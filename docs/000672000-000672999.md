# StackOverflow 问答 000672000-000672999

# soa - 云计算是基于 SOA 的吗？

> ID：672004
> 
> 赞同：4
> 
> 时间：2009-03-23T01:49:33.777
> 
> 标签：soa, cloud, definition

一些 SOA 基础是：

*   松耦合
*   可重用性
*   无状态服务
*   服务之间的正式合同
*   粗粒度
*   异步
*   抽象底层逻辑（黑盒）
*   可组合（作为构建块的服务）
*   可发现的服务
*   自主服务

* * *

它们中的大多数都可以应用于云计算，所以我的问题是云计算是 SOA 思维的产物还是它们是两个不同的怪物？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T02:06:47.730

云计算更多地基于 IAAS (I)nfrastructure (A)s (A) 服务，其底层虚拟化技术被抽象到最终用户不会注意到它们的地步。

IAAS 可能会也可能不会实现您在 SOA 中找到的所有内容。例如，它可能期望部署的应用程序处理它们自己的互连需求。IAAS 只关心全球配额是否得到执行，硬件是否可用并准确计量（很像电力计量）。

因此，云计算或多或少是 IAAS 的营销流行语。

一位智者曾经说过，“如果你不能用一两句话来解释某事是什么或做什么，那你就有问题了”，这说明没有人（包括 IBM）对“云”提出一个合适的定义。计算”，这与 IAAS 所暗示的明显不同。

同时，尽管您仍然可以，请随意从歧义中获利:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T01:55:10.940

云计算和 SOA 都是定义松散的术语，正如您所注意到的，它们有很多重叠之处。但是，我认为每个的合理定义将包括不与另一个相交的特征。例如，我看不出为什么不能在单一的、基于地球的（即，不是云:-) 服务器上提供 SOA 应用程序。相反，网络存储架构可能会或可能不会在底层使用 SOA，但在讨论 SOA 时，它们不会是首先想到的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-05T18:36:55.473

我的观点是——SOA 中的面向服务作为一个广泛的概念或架构风格适用于所有架构领域，即业务、信息、应用程序、技术。所以对于使用 IaaS、PaaS 或 SaaS 的人来说，它是业务架构级别的 SOA。它具有“服务”（在 SOA 中）需要的所有元素、提供者、消费者、绑定双方的服务合同等等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-25T12:25:06.843

按需基础——在云计算中，服务是按需和按需提供给用户的。SOA 与此类似，因为系统到系统的服务是按需提供的，也是按需提供的。因此，我认为，云计算和 SOA 都依赖于网络。

# c# - 查找 TreeViewItem 以删除数据

> ID：672005
> 
> 赞同：2
> 
> 时间：2009-03-23T01:49:43.200
> 
> 标签：c#, xaml, treeview, drag-and-drop

我想从 ListView 中拖动数据并将其放在 TreeView 中（拖动工作正常）。我使用 DataBinding 和 ItemTemplate 来填充 TreeView。

```
<TreeView ItemsSource="{Binding Groups}" Name="tvGroups" AllowDrop="True"
          Drop="tvDrop" DragOver="tvDragOver">
    <TreeView.ItemTemplate>
        <HierarchicalDataTemplate ItemsSource="{Binding Participants}">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Name}" />
                <Button Tag="{Binding .}" Click="Button_Click_2">
                    <Image Source="Resources/cross.png" />
                </Button>
            </StackPanel>
            <HierarchicalDataTemplate.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal" >
                        <TextBlock Text="{Binding Alias}" />
                        <Button Tag="{Binding .}" Name="btnDeleteParticipants" Click="btnParticipants_Click" >
                            <Image Source="Resources/cross.png" />
                        </Button>
                    </StackPanel>
                </DataTemplate>
            </HierarchicalDataTemplate.ItemTemplate>
        </HierarchicalDataTemplate>
    </TreeView.ItemTemplate>
</TreeView> 
```

* * *

```
private void tvDrop(object sender, DragEventArgs e)
{
    if (e.Effects == DragDropEffects.Copy &&
        e.Data.GetDataPresent(typeof(Participant)))
    {
        Participant data = e.Data.GetData(typeof(Participant)) as Participant;
    }
} 
```

A`Participant`从 ListView 拖到 TreeView。现在我需要找到`Group`. `Group`有什么想法可以从 TreeView中获得正确的信息吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T02:30:56.517

我只需在 HierarchicalDataTemplate 的 ItemTemplate 中的 StackPanel 上设置 Drop="tvDrop" 和 DragOver="tvDragOver"。

这种方式 1）当某物从组中退出时，您没有任何风险获得事件 2）您可以安全地将 Sender 转换为 FrameworkElement 并获取 DataContext 并将其转换为您的类。

如果您需要支持拖出组，您还可以在树视图本身上设置不同的处理程序。

# c# - 有没有办法在进程启动前或启动后告诉进程在 Windows 上使用哪个 IP 地址？

> ID：672012
> 
> 赞同：1
> 
> 时间：2009-03-23T02:01:23.123
> 
> 标签：c#, .net, windows, automated-tests, ip-address

我可以在 C# 中编程，所以如果有任何 .NET 类可用于重新分配 IP 地址，或者是否有用于更改给定进程的 IP 地址的命令行操作，这就是我认为我正在寻找的。

我正在做一些自动浏览器测试，我希望从不同的 IP 地址向我的站点发送请求。我的 Web 服务器分配了 15 个 IP 地址，所以我想让浏览器在每个请求上从不同的 IP 地址发出请求。或者我希望能够打开多个浏览器实例并让每个实例使用不同的 IP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T02:48:57.677

我今天读到了这篇文章：[为什么基于云的负载测试是一个杀手级应用](http://johngannonblog.com/2009/03/04/why-cloud-based-load-testing-is-a-killer-app/#)

您可以使用云服务（如亚马逊的）通过在短时间内启动大量服务器来测试您的站点来进行负载测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T02:10:25.757

您可以设置 ServicePoint 类的[BindIPEndPointDelegate](http://msdn.microsoft.com/en-us/library/system.net.servicepoint.bindipendpointdelegate.aspx)属性来指定用于连接的本地 IP 地址。

# regex - AWK 匹配正数和负数

> ID：672013
> 
> 赞同：0
> 
> 时间：2009-03-23T02:01:49.240
> 
> 标签：regex, unix, awk

我有一个看起来像这样的数据：

```
-1033  
-  
222
100
-30
-
10 
```

我想要做的是捕获除“仅破折号”条目之外的所有数字。

为什么我下面的 awk 失败了？

```
 awk '$4 != "-" {print $4}' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T02:16:18.020

你的`awk`脚本说

> 如果第四个字段不是破折号，打印出来

但是，如果该行不是破折号，您希望将其打印出来

```
awk '$0 != "-"' 
```

默认操作是打印，因此不需要正文。

如果你想打印一组数字，如果你使用 gawk，你可以使用 GNU awk 扩展。它允许使用正则表达式拆分记录：

```
gawk 'BEGIN { RS="(^|\n)-($|\n)" } { print "Numbers:\n" $0 }' 
```

现在，而不是行，它需要一组数字，由仅包含 的行分隔`-`。将字段分隔符 ( `FS`) 设置为换行符允许您遍历此类组中的数字：

```
gawk 'BEGIN { FS="\n"; RS="(^|\n)-($|\n)" } 
      { print "Numbers:"; for(i=1;i<=NF;i++) print " *: " $i }' 
```

但是我同意其他答案。如果您只想过滤掉与某些文本匹配的行，`grep`那么它是更好的工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T02:48:57.287

假设您的数据文件*实际上*是多列的，并且值在第 4 列中，则以下将起作用：

```
awk '$4 != "-" {print $4} {}' 
```

它仅在不是“-”的地方打印值。您的版本可能会打印该值（或两次），因为默认操作是打印。添加`{}`使默认操作“什么都不做”。

如果数据实际上如图所示（仅一列），您应该使用`$1`而不是`$4`- 我不会使用`$0`，因为那是整行，而且您的前两行末尾有空格，这将`$0`导致.`"-1033 "``"- "`

但是，如果它是单列，我根本不会使用 awk 而是：

```
grep -v '^-$'
grep -v '^ *- *$' 
```

`"-"`第二个允许字符两侧的空格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T02:52:30.227

你为什么要检查`$4`？看来您应该检查`$1`或`$0`如 litb 所说。

但是 awk 是完成这项工作的重量级工具。尝试

```
grep -v '^-$' 
```

删除仅包含破折号或

```
grep -v '^ *- *$' 
```

删除仅包含破折号和可能包含一些空格字符的行。

# c# - 自定义数据库连接类问题

> ID：672017
> 
> 赞同：1
> 
> 时间：2009-03-23T02:04:47.377
> 
> 标签：c#, asp.net

在我们的 Web 项目中，我们有一个自定义的数据库连接类，它创建 SqlConnection 对象并从 web.config 中为我们获取数据库连接字符串。

虽然这很好，但有一个问题。我们 Web 项目中的所有项目都依赖于该 web.config，以便此类可以工作。

需要在其他不需要 web.config 的解决方案或项目中使用来自我们 DL 的这个 db 连接，例如尝试使用的控制台项目让我们说我们的 Web 项目中的一些 DL 方法来进行一些数据操作.

因此，当我将一些 BL 项目方法添加到我的控制台解决方案时，它正在寻找创建数据库连接，但我的控制台应用程序中当然没有 web.config，所以它被炸毁了。

有没有比以下更好的方法来管理 SqlConnection 的创建：a) 将该类放在 web 项目中 b) 使该连接依赖于 web.config 键

以便非基于 Web 的项目可以在没有 BL 引用的情况下使用 BL，并且依赖于最终依赖于 web.config 中的键的连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T02:11:32.227

在您的控制台应用程序中，这些数据库连接设置需要进入 App.Config，但是您显然不希望将它们存储在 App.Config 和 Web.Config 中，因此您可以使用以下技术。

1) 将 DN 配置设置移动到单个 DBSettings.config 文件

2) 根据需要从 Web.Config 和 App.Config 中引用该配置

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
   <appSettings file="DBSettings.config">
   ...
</configuration> 
```

[此处详细介绍了](http://www.devx.com/vb2themax/Tip/18880)此技术。

# networking - 如果计算机名称以破折号“-”开头，如何 ping 计算机

> ID：672018
> 
> 赞同：4
> 
> 时间：2009-03-23T02:05:32.427
> 
> 标签：networking, ping

如果计算机名称以破折号“-”开头，如何 ping 计算机

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-23T02:09:21.093

在 *nix 上，使用“--”来允许以破折号开头的参数：

```
ping -- -funkyhost 
```

（不过，这可能对 Windows 没有帮助，因为 Windows 命令行解析有点初级）

另一方面，格式正确的 DNS 名称不允许以连字符开头。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T02:09:44.057

**在 Windows 上：**

尝试使用反斜杠 ('\') 字符转义破折号：

```
ping \-<hostname>.<domain> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-20T14:31:07.530

在 Microsoft Windows 上，使用 Alt+0151 - 更长的破折号

**ping 一个名为“-Quant-”的电脑名称**

1.  命令
2.  键入 ping
3.  按住 Alt，然后从数字键盘输入 0151，松开 Alt
4.  输入数量
5.  按住 Alt，然后从数字键盘输入 0151，松开 Alt
6.  按回车

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-11-26T16:24:54.707

使用IP地址怎么样？

# c# - C# 的简单 CRUD 生成器

> ID：672020
> 
> 赞同：13
> 
> 时间：2009-03-23T02:06:14.547
> 
> 标签：c#, database, code-generation, crud, dao

我正在为 C# 寻找一个简单的 CRUD（或 DAL）生成器。我不想要任何重量级的东西，因为我在 SQL Server 2008 数据库中只有几个表。

有什么建议么？我知道 .netTiers，但这对我的需要来说太多了。

谢谢！

更新：我尝试了 LINQ to SQL，但它不能很好地满足我的需求。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-23T02:39:17.043

我在过去的项目中使用过 SubSonic，它轻巧且易于使用。

他们提供了一个简单的[教程视频](http://www.wekeroad.com/webcasts/subsonicintro/intro.html)，完全设置它应该不超过 10 分钟。我建议观看处理 Web 应用程序项目的视频的后半部分，因为它向您展示了如何创建一个自定义的 Visual Studio 按钮，该按钮在您单击它时为您创建 DAL，而不是像他们建议的那样使用自定义构建提供程序视频的前半部分。

它提供了几种访问数据的方法、Active Record、生成类型化的存储过程和视图，或者您可以使用[的查询语言。](http://subsonicproject.com/querying/select-queries/)

使用后，我发现了一些怪癖：

*   如果您使用没有参数的生成存储过程，它将抛出一个`NullReferenceException`. 一种解决方法是创建一个未在过程中使用的虚拟参数
*   该`DeepSave()`功能在当前 2.1 版本中不起作用，您必须单独保存连接表中的数据
*   当您使用附加的（例如`Where(Tag.Columns.TagName).IsEqualTo("subjective")`，确保使用字符串值`Tag.Columns.TagName`来引用列时 - 否则如果您尝试使用`Column.Schema`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-23T02:54:52.187

Visual Studio 附带了一个几乎没人知道的代码生成器，称为[T4](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)。

您应该能够相对轻松地使用它来创建 CRUD 模板。

**编辑**

这是一个示例：[http ://www.olegsych.com/2008/01/how-to-use-t4-to-generate-crud-stored-procedures/](http://www.olegsych.com/2008/01/how-to-use-t4-to-generate-crud-stored-procedures/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T02:12:36.607

[MyGeneration](http://mygenerationsoftware.com)有一些相当不错的[CRUD SP 生成模板](http://www.mygenerationsoftware.com/TemplateLibrary/Template/?id=0834e5a5-976a-4b28-8102-be930d8066a2)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-04-12T08:31:08.690

试试[http://pureobjects.com/](http://pureobjects.com/) 它不需要任何其他工作

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-23T02:13:03.673

如何使用使用 DataSet 设计器创建的 DataSet。我记得在过去（.NET 1.0 和 1.1），我们会将 DataAdapter 拖到设计图面上，指定 Select 查询，然后根据 Select 查询为我们创建 Insert、Update 和 Delete 查询。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-23T04:29:06.700

看看[Codesmith](http://www.codesmithtools.com/)。[2.6 版本](http://www.codesmithtools.com/freeware.aspx)是免费的，以后的版本是供购买的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-23T02:54:21.983

万一钱不是一个大问题，我在[CodeSmith](http://www.codesmithtools.com/)中使用模板取得了巨大的成功。

有大量用于 CRUD 操作的示例模板，它会直接从您的数据库中读取。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-23T02:11:49.527

LINQ To SQL 很简单，它内置在 .NET 3.5 SP1 中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-23T02:14:51.297

Visual Studio 向导将为您创建一个简单的 CRUD 应用程序。

在表单上拖动一个数据网格，单击连接属性并从那里按照向导进行操作。

不是最佳实践，但很简单并且有效......

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-23T03:56:42.410

您是否尝试过动态数据 Web 应用程序（使用 LINQ to SQL）或动态数据实体 Web 应用程序（使用实体框架）。

[MSDN：演练：使用脚手架创建新的 ASP.NET 动态数据网站](http://msdn.microsoft.com/en-us/library/cc488469.aspx)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-10-13T18:25:42.560

我使用的是 SubSonic 3 ActiveRecord，但后来搬到了 BLToolkit。由于缺乏良好的文档，BLToolkit 很难上手，但一旦你习惯了它，它就非常像 SubSonic……除了没有性能问题。

SubSonic 很棒而且很简单，但是对于任何实用的东西来说，性能都无法忍受。每当连接或子查询完成时，它都会拉下整个表。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-09-30T15:51:23.450

我使用[ssms 工具包](http://www.ssmstoolspack.com/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-09-19T00:51:04.237

看看 LLBLGen Pro，我发誓。它不是免费的，但也不贵。您可以在一小时内启动并运行（编写代码），它附带的模板生成的代码基本上可以做任何您想做的事情。甚至不必再考虑数据库接口代码真是太好了（而且富有成效）。

# flash - Adobe AIR 执行程序

> ID：672021
> 
> 赞同：32
> 
> 时间：2009-03-23T02:06:29.790
> 
> 标签：flash, apache-flex, air, command

我想从 Adob​​e AIR 应用程序中按下一个按钮并执行一些已安装的程序。例如，我会有一个名为“Start Winamp”的按钮。当按下它时，它应该直接启动 Winamp.exe...我不想执行一些命令行的东西，我只想启动一个 exe。或者……是一样的吗？请让我知道这是否可能。

谢谢你。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-12-17T15:25:43.833

使用 AIR 2.0，您现在可以：

```
if(NativeProcess.isSupported)
{
    var file:File = File.desktopDirectory;
    file = file.resolvePath("StyleLookupold.exe");

    var nativeProcessStartupInfo:NativeProcessStartupInfo = new NativeProcessStartupInfo();
    nativeProcessStartupInfo.executable = file;
    var process:NativeProcess = new NativeProcess();

    process.start(nativeProcessStartupInfo);

} 
```

您还需要将其添加到您的描述符文件中。

```
<supportedProfiles>extendedDesktop</supportedProfiles> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-23T08:00:36.350

没有直接的方法可以做到这一点。试试[CommandProxy](http://www.mikechambers.com/blog/2008/01/17/commandproxy-net-air-integration-proof-of-concept/)。

非常仔细地阅读博客文章。您确实需要创建两个不同的项目：一个本机操作系统可执行文件和一个 AIR 应用程序。本机可执行文件会启动您的 AIR 应用程序。AIR 应用程序依次请求可执行文件来处理操作系统级别的请求。

[从Google Code](http://code.google.com/p/commandproxy/)下载源代码并创建两个项目——一个用于示例 C# exe 的 Visual Studio/Mono，另一个用于 AIR 应用程序。[这](http://code.google.com/p/commandproxy/wiki/Compiling)是一个链接，描述了如何设置前者。

在 AIR 应用程序的主 MXML 文件中，您需要执行以下操作：

*   创建一个`CommandProxy`对象，添加一些事件监听器，用于连接检测、`Command`响应和错误。

*   通过`connect`调用连接到本机 exe

*   在 的事件处理程序中`connect`，创建一个新的`Command`eg`ScreenshotCommand`并执行它（通过`CommandProxy.execute`方法）

……就是这样！

希望这可以帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-20T10:14:38.447

答案分为两部分。一，如果你真的必须运行一个 .exe 文件，唯一的办法就是使用命令代理。就个人而言，在 .Net/Mono 中使用一个有点夸大其词。我不知道 Mono，但是要求您的用户安装 .Net**和**AIR 会吓跑几乎所有人。另外，如果我要让用户安装 Mono，为什么不直接用 Mono 编写 UI 并完成它......？

你可以在 Ruby 中编写一个简单的命令代理，它实际上是跨平台的，并且在大约 5 分钟内非常省事（我刚刚做到了，如果你想要代码在这里评论我，我会发布它）。如果您想在启动后控制该过程，这是一项更严肃的努力。对于分发等，我相信Ruby会更容易。

**另一方面**，[检查一下这个想法](http://www.jeffryhouser.com/index.cfm/2008/4/22/)。Jeff 建议使用来自 AIR 的 URL 请求。基本上，如果您的浏览器能够正确解释它，那么您就可以开始了。代码看起来像这样

```
var request : URLRequest = new URLRequest('C:\\playlists\\test.m3u'); 
```

我认为，如果有一点创意（尤其是 Mime 类型），第二种解决方案甚至可能适用于 Winamp（例如，播放列表或其他东西）。

祝你好运，谢谢你的问题，这可能是一个骗局，但谷歌只找到了这个，所以你赢了:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-05T13:56:22.477

我认为 FluorineFx 可以满足您的要求：[http ://aperture.fluorinefx.com/?p=5](http://aperture.fluorinefx.com/?p=5)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-11-09T23:10:23.073

AIR 2.0 将具备这种能力。

预计将在年底（2009 年）推出测试版，并于 2010 年上半年发货。

[http://blogs.adobe.com/air/2009/10/previewing_adobe_air_2_at_adob.html](http://blogs.adobe.com/air/2009/10/previewing_adobe_air_2_at_adob.html)

**本机进程 API** 从 AIR 2 开始，开发人员可以访问本机进程 API，使应用程序能够调用本地计算机上的本机应用程序并与之通信。为了保持 .air 文件格式的跨平台特性，利用本机进程 API 的应用程序必须部署为本机安装程序，例如 .exe 和 .dmg。AIR 运行时 SDK 将支持生成基本的本机安装程序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T02:23:00.047

请参阅此博客文章：[从 AIR 运行 exe 文件](http://www.badu.ro/?p=35)

简短的摘要：

> “如果您确实需要运行外部 exe 文件，并且没有其他方法可以解决您的问题，那么您将确保用户在启动 AIR 应用程序之前运行另一个软件。”

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-23T02:26:44.873

现在，没有办法用 AIR 原生地做到这一点。不过，有一些选择：

*   [舒](http://shu-player.com/)
*   [Red5](http://osflash.org/red5)在 localhost 上运行
*   创建一个在用户机器上运行的服务并使用[套接字](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/Socket.html)连接到它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-02-10T09:22:45.710

另一种方法是在本地机器上启动简单的网络服务器（在后台），并使用 HTTPService 调用它的方法。

例如，后台网络服务器可以是 python： http: [//fragments.turtlemeat.com/pythonwebserver.php](http://fragments.turtlemeat.com/pythonwebserver.php)

它可以启动可执行文件并提供 AIR 无法提供的功能。

这使 Flex 代码保持干净，因为它只实现了 REST 接口和 python（或其他语言）的其余工作。您还可以从使用 python 作为 sqlite 数据库的接口中受益，或者您可以将整个 django 作为网络服务器启动。

唯一的缺点是服务器必须已经在 localhost 上运行.. 并且正在监听某个端口（即 81）。您可以通过在系统启动时启动服务器来做到这一点。

这不是最好的方法，但在某些情况下，它可以像对我一样帮助您的项目。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-27T13:45:29.263

在 mac os x 中，如果要启动 .app 文件，则必须为文件路径编写以下内容。（假设app的名字是xxx）

```
if(NativeProcess.isSupported)
{
    //not correct
    //file = file.resolvePath("/Applications/xxx.app");

    //correct
    file = file.resolvePath("/Applications/xxx.app/Contents/MacOS/xxx");

    var nativeProcessStartupInfo:NativeProcessStartupInfo = new NativeProcessStartupInfo();
    nativeProcessStartupInfo.executable = file;
    var process:NativeProcess = new NativeProcess();

    process.start(nativeProcessStartupInfo);

} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-10-06T17:50:09.150

或者简单我的网站为新应用程序创建自定义安装程序阅读更多

[http://board.flashkit.com/board/showthread.php?834579-Embed-exe-file-from-swf-to-write-to-local-directory](http://board.flashkit.com/board/showthread.php?834579-Embed-exe-file-from-swf-to-write-to-local-directory)

额外提示：我们建议您使用 Enigma Virtual Box，因为它是免费的，它非常适合应用程序虚拟化或像 BoxedApp Packer 这样的 Exe-Packer，但它比 Enigma Virtual Box 贵很多谢谢！

# php - 缓存不经常更改的查询结果的最佳技术

> ID：672029
> 
> 赞同：6
> 
> 时间：2009-03-23T02:09:56.897
> 
> 标签：php, mysql, caching

我有一个 php Web 应用程序，其中某些数据每周更改一次，但经常被阅读。

检索数据的 SQL 查询和用于 html 输出的 php 代码相当复杂。有多个表连接和大量计算 - 但它们会产生一个相当基本的 html 表。用户是分组的，每周每个组的表格相同，但不同的组不同。我可能会为成千上万的用户提供数百张表。

出于性能原因，我想缓存这些数据。我不想在每次有人点击页面时都运行这些查询和计算，而是希望每周运行一次进程来为每个组生成表，以便在需要时进行简单的读取。

我很想知道您成功或不成功地使用了哪些技术来实现这样的目标？

我可以看到的选项包括：

*   将计算的 html 结果存储在 MySQL 表中，由用户组标识
*   将结果数据存储在由用户组标识的 MySQL 表中（困难，因为没有固定数量的数据项）
*   在静态文件中缓存页面输出

欢迎任何其他建议！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T02:23:07.910

在生成表的函数中，使其将结果存储到磁盘上的文件中：

```
/cache/groups/1.txt
/cache/groups/2.txt 
```

您不必为它运行每周的批处理作业，在调用该函数以获取数据时，检查缓存是否已过期（或不存在）。如果是这样，则生成并缓存结果。如果没有，只需返回缓存的文件。

```
function getGroupTable($groupId) {
    if (cacheIsStale($groupId)) {
        generateCache($groupId);
    }
    return file_get_contents($cacheFile);
} 
```

该`cacheIsStale()`函数可以只查看[文件的时间戳](http://au2.php.net/manual/en/function.filemtime.php)来测试新鲜度。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-23T02:18:31.413

确实有几个选择：

*   每周预渲染页面，然后“静态”地提供它们。
*   使用缓存（例如[Squid](http://www.squid-cache.org/)）在第一次机会的基础上将此类响应缓存一周。例如，您可以配置缓存策略，以便访问特定页面（例如very_long.php？...）的请求与网站的其余部分分开缓存。
*   确保打开数据库缓存。MySQL 有自己的缓存，您可以对其进行微调，以便不会重新计算重复的长查询。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T02:19:24.377

首先，简介。验证这些查询是否确实消耗了大量时间。也许 MySQL 查询结果缓存已经为您完成了工作。

如果他们真的在消耗资源，我会做的是创建一个包含计算结果的表，以及一个完成所有需要管理的过程，以便在数据更改时调用。那些频繁的读取应该只针对预先计算的数据，而不必检查它是否仍然有效。

只需在修改基础数据的过程或数据库触发器中添加一些挂钩，如果可以的话，这些将不经常执行（每周？），并且可能需要大量时间来生成任何结果。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T02:24:08.250

看来您已经涵盖了大部分内容。

假设表数据不大，另一种选择是使用[memcache](http://php.net/memcache)缓存结果 - 这可能是更快的解决方案，尽管您需要检查内存需求以查看它是否是一个可行的选择。

# c# - 流利的 NHibernate，使用接口

> ID：672032
> 
> 赞同：31
> 
> 时间：2009-03-23T02:10:57.393
> 
> 标签：c#, nhibernate, interface, mapping, fluent

我刚刚切换到 Fluent NHibernate，但遇到了一个问题，但没有找到任何相关信息。

情况如下：

```
public class Field : DomainObject, IField
{
    public Field()
    {  
    }

    public virtual string Name { get; set; }
    public virtual string ContactPerson { get; set; }
    public virtual bool Private { get; set; }
    public virtual IAddress Address { get; set; }  
} 
```

IAddress 是由一个名为 Address 的类实现的接口

```
public class Address : DomainObject, IAddress
{
    public Address()
    {
    }

    public virtual string City { get; set; }
    public virtual string Country { get; set; }
    public virtual string PostalCode { get; set; }
    public virtual string StreetAddress { get; set; }
} 
```

这是我的两个类的映射文件

地址

```
public class AddressMap : ClassMap<Address>
{   
    public AddressMap()
    {
        WithTable("Addresses");
        Id(x => x.Id, "Id").Access.AsCamelCaseField(Prefix.Underscore).GeneratedBy.Guid();
        Map(x => x.City, "City");
        Map(x => x.Country, "Country");
        Map(x => x.PostalCode, "PostalCode");
        Map(x => x.StreetAddress, "StreetAddress");
    }
} 
```

场地

```
public class FieldMap : ClassMap<Field>
{
    public FieldMap()
    {
        WithTable("Fields");
        Id(x => x.Id, "Id").Access.AsCamelCaseField(Prefix.Underscore).GeneratedBy.Guid();
        Map(x => x.Name, "Name");
        Map(x => x.ContactPerson, "ContactPerson");
        Map(x => x.Private, "Private");
        References(x => x.Address, "AddressId").Cascade.Delete().Cascade.SaveUpdate();
    }
} 
```

因此，当我尝试从数据库中检索字段对象时，我收到 NHibernate 错误，指出 IAddress 未映射。有没有办法指定 NHibernate 在映射中使用 Address 类？

如果需要更多信息，请告诉我。

非常感谢，

查尔斯

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2010-01-22T00:28:59.353

我发现使用接口而不是具体类作为属性是有正当理由的。

例如，如果您的 Field 类与 Address 类位于一个单独的项目中，并且您没有从 Field 类的项目中依赖 Address 类的项目。

还有其他处理这种情况的方法，但最简单的方法通常是尝试您正在做的事情并明确告诉 NHibernate 用于 IAddress 的具体类。

您现在可以在 Fluent NHibernate 中执行此操作，如下所示：

```
References(x => x.Address, "AddressId")
    .Class(typeof(Address); 
```

不幸的是，你不能用 HasMany 或 HasManyToMany 做到这一点。由于 C# 中缺乏良好的协方差支持，我不确定这是否可能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T20:41:37.893

在您的 Field 对象上，您有一个 IAddress 类型的对象。这可以通过任意数量的不同实现来实现。根据您的要求，每个实现都会有自己的映射，这会给 NHibernate 带来许多困难（不可能？）。

一个简单的例子将有助于演示。假设您有两个 IAddress 实现 Address1 和 Address2。它们都保存在自己的表 tblAddress1 和 tblAddress2 中。当您尝试加载您的 Field 对象时，NHibernate 所知道的只是您有实现 IAddress 的东西，它不知道哪个实现被持久化。它如何知道使用哪个映射来检索任何给定字段的子对象？

我敢肯定还有更多的复杂性，但这个例子说明了为什么你必须为你声明的确切类型的对象进行映射。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-17T10:02:42.797

如果您有兴趣将 ORM 完全与域层分离，并在整个数据层中引用接口而不是指定具体的类，则可以实现 EmptyInterceptor 以在两者之间进行映射。

[在这里](https://stackoverflow.com/questions/2286691/how-to-map-an-interface-in-nhibernate/21825789#21825789)查看我的答案。

# php - 将字符串与整数进行比较会产生奇怪的结果

> ID：672040
> 
> 赞同：36
> 
> 时间：2009-03-23T02:14:02.237
> 
> 标签：php, casting, comparison

我真的很困惑为什么这个操作有效。有人可以解释一下吗？

```
$test1 = "d85d1d81b25614a3504a3d5601a9cb2e";
$test2 = "3581169b064f71be1630b321d3ca318f";

if ($test1 == 0)
  echo "Test 1 is Equal!?";
if ($test2 == 0)
  echo "Test 2 is Equal!?";

// Returns: Test 1 is Equal!? 
```

为了澄清起见，我试图将字符串`"0"`与`$test`变量进行比较。我已经知道要修复我可以包含（因为我应该有）的代码`0`in `""`s

我想知道这是 PHP 错误、服务器错误还是某种有效的操作。根据[http://us3.php.net/types.comparisons](http://us3.php.net/types.comparisons)这**应该不起作用**。

**编辑：**从头开始，显然它确实提到了字符串和 0 之间的松散比较是真的。但我仍然不知道为什么。

**编辑2：**我已经修改了我的问题，为什么`$test2`价值`"3581169b064f71be1630b321d3ca318f"`不起作用？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-03-23T02:32:54.220

[从 PHP 手册](http://il.php.net/manual/en/language.types.string.php#language.types.string.conversion)：

> **字符串转换为数字**
> 
> 在数字上下文中评估字符串时，结果值和类型确定如下。
> 
> 如果字符串包含任何字符“.”、“e”或“E”，则该字符串将被评估为浮点数。否则，它将被评估为整数。
> 
> 该值由字符串的初始部分给出。如果字符串以有效的数字数据开头，这将是使用的值。否则，该值将为 0（零）。有效的数字数据是一个可选的符号，后跟一个或多个数字（可选地包含一个小数点），后跟一个可选的指数。指数是“e”或“E”后跟一位或多位数字。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-23T02:21:24.653

**使用 == 运算符进行类型转换**

== 运算符是一种松散类型的比较。它将两者都转换为通用类型并进行比较。[这里解释了](http://us3.php.net/manual/en/language.types.string.php#language.types.string.conversion)字符串转换为整数的方式。

请注意，[您链接到的页面与](http://us3.php.net/types.comparisons)此不矛盾。检查第二个表，它说将整数`0`与字符串`"php"`进行比较`==`应该是正确的。

发生的情况是字符串转换为整数，非数字字符串（不包含或以数字开头的字符串）转换为`0`.

**数字与非数字字符串**

由数字组成或以数字开头的字符串被视为*数字字符串*。如果字符串在该数字之后有其他字符，则这些字符将被忽略。

如果字符串以不能解释为数字的一部分的字符开头，则它*是非数字字符串*并将转换为`0`. 这并不意味着数字字符串必须以数字 (0-9) 开头 - 例如`"-1"`是数字字符串，因为在这种情况下减号是数字的一部分。

例如，您的字符串`"d85d1d81b25614a3504a3d5601a9cb2e"`不以数字开头，因此它将转换为`0`. 但是您的第二个字符串`"3581169b064f71be1630b321d3ca318f"`将转换为 integer `3581169`。所以这就是为什么你的第二个测试不能以同样的方式工作。

**你应该做什么**

你可能想要：

```
if ($test1 === "0") 
```

注意使用三等号而不是双等号。这确保您要比较的是一个仅包含数字零的字符串，并防止任何类型转换。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-23T02:23:06.397

经过一番调查，原来 PHP 手册中的 aidan 提到，**任何不以数字开头的字符串**在转换为整数时都将转换为 0。

这意味着：

```
("php" == 0) === true
("1php" == 0) === false 
```

非常烦人并且没有很好的记录。它位于类型比较页面的评论底部。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-06T19:24:43.240

```
$test1 = "d85d1d81b25614a3504a3d5601a9cb2e"; 
```

此字符串以“d”开头，它不是有效数字，var 将解析为 0，您的 test#1 将通过。

```
$test2 = "3581169b064f71be1630b321d3ca318f"; 
```

此字符串以 3581169 开头，这是一个有效数字，因此 var 将解析为不等于 0 的值。因此您的 test#2 不会通过。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-06T12:49:46.353

我一直在使用一些转换和比较来测试**数字字符串**是否为数字：

```
$test1="19de6a91d2ca9d91721d82f1bd8102b6";
   echo (float)$test1==$test1; //TRUE
   echo is_float($test1); //FALSE

   //Converting the string to float and then converting it to string and compare will do the trick 
   echo (string)((float)$test1)==(string)$test1; //FALSE

$test2="5.66";
   echo (float)$test2==$test2; //TRUE

   //Testing the numeric string using `is_float` wont give the expected result
   echo is_float($test2); //FALSE

   echo (string)((float)$test2)==(string)$test2; //TRUE 
```

# java - 创建自定义 Hibernate UserType：找出当前实体表名

> ID：672063
> 
> 赞同：1
> 
> 时间：2009-03-23T02:27:26.697
> 
> 标签：java, hibernate

我正在编写一个 Hibernate CompositeUserType，为了将自定义对象序列化为 JDBC，我需要知道我正在更新的表的名称（因为我的工具有一些配置附加到表中）。

我现在可以完成这项工作的唯一方法是使用实​​体表名显式参数化我的 UserType，这是冗余且容易出错的。

有没有办法在“nullSafeSet”中获取这些信息？

```
public void nullSafeSet(PreparedStatement ps, Object value, int index,
        SessionImplementor session) 
        throws HibernateException, SQLException {

    // find out the entity table name here 
```

如果没有，是否有办法在 UserType 初始化期间获取拥有实体的定义（类似于传递参数的方式）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T04:42:57.823

我做了类似的事情，我需要在运行时根据其他一些设置在自定义类型上设置一个属性。使用配置，您可以访问自定义类型以动态设置属性，如下所示：

```
for (Iterator iter=configuration.getClassMappings(); iter.hasNext();) {
  PersistentClass pc = (PersistentClass)iter.next();
  for (Iterator iter2=pc.getPropertyIterator(); iter2.hasNext();) {
    Property property = (Property)iter2.next();
    if (property.getType().getName().equals("your custom type")) {
      SimpleValue v = (SimpleValue)property.getValue();
      v.getTypeParameters().setProperty("table property", pc.getTable().getName());
    }
  }
} 
```

显然，这里有很多假设（每个实体一个表，自定义类型是单个属性等），但它应该可以工作。

我没有尝试过的另一种可能性是在 nullSafeSet 方法中使用 PreparedStatement 元数据，例如：statement.getMetaData().getTableName(index)。

# smlnj - smlnj listdir 问题

> ID：672065
> 
> 赞同：-1
> 
> 时间：2009-03-23T02:30:37.797
> 
> 标签：smlnj

我是一个学习sml的新手，给我的问题涉及到我不理解的IO功能。这是我真正需要帮助才能开始的 2 个问题，请向我提供代码和一些解释，我将能够对其他问题给出的代码进行反复试验。

Q2) readlist(filename) 读取文件名列表（每个文件名由 (Q1) 中的 listdir 生成，并将它们组合成一个大列表。（从 Q1 中的文本文件读取，然后将内容分配到 1 个包含所有信息）

问题是，我只在介绍部分从学校的讲师那里学到，甚至没有显示系统输入或输出示例，甚至没有教授“使用文件”功能。如果知道 sml 的人看到这个，请帮忙。感谢任何努力帮助我的人。

感谢您的回复，目前我正在使用 SMLNJ 尝试执行此操作。基本上，Q1 要求我将提供的“目录名”的目录文件列出到“文件名”中的文本文件中。Q2 要求我从“文件名”文本文件中读取，然后将内容放入一个大列表中。

顺便说一句，如果你们只看到这篇文章，也请尝试提问。目前我被困在试图从 txt 文件中读取并将其附加到一个列表中，我可以为单行执行此操作，但现在我正在尝试为整个文件执行此操作：

```
fun readlist(infile : string) =
let val ins = TextIO.openIn infile

fun listing() = 
TextIO.inputLine ins;

in listing()
end;
TextIO.closeIn; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T04:55:19.820

你确定我没教你？你欠我一个鸡肉馅饼。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T02:41:09.097

我很难弄清楚你想问什么问题。

您询问的函数不是 ML 标准基础库的一部分。如果您应该编写它们，那么如果没有某种 Posix 模块，您将很难过。你可以告诉你的导师我不关心这个作业。

莫斯科 ML 包含一个`listDir`非常简单的函数：

```
- load "Mosml";
> val it = () : unit
- Mosml.listDir ".";
> val it = ["natural-semantics.djvu", "natural-semantics.pdf"] : string list
- 
```

要获得更多帮助，请更清楚您的要求。

* * *

编辑：因为这是一个家庭作业问题，我不应该只给你答案，而是一些有用的功能包括`openDir`,`readDir`和`closeDir`from the `OS.Filesys`structure。这些将告诉您目录中的内容。然后读取和写入您想要的文件`TextIO`。

您会发现[标准基础库文档](http://www.standardml.org/Basis/index.html)必不可少。

# javascript - 如何具有固定宽度的灵活高度

> ID：672068
> 
> 赞同：1
> 
> 时间：2009-03-23T02:31:35.860
> 
> 标签：javascript, css

1.  页面具有从 980px 到 1200px 的灵活宽度
2.  有 3 列
3.  左列是固定宽度
4.  中间列灵活且大（因此所有额外的宽度都将进入此列）
5.  右列是固定宽度

## 问题

*   Middle Column 存储一个巨大的文章，但是当左右列是固定宽度时，它设置了整个页面的高度。
*   因此它修剪文章

*   如何将中间栏设置为灵活高度以便显示整篇文章？？**

## 示例代码

```
<div class="col_2">
</div>
<div class="col_1">
</div>
<div class="col_3">

.col_1{padding-left:230px; padding-right:259px;position:absolute; }
.col_2{width:210px; float:left;}
.col_3{width:210px; float:right; margin-right:10px;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T02:45:56.420

您可以尝试A List Apart 中[的“The Holy Grail”](http://www.alistapart.com/articles/holygrail)。它是一个三柱固定的左/右液体中心布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T02:40:08.243

对于三列、左/右固定、居中的液体布局，请尝试：

[Mani Sheriar 的 CSS 三列液体布局](http://www.manisheriar.com/holygrail/index.htm)

# c# - 如何使用索引器访问枚举项并将数组字符串分配给它以进行显示？

> ID：672073
> 
> 赞同：2
> 
> 时间：2009-03-23T02:38:25.750
> 
> 标签：c#

已编辑：2009 年 3 月 23 日更新。请参阅底部的其余帖子。我仍然遇到索引器的问题。任何帮助或示例真的会帮助我。

> 1.  编写一个类 MyCourses，其中包含您当前正在学习的所有课程的枚举。这个枚举应该嵌套在你的 MyCourses 类中。您的班级还应该有一个数组字段，该字段提供每个课程的简短描述（作为字符串）。编写一个索引器，将您的枚举课程之一作为索引并返回该课程的字符串描述。
>     
>     
> 2.  编写一个 MyFriends 类，其中包含一个索引器，该索引器提供对您朋友姓名的访问。

```
namespace IT274_Unit4Project
{

    public class MyCourses
    {

        // enumeration that contains an enumeration of all the courses that 
        // student is currently enrolled in
       public enum CourseName {IT274= 0,CS210 = 1}

        // array field that provides short description for each of classes, 
        // returns string description of the course
        private String[] courseDescription = 
         {"Intermediate C#: Teaches intermediate elements of C# programming and software design",
          "Career Development Strategies: Teaches principles for career progression, resume preparation, and overall self anaylsis"};

        // indexer that takes one of the enumerated courses as an index 
        // and returns the String description of the course
         public String this[CourseName index]
           {
             get
             {
                 if (index == 1)
                     return courseDescription[0];
                 else
                     return courseDescription[1];
             }
               set
               {
                   if (index == 1)
                       courseDescription[0] = value;
                   else
                       courseDescription[1] = value;
               }
         }

    }

}//end public class MyCourses 
```

我正在做这个家庭作业项目，并且无法理解解释如何正确获取枚举的访问值然后将字符串数组值应用于它的文本。你能帮我理解这个吗？我们使用的文字非常困难，而且对于初学者来说很难理解，所以我在这里有点自己。我已经编写了第一部分，但是在访问枚举值和分配方面需要一些帮助，我想我已经接近了，但不明白如何正确获取和设置值。

*请不要向我提供直接的代码答案，除非 MSDN 风格的解释是泛化的而不是特定于我的项目的。IE：*

```
 public class MyClass
{ string field1;
string field2;

//properties
public string Value1
get etc... 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T02:53:34.123

首先，枚举的基本类型必须是数值类型，所以不能有基本类型字符串的枚举。以下内容不会编译：

```
public enum CourseName
{
    Class1 = "IT274-01AU: Intermediate C#", 
    Class2 = "CS210-06AU: Career Development Strategies"
} 
```

因此，将其更改为使用默认的 int 基类型。如下所示，但可以根据需要更改名称（例如，您可能希望使用课程名称而不是代码）。还要记住，在枚举中尽可能使用有意义的名称。

```
public enum Courses
{
    IT274_01AU, 
    CS210_06AU
} 
```

（我知道您说过您不想要特定的代码示例，但我认为这比任何解释都更清楚地说明了我的观点。）

* * *

其次，您在使用索引器时处于正确的轨道上，但您必须考虑如何将枚举与字符串描述数组联系起来。请记住，枚举只不过是一组有限的美化（命名）数字。使用上述`Courses`枚举，您有两个名为`IT274_01AU`和的值`CS210_06AU`。因此，在索引器中，您必须将这些值中的每一个映射到字符串描述。有多种方法可以做到这一点，但最简单的一种是 switch 语句，例如：

```
switch (myEnum)
{
case value1:
    return string1;
case value2:
    return string2;
} 
```

然而，另一种选择是将枚举值显式映射到其基本类型，并使用基本类型索引到您的数组中。例如，如果您有枚举

```
public enum Enumerations
{
    value1 = 0,
    value2 = 1
} 
```

then you can index directly into an array using `myArray[(int)myEnum]`. This may be of use and is the slightly-more-advanced-but-less-lines-of-code-and-arguably-easier-to-understand method.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T02:51:27.513

（抵制写代码的冲动）

首先，枚举是整数的命名列表，并且（根据 MSDN）批准的枚举类型是 byte、sbyte、short、ushort、int、uint、long 或 ulong。

另外，请记住 courseDescription 是一个字符串数组，索引器的目的是为您提供该数组的索引（即 [0] 返回第一个字符串，[1] 返回第二个，等等）。

# asp.net-mvc - 将 application/json 绑定到 asp.net mvc 中的 POCO 对象，序列化异常

> ID：672079
> 
> 赞同：2
> 
> 时间：2009-03-23T02:41:50.907
> 
> 标签：asp.net-mvc, json, serialization, error-handling

我正在将 json 从我的视图中备份到我的控制器操作以执行操作。要将正在发送的 json 转换为 POCO，我正在使用此操作过滤器：

```
public class ObjectFilter : ActionFilterAttribute {
public Type RootType { get; set; }

public override void OnActionExecuting(ActionExecutingContext filterContext) {
IList<ErrorInfo> errors = new List<ErrorInfo>();
try {
    object o = new DataContractJsonSerializer(RootType).ReadObject(filterContext.HttpContext.Request.InputStream);
    filterContext.ActionParameters["postdata"] = o;
    }
catch (SerializationException ex) {
    errors.Add(new ErrorInfo(null, ex.Message));
}
finally {
    filterContext.ActionParameters["errors"] = errors.AsEnumerable();
} 
```

}

它使用 DataContractJsonSerializer 将 JSON 映射到我的对象。然后我的 Action 被装饰成这样：

```
[ObjectFilter(RootType = typeof(MyObject))]
public JsonResult updateproduct(MyObject postdata, IEnumerable<ErrorInfo> errors) {
    // check if errors has any in the collection!
} 
```

所以推测，这里发生了什么，如果将 JSON 序列化为对象类型时出现问题（如果字符串不能被解析为十进制类型或类似的类型），它会将错误添加到集合中，然后通过这个错误直到视图。然后它可以检查这个集合是否有错误并向客户端报告。

问题是我似乎无法找出*导致*问题的字段。理想情况下，我想回到视图并说“这个领域”有问题。SerializationException 类似乎没有提供这种灵活性。

集体 SO hivemind 将如何考虑解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T03:08:29.540

I would just do an ajax form post. It's much easier.

[http://plugins.jquery.com/project/form](http://plugins.jquery.com/project/form)

[http://malsup.com/jquery/form/](http://malsup.com/jquery/form/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-18T12:15:38.047

这个怎么样：[Json.Net](http://james.newtonking.com/projects/json-net.aspx) 它读取一个 JSON 字符串，然后将其反序列化为给定的 POCO 对象。

```
string jsonResult = GetJsonStringFromSomeService();
MyPocoObject myobject = JsonConvert.DeserializeObject<MyPocoObject>(jsonResult);
Console.Write("Damn that is easy"); 
```

但是对于确定错误发生的位置，我不太确定。

# language-agnostic - 何时使用模板方法 Vs。战略？

> ID：672083
> 
> 赞同：31
> 
> 时间：2009-03-23T02:45:55.733
> 
> 标签：language-agnostic, design-patterns

模板方法模式和策略模式做的事情大致相同。我了解它们之间的基本区别（模板方法是基于继承的，策略是基于组合的），但是对于何时选择一个而不是另一个有什么体面的指导方针？似乎他们做的事情基本相同。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-23T02:55:55.910

策略允许在多个地方使用可重用的算法。如果您有一个算法可以由您的消费者提供并且可以在多个地方使用，那么这是 Strategy 的好地方（排序算法、谓词、比较器......就是很好的例子）。

模板方法专门针对您希望人们能够从您的类继承并希望他们能够以受控方式覆盖您的实现的情况（基本上防止他们替换所有管道并为他们提供特定的扩展点而无需因为他们没有调用基本方法或在错误的时间调用它而冒着问题的风险）。

它们可以是相似的，并且它们可以用于相同的目的，具体取决于您实际在做什么。与所有设计模式一样，很难回答这样的问题，因为没有真正确定的答案。实际上更容易在上下文中决定......

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-01T21:30:55.723

这两者实际上可以非常有效地一起使用。

不要将模式视为具有特定代码来实现它们的食谱。

关键是设计意图，并且可以有很多实现。通过在代码中某处提及模式名称，您可以让读者了解您在编写该代码时的意图。实施是次要的。

模板方法为您提供“具有可替换步骤的算法”。（算法通常在不可覆盖的方法中定义（例如 final 或 private））

这个概念的 GoF 实现使用继承和方法覆盖来替换这些步骤。

*但是*，如果这些步骤被*策略*替换，您仍然使用模板方法。

例如，考虑一个想要按顺序遍历二叉树并在每个节点处“做某事”的类。

意图是 inorder() 方法是一个模板方法 - walk 的结构总是相同的。

“钩子”方法，即“做某事”的部分，可以作为同一类中的方法实现（并在子类中重写以改变行为），也可以在外部实现，在这种情况下，它是一种“做某事”的策略。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-03-23T15:05:10.057

当算法需要了解它运行的对象的内部结构时，我使用模板方法。

在所有其他情况下（即当算法只需要使用对象的接口时），我尝试使用 Strategy。

此外，策略仅在需要实现实际算法时才有用：如果类之间的唯一区别是（例如）返回什么简单的值，请使用模板方法。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-03-23T08:53:03.230

在以下情况下考虑使用策略：

*   您的对象行为需要在运行时更改。
*   您已经有其他标准的类层次结构。
*   您想在不同的类之间共享策略逻辑。

在其他情况下，使用模板模式就足够了。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-03-09T18:11:15.747

我不同意这个说法（来自[这个答案](https://stackoverflow.com/a/672098/331508)）：

> “模板方法专门针对您希望人们能够从您的类继承并希望他们能够以受控方式覆盖您的实现的情况。”

如果您希望人们从您的类继承，那么您想要一个特定的实现，而不是想要一个特定的行为。这对我来说很难闻。

WANT 的一项有效功能是能够覆盖或提供算法的各个步骤的实现。这个目标可以通过模板方法（我们可以选择性地覆盖受保护的方法）或策略模式（我们注入实现）来实现。

如果您正在构建一个实现算法的类，并且您希望允许其他开发人员更改该算法中的步骤，那么这就是您的要求。您唯一的决定是是否允许他们通过继承或组合来做到这一点。

在所有其他条件相同的情况下，我们应该更倾向于组合而不是继承，但我们甚至应该首先弄清楚我们的目标是什么（我们可能都不需要）来决定继承/组合。

我永远不会从“我想让他们继承这个类”开始。这是国际海事组织本末倒置。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-23T08:49:59.680

您可以创建大继承树来更改 N 行为之一。您可以创建第二个大继承树来更改 N 行为中的第二个。

但您也可以通过创建小型策略树来卸载您的树。

因此，如果您注意到添加越来越多的类只是为了在某些行为中添加一些更改 - 是时候为您的类提供策略了。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-04-11T15:57:48.973

我同意并同意斯科特的解释。

**模板**模式 = 关心绘制将进行操作的通用线 - 模板 - 基本上是“具有可替换步骤的算法”（非常好的创造），其中可替换步骤可以使用**策略**模式概念委托。

**策略**模式 = 只关心将客户端与操作的下划线实现分离，该操作的结果需要始终遵守某些预定规则（例如排序，结果始终是排序列表，但您可以将实际排序推迟到冒泡排序或快速排序种类）。

干杯。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-23T02:47:18.303

OO 设计的核心原则之一是“偏好组合优于继承”，因此建议偏好策略模式。这显然取决于您在特定情况下要完成的工作。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-02-11T19:19:50.330

我的总结：策略模式比模板方法模式耦合更松散，这通常是一件好事。

Robert C. Martin 在[模板方法和策略：继承与委托](http://staff.cs.utu.fi/%7Ejounsmed/doos_06/material/TemplateAndStrategy.pdf)

> 因此，STRATEGY 模式比 TEMPLATE METHOD 模式提供了一个额外的好处。模板方法模式允许通用算法操作许多可能的详细实现，通过完全符合 DIP，策略模式还允许每个详细实现由许多不同的通用算​​法操作。

DIP 是[依赖倒置原则](http://en.wikipedia.org/wiki/Dependency_inversion_principle)：

> A. 高级模块不应该依赖于低级模块。两者都应该依赖于抽象。B. 抽象不应该依赖于细节。细节应该取决于抽象。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-09-30T21:43:10.340

我几乎总是会选择策略，因为客户端代码不依赖于实现，而在模板模式中，实现的一部分保留在抽象类中，抽象类的任何更改都可能需要更改客户端，这通常会导致僵化代码，我们最终告诉开发人员“这比我预期的变化更大”。

但是如果在抽象类中获取通用代码真的很有帮助，我会毫不犹豫地这样做，并尝试让与客户端代码相关的代码远离它

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2016-03-02T06:03:46.753

我更喜欢混合使用两者，将默认实现（来自模板模式）转储到策略模式的上下文类中。这样，我可以强制用户调用我希望他们调用的方法，以便算法步骤的执行顺序保持可控。

```
 /**
 *  enables replaceable steps in algorithm
 */
public interface HouseStrategy{
      void buildWalls();
      void buildPillars();
}

public class HouseContext{

    //public API that enforces order of execution
    public void build(HouseStrategy strategy){
        buildFoundation();//default implementation
        strategy.buildPillars();//delegated to concrete strategy
        strategy.buildWalls();//delegated to concrete strategy
        buildWindows();//default implementation
    }

    //default implementation
    private void buildWindows() {
        System.out.println("Building Glass Windows");
    }
    //default implementation
    private void buildFoundation() {
        System.out.println("Building foundation with cement,iron rods and sand");
    }

}

public class WoodenHouse implements HouseStrategy {

    @Override
    public void buildWalls() {
        System.out.println("Building Wooden Walls");
    }

    @Override
    public void buildPillars() {
        System.out.println("Building Pillars with Wood coating");
    }

}

public class GlassHouse implements HouseStrategy {

    @Override
    public void buildWalls() {
        System.out.println("Building Wooden Of glass");
    }

    @Override
    public void buildPillars() {
        System.out.println("Building Pillars with glass coating");
    }

} 
```

正如我们所看到的，具体的策略仍然可以扩展。如中，

```
public class GlassHouse implements HouseStrategy,EarthquakeResistantHouseStrategy{......} 
```

用途

```
HouseContext context = new HouseContext();

    WoodenHouse woodenHouseStrategy = new WoodenHouse();
    context.build(woodenHouseStrategy);

    GlassHouse glassHouseStrategy = new GlassHouse();
    context.build(glassHouseStrategy); 
```

我在这里看到的一个缺点是具体策略只能改变算法的变体行为，即 buildWalls() 和 buildPillars()。如果我们需要更改不变部分，即 buildFoundation() 和 buildWindows()，我们需要创建另一个 Context 类来实现新行为。尽管如此，我们还是得到了一些纯策略模式中没有的代码可重用性:-)

# .net - .Net ORM 与 MySQL 配合得很好

> ID：672099
> 
> 赞同：6
> 
> 时间：2009-03-23T02:56:19.700
> 
> 标签：.net, mysql, orm

我的 C# Windows 服务（它是服务，而不是 MVC Web 应用程序！）需要与 MYSQL 数据库通信。为了减轻我的数据层工作，我正在考虑为此目的使用 ORM。

那么哪个 .Net ORM 最适用于 MYSQL 数据库？[休眠](http://www.hibernate.org/343.html)？[亚音速](http://subsonicproject.com/)？[实体框架](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx)？LINQ2SQL？还是其他人？

**编辑：我使用.Net 3.5**

**编辑 2：首选开源解决方案。**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T03:11:52.817

我完全有偏见，但我会去 NHibernate。通过一些调整，我已经设法让相同的 DAL 代码与 Access（用于 CD 交付）、Sql Server（用于企业）和 MySql（为了它的笑声）一起工作。这是几年前的事了，我确实必须确保字段/表名称在所有环境中都有效。除了 NHibernate 完成了其余的工作 - 很棒。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-01-18T10:13:15.237

我不敢相信没有人提到[Rob Conery](http://blog.wekeroad.com/)的[SubSonic](http://subsonicproject.com/)！！这应该是所有 ORM 用户都需要学习的。当然 NHibernate 有它的支持者、很棒的[教程](http://www.summerofnhibernate.com/)和很多优点。但是 Subsonic 也会自动为您生成 DAL，并将您留给业务层、测试和表示层的业务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T03:01:33.870

我更喜欢[LLBLGen](http://www.llblgen.com)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T03:11:02.520

对于 mysql 细节，NHibernate 在 mysql 中有一个零值日期的小问题。因为我只将它与 MSSQL 和 postgres 一起使用，所以我不知道它是否有什么可担心的。

如果您有使用 Hibernate 或其他来自 Java 或其他语言的 ORM 的经验，NHibernate 或 ActiveRecord（基于 NHibernate）会感到非常熟悉。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-23T03:11:58.713

对于分层开发，我会远离实体框架或 LINQ to SQL。话虽如此，我还没有尝试过 LLBLGen 或 NHibernate。

# c# - 为什么没有非整数枚举？

> ID：672102
> 
> 赞同：6
> 
> 时间：2009-03-23T03:02:24.460
> 
> 标签：c#, enums, language-design

为什么不能创建非整数枚举？我想知道这是否是语言设计决定，或者在编译器中实现它是否存在问题。

换句话说，在语言中实现非整数枚举是否可行，但没有正当的需要？或者，如果它不可行但合理，那么有什么障碍？

有人告诉我在 C# 中没有这个功能的原因或理由是什么，非常拜托。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-23T03:17:19.417

没有技术原因不能完成，但是，我们实际上更多地谈论一组常量（如果它们相关，可能在一个公共命名空间内）。

在枚举中，数值通常是次要的。

在下面的：

```
enum Fruit {
  Apple,
  Orange,
  Pear,
  Peach
} 
```

我们只是描述一组命名常量。我们是说 Fruit 类型的变量可以采用这四个值之一。每一个的整数值是什么，真的不相关。只要我只是通过名称来引用它们，代表 Apple 的值是 0、1、32、-53 还是 0.002534f 都没有关系。

大多数语言确实允许您指定应该代表每种语言的值，但这实际上是次要的。它有时很有用，但它不是枚举核心目的的一部分。它们只是为您提供一组相关的命名常量，而无需为每个常量指定一个整数 ID。

此外，枚举通常用于指定可以与按位运算结合的可选标志。如果每个值都由一个整数表示（那么您只需要选择一个使用您想要的位模式的整数）就可以轻松实现。浮点值在这种情况下没有用。（按位和/或运算对浮点值没有多大意义）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-23T03:19:51.953

我认为枚举是这样制作的，因为与您想要做的相反，**枚举并不意味着包含任何有意义的数字表示**。

例如，枚举非常适合描述 ff：

```
enum Color
{
   Black,
   White,
   Red,
   Yellow,
   Blue,
   //everything else in between
} 
```

（诚​​然，颜色可以用数字表示复杂类型，但暂时放纵我）。心情怎么样？

```
enum Mood
{
    Happy,
    Giddy,
    Angry,
    Depressed,
    Sad
} 
```

还是味道？

```
enum Taste
{
    Bitter,
    Salty,
    Sweet,
    Spicy
} 
```

我认为你说对了。底线是：枚举旨在表示难以用数字表示的对象或对象特征，或者没有有意义或实用的数字表示 - 因此任意分配给整数是最方便的数据类型。

这与假期之类的东西相反，后者在*数字上是有意义的*。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-23T03:17:53.177

只有语言的设计者可以告诉你为什么他们不允许非整数枚举，但我可以告诉你最可能的解释。

最初的 C 没有这样做，因为它对于它的目的（一种系统编程语言）来说是不必要的。C++ 没有这样做，因为它是基于 C 的，无论如何你都可以用类来模拟它。出于同样的原因，C# 可能不会这样做。

这只是我的猜测，因为我没有参与任何这些语言的设计。

一旦你决定走上课的路（DateTime），就没有理由不一路走下去。如果要使用枚举，可以将枚举创建为从零开始的连续整数，并使用这些枚举作为索引来创建一个 DateTime 值数组。

但是我只有一个 Holiday 类，它在类中提供了整个工具包和 kaboodle：常量、基于这些常量返回 DateTime 的 get() 例程等等。

这为您提供了真正的封装以及完全更改实现而不影响接口的能力。为什么要抛弃 OOP 的好处之一？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T03:17:55.280

在不知道实际答案的情况下，我建议更多的是后者——没有真正正当的需要。

在我看来，枚举只是代表特定情况下可用的各种选项；不实际存储数据。

不应将保存枚举值的变量视为保存值 1 或 2 或 3，即使这些是存储在该内存位置中的实际值。它应该被认为是代表星期一、星期二或星期三（例如）。它仅在该枚举方面具有意义，并且确实不应该（尽管经常这样做）以其他方式使用。您对 Enum 值执行的操作只是通过实现 Enum 的方式提供的编程快捷方式。

# visual-studio - 如何让代码窗口在 Visual Studio 2008 中垂直拆分？（不是 HTML 模式）

> ID：672110
> 
> 赞同：31
> 
> 时间：2009-03-23T03:09:00.777
> 
> 标签：visual-studio, visual-studio-2008, ide

在 Visual Studio 2008 中，似乎**Window -> Split**只给了我一个水平拆分，而**Window -> New Horizo​​ntal tab group**不允许我在两个窗格中编辑同一个文件。

请注意，我说的是 C# 代码窗口，**而不是**HTML 编辑模式。

我想在两个水平排列的窗格中编辑同一个文件。

这可能吗？免费的插件很好。

**编辑：**我安装了 CodeRush Express，它似乎对我的代码窗口边框做了*一些事情。*

**编辑#2：**这不是 CodeRush。我在没有 CodeRush 的 VM 上尝试过，我遇到了完全相同的问题。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-03-23T05:26:05.567

好的，我在[这里](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=344036)找到了解决方案。

答案是：

1.  窗口 -> 新窗口
2.  窗口 -> 新建垂直选项卡组

这将复制当前选项卡，因此您将获得`[Form1.cs:1]`和`[Form1.cs:2]`选项卡；然后您**可以**使用垂直选项卡组并排查看它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T03:28:13.650

我相信这不是 CodeRush 的错。vanilla 2008 安装只允许您使用顶部一个文件和底部一个文件进行拆分视图。唯一的并排选项是水平选项卡组功能（问题是只有一个文件在其中一个中打开，正如您所提到的。）

显而易见的解决方法是在别处制作文件的只读副本并在一个选项卡组中使用它，或者打开第二个 VS 实例。它确实可以很好地处理在其他应用程序中更改的文件，因此在两个实例中打开相同的文件不是问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-23T10:25:22.543

在 VS2010 中我找不到垂直选项卡组按钮。解决方法是：

```
1\. Open Fullscreen mode
2\. Click and drag the window to the far right (or left) and it should give  
   you an option to view both windows side by side.
3\. Exit full screen mode and you should now have the ability to click and  
     drag windows between vertical tab groups, and it even now allows you to  
     drag to a new vertical tab group. 
```

不知道为什么你必须先跳到全屏，我似乎记得以前不必这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T03:39:53.857

作为 CodeRush 的一次性开发人员，我怀疑这是否是由 CodeRush Xpress 引起的。我目前正在 Visual Studio 2008 上运行 CodeRush 9.1.0 的最新测试版，并且拆分工作正常。但是，您当然可以尝试卸载 CodeRush Xpress 以查看是否可以解决问题。如果是这样，我建议在 DevExpress 的[点对点论坛上](http://community.devexpress.com/forums/)发帖。

[替代文字 http://diditwith.net/content_images/CRXSplits.png](http://diditwith.net/content_images/CRXSplits.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T17:11:50.780

我喜欢垂直选项卡组选项。唯一困扰我的是我不能将解决方案资源管理器放在两个窗口上（或属性）。我必须在一侧导航并移动屏幕。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-20T20:41:20.117

我发现这个用于 VS 2012 的漂亮附加工具允许您同时比较两个文件并进行更改。

看看[这个](http://visualstudiogallery.msdn.microsoft.com/56f99a33-46b9-4d9e-8145-900aaba9951d)：

# .net - ASP.NET 的 BlogEngine.Net 是否与 Wordpress 相叠加？

> ID：672121
> 
> 赞同：17
> 
> 时间：2009-03-23T03:14:25.837
> 
> 标签：.net, wordpress, blogs, blogengine.net

我对 Wordpress 有点熟悉，也用过一点。有一个巨大的社区，有大量的插件和主题等。BlogEngine.Net 比较好？您会推荐其他 .NET CMS 吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-23T03:28:48.390

与 WordPress 相比，BlogEngine.NET 相对不成熟，社区规模要小得多。这并不是说 BlogEngine 本身就不好，但它绝对是 WordPress 成为主流的利基市场。

至于 .NET **CMS**解决方案，而不仅仅是博客平台，[N2](http://n2cms.com/)和[Graffiti](http://graffiticms.com/)都非常受推崇，并且似乎被广泛采用。它们也都面向比简单的博客更灵活的 CMS，尽管具有类似博客的功能。当然，N2 是开源的，而 Graffiti 是付费产品（尽管价格相当便宜），但两者都做得很好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-23T03:20:03.840

我没有使用 BlogEngine.Net 的经验，但要回答您关于任何其他替代方案的问题，我们使用的是[Sitefinity](http://www.sitefinity.com)，它是一个基于 .Net 的 CMS，并且是高度可定制的。根据我们的经验，它对于非常大的站点存在一些性能问题，但我们仍然对它大体上感到满意。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T03:28:51.480

Wordpress 非常流畅。它很成熟，有大量的模板和插件，管理工具也很棒。安装很简单——即使是在 IIS7/PHP 上。

我主要是一个 .Net 程序员，虽然我也可以使用 PHP（我只是不关心它。）所以，我想说 BlogEngine.Net 可以“叠加”，但我认为从运营来看，Wordpress 依然是领头羊。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T03:30:48.590

我没有亲自使用过它，但我听说过[dasBlog](http://dasblog.codeplex.com/)的好消息，它是一个类似于 WordPress 的开源 .NET 博客。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T03:37:28.150

我认为这取决于对您而言重要的是什么。试试 BlogEngine.net 和 Wordpress。这不是我们的博客，它是你的。我通常会发现使用它大约 1-3 周会弄乱功能，而对我来说感觉最合适的东西效果最好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-27T10:45:39.203

[Atomsite](http://atomsite.net/)是另一种选择，管理界面看起来与 Wordpress 非常相似。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T03:21:28.253

我对 Wordpress 不是很熟悉，但令我印象深刻的是，Wordpress 不仅仅是一个博客引擎，更是一个完整的文档管理解决方案。

所以就我个人而言，我发现“少即是多”我非常喜欢 BlogEngine 的简单性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-08T15:52:20.350

我们正在使用 BlogEngine.Net。是的，它不太成熟，有时社区在线程上有点安静。然而，它写得很好，并使用 ASP.Net 网络表单。我们已将其与我们网站上的个人资料会员资格相结合，效果很好。

但是，需要注意的一件事 - 它从未设计用于网络农场或云。如果您在这里遇到问题，论坛中有一些解决方法可以帮助您......但这并不理想。

编辑也不能拥有自己的博客。很长一段时间以来，它一直是被问到最多的功能。同样，一些用户提供了实现此功能的解决方案，但它会破坏您的升级路径。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-23T04:41:42.543

将 Blogengine 集成到预先存在的 CMS 中也存在问题，以及在同一服务器上拥有多个博客的问题。肯定有一些黑客可以实现这两种方法，但我们认为这不值得，只使用了 wordpress。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-28T03:31:27.133

我经营一个单用户博客和一个 .Net 开发人员。今晚查看 BlogEngine.Net 和 dasblog 后，我将从 WordPress 迁移到 BlogEngine.Net。（关于 Wordpress 没什么好说的，我只想在 .Net 平台上运行）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-01-18T17:51:32.450

我已经广泛使用（在工作和家庭）。BlogEngine 到 Wordpress 就像 Windows 98 到 Mac OSX。是的，他们都做同样的基本事情，但是使用一个会让你有一种灵感/平静的感觉（Wordpress），而使用另一个（BlogEngine）会让你没有灵感和沮丧。这可能很大程度上是由于每个平台的相应社区的规模不平衡——但事实就是如此。在任何情况下，我都被迫在工作中使用 BlogEngine - 但我决定在我的家庭/个人博客中坚持使用 Wordpress。

我知道它永远不会快乐，但我希望有一个 .NET 版本的 Wordpress！

# iphone - iphone应用程序编程：时区的现有plist文件？

> ID：672122
> 
> 赞同：1
> 
> 时间：2009-03-23T03:16:06.893
> 
> 标签：iphone, timezone

是否有列出时区和相应城市的 plist 文件？能够选择几个时区（独立于用户位置/iphone 设置）是我正在编写的应用程序中的一项要求。

我希望我不必将某些现有列表重新格式化为 plist。

谢谢，

麦克风。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T19:54:10.847

有一个 API 可以为您提取所有时区信息。查看 Tableview Suite 示例代码

[http://developer.apple.com/iphone/library/samplecode/TableViewSuite/index.html](http://developer.apple.com/iphone/library/samplecode/TableViewSuite/index.html)

# ruby - Ruby 术语问题：这是同时进行的 Ruby 声明、定义和赋值吗？

> ID：672135
> 
> 赞同：1
> 
> 时间：2009-03-23T03:21:26.787
> 
> 标签：ruby, terminology, declaration, definition

如果我说：

x = "ABC"

这似乎是一个声明、定义和赋值，所有这些都是同时发生的，无论我之前是否在程序中说过关于 x 的任何内容。

它是否正确？

我不确定 Ruby 中用于声明、定义和分配的正确术语是什么，或者由于 Ruby 中的动态类型，这些东西之间是否存在区别。

@tg：关于您的第 2 点：即使 x 在 x = "abc" 语句之前存在，您不能将 x = "abc" 语句称为定义/重新定义吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T03:53:34.743

1.  **声明：** *不*
    。谈论在 Ruby 中**声明**变量是没有意义的，因为在语言中没有任何类似于声明的东西。为编译器设计的语言有声明，因为编译器需要提前知道大数据类型是什么以及如何访问它们的不同部分。 *例如*，如果我在 C 中说：

    ```
    int *i; 
    ```

    然后编译器知道某处为 i 预留了一些内存，并且它与保存指向 int 的指针一样大。最终链接器会将所有引用挂钩`i`在一起，但至少编译器知道它在某个地方。

2.  **定义：** *大概*。
    定义通常为某些**东西**设置一个初始值（至少在熟悉的编译语言中）。如果`x`在语句之前不存在`x = "abc"`，那么我想您可以将其称为定义，因为那是 Ruby 必须为 symbol 赋值的时候`x`。

    不过，同样，*定义*是人们通常用来区分对某个变量的初始静态赋值与该变量的声明的特定术语。在 Ruby 中，您没有那种声明。如果变量在当前范围内的某处被分配了一个值，您通常只会说它已*定义*，如果没有，您会说它是*未定义*的。

    您通常不会谈论它有一个*定义*，因为在 Ruby 中这只是*赋值*。没有特殊的上下文可以证明您可以像其他语言一样使用*定义。*

    这让我们...

3.  **作业：** *是的。*
    您绝对可以称其为**赋值**，因为它为符号赋值`x`。我认为没有人会不同意这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T03:53:09.643

差不多。如果，在下一行，你这样做：

```
x = 1 
```

然后你刚刚*重新定义*了它，并分配了它（它现在是一个整数，而不是一个字符串）。Duck 打字与您可能习惯的打字非常不同。

# installation - 为 Web 部署购买或构建？

> ID：672138
> 
> 赞同：8
> 
> 时间：2009-03-23T03:22:12.197
> 
> 标签：installation, wix, windows-installer, clickonce, web-deployment

我一直在评估可用于 Windows 应用程序的各种安装和 Web 部署解决方案。我将在这里澄清一下（没有太多细节，这些工具已在其他问题中介绍过）我对选项的理解：

*   [NSIS](http://nsis.sourceforge.net/Main_Page) - 生成安装可执行文件的免费工具。小二进制。专门的，有时是迟钝的脚本语言。
*   [Inno Setup](http://www.innosetup.com/isinfo.php) - 安装可执行文件的免费工具。各种二进制压缩方案。帕斯卡脚本引擎。
*   [WIX](http://wix.sourceforge.net/) - 生成 MSI 二进制文件的免费工具集。XML 定义语言。
*   [WIX ClickThrough](http://wix.sourceforge.net/ctvision.html) - 用于打包、Web 下载和自动更新检测的附加工具（现在是 WIX 核心的一部分）。
*   [InstallShield](http://www.acresso.com/products/is/installshield-overview.htm) - 用于安装打包的商业开发环境。生成 MSI 二进制文件。类 C 的 InstallScript 语言。
*   [Wise](http://www.symantec.com/business/wise-installation-studio) - 用于安装打包的商业开发环境。生成 MSI 二进制文件。
*   [ClickOnce](http://msdn.microsoft.com/en-us/library/t71a733d(VS.80).aspx) - Visual Studio 支持的框架，用于将应用程序发布到 Web 服务器，并自动检测更新。不支持自定义安装要求（INI 文件、注册表等...）。软件包设置为 MSI 二进制文件。
*   [Install Aware](http://installaware.com/) - 用于安装的商业开发环境。生成 MSI 二进制文件。自动更新框架（Web 更新）。

如果我遗漏了任何内容，请告诉我。

并在 StackOverflow 上找到了一些关于这些技术的有用讨论：

*   [最佳简单安装系统](https://stackoverflow.com/questions/23836/what-is-the-best-simple-install-system-for-xp-vista)
*   [Windows 安装程序的最佳选择](https://stackoverflow.com/questions/3767/what-is-the-best-choice-for-building-windows-installers)
*   [ClickOnce 的替代品](https://stackoverflow.com/questions/623418/what-alternatives-are-there-to-clickonce)

我使用过其中一些解决方案，以及少数专有的内部安装解决方案。他们主要关心打包安装并为开发人员提供访问运行时环境的框架。随着对 Web 部署和自动软件更新的需求不断增长，我希望在开发人员之间就软件和后续更新的 Web 交付框架达成更多共识，但我还没有真正找到共识。当然有可用的解决方案（ClickOnce、ClickThrough、InstallShield 更新服务），但它们都有相当大的限制（如果我错误地陈述了其中任何一个，请纠正我）。我会对提供以下一些功能的框架感兴趣：

*   第三方托管/更新管理。
*   访问客户端环境（INI 文件、注册表等）。
*   用户注册/激活。
*   反馈/错误报告

这给我留下了深刻的印象，即解决 Web 部署问题的最佳方法是通过定制构建的专有解决方案（可能利用现有的安装程序包）。我已经看到这种解决方案适用于许多成功的应用程序：

*   FileZilla - 对 update.filezilla-project.org 的 HTTP 请求以检查更新，下载 NSIS 二进制文件（我认为），然后关闭以运行安装。
*   大型多人游戏的自动更新是完全必要的，并且使用专有系统普遍实施。

所以，最后，我的问题：

*   我是否错过了可以提供所需功能的 Web 部署框架？
*   我的要求是否过于具体而无法合理地期望第三方框架能够提供？
*   我应该购买还是建造？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-08T00:42:13.770

我会敦促对 Installaware 保持谨慎。我们最近在他们的客户支持方面获得了令人震惊的体验。

我们跟踪了他们的一个示例项目，结果惨遭失败。向客户支持提出了一张支持票，并被告知要花费 199 美元让他们查看修复自己的代码。

然后，我们在用户论坛中提出了同样的问题，并立即被禁止，因为这构成了交叉发布，是不允许的。即使他们的条款和条件中没有提到这一点。事实上，他们禁止了我们的 IP，所以我们公司的任何人都不能在论坛上发帖。

一次非常糟糕的经历，我们不会重复。我们现在希望尽快更换 Installaware。

购买 Installaware，后果自负。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-09-16T19:11:07.283

绝对同意说远离 InstallAware 的海报。他们长期以来一直存在非常荒谬的道德问题，并且他们对待自己的客户非常糟糕。他们可以是彻头彻尾的辱骂和侮辱。

当心安装意识！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-09-30T17:56:07.333

我完全同意 InstallAware。

在使用了 WiX、NSIS 和 InstallAware 之后，我不得不谦虚地承认，对于我作为软件开发人员真正需要的东西来说，它们都太过分了。到目前为止，我所做的所有项目都无法使用 Visual Studio 部署项目进行部署。

有限制吗？是的。

学习使用也*很简单。*此外，您实际上*可以通过使用*[此处](http://69.10.233.10/KB/install/dotnetpatching.aspx?fid=209224&df=90&mpp=25&noise=3&sort=Position&view=Quick)描述的技术自动创建*补丁*（.MSP 文件）等非常巧妙的事情

我完全理解您无法在 Visual Studio 安装项目中完成*所有*工作，但您*能*完成的工作令人惊讶。它是免费的，很简单，坦率地说，与花费无休止地学习 WiX 令人难以置信的 XML（尽管令人印象深刻）或 InstallAware 的冗长脚本相比，一般用途是一个更好的选择......

使用 VS Setup，它是拖放和构建和部署。我尝试过的所有其他解决方案都遇到了挫折......他们无法自动检测您的项目输出......或者需要特殊的过滤器以免包含来自构建的不需要的输出。

因此，我的建议是：如果您只是希望部署您的项目，那么请学习：

1.  如何构建自定义安装程序类，以及
2.  如何编写自己的必备包

这些都是相当容易掌握的技能，并且可以满足大多数开发人员的需求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T03:39:59.643

*   如果您的特定要求是您业务的核心；即，您的业务的一部分是提供流畅且用户友好的部署/安装，并且您觉得没有可用的部署库可以让您实现这一点，那么当然可以继续构建您自己的。
*   如果您的特定要求很好，但它们并没有成为您业务的重要组成部分；即最终用户通常不会期望或需要顺利的安装过程，或者永远不需要自己这样做（即他们将这一步骤传递给他们的 IT 部门），那么需要构建自己的只是为了满足您自己的特定要求是可能会被所涉及的额外努力所抵消。

我认为您需要定制解决方案的印象是正确的。似乎您的要求将成为产品体验的关键，特别是如果您需要真正流畅的自动更新和反馈。

# c# - 访客模式，无需强制转换

> ID：672141
> 
> 赞同：3
> 
> 时间：2009-03-23T03:24:01.833
> 
> 标签：c#, design-patterns, visitor-pattern

我有一个关于访客模式的问题，我目前有两个程序集。我的第一个程序集包含几个接口。

```
public interface INode
{
    void Visit(INodeVisitor visitor);
}

public interface INodeVisitor
{
    void VisitContainer(IContainer container);
}

public interface IContainer : INode
{
} 
```

我的第二次集会

```
 class Program
{
    static void Main(string[] args)
    {
        ContainerVisitor visitor = new ContainerVisitor();
        visitor.VisitContainer(new Container());
    }
}

public class ContainerVisitor : INodeVisitor
{
    public void VisitContainer(IContainer value)
    {
        Container container = value as Container;
        // Do some stuff...
    }
}

public class Container : IContainer
{        
    public void Visit(INodeVisitor visitor)
    {
        visitor.VisitContainer(this);
    }
} 
```

我想要做的是避免需要在 ContainerVisitor 类中进行转换，我想直接引用 Container。我无法将接口 INodeVisitor 接口更改为使用 Container。有任何想法吗？我应该投吗？

干杯

罗汉

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T03:47:58.563

演员表是不可避免的，但您可以将其抽象出来以将其从实际的 ContainerVisitor 类中删除。

```
public class NodeVisitor<T> : INodeVisitor where T : IContainer {
  public void VisitContainer(T node) {
    var container = node as T;
    if ( container != null ) { 
      VisitTyped(container);
    }
  }
  protected abstract VisitContainerTyped(T container);
} 
```

现在 ContainerVisitor 可以从 NodeVisitor 派生并避免强制转换

```
public class ContainerVisitor : NodeVisitor<Container>{
    protected override void VisitContainerTyped(Container container){
        // Do some stuff...
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T05:27:45.157

我认为假设它是一个实例是不*正确的。*`Container`我可以完全有效地编写自己的`IContainer`实现，而您的实现会扼杀它，从而打破基于接口的抽象的全部要点。您也不能（有效地）将 API 更改为接受`Container`（使用显式实现来支持`IContainer`），因为我可能使用的是接口而不是类：

```
INodeVisitor visitor = new ContainerVisitor();
visitor.VisitContainer(myBespokeContainer); 
```

如果您想对基类中的某些内容提供可选支持，那么您将不得不使用“as”来检测它。其他任何事情，你都在打破抽象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T07:05:53.253

除非您可以更好地定义您的 IContainer 接口，否则您将无法避免强制转换。正如 Marc 所说，这违背了基于接口的抽象的目的。

```
public interface IContainer : INode
{
    void Add(IComponent component);
    void Add(IComponent component, string name);
    void Remove(IComponent component);
    ComponentCollection Components { get; }
} 
```

使用定义更好的 IContainer，您的访问者将不需要进行任何转换。

```
public class ContainerVisitor : INodeVisitor
{
    public void VisitContainer(IContainer container)
    {
        foreach (IComponent component in container.Components)
        {
            // ...
        }
    }
} 
```

# c# - MVC - 使用 RedirectToAction() 传递数据

> ID：672143
> 
> 赞同：59
> 
> 时间：2009-03-23T03:27:39.593
> 
> 标签：c#, asp.net-mvc, redirecttoaction

我想获取在 MVC 用户表单中输入的数据并将其显示在不同的视图中。

该类具有以下私有变量：

```
IList<string> _pagecontent = new List<string>(); 
```

以下操作接受 FormCollection 对象，对其进行验证，并将其作为列表传递给“预览”视图：

```
[Authorize(Roles = "Admins")]
[ValidateInput(false)]
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult UpdateContent(FormCollection collection)
{
    if (ModelState.IsValid)
    {
        string PageToInsert = collection["PageToInsert"];
        string PageHeader = collection["PageHeader"];
        string PageBody = collection["PageBody"];

        //validate, excluded...

        _pagecontent.Add(PageToInsert);
        _pagecontent.Add(PageHeader);
        _pagecontent.Add(PageBody);

    }
    return RedirectToAction("Preview", _pagecontent);
} 
```

预览视图具有以下用于传递强类型对象列表的页面指令：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Template.Master" Inherits="System.Web.Mvc.ViewPage<List<string>>" %> 
```

我希望能够使用 Model 对象来获取我的数据，但是我不能。在下一行，我得到一个`error index out of bounds`异常，指出索引必须是非负的并且小于集合的大小：

```
<% if (Model[0].ToString() == "0") { %> 
```

并且在 URL 中添加了一些奇怪的参数，因为它解析为 `http://localhost:1894/Admin/Preview?Capacity=4&Count=3`

所以我有两个问题：

1.  当我调用 RedirectToAction 并将它传递给我的列表时，为什么它在视图的模型对象中无法访问？
2.  做我想做的事情的正确方法是什么，即将字符串集合传递给视图以在那里显示？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-03-23T03:51:19.913

尝试使用 TempData。它就像一个单次会话对象。您将所需的值放入 TempData，立即重定向并将它们取出。这里有一篇很好的文章：http: [//blogs.teamb.com/craigstuntz/2009/01/23/37947/](http://blogs.teamb.com/craigstuntz/2009/01/23/37947/)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-25T19:24:21.877

使用 TempData 时要小心。它在单个服务器环境中运行良好，但在云环境中它可能无法按预期运行，因为您不能保证请求会到达同一台机器。这是因为 TempData 依赖于 asp.net 会话。但是，如果您使用 SQL 或 AppFabric Cache 等其他会话管理器，它将正常工作。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-23T21:43:23.737

RedirectAction 的第二个参数是 routeValues，而不是模型。

```
protected internal RedirectToRouteResult RedirectToAction(string actionName, object routeValues); 
```

尝试对模型使用 TempData。它用于在重定向之间保留数据。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-23T03:35:38.780

RedirectToAction 的问题在于它返回了一个 HTTP 302，然后浏览器就会自行执行一个全新的 HTTP 请求。您可能需要考虑使用 cookie 和/或会话对象在请求之间保留数据。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-07-24T13:06:37.200

这不起作用，因为 RedirectToAction 实际上是将 Http 302 发送回浏览器。当浏览器收到这个 302 时，它会向服务器发出一个新请求，请求新页面。新请求，新临时变量。

当您尝试保存/编辑/删除某些内容并且由于某种原因您拒绝它并且您必须再次返回旧表单时，您也会遇到这个问题。

所以，而不是：

```
return RedirectToAction("Preview", _pagecontent); 
```

将预览逻辑放在一个单独的方法中，然后调用它：

```
return PreviewLogic(_pagecontent); 
```

您也可以像其他人所说的那样使用 TempData[] dic 为下一个请求保留数据，但是您将无法避免到服务器的 302 额外往返。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-23T15:33:04.780

听起来您正在尝试这样做：

```
public ActionResult UpdateContent(FormCollection form) {
    ...
    return View("Preview", _pagecontent);
} 
```

请注意，重定向应该是浏览器的“干净的石板”（除了 auth cookie 之类的东西）。您不必告诉浏览器将信息传递给下一个请求，因为下一个请求应该能够独立存在。您所要做的就是告诉浏览器接下来要请求哪个 URL。在 ASP.NET MVC 中，当您将 arguments-object 传递给 时`RedirectToAction`，该对象的公共属性将作为查询字符串参数附加到生成的 URL。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-05T17:36:19.453

您不能只制作 2 个具有相同名称的操作结果并用 HttpPost 标记其中的 1 个吗？

```
 public ActionResult UpdateContent(FormCollection preview = null)
    {
        return View(preview);
    }
    [HttpPost]
    public ActionResult UpdateContent(FormCollection collection = null, bool preview = false)
    {
        if (preview)
            return UpdateContent(collection);
        else
            return UpdateContent(null);
    } 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-03-23T14:59:52.770

看起来您正在寻找 UpdateModel 命令：

查看 ScottGu 关于该主题的博客文章：

[改进的 UpdateModel 和 TryUpdateModel 方法](http://weblogs.asp.net/scottgu/archive/2008/10/16/asp-net-mvc-beta-released.aspx#four)

# c# - 第三次调用后 HttpWebRequest 失败

> ID：672147
> 
> 赞同：0
> 
> 时间：2009-03-23T03:28:54.397
> 
> 标签：c#, httpwebrequest

这是我的方法：

```
private static void UpdatePref(List<EmailPrefer> prefList)
{
    if(prefList.Count > 0)
    {
        foreach (EmailPref pref in prefList)
        {
            UpdateEmailRequest updateRequest = new UpdateEmailRequest(pref.ID.ToString(), pref.Email, pref.ListID.ToString());
            UpdateEmailResponse updateResponse =(UpdateEmailResponse) updateRequest.SendRequest();

            if (updateResponse.Success)
            {
                Console.WriteLine(String.Format("Update Succsesful.  ListID:{0}  Email:{2}  ID:{1}", pref.ListID, pref.Email, pref.ID));
                continue;
            }
            Console.WriteLine( String.Format("Update Unsuccessful.  ListID:{0}  Email:{2}  ID:{1}\n", pref.ListID, pref.Email, pref.ID));
            Console.WriteLine(String.Format("Error:{0}", updateResponse.ErrorMessage));
        }

        Console.WriteLine("Updates Complete.");
    }
    Console.WriteLine("Procses ended.  No records found to update");
} 
```

该列表有大约 84 条有效记录，它正在循环并发送 API 请求。但它在第 3 次 API 调用时停止，仅处理 84 条记录中的 2 条。当我调试以查看发生了什么时，我只看到它在我的 SendRequest 方法中停止，而没有吐出任何错误。它在 GetRequestStream 处停止，当我走到那里并尝试继续前进时，它就停止了，我的应用程序停止运行而没有任何错误！

```
HttpWebRequest request = CreateWebRequest(requestURI, data.Length);
request.ContentLength = data.Length;
request.KeepAlive = false;
request.Timeout = 30000;

// Send the Request
requestStream = request.GetRequestStream(); 
```

什么？最终，如果我让它继续运行，我确实会收到错误“操作已超时”。但是，为什么前 2 个调用通过而这个超时呢？我不明白。

另外，第二个问题。让它在我的 foreach 中创建一个新对象用于发送和接收是否效率低下？但这就是我删除这些类的方式，并要求电子邮件、ListID 等是发送该类型 API 调用的必要条件。我只是不知道通过 foreach 中的每次迭代创建一个新实例是否有效。可能很常见，但对我来说只是觉得奇怪和低效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T04:17:03.297

编辑：看来你已经在评论中回答了你自己的问题。

我没有这方面的个人经验，但在您获取响应后，您似乎需要在 HTTP Web 请求上调用 close 。打开的连接数限制为 2，并且在您关闭（）之前不会释放连接。请参阅[http://blogs.msdn.com/feroze_daud/archive/2004/01/21/61400.aspx](http://blogs.msdn.com/feroze_daud/archive/2004/01/21/61400.aspx)，它提供了以下代码来演示您所看到的症状。

```
 for(int i=0; i < 3; i++) {
       HttpWebRequest r = WebRequest.Create(“http://www.microsoft.com“) as HttpWebRequest;
       HttpWebResponse w = r.GetResponse() as HttpWebResponse;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T04:01:37.813

它超时的一种可能性是您正在与之交谈的服务器正在限制您。您可以尝试在每次更新后插入延迟（可能是一秒钟？）。

假设`UpdateEmailRequest`and`UpdateEmailResponse`以某种方式分别从`WebRequest`and派生而来`WebResponse`，那么以您的方式创建请求并不是特别低效。这很标准。但是，请注意，这意味着它可能分配了非托管资源，您应该通过调用该方法来处理`WebResponse`它。像这样的东西：`IDisposable``Dispose`

```
UpdateEmailResponse updateResponse =(UpdateEmailResponse) updateRequest.SendRequest();
try
{
    if (updateResponse.Success)
    {
        Console.WriteLine(String.Format("Update Succsesful.  ListID:{0}  Email:{2}  ID:{1}", pref.ListID, pref.Email, pref.ID));
        continue;
    }
    Console.WriteLine( String.Format("Update Unsuccessful.  ListID:{0}  Email:{2}  ID:{1}\n", pref.ListID, pref.Email, pref.ID));
    Console.WriteLine(String.Format("Error:{0}", updateResponse.ErrorMessage));
}
finally
{
    updateResponse.Dispose();
} 
```

我想有可能不处理响应对象会保持与服务器的打开连接，并且服务器超时，因为您有太多打开的连接。

# java - 如何在 GRAILS 中从 src/java 访问域类？

> ID：672149
> 
> 赞同：0
> 
> 时间：2009-03-23T03:29:58.840
> 
> 标签：java, grails

如何从 Grails 中的控制器访问或更好地将一堆域类传递给驻留在 grails 树中的 src/java 中的非常简单的 java 程序？我总是得到域类的 ClassNotFoundException，无论我将它们放在哪个包中。尝试使用 Eclipse 导入域类时，没有指向域类的自动完成。

我只想将 grails 用作原型前端，以便为我的 java 应用程序输入和输出。因此，欢迎任何快速且不那么肮脏的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T23:03:16.460

我只需将路径添加`%userprofile%\.grails\<grails-ver>\projects\<my-project>\classes`到系统类路径即可自行解决。现在一切都按预期工作。

奇怪的问题，可能我在设置 grails、Eclipse 等时错过了一些东西......

感谢大家 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T05:33:49.650

您可能需要详细说明如何运行应用程序，以提供有关类加载器的一些想法，以及为什么您的 java 应用程序中的类加载器没有找到类。

对此的架构观点是，您最好使用 Grails 服务来访问您的后端应用程序。如果您在控制器中声明名为 xxxService 的属性，您将获得一个注入到控制器中的服务实例，然后您可以使用它来调用所需的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-25T21:07:04.973

[http://www.grails.org/FAQ#Q：如何从 src/groovy 中的源访问域类？](http://www.grails.org/FAQ#Q%3a%20How%20can%20I%20access%20domain%20classes%20from%20sources%20in%20src/groovy?)

# jquery - jquery 验证尚未创建的元素

> ID：672155
> 
> 赞同：6
> 
> 时间：2009-03-23T03:36:47.560
> 
> 标签：jquery, validation, jquery-validate

我想知道在最初设置规则时是否可以让 jQuery Validator 插件验证 dom 中尚不存在的元素。

调用 .Rules("add", therules) 方法只会将规则附加到 dom 中当前存在的元素上。如果我要创造一些。验证不会触发。有什么想法吗？

我正在使用的验证器主页：http: [//bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

正在通过[http://ejohn.org/blog/javascript-micro-templating/创建新元素](http://ejohn.org/blog/javascript-micro-templating/)

基本上有一个ajax调用，服务器返回一堆json（ajaj？），这个json由resig的模板引擎提供。示例模板如下所示：

```
<script type="text/html" id="ProductsTemplateEdit">
    <td>
        <input type="hidden" value="<#= item.ID #>" id="Edit.ID" name="Edit.ID" />
        <input type="text" value="<#= item.Price#>" id="Edit.Price" name="Edit.Price" />
    </td>
</script> 
```

这些值显然是通过传入的 json 填充的。

我还应该提到我正在使用 xval 验证框架，它基本上会自动为我生成 jquery 验证规则：http: [//blog.codeville.net/2009/01/10/xval-a-validation-framework-for- aspnet-MVC/](http://blog.codeville.net/2009/01/10/xval-a-validation-framework-for-aspnet-mvc/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T04:10:09.227

好吧，试试两个。什么是动态添加元素？你不能把 .Rules("add", ) 放到同一个代码中吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-15T20:18:11.407

嘿，不确定这是否是不礼貌的黑客行为，但它对我有用。在此之前，我在选择器上执行 each() 并遇到与新创建的 Ajaxed 元素相同的问题。

现场的鼠标悬停事件似乎已经成功了，当然你不会对你的 css 感到疯狂：

```
// >>> MSG/Comment form validator, now and forever...  
    $('form.streamForms').live('mouseover', function(){
        $(this).validate({
            rules: {
                text: "required"

            },
            messages: {
                text: " "
            }
        });    
    }); 
```

希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T03:38:32.407

你会想看看 jQuery 1.3 的新[Live Events](http://docs.jquery.com/Events/live)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-30T17:43:58.890

以下是我的处理方式。首先我创建了我的验证对象。

```
    var myvalidations = {};
    myvalidation.registerform = function() { $("#registerform").validate({
            提交处理程序：函数（表单）{
                $(form).ajaxSubmit(optionspersonal);
                //提交注册（）；
            },
                    规则：{
                名： {
                     要求：真，
                     最小长度：5，
                     最大长度：22
                },
                    消息：{
                             名： {
                                 必需：“告诉我们如何称呼您。”,
                     minlength: "您的用户名必须至少包含 5 个字符"
                             }
                     }
             });
        }

```

现在，每当您创建表单时，请确保它上面有一个 ID 或在某种程度上可以引用它，并在创建它后立即调用您的函数。

```
    //创建我的内容
    $('.content').html('--fields etc--');
    //添加验证
    myvalidation.registerform();

```

欢迎任何进一步的建议；但我认为基本上这是正确的方法。

# html - 有没有办法编写屏幕阅读器会忽略的内容？

> ID：672156
> 
> 赞同：24
> 
> 时间：2009-03-23T03:36:59.120
> 
> 标签：html, css, accessibility

我刚刚在一个页面上工作，该页面需要有视力和视力受损的用户都可以访问。内容的某些元素，只是由于仅与视觉元素相关的性质，根本不适用于使用屏幕阅读器的人。例如，一个链接在一个新窗口中打开了一个视听演示文稿，但由于我无法控制的情况，窗口的大小被调整得很尴尬，所以有一条消息说你应该调整窗口的大小，以便更好地查看所有内容。显然，对于无论如何都看不到的人来说，这是无用的信息。

是否有一种可接受的方式让屏幕阅读器忽略某些内容？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2014-02-10T09:56:20.040

实际上这样做的正确方法是使用 ARIA `role=hidden`。像这样：

```
<button type="button">
  <span aria-hidden="true" class="icon">&gt;</span>
  <span class="hide">Go!</span>
</button> 
```

通过这样做，您隐藏了 > 字符，因此屏幕阅读器不会读取“右尖括号”，而是读取“Go！”。如果您在视觉上隐藏 .hide 类中的内容，有视力的用户只会看到 >。像这样：

```
.hide{
  position: absolute;
  left:-999em;
} 
```

ARIA 角色`presentation`用于“规范化”语义含义，例如 a `<table>`with`role="presentation"`不会被读取为表格内容，而只是纯文本。

如果您不想读取图像，可以输入如下空`alt`文本：

```
<img src="decorative-flower.jpg" alt=""/> 
```

..或者如果它是一个`<svg>`省略`<title>`和`<description>`

```
<svg>
  <!-- <title>Remove this line</title> -->
  <!-- <description> Remove this too..</description> -->
</svg> 
```

我注意到在一些罕见的情况下，一些屏幕阅读器仍然会阅读空的 alt 图像，所以你也可以`aria-hidden="true"`在这里使用。

此时不支持 CSS 的 speak 属性，链接属性 media="aural" 也是如此。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-03-23T03:38:44.717

写到一半，我记得在哪里看。

CSS 可以做到这一点：

```
<span class="dontRead">Screen readers shouldn't read this</span>

.dontRead {
    speak: none;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-10-10T11:01:47.433

检查这个

```
<h1 role="presentation" tabindex="-1">Some text that screen readers will ignore </h1> 
```

因为**role="presentation"**和**tabindex="-1"**屏幕阅读器会忽略上面的标签。

我在 ie8 和 firefox 3.5 上检查了它，它与 JAWS 屏幕阅读器一起使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-04T14:10:22.753

CSS 具有这些听觉属性，但由于它们没有在任何地方实现，它们完全没用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-10-11T21:24:40.057

对辅助技术用户隐藏特定信息的问题在于，它假设他们在某个黑暗的房间里单独使用您的软件，这根本不是一个安全的假设。许多辅助技术用户与其他用户（与此信息相关）密切合作，一些非常幸运的人甚至拥有助手。明智的做法是为他们淡化或低估这些内容的优先级，而是以某种方式稍后将其放置在文档中。

# c# - App.config - 加密部分错误：

> ID：672157
> 
> 赞同：5
> 
> 时间：2009-03-23T03:37:25.610
> 
> 标签：c#, .net, xml, configuration

我有一个加密配置文件中的部分的应用程序。在我第一次尝试从配置文件中读取加密部分时，我收到一条错误消息：“无法识别属性'configProtectionProvider'。请注意，属性名称区分大小写。”

```
config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);  
// Get the section in the file.   
ConfigurationSection section = config.GetSection("EncryptedSection");

if (section != null)      
{           
    // Protect the section.
    section.SectionInformation.ProtectSection("RsaProtectedConfigurationProvider");
    section.SectionInformation.ForceSave = true;

    // Save the change.

    config.Save(ConfigurationSaveMode.Modified);  
}  
ConfigurationManager.RefreshSection("EncryptedSection");  
Properties.Settings.Default.Reset();

//This is the part where I read the encrypted section:

ConfigurationManager.RefreshSection("EncryptedSection");
System.Collections.IDictionary HSMMasterKeyConfig = (System.Collections.IDictionary)System.Configuration.ConfigurationManager.GetSection("EncryptedSection"); 
```

这只发生在我第一次尝试阅读加密部分时。我注意到 .config 文件在第一次保存后立即更新，但由于某种原因，我需要重新启动应用程序才能使用加密部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T13:17:34.120

你读过这...

[http://bytes.com/groups/net/521818-configurationerrorexception-when-reading-protected-config-section](http://bytes.com/groups/net/521818-configurationerrorexception-when-reading-protected-config-section)

...因为这似乎是涉及直接映射到您的情况的 MSFT 支持工程师的对话。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T16:01:55.940

最好的方法是仅在安装期间加密 app.config 部分。将安装程序类添加到您的项目并覆盖该类中的 Install 方法。在这种方法中，您应该执行加密。您必须在覆盖的 Install 方法结束时调用 base.Install。在安装项目中，转到自定义操作并找到要使用您的项目输出 [exe 或程序集] 指向的安装自定义操作，其中包含您的安装程序类实现的定义。这样，它将在安装过程中直接加密您的 app.Config 部分，您将不会遇到此问题。应用程序将自动使用 DPAPI 提供程序读取/写入部分或设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-04T00:47:58.653

供您参考，问题是尝试加密配置部分的进程没有管理员权限。我将此过程添加到管理员组并解决了它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-23T16:13:13.320

我今天遇到了同样的问题。通常，每当我启动配置加密的应用程序时，我总是在启动时检查配置以确定它是否受到保护。如果不是，我遵循标准的 SectionInformation.ProtectSection 方法。这始终是我的第一步，但今天出于某种原因，我决定在执行保护检查并得到“无法识别的属性'configProtectionProvider'之前从配置中引用一些东西。请注意，属性名称区分大小写。”错误。您所要做的就是在正常代码中引用配置之前运行保护代码，您将不再有错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T11:40:01.047

尝试在单独的应用程序域中运行您的 Exe。在新的 AppDomain 中加载您的应用程序后，检查 Sections 是否已加密。如果不是，则加密该部分并触发 AppDomain 再次卸载并重新加载您的可执行文件。

# payment - 在您刚开始学习的平台上完成的工作的计费道德

> ID：672159
> 
> 赞同：9
> 
> 时间：2009-03-23T03:37:35.607
> 
> 标签：payment, platform, billing

虽然这不适用于我目前的情况，但我相信我们以前都去过那里。您是被要求使用 C# 开发应用程序的 Java 开发人员，或者您是被要求在 ASP.NET MVC 中做某事的 ASP.NET 开发人员，或者是有机会开发 Rails 或 Django 站点的 PHP 开发人员。

从根本上说，如果你是一个称职的程序员，那么这种平台转换应该不是问题。如果有足够的时间，您可以期望变得像在旧平台上一样精通。

但是，如果这是一个客户的自由项目，那么在他们的一角钱上学习这个平台似乎完全不道德吗？假设该客户没有给您无限的时间来完成项目，由于您的经验不足，将会出现妥协和可能的质量问题。

也就是说，你必须从某个地方开始，并不是每个人都有空闲时间来修补新的语言/平台。有时有必要硬着头皮尝试明智地计划事情，然后完成并获得报酬。

这看起来不道德吗？接受较低的利率会使其更合乎道德吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-23T03:39:59.907

如果您透露您的主要专长是在他们雇用您开发的平台以外的平台上，我认为这里没有道德问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-23T03:44:09.710

**假设您按小时计费：**

如果您是一位经验丰富的开发人员，那么您应该能够分辨出由于学习新平台而不是解决手头的问题而花费了您的时间。

跟踪您所做的事情（使用屏幕截图应用程序可能会有所帮助），如果它是纯粹的研究（阅读文章，查找文档），那么不要对其收费。此外，如果您正在修复一个被证明是新手错误的错误（例如误解某些信息），那么不要为此计费。您剩下的时间将花在为客户进行生产性工作上，这应该是计费的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-23T03:42:13.117

这是不言而喻的，但是如果您不知道他们希望您使用的语言/平台，您的客户将决定他们是否愿意与您一起担任顾问，并且他们也将是那些告诉你他们是否会为你“边写代码边学习”付费。您只需要从一开始就对所有事情都坦诚相待。如果您不了解平台/语言，请不要表现得像您了解平台/语言一样。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-23T04:06:20.173

不 - 这不是不道德的。我们的职业要求我们不断地学习新的东西。这就是为什么我们可以期望我们会收取/获得报酬的原因。雇主通常不仅愿意为我们购买书籍，还愿意为认证、研讨会以及我们花在上述扩展学习上的任何时间付费。其背后的合理性是，如果我们学习新东西，不可避免地会为它们带来回报（无论是效率、性能等）。

我怀疑你会争辩说它不同，因为你是自由职业者，所以我会提出一个问题 - 为什么它有任何不同？你的雇主就是你的客户——如果你觉得他们会从所说的平台中获益而不是另一个，那么你就是在为他们提供服务，应该得到相应的补偿。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-23T03:55:30.590

听起来你们都在谈论“时间和材料”项目，无论您花费多少时间来完成工作，客户都会付钱给您。在这样的项目中，我可以看到这是如何发挥作用的，我建议诚实。

我从事的大多数项目都是“固定价格”。客户让我们知道他们想要什么。然后我们制定“固定价格”报价。如果客户不喜欢他们去别处的数字，如果他们对数字没意见，那么他们就同意这个价格。我们是否必须学习一些东西才能完成工作，客户的价格保持不变。在这种情况下没关系。客户要么同意价格，要么不同意，花多少时间都没关系。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T03:49:36.280

我一直在使用 adobe air 遇到这种情况。是的，这并不完全像从 Java 跳到 .NET 或从 PHP 跳到 Python，因为我已经知道 javascript。实际上，我担心我会因为太贵而退出，并为该项目提供了低于保证金的价格。但并不后悔，因为客户非常满意，后来又带着另外 2 个项目回来了。

如果您提供的价格对您的客户来说是可以接受的，并且您绝对确信您可以提供高质量的产品，那么这没有什么不道德的。

# smlnj - smlnj 改写了 listdir(filename, directoryname) 的问题

> ID：672170
> 
> 赞同：0
> 
> 时间：2009-03-23T03:45:43.717
> 
> 标签：smlnj

我是一个学习 sml 的新手，我遇到的问题涉及 IO 函数，即使在阅读之后我也不知道它是如何工作的。这是我真正需要帮助才能开始的 2 个问题，请为我提供编码和一些解释，我将能够使用为其他问题提供的代码进行试验和错误。

Q1) listdir(filename,directoryname)，给出一个目录的名字，在一个文本文件中列出它的内容。该列表的形式可以很容易地将文件名、日期和大小彼此分开。（类似于 msdos 对“dir”所做的操作，但不仅仅是将其列出，而是将所有文件和详细信息放入一个文本文件中。

Q2) readlist(filename) 读取文件名列表（每个文件名由 (Q1) 中的 listdir 生成，并将它们组合成一个大列表。（从 Q1 中的文本文件中读取，然后将内容分配到 1 个包含所有信息）

问题是，我只在介绍部分从学校的讲师那里学到，甚至没有显示系统输入或输出示例，甚至没有教授“使用文件”功能。如果知道 sml 的人看到这个，请帮忙。感谢任何努力帮助我的人。

感谢您的回复，目前我正在使用 SMLNJ 尝试执行此操作。基本上，Q1 要求我将提供的“目录名”的目录文件列出到“文件名”中的文本文件中。Q2 要求我从“文件名”文本文件中读取，然后将内容放入一个大列表中。

重复：[smlnj listdir](https://stackoverflow.com/questions/672065/smlnj-listdir)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T18:32:21.617

作为提示，我会说您必须使用这些功能：

OS.FileSys.OpenDir(directoryname) - 这将为您打开目录流 (Q1) TextIO.openOut(filename) - 这将打开文件流 (Q2)

TextIO.openIn(filename)-这将打开文件（Q2）如果你被卡住并且不知道如何做 progs，那么我会在这里发布完整的代码，但我建议你先试一试。

* * *

祖拜尔酋长

# python - 使用python map等功能工具

> ID：672172
> 
> 赞同：127
> 
> 时间：2009-03-23T03:46:29.410
> 
> 标签：python, dictionary, functional-programming

这很不合时宜，但我正在尝试学习/理解 python 中的函数式编程。以下代码：

```
foos = [1.0,2.0,3.0,4.0,5.0]
bars = [1,2,3]

def maptest(foo, bar):
    print foo, bar

map(maptest, foos, bars) 
```

产生：

```
1.0 1
2.0 2
3.0 3
4.0 None
5.0 None 
```

**问：有没有办法在 python 中使用 map 或任何其他功能工具来生成以下没有循环等的内容？**

```
1.0 [1,2,3]
2.0 [1,2,3]
3.0 [1,2,3]
4.0 [1,2,3]
5.0 [1,2,3] 
```

**顺便说一句，如果 foo 和 bar 之间存在依赖关系，实现将如何变化。例如**

```
foos = [1.0,2.0,3.0,4.0,5.0]
bars = [1,2,3,4,5] 
```

**并打印：**

```
1.0 [2,3,4,5]
2.0 [1,3,4,5]
3.0 [1,2,4,5]
... 
```

**PS：我知道如何使用 if、循环和/或生成器天真地做到这一点，但我想学习如何使用功能工具来实现相同的目标。是否只是将 if 语句添加到 maptest 或在 maptest 内部将另一个过滤器映射应用于条的情况？**

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-03-23T05:11:47.380

你熟悉其他函数式语言吗？即，您是在尝试学习 python 如何进行函数式编程，还是在尝试学习函数式编程并使用 python 作为工具？

另外，您了解列表推导吗？

```
map(f, sequence) 
```

直接等价于 (*)：

```
[f(x) for x in sequence] 
```

事实上，我认为`map()`曾经计划从 python 3.0 中删除是多余的（这没有发生）。

```
map(f, sequence1, sequence2) 
```

主要相当于：

```
[f(x1, x2) for x1, x2 in zip(sequence1, sequence2)] 
```

（它处理序列长度不同的情况有所不同。如您所见，`map()`当其中一个序列用完时填充 None ，而`zip()`当最短序列停止时停止）

因此，为了解决您的具体问题，您正在尝试产生结果：

```
foos[0], bars
foos[1], bars
foos[2], bars
# etc. 
```

您可以通过编写一个接受单个参数并打印它的函数来做到这一点，然后是条形：

```
def maptest(x):
     print x, bars
map(maptest, foos) 
```

或者，您可以创建一个如下所示的列表：

```
[bars, bars, bars, ] # etc. 
```

并使用您的原始地图测试：

```
def maptest(x, y):
    print x, y 
```

一种方法是事先明确构建列表：

```
barses = [bars] * len(foos)
map(maptest, foos, barses) 
```

或者，您可以拉入`itertools`模块。 `itertools`包含许多巧妙的函数，可帮助您在 python 中进行函数式惰性求值编程。在这种情况下，我们想要`itertools.repeat`，它将在您迭代它时无限期地输出它的参数。最后一个事实意味着，如果你这样做：

```
map(maptest, foos, itertools.repeat(bars)) 
```

您将获得无穷无尽的输出，因为`map()`只要其中一个参数仍在产生输出，它就会一直运行。然而，`itertools.imap`就像`map()`, 但在最短的可迭代停止时立即停止。

```
itertools.imap(maptest, foos, itertools.repeat(bars)) 
```

希望这可以帮助 ：-）

(*) 在 python 3.0 中有点不同。在那里， map() 本质上返回一个生成器表达式。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2009-03-23T04:00:28.440

最简单的方法不是`bars`通过不同的功能，而是直接从以下位置访问它`maptest`：

```
foos = [1.0,2.0,3.0,4.0,5.0]
bars = [1,2,3]

def maptest(foo):
    print foo, bars

map(maptest, foos) 
```

使用您的原始`maptest`函数，您还可以在以下位置使用 lambda 函数`map`：

```
map((lambda foo: maptest(foo, bars)), foos) 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-03-23T04:00:28.300

这是您正在寻找的解决方案：

```
>>> foos = [1.0, 2.0, 3.0, 4.0, 5.0]
>>> bars = [1, 2, 3]
>>> [(x, bars) for x in foos]
[(1.0, [1, 2, 3]), (2.0, [1, 2, 3]), (3.0, [1, 2, 3]), (4.0, [1, 2, 3]), (5.0, [
1, 2, 3])] 
```

我建议使用列表理解（`[(x, bars) for x in foos]`部分）而不是使用 map，因为它避免了每次迭代时函数调用的开销（这可能非常重要）。如果你只是打算在 for 循环中使用它，你会通过使用生成器理解获得更好的速度：

```
>>> y = ((x, bars) for x in foos)
>>> for z in y:
...     print z
...
(1.0, [1, 2, 3])
(2.0, [1, 2, 3])
(3.0, [1, 2, 3])
(4.0, [1, 2, 3])
(5.0, [1, 2, 3]) 
```

不同之处在于生成器理解是[延迟加载](http://en.wikipedia.org/wiki/Lazy_loading)的。

**更新** 针对此评论：

> 当然你知道，你不复制酒吧，所有条目都是相同的酒吧列表。因此，如果您修改其中任何一个（包括原始钢筋），您将修改所有这些。

我想这是一个有效的观点。我能想到两种解决方案。最有效的可能是这样的：

```
tbars = tuple(bars)
[(x, tbars) for x in foos] 
```

由于元组是不可变的，这将防止条形图通过此列表推导（或生成器推导，如果您走那条路线）的结果进行修改。如果你真的需要修改每一个结果，你可以这样做：

```
from copy import copy
[(x, copy(bars)) for x in foos] 
```

然而，这在内存使用和速度方面都可能有点贵，所以我建议不要这样做，除非你真的需要添加到它们中的每一个。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-03-23T07:28:29.017

函数式编程是关于创建无副作用的代码。

map 是一个功能列表转换抽象。您使用它来获取一系列事物并将其转换为其他事物的序列。

您正在尝试将其用作迭代器。不要那样做。:)

这是一个示例，说明如何使用 map 来构建所需的列表。有更短的解决方案（我只使用理解），但这将帮助您更好地理解 map 的作用：

```
def my_transform_function(input):
    return [input, [1, 2, 3]]

new_list = map(my_transform, input_list) 
```

请注意，此时您只进行了一次数据操作。现在您可以打印它：

```
for n,l in new_list:
    print n, ll 
```

- 我不确定你所说的“没有循环”是什么意思。fp 并不是要避免循环（您不能在不访问每个项目的情况下检查列表中的每个项目）。这是为了避免副作用，从而编写更少的错误。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-03-23T04:21:19.450

```
>>> from itertools import repeat
>>> for foo, bars in zip(foos, repeat(bars)):
...     print foo, bars
... 
1.0 [1, 2, 3]
2.0 [1, 2, 3]
3.0 [1, 2, 3]
4.0 [1, 2, 3]
5.0 [1, 2, 3] 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-03-23T04:17:28.367

```
import itertools

foos=[1.0, 2.0, 3.0, 4.0, 5.0]
bars=[1, 2, 3]

print zip(foos, itertools.cycle([bars])) 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-03-23T04:24:48.567

以下是函数参数的概述`map(function, *sequences)`：

*   `function`是您的函数的名称。
*   `sequences`是任意数量的序列，通常是列表或元组。 *将同时*`map`迭代它们并将当前值赋予. 这就是为什么序列的数量应该等于函数的参数数量的原因。*`function`*

 *听起来您正在尝试迭代一些`function`' 参数但保持其他参数不变，不幸`map`的是不支持这一点。我发现了一个向 Python 添加这样一个特性[的旧提议](http://mail.python.org/pipermail/python-dev/2003-February/033486.html)，但是地图结构是如此干净和完善，以至于我怀疑这样的东西是否会被实现。

正如其他人所建议的那样，使用全局变量或列表推导等解决方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-23T03:51:03.203

这会做吗？

```
foos = [1.0,2.0,3.0,4.0,5.0]
bars = [1,2,3]

def maptest2(bar):
  print bar

def maptest(foo):
  print foo
  map(maptest2, bars)

map(maptest, foos) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-06T04:11:41.850

这个怎么样：

```
foos = [1.0,2.0,3.0,4.0,5.0]
bars = [1,2,3]

def maptest(foo, bar):
    print foo, bar

map(maptest, foos, [bars]*len(foos)) 
```

# algorithm - 算法应该并行化有哪些提示？

> ID：672180
> 
> 赞同：5
> 
> 时间：2009-03-23T03:53:11.267
> 
> 标签：algorithm, language-agnostic, optimization, concurrency, parallel-processing

到目前为止，我的经验告诉我，即使使用多核处理器，并行化算法也不会总是显着加快速度。事实上，有时它会减慢速度。有哪些好的提示可以通过并行化显着加快算法速度？

（当然，考虑到过早优化的警告及其与邪恶的相关性）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T03:55:06.953

为了从并行化中获得最大的好处，一个任务应该能够被分解成类似大小的粗粒度块，这些块是独立的（或大部分是独立的），并且几乎不需要块之间的数据通信或同步。

细粒度并行化几乎总是会增加开销，并且无论可用物理内核的数量如何，都会有有限的加速。

[对此需要注意的是，那些没有非常大的架构。“核心”的数量（例如连接机器 64,000 个核心）。这些非常适合可以分解为分配给特定拓扑（如矩形网格）的相对简单的动作的计算。]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T03:56:16.780

如果您可以将工作分成独立的部分，那么它可能会很好地并行化。

还要记住[Amdahl 定律](http://en.wikipedia.org/wiki/Amdahl's_law)，它清醒地提醒我们，通过向大多数程序添加更多内核，我们对性能提升的期望是多么少。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T03:55:28.670

首先，查看已故 Jim Gray 的这篇论文：

[分布式计算经济学](http://research.microsoft.com/apps/pubs/default.aspx?id=70001)

实际上，这将根据您在问题中所写的内容消除一些误解。显然，如果你的问题集越难以被离散化，它就越困难。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T04:13:31.433

任何时候你的计算依赖于以前的计算，这不是一个并行问题。线性图像处理、蛮力方法和遗传算法之类的东西都很容易并行化。

一个很好的类比是，你可以做些什么来让一群朋友同时做不同的部分？例如，如果不同的人可以在不同的部分工作，将宜家家具放在一起可能会很好地并行，但滚动墙纸可能不会，因为您需要按顺序制作墙壁。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T04:20:42.040

如果您正在进行大型矩阵计算，例如涉及有限元模型的模拟，这些通常可以直接分解为更小的部分。假设您正在处理非常大的矩阵，则矩阵向量乘法可以很好地从并行化中受益。除非存在导致代码运行缓慢的真正性能瓶颈，否则可能没有必要为并行处理而烦恼。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T03:55:17.547

好吧，如果你需要很多锁才能让它工作，那么它可能是那些不能很好并行化的困难算法之一。算法中是否有任何部分可以分解成不需要相互接触的独立部分？

# python - Django 自定义查询集过滤器

> ID：672182
> 
> 赞同：9
> 
> 时间：2009-03-23T03:53:41.637
> 
> 标签：python, django, django-queryset, generator-expression

在 Django 中，是否有一种标准方法可以为 QuerySets 编写复杂的自定义过滤器？

就像我能写的一样

```
MyClass.objects.all().filter(field=val) 
```

我想做这样的事情：

```
MyClass.objects.all().filter(customFilter) 
```

我可以使用生成器表达式

```
(x for x in MyClass.objects.all() if customFilter(x)) 
```

但这会失去可链接性和 QuerySet 提供的任何其他功能。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-23T12:21:14.913

开始使用管理器方法的建议是一个很好的建议，但要更直接地回答您的问题：是的，使用[Q 对象](http://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)。例如：

```
from django.db.models import Q

complexQuery = Q(name__startswith='Xa') | ~Q(birthdate__year=2000)

MyModel.objects.filter(complexQuery) 
```

Q 对象可以与 | (OR)、& (AND) 和 ~ (NOT)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-23T03:58:12.097

我认为您可能需要自定义[管理器](https://docs.djangoproject.com/en/dev/topics/db/managers/#custom-managers)。

# open-source - 开源政治竞选管理软件？

> ID：672183
> 
> 赞同：9
> 
> 时间：2009-03-23T03:55:01.167
> 
> 标签：open-source

有谁知道任何致力于政治竞选管理软件的活跃开源项目？

我查看了 sourceforge，但没有从“政治”、“政治”、“捐赠”、“运动”或“会计”、“政治”或“投票”类别中看到任何相关内容。

我参与了一项政治运动，该运动目前正在为一些设计糟糕的 SaaS（我猜我应该保护它的名字，咳咳）付出代价，基本上只是跟踪人们现在所做的捐款，人们过去所做的捐款、人们承诺的捐款、联系信息、他们可能投票的方式等。

在电子表格中管理起来有点多，但它似乎还不够复杂，以至于政治运动必须为此付出代价（尤其是低预算的本地运动）。

如果存在这样的项目，我很乐意提供帮助，或者如果不存在，则启动/恢复一个。

非常感谢任何提示，查看的地方等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T04:46:09.873

Drupal CMS 的模块可能会有所帮助。虽然我没有使用这些模块的任何经验，但您可以查看[CiviCRM](http://civicrm.org/)。

在[drupalmodules.com](http://drupalmodules.com/search/node/campaign+management)上的搜索还发现了一些其他模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T04:01:13.960

我不知道任何确切的。但是，您可能会使用一些现成的开源解决方案，这些解决方案并非专门针对活动。也许您可以使用多种项目管理甚至*错误跟踪*类型的应用程序来提供帮助。至于跟踪捐赠，您应该能够找到一些开源项目来满足这一需求，即使它不是那么具体。如果需要，您甚至可以轻松编写此代码。

编辑，这是一个声称与活动管理一起使用的 CRM 项目：

[http://sourcetapcrm.sourceforge.net/](http://sourcetapcrm.sourceforge.net/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T23:14:57.470

CiviCRM 是帮助非营利组织的 Drupal、Joomla 或独立软件包。

它可以：

1.  运行邮件列表
2.  订阅会员
3.  处理捐赠
4.  管理活动注册和付款

它应该适合政治运动

我经常使用 CiviCRM

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-24T16:22:59.500

我是 Voter Universe 的创建者，这是一个新的开源 Web 应用程序，用于帮助政治运动和政治组织分析选民数据并与之交互。该应用程序仍在积极开发中，但我们预计将在 2009 年 10 月发布我们的第一个生产版本，并推出价格合理的托管服务。

第一个版本将不包括捐助者管理，但该功能是第一个版本之后的高优先级项目。

几周前，我在 Netroots Nation 开始宣传该应用程序之前创建了一个截屏视频。[您可以在我们的网站http://www.voteruniverse.com](http://www.voteruniverse.com)查看截屏视频

杰森兰茨

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-12-15T01:36:21.943

“基本上只是跟踪人们现在所做的捐赠、人们过去所做的捐赠、人们承诺进行的捐赠、联系信息、他们可能投票的方式等”：在没有合适的定制的情况下我将操纵 QuickBooks 的程序——通过在捐款当日开具承诺发票，同时在收集捐款之日开具收据；以及创建一个银行帐户来存入所有款项并编写支票以跟踪所有支出。联系信息部分很简单。为了跟踪人们可能投票的方式，我将创建将在创建发票时用于销售或服务行的派对项目，例如partyA-item、partyB-item、partyC-item 等，并将提取特定的销售/服务图表来监控投票模式。我相信您会发现我的建议很有用。

# c# - 保存来自 AnonymousType 的数组

> ID：672196
> 
> 赞同：0
> 
> 时间：2009-03-23T03:59:22.997
> 
> 标签：c#, linq-to-xml, anonymous-types

我在网上查找了一些参考资料，但运气不佳。希望这只是我忽略的一些简单的事情，但是在我的代码中，我正在遍历参与者列表并将查询的结果存储到数组中。如您所知，我的 foreach 语句将只添加数组的最后一个元素，因为第一个元素被替换。

我怎样才能将值添加到下一个数组索引。那么，如果数组中有 [2]，我如何确保 this.physEntityPhysicalLeftEntityIDs 包含 [2] 而不是总是 [1]？如果我需要澄清，请告诉我。

```
if (leftParticipants.Length >= 0) // Check to see if LeftParticipants exists
{
   for (int c = 0; c < leftParticipants.Length; c++)
   {
       var l_entityIDs = 
          from BioList in o_data.Descendants(bp + "physicalEntityParticipant")
          where BioList.Attribute(rdf + "ID").Value == leftParticipants[c].TrimStart('#')
          select new
          {
              o_entityIDs = BioList.Elements(bp + "PHYSICAL-ENTITY")
              .Select(entityID => entityID.Attribute(rdf + "resource").Value).ToArray()
          };

       foreach (var entity in l_entityIDs)
       {
           this.physEntityPhysicalLeftEntityIDs = entity.o_entityIDs;  // Set SmallMolecules from Left
       }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T04:03:44.843

好吧，如果你想把它当作一个数组/列表，你所要做的就是

l_enityIDs.ToList()

然后 .Add(new {o_entityIDs = foo})

如果要将其添加到 IEnumerable，则需要一个扩展方法，该方法返回源 enumberable 中的所有内容，以及添加下一个值的 yield 语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T04:09:01.273

如果`physEntityPhysicalLeftEntityIDs`是一个数组，您需要初始化一个索引变量并在每次`foreach`循环中递增它：

```
int destIndex = 0;       
foreach (var entity in l_entityIDs)
{
    this.physEntityPhysicalLeftEntityIDs[destIndex] = entity.o_entityIDs;  // Set SmallMolecules from Left
    ++destIndex;
} 
```

这假设您已经在数组中分配了足够的空间。如果数组中的项数超出了数组的容量，则会出现索引越界错误。

为了确保数组中有足够的空间，您可以在上面的循环之前分配它：

```
this.physEntityPhysicalLeftEntityIds = new int[l_entityIDs.Count()]; 
```

用正确的类型替换`int`该行（您没有说明数组中存储的类型）。

# asp.net-mvc - 带有 Ajax 表单的模型状态

> ID：672199
> 
> 赞同：2
> 
> 时间：2009-03-23T04:00:56.987
> 
> 标签：asp.net-mvc, ajax, model, state, modelstate

我正在使用 AJAX 表单将项目更新到数据库。完成后，它会返回一个局部视图，重新列出所有项目并将它们全部显示在一个表格中。当我必须在控制器操作中添加模型状态错误时，就会出现问题。当出现模型状态错误时，我不想返回项目列表，因为我想使用 ValidationMessage 向用户显示错误。我的想法是我可以在我的控制器中做这样的事情：

```
 [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult UpdateNewsItem(int newsID, string newsTitle, string newsDescription, string newsBeginningDate, string newsEndingDate)
    {
        List<Models.News> lstNewsItem = new List<News>();

        //we need to grab the member so we can capture the user id 
        //for the corresponding news property
        MembershipUser member = Membership.GetUser(User.Identity.Name);

        //the news instance to use in case the viewdata is invalid
        Models.News newsError = new Models.News();

        //create the datetime objects
        DateTime dtBeginningDate = DateTime.MinValue;
        DateTime dtEndingDate = DateTime.MaxValue;

        //the message we want to send whenever the user enters an invalid date
        string strInvalidDateError = "Invalid date.  Please use a format like '12/25/2008'";

        //clean user input
        newsTitle = Models.clsGlobals.CleanString(newsTitle);
        newsDescription = Models.clsGlobals.CleanParagraph(newsDescription);

        //newsTitle 
        if (string.IsNullOrEmpty(newsTitle))
        {
            newsError.Title = string.Empty;
            ModelState.AddModelError("newsTitle", "You must enter a news title.");
        }

        //description
        if (string.IsNullOrEmpty(newsDescription))
        {
            newsError.Description = string.Empty;
            ModelState.AddModelError("newsDescription", "You must enter a news description.");
        }

        //beginningDate
        if (string.IsNullOrEmpty(newsBeginningDate))
        {
            ModelState.AddModelError("newsBeginningDate", "You must enter a beginning date.");
        }

        //endingDate
        if (string.IsNullOrEmpty(newsEndingDate))
        {
            ModelState.AddModelError("newsEndingDate", "You must enter an ending date.");
        }

        //set the beginning date 
        try
        {
            dtBeginningDate = DateTime.Parse(newsBeginningDate);
            newsError.BeginningDate = dtBeginningDate;
        }

        catch (FormatException)
        {
            ModelState.AddModelError("newsBeginningDate", strInvalidDateError);
        }

        //set the ending date
        try
        {
            dtEndingDate = DateTime.Parse(newsEndingDate);
            newsError.EndingDate = dtEndingDate;
        }

        catch (FormatException)
        {
            ModelState.AddModelError("newsEndingDate", strInvalidDateError);
        }

        //data is validated, so we can begin the update
        if (ModelState.IsValid == true)
        {

            try
            {
                //use to perform actions on db
                Models.NewsDataContext dcNews = new Models.NewsDataContext();

                //fetch the items that match what the user requested to edit
                lstNewsItem = this.GetNewsItem(newsID);

                //set news properties
                foreach (Models.News news in lstNewsItem)
                {

                    news.UserId = (Guid)member.ProviderUserKey;
                    news.Title = newsTitle;
                    news.Description = newsDescription;
                    news.EntryDate = DateTime.Now;
                    news.BeginningDate = dtBeginningDate;
                    news.EndingDate = dtEndingDate;

                }//next

                //update the transaction
                dcNews.SubmitChanges();

                //update the news list
                return PartialView("NewsList", this.GetNewsItems());

            }

            //just to make sure everything goes as planned,
            // catch any unhandled exceptions
            catch (Exception ex)
            {
                ModelState.AddModelError("_FORM", ex);
            }//end catch

        }//end if valid modelstate

        //invalid modelstate, so repopulate the viewdata and
        //send it back

        //the list to hold the entries
        List<Models.News> lstErrorNewsItems = new List<Models.News>();

        //set the remaining error properties
        newsError.UserId = (Guid)member.ProviderUserKey;
        newsError.NewsID = newsID;
        newsError.EntryDate = DateTime.Now;

        //add the item--there will only be one
        //but the view is expecting a list so we will
        //treat it like one
        lstErrorNewsItems.Add(newsError);

        return PartialView("EditNews", lstErrorNewsItems);

    }//end actionresult 
```

问题是当发生模型状态错误时，模型状态视图数据不会被返回。我怀疑这可能是因为我没有指定更新目标 ID。但是我不能设置另一个 updatetargetid 因为我已经有了一个。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T13:40:25.037

```
 if (!Model.IsValid)  {
    return PartialView("YourEditForm");
    }
    else 
    {
    return View("YourIndexView");
    } 
```

应该可以很好地重新显示带有验证错误和所有内容的编辑表单。ViewData 从 Post 数据中填充。

**大更新**

我做了一些测试来弄清楚。并提出了一个有效的测试项目。以下是一些清单：

我的测试控制器

```
 public class TestController : Controller
    {
                 //
        // GET: /Test/
        List<TestData> data;
        public TestController()
        {
            data = new List<TestData>();
            for (var i = 0; i < 10; i++)
            {
                data.Add(new TestData(){Name=string.Format("TestData{0}",i.ToString().PadLeft(4,'0'))});
            }
        }

        public ActionResult Index()
        {

            return View( data);
        }

        public ActionResult Edit(string name)
        {
            if (Request.IsAjaxRequest())
            {
                return PartialView("AjaxEdit", new TestData() { Name = name });
            }

            return View(new TestData() { Name = name });
        }

        [AcceptVerbs(HttpVerbs.Post)]
        public ActionResult Edit(TestData testData)
        {
            ModelState.AddModelError("name", "incorrect name");
            if (!ModelState.IsValid)
            {
                if (Request.IsAjaxRequest())
                {
                    return PartialView("AjaxEdit");
                }

            }

            return View();
        }
    } 
```

我的编辑视图：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<AjaxValidationPartial.Models.TestData>" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
    Edit
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">

    <h2>Edit</h2>
    <div id="editForm">
<% Html.RenderPartial("AjaxEdit",Model );%>
</div>
</asp:Content> 
```

我的 Ajax 部分编辑视图

" %>

```
<%= Html.ValidationSummary("Edit was unsuccessful. Please correct the errors and try again.") %>

<% using (Ajax.BeginForm(new AjaxOptions { UpdateTargetId = "editForm" }))
   {%>

    <fieldset>
        <legend>Fields</legend>
        <p>
            <label for="Name">Name:</label>
            <%= Html.TextBox("Name")%>
            <%= Html.ValidationMessage("Name", "*")%>
        </p>
        <p>
            <input type="submit" value="Save" />
        </p>
    </fieldset>

<% } %>

<div>
    <%=Html.ActionLink("Back to List", "Index") %>
</div> 
```

还有我的 TestData 模型类

```
 public class TestData
    {
        public string Name { get; set; }
    } 
```

使用此代码，它可以按您的意愿工作。 **请注意，我没有在“发布”编辑操作中将任何模型传递给局部视图。被渲染的视图从发布请求中获取它需要的所有值。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T00:30:36.150

好吧，我已经想通了。感谢您的回复。为了将来参考，我必须做的是设置一个主分隔器，我的所有内容都放入其中。然后，我总是将 updateTargetID 设置为该分隔符，以便它显示的内容无关紧要，只需显示它即可。这实际上更容易，因为您不必浪费 Javascript 函数来打开和关闭其他 div 标签，因为您只使用一个不断更新的标签。

# .net - 有人有使用 slide.show2 的经验吗？

> ID：672203
> 
> 赞同：1
> 
> 时间：2009-03-23T04:03:25.610
> 
> 标签：.net, silverlight, slideshow, slide.show2

我希望在网站上使用[Slide.Show2](http://slideshow2.codeplex.com/)，但是我遇到了一些问题，我想知道它们是否值得一试？

迄今为止的问题：

1.  XmlDataProvider 不支持 Path 参数中的查询字符串参数。虽然我已经设法绕过它，但这向我提出了一些关于源的成熟度/质量的严重警告标志。
2.  目前该应用程序似乎正在崩溃，不确定是否值得进行故障排除。

如果不是 Slide.Show2，你能建议一个替代方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T06:28:46.400

好吧，你可以访问源代码，所以如果有什么不符合你的喜好，你可以改变。

您也可以尝试联系作者，看看他们是否可以帮助您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T09:26:19.810

我使用 FlickR API 实现了 slide.show 2，它运行良好。我遇到了一个问题，我尝试在 CodePlex 上寻求帮助，但看起来这个项目已经死了。我认为那里不会有很多支持。我认为你最好的办法是自己在源头上摆弄。

# text - 为什么我的 sIFR 文本没有环绕在液体设计上？

> ID：672205
> 
> 赞同：0
> 
> 时间：2009-03-23T04:04:45.777
> 
> 标签：text, word-wrap, sifr

我有一行简单的文本，我用 sIFR 替换了我网站上的标题。该站点是流动的，因此当浏览器窗口改变宽度时它会缩放。但是当我缩小浏览器窗口时，替代文本（当我打开它进行测试时）换行到另一行，但 sIFR 文本没有。

我在网络上的其他地方看到人们在 sifr.js 代码中实现了一个`preventWrap=false`函数，但是作为 JavaScript 新手，我不知道在哪里可以让它工作。

这是相关的CSS：

```
.sIFR-hasFlash h2 {
    visibility: hidden;
    letter-spacing: 1px;
    font-size: 18px;
    text-align: center;
    line-height: 1.5em;
} 
```

以及相关的 JavaScript：

```
 sIFR.replaceElement(named({sSelector: "h2", 
sFlashSrc: "flash/h2_font.swf", sBgColor: "#006633", 
sColor: "#FFFFFF", sFlashVars: "textalign=center", sWmode: "transparent"})); 
```

不知道我会把它放在哪里`preventWrap=false`，或者这是否是要走的路。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T22:03:29.717

sIFR 3 应该解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T15:47:55.977

我有一个类似的问题，添加*position:relative* to your CSS 可能会解决它。

# javascript - jQuery 厚盒问题

> ID：672210
> 
> 赞同：0
> 
> 时间：2009-03-23T04:12:56.770
> 
> 标签：javascript, jquery, ajax

我是一个 jQuery 新手。我正在建立一个在线商店，并且正在使用 jQuery 插件“Thickbox”（[http://jquery.com/demo/thickbox](http://jquery.com/demo/thickbox)）。在线商店设置为显示“放大图像”，它运行Thickbox JS 脚本并显示图像。

当数据通过 CMS 系统放置在页面上时会出现问题（我相信使用 Ajax？）。当您从“选择类型”选择下拉菜单中选择另一个产品时，来自 CMS 系统的新数据将放置在页面上，并且不应用厚盒脚本，因为它看不到新数据。

我一直在玩我找到的修复程序（[http://www.codynolden.com/blog/2009/01/thickbox-and-ajax-using-livequery](http://www.codynolden.com/blog/2009/01/thickbox-and-ajax-using-livequery)），但我似乎无法将其应用于我的网站？

我的网站的一个活生生的例子：http: [//madisonlane.businesscatalyst.com/_product_36331/AAA-_Autumn_Dress](http://madisonlane.businesscatalyst.com/_product_36331/AAA-_Autumn_Dress)

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T03:41:04.147

在thickbox.js 中：

```
$(domChunk).click(function(){ 
```

被替换为：

```
$(domChunk).live(click, function(){ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-23T17:14:46.923

斯图尔特做对了：非常感谢！

我遇到了类似的问题：在我的情况下，附加链接的目标（通过 jQuery`.append()`方法）没有加载到厚盒中。

我的 jQuery 代码在一个`document.ready()`函数中执行：

```
$("#subpages").append('','<a href="..." class="thickbox" [...]'); 
```

只需添加：

```
tb_init('.thickbox'); //required to reinitialize thickbox as DOM was manipulated 
```

就在最后一行解决了问题之后。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T04:21:54.317

您使用的是 IFRAMED 厚盒吗？你可能会有更好的运气，因为默认情况下，thickbox 只显示在 DIV 中。您需要将 &TB_iframe=true 添加到您的 URL 的查询字符串中以获取此信息

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T04:56:23.703

我可能没有正确阅读您的问题，但从听起来的方式来看，内容正在被破坏并使用新的项目选择创建，对吗？

如果是这种情况，您需要在加载新内容时调用 tb_init('.some-selector') 。我记得必须这样做才能有条件地设置一次厚盒。Thickbox 的工作原理是浏览您的页面并连接点击事件以与“thickbox”类链接。通过使用 tb_init()，您可以随时在您喜欢的任何选择器上连接您的东西。查看Thickbox 的源代码以了解我的意思。

# project-management - 团队沟通（尤其是通过电子邮件）——默认打开还是关闭？

> ID：672213
> 
> 赞同：5
> 
> 时间：2009-03-23T04:14:53.443
> 
> 标签：project-management, collaboration

我是一位经验丰富的 C# 开发人员（大约 5 年经验），最近被任命为我的第一个开发团队的技术主管（在 3-5 名其他开发人员之间变化）。在担任这个职位的过去 4 个月里，不断出现的一个难题是试图找到适当程度的共享意识，以了解项目经理、客户经理、客户、设计师、CEO 和我自己之间进行的沟通（尤其是通过电子邮件） .

一方面，我知道每个开发人员对项目总体方向的了解越多，他们就越能理解他们的特定功能在大局中的范围。

然而另一方面，我的很多时间似乎都浪费在所有不同利益相关者和经理之间的电子邮件海洋中，所以我喜欢认为将开发人员隔离到“他们需要做他们当前的工作” "将使他们免受干扰。

我曾考虑只密件抄送所有开发人员，以便他们可以过滤这些电子邮件并基本上“选择加入”所有电子邮件，但我担心一些开发人员只会将此视为需要处理的额外噪音。如果所有开发人员都想为太多讨论做出贡献，它可能会为“太多厨师”打开大门。然而另一方面，其他意见可以帮助我做出更好的决定（即 House MD 风格）。

呼……要考虑的太多了。有人在这方面有一些明智的指导吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T11:37:47.840

回答晚了，但仍然相信有一些东西可以添加到迄今为止给出的极好的建议中。要回答您的问题，我们需要更上一层楼，因此需要较长的回复。

您已被任命为负责团队的技术主管，尽管您日常工作的许多方面可能看起来与您的开发日相似，但您需要处理它们的方式已经改变。在软件开发环境中，与成为建筑工地或工厂的领班相比，当您任命技术负责人（您可能仍然坐在同一张桌子上，穿着相同的衣服）时，通常不会有太大的变化。不过，令人高兴的变化是，您现在被邀请参加所有这些会议，并开始收到来自开发团队以外人员的所有这些电子邮件和电话。

缺乏切实的改变可能会欺骗你的思想，认为你只需要保持基本相同的工作即可。情况并非如此，您需要意识到自己在新身份中的行动和重新行动。看起来你现在在外部有点“更受尊重”，你可能倾向于在内部分享一些“尊重”，表现出一点民主，而且总体上是公平的。

好吧，这与公平或尊重无关，新工作是：

*   指导开发团队（主要通过个人示例和创建描述目标的图像）。

*   成为团队与其他组织单位之间的抽象层。

就像在编程中经常创建一个抽象层来封装和隐藏复杂性一样，在组织中也会发生同样的情况。你是层，必须封装开发团队的接口。从局外人的角度来看，任何好的封装：

*   向外部观察者隐藏与手头任务（例如算法的具体实现）无关的内部复杂性。

*   使可能影响外部用户的事情变得明确（可以抛出的异常、任何限制和约束等）。

*   总是给出有意义的反馈。

*   行动一致。

这些原则同样适用于团队的对外沟通。遵循这些原则并非易事；实际上它涉及很多具体的工作，例如决定哪些细节是内部的，哪些事实需要传达，何时，反馈需要如何以最佳方式组织和以一致的方式呈现，以及应该向外部通知谁，谁需要跟进，何时跟进。这是很多工作，即使其中一些似乎只是微不足道的管理员。

现在到内部，内部沟通。一种方法是广播。但它阻塞了内部网络，每个人都必须花时间来决定通信是否与他们有任何关联。这就像拥有一个非常通用的算法，无论输入如何，它总是做完全相同的工作量。这当然是可能的，但你为什么要这样做呢？一种更有效的方法显然是根据输入来调整处理，这里必须有人的工作来决定团队应该如何做某事、调度或转换输入：

*   决定需要采取的行动顺序，

*   或者只是确认并存储以供将来参考，

*   或跟进，

*   或者将问题推迟到以后审查，然后确保对其进行审查并将其反馈到决策循环中。

这也不是一项小工作，必须有人去做。显然，现在管理外向和内向的沟通是你的工作，你必须花费你大脑的一些处理能力才能把它做好，所以没有其他人需要，开发人员可以专注于他们的任务。

不管你的职位是什么，不要抄送或密送所有人还有其他一些很好的理由：

*   TO 表示“采取行动”，CC - “记下以备将来参考”，BCC - “窃听或群发邮件”。当您使用一个或另一个电子邮件给一群人时，您应该小心：

    *   给一个人发电子邮件是一个简单的“收件人”，当给一群人发电子邮件时，只“给”那些你需要采取行动的人（包括一个简单的确认）。这是默认含义，在任何其他情况下明确告诉他们预期的内容（即仅供参考，无需采取行动等）。

    *   只抄送那些你想记下的信息，以备日后参考。如果您希望在达成协议或解决问题之前来回发送大量电子邮件，请不要“抄送”，最好稍后将摘要确认发送给需要通知的其他方。除了节省每个人的时间并避免由于有人注意到非最终沟通而产生的误解，这将有助于使交流更加个人化、更加自然地进行，并减少形式主义和繁文缛节。通常 CC-d 电子邮件被正式处理，这并不总是一件好事（但有时正是你想要的）。

    *   使用密件抄送几乎是不可能的。如果有人窃听你的谈话，一旦曝光，很容易破坏你的可信度。这只是一个“何时”的问题。那么您的团队是否应该担心您可能会将他们的谈话密送给其他人？在大多数情况下，通过密件抄送群发邮件也是错误的，它给人的印象是电子邮件是专门针对收件人的。

*   转发、CC-ing 和 BCC-ing 需要很少的努力，但会增加噪声并稀释信号。值得考虑一下您到底需要一个人做什么，以及在撰写之前他们应该知道什么来对您的沟通采取行动。

*   有些对话最好完全“脱机”（电话或更好的面对面），因为它为您提供了更多的操作空间。广播或书面形式化就像让自己陷入困境。您可以随时以书面形式确认后者。

转到技术主管职责的第二部分（通过个人示例和描绘目标的图像来指导团队）。要做到这一点，您无需将碰巧在收件箱中结束的每一条信息都传递给团队。你必须创造一个故事，任何好的故事都是真实事件的抽象，只包含特定受众的相关和有趣的细节。根据你的日常经验创建这个简短的故事，判断什么是相关的和有趣的，然后定期向团队展示它也是一项艰巨的工作。

但是不要忘记，通过指导团队并充当抽象层，您可以帮助开发人员和外部世界更有效地交互，完成更多工作并解决更大的复杂性，这项工作是有意义的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-23T04:20:12.480

工程团队需要了解为什么要求他们在宏观层面上做事的商业原因。工程团队将从中获得理解和动力。但是太多的喋喋不休是一个禁忌，正如你所指出的，**你的工作的一部分是过滤**，其中一部分意味着不要让他们暴露在大量的噪音中。您的开发人员可能对如何做特定事情或为什么选择特定技术有意见和见解，他们应该因为他们在这些领域的专业知识而被派上用场。

绝对不要创造一种密件抄送的文化。

一种选择是有单独的邮件列表，感兴趣的各方可以订阅，但当然，并不是所有的聊天都会在这些列表中。

当然，定期的公司会议是必须的。让工程人员知道为什么业务依赖于交付稳定、完整的产品（或即将到来的里程碑所需的任何东西）。20 分钟，没有幻灯片，没有废话对我有用。您的团队和情况可能会有所不同。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T04:18:08.180

一种方法可能是不转发所有这些电子邮件，而是每周一次将所有相关信息、设计变更等汇总到每周会议中。我绝对不会向开发人员发送大量电子邮件。当然，如果讨论了一些关键问题，那么应该引起他们的注意。但是，请尝试每周回顾和讨论相关细节。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-23T04:22:32.240

我会使用 Wiki，您不想添加到电子邮件风暴中，并且您的开发人员也可以贡献和改变事物。它对于共享文档也非常有用，如果做得好，它将成为自支持的。

顺便说一句，从电子邮件剪切/粘贴到 wiki 似乎是一件奇怪的事情，有人知道我也可以通过电子邮件发送内容的轻量级 .Net wiki 吗？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-23T04:27:05.363

听起来你很技术，所以我会给你这个建议：遵循 Joel Spolsky 关于项目经理做什么的建议。基本上，尝试尽可能地隔离您的开发人员，以便他们尽可能高效。

他刚刚在最近的这篇文章《[如何成为一名项目经理》](http://www.joelonsoftware.com/items/2009/03/09.html)中简单地提到了这一点，但他之前已经对这个话题进行了更深入的探讨。查看他过去的著作以获取更多信息：

> 一旦规范完成并且开发团队开始工作，我有两个责任：解决关于设计的任何问题，并与所有其他团队交谈，这样开发人员就不必这样做了。

如果你不是技术人员，那么你需要从你的团队中选择一个人来帮助设计工作，他们将不得不与客户进行一些交流，以弄清楚需求是什么以及最好的设计是什么。

编辑：在[Joel 的主页上](http://www.joelonsoftware.com/)有两个部分，标题为 Tech Lead 和 Program Manager。查看那里的文章以获取有关程序管理器的更多信息，尤其是[认为有害的人工任务开关](http://www.joelonsoftware.com/articles/fog0000000022.html)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-24T07:04:38.617

我在发布一年后看到这个问题，但是我可以为我的案例添加一些特定数据的经验。对于项目中的 2-3 名开发人员，我主要是一对一的。很多时候，我通过 IM 或电话进行此操作，因为我的团队中的大多数人都在家庭办公室度过了很多时间。不时开会是不可避免的，主要是在项目开始时（1-2 次开发人员会议往往足以启动相当复杂的项目），但通常，与公司其他成员的所有沟通都通过我，开发人员得到摘要。唯一的例外是当我直接将开发人员与用户（而不是管理人员！）联系起来以制定项目的详细信息时。

我倾向于避免定期会议（每周或每天），并且仅在至少发生两次会议时才安排会议，按以下顺序：

1.  重要信息进来（取决于紧急情况，这可能要等一周）
2.  开发人员在办公室，最好是出于其他原因（开发人员对开发人员的会议）
3.  客户端可用（那里没有太多选择，但我稍后会尝试将开发人员与客户端的单一实践专家联系起来）
4.  我需要设计建议（因为我是技术主管，所以我负责大部分高级架构决策）

对于 4-8 人的团队（8 人通常意味着两个团队），我发现每周大约一次 30 分钟的简短会议足以让每个人都了解最新情况。当然，这是我每天为初级开发人员做的一对一以及每周为高级开发人员做两次的一对一的补充。

对于一对一，我更喜欢开发人员在他们寻找更多要做的事情或者当他们对刚开始做的任务有疑问时与我联系。这对我来说也是一个很好的方式来关注事情的进展，而开发人员不需要考虑让我保持最新状态。当即时消息足够时，我倾向于避免使用电子邮件，否则切换到电话（当有一些事情需要解释或讨论时）并在以下情况下使用电子邮件：

*   客户通过电子邮件报告错误
*   有很多重要的小细节，开发人员可能会在实施过程中多次查看该电子邮件

当他们需要协调某些事情时（例如，当 Java 和 Javascript 开发人员需要制定接口细节时）也会有开发人员对开发人员的会议。

这种工作方式意味着我必须尽可能快地响应 IM，而且我通常会处理很多中断，因此开发人员只需要为我或其他开发人员处理中断。没关系，因为我工作的重要部分是让开发人员有效。

如果我需要安静地进行编码（并且负担得起），我发现将客户沟通委托给非技术项目经理甚至是 beta 测试人员（他们比程序员更擅长分心）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T12:42:19.153

问他们更喜欢什么。我认为他们宁愿不要在每封电子邮件上抄送，而是会选择定期进行简短的口头更新。

# perl - 如何确定 Perl 文件句柄是读句柄还是写句柄？

> ID：672214
> 
> 赞同：13
> 
> 时间：2009-03-23T04:15:09.183
> 
> 标签：perl, filehandle

给你一个`IO::File`对象或一个 typeglob（`\*STDOUT`或`Symbol::symbol_to_ref("main::FH")`）；您将如何确定它是读句柄还是写句柄？无法扩展接口以传递此信息（我正在重写以在实际关闭之前和之前`close`添加调用）。`flush``sync`

目前我正在尝试`flush`和`sync`文件句柄并忽略错误`"Invalid argument"`（这是我尝试`flush`或`sync`读取文件句柄时得到的）：

```
eval { $fh->flush; 1 } or do {
        #this seems to exclude flushes on read handles
        unless ($! =~ /Invalid argument/) {
                croak "could not flush $fh: $!";
        }
};

eval { $fh->sync; 1 } or do {
        #this seems to exclude syncs on read handles
        unless ($! =~ /Invalid argument/) {
                croak "could not sync $fh: $!";
        }
}; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T05:43:23.310

看看 fcntl 选项。也许`F_GETFL`与`O_ACCMODE`.

**编辑：**我在午餐时做了一些谷歌搜索和玩，这里有一些*可能不可移植的*代码，但它适用于我的 Linux 机器，可能适用于任何 Posix 系统（也许甚至是 Cygwin，谁知道？）。

```
use strict;
use Fcntl;
use IO::File;

my $file;
my %modes = ( 0 => 'Read only', 1 => 'Write only', 2 => 'Read / Write' );

sub open_type {
    my $fh = shift;
    my $mode = fcntl($fh, F_GETFL, 0);
    print "File is: " . $modes{$mode & 3} . "\n";
}

print "out\n";
$file = new IO::File();
$file->open('> /tmp/out');
open_type($file);

print "\n";

print "in\n";
$file = new IO::File();
$file->open('< /etc/passwd');
open_type($file);

print "\n";

print "both\n";
$file = new IO::File();
$file->open('+< /tmp/out');
open_type($file); 
```

示例输出：

```
$ perl test.pl 
out
File is: Write only

in
File is: Read only

both
File is: Read / Write 
```

# ajax - 通过 AJAX 下载 CSV

> ID：672218
> 
> 赞同：5
> 
> 时间：2009-03-23T04:18:19.660
> 
> 标签：ajax, prototypejs, lowpro

您可以使用 AJAX 从 Web 应用程序下载生成的 csv 文件吗？如果是这样，是否有人可以指出我的任何参考？

编辑：对不起，我应该提到我正在使用 Prototype 的 Ajax.Request，我查看了 firebug 的响应工具，生成的 CSV 是响应，我只需要在 Ajax 生成后使用保存文件选项弹出它。要求

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T21:21:07.027

这是 Ajax 请求的一个已知限制，您需要使用 JS，例如：

```
window.location='download-csv.rb'; 
```

而不是使用 Ajax 请求。另一种方法是更改​​隐藏 iframe 的位置，但这有它自己的优点/缺点。

无论您发送什么 HTTP 标头，您都不会收到显示“文件保存”对话框的 Ajax 请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T04:20:27.440

根据您的最新编辑，要使您的 CSV 文件触发文件下载（而不是在浏览器中呈现），不需要 Ajax。

相反，解决方案是让您的后端系统在请求 CSV 文件时添加此 HTTP 标头：

```
Content-disposition: attachment; filename=<your_filename.csv>; 
```

您在此处的实现取决于您使用的后端系统。如果您使用的是 Rails（正如您的用户名所暗示的那样），请从这里开始：

```
filename = 'your_filename.csv'
headers['Content-Type'] = 'text/plain'
headers['Content-Disposition'] = "attachment; filename=\"#{filename}\""
render :layout => false 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T04:22:29.977

下载它不是问题；您可以通过 XmlHttpRequest 下载您喜欢的任何数据。困难的部分是解析它。有几种方法可以解析它，从正则表达式到字符串索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T04:26:07.660

您可以使用“AJAX”来下载*任何东西*。有些人会说在这种情况下您不应该将其称为 AJAX，因为该术语专门用于下载 XML。但实际上，它只是一种无需重新加载页面即可将数据输入客户端的机制。如果您正在加载 HTML，它会被称为 AHAH，对于 CSV，我猜您会称它为 AHAC 或 AJAC？..

# perl - 在 perl 程序中从谷歌获取结果数量

> ID：672224
> 
> 赞同：7
> 
> 时间：2009-03-23T04:21:32.647
> 
> 标签：perl, api

是否有我可以在我的 Perl 程序中使用的谷歌 API，以便它返回为搜索词找到的结果数量？

每当在谷歌上进行搜索时，在最右边，它会找到许多结果以及花费的时间。我只想得到这些信息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T06:42:26.490

谷歌几年前[弃用了他们的 SOAP API 。](http://code.google.com/apis/soapsearch/)尝试使用[REST::Google::Search](http://search.cpan.org/perldoc?REST::Google::Search)或[Google::Search](http://search.cpan.org/perldoc?Google::Search)，它们使用他们的[AJAX API](http://code.google.com/apis/ajaxsearch/)。我自己没有机会尝试任何一个模块，所以我不确定哪个更好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T05:08:26.700

CPAN 模块[Net::Google::Search](http://search.cpan.org/perldoc?Net::Google::Search)实现了 Google 的 SOAP API 进行搜索。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T04:32:48.267

我不确定这是否正是您正在寻找的，但您可以检查它是否支持您的使用模型：[Google Ajax Search API](http://code.google.com/apis/ajaxsearch/)。

# css - IE 6 & IE 7 Z-Index 问题

> ID：672228
> 
> 赞同：21
> 
> 时间：2009-03-23T04:23:18.290
> 
> 标签：css, internet-explorer, cross-browser

[http://madisonlane.businesscatalyst.com](http://madisonlane.businesscatalyst.com)

我试图让 div#sign-post 位于 div#bottom 上方。这适用于除 IE6 和 IE7 之外的所有浏览器。谁能看到这里有什么问题？

IE6 还会在 div#bottom 的顶部显示额外的 198px。

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2010-10-22T14:51:37.063

这里的大多数答案都是错误的；有些工作，但不是因为他们所说的原因。这里有一些解释。

这就是 z-index 根据[规范](http://www.w3.org/TR/CSS2/visuren.html#z-index)应该如何工作：

*   你可以给`z-index`任何元素赋值；如果你不这样做，它默认为`auto`
*   定位元素（即`position`属性与默认值不同的元素`static`）与`z-index`不同的 from`auto`创建一个新的*堆叠上下文*。堆叠上下文是重叠的“单元”；一个堆叠上下文要么完全在另一个之上（也就是说，第一个的每个元素都在第二个的任何元素之上）或完全在它之下。
*   在相同的堆栈上下文中，比较元素的*堆栈级别*。具有显式`z-index`值的元素将该值作为堆栈级别，其他元素从其父元素继承。堆栈级别较高的元素显示在顶部。当两个元素具有相同的堆栈级别时，通常在 DOM 树中较晚的那个被绘制在顶部。（如果它们具有不同的`position`属性，则适用更复杂的规则。）

换句话说，当两个元素已经`z-index`设置时，为了决定哪个将显示在顶部，您需要检查它们是否有任何定位的父元素也`z-index`设置了。如果他们不这样做，或者父母很常见，则 z-index 较高的一方获胜。如果他们这样做，您需要比较父母，而`z-index`孩子是无关紧要的。

因此，`z-index`决定了元素与其“堆叠父级”的其他子级（最近的祖先具有一`z-index`组和一个`position`，或）相比如何放置`relative`，但与其他元素比较时并不重要；重要的是堆叠父级（或者可能是堆叠父级的堆叠父级等）。在一个典型的文档中，您只在下拉菜单和弹出窗口等少数元素上使用，其中没有一个包含另一个，所有具有 a 的元素的堆叠父级是整个文档，您通常可以不考虑作为全局的文档级排序。`absolute``fixed``z-index``z-index``z-index``z-index``z-index`

与 IE6/7 的根本区别在于定位元素开始新的堆叠上下文，无论它们是否已`z-index`设置。由于您本能地为其赋值的元素`z-index`通常是绝对定位的，并且具有相对定位的父或近祖先，这意味着您的`z-index`-ed 元素根本不会被比较，而是它们的定位祖先将 - 因为那些有未设置 z-index，以文档顺序为准。

作为一种解决方法，您需要找出实际比较了哪些祖先，并为它们分配一些 z-index 以恢复您想要的顺序（通常是反向文档顺序）。通常这是由 javascript 完成的 - 对于下拉菜单，您可以遍历菜单容器或父菜单项，并为它们分配`z-index`1000、999、998 等。另一种方法：当一个弹出或下拉菜单变得可见时，找到它所有相对定位的祖先，并给它们一个`on-top`z-index非常高的类；当它再次变得不可见时，删除这些类。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-23T09:03:15.357

同意验证者的评论 - 验证通常会有所帮助。但是，如果它没有在 IE 中为 z-index 提供一些指针：

1）您正在操作的z-index元素应该在同一级别，即。你应该设置#bottom 和#body 的z-index

如果这不可行，那么

2) IE 有时不会正确应用 z-index，除非您将其应用到具有`position:relative`. 尝试将该属性应用于#bottom 和#body（或#signpost）

让我知道结果如何

达科

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-11T19:21:11.747

我刚刚遇到了这个问题，我发现的解决方法（感谢 Quirksmode）是为您尝试设置它自己的 z-index 的节点的直接父节点提供小于 z-index 的 z-index您尝试设置的节点。这是一个应该在 IE6 中工作的快速示例

```
<html>
  <head>
    <style type="text/css">
      #AlwaysOnTop {
        background-color: red;
        color: white;
        width: 300px;
        position: fixed;
        top: 0;
        z-index: 2;
      }
      #Header {
        color: white;
        width: 100%;
        text-align: center;
        z-index: 1;
      }
    </style>
  </head>
  <body>
    <div id="Header">
      <div id="AlwaysOnTop">This will always be on top</div>
    </div>
    <div id="Content">Some long amount of text to produce a scroll bar</div>
  </body>
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-10T14:11:09.913

欢迎，我解决了这个问题：

```
.header { 
    position: relative;
    z-index: 1001;
}
.content {
    position: relative;
    z-index: 1000;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T06:00:30.633

在我看来，您那里有一些格式错误的 HTML。我试着数了数，也许我忘记了开始和结束标签的数量，但看起来 div#container 没有关闭。尝试通过验证器（例如 W3C 的 HTML Validator 或其他东西）运行您的页面并修复一些错误。这在过去帮助我解决了这些问题。祝你好运！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T09:16:46.823

我最近遇到了一个持续的问题，显示一层在另一层之上。在我的例子中，我以编程方式在 Javascript 中创建了两层，一层用于显示自定义控件，另一层用于在其后面创建全屏层。FF 很好，但 IE 总是在其他所有内容之上显示全屏图层。

在互联网上进行了无数次拖网之后，尝试了每个人的建议，我最终让它工作的唯一方法是`position:`从两个层中删除属性，并调整`margin-top:`属性直到我得到满意的结果。

有点杂乱无章，但它可以工作，并且在 IE 8 解决所有当前错误之前会很好......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-29T17:49:44.093

唯一可靠的解决方案是，将顶部元素**放在代码下方，然后**以绝对定位将它们推到其他东西上。

例如 Wordpress：将导航放在页脚文件中，但仍在页面包装器中。

或许也能为搜索引擎带来一些优势，因为它们可以直接从内容开始，无需先爬过菜单……

更新：我需要纠正自己。虽然将元素放在下面然后将其推过仍然是最简单的方法，但在某些情况下，这在合理的时间内是不可能的。然后**你必须确保每个父元素都有某种定位和一些有意义的 z-index**。然后 z-index 即使在 IE7 中也应该再次工作。

# ruby-on-rails - Ruby on Rails：新的照片控制器？

> ID：672229
> 
> 赞同：2
> 
> 时间：2009-03-23T04:23:21.130
> 
> 标签：ruby-on-rails, ruby, forms

我的 Profile 类和 Photos 类之间存在一对多的关系。Profile 保存了用户的信息，photos 保存了用户的图片。目前，“上传照片”链接显示在个人资料视图的底部。我想让链接显示在单独的视图上，而不是将所有内容都塞在同一个表单上。我应该只创建一个名为 profile_photo.html.erb 的新视图来显示此链接，还是应该创建一个与照片关联的新控制器和模型？推荐的做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T05:16:04.950

“Photos”类应该称为“Photo”，因为 Rails 对模型使用单数名称。

是的，您应该创建一个新的控制器来创建照片，因为它是另一种资源。您可能最终想要编辑照片，添加描述等等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T05:22:42.283

我同意 Radar，你会想要创建一个 PhotosController。当您这样做时，您可以更进一步，并在 routes.rb 文件中定义 has_many 关系。像这样：

```
 map.resources :photos
   map.resources :profiles, :has_many => :photos 
```

`profile_photos_path`这将生成诸如,`new_profile_photo_path`等的url ... 运行`rake routes`命令以查看它为您提供的内容。这将有助于使您的代码保持干燥且易于阅读。

# php - 本地主机上的 mysql_connect()

> ID：672235
> 
> 赞同：0
> 
> 时间：2009-03-23T04:27:22.587
> 
> 标签：php, mysql, linux, apache

我正在尝试在我的家庭网络上实现一个小“内部网”，但我是一个 apache/mysql 配置菜鸟......

运行fedora 10，并且我知道如何设置apache、mysql和php。但是，当我尝试使用带有 POST 的标准表单时，php 脚本似乎在 mysql_connect(...); 上出错了。线。我没有收到错误消息，实际上浏览器页面是空白的，即使在查看源代码窗口中也是如此。这是我所拥有的：

```
$conn = mysql_connect("localhost:1186", "user", "password");

... 
```

我已经在 mysqladmin 工具中添加了用户名和密码，并且我尝试了“localhost”和“localhost:1186”，因为我看到了 my.cnf 文件中引用的 1186 端口。

显然我有一些配置错误，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T04:31:20.923

出现错误时，结果页面为空白。设置中最常见的错误之一是忘记安装 php-mysql 或 mysql-server 软件包。验证它们是否已安装，如果未安装其中一个或两个，则重新启动 httpd 服务，如果未运行则启动 mysql 服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T04:31:48.147

全新 mysql 安装的默认设置是

$conn = mysql_connect("localhost:3306", "root", "");

要不就

$conn = mysql_connect("localhost", "root", "");

这有利于测试目的，但让 root 帐户不受保护是一个坏习惯。

# c# - 运行由 ASP.NET 网页请求触发的异步操作

> ID：672237
> 
> 赞同：57
> 
> 时间：2009-03-23T04:28:31.743
> 
> 标签：c#, asp.net, asynchronous

我有一个异步操作，由于各种原因需要使用对 ASP.NET 网页的 HTTP 调用来触发该操作。当我的页面被请求时，它应该开始这个操作并立即向客户端返回一个确认。

此方法也通过 WCF Web 服务公开，并且运行良好。

在我第一次尝试时，抛出了一个异常，告诉我：

```
在此上下文中不允许异步操作。
开始异步操作的页面必须具有 Async
属性设置为 true 并且异步操作只能是
在 PreRenderComplete 事件之前的页面上开始。
```

所以当然我将`Async="true"`参数添加到`@Page`指令中。现在，我没有收到错误消息，但页面在异步操作完成之前一直处于阻塞状态。

如何让真正的“即发即弃”页面正常工作？

**编辑：** 一些代码以获取更多信息。它比这更复杂一些，但我试图在那里得到一般的想法。

```
public partial class SendMessagePage : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string message = Request.QueryString["Message"];
        string clientId = Request.QueryString["ClientId"];

        AsyncMessageSender sender = new AsyncMessageSender(clientId, message);
        sender.Start();

        Response.Write("Success");
    }
} 
```

AsyncMessageSender 类：

```
public class AsyncMessageSender
{
    private BackgroundWorker backgroundWorker;
    private string client;
    private string msg;

    public AsyncMessageSender(string clientId, string message)
    {
        this.client = clientId;
        this.msg = message;

        // setup background thread to listen
        backgroundThread = new BackgroundWorker();
        backgroundThread.WorkerSupportsCancellation = true;
        backgroundThread.DoWork += new DoWorkEventHandler(backgroundThread_DoWork);
    }

    public void Start()
    {
        backgroundThread.RunWorkerAsync();
    }

    ...
    // after that it's pretty predictable
} 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-08-27T19:21:55.703

如果您在发出请求的 .aspx 页面中运行网络表单，请设置 Ansync = "true"。
`<%@ Page Language="C#" Async="true" ... %>`

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-23T05:03:32.187

如果您不关心向用户返回任何内容，您可以启动一个单独的线程，或者为了快速而肮脏的方法，使用委托并异步调用它。如果您不关心异步任务完成时通知用户，您可以忽略回调。尝试在 SomeVeryLongAction() 方法的末尾放置一个断点，您会看到它在页面已被提供后完成运行：

```
private delegate void DoStuff(); //delegate for the action

protected void Page_Load(object sender, EventArgs e)
{

}

protected void Button1_Click(object sender, EventArgs e)
{
    //create the delegate
    DoStuff myAction = new DoStuff(SomeVeryLongAction); 
    //invoke it asynchrnously, control passes to next statement
    myAction.BeginInvoke(null, null);
    Button1.Text = DateTime.Now.ToString();
}

private void SomeVeryLongAction()
{
    for (int i = 0; i < 100; i++)
    {
        //simulation of some VERY long job
        System.Threading.Thread.Sleep(100);
    }
} 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-03-23T05:22:33.343

好的，问题来了：Async 属性适用于您的页面将调用一些也会阻塞线程的长时间运行的任务，然后您的页面需要该任务的输出才能将信息返回给用户的情况。例如，如果您的页面需要调用 Web 服务，请等待其响应，然后使用响应中的数据来呈现您的页面。

您使用 Async 属性的原因是为了避免阻塞线程。这一点很重要，因为 ASP.NET 应用程序使用线程池来处理请求，并且只有相对少量的线程可用。如果每个调用在等待 Web 服务调用时都占用了线程，那么很快你就会遇到足够多的并发用户，用户将不得不等待这些 Web 服务调用完成。Async 属性允许线程返回到线程池并为您的网站的其他并发访问者提供服务，而不是在等待 Web 服务调用返回时强制其无所事事。

您的结果是：Async 属性是为在异步任务完成之前您无法呈现页面的情况而设计的，这就是它不会立即呈现页面的原因。

您需要启动自己的线程，并使其成为守护线程。我不记得确切的语法，但您可以通过在 BCL 文档中搜索“daemon”轻松地在文档中找到它。这意味着线程将阻止您的应用程序在它处于活动状态时关闭，这很重要，因为 ASP.NET 和 IIS 在他们认为有必要时保留“回收您的进程”的权利，如果在您的线程工作时发生这种情况，你的任务将被停止。制作线程守护程序将防止这种情况（除了一些可能的罕见边缘情况......当您找到有关此的文档时，您会发现更多信息）。

该守护线程是您将启动这些任务的地方。在您告诉守护线程执行任务后，您可以立即渲染您的页面......因此页面的渲染将立即发生。

不过，比 ASP.NET 进程中的守护线程更好的是实现一个 Windows 服务来完成任务。让您的 ASP.NET 应用程序将要执行的任务传达给服务。无需守护线程，也无需担心您的 ASP.NET 进程会被回收。您如何告诉服务执行任务？可能通过 WCF，或者可能通过将记录插入到服务轮询的数据库表中。或者其他一些方式。

编辑：这是另一个想法，我以前也出于同样的目的使用过它。将有关您的任务的信息写入 MSMQ 队列。让另一个进程（甚至可能在另一台机器上）从该队列中拉出并执行耗时的任务。插入队列的工作经过优化以尽快返回，因此当您放入队列中的数据通过网络或类似方式发送时，您的线程不会阻塞。这是记录需要完成任务而不等待该任务执行这一事实的最快方法之一。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-06-28T09:30:28.780

您可以非常轻松地解决此限制，甚至无需将 Async 设置为 true。

```
public void Start()
{
    new Task(() =>
    {
        backgroundThread.RunWorkerAsync();
    }).Start();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-28T23:11:22.077

如果您在异步调用 Web 服务时遇到此错误，请确保按照异常消息的指示添加 Async='true' 属性？

页面顶部 <Page Language='VB' Async='true' AutoEventWireup='false' CodeFile='mynewpage.aspx.vb' Inherits='mynewpage' %>

# java - 在 Swing 和 AWT 中，为什么一个被认为是轻量级的而另一个被认为是重量级的？

> ID：672238
> 
> 赞同：2
> 
> 时间：2009-03-23T04:28:50.680
> 
> 标签：java, swing, awt

为什么在JAVA中说Swings是重量级的而AWT是轻量级的？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-23T04:38:51.453

AWT 被称为“重量级”，因为基本上每个 AWT 组件都是本机平台组件。AWT 是在平台的本机 GUI 工具包之上实现的。这也解释了为什么 AWT 与 Swing 相比非常有限。就实现的内容而言，它使用最小公分母。

另一方面，Swing 是用 Java 实现的，除了顶级组件（windows ...）之外的几乎所有东西。可以有原生组件，这些仍然被称为“重量级”。

请查看IBM 的[此页面](http://www.ibm.com/developerworks/grid/library/os-swingswt/)，以深入比较 AWT、Swing 和 SWT。

编辑：我认为这是你的问题，即使重/轻似乎在你的措辞中被颠倒了。重/轻重量几乎是 Java GUI 工具包中的一个标准名称，所以我按照自己的理解进行。（感谢 BobbyShaftoe 指出这一点）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T17:30:33.600

在 Java 世界中，AWT 组件被认为是“重量级”的，因为它们使用底层的原生组件。当您实例化**java.awt.Button**的实例时，您实际上是在要求底层操作系统为您绘制此对象。

另一方面，Swing 是“轻量级的”，因为它主要依赖于 Java2D API 来完成所有绘制，而这些绘制又委托给底层操作系统或硬件。这也解释了为什么 Swing 需要所有那些执行实际绘画的 UI 组件来模仿特定的外观和感觉（Windows、GTK、Motif 等）。

[本文更详细地解释了轻量级和重量级组件之间的区别。](http://java.sun.com/products/jfc/tsc/articles/mixing/)

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-25T18:06:50.387

因为每个“重量级”组件都有一个本地节点，而“轻量级”组件没有。由于 AWT 是重量级的，每个 AWT Button 在 windows 平台上都有对应的 MFC 按钮，在 Unix 平台上则有 Motif 按钮。由于 Swing 是轻量级的，按钮的图形只是绘制在框架的顶部……没有底层的 MFC 或 Motif 按钮。您可以在 Sun 网站上的[混合重型和轻型组件](http://java.sun.com/products/jfc/tsc/articles/mixing/index.html)一文中找到有关此主题的更多信息。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-23T04:30:39.567

我不完全理解这个问题，我确信这将导致一场激烈的战争，但也许是因为 AWT 提供了一个“更简单”的 API，尽管它更原始一些。然而，如果你喜欢 API，Swing 可以说是一个非常头重脚轻或重量级的东西。它比 AWT 有更丰富的支持和更多的类。

# c - 如何在 C 中通过 TCP 发送整数数组？

> ID：672241
> 
> 赞同：3
> 
> 时间：2009-03-23T04:29:27.760
> 
> 标签：c, sockets, tcp

我被引导相信`write()`只能发送字节的数据缓冲区（即有符号字符），那么如何使用`write()`sys/socket.h 库中的 C 函数发送一个长整数数组？

显然，我不能只将 long 转换为 char，因为任何超过 127 的数字都会出现格式错误。

我看了一下这个问题，[如何将整数数组分解为字节数组（像素编码）](https://stackoverflow.com/questions/392371/how-to-decompose-integer-array-to-a-byte-array-pixel-codings)，但无法理解 - 如果这是我要找的，请有人把它弄小一点吗？

### 跟进问题：

[为什么从 TCP 套接字读取整数数组时会得到奇怪的结果？](https://stackoverflow.com/questions/673799/why-do-i-get-weird-results-when-reading-an-array-of-integers-from-a-tcp-socket)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-23T04:34:20.370

write 的原型是：

```
ssize_t write(int fd, const void *buf, size_t count); 
```

因此，虽然它以字节为单位写入，但它可以采用任何类型的指针。通过一个`int*`将完全没有问题。

**编辑：**

但是，我建议您还发送您计划首先发送的整数数量，以便接收者知道要读取多少。像这样的东西（为简洁起见省略了错误检查）：

```
int x[10] = { ... };
int count = 10;
write(sock, &count, sizeof(count));
write(sock, x, sizeof(x)); 
```

注意：如果数组来自动态内存（就像你`malloc`编辑它），你不能使用`sizeof`它。在这种情况下，计数将等于：`sizeof(int) * element_count`

**编辑：**

正如[Brian Mitchell](https://stackoverflow.com/questions/672241/how-do-i-send-an-array-of-integers-over-tcp-in-c/672253#672253)所指出的，您可能还需要注意[字节序](http://en.wikipedia.org/wiki/Endianness)问题。发送任何多字节值时就是这种情况（如我推荐的计数以及数组的每个元素）。这是通过：`htons`/`htonl`和`ntohs`/`ntohl`函数完成的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-23T04:37:41.877

Write 可以做你想做的事，但是有一些事情需要注意：

1：您可能会收到不在 int 边界上的部分写入，因此您必须准备好处理这种情况

2：如果代码需要可移植，您应该将您的数组转换为特定的字节序，或者对消息中的字节序进行编码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T04:34:31.853

是的，您可以将指向缓冲区的指针转换为指向 的指针`char`，然后用它调用`write()`。在 C 中将指针强制转换为不同类型不会影响所指向的内存的内容——它所做的只是表明程序员打算以不同的方式解释该地址处的内存内容。

只需确保您提供`write()`正确的数组字节大小 - 在您的情况下，这将是元素的次数`sizeof (long)`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T04:39:44.163

发送单个 int（假设为 4 字节 int）的最简单方法是：

```
int tmp = htonl(myInt);
write(socket, &tmp, 4); 
```

其中 htonl 是将 int 转换为[网络字节顺序](http://en.wikipedia.org/wiki/Endianness#Endianness_in_networking)的函数。（类似地，当您从套接字读取时，该函数`ntohl`可用于转换回主机字节顺序。）

对于整数数组，您首先希望将数组成员的计数作为整数发送（按网络字节顺序），然​​后发送整数值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T08:36:07.887

在您的客户端/服务器程序中具有序列化/反序列化功能会更好。

每当您要发送数据时，将数据序列化到字节缓冲区中，然后通过 TCP 发送并使用字节数。

接收数据时，将缓冲区中的数据反序列化为您自己的解释。

您可以根据需要以任何形式解释字节缓冲区。它可以包含基本数据类型、对象等。

只要确保照顾好字节序和对齐的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-20T06:39:56.763

声明一个字符数组。在数组的每个位置，存储整数，而不是字符。然后你就发送那个。

例如：

```
char tcp[100];

tcp[0] = 0;
tcp[1] = 0xA;
tcp[2] = 0xB;
tcp[3] = 0xC;
.
.

// Send the character array
write(sock, tcp, sizeof(tcp)); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T06:22:58.363

我认为您需要在这里提出一个**协议**。

假设您的整数数组是：

```
100, 99, 98, 97 
```

我不会将整数直接写入缓冲区，而是通过将数组转换为字符串表示来“序列化”数组。字符串可能是：

```
"100,99,98,97" 
```

这就是将通过电线发送的内容。在接收端，您将用逗号分割字符串并备份数组。

这更加标准化，人类可读，并且意味着人们不必考虑高/低字节顺序和其他愚蠢的事情。

*// 讽刺*

如果您使用的是 .NET 或 Java，您可能会将其编码为 XML，如下所示：

```
<ArrayOfInt><Int>100</Int><Int>99</Int><Int>98</Int><Int>97</Int></ArrayOfInt> 
```

:)

# internet-explorer - DIV下出现奇怪的IE7间距

> ID：672251
> 
> 赞同：0
> 
> 时间：2009-03-23T04:36:14.187
> 
> 标签：internet-explorer, css, cross-browser

[http://www.downloadadeal.com.au/](http://www.downloadadeal.com.au/)

上面的网站在除 IE7 之外的所有浏览器中都很好，其中在内容和布局底部的页脚之间出现了一个奇怪的空间？两条页脚线应该匹配。有没有人经历过无法解释的间距？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T05:00:15.533

不确定，但是您有一个 CSS 规则“div#page-content”，其高度值设置为“auto！important”，这可能是问题所在，因为它覆盖了一个更具体的名为“body#home div#”的规则page-content' 试图将高度设置为 636px。我可以看到您正在尝试在此页面的左侧和右侧保持像素精度，而该项目可能会阻碍您？

只是要看的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T19:24:39.967

'#home-content' 上的 'margin-bottom' 通过 IE 上的 '#page-content' 底部折叠，而在其他浏览器上，它正确地位于浮动上方，正好位于 '#home-content' 之后。

边距折叠很难正确处理，尤其是考虑到 IE 的错误，所以如果可以的话，通常最好避免（使用 padding-top/bottom 代替）。

在任何情况下，我强烈建议您*不要*尝试使您的页面高度与此页面上的像素数相同。字体设置/大小的任何更改都会严重破坏它；例如，如果我将文本大小放大一半，则文本会从其容器中掉出，从而使页面完全无法使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T04:45:24.430

使用 IE，在内容之后立即关闭 div 是个好主意：而不是这样：

```
<div>
  My Content
</div> 
```

做这个：

```
<div>
  My Content</div> 
```

我知道，它弄乱了你漂亮的缩进，但我发现它对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T05:06:44.163

您在页脚中使用 p 标签。这可能设置了边距。（HTML4 的默认值为 1.12 em）。尝试添加 margin-bottom: 0px; 到页脚中 p 元素的样式。

在各种 div 标签之间还有一些杂散的空格字符。

# php - 有没有办法（或最佳实践）标记 CSV 文档的头部（等价物）？

> ID：672252
> 
> 赞同：0
> 
> 时间：2009-03-23T04:36:48.400
> 
> 标签：php, csv

我正在使用 PHP 从数据库中导出数据以将其转换为 CSV。我认为为第一行提供一个标题（类似于`<th>`HTML 中的元素）会很有用，这样最终用户就会理解该列的含义。例子

```
=============
| id | name |
=============
| 0  | tim  |
| 1  | tom  |
============= 
```

这看起来像一个 CSV

```
id, name
0, tim
1, tom 
```

有没有办法标记第一行的列或做任何不同的事情，经常读取 CSV 的程序（例如 Microsoft Excel）会相应地标记它。即提供一个语义挂钩来通知客户端（可能是 Excel 但不限于）这是一个列标题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T04:38:43.637

没有。为了让它更有趣，没有什么说标题行必须存在。好时光，好时光……

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T09:36:24.170

使用 CSV 要避免的一个关键是避免使用“ID”作为文件中的第一个字符。小写的“id”或双引号的“ID”是可以接受的，但如果 Excel 遇到大写的“ID”，它会尝试将文件作为 SYLK 文件打开并失败。

（编辑：注意上面的单引号应该被忽略）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T04:50:25.060

我能想到的最佳做法是只将标题放在第一行。但这显然是常识。

# c# - C# 中的文件比较

> ID：672259
> 
> 赞同：2
> 
> 时间：2009-03-23T04:39:53.557
> 
> 标签：c#, video, file, audio, comparison

是否有任何内置类/方法来比较两个音频/视频文件的内容？或者是否有任何内置类/方法将音频/视频文件转换为比特流？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T04:45:08.973

您可以在两个文件流上使用 System.Security.Cryptography 中的哈希函数并进行比较。这很容易做到，并且适用于小文件。如果您的文件很大，如果您正在处理音频/视频，它们可能是很大的，那么读取文件并生成哈希可能需要一些时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T05:58:35.583

其他答案很好 - 散列（如果您将文件与多个候选者进行比较）或逐字节比较（如果比较两个单个文件）。

以下是一些额外的想法：

首先，检查文件大小——如果它们不同，那么不要浪费时间比较字节。这些可以快速检查。

其次，尝试使用二分法从文件的末尾或中间进行搜索。

例如，假设你有一个这样的文件：

```
ABCDEFGHIJKLMNOP 
```

然后修改成这样：

```
ABCDEF11GHIJKLMN 
```

为了使文件大小保持不变，并且要插入内容，其他字节将被“剔除”。因此，二进制切分方法可能会以更少的读取来解决这个问题（例如，从两个文件中查找和读取字节 SIZE/2-10 到 SIZE/2+10，并进行比较）。

你可以尝试结合这些技术。如果您对所处理的数据的足够好的样本进行此操作，您可能会发现您比较的所有不同文件（示例）：

*   80% 被发现是因为文件大小不同（每个文件 10ms）
*   10% 被发现是由于二进制斩波（每个文件 50 毫秒）
*   由于线性字节比较（每个文件 2000 毫秒）发现了 10%

对整个文件进行二进制切碎不会那么聪明，因为我希望如果线性读取而不是寻找随机点，硬盘会更快。但是，如果您检查 SIZE/2，然后是 SIZE/4+SIZE/4x3，然后是 SIZE/8，例如 5 次迭代，您可能会发现大部分差异，而无需进行逐字节比较。只是一些想法。

另外，不是从文件的前面读取，而是尝试从文件的末尾向后读取。同样，您可能会用寻找时间来换取概率，但在“插入”场景中，假设在文件中途进行了更改，您可能会发现从末尾开始比从头开始更快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T04:41:59.150

您可以对这两个文件进行逐字节比较。System.IO.File.ReadAllBytes(...) 对此很有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T08:39:10.470

没有直接的方法来比较文件。而且您必须处理音频/视频文件，这些文件会比较大，我不知道按位比较是否有效。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-02-05T14:34:28.167

**示例：2 个文件的二进制比较**

```
/// <summary>
/// Methode, die einen Binärvergleich von 2 Dateien macht und
/// das Vergleichsergebnis zurückliefert.
/// </summary>
/// <param name="p_FileA">Voll qualifizierte Pfadangabe zur ersten Datei.</param>
/// <param name="p_FileB">Voll qualifizierte Pfadangabe zur zweiten Datei.</param>
/// <returns>True, wenn die Dateien binär gleich sind, andernfalls False.</returns>
private static bool FileDiffer(string p_FileA, string p_FileB)
{
    bool retVal = true;
    FileInfo infoA = null;
    FileInfo infoB = null;
    byte[] bufferA = new byte[128];
    byte[] bufferB = new byte[128];
    int bufferRead = 0;

    // Die Dateien überprüfen
    if (!File.Exists(p_FileA))
    {
        throw new ArgumentException(String.Format("Die Datei '{0}' konnte nicht gefunden werden", p_FileA), "p_FileA");
    }
    if (!File.Exists(p_FileB))
    {
        throw new ArgumentException(String.Format("Die Datei '{0}' konnte nicht gefunden werden", p_FileB), "p_FileB");
    }

    // Dateiinfo wegen der Dateigröße erzeugen
    infoA = new FileInfo(p_FileA);
    infoB = new FileInfo(p_FileB);

    // Wenn die Dateigröße gleich ist, dann einen Vergleich anstossen
    if (infoA.Length == infoB.Length)
    {
        // Binärvergleich
        using (BinaryReader readerA = new BinaryReader(File.OpenRead(p_FileA)))
        {
            using (BinaryReader readerB = new BinaryReader(File.OpenRead(p_FileB)))
            {
                // Dateistream blockweise über Puffer einlesen
                while ((bufferRead = readerA.Read(bufferA, 0, bufferA.Length)) > 0)
                {
                    // Dateigrößen sind gleich, deshalb kann hier
                    // ungeprüft auch von der 2\. Datei eingelesen werden
                    readerB.Read(bufferB, 0, bufferB.Length);

                    // Bytevergleich innerhalb des Puffers
                    for (int i = 0; i < Math.Min(bufferA.Length, bufferRead); i++)
                    {
                        if (bufferA[i] != bufferB[i])
                        {
                            retVal = false;
                            break;
                        }
                    }

                    // Wenn Vergleich bereits fehlgeschlagen, dann hier schon abbruch
                    if (!retVal)
                    {
                        break;
                    }
                }
            }
        }
    }
    else
    {
        // Die Dateigröße ist schon unterschiedlich
        retVal = false;
    }

    return retVal;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-02-05T14:26:53.767

**示例：在 .NET (C#) 中生成 SHA1 和 MD5 哈希**

```
public static string GenerateHash(string filePathAndName)
{
  string hashText = "";
  string hexValue = "";

  byte[] fileData = File.ReadAllBytes(filePathAndName);
  byte[] hashData = SHA1.Create().ComputeHash(fileData); // SHA1 or MD5

  foreach (byte b in hashData)
  {
    hexValue = b.ToString("X").ToLower(); // Lowercase for compatibility on case-sensitive systems
    hashText += (hexValue.Length == 1 ? "0" : "") + hexValue;
  }

  return hashText;
} 
```

# c - 快速调用 GCC 示例

> ID：672268
> 
> 赞同：10
> 
> 时间：2009-03-23T04:46:47.423
> 
> 标签：c, gcc, compiler-construction, fastcall

有人可以提供一个用于 gcc 的 fastcall 示例吗？如果可能，您能否在不使用 fastcall 的情况下提供等效调用并解释它们有何不同？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-23T05:06:15.503

给定函数调用在 C 代码中的显示方式没有区别。唯一的区别在于函数声明。[GCC 手册](http://gcc.gnu.org/onlinedocs/gcc-4.3.2//gcc/Function-Attributes.html#Function-Attributes)有更多细节。

```
$ cat fastcall.c
extern void foo1(int x, int y, int z, int a) __attribute__((fastcall));
extern void foo2(int x, int y, int z, int a);

void bar1()
{
    foo1(99, 100, 101, 102);
}

void bar2()
{
    foo2(89, 90, 91, 92);
}

$ gcc -m32 -O3 -S fastcall.c -o -
.
.
bar1:
.
.    
    movl    $100, %edx
    movl    $99, %ecx
    movl    $102, 4(%esp)
    movl    $101, (%esp)
    call    foo1
.
.
bar2:
.
.
    movl    $92, 12(%esp)
    movl    $91, 8(%esp)
    movl    $90, 4(%esp)
    movl    $89, (%esp)
    call    foo2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T05:02:16.700

这里有几个链接

[是否可以说服 GCC 模仿 fastcall 调用约定？](https://stackoverflow.com/questions/165496/is-it-possible-to-convince-gcc-to-mimic-the-fastcall-calling-convention)

[http://www.google.com/search?q=gcc+fastcall](http://www.google.com/search?q=gcc+fastcall)

# c# - 检测连接到局域网的主机

> ID：672279
> 
> 赞同：3
> 
> 时间：2009-03-23T04:56:01.550
> 
> 标签：c#, detection, autodiscovery

为了在 c# 中创建局域网信使，我需要使用相同的局域网信使软件明显地在线检测主机。我试图寻找这样做的起点，但徒劳无功。我需要知道如何开始工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T05:18:52.527

我过去有两种方法：让所有客户端连接到预定义的主机（简单，但需要一些客户端配置）和让主机（或客户端）通过“广播”地址广播它们的存在（例如, 10.0.255.255）（硬，防火墙/NAT 会让生活变得痛苦，客户端不需要配置）。

但是，是的——如果 WCF 实现了一个发现协议，那就去吧。如果它做你想做的事，它可能比你（或大多数人，就此而言）可以写的任何东西都要好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T05:02:23.547

您可以使用 Windows 连接基础吗？如果是这样，您可以使用 WCF 来实现 WS-Discovery 协议。这是一个[简短](http://weblogs.asp.net/gsusx/archive/2009/02.aspx)的操作方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T05:20:12.070

根据您是否计划依赖集中式服务器，您可以选择：

1）无服务器：当客户端上线时，他会广播自己的身份，要求其他客户端发送他们的身份。

2）集中服务器：一个新的客户端连接，他注册到服务器并下载客户端列表。然后通知每个客户端（通过轮询，如果使用 WCF，则通过双工合同，或通过基本套接字连接）新客户端。

第一个版本将基于 UDP 套接字。请注意，这不适用于本地网络，因为我相信这些数据包不会通过路由器。这也可能是一个糟糕的设计，因为大量客户端只会用数据包淹没网络。但是，嘿，这对你来说可能就足够了。

WCF 还提供点对点支持，您可能会感兴趣。[这](http://msdn.microsoft.com/en-us/magazine/cc188685.aspx)是一篇关于它的文章。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T05:31:44.477

您可能喜欢使用 ZeroConf aka Bonjour、Rendevous 或有时是 Avahi。

[http://www.mono-project.com/Mono.Zeroconf](http://www.mono-project.com/Mono.Zeroconf)

[http://craz.net/programs/ZeroconfNetServices/](http://craz.net/programs/ZeroconfNetServices/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-04T11:42:16.423

使用我在 LAN Messenger 中使用的这个 GetComputers() 方法

```
using System.Diagnostics;

public static string[] GetComputers()
{
    //Process that retrieves the net view >> list of computers on the network
    Process proc = new Process();
    proc.StartInfo.FileName = "net.exe";
    proc.StartInfo.CreateNoWindow = true;
    proc.StartInfo.Arguments = "view";
    proc.StartInfo.RedirectStandardOutput = true;
    proc.StartInfo.UseShellExecute = false;
    proc.Start();

    //Reads the output of the net view.
    StreamReader sr = new StreamReader(proc.StandardOutput.BaseStream);
    string line = "";

    List<string> names = new List<string>();
    while ((line = sr.ReadLine()) != null)
    {
        if (line.StartsWith(@"\\"))
            names.Add(line.Substring(2).Split(' ')[0].TrimEnd());
    }

    sr.Close();
    proc.WaitForExit();

    //Array that contains computer names
    string[] computerNames = new string[names.Capacity];
    int i = 1;

    //Adds computers names to the list view
    foreach (string name in names)
    {
        computerNames[i] = name;
        i++;
    }

    return computerNames;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T05:17:51.890

您可以让您的应用程序在预定义的端口上侦听，当有人连接到该端口时，会发回某种确认，例如应用程序名称和 IP。

因此，当一个新客户端上线时，它会发送一个广播，一个 UDP 数据包广告它的 IP。其他客户端将在相关端口上侦听这些“公告”，并将其自己的 IP（通过其他端口）发送回发送者。因此，现在 LAN 上所有正在运行的客户端将使用其 IP 联系初始发送者。其他客户端也可以记录“通知”发送者的 IP - 这也可以让他们保持网络上其他客户端的最新列表。

为了使列表保持最新，您可以让所有客户端以半随机间隔（例如每分钟 + rand(10) 秒）在网络上广播它们的存在。

以上所有内容都假设您正在谈论同一网络上的客户端。如果您在 Internet 上执行此操作，则需要一些中心点来跟踪已登录客户端的 ips。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T05:20:13.897

我认为可以ping通广播ip并得到每个人的答复。或类似的东西。可以从那开始，然后检查客户端是否正在侦听某个端口或其他东西。

另一种方法是让客户端告诉服务器“我们还在这里！” 每隔一段时间。

# ruby-on-rails - 如何准备好迎接科技危机

> ID：672286
> 
> 赞同：1
> 
> 时间：2009-03-23T05:03:40.083
> 
> 标签：ruby-on-rails, scalability, mongrel

在接下来的几天里，我们很有可能会受到技术压力的影响。不幸的是，我们还没有上线，所以我们无法很好地估计我们的系统如何处理生产观众。

我们的生产设置由 2 个 EngineYard 切片组成，每个切片带有 3 个 mongrel 实例，使用 Postgres 作为数据库服务器。

显然，我们的应用程序将如何保持的很大一部分与我们的实际代码和查询等有关。但是，如果有任何关于期望什么样的负载或有经验的人的经验的提示/指针，那将是很好的。经历过。6 个 mongrel 实例（如果服务器可以接受的话，可能是 8 个）听起来会处理负载，或者至少是大部分？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T02:21:44.587

由于 Facebook 上的病毒式增长，我曾开发过几个经历过高负载的 Rails 应用程序。

您的杂种数量应基于几个因素。如果您的杂种进行 API 调用或发送电子邮件并且必须等待响应，那么您应该尽可能多地运行。否则，请尝试为每个 CPU 内核保持一个杂种，可能还剩下几个。

确保您的服务器使用的是公平代理平衡器（不是循环）。这是执行此操作的 nginx 模块：http: [//github.com/gnosek/nginx-upstream-fair/tree/master](http://github.com/gnosek/nginx-upstream-fair/tree/master)

这里还有一些关于改进和基准测试应用程序性能以处理负载的其他技巧：

**活动记录**

Rails 应用程序面临的最常见问题是 ActiveRecord 对象的使用不当。当只需要一个查询时，进行 100 个查询是很容易的。确定这是否可能是您的应用程序问题的最简单方法是设置[New Relic](http://www.newrelic.com/)。在向您网站上的每个主要页面发出请求后，请查看 newrelic SQL 概述。如果您依次看到大量非常相似的查询（从 id = 1 的帖子中选择 *，从 id = 2 的帖子中选择 *，从帖子中选择 *...），这可能表明您需要使用：包括在您的一个 ActiveRecord 调用中。

*其他一些基本的 ActiveRecord 技巧（这些只是我能想到的）：*

1.  如果您还没有这样做，请确保正确使用数据库表上的索引。

2.  避免在视图中进行数据库调用，尤其是局部调用，很容易忘记您在视图中进行了多少数据库查询。将所有查询和计算推送到您的模型或控制器中。

3.  避免在迭代器中进行查询。通常这可以通过使用 :include 来完成。

4.  尽可能避免让 rails 为大型数据集构建 ActiveRecord 对象。当你调用 Post.find(:all).size 时，会为数据库中的每个 Post 实例化一个新类（它也可能是一个大查询）。在这种情况下，您可能希望使用 Post.count(:all)，它会进行一次快速查询并返回一个整数而不实例化任何对象。

5.  `User..has_many :objects`像create a`user.objects`和`user.object_ids`method这样的关联。后者跳过 ActiveRecord 对象的实例化并且可以更快。尤其是在处理大量对象时，这是加快处理速度的好方法。

6.  尽可能学习和使用 named_scope。它将帮助您保持代码很小，并使高效查询变得更加容易。

**外部 API 和 ActionMailer**

尽可能不要在处理请求时对外部服务进行 API 调用。您的服务器将停止执行代码，直到收到响应。这不仅会增加加载时间，而且您的 mongrel 将无法处理新请求。

如果您绝对必须在请求期间进行外部调用，则需要运行尽可能多的 mongrel，因为您可能会遇到其中许多都在等待 API 响应而不做任何其他事情的情况。（这是构建 Facebook 应用程序时非常常见的问题）

在某些情况下，这同样适用于发送电子邮件。如果您希望许多用户在短时间内注册，请务必对 ActionMailer 传递消息所需的时间进行基准测试。如果它几乎不是即时的，那么您应该考虑将电子邮件存储在您的数据库中，并使用单独的脚本来传递它们。

已经创建了诸如[BackgroundRB](http://backgroundrb.rubyforge.org/)之类的工具来解决这个问题。

**缓存**

[这是关于在 rails 中缓存的不同方法的一个很好的指南。](http://guides.rubyonrails.org/caching_with_rails.html)

**基准测试（定位性能问题）** 如果您怀疑某个方法可能运行缓慢，请尝试在控制台中对其进行基准测试。这是一个例子：

```
>> Benchmark.measure { User.find(4).pending_invitations }
=> #<Benchmark::Tms:0x77934b4 @cutime=0.0, @label="", @total=0.0, @stime=0.0, @real=0.00199985504150391, @utime=0.0, @cstime=0.0> 
```

跟踪应用程序中运行缓慢的方法。这些是您要避免频繁执行的那些。在某些情况下，只有第一次调用会很慢，因为 Rails 有查询缓存。您也可以使用[Memoization](http://ryandaigle.com/articles/2008/7/16/what-s-new-in-edge-rails-memoization)自己缓存该方法。

NewRelic 还将很好地概述方法和 SQL 调用执行所需的时间。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T05:06:36.580

查看一些负载测试软件，例如[WEBLoad](http://www.webload.org/)，或者如果您有钱，可以使用 Quick Test Pro。这将有助于给你一些想法。WEBLoad 可能是在您的情况下最好的测试。

您可以生成数以千计的虚拟节点访问您的站点，并且可以根据该负载检查服务器的性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T14:14:31.117

根据我观察我们的一些客户吸收嘎吱嘎吱声的经验，流量相当适中 - 不是人们似乎期望的骨头粉碎峰值。现在，如果你被联合并在雅虎的页面上制作，事情可能会有所不同。

如果您想了解他们如何处理它（Yahoo FP），请搜索 Facestat.com 的经验。

如果您的服务器太热，我的建议是准备关闭注册或转到更静态的网站版本。使用监控/分析工具也是一个好主意，我喜欢 FiveRuns Manage 工具以便于设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T18:54:30.397

由于您使用的是 EngineYard，因此您应该能够在必要时分配更多机器来处理负载

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T20:52:22.547

您的大问题可能不是传入请求的数量，而是数据库中的数据量向您显示您的查询没有使用您期望的索引，或者返回太多数据，例如用户列表页面有效有 10 个用户，但是当您尝试在该页面上显示 10,000 个用户时死掉，因为您没有添加分页（will_paginate 插件几乎是您的朋友 - 注意为您生成的“选择计数（*）”查询）

所以要注意两件事：

1.  缺少索引
2.  每页数据过多

对于#1，有一个插件在每次查询后运行“解释...”查询，因此您可以手动检查索引使用情况

有一个插件可以为您生成各种类型的数据，也可以帮助您填充数据库以测试这些查询。

对于 #2，使用 will_paginate 插件或其他方式来减少每页的数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T00:31:57.173

我们的设置与您基本相同，在 EY 有 2 个 prod slice 和一个 staging slice。我们发现 ab 是一个很棒的负载测试工具 - 只需编写一个 bash 脚本，其中包含您希望被命中的 url 并将其指向您的切片。观看 NewRelic 统计数据，它应该让您了解您的应用程序可以处理的负载以及您可能需要优化的地方。

我们还发现 query_reviewer 也非常有用。它非常适合查找那些未索引的表和 n+1 查询。

# testing - 等待，VBScript

> ID：672293
> 
> 赞同：0
> 
> 时间：2009-03-23T05:08:35.297
> 
> 标签：testing, watin

我正在使用[WatiN](http://en.wikipedia.org/wiki/Watir#WatiN)进行网络测试。在我的一个网页中，我有一个打开对话框的 VBScript 函数。我无法使用 WatiN 访问它。

我尝试使用 WatiNTestRecorder；它没有成功。

我也试过这个：http: [//blogs.dovetailsoftware.com/blogs/kmiller/archive/2008/07/16/scenario-testing-with-watin.aspx](http://blogs.dovetailsoftware.com/blogs/kmiller/archive/2008/07/16/scenario-testing-with-watin.aspx)，再次失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T15:45:57.400

您是否尝试过 VbScriptMsgBoxDialogHandler？跟随一个例子

```
 var handler = new VbScriptMsgBoxDialogHandler(buttonToPush);
    using(new UseDialogOnce(Ie.DialogWatcher, handler ))
    {
        Ie.Button("vbScriptMsgBox").ClickNoWait();
        handler.WaitUntilHandled(10);

                Assert.That(handler.HasHandledDialog, "Should have handled dialog");                
    } 
```

# c - 在C中进行二进制算术的最佳方法？

> ID：672294
> 
> 赞同：8
> 
> 时间：2009-03-23T05:09:58.007
> 
> 标签：c, binary, performance, math, processing-efficiency

我正在学习 C 并编写一个简单的程序，该程序将假定每个为二进制数的 2 个字符串值并根据用户选择执行算术运算：

*   添加两个值，
*   从输入 1 中减去输入 2，或
*   将两个值相乘。

我的实现假设字符串中的每个字符都是一个二进制位，例如`char bin5 = "0101";`，但是一次解析字符串一个字符的方法似乎太天真了。理想情况下，我想直接使用二进制值。

在 C 中执行此操作的最有效方法是什么？有没有更好的方法将输入视为二进制值，而不是`scanf()`从字符串中获取每一位？

我做了一些研究，但从初学者的角度来看，我没有发现任何明显更好的方法。任何建议，将不胜感激！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-23T05:26:48.497

**建议：**
没有什么比一次遍历一个字符并确保用户只输入一个和零更好的了。请记住，即使**假设**所有内容都是or ，您也可以编写一个*非常*快速的汇编程序，但您并不想这样做。用户可以输入任何内容，并且您希望能够告诉他们他们是否搞砸了。**`1``0`**

 **确实，与添加实际数字可能需要的几个周期相比，这看起来慢得令人难以置信，但是如果你在纳秒或毫秒内得到答案真的很重要吗？无论如何，人类只能检测到 30 毫秒的延迟。

最后，与解析字符串或添加数字相比，从用户那里获取输入并将输出写入屏幕所花费的时间要长得多，因此您的算法在这里几乎不是瓶颈。为实际上计算密集型的事物保存您的花哨优化:-)。

您在这里应该关注的是减少任务的人力密集度。而且，事实证明，有人已经为你做到了。

**[解决](http://linux.die.net/man/3/strtol)**方案：**
查看[手册页](http://linux.die.net/man/3/strtol)：[`strtol()`](http://linux.die.net/man/3/strtol)**

 **```
long strtol(const char *nptr, char **endptr, int base); 
```

这将允许您将任何基数的字符串 (nptr) 转换为长字符串。它也检查错误。转换二进制字符串的示例用法：

```
#include <stdlib.h>

char buf[MAX_BUF];
get_some_input(buf);

char *err;
long number = strtol(buf, &err, 2);
if (*err) {
    // bad input: try again?
} else {
    // number is now a long converted from a valid binary string.
} 
```

提供 base 2 告诉`strtol`转换二进制文字。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T06:26:35.157

首先，我确实建议您使用 tgamblin 推荐的 strtol 之类的东西，最好使用 lib 提供给您的东西，而不是一遍又一遍地创建轮子。

但是由于你正在学习 CI 做了一个没有 strtol 的小版本，它既不快速也不安全，但我确实以位操作为例进行了一些操作。

```
int main()
{
    unsigned int data = 0;
    int i = 0;

    char str[] = "1001";

    char* pos;
    pos = &str[strlen(str)-1];

    while(*pos == '0' || *pos == '1')
    {
        (*pos) -= '0';
        data += (*pos) << i;

        i++;
        pos--;
    }

    printf("data %d\n", data);
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T07:12:24.453

为了获得最佳性能，您需要区分函数的可信输入和不可信输入。

例如，一个`getBinNum()`接受用户输入的函数应该检查有效字符并压缩以删除前导零。首先，我们将展示一个通用的就地压缩函数：

```
// General purpose compression removes leading zeroes.
void compBinNum (char *num) {
    char *src, *dst;

    // Find first non-'0' and move chars if there are leading '0' chars.
    for (src = dst = num; *src == '0'; src++);
    if (src != dst) {
        while (*src != '\0')
            *dst++ = *src++;
        *dst = '\0';
    }

    // Make zero if we removed the last zero.
    if (*num == '\0')
            strcpy (num, "0");
} 
```

然后提供一个检查器函数，该函数返回传入的值，如果无效则返回 NULL：

```
// Check untested number, return NULL if bad.
char *checkBinNum (char *num) {
    char *ptr;

    // Check for valid number.
    for (ptr = num; *ptr == '0'; ptr++)
        if ((*ptr != '1') && (*ptr != '0'))
            return NULL;

    return num;
} 
```

然后输入函数本身：

```
#define MAXBIN 256

// Get number from (untrusted) user, return NULL if bad.
char *getBinNum (char *prompt) {
    char *num, *ptr;

    // Allocate space for the number.
    if ((num = malloc (MAXBIN)) == NULL)
        return NULL;

    // Get the number from the user.
    printf ("%s: ", prompt);
    if (fgets (num, MAXBIN, stdin) == NULL) {
        free (num);
        return NULL;
    }

    // Remove newline if there.
    if (num[strlen (num) - 1] == '\n')
        num[strlen (num) - 1] = '\0';

    // Check for valid number then compress.
    if (checkBinNum (num) == NULL) {
        free (num);
        return NULL;
    }
    compBinNum (num);

    return num;
} 
```

应该编写其他要相加或相乘的函数，以假设输入已经有效，因为它是由该库中的一个函数创建的。我不会为他们提供代码，因为它与问题无关：

```
char *addBinNum (char *num1, char *num2) {...}
char *mulBinNum (char *num1, char *num2) {...} 
```

如果用户选择从 以外的其他地方获取数据`getBinNum()`，您可以允许他们调用`checkBinNum()`来验证它。

如果你真的很偏执，你可以检查每个传递给你的例程的数字并采取相应的行动（返回 NULL），但这需要相对昂贵的检查，而这是不必要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T05:25:07.550

将字符串解析为整数，然后对整数进行数学运算不是更容易吗？

我假设这是一项学校作业，但我赞成你，因为你似乎付出了很大的努力。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-11-27T20:27:16.113

仅仅因为字符串仅由集合 {0,1} 中的数字组成而假设字符串是二进制数是危险的。例如，当您的输入是“11”时，用户可能指的是十进制的 11，而不是二进制的 3。正是这种粗心大意导致了可怕的错误。您的输入不完整，您应该真正要求用户也指定基础。

# sharepoint - SharePoint 默认视图忽略自定义标题 DisplayName

> ID：672297
> 
> 赞同：6
> 
> 时间：2009-03-23T05:12:35.053
> 
> 标签：sharepoint, content-type, wss-3.0

我创建了一个从联系人继承的自定义内容类型（即 <ContentType ID="0x010600..."），并且我正在尝试使用以下内容重命名“标题”字段：

```
<FieldRefs>
    <FieldRef ID="{fa564e0f-0c70-4ab9-b863-0177e6ddd247}" Name="Title" DisplayName="Last Name" Sealed="TRUE"  />
    <FieldRef ID="{82642ec8-ef9b-478f-acf9-31f7d45fbc31}" Name="LinkTitle" DisplayName="Last Name" Sealed="TRUE"/>
    <FieldRef ID="{BC91A437-52E7-49E1-8C4E-4698904B2B6D}" Name="LinkTitleNoMenu" DisplayName="Last Name" Sealed="TRUE" />
</FieldRefs> 
```

它在“编辑”、“查看”和“添加”页面中正确重命名，但在默认视图和 DataGrid 视图中始终显示标题。我希望它在任何地方重命名。我正在尝试做的事情是否可行，如果可以，怎么办？任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T20:41:00.093

为了在视图中重命名该字段，您必须使用 ListTemplate 定义您的列表并在此处重复您的字段重命名（以及令人讨厌的重复来自您的内容类型的所有字段，这不是标准的）

# excel - 如何突出显示 Excel 电子表格中的计算字段？

> ID：672308
> 
> 赞同：10
> 
> 时间：2009-03-23T05:21:39.773
> 
> 标签：excel

有没有一种简单的方法可以通过宏或其他方式做到这一点？计算字段是指从其他字段计算的字段，而不是原始输入值。通过突出显示，我的意思是颜色不同。我需要这个来更好地理解来自客户的大型电子表格。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-28T02:46:51.807

要手动执行此操作，请按 F5 键调出 GoTo 对话框。单击特殊单元格按钮。在下一个屏幕上，选择公式（它是右侧的一个选项）。

Excel 将选择所有匹配的单元格。现在只需应用格式即可。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T05:45:58.547

我将假设您在这里只讨论单元格公式而不是 VBA 计算，因为如果您这样做，您可以在 VBA 过程中设置单元格颜色。

执行此操作的方法是在完成后检查单元格中的公式，然后更改其颜色。这里的相关事件是更改，单元格的 HasFormula 属性会告诉您单元格是文字值，还是根据公式计算得出的：

```
Private Sub Worksheet_Change(ByVal Target As Range)
    If Target.HasFormula Then
        Target.Interior.Color = vbRed
    别的
        ' 完全去除背景颜色（即无填充）
        Target.Interior.ColorIndex = xlColorIndexNone
    万一
结束子

```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T06:09:29.597

Excel 具有“跟踪依赖项”的内置功能（显示箭头以显示计算的单元格）

选择包含您的数据的范围。
Excel 2007 -> 公式 -> 跟踪依赖项

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-12-05T02:34:25.530

# TLDR；

使用带有公式的条件格式来突出显示包含公式的所有单元格。

# 细节

在 MS Office 365 版本：5.0.4667.1002 中，以下工作

1.  选择一系列单元格。
    *   **Case1**：`Ctrl + A`用于选择*所有单元格*。
    *   **Case2**：选择*特定范围*。
2.  转到“主页”选项卡的“样式”部分，然后选择“条件格式”>“新建规则”。
3.  “新建格式规则”对话框将打开。
4.  选择“使用公式确定要格式化的单元格”
5.  在文本框中，添加以下规则：`=IsFormula(A1)`
    *   **Case1**：如果您选择了所有单元格，请使用，`A1`因为它是第一个单元格。
    *   **Case2**：如果您选择了特定范围，请替换为范围`A1`中的第一个单元格。
6.  单击格式...
7.  “格式化单元格”对话框将打开。
8.  选择您要应用的格式。例如黄色背景。
9.  单击确定。
10.  例如，所有具有公式的单元格现在都将具有黄色背景。

# 截屏

![您已创建新的格式规则！](https://i.stack.imgur.com/JIVdV.jpg)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-23T05:54:38.150

下面的代码应该循环遍历每个工作表，突出显示以“=”开头的每个单元格并将其着色为所需的颜色（当前颜色为 36，即浅黄色）。

```
Sub HighLightFormulas()
Dim objSheet As Worksheet
Dim strOriginalSheet As String
Dim intMaxBlankCells As Integer
Dim intBlankColumns As Integer
Dim intBlankRows As Integer
Dim intCurrentColumn As Integer
Dim intCurrentRow As Long

intMaxBlankCells = 40
strOriginalSheet = ActiveSheet.Name

For Each objSheet In Worksheets
    intBlankRows = 0
    intCurrentRow = 1
    intCurrentColumn = 1

    Do While intCurrentRow <= 65536 And intBlankRows <= intMaxBlankCells
        intBlankColumns = 0
        intCurrentColumn = 1

        Do While intCurrentColumn <= 256 And intBlankColumns <= intMaxBlankCells
          If Left(objSheet.Cells(intCurrentRow, intCurrentColumn).Formula, 1) = '=' Then
            objSheet.Cells(intCurrentRow, intCurrentColumn).Interior.ColorIndex = 36
          End If
          intCurrentColumn = intCurrentColumn + 1
        Loop

        If intCurrentColumn = intBlankColumns Then
            intBlankRows = intBlankRows + 1
        Else
            intBlankRows = 0
        End If
        intCurrentRow = intCurrentRow + 1
    Loop
Next objSheet
Worksheets(strOriginalSheet).Activate

Call MsgBox("The Highlighting process has completed", vbOKOnly, "Process Complete") 
```

结束子

它也会在连续 40 个空白单元格后停止（以避免处理所有大部分空白表）。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T05:33:22.990

简单的解决方案：Ctrl - `（Tab 上方的键）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T05:29:52.797

您可以使用 Interior.ColorIndex 属性来更改活动单元格的背景颜色：

```
ActiveCell.Interior.ColorIndex = 36 
```

您也可以将其应用于一个范围：

```
Range("A1:A5").Interior.Color = RGB(200,160,35) 
```

这适用于 Excel 2003，我没有使用最新版本，但我怀疑这已经改变了。

您通常可以录制一个宏，然后查看生成的代码以了解某些操作是如何完成的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-23T17:40:36.330

我喜欢 Craig 的代码，因为它保留了现有工作表的布局，但显示了计算的内容和“一目了然”的内容，但我对其进行了一些修改，以便更好地计算活动区域的工作表，我添加了一个“UnhighlightFormulas”子例程，因此可以轻松撤消格式设置（例如在打印之前）。它已经在 Excel 2007 中进行了测试。请注意，运行此程序时您将丢失任何其他单元格背景颜色。

```
Option Explicit
Public Sub HighlightFormulas()
ColorFormulas (36) '36 is yellow
End Sub

Public Sub UnhighlightFormulas()
ColorFormulas (-4142) '-4142 is default
End Sub

Private Sub ColorFormulas(intColor As Integer)
Dim wshSheet As Worksheet
Dim rngRange As Range
Dim rngCell As Range
For Each wshSheet In Worksheets
  Set rngRange = RangeInUse(wshSheet)
  If Not rngRange Is Nothing Then
    For Each rngCell In rngRange
      If Left(rngCell.Formula, 1) = "=" Then
        If rngCell.Interior.ColorIndex <> intColor Then rngCell.Interior.ColorIndex = intColor
      Else
        If rngCell.Interior.ColorIndex <> -4142 Then rngCell.Interior.ColorIndex = -4142 '-4142 is default
      End If
    Next
  End If
Next
End Sub

Private Function RangeInUse(ws As Worksheet) As Range
  Dim LastRow&, LastCol%
' adapted from http://www.beyondtechnology.com/geeks012.shtml
' Error-handling in case there is no data in worksheet
  On Error Resume Next
  With ws
    LastRow& = .Cells.Find(What:="*", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row
    LastCol% = .Cells.Find(What:="*", SearchDirection:=xlPrevious, SearchOrder:=xlByColumns).Column
  End With
  Set RangeInUse = ws.Range("A1", Cells(LastRow&, LastCol%))
End Function 
```

# .net-2.0 - 跨 RDC (.NET) 的自定义剪贴板数据格式

> ID：672311
> 
> 赞同：1
> 
> 时间：2009-03-23T05:23:37.287
> 
> 标签：.net-2.0, clipboard

我正在尝试将自定义对象从 RDC 窗口复制到主机（我的本地）机器中。它失败。这是我用于 1) 复制和 2) 粘贴的代码：

1) 远程（在 Windows XP 上运行的客户端通过 RDC 访问）：

```
 //copy entry
            IDataObject ido = new DataObject();
            XmlSerializer x = new XmlSerializer(typeof(EntryForClipboard));
            StringWriter sw = new StringWriter();
            x.Serialize(sw, new EntryForClipboard(entry));
            ido.SetData(typeof(EntryForClipboard).FullName, sw.ToString());
            Clipboard.SetDataObject(ido, true); 
```

2) 本地（在本地 Windows XP x64 工作站上运行的客户端）：

```
 //paste entry
                IDataObject ido = Clipboard.GetDataObject();
                DataFormats.Format cdf = DataFormats.GetFormat(typeof(EntryForClipboard).FullName);

                if (ido.GetDataPresent(cdf.Name)) //<- this always returns false
                {
                    //can never get here!
                    XmlSerializer x = new XmlSerializer(typeof(EntryForClipboard));
                    string xml = (string)ido.GetData(cdf.Name);
                    StringReader sr = new StringReader(xml);
                    EntryForClipboard data = (EntryForClipboard)x.Deserialize(sr);
                } 
```

不过，它可以在同一台机器上完美运行。

有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T05:37:02.093

您可以研究以下几件事：

1.  您确定对象的序列化确实将其转换为 XML 吗？也许输出的 XML 引用了您的内存空间？尝试查看 XML 的文本来查看。
2.  如果您确实有对象的序列化 XML 版本，为什么不将值存储为纯文本而不使用`typeof(EntryForClipboard)`？就像是：

    ```
    XmlSerializer x = new XmlSerializer(typeof(EntryForClipboard));
    StringWriter sw = new StringWriter();
    x.Serialize(sw, new EntryForClipboard(entry));
    Clipboard.SetText(sw.ToString(), TextDataFormat.UnicodeText); 
    ```

    然后，您在客户端程序中所要做的就是检查剪贴板中的文本是否可以反序列化回您的对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T23:40:32.007

好的，找到问题所在了。使用自定义格式复制 RDC 时，自定义格式名称会被截断为 16 个字符。在行

```
ido.SetData(typeof(EntryForClipboard).FullName, sw.ToString()); 
```

格式名称很长。

当我在主机上接收复制的数据时，可用的格式具有我的自定义格式，但被截断为 16 个字符。

```
IDataObject ido = Clipboard.GetDataObject();
ido.GetFormats(); //used to see available formats. 
```

所以我只使用了一个较短的格式名称：

```
//to copy
ido.SetData("MyFormat", sw.ToString());
...
//to paste
DataFormats.Format cdf = DataFormats.GetFormat("MyFormat");
if (ido.GetDataPresent(cdf.Name)) {
  //this not works
  ... 
```

# flash - FLV 文件和 SWF 文件

> ID：672314
> 
> 赞同：1
> 
> 时间：2009-03-23T05:26:43.427
> 
> 标签：flash, flv

只是想确认一下我目前的理解是否正确，

1.  我们可以使用 Flash Player 浏览器插件来播放 FLV 和 SWF 文件；
2.  FLV 文件只包含视频/音频，但 SWF 文件不仅可以包含视频/音频，还可以包含其他信息（图片/动画/等）。

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T05:31:19.923

flash player 不能直接播放 FLV 文件，你需要一个 FLV 播放器来做到这一点。但你基本上是正确的.. FLV 是一种像 h.264 这样的视频格式，而 SWF 是一种信封格式，几乎可以容纳任何东西

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T10:31:39.030

> 我们可以使用 Flash Player 浏览器插件来播放 FLV 和 SWF 文件；

是的。来自FLV 的[文档](http://www.adobe.com/devnet/flv/)：

> [...] Flash Player 还可以直接播放带有 MIME 类型 video/x-flv 的 FLV 文件。FLV 文件对同步的音频和视频流进行编码。

至于你的另一个问题：

> FLV 文件只包含视频/音频，但 SWF 文件不仅可以包含视频/音频，还可以包含其他信息（图片/动画/等）

是的。同样，我建议您返回[文档](http://www.adobe.com/devnet/swf/)：

> SWF 文件格式通过 Internet 提供矢量图形、文本、视频和声音，并受到 Adob​​e® Flash® Player 和 Adob​​e AIR™ 软件的支持。Flash Player 已经覆盖了超过 98% 的支持 Internet 的台式机以及超过 8 亿部手机和移动设备。
> 
> SWF 文件格式旨在成为一种高效的二进制交付格式，而不是用于在图形编辑器之间交换图形的格式。

其他问题：

> 还有一个问题，如何手动使用 Adob​​e Flash 播放器？

当您双击系统上的 SWF 文件时会发生什么？通常，flash player 独立版应该会出现并播放 SWF 文件。您必须弄清楚可执行文件在系统上的位置。

> 关于如何让 Adob​​e Flash Player 播放 flv 文件的任何想法，以便我可以试一试？

您可以将 flv 拖放到独立播放器上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-22T06:31:51.887

使用 Adob​​e Flash Player 插件，您可以在 Web 浏览器上查看 SWF，但不能查看 FLV。
对于 FLV 需要导出到基于 Web 的 flv 播放器。
所以要把FLV放到网页上播放，你只需要一个FLV播放器。
SWF 可以是一个控制 FLV 文件播放的 FLV 播放器。
[Moyea Web Player](http://www.playerdiy.com/)是一款不错的flash视频播放器创作者，你可以试试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-22T06:37:59.270

自从我今天遇到这个问题以来，请注意，以防万一有人遇到这个问题。

Windows Server 2003 和 IIS 不知道如何正确处理 FLV 文件。因此，如果您有一个 SWF 可以引入 FLV，它就无法正常工作。

需要加载IIS，右键本地计算机，属性，MIME TYPES。并添加：

扩展名：.flv MIME：flv-application/octet-stream

# java - Android：使用 SurfaceView 重新获得焦点

> ID：672325
> 
> 赞同：6
> 
> 时间：2009-03-23T05:37:23.543
> 
> 标签：java, android, surfaceview

我目前正在使用 Android，正在使用 Lunar Lander 示例。

我发现如果您离开应用程序（例如，点击呼叫按钮），它将破坏底层表面（呼叫`surfaceDestroyed`）。

向后导航（这将触发`onWindowVisibilityChanged`）应用程序将崩溃，因为它将尝试绘制到表面而不重新创建它。

是否有一些我可以放入`onWindowVisibilityChanged`（或其他任何地方）的代码来重新生成 SurfaceView 的底层表面并很好地恢复执行？

感觉这应该是一个简单的函数调用，但我在 API 文档中找不到任何内容。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-04T20:28:54.460

“mSurfaceExists = true”的这个解决方案也不适合我。看起来 surfaceCreated() 没有被调用，因为 super.onWindowVisibilityChanged() 没有被调用。所以没有创建表面并且它不会崩溃，因为 threas.start 没有被调用。

我认为问题是：调用 thread.start() 会导致错误，因为线程已经启动。但是在surfaceDestroyed() 中，thread.join 导致线程完成并死亡。并且线程一旦死了就无法重新启动。

我猜这个技巧是在surfacecreated中创建一个新线程，或者只在用户调用应用程序完成（返回键）而不是暂停（home键）时才导致线程完成。这可以通过在活动上调用 isFinishing() 来检查。

不确定这是否可行。我很快就会尝试这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T06:45:22.380

误诊！该应用程序会自动重新创建表面，但其中有一个调用试图在创建之前对其进行绘制。

解决问题：

```
boolean mSurfaceExists;
...
public void surfaceDestroyed(SurfaceHolder holder) {
    mSurfaceExists = false;
    ...
}

public void surfaceCreated(SurfaceHolder holder) {
    mSurfaceExists = true;
    ...
}

protected void onWindowVisibilityChanged(int visibility) {
    // only call base if there's a surface
    if(mSurfaceExists)
        super.onWindowVisibilityChanged(visibility);
} 
```

现在一切都膨胀了。（据我所知，无论如何 - 如果这是不好的做法，Java/Android 专家可以随时发表评论！）

# .net - ASP.NET MVC Web App 中忽略了 AssemblyInfo 版本控制？

> ID：672327
> 
> 赞同：7
> 
> 时间：2009-03-23T05:38:00.187
> 
> 标签：.net, asp.net-mvc, model-view-controller, reflection

这里有一个奇怪的。我的 MVC Web 应用程序的版本号没有根据`AssemblyInfo.cs`. 我在 set 中设置的定义`AssemblyInfo.cs`是' `1.0.232.0`'。

我尝试了多种方法来打印它：

```
<%= System.Reflection.Assembly.GetExecutingAssembly().GetName().Version.ToString()%> 
```

（结果 0.0.0.0）

```
<%= System.Reflection.Assembly.GetCallingAssembly().GetName().Version.ToString()%> 
```

（导致 2.0.0.0，在我的项目中没有设置。）

```
<%= typeof(HomeController).GetType().Assembly.GetName().Version.ToString()%> 
```

（结果为 2.0.0.0）

这让我相信它根本不能拿起我的 AssemblyInfo.cs 文件？如果我尝试使用“发布”按钮发布到我们开发服务器上的 IIS，也会出现这种情况。

有任何想法吗？也许我使用了错误的语句来获取版本号？:\

多谢你们。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-23T08:27:49.920

该视图（默认情况下）仍然在很大程度上按需编译，因此您不能`GetExecutingAssembly()`在视图中可靠地使用 - 但是，对我来说，控制器的使用工作正常：

```
[assembly: AssemblyVersion("1.2.3.4")] 
```

和：

```
<h2><%=typeof(MvcApplication4.Controllers.HomeController).Assembly
   .GetName().Version.ToString() %></h2> 
```

节目

## 1.2.3.4

在页面中。

**编辑** 您犯的错误是调用`typeof(...).GetType()`-这将给您`Type`（或子类）-所以是的，它将是2.x。 **/编辑**

有关预编译视图的额外步骤，请参阅[此处](http://weblogs.asp.net/scottgu/archive/2008/12/19/asp-net-mvc-design-gallery-and-upcoming-view-improvements-with-the-asp-net-mvc-release-candidate.aspx)的“用于编译视图的 MSBuild 任务” 。

可以说，您的视图本身不应该获取这些数据 - 它应该被放入 ViewData （或类似的）中，可能是通过基本控制器或动作过滤器。

* * *

关于母版页的问题；首先，选择一个键；-p

```
<%=ViewData["AppVersion"] %> 
```

然后想到两个选项：`OnActionExecuting`在控制器（或通用基本控制器）中覆盖：

```
 protected override void OnActionExecuting(
        ActionExecutingContext filterContext)
    {
        filterContext.Controller.ViewData["AppVersion"] =
            GetType().Assembly.GetName()
            .Version.ToString(); // probably cached
        base.OnActionExecuting(filterContext);
    } 
```

或创建一个动作过滤器：

```
public class AppVersionAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(
         ActionExecutingContext filterContext)
    {
        filterContext.Controller.ViewData["AppVersion"] =
            GetType().Assembly.GetName()
            .Version.ToString(); // probably cached
        base.OnActionExecuting(filterContext);
    }
} 
```

并使用此属性标记您的控制器（类）或操作（方法）：

```
[HandleError, AppVersion]
public class HomeController : Controller
{ ... } 
```

# c# - 我在 C# asp.net 中有哪些选项可以在网站上绘制图表？

> ID：672329
> 
> 赞同：2
> 
> 时间：2009-03-23T05:39:52.133
> 
> 标签：c#, asp.net, charts

往上看...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T05:41:21.457

几年前我也遇到过同样的问题。当时，哪个选项的明确答案是 Dundas Charts。事实上，我们确实轻松地使用了 Dundas Charts。

从那时起，MS 获得了他们的图表代码库并将其包含在他们的 3.5 框架中。您可以轻松地将它与 ASP.NET 一起使用。看看这篇博文：

[http://weblogs.asp.net/scottgu/archive/2008/11/24/new-asp-net-charting-control-lt-asp-chart-runat-quot-server-quot-gt.aspx](http://weblogs.asp.net/scottgu/archive/2008/11/24/new-asp-net-charting-control-lt-asp-chart-runat-quot-server-quot-gt.aspx)

```
<asp:chart ... 
```

我用于图表的另一个第三方控件库是[Devexpress](http://www.devexpress.com/)。使用 Devexpress 启动和推广产品只需要很少的时间（甚至可能更少），但最终，Dundas 拥有更多的定制功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T05:50:00.190

[ZedGraph](http://zedgraph.org/wiki/index.php?title=Main_Page)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T05:45:29.390

这些选项：

[ASP.NET 图表控件库](http://www.asp.net/community/control-gallery/browse.aspx?category=7)

此外，不要忘记查看 ASP.NET 图表控件（由 Chris 链接）。我相信 MS 从 Dundas 手中买下了控制权。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T16:22:28.810

带有 ASP.NET[包装器](http://groups.google.com/group/google-chart-api/web/useful-links-to-api-libraries)的[Google Chart API](http://code.google.com/apis/chart/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T05:50:25.010

如果您准备好使用[Ajax](http://www.asp.net/ajax/)，请查看 SO 绘制声誉图表的方式。该工具是一个名为[flot](http://code.google.com/p/flot/)的 Jquery 扩展。

> Flot 是一个用于 jQuery 的纯 Javascript 绘图库。它在客户端即时生成任意数据集的图形图。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T07:03:12.977

我过去使用过[http://www.fusioncharts.com/](http://www.fusioncharts.com/ "融合图")，发现它们非常好。

# iphone - 同步 UIScrollView 滚动

> ID：672338
> 
> 赞同：7
> 
> 时间：2009-03-23T05:49:19.753
> 
> 标签：iphone, objective-c, uiscrollview

我有三个 UIScrollView、`scrollView1`、`scrollView2`和`scrollView3`。何时`scrollView1`滚动`scrollView2`则应随之水平滚动，而何时`scrollView3`滚动`scrollView2`则应与其垂直滚动。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-23T08:03:11.460

UIScrollViewDelegate 协议包括 scrollViewDidScroll:。

您可以使用 scrollView2 中的 setContentOffset 和 scrollView1 的委托的 scrollViewDidScroll 中的 scrollView3 设置从属滚动视图的 contentOffset：

# dns - 使用 Windows Server 2008 制作外部 DNS 服务器

> ID：672344
> 
> 赞同：-1
> 
> 时间：2009-03-23T05:52:01.103
> 
> 标签：dns, windows-server-2008

我有一台运行 Windows Server 2008 网页的服务器（我的笔记本电脑：P），我想知道是否可以创建自己的域名而不是为服务付费？我知道 Windows Server 2k8 有一个 DNS 服务，但是让它在外部工作有多容易？听起来这很困难，因为域名不必与 ISP 连接吗？请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T06:14:28.023

在您的计算机上“运行域”（网站、电子邮件等）真的很容易，而无需支付托管服务：

1.  将计算机连接到运行 DNS 的 24/7 互联网。
2.  从域名注册商处购买域名。让我们称之为`mydomain.com`。
3.  配置`mydomain.com`为具有从步骤 1 将用户指向计算机的 NS 记录。这样，任何子域查询`www.mydomain.com`都`mail.mydomain.com`将被发送到该计算机。
4.  在步骤 1 中的计算机上添加 DNS 条目，以将用户发送到正确的计算机。就像将所有重定向`www.mydomain.com`到`12.34.56.78`（如果那是您的网络服务器的 IP。）

完成此操作后，任何查询的 DNS 请求`www.mydomain.com`都将发送到您计算机的 DNS，并以`12.34.56.78`.

如果您在第 1 步中没有计算机的静态 IP，那就更麻烦了，但是有免费服务可以解决这个问题，例如[害怕.org](http://afraid.org)。

当然，看看现在托管有多便宜，您最好还是托管它。它确实为您节省了很多额外的麻烦，而且定制成本很低。

编辑：重新阅读问题后，我意识到您可能只是在 LAN 或其他专用网络中设置 DNS 域。我认为“外部”让我失望了......

# linux - 如何在 Linux 上实现线程安全定时器？

> ID：672350
> 
> 赞同：4
> 
> 时间：2009-03-23T05:57:28.470
> 
> 标签：linux, thread-safety, timer

众所周知，在信号处理程序中做事真的很糟糕，因为它们在类似中断的上下文中运行。调用信号处理程序时，很可能会持有各种锁（包括 malloc() 堆锁！）。

所以我想在不使用信号机制的情况下实现一个线程安全的计时器。

我能怎么做？

抱歉，实际上，我并不期待有关线程安全的答案，而是有关在 Unix 或 Linux 上实现线程安全的计时器的答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T09:01:05.393

在你的线程中使用 usleep(3) 或 sleep(3)。这将阻塞线程，直到超时到期。

如果您需要等待 I/O 并且在任何 I/O 准备好之前让计时器到期，请使用 select(2)、poll(2) 或 epoll(7) 并设置超时。

如果您仍然需要使用信号处理程序，请使用 pipe(2) 创建管道，在线程的读取端执行阻塞读取，或使用 select/poll/epoll 等待它准备好，然后写入一个字节使用 write(2) 到信号处理程序中管道的写入端。你写什么到管道中并不重要——这个想法只是让你的线程唤醒。如果要在一个管道上多路复用信号，请将信号编号或其他 ID 写入管道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T06:14:16.807

您可能应该使用`pthreads`POSIX 线程库之类的东西。它不仅提供线程本身，还提供基本的同步原语，如互斥体（锁）、条件、信号量。这是我发现似乎不错的教程： [http ://www.yolinux.com/TUTORIALS/LinuxTutorialPosixThreads.html](http://www.yolinux.com/TUTORIALS/LinuxTutorialPosixThreads.html)

对于它的价值，如果您完全不熟悉多线程编程，那么在 Java 或 Python 中学习它可能比在 C 中更容易一些，如果您知道其中任何一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T07:19:42.347

我认为解决您描述的问题的通常方法是让信号处理程序只做最少量的工作。例如设置一些 timer_expired 标志。然后你有一些线程定期检查标志是否已设置，并执行实际工作。

如果您不想使用信号，我想您必须让线程休眠或忙等待指定的时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-11T22:32:07.937

使用 Posix 间隔计时器，并通过信号通知它。在信号处理函数内部，几乎没有 C 的函数，如 printf() 可以使用，因为它们不是可重入的。

***使用单个全局标志，声明为静态 volatile***供信号处理程序操作。处理程序应该有这一行代码，没有别的；这个标志应该影响程序中 1 & Only 线程中其他地方的流控制。

```
static volatile bool g_zig_instead_of_zag_flg = false;
...
void signal_handler_fnc()
     g_zig_instead_of_zag_flg = true;
return

int main() {

   if(false == g_zig_instead_of_zag) {
      do_zag();
   }  else  {
      do_zig();
      g_zig_instead_of_zag = false;
    return 0;
} 
```

Michael Kerrisk 的***The Linux Programming Interface*** [有](http://man7.org/tlpi/code/online/dist/timers/ptmr_sigev_signal.c.html)这两种方法的示例，还有一些示例，但是这些示例带有很多他自己的私有函数，你必须开始工作，并且这些示例小心地避免了他们应该探索的许多陷阱，所以不伟大的。

使用通过线程通知的 Poxix 间隔计时器会使一切变得更糟，而 AFAICT，该通知方法几乎没用。我之所以这么说是因为我允许在某些情况下在 main() 线程中什么都不做，而处理程序线程中的所有内容都是有用的，但我肯定想不出任何这样的情况。

# c++ - 如何在 std::vector 中管理动态内存？

> ID：672352
> 
> 赞同：3
> 
> 时间：2009-03-23T05:59:09.917
> 
> 标签：c++, memory-management, stl, vector

std::vector 如何实现对元素数量变化的管理：是使用 realloc() 函数，还是使用链表？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-23T06:28:38.177

它使用分配给它的分配器作为第二个模板参数。那就这样吧。假设它在 push_back 中，`t`设为要推送的对象：

```
...
if(_size == _capacity) { // size is never greater than capacity
    // reallocate
    T * _begin1 = alloc.allocate(_capacity * 2, 0);
    size_type _capacity1 = _capacity * 2;

    // copy construct items (copy over from old location).
    for(size_type i=0; i<_size; i++)
        alloc.construct(_begin1 + i, *(_begin + i));
    alloc.construct(_begin1 + _size, t);

    // destruct old ones. dtors are not allowed to throw here. 
    // if they do, behavior is undefined (17.4.3.6/2)
    for(size_type i=0;i<_size; i++)
        alloc.destroy(_begin + i);
    alloc.deallocate(_begin, _capacity);

    // set new stuff, after everything worked out nicely
    _begin = _begin1;
    _capacity = _capacity1;
} else { // size less than capacity
    // tell the allocator to allocate an object at the right
    // memory place previously allocated
    alloc.construct(_begin + _size, t);
}
_size++; // now, we have one more item in us
... 
```

类似的东西。分配器将关心分配内存。它将分配内存和将对象构造到该内存中的步骤分开，因此它可以预先分配内存，但还不能调用构造函数。在重新分配期间，向量必须注意复制构造函数抛出的异常，这使事情有些复杂化。以上只是一些伪代码片段 - 不是真正的代码，可能包含许多错误。如果大小超过容量，它会要求分配器分配一个新的更大的内存块，如果没有，那么它只是在先前分配的空间上构造。

这的确切语义取决于分配器。如果它是标准分配器，构造会做

```
new ((void*)(_start + n)) T(t); // known as "placement new" 
```

并且分配`allocate`只会从`::operator new`. `destroy`会调用析构函数

```
(_start + n)->~T(); 
```

所有在分配器后面抽象的东西，向量只使用它。堆栈或池分配器的工作方式可能完全不同。关于这一点的一些关键点`vector`很重要

*   调用 后`reserve(N)`，您最多可以将 N 项插入到您的向量中，而不会冒重新分配的风险。在那之前，只要`size() <= capacity()`、对其元素的引用和迭代器仍然有效。
*   Vector 的存储是连续的。您可以将 &v[0] 视为一个缓冲区，其中包含您当前在向量中拥有的尽可能多的元素。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-23T06:10:10.670

向量的硬性规则之一是数据将存储在一个连续的内存块中。

这样你就知道理论上你可以做到这一点：

```
const Widget* pWidgetArrayBegin = &(vecWidget[0]); 
```

然后，您可以将*pWidgetArrayBegin*传递给需要数组作为参数的函数。

唯一的例外是 std::vector<bool> 专业化。它实际上根本不是布尔值，但那是另一回事。

所以 std::vector 将重新分配内存，并且不会使用链表。

这意味着您可以这样做：

```
Widget* pInteresting = &(vecWidget.back());
vecWidget.push_back(anotherWidget); 
```

如您所知， push_back 调用可能导致向量将其内容转移到一个全新的内存块，从而使*pInteresting*无效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T06:09:43.730

管理的内存`std::vector`保证是连续的，因此您可以将`&vec[0]`其视为指向动态数组开头的指针。

鉴于此，它实际管理其重新分配的方式是特定于实现的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T06:25:49.823

std::vector 将数据存储在连续的内存块中。

假设我们将一个向量声明为

std::vector intvect;

因此，最初将创建 x 个元素的内存。这里 x 取决于实现。

如果用户插入的元素超过 x 个，则将创建一个包含 2x（大小的两倍）元素的新内存块，并将初始向量复制到该内存块中。

这就是为什么总是建议通过调用reserve函数为vector预留内存。

intvect.reserve(100);

以免删除和复制矢量数据。

# c++ - MSXML2::IXMLDOMDocument2* 的静态实例变为无效

> ID：672355
> 
> 赞同：0
> 
> 时间：2009-03-23T06:02:11.440
> 
> 标签：c++, msxml

我有一个 C++ dll (x.dll)，它导出一个使用 MSXML2::IXMLDOMDocument2* 静态实例的类。

在 X.dll 中

包装器.h

```
class EXPORTEDCLASS wrapper
{
    wrapper();
    public:
// Some accessor methods.

    private:
   PIMPL* pImpl;
}; 
```

包装器.cpp

```
class PIMPL
{
public:
    PIMPL();

    static MSXML2::IXMLDOMDocumentPtr m_pDomDocument;
    static s_bInit;

    static void initDomDocument();
};

PIMPL::PIMPL()
{
    initDomDocument();
}

void PIMPL::initDomDocument()
{
    if(!s_bInit)
    {
        hr = CoCreateInstance(CLSID_DOMDocument40,NULL, CLSCTX_INPROC_SERVER, 
    IID_IXMLDOMDocument2, (void**)&m_pDomDocument);

    m_pDomDocument->load(strFileName);

    s_bInit = true;
}
}

wrapper::wrapper()
{
    pImpl = new PIMPL();
} 
```

m_pDomDocument 不会在任何地方发布。但在某些地方，它只分配给一些本地智能指针，它们也没有明确地释放。

在应用程序中，对包装器的第一次调用来自其他一些 dll 的 DllMain

这次创建了 m_pDomDocument 指针，因此对包装器的所有调用都成功了。

当下一个调用也恰好来自其他 dll 的 DllMain 时，我发现 s_bInit 是真的，所以我不再构造这个对象。

但这一次 m_pDomDocument 不知何故无效。（其值与第一次调用相同，但其 vptr 无效）

谁能告诉我这里可能出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T12:27:43.323

问题已解决。

有一个不合时宜的调用 CoUninitialize 用于释放 COM 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T06:15:19.643

尝试使用它来创建 COM 对象：

```
m_pDomDocument.CreateInstance("MSXML2.DOMDocument"); 
```

# jquery - 用户使用jquery上传文件时如何提取整个路径

> ID：672357
> 
> 赞同：3
> 
> 时间：2009-03-23T06:04:13.197
> 
> 标签：jquery, file-upload

我正在尝试提取用户在浏览器上上传的文件的整个路径，这我需要使用 javascript 或 jquery 来完成。

如果我给`($("#userfile").val());`我，我只能提取文件名而不是整个路径。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T06:24:37.033

我相信不泄露文件输入的整个路径是一种安全措施。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T06:35:58.817

Internet Explorer 将为您提供完整路径，但其他浏览器不会。[这是我发现的一个示例页面](http://www.java2s.com/Tutorial/JavaScriptDemo/FileUpload.htm)，它演示了这一点

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-08T08:48:55.083

对于 IE8，情况也并非如此。IE8 隐藏了文件的真实路径并将其更改为，例如：

```
C:\\**fakepath**\filename 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-10T14:39:53.103

如上所述，这通常是权限问题。尝试并将文件移动到不同的区域并授予其完全权限。

```
var path = $('#file').attr("value"); 
```

这也会给你文件的路径

# javascript - 与 CruiseControl、nUnit、nAnt 和 ASP.net MVC 集成的 JavaScript 自动化单元测试

> ID：672358
> 
> 赞同：5
> 
> 时间：2009-03-23T06:05:04.257
> 
> 标签：javascript, asp.net-mvc, unit-testing

我在一个 ASP.net MVC 团队工作，他们使用 Cruisecontrol、nUnit 和 nAnt 进行自动化测试和构建。我是该小组的新手，我处理 Javascript 层，我正在寻找将我的工作与我的团队工作流程结合起来的方法。

有没有办法做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T06:11:42.383

一些想法：

*   有 JSUnit，一个用于 JavaScript 的单元测试框架。我2年前用过，效果还不错。现在可能会有更好的东西。
*   我假设他们正在使用某种形式的源代码控制，并且 Cruise Control 监视存储库。如果是这样，那么只需确保您的 JavaScript 保存在同一个存储库中，这样它就会触发构建、单元测试的自动启动等。
*   如果您的 JavaScript 层的某些部分只能在浏览器中进行测试，请考虑使用 Selenium 或类似工具来创建一种自动化测试，以驱动浏览器通过各种场景。我确信有一种方法可以从巡航控制系统中启动这些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T06:25:24.940

就在几天前，John Resig 宣布了他正在开发的一个 JavaScript 单元测试自动化器，名为**[Test Swarm](http://ejohn.org/blog/javascript-testing-does-not-scale/)。**它刚刚进入 alpha 阶段，但可能值得一看。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T07:36:28.450

我发现 JSUnit 是一个非常好的 javascript 单元测试工具。

您也可以考虑使用 javascript lint（下面的链接）。它是一个静态代码分析器（不是单元测试工具），我过去在这方面有很好的经验。它不像某些已编译的语言 lint 工具那样彻底，但它可以使您免于在 javascript 中犯一些真正邪恶的错误。您可以从网页或命令行运行它，因此它应该很容易连接到构建过程中。

[http://www.javascriptlint.com/index.htm](http://www.javascriptlint.com/index.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T06:27:20.397

正如[@Charlie 所](https://stackoverflow.com/questions/672358/automated-unit-testing-for-javascript-integrated-with-cruisecontrol-nunit-nant/672368#672368)提到的，JsUnit 是通过[JsUnit Server](http://web.archive.org/web/20110907025515/http://www.jsunit.net/documentation/serverOverview.html)进行自动化单元测试的不错选择。

[QUnit](http://docs.jquery.com/QUnit)是一个新的单元测试运行器，具有高度的可定制性，我一直在使用它，您可以通过[Selenium](http://seleniumhq.org/)等[浏览器自动化工具](http://docs.jquery.com/QUnit#Integration_into_Browser_Automation_Tools)集成和检查测试结果。

这几乎是我们目前所拥有的，但是现在正在出现一个**非常有前途的项目，John Resig 先生的**[TestSwarm](http://testswarm.com/)，查看此博客文章以获取更多信息（并注册 alpha 版本！）：

*   [JavaScript 测试无法扩展](http://ejohn.org/blog/javascript-testing-does-not-scale/)

看起来真的很有趣：

[![](https://i.stack.imgur.com/VPtuu.png)](https://i.stack.imgur.com/VPtuu.png)
[（来源：[ejohn.org](http://ejohn.org/files/ts-swarm.png)）]

# python - 如何使用 python 发送 AT GSM 命令？

> ID：672366
> 
> 赞同：9
> 
> 时间：2009-03-23T06:11:02.917
> 
> 标签：python, modem

如何使用 python 发送 AT GSM 命令？

使用 Delphi 和一些 comport 组件 (TComport) 可以很容易地做到这一点，但是我如何使用 python 与我的调制解调器交谈？

加思

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-23T07:08:33.417

我用pyserial这样做：

```
import serial

serialPort = serial.Serial(port=1,baudrate=115200,timeout=0,rtscts=0,xonxoff=0)
def sendatcmd(cmd):
    serialPort.write('at'+cmd+'\r')

print 'Loading profile...',
sendatcmd('+npsda=0,2') 
```

然后我听答案...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T06:59:32.270

不知道有没有AT模块，不过可以用[pyserial](http://pyserial.sourceforge.net/)和串口通信。

# struts - Struts 2.1.6 中的 ONGL

> ID：672367
> 
> 赞同：1
> 
> 时间：2009-03-23T06:11:24.053
> 
> 标签：struts, abc

我正在使用带有 ONGL 的 struts 2.1.6。请查看下面的代码，并告诉我应该`<td>`在第 3 行和第 4 行中定义宽度、高度、bgcolor 等标签的属性。

1) `s:form action="Login">`
2) `<table>`
3) `<tr><s:textfield key="username"/></tr>`
4) `<tr><s:password key="password" /></tr>`
5) `</table>`
6)`</s:form>`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T10:35:45.417

<s:textfield> 只创建一个文本字段（输入标签），不做 td 标签。您可以自己插入它们（实际上，您可能应该，我不认为带有直接内容的 tr 标签是合法的？）。在大多数情况下，使用 CSS 进行样式设置而不是使用表格进行布局被认为是更好的形式，但这是另一回事。

编辑：对不起，我没有想到这一切。基本上，这些标签是由 struts 主题插入的。你可以设置你想用 CSS 设置的东西，或者使用简单的主题，[文档中的这个问题](http://struts.apache.org/2.0.8/docs/why-do-the-form-tags-put-table-tags-around-controls.html)应该让你开始。

# c++ - 如果我要覆盖它，我可以调用基类的虚函数吗？

> ID：672373
> 
> 赞同：378
> 
> 时间：2009-03-23T06:17:06.147
> 
> 标签：c++, virtual-functions, overriding

假设我有课程`Foo`并`Bar`设置如下：

```
class Foo
{
public:
    int x;

    virtual void printStuff()
    {
        std::cout << x << std::endl;
    }
};

class Bar : public Foo
{
public:
    int y;

    void printStuff()
    {
        // I would like to call Foo.printStuff() here...
        std::cout << y << std::endl;
    }
}; 
```

如代码中所述，我希望能够调用我正在覆盖的基类函数。在Java中有`super.funcname()`语法。这在 C++ 中可能吗？

* * *

## 回答 #1

> 赞同：494
> 
> 时间：2009-03-23T06:20:13.703

C++ 语法是这样的：

```
class Bar : public Foo {
  // ...

  void printStuff() {
    Foo::printStuff(); // calls base class' function
  }
}; 
```

* * *

## 回答 #2

> 赞同：130
> 
> 时间：2009-03-23T06:20:03.627

是的，

```
class Bar : public Foo
{
    ...

    void printStuff()
    {
        Foo::printStuff();
    }
}; 
```

它与 Java 中的相同`super`，只是当您具有多重继承时，它允许从不同的基础调用实现。

```
class Foo {
public:
    virtual void foo() {
        ...
    }
};

class Baz {
public:
    virtual void foo() {
        ...
    }
};

class Bar : public Foo, public Baz {
public:
    virtual void foo() {
        // Choose one, or even call both if you need to.
        Foo::foo();
        Baz::foo();
    }
}; 
```

* * *

## 回答 #3

> 赞同：75
> 
> 时间：2011-06-12T01:42:52.150

有时你需要调用基类的实现，当你不在派生函数中时......它仍然有效：

```
struct Base
{
    virtual int Foo()
    {
        return -1;
    }
};

struct Derived : public Base
{
    virtual int Foo()
    {
        return -2;
    }
};

int main(int argc, char* argv[])
{
    Base *x = new Derived;

    ASSERT(-2 == x->Foo());

    //syntax is trippy but it works
    ASSERT(-1 == x->Base::Foo());

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2009-03-23T15:11:39.077

以防万一您为班级中的许多功能执行此操作：

```
class Foo {
public:
  virtual void f1() {
    // ...
  }
  virtual void f2() {
    // ...
  }
  //...
};

class Bar : public Foo {
private:
  typedef Foo super;
public:
  void f1() {
    super::f1();
  }
}; 
```

如果你想重命名 Foo. 这可能会节省一些写作。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-05-28T14:20:07.987

如果你想从它的派生类调用基类的函数，你可以简单地在重写的函数内部调用并提到基类名称（如**Foo::printStuff()**）。

代码在这里

```
#include <iostream>
using namespace std;

class Foo
{
public:
    int x;

    virtual void printStuff()
    {
         cout<<"Base Foo printStuff called"<<endl;
    }
};

class Bar : public Foo
{
public:
    int y;

    void printStuff()
    {
        cout<<"derived Bar printStuff called"<<endl;
        Foo::printStuff();/////also called the base class method
    }
};

int main()
{
    Bar *b=new Bar;
    b->printStuff();
} 
```

同样，您可以在运行时确定使用该类的对象（派生或基类）调用哪个函数。但这要求您在基类中的函数必须标记为虚拟。

下面的代码

```
#include <iostream>
using namespace std;

class Foo
{
public:
    int x;

    virtual void printStuff()
    {
         cout<<"Base Foo printStuff called"<<endl;
    }
};

class Bar : public Foo
{
public:
    int y;

    void printStuff()
    {
        cout<<"derived Bar printStuff called"<<endl;
    }
};

int main()
{

    Foo *foo=new Foo;
    foo->printStuff();/////this call the base function
    foo=new Bar;
    foo->printStuff();
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-12-23T12:14:52.510

如果有多个继承级别，您可以指定直接基类，即使实际实现处于较低级别。

```
class Foo
{
public:
  virtual void DoStuff ()
  {
  }
};

class Bar : public Foo
{
};

class Baz : public Bar
{
public:
  void DoStuff ()
  {
    Bar::DoStuff() ;
  }
}; 
```

在此示例中，类**Baz**指定**Bar::DoStuff()**尽管类**Bar**不包含**DoStuff**的实现。这是一个细节，**巴兹**不需要知道。

显然，调用**Bar::DoStuff**比调用**Foo::DoStuff**更好，以防更高版本的**Bar**也覆盖此方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-16T10:29:39.997

检查这个...

```
#include <stdio.h>

class Base {
public:
   virtual void gogo(int a) { printf(" Base :: gogo (int) \n"); };    
   virtual void gogo1(int a) { printf(" Base :: gogo1 (int) \n"); };
   void gogo2(int a) { printf(" Base :: gogo2 (int) \n"); };    
   void gogo3(int a) { printf(" Base :: gogo3 (int) \n"); };
};

class Derived : protected Base {
public:
   virtual void gogo(int a) { printf(" Derived :: gogo (int) \n"); };
   void gogo1(int a) { printf(" Derived :: gogo1 (int) \n"); };
   virtual void gogo2(int a) { printf(" Derived :: gogo2 (int) \n"); };
   void gogo3(int a) { printf(" Derived :: gogo3 (int) \n"); };       
};

int main() {
   std::cout << "Derived" << std::endl;
   auto obj = new Derived ;
   obj->gogo(7);
   obj->gogo1(7);
   obj->gogo2(7);
   obj->gogo3(7);
   std::cout << "Base" << std::endl;
   auto base = (Base*)obj;
   base->gogo(7);
   base->gogo1(7);
   base->gogo2(7);
   base->gogo3(7);

   std::string s;
   std::cout << "press any key to exit" << std::endl;
   std::cin >> s;
   return 0;
} 
```

输出

```
Derived
 Derived :: gogo (int)
 Derived :: gogo1 (int)
 Derived :: gogo2 (int)
 Derived :: gogo3 (int)
Base
 Derived :: gogo (int)
 Derived :: gogo1 (int)
 Base :: gogo2 (int)
 Base :: gogo3 (int)
press any key to exit 
```

最好的方法是使用**base::function**作为@sth

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-02-17T19:48:06.257

是的，您可以调用它。在子类中调用父类函数的 C++ 语法是

```
class child: public parent {
  // ...

  void methodName() {
    parent::methodName(); // calls Parent class' function
  }
}; 
```

阅读有关函数[覆盖](https://www.codeslehrer.com/function-overriding-c/)的更多信息。

# mysql - MySQL 查询，批量插入

> ID：672386
> 
> 赞同：0
> 
> 时间：2009-03-23T06:24:58.967
> 
> 标签：mysql, bulkinsert, load-data-infile

我有一个要在 MYSQL 表中插入的批量数据，假设一次 10k，我正在做的是将数据存储在 XML 文件中，然后进行插入（数据大约为 50K 行），这需要很多时间，在 MySQL 表中是否有批量插入的选项。

在此先感谢，
请帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T06:32:23.333

[LOAD DATA INFILE](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)可以提供帮助。这是从文本文件加载数据的最快方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T06:34:47.943

您可能还想在插入之前禁用 de 索引并在之后启用它们以重新创建它们。

ALTER TABLE ... 禁用
ALTER TABLE ... 启用键

# c++ - 如何在 UnitTest++ 中使用实用程序函数

> ID：672392
> 
> 赞同：0
> 
> 时间：2009-03-23T06:26:38.930
> 
> 标签：c++, unit-testing

我正在使用 UnitTest++ 对 C++ 代码进行单元测试。

在我的测试中，有一组测试我重复了几次。我想要一个实用函数来执行这些测试。简而言之，我想这样做：

```
TEST( foo ) {
    Foo one;
    Foo two;

    // init one & two
    // lots of CHECK_CLOSE(one.bar, two.bar, 1e-5); in repeating cycles
}

TEST( bar ) {
    Foo one;
    Foo two;

    // init one & two
    // lots of CHECK_CLOSE(one.bar, two.bar, 1e-5); in repeating cycles
} 
```

并使用这个：

```
void blah( const Foo& one, const Foo& two ) {
    // lots of CHECK_CLOSE(one.bar, two.bar, 1e-5);
}

TEST( foo ) {
    Foo one;
    Foo two;

    // init one & two
    blah(one, two);
}

TEST( bar ) {
    Foo one;
    Foo two;

    // init one & two
    blah(one, two);
} 
```

由于 UnitTest++ 的宏操作，这不起作用。解决这个问题的最佳方法是什么？

**编辑**：我现在无法查看的一些想法。

1.  如果我使用带有实用程序函数的夹具，`struct`我可以从该函数中调用 UnitTest++ 宏吗？
2.  我可以编写一个宏来执行常见的测试。我不是很喜欢这个，但至少我会干瞪眼……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T13:58:11.600

编写一个宏来完成它。不要让“宏是邪恶的”口头禅对您隐藏这个事实：宏旨在生成重复代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T07:35:19.610

我建议不要这样做，因为你会丢失很多关于哪个测试失败的信息，包装函数现在包含了两个或更多测试的功能，所以当它失败时你必须回溯以查看是什么测试失败的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T08:52:53.090

使您的常用检查函数返回布尔值。然后在每个 TEST 中检查或断言您的常用函数的结果。

# c# - 如何获取类属性的名称？

> ID：672412
> 
> 赞同：29
> 
> 时间：2009-03-23T06:41:36.070
> 
> 标签：c#, reflection, properties, gettype

无论如何我可以获得类属性的名称`IntProperty`吗？

```
public class ClassName
{
  public static int IntProperty { get { return 0; } }
}

//something like below but I want to get the string of "IntProperty"
ClassName.IntProperty.GetType().Name 
```

基本上我想要做的是将属性名称字符串动态保存到数据库中，然后从数据库中检索它并动态调用属性。

似乎我正在寻找的东西类似于我认为的鸭子打字。

谢谢！

更新：

这是实际的代码。这更像是一种工作流程。但是每个任务都被定义为一个类的属性（类用于对任务进行分组）。

```
public class ApplicationTask
{
    public static Task<string> SendIncompleteNotification
    {
        get
        {
            return new Task<string>
                (
                a => Console.WriteLine("Sample Task")
                , "This is a sample task which does nothing."
                );
        }
    }
} 
```

因此，代码将能够检索类和属性的全名，例如：`namespace.ApplicationTask.SendIncompleteNotification`并将其保存到数据库中。稍后，代码将读取字符串并动态创建任务并将其传递给另一个执行。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2016-10-14T05:38:57.990

使用 C#6.0，您可以通过

```
nameof(ClassName.IntProperty) 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-03-23T07:00:59.503

我认为在这种情况下使用[GetProperty](http://msdn.microsoft.com/en-us/library/kz0a8sxy.aspx)方法是多余的，因为您需要知道属性名称才能调用该方法。

您可以遍历您的属性并提取其名称：

```
foreach (PropertyInfo p in typeof(ClassName).GetProperties())
{
    string propertyName = p.Name;
    //....
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-23T07:06:49.880

的结果`ClassName.IntProperty`只是一个整数值。一旦它被执行并返回结果，就没有它来自`IntProperty`.

如果您使用的是 .NET 3.5，则可以改用表达式树，通常通过 lambda 表达式创建：

```
Expression<Func<int>> exp = () => ClassName.IntProperty; 
```

然后，您可以编译并执行表达式*，并*分别找出它在做什么（`IntProperty`在这种情况下是检索）。我不确定这是否适合您想要做的事情。

如果您*确实*知道如何将属性名称保存在数据库中，那么`GetProperty`这就是检索前线的方法。

也许如果您可以就如何使用这个问题提供更多背景信息，我们可以提供更多帮助。您只展示了一个表达式 - 如果您可以根据使用它的位置来展示它，那就太好了。

编辑：您已经扩展了属性，但没有扩展它的调用方式。您是否*需要*直接调用它，而不仅仅是使用`Type.GetProperties`属性名称列表获取属性列表并将其存储在数据库中？

同样，如果您可以显示*调用*该属性的代码，以及您希望它如何与数据库交互，我们可能会取得更多进展。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-23T06:54:56.600

```
Type objectType = this.GetType();
PropertyInfo property = objectType.GetProperty("intProperty");
System.Console.Write(property.Name); 
```

这是你需要的吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-05T14:58:23.097

你可以简单地使用`nameof(ClassName.IntProperty)` 它会给你“IntProperty”

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2011-05-30T15:21:34.410

我遇到了这个，它似乎对获取属性名称很有帮助。(C++)

```
#define getVarName(varName,holder) sprintf(holder, "%s", #varName)

int main() {
    int var = 100; // just any type of identifier
    char name[100]; // it will get the variables name
    getVarName(var, name);
    puts(name);
    return 0;
} 
```

参考：http: [//zobayer.blogspot.com/2010/05/c-fun-get-variables-name.html](http://zobayer.blogspot.com/2010/05/c-fun-get-variables-name.html)

# c# - 装饰器和虚拟方法

> ID：672415
> 
> 赞同：3
> 
> 时间：2009-03-23T06:42:32.340
> 
> 标签：c#, design-patterns, ooad

装饰器设计模式是扩展类功能的一个很好的解决方案。例如，如果我想要现有类方法的预处理和后处理方法，我可以创建一个装饰器并覆盖基类中的现有方法，并分别调用我的预处理和后处理方法。

我的问题是，在应用程序设计过程中很少会出现上述要求。我不能将我创建的所有方法都标记为虚拟方法，以便它们可以被装饰器覆盖。因此，我将不得不求助于方法隐藏。

有没有更好的方法来设计我的类，以便在我想要覆盖任何方法的情况下，它可以以最好的方式完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T14:13:11.483

通常当我装饰一个类时，我是通过组合而不是继承来完成的。这样你就不需要覆盖任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T07:22:43.743

您是否考虑过使用方面（AOP）？-在你写评论后添加：你可以看看 log4postsharp 项目，看看他们如何使用方法上的属性。[Log4PostSharp](http://www.codeproject.com/KB/dotnet/log4postsharp-intro.aspx)

如果您使用 f.ex Reflector 编译并打开 dll，您将看到在运行时添加了前置和后置操作。

- 也可以使用 xml-configs 添加此类行为

# c++ - 提升 lambda 集合大小评估

> ID：672421
> 
> 赞同：3
> 
> 时间：2009-03-23T06:45:10.540
> 
> 标签：c++, functor, boost-lambda, boost-functional

我有一个形式的功能：

```
void DoSomething(const boost::function<bool ()>& condition, other stuff); 
```

这个函数做一些工作并且只在条件为真时返回。该条件已表示为函子参数，因为我想在不同的调用站点提供不同的条件。

现在，直接使用它相当简单，但它需要声明许多小的一次性函数或仿函数对象，如果可能的话，我想避免这些。我一直在研究 Boost 的 lambda 库，以寻找消除这些问题的可能方法，但我认为我缺少一些基本的东西；我只是不能让它做我想做的事。

目前让我感到难过的一个案例是：我有一个`std::vector`名为`data`;的集合。我所追求的条件是当该`size()`集合达到某个阈值时。那么，本质上，我希望我的`condition`仿函数在何时返回真`data.size() >= threshold`，否则返回假。但我一直无法用 lambda 语法表达它。

到目前为止，我能想到的最好的（至少可以编译，尽管它不起作用）是这样的：

```
boost::function<bool (size_t)> ge = boost::bind(std::greater_equal<size_t>(),
                                                _1, threshold);
boost::function<size_t ()> size = boost::bind(&std::vector<std::string>::size,
                                              data);
DoSomething(boost::lambda::bind(ge, boost::lambda::bind(size)), other stuff); 
```

在进入 时`DoSomething`，大小为 0——即使在运行过程中大小增加，对 的调用`condition()`似乎总是大小为 0。跟踪它（通过 Boost 的内部机制有点棘手），而它确实似乎在`greater_equal`每次`condition()`评估时都在调用，它似乎没有在调用`size()`.

那么我完全搞砸了什么基本的事情？有没有一种更简单的方式来表达这种事情（同时仍然尽可能保持代码内联）？

理想情况下，我希望它尽可能接近 C# 等效代码流畅度：

```
DoSomething(delegate() { return data.size() >= threshold; }, other stuff);
DoSomething(() => (data.size() >= threshold), other stuff); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T07:21:04.027

问题是，lambda 函数存储了`data`向量的副本，而不是引用。所以`size()`在副本上调用，而不是你正在修改的原始对象。这可以通过包装`data`with来解决`boost::ref`，它存储一个引用：

```
boost::function<size_t ()> size = boost::bind(&std::vector<std::string>::size,
                                              boost::ref(data)); 
```

您还可以使用普通`>=`运算符而不是`std::greater_equal<>`在 lambda 函数的定义中，并将它们组合在一起：

```
boost::function<bool ()> cond =
    (boost::bind(&std::vector<std::string>::size, boost::ref(data))
        >= threshold);

DoSomething(cond, other stuff); 
```

# c++ - 在 Windows 环境中使用 C/C++ 联网

> ID：672426
> 
> 赞同：1
> 
> 时间：2009-03-23T06:48:38.347
> 
> 标签：c++, c, windows, sockets

在 Windows 平台上使用套接字的最佳方式是什么？

我猜是基本套接字，TCP/IP。也许是为了聊天客户，或者只是为了学习。

有人能给我一个WININET用法的例子吗？

也许 ftpgetfile()

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T06:57:57.810

这是一个非常广泛的问题，很大程度上取决于您的需求。

你需要什么水平？HTTP/FTP？还是您自己的协议的“只是套接字”？您需要什么样的性能（连接数量、预期速度）？

如果您选择使用原始 API，您通常应该远离 WSAAsyncSelect，因为在“几个”并发连接之上性能非常糟糕。阻塞套接字和每套接字线程也不是太热。WSAEventSelect 有点棘手，但可以很好地完成工作（µtorrent 以这种方式处理**大量**并发连接）。Fancypants 真正的高负载将是 I/O 完成端口。您还可以查看 boost ASIO 以获得一些可移植性。

如果您想使用 HTTP/FTP 等标准协议，请检查 libcurl。或者，对于较少的需求和较小的开销，标准的 Windows WININET 功能（尽管有很多限制）。

* * *

要使用 WinINet 函数，请尝试从[这里](http://msdn.microsoft.com/en-us/library/aa385438(VS.85).aspx)开始- 可能不是示例，但至少可以为您提供足够的东西来谷歌搜索；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T07:04:14.473

对于带有 TCP/UDP 的基本客户端服务器应用程序，winsock 应该足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T07:05:15.470

你是说windows上的异步I/O模型吗？有select、WSAAsyncSelect、WSAEventSelect、Overlapped I/O、I/O Completion Port，你也可以使用Libevent和Boost Asio，它们都是跨平台的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T08:18:25.073

您可以在 msdn 或 codeproject.con 中找到 WinInet 示例

您可以在不错的 platofrm 独立库中找到使用方法 - boost::asio

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T08:44:01.190

如果您希望将此作为学习经验，我也会看看[ACE](http://www.cs.wustl.edu/~schmidt/ACE.html)。一个 C++ 跨平台框架，它实现了[并发网络和网络对象](https://rads.stackoverflow.com/amzn/click/com/B001C4QJ94)的模式中讨论的许多模式。作者也写过关于 ACE 的文章（见[这里](https://rads.stackoverflow.com/amzn/click/com/0201604647)）。

# windows - SVN admin 管理 GUI 工具

> ID：672431
> 
> 赞同：25
> 
> 时间：2009-03-23T06:57:15.440
> 
> 标签：windows, svn, user-interface, admin

Windows 上的 SVN 存储库有哪些 GUI 管理/管理工具？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-23T08:17:53.343

看看[visualsvn](http://www.visualsvn.com/server/)：

> VisualSVN Server 是一个包，其中包含您在 Windows 平台上为您的团队安装、配置和管理 Subversion 服务器所需的一切。它包括 Subversion、Apache 和一个管理控制台。
> 
> 用户友好的管理控制台
> 
> *   创建、导入和删除存储库
> *   在存储库中创建和删除文件夹
> *   显示 Subversion 服务器概览状态的仪表板
> *   管理 Subversion 安全策略
> *   启动、停止和重新启动服务
> *   存储库浏览器
> *   管理用户和组
> *   编辑 Subversion 钩子

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-09-20T13:02:36.887

我建议您查看[Subversion Edge](https://ctf.open.collab.net/sf/projects/svnedge/)。

Subversion Edge 是最新版本的 Apache Subversion、httpd 和 ViewVC 的发行版，所有这些都经过测试并旨在协同工作。它还包括一个易于使用的 Web 控制台，用于配置和管理服务器。它非常易于安装和运行，并包含一个内置更新程序，可让您通过 Web 浏览器远程安装更新。因此，您始终了解最新的安全修复程序，而不必担心组件无法协同工作。

Subversion Edge 是免费和开源的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T07:00:56.010

您想管理远程存储库（无论是 linux 还是 windows 机器）还是本地存储库？

就我个人而言，我没有遇到任何像样的实用程序，所以我使用了一个 AutoIT 脚本，它使用 PuTTY 的 plink.exe 与我的 linux 服务器上的*svnadmin交互。*

**编辑**：相当蹩脚的代码，但它符合我的目的。假设您的 $svndir 中有一个“conf/shared”目录，该目录将由该脚本创建的存储库共享。[使用AutoIt](http://www.autoitscript.com)编写脚本

```
$plink_bin = "C:\path\to\plink.exe"
$svndir = "/subversion"
$sshuser = "username"
$hostname = "host.domain.com"

$proj = InputBox("Enter project name", "Please enter a subversion project name", "")

if ($proj = "") Then
    Exit(1)
EndIf

$arg =        "cd " & $svndir & ";"
$arg = $arg & "svnadmin create " & $proj & ";"
$arg = $arg & "rm -fr " & $proj & "/conf;"
$arg = $arg & "ln -s ../conf/shared " & $proj & "/conf"

$command = $plink_bin & " " & $sshuser & "@" & $hostname & " " & $arg
Run($command) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-31T13:25:14.080

[svn-access-manager](http://sourceforge.net/projects/svn-access-mana/)似乎也是一个伟大的 SVN 开源 Web 管理 GUI（并且目前处于活动状态......）。

也试试[USVN](http://www.usvn.info/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-20T15:04:50.490

[uberSVN](http://www.ubersvn.com/download)使 Subversion 管理变得简单，可用于 Windows、Mac 和各种 Linux 版本：

免费、易于实现的 Subversion 用户界面，包括：

*   设置 Subversion 服务器所需的一切，包括最新版本的 Subversion 和 Apache。
*   切换功能让您可以使用 1.7.5 或 1.6.18 进行部署并随时升级或降级。
*   一个非常快速和简单的设置向导。
*   社交编码环境。
*   易于使用的管理控制台。
*   高级 LDAP 功能。
*   支持离线安装。
*   支持那些需要通过不同的机器（代理）访问互联网的人。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T17:11:12.867

还有我自己的名为[PainlessSVN](http://www.datakido.com/downloads/Token/ViewInfo/ItemId/4)的程序。它仅适用于要使用 svnserve.exe 服务的存储库设置它可以与 LAN 中的 Subversion 服务器一起使用。我目前正在开发 1.1 版，这几乎是一个完整的重写。查看博客以了解新内容。

如果您想使用现有的 Subversion 服务器，那么我的程序将为您工作。如果你想从头开始，那么[VisualSVN Server](http://visualsvn.com/server/)是不错的选择。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-23T12:03:37.263

找到这个工具：[http ://sublimesvn.com/download/index.html](http://sublimesvn.com/download/index.html)

这是 Sublime 的 beta 版本。在 2009 年 9 月 1 日到期之前，它可以不受限制地免费使用。定价将在今年晚些时候发布 Sublime 1.0 时公布。

# vb.net - 以编程方式检查 Word 邮件合并数据源

> ID：672432
> 
> 赞同：0
> 
> 时间：2009-03-23T06:57:40.637
> 
> 标签：vb.net, interop, ms-office, mailmerge

我想遍历 MS-Word 邮件合并数据源的所有行并将相关数据提取到 XML 中。

我目前正在使用此代码：

```
Imports Microsoft.Office.Interop
Do
  objXW.WriteStartElement("Recipient")
  Dim objDataFields As Word.MailMergeDataFields = DataSource.DataFields
  For Each FieldIndex As Integer In mdictMergeFields.Keys
    strValue = objDataFields.Item(FieldIndex).Value
    If Not String.IsNullOrEmpty(strValue) Then
      strName = mdictMergeFields(FieldIndex)
      objXW.WriteElementString(strName, strValue)
    End If
  Next
  objXW.WriteEndElement()
  If DataSource.ActiveRecord = LastRecord Then
    Exit Do
  Else
    DataSource.ActiveRecord = Word.WdMailMergeActiveRecord.wdNextDataSourceRecord
  End If
Loop 
```

事实证明它有点迟钝（每行大约 1 秒）。有什么方法可以更快地做到这一点？

我的幻想是找到一个类似的函数`MailMergeDataSource.ToDatatable`，然后检查数据表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T09:27:39.293

每当您逐行迭代某些内容，然后对每一行进行某种处理时，都会变得有点慢。

我倾向于通过在此之前准备 mdictMergeFields 集合的步骤来解决这个问题，以便*它只*包含非“空或空”的元素，这意味着您不必在每次迭代时检查它。您可以在进程中执行此操作，或者在用户执行其他操作时在后台“偷偷摸摸”地执行此操作。

要尝试的另一件事（可能有帮助！）是更改“Do...Loop”块，这样您就不会在每个导入行的末尾检查记录是否是“最后一条记录”。相反，获取记录计数，然后将当前索引与已知最大值进行比较（这可能更快）

IE：

```
Dim i, x as Integer
i = ActiveDocument.MailMerge.DataSource.RecordCount

Do While x < i
objXW.WriteStartElement("Recipient")  
Dim objDataFields As Word.MailMergeDataFields = DataSource.DataFields  
For Each FieldIndex As Integer In mdictMergeFields.Keys    
 strValue = objDataFields.Item(FieldIndex).Value    
 If Not String.IsNullOrEmpty(strValue) Then      
  strName = mdictMergeFields(FieldIndex)      
  objXW.WriteElementString(strName, strValue)    
 End If  
Next  
objXW.WriteEndElement()
x += 1
Loop 
```

我并没有真正使用 Office Interop，但希望这可能会提供一些帮助！回帖，让我知道进展如何。

/理查德。

# java - 用于匹配除给定列表之外的任何字符序列的 Java 模式

> ID：672440
> 
> 赞同：8
> 
> 时间：2009-03-23T07:03:30.417
> 
> 标签：java, regex

如何编写模式（Java）以匹配除给定单词列表之外的任何字符序列？

我需要找出给定的代码是否有任何被标签包围的文本，比如给定的单词列表。例如，我想检查标签周围除了“一”和“二”之外是否还有其他词。

```
"This is the first tag <span>one</span> and this is the third <span>three</span>" 
```

模式应该匹配上面的字符串，因为单词“three”被标签包围并且不是给定单词列表的一部分（“one”，“two”）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T07:22:03.120

前瞻可以做到这一点：

```
\b(?!your|given|list|of|exclusions)\w+\b 
```

火柴

*   单词边界（单词开头）
*   后面没有任何“您的”、“给定的”、“列表”、“的”、“排除的”
*   后跟多个单词字符
*   后跟一个词边界（词尾）

实际上，这匹配任何未排除的单词。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T07:38:14.283

这应该让你开始。

```
import java.util.regex.*;

// >(?!one<|two<)(\w+)/
// 
// Match the character “&gt;” literally «>»
// Assert that it is impossible to match the regex below starting at this position (negative lookahead) «(?!one|two)»
//    Match either the regular expression below (attempting the next alternative only if this one fails) «one»
//       Match the characters “one<” literally «one»
//    Or match regular expression number 2 below (the entire group fails if this one fails to match) «two»
//       Match the characters “two<” literally «two»
// Match the regular expression below and capture its match into backreference number 1 «(\w+)»
//    Match a single character that is a “word character” (letters, digits, etc.) «\w+»
//       Between one and unlimited times, as many times as possible, giving back as needed (greedy) «+»
// Match the characters “/” literally «</»
List<String> matchList = new ArrayList<String>();
try {
    Pattern regex = Pattern.compile(">(?!one<|two<)(\\w+)/");
    Matcher regexMatcher = regex.matcher(subjectString);
    while (regexMatcher.find()) {
        matchList.add(regexMatcher.group(1));
    } 
} catch (PatternSyntaxException ex) {
    // Syntax error in the regular expression
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T07:08:50.500

用这个：

```
if (!Pattern.matches(".*(word1|word2|word3).*", "word1")) {
    System.out.println("We're good.");
}; 
```

您正在检查模式是否与字符串*不*匹配。

# java - 我需要在 GUI 中代表 3 个所有者之间 100% 的某些资源的分配 - 有什么建议吗？

> ID：672442
> 
> 赞同：1
> 
> 时间：2009-03-23T07:05:09.977
> 
> 标签：java, swing, user-interface

对于 2 个所有者，答案很简单 - 使用一个滑块，一个所有者在左侧，另一个在右侧，然后滑动来控制每个所有者的百分比。

我如何与 3 个或更多所有者一起做？

具体来说，我说的是基于 Java Swing 的 GUI，但主要是在寻找设计理念。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T07:15:45.473

一个饼图怎么样，每个所有者有一个段，用户可以直接操纵（用鼠标拖动）段之间的边界或选择一个段并输入其百分比。

或者，您可以扩展滑块以在其上添加更多的 nob，因此对于 3 人之间的拆分，它看起来像这样：

```
|-------O-----O-----------| 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T07:14:34.120

你有三个滑块怎么样，每个滑块从 0% 到 100%。
将任何一个滑块增加 X% 会使其他两个滑块减少 X/2%。
您也可以为每个滑块设置一个单选按钮，一次只能选择零个或一个。如果选择了给定滑块的单选按钮，则该滑块将被锁定，并且将其他滑块之一增加 X% 会使剩余的滑块减少 X%。

有点笨拙。

你也可以有一个包含三个切片的饼图，你可以拖动分隔线。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T07:38:21.630

听起来好像您需要创建一个新`Component`功能才能有效地启用此功能。

一种可能的解决方案是子分类`JSlider`并允许多个“拇指”（我认为这是正确的术语），你**不能**滑过彼此。在这个简单的图表中，“-”代表轨道的单位，“|” 表示滑块上的拇指：

```
--------|--------|-------- 
```

在这里，三个用户中的每一个都平等地分配了资源。

不是让拇指代表用户的值，而是代表该用户分配的上限或下限，并且两个拇指（或一个拇指与轨道末端）之间的距离将代表用户的分配。您可以通过简单地添加额外的拇指来支持任意数量的用户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T07:39:31.003

也许最容易实现的是：

*   3 个滑块，每个所有者一个。
*   每个所有者都被分配`their_slider_value / total_of_all_slider_values`。

一些例子：

如果 A 设置为 0，B 设置为 1/2，C 设置为满，A 为 0%，B 为 33.3%，C 为 66.6%

```
 A = A_slider / (A_slider + B_slider + C_slider) 
     = 0        / (0        + 1/2      + 1)        = 0   =  0.0%
   B = B_slider / (A_slider + B_slider + C_slider) 
     = (1/2)    / (0        + 1/2      + 1)        = 1/3 = 33.3% 
   C = C_slider / (A_slider + B_slider + C_slider) = 
       (1)      / (0        + 1/2      + 1)        = 2/3 = 66.6% 
```

如果 A、B 和 C 都设置为最大值（或最小值），则它们各取 1/3

**好处：**

*   它应该是直观的（相对值是相同的；如果`A_slider`是 的两倍`B_slider`，它会获得两倍的资源）
*   您可以使用现有控件（即它不会发明新控件）
*   很容易表示 0%（您不必担心滑块重叠）
*   可以根据需要轻松扩展到 4 个或 5 个或多个所有者。

**缺点：**

*   有很多方法可以表示相同的分配

如果您想付出更多的努力，您可以在滑块旁边附上文本（百分比）或滑块表示的实际分配的图形表示（不是用户可以操纵的东西）（用分配填充的条形图） ，或饼图等）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T07:49:19.480

要将显示和输入分开，那么更新例如饼图的旋转控件呢？每个旋转控件向上或向下移动为 2，其他两个控件则向下或向上移动 1。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T08:21:13.227

创建一个三角形控件，您可以在其中移动一个点。如果它在其中一个角落，则意味着该角落的 100%。如果它在中间，则意味着每个人的 33%。

# java - 如何使用 SAXReader 解析 GPX 文件？

> ID：672454
> 
> 赞同：2
> 
> 时间：2009-03-23T07:10:48.997
> 
> 标签：java, xml, gpx

我正在尝试解析[GPX 文件](http://en.wikipedia.org/wiki/GPS_eXchange_Format)。我用 JDOM 试过，但效果不是很好。

```
SAXBuilder builder = new SAXBuilder();
Document document = builder.build(filename);
Element root = document.getRootElement();
System.out.println("Root:\t" + root.getName());
List<Element> listTrks = root.getChildren("trk");
System.out.println("Count trk:\t" + listTrks.size());
for (Element tmpTrk : listTrks) {
  List<Element> listTrkpts = tmpTrk.getChildren("trkpt");
  System.out.println("Count pts:\t" + listTrkpts.size());
  for (Element tmpTrkpt : listTrkpts) {
    System.out.println(tmpTrkpt.getAttributeValue("lat") + ":" + tmpTrkpt.getAttributeValue("lat"));
  }
} 
```

我打开了[示例文件](http://openstreetmap.org/trace/339421/data)（CC-BY-SA [OpenStreetMap）](http://www.openstreetmap.org)，输出只是：

> 根：gpx
> 计数 trk：0

我能做些什么？我应该使用 SAXParserFactory ( `javax.xml.parsers.SAXParserFactory`) 并实现 Handler 类吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T08:06:26.057

这是我的 gpx 阅读器。它忽略了一些标签，但我希望它会有所帮助。

```
package ch.perry.rando.geocode;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import javax.xml.parsers.ParserConfigurationException;
import javax.xml.parsers.SAXParser;
import javax.xml.parsers.SAXParserFactory;
import org.xml.sax.Attributes;
import org.xml.sax.SAXException;
import org.xml.sax.helpers.DefaultHandler;

/**
 *
 * @author perrym
 */
public class GpxReader extends DefaultHandler {
    private static final DateFormat TIME_FORMAT
            = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'");

    private List<Trackpoint> track = new ArrayList<Trackpoint>();
    private StringBuffer buf = new StringBuffer();
    private double lat;
    private double lon;
    private double ele;
    private Date time;

    public static Trackpoint[] readTrack(InputStream in) throws IOException {
        try {
            SAXParserFactory factory = SAXParserFactory.newInstance();
            factory.setValidating(true);
            SAXParser parser = factory.newSAXParser();
            GpxReader reader = new GpxReader();
            parser.parse(in, reader);
            return reader.getTrack();
        } catch (ParserConfigurationException e) {
            throw new IOException(e.getMessage());
        } catch (SAXException e) {
            throw new IOException(e.getMessage());
        }
    }

    public static Trackpoint[] readTrack(File file) throws IOException {
        InputStream in = new FileInputStream(file);
        try {
            return readTrack(in);
        } finally {
            in.close();
        }
    }

    @Override
    public void startElement(String uri, String localName, String qName,
            Attributes attributes) throws SAXException {
        buf.setLength(0);
        if (qName.equals("trkpt")) {
            lat = Double.parseDouble(attributes.getValue("lat"));
            lon = Double.parseDouble(attributes.getValue("lon"));
        }
    }

    @Override
    public void endElement(String uri, String localName, String qName)
            throws SAXException {
        if (qName.equals("trkpt")) {
            track.add(Trackpoint.fromWGS84(lat, lon, ele, time));
        } else if (qName.equals("ele")) {
            ele = Double.parseDouble(buf.toString());
        } else if (qName.equals("")) {
            try {
                time = TIME_FORMAT.parse(buf.toString());
            } catch (ParseException e) {
                throw new SAXException("Invalid time " + buf.toString());
            }
        }
    }

    @Override
    public void characters(char[] chars, int start, int length)
            throws SAXException {
        buf.append(chars, start, length);
    }

    private Trackpoint[] getTrack() {
        return track.toArray(new Trackpoint[track.size()]);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-21T15:56:48.933

要在 Java 中轻松读取 GPX 文件，请参阅：http: [//sourceforge.net/p/gpsanalysis/wiki/Home/](http://sourceforge.net/p/gpsanalysis/wiki/Home/)
示例：
//从 GPX 文件中获取点
final List points= GpxFileDataAccess.getPoints(new File("/path/ toGpxFile.gpx"));

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-27T22:10:49.543

准备好使用、开源和功能齐全的 java GpxParser（以及更多）在这里 [https://sourceforge.net/projects/geokarambola/](https://sourceforge.net/projects/geokarambola/)

详情在这里 [https://plus.google.com/u/0/communities/110606810455751902142](https://plus.google.com/u/0/communities/110606810455751902142)

使用上面的库解析 GPX 文件是一个单行：

```
Gpx gpx = GpxFileIo.parseIn( "SomeGeoCollection.gpx" ) ; 
```

获得它的点、路线或轨道也很简单：

```
for(Point pt: gpx.getPoints( ))
  Location loc = new Location( pt.getLatitude( ), pt.getLongitude( ) ) ; 
```

# c++ - 什么是“堆栈对齐”？

> ID：672461
> 
> 赞同：58
> 
> 时间：2009-03-23T07:21:17.600
> 
> 标签：c++, data-structures, mingw, visual-c++, compiler-construction

什么是堆栈对齐？为什么使用它？它可以通过编译器设置来控制吗？

这个问题的细节取自尝试将 ffmpeg 库与 msvc 一起使用时面临的问题，但是我真正感兴趣的是对什么是“堆栈对齐”的解释。

细节：

*   当运行链接到 avcodec 的 msvc 编译程序时，我收到以下错误：“编译器未对齐堆栈变量。Libavcodec 已被错误编译”，然后是 avcodec.dll 中的崩溃。
*   avcodec.dll 不是用 msvc 编译的，所以我看不到里面发生了什么。
*   运行 ffmpeg.exe 并使用相同的 avcodec.dll 时一切正常。
*   ffmpeg.exe不是用msvc编译的，是用gcc/mingw编译的（和avcodec.dll一样）

谢谢，

担

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2009-03-23T07:37:35.173

内存中变量的对齐（简短的历史）。

过去计算机有一个 8 位数据总线。这意味着，每个时钟周期可以处理 8 位信息。那很好。

然后是 16 位计算机。由于向下兼容等问题，保留了 8 位字节，引入了 16 位字。每个字为 2 个字节。每个时钟周期可以处理 16 位信息。但这带来了一个小问题。

让我们看一个内存映射：

```
+----+
|0000| 
|0001|
+----+
|0002|
|0003|
+----+
|0004|
|0005|
+----+
| .. | 
```

每个地址都有一个可以单独访问的字节。但是只能在偶数地址处获取单词。因此，如果我们读取 0000 处的字，我们会读取 0000 和 0001 处的字节。但如果我们要读取位置 0001 处的字，则需要两次读取访问。首先是 0000,0001，然后是 0002,0003，我们只保留 0001,0002。

当然，这需要一些额外的时间，而这并不受欢迎。所以这就是他们发明对齐的原因。所以我们在字边界存储字变量，在字节边界存储字节变量。

例如，如果我们有一个包含字节字段 (B) 和字字段 (W) 的结构（以及一个非常幼稚的编译器），我们会得到以下结果：

```
+----+
|0000| B
|0001| W
+----+
|0002| W
|0003|
+----+ 
```

这不好玩。但是当使用单词对齐时，我们发现：

```
+----+
|0000| B
|0001| -
+----+
|0002| W
|0003| W
+----+ 
```

这里为了访问速度牺牲了内存。

您可以想象，当使用双字（4 字节）或四字（8 字节）时，这一点更为重要。这就是为什么对于大多数现代编译器，您可以在编译程序时选择使用哪种对齐方式。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-23T07:45:58.710

某些 CPU 架构需要各种数据类型的特定对齐，如果您不遵守此规则，则会引发异常。在标准模式下，x86 对基本数据类型不要求这样做，但可能会遭受性能损失（请访问 www.agner.org 了解低级优化技巧）。

但是，[SSE](http://en.wikipedia.org/wiki/Streaming_SIMD_Extensions "上证所")指令集（通常用于高性能）音频/视频处理具有严格的对齐要求，如果您尝试在未对齐的数据上使用它会抛出异常（除非您在某些处理器上使用慢得多的未对齐版本）。

您的问题**可能**是一个编译器希望*调用者*保持堆栈对齐，而另一个编译器希望被*调用*者在必要时对齐堆栈。

**编辑**：至于为什么会发生异常，DLL 中的一个例程可能想要对一些临时堆栈数据使用 SSE 指令，并且由于两个不同的编译器不同意调用约定而失败。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-23T07:41:20.157

IIRC，堆栈对齐是指将变量放在堆栈上“对齐”到特定数量的字节。因此，如果您使用 16 位堆栈对齐，堆栈上的每个变量将从一个字节开始，该字节是函数中当前堆栈指针的 2 个字节的倍数。

这意味着，如果您使用小于 2 字节的变量，例如 char（1 字节），则它与下一个变量之间将有 8 位未使用的“填充”。这允许基于可变位置的假设进行某些优化。

调用函数时，将参数传递给下一个函数的一种方法是将它们放在堆栈上（而不是将它们直接放在寄存器中）。这里是否使用对齐很重要，因为调用函数将变量放在堆栈上，以便调用函数使用偏移量读取。如果调用函数对齐变量，而被调用函数期望它们不对齐，那么被调用函数将无法找到它们。

似乎 msvc 编译的代码在变量对齐方面存在分歧。尝试在关闭所有优化的情况下进行编译。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T07:53:42.357

据我所知，编译器通常不会对齐堆栈上的变量。该库可能取决于您的编译器不支持的某些编译器选项集。正常的解决方法是将需要对齐的变量声明为静态的，但如果你在其他人的代码中这样做，你会想要确保它们有问题的变量稍后在函数中初始化，而不是在宣言。

```
// Some compilers won't align this as it's on the stack...
int __declspec(align(32)) needsToBe32Aligned = 0;
// Change to
static int __declspec(align(32)) needsToBe32Aligned;
needsToBe32Aligned = 0; 
```

或者，找到一个对齐堆栈上的变量的编译器开关。显然，我在这里使用的“__declspec”对齐语法可能不是您的编译器使用的。

# c# - 如何将扩展类 ScrollViewer 添加到 XAML 文件？

> ID：672465
> 
> 赞同：1
> 
> 时间：2009-03-23T07:24:14.377
> 
> 标签：c#, wpf, scrollviewer

我正在寻找一种方法来为 ScrollViewer 的滚动设置动画，我找到了一个示例，但是当我尝试将类添加到 XAML 文件时，我收到一个错误：

> 错误 2
> 找不到类型“AniScrollViewer”。确认您没有丢失程序集引用并且所有引用的程序集都已构建。

这是[我在论坛中找到的代码](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/cd724d5e-ae67-4eb5-921e-05bd913b202b/)，我将类添加到我的 cs 文件中：

```
public class AniScrollViewer:ScrollViewer
{

  public static DependencyProperty CurrentVerticalOffsetProperty = DependencyProperty.Register("CurrentVerticalOffset", typeof(double), typeof(AniScrollViewer), new PropertyMetadata(new PropertyChangedCallback(OnVerticalChanged)));

  public static DependencyProperty CurrentHorizontalOffsetProperty = DependencyProperty.Register("CurrentHorizontalOffsetOffset", typeof(double), typeof(AniScrollViewer), new PropertyMetadata(new PropertyChangedCallback(OnHorizontalChanged)));

  private static void OnVerticalChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
  {
    AniScrollViewer viewer = d as AniScrollViewer;
    viewer.ScrollToVerticalOffset((double)e.NewValue);
  }

  private static void OnHorizontalChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
  {
    AniScrollViewer viewer = d as AniScrollViewer;
    viewer.ScrollToHorizontalOffset((double)e.NewValue);
  }

  public double CurrentHorizontalOffset
  {
    get { return (double)this.GetValue(CurrentHorizontalOffsetProperty); }
    set { this.SetValue(CurrentHorizontalOffsetProperty, value); }
  }

  public double CurrentVerticalOffset
  {
    get { return (double)this.GetValue(CurrentVerticalOffsetProperty); }
    set { this.SetValue(CurrentVerticalOffsetProperty, value); }
  }
} 
```

这是动画代码的示例：

```
private void ScrollToPosition(double x, double y)
{
  DoubleAnimation vertAnim = new DoubleAnimation();
  vertAnim.From = MainScrollViewer.VerticalOffset;
  vertAnim.To = y;
  vertAnim.DecelerationRatio = .2;
  vertAnim.Duration = new Duration(TimeSpan.FromMilliseconds(250));

  DoubleAnimation horzAnim = new DoubleAnimation();
  horzAnim.From = MainScrollViewer.HorizontalOffset;
  horzAnim.To = x;
  horzAnim.DecelerationRatio = .2;
  horzAnim.Duration = new Duration(TimeSpan.FromMilliseconds(300));

  Storyboard sb = new Storyboard();
  sb.Children.Add(vertAnim);
  sb.Children.Add(horzAnim);

  Storyboard.SetTarget(vertAnim, MainScrollViewer);
  Storyboard.SetTargetProperty(vertAnim, new PropertyPath(AniScrollViewer.CurrentVerticalOffsetProperty));
  Storyboard.SetTarget(horzAnim, MainScrollViewer);
  Storyboard.SetTargetProperty(horzAnim, new PropertyPath(AniScrollViewer.CurrentHorizontalOffsetProperty));

  sb.Begin();
} 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T09:15:56.950

您的 xaml 文件需要引用您的命名空间才能找到您的 AniScrollViewer

可以说，您的 AniScrollViewer 位于命名空间 Test 中，您可以像这样在 xaml 中使用它：

```
<Window x:Class="something"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Test="clr-namespace:Test;assembly=">

    <Test:AniScrollViewer />

</Window> 
```

# java - JUnit：如何避免测试工具类中的“无可运行方法”

> ID：672466
> 
> 赞同：118
> 
> 时间：2009-03-23T07:26:22.283
> 
> 标签：java, ant, junit, testing

我已经从 JUnit3.8 切换到 JUnit4.4。我使用 ant 运行测试，我的所有测试都成功运行，但测试实用程序类失败并出现“无可运行方法”错误。我使用的模式是在 test 文件夹下包含名称为 *Test* 的所有类。

我知道跑步者找不到任何用 @Test 属性注释的方法。但它们不包含此类注释，因为这些类不是测试。令人惊讶的是，在 eclipse 中运行这些测试时，它并没有抱怨这些类。

在 JUnit3.8 中，这根本不是问题，因为这些实用程序类没有扩展 TestCase，因此运行程序不会尝试执行它们。

我知道我可以在 ant 脚本的 junit 目标中排除这些特定类。但是我不想在我添加的每个新实用程序类上都更改构建文件。我也可以重命名课程（但给课程起好名字一直是我最薄弱的天赋:-)）

这个问题有什么优雅的解决方案吗？

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2009-06-11T18:16:07.207

使用@Ignore 注释您的实用程序类。这将导致 JUnit 不尝试将它们作为测试运行。

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2010-06-10T16:34:40.407

我的具体情况有以下情况。我们的测试

```
public class VenueResourceContainerTest extends BaseTixContainerTest 
```

全部展开

```
BaseTixContainerTest 
```

JUnit 试图运行 BaseTixContainerTest。可怜的 BaseTixContainerTest 只是试图设置容器，设置客户端，点一些披萨，然后放松一下……伙计。

如前所述，您可以使用

```
@Ignore 
```

但这导致 JUnit 将该测试报告为已跳过（而不是完全忽略）。

```
Tests run: 4, Failures: 0, Errors: 0, Skipped: 1 
```

这让我很恼火。

所以我做了 BaseTixContainerTest 抽象，现在 JUnit 真正忽略了它。

```
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0 
```

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2009-03-23T07:45:00.647

假设您可以控制用于查找测试类的模式，我建议将其更改为 match`*Test`而不是`*Test*`. 这种方式`TestHelper`不会匹配，但`FooTest`会。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2012-05-22T09:18:50.767

为了防止 JUnit 实例化您的测试基类，只需让它

```
public abstract class MyTestBaseClass { ... whatever... } 
```

（@Ignore 将其报告为已忽略，我将其保留用于*暂时*忽略的测试。）

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2016-02-02T22:45:21.860

1.  如果这是您的基本测试类，例如 AbstractTest 并且您的所有测试都扩展了它，那么将此类定义为**抽象**
2.  如果它是 Util 类，那么最好从类中删除 *Test 重命名为 MyTestUtil 或 Utils 等。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2015-08-04T00:03:07.950

使用 IDE 的代码完成添加导入时要小心`@Test`。

例如，它必须是`import org.junit.Test`而不是`import org.testng.annotations.Test`。如果你做后者，你会得到“没有可运行的方法”错误。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-03-31T21:44:10.500

Ant 现在带有该`skipNonTests`属性，该属性旨在完全按照您的要求进行。无需更改基类以对其进行抽象或添加注释。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-23T09:31:31.513

给这些类添加一个空的测试方法怎么样？

```
public void avoidAnnoyingErrorMessageWhenRunningTestsInAnt() {
    assertTrue(true); // do nothing;
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-03-22T13:38:11.517

如果在你的测试类中写了 import org.junit.jupiter.api.Test; 删除它并写入 import org.junit.Test; 在这种情况下，它也对我有用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-04-23T20:01:32.317

在运行最简单的简单代码（使用@Test、@Before 等）时，我也遇到了类似的问题（“没有可运行的方法……”），但无处可寻。我使用的是 Junit4 和 Eclipse SDK 版本 4.1.2。通过使用最新的 Eclipse SDK 4.2.2 解决了我的问题。我希望这可以帮助那些在类似问题上苦苦挣扎的人。

# c# - 依赖注入和 C# 语法

> ID：672472
> 
> 赞同：2
> 
> 时间：2009-03-23T07:30:13.287
> 
> 标签：c#, model-view-controller

我想知道是否有人可以在这段代码的一行中解释语法：

```
public class ContactController : Controller
{
    private IContactManagerRepository _repository;

    **public ContactController()
        : this(new EntityContactManagerRepository())**
    {}

    public ContactController(IContactManagerRepository repository)
    {
        _repository = repository;
    } 
```

我特别感兴趣的是第一个构造函数。我从我得到它的文章中了解到（[http://www.asp.net/learn/mvc/tutorial-29-cs.aspx](http://www.asp.net/learn/mvc/tutorial-29-cs.aspx) - 清单 3) 第一个构造函数调用第二个构造函数，当我将鼠标悬停在 this(new EntityContactManagerRepository()) 上时，intellisense 告诉我它确实是指第二个构造函数。但是我之前没有见过后面有冒号的构造函数。我知道类声明中的冒号告诉编译器ContactController继承自Controller，但是构造函数中的冒号是做什么的呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T07:38:53.657

正如您所说，它只是调用另一个构造函数作为执行的第一部分。另一种方法是使用`base`which 在基类中调用构造函数。语言规范对此调用使用术语*构造函数初始化器。**总是*有这样的事情——如果你不指定任何东西，它就相当于调用`base()`. 换句话说：

```
public Foo(int x) 
```

相当于

```
public Foo(int x) : base() 
```

在这两种情况下，基类的无参数构造函数都会在`Foo`构造函数的主体执行之前被调用。编译器确保您不会陷入无限循环——每个（非静态）类必须至少有一个调用基类构造函数的构造函数；您总是在“this”类的构造函数主体执行之前调用基类构造函数。

然而，与 Java 不同的是，实例变量初始化程序*在*基类构造函数调用之前执行。

有关更多信息，请参阅我[关于构造函数链接](http://pobox.com/~skeet/csharp/constructors.html)的文章。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T07:35:56.877

它被称为[构造函数链接](http://www.csharp411.com/constructor-chaining/)。使用该语法，您可以调用基类的构造函数或当前类的另一个构造函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T07:37:06.610

此功能称为[构造函数初始化](http://msdn.microsoft.com/en-us/library/aa645603(VS.71).aspx)器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T07:43:07.047

您的示例使用构造函数链接。即默认构造函数调用具有相同类型参数的特定构造函数。为此，您可以将`this`关键字与示例中所需的任何参数一起使用。

一个类似的功能是`base`关键字的使用。当你有一个类层次结构时，你总是为层次结构中的所有类型调用构造函数。因此，例如，如果您有一个`B`类和一个`D`类，`B`那么`D`当您创建`D`. 对于默认构造函数（即不带参数），您无需执行任何操作。但是，如果`B`只实现需要参数的构造函数，则需要某种方式从`D`的构造函数中传递 this。为此，您可以使用与示例中使用`base`的方式类似的关键字`this`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T13:17:54.217

这是缺少可选/默认参数支持的结果（解决方法）。您会发现自己处于以下情况：

```
MessageBox.Show(string)
...
MessageBox.Show(Window, string, string)
...
MessageBox.Show(Window, string, string, MessageBoxButton, MessageBoxImage, MessageBoxResult, MessageBoxOptions) 
```

在这些情况下，通常具有最多参数的那个包含一个实现，而其他重载只是使用默认参数调用那个。需要注意的一点是，当参数数量增加到 N 时，重载的数量可能会增加到 N！。

构造函数是**特殊函数**，因此您必须按应有的方式对待它们。一个对象只能构造一次。请记住，在普通函数中，您可以多次调用实现函数。在这里，您必须调用**一次实现构造函数**，这也是要做的**第一件事**。构造函数链接语法指出了这些要求。

让我们回到最初的问题。即使这些情况不是很常见，您也可以通过定义一个新类型（这里使用 C# 3.0 特性）来解决这个问题，该类型将用作参数：

```
public class Parameter
{
    public string P1 { get; set; }
    public int P2 { get; set; }
    public string P3 { get; set; }
    public double P4 { get; set; }
    ...
    public Parameter()
    {
        P1 = "p1";
        P2 = 2;
        P3 = "p3";
        P4 = 4.0;
        ...
    }
}
...
FunctionWithManyParametersCanNowBeCalledLike(new Parameter() { P2 = -2 }); 
```

在这里，我们在构造函数中提供了默认参数。这是许多构造函数的解决方案吗？不。

C# 4.0 将包括可选和命名参数功能。所以我们甚至不需要定义一个新的参数类型。您可能会认为该功能是为此的语法糖，但是它们有所不同。**对于基类**构造函数参数，我们**仍然需要**这种语法。

 *** * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T07:37:51.023

冒号用于指示您正在调用来自同一类的另一个构造函数（如在您的示例中）或使用来自基类的构造函数`:base(..args...)`

此语法用于强制您在执行任何额外工作之前调用其他构造函数或基构造函数（即，它确保基类首先初始化顺序）。

# java - 我想让 java 应用程序调用动作脚本中的函数？

> ID：672475
> 
> 赞同：2
> 
> 时间：2009-03-23T07:33:06.323
> 
> 标签：java, apache-flex, flash, actionscript-3, amf

如何让 SWF 文件立即从进行实时计算的 Java 应用程序中检索值（速度是必需的）。

> 其他形式的问题：我怎样才能尽可能快地为我的网站浏览器提供即时数据 - 现在是 bean 计算的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T15:46:34.990

如果速度至关重要，您可能希望通过某种套接字连接来实现。通常签名的小程序或 WebStart Java 应用程序能够打开一个监听套接字。Flash 应用程序将能够连接到此套接字，因此您将进行非常快速的双向通信。

然而，有一些警告。

*   你应该记住，用户可能会对他机器上奇怪的套接字活动产生怀疑，或者它会被防火墙阻止——所以你需要警告用户。
*   为了能够从 Flash 连接到 Java，您必须从侦听套接字调度跨域策略文件（或任何其他低于 1024 - 请参阅文档了解详细信息；关键字：crossdomain、policy-file-request、[loadPolicyFile](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/system/Security.html#loadPolicyFile())）。此外，您的 Flash 应用程序可能需要从 Java 应用程序手动请求此类文件。

关于如何为您的 Java 应用程序获取证书的几个有用链接：[如何获取免费代码签名证书（俄语）](http://octets.ru/security/besplatnyj-code-signing-sertifikat-za-30-minut/)，[类似但不太详细的英文描述](http://www.dallaway.com/acad/webstart/)。

但是，如果您能够（阅读：速度足够）使用`Java Applet <-> JavaScript <-> Flash`组合，我建议您利用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T07:55:46.953

我将假设计算是在运行 Flash 的同一浏览器中的 Java 小程序中完成的。

您可以使用以下代码从小程序中调用 Javascript。然后，此代码可以更新 Flash 动画中的值。

```
import netscape.javascript.JSObject;

JSObject win = JSObject.getWindow(applet);
win.eval("window.alert('Hello from Java')"); 
```

如果我的假设不正确，那么 Java 应用程序在哪里运行？在客户端还是服务器上？

如果它在服务器上，那么您需要 Flash 远程处理。我相信有几种不同的 Flash 远程处理技术。尝试搜索[java flash remoting](http://www.google.com/search?q=flash+java+remoting&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)。您可以让它每 2 秒左右调用一次服务器以获取最新数据。

如果它在客户端上运行，出于安​​全考虑，我怀疑您是否可以从 Flash 连接到它。一个签名的 Java 小程序可以连接到它想连接的任何地方。您可以使用它检索数据，然后使用上述方法将其推送到 Flash 中。不过，这将是一个疯狂的黑客行为。你能用 Flex 做同样的事情吗？（我以前从未使用过 Flex）。

# open-source - Web 搜索引擎组件的开源项目

> ID：672476
> 
> 赞同：0
> 
> 时间：2009-03-23T07:34:09.207
> 
> 标签：open-source, search-engine

[有人可以列出问题“构建网络搜索引擎”](https://stackoverflow.com/questions/112248/building-a-web-search-engine)中包含的每个组件的开源软件列表吗？

这将节省很多人寻找高质量开源组件的时间。

组件列表：

1.  履带式
2.  解析器
3.  索引器
4.  排名引擎
5.  前端

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T07:43:51.367

对于 Java 世界：

解析器

*   [JavaCC](https://javacc.dev.java.net/)
*   [蚂蚁](http://antlr.org)

索引器

*   [Apache Lucene](http://lucene.apache.org)

排名引擎

*   [Apache Lucene](http://lucene.apache.org)

前端

*   任何轻量级 MVC 框架

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T09:11:57.660

Lucene 也可用于 .NET [http://incubator.apache.org/lucene.net/](http://incubator.apache.org/lucene.net/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T21:22:12.850

看起来[nutch 可以满足](http://lucene.apache.org/nutch/about.html)您开箱即用的所有需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-12T19:55:13.997

Nutch + Lucene + Mapreduce/Apache 是您的解决方案。

# command-line - 从批处理文件中删除的文件数

> ID：672488
> 
> 赞同：1
> 
> 时间：2009-03-23T07:39:45.743
> 
> 标签：command-line, batch-file, command, cmd

```
REM Detect how many files are on the C: drive
dir /s /b C:\ |find /c "\" > NUMfiles.###
set /p count1=<NUMfiles.###

##### TEMP FILES DELETED HERE, RUN CCLEANER, RUN MBAM, ETC #####

REM Calculate Total Files Deleted
dir /s /b C:\ |find /c "\" > NUMfiles.###
set /p count2=<NUMfiles.###
set /a count3=%count1% - %count2%
echo Number of files removed: %count3% 
```

这似乎没有给我一个准确的读数。任何人都可以帮忙吗？我在脚本之前和最后使用 'dir /s /b C:\ |find /c "\"' 通过命令行进行手动检查。'%count3% 的输出不准确，因为我从手动检查中减去。希望你能理解我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-18T13:22:04.877

是的，正如 snemarch 所说，您列出所有内容和临时文件的事实也可以由另一个进程添加/删除，同时使整个工作无效。

附带说明一下，在“dir”命令中添加“/ad”将从列出的目录中删除，因此如果您坚持只检查文件，则不需要 VonC 的“find /v”添加到该过程中。

你不能在文件被删除时不检查文件吗？不确定你用它做什么，但你肯定需要从源头，删除部分重新考虑方式。

我的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T09:31:23.637

如果您必须迭代所有内容，则此命令行可能更精确地列出文件的数量*（*文件，而不是目录）：

```
dir /a /s /OG C:\ |find /v "<DIR>" | find /c "M " 
```

当然，这假设 a`dir`确实显示 ' `AM`' 或 ' `PM`'。

如果没有，以下应该会更好：

```
dir /a /s /OG C:\ |find /v "<DIR>" | find /c "/" 
```

# php - 使用 OPENDIR 访问共享云端硬盘

> ID：672492
> 
> 赞同：0
> 
> 时间：2009-03-23T07:42:08.640
> 
> 标签：php

我想通过 PHP 显示我系统中的所有驱动器，所以我使用了 opendir。这里有一个问题，我已经以 Z 的名义映射了一个驱动器：当我们尝试在浏览器中显示驱动器时，这个驱动器没有显示。

基本上我有c：驱动器，另外我已经从网络连接映射了Z：驱动器。请帮助我如何在浏览器中显示两个驱动器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T07:56:11.633

windows下的默认SYSTEM用户将无法访问映射的网络驱动器。服务默认在此用户下运行，如 Apache。

映射的网络驱动器是为特定用户安装的，不适用于其他用户。

尖端：

1.  不要使用驱动器号，而是使用 UNC 路径。（例如：'\\server\share 而不是'g:\'）
2.  映射的驱动器是为某些特定用户映射的，而服务在另一个上下文中运行并且不知道此映射。有一种称为“作为服务登录”的特权。您为服务指定的用户帐户应具有此权限。使用 secpol.msc 授予它。
3.  从网络驱动器映射到的本地用户运行服务器，而不是将其作为系统服务运行。使用 services.msc 并在登录选项卡下更改用户。

始终执行提示 1。在提示 2 或 3 之间进行选择。

# sql-server - 在 MS Access 中从 .mdf 文件创建数据库

> ID：672500
> 
> 赞同：1
> 
> 时间：2009-03-23T07:46:33.247
> 
> 标签：sql-server, database, ms-access

我有一个需要导入 MS Access 的 .mdf。我读过 .mdf 是一种 Sql Server 格式，因此 Access 无法识别它。但是有什么方法可以让我在 MS Access 中创建数据库。我正在使用 Access 2003 和 Sql Server 2005

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T08:06:59.157

为什么不在 SQL Management Studio 中右键单击数据库，单击导出，然后指定所需的参数？

我刚检查过。适用于我安装的 SQL Server 2008。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T08:06:55.600

您可以创建一个新的 Access 数据库并将 mdf 文件中的表导入其中。您没有提到 Access 或 SQL Server 的版本，因此很难更具体。

或者，如果您有权访问 SQL Server，则可以将数据库导出为 Access .mdb。

# c# - 有没有简单的方法来使用 InternalsVisibleToAttribute？

> ID：672501
> 
> 赞同：32
> 
> 时间：2009-03-23T07:48:55.287
> 
> 标签：c#, .net, visual-studio

我有一个 C# 项目和一个带有主项目单元测试的测试项目。我想拥有可测试的`internal`方法，并且我想在没有 Visual Studio 测试项目中可以拥有的神奇 Accessor 对象的情况下测试它们。我想使用**`InternalsVisibleToAttribute`**，但每次完成后，我都必须回去查看如何操作，我记得这涉及创建用于签署程序集的密钥文件，然后使用`sn.exe`它来获取公钥等等。

*   **是否有一个实用程序可以自动执行创建 SNK 文件、设置项目以签署程序集、提取公钥和应用*InternalsVisibleTo*属性的过程？**

*   **有没有办法在*没有*签名程序集的情况下使用该属性？**

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-23T07:56:02.007

您不必使用已签名的程序集来使用`InternalsVisibleTo`. 如果不使用签名程序集，则只需输入程序集的全名即可。

因此，如果您想`MyAssembly`在您的测试程序集 ( `MyAssembly.Test`) 中访问，您只需要像这样的测试程序集的名称`AssemblyInfo.cs`：`MyAssembly`

```
[assembly: InternalsVisibleTo("CompanyName.Project.MyAssembly.Test")] 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-23T08:17:38.773

Brian 是对的，但是，在某些情况下，您确实有一个签名的程序集，并且您确实希望获得该程序集的公钥。

拿到这把钥匙确实挺麻烦的。
因此，我这样做了：
我在VS.NET中自定义了我的外部工具，这样我就可以一键获取当前项目的程序集的公钥。
这是如何完成的：

*   在 VS.NET 中，打开“工具”菜单，然后单击“外部工具”
*   将打开一个名为“外部工具”的窗口
*   点击添加
*   对于标题，输入“获取公钥”
*   在“命令”中，输入`C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\Bin\sn.exe`
*   在“参数”中，键入：`-Tp $(TargetPath)`
*   确保选中“使用输出窗口”选项

然后，您构建项目，当您单击“获取公钥”时，您应该在输出窗口中看到该项目的公钥。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-27T10:14:31.040

还有另一种调用内部方法的替代方法，那就是使用“反射”。

```
 BindingFlags bindingFlags = BindingFlags.Instance | BindingFlags.NonPublic;

        MethodInfo minfo = typeof(BaseClassName).GetMethod("MethodName", bindingFlags);
        BaseClassName b = new BaseClassName();            
        minfo.Invoke(b, null); 
```

这里我假设“BaseClassName”是来自另一个类库的类的名称，“MethodName”是内部方法的名称。

# vb.net - 在表达式的条件中使用结果计数的 LINQ 语句

> ID：672503
> 
> 赞同：2
> 
> 时间：2009-03-23T07:49:38.327
> 
> 标签：vb.net, linq

请各位LINQ-fu高手帮忙。

我有一个要求，我必须在 VB.NET 中使用 Target.AddRange() 从 IEnumerable(Of T)（我们称之为 Source）将项目添加到 List(Of T)（我们称之为 Target）中。

```
Target.AddRange(Source.TakeWhie(Function(X, Index) ?)) 
```

这 ？部分是一个棘手的条件，例如：*只要尚未枚举的计数不等于将列表填充到所需的最小值所需的计数，则随机决定是否应采用当前项目，否则采用该项目。* 有点像...

```
Source.Count() - Index = _minimum_required - _curr_count_of_items_taken _
OrElse GetRandomNumberBetween1And100() <= _probability_this_item_is_taken
' _minimum_required and _probability_this_item_is_taken are constants 
```

令人困惑的部分是 _curr_count_of_items_taken 需要在每次满足 TakeWhile 语句时递增。我该怎么做呢？

我也对使用任何其他 LINQ 方法（Aggregate、Where 等）而不是 TakeWhile 的解决方案持开放态度。

如果所有其他方法都失败了，那么我将重新使用一个好的旧 for 循环 =)

但希望有一个LINQ解决方案。在此先感谢您的任何建议。

编辑：根据要求，旧的 for-loop 版本：

```
Dim _source_total As Integer = Source.Count()
For _index As Integer = 0 To _source_total - 1
    If _source_total - _index = MinimumRows - Target.Count _
    OrElse NumberGenerator.GetRandomNumberBetween1And100 <= _possibility_item_is_taken Then
        Target.Add(Source(_index))
    End If
Next 
```

编辑：大卫的无副作用答案接近我需要的同时保持可读性。也许他是唯一能理解我沟通不畅的伪代码的人=）。事后看来，OrderBy(GetRandomNumber) 非常出色。我只需要将 Take(3) 部分更改为 Take(MinimumRequiredPlusAnOptionalRandomAmountExtra) 并在最后删除 OrderBy 和 Select。感谢其他人的建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T08:37:32.860

基本上，您需要引入副作用。

在 C# 中，这相对容易——您可以使用 lambda 表达式来更新捕获的变量。在 VB 中这可能仍然是可能的，但我不想猜测语法。我*不太*了解您的情况（听起来有点倒退），但您可以执行以下操作：

C# 将类似于：

```
int count = 0;

var query = source.TakeWhile(x => count < minimumRequired ||
                                  rng.Next(100) < probability)
                  .Select(x => { count++; return x; });

target.AddRange(query); 
```

每次实际使用项目时，计数都会增加。

请注意，我*怀疑*您实际上想要`Where`而不是`TakeWhile`- 否则第一次`rng`给出一个高数字时，序列将结束。

*编辑：如果你不能直接*使用副作用，你也许可以使用可怕的 hack。这个我没试过，但是...

```
public static T Increment<T>(ref int counter, T value)
{
    counter++;
    return value;
}

...

int count = 0;
var query = source.TakeWhile(x => count < minimumRequired ||
                                  rng.Next(100) < probability)
                  .Select(x => Increment(ref count, x));

target.AddRange(query); 
```

换句话说，您将副作用放入一个单独的方法中，并使用计数器的传递引用来调用该方法。不知道它是否可以在 VB 中工作，但可能值得一试。另一方面，循环可能更简单......

作为一种*完全*不同的处理方式，您的源是否已经是内存中的集合，您可以廉价地对其进行迭代？如果是这样，只需使用：

```
var query = Enumerable.Concat(source.Take(minimumRequired),
                              source.Skip(minimumRequired)
                                    .TakeWhile(condition)); 
```

也就是说，一定要抓前n个元素，然后重新开始，*跳过*前n个元素，根据条件取剩下的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T12:52:13.870

如果您的任务是从 50 个随机图像的集合中提取 3 个随机图像，那么这非常有用。

```
target.AddRange( source.OrderBy(GetRandomNumber).Take(3) ); 
```

如果您需要保留订单，添加起来并不难：

```
target.AddRange( source
  .Select( (x, i) => new {x, i})
  .OrderBy(GetRandomNumber)
  .Take(3)
  .OrderBy( z => z.i)
  .Select( z => z.x)
); 
```

* * *

如果要求（无论出于何种原因）

*   喜欢列表末尾的项目
*   允许通过比请求更多的项目（5 个而不是 3 个，但仅有时）

然后我会写 foreach 循环。

# c# - 如何以编程方式限制对 Web 服务的访问？

> ID：672506
> 
> 赞同：2
> 
> 时间：2009-03-23T07:53:30.860
> 
> 标签：c#, web-services, security, iis

我正在使用 C# 和 .Net 2.0 编写传统的 ASMX Web 服务，以便在 IIS 上进行部署。Web 服务将部署在共享托管环境中，每个客户端都有自己的应用程序副本，位于单独的虚拟目录中（我知道，我知道 - 这是一个遗留应用程序）。每个虚拟目录中都会有一个单独的 Web 服务副本。

由于 Web 服务可能会做一些强大的事情，我想选择性地限制对某些 IP 地址的访问。在防火墙中执行此操作不是一个很好的选择，因为它只是应该限制的 web 服务，而不是网站的其余部分 - 它位于每个虚拟目录级别。

我能否以编程方式读取请求者的 IP 地址并将其与列表进行比较，以便拒绝来自其他地址的呼叫？这有什么重大的陷阱吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T08:06:39.317

是的，你可以轻松做到。

```
[WebMethod]
public bool IsAlive()
{
     string callingAddress = HttpContext.Current.Request.UserHostAddress;
     return (callingAddress == allowedAddress);
} 
```

唯一的缺陷是维护 IP 地址列表。

还值得注意的是，您可以在 IIS 中为每个 Web 应用程序配置 IP 地址访问控制。我在不同的时间使用了这两种方法，这实际上归结为您希望如何维护授权 IP 地址列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-12T07:49:51.020

唯一的缺陷是维护 IP 地址列表。

还值得注意的是，您可以在 IIS 中为每个 Web 应用程序配置 IP 地址访问控制。我在不同的时间使用了这两种方法，这实际上归结为您希望如何维护授权 IP 地址列表。

# flash - Adobe 媒体播放器

> ID：672514
> 
> 赞同：-1
> 
> 时间：2009-03-23T08:00:23.013
> 
> 标签：flash, adobe, media

我对 Adob​​e Media Player ( [http://get.adobe.com/amp/](http://get.adobe.com/amp/) ) 和 Adob​​e Flash Player 之间的不同功能比较感到困惑。

我的理解是，Media Player 可以播放任何支持的视频/音频类型（例如，flv 文件），但 Flash Player 只能播放 swf 文件，不能直接播放视频/音频。我的理解正确吗？

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T08:33:12.217

Adobe 媒体播放器是建立在 Flash 播放器之上的媒体播放器（如 Windows 媒体播放器或 VLC，但专为 Adob​​e 内容（如 FLV）而设计）。你不能直接在 Flash 播放器中播放视频/音频，除非你通过 actionscript / Flash / Flex 让它工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T08:45:32.637

Adobe Media Player 是一个基于 AIR 的桌面应用程序。它与任何其他媒体播放器一样工作，但比典型的媒体播放器范围更广。此应用程序要求您在系统上安装 AIR 运行时。拥有 Flash 播放器还不够。要在独立播放器或浏览器中运行大多数 SWF，需要安装 Flash 播放器。

> Adobe® Media Player 软件为内容创建者、广告内容创建合作伙伴、内容发布者和交付合作伙伴提供了围绕富媒体分发、跟踪和建立业务的新机会。从简单的许可交易到播客和交互式观看体验，可能性仅受您的想象力限制。

在[此处查看](http://www.adobe.com/products/mediaplayer/content_partners/)以了解有关如何将内容添加到 AMP 安装的更多信息。

> 我已经下载了 Adob​​e Media Player，但是找不到在哪里可以输入 flv 文件的 url，请您帮忙指出在哪里设置要播放的 flv 文件？

转到我的收藏夹 > 我的个人视频。左下角有一个添加视频按钮。祝你好运！

> 我可以这样理解吗，Flash Player 支持 swf（不支持直接渲染视频），我们可以在 swf 中开发播放器，并利用 actionscript API 在此类 swf 应用程序中渲染视频——形成 swf 播放器，在 flash 播放器中播放？

Flash Player 允许您播放视频。AMP 主要针对共享在线媒体。如果您愿意，您可以编写自己的播放器。

> 另一个问题是，为什么 Youtube 开发自己的基于 swf 的播放器，为什么不直接在他们的页面中使用 Adob​​e Media Player？有什么技术原因吗？

AFAIK、Youtube 和其他一些人使用他们专有的视频格式（基本上是 SWF + 与安全性 + 优化相关的增量），这就是他们使用定制播放器的原因。

> 似乎 Flash Player 不支持直接播放视频（Flash Player 仅支持播放 swf 文件），这是讨论（我对此感到困惑好几天）。

不，Flash Player 允许您播放 FLV。读[这个](http://www.adobe.com/devnet/flv/)。你真的试过在你的 Flash Player（独立播放器）中播放一个吗？

# c# - 在 C# 中，如何将 Intellisense 添加到 DataGridView 单元格？

> ID：672515
> 
> 赞同：3
> 
> 时间：2009-03-23T08:00:25.320
> 
> 标签：c#, datagridview, intellisense

我希望这将是一个共同的需求。任何人都可以帮助或将我指向解释如何执行此操作的页面吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T08:18:52.157

如果您的意思是 上的自动完成选项`TextBox`，我不知道对此有任何内置支持。最接近的（虽然不一样）是使用`DataGridViewComboBoxColumn`.

对于*不能*直接获得的东西；看起来其他人已经看过这个 - 你可以试试[这里](http://www.vb-tips.com/DataGridViewAutoComplete.aspx)的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:49:52.700

如果您的意思是使用文本框按钮 textChanged 事件从数据库中获取 dataGridView 的数据，请执行此操作。

```
private void textBox1_TextChanged(object sender, EventArgs e)
{
string query = "select Emp_ID,Emp_Name,Father_Name,Email from Employee where Emp_Name like '" + textBox1.Text + "%' ORDER BY Emp_Name ASC";
using (SqlCommand comand = new SqlCommand(query, con))
{
SqlDataAdapter da = new SqlDataAdapter();
da.SelectCommand = comand;
DataTable ds = new DataTable();
ds.Locale = System.Globalization.CultureInfo.InvariantCulture;
da.Fill(ds);
dataGridView1.DataSource = ds;
}
} 
```

# .net - 如何通过 linq 获取树状结构的表数据？

> ID：672524
> 
> 赞同：1
> 
> 时间：2009-03-23T08:05:02.003
> 
> 标签：.net, linq-to-sql, tree

我有一个本身具有树结构的表。

```
Id ParentId Name
----------------
1    null   x
2    null   y
3    null   z
4    null   t
5     1     xx
6     1     xy
7     1     xz
8     2     yx
9     2     yy
10    9     yyx
11    10    yyxx
12    11    yyxxx 
```

我想检索根节点下的整个子树。当我的根节点为“x”时，我想获取节点集 {1、5、6、7、10、11、12}。我怎样才能通过 linq 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T09:03:18.867

如果您能够更改表结构以添加额外的字段，那么我过去使用的一种方法是拥有一个“路径”字段，其中包含一个逗号分隔的 ID 列表。

```
ID    ParentID    Name      Path
--    --------    ----      ----
1     null        x         1
2     null        y         2
3     null        z         3
4     null        t         4
5     1           xx        1,5
6     1           xy        1,6
7     1           xz        1,7
8     2           yx        2,8
9     2           yy        2,9
10    9           yyx       2,9,10
11    10          yyxx      2,9,10,11
12    11          yyxxx     2,9,10,11,12 
```

然后您可以使用 LIKE（或 Linq 中的 StartsWith）基于 Path 字段进行查询

在您的问题中，您说您想获得 { 1, 5, 6, 7, 10, 11, 12 }，但如果我没看错的话，这些 ID 是两个不同子树的一部分。

得到“x”和它所有的孩子......

```
where Path = "1" || Path.StartsWith("1,") 
```

为了得到x的孩子......

```
where Path.StartsWith("1,") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-18T10:40:37.743

您需要使用表本身在 Linq 中执行内部联接，如下所示：

```
from root in TableName 
join subnodes in TableName on root.Id equals subnodes.ParentId
select new { Name } 
```

这将检索父 id 与 Id 匹配的所有记录，并将同一个表重命名为子节点

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T08:58:01.773

```
 /// <summary>
    /// Allows to recursively select descendants as plain collection
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="source"></param>
    /// <param name="DescendBy"></param>
    /// <returns></returns>

    public static IEnumerable<T> Descendants<T>(
        this IEnumerable<T> source, Func<T, IEnumerable<T>> DescendBy)
    {
        foreach (T value in source)
        {
            yield return value;

            foreach (var child in DescendBy(value).Descendants(DescendBy))
            {
                yield return child;
            }
        }
    } 
```

用法：node.children.Descendants(node=>node.children);

# c# - 忽略排队的鼠标事件

> ID：672533
> 
> 赞同：8
> 
> 时间：2009-03-23T08:16:30.867
> 
> 标签：c#, .net, events, compact-framework, windows-ce

我有一个用 C# 编写的面向 .NET Compact Framework 3.5 的应用程序，在 Windows CE 上运行。有时，会在 UI 线程上执行持续一秒左右的操作。我目前将该`Cursor.Current`属性设置为指示应用程序正忙，但这并不能阻止急切用户排队的鼠标事件。这有时会导致意外点击。

在 .NET Compact Framework 平台上忽略排队的鼠标消息的最佳方法是什么？遗憾的是，代码必须在 UI 线程上运行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T09:22:23.843

禁用控件对您没有帮助，正如我从我的 POS 应用程序中发现的那样，用户可以在大约 50 毫秒内再次单击，尤其是在使用未校准的触摸屏时。

这造成的问题之一是在生成发票时，您不能重复点击生成另一张发票，因为在清除当前发票之前有 50 毫秒的延迟。

在这种情况下，我使用类似于以下的模式：

```
 public static void ClearMouseClickQueue()
    {
        Message message;
        while (PeekMessage(out message,IntPtr.Zero, (uint) MessageCodes.WM_MOUSEFIRST,(uint) MessageCodes.WM_MOUSELAST,1) != 0)
        {    
        }
    }

    private object approvalLockObject = new object();

    private void btnApproveTransaction_Click(object sender, EventArgs e)
    {
        ApproveTransactionAndLockForm();
    }

    private void ApproveTransactionAndLockForm()
    {
        lock (approvalLockObject)
        {
            if (ApprovalLockCount == 0)
            {
                ApprovalLockCount++;
                ApproveTransaction();
            }
            else
            {
                CloseAndRetry();
            }
        }
    }

    private void ApproveTransaction()
    {
        ClearMouseClickQueue();

        this.Enabled = false;

        Logger.LogInfo("Before approve transaction");

        MouseHelper.SetCursorToWaitCursor();

        ... validate invoice and print
    } 
```

如果您需要重新启用屏幕，请执行以下操作：

```
 this.Enabled = true;

            ApprovalLockCount = 0;

            DialogResult = DialogResult.None; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T08:43:40.240

我认为最好的解决方案是防止事件发生。当冗长的操作完成时，您可以通过禁用所有控件并重新启用它们来做到这一点。

# c# - 如何在 C# 中将数据从一个列表视图移动到另一个列表视图？

> ID：672539
> 
> 赞同：1
> 
> 时间：2009-03-23T08:20:06.350
> 
> 标签：c#, listview

如何使用 c# 将数据从一个列表视图移动到另一个列表视图

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T08:26:57.783

```
ListViewItem itemClone;
ListView.ListViewItemCollection coll = listView1.Items;
foreach (ListViewItem item in coll)
{
itemClone = item.Clone() as ListViewItem;
listView1.Items.Remove(item);
listView2.Items.Add(itemClone);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T08:25:06.633

```
ListViewItem listItemToMove = listView1.SelectedItems[0];
ListViewItem itemToAdd = (ListViewItem)listItemToMove.Clone ();
listView2.Items.Add (itemToAdd);
listView1.Items.Remove(listItemToMove); 
```

# ruby-on-rails - 在 RoR 中使用 XML/SOAP Web 服务

> ID：672540
> 
> 赞同：0
> 
> 时间：2009-03-23T08:21:02.337
> 
> 标签：ruby-on-rails, web-services, soap

我知道他们从 RoR 中删除了 ActionService 并选择了 RESTful Web 服务。我想知道 Rails 是否是使用基于 XML/SOAP 的 Web 服务的框架的不错选择。谁能指出一些关于如何在 ROR 中使用基于 SOAP 的 Web 服务的好资源/教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T09:41:52.223

这是soap4r的一个非常好的分步教程：[链接不再有效]

# asp.net - ASP.NET：用于存储应在多个 Web 应用程序之间共享的文件的位置

> ID：672544
> 
> 赞同：1
> 
> 时间：2009-03-23T08:23:06.217
> 
> 标签：asp.net, configuration, file

我有两个网络应用程序。一个是可从互联网访问的面向外部的应用程序。另一个是管理第一个的应用程序，只能从 Intranet 访问。

他们将数据保存在文件系统上的文件中（我认为数据库对于这些应用程序来说太过分了）。

管理应用程序应该能够编写一些面向外部的应用程序可以读取的文件（用于提供对来自 Internet 的请求的响应的数据文件），并且面向外部的应用程序应该能够编写一个文件管理可以读取（日志文件）。

我的问题是：存储这些文件的最佳位置是什么？

*   应用数据/[公司名称]/[产品名称]？
*   Web应用程序之一下的APP_DATA？
*   别的地方？

需要考虑的一些因素是： 解决方案需要哪些额外权限？Web 应用程序是否可以在不需要知道其他应用程序安装位置的情况下发现该位置？

在此先感谢您的任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T08:51:50.953

我知道你说数据库会过大，但是如果资源存储在数据库中，那么一侧可能会访问内部系统的双面应用程序会更加安全（尽管不完全安全）。它只是提供了一个额外的层。我认为互联网用户应该在主机文件系统上获得最低限度的权限（是否通过网络服务等网络层）。

否则，为什么不在物理上独立的设备（如果需要，可能会断开连接，例如可疑活动）上的“沙盒”路径，例如 USB 硬盘？

# java - JCR 170 数据建模：节点名称

> ID：672551
> 
> 赞同：1
> 
> 时间：2009-03-23T08:30:01.257
> 
> 标签：java, data-modeling, jackrabbit, jcr

**情况：**
假设我们正在实现一个基于 JCR 并支持本地化的博客引擎。
内容结构看起来像这样*/blogname/content/[node name]*

**问题：** 命名内容节点（/blogname/content/ **[nodename]**）以满足以下要求的最佳方法是什么：

1.  节点名称必须在 HTML 中可用以支持类似 REST 的 URL，即：blogname.com/content/nodename 应指向单个内容项。
2.  上述要求不能产生丑陋的 URL，即：/content/node_name 是好的，/content/node%20name 是坏的。
3.  给定节点名称，编程检索应该很容易，即：//content[@node_name=some-name]
4.  命名方案必须保证节点名称的唯一性。

PS：使用的JCR实现是[JackRabbit](http://jackrabbit.apache.org/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-31T17:53:43.990

**对于 1\. 到 3\. 答案很简单：**只需使用您想在节点名称中看到的字符，即。将您拥有的任何输入字符串（例如博客文章标题）转义为受限字符集，例如[用于 URIs 的](http://www.ietf.org/rfc/rfc2396.txt)字符集。

例如，不允许空格（JCR 节点名称允许使用，但会`%20`在 URL 中产生丑陋）和其他必须在 URL 中编码的字符。您可以删除这些字符或简单地用下划线替换它们，因为在大多数情况下看起来不错。

**关于唯一名称 (4.)**，您可以包括当前时间，包括。毫秒或您明确检查冲突。第一个可能看起来有点难看，但对于博客场景来说可能永远不会失败。后者可以通过在已经存在具有此类名称的节点时对引发的异常做出反应并添加例如。一个递增的计数器，然后重试（例如`my_great_post1`，，`my_great_post2`等）。您还可以锁定父节点，这样实际上只有一个会话可以同时添加一个节点，这样可以避免循环试验，但会以阻塞为代价。

**注意：** `//content[@node_name=some-name]`不是有效的 JCR Xpath 查询。你可能想用`/jcr:root/content//some-name`它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T05:12:14.220

关于项目 3。我最近了解到 xpath 查询不允许项目以数字开头。如果您的节点名称以数字开头，仍然可以通过转义名称的第一个字节来查询它，但是如果您以字母开头所有节点名称，您的查询将更加直接。

（我不确定属性名称。从未见过不是以字母开头的。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-28T19:49:00.180

唯一名称：要从标题的第一个字符加上随机数（以解决冲突）快速生成唯一名称，您可以使用以下算法：

```
String title = "JCR 170 Data modeling: Node names";
String name = title.substring(0, Math.min(title.length(), 10)).trim().replace(' ', '_');
if (name is not unique) {
    name += "_";
    Random r = new Random();
    while (name is not unqiue) {
        name += Integer.toString(r.nextInt(10));
    }
} 
```

使用随机数的好处是：即使你有很多相似的名字，这也能很快解决冲突。

# html - 如何将 CSS 添加到不是我的提要中

> ID：672553
> 
> 赞同：-1
> 
> 时间：2009-03-23T08:31:56.057
> 
> 标签：html, css, image, rss, feed

我想用 CSS 将图像与这个 RSS 的文本分开。

[http://redbolivia.com/index.php?format=feed&type=rss](http://redbolivia.com/index.php?format=feed&type=rss)

有任何想法吗？我可以用 CSS 做到这一点吗？

* * *

如何将 CSS 添加到不属于**我的提要中**

* * *

但是我把CSS放在标题和信息上，但现在我想把图像和文本分开，因为它太近了。我这样做了：

```
.rss_item_header
    {
        font-size:14px;
        font-weight:bold;
    }
/* image try */
    .rss_item.img
{
margin:7px;
}

    .rss_item_info
    {
        color:#666;
        font-size:11px;
text-align:justify ; 
```

* * *

因为我不想在信息旁边的图像显示此提要[http://redbolivia.com/index.php?format=feed&type=rss](http://redbolivia.com/index.php?format=feed&type=rss) 我想在此提要中留出边距，所以图像太近了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T08:36:01.273

不，CSS 用于样式元素，而不是提取它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T18:07:19.013

```
img {
    margin: 5px;
    } 
```

..将为页面上所有图像的所有边添加5px的边距。（你说这不是你的提要。你为什么需要改变这个？）

# asp.net - Asp.net Ajax 临时模态弹出窗口

> ID：672561
> 
> 赞同：1
> 
> 时间：2009-03-23T08:36:39.103
> 
> 标签：asp.net, ajax

我正在使用 Asp.Net 3.5

我想在屏幕中央显示弹出窗口只需 2 秒。它将出现 2 秒。并自动消失。

如何使用模态弹出窗口做到这一点？

我试过了，但 2 秒后没有隐藏？

```
 function showPanel() {
        $find('modal').show();
        setTimeout("hidePanel()",2000);
    }
       function hidePanel() {
       $find('modal').hide();

    }
    </script>
</head> 
```

塞佩特·埃克尔

```
 <cc1:ModalPopupExtender ID="ModalPopupExtender1" runat="server" TargetControlID="SepeteEkle" PopupControlID="bilgi" DropShadow="true" BehaviorID="modal"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T08:42:03.503

将 JQuery 与 UI 对话框插件一起使用。您可以在指定的时间间隔后关闭它。查看[JQuery](http://www.jquery.com)网站了解更多详情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T09:02:10.553

假设您使用的是 ASP.NET AJAX ...

在 ASPX 标记中为您的 ModalPopupExtender 提供一个 BehaviorID，然后您可以使用

```
$find('behaviorID') 
```

在 javascript 中获取面板。

然后你可以有两个功能

```
function showPanel()
{
    $find('behaviorID').show();
    setTimeout("hidePanel()",2000);
}

function hidePanel()
{
    $find('behaviorID').hide();
} 
```

# iphone - 使用 UIImageWriteToSavedPhotosAlbum(imageView.image,nil, nil, nil); 时出现内存泄漏？

> ID：672567
> 
> 赞同：0
> 
> 时间：2009-03-23T08:39:19.407
> 
> 标签：iphone

使用 UIImageWriteToSavedPhotosAlbum(imageView.image,nil, nil, nil); 时出现内存泄漏？在这种情况下，我该如何消除内存泄漏？当我尝试不使用这条线时，没有内存泄漏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T22:12:57.103

nil,nil,nil 是你的问题。

其中一个 nil 被称为 (SEL)completionSelector

你传递给它一个方法选择器。在该方法中，您释放内存。如果我没记错的话，Apple 的文档解释了这一点。如果没有，我确定我已经通过搜索谷歌看到了一些东西，展示了如何做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T22:17:52.210

请记住，当设备没有时，模拟器可能会泄漏内存。

始终在设备上进行泄漏测试。

祝你好运！

# eclipse - 如何在eclipse中设置编辑器窗口标签宽度？（不是空格）

> ID：672568
> 
> 赞同：4
> 
> 时间：2009-03-23T08:39:58.237
> 
> 标签：eclipse, installation

我想知道是否可以在 Eclipse 中设置编辑器窗口选项卡宽度。

当我想连续关闭几个窗口并且总是必须移动鼠标时，我讨厌它。我可以将 Eclipse 设置为每个窗口选项卡仅使用一个宽度吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T09:21:49.133

我认为不可能做到这一点。为什么不使用键盘快捷键呢？

您没有指定平台，但在 Windows 上，快捷键是 Ctrl-W。这样，您不必移动鼠标。

# projects - Cruisecontrol 集团项目

> ID：672572
> 
> 赞同：1
> 
> 时间：2009-03-23T08:41:30.527
> 
> 标签：projects, cruisecontrol

是否可以在 CruiseControl 中对项目进行分组？

（我知道可以使用相同的前缀对它们进行分组……但是真的可以对它们进行分组吗？）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T08:56:15.407

您可以在“项目”下添加标签：

```
<project ...>
  <category>Category 1</category>
  ...
</project> 
```

并根据 CruiseControl 文档：“此项目的一般类别。仪表板使用它来为项目提供分组。类别不跨越服务器。”

# java - 如何解析代码以在 Java 中构建编译器？

> ID：672577
> 
> 赞同：7
> 
> 时间：2009-03-23T08:44:25.340
> 
> 标签：java, parsing, compiler-construction, parser-generator

我需要编写一个编译器。这是大学的家庭作业。老师告诉我们，我们可以使用任何我们想做的API来做代码的解析，只要它是好的。这样我们就可以更专注于我们将生成的 JVM。

所以是的，我会用 Java 编写一个编译器来生成 Java。

你知道有什么好的API吗？我应该使用正则表达式吗？我通常手动编写自己的解析器，尽管在这种情况下不建议这样做。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-23T09:06:10.967

正则表达式很适合在编译器中使用，但仅用于识别标记（即没有递归结构）。

编写编译器的经典方法是拥有一个用于识别标记的**词法分析器**、一个用于识别结构的**语法分析器**、一个用于识别含义的**语义分析器、一个****中间代码生成器**、一个**优化器**，最后一个**目标代码生成器**。如果使编译器更易于编写，则可以合并或完全跳过任何这些步骤。

已经开发了许多工具来帮助完成这个过程。对于Java，您可以查看

*   ANTLR - [http://www.antlr.org/](http://www.antlr.org/)
*   可可/R - [http://ssw.jku.at/Coco/](http://ssw.jku.at/Coco/)
*   JavaCC - [https://javacc.dev.java.net/](https://javacc.dev.java.net/)
*   SableCC - [http://sablecc.org/](http://sablecc.org/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-23T08:58:01.157

我会推荐[ANTLR](http://antlr.org/)，主要是因为它通过 StringTemplate 的输出生成能力。

更好的是，[Terence Parr 的这本书](http://www.pragmaticprogrammer.com/titles/tpantlr/index.html)是迄今为止面向使用解析器生成器编写编译器的更好的书籍之一。

然后你就有了[ANTLRWorks](http://antlr.org/works/index.html)，它可以让你在运行中学习和调试你的语法。

最重要的是，[ANTLR wiki + 文档](http://www.antlr.org/wiki/display/ANTLR3/ANTLR+v3+documentation)（虽然我不喜欢这样全面），对于任何初学者来说都是一个很好的起点。它帮助我在一周内刷新了编译器编写的知识。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-23T08:50:18.663

看看[JavaCC](https://javacc.dev.java.net/)，一个 Java 语言解析器。它非常易于使用并掌握

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-23T08:50:37.743

去经典 - Lex + Yacc。在 Java 中，它拼写为[JAX](http://linux4u.jinr.ru/usoft/WWW/www_blackdown.org/kbs/jax.html)和[javacc](https://javacc.dev.java.net/)。Javacc 甚至有一些[Java 语法](http://java.net/projects/javacc/sources/svn/show/trunk/examples/JavaGrammars?rev=455)可供检查。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-23T14:24:40.187

我建议使用像[ANTLR](http://antlr.org)这样的元编译器，或者一个简单的[解析器组合](http://en.wikipedia.org/wiki/Parser_Combinator)库。[函数式 Java](http://functionaljava.org)有一个[解析器组合器 API](http://functionaljava.googlecode.com/svn/artifacts/2.19/javadoc/fj/parser/package-summary.html)。还有[JParsec](http://jparsec.codehaus.org/JParsec+Overview)。这两个都基于[Haskell 的 Parsec 库](http://www.haskell.org/haskellwiki/Parsec)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-23T13:57:42.950

[JFlex](http://jflex.de)是一个扫描器生成器，根据[手册](http://jflex.de/manual.html#SECTION00090000000000000000)，它被设计为与解析器生成器[CUP](http://www2.cs.tum.edu/projects/cup/)一起使用。

> JFlex 的主要设计目标之一是尽可能简单地与免费的 Java 解析器生成器 CUP 交互 [原文如此]。

它还[支持](http://jflex.de/manual.html#SECTION00092000000000000000)BYACC [/J](http://byaccj.sourceforge.net/)，顾名思义，它是 Berkeley YACC 的一个端口，用于生成 Java 代码。

我使用过 JFlex 本身并喜欢它。但是，我正在做的项目很简单，我手动编写了解析器，所以我不知道 CUP 或 BYACC/J 有多好。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-23T09:35:31.287

我在我的编译器课程中使用了 SableCC，尽管不是自愿的。

我记得发现它非常笨重和重量级，更强调清洁而不是方便（没有运算符优先级或任何东西；你必须在语法中说明这一点）。

如果可以选择，我可能想使用其他东西。我对 yacc（对于 C）和 happy（对于 Haskell）的体验都很愉快。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-23T11:58:49.147

解析器组合器是一个不错的选择。流行的 Java 实现是 JParsec。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-23T09:27:24.503

如果您要成为铁杆，请在混合中加入一些[http://llvm.org](http://llvm.org) :)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-23T19:42:32.667

我建议您查看 BeanShell 的源代码。它有一个 Java 编译器，而且读起来相当简单。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-01-23T17:44:19.657

[http://java-source.net/open-source/parser-generators](http://java-source.net/open-source/parser-generators)和[http://catalog.compilertools.net/java.html](http://catalog.compilertools.net/java.html)包含用于此目的的工具目录。还比较 Stackoverflow 问题[Alternatives to Regular Expressions](https://stackoverflow.com/questions/514313/alternatives-to-regular-expressions)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-04-14T12:27:46.080

使用解析器组合器，例如[JParsec](http://jparsec.codehaus.org/)。[关于如何使用它](https://vimeo.com/40323909)有一个很好的视频教程。

# jquery - 在执行操作之前等待使用 jquery

> ID：672582
> 
> 赞同：0
> 
> 时间：2009-03-23T08:49:23.567
> 
> 标签：jquery, jquery-1.3.2

我使用 jquery 1.3.2 版，

我想使用事件“加载”将页面内容加载到“div”。

我用过：`$("#div1").load("page1.php");`--->它起作用了。

但我想在做事件“加载”之前，它等待大约时间。

同样：`$("#div1").load("page1.php",{after: 5});`

请告诉我怎么做，非常感谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T08:53:53.757

您可以尝试[延迟插件](http://james.padolsey.com/javascript/jquery-delay-plugin/)或查看更[传统的方法](http://www.elated.com/articles/javascript-timers-with-settimeout-and-setinterval/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T09:24:09.770

您可以尝试减慢服务器发送响应的速度，例如

```
//sleep for 5 seconds before outputting stuff
sleep(5);
echo 'Now I\'ll talk!'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T09:38:16.567

使用 settimeout() 将是最好和最简单的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-02T01:27:02.257

Try this:

```
setTimeout(function() {
   $("#div1").load("page1.php");
}, 5000); 
```

# apache-flex - flex 3 根据数据网格大小使应用程序高度动态化

> ID：672588
> 
> 赞同：1
> 
> 时间：2009-03-23T08:51:15.027
> 
> 标签：apache-flex, dynamic, height

我需要根据用户搜索特定项目后更改的数据网格的大小使我的应用程序高度动态化。有人可以帮我弄这个吗。

此外，当我嵌入到我的 html 中时，是否有一个我可以调用的 javascript 函数可以访问应用程序高度，以便我可以相应地设置页面？

需要从我的 html 页面内部调用 javascript，以便我可以获得动态高度

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T09:06:26.707

如果您的 SWF 嵌入对象具有 ID（或任何其他唯一标识方式），则更改其大小相当简单。使用 jQuery，例如：

```
$("#swf").height(500); 
```

这会将 SWF 的高度设置为 500 像素。即使没有 jQuery，它也相当简单：

```
document.getElementById("swf").style.height = "500px"; 
```

要从 Flash 内部调用 javascript，请使用 ExternalInterface 类，它有一个用于此目的的静态方法。（或者，您可以使用带有“javascript:”协议的 navigateToURL() 静态函数。）

# c# - 在 C# 中为 XML 文档创建父节点

> ID：672593
> 
> 赞同：1
> 
> 时间：2009-03-23T08:52:23.840
> 
> 标签：c#, asp.net, xml

我的代码：

```
// Read in Xml-file 
XmlDocument doc = new XmlDocument();
doc.Load("C:/Web.config");

XmlNode d = doc.SelectSingleNode("/configuration");
XmlNode MYNODE = doc.CreateNode("element", "connectionStrings", "");

//newParent.(childNode);
d.AppendChild(MYNODE);

//Saving the document
doc.Save("C:/Web.config"); 
```

我的 Web.config 中的 MyOutput：

```
<connectionStrings /> 
```

我在 Web.config 中真正想要的输出：

```
<connectionStrings>

</connectionStrings> 
```

我必须在我的代码中进行哪些更改才能获得正确的输出？另外，如果我想让我的标签出现在另一个标签的上方，我必须怎么做...说我的 --SharePoint-- 标签。

问候艾蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T09:00:42.523

输出是正确的。由于标签中没有任何子元素`connectionStrings`，因此它呈现为空标签。

`<connectionStrings />`与 的意思相同`<connectionStrings></connectionStrings>`。

如果要在特定节点之前插入标签，请使用以下`InsertBefore`方法：

```
XmlNode sharePoint = doc.SelectSingleNode("SharePoint");
XmlNode MYNODE = doc.CreateNode("element", "connectionStrings", "");

doc.InsertBefore(MYNODE, sharePoint); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T09:01:10.620

两者`<ConnectionStrings>`看起来都一样。`<connectionStrings />`和没有区别`<connectionStrings></connectionStrings>.`

您可以使用`AppendChild()`or`InsertBefore()`或`InsertAfter()`方法来定位您的节点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T09:02:15.780

您也许可以在元素中添加一些空白文本？

```
MYNODE.InnerText = " "; 
```

或者其他一些内容——也许是评论？如果没有一些内容，这两种形式几乎相同。

重新提出“标签”问题-这取决于您的意思...但是`XmlNode`具有`InsertBefore`并且`InsertAfter`-只需找到您希望它与之相邻的节点并使用其中之一即可。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T09:03:21.503

它们都是格式良好的 xml 格式。

但是，如果您向附加的子节点添加新的子节点，您将得到您想要的。例如，只需在 connectionstrings 节点中添加一个空格：

```
XmlNode MYNODE = doc.CreateNode("element", "connectionStrings", "");
MYNODE.InnerText = " "; 
```

这对实际使用连接字符串元素没有任何影响。但输出将如您所愿。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T11:01:07.913

```
XmlNode root = doc.DocumentElement;
root.InsertAfter(connNODE, root.FirstChild); 
```

这是我需要做的，以便将我的节点放置在正确的位置。感谢大家的帮助！艾蒂安

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-06T12:39:39.497

抱歉来晚了，但我忍不住回复这个帖子：

```
XmlNode xNode = xDoc.CreateNode("element", "FundDetails", ""); // Parent node to insert
xDoc.InsertBefore(xNode, xDoc.ParentNode); // inserting parent node to existing XML document 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-06-05T05:31:36.720

> 此代码帮助父节点从数据库中获取更多数据。

```
 XmlNode dataNode = doc.CreateNode(XmlNodeType.Element, "connectionstrings", null);
                 root.PrependChild(dataNode);
                for (int i = 1; i < root.ChildNodes.Count; i++)
                {
                    dataNode.AppendChild(root.ChildNodes[i]);
                    i--;
                } 
```

如果您向附加的子节点添加新的子节点，您将得到您想要的。例如，只需将 NULL 添加到 connectionstrings 节点中。

# asp.net - ASP.NET MVC 是否使 Web 窗体成为传统平台？

> ID：672597
> 
> 赞同：10
> 
> 时间：2009-03-23T08:53:44.193
> 
> 标签：asp.net, asp.net-mvc

上周在 Mix '09 上，发布了[ASP.NET MVC](http://www.asp.net/mvc/) 1.0 的最终版本。

该框架的一些既定好处是：

> *   清晰的关注点分离
> *   可测试性 - 支持测试驱动开发
> *   对 HTML 和 JavaScript 的细粒度控制
> *   直观的 URL

现在，微软正在小心地吹捧这是“ASP.NET Web 表单的替代品，而不是替代品”，但鉴于上述优势，我想知道：

1.  “经典” ASP.NET Web 窗体被认为是“遗留”框架需要多长时间？
2.  如果您今天开始开发一个新的 .NET Web 项目，为什么会选择使用 Web 窗体而不是 ASP.NET MVC 产品？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T09:10:02.580

好问题。我认为最终的答案将是开发团队的专业知识和将决定这一点的项目需求。ASP.NET Web 表单被大量使用，它可能不会很快消失。此外，还有很多自定义控件和第三方支持，例如组件和书籍。Web 表单的主要好处是创建一个动态网站是多么容易。这确实是开发网站的一种 RAD 方式。

但是，一旦该团队在创建对可扩展性、可靠性和可测试性有更高要求的大型网站方面拥有更多经验，他们就会为此寻求其他解决方案。在这种情况下，他们会意识到 Web 表单更难进行单元测试。他们也可能会看到视图状态会降低性能并寻找可能的解决方案。

尽管 MVC 具有上述优点，但不太可能有人会立即或永远转换他们的网站以使用这个新框架。另外，它需要团队学习新技术，并解决新的错误。团队将不得不学习新的方法来做同样的事情。例如，支持使用 MVC 上传文件有多容易？

正如我最近看到的，没有理由不能同时使用 MVC 和 Web 表单来创建站点。所以你可能会在不久的将来看到更多的混合动力车。但我怀疑网络表单会永远消失。

我有点想 Web 表单，比如 VB1 改变了在桌面上创建 Windows 应用程序的方式。时至今日，RAD 创建应用程序的方式仍然存在并且永远不会消失。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T09:20:46.190

请记住，MVC 仍然使用 WebForms 作为它的默认视图引擎。当然，您可以用另一个替换它，但 WebForms 仍然是它的核心部分。

此外，并不是每个人都喜欢严格控制 HTML 或路由。这不是我的态度，但有些人只是希望以最小的努力完成他们的工作。

.asmx 文件在技术上不也是“旧”模型的一部分吗？我可以肯定地说，很多人不希望看到他们离开。

不过，我个人认为 ASP.net MVC 将成为未来 ASP.net 的主要 Web 引擎，尽管尚未出现在 .net 4.0 中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T12:34:53.550

您问的是新发布的 Web 平台 ASP.NET MVC 何时会取代已经存在七年的 Web 窗体。

如果过去七年我们一直在为 ASP.NET MVC 呐喊，那么在发布 ASP.NET MVC 之前不会花七年时间。事实是，并不是每个人都认为有必要这样做。在这七年的大部分时间里，我们中的许多人一直在创建复杂的、高度可扩展的 Web 应用程序。

我们甚至知道如何使它们可测试，并将表示与业务逻辑和数据访问分开。ASP.NET MVC 可能会强制执行这种分离，但我已经通过使用编码标准和代码审查来做到这一点，并且说“没有针对此的单元测试”和“从 UI 中获取业务逻辑”。

此外，如果我真的需要对 HTML 进行更多控制，我会编写自己的控件来生成 HTML。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T09:18:51.450

我不相信 WebForms 会退休。

我一直在业务应用程序中使用 WebForms，在家里使用 MVC 处理一些私人事务。虽然我真的很喜欢 MVC，但我看不出这怎么可能用 HTML/CSS/JavaScript 实现真正复杂的 UI 逻辑。它很快就会变得难以管理并且非常不安全，因为可以关闭 JavaScript 以防止禁用某些控件或隐藏某些信息。相反，使用 WebForms 关闭 JavaScript 几乎会使页面无法执行任何操作，无论是否授权。

这两个平台都将继续发展。对于一般的网站和 HTML/CSS 爱好者来说，MVC 是一种可行的方法，对于复杂的应用程序，您可能需要面向对象的架构和人工事件处理，即使它使您从 HTTP 的无状态本质中抽象出来。

所以，选择最适合你的。

PS 完全放弃 WebForms 将危及全球众多项目和公司的未来。微软人不想成为仇恨的对象和引发第三次世界大战的导火索。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T15:09:17.410

对于那些想要一个伪无状态 Web 应用程序的人来说，WebForms 仍然占有一席之地，他们可以通过拖放轻松地组合在一起。对于那些不需要或不想了解 HTTP 工作原理的人。它是 Web 应用程序的终极 RAD。

另一方面，ASP.NET MVC 允许以更多责任为代价进行更精细的控制。您可以完全控制您的 HTML，但这意味着您必须自己清理/编码您的输出。大多数情况下，您的应用程序必须是完全无状态的，并且对于一些 ASP.NET WebForms/Windows WinForms 开发人员来说，这有点难以理解。

我认为任何一个都不会支配另一个，尽管一个可能会受到青睐。

# java - Java：谷歌地图替代品

> ID：672600
> 
> 赞同：4
> 
> 时间：2009-03-23T08:55:13.987
> 
> 标签：java, api, maps

我真的厌倦了使用 Google Web Toolkit 使用 Netbeans 访问 Java 中的 Google Maps... 有人知道提供简单（r）API 的好选择吗？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T09:02:20.680

[OpenStreetMap](http://openstreetmap.org/)结合[OpenLayers](http://www.openlayers.org/)有一个很好的[API](http://wiki.openstreetmap.org/wiki/API)。 祝你好运！

包括驾驶说明，但由于 OSM 是用户生成的，因此您不能 100% 依赖此信息。参见[OSM-Wiki 文章“路由”](http://wiki.openstreetmap.org/wiki/Routing)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-28T20:26:04.337

如果您想要另一个 API 具有出色的路由和其他具有 J2ME API 的映射替代方案，您可以查看 [Shameless plug] [http://developer.decarta.com](http://developer.decarta.com) [/shameless plug]

我们还提供地图绘制、地理编码和其他很酷的空间功能。我们有一个 android API、iOS API、移动 JS 和一个桌面 JS 以及 XML Web 服务。

# activex - IE是否安装了activex控件？

> ID：672605
> 
> 赞同：0
> 
> 时间：2009-03-23T08:58:25.743
> 
> 标签：activex, controls, installation

简单问题：如何控制我的activex安装在客户端？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T10:10:33.057

变种 p; try { p = new ActiveXObject('你的 activex 控件名称'); } catch (e) { alert("未安装"); }

它真的很简单不是吗？好的编程:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T09:12:51.700

主要方法是尝试创建它的实例。如果创建失败，则表示未安装 activex 控件或发生其他错误。

# .net - 在项目中引入代码生成器。这会是一种风险吗？

> ID：672608
> 
> 赞同：2
> 
> 时间：2009-03-23T08:59:47.643
> 
> 标签：.net, code-generation

我对一个 .NET 项目（VS2008/.NET 3.5）进行了代码审查。我注意到许多业务实体和数据访问组件是从头开始创建的，而没有实现复杂的火箭科学代码的业务需求。

许多审查问题与数据访问层有关。

查看所使用的架构，我建议结合 .NetTiers 引入像 CodeSmith 这样的代码生成器。

技术负责人喜欢这个想法，但他说引入这个会有风险，因为团队正处于开发阶段的中间，项目太小。

在这个阶段引入代码生成器是否更好？

*（本主题不是关于必须使用哪种代码生成工具，而是关于何时引入它或是否引入它的时机）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T17:06:55.287

在这样的团队中引入代码生成器时，我会非常小心。特别是你提到的那些。也就是说，这可能因项目/团队而异。

考虑：

*   目前的手写dal是否足以满足项目的实际需求？如果您确实需要引入分页和其他类似功能，这一点尤其重要。如果团队没有这些，并且已经面临问题，那么他们将很难继续前进。我想说这更像是 ORM 的一个案例，特别是一些精简的东西。
*   团队中的一部分人是否对这些工具之一有任何先前的知识？这些成员是否将它们用于成功的项目？这比看起来更重要，特别是如果您正在考虑像 nettiers 这样广泛的东西，它会引入自己的问题/思维定势。考虑一些容易理解的东西，这不会让你彻底改变。
*   您是否清楚地了解该工具及其使用方式如何影响开发人员引入更改的时间。无论使用哪种工具，都不要让它在文件上放置日期/时间，因为它会在查看源代码控制日志时知道发生了什么变化。无论您使用哪种工具，开发人员都应该能够毫不费力地使用它，否则它将进入中间（特别是在正在进行的项目中）。
*   您将如何将生成的代码与已经未生成的代码集成？如果不清楚，您可能正在谈论完全扔掉。如果您处于这种情况，那么引入新工具不太可能解决团队问题。
*   您没有适当的测试自动化。在没有测试自动化的情况下进行更改要困难得多，特别是因为很难不破坏某些东西。

附言。不久前，我们在几个项目中引入了 nettiers（对我们来说似乎很好 :()。我们在项目开始时就这样做了，即使这样它也确实进入了中间。当然我们有更多的代码更快，但这确实没有这并不意味着我们有更多重要的代码。开始使用自定义代码（加上 linq2sql）开发新功能，生产力和质量迅速提高。我们再也没有使用过它，也从未错过它。我们广泛使用 ORM，并且其他更专注代码生成在这里和那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T09:19:09.017

在中间添加新东西到项目中总是存在风险，尤其是当新东西正在取代旧东西时。基本上任何依赖于旧代码的代码都需要完全测试。这是改变的风险和成本的一部分。

风险伴随着错误。假设一切正常，那么这不是问题。但是当出现问题时会发生什么？然后成本上升，因为需要额外的时间来再次通过调试/测试周期。

中间唯一有意义的情况是，如果您还没有进行任何测试。但是，如果是这样的话，那么我会更担心总体质量，因为我希望这样一个低级别的层在整个过程中都经过彻底的测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T09:32:39.857

*   至少暂时不要使用现有的手写代码
*   如果你能找到一个真正让开发新组件更容易/更快的代码生成器，那么我看不出它会带来风险或难以“推销”给开发人员
*   虽然生成重复代码比手动编写更好，但它实际上只是一个创可贴
*   理想情况下，您应该找到一种方法来提取重复方面，从而允许您手动编写非重复代码。
*   例如，使用[NHibernate](http://www.hibernate.org/343.html)进行数据访问，这样您就不必为每个域对象编写 CRUD 操作，而只需指定它们如何映射到 DB 表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T22:28:24.393

我已经使用代码生成器（不包括 Visual C++ 等标准工具）参与了几个项目。一开始他们很酷。实时节省。最后，几乎每个人都讨厌他们。对于您以后添加的任何新功能，它们需要太多的定制或太多的工作。此外，一些可怜的 schlub 通常最终会永远卡在项目上，因为他们是唯一知道如何修改工具的人。你可能不希望那个人成为你:)

就像迈克尔建议的那样，正确的路线是找到一种通过重新设计来消除重复编码的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T09:04:20.237

你可能会看[T4 生成代码](https://stackoverflow.com/questions/524295/code-generators-or-t4-templates-are-they-really-evil)，内置在 Visual Studio 中，无需额外安装。

我已经阅读了 Oleg 的一些[非常有用的教程](http://www.olegsych.com/2008/09/t4-tutorial-creating-reusable-code-generation-templates/)，很容易一次开始将其应用于您的开发的一部分，从而降低所涉及的风险。然后，如果证明它是值得的，就多应用它。

# c# - 'where()' 方法的问题

> ID：672612
> 
> 赞同：1
> 
> 时间：2009-03-23T09:01:34.160
> 
> 标签：c#, .net, linq

参考我关于[在 foreach 循环中过滤（“约束”）类型的](https://stackoverflow.com/questions/671229/type-constraint-on-foreach-using-linq-extensions)问题，我正在尝试 Charlie Flowers 回答中的第一种方法，使用集合上的 .Where 方法，但编译器在系统上找不到 .Where 。 Web.UI.ControlCollection 类。这是从 IEnumerable 派生的，那么这里有什么问题呢？

```
foreach (var control in Controls.Where(i => i.GetType() == typeof(TextBox))) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T09:14:54.813

首先，确保你有`using System.Linq;`在文件的顶部。

`IEnumerable`如果您有一个实现但没有实现的集合`IEnumerable<T>`，但您知道对象都是给定类型（例如`Control`），那么您可以使用`Cast<T>`LINQ 扩展方法：

```
foreach (var control in Controls.Cast<Control>()
        .Where(i => i.GetType() == typeof(TextBox))) {...} 
```

但是，鉴于您的`Where`条款，在这种情况下，使用该方法可能更谨慎，该`OfType<T>`方法仅返回给定类型的方法（`Cast<T>`如果有任何错误，则抛出异常）：

```
foreach (var control in Controls.OfType<TextBox>()) {...} 
```

这与您的版本之间的细微差别在于，上面将返回 的子类`TextBox`，而您的`GetType() == typeof(TextBox)`版本不会。

基本上，大多数 LINQ 扩展方法只为`IEnumerable<T>`/定义`IQueryable<T>`，而不是`IEnumerable`/ `IQueryable`。

# c# - C# 中的树节点中是否提供只读属性？

> ID：672613
> 
> 赞同：0
> 
> 时间：2009-03-23T09:01:34.457
> 
> 标签：c#, readonly, tree-nodes

如何在 Windows C# 中设置树节点“只读”？我们不应该禁用，默认。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T09:11:03.187

将`TreeView.LabelEdit`属性设置为 False

# c++ - C++ 中的宏扩展

> ID：672618
> 
> 赞同：5
> 
> 时间：2009-03-23T09:03:00.990
> 
> 标签：c++, macros

如何定义参数位于行首的宏（或解决方法）？

```
#define SINGLETON_IMPLEMENTATION(className) \
    ##className* ##className::instance_ = NULL; 
```

这会给出编译器警告（GCC 3.2.3）：“'##' 不能出现在宏扩展的任一端”

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-23T09:10:26.527

您只需要## 将参数附加到另一个字符串。您的宏可以重铸为

```
#define SINGLETON_IMPLEMENTATION(className) \
    className* className::instance_ = NULL; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-23T09:08:59.057

`##`是连接运算符；编译器只是在抱怨这一点。
你不能在没有之前的东西的情况下连接一个标记，即在宏扩展的开头；只需尝试删除`##`第二行开头的 。
第二个`##`似乎也是错误的。如果您只想初始化一个单例指针，`##`请从宏中删除两个 s。

# scrollbar - 如何使垂直滚动条跟随数据？

> ID：672630
> 
> 赞同：2
> 
> 时间：2009-03-23T09:07:57.327
> 
> 标签：scrollbar, visual-c++-6

在我的 VC++ 6.0 MFC 中，我添加了一个带有垂直滚动条的 EditBox，每 10 秒我从串口读取数据，我必须通过 EditBox(IDC_EDIT1) 显示，我没有任何问题地完成它。

但是我面临的一个典型问题是，每当在 EditBox 中显示新数据时，垂直滚动条会向上并且数据保持向下，我每次都必须向下滚动才能读取数据。

所以我的问题是，每当 EditBox 中显示新数据时，垂直滚动条也必须与数据一起向下移动。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T09:11:49.017

您需要向编辑控件发送一个 EM_SETSEL 消息，其中字符串的长度作为参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T08:49:48.033

此外，如果您的 EditBox 是 CEdit，您可以尝试遵循其成员函数 void SetSel( DWORD dwSelection, BOOL bNoScroll = FALSE ); void SetSel(int nStartChar, int nEndChar, BOOL bNoScroll = FALSE);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T15:18:47.513

您可以向控件发送消息：

```
SendMessage(hwnd, WM_VSCROLL, SB_BOTTOM, 0); 
```

其中 hwnd 是编辑框的句柄

# database - 帮我把这些数据结构变成数据库表

> ID：672635
> 
> 赞同：2
> 
> 时间：2009-03-23T09:11:01.890
> 
> 标签：database, data-structures

~~自从我上次修改数据库以来已经有一段时间了，而且通常我的思绪已经转移到我需要做的事情上。这是我的问题：~~

 ~~1.  我有一个条目列表（字符串）。
2.  每个条目都有自己的名称和唯一 ID。
3.  条目可以共享名称，但不能共享 ID。
4.  条目也可以有属性（字符串）。
5.  条目可以有多个相同的属性。
6.  每个条目的每个属性都可以有自己的值（字符串）。~~ 

~~满足这些要求的最佳表格布局是什么？~~

好吧愚蠢的问题。无论如何感谢您的帮助。:P

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T09:29:51.877

条目表，带有 Name 和 UniqueID (PK)

属性表，带有 PropertyName 和 ID (PK)

具有 EntryID (FK)、PropertyID (FK)、UniqueID (PK)、值的 EntryProperty 表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T09:35:16.747

```
CREATE TABLE entries (
  INTEGER id NOT NULL AUTOINCREMENT,
  VARCHAR(XX) name,
  PRIMARY KEY(id)
)

CREATE TABLE properties (
  INTEGER id NOT NULL AUTOINCREMENT,
  VARCHAR(XX) name,
  VARCHAR(XX) value,
  INTEGER entryid NOT NULL,
  FOREIGN KEY(entryid) REFERENCES entries (id)
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T09:30:14.340

> 好吧，我的问题是弄清楚如何处理具有多个重复属性的条目。我是为每个条目创建一个新表还是什么？

好吧，没有:-)

假设您有一个条目和属性表，我猜您需要一个包含以下列的表：

```
id, entry_id, property_id, property_value, timestamp 
```

这有帮助还是我弄错了？

# c# - 在事件处理程序中使用 null 检查

> ID：672638
> 
> 赞同：29
> 
> 时间：2009-03-23T09:11:48.877
> 
> 标签：c#

在检查事件处理程序是否为空时，这是在每个线程的基础上完成的吗？

确保有人正在收听事件是这样完成的：

```
EventSeven += new DivBySevenHandler(dbsl.ShowOnScreen); 
```

如果我在上面检查空值的地方添加遵循此模式的代码，那么为什么需要空值检查（[代码取自该站点](http://www.codeproject.com/KB/cs/csevents01.aspx)）。我错过了什么？

另外，事件和 GC 的规则是什么？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-03-23T09:20:17.157

问题是如果没有人订阅该事件，则它为空。而且您不能针对空值调用。三种方法跃入脑海：

*   检查空值（见下文）
*   添加一个“什么都不做”处理程序：`public event EventHandler MyEvent = delegate {};`
*   使用扩展方法（见下文）

在检查 null 时，为了线程安全，*理论上*您必须首先捕获委托引用（以防它在检查和调用之间发生变化）：

```
protected virtual void OnMyEvent() {
    EventHandler handler = MyEvent;
    if(handler != null) handler(this, EventArgs.Empty);
} 
```

扩展方法具有可在空实例上调用的不寻常属性...

```
 public static void SafeInvoke(this EventHandler handler, object sender)
    {
        if (handler != null) handler(sender, EventArgs.Empty);
    }
    public static void SafeInvoke<T>(this EventHandler<T> handler,
        object sender, T args) where T : EventArgs
    {
        if (handler != null) handler(sender, args);
    } 
```

然后你可以打电话：

```
MyEvent.SafeInvoke(this); 
```

它既是空安全的（通过检查）又是线程安全的（通过只读取一次引用）。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-03-23T09:21:06.967

恐怕我真的不清楚你的意思，但如果委托可能为空，你需要在每个线程上单独检查。通常你会这样做：

```
public void OnSeven()
{
    DivBySevenHandler handler = EventSeven;
    if (handler != null)
    {
        handler(...);
    }
} 
```

这样可以确保即使您`EventSeven`在使用过程中发生更改`OnSeven()`也不会获得`NullReferenceException`.

但是你是对的，如果你肯定有一个订阅的处理程序，你就不需要空检查。这可以在 C# 2 中使用“no-op”处理程序轻松完成：

```
public event DivBySevenHandler EventSeven = delegate {}; 
```

另一方面，如果您可能从各个线程获得订阅，您*可能*需要某种锁定以确保您拥有“最新”的处理程序集。[我的线程教程](http://jonskeet.uk/csharp/threads/lockchoice.shtml)中有一个示例可以提供帮助 - 尽管通常我建议尽量避免需要它。

在垃圾回收方面，事件*发布*者最终会引用事件*订阅者*（即处理程序的目标）。如果发布者的寿命比订阅者长，这只是一个问题。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2015-09-01T15:54:01.503

我想附加一些关于 C# 6.0-Syntax 的简短信息：

现在可以替换它：

```
var handler = EventSeven;

if (handler != null)
    handler.Invoke(this, EventArgs.Empty); 
```

有了这个：

```
handler?.Invoke(this, EventArgs.Empty); 
```

* * *

将它与*表达式体成员*结合起来，您可以缩短以下代码：

```
protected virtual void OnMyEvent()
{
    EventHandler handler = MyEvent;
    handler?.Invoke(this, EventArgs.Empty);
} 
```

降到**单线**：

```
protected virtual void OnMyEvent() => MyEvent?.Invoke(this, EventArgs.Empty); 
```

* * *

[有关空条件运算符的详细信息，请参阅 MSDN](https://msdn.microsoft.com/en-us/library/dn986595.aspx)
请参阅有关表达式主体成员的[此博客](http://www.informit.com/articles/article.aspx?p=2414582)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T09:17:00.223

在触发事件处理程序之前检查它始终是一个好习惯。即使我最初“保证”自己始终设置它，我也会这样做。如果我稍后更改此设置，则不必检查所有事件触发。因此，对于每个事件，我总是有一个伴随的 OnXXX 方法，如下所示：

```
private void OnEventSeven()
{
    var handler = EventSeven;
    if (handler != null)
    {
        handler(this, EventArgs.Empty);
    }
} 
```

如果事件处理程序对您的类是公共的，这一点尤其重要，因为外部调用者可以随意添加和删除事件处理程序。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-23T09:20:06.300

如果你是这个意思：

```
public static void OnEventSeven(DivBySevenEventArgs e)
    {
        if(EventSeven!=null)
            EventSeven(new object(),e);
    } 
```

一段代码，那么答案是：

如果没有人订阅“EventSeven”事件处理程序，那么您将在“EventSeven(new object(),e);”上获得空引用异常；

和规则：

当订阅者不想再接收事件时，订阅者负责添加处理程序 (+=) 并删除它 (-=)。垃圾收集遵循默认规则，如果不再引用某个对象，则可以对其进行清理。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-03-26T00:20:30.033

使用[PostSharp](http://www.sharpcrafters.com/)可以在编译后步骤中调整已编译的程序集。这允许您将“方面”应用于代码，解决横切关注点。

尽管空检查或空委托初始化可能是一个非常小的问题，但我编写了一个方面，通过向程序集中的所有事件添加一个空委托来解决它。

它的使用非常简单：

```
[assembly: InitializeEventHandlers( AttributeTargetTypes = "Main.*" )]
namespace Main
{
   ...
} 
```

我[在我的博客上详细讨论了这个方面](http://whathecode.wordpress.com/2012/03/26/null-checks-for-event-handlers-an-aspect-solution/)。如果你有 PostSharp，这里是方面：

```
/// <summary>
///   Aspect which when applied on an assembly or class, initializes all the event handlers (<see cref="MulticastDelegate" />) members
///   in the class(es) with empty delegates to prevent <see cref="NullReferenceException" />'s.
/// </summary>
/// <author>Steven Jeuris</author>
[AttributeUsage( AttributeTargets.Assembly | AttributeTargets.Class | AttributeTargets.Event )]
[MulticastAttributeUsage( MulticastTargets.Event, AllowMultiple = false )]
[AspectTypeDependency( AspectDependencyAction.Commute, typeof( InitializeEventHandlersAttribute ) )]
[Serializable]
public class InitializeEventHandlersAttribute : EventLevelAspect
{
    [NonSerialized]
    Action<object> _addEmptyEventHandler;

    [OnMethodEntryAdvice, MethodPointcut( "SelectConstructors" )]
    public void OnConstructorEntry( MethodExecutionArgs args )
    {
        _addEmptyEventHandler( args.Instance );
    }

    // ReSharper disable UnusedMember.Local
    IEnumerable<ConstructorInfo> SelectConstructors( EventInfo target )
    {
        return target.DeclaringType.GetConstructors( BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic );
    }
    // ReSharper restore UnusedMember.Local

    public override void RuntimeInitialize( EventInfo eventInfo )
    {
        base.RuntimeInitialize( eventInfo );

        // Construct a suitable empty event handler.
        MethodInfo delegateInfo = DelegateHelper.MethodInfoFromDelegateType( eventInfo.EventHandlerType );
        ParameterExpression[] parameters = delegateInfo.GetParameters().Select( p => Expression.Parameter( p.ParameterType ) ).ToArray();
        Delegate emptyDelegate
            = Expression.Lambda( eventInfo.EventHandlerType, Expression.Empty(), "EmptyDelegate", true, parameters ).Compile();

        // Create a delegate which adds the empty handler to an instance.
        _addEmptyEventHandler = instance => eventInfo.AddEventHandler( instance, emptyDelegate );
    }
} 
```

...以及它使用的辅助方法：

```
/// <summary>
///   The name of the Invoke method of a Delegate.
/// </summary>
const string InvokeMethod = "Invoke";

/// <summary>
///   Get method info for a specified delegate type.
/// </summary>
/// <param name = "delegateType">The delegate type to get info for.</param>
/// <returns>The method info for the given delegate type.</returns>
public static MethodInfo MethodInfoFromDelegateType( Type delegateType )
{
    Contract.Requires( delegateType.IsSubclassOf( typeof( MulticastDelegate ) ), "Given type should be a delegate." );

    return delegateType.GetMethod( InvokeMethod );
} 
```

# java - PreparedStatement中的JDBC生成SQL

> ID：672640
> 
> 赞同：0
> 
> 时间：2009-03-23T09:11:57.223
> 
> 标签：java, jdbc, prepared-statement

我最近遇到了一个非常大的问题，这花了我很多时间来调试。我有一个更新语句，它更新表中的 32 列。我用 PreparedStatement 做到了这一点。不小心我删除了一个 setParameter() 调用，所以更新无法成功完成。

我从 JDBC (Apache Derby) 得到异常，告诉：“至少一个参数未初始化”并且无法确定未设置哪个参数，因为驱动程序不会告诉您至少第一个参数的名称或序号没有设置...

我在谷歌上搜索某些实用程序未成功，该实用程序将从（即将完成的）准备好的语句中生成普通的旧 SQL。这在这种情况下会有很大帮助，因为我将能够看到未设置的内容。

有没有人遇到过这个问题？有什么解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T09:14:15.487

看看[P6Spy](http://www.p6spy.com/)。它可以拦截所有 JDBC 调用并在将它们转发到数据库之前将它们记录下来。

或者，考虑使用 Springs JDBCTemplate，它可以消除您的大量样板 JDBC 编码并帮助避免此类错误。你不需要 Spring 框架的其余部分来使用这个位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T09:29:00.507

由于准备好的语句中的参数只是 PreparedStatement 对象中的列表或映射，您应该能够检查这些值。

您还可以在 jdbc 驱动程序周围编写一个非常简单的 Wrapper，它创建包装的 PreparedStatements 并在实际执行语句之前记录所有参数和设置。

# windows - 在 Windows 下的网络应用程序中，在哪里存储首选项？

> ID：672646
> 
> 赞同：0
> 
> 时间：2009-03-23T09:13:51.807
> 
> 标签：windows, network-programming, preferences

如果我的目标是我的应用程序应该可以从网络共享运行并且用户的设置应该保持不变，而不管他当时登录的确切机器是什么，我应该在哪里存储首选项和设置？

同样，我应该在哪里存储应用程序范围的设置？

使用的开发环境不是 .Net，但可以编译与 Windows 2000 或更高版本兼容的应用程序（如果相关）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T09:21:01.087

用户个人资料。假设她的个人资料正在漫游，无论她登录到哪里，设置都会跟随用户。

对于应用程序，设置应存储在 Application Data 特殊文件夹中。[您可以使用SHGetSpecialFolderPath](http://msdn.microsoft.com/en-us/library/bb762204(VS.85).aspx)获取此文件夹的路径。有关特殊文件夹的更多信息，请查看 Wikipedia 上的[这篇文章](http://en.wikipedia.org/wiki/Special_Folders)。

当您说“应用程序范围的设置”时，我假设您的意思是所有用户都可以使用的设置。这些可以与应用程序一起存储在网络共享上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T09:21:34.580

在我看来，如果“无论他登录的确切机器如何，用户的设置都应该持续存在”，那么您可以存储设置的唯一位置是“在服务器上”。

具体如何实现是另一回事。如果共享是可写的，那么将配置存储在与应用程序相同的路径/文件夹中的文件中是最简单的方法。如果共享不可写，您将不得不找到另一种方法来执行此操作 - 例如简单的 http Web 应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T10:39:21.633

也许[隔离存储](http://msdn.microsoft.com/en-us/library/3ak841sy(VS.80).aspx)是您正在寻找的（在每个用户设置/文件的情况下）

# infragistics - Infragistics UltraGrid：LoadOnDemand 功能无法正常工作

> ID：672649
> 
> 赞同：0
> 
> 时间：2009-03-23T09:14:56.280
> 
> 标签：infragistics, ultrawingrid

我正在使用 Infragistics Windows Ultragrid，版本 7.3。我正在尝试将 UltraDataSource 与 LoadOnDemand 模式一起使用。我定义了三个频段：根、子和孙子。

当我单击第一行时，它会请求子带的数据，但也会请求第一个子带下的孙子行。

为什么会这样？

我认为除非我单击子带，否则不应要求这些项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T10:58:23.210

有关此问题的更多信息。我发现在设置根带的行号时引发了 UltraDataSource 的 InitializeRowsCollection 事件，即

ultraDataSource1.Rows.SetCount(collection.Count);

在这一点上，我还没有将实际的行添加到根带。为什么它要求子带的项目？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T11:51:14.407

如果我在一切之前为根波段设置波段和数据，那么在我执行 ultraGrid1.DataSource = ultraDataSource1; 之前不会引发 InitializeRowsCollection 事件。

但它再次为儿童和孙子乐队提出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T16:45:25.997

我们通过使用 Ultragrid 的 InitializeRowsCollection 事件而不是 UltraDataSource 的事件来解决这个问题。此事件在预期时触发。

问候。

# git - 重新定位 .git 文件夹

> ID：672655
> 
> 赞同：2
> 
> 时间：2009-03-23T09:17:08.770
> 
> 标签：git

我认为没有一点黑客攻击是不可能的，而只是把它扔在那里。

在 Git 中，是否可以将大部分 .git 文件夹（我假设为 /objects）重新定位到另一个位置。我当前的硬盘驱动器没有被 git 填满时遇到问题，我希望能够将其移动到单独的硬盘驱动器以释放空间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T09:27:49.137

我能想到三种可能：

1.  环境变量告诉 Git在`GIT_DIR`哪里寻找存储库。显然，默认值为`.git`，但`/some/where/else`如果需要，您也可以将其设置为 。
2.  环境变量的`GIT_OBJECT_DIR`作用相同，但仅针对`.git/objects`子目录，而不是整个存储库。
3.  您可以使用文件`.git/objects/info/alternates`或环境变量`$GIT_ALTERNATE_OBJECT_DIRECTORIES`从另一个存储库“借用”对象。

有关详细信息，请参阅[git-repositorylayout(5) 手册页](http://Kernel.Org/pub/software/scm/git/docs/gitrepository-layout.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T22:48:55.207

Git 有一个名为`--git-dir`. 每当您运行 git 时，请使用该`--git-dir`选项。

```
 git --git-dir=a_different_git_directory status 
```

也许你可以把它放在一个批处理文件或其他东西中，让你的生活更轻松。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T09:19:18.580

通常 .git 目录并没有那么大。您最后一次进行垃圾收集是什么时候？

```
git gc 
```

这会清理 git 存储中未引用的对象。

# java - 创建 Java 扩展的最佳工具是什么？

> ID：672667
> 
> 赞同：1
> 
> 时间：2009-03-23T09:21:21.117
> 
> 标签：java, compiler-construction, parsing, lexer

我们的项目组正在开发一个 Java 语言扩展，并且我们一直在试图找出我们应该为此目的使用什么工具。该扩展主要包括对 Java 中使用的并发模型的修改。到目前为止，我们一直在研究两种工具：Polyglot 和 Javacc。Javacc 似乎更易于使用，但由于我们将对语言进行一些重大更改，因此在更高级的 Polyglot 上使用它可能仍然不是一个好主意，因为它可能更好地应对增加的复杂性.

您对这些工具有任何经验和/或您有其他工具推荐吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T11:30:46.983

检查[Jetbrain 的 MPS](http://www.jetbrains.com/mps/index.html)，但到目前为止我还没有经验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T09:36:25.387

[ANTLR](http://www.antlr.org)是一个非常好的选择。它比 JavaCC 活跃一点，文档更好。亚马逊上有一本书，你会发现它很有帮助。

# java - Java WebDAV 客户端库

> ID：672678
> 
> 赞同：25
> 
> 时间：2009-03-23T09:27:08.140
> 
> 标签：java, client-side, webdav

您可以推荐什么 Java WebDAV 客户端库？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-01-19T06:32:24.237

我最近创建了一个非常易于使用的：

[https://github.com/lookfirst/sardine](https://github.com/lookfirst/sardine)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-23T10:29:45.727

你看过[Jackrabbit 的](https://jackrabbit.apache.org/jcr/components/jackrabbit-webdav-library.html)吗？

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-07-21T21:54:14.310

好的，我有点晚了，但你真的应该看看[milton webdav 服务器](http://milton.io/)项目。它的开源（apache2），成熟并且被积极维护。

它旨在允许任何后端实现连接到 webdav，许多用户报告在 4 小时内为现有应用程序实现它。

它支持所有常见的 webdav 东西，如锁定、自定义属性、摘要/基本身份验证等。它还支持 caldav 并与 apache FTP 集成，因此您只需花费一个价格即可获得 2 个协议！

Milton 附带一个 servlet 和一个 spring 控制器，它可以独立于 Web 容器运行。

Milton 还有一个不错的小型 webdav 客户端库，由于它的观察者支持，它非常​​适合桌面应用程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-23T10:46:05.483

**我将Jakarta Slide**项目提供的客户端库用于我大约 2 年前开发的软件，它运行良好。现在，访问该[站点](http://jakarta.apache.org/slide/)，我发现该项目由于缺乏开发人员而不再活跃。但是客户端库对您来说仍然是一个不错的选择。无论如何，我没有看到很多替代品。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-15T10:19:41.973

尝试在这里尊重他们：[http ://www.webdavsystem.com/javaserver](http://www.webdavsystem.com/javaserver)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-28T09:16:24.413

你检查过沙丁鱼吗？

[https://code.google.com/p/sardine/](https://code.google.com/p/sardine/)

[https://github.com/lookfirst/sardine](https://github.com/lookfirst/sardine)

最新版本 5.3 - 2013 年 8 月，可在 Maven 中心获得：

[https://mvnrepository.com/artifact/com.github.lookfirst/sardine/5.3](https://mvnrepository.com/artifact/com.github.lookfirst/sardine/5.3)

# winforms - WinForms 中的 UI 设计概念

> ID：672682
> 
> 赞同：0
> 
> 时间：2009-03-23T09:28:23.283
> 
> 标签：winforms

在某种情况下，我想禁用选项卡面板，以便禁用选项卡面板中的控件。

我想禁用选项卡面板，但我仍然想启用选项卡面板中的控件。需要的是用户不能在某个情况下切换到另一个选项卡面板。

我该怎么做这个要求？

通过 dinesh

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T17:27:13.133

使用标签面板以外的东西。

选项卡面板“卡住”一个选项卡以使用户无法移动到其他选项卡不是标准行为。如果你这样做，你会甩掉用户。

你所追求的听起来像是一个模态对话框。听起来您不希望用户在输入某些数据或类似数据之前离开某个屏幕。模态对话框就是为此目的而构建的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T09:37:13.997

没有直接的方法来禁用标签页，只有您可以将其删除。但是在您的情况下，您无法删除 Tab，因此我认为您需要在 Tab_SelectionIndex 更改事件中添加一些代码。当 Tab 索引出现时，将其设置回另一个索引。

试试这个代码

```
private void tabControl1_SelectedIndexChanged(object sender, EventArgs e)
{
if (tabControl1.SelectedIndex == 1)
{
tabControl1.SelectedIndex = -1;
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T09:42:15.217

除了 anuraj 的回答，将选项卡文本的颜色设置为禁用文本颜色状态，因此它是“禁用”的视觉提示。

# iphone - 如何通过触摸该图像来旋转箭头图像？

> ID：672684
> 
> 赞同：2
> 
> 时间：2009-03-23T09:29:14.327
> 
> 标签：iphone, cocos2d-iphone

我正在做一个项目，我需要通过触摸来旋转图像。

根据用户触摸它的方式，它可以更快或更慢地旋转。

你能告诉我一些教程或如何做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T13:14:54.770

将您的图像放在 UIImageView 中，然后将该视图子类化并替换 touchesBegan:withEvent: 或为其设置委托并实现与委托方法相同的方法。这将使您能够响应触摸事件（在这种情况下是触摸的开始，尽管您可以为结束触摸或移动手指做同样的事情）。

在这种触摸处理方法中，您可以实现类似于我[在此处](https://stackoverflow.com/questions/486609/how-can-i-use-animation-in-cocos2d/493680#493680)描述的内容，以便以给定的速度执行 UIImageView 的启用 Core-Animation 的旋转。要更改速度，请更改我提供的动画的持续时间属性。正如我在那里建议的那样，您可能希望查看 CAKeyframeAnimation 以在开始和结束时使用加速和减速来制作更平滑的动画。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T22:09:39.873

一种更简单的方法是设置一个 NStimer 并在每次触发时旋转变换。

我在这里有一些示例代码巧合地做了类似的事情：

[http://github.com/kailoa/touchsamplecode/tree/master](http://github.com/kailoa/touchsamplecode/tree/master)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T00:22:38.260

使用 Cocos2d，你不能有“启用触摸”的精灵，“isTouchEnabled”是在图层级别。您必须在层级接收触摸，然后检查触摸的位置与可触摸精灵的位置。CGRect* 函数包括一个“矩形包含点”，您可以将触摸位置传递给它，使用精灵的矩形来查看它是否被“触摸”，然后您可以说 [sprite runAction:[Rotate .... ]]

# design-patterns - 何时在类名中包含设计模式名称？

> ID：672690
> 
> 赞同：19
> 
> 时间：2009-03-23T09:32:56.283
> 
> 标签：design-patterns

在我的上一个项目中，我注意到在类名中包含设计模式名称非常方便。例如：

*   ContextLazyFactory
*   RunOnce 调解器
*   第三方调解员
*   MyProjectCliFacade
*   二进制门

它使项目易于阅读。额外的好处是您不会使用自己的名称，例如“RunOnceManager”、“ContextDelayedConstruction”、“ThirdPartyInterface”等，这些名称可能仅对作者具有尖锐的意义。另一方面，我不希望在 STL 中看到像 vector_container 这样的类。你怎么想？

我目前对这个主题的看法是：作为类层次结构中重要节点的类应该在其名称中包含其设计模式，以强调层次结构并使项目更易于阅读。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-23T09:37:55.523

在许多情况下，这对我来说似乎很自然：

*   命名设计模式以解释它们的作用
*   类被命名以解释它们的作用

当用设计模式术语来解释一个类的目的时，为什么不使用它呢？

另一方面，当设计模式大多是*偶然*的，则排除它。例如，一个类可能恰好是一个单例，但这不是它在生活中的主要目的，所以我不希望在名称中看到“单例”。将其与主要目的是成为其他对象的工厂的工厂进行比较 - “FooFactory”非常有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T09:38:44.787

我同意你的看法。我唯一要添加的（不用说真的）是确保类名中的模式名称确实使用了实际使用的模式。

我曾经看到一个名为 XxxxFactory 的类（或类似的东西），它与工厂模式一点也不相似！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T09:38:49.140

我还在类名中使用设计模式名称来增加可读性并使其他人易于理解。

Vectors 对我来说已经是一个集合，所以不需要 _collection。顺便说一句，容器不是设计模式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T09:39:01.013

如果生成的名称足够清晰，请继续使用它。

但在某些情况下，生成的名称要么笨拙，要么含糊不清。在这种情况下，请使用最合适的名称。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T09:45:34.570

我认为在名称中使用设计模式是个**好**主意。例如，在我的一款游戏中，我有：

```
GameLevelAbstract
InGameArea
MainMenu 
```

后两个类（InGameArea 和 MainMenu）子类 GameLevelAbstract 并实现它的纯虚方法。我可以在我的源视图中看到该类是抽象的，并且立即知道它是或不是我正在寻找的。

另一个例子是我的图形外观：

```
GraphicsFacade
OpenGLGraphics
DirectXGraphics 
```

与我上面的设置完全相同，只是它处理图形。

当我寻找课程时，我发现在名称中使用设计模式非常有用且信息丰富。我确实认为某些东西不应该在名称中使用，例如 Singleton，但是 Flyweight、Factory 或 Facade 是我认为非常适合实现这些模式的类的名称的设计名称示例。

我认为如果你使用好的类名来帮助程序员一目了然地掌握你的类的功能是一件好事。

在大多数情况下，我认为陈述某事是数据结构或算法并不是一件好事。“LinkedListDataStructure”或“BubbleSortAlgorithm”不会增加程序员对类的理解，因为“LinkedList”在它的功能上是显而易见的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-07T09:22:17.593

至少有一个缺点：如果由于某种原因类在重构后不使用该模式，则必须重命名它或使用错误名称的类。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-18T08:37:31.130

将设计模式名称添加为类名真的很好。这使代码更容易理解。类名应该是有意义的，并且应该反映类的功能。当在类名中添加模式名称时，它增加了可读性，因为它也反映了用于设计类的技术。我更喜欢这种类型的类名。

# windows - “以管理员身份运行”时的 Windows 批处理文件起始目录

> ID：672693
> 
> 赞同：92
> 
> 时间：2009-03-23T09:35:01.817
> 
> 标签：windows, windows-vista, batch-file, directory, uac

我有一个位于目录中的批处理文件，也必须从那里运行，因为它更新了该目录中的文件。
这工作得很好，除非用户以管理员身份运行批处理文件（Vista 需要）。那么起始目录是C:\Windows\System32。

有没有办法仍然能够知道批处理文件是从哪个目录运行的？
我不希望用户手动输入目录。

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2009-03-23T09:42:36.027

尝试像这样访问批处理文件路径：

```
echo %~dp0 
```

`for /?`有关更多信息，请参阅描述上述命令如何工作的命令中的以下引用：

```
您现在可以使用以下可选语法：

    %~I - 扩展 %I 删除任何周围的引号 (")
    %~fI - 将 %I 扩展为完全限定的路径名
    %~dI - 仅将 %I 扩展为驱动器号
    %~pI - 仅将 %I 扩展为路径
    %~nI - 仅将 %I 扩展为文件名
    %~xI - 仅将 %I 扩展为文件扩展名
    %~sI - 扩展路径仅包含短名称
    %~aI - 将 %I 扩展为文件的文件属性
    %~tI - 将 %I 扩展到文件的日期/时间
    %~zI - 将 %I 扩展为文件大小
    %~$PATH:I - 搜索 PATH 中列出的目录
                   环境变量并将 %I 扩展到
                   找到的第一个名称的完全限定名称。
                   如果环境变量名不是
                   已定义或文件未找到
                   搜索，然后这个修饰符扩展为
                   空字符串

可以组合修饰符以获得复合结果：

    %~dpI - 仅将 %I 扩展为驱动器号和路径
    %~nxI - 仅将 %I 扩展为文件名和扩展名
    %~fsI - 将 %I 扩展为仅包含短名称的完整路径名
    %~dp$PATH:I - 搜索 PATH 中列出的目录
                   %I 的环境变量并扩展为
                   找到的第一个驱动器号和路径。
    %~ftzaI - 将 %I 扩展为类似 DIR 的输出线

```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2011-02-08T12:59:44.403

比`cd`哪个`pushd`更好

*   如果从开始更改驱动器号`D:\...`
*   如果在 UNC 网络路径上，则分配驱动器号

所以`pushd %~dp0`很好。

好的做法是在完成后打电话`popd`。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2015-05-15T10:13:22.510

这应该通过将批处理文件的工作目录设置回当前目录来解决您的问题：

在 .bat 脚本的顶部包含这两行：

```
@setlocal enableextensions
@cd /d "%~dp0" 
```

位于：http: [//www.codeproject.com/Tips/119828/Running-a-bat-file-as-administrator-Correcting-cur](http://www.codeproject.com/Tips/119828/Running-a-bat-file-as-administrator-Correcting-cur)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-06-22T11:39:20.910

要解决此问题，请在 .bat 脚本的顶部包含以下两行：

```
@setlocal enableextensions
@cd /d "%~dp0" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T18:55:33.427

我用：

光盘 %0..

在批处理文件的开头将目录更改为启动批处理文件的目录。

-马修

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-02-01T07:02:31.310

@setlocal 启用扩展

@cd /d "%~dp0"

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-20T18:46:25.567

您可以通过添加父文件名直接从文件名 CD（未在 Windows 8.x 中测试，但据我所知，“永远”工作）。

```
CD %FILENAME%\.. 
```

并且 CD 也将使用 /D 更改驱动器，如上所示，但未明确提及，因此可能会被遗漏。CD /D %FILENAME%\..

（如果您使用 cmd.exe，FOR /?IF /?SET /?CALL /?GOTO /? 都提供非常有用的阅读，我会不时重读它们。）

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-10-25T12:29:59.090

这里的工作解决方案：

[http://www.vistax64.com/vista-general/79849-run-administrator-changes-default-directory.html](http://www.vistax64.com/vista-general/79849-run-administrator-changes-default-directory.html)

FOR /F %%I IN ("%0") DO SET BATDIR=%%~dpI

ECHO 批处理文件位于目录 %BATDIR%

# java - 懒惰地实例化一个 final 字段

> ID：672696
> 
> 赞同：2
> 
> 时间：2009-03-23T09:35:43.780
> 
> 标签：java, final

是否可以懒惰地实例化最终字段？

以下代码无法编译：

```
public class Test{
    private final Connection conn;

    public Connection getConnection(){
        if(conn==null){
            conn = new Connection();
        }
        return conn;
    }
} 
```

有替代方案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T09:38:47.673

不，final 字段的意义在于它在构造过程中设置一次，之后将永远不会更改。编译器或虚拟机如何知道对`conn`您的情况有用的任何信息？它怎么知道只有那个属性才能设置它，而不是其他方法？

也许如果你解释了你想要的语义是什么，我们可以想出一个替代方案。您可能有一个“提供者”接口，代表一种获取值的方式，然后是`MemoizingProvider`另一个提供者的代理，但只有一次，否则缓存该值。那也无法为缓存值提供最终字段，但至少它只会在一个地方。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T16:01:45.867

这是使用 Memoisation（带有 Callables）的一种方法：

课堂备忘录：

```
public class Memo<T> {
    private T result;
    private final Callable<T> callable;

    private boolean established;

    public Memo(final Callable<T> callable) {
        this.callable = callable;
    }

    public T get() {
        if (!established) {
            try {
                result = callable.call();
                established = true;
            }
            catch (Exception e) {
                throw new RuntimeException("Failed to get value of memo", e);
            }
        }
        return result;
    }
} 
```

现在我们可以创建一个最终的连接！

```
private final Memo<Connection> conn = new Memo<Connection>(
    new Callable<Connection>() {
    public Connection call() throws Exception {
        return new Connection();
    }
});

public Connection getConnection() {
    return conn.get();
} 
```

[来源](http://fahdshariff.blogspot.com/2011/05/lazily-instantiate-final-field.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T14:45:48.153

dhiller 的回答是经典的双重检查锁定错误，*不要使用。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T12:33:49.343

正如 Jon Skeet 所说，不，没有。

解释您的代码示例，您可能想要执行以下操作：

```
public class Test{
    private final Object mutex = new Object(); // No public locking
    private Connection conn;

    public Connection getConnection(){
        if(conn==null){
            synchronized (mutex) {
                if(conn==null){
                    conn = new Connection();
                }
            }
        }
        return conn;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T14:44:58.360

作为旁注，可以更改最终字段。至少实例字段。你只需要一些反思：

```
import java.lang.reflect.Field;

public class LazyFinalField {

  private final String finalField = null;   

  public static void main(String[] args) throws Exception {
    LazyFinalField o = new LazyFinalField();
    System.out.println("Original Value = " + o.finalField);
    Field finalField = LazyFinalField.class.getDeclaredField("finalField");
    finalField.setAccessible(true);
    finalField.set(o, "Hello World");   
    System.out.println("New Value = " + o.finalField);   
  }
}

Original Value = null
New Value = Hello World 
```

# javascript - 通过javascript进入数据库

> ID：672697
> 
> 赞同：0
> 
> 时间：2009-03-23T09:36:12.173
> 
> 标签：javascript, database, client-side

我需要知道我可以通过javascript连接数据库吗？实际上，我结束的最后一个动作是通过 javacsript 完成的。现在，我需要在最后一个操作停止的数据库中创建一些条目（通过 javascript 提取）。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T09:41:05.187

答案取决于运行 Javascript 的位置。

如果您询问在浏览器中运行的 Javascript 是否直接访问远程服务器上的数据库，那么答案是否定的。`XMLHTTPRequest`您可以做的最好的事情是创建一个 Web 服务来更新数据库并通过JavaScript 中的对象调用它。您需要非常小心通过此类 Web 服务提供的内容。如果您允许任何 SQL 语句，任何人都可以连接到您的服务并运行`DELETE FROM customer;`或插入新的用户记录或做任何可怕的事情。

如果您通过 CSCRIPT.EXE 或类似方式通过 Windows 脚本主机运行 JavaScript，您可以创建 ODBC 对象并以这种方式访问​​数据库。

如果您在 JVM 上运行 JavaScript，我认为您可以使用 JDBC。

如果您想提供更多详细信息，我可以更具体。

# c++ - 将 const 引用传递给原始类型有什么用？

> ID：672700
> 
> 赞同：16
> 
> 时间：2009-03-23T09:36:53.200
> 
> 标签：c++, reference, constants, primitive

在我维护的一个项目中，我看到很多这样的简单`get`/`set`方法代码

```
const int & MyClass::getFoo() { return m_foo; }

void MyClass::setFoo(const int & foo) { m_foo = foo; } 
```

这样做而不是以下有什么意义？

```
int MyClass::getFoo() { return m_foo; }  // Removed 'const' and '&' 

void MyClass::setFoo(const int foo) { m_foo = foo; }  // Removed '&' 
```

传递对原始类型的引用应该需要与传递类型的值本身相同（或更多）的工作，对吧？
毕竟这只是一个数字......
这只是一些尝试的微优化还是有真正的好处？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-23T09:46:39.950

不同之处在于，如果您自己将该结果放入引用中，您可以在您自己的变量名中跟踪整数成员变量的更改，而无需调用该函数。

```
const &int x = myObject.getFoo();
cout<<x<<endl;
//...
cout<<x<<endl;//x might have changed 
```

这可能不是最好的设计选择，并且返回引用（无论是否为 const）非常危险，以防返回从范围中释放的变量。因此，如果您返回一个引用，请注意确保它不是超出范围的变量。

修饰符也有细微的差别，但同样可能不是值得做的事情或本来打算做的事情。

```
void test1(int x)
{
  cout<<x<<endl;//prints 1
}

void test2(const int &x)
{
  cout<<x<<endl;//prints 1 or something else possibly, another thread could have changed x
}

int main(int argc, char**argv)
{
  int x = 1;
  test1(x);
  //...
  test2(x);
  return 0;
} 
```

所以最终的结果是，即使在参数传递之后，您也可以获得更改。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-23T15:25:57.607

对我来说，为原语传递*const 引用*是一个错误。要么你需要修改这个值，在这种情况下你传递一个*非常量引用*，或者你只需​​要访问这个值，在这种情况下你传递一个*const*。

*const 引用*应该只用于复杂的类，因为复制对象可能是一个性能问题。在原语的情况下，除非您需要修改变量的值，否则不应传递*引用*。原因是引用比*非**引用*花费更多的计算时间，因为使用*引用*，程序需要在表中查找对象的*地址*。当此查找时间短于复制时间时，引用是一种改进。

 ***通常，*整数*和*地址*在低级实现中具有相同的字节长度。所以复制一个*int*作为一个函数的返回值的时间就相当于复制一个*地址*的时间。*但是在返回int*的情况下，不会执行查找，因此会提高性能。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-23T09:40:35.970

返回值和返回 const 引用之间的主要区别在于，您可以 const_cast 该引用并更改该值。

这是一个糟糕设计的例子，也是试图创造一个简单而简洁的设计就绰绰有余的智能设计的尝试。作者不只是返回一个值，而是让代码读者思考他可能有什么意图。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-23T14:44:28.627

没有太大的好处。我以前在框架或宏生成的 getter 和 setter 中看到过这一点。宏代码没有区分原始类型和非 POD 类型，只是`const type&`全面用于设置器。我怀疑这是效率问题还是真正的误解；很可能这是一个一致性问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-23T09:48:03.220

我认为这种类型的代码是误解了引用的概念并将其用于包括原始数据类型在内的所有内容的人编写的。我也看过一些这样的代码，看不出这样做有什么好处。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T09:55:00.583

没有任何意义和好处，除了

```
void MyClass::setFoo(const int foo)
void MyClass::setFoo(const int& foo) 
```

那样你将无法在“setFoo”实现中重用“foo”变量。我相信 'int&' 只是因为 Guy 习惯于通过 const 引用传递所有东西，这并没有错。

# sql - 如何删除 MySQL 表中的重复项

> ID：672702
> 
> 赞同：7
> 
> 时间：2009-03-23T09:37:17.350
> 
> 标签：sql, mysql, database

我已向客户提供以下查询以删除重复的电话号码。MSSQL 数据库中的记录，但现在他们还需要在 MySQL 上执行此操作，并且他们报告说 MySQL 抱怨查询的格式。我已经为我的代码示例设置了一个带有重复项的测试表，但实际的删除查询才是最重要的。

我在无知和紧迫的情况下问这个问题，因为我仍在忙于下载和安装 MySQL，也许有人可以在此期间提供帮助。

```
 create table bkPhone
 (
     phoneNo nvarchar(20),
     firstName nvarchar(20),
     lastName nvarchar(20)
 )
 GO

 insert bkPhone values('0783313780','Brady','Kelly')
 insert bkPhone values('0845319792','Mark','Smith')
 insert bkPhone values('0834976958','Bill','Jones')
 insert bkPhone values('0845319792','Mark','Smith')
 insert bkPhone values('0828329792','Mickey','Mouse')
 insert bkPhone values('0834976958','Bill','Jones')

 alter table bkPhone add phoneId int identity

 delete from bkPhone
 where phoneId not in
 (
     select min(phoneId)
     from bkPhone
     group by phoneNo,firstName,lastName
     having  count(*) >= 1
 ) 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-29T01:50:59.483

许多方式导致罗马。这是一。它非常快。因此，您可以将它与大型数据库一起使用。不要忘记不雅。诀窍是：使 phoneNo 唯一并使用“忽略”。

```
drop table if exists bkPhone_template;
create table bkPhone_template (
         phoneNo varchar(20),
         firstName varchar(20),
         lastName varchar(20)
 );

insert into bkPhone_template values('0783313780','Brady','Kelly');
 insert into bkPhone_template values('0845319792','Mark','Smith');
 insert into bkPhone_template values('0834976958','Bill','Jones');
 insert into bkPhone_template values('0845319792','Mark','Smith');
 insert into bkPhone_template values('0828329792','Mickey','Mouse');
 insert into bkPhone_template values('0834976958','Bill','Jones');

drop table if exists bkPhone;
create table bkPhone like bkPhone_template;
alter table bkPhone add unique (phoneNo);

insert  ignore into bkPhone (phoneNo,firstName,lastName) select phoneNo,firstName,lastName from bkPhone_template;

drop table bkPhone_template; 
```

如果数据表已经存在，那么您只需要使用以下插入忽略选择运行创建表选择。最后，您必须运行一些表重命名语句。就这样。

这种解决方法比删除操作要快得多。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-23T09:42:32.750

您可以通过以下方式选择独特的：

```
select distinct(phoneNo) from bkPhone 
```

并将它们放入另一个表中，删除旧表并将新表重命名为旧名称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T10:28:29.660

MySQL 抱怨，因为它没有任何意义。您尝试使用`min()`您分组的列进行聚合。

现在，如果您尝试删除同一个人的重复电话号码，SQL 应该是：

```
delete from bkPhone
 where phoneId not in
 (
         select min(phoneId)
         from bkPhone
         group by firstName,lastName /* i.e. grouping by person and NOT grouping by phoneId */
         having  count(*) >= 1
 ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T09:42:21.130

Mysql还包括：

[http://mssql-to-postgresql.blogspot.com/2007/12/deleting-duplicates-in-postgresql-ms.html](http://mssql-to-postgresql.blogspot.com/2007/12/deleting-duplicates-in-postgresql-ms.html)

# java - 在哪里可以找到读取 vcard 文件的 java 库？

> ID：672704
> 
> 赞同：12
> 
> 时间：2009-03-23T09:38:11.903
> 
> 标签：java, vcf-vcard

我需要一个 java 库来读取 vcard 文件 (vcf)。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-25T19:12:34.343

[ez-vcard](https://github.com/mangstadt/ez-vcard)支持 vCard 标准的 2.1、3.0 和 4.0 版本，以及 XML 编码的 vCard（“xCard”标准）、HTML 编码的 vCard（“hCard”微格式）和 JSON 编码的 vCard（“jCard”标准）。

[https://github.com/mangstadt/ez-vcard](https://github.com/mangstadt/ez-vcard)

要读取 vCard 文件，请使用该`Ezvcard.parse()`方法。然后，在返回的对象上调用各种 getter 方法`VCard`来检索 vCard 数据字段。

```
File file = new File("my-vcard.vcf");
VCard vcard = Ezvcard.parse(file).first();
System.out.println("Name: " + vcard.getFormattedName().getValue());
System.out.println("Email: " + vcard.getEmails().get(0).getValue()); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-23T09:43:56.273

[搜索 Java 和 vcard](http://www.google.com/search?q=java+vcard)会产生很多结果。

特别是[Mime-Dir-j](http://sourceforge.net/projects/mime-dir-j/)不再处于积极开发中，但可能是您所需要的，而[vcard4j](http://sourceforge.net/projects/vcard4j)似乎已经休眠了更长时间（2003 年最新版本！）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-03-15T14:47:10.240

[Cardme](http://sourceforge.net/projects/cardme)似乎是最好的 vcard 库，开发活跃，甚至还有一个 wiki 站点。

检查项目[主页](https://github.com/george-haddad/cardme)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-09-14T15:48:51.957

还没有使用它（即将试用），但这看起来很有希望。

[http://code.google.com/p/android-vcard/](http://code.google.com/p/android-vcard/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-16T12:18:23.257

[http://wiki.modularity.net.au/ical4j/index.php?title=VCard](http://wiki.modularity.net.au/ical4j/index.php?title=VCard)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T09:42:47.587

我发现这个 API 可以解决问题：http: [//sourceforge.net/projects/mime-dir-j/](http://sourceforge.net/projects/mime-dir-j/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T09:42:52.877

试试谷歌、雅虎等，然后找到[http://vcard4j.sourceforge.net/](http://vcard4j.sourceforge.net/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-23T11:05:55.017

好吧，以防万一您想使用手机，JSR75 开箱即用：

javax.microedition.pim.PIM.fromSerialFormat 被指定为支持 vCard 3.0

# c# - 新打开的 Windows 窗体 C# 的 TabPages

> ID：672710
> 
> 赞同：2
> 
> 时间：2009-03-23T09:40:05.987
> 
> 标签：c#, winforms

我想为每个新打开的表单添加一个新的标签页。

例子：

```
frmReport reportform = new frmReport();
report.Show(); 
```

当我打开`frmReport`表单时，它必须在新的 中打开`TabPage`，就像在 Windows Internet Explorer 7-8 标签页中一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T10:00:22.083

您希望在这里实现的是“标签页内的窗口”。这不应该是这样！它看起来像这样：

*   视窗操作系统
*   应用程序的窗口（Window 类）
*   放置在 Window 上的容器（例如：Panel、TabControl！）
*   放置在 Windows 和容器上的控件（例如：Button，还有像 Panel 这样的容器！）

因此，当您查看此内容时，您会发现将 Windows 类放入 TabControl 是不合适的！

那么该怎么办？

例如，创建 UserControl 类并将所有控件从 Window 移动到这个新的 UserControl。下一个放置在您的 Window TabControl 上，然后在其中一个 TabPages 上放置这个新创建的 UserControl。

通过这种方式，您将拥有一个设计良好的 UI。再一次：你没有把 Window 放在你的 TabPage 上！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-23T06:20:21.270

事实上你可以添加`Windows.Forms`到`TabPages`你只需要做设置

```
Form.TopLevel = false 
```

你可以将它添加到任何容器`TabPage`中`Panel`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T09:43:37.070

抱歉，没有直接的方法可以做到这一点。最好使用用户控件而不是表单并将控件添加到选项卡页。

请参阅[此链接](http://k-mug.org/forums/p/360/1200.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-02T20:45:07.490

我将 DevExpress 控件用于 tabPages。

# sql - 规范化（SQL 视图）和性能/可靠性（SQL 表）之间的权衡在哪里

> ID：672713
> 
> 赞同：3
> 
> 时间：2009-03-23T09:40:36.360
> 
> 标签：sql, database-design

我有一个相当长的业务流程，最终导致财务运营。

最终重要的是这些最终操作，尽管我必须记录导致它的所有内容。

由于最终操作中包含的所有信息都在其他表中可用（在业务过程中使用），因此使用视图是有意义的，但视图逻辑会相当复杂（涉及数十个表），而且我'我担心：

1.  即使有适当的索引，一个表可能会更快（我的表最终将包含数百万个 if 项，并且应该可以在几乎所有列上完全搜索）

2.  视图逻辑会很复杂，所以如果我想发展我的业务逻辑，恐怕几年后它可能会使事情复杂化。

由于这两个原因，我有点想在业务流程结束时将数据写入表中，而不是依赖于视图，但是复制数据听起来不太对劲（而且看起来也有点像过早的优化，但由于它是我设计的中心点，我想尽快解决这个问题）

你有没有遇到过这样的选择？你做了什么决定？

**编辑：**在我的情况下，创建一个表显然会导致重复，即。写入表中的数据存在于数据库中的其他位置，并且可以仅使用连接来检索而无需任何计算。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T09:51:19.283

我想你回答了你的问题，把它写下来。

这个问题可以这样看：一方面你有“实时数据”。你有新鲜的数据，从他们那里创建视图来显示“实时数据”也很好。

但随着时间的推移，会有更多的数据和逻辑变化。因此，最好记下您前段时间拥有的数据摘要。这是非常实用的——您不会重复数据，因为您会重新计算它们并保存到它们的新表摘要中。

所以当你这样想的时候，很明显在这个例子中新表会更好。当你写：

*   更快的访问
*   可以有更复杂的逻辑
*   逻辑改变时保持归档数据不变

因此，当您满足此（或部分）标准时，您需要而不是选择 - 您进入表格。

只有在从其他新数据中显示新数据时，我才会使用视图。在非常非常简单的问题中。当它变得更复杂时 - 你总是切换到新表。

所以不要害怕进入它。拥有一个访问速度更快的汇总表是非常漂亮的解决方案，它是格式良好的数据库的标志。

注意这张表的设计——所以当业务逻辑发生变化时——你不需要改变这张表中的一块石头。然后一切都会好起来的！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T10:21:24.640

在这种情况下，我支持新表。该视图有许多缺点 - 性能明显、复杂性和逻辑锁定。但是，恕我直言，最重要的原因是随着基础数据的变化，视图中的值也会发生变化。在大多数情况下，这是一件好事，但是，对于财务操作来说，对所发生的事情进行固定记录不是更好吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T13:39:49.577

As MrTelly alluded to, are you sure that your end result table really is a duplication of the view data? Or, is it actually a record of the final action taken as a result of the items in the view data.

For a clearer example, let's say that every time my gas tank gets to half-empty I buy $10 of gas. I write this down in a log. One day I buy my gas and write it in my log then later find out that my fuel gauge was broken and I really had 3/4 a tank of gas. Should I now erase the $10 purchase from my log because the underlying data (the level of gas in my tank) has changed? Ok, maybe that's not a **clearer** example, but hopefully it gets the point across. Recording the results is a different thing from recording the events that led up to the result. This is especially true in financial application. Therefore, I don't know that you're breaking normalization at all with storing the final outcome in its own table.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-02T20:58:27.150

**索引视图**是一种方式。但是这种方法有很多限制，但它通常是有利的，尽管如果实施不正确会产生一些开销问题。使用这种方法，您无需跟踪基表中发生的更改，并且数据会在您的索引视图中很好地累积。理论上。

参考：

*   [使用 SQL Server 2005 索引视图提高性能](http://technet.microsoft.com/en-us/library/cc917715.aspx)
*   Oracle：物化视图概念和架构

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T09:52:03.383

我总是决定进行更好的标准化。在您的情况下，虽然视图可能很复杂，但最好拥有它而不是必须与所有数据更改操作保持同步的新表。另外，当您的工作日结束时，视图将始终是最新的每天只有几个小时的电流。

此外，如果此表中的数据由于某种原因不同步，您将遇到更大的问题。

# sql-server - 如何对 SQL Server 数据库进行版本控制？

> ID：672716
> 
> 赞同：18
> 
> 时间：2009-03-23T09:41:11.757
> 
> 标签：sql-server, database, version-control

我有 SQL Server 数据库并在其中进行更改。一些数据库表的记录是我的应用程序运行所需的起始记录。我想对数据库和这些记录（行）进行版本控制。是否可以这样做并将其捆绑到我的源代码的 SVN 版本控制中，或者是否有其他解决方案？我希望完成此操作以便能够返回到以前版本的数据库并比较数据库修订版之间的更改。如果这方面的工具是免费的、开源的或者不是很贵，那就太好了。

我的环境是 Visual C# Express、SQL Server 2008 Express 和 Tortoise SVN。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-03-09T10:59:11.917

迟到的答案，但希望对其他读者有用

我可以建议使用名为 ApexSQL Source Control 的 SSMS 插件。通过使用此插件，开发人员可以通过向导直接从 SSMS 轻松地将数据库对象与源代码控制系统映射。它包括对 Git、TFS、Mercurial、Subversion、TFS（包括 Visual Studio Online）和其他源代码控制系统的支持。它还包括对源控制静态数据的支持（因此您也可以版本控制记录）。

下载并安装 ApexSQL Source Control 后，只需右键单击要进行版本控制的数据库并导航到 SSMS 中的 ApexSQL Source Control 子菜单。点击“Link database to source control”选项，选择源代码控制系统和数据库开发模式，例如：

[![在此处输入图像描述](https://i.stack.imgur.com/ZY1r7.png)](https://i.stack.imgur.com/ZY1r7.png)

之后，您可以排除不想链接到源代码管理的对象。可以按所有者或类型排除特定对象。

在下一步中，将提示您提供源代码控制管理系统的登录信息：

[![在此处输入图像描述](https://i.stack.imgur.com/eMoMl.png)](https://i.stack.imgur.com/eMoMl.png)

完成后，只需单击“完成”按钮，将显示“操作中心”窗口，提供将提交到存储库的对象（这是默认情况下，如果存储库为空）。

将数据库链接到源代码管理后，可以从源代码管理客户端执行的所有操作都将在“对象资源管理器”窗格中可用。其中包括：

*   在有或没有锁定版本化对象的情况下签出，
*   查看该对象的历史并应用特定的修订，
*   查看对该对象所做的更改和
*   使用“链接静态数据”将数据从表放置到源代码管理</li>

您可以阅读本文了解更多信息：http: [//solutioncenter.apexsql.com/sql-source-control-reduce-database-development-time/](http://solutioncenter.apexsql.com/sql-source-control-reduce-database-development-time/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T09:54:16.093

我们刚刚开始在我们的一些项目中执行以下操作，并且它似乎工作得很好，用于填充“静态”表。

我们的脚本遵循构建临时表的模式，然后填充我们希望真实表类似于的内容。我们只在这里放置人类可读的值（即我们不包括 IDENTITY/GUID 列）。脚本的其余部分获取临时表并执行适当的 INSERT/UPDATE/DELETE 语句以使真实表类似于临时表。当我们必须改变这个“静态”数据时，我们只需要更新临时表的数量。这意味着版本之间的差异可以按预期工作，并且回滚脚本就像从源代码管理中获取以前的版本一样简单。

INSERT/UPDATE/DELETE 只需写入一次。事实上，我们的脚本稍微复杂一些，并且在实际的 DML 语句之前运行了两组验证。一组验证临时表数据（即我们不会通过尝试使数据库类似于临时表来违反任何约束）。另一个验证临时表和目标数据库（即外键可用）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-28T23:29:21.810

SQL Source Control 2.0 中添加了静态数据支持，目前在测试版中可用。更多关于如何尝试的信息可以在这里找到：

[http://www.red-gate.com/messageboard/viewtopic.php?t=12298](http://www.red-gate.com/messageboard/viewtopic.php?t=12298)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T09:59:12.383

有一个名为[Database Publishing Wizard](http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en)的免费 Microsoft 产品，您可以使用它来编写整个数据库（模式和数据）的脚本。它非常适合拍摄数据库当前状态的快照，并且可以让您随时从头开始重新创建

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T10:32:39.057

对于数据库（模式）版本控制，我们使用自定义属性，这些属性在安装程序运行时添加到数据库中。这些脚本的内容是使用我们的构建脚本生成的。

设置属性的脚本如下所示：

```
DECLARE @AssemblyDescription sysname
SET @AssemblyDescription = N'DailyBuild_20090322.1'

DECLARE @AssemblyFileVersion sysname
SET @AssemblyFileVersion = N'0.9.3368.58294'

-- The extended properties DatabaseDescription and DatabaseFileVersion contain the
-- AssemblyDescription and AssemblyFileVersion of the build that was used for the
-- database script that creates the database structure.
-- 
-- The current value of these properties can be displayed with the following query:
-- SELECT * FROM sys.extended_properties

IF EXISTS (SELECT * FROM sys.extended_properties WHERE class_desc = 'DATABASE' AND name = N'DatabaseDescription')
BEGIN
    EXEC sys.sp_updateextendedproperty @name = N'DatabaseDescription', @value = @AssemblyDescription
END
ELSE
BEGIN
    EXEC sys.sp_addextendedproperty @name = N'DatabaseDescription', @value = @AssemblyDescription
END

IF EXISTS (SELECT * FROM sys.extended_properties WHERE class_desc = 'DATABASE' AND name = N'DatabaseFileVersion')
BEGIN
    EXEC sys.sp_updateextendedproperty @name = N'DatabaseFileVersion', @value = @AssemblyFileVersion
END
ELSE
BEGIN
    EXEC sys.sp_addextendedproperty @name = N'DatabaseFileVersion', @value = @AssemblyFileVersion
END
GO 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T09:49:10.067

您可以获得适用于 SQL Server Express 的 SQL Management Studio 版本。我相信您将能够使用它来生成数据库模式的脚本。我认为这会让您手动创建脚本以插入起始记录。

然后，将所有脚本连同以正确顺序运行各个脚本的主脚本一起放入源代码控制中。

您将能够使用windiff（Visual Studio SDK 免费）运行差异，否则[Beyond Compare](http://www.scootersoftware.com/)价格低廉，并且是一个很棒的差异/合并/同步工具。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T09:53:38.107

MS Visual Studio Team System for Database Developers 具有轻松为整个架构生成创建脚本的功能。唯一的缺点就是成本！

您是否考虑过使用 SubSonic？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-23T09:57:01.220

您应该使用特定于数据库的版本控制。

[http://msdn.microsoft.com/en-us/library/ms189050.aspx](http://msdn.microsoft.com/en-us/library/ms189050.aspx)

> 当 READ_COMMITTED_SNAPSHOT 或 ALLOW_SNAPSHOT_ISOLATION 数据库选项为 ON 时，将为在数据库中执行的所有数据修改维护逻辑副本（版本）。每次特定事务修改行时，数据库引擎实例都会在 tempdb 中存储该行先前提交的映像的一个版本。每个版本都标有进行更改的事务的事务序列号。修改行的版本使用链接列表链接。最新的行值始终存储在当前数据库中，并链接到存储在 tempdb 中的版本化行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-18T14:24:35.887

我[`bcp`](http://msdn.microsoft.com/en-us/library/aa337544.aspx)为此使用（批量加载实用程序，标准 SQL Server 安装的一部分，包括 Express 版）。

每个包含数据的表都需要一个控制文件`Table.ctl`和一个数据文件`Table.csv`（这些是文本文件，可以使用`bcp`. 作为文本文件，这些可以很容易地进行版本控制。

作为我的生成批次的一部分（有关更多信息，请参阅[我的答案](https://stackoverflow.com/questions/988426/how-should-you-build-your-database-from-source-control/1017208#1017208)），我遍历每个控制文件，如下所示：

```
SET BASE_NAME=MyDatabaseName
SET CONNECT_STRING=.\SQLEXPRESS

FOR /R %%i IN (.) DO (
  FOR %%j IN ("%%~fi\*.ctl") DO (
    ECHO +   %%~nj
    bcp %BASE_NAME%..%%~nj in "%%~dpsj%%~nj.csv" -T -E -S %CONNECT_STRING% -f "%%~dpsj%%~nj.ctl" >"%TMP%\%%~nj.log"
    IF %ERRORLEVEL% GTR 0 (
      TYPE "%TMP%\%%~nj.log"
      GOTO ERROR_USAGE
    )
  )
) 
```

此脚本的当前限制是文件名必须是表名，如果表名包含特定特殊字符，则可能无法实现。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-09-11T18:23:34.130

这个[项目](http://ysgitdiary.blogspot.com/2010/09/cassqldev-05320100909215832-out-now.html)有一个很好的部署和回滚示例

# windows - shell进程的并行执行

> ID：672719
> 
> 赞同：45
> 
> 时间：2009-03-23T09:42:30.303
> 
> 标签：windows, batch-file, shell, parallel-processing, multicore

是否有可用于在 Windows 批处理文件中并行执行多个进程的工具？我找到了一些有趣的 Linux 工具（[并行](http://mi.eng.cam.ac.uk/~er258/code/parallel.html)和[PPSS](http://code.google.com/p/ppss/)），但是，我需要一个适用于 Windows 平台的工具。

奖励：如果该工具还允许以简单的方式在多台机器之间分配进程，并以[PsExec](http://technet.microsoft.com/de-de/sysinternals/bb897553.aspx)远程运行进程，那就太好了。

示例：我希望在下面的 for 循环中

```
for %F in (*.*) do processFile.exe %F 
```

有限数量的 processFile.exe 实例并行运行以利用多核 CPU。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-07-30T04:33:30.487

***编辑***-*我修改了脚本以选择性地显示每个进程的输出*

这是一个本机批处理解决方案，它可靠地并行运行命令列表，一次不会启动超过***n 个***进程。

它甚至内置了一种机制，可以通过 PSEXEC 将进程分配到特定的 CPU 或远程机器，但我还没有测试过该功能。

完成这项工作的技巧是通过 CMD 进程启动每个命令，该进程将 stdout 或未定义的句柄重定向到锁定文件。该进程将在文件上保持一个排他锁，直到它终止。进程如何终止（正常退出、崩溃、终止进程）无关紧要，一旦完成，锁就会被释放。

主脚本可以通过尝试重定向到同一个锁定文件来测试进程是否仍然处于活动状态。如果进程仍然处于活动状态，则重定向将失败，如果已终止，则重定向成功。

默认情况下，脚本会忽略每个进程的输出。如果以`/O`选项作为第一个参数开始，那么它将显示每个进程的输出，而不会交错。

我的演示将进程限制设置为 4，并简单地运行一系列不同长度的 PING 命令。

我已经在 XP、Vista 和 Windows 7 上对此进行了测试。

```
@echo off
setlocal enableDelayedExpansion

:: Display the output of each process if the /O option is used
:: else ignore the output of each process
if /i "%~1" equ "/O" (
  set "lockHandle=1"
  set "showOutput=1"
) else (
  set "lockHandle=1^>nul 9"
  set "showOutput="
)

:: The list of commands could come from anywhere such as another file
:: or the output of another command. For this demo I will list the
:: commands within this script - Each command is prefixed with :::
::: ping /n 05 ::1
::: ping /n 20 ::1
::: ping /n 10 ::1
::: ping /n 15 ::1
::: ping /n 07 ::1
::: ping /n 05 ::1
::: ping /n 20 ::1
::: ping /n 10 ::1
::: ping /n 15 ::1
::: ping /n 07 ::1

:: Define the maximum number of parallel processes to run.
:: Each process number can optionally be assigned to a particular server
:: and/or cpu via psexec specs (untested).
set "maxProc=4"

:: Optional - Define CPU targets in terms of PSEXEC specs
::           (everything but the command)
::
:: If a CPU is not defined for a proc, then it will be run on the local machine.
:: I haven't tested this feature, but it seems like it should work.
::
:: set cpu1=psexec \\server1 ...
:: set cpu2=psexec \\server1 ...
:: set cpu3=psexec \\server2 ...
:: etc.

:: For this demo force all CPU specs to undefined (local machine)
for /l %%N in (1 1 %maxProc%) do set "cpu%%N="

:: Get a unique base lock name for this particular instantiation.
:: Incorporate a timestamp from WMIC if possible, but don't fail if
:: WMIC not available. Also incorporate a random number.
  set "lock="
  for /f "skip=1 delims=-+ " %%T in ('2^>nul wmic os get localdatetime') do (
    set "lock=%%T"
    goto :break
  )
  :break
  set "lock=%temp%\lock%lock%_%random%_"

:: Initialize the counters
  set /a "startCount=0, endCount=0"

:: Clear any existing end flags
  for /l %%N in (1 1 %maxProc%) do set "endProc%%N="

:: Launch the commands in a loop
:: Modify the IN () clause as needed to retrieve the list of commands
  set launch=1
  for /f "tokens=* delims=:" %%A in ('findstr /b ":::" "%~f0"') do (
    if !startCount! lss %maxProc% (
      set /a "startCount+=1, nextProc=startCount"
    ) else (
      call :wait
    )
    set cmd!nextProc!=%%A
    if defined showOutput echo -------------------------------------------------------------------------------
    echo !time! - proc!nextProc!: starting %%A
    2>nul del %lock%!nextProc!
    %= Redirect the lock handle to the lock file. The CMD process will     =%
    %= maintain an exclusive lock on the lock file until the process ends. =%
    start /b "" cmd /c %lockHandle%^>"%lock%!nextProc!" 2^>^&1 !cpu%%N! %%A
  )
  set "launch="

:wait
:: Wait for procs to finish in a loop
:: If still launching then return as soon as a proc ends
:: else wait for all procs to finish
  :: redirect stderr to null to suppress any error message if redirection
  :: within the loop fails.
  for /l %%N in (1 1 %startCount%) do 2>nul (
    %= Redirect an unused file handle to the lock file. If the process is    =%
    %= still running then redirection will fail and the IF body will not run =%
    if not defined endProc%%N if exist "%lock%%%N" 9>>"%lock%%%N" (
      %= Made it inside the IF body so the process must have finished =%
      if defined showOutput echo ===============================================================================
      echo !time! - proc%%N: finished !cmd%%N!
      if defined showOutput type "%lock%%%N"
      if defined launch (
        set nextProc=%%N
        exit /b
      )
      set /a "endCount+=1, endProc%%N=1"
    )
  )
  if %endCount% lss %startCount% (
    1>nul 2>nul ping /n 2 ::1
    goto :wait
  )

2>nul del %lock%*
if defined showOutput echo ===============================================================================
echo Thats all folks^^! 
```

这是忽略流程输出的示例运行的输出

```
12:24:07.52 - proc1: starting  ping /n 05 ::1
12:24:07.52 - proc2: starting  ping /n 20 ::1
12:24:07.53 - proc3: starting  ping /n 10 ::1
12:24:07.54 - proc4: starting  ping /n 15 ::1
12:24:11.60 - proc1: finished  ping /n 05 ::1
12:24:11.60 - proc1: starting  ping /n 07 ::1
12:24:16.66 - proc3: finished  ping /n 10 ::1
12:24:16.66 - proc3: starting  ping /n 05 ::1
12:24:17.68 - proc1: finished  ping /n 07 ::1
12:24:17.68 - proc1: starting  ping /n 20 ::1
12:24:20.72 - proc3: finished  ping /n 05 ::1
12:24:20.72 - proc3: starting  ping /n 10 ::1
12:24:21.75 - proc4: finished  ping /n 15 ::1
12:24:21.75 - proc4: starting  ping /n 15 ::1
12:24:26.82 - proc2: finished  ping /n 20 ::1
12:24:26.82 - proc2: starting  ping /n 07 ::1
12:24:29.86 - proc3: finished  ping /n 10 ::1
12:24:32.89 - proc2: finished  ping /n 07 ::1
12:24:35.92 - proc4: finished  ping /n 15 ::1
12:24:36.93 - proc1: finished  ping /n 20 ::1
Thats all folks! 
```

这是使用`/O`显示进程输出的选项运行时的输出

```
-------------------------------------------------------------------------------
12:24:51.02 - proc1: starting  ping /n 05 ::1
-------------------------------------------------------------------------------
12:24:51.02 - proc2: starting  ping /n 20 ::1
-------------------------------------------------------------------------------
12:24:51.03 - proc3: starting  ping /n 10 ::1
-------------------------------------------------------------------------------
12:24:51.04 - proc4: starting  ping /n 15 ::1
===============================================================================
12:24:55.10 - proc1: finished  ping /n 05 ::1

Pinging ::1 with 32 bytes of data:
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms

Ping statistics for ::1:
    Packets: Sent = 5, Received = 5, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 0ms, Average = 0ms
-------------------------------------------------------------------------------
12:24:55.10 - proc1: starting  ping /n 07 ::1
===============================================================================
12:25:00.17 - proc3: finished  ping /n 10 ::1

Pinging ::1 with 32 bytes of data:
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms

Ping statistics for ::1:
    Packets: Sent = 10, Received = 10, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 0ms, Average = 0ms
-------------------------------------------------------------------------------
12:25:00.19 - proc3: starting  ping /n 05 ::1
===============================================================================
12:25:01.22 - proc1: finished  ping /n 07 ::1

Pinging ::1 with 32 bytes of data:
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms

Ping statistics for ::1:
    Packets: Sent = 7, Received = 7, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 0ms, Average = 0ms
-------------------------------------------------------------------------------
12:25:01.23 - proc1: starting  ping /n 20 ::1
===============================================================================
12:25:04.27 - proc3: finished  ping /n 05 ::1

Pinging ::1 with 32 bytes of data:
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms

Ping statistics for ::1:
    Packets: Sent = 5, Received = 5, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 0ms, Average = 0ms
-------------------------------------------------------------------------------
12:25:04.28 - proc3: starting  ping /n 10 ::1
===============================================================================
12:25:05.30 - proc4: finished  ping /n 15 ::1

Pinging ::1 with 32 bytes of data:
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms

Ping statistics for ::1:
    Packets: Sent = 15, Received = 15, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 0ms, Average = 0ms
-------------------------------------------------------------------------------
12:25:05.32 - proc4: starting  ping /n 15 ::1
===============================================================================
12:25:10.38 - proc2: finished  ping /n 20 ::1

Pinging ::1 with 32 bytes of data:
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms

Ping statistics for ::1:
    Packets: Sent = 20, Received = 20, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 0ms, Average = 0ms
-------------------------------------------------------------------------------
12:25:10.40 - proc2: starting  ping /n 07 ::1
===============================================================================
12:25:13.44 - proc3: finished  ping /n 10 ::1

Pinging ::1 with 32 bytes of data:
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms

Ping statistics for ::1:
    Packets: Sent = 10, Received = 10, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 0ms, Average = 0ms
===============================================================================
12:25:16.48 - proc2: finished  ping /n 07 ::1

Pinging ::1 with 32 bytes of data:
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms

Ping statistics for ::1:
    Packets: Sent = 7, Received = 7, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 0ms, Average = 0ms
===============================================================================
12:25:19.52 - proc4: finished  ping /n 15 ::1

Pinging ::1 with 32 bytes of data:
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms

Ping statistics for ::1:
    Packets: Sent = 15, Received = 15, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 0ms, Average = 0ms
===============================================================================
12:25:20.54 - proc1: finished  ping /n 20 ::1

Pinging ::1 with 32 bytes of data:
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms
Reply from ::1: time<1ms

Ping statistics for ::1:
    Packets: Sent = 20, Received = 20, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 0ms, Average = 0ms
===============================================================================
Thats all folks! 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-24T09:32:41.377

尝试`start`：

```
start "title of the process" "P:\ath\to.exe" 
```

它会打开一个具有给定标题的新窗口并执行 BAT、CMD 或 EXE 文件。您还可以设置优先级，设置相同的环境等。

不可执行的文件用相关程序打开。

进一步阅读：开始 -> 运行

```
cmd /k start /? 
```

至少从 WinME 开始就可以使用 Start。

祝你好运！

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-03-24T09:32:37.650

听起来更像您想使用 Powershell 2。但是，您可以使用 生成新`cmd`窗口（或其他进程）`start`，另请参阅[此](https://stackoverflow.com/questions/649634/how-do-i-run-a-bat-file-in-the-background-from-another-bat-file/649937#649937)答案。尽管您可能必须使用一些其他工具和一些小技巧来创建类似“进程池”的东西（一次最多只能运行*n 个*实例）。`tasklist /im`您可以通过使用并计算已经存在的数量（`for`循环或`wc`，如果适用）并简单地等待（`ping -n 2 ::1 >nul 2>&1`）并再次重新检查是否可以生成新进程来实现后者。

我为此拼凑了一个小测试批次：

```
@echo off
for /l %%i in (1,1,20) do call :loop %%i
goto :eof

:loop
call :checkinstances
if %INSTANCES% LSS 5 (
    rem just a dummy program that waits instead of doing useful stuff
    rem but suffices for now
    echo Starting processing instance for %1
    start /min wait.exe 5 sec
    goto :eof
)
rem wait a second, can be adjusted with -w (-n 2 because the first ping returns immediately;
rem otherwise just use an address that's unused and -n 1)
echo Waiting for instances to close ...
ping -n 2 ::1 >nul 2>&1
rem jump back to see whether we can spawn a new process now
goto loop
goto :eof

:checkinstances
rem this could probably be done better. But INSTANCES should contain the number of running instances afterwards.
for /f "usebackq" %%t in (`tasklist /fo csv /fi "imagename eq wait.exe"^|find /c /v ""`) do set INSTANCES=%%t
goto :eof 
```

它产生最多四个并行执行并最小化的新进程。等待时间可能需要调整，具体取决于每个进程的执行量和运行时间。如果您正在做其他事情，您可能还需要调整任务列表正在查找的进程名称。

但是，无法正确计算该批次产生的进程。一种方法是在批处理开始时创建一个随机数`%RANDOM%`（

```
@echo off
title %1
"%2" "%3" 
```

这将是一个简单的批处理，将其标题设置为第一个参数，然后以第三个参数作为参数运行第二个参数。`tasklist /fi "windowtitle eq ..."`然后，您可以通过仅选择具有指定窗口标题 ( )的进程来过滤任务列表。这应该工作相当可靠，并防止太多误报。如果您仍然有一些实例正在运行，那么搜索`cmd.exe`将是一个坏主意，因为这会限制您的工作进程池。

您可以使用`%NUMBER_OF_PROCESSORS%`创建一个合理的默认值来生成多少个实例。

您还可以轻松地调整它以用于`psexec`远程生成进程（但不太可行，因为您必须在另一台机器上拥有管理员权限并在批处理中提供密码）。但是，您必须使用进程名称进行过滤。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-08-20T16:09:32.513

[在http://www.pirosa.co.uk/demo/wxargs/wxargs.html](http://www.pirosa.co.uk/demo/wxargs/wxargs.html)有一个基本的 Windows xargs-like-clone 支持 -P 并行处理选项

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-28T20:47:08.590

Linux 下的 GNU xargs 有一个“-P n”开关来并行启动“n”个进程。

也许 xargs 的 cygwin/mingw 构建也支持这个？

然后你可以使用：

```
xargs -P 4 processFile < fileList 
```

但是，没有花哨的多节点进程产生。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-09-18T20:40:36.947

我编写了一个提供多线程支持的库（以“模拟”线程池行为的方式）

[github上的MultiBat](https://github.com/adisak/MultiBat)

这是该库的内联版本，但我最好转到上面的链接以获取最新版本（以及不需要内联到您的 bat 文件中的版本。

```
REM ---------------------------------------------------------------------------
REM ---------------------------------------------------------------------------
REM ---------------------------------------------------------------------------
goto:EOF
REM Append this to the END of your batch-file [*.BAT] to get inline "Multi" support

REM  "Multi" is a thread-pool emulation helper library for controlling multi-threaded windows batch [*.BAT] files
REM  Copyright (c) 2020 Adisak Pochanayon
REM  Contact: adisak@gmail.com
REM  See Multi_License.txt for details

REM -----------------------------------

:Multi_Setup

call :Multi_SetName %1

if "%2"=="" (
    if "%NUMBER_OF_PROCESSORS%"=="" call :Multi_SetLimitToMax
) else (
    call :Multi_SetLimit %2
)
goto:EOF

REM -----------------------------------

:Multi_SetName
REM Returns: MULTI_CHILDPROC_WINNAME - name to use for child processes (the window title)

if "%1"=="" (
    SET MULTI_CHILDPROC_WINNAME=Multi-CmdProc
) else (
    SET MULTI_CHILDPROC_WINNAME=Multi-CmdProc-%1
)
goto:EOF

REM -----------------------------------

REM To Enable Hyperthreading, call Multi_SetHyperThread before calling Multi_Setup or Multi_SetLimitToMax

:Multi_SetHyperThread
REM Parameter 1: (optional)
REM        value=1    (or unspecified) - Use Hyperthreading if available
REM        value=0 (or other) - Do not use Hyperthreading to compute the max threads
REM Returns: NumberOfCores - number of real CPU cores
REM Returns: MULTI_HAS_HYPERTHREADING - 1 if the CPU has Hyperthreading
REM Returns: MULTI_USE_HYPERTHREADING - 1 if "Multi" should use Hyperthreading

REM Set variable NumberOfCores
if "%NumberOfCores%"=="" (
    for /f "tokens=*" %%f in ('wmic cpu get NumberOfCores /value ^| find "="') do set %%f
)

REM Set variable MULTI_HAS_HYPERTHREADING
if "%MULTI_HAS_HYPERTHREADING%"=="" (
    if "%NumberOfCores%"=="%NUMBER_OF_PROCESSORS%" (
        REM Non-Hyperthreading
        SET MULTI_HAS_HYPERTHREADING=0
    ) else (
        REM Hyperthreading
        SET MULTI_HAS_HYPERTHREADING=1
    )
}

if "%1"=="" (
    SET MULTI_USE_HYPERTHREADING=%MULTI_HAS_HYPERTHREADING%
) else (
    SET MULTI_USE_HYPERTHREADING=%1
)

REM Set the max threads to the limit (respecting Hyperthreading options)
call :Multi_SetLimitToMax
goto:EOF

REM -----------------------------------

:Multi_SetLimit
REM Parameter 1:
REM        value=N    - Use N as the number of max threads
REM        unspecified - Compute the default number of max threads
REM Returns: MULTI_MAXCHILDREN - the maximum number of child processes to run simultaneously

if "%1"=="" (
    if "%MULTI_MAXCHILDREN%"=="" call :Multi_SetLimitToMax
    goto:EOF
)

SET /A MULTI_MAXCHILDREN=%1
if %MULTI_MAXCHILDREN% LSS 1 SET MULTI_MAXCHILDREN=1
goto:EOF

REM -----------------------------------

:Multi_SetLimitToMax
REM Parameter 1: (optional)
REM        Passed to Multi_SetHyperThread if present
REM Returns: MULTI_MAXCHILDREN - max number of "threads" in pool for "Multi"

if "%1"=="" (
    REM Check if Hyperthreading support was initialized
    if "%NumberOfCores%"=="" (
        call :Multi_SetHyperThread 0
        REM Multi_SetHyperThread calls back to this subroutine so exit to prevent recursion
        goto:EOF
    )
) else (
    call :Multi_SetHyperThread %1
    REM Multi_SetHyperThread calls back to this subroutine so exit to prevent recursion
    goto:EOF
)

if %NUMBER_OF_PROCESSORS% LEQ 3 (
    SET MULTI_MAXCHILDREN=1
) else (
    if "%NumberOfCores%"=="%NUMBER_OF_PROCESSORS%" (
        REM Non-Hyperthreading
        SET /A MULTI_MAXCHILDREN=%NUMBER_OF_PROCESSORS%-2
    ) else if "%MULTI_USE_HYPERTHREADING%"=="1" (
        REM Hyperthreading available and used
        SET /A MULTI_MAXCHILDREN=%NUMBER_OF_PROCESSORS%/2 - 1
    ) else (
        REM Hyperthreading available but not used
        SET /A MULTI_MAXCHILDREN=%NUMBER_OF_PROCESSORS%-2
    )
)
goto:EOF

REM -----------------------------------

:Multi_RunWin

if "%MULTI_CHILDPROC_WINNAME%"=="" call :Multi_SetName

call :Multi_WaitChildrenMax
start "%MULTI_CHILDPROC_WINNAME%" /BELOWNORMAL cmd /c %*
goto:EOF

REM -----------------------------------

:Multi_RunWinMin

if "%MULTI_CHILDPROC_WINNAME%"=="" call :Multi_SetName

call :Multi_WaitChildrenMax
start "%MULTI_CHILDPROC_WINNAME%" /MIN /BELOWNORMAL cmd /c %*
goto:EOF

REM -----------------------------------

:Multi_RunSyncMin

REM Use this command to run things that mess with the window title
REM and otherwise would screw up the "Multi" System
start "Multi-Sync" /MIN /WAIT cmd /c %*
goto:EOF

REM -----------------------------------

:Multi_WaitChildrenMax

REM Wait until less than MULTI_MAXCHILDREN children are running

if "%MULTI_MAXCHILDREN%"=="" call :Multi_SetLimitToMax

call :Multi_WaitChildren %MULTI_MAXCHILDREN%
goto:EOF

REM -----------------------------------

:Multi_WaitChildren

SETLOCAL
REM multi_WAITCOUNT is a local variable
SET multi_WAITCOUNT=1

if "%1"=="" GOTO :loop_WaitChildren
SET /A multi_WAITCOUNT=%1
if %multi_WAITCOUNT% LSS 1 set multi_WAITCOUNT=1

:loop_WaitChildren
call :Multi_GetNumChildren
if %MULTI_NUM_CHILDREN% LSS %multi_WAITCOUNT% GOTO :exit_WaitChildren
timeout /t 1 /nobreak > nul
GOTO :loop_WaitChildren

:exit_WaitChildren
ENDLOCAL
goto:EOF

REM -----------------------------------

:Multi_GetNumChildren
REM Returns: MULTI_NUM_CHILDREN - the number of "children" processes (Windows named MULTI_CHILDPROC_WINNAME)

if "%MULTI_CHILDPROC_WINNAME%"=="" call :Multi_SetName

REM MULTI_NUM_CHILDREN should contain the number of 
REM running %MULTI_CHILDPROC_WINNAME% instances after this
for /f "usebackq" %%t in (`tasklist /fo csv /fi "WINDOWTITLE eq %MULTI_CHILDPROC_WINNAME%" ^| find /c "cmd"`) do (
    SET MULTI_NUM_CHILDREN=%%t
)
goto:EOF

REM ----------------------------------- 
```

# c++ - 如何将 c++ std::list 元素转换为多映射迭代器

> ID：672729
> 
> 赞同：0
> 
> 时间：2009-03-23T09:44:10.297
> 
> 标签：c++, list, stl, iterator, multimap

我有

```
std::list<multimap<std::string,std::string>::iterator> > 
```

现在我有了新元素：

```
multimap<std::string,std::string>::value_type aNewMmapValue("foo1","test") 
```

我想避免需要设置临时多图并插入新元素只是为了取回它的迭代器，这样我就可以将它推回：

```
std::list<multimap<std::string,std::string>::iterator> > 
```

我能以某种方式避免创建临时多图吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T09:48:18.400

您尚未指定存储在`list`. 无论如何，假设您要添加特定键指向的值，您可以调用`list.insert(*mapIter)`.

```
multimap<std::string,std::string>::value_type aNewMmapValue("foo1","test") 
```

您需要通过 将其添加到您的多地图中`map.insert`。此函数返回一个迭代器。然后，您可以安全地将这个迭代器添加到您的列表中。

```
std::list<multimap<std::string,std::string>::iterator> yourlist;
// ....
multimap<std::string,std::string>::iterator itr = 
                               yourmultimap.insert(aNewMmapValue);
yourlist.insert(itr); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T09:58:14.210

在获取迭代器之前，您需要将键值对插入到多重映射中。

迭代器本身不能工作。如果您要存储来自多个不同多图的迭代器，您可能需要在列表中存储的不仅仅是一个迭代器。

也许：

1.  a`pair<multimap<std::string,std::string>::iterator, multimap<std::string,std::string>::iterator>`其中第一个是迭代器，第二个是结束迭代器。

2.  a`pair<multimap<std::string,std::string>::iterator, multimap<std::string,std::string>*>`其中 first 是迭代器， second 是指向迭代器所属的多重映射的指针。

3.  一些其他类型的解决方案。

编辑：我同意 Mykola Golubyev：将迭代器存储更长的时间通常是一个坏主意，因为迭代器可能会失效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T16:06:24.217

该类型`std::multimap<std::string,std::string>::iterator`是`std::pair<const std::string, std::string>` **存储在 std::multimap 中的 a**的迭代器。如果元素未存储在多映射中，则不能通过多映射迭代器引用它。

您可能想要存储使用 a`std::list<std::pair<std::string,std::string> >`来代替。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-10T04:50:14.817

Don't store iterators. Use either const iterators or better way is store the pointers to the elements in the map.

# winforms - 组件与控制

> ID：672730
> 
> 赞同：11
> 
> 时间：2009-03-23T09:44:22.543
> 
> 标签：winforms, controls, components

在 WinForms .Net 控件的世界中

组件和控件有什么区别？

*   控件可以包含任何组件吗？
*   组件可以包含任何控件吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T19:40:51.027

控件具有充当窗口所需的所有管道。响应 Window 消息 (WndProc) 和拥有句柄的能力是最重要的。组件缺少所有这些。它真的很简单，它具有设置属性的设计时支持，并且可以被释放，仅此而已。

组件仍然可以有运行时表示，OpenFileDialog 就是最好的例子。但这实际上是 Windows 内置的对话框，而不是 Windows 窗体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T09:47:35.110

组件只是对象/子 API 的表示。例如。ImageList 是一个不可见的组件，只是一组图像的 API。您可以将它们拖放到表单上的事实只是设计器中的糖。

控件旨在可见/可交互/可嵌套。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T10:36:49.423

作为对您的评论的回应，可以在对象浏览器中看到组件和控件来自不同的对象层次结构。不能在 Control 中添加组件，因为 Controls 集合只接受具有 Control 基本类型的对象。

组件不能包含控件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-13T06:40:27.087

**组件**基本上是一个类（它可以是 dll、Activex 对象）。

*   它没有用户界面功能，这就是您看不到视觉表示的原因。
*   它是可移植的，并不特定于任何语言。

另一方面，**控件**是提供用户界面功能的组件。

*   由于控件具有 UI，因此您可以看到它的可视化表示。
*   它是特定于语言的，不可移植。

# c# - HTML - 我如何知道所有帧何时加载？

> ID：672731
> 
> 赞同：12
> 
> 时间：2009-03-23T09:44:47.567
> 
> 标签：c#, html, browser, mshtml

我正在使用 .NET WebBrowser 控件。我如何知道网页何时完全加载？

我想知道浏览器何时不再获取任何数据。（IE 在其状态栏中写入“完成”的那一刻......）。

笔记：

*   对于包含多个框架的网站，DocumentComplete/NavigateComplete 事件可能会发生多次。
*   浏览器就绪状态也不能解决问题。
*   我尝试检查帧集合中的帧数，然后计算我得到 DocumentComplete 事件的次数，但这也不起作用。
*   this.WebBrowser.IsBusy 也不起作用。在 Document Complete 处理程序中检查它时始终为“假”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-02-24T21:26:27.577

以下是我在应用程序中解决问题的方法：

```
private void wbPost_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
{
    if (e.Url != wbPost.Url)
        return;
    /* Document now loaded */
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-31T17:22:48.123

我**在页面完全加载**（包括框架）时做某事的方法是这样的：

```
using System.Windows.Forms;
    protected delegate void Procedure();
    private void executeAfterLoadingComplete(Procedure doNext) {
        WebBrowserDocumentCompletedEventHandler handler = null;
        handler = delegate(object o, WebBrowserDocumentCompletedEventArgs e)
        {
            ie.DocumentCompleted -= handler;
            Timer timer = new Timer();
            EventHandler checker = delegate(object o1, EventArgs e1)
            {
                if (WebBrowserReadyState.Complete == ie.ReadyState)
                {
                    timer.Dispose();
                    doNext();
                }
            };
            timer.Tick += checker;
            timer.Interval = 200;
            timer.Start();
        };
        ie.DocumentCompleted += handler;
    } 
```

从我的其他方法中，我学到了一些“不要”-s：

*   不要试图弯曲勺子...... ;-)
*   不要尝试使用 DocumentComplete、Frames、HtmlWindow.Load 事件构建复杂的构造。如果您的解决方案完全有效，您的解决方案将是脆弱的。
*   不要使用`System.Timers.Timer`代替`Windows.Forms.Timer`，如果你这样做，奇怪的错误将开始在奇怪的地方发生，因为计时器运行在与你的应用程序的其余部分不同的线程上。
*   不要只使用没有 DocumentComplete 的 Timer，因为它可能会在您的页面甚至开始加载之前触发，并且会过早地执行您的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-13T14:28:11.303

这是我的测试版本。只需将此作为您的`DocumentCompleted Event Handler`并将您只想调用*一次*的代码放入方法`OnWebpageReallyLoaded()`中。实际上，这种方法确定页面何时稳定了 200 毫秒，然后执行它的操作。

```
// event handler for when a document (or frame) has completed its download
Timer m_pageHasntChangedTimer = null;
private void webBrowser_DocumentCompleted( object sender, WebBrowserDocumentCompletedEventArgs e ) {
    // dynamic pages will often be loaded in parts e.g. multiple frames
    // need to check the page has remained static for a while before safely saying it is 'loaded'
    // use a timer to do this

    // destroy the old timer if it exists
    if ( m_pageHasntChangedTimer != null ) {
        m_pageHasntChangedTimer.Dispose();
    }

    // create a new timer which calls the 'OnWebpageReallyLoaded' method after 200ms
    // if additional frame or content is downloads in the meantime, this timer will be destroyed
    // and the process repeated
    m_pageHasntChangedTimer = new Timer();
    EventHandler checker = delegate( object o1, EventArgs e1 ) {
        // only if the page has been stable for 200ms already
        // check the official browser state flag, (euphemistically called) 'Ready'
        // and call our 'OnWebpageReallyLoaded' method
        if ( WebBrowserReadyState.Complete == webBrowser.ReadyState ) {
            m_pageHasntChangedTimer.Dispose();
            OnWebpageReallyLoaded();
        }
    };
    m_pageHasntChangedTimer.Tick += checker;
    m_pageHasntChangedTimer.Interval = 200;
    m_pageHasntChangedTimer.Start();
}

OnWebpageReallyLoaded() {
    /* place your harvester code here */
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T13:11:49.830

你试过`WebBrowser.IsBusy`房产吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T13:33:40.153

当帧完成时，在每个帧中使用 javascript 设置一个标志，然后让 C# 查看标志如何？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T13:45:52.137

我没有其他选择，但我想知道 Document Complete 处理程序期间的`IsBusy`属性是否`true`是因为处理程序仍在运行，因此`WebBrowser`控制在技术上仍然“忙碌”。

最简单的解决方案是有一个每 100 毫秒左右执行一次的循环，直到`IsBusy`标志被重置（在出现错误的情况下具有最大执行时间）。当然，这假设在页面加载期间的任何时候`IsBusy`都不会设置为`false`。

如果 Document Complete 处理程序在另一个线程上执行，您可以使用锁将主线程发送到睡眠状态并从 Document Complete 线程中唤醒它。然后检查`IsBusy`标志，重新锁定主线程仍然是`true`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T15:22:37.503

我不确定它是否会起作用，但请尝试在您的框架集上添加一个 JavaScript“onload”事件，如下所示：

```
function everythingIsLoaded() { alert("everything is loaded"); }
var frameset = document.getElementById("idOfYourFrameset");
if (frameset.addEventListener)
    frameset.addEventListener('load',everythingIsLoaded,false); 
else
    frameset.attachEvent('onload',everythingIsLoaded); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-26T07:35:30.440

可以使用 jQuery 吗？然后，您可以轻松地在目标帧上绑定帧就绪事件。有关说明，请参阅[此](https://stackoverflow.com/questions/205087/jquery-ready-in-a-dynamically-inserted-iframe)答案。这篇[博文](http://sonspring.com/journal/jquery-iframe-sizing)也有关于它的讨论。最后，您可以使用一个[插件。](http://ideamill.synaptrixgroup.com/?page_id=18)

这个想法是您使用以下方法计算网页中的帧数：

```
$("iframe").size() 
```

然后计算 iframe 就绪事件被触发的次数。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-26T07:39:11.087

您将获得外部网页以及每个框架的 BeforeNavigate 和 DocumentComplete 事件。当您收到外部网页的 DocumentComplete 事件时，您就知道您已经完成了。您应该能够使用[IWebBrowser2::TopLevelContainer()](http://msdn.microsoft.com/en-us/library/aa768276(VS.85).aspx)的托管等效项来确定这一点。

但是请注意，网站本身可以随时触发更多框架导航，因此您永远不知道页面是否真的永远完成。您可以做的最好的事情是记录您看到的所有 BeforeNavigates，并在您获得 DocumentComplete 时减少计数。

编辑：这是托管文档：[TopLevelContainer](http://msdn.microsoft.com/en-us/vcsharp/aa752080(VS.85).aspx)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-26T10:12:10.987

这是最终对我有用的方法：

```
 public bool WebPageLoaded
    {
        get
        {
            if (this.WebBrowser.ReadyState != System.Windows.Forms.WebBrowserReadyState.Complete)
                return false;

            if (this.HtmlDomDocument == null)
                return false;

            // iterate over all the Html elements. Find all frame elements and check their ready state
            foreach (IHTMLDOMNode node in this.HtmlDomDocument.all)
            {
                IHTMLFrameBase2 frame = node as IHTMLFrameBase2;
                if (frame != null)
                {
                    if (!frame.readyState.Equals("complete", StringComparison.OrdinalIgnoreCase))
                        return false;

                }
            }

            Debug.Print(this.Name + " - I think it's loaded");
            return true;
        }
    } 
```

在每个文档完成事件上，我都会遍历所有 html 元素并检查所有可用的帧（我知道它可以被优化）。对于每一帧，我检查它的就绪状态。它非常可靠，但就像 jeffamaphone 所说，我已经看到一些网站触发了一些内部刷新。但是上面的代码满足了我的需求。

编辑：每一帧都可以包含其中的帧，所以我认为应该更新这段代码以递归检查每一帧的状态。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-03-30T20:54:38.577

我只是使用 webBrowser.StatusText 方法。当它说“完成”时，一切都已加载！还是我错过了什么？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-11-03T04:10:39.007

检查 IE.readyState = READYSTATE_COMPLETE 应该可以工作，但如果这对您来说不可靠并且您确实想知道“IE 在其状态栏中写入'完成'的那一刻”，那么您可以循环直到 IE.StatusText 包含“完毕”。

# javascript - 防止长时间运行的 javascript 锁定浏览器

> ID：672732
> 
> 赞同：55
> 
> 时间：2009-03-23T09:45:21.323
> 
> 标签：javascript

我有 JavaScript，它执行大量计算以及从/向 DOM 读取/写入值。该页面很大，因此这通常会以 100% 的 CPU 使用率锁定浏览器长达一分钟（IE 有时会更长）。

是否有任何关于优化 JavaScript 以防止这种情况发生的资源（我能找到的只是如何关闭 Firefox 的长时间运行脚本警告）？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-03-23T10:00:13.643

如果你可以将你的计算算法变成可以迭代调用的东西，你可以通过使用带有短超时值的[setTimeout以频繁的间隔释放控制权。](https://developer.mozilla.org/En/DOM/window.setTimeout)

例如，像这样的事情......

```
function doCalculation()
{
   //do your thing for a short time

   //figure out how complete you are
   var percent_complete=....

   return percent_complete;
}

function pump()
{
   var percent_complete=doCalculation();

   //maybe update a progress meter here!

   //carry on pumping?
   if (percent_complete<100)
   {
      setTimeout(pump, 50);
   }
}

//start the calculation
pump(); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-23T09:59:05.567

使用超时。

通过将循环的内容放入单独的函数中，并从 setTimeout() 以 50 左右的超时时间调用它们，javascript 将产生对线程的控制并在一段时间后返回，从而允许 UI 获得在看。

[这里](http://windyroad.org/2007/03/30/web-apps-the-new-single-threaded-gui/)有一个很好的解决方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-23T13:19:13.540

前段时间我曾写过一篇关于[浏览器内性能的](http://piecesofrakesh.blogspot.com/2007/10/client-side-performance-optimization-of.html)博客，但让我在这里为你总结一下与 DOM 相关的内容。

*   尽可能不频繁地更新 DOM。对内存中的 DOM 对象进行更改，并将它们仅附加到 DOM 一次。
*   使用内部 HTML。在大多数浏览器中，它比 DOM 方法更快。
*   使用事件委托而不是常规事件处理。
*   知道哪些电话是昂贵的，并避免它们。例如，在 jQuery 中，$("div.className") 将比 $("#someId") 更昂贵。

然后还有一些和 JavaScript 本身相关的：

*   尽可能少循环。如果您有一个收集 DOM 节点的函数，而另一个处理它们的函数，那么您将循环两次。相反，将匿名函数传递给收集节点的函数，并在收集节点时处理节点。
*   尽可能使用本机功能。例如，forEach 迭代器。
*   使用 setTimeout 让浏览器偶尔呼吸一下。
*   对于具有幂等输出的昂贵函数，缓存结果，这样您就不必重新计算它。

我的博客上还有更多内容（上面的链接）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-14T18:17:33.867

这仍然有点前沿，但是 Firefox 3.5 有这些称为 Web Workers 的东西，不过我不确定它们在其他浏览器中是否支持。

Resig 先生在这里有一篇关于它们的文章：http: [//ejohn.org/blog/web-workers/](http://ejohn.org/blog/web-workers/)

[模拟退火](http://www.mozbox.org/pub/simulatedAnnealing/)可能是最简单的例子，如果你注意到旋转的 Firefox 徽标没有冻结，当工作线程正在执行他们的请求时（因此不会冻结浏览器）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T09:51:00.610

您可以尝试在线程中执行长时间运行的计算（请参阅[JavaScript 和线程](https://stackoverflow.com/questions/30036/javascript-and-threads)），尽管它们不是很便携。

您也可以尝试使用一些 Javascript 分析器来查找性能瓶颈。[Firebug](http://getfirebug.com/js.html)支持分析 javascript。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-14T18:27:22.083

我的经验是 DOM 操作，尤其是在 IE 中，比“核心”JavaScript（循环等）更容易成为性能问题。

如果您正在构建节点，在 IE 中通过构建 HTML 字符串然后在容器上设置 innerHTML 比使用 DOM 方法（如 createElement/appendChild）要快得多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-13T07:24:29.343

您可以尝试通过以下方式缩短代码

```
 $(xmlDoc).find("Object").each(function(arg1) {
    (function(arg1_received) {
                setTimeout(function(arg1_received_reached) {

                    //your stuff with the arg1_received_reached goes here 

                }(arg1_received), 0)
            })(arg1)
}(this)); 
```

或 for "for" 循环尝试

```
for (var i = 0 ; i < 10000 ; i = i + 1) {
    (function(arg1_received) {
        setTimeout(function(arg1_received_reached) {

            //your stuff with the arg1_received_reached goes here 

        }(arg1_received), 0)
    })(arg1_to_send)
} 
```

我遇到了同样的问题，我的客户将此报告为“Kill page”错误。但现在我得到了一个最好的解决方案。:)

# c - 如何防止C中的多个定义？

> ID：672734
> 
> 赞同：54
> 
> 时间：2009-03-23T09:46:00.730
> 
> 标签：c, multiple-definition-error

我是 C 新手，我只是想用 Code::Blocks 编写一个控制台应用程序。这是（简化的）代码：main.c：

```
#include <stdio.h>
#include <stdlib.h>
#include "test.c" // include not necessary for error in Code::Blocks

int main()
{
    //t = test(); // calling of method also not necessary
    return 0;
} 
```

测试.c：

```
void test() {} 
```

当我尝试构建这个程序时，它给出了以下错误：

```
*path*\test.c|1|`_test'的多重定义|
obj\Debug\main.o:*path*\test.c|1|首先定义在这里|

```

我不可能多次定义测试（尽管我不知道下划线来自哪里），而且定义似乎不太可能以某种方式被包含两次。这就是所有的代码。

我已经排除了这个错误是由于与其他函数或文件被称为 test 或 test.c 的一些命名冲突。请注意，多个定义和第一个定义位于同一文件的同一行。

有谁知道是什么原因造成的，我能做些什么？谢谢！

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-03-23T10:00:19.743

你实际上编译了`test.c`两次的源代码：

*   第一次`test.c`自己编译的时候，
*   第二次编译时`main.c`包含所有`test.c`源代码。

`main.c`为了使用该`test()`函数，您需要的是一个简单的声明，而不是它的定义。这是通过包含一个`test.h`包含以下内容的头文件来实现的：

```
void test(void); 
```

这会通知编译器存在这样一个带有输入参数和返回类型的函数。这个函数的作用（里面的所有东西`{`和`}`）都留在你的`test.c`文件中。

在 main.c 中，替换`#include "test.c"`为`#include "test.h"`.

最后一点：随着您的程序越来越复杂，您将面临头文件可能被多次包含的情况。为了防止这种情况，有时标头源包含在特定的宏定义中，例如：

```
#ifndef TEST_H_INCLUDED
#define TEST_H_INCLUDED

void test(void);

#endif 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-23T09:55:19.087

下划线由编译器放在那里并由链接器使用。基本路径是：

```
main.c
test.h ---> [compiler] ---> main.o --+
                                     |
test.c ---> [compiler] ---> test.o --+--> [linker] ---> main.exe 
```

因此，您的主程序应该包含测试模块的头文件，该头文件应该只包含声明，例如函数原型：

```
void test(void); 
```

这让编译器知道它在编译 main.c 时存在，但实际代码在 test.c 中，然后是 test.o。

这是将两个模块连接在一起的链接阶段。

通过将 test.c 包含到 main.c 中，您将在 main.o 中定义 test() 函数。大概，然后您将链接 main.o 和 test.o，它们都包含函数 test()。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-23T09:48:52.127

您不应在*.c 文件中包含其他源文件 (*.c)。我想你想要一个*带有测试函数声明的头文件（.h），并将它的定义放在一个单独的.c 文件中。

该错误是由测试函数的多个定义引起的（一个在test.c中，另一个在main.c中）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-25T10:20:40.523

我有类似的问题，我按照以下方式解决了。

解决如下：

函数原型声明和全局变量应该在 test.h 文件中，并且不能在头文件中初始化全局变量。

test.c文件中全局变量的函数定义和使用

如果您在标头中初始化全局变量，则会出现以下错误

> `_ test'的多重定义| obj\Debug\main.o：*路径*\test.c|1|首次定义在这里|

只是在头文件中声明全局变量，没有初始化应该起作用。

希望能帮助到你

干杯

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-23T09:51:33.213

包含实现文件 ( `test.c`) 会导致它被添加到您的 main.c 并在那里编译，然后再次单独编译。因此，该函数`test`有两个定义——一个在 的目标代码中，一个在 的目标代码中`main.c`，`test.c`这会给您带来 ODR 违规。您需要创建一个包含声明的头文件`test`并将其包含在`main.c`：

```
/* test.h */
#ifndef TEST_H
#define TEST_H
void test(); /* declaration */
#endif /* TEST_H */ 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-23T09:52:48.670

如果您已将 test.c 添加到您的 Code::Blocks 项目中，则该定义将被看到两次——一次通过#include，一次通过链接器。你需要：

*   删除#include“test.c”
*   创建一个包含声明的文件 test.h： **void test();**
*   # 在 main.c 中包含文件 test.h

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-23T10:16:14.853

如果您使用的是 Visual Studio，您还可以在头文件的顶部执行“#pragma once”，以实现与“#ifndef ...”-wrapping 相同的效果。其他一些编译器可能也支持它.. .. 但是，不要这样做 :D 坚持使用#ifndef-wrapping 以实现跨编译器兼容性。我只是想让你知道你也可以做一次#pragma，因为你在阅读其他人的代码时可能会遇到很多这种说法。

祝你好运

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-07-06T20:08:26.047

在此之后的时代，我发现了另一个导致相同错误的问题，但在任何地方都没有找到答案。我想把它放在这里以供其他遇到同样问题的人参考。

我在头文件中定义了一个函数，它一直抛出这个错误。（*我知道这不是正确的方法，但我想我会很快测试它。*）

解决方案是**只**在头文件中放置声明，在 cpp 文件中放置定义。

原因是头文件没有被编译，它们只提供定义。

# svn - 在 VisualSVN 的头文件中插入修订信息

> ID：672736
> 
> 赞同：2
> 
> 时间：2009-03-23T09:46:35.533
> 
> 标签：svn, visualsvn-server, svn-hooks

我想在 VisualSVN 服务器上运行某种提交后挂钩脚本，以便将文件（或简单地编辑文件）添加到包含修订号（和其他修订信息）的存储库。我知道这可以使用客户端脚本来实现，但我想在服务器上进行。有什么想法吗？有可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T09:49:45.917

您可以通过 VisualSVN 服务器管理器管理服务器挂钩：

1.  启动服务器管理器，
2.  选择存储库，
3.  **行动 | 所有任务 | 管理钩子。**

在对话框中，它告诉您修订号是第二个参数。有了修订号，您可以使用`svn.exe`并`svnlook.exe`执行许多其他任务……有用吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T15:04:10.017

从技术上讲，您可以使用提交后挂钩脚本来执行任务。但是，您应该了解，您不能修改原始事务本身（即不要尝试**启动**或**预**提交钩子。必须将带有修订详细信息的补充文件的提交作为单独的文件执行。

为了检索额外的修订数据，您可以[在您的钩子中](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.maint.html#svn.reposadmin.maint.tk.svnlook)[使用`svnlook.exe`](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.maint.html#svn.reposadmin.maint.tk.svnlook)。

请参阅[SVNBook](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.create.html#svn.reposadmin.create.hooks)：

> 虽然钩子脚本几乎可以做任何事情，但钩子脚本作者应该在一个方面表现出克制：**不要使用钩子脚本修改提交事务**. 虽然使用钩子脚本自动更正提交的文件中存在的错误、缺点或违反策略可能很诱人，但这样做可能会导致问题。Subversion 保留存储库数据的某些位的客户端缓存，如果您以这种方式更改提交事务，这些缓存将变得难以察觉的陈旧。这种不一致会导致令人惊讶和意外的行为。而不是修改事务，您应该简单地在预提交挂钩中验证事务，如果它不满足所需的要求，则拒绝提交。作为奖励，您的用户将了解谨慎、合规的工作习惯的价值。

# asp.net - 限制 ASP.NET 模板控件中允许的子控件类型

> ID：672742
> 
> 赞同：1
> 
> 时间：2009-03-23T09:48:44.467
> 
> 标签：asp.net

我试图限制可以放入 ASP.NET 中模板化控件的模板化区域的控件的可能类型。有谁知道这是怎么做到的吗？

/阿斯格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T11:10:37.720

约翰，非常感谢您的指点！那会让我更进一步。我不太确定，为什么它没有意义......例如在 DataGrids 列属性中只允许某些子控件：

BoundColumn ButtonColumn EditCommandColumn HyperLinkColumn

插入的任何其他控件都将导致编译错误：错误 4 验证 (ASP.Net): 元素列的开始和结束标记之间不允许出现文本。

/阿斯格

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T10:05:04.257

我不确定使用模板执行此操作本身是否有意义。模板是 ITemplate 类型的属性。我想您的设计器代码可能会尝试限制模板中的内容，但这确实违反了范式。

也许您想要的是重写 Control.AddParsedSubObject 方法，或者实现一个 ControlBuilder 来认真对待它。

# java - 为什么 EclipseLink 查询缓存仅在我使用 query.getSingleResult() 时有效？

> ID：672754
> 
> 赞同：1
> 
> 时间：2009-03-23T09:52:06.987
> 
> 标签：java, jpa, eclipselink

我的实体有一个命名查询，如下所示：

```
@NamedQuery(name = "Person.find", query = "select p from Organization p where p.name=:NAME") 
```

在我的代码中，我想设置查询缓存提示：

```
query.setHint("eclipselink.cache-usage", "CheckCacheThenDatabase"); 
```

如果我尝试获取整个结果列表：

```
List<Person> result = query.getResultList(); 
```

EclipseLink 抛出异常：

```
Exception [EclipseLink-6124] (Eclipse Persistence Services - 1.0.1 (Build 20080905)): org.eclipse.persistence.exceptions.QueryException
Exception Description: Required query of class org.eclipse.persistence.queries.ReadAllQuery, found class org.eclipse.persistence.queries.ReadObjectQuery 
```

如果我试图只得到一个结果，它会起作用：

```
Person person = query.getSingleResult(); 
```

如果我删除查询提示，那么 getResultList() 也可以工作。

我不明白这个例外 - 不是说它特别期待 getResultList() 吗？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T11:01:10.097

EclipseLink 文档说：

“EclipseLink 不支持本地查询或具有复杂结果集（例如返回数据或多个对象）的查询的缓存使用。”

文档还说：

“CheckCacheThenDatabase – 您可以配置任何读取对象查询以在访问数据库之前完全检查缓存。”

所以行为似乎没问题，我只是发现异常具有误导性。

编辑：在实体定义中尝试这样的事情，这应该足够了：（在网页上编码，因此可能会出现错误）

```
Entity
@Cache(expiry = 3600000, // 1 hour size = 10000)
@NamedQueries({
  @NamedQuery(name = "Person.findByPK", query = "select p from Person p " +
  "where p.name=:NAME",
  hints = {
    @QueryHint(name = QueryHints.CACHE_USAGE,
    value = CacheUsage.CheckCacheThenDatabase),
    @QueryHint(name = QueryHints.QUERY_TYPE, value = QueryType.ReadObject)
  }
}) 
```

# objective-c - 如何从 IMAP 邮件中提取附件？

> ID：672759
> 
> 赞同：0
> 
> 时间：2009-03-23T09:53:06.593
> 
> 标签：objective-c, cocoa, parsing, imap, attachment

如何从 IMAP 邮件中提取所有附件？我使用 Objective-C 和 Cocoa，但也喜欢通用教程、代码或提示。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T17:45:33.107

我认为您所说的“普通 IMAP 消息”是您有一个代表 IMAP 消息的字节序列。我不知道 FoundationKit 或 AppKit 内置的任何类会解析这种格式并以您寻求的方式公开消息的元素（例如附件）。您必须要么[找到一个现有的库](http://www.mronge.com/2005/11/13/imap-libraries/)来处理 IMAP 数据，要么卷起袖子编写一些代码来根据[IMAP 规范](http://www.isi.edu/in-notes/rfc3501.txt)解析电子邮件的内容。

# ios-simulator - iPhone 应用程序从 Finder 崩溃

> ID：672765
> 
> 赞同：-1
> 
> 时间：2009-03-23T09:54:56.340
> 
> 标签：ios-simulator, iphone

我编写了一个 iPhone 应用程序，并且只使用模拟器对其进行了测试，因为我没有真正的 iPhone。如果我 Build and Go，我可以看到应用程序正在运行。但是如果我去 Finder 然后通过项目的构建文件夹打开它，它会立即崩溃。有谁知道这是什么原因？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T16:33:50.483

它崩溃是因为双击它会导致 Mac OS X 尝试将其作为 Mac 应用程序运行。它的结构与 Mac 应用程序相同，而且是 x86 二进制文件，为什么不呢？但是 iPhone 应用程序尝试动态链接 UIKit，但没有这样做，然后崩溃了。模拟器设置 iPhone 应用程序的环境，以便链接成功。您可能可以在命令行中仔细使用环境变量来执行此操作，但 Finder 不会这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T15:25:56.297

Finder 无法正确启动模拟器。据我所知，XCode 是唯一受支持的启动模拟器的方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T05:17:40.930

所以汤姆，如果我想把那个二进制文件发送给朋友，打开它的说明是什么？

# .net - WPF软电话控制

> ID：672768
> 
> 赞同：0
> 
> 时间：2009-03-23T09:56:11.190
> 
> 标签：.net, wpf, wpf-controls, sip

我们有一个定制的 WPF CRM，并且正在寻求集成一个软电话客户端，这样操作员就不必手动输入电话号码。从我在网上看到的情况来看，没有 WPF 软电话客户端，看起来我们必须从头开始构建自己的客户端。

有人知道那里有任何 WPF 软电话实现吗？我确实找到[了这个](http://www.vista-files.org/programs/conaito-technologies/sip-phone-dll.html)库，它可以帮助我从头开始构建它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T09:25:32.883

我最近开始使用 conaito 库，虽然不在 WPF 应用程序中。我仍在使用Winforms。它似乎表现得很好，而且做得很好。您可以下载带有大量示例代码的全功能试用版。

# c++ - linux Code::Blocks、EMACS 或 GVIM 上的 C++ 开发

> ID：672770
> 
> 赞同：2
> 
> 时间：2009-03-23T09:57:40.640
> 
> 标签：c++, emacs, ide, vim

我不是在寻找 C++ 开发的 IDE 建议。我发现了很多关于这方面的讨论，并尝试了 EMACS、GVIM 和 Code::Blocks。我比其他两个更喜欢 Code::Blocks。但看起来大多数开发者社区都在使用 EMACS 或 GVIM 等工具。是否有一个原因？为什么 Code::Blocks 使用较少？

我发现 EMACS 和 GVIM 对用户不太友好。您必须付出更多努力才能使其正常工作，但 Code::Blocks 在这里发挥了作用。它很容易启动和编译。还是我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T10:51:43.567

Code::Blocks 使用较少，因为它不能像 Emacs 和 Vim 那样扩展。在我使用不同的编程语言（在 Emacs 中）工作期间，我经常创建一个新的脚本，使我的工作更加轻松。Code::Blocks 只允许在 C++ 中编写扩展，这需要做很多工作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-23T10:06:41.680

无论您最终使用哪种编辑器，至少花几分钟时间学习在 Vim 中导航和执行基本编辑任务是值得的，因为某种风格的 vi 是最常用的编辑器，尤其是在更专业的发行版中。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-23T10:04:33.540

Code::Blocks 是一个新进入者。另一方面，Vim 和 Emacs 的存在时间要长得多。他们是原始的文本编辑器。这些是在没有 GUI 时编写的，并且随着时间的推移而发展。GUI后来被添加到这些中；GVim 就是一个例子。像任何其他基于 GUI 的现代 IDE 一样，Code::Blocks 对您隐藏了奇怪的命令行调用，从而使其更加用户友好——对于那些在丰富的操作系统 UI 中长大的人来说 :-)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-23T10:34:41.940

许多开发人员使用 EMACS 和 vim，因为它们是出色而强大的编辑工具，一旦学会，可以使日常编辑任务变得更加简单。两者都不是与 Code::Blocks 相同意义上的 IDE。EMACS 和 Vim 只是编辑器，但由于它们的实用性和使用寿命，它们积累了许多插件和扩展来模拟 IDE 的许多任务。

至于你想学什么，就看你自己了。如果你只是想要一个让你直接进入的 IDE，你可能不会在寻找 Emacs 和 Vim，但如果你想要一个非常强大的编辑器，虽然需要一些时间来学习，但最终会让你的生活更轻松，选择 Emacs 或 Vim。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T10:03:34.807

Code::Blocks 是一个不错的 IDE，但大多数 linux OSS 项目不希望依赖于 IDE，并且编写得如此之好，以至于任何可以驱动编辑器并使用 make 的人都可以构建它们。如果你打算在 Linux 上做严肃的工作，你需要学习 vim 或 emacs 之一。这并不是说您当然不能在自己的项目中使用 Code::Blocks - 我当然可以！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T10:11:39.500

Vi(m)、Emacs 在 linux 机器上无处不在。它们非常可扩展，可以满足任何项目需求。由于 linux 上的几乎所有项目（至少在我们公司）都是非常大的支持项目，因此您需要一个严肃的可配置工具来完成任务。您不需要 IDE 来快速创建小型项目。一个项目。一种配置。多年的工作。

加。使用 Vim 或 Emacs，您可以远程完成并填写好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-23T16:32:03.843

就个人而言，我不时切换选择的 IDE。例如，我使用 Code::Blocks 已经有几年了，但现在因为某些原因跳过了它，因为编辑器窗口的延迟增加了，让我可以在盲注中输入整个短语；而且我已经禁用了所有耗时的东西（我反正不经常使用），比如代码完成（也就是说，在我的 Debian GNU/Linux 安装上；在 Windows 上，我仍然喜欢 code::blocks）。

所以，我最近偶然发现了***Monodevelop***，尽管我不是 mono/.net 的最大粉丝，但这个 IDE 非常好并且可扩展。它有一个类浏览器和一个文件系统浏览器，还有一些我个人不使用的特性（它主要是一个单声道/.net IDE，但也很好地支持 C++）。我唯一不喜欢monodevelop的是它不是基于闪烁的，或者它不能被调整为像闪烁（我是它的复制+粘贴机制的重度用户）（*）。

我通常不在 IDE 中编译，因为在分发您的应用程序或将其移植到其他操作系统（我使用 makefile 或 CMake 代替）时，这通常很痛苦。此外，如果您的应用程序转储大量日志，或者当您的编译器转储史诗般的错误消息时，有一个方便编译的（全屏）控制台/终端窗口非常好。

(*) 例如，您可以按 CTRL+D 仅复制当前光标位置后面的标记文本。要了解它，请查看 Notepad++ (win) 或 Scite (Linux)。

# c# - 如何在数据网格中将文本显示为粗体？

> ID：672779
> 
> 赞同：2
> 
> 时间：2009-03-23T09:59:29.777
> 
> 标签：c#, .net, winforms

我在窗口应用程序 c#.net 中使用数据网格。我想动态地将文本显示为粗体。

使用下面的代码我得到错误 font.bold 是只读的。

```
Datagrid.Rows[0].Cells[0].Style.Font.Bold = true; 
```

有没有其他方式在数据网格中动态显示文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T10:01:38.320

```
var myBoldFont = new Font(myBaseFont, FontStyle.Bold);
Datagrid.Rows[0].Cells[0].Style.Font = myBoldFont; 
```

# java - Python Programming - 用 Python 开发企业级软件的规则/建议？

> ID：672781
> 
> 赞同：7
> 
> 时间：2009-03-23T09:59:44.347
> 
> 标签：java, python, design-patterns, programming-languages, dynamic-typing

我是一个有点高级的 C++/Java 开发人员，最近对 Python 产生了兴趣，我非常喜欢它的动态类型和高效的编码风格。我目前使用它来满足我的小型编程需求，例如解决编程谜题和编写脚本，但我很好奇是否有人在企业级项目中成功使用过 Python？（最好使用现代编程概念，例如 OOP 和某种类型的设计模式）

如果是这样，你能否解释一下你**为什么**选择 Python *（特别是）*，并给我们一些你从这个项目中学到的**经验教训？**（随意比较在项目中使用 Python 与 Java 等）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-23T11:11:11.120

我正在使用 Python 开发复杂的保险承保应用程序。

我们的应用软件本质上以公司可以订阅的形式重新包装了我们的精算模型。这项业务基于我们的精算师和他们的深刻思考。我们没有打包一个相对固定的聪明算法。我们通过网络服务将我们的精算大脑出租给客户。

1.  精算师必须能够自由地做出改变，因为他们可以更深入地了解导致索赔的各种因素。

    *   静态语言（Java、C++、C#）会导致早期锁定数据模型。

    *   Python 允许我们拥有一个非常灵活的数据模型。他们可以自由地添加、更改或删除因素或信息源，而无需大量开发成本和复杂性。鸭子打字允许我们引入新作品而无需大量返工。

2.  我们的软件是一种服务（不是一个包），所以我们面临着无穷无尽的集成问题。

    *   静态语言需要复杂的映射组件。通常是某种可配置的、由 XML 驱动的从客户消息到我们不断变化的内部结构的映射。

    *   Python 允许我们将映射作为一个简单的 Python 类定义，我们只需对其进行调整、测试并投入生产。这个模块没有任何限制——它是一流的 Python 代码。

3.  我们必须进行广泛的、长期运行的概念验证。这些涉及许多具有不同数据馈送和定制功能的“假设”场景。

    *   静态语言需要大量仔细的计划和思考才能创建另一个演示，从另一个客户提供的文件到我们精算模型的当前版本的另一个映射。

    *   Python 需要的计划要少得多。Duck typing（和 Django）让我们轻松完成一个演示。数据映射是简单的 python 类定义；我们的精算模型处于相当稳定的变化状态。

4.  我们的商业模式需要经过一定程度的谈判。我们与信息提供者的合同相当复杂；这些不会像精算模型那样经常变化，但这里的变化需要定制。

    *   静态语言绑定了关于合同的假设，并且需要相当复杂的设计（或变通方法）来处理谈判交易的商务人员的大脑屁。

    *   在 Python 中，我们使用了一个广泛的测试套件，并随着各种合同条款和条件的渗透而进行了大量的重构。

    每周我们都会收到一个问题，例如“我们可以处理像 X 这样的规定吗？” 我们的标准答案是“绝对”。接下来是一个小时的重构，以确保如果交易以这种形式达成，我们*可以处理它。*

5.  我们主要是一个 RESTful Web 服务。Django 做了很多开箱即用的工作。我们不得不编写一些扩展，因为我们的安全模型比 Django 提供的更严格。

    *   静态语言不必提供源代码。不喜欢安全模型？向供应商支付 $$$。

    *   动态语言必须作为源发布。在我们的例子中，我们花时间仔细阅读 Django 的源代码，以确保我们的安全模型完全适合 Django 的其余部分。我们*不需要*HIPAA 合规性，但无论如何我们都在构建它。

6.  我们使用来自信息提供商的网络服务。urllib2 很好地为我们做到了这一点。我们可以快速地对接口进行原型设计。

    *   使用静态语言，您拥有 API，您编写、运行并希望它有效。开发周期是编辑、编译、构建、运行、崩溃、查看日志；这只是为了增加接口并确保我们拥有正确的协议、凭据和配置。

    *   我们在交互式 Python 中练习界面。由于我们以交互方式执行它，我们可以立即检查响应。开发周期缩短为运行、编辑。我们可以在一个下午完成一个 Web 服务 API。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T10:06:25.017

我一直在世界上最大的银行之一中使用 Python 作为分布式计算框架。之所以选择它，是因为：

*   开发和部署新功能的速度必须非常快；
*   它必须易于与 C 和 C++ 集成；
*   代码的某些部分将由专业领域是数学建模而不是软件开发的人编写。

# css - 清理 CSS 的工具？

> ID：672786
> 
> 赞同：1
> 
> 时间：2009-03-23T10:00:21.787
> 
> 标签：css, tidy

在发布网站之前，我有大量未使用的 CSS 样式。有什么好的工具可以检测未使用的 CSS 类、div 吗？

> **相关问题：**
> 
> *   [识别未使用的 CSS 定义的工具](https://stackoverflow.com/questions/135657/tool-to-identify-unused-css-definitions)
> *   [是否有任何实用程序可以帮助我重构 CSS](https://stackoverflow.com/questions/114272/are-there-any-utilites-that-will-help-me-refactor-css)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-04-16T20:29:28.647

这是一个简单的基于 Web 的 css 优化器，非常有用： [http ://www.cleancss.com/](http://www.cleancss.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-06T05:46:58.743

试试[ProCSSor](http://procssor.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-29T04:00:02.500

确保你有 firebug（对于 Firefox，如果你不知道的话），然后安装由 Google 开发的用于 firebug 的 pagespeed 插件：

[http://code.google.com/speed/page-speed/](http://code.google.com/speed/page-speed/)

它会在萤火虫中为您提供一个“pageSpeed”选项卡。打开它并选择“性能”，然后单击“分析性能”。除了许多其他有用的建议外，您还将获得一个标有“删除未使用的 Css”的列表项。单击以展开它并查看当前页面上出现的未使用的 css 规则的资源细分，以及通过删除未使用的规则将节省的内存大小。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-23T10:20:28.387

你可以试试 CSS Tidy：

[http://csstidy.sourceforge.net/](http://csstidy.sourceforge.net/)

它简单而有效。

# java - 如何在 HTML 文件中搜索某些标签？

> ID：672791
> 
> 赞同：3
> 
> 时间：2009-03-23T10:01:47.337
> 
> 标签：java, html, html-parsing

我在 Java 中遇到了一个小问题。如何做到这一点：我想在 HTML 文件中搜索标签 href 和 src，然后我想获取与该标签关联的 URL。

最好的方法是什么？

谢谢您的帮助。最好的祝福。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T10:11:57.860

您想将其作为一次性编辑任务，还是需要系统（即代码）实现？在第二种情况下，找到一个 Java HTML 解析器实现并遍历 DOM 树。

[http://java-source.net/open-source/html-parsers](http://java-source.net/open-source/html-parsers)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T11:07:23.360

这是我用来完成您想要做的事情的代码，但首先让我给您一些提示。

如果您在 Java Swing 环境中，请确保使用 javax.swing.text.html 和 javax.swing.text.html.parser 包中的方法。不幸的是，它们主要用于 JEditorPane，但我仍然强烈建议您看看这些。

Java 6 API 中有一个名为 HTML.Tag 的类，它标识 HTML 开始和结束标记，然后您可以使用它来确定您希望程序遵循的链接在哪里。[http://java.sun.com/javase/6/docs/api/javax/swing/text/html/HTML.Tag.html](http://java.sun.com/javase/6/docs/api/javax/swing/text/html/HTML.Tag.html "链接到 Java API 中的 HTML.Tag")

当我编写一个与此非常相似的程序时，我使用了 3 个主要方法：

```
public void handleStartTag(HTML.Tag t, MUtableAttributeSet atts, int pos)
public void handleEndTag(HTML.Tag t, int pos)
public void handleText(char[] text, int pos) 
```

如果您需要有关如何编写这些方法的更多帮助，您可以给我发消息，但基本上，您正在寻找一个初始标签和一个结束标签，然后您将从中识别出 url，然后您可以继续下一步，它在 url 之后。

要遵循 url，我建议您使用 JEditorPane 对象。javax.swing.event.HyperlinkListener 接口只定义了一种方法 hyperlinkUpdate(HyperlinkEvent e)，您可以将 url 传递到该方法中，然后在 JEditorPane 对象上调用 .setPage(evt.getURL())。然后，这将使用新页面更新窗格，并允许您再次启动该过程。

如果您有任何问题，请给我留言，请投票给这个答案！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T10:27:14.627

如果您的文件是一个**xhtml 文档**，那么它就是一个标准的 xml 文档，并且解析它的最糟糕的方法是使用[jdom](http://www.jdom.org/)。JDom 非常强大且易于使用和理解。

如果你有一个 html 文档，你可以试试[htmlparser](http://htmlparser.sourceforge.net/)，特别是 LinkTag[类](http://htmlparser.sourceforge.net/javadoc/org/htmlparser/tags/LinkTag.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T10:32:12.210

[看看这个问题：](https://stackoverflow.com/questions/238036/java-html-parsing)

我使用的答案是[JTidy](http://jtidy.sourceforge.net/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T10:36:01.420

您可以使用[Rhino](http://ejohn.org/projects/bringing-the-browser-to-the-server/)，然后加载 html 文件。加载后，您可以使用 getElementBy 转到任何节点或获取值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T10:49:42.043

我会看看[tagsoup](http://home.ccil.org/~cowan/XML/tagsoup/)，它将从任何 HTML 文档构建一个 DOM 树，即使是最不兼容的文档。

然后使用 XPath 并遍历返回的 NodeList：

//一种

和

//图片

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T11:07:48.770

我已经成功地将[Neko HTML Parser](http://sourceforge.net/projects/nekohtml)用于此类事情（屏幕抓取）。

```
导入 org.cyberneko.html.parsers.DOMParser；
导入 org.w3c.dom.Node；

公共类TestParser {

     公共静态 void main(String[] argv) 抛出异常 {
          DOMParser 解析器 = 新的 DOMParser();
          对于 (int i = 0; 我
```

# .net - 如何使用框架在 List(Of Byte) 中搜索两个值？

> ID：672792
> 
> 赞同：0
> 
> 时间：2009-03-23T10:02:04.530
> 
> 标签：.net, search, list, indexing, find

有没有办法在列表中搜索多个连续值？我查看了 Find 和 IndexOf 但 Find 使用仅使用当前值的谓词，而 IndexOf 仅采用字节参数。

我可以编写自己的解决方案，但我想确保没有解决这个常见问题的可用解决方案。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T11:10:16.987

一个想法可能是将您的列表分成连续值组，然后比较每个值的内容。这是另一个将执行拆分的函数（从 F# 核心库中提取）。

```
static IEnumerable<T[]> Windowed<T>(this IEnumerable<T> source, int size)
{
  if (source == null)
    throw new NullReferenceException();
  if (size <= 0)
    throw new ArgumentOutOfRangeException("size", "The window size must be positive.");

  var arr = new T[size];
  var r = size-1;
  var i = 0;
  foreach (T item in source)
  {
    arr[i] = item;
    i = (i+1) % size;
    if (r == 0)
    {
      var res = new T[size];
      for (int j = 0; j < size; j++)
        res[j] = arr[(i+j) % size];
      yield return res;
    }
    else 
      r -= 1;
  }
} 
```

你可以像这样使用上面的函数：

```
var result = Enumerable.Range(1, 10).Windowed(2)
               .Where(a => a[0] == 3 && a[1] == 4)
               .First(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T10:18:51.447

老实说，我认为这不是一个特别常见的问题 - 我很确定框架中没有任何内容。

我怀疑你需要弄清楚你是否想要效率或简单来实现你自己的。一个相当简单的扩展方法版本可能如下所示：

```
public static int IndexOf<T>(this IEnumerable<T> source,
                             T first,
                             T second)
{
    IEqualityComparer<T> comparer = EqualityComparer<T>.Default;

    // We can only return when we've read source[index+1], so we need
    // to keep one value behind
    int index=-1;
    T prev = default(T);
    foreach (T element in source)
    {
        if (comparer.Equals(first, prev) &&
            comparer.Equals(second, element) &&
            index >= 0) // Avoid edge cases where first=default(T)
        {
            return index;
        }
        index++;
        prev = element;
    }
    return -1;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T11:19:29.493

这是我自己对这个问题的解决方案。我喜欢这个方法，因为它可以处理任意数量的项目，是 O(n) 并且非常简单：

```
 <Extension()> Public Function Find(Of T)(ByVal list As List(Of T), ByVal searchedValue As T(), ByVal startingIndex As Integer) As Integer
    Dim mainIndex As Integer
    Dim searchedIndex As Integer
    Dim result As Integer

    result = -1 ' Initialize result
    mainIndex = startingIndex

    While mainIndex < list.Count AndAlso result = -1
        If list(mainIndex).Equals(searchedValue(0)) Then
            searchedIndex = 0
            While searchedIndex < searchedValue.Length AndAlso (list(mainIndex + searchedIndex).Equals(searchedValue(searchedIndex)))
                searchedIndex = searchedIndex + 1
            End While

            If searchedIndex = searchedValue.Length AndAlso list(mainIndex + searchedIndex - 1).Equals(searchedValue(searchedIndex - 1)) Then
                result = mainIndex
            End If
        End If

        mainIndex = mainIndex + 1
    End While

    Return result
End Function 
```

# asp.net - 在没有 HttpContext 的情况下在 asp.net 中获取 ApplicationState

> ID：672793
> 
> 赞同：1
> 
> 时间：2009-03-23T10:02:18.087
> 
> 标签：asp.net, multithreading, httpcontext, httpapplication

我有一个 webapp，它在 ApplicationState 中存储了一个配置对象。此对象包含与数据库的连接字符串以及其他内容。

有时我会启动一个异步线程来执行一些运行时间较长的任务，例如发送电子邮件和更新数据库。

但是，由于该线程没有 HttpContext 我无法获取配置对象。

我知道这种一切都依赖于 HttpContext 的设计很糟糕，但现在改变已经太迟了。查看反射器，我看到 HttpContext 类仅使用静态内部类来获取 ApplicationState。有没有其他方法可以得到它？

.net 中的所有这些内部类真的很烦人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T10:08:24.123

当你开始它时，只需将你喜欢的任何东西传递给你的线程。使用[ParameterizedThreadStart](http://msdn.microsoft.com/en-us/library/system.threading.parameterizedthreadstart%28v=vs.110%29.aspx)委托来启动它，而不仅仅是[ThreadStart](http://msdn.microsoft.com/en-us/library/system.threading.threadstart%28v=vs.110%29.aspx)委托。您可以将 HttpContext.Current 传递给它，或者将您希望线程拥有的信息捆绑在一起，然后传递它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-26T02:37:56.560

如果您*确实*需要从异步处理程序访问应用程序状态（或类似），您应该修改您的`HttpApplication`子类（例如 Global.asax）以在以下期间将应用程序状态实例（`this.Application`）存储到静态属性`Application_Start`：

```
public static HttpApplicationStateWrapper State { get; private set; }

protected void Application_Start()
{
    State = new HttpApplicationStateWrapper(this.Application);
} 
```

使用 DI 框架来注册这个实例会更合适，但如果你有一个可用的框架，你可能会完全避免使用 Application State 来存储配置。此外，.NET 中有一个配置框架可以直接满足这一需求并提供从任何地方读取配置的能力。

# java - 如何在 Ubuntu 中将 Java 从 1.6.0 降级到 1.5.0？

> ID：672795
> 
> 赞同：3
> 
> 时间：2009-03-23T10:02:37.757
> 
> 标签：java

我需要在 Ubuntu 中降级 Java。当前版本是 1.6.0，我的 Android 平台必须使用 JDK 1.5.0。

怎么做？删除它并重新安装？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-02-23T18:27:24.787

迟到的答案，但它可能会帮助那里的人：

```
sudo add-apt-repository "deb http://archive.ubuntu.com/ubuntu hardy main multiverse"
sudo add-apt-repository "deb http://archive.ubuntu.com/ubuntu hardy-updates main multiverse"
sudo apt-get update
sudo apt-get install sun-java5-jdk 
```

然后你可以看到java5

```
sudo update-java-alternatives -l 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-23T10:07:02.257

`update-java-alternatives`是你的朋友：

```
$ sudo update-java-alternatives -l
java-1.5.0-sun 53 /usr/lib/jvm/java-1.5.0-sun
java-6-sun 63 /usr/lib/jvm/java-6-sun 
```

然后选择所需的 Java 版本。例如，要选择 Java 1.5，请执行

```
$ sudo update-java-alternatives -s java-1.5.0-sun 
```

首先确保您安装了正确的 Java 包。

有关详细信息，请参阅[Ubuntu Java 页面](https://help.ubuntu.com/community/Java)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T12:13:31.873

回到 Solaris 上的石器时代（2000-2001），我们会并排安装两个版本（/usr/local 或 /opt），并使用 bash 脚本将 JAVA_HOME 更改为我们想要使用的版本。十分简单。只需确保 JAVA_HOME 在您的 PATH 中，并且可能在您的 LD_LIBRARY_PATH 中。

# c++ - 带有 LVS_OWNERDATA 标志的 ListView

> ID：672796
> 
> 赞同：1
> 
> 时间：2009-03-23T10:02:54.013
> 
> 标签：c++, visual-studio, mfc, listview

我想制作一个 CListView，它将使用套接字从远程服务器读取他的行。行可能超过一百万，这就是为什么我只需要在需要时读取行并且可以分组读取它们（每个请求超过 1 行）。我还需要支持按行排序。

可能我必须使用带有 LVS_OWNERDATA 标志的列表控件吗？当我必须阅读另一组行时？如果它是一个网页网格，我是否需要一个上一个、下一个按钮？

你能给我一些建议吗？

最好的祝福

PS 但是我还有另一个问题...... CListView 在主 UI 线程中，但我只能从第二个线程请求行，这可能并不总是可以使用。

可能我必须在回调中阻止 UI 线程以获取行信息？

有没有办法阻止 ListView 询问新的行信息？可能在我的第二个线程忙之前禁用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T10:17:59.857

阅读 Raymond Chen 关于[OWNERDATA 列表视图](http://blogs.msdn.com/oldnewthing/archive/2005/06/15/429338.aspx)。您需要为获取的数据实现自己的缓存，并在获取数据时显示一些合理的内容。我认为 Next/Prev 按钮不是一个好主意，列表视图处理自己的导航（滚动条、键盘快捷键等）

# regex - 正则表达式中的 C# 字符串格式占位符

> ID：672798
> 
> 赞同：6
> 
> 时间：2009-03-23T10:03:18.753
> 
> 标签：regex, formatting

我有一个正则表达式，以逐字 C# 字符串类型定义，如下所示：

```
private static string importFileRegex = @"^{0}(\d{4})[W|S]\.(csv|cur)"; 
```

正则表达式行开始 (^) 之后的前 3 个字母可以是许多可能的字母字符组合之一。

我想使用上面的方法做一个优雅的 String.Format，将我的 3 个字母组合选择放在开头，并在我的匹配算法中使用它，如下所示：

```
string regex = String.Format(importFileRegex, "ABC"); 
```

这会给我一个正则表达式`^ABC(\d{4})[W|S]\.(csv|cur)`

问题是，当我执行 String.Format 时，因为我在字符串中有其他花括号（例如`\d{4}`） String.Format 寻找要放入这里的东西，但找不到它并给我一个错误：

```
System.FormatException : Index (zero based) must be greater than or equal to zero and less than the size of the argument list. 
```

任何人都知道，除了将字符串分开之外，我可以逃避其他花括号或其他什么来避免上述错误吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-23T10:05:26.237

试试这个（注意双花括号）：

> `@"^{0}(\d`**`{{4}}`**`)[W|S]\.(csv|cur)"`

# c# - 在 dotnet 中生成 jpg 缩略图

> ID：672807
> 
> 赞同：1
> 
> 时间：2009-03-23T10:06:25.797
> 
> 标签：c#, image

我正在使用此代码拍摄 jpg 图像并将其保存为缩略图，但它似乎很慢..

```
 Image thumbNail = image.GetThumbnailImage(width, height, null, new IntPtr()); 
```

有没有更快的方法从图像目录中生成大量缩略图？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T10:12:54.177

尝试绘制图像 -**重新编辑**

```
 public Image ResizeImage(Image openImage, int NewWidth, int NewHeight) {
        var openBitmap = new Bitmap(openImage);
        var newBitmap = new Bitmap(NewWidth, NewHeight);
        using (Graphics g = Graphics.FromImage(openBitmap))
        {
            g.InterpolationMode = InterpolationMode.HighQualityBicubic;
            g.PixelOffsetMode = PixelOffsetMode.HighQuality;
            g.DrawImage(newBitmap, new Rectangle(0, 0, NewWidth, NewHeight));
        }
        openBitmap.Dispose(); //Clear The Old Large Bitmap From Memory

        return (Image)newBitmap;
    } 
```

典型的 3-4mb 图像需要 4-8ms

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-04-09T19:32:40.417

1) 到目前为止，创建 .JPG 缩略图的最快和最可靠的方法是使用部分解压缩。

Jpg 有一个独特的方面，它可以提取原件的 1/8 大小或 1/16 大小（或 2 大小的任何幂）副本，而**无需解压缩或采样**整个原始图像。

有没有注意到像 Picassa 或 Windows Explorer 这样的程序似乎可以超快速地创建缩略图？这就是他们的做法（当他们还没有被缓存时）。

在任何基于独立 JPEG 组库代码的库中都可以轻松使用此功能，并且大多数库都可以使用。例如 ImageMagick，它有一个可用的 .NET 层。

2) 您可以通过使用[libjpeg turbo](http://sourceforge.net/projects/libjpeg-turbo/)等硬件加速库来进一步提高速度，尽管它可能需要互操作。

3) 这个特殊的 .jpg 功能的一些解释在[这里](http://jpegclub.org/djpeg/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T17:41:50.930

尝试一下：

```
public bool GenerateThumbNail(string fileName, string thumbNailFileName,
    ImageFormat format, int height, int width)
{
    try
    {
        using (Image img = Image.FromFile(fileName))
        {
            Image thumbNail = new Bitmap(width, height, img.PixelFormat);
            Graphics g = Graphics.FromImage(thumbNail);
            g.CompositingQuality = CompositingQuality.HighQuality;
            g.SmoothingMode = SmoothingMode.HighQuality;
            g.InterpolationMode = InterpolationMode.HighQualityBicubic;
            Rectangle rect = new Rectangle(0, 0, width, height);
            g.DrawImage(img, rect);
            thumbNail.Save(thumbNailFileName, format);
        }
        return true;
    }
    catch (Exception)
    {
        return false;
    }
} 
```

它也使用 DrawImage。

# .net - 托管 (.net) 应用程序中内存泄漏的最常见（并且经常被忽视）的原因是什么？

> ID：672810
> 
> 赞同：14
> 
> 时间：2009-03-23T10:07:19.277
> 
> 标签：.net, memory

请任何人推荐一个快速清单/最佳实践指南，以帮助我们避免简单（但微妙）的错误，这些错误可能导致 .net 应用程序中的内存泄漏

当我处于项目的测试阶段时，我发现开始寻找内存泄漏的原因是困难且非常痛苦的。

如果有“经验法则”可以完全指导托管应用程序中的内存泄漏，我恳请您分享您的经验。

谢谢。

（我认为托管应用程序应该是“内存托管的”，即 GC？为什么我们仍然在纯托管代码中发现泄漏？）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-23T10:15:23.157

泄漏有多种形式：

*   非托管泄漏（分配非托管代码的代码）
*   资源泄漏（分配和使用非托管资源的代码，如文件、套接字）
*   延长对象的生命周期
*   对 GC 和 .NET 内存管理的工作原理的错误理解
*   .NET 运行时中的错误

前两个通常由两段不同的代码处理：

*   在对象上实现 IDisposable 并在 Dispose 方法中处理非托管内存/资源
*   实现终结器，以确保在 GC 发现对象符合收集条件时释放非托管资源

然而，第三个是不同的。

假设您正在使用一个包含数千个对象的大列表，总共有很大的内存大小。如果您保留对该列表的引用的时间超过您需要的时间，您将遇到看起来像内存泄漏的情况。另外，如果你不断地添加到这个列表中，让它周期性地随着更多的数据增长，而旧的数据永远不会被重用，那么你肯定有内存泄漏。

我经常看到的其中一个来源是将方法附加到事件处理程序，但在完成后忘记取消注册它们，从而使事件处理程序在大小和要执行的代码方面缓慢膨胀。

第四，对 .NET 内存管理工作原理的错误理解可能意味着您在进程查看器中查看内存使用情况并注意到您的应用程序的内存使用情况不断增长。如果您有大量可用内存，GC 可能不会经常运行，从而使您无法正确了解当前内存*使用情况*，而不是映射内存。

第五个，这更难，到目前为止，我只在 .NET 中看到了一个资源管理错误，并且已经计划在 .NET 4.0 中修复它，它是将桌面屏幕复制到 .NET 图像中。

* * *

**编辑**：针对评论中的问题，如何避免保持参考的时间超过必要的时间，那么唯一的方法就是做到这一点。

让我解释。

首先，如果你有一个长时间运行的方法（例如，它可能正在处理磁盘上的文件，或者下载一些东西，或类似的东西），并且你在方法的早期使用了对大数据结构的引用，在 long-运行部分，然后在方法的其余部分不使用该数据结构，然后.NET，在发布版本中（而不是在调试器下运行）足够聪明，可以知道这个引用，尽管它被保存在技术上在范围内的变量有资格进行垃圾收集。垃圾收集器在这方面非常激进。在调试构建和在调试器下运行时，它将在方法的生命周期内保留引用，以防您想在断点处停止时检查它。

但是，如果引用存储在声明方法的类中的字段引用中，它就不是那么聪明了，因为无法确定它是否会在以后被重用，或者至少非常非常困难。如果这个数据结构变得不必要了，你应该清除你持有的引用，以便 GC 稍后会拾取它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-23T10:15:23.810

简短的回答是不明显的参考。

添加一些细节：

*   在收集 AppDomain 之前不会收集静态数据（这可能等于进程关闭）
*   活动（记得退订）
*   阻塞式终结器（终结器按顺序运行，因此任何阻塞式终结器都会阻止收集所有其他可终结对象）。示例包括无法访问 STA 线程的终结器。
*   死锁线程永远不会释放根
*   忘记调用 Monitor.Exit()（例如，当使用超时或跨方法时）可能会导致死锁，进而可能导致泄漏

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-23T10:12:14.350

第一个是附加的并且从不分离的事件处理程序。

如果事件的订阅者的寿命比事件的生产者长，并且订阅者没有断开事件处理程序的连接，那么触发事件的对象将保持活动状态，因为仍然存在通过订阅对象对其的引用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-23T10:14:37.637

要回答您的最后两个问题：

根据定义，托管代码中没有内存泄漏。可能发生两种泄漏：

*   当没有对对象的引用处于活动状态时，对象被释放。如果你仍然有一个对象的引用，它不会被释放。例如，当您丢弃对已注册事件的对象的引用时，就会发生这种情况 - 如果您不手动取消注册事件处理程序（或使用弱引用），该事件仍将引用该对象，因此它不会被释放，尽管您不再有明显的参考。
*   非托管资源可能会泄露。通常，非托管资源的包装器实现 IDisposable 并在您调用 Dispose 时释放资源。如果你只是扔掉这个对象，它不会释放资源，因此会泄漏它。

因此，两个经验法则是：

*   释放对象时取消注册任何事件处理程序，或为此使用弱引用（在 SO 上搜索，在某处进行了解释）。
*   如果一个类公开了 Dispose 方法，请调用它。如果您只是临时使用该对象，请使用 using 构造。如果您有实现 IDisposable 的成员，请自己实现 IDisposable 并在您的 Dispose 中调用成员的 Dispose。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-23T10:22:43.577

您可以做的许多好事之一来有效地管理内存。

尽可能在任何实现 IDisposable 的对象上调用 dispose，尤其是在 DataSet 或 DataTable 对象上。

最好还是在这些对象上使用 using{} 构造。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-23T10:12:31.697

在我看来，托管应用程序中内存泄漏的第一大原因是错误地认为您有内存泄漏，而实际上您没有正确测量。一定要使用内存分析器来准确测量你有什么样的内存泄漏。您可能会发现您还有其他问题。

但是当泄漏是真实的时，主要原因将是对那些在不需要时保持这些对象存活的对象的引用。为几乎所有实现 IDisposable 的对象实现*using*语句是一个好的开始。我知道的唯一例外是 WCF 代理类，它应该使用 try/catch/finally 访问，而不是*using*语句。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-23T10:21:01.660

我可以开始建议人们应该始终了解`IDisposable`对象以及如何正确处理它们。另外，要非常小心应用程序中的**状态**。*仅在绝对必要时抓取*物体。如果对象 A 会在您的应用程序中存在很长时间，请始终*尽量*不要在 A 和其他对象之间建立依赖关系。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-23T10:19:03.693

值类中的循环引用（通常在应用程序的模型层中）也可以轻松隐藏它们的泄漏。理论上，不要做它们，在实践中，当你需要做它们时要注意:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-03T09:07:00.970

检查使用后不需要存在于内存中的静态变量，检查事件处理引用，阻止收集其他终结器的任何终结器，以及是否存在对任何 DLL 或 COM+ 对象的任何非托管引用

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-11-14T03:36:03.907

以下是内存泄漏的主要原因。

1.  持有对托管对象的引用（未释放事件处理程序的经典案例。）
2.  无法释放非托管资源
3.  未能处理绘图对象
4.  我注意到计时器也会导致内存泄漏。如果您正在使用任何计时器，请务必将其丢弃。

请进一步阅读[http://blogs.msdn.com/b/davidklinems/archive/2005/11/16/three-common-causes-of-memory-leaks-in-managed-applications.aspx](http://blogs.msdn.com/b/davidklinems/archive/2005/11/16/three-common-causes-of-memory-leaks-in-managed-applications.aspx)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-06-23T07:27:26.003

内存泄漏可能来自多种来源。

*   您注册了一个活动，但忘记取消注册该活动。

*   文件/连接已打开但未正确关闭。

*   Dispose() 调用未正确实现。

*   Dispose() 调用以某种方式被绕过；例如，在两者之间遇到了异常。

*   您遇到了死锁（这可能导致不释放根对象）。

*   终结器线程被阻塞；例如，COM 对象的 STA 线程不可用。

*   非托管代码存在泄漏。

*   对象的生命周期太长。

*   有一个循环引用。

*   泄漏可能来自 .NET 运行时环境（在极少数情况下）。

*   您的测试框架也可能出现泄漏。（这种情况下是测试泄漏，不是开发环境泄漏，由测试工程师负责解决。）

# wpf - 表单allowtransparency = true时的WPF Combobox错误

> ID：672812
> 
> 赞同：1
> 
> 时间：2009-03-23T10:08:28.430
> 
> 标签：wpf, transparency

我在 WPF 中发现了以下内容：

我有一个 AllowTransparency=true 的表单。在表格内我放了一个组合框。我在组合框中添加了一些项目。

我运行此应用程序并单击组合框。起初它似乎根本没有出现。仔细检查（添加更多项目后），我发现它实际上出现在表单后面。如果我添加足够多的项目，它就会从表单后面看到。

如果我只是更改 AllowTransparency=false，那么一切都很好。

这看起来像是 WPF (3.5 SP1) 中的一个错误。

有人知道解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T10:48:49.597

AllowTransparency 速度慢且有问题，不应该使用 - 这是在各种显示驱动程序中遇到错误的好方法。

您可以在不使用 AllowTrasparency 的情况下获得几乎任何您喜欢的东西，请查看这篇文章以获取示例：

[http://blogs.msdn.com/wpfsdk/archive/2008/09/08/custom-window-chrome-in-wpf.aspx](http://blogs.msdn.com/wpfsdk/archive/2008/09/08/custom-window-chrome-in-wpf.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T10:14:14.843

转到 [https://connect.microsoft.com/dashboard/?wa=wsignin1.0](https://connect.microsoft.com/dashboard/?wa=wsignin1.0)

搜索后提交您的反馈@

[https://connect.microsoft.com/VisualStudio](https://connect.microsoft.com/VisualStudio)

[https://connect.microsoft.com/VisualStudio/feedback/CreateFeedbackForm.aspx?FeedbackFormConfigurationID=1160&FeedbackType=1](https://connect.microsoft.com/VisualStudio/feedback/CreateFeedbackForm.aspx?FeedbackFormConfigurationID=1160&FeedbackType=1)

并提及重现的步骤。

有 3.5sp1 的更新，但你可以测试，但我怀疑

[http://www.microsoft.com/downloads/details.aspx?familyid=6c095bba-6100-4ec9-9c54-6450b0212565&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=6c095bba-6100-4ec9-9c54-6450b0212565&displaylang=en)

# asp.net - HTML中的框架？

> ID：672820
> 
> 赞同：1
> 
> 时间：2009-03-23T10:12:46.033
> 
> 标签：asp.net

实际上......我有一个左框架和一个右框架......

1.  在 Left Frame 中，我有一个树视图（它是静态的）

2.  在 Right Frame 中，基于点击（即基于选定的孩子，我必须显示相应的网页）

如何实现这个？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T10:19:27.467

使用框架集

```
<frameset cols="150,*" frameborder="NO" marginwidth=0 marginheight=0>
    <frame src="left.html" frameborder="NO" >
    <frame src="right.html" frameborder="NO" name="subwindow">
</frameset>

<noframes>
   <body><p>This web page uses frames.</p></body>
</noframes>
</frameset> 
```

并使您的链接到目标窗口，例如；

```
<A HREF="main.html" target="subwindow"> 
```

# c# - 映射到 Nhibernate 中的枚举位标志

> ID：672822
> 
> 赞同：15
> 
> 时间：2009-03-23T10:13:01.383
> 
> 标签：c#, nhibernate

采取以下枚举标志

```
[Flags]
enum Permssions
{
   CanComment = 1,
   CanEdit = 2,
   CanDelete = 4,
   CanRemoveUsers = 8,
   All = CanComment | CanEdit | CanDelete | CanRemoveUsers 
} 
```

在 NHibernate 中，我在使用之前映射到一个枚举：

```
<property type="n.Permssions, n.Permssions"
name="Permssions" column="Permssions"></property> 
```

我的问题是，如何使用 NHibnerate 将按位字段映射到标志字段？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-01T07:40:12.613

当我映射一个枚举，并且这个枚举有一个“int”类型的支持值时，我只是将我的枚举属性映射到数据库中的一个 int 字段。我没有遇到这方面的问题。
我也为标志枚举做过这个，这没有问题。当您组合某些标志时，NHibernate 会将这些标志的“组合”保存到数据库中的指定列中。
当您检索具有“标志枚举”属性的实例时，NHibernate 会将其重构回正确的组合。
例如，如果 DB 包含“3”，则 NHibernate 将使用适当值的组合填充您的属性。
事实上，我让 NHibernate 自己解决了所有问题：

```
<property name="OnCallType" column="OnCallType" /> 
```

其中 OnCallType 列在我的数据库中是 int 类型，而 OnCallType 属性是具有 flags 属性的枚举类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T11:50:15.300

我认为最好的选择是使用[自定义用户类型](http://knol.google.com/k/fabio-maulo/nhibernate-chapter-5/1nr4enxv3dpeq/8#5(2E)2(2E)(C2)(A0)NHibernate_Types)。您可以在其中将班级中的 Enum 映射到这两列。这是一个使用 ICompositeUserMap 的示例，可用作指南：

*   [Money 对象和 NHibernate ICompositeUserType](http://geekswithblogs.net/opiesblog/archive/2006/08/05/87218.aspx)

尽管在您的情况下，仅实现 IUserType 就足够了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-27T13:44:26.877

这为我解决了问题：

在类映射中，我将其映射到具有枚举类型名称的自定义类型。

```
Map(x => x.MyEnumProperty).CustomType<EnumType>(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T20:55:21.697

我将有一个用于 NHibernate 持久性的私有 int 字段和一个用于读取和写入 int 字段的标志枚举的公共 Getter/Setter 属性。（NHibernate 可以配置为使用私有字段）

这样你就不必诉诸巫术魔法或混乱的常数来完成工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T06:45:12.120

这并不能准确回答您的问题，但在您的类和映射中使用 Int32 属性可能更容易，并使用像这样的静态常量类来处理代码中的值：

```
public static class Permissions
{
    public const int CanComment = 0x1;
    public const int CanEdit = 0x2;
    public const int CanDelete = 0x4;
    public const int CanRemoveUsers = 0x8;
    public const int All = CanComment | CanEdit | CanDelete | CanRemoveUsers;
} 
```

我知道这并不理想，因为它不会将您的用户限制为固定的枚举值，并强制您处理代码中的原始整数，但我认为 Hibernate 会遇到按位枚举的问题。它将尝试将数据库中的值映射回特定的枚举值。如果它在数据库中找到一个您没有明确枚举的值，它可能会窒息。例如，如果它在数据库中找到“3”，它将无法将其映射回枚举值，除非您明确枚举每个组合，如 CanCommentAndEdit、CanCommentAndEditAndDelete 等。这可能会破坏使用按位的目的枚举。

# ms-access - 独立安装 Ms-Access 2003？

> ID：672828
> 
> 赞同：2
> 
> 时间：2009-03-23T10:16:24.230
> 
> 标签：ms-access

任何人都知道是否可以在没有 Office 2003 其余部分的情况下单独安装 Access 2003？我似乎没有找到我的安装盘来测试这个，但认为有人可能会有答案......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T10:20:47.840

我相信如此，当您安装 Office 并选择自定义安装时，您可以取消选择除 Access 之外的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T11:48:01.607

您可以进行自定义安装，然后取消选择所有内容。

您基本上将获得所有 MS Office 运行时和共享组件，只有 Access 应用程序可运行。

注意：我不再使用访问运行时，但会定期将它用于 Excel 和/或 Word 应用程序。

# iphone - Sqlite3 在 iPhone 上给出“没有这样的表”错误

> ID：672829
> 
> 赞同：3
> 
> 时间：2009-03-23T10:16:58.393
> 
> 标签：iphone, sqlite

我创建了一个 sqlite3 数据库，创建了表并插入了一些数据。我可以使用终端应用程序使用选择查询进行检索。

但是当我将此数据库添加到我的 iPhone 应用程序资源并尝试以编程方式访问数据时，我收到错误消息*“没有这样的表：表名”*

为什么会这样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T05:29:40.057

sqlite3_open() creates an empty database for you if the database path does not exist. So, it is possible that the path you gave it does not lead you to the intended file. With an empty database, you get "no such table" a lot.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T22:35:17.147

I had the same error with sqlite3X C++ wrapper. I use this library in my IE-plugin. The problem was in unavailability .sqlite base. Current directory for IE(not plugin) is "C:\Documents and Settings\UserName\desktop\". When I put my base in this location - problem was solved.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T12:38:54.917

iPhone 可能无法访问 DB 文件。尝试从 iPhone 应用程序本身创建数据库。

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(
                    NSDocumentDirectory, NSUserDomainMask, YES
                 );
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *path = [
      documentsDirectory stringByAppendingPathComponent:@"yourdbname.sql"
];
// Open the database. The database was prepared outside the application.
if (sqlite3_open([path UTF8String], &db_handle) != SQLITE_OK) {
    // Even though the open failed, 
    // call close to properly clean up resources.
    sqlite3_close(db_handle);
    NSAssert1(0, 
         @"Failed to open database with message '%s'.", 
         sqlite3_errmsg(db_handle)
    );
} 
```

并再次执行您的查询。此外，如果您检查数据库访问代码的每个步骤中的潜在错误，它也会有所帮助。

# nhibernate - 关于域对象的存储库及其保存方法的问题

> ID：672836
> 
> 赞同：9
> 
> 时间：2009-03-23T10:18:31.387
> 
> 标签：nhibernate, linq-to-sql, orm, domain-driven-design, ddd-repositories

关于 DDD、存储库模式和 ORM，我有一个有点荒谬的问题。在这个例子中，我有 3 个类：**Address**、**Company**和**Person**。一个人是公司的成员并且有一个地址。公司也有地址。

这些类反映了一个数据库模型。我删除了我的模型的所有依赖项，因此它们不会绑定到特定的 ORM 库，例如 NHibernate 或 LinqToSql。这些依赖关系在存储库中处理。

在其中一个**存储库**中有一个**SavePerson(Person person)**方法，该方法根据 Person 是否已存在于数据库中来**插入/更新它。**

由于 Person 对象有一个 Company，因此我目前在进行 SavePerson 调用时也保存/更新了 Company 属性的值。在此过程中，我插入/更新公司的所有数据 - 名称和地址。

但是，我真的很难想到公司的数据在与人打交道时会发生变化的情况——我只想能够将公司分配给一个人，或者将一个人移动到另一个公司。我不认为我想和一个新人一起创建一个新公司。所以 SaveCompany 调用引入了不必要的数据库调用。保存 Person 时，我应该能够更新 CompanyId 列。

但是由于 Person 类有一个 Company 属性，我有点倾向于用它来更新/插入它。从严格/纯粹的角度来看，SavePerson 方法应该保存整个 Person。

首选的方式是什么？只是在保存 Person 或保存其所有数据时插入/更新 Company 属性的 CompanyId？或者你会为这两种场景创建两种不同的方法（你会给它们起什么名字？）

另外，另一个问题，我目前有不同的方法来保存一个人、一个地址和一个公司，所以当我保存一个公司时，我也会调用 SaveAddress。假设我使用 LinqToSql——这意味着我不在同一个 Linq 查询中插入/更新公司和地址。我猜有 2 个 Select Calls（检查公司是否存在，检查地址是否存在）。然后对两者进行两次插入/更新调用。如果引入更多的复合模型类，则更多。LinqToSql 有没有办法优化这些调用？

```
public class Address
{
    public int AddressId { get; set; }
    public string AddressLine1 { get; set; }
    public string AddressLine2 { get; set; }
    public string City { get; set; }
    public string PostalCode { get; set; }        
}

public class Company
{
    public int CompanyId { get; set; }
    public string Name { get; set; }
    public Address Address { get; set; }
}

public class Person
{
    public int PersonId { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string Email { get; set; }
    public Company Company { get; set; }
    public Address Address { get; set; }

} 
```

**编辑**

另请参阅[此后续问题](https://stackoverflow.com/questions/679005/how-are-value-objects-stored-in-the-database)。值对象如何存储在数据库中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T22:03:56.353

我自己最近使用了 Keith 建议的 IRepository 方法。但是，您不应该在这里关注这种模式。取而代之的是，DDD 手册中还有一些可以在此处应用的部分。

## 为您的地址使用*值对象*

首先，您可以在此处应用值对象 (VO) 的概念。在您的情况下，它将是地址。值对象和实体对象的区别在于实体有一个身份；VO没有。VO 的身份实际上是其属性的总和，而不是唯一身份。在[Domain-Drive Design Quickly](https://rads.stackoverflow.com/amzn/click/com/1411609255)（它也是一个免费的 PDF 下载）一书中，他很好地解释了这一点，他指出地址实际上只是地球上的一个点，不需要像人这样的单独的类似 SocialSecurity 的身份。地球上的那个点是街道、号码、城市、邮编和国家的组合。它可以具有纬度和经度值，但根据定义，它们仍然是 VO，因为它是两点的组合。

## 使用*服务*将您的实体组合成一个实体以进行操作。

另外，不要忘记 DDD 手册中的服务概念。在您的示例中，该服务将是：

```
public class PersonCompanyService
{
  void SavePersonCompany(IPersonCompany personCompany)
  {
    personRepository.SavePerson();
    // do some work for a new company, etc.
    companyRepository.SaveCompany();
  }
} 
```

当您有两个需要类似操作来协调其他操作组合的实体时，就需要服务。在您的情况下，同时保存 Person() 并创建一个空白 Company() 。

## ORM 通常需要一个身份，句号。

现在，您将如何将地址 VO 保存在数据库中？您显然会使用 IAddressRepository。但是由于大多数 ORM（即 LingToSql）要求所有对象都有一个身份，所以这里的诀窍是：在你的模型中将身份标记为内部，因此它不会暴露在你的模型层之外。这是史蒂文桑德森自己的建议。

```
public class Address
{
  // make your identity internal
  [Column(IsPrimaryKey = true
    , IsDbGenerated = true
    , AutoSync = AutoSync.OnInsert)]
  internal int AddressID { get; set; }

  // everything else public
  [Column]
  public string StreetNumber { get; set; }
  [Column]
  public string Street { get; set; }
  [Column]
  public string City { get; set; }
  ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T16:23:15.020

根据我最近使用存储库模式的经验，我认为您会从使用通用存储库（现在常见的 T 的 IRepository）中受益。这样您就不必添加像 SavePerson(Person person) 这样的存储库方法。相反，你会有类似的东西：

```
IRepository<Person> personRepository = new Repository<Person>();
Person realPerson = new Person();
personRepository.SaveOrUpdate(realPerson); 
```

这种方法也很适合测试驱动开发和模拟。

我觉得您描述中有关行为的问题与域有关，也许您应该在您的 Person 类中有一个 AddCompany 方法并将 Company 属性更改为

```
public Company Company { get; private set; } 
```

我的观点是；对域进行建模，而不必担心数据将如何持久化到数据库中。这是将使用您的域模型的服务的一个问题。

回到存储库，看看这篇[文章](http://mikehadlow.blogspot.com/2008/03/using-irepository-pattern-with-linq-to.html)，了解 IRepository over LinqToSql 的良好解释。Mike 的博客上有许多其他关于 Repositories 的帖子。当你选择 ORM 时，我可以推荐 HHibernate 而不是 LinqToSql，后者现在已经不复存在，NHibernate 有一个很好的支持社区。

# c# - 将未知数量的列映射到字典

> ID：672840
> 
> 赞同：4
> 
> 时间：2009-03-23T10:19:57.327
> 
> 标签：c#, .net, nhibernate, mapping

我有一个遗留系统，可以在需要时动态地用额外的列来扩充一个表。现在我想通过 C#/NHibernate 访问该表。
无法更改遗留系统的行为，我需要动态处理附加列中的数据。因此，动态组件映射不是一个选项，因为我不知道附加列的确切名称。

有没有办法将所有未映射的列放入字典（列名作为键）？或者，如果这不是一个选项，将所有列放入字典中？

同样，我在编译时不知道列的名称，所以这必须是完全动态的。

例子：

```
public class History
{
    public Guid Id { get; set; }
    public DateTime SaveDateTime { get; set; }
    public string Description { get; set; }
    public IDictionary<string, object> AdditionalProperties { get; set; }
} 
```

因此，如果表 History 包含列*Id*、*SaveDateTime*、*Description*、*A*、*B*、*C*和*D*我想在 IDictionary 中有“A”、“B”、“C”和“D”。或者，如果这太难了，只需将所有列都扔在那里。

对于初学者来说，如果有帮助的话，我也可以只使用字符串列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-20T09:15:42.300

我想通过以下代码，您可以在 Hashtable 中获得结果：

```
var hashTable = (Hashtable)Session.CreateSQLQuery("SELECT * FROM MyTable")
    .SetResultTransformer(Transformers.AliasToEntityMap)
    .UniqueResult(); 
```

显然，您的所有数据都将从会话中分离出来......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T06:57:19.773

您可能需要一个 ADO.NET 查询来获取这些数据。如果您使用 NH，即使使用 SELECT * 进行 SQL 查询，您也不会获得列名。

您可以尝试使用 SMO（SqlServer 管理对象，SqlServer 的 .NET 端口）或其他方式来查找表定义。[然后，您使用Fluent NHibernate](http://fluentnhibernate.org/)和动态组件构建映射。我不确定您是否可以在使用会话工厂后更改映射。值得一试。祝你好运 ：-）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-14T10:39:35.423

What's not possible in sql is not possible in NHibernate.

It's not possible to write in insert query to insert into unknown columns.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T07:07:01.473

NHibernate 确实有获取数据库模式的方法，只要它受到数据库类型/方言的支持。它主要由 SchemaExport 和 SchemaUpdate 函数使用。

如果你不怕弄脏你的手；

首先查看 Configuration 类中的 GenerateSchemaUpdateScript 函数： [https ://nhibernate.svn.sourceforge.net/svnroot/nhibernate/trunk/nhibernate/src/NHibernate/Cfg/Configuration.cs](https://nhibernate.svn.sourceforge.net/svnroot/nhibernate/trunk/nhibernate/src/NHibernate/Cfg/Configuration.cs)

特别是，您会对该类感兴趣，该类在该方法中被引用： [https ://nhibernate.svn.sourceforge.net/svnroot/nhibernate/trunk/nhibernate/src/NHibernate/Tool/hbm2ddl/DatabaseMetadata.cs](https://nhibernate.svn.sourceforge.net/svnroot/nhibernate/trunk/nhibernate/src/NHibernate/Tool/hbm2ddl/DatabaseMetadata.cs)

DatabaseMetadata 对象将允许您遍历数据库中所有表和字段的元数据，从而确定哪些字段未映射。如果您再次查看 Configuration 类，它会在 TableMappings 集合中保存它的映射列表。从 GenerateSchemaUpdateScript 函数中获取提示，您可以将 TableMappings 中的 Table 对象与 DatabaseMetadata.GetTableMetadata 函数返回的任何实现 ITableMetadata 的对象进行比较，以确定哪些列未映射。

然后使用此信息重建“动态”类在运行时使用的映射文件，将所有动态/运行时字段放置在映射文件的“附加属性”动态组件部分中。映射文件需要作为外部文件而不是嵌入式资源来执行此操作，但这可以通过 Configuration AddFile 函数实现。重建后，重新加载配置，最后重建会话工厂。

目前，Firebird、MsSQL Compact、MsSQL、MySQL、Oracle、SQLite 和 SybaseAnywhere 似乎都有 ITableMetadata 的实现，因此只能使用其中一种实现（除非您自己实现）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-15T03:29:19.643

我假设您的程序`Configuration`在启动时通过读取 XML 文件构建单个对象，然后使用`Configuration`对象构建`ISessionFactory`对象。

但是，您的程序无需读取 XML 文件、构建`Configuration`对象并每天调用它，而是可以向数据库发送查询以找出该表上的任何额外列，然后以编程`Configuration`方式将列添加到将对象`DynamicMapping`编译为.`Configuration``ISessionFactory`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-13T04:17:34.787

我认为你能做的最好的事情是在运行时找到这些列，为这些额外的列创建一个映射，然后将输出写入一个 xmlfile。完成后，您可以在运行时添加映射...

```
ISessionFactory sessionFactory = new Configuration()
                  .AddFile("myDynamicMapping.hbm.xml") 
```

你将如何使用这个映射是一个很好的问题，因为你必须动态创建你的类，然后你就是 SOL

祝你好运。

# javascript - flot v0.5 是否支持 IE8 RTM？

> ID：672841
> 
> 赞同：1
> 
> 时间：2009-03-23T10:20:12.397
> 
> 标签：javascript, internet-explorer-8, flot

[flot v0.5](http://code.google.com/p/flot/)无法在 IE8 RTM 中正确呈现。我正在使用与 flot 一起打包的 excanvas 库（根据说明）。

项目[描述](http://code.google.com/p/flot/)声明支持 IE8，但没有提及哪种模式（兼容或标准）。

有没有人有使用 IE8 的 flot v0.5 的经验？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T11:54:29.487

我刚刚尝试在 IE 8 中加载[Flot 示例](http://people.iola.dk/olau/flot/examples/)。它仅在我启用兼容性视图按钮时才有效，这表明它目前仅在兼容模式下工作。

# c++ - 可以使用模板按名称访问结构变量吗？

> ID：672843
> 
> 赞同：19
> 
> 时间：2009-03-23T10:20:37.620
> 
> 标签：c++, templates

假设我有一个这样的结构：

```
struct my_struct
{
  int a;
  int b; 
} 
```

我有一个函数应该为“a”或“b”设置一个新值。此功能还需要指定要设置的变量。一个典型的例子是这样的：

```
void f(int which, my_struct* s, int new_value)
{
  if(which == 0)
     s->a = new_value;
  else
     s->b = new_value; 
} 
```

由于我不会在这里写的原因，我不能将指向 a/b 的指针传递给 f。所以我不能用 my_struct::a 或 my_struct::b 的地址调用 f。我不能做的另一件事是在 my_struct 中声明一个向量 (int vars[2]) 并将一个整数作为索引传递给 f。基本上在 f 我需要按名称访问变量。

上一个例子的问题是，将来我计划向 struct 添加更多变量，在这种情况下，我会记得向 f 添加更多 if 语句，这不利于可移植性。我能做的就是把 f 写成一个宏，像这样：

```
#define FUNC(which)
void f(my_struct* s, int new_value) \
{ \
        s->which = new_value; \
} 
```

然后我可以调用 FUNC(a) 或 FUNC(b)。

这会起作用，但我不喜欢使用宏。所以我的问题是：有没有办法使用模板而不是宏来实现相同的目标？

**编辑**：我将尝试解释为什么我不能使用指针并且我需要按名称访问变量。基本上，结构包含系统的状态。该系统需要在请求时“撤消”其状态。撤消是使用一个名为 undo_token 的接口来处理的，如下所示：

```
class undo_token
{
public:
   void undo(my_struct* s) = 0;
}; 
```

因此，由于多态性（mystruct 还包含其他类型的变量），我无法将指针传递给 undo 方法。

当我向结构中添加一个新变量时，我通常还会添加一个新类，如下所示：

```
class undo_a : public undo_token
{
  int new_value;
public:
  undo_a(int new_value) { this->new_value = new_value; }
  void undo(my_struct *s) { s->a = new_value}
}; 
```

问题是我在创建令牌时不知道指向 s 的指针，所以我无法在构造函数中保存指向 s::a 的指针（这本来可以解决问题）。“b”的类是一样的，只是我必须写“s->b”而不是s->a

也许这是一个设计问题：我需要每个变量类型一个撤消令牌，而不是每个变量一个......

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-23T10:47:51.020

要回答确切的问题，有，但它非常复杂，它纯粹是编译时的事情。（如果您需要运行时查找，请使用指向成员的指针 - 根据您更新的问题，您可能误解了它们的工作方式。）

首先，您需要一些可以在编译时用来表示“成员名称”的东西。在编译时元编程中，除整数之外的所有内容都必须由类型表示。因此，您将使用一个类型来表示一个成员。

例如，一个整数类型的成员存储一个人的年龄，另一个用于存储他们的姓氏：

```
struct age { typedef int value_type; };
struct last_name { typedef std::string value_type; }; 
```

`map`然后你需要在编译时进行查找的东西。让我们称之为`ctmap`。让我们最多支持 8 名成员。首先，我们需要一个占位符来表示字段的缺失：

```
struct none { struct value_type {}; }; 
```

然后我们可以前向声明 的形状`ctmap`：

```
template <
    class T0 = none, class T1 = none,
    class T2 = none, class T3 = none,
    class T4 = none, class T5 = none,
    class T6 = none, class T7 = none
    >
struct ctmap; 
```

然后我们专门针对没有字段的情况：

```
template <>
struct ctmap<
    none, none, none, none,
    none, none, none, none
    >
{
    void operator[](const int &) {};
}; 
```

稍后（可能）将清楚其原因。最后，所有其他情况的定义：

```
template <
    class T0, class T1, class T2, class T3,
    class T4, class T5, class T6, class T7
    >
    struct ctmap : public ctmap<T1, T2, T3, T4, T5, T6, T7, none>
    {
        typedef ctmap<T1, T2, T3, T4, T5, T6, T7, none> base_type;

        using base_type::operator[];
        typename T0::value_type storage;

        typename T0::value_type &operator[](const T0 &c)
        { return storage; }
}; 
```

这到底是怎么回事？如果你放：

```
ctmap<last_name, age> person; 
```

C++ 将`person`通过递归扩展模板来构建一个类型，因为`ctmap` *继承自自身*，并且我们为第一个字段提供存储，然后在继承时将其丢弃。当没有更多领域时，这一切都突然停止，因为全能专业化`none`开始了。

所以我们可以说：

```
person[last_name()] = "Smith";
person[age()] = 104; 
```

这就像在 中查找`map`，但在编译时，使用字段命名类作为键。

这意味着我们也可以这样做：

```
template <class TMember>
void print_member(ctmap<last_name, age> &person)
{
    std::cout << person[TMember()] << std::endl;
} 
```

这是一个打印成员值的函数，其中要打印的成员是类型参数。所以我们可以这样称呼它：

```
print_member<age>(person); 
```

所以是的，你可以写一个有点像 a `struct`，有点像 compile-time 的东西`map`。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-23T10:36:34.617

```
#include <iostream>
#include <ostream>
#include <string>

struct my_struct
{
    int a;
    std::string b;
};

template <typename TObject, typename TMember, typename TValue>
void set( TObject* object, TMember member, TValue value )
{
    ( *object ).*member = value;
}

class undo_token {};

template <class TValue>
class undo_member : public undo_token
{
    TValue new_value_;
    typedef TValue my_struct::* TMember;
    TMember member_;

public:
    undo_member(TMember member, TValue new_value):
        new_value_( new_value ),
        member_( member )
    {}

    void undo(my_struct *s) 
    { 
        set( s, member_, new_value_ );
    }
};    

int main()
{
    my_struct s;

    set( &s, &my_struct::a, 2 );
    set( &s, &my_struct::b, "hello" );

    std::cout << "s.a = " << s.a << std::endl;
    std::cout << "s.b = " << s.b << std::endl;

    undo_member<int> um1( &my_struct::a, 4 );
    um1.undo( &s );

    std::cout << "s.a = " << s.a << std::endl;

    undo_member<std::string> um2( &my_struct::b, "goodbye" );
    um2.undo( &s );

    std::cout << "s.b = " << s.b << std::endl;

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-01-05T00:01:38.237

除了[Daniel Earwicker 的回答](https://stackoverflow.com/a/672913/620438)之外，我们还可以使用新 C++ 标准中的可变参数模板来实现相同的目的。

```
template <typename T>
struct Field {
  typename T::value_type storage;

  typename T::value_type &operator[](const T &c) {
    return storage;
  }
};

template<typename... Fields>
struct ctmap : public Field<Fields>... {
}; 
```

此代码更简洁，并且没有固定的成员绑定。你可以以同样的方式使用它

```
struct age { typedef int value_type; };
struct last_name { typedef std::string value_type; };

ctmap<last_name, age> person;

person[last_name()] = "Smith";
person[age()] = 104; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-23T15:01:59.317

[Mykola Golubyev 的回答](https://stackoverflow.com/questions/672843/can-templates-be-used-to-access-struct-variables-by-name/672886#672886)很好，但可以通过使用指向成员的指针可以用作非类型模板参数的事实来稍微改进：

```
#include <iostream>
#include <ostream>
#include <string>

struct my_struct
{
    int a;
    std::string b;
};

template <typename TObject, typename TMember, typename TValue>
void set( TObject* object, TMember member, TValue value )
{
    ( *object ).*member = value;
}

class undo_token {};

template <class TValue, TValue my_struct::* Member>
class undo_member : public undo_token
{
        // No longer need to store the pointer-to-member
        TValue new_value_;

public:
        undo_member(TValue new_value):
                new_value_(new_value)
        {}

        void undo(my_struct *s) 
        { 
                set( s, Member, new_value_ );
        }
};    

int main()
{
    my_struct s;

    set( &s, &my_struct::a, 2 );
    set( &s, &my_struct::b, "hello" );

    std::cout << "s.a = " << s.a << std::endl;
    std::cout << "s.b = " << s.b << std::endl;

    undo_member<int, &my_struct::a> um1( 4 );
    um1.undo( &s );

    std::cout << "s.a = " << s.a << std::endl;

    undo_member<std::string, &my_struct::b> um2( "goodbye" );
    um2.undo( &s );

    std::cout << "s.b = " << s.b << std::endl;

    return 0;
} 
```

这减少了每个`undo_member`.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-23T10:29:37.177

我不确定为什么不能使用指针，所以我不知道这是否合适，但请看一下[C++: Pointer to class data member](https://stackoverflow.com/questions/670734/c-pointer-to-class-data-member)，它描述了一种可以将指针传递给 a 的数据成员的方法不直接指向成员的结构/类，**但后来绑定到结构/类指针**。（在海报编辑后添加的重点解释了为什么不能使用指针）

这样您就不会将指针传递给成员 - 相反，它更像是对象内的偏移量。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-23T10:42:22.997

听起来您正在寻找的东西称为“[反射](http://en.wikipedia.org/wiki/Reflection_(computer_science))”，是的，它通常是通过模板和宏的某种组合来实现的。请注意，反射解决方案通常很混乱且令人讨厌，因此您可能需要在深入研究代码之前对它们进行一些研究，以确定这是否*真的*是您想要的。

Google 上第二次点击“C++ 反射模板”是一篇关于“[通过模板元编程实现反射支持](http://lcgapp.cern.ch/project/architecture/ReflectionPaper.pdf)”的论文。那应该让你开始。即使它不是您正在寻找的东西，它也可能会向您展示解决问题的方法。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-23T10:24:24.537

你不能使用模板来解决这个问题，但为什么要首先使用结构呢？这似乎是 std::map 的理想用途，它将名称映射到值。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-23T10:42:30.190

根据您的描述，我猜您无法重新定义结构。

如果你这样做了，我建议你使用 Boost.Fusion 来用模板命名的字段来描述你的结构。有关这方面的更多信息，请参见[关联元组。](http://spirit.sourceforge.net/dl_more/fusion_v2/libs/fusion/doc/html/fusion/quick_start.html#fusion.quick_start.associative_tuples)这两种结构实际上可能是兼容的（内存中的组织相同），但我很确定没有办法从标准中获得这样的保证。

如果你不这样做，你可以创建一个结构的补充，让你可以像关联元组一样访问字段。但这可能有点口头上的。

**编辑**

现在很清楚，您可以按照自己的方式定义结构。所以我绝对建议你使用 boost.fusion。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-23T11:27:36.710

我想不出为什么在创建撤消命令时手头没有所有东西的原因。您希望能够撤消的，您已经完成了。因此，我相信您可以在创建撤消命令时使用指向类成员的指针，甚至可以使用指向特定类实例字段的指针。

你在你的编辑部分是对的。这*是*一个设计问题。

# api - 如何从办公室文件中读取作者信息？

> ID：672846
> 
> 赞同：1
> 
> 时间：2009-03-23T10:21:10.990
> 
> 标签：api, .net-2.0, ms-office

我在一个文件夹中有一堆 Office 2003 文档（.ppt、.doc、.xls），需要从每个文件中提取“作者”属性。最好的方法是什么，我可以使用某种（免费）office-api来阅读这些信息吗？

我正在使用 .NET 2.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T10:46:26.967

[这篇文章](http://bytes.com/topic/c-sharp/answers/757466-c-app-reading-modifying-ms-office-document-meta-data#post3027298)包含一些用于访问 MS Office 文件属性的代码。

一篇[codeproject 文章](http://www.codeproject.com/KB/files/SummInfoPropSetFile.aspx)- 它是用 c++ 编写的，但它可能很有用。

[这](http://www.xtractpro.com/articles/Office-Properties.aspx)看起来是最有前途的文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T11:07:13.327

我在 MSDN 上找到[了一篇](http://support.microsoft.com/kb/224351)关于 Dsofile.dll 的文章，它似乎按预期工作。仍然欢迎其他建议。

# innovation - 您如何在组织中促进创新？

> ID：672848
> 
> 赞同：0
> 
> 时间：2009-03-23T10:21:45.387
> 
> 标签：innovation

如今，创新似乎是一个流行词。每个组织都非常重视它，同时它也成为最辱骂的词。每一个新事物都不是创新。在我的组织中，也开始推动创新文化以及我如何参与其中。

我想知道您如何促进创新文化。是否有一些经过验证的方式促使人们以这种方式思考。我正在寻找一个答案，告诉我如何激励人们并给他们一些方向，以便他们扩展他们的想象力并提出新的想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T10:29:17.523

现有组织中的创新几乎总是会挑战现状。除非您非常幸运，否则您将需要一位资深人士来帮助您通过导致的政治雷区。假设你有，你的拥护者，一个好的创新方法是一种合理的激励，Ipod/Cash Prize怎么样，在一张纸上写下一个想法，你可以输入任意多次。

还要向你所有的新员工询问想法，他们是无价的，因为他们不知道什么是不能做的，他们没有被你的文化所影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T10:42:30.190

创新不是可以推广的东西，因为推广本质上是在兜售“创新”是好的、有价值的理念。尽管您的大多数员工可能都同意这一点，但它不会使事情发生变化。

你需要做的是营造一个有利于创新的环境。消除现在不允许员工创新的障碍和障碍。晋升通常是为了奖励一些可取的行为，但你不需要奖励创新，因为它本身就是一种奖励。

我曾经目睹过太多这样的情况，管理层说：“好吧，伙计们，现在开始给我们你所有的伟大和创新的想法，我们将进行某种竞争，最好的想法的发起者将获得奖金。” 这在很多层面上都是错误的：

*   创新是一个过程，创意只是一个结果。将过程和环境简化为最终结果是错误的。因为你不能通过简单地向她承诺一辆车来贿赂你的孩子成为一个著名的歌手。你需要先创造一个支持她成为歌手的环境，然后她可能会也可能不会成为明星。

*   想法很便宜；将想法融入生活是很困难的。纯粹的思想实验不会带来创新，需要将资源、时间和金钱投入到真正的实验中。

*   一些最好的想法直到被发明和实施很长时间后才能被评估。

*   创新并不是您真正希望您的员工参与竞争的领域，恰恰相反——合作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T10:28:09.240

在进行此活动时，您需要非常小心。很难激发人们以不同的方式思考。如果您试图激励高级开发人员，这将变得不可能。一种方法是——以身作则。找到您所在领域或领域中每个人都知道的问题。如果您可以以不同的方式解决该问题，请在论坛中谈论它。看看人们是否对此感到兴奋？只有这样，你才能激发人们的火花。虽然那时我还是失败了。我想到了一个好主意，我与人们分享并要求他们提出解决方案。但是人们并没有花时间在上面，最后我不得不解决问题并指导他们实施。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T10:51:52.897

您需要使组织中的每个人都可以轻松地与您联系并在源头内进行交流。您需要能够让人们提出想法，讨论想法，而无需通过主管等。

定期投票、竞赛和奖项，例如几个月的最佳创意将帮助员工在这里和那里进行头脑风暴。

为了让您的员工具有创新性，我认为他们需要良好的沟通形式，并能够向组织发布建议。匿名。

每个月左右，你应该有一组专门的人来检查每个想法并[筛选](http://en.wikipedia.org/wiki/Screening)它们。如果您为最佳创意颁发奖项和奖励，我认为您将在您的组织中促进创新文化。

我也认为实际花费一些资源是一个非常好的主意。创新非常重要，如果此时无法在您的组织中实现更好的想法，则应给出解释。将呈现给您的许多想法很可能是好的，但没有经过适当的考虑，并且许多人无法看到大局，这就是为什么解释为什么这将非常困难和需要资源是一个好主意接通。

编辑：确保你不要因为投入资源成本高昂而预先放弃所有想法。如果您认为一个想法可能不错，但可能代价高昂，那么该想法可能值得进一步研究。最终，您希望您的企业为未来做好准备，并能够扩展和成长。如果您没有创新并且能够将一些想法付诸实践，那么从长远来看，这不会发生。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-06T22:02:20.397

榜样效应是促进创业思维和创新倾向最具感染力的方式……这与以身作则不同。它更多是关于授权、支持和认可需要情境领导力的批判性和创造性思维。情境领导意味着团队形成阶段的励志风格，团队风暴阶段的权威风格，团队规范阶段的导师风格和团队执行阶段的共识风格。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T11:13:00.833

如果我有一家公司，我会创建一个内部论坛，我的员工可以在这里发表他们的想法，他们的同事可以在那里提出建设性的批评。

我也会给我的员工时间（即 Google 的 20%）来研究他们热衷的想法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T11:16:58.750

我对编程充满想象力、新想法和热情。不幸的是，在我工作的地方没有人想要我。人们只是拥有一个软件，他们进一步开发和维护它，避免任何主动性。

更糟糕的是，当你不能让你的员工具有创新性或公司不希望/不需要他们的员工具有创新性时？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-29T21:36:03.003

创新对于实现个人和组织的成长是必要的。
为什么创新是当今的流行语？答：因为
1\. 削减成本不是实现增长或利润的方法。当今世界正处于为了盈利而进行过多成本削减的地步。
2、产品和服务的生命周期因竞争激烈而缩短。只有创新的产品和服务才能引领市场。但为了保持竞争力，我们会在衰退时进行创新。
3\. 技术和商业模式的变化开辟了执行某些任务的新途径。它创造了技术创新和商业模式创新。

# sql-server-2008 - SQL Server 代理 - 作业可以询问有关自身的信息

> ID：672852
> 
> 赞同：0
> 
> 时间：2009-03-23T10:23:20.767
> 
> 标签：sql-server-2008

我想没有人知道 SQL Server 代理作业是否可以询问有关自身的信息，例如它自己的 ID 或它运行的路径？我知道，`xp_sqlagent_enum_jobs`但这`sp_help_job`无济于事，因为您必须指定作业 ID。

我们的想法是，我们希望通过能够调用将识别当前作业的存储过程来管理我们不必管理的代码。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T08:39:27.807

是的，但它并不漂亮。

查看 sys.sysprocesses（或 SQL 2000 及更低版本中的 dbo.sysprocesses）。程序名称将是 SQL Agent 的东西，最后是一个二进制值。该二进制值是作业 guid 的二进制值。因此，将该值子串出并针对 msdb.dbo.sysjobs 表进行查找以找出它是什么工作（您需要将 sysjobs.job_id 强制转换为 varbinary(100) 以获得匹配的值）。

我告诉过你它不漂亮，但它会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-12T06:08:07.270

讨厌！！！但我认为它可能会工作......

例如。**在**工作中使用-`select * from msdb..sysjobs where job_id = dbo.fn_currentJobId()`

让我知道。

```
create function dbo.fn_CurrentJobId()  
returns uniqueidentifier  
as  
begin  
 declare @jobId uniqueidentifier  

 select @jobId = j.job_id  
 from master..sysprocesses s (nolock)   
 join msdb..sysjobs j (nolock)  
   on (j.job_id = SUBSTRING(s.program_name,38,2) + SUBSTRING(s.program_name,36,2) + SUBSTRING(s.program_name,34,2) + SUBSTRING(s.program_name,32,2) + '-' + SUBSTRING(s.program_name,42,2) + SUBSTRING(s.program_name,40,2) + '-' + SUBSTRING(s.program_name,46,2) + SUBSTRING(s.program_name,44,2) + '-' + SUBSTRING(s.program_name,48,4) + '-' + SUBSTRING(s.program_name,52,12) )
 where s.spid = @@spid  

 return @jobId  
end  
go 
```

谢谢你的信息

# java - 如何在 Java 中使用正则表达式验证姓名、中间名和姓氏？

> ID：672855
> 
> 赞同：0
> 
> 时间：2009-03-23T10:24:31.947
> 
> 标签：java, regex, validation

我得到一个名字列表，需要验证它们。一些例子：

*   伊丽莎白·T·邦
*   伊丽莎白·邦
*   扎基 MF El-Adawy
*   约瑟夫·m。小牧师
*   扎基 MF El-Adawy

如何在 Java 中使用正则表达式来验证它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T16:12:01.630

为什么需要验证名称？捕捉拼写错误或人们只是捣碎键盘？拒绝一个名字不寻常的合法客户真的值得冒险吗？有没有中间名或不止一个名字的人，只有一个名字的人，坚持到处使用他们的头衔的人，当然还有各种非ASCII字符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T10:26:34.113

我首先列出规定有效名称的规则。只是简单的古英语。我怀疑您最终会遇到一组非常复杂的规则和例外情况。一旦你弄清楚了这一点，你就可以准备编写一个正则表达式来匹配它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T15:47:20.847

如果您使用 Eclipse，您可能会发现[QuickREx Eclipse 插件很有帮助。](http://www.bastian-bergerhoff.com/eclipse/features/web/QuickREx/toc.html)每当我测试和开发复杂的正则表达式时，我都会使用它。它允许您指定测试输入、查看所有匹配组等。

# c# - Python 比 Java/C# 慢吗？

> ID：672857
> 
> 赞同：72
> 
> 时间：2009-03-23T10:26:13.490
> 
> 标签：c#, java, python, performance

Python 比 Java/C# 慢吗？

[性能比较-c-java-python-ruby-jython-jruby-groovy](http://blog.dhananjaynene.com/2008/07/performance-comparison-c-java-python-ruby-jython-jruby-groovy/)

这是一个优化CPython的项目：[unladen-swallow](http://code.google.com/p/unladen-swallow/)

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-03-23T11:25:08.823

不要将语言和运行时混为一谈。

Python（该语言）有许多运行时实现。

*   CPython 通常被解释，并且会比本地代码 C# 慢。它可能比 Java 慢，具体取决于 Java JIT 编译器。

*   JYthon 在 JVM 中进行解释，并具有与 Java 相同的性能配置文件。

*   IronPython 依赖与 C# 相同的 .NET 库和 IL，因此性能差异会相对较小。

*   Python 可以通过 PyREX、PyToC 等翻译成本地代码。在这种情况下，它的性能通常与 C++ 一样好。您可以 - 在一定程度上 - 进一步优化 C++，并且可能会比 PyREX 的未优化输出获得更好的性能。

    有关详细信息，请参阅[http://arcriley.blogspot.com/2009/03/so-long-pyrex.html](http://arcriley.blogspot.com/2009/03/so-long-pyrex.html)

请注意，Python（语言）并不慢。一些 Python 运行时（例如 CPython）会比本地代码 C++ 慢。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2009-03-23T11:30:48.873

问为什么 Python 比 Java/C# 慢是不正确的。Java有多快？好吧，幼稚的解释器比优化的编译器慢十倍左右。我相信有一个用 JavaScript 编写的 Java 字节码解释器——它可能不是很快。因此，预期的问题似乎是“为什么 CPython 语言系统比同等的 Sun、IBM 和 Oracle JRE 以及 Microsoft .NET 运行时慢？”

我相信正确的答案是非技术性的。最快的 Java 和 .NET 运行时速度更快，因为它们拥有庞大的全职技术团队在性能竞争环境中开发它们。

动态语言系统很容易实现。任何白痴都可以做到。我有。静态语言系统的设计和实现更加复杂。一个简单的静态系统往往比等效的刚刚工作的动态等效系统运行得更快。然而，高度优化的动态系统有可能运行得几乎一样快。我知道一些 Smalltalk 实现非常好。一个经常被引用的开发动态系统的例子是[MIT Lisp Machine](http://en.wikipedia.org/wiki/Lisp_machine)。

此外，如果真正的咕噜声是由库代码完成的，那么语言系统可能并不重要。或者，该语言可能会鼓励（或给予时间（！））开发更有效的算法，这些算法可以轻松消除常数因子的性能差异。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2009-07-24T13:13:11.070

正如其他答案中提到的，这取决于运行时系统以及手头的任务。所以标准的 (C)Python 不一定比 Java 或 C# 慢。它的一些模块是用 C 实现的。因此将*本机*实现的速度与 Python 的语言相结合。

我们做了一个小实验：我们比较了不同语言的阶乘计算的执行时间。该测试实际上旨在评估任意精度整数实现的性能。

```
受测者。语言任意精度整数运行时

     1.Java java.math.BigInteger JRE 6.13
     2\. .NET System.Numerics.BigInteger MS CLR 4.0
     3\. Python long Active Python 2.6.2.2
     4\. 吱吱声 BigInt 吱吱声 3.10.2
     5\. .NET Mono.Math.BigInteger MS CLR 4.0

结果：

                 1) 2) 3) 4) 5)
   10.000！343 毫秒 137 毫秒 91 毫秒 1.200 毫秒 169 毫秒
   20.000！1.480 毫秒 569 毫秒 372 毫秒 1.457 毫秒 701 毫秒
   30.000！3.424 毫秒 1.243 毫秒 836 毫秒 3.360 毫秒 1.675 毫秒
   40.000！6.340 毫秒 2.101 毫秒 1.975 毫秒 6.738 毫秒 3.042 毫秒
   50.000！10.493 毫秒 3.763 毫秒 3.658 毫秒 10.019 毫秒 5.242 毫秒
   60.000！15.586 毫秒 7.683 毫秒 5.788 毫秒 14.241 毫秒 10.000 毫秒

```

[替代文字 http://www.mycsharp.de/wbb2/attachment.php?attachmentid=6909&sid=0d5aa62b522d005d9e7089785b5d19f1](http://www.mycsharp.de/wbb2/attachment.php?attachmentid=6909&sid=0d5aa62b522d005d9e7089785b5d19f1)

条形图显示结果。Python 是明显的赢家。据我所知，Python 使用[Karatsuba 算法](http://en.wikipedia.org/wiki/Karatsuba_algorithm)来乘以大整数，这解释了速度。

此外，Python 的“任意精度整数”类型是内置的`long`. 因此，您甚至不需要 Java 的 BigInteger 类所需的特殊类型处理。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2013-07-22T15:08:47.893

简单地说，**Python 很慢**。

无论您使用哪种解释器（当前可用），它都比 Java 和 C 慢。在各种基准测试中，它比 Ruby 和 PHP 慢。不要依赖别人的答案，检查并验证自己。

[http://benchmarksgame.alioth.debian.org/u64q/benchmark.php?test=all&lang=python3&lang2=java&data=u64q](http://benchmarksgame.alioth.debian.org/u64q/benchmark.php?test=all&lang=python3&lang2=java&data=u64q)

就我个人而言，我不认为，在让 python 更快方面做出了很多重要的贡献和开发。由于 python 的生产力很好并且它直接解决了一些问题，所以速度/性能没有被认真对待。还有一些架构问题也阻止了 Python 进行性能调整。

**免责声明**- 这个答案可能会伤害 Python 爱好者。我也是 Python 开发人员，喜欢在 Django/Flask/Pyramid 而非 Spring (Java) 中开发 webapps。但我实际上在我的工作和经验中看到，Python 是如何变慢的。速度并不总是我的首要任务。但我确实支持他们，他们说 Python 解释器应该上油和润滑或更换发动机，以至少在马拉松比赛中站稳脚跟。它是一种主流的编程语言。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-03-23T10:30:51.467

正如评论中所建议的那样，您确实应该提供一个测试用例来进行推理。性能差异背后的原因将根据正在执行的测试而改变。

但是，我建议静态与动态性质可能与它有很大关系。对于非虚拟调用，JIT 编译的 C#/Java 非常便宜，因为它可以在 JIT 时间准确确定。即使是虚拟呼叫也只涉及单级重定向。当绑定变得动态时，需要考虑的事情范围更广。

我不知道有关 Python 的足够详细信息，无法声称了解其确切的运行时行为，我怀疑这也可能因版本和实现而异。有“python 字节码”之类的东西，然后由虚拟机执行——这个虚拟机是否真的执行 JIT 编译是另一回事。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-03-23T12:19:45.307

归结为编译阶段需要处理的信息较少，因此运行时需要在鸭类型（动态类型）语言的情况下做更多的工作。

因此，如果我正在调用 foo.bar()，在 Java 或 C++ 的情况下，可以通过发现“foo”的类型，然后直接在内存位置调用方法，在编译过程中优化对 bar 的调用。编译器知道它会被找到。由于 python 或任何其他动态类型语言编译器不知道对象 foo 属于什么类型，它必须在运行时进行类型检查，然后查找 bar 方法的地址，然后调用它。

Python 编译器编写者也遇到了其他困难，尽管上面的那个希望足以说明问题。因此，即使有最好的编译器编写者，静态类型语言也可能在运行时表现得更好。

动态类型语言得分通常在开发时间。由于要编写和维护的代码行数更少，并且开发人员没有编译等待时间，因此开发速度通常要快得多。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-03-23T11:47:26.820

你在那里得到的是用 Python 编写 Java 的明确示例：

```
 def __init__(self,size):  
     self.first = None  
     last = None  
     for i in range(size):  
         current = Person(i)  
         if self.first == None : self.first = current  
         if last != None :  
             last.next = current  
             current.prev = last  
         last = current  
     self.first.prev = last  
     last.next = self.first 
```

更多的pythonic：

```
 def __init__(self,size):  
     chain = [Person(i) for i in range(size)]
     self.first = chain[0]
     chain = zip(chain, chain[1:].append(chain[0]))
     for p,n in chain:
        p.next = n
        n.prev = p 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-03-23T13:53:00.137

我认为最终是 Python 没有尽其所能进行优化。大多数常见的优化技术都是针对静态语言的。动态语言有*一些*优化技术，但现代语言似乎并没有尽可能多地使用它们。Steve Yegge 有一篇关于这个主题的优秀[博客文章](http://steve-yegge.blogspot.com/2008/05/dynamic-languages-strike-back.html)。

**编辑**：我只是想指出，我不一定说这是对 Python 的批评。任何一天，我都更喜欢简单而不是不必要的速度。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-03-23T13:30:40.130

这与语言本身没有任何关系，只是 Java**实现**和**运行时系统**(JVM) 的质量非常高，而且多年来在稳定性、可扩展性和性能改进方面投入了大量资源。

相比之下，CPython 实现最近才在其解释器中实现了线程调度，这使得它在某些问题上的性能提升高达 20%。这听起来不是一件好事，这很糟糕，因为这种基本优化从一开始就应该存在。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-23T10:33:41.817

我认为相反。我可以用 Python 比用 Java 更快地编写简单的程序，而且这些 Python 脚本运行得非常快。

当然，没有示例的问题很难回答。也许您发现了慢库、错误等。请给我们更多详细信息。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-04-26T16:55:02.400

由于它是解释的而不是编译的..它的执行时间应该更慢。

作为*代码完成（第二版）*书第 600 页中提到的表格，

*C# 在执行时间*上等于 C++ (1:1)。*而且 Python 在执行时间*上比 C++ 慢一百倍以上（>100:1）。

Java 比 C++ 慢一倍半 (1.5:1)。

这些统计数据是平均的。我不知道谁做了这项研究，但似乎很有趣。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-07-22T12:58:01.963

仅通过定性推理无法回答此类问题，您需要良好的基准来支持它。这是一组比较[Python 3 与 C# Mono](http://shootout.alioth.debian.org/u32q/benchmark.php?test=all&lang=python3&lang2=csharp&box=1)并发现 Python 慢 3 到 300 倍的集合。Python 与 Java 的结果相似。（适用于解释基准的通常注意事项。）

这些基准还报告了源代码大小，Python 比 Java 和 C# 简洁得多。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-23T13:04:06.370

我认为编写 Python 代码的简便性使得编写更复杂的代码成为可能。例如，利用多核处理器的代码。由于在过去的 5 到 10 年中，每核性能基本停滞不前，我认为 Python 程序（无论它们是在 CPython 还是其他东西上运行）从长远来看并不明显。

# math - 单位范围 [0->1] 的清晰/标准名称

> ID：672860
> 
> 赞同：7
> 
> 时间：2009-03-23T10:27:11.037
> 
> 标签：math, range, naming

我现在正在写一个 Range 类，我正在为公共范围 [0->1] 寻找一个好名字。如果它是一个长度为 1 的向量，我会称它为单位向量。是否有明确的名称来给出这个范围/间隔？可能是*单位范围*？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-23T13:08:54.503

[0,1] 之间的闭合范围通常称为[闭合单位区间](http://mathworld.wolfram.com/UnitInterval.html)。如果不包括端点，它将是开放单位间隔。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T10:33:22.643

我会选择间隔，因为它听起来比“单位范围”更好:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T10:33:15.717

*正常范围*怎么样？

# c++ - 导入父类的所有变量

> ID：672881
> 
> 赞同：4
> 
> 时间：2009-03-23T10:34:00.490
> 
> 标签：c++, gcc, templates, scope

您可能已经注意到，更高版本的 gcc 对标准更加严格（[参见这个问题](https://stackoverflow.com/questions/605497/accessing-inherited-variable-from-templated-parent-class)）

模板类的所有继承成员都应使用全名调用，即。 `ParentClass<T>::member`而不仅仅是`member`

但是我仍然有很多不尊重这一点的旧代码。为每个类中的每个使用过的成员添加`using ParentClass<T>::member`是相当痛苦的。有没有办法做类似的事情`using ParentClass<T>::*`？我希望这比在 g++ 中停用此检查更好，但如果现在有办法，我该如何停用它？

**编辑**：

根据 C++ FAQ（谢谢），这些是正确解决继承的成员变量名称的唯一方法：

1.  将呼叫从 更改`f()`为`this->f()`。由于 this 在模板中始终是隐式依赖的，`this->f`因此是依赖的，因此查找被推迟到模板被实际实例化，此时所有基类都被考虑在内。

2.  插入`using B<T>::f`；就在打电话之前`f()`。

3.  将调用从 f() 更改为`B<T>::f()`.

所以现在正在寻找正确的开关来停用全名解析......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T10:46:43.597

不是你问题的真正答案，但你[也可以写](http://www.parashift.com/c++-faq-lite/templates.html#faq-35.19) `this->member`而不是`ParentClass<T>::member`. 这通常更容易编写，并使编译器`member`在正确的位置查找。

# vb.net - 如何从文本框中的字符串中删除一项

> ID：672888
> 
> 赞同：0
> 
> 时间：2009-03-23T10:36:54.040
> 
> 标签：vb.net

我有一个 2 列的网格视图。

第一个字段包含名为 chkSelect 的复选框，第二列是与 EmailId 绑定的标签。

```
<asp:GridView ID="gvwNewsLetter" runat="server" AutoGenerateColumns="false" DataKeyNames="UserID">
<Columns>

<asp:TemplateField HeaderText="Select">
    <ItemTemplate>
    <asp:CheckBox ID="chkSelectMail" runat="server" />
    </ItemTemplate>
</asp:TemplateField>

<asp:TemplateField HeaderText="EmailID">        
    <ItemTemplate>
    <asp:Label ID="lblEmail" runat="server" Text='<%#Eval("EmailID")%>' ></asp:Label>
    </ItemTemplate> 
</asp:TemplateField>

</columns>
</asp:GridView> 
```

当我选中每个复选框时，我必须在 gridview 之外的 textarea 中的相应行中显示 mailid，例如“abc@gmail.com,sdf@gmail.com”。如果我取消选中中间，我必须从文本框中删除该特定 ID。任何人都可以在取消选中复选框时帮助提供删除mailid的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T10:40:31.723

每次选中/取消选中复选框时，您不能只重建整个字符串吗？可能比每次尝试解析和修改现有字符串要快。

# silverlight-2.0 - Silverlight 有什么缺点吗？

> ID：672889
> 
> 赞同：8
> 
> 时间：2009-03-23T10:38:26.190
> 
> 标签：silverlight-2.0

我们计划使用 Silverlight 2.0 开发基于 Web 的应用程序。该应用程序将由我们公司的员工使用。该应用程序将使用 IE6（是的 IE6）访问，并且未安装 Silverlight。

我们将通过我们的 IT 支持向所有用户推出 Silverlight。所有员工都使用 Windows。

在使用 Silverlight 开发此应用程序之前，我还有什么需要考虑的吗？

有什么缺点吗？IE6会有性能问题吗？我应该升级到 IE7/IE8 吗？

此应用程序将由打开 10 个电子表格和应用程序的企业使用。512MB 是员工 PC 可用的标准内存。在 IE6 中使用 Silverlight 会不会很重？会不会导致系统死机？

还有什么我应该考虑的吗？

编辑：在马克的第一个回答之后。是否有任何“压力测试”应用程序可用于检查我们用户的 PC 版本？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T10:45:06.157

需要考虑的一个问题是，Silverlight 仍然是一项非常新的技术，需要解决一些错误（在 SO 中搜索 silverlight 标签以找到一对 - 调整列表框大小是最令人震惊的）。

我还没有使用 Silverlight 3，所以我不知道有多少已经解决，但请注意，在不久的将来您可能需要进行一些黑客攻击/解决方法。

此外，Silverlight 是 Web 框架的重量级方面，如果您的客户使用更严格的硬件和软件，那么 ASP.NET / AJAX 解决方案可能更合适。也许尝试构建一个“压力测试”Silverlight 应用程序（具有大量控件和频繁的服务器访问），以查看性能影响是否太大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T11:05:27.263

1.  与 Flash 一样，只要您的应用程序通过桌面浏览器使用，一切都很好。一旦有人试图通过手机或小型笔记本电脑访问某些东西，您可能会遇到困难。特别是如果您的 silverlight 矩形大于屏幕尺寸并且用户无法调整。与 Flash 一样，解决此问题的一种方法是将您的应用程序设置为 100% 的屏幕尺寸。但是，在大屏幕上，这也可能使您的应用程序无法使用。

2.  另一个考虑因素是用户将无法链接到应用程序的特定部分。默认情况下，地址栏中的 URL 在整个应用程序的用户体验中保持不变。但是，这*可以*通过大量使用 html #anchor 点来解决，就像 Gmail 所做的那样。这提供了使浏览器后退按钮也可以工作的额外好处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-20T12:44:00.327

由于依赖于它的 Intranet 应用程序，许多公司已经将自己锁定在 IE6 中。我担心 Silverlight 会引入同样的问题。

将来，您可能会发现（无论出于何种原因（成本、安全性、应用程序的可用性等）将一些用户移动到 Silverlight 不支持的平台会更好——除非您不能这样做，因为他们需要访问该平台） Web应用程序。

The joy of a well written web application is that all you need to use it is a browser. A little scripting can automate it. You can access it on a desktop, a phone, a TV or a fridge. Etc.

Silverlight is vendor lock-in at a time when open web technologies are maturing rapidly and isn't a path I would head down.

# windows - 从网络共享复制时出错“此页面存在未指明的潜在安全漏洞。”

> ID：672890
> 
> 赞同：2
> 
> 时间：2009-03-23T10:38:58.247
> 
> 标签：windows, windows-xp

我最近重新安装了 XP，然后重新安装了 SP3，当我尝试从网络共享中复制某些内容时，我目前遇到了错误。

```
Title: Internet Explorer
Message: This page has an unspecified potential security flaw.
         Would you like to continue? 
```

我相信它与[KB921398 (MS06-045)](http://support.microsoft.com/kb/921398)有关，我目前正在卸载 SP3，但有谁知道是否有其他方法可以禁用此特定更新？它不会出现在“添加和删除程序”中。

通过在 Internet Explorer 的安全设置中将任何网络 IP 掩码添加到受信任的 Intranet 区域来临时修复，但这不是修复 :(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T18:42:17.167

> 通过将任何网络 IP 掩码添加到受信任的 Intranet 区域来临时修复

这才是真正的解决办法。当您尝试将文件复制到 Internet 区域之外时，会出现错误消息。如果您真的将文件从公共 Internet 网络共享中拖出，这确实是有风险的，因此该消息并没有真正错误（只是模糊和误导）。

为了避免在您的 Intranet 中弹出错误 - 并且因为无论如何这是正确的做法 - 您需要确保 Windows 将 Intranet 视为在本地 Intranet 区域中。

转到控制面板 -> Internet 选项 -> 安全 -> 本地 Intranet -> 站点。如果勾选了“自动检测 intanet 网络”，请取消勾选，因为显然自动检测不起作用。打开前两个；如果您确定永远不会访问 Intranet 之外的网络共享（例如，因为防火墙阻止了它），您可以勾选“包括所有网络路径”。

如果这不起作用，请将文件夹路径添加为受信任的本地 Intranet 站点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-25T23:06:33.137

这是正确的解决方法，因为 IE 和 Windows 资源管理器之间存在联系。我发现这是一个巧妙的技巧，因为我们所有的服务器都将它们的 Windows 共享导出到一个公共子网上。将这一行添加到 Intranet Setting "File://192.168.0.*"（更改为正确的子网）。

# asp.net - 云中的 Windows 服务

> ID：672894
> 
> 赞同：2
> 
> 时间：2009-03-23T10:40:27.870
> 
> 标签：asp.net, windows-services, azure, cloud

我正在考虑为 web 2.0 启动站点编写一个应用程序，该站点将必不可少地监视特定的 RSS 提要。

由于这种服务的预期使用率，我期望利用云计算将是实现它的方法，但是由于我缺乏经验，我不知道是否可以在云中运行 Windows 服务。

这将有一个网络前端，但没想到会有很重的负载，因为它只是用于注册，然后用户将通过 SMS/Email 接收通知

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T10:54:52.313

使用 Azure 时，您可以在云中运行“服务”。它被称为“工人角色” [，请参见此处的架构](http://msdn.microsoft.com/en-us/library/dd179341.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T10:55:46.350

如果您正在考虑运行 Windows Azure（它分为 Web 角色和辅助角色）。您必须注册一个 Azure 密钥（我相信 Bizspark 包包括一个）才能开始，下载 SDK 和 Azure 工具。

看起来您实际上只需要 web 角色，在这种情况下，它只是一个您可以正常编写的普通 ASP.NET / MVC 站点。

从本质上讲，您在这里获得的好处是能够通过调整配置文件来增加运行您的应用程序的服务器实例的数量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T10:46:18.107

设法找到这个在云中发布 WCF 服务的链接。我是 WCF 的新手，所以不确定它是否会提供我需要的解决方案，它可能会，但我需要做更多的研究

[http://geekswithblogs.net/bloesgen/archive/2008/12/21/128098.aspx](http://geekswithblogs.net/bloesgen/archive/2008/12/21/128098.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T11:06:53.703

另一个选项是 Amazon EC2 Cloud，它允许您根据需要实例化尽可能多的 Windows2k3 数据中心版本的实例。我在这样的实例上运行 Windows 服务、IIS、Postgresql 等，没有任何问题。

# database - 如何正确填充年龄属性？

> ID：672897
> 
> 赞同：0
> 
> 时间：2009-03-23T10:41:52.047
> 
> 标签：database, tsql

我有一个跟踪多个客户端的 MS-SQL Server。如果生日已知，则将其存储为名为 的日期时间属性`dayOfBirth`。现在我想要另一个属性年龄，它跟踪客户的当前年龄。由于年龄可以随时改变，我认为脚本可能是最好的主意。

我做的第一件事是创建一个存储过程，它计算给定生日的年龄作为日期时间。这是我想出的：

```
USE [MyDB]
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE CalculateAge
@dayOfBirth datetime,
@age INT OUTPUT
AS

DECLARE @today datetime, @thisYearBirthDay datetime
DECLARE @years int

SET @today = GETDATE()
SET @thisYearOfBirth = DATEADD(year, @dayOfBirth, @today), @dayOfBirth)
SET @years = DATEDIFF(year, @dayOfBirth, @today) - (CASE WHEN @thisYearBirthDay > @today THEN 1 ELSE 0 END)
SET @age = @years 
```

之后，我创建了另一个脚本，它遍历所有具有非空 dayOfBirth 属性的记录，并相应地更新填充的年龄。

```
USE [MyDB]
GO

DECLARE @age int;
DECLARE @birth datetime;
DECLARE @id intl
DECLARE cursorQuery CURSOR FOR SELECT clientId FROM Clients WHERE dayOfBirth IS NOT NULL;

OPEN cursorQuery

FETCH NEXT FROM cursorQuery INTO @id

WHILE @@FETCH_STATUS = 0
BEGIN
    SET @birth = (SELECT dayOfBirth from Kunden where clientId=@id);
    EXEC dbo.CalculateAge @birth, @age OUTPUT;
    UPDATE Clients SET Age = @age WHERE clientId = @id;
    FETCH NEXT FROM cursorQuery INTO @id
END

CLOSE cursorQuery
DEALLOCATE cursorQuery 
```

我会每天触发一次上面的脚本来填充年龄属性。到目前为止，这就是我所拥有的，但我觉得还有很大的改进空间。

** 感谢宋大师 **

我最终得到了这样的结果：

```
CREATE TABLE Client (

ID int identity(1,1) primary key,
DOB datetime null,
AGE as (case
    when DOB is null then null
    else DATEDIFF(YY,DOB,GETDATE()) - CASE WHEN (MONTH(GETDATE()) = MONTH(DOB) AND DAY(DOB) > DAY(GETDATE()) OR MONTH(GETDATE()) > MONTH(DOB)) THEN 1 ELSE 0 END
    end
    )
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T10:47:56.697

您真的不应该将年龄存储在数据库中，因为它很容易计算并且每天都在变化。

我建议您保留出生日期字段并根据需要计算年龄。如果您希望将年龄与其他属性一起选择，那么考虑一个视图，也许使用用户定义的函数来计算年龄。

以下是您可以使用的示例（未经测试）UDF

```
CREATE FUNCTION age 
(
    @userId int
)
RETURNS int
AS
BEGIN

    DECLARE @Result int

    SELECT @Result = DATEDIFF(year, dateofBirth, getDate())
    FROM    person
    WHERE   userId = @userId

    RETURN @Result

END
GO 
```

然后在您的查询中，您可以执行类似于以下的操作，

```
SELECT *,
       dbo.age(userId) as age
FROM   person 
```

在回答您关于排序等的问题时，您可以创建数据视图并使用它来显示数据，如下所示（未经测试）

```
CREATE VIEW personview(firstname, surname, dateOfBirth,age) AS 

SELECT firstname,
       surname,
       dateOfbirth,
       dbo.age(userid)
FROM   person 
```

然后，您可以使用此视图执行查询，根据年龄进行过滤和排序可能会降低性能，如果您定期根据年龄字段进行排序/过滤，那么您可能需要创建索引视图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T13:29:09.743

与其创建触发器并进行任何手动更新，最简单的解决方法是创建**一个**名为`Age`.

这样，您就不必担心 Age 数据不同步（数据保持一致），并且不再需要触发器或手动更新。

如下图所示，计算人的年龄可能有点麻烦。

![替代文字](https://farm4.static.flickr.com/3571/3378445765_88e356b5f8_o.png)

这是使用的文本

```
create table #Person (
ID      int identity(1, 1) primary key,
DOB     datetime null,
Age     as 
        (case 
                when DOB is null then null
                --; Born today!
                when datediff(d, DOB, getdate()) = 0 then 0
                --; Person is not even born yet!
                when datediff(d, DOB, getdate()) < 0 then null
                --; Before the person's B-day month so calculate year difference only
                when cast(datepart(m, getdate()) as int) > cast(datepart(m, DOB) as int) 
                    then datediff(year, DOB, getdate())
                --; Before Person's b-day
                else datediff(year, DOB, getdate()) - 1
            end)
)
insert  #Person select GetDate()
insert  #Person select null
insert  #Person select '12/31/1980'

select  * from  #Person

update  #Person
set     DOB = '01/01/1980'
where   ID = 2

select  * from  #Person 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T11:01:29.847

使用视图和/或函数。如果您能提供帮助，切勿存储基于完全相同数据的两个字段，因为它们最终会不同步。

# c++ - C++：如何从快捷方式打开 IShellFolder 驱动器文件夹

> ID：672899
> 
> 赞同：1
> 
> 时间：2009-03-23T10:42:26.320
> 
> 标签：c++, windows, shell-extensions

我在快捷方式中使用以下命令在 Windows 资源管理器中打开我的虚拟驱动器。%SystemRoot%\Explorer.exe /e,::{MyExtension CLSID}

虚拟驱动器使用 IShellFolder 接口，是一个 ShellExtension。它有几个预定义的文件夹。问题是我可以使用上述语句直接在 Windows 资源管理器中打开虚拟驱动器，但无法直接打开其中一个文件夹。

此链接说明如何打开 IShellFolder [http://msdn.microsoft.com/en-us/library/bb776817(VS.85).aspx#](http://msdn.microsoft.com/en-us/library/bb776817(VS.85).aspx#)

但我不确定如何使用对象名参数 %SystemRoot%\Explorer.exe /e,::{MyExtension CLSID},objectname

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T19:50:05.190

我使用了[GMail Drive Shell 扩展](http://www.viksoe.dk/code/gmail.htm)，安装了它，并在命名空间内创建了一个文件夹。然后我使用上面的方法 (/E,::{CLSID}) 创建快捷方式并在末尾添加“,foldername”。
它工作得很好，我认为你需要检查你的[IPersistFolder::Initialize](http://msdn.microsoft.com/en-us/library/aa931627.aspx)实现。

# sql - FoxPro 中的限制

> ID：672903
> 
> 赞同：5
> 
> 时间：2009-03-23T10:43:37.800
> 
> 标签：sql, limit, foxpro

我正在尝试从 fox pro 数据库中提取大量数据，使用它并将其插入到 mysql 数据库中。一次做所有事情太多了，所以想分批做 10 000 条记录。Fox Pro SQL中的LIMIT 5、10等价于什么，想要一个select语句

从人数限制 5、10 中选择姓名、地址；

即从第 5 个开始，只返回 10 个结果。在网上环顾四周，他们只提到了 top 显然没有多大用处。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T12:23:14.190

看一下[RecNo()](http://msdn.microsoft.com/en-us/library/aa978202(VS.71).aspx)函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T23:20:42.710

FoxPro 不直接支持 LIMIT 子句。它确实有“TOP nn”，但它只提供给定百分比内的“最顶级记录”，甚至限制返回 32k 条记录（最大）。

您最好将数据转储为 CSV，或者如果这不切实际（由于大小问题），则编写一个小的 FoxPro 脚本自动生成一系列 BEGIN-INSERT(x10000)-COMMIT 语句转储到一系列文本文件。当然，你需要一个 FoxPro 开发环境，所以这可能不适用于你的情况......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-21T17:28:56.513

Visual FoxPro 不直接支持 LIMIT。我使用以下查询来克服限制： `SELECT TOP 100 * from PEOPLE WHERE RECNO() > 1000 ORDER BY ID;` 其中 100 是限制，1000 是偏移量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-10T08:49:24.513

使用 TOP 子句很容易绕过 LIMIT 子句；如果您想从记录 _start 中提取以从名为 _test 的文件中记录 _finish，您可以执行以下操作：

[VFP]

** 假设 _start <= _finish，如果不是，则会出现顶部子句错误

*

_finish = MIN(RECCOUNT('_test'),_finish)

*

SELECT * FROM (SELECT TOP (_finish - _start + 1) * FROM (SELECT TOP _finish *, RECNO() AS _tempo FROM _test ORDER BY _tempo) xx ORDER BY _tempo DESC) yy ORDER BY _tempo

**

[/VFP]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T12:08:49.717

几年前，我不得不将 Foxpro 数据库转换为 Mysql。我为解决这个问题所做的就是在 Foxpro 表中添加一个自动递增的 id 列，并将其用作行引用。

那么你可以做类似的事情。

```
select name, address from people where id >= 5 and id <= 10; 
```

[Foxpro sql 文档](http://msdn.microsoft.com/en-us/library/aa978304(VS.71).aspx)没有显示任何类似于限制的内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T15:35:07.347

为了扩展 Eyvind 的答案，我将创建一个程序来使用 RecNo() 函数来提取给定范围内的记录，比如 10,000 条记录。

然后，您可以一次以编程方式循环遍历包含 10,000 条记录的大表，并将数据加载到 MySQL 数据库中。

通过使用 RecNO() 函数，您可以确定不会多次插入行，并且能够在数据加载过程中的已知点重新启动。如果您需要停止并重新启动加载过程，这本身就非常方便。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-03T23:30:29.410

在这里，根据您的表格进行调整。花了我 2 分钟，我这样做太频繁了。

N1 - 按任何方式分组，并确保你有一个 max(id)，你可以使用 recno() 来制作一个，正确排序

N2 - 加入 N1，其中 ID = N1 的 Max Id，显示 N2 中所需的字段

然后，如果您想加入其他表，请将它们全部放在括号中并给它一个别名并将其包含在连接中。

```
Select N1.reference, N1.OrderNoteCount, N2.notes_desc LastNote
FROM
(select reference, count(reference) OrderNoteCount, Max(notes_key) MaxNoteId
from custnote 
where  reference != '' 
Group by reference
) N1
JOIN 
(
select reference, count(reference) OrderNoteCount, notes_key, notes_desc
from custnote 
where  reference != '' 
Group by reference, notes_key, notes_desc
) N2 ON N1.MaxNoteId = N2.notes_key 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-04-05T12:07:16.273

根据返回的行数，如果您使用的是 .NET Framework，您可以通过以下方式偏移/限制获取的 DataTable：

```
dataTable = dataTable.AsEnumerable().Skip(offset).Take(limit).CopyToDataTable(); 
```

请记住添加程序集 System.Data.DataSetExtensions。

# nhibernate - 双向一对多实体关联

> ID：672915
> 
> 赞同：0
> 
> 时间：2009-03-23T10:48:14.917
> 
> 标签：nhibernate, bidirectional

如果我有两个对象，比如 ProductOrder 和 Product，我希望它们都能够包含对另一个的多个引用，例如

一个产品可以被多个订单引用一个 ProductOrder 可以包含多个产品。

我试图这样做......

```
 <set name="Products" inverse ="true" cascade="save-update">
      <key column="OrderID"/>
      <one-to-many class="Product"/>
  </set>

public class ProductOrder
{
    private ISet<Product> products = new HashedSet<Product>();

    public virtual int ID { get; set; }
    public virtual Customer Customer { get; set; }
    public virtual int NumberOfProducts { get; set; }
    public virtual decimal TotalCost { get; set; }
    public virtual void AddProduct (Product product)
    {
        products.Add(product);
    }
    public virtual ISet<Product> Products
    {
        get { return this.products; } 
        set { this.products = value; }
    }        
}

<set name="Orders" lazy="true" table="ProductOrders">
  <key column="ProductID"/>
  <one-to-many class="ProductOrder"/>
</set>

public class Product
{
    //public virtual Guid Id { get; set; }  //Could use Guid, though it's not really readable and harder to find reference in the DB

    private ISet<ProductOrder> orders = new HashedSet<ProductOrder>();

    public virtual int ID { get; set; }
    public virtual string Name { get; set; }
    public virtual string Category { get; set; }
    public virtual int Count { get; set; }
    public virtual bool Discontinued { get; set; }
    public virtual void AddOrder(ProductOrder order)
    {
        orders.Add(order);
    }
    public virtual ISet<ProductOrder> Orders
    {
        get { return this.orders; }
        set { this.orders = value; }
    }  
} 
```

我只是无法让它像我期望的那样工作。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T16:34:10.967

从您的代码中，我认为这不是一对多而是多对多的关系？看看[http://nhibernate.info/doc/nh/en/index.html#collections-ofvalues](http://nhibernate.info/doc/nh/en/index.html#collections-ofvalues)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T11:34:27.117

恕我直言，您不应该映射 Product.Orders 关系。通常，您不希望将潜在的大型集合映射到可能从数据库中提取大型集合的域对象上。

如果您的订单开始变大，您将开始遇到性能问题。

# java - 如何使用java获取图像的高度和宽度？

> ID：672916
> 
> 赞同：118
> 
> 时间：2009-03-23T10:48:34.277
> 
> 标签：java, javax.imageio

[除了使用ImageIO.read](https://docs.oracle.com/javase/8/docs/api/javax/imageio/ImageIO.html#read-java.io.File-)获取图像高度和宽度之外，还有其他方法吗？

因为我遇到了锁定线程的问题。

```
at com.sun.medialib.codec.jpeg.Decoder.njpeg_decode(Native Method)      
at com.sun.medialib.codec.jpeg.Decoder.decode(Decoder.java:87)      
at com.sun.media.imageioimpl.plugins.jpeg.CLibJPEGImageReader.decode(CLibJPEGImageReader.java:73)     
 - locked <0xd96fb668> (a com.sun.media.imageioimpl.plugins.jpeg.CLibJPEGImageReader)      
at com.sun.media.imageioimpl.plugins.clib.CLibImageReader.getImage(CLibImageReader.java:320)    
 - locked <0xd96fb668> (a com.sun.media.imageioimpl.plugins.jpeg.CLibJPEGImageReader)     
 at com.sun.media.imageioimpl.plugins.clib.CLibImageReader.read(CLibImageReader.java:384)   
 - locked <0xd96fb668> (a com.sun.media.imageioimpl.plugins.jpeg.CLibJPEGImageReader)      
at javax.imageio.ImageIO.read(ImageIO.java:1400)      
at javax.imageio.ImageIO.read(ImageIO.java:1322) 
```

此错误仅发生在 Sun 应用服务器上，因此我怀疑它是 Sun 错误。

* * *

## 回答 #1

> 赞同：316
> 
> 时间：2012-01-31T17:17:39.340

这是非常简单和方便的东西。

```
BufferedImage bimg = ImageIO.read(new File(filename));
int width          = bimg.getWidth();
int height         = bimg.getHeight(); 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2012-08-28T16:57:34.307

这是对@Kay 的精彩帖子的重写，它抛出 IOException 并提供提前退出：

```
/**
 * Gets image dimensions for given file 
 * @param imgFile image file
 * @return dimensions of image
 * @throws IOException if the file is not a known image
 */
public static Dimension getImageDimension(File imgFile) throws IOException {
  int pos = imgFile.getName().lastIndexOf(".");
  if (pos == -1)
    throw new IOException("No extension for file: " + imgFile.getAbsolutePath());
  String suffix = imgFile.getName().substring(pos + 1);
  Iterator<ImageReader> iter = ImageIO.getImageReadersBySuffix(suffix);
  while(iter.hasNext()) {
    ImageReader reader = iter.next();
    try {
      ImageInputStream stream = new FileImageInputStream(imgFile);
      reader.setInput(stream);
      int width = reader.getWidth(reader.getMinIndex());
      int height = reader.getHeight(reader.getMinIndex());
      return new Dimension(width, height);
    } catch (IOException e) {
      log.warn("Error reading: " + imgFile.getAbsolutePath(), e);
    } finally {
      reader.dispose();
    }
  }

  throw new IOException("Not a known image file: " + imgFile.getAbsolutePath());
} 
```

我想我的代表还不够高，我的意见不足以被认为是值得回复的。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2013-02-15T04:08:38.253

我尝试使用列出的各种方法来测试性能。由于许多因素会影响结果，因此很难进行严格的测试。我准备了两个文件夹，一个有 330 个 jpg 文件，另一个有 330 个 png 文件。在这两种情况下，平均文件大小为 4Mb。然后我为每个文件调用了 getDimension。getDimension 方法的每个实现和每个图像类型都单独测试（单独运行）。这是我得到的执行时间（jpg的第一个数字，png的第二个数字）：

```
1(Apurv) - 101454ms, 84611ms
2(joinJpegs) - 471ms, N/A
3(Andrew Taylor) - 707ms, 68ms
4(Karussell, ImageIcon) - 106655ms, 100898ms
5(user350756) - 2649ms, 68ms 
```

很明显，有些方法加载整个文件以获取尺寸，而另一些方法仅通过从图像中读取一些标题信息来获取。我认为当应用程序性能至关重要时，这些数字可能很有用。

感谢大家对这个线程的贡献 - 非常有帮助。

* * *

## 回答 #4

> 赞同：53
> 
> 时间：2010-05-26T09:46:18.990

我找到了另一种读取图像大小的方法（更通用）。您可以将 ImageIO 类与 ImageReaders 配合使用。这是示例代码：

```
private Dimension getImageDim(final String path) {
    Dimension result = null;
    String suffix = this.getFileSuffix(path);
    Iterator<ImageReader> iter = ImageIO.getImageReadersBySuffix(suffix);
    if (iter.hasNext()) {
        ImageReader reader = iter.next();
        try {
            ImageInputStream stream = new FileImageInputStream(new File(path));
            reader.setInput(stream);
            int width = reader.getWidth(reader.getMinIndex());
            int height = reader.getHeight(reader.getMinIndex());
            result = new Dimension(width, height);
        } catch (IOException e) {
            log(e.getMessage());
        } finally {
            reader.dispose();
        }
    } else {
        log("No reader found for given format: " + suffix));
    }
    return result;
} 
```

请注意，getFileSuffix 是返回不带“.”的路径扩展名的方法。所以例如：png，jpg等。示例实现是：

```
private String getFileSuffix(final String path) {
    String result = null;
    if (path != null) {
        result = "";
        if (path.lastIndexOf('.') != -1) {
            result = path.substring(path.lastIndexOf('.'));
            if (result.startsWith(".")) {
                result = result.substring(1);
            }
        }
    }
    return result;
} 
```

此解决方案非常快，因为仅从文件中读取图像大小而不是整个图像。我对其进行了测试，与 ImageIO.read 性能没有可比性。我希望有人会发现这很有用。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2009-03-28T01:59:39.970

您可以将 jpeg 二进制数据作为文件加载并自己解析 jpeg 标头。您正在寻找的是 0xFFC0 或帧头标头：

```
Start of frame marker (FFC0)

* the first two bytes, the length, after the marker indicate the number of bytes, including the two length bytes, that this header contains
* P -- one byte: sample precision in bits (usually 8, for baseline JPEG)
* Y -- two bytes
* X -- two bytes
* Nf -- one byte: the number of components in the image
      o 3 for color baseline JPEG images
      o 1 for grayscale baseline JPEG images

* Nf times:
      o Component ID -- one byte
      o H and V sampling factors -- one byte: H is first four bits and V is second four bits
      o Quantization table number-- one byte

The H and V sampling factors dictate the final size of the component they are associated with. For instance, the color space defaults to YCbCr and the H and V sampling factors for each component, Y, Cb, and Cr, default to 2, 1, and 1, respectively (2 for both H and V of the Y component, etc.) in the Jpeg-6a library by the Independent Jpeg Group. While this does mean that the Y component will be twice the size of the other two components--giving it a higher resolution, the lower resolution components are quartered in size during compression in order to achieve this difference. Thus, the Cb and Cr components must be quadrupled in size during decompression. 
```

有关标题的更多信息，请查看 wikipedia 的 jpeg 条目，或者我在[此处](http://www.obrador.com/essentialjpeg/headerinfo.htm)获得上述信息。

我使用了类似于以下代码的方法，该方法是从sun 论坛上的[这篇文章中获得的：](http://forums.sun.com/thread.jspa?messageID=2717499#2717499)

```
import java.awt.Dimension;
import java.io.*;

public class JPEGDim {

public static Dimension getJPEGDimension(File f) throws IOException {
    FileInputStream fis = new FileInputStream(f);

    // check for SOI marker
    if (fis.read() != 255 || fis.read() != 216)
        throw new RuntimeException("SOI (Start Of Image) marker 0xff 0xd8 missing");

    Dimension d = null;

    while (fis.read() == 255) {
        int marker = fis.read();
        int len = fis.read() << 8 | fis.read();

        if (marker == 192) {
            fis.skip(1);

            int height = fis.read() << 8 | fis.read();
            int width = fis.read() << 8 | fis.read();

            d = new Dimension(width, height);
            break;
        }

        fis.skip(len - 2);
    }

    fis.close();

    return d;
}

public static void main(String[] args) throws IOException {
    System.out.println(getJPEGDimension(new File(args[0])));
} 
```

}

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2012-02-17T06:02:24.273

简单的方法：

```
BufferedImage readImage = null;

try {
    readImage = ImageIO.read(new File(your path);
    int h = readImage.getHeight();
    int w = readImage.getWidth();
} catch (Exception e) {
    readImage = null;
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-02-04T21:02:00.823

您可以使用工具包，无需 ImageIO

```
Image image = Toolkit.getDefaultToolkit().getImage(file.getAbsolutePath());
int width = image.getWidth(null);
int height = image.getHeight(null); 
```

如果您不想处理图像的加载，请执行

```
ImageIcon imageIcon = new ImageIcon(file.getAbsolutePath());
int height = imageIcon.getIconHeight();
int width = imageIcon.getIconWidth(); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2018-06-20T18:06:08.137

ImageIO.read 的问题在于它真的很慢。您需要做的就是读取图像标题以获取大小。`ImageIO.getImageReader`是完美的候选人。

这是 Groovy 示例，但同样适用于 Java

```
def stream = ImageIO.createImageInputStream(newByteArrayInputStream(inputStream))
def formatReader = ImageIO.getImageWritersByFormatName(format).next() 
def reader = ImageIO.getImageReader(formatReader)
reader.setInput(stream, true)

println "width:reader.getWidth(0) -> height: reader.getHeight(0)" 
```

性能与使用 SimpleImageInfo java 库相同。

[https://github.com/cbeust/personal/blob/master/src/main/java/com/beust/SimpleImageInfo.java](https://github.com/cbeust/personal/blob/master/src/main/java/com/beust/SimpleImageInfo.java)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2020-06-18T15:40:20.397

在过去的几年中挣扎`ImageIO`了很多，我认为**Andrew Taylor**的[解决方案](https://stackoverflow.com/a/12164026/6693204)是迄今为止最好的折衷方案（快速：不使用`ImageIO#read`，并且用途广泛）。谢啦！！

但是我对被迫使用本地文件（文件/字符串）感到有点沮丧，特别是在您想要检查图像大小的情况下，例如，您通常检索`InputPart`/的多部分/表单数据请求`InputStream`。所以我很快做了一个变体，接受`File`,`InputStream`和`RandomAccessFile`，基于`ImageIO#createImageInputStream`这样做的能力。

当然，这样一个带有`Object input`, 的方法可能只保持私有，你应该根据需要创建尽可能多的多态方法，调用这个方法。您还可以在传递给此方法之前接受`Path`with`Path#toFile()`和`URL`with ：`URL#openStream()`

```
 private static Dimension getImageDimensions(Object input) throws IOException {

    try (ImageInputStream stream = ImageIO.createImageInputStream(input)) { // accepts File, InputStream, RandomAccessFile
      if(stream != null) {
        IIORegistry iioRegistry = IIORegistry.getDefaultInstance();
        Iterator<ImageReaderSpi> iter = iioRegistry.getServiceProviders(ImageReaderSpi.class, true);
        while (iter.hasNext()) {
          ImageReaderSpi readerSpi = iter.next();
          if (readerSpi.canDecodeInput(stream)) {
            ImageReader reader = readerSpi.createReaderInstance();
            try {
              reader.setInput(stream);
              int width = reader.getWidth(reader.getMinIndex());
              int height = reader.getHeight(reader.getMinIndex());
              return new Dimension(width, height);
            } finally {
              reader.dispose();
            }
          }
        }
        throw new IllegalArgumentException("Can't find decoder for this image");
      } else {
        throw new IllegalArgumentException("Can't open stream for this image");
      }
    }
  } 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-04-27T09:57:39.867

您可以使用 java 使用 BufferedImage 对象获取图像的宽度和高度。

```
public void setWidthAndHeightImage(FileUploadEvent event){
    byte[] imageTest = event.getFile().getContents();
                baiStream = new ByteArrayInputStream(imageTest );
                BufferedImage bi = ImageIO.read(baiStream);
                //get width and height of image
                int imageWidth = bi.getWidth();
                int imageHeight = bi.getHeight();
    } 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-02-04T10:03:04.943

使用 ImageIO.read 获取缓冲图像是一种非常繁重的方法，因为它会在内存中创建图像的完整未压缩副本。对于 png，您还可以使用 pngj 和代码：

```
if (png)
    PngReader pngr = new PngReader(file);
    width = pngr.imgInfo.cols;
    height = pngr.imgInfo.rows;
    pngr.close();
} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2019-07-30T15:48:21.090

所以不幸的是，在尝试了上面的所有答案之后，经过不知疲倦的尝试，我没有让它们工作。所以我决定自己做真正的黑客，我去为我工作。我相信它也适合你。

我正在使用这种简单的方法来获取应用程序生成的图像的宽度，但稍后会上传以进行验证：

请。请注意：您必须在清单中启用权限才能访问存储。

/*我将其设为静态并放入我的 Global 类中，这样我就可以从一个源引用或访问它，如果有任何修改，都必须在一个地方完成。只是在 java 中维护一个 DRY 概念。（无论如何）:)* /

```
public static int getImageWidthOrHeight(String imgFilePath) {

            Log.d("img path : "+imgFilePath);

            // Decode image size
            BitmapFactory.Options o = new BitmapFactory.Options();
            o.inJustDecodeBounds = true;
            BitmapFactory.decodeFile(imgFilePath, o);

            int width_tmp = o.outWidth, height_tmp = o.outHeight;

            Log.d("Image width : ", Integer.toString(width_tmp) );

            //you can decide to rather return height_tmp to get the height.

            return width_tmp; 
```

}

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2015-11-23T09:56:15.557

要在没有 EMF Image Reader 的情况下获取 emf 文件的大小，您可以使用代码：

```
Dimension getImageDimForEmf(final String path) throws IOException {

    ImageInputStream inputStream = new FileImageInputStream(new File(path));

    inputStream.setByteOrder(ByteOrder.LITTLE_ENDIAN);

    // Skip magic number and file size
    inputStream.skipBytes(6*4);

    int left   = inputStream.readInt();
    int top    = inputStream.readInt();
    int right  = inputStream.readInt();
    int bottom = inputStream.readInt();

    // Skip other headers
    inputStream.skipBytes(30);

    int deviceSizeInPixelX = inputStream.readInt();
    int deviceSizeInPixelY = inputStream.readInt();

    int deviceSizeInMlmX = inputStream.readInt();
    int deviceSizeInMlmY = inputStream.readInt();

    int widthInPixel = (int) Math.round(0.5 + ((right - left + 1.0) * deviceSizeInPixelX / deviceSizeInMlmX) / 100.0);
    int heightInPixel = (int) Math.round(0.5 + ((bottom-top + 1.0) * deviceSizeInPixelY / deviceSizeInMlmY) / 100.0);

    inputStream.close();

    return new Dimension(widthInPixel, heightInPixel);
} 
```

# c# - 何时不使用 lambda 表达式

> ID：672918
> 
> 赞同：56
> 
> 时间：2009-03-23T10:49:10.843
> 
> 标签：c#, .net, lambda, anonymous-methods

Stack Overflow 上正在回答很多问题，成员指定如何使用[lambda 表达式](https://en.wikipedia.org/wiki/Anonymous_function)解决这些现实世界/时间问题。

我们是否过度使用它，我们是否正在考虑使用 lambda 表达式对性能的影响？

我发现了几篇文章探讨了 lambda vs 匿名委托 vs `for`/`foreach`循环的性能影响，结果不同

1.  [匿名委托 vs Lambda 表达式 vs 函数调用性能](http://blogs.microsoft.co.il/blogs/alex_golesh/archive/2007/12/11/anonymous-delegates-vs-lambda-expressions-vs-function-calls-performance.aspx)
2.  [foreach 与 List.ForEach 的性能](http://diditwith.net/2006/10/05/PerformanceOfForeachVsListForEach.aspx)
3.  [.NET/C# 循环性能测试（FOR、FOREACH、LINQ 和 Lambda）](http://jerrytech.blogspot.com/2008/09/netc-loop-performance-test-for-foreach.html)。
4.  [DataTable.Select 比 LINQ 快](https://stackoverflow.com/questions/626679/datatable-select-vs-datatable-rows-find-vs-foreach-vs-findpredicatet-lambda/650922#650922)

选择合适的解决方案时应该有什么评价标准？除了使用 lambda 时代码更简洁、更易读的明显原因。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-23T12:27:06.490

尽管我将专注于第一点，但我首先在整个性能问题上给出我的 2 美分。除非差异很大或使用量很大，否则我通常不会担心添加后对用户没有任何可见差异的微秒。我强调，我只在考虑非密集调用方法时才在意。我确实有特殊性能考虑的地方是我设计应用程序本身的方式。我关心缓存，关心线程的使用，关心调用方法的巧妙方法（是进行多次调用还是尝试只进行一次调用），是否池化连接等等。实际上我通常不关心不关注原始性能，而是关注可扩展性。我不在乎它是否对单个用户运行得更好一点纳秒，

话虽如此，我对第 1 点的看法如下。我喜欢匿名方法。它们给了我很大的灵活性和优雅的代码。匿名方法的另一个重要特性是它们允许我直接使用容器方法中的局部变量（当然，从 C# 的角度来看，而不是从 IL 的角度来看）。他们经常为我节省大量代码。我什么时候使用匿名方法？每次我需要的代码在其他地方都不需要。如果在两个不同的地方使用它，我不喜欢复制粘贴作为重用技术，所以我将使用普通的 ol' 委托。所以，就像 shoosh 回答的那样，重复代码是不好的。理论上没有性能差异，因为匿名是 C# 技巧，而不是 IL 东西。

我对匿名方法的大部分想法都适用于 lambda 表达式，因为后者可以用作表示匿名方法的紧凑语法。让我们假设以下方法：

```
public static void DoSomethingMethod(string[] names, Func<string, bool> myExpression)
{
    Console.WriteLine("Lambda used to represent an anonymous method");
    foreach (var item in names)
    {
        if (myExpression(item))
            Console.WriteLine("Found {0}", item);
    }
} 
```

它接收一个字符串数组，对于每个字符串，它将调用传递给它的方法。如果该方法返回 true，它将显示“Found...”。您可以通过以下方式调用此方法：

```
string[] names = {"Alice", "Bob", "Charles"};
DoSomethingMethod(names, delegate(string p) { return p == "Alice"; }); 
```

但是，您也可以通过以下方式调用它：

```
DoSomethingMethod(names, p => p == "Alice"); 
```

两者之间的 IL 没有区别，因为使用 Lambda 表达式的那个更具可读性。再一次，没有性能影响，因为这些都是 C# 编译器技巧（不是 JIT 编译器技巧）。正如我不觉得我们过度使用匿名方法一样，我也不觉得我们过度使用 Lambda 表达式来表示匿名方法。当然，同样的逻辑也适用于重复代码：不要使用 lambda，使用常规委托。还有其他限制会导致您回到匿名方法或普通委托，例如 out 或 ref 参数传递。

Lambda 表达式的另一个好处是完全相同的语法不需要表示匿名方法。Lambda 表达式还可以表示……您猜对了，表达式。举个例子：

```
public static void DoSomethingExpression(string[] names, System.Linq.Expressions.Expression<Func<string, bool>> myExpression)
{
    Console.WriteLine("Lambda used to represent an expression");
    BinaryExpression bExpr = myExpression.Body as BinaryExpression;
    if (bExpr == null)
        return;
    Console.WriteLine("It is a binary expression");
    Console.WriteLine("The node type is {0}", bExpr.NodeType.ToString());
    Console.WriteLine("The left side is {0}", bExpr.Left.NodeType.ToString());
    Console.WriteLine("The right side is {0}", bExpr.Right.NodeType.ToString());
    if (bExpr.Right.NodeType == ExpressionType.Constant)
    {
        ConstantExpression right = (ConstantExpression)bExpr.Right;
        Console.WriteLine("The value of the right side is {0}", right.Value.ToString());
    }
 } 
```

注意稍有不同的签名。第二个参数接收一个表达式而不是一个委托。调用此方法的方法是：

```
DoSomethingExpression(names, p => p == "Alice"); 
```

这与我们在使用 lambda 创建匿名方法时所做的调用完全相同。这里的区别在于我们不是创建匿名方法，而是创建表达式树。正是由于这些表达式树，我们可以将 lambda 表达式转换为 SQL，例如 Linq 2 SQL 所做的，而不是在引擎中为每个子句（如 Where、Select 等）执行内容。是无论您是创建匿名方法还是发送表达式，调用语法都是相同的。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2011-12-20T22:27:36.427

我的回答不会受欢迎。

我相信 Lambda 的 99% 始终是更好的选择，原因有以下三个。

首先，假设您的开发人员很聪明，这绝对没有错。其他答案有一个基本前提，即除了您之外的每个开发人员都是愚蠢的。不是这样。

其次，Lamdas (et al) 是一种现代语法——明天它们将比现在更普遍。您的项目代码应该来自当前和新兴的约定。

第三，以“老式方式”编写代码对您来说似乎更容易，但对编译器来说却并不容易。这很重要，随着编译器的修订，遗留方法几乎没有机会改进。依赖编译器扩展它们的 Lambdas（等）可以受益，因为编译器会随着时间的推移更好地处理它们。

总结一下：

1.  开发人员可以处理
2.  每个人都在做
3.  有未来的潜力

同样，我知道这不会是一个受欢迎的答案。相信我，“简单就是最好的”也是我的口头禅。维护是任何来源的重要方面。我得到它。但我认为我们用一些陈词滥调的经验法则掩盖了现实。

// 杰瑞

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-23T10:56:05.477

代码重复。
如果您发现自己不止一次编写相同的匿名函数，那么它不应该是一个。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-03-23T11:13:09.913

好吧，当我们谈论委托使用时，lambda 和匿名方法之间不应该有任何区别——它们是相同的，只是语法不同。从运行时的角度来看，命名方法（用作委托）也​​是相同的。那么，区别在于使用委托与内联代码之间 - 即

```
list.ForEach(s=>s.Foo());
// vs.
foreach(var s in list) { s.Foo(); } 
```

（我希望后者更快）

同样，如果您谈论的*不是*内存中的对象，那么就维护类型检查（而不是一直解析字符串）而言，lambda 是您最强大的工具之一。

当然，在某些情况下，简单`foreach`的 with 代码会比 LINQ 版本更快，因为要执行的调用会更少，并且调用花费的时间虽小但可衡量。然而，在许多情况下，代码根本不是瓶颈，更简单的代码（尤其是用于分组等）的价值远远超过几纳秒。

另请注意，在 .NET 4.0 中还有用于循环、逗号等内容的[附加`Expression`节点](http://marcgravell.blogspot.com/2008/11/future-expressions.html)。该语言不支持它们，但运行时支持。我提到这一点只是为了完整：我当然不是说你应该`Expression`在哪里使用手动构造`foreach`！

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-23T11:14:21.937

我想说性能差异通常很小（显然，在循环的情况下，如果您查看第二篇文章的结果（顺便说一句，Jon Skeet 在[这里](http://codeblog.jonskeet.uk/2006/01/20/foreachperf/)有类似的文章）），您几乎不应该选择仅出于性能原因的解决方案，除非您正在编写一个性能绝对是首要的非功能性要求的软件，*并且*您确实必须进行微优化。

什么时候选择什么？我想这取决于情况，但也取决于人。举个例子，有些人更喜欢 List.Foreach 而不是普通的 foreach 循环。我*个人*更喜欢后者，因为它通常更具可读性，但我该反对谁呢？

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-23T17:57:04.670

任何时候 lambda 只是将其参数直接传递给另一个函数。不要为函数应用程序创建 lambda。

例子：

```
var coll = new ObservableCollection<int>();
myInts.ForEach(x => coll.Add(x)) 
```

更好：

```
var coll = new ObservableCollection<int>();
myInts.ForEach(coll.Add) 
```

主要的例外是 C# 的类型推断由于某种原因而失败（而且很多时候都是如此）。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-23T11:28:48.643

经验法则：

1.  编写自然且可读的代码。
2.  避免代码重复（lambda 表达式可能需要一点额外的努力）。
3.  仅在出现问题时进行优化，并且仅使用数据来备份该问题的实际情况。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-23T11:35:46.253

如果您需要递归，请不要使用 lambda，[否则您最终会分心](http://blogs.msdn.com/madst/archive/2007/05/11/recursive-lambda-expressions.aspx)！

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-12-20T12:51:18.337

Lambda 表达式很酷。**与旧`delegate`语法**相比，它们有一些优点，例如，它们可以转换为匿名函数或表达式树，从声明中推断出参数类型，它们更简洁，等等。我认为在以下情况下不使用 lambda 表达式没有真正的价值你需要一个匿名函数。早期样式的一个不太大的优势是，如果不使用参数声明，您可以完全省略它们。喜欢

```
Action<int> a = delegate { }; //takes one argument, but no argument specified 
```

当您必须声明一个什么都不做的空委托时，这很有用，但这并不是不使用 lambda*的*充分理由。

Lambda 让您可以编写快速的匿名方法。现在，在匿名方法变得毫无意义的地方，即命名方法更有意义的地方，这使得 lambdas 变得毫无意义。**相对于命名方法**，匿名方法可能是不利的（不是 lambda 表达式本身，但由于现在 lambda 广泛代表匿名方法，因此它是相关的）：

1.  因为它往往会导致逻辑重复（经常这样，重用很困难）

2.  当没有必要写信时，例如：

    ```
    //this is unnecessary 
    Func<string, int> f = x => int.Parse(x);

    //this is enough
    Func<string, int> f = int.Parse; 
    ```

3.  因为编写匿名迭代器块是不可能的。

    ```
    Func<IEnumerable<int>> f = () => { yield return 0; }; //impossible 
    ```

4.  因为递归 lambda 需要多一行古怪，比如

    ```
    Func<int, int> f = null;
    f = x => (x <= 1) ? 1 : x * f(x - 1); 
    ```

5.  好吧，因为反射有点混乱，但这没有实际意义，不是吗？

除了第 3 点之外，其余的都不是不*使用*lambda*的*充分理由。

 *另请参阅此[线程](https://stackoverflow.com/questions/7630538/c-action-func-vs-methods-whats-the-point)，了解`Func/Action`委托的不利之处，因为它们通常与 lambda 表达式一起使用。

# c# - 为什么我的 WPF Datagrid 不显示数据？

> ID：672923
> 
> 赞同：9
> 
> 时间：2009-03-23T10:51:28.827
> 
> 标签：c#, wpf, datagrid

本[演练](http://windowsclient.net/wpf/wpf35/wpf-35sp1-toolkit-datagrid-feature-walkthrough.aspx)说您可以在一行中创建 WPF 数据网格，但没有给出完整的示例。

因此，我使用通用列表创建了一个示例并将其连接到 WPF 数据网格，但它没有显示任何数据。

我需要对下面的代码进行哪些更改才能使其在数据网格中显示数据？

## 回答：

此代码现在有效：

**XAML：**

```
<Window x:Class="TestDatagrid345.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:toolkit="http://schemas.microsoft.com/wpf/2008/toolkit"
    xmlns:local="clr-namespace:TestDatagrid345"
    Title="Window1" Height="300" Width="300" Loaded="Window_Loaded">
    <StackPanel>
        <toolkit:DataGrid ItemsSource="{Binding}"/>
    </StackPanel>
</Window> 
```

**代码背后：**

```
using System.Collections.Generic;
using System.Windows;

namespace TestDatagrid345
{
    public partial class Window1 : Window
    {
        private List<Customer> _customers = new List<Customer>();
        public List<Customer> Customers { get { return _customers; }}

        public Window1()
        {
            InitializeComponent();
        }

        private void Window_Loaded(object sender, RoutedEventArgs e)
        {
            DataContext = Customers;

            Customers.Add(new Customer { FirstName = "Tom", LastName = "Jones" });
            Customers.Add(new Customer { FirstName = "Joe", LastName = "Thompson" });
            Customers.Add(new Customer { FirstName = "Jill", LastName = "Smith" });
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-01-10T23:33:33.023

通常在 WPF 中，您将利用`ObservableCollection<>`

因为这样您就可以从源集合`.Add()`/`.Remove()`元素到/从源集合，并且任何绑定的控件**（数据绑定）**都会自动更新**（自动属性更改通知）**。这些是 WPF 中的两个重要概念。

**主窗口视图模型**

```
using System.Collections.Generic;

namespace TestDatagrid345.ViewModels
{
  class Window1ViewModel
  {
    private ObservableCollection<Customer> _customers = new ObservableCollection<Customer>();
    public ObservableCollection<Customer> Customers
    {
      Get { return _customers; }
    }
  }
} 
```

**主窗口**

```
using System.Collections.Generic;
using System.Windows;

namespace TestDatagrid345
{
  public partial class Window1 : Window
  {
    Window1ViewModel _viewModel;

    public Window1()
    {
      InitializeComponent();
      _viewModel = (Window1ViewModel)this.DataContext; // @#$% (see XAML)
    }

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
      // but this stuff could instead be done on a 'Submit' button click on form:
      _viewModel.Customers.Add(new Customer { FirstName = "Tom", LastName = "Jones" });
      _viewModel.Customers.Add(new Customer { FirstName = "Joe", LastName = "Thompson" });
      _viewModel.Customers.Add(new Customer { FirstName = "Jill", LastName = "Smith" });
    }
  }
} 
```

**主窗口 XAML**

```
<Window
  x:Class="TestDatagrid345.MainWindow"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:vm="clr-namespace:TestDatagrid345.ViewModels"
  Title="Window1"
  Height="350"
  Width="525"
  WindowState="Maximized">
  <Window.DataContext>
    <vm:Window1ViewModel /> <!-- this needs to be here for @#$% -->
  </Window.DataContext>
  <Grid>
   <DataGrid
      AutoGenerateColumns="True"
      ItemsSource="{Binding Path=Customers}"
      AlternatingRowBackground="LightBlue"
      AlternationCount="2" />
  </Grid>
</Window> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T10:58:55.720

您需要添加

```
DataContext = Customers; 
```

在你的 Window_Loaded()

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-21T21:06:28.167

试试看：填充您的 _customers 列表并分配属性 ItemsSource

```
 dataGrid1.ItemsSource = _customers; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-02-18T11:24:14.733

我试图弄清楚为什么 JohnB 的答案给出的相同代码对我不起作用，问题是模型对象（客户）没有属性，而是字段。将它们转换为属性解决了我的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T11:43:45.550

现在从绑定中删除 Path=Customers ，它应该可以工作:)

# silverlight-2.0 - 如何使 Silverlight 2.0 按钮完全透明？

> ID：672926
> 
> 赞同：4
> 
> 时间：2009-03-23T10:51:57.827
> 
> 标签：silverlight-2.0

我在工具栏上使用了一个按钮，该按钮具有很好的渐变效果。我希望按钮完全透明，以便它的内容仅显示在渐变中。当我尝试时，按钮显示为白色而不是透明。

我的按钮的 XAML 是：

```
<Button Name="NewAppointmentButton" Style="{StaticResource ToolbarButtonStyle}">
  <TextBlock>X</TextBlock>
</Button> 
```

风格是：

```
<Style x:Key="ToolbarButtonStyle" TargetType="Button">
  <Setter Property="Background" Value="Transparent"/>
  <Setter Property="BorderThickness" Value="0"/>
  <Setter Property="Height" Value="24"/>
  <Setter Property="Width" Value="24"/>
</Style> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T11:02:32.667

最好的方法是定义一个新的按钮模板。将此添加到您的 UserControl.Resources 标记应该可以工作：

```
<ControlTemplate x:Key="ButtonControlTemplate1" TargetType="Button">
        <Grid>
            <vsm:VisualStateManager.VisualStateGroups>
                <vsm:VisualStateGroup x:Name="CommonStates">
                    <vsm:VisualState x:Name="Normal"/>
                    <vsm:VisualState x:Name="MouseOver">
                        <Storyboard/>
                    </vsm:VisualState>
                    <vsm:VisualState x:Name="Pressed">
                        <Storyboard/>
                    </vsm:VisualState>
                    <vsm:VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="DisabledVisualElement" Storyboard.TargetProperty="Opacity">
                                <SplineDoubleKeyFrame KeyTime="0" Value=".55"/>
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </vsm:VisualState>
                </vsm:VisualStateGroup>
                <vsm:VisualStateGroup x:Name="FocusStates">
                    <vsm:VisualState x:Name="Focused">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="FocusVisualElement" Storyboard.TargetProperty="Opacity">
                                <SplineDoubleKeyFrame KeyTime="0" Value="1"/>
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </vsm:VisualState>
                    <vsm:VisualState x:Name="Unfocused" />
                </vsm:VisualStateGroup>
            </vsm:VisualStateManager.VisualStateGroups>
            <ContentPresenter
                x:Name="contentPresenter"
                Content="{TemplateBinding Content}"
                ContentTemplate="{TemplateBinding ContentTemplate}"
                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                Margin="{TemplateBinding Padding}"/>
            <Rectangle x:Name="DisabledVisualElement" RadiusX="3" RadiusY="3" Fill="#FFFFFFFF" Opacity="0" IsHitTestVisible="false" />
            <Rectangle x:Name="FocusVisualElement" RadiusX="2" RadiusY="2" Margin="1" Stroke="#FF6DBDD1" StrokeThickness="1" Opacity="0" IsHitTestVisible="false" />
        </Grid>
    </ControlTemplate> 
```

现在您的按钮应定义为：

```
<Button x:Name="NewAppointmentButton" Template="{StaticResource ButtonControlTemplate1}">
    <TextBlock>X</TextBlock>
</Button> 
```

如果您正在使用表达式混合，您可以使用它来编辑您的按钮模板，使其符合您的心意：) 在设计视图中选择您的按钮 - 就在设计窗口上方将是一个名为“NewAppointmentButton”的灰色按钮。单击它，然后单击“编辑控制部件”，然后单击“编辑模板” - 该按钮应该有一个黄色的轮廓。您现在可以编辑视觉元素、状态和转换。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-17T19:37:16.067

我同意@BigDubb - 我认为这是最简单的方法。

```
<Border MouseLeftButtonDown="bla_Click" BorderThickness="0" Cursor="Hand">
    ...content here...
</Border> 
```

可选的 Cursor 属性提供了该区域可点击的视觉指示，这有时从边框的内容中看不清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T21:06:38.550

如果您想要一个显示文本的透明按钮，为什么不只使用边框，除非您当然要利用按钮的状态。

你可以只添加一个边框，添加你的内容，将边框上的背景设置为空，然后bada boom，bada bing。请注意，您必须让事件侦听器侦听 MouseLeftButtonDown 事件而不是 Click 事件。这比使用控制模板等更容易。

# javascript - 如何从第一页显示的第二页获取 div

> ID：672927
> 
> 赞同：0
> 
> 时间：2009-03-23T10:52:57.590
> 
> 标签：javascript, html

在我的 main.html 页面中，我有一个按钮。单击该按钮时，我需要获取另一个页面的内容。

目标页面有五个 div，我需要捕获一个 div 并在 main.html 页面中显示该 div 数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T11:02:03.637

使用 Javascript 和 JQuery。请参阅[http://docs.jquery.com/Manipulation](http://docs.jquery.com/Manipulation)或特别是[http://docs.jquery.com/Ajax/load](http://docs.jquery.com/Ajax/load)

准确地说，使用这样的东西：

```
$("#yourdiv").load("/yourpage.html #section"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T11:18:46.060

jQuery 可以非常优雅地做到这一点：

```
<script type="text/javascript" src="/js/jquery/jquery-1.3.2.min.js"></script>
<script>
//only when the DOM has been loaded
$(document).ready(function() {

    //bind to button id="myButton" click event
    $('#myButton').click(function() {

        //populate div id="myDiv" with specific div (div id="someDiv") from another page            
        $('#myDiv').load('/anotherPage.html #someDiv');
    });
});
</script> 
```

请参阅[jQuery Ajax/加载](http://docs.jquery.com/Ajax/load)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T11:06:40.897

只要第二个页面在同一个域中，就可以使用 AJAX 技术。例如，使用[Prototype](http://www.prototypejs.org/)你可以做这样的事情：

```
new Ajax.Request('http://url.of.second/page', {
  method: 'get',
  onSuccess: function(transport) {

    //make a regular expression to grab the required HTML fragment
    var re = /<div id="otherdiv">(.*)</div>/i;

    //extract the fragment from transport.responseText
    var found = transport.responseText.match(re);

    //add the fragment to targetdiv on current page
    $('targetdiv').innerHTML=found[1];
  }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-19T21:03:12.983

Jiri 的回答很到位。 **[http://docs.jquery.com/Ajax/load](http://docs.jquery.com/Ajax/load)** 是确切的 jquery 链接。谢谢吉里...

# java - 任何人都可以帮助解决有关唱片店的Java问题吗？

> ID：672932
> 
> 赞同：-1
> 
> 时间：2009-03-23T10:54:46.650
> 
> 标签：java, java-me

我有这个代码。基本上这会返回没有城镇质量的正确数据。当我添加城镇质量时，该方法没有返回任何内容，甚至没有返回原始数据，我不知道为什么。任何人都可以看到问题吗？

```
 protected void listRecords() {
    mListForm.deleteAll(); // clear the form
    try {
        RecordStore rs = RecordStore.openRecordStore("Details", true);
        RecordEnumeration re = rs.enumerateRecords(null, new RecordSorter(), false);
        while (re.hasNextElement()) {
            byte [] recordBuffer = re.nextRecord();
            String record = new String(recordBuffer);

            // extract the name and the age from the record

            int endOfName = record.indexOf(";");
            int endOfDesc = record.indexOf(";" , endOfName + 1);
            int endOfTown = record.indexOf (";", endOfDesc + 1);

            String name = record.substring(0, endOfName);
            String desc = record.substring(endOfName + 1, endOfDesc);
            String town = record.substring(endOfDesc +1, endOfTown);

            mListForm.append(name + " aged: "+ desc + "   " + town);
        }
        rs.closeRecordStore();
    }
    catch(Exception e){
        mAlertConfirmDetailsSaved.setString("Couldn't read details");
        System.err.println("Error accessing database");
    }
    mDisplay.setCurrent(mListForm);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T11:57:57.450

您是否尝试在调试器中运行它？是否发生异常？记录中是否存在三个分号？mDisplay 的字符串大小有限制吗？调用 setCurrent 时，mListForm 是否正确？

换句话说，到目前为止你做了什么，哪里是绝对正确的，哪里是错误的？

# xslt - 如何不复制一些属性？

> ID：672935
> 
> 赞同：24
> 
> 时间：2009-03-23T10:55:14.167
> 
> 标签：xslt, xpath

我需要从输入文档复制到输出文档的所有属性，但一个。

我的输入是这样的：

```
<mylink id="nextButton" type="next" href="javascript:;" /> 
```

我需要这样的输出：

```
<a id="nextButton" href="javascript:;" /> 
```

如果我使用以下 XSL：

```
<xsl:template match="mylink">
    <a><xsl:copy-of select="attribute::*"/></a>
</xsl:template> 
```

我得到所有属性输出如下：

```
<a id="nextButton" type="next" href="javascript:;" /> 
```

但我想忽略“类型”属性。我尝试了以下方法，但它们似乎都没有按我需要的方式工作：

```
<xsl:copy-of select="attribute::!type"/>
<xsl:copy-of select="attribute::!'type'"/>
<xsl:copy-of select="attribute::*[!type]"/>
<xsl:copy-of select="attribute::not(type)"/> 
```

我应该如何编写样式表以获得所需的输出？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-03-23T11:06:21.287

最短形式：

```
<xsl:template match="mylink">
    <a><xsl:copy-of select="@*[name()!='type']"/></a>
</xsl:template> 
```

更长的（这是我想出的第一件事，我把它留作参考）：

```
<xsl:template match="mylink">
    <a>
     <xsl:for-each select="@*">
      <xsl:if test="name() != 'type'">
       <xsl:attribute name="{name()}"><xsl:value-of select="."/></xsl:attribute>
      </xsl:if> 
     </xsl:for-each>
    </a>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-06-28T07:37:47.523

在 XSLT 2.0 中：

```
<xsl:template match="mylink">
  <a><xsl:copy-of select="@* except @type"/></a>
</xsl:template> 
```

# java - 将传入字符串的 unicode 表示形式转换为 UTF-8？

> ID：672948
> 
> 赞同：2
> 
> 时间：2009-03-23T11:01:29.147
> 
> 标签：java, utf-8

我正在阅读一些已经转换为 html 样式 υ 代码的数据。

我现在需要将其转换回 UTF-8 字符以供查看。不幸的是，我无法使用浏览器查看字符串。

我已经阅读了有关 java 中的转换的信息，似乎如果您有一个 \uxxxx 字符串，那么编译器将为您转换；但是，这当然行不通，因为我想读取动态字符串。

那么这可以做到吗？

非常感谢！担

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T11:27:46.710

你需要使用：

```
String StringEscapeUtils.unescapeJava(String str) 
```

来自 Apache Commons Library。

它将`\uxxxx`在输入字符串中找到序列并将它们转换为普通的 Java 字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T11:17:18.017

[native2ascii](http://java.sun.com/j2se/1.4.2/docs/tooldocs/windows/native2ascii.html)

使用“-reverse”选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T11:32:13.690

> 转换为html风格的υ代码。

其中哪一个？`\uXXXX`是 Java 约定，与 HTML 无关。HTML 实体看起来像`&#175;`

# ejb-3.0 - 使用 JBoss Seam (EJB3+JSF) 的审计日志

> ID：672955
> 
> 赞同：2
> 
> 时间：2009-03-23T11:04:33.007
> 
> 标签：ejb-3.0, seam, auditing

我需要为使用 JBoss Seam 编写的 Web 应用程序实现审计日志。EntityListeners 似乎是不错的候选者，但我不知道如何将 EntityListeners 连接到应用程序会话上下文以在审计记录中包含登录使用的主体。

我想知道是否有办法进行这种“连接”，或者是否有一种更舒适/优雅/有效的方式来为这个编程环境实现审计日志。

提前致谢。

拉法。

编辑：
非常感谢达莫的回答！我尝试注入我的身份组件，但没有成功。但是，对 Component.getInstance() 的建议调用确实提供了对 EntityListener 中用户身份的所需引用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T16:04:37.187

您是否尝试过将您的应用程序/会话范围的 Bean 注入到 EntityListener 中？或者如果注入不可用，则使用 Component.getInstance("myBean") 。

# ruby-on-rails - 在 ActiveRecord 中查找最新对象

> ID：672958
> 
> 赞同：4
> 
> 时间：2009-03-23T11:05:41.397
> 
> 标签：ruby-on-rails, activerecord

简单的问题：我需要帮助编写一个 ActiveRecord`find_all_by`语句，在该语句中我想从最新创建的对象到最旧的对象进行排序。

作为这个问题的后续行动：如果我将结果保存到变量 @records. 然后我如何要求其中的下一条记录？我想做类似的事情`@current_record = @records.next`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T11:12:38.587

此代码将执行您的初始查询

```
 @records = Model.find_all_by_column('value', :order => 'created_at DESC') 
```

关于你的跟进。如果要遍历返回的数组，则可以执行以下操作

```
 @records.each do |record|
  # Code to do something
 end 
```

在迭代器中，您可以在看到特定记录时设置一个标志，然后对迭代器中的下一条记录执行某些操作。

如果您想检查查找器返回的数组中是否有任何记录，则可以检查@records.length

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T11:15:54.697

```
Model.find_all_by_column_name('something', :order => "...") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T11:39:27.400

对于问题2：“其中的下一条记录”是什么意思？

如果您搜索显示结果的方法，使用每个方法都很方便：

```
<% @records.each do |record| %>
   #...
<% end %> 
```

甚至更好，带有部分

```
<%= render :partial => 'record', :collection => @records %> 
```

# google-visualization - 如何使用谷歌图表绘制折线图

> ID：672960
> 
> 赞同：2
> 
> 时间：2009-03-23T11:06:00.757
> 
> 标签：google-visualization

为什么这条线在 y 轴上从 100 开始，任何机构都可以解决我的问题。

代码：

```
<img src="http://chart.apis.google.com/chart?
chs=500x200
&amp;chd=t:533,100,423,200|179,50
&amp;cht=lc
&amp;chxt=x,y
&amp;chxl=0:|JAN|FEB|MAR|APR|MAY|JUNE|JULY|AUG|SEP|OCT|NOV|DEC|
1:||20|40|60|80|100
&amp;chco=FF9900,FF0000,0000FF"
alt="Sample chart" /> 
```

如果我更改了 y 轴值，则该线将达到 1000！

```
1:||200|400|600|800|1000 
```

我怎样才能在 533 得到那个起点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T11:24:09.183

轴 1 是左侧 y 轴，使用`chxl`参数指定标签 0、20、40、60、80 和 100。

您可以将最高值更改为 533，但我认为这看起来很奇怪。

要意识到的是标签独立于值工作。[您可以使用参数](http://code.google.com/apis/chart/formats.html#data_scaling)更改[数据的比例`chds`](http://code.google.com/apis/chart/formats.html#data_scaling)。

所以我认为你应该在 Y 轴标签上指定一个整数值，比如 600，然后缩放数据以匹配。

试试这个：

```
<img src="http://chart.apis.google.com/chart?
chs=500x200
&amp;chd=t:533,100,423,200|179,50
&amp;chds=0,600
&amp;cht=lc
&amp;chxt=x,y
&amp;chxl=0:|JAN|FEB|MAR|APR|MAY|JUNE|JULY|AUG|SEP|OCT|NOV|DEC|
1:|0|300|600
&amp;chco=FF9900,FF0000,0000FF"
alt="Sample chart" /> 
```

> ![图形](https://chart.apis.google.com/chart?chs=500x200&chd=t:533,100,423,200|179,50&chds=0,600&cht=lc&chxt=x,y&chxl=0:|JAN|FEB|MAR|APR|MAY|JUNE|JULY|AUG|SEP|OCT|NOV|DEC|1:|0|300|600&chco=FF9900,FF0000,0000FF)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T11:19:35.297

所有 Google 图表都按 100 的比例表示。因此最高值将始终沿图表顶部运行。

当您将轴指定为 20,40,60,80,100 时，它现在看起来好像您的最高值是 100，但实际上，无论您拥有什么值，它总是看起来像 100，因为它会沿着顶部运行。

删除轴设置，或调整轴值以表示值中的最大值。在这种情况下为 533。

# c# - 如何在 C# 中为时间戳数据类型分配默认值？

> ID：672961
> 
> 赞同：-2
> 
> 时间：2009-03-23T11:06:08.043
> 
> 标签：c#, .net, sql, linq, linq-to-sql

我想在 c# 中为时间戳数据类型分配默认值？

我在 c# 中有一个表对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T11:48:24.570

SQL 时间戳基于 sql 服务器上的插入/更新顺序。无法从 C# 中分配它。我怀疑 SQL 甚至会允许您更新 TimeStamp 类型的列。

TimeStamp 是一个二进制序列。（我相信 8 个字节。）与 DateTime 没有相关性。页面上没有任何内容可供用户显示。

如果要向用户显示上次修改或首次创建记录的时间，则必须维护 DateTime 类型的单独字段，并使用 sprocs 或触发器更新应用程序或 sql 中的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T14:38:10.997

根据[文档](http://msdn.microsoft.com/en-us/library/aa260631(SQL.80).aspx)，Transact-SQL**时间戳**数据类型只是一个递增数字，不保留日期或时间。您无法将其转换为有意义的`DateTime`值。

文档说它是一个 8 字节的值。因此，如果它存储在 a 中`System.Data.Linq.Binary`，您可以`long`使用以下代码将其转换为 a：

```
System.Data.Linq.Binary timestampValue;
// Somehow get a reference to the SQL timestamp you're interested in

// Use BitConverter to convert the 8 bytes to a long
long timestampLong = BitConverter.ToInt64(timestampValue.ToArray(), 0); 
```

您可以尝试`DateTime`通过调用接受值的构造函数将该值转换为 a `ticks`，但结果将毫无意义。`ticks`如果值超出范围，您也可能会遇到异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T11:14:10.957

对于 DateTime 对象，只需使用

```
var d = new DateTime(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T11:19:15.017

日期时间 d = new DateTime(2009,3,23);

[微软](http://msdn.microsoft.com/en-us/library/system.datetime.datetime(VS.80).aspx)

# javascript - 一次点击两个事件

> ID：672971
> 
> 赞同：0
> 
> 时间：2009-03-23T11:09:19.267
> 
> 标签：javascript, dom-events, buttonclick

我正面临这个问题：

```
<p class="pushButton">
  <a href="javascript:return;"
      onclick="SetOkCodeButton('=SC_ORDER', 'BBPForm', '', '',''); 
      return false;" name="Order" class="pushButton" 
      title="Orders your shopping cart. This completes the operation "
      onmouseover="status=' ';return true;"  onmouseout="status=' ';">
      &nbsp;Order&nbsp;
  </a>
</p>

<p class="pushButton">
  <a href="javascript:return;" 
      onclick="SetOkCodeButton('=SC_REFRESH', 'BBPForm', '', '',''); 
      return false;" name="Refresh" class="pushButton" 
      title="Updates all details according to your changes. "
      onmouseover="status=' ';return true;"  onmouseout="status=' ';">
      &nbsp;Refresh&nbsp;
   </a>
</p> 
```

我需要更改`ORDER`按钮的功能。它应该在事件生成之前触发`REFRESH`（生成事件）功能。`SC_REFRESH``SC_ORDER`

`onlick`这意味着我需要在按钮上触发两个事件`ORDER`- 先是`REFRESH`，然后是`ORDER`。两个事件之间有 2 秒的休息时间。的功能`REFRESH`不会改变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T11:28:48.707

一个）。2秒延迟的原因是什么？这是非常可疑的...

乙）。任何给定的方法都应该很好地完成一件事。在该方法中为 REFRESH 和 ORDER 创建不同的功能向我表明，您确实有两个方法应该分为两个（可能都称为公共的第三个函数），但是我又一次难以想象您为什么想要在发布*之前*刷新表单。

C）。如果你真的需要这个，你可以最好在新划分的方法本身中引入一个带有[setTimeout的计时器，但是如果你继续现有的实现，那么我猜是 onclick 属性本身，尽管现在它变得混乱（呃）。](http://www.w3schools.com/htmldom/met_win_settimeout.asp)你会写这样的东西：

```
onclick="SetOkCodeButton('=SC_REFRESH', 'BBPForm', '', '',''); setTimeout(function(){SetOkCodeButton('=SC_ORDER', 'BBPForm', '', '','');},2000);" 
```

请注意，尽管 setTimeout 是异步的 - 如果您想要一个真正的 wait() 方法，您需要自己编写一个（这些处理器很昂贵），但它们很昂贵，我再次怀疑您是否真的需要它。

D)。return false 也令人深感怀疑……

E)。鼠标悬停和鼠标悬停也是如此，这是自动生成的代码吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T12:10:52.630

有什么理由这行不通吗？

```
<p class="pushButton">
  <a href="javascript:return;" 
      onclick="SetOkCodeButton('=SC_REFRESH', 'BBPForm', '', '','');SetOkCodeButton('=SC_ORDER', 'BBPForm', '', '','');
      return false;" name="Refresh" class="pushButton" 
      title="Updates all details according to your changes. "
      onmouseover="status=' ';return true;"  onmouseout="status=' ';">
       Refresh 
   </a>
</p> 
```

如果这些函数是同步的，这应该没问题，如果它们是异步的，你可能需要一个回调。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T14:20:06.953

我刚刚发现我在这里列出的代码是由 SAP 的这个模板生成的。我是新来的。:-) 任何人都可以看到触发 2 个事件（SC_REFRESH 和 SC_ORDER）而不是一个（SC_ORDER）的机会？

`TR()` `TD()`

`BBPVSpace()` `BBPButtonBegin()`

`if (BTN_SC_ORDER.exists)` `if (BTN_SC_ORDER.disabled)` `BBPDisabledButton(BTN_SC_ORDER.label)` `BBPButtonSpace()` `else` `BBPButton(BTN_SC_ORDER.OKCODE,BTN_SC_ORDER.label, tooltip=#BUTTON_ORDER)` `BBPButtonSpace()` `end` `end`

`if (BTN_SC_REFRESH.exists)` `if (BTN_SC_REFRESH.disabled)` `BBPDisabledButton(BTN_SC_REFRESH.label)` `BBPButtonSpace()` `else` `BBPButton(BTN_SC_REFRESH.OKCODE,BTN_SC_REFRESH.label,tooltip=#BUTTON_ACTUAL)` `BBPButtonSpace()` `end` `end`

# ruby - 鞋子中的点击事件

> ID：672972
> 
> 赞同：3
> 
> 时间：2009-03-23T11:09:40.170
> 
> 标签：ruby, events, shoes

单击一个 slot 时，我会更改 slot 的内容以提供用户反馈，然后调用一些需要几秒钟才能运行的代码。但是，直到“慢”过程完成后，才会呈现对插槽的更改。有什么方法可以强制渲染在“慢”代码运行之前发生。

在以下示例中，用户永远不会看到“处理中，请稍候......”

```
class MyTest < Shoes

  url '/', :index
  url '/result', :result

  def index
    stack do
      my_button=flow do
        image './assets/trees.jpg'
        para 'Process Image'
      end
      my_button.click do
        my_button.contents[0].hide
        my_button.contents[1].text="Processing, please wait ..."
        sleep(4) # Simulate slow process

        visit '/result'
      end
    end
  end
  def result
    stack do
      para "Finished processing"
    end
  end
end

Shoes.app 
```

查看 ruby​​.c 或 canvas.c 中的 Shoes 源代码，有对重新绘制或绘制画布的引用。它们可以从鞋子内部调用吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T14:03:30.050

这有点骇人听闻，但您可以将实际逻辑移动到一个单独的函数中，如下所示：

```
def doStuff()
  sleep(4) # Simulate slow process

  visit '/result'
end 
```

并用于`timer`在单独的线程中运行它：

```
my_button.click do 
  my_button.contents[0].hide
  my_button.contents[1].text="Processing, please wait ..."

  timer(0) { doStuff() }
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T09:25:22.283

谢谢你。这是一种享受。我还使用 Threads 制定了解决方案：

```
 def doStuff
         sleep(4) # Simulate slow process
         visit '/result'
      end

      .
      .
      .

      my_button=stack do 
         image  "button_image.jpg"
          para  "Press me"
      end
      my_button.click do
          Thread.new do
             doStuff
          end
           my_button.contents[0].hide
          my_button.contents[1].text = "Processing, please wait ..."
      end 
```

两种解决方案似乎都按预期工作。

# build-automation - 建立一个分支的源代码控制

> ID：672976
> 
> 赞同：2
> 
> 时间：2009-03-23T11:12:14.080
> 
> 标签：build-automation, cruisecontrol.net, nant, branch, sourcegear-vault

我目前正在为工作评估不同的源代码控制解决方案，并且有一些关于分支的问题。

我对如何分支有基本的了解，但我不确定我们的构建机器（CruiseControl.net）如何获得一个分支来构建它。

我们有很多项目，这些项目都依赖于其他项目（还有其他项目）：实用程序>数据访问>业务逻辑>通用GUI>（网站|桌面客户端）

**我们如何构建存储库**（如果有任何区别，则为 Vault），以便构建机器能够：

1.  建立后备箱
2.  构建“最新”分支

一个粗略的文件夹结构和/或关于如何从 Cruisecontrol 获取的解释会很棒。

谢谢

**编辑：**

为了增加一些清晰度，我们打算使用主干进行开发，然后为每个版本使用一个分支。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T11:21:50.453

“最新分支”是什么意思？分支应该用于主干之外的扩展开发——主干应该**始终**包含最新的生产代码。

每个项目应该有`trunk`和`branches`文件夹：

```
Project 1
  |-> trunk
  |-> branches
Project 2
  |-> trunk
  |-> branches
    etc. 
```

然后，您的构建机器可以在本地将任何主干或分支检出到它想要的任何位置（对于您的互连项目，您必须对其进行设置，以便相对目录路径起作用）。在伪脚本中：

```
checkout project1/trunk /builds/project1
build /builds/project1 
```

和

```
checkout project1/branches/myBranch /builds/project1
build /builds/project1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T21:33:20.733

如果项目具有不同的发布周期（项目 1 的版本为 1.0，而项目 2 的版本已为 1.1），Mark 提出的解决方案效果很好。如果你所有的项目都是相互依赖的，我会从一个简单的结构开始

```
My Big Project
  | 
  +-- trunk
  |     |
  |     +-- utils
  |     |
  |     +-- data
  |     |
  |     +-- business
  |     |
  |     +-- gui (web)
  |     |
  |     +-- gui (swing)
  | 
  +-- branches
  | 
  +-- tags 
```

这样，当你做一个分支/标记时，你确定你已经分支了所有的*东西*（整个代码）。否则，您在标记时总是冒着错过一个项目的风险。

您的构建服务器只需检查主干（包含所有内容）或一个标签/分支（也包含所有内容）并构建/安装版本。

一旦 utils 包稳定，您可以随时将其“升级”到同级项目并使用 Maven/Ivy 来管理依赖项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T13:40:38.083

只是为了澄清如何在 Vladimir 的方案中使用标签和分支。假设您的产品版本 1.x 已停用，版本 2.1 已发布，而您正在开发版本 3.0：

```
trunk <- you're working on version 3.0 here
 project1
 project2

branches
 ReleaseBranch-1.0
 ReleaseBranch-2.0 <-- fixes to version 2.1 (the current production version) get committed here, then merged into the trunk

tags
 Release-1.0 <-- a copy of the source that was used to build version 1.0
 Release-1.1
 Release-1.2
 Release-2.0
 Release-2.1 
```

在您的持续集成/构建服务器中，您将需要 2 个过程：

*   一个指向版本控制系统中的主干的
*   一个指向版本控制系统上 ReleaseBranch-2.0 的

[Pragmatic Version Control with Subversion](https://rads.stackoverflow.com/amzn/click/com/0977616657)一书是为 Subversion 设计的，但确实介绍了如何组织如上所述的存储库。

# c# - 仅使用 C# 关键字可以制作的最长的法律语句块是多少？

> ID：672977
> 
> 赞同：19
> 
> 时间：2009-03-23T11:12:28.073
> 
> 标签：c#, keyword

我正在用 C# 编写一些代码，我发现自己在写：

```
return new MyClass(... 
```

当我注意到 the`return`和 the`new`都是 C# 关键字时。所以我想知道 C# 中最长的合法关键字序列是什么。我能想到的只有：

```
internal static override void MyFunc(... 
```

`internal static override void`所有关键字在哪里。你能想到更长的关键字序列吗？

注意：这个问题真的没有意义。我只是希望在火上浇更多的乐趣:-)

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-03-23T11:21:35.603

对于 6：

```
new protected internal unsafe virtual decimal Foo() {...} 
```

编辑 7：

```
new protected internal unsafe virtual extern decimal Foo(); 
```

如果我们允许括号和大括号...

（**编辑**了“lock”、“new object()”、“as”和“string”由其他人贡献；见评论）

```
decimal Bar() {
    lock (new object() as string) {
        if (true) {
            checked {
                unsafe {
                    try {
                        do {
                            return default(decimal);
                            unchecked {break;}
                            continue;
                        } while (false);
                    }
                    catch { throw; }
                    finally { }
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-03-23T11:29:03.183

我猜它是无限的：

```
return null as string as string as string as string as string.... 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-03-27T19:36:29.200

这是另一种情况，只要您愿意：

```
do do do do do do do do do do do do do do do // ...
while(x) while(x) while(x) while(x) while(x) // ... 
```

使用上下文关键字，您还可以拥有

```
await await await await await await await // ... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T11:18:54.173

```
internal protected static volatile string foo = "bar"; 
```

那是5。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-12T14:27:08.313

方法定义的另一种变体（由我的同事发现）：

```
protected internal override sealed unsafe async void await() { ... } 
```

连续生成 8 个关键字。使用作为上下文关键字的事实`await`，因此可以将其重用于方法名称。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-07T19:52:28.763

```
public abstract class Base {
    protected internal abstract ref readonly int MyMethod();
}

public class Sub : Base {
    extern sealed protected internal override unsafe ref readonly int MyMethod();
} 
```

设法让 9 进入方法声明。不确定是否可以在方法声明中获得更多信息

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-26T08:48:55.550

10 与外部部分黑客

```
abstract partial class A
{
    private protected virtual extern unsafe ref readonly delegate*<int> Test();
}

partial class B : A
{
    private protected sealed override unsafe partial ref readonly delegate*<int> Test();

    // 1        2       3       4       5      6       7     8     9        10
    private protected sealed override extern unsafe partial ref readonly delegate*<int> Test();
} 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-03-23T11:24:59.713

我可以作弊吗？

```
internal protected static volatile StringBuilder @string = 
  new StringBuilder(int.Parse("12")); 
```

使用我可以使用关键字或其他保留术语作为变量名的事实，如果我在它前面加上一个 @ - 如果你允许 StringBuilder 的重复，则在 9 处。

# haskell - 调试haskell代码的好方法是什么？

> ID：672979
> 
> 赞同：33
> 
> 时间：2009-03-23T11:12:50.833
> 
> 标签：haskell, debugging, ghc

我使用了 ghci 调试器，但如果它在某种程度上与文本编辑器集成以简化设置断点的过程，我会更喜欢它。它可能不应该严格评估每个可见变量，但至少简化查看本地状态的过程。

我最近发现了跟踪功能，它允许从其他困难的地方进行调试打印输出。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-24T02:57:07.927

A good way to debug Haskell code is to write and test algebraic laws using [QuickCheck](http://www.cse.chalmers.se/~rjmh/QuickCheck/) and [SmallCheck](http://www.cs.york.ac.uk/fp/smallcheck/). There have been several Haskell debuggers including Hat, Hood, and Freya, but none of them have been perceived as sufficiently valuable to be worth maintaining for a long time.

When it's Haskell, you have to think differently about how to do things. The ICFP paper on the QuickCheck page has some good examples to get you started. If you want a real-world example [`xmonad`](http://xmonad.org/) is extensively debugged using QuickCheck.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-23T14:32:09.387

是的，GHCi 调试器的前端将是一件好事。也许我们会在下一次黑客马拉松期间完成一些事情。然而，与此同时：

*   [Monad Reader, Issue 10 (PDF)](http://www.haskell.org/wikiupload/0/0a/TMR-Issue10.pdf)有一篇关于使用调试器的文章。也许这可以给你更多的提示。

或者，Haskell 非常适合使用 QuickCheck 进行自下而上的测试。即，单独测试您的组件，然后将它们放在一起。如果您的代码是纯的，这通常可以正常工作。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-25T23:41:38.520

作为旁注，请注意`Debug.trace`在调试多线程程序时不会成为您的朋友。

从长远来看，测试是必经之路。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-01T15:58:38.203

For my own purposes I find that it's a combination of factors.

1.  Write easy to debug functional code, this means to make sure your functions are relatively small (5-20 lines) and that they only do one clearly defined thing each.
2.  Use [HUnit](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/HUnit) to define test cases that will bring out your problems.

As seen in other answers, a lot of people love [QuickCheck](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/QuickCheck). I've found it difficult to define meaningful QuickCheck test cases for at least some of my code so generally make more use of standard unit tests. That being said, there's an excellent introduction to using QuickCheck in [Chapter 11](http://book.realworldhaskell.org/read/testing-and-quality-assurance.html) of Real World Haskell.

Should you find yourself using both QuickCheck and HUnit, you may want to look into [test-framework](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/test-framework).

# c# - Dispose 在用户控件上，真的是要编辑 .designer.cs 文件吗？

> ID：672980
> 
> 赞同：4
> 
> 时间：2009-03-23T11:12:57.683
> 
> 标签：c#, controls, dispose, idisposable

对于具有必须释放的内部数据结构的用户控件，将该代码添加到 .designer.cs 文件中的 Dispose 方法的正确位置是否正确，或者是否有一个事件或我们打算使用的东西？

**编辑**：这是一个 winforms 用户控件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T13:08:56.670

如果您在谈论 WinForms，我通常采用两种方法之一来解决此问题。

**方法一**

打开 Form.Designer.cs 文件。在生成的 dispose 方法中，我添加了对 DisposeCore 的调用。然后我返回到 Form.cs 并添加一个 DisposeCore 方法，该方法现在将在 dispose 期间调用。我将所有处置逻辑添加到此方法中。

技术上不支持编辑设计器文件。但是我发现当设计器重新生成代码时，这个特定的编辑不会被冲走。

**方法二**

将事件处理程序添加到 Form.Disposed 并在处理程序中执行我的处置逻辑。这是更可取的方式，因为它是受支持的操作，并且不会受到您尚未遇到的某些设计器世代的影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T11:22:41.963

你能澄清一下什么样的控制吗？ASP.NET，WinForms？

在 ASP.NET 中，您可以：

```
protected override void OnUnload(EventArgs e){
     base.OnUnload(e);
     //Unload here...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-26T14:37:44.100

或者，您可以将其剪切并粘贴到主 .cs 文件中。该代码不在“#region 组件设计器生成的代码”中，因此 Studio 不会错过它。

# java - 获得免费驾驶指导的最佳方式

> ID：672983
> 
> 赞同：-1
> 
> 时间：2009-03-23T11:13:28.600
> 
> 标签：java, maps, driving-directions

有没有简单的方法来获取驾驶说明？

类似于：我调用“ [http://someservice/?start=NYC&target=Washington](http://someservice/?start=NYC&target=Washington) ”，然后服务返回一个包含路由信息的 XML 文件？

有没有人尝试过从独立的桌面应用程序访问这种基于 Web 的服务？

任何帮助将不胜感激！

更新：感谢您的提示，但不幸的是我无法运行 JavaScript。是否还有可能收到驾驶指示？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T11:15:25.180

你看过[谷歌地图 API](http://code.google.com/apis/maps/)吗？

另请参阅如何将[Google 地图的路线添加到您的站点](http://www.malevolent.com/weblog/archive/2005/05/01/add-google-maps/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T11:16:58.437

[谷歌地图 API](http://code.google.com/apis/maps/documentation/index.html)。

[来自Directions doc](http://code.google.com/apis/maps/documentation/services.html#LoadingDirections)的示例：

```
// Create a directions object and register a map and DIV to hold the 
// resulting computed directions

var map;
var directionsPanel;
var directions;

function initialize() {
  map = new GMap2(document.getElementById("map_canvas"));
  directionsPanel = document.getElementById("my_textual_div");
  map.setCenter(new GLatLng(49.496675,-102.65625), 3);
  directions = new GDirections(map, directionsPanel);
  directions.load("from: 500 Memorial Drive, Cambridge, MA to: 4 Yawkey Way, Boston, MA 02215 (Fenway Park)");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T14:09:33.373

根据您的应用程序，它可能还不是一个可行的选项，但您可能希望查看使用[OpenStreetMap](http://wiki.openstreetmap.org)数据的各种路由产品。[路由 wiki 页面](http://wiki.openstreetmap.org/wiki/Routing)提供了有关各种项目的更多信息。

# php - PHP 拼字游戏

> ID：672984
> 
> 赞同：0
> 
> 时间：2009-03-23T11:13:42.953
> 
> 标签：php, boggle

对于一个项目，我正在考虑用 PHP 构建一个 Boggle 类型的游戏。我在网上看到的所有解决方案都使用了某种基于树或散列的方法。

PHP 中是否有类似的数据结构？关于如何处理当前字母板上存在哪些单词的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T11:26:38.303

您真的需要弄清楚这些字母可以使用哪些单词吗？

一个简单的方法是让用户猜测一个单词，检查板上是否存在正确的字母，然后检查该单词是否为真实单词。

这很简单，但是您无法告诉用户还剩多少字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T11:46:00.893

PHP 确实在语言中内置了哈希数据结构。不过，它们通常被称为关联数组。

[该网站](http://www.bellaonline.com/articles/art31316.asp)对它们进行了非常简短的解释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T22:02:15.453

你可能想看看[这个问题](https://stackoverflow.com/questions/746082/how-to-find-list-of-possible-words-from-a-letter-matrix-boggle-solver)。它提供了很多关于如何编写一个 boggle 求解器的解决方案。大多数都在 Python 中，但我也在那里发布了一个 PHP 解决方案。这有点慢（计算所有内容约 2 秒），但它应该是一个很好的起点。

# asp.net - 任何好的开源或廉价的 ASP.NET 目录应用程序

> ID：672987
> 
> 赞同：0
> 
> 时间：2009-03-23T11:14:38.350
> 
> 标签：asp.net, catalog

我们正在寻找一个便宜到免费的“现成”ASP.NET 目录应用程序，它将满足以下要求：

*   支持两种listing：
    *   **服务**供应商****
    ***   **产品供应商**及其**产品****
***   供应商可分为：
    *   专业领域 - 包括子类别
    *   地点
    *   其他数据，例如列表来自哪里*   供应商/产品详细信息的版本控制*   易于使用的管理界面*   使用母版页，以便我们可以将其放入现有的站点布局中*   在安装了 .NET 3.5 的 Windows 2003 服务器上运行**

 **在理想情况下，可能会满足以下附加要求：

*   供应商可以管理自己的清单

我们可以使用的其他产品（显然需要一些额外的开发来满足这些要求）是：

*   内容管理系统 (MS)
*   Commerce Server - 请记住，我们不销售产品/供应商，只是列出它们
*   简单的数据库应用程序。

我很高兴在 MCMS/simple DB 中找到一些东西，我只是想看看是否有人对现成的应用程序有任何经验，可以节省我们一些时间。

我也很高兴收到“不要使用它，因为”类型的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-07T22:29:12.460

看看[Melon ASP.NET 产品目录](http://meloncomponents.com/Components/ProductCatalog/ProductCatalogOverview.aspx)，不确定他们是否有供应商人员，但易于集成且非常可扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-03T17:31:20.113

问了这个问题后不久，客户找到了解决他们问题的不同解决方案，所以我停止了寻找。

从那时起，Web 平台安装程序已经启动，在撰写本文时，它提供了许多基于 .NET 的电子商务应用程序，包括一些带有付费/支持选项的应用程序：

我没有使用或调查任何这些，所以你的里程可能会有所不同，但我在这里（作为社区维基）列出它们，以帮助那些不时跳过去寻找答案的少数人：

*   [核心电子商务精简版](http://www.core-frameworks.com/ecommerce-overview/ecommerce-lite-version)
*   [卡特里斯](http://www.kartris.com/)
*   [用于 ASP.NET 的 Kentico CMS](http://www.kentico.com/home.aspx)
*   [mojo门户](http://www.mojoportal.com/)
*   [nopCommerce](http://www.nopcommerce.com/default.aspx)
*   [锦绣CRM](http://www.splendidcrm.com/)

# asp.net - 默认网页字体

> ID：672989
> 
> 赞同：1
> 
> 时间：2009-03-23T11:15:30.797
> 
> 标签：asp.net, fonts

我正在添加一个包含与 LinkBut​​ton 相邻的文本的 asp.net ImageButton。我正在使用图像编辑器为 ImageButton 创建图像，我需要知道 LinkBut​​ton 使用的是什么字体。我试过萤火虫，但我还是想不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T12:37:49.880

无论您使用何种字体和大小在图像上绘制文本，对于所有用户来说，它看起来都与浏览器中的文本不同。根据操作系统的设置，一些浏览器在显示文本时会使用抗锯齿，这会对文本的外观产生很大的影响，而普通的抗锯齿和 cleartype 也有一些区别。（在 Windows 7 中，它会更加不同，因为它有一个为您的特定屏幕微调 cleartype 的向导，因此 cleartype 的呈现方式会有数千种变化。）

不要将文本放在图像中，而是将图像用作按钮的背景，并让浏览器在图像顶部显示文本。

例子：

```
<asp:Button runat="server" class="FancyButton" Text="click me" /> 
```

CSS：

```
.FancyButton {
   background: url(fancybutton.gif);
   border: none;
   width: 80px;
   height: 25px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T11:31:27.810

在 FireFox 中，您可以看到默认字体和颜色：

> 工具/选项/内容选项卡/字体和颜色

在 Internet Explorer 中：

> 工具/互联网选项/常规选项卡/字体按钮

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T11:31:56.700

它不会真正帮助找出使用的字体，因为任何给定的用户可能在他们的网络浏览器上设置了不同的默认字体，并且不同的网络浏览器也可能有不同的默认字体。

如果您希望 ImageButton 使用与 LinkBut​​ton 相同的字体，您需要自己指定字体。这样做的缺点是，除非您选择一种常用字体，否则无法保证所有用户都会安装此字体。您可以指定备用字体，但这在这里并没有真正的帮助，因为您不能指定备用图像。

为什么需要使用包含文本的图像？

你能张贴你想要实现的图像吗？

我确实编写了一些 CSS 来使文本具有类似背景的按钮，尽管它是针对经典 Windows 按钮样式的，但我确信比我有更多 CSS 知识的人可以更进一步。如果您认为它会有所帮助，我会去挖掘它并在这里发布。

编辑：这是代码：

```
.button {
    font:"Microsoft Sans Serif";
    font-size:small;
    background:#CCCCCC;
    border:solid;
    border-width:thin;
    border-left-color:#FFFFFF;
    border-top-color:#FFFFFF;
    border-right-color:#666666;
    border-bottom-color:#666666;
    padding-left:12px;
    padding-right:12px
}

<span class="button">Esc</span> 
```

# java - 从 Eclipse 的项目资源管理器视图中删除项目 .jars

> ID：672990
> 
> 赞同：63
> 
> 时间：2009-03-23T11:15:33.353
> 
> 标签：java, eclipse, ide, jar, classpath

jar 列表占用了太多空间。我可以折叠或隐藏它吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2011-11-09T10:32:31.330

另一种解决方案是使用 Package Explorer 视图。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-03-23T11:19:38.570

在项目资源管理器中：

*   自定义视图
*   查看`Libraries from external`

[![在此处输入图像描述](https://i.stack.imgur.com/8PYAM.png)](https://i.stack.imgur.com/8PYAM.png) [![在此处输入图像描述](https://i.stack.imgur.com/l4B1i.png)](https://i.stack.imgur.com/l4B1i.png)

或在包资源管理器中：

*   取消选中“显示引用的库节点”
*   添加过滤器以隐藏“*.jar”文件

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2010-01-07T08:11:18.807

在 Eclipse3.5 中，在“customize view”中选择过滤器“libraries from external”。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-08-07T14:35:55.807

在 Eclipse 3.7 中

*   Project Explorer 的打开视图菜单（标题右侧的向下箭头图标）
*   选择自定义视图菜单项
*   在过滤器选项卡上的可用自定义窗口中，从外部检查库，然后单击确定

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-10-20T21:30:17.010

在 Eclipse3.5 中

*   转到配置构建路径。选择库选项卡
*   删除任何要隐藏的库 jar 文件
*   使用 Add External Jar 选项将 Jar 文件添加回来
*   在“自定义视图”中选择过滤器“来自外部的库”。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-03T17:21:05.337

适用于项目资源管理器和包资源管理器视图中的 eclipse 3 和 4。

嘿，这是它的工作原理：

*   在天花板上下拉 -> 自定义视图... -> 过滤器勾选“来自外部的库”
*   右键单击项目 -> 属性 -> Java 构建路径 -> 删除所有 jars -> 添加外部 jars -> 添加所有 jars

你去吧。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-23T11:26:00.227

我相信 Eclipse 3.4.2 将 jar 放在可折叠的“引用库”节点下。你用什么版本？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-01-15T03:48:30.370

转到 Java 构建路径的库选项卡，添加变量（添加变量名称和库文件夹位置）。

添加变量后，单击扩展，您将看到所有 jar。选择所有这些（或任何需要的）并单击确定。单击确定退出构建路径对话框。

这将从您的项目视图中删除所有 jar。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-13T19:11:30.743

项目资源管理器 > [向下箭头图标] > 自定义视图 > 选择要排除以在资源管理器中查看的选项

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-04-16T09:04:57.147

**在 Eclipse Luna 中：**

1.  在项目浏览器的工具栏上，单击菜单按钮**“查看菜单”**（箭头）以打开显示选项的下拉菜单。
2.  选择*自定义视图...*
3.  在打开的对话框中，选择过滤器选项卡，然后选择要隐藏的文件类型的复选框。

要隐藏***.jar** ，请从 external 中选择***Libraries***。
更多信息检查：[Eclipse 帮助](http://help.eclipse.org/luna/index.jsp?topic=%2Forg.eclipse.platform.doc.user%2Ftasks%2Ftasks-48b.htm)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-07-16T12:23:46.387

在 Juno 上，查看 Project Explorer 最小化按钮左侧的“查看菜单”按钮。开发菜单并选择“自定义视图”选项。在“过滤器”选项卡中，选中“来自外部的库”选项。就这样。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-07-10T18:00:20.647

对于 Eclipse STS，

停止查看大量 jar 文件的快速解决方法是切换到导航器视图。出于我的目的，导航器的工作方式与项目资源管理器相同。我尝试在项目视图中添加自定义过滤器“*.jar”，但自定义过滤器在 STS 中不可用。同样自定义视图... - >过滤器勾选“来自外部的库”仅适用于第 3 方 jar，它不适用于您项目中的自定义 jar。

# wpf - 如何将像“Red”这样的字符串转换为 System.Windows.Media.Color？

> ID：672991
> 
> 赞同：45
> 
> 时间：2009-03-23T11:15:50.890
> 
> 标签：wpf

我知道我可以走很长的路...

1.  添加对 System.Drawing 的引用
2.  从字符串创建 System.Drawing.Color
3.  从 System.Drawing.Color 的 ARGB 值创建 System.Windows.Media.Color。

但这感觉像是严重的矫枉过正。

有没有更简单的方法？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-03-23T11:22:37.473

```
var color = (Color)ColorConverter.ConvertFromString("Red"); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-23T11:19:19.697

[System.Windows.Media.ColorConverter](http://msdn.microsoft.com/en-us/library/system.windows.media.colorconverter.aspx)是 XamlReader 的工作方式。

```
var result = ColorConverter.ConvertFromString("Red") as Color; 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-23T11:20:46.790

**新的更好的答案**

当然，ColorConverter 是要走的路。调用[ColorConverter.ConvertFromString](http://msdn.microsoft.com/en-us/library/ms606533.aspx)并转换结果。诚然，这将涉及拳击。如果您想避免装箱，请先为标准名称构建一个字典（仍然使用 ColorConverter），然后使用该字典进行后续查找。

**原始答案**

[您可以相当轻松地将System.Windows.Media.Colors](http://msdn.microsoft.com/en-us/library/system.windows.media.colors.aspx)中的属性名称和值一次提取到地图中：

```
private static readonly Dictionary<string, Color> KnownColors = FetchColors();

public static Color FromName(string name)
{
    return KnownColors[name];
}

private static Dictionary<string, Color> FetchColors()
{
    // This could be simplified with LINQ.
    Dictionary<string, Color> ret = new Dictionary<string, Color>();
    foreach (PropertyInfo property in typeof(Colors).GetProperties())
    {
        ret[property.Name] = (Color) property.GetValue(null);
    }
    return ret;
} 
```

这有点难看，但它是一次性的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T11:27:24.387

此代码使将名称转换为`Color`类更快：

```
public class FastNameToColor
{
    Dictionary<string, Color> Data = new Dictionary<string, Color>();

    public FastNameToColor()
    {
        System.Reflection.PropertyInfo[] lColors = typeof(System.Drawing.Color).GetProperties();

        foreach (PropertyInfo pi in lColors)
        {
            object val = pi.GetValue(null, null);
            if (val is Color)
            {
                Data.Add(pi.Name, (Color)val);
            }
        }
    }

    public Color GetColor(string Name)
    {
        return Data[Name];
    }
} 
```

您可以扩展此代码以`Media.Color`直接将名称转换为。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-18T10:30:43.497

仅供参考，另一种更简单的方法是使用微软构建的静态类，例如 Colors.Red

[http://msdn.microsoft.com/en-us/library/windows/desktop/bb189018.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb189018.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-25T15:47:17.090

> 此代码使在 c#、wpf 中将十六进制字符串转换为画笔变得更加容易

```
var brush = (Brush)new 
System.Windows.Media.BrushConverter().ConvertFromString("#28808080"); 
```

# javascript - 如何检索渲染画布元素的坐标（x，y，w，h）？

> ID：672993
> 
> 赞同：1
> 
> 时间：2009-03-23T11:16:40.433
> 
> 标签：javascript, drawing, canvas, dimensions

如何获取渲染画布元素的坐标？我需要他们申请`clearRect`，`fillRect`等等到它的区域。

我得到了画布：

```
//html
<div><canvas id="canvas_id">some useless text..</canvas></div>

//javascript   
var ctx = document.getElementById('canvas_id').getContext('2d'); 
```

然后？有办法得到左上角`x`，左上角`y`，`width`还有`height`这个？

@update 后*moonshadow*的回答：

谢谢你的回答，我知道操作是相对于画布的，但我问了这个问题，因为我没有解释自己的这种行为：我已经用画布对象做了一个测试文件（[http://avastreg.ilbello.com /canvas/test.html](http://avastreg.ilbello.com/canvas/test.html)）。

在这里，我放置了一个表格，`clearRect`可以通过表格发送尺寸。当您在画布（新闻）上触发鼠标悬停时，它适用`clearRect`于该坐标。在`mouseout`笔芯上。

起始值为：

```
x = 0, y = 0, w = 200, h = 200 // Notice that doesn't work. 
```

然后尝试类似

```
x: -10000, y: -10000, w: 50000000, h: 50000000 // => it seems a joke but this works! 
```

使用其他值，它会部分清除。为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T11:28:07.863

画布的宽度和高度在它的 offsetWidth 和 offsetHeight 中。

我过去使用过这样的代码来查找画布的顶部和左侧：

```
var canvasTop = 0;
var canvasLeft = 0;
var c = document.getElementById('canvas_id');
while( c && ( c != document.body ) )
{
  canvasTop += c.offsetTop;
  canvasLeft += c.offsetLeft;
  c = c.offsetParent;
} 
```

一般来说，[quirksmode.org](http://www.quirksmode.org/dom/w3c_cssom.html)有一个很大的列表，列出了这些属性的名称以及哪些浏览器支持哪些。

请记住，图形上下文上的操作坐标，如 fillRect、clearRect 等，默认情况下是相对于画布的，而不是整个文档，因此您*不需要*将画布的顶部和左侧添加到您想要的坐标画在。*************