# StackOverflow 问答 000349000-000349999

# c++ - 除非安装 Visual Studio 2008，否则为什么我的程序无法运行？

> ID：349004
> 
> 赞同：4
> 
> 时间：2008-12-08T09:39:28.583
> 
> 标签：c++, visual-studio-2008, redistributable

我编写了一个使用 GLUT、OpenGL 和 FMOD 的游戏。问题是二进制文件不会运行，除非计算机上安装了 Visual Studio 2008。

为什么是这样？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-08T09:44:07.763

您很可能正在链接 C/C++ 运行时的 DLL 版本。转到项目属性 -> C++ -> 代码生成，并将运行时库设置为*不是*“DLL”类型之一。

或者，您可以链接到 DLL 运行时，但是您必须使用您的应用程序重新分发运行时。

MSDN 提供了有关 C++ 应用程序部署各个方面的更多信息：http: [//msdn.microsoft.com/en-us/library/zebw5zk9.aspx](http://msdn.microsoft.com/en-us/library/zebw5zk9.aspx)

此外，[Dependency Walker (depends.exe)](http://www.dependencywalker.com/)将显示您的可执行文件所依赖的库。它还附带了一些版本的 Visual Studio。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-08T09:44:39.493

您的意思是为什么需要[Microsoft Visual C++ 2008 Redistributable Package (x86)](http://www.microsoft.com/downloads/details.aspx?FamilyID=9b2da534-3e03-4391-8a4d-074b9f2bc1bf&displaylang=en)？

> 此软件包安装 C 运行时 (CRT)、标准 C++、ATL、MFC、OpenMP 和 MSDIA 库的运行时组件。对于支持并行部署模型（CRT、SCL、ATL、MFC、OpenMP）的库，它们被安装到支持并行程序集的 Windows 操作系统版本上的本机程序集缓存（也称为 WinSxS 文件夹）中.

因为它们并非默认安装在所有 Windows 上，尤其是在 VS 2008 之前发布的那些。

就算

```
cout << "Hello, World" << endl; 
```

您需要一个库，在本例中是标准 C++ 库。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-08T09:42:12.183

欢迎来到应用程序部署的美妙世界。

运行该工具**取决于**您的可执行文件，它会告诉您哪些 DLL 还需要与您的 EXE 一起复制。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-08T09:42:47.563

[该程序](http://www.dependencywalker.com/)可以帮助您找到无法运行的计算机上缺少哪些 dll（如果有）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-08T09:43:45.627

默认情况下，只有 C 运行时的发布版本和 C++ 标准库 dll 与 Windows 一起安装。安装 Visual Studio 将另外安装调试版本。

确保您正在部署的版本完全在发布模式下构建。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-08T09:42:46.423

尝试在发布模式下编译，并确保所有需要的 DLL 都安装在目标机器上。这个对我有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-08T09:41:33.510

你对调试库有依赖吗？

# iphone - 您是否为您的 iPhone Beta 应用程序使用不同的应用程序 ID？

> ID：349016
> 
> 赞同：6
> 
> 时间：2008-12-08T09:44:16.140
> 
> 标签：iphone, distribution, beta, adhoc, app-id

我们这些拥有 iPhone 应用程序（已发布或未发布）的人能够使用 ad-hoc 分发发送有限的 beta 版本。虽然 Apple 文档中存在一些漏洞，但“网络”上有许多博客、帖子和其他文章填补了这些空白。

但是，我没有看到任何人提到一件事，我很好奇：当您进行测试版构建时，您是否使用与您已发布（或即将发布）的应用程序相同的应用程序 ID？

使用不同 id 的理由是，测试版仍然可以与已发布的应用程序一起运行。如果您已经在该领域发布了版本，这可能更重要。

反对的一个论点是，测试版将无法访问已发布的应用程序可能生成的任何数据，反之亦然。根据具体情况，这可能是也可能不是您想要的。

这种方法有什么问题吗？我目前只注册了一个应用程序 ID，但是 IIRC 没有任何障碍可以根据需要创建更多应用程序 ..？

很想听听其他人在做什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-08T11:42:43.687

为简单起见，我们使用相同的应用 ID。ad-hoc 分发中有很多令人头疼的问题，我们不想让任何人混淆“为什么我的手机上有两个应用程序？” 问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-08T11:54:04.880

我认为这取决于应用程序中数据的重要性。如果数据有价值，我认为 beta 测试人员不会希望它处于危险之中，因此拥有一个单独的 AppID 是有意义的。当然，这也意味着他们也不会完全测试应用程序，任何“升级”代码都不会得到测试。

就我而言（Yummy），数据只是delicious.com 的缓存，因此我的代码中的灾难性错误意味着，更糟糕的是，再次下载所有书签。所以我倾向于对所有事情使用相同的 AppID。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T04:10:28.720

我使用两种不同的包标识符来允许我的测试团队安装多个版本的应用程序以及不同的包显示名称，因此他们可以很容易地看到他们正在使用开发或测试版本，并在出现问题时将这个数字报告给我被发现。

# java - 基于 JDBC 的 AS400 样式命名

> ID：349018
> 
> 赞同：2
> 
> 时间：2008-12-08T09:45:13.190
> 
> 标签：java, sql, jdbc, ibm-midrange, jt400

有什么方法可以通过 jt400 在 JDBC 上使用 AS400 样式库/文件样式命名？我希望能够运行如下查询：

```
SELECT * FROM MYLIBRARY/MYFILE 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-09T20:49:34.410

将 jdbc 命名属性设置为“system”。

[http://javadoc.midrange.com/jtopen_6_3/com/ibm/as400/access/doc-files/JDBCProperties.html](http://javadoc.midrange.com/jtopen_6_3/com/ibm/as400/access/doc-files/JDBCProperties.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-08T16:34:00.883

这似乎取决于您使用的驱动程序。对于我们的 .NET 项目，我们使用 IBM 驱动程序并使用“标准”iSeries 命名约定。

检查驱动程序中的选项。我们的连接字符串中有“Naming=System”（再次使用 .NET 驱动程序）也许可以解决它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-08T11:41:57.230

有一种方法可以使用 STRSQL 在 400 上执行此操作，但据我所知，使用 JDBC

# sql-server - SQL Server 中的远程计算机名称

> ID：349022
> 
> 赞同：2
> 
> 时间：2008-12-08T09:46:14.263
> 
> 标签：sql-server

我有一个在多台计算机上运行并连接到 sql server 的应用程序我想在每次连接时将这些计算机的机器名称记录在表中我该怎么做

我想知道有没有这样的命令

“选择@@MachineName”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-08T09:59:09.760

如何记录此信息取决于您，但[HOST_NAME()](http://msdn.microsoft.com/en-us/library/ms178598(SQL.90).aspx)返回连接到服务器的工作站的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T09:48:59.780

创建链接服务器：（允许访问针对 OLE DB 数据源的分布式异构查询。）使用以下命令：

> sp_addlinkedserver [@server=]'服务器'[，[@srvproduct=]'product_name'][，[@provider=]'provider_name']
> 
> ```
>  [ , [ @datasrc= ] 'data_source' ] 
>  [ , [ @location= ] 'location' ] 
>  [ , [ @provstr= ] 'provider_string' ] 
>  [ , [ @catalog= ] 'catalog' ] 
> ```

然后访问就像：

从 [server-name].[db-name].dbo.[tablename] 中选择 *

此外，请确保您在两台服务器上使用的安全登录名相同（或至少在其他服务器上也存在）。

# php - 纯文本/HTML 电子邮件在 mac 邮件客户端中不起作用

> ID：349023
> 
> 赞同：0
> 
> 时间：2008-12-08T09:46:31.720
> 
> 标签：php, email

下面的代码是我正在使用的代码。它在雷鸟中运行良好，但在 mac 邮件客户端中运行良好（我假设任何东西都是由微软制作的。我目前无法访问它来测试它）。尽管我知道各种邮件客户端的特性，但我对此感到困惑！这是相当不言自明的，但我正在尝试发送纯文本和 html 电子邮件以增加读者群。任何帮助将非常感激。

编辑

我应该澄清一下，无论如何都会发送内容，但在 Thunderbird 中它会正确显示消息，但在 mac 邮件客户端中，你会得到从第一个 PHP-alt 到最后一个 PHP 的全部内容

```
<?php
//define the receiver of the email
$to = 'youraddress@example.com';
//define the subject of the email
$subject = 'Test HTML email';
//create a boundary string. It must be unique
//so we use the MD5 algorithm to generate a random hash
$random_hash = md5(date('r', time()));
//define the headers we want passed. Note that they are separated with \r\n
$headers = "From: webmaster@example.com\r\nReply-To: webmaster@example.com";
//add boundary string and mime type specification
$headers .= "\r\nContent-Type: multipart/alternative; boundary=\"PHP-alt-".$random_hash."\"";
//define the body of the message.
ob_start(); //Turn on output buffering
?>
--PHP-alt-<?php echo $random_hash; ?> 
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: 7bit

Hello World!!! 
This is simple text email message. 

--PHP-alt-<?php echo $random_hash; ?> 
Content-Type: text/html; charset="iso-8859-1"
Content-Transfer-Encoding: 7bit

<h2>Hello World!</h2>
<p>This is something with <b>HTML</b> formatting.</p>

--PHP-alt-<?php echo $random_hash; ?>--
<?
//copy current buffer contents into $message variable and delete current output buffer
$message = ob_get_clean();
//send the email
$mail_sent = @mail( $to, $subject, $message, $headers );
//if the message is sent successfully print "Mail sent". Otherwise print "Mail failed" 
echo $mail_sent ? "Mail sent" : "Mail failed";
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T10:01:37.743

与其尝试滚动您自己的邮件程序，不如尝试例如[PHPMailer](http://phpmailer.codeworxtech.com/)。它对 multipart/alternative 有很好的支持。集成它比推出自己的解决方案要容易得多。我去过那里 - 在无休止地解决奇怪的 MIME 问题之后，我放弃了我的手工邮件，切换到这个，并在我空闲的时间专注于其他事情。

换句话说，不要重新发明轮子。尽管自己动手可能是一个很好的挑战，并且在此过程中您会学到很多东西，但如果您只想让它发挥作用，这些人已经为您处理了复杂性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T09:56:15.413

您没有正确使用输出缓冲 - 请参阅[ob_end_clean](http://php.net/ob_end_clean)的手册页以查看它没有返回捕获的输出，您需要[ob_get_contents](http://php.net/ob_get_contents)：

```
$message =ob_get_contents();
ob_end_clean(); 
```

# c++ - С++ 中的字符串文字是在静态内存中创建的吗？

> ID：349025
> 
> 赞同：49
> 
> 时间：2008-12-08T09:47:29.130
> 
> 标签：c++, string, char

c++ 中的字符串文字是否在静态内存中创建并仅在程序退出时销毁？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-12-08T09:51:53.550

是的，字符串文字在程序的整个过程中都有效，即使在静态对象的销毁期间也是如此。

标准中的 2.13.4/1 说

> 普通字符串文字的类型为“n const char 数组”和静态存储持续时间。

该标准在 3.7.1/1 中提到了“静态存储持续时间”：

> 这些对象的存储将持续到程序的持续时间。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2008-12-08T09:51:46.657

实际上，它的创建位置是编译器编写者的实现决定。最有可能的是，字符串文字将存储在内存的只读段中，因为它们永远不会改变。

在旧的编译器时代，您曾经拥有像这些文字这样的静态数据，以及全局但可变的数据。这些存储在 TEXT（代码）段和 DATA（初始化数据）段中。

即使您有类似`char *x = "hello";`的代码，`hello`字符串本身也存储在只读内存中，而变量`x`在堆栈上（或者如果它是全局的，则存储在可写内存中的其他地方）。`x`只是被设置为`hello`字符串的地址。这允许各种棘手的事情，例如字符串折叠，因此“无效选项”（0x1000）和“有效选项”（0x1002）可以使用相同的内存块，如下所示：

```
+-> plus:0   1   2   3   4   5   6   7   8   9   A   B   C   D   E
|      +---+---+---+---+---+---+---+---+---+---+---+---+---+---+----+
0x1000 | i | n | v | a | l | i | d |   | o | p | t | i | o | n | \0 |
       +---+---+---+---+---+---+---+---+---+---+---+---+---+---+----+ 
```

请记住，我并不是指就 ROM 而言的只读内存，只是专门用于存储不可更改内容的内存（操作系统可能将其标记为真正只读）。

他们也永远不会被摧毁，直到`main()`退出。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-08T09:51:58.123

嗯，是。他们必须是；构成每个字符串中字符序列的信息必须在某个地方。如果它们被动态分配然后初始化，用于初始化的信息将驻留在哪里？因此，简单地将字符串设置为静态会更有效，以便在程序加载完成后它们始终可用且有效。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-08T09:59:06.483

字符串文字存储在内存的只读段中

# wpf - 我不希望我的 WPF 窗口的任务栏上下文菜单中有“关闭窗口”菜单项

> ID：349040
> 
> 赞同：3
> 
> 时间：2008-12-08T09:56:19.547
> 
> 标签：wpf

我不希望我的 WPF 窗口的任务栏上下文菜单中有“关闭窗口”菜单项。我的目的是惹恼用户。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-08T16:01:37.347

一个更简单的选择是这样做：

```
<Window ShowInTaskbar="False" ... /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T10:08:36.763

虽然除了惹恼用户之外，我没有看到从菜单中删除关闭命令的理由，但您可以在此处找到如何使用 WinAPI 调用在 C# 中修改应用程序的系统菜单的信息：

> [http://www.codeguru.com/csharp/csharp/cs_misc/userinterface/article.php/c9327](http://www.codeguru.com/csharp/csharp/cs_misc/userinterface/article.php/c9327)

# asp-classic - 将连接字符串转换为 SQLOLEDB

> ID：349047
> 
> 赞同：1
> 
> 时间：2008-12-08T10:01:18.697
> 
> 标签：asp-classic, ado

连接代码：

```
set conx = Server.CreateObject("ADODB.connection")
conx.Open Application("connectionString")

set cmdx = server.CreateObject("ADODB.command")
cmdx.ActiveConnection = conx
cmdx.CommandText = "dbo.sproc"
cmdx.CommandType = &H0004

set rsx = Server.CreateObject("ADODB.Recordset")
rsx.open cmdx

resarray = rsx.getrows 
```

此连接字符串有效：

```
connectionString = "DRIVER=SQL Server;UID=User;Address=000.000.000.000;Network=DBMSSOCN;DATABASE=Database;SERVER=server;Password=password;" 
```

这不...

```
connectionString = "Provider=SQLOLEDB;Data Source=000.000.000.000;UID=User;Address=000.000.000.000;Network=DBMSSOCN;DATABASE=Database;SERVER=server;Password=password;" 
```

我得到的错误是：

```
ADODB.Recordset error '800a0e78'

Operation is not allowed when the object is closed. 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T11:17:31.397

这里只是一个平底船，但 OLEDB 驱动程序处理行计数信息的方式与 ODBC 不同。

我非常怀疑如果您在存储过程的顶部添加 SET NOCOUNT ON，问题就会消失。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-08T10:54:14.080

听起来像是数据库中的权限问题！

# sql-server - 如何在 Sql Server 2005 中更改 UDT 的基本类型？

> ID：349049
> 
> 赞同：10
> 
> 时间：2008-12-08T10:02:54.120
> 
> 标签：sql-server, sql-server-2005, user-defined-types

我的类型为“x”，类型为 varchar(50)。**如何将其更改为 varchar(100)？**看来我做不到！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-08T10:33:17.727

你不能。你能做的是

*   使用 OBJECT_DEFINITION 编写包含该类型的所有对象的脚本。
*   放下它们。
*   重新创建具有新长度的类型
*   重新创建对象。

# math - 计算 LookAt 矩阵

> ID：349050
> 
> 赞同：46
> 
> 时间：2008-12-08T10:04:08.347
> 
> 标签：math, graphics, 3d, projection

我正在编写一个 3d 引擎，并且遇到了 DirectX 文档中描述的 LookAt 算法：

```
zaxis = normal(At - Eye)
xaxis = normal(cross(Up, zaxis))
yaxis = cross(zaxis, xaxis)

 xaxis.x           yaxis.x           zaxis.x          0
 xaxis.y           yaxis.y           zaxis.y          0
 xaxis.z           yaxis.z           zaxis.z          0
-dot(xaxis, eye)  -dot(yaxis, eye)  -dot(zaxis, eye)  1 
```

现在我明白了它在旋转方面的工作原理，但我不太明白为什么它将矩阵的平移分量放在那些点积上。稍微检查一下，它似乎是根据新基向量在眼睛/相机位置上的投影来少量调整相机位置。

问题是为什么需要这样做？它有什么作用？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2011-07-23T18:29:03.140

**请注意，给出的示例是左手行主矩阵**。

所以操作是：先平移到原点（通过 - *eye*移动），然后旋转，使*eye*到*At*的向量与 +z 对齐：

如果您将旋转矩阵预乘以平移 -*眼睛*，基本上您会得到相同的结果：

```
[ 1 0 0 0 ] [ xaxis.x yaxis.x zaxis.x 0 ]
[ 0 1 0 0 ] * [ xaxis.y yaxis.y zaxis.y 0 ]
[ 0 0 1 0 ] [ xaxis.z yaxis.z zaxis.z 0 ]
[ -eye.x -eye.y -eye.z 1 ] [ 0 0 0 1 ]

  [ xaxis.x yaxis.x zaxis.x 0 ]
= [ xaxis.y yaxis.y zaxis.y 0 ]
  [ xaxis.z yaxis.z zaxis.z 0 ]
  [ 点(xaxis,-eye) 点(yaxis,-eye) 点(zaxis,-eye) 1 ]

```

### 补充笔记：

请注意，查看转换是（有意）**反转**的：您将每个顶点乘以该矩阵以“移动世界”，以便您想要查看的部分最终出现在规范视图体积中。

另请注意，LookAt 矩阵的旋转矩阵（称为*R*）分量是基矩阵的*反向变化，*其中*R*的行是旧基向量的新基向量（因此变量名称 xaxis.x, . . xaxis 是基础发生变化后*新的 x 轴）。*然而，由于反转，行和列被转置。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-09T14:44:53.663

我通过创建一个 3x3 旋转矩阵来构建一个查看矩阵，就像您在此处所做的那样，然后将其扩展为一个 4x4，其中包含零和右下角的单个 1。然后我使用负眼点坐标（无点积）构建一个 4x4 平移矩阵，并将两个矩阵相乘。我的猜测是，这种乘法产生的结果相当于你的示例底行中的点积，但我需要在纸上解决它才能确定。

3D 旋转会改变您的坐标轴。因此，您不能直接使用眼点而不将其转换到这个新的坐标系中。这就是矩阵乘法——或者在本例中是 3 个点积值——完成的任务。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-08T14:28:29.717

该平移组件通过在原点处创建“眼睛”以及以该原点（您的“眼睛”）和三个轴表示的所有其他内容来帮助您创建[正交基础。](http://en.wikipedia.org/wiki/Orthonormal_basis)

这个概念并不是矩阵正在调整相机位置。相反，它试图简化数学运算：当您想要渲染从“眼睛”位置可以看到的所有事物的图片时，最容易假装您的眼睛是宇宙的中心。

因此，简短的回答是，这使数学变得更容易。

回答评论中的问题：您不只是从所有内容中减去“眼睛”位置的原因与操作的顺序有关。可以这样想：一旦你处于新的参考系（即，由 xaxis、yaxis 和 zaxis 表示的头部位置）中，你现在想要根据这个新的（旋转的）参考系来表达距离。这就是为什么您使用新轴的点积与眼睛位置：这表示物体需要移动的相同距离，但它使用新坐标系。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-09T17:44:23.003

只是一些一般信息：

观察矩阵是一个矩阵，它定位/旋转某些东西以从空间中的另一个点指向（查看）空间中的一个点。

该方法采用相机视图的所需“中心”，一个“向上”向量，它表示相机的“向上”方向（向上几乎总是（0,1,0），但不一定是)，以及一个“眼睛”向量，它是相机的位置。

这主要用于相机，但也可用于其他技术，如阴影、聚光灯等。

坦率地说，我不完全确定为什么在这种方法中设置翻译组件。在`gluLookAt`（来自 OpenGL）中，平移分量设置为 0,0,0，因为相机始终被视为位于 0,0,0。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-08T10:12:45.990

点积只是将一个点投影到轴上，以获得眼睛的 x、y 或 z 分量。您正在向后移动相机，因此从 (10, 0, 0) 和 (100000, 0, 0) 看 (0, 0, 0) 会产生不同的效果。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-09T17:50:38.420

观察矩阵执行以下两个步骤：

1.  将您的模型翻译为原点，
2.  根据向上矢量和观察
    方向设置的方向旋转它。

点积只是意味着您先进行平移，然后再进行旋转。点积不是将两个矩阵相乘，而是将一行与一列相乘。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-15T07:25:36.637

一个 4x4 变换矩阵包含两到三个分量：1\. 旋转矩阵 2\. 平移添加。3.规模（很多引擎不直接在矩阵中使用这个）。

它们的组合会将一个点从空间 A 变换到空间 B，因此这是一个变换矩阵 M_ab

现在，相机的位置在空间 A 中，因此它不是空间 B 的有效变换，因此您需要将此位置与旋转变换相乘。

唯一的悬而未决的问题是为什么这些点？好吧，如果你将这 3 个点写在纸上，你会发现 X、Y 和 Z 的 3 个点与旋转矩阵的乘法完全一样。

第四行/列的一个例子是在世界空间中取零点 - (0,0,0)。它不是相机空间中的零点，因此您需要知道相机空间中的表示是什么，因为旋转和缩放使其为零！

干杯

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-04-24T01:10:39.193

有必要将眼点放在您的轴空间中，而不是在世界空间中。当您用坐标单位基向量（x、y、z 之一）点一个向量时，它会为您提供*该*空间中眼睛的坐标。您可以通过在最后一个位置（在本例中为最后一行）应用三个翻译来转换位置。然后用负数向后移动眼睛，相当于向前移动所有其余空间。就像在电梯里向上移动一样，你会觉得世界其他地方都从你的脚下掉了下来。

使用左手矩阵，将平移作为最后一行而不是最后一列，是一种宗教差异，与答案完全无关。然而，这是一个应该严格避免的教条。在绘制树形草图时，最好以自然的阅读顺序从左到右链接全局到局部（正向运动学）变换。使用左手矩阵会迫使您从右到左编写这些矩阵。

# c# - 如何在单击按钮时检查gridview列中复选框的状态

> ID：349055
> 
> 赞同：1
> 
> 时间：2008-12-08T10:05:45.427
> 
> 标签：c#, asp.net, javascript, webforms

T 在gridview 中使用了复选框列。单击链接按钮时，应检查是否选中了 gridview 中的复选框。如果未选中任何复选框，则应显示警报（“至少检查一个复选框”）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T14:57:51.750

您必须在页面中添加一些自定义 Javascript 才能显示客户端警报。这是我编写的一个方法，它适用于名为“GridView1”的 GridView（如果您刚刚将控件拖到 ASPX 页面上，这应该是默认名称）：

```
<script type="text/javascript">
    function ClientCheck() {
        var valid = false;
        var gv = document.getElementById("GridView1");

        for (var i = 0; i < gv.all.length; i++) {
            var node = gv.all[i];
            if (node != null && node.type == "checkbox" && node.checked) {
                valid = true;
                break;
            }
        }
        if (!valid) {
            alert("Invalid. Please select a checkbox to continue.");
        }

        return valid;
    }
</script> 
```

您可以看到它为`GridView`控件设置了一个变量，然后在循环中遍历所有子控件`for`。如果孩子是 a`checkbox`并且它是`checked`，那么我们将`valid`变量设置为 true。如果我们到达迭代结束并且没有找到选中的复选框，则`valid`保持为 false 并且我们执行警报。

要将其链接到您`GridView`的 ASPX 页面上，首先将按钮列设置为 a并用您的客户端代码`TemplateField`包围。`LinkButton`如果您使用设计器设置列，则可以使用列编辑器中的“将此字段转换为模板字段”链接）。这是您最终会得到的源示例：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" DataSourceID="ObjectDataSource1">
    <Columns>
        <asp:TemplateField HeaderText="Button Field" ShowHeader="False">
            <ItemTemplate>
                <span onclick="return ClientCheck();">
                    <asp:LinkButton ID="LinkButton1" runat="server" CommandName="IDClick" Text='<%# Eval("YourDataSourceItem") %>'></asp:LinkButton>
                </span>
            </ItemTemplate>
        </asp:TemplateField>
        // ...your remaining columns... 
```

使用`TemplateField`允许我们添加我们喜欢的任何客户端代码。在这里，我们添加一个`span`并使用`onclick`来调用我们的`ClientCheck`方法。

如果您不关心警报，您可以通过使用`CustomValidator`在服务器端执行的控件来实现您的目标。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T08:53:56.413

我找到了答案。及其工作...

功能 checkBoxselectedornot() {

```
 var frm=document.forms['aspnetForm'];
       var flag=false;
       for(var i=0;i<document.forms[0].length;i++)
       {
           if(document.forms[0].elements[i].id.indexOf('chkDownloadSelectedEvent')!=-1)
           {
                 if(document.forms[0].elements[i].checked)
                 {
                      flag=true
                 }  
           }
       } 
      if (flag==true)
      {
        return true
      }else
      {
        alert('Please select at least one Event.')
        return false
      }

} 
```

和 girdview 代码是...

```
 <asp:BoundField ItemStyle-Width ="100px" DataField ="EventStartDate" DataFormatString ="{0:g}" HeaderText ="<%$ Resources:stringsRes, ctl_EventList_StartDate %>" SortExpression ="EventStartDate" HtmlEncode ="true" ItemStyle-Wrap ="false" />
            <asp:BoundField ItemStyle-Width="100px" DataField="EventDate" DataFormatString="{0:g}" HeaderText="<%$ Resources:stringsRes, ctl_EventList_Date %>"  SortExpression="EventDate" HtmlEncode="true" ItemStyle-Wrap="false" />
            <asp:ButtonField ItemStyle-Width="150px" ButtonType="Link" DataTextField="EventName" HeaderText="<%$ Resources:stringsRes, ctl_EventList_Event %>"  SortExpression="EventName" CommandName="show_details" CausesValidation="false" />
            <asp:BoundField DataField="EventLocation" HeaderText="<%$ Resources:stringsRes, ctl_EventList_Location %>" SortExpression="EventLocation" />
            <asp:TemplateField HeaderText ="Select">
            <ItemTemplate >
                <asp:CheckBox ID="chkDownloadSelectedEvent" runat ="server" AutoPostBack ="false" Onclick="eachCheck();"/>                   

            </ItemTemplate>
            </asp:TemplateField>
        </Columns>
        <RowStyle Height="25px" />
        <HeaderStyle Height="30px"/>
    </asp:GridView> 
```

并且有一个链接按钮....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T10:45:34.083

我没有在网格视图中使用该复选框，但是您不会在网格视图中的列周围进行 for 循环并检查状态吗？Myabe 添加一个计数，如果为 0，则发出警报。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T10:58:00.920

```
var grid = document.getElementById("gridId");  //Retrieve the grid    
    var inputs = grid.getElementsByTagName("input"); //Retrieve all the input elements from the grid
    var isValid = false;
    for (var i=0; i < inputs.length; i += 1) { //Iterate over every input element retrieved
        if (inputs[i].type === "checkbox") { //If the current element's type is checkbox, then it is wat we need
            if(inputs[i].checked === true) { //If the current checkbox is true, then atleast one checkbox is ticked, so break the loop
                isValid = true;
                break;
            }
        }
    }
    if(!isValid) {
        alert('Check at least one checkbox');
    } 
```

# html - CSS中的报告部分样式列表编号？

> ID：349060
> 
> 赞同：7
> 
> 时间：2008-12-08T10:08:47.917
> 
> 标签：html, css

现在我知道了“正常”的 CSS 列表样式（罗马、拉丁等），当然在过去的几年里，它们在不允许这样的事情上有些不灵活：

（一种）

或者

一种）

只要

一种。

现在我相信你可以使用 :before 和 :after 伪元素获得类似上面的效果。那是对的吗？如果可以的话，浏览器兼容性如何？

然而，我的主要问题是我想要报告样式编号：

1.  简介 1.1 目标 1.2 假设 1.3 限制 1.3.1 ...
2.  新节...

等等。

CSS 可以做到这一点，如果可以，浏览器的兼容性如何？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-08T10:26:25.133

请参阅[生成的内容、自动编号和列表](http://www.w3.org/TR/CSS2/generate.html)。

> 此示例显示了一种使用“Chapter 1”、“1.1”、“1.2”等对章节和章节进行编号的方法。

```
H1:before {
    content: "Chapter " counter(chapter) ". ";
    counter-increment: chapter;  /* Add 1 to chapter */
    counter-reset: section;      /* Set section to 0 */
}
H2:before {
    content: counter(chapter) "." counter(section) " ";
    counter-increment: section;
} 
```

编辑：[quirksmode.org](http://www.quirksmode.org/css/contents.html)在浏览器上有更好的 css 支持表。几乎所有浏览器，除了 IE8b2 之前的 IE。所以是的，完全没用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-08T12:12:02.910

这是 CSS2 自动编号和递增的 W3C 规范，以 1.1、1.2、1.3 类型编号为例。

[http://www.w3.org/TR/CSS2/generate.html#counters](http://www.w3.org/TR/CSS2/generate.html#counters)

我无法帮助您解决支持问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T10:30:54.690

一个简单的标记示例是：

```
<ol>
    <li>level one</li>
    <ol start="10"> 
        <li>level two</li>
        <li>level two</li>
        <ol start="110">
            <li>level three</li>
        </ol> 
        <li>level two
    </ol> 
    <li>level one</li>
</ol> 
```

结果是：

```
 1\.  level one
        10\. level two
        11\. level two
             110\. level three
        12\. level two 
   2\. level one 
```

浏览器支持相当广泛：符合 MSIE6。这是 HTML 4.0

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-15T16:45:53.143

这是我的纯 CSS 解决方案的完整版本，一直到 h6 级。通过 IE9 和 Firefox 28 测试。

```
body {
  counter-reset:level1Header;
}
h1 {
  counter-reset:level2Header;
}
h2 {
  counter-reset:level3Header;
}
h3 {
  counter-reset:level4Header;
}
h4 {
  counter-reset:level5Header;
}
h5 {
  counter-reset:level6Header;
}

h1:before {
  counter-increment:level1Header;
  content:counter(level1Header) ". ";
}

h2:before {
  counter-increment:level2Header;
  content:counter(level1Header) "." counter(level2Header) " ";
}

h3:before {
  counter-increment:level3Header;
  content:counter(level1Header) "." counter(level2Header) "." counter(level3Header) " ";
}

h4:before {
  counter-increment:level4Header;
  content:counter(level1Header) "." counter(level2Header) "." counter(level3Header) "." counter(level4Header) " ";
}

h5:before {
  counter-increment:level5Header;
  content:counter(level1Header) "." counter(level2Header) "." counter(level3Header) "." counter(level4Header) "." counter(level5Header) " ";
}

h6:before {
  counter-increment:level6Header;
  content:counter(level1Header) "." counter(level2Header) "." counter(level3Header) "." counter(level4Header) "." counter(level5Header) "." counter(level6Header) " ";
} 
```

# c# - 可能重载空合并运算符？

> ID：349062
> 
> 赞同：43
> 
> 时间：2008-12-08T10:10:19.690
> 
> 标签：c#, .net, operator-overloading, null-coalescing-operator

是否可以为 C# 中的类重载空合并运算符？

例如，如果实例为空，我想返回一个默认值，如果不是，则返回该实例。代码看起来像这样：

```
 return instance ?? new MyClass("Default"); 
```

但是，如果我想使用 null-coalescing 运算符来检查 MyClass.MyValue 是否已设置，该怎么办？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-12-08T10:29:33.537

好问题！[它没有在可重载和不可重载运算符列表中以](http://msdn.microsoft.com/en-us/library/8edha89s.aspx)一种或另一种方式列出，并且[在运算符页面](http://msdn.microsoft.com/en-us/library/ms173224.aspx)上没有提及任何内容。

所以我尝试了以下方法：

```
public class TestClass
{
    public static TestClass operator ??(TestClass  test1, TestClass test2)
    {
        return test1;
    }
} 
```

我收到错误“预期可重载的二进制运算符”。所以我想说，从 .NET 3.5 开始，答案是否定的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-08T10:54:50.383

根据[ECMA-334](http://www.ecma-international.org/publications/standards/Ecma-334.htm)标准，不可能超载?? 操作员。

同样，您不能重载以下运算符：

*   =
*   &&
*   ||
*   ?:
*   ?.
*   检查
*   未经检查
*   新的
*   类型
*   作为
*   是

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-08T10:16:48.900

简单的回答：没有

C# 设计原则不允许改变语言语义的运算符重载。因此复合赋值、三元运算符和...等复杂运算符不能重载。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-01-10T18:30:12.590

据传这将成为下一版本 C# 的一部分。来自[http://damieng.com/blog/2013/12/09/probable-c-6-0-features-illustrated](http://damieng.com/blog/2013/12/09/probable-c-6-0-features-illustrated)

***7\. Monadic null 检查***

*无需在访问属性或方法之前检查空值。在 Groovy 中称为安全导航运算符）。*

*前*

```
if (points != null) {
    var next = points.FirstOrDefault();
    if (next != null && next.X != null) return next.X;
}   
return -1; 
```

*后*

```
var bestValue = points?.FirstOrDefault()?.X ?? -1; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-01T18:11:41.610

我试图用我写的一个非常相似的结构来完成这个`Nullable<T>`。有了`Nullable<T>`你可以做类似的事情

```
Nullable<Guid> id1 = null;
Guid id2 = id1 ?? Guid.NewGuid(); 
```

尽管只[定义了](https://docs.microsoft.com/en-us/dotnet/api/system.nullable-1.op_explicit?view=netframework-4.8)到 type的[转换](https://docs.microsoft.com/en-us/dotnet/api/system.nullable-1.op_explicit?view=netframework-4.8)`id1`，但隐式转换from`Nullable<Guid>`到 a没有问题。用我自己的类型做同样的事情，它给出了一个错误`Guid``Nullable<T>`[`explicit`](https://docs.microsoft.com/en-us/dotnet/api/system.nullable-1.op_explicit?view=netframework-4.8)`T`

> 操作员 '？？' 不能应用于“MyType”和“Guid”类型的操作数

所以我认为编译器内置了一些魔法来为`Nullable<T>`. 所以作为替代...

## tl;博士

我们不能覆盖`??`操作符，但是如果您希望合并操作符评估基础值而不是类（或在我的情况下为结构）本身，您可以只使用一种方法，从而需要很少的额外击键。在我上面的案例中，它看起来像这样：

```
public struct MyType<T>
{
    private bool _hasValue;
    internal T _value;

    public MyType(T value)
    {
        this._value = value;
        this._hasValue = true;
    }

    public T Or(T altValue)
    {
        if (this._hasValue)
            return this._value;
        else
            return altValue;
    }
} 
```

用法：

```
MyType<Guid> id1 = null;
Guid id2 = id1.Or(Guid.Empty); 
```

这很好用，因为它是一个结构，并且`id1`它本身实际上不能为空。对于一个类，扩展方法可以处理实例是否为空，只要您尝试检查的值是公开的：

```
public class MyClass
{
    public MyClass(string myValue)
    {
        MyValue = myValue;
    }

    public string MyValue { get; set; }
}

public static class MyClassExtensions
{ 
    public static string Or(this MyClass myClass, string altVal)
    {
        if (myClass != null && myClass.MyValue != null)
            return myClass.MyValue;
        else
            return altVal;
    }
} 
```

用法：

```
MyClass mc1 = new MyClass(null);
string requiredVal = mc1.Or("default"); //Instead of mc1 ?? "default"; 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-11-19T13:46:21.383

如果有人在这里寻找解决方案，最接近的例子就是这样做

```
return instance.MyValue != null ? instance : new MyClass("Default"); 
```

# .net - 将扩展方法应用于具有泛型类型的泛型类

> ID：349064
> 
> 赞同：9
> 
> 时间：2008-12-08T10:11:56.380
> 
> 标签：.net, vb.net, generics, static-typing

我正在使用 vb.net 中的泛型类。
如果不指定类型，扩展方法似乎不能应用于泛型类。

我有这个通用类

```
Public Class MyGeneric(Of T)
    'Methods and properties go here 
    '
    '
End Class 
```

还行吧

```
<Extension()> _
Public Sub DoSomething(ByVal myGenericDoubleObj As MyGen(Of Double))

End Sub 
```

这不好（IDE 给了我未定义的错误 T。）

```
<Extension()> _
Public Sub DoSomethingGeneric(ByVal myGenericObj As MyGen(Of T))

End Sub 
```

这与.Net的静态检查有关吗？
对我说“你可以尝试用 Type T 做的事情可能不兼容，我不会允许你这样做。”

PS 作为通用类，我所承受的所有这些痛苦都来自另一个库，并在许多不同的地方使用。我对在我继承的泛型类中继承和添加这个方法有点警惕。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-08T10:27:23.853

如果您使扩展方法成为通用方法，它应该可以工作

即 DoSomething **(Of​​ T)** () instread 只是 DoSomething()

```
<Extension()> _
Public Sub DoSomething(Of T)(ByVal myGenericObj As MyGeneric(Of T))
End Sub 
```

希望这可以帮助

# javascript - 使用 Javascript 下载文件

> ID：349067
> 
> 赞同：10
> 
> 时间：2008-12-08T10:14:32.490
> 
> 标签：javascript, asp-classic, vbscript

我希望用户能够从我的服务器下载这个 Excel 文件。单击“下载”按钮后，必须有一种简单的方法来启动文件的下载......但我不知道如何做到这一点。

到目前为止我有这个：（VBscript和ASP）

```
<head>
<script type="text/javascript" src="overzicht.js"></script>
</head>

Set fs=Server.CreateObject("Scripting.FileSystemObject")

    if (fs.FileExists("c:\file.xls"))=true then   'fake filename D:
        response.write("<input type='button' value='Download Masterfile' class='button' onclick='exportmasterfile();' /><br />")
    else
        response.write("Masterfile not found. <br />")
    end if

    set fs=nothing 
```

javascript 函数为空。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-08T10:37:47.640

实际上，如果您想要一种“更高效”（更性感）的方式，请使用：

```
location.href = your_url; 
```

这样，您将节省编译器一些时间，将其从`location`' 的原型链上移至`window`对象。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-08T10:19:25.257

你不会相信的。找到了...

```
function exportmasterfile()
{   var url='../documenten/Master-File.xls';    
    window.open(url,'Download');  
} 
```

对不起大家！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-08T10:21:37.780

如果您的服务器被配置为触发下载该 mime 类型的文件，它就像这样简单：

```
window.location = your_url 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-24T02:58:18.317

这是一个用于下载二进制文件的 VBScript 函数。

```
Function SaveUrlToFile(url, path)
  Dim xmlhttp, stream, fso

  ' Request the file from the internet.
  Set xmlhttp = CreateObject("MSXML2.XMLHTTP")
  xmlhttp.open "GET", url, false
  xmlhttp.send
  If xmlhttp.status <> 200 Then
    SaveUrlToFile = false
    Exit Function
  End If

  ' Download the file into memory.
  Set stream = CreateObject("ADODB.Stream")
  stream.Open
  stream.Type = 1 ' adTypeBinary
  stream.Write xmlhttp.responseBody
  stream.Position = 0 ' rewind stream

  ' Save from memory to physical file.
  Set fso = Createobject("Scripting.FileSystemObject")
  If fso.Fileexists(path) Then
    fso.DeleteFile path
  End If
  stream.SaveToFile path

  SaveUrlToFile = true
End Function 
```

# c# - 在 C# 中更改 ComboBox 荧光笔的颜色

> ID：349075
> 
> 赞同：4
> 
> 时间：2008-12-08T10:18:15.260
> 
> 标签：c#, user-interface, combobox

嘿。我对 ComboBox 中的荧光笔有疑问。最近，我不得不将 ComboBox 中的某些项目变灰，我通过手动（以编程方式）在**ComboBox**中绘制字符串来做到这一点。在**DrawMode.NORMAL**下的 .NET 组合框中，当您单击箭头时，荧光笔将自动出现，并且荧光笔的背景颜色默认为近蓝色。问题是当我们将鼠标移到一个项目上时，悬停项目的前景色变为白色，但是当我们手动绘制项目时（**DrawMode.OwnerDrawVariable**）它不起作用。你能帮我解决这个问题吗？？

这就是我将项目变灰的方式，

```
private void comboBox1_DrawItem(object sender, DrawItemEventArgs e)
{
    e.DrawBackground();
    int index = e.Index;
    CombinationEntry aFunction = comboBox1.Items[index] as CombinationEntry;  //CombinationEntry is a custom object to hold the gray info. Gray if not available and black if available
    if (aFunction.myIsAvailable)
    {
        e.Graphics.DrawString(aFunction.ToString(), new Font("Arial", 10, FontStyle.Regular, GraphicsUnit.Pixel), Brushes.Black, new Point(e.Bounds.X, e.Bounds.Y));
    }
    else
    {
        e.Graphics.DrawString(aFunction.ToString(), new Font("Arial", 10, FontStyle.Regular, GraphicsUnit.Pixel), Brushes.Gray, new Point(e.Bounds.X, e.Bounds.Y));
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-08T16:11:15.313

默认情况下，ComboBox 中的文本以两种颜色之一绘制：

```
SystemColors.WindowText 
```

对于未突出显示的项目，或

```
SystemColors.HighlightText 
```

对于突出显示的项目。

这些颜色不是固定的，但可以由用户配置（例如，通过控制面板）。在典型的 Windows 配色方案中，WindowText 为黑色，HighlightText 为白色，但如果重新配置了配色方案，情况并非总是如此。

为了确保无论用户如何配置他们的系统都能获得正确的颜色，并为突出显示的文本和非突出显示的文本获得适当的颜色，而不是使用 Brushes.Black 作为非禁用文本，使用类似的东西：

```
e.State == DrawItemState.Selected ?
    SystemBrushes.HighlightText : SystemBrushes.WindowText 
```

这基本上是说，如果您正在绘制的项目（e.State）的状态为 Selected（突出显示），则使用 SystemColors.HighlightText，否则使用 SystemColors.WindowText。

您可能还想使用：

```
SystemBrushes.GrayText 
```

而不是 Brushes.Gray，再次以防用户使用非标准配色方案并且纯灰色看起来不正确。而且，您可能还应该使用：

```
comboBox1.Font 
```

而不是创建 Arial 字体，以确保该字体与为表单上的 ComboBox 定义的字体匹配。（同样创建一个 Font 对象而不释放它会导致资源泄漏。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-09T03:20:51.467

Yeah. That was really helpful. Also I tried to do:

```
if (e.State == ((DrawItemState.NoAccelerator | DrawItemState.NoFocusRect) | 
                (DrawItemState.Selected | 
                 DrawItemState.NoAccelerator | 
                 DrawItemState.NoFocusRect)))
{
    e.Graphics.DrawString(aFunction.ToString(), 
                          new Font("Arial", 10, FontStyle.Regular,
                                   GraphicsUnit.Pixel), 
                          SystemBrushes.HighlightText, 
                          new Point(e.Bounds.X, e.Bounds.Y));
} 
```

Which gave me what I expected. I will definetly consider your suggestions on using the system brushes rather than the solid brush. Thanks for your solution.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-12T14:48:42.740

`if ((e.State & DrawItemState.Selected) == DrawItemState.Selected)`将优于 `e.State == DrawItemState.Selected`或试图涵盖所有可能性

# visual-studio - Visual Studio - 有没有办法选择多个文件并围绕每个文件包装一个命名空间？

> ID：349086
> 
> 赞同：1
> 
> 时间：2008-12-08T10:25:38.600
> 
> 标签：visual-studio, automation, namespaces

有没有办法选择文件夹中的所有类并在 Visual Studio 中为每个类分配一个命名空间？

如果没有工具可以做到这一点，是否有一个正则表达式模式可以匹配类声明之前的所有内容，但在导入之后？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-29T19:47:05.933

[Resharper 具有更改](http://www.jetbrains.com/resharper/documentation/help20/Refactoring/renaming.html)文件名称空间的功能。

对于手动解决方案，您可以：

*   关闭解决方案中的所有文件
*   仅打开那些需要更改其命名空间的文件
*   `namespace old`对to执行查找和替换`namespace new`

# c# - 如何在单击按钮时检查gridview列中复选框的状态

> ID：349087
> 
> 赞同：3
> 
> 时间：2008-12-08T10:25:55.200
> 
> 标签：c#, asp.net, javascript

我在gridview中使用了复选框列。我想检查该复选框的状态。单击按钮时，应检查是否选中了任何复选框。如果没有选中任何复选框，那么它应该首先显示选中复选框的警报消息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-08T13:38:10.787

嘿，我找到了答案。如下：

```
function checkBoxselectedornot()
{

       var frm=document.forms['aspnetForm'];
       var flag=false;
       for(var i=0;i<document.forms[0].length;i++)
       {
           if(document.forms[0].elements[i].id.indexOf('chkDownloadSelectedEvent')!=-1)
           {
                 if(document.forms[0].elements[i].checked)
                 {
                      flag=true
                 }  
           }
       } 
      if (flag==true)
      {
        return true
      }else
      {
        alert('Please select at least one Event.')
        return false
      }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-21T07:20:30.263

```
 protected void OnCheckedChanged(object sender, EventArgs e)
        {
            bool flag = false;

            foreach (GridViewRow row in Grid_InvoiceGarden.Rows)
            {
                CheckBox chkItem = (CheckBox)row.FindControl("chkSelect");
                if (chkItem.Checked)
                    flag = true;
            }
            if (flag == true)
            {
                btnUpdate.Visible = true;
            }
            else
            {
                btnUpdate.Visible = false;
            }      
        } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-08T10:30:01.227

```
if(document.getElementById('checkBoxId').checked) {
    //checked
} else {
    //not checked
} 
```

编辑：如果你想检查表单的所有复选框，你可以遍历集合：

```
var inputs = document.getElementById('formId').getElementsByTagName('input');
var isChecked = false
for( var i = 0; i < inputs.length; i++) {
    if(inputs[i].type == 'checkbox' && inputs[i].checked) {
        isChecked = true;
    }
}

if(isChecked) {
    //at least one checkbox checked
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T10:42:50.267

服务器端：

> //在你的按钮点击事件中：
> 
> 布尔标志 = 假；
> 
> for(int i=0;i < gridview1.rows.count;i++)
> 
> {
> if(checkbox1.checked)
> 
> ```
>  flag = true; 
> ```
> 
> }
> 
> 如果（标志）
> 
> {
> 
> //表示至少选中一个复选框
> 
> }

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-08T16:41:14.193

您必须在页面中添加一些自定义 Javascript 才能显示客户端警报。这是我编写的一种方法，它适用于名为“GridView1”的 GridView（如果您刚刚将控件拖到 ASPX 页面上，这应该是默认名称）：

```
<script type="text/javascript">
    function ClientCheck() {
        var valid = false;
        var gv = document.getElementById("GridView1");

        for (var i = 0; i < gv.all.length; i++) {
            var node = gv.all[i];
            if (node != null && node.type == "checkbox" && node.checked) {
                valid = true;
                break;
            }
        }
        if (!valid) {
            alert("Invalid. Please select a checkbox to continue.");
        }

        return valid;
    }
</script> 
```

您可以看到它为`GridView`控件设置了一个变量，然后在循环中遍历所有子控件`for`。如果孩子是 a`checkbox`并且它是`checked`，那么我们将`valid`变量设置为 true。如果我们到达迭代结束并且没有找到选中的复选框，则`valid`保持为 false 并且我们执行警报。

要将其链接到您`GridView`的 ASPX 页面上，首先将按钮列设置为 a并用您的客户端代码`TemplateField`包围。`LinkButton`如果您使用设计器设置列，则可以使用列编辑器中的“将此字段转换为模板字段”链接）。这是您最终会得到的源示例：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" DataSourceID="ObjectDataSource1">
    <Columns>
        <asp:TemplateField HeaderText="Button Field" ShowHeader="False">
            <ItemTemplate>
                <span onclick="return ClientCheck();">
                    <asp:LinkButton ID="LinkButton1" runat="server" CommandName="IDClick" Text='<%# Eval("YourDataSourceItem") %>'></asp:LinkButton>
                </span>
            </ItemTemplate>
        </asp:TemplateField>
        // ...your remaining columns... 
```

使用`TemplateField`允许我们添加我们喜欢的任何客户端代码。在这里，我们添加一个`span`并使用`onclick`来调用我们的`ClientCheck`方法。

如果您不关心警报，您可以通过使用`CustomValidator`在服务器端执行的控件来实现您的目标。

我希望这有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-09T05:45:41.407

```
 <script type="text/javascript" language="javascript">
        function CheckboxSelect() {

            var LIntCtr;
            var LIntSelectedCheckBoxes = 0;

            for (LIntCtr = 0; LIntCtr < document.forms[0].elements.length; LIntCtr++) {
                if ((document.forms[0].elements[LIntCtr].type == 'checkbox') && (document.forms[0].elements[LIntCtr].name.indexOf('chkID') > -1)) {
                    if (document.forms[0].elements[LIntCtr].checked == true) {
                        LIntSelectedCheckBoxes = parseInt(LIntSelectedCheckBoxes) + 1;
                    }
                }
            }
            if (parseInt(LIntSelectedCheckBoxes) == 0) {
                alert('User(s) Must Be Selected For operation !');
                return false;
            }
        }
    </script> 
```

# sql - 一个sql server表可以有两个标识列吗？

> ID：349092
> 
> 赞同：31
> 
> 时间：2008-12-08T10:28:59.933
> 
> 标签：sql, sql-server, identity-column

我需要一列作为主键，另一列自动增加订单号字段。这可能吗？

编辑：我想我只会使用一个复合数字作为订单号。无论如何谢谢。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-12-08T10:46:09.307

```
CREATE TABLE [dbo].[Foo](
    [FooId] [int] IDENTITY(1,1) NOT NULL,
    [BarId] [int] IDENTITY(1,1) NOT NULL
) 
```

返回

```
Msg 2744, Level 16, State 2, Line 1
Multiple identity columns specified for table 'Foo'. Only one identity column per table is allowed. 
```

所以，不，你不能有两个身份列。您当然可以使主键不自动递增（身份）。

编辑：[msdn:CREATE TABLE (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms174979.aspx)和[CREATE TABLE (SQL Server 2000)](http://msdn.microsoft.com/en-us/library/aa258255%28SQL.80%29.aspx)：

> 每个表只能创建一个标识列。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-04-02T14:13:38.317

如果您使用 SQL Server 2012，则可以使用默认值的第二列序列

```
--Create the Test schema
CREATE SCHEMA Test ;
GO

-- Create a sequence
CREATE SEQUENCE Test.SORT_ID_seq
    START WITH 1
    INCREMENT BY 1 ;
GO

-- Create a table
CREATE TABLE Test.Foo
    (PK_ID int IDENTITY (1,1) PRIMARY KEY,
    SORT_ID int not null  DEFAULT (NEXT VALUE FOR Test.SORT_ID_seq));
GO

INSERT INTO Test.Foo VALUES ( DEFAULT )
INSERT INTO Test.Foo VALUES ( DEFAULT )
INSERT INTO Test.Foo VALUES ( DEFAULT )

SELECT * FROM Test.Foo 

-- Cleanup
--DROP TABLE Test.Foo
--DROP SEQUENCE Test.SORT_ID_seq
--DROP SCHEMA Test 
```

[http://technet.microsoft.com/en-us/library/ff878058.aspx](http://technet.microsoft.com/en-us/library/ff878058.aspx)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-05-21T08:44:02.423

添加一个标识列，然后添加一个计算列，其公式为标识列的名称

现在两者都将同时增加

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-05-29T15:35:09.220

不，不可能有多个标识列。

企业管理器甚至不允许您将 > 1 列设置为身份。当第二列成为身份时

另请注意，@@identity 返回打开连接的最后一个标识值，如果一个表可能有多个标识列，这将毫无意义。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-23T19:58:11.563

```
create table #tblStudent
(
    ID int primary key identity(1,1),
    Number UNIQUEIDENTIFIER DEFAULT NEWID(),
    Name nvarchar(50)
) 
```

两个标识列是不可能的，但如果您接受使用唯一标识符列，那么此代码也可以执行相同的工作。您还需要一个额外的列 - 名称列 - 用于插入值。

示例用法：

```
insert into #tblStudent(Name) values('Ali')

select * from #tblStudent 
```

* * *

Ps：[NewID()](http://msdn.microsoft.com/en-us/library/ms190348.aspx)函数创建一个uniqueidentifier 类型的唯一值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-08T10:35:37.627

主键不需要是标识列。

您不能有两个身份列。

你可以用触发器得到接近你想要的东西......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-08T10:34:25.120

在 sql server 中，不能有多个列作为标识。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-13T12:16:38.567

我刚刚创建了一个代码，允许您在同一张表上插入两个身份。让我与您分享以防万一：

```
create trigger UpdateSecondTableIdentity
On TableName For INSERT
as
update TableName
set SecondIdentityColumn = 1000000+@@IDENTITY
where ForstId = @@IDENTITY; 
```

谢谢，

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-09-17T19:42:43.820

一种解决方法是创建一个递增计数器的 INSERT 触发器。

所以我有一个表，它有一个标识 col：applicationstatusid。它也是主键。我想自动增加另一个 col: applicationnumber

所以这是我写的触发器。

```
 create trigger [applicationstatus_insert] on [ApplicationStatus] after insert as 
       update [Applicationstatus] 
       set [Applicationstatus].applicationnumber =(applicationstatusid+ 4000000) 
       from [Applicationstatus] 
       inner join inserted on [applicationstatus].applicationstatusid = inserted.applicationstatusid 
```

# perl - Mason 是一个框架吗？

> ID：349094
> 
> 赞同：14
> 
> 时间：2008-12-08T10:29:17.953
> 
> 标签：perl, web-applications, frameworks, mason

我一直在和一个朋友争论 Mason (Perl) 不是一个框架，而是一种模板语言。我觉得 Mason for Perl 做了 JSP 为 Java 做的事情（作为一个类比，而不是纯粹的技术比较）。据我所知，JSP 不是一个框架，我觉得 Mason 也不是。当我查看 wikipedia [Mason (Perl)](http://en.wikipedia.org/wiki/Mason_%28Perl%29)时，我看到主站点说它是一个用 Perl 编写的 Web 应用程序框架，而讨论页面对它提出了质疑。

关于它为什么是/它不是框架的任何指示？

根据 ysth 的评论进行更新：对于一个框架，我认为它至少应该使数据库访问变得容易、管理会话、webapp 所需的基本安全性、模板和代码重用（或使基本任务变得简单的库）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-08T21:58:59.777

Mason 是 MVC（模型-视图-控制器）框架的缩写。它提供了广泛的渲染（视图）功能，这就是为什么人们认为 Mason 是一种模板语言。然而，它也提供了相当多的调度机制（特别是 dhandler 的形式）和控制机制（很自然地适合自动处理程序）。

几年前，我写了一个[在线教程](http://perltraining.com.au/talks/whirlwind/)（在 Mason 中）来展示其中的一些功能。它针对全屏显示进行了优化，并且需要启用 javascript。

Mason 没有给你的是数据库抽象层，所以你必须自带 Model。

[据我所知，amazon.com 和许多其他网站](http://masonhq.com/?MasonPoweredSites)都是用 Mason 编写的。

如果您喜欢与 Mason 一起工作，但又想拥有一个模型、更多玩具和一匹小马，那么您可以考虑将[Jifty](http://jifty.org/)视为一个 Web 应用程序框架。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-08T10:41:10.050

模板系统类似于`HTML::Template`，即只做模板的模块。

我觉得它`Mason`做得更多，它以某种方式具有路由机制，但它提供了参数处理`%ARGS`，通过`%INIT`.

它还提供接口`mod_perl`，`CGI`...

现在，它不与数据库对话，就好像您想要一种干净的方式来做到这一点，您必须使用`Class::DBI`,`DBIx::Perlish`或其他数百个执行对象映射的 perl 模块中的一个，或者其他任何东西......

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-08T11:56:13.613

不看它就无法回答 HTML::Mason 是否是框架的问题，但我总是对以下定义感到满意....

> “一个框架调用你的程序，而你的程序调用一个库”

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-08T14:27:08.893

它不是[模型-视图-控制器](http://en.wikipedia.org/wiki/Model-view-controller)类型的框架，例如它可能比 Ruby on Rails 更接近 PHP（并且从我所看到的情况来看同样糟糕）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-08T14:13:56.393

[用 Mason 的竞争观点来看待 HTML 中的 Embedded Perl](http://www.masonbook.com/book/chapter-1.mhtml#TOC-ANCHOR-7)，我会说它是一种模板语言。否则[Catalyst](http://www.catalystframework.org/)和[Maypole](http://maypole.perl.org/)会在名单上。另外，我想我在某处读到过，您可以使用 Mason 作为 Catalyst 应用程序中的[视图](http://search.cpan.org/dist/Catalyst-View-Mason/lib/Catalyst/View/Mason.pm)部分。

我想我可以看到你可以在哪里像框架一样使用它，但是如果你将它视为模板语言，它似乎更完整。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-27T10:52:19.573

Mason 本身并不是一个框架，它只是一个模板系统，但具有一些非常酷的功能。它有自己的结构，你可以很容易地在其中嵌入 perl 代码，它还支持缓存。我见过有人单独使用 Mason 来开发大型应用程序，但我想它在 MVC 框架中效果更好。

小心！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-01-19T21:43:22.837

HTML::Mason 是框架在变老后想要成为的样子。使用 HTML::Mason 你会得到：

*   调度员
*   模板
*   缓存
*   日志记录
*   极其灵活的模块化

它是为高性能的多层 Web 应用程序而设计的，而不是为了取悦从桌面编程（例如 MVC）中借来的设计模式的粉丝。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-25T23:33:56.050

下面的框架定义取自 Gamma 关于设计模式的书。“框架是一组协作类，它们构成了特定软件类的可重用设计。” 根据这个定义，Mason 是一个框架。MVC 框架只是一种框架。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-08T10:36:40.793

取决于您对框架的定义。

如果名称框架不止一件事，您可以将名称框架应用于任何库。

# java - 为什么我的 Java 网络服务不能与我的 Perl 后端通信？

> ID：349103
> 
> 赞同：0
> 
> 时间：2008-12-08T10:31:11.710
> 
> 标签：java, perl, web-services

在我们的项目中，Java webservice 与用 C 和 Perl 编写的后端程序进行通信以进行处理。我们正在使用 ProcessBuilder 来执行后端 (UNIX) 作业 FrameworkHandler。

```
ProcessBuilder process;
process.Start(FrameworkHandler -a ACTION) 
```

FrameworkHandler 调用 Perl 脚本来执行某些操作。Perl 脚本在内部执行两个 XML 文件之间的差异命令，并使用 print 函数打印错误：

```
sub print_error
{
    $err_msg = shift;
    print STDERR "$err_msg\n";
} 
```

每当文件之间存在差异时，Perl 程序就会在 print_error 函数中挂起。如果我们在 UNIX shell 中执行 Perl 程序，它可以正常工作。但是如果我们通过 webservice 执行 Perl，它不会在 diff 命令之后返回。因此，Web 服务也没有返回响应。XML 标记中的大于 (>) 符号是否存在问题？

任何帮助深表感谢。

部分错误：

* * *

```
< diff -udr --new-file --label=postProcess1 --label=postProcess2 postProcess1 postProcess2
< --- postProcess1
< +++ postProcess2
< @@ -124,6 +124,36 @@
<               <LOCATION></LOCATION>
<               <ADDRESS_PART1>Test Address ^D</ADDRESS_PART1 >
<         </address_details>
< +       <address_details>
< +             <CITY></CITY>
< +             <STATE>12</STATE> 
```

* * *

谢谢， 马修 Liju

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T10:43:54.570

[API 文档](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Process.html)说：

“由于部分原生平台只为标准输入输出流提供有限的缓冲区大小，未能及时写入子进程的输入流或读取输出流，可能导致子进程阻塞，甚至死锁。”</p>

你遵守了吗？

# mysql - MySQL 查询所有列的 max()

> ID：349108
> 
> 赞同：3
> 
> 时间：2008-12-08T10:33:33.483
> 
> 标签：mysql, max

使用单个查询检索表中所有列的最大值的正确方法是什么？谢谢。

澄清：相同的查询应该适用于任何表，即列名不会被硬编码到其中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-08T10:35:52.043

```
SELECT max(col1) as max_col1, max(col2) as max_col2 FROM `table`; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T10:54:50.367

我认为（但很高兴显示错误）您必须至少知道表中的列数，但是您可以这样做：

```
select max(c1),max(c2),max(c3),max(c4),max(c5)
from (
    select 1 c1, 1 c2, 1 c3, 1 c4, 1 c5 from dual where 0
    union all
    select * from arbitrary5columntable
) foo; 
```

显然，您失去了索引的任何好处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T11:06:39.283

您将不得不分两步进行 - 第一步检索表的结构，然后第二步检索每个表的最大值

在 php 中：

```
$table = "aTableName";
$columnsResult = mysql_query("SHOW COLUMNS FROM $table");

$maxValsSelect = "";
while ($aColumn = mysql_fetch_assoc($columnsResult)) {
  if (strlen($maxValsSelect) > 0) {
    //Seperator
    $maxValsSelect .= ", ";
  }  

  $maxValsSelect .= "MAX(" . $aColumn['Field'] . ") AS '" . $aColumn['Field'] . "'";
} 

//Complete the query
$maxValsQuery = "SELECT $maxValsSelect FROM $table";
$maxValsResult = mysql_query($maxValsQuery);

//process the results.... 
```

# .net - System.Diagnostics：如何使用身份登录

> ID：349119
> 
> 赞同：1
> 
> 时间：2008-12-08T10:37:51.523
> 
> 标签：.net, logging, impersonation, system.diagnostics

我已经实现了基于 System.Diagnostics 的跟踪。

我还在使用 System.Diagnostics.TextWriterTraceListener，并将整个跟踪连接到 MOSS 2007 Web 应用程序。

由于某种原因，跟踪尝试 (a) 创建日志文件，和/或 (b) 使用**当前正在浏览 SharePoint 站点的用户**写入日志文件，有没有办法配置日志记录以使用特定的用户帐户而不是？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T15:03:08.820

显然，MOSS 被配置为使用 Windows 身份验证（kerberos）和模拟。如果您不需要模拟当前登录到 moss 的用户，请关闭模拟（在 web.config 中）。您会发现日志文件将由运行 moss 安装的应用程序池的用户创建和写入。

如果您必须使用模拟，那么另一种解决方案是授予每个人在日志目录中创建和写入文件的权限（并且只能在日志目录中）。然而，这并不是最好的主意。您可以禁止所有人的读取权限，但需要读取日志的人除外，但您仍然需要担心有人试图通过填满磁盘来攻击您。

第三种选择是在登录之前切换身份。像这样的东西可能会起作用：

```
var wic = WindowsIdentity.Impersonate(IntPtr.Zero); // "revert to self"
/* LOG GOES HERE K */
wic.Undo(); // return to impersonation 
```

大警告：我自己只是在学习这些东西，所以上面的代码可能根本不起作用。如果是这样，那就太好了，因为您无需 p/invoke 即可登录您的日志编写身份，这也意味着您不必创建该用户并将其密码以明文形式存储在您的应用程序中。

我想知道这个的老斯基特在哪里？Windows 安全需要一些繁重的工作；我现在刚开始在酒吧...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T12:08:50.827

请不要告诉我这是必要的 - [http://www.15seconds.com/Issue/040511.htm?voteresult=5](http://www.15seconds.com/Issue/040511.htm?voteresult=5)

# visual-studio - 是否有一种简单的方法可以在运行时重新创建 WinForms 布局体验，以便用户定位控件

> ID：349121
> 
> 赞同：2
> 
> 时间：2008-12-08T10:38:29.930
> 
> 标签：visual-studio, winforms, layout, editor

在 Visual Studio 中布局 WinForm 时，您可以使用拖动句柄和边框对齐提示轻松调整控件大小和对齐控件。

我想对运行时控件做同样的事情，以使用户能够在页面上放置图像。

例如，如果用户有一张照片，并且他们想将其作为桌面背景放置，我希望该控件可以帮助他们在迷你桌面视觉效果中移动和调整照片缩略图的大小。

我可以做到这一切，但我真正的问题是，有没有人知道一种从标准 WinForms 布局编辑器继承的方法，以便我可以选择使用漂亮的停靠、对齐提示和控件调整大小而无需再次编码？

提前致谢

瑞安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T10:41:12.890

我不知道容易，但是您可以在自己的应用程序中托管实际的 winforms 设计器，而不会出现太多问题。请参见[此处](http://msdn.microsoft.com/en-us/magazine/cc163634.aspx)。

# sql-server - 单用户：关闭 Microsoft SQL Server 的锁定

> ID：349126
> 
> 赞同：1
> 
> 时间：2008-12-08T10:41:13.263
> 
> 标签：sql-server, performance

我正在针对托管在 Microsoft SQL Server 中的数据库运行升级脚本。这需要一段时间。由于各种原因，一些查询不值得进一步优化。

我是唯一使用这个数据库的人：有没有办法让 SQL Server 不用担心事务/锁定？

例如，在 DELETE ... WHERE 上，SQL 是否需要在即将删除的行上获得排他锁？如果是这样，我可以告诉它不要打扰，因为这是唯一正在运行的查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T11:07:58.623

请参阅[SQL 查询性能 - 你觉得脏吗？（脏读）](http://blogs.neudesic.com/blogs/phil_scott/archive/2005/12/05/11.aspx)。

编辑：这只是推测，但如果您是与 SQL Server 的唯一连接，则可以使用`WITH (TABLOCKX)`. 您正在牺牲并发性，但它可能会变得更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T13:43:33.303

关闭自动提交（又名隐式事务）；你需要在最后做一个 commit() 。日志文件会相应变大，请确保您有足够的磁盘空间。tempdb 在同一个磁盘上吗？

# email - 没有 POP 或 IMAP 的邮件客户端

> ID：349127
> 
> 赞同：2
> 
> 时间：2008-12-08T10:41:54.107
> 
> 标签：email, gtk

我的大学拒绝允许我们通过 POP 或 IMAP 等方式访问邮件，所以我想编写一个基于 GTK 的 C 应用程序，它位于我的通知区域并完成邮件客户端通知程序的工作。因为我不能使用 POP 或 IMAP 之类的东西，所以有什么好的方法呢？我想我可以抓取 HTML 并查找仅存在于未读邮件或其他内容中的标签？

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T11:03:38.353

我知道你说的是 C/GTK，但它是 Python/GTK 中的小菜一碟，带有 urllib2、libcookie 和 BeautifulSoup。这样您就不必处理原始套接字，也不必自己解析 HTML。地狱，如果您使用指向源的链接来编辑您的问题，我可以立即为您解决这个问题。但是，如果您将其作为插座练习进行，那么您将获得更多力量：P

您应该注意，大多数服务器管理员不会过于频繁地抓取他们的网站，并且您应该与他们一起清除它，以免受到影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T10:45:55.673

是的，如果访问您的电子邮件的唯一方法是通过网络邮件，那么您创建的任何工具都必须使用网络邮件标记来处理新消息。

我个人会尝试找出为什么不允许使用 POP/IMAP。就我而言，这是一个非常奇怪的政策。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T11:01:04.597

在之前的工作中，当时我们唯一可以通过网络邮件（squirrelmail）访问电子邮件，我写了一个 Perl 脚本`WWW::Mechanize`，通过页面获取电子邮件，通过 smtp 将它们发送到外部邮箱，删除它们，并清除垃圾...

大约有 20/25 行代码。当然，C 版本会更大一些，因为它没有`WWW::Mechanize`:-)

# java - 错误正在加载罐子

> ID：349131
> 
> 赞同：0
> 
> 时间：2008-12-08T10:43:51.823
> 
> 标签：java, classpath, ejb

我在我的应用程序中发现 NoClassDefintion 错误，即使我耳朵的 lin 文件夹中有相关的 jar，错误是

`java.rmi.RemoteException: EJB Exception: ; nested exception is: java.lang.NoClassDefFoundError: com/sun/rave/web/ui/model/Option`

注意我已经在我的 Eclipse 中添加了相同的用户库，它没有显示任何编译错误这个错误只是在运行时......！！！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T10:46:41.007

我有一段时间没有使用 EJB，但我似乎记得必须为 EJB 设置不同的类路径。我认为您必须在 EJB jar 的 manifest.mf 文件中设置它。

一个快速的谷歌出现了[这个线程](http://publib.boulder.ibm.com/infocenter/wasinfo/v4r0/topic/com.ibm.support.was40.doc/html/Classloader/swg21052375.html)，建议你需要输入：

`Class-Path: jar1.jar, jar2.jar`

在您的 manifest.mf 文件中。

您可能还会发现[此页面](http://edocs.bea.com/wls/docs70/programming/classloading.html)（向下滚动到底部）和[此](http://java.sun.com/j2se/1.4.2/docs/guide/jar/jar.html#JAR)页面（搜索“Class-Path”）很有帮助。

# c# - TabControl 选项卡标题在更改字体时调整大小

> ID：349133
> 
> 赞同：2
> 
> 时间：2008-12-08T10:45:31.977
> 
> 标签：c#, winforms, tabcontrol

我有一个在 Vista 中运行时将每个控件的字体更改为 SegoeUI 的应用程序。它工作正常，除了标签页的标题（从一个标签切换到另一个标签时要单击的按钮）。

标签页标题不会垂直增长以适应更大的字体大小，它们始终保持相同的高度。

是否有允许 TabControl 处理此问题的属性？（我尝试过 AutoSizeMode，但它只处理选项卡的宽度）

如果不是，那么基于字体大小以编程方式调整标签页标题大小的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-08T12:33:02.493

选项卡控件上有一个 ItemSize 属性，您可以设置它来更改选项卡本身的大小。此外，为了帮助您获取文本的大小，Graphics 对象上有一个 MeasureString() 方法，该方法将为您返回具有给定文本大小的 SizeF 结构。这可以帮助您确定是否需要更改 ItemSize 属性。一些粗略的代码：

```
 Graphics g = this.tabControl1.TabPages[0].CreateGraphics();
            SizeF s = g.MeasureString(this.tabControl1.TabPages[0].Text, this.tabControl1.TabPages[0].Font); 
```

# cocoa - OS X 线程间通信问题

> ID：349142
> 
> 赞同：3
> 
> 时间：2008-12-08T10:47:16.607
> 
> 标签：cocoa, multithreading, macos

我正在 Cocoa 中开发一个多线程应用程序。主线程从用户那里获取值，当单击按钮时，我会调用一个辅助线程，其中会进行长时间的计算。现在从这个线程我必须将计算的每一步的输出返回到主线程。我想定期将数据从一个线程发送到另一个线程。我找不到任何这样做的简单示例。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-08T11:40:47.870

有很多方法可以做到这一点，按照复杂程度的粗略顺序（最简单的优先）：

*   使用 NSObject 的 performSelectorOnMainThread:withObject:waitUntilDone: 非常不言自明。
*   使用 performSelector:onThread:withObject:waitUntilDone:，这会让你走另一条路
*   使用 NSNotification（和 NSDistributedNotificationCenter），但如果你不小心，很容易陷入竞争状态
*   使用 NSPorts 来回发送数据

查看 Abizer 提到的文档，了解所有这些的详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T17:11:44.927

`performSelectorOnMainThread:withObject:waitUntilDone:`通常是使用后台线程的进度更新 UI 的最简单方法。您还可以创建自己的存储区域，使用 NSLock 或类似机制在线程之间安全访问，甚至使用分布式对象（也可以在进程之间或通过网络工作）。

然后是 NSOperationQueue 和 NSOperation，它们确实有助于简化多线程编程，尽管很多程序员一直在避免使用它，因为它在 Leopard 下的某些情况下会导致崩溃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T11:05:58.130

请查看 Apple 文档。

您可能需要创建一个 ADC 会员帐户，但这是免费的

[多线程 Cocoa 程序](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CocoaFundamentals/AddingBehaviortoaCocoaProgram/chapter_4_section_6.html)

# asp.net - ASP.NET MVC 多久才能在工业中得到广泛应用？

> ID：349150
> 
> 赞同：6
> 
> 时间：2008-12-08T10:50:34.960
> 
> 标签：asp.net, asp.net-mvc

我正在尝试决定是否学习 ASP.NET MVC（或者花时间学习另一种我感兴趣的技术）。我知道这是一个优雅的框架，但如果我投资于这项技能，我正在尝试评估我未来的工作机会。根据您的估计，在 ASP.NET MVC 开发人员的需求与其他顶级 Web 开发框架中的开发人员相媲美之前，需要多长时间？是一年的事情吗？2年？3+？在相关的说明中，您是否认为 ASP.NET MVC 在可预见的将来会超越经典的 ASP.NET？Scott Guthrie 说这两者将并存，但我很好奇 ASP.NET MVC 预计会占据多少份额。

我知道这是一个推测性的问题；我只是对你的主观预感感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T11:21:03.417

对于主流采用，我不认为它会在 RTM 之后真正起飞。最初的工作将仅限于新项目，我怀疑在经济现状的情况下可能会减少。当有更多已建立的项目需要维护时，工作岗位的真正增加将会到来。

至于超越最初的 ASP.NET，这将在更多旧项目退役时发生，无论是一次性完成，还是部分被新的 MVC 功能取代。

就个人而言，我现在至少会学习基础知识，以便为 RTM 之后的增加做好准备。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-08T11:37:07.987

> “但如果我投资这项技能，我会尝试评估我未来的工作机会”

如果您想增加未来的工作机会，那么您应该问自己的是；“我今天能做的最酷最有趣的事情是什么？”

因为如果你想到“什么会让你变得有价值”，你最终会变得平庸。然而，如果你做*有趣*的事情，你最终会创造出很少有人有能力超越的能力——这在世界上似乎总是很有价值...... ;)

更不用说你的职业生涯会好很多！

做有趣的事，做你最“踢”的事，*那么*你的“价值”就会增加！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T10:58:39.673

我知道一些公司，包括我自己的公司，正在适应 asp.net mvc 并将其用于几乎所有项目。

即使它是 Beta，我仍然看到它被广泛使用。这可能是因为 ASP.NET 是一种强大的网络语言，公司越来越适应更好、更先进的技术，例如 .net。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T11:08:51.710

在我们公司，它正在成为新项目的事实标准，我们目前正在将我们的主要网站从 ColdFusion Mach-II 移植到 ASP.NET MVC，因为两者都是 MVC 环境，我认为 MVC 是一种优于 Web 表单和代码隐藏模型的架构模式。

鉴于 Microsoft 在这方面投入了大量时间和精力，我认为它不会以任何方式消失，尤其是当您拥有 IronRuby 等令人兴奋的东西时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-08T11:25:24.080

我认为这两种选择都会存在很长时间。

当前的趋势似乎是面向 RESTful 应用程序等，我预计 MVC 会越来越流行。然而，一些项目更适合现有的 webforms 风格，而另一些项目将从 MVC 中受益匪浅。

MVC 很棒，学习基础知识不会花很长时间。浏览 Scott Guthries 博客上的教程（尽管一些早期的东西已经过时并且语法已经改变）

MVC 确实有一些缺点：

MVC 不使用视图状态。这有正面（更小的页面、更快、更干净的模型）和负面的观点。虽然并非不可能，但开发项目（例如需要维护状态的控件，例如分页数据网格等）会比较棘手

许多公司已经对现有的网络表单技术进行了投资

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T11:26:46.543

我也知道一些常规公司已经在开发它，还有一些正在考虑使用它。我认为它已经处于一个普通的 asp.net 程序员明智地修补它的阶段。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-08T16:18:39.573

我们将它用于我们的下一个项目。在使用它发布项目之前，它不需要是 RTM。它只需要通过 QA。

# autocomplete - 自动完成建议如何工作？

> ID：349155
> 
> 赞同：14
> 
> 时间：2008-12-08T10:52:10.637
> 
> 标签：autocomplete

例如，如果您在 Firefox 的右上角 google/yahoo 搜索框中输入内容，则会出现某种“建议自动完成”之类的内容。

另一个例子是在这个问题预览下方的 youtube 搜索框和 Stackoverflow 标签编辑框中。它们是如何工作的？他们背后的技术是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-09-04T16:13:50.253

> 他们背后的技术是什么？

如果您想知道下面使用的是哪种数据结构，那么它称为“ **trie** ”，并且与尝试相比使用更少的空间，您可以使用**“DAFSA”**

> 它们是如何工作的？

两者都实现为树，其中树的每个节点对应于字符串中的一个字符，之前出现的字符是稍后出现的字符的父级，例如字符串“tap”、“taps”、“top”和“tops” " 存储在 Trie（左）和 DAFSA（右）中，因此当您开始键入 tap.. 根据键入的字符遍历树并根据分配给每个单词的某些权重显示建议时，可能会分配权重根据单词的使用频率。

[![弦乐](https://i.stack.imgur.com/sVnDS.png)](https://i.stack.imgur.com/sVnDS.png)

在最坏的情况下查找字符串是 O(m) 时间，其中 m 是字符串的长度。

图片来自维基百科文章：[DAFSA](https://en.wikipedia.org/wiki/Deterministic_acyclic_finite_state_automaton)，[trie](https://en.wikipedia.org/wiki/Trie)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-08T11:06:08.720

这是使用 AJAX 完成的，这个网站上有一个很好的教程： [AJAX Suggest Tutorial](http://www.dynamicajax.com/fr/AJAX_Suggest_Tutorial-.html)和[WaybackMachine 版本，因为网站似乎关闭了](https://web.archive.org/web/20170129160828/www.dynamicajax.com/fr/AJAX_Suggest_Tutorial-.html)。

据我所知，一个带有关键字和一些代码的数据库就是它的全部内容。

我现在正在学习如何实际使用它，用于工作。:)

另一个资源是[w3schools](https://www.w3schools.com/js/js_ajax_intro.asp)。他们也涵盖了它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-08T11:09:31.740

他们通常使用 JavaScript：

*   查看所有可能值的本地数组
*   在后台请求另一个页面（即/autocomplete.php?q=partialText）。
*   调用网络服务。

当 JavaScript 有要显示的条目列表时，它会修改页面以显示自动完成框。

如果您想在您的网站上放置一个自动完成框，我已经使用并发现以下内容非常好。它还基于流行的 jQuery 框架。

[jQuery自动完成插件](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-01T17:12:23.943

这很简单。

客户端：

1.  抓取表单字段中的击键
2.  在击键时向服务器发出 AJAX 请求
    1.  如果立即输入另一个按键，则取消当前的 AJAX 请求，因为它现在已过时
    2.  在表单字段中使用更新的字符请求新的 AJAX
3.  显示服务器对客户端的响应

服务器端：

1.  所有单词都已按字母顺序分组
2.  如果客户请求输入“ove”，则查找所有以 ove 开头的单词，按受欢迎程度排序
3.  将热门匹配返回给客户端

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-04T19:00:03.650

*在Smashing Magazine*文章（下面的链接）中有一个优秀的开源国家选择器，其中讨论了**简单的自动完成解决方案的****可用性挑战**，并修复了它们。

 **虽然我是 UX，而不是 Dev，但我确信聪明的开发人员可以调整这个开源代码来处理其他类型的选择——而不仅仅是国家/地区的名称。:)

*   [描述此选择器解决的可用性问题的文章](http://uxdesign.smashingmagazine.com/2011/11/10/redesigning-the-country-selector/)。

*   [演示和开源下载](http://baymard.com/labs/country-selector)。尝试一下！

免责声明：我与制作此国家/地区选择器的人没有任何关系。我只是碰巧知道它，我喜欢与开发人员 FWIW 分享有关可用性的信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T11:44:26.537

有很多答案，因为它们有不同的实现。[我们的 AutoCompleter，您可以通过引发一个事件在Stacked](http://stacked.ra-ajax.org/)中看到一个示例，然后在 .ASPX 页面的代码隐藏中处理该事件，您可以从该页面使用您希望的任何控件填充 ControlCollection。然而，我们在 Stacked 中只使用文本内容作为锚链接的文字控件。但如果我们愿意，我们可以添加复选框或图像...

如果您使用的是 ASP.NET，我们的 AutoCompleter 是一个很好的起点。如果您在“其他”方面，那么可能 ScriptAculous AutoCompleter 是另一个不错的起点......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-09T08:38:06.703

我最近也在研究自动完成功能，我们使用 lucene 来索引要在自动完成中显示的文本。使用 lucene 搜索速度很快。使用自动完成数据时需要注意的事项：

1.  新鲜的建议，
2.  对长期数据的依赖，
3.  区域依赖，
4.  语言依赖

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-03-01T01:29:11.770

## 2022 年更新

标记的答案有点过时了。建议自动完成在表面上看起来像魔术，但实际上它在引擎盖下是

*   快速异步通信和
*   搜索关键字列表

将字符串发送到您的数据库，然后以 JSON 格式返回响应以循环/迭代。然后作为用户类型重复。

一个很好的例子是使用[YELP Fusion](https://www.yelp.com/developers/documentation/v3/autocomplete)完成的。

下面是小型库 autocomplete.js 的示例

```
$(function () {
var availableTags = [
"ActionScript",
"AppleScript",
"Asp",
"BASIC",
"C",
"C++",
"Clojure",
"COBOL",
"ColdFusion",
"Erlang",
"Fortran",
"Groovy",
"Haskell",
"Java",
"JavaScript",
"Lisp",
"Perl",
"PHP",
"Python",
"Ruby",
"Scala",
"Scheme"
];
$(".sbx-custom__input").autocomplete({
source: availableTags
});
});
```

```
<!--jqueryui-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>

<!--autocompletejs-->
<script src="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@10.2.6/dist/autoComplete.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@10.2.6/dist/css/autoComplete.min.css">

<!--input-->
<input class="sbx-custom__input" autocomplete="on" required="required" placeholder="autocomplete...">
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-02-01T17:19:36.223

[这是 MooTools 的一个](http://digitarald.de/project/autocompleter/)。

# php - 如何使用 RegEx 匹配方括号文字？

> ID：349156
> 
> 赞同：28
> 
> 时间：2008-12-08T10:52:13.210
> 
> 标签：php, regex, string

匹配方括号的正则表达式是什么？我正在使用`\\]`in 中的模式`eregi_replace`，但似乎无法找到`]`...

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-12-08T11:02:10.790

`\]`是正确的，但请注意 PHP 本身也`\`具有转义字符，因此您可能必须使用`\\[`（或不同类型的字符串文字）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-08T11:01:30.260

完美运行：

```
<?php
    $hay = "ab]cd";
    echo eregi_replace("\]", "e", $hay);
?> 
```

输出：

```
abecd 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-08T15:28:50.827

有两种方法可以做到这一点：

```
/ [\]] /x;

/  \]  /x; 
```

虽然您可能认为后者是更好的选择，但实际上我会考虑在更简单的正则表达式中使用它。我会考虑前者，这是更大的正则表达式的更好选择。考虑以下：

```
/ (\w*) (  [\d\]] ) /x;

/ (\w*) ( \d | \] ) /x; 
```

在这个例子中，前者是我的首选解决方案。它在组合单独的实体方面做得更好，这些实体可能在给定的位置都匹配。它还可能具有一些速度优势，具体取决于实施。

*注意：这是在 Perl 语法中，部分是为了确保正确突出显示。*
*在 PHP 中，您可能需要在反斜杠上加倍。* `"[\\]]"`和`"\\]"`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-08T12:56:26.830

您无需对其进行转义：如果被隔离， ] 将被视为常规字符。
用 eregi_replace 和 preg_replace 测试。

[是另一只野兽，你必须逃脱它。对于两个正则表达式系列，PHP 似乎都将单引号和双引号、单引号或双引号都视为相同。

也许你的问题在你表达的其他地方，你应该完整地给出它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-08T11:29:30.717

您的问题可能来自您使用 eregi_replace 的事实，第一个参数用简单的引号括起来：

```
 '\[' 
```

但是，在[双引号](http://us2.php.net/manual/en/language.types.string.php#language.types.string.syntax.double)中，它可以根据上下文很好地工作，因为它[改变了将参数](http://www.weberdev.com/get_example-3838.html)传递给函数的方式（简单引号只是传递字符串而没有任何解释，因此需要加倍为“\”字符）。

在这里，如果`"\["`被解释为转义字符，你仍然需要加倍“\”。

注意：根据您的评论，您可以尝试正则表达式

```
<\s*(?:br|p)\s*\/?\s*\>\s*\[ 
```

为了检测a或 a`[`之后的右`<br>``<p>`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T11:48:34.453

在 .Net 中，您通过添加反斜杠来转义特殊字符；“\”表示它会变成；“[”...

尽管由于您通常在*字符串文字*中执行此操作，因此您要么必须执行此类操作；

```
@"\[" 
```

或类似的东西；

```
"\\[" 
```

# multithreading - 使用 SEDA 和 C# 的经验？

> ID：349172
> 
> 赞同：1
> 
> 时间：2008-12-08T10:59:48.517
> 
> 标签：multithreading, events, c#-3.0

我正在考虑 SEDA。我们目前设计的应用程序（作为服务在服务器上运行）必须是多线程的和基于消息/事件的。

SEDA 的想法非常有趣，应该匹配。但是我找不到有关使用它的经验的文章等。

我现在的问题是：

*   你是使用 ActiveMQ、MSMQ 来实现队列还是有一个自写的类作为队列？我们曾经编写过一个线程安全的 FIFO 队列类，它在多线程环境中非常有用。

*   Fit 是 .NET 的线程池类，还是您实现了自己的 Threadpool / sheduler？

有什么陷阱/好的做法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T09:04:01.943

似乎没有人在这个话题上做过什么。

所以我们决定实现我们自己的（线程安全的）消息传递基础设施。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-22T02:22:44.570

你应该看到我确实找到的这篇博文。我目前正在研究这个主题。

[http://surana.wordpress.com/2010/01/07/seda-on-net/](http://surana.wordpress.com/2010/01/07/seda-on-net/)

# python - 将数据结构格式化为逗号分隔的参数列表

> ID：349175
> 
> 赞同：6
> 
> 时间：2008-12-08T11:00:39.513
> 
> 标签：python, refactoring, list

我需要将列表（或字典）转换为逗号分隔的列表以传递给另一种语言。

有没有比这样做更好的方法：

```
 result = ''
 args = ['a', 'b', 'c', 'd']

 i = 0
 for arg in args:
     if i != 0:    result += arg
     else:         result += arg + ', '
     i += 1

 result = 'function (' + result + ') 
```

谢谢，丹

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-08T11:03:54.780

`', '.join(args)`会成功的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-08T11:09:37.607

```
'function(%s)' % ', '.join(args) 
```

生产

```
'function(a, b, c, d)' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-09T02:39:34.530

```
result = 'function (%s)' % ', '.join(map(str,args)) 
```

我建议使用 map(str, args) 而不仅仅是 args，因为您的某些参数可能不是字符串，并且会导致 TypeError，例如，您的列表中有一个 int 参数：

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: sequence item 0: expected string, int found 
```

当您进入 dict 对象时，您可能希望用逗号分隔 dict 的值（大概是因为这些值是您想要传递给此函数的值）。如果您对 dict 对象本身执行 join 方法，您将分离键，如下所示：

```
>>> d = {'d':5, 'f':6.0, 'r':"BOB"}
>>> ','.join(d)
'r,d,f' 
```

你想要的是以下内容：

```
>>> d = {'d':5, 'f':6.0, 'r':"BOB"}
>>> result = 'function (%s)' % ', '.join(map(str, d.values()))
>>> result
'function (BOB, 5, 6.0)' 
```

但是，请注意您遇到的新问题。当您通过连接函数传递一个字符串参数时，它会丢失它的引用。因此，如果您打算传递字符串，那么当传递给函数时，您会丢失通常围绕字符串的引号（字符串在许多通用语言中都被引用）。但是，如果您只是传递数字，那么这对您来说不是问题。

解决我刚才描述的问题可能有更好的方法，但这里有一种方法可以为您工作。

```
>>> l = list()
>>> for val in d.values():
...   try:
...     v = float(val) #half-decent way of checking if something is an int, float, boolean
...     l.append(val) #if it was, then append the original type to the list
...   except:
...     #wasn't a number, assume it's a string and surround with quotes
...     l.append("\"" + val + "\"")
...
>>> result = 'function (%s)' % ', '.join(map(str, l))
>>> result
'function ("BOB", 5, 6.0)' 
```

Now the string has quotes surrounding itself. If you are passing more complex types than numeric primitives and strings then you probably need a new question :)

One last note: I have been using d.values() to show how to extract the values from a dictionary, but in fact that will return the values from the dictionary in pretty much arbitrary order. Since your function most likely requires the arguments in a particular order, you should manually construct your list of values instead of calling d.values().

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T11:21:52.590

为什么不使用两种语言都可以解析的标准，例如 JSON、XML 或 YAML？ [simplejson](http://pypi.python.org/pypi/simplejson)很方便，并在 python 2.6 中作为 json 包含。

# c# - 在 C# 中使用 volatile (Thread.VolatileRead/ Thread.VolatileWrite)

> ID：349192
> 
> 赞同：8
> 
> 时间：2008-12-08T11:07:15.677
> 
> 标签：c#, multithreading

在多 CPU 机器上运行的多线程程序中，我是否需要使用易失性读/写访问共享状态（下面示例代码中的 _data）以确保正确性。

换句话说，堆对象可以缓存在cpu上吗？

使用下面的示例并假设多线程将访问 GetValue 和 Add 方法，我需要 ThreadA 能够添加数据（使用 Add 方法）和 ThreadB 能够立即查看/获取添加的数据（使用 GetValue 方法）。那么我是否需要向 _data 添加易失性读/写来确保这一点？基本上我不想添加要缓存在 ThreadA 的 cpu 上的数据。

/ 我没有锁定（强制执行独占线程访问），因为代码需要超快，并且我没有从 _data 中删除任何数据，所以我不需要锁定 _data。

谢谢。

**** 更新 ****************************

显然，你们认为使用这个例子去无锁是个坏主意。但是我在这里会面临哪些副作用或例外情况？

如果 1 个线程正在迭代读取值而另一个线程正在迭代更新值，那么 Dictionary 类型是否会引发异常？还是我只会经历“脏读”（在我的情况下这很好）？

**** 结束更新 ****************************

```
public sealed class Data
{
    private volatile readonly Dictionary<string, double> _data = new Dictionary<string, double>();

    public double GetVaule(string key)
    {
        double value;
        if (!_data.TryGetValue(key, out value))
        {
            throw new ArgumentException(string.Format("Key {0} does not exist.", key));
        }
        return value;
    }

    public void Add(string key, double value)
    {
        _data.Add(key, value);
    }

    public void Clear()
    {
        _data.Clear();
    }
} 
```

* * *

感谢您的回复。关于锁，这些方法几乎经常被多个线程调用，所以我的问题是有争议的锁而不是实际的锁操作。

所以我的问题是关于 cpu 缓存，堆对象（_data 实例字段）可以缓存在 cpu 上吗？我是否需要使用易失性读/写访问 _data 字段？

/另外，我坚持使用.Net 2.0。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-08T11:26:45.497

[MSDN 文档](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)`Dictionary<TKey, TValue>`说它对多个阅读器是安全的，但*他们*没有提供“一个作者，多个阅读器”保证其他一些类可以做到。简而言之，我不会这样做。

您说您正在避免锁定，因为您需要代码“超快” - 您是否*尝试过*锁定以查看开销是多少？无争议的锁非常便宜，当锁存在争议时，您就可以从增加的安全性中受益。在决定担心无锁解决方案的并发问题之前，我肯定会对此进行广泛的分析。`ReaderWriterLockSlim`如果您实际上有多个阅读器，可能会很有用，但听起来您至少目前只有一个阅读器和一个作者 - 在这种情况下，简单的锁定会更容易。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T18:36:02.903

我认为您可能误解了`volatile`关键字的使用（无论是那个还是我，请随时纠正我）。关键字保证从多个线程对变量本身的值的`volatile`获取和设置操作将始终处理相同的副本。例如，如果我有一个`bool`表示状态的值，那么在一个线程中设置它会使新值立即可供另一个线程使用。

但是，您永远不会更改变量的值（在本例中是引用）。您所做的只是操纵引用指向的内存区域。将其声明为`volatile readonly`（如果我的理解是合理的，它会通过不允许设置它来破坏 volatile 的目的）不会对正在操作的实际数据（后端存储`Dictionary<>`）产生任何影响。

话虽如此，在这种情况下您确实需要使用锁。您的危险超出了“脏读”（意味着您所读的内容在某些时候是有效的）的前景，进入了真正未知的领域。正如 Jon 所说，在尝试无锁编码之前，您确实需要证明锁定会产生不可接受的性能。否则，这就是过早优化的缩影。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-08T12:31:47.393

问题是您的添加方法：

```
public void Add(string key, double value)
{
    _data.Add(key, value);
} 
```

可能导致 _data 决定完全重新组织它所持有的数据 - 此时 GetVaule 请求可能会以任何可能的方式失败。

您需要一个锁或不同的数据结构/数据结构实现。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T11:25:09.213

如果您开始在其上调用方法，我认为 volatile 不能替代锁定。您保证线程 A 和线程 B 看到字典的相同副本，但您仍然可以同时访问字典。您可以使用多模式锁来增加并发性。[`ReaderWriterLockSlim`](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)例如参见。

> 表示用于管理对资源的访问的锁，允许多个线程进行读取或独占访问进行写入。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-25T05:18:40.163

该`volatile`关键字与锁定无关，它用于指示指定字段的值可能会被不同的线程或其他可以与您的代码同时运行的东西更改或读取。这对于编译器来说至关重要，因为许多优化过程都涉及缓存变量值和重新排列指令。该`volatile`关键字将告诉编译器在优化那些引用`volatile`变量的指令时要“谨慎”。

对于字典的多线程使用，有很多方法可以做。最简单的方法是使用`lock`关键字，它具有足够的性能。如果您需要更高的性能，您可能需要为您的特定任务实现自己的字典。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-18T18:20:42.923

volatile 不是锁定，它与同步无关。对只读数据进行无锁读取通常是安全的。请注意，仅仅因为您没有从 _data 中删除任何内容，您似乎调用了 _data.Add()。那不是只读的。所以，是的，这段代码会以各种令人兴奋且难以预测的方式在你面前爆炸。

使用锁，很简单，更安全。如果您是无锁大师（您不是！），并且分析显示了与锁争用相关的瓶颈，并且您无法通过分区或切换到自旋锁来解决争用问题，那么只有这样您才能研究获得无锁读取的解决方案，这将涉及从头开始编写自己的字典，并且可能比锁定解决方案更快。

你是否开始看到你的想法离你有多远？只需使用该死的锁！

# c# - 我需要帮助滚动我的控件 - c#

> ID：349204
> 
> 赞同：1
> 
> 时间：2008-12-08T11:11:15.480
> 
> 标签：c#, winforms, controls

我编写了一个简单的控件，它基本上显示几个单词，旁边有一个图像。

我希望在调整父表单大小时包含项目拉伸，正如您从我注释掉的代码中看到的那样，我不想使用循环，因为它会闪烁。

关于如何让项目以一种很好的方式随着表格增长和缩小的任何想法？

```
 public class IconListBox : FlowLayoutPanel  {

        private const int ITEM_PADDING = 2;
        private const int MAX_IMAGE_SIZE = 64;

        List<FlowLayoutPanel> _listItems;

        public IconListBox()    {

            this.SizeChanged += new EventHandler(IconListBox_SizeChanged);
            this.AutoScroll = true;
            this.HorizontalScroll.Enabled = false;
            this.HorizontalScroll.Visible = false;
            this.VerticalScroll.Enabled = true;
            this.VerticalScroll.Visible = true;

            _listItems = new List<FlowLayoutPanel>();
        }

        void IconListBox_SizeChanged(object sender, EventArgs e) {

            //foreach (FlowLayoutPanel item in _listItems) {
            //    item.Width = this.Width - 10;
            //}
        }

        public void AddItem(string itemText) {

            PictureBox pic = new PictureBox();
            pic.Image = MyWave.Properties.Resources.mywave_icon;
            pic.Width = pic.Height = MAX_IMAGE_SIZE;
            pic.SizeMode = PictureBoxSizeMode.Normal;
            pic.Enabled = false;

            FlowLayoutPanel p = new FlowLayoutPanel();
            p.Width = this.Width;
            p.Height = pic.Image.Height + (ITEM_PADDING * 4);
            p.BackColor = Color.White;
            p.Padding = new Padding(ITEM_PADDING);
            p.Margin = new Padding(0);

            Label l = new Label();
            l.Margin = new Padding(10, 5, 0, 0);
            l.Width = this.Width - ITEM_PADDING - MAX_IMAGE_SIZE;
            l.Height = p.Height - (ITEM_PADDING * 2);
            l.Text = itemText;
            l.Enabled = false;
            //l.BorderStyle = BorderStyle.FixedSingle;

            p.Controls.Add(pic);
            p.Controls.Add(l);

            p.MouseEnter += new EventHandler(p_MouseEnter);
            p.MouseLeave += new EventHandler(p_MouseLeave);
            p.MouseClick += new MouseEventHandler(p_MouseClick);

            this.Controls.Add(p);
            _listItems.Add(p);

            p.Anchor = AnchorStyles.Right;

        }

        void p_MouseClick(object sender, MouseEventArgs e) {
            //throw new NotImplementedException();
        }

        void p_MouseLeave(object sender, EventArgs e) {
            ((Panel)sender).BackColor = Color.White;
        }

        void p_MouseEnter(object sender, EventArgs e) {
            ((Panel)sender).BackColor = Color.LightBlue;
        }

        public void AddItem(string itemText, Image icon) {

        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T11:26:18.010

`foreach`通过嵌入`SuspendLayout()`和避免每次调整子控件大小时触发重绘`ResumeLayout()`：

```
this.SuspendLayout();

foreach (FlowLayoutPanel item in _listItems) 
{
    item.Width = this.Width - 10;
}

this.ResumeLayout(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T11:17:59.557

锚定表单的右侧和底部，并可能停靠它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T11:27:39.753

您可以使用[此处](http://msdn.microsoft.com/en-us/library/3t7htc9c(VS.80).aspx)的信息尝试启用双缓冲。

# python - 如何找到 django 模型基类的“具体类”

> ID：349206
> 
> 赞同：13
> 
> 时间：2008-12-08T11:11:45.590
> 
> 标签：python, django, inheritance, django-models

使用模型继承时，我试图找到 django-model 对象的实际类。

一些描述问题的代码：

```
class Base(models.model):
    def basemethod(self):
        ...

class Child_1(Base):
    pass

class Child_2(Base):
    pass 
```

如果我创建两个子类的各种对象并创建一个包含它们的查询集：

```
Child_1().save()
Child_2().save()
(o1, o2) = Base.objects.all() 
```

我想确定对象是基类方法中的 Child_1 还是 Child_2 类型，我可以通过 o1.child_1 和 o2.child_2 获取子对象，但这会重新获得有关基类中子类的知识。

我想出了以下代码：

```
def concrete_instance(self):
    instance = None
    for subclass in self._meta.get_all_related_objects():
        acc_name = subclass.get_accessor_name()
        try:
            instance = self.__getattribute__(acc_name)
            return instance
        except Exception, e:
            pass 
```

但它感觉很脆弱，我不确定如果我继承更多级别会发生什么。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-08T13:05:59.620

Django 使用父模型表和子模型表之间的 OneToOneField 实现模型继承。当你这样做时`Base.object.all()`，Django 只查询基表，因此无法知道子表是什么。因此，不幸的是，如果没有额外的查询，就不可能直接进入子模型实例。

此[代码段](http://www.djangosnippets.org/snippets/1031/)显示了将 ContentType 字段添加到基本模型的常用方法：

```
from django.contrib.contenttypes.models import ContentType

class Base(models.Model):
    content_type = models.ForeignKey(ContentType,editable=False,null=True)

    def save(self):
        if(not self.content_type):
            self.content_type = ContentType.objects.get_for_model(self.__class__)
        self.save_base()

    def as_leaf_class(self):
        content_type = self.content_type
        model = content_type.model_class()
        if(model == Base):
            return self
        return model.objects.get(id=self.id) 
```

然后你可以说`if Base.content_type.model_class()`确定类型。

[这](http://www.djangosnippets.org/snippets/1034/)是另一个将自定义管理器添加到组合中的片段。

如您所见，这两种解决方案都有可能非常昂贵。如果您有大量实例，则使用 as_leaf_class() 方法将需要对每个项目进行一次查询。

相反，如果您有一组已知的子模型，只需分别查询每个模型并将实例聚合到一个列表中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-12-12T17:59:21.447

看看[django-model-utils](https://github.com/carljm/django-model-utils/)中的 InheritanceManager - 将它附加到模型中会为您提供具体的子类（至少在第一级）：

```
from model_utils.managers import InheritanceManager

class Base(models.Model):
    objects = InheritanceManager()

# ...

Base.objects.all().select_subclasses() # returns instances of child classes 
```

model-utils 需要 Django 1.2 或更高版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-29T19:19:48.387

嗯...我的问题是。在一个视图中，我有这个主要模型，比如说“Big_Model”，还有一些与“Big_Model”相关的“Small_Model”。因此，当我想检索与“Big_Model”的某个实例相关的所有“Small_Model”时，我做了 **_set.all() 的事情。但关键是 Small_Model 有子类，我想在 views.py 中获取与每个 Small_Model 实例相关的子类。我的诀窍是在模型 Small_Model 中定义布尔方法，例如 is_child_1() 和 is_child_2()。当它为真时，您应用实际的子指针而不是 Small_Model 指针。

好的......这还不够清楚，我仍然没有太多时间写一个好的例子，所以我将在这里复制粘贴我的案例：

```
class Cache(models.Model):
  valor = models.DecimalField(max_digits=9, decimal_places=2, blank= True, null= True)
  evento=models.ForeignKey(Evento)
  def __unicode__(self):
    return u'%s: %s' % (self.evento, self.valor)
  class Meta:
    verbose_name='Cachê'
    verbose_name_plural='Cachês'
  def is_cb(self):
    try:
      self.cache_bilheteria
      return True
    except self.DoesNotExist:
      return False
  def is_co(self):
    try:
      self.cache_outro
      return True
    except self.DoesNotExist:
      return False 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-03T08:56:44.473

[Daniel Naab 提议](https://stackoverflow.com/a/349494/1042635)的略微修改版本：

```
from django.contrib.contenttypes.models import ContentType
from django.db import models

def ParentClass(models.Model):
    superclass = models.CharField(max_length = 255, blank = True)

    def save(self, *args, **kwargs):
        if not self.superclass:
            self.superclass = ContentType.objects.get_for_model(self.__class__)

        super(ParentClass, self).save(*args, **kwargs)

    def getChild(self):
        s = getattr(self, self.superclass)
        if hasattr(s, 'pk'):
            return s
        else:
            return None

class Child1(ParentClass):
    pass

class Child2(ParentClass):
    pass 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-12-08T11:23:59.090

感觉很脆弱，因为它是。（这是在不同上下文中的答案的重印。 [请参阅以编程方式进行 C++ 转换：可以完成吗？](https://stackoverflow.com/questions/243082/c-casting-programmatically-can-it-be-done)）

阅读多态性。几乎每一个“动态转换”情况都是多态性难以实现的例子。

无论您在动态演员阵容中做出的决定都已经做出。只需将实际工作委托给子类即可。

您遗漏了示例中最重要的部分。有用的、多态的工作。

当您说“我想确定对象的类型是 Child_1 还是 Child_2 ...”时，您忽略了“所以我可以使对象`aMethod()`以每个子类独有的方式执行”。该方法是有用的工作，它应该只是两个子类的方法。

```
class Base(models.model):
    def aMethod(self):
        # base class implementation.

class Child_1(Base):
    def aMethod(self):
        # Child_1 override of base class behavior.

class Child_2(Base):
    def aMethod(self):
        supert( Child_2, self ).aMethod() # Invoke the base class version
        # Child_2 extension to base class behavior. 
```

相同的方法，多种实现。永远不需要“运行时类型识别”或确定具体类。

# sharepoint - 可以将 log4net 配置为以自己的身份运行吗？

> ID：349213
> 
> 赞同：0
> 
> 时间：2008-12-08T11:14:22.760
> 
> 标签：sharepoint, logging, moss, log4net, impersonation

我正在考虑在 MOSS(SharePoint) 2007 项目中使用 log4net，但我需要知道是否可以轻松地将日志记录配置为使用某个用户名 + 密码进行日志记录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T11:23:12.243

看起来不像（基于快速浏览文档），但您当然可以为 Log4Net 创建一个包装类，该类使用模拟来作为您所需的用户执行日志记录

[.NET 2.0 中的模拟和委托](http://msdn.microsoft.com/en-us/library/ms998351.aspx)（应该与 3.5 相同的技术）

# delphi - Delphi 指纹识别代码示例

> ID：349237
> 
> 赞同：2
> 
> 时间：2008-12-08T11:24:55.563
> 
> 标签：delphi, fingerprint, biometrics

你知道我在哪里可以找到用于从图像文件中进行指纹识别的 Delphi 代码示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T04:58:32.173

我对生物特征图像识别了解不多，但如果你能找到 C 或 C++ 代码，并将其移植到 Delphi，你会更好。初学者请参阅[免费指纹成像软件](http://ffpis.sourceforge.net/)和[指纹验证系统](http://fvs.sourceforge.net/)。第一个站点包含有用的链接。

# php - Javascript AJAX 函数未加载

> ID：349238
> 
> 赞同：0
> 
> 时间：2008-12-08T11:25:07.623
> 
> 标签：php, javascript, ajax

我有一个 realtivley 简单的 ajax 应用程序，我已将其分解为更加模块化。代码在下面的链接中，我主要做的是添加 GetRecordSet 函数并允许 fetchcompelte 为将数据放入哪个层获取一个变量。它应该可以正常工作。当我放入 alert()s 时，代码似乎在执行，除了在 fetch complete 中的任何一个 if 子句中。

[http://www.nomorepasting.com/getpaste.php?pasteid=22558](http://www.nomorepasting.com/getpaste.php?pasteid=22558)

这是 get_records.php 的代码，看起来应该没问题

[http://www.nomorepasting.com/getpaste.php?pasteid=22559](http://www.nomorepasting.com/getpaste.php?pasteid=22559)

这是原始索引 php 文件

[http://www.nomorepasting.com/getpaste.php?pasteid=22560](http://www.nomorepasting.com/getpaste.php?pasteid=22560)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-08T11:41:25.357

我建议您使用[http://www.prototypejs.org](http://www.prototypejs.org/api/ajax/request)中的prototypejs ，它将抽象代码中的所有状态检查并使其更简单并摆脱混乱。

如果出于某种原因您更喜欢使用自己的代码，那么请避免对 XMLHttpRequestObject 的 readyState 属性使用字符串值。请改用下表

```
 State Description 
   0   The request is not initialized 
   1   The request has been set up 
   2   The request has been sent 
   3   The request is in process 
   4   The request is complete 
```

并检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T12:13:09.600

首先，我同意 Shyam 并为 Firefox 安装 Firebug；这将对 javascript 调试有很大帮助。

无论如何，这条线

```
xmlHttp.onreadystatechange = FetchComplete(layername); 
```

将分配`FetchComplete(layername)`to的结果`xmlHttp.onreadystatechange`，这不是您想要的。它需要是

```
xmlHttp.onreadystatechange = FetchComplete; 
```

但是你有通过的问题`layername`。

如果将 onreadystatechange 定义为匿名内部函数，则可以轻松使用在其外部定义的变量，因此可以执行以下操作：

```
function GetAuctionData(pk) {

    var xmlHttp=GetXmlHttpObject();
    var layer = "Layer2";

    if(xmlHttp==null) {
        alert("Your browser is not supported?");
    }

    var url="get_auction.php?";
    url=url+"cmd=GetAuctionData&pk="+pk;
    url=url+"&sid="+Math.random();

    xmlHttp.onreadystatechange = function() {
        if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
            document.getElementById(layer).innerHTML=xmlHttp.responseText
        } else if (xmlHttp.readyState==1 || xmlHttp.readyState=="loading") {
            document.getElementById(layer).innerHTML="loading"
        }
    };

    xmlHttp.open("GET",url,true)
    xmlHttp.send(null)
} 
```

`layer`在 GetAuctionData() 中定义为局部变量，但可以在匿名函数中访问，因为您正在创建闭包。请注意，我没有测试过上述功能，但原则上它应该可以工作。

# php - 是否有与用 PHP 编写的 Trac 的等价物？

> ID：349241
> 
> 赞同：21
> 
> 时间：2008-12-08T11:25:22.083
> 
> 标签：php, svn, bug-tracking, trac

是否有与用 PHP 编写的[Trac的等价物？](http://trac.edgewall.org/)我需要与 SVN 集成并且免费的东西。它应该允许我浏览 SVN 源，进行某种错误跟踪并显示 SVN 中的最新更改。wiki 不是必需的。

提前致谢。

# unix - 使用空目录从分支创建 CVS 视图

> ID：349248
> 
> 赞同：0
> 
> 时间：2008-12-08T11:28:48.987
> 
> 标签：unix, cvs, wincvs

我`cvs -tag -b "abcdefg"`在我的 CVS 中使用命令来标记分支。我的 CSV 存储库在每个文件夹中都有一个空目录“obj”。

每当我使用命令`cvs co -r "abcdefg" REPO`时，我都会得到一个完整的回购减去空文件夹。我也尝试使用`-f`选项，但它没有用。有什么办法摆脱这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T13:07:08.367

CVS 中的目录不以任何方式进行版本控制。当您在 CVS 中使用分支标签进行检出时，它只会检出具有与请求的分支标签匹配的文件的目录。由于“obj”目录都是空的，CVS 不知道要检查它们。当您运行更新时，它将“修复”您的工作副本的状态并获取空目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T11:43:22.547

除非您指定 -P （修剪空目录），否则您应该自动获取所有空目录。

你有没有检查过你是否有一个 .cvsrc 文件，它指定了类似的东西

```
co -P 
```

它应该位于您的 $HOME 目录中

如果不是这样，问题是您的标签是否设置在空目录上？执行标记操作时是否检查了空目录？
标记操作仅标记您在沙箱中拥有的东西，要标记存储库中的所有内容，请执行 rtag。

# javascript - 如何在javascript中显示xml？

> ID：349250
> 
> 赞同：6
> 
> 时间：2008-12-08T11:29:49.360
> 
> 标签：javascript, xml

正如问题所说，它只是让我忘记了如何在 javascript 中显示 xml，我想在页面上的 div 中显示一些源 xml，它位于另一个 div 中 xml 的处理结果旁边。

不记得是否有等效于 javascript 的转义来转换客户端上的实体

**注意**：xml 文件是从服务器提供的，所以我需要一个客户端解决方案

**注意**：主要问题是 XML 在大多数浏览器中无法正确呈现，所有括号和属性都消失了，留下看起来不像 xml 的文本

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-08T14:14:18.217

使用 Ajax 获取您的 XML，然后简单地将结果放入`textarea`. 以您想要的任何方式设置文本区域的样式。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-08T11:57:15.997

如果您希望*浏览器呈现*您的`XML`as `XML`，它必须在它自己的文档中，例如 an`iframe`或 a `frame`。`DIV`不会做的工作！

此外，在为您`HTTP`提供服务的请求的标头中`iframe`应该发送`Content-Type: text/xml`，因此浏览器可以理解该内容是一个`XML`.

但是，如果你真的需要在 DIV 中看到它，你将不得不自己构建一个`XML`渲染函数`XML2HTML`。`HTML` [`PRE`](http://www.w3schools.com/TAGS/tag_pre.asp)如果您的`XML`字符串已经格式化（换行符和制表符） ，您可以使用该标签。在这种情况下，您将不得不在字符串中替换`<`为。`&gt;``XML`

**结论：** `The browser`不能在同一个文档中渲染`XML`和。`HTML`如果你需要它，你只需要解决它。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-08T11:58:07.993

这里有一个功能：

```
<script type="text/javascript">
<!--
    function xml_to_string(xml_node)
    {
        if (xml_node.xml)
            return xml_node.xml;
        else if (XMLSerializer)
        {
            var xml_serializer = new XMLSerializer();
            return xml_serializer.serializeToString(xml_node);
        }
        else
        {
            alert("ERROR: Extremely old browser");
            return "";
        }
    }

    // display in alert box
    alert(xml_to_string(my_xml));

    // display in an XHTML element
    document.getElementById("my-element").innerHTML = xml_to_string(my_xml);
-->
</script> 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-08T13:08:22.577

当您不想为此使用整个 JavaScript 框架时...

```
function insertLiteral(literalString, targetElement)
{
    var textNode = document.createTextNode(literalString);
    targetElement.appendChild(textNode)
    return textNode;
}

// test it (for the example, I assume #targetDiv is there but empty)
var xmlString = "<this><is_some><xml with='attributes' /></is_some></this>";
var targetElement = document.getElementById("targetDiv");
var xmlTextNode = insertLiteral(xmlString, targetElement); 
```

`#targetDiv`可以使用 CSS 设置样式：

```
#targetDiv {
  font-family: fixed;
  white-space: pre;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-08T12:32:18.283

问题是您必须转义 HTML 解析器将解释为标记的字符：<、>、&，在某些情况下，“和”

Core JavaScript 不为您提供此功能，但许多附加库提供。

例如，Prototype 有： http: [//www.prototypejs.org/api/string/escapeHTML](http://www.prototypejs.org/api/string/escapeHTML)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-08T11:38:40.823

一种技术是使用两个 iframe 元素，并将 src 属性设置为服务器可用的相应 xml 文件（假设它通过虚拟目录公开）：

```
<iframe src="/myapp/Document1.xml"><iframe src="/myapp/Document2.xml"> 
```

或者，您可能会使用 AJAX 类型的请求来检索 xml 文档，然后使用以下方式将它们动态嵌入到 HTML 文档中：

```
getElementById("myDiv").innerText = ajax.response; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-07-05T11:16:24.577

这是我发现在同一页面上将 XML 显示为文本以进行复制和粘贴的最简单方法：

```
var xml = document.getElementById('svg_element').innerHTML;
document.getElementById('svg_pre').innerText = xml; 
```

# c# - 如何找出一个目录中有多少个文件？

> ID：349251
> 
> 赞同：11
> 
> 时间：2008-12-08T11:30:54.553
> 
> 标签：c#, .net, file-io

我需要计算目录中的文件数。我可以使用获取目录中所有文件的名称`System.IO.Directory.GetFiles()`并获取该数组的长度，但在大型目录上花费的时间太长。有没有办法只得到计数而不必得到名字？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-08T11:35:27.633

我不这么认为，不——至少在原版 .NET 中没有。我怀疑这不是实际获取名称需要时间 - 它是操作系统遍历目录内部。*您*可以通过 P/Invoke 进行 Win32 调用。

您正在查看的目录有多大？一般来说，在一个目录中拥有超过几百个文件至少在*传统上不是一个好主意。*文件系统在这方面总体上有所改进，但我不知道 NTFS 和 Fat32 的当前状态如何。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-08T12:46:32.823

我做了一个小测试 - 在 C++/Qt 和 C++/CLI 中编写了相同的任务：

```
LARGE_INTEGER i1, i2;       

QueryPerformanceCounter(&i1);       

int count = IO::Directory::GetFiles(L"c:\\windows\\system32")->Length;

QueryPerformanceCounter(&i2);

__int64 result = i2.QuadPart - i1.QuadPart; 
```

结果约为 16.500.000

和

```
LARGE_INTEGER i1, i2;

QueryPerformanceCounter(&i1);

intcount = QDir("c:/windows/system32").entryList(QDir::Files).count();

QueryPerformanceCounter(&i2);

__int64 result += i2.QuadPart - i1.QuadPart; 
```

结果约为 2.100.000.000

文件数为 2125

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-08T12:46:54.557

没有更快的方法。无论您使用什么，都归结为`FindFirstFile`Win32`FindNextFile`调用。
您可以尝试使用类似[这样](http://www.codeproject.com/KB/files/FileSystemEnumerator.aspx)的东西，但它可能会花费同样多的时间——但内存使用量可能会少一点（= 可能不值得）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-08T12:20:13.597

到目前为止，在我遇到的大多数语言中，您只能通过遍历文件夹并计算文件来获得这些信息。我怀疑是否存在仅获取计数的 Windows API 调用（但我会感到惊讶！）。
该方法的优点：灵活性——您可以过滤掉一些文件类型，递归地走下去或忽略文件夹等。

如果该方法对您来说很慢，也许您应该使用更好的方法，例如不创建一个充满目录信息的数组（填充它需要时间！更不用说内存成本和垃圾收集时间），而是使用迭代器：多一点工作（但一旦你得到这个功能，它总是在那里）但效率更高。

# events - Compact Framework - 在不活动一段时间后锁定 UI 的超时功能

> ID：349255
> 
> 赞同：2
> 
> 时间：2008-12-08T11:34:34.403
> 
> 标签：events, timeout, compact-framework, c#-2.0, handhelddevice

早上好，

我是一个中型 PDA 应用程序的开发人员，该应用程序将在街头使用。PDA 将包含一些模糊的敏感数据（姓名和地址等）。移动数据库上的加密已经被处理，但是如果有人在 PDA 登录时抓住了它，他们可以愉快地浏览数据，直到电池没电或者他们关闭应用程序并不得不重新登录。

当用户访问 PDA 应用程序时，他们需要输入他们的用户名和 PIN 码。该软件的版本 1 在系统中的每个按钮中都有一个事件，因此当按下按钮时，它会更新一个名为 LastActionTime 的变量。主窗体上运行了一个计时器，如果 LastActionTime 超过 10 分钟，那么系统将再次抛出登录表单，直到前一个用户/管理员再次登录（就像 Windows 锁定屏幕一样）。

这工作得很好......从某种意义上说......问题在于它只处理按钮而不处理其他控件，如 ListViews、PictureBoxes 等。

有什么好的方法可以实现这一目标吗？例如，有没有一种方法可以扩展 Windows 窗体类来处理每个事件并相应地更新该变量？或者我可以做一些类似windows的事情来处理表单上的每一个鼠标事件吗？

简而言之，我想要实现的是，当 PDA 屏幕/按钮 10 分钟没有被触摸时，PDA 会知道这一点并允许我触发我的锁定方法。

任何想法、帮助和指导将不胜感激。

**编辑**：我在 Windows Mobile 6.0 上使用 Compact Framework 2.0，但是该功能需要在 Windows Mobile 5.0 及更高版本上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T12:27:39.273

一种可能的解决方案是依靠 PDA 进入电源空闲状态。您可以使用 OpenNETCF.WindowsCE.PowerManager.PowerIdle 事件为此注册通知。事实上，考虑电源管理因素是个好主意。您不能期望您的 PDA 一直处于相同的状态。

另一种解决方案是监视输入驱动程序的非活动事件（请参阅此[链接](http://msdn.microsoft.com/en-us/library/ms889826.aspx)）。然而，这个解决方案是非常特定于设备的。

不幸的是，在 Windows CE 中没有办法注册全局鼠标事件挂钩。

以上是操作系统解决方案。扩展 Windows 窗体和控件类并不是一种简单的方法。可能您需要扩展您将使用的所有控件。最简单的解决方案是为所有控件和表单实现 GetFocus 方法。你可以在那里重置你的计数器。

顺便说一句，在桌面环境中，这可以通过 GetLastInputInfo 轻松实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T13:29:44.227

看看这个帖子：

[http://social.msdn.microsoft.com/Forums/en-US/netfxcompact/thread/906b016d-f1ee-4b3e-b3df-1e3a6fea282a/](http://social.msdn.microsoft.com/Forums/en-US/netfxcompact/thread/906b016d-f1ee-4b3e-b3df-1e3a6fea282a/)

我遇到了同样的问题，最终使用 Application.AddMessageFilter 来获得适当的结果。该线程最终包含指向我编写的示例项目的链接，该链接显示了不活动计时器的工作情况，包括在必要时关闭子对话框以返回主窗口屏幕。

大卫

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-26T11:09:11.363

此处发布的解决方案适用于 WM6.5

[http://www.dzhang.com/blog/2010/01/09/detecting-user-activity-or-inactivity-in-windows-mobile](http://www.dzhang.com/blog/2010/01/09/detecting-user-activity-or-inactivity-in-windows-mobile)

# xml - XML 或自己的格式文件？

> ID：349256
> 
> 赞同：2
> 
> 时间：2008-12-08T11:34:37.960
> 
> 标签：xml, file

何时将信息保存在 XML 文件中以及何时保存在自己的格式文件中是个好主意？

对于 XML（或其他标准），我看到：

*   (+) 标准格式。
*   (-) 手动修改很乏味。

对于自己的格式文件，我看到：

*   (-) 我们需要构建一个自己的解析器（非标准）。
*   (+) 手动修改文件很容易。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-08T11:39:51.383

以各种方式适合时使用 XML：

*   需要在能够处理 XML 的不同应用程序之间共享
*   天然树状结构
*   主要数据很容易表示为文本（二进制数据在基于文本的格式中有点杂乱无章）
*   可扩展性很重要
*   性能并不重要（解析 XML 并不是非常快 - 尽管如果性能很重要并且您选择 XML，那么请四处寻找快速的解析器，因为最快和最慢之间存在很大差异）
*   可以预定义模式，并且可以根据它验证文档
*   更简单的格式（例如 name=value 对）不会削减它

基本上，如果您的数据模型在 XML 中有一个非常自然的表示，那么这很可能是处理它的最简单方法。如果您最终不得不花很多时间来适应 XML，请考虑其他格式。请注意，除了 XML 之外，还有许多其他标准（或“某种程度的标准”——例如，由多个平台上的工具支持）格式可用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-08T16:17:24.973

对于 XML，我看到：

*   (+) 标准格式。
*   (-) 手动修改很乏味。

    我只在 API 需要时使用 XML。

对于 JSON/YAML，我看到：

*   (+) 标准格式。
*   (+) 很容易手动修改。

    我对几乎所有东西都使用 JSON/YAML。除非接口需要其他东西。

对于 CSV，我看到：

*   (+) 标准格式。
*   (+) 很容易手动修改。
*   (-) 当列名有问题或数据不是简单的第一正规形式时，这有点模糊。

    我尽可能使用 CSV。

对于语言序列化程序，我看到：

*   (+) 给定语言的标准格式。
*   (-) 几乎不可能手动修改。

    当我确定双方使用相同的语言时，我偶尔会使用序列化文件在进程之间传递数据。

对于自己的格式文件，我看到：

*   (-) 我们需要构建一个自己的解析器（非标准）。
*   (+) 手动修改文件很容易。

    我避免发明自己的文件格式。多年来没有发明我自己的文件格式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-08T16:20:27.557

XML 为您提供了 XSLT 和 Xpath 的强大功能，而您自己的格式却没有。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T11:40:35.860

有关利弊的讨论，请参阅[在 xml 成为标准之前并考虑到它的所有缺点是什么让 xml 如此受欢迎](https://stackoverflow.com/questions/116195/before-xml-became-a-standard-and-given-all-its-shortcomings-what-made-xml-so-po)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-08T11:43:23.247

还要记住你有各种漂亮的 XML 编辑器，这些模式会给你自动完成、语法检查和各种现代编辑特权，其他格式不完全支持

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-08T11:44:11.717

> (-) 手动修改很乏味。

我认为这在很大程度上取决于您定义的 XML/自己的格式。如果您使用例如二进制格式（这样做可能非常有效），那么手动编辑文件几乎是不可能的。

我认为还有其他方面会影响文件格式的选择，例如

*   表现
*   与其他组件的互操作性
*   手动编辑文件的能力（调试）
*   向后兼容性问题
*   ETC

如果您要使用文本格式，在大多数情况下我会选择基于 XML 的解决方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-08T19:15:29.280

我的经验法则是：如果我需要转换或验证它，或者我需要与我无法控制的应用程序域共享数据，我会首先考虑 XML，如果我需要不，我没有。

**编辑：**

我通常忘记了文本，尤其是 Unicode：如果我的数据的很大一部分是文本（尤其是标记文本），并且如果我需要支持 Unicode（任何使用文本块的应用程序通常都支持），那迅速将 XML 移到列表中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-08T12:15:48.300

正如上面所指出的，易于编辑并不是一个主要问题：周围有很多好的（而且对某些人免费的）XML 编辑器。

另一个潜在的问题是冗长，尽管大文件的答案是压缩它们：在许多语言中，它几乎是透明的。

XML 在很多方面都很好：标准定义明确（您不必考虑如何定义字符集、如何转义内容、如何处理特殊情况（多行、二进制等））；它有很多工具（编辑器、解析器、XPath 等）；与其他工具交换数据很棒。

如果你的需求很简单，只操作Ascii，自给自足（只有这个应用程序会使用这种格式），也许你可以用另一种格式。但在定义自己的格式之前，您可能会先看看现有的基于文本的格式，例如 Json、Yaml，甚至 Lua（最初是一种数据描述语言），或者对于非常简单的需求，Windows 的 ini 格式或 Java 的属性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-08T16:28:33.813

按顺序我使用：

*   属性文件，如果数据可以表示为键/值
*   如果数据可以表示为表格，则为 CSV
*   结构复杂的 XML

在我看来，XML 的缺点可能是解析器的性能，而当数据很重要时，XML 文件的大小可能是一个障碍（几 MB 的 XML 文件很难在许多编辑器中打开）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-08T19:20:42.810

如[annakata](https://stackoverflow.com/users/13018/annakata)所述，如果您选择 XML 路由，则可以使用 XSLT 和 XPATH。我发现通过巧妙地使用 XSLT，您可以创建“自记录”配置文件。

通过创建一个 .xsl 文件并向 XML 文件添加这样的声明，用户可以简单地双击 XML 文件并在他们的浏览器中查看转换的结果（我知道 IE 和 Firefox 都支持这一点）

```
<?xml-stylesheet type="text/xsl" href="config-documentation.xsl"?> 
```

只是认为这可能会有所帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-08T19:34:05.000

XML 通常是我的首选。部分原因是它是我的平台选择 (.NET) 的标准配置文件格式。我发现，几乎完全，定义良好的 XML 文件比自定义格式更好。我也会回避 CSV 和平面文件，除非它们是项目的要求。

我选择 XML 的原因（请注意，有些是特定于平台的）：

*   **我的平台的标准实现。** 大量工具可用于处理 XML、XSD、XSLT。

*   **模式实施 (XSD)。** 允许我强制执行文件结构。当格式被其他人使用时也非常有用。

*   **导航（XPath、Linq to Xml）。** 易于提取和写入节点及其属性。与客户阅读器和编写器相比，编写此类代码的风险更小。

*   **可转换 (XSLT)。** 可以毫不费力地将文件转换为其他演示视图。

*   **可互操作。** XML 的结构非常适合描述对象。序列化为 XML 的对象很容易移植，并且可以跨越应用程序边界。

*   **易于编辑。** 定义良好的 XML 易于阅读和编辑。一个简单的文本编辑器就足以开始，并且有许多具有各种功能和价格点的 XML 编辑工具可用。

我不理解手动修改 XML 比自定义格式更容易的看法。XML 可能比您想出的格式更冗长，但它提供了与其包含的数据的上下文相关性。如果您可以查看（格式良好的）XHTML，那么查看 XML 并没有太大的不同。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-08T20:05:32.360

这真的取决于你的数据。

请参阅 ESR 的[Unix 编程艺术：Ch。5 文本性-数据文件元格式](http://www.faqs.org/docs/artu/ch05s02.html)。这句话总结了它：

> XML 可以是一种简化的选择，也可以是一种复杂的选择。围绕它有很多炒作，但不要因为不加批判地采用或拒绝它而成为时尚受害者。谨慎选择并牢记 KISS 原则。

XML 当然有它的用途，它**非常**适合表达复杂的分层数据集，但是如果你需要做的只是存储半打`key:value`数据对，那么它就太过分了，而且不适合基于行的表格数据。

# javascript - 从 Javascript 中检测真正的边框、填充和边距

> ID：349257
> 
> 赞同：10
> 
> 时间：2008-12-08T11:34:44.203
> 
> 标签：javascript, css, border, padding, margin

有没有办法从 Javascript 代码中检测元素的真实边框、填充和边距？如果你看下面的代码：

```
<html>
    <head>
        <style>
        <!--
        .some_class {
            padding-left: 2px;
            border: 2px solid green;
        }   
        -->
        </style>
        <script>
        <!--
        function showDetails()
        {
            var elem = document.getElementById("my_div");
            alert("elem.className=" + elem.className);
            alert("elem.style.padding=" + elem.style.padding);
            alert("elem.style.paddingLeft=" + elem.style.paddingLeft);
            alert("elem.style.margin=" + elem.style.margin);
            alert("elem.style.marginLeft=" + elem.style.marginLeft);
            alert("elem.style.border=" + elem.style.border);
            alert("elem.style.borderLeft=" + elem.style.borderLeft);
        }
        -->
        </script>
    </head>
    <body>
        <div id="my_div" class="some_class" style="width: 300px; height: 300px; margin-left: 4px;">
            some text here
        </div>
        <button onclick="showDetails();">show details</button>
    </body>
</html> 
```

你可以看到，如果你点击按钮，填充没有被正确报告。只有通过“样式”直接定义的属性会被报告回来，那些通过 CSS 类定义的属性不会被报告。

有没有办法取回这些属性的最终值？我的意思是在浏览器计算和应用所有 CSS 设置之后获得的值。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-28T02:51:42.680

该`style`属性可以获取内联分配的样式，例如

`<div id="target" style="color:#ddd;margin:10px">test</div>` 如果您想获取外部 css 文件或`<style/>`元素中分配的样式，请尝试以下操作：

```
var div = document.getElementById("target");
var style = div.currentStyle || window.getComputedStyle(div);
display("Current marginTop: " + style.marginTop); 
```

如果您使用的是 jQuery，@vsync 的解决方案很好。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-08-14T23:54:24.653

## 使用 jQuery：

```
var $elm = $('.box');
var hPadding = $elm.outerWidth() - $elm.width();
var vPadding = $elm.outerHeight() - $elm.height();
var hBorder = $elm.outerWidth() - $elm.innerWidth();
var vBorder = $elm.outerHeight() - $elm.innerHeight();

console.log("Horizontal padding & border: ", hPadding);
console.log("Vertical padding & border: ", vPadding);
console.log("Horizontal border: ", hBorder);
console.log("Vertical border: ", vBorder);
```

```
.box{ 
  width: 50%;
  padding:10vw; 
  border:10px solid red; 
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div class='box'></div>
```

**你的方式（但你必须声明 paddingLeft, paddingRight..不仅仅是 'padding' ）：**

```
var elm = $('.box');
console.log("padding left (PX): ", elm.css("paddingLeft"));
```

```
.box { 
  padding:0 50px 0 5vw; 
  border: 2px solid green; 
  width: 300px; 
  height: 300px; 
  margin-left: 4px;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div class="box">some text here</div>
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-08T12:39:40.920

这是可能的，但当然，每个浏览器都有自己的实现。幸运的是，PPK 为我们完成了所有艰苦的工作：

[http://www.quirksmode.org/dom/getstyles.html](http://www.quirksmode.org/dom/getstyles.html)

# mysql - 建议表结构的 MySQL 工具或查询

> ID：349260
> 
> 赞同：11
> 
> 时间：2008-12-08T11:35:48.427
> 
> 标签：mysql, structure

几周前，我在 MySQL 中使用了一个查询，该查询描述了一个表，并建议对其结构进行可能的改进。例如，如果我有一个 int 字段，但该字段中只有数字 1-3，它将建议 set(1,2,3) 作为类型。

我想我正在使用 phpMyAdmin，但我已经使用了所有我能找到的功能 - 分析、描述、解释、优化等 - 无济于事。我这辈子都不记得查询是什么了！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-08T11:42:30.287

这是 phpMyAdmin 给我的：

```
SELECT *
FROM `table_name`
PROCEDURE ANALYSE ( ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-09T12:19:26.140

在 phpMyAdmin 2.11.6 中，转到表的结构选项卡。下面的字段列表有 3 个带有标签的按钮：“打印视图”“关系视图”“建议表结构”。

最后一个是你需要的。

# .net - .net 架构：创建 IRepository 一般地

> ID：349280
> 
> 赞同：4
> 
> 时间：2008-12-08T11:48:04.847
> 
> 标签：.net, generics, architecture, repository-pattern

我正在使用通用存储库接口，它允许我添加、查找、更新和删除不同类型的对象。然后我实现了两个具体的存储库，并且可以在不更改应用程序的情况下切换它们。一切都奇妙地脱节。但我遇到了一个障碍。我的存储库方法中的代码感觉不对，我不知道如何做得更好。这是我的代码片段：

```
public class OracleRepository<T> : IRepository<T> where T : new()
{
    public IQueryable<T> GetAll()
    {
        if (typeof(T) == typeof(Object1))
        {
            return (IQueryable<T>)DataAccess.GetAllObject1().AsQueryable();

        }

        if (typeof(T) == typeof(Object2))
        {
            return (IQueryable<T>)DataAccess.GetAllObject2().AsQueryable();
        }

        throw new NotImplementedException();
    }
} 
```

问题是我的 DataAccess（从数据读取器创建对象）不是通用的，并且对于它支持的每种类型的对象都有特定的方法。

我可以重写上面的内容，以避免使用泛型或其他方式的 if-then-elseif 列表吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-08T11:56:46.450

一种常见的模式是使用字典从类型到相关类型的函数。例如：

```
private static readonly IDictionary<Type, Func<object>> Fetchers =
    new Dictionary<Type, Func<object>>();
    {
        (typeof(Object1), () => DataAccess.GetAllObject1().AsQueryable()),
        (typeof(Object2), () => DataAccess.GetAllObject2().AsQueryable()),
        // etc
    };

public IQueryable<T> GetAll()
{
    Func<object> func = Fetchers[typeof(T)];
    if (func == null)
    {
        throw new NotImplementedException();
    }
    return (IQueryable<T>) func();
} 
```

演员表在那里是因为你不能真正表达字典中的类型关系，但至少添加新类型等稍微容易一些。

您可以根据etc 返回的内容将呼叫`AsQueryable()`移至。`GetAll()``GetAllObject1()`

# asp.net - ASP.NET 成员密码过期

> ID：349286
> 
> 赞同：23
> 
> 时间：2008-12-08T11:52:34.323
> 
> 标签：asp.net, authentication, asp.net-membership, change-password

我正在使用 ASP.NET 成员身份验证我的 Web 应用程序。这对我很有用。我现在必须实现密码过期。

如果密码已过期，则应将用户重定向到`ChangePassword`屏幕，并且不应允许在不更改密码的情况下访问应用程序的任何其他部分。

有很多aspx页面。如果密码已过期，一种解决方案可能是重定向到每个 aspx 的`ChangePassword`屏幕`OnInit`。有没有其他解决方案或建议。

谢谢，杰

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2011-07-15T09:29:36.030

除了[csgero 的回答之外](https://stackoverflow.com/questions/349286/asp-net-membership-password-expiration/349687#349687)，我发现您不需要在 ASP.Net 2.0 (3.5) 中显式添加此事件的事件处理程序。

您可以简单地在其中创建以下方法`global.asax`，它会为您连接起来：

```
void Application_PostAuthenticateRequest(object sender, EventArgs e)
{
    if (this.User.Identity.IsAuthenticated)
    {
        // get user
        MembershipUser user = Membership.GetUser();

        // has their password expired?
        if (user != null
            && user.LastPasswordChangedDate.Date.AddDays(90) < DateTime.Now.Date
            && !Request.Path.EndsWith("/Account/ChangePassword.aspx"))
        {
            Server.Transfer("~/ChangePassword.aspx");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-08T14:17:29.427

您可以在 global.asax 中为 HttpApplication.PostAuthenticateRequest 事件添加事件处理程序并在那里处理重定向。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-03-26T20:53:33.650

在[Andrew 的回答](https://stackoverflow.com/a/6705094/5662)之后，我发现您需要检查用户是否已经在更改密码页面上，否则他们将永远无法真正更改密码，因此永远不会离开更改密码站点：

```
void Application_PostAuthenticateRequest(object sender, EventArgs e)
    {
        if (this.User.Identity.IsAuthenticated)
        {
            // get user 
            MembershipUser user = Membership.GetUser();

            // has their password expired? 
            if (user != null
                && user.LastPasswordChangedDate.AddMinutes(30) < DateTime.Now
                && !Request.Path.EndsWith("/Account/ChangePassword.aspx"))
            {
                Server.Transfer("~/Account/ChangePassword.aspx");
            }
        }
    } 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-07-24T13:59:32.743

大约一个小时就实现了这个，不需要修改你的基本页面。这是你必须做的：

1.  响应`LoggingIn`成员控制事件

2.  在会员数据库中找到用户并获取`LastPasswordChangedDate`

3.  使用 TimeSpan，将其与当前日期进行比较，并确定上次更改密码的时间是否超过所需天数。我从 web.config 得到这个值

4.  如果过期，重定向到`ChangePassword`屏幕

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-23T20:44:02.187

我来这里是为了寻找解决方案，但我目前的技术是 ASP.NET MVC。所以为了帮助别人：你可以扩展`AuthorizeAttribute`, 和 override`OnAuthorization`方法，像这样：

```
public class ExpiredPasswordAttribute : AuthorizeAttribute
{
    public override void OnAuthorization(AuthorizationContext filterContext)
    {
        IPrincipal user = filterContext.HttpContext.User;

        if(user != null && user.Identity.IsAuthenticated)
        {
            MembershipUser membershipUser = Membership.GetUser();

            if (PasswordExpired) // Your logic to check if password is expired...
            {
                filterContext.HttpContext.Response.Redirect(
                    string.Format("~/{0}/{1}?{2}", MVC.SGAccount.Name, MVC.SGAccount.ActionNames.ChangePassword,
                    "reason=expired"));

            }
        }

        base.OnAuthorization(filterContext);
    }
} 
```

注意：我使用[T4MVC](http://t4mvc.codeplex.com/)来检索上面代码中的 Controller 和 Action 名称。

用这个属性标记除“ `AccountController`”之外的所有控制器。这样做，密码过期的用户将无法浏览该网站。

这是我在该主题上发表的一篇文章，其中有一些加分：

[ASP.NET MVC 中的用户密码过期过滤器属性](http://www.leniel.net/2012/05/user-password-expired-filter-aspnet-mvc.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-10T21:32:20.490

我使用了上面的代码，只对其稍作修改以使用 .NET 身份提供程序在 Asp.NET (4.5) MVC5 中实现。把它留在这里给下一个家伙/gal :)

```
void Application_PostAuthenticateRequest(object sender, EventArgs e)
    {
        if (this.User.Identity.IsAuthenticated)
        {
            WisewomanDBContext db = new WisewomanDBContext();

            // get user
            var userId = User.Identity.GetUserId();
            ApplicationUser user = db.Users.Find(userId);

            // has their password expired?
            if (user != null && user.PasswordExpires <= DateTime.Now.Date
                && !Request.Path.EndsWith("/Manage/ChangePassword"))
            {
                Response.Redirect("~/Manage/ChangePassword");
            }

            db.Dispose();
        }
    } 
```

# datetime - Convert datetime in to date

> ID：349291
> 
> 赞同：8
> 
> 时间：2008-12-08T11:55:57.263
> 
> 标签：datetime, grails, groovy

How do I convert a datetime field in Grails to just date, with out capturing the time? I need to do this for comparison with system date.

```
class Trip 
{
    String name
    String city
    Date startDate
    Date endDate
    String purpose
    String notes

    static constraints = {
        name(maxLength: 50, blank: false)
        startDate(validator: {return (it >= new Date())}) // This won't work as it compares the time as well 
        city(maxLength: 30, blank: false)
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-08T13:50:02.603

There's [unfortunately] not an "out-of-the box" method for performing this operation in `Grails|Groovy|Java`.

Somebody **always** throws in [Joda-Time](http://joda-time.sourceforge.net/) any time a `java.util.Date` or `java.util.Calendar` question is raised, but including yet another library is not always an option.

Most recently, for a similar problem, we created a `DateTimeUtil` class with `static` methods and something like the following to get a `Date` only:

```
class DateTimeUtil {

    // ...

    public static Date getToday() {
        return setMidnight(new Date())
    }

    public static Date getTomorrow() {
        return (getToday() + 1) as Date
    }

    public static Date setMidnight(Date theDate) {
        Calendar cal = Calendar.getInstance()
        cal.setTime(theDate)
        cal.set(Calendar.HOUR_OF_DAY, 0)
        cal.set(Calendar.MINUTE, 0)
        cal.set(Calendar.SECOND, 0)
        cal.set(Calendar.MILLISECOND, 0)
        cal.getTime()
    }

    //...

} 
```

Then, in the validator, you can use

```
startDate(validator: {return (it.after(DateTimeUtil.today))}) //Groovy-ism - today implicitly invokes `getToday()` 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-09T07:51:31.657

I cracked it :

startDate(validator: {return (it >= new Date()-1)})

It was that simple ;-)

To change the view in GSP page:

```
<g:datePicker name="startDate" value="${trip?.startDate}" years="${years}"  precision="day" /> 
```

Thanks everyone for the contribution

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T10:42:51.670

Better use calender plugin in Grails.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-15T16:49:40.457

You should use `startdate.clearTime()`

We do this by overwriting the setter for our domain classes that only need the date and not the time. That way, we can compare the dates of two instances without having to do this later. :

```
def setStartDate( Date date ) {
    date.clearTime()
    startDate = date
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-08T12:49:41.990

Try using 'java.sql.Date' not 'java.util.Date' as a type of your Date property along with

**formatDate**

**Purpose**

Allows the formatting of java.util.Date instances using the same patterns defined by the SimpleDateFormat class.

**Examples**

**Description**

**Attributes**

```
* format (required) - The format to use for the date
* date (required) - The date object to format 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-03-21T10:55:34.870

Late I know, but these days, don't use Date, use LocalDate. Works fine in Grails / groovy GORM, and it's the new Java way of doing things.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-08T12:56:10.153

Maybe

```
startDate(validator: {d = new Date(); return (it..d) >= 0}) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-08T13:02:05.383

Have you tried using [jodatime](http://joda-time.sourceforge.net/)? It makes working with date and time in java so much easier.

# performance - IDE/编译器 PC 基准测试来比较我的 PC 性能？

> ID：349293
> 
> 赞同：3
> 
> 时间：2008-12-08T11:56:37.543
> 
> 标签：performance, visual-studio-2008, upgrade, benchmarking

我正在寻找一个基准（以及其他 PC 上的结果），它可以让我了解通过升级我的 PC 可以获得的开发性能增益，并且该基准也可以用来证明我的老板升级的合理性。

我使用 Visual Studio 2008 进行开发，所以我想了解构建时间会通过什么因素得到改善，如果基准测试可以包含 IDE 性能（即在编辑时，使用智能感知，打开代码文件等）到其结果中。

我目前有一个 AMD 3800x2，在 Vista 32 上具有 2GB RAM。例如，我想知道我在 Visual Studio 2008 中看到什么样的性能提升，在 Vista 64 上具有 Q6600、4GB RAM。以及其他处理器和其他 RAM 大小……还可以查看硬盘性能是否是一个重要因素。

编辑：我提到 Vista 64 是因为我知道 Vista 32 最多只能使用 3GB RAM。因此，我认为想要使用更多 RAM 需要 Vista 64，但总体上它可能仍然会更慢，在 64 位操作系统上使用 32 位 VS 2008 会有很大的开销。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T12:07:13.933

抱歉，我不知道专门针对 IDE 的任何基准测试。

但是，Vista-64 运行 VS 的速度不会比 Vista-32 快，因为 VS 是 32 位的。如果有的话，它在 Vista-64 上的运行速度会稍微慢一些。要在 Vista x64 上运行任何 32 位应用程序，操作系统使用称为 WOW64 的转换层：

[WOW64是操作系统提供的兼容环境，允许32位应用程序在Windows 64位操作系统上运行。](http://en.wikipedia.org/wiki/WOW64)

一个问题是必须在 WOW64 下运行 Visual Studio，它实际上在 Vista x64 上的运行速度可能比在 Visa x86 上慢。显然在 x86 下它不需要经过翻译过程。

网上有很多在 32 位和 64 位版本的 Windows 上运行 32 位应用程序的比较。一般来说，如果看到任何好处，它们是相对较小的。一项这样的测试仅在某些有限的情况下显示了改进，甚至降低了在 64 位环境中运行的某些 32 位应用程序的性能：

[我们看到的是，使用 64 位内存寻址，或者特别是将 32 位可执行文件的内存寻址转换为与 64 位版本的 XP 一起工作，会对内存带宽造成轻微影响。虽然还不足以成为问题，但它证明了我们从之前的基准测试结果中已经看到的情况：32 位代码在 64 位环境中的运行速度比在其原生 32 位环境中的运行速度稍慢。](http://www.pcstats.com/articleview.cfm?articleid=1665&amp;page=7)

更好的 RAM 和磁盘性能肯定会有所帮助。VS 在构建时会执行大量磁盘 IO。

斯科特对此有一篇很好的帖子：[http ://weblogs.asp.net/scottgu/archive/2007/11/01/tip-trick-hard-drive-speed-and-visual-studio-performance.aspx](http://weblogs.asp.net/scottgu/archive/2007/11/01/tip-trick-hard-drive-speed-and-visual-studio-performance.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T12:43:07.527

请阅读Patrick Smacchia[的这篇博文。](http://codebetter.com/blogs/patricksmacchia/archive/2008/12/04/solid-state-drive-enhance-developers-productivity.aspx)我很清楚，区别在于 HDD/SSD，所以选择 SSD。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T12:06:33.217

我不知道任何可以比较 Visual Studio 的基准……但我可以告诉你；最大的收获是购买更快的硬盘驱动器（例如 300GB Velociraptor）并确保您有足够的 RAM。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T12:59:35.950

我只能说，“incredibuild”增强网络环境中的客户端概览可以为您提供这样的速度比较。我们将它与 10 个客户端一起使用（尽管硬件都相同：（）

也许这里有一些比我工作的大公司的开发人员可以为您提供有趣的信息？！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-10T10:50:30.977

Anandtech 已开始使用 Visual Studio 2008 中的 Chromium 构建作为 CPU 基准测试。

[http://www.anandtech.com/show/4083/the-sandy-bridge-review-intel-core-i5-2600k-i5-2500k-and-core-i3-2100-tested/19](http://www.anandtech.com/show/4083/the-sandy-bridge-review-intel-core-i5-2600k-i5-2500k-and-core-i3-2100-tested/19)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-10T09:50:54.767

有很多任务，但据我研究：

*   VS 启动 - SSD & RAM
*   编译项目 - 多核快速 CPU（编译使用更多核/HT）+ SSD
*   在文件中查找/查找参考 - 具有最高速度的最大 RAM + SSD

所以一般来说，一切都很好。至少 4 个内核，至少 8-16 GB RAM 和不错的 SSD。

# workflow-foundation - Windows 工作流基础中的事务范围

> ID：349308
> 
> 赞同：1
> 
> 时间：2008-12-08T12:05:19.287
> 
> 标签：workflow-foundation

我在 Windows 工作流基础中使用了事务范围活动。我收到一个工作流 SQL 持久性错误。

我没有 SQL 持久性数据库。

我们是否需要持久性服务。

我没有 Microsoft 分布式事务协调器 (MSDTC)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-02T08:49:06.453

Windows Workflow Foundation 3.x 中的事务范围需要支持事务工作的 WorkflowPersistenceService。开箱即用的 SqlPersistenceService 适用于此，您也可以编写自己的。

# .net - ASP.Net 程序员应该参考哪些其他框架以获得代码灵感？

> ID：349318
> 
> 赞同：4
> 
> 时间：2008-12-08T12:10:45.737
> 
> 标签：.net, asp.net

ASP.Net 程序员应该参考哪些其他框架以获得代码灵感？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-08T12:26:35.983

扩大您的搜索范围 - 不要只看 ASP.NET MVC。不同的方法将帮助你更好地理解你想做的事情。

一些建议：

*   [回报率](http://www.rubyonrails.org/)
*   [姜戈](http://www.djangoproject.com/)
*   [圣杯](http://grails.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T12:20:53.843

ASP.NET 程序员应该看看 ASP.NET MVC 框架，以了解如何在基本相同的平台上做事的替代方案，但仍然更像其他一些流行的框架。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-08T12:21:43.967

毫无疑问，您需要查看[ASP.NET MVC](http://www.asp.net/mvc/default.aspx?wwwaspnetrdirset=1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T12:16:25.163

那么 ASP.NET 在它自己的方面非常独特。您拥有用户控件、母版页、Web 表单、大量用于 IIS 的钩子……

我会说您应该查看其他人的代码以获取灵感，看看他们是如何做到的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-08T12:24:00.483

Drupal 有一个非常简洁的挂钩框架，它允许您扩展模块和核心代码，而无需通过编辑它并在每个新版本之后被迫重新进行更改来分叉它。

Rails 有一些非常令人难以置信的实用程序（如 rake），它们使数据库迁移变得轻而易举，并使项目设置变得更加容易。

Django 有一个非常干净的代码库和快速的开发时间。

# css - 使用 css 复制 html 元素

> ID：349322
> 
> 赞同：20
> 
> 时间：2008-12-08T12:12:45.123
> 
> 标签：css, navigation

我一直在为我试图正确实现的网页设计一个网页。此设计包含在整个页面中部分或全部重复的导航元素 - 特别是，指向主要 3 个导航类别的链接在页面上出现不少于 4 次。

我不是网页设计专家，但我不喜欢在 html 中复制相同内容的想法。我可以使用 CSS 使我的 html 包含一个健全格式的导航链接列表，但标准浏览器视图包含多个部分重复项吗？

（另外，假设这是可能的，这是一个好主意吗？或者我会更好地习惯我的 html 将包含 4 次相同的链接的想法？）

编辑：实际上生成导航链接不是问题；我正在寻找清理输出html

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-08T12:23:09.017

简短的回答：没有。

长答案：不是真的，

有几个 CSS 选择器[**:before**和**:after**](http://www.quirksmode.org/css/beforeafter.html)可以用于这种目的，但它们的内容是有限的，而且它们的实现还不是跨浏览器安全的。

恕我直言，这样做可能是不明智的，因为样式（实际上是内容）现在可能看起来相同，但不能保证以后会，而且这种内容*是内容*，正确地属于标记而不是样式. 如果您不喜欢服务器端包含模型（这很好），我希望 JS 可以帮助您复制标记，而 CSS 可以帮助您保持一致的样式，但我认为您不一定会走上一条富有成效的道路.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-05T16:12:35.630

## 有点可能，但仍不确定您是否愿意

**并提出了一些严重的挑战，这些挑战因环境而异。**

一个问题是您的既定目标是减少 html 的混乱和冗余。但是，要拥有一个链接，您仍然需要一个锚元素 ( `<a></a>`) 作为链接的根。

尽管如此，您可以使用当今的浏览器（现在更普遍地支持伪元素）执行类似操作的一种方法是将文本与**在**`a`代码中留下*空*锚点的文本分开。所以你仍然有`a`代码中的 HTML，但消除了任何多余的*文本*。这真的有用吗？不是我的想法。特别是如果您正在处理*作为 text 一部分的**内联*链接，因为您要做的是然后通过伪元素将文本添加到这些链接，例如：

 *```
a[href='#oneUrl']:before {
    content: 'your anchor text';
} 
```

看看[这个小提琴的例子](http://jsfiddle.net/hSNLr/8/)。

但是，还有**另一种方法*可以进一步减少 HTML***，但有一些其他严重的限制。您可以在文本本身中有链接（比方说），这允许在其中包含相关的真实内容措辞。但是，它们中的每一个都可以有两个（目前*最大*）关联的伪元素，可以“扩展”为页眉、页脚等中的单独链接。看看[这个小提琴示例](http://jsfiddle.net/hSNLr/15/)。显然，这要求您能够精确定位这些链接（可能`position: fixed`像示例中那样使用），这可能具有挑战性。然而，一个大问题是搜索引擎不会选择那些额外的链接或它们的文本，屏幕阅读器也不会，所以你的“主导航”实际上变得*不可见*在某种程度上。这对我来说似乎是不可取的，但*它确实限制了您的 html 冗余*。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2019-01-15T13:44:53.310

您可以通过将属性中的内容投影为伪元素来复制它：

```
.duplicate::before,
.duplicate::after {
    content:attr(title);
    display:block;
}
```

```
<div class="duplicate" title="text to duplicate"></div>
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-08T12:20:16.013

简短的回答不，在 css 中你不能创建内容或多次显示它。通常这种重复的内容是通过服务器端技术（PHP、JSP、ASPX）等来处理的。如果您的网站是静态内容（没有服务器端处理），那么您最好的选择就是复制和过去。

使用 javascript 可以做到这一点，但会有很多缺点，最好是复制和粘贴。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-08T12:18:25.173

恕我直言，这是不可能的。我的解决方案是添加一个小型 PHP 或其他引擎，在需要的位置自动呈现菜单。这样你的代码就是[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-08T12:21:14.653

您可以查看[服务器端包含](http://httpd.apache.org/docs/1.3/howto/ssi.html)，但是正如 Germstorm 已经说过的那样，这可能最好通过一个小的 PHP 脚本来完成。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-08T12:24:52.977

如果您仅在单个文件中重复链接代码{您将其用作模板并动态推送内容}，这不会有太大问题。

我不会假设您使用哪种服务器端技术，但您可以使用 JavaScript 快速管理它。为链接编写 HTML，将其分配给 JavaScript 变量，然后在需要的地方回显它。

此外，如果您碰巧使用的是 scriptalicious，那么您很幸运！您可以使用Builder**动态**[创建 DOM 元素](http://github.com/madrobby/scriptaculous/wikis/builder)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-08T12:31:05.977

正如其他人所说，如果您可以使用一些服务器端代码。如果由于某种原因不能使用服务器端代码，最好的办法是编写一个小程序，读取您独特的 html 页面并添加重复的 HTML。这比手动复制和粘贴更快更容易，尤其是在您有很多页面的情况下。如果您在处理过程中向页面添加了一些带有特殊标识符字符串的 html 注释标签，您还可以在将来更改页面结构时使用这些标签快速查找和替换所有常见的 HTML。

但是像这样预处理html页面是一种痛苦，所以除非你不能在服务器端这样做，否则不要这样做。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-04-11T07:45:03.037

你说你想清理输出的 HTML。但出于什么原因？我假设您要么想减少 HTML 大小和带宽占用，要么保持 HTML 漂亮，就像源代码一样。

**减少 HTML 大小和带宽占用**

实现此目的的最佳方法是使用 HTTP 压缩。大多数 HTTP 服务器都可以配置为以这种方式提供内容。检查您的服务器文档。

**保持 HTML 漂亮**

也许你想把你的 HTML 变成一个模板引擎。有几个选项，比如[Mustache.js](https://github.com/janl/mustache.js)和[Underscore](http://underscorejs.org/#template)。但是，您会受到性能损失，因为 JS 处理需要额外的步骤。

* * *

无论如何，我认为您正在解决错误的问题。仅仅因为 HTML [有点] 可读，并不意味着它应该被视为源代码。我经历过这个，现在我只是将 HTML 视为浏览器的“汇编代码”。使用更好的模板语言，如[Slim](http://slim-lang.com/)，有助于执行此 POV。

这并不意味着您应该将 HTML 视为垃圾。这只是意味着它的输出可读性不是你作为程序员的问题，你应该担心使用**可靠的模板引擎编写好的和可读的****视图模板**。毕竟，您希望 HTML 尽可能让浏览器快速呈现。如果这意味着代码重复并且没有空格，那就这样吧。

 *** * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-05-30T22:08:22.003

可以使用`::before`和`::after`。但是，它只能显示文本（不能显示 HTML 元素）。如果它可以显示 HTML 元素，那么将存在重大安全风险......

我可能会`<script>`在页面内注入一个元素，例如使用恶意 JavaScript。

如果 CSS 能够做到这一点，那么诸如 Stylish 之类的 CSS Userscript 扩展可能会很危险。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2013-04-08T03:23:49.000

我认为您将使用 HTML 包含和 SSI 或服务器端包含在相同页面上合并相同的方法，这是您将使用的格式。 `<!--#include virtual="path to file/include-file.html" -->`，始终在每个相似的页面中包含该文件.. 只需转到此链接.. [http://webdesign.about.com/od/ssi/a/aa052002a.htm](http://webdesign.about.com/od/ssi/a/aa052002a.htm)

# javascript - 如何将列调整大小添加到 MooTools 可排序表？

> ID：349325
> 
> 赞同：1
> 
> 时间：2008-12-08T12:13:30.503
> 
> 标签：javascript, html, html-table, mootools, tablesorter

我想要一张[与这张类似](http://joomlicious.com/mootable/)的表格，但用户可以在其中调整表格的高度并对其进行排序。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T11:13:51.310

我在这里找到了好的 [http://groups.google.com/group/flexigrid/?pli=1](http://groups.google.com/group/flexigrid/?pli=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T14:05:37.253

[http://demos111.mootools.net/Resizable](http://demos111.mootools.net/Resizable)

# java - 我应该如何构建 jsps 使用的资源包属性文件？

> ID：349326
> 
> 赞同：3
> 
> 时间：2008-12-08T12:14:39.380
> 
> 标签：java, jsp, jakarta-ee, internationalization

我目前正在转换现有的 Web 应用程序以支持其他语言（即威尔士语）。我建议的方法是将所有显示的文本提取到属性文件中，然后使用 JSTL fmt 标记访问文本。

我的问题是：这些属性文件应该如何构建？我知道它们需要位于 Web 应用程序的类路径中，但与其将它们直接存储在 WEB-INF/classes 中，我更愿意在构建步骤中将它们复制到那里。这让我在如何在 subversion 中存储文件方面有很大的灵活性。由于它们与 jsp 密切相关，因此创建一个新的顶级目录（例如资源）并在此文件夹下镜像 jsp 结构是一个好主意吗？这会给我一个像

```
resources/jsp/index.properties
resources/jsp/index_cy.properties 
```

这似乎是一种合理的方法，如果需要它们，它也可以扩展到类的属性文件：

```
resources/com/mycompany/myapp/CustomObject.properties
resources/com/mycompany/myapp/CustomObject_cy.properties 
```

然后，构建过程可以将所有这些文件复制到 WEB-INF/classes 中，以便打包到 war 文件中。

这种方法是否符合行业标准？这是我目前公司的第一个多语言应用程序，因此它很可能被用作所有其他公司的蓝图。

编辑：有人指出，这种方法可能会导致各种属性文件中出现大量重复的字符串。虽然这是真的，但它只会与 jsps 中当前存在的重复字符串一样多。从 jsp 到属性文件的清晰映射是否会更好，代价是属性文件中有一些重复？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T12:19:07.217

> 这种方法是否符合行业标准？这是我目前公司的第一个多语言应用程序，因此它很可能被用作所有其他公司的蓝图。

是的，我认为是的。

我相信 Maven 创建了以下目录结构：

```
源代码
  +- 主要
  | |- 爪哇
  | |- 资源
  +- 测试
       |- 爪哇
       |- 资源

```

这为您提供了代码和单元测试之间的清晰分离，然后是 java 代码和资源（如属性文件等）之间的分离。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T16:59:47.697

> 有人指出，这种方法可能会导致各种属性文件中出现大量重复的字符串。虽然这是真的，但它只会与 jsps 中当前存在的重复字符串一样多。从 jsp 到属性文件的清晰映射是否会更好，代价是属性文件中有一些重复？

是的，这总是更好。虽然可以在不同的地方/JSP 用英语“重用”一个字符串，但在其他语言中它仍然是不可能的。重用本地化字符串还可能在原本不相关的组件之间产生不必要的和棘手的依赖关系。翻译人员还需要了解他们在您的应用程序中翻译的文本的使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T12:24:30.530

我不确定在资源文件和使用它们的代码文件之间建立太强的连接是否是个好主意，因为这可能会导致不必要的重复文本重复。

当文本由第三方翻译时，这尤其成问题，因为相同的表达，当在不同的文件中多次出现时，可能会被不同的翻译，这会极大地混淆用户。

我会分别构建资源文件，并尝试找到一个本质上有意义的组织，例如 UiLabels.properties、ErrorMessages.properties。

# c# - 测试过程。开始？

> ID：349336
> 
> 赞同：19
> 
> 时间：2008-12-08T12:18:53.053
> 
> 标签：c#, unit-testing, process

我正在创建一个应用程序，它将管理外部实用程序的多个实例，为每个实例提供数据并获取结果。

但是当我为班级编写单元测试时，我遇到了一个问题。

**如何测试目标方法在调用时实际启动进程（通过属性设置）？**

我试过了：

*   让该类执行一个外部进程，然后使用 GetProcessesByName 检查它是否已启动。
*   使用输出重定向，例如使用大于号将某些内容回显到文件并测试其存在

我觉得发出代码和/或创建另一个 exe 来测试是矫枉过正的。

这是确切的方法：

```
public void Start()
{
    if (!_isRunning) {
        var startInfo = new ProcessStartInfo() {
            CreateNoWindow = true,
            UseShellExecute = true,

            FileName = _cmdLine,
            Arguments = _args
        };

        _process = Process.Start(startInfo);
        _isRunning = true;

    } else {
        throw new InvalidOperationException("Process already started");

    }
} 
```

我想对其进行单元测试，以便如果没有运行（_isRunning == false），则应该生成一个新进程。

我感到很难过，是否有一种优雅的方式来对外部进程实际启动进行单元测试？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-08T12:30:32.763

我会使用依赖注入并使用模拟或假类来解决这个问题。注意我使用的是实例方法而不是类方法。在您的常规代码中，您可以使用默认构造函数，它将为您创建一个进程。对于测试，您可以注入一个模拟或假进程，并简单地检查在您的模拟对象上调用了正确的方法，并且根本不需要实际启动一个进程。您需要调整它以考虑我省略的属性。前任。以下：

```
 public class UtilityManager
 {
      public Process UtilityProcess { get; private set; }

      private bool _isRunning;

      public UtilityManager() : this(null) {}

      public UtilityManager( Process process )
      {
          this. UtilityProcess = process ?? new Process();
          this._isRunning = false;
      }

      public void Start()
      {
          if (!_isRunning) {
          var startInfo = new ProcessStartInfo() {
              CreateNoWindow = true,
              UseShellExecute = true,

              FileName = _cmdLine,
              Arguments = _args
          };

          this.UtilityProcess.Start(startInfo);
          _isRunning = true;

      } else {
          throw new InvalidOperationException("Process already started");
      }
 } 
```

测试代码...

```
 [TestMethod]
 public void StartTest()
 {
      Process proc = new FakeProcess();  // May need to use a wrapper class
      UtilityManager manager = new UtilityManager( proc );
      manager.CommandLine = "command";
      ...

      manager.Start();

      Assert.IsTrue( proc.StartCalled );
      Assert.IsNotNull( proc.StartInfo );
      Assert.AreEqual( "command", proc.StartInfo.FileName );
      ...
 } 
```

# php - JavaScript 函数不工作。如何解决？

> ID：349348
> 
> 赞同：0
> 
> 时间：2008-12-08T12:21:35.340
> 
> 标签：php, javascript, ajax

我有以下 JavaScript 代码： [链接](http://www.nomorepasting.com/getpaste.php?pasteid=22561)

其中 makewindows 函数似乎不起作用。

它确实创建了一个窗口，但是 html 要么包含引号，要么如果我将其更改为

```
child1.document.write(json_encode($row2["ARTICLE_DESC"])); 
```

创建一个空白的 html 页面。

我将此函数移动到我的主要 JavaScript 文件以包含，因为我之前遇到错误，但现在弹出窗口中没有显示 HTML。这是因为我没有在 thest3.php 中检索 article_Desc 吗？

使用的其他 2 个文件在这里： [link](http://www.nomorepasting.com/getpaste.php?pasteid=22562) 和[test3.php](http://www.nomorepasting.com/getpaste.php?pasteid=22563)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T13:01:40.500

> $row2["ARTICLE_DESC"] 是 PHP 变量。

它确实是一个 php 变量，但**它没有被呈现为 php，因为它没有包含在`<?php ?>`标签中**

所以，正确的做法是：

```
child1.document.write(<?php echo json_encode($row2["ARTICLE_DESC"]); ?>); 
```

这样，作为服务器端语言的 php 将在呈现页面之前呈现 $row2 中的值，因此当页面最终呈现时，该值将在 javascript`write`函数中......因为它应该是。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T12:26:54.347

要打印 php 变量，您需要 php 标签：

```
child1.document.write(<?php echo json_encode($row2["ARTICLE_DESC"]); ?>); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T12:23:43.293

$row2["ARTICLE_DESC"] 是 PHP 变量。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-08T12:56:28.903

我怀疑它在被 PHP 解释器解析后包含了 javascript。尝试向 makewindows 添加一个参数，并在构建 HTML 时通过参数传递您打算使用的值。

```
 ...
 <p><a href='#' onclick='makewindows('"
  . json_encode($row2["ARTICLE_DESC"])
  . "'); return false;'>...

function makewindows(html){
   child1 = window.open ("about:blank");
   child1.document.write(html);
   child1.document.close();
} 
```

# sql-server - SQL Server：打印输出不会立即出现

> ID：349358
> 
> 赞同：92
> 
> 时间：2008-12-08T12:24:57.907
> 
> 标签：sql-server

在 SQL Server 2005 Management Studio 中，PRINT 语句的输出似乎不会立即出现：如果我有一个 PRINT 语句后跟一个长时间运行的语句，则 PRINT 输出直到以下语句之后才会出现。

有没有办法更早地刷新输出？我正在运行一些需要很长时间才能完成的升级脚本，我想知道脚本的进度（所以我知道是等几分钟然后开始下一个，还是去吃午饭）。

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2008-12-08T12:26:36.080

`go`不会。只有在提交事务、返回其他记录集或完成语句（ SQL 批处理中的语句终止符）时，才会返回 PRINT 语句的输出。您可以在非致命错误级别 (0-18) 上使用[raiserror](https://docs.microsoft.com/en-us/sql/t-sql/language-elements/raiserror-transact-sql)来获得此类即时反馈。例如：

```
RAISERROR ('Foo', 10, 1) WITH NOWAIT 
```

# visual-studio - MDF 文件的版本控制

> ID：349360
> 
> 赞同：7
> 
> 时间：2008-12-08T12:26:32.053
> 
> 标签：visual-studio, database-design, version-control

我正在开发一个 Web 应用程序（它位于 Visual Studio 2008 的 asp.net mvc 框架测试版中）并且想要对其进行版本控制。如何对 App_Data 文件夹中的数据库文件（*.mdf，二进制）进行版本控制。

有没有办法只存储表和数据库的任何定义，还是我真的需要对其内容进行版本控制？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-08T21:36:32.397

将数据库结构导出为创建脚本，并可能将一些表（参考）数据导出为插入脚本，然后将它们检查到源代码管理中。

绝对不要尝试将数据库二进制文件 (*.mdf) 放入源代码控制中。

# sql-server - SQL Server：升级数据库

> ID：349364
> 
> 赞同：1
> 
> 时间：2008-12-08T12:27:08.433
> 
> 标签：sql-server, upgrade

我们有一个使用 Microsoft SQL Server 数据库的产品。我们有客户使用各种旧版本的产品。

在这种情况下，人们如何编写/构建他们的数据库升级脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T12:31:58.173

您需要一组发布到发布的补丁脚本。在具有实时数据的生产系统上，这有点棘手，因为您可能还必须在这些脚本中操作数据。

[Redgate SQL Compare Pro](http://www.red-gate.com/products/SQL_Compare/index.htm)是生成这些脚本或对脚本执行 QA 功能的非常好的工具（显然您不应该将它同时用于这两个角色）。因为您涉及实时客户数据，所以您必须对升级进行回归测试。

我不认为有一个简单的方法可以做到这一点。您必须开发脚本并测试它所做的任何数据操作。为一些有用的升级集进行不同版本的测试。这里的关键是安排一个生产镜像测试环境，您可以在将补丁应用到实时系统之前对其进行测试。

PS 在你最终运行补丁脚本之前不要忘记在生产数据库上备份和测试恢复，但你已经知道了；-}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T12:55:03.650

我们有一个 SQL 脚本可以进行全新安装和升级。安装 SQL Express 或完整的 SQL Server 后，我们运行此脚本，该脚本执行以下操作：

1.  如果表不存在，则使用 CREATE TABLE 创建表。
2.  删除并重新创建所有存储过程
3.  对表格进行修改，例如字段更改、字段添加等。

我们继续扩展这个脚本，所以每个版本只会添加到这个 SQL 脚本文件。这意味着我们可以在生产系统上运行此脚本以将它们更新到最新模式，使用该脚本进行新安装以从头开始创建模式。

这样，我们可以保证升级脚本甚至会将最旧的安装升级到最新版本。

# sql-server - 架构更改未在 SQL 2008 (SSMS) 中的 Intellisense 中更新

> ID：349366
> 
> 赞同：20
> 
> 时间：2008-12-08T12:27:39.743
> 
> 标签：sql-server, sql-server-2008, intellisense, ssms

我注意到 SQL Server 2008 中的 SSMS 中存在一个问题 - 感觉像是一个错误，但我怀疑是一个“功能”。

我打开了各种选项卡，例如一个表中的更改表脚本和在另一个选项卡中查询该表的 SProc，当我执行更改表脚本时，更改不会反映在另一个选项卡中的 Intellisense 中。

我可以创建新查询，但更改仍未反映在 Intellisense 中。如果我打开一个新的 SSMS 实例，这些更改会反映出来，当然，直到我进行进一步的更改。

但是，如果您否决了 Intellisense 并继续使用修改后的表和代码，则所有内容都会编译而不会发出任何抱怨（如预期的那样）。

这是一个错误吗？一个特征？是否有某个地方可以改变这种行为？我检查了选项，但看不到任何东西

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-12-03T14:16:59.400

`CTRL`++`SHIFT`更新`R`智能感知，简称。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-08T12:34:48.153

在我发布问题之前，我找到了在谷歌上成功搜索的正确短语。

是的，伙计们，这确实是一个功能！智能感知依赖于您需要手动刷新的本地缓存。看：

[http://blogs.msdn.com/dtjones/archive/2008/09/11/refreshing-the-intellisense-cache.aspx](http://blogs.msdn.com/dtjones/archive/2008/09/11/refreshing-the-intellisense-cache.aspx)

另外：[Ninjapig的替代品](http://blog.sqlauthority.com/2009/03/31/sql-server-2008-intellisense-does-not-work-enable-intellisense/)

恕我直言，这不仅有点烦人，但我相信专家们会争辩说，这样做有一些重要的需求。经过进一步检查，我已经能够在其中一个工具栏上添加一个“刷新本地缓存”按钮。快速尝试刷新后，刷新似乎需要一些时间，因为 Intellisense 从过时到不存在，然后又回到更新状态或一分钟左右。

我很想提出这个问题，但我会把它留在这里，以防它帮助其他人解决这个问题，或者直到其他人决定不这样做......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T23:28:50.600

很好地提出了这个问题——我在 VS 2008 SP1 中经常遇到它，但是在刷新发生之前，编码正确的名称仍然会产生一个错误的错误——我目前无法让它这样做。我怀疑我需要再次关机/重新加载。

# python - 如何在 post 查询中传递 python 列表？

> ID：349369
> 
> 赞同：9
> 
> 时间：2008-12-08T12:28:28.460
> 
> 标签：python, web-services

我想在 POST 调用的列表中发送一些字符串。例如：

```
 www.example.com/?post_data = A list of strings 
```

python 代码将数据作为单个字符串（而不是字符串列表）接收。如何将其发布为字符串列表？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-08T12:35:54.343

URL 中没有“字符串列表”之类的东西（或者几乎在 HTTP 中的任何内容中 - 如果您为同一个标头指定多个值，它们会在大多数 Web 应用程序框架 IME 中作为单个分隔值出现）。它只是一个字符串。我建议您以某种方式（例如逗号分隔）分隔字符串，然后在另一端再次解析它们。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-08T13:13:35.000

TRY JSON(JavaScript Object Notation) 它在 python 包中可用。在这里找到：http: [//docs.python.org/library/json.html](http://docs.python.org/library/json.html)

您可以将列表编码为以 JSON 表示的数组并附加到 post 参数。稍后将其解码回列表...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-08T12:38:23.903

你在说这个吗？

```
post_data= ",".join( list_of_strings ) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T12:36:52.563

如果您收到的大字符串只是分隔，那么您可以尝试拆分它。请参阅[拆分字符​​串](http://www.java2s.com/Code/Python/String/Splittingstrings.htm)。

为了澄清，你得到了字符串的分隔列表，将该列表拆分为一个 python 列表，瞧！，你有一个 python 列表......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-08T13:15:32.237

格式化传入参数取决于您的服务器。例如，当 zope 收到这样的请求时： [http ://www.zope.org?ids:list=1&ids:list=2](http://www.zope.org?ids:list=1&ids:list=2)

您可以将 id 作为列表获取。但此功能取决于服务器。如果您的服务器不支持某种解析和验证您的输入，您必须自己实现它。或者你使用zope。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-15T12:33:24.197

如果您不能或不想简单地用逗号分隔它们，并且您想以更列表的方式发送它们。我有一个要传递的数字列表，并且我在另一端使用 PHP 网络服务，我不想重建我的网络服务，因为我使用了 Zend 框架提供的通用多选元素。

这个例子适用于我和我的小整数，它适用于你的字符串，我实际上不执行 urllib.quote(s)，我只是做一个 str(s)。

导入 urllib

```
import urllib 
```

你的蜇伤清单：

```
string_list = ['A', 'list', 'of', 'strings', 'and', 'öthér', '.&st,u?ff,'] 
```

将字符串列表与 'post_data[]=' 连接在一起，同时对字符串进行 urlencode

```
post_data = '&'.join('post_data[]='+urllib.quote(s) for s in string_list) 
```

发布到[http://example.com/](http://example.com/)

```
urllib.urlopen('http://example.com/',post_data) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-08T14:55:56.527

传递给 POST 语句的数据（据我所知）被编码为键值对，使用 application/x-www-form-urlencoded 编码。

因此，我假设您将字符串列表表示为以下字典：

```
>>> my_string_list= { 's1': 'I',                                                
...     's2': 'love',                                                           
...     's3': 'python'                                                          
... } 
```

然后，将它作为参数传递给 POST 就像阅读 urllib 的文档一样困难。

```
>>> import urllib
>>> print urllib.urlopen( 'http://www.google.fr/search', 
       urllib.urlencode( my_string_list ) 
    ).read() 
```

请注意，google 的搜索查询不使用 POST，但您会看到 google 报告的错误。

如果您在输入上面的代码时运行 WireShark，您将看到 POST 的数据被传递为：

```
 s3=python&s2=love&s1=I 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-08T21:47:47.647

像这样的数据结构[`django.utils.datastructures.MultiValueDict`](http://code.djangoproject.com/browser/django/trunk/django/utils/datastructures.py)是表示此类数据的一种简洁方式。AFAIK 它保留了秩序。

```
>>> d = MultiValueDict({'name': ['Adrian', 'Simon'], 'position': ['Developer']})
>>> d['name']
'Simon'
>>> d.getlist('name')
['Adrian', 'Simon']
>>> d.get('lastname', 'nonexistent')
'nonexistent'
>>> d.setlist('lastname', ['Holovaty', 'Willison']) 
```

Django 使用[`django.http.QueryDict`](http://code.djangoproject.com/browser/django/trunk/django/http/__init__.py)(subclass of `MultiValueDict`) 将查询字符串转换为 python 原语并返回。

```
from django.http import QueryDict

qs = 'post_data=a&post_data=b&post_data=c'

query_dict = QueryDict(qs)

assert query_dict['post_data'] == 'c'
assert query_dict.getlist('post_data') == ['a', 'b', 'c']
assert query_dict.urlencode() == qs 
```

您应该能够复制这些类并在您的项目中使用它们。（虽然我没有检查所有依赖项）

# forms - 提交/重置按钮 - 表格中的订单

> ID：349375
> 
> 赞同：3
> 
> 时间：2008-12-08T12:31:47.707
> 
> 标签：forms, user-interface, usability

在表单上放置**提交和重置按钮时，****您使用什么顺序？**

```
[SUBMIT] [RESET] 
```

或者

```
[RESET] [SUBMIT] 
```

这个问题在工作中出现过无数次...

那么，在您看来，哪个对在线用户最有用？

我个人倾向于后者，但有些人倾向于不这么认为。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-15T21:58:27.313

我可能在这里是少数，但我**从来没有**在我的表格上放一个 RESET 按钮。

此外，当我测试表单时，我看不到用户需要删除表单上*所有*数据的情况。

对于用户来说，点击它并消除他们所有的辛勤工作太容易了。

用户收益：低

用户潜在问题：高

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-08T13:00:12.517

除了已经给出的建议之外，我想补充一点，提交按钮应该是一个实际按钮，其中重置或取消只是一个链接，使其与提交按钮不同，因此突出了它们在功能上不同并保持简单的事实. 您想要做的最后一件事是让您的用户思考。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-08T12:39:44.693

我总是像大多数 ms windows windwos [ok][cancel] 一样使用 [Submit][Reset] :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-08T12:39:59.157

Windows 中对话框的常见格式是在最右边（或者我应该说在外面？）有取消按钮。

快速浏览一下[设计指南](http://msdn.microsoft.com/en-us/library/bb545457.aspx)并没有找到官方推荐的顺序，但是您可以清楚地看到按钮是按取消从左到右排序的（即，您取消的次数越多，您的按钮越向右...... . 是的，也许，不，从来没有，我不能相信你问那个）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-08T12:38:36.210

这取决于用户拥有哪个平台背景，因为对话框和消息框通常以符合该平台界面指南的布局呈现按钮。不同的平台总是有不同的对话框布局。

我已经习惯了前者，因为我是 Windows 用户并且 Windows 有这个顺序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T12:38:49.253

就个人而言，我认为这取决于按钮的对齐方式。如果左对齐，我更喜欢第一个，否则，后者。

在这两种情况下，更常用的选择更加明显。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-08T12:42:22.177

我同意stg：这取决于我的对齐方式。如果按钮左对齐，则“接受”（或“提交”）选项位于左侧。如果按钮右对齐，则该选择在右侧。

还有一个我个人的烦恼：无论按钮如何对齐或排序，按回车键应该总是调用“提交”动作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-08T12:50:25.640

至于 [RESET] 按钮，我认为不应该在没有确认的情况下使用默认表单重置，尤其是在长表单中......

想象一下这种情况……用户急于完成在线交易，填写个人详细信息、信用卡号码和大量其他需要检查的东西，当用户完成时，他错误地点击了重置按钮而不是提交...！相信我，这是一个非常烦人的经历。

所以我认为，如果你曾经使用过重置按钮，你应该**首先`confirm`与用户联系，然后重置表单**

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-12-19T08:39:30.880

您可以为 [提交] 和 [重置] 尝试不同的配色方案。在我的表单中，我更喜欢 [submit] [reset] 使用不同的颜色并突出显示 [submit] 按钮。

# php - AJAX、PHP 会话和同时请求

> ID：349381
> 
> 赞同：0
> 
> 时间：2008-12-08T12:34:05.813
> 
> 标签：php, ajax, session

我会直入主题！

当用户提交搜索时，我的 javascript 向我的 PHP 文件发送大约 20 个 AJAX 请求以响应（通过外部 Web API）。结果存储在会话数组中的一个数组中。

我读过浏览器只允许同时向服务器发出 2 个请求。

我的第一个问题是，虽然仍有多个请求仍在等待响应，但 AJAX“添加到购物篮”请求将不起作用，因为它仍在等待其他请求完成。

我的第二个（也是更烦人的）问题是，同时处理的 2 个请求似乎相互覆盖，因此当所有响应完成时，只有一半在会话数组中。所有奇数或偶数取决于最终请求是奇数还是偶数。

我宁愿不必单独发送请求（即只在最后一个完成时发送下一个请求），因为这会减慢用户的速度。

是否有解决此会话覆盖的方法，或者我应该完全使用完全不同的方法？

谢谢大家！

* * *

编辑：
它用于检查域可用性。用户搜索“mydomain”，最终会显示 com、net、org 等的结果。

发送单个请求并让脚本一次性搜索所有 tld 意味着在所有结果都输入之前不会返回响应。某些 tld 的结果似乎需要长达 30 秒或超过 30 秒，在此期间用户没有得到任何反馈保存一个漩涡状图标和“请稍候”（这是未启用 javascript 时发生的情况）。

单独的请求允许我在域进入时显示它们的可用性。

我目前正在考虑发送单个请求，然后使用 javascript 的 setinterval 重复检查会话，直到所有结果都出现。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-08T12:41:21.930

我认为你应该开始重构你的解决方案：

1.  所有性能指南都规定您应该尽量减少 HTTP 请求的数量。20 太多了
2.  如果您有共享资源，则需要锁定和解锁您操作它的部分，以防止两个或多个请求同时更新它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T16:07:23.963

[http://php.net/manual/en/function.session-write-close.php](http://php.net/manual/en/function.session-write-close.php)

将会话中的数据存储在局部变量中，然后调用此函数为其他文件解锁会话。（虽然不得不说 20 次 AJAX 调用可能不是最好的解决方案）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-08T12:40:49.530

请求是并行处理的，这意味着这类似于并发编程（使用线程），包括竞争条件等。

我的建议是只将搜索操作（假设用户只执行一个搜索，而不是 20 个）发送到服务器，然后将其拆分为您希望它执行的 20 个操作。这允许您按顺序执行它们，防止它们相互覆盖。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-03T12:35:52.333

As others have pointed out your first approach should be to reduce the number of requests. If this is not an option you can use subdomains to increase the number of parallel requests.

Configure your DNS (for say mydomain.com) to accept all subdomains *.mydomain.com and to send them to the same server.

You can then send the different AJAX requests to different domains (a.mydomain.com, b.mydomain.com, ...)

This approach is used by mapservers such as google maps, to increase the number of maptiles that are downloaded in parallel by the browser.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-08T12:41:02.477

抱歉，这并不是您真正想要的答案，但 20 个请求对于一次搜索来说听起来太多了。实施了类似的事情，即。存储在会话中的简短搜索历史，我们选择根本不使用 AJAX。它有时间和地点，但如果当您的流量增加时它会通过请求杀死您的服务器，则不是。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T13:07:29.757

尝试为您的 ajax 调用构建请求队列。每次通话都将在前一个通话结束后进行。

在发出第二个请求后，您无法确定会发生什么，因为正如您所说，只能同时发送 2 个请求。在那个数字之后，第三个请求很可能会取代第二个，依此类推。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-12T23:16:59.717

问题是在同时请求之间，会话开始了。即使它在另一个上下文中打开，由于存储的会话读取和相同的 cookie，每个请求打开的会话是相同的。然后，如果当前请求中的一个首先结束其任务，它将关闭会话，因为它总是在脚本结束其任务时发生，但由于另一个脚本（另一个被调用的）可能仍在运行，它不知道会话已经关闭了，所以有一些解决方案。在结束任务之前，将会话 var 复制到 sessionholder var，重新启动会话，恢复会话值 session = sessionholder 和 session_write_close 哪个会话将首先开始或结束？有时没有办法知道，也许第一个开始会话的人会花更长的时间来结束他的任务，而另一个人来来去去，是分配一个引用（会话 ID），它发送给客户端（通常通过 cookie），因此当 cookie 返回时，该引用 ID 标识存储的会话变量以恢复先前的值。请记住，同一个调用可能会做同样的事情，因为 ajax 是异步的，如果由于某种原因一个调用延迟，并且用户再次单击，新请求不会结束当前请求，它会发生同样的问题，所以如果使用ajax 准备根据您的应用程序根据需要处理会话。最后，请记住，调用可能是对不同文件或同一个文件，一个ajax 调用请求prices.php 和其他products.php，但两者都将使用相同的会话存储变量，会话变量一直只有一个您拥有的所有脚本。盖兹大道。谢谢阅读 由于 ajax 是异步的，如果由于某种原因一个调用延迟，并且用户再次单击，新请求将不会结束当前请求，并且会发生同样的问题，因此如果使用 ajax 准备根据您的应用程序处理所需的会话. 最后，请记住，调用可能是对不同文件或同一个文件，一个ajax 调用请求prices.php 和其他products.php，但两者都将使用相同的会话存储变量，会话变量一直只有一个您拥有的所有脚本。盖兹大道。谢谢阅读 由于 ajax 是异步的，如果由于某种原因一个调用延迟，并且用户再次单击，新请求将不会结束当前请求，并且会发生同样的问题，因此如果使用 ajax 准备根据您的应用程序处理所需的会话. 最后，请记住，调用可能是对不同文件或同一个文件，一个ajax 调用请求prices.php 和其他products.php，但两者都将使用相同的会话存储变量，会话变量一直只有一个您拥有的所有脚本。盖兹大道。谢谢阅读 或相同的文件，一个ajax 调用请求prices.php 和其他products.php 但两者都将使用相同的会话存储变量，会话变量对于您拥有的所有脚本始终只有一个。盖兹大道。谢谢阅读 或相同的文件，一个ajax 调用请求prices.php 和其他products.php 但两者都将使用相同的会话存储变量，会话变量对于您拥有的所有脚本始终只有一个。盖兹大道。谢谢阅读

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-08T18:17:15.107

我认为这是某种自动完成搜索框。如果您使用的是 Scriptaulous 的 Ajax.Autocompleter，您可以简单地指定一个“minChars”参数。在至少输入了这么多字符之前，它不会发送 AJAX 请求。

您还可以调整“频率”参数，该参数会更改在触发 AJAX 请求之前轮询输入字段以进行更改的频率（以秒为单位）。

[更多细节在这里](http://github.com/madrobby/scriptaculous/wikis/ajax-autocompleter)

# sharepoint - 如何检查是否安装了 MOSS Standard 或 MOSS Enterprise？

> ID：349383
> 
> 赞同：4
> 
> 时间：2008-12-08T12:35:11.850
> 
> 标签：sharepoint, moss

如何检查是否安装了 MOSS Standard 或 MOSS Enterprise？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T10:45:56.040

由于 Paul 的回答中给出的链接似乎需要在 ASP.NET 网络博客上注册，因此无需离开并在其他地方登录即可获得答案：

Central Admin -> 操作 -> 升级和迁移 -> 转换许可证类型

“当前许可证”字段会告诉您。输入企业许可证密钥后，您还需要通过访问启用企业功能：

中央管理 -> 操作 -> 升级和迁移 -> 启用企业功能

完成此操作后，您将无法将安装恢复为标准功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T07:46:42.780

从代码中，检查 MOSS 许可证的一种简单方法是查看“Premium”（企业）农场范围的功能是否安装在`SPFarm.Local.FeatureDefinitions`：

```
99ee0928-7342-4739-865d-35b61ea4eaf0    BDCAdminUILinks
e4e6a041-bc5b-45cb-beab-885a27079f74    ExcelServer
a573867a-37ca-49dc-86b0-7d033a7ed2c8    PremiumSiteStapling
a10b6aa4-135d-4598-88d1-8d4ff5691d13    ipfsAdminLinks
cdfa39c6-6413-4508-bccf-bf30368472b3    DataConnectionLibraryStapling 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-08T12:43:54.547

该链接应该可以解决您的问题...

[确定共享点版本](http://weblogs.asp.net/danlewis/archive/2008/09/06/determine-which-version-of-sharepoint-is-installed.aspx)

编辑：这篇文章现在已经消失了，所以看看下面丹的回答

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-02T15:26:24.117

查看这篇文章“如何检查是否安装了 SharePoint Standard 或 SharePoint Enterprise？”

> 如上表所示，SKU 键只是一个 GUID，因此我们可以使用下面的代码轻松检索此信息，使用可视化 webpart 并将此 Render 方法添加到您的 UserControl.ascx.cs 文件中。

```
protected override void Render(HtmlTextWriter writer)
    {
        base.Render(writer);

        const string SHAREPOINT2010FOUNDATION = “BEED1F75-C398-4447-AEF1-E66E1F0DF91E”;
        const string SHAREPOINT2010STANDARD = “3FDFBCC8-B3E4-4482-91FA-122C6432805C”;
        const string SHAREPOINT2010ENTERPRISE = “D5595F62-449B-4061-B0B2-0CBAD410BB51″;

        SPFarm _spFarm = SPFarm.Local;

        IEnumerable<Guid> _guid = _spFarm.Products;
        foreach (var item in _guid)
        {

            string _skuID = item.ToString();
            writer.Write(“&lt;div>\n”);
            if (_skuID.Equals(SHAREPOINT2010STANDARD, StringComparison.CurrentCultureIgnoreCase))
            {
                writer.Write(“&lt;span>” + _skuID + ” – You have SharePoint 2010 Standard Edition” + “&lt;/span>\n”);
            }
            if (_skuID.Equals(SHAREPOINT2010ENTERPRISE,StringComparison.CurrentCultureIgnoreCase))
            {
                writer.Write(“&lt;span>” + _skuID + ” – You have SharePoint 2010 Enterprise Edition” + “&lt;/span>\n”);
            }
            if (_skuID.Equals(SHAREPOINT2010FOUNDATION, StringComparison.CurrentCultureIgnoreCase))
            {
                writer.Write(“&lt;span>” + _skuID + ” – You have SharePoint 2010 Foundation” + “&lt;/span>\n”);
            }

            writer.Write(“&lt;/div>\n”);

        }
    } 
```

# sharepoint - 工作流自动清理计时器作业未运行

> ID：349387
> 
> 赞同：1
> 
> 时间：2008-12-08T12:37:43.403
> 
> 标签：sharepoint, moss, timer-jobs

我正在测试几个工作流的工作流历史清理时间间隔。工作流程历史记录需要保留特定天数。我已经实施了[这里推荐的解决方案](http://mdablog.spaces.live.com/Blog/cns!B0C40902E1212960!796.entry)

我的问题是，现在我需要测试我的代码以查看工作流历史是否在确切的天数后被清理。

我开始知道工作流程历史记录是由每天运行的名为“工作流程自动清理”的计时器作业清理的。

但在我的情况下，工作流历史清理似乎没有运行，因为在 "Central Administration > Operations > Timer Job Definitions > Edit Timer Job" 中，上次运行时间显示为 "N\A"

我在这里有什么遗漏吗？我应该怎么做才能使这个计时器作业正常运行？

更新：检查 SharePoint 日志会显示以下消息：“升级作业定义已存在，等待现有升级完成”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-15T16:52:50.737

[从MSDN](http://social.msdn.microsoft.com/Forums/en-US/sharepointworkflow/thread/9d903fe5-6344-4e9b-893e-2f6fa7779622/)得到答案。

有针对此问题的修补程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-12T14:33:38.947

搞笑，一个允许您安装修补程序的修补程序？

此处概述的步骤对我有用：http: [//blogs.technet.com/manjesh/archive/2009/11/10/unable-to-run-sharepoint-configuration-wizard-error-unable-to-upgrade-sharepoint-产品和技术，因为升级已经在进行中.aspx](http://blogs.technet.com/manjesh/archive/2009/11/10/unable-to-run-sharepoint-configuration-wizard-error-unable-to-upgrade-sharepoint-products-and-technologies-because-an-upgrade-is-already-in-progress.aspx)

# asp.net - ASP.net 会话状态服务信息

> ID：349398
> 
> 赞同：1
> 
> 时间：2008-12-08T12:40:05.660
> 
> 标签：asp.net, service, state

您在哪里可以获得有关 ASP.NET 状态服务的信息，例如它的工作原理、性能、行为特征等。在 Internet 上查看过，但无法找到深入的信息或专门针对该主题的文章。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T12:53:12.640

以编程方式，会话状态只不过是字典或哈希表形式的内存，例如键值对，可以在用户会话期间设置和读取。

检查以下链接以获取更多详细信息：

*   MSDN 上的“ [ASP.NET 会话状态”](http://msdn.microsoft.com/en-us/library/ms972429.aspx)
*   MSDN 上的“[会话状态概述”](http://msdn.microsoft.com/en-us/library/ms178581%28VS.80%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T13:40:23.403

对于 SQL Server 状态管理，请记住不要`Session["Key"]`在循环中调用。（尽量避免这种情况）因为每次它访问会话时都会往返于 sqlserver。

# delphi - 从经典 asp 调用的 COM+ activeX dll 调用 non-activeX dll 时出现 IIS7 错误

> ID：349405
> 
> 赞同：0
> 
> 时间：2008-12-08T12:42:41.273
> 
> 标签：delphi, iis-7, asp-classic, activex

我有一个经典的 ASP 应用程序，它在旧版本的 IIS 上运行良好，但在 IIS7 上运行良好。

ASP 代码调用 COM+ ActiveX DLL（用 VB6 编写），我设法让一切运行良好，除了 ActiveX DLL 调用另一个第 3 方非 ActiveX DLL 的一个程序。

那时，我得到**"error 800706be"**。

我不确定在这里做什么。这是我尝试过的：

*   我认为这可能与权限有关，所以为了测试，我已将非 ActiveX DLL 的 IIS_IUSR 授予“完全控制” - 这并没有解决问题

*   我知道调用非 ActiveX DLL 的 COM+ 组件不是问题，因为我可以毫无问题地调用该组件中的其他方法。然后我看到组件服务中运行的组件。

谁能帮我吗？

**编辑**： 8000706BE 转换为“远程过程调用失败”。不是很有帮助，是吗？

**编辑** 嗨 - 感谢您的评论。我让第 3 方 DLL 的提供者将其重新编译为 ActiveX DLL，现在它在 IIS7 上运行良好。

第 3 方 DLL 是用 Delphi 编写的——起初他们尝试用最新的 Delphi 版本重新编译它，但也没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-08T12:55:43.383

看起来很奇怪试试这个工具来帮助。

> ADPlus 是 Microsoft 产品支持服务 (PSS) 提供的一种工具，可以对任何停止响应（挂起）或失败（崩溃）的进程或应用程序进行故障排除。通常，您可以使用 ADPlus (ADPlus.vbs) 作为 Microsoft Internet Information Server (IIS) 异常监视器 (6.1/7.1) 和用户模式进程转储的替代工具。这是两个独立的工具，PSS 经常使用它们来隔离导致进程在 Microsoft Windows DNA 环境中停止响应（挂起）或意外退出（崩溃）的原因。

[http://support.microsoft.com/kb/286350/](http://support.microsoft.com/kb/286350/)

# user-interface - 为什么 Tk GUI 被认为是丑陋的？

> ID：349409
> 
> 赞同：34
> 
> 时间：2008-12-08T12:45:18.833
> 
> 标签：user-interface, tk

Tk GUI 似乎被普遍认为是丑陋的，但我想知道具体原因。Tcl/Tk 世界中的一些人会争辩说，这是一个有争议的问题，因为现在对本地外观和感觉有更好的支持，这是我决定使用 Tcl/Tk 的一个重要原因。然而，现在的问题是，因为我正在利用 Tcl/Starkit vfs（虚拟文件系统），本机文件对话框不起作用，我将不得不恢复到纯 Tk 文件对话框。

请我寻找特定的技术原因，例如关于字体别名（或缺少）或字体样式或颜色等。因为我个人不买“这对我来说很丑”。对我来说，它只是不同，我经常在 Mac 和 Windows 和 Linux 之间切换，所以我习惯了不同的外观/感觉。

具体来说，传统 Tk GUI 的主题式外观被认为是丑陋的：

![Tcl/Tk GUI 示例](https://web.archive.org/web/20140120195559/http://ascend4.org/images/e/e4/Browser01.png)

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-12-08T15:01:19.993

我认为部分原因是 Tk 非常强大且易于使用，但它并没有做太多的手持操作。因为它很容易，所以在 UI 设计方面经验不足的人可以在很短的时间内完成一些工作。但是，没有很多经验，他们依赖默认值和最短路径解决方案（阅读：不要在不需要时隐藏滚动条，不要使用常用的工具栏成语，不要' t 正确对齐小部件等）。

不幸的是，Tk 的默认设置并不总是最漂亮的。正如问题中的屏幕截图所示，默认使用相对较粗的边框宽度和次优字体，并且复选框确实直接来自 80 年代。但是，在专家手中，所有这些问题都是可以在空闲时间处理的小问题。

例如，经过五分钟的调整，原始屏幕截图可能如下所示：

[![略微改进的用户界面](https://i.stack.imgur.com/md7eD.png)](https://i.stack.imgur.com/md7eD.png)

当然，这看起来仍然有点笨拙，但可以说它比原来的要好很多。有一个小时专门用于这项任务，可以进行更多改进。

使用 tk 8.5（实际上是几年前）支持主题和原生小部件，甚至 X11 版本也进行了小幅改进。不过，Tk 仍然落后于眼睛糖果的曲线，如果设计需要渐变、动画等，它会迫使人们“自己动手”。

然而，对于大多数类型的应用程序，Tcl 和 Tk 仍然是一个很好的实用解决方案。如果您试图与 Flash 应用程序竞争，您将失败。但是，如果您的工业应用程序只需要工作和可用并且可能是多平台的，那么 Tk 仍然是最好的选择之一。

* * *

截至 2015 年，有一篇关于现代化 Tkinter 的 IDLE IDE 的精彩文章。这篇文章描述了一些使 IDLE 看起来更现代的步骤：

*   [http://www.tkdocs.com/tutorial/idle.html](http://www.tkdocs.com/tutorial/idle.html)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-12-08T12:56:50.417

事实上，“它只是不同”的论点是我的主要原因。Tk GUI 的外观和行为不像本机应用程序，这会以多种小方式影响“外观和感觉”，与给定系统上的本机应用程序相比，这会使复杂的应用程序感觉怪异和笨拙。

文件对话框可能是我所写内容的一个完美示例：它们可能不会比某些系统上的本机对话框“更糟”或“更好”，但它们是不同的，它们的行为与系统上的所有其他应用程序不同。

如果您是 MacOS X 用户，您可以通过比较原生 Mac 应用程序与在 Mac 上运行的具有 X11 兼容层（如 Gimp 或 Inkscape）的应用程序来感受它。它们与所有其他应用程序的行为不同（顶部栏中没有菜单，cmd+tab 的工作方式略有不同，cmd+backtick 的工作方式大不相同），所以 - 虽然它们在 Linux X11 桌面上的行为很好 - 同样的行为在 Linux X11 桌面上感觉很奇怪和笨拙苹果电脑。

Tk 的缺点是这些 GUI 实际上并不是任何地方的原生。

对于可移植的 UI，我可能会推荐 wxWidgets，它只是系统提供的任何原生 UI 的通用 API 层（外观）。对于您当前的情况，这可能有点离题，但无论如何它可能值得一看。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-12-08T13:05:44.237

与过去相比，TK 对原生外观 GUI 的支持要好得多。早期版本的 Tk 具有类似主题的外观和感觉，旨在与基于主题的桌面环境（如 MWM 和 CDE）一起使用。在这种环境下，它看起来像一个原生应用程序。长期以来，Motif 被用作 X11 应用程序的默认 GUI 工具包。GTK 和（在某种程度上）QT 的出现意味着许多此类应用程序不再是这种情况。

大多数现代跨平台 GUI 工具包——GTK、QT Tk、WXWidgets 等——现在都有一些机制来使用底层的原生小部件。WX 从一开始就是为此而设计的——X11 上的 GTK 和 Motif 版本，Windows 上的 Win32 和（IIRC）OSX 版本。GTK 有一个主题引擎并使用基于本机小部件的主题。QT 模拟了外观和感觉，Tk 有一个本地工具包的包装器。

具有原生外观和感觉的 TK 应用程序示例：

1.  SnackAmp（Vista 上的 Win32）

![Windows Vista 上的 SnackAmp Tk GUI](https://i.stack.imgur.com/GkVK8.png)

2.  Linux 上的 PostgreSQL 访问

![具有原生外观的 Tk API](https://i.stack.imgur.com/dRN9X.jpg)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-12-08T13:07:20.660

因为它的外观是由既不是 UX 也不是图形设计师而是程序员的人设计的。也许它解决了这个问题（在多个平台上拥有相同的 UI），但它看起来很难看。

补充：实际上，让 UI 达到不被认为丑陋的程度是一门艺术。我的团队中有两个极端。一个人只是不关心 UI：他看到一个按钮，不管它在屏幕上如何绘制，它都是一个按钮；即使您在鲜红色的背景上将它“使我的眼睛睁大”的石灰绿色，他仍然会认为它是一个按钮，因为它“像按钮一样嘎嘎作响”。另一个团队成员就是要让 UI 变得“酷”。但他完全忽略了这一点，即 Office 2007 不仅仅是闪亮的外观使“Office 2007”成为“Office 2007”，还包括图标、控件之间的一致性、与它们交互的方式——所有这些看起来与感觉的小细节。结果？猪身上的口红。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-12-08T13:14:02.393

只是一个例子：如果你看一下你提供的例子，你会看到很多额外的行——滚动条有几行，然后文本持有者的矩形有几行，所以在边框上发生了很多事情。

对于程序员来说，我们从逻辑上看可能没有错，从逻辑上讲，每个元素都有自己的边界。但对于其他人来说，它看起来超负荷了。

这是一个视觉设计问题，而不是编程问题。这更像是“为什么 iPod 好而 Zune 丑”之类的东西——你无法得到一个直接可衡量的答案，但大多数人仍然会同意，如果你关心他们，这是你需要做些什么的事实意见 - 即，卖给他们。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-12-08T13:03:05.520

很难对这样的问题保持客观​​，我认为这在本质上是非常主观的。

有几点似乎让我感到不安：

*   滚动条无处不在，而不仅仅是在需要的地方
*   相当“胖”的滚动条，占用大量空间
*   大量粗体字体，例如在菜单标题等
*   某些地方的等宽（“打字机风格”）文本

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-12-09T03:23:07.657

似乎这个讨论至少应该提到这些链接：

[http://wiki.tcl.tk/8646](http://wiki.tcl.tk/8646) [http://wiki.tcl.tk/9485](http://wiki.tcl.tk/9485)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-16T11:28:15.533

Tk 是否漂亮，这取决于人，但我会说它至少不丑（除了 android）。看看我使用纯 python 和 tkinter (Tk) 制作的程序的屏幕截图。你只需要知道如何以更漂亮的方式使用它。![在此处输入图像描述](https://i.stack.imgur.com/inPgJ.png)![在此处输入图像描述](https://i.stack.imgur.com/hWbTR.png)

# .net - 如何将注册表中的 REG_BINARY 值转换为字符串？(vb.net)

> ID：349410
> 
> 赞同：2
> 
> 时间：2008-12-08T12:45:26.993
> 
> 标签：.net, vb.net, binary, registry, string-conversion

我有一个注册表值，它存储为二进制值 (REG_BINARY)，其中包含有关文件路径的信息。该值被读出到一个字节数组中。但是我怎样才能把它变成一个可读的字符串呢？

我已阅读有关 system.text.encoding.ASCII.GetString(value) 的信息，但这不起作用。据我所知，注册表值是任意二进制数据而不是 ASCII，这是该方法产生无用数据的原因。

有人知道我如何转换数据吗？

样本：（参赛作品的一部分）

```
01 00 00 00 94 00 00 00 14 00 00 00 63 00 3A 00 5C 00 
70 00 72 00 6F 00 67 00 72 00 61 00 6D 00 6d 00 65 00 
5C 00 67 00 65 00 6D 00 65 00 69 00 6E 00 73 00 61 00 
6D 00 65 00 20 00 64 00 61 00 74 00 65 00 69 00 65 00 
6E 00 5C 
```

由于注册表编辑器，这应该是：

```
............c.:.\.p.r.o.g.r.a.m.m.e.\.g.e.m.e.i.n.s.a.m.e. .d.a.t.e.i.e.n.\ 
```

该条目本身是从 Outlook 创建的。这是一个禁用插件项目（弹性）的条目

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-08T12:52:46.913

好吧，它不是*任意*的二进制数据——它是某种编码的文本*数据*。您需要找出编码是什么。

如果工作，我不会感到惊讶`Encoding.Unicode.GetString(value)`- 但如果没有，请发布一个样本（十六进制），我会看看我能做什么。将数据放入其中的文件说明了什么？

编辑：看起来 Encoding.Unicode 是你的朋友，但从字节 12 开始。使用

```
Encoding.Unicode.GetString(bytes, 12, bytes.Length-12) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-01T05:55:27.243

我也有这个问题，我用这种方式解决了：

我已将变量声明为：

```
Dim encoding As System.Text.Encoding = System.Text.Encoding.Unicode 
```

然后我循环执行此操作：

```
 For Each Val As String In ValueName
        data = k.GetValue(Val)
        ListRecent.Items.Add(Val & ": " & encoding.GetString(data))
    Next 
```

所以在名为“ListRecent”的列表框中，我获得了最近的完整列表

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T13:04:50.243

采用

```
Function Microsoft.Win32.RegistryKey.GetValue(name as String) as Object 
```

也看看`System.Text.Encoding`和`System.Text.Encoding.Unicode`

# java - 调用方法与 class.method

> ID：349442
> 
> 赞同：1
> 
> 时间：2008-12-08T12:55:50.777
> 
> 标签：java, coding-style

我有一个类，其中定义了两个方法。

```
public class Routines {

     public static method1() {
      /* set of statements */
     }

     public static method2() {
      /* another set of statements.*/
     }
} 
```

现在我需要从 method2() 调用 method1()

以下哪种方法更好？或者这是否有资格作为一个问题？

```
public static method2() {

        method1();

} 
```

或者

```
public static method2() {

        Routines.method1();

} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-08T14:01:16.120

虽然我同意现有的答案，即这主要是一个样式问题，但 Eclipse 和 IntelliJ 的代码批评者都会在不使用该`Classname.method()`样式的代码中标记“对静态方法的非静态引用”，这已经足够了。

通过使用类名来限定对静态目标的引用、限定对实例目标的引用以及本地引用的裸名，我养成了强调*意图的习惯。*`this`现代 IDE 将为这些结构使用不同的突出显示，所以我认为这些天它不那么重要了。我喜欢维护者（通常是我自己）*知道*它的意图，是的，我知道这是一个`static`参考。

是的，它确实使代码更加冗长，但我认为额外的字符是值得的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-08T13:12:24.550

我会用第一种方法。在我看来，它相当于：

```
public void method2()
{
    method1();
} 
```

和：

```
public void method2()
{
    this.method1();
} 
```

我不知道有多少人在调用类中的另一个方法时显式调用**它。**所以我个人的口味是选项 1 - 无需明确调用 ClassName 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-08T13:04:22.633

好吧，它有资格作为一个问题，但显然结果将是相同的任何一种方式，所以这只是一个风格问题。（可能有一些奇怪的过载情况*可能会*产生影响，但你应该从一开始就避免这些情况。如果你愿意，我可以举出例子，但这可能不值得。）

如果您觉得特别需要强调它是一种静态方法，请随意制作它`Routines.method1()`- 但通常我会将其保留为`method1()`.

编辑：我试图想出一个例子，它使用重载有区别`params`：

```
void CallMethod()
{
    Console.WriteLine("Calling Method()");
    Method();
    Console.WriteLine("Calling Test.Method()");
    Test.Method();
}

void Method(params string[] ignored)
{
    Console.WriteLine ("  Instance method called");
}

static void Method()
{
    Console.WriteLine ("  Static method called");
} 
```

不过，这在这两种情况下都会调用静态方法。（有趣的是，将`params`静态方法放在使用 MS C# 编译器时会给出一个稍微令人困惑的错误消息，并完全破坏 Mono 编译器 - 至少是我正在使用的版本。）

使用参数，您可能会遇到使用泛型类型参数和类型推断的奇怪情况，但如果没有任何参数，情况并非如此。即便如此，非通用形式将优先。

简而言之，我认为我毕竟做不到:(

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-08T13:09:02.450

这纯粹是一个风格问题，所以这取决于你的品味。

我更喜欢第一个版本。由于这两种方法在同一个类中，我觉得重复类名没有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-08T14:13:32.463

我愿意

```
public static method2() {
        Routines.method1();
} 
```

没有猜测。如果我从父类调用静态方法，这很清楚。出于同样的原因，我不喜欢静态导入。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T14:22:48.090

这只是个人喜好和代码可读性的问题，但是只调用“method1()”并不等同于“this.method”，因为示例中的两个方法都是静态的，不能调用尚未实例化的对象. 使用静态方法是无法预见的，如果在调用方法的那一刻有实例化对象，则不能使用“this”。如果实例化，“this”只是指向已执行对象的指针。

要回答这个问题：

只写“method1()”而不是“Routines.method1()”是完整的语法糖。计算机正在执行/调用的结果，即编译器从代码中生成的结果，是完全一样的。

# java - java或c ++中的邻接矩阵来查找连接的节点

> ID：349446
> 
> 赞同：2
> 
> 时间：2008-12-08T12:56:11.977
> 
> 标签：java, c++, graph-theory

我遇到了一个问题，我在图中给出了 N 个节点，这些节点相互连接，然后给出一个矩阵，其中列出了一个节点连接到另一个节点（如果是，则为 1，如果不是，则为 0）。我想知道如何最好地解决这个问题。我认为这些是邻接矩阵？但是我将如何实现...

基本上，我试图摆脱这些的是找出特定节点是否连接到给定集合“S”中的所有其他节点。以及所选项目是否为集团...

我会很感激任何提示。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-08T13:07:37.073

您可以使用二维布尔数组来实现这一点。因此，如果节点 i 连接到节点 j，则 myarray[i][j] 将为真。如果您的边缘不是定向的，那么 myarray[j][i] 将在 myarray[i][j] 为真时为真。

这也可以通过使用整数（或其他数字类型）而不是布尔值作为数组元素来扩展到加权边。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-08T14:04:15.150

最简单的方法是使用方阵（2d 数组），使用布尔值来显示连接的存在或不存在，或者使用整数来表示遍历的成本。然而，对于稀疏图，您可以通过使用锯齿状数组然后存储与第一个节点相邻的节点来获得更好的压缩。在 Java 中，我可能会通过设置一个`List<List<Integer>>`外部列表对应于所讨论的节点而内部列表是与该节点相邻的所有节点来做到这一点。

假设您决定使用标准（未压缩）矩阵，您可以通过遍历列表然后查找 A[i][j] 来确定节点 i 是否与列表中的每个节点 j 相邻。如果其中任何一个是`false`，则它不与列表中的每个项目相邻，否则为真。对于派系，您只需对列表中的每个项目执行此操作（放弃 i=j 的情况并为无向图进行一些优化）。

一个例子（同样在 Java 中）

```
public boolean isClique(boolean[][] A, List<Integer> nodes){
  for(int i : nodes){
    for(int j : nodes){
      if(i != j){
        if(!A[i][j]) return false;
      }
    }
  }
  return true;
} 
```

Max-Clique 问题的优化和解决方案留给读者作为练习。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-07T17:13:00.070

试试这个：

```
public class AdjacencyMatrix {

private String [] nodes;

private int [][] matrix;

public AdjacencyMatrix(String [] nodes,int [][] matrix){
    this.nodes = nodes;
    this.matrix = matrix;
}

boolean isSymmetric(){
    boolean sym = true;
     for(int i=0;i<matrix.length;i++){
         for(int j=i+1; j < matrix[0].length ; j++){
             if (matrix[i][j] != matrix[j][i]){
                 sym = false;
                 break;
             }
         }
     }
     return sym;
}

public Graph createGraph(){
    Graph graph = new Graph();
     Node[] NODES = new Node[nodes.length];

    for (int i=0; i<nodes.length; i++){
        NODES[i] =  new Node(nodes[i]);
        graph.addNode(NODES[i]);
    }

    for(int i=0;i<matrix.length;i++){            
         for(int j=i;j<matrix[0].length;j++){
             int distance = matrix[i][j];
             if (distance != 0){                     
                 graph.addEdge(new Edge(NODES[i], NODES[j], distance));
             } 
         }
    }

    return graph;
}

public long pathLength(int[] path){
    long sum = 0;
    for (int i=0; i<path.length - 1; i++){
        if (matrix[path[i]][path[i+1]] != 0)
            sum += matrix[path[i]][path[i+1]];
        else {
            sum = 0;
            break;
        }
    }

    return sum;
}

public static void main(String[] args){
    String[] nodes = {"A", "B", "C", "D", "E"};
    int [][] matrix= {  {0, 2, 2, 1, 0}, 
                        {2, 0, 1, 0, 0}, 
                        {2, 1, 0, 0, 1}, 
                        {1, 0, 0, 0, 4}, 
                        {0, 0, 1, 4, 7}};
    AdjacencyMatrix am = new AdjacencyMatrix(nodes, matrix);
    Graph graph  = am.createGraph();
    int[] a = {0, 2, 4, 4, 3, 0};
    int[] b = {0, 1, 2, 4, 4, 3, 0};
    graph.writeGraph(); 
    am.pathLength(a);
    am.pathLength(b);
}

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T13:05:57.183

提示：所以你有你的邻接矩阵`M`，它告诉你两个节点是否直接连接。那么 M^2 给了你什么？它告诉您两个节点之间是否存在长度为 2 的路径。

我让你想象什么是 M^3,... , M^inf （当你到达固定点时）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-08T14:43:32.107

使用您的邻接矩阵，应用[Floyd-Warshall 算法](http://en.wikipedia.org/wiki/Floyd-Warshall_algorithm)将为您提供节点之间的所有路径。然后你可以检查特定的集合。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T19:28:18.053

您可能想使用[bitset](http://www.sgi.com/tech/stl/bitset.html)或[bit_vector](http://www.sgi.com/tech/stl/bit_vector.html)代替 bool[][]。

如果您不使用锯齿状数组，并且您的连接是对称的，请考虑使用基于 MIN() 和 MAX() [宏] 的访问器进行包装。在两个地方存储相同的数据是一个痛苦的秘诀。最终，array[i][j] != array[j][i]。

```
E.g: getValue( int i, int j ) { return array [ MIN(i,j) ] [ MAX(i,j) ] } 
```

# unit-testing - Moq-ing 类或接口有什么区别？

> ID：349452
> 
> 赞同：18
> 
> 时间：2008-12-08T12:56:58.590
> 
> 标签：unit-testing, class, mocking, interface, moq

我一直在使用[moq](http://code.google.com/p/moq/)在我的单元测试中模拟对象，并且我在网站上看到关于 moq 的信息，它能够模拟类和接口。

前几天我和我的一个同事讨论过，他们说没有理由模拟类，我应该只模拟接口。

我对此并没有真正的答案....而且我似乎也无法在起订量网站上找到任何答案。

一个人永远不应该模拟课程，这是真的吗？我会说不，因为如果这是真的，那么 Moq 甚至都不会允许它......那么有没有时候在接口上模拟一个类更好？模拟类与模拟接口有什么区别？或者它真的只是一种偏好？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-11T12:13:19.083

模拟一个类是完全有效的。但是，使用 MoQ，您只能模拟类上的虚拟方法和属性。

当您有抽象基类而不是接口，或者具有默认实现和虚拟作为扩展点的类时，它很有用。在很多情况下，您无法访问需要模拟的类的源代码。.Net 框架中有很多示例，例如 MembershipProvider。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T13:05:24.953

如果该类没有实现接口或者如果模拟框架允许部分模拟，那么您将希望能够模拟该类。在前一种情况下，因为没有接口可以模拟。在后者中，您可以从您不想模拟的类中继承现有行为。

但是，通常情况下，您希望您的类在可用时依赖于接口。在这种情况下，您不需要模拟实现接口的类。您应该只模拟接口本身，以避免测试中的任何依赖项在被测类中不存在。

# sql - 如何在 MySQL 选择中使用 XPATH？

> ID：349459
> 
> 赞同：5
> 
> 时间：2008-12-08T12:58:00.633
> 
> 标签：sql, mysql, xpath

假设我有一个名为“xml”的表，它将 XML 文件存储在单列“数据”中。我将如何编写运行 XPath 并仅返回与该 XPath 匹配的行的 MySQL 查询？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-08T17:04:35.470

```
SELECT * FROM xml
WHERE EXTRACTVALUE(data, '<xpath-expr>') != ''; 
```

但是，您应该注意，MySQL 对 XPath 的支持是有限制的。

*   `EXTRACTVALUE()`仅返回 CDATA。
*   并非所有 XPath 结构都受支持。abatishchev 的回答中提到的文档[页面](http://dev.mysql.com/doc/refman/5.1/en/xml-functions.html#function_extractvalue)上“XPath 限制”标题下的详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T17:21:28.293

我刚从一位同事那里得到答案，似乎修剪 xml 经常有帮助：

```
select * from xml where 
   trim(both '\r\n' from ExtractValue(xml, '/some/xpath')) = 'value'; 
```

# sql - SQL语句问题

> ID：349460
> 
> 赞同：2
> 
> 时间：2008-12-08T12:58:10.040
> 
> 标签：sql, dataset

我有这个代码：

```
SELECT    idcallhistory3, callid, starttime, answertime, endtime, duration,
          is_answ, is_fail, is_compl, is_fromoutside, mediatype, from_no,
          to_no, callerid, dialednumber, lastcallerid, lastdialednumber,
          group_no, line_no
FROM      "public".callhistory3
WHERE     (starttime >= ?) AND (endtime <= ?) AND (is_fromoutside = ?) 
          AND (from_no = ?) AND (to_no = ?) 
```

问题是我需要传递一个值吗？并在没有过滤器的情况下获得所有结果，例如 *

有什么帮助吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-08T13:03:55.113

```
WHERE 
  (@start is null OR starttime >= @start) AND 
  (@end is null OR endtime <= @end) AND 
  (@fromOutside is null OR is_fromoutside = @fromOutside) AND 
  (@fromNo is null OR from_no = @fromNo) AND 
  (@toNo is null OR to_no = @toNo) 
```

为所有参数传递空值（当 sql 空值；感谢 GC）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-08T14:42:00.050

我喜欢 COALESCE。

您只需要注意左侧的空值，如果左侧可以有空值，您可以执行类似于最后一行的操作，以便空值匹配。通常有这样的事情，但你会想确保你的查询仍然执行正常。

```
SELECT    idcallhistory3, callid, starttime, answertime, endtime, duration,
          is_answ, is_fail, is_compl, is_fromoutside, mediatype, from_no,
          to_no, callerid, dialednumber, lastcallerid, lastdialednumber,
          group_no, line_no
FROM      "public".callhistory3
WHERE     (starttime >= COALESCE(@starttime, starttime )) 
          AND (endtime <= COALESCE(@endtime, endtime)) 
          AND (is_fromoutside = COALESCE(@is_fromoutside, is_fromoutside)) 
          AND (from_no = COALESCE(@from_no, from_no)) 
          AND (COALESCE(to_no, -1) = COALESCE(@to_no, to_no, -1)) -- make nulls match 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-08T13:17:43.260

对于具有多个可选部分的复杂查询，您可能会发现创建适合的 SQL 会更好。您可以在调用方（例如，在 C# 中）或在数据库中（至少使用 SQL Server）执行此操作 - 但无论哪种方式，您都*必须*确保它保持参数化。在调用者完成工作的情况下，只需为命令添加合适的参数即可。如果数据库正在生成 TSQL，则该方法取决于 RDBMS。使用 SQL-Server，`sp_ExecuteSql`是您的朋友 - 即您可以`@cmd`根据查询构建一个变量，然后：

```
EXEC sp_ExecuteSQL @cmd, N'@someArg int', @actualArg 
```

`@someArg`里面的声明在哪里`@cmd`，`@actualArg`是在执行时传入的值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-08T13:01:59.500

这样做的典型方法是：

```
WHERE (? IS NULL OR starttime >= ?) 
```

然后传入 DBNull.Value。显然，您需要为每个希望能够像这样“通配符”的参数执行此操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-08T13:05:09.730

有条件地添加“Where”语句——仅当您需要过滤结果时

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T15:09:28.997

我同意贾马尔汉森的观点。COALESCE 是迄今为止性能最好的方法，至少在 SQL Server 上是这样

# video - 是否有与 ASF View 等效的 MP4 文件？

> ID：349480
> 
> 赞同：2
> 
> 时间：2008-12-08T13:03:20.730
> 
> 标签：video, encoding, transcoding

我正在开发我们的编码软件，遇到了一个奇怪的问题，即在某些播放器中以 4:3 的比例播放 16:9 纵横比的文件，从 WMV 转码为 MP4。使用 ASF 视图，我可以看到源 WMV 文件在其 BITMAPINFOHEADER 结构中似乎有不正确的数据（它报告有 4:3 尺寸，但实际上是 16:9），但是是否有用于 MP4 文件的等效工具，所以我可以检查这个问题是否已经传递到转码文件中？

我想读取嵌入在流中的元数据，而不是使用使用 DirectShow/FFmpeg/other 呈现它的工具，因为这些似乎会进行一些修改并报告正确的纵横比。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T10:40:19.070

环顾四周后，我发现 MP4Box 可用于使用`-info`开关检索此信息，例如

```
mp4box.exe -info filename.mp4 
```

如果有人感兴趣，那么问题在于原始 WMV 流设置了`AspectRatioX`和`AspectRatioY`元数据属性，因此视频具有非方形像素。这种非方形元数据被传递到 MP4 文件，因此它应该可以正确播放（并且在 Windows Media Player 中播放），但是 Flash 似乎忽略了这个元数据属性并使用方形像素播放它。

# silverlight-2.0 - 如何在 Silverlight 2 中引用嵌入式资源

> ID：349489
> 
> 赞同：2
> 
> 时间：2008-12-08T13:05:10.883
> 
> 标签：silverlight-2.0, embedded-resource

我有以下带有图像作为模板的简单按钮。问题是我想将图像更改为资源，而不是内容引用。我想这样做，以便可以将 DLL 共享为可重用的库，但这样做时效果不佳。

如何告诉 Image 对象以声明方式使用嵌入式资源？

```
<Button x:Name="LogoutButton" Click="Button_Click">
  <Button.Template>
    <ControlTemplate>
      <Image Source="Resources/logout.png" />
    </ControlTemplate>
  </Button.Template>
</Button> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T13:19:03.273

好的，我想通了：

1.  不要让它成为嵌入式资源。使其成为资源/请勿复制

这就是它的全部。像引用内容路径一样引用它，它可以工作。

# asp.net - ASP.net 会话状态服务信息

> ID：349503
> 
> 赞同：6
> 
> 时间：2008-12-08T13:07:40.707
> 
> 标签：asp.net, service, state

您在哪里可以获得有关 ASP.NET 状态服务的信息，例如它的工作原理、性能、行为特征等。在 Internet 上查看过，但无法找到深入的信息或专门针对该主题的文章。谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-08T13:57:28.703

*   [ASP.NET 会话状态：架构和性能注意事项（博客文章）](http://blogs.msdn.com/tims/archive/2003/11/21/57453.aspx)
*   [ASP.NET 会话状态 (MSDN)](http://msdn.microsoft.com/en-us/library/ms972429.aspx)
*   [提高 .NET 应用程序性能和可扩展性 (MSDN)](http://msdn.microsoft.com/en-us/library/ms998530.aspx)
*   [会话状态 (MSDN)](http://msdn.microsoft.com/en-us/library/87069683(vs.71).aspx)

哪个可能对你有用，也可能没用..

简而言之，它是这样工作的：

**InProc 会话状态**是最快的，但它也是进程内的，这意味着它不共享（阅读“*对网络农场没有好处*”），并且在进程崩溃时丢失。

**状态服务 (aspnet_state.exe)**仍然非常快，但由于工作进程和服务本身之间的编组，存在一些开销。可能很好，因为 IP 地址可以在配置中传递，这意味着**它可以在自己的机器上运行**。它也是工作进程的进程外，这意味着它可以在进程崩溃后幸存下来。由于它可以在单台机器上运行，因此可以共享状态，前提是所有客户端都使用同一台机器。

**Sql Server**（或其他自定义提供程序） - 往往（并非总是）是所有这些中最慢的，尤其是由于可能有更多的磁盘 I/O。然而，这也是更强大的解决方案之一，因为状态可以持久化到磁盘，这意味着它不仅可以在 Web 服务器上的进程崩溃中幸存下来，而且它可以在服务器崩溃本身中幸存下来（一旦数据库重新上线，状态恢复）。再加上集群，这可以提供一个坚如磐石的会话系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T13:14:38.663

以编程方式，会话状态只不过是字典或哈希表形式的内存，例如键值对，可以在用户会话期间设置和读取。

检查以下链接以获取更多详细信息：

[http://msdn.microsoft.com/en-us/library/ms972429.aspx](http://msdn.microsoft.com/en-us/library/ms972429.aspx)

[http://msdn.microsoft.com/en-us/library/ms178581(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms178581(VS.80).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T13:40:49.937

考虑阅读一本书：“C# 2008 中的 Pro ASP.NET 3.5”或“VB.net 2008 中的 Pro ASP.NET 3.5”。

# c# - 使用 Parallel.For 测试 SQL 查询并与 ThreadPool 进行比较

> ID：349513
> 
> 赞同：1
> 
> 时间：2008-12-08T13:12:43.613
> 
> 标签：c#, multithreading, performance, parallel-processing, threadpool

我正在寻找一种方法来轻松加载测试和基准测试我们的一些 SQL（使用 ADO.NET，使用 LINQ 或 PLINQ 没什么特别的），在高并行负载下运行时必须具有高性能。

我曾考虑使用新的并行扩展 CTP，特别是`Parallel.For`/`Parallel.ForEach`简单地运行 SQL 超过 10k 次迭代左右 - 但我无法找到任何关于这些优化的数据。

本质上，我担心因为数据库访问本质上是 I/O 绑定的，所以它不会产生足够的负载。有谁知道并行。如果它正在执行的任务不完全受 CPU 限制，是否足够智能以使用 > x 个线程（其中 x = CPU 数）？即它的行为方式与托管线程池类似吗？

如果是这样就更酷了！

**编辑：正如@CVertex 在下面提到的，您可以独立设置线程数。有谁知道默认情况下并行库是否足够智能以在作业受 I/O 绑定时继续添加线程？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T13:42:29.700

当然可以！

您可以指定所需的每个 CPU 的最大线程数。

在你 Parallel.For 无论你在做什么之前，你必须从 System.Threading.Tasks 命名空间中实例化你自己的 TaskManager。查看 ctor 参数以了解如何根据自己的目的自定义任务管理器。

Parallel.For 应该有一个重载，它需要一个任务管理器实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T13:55:39.487

另一种方法是定义 PLINQ_DOP 环境变量。从文档：

```
PLINQ_DOP
DOP stands for degree of parallelism. Setting this environment variable defines the number of threads for PLINQ to use. 
E.g. PLINQ_DOP=1 means single-threaded, while PLINQ_DOP=8 means PLINQ should use 8 threads. 
If this is set to a value greater than the number of procs*cores available on the system, 
PLINQ will use more threads than processors. If one of them blocks, for instance, 
this allows other threads to make forward progress. 
```

# c# - 内置帮助器将 User.Identity.Name 解析为 Domain\Username

> ID：349520
> 
> 赞同：47
> 
> 时间：2008-12-08T13:14:37.340
> 
> 标签：c#, asp.net, .net, authentication, active-directory

是否有任何内置实用程序或帮助程序来解析`HttpContext.Current.User.Identity.Name`，例如`domain\user`如果存在和用户分别获取域名？

或者还有其他班级可以这样做吗？

我知道这很容易打电话`String.Split("\")`但很有趣

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-12-08T16:53:33.857

这更好（*更易于使用，没有机会`NullReferenceExcpetion`并且符合关于平等对待空字符串和空字符串的 MS 编码指南*）：

```
public static class Extensions
{
    public static string GetDomain(this IIdentity identity)
    {
        string s = identity.Name;
        int stop = s.IndexOf("\\");
        return (stop > -1) ?  s.Substring(0, stop) : string.Empty;
    }

    public static string GetLogin(this IIdentity identity)
    {
        string s = identity.Name;
        int stop = s.IndexOf("\\");
        return (stop > -1) ? s.Substring(stop + 1, s.Length - stop - 1) : string.Empty;
    }
} 
```

用法：

```
IIdentity id = HttpContext.Current.User.Identity;
id.GetLogin();
id.GetDomain(); 
```

这需要 C# 3.0 编译器（或更新版本），并且不需要 3.0 .Net 在编译后工作。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-06-08T21:19:40.073

`System.Environment.UserDomainName`只给你域名

同样，`System.Environment.UserName`只为您提供用户名

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-27T16:30:52.617

```
var components = User.Identity.Name.Split('\\');

var userName = components.Last() 

var domainName = components.Reverse().Skip(1).FirstOrDefault() 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-02-01T22:06:14.110

你们也可以考虑解析像“user@company.com”或“user@domain”这样的字符串输入。

这就是我目前正在做的事情：
如果字符串包含'\'然后在'\'处拆分字符串并提取用户名和域
否则如果字符串包含'@'然后在'@'处拆分字符串并提取用户名和域
否则将字符串视为没有域的用户名

在输入字符串不是易于预测的格式（即“域\用户@域”）的情况下，我仍在寻找更好的解决方案。我在想正则表达式...

更新：我的立场得到纠正。我的回答有点脱离上下文，它指的是从用户输入中解析用户名和域的一般情况，例如在用户登录/登录提示中。希望它仍然可以帮助某人。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-08T14:09:27.430

我也认为不，因为前几天我问了自己同样的问题：D

你可以试试：

```
public static string GetDomain(string s)
{
    int stop = s.IndexOf("\\");
    return (stop > -1) ? s.Substring(0, stop + 1) : null;
}

public static string GetLogin(string s)
{
    int stop = s.IndexOf("\\");
    return (stop > -1) ? s.Substring(stop + 1, s.Length - stop - 1) : null;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-08T13:27:24.147

我不这么认为，因为 System.Security.Principal.WindowsIdentity 不包含此类成员。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-04-03T11:16:52.923

虽然不是 .NET 内置的，但始终可以 P/Invoke 到[CredUIParseUserName](http://msdn.microsoft.com/en-us/library/windows/desktop/aa375175%28v=vs.85%29.aspx)。[下面](http://www.pinvoke.net/default.aspx/credui.creduiparseusername)是一个如何在 .NET 中使用它的示例。

PS：它似乎没有处理“.\username”中的“点”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-01T12:14:27.977

似乎是通过正则表达式解决的问题：

```
public static class UserExtensions
{
    public static string GetDomain(this IIdentity identity)
    {
        Regex.Match(identity.Name, ".*\\\\").ToString()
    }

    public static string GetLogin(this IIdentity identity)
    {
        return Regex.Replace(identity.Name, ".*\\\\", "");
    }
} 
```

# sql-server - SQL Server 历史表 - 通过 SP 或触发器填充？

> ID：349524
> 
> 赞同：24
> 
> 时间：2008-12-08T13:15:39.943
> 
> 标签：sql-server, stored-procedures, triggers

在我的应用程序的 SQL Server 后端中，我想为我的一组关键表创建历史表，这将跟踪行更改的历史记录。

我的整个应用程序使用存储过程，没有嵌入式 SQL。修改这些表的唯一数据库连接将是通过应用程序和 SP 接口。传统上，我合作过的商店使用触发器执行此任务。

如果我可以在存储过程和触发器之间进行选择，哪个更好？哪个更快？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-12-12T18:44:59.797

触发器。

我们编写了一个 GUI（内部称为*Red Matrix Reloaded*）以允许轻松创建/管理审计日志记录触发器。

这是使用的一些 DDL：

* * *

## 审计日志表

```
CREATE TABLE [AuditLog] (
    [AuditLogID] [int] IDENTITY (1, 1) NOT NULL ,
    [ChangeDate] [datetime] NOT NULL CONSTRAINT [DF_AuditLog_ChangeDate] DEFAULT (getdate()),
    [RowGUID] [uniqueidentifier] NOT NULL ,
    [ChangeType] [varchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
    [TableName] [varchar] (128) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
    [FieldName] [varchar] (128) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
    [OldValue] [varchar] (8000) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
    [NewValue] [varchar] (8000) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
    [Username] [varchar] (128) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
    [Hostname] [varchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
    [AppName] [varchar] (128) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
    [UserGUID] [uniqueidentifier] NULL ,
    [TagGUID] [uniqueidentifier] NULL ,
    [Tag] [varchar] (8000) COLLATE SQL_Latin1_General_CP1_CI_AS NULL 
) 
```

* * *

## 触发器记录插入

```
CREATE TRIGGER LogInsert_Nodes ON dbo.Nodes
FOR INSERT
AS

/* Load the saved context info UserGUID */
DECLARE @SavedUserGUID uniqueidentifier

SELECT @SavedUserGUID = CAST(context_info as uniqueidentifier)
FROM master.dbo.sysprocesses
WHERE spid = @@SPID

DECLARE @NullGUID uniqueidentifier
SELECT @NullGUID = '{00000000-0000-0000-0000-000000000000}'

IF @SavedUserGUID = @NullGUID
BEGIN
    SET @SavedUserGUID = NULL
END

    /*We dont' log individual field changes Old/New because the row is new.
    So we only have one record - INSERTED*/

    INSERT INTO AuditLog(
            ChangeDate, RowGUID, ChangeType, 
            Username, HostName, AppName,
            UserGUID, 
            TableName, FieldName, 
            TagGUID, Tag, 
            OldValue, NewValue)

    SELECT
        getdate(), --ChangeDate
        i.NodeGUID, --RowGUID
        'INSERTED', --ChangeType
        USER_NAME(), HOST_NAME(), APP_NAME(), 
        @SavedUserGUID, --UserGUID
        'Nodes', --TableName
        '', --FieldName
        i.ParentNodeGUID, --TagGUID
        i.Caption, --Tag
        null, --OldValue
        null --NewValue
    FROM Inserted i 
```

* * *

## 触发器记录更新

```
CREATE TRIGGER LogUpdate_Nodes ON dbo.Nodes
FOR UPDATE AS

/* Load the saved context info UserGUID */
DECLARE @SavedUserGUID uniqueidentifier

SELECT @SavedUserGUID = CAST(context_info as uniqueidentifier)
FROM master.dbo.sysprocesses
WHERE spid = @@SPID

DECLARE @NullGUID uniqueidentifier
SELECT @NullGUID = '{00000000-0000-0000-0000-000000000000}'

IF @SavedUserGUID = @NullGUID
BEGIN
    SET @SavedUserGUID = NULL
END

    /* ParentNodeGUID uniqueidentifier */
    IF UPDATE (ParentNodeGUID)
    BEGIN
        INSERT INTO AuditLog(
            ChangeDate, RowGUID, ChangeType, 
            Username, HostName, AppName,
            UserGUID, 
            TableName, FieldName, 
            TagGUID, Tag, 
            OldValue, NewValue)
        SELECT 
            getdate(), --ChangeDate
            i.NodeGUID, --RowGUID
            'UPDATED', --ChangeType
            USER_NAME(), HOST_NAME(), APP_NAME(), 
            @SavedUserGUID, --UserGUID
            'Nodes', --TableName
            'ParentNodeGUID', --FieldName
            i.ParentNodeGUID, --TagGUID
            i.Caption, --Tag
            d.ParentNodeGUID, --OldValue
            i.ParentNodeGUID --NewValue
        FROM Inserted i
            INNER JOIN Deleted d
            ON i.NodeGUID = d.NodeGUID
        WHERE (d.ParentNodeGUID IS NULL AND i.ParentNodeGUID IS NOT NULL)
        OR (d.ParentNodeGUID IS NOT NULL AND i.ParentNodeGUID IS NULL)
        OR (d.ParentNodeGUID <> i.ParentNodeGUID)
    END

    /* Caption varchar(255) */
    IF UPDATE (Caption)
    BEGIN
        INSERT INTO AuditLog(
            ChangeDate, RowGUID, ChangeType, 
            Username, HostName, AppName,
            UserGUID, 
            TableName, FieldName, 
            TagGUID, Tag, 
            OldValue, NewValue)
        SELECT 
            getdate(), --ChangeDate
            i.NodeGUID, --RowGUID
            'UPDATED', --ChangeType
            USER_NAME(), HOST_NAME(), APP_NAME(), 
            @SavedUserGUID, --UserGUID
            'Nodes', --TableName
            'Caption', --FieldName
            i.ParentNodeGUID, --TagGUID
            i.Caption, --Tag
            d.Caption, --OldValue
            i.Caption --NewValue
        FROM Inserted i
            INNER JOIN Deleted d
            ON i.NodeGUID = d.NodeGUID
        WHERE (d.Caption IS NULL AND i.Caption IS NOT NULL)
        OR (d.Caption IS NOT NULL AND i.Caption IS NULL)
        OR (d.Caption <> i.Caption)
    END

...

/* ImageGUID uniqueidentifier */
IF UPDATE (ImageGUID)
BEGIN
    INSERT INTO AuditLog(
        ChangeDate, RowGUID, ChangeType, 
        Username, HostName, AppName,
        UserGUID, 
        TableName, FieldName, 
        TagGUID, Tag, 
        OldValue, NewValue)
    SELECT 
        getdate(), --ChangeDate
        i.NodeGUID, --RowGUID
        'UPDATED', --ChangeType
        USER_NAME(), HOST_NAME(), APP_NAME(), 
        @SavedUserGUID, --UserGUID
        'Nodes', --TableName
        'ImageGUID', --FieldName
        i.ParentNodeGUID, --TagGUID
        i.Caption, --Tag
        (SELECT Caption FROM Nodes WHERE NodeGUID = d.ImageGUID), --OldValue
        (SELECT Caption FROM Nodes WHERE NodeGUID = i.ImageGUID) --New Value
    FROM Inserted i
        INNER JOIN Deleted d
        ON i.NodeGUID = d.NodeGUID
    WHERE (d.ImageGUID IS NULL AND i.ImageGUID IS NOT NULL)
    OR (d.ImageGUID IS NOT NULL AND i.ImageGUID IS NULL)
    OR (d.ImageGUID <> i.ImageGUID)
END 
```

* * *

## 触发器记录删除

```
CREATE TRIGGER LogDelete_Nodes ON dbo.Nodes
FOR DELETE
AS

/* Load the saved context info UserGUID */
DECLARE @SavedUserGUID uniqueidentifier

SELECT @SavedUserGUID = CAST(context_info as uniqueidentifier)
FROM master.dbo.sysprocesses
WHERE spid = @@SPID

DECLARE @NullGUID uniqueidentifier
SELECT @NullGUID = '{00000000-0000-0000-0000-000000000000}'

IF @SavedUserGUID = @NullGUID
BEGIN
    SET @SavedUserGUID = NULL
END

    /*We dont' log individual field changes Old/New because the row is new.
    So we only have one record - DELETED*/

    INSERT INTO AuditLog(
            ChangeDate, RowGUID, ChangeType, 
            Username, HostName, AppName,
            UserGUID, 
            TableName, FieldName, 
            TagGUID, Tag, 
            OldValue,NewValue)

    SELECT
        getdate(), --ChangeDate
        d.NodeGUID, --RowGUID
        'DELETED', --ChangeType
        USER_NAME(), HOST_NAME(), APP_NAME(), 
        @SavedUserGUID, --UserGUID
        'Nodes', --TableName
        '', --FieldName
        d.ParentNodeGUID, --TagGUID
        d.Caption, --Tag
        null, --OldValue
        null --NewValue
    FROM Deleted d 
```

* * *

为了知道软件中的哪个用户进行了更新，每个连接都通过调用存储过程“将自己登录到 SQL Server”：

```
CREATE PROCEDURE dbo.SaveContextUserGUID @UserGUID uniqueidentifier AS

/* Saves the given UserGUID as the session's "Context Information" */
IF @UserGUID IS NULL
BEGIN
    PRINT 'Emptying CONTEXT_INFO because of null @UserGUID'
    DECLARE @BinVar varbinary(128)
    SET @BinVar = CAST( REPLICATE( 0x00, 128 ) AS varbinary(128) )
    SET CONTEXT_INFO @BinVar
    RETURN 0
END

DECLARE @UserGUIDBinary binary(16) --a guid is 16 bytes
SELECT @UserGUIDBinary = CAST(@UserGUID as binary(16))
SET CONTEXT_INFO @UserGUIDBinary

/* To load the guid back 
DECLARE @SavedUserGUID uniqueidentifier

SELECT @SavedUserGUID = CAST(context_info as uniqueidentifier)
FROM master.dbo.sysprocesses
WHERE spid = @@SPID

select @SavedUserGUID AS UserGUID
*/ 
```

* * *

**笔记**

*   Stackoverflow 代码格式删除了大多数空行 - 所以格式化很糟糕
*   我们使用用户表，而不是集成安全性
*   提供此代码是为了方便 - 不允许批评我们的设计选择。纯粹主义者可能会坚持所有的日志记录代码都应该在业务层完成——他们可以来这里为我们编写/维护它。
*   无法使用 SQL Server 中的触发器记录 blob（没有 blob 的“之前”版本 - 只有现有版本）。Text 和 nText 是 blob - 这使得笔记要么无法记录，要么使它们成为 varchar(2000) 的。
*   Tag 列用作标识行的任意文本（例如，如果客户被删除，则标签将在审计日志表中显示“General Motors North America”。
*   TagGUID 用于指向行的“父”。例如，记录**InvoiceLineItems**指向**InvoiceHeader**。这样，任何搜索与特定发票相关的审计日志条目的人都会在审计跟踪中通过行项目的 TagGUID 找到已删除的“行项目”。
*   有时将“OldValue”和“NewValue”值写为子选择 - 以获得有意义的字符串。IE”

    旧值：{233d-ad34234..} 新值：{883-sdf34...}

在审计追踪中不如以下有用：

```
OldValue: Daimler Chrysler
NewValue: Cerberus Capital Management 
```

**最后说明**：随意不要做我们所做的事情。这对我们来说很好，但其他人可以自由地不使用它。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-12-08T13:26:05.710

[在 SQL Server 2008 中，MSDN 上](http://msdn.microsoft.com/en-us/library/bb522489.aspx)称为 CDC（更改数据捕获）的新功能 CDC可以提供帮助。CDC 是一种无需编写触发器或其他机制即可将表数据的更改记录到另一个表中的能力，更改数据捕获记录 SQL Server 中表的插入、更新和删除等更改，从而使更改的详细信息在关系中可用格式。

[第 9 频道视频](http://channel9.msdn.com/posts/ashishjaiman/CDC-Change-Data-Capture-SQL-Server-2008/)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-08-30T09:43:03.720

我们有一个用于生成触发器的第三方工具[ApexSQL Audit 。](http://www.apexsql.com/sql_tools_audit.aspx)

以下是触发器在后台的外观以及数据的存储方式。希望人们会发现这足以对流程进行逆向工程。它与 Ian Boyd 在他的示例中展示的有点不同，因为它允许单独审计每个列。

**表 1 – 保存交易详情（谁、何时、应用程序、主机名等）**

```
CREATE TABLE [dbo].[AUDIT_LOG_TRANSACTIONS](
    [AUDIT_LOG_TRANSACTION_ID] [int] IDENTITY(1,1) NOT NULL,
    [DATABASE] [nvarchar](128) NOT NULL,
    [TABLE_NAME] [nvarchar](261) NOT NULL,
    [TABLE_SCHEMA] [nvarchar](261) NOT NULL,
    [AUDIT_ACTION_ID] [tinyint] NOT NULL,
    [HOST_NAME] [varchar](128) NOT NULL,
    [APP_NAME] [varchar](128) NOT NULL,
    [MODIFIED_BY] [varchar](128) NOT NULL,
    [MODIFIED_DATE] [datetime] NOT NULL,
    [AFFECTED_ROWS] [int] NOT NULL,
    [SYSOBJ_ID]  AS (object_id([TABLE_NAME])),
  PRIMARY KEY CLUSTERED 
  (
       [AUDIT_LOG_TRANSACTION_ID] ASC
  )
) 
```

**表 2 – 保留之前/之后的值。**

```
CREATE TABLE [dbo].[AUDIT_LOG_DATA](
   [AUDIT_LOG_DATA_ID] [int] IDENTITY(1,1) NOT NULL,
   [AUDIT_LOG_TRANSACTION_ID] [int] NOT NULL,
   [PRIMARY_KEY_DATA] [nvarchar](1500) NOT NULL,
   [COL_NAME] [nvarchar](128) NOT NULL,
   [OLD_VALUE_LONG] [ntext] NULL,
   [NEW_VALUE_LONG] [ntext] NULL,
   [NEW_VALUE_BLOB] [image] NULL,
   [NEW_VALUE]  AS (isnull(CONVERT([varchar](8000),      [NEW_VALUE_LONG],0),CONVERT([varchar](8000),CONVERT([varbinary](8000),substring([NEW_VALUE_BLOB],(1),(8000)),0),0))),
   [OLD_VALUE]  AS (CONVERT([varchar](8000),[OLD_VALUE_LONG],0)),
   [PRIMARY_KEY]  AS ([PRIMARY_KEY_DATA]),
   [DATA_TYPE] [char](1) NOT NULL,
   [KEY1] [nvarchar](500) NULL,
   [KEY2] [nvarchar](500) NULL,
   [KEY3] [nvarchar](500) NULL,
   [KEY4] [nvarchar](500) NULL,
PRIMARY KEY CLUSTERED 
 (
    [AUDIT_LOG_DATA_ID] ASC
)
) 
```

**插入触发器**

我没有显示更新触发器，因为它们很长并且与这个具有相同的逻辑。

```
CREATE TRIGGER [dbo].[tr_i_AUDIT_Audited_Table]
ON [dbo].[Audited_Table]
FOR INSERT
NOT FOR REPLICATION
As
BEGIN
DECLARE 
    @IDENTITY_SAVE              varchar(50),
    @AUDIT_LOG_TRANSACTION_ID       Int,
    @PRIM_KEY               nvarchar(4000),
    @ROWS_COUNT             int

SET NOCOUNT ON
Select @ROWS_COUNT=count(*) from inserted
Set @IDENTITY_SAVE = CAST(IsNull(@@IDENTITY,1) AS varchar(50))

INSERT
INTO dbo.AUDIT_LOG_TRANSACTIONS
(
    TABLE_NAME,
    TABLE_SCHEMA,
    AUDIT_ACTION_ID,
    HOST_NAME,
    APP_NAME,
    MODIFIED_BY,
    MODIFIED_DATE,
    AFFECTED_ROWS,
    [DATABASE]
)
values(
    'Audited_Table',
    'dbo',
    2,  --  ACTION ID For INSERT
    CASE 
      WHEN LEN(HOST_NAME()) < 1 THEN ' '
      ELSE HOST_NAME()
    END,
    CASE 
      WHEN LEN(APP_NAME()) < 1 THEN ' '
      ELSE APP_NAME()
    END,
    SUSER_SNAME(),
    GETDATE(),
    @ROWS_COUNT,
    'Database_Name'
)

Set @AUDIT_LOG_TRANSACTION_ID = SCOPE_IDENTITY()    

--This INSERT INTO code is repeated for each columns that is audited. 
--Below are examples for only two columns
INSERT INTO dbo.AUDIT_LOG_DATA
(
    AUDIT_LOG_TRANSACTION_ID,
    PRIMARY_KEY_DATA,
    COL_NAME,
    NEW_VALUE_LONG,
    DATA_TYPE
    , KEY1
)
SELECT
    @AUDIT_LOG_TRANSACTION_ID,
    convert(nvarchar(1500), IsNull('[PK_Column]='+CONVERT(nvarchar(4000), NEW.[PK_Column], 0), '[PK_Column] Is Null')),
    'Column1',
    CONVERT(nvarchar(4000), NEW.[Column1], 0),
    'A'
    , CONVERT(nvarchar(500), CONVERT(nvarchar(4000), NEW.[PK_Column], 0))
FROM inserted NEW
WHERE NEW.[Column1] Is Not Null

 --value is inserted for each column that is selected for auditin
INSERT INTO dbo.AUDIT_LOG_DATA
(
    AUDIT_LOG_TRANSACTION_ID,
    PRIMARY_KEY_DATA,
    COL_NAME,
    NEW_VALUE_LONG,
    DATA_TYPE
    , KEY1
)
SELECT
    @AUDIT_LOG_TRANSACTION_ID,
    convert(nvarchar(1500), IsNull('[PK_Column]='+CONVERT(nvarchar(4000), NEW.[PK_Column], 0), '[PK_Column] Is Null')),
    'Column2',
    CONVERT(nvarchar(4000), NEW.[Column2], 0),
    'A'
    , CONVERT(nvarchar(500), CONVERT(nvarchar(4000), NEW.[PK_Column], 0))
    FROM inserted NEW
    WHERE NEW.[Column2] Is Not Null
End 
```

*免责声明：*我与 Apex 没有任何关系，但我确实在我目前的工作中使用了他们的工具。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-08T14:31:21.007

正如其他人所说，触发器。它们更容易进行单元测试，并且对于直接访问进行随机查询的表的高级用户来说更具弹性。

至于更快？确定数据库中什么是快是一个具有大量变量的难题。如果没有“尝试两种方法并进行比较”，您将不会得到关于哪种方法更快的有用答案。变量包括所涉及的表的大小、正常的更新模式、服务器中磁盘的速度、内存量、用于缓存的内存量等。这个列表是无穷无尽的，每个变量都会影响是否触发比 SP 内的自定义 SQL 更快。

好的。快速地。便宜的。选择两个。触发器在完整性方面很好，在维护方面可能很便宜。可以说他们也很快，因为一旦他们工作，你就完成了他们。SP 是一个维护问题，将东西推入维护可能很快，但绝不是好的或便宜的。

祝你好运。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-12T17:27:21.217

推荐的方法取决于您的要求。如果历史表用于**审计跟踪**，您需要捕获每个操作。如果历史表只是出于**性能**原因，那么计划的 SQL 代理数据传输作业就足够了。

要捕获每个操作，请使用 AFTER TRIGGERs 或 Change Data Capture。

After 触发器为您提供了两个临时表以在触发器内部进行操作：

*   **在 INSERT 或 UPDATE 之后**插入****
***   **删除**后删除**

 **您可以从这些临时表中插入历史记录表，并且您的历史记录表将始终是最新的。您可能希望在历史记录表中添加版本编号、时间戳或两者，以分隔对单个源行的更改。

变更数据捕获 (CDC) 旨在创建一个增量表，您可以将其用作将数据加载到数据仓库（或历史表）的源。与触发器不同，CDC 是异步的，您可以使用任何方法和调度来填充目标（sprocs、SSIS）。

您可以使用 CDC 访问原始数据和更改。[更改跟踪](http://msdn.microsoft.com/en-us/library/cc280462.aspx)(CT) 仅检测更改的行。可以使用 CDC 而不是 CT 构建完整的审计跟踪。[CDC 和 CT](http://msdn.microsoft.com/en-us/library/bb933994.aspx)都仅在 MSSQL 2008 Enterprise 和 Developer Edition 中可用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-08T13:19:28.203

为此使用触发器。这意味着任何更改，无论来源如何，都将反映在历史记录表中。它有利于安全性，对故障模式有弹性，比如人们忘记添加代码来更新历史表等等。

由于执行时间将由 I/O 控制，因此这种类型的操作都不太可能有任何特定的速度差异。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-12T17:39:35.873

需要非常小心的一个问题是确定此表的预期用例，并确保它为此目的正确构建。

具体来说，如果它是针对利益相关者的操作审计跟踪，这与表中记录更改的前后快照有很大不同。（事实上​​，除了调试之外，我很难想象记录更改有什么好的用途。）

审计跟踪通常至少需要用户 ID、时间戳和操作代码——可能还需要一些有关操作的详细信息。示例 - 更改采购订单中行项目的订购数量。

对于这种类型的审计跟踪，您**不想**使用触发器。在 BR 层中嵌入这些事件的生成越高越好。

OTOH，对于记录级别的更改，触发器是正确的匹配。但是从您的 dbms 日志文件中获取它通常也更容易。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-05T13:15:40.900

我更喜欢对审计表使用触发器，因为触发器可以捕获所有更新、插入和删除，而不仅仅是通过某些存储过程调用的更新、插入和删除：

```
CREATE TRIGGER [dbo].[tr_Employee_rev]
ON [dbo].[Employee]
AFTER UPDATE, INSERT, DELETE
AS
BEGIN
    IF EXISTS(SELECT * FROM INSERTED) AND EXISTS (SELECT * FROM DELETED)
    BEGIN
        INSERT INTO [EmployeeRev](EmployeeID,Firstname,Initial,Surname,Birthdate,operation, updated, updatedby) SELECT inserted.ID, inserted.Firstname,inserted.Initial,inserted.Surname,inserted.Birthdate,'u', GetDate(), SYSTEM_USER FROM INSERTED
    END 

    IF EXISTS (SELECT * FROM INSERTED) AND NOT EXISTS(SELECT * FROM DELETED)
    BEGIN
        INSERT INTO [EmployeeRev](EmployeeID,Firstname,Initial,Surname,Birthdate,operation, updated, updatedby) SELECT inserted.ID, inserted.Firstname,inserted.Initial,inserted.Surname,inserted.Birthdate,'i', GetDate(), SYSTEM_USER FROM INSERTED
    END

    IF EXISTS(SELECT * FROM DELETED) AND NOT EXISTS(SELECT * FROM INSERTED)
    BEGIN
        INSERT INTO [EmployeeRev](EmployeeID,Firstname,Initial,Surname,Birthdate,operation, updated, updatedby) SELECT deleted.ID, deleted.Firstname,deleted.Initial,deleted.Surname,deleted.Birthdate,'d', GetDate(), SYSTEM_USER FROM DELETED 
    END
END 
```

我使用 SQLServer 为修订表生成 SQL，而不是手动编码。此代码可在[https://github.com/newdigate/sqlserver-revision-tables上找到](https://github.com/newdigate/sqlserver-revision-tables)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-08T13:25:08.503

触发器。现在您可能会说更新数据的唯一方法是通过您的 SP，但情况可能会发生变化，或者您可能需要进行大规模插入/更新，而使用 SP 将过于麻烦。使用触发器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-12T18:39:36.453

这取决于应用程序的性质和表结构、索引数量、数据大小等、外键等。如果这些是相对简单的表（没有或很少有索引，如日期时间/整数列上的索引），数据有限设置（< 100 万行），您可能可以使用触发器。

请记住，触发器可能是锁定问题的根源。我假设如果您使用历史表作为一种审计跟踪，您将对它们进行索引以供将来参考。如果触发器更新由于索引而导致插入/更新/删除缓慢的历史表，则过程调用将阻塞，直到触发器完成。此外，如果触发器中将更新任何外键约束，这也可能会影响性能。

在这种情况下，这一切都取决于表索引。我们将 Sql Server 2000 用于每天处理超过 10 万笔金融交易的 24/7 应用程序。最大/主表有超过 1 亿行和 15 个索引（如果需要正常运行时间，大规模删除是不可能的）。尽管所有 SQL 都在存储过程中完成，但由于性能下降，我们不使用触发器或外键。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-12-02T15:47:28.383

触发器。这是我的方法：

1.  为每个需要审计试验的关键表创建一个审计表
2.  审计表将包括源表中的所有列 + 列审计记录信息，例如谁、何时和操作
3.  仅针对 UPDATE 和 DELETE 触发，INSERT 操作将在源表本身中具有原始记录
4.  在更新或删除之前，将原始记录+审计信息复制到审计表
5.  （可选 - 仅适用于 UPDATE：）要知道哪一列被更新，请使用 SQL 函数中的 UPDATE(ColumnName) 或 COLUMNS_UPDATED() 来确定受影响的列

以这种方式进行审计可以保持源表中的当前状态和审计表中的所有历史记录，并且可以通过键列轻松识别。

# c# - 按需 IEnumerable 绑定到 ListBox

> ID：349536
> 
> 赞同：3
> 
> 时间：2008-12-08T13:22:03.393
> 
> 标签：c#, wpf, data-binding

我有一个可能相当大的对象列表，我想绑定到 WPF 中的 ListBox。但是，我想让 List 以增量方式自行加载。如何将 ListBox 绑定到按需加载自身的 IEnumerable，以使列表框仅尝试枚举显示所需的数量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T15:58:03.593

WPF ListBox 使用[VirtualizingStackPanel](http://msdn.microsoft.com/en-us/library/system.windows.controls.virtualizingstackpanel.aspx)作为其项目的布局控件。您可以使用以下 XAML 将 VirtualizingStackPanel 设置为仅根据需要加载项目：

```
<ListBox 
    VirtualizingStackPanel.IsVirtualizing="True"
    ItemSource="..."
    /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T13:56:21.060

您可以将列表存储在数据库中 - 可能是内存中的 - 然后使用 LINQ 在 IEnumerable 中检索所需的块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T13:27:29.777

使用winform，“虚拟模式” - 但是AFAIK，这在WPF中是不一样的。你可以看到[这个 MSDN 论坛](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/6d8e6f19-538a-4808-a5b0-4f6969041129/)帖子。

我在很大程度上同意 Drew Marsh - 让用户过滤数据，而不是滚动浏览它。

# sql - 嗅探对 SQL Server 的查询

> ID：349540
> 
> 赞同：8
> 
> 时间：2008-12-08T13:24:56.053
> 
> 标签：sql, sql-server

有没有办法在任何级别（高于传输级别）上嗅探发送到 SQL Server 数据库的 SQL 查询？也许 ASP.NET 中有某种跟踪器或 SQL Server 中的内置日志？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-08T13:26:11.433

SQL Server Profiler 也许？这将获取执行的查询。您还可以从中获取统计信息、查询计划和许多其他感兴趣的项目。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-08T13:39:21.203

您正在寻找的工具是[SQL Server Profiler](http://msdn.microsoft.com/en-us/library/ms181091.aspx)，学会使用它并爱上它。

尝试从运行 ASP.NET 应用程序的 IIS 服务器的 ApplicationName 和/或 HostName 筛选器开始。Profiler 可以变得很健谈。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-08T13:43:20.150

当您在 SQL Management Studio 中时，打开查询编辑器并将其设置为您想要分析的正确数据库。运行以下查询：

```
select db_id() 
```

这将告诉您您的数据库 id 。

*   转到工具 > SQL 配置文件管理器。
*   单击文件 > 新建跟踪...
*   连接到您的数据库服务器。
*   在显示的窗口中，单击“事件选择”选项卡。
*   单击显示所有列复选框。
*   然后单击 Column Filters 并在 Edit Filter 框中选择 DatabaseID。

    在右侧，选择“等于”并输入上面查询中的数据库 ID。

*   单击确定，然后单击运行。

# c++ - 线程问题（追逐自己的尾巴）

> ID：349544
> 
> 赞同：1
> 
> 时间：2008-12-08T13:25:38.160
> 
> 标签：c++, multithreading

有`ConnectionManager`等待传入连接。对于每个传入连接，它都会创建一个`Connection`实例来处理此连接上的入站和出站流量。每个`Connection`都有一个`Watchdog`处理“坏连接”条件并调用已注册的“侦听器”。一个“侦听器”`ConnectionManager`关闭连接并删除`Connection`实例，该实例又删除相应的看门狗。

等待。一分钟。

`Watchdog`调用`ConnectionManager`哪个删除哪个`Connection`删除？`Watchdog`看门狗追逐自己的尾巴。

我完全被封锁了。我该如何解决这个问题？

* * *

**解决方案**：我会让 Listener 变得异步，虽然我还不知道如何在没有太多痛苦的情况下做到这一点。`Watchdog`不`ConnectionManager`知道。这是相当通用的。此外，Win32-Thread-API 没有“加入”之类的东西，所以我可能需要自己动手`GetExitCodeThread()`和`STILL_ACTIVE`......

多谢你们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-08T13:35:06.097

消息传递。

不是让 Watchdog 调用 的方法，而是将`ConnectionManager`消息发布到连接管理器中的队列。这个队列需要是线程安全的。当`ConnectionManager`进程在其线程中处理队列时，等待连​​接线程结束是安全的。

```
Watchdog          Queue               ConnectionManager
   |                |                        |
Kill Connection---->|                        |
   |                |<-------------------Get Message
  ---               |                        |
                    |-------------------->Process Message
                    |                        |
                    |                     Kill Connection 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T13:36:07.873

如果这些对象中的每一个都在其自己的线程中运行，则没有问题。

Watchdog 通知 ConnectionManager 并返回。
此时看门狗线程可以退出。

当 ConnectionManager 注意到 watchdog 事件时，它会终止 Connection 线程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-08T13:48:15.337

如果看门狗在不同的线程中运行，那么问题还算不错——看门狗用异步消息通知 ConnectionManager 删除，然后退出它自己的线程。

同时，ConnectionManager 线程收到删除消息，并开始删除看门狗。

为了避免竞争条件，看门狗析构函数应该加入看门狗线程，并清理线程。（可能还会向看门狗线程发出信号，或断言（）有关看门狗线程准备退出的信息）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T15:16:30.073

细心的话是没有问题的。

1.  ConnectionInstance::a_method() calls Watchdog::a_method() calls ConnectionManager::a_method

2.  ConnectionManager::a_method() deletes ConnectionInstance deletes Watchdog

3.  ConnectionManager::a_method() returns to Watchdog::a_method() returns to ConnectionInstance::a_method(). As long as the return path doesn't access any members it's just a return from a function. The code is still there by the standard, so you can safely return.

This requires careful coding and maintaining, but it's not a dirty hack it may seem.

Asynchronous protocol will require same amount of thinking. It's not just that you'll need to avoid racing between Watchdog requesting delete in a ConnectionManager::queue and ConnectionManager doing something with the queue at the same time. The problem is deeper: there's a period of time when ConnectionInstance is not functional - it has requested to be deleted - but not still deleted. What it it doing? A code can not stay still. If there's a safe way out for the not defunct ConnectionInstance, you can as well roll back the stack yourself without creating extra asynchronous protocols.

Watchdog throwing an exception might be an easier way to deal with ConnectionInstance, if they are in the same thread.

# sharepoint - 我们可以将 SharePoint 在网站层次结构中向上移动吗？

> ID：349558
> 
> 赞同：0
> 
> 时间：2008-12-08T13:30:18.803
> 
> 标签：sharepoint, sharepoint-2007, wss

我的 SharePoint 与本地 Intranet 链接为[http://shserver/Sites/LAPP/HR/LA](http://shserver/Sites/LAPP/HR/LA)。我想将站点 LA 移动到以下位置[http://shserver/Sites/LAPP/LA](http://shserver/Sites/LAPP/LA)。

这是否可以通过某种工具实现，或者唯一的方法是在新的 url 位置完全重新创建站点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T13:37:24.267

STSAdmin 应该在这里提供帮助 -[本文](http://sharepoint.microsoft.com/blogs/fromthefield/Lists/Posts/Post.aspx?List=0ce77946%2D1e45%2D4b43%2D8c74%2D21963e64d4e1&ID=26)旨在涵盖您需要的内容

# sql - SQL如何搜索多对多关系

> ID：349559
> 
> 赞同：6
> 
> 时间：2008-12-08T13:32:00.783
> 
> 标签：sql, search, many-to-many, relational-division

我有一个包含两个主表`notes`和`labels`. 它们具有多对多的关系（类似于 stackoverflow.com 对标签的问题）。我想知道的是如何使用 SQL 使用多个标签搜索笔记？

例如，如果我有一个带有三个标签“一”、“二”和“三”的便笺“test”，而我有一个带有标签“一”和“二”的第二个便笺“test2”，那么 SQL 查询将是什么？找到所有与标签“一”和“二”相关的笔记？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-08T13:44:24.830

要获取同时具有标签“一”和“二”的注释的详细**信息**：

```
select * from notes
where note_id in
( select note_id from labels where label = 'One'
  intersect
  select note_id from labels where label = 'Two'
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T13:36:26.437

```
select * from notes a
inner join notes_labels mm on (mm.note = a.id and mm.labeltext in ('one', 'two') ) 
```

当然，替换为您的实际列名，希望我对您的表的假设是正确的。

实际上，由于英语以及有时如何使用“and”一词，您的问题可能存在一些歧义。例如，如果您的意思是要查看标记为“一”而不是“二”的注释，则应该可以（将您的“和”解释为“向我显示所有带有标签的注释”和/加上所有带有“二”标签的注释）。但是，如果您只想要具有两个标签的笔记，这将是一种方法：

```
select * from notes a
where exists (select 1 from notes_labels b where b.note = a.id and b.labeltext = 'one')
     and exists (select 1 from notes_labels c where c.note = a.id and c.labeltext = 'two') 
```

编辑：感谢大家的建议，我大脑中的星期一齿轮有点慢......看起来我应该维基百科！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-08T14:12:34.477

注意：我还没有实际测试过这个。它还假设您有一个名为 notes_labels 的多对多表，但情况可能根本不是这样。

如果你只想要有任何标签的笔记，就像这样

```
SELECT DISTINCT n.id, n.text
FROM notes n
INNER JOIN notes_labels nl ON n.id = nl.note_id
INNER JOIN labels l ON nl.label_id = l.id
WHERE l.label IN (?, ?) 
```

如果您想要包含所有标签的笔记，则需要做一些额外的工作

```
SELECT n.id, n.text
FROM notes n
INNER JOIN notes_labels nl ON n.id = nl.note_id
INNER JOIN labels l ON nl.label_id = l.id
WHERE l.label IN (?, ?)
GROUP BY n.id, n.text
HAVING COUNT(*) = 2; 
```

? 是一个 SQL 占位符，2 是您要搜索的标签数。这是假设链接表有两个 ID 列作为复合主键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T13:37:26.683

像这样的东西......（你需要另一个链接表）

```
SELECT *
FROM Notes n INNER JOIN NoteLabels nl
ON n.noteId = nl.noteId
WHERE nl.labelId in (1, 2) 
```

**编辑**：NoteLabel 表将有两列，noteId 和 labelId，带有一个复合 PK。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-08T13:40:39.283

假设您有一个规范化的数据库，您应该在两者之间有另一个`notes`表`labels`

然后，您应该使用 an`inner join`将表连接在一起

1.  `labels`使用绑定表（多对多表）加入表
2.  将`notes`表与上一个查询连接起来

例子：

`select * from ((labels l inner join labels_notes ln on l.labelid = ln.labelid) inner join notes n on ln.notesid = n.noteid)`

这样，您已将两个表连接在一起。

现在您需要添加的是该`where`子句……但我将由您决定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T13:41:38.750

你什么也没说这种多对多关系是如何实现的。我假设标签表是 Labels(noteid: int, label: varchar) - 主键跨越两者？

```
SELECT DISTINCT n.id from notes as n, notes_labels as nl WHERE n.id = nl.noteid AND nl.text in (label1, label2); 
```

替换为您的列名，并为标签插入适当的占位符。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-08T13:52:44.297

如果你只需要一个列表，你可以使用`where exists`以避免重复。如果您的选择条件中有多个针对节点的标签，您将在结果中获得重复的行。这是一个例子`where exists`：

```
create table notes (
       NoteID int not null primary key
      ,NoteText varchar (max)
)
go

create table tags (
       TagID int not null primary key
      ,TagText varchar (100)
)
go

create table note_tag (
       NoteID int not null
      ,TagID int not null
)
go

alter table note_tag
  add constraint PK_NoteTag
      primary key clustered (TagID, NoteID)
go

insert notes values (1, 'Note A')
insert notes values (2, 'Note B')
insert notes values (3, 'Note C')

insert tags values (1, 'Tag1')
insert tags values (2, 'Tag2')
insert tags values (3, 'Tag3')

insert note_tag values (1, 1) -- Note A, Tag1
insert note_tag values (1, 2) -- Note A, Tag2
insert note_tag values (2, 2) -- Note B, Tag2
insert note_tag values (3, 1) -- Note C, Tag1
insert note_tag values (3, 3) -- Note C, Tag3
go

select n.NoteID
      ,n.NoteText
  from notes n
 where exists
       (select 1
          from note_tag nt
          join tags t
            on t.TagID = nt.TagID
         where n.NoteID = nt.NoteID
           and t.TagText in ('Tag1', 'Tag3'))

NoteID      NoteText
----------- ----------------
1           Note A
3           Note C 
```

# django - 使用 Django 进行 Lighttpd 和 Apache 配置所需的帮助

> ID：349564
> 
> 赞同：1
> 
> 时间：2008-12-08T13:33:12.137
> 
> 标签：django, apache, lighttpd, lighty, static-media

我使用 Django 作为 Web 框架，然后分别使用 Apache 和 Lighttpd 作为 Web 服务器和静态媒体服务器。Lighty 很好地服务于我所有的静态内容，但我需要对其进行配置以服务于用户上传的新文件。Lighttpd 运行在与 Apache(Django) 不同的机器上。我创建目录然后创建图像文件的 django 代码在我的 Apache 机器上执行，使其当前保存在同一台机器本身中。我希望这个目录和文件创建发生在我的静态媒体服务器上，然后应该由媒体服务器本身提供服务。我分别使用 os.mkdir 和 urllib.urlretrieve 函数在 Django（Apache）机器上创建目录和保存文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T20:39:36.940

最简单的答案是用户上传到两个 Web 服务器都可以访问的共享目录。然后它立即可用。如果您使用的是 unix（听起来很像），那么 NFS 是一个可能的解决方案。如果您认为您的站点将像 flickr 一样扩展到多个服务器，那么使用 rsync 推送到多个边缘服务器，甚至可能实施分片方案是另一种解决方案。

小心点。根据您的应用程序，您必须考虑许多安全问题。

如果所有文件都进入可公开访问的目录，则用户可能会猜测其他人文件的名称并下载它们。在这种情况下，您将希望从 Django 为它们提供服务，并在顶部提供一层薄薄的安全性。

永远不要相信你的用户！验证他们上传的内容是否在某个允许的范围内。在任何情况下，您都不应允许他们上传他们想要的任何内容。当然，除非您的用户是值得信赖的少数人。即使那样你也应该做一些检查。他们可能不应该为一个上传 .php 文件。您想要给他们的最后一件事是能够在您的服务器上运行任意脚本。至少将目录配置为仅提供文件而不执行任何操作。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T20:27:01.257

这就是我使用 rsync 的那种东西。在主服务器上做任何你喜欢的事情，然后定期（或按需）rsync 推送到静态服务器。Rsync 比你可以通过快速 hack 生成的任何东西都更快（并且功能更丰富）。

正因为我偏执，所以我每小时将我所有的客户站点同步到 2 台备份服务器，其中一台在我的车库里。我刚刚对一个 1.7GB 的客户站点（没有任何更改）计时了一个“rsync -a”，它花费了 9.92 秒的挂钟时间，包括用于 rsync 3 个不同目录的 3 次网络握手。有任何改变，presto-bango，它已经完成，带有时间戳，所有者/组等。

当您开始真正的、多机、无人参与的备份工作时，您对服务器故障会变得多么无所谓，这真是令人惊讶。我睡得很好。

# c# - 默认文档的 IIS 6 404

> ID：349574
> 
> 赞同：2
> 
> 时间：2008-12-08T13:37:33.267
> 
> 标签：c#, asp.net, iis-6

我在 IIS 6 上部署了一个 ASP.NET 网站。我的应用程序中有几个文件夹，其中包含 log.ashx、default.ashx 等处理程序。

我在 IIS 中配置了默认文档，因此我可以在浏览器中键入 www.mydomain.com/tools，我将获得 /tools/default.ashx。

IIS 一直给我 404，这是我的问题。我还将 aspnet_isapi.dll 配置为通配符处理程序。

有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-08T14:00:17.823

在 IIS 中设置默认文档只是告诉 IIS 在请求的文件夹中查找具有该名称的文档，因此如果 /tools/default.ashx 在服务器上不存在，那么您确实会得到 404。

您需要在 web.config 中声明处理程序 - 这篇文章[http://dotnetperls.com/Content/ASHX-Handler.aspx](http://dotnetperls.com/Content/ASHX-Handler.aspx)将向您介绍如何使用 web.config 的 urlMappings 部分设置类似的内容。

# linux - Linux：检索每个接口发送/接收的数据包计数器（以太网、ipv4、ipv6）

> ID：349576
> 
> 赞同：12
> 
> 时间：2008-12-08T13:38:53.937
> 
> 标签：linux, networking, ip

在 Linux 上，我如何（以编程方式）*基于每个接口*检索以下计数器：

*   发送/接收以太网帧，
*   发送/接收 IPv4 数据包，
*   发送/接收 IPv6 数据包。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-09T13:06:10.287

在我的系统上，有一些文件`/sys/class/net/eth0/statistics`，其中提供了有关网络接口的各种统计信息。

这是假设最近`/sys`安装了（sysfs）的Linux。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-04T13:24:32.903

```
cat /proc/net/dev 
```

应包含计数器、统计数据和信息。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-08T13:57:43.523

您应该能够使用`iptables`规则和数据包计数器来执行此操作，例如

```
# input and output must be accounted for separately
# ipv4, eth0
iptables -I INPUT -i eth0
iptables -I OUTPUT -o eth0
# ipv6, eth0
ip6tables -I INPUT -i eth0
ip6tables -I OUTPUT -o eth0 
```

要查看统计信息，请解析这些输出：

```
iptables -L -vxn
ip6tables -L -vxn 
```

`-Z`您还应该在要重置计数器时查找标志。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-08T13:58:57.123

您总是可以自己解析各种内核状态文件，我认为这就是工具喜欢`netstat`做的事情。

手册页建议：

*   `/proc/net/raw`-- 原始套接字信息
*   `/proc/net/tcp`-- TCP 套接字信息
*   `/proc/net/udp`-- UDP套接字信息

我想应该有一个非过程的方式来做到这一点，也许`/sys`也是？我快速浏览了一下，但什么也没找到。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-08T14:00:26.013

要么只解析`netstat -i`. 或者`strace netstat -i`，并使用它来确定它在哪里查找信息。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-08T14:03:59.487

`ifconfig`告诉您传输的数据量（字节和数据包）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-05-08T07:32:59.130

以下命令提供在系统范围内维护的 ipv4/ipv6 统计信息：

```
netstat --statistics

nstat -z

cat /proc/net/dev_snmp6/eth0  gives ipv6 stats per interface 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-02-24T14:08:25.633

**您可以使用ethtool**打印完整的以太网统计信息： `ethtool -S eth1`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-08T13:51:35.737

[Wireshark](http://www.wireshark.org/)（曾经是 Ethereal）可以帮助你。

[Netstat](http://linux.die.net/man/8/netstat)将是我的第二个猜测

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-05-19T20:28:00.650

您可以在 monodevelop 的 C# 中轻松做到这一点：

```
using System.Net.NetworkInformation;

foreach (NetworkInterface ni in interfaces)
{
  // perform your calculations
} 
```

# c# - C# 中的 MP3 封面艺术标记

> ID：349581
> 
> 赞同：1
> 
> 时间：2008-12-08T13:41:08.940
> 
> 标签：c#, tags, mp3, cover

我需要用 C# 中的封面艺术标记 MP3 文件...

有什么简单的方法可以做到这一点吗？我发现 UltraID3Lib 作为示例，它非常适合常规 ID3 标记，但我无法处理封面。如果有人知道这样做的简单方法会很棒:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T14:03:54.917

我做这样的[事情](http://www.mkoby.com/2007/03/21/mp3s-ultraid3lib/)：

```
private static void FixAlbumArt(FileInfo MyFile)
{
  //Find the jpeg file in the directory of the Mp3 File
  //We will embed this image into the ID3v2 tag
  FileInfo[] fiAlbumArt = MyFile.Directory.GetFiles("*.jpg");
  if (fiAlbumArt.Length &lt; 1)
  {
    Console.WriteLine("No Album Art Found in {0}", MyFile.Directory.Name);
    return;
  }
  string AlbumArtFile = fiAlbumArt[0].FullName;

  //Create Mp3 Object
  UltraID3 myMp3 = new UltraID3();
  myMp3.Read(MyFile.FullName);
  ID3FrameCollection myArtworkCollection =
    myMp3.ID3v23Tag.Frames.GetFrames(MultipleInstanceFrameTypes.Picture);

  if (myArtworkCollection.Count &gt; 0)
  {//Get Rid of the Bad Embedded Artwork
    #region Remove All Old Artwork
    for (int i = 0; i &lt; myArtworkCollection.Count; i++)
    {
      ID3PictureFrame ra = (ID3PictureFrame)myArtworkCollection[0];
      try
      {
        myMp3.ID3v23Tag.Frames.Remove(FrameTypes.Picture);
      }
      catch { }
    }
    myArtworkCollection.Clear();

     //Save out our changes so that we are working with the
    //most up to date file and tags
    myMp3.ID3v23Tag.WriteFlag = true;
    myMp3.Write();
    myMp3.Read(MyFile.FullName);
    #endregion Remove All Old Artwork
  }
  //Create a PictureFrame object, pointing it at the image on my PC
  ID3PictureFrame AlbumArt =
    new ID3PictureFrame(
    (System.Drawing.Bitmap)System.Drawing.Bitmap.FromFile(AlbumArtFile),
    PictureTypes.CoverFront, "Attached picture", TextEncodingTypes.ISO88591);
  myMp3.ID3v23Tag.Frames.Add(AlbumArt);
  myMp3.ID3v23Tag.WriteFlag = true;
  myMp3.Write();

  myMp3 = null;
} 
```

我在工作，忘记打开 Foldershare，所以我无法向您展示我的精简版本，我在其中传递了一个 Image 对象，但这拥有完成工作所需的一切。祝你好运。

# vba - 访问 VBa：在报告时检查 excel 文件的结尾

> ID：349588
> 
> 赞同：0
> 
> 时间：2008-12-08T13:44:20.057
> 
> 标签：vba, excel, ms-access

我正在将访问表的某些检查结果写入 excel 文件。有时结果超过 65k，超出了 excel 的处理能力（excel 2002）。我如何检查文件的结尾并打开一个新工作表以继续

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T14:13:46.923

你至少有两个选择。

第一个是在输出它们时简单地计算行数（如果写入不是一次全部发生，请保留一个辅助文件，其中包含主文件中的行数）。随着行数接近限制（即 65k），开始一个新的工作表。

根据文件结构的灵活性，另一种方法是将所有行写入访问表，然后让 Excel 工作表查询访问表。这将绕过 Excel 2002 中的行数限制

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T13:59:17.170

我应该问你如何将这些输出到文件中。

如果它是程序上的，那么为什么没有一个运行计数器到 65535。当它超过这个值时，开始一个新的工作表。

# excel - VB6中的ole excel对象

> ID：349597
> 
> 赞同：1
> 
> 时间：2008-12-08T13:47:30.283
> 
> 标签：excel, vb6, ole

是否有人知道有关在 VB6 中使用 ole excel 对象（嵌入式工作簿、工作表等）的详细信息的***在线资源？***我正在维护一个大量使用这些控制的应用程序，我在让它们为该程序的用户正常工作时遇到了很多麻烦。我可以在网上找到的与 ole excel 控件相关的零星问答非常有限，而且不是很明确。显然，我已经阅读了 MSDN 上的内容，但我觉得它不是很有帮助，所以我想找到另一个好的参考来源。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T19:09:50.000

我不确定这对*嵌入*Excel 是否有帮助，但假设 Excel 引擎是嵌入控件的核心，您可以[在此处](http://msdn.microsoft.com/en-us/library/aa272310(office.11).aspx)查找 Excel 2003 可用对象的按字母顺序排列的参考。

这里是 Excel VBA 参考[的](http://msdn.microsoft.com/en-us/library/aa272254(office.11).aspx)根源，其中包括一个“概念”部分，讨论主要对象，如工作簿和工作表、单元格和范围等。

您必须先在项目中设置对 Excel 对象的引用，然后才能创建这些对象中的任何一个。在 Project/References 下，您会找到类似“Microsoft Excel 9.0 Object Library”的内容。（我有 Office 2000，因此是 9.0。根据上面的链接，我想对于 Excel 2003，您会看到 Excel 11。）

在您的代码中，执行以下操作：

```
' Start a new workbook in Excel '

Dim oExcel As Excel.Application
Dim oBook As Excel.Workbook

' Launch an instance of Microsoft Excel '
Set oExcel = new Excel.Application
Set oBook = oExcel.Workbooks.Add 
```

然后继续针对应用程序、工作簿等进行编码。上面的代码将创建一个*未*嵌入但在它自己的窗口中的 Excel 实例。需要注意的一件事是，默认情况下，该 Excel 实例将不可见。您必须先将 Visible 属性设置为 True，然后才能看到它。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T04:47:21.060

任何有关 Excel VBA 的书都应该有所帮助，因为您可以将代码从 VBA 复制并粘贴到 VB6。我会从那里开始。

同样尝试使用 VBA 在 Excel 中做您想做的事情，然后将其放入您的 VB6 项目中也会有所帮助。然后，您将可以访问 Excel 中的所有 VBA 帮助（如果您安装了它......它并不总是默认安装）。

# c# - C# 中的测试驱动远程处理 - 我需要单独的服务器 AppDomain 吗？

> ID：349603
> 
> 赞同：3
> 
> 时间：2008-12-08T13:50:17.423
> 
> 标签：c#, unit-testing, remoting

我想以测试驱动的方式开始在 C# 下使用 Remoting，但我卡住了。

我在该主题上发现的一件事是[Marc Clifton 的这篇文章](http://www.codeproject.com/KB/architecture/TddRemoting.aspx)，但他似乎通过从控制台手动启动服务器来运行服务器。

我尝试在测试夹具中启动服务器（即注册服务类）。我可能也有接口的使用错误，但稍后会出现。

我总是收到频道已注册的异常（对于德语消息感到抱歉）。System.Runtime.Remoting.RemotingException：Der Channel tcp wurde bereits registriert。

在测试方法中注释掉 ChannelServices.RegisterChannell() 行之后，它发生在调用 Activator.GetObject() 中。

我试图将 StartServer() 放入一个线程中，但这也无济于事。我发现创建一个新的 AppDomain 可能是一种可能的方式，但还没有尝试过。

你能告诉我，如果我的方法本质上是错误的吗？我该如何解决？

```
using System;
using NUnit.Framework;
using System.Runtime.Remoting;
using System.Runtime.Remoting.Channels;
using System.Runtime.Remoting.Channels.Tcp;

namespace Bla.Tests.Remote
{
    [TestFixture]
    public class VerySimpleProxyTest
    {
        int port = 8082;
        string proxyUri = "MyRemoteProxy";
        string host = "localhost";

        IChannel channel;

        [SetUp]
        public void SetUp()
        {
            StartServer();
        }

        [TearDown]
        public void TearDown()
        {
            StopServer();
        }

        [Test]
        public void UseRemoteService()
        {
            //IChannel clientChannel = new TcpClientChannel();
            //ChannelServices.RegisterChannel(clientChannel, false);
            string uri = String.Format("tcp://{0}:{1}/{2}", host, port, proxyUri);
            IMyTestService remoteService = (IMyTestService)Activator.GetObject(typeof(IMyTestService), uri);

            Assert.IsTrue(remoteService.Ping());
            //ChannelServices.UnregisterChannel(clientChannel);
        }

        private void StartServer()
        {
            channel = new TcpServerChannel(port);
            ChannelServices.RegisterChannel(channel, false);
            RemotingConfiguration.RegisterWellKnownServiceType(typeof(MyTestService), proxyUri, WellKnownObjectMode.Singleton);
        }

        private void StopServer()
        {
            ChannelServices.UnregisterChannel(channel);
        }
    }

    public interface IMyTestService
    {
        bool Ping();
    }

    public class MyTestService : MarshalByRefObject, IMyTestService
    {
        public bool Ping()
        {
            return true;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-17T23:18:19.823

我真的没有解决您的问题的方法，但我的建议是，不要以这种方式编写单元测试。看到这个[帖子](http://www.artima.com/weblogs/viewpost.jsp?thread=126923)。你真的想在这里测试什么代码。我很确定 Microsoft 已经对 .net 附带的 Remoting 功能进行了大量测试。实现你的 Service 接口的类可以在过程中通过更新实现来进行单元测试。如果 .net 框架不使用静态作为注册位，那么注册服务接口的代码将是可测试的，但是，唉。您可以尝试以某种方式将 IChannel 模拟传递给 `ChannelServices.RegisterChannel`并验证您的注册码，但在我看来，这将是浪费时间。

我只想指出，测试应该是达到目的的一种手段，而不是其本身的目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T12:51:37.977

我找到了一个很好的方法来做我想做的事，只使用 WCF 而不是 Remoting。

我在不到 5 分钟的时间内将[Yair Cohen 的文章](http://blogs.microsoft.co.il/blogs/smallfish/archive/2008/11/28/testing-wcf-service.aspx)中给出的源代码移植到了 NUnit，它开箱即用。

# web-applications - 很多小项目有什么好的项目管理软件？

> ID：349605
> 
> 赞同：21
> 
> 时间：2008-12-08T13:50:38.593
> 
> 标签：web-applications, project-management, time-management

我在一家小型网络机构（3 名程序员，2 名项目经理）工作，我们主要为营销活动制作网站，也制作一些较大的网站。我们的大多数项目都在开发一个星期，也许是两个星期。大多数项目仅由单个开发人员完成。

到目前为止，我们一直在使用 Google 文档中的电子表格来跟踪当前和即将进行的项目。但是最近我们一直觉得这有点不精确，很难仅通过电子表格中的单个单元格来判断项目的规模和范围。进一步看，随着我们的扩展，即使我们对电子表格进行一些更改，这也不是一个可行的选择。

**我看过的大多数（诚然很少*）项目/时间管理工具更多地关注于具有大量任务的少数项目。不太关心谁做什么。**

**我们想要的是可以反过来舒适地工作的东西，许多项目分配给少数开发人员，每个项目都有少数票/任务。**

我也很难找到能够很好地概述分配给单个开发人员的内容以及他们将拥有的预期工作量的软件。

**有这样的软件吗？**
如果不是，那么滚动我们自己的一个好的起点是什么？

`*` *到目前为止我看过的主要是[activecollab](http://www.activecollab.com/)、[redmine](http://www.redmine.org/)、[fogbugz](http://www.fogcreek.com/FogBUGZ/)和[trac](http://trac.edgewall.org/)，现在[redmine](http://www.redmine.org/)感觉是最合适的*

**更新：** 我一直在玩弄 Redmine，尽管我以前从未接触过 Ruby，但似乎很容易摆弄。我破解了时间表插件以显示未来的工作，而不是在下午完成的工作时间。现在我的主要障碍是说服我们的项目经理试一试；）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-08T14:12:22.807

我可能会尝试使用[Redmine 之](http://redmine.org/)类的东西。它本身不是项目管理，它更像是锻造软件，但它具有时间跟踪、论坛、文档和文件上传、轻量级甘特图和错误/问题跟踪器。它发展迅速，甚至可以导入 Trac 数据。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-08T14:00:24.627

[FogBugz](http://www.fogcreek.com/FogBugz/) - 我们主机的插件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-08T14:16:54.500

我会说[fogbugz](http://www.fogbugz.com)。但这一切都取决于成本。问题中提到的大多数产品/应用程序都是免费或开源的。如果成本是一个问题，那么其中一个应用程序会很棒。

关于[fogbugz](http://www.fogbugz.com)的另一个好处是他们可以为您托管它。对于这样一个小团队，您可能不想担心自己托管其他软件产品并确保它们得到备份等等。

只是要考虑的事情。我已经尝试了大部分产品，最后选择了[fogbugz](http://www.fogbugz.com)。我也是一个非常小的团队的一员，它工作得很好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-05T04:48:05.487

好吧，我在一个 8 人的团队中工作，我们有大约 50 个项目的投资组合，而且还在增加......

我正在使用 redmine，一切似乎都很好......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-08T14:50:45.757

你也可以看看： http: [//www.dotproject.net/](http://www.dotproject.net/)

几年前我用过它，它并不太破旧。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-10T23:02:37.463

[大本营](http://basecamphq.com/)……当然！

可以说我有一个非技术团队，他们现在热爱生活！我们，技术人员，已经爱了几个月了！！！:D

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-07-13T07:34:58.553

如果碰巧您的团队对使用 Emacs 感到满意，那么 org-mode ( [http://orgmode.org/](http://orgmode.org/) ) 将是理想的选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-03T22:01:44.873

RationalPlan 呢？

单项目版本、多项目版本和免费项目查看器：

[http://www.RationalPlan.com](http://www.RationalPlan.com)

伊万·卢西安

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-03-08T15:27:42.447

听到很多关于[playnice.ly](http://playnice.ly/)的炒作，可能会很高兴看到它如何与一些更成熟的软件（如[双子座项目平台）相媲美](http://www.geminiplatform.com)

# jquery - 简单的 jQuery 函数适用于除 Firefox 之外的所有浏览器。我错过了什么？

> ID：349612
> 
> 赞同：0
> 
> 时间：2008-12-08T13:54:29.957
> 
> 标签：jquery, firefox

```
$(document).ready(function() {
    $("span.link").mouseover(function(e){
        $(this.children).css("display","inline");  
      });
  }); 
```

我不是 javascript 专家，但我使用 jQuery 拼凑了一些函数。

在这种情况下，样式表隐藏了一些控件。当用户将鼠标悬停在上面时，此函数会公开这些控件。

这适用于除 Firefox（在 Mac 和 Windows 上）之外的所有浏览器。我错过了一些明显的东西吗？

谢谢你的帮助，

杰森

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-08T13:58:26.877

试试这样：

```
$(function() {
    $("span.link").mouseover(function(e){
        $(this).children().css("display","inline");  
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T14:19:01.047

实际上，您在开发 Web 应用程序时需要使用的是：

*   火狐
*   IE
*   苹果浏览器
*   （Chrome 很快...）

我的意思是，您应该**在所有 3 个主要的 A 级浏览器上测试您网站的每一步**……因此，如果在此过程中出现问题，您将确切知道是什么导致了中断。

如果您不定期与浏览器一起检查您的页面是如何运行的，那么以后解决问题将变得更加困难。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-08T14:36:13.773

补充一下 Dreas 所说的，如果您碰巧正在为一个获得大量流量的客户端进行开发（我会说无论如何都要这样做），请帮自己一个忙，并找到一种在 IE6 中测试它的方法。如果你这样做，你将来会为自己省去很多麻烦。上周我有三分之一的时间在弄清楚为什么这个或那个在 IE（6 和 7）中不起作用，包括我星期五的一整天。幸运的是，我仍处于开发阶段，一周后并没有让客户愤怒地回来想知道为什么他/她的用户在 IE6 中遇到问题（以前也发生过）。

谢天谢地，一位同事将我介绍给了 Microsoft Virtual PC，所以现在我可以在我说完成之前测试我需要的任何东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T20:15:59.797

查看此[应用程序](http://tredosoft.com/Multiple_IE)，它安装了多个版本的 Internet Explorer

...范围从 v3、v4、v5，最重要的是 v6（开发时应该在 ie6 中包含测试）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-27T11:25:22.397

使用 addClass ......更容易使用，特别是如果您希望在以后添加多种样式。只是养成一个好习惯。

```
$(function() {
    $("span.link").mouseover(function(e){
        $(this).children().addClass('inlineClass');  
    });
}); 
```

# vba - 关键字 Set 在 VBA 中的实际作用是什么？

> ID：349613
> 
> 赞同：161
> 
> 时间：2008-12-08T13:54:30.143
> 
> 标签：vba, variable-assignment

希望是一个简单的问题，但我非常想要一个技术性的答案！

有什么区别：

```
i = 4 
```

和

```
Set i = 4 
```

在 VBA 中？我知道后者会抛出错误，但我不完全明白为什么。

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2008-12-08T14:00:24.203

`set`用于分配对对象的引用。C等价物是

```
 int i;
int* ref_i;

i = 4; // Assigning a value (in VBA: i = 4)
ref_i = &i; //assigning a reference (in VBA: set ref_i = i) 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2008-12-08T13:57:56.783

在您的情况下，它将产生错误。:-)

`Set`分配一个对象引用。对于所有其他赋值，（隐式、可选和很少使用的）`Let`语句是正确的：

```
Set object = New SomeObject
Set object = FunctionReturningAnObjectRef(SomeArgument)

Let i = 0
Let i = FunctionReturningAValue(SomeArgument)

' or, more commonly '

i = 0
i = FunctionReturningAValue(SomeArgument) 
```

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2008-12-08T13:58:45.707

来自[MSDN](http://msdn.microsoft.com/en-us/library/aa192490.aspx)：

> **Set 关键字：** 在 VBA 中，Set 关键字是区分对象赋值和对象默认属性赋值所必需的。由于 Visual Basic .NET 不支持默认属性，因此不需要且不再支持 Set 关键字。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-12-08T13:57:41.527

Set 用于设置对象引用，而不是分配值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-08T13:59:49.260

在我的脑海中，Set 用于将 COM 对象分配给变量。通过执行 Set 我怀疑它在引擎盖下正在对对象执行 AddRef() 调用以管理它的生命周期。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-05T07:37:42.890

所以当你想设置一个值时，你不需要“设置”；否则，如果您指的是一个对象，例如工作表/范围等，您需要使用“设置”。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-11-11T05:05:59.870

Set 是一个关键字，它用于分配对 VBA 中对象的引用。

例如，*下面的例子展示了如何在 VBA 中使用 Set。

将 WS 调暗为工作表

设置 WS = ActiveWorkbook.Worksheets("Sheet1")

WS.Name = "阿米特"

# php - json_encode和mysql unicode问题

> ID：349614
> 
> 赞同：2
> 
> 时间：2008-12-08T13:54:45.043
> 
> 标签：php, javascript, html, ajax, unicode

我有以下 javascript 代码：

[http://www.nomorepasting.com/getpaste.php?pasteid=22561](http://www.nomorepasting.com/getpaste.php?pasteid=22561)

哪个工作正常（makewindows 函数已更改为显示它是一个 php 变量），但是 html 包含 unicode 字符，并且只会分配导致第一个 unicode 字符的字符。如果我制作一个小测试文件并直接回显 article_desc，则所有 html 都会输出，尽管显示的是 quetsions 标记而不是正确的符号。然而 json_encode 似乎缩短了 html，导致错误。

编辑：这是直接来自我要显示的 html 的 mysql 数据库的转储：

[http://www.yousendit.com/download/TTZueEVYQzMrV3hMWEE9PQ](http://www.yousendit.com/download/TTZueEVYQzMrV3hMWEE9PQ)

它在源代码中显示 utf-8。回显 article_desc 生成的实际页面代码在这里：

[http://www.nomorepasting.com/getpaste.php?pasteid=22566](http://www.nomorepasting.com/getpaste.php?pasteid=22566)

这绝对是同一张唱片，所以我不确定为什么它看起来很不一样。

编辑：这是通过调用修复的：mysql_query('SET NAMES utf8');

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T20:37:05.183

`json_encode`期望字符串是 UTF-8 编码的字节流。您必须在内部使用 utf-8 编码的字符串（无论如何，这是在 PHP 中处理 unicode 字符的唯一当前方法），或者使用[不同的库](http://framework.zend.com/manual/en/zend.json.html)来生成 json。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-02T10:51:24.620

我遇到过同样的问题。我正在使用**Zend_Db** /mysqli 并且我的数据库内容实际上是 UTF8。

我通过让我的数据库适配器使用 UTF8 解决了这个问题：

```
$conf->db->params['charset'] = 'UTF8'; 
```

如果你使用 PDO 而不是 mysqli，你可以这样做：

```
$pdoParams = array(PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES UTF8;');
$conf->db->params['driver_options'] = $pdoParams; 
```

如果您不使用 Zend_Db 而是使用 mysqli，您可能需要查看[http://php.net/manual/en/mysqli.set-charset.php](http://php.net/manual/en/mysqli.set-charset.php)。

资料来源：[http ://www.zfsnippets.com/snippets/view/id/13](http://www.zfsnippets.com/snippets/view/id/13)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T20:51:22.980

```
json_encode( utf8_encode( $Content ) ); 
```

这将解决您的问题。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-08T13:59:46.280

我认为您不需要 json_encode。json_encode 将 PHP 数组和对象编码为可读的 JavaScript 格式。如果您在 ajax 中发送纯文本或 html，则不需要 json_encode

# c# - 从 C# 中的 Web 服务获取网页的虚拟路径

> ID：349626
> 
> 赞同：1
> 
> 时间：2008-12-08T13:58:08.390
> 
> 标签：c#

我想从 Web 服务获取网页的虚拟路径。有没有办法做到这一点？假设我有一个像 aa 这样的 aspx 页面，我想从我的 Web 服务中获取该页面的完整路径作为该页面的 url。

问候， 苛刻的苏曼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T14:13:05.473

什么类型的网络服务？asmx? 还是 wcf (svc)？

使用 asmx，您可以`HttpContext.Current`用来获取当前的 ASP.NET 请求，因此您可以获得几乎所有使用 ASP.NET 可以获得的东西；尝试查看 的`.Request`属性`HttpContext.Current`。

使用 wcf，不建议这样做 - 但如果启用 ASP.NET 兼容性，它可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T15:32:25.860

我同意上面的帖子。您可以使用 HttpContext.Current.Request 对象获取虚拟路径和请求 URL。

```
string path = HttpContext.Current.Request.ApplicationPath; 
```

或者如果你想要完整的 URL：

```
string path = HttpContext.Current.Request.Url.OriginalString; 
```

# java - 有什么理由使用 JBoss 5 而不是 GlassFish v2/v3 Prelude？

> ID：349634
> 
> 赞同：4
> 
> 时间：2008-12-08T14:00:08.293
> 
> 标签：java, jakarta-ee, jboss, glassfish

JBoss 5 在 2 年后刚刚推出测试版，在 Java EE 6 发布前几个月（JavaOne 在 2009 年 5 月左右）为我们提供了一个兼容 Java EE 5 的容器。我们使用 GlassFish v2 已经有一段时间了，现在有了 GlassFish v3 Prelude。

JBoss 5有什么理由超过这些吗？在过去的一年或更长时间里，我感觉 JBoss 本质上是一个死项目。

你怎么看？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-09T08:39:40.420

JBoss 绝不是一个死项目。它非常活跃，并得到了 RedHat 的强大商业支持。他们花费了大量时间重新设计整个应用服务器以运行新的 JBoss 微容器。不确定这是否值得 3 年多的努力，但发行说明在这里：

[http://sourceforge.net/project/shownotes.php?release_id=645033&group_id=22866](http://sourceforge.net/project/shownotes.php?release_id=645033&group_id=22866)

与应用服务器的任何重大重写一样，我会小心地使用 JBoss 5。如果您只是按照 Java EE 规范进行编程，那么 Glassfish 可能会很好地满足您的需求。如果您想使用 JBoss 堆栈的一部分（Seam、JBoss AOP 等），那么根据您的 QA / 部署时间表，将 JBoss 4 而不是 5 定位可能是值得的。到 5.1 发布时，应该修复了主要错误，并且您应该希望能够轻松迁移。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-09T21:32:07.443

如果您计划使用 JMS，请小心，因为连接到 IBM MQ 等 JMS 提供者可能会成为 glassfish 的噩梦。

除了功能之外，您还应该考虑它与堆栈的其余部分的匹配程度。

卡尔

# java - 早先打印 InfModel 会在以后更改打印表示？

> ID：349652
> 
> 赞同：2
> 
> 时间：2008-12-08T14:08:43.033
> 
> 标签：java, jena, jena-rules

我在使用推理 API 的 Jena 2.5.5（在 Linux 上）中得到了一种奇怪的效果。以下代码是精简版。我正在创建一个最初为空的模型和一个通用规则推理器。我为某个陈述添加了反身性规则。我将推理器附加到模型以获得 InfModel。然后我创建匹配语句并将其添加到模型中。

结果：InfModel 包含语句及其反向语句。到目前为止一切顺利，这就是它应该做的。

现在，当我`System.out.println()`在将匹配语句添加到 Model 之前的 InfModel 时，结果完全不同：规则似乎没有触发，因此，InfModel 最终将不包含原始语句的反向。

将模型写入控制台会如何改变代码的功能？这种行为是否记录在案？

```
import java.util.*;

import com.hp.hpl.jena.rdf.model.*;
import com.hp.hpl.jena.reasoner.rulesys.*;

/**
 * Describe class <code>RuleTest</code> here.
 */
public class RuleTest {
    public static void main(String[] args) throws Exception {
        /* create model */
        Model model = ModelFactory.createDefaultModel();

        /* output model */
        System.out.println("original model : " + model);
        System.out.println("-----");

        /* collect rules */
        List<Rule> rules = new ArrayList<Rule>();
        Rule rule = Rule.parseRule("[ (subject predicate object) -> (object predicate subject) ].");
        rules.add(rule);

        /* create rule reasoner */
        GenericRuleReasoner reasoner = new GenericRuleReasoner(rules);

        /* attach reasoner to model */
        InfModel infModel = ModelFactory.createInfModel(reasoner, model);

        /* output model */
        //-----------------------------------------------//
        // commenting the following line in/out changes  //
        // the output of (*) below in Jena 2.5.5 ?!?!?!  //
        //-----------------------------------------------//
        //System.out.println("inference model: " + infModel);        
        System.out.println("=====");

        /* add facts to original model */
        Resource s = model.createResource("subject");
        Property p = model.createProperty("predicate");
        RDFNode  o = model.createResource("object");
        Statement stmt = model.createStatement(s, p, o);
        model.add(stmt);

        /* output models */
        System.out.println("original model : " + model);
        System.out.println("-----");
        System.out.println("inference model: " + infModel); // (*)
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T21:00:06.320

快速浏览了相关来源，您似乎有两个选择：

*   如果您想对基本*模型*进行更改，然后确保它们传播到*infModel*，那么您必须在进行更改之后调用*infModel.rebind()*并且在“询问” *infModel*任何内容之前。

*   您可以直接使用*infModel*（而不是*model*）来创建和添加语句的元素和语句本身。

我知道这并不能直接回答您的问题，但它可能会解决您的问题（顺便说一句，这似乎是由 ModelCom 中的 toString() 方法触发的具体化引起的*- InfModel**的*父*类*）。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-24T16:48:40.803

现在是几年后的事了，Jena 在 2.10.x 系列中。当指示的行被注释掉时，您的程序的输出是：

```
original model : <ModelCom   {} | >
-----
=====
original model : <ModelCom   {subject @predicate object} |  [subject, predicate, object]>
-----
inference model: <ModelCom   {object @predicate subject; subject @predicate object} |  [object, predicate, subject] [subject, predicate, object]> 
```

InfModel 的字符串表示包含两个三元组。取消注释该行时，输出为：

```
original model : <ModelCom   {} | >
-----
inference model: <ModelCom   {} | >
=====
original model : <ModelCom   {subject @predicate object} |  [subject, predicate, object]>
-----
inference model: <ModelCom   {subject @predicate object} |  [subject, predicate, object]> 
```

InfModel 的第二个字符串表示只有一个三元组，所以仍然可以观察到差异。（我在此处包含了输出，因为在问题中尚不清楚*观察*到的差异。）

简短的回答是，发生这种情况是因为您偷偷摸摸地进行修改`model`，而没有告诉`infModel`您更改了底层`model`. `infModel.rebind();`为了解决这个问题，你应该在 update 之后添加一个调用`model`。也就是说，您现在将拥有：

```
model.add(stmt);
infModel.rebind(); 
```

当你这样做时，你会在两种情况下得到相同的输出。该行评论为：

```
original model : <ModelCom   {} | >
-----
=====
original model : <ModelCom   {subject @predicate object} |  [subject, predicate, object]>
-----
inference model: <ModelCom   {object @predicate subject; subject @predicate object} |  [object, predicate, subject] [subject, predicate, object]> 
```

未注释该行：

```
original model : <ModelCom   {} | >
-----
inference model: <ModelCom   {} | >
=====
original model : <ModelCom   {subject @predicate object} |  [subject, predicate, object]>
-----
inference model: <ModelCom   {object @predicate subject; subject @predicate object} |  [object, predicate, subject] [subject, predicate, object]> 
```

我的猜测是，编写 InfModel 的字符串表示不会导致执行任何推理，除非尚未执行任何推理，然后打印底层模型，然后打印任何额外的三元组。因此：

*   在第一种情况下（当您`infModel`只打印一次时）它还没有进行任何推理，因此它会咨询`model`并进行适当的推理并获得额外的三元组。然后它打印`model`'s 三元组，然后是推断的三元组。
*   在第二种情况下（当您打印`infModel`两次时），第一次打印`infModel`时，它会咨询`model`并进行一些推断，但`model`它是空的，因此没有额外的三元组，然后它打印`model`的三元组和额外的推断三元组（有没有任何）。然后，第二次`infModel`打印，推理已经执行，所以它打印`model`的三元组（但有一个额外的）和任何推断的三元组（没有，因为没有执行更多的推理）。

`rebind()`在添加三元组后调用 to`model`意味着在第二种情况下，额外的推断三元组在打印时可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T21:07:42.470

model.toString() 很可能有副作用。我没有看过 JENA 的来源，所以我不能确定。

# python - windows下运行快捷方式

> ID：349653
> 
> 赞同：1
> 
> 时间：2008-12-08T14:09:25.420
> 
> 标签：python, windows

以下不起作用，因为它不会等到该过程完成：

```
import subprocess
p = subprocess.Popen('start /WAIT /B MOZILL~1.LNK', shell=True)
p.wait() 
```

知道如何运行快捷方式并等待子进程返回吗？

**编辑：**最初我在我的帖子中尝试这个没有**shell**选项，这导致 Popen 失败。实际上，`start`不是可执行文件，而是 shell 命令。多亏了吉姆，这个问题得到了解决。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-08T14:21:50.277

您将需要调用 shell 以使 subprocess 选项起作用：

```
p = subprocess.Popen('start /B MOZILL~1.LNK', shell=True)
p.wait() 
```

但是，这仍会立即退出（请参阅@R. Bemrose）。

如果`p.pid`包含正确的 pid（我不确定在 windows 上），那么您可以使用[`os.waitpid()`](http://docs.python.org/library/os.html#os.waitpid)等待程序退出。否则你可能需要使用一些 win32 com 魔法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-08T15:24:43.240

cmd.exe 将在 start 启动程序后立即终止。此行为记录在案（在 start /? 中）：

> 如果启用了命令扩展，则通过命令行或 START 命令的外部命令调用更改如下：

...

> 执行 32 位 GUI 应用程序时，CMD.EXE 不会等待应用程序终止，然后返回命令提示符。如果在命令脚本中执行，则不会发生此新行为。

我不确定 /wait 标志如何影响它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T15:01:43.473

注意：我只是在 Jim 的回复上加上一个小技巧。使用“等待”选项启动怎么样？

```
p = subprocess.Popen('start /B MOZILL~1.LNK /WAIT', shell=True)
p.wait() 
```

这应该有效。

# sql-server - 从 sql 脚本创建 mdf 文件

> ID：349655
> 
> 赞同：2
> 
> 时间：2008-12-08T14:10:10.970
> 
> 标签：sql-server, database, visual-studio, refactoring

我在 Visual Studio 2008 的 MVC Web 应用程序项目的 App_Data 文件夹中创建了一个数据库。这会为数据库生成一个 mdf 文件，可以在“服务器资源管理器”选项卡中进行探索。您可以为对数据库所做的更改创建 SQL 脚本。

所以我想知道您如何在 Visual Studio 2008 中将这些 sql 更改脚本运行到 mdf 文件？还是我被迫通过 SQL Management Studio Express 应用程序执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T14:14:28.577

语法是：

```
CREATE DATABASE [databaseName] 
```

这将在您连接的 SQL Server 上创建一个数据库，在标准位置创建具有标准名称的文件。如果您愿意，还有其他选项（[在 MSDN 上描述](http://msdn.microsoft.com/en-us/library/aa258257.aspx)）可以帮助您将数据库文件放在其他地方（包括重命名它们）。

要执行此命令，您需要连接到 SQL 服务器。我推荐[SQL Server Management Studio](http://msdn.microsoft.com/en-us/library/ms174173.aspx)（还有免费的[Express Edition](http://www.microsoft.com/downloads/details.aspx?familyid=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&displaylang=en)）。

当然，您也可以使用[SQLCMD](http://msdn.microsoft.com/en-us/library/ms162773.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T12:15:32.637

您可以做的是创建一个数据库项目* 并将该项目连接到您的数据库。数据库项目可以在新项目对话框的“*其他项目类型/数据库”下找到。*如果您随后将创建脚本放在数据库项目中，您只需在解决方案资源管理器中右键单击脚本并选择运行即可运行它。

*数据库项目仅在[Visual Studio 专业版](http://msdn.microsoft.com/en-us/vstudio/products/cc149003.aspx)及更高版本中可用。

# java - 如何确定摆动分量？

> ID：349657
> 
> 赞同：3
> 
> 时间：2008-12-08T14:12:05.100
> 
> 标签：java, debugging, swing

我有个问题。

我正在研究另一个人的代码，并且有一个带有很多 JSeparators 的 JFrame（他将它们用作“面板”的边框），现在我将它们替换为一个 JBorderedPanel 类，该类遵循整个应用程序的相同边框样式。

问题是他的一些分隔符并不清楚它们在代码中的位置，有很多 jSeparator#，替换为 0 到 999 之间的任何数字。

除了一一测试所有jSeparators之外，有没有办法确定哪个变量对应哪个边框？

在“不要替换它们！”之前 我有义务更换它们。如果可以，我不会这样做。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-08T15:00:35.097

看看[Swing Explorer](https://swingexplorer.dev.java.net/)。这是一个非常方便的摆动调试工具。有一个 Eclipse 插件可以即时检测您的代码并启动。

使用它，您可以查看摆动对象层次结构，右键单击它，然后在另一个窗口中渲染它的任何部分，突出显示每个组件并让您查看它们的边界，以及选择它们。选择后，您可以右键单击树中的组件并打印堆栈跟踪，该堆栈跟踪将引导您到创建该组件的位置...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T15:03:32.843

遍历 JFrame 的子级并将鼠标侦听器添加到其中的每个 JSeparator：

```
public void installListeners (java.awt.Container parent) {
    for (Component child: parent.getComponents()) {
        if (child instanceof JSeparator) {
            child.addMouseListener (...
                hover(event);
            }
        }
        if (child instanceof java.awt.Container) {
            installListeners ((java.awt.Container)child);
        }
    }
} 
```

现在实现`hover()`将事件源与当前类中的所有字段进行比较并打印匹配的字段：

```
public void hover (MouseEvent event) {
    for (Field f: getClass().getFields()) {
        if (f.get(this) == event.getSource()) {
            System.out.println(f.getname());
            break;
        }
    }
} 
```

您将不得不处理大量异常，但基本上就是这样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-08T14:20:22.543

您可以为代码中的每个分隔符[添加颜色](http://www.java2s.com/Tutorial/Java/0240__Swing/CustomizingJSeparatorLookandFeel.htm)（绿色、红色、黄色等），然后查看这些彩色 JSeparator 最终显示在您的应用程序中的什么位置...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-08T14:19:00.797

您可以`MouseListener`在每个`JSeparator`. 当鼠标进入其区域时，将其背景变为红色并打印一条标识对象的行，最好打印其变量名。这可能需要您更改构造函数调用，但您的 IDE 应该支持您这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-08T14:31:28.150

我猜前面的人使用了某种 GUI 编辑器。

我的第一次尝试将是 Netbeans 或 Eclipse 中的 GUI 编辑器。他们可能能够正确解析和渲染它，除非代码真的很丑。

如果它可以打开，您可以通过在 UI 上选择它们来跟踪它们的位置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T14:37:18.653

在这里，我喜欢你的两个想法，但是所有的 jSeparator 都是这样初始化的：

> > ```
> > public JSeparator getJSeparatorArvore01() {
> >     if (jSeparatorArvore01 == null) {
> >         jSeparatorArvore01 = new JSeparator();
> >         jSeparatorArvore01.setLocation(new Point(14, 38));
> >         jSeparatorArvore01.setSize(new Dimension(72, 10));
> >     }
> >     return jSeparatorArvore01;
> > } 
> > ```
> > 
> > 如何在不花费 24 小时的情况下在 50 多个 jSeparator 上添加鼠标侦听器（或不同颜色）？:(

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T10:35:44.837

我建议您不要过多使用边框。边框可能是 GUI 历史上被滥用最多的组件。最初它旨在将一组非常小的相关组件组合在一起，通常是复选框或单选按钮。然后有人发明了标题边框，它变成了懒惰的程序员命名部分的方式，理想情况下应该使用标签和空格来完成。

边框只会添加视觉噪音而不是预期的分隔。少即是多。

# .net - String.Format 与否？

> ID：349659
> 
> 赞同：7
> 
> 时间：2008-12-08T14:12:17.910
> 
> 标签：.net, coding-style, format, string.format

# 复制自：[字符串输出：C# 中的格式或连接？](https://stackoverflow.com/questions/16432/c-string-output-format-or-concat)

尤其是在 C# 世界中，对所有内容使用 String.Format 非常普遍，通常作为 VB.NET 开发人员，除非我必须*我不使用 String.Format，

我更喜欢普通的字符串连接，例如：

```
V1 = V2 & "test-x" & V3 & "-;" 
```

对我来说这比这更好：

```
V1 = String.Format("{0} test-x {1} -;", V2, V3) 
```

我错过了什么吗？或者这只是个人喜好？

**使用 String.Format 的原因（来自答案）**（*我会尽量保持最新*）

*   如果您使用字符串格式，本地化会容易得多
*   显然更改输入格式更容易
*   它更具可读性（*但这是个人的*）
*   更好的性能

**有时我需要动态更改样式或替换内容，然后我使用 String.Format*

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-08T14:19:20.033

如果您要本地化您的应用程序（并且通常很难在一开始就排除这种情况），那么 String.Format 是首选，原因有两个：

1.  您只有一个字符串文字要翻译
2.  您可以更改值的顺序，这在另一种语言中可能更有意义。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-08T14:22:57.857

每个人都发布了关于 string.format 的可读性（我接受，它具有 null ref 和国际化好处是的），但没有人提到它比简单的*字符串*连接（少量元素）或使用 StringBuilder（大量连接）。

如果性能很重要，或者您正在执行大量操作（因此性能很快*就会*很重要），那么您应该避免格式化。

编辑：根据要求提供参考；）

[http://msmvps.com/blogs/jon_skeet/archive/2008/10/06/formatting-strings.aspx](http://msmvps.com/blogs/jon_skeet/archive/2008/10/06/formatting-strings.aspx)

[http://blog.briandicroce.com/2008/02/04/stringbuilder-vs-string-performance-in-net/](http://blog.briandicroce.com/2008/02/04/stringbuilder-vs-string-performance-in-net/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-08T14:15:55.857

Karl Seguin 的好文章：[代码更好 - 使用 string.format](http://codebetter.com/blogs/karlseguin/archive/2006/04/10/142602.aspx)解释一些好处。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-08T14:16:40.880

第一种方法很难阅读，而且打字更无聊。同样，一旦您开始进行大量此类连接，就需要考虑性能方面的考虑。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-08T14:17:13.687

如果您实际上是在格式化值（{0:d} 等），则 String.Format 比字符串连接好得多。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-08T14:18:32.157

对我来说，这取决于内容。连接字符串确实会创建额外的字符串对象（因为[字符串在 .NET 中是不可变的](http://channel9.msdn.com/forums/TechOff/58729-Why-are-string-types-immutable-in-C/)），但主要是可读性问题。

有时，当您想在字符串中放置换行符时，它会变得复杂，在这种情况下，我倾向于使用类似的东西：

```
StringBuilder.AppendLine(string.Format("Some text {0}.", "here")); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-08T14:15:02.053

我个人发现 String.Format 更容易阅读，字符串显示为一个连续的文本。这取决于有多少参数，如果您需要寻找正确的参数来理解它，那么......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-08T14:20:35.817

我相信它更多的是一个偏好问题。但是，一旦我开始定期使用它，我的大多数团队都会效仿。当我们讨论它时，一致认为它更容易理解和阅读。

# sql-server - 在 SQL Server Management Studio 中删除记住的登录名和密码列表

> ID：349668
> 
> 赞同：271
> 
> 时间：2008-12-08T14:14:10.277
> 
> 标签：sql-server, security, login, ssms

我最近在维修我的公司时使用了我们公司的备用笔记本电脑（具有一般用户设置）。登录数据库时，我已经检查了 SQL Server Management Studio 中的“记住密码”选项。

我需要清除我使用的登录名和密码信息，以防止下一个使用笔记本电脑的人使用我的登录名和密码。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：361
> 
> 时间：2009-08-03T04:43:57.923

此处的另一个答案还提到自 2012 年以来，您可以通过[如何从“连接到服务器”对话框中删除缓存的服务器名称来删除删除缓存的登录名？](https://stackoverflow.com/questions/10993861/how-to-remove-cached-server-names-from-the-connect-to-server-dialog). 刚刚确认 MRU 列表中的此删除在 2016 年和 2017 年工作正常。

SQL Server Management Studio **2017**删除文件 `C:\Users\%username%\AppData\Roaming\Microsoft\SQL Server Management Studio\14.0\SqlStudio.bin`

SQL Server Management Studio **2016**删除文件 `C:\Users\%username%\AppData\Roaming\Microsoft\SQL Server Management Studio\13.0\SqlStudio.bin`

SQL Server Management Studio **2014**删除文件 `C:\Users\%username%\AppData\Roaming\Microsoft\SQL Server Management Studio\12.0\SqlStudio.bin`

SQL Server Management Studio **2012**删除文件 `C:\Users\%username%\AppData\Roaming\Microsoft\SQL Server Management Studio\11.0\SqlStudio.bin`

SQL Server Management Studio **2008**删除文件 `C:\Users\%username%\AppData\Roaming\Microsoft\Microsoft SQL Server\100\Tools\Shell\SqlStudio.bin`

SQL Server Management Studio **2005**删除文件 - 与上述答案相同，但 Vista 路径。 `C:\Users\%username%\AppData\Roaming\Microsoft\Microsoft SQL Server\90\Tools\Shell\mru.dat`

这些是 Vista / 7 / 8 的配置文件路径。

编辑：

注意，`AppData`是隐藏文件夹。您需要在资源管理器中显示隐藏文件夹。

编辑：您可以简单地从服务器/用户名下拉菜单中按删除（确认适用于 SSMS v18.0）。[来自https://blog.sqlauthority.com/2013/04/17/sql-server-remove-cached-login-from-ssms-connect-dialog-sql-in-sixty-seconds-049/](https://blog.sqlauthority.com/2013/04/17/sql-server-remove-cached-login-from-ssms-connect-dialog-sql-in-sixty-seconds-049/)的原始来源，其中提到此功能自 2012 年起可用！

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2019-04-30T05:50:33.517

这适用于 SQL Server Management Studio v18.0

文件“SqlStudio.bin”似乎不再存在。相反，我的设置都存储在这个文件中：

`C:\Users\*********\AppData\Roaming\Microsoft\SQL Server Management Studio\18.0\UserSettings.xml`

*   在 Notepad++ 等任何文本编辑器中打开它
*   ctrl+f 删除用户名
*   `<Element>.......</Element>`然后删除它周围的整个块。

**编辑：** 对于 v18.0（预览版 7），一个更简单且有效的解决方案是：

*   转到“连接到服务器”对话窗口：

    [![在此处输入图像描述](https://i.stack.imgur.com/UQPOz.png)](https://i.stack.imgur.com/UQPOz.png)

*   单击屏幕截图中标记为绿色的向下箭头图标。

*   使用键盘上的箭头键向上/向下导航

*   按键盘上的 DEL 键删除条目。

*   关闭对话窗口，当你重新打开它时，条目确实会被删除。

希望能帮助到你 ：-）

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2013-06-04T15:51:52.717

对于那些寻找 SSMS 2012 解决方案的人......请参阅此答案：

[删除缓存登录 2012](https://stackoverflow.com/questions/10993861/how-to-remove-cached-login-from-the-connect-to-server-dialog-in-sql-server-2012)

本质上，在 2012 年，您可以从服务器列表下拉列表中删除该服务器，这会清除该服务器的所有缓存登录。

也适用于 v17（内部版本 14.x）。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2018-09-07T18:02:13.080

在我的场景中，我只想从列表中删除一个特定的用户名/密码，该列表有许多我不想忘记的其他已保存连接。事实证明，`SqlStudio.bin`其他人在这里讨论的文件是`Microsoft.SqlServer.Management.UserSettings.SqlStudio`该类的 .NET 二进制序列化，可以对其进行反序列化、修改和重新序列化以修改特定设置。

为了完成特定登录的删除，我创建了一个新的 C# .Net 4.6.1 控制台应用程序并添加了对位于以下 dll 中的命名空间的引用：（`C:\Program Files (x86)\Microsoft SQL Server\130\Tools\Binn\ManagementStudio\Microsoft.SqlServer.Management.UserSettings.dll`您的路径可能会因 SSMS 版本而略有不同）

从那里我可以轻松地根据需要创建和修改设置：

```
using System.IO;
using System.Runtime.Serialization.Formatters.Binary;
using Microsoft.SqlServer.Management.UserSettings;

class Program
{
    static void Main(string[] args)
    {
        var settingsFile = new FileInfo(@"C:\Users\%username%\AppData\Roaming\Microsoft\SQL Server Management Studio\13.0\SqlStudio.bin");

        // Backup our original file just in case...
        File.Copy(settingsFile.FullName, settingsFile.FullName + ".backup");

        BinaryFormatter fmt = new BinaryFormatter();

        SqlStudio settings = null;

        using(var fs = settingsFile.Open(FileMode.Open))
        {
            settings = (SqlStudio)fmt.Deserialize(fs);
        }

        // The structure of server types / servers / connections requires us to loop
        // through multiple nested collections to find the connection to be removed.
        // We start here with the server types

        var serverTypes = settings.SSMS.ConnectionOptions.ServerTypes;

        foreach (var serverType in serverTypes)
        {
            foreach (var server in serverType.Value.Servers)
            {
                // Will store the connection for the provided server which should be removed
                ServerConnectionSettings removeConn = null;

                foreach (var conn in server.Connections)
                {
                    if (conn.UserName == "adminUserThatShouldBeRemoved")
                    {
                        removeConn = conn;
                        break;
                    }
                }

                if (removeConn != null)
                {
                    server.Connections.RemoveItem(removeConn);
                }
            }
        }

        using (var fs = settingsFile.Open(FileMode.Create))
        {
            fmt.Serialize(fs, settings);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2020-03-31T15:22:50.137

使用更新版本的 SQL Server Management Studio（我使用的是 18.4）有一种非常简单的方法来执行此操作

1.  打开“连接到服务器”对话框
2.  单击“服务器名称”下拉菜单，使其打开
3.  按键盘上的向下箭头突出显示服务器名称
4.  按键盘上的删除

登录没了！不要乱用 dll 或 bin 文件。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-05-24T14:00:46.743

正如 gleckcks 指出的那样，`SqlStudio.bin`在**Microsoft SQL Server Management Studio 18**中不再存在。我`UserSettings.xml`也在`C:\Users\userName\AppData\Roaming\Microsoft\SQL Server Management Studio\18.0`. 但是删除`<Element>`包含凭据似乎不起作用，如果我关闭并重新打开它，它会立即返回 xml 文件。

事实证明，您需要先**关闭 SQL Server Management Studio**，然后`UserSettings.xml`在您喜欢的编辑器（例如 Visual Studio Code）中编辑文件。我猜它除了这个xml文件之外还缓存在SSMS中的某个地方？！而且它没有打开`Control Panel\All Control Panel Items\Credential Manager\Windows Credentials`。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-07-21T22:22:18.257

从 XML 文件中删除整个节点“元素”（在“连接”树中），由版本 18 或更高版本使用。

C:\Users\%username%\AppData\Roaming\Microsoft\SQL Server Management Studio\18.0\UserSettings.xml

[![在此处输入图像描述](https://i.stack.imgur.com/FNuKk.png)](https://i.stack.imgur.com/FNuKk.png)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-01-13T08:04:57.447

对于 SQL Server Management Studio 2008

1.  你需要去**C:\Documents and Settings\%username%\Application Data\Microsoft\Microsoft SQL Server\100\Tools\Shell**

2.  删除**SqlStudio.bin**

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-08T14:18:42.827

删除：

C:\Documents and Settings\%你的用户名%\Application Data\Microsoft\Microsoft SQL Server\90\Tools\Shell\mru.dat"

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-05-28T09:56:10.000

在 XP 中，.mru.dat 文件位于 C:\Documents and Settings\Name\Application Data\Microsoft\Microsoft SQL Server\90\Tools\ShellSEM

但是，删除它不会做任何事情。

要在 XP 中删除列表，请从 C:\Documents and Settings\Name\Application Data\Microsoft\Microsoft SQL Server\100\Tools\Shell 中剪切 sqlstudio bin 文件并将其粘贴到桌面上。

试试 SQL

如果成功，则从桌面删除 sqlstudio bin 文件。

简单的 ：）

# java - RMI、EJB 和回调

> ID：349693
> 
> 赞同：4
> 
> 时间：2008-12-08T14:19:36.177
> 
> 标签：java, jakarta-ee, ejb, rmi, callback

客户端是否可以将 RMI 对象作为参数传递给 EJB，以便 EJB 可以回调客户端？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T14:41:16.027

您需要将调用中的连接详细信息传递给 EJB，并让 EJB 与客户端 RMI 服务器建立连接。

我的建议是对异步行为使用消息传递和临时队列，这听起来像是您正在尝试实现的...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T14:37:14.410

不可以。远程对象不能被序列化并移动到其他位置，因为与远程对象本身的连接本质上是瞬态的。

可以使用某种可以序列化的包装对象，一旦发送到 EJB 就会重新建立 RMI 连接。

# bash - Bash 字符串处理（索引和连接处的字符）

> ID：349702
> 
> 赞同：4
> 
> 时间：2008-12-08T14:23:23.130
> 
> 标签：bash, string

我正在尝试学习 bash 字符串处理。如何创建与此 Java 代码片段等效的 bash 脚本？

```
String symbols = "abcdefg12345_";
for (char i : symbols.toCharArray()) {
    for (char j : symbols.toCharArray()) {
        System.out.println(new StringBuffer().append(i).append(j));
    }
} 
```

上述代码片段的输出以：

```
aa
ab
ac
ad
ae
af 
```

并以：

```
_g
_1
_2
_3
_4
_5
__ 
```

我的目标是列出允许的字符（不一定是上面的字符）并打印出长度为 2 的所有排列。如果可能的话，我想要一个完全依赖 bash 并且不需要安装任何其他东西的解决方案。

**编辑：**只是一个小小的后续问题：有没有办法用一个没有空格分隔子字符串的字符串来做到这一点？喜欢 LIST="abcdef12345_"？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-08T14:28:07.987

这很简单，Bash 在输入解析器中完成。无需代码。尝试：

```
echo {a,b,c,d,e,f,g,1,2,3,4,5,_}{a,b,c,d,e,f,g,1,2,3,4,5,_} 
```

不过，您可能需要第二遍才能将其分成几行。

或者，您当然可以使用几个嵌套循环，例如您的示例：

```
LIST="a b c d e f 1 2 3 4 5 _";
for a in $LIST ; do
    for b in $LIST ; do
        echo $a$b;
    done;
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T14:28:41.963

```
for i in a b c d e f g 1 2 3 4 5 _; do
    for j in a b c d e f g 1 2 3 4 5 _; do
        echo $i$j
    done
done 
```

`man bash`是你的朋友。它在变量替换和内部命令上有很大的部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T15:27:09.117

非常适合一行：

```
 for i in `echo {a,b,c,d,e,f,g,1,2,3,4,5,_}{a,b,c,d,e,f,g,1,2,3,4,5,_}`; do echo $i; done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T15:38:09.233

只是如何拆分生成的项目的一些变化。就个人而言，我喜欢`tr`用于这项工作。：

```
echo {a,b,c,d,e,f,g,1,2,3,4,5,_}{a,b,c,d,e,f,g,1,2,3,4,5,_} | tr " " "\n" 
```

# jquery - jQuery中元素的总宽度（包括填充和边框）

> ID：349705
> 
> 赞同：165
> 
> 时间：2008-12-08T14:24:27.620
> 
> 标签：jquery, dimensions

在主题中，如何使用 jQuery 获取元素的总宽度，包括其边框和填充？我有 jQuery 维度插件，并`.width()`在我的`760px-wide`, `10px padding`DIV 上运行返回`760`。

也许我做错了什么，但如果我的元素表现为`780 pixels wide`并且 Firebug 告诉我它上面有`10px padding`，但调用`.width()`只给出 760，我很难知道如何。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：219
> 
> 时间：2008-12-08T14:30:59.040

**[更新]**

最初的答案是在 jQuery 1.3 之前编写的，当时存在的函数本身不足以计算整个宽度。

现在，正如[JP](https://stackoverflow.com/questions/349705/total-width-of-element-including-padding-and-border-in-jquery/673622#673622)正确指出的那样，jQuery 具有函数[outerWidth](http://docs.jquery.com/CSS/outerWidth)和[outerHeight](http://docs.jquery.com/CSS/outerHeight) ，默认情况下包括`border`and ，如果函数的第一个参数是`padding``margin``true`

* * *

**[原答案]**

该`width`方法不再需要`dimensions`插件，因为它已添加到`jQuery Core`

您需要做的是获取该特定 div 的填充、边距和边框宽度值，并将它们添加到`width`方法的结果中

像这样的东西：

```
var theDiv = $("#theDiv");
var totalWidth = theDiv.width();
totalWidth += parseInt(theDiv.css("padding-left"), 10) + parseInt(theDiv.css("padding-right"), 10); //Total Padding Width
totalWidth += parseInt(theDiv.css("margin-left"), 10) + parseInt(theDiv.css("margin-right"), 10); //Total Margin Width
totalWidth += parseInt(theDiv.css("borderLeftWidth"), 10) + parseInt(theDiv.css("borderRightWidth"), 10); //Total Border Width 
```

*拆分为多行以使其更具可读性*

这样，即使您从 css 更改填充或边距值，您也将始终获得正确的计算值

* * *

## 回答 #2

> 赞同：187
> 
> 时间：2009-03-23T14:41:06.433

任何其他偶然发现这个答案的人都应该注意，jQuery now (>=1.3) 有**`outerHeight`**/**`outerWidth`**函数来检索包括填充/边框在内的宽度，例如

```
$(elem).outerWidth(); // Returns the width + padding + borders 
```

要包括边距，只需传递**`true`**：

```
$(elem).outerWidth( true ); // Returns the width + padding + borders + margins 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-04-09T03:10:32.663

看起来 outerWidth 在最新版本的 jquery 中被破坏了。

差异发生在

外部 div 是浮动的，内部 div 设置了宽度（小于外部 div）内部 div 有 style="margin:auto"

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-26T21:22:01.603

为简单起见，我在一些函数中封装了 Andreas Grech 上面的出色答案。对于那些想要一点剪切和粘贴幸福的人。

```
function getTotalWidthOfObject(object) {

    if(object == null || object.length == 0) {
        return 0;
    }

    var value       = object.width();
    value           += parseInt(object.css("padding-left"), 10) + parseInt(object.css("padding-right"), 10); //Total Padding Width
    value           += parseInt(object.css("margin-left"), 10) + parseInt(object.css("margin-right"), 10); //Total Margin Width
    value           += parseInt(object.css("borderLeftWidth"), 10) + parseInt(object.css("borderRightWidth"), 10); //Total Border Width
    return value;
}

function  getTotalHeightOfObject(object) {

    if(object == null || object.length == 0) {
        return 0;
    }

    var value       = object.height();
    value           += parseInt(object.css("padding-top"), 10) + parseInt(object.css("padding-bottom"), 10); //Total Padding Width
    value           += parseInt(object.css("margin-top"), 10) + parseInt(object.css("margin-bottom"), 10); //Total Margin Width
    value           += parseInt(object.css("borderTopWidth"), 10) + parseInt(object.css("borderBottomWidth"), 10); //Total Border Width
    return value;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-18T16:41:52.417

相同的浏览器可能会返回边框宽度的字符串，在此 parseInt 将返回 NaN，因此请确保将值正确解析为 int。

```
 var getInt = function (string) {
            if (typeof string == "undefined" || string == "")
                return 0;
            var tempInt = parseInt(string);

            if (!(tempInt <= 0 || tempInt > 0))
                return 0;
            return tempInt;
        }

        var liWidth = $(this).width();
        liWidth += getInt($(this).css("padding-left"));
        liWidth += getInt($(this).css("padding-right"));
        liWidth += getInt($(this).css("border-left-width"));
        liWidth += getInt($(this).css("border-right-width")); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-24T15:27:48.683

```
$(document).ready(function(){     
$("div.width").append($("div.width").width()+" px");
$("div.innerWidth").append($("div.innerWidth").innerWidth()+" px");   
$("div.outerWidth").append($("div.outerWidth").outerWidth()+" px");         
});

<div class="width">Width of this div container without including padding is: </div>  
<div class="innerWidth">width of this div container including padding is: </div> 
<div class="outerWidth">width of this div container including padding and margin is:     </div> 
```

# asp.net-mvc - 选择哪一个：ASP.NET MVC 还是 RESTful WCF？

> ID：349717
> 
> 赞同：17
> 
> 时间：2008-12-08T14:29:59.433
> 
> 标签：asp.net-mvc, wcf, rest

使用 ASP.NET MVC，通常使用 AJAX 代码（例如 jQuery）从服务器调用 Web 服务而不需要刷新页面。使 Web 服务 RESTful 是很自然的。似乎有两条路可以走。首先，ASP.NET MVC URI 是 RESTful 的，很容易让一些 Controller/Action 充当 Web 服务方法。其次，从 3.5 版开始，WCF 可以是 RESTful 的。

那么，这两种方式的优缺点是什么？

对 ASP.NET MVC 的请求将通过 ASP.NET 管道。这是否使它比 WCF 慢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-08T19:35:24.793

如果您已经在网站的其余部分使用 ASP.Net MVC，我想对 AJAX 调用也使用相同的框架是有意义的。

关于 ASP.Net 管道，我假设您担心整个页面生命周期。仅当您将视图与 WebFormViewEngine 一起使用时，才会执行页面生命周期。该框架提供了[JsonResult](http://geekswithblogs.net/michelotti/archive/2008/06/28/mvc-json---jsonresult-and-jquery.aspx)以便于对操作结果进行 JSON 序列化，这完全绕过了 ASP.Net 页面生命周期。类似的类可用于 XML、RSS 等。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-21T00:02:08.520

在我的博客[http://shouldersofgiants.co.uk/Blog/](http://shouldersofgiants.co.uk/Blog/)上，如果有帮助的话，我已经整理了一个关于使用 ASP.Net MVC 提供 RESTful Web 服务的系列。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-15T22:32:56.213

您必须将 AJAX 调用与 REST API 区分开来，因为 AJAX 调用是在应用程序的上下文中进行的，并且可以依赖应用程序上下文进行会话、身份验证等操作。但是，REST API 是您为消费的世界 - 因为它可以依赖您的应用程序进行身份验证等事情，它为保护来自客户的呼叫等带来了全新的复杂性。

如果您只需要应用程序的 JS 与服务器通信，那么使用 MVC 控制器是最简单直接的解决方案。

如果您希望这些 API 与您网站的 MVC 代码分离（出于部署目的等），或者您需要一个 REST API 供其他人使用来调用您的应用程序 - WCF。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-05T17:29:18.033

使用 WCF 堆栈的另一个优点是可以使用 WCF 数据服务/ODATA（[规范](http://odata.org)、[演示](http://live.visitmix.com/MIX10/Sessions/FT12)）在几下鼠标单击的情况下公开 CRUD 和数据探索所需的所有接口，前提是您使用实体框架实现了数据层。

我正在考虑将这些基本的 RAD 接口与使用常规 MVC 构建的更复杂的事务服务的附加层结合起来。这种组合似乎不太优雅，但就生产力而言，它可能是有益的。

# entity-framework - ADO.NET Entity Framework：ORM 解决方案之间的决策

> ID：349718
> 
> 赞同：11
> 
> 时间：2008-12-08T14:30:35.487
> 
> 标签：entity-framework, orm

在选择 ORM 时，我正在为我的新应用程序寻找一些指南。我想通过 NHibernate 和 LINQ to SQL 评估 EF。我需要来自这个美妙社区的专家声音。您可以评估以下几点。

1.  可扩展性
2.  学习曲线
3.  便于使用
4.  性能等。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-08T14:45:41.913

好吧，在您列出的三个中，NHibernate 是最长的。如果您想使用具有良好记录的东西，那可能是一个安全的起点。

它在四个指标（规模/学习曲线/易用性和性能）上相当均匀，尽管您可能会发现有更多可用信息，因为它比其他两个更长。

LINQ to SQL 的发布时间比实体框架长，但仅针对 SQL Server 风格运行。它作为一个适合用途的 ORM 工作得很好，但不像实体框架（它提供 eSql 等）那样功能丰富。

LINQ to SQL 非常容易掌握（取决于您对 LINQ 的了解），并且最近生成的查询的质量有所提高（自早期的 beta 版本以来）。我不确定它的扩展性或性能如何，但您必须认为它与普通开发人员的手写 T-SQL 相当（好吧，现在这是一个疯狂的假设！）。它非常简单，并在 Visual Studio 中为您生成了一个非常好的模型。

非 SQL Server 数据库支持还有其他[(2) 个替代方案](http://www.devart.com/dotconnect/linq.html)

实体框架是三者中最新的，因此仍有一些问题需要纠正（希望在下一个版本中）。它将与许多提供程序一起使用（不限于 SQL Server），并且具有额外的优点，例如 eSQL 和[(1) Table-Per-Type 继承](http://msdn.microsoft.com/en-us/data/cc765425.aspx)。一开始学习可能有点棘手，但是一旦你用它完成了一两个解决方案，它就会变得可预测并且更容易实现。

由于它是最新的，它在学习曲线方面需要更多的时间（还有更多要学习的东西），而且性能......（目前）不太理想，但它确实提供了一些有趣的好处（尤其是支持多个提供商）。

我想我的回答是——你只是在评估还是需要产生一个可行的（生产就绪的）ORM 解决方案？

实体框架可能还没有完全准备好进行严肃的生产工作（在较小的解决方案之外），这让您只能使用 LINQ to SQL 或 NHibernate。如果您只打算使用 SQL Server 数据库，LINQ to SQL 是一个有趣的选择。否则，NHibernate 可能是认真工作的最佳选择。

(1) [ [http://msdn.microsoft.com/en-us/data/cc765425.aspx](http://msdn.microsoft.com/en-us/data/cc765425.aspx) ] (2) [ [http://www.devart.com/dotconnect/linq.html](http://www.devart.com/dotconnect/linq.html) ]

# c# - 您何时使用 StringBuilder.AppendLine/string.Format 与 StringBuilder.AppendFormat？

> ID：349724
> 
> 赞同：60
> 
> 时间：2008-12-08T14:32:18.867
> 
> 标签：c#, .net, formatting, stringbuilder

最近[出现了一个](https://stackoverflow.com/questions/349659/stringformat-or-not)关于使用 String.Format() 的问题。我的部分回答包括使用 StringBuilder.AppendLine(string.Format(...)) 的建议。Jon Skeet 认为这是一个不好的例子，并建议使用 AppendLine 和 AppendFormat 的组合。

我突然想到，我从来没有真正让自己适应使用这些方法的“首选”方法。我想我可能会开始使用类似以下的东西，但我很想知道其他人使用什么作为“最佳实践”：

```
sbuilder.AppendFormat("{0} line", "First").AppendLine();
sbuilder.AppendFormat("{0} line", "Second").AppendLine();

// as opposed to:

sbuilder.AppendLine( String.Format( "{0} line", "First"));
sbuilder.AppendLine( String.Format( "{0} line", "Second")); 
```

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-12-08T14:37:25.377

我认为`AppendFormat`follow`AppendLine`不仅更具可读性，而且比 call 更高效`AppendLine(string.Format(...))`。

后者创建一个全新的字符串，然后将其批量附加到现有的构建器中。我不会说“那为什么还要使用 StringBuilder 呢？” 但这似乎有点违背 StringBuilder 的精神。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-09-10T21:41:51.730

只需创建一个扩展方法。

```
public static StringBuilder AppendLine(this StringBuilder builder, string format, params object[] args)
{
    builder.AppendFormat(format, args).AppendLine();
    return builder;
} 
```

我喜欢这个的原因：

*   `AppendLine(string.Format(...))`如上所述，不会遭受与 一样多的开销。
*   防止我忘记`.AppendLine()`在最后添加部分（经常发生）。
*   更具可读性（但这更多是一种观点）。

如果您不喜欢将其称为“AppendLine”，则可以将其更改为“AppendFormattedLine”或任何您想要的名称。不过，我喜欢与其他对“AppendLine”的调用一致的所有内容：

```
var builder = new StringBuilder();

builder
    .AppendLine("This is a test.")
    .AppendLine("This is a {0}.", "test"); 
```

只需为您在 StringBuilder 上使用 AppendFormat 方法的每个重载添加其中一个。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-08T18:55:05.420

String.format 在内部创建一个 StringBuilder 对象。通过做

```
sbuilder.AppendLine( String.Format( "{0} line", "First")); 
```

一个额外的字符串生成器实例，它的所有开销都被创建了。

* * *

mscorlib、Commonlauageruntimelibary、System.String.Format 上的反射器

```
public static string Format(IFormatProvider provider, string format, params object[] args)
{
    if ((format == null) || (args == null))
    {
        throw new ArgumentNullException((format == null) ? "format" : "args");
    }
    StringBuilder builder = new StringBuilder(format.Length + (args.Length * 8));
    builder.AppendFormat(provider, format, args);
    return builder.ToString();
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T17:46:22.640

如果性能很重要，请尝试完全避免 AppendFormat()。请改用多个 Append() 或 AppendLine() 调用。这确实使您的代码更大且可读性更低，但它更快，因为不必进行字符串解析。字符串解析比你想象的要慢。

我一般使用：

```
sbuilder.AppendFormat("{0} line", "First");
sbuilder.AppendLine();
sbuilder.AppendFormat("{0} line", "Second");
sbuilder.AppendLine(); 
```

除非性能很关键，否则我会使用：

```
sbuilder.Append("First");
sbuilder.AppendLine(" line");
sbuilder.Append("Second");
sbuilder.AppendLine(" line"); 
```

（当然，如果“First”和“Second”不是字符串文字，这会更有意义）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-08T14:37:37.343

AppendFormat() 比 AppendLine(String.Format()) 更具可读性

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T14:49:47.617

我更喜欢这种结构：

```
sbuilder.AppendFormat("{0} line\n", "First"); 
```

虽然不可否认，要分离换行符有一些话要说。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-08T14:53:15.253

简单地使用真的很糟糕吗

```
sbuilder.AppendFormat("{0} line\n", first); 
```

? 我的意思是，我知道它不是独立于平台或其他什么的，但在 10 个案例中有 9 个可以完成工作。

# .net - 在 VB .NET 中查找并启动 VPN 连接

> ID：349729
> 
> 赞同：2
> 
> 时间：2008-12-08T14:36:07.940
> 
> 标签：.net, vb.net, windows-xp, network-programming

我正在使用[NetworkInterface.GetAllNetworkInterfaces()](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.networkinterface.getallnetworkinterfaces.aspx)来获取 PC 上的所有接口。但是，这似乎只返回“活动”接口。如何在 .NET 中找到“非活动”网络接口，例如未连接的 VPN、禁用的 NIC 等。

我想在“控制面板”->“网络连接”中按他们的名字找到它们。因此，例如，如果我有一个名为“我的工作”的 VPN，我希望能够使用“我的工作”这个名称找到它。

使用 Win32_NetworkAdapterConfiguration 似乎不是一个选项，因为它不会返回“网络连接”中显示的名称（据我所知）。

非常感谢，

RB。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T16:24:18.703

好的，这是我用来检测命名 VPN 的一个 hacky 解决方案。如果由于某种原因（包括网络连接断开、VPN 不存在等）无法连接到 VPN，它会抛出错误。

要测试的特定错误代码包括：

> 远程访问错误 800 - 无法建立 VPN 连接。
> VPN 服务器可能无法访问，或者可能没有为此连接正确配置安全参数。
> 
> 远程访问错误 623 - 系统找不到此连接的电话簿条目。

它并没有真正回答我提出的问题（尽管它对于现实生活中的问题来说已经足够好了）。

```
Dim p As New Process

p.StartInfo.UseShellExecute = False
p.StartInfo.RedirectStandardOutput = True
p.StartInfo.RedirectStandardError = True
p.StartInfo.FileName = "rasdial.exe"
p.StartInfo.Arguments = """Company HQ"""
p.Start()
If Not p.WaitForExit(My.Settings.VpnTimeout) Then
    Throw New Exception( _
String.Format("Connecting to ""{0}"" VPN failed after {1}ms", sVpn, My.Settings.VpnTimeout))
End If

If p.ExitCode <> 0 Then
    Throw New Exception( _
String.Format("Failed connecting to ""{0}"" with exit code {1}. Errors {2}", sVpn, p.ExitCode, p.StandardOutput.ReadToEnd.Replace(vbCrLf, "")))
End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T14:50:49.017

这个使用 WMI 的示例可能会帮助您了解大部分情况（顺便说一下关于 C# 的问题！）：

```
using System.Management;

string query = "SELECT * FROM Win32_NetworkAdapterConfiguration";
ManagementObjectSearcher moSearch = new ManagementObjectSearcher(query);
ManagementObjectCollection moCollection = moSearch.Get();

// Every record in this collection is a network interface
foreach (ManagementObject mo in moCollection)
{
    // Do what you need to here....
} 
```

为了测试适配器是否启用，这个链接应该有帮助：

[Win32_NetworkAdapterConfiguration 类](http://msdn.microsoft.com/en-us/library/aa394217.aspx)

编辑：您可能对[Win32_NetworkAdapter](http://msdn.microsoft.com/en-us/library/aa394216(VS.85).aspx)类有更多的运气 - 它具有 Caption 和 Description 属性，*可以*为您提供所需的内容。有一种方法可以将此信息与我提到的上一课联系起来，以获取 IP 地址等 - 如果没有进一步研究，不确定它是什么，但如果您需要知道，请告诉我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T15:46:11.050

```
RasDialer dialer = new RasDialer();
ReadOnlyCollection<RasConnection> connections = dialer.GetActiveConnections();

foreach (RasConnection connection in connections)
{
    // Do what you want to with the connections.
} 
```

这将检索 Windows 正在使用的所有连接的拨号条目（包括 VPN 连接）及其相关句柄和其他信息。

该组件是 CodePlex 上 DotRas 项目的一部分。

[http://www.codeplex.com/DotRas](http://www.codeplex.com/DotRas)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T16:28:28.570

好的-最后的努力:)

[Win32_NetworkConnection](http://msdn.microsoft.com/en-us/library/aa394220(VS.85).aspx)类怎么样- 我很确定这将处理 VPN 连接

# c# - HttpModule 禁用 SharePoint 2003 管理员

> ID：349741
> 
> 赞同：0
> 
> 时间：2008-12-08T14:38:58.807
> 
> 标签：c#, httpmodule, sharepoint-2003

我有一个 Web 部件，其中包含指向例如“管理用户”i SharePoint (2003) 的链接

我还有一个 http 模块，它必须向通过 sharePoint 站点提供的 aspx 页面添加一些 JavaScript。这对于普通用户提供的页面运行良好，但是当单击这些管理页面时，由 Web 部件提供......

有什么问题？如何调整过滤器以允许使用脚本提供这些页面？

Http 模块正在处理此事件：ReleaseRequestState...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-10T09:23:40.737

错误是必须为 60 配置单元中的虚拟目录启用过滤器。失败的页面全部来自 /_layouts/ 文件夹。

也就是说，您必须更新 LAYOUTS 文件夹中的 web.config 并将 dll + 任何引用的 dll 添加到相应的 bin 文件夹中。

# c# - 你如何测试你的 Request.QueryString[] 变量？

> ID：349742
> 
> 赞同：50
> 
> 时间：2008-12-08T14:39:07.853
> 
> 标签：c#, coding-style, tryparse, isnumeric, request.querystring

我经常使用`Request.QueryString[]`变量。

在我的`Page_load`我经常做这样的事情：

```
 int id = -1;

        if (Request.QueryString["id"] != null) {
            try
            {
                id = int.Parse(Request.QueryString["id"]);
            }
            catch
            {
                // deal with it
            }
        }

        DoSomethingSpectacularNow(id); 
```

这一切似乎有点笨拙和垃圾。你怎么处理你`Request.QueryString[]`的s？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-12-08T15:11:00.677

下面是一个扩展方法，可让您编写如下代码：

```
int id = request.QueryString.GetValue<int>("id");
DateTime date = request.QueryString.GetValue<DateTime>("date"); 
```

它`TypeDescriptor`用于执行转换。根据您的需要，您可以添加一个采用默认值而不是引发异常的重载：

```
public static T GetValue<T>(this NameValueCollection collection, string key)
{
    if(collection == null)
    {
        throw new ArgumentNullException("collection");
    }

    var value = collection[key];

    if(value == null)
    {
        throw new ArgumentOutOfRangeException("key");
    }

    var converter = TypeDescriptor.GetConverter(typeof(T));

    if(!converter.CanConvertFrom(typeof(string)))
    {
        throw new ArgumentException(String.Format("Cannot convert '{0}' to {1}", value, typeof(T)));
    }

    return (T) converter.ConvertFrom(value);
} 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-12-08T14:42:01.360

使用 int.TryParse 代替 try-catch 块：

```
if (!int.TryParse(Request.QueryString["id"], out id))
{
  // error case
} 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2010-09-29T19:52:43.993

试试这哥们...

```
List<string> keys = new List<string>(Request.QueryString.AllKeys); 
```

然后，您将能够通过...轻松搜索该人的字符串...

```
keys.Contains("someKey") 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-12-08T14:50:23.137

我正在使用一个小助手方法：

```
public static int QueryString(string paramName, int defaultValue)
{
    int value;
    if (!int.TryParse(Request.QueryString[paramName], out value))
        return defaultValue;
    return value;
} 
```

此方法允许我通过以下方式从查询字符串中读取值：

```
int id = QueryString("id", 0); 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-12-08T14:43:01.840

好吧，一方面使用 int.TryParse 代替......

```
int id;
if (!int.TryParse(Request.QueryString["id"], out id))
{
    id = -1;
} 
```

这假设“不存在”当然应该与“非整数”具有相同的结果。

编辑：在其他情况下，当您无论如何要将请求参数用作字符串时，我认为验证它们是否存在绝对是一个好主意。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-12-08T14:58:24.947

您也可以使用下面的扩展方法并这样做

```
int? id = Request["id"].ToInt();
if(id.HasValue)
{

} 
```

// 扩展方法

```
public static int? ToInt(this string input) 
{
    int val;
    if (int.TryParse(input, out val))
        return val;
    return null;
}

public static DateTime? ToDate(this string input)
{
    DateTime val;
    if (DateTime.TryParse(input, out val))
        return val;
    return null;
}

public static decimal? ToDecimal(this string input)
{
    decimal val;
    if (decimal.TryParse(input, out val))
        return val;
    return null;
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-08T14:44:52.150

```
if(!string.IsNullOrEmpty(Request.QueryString["id"]))
{
//querystring contains id
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-08T14:49:19.440

我确实有每个功能（实际上它是一个小类，有很多静态）：

*   `GetIntegerFromQuerystring(val)`
*   `GetIntegerFromPost(val)`
*   `....`

如果失败，它会返回 -1（*这对我来说几乎总是可以的，我还有一些其他的负数函数*）。

```
Dim X as Integer = GetIntegerFromQuerystring("id")
If x = -1 Then Exit Sub 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-08T14:54:00.540

Eeee 这是一个业力风险......

我有一个 DRY 可单元测试的抽象，因为有太多的查询字符串变量无法在遗留转换中继续使用。

下面的代码来自一个实用程序类，它的构造函数需要一个 NameValueCollection 输入 (this.source)，而字符串数组“keys”是因为旧版应用程序相当有机，并且已经开发出将几个不同的字符串作为潜在输入键的可能性。但是我有点喜欢可扩展性。此方法检查集合中的键并以所需的数据类型返回它。

```
private T GetValue<T>(string[] keys)
{
    return GetValue<T>(keys, default(T));
}

private T GetValue<T>(string[] keys, T vDefault)
{
    T x = vDefault;

    string v = null;

    for (int i = 0; i < keys.Length && String.IsNullOrEmpty(v); i++)
    {
        v = this.source[keys[i]];
    }

    if (!String.IsNullOrEmpty(v))
    {
        try
        {
            x = (typeof(T).IsSubclassOf(typeof(Enum))) ? (T)Enum.Parse(typeof(T), v) : (T)Convert.ChangeType(v, typeof(T));
        }
        catch(Exception e)
        {
            //do whatever you want here
        }
    }

    return x;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-08T14:57:17.803

我实际上有一个实用程序类，它使用泛型来“包装”会话，它为我完成了所有的“繁重的工作”，我也有一些几乎相同的东西用于处理 QueryString 值。

这有助于消除（通常很多）检查的代码重复。

例如：

```
public class QueryString
{
    static NameValueCollection QS
    {
        get
        {
            if (HttpContext.Current == null)
                throw new ApplicationException("No HttpContext!");

            return HttpContext.Current.Request.QueryString;
        }
    }

    public static int Int(string key)
    {
        int i; 
        if (!int.TryParse(QS[key], out i))
            i = -1; // Obviously Change as you see fit.
        return i;
    }

    // ... Other types omitted.
}

// And to Use..
void Test()
{
    int i = QueryString.Int("test");
} 
```

**笔记：**

这显然使用了静态，有些人不喜欢它，因为它会影响测试代码。您可以轻松地重构为基于实例和您需要的任何接口的东西。我只是认为静态示例是最轻的。

希望这有助于/提供思考。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-10-19T19:00:00.663

我修改了 Bryan Watts 的答案，以便如果您要求的参数不存在并且您指定了一个可为空的类型，它将返回 null ：

```
public static T GetValue<T>(this NameValueCollection collection, string key)
    {
        if (collection == null)
        {
            return default(T);
        }

        var value = collection[key];

        if (value == null)
        {
           return default(T);
        }

        var type = typeof(T);

        if (type.IsGenericType && type.GetGenericTypeDefinition() == typeof(Nullable<>))
        {
            type = Nullable.GetUnderlyingType(type);
        }

        var converter = TypeDescriptor.GetConverter(type);

        if (!converter.CanConvertTo(value.GetType()))
        {
            return default(T);
        }

        return (T)converter.ConvertTo(value, type);
    } 
```

您现在可以这样做：

```
Request.QueryString.GetValue<int?>(paramName) ?? 10; 
```

# ruby-on-rails - Ruby on Rails 中的欢迎/主页 - 最佳实践

> ID：349743
> 
> 赞同：84
> 
> 时间：2008-12-08T14:40:16.213
> 
> 标签：ruby-on-rails, ruby

我的主页（或欢迎页面）将包含来自两个模型的数据（我们称它们为作者和帖子）。我是 Rails 新手，不确定实现这一目标的最佳方法是什么。

我是否应该创建一个名为welcome 的新控制器，它从作者和帖子中收集数据，然后在欢迎索引视图中显示它们？或者我应该在从作者那里获取数据的帖子模型下有一个欢迎视图？或任何其他方式来实现这一点？

我了解如何在技术上完成所有这些工作，但不确定使用 rails 框架的最佳实践方法是什么。

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2012-06-12T19:52:13.330

似乎没有一个最佳实践。

**(1)**标准`config/routes.rb`文件似乎建议根页面（或主页/欢迎页面）应由`welcome#index`. 如果您要以此为指导，那么要生成相应的`welcome#index`控制器/动作，您可以使用以下命令：

```
rails generate controller Welcome index 
```

然后，在 中`config/routes.rb`，您可以删除生成器自动添加的 GET 路由（`get "welcome/index"`），并将根路由`root 'welcome#index'`（或`root :to => 'welcome#index'`在 Rails 中`< 4`）放在文件顶部，因为它可能是您最常用的路由，应该首先匹配。

`public/index.html`还记得在 Rails中删除`< 4`。

**(2)**官方的[Ruby on Rails 路由指南](http://guides.rubyonrails.org/routing.html#using-root)使用`PagesController`. 它实际上暗示`pages#main`了，尽管对我来说它更有意义`pages#home`（因为“主页”是无处不在的术语/概念）。此外，此控制器可以处理其他*面向页面的*操作，例如`pages#about`、`pages#contact`、`pages#terms`、`pages#privacy`等。

**(3)** The [Ruby on Rails Tutorial](https://www.railstutorial.org/book/static_pages#sec-static_pages)，与`static_pages#home`and`static_pages#help`等一起使用，虽然我不喜欢用“静态”表示这个控制器的想法。这些页面仍然可能有一些动态方面，尤其是主页！

**(4)**尽管没有讨论如何处理*主页*，[但 RailsCast #117 on Semi-Static Pages](http://railscasts.com/episodes/117-semi-static-pages)提出了另一组仅*显示*资源的方法。

我更喜欢 1 和/或 2。对于“and”场景，您可以使用 welcome#index 和 pages#about 等，而对于“or”场景，您可以使用 pages#home、pages#about、等等。如果被迫选择，我会选择选项 2，因为你最终得到的代码更少。顺便说一句，除了“静态”这个词之外，2 和 3 几乎相同。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2008-12-08T15:02:55.543

问题是，您的主页只是一个登录页面还是一组页面？如果它只是一个登陆页面，你不希望你的用户在那里停留很长时间，除非去其他地方。如果它是一组页面，或者类似于现有组，您可以将一个操作添加到它最喜欢的控制器。

我为当前项目所做的是制作一个名为 的控制器`Static`，因为我需要 3 个静态页面。主页就是其中之一，因为除了去其他地方外，没有什么可看或可做的。

要映射默认路由，请使用以下内容`routes.rb`：

```
# Place at the end of the routing!
map.root :controller => 'MyController', :action => :index 
```

就我而言，这将是：

```
map.root :controller => 'static', :action => :index 
```

如果你愿意，你可以为这个主页创建一个控制器。我将其称为 main，或者您可以记住的与主页相关的东西。从那里您可以获取您的数据和模型，并遵循输出视图。

```
class MainController < ApplicationController
  def index
    @posts = Posts.find(:all, :limit => 10, :order => 'date_posted', :include => :user)
  end
end 
```

假设您正确定义了模型关系，与之匹配的模板将非常简单。

祝你好运，希望这会有帮助。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-12-08T18:23:26.653

当我第一次开始使用 Rails 时，我问过自己这样的问题。以下是您需要了解的内容：

*   模型不一定与控制器和视图直接相关。

也就是说，特定的控制器/视图组合可以与生成该特定页面所需的任意数量的模型一起使用。

控制器的目的是准备您需要显示的数据集，无论使用什么模型来存储该数据。

视图的目的是以最合适的方式显示该数据。

换句话说，控制器/视图组合永远不会“在”特定模型下。他们使用模型，但在任​​何层次关系中都不在模型之下。事实上，他们是他们使用的任何模型的**同行。**

我认为混淆来自 AWDR 和其他介绍性文本中的脚手架生成器示例，例如：

ruby 脚本/生成脚手架模型控制器

我知道模型和控制器/视图之间的这种隐含关系让我有点困惑。但是没有严格的关系，真的。如果有，那么用 MVC 方法做任何复杂的事情都将非常困难。显然，事实并非如此。

希望这可以帮助。

- 约翰

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-12-08T18:03:14.057

最佳做法是您的第一个建议。创建一个“欢迎”控制器并从您想要的任何模型中调用记录。有一个指向该控制器的根路由点。非常干净和适当。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-06-26T19:32:12.763

请注意，在 Rails3 中，处理此问题的正确方法是将以下行添加到 routes.rb 文件的末尾：

```
root :to => "welcome#index" 
```

并删除 public/index.html.erb。

另请注意，welcome#index 对应于 WelcomeController 中的 index 操作，The Wicked Flea 的答案中的代码如下所示：

```
class WelcomeController < ApplicationController
  def index
    @posts = Posts.find(:all, :limit => 10, :order => 'date_posted', :include => :user)
  end
end 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-10-20T02:30:37.293

**这个答案是从 Rails 3.2.1 开始的。**

首先为页面设置一个Controller，例如命名为`static`：

```
$ rails generate controller static 
```

在文件中`app/controllers/static_controller.rb`：

```
class StaticController < ApplicationController
    def index       
    end
end 
```

创建新的视图文件`app/views/index.html.erb`

最后配置你的`config/routes.rb`：

```
MyApp::Application.routes.draw do
   match 'home', :to => "static#index"
   root :to => "static#index"
end 
```

This will make both `/home` and `/` go to whatever you put in the View file you just created.

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-12-08T15:02:37.387

创建一个尽可能适当命名的新控制器。摘要控制器？启动控制器？DailyFrontPage 控制器？你会有一个想法。

不仅如此，我会认真考虑创建一个新模型，*而不是*基于 ActiveRecord，它从您的作者和帖子模型（或任何他们的真实姓名）收集信息，以便在您的视图中呈现。另一种方法是在控制器中组装数据，这几乎肯定会很混乱——每次我都尝试过，而且我尝试了很多次。一个单独的模型似乎最终变得更加整洁。

如果处理比较简单，为什么不先尝试在控制器中构建数据，然后将输出包装在 Struct 中，然后将 Struct 替换为真实类并将构造移到那里，一路重构。它不应该在总时间上增加太多（大部分代码可以重用），你会很好地了解什么最适合你。

# asp.net - 从 Web 服务返回 XElement

> ID：349769
> 
> 赞同：4
> 
> 时间：2008-12-08T14:52:15.847
> 
> 标签：asp.net, web-services, xelement

是否可以从 Web 服务（在 C#/asp.net 中）返回 XElement？

尝试一个返回 XElement 的简单 Web 服务：

```
[WebMethod]
public XElement DoItXElement()
{
  XElement xe = new XElement("hello",
     new XElement("message", "Hello World")
     );

  return xe;
} 
```

这编译得很好，但如果你尝试运行它，你会得到

```
不能在架构的顶层使用通配符。
```

我发现[这篇文章暗示这是](http://blog.bksanders.com/index.php/tag/linq-to-xml/).net中的一个错误。

那么...我可以从 Web 服务返回 XElement 吗？如果是这样，怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-08T15:35:54.807

XElement 的序列化方式似乎存在问题，请[在此处查看](http://www.developersdex.com/csharp/message.asp?p=1111&r=6149937)...

您可以尝试将 XElement 作为字符串输出，或者按照文章的建议，您可以使用类包装器并将 XElement 放入其中。如果要以通用格式输出数据，您将无法返回字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-08T16:23:00.033

我试图避免字符串！

我可以返回一个 XmlNode（从 XElement 创建），它得到了我需要的东西——客户端上的一段 XML。感谢该链接 - 我将进一步调查 XWrapper ......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T16:40:53.370

奇怪的是，这似乎只有在您尝试查看服务的“发现”部分时才会发生 - 您可以毫无问题地运行该方法......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-02T18:57:12.130

返回一个 XmlElement 类型，只需使用此扩展方法将 XElement 转换为 XmlElement：

```
[System.Runtime.CompilerServices.Extension()]
public XmlElement ToXmlElement(XElement value)
{
    var xmlDoc = new XmlDocument();
    xmlDoc.LoadXml(value.ToString());
    return xmlDoc.DocumentElement;
} 
```

这似乎运作良好。

# database - 具有并行非阻塞数据库访问的 Web 脚本语言？

> ID：349773
> 
> 赞同：1
> 
> 时间：2008-12-08T14:54:32.083
> 
> 标签：database, parallel-processing, sharding

我的 webapp 需要使用多个数据库分片，并且偶尔需要并行查询这些分片。是否有任何 Web 脚本语言对并行非阻塞数据库访问具有成熟、稳定的支持？如果是这样，你能指出我正确的方向吗？免费的开源是首选，但我主要想要一些可以工作的东西。

线程对我来说很好，但我不需要真正的多线程支持。我想要的只是对五个不同的数据库服务器进行五个 10 秒的数据库查询需要 10 秒而不是 50 秒。它实际使用了多少 CPU 对我来说并不重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T19:52:15.180

实际上，您似乎不需要并行非阻塞 I/O——您需要并行非阻塞数据库访问，这通常通过不同的 API 处理。

例如，在 Java 中，一般 I/O 是通过 java.io 和 java.net 中的组件处理的，但数据库访问是通过 java.sql 和特定于供应商的驱动程序处理的。类似的特征是其他平台/语言的典型特征。

您的主要问题似乎是实现某种多处理/多线程，您可以从中发出单独的并行数据库访问请求。我建议这是你应该研究的主要领域。

关于该主题有很多可用的材料，但您需要专注于您的特定平台/语言以获得大部分细节。请注意，这在传统上是软件开发的一个非常困难的领域。

向您致以最良好的祝愿...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-02T14:14:16.707

一种可能的解决方法是分割网页，使每个部分只命中一个分片。浏览器应该为每个部分启动一个单独的 AJAX 请求并在客户端构建页面。

此解决方案不依赖于所选语言/框架，但需要在客户端启用 JavaScript。

性能可能会因每个访问者的操作系统、浏览器和设置而异（[更多信息](http://msdn.microsoft.com/en-us/library/cc304129(VS.85).aspx)）。但是，一旦页面每个部分的数据可用，页面就会逐渐呈现。

作为与服务器端解决方案相比的缺点，这种方法将复杂性从服务器转移到客户端 JavaScript，并增加了 Web 服务器的负载。

# macos - Mac OS X 访问具有相同供应商 ID 和不同产品 ID 的设备

> ID：349779
> 
> 赞同：1
> 
> 时间：2008-12-08T14:56:27.133
> 
> 标签：macos, usb

我正在编写一个打开 USB 设备并传输一些数据的应用程序。我正在关注开发人员示例中的 UsbSimpleNotificationExample。该示例为唯一的供应商 ID 和产品 ID 添加通知并分配回调。但是对于我的应用程序，我有多个 PID 和一个 VID。如何添加具有单个 Vid 和多个 PID 的字典条目？如果我将 CFDictionarySetValue 与 2 个 PID 一起使用，则第二个 Pid 调用会覆盖第一个字典值。因此，我无法正确匹配 IOServiceAddMatchingNotification 回调。我可以尝试哪些其他选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T02:13:18.997

为什么不尝试仅添加供应商 ID？

然后您的匹配项应包括所有产品 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-20T15:40:52.943

晚了6年……对不起。

这是你如何做到的：

```
CFMutableDictionaryRef  matchingDict = IOServiceMatching ( kIOUSBDeviceClassName );
if ( matchingDict )
{
    UInt32        usbVendor = k_MyVendorID;
    CFNumberRef   refVendorId = CFNumberCreate ( kCFAllocatorDefault, kCFNumberIntType, &usbVendor );
    CFDictionarySetValue ( matchingDict, CFSTR ( kUSBVendorID ), refVendorId );
    CFRelease ( refVendorID );
    CFDictionarySetValue ( matchingDict, CFSTR ( kUSBProductID ), CFSTR ( "*" ) );   // This is a wildcard, so we find any device.
} 
```

注意通配符。

# reporting-services - 像从特定地址一样通过电子邮件发送 MS Reporting Services 2005 报告

> ID：349786
> 
> 赞同：1
> 
> 时间：2008-12-08T14:59:25.660
> 
> 标签：reporting-services, exchange-server

我们有各种报告服务报告，这些报告计划自动生成报告并将它们通过电子邮件发送到分发列表。这非常有效，但它们似乎来自`MSRepSvc@ourdomain.com`.

这一切都很好，但 PHB 希望他们看起来像是来自`OurGroup@ourdomain.com`. 我们已经设置了一个组，因此 Exchange 允许我们（其中的那些`OurGroup`）使用 From 地址从 Outlook 发送消息`OurGroup`，但我正在努力寻找如何配置 Reporting Services 来执行此操作。

它是服务器范围的配置选项吗？它是用户访问配置文件选项吗？我们是否可以通过使用应用程序附加到 RS 服务器以编程方式完成它（许多报告已经由代码触发）。

**编辑：**我们与其他组共享服务器 - 所以它必须是一个子集或逐个报告的基础。（如果它有所作为，那就是 RS'05，尽管我们正在升级到 '08。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T19:12:10.860

对不起，你不能。

因为它使用 SMTP，所以您受限于协议。该设置在[.config 文件](http://msdn.microsoft.com/en-us/library/ms159155(SQL.90).aspx)中定义，在运行时或在应用程序或报告/订阅中不可配置。

Outlook 使用允许指定“发件人”的 MAPI。

现在，有一些丑陋的解决方法:-)

1.  如果您将报告发送到邮箱，则可以使用规则转发和更改电子邮件。但是，邮箱必须与您可以登录并配置规则的登录名相关联。否则，如果您只是连接到邮箱，则需要运行 Outlook 来应用规则。

2.  多次安装 RS 并在每次安装时配置不同的“发件人”电子邮件。在这种情况下，“FROM”在配置文件中定义。

3.  将电子邮件发送到监控邮箱以进行转发的服务

选项 3 显然是最简洁但投资最多的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T15:04:40.363

您可以使用 Reporting Services 配置管理器（在 SQL Server 2005 开始菜单项的“配置”下可用）配置发件人电子邮件地址。在左侧窗格中，单击“电子邮件设置”标题，然后指定发件人地址。

这是将出现在您正在配置的服务器上生成的所有报告中的地址。我不相信有办法在报告级别指定发件人地址。

HTH。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-08T21:29:21.537

您是使用数据驱动订阅，还是仅使用 RS 中的简单订阅类型来分发您的报告？

我相信通过数据驱动订阅，您可以提供一个自定义表格，其中包含订阅引擎可以用来指定订阅属性的信息，包括报告的参数、收件人列表、格式类型等。它可以让您根据自定义表中的数据指定电子邮件通信的 TO/FROM/SUBJECT 等。检查一下，让我们知道这是否适合您。

干杯。

# java - 您如何组织 java 项目中类路径中可用的非源资源？

> ID：349787
> 
> 赞同：1
> 
> 时间：2008-12-08T14:59:55.817
> 
> 标签：java, resources, classpath, structure

在用 java 编写的软件项目中，您通常有资源，这些资源是项目的一部分，应该包含在类路径中。例如，一些模板或图像，应该可以通过类路径 (getResource) 访问。这些文件应包含在生成的 JAR 文件中。

很明显，这些资源应该添加到修订控制系统中。但是您将这些文件放在哪个目录中？与 java-source-files 并行还是在另一个也重现所需包结构的目录中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-08T15:10:12.690

[Maven](http://maven.apache.org/)将它们放入 src/main/resources/ 中（Java 代码将转到 src/main/java/）。主要原因是 Maven 可以编译各种语言的代码，将它们分开是有意义的，这样一个编译就不会被另一个编译的文件混淆。

在资源的情况下，Maven 将在将它们添加到 Jar 之前替换其中的变量，因此它们也是“编译”源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T15:06:26.333

就个人而言，如果它们与代码的特定部分密切相关并且数量不多，我更愿意将它们与源代码放在一起。

但是，如果这些文件有自己的组织结构是有意义的，或者如果有数百个文件很难在其中找到源代码，我会将它们分开。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-08T15:10:32.643

我更喜欢你的后一种解决方案：一个模仿源代码包结构的单独目录。这样它们就不会破坏您的源代码，而是紧挨着打包的 JAR 文件中已编译的类文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T15:23:33.333

这取决于您的喜好。将它们与源代码文件混合在一起可以更轻松地进行重构，例如重命名包（因为资源与源一起移动），但是如果有多个图标、图像和本地化文件，您会很容易得到一堆杂乱无章的文件。

使用今天的工具，这也无关紧要。无论您使用 Eclipse、Netbeans 还是其他工具，它们都允许您拥有布局与源代码不同的二进制包。所以最后你可以随心所欲地做。

就我个人而言，我尽量避免将源代码与资源混为一谈，因为我通常很少更改资源，但会非常频繁地更改源代码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-08T15:40:39.713

我通常是这样的：

```
project/src
project/resources
project/classes
project/lib
project/dist 
```

*src*和*resources*都具有包结构，构建文件将*类*和*资源*作为放置在*dist*中的 jar 的输入。

在内部运行时，类路径类似于：*lib;classes;resources;*

如果应用程序已安装，则安装程序会创建资源目录并将其原封不动地放置在安装中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T15:25:21.663

如果您的构建工具不会混淆，您可以将这些东西放在类路径中。Eclipse 不会尝试编译您的 jpeg，Ant 也不会，因此无需担心太多。好消息是，如果您有很多相关的东西，您可以将它们放在一起，按功能而不是按文件类型组织。

我们在我工作的地方这样做；我们有需要一些代码和少量静态资源的电子邮件。所有这些东西都保存在 java 源路径中的一个文件夹中；我们可以轻松地从系统中添加和删除电子邮件，而不会忘记某些事情或犯错误，例如 src/resource 路径不匹配或一棵树中的孤立文件不存在于另一棵树中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-07-10T23:45:30.267

如前所述，这取决于您，并且可能因项目而异。例如，使用[Wicket](http://www.wicketframework.org/)`.html` ，将文件保存在类旁边是非常常见和实用的。另外，我经常将一些配置与源代码 - `META-INF`, `WEB-INF`, 日志记录在一起。

要让 Maven 从源代码树中获取资源，请使用以下命令：

```
<build>
   <resources>
     <resource>
         <directory>src/main/resources</directory>
     </resource>
     <!-- Web - Wicket -->
     <resource>
         <filtering>false</filtering>
         <directory>src/main/java</directory>
         <includes><include>**</include></includes>
         <excludes><exclude>**/*.java</exclude></excludes>
     </resource>
  </resources>

  <testResources>
     <testResource>
         <directory>src/test/resources</directory>
     </testResource>
     <!-- Web - Wicket -->
     <testResource>
         <filtering>false</filtering>
         <directory>src/main/java</directory>
         <includes><include>**</include></includes>
         <excludes><exclude>**/*.java</exclude></excludes>
     </testResource>
  </testResources> 
```

保持资源分离的主要原因是（恕我直言）工作角色的分离。例如，如果您有一个包含翻译团队的项目，您将使用与代码分开的字符串和不同的 SCM 权限来保留资源。

# networking - 网络协议模糊测试的框架？

> ID：349791
> 
> 赞同：12
> 
> 时间：2008-12-08T15:01:05.987
> 
> 标签：networking, network-protocols, fuzzing

任何人都可以推荐任何对程序员友好（即可扩展）的框架或系统来执行网络级数据包[模糊测试](http://en.wikipedia.org/wiki/Fuzzing)吗？

我正在寻找这样一个系统，我可以在其中以其他数据包格式进行编程，并以与协议相关的方式破坏这些数据包的各种方式。

我知道如何谷歌。我正在寻找具体的建议:)

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-12-30T12:22:02.917

[Scapy](http://www.secdev.org/projects/scapy/)看起来对程序员很友好。它是用 Python 编写的。

您使用 Python 命令解释器作为其命令解释器。它有非常好的文档。它看起来易于使用和理解。

API 看起来不错；以“pythonic”风格编写。它看起来非常完整，并且正在积极开发中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-08T15:35:51.297

我可以推荐[Sulley 模糊测试框架](http://code.google.com/p/sulley/)。这是一个 python 框架并且擅长它的工作。

如果您想要第 2 层协议模糊测试，请查看 ernw.de 人员的出色工作：

[http://www.ernw.de/download/l2sulley_04-15-08.tar.bz2](http://www.ernw.de/download/l2sulley_04-15-08.tar.bz2)

[http://www.ernw.de/download/l2_fuzzing_shmoo08.pdf](http://www.ernw.de/download/l2_fuzzing_shmoo08.pdf)

您对模糊测试特别感兴趣的协议是什么？

更新：当您以 DNS 为目标时，您应该查看[PROTOS 测试套件](http://www.ee.oulu.fi/research/ouspg/protos/index.html)，尤其是他们的[DNS 模块](http://www.ee.oulu.fi/research/ouspg/protos/testing/c09/dns/index.html)。虽然这是一个封闭源代码的 Java 包，所以你不能像框架一样使用它，但是如果 PROTOS 不够完善，你总是可以编写一个 Sulley 模块来满足你的特定需求。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-10-13T21:32:44.630

您可能对[American Fuzzy Lop](http://lcamtuf.coredump.cx/afl/)和[Preeny 感兴趣](https://github.com/zardus/preeny)。这是一个使用非常简单并采用遗传算法的模糊器，在这种情况下，这意味着它将检测输入位的哪些变化会导致新的代码路径并更加关注这些变化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T15:24:41.397

我只是用谷歌搜索了一下。我从来没有使用过这些。

*   [模糊测试的艺术](http://theartoffuzzing.com/joomla/index.php)
*   [ProxyFuzz](http://theartoffuzzing.com/joomla/index.php?option=com_content&task=view&id=21&Itemid=40)
*   [Sulley 模糊测试框架](http://www.fuzzing.org/category/sulley/)
*   [MalyFuzz](http://sourceforge.net/projects/malybuzz/)
*   [JBroFuzz](http://sourceforge.net/projects/jbrofuzz)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-08T18:13:03.150

我知道 fuzzled 作为一个框架真的很好，如果你喜欢 Perl：[http ://www.securiteam.com/tools/5FP0Q1PKUS.html](http://www.securiteam.com/tools/5FP0Q1PKUS.html)

JborFuzz 和大多数其他 fuzzer 不会这样做，因为它们不是作为框架设计的，当然不是网络级别的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-30T11:02:57.977

建议的答案都不符合我的需求，所以我编写[了自己的模糊 DNS 服务器](https://github.com/raybellis/evldns)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-11-19T13:35:40.107

这是我的建议，主要是因为开发它们的安全组享有盛誉。

*   AutoFuzz ([软件](http://autofuzz.sourceforge.net/)) ([论文](https://people.csail.mit.edu/sergeyg/publications/autofuzz.pdf))
*   SecFuzz ([软件](https://github.com/ptsankov/secfuzz)) ([论文](https://www.inf.ethz.ch/personal/basin/pubs/ast12.pdf))

**Scapy**是一个了不起的工具，但是这些框架使用 Scapy 来做更多的事情。

# ruby-on-rails - 基于客户端的网站的最佳数据库策略（Ruby on Rails）

> ID：349799
> 
> 赞同：5
> 
> 时间：2008-12-08T15:02:44.983
> 
> 标签：ruby-on-rails, ruby, database, activerecord

我已经建立了一个很好的网站系统，可以满足小众市场的需求。去年，我通过使用 Capistrano 将软件的副本部署到我的 Web 服务器来销售这些网站。

在我看来，这些网站的唯一区别是数据库、CSS 文件和用于单个客户图形设计的一小部分图像。

其他一切都完全相同，或者应该是……现在我已经部署了大约 20 个这样的站点，要让它们都使用相同的代码进行更新变得很麻烦。而这个问题只会变得更糟。

我在想我应该重构这个系统，这样我就可以使用一组部署的 ruby​​ 代码，通过传入请求的 URL 动态选择正确的数据库等。

似乎有两种处理数据库的方法：

*   使用多个数据库，每个客户端一个
*   使用一个数据库，每个表中都有一个 client_id 字段，以及一个额外的“客户端”表

多数据库方法目前对我来说是最简单的，因为我不必重构应用程序中的每个模型来将 client_id 字段添加到所有 CRUD 操作。

但是，每次我想迁移数据库时，都必须为数十个或数百个不同的数据库运行“rake db:migrate”会很麻烦。显然这可以通过脚本来完成，但它闻起来不太好。

另一方面，每个客户将在“项目”表中拥有 20K-50K 项目。当 items 表中有 50 万或百万个项目时，我担心全文搜索的速度。即使在 client_id 字段上有索引，我怀疑如果将项目分开到不同的客户端数据库中，搜索会更快。

如果有人对解决这个问题的最佳方法有明智的意见，我非常想听听。非常感谢提前...

- 约翰

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T20:38:49.017

感谢您的精彩评论。我决定采用多数据库方法。这对我来说是最简单的方法，因为我不必重新编写整个应用程序。

我要做的是在application_controller中添加一个before_filter，所以它适用于所有控制器......像这样：

```
before_filter :client_db # 切换到客户端的数据库
```

然后，在 application_controller.rb 中，我将包含如下内容：

```
def client_db
    @client = Client.find(params[:client_id])
    规格 = Client.configurations[RAILS_ENV]
    new_spec = spec.clone
    new_spec["database"] = @client.database_name
    ActiveRecord::Base.establish_connection(new_spec)
  结尾

```

然后，像 example.com?client_id=12345 这样的 URL 将选择正确的数据库。

由于我在 Mongrel 前面使用 Apache 作为代理，Apache 将根据客户端的网站 URL 将正确的 client_id 添加到所有请求中。因此，client_id 实际上并不是用户看到的 URL 的一部分。它只会在 Apache 和 Mongrel 之间传递。我不确定我是否正确解释了这一点，但它可以工作并使事情保持清洁和简单。

如果我决定将来需要使用单个数据库，那么我可以重构所有代码。目前，这似乎是最简单的方法。

有人看到这种方法有什么问题吗？

- 约翰

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T15:17:59.337

使用单独的数据库（包括您已经列出的那些）有以下优点：

*   当您有数百万个大文本块要搜索时，全文搜索会变得很慢（取决于您的服务器的能力）。
*   分离数据库将使每个客户端的表索引速度更快。特别是，如果您接受一个新的大客户，它可能会让您早期采用的一些客户感到不安。突然之间，他们的应用程序将（对他们）没有明显的原因受到影响。同样，如果您保持在硬件的容量之下，这可能不是问题。
*   如果您曾经删除一个客户端，那么仅打包他们的数据库比通过 client_id 删除所有关联的行要稍微干净一些。如果他们以后改变主意，同样干净地恢复它们。
*   如果任何客户要求他们愿意支付的额外功能，您可以在不修改其他任何人的情况下分叉他们的数据库结构。
*   对于悲观主义者：您意外破坏所有客户数据的可能性较小，而不仅仅是一个客户的数据。;)

话虽如此，单数据库解决方案可能更好：

*   您的数据库服务器的功能使大型单表成为非问题。
*   您的客户的数据库保证保持不变。
*   您不必担心为了存档/恢复或发生灾难而将每个人的数据分开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-08T16:08:04.727

我会选择使用客户端 ID 的单个数据库——您应该能够通过使用某种形式的基本模型和一个命名范围来减少对该客户端 ID 的任何操作，从而减少重构的痛苦。

您可以使用诸如 Ferret 之类的索引库或类似的东西来处理全文搜索变慢的问题。一旦单个客户端的数据库变得很大，这无论如何都会成为一个问题，因此您可能需要以任何一种方式实现它。

# c++builder - Borland C++ Builder 中的新 TXMLDocument

> ID：349802
> 
> 赞同：1
> 
> 时间：2008-12-08T15:03:09.977
> 
> 标签：c++builder, txmldocument

我可以在 Borland C++ Builder 中自己创建和销毁 TXMLDocument 吗？我已经尝试过，但 borland 一直告诉我 TXMLDocument 是（并且必须是）IDE 托管组件。

此外，我想这样做的唯一原因是 TXMLDocument 类型的崩溃：我获取 TXMLDocument 并从中“获取”一个工作簿，设置一些文档属性（xml 稍后保存为 Excel 文件），并且我添加了一些样式。好的，然后我添加一个工作表，然后添加我想要的具有正确格式的所有单元格，然后保存它。此时一切正常。

然后我想保存另一个 Excel 文件。由于 IDE 不允许我删除并重新创建 TXMLDocument，因此我尝试仅删除它的工作表。当我尝试这个（在调试模式下）时，IDE 进入 CPU 选项卡中的行步模式（显示一些汇编程序）：

```
ntdll.DbgBreakPoint:
77A07DFE CC               int 3
77A07DFF C3               ret 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T15:26:55.543

你需要做这样的事情：

```
_di_IXMLDocument Doc = NewXMLDocument(); 
```

我不记得为什么的血腥细节，但这应该为您指明正确的方向。

Codegear 网站上有更多[信息](http://dn.codegear.com/article/29241)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-15T14:07:03.447

试试这个 ：

```
#include <oxmldom.hpp>
#include <XMLDoc.hpp>
#include <xmldom.hpp>
#include <XMLIntf.hpp>

  try
  {
   CoInitialize(0);
   _di_IXMLDocument xmlDoc;
    xmlDoc = LoadXMLData( s1 );
   s1 = xmlDoc->XML->Text;
   CoUninitialize();
   mylog( Fun + String::Format( "ANSW-MSG-XML %s ", ARRAYOFCONST(( s1 ))));
  }
  catch ( Exception & ex )
  {
   mylog( Fun + String::Format( "PARSEXML:ERRORE %s \nmsg:%s",
      ARRAYOFCONST(( ex.Message, cmdMsg ))));
  } 
```

# linux - 如何安排 Makefile 来编译具有多个 .c 文件的内核模块？

> ID：349811
> 
> 赞同：9
> 
> 时间：2008-12-08T15:06:17.253
> 
> 标签：linux, makefile, module, kernel

如何安排 Makefile 来编译具有多个 .c 文件的内核模块？

这是我当前的 Makefile。它是由[KDevelop自动生成的](http://www.kdevelop.org/)

```
TARGET = nlb-driver
OBJS = nlb-driver.o
MDIR = drivers/misc

EXTRA_CFLAGS = -DEXPORT_SYMTAB
CURRENT = $(shell uname -r)
KDIR = /lib/modules/$(CURRENT)/build
PWD = $(shell pwd)
DEST = /lib/modules/$(CURRENT)/kernel/$(MDIR)

obj-m += $(TARGET).o

default:
    make -C $(KDIR) M=$(PWD) modules

$(TARGET).o: $(OBJS)
    $(LD) $(LD_RFLAG) -r -o $@ $(OBJS)

ifneq (,$(findstring 2.4.,$(CURRENT)))
install:
    su -c "cp -v $(TARGET).o $(DEST) && /sbin/depmod -a"
else
install:
    su -c "cp -v $(TARGET).ko $(DEST) && /sbin/depmod -a"
endif

clean:
    -rm -f *.o *.ko .*.cmd .*.flags *.mod.c
    make -C $(KDIR) M=$(PWD) clean

-include $(KDIR)/Rules.make 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2017-04-25T01:18:10.003

就我而言，该项目包含 6 个文件：

*   `monter_main.c`,`monter_main.h`
*   `monter_cdev.c`,`monter_cdev.h`
*   `monter_pci.c`,`monter_pci.h`

`monter_main.c`是我模块的主文件。

请记住，您不应该拥有与您尝试构建的模块同名的文件（例如`monter.c`和`monter.ko`），除非您在该文件中拥有所有代码。

这是我的 Makefile：

*   **生成文件**

    ```
    KDIR ?= /lib/modules/`uname -r`/build

    default:
        $(MAKE) -C $(KDIR) M=$$PWD

    install:
        $(MAKE) -C $(KDIR) M=$$PWD modules_install

    clean:
        $(MAKE) -C $(KDIR) M=$$PWD clean 
    ```

*   **建站**

    ```
    obj-m := monter.o
    monter-objs := monter_main.o monter_cdev.o monter_pci.o 
    ```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-08T15:12:15.837

我认为仅在第二行中列出更多目标文件就可以了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-08T16:03:40.960

$(TARGET).o 的依赖关系可以是多个目标文件，一个对应于驱动程序中的每个源文件。许多其他驱动程序在 OBJS 的初始声明之后使用 += 运算符。例如，

```
OBJS = nlb-driver.o
OBJS += file1.o
OBJS += file2.o
... 
```

然后目标规则将扩展为

```
$(TARGET).o: nlb-driver.o file1.o file2.o
    $(LD) $(LD_RFLAG) -r -o $@ $(OBJS) 
```

如果源文件多于一行，这很好。但是如果只有少量文件，你也可以在一行中定义所有对象

```
OBJS = nlb-driver.o file1.o file2.o 
```

# error-correction - 纠错库？

> ID：349815
> 
> 赞同：2
> 
> 时间：2008-12-08T15:10:12.597
> 
> 标签：error-correction, file-recovery, online-storage

我有兴趣使用 Reed-Solomon 纠错 [ [http://en.wikipedia.org/wiki/Reed%E2%80%93Solomon_error_correction](http://en.wikipedia.org/wiki/Reed%E2%80%93Solomon_error_correction)作为参考] 尝试从文件的部分位重建文件。我这样做是出于个人兴趣。

我最近阅读了有关 WuaLa [ [http://www.wua.la/]](http://www.wua.la/])的文章，我对他们如何利用 Reed-Solomon 从部分文件重建文件感兴趣。

有谁知道已经构建的支持 Reed-Solomon 的库？谁能指出我做这类事情所涉及的数学（请记住，我是一个软件人而不是数学人，所以如果你能指出一些更容易获得的东西，那就太好了）。我已经查看了有关此工具的部分视频 [ [http://www.youtube.com/watch?v=3xKZ4KGkQY8]](http://www.youtube.com/watch?v=3xKZ4KGkQY8])，但我仍在努力解决所涉及的数学问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T15:40:19.777

[http://parchive.sourceforge.net/](http://parchive.sourceforge.net/)是一个开源实现。所以你至少可以阅读代码。我相信他们也有关于数学的文档[http://parchive.sourceforge.net/docs/specifications/parity-volume-spec/article-spec.html](http://parchive.sourceforge.net/docs/specifications/parity-volume-spec/article-spec.html)，维基百科也是如此[http://en.wikipedia.org/wiki /Reed-Solomon_error_correction](http://en.wikipedia.org/wiki/Reed-Solomon_error_correction)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-27T18:03:53.053

有一个用于 python [http://pypi.python.org/pypi/zfec](http://pypi.python.org/pypi/zfec)的 ZFEC 包，它实现了 Reed Solomon 算法，用于从部件创建和恢复文件，并完全按照您的意愿进行操作。您无需编码即可使用它 - 作为命令行实用程序。它的核心是一个 .c 文件。我实际上将它用作传输实时视频的擦除代码。

# powershell - AD 组比较 - PowerShell

> ID：349822
> 
> 赞同：3
> 
> 时间：2008-12-08T15:12:52.890
> 
> 标签：powershell

使用以下功能（比较 2 个用户的组成员身份）时，我得到的结果没有意义。

```
function Compare-ADUserGroups <br>
{  #requires -pssnapin Quest.ActiveRoles.ADManagement  
    param (
        [string] $FirstUser = $(Throw "logonname required."),
        [string] $SecondUser = $(Throw "logonname required.")
    )

    $a = (Get-QADUser $FirstUser).MemberOf 
    $b = (Get-QADUser $SecondUser).MemberOf
    $c = Compare-Object -referenceObject $a -differenceObject $b 
    $c | Sort-Object InputObject
} 
```

当我调用它（Compare-ADUserGroups User1 User2）时，我得到一个类似于以下的结果集：

*   CN=[所有用户],OU=adm,DC=OSUMC,DC=EDU <=
*   CN=[所有用户],OU=adm,DC=OSUMC,DC=EDU =>
*   CN=扩展用户,OU=MSG,DC=OSUMC,DC=EDU <=
*   CN=扩展用户,OU=MSG,DC=OSUMC,DC=EDU =>
*   CN=LCS2005,OU=分发列表,DC=OSUMC,DC=EDU <=
*   CN=LCS2005,OU=分发列表,DC=OSUMC,DC=EDU =>

我希望这些不会显示，因为它们是相等的并且我没有使用 -IncludeEqual 参数。关于为什么会出现这些的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T18:52:51.960

他们中有*一些东西*正在摆脱比较。如果你运行，你会看到类似的东西......

获取进程 | export-clixml c\procs.xml Diff (get-process) (import-clixml c:\procs.xml)

因为这些对象的某些属性（例如 VM 和 PM）会在两次 Get-Process 运行之间的短暂间隔内发生变化。因此，您可能会遇到类似的情况，两个对象之间的某些属性不同。默认情况下，Compare-Object 会查看*每个*属性。

另一种方法是使用 Compare-Object 的 -property 参数来仅比较特定属性，而不是比较*整个*对象。Compare-Object 在这方面肯定会有点棘手，因为它使用对象属性而不是简单地使用文本的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-07T15:18:44.343

我编写了一个用户界面来比较组并在 2 个用户之间应用更改 [![在此处输入图像描述](https://i.stack.imgur.com/mMYPu.png)](https://i.stack.imgur.com/mMYPu.png)

```
#requires -version 2
<#
    .SYNOPSIS
        Compare les groupe entre 2 users
    .DESCRIPTION
        Affiche sur 2 colones les les groupes AD des 2 users a comparer et met en evidance les goupes mamquants de chaque user
    .PARAMETER user1
        Nom complet de l'utilisateur 1 a comparer
        ex : domain.adds\UserName
    .PARAMETER user2
        Nom complet de l'utilisateur 2 a comparer
    .EXAMPLE
        .\Compare-QadUsersGrp.ps1 $(whoami) $($UserNames)
    .EXAMPLE
        Start-Process -WindowStyle hidden powershell -ArgumentList "-WindowStyle Normal .\Compare-QadUsersGrp.ps1 $(whoami) $($UserNames)"
#>

param( 
    [string]$SessionName1 = 'Domain\testalb',
    [string]$SessionName2 = 'Domain\testalb2'
)

$currentRunner = $false
$version = '0.60'
$source = "Script Compare-Sessions (alopez)"
$lanStorage = "c:"

    add-content "$lanStorage\Get-TSAdmin_Usage-Log.txt" -value "[$(Get-Date -Format 'yyyy/MM/dd HH:mm:ss')]  $(whoami) - $($version) Compare-Sessions - $SessionName1  vs  $SessionName2"

############################################### Zone liée a l'affichage (refresh) ################################################

    function Refresh-Tabs {
        $loadBar.Visible = $true
        $loadBar.Value = 0

        $ListCompared = Get-vsGrps

        $loadBar.Value = 90
        $SrvForm.height = 178 + $ListCompared.count * 22

        $DefaultColor = 'DarkBlue'
        Set-DataGridView -DataGridView $Grille -AlternativeRowColor -ForeColor $DefaultColor -BackColor 'AliceBlue'

        Load-DataGridView -DataGridView $Grille -Item (ConvertTo-DataTable -InputObject ($ListCompared | ?{$_}))
        $Grille.Columns["$SessionName2"].Width=320
        $Grille.Columns["$SessionName2"].HeaderCell.Style.Alignment = 'MiddleRight'
        #$Grille.Columns["$SessionName2"].AutoSizeMode = $true
        $Grille.Columns["$SessionName2"].DefaultCellStyle.Alignment = 'MiddleRight'
        $Grille.Columns['#'].Width=20
        $Grille.Columns["$SessionName1"].Width=330
        #$Grille.Columns["$SessionName2"].AutoSizeMode = $true

        $Grille.Columns['DN'].Width = 0
        Find-DataGridViewValue -DataGridView $Grille -Value '==' -FindingColumns '#' -RowForeColor Gray
        Find-DataGridViewValue -DataGridView $Grille -Value '=>' -FindingColumns '#' -RowForeColor Green
        #Find-DataGridViewValue -DataGridView $Grille -Value '<=' -FindingColumns '#' -RowForeColor Blue

        $loadBar.Value = 100
        $loadBar.Visible = $false

    }

    function Set-DataGridView  {
        PARAM (
            [ValidateNotNull()]
            [Parameter(Mandatory = $true)]
            [System.Windows.Forms.DataGridView]$DataGridView,

            [Parameter(ParameterSetName = "AlternativeRowColor")]
            [Switch]$AlternativeRowColor,

            [Parameter(Mandatory = $true, ParameterSetName = "AlternativeRowColor")]
            [System.Drawing.Color]$ForeColor,

            [Parameter(Mandatory = $true, ParameterSetName = "AlternativeRowColor")]
            [System.Drawing.Color]$BackColor,

            [Parameter(ParameterSetName = "Proper")]
            [Switch]$ProperFormat
        )
        PROCESS
        {

            $DataGridView.DefaultCellStyle.ForeColor = $DefaultColor

            if ($psboundparameters['AlternativeRowColor']) { # les ligne PAIRES
                $DataGridView.AlternatingRowsDefaultCellStyle.ForeColor = $ForeColor
                $DataGridView.AlternatingRowsDefaultCellStyle.BackColor = $BackColor
            }

            if ($psboundparameters['ProperFormat']) {
                #$Font = New-Object -TypeName System.Drawing.Font -ArgumentList "Segoi UI", 10
                $Font = New-Object -TypeName System.Drawing.Font -ArgumentList "Consolas", 10
                #[System.Drawing.FontStyle]::Bold

                $DataGridView.ColumnHeadersBorderStyle = 'Raised'
                $DataGridView.BorderStyle = 'Fixed3D'
                $DataGridView.SelectionMode = 'FullRowSelect'
                $DataGridView.AllowUserToResizeRows = $false
                $datagridview.DefaultCellStyle.font = $Font
            }
        }  
    }

    function ConvertTo-DataTable {
        <#
            .SYNOPSIS
                Converts objects into a DataTable.
            .DESCRIPTION
                Converts objects into a DataTable, which are used for DataBinding.
            .PARAMETER  InputObject
                The input to convert into a DataTable.
            .PARAMETER  Table
                The DataTable you wish to load the input into.
            .PARAMETER RetainColumns
                This switch tells the function to keep the DataTable's existing columns.
            .PARAMETER FilterWMIProperties
                This switch removes WMI properties that start with an underline.
            .EXAMPLE
                $DataTable = ConvertTo-DataTable -InputObject (Get-Process)
        #>
        [OutputType([System.Data.DataTable])]
        param(
            [ValidateNotNull()]
                $InputObject, 
            [ValidateNotNull()]
                [System.Data.DataTable]
                    $Table,
            [switch]    $RetainColumns,
            [switch]    $FilterWMIProperties
        )

        if($Table -eq $null) {
            $Table = New-Object System.Data.DataTable
        }

        if($InputObject-is [System.Data.DataTable]) {
            $Table = $InputObject
        } else {
            if(-not $RetainColumns -or $Table.Columns.Count -eq 0) {
                #Clear out the Table Contents
                $Table.Clear()

                if($InputObject -eq $null){ return } #Empty Data

                $object = $null
                #find the first non null value
                foreach($item in $InputObject) {
                    if($item -ne $null) {
                        $object = $item
                        break
                    }
                }

                if($object -eq $null) { return } #All null then empty

                #Get all the properties in order to create the columns
                foreach ($prop in $object.PSObject.Get_Properties()) {
                    if(-not $FilterWMIProperties -or -not $prop.Name.StartsWith('__')) #filter out WMI properties
                    {
                        #Get the type from the Definition string
                        $type = $null

                        if($prop.Value -ne $null) {
                            try{ $type = $prop.Value.GetType() } catch {}
                        }

                        if($type -ne $null) # -and [System.Type]::GetTypeCode($type) -ne 'Object')
                        {
                            [void]$table.Columns.Add($prop.Name, $type) 
                        }
                        else #Type info not found
                        { 
                            [void]$table.Columns.Add($prop.Name)    
                        }
                    }
                }

                if($object -is [System.Data.DataRow]) {
                    foreach($item in $InputObject) {   
                        $Table.Rows.Add($item)
                    }
                    return  @(,$Table)
                }
            } else {
                $Table.Rows.Clear() 
            }

            foreach($item in $InputObject) {       
                $row = $table.NewRow()

                if($item) {
                    foreach ($prop in $item.PSObject.Get_Properties()) {
                        if($table.Columns.Contains($prop.Name)) {
                            $row.Item($prop.Name) = $prop.Value
                        }
                    }
                }
                [void]$table.Rows.Add($row)
            }
        }

        return @(,$Table)   
    }

    function Load-DataGridView {
        <#
            .SYNOPSIS
                This functions helps you load items into a DataGridView.
            .DESCRIPTION
                Use this function to dynamically load items into the DataGridView control.
            .PARAMETER  DataGridView
                The ComboBox control you want to add items to.
            .PARAMETER  Item
                The object or objects you wish to load into the ComboBox's items collection.
            .PARAMETER  DataMember
                Sets the name of the list or table in the data source for which the DataGridView is displaying data.
        #>
        Param (
            [ValidateNotNull()]
                [Parameter(Mandatory=$true)]
                    [System.Windows.Forms.DataGridView]
                        $DataGridView,
            [ValidateNotNull()]
                [Parameter(Mandatory=$true)]
                    $Item,
            [Parameter(Mandatory=$false)]
                [string]
                    $DataMember
        )
        $DataGridView.SuspendLayout()
        $DataGridView.DataMember = $DataMember

        if ($Item -is [System.ComponentModel.IListSource] -or $Item -is [System.ComponentModel.IBindingList] -or $Item -is [System.ComponentModel.IBindingListView] ) {
            $DataGridView.DataSource = $Item
        } else {
            $array = New-Object System.Collections.ArrayList

            if ($Item -is [System.Collections.IList]) {
                $array.AddRange($Item)
            } else {   
                $array.Add($Item)   
            }
            $DataGridView.DataSource = $array
        }
        $DataGridView.ResumeLayout()
    }

    function Find-DataGridViewValue {
        # https://github.com/lazywinadmin/WinFormPS/blob/master/WinFormPS.psm1
        <#
            .SYNOPSIS
                The Find-DataGridViewValue function helps you to find a specific value and select the cell, row or to set a fore and back color.

            .DESCRIPTION
                The Find-DataGridViewValue function helps you to find a specific value and select the cell, row or to set a fore and back color.

            .PARAMETER DataGridView
                Specifies the DataGridView Control to use

            .PARAMETER RowBackColor
                Specifies the back color of the row to use

            .PARAMETER RowForeColor
                Specifies the fore color of the row to use

            .PARAMETER SelectCell
                Specifies to select only the cell when the value is found

            .PARAMETER SelectRow
                Specifies to select the entire row when the value is found

            .PARAMETER FindingColumns
                Specifies the column(s) to search Value or NotValue

            .PARAMETER Value
                Specifies the value to search

            .PARAMETER NotValue
                Specifies the value to not match in all column (param FindingColumns is recomanded)

            .EXAMPLE
                PS C:\> Find-DataGridViewValue -DataGridView $Grille -Value $textbox1.Text

                This will find the value and select the cell(s)

            .EXAMPLE
                PS C:\> Find-DataGridViewValue -DataGridView $Grille -Value $textbox1.Text -RowForeColor 'Red' -RowBackColor 'Black'

                This will find the value and color the fore and back of the row
            .EXAMPLE
                PS C:\> Find-DataGridViewValue -DataGridView $Grille -Value $textbox1.Text -SelectRow

                This will find the value and select the entire row

            .NOTES
                Francois-Xavier Cat
                @lazywinadm
                www.lazywinadmin.com
        #>
        [CmdletBinding(DefaultParameterSetName = "Cell")]
        PARAM (
            [ValidateNotNull()]
            [Parameter(Mandatory = $true)]
            [System.Windows.Forms.DataGridView]$DataGridView,
            $Value,
            $NotValue,
            [string[]]$FindingColumns,
            #[Parameter(ParameterSetName = "Cell")]
            [Switch]$SelectCell,
            #[Parameter(ParameterSetName = "Row")]
            [Switch]$SelectRow,
            #[Parameter(ParameterSetName = "Column")]
            #[Switch]$SelectColumn,
            [Parameter(ParameterSetName = "RowColor")]
            [system.Drawing.Color]$RowForeColor,
            [Parameter(ParameterSetName = "RowColor")]
            [system.Drawing.Color]$RowBackColor
        )

        PROCESS
        {
            $DataGridView.ClearSelection()
            ForEach ($Col in  $DataGridView.Columns) {
                if ($FindingColumns -contains $Col.Name -or !$FindingColumns) {
                    ForEach ($Row in $DataGridView.Rows) {
                        $CurrentCell = $dataGridView.Rows[$Row.index].Cells[$Col.index]

                        if ((-not $CurrentCell.Value.Equals([DBNull]::Value)) -and ( ($Value -and ($CurrentCell.Value.ToString() -like "$Value")) -or ($NotValue -and ($CurrentCell.Value.ToString() -notlike "$NotValue")) ))
                        {
                            # Append-RichtextboxStatus -ComputerName $textboxSocieteName.Text -Source "Find $Value$NotValue" -Message "Colonne:$($col.name) ligne:$($row.index)"
                            # Row Selection
                            IF ($PSBoundParameters['SelectRow'])
                            {
                                $dataGridView.Rows[$Row.index].Selected = $true
                            }

                            # Row Fore Color
                            IF ($PSBoundParameters['RowForeColor'])
                            {
                                $dataGridView.Rows[$Row.index].DefaultCellStyle.ForeColor = $RowForeColor
                            }

                            # Row Back Color
                            IF ($PSBoundParameters['RowBackColor'])
                            {
                                $dataGridView.Rows[$Row.index].DefaultCellStyle.BackColor = $RowBackColor
                            }
                            # Cell Selection
                            ELSEIF (-not ($PSBoundParameters['SelectRow']) -and -not ($PSBoundParameters['RowForeColor']) -and -not ($PSBoundParameters['SelectColumn']))
                            {
                                $CurrentCell.Selected = $true
                            }
                        }#IF not empty and contains value
                    }
                }
            }
        }#PROCESS
    }
############################################### Zone liée aux actions sur les objects ############################################

    $CommonObject = [hashtable]::Synchronized( @{
    })

    function Get-vsGrps {
        Add-PSSnapin 'Quest.ActiveRoles.ADManagement'

        $loadBar.Value = 10
        $User1 = Get-QADUser -identity $SessionName1
        $loadBar.Value = 20
        $User2 = Get-QADUser -identity $SessionName2
        $loadBar.Value = 30
        $ListCompared = Compare-Object $User1.memberof $User2.memberof -IncludeEqual | %{
            #$_.InputObject=(Get-QADGroup $_.InputObject).Name
            #$_.InputObject = ($_.InputObject -split(','))[0] -replace('CN=','')
            [pscustomobject][ordered]@{
                "$SessionName2" = $(
                    if ($_.SideIndicator -eq '==' -or $_.SideIndicator -eq '=>') {
                        ($_.InputObject -split(','))[0] -replace('CN=','')
                    } else {
                        ''
                    }
                )
                '#' = $_.SideIndicator
                "$SessionName1" = $(
                    if ($_.SideIndicator -eq '==' -or $_.SideIndicator -eq '<=') {
                        ($_.InputObject -split(','))[0] -replace('CN=','')
                    } else {
                        ''
                    }
                )
                DN = $_.InputObject
            }
        } | Sort-Object DN
        $loadBar.Value = 40
        $ListCompared
    }

    function Toggle-Group {
        $loadBar.Value = 0
        $loadBar.Visible = $true
        $loadBar.Value = 50

        $line = $Grille.CurrentCell.RowIndex
        $col = $Grille.CurrentCell.ColumnIndex
        $DN = $Grille.currentrow.Cells[3].value
        $Grp = ($DN -split(','))[0] -replace('CN=','')

        if (@(0,2) -contains $col -and $edit.Checked) {
            $user = $Grille.columns[$Col].HeaderText
            if ($Grille.CurrentCell.value -eq '' -or $Grille.CurrentCell.value -like " Supp ($Grp) ! ") {
                add-QADGroupMember -identity $DN -member $user
                retour-email -title "$user : Add '$Grp'" -msg "Add $DN"
                $Grille.CurrentCell.value =  " Add ($Grp) ! "
                $Grille.CurrentCell.Style.ForeColor = 'Magenta'
            }
            else {
                Remove-QADGroupMember -identity $DN -member $user
                retour-email -title "$user : Supp '$Grp'" -msg "Supp $DN"
                $Grille.CurrentCell.value = " Supp ($Grp) ! "
                $Grille.CurrentCell.Style.ForeColor = 'Red'
            }
            $Grille.currentrow.Cells[1].value = "><"
            $Grille.currentrow.Cells[1].style.ForeColor = 'Red'
        }

        $loadBar.Value = 100
        $loadBar.Visible = $false
    }

    function retour-email {
        param (
            [string] $email = $script:currentRunner,
            [switch] $force = $edit.Checked,
            [string] $title = '.',
            [string] $msg = '.'
        )
        if ( $email -and $force) {
            Send-MailMessage -To $email -from 'Script@mydomain.com' -Subject "$title" -SmtpServer mySmtpServer -BodyAsHtml -Body "$msg"
        }
        add-content "$lanStorage\Get-TSAdmin_Usage-Log.txt" -value "[$(Get-Date -Format 'yyyy/MM/dd HH:mm:ss')]  $(whoami) - $($version) Compare-Sessions - $title"
    }

############################################### Zone GUI / Interface - formulaire ###############################################

#requires -version 2

Add-Type -AssemblyName 'System.Drawing'
Add-Type -AssemblyName 'System.Windows.Forms'
[System.Windows.Forms.Application]::EnableVisualStyles()

# permet de faire les requette serveur apres ouverture du formulaire
    $timerOnload = New-Object System.Windows.Forms.Timer 
    $timerOnload.Interval = 500
    $timerOnload.add_Tick({
            Refresh-Tabs

            $script:currentRunner = (whoami | Get-QADUser).email

            $edit.Text = "Edit Mode, with email return ($($script:currentRunner))"
            $timerOnload.Enabled = $false
        })
    $timerOnload.Enabled = $true
    $timerOnload.Start()
# 

#region $SrvForm
$SrvForm = New-Object -TypeName 'System.Windows.Forms.Form'
$SrvForm.Name = 'SrvForm'
$SrvForm.MaximumSize = New-Object -TypeName 'System.Drawing.Size' -ArgumentList @(0, 1200)
$SrvForm.MinimumSize = New-Object -TypeName 'System.Drawing.Size' -ArgumentList @(670, 180)
$SrvForm.Size = New-Object -TypeName 'System.Drawing.Size' -ArgumentList @(670, 350)
$SrvForm.Padding = New-Object -TypeName 'System.Windows.Forms.Padding' -ArgumentList @(1,1,1,0)
$SrvForm.KeyPreview = $True
$SrvForm.Add_KeyDown({ if ($_.KeyCode -eq 'Escape') {$SrvForm.Close()} })
$SrvForm.Add_KeyDown({ if ($_.KeyCode -eq 'F5') {
            Refresh-Tabs
        }
    })
$icon1 = & {
    $iconString = 'AAABAAEAJCEAAAEAGAAcDwAAFgAAACgAAAAkAAAAQgAAAAEAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACGhoaTk5OZmZmdnZ2enp6bm5sAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABPT0+QkJCenp6AgIAAAAAAAAAAAAAAAAAAAACOjo6cnJyrq6u3t7e7u7u4uLiysrKurq6hoaGIiIgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABxcXGrq6vPz8/b29u5ubmLi4sAAAAAAAAAAACFhYWcnJy2trbLy8vX19fb29vZ2dnU1NTMzMzCwsKjo6OQkJCFhYUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgIAAABnZ2eoqKi6urrQ0NDf39/c3Ny8vLyHh4cAAAAAAACcnJy3t7d+fn5dXV11dXXp6env7+/s7Ozm5ube3t7KysqqqqqXl5eKiooAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABOTk6ampqoqKi4uLjHx8fOzs7e3t7c3NzGxsaoqKiRkZGmpqZwcHAAAAAAAAAAAADc3Nz8/Pz5+fn39/fx8fHl5eXDw8Ovr6+Xl5eGhoYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWFhaEhISbm5unp6e0tLS8vLzDw8PLy8vZ2dng4ODQ0NC9vb1WVlZmZmZJSUlAQECFhYX8/Pz////////9/f37+/v29vbT09PDw8OsrKyNjY0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbGxuFhYWenp6jo6OsrKy0tLS7u7vCwsLHx8fPz8/V1dVKSkqKiorQ0NDo6Oj29vb+/v7////////////////+/v79/f3f39/Q0NC0tLQYGBh+fn7IyMimpqYAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwNPT0+MjIympqagoKCUlJSVlZWqqqqioqJbW1u2tra2trbX19ft7e37+/v////////////////////////////l5eXb29s2NjasrKz////4+Pjo6OjExMQAAAAAAAAAAAA5OTnAwMDa2trFxcWgoKBfX19MTExTU1NaWlp2dnaTk5M7OzuxsbGzs7O5ubnMzMzx8fH09fTk5OT////////////////////////k5OTCwsIuLi7////////q6uro6Ojd3d2Ojo4AAAAAAABoaGjU1NTg29vw9PXs8vLo7Ozf4OHU1NTJycm6urq0tLRUVFSdnZ2urq6zs7PS0tLs7OzT09P5+/v1+Pn3+/z8///////////////j4+OqqqpLS0v////9/f3m5ubo6Ojo6OiysrIAAAAAAAB2dnbW2dmsaGKMDQCqPy7CcWPVpJvcv7nbyMTd09He3t/c4OFZWlq0tre7vb7T09P09PT////hwrrlnovSg2i7aki/i3TXyMHx9fbl5+ifn6A5OTn////6+vrn5+fo6Ojq6uq9vb0AAAAAAACBgYHY3NytWlCdHQemIAiuJAizJgm3LA68Oh3ARivCUDbHa1WrdGacUTepXkCsmJD3+/zh0s7urZ3suqrVlXe9ZTWxSxKwQwusRhWtYD2MYU4IBwf39/f+/v7n5+fo6Ojn5+exsbEAAAAAAACLi4va39+uSDisKRCyKAy2Kgy7MhO7Lg3ANxfCORjEOhrEOhm/OBSyRROySxauTh3CpJbfppHz0Mfs0MXVpYe9cT2yWRyyWByyVhuyUhmkRhUNDAuZmZn////u7u7o6OjY2NiXl5cAAAAJCQmRkZHc4+WxNx+3Mxe5LhC6LA2/NBPDORnENRPJQSDKQiDLQyLGQx+ySheyVRqzWR7Hek3it6Ly39rs187VqYq9dD+yXB2yXB2yWR2yVhu3ThZpKA0ZGxzb29v////19fXNzc0AAAAAAABFRUWVlZXc5ea1Kg29Ox6+Nhi+Lw3DMxDKRSPIOBPORSLPSifRSyjKSiSySxeyVhuzXSDGhVniv6vy497s1szVpoi9cT2yWRyyVhuyUhmySRKrUCe7o5mUlZYeHh62trbj4+MAAAAAAAAAAABjY2OdnZ3Y1NS6LA3DQiXFQCDDMg7HMg7ORCLRSCXPORLWUS3XUi/SUCuzRBOzTRazVh3GfVPjs5/z1MzsxrrVmXq9ZjWxShKvTBm6bUnStKjs8vXf4ODR0dDAwMChoaHNzc0AAAAAAAAAAABoaGipqqrSvbi/NhfHSSvLSSrHNBDLNg/PORPZWDXVQBjYSiLeWjbeWjbMVjOgUS+tRRTDYzvckXjqq5zkn4zMfGC2aEjDlIDq39r7+fn////7+/vb29vKysqysrK5ubnDw8MAAAAAAAAAAABpaWm1trfNopnFQiTMTzLQUzTMOhXPOBDSORDbUy7fWzbbPhPiXjjjYj3jYj2qrK3Ey87Y3+Ln7O7w9fbx9vf4/f/////////////////+/v75+fnW1tbDw8OlpaXHx8eurq4AAAAAAAAAAABpaWnAwsPKiXvLTjDQVTfTWTrUSSXTOQ/XPBHdSyLkZD/jUSfiRxroakXnaES/i3zBwcHd3d3w8PD6+vr+/v7////+/v7////+/v79/f36+vrv7+/MzMy3t7eRkZHl5eW8vLwAAAAAAAAAAABqamrLzs/Icl7QWDvTWz7YXz/aXDrWOQ7bPhLfQhXpa0bqaUPmRBLqXzXscErZeFyvrq7Nzc3j4+Px8fH4+Pj7+/v8/Pz7+/v6+vr29vbw8PDa2tq6urqcnJzf39/Nzc0AAAAAAAAAAAA8PDxsbGzU2NnHYEjTYETXYUTbZUbfaknaQRXfQBLiQRHrYDbwdlHuYTbsSRfwdlHudlG1kIW1tbXPz8/g4ODp6enu7u7v7+/v7+/r6+vm5ubc3Ny7u7uYmJjOzs7Ly8sAAAAAAAAAAAAAAABYWFhycnLY29vJWD3VZkvaZ0rdakvibk7gTyXiQRPmRBTrSRjze1X2fFbyUB7xWiryflrve1ixkYiurq7JycnT09PY2Nja2trZ2dnW1tbOzs6lpaVdXV1WVlbY2NgAAAAAAAAAAAAAAAAAAABdXV2BgYHU0tLMWj7YbFHcbVDfcFHkclPkXznkQxPpRhTuSBT2cEX5glv5b0P0TBb0c0rygF7rfl12Sj1PT0+VlZW9vb3ExMS3t7eDg4M3NzcODg4MDAwQEBACAgIAAAAAAAAAAAAAAAAAAABfX1+Ojo7RyMfOY0jZcFbdclXhdFfld1nnbUnlRRTqRxTwSRX2YC/8iGL9imT4ViHzVSPziGbwhGTsg2SrYEoxGxYSCggIBQUCAQEHAwIgISEbGxscHBwAAAAAAAAAAAAAAAAAAAAAAAAAAABfX1+YmJjOv7vSa1LadFvfd1ziel3mfV/pelvlRRfqRxTwShX2Thf8jGj+jmn7hl/xRxHwaD3xi2ztiGrqhmrlhGrPeWTBc1+6YUqGSzy6vLwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABbW1ukpKTMtrHUcVnbeGDfe2LjfmPngWXqhmnmTSDpRRPuSRXzSBL4b0P7knD4j2/yYjTrRhTvgmHtjHDqi3DninHkiXHgiXLZaE2KWkzCxMUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABWVlaxsLHKsKrWdl/cfWXgf2fjgmjnhmrqiW3oZ0LmQhDqRxTuSRXxSxb4knL2k3TziGboQxHnWjHtk3jqj3bnj3fkjnfijXjWX0KLbmXBwsMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABcXFy7u7vKrKbWd2HcgmvghGzjhm7niW/pjHHrhmniPg7nRRTqRhTsSBXye1b0lnjzmn/qaELfOgrnd1jqln7nk3zkkX3ikn7TVDaNhYG/wMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkZGS/v7/KpZ3We2bdhnHgiHLjinTmjXXoj3brk3rgSBziQhPlRBTnRBTrXzXymX7xmX/vlnzfSB3ZQhfnj3fnloHlloLil4TLRieRmpm+vr4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABqamrBw8TIkYXUcVrafGXegGnhhG3kiXHojXXrk3riXDbfQBLhQRPiQhPiQRLvmIDvn4junojkclLVOhDbZETnn4zlnIrjm4q2Qyijqam7u7sAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABtbW3Fx8e3nJaobmCpaVisYk+uXEawVT2zTzS1SSq1PBm3MQrCMwrNNgvWNgjhSR7mWjPlYTzjZ0bTMwjOMAjccVbdfmfcgmyiOyK1urm3t7cAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsbGzAwMDMzc7O0tLQ1NTT19jU2dvW3N7Y3+Hb4uTc5efd5unV3uDM1tjEzs+8xce3vLy2sK20paC0npeylIuthnuqe26nb2KOZlrJy8uysrIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABRUVGwsLCxsbGqqqqmpqasrKyxsbG3t7e8vLzAwMDExMTIyMjLy8vPz8/S0tLV1dXX2NjV1tbT1NTS09TR0tLO0NDMzc7KzMzJysvExMSzs7MAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///f/8AAAAP+fwD/wAAAA/g+AD/AAAAD8B4AH8AAAAPgBAAPwAAAA+AAAAfAAAADwAAAAMAAAAPwAAAAQAAAA4AAAABAAAADAAAAAAAAAAMAAAAAAAAAAwAAAABAAAADAAAAAEAAAAMAAAAAQAAAAwAAAADAAAADAAAAAMAAAAIAAAABwAAAAgAAAAHAAAACAAAAAcAAAAIAAAADwAAAAgAAAAfAAAACAAAAB8AAAAIAAAAPwAAAAgAAAD/AAAACAAAAf8AAAAIAAAB/wAAAAgAAAH/AAAAAAAAAf8AAAAAAAAB/wAAAAAAAAH/AAAAAAAAA/8AAAAAAAAD/wAAAA/8AAP/AAAAA='
    $iconStream = New-Object -TypeName 'System.IO.MemoryStream' -ArgumentList @(,([System.Convert]::FromBase64String($iconString)))
    $icon = New-Object -TypeName 'System.Drawing.Icon' -ArgumentList $iconStream
    $iconStream.Dispose()
    return $icon
}
$SrvForm.text = "$SessionName2 vs $SessionName1"
$SrvForm.Icon = $icon1
$SrvForm.Topmost = $True
$SrvForm.Topmost = $false

$SrvForm.SuspendLayout()

    #region $groupBox1
    $groupBox1 = New-Object -TypeName 'System.Windows.Forms.GroupBox'
    $groupBox1.Text = 'Comparatif des groupes (direct)'
    $groupBox1.Dock = [System.Windows.Forms.DockStyle]::Fill
    $groupBox1.SuspendLayout()

        #region $Grille
        $Grille = New-Object -TypeName 'System.Windows.Forms.DataGridView'
        $Grille.Name = 'Grille'
        $Grille.Dock = [System.Windows.Forms.DockStyle]::Fill
        $Grille.ReadOnly = $true
        $Grille.SelectionMode = [System.Windows.Forms.DataGridViewSelectionMode]::FullRowSelect
        $Grille.RowHeadersVisible = $false
        $Grille.AllowUserToAddRows = $false
        $Grille.AllowUserToResizeRows = $false
        $Grille.AllowUserToDeleteRows = $false
        $Grille.PerformLayout()

        #endregion $Grille

        [System.Void]$groupBox1.Controls.Add($Grille)

        #region $aide
        $aide = New-Object -TypeName 'System.Windows.Forms.Label'
        $aide.Name = 'aide'
        $aide.Text = 'Double-click sur un groupe ajoute ou supprime le groupe pour cet utilisateurs'
        $aide.Visible = $false
        $aide.ForeColor = [System.Drawing.Color]::Red
        $aide.Dock = [System.Windows.Forms.DockStyle]::Bottom
        $aide.TextAlign = [System.Drawing.ContentAlignment]::MiddleRight
        #endregion $aide

        [System.Void]$groupBox1.Controls.Add($aide)

    $groupBox1.ResumeLayout($false)
    $groupBox1.PerformLayout()
    #endregion $groupBox1

    [System.Void]$SrvForm.Controls.Add($groupBox1)

    #region $panel1
    $panel1 = New-Object -TypeName 'System.Windows.Forms.Panel'
    $panel1.Size = New-Object -TypeName 'System.Drawing.Size' -ArgumentList @(0, 30)
    $panel1.Padding = New-Object -TypeName 'System.Windows.Forms.Padding' -ArgumentList @(4)
    $panel1.Dock = [System.Windows.Forms.DockStyle]::Bottom
    $panel1.SuspendLayout()

        #region $edit
        $edit = New-Object -TypeName 'System.Windows.Forms.CheckBox'
        $edit.Name = 'edit'
        $edit.Text = 'Mode Edition, avec retour par email de chaque modif'
        $edit.Checked = $false
        $edit.Width = 480
        $edit.Dock = [System.Windows.Forms.DockStyle]::Left
        #endregion $edit

        [System.Void]$panel1.Controls.Add($edit)

        #region $button1
        $button1 = New-Object -TypeName 'System.Windows.Forms.Button'
        $button1.Text = 'Retour Email complet'
        $button1.Width = 150
        $button1.Dock = [System.Windows.Forms.DockStyle]::Right
        #endregion $button1

        [System.Void]$panel1.Controls.Add($button1)

    $panel1.ResumeLayout($false)
    $panel1.PerformLayout()
    #endregion $panel1

    [System.Void]$SrvForm.Controls.Add($panel1)

    #region $statusStrip1
    $statusStrip1 = New-Object -TypeName 'System.Windows.Forms.StatusStrip'
    $statusStrip1.SuspendLayout()

        #region $LabelVersion
        $LabelVersion = New-Object -TypeName 'System.Windows.Forms.ToolStripStatusLabel'
        $LabelVersion.Text = 'V0.00'
        $LabelVersion.Spring = $true
        $LabelVersion.TextAlign = [System.Drawing.ContentAlignment]::MiddleLeft
        #endregion $LabelVersion

        [System.Void]$statusStrip1.Items.Add($LabelVersion)

        #region $loadBar
        $loadBar = New-Object -TypeName 'System.Windows.Forms.ToolStripProgressBar'
        $loadBar.Style = [System.Windows.Forms.ProgressBarStyle]::Continuous
        $loadBar.Value = 100
        $loadBar.Visible = $true
        #endregion $loadBar

        [System.Void]$statusStrip1.Items.Add($loadBar)

    $statusStrip1.ResumeLayout($false)
    $statusStrip1.PerformLayout()
    #endregion $statusStrip1

    [System.Void]$SrvForm.Controls.Add($statusStrip1)

############################################### Zone personalisation du formilaire ##############################################

$LabelVersion.Text = "[PID:$pid] $($script:MyInvocation.MyCommand) - V $Version"

$button1.add_click({
        retour-email -title "$SessionName2  vs  $SessionName1" -msg (Get-vsGrps | ConvertTo-Html)
    })

$Grille.add_DoubleClick({
        Toggle-group
    })

$Grille.add_ColumnHeaderMouseClick({
        Find-DataGridViewValue -DataGridView $Grille -Value '==' -FindingColumns '#' -RowForeColor Gray
        Find-DataGridViewValue -DataGridView $Grille -Value '=>' -FindingColumns '#' -RowForeColor Green
    })

$edit.Add_CheckStateChanged({
        $aide.visible = $edit.Checked
    })

$SrvForm.ResumeLayout($false)
$SrvForm.PerformLayout()
#endregion $SrvForm

#region GUI Startup
$SrvForm.ShowDialog()
#endregion GUI Startup

#$powershell.Dispose()
#$runspace.close()
$timerOnload.stop()

Get-vsGrps 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-18T16:16:16.263

我最好的猜测是，提供的 MemberOf 属性`Get-QADUser`可能会返回一个对象，而不仅仅是作为字符串的组的可分辨名称。这是我用于比较 Active Directory 组成员身份的脚本：

```
# Compare the group memberships of 2 Active Directory Users or the user memberships of 2 Active Directory Groups.
# Requires the ActiveDirectory PowerShell module from the Microsoft's Remote Server Administration Tools.

Import-Module ActiveDirectory

function Get-ComparisonResult ($name1, $name2, $sideIndicator)
{
    $comparisonResult = $null

    switch ($_.SideIndicator)
    {
        '<=' { $comparisonResult = "$($name1) Only" }
        '==' { $comparisonResult = "$($name1) and $($name2)" }
        '=>' { $comparisonResult = "$($name2) Only" }
    }

    return $comparisonResult
}

function Compare-ADUserGroupMembership($userName1, $userName2)
{
    $userComparisonResultColumn = @{ name = 'Comparison Result'; expression = { Get-ComparisonResult $user1.DisplayName $user2.DisplayName  $_.SideIndicator } }
    $groupNameColumn = @{ name = 'Group Name'; expression = { (Get-ADGroup $_.InputObject).Name } }

    $user1 = Get-ADUser $userName1 -Properties memberOf, displayName
    $user2 = Get-ADUser $userName2 -Properties memberOf, displayName

    $userGroupComparison = Compare-Object -IncludeEqual $user1.MemberOf $user2.MemberOf | Select $userComparisonResultColumn, $groupNameColumn

    return $userGroupComparison
}

function Compare-ADGroupMembership($groupName1, $groupName2)
{
    $groupComparisonResultColumn = @{ name = 'Comparison Result'; expression = { Get-ComparisonResult $groupName1 $groupName2 $_.SideIndicator } }
    $userNameColumn = @{ name = 'User Name'; expression = { $_.InputObject.name } }

    $groupMembers1 = Get-ADGroupMember $groupName1
    $groupMembers2 = Get-ADGroupMember $groupName2

    $groupMemberComparison = Compare-Object -IncludeEqual $groupMembers1 $groupMembers2 | Select $groupComparisonResultColumn, $userNameColumn

    return  $groupMemberComparison
}

Compare-ADUserGroupMembership 'userone' 'usertwo' | ft -AutoSize
Compare-ADGroupMembership 'Group One' 'Group Two' | ft -AutoSize 
```

# algorithm - 你如何检测字符串列表中的重复？

> ID：349823
> 
> 赞同：4
> 
> 时间：2008-12-08T15:12:53.637
> 
> 标签：algorithm, string, analysis

我有一系列 SQL 调用，我想用它来检测循环（以及因此不必要的重复 sql 调用），但它让我想到了这个更普遍的问题。

给定一个列表，说 `[a,b,c,b,c,a,b,c,b,c,a,b,b]`

有什么办法可以把它变成 `a,[[b,c]*2,a]*2,b*2`

或者，`[a,[b,c]*2]*2,a,b*2`

也就是说，检测重复（可能是嵌套的）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-08T15:19:14.513

查看[Lempel-Ziv-Welsh 压缩算法](http://en.wikipedia.org/wiki/LZW)。它建立在检测字符串中的重复并利用它们进行压缩的基础上。我相信你可以使用[Trie](http://en.wikipedia.org/wiki/Trie) 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T15:18:54.797

如果您可以先对其进行排序，那么很容易再经过一次查找重复运行。当然，对像 SQL 查询这样的自由格式进行排序听起来有点吓人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T15:19:09.147

我不是该领域的专家，但您可能想查看一些压缩算法，在我看来，这正是他们所做的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T15:20:15.977

如果字符串足够大，一个有趣的方法是在其上运行压缩工具（如 gzip、bzip 或 7zip）。这些工具的工作原理是定位重复（在不同级别），并用指向文本第一个实例（或字典）的指针替换它们。您实现的压缩是重复的量度。转储文件（您必须编写代码来执行此操作）将为您提供重复的内容。

# sql-server - SQL Server - 数据库大小计算差异问题

> ID：349824
> 
> 赞同：0
> 
> 时间：2008-12-08T15:13:52.683
> 
> 标签：sql-server

我正在尝试以编程方式监视 SQL Server 数据库的大小，以便我的 Web 应用程序的管理部分可以报告它，并且我可以使用它来执行一些清理 SP、清除日志文件等。

根据 SO 建议，我使用以下代码计算表的大小：

```
CREATE TABLE #t (name SYSNAME, rows CHAR(11), reserved VARCHAR(18), data VARCHAR(18), index_size VARCHAR(18), unused VARCHAR(18))EXEC sp_msforeachtable 'INSERT INTO #t EXEC sp_spaceused ''?'''-- SELECT * FROM #t ORDER BY name-- SELECT name, CONVERT(INT, SUBSTRING(data, 1, LEN(data)-3)) FROM #t ORDER BY nameSELECT SUM(CONVERT(INT, SUBSTRING(data, 1, LEN(data)-3))) FROM
#tDROP TABLE #t 
```

当我对我的小型示例数据库运行此程序时，我得到的总和值约为 6.8 兆字节。当我查看数据库的属性时，它显示为 15.5 兆字节。

我有以下问题：
1.还有什么可以弥补差异？
2\. 这种差异是否可以被描述为“开销”，它只会随着其他数据的增长而增长（粗略估计就是我所需要的）。
3\. 存储过程、函数、视图、触发器都在这个“开销”空间中？有没有办法计算这些？
4\. 还有其他方法可以获取整个数据库的大小吗？我真的只是想要一种简单的方法来获得真实的尺寸。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T15:56:04.907

在我看来，不同之处在于您在“属性”页面中看到的大小是通过查询表 .sys.database_files 计算得出的，该表计算每个数据库文件分配的 8KB 页数。

要获得相同的结果，只需运行以下查询 (SQL Server 2005)：

```
选择
  SUM([size] * 8) / 1024 AS DB_Size -- 字段“size”包含每个文件中包含的 8 KB 页数
从
  [db_name_here].sys.database_files

```

MSDN 网站上有关[sys.database_files](http://msdn.microsoft.com/en-us/library/ms174397.aspx)的更多信息。

希望这可以帮助。:)

迭戈

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T15:57:29.943

为什么不只检查磁盘上文件（或多个文件）的大小？假设您知道文件的名称，您可以通过文件系统检查它们的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T16:08:17.660

快速观察一下，您的脚本似乎只对 sp_spaceused 的数据列求和，而不是保留列（保留 = 数据 + 索引 + 未使用）。sp_msforeachtable 也不包括系统表。

也来自于 sp_spaceused 的 SQL Server 联机丛书

> 如果未指定 objname，则返回整个数据库的结果。

也来自在线书籍的同一页

> database_size 将始终大于reserved + unallocated 空间的总和，因为它包括日志文件的大小，但reserved 和unallocated_space 只考虑数据页。

另一件事您可能需要运行 DBCC UPDATEUSAGE 以获得准确的数字。

另请参见“ [SQL Server 联机丛书 sp_spaceused (Transact-SQL)”](http://msdn.microsoft.com/en-us/library/ms188776.aspx)

# visual-studio - 编程视觉工作室宏

> ID：349826
> 
> 赞同：1
> 
> 时间：2008-12-08T15:14:43.150
> 
> 标签：visual-studio, visual-studio-macros

我很沮丧尝试为 Visual Studio 编写宏（使用 VS 2008，版本 9.0.30729.1 SP，包含所有更新）。

在宏资源管理器中，我可以转到 Microsoft 的示例/VSEditor 并添加一个按我的意愿运行的子例程。但我似乎无法让它在其他任何地方工作。特别是在宏资源管理器的 MyMacros 区域中。

详细信息：
我已经复制了整个示例/VSEditor 代码并将其复制到 MyMacros/Testing 并将内部模块名称重命名为 Testing 并保存了修改后的代码。宏资源管理器现在显示测试模块及其包含的所有子例程。如果我右键单击，比如说，InsertDate 并选择运行，没有任何反应。但是，如果我向下滚动到示例/VSEditor/InsertDate 并右键单击并选择运行，它会按预期插入日期。它几乎是相同的代码（只是上面提到的位置和名称更改），但一个运行而另一个不运行。

有没有办法获得关于正在发生的事情/代码失败的地方/代码失败的原因的反馈？

谁能解释我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T21:32:22.623

我尝试了同样的事情，将 VSEditor 代码复制到 MyMacros/Testing。事情也不会运行。

然后我转到菜单选项**View|Error List**。**然后到Microsoft Visual Studio 宏**编辑器中的菜单选项**Debug|Build 。**我看到未声明**实用程序**（错误列表中的第一个错误）。当我将实用程序复制到 MyMacros 时。宏开始工作。

 ****也许这与您遇到的问题相同。

# apache-flex - 如果 Flex Builder 3 调试器无法启动怎么办

> ID：349827
> 
> 赞同：1
> 
> 时间：2008-12-08T15:14:48.423
> 
> 标签：apache-flex, flash, flex-builder-3

我现在正在使用 Flex Builder 3，它突然拒绝开始调试会话。我重新安装了 Flash Player 的调试器版本：9 和 10 版本。然后我重新安装了 Flex Builder 本身，允许它安装它的本机 Flash Player 版本。最后，我尝试使用 IE 和 Firefox 作为调试播放器的主机。我到底怎么能诊断出FB发生了什么？谢谢你。

**PS**我已经打开了防火墙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T15:56:13.113

我有一个类似的问题，这是如何解决的： http: [//therush.wordpress.com/2008/03/11/resolved-flex-builder-3-debugger-stopped-working](http://therush.wordpress.com/2008/03/11/resolved-flex-builder-3-debugger-stopped-working)

如果这不能解决它：尝试查看（使用 netstat -an on win）flash 播放器是否正在侦听调试连接。如果不是，那就是播放器的问题。如果是，请尝试检查构建器属性以查看它是否尝试连接到正确的端口。尝试 telnet 到所述端口以查看播放器是否响应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T15:29:09.143

调试播放器使用套接字连接与调试器对话，也许您安装了阻止此连接的东西（可能是软件防火墙或病毒程序）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T13:43:14.020

你提到重新安装。只是为了细致，您是否使用了“卸载程序”工具？[http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_14157](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_14157)。从 Windows 添加/删除 UI 卸载无法正常工作。

修复后，如果您需要针对多个版本（9 和 10）进行测试，您可以查看此工具： http: [//geekglue.blogspot.com/2007/12/iflash-switcher-installing -new-player.html](http://geekglue.blogspot.com/2007/12/iflash-switcher-installing-new-player.html)。（它目前作为 Firefox 插件提供。）

# c++ - WM_GETTEXT 按钮动作

> ID：349835
> 
> 赞同：0
> 
> 时间：2008-12-08T15:18:55.607
> 
> 标签：c++, windows-mobile, button, action

我想将一个动作绑定到一个 PocketPC 按钮（中心的最大按钮 - 不知道它是如何调用的）。我试图将操作绑定到 WM_GETTEXT 消息，但是每次按键都会发送此消息，并且不知道如何将操作添加到特定按钮。有谁知道如何做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T16:50:59.430

您是在谈论“d-pad”中间的操作按钮吗？每个设备都有自己的硬件布局；没有所有设备通用的“中心最大按钮”之类的东西。前提是可以发图吗？

不管怎样，看看这个页面：[Windows Mobile 的 Keys and Key Codes](http://msdn.microsoft.com/en-us/library/bb431750.aspx)。

另外，`WM_GETTEXT`绝对不是您要处理的消息**。**它的目的是检索窗口的“窗口文本”（按钮的标题、编辑控件的内容等）。

您应该处理`WM_KEYDOWN`/`WM_KEYUP`或`WM_CHAR`. 此外，您可能想查看[Accelerators](http://msdn.microsoft.com/en-us/library/aa924659.aspx)。

# java - JUnit 4：在运行测试之前在测试套件中设置东西（就像测试的 @BeforeClass 方法，仅用于测试套件）

> ID：349842
> 
> 赞同：25
> 
> 时间：2008-12-08T15:23:00.573
> 
> 标签：java, unit-testing, junit, functional-programming

我想对（宁静的）网络服务进行一些功能测试。测试套件包含一堆测试用例，每个测试用例在 web 服务上执行几个 HTTP 请求。

自然，Web 服务必须运行，否则测试将失败。:-)

启动 web 服务需要几分钟（它会处理一些繁重的数据提升），所以我想尽可能不频繁地启动它（至少所有只有从服务中获取资源的测试用例才能共享一个）。

那么有没有办法在测试套件中设置炸弹，就像在测试用例的 @BeforeClass 方法中一样运行测试？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2011-10-03T18:12:37.677

`@ClassRule`现在的答案是在您的套件中创建一个。该规则将在每个测试类运行之前或之后（取决于您如何实现）被调用。您可以扩展/实现一些不同的基类。类规则的好处在于，如果您不将它们实现为匿名类，那么您可以重用代码！

这是一篇关于它们的文章：http: [//java.dzone.com/articles/junit-49-class-and-suite-level-rules](http://java.dzone.com/articles/junit-49-class-and-suite-level-rules)

下面是一些示例代码来说明它们的使用。是的，这是微不足道的，但它应该足以说明生命周期，以便您开始。

首先是套件定义：

```
import org.junit.*;
import org.junit.rules.ExternalResource;
import org.junit.runners.Suite;
import org.junit.runner.RunWith;

@RunWith( Suite.class )
@Suite.SuiteClasses( { 
    RuleTest.class,
} )
public class RuleSuite{

    private static int bCount = 0;
    private static int aCount = 0;

    @ClassRule
    public static ExternalResource testRule = new ExternalResource(){
            @Override
            protected void before() throws Throwable{
                System.err.println( "before test class: " + ++bCount );
                sss = "asdf";
            };

            @Override
            protected void after(){
                System.err.println( "after test class: " + ++aCount );
            };
        };

    public static String sss;
} 
```

现在测试类定义：

```
import static org.junit.Assert.*;

import org.junit.ClassRule;
import org.junit.Rule;
import org.junit.Test;
import org.junit.rules.ExternalResource;

public class RuleTest {

    @Test
    public void asdf1(){
        assertNotNull( "A value should've been set by a rule.", RuleSuite.sss );
    }

    @Test
    public void asdf2(){
        assertEquals( "This value should be set by the rule.", "asdf", RuleSuite.sss );
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T15:28:24.277

jUnit 不能做那种事情——尽管 TestNG 确实有`@BeforeSuite`和`@AfterSuite`注释。通常，您需要构建系统来执行此操作。在 Maven 中，有“集成前测试”和“集成后测试”阶段。在 ANT 中，您只需将步骤添加到任务中。

您的问题几乎是[jUnit 4.x 中的 Before and After Suite 执行挂钩](https://stackoverflow.com/questions/82949/before-and-after-suite-execution-hook-in-junit-4x)，所以我会看看那里的建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T12:28:30.880

一种选择是使用 Apache Ant 之类的东西来启动您的单元测试套件。然后，您可以在 junit 目标之前和之后进行目标调用，以启动和停止 Web 服务：

```
<target name="start.webservice"><!-- starts the webservice... --></target>
<target name="stop.webservice"><!-- stops the webservice... --></target>
<target name="unit.test"><!-- just runs the tests... --></target>

<target name="run.test.suite" 
        depends="start.webservice, unit.test, stop.webservice"/> 
```

然后，您使用 ant（或您选择的集成工具）运行您的套件。大多数 IDE 都支持 Ant，这使得将测试转移到连续集成环境中变得更加容易（其中许多使用 Ant 目标来定义自己的测试）。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-12-09T11:52:46.723

顺便说一句，让单元测试实际调用 Web 服务、数据库等外部资源是一个坏主意。

单元测试的运行速度应该非常快，并且每次运行套件都会延迟“几分钟”，这意味着它不会像应有的那样运行。

我的建议：

在单元测试中使用 EasyMock ( [http://www.easymock.org/](http://www.easymock.org/) ) 之类的东西来模拟外部依赖项。

[使用 Fitnesse ( http://fitnesse.org/](http://fitnesse.org/) ) 之类的东西或针对测试环境运行且持续运行的本土解决方案构建单独的集成测试套件。

# ruby-on-rails - 如何从 ActiveRecord 中的 Oracle 日期列返回日期（不是 TimeWithZone）？

> ID：349845
> 
> 赞同：0
> 
> 时间：2008-12-08T15:23:07.487
> 
> 标签：ruby-on-rails, oracle, datetime, activerecord

环境：Rails 2.2.2、Oracle 10g

在我的 ActiveRecord 模型中声明为“日期”的大多数列都是这样的：日期：它们根本不关心时间。

所以使用这样声明的模型：#

```
class MyDateOnlyModel < ActiveRecord::Migration
  def self.up
    create_table :my_date_only_model do |t|
      t.date :effective_date
      t.timestamps
    end
  end
end 
```

编写这样的测试：

```
test_date = Date.new(2008,12,05)
MyDateOnlyModel.create!(:effective_date => test_date)
assert_equal test_date, MyDateOnlyModel.find(:first).effective_date 
```

应该通过，不是吗？（当然，假设我在转录上述内容时没有搞砸任何事情）

但它没有——不完全是。我明白了：

```
<Fri, 05 Dec 2008> expected but was
<Fri, 05 Dec 2008 00:00:00 UTC +00:00>. 
```

所以我在数据库中输入了一个日期并得到了……*我*得到了什么？

```
puts MyDateOnlyModel.find(:first).eff_date.class 
```

告诉我我实际上得到了一个`ActiveSupport::TimeWithZone`. 这根本不是我想要的。

有没有一种简单的方法来告诉 ActiveRecord 一些（不是所有）列是`Date`s 并且只有`Date`s？

更新：更多抱怨...

是的，我可以使用 to_date：

```
assert_equal test_date, MyDateOnlyModel.find(:first).effective_date.to_date 
```

工作正常。但这就是我试图避免的。我让 AR 让我约会，我想要约会回来。

我可以在我的类中添加一个方法， Effective_date_as_date - 这也有效。但肯定不是不可能约会，dagnabbit。

**接受前更新**

最终我意识到为什么这是 Oracle 的一个特殊问题：DATE 和 DATETIME 之间没有区别，因此 ActiveRecord 无法单独判断零时间是指午夜（可能带有时区更正）还是只是日期。呸。愚蠢的甲骨文。所以我要么沿着插件路线走，改变我的数据库（很诱人，非常诱人），要么继续我目前的 to_date/to_time 混乱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T15:35:00.393

您是否尝试过将属性转换为 Date 类型？

API 对 to_date 的描述如下：

> 将 self 转换为 Ruby Date 对象；时间部分被丢弃

```
test_date = Date.new(2008,12,05)
MyDateOnlyModel.create!(:effective_date => test_date)
assert_equal test_date, MyDateOnlyModel.find(:first).effective_date.to_date 
```

**更新**：

[增强型 Oracle 适配器](http://blog.rayapps.com/2008/05/13/activerecord-oracle-enhanced-adapter/)

看起来这个适配器可能会解决您的问题...

> 设置下面的选项，因此名称中带有 DATE 的列将被模拟为日期（而不是时间，这是数据库中 DATE 列的默认值）

```
ActiveRecord::ConnectionAdapters::OracleEnhancedAdapter.emulate_dates_by_column_name = true 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T18:36:51.143

我发现了一个错误：您无法将 TimWithZone 与日期进行比较。比较失败，红宝石告诉我。

# java - 颠覆中提取接口重构的最佳体现

> ID：349852
> 
> 赞同：0
> 
> 时间：2008-12-08T15:24:43.490
> 
> 标签：java, svn, refactoring

我正在提取一个我想保留原始名称的接口。根据我们的命名约定，实际的类将获得一个“Impl”后缀。我想知道如何在颠覆中最好地反映这一点，以便历史“AppPropertiesImpl.java”涵盖其作为“AppProperties.java”的生命。至于新的“AppProperties.java”，我认为它可能是新文件或旧文件的副本。知道如何解决这个问题吗？

这是我现在拥有的：

应用程序属性.java

```
public class AppProperties {
    public static final CONSTANT_ONE = "CONSTANT_ONE";

    private String propertyOne;

    public String getPropertyOne() {
        return propertyOne;
    }

    public String setPropertyOne(String propertyOne) {
        this.propertyOne = propertyOne;
    }
} 
```

我想结束：

应用程序属性.java

```
public interface AppProperties {
    public static final CONSTANT_ONE = "CONSTANT_ONE";
    String getPropertyOne();
    String setPropertyOne(String propertyOne);
} 
```

AppPropertiesImpl.java

```
public class AppPropertiesImpl implements AppProperties {
    private String propertyOne;

    public String getPropertyOne() {
        return propertyOne;
    }

    public String setPropertyOne(String propertyOne) {
        this.propertyOne;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T15:27:42.047

重命名`AppProperties.java`为`AppPropertiesImpl.java`（使用`svn rename`）并提交。然后更改您的文件并将新文件添加`AppProperties.java`到 Subversion。瞧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T15:31:49.417

如果要保留要使用的文件的历史记录[svn move](http://svnbook.red-bean.com/en/1.1/re18.html)

```
svn move AppProperties.java AppPropertiesImpl.Java 
```

# visual-studio-2008 - 如何自动化 Visual Studio 的代码指标功能

> ID：349855
> 
> 赞同：11
> 
> 时间：2008-12-08T15:25:25.453
> 
> 标签：visual-studio-2008, msbuild, code-metrics

我想自动化在 .NET 解决方案上收集代码指标的过程。有什么方法可以让 msbuild 运行 VS2008 开发版中包含的 Code Metrics 功能？

我最终可能会使用[SourceMonitor](http://www.campwoodsw.com/sourcemonitor.html)，但我想知道是否有办法从命令行使用 VS 代码指标引擎。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-02-10T17:26:36.123

最后，微软为我们提供了一种使用新的“[电动工具”](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=edd1dfb0-b9fe-4e90-b6a6-5ed6f6f6e615)[自动化 Visual Studio 代码度量功能](http://blogs.msdn.com/b/camerons/archive/2011/01/28/code-metrics-from-the-command-line.aspx)的方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T21:28:54.330

这就是我的公司使用 MSBuild 自动化 FxCop 的方式：

 `````
<!-- The directory where FxCop is installed. -->
<FxCopDirectory>C:\Program Files\Microsoft FxCop 1.36</FxCopDirectory>

<!-- The FxCop console executable.. -->
<FxCopCmd>$(FxCopDirectory)\FxCopCmd</FxCopCmd>

<Target Name="CodeAnalysis>
<!-- Once to get XML for metrics. -->
<Exec Command="&quot;$(FxCopCmd)&quot; /p:&quot;$(BuildDirectory)\FxCop\RuleSet.FxCop&quot; /out:$(BuildResults)\FxCop.xml /summary /verbose /f:$(Binaries)\@(CodeAnalysis, ' /f:$(Binaries)\')" />

<!-- Once to report with the build results. -->
<Exec Command="&quot;$(FxCopCmd)&quot; /p:&quot;$(BuildDirectory)\FxCop\RuleSet.FxCop&quot; /out:$(BuildResults)\FxCop.html /summary /verbose /applyoutXsl:$(MSBuildTasks)\CodeAnalysisReport.xsl /f:$(Binaries)\@(CodeAnalysis, ' /f:$(Binaries)\')" />

<!-- Update the FxCop report so that it is fully expanded by default. -->
<FileUpdate Regex="&lt;body\s"
            ReplacementText="&lt;body onLoad=&quot;ExpandAll();&quot; "
            Files="$(BuildResults)\FxCop.html" />
</Target> 
````  `然后，您可以编写一些 C# 代码来使用输出文件：

```
/// <summary>
/// Gather metrics for code analysis.
/// </summary>
private static void GatherCodeAnalysisMetrics()
{
    string file = @"$(BuildResults)\FxCop.xml";
    if (!File.Exists(file)) return;
    System.Xml.XmlDocument document = new System.Xml.XmlDocument();
    document.Load(file);
    System.Xml.XmlNodeList list = document.SelectNodes("//Message");
    codeAnalysisWarnings = list.Count;

    Console.WriteLine("Code analysis warnings: " + codeAnalysisWarnings);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T14:57:22.973

jgwood - 我相信他指的是代码度量（圈复杂度等）而不是 FxCop。我也一直在为此寻找解决方案，因为复杂性的 FxCop 规则具有硬编码的阈值。听起来 VS2008 中的指标还没有命令行或 API（根据代码分析团队博客上的[这篇文章](http://blogs.msdn.com/fxcop/archive/2007/10/03/new-for-visual-studio-2008-code-metrics.aspx#5395389)）——希望他们会发布一个 powertool。

你看过[NDepend](http://www.ndepend.com/)吗？

# objective-c - 将 UIDatePicker 装入 UIActionSheet

> ID：349858
> 
> 赞同：37
> 
> 时间：2008-12-08T15:27:08.727
> 
> 标签：objective-c, iphone, cocoa-touch, uidatepicker

我试图让带有 UIButton 的 UIDatePicker 显示在 UIActionSheet 中。不幸的是，它被裁剪掉了，整个日期选择器不可见。我什至还没有尝试添加 UIButton。任何人都可以建议让整个视图正确适合吗？我不确定如何添加正确的尺寸，因为 UIActionSheet 似乎缺少`-initWithFrame:`类型构造函数。

```
UIActionSheet *menu = [[UIActionSheet alloc] initWithTitle:@"Date Picker" 
                                                  delegate:self
                                         cancelButtonTitle:@"Cancel"
                                    destructiveButtonTitle:nil
                                         otherButtonTitles:nil];

// Add the picker
UIDatePicker *pickerView = [[UIDatePicker alloc] init];
pickerView.datePickerMode = UIDatePickerModeDate;
[menu addSubview:pickerView];
[menu showInView:self.view];

[pickerView release];
[menu release]; 
```

我也尝试过类似的东西：

```
UIActionSheet *menu = [[UIActionSheet alloc] initWithFrame:CGRectMake(200.0, 200.0, 100.0f, 100.0f)]; 
```

坐标当然是不现实的，但它们似乎不会影响 UIActionSheet 的位置/大小。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-12-09T18:42:21.700

你可以使用这样的东西（调整坐标）：

```
 UIActionSheet *menu = [[UIActionSheet alloc] initWithTitle:@"Date Picker" 
                                                  delegate:self
                                         cancelButtonTitle:@"Cancel"
                                    destructiveButtonTitle:nil
                                         otherButtonTitles:nil];

    // Add the picker
    UIDatePicker *pickerView = [[UIDatePicker alloc] init];
    pickerView.datePickerMode = UIDatePickerModeDate;
    [menu addSubview:pickerView];
    [menu showInView:self.view];    
    [menu setBounds:CGRectMake(0,0,320, 500)];

    CGRect pickerRect = pickerView.bounds;
    pickerRect.origin.y = -100;
    pickerView.bounds = pickerRect;

    [pickerView release];
    [menu release]; 
```

但是您最好使用 UIDatePicker 和导航栏创建全屏视图。有关示例，请参阅 iPhone DevCenter 中的 UICatalog -> Pickers 示例。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-10-07T08:23:40.647

尝试添加以下行来解决禁用按钮问题

```
[menu sendSubviewToBack:pickerView]; 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2010-09-28T17:19:14.557

德米特里的回答*几乎*是正确的。但是，actionsheet 的框架太小，因此选择器底部附近的触摸将被忽略。我已经纠正了这些问题：

```
UIActionSheet *menu = [[UIActionSheet alloc] initWithTitle:@"Date Picker" 
                                                  delegate:self
                                         cancelButtonTitle:@"Cancel"
                                    destructiveButtonTitle:nil
                                         otherButtonTitles:@"OK",nil];    
// Add the picker
UIDatePicker *pickerView = [[UIDatePicker alloc] init];
pickerView.datePickerMode = UIDatePickerModeTime;
[menu addSubview:pickerView];
[menu showInView:_mainView];        

CGRect menuRect = menu.frame;
CGFloat orgHeight = menuRect.size.height;
menuRect.origin.y -= 214; //height of picker
menuRect.size.height = orgHeight+214;
menu.frame = menuRect;

CGRect pickerRect = pickerView.frame;
pickerRect.origin.y = orgHeight;
pickerView.frame = pickerRect;

[pickerView release];
[menu release]; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-04-20T15:52:57.687

这对我有用

```
NSString *title = UIDeviceOrientationIsLandscape([UIDevice currentDevice].orientation) ? @"\n\n\n\n\n\n\n\n\n" : @"\n\n\n\n\n\n\n\n\n\n\n\n" ;
UIActionSheet *actionSheet = [[UIActionSheet alloc] 
                              initWithTitle:[NSString stringWithFormat:@"%@%@", title, NSLocalizedString(@"SelectADateKey", @"")]
                              delegate:self cancelButtonTitle:nil destructiveButtonTitle:nil otherButtonTitles:@"Ok", nil];
[actionSheet showInView:self.view];
UIDatePicker *datePicker = [[[UIDatePicker alloc] init] autorelease];
datePicker.datePickerMode = UIDatePickerModeDate;
[actionSheet addSubview:datePicker]; 
```

有点棘手，但它的工作原理！

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-07-06T11:57:58.193

顶部按钮，底部选择器：

```
 UIActionSheet *menu = [[UIActionSheet alloc] initWithTitle:@"Date Picker" 
                                                  delegate:self
                                         cancelButtonTitle:@"Cancel"
                                    destructiveButtonTitle:nil
                                         otherButtonTitles:@"OK",nil];    
// Add the picker
UIDatePicker *pickerView = [[UIDatePicker alloc] init];
pickerView.datePickerMode = UIDatePickerModeTime;
[menu addSubview:pickerView];
[menu showInView:_mainView];        

CGRect menuRect = menu.frame;
menuRect.origin.y -= 214;
menuRect.size.height = 300;
menu.frame = menuRect;

CGRect pickerRect = pickerView.frame;
pickerRect.origin.y = 174;
pickerView.frame = pickerRect;

[pickerView release];
[menu release]; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-08-10T10:04:23.690

确保在 UITabBarController 内部时在正确的视图中显示 UIActionSheet 以避免底部的交互性问题：

`[actionSheet showInView:self.parentViewController.tabBarController.view];`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-10-04T12:04:38.817

可能不直接回答具体问题（如何让 UIDatePicker 适合），但对于呈现 UIDatePicker（以及其他）的 UIActionSheet 的实现，请参阅[ActionSheetPicker](https://github.com/TimCinel/ActionSheetPicker)。从它的自述文件：

> *使用 PickerView 轻松呈现 ActionSheet，允许用户从多个不可变选项中进行选择。基于 mobilesafari 中的 HTML 下拉选项。*

还：

> *一些代码源自 Marcio 在 Stack Overflow 上的帖子* [[在操作表中添加 UIPickerView 和按钮 - 怎么样？](https://stackoverflow.com/questions/1262574/add-uipickerview-a-button-in-action-sheet-how)]

即使一个人不使用代码，在你自己动手之前阅读它也是很好的。

* * *

### 更新：

此版本已弃用：改用[ActionSheetPicker-3.0](https://github.com/skywinder/ActionSheetPicker-3.0)。

# javascript - javascript style.width 在具有过渡文档类型的 Firefox 中不起作用

> ID：349861
> 
> 赞同：8
> 
> 时间：2008-12-08T15:27:52.890
> 
> 标签：javascript, css, doctype, transitional

我有一个脚本，可以为页面上弹出的小 DIV 设置动画。如果我删除 DOCTYPE，它在 IE 和 FF 中都可以正常工作，但是当 DOCTYPE 是 XHTML/Transitional 时，在 Firefox 中，宽度不会改变。

```
this.container.style.visibility = "visible";
alert("this.container.style.width before = " + this.container.style.width)
this.container.style.width = this.width;
alert("this.container.style.width after = " + this.container.style.width); 
this.container.style.height = this.height; 
```

在 IE 和没有 DOCTYPE 的 FF 中，第一个警报说 0，第二个说 320（这是代码中其他地方设置的宽度）

在 FF 中，使用 DOCTYPE 到 XHTML/Transitional，两个警报都显示为 0。知道这里发生了什么吗？我想我可能需要在过渡中明确设置 DIV 的位置，但我不确定。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-08T15:42:07.603

您是否尝试过设置：

```
this.container.style.visibility = "visible";
alert("this.container.style.width before = " + this.container.style.width);
this.container.style.width = this.width + 'px';
alert("this.container.style.width after = " + this.container.style.width);
this.container.style.height = this.height + 'px';

//Note the 'px' above 
```

我发现尝试在没有单位的情况下设置数字的宽度/高度可能会导致问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-21T08:00:30.803

您可以使用：

```
document.getElementById("td").style.visibility="hidden";
document.getElementById("td").style.display="none"; 
```

而不是宽度属性。

有用！

# asp.net - ASP DropDown 导致 ViewState 出现在地址栏中

> ID：349864
> 
> 赞同：1
> 
> 时间：2008-12-08T15:28:28.740
> 
> 标签：asp.net, vb.net, drop-down-menu, postback, autopostback

如果您在 Internet Explorer 中访问[此页面](http://www.maplesoft.com/company/news/index.aspx)，并从右上角的“当前媒体发布”下拉列表中选择一个值，最终 IE 会尝试将您重定向到包含此字符串的丑陋 url：

__EVENTTARGET=selArchives&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=

该页面应该只更新 selArchives 查询字符串值。

下拉列表将 AutoPostBack 设置为 true，并且代码隐藏在 VB 中，这是事件处理程序：

```
Private Sub selArchives_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles selArchives.SelectedIndexChanged
    Response.Redirect("index.aspx?selArchives=" + selArchives.SelectedValue)
End Sub 
```

显然，我可以自己编写 JavaScript，但我想找到问题的根源。

* * *

不知道具体是什么导致了这个问题。看起来这是几个因素的组合。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T15:45:03.777

去了现场。除了一些弹出的 javascript 错误之外，它似乎工作正常。

== 错误：$ 未定义源文件：[http ://www.maplesoft.com/ScriptResource.axd?d=kNY1h-WYJzKkuCdZqmndbpb67jRr2cZCC6s2tf_nrnwCcH6rvds1RZUYXUp0gdMqnu-6-o6rl1eH-wm7AO9xVw2&t=633640679588907500](http://www.maplesoft.com/ScriptResource.axd?d=kNY1h-WYJzKkuCdZqmndbpb67jRr2cZCC6s2tf_nrnwCcH6rvds1RZUYXUp0gdMqnu-6-o6rl1eH-wm7AO9xVw2&t=633640679588907500)

# 线路：1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T15:39:27.313

该问题仅出现在 IE 中。它在 Firefox 中运行良好，显然 Chrome 也是如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T15:47:20.447

对我来说也适用于 XP2 上的 IE7。

但是，在加载时存在对象预期错误。$ 未定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T15:53:07.347

首先，您的页面有 javascript 错误。请修复它们。

其次，当您选择日期并单击“开始”按钮时，您只会看到丑陋的 url。但是您已将下拉菜单设置为自动回发。放弃按钮；你不需要它。

您的代码隐藏中的按钮有些问题。还有下拉菜单，因为它在几次使用后停止工作。

您必须发布页面的来源以获得更多帮助。

# c# - Wpf TextBlock中的垂直文本

> ID：349875
> 
> 赞同：45
> 
> 时间：2008-12-08T15:34:32.470
> 
> 标签：c#, wpf

是否可以垂直显示 TextBlock 中的文本，以便所有字母相互堆叠（不使用 LayoutTransform 旋转）？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2010-01-19T03:59:34.057

还没有人提到使用纯 XAML 垂直堆叠任意字符串的字母（不旋转它们）的明显而简单的方法：

```
<ItemsControl
  ItemsSource="Text goes here, or you could use a binding to a string" /> 
```

这只是通过识别字符串是 IEnumerable 的事实来垂直布置文本，因此 ItemsControl 可以将字符串中的每个字符视为单独的项目。ItemsControl 的默认面板是 StackPanel，因此字符是垂直排列的。

注意：为了精确控制水平定位、垂直间距等，可以在 ItemsControl 上设置 ItemContainerStyle 和 ItemTemplate 属性。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2010-01-19T01:05:24.127

以防万一有人仍然看到这篇文章......这是一个简单的 100% xaml 解决方案。

```
 <TabControl TabStripPlacement="Left">
        <TabItem Header="Tab 1">
            <TabItem.LayoutTransform>
                <RotateTransform Angle="-90"></RotateTransform>      
            </TabItem.LayoutTransform>
            <TextBlock> Some Text for tab 1</TextBlock>
        </TabItem>
        <TabItem Header="Tab 2">
            <TabItem.LayoutTransform>
                <RotateTransform Angle="-90"></RotateTransform>
            </TabItem.LayoutTransform>
            <TextBlock> Some Text for tab 2</TextBlock>
        </TabItem>
    </TabControl> 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-12-08T15:59:19.673

如果不改变系统固有的文本布局方式，我认为没有直接的做法。最简单的解决方案是更改文本块的宽度并提供一些额外的属性，如下所示：

```
<TextBlock TextAlignment="Center" FontSize="14" FontWeight="Bold" Width="10" TextWrapping="Wrap">THIS IS A TEST</TextBlock> 
```

这很hacky，但它确实有效。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-07-31T12:39:58.223

只需使用一个简单的 LayoutTransform ..

```
<Label Grid.Column="0" Content="Your Text Here" HorizontalContentAlignment="Center">
  <Label.LayoutTransform>
    <TransformGroup>
        <RotateTransform Angle="90" />
        <ScaleTransform ScaleX="-1" ScaleY="-1"/>
    </TransformGroup>
  </Label.LayoutTransform>
</Label> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-08T22:32:42.063

这是可行的：

您`TextBlock`的`TextAlignment`属性应设置为`Center`：

```
<TextBlock Name="textBlock1" TextAlignment="Center" Text="Stacked!" /> 
```

`NewLine`然后在每个字符之间添加s：

```
textBlock1.Text =
    String.Join(
        Environment.NewLine,
        textBlock1.Text.Select(c => new String(c, 1)).ToArray()); 
```

（用于`System.Linq`从原始字符串中的单个字符创建字符串数组。我相信还有其他方法可以做到这一点......）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-02-15T08:48:04.613

下面的 XAML 代码更改了文本块中显示的文本的角度。

```
<TextBlock Height="14"
        x:Name="TextBlock1"
        Text="Vertical Bottom to Up" Margin="73,0,115,0" RenderTransformOrigin="0.5,0.5" >
        <TextBlock.RenderTransform>
            <TransformGroup>
                <ScaleTransform/>
                <SkewTransform/>
                <RotateTransform Angle="-90"/>
                <TranslateTransform/>
            </TransformGroup>
        </TextBlock.RenderTransform>
 </TextBlock> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-10-13T18:25:41.473

Ray Burns 建议的公认答案在 .net 4.0 上对我不起作用。这是我的做法：

拉入 mscorlib

```
xmlns:s="clr-namespace:System;assembly=mscorlib" 
```

放入您的用户控件/窗口/页面资源

```
<s:String x:Key="SortString">Sort</s:String> 
```

并像这样使用它

```
<ItemsControl ItemsSource="{Binding Source={StaticResource SortString}}" Margin="5,-1,0,0"   /> 
```

希望能帮助到你！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-09-28T16:47:42.557

创建一个带有一堆 ot 文本块的堆栈面板，这些文本块需要一个字符

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-09-29T16:19:56.117

使文本容器的最大宽度仅允许一个字符并换行：

```
<TextBlock TextWrapping="Wrap" MaxWidth="8" TextAlignment="Center" Text="stack" /> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-03-21T19:48:59.330

制作图像并用图像填充块，使用photoshop或旨在操纵文本而不是摆弄代码的东西？

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-10-08T18:19:26.640

此代码允许垂直文本堆叠和水平居中字母。

```
<ItemsControl Grid.Row="1"
              Grid.Column="0"
              ItemsSource="YOUR TEXT HERE"
              HorizontalAlignment="Center"
              VerticalAlignment="Center">

    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding}"
                   HorizontalAlignment="Center"/>
        </DataTemplate>
    </ItemsControl.ItemTemplate>

</ItemsControl> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-09T06:04:50.247

这是一种在 TextBlock 文本中的每个字符后插入 '\n' 的方法，这样可以使其垂直显示：

```
<TextBlock x:Name="VertTextBlock" Text="Vertical Text" Loaded="VertTextBlock_Loaded"></TextBlock> 
```

然后，在 Loaded 事件处理程序中，您说：

```
TextBlock tb = sender as TextBlock;
StringBuilder sb = new StringBuilder(tb.Text);
int len = tb.Text.Length * 2;

for (int i = 1; i < len; i += 2)
{
    sb.Insert(i, '\n');
}

tb.Text = sb.ToString(); 
```

该解决方案是由 Lette 提出的，但我相信我的实现会产生更少的开销。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-09-09T05:46:13.550

```
<linebreak/> can be used to show data in two lines 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-04-06T08:47:54.757

您也可以使用“RUN”绑定

在 App.xaml 文件中使用如下内容：

```
<Application x:Class="Some.App"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:commands="clr-namespace:Deridiam.Helper.Commands"
         xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
         ShutdownMode="OnMainWindowClose"
         StartupUri="Views/MainWindow.xaml">
<Application.Resources>

    <commands:HorizontalToVertical x:Key="HorizontalToVertical_Command"></commands:HorizontalToVertical>

    <ControlTemplate x:Key="VerticalCell" TargetType="ContentControl">
            <TextBlock Text="{TemplateBinding Content}" Foreground="Black"
                    TextAlignment="Center" FontWeight="Bold" VerticalAlignment="Center"
                    TextWrapping="Wrap" Margin="0" FontSize="10">  
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="Loaded">
                        <i:InvokeCommandAction Command="{Binding ConvertToVerticalCmd, Source={StaticResource HorizontalToVertical_Command}}" 
                                               CommandParameter="{Binding RelativeSource={RelativeSource AncestorType={x:Type TextBlock}}}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
            </TextBlock>
    </ControlTemplate>

</Application.Resources> 
```

在 app.xaml 示例中的**Loaded**事件上使用**i:Interaction.Triggers**创建绑定到文本块的**命令**类

 ****```
namespace Deridiam.Helper.Commands
{
public class HorizontalToVertical
{
    private ICommand _convertToVerticalCommand;

    public ICommand ConvertToVerticalCmd =>
        _convertToVerticalCommand ?? (_convertToVerticalCommand = new RelayCommand(
                x =>
                {
                    var tBlock = x as TextBlock;
                    var horizontalText = tBlock.Text;
                    tBlock.Text = "";

                    horizontalText.Select(c => c).ToList().ForEach(c =>
                    {
                        if (c.ToString() == " ")
                        {
                            tBlock.Inlines.Add("\n");
                            //tBlock.Inlines.Add("\n");
                        }

                        else
                        {
                            tBlock.Inlines.Add((new Run(c.ToString())));
                            tBlock.Inlines.Add(new LineBreak());
                        }

                    });
                }));
}
} 
```

最后在您希望显示垂直文本的 .xaml 文件中

```
<ContentControl Width="15" Content="Vertical Text" Template="{StaticResource VerticalCell}">
</ContentControl> 
```

将导致：

V
e
r
t
i
c
a
l

T
e
x
t

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-05-28T13:18:16.907

上述解决方案都没有解决我的问题（有些接近），所以我在这里发布我的解决方案，也许可以帮助某人。接受的解决方案对我有帮助，但文本未与中心对齐。

```
<ItemsControl ItemsSource="{Binding SomeStringProperty, FallbackValue=Group 1}" Margin="5"
          TextElement.FontSize="16" 
          TextElement.FontWeight="Bold" 
          TextBlock.TextAlignment="Center"
          HorizontalAlignment="Center" 
          VerticalAlignment="Center" >
<ItemsControl.ItemsPanel>
    <ItemsPanelTemplate>
        <WrapPanel Orientation="Vertical" />
    </ItemsPanelTemplate>
</ItemsControl.ItemsPanel>
<ItemsControl.ItemTemplate>
    <DataTemplate  >
        <TextBlock Text="{Binding }" HorizontalAlignment="Center"  />
    </DataTemplate>
</ItemsControl.ItemTemplate> 
```

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2021-06-23T06:28:02.507

我将提供基于转换器的解决方案：

```
using System;
using System.Collections.Generic;
using System.Globalization;
using System.Windows.Data;
using System.Windows.Markup;

namespace Converters
{
    [ValueConversion(typeof(object), typeof(string))]
    public class InsertLineBreakConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if (parameter != null)
                value = parameter;

            if (value == null)
                return null;

            if (!(value is string str))
                str = value.ToString();

            return string.Join(Environment.NewLine, (IEnumerable<char>) str);
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }

        public static InsertLineBreakConverter Instance { get; } = new InsertLineBreakConverter();
    }

    public class InsertLineBreakConverterExtension : MarkupExtension
    {
        public override object ProvideValue(IServiceProvider serviceProvider)
            => InsertLineBreakConverter.Instance;
    }
} 
```

使用示例：

```
 <TextBlock Text="{Binding Property, Converter={cnvs:InsertLineBreakConverter}}"/>   
   <TextBlock Text="{Binding Converter={cnvs:InsertLineBreakConverter}, ConverterParameter='Some Text'}"/> 
```

# active-directory - 无法从测试/生产服务器修改 Active Directory

> ID：349878
> 
> 赞同：1
> 
> 时间：2008-12-08T15:35:16.353
> 
> 标签：active-directory

好的，因为我在这个问题上处于持有模式，也许有人已经看到了这些症状并且可以提供一些明智的建议。（注意：我只了解了足够的 Active Directory 信息来构建此功能，并且我只有对 Active Directory 的读取权限。）

我更新了公司内网，允许自动输入/修改员工电话/地址信息；它使用 Web 服务连接到公司的 Active Directory，因此我可以从主应用程序中的多个位置调用它。

AD 在同一个林中有两个域（A 和 B）。每个域都有一个“ADS 更新用户”组和一个“ADSupdate”帐户（属于“ADS 更新用户”）。

问题：对于本地开发服务器、测试服务器和生产服务器，域 A 中的条目更新正常。域 B 中的条目仅在从本地开发服务器运行时更​​新。当您在测试或生产上运行相同的代码（多次验证）时，您会收到（一般访问被拒绝错误）。

域名存储在员工记录中，因此为所有员工调用完全相同的代码。

所有本地开发服务器、测试和生产服务器都位于域 A 中。

这让域 B 的 Active Directory 管理员感到困惑，老实说，我很感谢本地开发服务器能够更新域 B 中的 Active Directory 条目。这证明代码至少在一个位置有效

我查看了机器权限、组和用户权限以及 IIS，我发现没有显着差异。任何帮助将不胜感激......</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-08T22:46:14.393

是否在任何 Web 服务应用程序上启用了集成身份验证？

域 A 上的生产应用程序是否安装在域控制器上？

当您从远程机器调用 Web 服务时，来自开发工作站的更新是否有效？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T19:17:50.907

这不是由任何代码更改引起的。生产和测试服务器已升级并运行更新版本的 IIS (6.0)。较新版本的 IIS 将无法跨 Active Directory 域工作。

我的开发机器正在运行旧版本的 IIS (5.1)

这就解释了为什么去年一切正常，然后突然停止工作。另一个领域的员工太少，以至于没有立即注意到。

# php - 如何以编程方式从 linux 中的 apache 重新启动系统服务（不是 apache）？

> ID：349884
> 
> 赞同：5
> 
> 时间：2008-12-08T15:36:39.673
> 
> 标签：php, linux, apache, cgi, restart

我需要一种简单的方法来允许最终用户从同一个盒子上的 apache 提供的网页重新启动 tomcat。

我们正在努力让我们的 QC 部门能够轻松地将新版本的 webapp 部署到 apache。我们正在使用 samba，但我们需要一种简单的方法让他们在部署之前/之后停止/启动 tomcat 服务器。

这仅适用于内部质量控制箱。有没有现成的解决方案？或者编写一些快速的 php 应用程序来处理这个会更容易吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-09T03:15:22.150

就像 Skip 说的那样，但不要以 root 身份运行 CGI。相反，让 CGI 调用 sudo。您可以授予 Web 服务器`/etc/init.d/tomcat restart`仅在 sudoers 文件中运行的权限。

我实际上已经在工作中做到了这一点。CGI 的相关部分如下所示：

```
#!/usr/bin/perl
use CGI;
use IPC::Run3;
my $CGI = new CGI;

my $output;
if (defined $CGI->param('go') && 'restart' eq $CGI->param('go')) {
    run3 [ qw(sudo /etc/init.d/tomcat5.5 restart) ], \undef, \$output, \$output;
}

print <<EOF
Content-type: text/html

Blah, blah, blah, HTML form, displays $output at some point.
EOF 
```

这是来自 /etc/sudoers 的示例行（当然，使用 visudo 进行编辑）：

```
ALL     ALL=(root) NOPASSWD: /etc/init.d/tomcat5.5 restart 
```

这允许每个人重新启动tomcat。如果您愿意，您可以将其限制为 Apache。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T15:40:31.477

我会使用 CGI 脚本。将其设置为以 root 身份运行并调用“/etc/init.d/tomcat restart”（或者在您的机器上重新启动 tomcat）。

# oracle - 试图在内部连接到 Oracle，得到一个空闲实例？

> ID：349886
> 
> 赞同：17
> 
> 时间：2008-12-08T15:36:58.050
> 
> 标签：oracle, instance, idle-processing

所以我有一个 Oracle 实例，我知道它正在这个系统上运行，我已经向 oracle 用户发送了请求，并且我正在尝试使用“/ as sysdba”进行连接。但是，当我连接时，它说实例处于空闲状态。我知道数据库已启动并打开，因为我的应用程序正在与它交谈。我的路径（ORACLE_HOME 等）可能不正确：知道哪个不正确的设置可能会导致这种情况吗？

```
% sqlplus "/ as sysdba"

SQL*Plus: Release 10.2.0.3.0 - Production on Mon Dec 8 09:23:22 2008

Copyright (c) 1982, 2006, Oracle.  All Rights Reserved.

Connected to an idle instance.

09:23:22 SQL> Disconnected

% ps -ef | grep smon
 oracle  6961     1   0   Nov 05 ?           1:24 ora_smon_ORA003
% 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-09T01:26:46.580

确保您的 ORACLE_HOME 设置与服务器启动时完全相同，我在 solaris 上看到了 oracle 9.2.0.5.0 的这个问题，

```
ORACLE_HOME=/opt/oracle
ORACLE_HOME=/opt/oracle/ 
```

是两个不同的东西，会导致本地连接问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-08T15:42:41.783

这意味着数据库实例未安装或打开。执行*启动*命令，看看是否出现错误。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-06-29T08:37:32.327

谢谢。它确实是 ORACLE_HOME 变量末尾的额外斜杠。

在我的情况下，看看奇怪 - 我登录到服务器并尝试连接但得到了上述错误。我知道该实例已启动并且数据库已打开。所以检查了 ORACLE_HOME，因为我有点意识到这种可能性。我看到的是 ORACLE_HOME 很好（即末尾没有额外的斜线）。然后当我读到这个线程时尝试了很多之后，它让我印象深刻。数据库以 ORACLE_HOME 开头，带有额外的前斜杠。所以数据库是从 ORACLE_HOME=/u01/app/oracle/product/10.2.0.3/ 开始的，而我一直在尝试 ORACLE_HOME=/u01/app/oracle/product/10.2.0.3 :(

再次感谢。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-08T18:42:51.543

数据库不能在空闲的同时被您的应用程序使用。似乎 sqlplus 会话必须连接到与应用程序不同的实例。尝试在连接语句中指定连接标识符，如下所示：

```
sqlplus "/@ConnectIdentifier as sysdba" 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-17T20:51:31.207

大小写在 *nix 系统上很重要，因此请确保您的 ORACLE_SID 与实例名称完全匹配。在这种情况下，ORA003 与 ora003 不同。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-12T04:53:38.607

从机器控制台尝试

```
export ORACLE_SID=your sid here
sqlplus /nolog
startup 
```

我知道在windows上有一个命令可以创建一个服务来为你启动一个实例，或者admin -new -sid %ORACLE_SID% -intpwd %oracle_pwd% -startmode A

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-03-14T06:51:53.417

我有同样的问题。通过删除 ORACLE_HOME 末尾多余的“/”解决了它。

感谢分享——如果没有这个博客，诊断和解决这个问题真的很困难。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-01-04T13:24:42.283

试试这个登录`sqlplus sys/sys as sysdba`

```
SQL> startup 
```

输出应该是这样的：\n

```
Total System Global Area  467652608 bytes
Fixed Size          2214416 bytes
Variable Size         352323056 bytes
Database Buffers      104857600 bytes
Redo Buffers            8257536 bytes
Database mounted.
Database opened. 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-11-21T21:57:37.737

好的，这就是我发现的关于实例空闲的内容，它与 spfile.. 有时您`init.ora`位于其他地方

`init.ora`找到位置后尝试搜索

试试那个代码`startup spfile="C:\location";`

它会说该实例已启动。

那个对我有用

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-06-05T04:12:57.493

我在指定错误的 SID（xe 而不是 XE）时遇到了同样的问题。如果您使用 rpm 安装数据库，请检查 /etc/inid.d/oracle 中的所有环境

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-02-12T05:30:09.580

我尝试了 sqlplus dummy/dummy，它给了我实际的问题（内存不足）。我使内存可用，并且能够毫无问题地登录。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-09-10T11:31:35.400

问题可能是由于数据库非常繁忙而无法打开会话。在这种情况下，连接使用任何用户，甚至是虚拟用户

sqlplus 虚拟/虚拟

会给你实际的问题，但不是空闲的实例。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-07-01T08:03:11.953

只需输入：

```
shutdown abort 
```

然后

```
startup 
```

# c++ - 您如何确定 C++ 中 Linux 系统 RAM 的数量？

> ID：349889
> 
> 赞同：31
> 
> 时间：2008-12-08T15:38:24.973
> 
> 标签：c++, linux, ram

我刚刚编写了以下 C++ 函数来以编程方式确定系统安装了多少 RAM。它有效，但在我看来，应该有一种更简单的方法来做到这一点。我错过了什么吗？

```
getRAM()
{
    FILE* stream = popen("head -n1 /proc/meminfo", "r");
    std::ostringstream output;
    int bufsize = 128;

    while( !feof(stream) && !ferror(stream))
    {
        char buf[bufsize];
        int bytesRead = fread(buf, 1, bufsize, stream);
        output.write(buf, bytesRead);
    }
    std::string result = output.str();

    std::string label, ram;
    std::istringstream iss(result);
    iss >> label;
    iss >> ram;

    return ram;
} 
```

首先，我`popen("head -n1 /proc/meminfo")`用来从系统中获取 meminfo 文件的第一行。该命令的输出看起来像

> 内存总量：775280 kB

一旦我在 中获得了该输出`istringstream`，就可以很容易地对其进行标记以获得我想要的信息。有没有更简单的方法来读取这个命令的输出？是否有一个标准的 C++ 库调用来读取系统 RAM 的数量？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2008-12-08T16:18:40.773

在 Linux 上，您可以使用`sysinfo`在以下结构中设置值的函数：

```
 #include <sys/sysinfo.h>

   int sysinfo(struct sysinfo *info);

   struct sysinfo {
       long uptime;             /* Seconds since boot */
       unsigned long loads[3];  /* 1, 5, and 15 minute load averages */
       unsigned long totalram;  /* Total usable main memory size */
       unsigned long freeram;   /* Available memory size */
       unsigned long sharedram; /* Amount of shared memory */
       unsigned long bufferram; /* Memory used by buffers */
       unsigned long totalswap; /* Total swap space size */
       unsigned long freeswap;  /* swap space still available */
       unsigned short procs;    /* Number of current processes */
       unsigned long totalhigh; /* Total high memory size */
       unsigned long freehigh;  /* Available high memory size */
       unsigned int mem_unit;   /* Memory unit size in bytes */
       char _f[20-2*sizeof(long)-sizeof(int)]; /* Padding for libc5 */
   }; 
```

如果您只想使用 C++ 的函数来完成它（我会坚持使用`sysinfo`），我建议您使用 C++ 方法使用`std::ifstream`and `std::string`：

```
unsigned long get_mem_total() {
    std::string token;
    std::ifstream file("/proc/meminfo");
    while(file >> token) {
        if(token == "MemTotal:") {
            unsigned long mem;
            if(file >> mem) {
                return mem;
            } else {
                return 0;
            }
        }
        // Ignore the rest of the line
        file.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
    }
    return 0; // Nothing found
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-08T16:17:15.397

没有任何需要使用`popen()`. 您可以自己阅读文件。

此外，如果他们的第一行不是您要查找的内容，您将失败，因为`head -n1`只读取第一行然后退出。我不确定你为什么要像这样混合 C 和 C++ I/O；完全没问题，但您可能应该选择全部使用 C 或全部 C++。我可能会这样做：

```
int GetRamInKB(void)
{
    FILE *meminfo = fopen("/proc/meminfo", "r");
    if(meminfo == NULL)
        ... // handle error

    char line[256];
    while(fgets(line, sizeof(line), meminfo))
    {
        int ram;
        if(sscanf(line, "MemTotal: %d kB", &ram) == 1)
        {
            fclose(meminfo);
            return ram;
        }
    }

    // If we got here, then we couldn't find the proper line in the meminfo file:
    // do something appropriate like return an error code, throw an exception, etc.
    fclose(meminfo);
    return -1;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-08T17:20:50.087

请记住*/proc/meminfo*只是一个文件。打开文件，读取第一行，然后关闭文件。瞧！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-08T16:03:20.133

甚至`top`（从`procps`）解析`/proc/meminfo`。见[这里](http://procps.cvs.sourceforge.net/viewvc/procps/procps/proc/sysinfo.c?revision=1.40&view=markup)。

# sql - SQL 优先级查询

> ID：349892
> 
> 赞同：1
> 
> 时间：2008-12-08T15:39:42.117
> 
> 标签：sql, operator-precedence

我有一个包含三列的日志记录表。一列是唯一标识符，一列称为“名称”，另一列是“状态”。
Name 列中的值可以重复，因此您可能会在多行中看到名称“Joe”。名称“Joe”可能有一行状态为“open”，另一行状态为“closed”，另一行状态为“waiting”，可能还有一个状态为“hold”。我想使用从最高到最低顺序定义的优先级：("Closed","Hold","Waiting" and "Open") 为每个 Name 拉出排名最高的行并忽略其他行。任何人都知道一个简单的方法来做到这一点？

顺便说一句，并不是每个 Name 都会有所有的状态表示，所以“Joe”可能只有一行用于“等待”和“等待”，或者可能只是“等待”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-08T15:43:53.137

我会创建一个名为“Status_Precedence”的第二个表，其行如下：

```
Status  | Order
---------------
Closed  |  1
Hold    |  2
Waiting |  3
Open    |  4 
```

在您对另一个表的查询中，对该表进行连接（on `Status_Precedence.Status`），然后您就可以了`ORDER BY Status_Precedence.Order`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-08T15:51:45.743

如果您不想创建另一个表，可以使用 SELECT CASE 分配数字优先级

```
Select Name, Status, Case Status 
        When 'Closed' then 1
        When 'Hold' then 2
        When 'Waiting' then 3
        When 'Open' Then 4
        END
         as StatusID

         From Logging
Order By StatusId -- Order based on Case 
```

查找表也是一个很好的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T17:21:46.700

我最终使用了 matt b 的解决方案并使用这个最终查询来过滤掉排名较低的（较低的 bing 编号较高）。

```
SELECT * from [TABLE] tb
LEFT JOIN Status_Precedence sp ON tb.Status = sp.Status
WHERE  sp.Rank = (SELECT MIN(sp2.rank)
                FROM[Table] tb2
           LEFT JOIN Status_Precedence sp2 ON tb2.Status = sp2.Status
                WHERE tb.Status = tb2.Status)
order by tb.[name] 
```

# prolog - 在 prolog 中传递结果

> ID：349896
> 
> 赞同：1
> 
> 时间：2008-12-08T15:40:39.540
> 
> 标签：prolog

我正在尝试创建一个具有列表列表的函数，它将内部列表的总和与外部列表相乘。到目前为止，我可以总结一个列表，我已经创建了一个函数 sumlist([1..n],X)，它将返回 X = (result)。但是我无法获得另一个函数来有效地使用该函数，我已经尝试过 is 和 = 都无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T17:25:28.020

你是这个意思吗？

```
prodsumlist([], 1).

prodsumlist([Head | Tail], Result) :-
    sumlist(Head, Sum_Of_Head),
    prodsumlist(Tail, ProdSum_Of_Tail),
    Result is Sum_Of_Head * ProdSum_Of_Tail. 
```

`sumlist/2`SWI-Prolog 内置在哪里。

使用示例：

```
?- prodsumlist([[1, 2], [3], [-4]], Result).
Result = -36. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T01:16:28.333

“它将内部列表的总和与外部列表相乘”的部分并不是很清楚，但我相信你的意思是，给定一个`[L1,...,Ln]`数字列表列表，你想要计算(对于每个）。`S1*..*Sn``Si``Li``i`

`plus`我假设和的存在`mult`具有明显的含义（例如，当等于`plus(N,M,R)`时恰好成立）。首先，我们需要这样的谓词，当且仅当是 的元素之和时才成立。如果为空，显然必须是：`R``N+M``sum``sum(L,S)``S``L``L``S``0`

```
sum([],0). 
```

如果`L`不是空的而是 的形式`[N|L2]`，那么我们有`S`必须`N`加上`S2`中的元素的总和`L2`。换句话说，我们必须同时拥有`sum(L2,S2)`（让 S2 成为 的元素之和`L2`）和`plus(N,S2,S)`。那是：

```
sum([N|L2],S) :- sum(L2,S2), plus(N,S2,S). 
```

以同样的方式，您可以找出`p`您正在寻找的谓词。我们希望`p(L,R)`当且仅当`R`它是`S1`through `Sn`where `L=[L1,...,Ln]`and `sum(Li,Si)`for all的产物时才成立`i`。如果`L`为空，则`R`必须为`1`：

```
p([],1). 
```

如果`L`不是空的，而是 的形式`[LL|L2]`，那么我们有它`R`必须是“S”的乘积，“S”是 的元素之`LL`和，“P”是 中的列表之和的乘积`L2`。因为`S`我们已经有了`sum(LL,S)`，所以这给了我们以下内容。

```
p([LL|L2],R) :- sum(LL,S), p(L2,P), mult(S,P,R). 
```

我想补充的一件事是，将这些谓词视为您可能习惯于命令式或函数式编程的函数可能不是一个好主意。`sumlist([1,..,n],X)`返回的情况并非如此`X = (result)`；`(result)`是这样的一个值，`X`这`sumlist([1,...,n],X)`是真的。这需要稍微不同的心态。而不是思考“我如何计算 X 使得 p(X) 成立？” 你一定会想“P(X) 什么时候成立？” 并使用答案（“好吧，如果 q(X) 或 r(X)！”）构成从句 ( `p(X) :- q(X)`and `p(X) :- r(X)`)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-28T06:34:34.290

Here is a rewrite of [Kaarel's answer](https://stackoverflow.com/questions/349896/passing-results-in-prolog/353572#353572) (that's the intention anyway!) but [tail-recursive](http://www.cs.mu.oz.au/255/last_semester/last_semester/prolog_course/md5/md5_accumulators.html).

```
prodsumlist(List, Result) :-
    xprodsumlist(List,1,Result).

xprodsumlist([],R,R).

xprodsumlist([Head|Rest],Sofar,Result) :-
    sumlist(Head, Sum_Of_Head),
    NewSofar is Sofar * Sum_Of_Head,
    xprodsumlist(Rest, NewSofar, Result). 
```

# c++ - 哪些 C++ 编译器已经支持 lambda？

> ID：349899
> 
> 赞同：10
> 
> 时间：2008-12-08T15:41:20.180
> 
> 标签：c++, lambda

是否有 C++ 编译器已经支持[C++0x](http://en.wikipedia.org/wiki/C%2B%2B0x) [lambda](http://en.wikipedia.org/wiki/Lambda_calculus)表达式？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-08T15:45:09.673

[Visual Studio 2010 CTP](https://connect.microsoft.com/VisualStudio/content/content.aspx?ContentID=9790)已经支持它。

**更新：**现在是[Visual Studio 2010 Beta 2](http://msdn.microsoft.com/en-us/vstudio/dd582936.aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-08T15:49:44.640

g++ 从[4.5](http://gcc.gnu.org/gcc-4.5/changes.html)开始支持。可以在[此处](http://gcc.gnu.org/projects/cxx0x.html#lambdas)找到 gcc 中 C++11 支持的状态。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-10-28T15:25:48.253

如果您使用 -std=gnu++0x 启用它，G++ 在 4.5 中支持它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-09T20:38:10.877

英特尔 C++ 编译器可以，例如根据[TBB](http://www.threadingbuildingblocks.org/documentation.php)教程。

# numbers - 钢琴（Peano）号码？

> ID：349902
> 
> 赞同：2
> 
> 时间：2008-12-08T15:43:16.650
> 
> 标签：numbers, podcast, peano-numbers

我正在听 steve yegge 播客（#29，大约 21:29），其中一部分是，他们在谈论“如何判断与您交谈的人是否聪明”，他们以一种方式说是谈论“聪明人的事情”（我在解释），比如“钢琴数字”和“λ演算”。
我有足够的把握承认我不是世界上最聪明的人，但即使谷歌似乎也无法告诉我“钢琴号码”是什么。那么，我是否听错了播客上所说的内容？谁能告诉我什么是“钢琴号码”？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-08T15:47:35.487

聪明和拥有一定的知识基础不是一回事。

我会警惕听任何将两者等同的人。

并且以真正的方式，我将汇总其他答案。他们很可能是指Peano：

[http://en.wikipedia.org/wiki/Peano_axioms](http://en.wikipedia.org/wiki/Peano_axioms)

[http://en.wikipedia.org/wiki/Giuseppe_Peano](http://en.wikipedia.org/wiki/Giuseppe_Peano)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-08T15:45:14.867

也许是[皮亚诺？](http://en.wikipedia.org/wiki/Peano_axioms)

> 在数理逻辑中，Peano 公理，也称为 Dedekind-Peano 公理或 Peano 公设，是 19 世纪意大利数学家 Giuseppe Peano 提出的一组自然数公理。这些公理在许多元数学研究中几乎没有改变，包括对数论一致性和完整性的基本问题的研究。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-08T16:05:49.333

OTOH，谈论完全虚构的事情（例如“钢琴数字”）并看看谁假装对此很了解，这可能是对性格的一个很好的考验。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T16:04:52.300

**那些将智力等同于知识的人，两者都有缺陷。**

（请注意，我没有具体说明缺陷的大小，尤其是在 Yegge 的情况下。）

当我参加门萨考试时，我对这两门学科一无所知，但这并没有阻止我（脸红！）得分很好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-08T15:45:54.973

他可能指的是皮亚诺数字。Guiseppe Peano 是一位数学家。

[http://en.wikipedia.org/wiki/Giuseppe_Peano](http://en.wikipedia.org/wiki/Giuseppe_Peano)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-01T09:39:29.053

您可以在关于 lambda 演算的维基百科文章中找到 Peano 想法的实现：

[http://en.wikipedia.org/wiki/Lambda_calculus](http://en.wikipedia.org/wiki/Lambda_calculus)

更多关于 lambda 演算、lamdba 表达式和动态语言中的相关使用：

[http://delicious.com/ajlopez/lambda](http://delicious.com/ajlopez/lambda)

我正在使用 C# [http://code.google.com/p/ajcodekatas/source/browse#svn/trunk/AjLambda进行 lambda 演算的简单实现](http://code.google.com/p/ajcodekatas/source/browse#svn/trunk/AjLambda)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-07T19:21:36.657

对于那些对皮亚诺数的精确定义感兴趣的人，请在[此处](http://cs.calstatela.edu/wiki/index.php/Courses/CS_332L/Peano_arithmetic)查看此说明。简而言之，Peano 提出了一种使用后继函数生成自然数的递归方法。嵌套后继函数形式的数字称为皮亚诺数。这是教授逻辑编程时的常见话题。

# c# - 将集合作为属性的类与继承集合的类

> ID：349904
> 
> 赞同：8
> 
> 时间：2008-12-08T15:44:49.640
> 
> 标签：c#, class, inheritance

最近我使用了一个从集合继承的类，而不是在类中实例化集合，这是可以接受的，还是会在未来产生看不见的问题？为了清楚起见，下面的示例：

```
public class Cars : List<aCar> 
```

而不是类似的东西：

```
public class Cars
{
 List<aCar> CarList = new List<aCar>();
} 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-08T15:52:32.107

这样做的问题是您的 Cars 类仍将具有它从 List 继承的接口，这可能允许您不想要的操作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-08T15:53:45.833

这取决于你上课的最终目的。如果它仅作为您自己的集合实现工作，请使用继承。如果没有，请包含一个集合作为属性。第二种选择更通用：

*   由于您只能从一个类继承，您可能需要从另一个类而不是集合继承
*   如果您需要将此类视为一个集合，您可以包含一个索引器属性。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-08T15:58:22.017

我之前误读了这个问题。

我建议使用组合而不是继承。如果您希望能够使用所有时髦的 LINQ 东西，请务必实现`IEnumerable<T>`，甚至可能`IList<T>`- 但我不会`List<T>`直接派生自。

如果您*确实*想“免费”获得收藏品但仍保留控制权，则可以使用[CollectionBase](http://msdn.microsoft.com/en-us/library/system.collections.collectionbase.aspx)。这仍然会束缚您的一次继承权，但至少您可以更好地控制收藏中发生的事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-08T15:59:06.743

如果你想让你的 Cars 类表现得像一个 List 并且拥有相同的方法，那还不错。你只是从中派生出来，你就完成了。然后，如果您想添加任何其他功能，只需声明这些方法即可。但是，您现在已绑定到 List，如果 List 以任何不合需要的方式更改，您就完蛋了。

当您改为将其设为复合类并在类中实例化 List 时，您只需要公开您想要公开的 List 的方法。但这意味着你也必须重复它们。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-08T16:14:46.943

如果该类的目的是为标准集合添加附加功能，那么我将从该集合继承。如果收藏只是更大图景的一部分，那听起来更像是一种财产。

但是，除非您确实需要 List<T> 中的功能，否则我会考虑使用 Collection<T> 而不是 List<T>。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-08T17:32:21.500

真的需要“汽车”课程吗？有比“列表”更多的功能吗？如果没有，您应该使用“List”（或更好的“IList”）。

如果“汽车”类有任何附加功能，则主要有两种情况：

*   这个类是“final”类，可能性不大，其他人需要扩展它。那么这个结构可以吗。
*   这个类可能会被用作基类。然后我建议使用这种结构：

.

```
public class CarList<T> : List<T> where T : Car {
    // some added functionality
} 
```

如果您希望将来更加灵活，您应该使用组合：

```
public class CarList<T> : IList<T> where T : Car {
    private IList<T> innerList;
    public CarList() { this.innerList = new List<T>(); }

    // implementation of IList<T>

    // some added functionality
} 
```

# c# - 在 Visual Studio 中调试第三方 DLL？

> ID：349918
> 
> 赞同：18
> 
> 时间：2008-12-08T15:48:57.480
> 
> 标签：c#, .net, debugging, dll

我正在使用第三方 DLL。对于某些特定情况，DLL 中的函数会引发异常。是否可以在 Visual Studio 中调试 DLL？

在[Andrew Rollings 的回答](https://stackoverflow.com/questions/349918/debugging-a-third-party-dll-in-visual-studio/349925#349925)之后，我可以查看代码，但是有没有简单的方法可以通过 Visual Studio 中的代码进行调试？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-08T15:51:42.153

如果 DLL 是[.NET](http://en.wikipedia.org/wiki/.NET_Framework)语言，您可以使用[.NET Reflector](http://en.wikipedia.org/wiki/.NET_Reflector)等工具对其进行反编译，然后针对源代码进行调试。

或者您可以询问供应商是否有源代码。这可能是最简单的方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-08T16:15:31.530

基于 Andrew 的回答，您只需将反编译的源代码视为项目中的新库，并在源代码中设置断点。删除对第 3 方 DLL 的所有引用，以便它是正在执行的反编译代码。

其他事情：

*   反编译代码或违反与第 3 方供应商的许可协议可能会触犯法律。确保与某人一起查看此内容。
*   如果您要交付给其他开发人员或检查更大的源代码树，您将需要确保删除对反编译版本的引用。很容易忘记这一点！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-08T18:08:39.740

我遇到过两种方法：

**1）从使用项目访问DLL项目。** 这涉及在 Visual Studio 的单独实例中构建 DLL，然后通过 Visual Studio 中的不同项目访问 DLL（假设您拥有源代码）。有多种方法可以做到这一点：

*   您可以`Trace.WriteLine` 在 DLL 中添加将显示在 Visual Studio 的“输出”窗口中的语句。
*   您可以将`System.Diagnostics.Debugger.Break()`语句添加到 DLL 代码中。在 Visual Studio 中运行调用项目时，程序执行将在那里停止。从这里您可以添加访问调用堆栈（包括 DLL 本身中的所有函数调用）并设置断点（尽管断点的图标将显示为禁用，并且断点的悬停文本将显示“断点当前不会被命中. 没有为此文档加载任何符号")。
*   如果 DLL 抛出异常（如果异常被 DLL 捕获并处理，您可以从“输出”窗口中看到），您可以告诉 Visual Studio 在抛出该类型的异常时始终中断。点击`Ctrl`++ ，找到`Alt`抛出`E`的异常类型，然后单击该异常的“抛出”列。从这里开始，就像您使用过一样 `System.Diagnostics.Debugger.Break()` （见上文）。

**2) 将使用进程附加到 DLL 项目。** 这涉及将 Visual Studio 调试器挂接到正在运行的进程中。

*   在 Visual Studio 中打开 DLL 项目。
*   运行一个使用 DLL 的应用程序（这个应用程序不能从另一个 Visual Studio 实例运行，因为该进程已经附加了一个调试器）。
*   从这里您可以添加断点并单步执行在 Visual Studio 中加载的 DLL 代码（尽管断点将显示为与方法 1 中相同的禁用）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-08T19:03:00.583

调试几个第三方库以及[.NET](http://en.wikipedia.org/wiki/.NET_Framework)本身对我有用的是[WinDbg](http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx)。它是 Microsoft 的一个很棒的调试器，我用它来解决框架内部发生的一些棘手问题。

如果它是托管 DLL，则需要使用[Son of Strike (SOS) 扩展。](https://stackoverflow.com/questions/3572990/whats-the-story-behind-the-name-of-the-sos-son-of-strike-debugger-extension)它也可以调试本机。您需要了解一些关于调用堆栈和汇编/ [CIL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)指令的知识才能熟练使用它。您应该能够确定异常以及导致异常的原因。例如，我们使用 WinDbg/SOS 发现，在 HttpWebResponse 中，如果您使用 Gzip 压缩下载页面并且服务器返回错误的 Gzip 标头，.NET 在线程池中运行解压缩，并且崩溃会导致您的进程崩溃。调试愉快。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-04-18T19:28:06.000

我们应该在这里提到的另一个选项是 dotPeek 1.2（来自 ReSharper 创建者的免费反编译器）。这是一篇很好的文章，描述了如何配置 VS 符号服务器和 dotPeek 1.2 以从 VisualStudio 调试反编译代码：http: [//blog.jetbrains.com/dotnet/2014/04/09/introducing-dotpeek-1-2-early-访问程序](http://blog.jetbrains.com/dotnet/2014/04/09/introducing-dotpeek-1-2-early-access-program)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-23T13:51:38.980

正如 Cesar Reyes 在 Stack Overflow 问题*[Visual Studio - Attach source code to reference 中提到](https://stackoverflow.com/questions/2620279/visual-studio-attach-source-code-to-reference)*的那样，[ReSharper](http://en.wikipedia.org/wiki/ReSharper) 5（及更高版本）具有此功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-08T16:28:07.557

我认为 .NET Reflector 有一些调试插件。那将是一个更好的主意，因为反编译和重新编译代码通常会失败，并且您需要对代码进行很多更改才能修复它。

试试 .NET Reflector 调试器。它可能对你有很大帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-29T18:21:31.167

.NET Reflector 6 附带一个 Visual Studio 插件，可让您在没有源代码的程序集上使用 Visual Studio 的逐步调试。

看看这篇博文：

[http://www.simple-talk.com/community/blogs/alex/archive/2009/09/22/74919.aspx](http://www.simple-talk.com/community/blogs/alex/archive/2009/09/22/74919.aspx)了解更多详情。

这仍然是一个非常早期的构建。所以不能保证它会工作，它可能会破坏你的 Visual Studio 配置或项目配置。确保您对使用它的任何项目都有备份（或源代码控制）。

在这里下载： [http ://www.red-gate.com/MessageBoard/viewforum.php?f=109](http://www.red-gate.com/MessageBoard/viewforum.php?f=109)

# java - Toplink 对象未显示在 JDeveloper 中的 Toplink Map 节点下

> ID：349923
> 
> 赞同：1
> 
> 时间：2008-12-08T15:51:25.930
> 
> 标签：java, jakarta-ee, ejb, toplink, jdeveloper

由于某种原因，我在 TL Map 下看不到任何生成的对象。查看包含的图像（对不起，它不会使用社区 wiki 软件呈现......

[http://img261.imageshack.us/my.php?image=nothingundernodetn5.png](http://img261.imageshack.us/my.php?image=nothingundernodetn5.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-10T18:03:44.383

好吧，问题来了：教程显示Toplink地图可以展开。显然它不能在 Jdeveloper 10.1.3.0.4 中。您需要选择 Toplink 地图，然后找到 STRUCTURE 面板。这就是您现在扩展 Toplink 地图的方式。

# php - LAMP 堆栈是否适合企业使用？

> ID：349924
> 
> 赞同：26
> 
> 时间：2008-12-08T15:51:36.243
> 
> 标签：php, ruby, architecture, lamp, enterprise

LAMP（Linux、Apache、MySQL、PHP/Ruby/Python）堆栈是否适合企业使用？

明确地说，“企业”是指大型或超大型公司，其中安全性、稳健性、技能组合的可用性、总拥有成本 (TCO)、可扩展性和工具的可用性是关键考虑因素。换句话说，一家寻求外部采用框架/架构的公司——在这种环境中，无处不在的东西将被视为比异国情调/深奥的东西更“有效”。

我见过 Oracle、IBM 和 Sun 在 LAMP 堆栈上为各种企业实施系统的用例。我还看到了一些例子，其中像 yellowpages.com (Ruby on rails) 和 Facebook (php) 等网站都是基于它构建的。但是，这些示例都不是我正在寻找的。

我真的想在大型银行（即花旗集团）、电信公司（即 AT&T）或制造商（即 Proctor and Gamble）中找到它是企业标准的示例。为了清楚起见，我不是在寻找一个在有限意义上使用它的例子（比如在摩根大通），而是它是 CRM、制造系统或人力资源管理等系统的核心平台，以及内部和外部网站。

到目前为止，我所看到的看法是，基于 LAMP 堆栈构建的应用程序执行速度较慢且灵活性较差。我听到的一些论点是：

*   Linux 的支持不如 Unix、Solaris 或 Windows 服务器好。

*   Apache 比 BEA WebLogic 或 IIS 等 Web 服务器更难配置和维护。

*   对于业余爱好者来说，MySQL 是一个“尚未准备好迎接黄金时段”的数据库，而不是 SQL Server 或 Oracle 的竞争对手（尽管 PostgreSQL 似乎以更健壮而闻名）。

*   PHP / Ruby on rails 针对 CRUD（创建、读取、更新和删除操作）进行了优化。尽管在构建 CRUD 密集型 Web 应用程序时这是一个优势，但两者的执行速度都比 Java/Java EE 或 C#（它们都是常见的企业标准）慢。此外，许多应用程序和系统（如制造系统）具有许多非 CRUD 功能，使用 PHP 或 Ruby 甚至 Python 可能更难构建。

任何人都可以提供论据来支持或反驳 LAMP 堆栈适合企业的想法吗？

谢谢！

K A

更新：[有时 LAMP 堆栈适合企业使用：面向外部的博客](http://kaiseradvisor.blogspot.com/2009/07/sometimes-lamp-stack-is-appropriate-for.html)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-08T15:59:39.190

“但它是 CRM 和 HR 等系统以及内部和外部网站的核心平台”

首先，找到 LAMP CRM 或 HR 应用程序。

然后为 LAMP CRM 或 HR 应用程序寻找客户。

遗憾的是，第 1 项的示例并不多。因此，您的情况得到了证明。它不能用于企业应用程序，因为——目前——没有任何你称之为“企业”的应用程序。

但是，您的其他观点非常有趣。

1.  **Linux 的支持不如 Unix、Solaris 或 Windows Servers 好**。我认为红帽会强烈反对这一点。给他们打电话。我认为他们会做出非常有说服力的推销。阅读他们的[成功故事](http://customers.press.redhat.com/)。

2.  **Apache 比 BEA WebLogic 或 IIS 等 Web 服务器更难配置和维护**。通过谁？Apache 网站管理员？还是 IIS 网站管理员？这完全是主观的。

3.  **MySQL 是一个“尚未准备好迎接黄金时段”的数据库**。与 Sun Microsystems 合作。我想他们会强烈反对这一点。给他们打电话。我认为他们会做出非常有说服力的推销。阅读他们的[成功故事](http://www.sun.com/systems/solutions/mysql/perspectives.jsp)。

4.  **PHP / Ruby on rails 针对 CRUD 进行了优化，并且两者都在缓慢执行**。可能是真的。Java 和 Python 可能会更快。PHP 和 Ruby 并不是 LAMP 中的硬道理。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-08T23:44:06.507

> 在这种环境中，无处不在的东西将被视为比异国情调/深奥的东西更“有效”。

尽管由于语言中的许多缺陷，我个人不会推荐 PHP，但它肯定无处不在。随着 phusion 乘客的出现，共享托管公司对 Rails 的支持也在迅速增长。在 90% 以上的共享主机帐户支持开箱即用的 Rails 之前，我最多再给它一两年。如果这不是无处不在，那是什么？

> Linux 的支持不如 Unix、Solaris 或 Windows 服务器好。

如果这让您感到困扰，请从 RedHat 购买支持，或者安装 Solaris 并从 Sun 购买支持。两者都将为您提供与 Microsoft 可能提供的一样好的支持

> Apache 比 BEA WebLogic 或 IIS 等 Web 服务器更难配置和维护。

我不能代表 BEA WebLogic，但是在配置了 Apache、IIS 和 Tomcat 之后，Apache 是最容易理解的，并且很容易找到示例和文档*。*

> 对于业余爱好者来说，MySQL 是一个“尚未准备好迎接黄金时间”的数据库，而不是 SQL Server 或 Oracle 的竞争对手。

[哦真的吗？](http://www.mysql.com/customers/). 您应该将告诉 NASA、Google、CERN、路透社等公司作为您的使命，他们都在使用尚未准备好迎接黄金时段的业余爱好者数据库。

> PHP / Ruby on rails 针对 CRUD 进行了优化，两者的执行速度都比 Java/Java EE 或 C#（它们都是常见的企业标准）慢。

这里有两件事：

针对 CRUD 进行了优化 - 这完全无关紧要。
Rails 和一些 python/php 框架针对 CRUD 应用程序进行了优化。许多 C#/Java 框架也针对 CRUD 应用程序进行了优化。但是，如果您正在构建的应用程序是 CRUD 应用程序（并且 99% 的 Web 应用程序都是），这难道不是一件好事吗？
如果您不构建 CRUD 应用程序，那么在 ruby​​/python/php/java/C# 中有很多非 crud 优化的框架。净赢：没有人（因此无关紧要）

执行速度比 Java/C# 慢——这无疑是正确的，但也没关系。对于低流量站点，性能差异不会有任何影响，而对于高流量站点，您的瓶颈将是数据库，无论是 MySQL、oracle 还是其他什么。

您为所有这些付出的代价是开发时间。一旦你使用了所有这些建议来说服你的老板，你*不会*因为使用 LAMP 而失去任何东西，如果你处理数字并向他们展示用 Java 构建网站需要 6 个人工月，并且只有 3 个在 ruby​​/python 中构建它，这就是它归结为的原因。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-08T18:12:28.597

如果你雇佣白痴来实现它，C++ 和 Oracle 将无法扩展。如果您雇用聪明的人并完成工作，PHP 和 MySQL 将可以很好地扩展。

同样的论点也适用于安全性和稳健性。

Facebook、Digg、Yahoo 的一些部分在 PHP 上运行。当然，他们雇佣了很多博士程序员。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-10T03:45:01.170

只是想我会在 LAMP 上运行的网站列表中添加另一个网站 - 维基百科。世界第七大网站，完全用 PHP 编写并运行 MySQL，他们只有两三个付费开发人员。当然，他们有一些志愿者的帮助，但不是很多，而且规模还不错。不知道您是否真的称他们为“企业”，但对于如此庞大且受欢迎的网站，他们似乎为自己做得很好。

> Linux 的支持不如 Unix、Solaris 或 Windows 服务器好。

正如其他人在上面所说的那样，给 Red Hat 打个电话，我相信他们会乞求不同的。并且对 Linux 的*完全免费*支持的数量是惊人的。

> Apache 比 BEA WebLogic 或 IIS 等 Web 服务器更难配置和维护。

那要看你问谁了。通常管理 IIS 服务器的人可能会这样看待它。通常管理 Apache 的人不会。这取决于你雇用谁，如果你的堆栈是 LAMP，那么无论如何你都不想雇用没有 Apache 经验的人。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-08T16:55:07.207

我只想补充一点，我曾多次目睹，客户只有在为某些解决方案投入大量资金时才会感到自在，即使这会使企业集成更加困难，尽管您提出了什么样的论据。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-12-08T19:20:35.510

我认为第一个标准应该是您团队的技能水平和舒适度，以确保做出的任何平台决策都适合他们。无论您决定如何考虑代码的可伸缩性和可维护性。无论您选择什么堆栈，工具都很棒。

我个人会将其分解为 3 堆-

1.  Java 堆栈，您拥有 Solaris 或 Enterprise Linux（如 RedHat）和 Weblogic/Websphere/Tomcat 等，Java Enterprise 以及 Hibernate、Spring 等技术。大多数人会选择 Oracle 作为数据库。

2.  如果需要，Microsoft Stack 带有一些开源 Win Server - IIS - .net/C#（ASP.net 等） - NHibernate、NUnit（单元测试）等。您很可能希望将 SQL Server 用作 DB

3.  上面的堆栈都没有与 Enterprise Linux 运行一整套开源的东西，比如 MySQL（现在在 Sun 的域下，所以可以认真看待）、Apache（那里有 apache 大师）、Ruby（不是我个人的选择）/ PHP （祝你好运）/ Python（我喜欢它，因为它是一种成熟的语言）。从管理代码的角度来看，我会提倡 python 或 ruby​​。也许对某些人来说它可能是 PHP ..我不喜欢它。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-12-08T16:06:48.427

*严格来说是一种主观意见*，但我个人认为 MySQL 和在较小程度上 PHP 有点弱点，但肯定有很多人不同意，大公司也选择了 LAMP。

我更希望看到 postgres 甚至 SQLite 从 MySQL 市场中分一杯羹，我更希望看到基于 mono、jsp 或 cocoon 的应用程序。我猜 LAMP 对于一个总称来说有点太具体了。:)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-12-08T21:18:15.693

Linux / Apache 是强化的、精简的，并且每个都有很多人（当然价格合适），他们将提供支持，大量有用的工具，许多具有非常高水平的实用工具，可以与它们一起使用并且已经建立在它们之上.

但是，不确定其他两个。特别是 MySQL 似乎在被 Sun 收购后出现了奇怪的恶化，这与该线程中的帖子相反，表明 Sun 可能会产生良好的影响：

[http://www.reddit.com/r/programming/comments/7gb8j/oops_we_did_it_again_mysql_51_released_as_ga_with/](http://www.reddit.com/r/programming/comments/7gb8j/oops_we_did_it_again_mysql_51_released_as_ga_with/)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-11T16:51:28.750

没有找到基于 LAMP 构建的企业应用程序的原因不是因为它们不是企业级的，而是在我看来完全不同的东西。许多大玩家都使用 LAMP 或类似产品——Facebook 和~~MySpace~~立即浮现在脑海。所以它显然不是[规模和性能](https://stackoverflow.com/questions/432739/how-have-you-maximized-your-server-performance)的问题。

也就是说，我发现没有任何基于 LAMP 构建的企业应用程序的原因是它们固有的开放性。我不想将精算模块构建为 PHP 文件，因为任何人都可以窃取逻辑。另一方面，如果我有一个 DLL，我可以保留控制权。出于这个原因，您找不到很多基于 PHP 构建的 30 试用应用程序，但使用 ASP.NET 实现这种保护要容易得多。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2010-01-01T14:54:43.150

您的帖子中有一些真正糟糕的神话：

JavaEE 神话：-App 服务器比 apache 更容易配置，不，apache 更容易。-您暗示只有 JavaEE 完整解决方案是企业级的，不。

CRUD 神话：-CRUD 比 JavaEE 慢？怎么回事？POJO 和 EJB 正在使用 CRUD。限制因素不是 crud，它的服务器吞吐量

无论是什么技术，甚至是 MS..server 实现、持久层和应用程序层，都有 3 个限制瓶颈区域。选择的技术不是速度因素，因为您可以将一层的优势换成另一层的劣势。例如，我们可以通过使用文档存储而不是普通 DB 来加速 Java。

大多数新的 Rails 实现使用非 apache 服务器，它们比 Apache 快 3 到 5 倍。即使是经过良好调整的 Apache 服务器也可以胜过一些 javaEE 堆栈。问雅虎，因为他们在某些属性上使用 Symfony。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-12-08T16:19:34.453

我想你会发现很多企业都使用Linux服务器，通常Redhat、Novell或IBM都支持，Apache也常用。

但许多企业倾向于使用 Oracle 或 IBM DB2 等数据库，而不是开源产品——尽管有许多企业并不真正需要这些系统提供的那种能力，并且可以使用 MySQL 或 PostgreSQL。

对于网络服务器语言，我认为您几乎可以使用任何东西。但是，如果您使用 Apache，则使用 PHP、Ruby 或 Python 可能更容易，而如果您使用 IIS、Weblogic 或 Domino，则使用 Java / C# 会更容易。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-08T16:01:53.913

IMO 没有针对 Linux 和 Apache 的一般论据；如果您愿意为 Linux 付费，您当然可以获得企业级支持（如果您愿意遵守社区规则，则可以免费获得它的一个很好的近似值）。除非您需要更复杂的功能，否则 Apache 的配置并不难，这在应用服务器中是不可能的。

您当然可以反对 MySQL，因为最近才添加了一些与数据安全有关的最重要的功能。如果您对此感到担心，请改用 PostgreSQL。

至于您编写应用程序所用的语言： PHP 已被证明能够运行极其庞大和复杂的系统；我更关心可维护性而不是性能。并且 Ruby on Rails 只是“针对 CRUD 进行了优化”，因为几乎可以在任何时间（字面意思是几分钟）内编写一个简单的 CRUD Web 应用程序，但这并不意味着它不适合更复杂的应用程序，只是需要更多时间（仍然少于许多其他语言）

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-12-10T03:51:47.147

我认为大型商业 CRM 和 HR 应用程序可能偏向于交付大型商业 RDBMS 产品作为其产品的基础。如果不出意外，他们肯定更愿意团结起来对抗共同的威胁。

如果他们集成了没有许可和支持费用的产品，他们就很难证明许可和支持费用的合理性。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-12-10T15:10:06.420

我的2c：

Linux：自从2.6内核出来，我会说它绝对是一个高质量的操作系统。2.4 版还不是很完善，2.2 只是个玩笑，但 2.6 真的很好。不过，在选择分发时要小心。根据我的经验，RedHat/CentOS 非常好，如果你有一个好的管理员，显然 Debian（原始的，不是 Ubuntu！）可以很好地设置。我对 OpenSUSE 的体验不是很好。

Apache：没用过，但我不明白为什么会有问题。

MySQL：这是堆栈的最薄弱环节。我不打算在这里详细介绍 - 如果您有兴趣，请查看 reddit.programming 上的评论。最好看看 PostgreSQL。

PHP/Perl/Ruby/Python：我使用过 Perl，在较小程度上使用过 Python。它们可能适用于基于 Web 的应用程序，其中大部分工作由 Web 服务器和 DBMS 完成。但是，我更喜欢静态类型系统，并且更愿意选择 Java/C# 用于业务应用程序和 C++ 用于系统编程。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-21T04:16:01.273

我想建议我们确定企业系统的可伸缩性要求以及它们与 Web 应用程序相比有何不同。查看一些最具扩展性的系统，例如 Wikipedia、Flickr、Wordpress、Facebook、MySpace 和许多其他系统。您将在那里看到 LAMP 堆栈。我更喜欢 Python（因为我觉得这种语言给人一种更干净的感觉），但我听过 Cal Henderson (Flickr) 等专家的意见，他写了一本关于可扩展性的书，谈论他如何扩展 MySQL 服务器库。

企业系统的基本特征是什么？

支持、专业知识的可用性、平台/语言的稳定性可能很重要。

但 LAMP 还具有其他特性，例如更快的开发、更容易的可扩展性、大量可供重用的库、几个文档化的可扩展性故事、成熟的 Web 框架。

这里有一些关于构建可扩展系统的建议（我说的是 Web Scale）。鉴于所有这些证据，我一直想知道，为什么 LAMP 还没有为企业应用程序做好准备的看法不断出现。

至于 Apache，每项 Netcraft 研究都展示了一个非常不同的采用故事。通过服务器的绝对数量，可能会有更多的人具备配置、调整和扩展 Web 服务器的知识。

[可扩展的 Web 架构](http://dorai.wordpress.com/2007/03/03/scalable-web-architectures-part-ii/) [请查看 1995 年 8 月至 2009 年 1 月所有服务器的市场份额](http://news.netcraft.com/archives/web_server_survey.html)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-12-08T15:57:58.150

大型企业使用 LAMP 堆栈有两个主要问题：

*   **TCO**：考虑到 LAMP 基本上是免费的，企业仍然可以通过其他商业解决方案实现较低的总运营成本
*   **可支持性**：企业无需支付额外费用即可从其商业供应商处获得全天候的专业支持

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-12-08T16:47:09.500

Linux 被大量使用。Apache 和 Tomcat 被大量使用。MySQL 现在可能很健壮。我会改用 PostgreSQL。银行将使用 Oracle，但那里对 Java 和 Tomcat 有很好的支持。PHP 被大量使用，但许多大公司更喜欢 Java。

在我看来，你最好不要争论 Linux（可能是商业支持的版本）Tomcat、Java、Tomcat|Oracle|MSSQL 解决方案。

你需要一个 Linux 系统管理员，尤其是随着服务器数量的增加，尽管我相信你可以在那个时间出现之前得到一个兼职的。如果公司已经拥有 Windows 系统管理员，那么为 Linux 争论将是艰难的。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-07-24T10:54:16.737

我相信这并不是说这项技术还为时过早，也不是让 AT&T 这样的大公司继续在企业层面全面实施。这些公司的 IT 支出预算如此之大，以至于他们最不想考虑的就是在开源技术所需的定制和增强上花费更多，以满足他们的业务需求。

因此，他们寻找的（来自我的咨询经验）是购买和运行产品包，而不必在研究和破解部分上花费更多。使用开源构建的公司已经在全球范围内建立了自己的支持小组来满足大型企业不太愿意这样做的任何支持需求。他们需要快速、确定地完成工作，并且他们可以付款。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-12-08T16:03:27.327

Redhat 和 IBM 完全支持 Linux，Sun 购买了 MySQL，Yahoo 使用 Php，许多公司使用 LAMP 堆栈，但许多使用部件。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-12-08T21:15:56.383

我个人认为 Linux 的支持不如提到的其他操作系统。事实上，硬件供应商通常确实支持 Linux 而不是任何其他操作系统（Windows 除外，只要您使用主流发行版，他们通常会很好地支持 Linux）。

如果您不使用奇怪的风格（提示：只需使用 RHEL 或与其免费等效的 Centos），Linux 就得到了很好的支持。

MySQL可能有一些缺点，但在我看来它有很多优点；我们以非预期的方式大规模使用它，但它通常仍然运行良好（大多数问题是由于我们的版本过时或配置不当）。

LAMP 中的“P”代表什么是有争议的。我觉得 PHP 不是企业级的，因为它有很多单独的缺点（例如糟糕的 unicode 处理、没有命名空间、不一致的 API、不一致的语法、糟糕的版本向后兼容性、重复/过时的功能），它们加起来很难实现一个可维护的系统。

但是如果有一个经验丰富的团队，即使您选择 PHP，它也可以用来制作非常高质量的应用程序。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2009-02-13T08:57:20.443

如果它对 Google 来说足够好，相信我，它对你来说已经足够好了。

# objective-c - 以编程方式在 Cocoa 中创建控件

> ID：349927
> 
> 赞同：15
> 
> 时间：2008-12-08T15:52:21.593
> 
> 标签：objective-c, cocoa, controls

根据*Cocoa Programming for Mac OS X, 3rd Edition*，第 245 页（第 17 章），您通常会在 Interface Builder 中创建视图。但是，可以在代码中创建它们，例如：

```
NSView *superview = [window contentView]; 
NSRect frame = NSMakeRect(10, 10, 200, 100); 
NSButton *button = [[NSButton alloc] initWithFrame:frame]; 
[button setTitle:@"Click me!"]; 
[superview addSubview:button]; 
[button release]; 
```

这一切都很好，但是我如何将所述控件的出口连接到代码中的操作？（在 .NET 中，这很容易；添加一个委托……我希望在 Cocoa/Obj-C 中同样容易。）

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-08T16:36:41.377

您可以使用简单的分配将它们连接起来。要从上面继续您的代码：

```
[button setTarget: self];
[button setAction: @selector(myButtonWasHit:)]; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-08T21:12:11.400

如果您想针对第一响应者而不是特定对象：

```
[button setTarget:nil];
[button setAction:@selector(myAction:)]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-07T09:52:27.637

迅速：

```
button.target = self
button.action = "myAction:" 
```

当然，将 myAction 函数添加到 self：

```
func myAction(sender: NSButton) {
    println("click!")
} 
```

# c - 如何打印一位？

> ID：349931
> 
> 赞同：7
> 
> 时间：2008-12-08T15:53:30.357
> 
> 标签：c, printf, bit

请告诉我如何打印一点，例如`printf("%d",bit);`.

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-08T15:55:37.513

如果 bit 只是一个 int ，它在最低有效位中包含您想要的值，那么：

```
printf("%d", bit & 0x1); 
```

应该这样做。& 正在对仅设置第一个有效位的数字进行二进制与运算，因此您将删除整数中的所有其余位。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-08T16:01:48.890

如果您需要概括的不仅仅是 Herms，您可以这样做：

```
#define IsBitSet(val, bit) ((val) & (1 << (bit)))

/* ... your code ... */

printf ("%c", IsBitSet(bit, 0) ? '1' : '0'); 
```

printf 相当于 Herms 的答案。

如果你在谈论 C 中的位域，你可以这样做：

```
struct foo { int b:1; } myFoo;

printf("%c", myFoo.b ? '1' : '0'); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-08T16:17:42.150

相关问题：[您如何设置、清除和切换单个位？](https://stackoverflow.com/questions/47981/how-do-you-set-clear-and-toggle-a-single-bit-in-c)是对 c 和 c++ 中的单位访问的扩展讨论。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-08T16:00:29.033

要打印 n 的第 m 位（m 来自 1..16 或 32）：

```
void print_bit(n, m)
{
    printf("%d", n & (1 << (m - 1)));
} 
```

`- 1`如果您的位计数器从 0 开始，请删除该位。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-11T11:38:11.783

您可以使用“联合”：

```
union bitshow {
    unsigned bit1:1;
    int i;
};

int main() {
    union bitshow bit;
    cin >> bit.i;
    cout << bit.bit1;
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-09T10:10:16.790

C++ 的答案比 C89 的答案更容易，使用本机 bool 类型：

```
bool b = true;
std::cout << b; 
```

C99 非常相似：

```
_Bool b = 1;
printf("%d", b); 
```

# sql - SQL：获取每组中的第 N 个项目

> ID：349933
> 
> 赞同：3
> 
> 时间：2008-12-08T15:54:05.583
> 
> 标签：sql, mysql

我有一个这样的用户表

```
user_id | community_id | registration_date
--------------------------------------------
1       |     1        | 2008-01-01
2       |     1        | 2008-05-01
3       |     2        | 2008-01-28
4       |     2        | 2008-07-22
5       |     3        | 2008-01-11 
```

对于每个社区，我想获得第三个用户注册的时间。我可以使用 MySql 的“限制”SQL 扩展轻松地为单个社区执行此操作。例如，对于 ID=2 的社区

```
select registration_date
from user
order by registration_date
where community_id = 2
limit 2, 1 
```

或者，我可以通过以下方式获取第一个用户注册所有社区的日期：

```
select community_id, min(registration_date) 
from user 
group by 1 
```

但我不知道如何在单个 SQL 语句中获取*所有社区的第三个用户的注册日期。*

干杯，唐

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T16:10:49.887

使用内部选择：

```
select 
  registration_date, community_id 
from 
  user outer 
where 
  user_id IN (
    select 
      user_id 
    from 
      user inner 
    where 
      inner.community_id = outer.community_id 
    order by 
      registration_date 
    limit 2,1
  )
order by registration_date 
```

选择一组用户，其中每个用户都是其社区中的第三个用户，由内部选择中的限制子句返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T16:11:35.920

你是这个意思吗？

```
SELECT registration_date
FROM user
ORDER BY registration_date
LIMIT n 
```

其中*n*是您关注的用户。

# .net - 从 Word 中提取方程式和图像

> ID：349938
> 
> 赞同：4
> 
> 时间：2008-12-08T15:55:56.560
> 
> 标签：.net, vb.net, ms-word, extract, equation

是否有从 MS Word 文档中提取方程式（可能还有图像）的编程方式？我已经用谷歌搜索了所有内容，但还没有找到任何我可以投入并从中工作的东西。如果可能的话，我希望能够使用 VB.NET 或 C# 来做到这一点，但我可以选择足够多的任何语言来破解 DLL。谢谢！

**编辑：**现在我正在考虑从 Word 2003 中提取方程式，但如果需要将其转换为 2007/Open XML，那很好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-08T16:15:37.380

您的文档是什么 Word 格式？如果它们在 Open XML（文件扩展名为 .docx）中，您可以使用 Microsoft 提供的[Open XML SDK](http://www.microsoft.com/downloads/details.aspx?FamilyId=C6E744E5-36E9-45F5-8D8C-331DF206E0D0)来提取图像和嵌入内容。

Open XML 文件只不过是使用特殊结构的 zip 存档。您将在 SDK 中找到如何访问该 zip 存档部分的示例。实际上，您可以使用任何支持 zip 的库从文档包中提取内容。

如果文档仍然使用较旧的二进制格式，事情会更复杂一些。我认为最简单的方法是将文档转换为 Open XML 格式。做这件事有很多种方法：

*   从 SourceForge获取免费且开放的[b2xtranslator](http://b2xtranslator.sourceforge.net/)，它为您提供用于文件转换的 C# dll。
*   安装 Microsoft 的[Compatibility Pack](http://www.microsoft.com/downloads/details.aspx?FamilyID=941b3470-3ae9-4aee-8f43-c6bb74cd1466&displaylang=en)并使用以下命令行进行转换：

    `"C:\Program Files\Microsoft Office\Office12\wordconv.exe" -oice -nme input\_file output_file`

其中 input_file 和 output_file 必须是完整路径名。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-08T16:44:09.227

我不知道这是否会有所帮助，但 Word 2000/2003 中的对象模型有一个`InlineShapes`集合作为`Document`对象的一部分，它表示嵌入的图像和可能的类似对象，如方程式。

一些用于将第一项复制到剪贴板的 VBA 代码，这可能会帮助您提取它们：

```
ThisDocument.InlineShapes.Items(1).Select
Selection.Copy 
```

它也可以在 .NET 中访问，[MSDN 链接](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.inlineshapes(VS.80).aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T16:01:31.697

尝试查看[Word-to-latex](http://kebrt.webz.cz/programs/word-to-latex/)转换器。它需要 .Net 框架，尽管源代码尚未打开，但作者确实邀请了有关此的问题。

# c# - 从 C# 读取非 .NET DLL 版本？

> ID：349943
> 
> 赞同：31
> 
> 时间：2008-12-08T15:57:15.623
> 
> 标签：c#, dll

我有一个包含一些 DLL 的文件夹（不是 .NET 程序集），我想读取其中的文件信息。诸如版本，名称...等之类的东西。解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-12-08T16:00:20.343

使用 FileVersionInfo 对象。这是来自 Microsoft 网站的示例，该示例从 notepad.exe 获取版本信息

```
public void GetFileVersion() {
    // Get the file version for the notepad.
    FileVersionInfo myFileVersionInfo = FileVersionInfo.GetVersionInfo("%systemroot%\\Notepad.exe");

    // Print the file name and version number.
    textBox1.Text = "File: " + myFileVersionInfo.FileDescription + '\n' +
       "Version number: " + myFileVersionInfo.FileVersion;
 } 
```

[从这里](http://msdn.microsoft.com/en-us/library/system.diagnostics.fileversioninfo.getversioninfo.aspx)偷来的。

# c# - 如何在 C# 中动态调用具有任何签名的方法？

> ID：349948
> 
> 赞同：2
> 
> 时间：2008-12-08T15:58:10.707
> 
> 标签：c#

我有一个带有一些常见错误处理代码的类，我想传入要调用的方法和参数，但我想不出语法。我想做的大致是这样的：

```
private void InvokeHelper(Delegate method, params object[] args)
{
  bool retry = false;

  do
  {
    try
    {
      method.DynamicInvoke(args);
      retry = false;
    }
    catch (MyException ex)
    {
      retry = HandleException(ex);
    }
  } while (retry);
} 
```

然后能够执行以下操作：

```
InvokeHelper(foo.MethodA, a, b, c);
InvokeHelper(foo.MethodB, x, y ); 
```

这会在将 foo.MethodA 和 foo.MethodB 转换为 System.Delegate 时出现编译器错误。我想出了下面的解决方法（实际上我更喜欢它，因为这样我就可以对我的方法的参数进行类型检查），但我很好奇是否有办法做我最初想做的事情？我知道我可以使用`foo.GetType().GetMethod("MethodA")`和调用它，但我试图避免反思。我主要只是想了解如何在.net 中动态调用方法。

解决方法：

```
private delegate void EmptyDelegate();

private void InvokeHelper(EmptyDelegate method)
{
  bool retry = false;

  do
  {
    try
    {
      method.Invoke();
      retry = false;
    }
    catch (MyException ex)
    {
      retry = HandleException(ex);
    }
  } while (retry);
} 
```

然后调用：

```
InvokeHelper(delegate() { foo.MethodA(a, b, c); });
InvokeHelper(delegate() { foo.MethodB(x, y); }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-08T16:17:50.760

首先，你的签名是

```
private void InvokeHelper(Delegate method, params object[] args) 
```

然而你犯了一个错误，你必须将你的 args 分组到一个数组中才能调用这个方法：

```
InvokeHelper(foo.MethodA, new object[] { a, b, c}); 
```

`parms`关键字告诉编译器为您执行此操作；你可以这样调用这个方法：

```
InvokeHelper(foo.MethodA, a, b, c); 
```

其次，如果您的目标是 3.0 或更高版本，请不要使用 Delegate，使用 Action：

```
private void InvokeHelper(Action method) 
```

并这样称呼它：

```
InvokeHelper(()=> MyMethodToInvoke(a, b, c)); 
```

这只是一种整体上更好的方法。

* * *

至于您为什么遇到编译器问题，这是因为 System.Delegates 讨厌我们。这是一个简单的事实。那是因为没有从方法组到委托的隐式转换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T16:26:26.483

这是一个重写，遵循 Will 的使用 Action 的建议：

```
 private void InvokeHelper(Action method)
    {
        bool retry = false;

        do
        {
            try
            {
                method();
                retry = false;
            }
            catch (MyException ex)
            {
                retry = HandleException(ex);
            }
        } while (retry);
    }

    public void Test()
    {
        FooClass foo = new FooClass();
        InvokeHelper( () => foo.MethodA(1, "b", 3) );
        InvokeHelper( () => foo.MethodB(2, "y"));
    } 
```

# sql - 顺序或并行启动存储过程

> ID：349951
> 
> 赞同：11
> 
> 时间：2008-12-08T15:58:53.780
> 
> 标签：sql, sql-server, tsql, sql-server-2000, parallel-processing

我们有一个每晚运行的存储过程，它依次启动许多其他过程。其中一些程序在逻辑上可以与其他一些程序并行运行。

*   我如何向 SQL Server 指示一个过程应该并行运行还是串行运行——即：异步启动还是阻塞启动？
*   并行运行它们会有什么影响，请记住，我已经确定这些进程不会竞争表访问或锁定 - 只是总磁盘 io 和内存。在大多数情况下，他们甚至不使用相同的表。
*   如果其中一些程序是*相同*的程序，只是参数不同，这有关系吗？
*   如果我异步启动一对或过程，SQL Server 中是否有一个好的系统来等待它们完成，或者我是否需要让它们中的每一个在某处设置一个标志并使用定期检查和轮询标志`WAITFOR DELAY`？

目前我们仍在使用 SQL Server 2000。

附带说明一下，这很重要，因为主程序是响应从大型机系统到服务器的数据转储完成而启动的。大型机转储每晚大约需要 2 个小时，我们无法控制它。因此，我们一直在努力寻找减少处理时间的方法。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-01-10T15:41:13.097

I had to research this recently, so found this old question that was begging for a more complete answer. Just to be totally explicit: **TSQL does *not*** (by itself) **have the ability to launch other TSQL operations asynchronously**.

That doesn't mean you don't still have a lot of options (some of them mentioned in other answers):

*   **Custom application**: Write a simple custom app in the language of your choice, using asynchronous methods. Call a SQL stored proc on each application thread.
*   **SQL Agent jobs**: Create multiple SQL jobs, and start them asynchronously from your proc using `sp_start_job`. You can check to see if they have finished yet using the undocumented function `xp_sqlagent_enum_jobs` as described in [this excellent article](http://www.databasejournal.com/features/mssql/article.php/10894_3491201_2/Detecting-The-State-of-a-SQL-Server-Agent-Job.htm) by Gregory A. Larsen. (Or have the jobs themselves update your own JOB_PROGRESS table as Chris suggests.) You would literally have to create separate job for each parallel process you anticipate running, even if they are running the same stored proc with different parameters.
*   **OLE Automation**: Use `sp_oacreate` and `sp_oamethod` to launch a new process calling the other stored proc as described in [this article](http://www.databasejournal.com/features/mssql/article.php/3427581/Submitting-A-Stored-Procedure-Asynchronously.htm), also by Gregory A. Larsen.
*   **DTS Package**: Create a DTS or SSIS package with a simple branching task flow. DTS will launch tasks in individual spids.
*   **Service Broker**: If you are on SQL2005+, look into using [Service Broker](http://technet.microsoft.com/en-us/library/ms166104.aspx)
*   **CLR Parallel Execution**: Use the CLR commands `Parallel_AddSql` and `Parallel_Execute` as described in [this article](http://www.codeproject.com/KB/database/asynchronousTSQL.aspx) by Alan Kaplan (SQL2005+ only).
*   **Scheduled Windows Tasks**: Listed for completeness, but I'm not a fan of this option.

I don't have much experience with Service Broker or CLR, so I can't comment on those options. If it were me, I'd probably use multiple Jobs in simpler scenarios, and a DTS/SSIS package in more complex scenarios.

**One final comment**: SQL already attempts to parallelize individual operations whenever it can*. This means that running 2 tasks at the same time instead of after each other is no guarantee that it will finish sooner. Test carefully to see whether it actually improves anything or not.

We had a developer that created a DTS package to run 8 tasks at the same time. Unfortunately, it was only a 4-CPU server :)

*Assuming default settings. This can be modified by altering the server's Maximum Degree of Parallelism or Affinity Mask, or by using the MAXDOP query hint.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-08T16:06:37.443

创建几个 SQL Server 代理作业，每个作业都运行一个特定的 proc。

然后从你的主进程中开始工作。

我能想到的唯一等待方法是，如果您有一个状态表，每个 proc 完成时都会更新它。

然后另一个工作可以轮询该表以完全完成并启动最终过程。或者，您可以在此表上设置触发器。

内存影响完全取决于您的环境..

**更新：** 如果您可以访问任务系统..那么您可以采用相同的方法。只需让 windows 执行多个任务，每个任务负责一个 proc。然后在所有任务完成后使用状态表上的触发器来启动某些操作。

**UPDATE2：** 此外，如果您愿意创建一个新应用程序，您可以将所有逻辑包含在一个 exe 中......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-08T18:45:08.780

You do need to move your overnight sprocs to jobs. SQL Server job control will let you do all of the scheduling you are asking for.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T19:24:27.607

You might want to look into using DTS (which can be run from the SQL Agent as a job). It will allow you pretty fine control over which stored procedures need to wait for others to finish and what can run in parallel. You can also run the DTS package as an EXE from your own scheduling software if needed.

**NOTE:** You will need to create multiple copies of your connection objects to allow calls to run in parallel. Two calls using the same connection object will still block each other even if you don't explicitly put in a dependency.

# perl - 为什么我不能在 Perl 中删除这个空目录？

> ID：349953
> 
> 赞同：4
> 
> 时间：2008-12-08T15:59:18.677
> 
> 标签：perl, find, directory-traversal

我正在从[http://www.perlmonks.org/index.pl?node_id=217166](http://www.perlmonks.org/index.pl?node_id=217166)转换一个 linux 脚本，具体如下：

```
#!/usr/bin/perl -w
use strict;
use Getopt::Std;
use File::Find;

@ARGV > 0 and getopts('a:', \my %opt) or die << "USAGE";
# Deletes any old files from the directory tree(s) given and
# removes empty directories en passant.
usage: $0 [-a maxage] directory [directory ...]
       -a  maximum age in days, default is 120
USAGE

my $max_age_days = $opt{a} || 120;

find({
    wanted => sub { unlink if -f $_ and -M _ > $max_age_days },
    postprocess => sub { rmdir $File::Find::dir },
}, @ARGV); 
```

我的尝试是：

```
#!/usr/bin/perl -w
use strict;
use Getopt::Std;
use File::Find;

@ARGV > 0 and getopts('a:', \my %opt) or die << "USAGE";
# Deletes any old files from the directory tree(s) given and
# removes empty directories en passant.
usage: $0 [-a maxage] directory [directory ...]
       -a  maximum age in days, default is 120
USAGE

my $max_age_days = $opt{a} || 120;

find({
    wanted => sub { unlink if -f $_ and -M _ > $max_age_days },
#    postprocess => sub { rmdir $File::Find::dir },
    postprocess => sub {
                        my $expr = "$File::Find::dir";
                        $expr =~ s/\//\\/g;      # replace / with \
                        print "rmdir $expr\n";
                        `rmdir $expr`;
                        },
}, @ARGV); 
```

但是，当脚本尝试删除一个目录时，我收到一个错误，指出该目录正在被另一个进程使用（当它不是时）。有任何想法吗？我正在使用 ActiveState 5.10 在 Windows Server 2003 SP2 64 位上运行该脚本。

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-08T16:09:04.727

从这个[文档](http://perl.active-venture.com/lib/File/Find.html)

> 后期过程
> 
> 该值应该是代码引用。**它在离开当前处理的目录之前被调用**。它在没有参数的 void 上下文中调用。当前目录的名称在 $File::Find::dir 中。这个钩子对于总结一个目录很方便，比如计算它的磁盘使用情况。当 follow 或 follow_fast 生效时，后处理是无操作的。

这意味着当您尝试删除该目录时，您自己的代码仍在使用该目录。尝试构建一个名称列表并在调用 find 之后对其进行迭代。

另一种可能的解决方案是使用该`no_chdir`选项来避免 find 使用您要删除的目录。

编辑：此评论也很相关，因此我将其推广到主要答案的正文：

> 补充一点：这里的问题是，在 Linux 上可以删除正在使用的文件和目录，而在 Windows 上则不能。这就是为什么它在未经修改的情况下无法工作。-[莱昂蒂默曼斯](https://stackoverflow.com/users/4727/leon-timmermans)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-08T16:07:35.367

只是一些注意事项：

1.  您无需将 / 翻转为 \。Perl 理解 / 是目录分隔符，即使在 Windows 上也是如此。
2.  rmdir 是 Perl 内置的，你不需要用反引号调用它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-08T16:10:59.933

perlmonks 版本使用 Perl 方法“rmdir”进行删除。您的版本生成带有反引号的子shell。所以消息很可能是正确的——当 rmdir 试图使用该目录时，Perl 仍在使用该目录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T15:48:38.867

感谢您的回复。我的最终脚本如下所示：

```
#!/usr/bin/perl -w
use strict;
use warnings;
use Getopt::Std;
use File::Find;
use Win32::OLE;

@ARGV > 0 and getopts('a:', \my %opt) or die << "USAGE";
Deletes any old files from the directory tree(s) given and
removes empty directories en passant.
usage: $0 [-a maxage] directory [directory ...]
       -a  maximum age in days, default is 30
USAGE

my $max_age_days = $opt{a} || 30;
my @dir_list = undef;

find({
    wanted => sub { if (-f $_ and -M _ > $max_age_days) {
        unlink $_ or LogError ("$0: Could not delete $_ ($!)")}},
    postprocess => sub {push(@dir_list,$File::Find::dir)},
}, @ARGV);

if (@dir_list) {foreach my $thisdir (@dir_list) { rmdir $thisdir if defined ($thisdir)}}

############
sub LogError {
    my ($strDescr) = @_;
    use constant EVENT_SUCCESS => 0;
    use constant EVENT_ERROR => 1;
    use constant EVENT_WARNING => 3;
    use constant EVENT_INFO => 4;

    my $objWSHShell = Win32::OLE->new('WScript.Shell');
    $objWSHShell->LogEvent(EVENT_ERROR, $strDescr);
} 
```

似乎工作得很好 - 你能想出任何改进它的方法吗？

# wpf - 可观察集合 不更新用户界面

> ID：349957
> 
> 赞同：4
> 
> 时间：2008-12-08T16:00:06.163
> 
> 标签：wpf, wcf, multithreading, collections

我遇到了 ObservableCollection 获取新项目但未在 ListView 中反映这些更改的问题。我在实现这一点的方式上有足够的怪癖，以至于我很难确定问题出在哪里。

我的 ObservableCollection 是这样实现的：

```
public class MessageList : ObservableCollection<LobbyMessage>
{
    public MessageList(): base()
    {
        Add(new LobbyMessage() { Name = "System", Message = "Welcome!" });
    }
} 
```

我将集合存储在一个静态属性中（以便从多个用户控件轻松访问它）：

```
static public MessageList LobbyMessages { get; set; } 
```

在我的主 NavigationWindow 的 OnLoad 事件中，我有以下行：

```
ChatHelper.LobbyMessages = new MessageList(); 
```

我在 ListView 所在的 UserControl 中的 XAML 内容如下：

```
 <ListBox IsSynchronizedWithCurrentItem="True" 
         ItemsSource="{Binding Mode=OneWay}" 
         x:Name="ListBoxChatMessages" 
         d:UseSampleData="True" 
         ItemTemplate="{DynamicResource MessageListTemplate}" 
         IsEnabled="True">
      <ListBox.DataContext>
        <Magrathea_Words_Tools:MessageList/>
       </ListBox.DataContext>
    </ListBox> 
```

我在构造函数中添加的初始消息很好地出现在 UI 中。

现在，我向集合中添加新项目的方式是来自 WCF 服务的 CallBack。我让这段代码在 WinForms 应用程序中工作，并且有必要将回调编组到 UI 线程，所以我保留了该代码。这是该方法的缩写版本：

```
Helper.Context = SynchronizationContext.Current;

#region IServiceMessageCallback Members

/// <summary>
/// Callback handler for when the service has a message for 
/// this client
/// </summary>
/// <param name="serviceMessage"></param>
public void OnReceivedServiceMessage(ServiceMessage serviceMessage)
{
    // This is being called from the WCF service on it's own thread so
    //  we have to marshall the call back to this thread.
    SendOrPostCallback callback = delegate
    {
        switch (serviceMessage.MessageType)
        {
            case MessageType.ChatMessage:
                ChatHelper.LobbyMessages.Add(
                        new LobbyMessage()
                        {
                            Name = serviceMessage.OriginatingPlayer.Name,
                            Message = serviceMessage.Message
                        });
                break;

            default:
                break;
        }
    };

    Helper.Context.Post(callback, null);
} 
```

在调试时，我可以看到集合已使用来自服务的消息进行更新，但 UI 并未反映这些添加。

关于我缺少什么以使 ListView 反映集合中的这些新项目的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T14:24:54.763

我解决了这个问题。

静态属性或传入数据的上下文都与该问题无关（事后看来这很明显）。

由于某种原因，从 Expression Blend 生成的 XAML 不能胜任这项任务。我所做的只是将 ItemSource 分配给 C# 中的集合。

```
ListBoxChatMessages.ItemsSource = ChatHelper.LobbyMessages.Messages; 
```

我的 XAML 现在更加简化了。

```
<ListBox IsSynchronizedWithCurrentItem="True" 
       ItemsSource="{Binding Mode=OneWay}" Background="#FF1F1F1F" 
       Margin="223,18.084,15.957,67.787" x:Name="ListBoxChatMessages" 
       ItemTemplate="{DynamicResource MessageListTemplate}" 
       IsEnabled="True"/> 
```

我有点困惑为什么会这样。我正在阅读有关如何在 WPF 中绑定数据的 MSDN 文章，其中包括几个绑定对象、引用对象的属性等。我不明白为什么当 UserControl 的构造函数中的一行代码执行把戏就好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-09T13:17:09.177

您需要让 ObservableCollection 中的 poco 类实现 INotifyPropertyChanged。

例子：

```
<viewModels:LocationsViewModel x:Key="viewModel" />
.
.
.    
<ListView
    DataContext="{StaticResource viewModel}"
    ItemsSource="{Binding Locations}"
    IsItemClickEnabled="True"
    ItemClick="GroupSection_ItemClick"
    ContinuumNavigationTransitionInfo.ExitElementContainer="True">

    <ListView.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Name}" Margin="0,0,10,0" Style="{ThemeResource ListViewItemTextBlockStyle}" />
                <TextBlock Text="{Binding Latitude, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Style="{ThemeResource ListViewItemTextBlockStyle}" Margin="0,0,5,0"/>
                <TextBlock Text="{Binding Longitude, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Style="{ThemeResource ListViewItemTextBlockStyle}" Margin="5,0,0,0" />
            </StackPanel>
        </DataTemplate>
    </ListView.ItemTemplate>
</ListView>

public class LocationViewModel : BaseViewModel
{
    ObservableCollection<Location> _locations = new ObservableCollection<Location>();
    public ObservableCollection<Location> Locations
    {
        get
        {
            return _locations;
        }
        set
        {
            if (_locations != value)
            {
                _locations = value;
                OnNotifyPropertyChanged();
            }
        }
    }
}

public class Location : BaseViewModel
{
    int _locationId = 0;
    public int LocationId
    {
        get
        {
            return _locationId;
        }
        set
        {
            if (_locationId != value)
            {
                _locationId = value;
                OnNotifyPropertyChanged();
            }
        }
    }

    string _name = null;
    public string Name
    {
        get
        {
            return _name;
        }
        set
        {
            if (_name != value)
            {
                _name = value;
                OnNotifyPropertyChanged();
            }
        }
    }

    float _latitude = 0;
    public float Latitude 
    { 
        get
        {
            return _latitude;
        }
        set
        {
            if (_latitude != value)
            {
                _latitude = value;
                OnNotifyPropertyChanged();
            }
        }
    }

    float _longitude = 0;
    public float Longitude
    {
        get
        {
            return _longitude;
        }
        set
        {
            if (_longitude != value)
            {
                _longitude = value;
                OnNotifyPropertyChanged();
            }
        }
    }
}

public class BaseViewModel : INotifyPropertyChanged
{
    #region Events
    public event PropertyChangedEventHandler PropertyChanged;
    #endregion

    protected void OnNotifyPropertyChanged([CallerMemberName] string memberName = "")
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(memberName));
        }
    }
} 
```

# c++ - WinHttp 获取 404 文件未找到

> ID：349965
> 
> 赞同：1
> 
> 时间：2008-12-08T16:01:34.867
> 
> 标签：c++, winhttp

我正在使用 WinHttp 抓取一个网页，结果页面是该站点的 404 文件未找到页面。我知道该代码可以正常工作，因为我已经在其他网站上对其进行了测试。有问题的页面是一个普通的 http 协议和 .html 文件。

我能做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T16:12:10.053

你不会付出太多。我可能会从您`WinHttp`调用的 HTTP 会话跟踪开始，并将其与基于浏览器的工作会话的跟踪进行比较，看看有什么不同。可以是任何东西，从 cookie 到`referer`字段，再到谁知道服务器可能不喜欢什么。

# hyperlink - 如何阻止链接在 DNN 4.9.x 中包装

> ID：349974
> 
> 赞同：0
> 
> 时间：2008-12-08T16:03:57.620
> 
> 标签：hyperlink, word-wrap, dotnetnuke

我遇到了链接换行的问题。我该如何防止这种情况？

![自动换行][1]

[1]：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-08T16:12:34.267

你可以试试这个`<nobr>`标签。

例如：

```
<nobr><a href="#">my long link</a></nobr> 
```

# java - 了解 Eclipse 中导入的 WAR 及其文件夹结构

> ID：349978
> 
> 赞同：2
> 
> 时间：2008-12-08T16:05:00.320
> 
> 标签：java, eclipse

我刚刚从外部站点导入了一个 WAR 文件，它基本上是一个 servlet 到 Eclipse IDE（项目在 Apache-Tomcat 上运行）。

当我导入它时，它有一个名为**Web App Libraries**的文件夹。所以这里有一些我的新手问题：

1.  我不确定这个文件夹的确切用途是什么？它有什么作用，你为什么选择在你的项目中使用它？

2.  我看到它有一个名为**Improted Classes**的文件夹和里面的 foobar.class 文件 - 为什么？
    *（这些似乎反映在**Web Content**文件夹中 - 尽管您可以在此处修改代码，因为它们是 foobar.java。）*

3.  也有对 foobar.jar 文件的引用——这些也反映在**WEB-INF/lib**文件夹中——为什么？

我知道这些是基本类型的问题，但我刚刚开始掌握 Java 和网站开发，所以如果它们听起来有点愚蠢，请道歉！- 顺便说一句，如果有人知道任何好的在线资源来了解更多关于这样的项目文件结构的信息，请告诉我。我只需要尽快掌握这些东西——因为项目截止日期很快。

干杯。

这是一个屏幕截图，只是为了帮助您可视化：

![替代文字](https://rantincsharp.files.wordpress.com/2008/12/eclipserestlet.gif)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T18:37:50.463

我假设这是来自“项目资源管理器”视图的屏幕截图。它不显示确切的文件夹和文件结构，只是添加了一些从项目元数据构建的糖果。

*   要查看项目的真实结构，请尝试切换到“导航器”视图。
*   在 WAR 文件导入期间，Eclipse 基本上做了两件事：
    *   创建一个新的 Web 项目并将 WAR 的内容复制到新项目的“WebContent”子文件夹中。
    *   它基于 WAR，构建项目的元数据（.project 和 .classpath 文件）。
*   “Web App Libraries”部分显示 WAR 包含的 jar 文件列表（在 WEB-INF/lib
*   “导入的类”（我也是第一次看到）似乎包含在导入的 WAR（WEB-INF/类）中找到的类，Eclipse 无法找到任何相应的源文件。要解决此问题，请在项目中创建一个新的 Java 源文件夹并将您现在在“firstResource”文件夹中拥有的类移动到该文件夹​​。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T17:47:37.460

Web App Libraries 不是一个真正的目录，而是 Eclipse 认为是该项目的库的列表。

通常，这包括 WebContent/WEB-INF/lib/ 中的所有 jar 文件

有时，Eclipse 不再将它们列在 Eclipse 的 Package Explorer 中的真实目录中……但如果您使用另一个程序查看它们，它们仍然存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-08T16:29:55.197

在 Eclipse 中，如果您使用的是 Java Web Development 视图，您将配置：

1.  提供 servlet 库的 Tomcat 服务器运行时
2.  Java 运行时
3.  其他需要的库

项目中的 Web App Libraries 复制了第一个设置，因此您不需要在开发盒上安装本地 Tomcat。

其余的对我来说听起来很乱。

您的 src / JavaSource 文件夹中包含原始 Java 文件。它们不应该出现在 Web 内容中——那是为了你的 HTML、图像、JSP 等。

所以一个典型的项目设置：

```
Project Name/
   JavaSource/ or src/ // holds all the Java Source Files, Servlets, Struts Actions
   WebContent/         // Nice root folder to hold web content files
       content files and folders
       WEB-INF/        // Web App Config folder
           lib/        // Libraries (but not tomcat ones)
           web.xml
           classes/    // Where your compiled Java goes, and configs (log4j.properties) 
```

有些人也将 JSP 放在 WEB-INF 中，因为它不需要在 JSP 文件状态下可访问，仅在 Tomcat 自己执行的编译状态下即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T17:44:31.007

它简单，eclipse 为您的项目结构提供了多种视图。您正在查看的视图绝对是 Package Explorer 视图。在这种情况下，前面有一个特殊图标的所有东西都是一个帮助项目，它可以通过简化对某些东西的访问来帮助你，比如外部库（由计算机上的软件或 eclipse 本身或其他项目提供）。

在 Eclipse 中，转到 menu->window->show view->navigator Navigator 视图会告诉您项目的真实文件夹结构。

# sql-server - 从 SQL 视图执行 SQL 存储过程

> ID：349979
> 
> 赞同：11
> 
> 时间：2008-12-08T16:05:24.403
> 
> 标签：sql-server, stored-procedures, view

我发现在 Excel 中调用存储过程并不像应有的那么容易，但是调用视图或直接表非常容易。那么，如何创建一个视图来调用没有参数的存储过程？

我知道我将无法将任何值传递到视图中，而且我不需要或不想，只想将存储过程包装在视图中。

类似的东西`select exec MyStoredProc()`会很棒。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-08T16:18:58.667

iirc（我手头没有副本）如果您碰巧在 T-SQL 中，应该可以从返回表的**用户定义的表函数**（对于大多数意图和目的与 sprocs 相同）中选择 *多变的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T16:12:45.683

您应该能够在虚拟表上放置触发器，并在触发器内调用 proc。

这绝对是一个 hack，你会想要真正锁定 table 和 proc 的权限。

# ruby-on-rails - Rails 中的友好字节格式

> ID：349980
> 
> 赞同：15
> 
> 时间：2008-12-08T16:05:32.127
> 
> 标签：ruby-on-rails, ruby

我需要将字节的整数表示形式格式化为友好的形式，并且我希望 Ruby 或 Rails 中有一个实用函数可以为我进行格式化（当然是为了让我的懒惰永久化。）

我正在寻找看起来像的东西：

```
format_bytes(1024)     -> "1 KB"
format_bytes(1048576)  -> "1 MB" 
```

看起来 ActiveSupport 中有一些东西可以反过来做，但我还没有找到朝这个方向做的方法。

如果不存在，有没有人有一个特别优雅的解决方案？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-12-08T16:30:53.853

[数字到人类的大小](http://api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html)是您正在寻找的。

```
require 'action_view'
include ActionView::Helpers::NumberHelper
number_to_human_size(123)                                          # => 123 Bytes
number_to_human_size(1234)                                         # => 1.2 KB
number_to_human_size(12345)                                        # => 12.1 KB
number_to_human_size(1234567)                                      # => 1.2 MB
number_to_human_size(1234567890)                                   # => 1.1 GB
number_to_human_size(1234567890123)                                # => 1.1 TB
number_to_human_size(1234567, :precision => 2)                     # => 1.18 MB
number_to_human_size(483989, :precision => 0)                      # => 473 KB
number_to_human_size(1234567, :precision => 2, :separator => ',')  # => 1,18 MB 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-30T00:41:29.797

接受的答案仍然有效，但在较新的 rails 中需要 actionpack 而不是 actionview。

```
require 'actionpack' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-13T15:48:19.390

接受的答案很完美，但我不需要前两行。我只放：

```
number_to_human_size(123)                                          # => 123 Bytes
number_to_human_size(1234)                                         # => 1.2 KB
number_to_human_size(12345)                                        # => 12.1 KB
number_to_human_size(1234567)                                      # => 1.2 MB
number_to_human_size(1234567890)                                   # => 1.1 GB
number_to_human_size(1234567890123)                                # => 1.1 TB
number_to_human_size(1234567, :precision => 2)                     # => 1.18 MB
number_to_human_size(483989, :precision => 0)                      # => 473 KB
number_to_human_size(1234567, :precision => 2, :separator => ',')  # => 1,18 MB 
```

并且像魅力一样工作。

# php - 这个正则表达式有什么作用

> ID：349997
> 
> 赞同：3
> 
> 时间：2008-12-08T16:08:43.557
> 
> 标签：php, regex, wordpress

```
$pee = preg_replace( '|<p>|', "$1<p>", $pee ); 
```

这个正则表达式来自Wordpress源代码（formatting.php，wpautop函数）；我不确定它的作用，有人可以帮忙吗？

实际上我正在尝试将此函数移植到 Python ......如果有人已经知道现有的端口，那会好得多，因为我对正则表达式真的很不好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T16:31:25.740

preg_replace() 函数 - 有点令人困惑 - 允许您使用除标准“/”之外的其他分隔符用于正则表达式，所以

```
"|<p>|" 
```

将是一个正则表达式，只是匹配

```
"<p>" 
```

在文本中。但是，我不清楚替换参数是什么

```
"$1<p>" 
```

会这样做，因为没有分组映射到 $1。看起来就像给定的那样，这只是用一个空字符串替换一个段落标记，然后是一个段落标记，实际上什么都不做。

任何对 PHP 怪癖有更深入了解的人都有更好的分析？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T16:15:07.973

...？

实际上，看起来这需要第一个`<p>`标记并将前一个正则表达式的第一个匹配项添加到它之前（因为在这个标记中没有匹配项），

但是，至少可以说这种行为是不好的，因为不能保证 preg_* 函数不会用自己的值破坏 $1 。

编辑：从杰伊的评论来看，这个正则表达式实际上什么也没做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-08T16:15:44.477

wordpress 真的称变量为“小便”吗？

我不确定 $1 代表什么（第一个参数中没有大括号？），所以我认为它实际上没有任何作用，但我可能是错的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T17:05:47.513

在这种情况下，管道符号`|`没有“匹配这个或那个”的默认含义，而是用作模式的替代分隔符，而不是更常见的斜杠`/`。这可能是有道理的，如果您想匹配 for`/`而不必逃避这些外观（例如`/(.\*)\/(.\*)\//`，不如 可读`#/(.\*)/(.\*)/#`）。不过，使用它似乎是相当有效的，`|`但这只是模式的另一个保留字符。

通常`$1`在替换模式中应该匹配由括号表示的第一组。例如，如果你有一个像

```
"(.*)<p>" 
```

`$0`将包含整个匹配项和.`$1`之前的部分`&lt;p&gt;`。

由于给定的 reg-ex 没有声明任何组并且`$1`不是在别处定义的变量（在 PHP4 中）的有效名称，因此此调用似乎替换了任何出现的`&lt;p&gt;`with `&lt;p&gt;`?

老实说，我现在也很困惑。只是一个猜测：在给定行之前调用另一个模式匹配方法（preg_match 等），所以`$1`从那里“泄漏”？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-08T16:34:49.510

我强烈推荐惊人的[RegexBuddy](http://www.regexbuddy.com/ "正则表达式好友")

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T20:39:56.723

我相信那条线什么也没做。

对于它的价值，这是前一行，其中设置了 $1：

```
$pee = preg_replace('!<p>([^<]+)\s*?(</(?:div|address|form)[^>]*>)!', "<p>$1</p>$2", $pee); 
```

但是，我认为这不值得。在我的测试中，$1 不会保持从一个 preg_replace 到下一个的值，即使下一个没有为 $1 设置自己的值。请记住，PHP 变量名不能以数字开头（参见： http: [//php.net/language.variables](http://php.net/language.variables)），因此 $1 不是 PHP 变量。它仅表示单个 preg_replace 中的某些内容，在这种情况下 preg_replace 的规则表明它没有任何意义。

也就是说，autop 是一个如此广泛使用的函数，这让我怀疑我自己的结论，即这条线什么也没做。所以我期待有人纠正我。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-13T13:37:01.197

正则表达式仅匹配文字文本

. 选择用竖线而不是正斜杠来分隔正则表达式是非常不幸的。它不会更改代码，但会使人类更难阅读。（这也使得在正则表达式中无法使用交替运算符。）

$1 在 PHP 中不是一个有效的变量名，因此 $1 永远不会插入双引号字符串中。$1 不变地传递给 preg_replace。preg_replace 解析替换字符串，并将 $1 替换为第一个捕获组的内容。如果没有捕获组，则 $1 将被替换为空。

因此，此代码与以下代码相同：

```
$pee = preg_replace( '/<p>/', "<p>", $pee ); 
```

这样做什么都不做是不正确的。搜索和替换将运行，降低您的软件速度，并为 $pee 的临时副本占用内存。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2008-12-08T16:16:04.493

它从模式中替换匹配

```
"|<p>|" 
```

由字符串

```
"$1<p>" 
```

该| 在替换模式中是导致正则表达式引擎匹配左侧的部分或右侧的部分。

我不明白为什么要这样使用它，因为通常它是用于“ta（b | p）e”之类的......

对于 $1，我猜变量 $1 在 PHP 代码中，它在 preg_replace 期间被替换，所以 if $1 = "test"; 替换将替换

```
"<p>" 
```

到

```
"test<p>" 
```

但我不确定 1 美元****``************