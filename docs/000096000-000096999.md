# StackOverflow 问答 000096000-000096999

# ruby-on-rails - Rails 中同一个模型的多个关系

> ID：96003
> 
> 赞同：12
> 
> 时间：2008-09-18T19:25:13.103
> 
> 标签：ruby-on-rails

假设我有两个模型，Classes 和 People。一个班级可能有一两个人作为教师，二十个人作为学生。所以，我需要在模型之间建立多种关系——一种是针对教师的 1->M，一种是针对学生的 1->M。

编辑：教师和学生*必须*相同；教师可以是其他班级的学生，反之亦然。

我敢肯定这很容易，但谷歌没有提出任何相关的内容，我只是没有在我的书中找到它。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-18T19:29:35.933

这里有很多选项，但假设讲师始终是讲师，学生始终是学生，您可以使用继承：

```
class Person < ActiveRecord::Base; end  # btw, model names are singular in rails
class Student < Person; end
class Instructor < Person; end 
```

然后

```
class Course < ActiveRecord::Base  # renamed here because class Class already exists in ruby
  has_many :students
  has_many :instructors
end 
```

请记住，要使单表继承起作用，您需要表`type`中的一列`people`。

### 使用关联模型可能会解决您的问题

```
class Course < ActiveRecord::Base
  has_many :studentships
  has_many :instructorships
  has_many :students,    :through => :studentships
  has_many :instructors, :through => :instructorships
end

class Studentship < ActiveRecord::Base
  belongs_to :course
  belongs_to :student, :class_name => "Person", :foreign_key => "student_id"
end

class Instructorship < ActiveRecord::Base
  belongs_to :course
  belongs_to :instructor, :class_name => "Person", :foreign_key => "instructor_id"
end 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-04-07T12:15:41.637

在我的情况下，我有资产和用户模型资产可以由用户创建并且可以分配给用户并且用户可以创建许多资产并且可以拥有许多资产我的问题的解决方案是asset.rb

```
class Asset < ActiveRecord::Base

belongs_to :creator ,:class_name=>'User'
belongs_to :assigned_to, :class_name=>'User' 

end 
```

和

```
user.rb

class User < ActiveRecord::Base

has_many :created_assets, :foreign_key => 'creator_id', :class_name => 'Asset'
has_many :assigned_assets , :foreign_key => 'assigned_to_id', :class_name => 'Asset'

end 
```

所以你的解决方案可能是

```
class Course < ActiveRecord::Base
has_many :students ,:foreign_key => 'student_id', :class_name => 'Person'
has_many  :teachers, :foreign_key => 'teacher_id', :class_name => 'Person'

end 
```

和

```
class Person < ActiveRecord::Base
belongs_to  :course_enrolled,:class_name=>'Course'
belongs_to  :course_instructor,:class_name=>'Course'

end 
```

# c# - 了解类型参数是否在 c# 2.0 中实现接口的更简单方法是什么？

> ID：96027
> 
> 赞同：2
> 
> 时间：2008-09-18T19:27:20.620
> 
> 标签：c#, reflection, types

例如，给定一个类型参数方法，我正在寻找类似粗体部分的东西

> void MyMethod< T >() {
> if ( **typeof(T).Implements( *IMyInterface* )** ) {
> 
> ```
>  //Do something 
> ```
> 
> 别的
> 
> ```
>  //Do something else 
> ```
> 
> }

也欢迎使用 C# 3.0 的答案，但请先放弃 .NET 2.0 的答案；）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T19:30:20.673

[Type.IsAssignableFrom](http://msdn.microsoft.com/en-us/library/system.type.isassignablefrom.aspx)

```
if(typeof(IMyInterface).IsAssignableFrom(typeof(T)))
{
  // something
}
else
{
  // something else
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T19:30:35.290

我认为

```
if (typeof (IMyInterFace).IsAssignableFrom(typeof(T)) 
```

也应该工作：但我没有看到优势......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T19:34:24.440

Ï刚刚尝试使用

```
if( typeof(T).Equals(typeof(IMyInterface) ) 
     ... 
```

而且也有效，但是您的答案似乎更可靠，并且是我想要的。谢谢！

# asp.net - 在代码隐藏中获取 ASP.Net 页面的 URL

> ID：96029
> 
> 赞同：200
> 
> 时间：2008-09-18T19:27:25.690
> 
> 标签：asp.net

我有一个 ASP.Net 页面，它将托管在几个不同的服务器上，我想获取页面的 URL（或者更好的是：托管页面的站点）作为字符串用于代码隐藏. 有任何想法吗？

* * *

## 回答 #1

> 赞同：235
> 
> 时间：2008-09-18T19:30:31.033

用这个：

```
Request.Url.AbsoluteUri
```

这将为您提供完整路径（包括[http://..](http://..)）

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2009-10-07T21:59:17.330

如果您只想要请求的方案和权限部分（协议、主机和端口），请使用

```
Request.Url.GetLeftPart(UriPartial.Authority) 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2010-08-02T07:59:18.133

我在用

```
Request.Url.GetLeftPart(UriPartial.Authority) +
        VirtualPathUtility.ToAbsolute("~/") 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-08-20T14:04:09.727

我在自定义类的代码中使用它。派上用场发送电子邮件，如 no-reply@example.com "no-reply@" + BaseSiteUrl 在任何网站上都可以正常工作。

```
// get a sites base urll ex: example.com
public static string BaseSiteUrl
{
    get
    {
        HttpContext context = HttpContext.Current;
        string baseUrl = context.Request.Url.Authority + context.Request.ApplicationPath.TrimEnd('/');
        return baseUrl;
    }

} 
```

如果您想在代码隐藏中使用它，请摆脱上下文。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-18T19:32:15.117

你想要服务器名称吗？还是主机名？

[Request.Url.Host](https://stackoverflow.com/questions/96029/get-url-of-aspnet-page-in-code-behind#96052)阿拉斯蒂芬

[Dns.GetHostName](http://msdn.microsoft.com/en-us/library/system.net.dns.gethostname.aspx) - 服务器名称

[Request.Url](http://msdn.microsoft.com/en-us/library/system.web.httprequest.url.aspx)将有权访问您需要了解的有关所请求页面的大部分内容。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-12-01T16:03:20.167

```
Request.Url.GetLeftPart(UriPartial.Authority) + Request.FilePath + "?theme=blue"; 
```

这将为您提供您所在页面的完整路径。我在查询字符串中添加了。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-11-30T14:10:08.920

我面临同样的问题，到目前为止我发现：

```
new Uri(Request.Url,Request.ApplicationPath) 
```

或者

```
Request.Url.GetLeftPart(UriPartial.Authority)+Request.ApplicationPath 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-18T19:29:16.137

请求.Url.Host

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-06-12T16:29:36.847

如果要在末尾包含任何唯一字符串，类似于 example.com?id=99999，请使用以下内容

```
Dim rawUrl As String = Request.RawUrl.ToString() 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-06-25T06:43:26.990

使用 js 文件，您可以捕获以下内容，也可以在代码隐藏中使用：

```
<script type="text/javascript">
    alert('Server: ' + window.location.hostname);
    alert('Full path: ' + window.location.href);
    alert('Virtual path: ' + window.location.pathname);
    alert('HTTP path: ' + 
        window.location.href.replace(window.location.pathname, ''));    
</script> 
```

# apache-flex - Flex 最佳实践？

> ID：96040
> 
> 赞同：8
> 
> 时间：2008-09-18T19:28:40.290
> 
> 标签：apache-flex, actionscript, blazeds, puremvc

我感觉在 Flex 上很容易找到示例、教程和简单示例。
似乎更难找到基于现实项目的技巧和良好实践。
关于如何的任何提示：

*   如何编写可维护的动作脚本代码
*   如何确保干净的关注点分离。有没有人在真正的 Flex 项目中使用过诸如 cairngorm、puremvc 或 easymvc 之类的 MVC 框架？
*   如何使用 blazeds/amfphp 从服务器获取数据？
*   如何减少最终用户的延迟？
*   ...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T19:55:19.787

在我的工作中，我经常与 Flex 一起工作，我很乐意提供帮助。但您的问题值得为每个问题撰写一篇文章 :) 我会尝试一些简短的回答。

可维护的代码：我认为任何其他面向对象语言的相同规则都适用。我习惯遵循一些特定于 flex 的规则：使用强类型变量，始终考虑调度事件作为 UI 组件相互通信的方式（更多的初始工作，非常灵活并且稍后解耦）。

框架：看了看，阅读了文档.. 非常好，但我仍然觉得它们的复杂性与它们提供的好处并没有平衡。无论如何，我想在这一点上改变主意..

与服务器交谈：现在我正在使用 BlazeDS，它工作得很好.. 那里有很多关于这个主题的教程，如果你在设置它时发现任何问题，我很乐意提供帮助。

延迟：您是指客户端/服务器通信吗？如果是这样，您应该探索 BlazeDS 实现的各种类型的通道。仅拉式，双向 http 轮询，在 http（彗星）上近乎实时。如果您需要更多，LiveCycle Data Services ES，来自的商业实现BlazeDS 的诞生，除其他外提供另一种称为 RTMP 的协议，它不是 http 隧道的，因此防火墙和代理可能存在问题，但它提供了更好的性能（有一个免费的 LCDS 闭源版本）。我在 Intranet 环境中使用标准的 http 通道，即使使用大型数据集也没有发现真正的性能问题。

嗯..很多东西，现在不能对每一点更具体，请问您是否需要:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T18:40:41.727

以下是一些与 Flex/AS3 最佳实践和标准有关的重要资源：

[Flex SDK 编码约定和最佳实践](http://opensource.adobe.com/wiki/display/flexsdk/Coding+Conventions)

[Flex 最佳实践 - 第 1 部分：设置您的 Flex 项目](http://www.adobe.com/devnet/flex/articles/best_practices_pt1.html)

我发现第一个特别有用，我尝试确保与我合作的任何团队都阅读过它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T18:56:27.790

我发现 MVC 框架 RIAWave[链接](http://ria.richtechmedia.com/go.php?http://ria.richtechmedia.com/flexsample/sample.rar)绝对令人难以置信。它超轻巧且易于使用。我发现 Cairngorm 和 PureMVC 的学习曲线非常陡峭，而且它们都对我来说有点笨重。RIAWave 不碍事，只为您提供 MVC 基础知识。

后端的 AMFPHP 也非常好。AMFPHP 还有一个 apache 模块，它将负责序列化/反序列化所有在 C 中发送和接收的数据，这非常快。

If latency is a worry, you will want to make sure you get a good webhost or even deploy to multiple data centers so that your users are never far from a server. Sounds like a bit early to be worrying about that though.

# java - 使用 Groovy/JRuby/Jython 或其他 JVM 语言的 UI 设计替代方案？

> ID：96041
> 
> 赞同：3
> 
> 时间：2008-09-18T19:28:45.750
> 
> 标签：java, user-interface, groovy, jruby, jvm-languages

对于 Java 生态系统中的开发人员来说，在 UI 设计方面有一些选择。最著名的是：

*   Swing（与 Netbeans 及其 GUI 构建器一起使用时首选）
*   Eclipse 的 SWT（主要用于 Eclipse 插件）

现在，是否有任何针对 JRuby / Groovy / Jython 或其他“动态”JVM 语言的框架或设计替代方案？

一些 UI 框架是 Swing 或 SWT 之上的层，例如，框架可以读取 XML 中的屏幕描述并实例化相应的 Swing 组件。

如果您知道这样的框架，但它以 JVM“动态”语言为目标，我也希望在答案中看到它们。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T20:24:14.943

不完全是 UI 设计，但你可以试试[Griffon](http://groovy.codehaus.org/Griffon)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-02-15T14:36:05.100

Clojure 有一些看起来很重要的 GUI 库/框架：

[seesaw](https://github.com/daveray/seesaw)将 Swing 包装在一个非常简洁的 DSL 中，它当然可以用于声明式地创建 GUI 界面：

```
(defn -main [& args]
  (invoke-later 
    (-> (frame :title "Hello", 
           :content "Hello, Seesaw",
           :on-close :exit)
     pack!
     show!))) 
```

[Incanter](http://incanter.org/)提供了相当多的图形和可视化功能（包括 JFreeChart 等）。不是一个通用的 GUI 库，但如果您专注于统计数据，则非常有用：

```
;; show a histogram of 1000 samples from a normal distribution
(view (histogram (sample-normal 1000))) 
```

还有一些简洁的示例代码弹出，用于[在 Clojure 中包装 JavaFX 2.0](http://blog.altasoft.pl/2011/06/clojure-javafx-2-0-simple-app/) - 这更像是一个声明性 DSL：

```
(defn -start [app stage]
   (eval
     (fx Stage :visible true :width 300 :height 200 :title "hello world"
         :scene (fx Scene
                  (fx BorderPane :left (fx Text "hello")
                      :right (fx Text "Right")
                      :top (fx Text "top")
                      :bottom (fx Text "Bottom")
                      :center (fx Text "In the middle!")))))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-02T11:48:06.870

我认为 Jruby 最成熟的两个框架是 Monkeybars ( [http://monkeybars.rubyforge.org/](http://monkeybars.rubyforge.org/) ) 和 Limelight ( [http://limelight.8thlight.com/](http://limelight.8thlight.com/) )。

Monkeybars 是一个完整的 ruby​​esque MVC 实现，可以与 Swing GUI 构建器结合使用，而 Limelight 则像 Shoes 一样追求最小代码/最大效果比率。

# delphi - 什么是安全呼叫？

> ID：96042
> 
> 赞同：16
> 
> 时间：2008-09-18T19:28:53.237
> 
> 标签：delphi, calling-convention

我正在使用 VB6 创建一个 ActiveX EXE，我得到的唯一示例都是用 Delphi 编写的。

阅读示例代码，我注意到有一些函数的签名后跟**safecall**关键字。这是一个例子：

```
function AddSymbol(ASymbol: OleVariant): WordBool; safecall; 
```

这个关键字的目的是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-18T19:51:03.417

Safecall 从右到左传递参数，而不是从左到右传递 pascal 或寄存器（默认）

使用safecall，过程或函数在返回时从堆栈中删除参数（如pascal，但不像cdecl，它取决于调用者）

Safecall 实现异常“防火墙”；特别是在 Win32 上，这实现了进程间 COM 错误通知。否则它将与 stdcall 相同（与 win api 一起使用的其他调用约定）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-18T21:21:09.190

此外，异常防火墙通过使用支持 IErrorInfo 的对象调用 SetErrorInfo() 来工作，以便调用者可以获得有关异常的扩展信息。这是由 TComObject 和 TAutoIntfObject 中的 TObject.SafeCallException 覆盖完成的。这两种类型都实现了 ISupportErrorInfo 来标记这个事实。

如果发生异常，safecall 方法的调用者可以查询 ISupportErrorInfo，然后查询其方法导致失败 HRESULT（高位设置）的接口，如果返回 S_OK，[GetErrorInfo()](http://msdn.microsoft.com/en-us/library/ms221032.aspx)可以获得异常信息（描述、帮助等，以由 Delphi RTL 在 SafeCallException 覆盖中传递给[SetErrorInfo()的 IErrorInfo 实现的形式）。](http://msdn.microsoft.com/en-us/library/ms221409.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-05-16T14:14:13.677

在 COM 中，每个方法都是一个返回 的函数`HRESULT`：

```
IThingy = interface
   ['{357D8D61-0504-446F-BE13-4A3BBE699B05}']
   function AddSymbol(ASymbol: OleVariant; out RetValue: WordBool): HRESULT; stdcall;
end; 
```

这是 COM 中的绝对规则：

*   COM中没有例外
*   一切都返回一个 HRESULT
*   负 HRESULT 表示失败
*   在高级语言中，失败被映射到异常

COM 设计者的意图是更高级别的语言会自动将**失败**的方法转换为异常。

因此，在您自己的语言中，COM 调用将在没有 HRESULT 的情况下表示。例如：

*   **类似德尔福**：`function AddSymbol(ASymbol: OleVariant): WordBool;`
*   **C# 类**：`WordBool AddSymbol(OleVariant ASymbol);`

在 Delphi 中，您可以选择使用原始函数签名：

```
IThingy = interface
   ['{357D8D61-0504-446F-BE13-4A3BBE699B05}']
   function AddSymbol(ASymbol: OleVariant; out RetValue: WordBool): HRESULT; stdcall;
end; 
```

并自己处理引发的异常：

```
bAdded: WordBool;
thingy: IThingy;
hr: HRESULT;

hr := thingy.AddSymbol('Seven', {out}bAdded);
if Failed(hr) then
    OleError(hr); 
```

或更短的等价物：

```
bAdded: WordBool;
thingy: IThingy;
hr: HRESULT;

hr := thingy.AddSymbol('Seven', {out}bAdded);
OleCheck(hr); 
```

或更短的等价物：

```
bAdded: WordBool;
thingy: IThingy;

OleCheck(thingy.AddSymbol('Seven'), {out}bAdded); 
```

## COM 不打算让你处理 HRESULT

但是你可以让 Delphi 把管道隐藏起来，这样你就可以继续编程了：

```
IThingy = interface
   ['{357D8D61-0504-446F-BE13-4A3BBE699B05}']
   function AddSymbol(ASymbol: OleVariant): WordBool; safecall;
end; 
```

在幕后，编译器仍然会检查返回的 HRESULT，`EOleSysError`如果 HRESULT 指示失败（即是否定的），则抛出异常。编译器生成的**安全调用**版本在功能上等同于：

```
function AddSymbol(ASymbol: OleVariant): WordBool; safecall;
var
   hr: HRESULT;
begin
   hr := AddSymbol(ASymbol, {out}Result);
   OleCheck(hr);
end; 
```

但它让您可以简单地调用：

```
bAdded: WordBool;
thingy: IThingy;

bAdded := thingy.AddSymbol('Seven'); 
```

tl;博士：您可以使用以下任一：

```
function AddSymbol(ASymbol: OleVariant; out RetValue: WordBool): HRESULT; stdcall;
function AddSymbol(ASymbol: OleVariant): WordBool; safecall; 
```

但前者要求您每次都处理 HRESULT。

## 奖金喋喋不休

您几乎不想自己处理 HRESULT；它使程序杂乱无章，并没有增加任何噪音。但有时您可能想自己检查 HRESULT（例如，您想处理不是很特殊的故障）。从来没有版本的 Delphi 开始包含以两种方式声明的已翻译的 Windows 标头接口：

```
IThingy = interface
   ['{357D8D61-0504-446F-BE13-4A3BBE699B05}']
   function AddSymbol(ASymbol: OleVariant; out RetValue: WordBool): HRESULT; stdcall;
end;

IThingySC = interface
   ['{357D8D61-0504-446F-BE13-4A3BBE699B05}']
   function AddSymbol(ASymbol: OleVariant): WordBool); safecall;
end; 
```

或来自 RTL 源：

```
 ITransaction = interface(IUnknown)
    ['{0FB15084-AF41-11CE-BD2B-204C4F4F5020}']
    function Commit(fRetaining: BOOL; grfTC: UINT; grfRM: UINT): HResult; stdcall;
    function Abort(pboidReason: PBOID; fRetaining: BOOL; fAsync: BOOL): HResult; stdcall;
    function GetTransactionInfo(out pinfo: XACTTRANSINFO): HResult; stdcall;
  end;

  { Safecall Version }
  ITransactionSC = interface(IUnknown)
    ['{0FB15084-AF41-11CE-BD2B-204C4F4F5020}']
    procedure Commit(fRetaining: BOOL; grfTC: UINT; grfRM: UINT); safecall;
    procedure Abort(pboidReason: PBOID; fRetaining: BOOL; fAsync: BOOL); safecall;
    procedure GetTransactionInfo(out pinfo: XACTTRANSINFO); safecall;
  end; 
```

**SC**后缀代表**safecall**。这两个接口是等效的，您可以根据需要选择声明 COM 变量的接口：

```
//thingy: IThingy;
thingy: IThingySC; 
```

您甚至可以在它们之间进行转换：

```
thingy: IThingSC;
bAdded: WordBool;

thingy := CreateOleObject('Supercool.Thingy') as TThingySC;

if Failed(IThingy(thingy).AddSymbol('Seven', {out}bAdded) then
begin
   //Couldn't seven? No sixty-nine for you
   thingy.SubtractSymbol('Sixty-nine');
end; 
```

## 额外奖励 Chatter - C#

C# 默认情况下与 Delphi **safecall**等效，但在 C# 中除外：

*   您必须选择退出安全调用映射
*   而不是选择加入

在 C# 中，您可以将 COM 接口声明为：

```
[ComImport]
[Guid("{357D8D61-0504-446F-BE13-4A3BBE699B05}")]
[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface IThingy
{
   WordBool AddSymbol(OleVariant ASymbol);
   WordBool SubtractSymbol(OleVariant ASymbol);
} 
```

您会注意到 COM`HRESULT`对您隐藏。C# 编译器和 Delphi 编译器一样，会自动检查返回的 HRESULT 并为您抛出异常。

在 C# 中，就像在 Delphi 中一样，您可以选择自己处理 HRESULT：

```
[ComImport]
[Guid("{357D8D61-0504-446F-BE13-4A3BBE699B05}")]
[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface IThingy
{
   [PreserveSig]
   HRESULT AddSymbol(OleVariant ASymbol, out WordBool RetValue);

   WordBool SubtractSymbol(OleVariant ASymbol);
} 
```

[ [**PreserveSig]**](https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.dllimportattribute.preservesig%28v=vs.110%29.aspx?f=255&MSPPError=-2147217396)告诉编译器按原样保留方法签名：

> 指示是否直接转换具有**HRESULT**或**retval返回值的非托管方法，或者是否将****HRESULT**或**retval**返回值自动转换为异常。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T20:35:51.313

[Francois 所说](https://stackoverflow.com/questions/96042/whats-safecall#96231)的话，如果不是为了安全调用，您的 COM 方法调用将如下所示，您将不得不自己进行错误检查，而不是获取异常。

```
function AddSymbol(ASymbol: OleVariant; out Result: WordBool): HResult; stdcall; 
```

# c# - 是否可以将 C# double[,,] 数组转换为 double[] 而无需复制

> ID：96054
> 
> 赞同：5
> 
> 时间：2008-09-18T19:29:30.833
> 
> 标签：c#, .net, arrays

我的 .NET 应用程序中有大量的 3D 数字数组。我需要将它们转换为一维数组以将其传递给 COM 库。有没有办法在不复制所有数据的情况下转换数组？

我可以像这样进行转换，但是我使用了两倍的内存量，这在我的应用程序中是一个问题：

```
 double[] result = new double[input.GetLength(0) * input.GetLength(1) * input.GetLength(2)];
  for (i = 0; i < input.GetLength(0); i++) 
    for (j = 0; j < input.GetLength(1); j++) 
      for (k = 0; k < input.GetLength(2); k++) 
        result[i * input.GetLength(1) * input.GetLength(2) + j * input.GetLength(2) + k)] = input[i,j,l];
  return result; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T19:33:33.083

我不相信 C# 将这些数据存储在内存中的方式会使它像 C 中的简单强制转换一样可行。为什么不使用 1d 数组开始并为该类型创建一个类，以便您可以在程序中访问它，就好像它是 3d 数组一样？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T19:32:16.800

不幸的是，C# 数组不能保证在连续内存中，就像它们在 C 等更接近金属的语言中一样。所以，不。如果没有逐个元素的副本，就无法将 double[,,] 转换为 double[] 。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T20:32:48.560

考虑使用[代理](http://en.wikipedia.org/wiki/Proxy_pattern)抽象对数据的访问（类似于 C++ 中的迭代器/智能指针）。不幸的是，语法不如 C++ 干净，因为 operator() 不能重载，并且 operator[] 是单参数，但仍然很接近。

当然，这种额外的抽象级别增加了复杂性和它自己的工作，但它允许您对使用 double[,,] 对象的现有代码进行最小的更改，同时允许您对两者都使用单个 double[] 数组互操作和您的 in-C# 计算。

```
class Matrix3
{
    // referece-to-element object
    public struct Matrix3Elem{
        private Matrix3Impl impl;
        private uint dim0, dim1, dim2;
        // other constructors
        Matrix3Elem(Matrix3Impl impl_, uint dim0_, uint dim1_, uint dim2_) {
            impl = impl_; dim0 = dim0_; dim1 = dim1_; dim2 = dim2_;
        }
        public double Value{
            get { return impl.GetAt(dim0,dim1,dim2); }
            set { impl.SetAt(dim0, dim1, dim2, value); }
        }
    }

    // implementation object
    internal class Matrix3Impl
    {
        private double[] data;
        uint dsize0, dsize1, dsize2; // dimension sizes
        // .. Resize() 
        public double GetAt(uint dim0, uint dim1, uint dim2) {
            // .. check bounds
            return data[ (dim2 * dsize1 + dim1) * dsize0 + dim0 ];
        }
        public void SetAt(uint dim0, uint dim1, uint dim2, double value) {
            // .. check bounds
            data[ (dim2 * dsize1 + dim1) * dsize0 + dim0 ] = value;
        }
    }

    private Matrix3Impl impl;

    public Matrix3Elem Elem(uint dim0, uint dim1, uint dim2){
        return new Matrix2Elem(dim0, dim1, dim2);
    }
    // .. Resize
    // .. GetLength0(), GetLength1(), GetLength1()
} 
```

然后使用这种类型来读写——'foo[1,2,3]'现在写成'foo.Elem(1,2,3).Value'，在读取值和写入值时，赋值和值表达式的左侧。

```
void normalize(Matrix3 m){

    double s = 0;
    for (i = 0; i < input.GetLength0; i++)     
        for (j = 0; j < input.GetLength(1); j++)       
            for (k = 0; k < input.GetLength(2); k++)
    {
        s += m.Elem(i,j,k).Value;
    }
    for (i = 0; i < input.GetLength0; i++)     
        for (j = 0; j < input.GetLength(1); j++)       
            for (k = 0; k < input.GetLength(2); k++)
    {
        m.Elem(i,j,k).Value /= s;
    }
} 
```

同样，增加了开发成本，但共享数据，消除了复制开销和复制相关的开发成本。这是一个权衡。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T19:33:48.200

在不了解您的 COM 库的详细信息的情况下，我会考虑在 .Net 中创建一个外观类，并在必要时将其公开给 COM。
您的外观将采用 double[,,] 并有一个从 [] 映射到 [,,] 的索引器。

编辑：我同意评论中的观点，洛伦斯的建议更好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T19:34:47.263

作为一种解决方法，您可以创建一个以一维形式维护数组的类（甚至可能更接近裸机形式，以便您可以轻松地将其传递给 COM 库？）然后在此类上重载 operator[] 以使其可用作为 C# 代码中的多维数组。

# java - XMLEncoder 和 XStream 的相对优势是什么？

> ID：96059
> 
> 赞同：5
> 
> 时间：2008-09-18T19:30:26.587
> 
> 标签：java, xml, serialization, xstream

假设我想在 XML 中存储很多小的配置对象，并且我不太关心格式。JDK 中内置的[XMLDecoder](http://java.sun.com/j2se/1.5.0/docs/api/java/beans/XMLDecoder.html)类可以工作，据我所知，[XStream](http://xstream.codehaus.org/)以类似的方式工作。

每个图书馆的优势是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T21:28:29.907

我真的很喜欢[XStream](http://xstream.codehaus.org/) 库。由于提供的 Java 对象，它在输出相当简单的 xml 方面做得非常好。它也适用于从 xml 复制对象。而且，无论如何，我们的第 3 方库之一已经依赖它。

*   我们选择使用它是因为我们希望我们的 xml 是人类可读的。使用别名功能使它变得更好。

*   如果您希望对象的某些部分以更好的方式反序列化，您可以扩展库。我们在一个案例中这样做了，因此文件将具有一组度、分和秒来表示纬度和经度，而不是两个双精度值。

两分钟的教程总结了基本用法，但是为了将信息集中在一个地方，我会尝试在这里总结一下，稍微短一点。

```
// define your classes
public class Person {
  private String firstname;
  private PhoneNumber phone;
  // ... constructors and methods
}

public class PhoneNumber {
  private int code;
  private String number;
  // ... constructors and methods
} 
```

然后使用库写出xml。

```
// initial the libray
XStream xstream = new XStream();
xstream.alias("person", Person.class); // elementName, Class
xstream.alias("phone", PhoneNumber.class); 

// make your objects
Person joe = new Person("Joe");
joe.setPhone(new PhoneNumber(123, "1234-456"));

// convert xml
String xml = xstream.toXML(joe); 
```

您的输出将如下所示：

```
<person>
  <firstname>Joe</firstname>
  <phone>
    <code>123</code>
    <number>1234-456</number>
  </phone>
</person> 
```

回去：

```
Person newJoe = (Person)xstream.fromXML(xml);
```

XMLEncoder 是为 Java bean 序列化提供的。我上次使用它时，该文件看起来相当讨厌。如果真的不在乎文件的外观，它可以为您工作，并且您可以避免第 3 方依赖，这也很好。我希望使序列化更漂亮的可能性对于 XMLEncoder 也将是一个更大的挑战。

如果您不给名称起别名，XStream 会输出完整的类名。如果上面的 Person 类有

```
package example;
```

xml 将具有“example.Person”，而不仅仅是“person”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T20:48:51.023

另一个建议：考虑使用 JAXB ( [http://jaxb.dev.java.net](http://jaxb.dev.java.net) )。如果您使用的是 JDK 1.6，它是捆绑的，请查看“javax.xml.bind”了解详细信息，因此无需额外的外部 jar。

JAXB 相当快。我也喜欢 XStream，但它有点慢。此外，XMLEncoder 有点像玩具（与其他选项相比）......但如果它有效，那么使用它并没有什么坏处。

另外：JAXB 的一个好处是您还可以使用它绑定部分文档（子树）；无需为整个文件创建对象。为此，您需要使用 Stax (XMLStreamReader) 指向子树的根元素，然后绑定。无需使用 SAX，即使对于大多数大文件，只要可以逐块处理即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T19:41:40.320

如果您计划将所有这些配置对象存储在一个文件中，并且该文件将非常大，那么您上面概述的两个选项都可能会占用大量内存，因为它们都需要将整个文件读入内存以被反序列化。

如果内存使用是一个问题（包含 XML 的文件会非常大），我推荐[SAX](http://www.saxproject.org/)。

如果内存使用不是问题（包含 XML 的文件不会很大），我会使用默认 JRE（在本例中为 XMLDecoder）中包含的任何内容来删除第 3 方依赖项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T07:57:33.780

我也更喜欢[XStream](http://xstream.codehaus.org/)，因为它非常易于使用和扩展。如果您使用默认设置，您可以快速开始。如果您需要自定义行为，它有一个非常干净的 API 和许多扩展点，因此您可以非常精细地控制要调整的内容，而不会干扰编组过程的其他部分。

由于 XStream 创建的 XML 看起来不错，因此手动编辑也很简单。如果输出不能满足您的需求，并且可用[转换器](http://xstream.codehaus.org/converters.html)的长列表不包含您需要的转换器，那么编写自己的转换器相当简单。

一个很大的优点也是他们[主页](http://xstream.codehaus.org/)上的好文档。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-23T18:27:51.847

我总是觉得 XStream 很诱人，因为它很容易上手。但是，我总是最终更换它。它真的很麻烦，它的收集处理可能需要做很多工作。

因此，我通常会切换到 JAXB。它比 XStream 健壮得多，几乎没有错误，而且更灵活。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-02T14:54:44.753

除了@jay 回答示例：

代码：

```
PortfolioAlternateIdentifier identifier = new PortfolioAlternateIdentifier();
identifier.setEffectiveDate(new Date());
identifier.setSchemeCode("AAA");
identifier.setIdentifier("123456"); 
```

**使用 XStream 的输出：**

```
<PortfolioAlternateIdentifier>
 <effectiveDate>2014-05-02 20:14:15.961 IST</effectiveDate>
 <schemeCode>AAA</schemeCode>
 <identifier>123456</identifier>
</PortfolioAlternateIdentifier> 
```

**使用 XMLEncoder 的输出：**

```
<?xml version="1.0" encoding="UTF-8"?> 
 <java version="1.6.0_38" class="java.beans.XMLDecoder"> 
   <object class="PortfolioAlternateIdentifier"> 
    <void property="effectiveDate"> 
  <object class="java.util.Date"> 
   <long>1399041855961</long> 
  </object> 
    </void> 
 <void property="identifier"> 
  <string>123456</string> 
 </void> 
   <void property="schemeCode"> 
    <string>AAA</string> 
   </void> 
  </object> 
</java> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-23T18:23:59.000

Java 还有一个新的实用程序类，旨在存储配置中典型的键值对集。它是老式的，但非常简单和方便。这是通过[java.util.Properties](http://java.sun.com/javase/6/docs/api/java/util/Properties.html)类完成的，这是一个带有序列化选项的 Map 对象。除非您存储整个对象，否则这可能就是您所需要的。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-03-25T17:18:23.877

如果您要持久化大量对象或者您的系统需要多线程，您应该避免像瘟疫那样使用 XMLEncoder/XMLDecoder。有关可怕的详细信息，请参见[http://matthew.mceachen.us/blog/do-not-want-xmlencoder-129.html](http://matthew.mceachen.us/blog/do-not-want-xmlencoder-129.html)。

如果您必须使用 XML，XStream 非常棒。但是问问自己是否真的需要使用 XML。这是一个序列化基准项目，可能会让您获得更好的解决方案：

[http://code.google.com/p/thrift-protobuf-compare/wiki/Benchmarking](http://code.google.com/p/thrift-protobuf-compare/wiki/Benchmarking)

# javascript - 使用 JavaScript 进行自动化单元测试

> ID：96066
> 
> 赞同：60
> 
> 时间：2008-09-18T19:30:36.790
> 
> 标签：javascript, jquery, unit-testing, ant, automation

我正在尝试将一些 JavaScript 单元测试合并到我的自动化构建过程中。目前 JSUnit 与 JUnit 配合得很好，但它似乎是废弃软件，缺乏对 Ajax、调试和超时的良好支持。

有没有人有幸（使用[Ant](https://en.wikipedia.org/wiki/Apache_Ant)）自动化单元测试库，例如[YUI](https://en.wikipedia.org/wiki/Yahoo!_UI_Library)测试、jQuery 的[QUnit](https://code.jquery.com/qunit/)或[jQUnit](http://code.google.com/p/jqunit/)？

注意：我使用自定义构建的 Ajax 库，因此 Dojo 的 DOH 的问题在于它要求您使用自己的 Ajax 函数调用和事件处理程序来处理任何 Ajax 单元测试。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-18T20:44:13.803

我正要开始在我正在做的一个新项目上做 JavaScript [TDD 。](https://en.wikipedia.org/wiki/Test-driven_development)我目前的计划是使用[QUnit](http://docs.jquery.com/QUnit)进行单元测试。在开发测试时，只需在浏览器中刷新测试页面即可运行。

为了持续集成（并确保测试在所有浏览器中运行），我将使用[Selenium](http://selenium.openqa.org/)在每个浏览器中自动加载测试工具，并读取结果。这些测试将在每次签入源代码控制时运行。

我还将使用[JSCoverage](http://siliconforks.com/jscoverage/)来获取测试的代码覆盖率分析。这也将通过 Selenium 实现自动化。

我目前正在设置这个。设置完成后，我将使用更准确的详细信息更新此答案。

* * *

测试工具：

*   [量子单位](http://docs.jquery.com/QUnit)
*   [JS覆盖](http://siliconforks.com/jscoverage/)
*   [硒](http://selenium.openqa.org/)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-09-18T19:51:49.983

那里有许多 JavaScript 单元测试框架（JSUnit、scriptaculous 等），但 JSUnit 是我所知道的唯一一个可以用于自动构建的框架。

如果您正在进行“真正的”单元测试，则不需要 AJAX 支持。例如，如果您使用的是 DWR 等[RPC](https://en.wikipedia.org/wiki/Remote_procedure_call) Ajax 框架，您可以轻松编写一个模拟函数：

```
   函数模拟函数（someArg，回调）{
      变量结果 = ...; //一些处理
      设置超时（

        函数（）{回调（结果）；},
        300 // 一些虚假的延迟
      );
    }

```

是的，JSUnit 确实处理超时：*[Simulating Time in JSUnit Tests](http://googletesting.blogspot.com/2007/03/javascript-simulating-time-in-jsunit.html)*

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-11-03T16:15:27.023

[我是js-test-driver](http://code.google.com/p/js-test-driver/)的忠实粉丝。

它在[CI](https://en.wikipedia.org/wiki/Continuous_integration)环境中运行良好，并且能够捕获实际浏览器以进行跨浏览器测试。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-26T12:35:18.167

我最近阅读了 Bruno 的一篇文章，使用 JSUnit 并在此基础上创建了一个 JsMock 框架……非常有趣。我正在考虑使用他的工作来开始对我的 JavaScript 代码进行单元测试。

[模拟 JavaScript 或如何在浏览器环境之外对 JavaScript 进行单元测试](http://brunofigueiredo.com/post/Mock-Javascript-or-How-to-unit-test-Javascript-outside-the-Browser-environment-Part-1.aspx)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-10-19T11:39:31.597

我刚刚[让 Hudson CI 运行 JasmineBDD](http://skaug.no/ingvald/2010/10/javascript-unit-testing.html)（无头），至少对于纯 JavaScript 单元测试。

（Hudson 通过 shell 运行 Java，运行 Envjs，运行 JasmineBDD。）

不过，我还没有让它与一个大图书馆很好地配合，比如原型。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T19:36:52.780

查看[YUITest](http://developer.yahoo.com/yui/yuitest/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-12-11T22:33:22.130

我同意 JSUnit 有点垂死挣扎。我们刚刚用 YUI 测试完成了替换它。

与使用 qUnit 的示例类似，我们使用[Selenium](https://en.wikipedia.org/wiki/Selenium_%28software%29)运行测试。我们独立于我们的其他 Selenium 测试运行这个测试，仅仅是因为它没有正常的 UI 回归测试所具有的依赖关系（例如，将应用程序部署到服务器）。

首先，我们有一个包含在所有测试 HTML 文件中的基本 JavaScript 文件。这处理设置 YUI 实例、测试运行器、YUI.Test.Suite 对象以及 Test.Case。它具有可以通过 Selenium 访问以运行测试套件的方法，检查测试运行器是否仍在运行（在它完成之前结果不可用），并获取测试结果（我们选择 JSON 格式）：

```
var yui_instance; // The YUI instance
var runner;  // The YAHOO.Test.Runner
var Assert;    // An instance of YAHOO.Test.Assert to save coding
var testSuite; // The YAHOO.Test.Suite that will get run.

/**
 * Sets the required value for the name property on the given template, creates
 * and returns a new YUI Test.Case object.
 *
 * @param template the template object containing all of the tests
 */
function setupTestCase(template) {
    template.name = "jsTestCase";
    var test_case = new yui_instance.Test.Case(template);
    return test_case;
}

/**
 * Sets up the test suite with a single test case using the given
 * template.
 *
 * @param template the template object containing all of the tests
 */
function setupTestSuite(template) {
    var test_case = setupTestCase(template);
      testSuite = new yui_instance.Test.Suite("Bond JS Test Suite");
      testSuite.add(test_case);
}

/**
 * Runs the YAHOO.Test.Suite
 */
function runTestSuite() {
    runner = yui_instance.Test.Runner;
    Assert = yui_instance.Assert;

    runner.clear();
    runner.add(testSuite);
    runner.run();
}

/**
 * Used to see if the YAHOO.Test.Runner is still running.  The
 * test results are not available until it is done running.
 */
function isRunning() {
    return runner.isRunning();
}

/**
 * Gets the results from the YAHOO.Test.Runner
 */
function getTestResults() {
    return runner.getResults(yui_instance.Test.Format.JSON);
} 
```

至于 Selenium 方面，我们使用了参数化测试。我们在 Internet Explorer 和 Firefox 的 data 方法中运行我们的测试，将测试结果解析为一个 Object 数组列表，每个数组包含浏览器名称、测试文件名称、测试名称、结果（通过、失败或忽略) 和消息。

实际测试只是断言测试结果。如果它不等于“通过”，那么它会通过从 YUI 测试结果返回的消息使测试失败。

```
@Parameters
public static List<Object[]> data() throws Exception {
    yui_test_codebase = "file:///c://myapppath/yui/tests";

    List<Object[]> testResults = new ArrayList<Object[]>();

    pageNames = new ArrayList<String>();
    pageNames.add("yuiTest1.html");
    pageNames.add("yuiTest2.html");

    testResults.addAll(runJSTestsInBrowser(IE_NOPROXY));
    testResults.addAll(runJSTestsInBrowser(FIREFOX));
    return testResults;
}

/**
 * Creates a Selenium instance for the given browser, and runs each
 * YUI Test page.
 *
 * @param aBrowser
 * @return
 */
private static List<Object[]> runJSTestsInBrowser(Browser aBrowser) {
    String yui_test_codebase = "file:///c://myapppath/yui/tests/";
    String browser_bot = "this.browserbot.getCurrentWindow()"
    List<Object[]> testResults = new ArrayList<Object[]>();
    selenium = new DefaultSelenium(APPLICATION_SERVER, REMOTE_CONTROL_PORT, aBrowser.getCommand(), yui_test_codebase);
    try {
        selenium.start();

        /*
         * Run the test here
         */
        for (String page_name : pageNames) {
            selenium.open(yui_test_codebase + page_name);
            //Wait for the YAHOO instance to be available
            selenium.waitForCondition(browser_bot + ".yui_instance != undefined", "10000");
            selenium.getEval("dom=runYUITestSuite(" + browser_bot + ")");

            // Output from the tests is not available until
            // the YAHOO.Test.Runner is done running the suite
            selenium.waitForCondition("!" + browser_bot + ".isRunning()", "10000");
            String output = selenium.getEval("dom=getYUITestResults(" + browser_bot + ")");

            JSONObject results = JSONObject.fromObject(output);
            JSONObject test_case = results.getJSONObject("jsTestCase");
            JSONArray testCasePropertyNames = test_case.names();
            Iterator itr = testCasePropertyNames.iterator();

            /*
             * From the output, build an array with the following:
             *     Test file
             *     Test name
             *     status (result)
             *     message
             */
            while(itr.hasNext()) {
                String name = (String)itr.next();
                if(name.startsWith("test")) {
                    JSONObject testResult = test_case.getJSONObject(name);
                    String test_name = testResult.getString("name");
                    String test_result = testResult.getString("result");
                    String test_message = testResult.getString("message");
                    Object[] testResultObject = {aBrowser.getCommand(), page_name, test_name, test_result, test_message};
                    testResults.add(testResultObject);
                }
            }
        }
    } finally {
        // If an exception is thrown, this will guarantee that the selenium instance
        // is shut down properly
        selenium.stop();
        selenium = null;
    }
    return testResults;
}

/**
 * Inspects each test result and fails if the testResult was not "pass"
 */
@Test
public void inspectTestResults() {
    if(!this.testResult.equalsIgnoreCase("pass")) {
        fail(String.format(MESSAGE_FORMAT, this.browser, this.pageName, this.testName, this.message));
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-12-01T10:42:50.343

有一个新项目可让您在 Java 环境（如 Ant）中运行[QUnit](http://docs.jquery.com/Qunit)测试，因此您可以将客户端测试套件与其他单元测试完全集成。

[http://qunit-test-runner.googlecode.com](http://qunit-test-runner.googlecode.com)

我用它对 jQuery 插件、[objx](http://objx.googlecode.com)代码、自定义 OO JavaScript 进行了单元测试，它无需修改即可适用于所有内容。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-01-16T11:03:42.697

我正在处理的项目使用[Js-Test-Driver](http://code.google.com/p/js-test-driver/)在 Chrome 10 上托管[Jasmine和](http://pivotal.github.com/jasmine/)[Jasmine-JSTD-Adapter](https://github.com/ibolmo/jasmine-jstd-adapter)，包括使用JS-Test-Driver 中包含的[代码覆盖率测试。](http://code.google.com/p/js-test-driver/wiki/CodeCoverage)

虽然每次我们在[CI 环境](http://en.wikipedia.org/wiki/Continuous_integration)中更改或更新浏览器时都会出现一些问题，但 Jasmine 测试运行得非常顺利，只有异步测试的小问题，但据我所知，这些可以使用 Jasmine Clock 解决，但我还没有机会修补它们。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-03-27T09:07:58.507

我发布[了一个小库](https://github.com/liammclennan/browsertest)，用于验证依赖于浏览器的 JavaScript 测试，而无需使用浏览器。它是一个 Node.js 模块，它使用zombie.js 加载测试页面并检查结果。[我已经在我的博客上](http://hackingon.net/post/Testing-Browser-dependent-JavaScript.aspx)写过它。这是自动化的样子：

```
var browsertest = require('../browsertest.js').browsertest;

describe('browser tests', function () {

    it('should properly report the result of a mocha test page', function (done) {
        browsertest({
            url: "file:///home/liam/work/browser-js-testing/tests.html",
            callback: function() {
                done();
            }
        });
    });

}); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-03-18T08:03:09.130

我查看了您的问题日期，当时有一些很好的 JavaScript 测试库和框架。

今天，您可以找到更多不同的焦点，例如[TDD](https://en.wikipedia.org/wiki/Test-driven_development)、[BDD](https://en.wikipedia.org/wiki/Behavior-driven_development)、Assetion 以及有/无跑步者支持。

这个游戏有*很多*玩家，像[Mocha](https://en.wikipedia.org/wiki/Mocha_(JavaScript_framework))，[Chai](https://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#JavaScript)，[QUnit](https://code.jquery.com/qunit/)，[Jasmine](https://en.wikipedia.org/wiki/Jasmine_(JavaScript_testing_framework))等......

您可以在[此](http://catjs.blogspot.co.il/)博客中找到有关 JavaScript、移动和 Web 测试的更多信息...

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T20:30:14.307

另一个可以与 Ant 一起运行的 JavaScript 测试框架是[CrossCheck](https://dev.thefrontside.net/crosscheck)。在项目的构建文件中有一个通过 Ant 运行 CrossCheck 的示例。

CrossCheck 尝试模拟浏览器，但成功有限，包括[XMLHttpRequest](https://en.wikipedia.org/wiki/XMLHttpRequest)和超时/间隔的模拟样式实现。

不过，它目前不处理从网页加载 JavaScript。您必须指定要加载和测试的 JavaScript 文件。如果您将所有 JavaScript 代码与 HTML 分开，它可能对您有用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-06-05T19:34:09.587

我编写了一个 Ant 任务，它使用[PhantomJS](http://phantomjs.org/)（一个无头[WebKit](https://en.wikipedia.org/wiki/WebKit)浏览器）在 Ant 构建过程中运行 QUnit HTML 测试文件。如果任何测试失败，它也可能导致构建失败。

[https://github.com/philmander/ant-jstestrunner](https://github.com/philmander/ant-jstestrunner)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-07-11T15:17:49.323

这是对几个测试工具的一个很好的评价。

[用于 TDD 的 JavaScript 单元测试工具](https://stackoverflow.com/questions/300855/looking-for-a-better-javascript-unit-test-tool)

我个人更喜欢 [https://code.google.com/p/js-test-driver/](https://code.google.com/p/js-test-driver/)

# javascript - 使用 TDD 原则在 JavaScript 中开发 UI

> ID：96086
> 
> 赞同：44
> 
> 时间：2008-09-18T19:33:09.950
> 
> 标签：javascript, user-interface, tdd

在用 JavaScript 开发 UI 时，我很难找到正确遵循 TDD 原则的最佳方法。解决这个问题的最佳方法是什么？

是否最好将视觉与功能分开？您是否首先开发视觉元素，然后编写测试，然后编写功能代码？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-19T00:54:02.970

我过去用 Javascript 做过一些 TDD，我必须做的是区分单元测试和集成测试。Selenium 将测试您的整个站点，包括服务器的输出、它的回发、ajax 调用等等。但是对于单元测试，这些都不重要。

你想要的只是你将要与之交互的 UI 和你的脚本。您将为此使用的工具基本上是[JsUnit](https://github.com/pivotal/jsunit)，它接受一个 HTML 文档，在页面上有一些 Javascript 函数并在页面的上下文中执行它们。所以你要做的就是在你的函数中包含页面上的 Stubbed out HTML。从那里，您可以测试脚本与模拟 HTML、脚本和测试的隔离单元中的 UI 组件的交互。

这可能有点令人困惑，所以让我们看看我们是否可以做一个小测试。让一些 TDD 假设在加载组件后，元素列表会根据 LI 的内容进行着色。

**测试.html**

```
<html>
<head>
<script src="jsunit.js"></script>
<script src="mootools.js"></script>
<script src="yourcontrol.js"></script>
</head>
<body>
    <ul id="mockList">
        <li>red</li>
        <li>green</li>
    </ul>   
</body>
<script>
    function testListColor() {
        assertNotEqual( $$("#mockList li")[0].getStyle("background-color", "red") );

        var colorInst = new ColorCtrl( "mockList" );

        assertEqual( $$("#mockList li")[0].getStyle("background-color", "red") );
    }
</script>

</html> 
```

显然 TDD 是一个多步骤的过程，因此对于我们的控制，我们需要多个示例。

**yourcontrol.js (step1)**

```
function ColorCtrl( id ) {
 /* Fail! */    
} 
```

**yourcontrol.js (step2)**

```
function ColorCtrl( id ) {
    $$("#mockList li").forEach(function(item, index) {
        item.setStyle("backgrond-color", item.getText());
    });
    /* Success! */
} 
```

您可能会看到这里的痛点，您必须在页面上保持您的模拟 HTML 与您的服务器控件的结构同步。但它确实为您提供了一个很好的使用 JavaScript 进行 TDD 的系统。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T20:35:43.560

我从来没有成功 TDDed UI 代码。我们最接近的确实是将 UI 代码与应用程序逻辑尽可能地分开。这就是模型-视图-控制器模式有用的原因之一——模型和控制器可以在没有太多麻烦和过于复杂的情况下进行 TDD。

根据我的经验，视图总是留给我们的用户接受测试（我们编写 Web 应用程序，我们的 UAT 使用 Java 的 HttpUnit）。然而，在这个级别上，它实际上是一个集成测试，没有我们希望的 TDD 的隔离测试属性。由于这种设置，我们必须先编写控制器/模型测试/代码，然后是 UI 和相应的 UAT。然而，在我最近编写的 Swing GUI 代码中，我一直在编写带有存根的 GUI 代码来探索我的前端设计，然后再添加到控制器/模型/API。不过这里是 YMMV。

因此，重申一下，我能给出的唯一建议是您似乎已经怀疑的内容 - 尽可能将您的 UI 代码与您的逻辑分开并进行 TDD。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-01T10:34:32.813

另请参阅：[用于 TDD 的 JavaScript 单元测试工具](https://stackoverflow.com/questions/300855/looking-for-a-better-unit-test-tool-for-javascript)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T18:27:19.260

我发现[MVP](http://en.wikipedia.org/wiki/Model_View_Presenter)架构非常适合编写可测试的 UI。您的**Presenter**和**Model**类可以简单地进行 100% 单元测试。您只需要担心用于 UI 测试（使用 Selenium 等）的**视图**（它应该是一个愚蠢的、薄层，只会向 Presenter 触发事件）

请注意，我说的是完全在 UI 上下文中使用 MVP，而不必跨越到服务器端。您的 UI 可以有自己的 Presenter 和 Model，它们完全位于客户端。Presenter 驱动 UI 交互/验证等逻辑，而 Model 保留状态信息并提供到后端的门户（您可以在其中拥有单独的模型）。

您还应该看看[Presenter First](http://www.atomicobject.com/pages/Presenter+First) TDD 技术。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T19:49:15.420

这是我切换到 Google Web Toolkit 的主要原因……我使用 Java 进行开发和测试，并且合理地期望编译后的 JavaScript 能够在各种浏览器上正常运行。由于 TDD 主要是一个单元测试功能，所以大部分项目可以在编译和部署之前进行开发和测试。

集成和功能测试套件验证生成的代码在部署到测试服务器后是否按预期运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T20:38:37.750

我正要开始在我正在做的一个新项目上做 Javascript TDD。我目前的计划是使用[qunit](http://docs.jquery.com/QUnit)进行单元测试。在开发测试时，只需在浏览器中刷新测试页面即可运行。

为了持续集成（并确保测试在所有浏览器中运行），我将使用[Selenium](http://selenium.openqa.org/)在每个浏览器中自动加载测试工具，并读取结果。这些测试将在每次签入源代码控制时运行。

我还将使用[JSCoverage](http://siliconforks.com/jscoverage/)来获取测试的代码覆盖率分析。这也将通过 Selenium 实现自动化。

我目前正在设置这个。设置完成后，我将使用更准确的详细信息更新此答案。

* * *

测试工具：

*   [量子单位](http://docs.jquery.com/QUnit)
*   [JS覆盖](http://siliconforks.com/jscoverage/)
*   [硒](http://selenium.openqa.org/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-16T19:57:17.740

我所做的是戳 Dom 看看我是否得到了我所期望的。这样做的一个很好的副作用是，在加快测试速度的同时，您也可以使您的应用程序快速运行。

我刚刚发布了一个开源工具包，它将极大地帮助 JavaScript tdd。它是许多开源工具的组合，它为您提供了一个开箱即用的 requirejs 主干应用程序。

它提供单个命令来运行：dev web server、jasmine 单浏览器测试运行器、jasmine js-test-driver 多浏览器测试运行器，以及 JavaScript 和 CSS 的连接/缩小。它还输出应用程序的未缩小版本以进行生产调试，预编译您的车把模板，并支持国际化。

无需设置。它只是工作。

[http://github.com/davidjnelson/agilejs](http://github.com/davidjnelson/agilejs)

# ffmpeg - ffmpeg av 库可以返回准确的 PTS 吗？

> ID：96107
> 
> 赞同：8
> 
> 时间：2008-09-18T19:35:56.260
> 
> 标签：ffmpeg, dts, mpeg, pts

我正在使用一个使用 IBBP... GOP 序列的 mpeg 流。前 4 个 AVPackets 返回的`(DTS,PTS)`值如下：`I=(0,3) B=(1,1) B=(2,2) P=(3,6)`

I 帧上的 PTS 看起来是合法的，但 B 帧上的 PTS 不可能正确，因为 B 帧不应显示在 I 帧之前，如其 PTS 值所示。我还尝试解码数据包并在生成的 AVFrame 中使用 pts 值，将 PTS 始终设置为零。

有什么方法可以从 ffmpeg 中获得准确的 PTS 吗？如果没有，那么同步音频的最佳方式是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-19T19:39:45.907

[我想我终于根据http://www.dranger.com/ffmpeg/tutorial05.html](http://www.dranger.com/ffmpeg/tutorial05.html)中的评论弄清楚了发生了什么：

> ffmpeg 对数据包重新排序，以便 avcodec_decode_video() 处理的数据包的 DTS 将*始终*与其返回的帧的 PTS相同

翻译：如果我向 avcodec_decode_video() 提供一个 PTS 为 12 的数据包，avcodec_decode_video() 将不会返回该数据包中包含的解码帧，直到我向它提供一个 DTS 为 12 的*后续*数据包。如果数据包的 PTS 是与它的 DTS 相同，则给定的数据包与返回的帧相同。如果数据包的 PTS 比其 DTS 晚 2 帧，则 avcodec_decode_video() 将延迟该帧并且在我再提供 2 个数据包之前不会返回它。

基于这种行为，我猜测 av_read_frame() 可能正在将数据包从 IPBB 重新排序到 IBBP，因此 avcodec_decode_video() 只需将 P 帧缓冲 3 帧而不是 5 帧。例如，输入和具有此排序的 P 帧的输出为 3 (6 - 3)：

```
|                  I B B P B B P
|             DTS: 0 1 2 3 4 5 6
| decode() result:       I B B P 
```

与标准排序 (6 - 1) 的差异为 5：

```
|                  I P B B P B B
|             DTS: 0 1 2 3 4 5 6
| decode() result:       I B B P 
```

<shrug/> 但这纯粹是猜想。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T21:03:16.583

好的，划掉我之前困惑的回复。

对于 IBBPBBI 电影，您希望 PTS 看起来像这样（按解码顺序）

```
0, 3, 1, 2, 6, 4, 5, ... 
```

对应于帧

```
I, P, B, B, I, B, B, ... 
```

因此，您似乎在序列开始时缺少一个 I，但时间戳看起来是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-20T15:23:04.517

我相当肯定你得到了准确的值。如果您将 MPEG 流视为流，它可能会有所帮助。在这种情况下，在您看到的 IBBPBB 之前，通常会有另一个 GOP。也许是这样的（使用与原始问题相同的符号）：

```
P(-3,-2)  B(-2,-1)  B(-1,0) 
```

基本上，I 帧之后的 B 帧是基于**前一个**GOP 的 I 帧和最后一个 P 帧。

虽然视频从这个开始是合乎逻辑的：

```
Start GOP: IPBBPBBPBB... 
```

以后应该是

```
Start GOP: IBBPBBPBBPBB
Start GOP: IBBPBBPBBPBB
Start GOP: IBB... 
```

请记住，解码任何 B 帧都需要它之前和之后的完整帧。因此，每对 B 帧都应显示在文件中的 I 或 P 帧之前。

FFMPEG 可能刚刚放弃了第一个 GOP 的“特殊情况”。

由于前两个 B 帧没有要操作的先前帧，因此您应该能够安全地丢弃它们。只需将您的时间戳从第一个 I 帧重新设置为基准，然后将音频流调整为相同的量。

这是否真的会导致帧丢失将取决于 FFMPEG 的实现，但更糟糕的情况是您丢失 83 毫秒（2 帧，24 帧/秒）。

# linux - 像 ping、ssh 这样的 Unix 命令可以正常工作，但基于套接字的程序无法连接

> ID：96113
> 
> 赞同：1
> 
> 时间：2008-09-18T19:36:43.123
> 
> 标签：linux, sockets, suse

我接到一个测试员的电话，说一台机器出现了我们的软件故障。当我检查问题机器时，我很快意识到问题是相当低级的：入站网络流量工作正常。像 ping 和 ssh 这样的基本出站命令工作正常，但任何涉及`connect()`调用的操作都因“没有路由到主机”而失败。

例如 - 在**这台特定的机器**`connect()`上，该程序将在以下任何 IP 地址的语句上失败`127.0.0.1`：

```
#!/usr/bin/perl -w
use strict;
use Socket;
my ($remote,$port, $iaddr, $paddr, $proto, $line);

$remote  = shift || 'localhost';
$port    = shift || 2345;  # random port
if ($port =~ /\D/) { $port = getservbyname($port, 'tcp') }
die "No port" unless $port;
$iaddr   = inet_aton($remote)           || die "no host: $remote";
$paddr   = sockaddr_in($port, $iaddr);

$proto   = getprotobyname('tcp');
socket(SOCK, PF_INET, SOCK_STREAM, $proto)      || die "socket: $!";
connect(SOCK, $paddr)    || die "connect: $!"; 
while (defined($line = <SOCK>)) {
    print $line;
}

close (SOCK)        || die "close: $!";
exit; 
```

关于这台机器坏在哪里的任何建议？它正在运行 SUSE-10.2。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T19:43:09.503

我会检查那台机器上的防火墙配置。iptables（我猜你的 SUSE 有 iptables 防火墙）可以设置为只允许 ping ICMP 数据包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T19:42:40.787

防火墙是否关闭？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T20:08:46.340

防火墙总是可以的，但它确实说 ssh 可以连接，所以这似乎不太可能。我想说看看路由（Linux 上的“路由”命令），并确保你没有两条默认路由，或者奇怪的路由或其他任何东西。总而言之，我会说在同一个远程 IP 上测试 ping 和 ssh 以及您的程序，如果它们都失败了，那么您就有了路由问题。如果只有您的程序失败，您可能有防火墙问题或程序问题 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T20:38:35.940

尝试将 connect() 指向 SSH 命令起作用的同一主机：端口。此外，请记住，某些防火墙可以为不同的用户帐户应用不同的规则（有时也适用于不同的可执行文件）。因此，请确保您在同一用户帐户下运行 ssh 和您的测试应用程序，并且没有为 SSH 设置 SUID。

# testing - Rational Functional Tester 等待对象存在

> ID：96114
> 
> 赞同：4
> 
> 时间：2008-09-18T19:36:45.153
> 
> 标签：testing, rft

我目前正在 Rational Functional Tester 中修改 Java 脚本，并且试图告诉 RFT 等待具有指定属性集的对象出现。具体来说，我想等到出现 X 行数的表。到目前为止，我能够做到的唯一方法是添加一个验证点，仅验证表有 X 行，但我无法利用 VP 的等待对象类型，所以这似乎是有点hacky。有一个更好的方法吗？

杰夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-02T22:06:29.587

不，没有内置的 waitForProperty() 类型的方法，所以你不能做一些简单的事情，比如 tableObject.waitForProperty("rowCount", x);

您的选择是使用您已经在做的验证点（如果它没有损坏...）或使用 do/while 循环和 find() 方法滚动您自己的同步点。

下面的`find()`代码示例假定这`doc`是一个 html 文档。将此调整为您的父 java 窗口。

```
TestObject[] tables = doc.find(atDescendant(".rowCount", x), false); 
```

如果您不熟悉`find()`，请在帮助菜单中的 RFT API 参考中进行搜索。 `find()`将是您在 RFT 脚本中最好的朋友。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-02T05:01:54.597

您可以使用：

```
getobject.gettext(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T07:16:17.377

您可以做一件事....您可以尝试获取特定属性并检查您是否获得了所需的值。如果不是，则在 IF 循环中迭代。

```
while (!flag) {
  if (obj.getproperty(".text").equals("Desired Text")) {
    flag = true
  }
} 
```

# vb.net - 从 Windows VB 应用程序打开没有工具栏或地址栏的 IE

> ID：96123
> 
> 赞同：0
> 
> 时间：2008-09-18T19:38:10.127
> 
> 标签：vb.net, browser, popup

```
Shell ("explorer.exe www.google.com") 
```

是我目前在成功安装后打开我的产品广告页面的方式。但是，我认为如果我能像 Avira 那样做，甚至是没有地址栏链接等的弹出窗口，它看起来会更好。通过浏览器链接做到这一点很容易

```
<a href="http://page.com"
onClick="javascript:window.open('http://page.com','windows','width=650,height=350,toolbar=no,menubar=no,scrollbars=yes,resizable=yes,location=no,directories=no,status=no');    return false")">Link text</a> 
```

但是我将如何在 VB 中添加这个功能呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T19:50:08.753

如果你想让它看起来很专业，你需要使用一个实际的浏览器组件。VB.NET 自带一个。如果您使用的是旧版本的 VB，则需要使用第三方。如果您想保持外壳打开，则必须单独定位浏览器[命令行并传递参数](http://blogs.msdn.com/petel/archive/2007/01/19/internet-explorer-7-command-line-arguments.aspx>)以指示它不应该有工具栏等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T19:58:58.953

作为用户，我发现阉割的弹出窗口很烦人而且效率低下。

所以我的回答是：“不要”。

# linux - REDUX：如何克服 Linux 上的 ksh 与 AIX/Solaris/HPUX 上安装的 ksh 之间的不兼容问题？

> ID：96133
> 
> 赞同：2
> 
> 时间：2008-09-18T19:39:45.533
> 
> 标签：linux, solaris, ksh, aix, hp-ux

在我们将数百个 ksh 脚本从 AIX、Solaris 和 HPUX 移植到 Linux 的过程中，我发现了另一个问题。请参阅[此处](https://stackoverflow.com/questions/74372/how-to-overcome-an-incompatibility-between-the-ksh-on-linux-vs-that-installed-o)了解上一个问题。

这段代码：

```
#!/bin/ksh
if [ -a k* ]; then
    echo "Oh yeah!"
else
    echo "No way!"
fi
exit 0 
```

（当在包含多个名称以 k 开头的文件的目录中运行时）会产生“哦，是的！” 当使用 AT&T ksh 变体（ksh88 和 ksh93）调用时。另一方面，它会产生错误消息，然后是“没办法！” 在其他 ksh 变体（pdksh、MKS ksh 和 bash）上。

同样，我的问题是：

*   是否有环境变量会导致 pdksh 表现得像 ksh93？做不到这一点：
*   pdksh 上是否有获得所需行为的选项？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-23T16:19:17.083

我不会再在 Linux 上使用 pdksh 了。由于 AT&T ksh 已成为开源，因此各种 Linux 发行版都提供了软件包。例如，RedHat Enterprise Linux 和 CentOS 包含 ksh93 作为“ksh”RPM 软件包。

pdksh 仍然在软件供应商的许多安装要求文档中被提及。我们用 ksh93 替换了我们所有 Linux 系统上的 pdksh，到目前为止没有任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T20:55:17.070

您确实意识到 [ 是 的别名（通常是链接，符号或硬链接）`/usr/bin/test`，对吗？所以也许实际的问题是不同版本的`/usr/bin/test`?

OTOH，ksh 用内置函数覆盖它。也许有办法让它不这样做？`/usr/bin/test`或者，如果`/usr/bin/test`在所有平台上都兼容，也许您可​​以明确地将 [ 别名为 ？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-17T14:49:42.577

一年后，我的问题似乎没有解决方案。

我添加这个答案是为了说我将不得不忍受它......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-26T06:58:58.763

在 Bash 中， test -a 操作针对单个文件。

我猜在 Ksh88 中 test -a 操作是针对单个文件的，但不会抱怨，因为其他测试词是 -a 的未指定条件。

你想要类似的东西

```
for K in /etc/rc2.d/K* ; do test -a $K && echo heck-yea ; done 
```

我可以说 ksh93 在这方面就像 bash 一样工作。遗憾的是，我认为代码写得不好，我认为这可能是一个不好的意见，因为问题的根本原因是 ksh88 内置测试允许草率的代码。

# html - DIVs vs. TABLEs 请反驳

> ID：96137
> 
> 赞同：2
> 
> 时间：2008-09-18T19:40:40.540
> 
> 标签：html, css, semantics

有很多人问“为什么我们不应该使用表格来构建我们的 HTML”，虽然有很多答案出现，但我很少看到有人被转换到语义世界。也就是说，我还没有看到任何令人信服的反驳来支持我们为什么应该（或可能）使用表格的理由。

有人愿意为表格何时是有效的结构标记提供理由吗？

* * *

2008 年 11 月 7 日

考虑到这个问题并没有像我想象的那样消失，我想我最好澄清我的问题并解释它的存在。

在“DIVs vs. TABLEs”问题之后多次阅读“表格更容易”的论点感到沮丧，我想更多地揭示这个问题，而不是让表格爱好者这么容易摆脱困境。

每个人都会对他们自己的其他人说，但我永远被赋予了一些应用程序来放置在我们的网站上，这些应用程序是由一些“表格更容易”的开发人员创建的，他们将一大块糟糕的 HTML 转储到我的页面中，老实说，我我只是没有看到足够多的餐桌爱好者倾听这些争论。

以前有人用过曼波吗？任何人都必须在微软的 Sharepoint 上进行设计吗？必须通过所有嵌套的表格垃圾来争取自己的方式是地狱，并且考虑到它是由一些该死的优秀编码人员编写的，这让我很恼火。合理的语义标记已经存在了很长时间，以至于开发人员没有理由仍然拥护“表格更容易”。桌子并不容易 - 他们很懒惰！

我的问题应该以消极的方式呈现，但我仍在等待人们接受他们使用表格的唯一原因是因为他们不知道 HTML。因为如果他们这样做了，那么他们就会明白，正如 jjrv 所说，表格是用于表格数据的。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-18T19:43:55.027

当您有数据表时，表是有效的。我见过交互式网格小部件，它们不遗余力地使用一堆 div 来避免可怕的表格标签。当它是表格数据时，将其设为表格。

我的一个比较有争议的观点是，当你在处理 CSS 中的垂直布局问题时遇到问题，你可以只使用一个表格，并且通常会立即解决它。将内容与演示混合起来可能没有它应该的那么漂亮，但它可以完成工作并避免使用 CSS hack 绕过 IE。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-06T15:25:16.220

RE: 为什么是桌子？

因为有些人（经过这么多年仍然）害怕改变。他们听说使用语义 HTML 是一件好事（而且通常不会完全掌握这个概念）。因此，他们尝试使用以前从未做过的 CSS 组合布局。他们遇到了一些（有据可查，通常很容易解决）的问题，举起手，然后跑回桌子。

然后他们认为 CSS“太耗时”（“我不愿意花时间去学习它”）或“不实用”（“我不明白。这太难了”）并且表格是唯一真正的方式。通过固执和无知，他们相信自己的胡说八道，并说服他们的客户和同行。

他们的世界依然快乐，不变，逐渐消失在过去，更深地进入过时*

这就是“为什么要使用表格”。结束。

（*除了它们非常适合编码 HTML 电子邮件）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-29T17:26:46.323

表格适用于那些不想花*几个小时*用 CSS 来让两个相邻的列式 div 扩展到 100% 的高度和宽度而不考虑内容的开发人员，然后让*黑客*在所有浏览器中工作而无需添加额外的 div 包装器和然后最后在*绝对*沮丧中，他们求助于 5 秒修复：

```
<table width="100%">
<tr><td valign="top">Left nav</td><td valign="top">Main content</td></tr>
</table> 
```

一个残酷的事实是，大多数用户（不包括那些使用屏幕阅读器的用户）真的不在乎页面是如何标记的，只要它加载得很快。

开发人员有预算和时间限制，“好”的 CSS 和标记需要时间。

网上有大量资源详细解释了如何排列两个 div 来替换那个简单的表格，这一事实非常清楚地告诉我，这种设计本质上与表格一样有缺陷。需要多少教程来解释如何[将具有两列的表格添加到页面](http://www.w3schools.com/html/html_tables.asp)？

HTML5 应该通过新的页眉、页脚、部分、导航和旁边标签给我们带来一些理智。取自 Nettuts+ 的[示例：](http://net.tutsplus.com/tutorials/html-css-techniques/html-5-and-css-3-the-techniques-youll-soon-be-using/)

```
<div id="content">
    <div id="mainContent">
        <section>
            <!-- Blog post -->
        </section>
        <section id="comments">
            <!-- Comments -->
        </section>
        <form>
            <!-- Comment form -->
        </form>
    </div>
    <aside>
        <!-- Sidebar -->
    </aside>
</div> 
```

然后是CSS：

```
#content {
    display: table;
}

    #mainContent {
        display: table-cell;
        width: 620px;
        padding-right: 22px;
    }

    aside {
        display: table-cell;
        width: 300px;
    } 
```

当您注意到 CSS 具有以下属性时，那些目光敏锐的人会喜欢这种讽刺的感觉：`display: table;`和`display: table-cell;`.

**表回来了宝贝！通过 HTML5 后门潜入；-)**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T23:18:02.437

基于 DIV 的布局受到限制。如果没有表格，基本上[不可能](https://stackoverflow.com/questions/35699/on-a-two-column-page-how-can-i-grow-the-left-div-to-the-same-height-of-the-righ)实现基于内容高度适当增长的两列布局。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T19:48:27.027

当您添加功能或修复错误或更改数据驱动网站的外观时，使用现代语义标记要容易得多。添加 AJAX 功能或任何类型的交互式脚本对 DIV 和 CSS 的效果要比使用 TABLE 好得多。

如果您也已经使用语义标记进行组织，那么迁移到 Drupal、Joomla、WordPress 等内容管理器会容易得多。

较新的浏览器版本还将更有效地支持现代标记，并且您的网站将显示得更快。重新排列所有这些表格可能会导致显示时间变慢。

另一方面，桌子会留在这里。有些人将继续使用它们，浏览器将继续显示它们。如果这是您想要的，那么非语义标记本身就没有错。一个永远不会改变的完全静态的站点可以与现代标记一样运行表格。

至于有效的结构标记，有这样的：表格是显示表格数据的好方法，如数据库或电子表格表格。它们对于其他任何东西都不是真正有效的标记。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T12:12:45.983

An interesting note is related to highly complex JavaScript applications. If you pick apart Gmail or Google Calendar with Firebug, you'll see that tables are used extensively, even for layout. Granted, these are usually dynamically generated but this goes to show that in rare cases some very visually complex interactive user interfaces are extremely difficult to build using only DIVs.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T19:45:02.450

即使在硬壳的旧 HTML v1.0 浏览器中也支持表格。如果您的目标市场包括 1990 年代在手机中使用嵌入式浏览器的人，那么这可能是使用表格的一个很好的理由。

许多现有的自动生成的 HTML 使用表格。如果您的代码需要与这些表交互或包含这些表，则最好保持一致性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T21:34:37.053

将表格用于最小公分母 html 或用于跨列或跨行有意义的表格数据。否则，一旦你掌握了它的窍门，css 布局就不会那么冗长并且更容易维护。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T21:32:26.433

我会说 jjrv 是正确的，因为表格非常适合表格数据，不遗余力地让某些东西像表格一样“工作”，而不是仅仅使用表格是边缘延迟的。

如果您关心标准，并朝着跨所有浏览器的可靠实现迈进，那么您的大部分标记应该在无表格的液体布局中......并且您的表格数据在......你猜对了表格！

如果您需要迎合真正旧的浏览器，即在可怕的 ie6 之前，那么您将在 css 中遇到很多问题，并且鉴于当前的使用统计数据，可以假设每个人都将拥有一个支持 css 布局的“现代”浏览器。

所有这一切都是这样的，当您在布局上将头撞在墙上并且您想要/确实在桌子上通过它说 f___ 它并且它起作用的时候。我希望这是一种已弃用的做法，但总的来说，这确实会产生可预测的结果。

# c# - OLEDBConnection.Open() 生成“未指定错误”

> ID：96150
> 
> 赞同：3
> 
> 时间：2008-09-18T19:41:55.123
> 
> 标签：c#, debugging, connection-string, xls, oledbconnection

我有一个应用程序将 Excel .xls 文件上传到文件系统，使用对象实例上的 .open() 方法使用 oledbconnection 对象打开文件，然后将数据存储在数据库中。**将文件上传和写入文件系统工作正常，但仅**在我们的生产服务器上尝试打开文件时出现错误。该应用程序在另外两台服务器（开发和测试服务器）上运行良好。

以下代码在 Exception.Message 中生成“未指定错误”。

**引用：**

```
 System.Data.OleDb.OleDbConnection x = new System.Data.OleDb.OleDbConnection(@"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + location + ";Extended Properties='Excel 8.0;HDR=Yes;IMEX=1'");
        try
        {
            x.Open();
        }
        catch (Exception exp)
        {
            string errorEmailBody = " OpenExcelSpreadSheet() in Utilities.cs.  " + exp.Message;
            Utilities.SendErrorEmail(errorEmailBody);
        } 
```

**:结束报价**

服务器的 c:\\temp 和 c:\Documents and Settings\\aspnet\local settings\temp 文件夹都赋予 \aspnet 完全控制权。

我认为存在某种权限问题，但似乎无法找到上述文件夹的权限与上传 Excel 文件的文件夹/目录之间的任何区别。相同的位置用于保存文件并打开它，这些方法在我的工作站和两个 Web 服务器上运行。Windows 2000 SP4 服务器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-30T23:11:13.480

虽然权限问题可能更常见，但您也可以从 Windows 文件系统/Access Jet DB Engine 连接限制中遇到此错误，我认为是 64/255。如果你破坏了 255 Access 读/写并发连接或每个进程的 64(?) 连接限制，你会得到这个完全相同的错误。至少我在一个应用程序中遇到过这种情况，该应用程序不断创建连接并且从未正确关闭。一个简单的`Conn.close();`下降，生活是美好的。我想 Excel 可能会有类似的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-07T16:43:33.453

如果您使用模拟，则需要向模拟用户授予权限，而不是/除了 aspnet 用户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-01T00:08:13.780

尝试将位置用单引号括起来

```
System.Data.OleDb.OleDbConnection x = new System.Data.OleDb.OleDbConnection(@"Provider=Microsoft.Jet.OLEDB.4.0;Data Source='" + location + "';Extended Properties='Excel 8.0;HDR=Yes;IMEX=1'"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T19:43:57.507

内部异常中有什么？这是 64 位应用程序吗？OLEDB 提供程序不适用于 64 位。您必须让您的应用程序以 x86 为目标。尝试在我的 64 位计算机上打开访问数据库时遇到错误时发现此问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T20:13:28.933

我在权限问题上遇到了这个错误，但看起来你已经涵盖了。我还看到它带有连接字符串中的一个标志——你可能会玩一下。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T20:16:27.507

是的。我也这样做了。取出 IMEX=1，取出扩展属性等。我设法在开发和测试服务器上破解它。:) 我一次把它们放回去，直到它被固定在 dev 上并再次测试，但仍然没有在 prod 上工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-03-05T09:42:00.523

不确定这是否是您面临的问题，
但是，在处理连接之前，您应该执行 Connection.Close()，
因为 Connection.Dispose() 命令是从 Component 继承的，并且不会正确处理某些连接资源。
未正确处理连接可能会导致访问问题。

# asp.net - 如何以编程方式单击 ASP.NET 网页上的按钮？

> ID：96153
> 
> 赞同：7
> 
> 时间：2008-09-18T19:42:14.513
> 
> 标签：asp.net

我试图弄清楚如何以编程方式单击网页上的按钮。

具体来说，我有一个带有 WebBrowser 控件的 WinForm。一旦它导航到我正在尝试使用的目标 ASP.NET 登录页面，在 DocumentCompleted 事件处理程序中我有以下编码：

```
HtmlDocument doc = webBrowser1.Document;

HtmlElement userID = doc.GetElementById("userIDTextBox");
userID.InnerText = "user1";

HtmlElement password = doc.GetElementById("userPasswordTextBox");
password.InnerText = "password";

HtmlElement button = doc.GetElementById("logonButton");
button.RaiseEvent("onclick"); 
```

这很好地填充了用户名和密码文本框，但我没有成功让那个该死的按钮点击；我也试过“click”、“Click”和“onClick”——还有什么？搜索 msdn 当然没有给我任何线索，groups.google.com 也没有。我必须靠近。或者也许不是——有人告诉我我应该调用页面的 POST 方法，但是如何做到这一点并不是给出的建议的一部分。

顺便说一句，按钮编码：

```
<input type="submit" name="logonButton" value="Login" onclick="if (typeof(Page_ClientValidate) == 'function') Page_ClientValidate(); " language="javascript" id="logonButton" tabindex="4" /> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-26T16:35:36.187

这是如何运作的？为我工作

```
HtmlDocument doc = webBrowser1.Document;

doc.All["userIDTextBox"].SetAttribute("Value", "user1");
doc.All["userPasswordTextBox"].SetAttribute("Value", "Password!");
doc.All["logonButton"].InvokeMember("Click"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-18T19:44:18.050

var btn = document.getElementById(btnName); 如果 (btn) btn.click();

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T19:44:20.843

这里有一个如何使用 InvokeMember 提交表单的示例。 [http://msdn.microsoft.com/en-us/library/ms171716.aspx](http://msdn.microsoft.com/en-us/library/ms171716.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T19:44:13.963

您可以尝试直接通过客户端脚本调用 Page_ClientValidate() 方法，而不是单击按钮，让我挖掘一个示例。

使用 MSHTML

```
mshtml.IHTMLWindow2 myBroserWindow = (mshtml.IHTMLWindow2)MyWebBrowser.Document.Window.DomWindow;
myBroserWindow.execScript("Page_ClientValidate();", "javascript"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T19:47:59.120

您是否尝试过 fireEvent 而不是 RaiseEvent？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T19:48:03.423

您可以直接调用该方法并传入通用对象和 EventArgs 参数。当然，如果您正在查看特定数据的 sender 和 EventArgs 参数，这可能不起作用。我通常的处理方式是将方法的核心重构为 doSomeAction() 方法，并且按钮单击的事件处理程序将简单地调用此函数。这样我就不必弄清楚如何调用通常只是一个事件处理程序来在页面/表单上执行一些逻辑。

在 javascript 单击表单发布按钮的情况下，您可以在客户端脚本中调用 form.submit() - 这将运行您在标记中定义的任何验证脚本 - 然后解析 Form_Load 事件并获取该表单上提交按钮的文本值（假设只有一个） - 至少这是我非常熟悉的 ASP.NET 1.1 方式......有人知道 2.0+ 更优雅的东西吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-19T12:50:33.607

在提交按钮未指定 ID 的情况下，这只是一个可能有用的额外功能 - 通常是这种情况。

```
 private HtmlElement GetInputElement(string name, HtmlDocument doc) {
            HtmlElementCollection elems = doc.GetElementsByTagName("input");

            foreach (HtmlElement elem in elems)
            {
                String nameStr = elem.GetAttribute("value");
                if (!String.IsNullOrEmpty (nameStr) && nameStr.Equals (name))
                {
                    return elem;
                }
            }
            return null;
    } 
```

所以你可以这样称呼它：

```
 GetInputElement("Login", webBrowser1.Document).InvokeMember("Click"); 
```

如果提交输入的值为“登录”，它将引发异常，但如果您想在调用点击之前有条件地检查，您可以将其分解。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-26T16:21:22.680

您在@Phunchak 的回答中发表了不想使用客户端脚本的评论。我认为你想要做的事情是不可能的。与表单交互的唯一方法是通过客户端脚本。C# 代码只能控制在页面发送到浏览器之前发生的情况。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-09T23:13:31.327

试试这个 button.focus System.Windows.Forms.SendKeys.Send("{ENTER}")

# iphone - iPhone 视频中的章节

> ID：96156
> 
> 赞同：3
> 
> 时间：2008-09-18T19:42:31.487
> 
> 标签：iphone, video

是否可以在应用程序中使用 iPhone 视频中的章节？

例如：我有一个 3 分钟的视频要播放。我的第 1 章从 0 岁开始，第 2 章从 50 岁开始，第 3 章从 95 岁开始。

我可以在 50 秒（第 2 章）开始播放视频直到结束吗？我可以让它只播放从 50 到 95 的第 2 章吗？

我的问题不是关于如何在视频中添加章节。我想知道这种行为在 iphone 上是否可用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-30T00:07:29.383

iPhone SDK 3.0+ 有一个新的 MPMoviePlayerController.initialPlaybackTime 属性，用于设置开始播放电影的时间。这将“四舍五入”到最接近的较早关键帧时间，因此不提供精确的开始定位，但非常接近。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-19T15:23:50.220

player.currentPlaybackTime = 时间；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T09:01:08.410

这绝对有可能将未记录的消息**setCurrentTime**发送到 MPMoviePlayerController。它接受一个 double 类型的参数，以秒为单位指定播放位置。在下面找到一个简短的示例：

扩展 MPMoviePlayerController 以避免编译器警告：

```
@interface MPMoviePlayerController (extended)
-(void)setCurrentTime:(double)seconds;
@end 
```

然后，您可以在任何需要的地方调用它——在开始之前或在播放期间。

```
MPMoviePlayerController* player = [[ MPMoviePlayerController alloc] initWithContentURL:url ];
[ player setCurrentTime:95.0 ];
[ player play ]; 
```

# cookies - Web Dev - 在哪里存储类似购物车的对象的状态？

> ID：96160
> 
> 赞同：16
> 
> 时间：2008-09-18T19:42:50.893
> 
> 标签：cookies, state

您正在构建一个 Web 应用程序。您需要在用户会话期间存储*类似购物车的对象的状态。*

一些注意事项：

*   这不完全是购物车，而更像是用户正在构建的行程......但我们现在将使用购物车这个词，b/c ppl 与之相关。
*   您不关心“废弃”的购物车
*   购物车完成后，我们会将其保存到一些服务器端数据存储中以供以后检索。

**你在哪里**存储有状态的对象？又**如何**？

*   服务器（会话、数据库等？）
*   客户端（cookie key-vals、cookie JSON 对象、隐藏的表单域等？）
*   其他...

**更新**：有人建议我列出我们的目标平台——虽然我不确定它是否完全必要……但可以说前端是使用 ASP.NET MVC 构建的。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-18T22:00:12.297

根据我对 Commerce Starter Kit 和 MVC Storefront（以及我建立的其他网站）的经验，无论您现在怎么想，关于用户与您的“产品”交互的信息对于业务人员来说都是最重要的。有太多的指标需要捕捉——这太疯狂了。

我会为您保存我经历过的所有内容 - 到目前为止，对我来说最成功的只是创建一个具有“NotCheckedOut”状态的 Order 对象，然后向其中添加项目并且用户添加项目。这使用户可以拥有多个购物车，并允许您从 Orders 表中挖掘焦油。交易订单也很容易 - 只需更改状态即可。

坚持“随用随走”还允许用户在由于某种原因无法完成购物车的情况下返回并完成购物车。电子商务的宽恕是巨大的。

Cookies 很糟糕，会话很糟糕，Profile 与用户的概念相关联，它会影响 DB，因此您不妨使用 DB。

你可能*认为*你不想这样做——但你需要*相信*我，并且知道你以后确实需要向统计专家提供一些数据。我答应你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T20:13:57.777

我已经考虑过您的建议，但还没有客户项目可以尝试。最接近的实际上是您可以在此处找到的购物清单...

[http://www.scottcommonsense.com/toolbox.aspx](http://www.scottcommonsense.com/toolbox.aspx)

单击杂货清单以打开窗口。它确实使用 ASPX，但仅用于管理放置在页面上的 JS 引用。其余的通过 AJAX 使用 Web 服务完成。

以前，我为一个自动使用匿名/身份验证 cookie 的商业站点构建了一个 ASP.NET 2.0 站点。每个都为您提供了一个 GUID 值，您可以使用该值来识别用户，然后将其与数据库中的数据相关联。我想要 auth cookie，以便用户可以移动到不同的计算机；工作、家庭等。我避免使用 Profile 字段来保存复杂的 ShoppingBasket 对象，该对象在所有 ASP.NET 2.0 书籍中都很流行。我不想处理“神奇”的序列化问题，因为数据结构会随着时间而改变。我更喜欢使用与软件更改同步的更新/更改脚本来管理数据库架构更改。

使用匿名/身份验证 cookie 识别客户端上的用户，您可以使用 ASP.NET AJAX 客户端使用作为 ASP.NET 的一部分为您提供的 JS 代理调用身份验证 Web 服务。您需要实现 Membership API 以至少对用户进行身份验证。提供者实现的其余部分可以安全地抛出 NotImplementedException。然后，您可以通过 AJAX 使用您自己的自定义 ASMX Web 服务（请参阅 ScriptReference 属性）并使用服务器端数据更新页面。如果您愿意，您可以完全取消 ASPX 页面，而只使用静态 HTML/CSS/JS。

一大警告是 JS 中的内存泄漏。长时间停留在同一页面上会增加内存泄漏的潜在问题。通过测试长时间会话并使用 Firebug 等工具来查找内存泄漏，您可以将风险降至最低。使用 JS Lint 工具，它可以帮助您随时发现主要问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T19:57:25.867

我倾向于将其存储为会话对象。这是因为您不关心废弃的购物车，因此可以消除将其存储在数据库中的开销，因为这不是必需的（更不用说您还需要某种清理例程来从数据库中删除废弃的购物车）。

但是，如果您希望用户能够持久保存他们的购物车，那么数据库选项会更好。这样，登录的用户将在会话中保存他们的购物车（因此当他们返回站点并登录时，他们的购物车将被恢复）。

您也可以将两者结合使用。来到站点的用户默认使用基于会话的购物车。当他们登录时，所有项目都从基于会话的购物车移动到基于数据库的购物车，并且任何后续购物车活动都直接应用于数据库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T19:44:40.890

在与您用于会话的任何内容（db/memcache 会话、签名的 cookie）或经过身份验证的用户相关联的数据库中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T19:46:00.183

将其存储在数据库中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T19:48:46.997

在不了解平台的情况下，我无法直接给出答案。但是，既然您不关心废弃的推车，那么我会与这里的同事有所不同，并建议将其存储在客户端上。如果您不在乎它是否被遗弃，为什么要将它存储在数据库中？
再说一次，它确实取决于您存储的对象的大小——cookie 毕竟有其局限性。

编辑：啊，asp.net MVC？为什么不使用档案系统？如果您不想让他们登录，您可以启用匿名个人资料

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T19:49:05.823

您是否设想人们需要能够在一台机器（例如他们的工作 PC）上启动但从另一台机器（例如家用 PC）继续/完成？如果是这样，答案是显而易见的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T19:49:27.510

如果您不关心废弃的购物车并且为有人在客户端弄乱数据做好准备......我认为 cookie 会很好 - 特别是如果它只是 JSON 数据的 cookie。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T19:57:59.470

我会在保存用户购物篮 ID 的客户端上使用（加密的）cookie。除非它是一个非常繁忙的站点，否则废弃的购物篮不会*过多*地填满数据库，如果您非常在意，可以运行常规管理任务来清除废弃的订单。同样这样做，如果用户关闭浏览器并离开，用户将保留他们的订单，此时会话中的购物篮将被清除..

最后，这意味着您不必担心编写代码来处理来自客户端 cookie 的数据的反序列化，同时担心在将数据转换为订单时将其实际放入数据库（太多我喜欢的失败点）..

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T20:11:46.893

我会说将状态存储在服务器上的某个位置并将其与用户的会话相关联。虽然 cookie 表面上可能是存储东西的平等地方，但如果您考虑安全性和数据大小，那么在服务器上保留尽可能多的数据是一件好事。

例如，在公共终端设置中，是否可以让某人查看 cookie 的内容并查看列表？如果是这样，cookie 很好；如果没有，您只需要一个将用户链接到数据的 ID。这样做还可以让您确保用户通过站点身份验证以获取该数据，而不是将所有内容存储在机器上 - 他们需要某种形式的凭据*以及*会话标识符。

从大小的角度来看，当然，您不会太担心 4K cookie 或浏览器/宽带用户的东西，但如果您的目标之一是允许手机或黑莓（不在 3G 上）连接并且拥有快速的体验（并且不会为数据付费），最大限度地减少传递给客户端的数据量将是关键。

服务器存储还为您提供了其他一些答案中提到的一些灵活性 - 用户可以将他们的购物车保存在一台机器上并在另一台机器上继续使用它；您可以将购物车绑定到某种形式的凭据（而不是临时会话），并在用户清除其 cookie 后很长时间保留购物车；您可以在容错方面获得更多信息 - 如果用户的浏览器崩溃，该站点仍然拥有安全可靠的数据。

如果容错很重要，您将需要某种持久性存储，例如数据库。如果没有，在应用程序内存中可能没问题，但如果应用程序重新启动，您将丢失数据。如果您在农场环境中，商店必须可以集中访问，因此您再次查看数据库。

您是选择通过临时会话还是通过凭据进行密钥，将取决于用户是否可以保存他们的数据并稍后再回来获取它。瞬态会话最终将被清理为“被遗弃”，也许没关系。绑定到用户配置文件将使用户保留他们的数据并明确放弃它。无论哪种方式，我都会使用某种后备存储，例如数据库，以实现容错和中央可访问性。（或者也许我过度设计了解决方案？）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T19:47:44.500

如果您关心支持未启用 Javascript 的用户，那么服务器端会话将允许您使用 URL 重写。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T19:51:22.217

如果相对较短的超时（大约 2 小时，取决于您的服务器配置）对于购物车来说是可以的，那么我会说服务器端会话。它比访问数据库更快、更高效。

如果您需要更长的持久性（例如，某些用户喜欢离开并在第二天回来），则将其存储在防篡改的 cookie 中（使用加密或哈希）。

# asp.net - 使用asp.net登录控制的部分站点SSL

> ID：96164
> 
> 赞同：5
> 
> 时间：2008-09-18T19:43:53.683
> 
> 标签：asp.net, ssl, login

我正在尝试将本地登录系统转换为 .net 中包含的标准 asp.net 登录控件。我希望未登录的用户在网站上的所有通信都以明文形式进行，但在用户登录后将所有内容锁定在 SSL 中 - 包括用户名和密码的传输。

我之前通过加载带有 https: 前缀的第二页“loginaction.aspx”来进行此操作，然后通过在 Request.Form.Keys 中查找正确的文本框控件来提取用户名和密码。有没有办法使用 .net 登录控件做类似的事情？我不想有一个单独的登录页面，而是在网站的每个页面上都包含这个控件（在登录视图中）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T01:17:16.460

您将无法简单地做您所说的事情，因为回发（这是登录控件使用的）将取决于页面的安全性（SSL 或非 SSL）。

在这种情况下，您最好的选择是使用包含仅包含登录控件的 HTTPS (SSL) 页面的 IFRAME。您可能必须在登录后重定向到另一个页面，以便您跳出 IFRAME。

计划 B 是在页面上（在您的主 FORM 之外）有一个单独的表单，它的 ACTION 属性指向您处理登录的另一个页面。您将不得不滚动您自己的登录代码来处理表单身份验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-23T16:16:51.063

我可以通过将 OnClientClick 事件添加到登录按钮控件并将其设置为以下 javascript 函数来完成此操作。
`

```
function forceSSLSubmit() 
{

                var strAction = document.forms[0].action.toString();

                if (strAction.toLowerCase().indexOf("http:") == 0) {
                    strAction = "https" + strAction.substring(4);

                    document.forms[0].action = strAction;
                }

        } 
```

`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T20:25:17.360

您将无法将您的网站设置为非 SSL，在每个页面上都有一个登录框，然后通过 SSL 提交用户名和密码。

真正做到这一点的唯一方法是使用某种框架。这样，您的整个页面可能是非 SSL，但登录框架必须是 SSL。

执行此操作的常用方法是使用 SSL 锁定整个站点，不用担心用户名和密码 SSL 加密并在他们登录后转到 SSL，或者使用我上面提到的帧路由。

# html - 是否有任何所见即所得的 html 编辑工具或组件允许从一个段落到另一个段落的格式复制？

> ID：96185
> 
> 赞同：0
> 
> 时间：2008-09-18T19:44:58.487
> 
> 标签：html, wysiwyg

我相信这个问题说明了一切......（如果需要，我会更新）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T19:48:32.253

[http://www.openwebware.com/](http://www.openwebware.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T07:32:59.263

[FCKEditor](http://www.fckeditor.com/)可以完成这项工作。

# c++ - C++ 宏什么时候有用？

> ID：96196
> 
> 赞同：182
> 
> 时间：2008-09-18T19:46:04.567
> 
> 标签：c++, c-preprocessor

**C**预处理器有理由被 C++ 社区恐惧和回避。内联函数、常量和模板通常是比`#define`.

以下宏：

```
#define SUCCEEDED(hr) ((HRESULT)(hr) >= 0) 
```

绝不优于安全类型：

```
inline bool succeeded(int hr) { return hr >= 0; } 
```

但是宏确实有它们的位置，请列出您发现的宏的用途，如果没有预处理器*就无法*做到。

请将每个用例放在一个单独的答案中，以便对其进行投票，并且如果您知道如何在没有预处理者的情况下获得其中一个答案，请在该答案的评论中指出如何。

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2008-09-18T19:56:26.227

作为调试函数的包装器，自动传递`__FILE__`,`__LINE__`等内容：

```
#ifdef ( DEBUG )
#define M_DebugLog( msg )  std::cout << __FILE__ << ":" << __LINE__ << ": " << msg
#else
#define M_DebugLog( msg )
#endif 
```

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2008-09-18T19:54:22.240

方法必须始终是完整的、可编译的代码；宏可能是代码片段。因此，您可以定义一个 foreach 宏：

```
#define foreach(list, index) for(index = 0; index < list.size(); index++) 
```

并这样使用它：

```
foreach(cookies, i)
    printf("Cookie: %s", cookies[i]); 
```

[从 C++11 开始，这被基于范围的 for 循环](http://en.cppreference.com/w/cpp/language/range-for)所取代。

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2008-09-18T20:02:33.983

头文件保护需要宏。

还有其他**需要**宏的领域吗？不多（如果有的话）。

还有其他可以从宏中受益的情况吗？是的！！！

我使用宏的一个地方是非常重复的代码。例如，当包装 C++ 代码以与其他接口（.NET、COM、Python 等）一起使用时，我需要捕获不同类型的异常。我是这样做的：

```
#define HANDLE_EXCEPTIONS \
catch (::mylib::exception& e) { \
    throw gcnew MyDotNetLib::Exception(e); \
} \
catch (::std::exception& e) { \
    throw gcnew MyDotNetLib::Exception(e, __LINE__, __FILE__); \
} \
catch (...) { \
    throw gcnew MyDotNetLib::UnknownException(__LINE__, __FILE__); \
} 
```

我必须将这些捕获放在每个包装函数中。我不是每次都输入完整的 catch 块，而是输入：

```
void Foo()
{
    try {
        ::mylib::Foo()
    }
    HANDLE_EXCEPTIONS
} 
```

这也使维护更容易。如果我必须添加一个新的异常类型，我只需要在一个地方添加它。

还有其他有用的例子：其中许多包括`__FILE__`和`__LINE__`预处理器宏。

无论如何，正确使用宏是非常有用的。宏并不邪恶——**滥用**它们是邪恶的。

* * *

## 回答 #4

> 赞同：54
> 
> 时间：2008-10-17T16:03:59.657

大多：

1.  包括警卫
2.  条件编译
3.  报告（预定义的宏，如`__LINE__`和`__FILE__`）
4.  （很少）复制重复的代码模式。
5.  在竞争对手的代码中。

* * *

## 回答 #5

> 赞同：50
> 
> 时间：2008-09-18T20:00:32.460

在条件编译内部，克服编译器之间的差异问题：

```
#ifdef WE_ARE_ON_WIN32
#define close(parm1)            _close (parm1)
#define rmdir(parm1)            _rmdir (parm1)
#define mkdir(parm1, parm2)     _mkdir (parm1)
#define access(parm1, parm2)    _access(parm1, parm2)
#define create(parm1, parm2)    _creat (parm1, parm2)
#define unlink(parm1)           _unlink(parm1)
#endif 
```

* * *

## 回答 #6

> 赞同：37
> 
> 时间：2008-09-18T19:54:05.797

当您想从表达式中创建一个字符串时，最好的例子是`assert`（`#x`将值`x`转换为字符串）。

```
#define ASSERT_THROW(condition) \
if (!(condition)) \
     throw std::exception(#condition " is false"); 
```

* * *

## 回答 #7

> 赞同：34
> 
> 时间：2008-10-22T20:26:21.997

有时将字符串常量更好地定义为宏，因为您可以使用字符串文字做更多的事情而不是使用`const char *`.

例如，字符串文字可以很[容易地连接起来](http://msdn.microsoft.com/en-us/library/c7bt45zf(VS.80).aspx)。

```
#define BASE_HKEY "Software\\Microsoft\\Internet Explorer\\"
// Now we can concat with other literals
RegOpenKey(HKEY_CURRENT_USER, BASE_HKEY "Settings", &settings);
RegOpenKey(HKEY_CURRENT_USER, BASE_HKEY "TypedURLs", &URLs); 
```

如果使用 a `const char *`，则必须使用某种字符串类在运行时执行连接：

```
const char* BaseHkey = "Software\\Microsoft\\Internet Explorer\\";
RegOpenKey(HKEY_CURRENT_USER, (string(BaseHkey) + "Settings").c_str(), &settings);
RegOpenKey(HKEY_CURRENT_USER, (string(BaseHkey) + "TypedURLs").c_str(), &URLs); 
```

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2008-09-18T19:50:47.303

当您想要更改程序流（和）时`return`，函数中的代码的行为与函数中实际内联的代码不同。`break``continue`

```
#define ASSERT_RETURN(condition, ret_val) \
if (!(condition)) { \
    assert(false && #condition); \
    return ret_val; }

// should really be in a do { } while(false) but that's another discussion. 
```

* * *

## 回答 #9

> 赞同：20
> 
> 时间：2008-09-18T19:53:01.773

明显的包括警卫

```
#ifndef MYHEADER_H
#define MYHEADER_H

...

#endif 
```

* * *

## 回答 #10

> 赞同：17
> 
> 时间：2008-09-18T20:04:27.597

[像UnitTest++](https://github.com/unittest-cpp/unittest-cpp "单元测试++")这样的 C++ 单元测试框架几乎都围绕预处理器宏展开。几行单元测试代码扩展成一个层次结构的类，手动输入一点也不好玩。如果没有 UnitTest++ 之类的东西和它的预处理器魔法，我不知道您将如何有效地为 C++ 编写单元测试。

* * *

## 回答 #11

> 赞同：17
> 
> 时间：2008-09-18T20:13:37.607

假设我们将忽略诸如头卫之类的明显事物。

有时，您想要生成需要由预编译器复制/粘贴的代码：

```
#define RAISE_ERROR_STL(p_strMessage)                                          \
do                                                                             \
{                                                                              \
   try                                                                         \
   {                                                                           \
      std::tstringstream strBuffer ;                                           \
      strBuffer << p_strMessage ;                                              \
      strMessage = strBuffer.str() ;                                           \
      raiseSomeAlert(__FILE__, __FUNCSIG__, __LINE__, strBuffer.str().c_str()) \
   }                                                                           \
   catch(...){}                                                                \
   {                                                                           \
   }                                                                           \
}                                                                              \
while(false) 
```

这使您能够编码：

```
RAISE_ERROR_STL("Hello... The following values " << i << " and " << j << " are wrong") ; 
```

并且可以生成如下消息：

```
Error Raised:
====================================
File : MyFile.cpp, line 225
Function : MyFunction(int, double)
Message : "Hello... The following values 23 and 12 are wrong" 
```

请注意，将模板与宏混合可以产生更好的结果（即自动生成与其变量名并排的值）

例如，其他时候，您需要某些代码的 __FILE__ 和/或 __LINE__ 来生成调试信息。以下是Visual C++的经典：

```
#define WRNG_PRIVATE_STR2(z) #z
#define WRNG_PRIVATE_STR1(x) WRNG_PRIVATE_STR2(x)
#define WRNG __FILE__ "("WRNG_PRIVATE_STR1(__LINE__)") : ------------ : " 
```

与以下代码一样：

```
#pragma message(WRNG "Hello World") 
```

它会生成如下消息：

```
C:\my_project\my_cpp_file.cpp (225) : ------------ Hello World 
```

其他时候，您需要使用 # 和 ## 连接运算符生成代码，例如为属性生成 getter 和 setter（这仅适用于非常有限的情况）。

其他时候，如果通过函数使用，您将生成不会编译的代码，例如：

```
#define MY_TRY      try{
#define MY_CATCH    } catch(...) {
#define MY_END_TRY  } 
```

哪个可以用作

```
MY_TRY
   doSomethingDangerous() ;
MY_CATCH
   tryToRecoverEvenWithoutMeaningfullInfo() ;
   damnThoseMacros() ;
MY_END_TRY 
```

（不过，我只看到这种代码正确使用**过一次**）

最后但并非最不重要的，著名的[`boost::foreach`](http://www.boost.org/doc/libs/1_35_0/doc/html/foreach.html)！！！

```
#include <string>
#include <iostream>
#include <boost/foreach.hpp>

int main()
{
    std::string hello( "Hello, world!" );

    BOOST_FOREACH( char ch, hello )
    {
        std::cout << ch;
    }

    return 0;
} 
```

（注：代码复制/粘贴自 boost 主页）

哪个（恕我直言）比`std::for_each`.

因此，宏总是有用的，因为它们超出了正常的编译器规则。但我发现大多数时候我看到一个，它们实际上是 C 代码的剩余部分，从未翻译成正确的 C++。

* * *

## 回答 #12

> 赞同：16
> 
> 时间：2008-09-18T19:52:39.700

您不能使用常规函数调用来执行函数调用参数的短路。例如：

```
#define andm(a, b) (a) && (b)

bool andf(bool a, bool b) { return a && b; }

andm(x, y) // short circuits the operator so if x is false, y would not be evaluated
andf(x, y) // y will always be evaluated 
```

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2008-10-17T15:46:44.823

害怕 C 预处理器就像害怕白炽灯泡一样，仅仅因为我们有荧光灯泡。是的，前者可以是{电| 程序员时间}效率低下。是的，你可以（字面上）被他们烧死。但是，如果您处理得当，他们可以完成工作。

当您对嵌入式系统进行编程时，C 曾经是除了汇编程序之外的唯一选择。在使用 C++ 在桌面上进行编程，然后切换到更小的嵌入式目标之后，您将学会不再担心这么多裸 C 功能（包括宏）的“不优雅”，而只是试图找出您可以从中获得的最佳和安全用法特征。

亚历山大·斯捷潘诺夫[说](http://www.stepanovpapers.com/notes.pdf)：

> 当我们用 C++ 编程时，我们不应该为它的 C 遗产感到羞耻，而是要充分利用它。C++ 的唯一问题，甚至 C 的唯一问题，都是在它们本身与自己的逻辑不一致时出现的。

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2008-10-23T21:49:30.173

仍然可以使用预处理器（宏）构建一些非常先进和有用的东西，而使用包括模板在内的 c++“语言结构”是永远无法做到的。

例子：

[使某物既是 C 标识符又是字符串](https://stackoverflow.com/questions/126277/making-something-both-a-c-identifier-and-a-string)

[在 C 中使用枚举类型的变量作为字符串的简单方法](https://stackoverflow.com/questions/147267/easy-way-to-use-variables-of-enum-types-as-string-in-c#202511)

[Boost 预处理器元编程](http://www.boost.org/doc/libs/?view=category_Preprocessor)

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2008-09-18T20:05:51.697

我们在信息丰富的异常抛出、捕获和日志记录中使用`__FILE__`和`__LINE__`宏进行诊断，同时在我们的 QA 基础架构中使用自动日志文件扫描器。

例如，抛出宏`OUR_OWN_THROW`可以与异常类型和该异常的构造函数参数一起使用，包括文本描述。像这样：

```
OUR_OWN_THROW(InvalidOperationException, (L"Uninitialized foo!")); 
```

这个宏当然会抛出`InvalidOperationException`异常，并将描述作为构造函数参数，但它也会向日志文件写入一条消息，该日志文件由发生抛出的文件名和行号及其文本描述组成。抛出的异常将获得一个 id，该 id 也会被记录。如果异常在代码中的其他地方被捕获，它将被标记为这样，然后日志文件将指示该特定异常已被处理，因此它不太可能导致稍后可能记录的任何崩溃。我们的自动化 QA 基础设施可以轻松发现未处理的异常。

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2011-11-06T12:41:18.530

代码重复。

看看[boost preprocessor library](http://www.boost.org/doc/libs/1_47_0/libs/preprocessor/doc/topics/motivation.html)，它是一种元元编程。在 topic->motivation 中你可以找到一个很好的例子。

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2008-09-18T19:52:45.630

一个常见的用途是检测编译环境，对于跨平台开发，您可以为 linux 编写一组代码，例如，当没有跨平台库供您使用时，您可以为 windows 编写另一组代码。

因此，在一个粗略的示例中，跨平台互斥锁可以具有

```
void lock()
{
    #ifdef WIN32
    EnterCriticalSection(...)
    #endif
    #ifdef POSIX
    pthread_mutex_lock(...)
    #endif
} 
```

对于函数，当您想显式忽略类型安全时，它们很有用。比如上面和下面的很多例子都是做 ASSERT 的。当然，就像许多 C/C++ 功能一样，您可以自责，但该语言为您提供了工具并让您决定要做什么。

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2008-09-18T20:50:04.803

我偶尔会使用宏，这样我就可以在一个地方定义信息，但在代码的不同部分以不同的方式使用它。这只是有点邪恶:)

例如，在“field_list.h”中：

```
/*
 * List of fields, names and values.
 */
FIELD(EXAMPLE1, "first example", 10)
FIELD(EXAMPLE2, "second example", 96)
FIELD(ANOTHER, "more stuff", 32)
...
#undef FIELD 
```

然后对于公共枚举，可以将其定义为仅使用名称：

```
#define FIELD(name, desc, value) FIELD_ ## name,

typedef field_ {

#include "field_list.h"

    FIELD_MAX

} field_en; 
```

在私有初始化函数中，所有字段都可用于使用数据填充表：

```
#define FIELD(name, desc, value) \
    table[FIELD_ ## name].desc = desc; \
    table[FIELD_ ## name].value = value;

#include "field_list.h" 
```

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2008-09-18T20:03:36.633

就像是

```
void debugAssert(bool val, const char* file, int lineNumber);
#define assert(x) debugAssert(x,__FILE__,__LINE__); 
```

这样您就可以例如拥有

```
assert(n == true); 
```

如果 n 为假，则将问题的源文件名和行号打印到您的日志中。

如果您使用正常的函数调用，例如

```
void assert(bool val); 
```

而不是宏，你所能得到的只是你的断言函数的行号打印到日志中，这将不太有用。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2008-09-18T21:41:01.093

```
#define ARRAY_SIZE(arr) (sizeof arr / sizeof arr[0]) 
```

与当前线程中讨论的“首选”模板解决方案不同，您可以将其用作常量表达式：

```
char src[23];
int dest[ARRAY_SIZE(src)]; 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2008-09-18T19:55:04.920

当您在编译时就编译器/操作系统/硬件特定行为做出决定时。

它允许您创建与编译器/操作系统/硬件特定功能的接口。

```
#if defined(MY_OS1) && defined(MY_HARDWARE1)
#define   MY_ACTION(a,b,c)      doSothing_OS1HW1(a,b,c);}
#elif define(MY_OS1) && defined(MY_HARDWARE2)
#define   MY_ACTION(a,b,c)      doSomthing_OS1HW2(a,b,c);}
#elif define(MY_SUPER_OS)
          /* On this hardware it is a null operation */
#define   MY_ACTION(a,b,c)
#else
#error  "PLEASE DEFINE MY_ACTION() for this Compiler/OS/HArdware configuration"
#endif 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2008-09-18T21:03:34.973

您可以使用#defines 来帮助调试和单元测试方案。例如，创建内存函数的特殊日志变体并创建一个特殊的 memlog_preinclude.h：

```
#define malloc memlog_malloc
#define calloc memlog calloc
#define free memlog_free 
```

使用以下代码编译您的代码：

```
gcc -Imemlog_preinclude.h ... 
```

memlog.o 中指向最终图像的链接。您现在控制 malloc 等，可能是为了记录日志，或者模拟单元测试的分配失败。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2008-09-18T19:54:39.617

编译器可以拒绝您的内联请求。

宏将永远占有一席之地。

我发现#define DEBUG 用于调试跟踪很有用——您可以在调试问题时将其保留为 1（甚至在整个开发周期中将其保持打开状态），然后在交付时将其关闭。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2008-09-19T03:52:38.610

在我的上一份工作中，我正在研究病毒扫描程序。为了让我更容易调试，我到处都有大量的日志记录，但是在这样一个高需求的应用程序中，函数调用的费用太昂贵了。所以，我想出了这个小宏，它仍然允许我在客户站点的发布版本上启用调试日志记录，而无需函数调用的成本将检查调试标志并返回而不记录任何内容，或者如果启用, 会做日志记录... 宏定义如下：

```
#define dbgmsg(_FORMAT, ...)  if((debugmsg_flag  & 0x00000001) || (debugmsg_flag & 0x80000000))     { log_dbgmsg(_FORMAT, __VA_ARGS__);  } 
```

由于日志函数中的 VA_ARGS，这对于这样的宏来说是一个很好的例子。

在此之前，我在一个高安全性应用程序中使用了一个宏，它需要告诉用户他们没有正确的访问权限，它会告诉他们他们需要什么标志。

宏定义为：

```
#define SECURITY_CHECK(lRequiredSecRoles) if(!DoSecurityCheck(lRequiredSecRoles, #lRequiredSecRoles, true)) return
#define SECURITY_CHECK_QUIET(lRequiredSecRoles) (DoSecurityCheck(lRequiredSecRoles, #lRequiredSecRoles, false)) 
```

然后，我们可以在整个 UI 上进行检查，它会告诉您哪些角色可以执行您尝试执行的操作（如果您还没有该角色）。其中两个的原因是在某些地方返回一个值，而在其他地方从一个 void 函数返回......

```
SECURITY_CHECK(ROLE_BUSINESS_INFORMATION_STEWARD | ROLE_WORKER_ADMINISTRATOR);

LRESULT CAddPerson1::OnWizardNext() 
{
   if(m_Role.GetItemData(m_Role.GetCurSel()) == parent->ROLE_EMPLOYEE) {
      SECURITY_CHECK(ROLE_WORKER_ADMINISTRATOR | ROLE_BUSINESS_INFORMATION_STEWARD ) -1;
   } else if(m_Role.GetItemData(m_Role.GetCurSel()) == parent->ROLE_CONTINGENT) {
      SECURITY_CHECK(ROLE_CONTINGENT_WORKER_ADMINISTRATOR | ROLE_BUSINESS_INFORMATION_STEWARD | ROLE_WORKER_ADMINISTRATOR) -1;
   }
... 
```

无论如何，这就是我使用它们的方式，而且我不确定如何使用模板来帮助...除此之外，我尽量避免使用它们，除非真的有必要。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2011-06-15T21:13:21.000

我使用宏来轻松定义异常：

```
DEF_EXCEPTION(RessourceNotFound, "Ressource not found") 
```

其中 DEF_EXCEPTION 是

```
#define DEF_EXCEPTION(A, B) class A : public exception\
  {\
  public:\
    virtual const char* what() const throw()\
    {\
      return B;\
    };\
  }\ 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2008-09-19T03:44:59.813

您可以使用or选项`#define`在编译器命令行上设置常量。这在为多个平台交叉编译相同的软件时通常很有用，因为您可以让您的 makefile 控制为每个平台定义的常量。`-D``/D`

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2008-10-03T02:16:15.507

如果您有一个用于一堆事情的字段列表，例如定义一个结构，将该结构序列化为/从某种二进制格式序列化，执行数据库插入等，那么您可以（递归地！）使用预处理器来避免重复你的字段列表。

这无疑是可怕的。但有时可能比在多个地方更新一长串字段更好？我只使用过一次这种技术，那一次很有帮助。

当然，相同的一般思想在具有适当反射的语言中被广泛使用——只需内省类并依次在每个字段上操作。在 C 预处理器中执行此操作是脆弱的、难以辨认的，并且并不总是可移植的。所以我有些惶恐地提到它。尽管如此，这里...

（编辑：我现在看到这与@Andrew Johnson 在 9/18 上所说的类似；但是递归包含同一文件的想法使这个想法更进一步。）

```
// file foo.h, defines class Foo and various members on it without ever repeating the
// list of fields.

#if defined( FIELD_LIST )
   // here's the actual list of fields in the class.  If FIELD_LIST is defined, we're at
   // the 3rd level of inclusion and somebody wants to actually use the field list.  In order
   // to do so, they will have defined the macros STRING and INT before including us.
   STRING( fooString )
   INT( barInt )   
#else // defined( FIELD_LIST )

#if !defined(FOO_H)
#define FOO_H

#define DEFINE_STRUCT
// recursively include this same file to define class Foo
#include "foo.h"
#undef DEFINE_STRUCT

#define DEFINE_CLEAR
// recursively include this same file to define method Foo::clear
#include "foo.h"
#undef DEFINE_CLEAR

// etc ... many more interesting examples like serialization

#else // defined(FOO_H)
// from here on, we know that FOO_H was defined, in other words we're at the second level of
// recursive inclusion, and the file is being used to make some particular
// use of the field list, for example defining the class or a single method of it

#if defined( DEFINE_STRUCT )
#define STRING(a)  std::string a;
#define INT(a)     long a;
   class Foo
   {
      public:
#define FIELD_LIST
// recursively include the same file (for the third time!) to get fields
// This is going to translate into:
//    std::string fooString;
//    int barInt;
#include "foo.h"
#endif

      void clear();
   };
#undef STRING
#undef INT
#endif // defined(DEFINE_STRUCT)

#if defined( DEFINE_ZERO )
#define STRING(a) a = "";
#define INT(a) a = 0;
#define FIELD_LIST
   void Foo::clear()
   {
// recursively include the same file (for the third time!) to get fields.
// This is going to translate into:
//    fooString="";
//    barInt=0;
#include "foo.h"
#undef STRING
#undef int
   }
#endif // defined( DEFINE_ZERO )

// etc...

#endif // end else clause for defined( FOO_H )

#endif // end else clause for defined( FIELD_LIST ) 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2009-08-18T23:46:43.227

我已经使用预处理器从嵌入式系统中使用的浮点值计算定点数，这些浮点值不能在编译代码中使用浮点数。将所有数学都放在真实世界单位中很方便，而不必在定点中考虑它们。

例子：

```
// TICKS_PER_UNIT is defined in floating point to allow the conversions to compute during compile-time.
#define TICKS_PER_UNIT  1024.0

// NOTE: The TICKS_PER_x_MS will produce constants in the preprocessor.  The (long) cast will
//       guarantee there are no floating point values in the embedded code and will produce a warning
//       if the constant is larger than the data type being stored to.
//       Adding 0.5 sec to the calculation forces rounding instead of truncation.
#define TICKS_PER_1_MS( ms ) (long)( ( ( ms * TICKS_PER_UNIT ) / 1000 ) + 0.5 ) 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2010-02-04T11:33:17.190

又一个 foreach 宏。T：类型，c：容器，i：迭代器

```
#define foreach(T, c, i) for(T::iterator i=(c).begin(); i!=(c).end(); ++i)
#define foreach_const(T, c, i) for(T::const_iterator i=(c).begin(); i!=(c).end(); ++i) 
```

用法（概念展示，不真实）：

```
void MultiplyEveryElementInList(std::list<int>& ints, int mul)
{
    foreach(std::list<int>, ints, i)
        (*i) *= mul;
}

int GetSumOfList(const std::list<int>& ints)
{
    int ret = 0;
    foreach_const(std::list<int>, ints, i)
        ret += *i;
    return ret;
} 
```

提供更好的实现：谷歌**“BOOST_FOREACH”**

可用的好文章：**有条件的爱：FOREACH Redux** (Eric Niebler) [http://www.artima.com/cppsource/foreach.html](http://www.artima.com/cppsource/foreach.html)

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2010-04-18T12:37:15.150

也许宏的最大用途是在独立于平台的开发中。考虑类型不一致的情况——使用宏，你可以简单地使用不同的头文件——比如：--WIN_TYPES.H

```
typedef ...some struct 
```

--POSIX_TYPES.h

```
typedef ...some another struct 
```

--program.h

```
#ifdef WIN32
#define TYPES_H "WINTYPES.H"
#else 
#define TYPES_H "POSIX_TYPES.H"
#endif

#include TYPES_H 
```

在我看来，比以其他方式实现它更具可读性。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2011-08-16T12:03:32.367

到目前为止，似乎 VA_ARGS 只是被间接提及：

在编写通用 C++03 代码时，您需要可变数量的（通用）参数，您可以使用宏而不是模板。

```
#define CALL_RETURN_WRAPPER(FnType, FName, ...)          \
  if( FnType theFunction = get_op_from_name(FName) ) {   \
    return theFunction(__VA_ARGS__);                     \
  } else {                                               \
    throw invalid_function_name(FName);                  \
  }                                                      \
/**/ 
```

[**注意：**通常，名称检查/抛出也可以合并到假设`get_op_from_name`函数中。这只是一个例子。围绕 VA_ARGS 调用可能还有其他通用代码。]

一旦我们使用 C++11 获得可变参数模板，我们就可以使用模板“正确”地解决这个问题。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2008-09-18T19:52:34.100

很多时候我最终得到如下代码：

```
int SomeAPICallbackMethod(long a, long b, SomeCrazyClass c, long d, string e, string f, long double yx) { ... }
int AnotherCallback(long a, long b, SomeCrazyClass c, long d, string e, string f, long double yx) { ... }
int YetAnotherCallback(long a, long b, SomeCrazyClass c, long d, string e, string f, long double yx) { ... } 
```

在某些情况下，我会使用以下内容让我的生活更轻松：

```
#define APIARGS long a, long b, SomeCrazyClass c, long d, string e, string f, long double yx
int SomeAPICallbackMethod(APIARGS) { ... } 
```

它带有真正隐藏变量名称的警告，这在较大的系统中可能是一个问题，所以这并不总是正确的做法，只是*有时*。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2008-09-18T20:06:30.667

我认为这个技巧是对无法用函数模拟的预处理器的巧妙使用：

```
#define COMMENT COMMENT_SLASH(/)
#define COMMENT_SLASH(s) /##s

#if defined _DEBUG
#define DEBUG_ONLY
#else
#define DEBUG_ONLY COMMENT
#endif 
```

然后你可以像这样使用它：

```
cout <<"Hello, World!" <<endl;
DEBUG_ONLY cout <<"This is outputed only in debug mode" <<endl; 
```

您还可以定义 RELEASE_ONLY 宏。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2008-09-18T20:17:08.363

您需要 Visual Studio 中资源标识符的宏，因为资源编译器只能理解它们（即，它不适用于 const 或 enum）。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2008-09-19T02:31:09.150

您可以将其实现为内联函数吗？

```
#define my_free(x) do { free(x); x = NULL; } while (0) 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2008-10-17T16:08:53.890

您可以在调试版本中启用额外的日志记录，并在发布版本中禁用它，而无需布尔检查的开销。所以，而不是：

```
void Log::trace(const char *pszMsg) {
    if (!bDebugBuild) {
        return;
    }
    // Do the logging
}

...

log.trace("Inside MyFunction"); 
```

你可以有：

```
#ifdef _DEBUG
#define LOG_TRACE log.trace
#else
#define LOG_TRACE void
#endif

...

LOG_TRACE("Inside MyFunction"); 
```

当 _DEBUG 未定义时，这根本不会生成任何代码。您的程序将运行得更快，并且跟踪记录的文本不会编译到您的可执行文件中。

* * *

## 回答 #37

> 赞同：-1
> 
> 时间：2011-05-08T04:12:25.953

```
#define COLUMNS(A,B) [(B) - (A) + 1]

struct 
{
    char firstName COLUMNS(  1,  30);
    char lastName  COLUMNS( 31,  60);
    char address1  COLUMNS( 61,  90);
    char address2  COLUMNS( 91, 120);
    char city      COLUMNS(121, 150);
}; 
```

* * *

## 回答 #38

> 赞同：-1
> 
> 时间：2018-08-03T14:24:59.233

宏对于模拟 switch 语句的语法很有用：

```
switch(x) {
case val1: do_stuff(); break;
case val2: do_other_stuff();
case val3: yet_more_stuff();
default:   something_else();
} 
```

对于非整数值类型。在这个问题中：

[在 switch 语句中使用字符串——我们在 C++17 中的立场是什么？](https://stackoverflow.com/q/41337256/1593077)

你会发现答案暗示了一些涉及 lambdas 的方法，但不幸的是，它是让我们最接近的宏：

```
SWITCH(x)
CASE val1  do_stuff(); break;
CASE val2  do_other_stuff();
CASE val3  yet_more_stuff();
DEFAULT    something_else();
END 
```

# sql-server - 如何确定从 LINQ 到 SQL 的结果集的大小（以字节为单位）

> ID：96211
> 
> 赞同：2
> 
> 时间：2008-09-18T19:48:25.577
> 
> 标签：sql-server, linq, linq-to-sql, datacontext

在编写手动 SQL 时，很容易估计查询返回的数据的大小和形状。我越来越发现使用 LINQ to SQL 查询很难做到这一点。有时我发现的数据比我预期的要多得多——这确实会减慢直接访问数据库的远程客户端的速度。

我希望能够运行查询，然后准确地知道通过网络返回了多少数据，并使用它来帮助我优化。

我已经使用 DataContext.Log 方法连接了一个日志，但这只能告诉我发送的 SQL，而不是接收到的数据。

有小费吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T20:25:03.647

看起来您可以获取 DataContext 的 SqlConnection 并打开统计信息。

其中一项统计数据是“返回的字节数”。

[MSDN 参考链接](http://msdn.microsoft.com/en-us/library/7h2ahss8(VS.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T18:59:38.653

注意：如果您有现有的 DataContext，则需要将连接强制转换为 SqlConnection

```
 ((SqlConnection)dc.Connection).StatisticsEnabled = true; 
```

然后检索统计信息：

```
 ((SqlConnection)dc.Connection).RetrieveStatistics() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T11:29:57.330

我发现没有办法抓取DataContext的SqlConnection，所以我手动创建了SqlConnection：

```
SqlConnection sqlConnection = new SqlConnection("your_connection_string");
// enable statistics
cn.StatisticsEnabled = true;

// create your DataContext with the SqlConnection
NorthWindDataContext nwContext = new NorthWindDataContext(sqlConnection);

var products = from product in nwContext
               where product.Category.CategoryName = "Beverages"
               select product;
foreach (var product in products)
{
    //do something with product
}

// retrieve statistics - for keys see http://msdn.microsoft.com/en-us/library/7h2ahss8(VS.80).aspx
string bytesSent = sqlConnection.RetrieveStatistics()["BytesSent"].ToString();
string bytesReceived = sqlConnection.RetrieveStatistics()["BytesReceived"].ToString(); 
```

# c# - .NET Compact Framework 打印库

> ID：96218
> 
> 赞同：7
> 
> 时间：2008-09-18T19:49:04.357
> 
> 标签：c#, windows-mobile, compact-framework

谁能指出可用于从 Compact .Net Framework 1.0 打印的库？

标准：

1.  我需要能够打印文本和条形码。
2.  该库最好可以升级到 .Net 2.0 或更高版本，且中断最少。
3.  可以是开源的[可以作为商业应用程序的一部分分发]，也可以是可以购买的。

*编辑*

更多信息：

1.  我们是 ISV，此应用程序出售给我们的客户。
2.  此应用程序通常安装在 Symbol、Opticon 设备上。但有时它会安装在通用的 Windows Mobile PDA 或电话设备上。
3.  我希望该库与来自多个供应商的打印机一起使用。[我现在有来自 O'Neil 和 Citizen-Systems 的打印机用于测试]。
4.  我们希望使用蓝牙连接打印机。我猜这个库通常应该与任何串行端口连接一起使用。
5.  [FieldSoftware](http://www.fieldsoftware.com)的[PrinterCE.NetCF](http://www.fieldsoftware.com/PrinterCE_NetCF.htm)似乎符合要求。谢谢克塔克。[_](https://stackoverflow.com/questions/96218/net-compact-framework-printing-libraries#96899) 我正在寻找类似的东西。

谢谢，

基肖尔

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T20:59:58.010

你没有给我们太多细节，比如你正在使用的设备或你想要打印到的打印机类型（本地、局域网、串行、网络等），但是我会看看我是否至少可以指出你正确的方向。

CF 打印的事实标准是[Field Software 的 PrinterCE](http://www.fieldsoftware.com/PrinterCE_NetCF.htm)。 [Bachmann Software 的 PrintBoy](http://www.bachmannsoftware.com/pbce.htm)也很有效。我不确定eitehr是否有能力打印条形码。

现在，如果您要打印条形码，则表明您使用的是 Symbol（现为摩托罗拉）或 Intermec 手持设备之类的设备。如果是这种情况，那么这些制造商就有自己的允许打印的 SDK。

如果您要打印到 Zebra 条码打印机之类的设备上，它们通常也有一些用于打印条码的串行 PCL 命令，因此您实际上不需要“打印”条码。相反，您发送 PCL 命令告诉打印机数据应该输出条形码而不是文本。打印机制造商可以提供 PCL 参考，因为这些类型的 PCL 没有标准化。

# linq-to-sql - 使用 linq to sql 开发良好的网站架构？

> ID：96226
> 
> 赞同：0
> 
> 时间：2008-09-18T19:49:50.893
> 
> 标签：linq-to-sql, architecture

有人发现使用 linq to sql 的良好网站架构吗？任何帮助都会非常有帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T20:28:18.680

我们刚刚完成了一个在 Linq2Sql 上投入大量资金的内部 IT 项目，并且得到了回报。起初我有点怀疑，但我认为最终效果很好。请记住，基本面不会改变。

1）尽量保持无状态 2）在您的服务和数据访问之间保持清晰的界限 3）不要**与**linq 对抗，**使用**它。如果它没有帮助你，你可能做错了什么

我们的实现最终是[Andrew Siemer](http://geekswithblogs.net/AndrewSiemer/archive/2008/02/05/linq-to-sql---implementing-the-repository-pattern.aspx)和[Beth Massi](http://code.msdn.microsoft.com/linqntier)方法（在 Andrew 方面有点重）和 C#的混合体

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T19:52:01.560

除了 StackOverflow，还有什么？;-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T20:31:04.630

请记住，Linq 是一种位于典型数据访问结构之上的技术。因此，迄今为止适用的所有规则仍然有效。仅仅因为您可以在客户端应用程序中更轻松地获取数据并不意味着您放弃了数据访问的架构最佳实践。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T23:47:49.167

[Rob Conery 的 MVC 店面](http://www.codeplex.com/mvcsamples)

正如其他人所说，linq-to-sql 与任何其他 ORM 没有什么不同，因此架构与您用于 NHibernate 和其他人的架构相同。

# c++ - 为什么我要使用 2 的补码来比较两个双精度数，而不是将它们的差异与 epsilon 值进行比较？

> ID：96233
> 
> 赞同：3
> 
> 时间：2008-09-18T19:51:14.197
> 
> 标签：c++, floating-point, double

引用[here](https://stackoverflow.com/questions/21265/comparing-ieee-floats-and-doubles-for-equality)和[here](https://stackoverflow.com/questions/17333/most-effective-way-for-float-and-double-comparison) ...为什么我会在epsilon方法上使用二进制补码？对于大多数情况，epsilon 方法似乎已经足够了。

* * *

**更新：** 我纯粹是在寻找一个理论上的原因，为什么你会使用一个而不是另一个。我一直使用 epsilon 方法。

有没有人成功使用 2 的补码比较？为什么？为什么不？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T19:55:23.190

您引用的第二个链接提到了一篇对该问题的描述很长的文章：

[http://www.cygnus-software.com/papers/comparingfloats/comparingfloats.htm](http://www.cygnus-software.com/papers/comparingfloats/comparingfloats.htm)

但除非您正在调整性能，否则我会坚持使用 epsilon，以便人们可以调试您的代码

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T19:58:30.730

简而言之，在比较两个来源未知的浮点数时，选择一个有效的 epsilon 几乎是不可能的。

例如：

比较亚特兰大佐治亚州、达拉斯德克萨斯州和俄亥俄州某个地方之间的距离（以英里为单位）时，好的 epsilon 是多少？

在比较我的左脚、右脚和我桌子下的电脑之间的距离（以英里为单位）时，什么是好的 epsilon？

**编辑：**

好吧，我让相当多的人不明白为什么你不知道你的 epsilon 是什么。

回到过去，我编写了两个与 NeverWinter Nights（由 BioWare 制作的游戏）配合使用的程序。其中一个程序采用二进制模型并将其转换为 ASCII。另一个程序采用 ASCII 模型并将其编译为二进制。我编写的测试之一是获取 BioWare 的所有二进制模型，将它们反编译为 ASCII，然后再返回二进制。然后我将我的二进制版本与 BioWare 的原始版本进行了比较。比较期间的问题之一是处理浮点值的一些细微差异。因此，我不想为每种类型的浮点数（顶点、法线等）提出一堆不同的 EPSILONS，而是想使用诸如这两个恭维比较之类的东西。从而避免了整个多重 EPSILON 问题。

相同类型的问题可能适用于处理第 3 方数据的任何类型的软件，然后需要使用原始数据验证其结果。在这些情况下，您甚至可能不知道浮点值代表什么，您只需要比较它们即可。我们的工业自动化软件遇到了这个问题。

**编辑：**

大声笑，这已经被不同的人投票了。

我将问题归结为这个，给定两个**任意**浮点数，你如何决定使用什么 epsilon？你不能。

您如何将 1e23 和 1.0001e23 与 epsilon 进行比较，并且仍然使用相同的 epsilon 比较 1e-23 和 5.2e-23？当然，你可以做一些动态的 epsilon 技巧，但这就是整数比较的重点（它不需要整数是精确的）。

整数比较能够使用相对于数字大小的 epsilon 来比较两个浮点数。

**编辑**

史蒂夫，让我们看看你在评论中所说的话：

“但你知道平等对你意味着什么……因此，你应该能够找到一个合适的 epsilon”。

把这句话反过来说：

“如果你知道平等对你意味着什么，那么你应该能够找到一个合适的 epsilon。”

我想说的是，在某些应用程序中，我们不知道绝对意义上的相等意味着什么，因此我们必须求助于整数版本试图做的相对比较。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T19:58:53.710

bits 方法可能更快。我说可能是因为在现代（多核、高度流水线）处理器上，通常不可能猜出真正更快的处理器。编码最简单最明显正确的实现，然后测量，然后优化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T20:00:30.603

在速度方面，请遵循以下规则：

1.  如果您不是经验丰富的开发人员，请不要优化。
2.  如果您是经验丰富的开发人员，请不要进行优化。

做最简单的方法。

亚历克斯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T20:00:38.637

奥斯卡是对的。除非你真的非常需要这种性能，否则不要搞砸。

而你没有。如果你处于这种情况，你就不需要问这个问题——你已经知道了。如果你认为你会，那么你不会。您的性能问题在其他地方。只需使用可读版本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T20:01:28.570

当分数由近似值表示时，使用任何按位比较的方法都会导致麻烦。所有浮点数的分数不是以 2 的幂（1/2、1/4、1/8、1/65536 和 c）命名的。所以，当然，都是无理数。

浮动第三 = 1/3; 浮动二=2.0；浮动另一个_两个=第三个*6.0；if(two != another_two) print ("近似值！\n");

唯一可以按位比较的情况是当您以完全相同的方式导出浮点数或者它们是精确表示（整数，2 的分数幂）时。即使那样，某些数字也可以有多种表示形式，尽管我从未在工作系统中看到过这种情况。

# java - 在 Java Web 应用程序 (WAR) 中存储配置文件的最佳位置是什么？

> ID：96247
> 
> 赞同：56
> 
> 时间：2008-09-18T19:53:51.320
> 
> 标签：java, web-applications, tomcat, jakarta-ee

我创建了一个 Web 应用程序 (WAR) 并将其部署在 Tomcat 上。在*webapp*中有一个带有表单的页面，管理员可以在其中输入一些配置数据。我不想将这些数据存储在 DBMS 中，而只是存储在文件系统上的 XML 文件中。放在哪里？

我想将文件放在部署应用程序本身的目录树中的某个位置。我的配置文件应该在*WEB-INF*目录中吗？还是放在别的地方？

在 servlet 中使用什么 Java 代码来查找目录的绝对路径？或者可以通过相对路径访问它吗？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-09-18T20:15:24.000

我们所做的是将它放在服务器上的单独目录中（您可以使用 /config、/opt/config、/root/config、/home/username/config 或任何您想要的东西）。当我们的 servlet 启动时，它们读取 XML 文件，从中获取一些东西（最重要的是 DB 连接信息），仅此而已。

我问为什么我们这样做了一次。

将所有内容存储在数据库中会很好，但显然您不能将数据库连接信息存储在数据库中。

您可以在代码中硬编码一些东西，但这很丑陋，原因有很多。如果信息必须更改，您必须重新构建代码并重新部署。如果有人获得了您的代码或 WAR 文件的副本，他们就会获得该信息。

把东西放在 WAR 文件中看起来不错，但如果你想改变很多东西，那可能是个坏主意。问题是，如果您必须更改信息，那么下次重新部署时它将覆盖文件，因此您不记得在 WAR 内置版本中更改的任何内容都会被遗忘。

文件系统中特殊位置的文件对我们来说非常有效。它没有任何大的缺点。你知道它在哪里，它是单独存储的，如果它们都需要不同的配置值（因为它不是 WAR 的一部分），那么可以很容易地部署到多台机器上。

我能想到的唯一其他可行的解决方案是将除了数据库登录信息之外的所有内容都保存在数据库中。这将来自通过 JVM 检索的 Java 系统属性。这是上面 Hans Doggen 提到的 Preferences API 的东西。我不认为它在我们的应用程序第一次开发时就已经存在，如果它没有被使用的话。

至于访问配置文件的路径，只是文件系统上的一个文件。您无需担心网络路径。因此，当您的 servlet 启动时，它只需在“/config/myapp/config.xml”（或其他）打开文件，它就会找到正确的东西。只是硬编码这个路径对我来说似乎是无害的。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-18T20:19:45.050

WEB-INF 是放置配置文件的好地方。这是一些从 servlet 获取目录的绝对路径的代码。

```
public void init(ServletConfig servletConfig) throws ServletException{
    super.init(servletConfig);
    String path = servletConfig.getServletContext().getRealPath("/WEB-INF") 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-18T20:29:48.660

将它放入`WEB-INF`将隐藏试图通过 URL 直接访问它的用户的 XML 文件，所以是的，我会说把它放入`WEB-INF`.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-18T19:57:34.977

我不会将它存储在应用程序文件夹中，因为这会用应用程序的新部署覆盖配置。

我建议你看看 Preferences API，或者在 users 文件夹（运行 Tomcat 的用户）中写一些东西。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-18T19:57:38.597

答案取决于您打算如何读取和写入该配置文件。

例如，Spring 框架让您能够[使用 XML 配置文件](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#beans-factory-instantiation)（或 Java 属性文件）；这些可以存储在您的类路径中（例如，在 WEB-INF 目录中）、文件系统上的任何其他位置，甚至内存中。如果您为此使用 Spring，那么存储配置文件最简单的位置是在您的 WEB-INF 目录中，然后使用 Spring 的[ClassPathXmlApplicationContext](http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/context/support/ClassPathXmlApplicationContext.html)类来访问您的配置文件。

但同样，这完全取决于您计划如何访问该文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T19:58:21.840

如果它是您的自定义配置 WEB-INF 是一个好地方。但是有些库可能需要配置驻留在 WEB-INF/classes 中。

# list - 如何附加到方案中的 alist？

> ID：96249
> 
> 赞同：5
> 
> 时间：2008-09-18T19:54:09.137
> 
> 标签：list, lisp, scheme, associative

将元素添加到 alist（关联列表）的头部非常简单：

```
> (cons '(ding . 53) '((foo . 42) (bar . 27)))
((ding . 53) (foo . 42) (bar . 27)) 
```

不过，附加到 alist 的尾部有点棘手。经过一些实验，我制作了这个：

```
> (define (alist-append alist pair) `(,@alist ,pair))
> (alist-append '((foo . 42) (bar . 27)) '(ding . 53))
'((foo . 42) (bar . 27) (ding . 53)) 
```

但是，在我看来，这不是惯用的解决方案。那么这通常是如何在方案中完成的呢？或者这实际上是这样的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T20:45:37.513

Common Lisp 专门为此目的定义了一个名为[ACNS](http://www.lispworks.com/documentation/HyperSpec/Body/f_acons.htm)的函数，其中

```
(acons key value alist) 
```

相当于：

```
(cons (cons key value) alist) 
```

这有力地表明，简单地向 alist 妥协是惯用的。请注意，这意味着两件事：

1.  由于搜索通常从前向后执行，因此最近添加的关联优先于旧关联。这可以用于词汇和动态环境的简单实现。
2.  虽然进入列表是 O(1)，但附加通常是 O(n)，其中 n 是列表的长度，因此惯用用法最有利于性能，并且在风格上更可取。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T20:21:08.710

您不会附加到一个列表。你在一个名单上。

a-list 在逻辑上是一组关联。您不关心集合中元素的顺序。您所关心的只是特定元素的存在与否。在 a-list 的情况下，您关心的只是给定标签是否存在关联（即，其 CAR 是指定值的对），以及给定该关联，关联值（即，在此实施，对的 CDR）。

# visual-studio - 我可以创建 Visual Studio 宏以在调试器中启动特定项目吗？

> ID：96250
> 
> 赞同：5
> 
> 时间：2008-09-18T19:54:09.900
> 
> 标签：visual-studio, visual-studio-2008, macros

我的项目在同一个解决方案文件中同时包含客户端和服务器组件。我通常将调试器设置为在调试时一起启动它们，但通常情况下我在调试器之外启动服务器，以便在仅处理客户端的东西时根据需要启动和停止客户端。（这要快得多）。

我试图为自己省去在解决方案资源管理器中四处寻找以启动单个项目的麻烦，而宁愿在工具栏上粘贴一个按钮，该按钮调用一个启动单个项目的调试器的宏（同时将“F5”类型调试单独保留到启动两个进程）。

我尝试录制，但这并没有真正产生任何有用的结果。

到目前为止，我所做的就是在解决方案资源管理器中找到项目项：

```
 Dim projItem As UIHierarchyItem

 projItem = DTE.ToolWindows.SolutionExplorer.GetItem("SolutionName\ProjectFolder\ProjectName").Select(vsUISelectionType.vsUISelectionTypeSelect) 
```

（这大致基于宏记录器如何尝试执行此操作。我不确定导航 UI 对象模型是否是正确的方法，或者我是否应该考虑通过解决方案/项目对象模型）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T20:21:16.370

行。如果加载了解决方案，这似乎适用于大多数 UI（全部？）上下文：

```
 Sub DebugTheServer()
    DTE.Windows.Item(Constants.vsWindowKindSolutionExplorer).Activate()
    DTE.ActiveWindow.Object.GetItem("Solution\ServerFolder\ServerProject").Select(vsUISelectionType.vsUISelectionTypeSelect)
    DTE.Windows.Item(Constants.vsWindowKindOutput).Activate()
    DTE.ExecuteCommand("ClassViewContextMenus.ClassViewProject.Debug.Startnewinstance")
 End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-29T05:03:54.090

从 C# 加载项中，以下内容对我有用：

```
Dte.Windows.Item(Constants.vsWindowKindSolutionExplorer).Activate();
Dte.ToolWindows.SolutionExplorer.GetItem("SolutionName\\SolutionFolderName\\ProjectName").Select(vsUISelectionType.vsUISelectionTypeSelect); 
```

# windows - 将文件从一个目录复制到另一个目录的批处理文件

> ID：96264
> 
> 赞同：1
> 
> 时间：2008-09-18T19:55:33.547
> 
> 标签：windows, batch-file

我有一个应用程序的两个代码库。我需要将所有带有 .java 的目录中的所有文件从较新的代码库复制到较旧的代码库（这样我就可以将其提交给 svn）。

我怎样才能写一个批处理文件来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T19:56:47.617

XCOPY /D ?

```
xcopy c:\olddir\*.java c:\newdir /D /E /Q /Y 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T20:02:59.643

如果您要解决这个问题的许多不同实例，我已经在[Apache Ant](http://ant.apache.org/)上取得了一些成功，用于这种复制/更新/备份之类的事情。

但是，有*一点*学习曲线，并且*确实*需要您安装 Java 运行时环境。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T20:08:01.253

我喜欢[Robocopy](http://en.wikipedia.org/wiki/Robocopy)（“强大的文件复制”）。它是一个命令行目录复制命令。它作为 Windows 资源工具包的一部分提供，并作为 Windows Vista 和 Windows Server 2008 的标准功能引入。

# iphone - 除了使用 NSTimer 之外，在 iPhone 上创建游戏循环还有什么更好的方法？

> ID：96265
> 
> 赞同：23
> 
> 时间：2008-09-18T19:55:35.183
> 
> 标签：iphone, objective-c, cocoa

我正在 iPhone 上编写游戏。我目前正在使用 NSTimer 来触发我的游戏更新/渲染。这个问题是（在分析之后）我似乎在更新/渲染之间失去了很多时间，这似乎主要与我插入 NSTimer 的时间间隔有关。

所以我的问题是使用 NSTimer 的最佳选择是什么？

请每个答案另一种选择。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-22T08:35:14.303

您可以使用线程获得更好的性能，请尝试以下操作：

```
- (void) gameLoop
{
    while (running)
    {
        NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
        [self renderFrame];
        [pool release];
    }
}

- (void) startLoop
{
    running = YES;
#ifdef THREADED_ANIMATION
    [NSThread detachNewThreadSelector:@selector(gameLoop)
    toTarget:self withObject:nil];
#else
    timer = [NSTimer scheduledTimerWithTimeInterval:1.0f/60
    target:self selector:@selector(renderFrame) userInfo:nil repeats:YES];
#endif
}

- (void) stopLoop
{
    [timer invalidate];
    running = NO;
} 
```

在`renderFrame`方法中，您准备帧缓冲区、绘制帧并在屏幕上显示帧缓冲区。（PS 有一篇很棒的[文章](http://dewitters.koonsolo.com/gameloop.html)介绍了各种类型的游戏循环及其优缺点。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T07:58:51.163

我不特别了解 iPhone，但我仍然可以提供帮助：不要简单地在循环结束时插入固定延迟，而是使用以下命令：

*   确定一个您会满意的刷新间隔，该间隔大于单次通过主循环。
*   在循环开始时，获取任何可用分辨率的当前时间戳并将其存储。
*   在循环结束时，获取另一个时间戳，并确定自上一个时间戳以来经过的时间（在循环之前初始化它）。
*   睡眠/延迟，以获得理想的帧时间与该帧已经经过的时间之间的差异。
*   在下一帧，您甚至可以通过与前一个循环开始时的时间戳进行比较来尝试补偿睡眠间隔中的不准确性。存储差异并在此循环结束时从睡眠间隔中添加/减去它（睡眠/延迟可能会太长或太短）。

您可能希望有一个警报机制，让您知道您的时间是否太紧（即，如果您在所有补偿后的睡眠时间小于 0，这意味着您需要更多的时间来处理您的帧速率允许）。效果将是您的游戏速度变慢。对于额外的点，如果您检测到这种情况发生，您可能希望简化渲染一段时间，直到您再次有足够的备用容量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-29T13:14:04.623

使用CADisplayLink，你可以在XCODE中提供的OpenGL ES模板项目中找到如何（从这个模板开始创建一个项目，看看EAGLView类，这个例子是基于open GL的，但是你只能将CADisplayLink用于其他一种游戏

# c - 如何拦截编辑框中的粘贴事件？

> ID：96271
> 
> 赞同：1
> 
> 时间：2008-09-18T19:56:48.940
> 
> 标签：c, winapi, edit-control

如何拦截编辑框中的粘贴事件，可能在值传输到对象之前？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T20:01:24.033

查找[子类 windows](http://msdn.microsoft.com/en-us/library/ms997565.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T20:04:04.073

如果您子类化然后拦截 WM_PASTE 消息，您可以做任何您想做的事，丢弃消息以防止粘贴，操作剪贴板数据，等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T20:04:42.887

子类化编辑框并处理 WM_PASTE 消息。

# c# - 在 C# 中临时加载 SSL 客户端密钥以进行客户端身份验证

> ID：96276
> 
> 赞同：1
> 
> 时间：2008-09-18T19:57:40.810
> 
> 标签：c#, .net, http, ssl, .net-2.0

我正在使用 WebBrowser 控件将 WebInterface 添加到 C# 应用程序。我的愿望是验证只有这样的应用程序才能使用 SSL 客户端证书连接到我们的 Web 服务器。

我的想法是将客户端证书嵌入到应用程序中，并在通过我的应用程序连接时使用。有人对如何做到这一点有建议吗？或者让它工作的唯一方法是在 X509Store 中加载密钥。

如果我把它放在 X509Store 中，它会让我的密钥可用于一般 Internet Explorer 使用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T18:12:33.390

所以，这里有几个想法：

## 1.

我同意 'erickson' 的观点，确认只有您的应用程序可以与应用程序通信，这在您当前的设计中几乎是不可能的。有人对您的应用程序进行逆向工程师然后游戏结束只是时间问题（如果那是您唯一的安全形式）。如果您想验证它是您的应用程序和有效用户，那么您需要对用户进行身份验证以及检查相关应用程序签名的某种机制（我认为这在客户端-服务器模型中是不可能的。 ..毕竟我总是可以撒谎说我的“hackyou”应用程序与你的“realapp”具有相同的签名，你无法从服务器端验证）

## 2.

请记住，WebBrowser 控件本质上是 IE 的包装器，因此如果没有一些技巧（我将在几秒钟内了解），您将不得不将证书添加到用户存储中。

## 3.

这是完成您所要求的事情的一种hacky方法（即使这是一个坏主意）：

*   首先使用[WebRequest.Create](http://msdn.microsoft.com/en-us/library/system.net.webrequest.create.aspx)创建一个 HttpWebRequest 对象
*   从文件或程序中编码的二进制流中手动加载 X509Certificate2 对象
*   使用[HttpWebRequest.ClientCertificates](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.clientcertificates.aspx)将您的证书添加到 webrequest
*   发送请求，得到响应
*   通过将 HttpWebResponse 的 ResponseStream 推送到 WebBrowser 的 DocumentStream 来向 WebBrowser 发送响应

这实质上意味着您必须编写一些包装类来处理与服务器之间的请求和响应，并且只使用 WebBrowser 来处理 HTML 的查看。

**实际上，您需要重新设计并查看您要处理的威胁！**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T21:05:58.307

你确定这是你想做的吗？如果您将私钥嵌入到您的应用程序中（根据您的方法），攻击者可以提取它并使用它来验证他们的流氓软件。

服务器无法验证客户端软件。它只能测试客户端是否拥有某些秘密。当您在客户端中嵌入私钥并分发它时，它就不再是秘密了。

我建议对您的软件的*用户*进行身份验证，而不是对软件本身进行身份验证。您需要让用户生成自己的秘密，无论是密码还是私钥，并给予他们保护它的动力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T21:23:41.353

使用密钥的目的与其说是验证用户，不如说是限制对应用程序用户的访问，而不是使用任何 WebBrowser。这是公共互联网上的一种内部网行为。

这是一个穷人的 DRM。人们提取密钥造成的损失并不那么重要。我认为发生这种情况的风险很低，我们可以松懈的可能性很小。

不过，如果有任何其他想法将 WebServer 的访问权限仅限于应用程序的用户，我愿意接受任何建议。基本上，我现在的愿望是拥有一个公开的 WebServer，任何人都可以阅读，但是从不同的地方通过公共网络访问是必要的，因此建立 Intranet 基础设施也是不可能的。

# .net - Visual Studio：检测不需要的程序集

> ID：96279
> 
> 赞同：13
> 
> 时间：2008-09-18T19:58:18.580
> 
> 标签：.net, visual-studio

在较大和/或长期运行的项目中，我倾向于引用许多程序集和名称空间，并且我经常最终会在以后删除某些功能或将其移至不同的项目中。

我只是想知道，有没有办法检查我的整个 Visual Studio 解决方案中的每个项目（哎呀，每个 .cs 文件），并获取所有引用的程序集和命名空间的列表，这些程序集和命名空间实际上没有被使用并且可以安全地删除？我知道 ReSharper 可以为单个代码文件执行此操作，但我没有看到检查所有文件或检查不需要的程序集的选项。

如果重要，请使用 Visual Studio 2005 和 2008 Professional。

编辑：到目前为止谢谢。ReSharper 或“如果构建中断则删除并读取”的问题在于，每个文件和程序集都非常乏味（我的项目在 7 个程序集中有大约 120 个 .cs 文件，并且在解决方案之外总共引用了 18 个程序集），所以理想情况下，我正在寻找“一键式”的东西。一些可用于构建脚本生成报告的自动方式的大奖励积分:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T19:59:42.600

[Resharper](http://www.jetbrains.com/resharper/)将为您执行此操作，您可以在 Clean Code 选项中进行设置，您可以在整个解决方案范围内运行；o)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T10:21:04.653

如果您有 ReSharper，请选择解决方案，右键单击并选择清理代码。然后，Resharper 将遍历解决方案中的每个代码文件。

至于删除项目引用，当编译器运行时，如果没有代码使用该 dll，它将不会添加引用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T20:04:50.060

如果您安装了 ReSharper，则可以在解决方案资源管理器中右键单击参考，然后单击**Find Dependent Code**。如果它返回结果对话框，那么您正在使用该引用/程序集。如果您收到消息“未找到依赖于模块*模块名称的代码”。*那么您应该可以删除该引用/程序集，因为它没有被使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-23T07:23:35.960

[（从这里](https://stackoverflow.com/questions/81597/remove-unused-references-using-visual-studio)交叉发布）鉴于 VisualStudio（或者它是 msbuild？）检测到未使用的引用并且不将它们包含在输出文件中，您可以编写一个脚本来解析 csproj 中的引用，并将其与通过项目输出的反射检测到的引用程序集。

如果你有动力...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-10T23:08:15.437

我在 Google 中搜索并寻找从我的代码中删除未使用的“使用”语句的方法时发现了这个问题。

重构很棒，但它对我不可用。然而，事实证明，Visual Studio 2008 是自己做的。

以下是步骤：

1.  在 Visual Studio 中加载代码。
2.  右键单击代码页上的任意位置。
3.  从菜单中单击“组织使用”。
4.  单击“删除未使用的使用”

完毕。我意识到这并不能回答最初的问题（为整个项目集体做这个），但它确实回答了我的问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-11-13T14:01:56.437

删除未使用的引用是 Visual Studio 2008 已经支持的功能。不幸的是，仅适用于 VB .NET 项目。

我已经在 Microsoft Connect 上提出了一项建议，以便为 C# 项目获取此功能：

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=510326](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=510326)

如果你也喜欢这个功能，那么你可以投票给我的建议。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T20:16:17.193

正如之前的回复所提到的，[Resharper](http://www.jetbrains.com/resharper/)非常适合这种情况以及各种其他情况，例如使代码更清晰并为您生成某些东西的方法。真正了解 Resharper 的所有优势的最佳方法是下载试用版，打印出[Keymap Cheatsheet](http://www.jetbrains.com/resharper/docs/ReSharper40DefaultKeymap.pdf)并将其贴在您正在开发的地方。

长话短说，它确实解决了这个问题，但它的作用远不止于此。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T20:03:58.190

任何体面的代码分析器都会为您执行此操作。我个人喜欢 DevPartner。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T21:13:38.150

它不会删除代码中对您引用的程序集的任何引用（我认为），但是您可以转到每个项目的属性，转到引用，然后单击“未使用的引用...”。然后，Visual Studio 为您提供了在此处删除它们的选项。

虽然没有办法在解决方案级别做到这一点。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-18T19:59:37.063

是的，我不认为有一个。我只是删除了一些我认为不需要的然后构建：/

顺便提一句。这将继续使用错误。您可以使用[Visual Studio Power 命令](http://www.visualstudiogallery.com/ExtensionDetails.aspx?ExtensionID=df3f0c30-3d37-4e06-9ef8-3bff3508be31)来删除和排序使用，所以先这样做，然后删除随机程序集：D

# c++ - 在 C++ 中我无法掌握指针和类

> ID：96285
> 
> 赞同：8
> 
> 时间：2008-09-18T19:58:50.123
> 
> 标签：c++, class, pointers

我刚从大学毕业，已经在 C++ 中工作了一段时间。我了解并使用 C++ 的所有基础知识，但我很难掌握更高级的主题，例如指针和类。我已经阅读了一些书籍和教程，并且理解了其中的示例，但是当我查看一些高级的现实生活示例时，我无法弄清楚它们。这让我很生气，因为我觉得它让我无法将我的 C++ 编程提升到一个新的水平。其他人有这个问题吗？如果是这样，你是如何突破的？有谁知道任何真正描述指针和类概念的书籍或教程？或者可能是一些使用高级指针和类技术的具有良好描述性注释的示例代码？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-18T20:05:57.563

指针和类在 C++ 中并不是真正的高级主题。它们非常基础。

对我来说，当我开始用箭头绘制方框时，指针就凝固了。为 int 画一个框。int* 现在是一个单独的盒子，带有一个指向 int 盒子的箭头。

所以：

```
int foo = 3;           // integer
int* bar = &foo;       // assigns the address of foo to my pointer bar 
```

使用我的指针框（栏），我可以选择查看框内的地址。（这是 foo 的内存地址）。或者我可以操纵我有地址的任何东西。这种操作意味着我沿着那个箭头指向整数（foo）。

```
*bar = 5;  // asterix means "dereference" (follow the arrow), foo is now 5
bar = 0;   // I just changed the address that bar points to 
```

课程完全是另一个话题。有一些关于面向对象设计的书籍，但我不知道适合初学者的书籍。一本介绍 Java 的书可能会让您很幸运。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-09-19T01:03:57.753

理解 C/C++ 中的指针

在了解指针的工作原理之前，有必要了解变量在程序中是如何存储和访问的。每个变量都有 2 个部分 - (1) 存储数据的内存地址和 (2) 存储数据的值。

内存地址通常称为变量的左值，而存储的数据的值称为右值（l 和 r 表示左右）。

考虑以下声明：

```
int x = 10; 
```

在内部，程序将内存地址与变量 x 相关联。在这种情况下，我们假设程序分配 x 驻留在地址 1001（不是实际地址，但为简单起见选择）。因此，x 的左值（内存地址）为 1001，x 的右值（数据值）为 10。

只需使用变量“x”即可访问右值。为了访问左值，需要“地址”运算符（'&'）。表达式'&x'被读作“x的地址”。

```
Expression          Value
----------------------------------
x                   10
&x                  1001 
```

x 中存储的值可以随时更改（例如 x = 20），但 x (&x) 的地址永远不能更改。

指针只是一个变量，可用于修改另一个变量。它通过为其右值设置一个内存地址来做到这一点。也就是说，它指向内存中的另一个位置。

创建指向“x”的指针如下：

```
int* xptr = &x; 
```

“int*”告诉编译器我们正在创建一个指向整数值的指针。“= &x”部分告诉编译器我们将 x 的地址分配给 xptr 的右值。因此，我们告诉编译器 xptr “指向” x。

假设 xptr 分配给内存地址 1002，那么程序的内存可能如下所示：

```
Variable    lvalue    rvalue
--------------------------------------------
x           1001      10   
xptr        1002      1001 
```

下一个难题是“间接运算符”（'*'），其用法如下：

```
int y = *xptr; 
```

间接操作符告诉程序将 xptr 的右值解释为内存地址而不是数据值。也就是说，程序查找存储在 xptr (1001) 提供的地址处的数据值 (10)。

把它们放在一起：

```
Expression      Value
--------------------------------------------
x                   10
&x                  1001
xptr                1001
&xptr               1002
*xptr               10 
```

现在已经解释了这些概念，这里有一些代码来演示指针的强大功能：

```
int x = 10;
int *xptr = &x;

printf("x = %d\n", x);
printf("&x = %d\n", &x);        
printf("xptr = %d\n", xptr);
printf("*xptr = %d\n", *xptr);

*xptr = 20;

printf("x = %d\n", x);
printf("*xptr = %d\n", *xptr); 
```

对于输出，您会看到（注意：内存地址每次都会不同）：

```
x = 10
&x = 3537176
xptr = 3537176
*xptr = 10
x = 20
*xptr = 20 
```

注意给'*xptr'赋值如何改变'x'的值。这是因为 '*xptr' 和 'x' 指的是内存中的相同位置，正如 '&x' 和 'xptr' 具有相同的值所证明的那样。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-18T20:05:23.507

[这个链接](http://cslibrary.stanford.edu/104/)有一个视频，描述了指针是如何工作的，使用粘土化。内容丰富，易于消化。

[这个页面](http://parashift.com/c++-faq-lite/classes-and-objects.html)有一些关于类基础的​​很好的信息。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-18T20:03:24.043

我曾经有一个问题，以帕斯卡的方式理解指针 :) 一旦我开始做汇编程序指针真的是访问内存的唯一方法，它只是打击了我。这听起来可能有点遥远，但尝试汇编程序（尝试了解计算机的真正含义总是一个好主意）可能会教你一些指导。课程——我不明白你的问题——你的学校教育是纯结构化编程吗？类只是查看现实生活模型的一种合乎逻辑的方式 - 您正在尝试解决一个可以总结为多个对象/类的问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-18T20:04:45.490

指针和类是完全不同的主题，所以我不会像这样把它们混为一谈。在这两者中，我会说指针更为基础。

了解什么是指针的一个很好的练习如下：

1.  创建一个链表
2.  从头到尾遍历它
3.  反转它，使头部现在是背部，背部现在是头部

首先在白板上完成所有操作。如果您可以轻松地做到这一点，那么您在理解什么是指针时应该不会再有问题了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T20:13:54.470

在其他答案中似乎已经解决了指针（没有双关语）。

类是面向对象的基础。我在 OO 方面遇到了巨大的麻烦——就像十年的失败尝试一样。最终帮助我的书是 Craig Larman 的“应用 UML 和模式”。我知道这听起来好像是关于不同的东西，但它确实很好地让你进入了类和对象的世界。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T20:16:31.093

我们只是在午餐时讨论了 C++ 和 OO 的一些方面，有人（实际上是一位伟大的工程师）说除非你在学习 C++ 之前有非常强大的编程背景，否则它会毁了你。

我强烈建议先学习另一种语言，然后在需要时转向 C++。指针并没有什么好东西，它们只是当编译器在没有它们的情况下很难将操作有效地转换为汇编时遗留下来的一块。

如今，如果编译器不能更好地优化数组操作，那么您可以使用指针，那么您的编译器就会损坏。

请不要误会我的意思，我并不是说 C++ 很糟糕或其他任何东西，也不想开始宣传讨论，我已经使用它并且现在偶尔使用它，我只是建议你从其他东西开始.

这真的不像学习驾驶手动汽车然后轻松地将其应用到自动驾驶汽车上，它更像是学习驾驶那些巨大的建筑起重机然后假设当你开始驾驶汽车时会适用 - 然后你发现自己在开着应急灯的情况下以 5 英里/小时的速度在马路中间开着车。

[编辑] 回顾最后一段——我认为这可能是我有史以来最准确的类比！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T20:59:04.470

对于指针和类，这是我的类比。我会用一副纸牌。一副牌有面值和类型（红桃 9、黑桃 4 等）。因此，在我们类似 C++ 的“Deck of Cards”编程语言中，我们会说以下内容：

```
HeartCard card = 4; // 4 of hearts! 
```

现在，您知道红桃 4 的位置了，因为天哪，您拿着牌，正面朝上，牌在顶部！所以关于其余的牌，我们只会说红心 4 是在 BEGINNING。所以，如果我在开始时问你是什么牌，你会说，“当然是红心 4！”。好吧，你只是“指向”我卡片所在的位置。在我们的“Deck of Cards”编程语言中，你也可以这样说：

```
HeartCard card = 4; // 4 of hearts!
print &card // the address is BEGINNING! 
```

现在，把你的牌翻过来。背面现在开始，你不知道卡是什么。但是，假设您可以随心所欲地制作它，因为您充满了魔力。让我们用我们的“纸牌”语言来做这件事吧！

```
HeartCard *pointerToCard = MakeMyCard( "10 of hearts" );
print pointerToCard // the value of this is BEGINNING!
print *pointerToCard // this will be 10 of hearts! 
```

好吧，MakeMyCard（“红桃 10”）是你在施展你的魔法，并且知道你想指向 BEGINNING，让卡片成为红桃 10！你把你的卡翻过来，瞧！现在，* 可能会让你失望。如果是这样，请检查一下：

```
HeartCard *pointerToCard = MakeMyCard( "10 of hearts" );
HeartCard card = 4; // 4 of hearts!
print *pointerToCard; // prints 10 of hearts
print pointerToCard; // prints BEGINNING
print card; // prints 4 of hearts
print &card; // prints END - the 4 of hearts used to be on top but we flipped over the deck! 
```

至于类，我们在示例中通过将类型定义为 HeartCard 来使用类。我们知道 HeartCard 是什么……这是一张具有价值和心型的卡片！因此，我们将其归类为 HeartCard。每种语言都有类似的方式来定义或“分类”你想要的东西，但它们都有相同的概念！希望这有帮助...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T20:35:09.753

In a sense, you can consider "pointers" to be one of the two most fundamental types in software - the other being "values" (or "data") - that exist in a huge block of uniquely-addressable memory locations. Think about it. Objects and structs etc don't really exist in memory, only values and pointers do. In fact, a pointer is a value too....the value of a memory address, which in turn contains another value....and so on.

So, in C/C++, when you declare an "int" (intA), you are defining a 32bit chunk of memory that contains a value - a number. If you then declare an "int pointer" (intB), you are defining a 32bit chunk of memory that contains the address of an int. I can assign the latter to point to the former by stating "intB = &intA", and now the 32bits of memory defined as intB, contains an address corresponding to intA's location in memory.

When you "dereference" the intB pointer, you are looking at the address stored within intB's memory, finding that location, and then looking at the value stored there (a number).

Commonly, I have encountered confusion when people lose track of exactly what it is they're dealing with as they use the "&", "*" and "->" operators - is it an address, a value or what? You just need to keep focused on the fact that memory addresses are simply locations, and that values are the binary information stored there.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T20:02:09.817

对于指针：

我发现[这篇文章](https://stackoverflow.com/questions/92001/whats-this-obsession-with-pointers)对指针进行了非常深思熟虑的讨论。也许这会有所帮助。你熟悉 C# 中的引用吗？那实际上*是指*别的东西？这可能是理解指针的良好开端。

另外，请查看下面 Kent Fredric 的帖子，以另一种方式向您介绍指针。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T20:03:57.270

要理解指针，我不能高度推荐[K&R](https://rads.stackoverflow.com/amzn/click/com/0131103628)书。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-18T20:11:36.770

对我有启发的书是Donald Alcock 的[Illustrating Ansi C。](http://www.amazon.co.uk/Illustrating-Ansi-Iso-Versio-Version/dp/0521468213/ref=sr_1_3?ie=UTF8&s=books&qid=1221768473&sr=8-3)它充满了手绘风格的方框和箭头图，说明了指针、指针算术、数组、字符串函数等......

显然它是一本“C”书，但核心基础知识很难被击败

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-18T20:12:47.610

来自 lassevek[对 SO 上类似问题](https://stackoverflow.com/questions/5727/understanding-pointers#5754)的回答：

> 指针是一个概念，很多人一开始可能会感到困惑，特别是在复制指针值并仍然引用同一个内存块时。
> 
> 我发现最好的类比是将指针视为一张纸，上面有房子地址，它引用的内存块是实际房子。因此可以很容易地解释各种操作：
> 
> *   复制指针值，把地址写在新纸上
> *   链接列表，房子里的一张纸，上面有下一个房子的地址
> *   释放内存，拆房子，抹掉地址
> *   内存泄露，纸丢了找不到房子
> *   释放内存但保留一个（现在无效的）引用，拆除房子，擦除其中一张纸，但有另一张带有旧地址的纸，当你去地址时，你不会找到房子，但你可能会发现一些类似于某人的废墟的东西
> *   缓冲区溢出，你把更多的东西搬进房子里，超出了你的承受能力，溢出到邻居的房子里

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-18T20:18:32.027

学习汇编语言，然后学习 C。然后你就会知道机器的基本原理是什么（以及前面的指针）。

指针和类是 C++ 的基本方面。如果你不理解它们，那意味着你并不真正理解 C++。

就我个人而言，我在 C++ 上坚持了几年，直到我觉得我牢牢掌握了 C 以及汇编语言的幕后情况。虽然这是很久以前的事了，但现在我认为了解计算机如何在低层次上工作确实对我的职业生涯有益。

学习编程可能需要很多年，但你应该坚持下去，因为这是一个非常有价值的职业。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-18T20:24:58.733

没有什么可以代替练习。

通读一本书或听一场讲座很容易，感觉就像你正在关注正在发生的事情。

我建议采用一些代码示例（我假设您将它们放在磁盘上的某个地方），编译并运行它们，然后尝试更改它们以执行不同的操作。

*   将另一个子类添加到层次结构
*   向现有类添加方法
*   将向前遍历集合的算法更改为向后迭代。

我认为没有任何“灵丹妙药”的书可以做到这一点。

对我来说，指针的含义是在汇编中工作，并且看到指针实际上只是一个地址，并且拥有一个指针并不意味着它指向的是一个有意义的对象。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-22T16:42:58.100

就课程而言，我掌握了三种真正帮助我跳入真正的面向对象编程的技术。

第一个是我在一个游戏项目中大量使用类和对象，大量使用泛化（kind-of 或 is-a 关系，例如，学生是一种人）和组合（has-a 关系，例如，学生有学生贷款）。分解这段代码需要做很多工作，但确实让事情变得清晰起来。

帮助的第二件事是在我的系统分析课程中，我必须在其中制作 http://www.agilemodeling.com/artifacts/classDiagram.htm">UML 类图。我刚刚发现的这些帮助我理解了类的结构在一个程序中。

最后，我帮助指导我大学的学生编程。关于这一点，我真正能说的是，通过教学和了解其他人解决问题的方法，你会学到很多东西。很多时候，一个学生会尝试我从未想过的事情，但通常很有意义，他们只是在实施他们的想法时遇到了问题。

我最好的建议是它需要大量的练习，而且你编程的越多，你就越能理解它。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-18T20:45:39.247

你读过 Bjarne Stroustrup 的*The C++ Programming Language*吗？他创建了 C++。

C++ FAQ Lite 也不错。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-18T20:32:23.833

The point at which I really got pointers was coding TurboPascal on a FatMac (around 1984 or so) - which was the native Mac language at the time.

The Mac had an odd memory model whereby when allocated the address the memory was stored in a pointer on the heap, but the location of that itself was not guaranteed and instead the memory handling routines returned a pointer to the pointer - referred to as a handle. Consequently to access any part of the allocated memory it was necessary to dereference the handle twice. It took a while, but constant practice eventually drove the lesson home.

Pascal's pointer handling is easier to grasp than C++, where the syntax doesn't help the beginner. If you are really and truly stuck understanding pointers in C then your best option might be to obtain a copy a a Pascal compiler and try writing some basic pointer code in it (Pascal is near enough to C you'll get the basics in a few hours). Linked lists and the like would be a good choice. Once you're comfortable with those return to C++ and with the concepts mastered you'll find that the cliff won't look so steep.

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-21T21:08:52.853

Your problem seems to be the C core in C++, not C++ itself. Get yourself the Kernighan & Ritchie (*The C Programming Language*). Inhale it. It's very good stuff, one of the best programming language books ever written.

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-18T20:01:54.467

假装一个指针是一个数组地址。

```
x = 500; // memory address for hello;
MEMORY[x] = "hello"; 
print  MEMORY[x]; 
```

这是一个图形过度简化，但在大多数情况下，只要您不想知道该数字是什么或手动设置它就可以了。

当我了解 CI 有一些宏时，我或多或少地允许您使用指针，就像它们*是*内存中的数组索引一样。但我早就丢失了那个代码，也早就忘记了。

我记得它开始于

```
#define MEMORY 0; 
#define MEMORYADDRESS( a ) *a; 
```

而这本身几乎没有用。希望其他人可以扩展该逻辑。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-18T20:03:57.363

我读过的关于这些主题的最好的书是 Bruce Eckel 的 Thinking in C++。[你可以在这里](http://www.mindview.net/Books/TICPP/ThinkingInCPP2e.html)免费下载。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-09-18T20:10:35.803

对于课程：

对我来说，突破的时刻是我了解了接口。抽象出你如何解决问题的细节，并只给出与类交互的方法列表的想法非常有见地。

事实上，我的教授明确告诉我们，他会通过将我们的课程插入到他的测试工具中来对我们的程序进行评分。评分将根据他给我们的要求以及程序是否崩溃来进行。

长话短说，类可以让你封装功能并以更简洁的方式调用它（大多数时候，总会有例外）

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-09-18T20:12:30.137

真正帮助我理解这些概念的一件事是学习 UML——统一建模语言。以图形格式查看面向对象设计的概念确实帮助我了解了它们的含义。有时试图仅仅通过查看实现它们的源代码来理解这些概念可能很难理解。

以图形形式查看诸如继承之类的面向对象范例是理解该概念的一种非常有效的方法。

Martin Fowler 的*UML Distilled*是一个很好的简短介绍。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-18T20:12:47.717

我认为，为了更好地理解指针，看看汇编语言如何处理指针可能会很有用。指针的概念实际上是汇编语言和 x86 处理器指令体系结构的基本部分之一。也许它会让你觉得指针是程序的自然组成部分。

至于类，除了 OO 范式之外，我认为从低级二进制的角度来看类可能会很有趣。在基本层面上，它们在这方面并没有那么复杂。

如果您想更好地了解 C++ 对象模型下的内容，可以阅读[深入了解 C++ 对象模型。](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.amazon.com%2FInside-Object-Model-Stanley-Lippman%2Fdp%2F0201834545&ei=FLnSSO2ZLp3uQont5IkK&usg=AFQjCNFzPwXc6GMJqD9y17GTJKczXltwGg&sig2=98ty8nCVp0qJCSplwp0IDQ)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-18T20:24:25.380

类比较容易掌握；OOP 可能需要你很多年。就个人而言，直到去年我才完全掌握真正的 OOP。Smalltalk 在大学中没有应有的普及，这太糟糕了。它确实使人们明白 OOP 是关于对象交易消息的观点，而不是类是具有函数的自包含全局变量。

如果你真的不熟悉课程，那么这个概念可能需要一段时间才能掌握。当我在 10 年级第一次遇到他们时，直到有人知道他们在做什么，我才明白他们在做什么，并解释了发生了什么。这就是我建议你尝试的方法。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-09-18T22:25:57.710

您可能会发现[Joel 的这篇文章很有](http://www.joelonsoftware.com/articles/ThePerilsofJavaSchools.html)启发性。顺便说一句，如果你已经“在 C++ 中工作了一段时间”并且已经从 CS 毕业，那么你可能已经上过 JavaSchool（我认为你根本没有在 C++ 中工作；你已经一直在 C 中工作，但使用 C++ 编译器）。

此外，为了支持 hojou 和 nsanders 的答案，指针对于 C++ 来说是非常基础的。如果您不了解指针，那么您就不会了解 C++ 的基础知识（顺便说一句，承认这一事实是了解 C++ 的开始）。同样，如果您不了解类，那么您就不会了解 C++（或 OO）的基础知识。

对于指针，我认为用方框绘图是个好主意，但在汇编中工作也是个好主意。我认为，任何使用相对寻址的指令都会让你很快理解什么是指针。

至于类（以及更普遍的面向对象编程），我会推荐 Stroustrups "The C++ Programming Language" 最新版。它不仅是规范的 C++ 参考资料，而且还包含很多其他方面的资料，从基本的面向对象的类层次结构和继承一直到大型系统中的设计原则。这是一本非常好的读物（如果不是有点厚和简洁的话）。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-09-21T20:45:31.707

指针不是什么神奇的东西，你一直在使用它们！
当你说：

诠释一个;

并且编译器为“a”生成存储，您实际上是在说您正在声明
一个 int 并且您想将其内存位置命名为“a”。

当你说：

诠释*一个；

您正在声明一个可以保存 int 内存位置的变量。就是这么简单。另外，不要害怕指针算术，当你处理指针并考虑遍历内存地址时，请始终牢记“内存映射”。

C++ 中的类只是定义抽象数据类型的一种方式。我建议阅读一本好的 OOP 书籍来理解这个概念，然后，如果您有兴趣，可以学习 C++ 编译器如何生成代码来模拟 OOP。但是，如果您坚持使用 C++ 足够长的时间，这些知识会及时出现：)

# unit-testing - 单元测试有哪些流行的命名约定？

> ID：96297
> 
> 赞同：208
> 
> 时间：2008-09-18T19:59:56.237
> 
> 标签：unit-testing, naming-conventions

## 一般的

*   遵循所有测试的相同标准。
*   清楚每个测试状态是什么。
*   具体说明预期的行为。

## 例子

1) MethodName_StateUnderTest_ExpectedBehavior

```
Public void Sum_NegativeNumberAs1stParam_ExceptionThrown() 

Public void Sum_NegativeNumberAs2ndParam_ExceptionThrown () 

Public void Sum_simpleValues_Calculated () 
```

资料来源：[单元测试的命名标准](http://osherove.com/blog/2005/4/3/naming-standards-for-unit-tests.html)

2）用下划线分隔每个单词

```
Public void Sum_Negative_Number_As_1st_Param_Exception_Thrown() 

Public void Sum_Negative_Number_As_2nd_Param_Exception_Thrown () 

Public void Sum_Simple_Values_Calculated () 
```

## 其他

*   *用Test*结束方法名
**   以类名开头的方法名*

 ** * *

## 回答 #1

> 赞同：98
> 
> 时间：2008-09-18T20:32:48.137

在这个人上，我非常赞同你。您使用的命名约定是：

*   清楚每个测试状态是什么。
*   具体关于预期的行为。

测试名称还需要什么？

与[Ray 的回答](https://stackoverflow.com/questions/96297/naming-conventions-for-unit-tests#96476)相反，我认为不需要*Test*前缀。这是测试代码，我们知道。如果您需要这样做来识别代码，那么您有更大的问题，**您的测试代码不应该与您的生产代码混淆。**

至于下划线的长度和使用，它的**测试代码**，谁在乎呢？只有你和你的团队会看到它，只要它是可读的，并且清楚测试在做什么，继续！:)

也就是说，我对[用它测试和记录我的冒险](http://cantgrokwontgrok.blogspot.com/2008/09/tdd-getting-started-with-test-driven.html)还是很陌生:)

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-01-21T18:35:16.607

这也值得一读：[结构化单元测试](http://haacked.com/archive/2012/01/02/structuring-unit-tests.aspx)

> 该结构对每个被测试的类都有一个测试类。这不是那么不寻常。但对我来说不寻常的是，他为每个正在测试的方法都有一个嵌套类。

例如

```
using Xunit;

public class TitleizerFacts
{
    public class TheTitleizerMethod
    {
        [Fact]
        public void NullName_ReturnsDefaultTitle()
        {
            // Test code
        }

        [Fact]
        public void Name_AppendsTitle()
        {
            // Test code
        }
    }

    public class TheKnightifyMethod
    {
        [Fact]
        public void NullName_ReturnsDefaultTitle()
        {
            // Test code
        }

        [Fact]
        public void MaleNames_AppendsSir()
        {
            // Test code
        }

        [Fact]
        public void FemaleNames_AppendsDame()
        {
            // Test code
        }
    }
} 
```

这就是为什么：

> 一方面，这是保持测试井井有条的好方法。一个方法的所有测试（或事实）都组合在一起。例如，如果您使用 CTRL+M、CTRL+O 快捷方式来折叠方法主体，您可以轻松地扫描您的测试并像阅读代码规范一样阅读它们。

我也喜欢这种方法：

**MethodName_StateUnderTest_ExpectedBehavior**

所以也许调整为：

**StateUnderTest_ExpectedBehavior**

因为每个测试都已经在一个嵌套类中

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2012-02-15T18:20:19.490

我倾向于使用这样的约定，`MethodName_DoesWhat_WhenTheseConditions`例如：

```
Sum_ThrowsException_WhenNegativeNumberAs1stParam 
```

但是，我确实看到很多是使测试名称遵循单元测试结构

*   安排
*   行为
*   断言

它也遵循以下 BDD / Gherkin 语法：

*   给定
*   什么时候
*   然后

这将以以下方式命名测试：`UnderTheseTestConditions_WhenIDoThis_ThenIGetThis`

所以你的例子：

```
WhenNegativeNumberAs1stParam_Sum_ThrowsAnException 
```

但是我更喜欢将被测试的方法名称放在第一位，因为这样测试可以按字母顺序排列，或者在 VisStudio 的成员下拉框中按字母顺序排列，并且 1 方法的所有测试都组合在一起。

* * *

无论如何，我喜欢用下划线分隔测试名称的主要*部分，而不是每个**单词*，因为我认为它更容易阅读和理解测试的重点。

换句话说，我喜欢：`Sum_ThrowsException_WhenNegativeNumberAs1stParam`比`Sum_Throws_Exception_When_Negative_Number_As_1st_Param`.

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-08-18T06:40:59.763

我确实将我的测试方法命名为使用“PascalCasing”的其他方法，没有任何下划线或分隔符。我留下了该方法的后缀*测试*，因为它没有增加任何价值。该方法是测试方法由属性*TestMethod*指示。

```
[TestMethod]
public void CanCountAllItems() {
  // Test the total count of items in collection.
} 
```

由于每个 Test 类应该只测试一个其他类，我将类的名称留在方法名称之外。包含测试方法的类的名称与被测类的名称类似，后缀为“Tests”。

```
[TestClass]
public class SuperCollectionTests(){
    // Any test methods that test the class SuperCollection
} 
```

对于测试异常或不可能的操作的方法，我在测试方法前加上“ *Cannot* ”一词。

```
[TestMethod]
[ExpectedException(typeOf(ArgumentException))]
public void CannotAddSameObjectAgain() {
  // Cannot add the same object again to the collection.
} 
```

我的命名约定基于 Bryan Cook 的文章[“TDD Tips: Test Naming Conventions & Guidelines”](http://www.bryancook.net/2008/06/test-naming-conventions-guidelines.html)。我发现这篇文章很有帮助。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-18T20:04:52.870

第一组名称对我来说更具可读性，因为 CamelCasing 分隔单词，而下划线分隔命名方案的部分。

我也倾向于在某处包含“测试”，无论是在函数名中，还是在封闭的命名空间或类中。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-09-18T20:04:47.800

只要你遵循一个单一的练习，这并不重要。通常，我为一个方法编写一个单元测试，涵盖一个方法的所有变体（我有简单的方法；），然后为需要它的方法编写更复杂的测试集。因此，我的命名结构通常是测试（JUnit 3 的保留）。

* * *

## 回答 #7

> 赞同：-7
> 
> 时间：2011-01-07T03:56:20.457

我对测试命名空间、类和方法使用“T”前缀。

我尝试保持整洁并创建复制命名空间的文件夹，然后为测试创建一个测试文件夹或单独的项目，并为基本测试复制生产结构：

```
AProj
   Objects
      AnObj
         AProp
   Misc
      Functions
         AFunc
   Tests
      TObjects
         TAnObj
            TAnObjsAreEqualUnderCondition
      TMisc
         TFunctions
            TFuncBehavesUnderCondition 
```

我可以很容易地看出某事是一个测试，我确切地知道它属于什么原始代码，（如果你不能解决这个问题，那么测试无论如何都太复杂了）。

它看起来就像接口命名约定，（我的意思是，您不会对以“I”开头的事物感到困惑，也不会与“T”混淆）。

在有或没有测试的情况下进行编译都很容易。

无论如何，它在理论上是好的，并且对于小型项目非常有效。

# svn - 如果 .svn 文件夹已损坏，如何恢复 svn 控制？

> ID：96313
> 
> 赞同：27
> 
> 时间：2008-09-18T20:02:16.667
> 
> 标签：svn

我有几个大型结帐，其中 .svn 文件夹已损坏，因此我收到错误消息，“清理无法处理以下路径..”并且我无法再提交或更新该目录中的文件。

我只是删除并再次结帐，但整个目录已经结束了。

是否有工具可以恢复特定文件夹的 .svn 文件夹，而无需下载所有内容？

我知道它将必须下载该文件夹中的所有文件，以便确定它们是否已更改..但是具有有效 .svn 文件夹的子目录应该没问题。

哦.. 我是 TortoiseSVN 或 linux 命令行的忠实粉丝。

想法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-18T20:13:07.450

如果您对文件进行了更改，并且无法删除它们，您可以使用 Subversion 1.5 功能，该功能允许您“有障碍物签出”。

只需删除此目录中的 .svn 目录，然后：（
使用 --depth 文件时无需删除内部目录，谢谢 Eric）

如果损坏的目录是工作副本的顶级目录：

```
svn checkout --depth files --force REPOS WC 
```

如果损坏的目录上方的目录仍然是版本控制的，请运行：

```
svn update --depth files --force WC 
```

在那个目录中。
在这两个示例中，REPOS 是存储库中与损坏目录匹配的 url，而 WC 是目录的路径。

最初修改的文件在此之后将处于修改状态。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T20:07:19.930

如果你知道哪个文件夹有损坏的 .svn 目录，你可以删除那个目录并再次运行 svn update。您可能必须删除整个目录，包括其当前内容。当然，如果 .svn 目录损坏的文件夹是包含千兆字节的文件夹，那么您又回到了开始的地方。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T20:17:17.753

备份缺少 .svn 的文件夹

然后删除文件夹

如果它是结帐的根，您将不得不重新结帐

如果它不是根目录，只需从上面的目录运行更新。

然后将备份文件夹移到它上面。（理想情况下不要移回 .svn 文件夹）

继续工作并确保更新/提交！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T20:06:40.353

我过去遇到过这个问题，除了“核选项”（即删除目录并重新结帐）之外，没有找到任何可行的解决方案。

不确定这是否是您的问题，但我的损坏是由与 SVN 服务器位于同一台计算机上的按访问病毒扫描程序引起的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T20:15:36.010

如果子目录正常并且子目录很大，您可以尝试非递归新结帐。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-29T22:02:02.527

选择的解决方案对我有用，可以恢复顶级 .svn 文件夹，但它不能识别子对象，所以此时一切对 SVN 来说似乎都是陌生的，尽管子文件夹中的版本控制是完整的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-11T00:01:27.193

我今天遇到了同样的错误。当我尝试切换分支并且未能删除不在 svn 存储库中的文件之一时，就会发生这种情况。之后，该文件夹被锁定，我无法使用任何命令使其再次工作。

我基本上删除了我拥有的东西并重新结帐。这很耗时，但我真的想确保 svn 清晰，然后才能重新开始工作。谢谢！

# .net - 如何获取程序集的根命名空间？

> ID：96317
> 
> 赞同：54
> 
> 时间：2008-09-18T20:02:45.870
> 
> 标签：.net, reflection

给定一个实例`System.Reflection.Assembly`。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2011-06-07T02:55:57.807

当我想通过其清单资源流从当前程序集中加载资源时，我多次遇到这种困境。

事实是，如果您使用 Visual Studio 将文件作为资源嵌入到程序集中，则其清单资源名称将派生自 Visual Studio 项目中定义的程序集的默认命名空间。

我想出的最佳解决方案（避免将默认命名空间硬编码为某处的字符串）是简单地确保您的资源加载代码总是从也在默认命名空间中的类内部发生，然后是以下近乎通用的方法可能用过了。

此示例正在加载嵌入式模式。

```
XmlSchema mySchema;
string resourceName = "MyEmbeddedSchema.xsd";
string resourcesFolderName = "Serialisation";
string manifestResourceName = string.Format("{0}.{1}.{2}",
    this.GetType().Namespace, resourcesFolderName, resourceName);
using (Stream schemaStream = currentAssembly.GetManifestResourceStream(manifestResourceName))
    mySchema = XmlSchema.Read(schemaStream, errorHandler); 
```

另请参阅：[如何获取程序集的命名空间？](https://stackoverflow.com/questions/653128/how-to-get-namespace-of-an-assembly)

编辑：还注意到我在[http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/3a469f5d-8f55-4b25-ac25-4778f260bb7e回答的问题的一个非常详细的答案](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/3a469f5d-8f55-4b25-ac25-4778f260bb7e)

如果有相同问题的人来寻找另一个编辑：在这里解决资源加载问题的好主意：[如何获取项目 csproj 的默认命名空间（VS 2008）](https://stackoverflow.com/questions/4885888/how-get-the-default-namespace-of-project-csproj-vs-2008)

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2008-09-18T20:04:46.317

不可能。没有指定“根”命名空间。选项中的默认命名空间是 Visual Studio 的东西，而不是 .net 的东西

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-18T20:06:55.673

给定程序集中可以有任意数量的命名空间，并且没有什么要求它们都从一个共同的根开始。您可以做的最好的事情是反映程序集中的所有类型并构建其中包含的唯一名称空间列表。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-11-11T13:24:03.257

我刚刚创建了一个名为 Root 的空内部类并将其放在项目根目录中（假设这是您的根名称空间）。然后我在需要根命名空间的任何地方使用它：

```
typeof(Root).Namespace; 
```

当然，我最终得到了一个未使用的文件，但它很干净。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-18T20:07:28.557

程序集不一定有根命名空间。命名空间和程序集是正交的。

相反，您可能正在寻找的是在该程序集中找到一个类型，然后找出它的命名空间是什么。

您应该能够通过使用 GetExportedTypes() 成员，然后使用返回的类型句柄之一中的命名空间属性来完成此操作。

同样，不能保证所有类型都在同一个命名空间中（甚至在同一个命名空间层次结构中）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T20:08:39.333

[Get Types](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.gettypes.aspx)为您提供程序集中定义的[Type](http://msdn.microsoft.com/en-us/library/system.type_members.aspx)对象列表。该对象具有命名空间属性。请记住，一个程序集可以有多个命名空间。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-07-01T15:31:03.987

```
GetType(frm).Namespace 
```

`frm`是启动表格

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-03-29T15:20:37.430

我`typeof(App).Namespace`在我的 WPF 应用程序中使用。App 类对于任何 WPF 应用程序都是必需的，它位于根目录中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T20:34:49.973

命名空间与程序集无关 - 命名空间和程序集中的类之间的任何映射纯粹是由于命名约定（或巧合）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-07-31T23:14:52.507

实际上有一种间接的方法来获取它，通过枚举程序集的清单资源的名称。您想要的名称以您知道的部分结尾。

此处不再重复代码，请参阅[获取 Assembly.GetManifestResourceStream() 方法的默认命名空间名称](http://social.msdn.microsoft.com/Forums/vstudio/en-US/3a469f5d-8f55-4b25-ac25-4778f260bb7e/get-default-namespace-name-for-assemblygetmanifestresourcestream-method?forum=csharpgeneral)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-05-09T05:52:30.403

我遇到的问题是，“如果我深入调用库代码 N 个方法并想要项目的命名空间——例如实际运行的 MVC 应用程序——我该如何得到它？”

有点hacky，但您可以获取堆栈跟踪和过滤器：

```
 public static string GetRootNamespace()
    {
        StackTrace stackTrace = new StackTrace();
        StackFrame[] stackFrames = stackTrace.GetFrames();
        string ns = null;
        foreach(var frame in stackFrames)
        {
            string _ns = frame.GetMethod().DeclaringType.Namespace;
            int indexPeriod = _ns.IndexOf('.');
            string rootNs = _ns;
            if (indexPeriod > 0)
                rootNs = _ns.Substring(0, indexPeriod);

            if (rootNs == "System")
                break;
            ns = _ns;
        }

        return ns;
    } 
```

所有这一切都是获取堆栈跟踪，运行从最近调用到 root 的方法，并过滤 System. 一旦它找到一个系统调用，它就知道它已经走得太远了，并返回它上面的名称空间。无论您是在运行单元测试、MVC 应用程序还是服务，系统容器都将比项目的根命名空间深 1 级，所以瞧。

在某些情况下，系统代码是跟踪中的中介（如 System.Task），这将返回错误的答案。我的目标是以一些启动代码为例，让它在根命名空间中轻松找到类或控制器或其他任何东西，即使完成工作的代码位于库中。这完成了该任务。

我确信这可以改进 - 我确信这种 hacky 的做事方式可以在很多方面得到改进，并且欢迎改进。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-02-22T19:24:07.503

在此处添加所有其他答案，希望不重复信息，这是我使用 Linq 解决此问题的方法。我的情况与丽莎的回答类似。

我的解决方案附带以下警告：

*   您正在使用 Visual Studio 并为您的项目定义了一个根命名空间，我认为这是您所要求的，因为您使用术语“根命名空间”
*   您没有从引用的程序集中嵌入互操作类型

```
Dim baseNamespace = String.Join("."c,
    Me.GetType().Assembly.ManifestModule.GetTypes().
        Select(Function(type As Type)
                    Return type.Namespace.Split("."c)
                End Function
        ).
        Aggregate(Function(seed As String(), splitNamespace As String())
                        Return seed.Intersect(splitNamespace).ToArray()
                    End Function
        )
) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-06-08T20:33:50.190

这是获取网站项目的根命名空间的一种相当简单的方法。

```
''' <summary>
''' Returns the namespace of the currently running website
''' </summary>
Public Function GetWebsiteRootNamespace() As String
    For Each Asm In AppDomain.CurrentDomain.GetAssemblies()
        If Asm Is Nothing OrElse Asm.IsDynamic Then Continue For

        For Each Typ In Asm.GetTypes
            If Typ Is Nothing OrElse Typ.Name Is Nothing Then Continue For
            If Typ.Name = "MyProject" Then Return Typ.Namespace.Split("."c)(0)
        Next
    Next

    Return Nothing
End Function 
```

这只是检查所有加载的“MyProject”类型的程序集并返回该类型的根命名空间。当您在单个解决方案中有多个 Web 项目共享一个日志系统时，这对于日志记录很有用。希望这可以帮助某人。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-12-02T20:20:51.437

如果您尝试加载嵌入式资源，则此解决方案有效。

```
var assembly = System.Reflection.Assembly.GetExecutingAssembly();
string[] resourceNames = assembly.GetManifestResourceNames();

string  resourceNameNoNamespace = $"Languages.{languageSupport.IsoCode}.Languages.xml";
var match = resourceNames.SingleOrDefault(rn => rn.EndsWith(resourceNameNoNamespace)); 
```

# shell - 用 mailx 和 uuencode 发送附件的 KornShell (ksh) 代码？

> ID：96326
> 
> 赞同：3
> 
> 时间：2008-09-18T20:03:13.340
> 
> 标签：shell, unix, scripting, solaris, ksh

我需要用mailx附加一个文件，但目前我没有成功。

**这是我的代码：**

```
subject="Something happened"
to="somebody@somewhere.com"
body="Attachment Test"
attachment=/path/to/somefile.csv

uuencode $attachment | mailx -s "$subject" "$to" << EOF

The message is ready to be sent with the following file or link attachments:

somefile.csv

Note: To protect against computer viruses, e-mail programs may prevent
sending or receiving certain types of file attachments.  Check your
e-mail security settings to determine how attachments are handled.

EOF 
```

任何反馈将不胜感激。

* * *

**更新** 我添加了附件 var 以避免每次都使用路径。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T20:35:21.627

您必须同时连接您的消息文本和 uuencoded 附件：

```
$ subject="Something happened"
$ to="somebody@somewhere.com"
$ body="Attachment Test"
$ attachment=/path/to/somefile.csv
$
$ cat >msg.txt <<EOF
> The message is ready to be sent with the following file or link attachments:
>
> somefile.csv
>
> Note: To protect against computer viruses, e-mail programs may prevent
> sending or receiving certain types of file attachments.  Check your
> e-mail security settings to determine how attachments are handled.
>
> EOF
$ ( cat msg.txt ; uuencode $attachment somefile.csv) | mailx -s "$subject" "$to" 
```

提供消息文本的方式有多种，这只是一个接近您原始问题的示例。如果应该重复使用该消息，则将其存储在一个文件中并使用该文件是有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T20:33:30.757

好吧，这是您遇到的前几个问题。

1.  您似乎假设邮件客户端将处理没有任何标题的 uuencoded 附件。那不会发生。

2.  您在滥用 I/O 重定向：uuencode 的输出和 here-document 都被馈送到 mailx，这是不可能的。

3.  您在滥用 uuencode：如果给出了一个路径，则它只是给出解码文件的名称，而不是输入文件名。两次给出文件将为解码的文件分配与读取的文件相同的名称。-m 标志强制 base64 编码。但这仍然不会为 mailx 提供附件标题。

你最好得到一个 mpack 的副本，它会做你想要的。

如果你必须这样做，你可以这样做：

```
cat <<EOF | ( cat -; uuencode -m /path/to/somefile.csv /path/to/somefile.csv; ) | mailx -s "$subject" "$to" 
place your message from the here block in your example here
EOF 
```

还有很多其他的可能性......但是这个仍然有你的例子中的here文档，并且很容易从我的脑海中浮出水面，并且没有涉及临时文件。

# .net - 配置多个 .Net 应用程序的最佳方法

> ID：96340
> 
> 赞同：4
> 
> 时间：2008-09-18T20:04:36.397
> 
> 标签：.net, asp.net, configuration

我们有一套相互关联的 .Net 3.5 应用程序。有些是网站，有些是 Web 服务，有些是 Windows 应用程序。每个应用程序当前都有自己的配置文件（app.config 或 web.config），并且由于多个应用程序需要相同的配置值，因此当前配置文件中有一些重复的键（目前手动保持同步）。此外，这套应用程序部署在各种环境（开发、测试、实时等）中

从单个配置源管理这些多个应用程序的配置的最佳方法是什么，以便可以在需要时在多个应用程序之间共享配置值？我们还希望为每个环境提供单独的配置（因此在部署时您不必手动更改特定于环境的某些配置值，例如连接字符串），但同时不想维护多个大型配置文件（每个环境一个），因为在添加新配置键时保持同步会很麻烦。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T20:07:19.463

Visual Studio 有一个相对晦涩的功能，可以让您将现有项目添加为链接，这应该可以完成您正在寻找的内容。查看[Derik Whittaker](http://devlicio.us/blogs/derik_whittaker/archive/2008/04/15/how-to-share-configuration-files-between-projects.aspx)关于此主题的帖子以获取更多详细信息。

Visual Studio 确实应该使这个选项更加明显。没有人真正想过点击“添加”按钮旁边的那个小箭头。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T20:18:11.840

您可以将 App.config 拆分为多个配置文件。您只需指定包含配置部分的文件的名称。

更改 app.config：

```
<SomeConfigSection>
  <SettingA/>
  <SettingB/>
</SomeConfigSection>
<OtherSection>
  <SettingX/>
</OtherSection> 
```

进入 app.config 和 SomeSetting.xml：

```
<SomeConfigSection file="SomeSetting.xml" />
<OtherSection file="Other.xml" /> 
```

SomeSetting.xml 包含：

现在，您可以使用某种构建或部署脚本从不同的部分文件组合您的 app.config。例如：

```
if debug copy SomeSettingDebug.xml deploydir/SomeSetting.xml
if MySql copy OtherSectionMySql.xml deploydir/OtherSetting.xml 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T20:19:27.000

我们使用具有 NAnt 属性的文件模板（例如 MyApp.config.template 和 MyWeb.config.template）来处理环境之间不同的位。所以模板文件可能看起来有点像这样：

```
<MyAppConfig>
    <DbConnString>${DbConnString}</DbConnString>
    <WebServiceUri uri="${WebServiceUri}" />
</MyAppConfig> 
```

在构建期间，我们只需在 NAnt 脚本中循环遍历每个环境，更改每个环境的 NAnt 属性 ${DbConnString} 和 ${WebServiceUri} 的值（实际上这些都设置在单个文件，其中包含每个环境的部分），并使用打开属性的选项进行 NAnt 复制。

设置花了一点时间，但它至少为我们节省了十倍的时间来处理不同版本的配置文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T04:27:35.547

这 2 个问题可能会对您有所帮助：[利用 machine.config](https://stackoverflow.com/questions/94053/how-are-you-using-the-machineconfig-or-are-you)和[为大型项目管理 app.config](https://stackoverflow.com/questions/89245/how-do-you-manage-net-appconfig-files-for-large-applications)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T20:10:08.083

查看 Microsoft 模式和实践组的 prism 框架？

# testing - 自动验证我网站的链接是否指向存在的 url？

> ID：96349
> 
> 赞同：4
> 
> 时间：2008-09-18T20:04:54.680
> 
> 标签：testing

是否有工具可以自动搜索我的网站并测试所有链接？我讨厌遇到错误的网址。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T20:06:09.667

[Xenu link sleuth](http://home.snafu.de/tilman/xenulink.html)非常好（而且免费）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T20:06:43.800

[w3.org 检查链接](http://validator.w3.org/checklink)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T20:08:50.100

如果我是你，我会查看[W3C Link Checker](http://validator.w3.org/checklink)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T20:06:24.847

像这样的东西应该可以工作： http: [//www.dead-links.com/](http://www.dead-links.com/)

谷歌搜索“404 检查器”或“断开链接检查器”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T20:09:37.303

我过去使用过 Xenu 的 Link Sleuth。它会抓取您的网站并告诉您哪些链接指向任何地方。它不是超级花哨，但它确实有效。

[http://en.wikipedia.org/wiki/Xenu%27s_Link_Sleuth](http://en.wikipedia.org/wiki/Xenu%27s_Link_Sleuth)

维基百科页面列出了一大堆其他产品。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T20:09:39.643

[WebHTTrack](http://www.httrack.com/page/21/fr/index.html)

浏览一个大型网站可能需要很长时间（我存档了一个 250MB 的网站，大约花了 2 个小时——虽然它不是本地的）它有一个日志，所以你应该能够轻松地跟踪 404。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T20:10:01.953

还可以查看 Google 的网站管理员工具。

[http://www.google.com/webmasters/tools/](http://www.google.com/webmasters/tools/)

它们使您能够查看 GoogleBot 在抓取您的网站时发现的 404（以及许多其他内容）。

# java - 将发布数据从一个 java servlet 写入另一个

> ID：96360
> 
> 赞同：9
> 
> 时间：2008-09-18T20:06:30.587
> 
> 标签：java, servlets

我正在尝试编写一个 servlet，它将通过 POST 将 XML 文件（xml 格式的字符串）发送到另一个 servlet。（非必要的 xml 生成代码替换为“Hello there”）

```
 StringBuilder sb=  new StringBuilder();
    sb.append("Hello there");

    URL url = new URL("theservlet's URL");
    HttpURLConnection connection = (HttpURLConnection)url.openConnection();                
    connection.setRequestMethod("POST");
    connection.setRequestProperty("Content-Length", "" + sb.length());

    OutputStreamWriter outputWriter = new OutputStreamWriter(connection.getOutputStream());
    outputWriter.write(sb.toString());
    outputWriter.flush();
    outputWriter.close(); 
```

这会导致服务器错误，并且永远不会调用第二个 servlet。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-18T20:13:48.480

使用像[HttpClient](http://hc.apache.org/httpclient-3.x/)这样的库，这种事情要容易得多。甚至还有一个[post XML 代码示例](http://svn.apache.org/viewvc/httpcomponents/oac.hc3x/trunk/src/examples/PostXML.java?view=markup)：

```
PostMethod post = new PostMethod(url);
RequestEntity entity = new FileRequestEntity(inputFile, "text/xml; charset=ISO-8859-1");
post.setRequestEntity(entity);
HttpClient httpclient = new HttpClient();
int result = httpclient.executeMethod(post); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-18T20:12:41.133

我建议改用 Apache [HTTPClient](http://hc.apache.org/)，因为它是一个更好的 API。

但是要解决当前的问题：`connection.setDoOutput(true);`打开连接后尝试调用。

```
StringBuilder sb=  new StringBuilder();
sb.append("Hello there");

URL url = new URL("theservlet's URL");
HttpURLConnection connection = (HttpURLConnection)url.openConnection();                
connection.setDoOutput(true);
connection.setRequestMethod("POST");
connection.setRequestProperty("Content-Length", "" + sb.length());

OutputStreamWriter outputWriter = new OutputStreamWriter(connection.getOutputStream());
outputWriter.write(sb.toString());
outputWriter.flush();
outputWriter.close(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T20:10:35.383

不要忘记使用：

```
connection.setDoOutput( true) 
```

如果您打算发送输出。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T21:18:33.253

HTTP post 上传流的内容及其机制似乎不是您所期望的。你不能只写一个文件作为帖子内容，因为 POST 有非常具体的 RFC 标准，说明 POST 请求中包含的数据应该如何发送。它不仅是内容本身的格式，也是如何将其“写入”到输出流的机制。很多时候 POST 现在是分块写入的。如果您查看 Apache 的 HTTPClient 的源代码，您将看到它是如何编写块的。

结果存在内容长度的怪癖，因为内容长度增加了一个小的数字，标识块和一个随机的小字符序列，当它被写入流时，它分隔每个块。查看更新的 Java 版本的 HTTPURLConnection 中描述的其他一些方法。

[http://java.sun.com/javase/6/docs/api/java/net/HttpURLConnection.html#setChunkedStreamingMode(int)](http://java.sun.com/javase/6/docs/api/java/net/HttpURLConnection.html#setChunkedStreamingMode(int))

如果您不知道自己在做什么并且不想学习它，那么处理添加像 Apache HTTPClient 这样的依赖项确实会容易得多，因为它抽象了所有复杂性并且可以正常工作。

# wpf - 在 WPF 中使用具有依赖属性和样式触发器的验证

> ID：96377
> 
> 赞同：1
> 
> 时间：2008-09-18T20:08:18.727
> 
> 标签：wpf, validation, validationrules

我正在尝试在 WPF 中使用验证。我创建了一个 NotNullOrEmptyValidationRule，如下所示：

```
public class NotNullOrEmptyValidationRule : ValidationRule
    {
        public override ValidationResult Validate(object value, CultureInfo cultureInfo)
        {
            if (String.IsNullOrEmpty(value as String))
                return new ValidationResult(false, "Value cannot be null or empty");

            return new ValidationResult(true, null); 
        }
    } 
```

现在，我需要在我的应用程序中使用它。在我的 App.xaml 文件中，我声明了 TextBox 的样式。这是声明。

```
 <Style x:Key="textBoxStyle" TargetType="{x:Type TextBox}">

            <Setter Property="Background" Value="Green"/>

            <Style.Triggers>

                <Trigger Property="Validation.HasError" Value="True">

                    <Setter Property="Background" Value="Red"/>
                    <Setter Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Self},Path=(Validation.Errors)[0].ErrorContent}"/>

                </Trigger>

            </Style.Triggers>

        </Style> 
```

现在，我想在我的 TextBox 上使用它，所以我使用以下代码：

```
 <TextBox Style="{StaticResource textBoxStyle}">
                <TextBox.Text>
                    <Binding>
                        <Binding.ValidationRules>
                            <NotNullOrEmptyValidationRule />
                        </Binding.ValidationRules>
                    </Binding>
                </TextBox.Text>

            </TextBox> 
```

错误出现在标记 NotNullOrEmptyValidationRule 上。XAML 语法检查器无法解析 NotNullOrEmptyValidationRule。我什至尝试过放置名称空间，但它似乎不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T20:24:02.777

您只需将 xmlns 添加到您的窗口，并使用它来引用您的 ValidationRule。

在 WPF 中，该对象完全可以从同一个程序集中使用。

由于您的规则未在标准 XAML 命名空间中定义，因此您必须创建到 clr 命名空间的映射，如下所示：

```
<Window ...
    xmlns:local="clr-namespace:MyNamespaceName"> 
```

然后你会像这样使用它：

```
<Binding Path=".">
    <Binding.ValidationRules>
        <local:NotNullOrEmptyValidationRule />
    </Binding.ValidationRules>
</Binding> 
```

*编辑* 我在绑定中添加了一个路径语句。你必须告诉绑定要绑定什么:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T03:06:58.923

我看到您在 TextBox 上的绑定设置为“文本”路径 - 无论该文本框的数据上下文是什么，这是一个字段吗？文本框是否真的得到了一个值？另外，如果您在验证方法中设置断点，是否会被解雇？

您可能想查找如何记录绑定失败并查看这些失败..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-03T06:41:29.693

你后面的代码中没有这一行

```
Public Sub New()

    ' This call is required by the Windows Form Designer.
    InitializeComponent()

    Me.**NameOfTextBox**.DataContext = Me
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T20:14:43.890

Visual Studio 和 Expression Blend 中存在导致此问题的错误。您需要做的是确保验证规则位于您可以引用的单独项目/程序集中。这应该可以解决问题。

但是，您必须重新添加命名空间才能使其正常工作。

# security - 如何判断 IE 认为哪些文件是“不安全的”？

> ID：96382
> 
> 赞同：8
> 
> 时间：2008-09-18T20:09:35.493
> 
> 标签：security, internet-explorer-6, internet-explorer-7

我们有一个 CMS 系统，其 Web 界面通过 HTTPS 提供服务。这对 Firefox 非常有效，但是当我们在 IE6 或 IE7 中加载它时，它会抱怨“此页面包含安全和非安全项目”。

我已经在 Firefox 中加载了该页面并使用 Firebug 进行了检查，并且每个连接似乎都通过 HTTPS，应该是这种情况。

有什么方法可以判断是什么导致 IE 抛出这个明显虚假的错误？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-20T16:59:55.287

Firefox 在混合内容检测中存在许多错误。通常，您应该尝试使用 Fiddler 来发现不安全的资源。

如果您安装我编写的工具 (www.bayden.com/dl/scriptfreesetup.exe)，您将获得不同的混合内容提示，其中显示页面上第一个不安全资源的确切 URL。该工具基本上是一个原型，你应该在完成后卸载它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T20:12:57.140

使用[Fiddler](http://www.fiddlertool.com/Fiddler2/version.asp)观察服务器和 IE 之间的流量。

请务必转到工具 > Fiddler 选项... > HTTPS > 并检查“解密 HTTPS 流量”

任何服务器和 IE 之间生成的任何非 HTTPS 流量都应该很容易在 Web Sessions 列表中发现。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-01-26T22:10:05.937

我使用了 Eric 的工具（感谢 Eric，您为我节省了几个小时……），事实证明 IE6 将使用相对路径指定的背景图像视为不安全的内容。即使它实际上是通过 https 请求它。因此，如果您感到困惑-将相对路径转换为绝对路径可能真的会有所帮助...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T20:13:32.350

一个或多个资源（CSS url-image ref 很容易被忽略）是否指向证书未涵盖的子域（[https://www.example.com](https://www.example.com)与[https://static.example.com](https://static.example.com)）？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T20:18:50.153

如果您看不到任何不使用 SSL 的东西，那么这通常归结为某处的 SSL 证书损坏。我不知道有什么可以告诉你问题到底是什么的东西，但是你可以很容易地获得所有加载的列表。

Firefox 的“页面信息”对话框（右键单击页面）上的媒体选项卡可以做到这一点，也值得一试[Fiddler](http://www.fiddlertool.com/)（这是一款出色且非常有用的软件）。

# sql - SQL server 2000 Like 语句用法

> ID：96390
> 
> 赞同：0
> 
> 时间：2008-09-18T20:10:09.220
> 
> 标签：sql, sql-server

我有一个如下所示的 SQL 语句：

```
SELECT [Phone]
FROM [Table]
WHERE
(
    [Phone] LIKE '[A-Z][a-z]'
    OR [Phone] = 'N/A'
    OR [Phone] LIKE '[0]'
) 
```

我遇到问题的部分是带有“LIKEs”的 where 语句。我已经看到 SQL 语句，其中作者`like`以我上面使用它们的方式使用语句。起初，我认为这可能是正则表达式的一个版本，但后来我学会了。

有没有人熟悉以这种方式使用类似的语句。注意：“N/A”工作正常。

我需要匹配的是有字符的电话号码。或只包含零的电话号码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T20:16:47.223

[在这里](http://technet.microsoft.com/en-us/library/aa933232(v=sql.80).aspx)检查。

[] 匹配一系列字符。

我想你想要这样的东西：

```
SELECT [Phone]
FROM [Table]
WHERE
(
    [Phone] LIKE '%[A-Z]%'
    OR [Phone] LIKE '%[a-z]%'
    OR [Phone] = 'N/A'
    OR [Phone] LIKE '0'
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T20:17:59.063

尝试使用该`t-sql` `ISNUMERIC`功能。这将向您显示哪些是/不是数字的。

您可能还需要`TRIM`或`REPLACE`空格来获得您想要的东西。

例如，要查找有效的电话号码，请将空格替换为 ''、测试为`ISNUMERIC`和测试`LEN`。

尽管我会警告您，但如果您必须处理国际电话号码，这将是乏味的。

上面的 SQL 需要注意的是，SQL Server 不理解正则表达式。

# php - 部署到多台服务器

> ID：96405
> 
> 赞同：8
> 
> 时间：2008-09-18T20:11:59.390
> 
> 标签：php, deployment

我必须将我的 php/html/css/etc 代码部署到多个服务器，并且我正在寻找可以轻松安全地部署到多个服务器的软件选项。

如果它可以绑定到我的 SVN 也有帮助。

有什么建议么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T20:38:37.267

[Capistrano](http://capify.org/)非常方便。有几个人使用它（[1、2、3](http://www.contentwithstyle.co.uk/Blog/178) [）](http://www.simplisticcomplexity.com/2006/8/16/automated-php-deployment-with-capistrano/)来部署[PHP](http://laurentbois.com/2008/08/05/use-capistrano-in-enterprise-for-php-and-ruby-on-rails-applications/)代码，这可以通过[快速搜索](http://www.google.com/search?q=capistrano+php+deployment)来证明。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T20:14:16.870

使用 ssh 设置无密码公钥身份验证将允许您非常快速地将文件 scp 到任何服务器（或通过 shell 脚本自动执行）。

这是一个简单的教程：[http ://rcsg-gsir.imsb-dsgi.nrc-cnrc.gc.ca/documents/internet/node31.html](http://rcsg-gsir.imsb-dsgi.nrc-cnrc.gc.ca/documents/internet/node31.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T20:31:00.107

如果您在 Redhat 或 Debian 上运行，请考虑将您的代码打包到 RPM 或 Debs 中。然后构建一个 yum 或 dpkg 存储库并将你的包放在那里。然后，您可以使用系统的包管理进行升级/回滚等。您甚至可以使用[puppet](http://reductivelabs.com/trac/puppet/)来自动化该过程。

如果你想把它绑定到颠覆中，你可以为每个新版本创建一个分支。当目录中出现新分支时，使用提交脚本构建 RPM。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T23:45:10.843

我会第二个Capistrano。它非常强大和灵活。我们当前的项目使用 Capistrano 部署到不同的服务器以及多台服务器。我们将两个参数传递给 cap 命令：1）要运行的机器特定配置选项集的名称和 2）要运行的操作的名称

最终看起来像这样：

```
cap -f deploy.rb live deploy 
```

或者

```
cap -f deploy.rb dev deploy 
```

当然，默认用例——一次部署到多台机器——对 Capistrano 来说是轻而易举的事，而且你不需要在要部署的机器上安装 Capistrano。总而言之，美味的技术。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T20:15:00.317

我以前使用过[Automated Build Studio](http://www.automatedqa.com/products/abs/index.asp)来完成类似的任务。它为您提供了很大的灵活性，您可以做什么。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T20:18:04.240

我同意 - 设置您的 svn 树，并使用 rsync over ssh 将树复制到远程位置。rsync 将使其快速高效，仅复制更改而不是完整文件。

您想将 svn 树导出到某个目录，然后从那里 rsync 到远程主机的目录树。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T20:25:28.373

我还忘了提到，如果你使用 rsync，你可以设置 rsync 使用 ssh，这样你只会传输已经改变的文件，节省时间和带宽。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-04-18T16:01:23.650

您还可以使用免费的[kwateeSDCM](http://www.kwatee.net)，它允许通过 ssh 进行远程安装。它还使您能够从一个中心位置管理特定于服务器的配置，并使升级变得无懈可击。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T08:09:01.333

我已经标记了一篇关于如何使用 Subversion 部署您的网站的帖子：[http ://blog.lavablast.com/post/2008/02/I2c-for-one2c-welcome-our-new-revision-control-overlords!.aspx](http://blog.lavablast.com/post/2008/02/I2c-for-one2c-welcome-our-new-revision-control-overlords!.aspx)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-12-07T17:04:15.903

我发现 capistrano 设置后非常易于使用。对于更复杂的环境，配置文件一开始可能会有点混乱，但很快就会变得有价值。我在生产环境中部署到 14 台服务器。我还使用多个环境部署到登台服务器。一个怪癖是，Ruby 中有一个错误会破坏并行部署，但对于 svn 导出，串行部署并不算太糟糕。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-06-13T21:11:18.203

Capistrano 设置太复杂了。我们发现 KwateeSDCM 使用起来非常简单，只需一个简单的 Web 界面，无需编写脚本。我们很快就完成了 Windows 和 linux 服务器上的 Dev 和 QA 配置的部署配置。

# c++ - C++：第 1 步：ExtractIconEx。第2步： ？？？第 3 步：SetMenuItemBitmaps

> ID：96414
> 
> 赞同：1
> 
> 时间：2008-09-18T20:13:02.147
> 
> 标签：c++, winapi, icons

我正在尝试将图标添加到 shell 扩展。我有这段代码（为了便于阅读而进行了清理），它有效：

```
InsertMenu(hmenu, index, MF_POPUP|MF_BYPOSITION, (UINT)hParentMenu, namestring); 
```

下一步是这段代码：

```
HICON hIconLarge, hIconSmall;
ICONINFO oIconInfo;
ExtractIconEx("c:\\progra~1\\winzip\\winzip32.exe", 0, &hIconLarge, &hIconSmall, 1);
GetIconInfo(hIconSmall, &oIconInfo);
//???????
SetMenuItemBitmaps(hParentMenu, indexMenu-1, MF_BITMAP | MF_BYPOSITION, hbmp, hbmp); 
```

我放什么来代替？尝试谷歌这方面的知识发现了许多我未能工作的提示。任何关于让它工作的建议，特别是在旧机器上（例如没有 .net 框架，没有 vista）都值得赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T20:22:25.777

Vista 对菜单中的图标有适当的支持，对于 Vista 之前的版本，如果您想要真正的 16x16 全彩图标，则必须使用所有者绘制菜单项 (MF_OWNERDRAW)

[Vista风格菜单...](http://shellrevealed.com/blogs/shellblog/archive/2007/02/06/Vista-Style-Menus_2C00_-Part-1-_2D00_-Adding-icons-to-standard-menus.aspx) [Vista风格+pre Vista回调](http://www.nanoant.com/programming/themed-menus-icons-a-complete-vista-xp-solution)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T13:13:53.947

这可行，尽管背面颜色是黑色而不是透明。

```
GetIconInfo(hIconSmall, &oIconInfo);
SetMenuItemBitmaps(hmenu, uMenuIndex+i+popUpMenuCount-1, MF_BITMAP | MF_BYPOSITION, oIconInfo.hbmColor, oIconInfo.hbmColor); 
```

# javascript - 如何拆分字符串，在特定字符处中断？

> ID：96428
> 
> 赞同：602
> 
> 时间：2008-09-18T20:14:13.643
> 
> 标签：javascript, string-split

我有这个字符串

```
'john smith~123 Street~Apt 4~New York~NY~12345' 
```

使用 JavaScript，将其解析为的最快方法是什么

```
var name = "john smith";
var street= "123 Street";
//etc... 
```

* * *

## 回答 #1

> 赞同：947
> 
> 时间：2008-09-18T20:17:59.233

使用 JavaScript 的[`String.prototype.split`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/split)功能：

```
var input = 'john smith~123 Street~Apt 4~New York~NY~12345';

var fields = input.split('~');

var name = fields[0];
var street = fields[1];
// etc. 
```

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2017-02-12T09:15:21.023

根据 ECMAScript6 `ES6`，干净的方法是解构数组：

```
const input = 'john smith~123 Street~Apt 4~New York~NY~12345';

const [name, street, unit, city, state, zip] = input.split('~');

console.log(name); // john smith
console.log(street); // 123 Street
console.log(unit); // Apt 4
console.log(city); // New York
console.log(state); // NY
console.log(zip); // 12345
```

您可能在输入字符串中有额外的项目。在这种情况下，您可以使用 rest 运算符获取其余的数组或忽略它们：

```
const input = 'john smith~123 Street~Apt 4~New York~NY~12345';

const [name, street, ...others] = input.split('~');

console.log(name); // john smith
console.log(street); // 123 Street
console.log(others); // ["Apt 4", "New York", "NY", "12345"]
```

我假设值的只读引用并使用了`const`声明。

**享受 ES6！**

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2008-09-18T20:19:29.760

你不需要 jQuery。

```
var s = 'john smith~123 Street~Apt 4~New York~NY~12345';
var fields = s.split(/~/);
var name = fields[0];
var street = fields[1]; 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2012-08-14T11:15:30.510

即使这不是最简单的方法，您也可以这样做：

```
var addressString = "~john smith~123 Street~Apt 4~New York~NY~12345~",
    keys = "name address1 address2 city state zipcode".split(" "),
    address = {};

// clean up the string with the first replace
// "abuse" the second replace to map the keys to the matches
addressString.replace(/^~|~$/g).replace(/[^~]+/g, function(match){
    address[ keys.unshift() ] = match;
});

// address will contain the mapped result
address = {
    address1: "123 Street"
    address2: "Apt 4"
    city: "New York"
    name: "john smith"
    state: "NY"
    zipcode: "12345"
} 
```

* * *

**ES2015 更新，使用解构**

```
const [address1, address2, city, name, state, zipcode] = addressString.match(/[^~]+/g);

// The variables defined above now contain the appropriate information:

console.log(address1, address2, city, name, state, zipcode);
// -> john smith 123 Street Apt 4 New York NY 12345 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-09-18T20:18:35.240

您需要查看 JavaScript 的[substr](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/substr)或[split](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/split)，因为这不是真正适合 jQuery 的任务。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-11-29T09:45:34.880

如果**找到拆分器，**那么只有

它会拆分它

否则返回**相同的字符串**

> ```
> function SplitTheString(ResultStr) {
>     if (ResultStr != null) {
>         var SplitChars = '~';
>         if (ResultStr.indexOf(SplitChars) >= 0) {
>             var DtlStr = ResultStr.split(SplitChars);
>             var name  = DtlStr[0];
>             var street = DtlStr[1];
>         }
>     }
> } 
> ```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-18T20:20:04.487

好吧，最简单的方法是：

```
var address = theEncodedString.split(/~/)
var name = address[0], street = address[1] 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-10-03T10:01:51.010

您可以使用`split`拆分文本。

作为替代方案，您也可以使用`match`如下

```
var str = 'john smith~123 Street~Apt 4~New York~NY~12345';
matches = str.match(/[^~]+/g);

console.log(matches);
document.write(matches);
```

正则表达式将匹配除数组之外的`[^~]+`所有字符并返回匹配项。`~`然后，您可以从中提取匹配项。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-18T20:21:27.697

就像是：

```
var divided = str.split("/~/");
var name=divided[0];
var street = divided[1]; 
```

可能是最简单的

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2020-09-05T13:51:49.917

`split()`JavaScript 中的方法用于将字符串转换为数组。它需要一个可选参数，作为一个字符，在其上进行拆分。在你的情况下（〜）。

如果 splitOn 被跳过，它将简单地将字符串放在数组的第 0 位。

如果 splitOn 只是一个“”，那么它将转换单个字符的数组。

所以在你的情况下：

```
var arr = input.split('~'); 
```

将获得名称`arr[0]`和街道`arr[1]`。

[您可以在 JavaScript](https://codetopology.com/scripts/javascript-tutorials/javascript-string-methods/#splitsplitOn)中的 Split on 中阅读更详细的说明

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-10-26T18:03:34.513

Zach 是对的。使用他的方法，您还可以制作一个看似“多维”的数组。我在 JSFiddle [http://jsfiddle.net/LcnvJ/2/创建了一个快速示例](http://jsfiddle.net/LcnvJ/2/)

```
// array[0][0] will produce brian
// array[0][1] will produce james

// array[1][0] will produce kevin
// array[1][1] will produce haley

var array = [];
    array[0] = "brian,james,doug".split(",");
    array[1] = "kevin,haley,steph".split(","); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-01-17T02:13:58.490

这样`string.split("~")[0];`事情就搞定了。

来源：[String.prototype.split()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/split)

* * *

**另一种使用 curry 和函数组合的函数方法。**

所以第一件事就是拆分功能。我们想把它`"john smith~123 Street~Apt 4~New York~NY~12345"`变成这个`["john smith", "123 Street", "Apt 4", "New York", "NY", "12345"]`

```
const split = (separator) => (text) => text.split(separator);
const splitByTilde = split('~'); 
```

所以现在我们可以使用我们专门的`splitByTilde`功能了。例子：

```
splitByTilde("john smith~123 Street~Apt 4~New York~NY~12345") // ["john smith", "123 Street", "Apt 4", "New York", "NY", "12345"] 
```

要获取第一个元素，我们可以使用`list[0]`运算符。让我们构建一个`first`函数：

```
const first = (list) => list[0]; 
```

算法是：用冒号分割，然后得到给定列表的第一个元素。所以我们可以组合这些函数来构建我们的最终`getName`函数。构建一个`compose`函数`reduce`：

```
const compose = (...fns) => (value) => fns.reduceRight((acc, fn) => fn(acc), value); 
```

现在用它来组合`splitByTilde`和`first`运行。

```
const getName = compose(first, splitByTilde);

let string = 'john smith~123 Street~Apt 4~New York~NY~12345';
getName(string); // "john smith" 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-04-09T09:25:28.953

# 尝试使用纯 Javascript

```
 //basic url=http://localhost:58227/ExternalApproval.html?Status=1

 var ar= [url,statu] = window.location.href.split("="); 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-08-28T13:00:48.607

JavaScript：将字符串转换为数组 JavaScript 拆分

```
 var str = "This-javascript-tutorial-string-split-method-examples-tutsmake."

    var result = str.split('-'); 

    console.log(result);

    document.getElementById("show").innerHTML = result; 
```

```
<html>
<head>
<title>How do you split a string, breaking at a particular character in javascript?</title>
</head>
<body>

<p id="show"></p> 

</body>
</html>
```

[https://www.tutsmake.com/javascript-convert-string-to-array-javascript/](https://www.tutsmake.com/javascript-convert-string-to-array-javascript/)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-03-28T13:58:50.667

由于逗号问题的拆分与此问题重复，因此在此处添加。

如果您想在一个字符上拆分并处理可能跟在该字符后面的额外空格，这通常与逗号一起发生，您可以使用`replace`then `split`，如下所示：

```
var items = string.replace(/,\s+/, ",").split(',') 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-11-15T14:58:43.317

这不如解构答案好，但是看到这个问题是 12 年前提出的，我决定给它一个在 12 年前也可以工作的答案。

```
function Record(s) {
    var keys = ["name", "address", "address2", "city", "state", "zip"], values = s.split("~"), i
    for (i = 0; i<keys.length; i++) {
        this[keys[i]] = values[i]
    }
}

var record = new Record('john smith~123 Street~Apt 4~New York~NY~12345')

record.name // contains john smith
record.address // contains 123 Street
record.address2 // contains Apt 4
record.city // contains New York
record.state // contains NY
record.zip // contains zip 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2018-03-01T11:27:31.907

使用此代码 -

```
function myFunction() {
var str = "How are you doing today?";
var res = str.split("/");

} 
```

# .net - 如何知道我在 Windows 服务中打开了多少 SQL 连接？

> ID：96431
> 
> 赞同：6
> 
> 时间：2008-09-18T20:14:29.447
> 
> 标签：.net, sql-server, ado.net, sqlconnection

我看到一些表明“连接泄漏”的错误。也就是说，连接未正确关闭并且池即将用完。那么，我该如何进行检测以查看在给定时间打开的确切数量？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T20:21:31.770

如果您使用的是 .net，则 PerfMon 中有用于 SQL 服务器的 .net 数据提供程序。您可以在那里查看 NumberOfPooledConnections

[![性能监视器的屏幕截图](https://i.stack.imgur.com/oH5Cd.png)](https://i.stack.imgur.com/oH5Cd.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T20:18:46.580

从数据库方面来看，主表中的 sp_who2 存储过程非常适合。它将向您显示与数据库的连接。如果您正在寻找更多数据，请尝试进行分析。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T20:19:11.867

实现一个服务，通过它创建、打开和关闭所有连接。在那里放一个柜台。每次打开或关闭连接时，使用您的日志记录框架进行记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T20:20:05.610

您可以使用分析器工具来跟踪所有现有的以及打开和关闭的连接

您可以从企业管理器中打开探查器

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T20:21:33.843

如果您使用的是 SQL 2000，则可以签入 SQL 2000 Enterprise Manager：

> 查看当前活动窗口 在 SQL Server 企业管理器中，展开服务器组，然后展开服务器。展开管理，然后展开当前活动。单击进程信息。
> 
> 当前服务器活动显示在详细信息窗格中。

( [http://technet.microsoft.com/en-us/library/cc738560.aspx](http://technet.microsoft.com/en-us/library/cc738560.aspx) )

（来自谷歌搜索：sql 2000 当前活动）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T20:21:54.497

您可以在 SQL Server Management Studio 或查询分析器中运行 sp_who2 以查看所有当前连接。那就是 SQL Server。我不确定您使用的是哪个 RDBMS。

此外，查看您的代码并确保在不再需要连接时立即关闭它。对这个肛门！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T16:33:27.163

使用“using”语句确保您的连接始终关闭，您将永远不会再遇到此问题：

```
using(SqlConnection connection = new SqlConnection())
{
...
} // connection is always disposed (i.e. closed) here, even if an exception is thrown 
```

# apache-flex - 如何从 Flex 应用程序读取 Flash SWF 中文本输入的值？

> ID：96440
> 
> 赞同：0
> 
> 时间：2008-09-18T20:16:24.823
> 
> 标签：apache-flex, flash, actionscript-3, cs3

我有一个 Flex 应用程序，它从 CS3 加载 SWF。加载的 SWF 包含一个名为“myText”的文本输入。我可以在 SWFLoader.content 中毫无问题地看到这一点，但我不知道我应该在我的 Flex 应用程序中将它视为什么类型。我认为 flex 文档涵盖了这一点，但我只能找到如何与另一个 Flex SWF 交互。

Flex 调试器告诉我它是 fl.controls.TextInput 类型，这是有道理的。但是 FlexBuilder 似乎不知道这个类。虽然 Flash 和 Flex 都使用 AS3，但 Flex 有一个全新的 GUI 类库。我认为它也有所有的 Flash 类，但我无法让它知道任何 fl.*** 包。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T15:46:08.247

类的`fl.*`层次结构仅适用于 Flash CS3。它是 Flash Components 3 库（我相信它被称为，我可能错了）。但是，您不需要该类来处理该对象。只要您可以在您的代码中获得对它的引用（您似乎拥有），您就可以将引用分配给无类型变量并使用它：

```
var textInput : * = getTheTextInput(); // insert your own method here

textInput.text = "Lorem ipsum dolor sit amet";

textInput.setSelection(4, 15); 
```

无需知道对象的类型即可与之交互。当然你会在编译时丢失类型检查，但这真的不是什么大问题，你只需要格外小心。

如果您真的非常想将对象引用为其真实类型，则相关类位于

```
Adobe Flash CS3/Configuration/Component Source/ActionScript 3.0/User Interface/fl/controls/TextInput.as 
```

...如果您安装了 Flash CS3，因为它仅随该应用程序提供。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T18:01:34.410

请记住，如果您按照 Theo 所说的操作并使用正确的类型引用它，它将在两个 swf 中编译该类，即使您没有在第一个中使用它。不幸的是， fl.* 类没有实现任何接口，因此您不能将它们键入接口而不是实现。如果可以的话，只有接口会被编译，这比实现要小得多。对于这个来说，这没什么大不了的，它可能只会增加几个 kb，但从长远来看，它会增加。只是提个醒；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T20:26:55.733

Flex 和 Flash SWF 本质上是相同的，只是使用不同的工具构建。我不确定它们是否共享相同的组件库，但根据包名，我猜它们至少大部分都是这样。

如果它是一个普通的文本输入，那么我猜它是 mx.controls.TextInput 的一个实例。

# sql - 从 CSV 批量导入 SQL

> ID：96448
> 
> 赞同：23
> 
> 时间：2008-09-18T20:17:14.370
> 
> 标签：sql, sql-server, tsql, bulkinsert

我需要将一个大型 CSV 文件导入 SQL 服务器。我正在使用这个：

```
BULK 
INSERT CSVTest
        FROM 'c:\csvfile.txt'
            WITH
    (
                FIELDTERMINATOR = ',',
                ROWTERMINATOR = '\n'
    )
GO 
```

问题是我的所有字段都被引号（“”）包围，所以一行实际上看起来像：

```
"1","","2","","sometimes with comma , inside", "" 
```

我可以以某种方式批量导入它们并告诉 SQL 使用引号作为字段分隔符吗？

**编辑**：使用 '","' 作为分隔符的问题，如示例中所建议的那样：大多数示例所做的是，它们导入的数据包括第一列中的第一个“和最后一列中的最后一个”，然后它们去吧，把它去掉。唉，我的第一列（也是最后一列）是日期时间，不允许将“20080902”作为日期时间导入。

从我一直在阅读的内容来看，我认为 FORMATFILE 是要走的路，但是文档（包括 MSDN）非常无用。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-18T20:20:21.273

尝试`FIELDTERMINATOR='","'`

这是一个很好的链接，可以帮助第一个和最后一个引号...看看他如何使用子字符串 SP

[http://www.sqlteam.com/article/using-bulk-insert-to-load-a-text-file](http://www.sqlteam.com/article/using-bulk-insert-to-load-a-text-file)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-30T03:38:03.353

我有时使用的另一个技巧是在 Excel 中打开 CSV，然后将 sql 语句写入每行末尾的单元格中。例如：

```
=concatenate("insert into myTable (columnA,columnB) values ('",a1,"','",b1,"'")") 
```

填写可以为您将其填充到每一行中。然后只需将输出复制并粘贴到新的查询窗口中。

这是老式的，但是如果您只需要偶尔进行一次导入，那么您可以省去阅读所有关于“正确”方法的晦涩文档的麻烦。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T20:24:43.197

尝试[OpenRowSet](http://support.microsoft.com/kb/321686)。这可用于导入 Excel 内容。Excel 可以打开 CSV 文件，因此您只需要找出正确的 [ConnectionString][2]。

[2]: Driver={Microsoft 文本驱动程序 (*.txt; *.csv)};Dbq=c:\txtFilesFolder\;Extensions=asc,csv,tab,txt;

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-19T05:58:36.700

我知道这不是一个真正的解决方案，但我使用一个虚拟表进行导入，并为所有内容设置了 nvarchar。然后我做了一个插入，它去掉了 " 字符并进行了转换。它不是很漂亮，但它可以完成工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-18T18:39:29.123

我说使用 FileHelpers 它是一个开源库

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T20:22:32.513

您需要以编程方式执行此操作，还是一次性完成？

使用企业管理器，右键单击导入数据可让您选择分隔符。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T21:36:09.920

您必须注意 BCP/BULK INSERT，因为如果引用不一致，BSP 或 Bulk Insert 都不能很好地处理这个问题，即使是格式文件（甚至 XML 格式文件也不提供选项）和虚拟 ["] 字符开始和结束并使用 [","] 作为分隔符。从技术上讲，如果没有嵌入的 [,] 字符，CSV 文件不需要有 ["] 字符

正是由于这个原因，逗号分隔的文件有时被称为喜剧限制文件。

OpenRowSet 将需要服务器上的 Excel，并且在 64 位环境中可能会出现问题 - 我知道在 64 位的 Jet 中使用 Excel 会出现问题。

如果文件将来可能与您的期望有所不同，SSIS 确实是您最好的选择。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-30T03:30:32.903

如果你愿意，你可以试试这个非常可爱的代码，这将从你的代码中删除不需要的分号。例如，如果您的数据是这样的：
“Kelly”、“Reynold”、“kelly@reynold.com”

```
Bulk insert test1
from 'c:\1.txt' with ( 
    fieldterminator ='","'
    ,rowterminator='\n')

update test1<br>
set name =Substring (name , 2,len(name))
where name like **' "% '**

update test1
set email=substring(email, 1,len(email)-1)
where email like **' %" '** 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-09-21T03:56:58.823

首先您需要将 CSV 文件导入数据表

然后您可以使用 SQLBulkCopy 插入批量行

```
using System;
using System.Data;
using System.Data.SqlClient;

namespace SqlBulkInsertExample
{
    class Program
    {
      static void Main(string[] args)
        {
            DataTable prodSalesData = new DataTable("ProductSalesData");

            // Create Column 1: SaleDate
            DataColumn dateColumn = new DataColumn();
            dateColumn.DataType = Type.GetType("System.DateTime");
            dateColumn.ColumnName = "SaleDate";

            // Create Column 2: ProductName
            DataColumn productNameColumn = new DataColumn();
            productNameColumn.ColumnName = "ProductName";

            // Create Column 3: TotalSales
            DataColumn totalSalesColumn = new DataColumn();
            totalSalesColumn.DataType = Type.GetType("System.Int32");
            totalSalesColumn.ColumnName = "TotalSales";

            // Add the columns to the ProductSalesData DataTable
            prodSalesData.Columns.Add(dateColumn);
            prodSalesData.Columns.Add(productNameColumn);
            prodSalesData.Columns.Add(totalSalesColumn);

            // Let's populate the datatable with our stats.
            // You can add as many rows as you want here!

            // Create a new row
            DataRow dailyProductSalesRow = prodSalesData.NewRow();
            dailyProductSalesRow["SaleDate"] = DateTime.Now.Date;
            dailyProductSalesRow["ProductName"] = "Nike";
            dailyProductSalesRow["TotalSales"] = 10;

            // Add the row to the ProductSalesData DataTable
            prodSalesData.Rows.Add(dailyProductSalesRow);

            // Copy the DataTable to SQL Server using SqlBulkCopy
            using (SqlConnection dbConnection = new SqlConnection("Data Source=ProductHost;Initial Catalog=dbProduct;Integrated Security=SSPI;Connection Timeout=60;Min Pool Size=2;Max Pool Size=20;"))
            {
                dbConnection.Open();
                using (SqlBulkCopy s = new SqlBulkCopy(dbConnection))
                {
                    s.DestinationTableName = prodSalesData.TableName;

                    foreach (var column in prodSalesData.Columns)
                        s.ColumnMappings.Add(column.ToString(), column.ToString());

                    s.WriteToServer(prodSalesData);
                }
            }
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-12-11T17:42:37.620

这是一个老问题，所以我写这篇文章是为了帮助任何偶然发现它的人。

SQL Server 2017 引入了 FIELDQUOTE 参数，该参数适用于这个确切的用例。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T20:22:52.030

是的，K Richard 是对的：`FIELDTERMINATOR = '","'`

有关详细信息，请参阅[http://www.sqlteam.com/article/using-bulk-insert-to-load-a-text-file](http://www.sqlteam.com/article/using-bulk-insert-to-load-a-text-file)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T20:49:58.207

您也可以使用 DTS 或 SSIS。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T21:51:29.760

您可以控制输入格式吗？| （管道），而 \t 通常是更好的字段终止符。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-19T06:04:43.957

如果您弄清楚如何将文件解析为 DataTable，我建议使用 SqlBulkInsert 类将其插入 SQL Server。

# php - 在 PHP 中使用会话的最新、最佳实践和最简单的方法是什么？

> ID：96460
> 
> 赞同：4
> 
> 时间：2008-09-18T20:18:39.170
> 
> 标签：php, session

PHP 中的会话似乎自我上次使用它们以来发生了变化，因此我正在寻找一种使用会话的简单方法，但同时它相对安全且是一种良好的常见做法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T20:39:06.313

会话管理在一段时间前发生了变化（我认为是 4.4 左右）。旧机制仍然有效，但已被弃用。它相当混乱，所以我建议远离它。今天，您通过访问全局变量 $_SESSION（它是一个数组）来使用会话。您*可以*将对象实例放在那里，但您需要在下一页开始会话之前加载这些对象的类定义。使用[自动加载](http://docs.php.net/manual/en/language.oop5.autoload.php)可以帮助你。

您必须先[启动会话](http://docs.php.net/manual/en/function.session-start.php)，然后才能使用 $_SESSION。由于启动会话会发送标头，因此您之前不能有任何输出。这可以通过以下两种方式之一解决：要么您总是在脚本开始时开始会话。或者您[缓冲所有输出](http://docs.php.net/manual/en/book.outcontrol.php)，并在脚本末尾将其发送出去。

> 一个好主意是在每个请求上重新生成会话。这使得劫持的可能性大大降低。

这是（稍微）不好的建议，因为它会使网站无法访问。每当用户权限发生变化时，您都应该[重新生成会话 ID 。](http://docs.php.net/manual/en/function.session-regenerate-id.php)一般来说，这意味着，每当他们登录时。这是为了防止会话固定（会话劫持的一种形式）。有关该主题的更多信息，请参阅[此最近的线程@Sitepoint](http://www.sitepoint.com/forums/showthread.php?t=571084)。

*仅*使用基于 cookie 的会话是可以的，但如果您在登录时重新生成会话 ID，它不会增加任何额外的安全性，并且会降低可访问性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T20:32:16.127

就简单性而言，没有比以下更好的了：

```
# Start the session manager
session_start(); 

# Set a var
$_SESSION['foo'] = 'whatever';

# Access the var
print $_SESSION['foo']; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T20:40:35.810

虽然数据库对于会话可能更安全，但您应该首先关注您在会话中存储的内容 - 它实际上不应该包含任何内容，只包含用于识别用户的 ID（并且可能是名字或页面之间的临时变量）。

我建议只使用默认的cookies。数据库会话在每一页上都会产生额外的影响，即使不是每个站点都是 slashdot，预优化这样简单的东西也没有什么坏处。

对于使用，我会推荐标准的全局变量：

```
$_SESSION['yourvar'] = 'somevalue'; 
```

如果您在所有代码中使用该方法，您可以稍后通过使用[session_set_save_handler](http://dk2.php.net/manual/en/function.session-set-save-handler.php)轻松更改后端，这提供了实现会话后端的统一方式。请注意，您可以使用一个对象来包含所有会话处理，只需为每个条目提供数组 - array('Staticclass', 'staticmethod')。

对于更深入的使用，我建议您看一下[KohanaPHP](http://www.kohanaphp.com/)中的会话是如何处理的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T20:33:22.223

如本书所述，您可以将 PHP 会话存储在数据库[中](http://www.wrox.com/WileyCDA/WroxTitle/Professional-PHP5.productCd-0764572822.html) 。我使用过这种方法，我发现它安全且易于实施，所以我会推荐它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T20:40:46.043

将 $SESSION 数组封装在 Session() 对象中，允许您以类似（但可分离）的方式从会话中获取变量、获取和发布，包括自动安全过滤器、闪存变量（使用一次然后被破坏的变量），和默认值设置器。

看看 Symfony 在这一点上的行为，它非常有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-11T11:59:35.170

会话是我 PHP 知识的重要组成部分，因为它帮助我解决了我在开发第一个 Web 应用程序时的登录身份验证问题。

```
session_start();
if( isset($_POST['username']) && isset($_POST['password']) )
{
    if( auth($_POST['username'], $_POST['password']) )
    {
        //Authentication passed
        $_SESSION['user'] = $_POST['username'];
        // redirect to required page
        header( "Location: index.php" );
    } 
    else 
    {
       //Authentication failed redirect to login
       header( "Location: loginform.html" );
    }
} 
else 
{
      //Username and Password are required
      header( "Location: loginform.html" );
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-18T20:27:30.770

首先，除非您有非常具体的商业理由不使用，否则仅使用基于 cookie。我有一个客户坚持只为一个项目使用基于 url 的会话。非常不安全，工作很痛苦。

一个好主意是在每个请求上重新生成会话。这使得劫持的可能性大大降低。例如。

```
session_start();
$old_sessionid = session_id();
session_regenerate_id();
$new_sessionid = session_id(); 
```

另一个好的做法是，如果您将某种用户登录作为系统的一部分，则在注销时完全无效并清空会话数据，以确保用户真正从系统中注销。我已经看到了通过删除会话 cookie 来完成注销的系统。

# javascript - 如何从 MooTools 中的 Request 对象中获取响应？

> ID：96463
> 
> 赞同：1
> 
> 时间：2008-09-18T20:18:52.743
> 
> 标签：javascript, ajax, mootools

您如何访问 MooTools 中 Request 对象的响应？我一直在查看文档和 MooTorial，但似乎没有取得任何进展。我用 MooTools 完成的其他 Ajax 东西我根本不需要操纵响应，所以我可以直接将它注入到文档中，但现在我需要先对其进行一些更改。我不想提醒响应，我想访问它，以便可以对其进行进一步更改。任何帮助将不胜感激。谢谢。

编辑：

我希望能够在请求已经发出后访问响应，最好是在 Request 对象之外。它用于 RSS 阅读器，因此我需要进行一些解析，而 Request 只是用于从服务器文件中获取提要。这个函数是一个类中的一个方法，它应该以字符串的形式返回响应，但它除了未定义之外什么都不返回：

```
 fetch: function(site){
                var feed;
                var req = new Request({
                        method: this.options.method,
                        url: this.options.rssFetchPath,
                        data: { 'url' : site },
            onRequest: function() {
                                if (this.options.targetId) { $
(this.options.targetId).setProperty('html',
this.options.onRequestMessage); }
                        }.bind(this),
                        onSuccess: function(responseText) {
                                feed = responseText;
                        }
                });
                req.send();
                return feed;
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T20:30:44.257

响应内容返回给 onComplete 中定义的匿名函数。

可以从那里访问它。

```
var req = new Request({
    method: 'get',
    url: ...,
    data: ...,
    onRequest: function() { alert('Request made. Please wait...'); },

    // the response is passed to the callback as the first parameter
    onComplete: function(response) { alert('Response: ' + response); }

}).send(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T21:23:20.373

[我可以在 Google 的 MooTools Group](http://groups.google.com/group/mootools-users/browse_thread/thread/7ade43ef51c91922)上找到我的答案。

# javascript - Javascript绘图库？

> ID：96486
> 
> 赞同：45
> 
> 时间：2008-09-18T20:22:22.890
> 
> 标签：javascript, graphics

对 JavaScript 交互式绘图库有什么建议吗？只需要绘制不同颜色的线条、多边形、文本。IE/Firefox/Opera/Safari 兼容。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-09-18T20:26:32.177

[Raphael](https://dmitrybaranovskiy.github.io/raphael/)在这方面非常酷，并且可以跨浏览器工作，因为它使用 VML（用于 MSIE）和 SVG（用于其他所有内容）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-18T20:24:51.120

John Resig 的[Processing.js](http://ejohn.org/blog/processingjs/)是一个很好的框架。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-18T20:23:41.077

您可以直接使用画布对象进行 2D 绘制。IE 需要 excanvas 库。

[http://developer.mozilla.org/En/Drawing_Graphics_with_Canvas](http://developer.mozilla.org/En/Drawing_Graphics_with_Canvas)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T20:25:33.320

试试[http://www.walterzorn.de/en/jsgraphics/jsgraphics_e.htm](http://www.walterzorn.de/en/jsgraphics/jsgraphics_e.htm)。这是我找到的最好的（不使用 SVG），并且可以在大多数没有插件的浏览器中使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T20:30:47.050

Drawing text with the canvas tag is a big pain. Your options are to use regular divs absolutely positioned in the right places, or find/write a font layout engine ([example](http://www.federated.com/%7Ejim/canvastext/)), or wait for a new standard to be implemented that lets you draw text. SVG deals with this much better.

In IE you have [ExplorerCanvas](http://excanvas.sourceforge.net/) to simulate the canvas API with IE's own VML markup. However, native VML can do text on a path and such things much like SVG. I think theoretically if you want complex text handling you'd want SVG and VML like the Raphael library that Dan mentioned.

You might also consider Flash for a moment before starting.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T20:31:17.017

As mentioned above, canvas is the way you should go. IE doesn't support it natively, so you'll need to download [ExCanvas](http://excanvas.sourceforge.net/) to ensure cross-browser compatibility. I'd recommend looking at [Ajaxian](http://ajaxian.com/by/topic/canvas) for some projects that use the canvas tag.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T20:33:27.653

Checkout the [jQuery Drawing plugin](http://plugins.jquery.com/project/Draw), and you can also look at the Mozilla [Canvas](http://developer.mozilla.org/En/Drawing_Graphics_with_Canvas) reference and [tutorial](http://developer.mozilla.org/en/Canvas_tutorial).

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-02-18T15:18:50.557

还有[mxGraph](http://www.jgraph.com/mxgraph.html)。这不使用 IE 的 excanvas。Excanvas 比使用 VML 慢得多，特别是重用相同的 VML 节点而不是删除、添加 DOM 节点以进行重绘。这通常是一个被忽视的点，但是关于 IE 性能的研究实在是太糟糕了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T20:24:52.523

根据您需要跨浏览器的程度以及进行输出的目标，您可能会查看 Canvas 元素和相关的 javascript。

[帆布](http://en.wikipedia.org/wiki/Canvas_(HTML_element))

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-05-27T14:04:29.483

[D3.js](http://d3js.org/)

> D3.js 是一个基于数据操作文档的 JavaScript 库。D3 帮助您使用 HTML、SVG 和 CSS 将数据变为现实。D3 对 Web 标准的重视为您提供了现代浏览器的全部功能，而无需将自己束缚于专有框架，结合了强大的可视化组件和数据驱动的 DOM 操作方法。

也看看这个[讨论](http://www.slant.co/topics/28/~what-are-the-best-javascript-drawing-libraries)。

# c++ - 返回默认构造值有什么问题吗？

> ID：96500
> 
> 赞同：7
> 
> 时间：2008-09-18T20:24:18.593
> 
> 标签：c++, oop, visual-c++, constructor

假设我有以下代码：

```
class some_class{};

some_class some_function()
{
    return some_class();
} 
```

这似乎工作得很好，并且省去了我必须声明一个变量来创建一个返回值的麻烦。但我认为我从未在任何类型的教程或参考资料中看到过这一点。这是特定于编译器的东西（Visual C++）吗？或者这是做错了什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-18T20:26:34.860

不，这是完全有效的。这也将更有效，因为编译器实际上能够优化掉临时的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T20:32:41.680

从函数调用返回对象是“工厂”设计模式，并且被广泛使用。

但是，无论是返回对象还是指向对象的指针，您都需要小心。前者将向您介绍复制构造函数/赋值运算符，这可能会很痛苦。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T20:38:02.337

它是有效的，但性能可能并不理想，具体取决于它的调用方式。

例如：

```
A a;
a = fn(); 
```

和

```
A a = fn(); 
```

不一样。

在第一种情况下，调用默认构造函数，然后在需要构造临时变量的 a 上调​​用赋值运算符。

在第二种情况下，使用了复制构造函数。

一个足够聪明的编译器会计算出哪些优化是可能的。但是，如果复制构造函数是用户提供的，那么我看不到编译器如何优化临时变量。它必须调用复制构造函数，并且为此它必须有另一个实例。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T20:47:01.817

Rob Walker 的示例之间的区别称为返回值优化 (RVO)，如果您想搜索它。

顺便说一句，如果您想确保您的对象以最有效的方式返回，请使用 shared_ptr 在堆上创建对象（即通过 new）并返回 shared_ptr。指针被返回并且引用计数正确。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T20:26:37.497

这是完全合理的 C++。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T20:27:45.543

这是完全合法的 C++，任何编译器都应该接受它。是什么让您认为它可能做错了什么？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T20:43:25.600

如果您的课程非常轻量级，那是最好的方法——我的意思是复制它并不是很昂贵。

但是，该方法的一个副作用是它确实倾向于使其更有可能创建临时对象，尽管这可能取决于编译器对事物的优化程度。

对于要确保不复制的更重量级的类（例如，一个大的位图图像），最好将类似的东西作为参考参数传递，然后将其填充，以确保绝对确保不会创建任何临时对象。

总体而言，简化语法并使事情变得更直接可能会产生在表达式中创建更多临时对象的副作用，这正是您在为更重量级的对象设计接口时应该牢记的事情。

# python - 如何将 pyOpenSSL verify_cb 的 ssl 证书中的 cn 关联到生成的套接字

> ID：96508
> 
> 赞同：6
> 
> 时间：2008-09-18T20:24:43.977
> 
> 标签：python, pyopenssl

我对 pyOpenSSL 有点陌生。我试图弄清楚如何将生成的套接字与 ssl 证书相关联。verify_cb 被调用，这使我可以访问证书和 conn，但是当发生这种情况时我如何关联这些东西：

cli,addr = self.server.accept()

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T20:49:43.353

握手完成后，即可获得客户端证书。虽然客户端证书在验证回调 (verify_cb) 中也可用，但除了在该回调中验证证书之外，没有任何理由尝试做任何事情。握手完全成功后，最好设置应用程序特定的映射。因此，请考虑使用 accept 方法返回的 OpenSSL.SSL.Connection 实例来获取证书（并从那里获取 commonName）并将其与此时的连接对象相关联。例如，

```
client, clientAddress = self.server.accept()
client.do_handshake()
commonNamesToConnections[client.get_peer_certificate().commonName] = client 
```

您可能需要检查映射以确保您没有覆盖任何现有连接（可能使用连接列表而不是仅将每个通用名称映射到一个）。当然，当连接丢失时，您需要删除条目。

`do_handshake' 调用强制握手实际发生。如果没有这个，握手将在应用程序数据首次通过连接传输时发生。这很好，但它会使设置这个映射稍微复杂一些。

# c# - 在 C# 中更改 ContextMenu 字体大小

> ID：96525
> 
> 赞同：4
> 
> 时间：2008-09-18T20:26:31.227
> 
> 标签：c#, .net, contextmenu, font-size

是否可以使用 .NET Framework 3.5 和 C# 为桌面应用程序更改 ContextMenu 中使用的字体大小？它似乎是一个系统范围的设置，但我只想在我的应用程序中更改它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T20:38:53.333

`ContextMenuStrip`如果您通过Windows 窗体中的 a 定义自己的上下文菜单，请使用*Font*属性。

如果您通过 WPF 中的 a 定义自己的上下文菜单`ContextMenu`，请使用各种*Fontxxx*属性，例如*FontFamily*和*FontSize*。

您不能更改控件附带的默认上下文菜单；这些是由系统设置决定的。因此，如果您想要“复制/剪切/粘贴/等”。具有自定义字体大小的 WinForms 菜单`TextBox`，您必须创建`ContextMenuStrip`具有适当字体大小的菜单并将其分配给`TextBox`的*ContextMenuStrip*属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T20:33:22.753

您可以更改 System.Windows.Forms.ContextMenuStrip 的字体大小。

如果您需要更改文本框上默认剪切/复制/粘贴上下文菜单的字体大小，我猜您需要将 ContextMenu 属性设置为替换默认菜单的自定义菜单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T20:50:47.267

在 WPF 中：

```
<Window.ContextMenu FontSize="36">
    <!-- ... -->
</Window.ContextMenu 
```

在 WinForms 中：

```
contextMenuStrip1.Font = new System.Drawing.Font("Segoe UI", 24F); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T20:39:22.210

你提到 .NET 3.5 - 你是用 WPF 写的吗？如果是这样，您可以为 TextBlock.FontSize 附加属性指定字体大小

```
<Whatever.ContextMenu TextBlock.FontSize="12">
  <MenuItem ... /> <!-- Will get the font size from parent -->
</Whatever.ContextMenu> 
```

或者，您可以以影响所有菜单项的样式指定它

```
<Style TargetType="MenuItem">
   <Setter Property="TextBlock.FontSize" Value="12" />
</Style> 
```

当然，最好让系统设置决定字体大小。有些人可能已经更改它以更好地适应他们的身体状况（如视力不佳）或硬件（大/小屏幕）。无论你在代码中强加什么，对某些人来说都是错误的选择，而你却让他们无法更改它。

# qt - 与没有 MFC 的 CMutex 交互

> ID：96538
> 
> 赞同：1
> 
> 时间：2008-09-18T20:27:01.333
> 
> 标签：qt, mfc

我们有多个 MFC 应用程序，它们使用 CMutex(false, "blah")，其中 "blah" 允许互斥锁跨进程边界工作。

其中一个应用程序是在没有 MFC 的情况下重写的（改用 Qt）。如何使用 Win32 调用模拟 CMutex？（Qt 的 QMutex 不是进程间的。）我不想修改 MFC 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T20:34:58.943

对于进程间互斥体，您需要以下调用：

> [创建互斥体](http://msdn.microsoft.com/en-us/library/ms682411(VS.85).aspx)
> 
> [等待单个对象](http://msdn.microsoft.com/en-us/library/ms687032(VS.85).aspx)
> 
> [释放互斥锁](http://msdn.microsoft.com/en-us/library/ms685066(VS.85).aspx)
> 
> [关闭手柄](http://msdn.microsoft.com/en-us/library/ms724211(VS.85).aspx)

这些是 CMutex 封装的底层 Win32 API 调用。

对于仅进程内的互斥锁，您还可以使用这些调用，它们更快：

> [InitializeCriticalSection](http://msdn.microsoft.com/en-us/library/ms683472(VS.85).aspx)
> 
> [EnterCriticalSection](http://msdn.microsoft.com/en-us/library/ms683472(VS.85).aspx)
> 
> [离开关键部分](http://msdn.microsoft.com/en-us/library/ms683472(VS.85).aspx)
> 
> [删除关键部分](http://msdn.microsoft.com/en-us/library/ms682552(VS.85).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T20:28:59.927

以下功能可能是您想要的，它们都记录在 MSDN 上。

```
CreateMutex(...)
WaitForSingleObject(...)
ReleaseMutex(...) 
```

# .net - 有没有一种优雅的方法来实例化带有参数的变量类型？

> ID：96541
> 
> 赞同：-1
> 
> 时间：2008-09-18T20:27:14.547
> 
> 标签：.net, generics, instantiation

这是不合法的：

```
public class MyBaseClass
{
  public MyBaseClass() {}
  public MyBaseClass(object arg) {}
}

public void ThisIsANoNo<T>() where T : MyBaseClass
{
  T foo = new T("whoops!");
} 
```

为此，您必须对 T 的类型对象进行一些反思，或者您必须使用 Activator.CreateInstance。两个都很恶心。有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T20:28:56.320

没有。如果您没有传入参数，那么您可以将类型参数限制为需要无参数构造函数。但是，如果您需要传递参数，那么您就不走运了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T20:45:13.130

您不能将 T 限制为具有除空构造函数之外的特定构造函数签名，但您可以将 T 限制为具有具有所需签名的工厂方法：

```
public abstract class MyBaseClass
{
    protected MyBaseClass() {}
    protected abstract MyBaseClass CreateFromObject(object arg);
}

public void ThisWorksButIsntGreat<T>() where T : MyBaseClass, new()
{
    T foo = new T().CreateFromObject("whoopee!") as T;
} 
```

但是，我建议也许在这种情况下使用不同的创建模式，例如抽象工厂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T20:28:55.493

```
where T : MyBaseClass, new() 
```

仅适用于无参数公共构造函数。除此之外，回到 activator.CreateInstance （这真的不是那么糟糕）。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-09-18T20:31:37.407

我可以看到这不起作用。

但是是什么阻止你这样做呢？

```
public void ThisIsANoNo<T>() where T : MyBaseClass
{
  MyBaseClass foo = new MyBaseClass("whoops!");
} 
```

由于所有内容都将从 MyBaseClass 继承，它们都将是 MyBaseClass，对吗？

我试过了，这行得通。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            ThisIsANoNo<MyClass>();
            ThisIsANoNo<MyBaseClass>();
        }

        public class MyBaseClass
        {
            public MyBaseClass() { }
            public MyBaseClass(object arg) { }
        }

        public class MyClass :MyBaseClass
        {
            public MyClass() { }
            public MyClass(object arg, Object arg2) { }
        }

        public static void ThisIsANoNo<T>() where T : MyBaseClass
        {
            MyBaseClass foo = new MyBaseClass("whoops!");
        }
    }
} 
```

# mysql - SQL 查询长度的实际限制（特别是 MySQL）

> ID：96553
> 
> 赞同：17
> 
> 时间：2008-09-18T20:28:19.397
> 
> 标签：mysql, sql, optimization

有很多（可能是冗余的）WHERE 子句的非常非常大的 SQL 查询是不是特别糟糕？

例如，这是我从我的 Web 应用程序中生成的一个查询，所有内容都已关闭，这应该是该程序生成的最大可能查询：

```
SELECT * 
FROM 4e_magic_items 
INNER JOIN 4e_magic_item_levels 
  ON 4e_magic_items.id = 4e_magic_item_levels.itemid 
INNER JOIN 4e_monster_sources 
  ON 4e_magic_items.source = 4e_monster_sources.id 
WHERE (itemlevel BETWEEN 1 AND 30)  
  AND source!=16 AND source!=2 AND source!=5 
  AND source!=13 AND source!=15 AND source!=3 
  AND source!=4 AND source!=12 AND source!=7 
  AND source!=14 AND source!=11 AND source!=10 
  AND source!=8 AND source!=1 AND source!=6 
  AND source!=9  AND type!='Arms' AND type!='Feet' 
  AND type!='Hands' AND type!='Head' 
  AND type!='Neck' AND type!='Orb' 
  AND type!='Potion' AND type!='Ring' 
  AND type!='Rod' AND type!='Staff' 
  AND type!='Symbol' AND type!='Waist' 
  AND type!='Wand' AND type!='Wondrous Item' 
  AND type!='Alchemical Item' AND type!='Elixir' 
  AND type!='Reagent' AND type!='Whetstone' 
  AND type!='Other Consumable' AND type!='Companion' 
  AND type!='Mount' AND (type!='Armor' OR (false )) 
  AND (type!='Weapon' OR (false )) 
 ORDER BY type ASC, itemlevel ASC, name ASC 
```

它似乎工作得很好，但它的流量也不是特别高（每天几百次左右），我想知道是否值得努力优化查询以消除冗余等。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-18T20:32:38.653

阅读您的查询让我想玩角色扮演游戏。

这绝对不会太长。只要它们格式正确，我会说实际限制约为 100 行。在那之后，您最好将子查询分解为视图，以防止您的视线交叉。

我处理过一些超过 1000 行的查询，这很难调试。

顺便问一下，我可以建议一个重新格式化的版本吗？这主要是为了证明格式化的重要性；我相信这会更容易理解。

```
select *  
from
  4e_magic_items mi
 ,4e_magic_item_levels mil
 ,4e_monster_sources ms
where mi.id = mil.itemid
  and mi.source = ms.id
  and itemlevel between 1 and 30
  and source not in(16,2,5,13,15,3,4,12,7,14,11,10,8,1,6,9)  
  and type not in(
                  'Arms' ,'Feet' ,'Hands' ,'Head' ,'Neck' ,'Orb' ,
                  'Potion' ,'Ring' ,'Rod' ,'Staff' ,'Symbol' ,'Waist' ,
                  'Wand' ,'Wondrous Item' ,'Alchemical Item' ,'Elixir' ,
                  'Reagent' ,'Whetstone' ,'Other Consumable' ,'Companion' ,
                  'Mount'
                 )
  and ((type != 'Armor') or (false))
  and ((type != 'Weapon') or (false))
order by
  type asc
 ,itemlevel asc
 ,name asc

/*
Some thoughts:
==============
0 - Formatting really matters, in SQL even more than most languages.
1 - consider selecting only the columns you need, not "*"
2 - use of table aliases makes it short & clear ("MI", "MIL" in my example)
3 - joins in the WHERE clause will un-clutter your FROM clause
4 - use NOT IN for long lists
5 - logically, the last two lines can be added to the "type not in" section.
    I'm not sure why you have the "or false", but I'll assume some good reason
    and leave them here.
*/ 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-18T20:32:16.640

默认 MySQL 5.0 服务器限制为“ **1MB** ”，最高可配置为 1GB。

这是通过客户端和服务器上的[max_allowed_pa​​cket](http://dev.mysql.com/doc/refman/5.0/en/packet-too-large.html)设置进行配置的，有效限制是两者的出租者。

注意事项：

*   这种“数据包”限制可能不会直接映射到 SQL 语句中的字符。当然，您要考虑客户端中的字符编码、一些数据包元数据等）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-03-04T08:49:44.467

> 选择@@global.max_allowed_pa​​cket

这是它在服务器上可调整的唯一真正限制，因此没有真正的直接答案

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T20:39:23.067

从实际的角度来看，我通常认为任何最终花费超过 10 行来编写（将每个子句/条件放在单独的行上）的 SELECT 都太长而难以维护。在这一点上，它可能应该作为某种存储过程来完成，或者我应该尝试找到一种更好的方式来表达相同的概念——可能通过创建一个中间表来捕获我似乎经常查询的一些关系。

您的里程可能会有所不同，并且有一些非常长的查询有充分的理由。但我的经验法则是 10 行。

**示例**（稍微不正确的 SQL）：

```
SELECT x, y, z
FROM a, b
WHERE fiz = 1
AND foo = 2
AND a.x = b.y
AND b.z IN (SELECT q, r, s, t
            FROM c, d, e
            WHERE c.q = d.r
              AND d.s = e.t
              AND c.gar IS NOT NULL)
ORDER BY b.gonk 
```

这可能太大了；然而，优化很大程度上取决于上下文。

请记住，查询越长越复杂，维护起来就越困难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T20:30:20.030

大多数数据库都支持存储过程来避免这个问题。如果您的代码运行速度足够快且易于阅读，您就不必为了缩短编译时间而对其进行更改。

另一种方法是使用准备好的语句，这样每个客户端连接只获得一次命中，然后只传递每个调用的参数

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T20:34:39.850

我假设您的意思是“关闭”字段没有值？

而不是检查某些东西是否不是这个，它也不是那个等等。你不能只检查该字段是否为空吗？或者将该字段设置为“关闭”，并检查类型或其他是否等于“关闭”。

# flash - Arial Font doesn't display properly in Mac

> ID：96562
> 
> 赞同：4
> 
> 时间：2008-09-18T20:29:19.520
> 
> 标签：flash, macos, fonts

I have a flash movie with a dynamic text that supposedly is Arial, and in my windows machine it displays as Arial. But when I tried it in a Mac, it shows as something like Times New Roman.

I tried every property available and can't seem to get it to show as Arial on the Mac.

I found another movie I had that didn't have this problem, so to pinpoint the problem I made a very simple movie. First I took a dynamic text from the other movie that worked and pasted it a new fla. Then I created a new text, and copied every property one by one. When I published it, the original text was showing as Arial, but not the new one, even if they had the same properties! (at least the ones I can edit in flash's properties editor.

I'm using Adobe Flash CS3 Professional.

What do you think can be the problem?? Are there any properties that aren't in the property editor? (I also checked filters, and Transformations)

Both are Dynamic texts, with no Instance Name, "Anti-alias for animation", Multiline, I'm not embeding the font and have checked "Render text as HTML".

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T05:45:48.260

当您使用动态文本字段时，您有两种选择 - 将字体嵌入（部分）到 SWF 中，或者使用设备字体。如果您嵌入，那么实际的字符形状将内置到您的 SWF 中；如果你没有，那么你只包括字体的*名称*- 如果操作系统没有任何该名称的字体，它将选择默认值。

从您从另一个文件复制的字段的问题来看，听起来您可能错过了“嵌入”设置。在属性检查器中查找标记为“嵌入设置”或类似的按钮。

如果您选择嵌入，则可以保证您的文本将在所有平台上以 Arial 呈现。但是，这只适用于您嵌入的字符。如果您只嵌入大写字母，然后将文本设置为“Hello”，那么您将在屏幕上看到的只有“H”。（小心嵌入整个字体 - 对于将有几兆字节的完整 unicode 字体，因为它们包括日文和中文等等。）

如果您选择不嵌入，那么为避免您遇到的问题，您可能应该使用字体菜单中首先列出的“设备”字体之一：**_sans、_serif、_typewriter**。在几乎所有情况下，这些都将在 PC 上转换为 Arial、Times 和 Courier，在 Mac 上转换为类似字体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T20:46:50.663

Arial*是*Helvatica 的 Windows 版本。DTP 是在 Mac 上发明的，微软基本上在 Windows 3.0 左右的某个时候创建​​了自己的 Mac 字体版本

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T20:37:18.003

Use Arial/Helvetica FontFamily

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T20:38:41.680

If you're not embedding the font then you're at the mercy of the player, and Arial is a Windows-only font. If all you want is the system's sans-serif font, try setting the font name to _sans

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T20:38:55.003

[You *can* embed fonts in Flash.](http://www.adobe.com/devnet/flash/quickstart/embedding_fonts/)

# c++ - STL vectors with uninitialized storage?

> ID：96579
> 
> 赞同：51
> 
> 时间：2008-09-18T20:31:31.480
> 
> 标签：c++, optimization, stl, vector

I'm writing an inner loop that needs to place `struct`s in contiguous storage. I don't know how many of these `struct`s there will be ahead of time. My problem is that STL's `vector` initializes its values to 0, so no matter what I do, I incur the cost of the initialization plus the cost of setting the `struct`'s members to their values.

Is there any way to prevent the initialization, or is there an STL-like container out there with resizeable contiguous storage and uninitialized elements?

(I'm certain that this part of the code needs to be optimized, and I'm certain that the initialization is a significant cost.)

Also, see my comments below for a clarification about when the initialization occurs.

SOME CODE:

```
void GetsCalledALot(int* data1, int* data2, int count) {
    int mvSize = memberVector.size()
    memberVector.resize(mvSize + count); // causes 0-initialization

    for (int i = 0; i < count; ++i) {
        memberVector[mvSize + i].d1 = data1[i];
        memberVector[mvSize + i].d2 = data2[i];
    }
} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-18T22:12:49.817

`std::vector` must initialize the values in the array somehow, which means some constructor (or copy-constructor) must be called. The behavior of `vector` (or any container class) is undefined if you were to access the uninitialized section of the array as if it were initialized.

The best way is to use `reserve()` and `push_back()`, so that the copy-constructor is used, avoiding default-construction.

Using your example code:

```
struct YourData {
    int d1;
    int d2;
    YourData(int v1, int v2) : d1(v1), d2(v2) {}
};

std::vector<YourData> memberVector;

void GetsCalledALot(int* data1, int* data2, int count) {
    int mvSize = memberVector.size();

    // Does not initialize the extra elements
    memberVector.reserve(mvSize + count);

    // Note: consider using std::generate_n or std::copy instead of this loop.
    for (int i = 0; i < count; ++i) {
        // Copy construct using a temporary.
        memberVector.push_back(YourData(data1[i], data2[i]));
    }
} 
```

The only problem with calling `reserve()` (or `resize()`) like this is that you may end up invoking the copy-constructor more often than you need to. If you can make a good prediction as to the final size of the array, it's better to `reserve()` the space once at the beginning. If you don't know the final size though, at least the number of copies will be minimal on average.

In the current version of C++, the inner loop is a bit inefficient as a temporary value is constructed on the stack, copy-constructed to the vectors memory, and finally the temporary is destroyed. However the next version of C++ has a feature called R-Value references (`T&&`) which will help.

The interface supplied by `std::vector` does not allow for another option, which is to use some factory-like class to construct values other than the default. Here is a rough example of what this pattern would look like implemented in C++:

```
template <typename T>
class my_vector_replacement {

    // ...

    template <typename F>
    my_vector::push_back_using_factory(F factory) {
        // ... check size of array, and resize if needed.

        // Copy construct using placement new,
        new(arrayData+end) T(factory())
        end += sizeof(T);
    }

    char* arrayData;
    size_t end; // Of initialized data in arrayData
};

// One of many possible implementations
struct MyFactory {
    MyFactory(int* p1, int* p2) : d1(p1), d2(p2) {}
    YourData operator()() const {
        return YourData(*d1,*d2);
    }
    int* d1;
    int* d2;
};

void GetsCalledALot(int* data1, int* data2, int count) {
    // ... Still will need the same call to a reserve() type function.

    // Note: consider using std::generate_n or std::copy instead of this loop.
    for (int i = 0; i < count; ++i) {
        // Copy construct using a factory
        memberVector.push_back_using_factory(MyFactory(data1+i, data2+i));
    }
} 
```

Doing this does mean you have to create your own vector class. In this case it also complicates what should have been a simple example. But there may be times where using a factory function like this is better, for instance if the insert is conditional on some other value, and you would have to otherwise unconditionally construct some expensive temporary even if it wasn't actually needed.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-08-27T14:43:06.233

In C++11 (and boost) you can use the array version of `unique_ptr` to allocate an uninitialized array. This isn't quite an stl container, but is still memory managed and C++-ish which will be good enough for many applications.

```
auto my_uninit_array = std::unique_ptr<mystruct[]>(new mystruct[count]); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-05-09T18:48:14.380

C++0x adds a new member function template `emplace_back` to `vector` (which relies on variadic templates and perfect forwarding) that gets rid of any temporaries entirely:

```
memberVector.emplace_back(data1[i], data2[i]); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-18T20:56:31.480

To clarify on reserve() responses: you need to use reserve() in conjunction with push_back(). This way, the default constructor is not called for each element, but rather the copy constructor. You still incur the penalty of setting up your struct on stack, and then copying it to the vector. On the other hand, it's possible that if you use

```
vect.push_back(MyStruct(fieldValue1, fieldValue2)) 
```

the compiler will construct the new instance directly in the memory thatbelongs to the vector. It depends on how smart the optimizer is. You need to check the generated code to find out.

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2020-05-06T17:44:33.847

You can use `boost::noinit_adaptor` to [*default initialize*](https://en.cppreference.com/w/cpp/language/default_initialization) new elements (which is no initialization for built-in types):

```
std::vector<T, boost::noinit_adaptor<std::allocator<T>> memberVector; 
```

As long as you don't pass an initializer into `resize`, it *default initializes* the new elements.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-18T20:55:08.507

So here's the problem, resize is calling insert, which is doing a copy construction from a default constructed element for each of the newly added elements. To get this to 0 cost you need to write your own default constructor AND your own copy constructor as empty functions. Doing this to your copy constructor is a **very bad idea** because it will break std::vector's internal reallocation algorithms.

Summary: You're not going to be able to do this with std::vector.

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-02-28T13:52:53.733

You can use a wrapper type around your element type, with a default constructor that does nothing. E.g.:

```
template <typename T>
struct no_init
{
    T value;

    no_init() { static_assert(std::is_standard_layout<no_init<T>>::value && sizeof(T) == sizeof(no_init<T>), "T does not have standard layout"); }

    no_init(T& v) { value = v; }
    T& operator=(T& v) { value = v; return value; }

    no_init(no_init<T>& n) { value = n.value; }
    no_init(no_init<T>&& n) { value = std::move(n.value); }
    T& operator=(no_init<T>& n) { value = n.value; return this; }
    T& operator=(no_init<T>&& n) { value = std::move(n.value); return this; }

    T* operator&() { return &value; } // So you can use &(vec[0]) etc.
}; 
```

To use:

```
std::vector<no_init<char>> vec;
vec.resize(2ul * 1024ul * 1024ul * 1024ul); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-18T20:34:49.723

Err...

try the method:

```
std::vector<T>::reserve(x) 
```

It will enable you to reserve enough memory for x items without initializing any (your vector is still empty). Thus, there won't be reallocation until to go over x.

The second point is that vector won't initialize the values to zero. Are you testing your code in debug ?

After verification on g++, the following code:

```
#include <iostream>
#include <vector>

struct MyStruct
{
   int m_iValue00 ;
   int m_iValue01 ;
} ;

int main()
{
   MyStruct aaa, bbb, ccc ;

   std::vector<MyStruct> aMyStruct ;

   aMyStruct.push_back(aaa) ;
   aMyStruct.push_back(bbb) ;
   aMyStruct.push_back(ccc) ;

   aMyStruct.resize(6) ; // [EDIT] double the size

   for(std::vector<MyStruct>::size_type i = 0, iMax = aMyStruct.size(); i < iMax; ++i)
   {
      std::cout << "[" << i << "] : " << aMyStruct[i].m_iValue00 << ", " << aMyStruct[0].m_iValue01 << "\n" ;
   }

   return 0 ;
} 
```

gives the following results:

```
[0] : 134515780, -16121856
[1] : 134554052, -16121856
[2] : 134544501, -16121856
[3] : 0, -16121856
[4] : 0, -16121856
[5] : 0, -16121856 
```

The initialization you saw was probably an artifact.

[EDIT] After the comment on resize, I modified the code to add the resize line. The resize effectively calls the default constructor of the object inside the vector, but if the default constructor does nothing, then nothing is initialized... I still believe it was an artifact (I managed the first time to have the whole vector zerooed with the following code:

```
aMyStruct.push_back(MyStruct()) ;
aMyStruct.push_back(MyStruct()) ;
aMyStruct.push_back(MyStruct()) ; 
```

So... :-/

[EDIT 2] Like already offered by Arkadiy, the solution is to use an inline constructor taking the desired parameters. Something like

```
struct MyStruct
{
   MyStruct(int p_d1, int p_d2) : d1(p_d1), d2(p_d2) {}
   int d1, d2 ;
} ; 
```

This will probably get inlined in your code.

But you should anyway study your code with a profiler to be sure this piece of code is the bottleneck of your application.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T20:32:47.700

Use the std::vector::reserve() method. It won't resize the vector, but it will allocate the space.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T20:57:42.680

From your comments to other posters, it looks like you're left with malloc() and friends. Vector won't let you have unconstructed elements.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T21:15:16.413

From your code, it looks like you have a vector of structs each of which comprises 2 ints. Could you instead use 2 vectors of ints? Then

```
copy(data1, data1 + count, back_inserter(v1));
copy(data2, data2 + count, back_inserter(v2)); 
```

Now you don't pay for copying a struct each time.

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-09-07T16:56:28.920

If you really insist on having the elements uninitialized and sacrifice some methods like front(), back(), push_back(), use boost vector from numeric . It allows you even not to preserve existing elements when calling resize()...

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T20:44:24.677

Do the structs themselves need to be in contiguous memory, or can you get away with having a vector of struct*?

Vectors make a copy of whatever you add to them, so using vectors of pointers rather than objects is one way to improve performance.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T20:53:25.623

I don't think STL is your answer. You're going to need to roll your own sort of solution using realloc(). You'll have to store a pointer and either the size, or number of elements, and use that to find where to start adding elements after a realloc().

```
int *memberArray;
int arrayCount;
void GetsCalledALot(int* data1, int* data2, int count) {
    memberArray = realloc(memberArray, sizeof(int) * (arrayCount + count);
    for (int i = 0; i < count; ++i) {
        memberArray[arrayCount + i].d1 = data1[i];
        memberArray[arrayCount + i].d2 = data2[i];
    }
    arrayCount += count;
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T21:59:47.693

I would do something like:

```
void GetsCalledALot(int* data1, int* data2, int count)
{
  const size_t mvSize = memberVector.size();
  memberVector.reserve(mvSize + count);

  for (int i = 0; i < count; ++i) {
    memberVector.push_back(MyType(data1[i], data2[i]));
  }
} 
```

You need to define a ctor for the type that is stored in the memberVector, but that's a small cost as it will give you the best of both worlds; no unnecessary initialization is done and no reallocation will occur during the loop.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-10-05T14:51:28.567

I'm not sure about all those answers that says it is impossible or tell us about undefined behavior.

Sometime, you need to use an std::vector. But sometime, you know the final size of it. And you also know that your elements will be constructed later. Example : When you serialize the vector contents into a binary file, then read it back later. Unreal Engine has its TArray::setNumUninitialized, why not std::vector ?

To answer the initial question "Is there any way to prevent the initialization, or is there an STL-like container out there with resizeable contiguous storage and uninitialized elements?"

yes and no. No, because STL doesn't expose a way to do so.

Yes because we're coding in C++, and C++ allows to do a lot of thing. If you're ready to be a bad guy (and if you really know what you are doing). You can hijack the vector.

Here a sample code that works only for the Windows's STL implementation, for another platform, look how std::vector is implemented to use its internal members :

```
// This macro is to be defined before including VectorHijacker.h. Then you will be able to reuse the VectorHijacker.h with different objects.
#define HIJACKED_TYPE SomeStruct

// VectorHijacker.h
#ifndef VECTOR_HIJACKER_STRUCT
#define VECTOR_HIJACKER_STRUCT

struct VectorHijacker
{
    std::size_t _newSize;
};

#endif

template<>
template<>
inline decltype(auto) std::vector<HIJACKED_TYPE, std::allocator<HIJACKED_TYPE>>::emplace_back<const VectorHijacker &>(const VectorHijacker &hijacker)
{
    // We're modifying directly the size of the vector without passing by the extra initialization. This is the part that relies on how the STL was implemented.
    _Mypair._Myval2._Mylast = _Mypair._Myval2._Myfirst + hijacker._newSize;
}

inline void setNumUninitialized_hijack(std::vector<HIJACKED_TYPE> &hijackedVector, const VectorHijacker &hijacker)
{
    hijackedVector.reserve(hijacker._newSize);
    hijackedVector.emplace_back<const VectorHijacker &>(hijacker);
} 
```

But beware, this is hijacking we're speaking about. This is really dirty code, and this is only to be used if you really know what you are doing. Besides, it is not portable and relies heavily on how the STL implementation was done.

I won't advise you to use it because everyone here (me included) is a good person. But I wanted to let you know that it is possible contrary to all previous answers that stated it wasn't.

# linux - 如何在 CentOS 5 上升级到 Subversion 1.5？

> ID：96597
> 
> 赞同：22
> 
> 时间：2008-09-18T20:32:37.640
> 
> 标签：linux, svn, version-control, centos, centos5

我的开发服务器（CentOS 5）正在运行 Subversion 1.4.2，我希望将其升级到 1.5。我在网络上散布的各种博客和文档中读到，这可以通过使用 RPMForge 来完成。我已按照[CentOS Wiki](http://wiki.centos.org/AdditionalResources/Repositories/RPMForge?action=show&redirect=Repositories%2FRPMForge)上的说明进行操作，包括安装 yum-priorities 并按照指示设置我的优先级（1 和 2 用于核心 repo 源，20 用于 RPMForge）。

但是，当我尝试运行时：

```
$ yum info subversion 
```

给我的版本号仍然是 1.4.2，状态为已安装。此时我的另一个选择是从源代码编译，但我想找到一个包管理的解决方案以方便将来升级。

有什么想法吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-09-18T21:21:05.510

您要做的是将“核心”软件包（包含在 CentOS 存储库中的软件包）替换为来自“第 3 方”存储库 (RPMForge) 的较新软件包，这是优先级插件旨在防止的。

RPMForge 储存库包含 CentOS 中没有的额外组件，以及更新版本的核心组件。不幸的是，`yum` 它非常愚蠢，并且总是将包更新到它可以在*任何*存储库中找到的最新版本。因此，在启用 RPMforge 的情况下运行“ `yum update`”将使用来自 RPMForge 的最新（前沿，可能不稳定且支持较少）软件包更新您系统的一半。

因此，使用 RPMForge 等 repos 的推荐方法是仅将它们与 yum 插件（如“priorites”）一起使用，这可以防止来自“高”优先级 repos 的包覆盖来自“低”优先级 repos 的包（“priority”的名称" 参数非常具有误导性）。通过这种方式，您可以从 RPMForge 安装*额外*的包（不在核心中），这是大多数人想要的。

现在到你原来的问题......

如果你*想*替换一个核心包，事情会变得有点棘手。基本上，您有两种选择：

1.  卸载优先插件，并默认*禁用*RPMForge 存储库（`enabled = 0`在 中设置`/etc/yum.repos.d/rpmforge.repo`）。然后，您可以在命令行上选择性地启用它：

    ```
    yum --enablerepo=rpmforge install subversion 
    ```

    将从 RPMForge 安装最新的 subversion 和依赖项。

    这种方法的问题在于，如果 RPMForge 中的 subversion 包有更新，那么当 repo 被禁用时，您将看不到它。要使颠覆保持最新，您必须记住运行

    ```
    yum --enablerepo=rpmforge update subversion 
    ```

    时。

2.  第二种可能性是使用priorites 插件，但手动“屏蔽”核心颠覆包（添加`exclude=subversion`到 `[base]`和`[update]`中的部分`/etc/yum.repos.d/CentOS-Base.repo`）。

    现在 yum 将表现得好像核心存储库中没有名为“subversion”的包，并愉快地从 RPMForge 安装最新版本。另外，运行时您将始终获得最新的 subversion 更新`yum update`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-28T16:27:01.030

1.- 如果您使用 yum-priorities 在文件中禁用它`/etc/yum/pluginconf.d/priorities.conf`

2.-检查颠覆的版本

```
 $ rpm -qa|grep subversion
    subversion-1.4.2-4.el5_3.1
    subversion-1.4.2-4.el5_3.1 
```

3.- 从 rpmforge 存储库中搜索 subversion 的最新版本

```
$ yum --enablerepo=rpmforge check-update subversion
subversion.x86_64      1.6.6-0.1.el5.rf         rpmforge 
```

4.- 现在使用 rpmforge 存储库升级 subversion

```
$ yum shell
>erase mod_dav_svn-1.4.2-4.el5_3.1
>erase subversion-1.4.2-4.el5_3.1
>install mod_dav_svn-1.6.6-0.1.el5.rf
>install subversion-1.6.6-0.1.el5.rf.x86_64
>run 
```

这就是我运行centos 5.4的全部内容

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-10T17:20:41.803

谢谢马特 - 我们在 SVN 上也有唯一的 SVN 1.7 发行[版](http://wandisco.com/subversion/downloads)。

您可能还想尝试[uberSVN](http://www.uberSVN.com)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T20:37:50.823

如果您安装[RPMForge](http://wiki.centos.org/AdditionalResources/Repositories/RPMForge)的存储库，那么您应该能够获得更新的软件包 - 这对您不起作用？

您应该在 /etc/apt/sources.list.d 中看到 rpmforge.list，其中包含如下行：

```
repomd http://apt.sw.be redhat/el$(VERSION)/en/$(ARCH)/dag 
```

我刚刚在干净的 CentOS 5 安装上进行了测试，并`yum check-update`显示

```
subversion.i386                          1.5.2-0.1.el5.rf       rpmforge
subversion-perl.i386                     1.5.2-0.1.el5.rf       rpmforge 
```

因此，请检查您的来源列表并再次运行检查更新。

编辑：哎呀，我的答案丢失了一部分。将其添加回上面。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T21:20:47.180

> 目前我并不太担心其他过时的软件包，但正如您所见，没有可用的 Subversion 更新。

也没有任何来自`rpmforge`. 这是您的优先级设置。尝试禁用 yum-priorities （更改`enabled=1`为`enabled=0`in `/etc/yum/pluginconf.d/priorities.conf`） - 然后它应该可以工作。

所以我想下一个问题是为什么优先级搞砸了……不过我不确定。

编辑：有关优先级的更多信息，请参阅[8jean 的答案](https://stackoverflow.com/questions/96597/how-do-i-upgrade-to-subversion-15-on-centos-5#97106)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T20:41:05.763

它在 Dag 的存储库中最高为 v 1.4.6。

你可以试试[Fedora 的 repo](https://admin.fedoraproject.org/pkgdb/packages/name/subversion)中的那个，或者对主存储库有一点耐心来升级它。

从源代码制作很容易，下载源代码包时请阅读 INSTALL 文件，记住 CentOS 可能已经移动了文件的安装位置。（使用“rpm -ql subversion”查看旧文件的安装位置）。

当 v1.5.0 发布到存储库时，您可以像以前一样删除构建的版本并使用 yum 安装。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T20:46:33.440

RPMForge 已经在 /etc/yum.repos.d/ 作为 rpmforge.repo，内容是：

```
# 名称：用于 Red Hat Enterprise 5 的 RPMforge RPM 存储库 - dag
# 网址：http://rpmforge.net/
[rpm锻造]
名称 = Red Hat Enterprise $releasever - RPMforge.net - dag
#baseurl = http://apt.sw.be/redhat/el5/en/$basearch/dag
mirrorlist = http://apt.sw.be/redhat/el5/en/mirrors-rpmforge
#mirrorlist = file:///etc/yum.repos.d/mirrors-rpmforge
启用 = 1
保护 = 0
gpgkey = file:///etc/pki/rpm-gpg/RPM-GPG-KEY-rpmforge-dag
gpg检查 = 1
优先级=20

```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T20:58:32.617

我在 /etc/apt/sources.list.d/rpmforge.list 中有确切的行。

当我运行检查更新时，我得到：

```
加载“优先级”插件
加载“fastestmirror”插件
从缓存的主机文件加载镜像速度
 * epel：mirror.unl.edu
 * rpmforge：fr2.rpmfind.net
 * 基地：mirrors.portafixe.com
 * 更新：mirrors.portafixe.com
 * 插件：mirrors.portafixe.com
 * 额外内容：mirrors.portafixe.com
由于存储库优先级保护，排除了 2202 个软件包

bzip2.i386 1.0.3-4.el5_2 更新         
bzip2-devel.i386 1.0.3-4.el5_2 更新         
bzip2-libs.i386 1.0.3-4.el5_2 更新         
libxml2.i386 2.6.26-2.1.2.6 更新         
libxml2-devel.i386 2.6.26-2.1.2.6 更新         
libxml2-python.i386 2.6.26-2.1.2.6 更新         
perl.i386 4:5.8.8-15.el5_2.1 更新         
sos.noarch 1.7-9.2.el5_2.2 更新         
tzdata.noarch 2008e-1.el5 更新  

```

目前我并不太担心其他过时的软件包，但正如您所见，没有可用的 Subversion 更新。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-07-29T22:19:58.783

您需要做的就是获取此脚本。在 CentOS 5.3 上完美地为我工作

[http://wandisco.com/subversion/os/downloads](http://wandisco.com/subversion/os/downloads)

不，我不在那里工作，也没有任何从属关系……只是找到了它，并想我会让你们知道。

祝你好运。

# git - Git - 与其他人在分支上工作时是拉还是变基

> ID：96615
> 
> 赞同：33
> 
> 时间：2008-09-18T20:33:27.730
> 
> 标签：git, version-control

因此，如果我使用的是远程（跟踪）分支的分支，并且我想获得最新的，我仍然不清楚我是否应该做`git pull`或`git rebase`. 我以为我在与其他用户一起在分支上工作时读过这`git rebase`句话，当他们拉动或变基时，它可能会把他们搞砸。真的吗？我们都应该使用`git pull`吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-09-18T21:01:49.097

git pull 是 2 个命令的组合

*   git fetch (同步你的本地仓库和远程最新的东西)
*   git merge（将远程分支的更改（如果有）合并到您的本地跟踪分支中）

git rebase 只是粗略地等同于 git merge。它不会远程获取任何东西。事实上，它也没有进行适当的合并，它会在第二个分支的新提交之后重播您所在分支的提交。

它的目的主要是让你有一个更干净的历史。在 gitk 的过去历史变得非常像意大利面条之前，不需要很多人进行多次合并。

最好的图形解释可以在这里的前 2 个图形中[看到](http://www.kernel.org/pub/software/scm/git/docs/v1.5.4.3/git-rebase.html)。但是让我在这里用一个例子来解释一下。

我有 2 个分支：master 和 mybranch。当站在 mybranch 上时，我可以跑

```
git rebase master 
```

在我最近提交到 mybranch 之前，我会在 master 中插入任何新内容。这是完美的，因为如果我现在在 master 中合并或 rebase mybranch 中的内容，我的新提交将在最近的提交之后线性添加。

如果我在“错误”的方向上变基，你提到的问题就会发生。如果我刚刚获得了最新的 master（有新的更改）并且从 master 我像这样重新设置基准（在同步我的分支之前）：

```
git rebase mybranch 
```

现在我所做的是我在主人过去的某个地方插入了我的新更改。提交的主线已更改。由于 git 使用提交 id 的方式，所有刚刚通过我的新更改重放的提交（来自 master）都有新的 id。

好吧，用语言来解释有点困难......希望这有点道理:-)

无论如何，我自己的工作流程是这样的：

*   'git pull' 来自远程的新更改
*   切换到我的分支
*   'git rebase master' 在我的提交历史中带来 master 的新变化
*   切换回主人
*   'git merge mybranch'，仅当 master 中的所有内容也在 mybranch 中时才会快进（从而避免公共分支上的提交重新排序问题）
*   '混帐推'

最后一句话。我强烈建议在差异很小的情况下使用 rebase（例如，人们处理不同的文件或至少在不同的行上工作）。它有我试图在上面解释的问题，但它使历史更加清晰。

一旦可能存在重大冲突（例如，同事重命名了一堆文件中的某些内容），我强烈建议合并。在这种情况下，系统会要求您解决冲突，然后提交解决方案。从好的方面来说，当存在冲突时，合并更容易解决。不利的一面是，如果很多人一直在合并，您的历史可能会变得难以追随:-)

祝你好运！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-18T23:43:39.833

Git`rebase`是对历史的改写。您永远不应该在“公共”分支（即您与他人共享的分支）上执行此操作。如果有人克隆了你的分支，然后你重新设置了那个分支——那么他们就不能再从你的分支中拉取/合并更改——他们将不得不扔掉旧的分支并重新拉取。

这篇[用 git 打包软件的](http://www.golden-gryphon.com/software/misc/packaging.html)文章非常值得一读。它更多的是关于管理软件发行版，但它非常技术性并且讨论了如何使用/管理/共享分支。他们谈论什么时候变基，什么时候拉动，以及每种方法的各种后果是什么。

简而言之，它们都有自己的位置，但您需要真正了解差异。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-18T20:38:08.110

`git pull`如果您的提交不在远程分支中，则进行合并。`git rebase`重写您必须与远程分支的尖端相关的任何现有提交。它们的相似之处在于它们都可能导致冲突，但我认为`git rebase`如果可以的话，使用可以让协作更顺畅。在 rebase 操作期间，您可以优化您的提交，使它们看起来像是新应用到远程分支的最新版本。合并可能更适合具有更多历史的分支上更长的开发周期。

像 git 中的大多数其他东西一样，有很多重叠的功能来适应不同的工作风格。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T17:29:19.637

查看关于[分支和合并](http://www.techscreencast.com/tool/versioncontrol/git-branching-and-merging/794)以及变基的优秀[Gitcast](http://www.techscreencast.com/tool/versioncontrol/git-rebasing/795)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T20:38:55.580

如果您想在不影响远程分支且不更改本地副本的情况下拉取源代码，最好使用 git pull。

我相信如果您有一个工作分支并进行了更改，请使用 git rebase 将该分支的基础更改为最新的远程 master，您将保留所有分支更改，但是该分支现在将从 master 分支位置，而不是之前分支的位置。

# asp.net - 如何只滚动表格、列表视图或数据网格的右侧？

> ID：96618
> 
> 赞同：2
> 
> 时间：2008-09-18T20:33:34.780
> 
> 标签：asp.net, .net, listview, datagrid

假设我有这样的数据结构：

```
Public Class AttendenceRecord
  Public CourseDate As Date
  Public StudentsInAttendence As Integer
End Class

Public Class Course
  Public Name As String
  Public CourseID As String
  Public Attendance As List(Of AttendenceRecord)
End Class 
```

我想要一个看起来像这样的表：

```
| 课程名称 | 课程编号 | [出席(0).CourseDate] | [出席(1).CourseDate]| ...
| CS 简介 | CS-1000 | 23 | 24 | ...
| 数据结构 | CS-2103 | 15 | 14 | ...

```

在一般情况下，我如何让课程 ID 右侧的所有内容都可以水平滚动，同时保留课程名称和课程 ID？理想情况下使用 ASP.NET 和/或 WinForms 中的表、列表视图或数据网格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T20:35:39.160

在纯.Net中，我什么都不知道。有固定标题的[CSS 解决方案。](http://www.imaputz.com/cssStuff/bigFourVersion.html)但是，根据我的经验，固定的左栏需要一些 javascript 融资。

我花了一分钟找到旧的例子。此后主机已下线。 [http://web.archive.org/web/20080215013647/http://www.litotes.demon.co.uk/example_scripts/tableScroll.html](http://web.archive.org/web/20080215013647/http://www.litotes.demon.co.uk/example_scripts/tableScroll.html)

这是我用来让它工作的机制：拿一张普通的桌子，把它分成另外 4 个桌子。使用业务约束获取要匹配的列宽和行高，然后链接 onscroll 事件以滚动其他表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T17:25:59.087

您可以从 System.Windows.Forms.DataGridView 控件获取此功能。创建列时，您可以将它们设置为[冻结](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcolumn.frozen.aspx)，然后只会将这些列滚动到冻结列的右侧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T20:50:07.597

这是一个仅使用 HTML 和 CSS 来实现我认为您正在寻找的示例：

[http://www.shrutigupta.com/index.php/2005/12/12/how-to-create-table-with-first-column-frozen/](http://www.shrutigupta.com/index.php/2005/12/12/how-to-create-table-with-first-column-frozen/)

# .net - 如何防止其他人使用我的 .Net 程序集？

> ID：96624
> 
> 赞同：10
> 
> 时间：2008-09-18T20:34:04.717
> 
> 标签：.net, security, assemblies

我有一个程序集，除指定的可执行文件外，任何应用程序**都不应使用该程序集。**请给我一些指示。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-18T20:49:42.030

您可以使用相同的密钥对程序集和可执行文件进行签名，然后在要保护的类的构造函数中进行检查：

```
public class NotForAnyoneElse {
  public NotForAnyoneElse() {
    if (typeof(NotForAnyoneElse).Assembly.GetName().GetPublicKeyToken() != Assembly.GetEntryAssembly().GetName().GetPublicKeyToken()) {
      throw new SomeException(...);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-18T20:37:03.620

在 .Net 2.0 或更高版本中，将所有内容都设置为内部版本，然后使用 Friend Assemblies

[http://msdn.microsoft.com/en-us/library/0tke9fxk.aspx](http://msdn.microsoft.com/en-us/library/0tke9fxk.aspx)

这不会停止反思。我想结合下面的一些信息。如果您绝对需要阻止任何人打电话，最好的解决方案可能是：

1.  ILMerge .exe 和 .dll
2.  混淆最终的.exe

您还可以检查调用堆栈并获取每个调用者的程序集，并确保它们都使用与程序集相同的密钥进行签名。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-18T20:39:42.787

如果不跳过一些箍，100% 完全不可能。

使用 .NET 的好处之一是能够使用反射，即加载程序集并检查它、动态调用方法等。这使得 VB.NET 和 F# 之间的互操作成为可能。

但是，由于您的代码位于托管程序集中，这意味着**任何人都可以添加对您的代码的引用并调用其公共方法或使用反射加载它并调用私有方法**。即使你“混淆”了你的代码，人们仍然可以使用反射和调用你的代码。但是，由于所有名称都将被屏蔽，因此做任何事情都非常困难。

如果您必须以一种阻止其他人执行它的方式发布您的 .NET 代码，您也许可以对您的二进制文件进行 NGEN（将其编译为 x86）并发布这些二进制文件。

我不知道你的具体情况，但混淆应该足够好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T20:56:07.253

您还可以查看使用[Netz](http://madebits.com/netz/)可执行打包程序和压缩程序。

这会将您的程序集和您的 .exe 文件打包到一个可执行文件中，因此如果不进行一些挖掘，它们对外界是不可见的。

我的猜测是，这足以阻止大多数 .net 程序员的访问。

.netz 方法的一大好处是它不需要您更改代码。另一个好处是它确实简化了您的安装过程。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T20:36:24.820

您应该能够将所有内容设置为内部范围，然后使用[InternalsVisibleTo](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)属性仅授予该一个程序集对内部方法的访问权限。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T20:40:43.517

[@Charles Graham](https://stackoverflow.com/questions/96624/how-to-prevent-others-from-using-my-net-assembly#96647)提到的代码访问安全属性是[StrongNameIdentityPermissionAttribute](http://msdn.microsoft.com/en-us/library/system.security.permissions.strongnameidentitypermissionattribute.aspx)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T20:46:45.217

正如一些人提到的，使用 InternalsVisibleTo 属性并将所有内容标记为内部。这当然不会防止反射。

尚未提及的一件事是将您的程序集合并到您的主 .exe/.dll/ [whatever](http://www.microsoft.com/downloads/details.aspx?familyid=22914587-b4ad-4eae-87cf-b14ae6a939b0&displaylang=en)中，这将稍微提高进入的障碍（人们将无法看到您的程序集独自坐在要求被引用），但不会停止反射路线..

更新：另外，IIRC，ilmerge 有一个功能，它可以自动内部化合并的程序集，这意味着您根本不需要使用 InternalsVisibleTo

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-18T21:35:54.257

我不确定这是否适合您，但也许您可以使用 WCF 或 ASP.NET Web 服务托管程序集并使用某种身份验证方案（LDAP、公钥/私有密钥对等）来确保只允许客户端连接。这将使您的程序集物理上不受其他任何人的控制，并且您可以控制谁连接到它。只是一个想法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T20:36:03.543

您可能可以在程序集的代码访问安全策略中进行设置。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T20:38:48.997

您可以使用混淆。

这将变成：

```
int MySecretPrimeDetectionAlgorithm(int lastPrimeNumber); 
```

变成不可读的东西，例如：

```
int Asdfasdfasdfasdfasdfasdfasdf(int qwerqwerqwerqwerqwerqwer); 
```

其他人仍然可以使用您的程序集，但很难做出明智的选择。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T21:22:23.183

听起来您正在寻找保护或混淆工具。虽然没有灵丹妙药，但我推荐的保护工具是[smartassembly](http://www.smartassembly.com/)。一些替代品是[Salamander Obfuscator](http://www.remotesoft.com/salamander/obfuscator.html)、[dotfuscator](http://www.preemptive.com/dotfuscator.html)和[Xenocode](http://www.xenocode.com/)。

不幸的是，如果你把你的字节交给某人阅读......如果他们有足够的时间和精力，他们可以找到加载和调用你的代码的方法。为了抢先回答我看到您经常问的评论：Salamander 会阻止您的代码直接加载到 Reflector 工具中，但我在 smartassembly 方面有更好（即：更可靠）的体验。

希望这可以帮助。:)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T20:37:29.030

例如，如果程序集是一个 Web 服务，您可以确保指定的可执行文件在 SOAP 消息中传递一个秘密值。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2008-09-18T22:35:05.863

只需要使用函数调用发送密码，如果它没有被授权，那么什么都不起作用，比如 .setAuthorizeCode('123456') 然后在每个可以使用的地方检查是否 authorizeCode != 123456然后抛出错误或退出......这听起来不是可重用性的好答案，但这正是重点。

只有您可以使用它，并且当您将授权代码硬编码到程序中时。

只是一个想法，可能是您正在寻找的东西，或者可以激励您做出更好的事情。

# .net - Visual Studio Express 安装问题

> ID：96648
> 
> 赞同：2
> 
> 时间：2008-09-18T20:36:07.473
> 
> 标签：.net, visual-studio-2008, installation, visual-studio-express

我刚刚在我的 Vista 机器上安装了“Visual C# 2008 Express Edition”和“Visual Web Developer 2008 Express Edition”。以前我一直在 Win XP 中运行这些。启动软件、启动一个新项目并尝试构建它时，我收到诸如“找不到引用的组件‘系统’之类的警告。”；每个使用的命名空间占一行。我安装了 .NET Framework 3.5 并且能够浏览“添加引用”中的选项卡，但我无法使其正常工作。（重新安装没有帮助。）有简单的解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-21T20:22:28.097

问题解决了。我使用了我能想到的最激进的解决方案——干净的 Vista 安装。不知何故重新安装 Visual Studio 并不包括所有必要的步骤。第一次启动软件时，它会自行配置。第一次肯定出了问题，当再次执行该过程时，它试图使用“破坏”配置。好吧，现在它已经修复了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T20:38:30.260

您是否通过“以管理员身份运行”启动？您的 .Net 框架目录上的权限可能不是应有的权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T20:54:36.463

您是否有针对该软件的补丁或更新？另一个想法是将 System.dll 复制到项目的 bin 文件夹中，这是我在以前的项目中用来使事情正常进行的操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-17T14:55:37.247

我真的不想遵循公认的答案并进行全新安装。我从 MSDN 论坛得到的更好的解决方案：

转到控制面板 > 程序和功能 > 打开或关闭 Windows 功能...

然后启用**Microsoft .Net Framework 3.0下的所有内容**

# windows-installer - Displaying the correct size in Windows' Add/Remove Programs

> ID：96653
> 
> 赞同：3
> 
> 时间：2008-09-18T20:36:58.830
> 
> 标签：windows-installer

I have a need to manually setup the registry settings for an entry in Window's Add/Remove Programs (for XP and Vista). Everything works except for the displayed size.

According to [this 2004 post](http://blogs.msdn.com/oldnewthing/archive/2004/07/09/178342.aspx) by Raymond Chen it should be possible by setting the `EstimatedSize` registry value but it doesn't work. [This more recent MSDN page](http://msdn.microsoft.com/en-us/library/aa372105(VS.85).aspx) says the `EstimatedSize` value is "*Determined and set by the Windows Installer.*" Does anyhow know how I can manually set the size value outside the Windows Installer?

(Suggestions to use a single large MSI are appreciated but we have done that in the past and its proven difficult and inflexible. Our current approach is a custom application to manage hundreds of smaller MSI packages, but this means the application itself has to write out the registry settings for Add/Remove Programs.)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-18T21:02:18.630

您可以尝试将子项目构建到 msm（合并模块）中，然后将批次链接到单个 msi - 您可以获得拥有单个模块和单个 msi 的好处。

# sql - How can I make MS Access Query Parameters Optional?

> ID：96661
> 
> 赞同：3
> 
> 时间：2008-09-18T20:37:49.390
> 
> 标签：sql, ms-access

I have a query that I would like to filter in different ways at different times. The way I have done this right now by placing parameters in the criteria field of the relevant query fields, however there are many cases in which I do not want to filter on a given field but only on the other fields. Is there any way in which a wildcard of some sort can be passed to the criteria parameter so that I can bypass the filtering for that particular call of the query?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T21:06:39.133

如果您像这样构建查询：

```
PARAMETERS ParamA Text ( 255 );
SELECT t.id, t.topic_id
FROM SomeTable t
WHERE t.id Like IIf(IsNull([ParamA]),"*",[ParamA]) 
```

如果不填写参数，将选择所有记录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-29T13:18:05.997

请注意，`*`带有关键字的通配符`LIKE`只会在 ANSI-89 查询模式中产生所需的效果。

许多人错误地认为 Access/Jet 中的通配符始终是 *。不是这样。Jet 有两个通配符：ANSI-92 查询模式中的 % 和 ANSI-89 查询模式中的 *。

ADO 始终是 ANSI-92，DAO 始终是 ANSI-89，但 Access 接口可以是任何一个。

在数据库对象中使用 LIKE 关键字时（即，将保存在 mdb 文件中的东西），您应该想一想：如果有人使用我自己通常使用的查询模式以外的查询模式使用此数据库会发生什么？假设您只想将文本字段限制为数字字符，并且您编写了这样的验证规则：

```
NOT LIKE "*[!0-9]*" 
```

如果有人无意中（或以其他方式）通过 ADO 连接到您的 .mdb，那么上面的验证规则将允许他们添加非数字字符的数据，并且您的数据完整性将受到影响。不好。

更好的 IMO 始终为两种 ANSI 查询模式编码。也许这最好通过显式编码两种模式来实现，例如

```
NOT LIKE "*[!0-9]*" AND NOT LIKE "%[!0-9]%" 
```

但是随着更多涉及 Jet SQL DML/DDL，这可能变得很难简洁地实现。这就是为什么我建议使用 ALIKE 关键字，它使用 ANSI-92 查询模式通配符，而不管查询模式如何，例如

```
NOT ALIKE "%[!0-9]%" 
```

注意 ALIKE 是无证的（我认为这就是我原来的帖子被标记的原因）。我已经在 J​​et 3.51 (Access97)、Jet 4.0 (Access2000 to 2003) 和 ACE (Access2007) 中对此进行了测试，并且工作正常。我之前已在新闻组中发布过此内容，并获得了 Access MVP 的批准。通常我自己会避开未记录的功能，但在这种情况下例外，因为 Jet 已被弃用近十年，并且保持它活着的 Access 团队似乎对对引擎进行深度更改（或错误修复！ )，这具有使喷气发动机成为非常稳定的产品的效果。

有关 Jet 的 ANSI 查询模式的更多详细信息，请参阅[关于 ANSI SQL 查询模式](http://web.archive.org/web/20140614093902/http://office.microsoft.com/en-gb/access-help/about-ansi-sql-query-mode-mdb-HP003070483.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T06:39:52.047

回到你之前的问题中我之前的例子。您的参数化查询是一个看起来像这样的字符串：

```
qr = "Select Tbl_Country.* From Tbl_Country WHERE id_Country = [fid_country]" 
```

根据 fid_Country 的性质（数字、文本、guid、日期等），您必须将其替换为百搭值和特定分隔符：

```
qr = replace(qr,"[fid_country]","""*""") 
```

为了完全允许通配符，您的原始查询也可以是：

```
qr = "Select Tbl_Country.* From Tbl_Country _
      WHERE id_Country LIKE [fid_country]" 
```

然后，您可以获得 fid_Country 的通配符值，例如

```
qr = replace(qr,"[fid_country]","G*") 
```

完成后，您可以使用字符串打开记录集

```
set rs = currentDb.openRecordset(qr) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T20:47:32.097

我不认为你可以。你是如何运行查询的？

我会说，如果您需要一个具有这么多开放变量的查询，请将其放入 vba 模块或类中，然后调用它，让它每次都构建字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T20:56:41.560

我不确定这是否有帮助，因为我怀疑您想使用保存的查询而不是 VBA 来执行此操作；但是，您可以做的最简单的事情是在 VBA 中逐行构建查询，然后从中创建记录集。

一种非常老套的方法是动态重写保存的查询，然后访问它；但是，如果您有多个人使用同一个数据库，您可能会遇到冲突，并且您会混淆下一个开发人员。

您还可以以编程方式将默认值传递给查询（如您在上一个问题中所讨论的）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T21:04:09.047

好吧，您可以通过传递 * 作为您不希望在当前过滤器中使用的字段的参数来返回非空值。在 Access 2003（以及可能的更早和更高版本）中，如果您使用`like [paramName]`数字、文本、日期或布尔字段作为标准，星号将显示所有记录（与您指定的其他标准匹配）。如果您也想返回空值，那么您可以使用`like [paramName] or Is Null`作为标准，以便它返回所有记录。（如果您在代码中构建查询，这最有效。如果您使用现有查询，并且您不想在有过滤值时返回空值，这将不起作用。）

如果您要过滤备忘录字段，则必须尝试另一种方法。

# java - What's the difference between | and || in Java?

> ID：96667
> 
> 赞同：15
> 
> 时间：2008-09-18T20:38:16.877
> 
> 标签：java

> **Possible Duplicate:**
> [Why do we usually use `||` not `|`, what is the difference?](https://stackoverflow.com/questions/7101992/why-do-we-usually-use-not-what-is-the-difference)

Title says it all. It's been discussed for other languages, but I haven't seen it for Java yet.

# javascript - How do I get flash to reload the parent HTML page it is embedded in?

> ID：96671
> 
> 赞同：5
> 
> 时间：2008-09-18T20:38:25.690
> 
> 标签：javascript, html, flash, actionscript

I have a flash app (SWF) running Flash 8 embedded in an HTML page. How do I get flash to reload the parent HTML page it is embedded in? I've tried using ExternalInterface to call a JavaScript function to reload the page but that doesn't seem to work. ­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-17T08:04:10.407

检查动作脚本中的[ExternalInterface](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/external/ExternalInterface.html)。使用它，您可以在代码中调用任何 JavaScript 函数：

```
 if (ExternalInterface.available)
  {
    var result = ExternalInterface.call("reload");
  } 
```

在嵌入 HTML 代码中输入一个 JavaScript 函数：

```
 function reload()
  {
    document.location.reload(true);
    return true;
  } 
```

这样做的好处是您还可以检查函数调用是否成功并采取相应措施。getUrl 以及对 JavaScript 的调用现在不应该再使用了。这是一个古老的黑客。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T20:41:21.830

尝试这样的事情：

`getURL("javascript:location.reload(true)");`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-12T08:48:15.917

简单的一条线解决方案。

```
ExternalInterface.call("document.location.reload", true); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-25T07:09:39.897

快速而肮脏：这在大多数情况下都有效（根本不修改 HTML 页面）：

```
import flash.external.ExternalInterface;

ExternalInterface.call("history.go", 0); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-07T19:37:59.200

在 Flash 10 中，您可以执行以下操作：

```
navigateToURL(new URLRequest("path_to_page"), "_self"); 
```

# c# - 组织扩展方法

> ID：96718
> 
> 赞同：19
> 
> 时间：2008-09-18T20:41:26.900
> 
> 标签：c#, extension-methods, code-organization

你如何组织你的扩展方法？假设我有对象类和字符串类的扩展，我很想将这些扩展方法分成 IE 类：

```
public class ObjectExtensions
{
    ...
}

public class StringExtensions
{
    ...
} 
```

我是让这太复杂还是有意义？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-18T20:48:31.470

我使用命名空间和类名的组合来组织扩展方法，这与您在问题中描述的方式相似。

通常，我的解决方案中有某种“主程序集”，它提供了大部分共享功能（如扩展方法）。为了讨论，我们将把这个程序集称为“框架”。

在框架程序集中，我尝试模仿我拥有扩展方法的事物的名称空间。例如，如果我正在扩展 System.Web.HttpApplication，我将拥有一个“Framework.Web”命名空间。“System”命名空间中的“String”和“Object”等类转换为该程序集中的根“Framework”命名空间。

最后，命名遵循您在问题中指定的行 - 以“Extensions”作为后缀的类型名称。这会产生一个像这样的类层次结构：

*   框架（命名空间）
    *   Framework.ObjectExtensions（类）
    *   Framework.StringExtensions（类）
    *   Framework.Web（命名空间）
        *   Framework.Web.HttpApplicationExtensions（类）

好处是，从维护的角度来看，以后很容易找到给定类型的扩展方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T20:46:52.830

有两种方法可以组织我使用的扩展方法，

1) 如果扩展特定于我正在处理的项目，那么我将它保存在同一个项目/程序集中，但在它自己的命名空间中。

2）如果扩展是一种类型，以便我可能或正在其他项目中使用它，那么我将它们分隔在一个通用的扩展程序集中。

要记住的最重要的事情是，我将在什么范围内使用它们？如果我牢记这一点，组织它们并不难。

# visual-studio - 对于使用 MSVS 测试版工具有效测试启用 AJAX 的网页有什么建议吗？

> ID：96719
> 
> 赞同：0
> 
> 时间：2008-09-18T20:41:31.610
> 
> 标签：visual-studio, ajax, testing

似乎 MS 确实在 Visual Studio 中为带有 AJAX 组件的网页的自动化测试工具留下了一个巨大的漏洞，我一直很难找到任何评论或第三方插件来解决这个问题。有人对在 MSVS 中为 AJAX 页面自动进行 Web 测试有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T20:43:01.093

我最终放弃了尝试，只是坚持使用 WATIR

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T20:44:29.060

我不知道这是否会有所帮助，但你可以试试这个：

[https://github.com/pivotal/jsunit](https://github.com/pivotal/jsunit)

编辑：对不起，我重读了您的 Q 并意识到您的意思是特定于 VS。我不知道你是否熟悉 Script#，但不久前我读过一些谈话，有人正在构建一个测试框架来使用它，而 Script# 可以与 MSAjax 一起使用。可能值得进行一些调查。

[http://scriptsharp.com/](http://scriptsharp.com/)

# c# - 将一个 dll 作为嵌入式资源嵌入到另一个 dll 中，然后从我的代码中调用它

> ID：96732
> 
> 赞同：57
> 
> 时间：2008-09-18T20:42:59.610
> 
> 标签：c#, .net-3.5, dll

我有一种情况，我正在创建一个使用另一个第三方 DLL 的 DLL，但我希望能够将第三方 DLL 构建到我的 DLL 中，而不是尽可能将它们保存在一起。

这是 C# 和 .NET 3.5。

我想这样做的方法是将第三方 DLL 存储为嵌入式资源，然后在执行第一个 DLL 期间将其放置在适当的位置。

我最初计划这样做的方法是编写代码将第三方 DLL 放在`System.Reflection.Assembly.GetExecutingAssembly().Location.ToString()` 减去 last指定的位置`/nameOfMyAssembly.dll`。我可以在此位置成功保存第三方`.DLL`（最终成为

> C:\Documents and Settings\myUserName\Local Settings\Application Data\assembly\dl3\KXPPAX6Y.ZCY\A1MZ1499.1TR\e0115d44\91bb86eb_fe18c901

)，但是当我到达需要此 DLL 的代码部分时，它找不到它。

有人知道我需要做些什么不同的事情吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-09-18T21:40:49.083

将第三方程序集作为资源嵌入后，添加代码以[`AppDomain.AssemblyResolve`](http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve.aspx)在应用程序启动期间订阅当前域的事件。只要 CLR 的 Fusion 子系统未能根据有效的探测（策略）定位程序集，就会触发此事件。在 的事件处理程序中`AppDomain.AssemblyResolve`，使用加载资源[`Assembly.GetManifestResourceStream`](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getmanifestresourcestream.aspx)并将其内容作为字节数组提供给相应的[`Assembly.Load`](http://msdn.microsoft.com/en-us/library/h538bck7.aspx)重载。下面是一个这样的实现在 C# 中的样子：

```
AppDomain.CurrentDomain.AssemblyResolve += (sender, args) =>
{
    var resName = args.Name + ".dll";    
    var thisAssembly = Assembly.GetExecutingAssembly();    
    using (var input = thisAssembly.GetManifestResourceStream(resName))
    {
        return input != null 
             ? Assembly.Load(StreamToBytes(input))
             : null;
    }
}; 
```

其中`StreamToBytes`可以定义为：

```
static byte[] StreamToBytes(Stream input) 
{
    var capacity = input.CanSeek ? (int) input.Length : 0;
    using (var output = new MemoryStream(capacity))
    {
        int readLength;
        var buffer = new byte[4096];

        do
        {
            readLength = input.Read(buffer, 0, buffer.Length);
            output.Write(buffer, 0, readLength);
        }
        while (readLength != 0);

        return output.ToArray();
    }
} 
```

最后，正如一些人已经提到的那样，[ILMerge](http://research.microsoft.com/~mbarnett/ILMerge.aspx)可能是另一个值得考虑的选择，尽管涉及更多。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-19T17:11:37.823

最后，我几乎完全按照 raboof 建议的方式进行了操作（并且类似于 dgvid 的建议），除了一些小的改动和一些遗漏修复。我选择这种方法是因为它最接近我最初寻找的方法，并且不需要使用任何第三方可执行文件等。效果很好！

这就是我的代码最终的样子：

编辑：我决定将此函数移动到另一个程序集，以便我可以在多个文件中重用它（我只是传入 Assembly.GetExecutingAssembly()）。

这是允许您通过嵌入式 dll 传递程序集的更新版本。

EmbeddedResourcePrefix 是嵌入资源的字符串路径，它通常是程序集的名称，后跟包含资源的任何文件夹结构（例如，如果 dll 位于项目中名为 Resources 的文件夹中，则为“MyComapny.MyProduct.MyAssembly.Resources” ）。它还假定 dll 具有 .dll.resource 扩展名。

```
 public static void EnableDynamicLoadingForDlls(Assembly assemblyToLoadFrom, string embeddedResourcePrefix) {
        AppDomain.CurrentDomain.AssemblyResolve += (sender, args) => { // had to add =>
            try {
                string resName = embeddedResourcePrefix + "." + args.Name.Split(',')[0] + ".dll.resource";
                using (Stream input = assemblyToLoadFrom.GetManifestResourceStream(resName)) {
                    return input != null
                         ? Assembly.Load(StreamToBytes(input))
                         : null;
                }
            } catch (Exception ex) {
                _log.Error("Error dynamically loading dll: " + args.Name, ex);
                return null;
            }
        }; // Had to add colon
    }

    private static byte[] StreamToBytes(Stream input) {
        int capacity = input.CanSeek ? (int)input.Length : 0;
        using (MemoryStream output = new MemoryStream(capacity)) {
            int readLength;
            byte[] buffer = new byte[4096];

            do {
                readLength = input.Read(buffer, 0, buffer.Length); // had to change to buffer.Length
                output.Write(buffer, 0, readLength);
            }
            while (readLength != 0);

            return output.ToArray();
        }
    } 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-18T20:48:43.637

有一个名为 IlMerge 的工具可以完成此操作：[http ://research.microsoft.com/~mbarnett/ILMerge.aspx](http://research.microsoft.com/~mbarnett/ILMerge.aspx)

然后，您可以进行类似于以下的构建事件。

设置路径="C:\Program Files\Microsoft\ILMerge"

ilmerge /out:$(ProjectDir)\Deploy\LevelEditor.exe $(ProjectDir)\bin\Release\release.exe $(ProjectDir)\bin\Release\InteractLib.dll $(ProjectDir)\bin\Release\SpriteLib.dll $(ProjectDir)\bin\Release\LevelLibrary.dll

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-18T21:17:50.620

我已经成功完成了您所描述的操作，但是因为第三方 DLL 也是一个 .NET 程序集，所以我从不将它写到磁盘上，我只是从内存中加载它。

我将嵌入式资源程序集作为字节数组获取，如下所示：

```
 Assembly resAssembly = Assembly.LoadFile(assemblyPathName);

        byte[] assemblyData;
        using (Stream stream = resAssembly.GetManifestResourceStream(resourceName))
        {
            assemblyData = ReadBytesFromStream(stream);
            stream.Close();
        } 
```

然后我用 Assembly.Load() 加载数据。

最后，我向 AppDomain.CurrentDomain.AssemblyResolve 添加了一个处理程序，以便在类型加载器查看时返回我加载的程序集。

有关更多详细信息，请参阅[.NET Fusion Workshop](http://www.grimes.demon.co.uk/workshops/fusWSEight.htm)。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-18T21:02:40.907

[您可以使用Netz](http://madebits.com/netz/)，一个 .net NET Executables Compressor & Packer轻松实现这一目标。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T20:56:58.173

您可以尝试使用 Assembly.Load(byte[] rawAssembly) 从嵌入式资源创建 rawAssembly，而不是将程序集写入磁盘。

# javascript - iframe 是一个糟糕的主意吗？

> ID：96748
> 
> 赞同：30
> 
> 时间：2008-09-18T20:44:40.293
> 
> 标签：javascript, iframe, widget

我正在构建一个小部件，并且一直在使用 iframe 在其中呈现内容。在某个时候，我可能会开始提供第三方 HTML 和 JS，所以我认为 iframe 会是一个好主意。

它确实使小部件 javascript 更复杂一些，我担心这可能不是最好的实现。

你有什么建议吗？听听其他人对 iframe 的看法会很有帮助。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-18T20:47:17.557

不，iframe 没有任何问题。如果您要开始提供第三方内容，iframe 可能是一个更好的主意。

即将发布的 HTML5 规范还计划在 iframe 中为此类情况构建更多安全功能，因此我认为现在也使用它们是一种好习惯。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-19T00:40:05.080

在 XMLHTTPRequest 被广泛使用之前，人们使用 JavaScript 和 iframe 的组合以动态方式提供内容，而无需刷新整个页面。

有很多关于以这种方式开发网站的信息，因此您应该有一个相对容易的时间来找到解决您可能遇到的许多障碍的解决方法。

我发现让我感到痛苦的一件事是在 iframe 中跨域使用 JavaScript。如果您在 iframe 中嵌入的页面来自与“父”页面不同的域，则浏览器具有不允许您从另一个访问其中一个的安全限制。诀窍是两个页面都声明

```
document.domain = 'somedomain.com'; 
```

网上有很多关于这种解决方法的资料。

祝你好运！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-18T20:48:27.523

我最近发现的一件事是，嵌入在 iframe 中的 .aspx 页面有时会出现丢失 cookie 的问题，这会导致我参与的应用程序中的会话状态丢失。

对我来说，这是在一个不同的开发商店在他们自己的页面中使用我的一个 .aspx 页面的场景中。这意味着我们在不同的服务器上，这些服务器可能很突出，也可能不突出。

显然，这是由父页面拒绝子页面的 cookie 引起的……会话 cookie 也是如此，会话也是如此。

这个工作原理的具体机制有点涉及：[更多细节](http://aspnetresources.com/blog/frames_webforms_and_rejected_cookies.aspx)

这个问题并没有影响到 FireFox，但它确实出现在 IE7 中，并且在几个小时内一直是个谜。

另外，我必须在一点上与上面链接的文章相矛盾。文章说，如果包含页面也是 .aspx，则您不会得到这个......在这种情况下，这不是真的，因为两个页面都是 .aspxs。

这对文章中关于这种情况的所有其他内容提出了一些疑问，但它确实导致了解决方案，所以这也是。

正如文章建议的那样，我输入了以下代码，该代码在页面的 Init 事件中注入了一个 p3p（隐私偏好项目 - 我从未听说过）标题：

```
HttpContext.Current.Response.AddHeader("p3p", "CP=\""IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT\""") 
```

...这就解决了问题。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-19T14:41:20.243

我将不同意大多数人的观点，并说是的，iframe 是一个**绝对糟糕**的主意。任何在网页设计社区工作过一段时间的人都会同意 iframe 是纯粹的邪恶，除非**绝对**必要，否则应该避免使用。

我认为它们不好的原因是因为它们破坏了网页的导航模式。通过使用 iframe，您可以有效地破坏浏览器上的后退和前进按钮并迷惑用户。它打破了 HTTP 协议背后的整个想法；一个 URL 将始终指向一个唯一的位置。如果 iframe 是一匹马，它早就退役了。还有其他方法可以动态提供内容，应该使用这些方法。

如果您正在创建一个*小部件*，那么使用 iframe 的直接担忧就会消失（对搜索引擎不利，对书签不利等），但无论哪种方式，内容都会更好地动态提供，甚至在新窗口中而不是在 iframe 中提供。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-19T02:35:35.363

我知道他们只有一件“非常糟糕”的事情。

如果您的第 3 方执行了一些 JavaScript，那么尝试修改他们的 DOM 有点太早了...... IE6 和 IE7 会抛出如此无用的“**[操作中止](http://blogs.msdn.com/ie/archive/2008/04/23/what-happened-to-operation-aborted.aspx)**”错误，然后**不仅会清空 iframe，还会清空整个周围的页面**。（例如，您的网站出现故障）

它在 IE8 中没有修复，但崩溃处理得更好。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-19T03:46:18.050

根据我的经验，iframe 要么是黑客，要么是节省时间的工具——确保如果你使用它们，出于这些原因，它们是必要的。如果您可以控制内容（或者可以通过镜像或抓取来获得控制），您应该考虑使用 AJAX 或服务器端包含将外部数据拉到页面上并将其推送到页面上 - 它最终会更加灵活，更多健壮，最终更易于管理。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-19T00:52:35.643

*就个人而言，如果你*可以避免太多麻烦，我会避免它。使用 Javascript（或 AJAX，如果您需要动态加载它们），您可以很容易地使用 div 并根据需要更改内容 - 在某些情况下，这将为您提供更大的灵活性并简化您的 JS，特别是如果有很多您的小部件与页面其余部分之间的交互。

也就是说，我会调查这两个选项，如果 JS 路径看起来太棘手或复杂，只需使用 iframe。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-18T20:47:19.787

取决于小部件的作用。iframe 有它们的位置，但它们确实很少引起布局问题（更不用说让你的 js 更复杂了），所以大多数人倾向于避免它们，除非绝对必要。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-18T20:49:05.633

iframe 与框架一样，只是用于手头任务的控件。因此，它本身既不好也不坏，但根据手头的任务和客户的要求可能是好是坏。据我所知，所有现代浏览器（和非 Linux 用户）都可以毫无问题地“查看和使用”iframe。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-06T08:03:13.460

iframe 并不邪恶，它们只是与其他任何工具一样的另一种工具，要确定它们的优点，您必须确定它们将被使用的上下文。Google 图片搜索和其他一些知名网站将 iframe 用于有限目的。

一般来说，我发现它们用于品牌推广或使用户能够返回将用户重定向到站点外的站点。

请注意，如果您使用跨域 iframe，例如指向页面所在域之外的域的 iframe，出于安全原因，您会受到设计的限制，并且无法通过 javascript 访问与其关联的域之外的 DOM 的内部结构。

另请注意，许多网站会阻止他们的网站被嵌入，并将 iframe 条带化（将顶部 url 重定向到他们的域）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T22:04:56.153

一个不错的选择是使用溢出 CSS 属性。默认值是可见的，但您可以将其设置为隐藏、滚动或自动。我会在你的情况下使用 auto 。如果你的内容变得太大，它看起来就像你有一个 iframe，但它仍然在页面上。

参见：[溢出属性](http://www.w3schools.com/Css/pr_pos_overflow.asp)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T14:12:50.233

从技术上讲，iFrame 与替代品相比没有什么错。但从语义上讲，有恶。

Web 基于 HTTP，该协议表示给定的 URL 将始终指向唯一的资源。

使用 iFrame，您只需为所有资源提供一个 URL 后面的网页中融合的多个资源。如果您担心 Web 应该如何发展，那就麻烦了。更重要的是，对于搜索引擎机器人来说，这很棘手。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-01-07T22:03:19.800

iframe 有一个重要的问题，几乎没有人提到，但它让我感到厌烦。

我们的同事将毕生精力投入到一个动态变化的数据库中，我们已将其加载到 Google Docs 电子表格中，然后我们将其与大量支持材料一起显示在我们的网站上。

绝对没有什么可以阻止有人从我的页面源中抓取 iframe 代码并将其推到他们的页面上。现在，他们正在获取我们所有的数据，这些数据在几分钟前刚刚刷新，完全免费提供给他们的页面。

如果一个谷歌 iframe 可以绑定到一个特定的域，那将会停止它的轨道。

任何想法，明亮的火花？

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T22:07:59.907

不一定，只要 iframe 中的内容是可预测的。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-03-21T10:08:53.907

[iframe](https://stackoverflow.com/questions/2258379/what-are-usability-accessibility-screen-reader-or-any-other-development-functi)存在几个可用性和可访问性问题。某些浏览器和屏幕阅读器无法显示 iframe，因此您应该提供替代内容：

```
<iframe src="content.html">
    <p>
        This content will only be displayed by browsers that do not support
        iframes. You should provide a link to the content, or in your 
        case an alternative way to use your widget.
    </p>
</iframe> 
```

如果您开始提供第三方内容，则应注意 iframe 在完成加载后抓取焦点。虽然对于普通用户来说是一个小烦恼，但对于使用屏幕阅读器浏览的用户来说可能会非常混乱。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-03-21T08:18:16.013

回复：“HTTP 协议背后的整个想法；一个 URL 将始终指向一个唯一的位置”

我从同一个 URL 为我的整个 CMS 提供安全性和可扩展性（主要使用 POST 而不是 GET 参数）。我不希望在没有身份验证的情况下看到安全内容，并且调度系统使我的开发更容易，因为我不必担心每个新页面的身份验证。

此外，对于某些应用程序，SEO 不适用（例如基于 Web 的 ERP）。

我使用 iFrame 从 PHP 生成的程序集树中提供内容。每当用户想要查看零件/装配的详细信息时，我不希望刷新树（和节点可见性）。

# .net - 如何从我的 Windows Mobile 5 设备中删除 .NET Compact Framework？

> ID：96750
> 
> 赞同：3
> 
> 时间：2008-09-18T20:44:49.293
> 
> 标签：.net, compact-framework, windows-mobile-5.0

我正在尝试让一些第三方应用程序在我的 Windows Mobile 5 智能手机上运行。

我已经安装了 Microsoft.NET Compact Framework 的最新版本 (3.5)，但每当我运行应用程序时，我都会收到一条错误消息，其中指出：“此应用程序 [应用程序名称] 需要更新版本的 Microsoft .NET Compact Framework比此设备上安装的版本。”

假设我已经成功安装了最新版本，这没有任何意义，让我相信我需要删除 .NET Compact Framework 并重新开始。（我试过重新安装它，但据我所知，没有自动方法可以在设备上或从我的 PC 上删除它。）

有人对我需要做什么有任何建议吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T22:14:27.533

最好*不要*卸载，如果它在ROM中的设备上，你无论如何都无法卸载它。

有几个选项可供您使用。

1.  不同的 CF 版本可以很好地共存，因此您可以安装旧版本并保留 3.5。
2.  CF 可以设置为兼容模式。这意味着您可以告诉仅针对旧版本编译的单个应用程序在兼容模式下使用 3.5 运行时，或者您可以设置该设备范围，以便*所有*旧 CF 应用程序将在兼容模式下再次运行 3.5 EE。

有关讨论配置文件和兼容模式的在线资源，请参阅以下链接：

*   [有关配置文件设置的 MSDN 文章](http://msdn.microsoft.com/en-us/library/bb629366.aspx)
*   [有关配置运行时版本的 MSDN 文章](http://msdn.microsoft.com/en-us/library/d5cd9b2c.aspx)
*   [David Kline 关于兼容模式的博客](http://blogs.msdn.com/davidklinems/archive/2005/04/19/409541.aspx)
*   [CF 3.5 Power Toys](http://www.microsoft.com/downloads/details.aspx?familyid=C8174C14-A27D-4148-BF01-86C2E0953EAB&displaylang=en)（包括用于设置配置的应用程序）

注意：我忘记在原始回复中提到使用选项 #2（针对 CF 3.5 运行）也很可能会提高应用程序的性能，因为它将使用最新的 CLR 运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T20:59:27.403

您是否尝试过使用 Microsoft ActiveSync 卸载它？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T18:29:21.973

如果你自己安装了它，你应该可以通过转到设置 -> 系统 -> 删除程序来删除它（在智能手机操作系统上可能是一个稍微不同的路径，我习惯于掌上电脑）。

# php - 如何在 PHP 中对多维数组进行排序

> ID：96759
> 
> 赞同：202
> 
> 时间：2008-09-18T20:45:56.123
> 
> 标签：php, sorting, multidimensional-array

我已将 CSV 数据加载到多维数组中。这样，每个“行”都是一条记录，每个“列”包含相同类型的数据。我正在使用下面的函数来加载我的 CSV 文件。

```
function f_parse_csv($file, $longest, $delimiter)
{
  $mdarray = array();
  $file    = fopen($file, "r");
  while ($line = fgetcsv($file, $longest, $delimiter))
  {
    array_push($mdarray, $line);
  }
  fclose($file);
  return $mdarray;
} 
```

我需要能够指定要排序的列，以便重新排列行。其中一列包含格式为的日期信息，`Y-m-d H:i:s`我希望能够以最近的日期作为第一行进行排序。

* * *

## 回答 #1

> 赞同：345
> 
> 时间：2013-05-28T09:33:41.597

## 介绍：PHP 5.3+ 的一个非常通用的解决方案

我想在这里添加我自己的解决方案，因为它提供了其他答案没有的功能。

具体来说，该解决方案的优势包括：

1.  它是**可重用**的：您将排序列指定为变量，而不是对其进行硬编码。
2.  它很**灵活**：您可以指定多个排序列（任意数量）——附加列用作最初比较相等的项目之间的决胜局。
3.  它是**可逆**的：您可以指定应该反转排序 - 分别为每一列。
4.  它是**可扩展**的：如果数据集包含无法以“哑”方式比较的列（例如日期字符串），您还可以指定如何将这些项目转换为可以直接比较的值（例如`DateTime`实例）。
5.  **如果您愿意**，它是关联的：此代码负责对项目进行排序，但*您*选择实际的排序函数（`usort`或`uasort`）。
6.  最后，它不使用`array_multisort`: 虽然`array_multisort`很方便，但它依赖于在排序之前创建所有输入数据的投影。这会消耗时间和内存，如果您的数据集很大，这可能会令人望而却步。

### 编码

```
function make_comparer() {
    // Normalize criteria up front so that the comparer finds everything tidy
    $criteria = func_get_args();
    foreach ($criteria as $index => $criterion) {
        $criteria[$index] = is_array($criterion)
            ? array_pad($criterion, 3, null)
            : array($criterion, SORT_ASC, null);
    }

    return function($first, $second) use (&$criteria) {
        foreach ($criteria as $criterion) {
            // How will we compare this round?
            list($column, $sortOrder, $projection) = $criterion;
            $sortOrder = $sortOrder === SORT_DESC ? -1 : 1;

            // If a projection was defined project the values now
            if ($projection) {
                $lhs = call_user_func($projection, $first[$column]);
                $rhs = call_user_func($projection, $second[$column]);
            }
            else {
                $lhs = $first[$column];
                $rhs = $second[$column];
            }

            // Do the actual comparison; do not return if equal
            if ($lhs < $rhs) {
                return -1 * $sortOrder;
            }
            else if ($lhs > $rhs) {
                return 1 * $sortOrder;
            }
        }

        return 0; // tiebreakers exhausted, so $first == $second
    };
} 
```

## 如何使用

在本节中，我将提供对这个示例数据集进行排序的链接：

```
$data = array(
    array('zz', 'name' => 'Jack', 'number' => 22, 'birthday' => '12/03/1980'),
    array('xx', 'name' => 'Adam', 'number' => 16, 'birthday' => '01/12/1979'),
    array('aa', 'name' => 'Paul', 'number' => 16, 'birthday' => '03/11/1987'),
    array('cc', 'name' => 'Helen', 'number' => 44, 'birthday' => '24/06/1967'),
); 
```

### 基础

该函数`make_comparer`接受定义所需排序的可变数量的参数，并返回一个您应该用作`usort`or的参数的函数`uasort`。

最简单的用例是传入您想用来比较数据项的键。例如，按您要执行`$data`的项目排序`name`

```
usort($data, make_comparer('name')); 
```

**[看到它在行动](http://ideone.com/g5jNqs)**。

如果项目是数字索引数组，则键也可以是数字。对于问题中的示例，这将是

```
usort($data, make_comparer(0)); // 0 = first numerically indexed column 
```

**[看到它在行动](http://ideone.com/upHxqf)**。

### 多个排序列

您可以通过将附加参数传递给 来指定多个排序列`make_comparer`。例如，按“数字”排序，然后按零索引列：

```
usort($data, make_comparer('number', 0)); 
```

**[看到它在行动](http://ideone.com/C5OqJT)**。

## 高级功能

如果将排序列指定为数组而不是简单字符串，则可以使用更多高级功能。这个数组应该是数字索引的，并且必须包含这些项目：

```
0 => the column name to sort on (mandatory)
1 => either SORT_ASC or SORT_DESC (optional)
2 => a projection function (optional) 
```

让我们看看如何使用这些功能。

### 反向排序

按名称降序排序：

```
usort($data, make_comparer(['name', SORT_DESC])); 
```

**[看到它在行动](http://ideone.com/eLUqjb)**。

要按数字降序排序，然后按名称降序排序：

```
usort($data, make_comparer(['number', SORT_DESC], ['name', SORT_DESC])); 
```

**[看到它在行动](http://ideone.com/RpyQZ3)**。

### 自定义投影

在某些情况下，您可能需要按其值不适合排序的列进行排序。样本数据集中的“生日”列符合这个描述：将生日作为字符串进行比较是没有意义的（因为例如“01/01/1980”出现在“10/10/1970”之前）。在这种情况下，我们要指定如何将实际数据投影到*可以**直接*与所需语义进行比较的表单。

投影可以指定为任何类型的[可调用对象](http://php.net/manual/en/language.types.callable.php)：字符串、数组或匿名函数。假设投影接受一个参数并返回其投影形式。

应该注意的是，虽然投影类似于与`usort`和 系列一起使用的自定义比较函数，但它们更简单（您只需要将一个值转换为另一个值）并利用已经嵌入到`make_comparer`.

让我们对没有投影的示例数据集进行排序，看看会发生什么：

```
usort($data, make_comparer('birthday')); 
```

**[看到它在行动](http://ideone.com/GvXmoM)**。

那不是预期的结果。但我们可以[`date_create`](http://php.net/manual/en/function.date-create.php)用作投影：

```
usort($data, make_comparer(['birthday', SORT_ASC, 'date_create'])); 
```

**[看到它在行动](http://ideone.com/sZE4hO)**。

这是我们想要的正确顺序。

预测可以实现更多的事情。例如，获得不区分大小写排序的一种快速方法是`strtolower`用作投影。

也就是说，我还应该提到，如果您的数据集很大，最好不要使用投影：在这种情况下，预先手动投影所有数据然后在不使用投影的情况下进行排序会快得多，尽管这样做会交易增加内存使用以加快排序速度。

最后，这是一个使用所有功能的示例：它首先按数字降序排序，然后按生日升序排序：

```
usort($data, make_comparer(
    ['number', SORT_DESC],
    ['birthday', SORT_ASC, 'date_create']
)); 
```

**[看到它在行动](http://ideone.com/RLmvsm)**。

* * *

## 回答 #2

> 赞同：218
> 
> 时间：2008-09-18T20:57:02.340

您可以使用[array_multisort()](http://php.net/manual/en/function.array-multisort.php)

尝试这样的事情：

```
foreach ($mdarray as $key => $row) {
    // replace 0 with the field's index/key
    $dates[$key]  = $row[0];
}

array_multisort($dates, SORT_DESC, $mdarray); 
```

对于 PHP >= 5.5.0，只需提取要排序的列。不需要循环：

```
array_multisort(array_column($mdarray, 0), SORT_DESC, $mdarray); 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2008-09-18T20:53:11.880

用[usort](http://docs.php.net/manual/en/function.usort.php)。这是一个通用解决方案，您可以将其用于不同的列：

```
class TableSorter {
  protected $column;
  function __construct($column) {
    $this->column = $column;
  }
  function sort($table) {
    usort($table, array($this, 'compare'));
    return $table;
  }
  function compare($a, $b) {
    if ($a[$this->column] == $b[$this->column]) {
      return 0;
    }
    return ($a[$this->column] < $b[$this->column]) ? -1 : 1;
  }
} 
```

按第一列排序：

```
$sorter = new TableSorter(0); // sort by first column
$mdarray = $sorter->sort($mdarray); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-04-13T14:38:54.843

## 使用闭包进行多行排序

这是使用 uasort() 和匿名回调函数（闭包）的另一种方法。我经常使用该功能。**需要 PHP 5.3——**不再依赖！

```
/**
 * Sorting array of associative arrays - multiple row sorting using a closure.
 * See also: http://the-art-of-web.com/php/sortarray/
 *
 * @param array $data input-array
 * @param string|array $fields array-keys
 * @license Public Domain
 * @return array
 */
function sortArray( $data, $field ) {
    $field = (array) $field;
    uasort( $data, function($a, $b) use($field) {
        $retval = 0;
        foreach( $field as $fieldname ) {
            if( $retval == 0 ) $retval = strnatcmp( $a[$fieldname], $b[$fieldname] );
        }
        return $retval;
    } );
    return $data;
}

/* example */
$data = array(
    array( "firstname" => "Mary", "lastname" => "Johnson", "age" => 25 ),
    array( "firstname" => "Amanda", "lastname" => "Miller", "age" => 18 ),
    array( "firstname" => "James", "lastname" => "Brown", "age" => 31 ),
    array( "firstname" => "Patricia", "lastname" => "Williams", "age" => 7 ),
    array( "firstname" => "Michael", "lastname" => "Davis", "age" => 43 ),
    array( "firstname" => "Sarah", "lastname" => "Miller", "age" => 24 ),
    array( "firstname" => "Patrick", "lastname" => "Miller", "age" => 27 )
);

$data = sortArray( $data, 'age' );
$data = sortArray( $data, array( 'lastname', 'firstname' ) ); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-11-19T23:21:51.813

我知道这个问题被问和回答已经 2 年了，但这是另一个对二维数组进行排序的函数。它接受可变数量的参数，允许您传入多个键（即列名）进行排序。需要 PHP 5.3。

```
function sort_multi_array ($array, $key)
{
  $keys = array();
  for ($i=1;$i<func_num_args();$i++) {
    $keys[$i-1] = func_get_arg($i);
  }

  // create a custom search function to pass to usort
  $func = function ($a, $b) use ($keys) {
    for ($i=0;$i<count($keys);$i++) {
      if ($a[$keys[$i]] != $b[$keys[$i]]) {
        return ($a[$keys[$i]] < $b[$keys[$i]]) ? -1 : 1;
      }
    }
    return 0;
  };

  usort($array, $func);

  return $array;
} 
```

在这里试试：[http ://www.exorithm.com/algorithm/view/sort_multi_array](http://www.exorithm.com/algorithm/view/sort_multi_array)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-06-30T09:31:27.493

[您可以使用usort](https://www.php.net/usort)函数对数组进行排序。

```
 $array = array(
  array('price'=>'1000.50','product'=>'product 1'),
  array('price'=>'8800.50','product'=>'product 2'),
  array('price'=>'200.0','product'=>'product 3')
);

function cmp($a, $b) {
  return $a['price'] > $b['price'];
}
usort($array, "cmp");
print_r($array); 
```

输出 ：

```
Array
(
    [0] => Array
        (
            [price] => 134.50
            [product] => product 1
        )

    [1] => Array
        (
            [price] => 2033.0
            [product] => product 3
        )

    [2] => Array
        (
            [price] => 8340.50
            [product] => product 2
        )

) 
```

[例子](https://qoify.com/how-to-sort-an-array-of-associative-arrays-by-value-of-given-key-in-php)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T20:50:53.350

“Usort”功能就是您的答案。
[http://php.net/usort](http://php.net/usort)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-18T22:16:00.853

这是一个 php4/php5 类，它将对一个或多个字段进行排序：

```
// a sorter class
//  php4 and php5 compatible
class Sorter {

  var $sort_fields;
  var $backwards = false;
  var $numeric = false;

  function sort() {
    $args = func_get_args();
    $array = $args[0];
    if (!$array) return array();
    $this->sort_fields = array_slice($args, 1);
    if (!$this->sort_fields) return $array();

    if ($this->numeric) {
      usort($array, array($this, 'numericCompare'));
    } else {
      usort($array, array($this, 'stringCompare'));
    }
    return $array;
  }

  function numericCompare($a, $b) {
    foreach($this->sort_fields as $sort_field) {
      if ($a[$sort_field] == $b[$sort_field]) {
        continue;
      }
      return ($a[$sort_field] < $b[$sort_field]) ? ($this->backwards ? 1 : -1) : ($this->backwards ? -1 : 1);
    }
    return 0;
  }

  function stringCompare($a, $b) {
    foreach($this->sort_fields as $sort_field) {
      $cmp_result = strcasecmp($a[$sort_field], $b[$sort_field]);
      if ($cmp_result == 0) continue;

      return ($this->backwards ? -$cmp_result : $cmp_result);
    }
    return 0;
  }
}

/////////////////////
// usage examples

// some starting data
$start_data = array(
  array('first_name' => 'John', 'last_name' => 'Smith', 'age' => 10),
  array('first_name' => 'Joe', 'last_name' => 'Smith', 'age' => 11),
  array('first_name' => 'Jake', 'last_name' => 'Xample', 'age' => 9),
);

// sort by last_name, then first_name
$sorter = new Sorter();
print_r($sorter->sort($start_data, 'last_name', 'first_name'));

// sort by first_name, then last_name
$sorter = new Sorter();
print_r($sorter->sort($start_data, 'first_name', 'last_name'));

// sort by last_name, then first_name (backwards)
$sorter = new Sorter();
$sorter->backwards = true;
print_r($sorter->sort($start_data, 'last_name', 'first_name'));

// sort numerically by age
$sorter = new Sorter();
$sorter->numeric = true;
print_r($sorter->sort($start_data, 'age')); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T23:38:24.680

在我可以让 TableSorter 类运行之前，我想出了一个基于[Shinhan](https://stackoverflow.com/users/18219/shinhan)提供的函数。

```
function sort2d_bycolumn($array, $column, $method, $has_header)
  {
  if ($has_header)  $header = array_shift($array);
  foreach ($array as $key => $row) {
    $narray[$key]  = $row[$column]; 
    }
  array_multisort($narray, $method, $array);
  if ($has_header) array_unshift($array, $header);
  return $array;
  }
```

*   $array 是要排序的 MD 数组。
*   $column 是您希望排序的列。
*   $method 是您希望执行排序的方式，例如 SORT_DESC
*   如果第一行包含您不想排序的标题值，则 $has_header 设置为 true。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-06-19T20:54:33.197

我尝试了几个流行的 array_multisort() 和 usort() 答案，但没有一个对我有用。数据变得混乱，代码不可读。这是一个快速的肮脏解决方案。警告：只有在您确定流氓分隔符以后不会回来困扰您时才使用此功能！

假设你的多数组中的每一行看起来像：name, stuff1, stuff2：

```
// Sort by name, pull the other stuff along for the ride
foreach ($names_stuff as $name_stuff) {
    // To sort by stuff1, that would be first in the contatenation
    $sorted_names[] = $name_stuff[0] .','. name_stuff[1] .','. $name_stuff[2];
}
sort($sorted_names, SORT_STRING); 
```

需要按字母顺序返回您的东西吗？

```
foreach ($sorted_names as $sorted_name) {
    $name_stuff = explode(',',$sorted_name);
    // use your $name_stuff[0] 
    // use your $name_stuff[1] 
    // ... 
} 
```

是的，很脏。但是超级简单，不会让你的头爆炸。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2008-09-18T20:54:06.417

我更喜欢使用array_multisort。[请参阅此处](http://us2.php.net/manual/en/function.array-multisort.php)的文档 。

# visual-studio-2008 - 为什么 Visual Studio 经常崩溃？

> ID：96780
> 
> 赞同：31
> 
> 时间：2008-09-18T20:47:24.593
> 
> 标签：visual-studio-2008, version-control, crash, visual-sourcesafe

添加/删除引用和项目时，Visual Studio 随机崩溃。有什么想法为什么？安装 Sp1 会有帮助吗？

编辑：我不使用除 SourceSafe 之外的任何插件。我的大部分开发工作都是在连接模式下完成的。

开发使用：
Visual Studio 2008
WinXp Terminal Service -> Win2k3 Sp2 (64bit)
VSS 8.0, 32bit

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-09-18T20:59:00.850

尝试删除您的 .user 和 .suo 文件 - 这些是 VS 创建的用户选项文件。您将获得每个项目的 .user 文件和解决方案的 .suo 文件。当它们被破坏时，就会发生奇怪的事情。删除它们会让你失去一些小东西，比如当你开始调试时选择哪个项目作为启动项目，但它通常会清除这样的奇怪行为。

您可能还想清除任何临时文件位置，例如 Temporary ASP.NET Files 文件夹（如果您在 ASP.NET 中工作），以防在某处缓存了一些奇怪的东西。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-24T16:51:03.867

我的 Visual Studio 2005 最近开始崩溃和锁定。我最终修复它的方法是从命令行运行它：

```
devenv /resetuserdata 
```

这清除了我所有的自定义，但它确实解决了问题。如果您对 VS 进行了很多自定义，您可以先尝试导出设置，然后再查看是否可以安全地导入它们。或者，拍摄您的 IDE 的快照，这样您就可以记住您在哪里拥有哪些按钮等。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-18T21:00:13.220

最常见的是，如果 Visual Studio 反复崩溃，则您的 .suo 或 .ncb 文件已损坏。关闭您的项目，删除这些文件，然后重新打开。这可能会解决您的问题。

.suo 是一个隐藏文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-15T02:42:43.137

如果您怀疑`.suo`文件损坏并与 Source Safe 集成，请当心。

当您在崩溃后重新启动 VS 时，您可能会收到以下消息：

*`The Open from Source Control operation is still in progress but you can start working now. the rest of the projects will be retrieved asynchronously.`*

这基本上意味着 VS 将从 Source Safe 加载您打开的解决方案中的所有项目，并**覆盖**任何已签出并包含未签入更改的文件！
VS 崩溃后，独立启动 Source Safe 并检查您要保留的内容。
然后在再次启动 VS 之前修复损坏。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-08-29T04:56:19.153

如果 .suo 或 .ncb 文件已损坏，也会导致 Visual Studio 崩溃。要解决此崩溃，您可以使用图像中提到的以下步骤。

1.  转到包含 Visual Studio 执行文件 (devenv.exe) 的文件夹。
2.  使用第一步中提到的文件夹路径打开命令提示符并运行命令**devenv.exe /ResetSettings。**
3.  如果第二步不能解决您的问题，请运行命令**devenv.exe /ResetUserData**。

[![在此处输入图像描述](https://i.stack.imgur.com/cJ2pk.png)](https://i.stack.imgur.com/cJ2pk.png)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-01T08:36:28.153

希望这可以帮助某人。感觉就像我已经尝试了一切。我什至修复了安装，这没有任何区别，并且完全删除了 VS，问题仍然存在。日志选项没有告诉我任何重要的信息，因此我最终删除了解决方案中的所有 bin 和 obj 文件夹以及所有 .suo 和 .user 文件，并将其移至硬盘驱动器根文件夹之外的一个完全不同的文件夹并重建它. 它神奇地来了！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T20:53:05.810

搜索并删除与您的解决方案关联的任何 .ncb 文件。在过去的版本中，这些（调试）文件用于损坏并删除它们将解决问题（Visual Studio 将自动重新生成它们）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T20:54:00.693

我发现即使在 SP1 中，它也很少在向项目中添加内容时崩溃，但主要是在切换到 ASP.NET 设计视图以及在工具中自动生成控件时。我只是禁用了它来创建它们，并且我不再遇到很多崩溃。

我知道这与您的问题没有太大关系，但我提出 SP1 的目的可能不是您问题的答案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-28T15:16:59.483

[我尝试了所有建议的选项，并在此链接](http://social.msdn.microsoft.com/Forums/en/vssetup/thread/f425381b-de05-401b-8d03-37951dfab25a)中找到了更多选项。没运气。

然后我尝试添加来自**网站**的引用（而不是 Web 应用程序）。这个过程是不同的：您必须右键单击项目并转到属性页，并且`Add...`参考选项卡上有一个按钮。

它仍然崩溃，但**这次事件查看器中有一条消息**指出我已安装的第 3 方组件中的 DLL 的完整路径。无法从磁盘读取 DLL（损坏）。因此，修复该库并稍后重新启动，我又恢复了。

更新：

我来找出真正的原因，我的SSD上的几个文件已经损坏。CHKDSK /R 让我回去了一段时间。最终不得不更换驱动器。只是提醒一下，这可能不是VS的错。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-21T00:39:27.733

更改`default`解决方案位置解决了我的问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-03-09T18:38:25.237

我必须删除解决方案中不再存在的项目的旧参考，这对我来说效果很好。

# naming-conventions - 什么是适当的库命名约定？

> ID：96811
> 
> 赞同：1
> 
> 时间：2008-09-18T20:50:53.243
> 
> 标签：naming-conventions

有两种流行的命名约定：

1.  vc90/win64/debug/foo.dll
2.  foo-vc90-win64-debug.dll

请讨论与任何一种方法相关的问题/好处。

我还想知道是否有可能以易于使用的跨平台方式在方法#1 中公开元数据（即编译器、平台、构建类型）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T20:58:18.013

#2 有利于分发，其中几个变体将一起打包在同一个文件夹/zip 文件中。但是，您可能不希望文件名本身包含所有这些信息，因为很难通过参数将这些信息更改为 makefile/csproj/nant 脚本等。在其中包含多个名为“foo”的文件会更容易不同的文件夹（您可以在其中决定文件夹结构）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T21:04:14.100

对于 .NET 程序集，您可以将此信息存储在程序集本身中：

[http://www.codinghorror.com/blog/archives/000142.html](http://www.codinghorror.com/blog/archives/000142.html)

我对其他程序集类型不够熟悉，不知道它们提供了什么。

# regex - Vim：我如何搜索一个单词后面没有另一个单词？

> ID：96826
> 
> 赞同：47
> 
> 时间：2008-09-18T20:52:55.220
> 
> 标签：regex, vim

非常基本的问题，我正在尝试在 Vim 中编写一个正则表达式来匹配任何以`"abc "`直接开头的短语，然后是`"defg"`.

我曾经`"[^defg]"`匹配除 d、e、f 或 g 之外的任何单个字符。

我的第一个直觉是尝试这些作品，`/abc [^\(defg\)]`或者两者都没有。`/abc [^\<defg\>]`

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-09-18T21:09:43.087

这是搜索字符串。

```
/abc \(defg\)\@! 
```

您正在寻找的概念称为负前瞻断言。在 vim 中试试这个以获取更多信息：

```
:help \@! 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-19T03:00:46.957

之前还是之后？

如果是以 'abc' 开头而不是（立即）后跟 'defg' 的任何内容，那么您需要[bmdhacks 解决方案](https://stackoverflow.com/questions/96826/vim-how-do-i-exclude-an-entire-word-from-my-search#97008)。

如果它是以 'abc' 开头的任何东西，而不是（立即）在 'defg' 之前，你想要一个消极的后视：

```
/\%(defg\)\@<!abc / 
```

只要它不是“defgabc”的一部分，这将匹配任何出现的“abc”。有关`:help \@<!`更多详细信息，请参阅。

如果你想匹配 'abc '，只要它不是 'defg.*abc' 的一部分，那么只需添加一个`.*`：

```
/\%(defg.*\)\@<!abc / 
```

仅在没有出现 'defg' 的行上匹配 'abc' 是类似的：

```
/\%(defg.*\)\@<!abc \%(.*defg\)\@!/ 
```

虽然，如果您只是为了替换而这样做，您可以通过组合`:v//`和`:s//`

```
:%v/defg/s/abc /<whatever>/g 
```

这将在所有不包含“defg”的行上用“<whatever>”替换“abc”。查看`:help :v`更多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T21:03:51.417

我们走吧，这是一个毛茸茸的：

```
/\%(\%(.\{-}\)\@<=XXXXXX\zs\)* 
```

（将 XXXXXX 替换为搜索词）。这将搜索*不*包含 XXXXXX 的所有内容。我想如果你这样做：

```
/abc \%(\%(.\{-}\)\@<=defg\zs\)* 
```

这可能会像您希望的那样工作。希望这有所帮助！

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2008-09-18T21:06:16.310

/abc\ [^d][^e][^f][^g]

对于较大的单词来说这很麻烦，但它就像一个魅力。

# c# - LinkBut ton 未在生产服务器上触发

> ID：96837
> 
> 赞同：0
> 
> 时间：2008-09-18T20:53:38.073
> 
> 标签：c#, asp.net

这是[“Works on My Machine 认证计划”](http://www.codinghorror.com/blog/archives/000818.html)的理想候选者。

我有以下链接按钮的代码...

```
<cc1:PopupDialog ID="pdFamilyPrompt" runat="server" CloseLink="false" Display="true">
  <p>Do you wish to upgrade?</p>
  <asp:HyperLink ID="hlYes" runat="server" Text="Yes" CssClass="button"></asp:HyperLink>
  <asp:LinkButton ID="lnkbtnNo" runat="server" Text="No" CssClass="button"></asp:LinkButton>
</cc1:PopupDialog> 
```

它使用自定义控件，只需在内容之前和之后添加代码以将其格式化为弹出对话框。**Yes**按钮是一个 HyperLink ，因为它执行 javascript 来隐藏对话框并显示不同的对话框。**No**按钮是一个 LinkBut​​ton ，因为它需要 PostBack 来处理这个值。

我没有使用 LinkBut​​ton 注册 onClick 事件，因为我只是检查 IsPostBack 是否为真。在本地执行时，PostBack 工作正常，一切顺利。当发布到我们的开发服务器时，单击“**否”**按钮不会执行任何操作。在本地测试与在开发服务器上测试时，我使用相同的浏览器。

我最初的想法是，也许验证器正在阻止 PostBack 触发。我确实在页面的另一部分使用了几个验证器，但它们都分配给了一个特定的验证组，而**没有**分配没有链接按钮。然而问题是为什么它不能在开发服务器上本地工作。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T20:57:47.437

检查生产时发出的 html 并确保它具有 __doPostback() 并且没有全局方法监视单击和取消事件。除此之外，如果您认为它可能与验证有关，您可以尝试将 CausesValidation 或任何内容添加为 false 并查看是否有帮助。否则，“在我的机器上工作”错误很难在不存在并且不知道 DEV 与 PROD 的配置的情况下进行调试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-28T23:59:15.283

我有一个类似的问题。我创建了一个带有 updatePanel 的表单，表单中有一些可以打开 modalpopup Ajax 扩展器的链接按钮。在我向站点添加身份验证之前，它们运行良好。在那之后，他们什么也没做。

阅读您的解决方案，我发现一些链接按钮正在工作，它们是明确设置了 CausesValidation 的链接按钮（我只将它放入那些我会做到这一点的地方）。将 CausesValidation="false" 添加到所有其他链接按钮允许它们在我通过身份验证后正常工作。

谢谢大家的评论，它拯救了我的一天！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T21:01:03.203

我对 ValidationGroup 的理解是，没有指定组的按钮会触发页面上的所有验证器。您是否尝试过为 LinkBut​​ton 提供不同的 ValidationGroup？

# algorithm - 天真的洗牌的现实问题

> ID：96840
> 
> 赞同：4
> 
> 时间：2008-09-18T20:53:45.340
> 
> 标签：algorithm, probability, shuffle

我正在写一些文章，旨在通过使用与扑克相关的主题来教授初级编程概念。目前，我正在研究洗牌的主题。

正如[Jeff Atwood 在 CodingHorror.com 上指出的那样](http://www.codinghorror.com/blog/archives/001015.html "天真的危险")，一种简单的洗牌方法（遍历数组并将每张卡片与数组中其他地方的随机卡片交换）会导致排列分布不均匀。在实际应用中，我只会使用[Knuth Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Knuth_shuffle "Knuth Fisher-Yates 洗牌")以获得更均匀的随机性。但是，我不想用对编码器不太友好的算法来解释编程概念。

这就引出了一个问题：如果黑帽知道你使用的是 52 张牌的天真洗牌，他们会有多大的优势？似乎它会无限小。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-18T21:20:19.380

与幼稚的洗牌相比，knuth 洗牌是一个微不足道的变化：只需与牌组剩余（未洗牌）部分中的任何一张牌交换，而不是整个牌组中的任何一张牌。如果您将其视为从剩余未选择的卡片中按顺序重复选择下一张卡片，它也非常直观。

就个人而言，我认为在正确的算法不再复杂（并且更容易可视化！）时教给学生一个糟糕的算法是一种糟糕的方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T20:57:14.287

事实证明，优势非常显着。 [看看这篇文章](http://www.cigital.com/papers/download/developer_gambling.php)

问题的一部分是有缺陷的算法，但另一部分是假设您可以从计算机获得“随机”数字。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T21:09:00.437

一个简单且公平的洗牌算法是为一副牌中的每张牌分配一个随机浮点数（例如，在 0 和 1 之间），然后按分配的数字对一副牌进行排序。

这实际上是一个完美的例子，让学生意识到仅仅因为某些东西是直观的，在我们的例子中，天真的洗牌，并不意味着它是正确的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T21:13:42.003

顺便说一句，在 ITtoolbox 上有一篇关于 shuffle 的[博客文章，在](http://it.toolbox.com/blogs/codesharp/more-random-than-random-25106)模拟 shuffle 时可能会很有趣。

至于你的问题，考虑一下有52个！一个可以开始的牌组配置可能会影响事物的着陆位置，如 Jeff 的 3 张牌组示例，请注意，过度代表中的 1 在每个插槽中出现一次。另请注意，他说您必须有几千个示例才能明显优势在哪里，但是对于套牌，您不太可能从完全相同的初始套牌重新开始，是吗？你会拿起发牌并将它们放在底部并洗牌，我认为这不太可能重复。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T20:59:27.777

这不像您正在编写将用于实际在线赌博网站的扑克程序。当您教人们如何编程时，某人在程序中作弊的能力并不重要。

留言说这是一个糟糕的现实世界模型（将其称为可能的安全漏洞），然后继续进行教学。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-18T20:54:57.227

主观。

> 似乎它会无限小。

同意。

# git - 有没有办法从 git 的历史中清除一些文件？

> ID：96842
> 
> 赞同：6
> 
> 时间：2008-09-18T20:54:00.147
> 
> 标签：git, version-control

我已经将几个项目从 Subversion 迁移到 git。它工作得非常好，但是当我克隆我的存储库时，它真的很长，因为我有很多 .jar 文件的所有历史记录包含在传输中。

有没有办法在我的主存储库中只保留某种类型文件的最新版本。我主要想删除二进制文件上的旧版本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T21:25:30.540

您可以使用“git rebase”-i 或“git filter-branch”删除旧版本

[http://schacon.github.com/git/git-filter-branch.html](http://schacon.github.com/git/git-filter-branch.html)

[http://schacon.github.com/git/git-rebase.html](http://schacon.github.com/git/git-rebase.html)

其他文档和教程： http: [//git-scm.com/documentation](http://git-scm.com/documentation)

不支持从现在开始仅保留当前版本。最好的办法是在版本控制中保留一个下载（或构建，或以其他方式生成）大型 .jar 文件的小脚本。

由于这会修改历史记录，它将使所有以前的克隆或从此存储库中提取无效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T20:57:29.373

简而言之，这将涉及重写整个 git 提交树以排除文件。您是否尝试过使用`git gc`并`git pack`让 git 压缩您的存储库？

# perl - 有没有办法在 Perl 中使用“常量”作为哈希键？

> ID：96848
> 
> 赞同：32
> 
> 时间：2008-09-18T20:54:25.853
> 
> 标签：perl, hash, constants

有没有办法使用常量作为哈希键？

例如：

```
use constant X => 1;

my %x = (X => 'X'); 
```

上面的代码将创建一个以“X”作为键而不是 1 作为键的散列。然而，我想使用常量 X 的值作为键。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-09-18T20:57:00.840

`use constant`实际上制作了常量子程序。

要执行您想要的操作，您需要显式调用 sub：

```
use constant X => 1;

my %x = ( &X => 'X'); 
```

或者

```
use constant X => 1;

my %x = ( X() => 'X'); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-18T21:11:07.547

另一种选择是不使用 use constant pragma 并按照 Damian Conway 的 Perl Best Practices 中的建议翻转到 Readonly。

在意识到常量哈希引用只是对哈希的常量引用后，我切换了一段时间，但不对哈希内的数据做任何事情。

readonly 语法会创建“正常外观”的变量，但实际上会强制保持不变性或只读性。您可以像使用任何其他变量一样使用它作为键。

```
 use Readonly;

Readonly my $CONSTANT => 'Some value';

$hash{$CONSTANT} = 1; 

```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-09-18T20:57:32.650

您的问题是 => 是一个神奇的逗号，它会自动引用它前面的单词。所以你写的相当于（'X'，'X'）。

最简单的方法是只使用逗号：

```
my %x = (X, 'X'); 
```

或者，您可以添加各种标点符号，以便在 => 前面不再有一个简单的单词：

```
my %x = ( X() => 'X' );
my %x = ( &X => 'X' ); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-18T21:00:09.243

使用`$hash{CONSTANT()}`或`$hash{+CONSTANT}`防止裸词引用机制启动。

来自： http: [//perldoc.perl.org/constant.html](http://perldoc.perl.org/constant.html)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-18T22:00:14.917

大多数其他人都很好地回答了你的问题。总而言之，这些内容对问题和推荐的解决方法提供了非常完整的解释。问题是 Perl 编译指示“使用常量”确实在您当前的包中创建了一个子例程，其名称是编译指示的第一个参数，其值是最后一个。

在 Perl 中，一旦声明了子例程，就可以在没有括号的情况下调用它。

理解“常量”只是子例程，您可以看到为什么它们没有插入到字符串中，以及为什么引用左侧参数的“胖逗号”运算符“=>”认为你已经给它一个字符串（尝试其他内置-in 函数，如 time() 和 keys() 有时会加上逗号以获得​​额外的乐趣）。

幸运的是，您可以使用显式标点符号（如括号或 & 符号）来调用常量。

但是，我有一个问题要问您：您为什么要使用常量作为哈希键？

我可以想到一些可能会引导您朝这个方向发展的场景：

1.  您想要控制哪些键可以在散列中。

2.  您想抽象键的名称以防以后更改

在数字 1 的情况下，常量可能不会保存您的哈希值。相反，请考虑创建一个具有公共 setter 和 getter 的类，它们填充仅对对象可见的散列。这是一个非常不像 Perl 的解决方案，但很容易做到。

就第 2 种情况而言，我仍然强烈主张建立一个班级。如果对哈希的访问是通过定义良好的接口进行管理的，那么只有类的实现者负责正确获取哈希键名。在这种情况下，我根本不建议使用常量。

希望这会有所帮助，并感谢您的宝贵时间。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-18T21:16:26.287

pragma 创建了一个子例程原型，`use constant`不接受任何参数。虽然它*看起来*像一个 C 风格的常量，但它实际上是一个返回常量值的子例程。

如果`=>`(fat comma) 是裸字，则 (fat comma) 会自动引用左操作数，$hash{key} 表示法也是如此。

如果您对常量名称的使用看起来像一个裸词，那么引用机制将启动，您将获得它的名称作为键而不是它的值。为防止这种情况发生，请更改用法，使其不是裸词。例如：

```
use constant X => 1;
%hash = (X() => 1);
%hash = (+X => 1);
$hash{X()} = 1;
$hash{+X} = 1; 
```

在初始化程序中，您也可以使用普通逗号代替：

```
%hash = (X, 1); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T20:58:17.187

=> 运算符将其左侧解释为“字符串”，就像 qw() 一样。

尝试使用

```
my %x = ( X, 'X'); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-18T20:58:25.127

一种方法是将 X 封装为 (X)：

```
my %x ( (X) => 1 ); 
```

另一种选择是取消 '=>' 并使用 ',' 代替：

```
my %x ( X, 1 ); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-22T11:33:06.987

评论@shelfoo（声誉还不够高，无法直接在那里添加评论！）

完全同意 Damian Conway 的 Perl Best Practices ……强烈推荐阅读。

但是，如果您打算将 PBP 用作内部风格指南，请阅读[PBP 模块推荐评论，这是一个有用的“勘误表”。](http://www.perlfoundation.org/perl5/index.cgi?pbp_module_recommendation_commentary)

# c# - 域对象模型的包命名约定

> ID：96859
> 
> 赞同：1
> 
> 时间：2008-09-18T20:55:39.737
> 
> 标签：c#, java, naming-conventions, packages

对于特定领域的对象模型，有哪些好的包命名约定。例如，假设您有一个**Person.java** POJO，您会将其放在**mydomain.model**或 **mydomain.entity**或**mydomain.om**（对象模型）包中。这个想法是将 MVC 模型对象与域对象模型分开。我们基于 MVC 的应用程序有一个包含行为 的**模型包，但使用该包来包含我们的域对象模型似乎不合适并且可能会造成混淆。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T01:01:51.547

我个人使用“com.mycompany.domain”，但这可能不是最好的答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-19T19:59:09.610

您可能希望垂直而不是水平地组织您的包以分离功能。

例如。

```
com.foobar.accounting.model.*
com.foobar.accounting.view.*

com.foobar.invoicing.model.*
com.foobar.invoicing.view.* 
```

可能比

```
com.foobar.model.accounting.*
com.foobar.model.invoicing.*

com.foobar.view.accounting.*
com.foobar.view.invoicing.* 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T21:02:05.493

您选择的包名称无关紧要。只要您的团队都在同一页面上，模型与域与 vo 与 foobar 都很好。我同意这个包应该只包含没有重要业务逻辑的 POJO 域对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T21:06:31.193

不仅如此，请注意命名空间的命名约定。我见过命名空间名称在不同程序集中重复的情况。谈论混乱。

# mysql - 什么导致表需要修理？

> ID：96867
> 
> 赞同：11
> 
> 时间：2008-09-18T20:56:47.300
> 
> 标签：mysql, database

每隔一段时间，我就会收到一条错误消息，说我的一张表“被标记为崩溃，应该修复”。然后我做一个修复表并修复它。是什么导致它们被标记为崩溃，我该如何防止它？我在 MySQL 5.0.45 中使用 MyISAM 表。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T21:18:28.760

表损坏可能有几个原因，[手册](http://dev.mysql.com/doc/refman/5.0/en/corrupted-myisam-tables.html)中对此进行了详细讨论。

为了对抗它，以下事情最有效：

1.  确保您始终正确关闭 MySQL
2.  考虑使用 --myisam-recover 选项在未正确关闭的情况下自动检查/修复您的表
3.  确保您使用的是最新版本，因为已知的损坏错误通常会尽快修复
4.  通过测试仔细检查您的硬件，看看它是否导致问题。[sysbench](http://sysbench.sourceforge.net/)和[memtest86](http://www.memtest86.com/)之类的工具通常可以帮助验证事情是否按应有的方式工作。
5.  确保没有任何东西从外部接触数据目录，例如病毒检查程序、备份程序等...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T21:05:46.250

通常，它发生在数据库未正确关闭时，例如系统崩溃或硬件问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-03T15:18:26.747

我曾经和你一样从 mysql 得到错误。

我以这种方式解决了我的问题

1.  将所有 myisam 表转换为 InnoDB（您可以在 stackoverflow.com 和搜索引擎中搜索“myisam vs InnoDB”以找出原因）
2.  为了从 MySQL 获得最佳性能，请使用第三方程序 MONyog (MySQL Monitor and Advisor) 并检查性能提示

这两个步骤救了我。我希望这些也对你有很大帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T21:05:07.000

这可能是很多事情，但[MySQL 性能博客](http://www.mysqlperformanceblog.com/2006/06/17/using-myisam-in-production/ "在生产中使用 MyISAM")提到了可能导致隐藏损坏的内存、操作系统或 MySQL 错误。此外，那篇文章和[另一篇文章](http://www.mysqlperformanceblog.com/2006/07/30/mysql-crash-recovery/ "MySQL 崩溃恢复")提到了在进行崩溃恢复时要记住的几件事。

# c# - 如何从较小的组件图像构建 C# ImageList 图像？

> ID：96871
> 
> 赞同：0
> 
> 时间：2008-09-18T20:57:03.243
> 
> 标签：c#, winforms, image, .net-2.0, system.drawing

我想为 C# WinForms TreeList 控件制作状态图标。状态是其他状态的组合（例如，用户节点可能是非活动或被禁止或非活动和被禁止），状态图标由不重叠的较小字形组成。

如果可以的话，我真的很想避免手动生成状态图标的所有可能排列。

是否可以创建可用于以编程方式生成 ImageList 的图像列表（或只是一堆位图资源或其他东西）？

我在 System.Drawing 类中闲逛，但没有任何反应。另外，我坚持使用.Net 2.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T21:00:22.393

```
Bitmap image1 = ...
Bitmap image2 = ...

Bitmap combined = new Bitmap(image1.Width, image1.Height);
using (Graphics g = Graphics.FromImage(combined)) {
  g.DrawImage(image1, new Point(0, 0));
  g.DrawImage(image2, new Point(0, 0);
}

imageList.Add(combined); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T22:49:36.763

只需使用 ImageList 中的 Images.Add 添加单个图像。所以，像：

```
 Image img = Image.FromStream( /*get stream from resources*/ );
ImageList1.Images.Add( img ); 
```

# java - 通过 RMI 对比 EJB 和 Toplink 的 ADF 业务组件

> ID：96875
> 
> 赞同：0
> 
> 时间：2008-09-18T20:57:24.397
> 
> 标签：java, jakarta-ee, ejb, oracle-adf

实现远程业务逻辑有什么区别？

目前我们正计划使用[ADF](http://en.wikipedia.org/wiki/Oracle_Application_Development_Framework)来开发前端 Web 应用程序（从[Struts](http://en.wikipedia.org/wiki/Apache_Struts)转移）。由于从 Struts 到 ADF 的迁移还将包括 PL/SQL 和 Oracle Forms，因此用户数量急剧增加，因此前端使用[TopLink调用](http://en.wikipedia.org/wiki/TopLink)[EJB与通过](http://en.wikipedia.org/wiki/Enterprise_JavaBean)[RMI](http://en.wikipedia.org/wiki/Java_remote_method_invocation)调用ADF 业务组件之间有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T14:16:47.690

ADF 非常广泛，因为它涵盖了前端一直到数据访问。如果您打算使用整个堆栈，它是一个很棒的[RAD](http://en.wikipedia.org/wiki/Rapid_application_development)框架，但如果您只打算使用其中的一部分，它就不那么热门了。

我假设您正在谈论将 TopLink 或 ADF 业务组件 (BC4J) 用于数据访问层。

我想说，如果您打算使用基于 RMI 的应用程序，TopLink 可能会更好，主要是因为 BC4J 的强大功能在于它的视图对象，它不会序列化（因此将这些结果转换为 TopLink 样式的值对象，反正）。

如果您正在做一个直接向上和向下的 Web 应用程序并且并不真正关心 EJB 和 RMI，那么我认为您会发现 BC4J 在使标准 Web 应用程序扩展方面提供了很多东西......长话短说，它将 SQL 映射到视图对象，这些对象基本上是智能数据网格，具有非常可调的行为，可以直接绑定到Oracle ADF Faces 的[JSF](http://en.wikipedia.org/wiki/JavaServer_Faces)组件，从而提供非常好的无缝 RAD。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T00:14:38.390

我现在正在经历类似的情况。我不是专家，但这里是我从我的经验中收集到的。EJB 使用 Toplink 还是 ADF 是否能更好地扩展在很大程度上取决于您的具体情况。在某些情况下，一个可能比另一个更好，但我觉得它们都是很好的解决方案。

但是，既然您提到该项目还涉及 Oracle Forms 的迁移，那么 ADF 似乎将是最佳选择，因为 Oracle 似乎将 JDeveloper 和 ADF 定位为 Forms and Reports 的继任者（请参阅[ADF 文档针对 Forms and Designer开发人员](http://www.oracle.com/technology/products/jdev/collateral/4gl/formsdesignerj2ee.html)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-02T19:37:55.323

您不应使用 ADF BC 的 EJB 部署。它需要大量的 RMI 同步。我将它与 ADF [Swing](http://en.wikipedia.org/wiki/Swing_%28Java%29)一起使用。转到下一个记录大约需要三秒钟。我们需要重写组合框以使其执行。

在[Oracle 11g](http://en.wikipedia.org/wiki/Oracle_Database#History)（2009-05 版）中，您将获得基于视图对象创建 SDO WS 的选项，并且您可以在其他 ADF 项目中的基于 ADF BC 服务的实体中使用这些选项。

# macos - 如何使用命令行工具为 Mac OS X 创建漂亮的 DMG？

> ID：96882
> 
> 赞同：224
> 
> 时间：2008-09-18T20:57:58.373
> 
> 标签：macos, scripting, installation, dmg

我需要为 Mac 应用程序创建一个不错的安装程序。我希望它是具有预定义大小、布局和背景图像的磁盘映像 (DMG)。

我需要在脚本中以编程方式执行此操作，以便集成到现有的构建系统中（实际上更多的是一个包系统，因为它只创建安装程序。构建是单独完成的）。

我已经使用“hdiutil”完成了 DMG 创建，但我还没有发现如何制作图标布局和指定背景位图。

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2009-10-03T12:05:26.397

经过大量研究，我想出了这个答案，特此将其放在这里作为我自己问题的答案，以供参考：

1.  确保在系统偏好设置>>通用访问中选中“启用辅助设备访问”。AppleScript 需要它才能工作。在此更改后您可能需要重新启动（否则它在 Mac OS X Server 10.4 上不起作用）。

2.  创建一个 R/W DMG。它必须大于结果。在此示例中，bash 变量“size”包含以 Kb 为单位的大小，并且“source”bash 变量中的文件夹内容将被复制到 DMG 中：

    ```
    hdiutil create -srcfolder "${source}" -volname "${title}" -fs HFS+ \
          -fsargs "-c c=64,a=16,e=16" -format UDRW -size ${size}k pack.temp.dmg 
    ```

3.  挂载磁盘映像，并存储设备名称（您可能希望在此操作后使用 sleep 几秒钟）：

    ```
    device=$(hdiutil attach -readwrite -noverify -noautoopen "pack.temp.dmg" | \
             egrep '^/dev/' | sed 1q | awk '{print $1}') 
    ```

4.  将背景图片（PNG 格式）存储在 DMG 中名为“.background”的文件夹中，并将其名称存储在“backgroundPictureName”变量中。

5.  使用 AppleScript 设置视觉样式（.app 的名称必须在 bash 变量“applicationName”中，根据需要使用其他属性的变量）：

    ```
    echo '
       tell application "Finder"
         tell disk "'${title}'"
               open
               set current view of container window to icon view
               set toolbar visible of container window to false
               set statusbar visible of container window to false
               set the bounds of container window to {400, 100, 885, 430}
               set theViewOptions to the icon view options of container window
               set arrangement of theViewOptions to not arranged
               set icon size of theViewOptions to 72
               set background picture of theViewOptions to file ".background:'${backgroundPictureName}'"
               make new alias file at container window to POSIX file "/Applications" with properties {name:"Applications"}
               set position of item "'${applicationName}'" of container window to {100, 100}
               set position of item "Applications" of container window to {375, 100}
               update without registering applications
               delay 5
               close
         end tell
       end tell
    ' | osascript 
    ```

6.  通过正确设置权限、压缩和释放它来完成 DMG：

    ```
    chmod -Rf go-w /Volumes/"${title}"
    sync
    sync
    hdiutil detach ${device}
    hdiutil convert "/pack.temp.dmg" -format UDZO -imagekey zlib-level=9 -o "${finalDMGName}"
    rm -f /pack.temp.dmg 
    ```

在 Snow Leopard 上，上面的 applescript 不会正确设置图标位置 - 这似乎是一个 Snow Leopard 错误。一种解决方法是在设置图标后简单地调用关闭/打开，即：

```
..
set position of item "'${applicationName}'" of container window to {100, 100}
set position of item "Applications" of container window to {375, 100}
close
open 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2009-03-10T03:40:41.997

[有一个名为create-dmg](https://github.com/andreyvit/create-dmg)的小 Bash 脚本可以构建具有自定义背景、自定义图标位置和卷名的精美 DMG。

我多年前为我当时经营的公司建立了它；从那时起，它依靠其他人的贡献而生存，据报道运作良好。

还有[node-appdmg](https://github.com/LinusU/node-appdmg)，它看起来像是基于 Node.js 的更现代和更积极的努力；也检查一下。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2008-09-18T21:11:57.590

不要去那里。作为一名长期的 Mac 开发人员，我可以向您保证，没有任何解决方案能够真正奏效。我尝试了很多解决方案，但它们都不是很好。我认为问题在于 Apple 并没有真正记录必要数据的元数据格式。

以下是我长期以来的做法，非常成功：

1.  创建一个新的 DMG，可写（！），大到足以容纳预期的二进制文件和额外的文件，如自述文件（稀疏可能有效）。

2.  安装 DMG 并在 Finder 中手动设置布局，或者使用适合您的任何工具进行布局。背景图像通常是我们放入 DMG 上隐藏文件夹（“.something”）中的图像。将您的应用程序的副本放在那里（任何版本，甚至过时的版本都可以）。再次复制您想要的其他文件（别名、自述文件等），过时的版本就可以了。确保图标具有正确的大小和位置（IOW，按照您想要的方式布局 DMG）。

3.  再次卸载 DMG，现在应该存储所有设置。

4.  编写一个创建 DMG 脚本，其工作方式如下：

*   它会复制 DMG，因此永远不会再触及原始的 DMG。
*   它安装副本。
*   它用最新的文件替换所有文件（例如构建后的最新应用程序）。您可以在命令行上简单地使用*mv*或*同上*。请注意，当您替换这样的文件时，图标将保持不变，位置将保持不变，除了文件（或目录）内容之外的所有内容都保持不变（至少同上，我们通常用于该任务） . 您当然也可以用另一张图片替换背景图片（只要确保它具有相同的尺寸）。
*   替换文件后，使脚本再次卸载 DMG 副本。
*   最后调用 hdiutil 将可写转换为压缩（且不可写）DMG。

这种方法听起来可能不是最优的，但相信我，它在实践中非常有效。您甚至可以将原始 DMG（DMG 模板）置于版本控制（例如 SVN）之下，因此如果您不小心更改/破坏了它，您可以返回到它仍然可以的版本。您可以将 DMG 模板与属于 DMG 的所有其他文件（自述文件、URL 文件、背景图像）一起添加到您的 Xcode 项目中，都在版本控制下，然后创建一个目标（例如名为“Create DMG”的外部目标）并在那里运行上面的 DMG 脚本并将您的旧主目标添加为依赖目标。您可以在脚本中使用 ${SRCROOT} 访问 Xcode 树中的文件（始终是产品的源根目录），并且可以使用 ${BUILT_PRODUCTS_DIR} 访问构建产品（始终是 Xcode 创建构建结果的目录） .

结果：实际上 Xcode 可以在构建结束时生成 DMG。准备发布的 DMG。您不仅可以通过这种方式非常轻松地创建发布 DMG，而且您实际上可以在自动化过程中（如果您愿意，可以在无头服务器上）使用命令行中的 xcodebuild（例如自动夜间构建）来执行此操作。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2015-01-23T15:12:07.197

通过提供此答案来更新此问题。

`appdmg`是一个简单易用的开源命令行程序，它从简单的 json 规范创建 dmg 文件。看看官网的readme：

[https://github.com/LinusU/node-appdmg](https://github.com/LinusU/node-appdmg)

快速示例：

1.  安装 appdmg

    ```
    npm install -g appdmg 
    ```

2.  写一个 json 文件 ( `spec.json`)

    ```
    {
      "title": "Test Title",
      "background": "background.png",
      "icon-size": 80,
      "contents": [
        { "x": 192, "y": 344, "type": "file", "path": "TestApp.app" },
        { "x": 448, "y": 344, "type": "link", "path": "/Applications" }
      ]
    } 
    ```

3.  运行程序

    ```
    appdmg spec.json test.dmg 
    ```

（免责声明。我是 appdmg 的创建者）

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2008-09-18T21:13:35.620

对于那些对此主题感兴趣的人，我应该提到我是如何创建 DMG 的：

```
hdiutil create XXX.dmg -volname "YYY" -fs HFS+ -srcfolder "ZZZ" 
```

在哪里

```
XXX == disk image file name (duh!)
YYY == window title displayed when DMG is opened
ZZZ == Path to a folder containing the files that will be copied into the DMG 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2010-06-30T15:38:26.373

我的应用程序[DropDMG](http://c-command.com/dropdmg/)是一种创建具有背景图片、图标布局、自定义卷图标和软件许可协议的磁盘图像的简单方法。它可以通过“dropdmg”命令行工具或 AppleScript 从构建系统进行控制。如果需要，图片和许可证 RTF 文件可以存储在您的版本控制系统下。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2015-12-20T13:23:04.200

为了创建漂亮的 DMG，您现在可以使用一些编写良好的开源代码：

*   [创建-dmg](https://github.com/andreyvit/create-dmg)
*   [节点应用程序](https://github.com/LinusU/node-appdmg)
*   [dmgbuild](https://pypi.python.org/pypi/dmgbuild)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-02-22T14:05:40.860

我发现这个很棒的 mac 应用程序可以自动化这个过程 - [http://www.araelium.com/dmgcanvas/](http://www.araelium.com/dmgcanvas/) 如果你正在为你的 mac 应用程序创建 dmg 安装程序，你必须看看

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-08-26T12:16:54.023

如果要设置自定义音量图标，请使用以下命令

```
/*Add a drive icon*/
cp "/Volumes/customIcon.icns" "/Volumes/dmgName/.VolumeIcon.icns"  

/*SetFile -c icnC will change the creator of the file to icnC*/
SetFile -c icnC /<your path>/.VolumeIcon.icns 
```

现在创建读/写 dmg

```
/*to set custom icon attribute*/
SetFile -a C /Volumes/dmgName 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-07-24T20:47:26.587

我终于在我自己的项目中得到了这个工作（恰好在 Xcode 中）。将这 3 个脚本添加到您的构建阶段将自动为您的产品创建一个漂亮而整洁的磁盘映像。您所要做的就是构建您的项目，DMG 将在您的产品文件夹中等待。

脚本 1（创建临时磁盘映像）：

```
#!/bin/bash
#Create a R/W DMG

dir="$TEMP_FILES_DIR/disk"
dmg="$BUILT_PRODUCTS_DIR/$PRODUCT_NAME.temp.dmg"

rm -rf "$dir"
mkdir "$dir"
cp -R "$BUILT_PRODUCTS_DIR/$PRODUCT_NAME.app" "$dir"
ln -s "/Applications" "$dir/Applications"
mkdir "$dir/.background"
cp "$PROJECT_DIR/$PROJECT_NAME/some_image.png" "$dir/.background"
rm -f "$dmg"
hdiutil create "$dmg" -srcfolder "$dir" -volname "$PRODUCT_NAME" -format UDRW

#Mount the disk image, and store the device name
hdiutil attach "$dmg" -noverify -noautoopen -readwrite 
```

脚本 2（设置窗口属性脚本）：

```
#!/usr/bin/osascript
#get the dimensions of the main window using a bash script

set {width, height, scale} to words of (do shell script "system_profiler SPDisplaysDataType | awk '/Main Display: Yes/{found=1} /Resolution/{width=$2; height=$4} /Retina/{scale=($2 == \"Yes\" ? 2 : 1)} /^ {8}[^ ]+/{if(found) {exit}; scale=1} END{printf \"%d %d %d\\n\", width, height, scale}'")
set x to ((width / 2) / scale)
set y to ((height / 2) / scale)

#get the product name using a bash script
set {product_name} to words of (do shell script "printf \"%s\", $PRODUCT_NAME")
set background to alias ("Volumes:"&product_name&":.background:some_image.png")

tell application "Finder"
    tell disk product_name
        open
        set current view of container window to icon view
        set toolbar visible of container window to false
        set statusbar visible of container window to false
        set the bounds of container window to {x, y, (x + 479), (y + 383)}
        set theViewOptions to the icon view options of container window
        set arrangement of theViewOptions to not arranged
        set icon size of theViewOptions to 128
        set background picture of theViewOptions to background
        set position of item (product_name & ".app") of container window to {100, 225}
        set position of item "Applications" of container window to {375, 225}
        update without registering applications
        close
    end tell
end tell 
```

由于我的背景图片和图标分辨率的大小，上述窗口测量适用于我的项目；您可能需要为自己的项目修改这些值。

脚本 3（制作最终磁盘映像脚本）：

```
#!/bin/bash
dir="$TEMP_FILES_DIR/disk"
cp "$PROJECT_DIR/$PROJECT_NAME/some_other_image.png" "$dir/"

#unmount the temp image file, then convert it to final image file
sync
sync
hdiutil detach /Volumes/$PRODUCT_NAME
rm -f "$BUILT_PRODUCTS_DIR/$PRODUCT_NAME.dmg"
hdiutil convert "$BUILT_PRODUCTS_DIR/$PRODUCT_NAME.temp.dmg" -format UDZO -imagekey zlib-level=9 -o "$BUILT_PRODUCTS_DIR/$PRODUCT_NAME.dmg"
rm -f "$BUILT_PRODUCTS_DIR/$PRODUCT_NAME.temp.dmg"

#Change the icon of the image file
sips -i "$dir/some_other_image.png"
DeRez -only icns "$dir/some_other_image.png" > "$dir/tmpicns.rsrc"
Rez -append "$dir/tmpicns.rsrc" -o "$BUILT_PRODUCTS_DIR/$PRODUCT_NAME.dmg"
SetFile -a C "$BUILT_PRODUCTS_DIR/$PRODUCT_NAME.dmg"

rm -rf "$dir" 
```

确保您使用的图像文件位于 $PROJECT_DIR/$PROJECT_NAME/ 目录中！

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-04-14T08:09:40.290

.DS_Store 文件将 Windows 设置存储在 Mac 中。窗口设置包括图标布局、窗口背景、窗口大小等。为挂载图像创建窗口时需要 .DS_Store 文件，以保留文件排列和窗口背景。

创建 .DS_Store 文件后，您可以将其复制到您创建的安装程序 (DMG)。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-10-09T12:55:20.087

我还需要使用命令行方法“在脚本中以编程方式”进行打包和 dmg 创建。到目前为止，我找到的最佳答案来自 Adium 项目的发布构建框架（参见 R1）。有一个自定义脚本 (AdiumApplescriptRunner) 可以让您避免 OSX WindowsServer GUI 交互。“osascript applescript.scpt”方法要求您以 builder 身份登录并从命令行 vt100 会话运行 dmg 创建。

OSX 包管理系统与其他可以轻松系统地完成此任务的 Unixen 相比，并没有那么先进。

R1：[http ://hg.adium.im/adium-1.4/file/00d944a3ef16/Release](http://hg.adium.im/adium-1.4/file/00d944a3ef16/Release)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-02-17T10:35:14.363

我刚刚编写了一个新的（友好的）命令行实用程序来执行此操作。它不依赖于 Finder/AppleScript，或任何（已弃用）Alias Manager API，并且易于配置和使用。

无论如何，任何有兴趣的人都可以[在 PyPi 上找到它](https://pypi.python.org/pypi/dmgbuild)；文档[可在 Read The Docs 上找到](http://dmgbuild.rtfd.org)。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-01-02T09:11:19.020

这些答案太复杂了，时代变了。以下在 10.9 上工作得很好，权限正确，看起来不错。

### 从目录创建只读 DMG

```
#!/bin/sh
# create_dmg Frobulator Frobulator.dmg path/to/frobulator/dir [ 'Your Code Sign Identity' ]
set -e

VOLNAME="$1"
DMG="$2"
SRC_DIR="$3"
CODESIGN_IDENTITY="$4"

hdiutil create -srcfolder "$SRC_DIR" \
  -volname "$VOLNAME" \
  -fs HFS+ -fsargs "-c c=64,a=16,e=16" \
  -format UDZO -imagekey zlib-level=9 "$DMG"

if [ -n "$CODESIGN_IDENTITY" ]; then
  codesign -s "$CODESIGN_IDENTITY" -v "$DMG"
fi 
```

### 创建带有图标（.icns 类型）的只读 DMG

```
#!/bin/sh
# create_dmg_with_icon Frobulator Frobulator.dmg path/to/frobulator/dir path/to/someicon.icns [ 'Your Code Sign Identity' ]
set -e
VOLNAME="$1"
DMG="$2"
SRC_DIR="$3"
ICON_FILE="$4"
CODESIGN_IDENTITY="$5"

TMP_DMG="$(mktemp -u -t XXXXXXX)"
trap 'RESULT=$?; rm -f "$TMP_DMG"; exit $RESULT' INT QUIT TERM EXIT
hdiutil create -srcfolder "$SRC_DIR" -volname "$VOLNAME" -fs HFS+ \
               -fsargs "-c c=64,a=16,e=16" -format UDRW "$TMP_DMG"
TMP_DMG="${TMP_DMG}.dmg" # because OSX appends .dmg
DEVICE="$(hdiutil attach -readwrite -noautoopen "$TMP_DMG" | awk 'NR==1{print$1}')"
VOLUME="$(mount | grep "$DEVICE" | sed 's/^[^ ]* on //;s/ ([^)]*)$//')"
# start of DMG changes
cp "$ICON_FILE" "$VOLUME/.VolumeIcon.icns"
SetFile -c icnC "$VOLUME/.VolumeIcon.icns"
SetFile -a C "$VOLUME"
# end of DMG changes
hdiutil detach "$DEVICE"
hdiutil convert "$TMP_DMG" -format UDZO -imagekey zlib-level=9 -o "$DMG"
if [ -n "$CODESIGN_IDENTITY" ]; then
  codesign -s "$CODESIGN_IDENTITY" -v "$DMG"
fi 
```

如果需要发生其他任何事情，最简单的方法是制作 SRC_DIR 的临时副本并在创建 DMG 之前对其应用更改。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-04-14T13:43:01.717

我使用[dmgbuild](https://pypi.org/project/dmgbuild/)。

*   安装：`pip3 install dmgbuild`
*   挂载你的卷
*   创建一个设置文件：

```
{
    "title": "NAME",
    "background": "YOUR_BACKGROUND.png",
    "format": "UDZO",
    "compression-level": 9,
    "window": { "position": { "x": 100, "y": 100 },
                "size": { "width": 640, "height": 300 } },
    "contents": [
        { "x": 140, "y": 165, "type": "file", "path": "/Volumes/YOUR_VOLUME_NAME/YOUR_APP.app" },
        { "x": 480, "y": 165, "type": "link", "path": "/Applications" }
    ]
} 
```

*   宽度值是背景的宽度。

*   高度值应该是窗口栏的背景高度 + 20。

*   在终端中：`dmgbuild -s settings.json "YOUR_VOLUME_NAME" output.dmg`

# java - 既然可以只使用 Java，为什么还要使用 Jython？

> ID：96922
> 
> 赞同：25
> 
> 时间：2008-09-18T21:01:30.423
> 
> 标签：java, eclipse, jython

标准答案是，当您只需要编写几行代码时它很有用......

我在 Eclipse 中集成了两种语言。因为 Eclipse 处理编译、解释、运行等都“运行”完全相同。

两者的 Eclipse IDE 是相似的——即时“编译”、智能感知等。两者都允许使用 Debug 透视图。

如果我想测试几行 Java，我不必创建一个全新的 Java 项目——我只需使用 Eclipse 中的[Scrapbook](http://www.eclipsezone.com/eclipse/forums/t61137.html)功能，它允许我*“执行 Java 表达式而无需创建新的 Java 程序。这是一种快速测试现有类或评估代码片段的巧妙方法”*。

Jython 允许使用 Java 库——但是（根据定义）Java 也是如此！

那么 Jython 还提供哪些其他好处？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-09-18T22:13:00.860

一个简单的例子（来自[http://coreygoldberg.blogspot.com/2008/09/python-vs-java-http-get-request.html](http://coreygoldberg.blogspot.com/2008/09/python-vs-java-http-get-request.html)）：

你有一个 Java 后端，你需要执行 HTTP GET 请求。

本机：

```
import java.net.*;
import java.io.*;

public class JGet {
    public static void main (String[] args) throws IOException {
        try {
            URL url = new URL("http://www.google.com");

            BufferedReader in = 
                new BufferedReader(new InputStreamReader(url.openStream()));
            String str;

            while ((str = in.readLine()) != null) {
                System.out.println(str);
            }

            in.close();
        } 
        catch (MalformedURLException e) {} 
        catch (IOException e) {}
    }
} 
```

在 Python 中：

```
import urllib
print urllib.urlopen('http://www.google.com').read() 
```

Jython 允许您使用 java 的健壮性，并在需要时使用 Python 的清晰度。

还有什么 ？正如乔治所说...

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-18T21:03:01.403

Python 语法（由 Jython 使用）对于许多程序员来说开发起来更加简洁和快速。

此外，您可以在 Java 应用程序中使用现有的 Python 库。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-05T19:33:55.547

类比：当你可以喝热自来水和咀嚼烤苦豆时，为什么还要喝咖啡。:-)

对于某些任务，Python 只是味道更好，效果更好，并且足够快（需要时间来酝酿？）。如果您的编程或部署环境专注于 JVM，那么 Jython 允许您编写 Python 代码，但无需更改您的部署和运行时环境。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-05-23T21:11:54.330

我刚刚发现了 Jython，作为一个语言学家，我想我会说这有点像问“当你可以使用法语时为什么要使用拉丁语”（当然，忘记拉丁语先于法语的事实） .

不同的人类语言实际上会让你以不同的方式思考。法语是一门很棒的语言，我在法国生活了很长时间并获得了学位。但是拉丁语惊人的力量和简洁将你的思维带入了一个不同的区域，例如，可以交换词序以产生各种微妙的效果。

我认为，从我对 Jython 的粗略了解（顺便说一下，这确实激发了我的热情），这将使我以不同的方式思考。一段时间以来，我一直对 Python/Jython 持怀疑态度，并且一直是 Java 泛型的忠实粉丝（讽刺的是，它减少了打字量，因此如果你愿意，可以将法语“拉丁化”）。我不太了解像 Jython 这样的“动态类型”语言的全部含义，但我认为最好的办法是顺其自然，看看 Jython 对我的想法有什么影响！

语言来来去去很有趣。另一个“拉丁语”可能被认为是具有无限递归语法的 Algol68。但是开发大规模递归代码的需求，以及阅读和思考代码的能力，还没有（还）让人感觉到。Jython*似乎*与我们现在所处的环境非常强大和优雅地契合，它具有 OO 库、Java swing 的强大功能，并且所有东西都封装在一个非常优雅的包中。也许有一天 Jython 也会采用无限递归语法？

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-19T00:11:09.843

I use Jython for *interactive* testing of Java code. This is often much faster than writing Java test applications or even any scripting language. I can just play with the methods and see how it reacts. From there I can learn enough to go and write some real code or test cases.

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-18T21:49:18.843

在某些语言中，某些任务比其他语言更容易。如果我必须解析一些文件，我会选择 Python 而不是 Java。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-18T21:53:36.010

*除非您喜欢*编写（或让您的 IDE 生成）数百行样板代码，否则使用 Python 不仅仅是“语法糖” 。使用动态类型语言时，快速开发技术具有优势，但缺点是它会使您的 API 和集成变得复杂，因为您不再拥有同质的代码库。这也会影响维护，因为不是您团队中的每个人都像您一样喜欢 Python，而且使用它的效率也不高。这可能是个问题。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-18T21:07:59.270

Python 库 ;) 例如[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/) - 一个接受错误标记的 HTML 解析器。AFAIK 没有类似的纯 Java 库。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-18T21:16:18.673

Python 具有函数式编程的一些特性，例如 lambda。Java 没有这样的功能，如果有这样的支持，一些程序会更容易编写。因此，有时用 Python 编写代码并通过 Jython 将其集成以尝试用 Java 编写代码会更容易。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T22:02:50.543

Jython 还可以用作 Java 程序中的嵌入式脚本语言。您可能会发现在某些时候使用内置的扩展语言编写一些东西很有用。如果使用 Java Jython 是一种选择（Groovy 是另一种选择）。

我主要使用 Jython 在 Java 系统上进行探索性编程。我可以导入应用程序的部分内容并查看 API，通过从交互式 Jython 会话调用调用​​来查看发生了什么。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T21:03:28.500

无需编译。也许你想得到比使用编译语言更快的东西，比如原型。

...您可以将 Jython 解释器嵌入到您的应用程序中。不错的功能，我不能说我用过，但还是很酷。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T03:04:43.420

将现有代码移植到新环境可能是原因之一。你的一些业务逻辑和领域功能可能存在于 Python 中，而编写该代码的团队坚持使用 Python。但是部署和维护它的团队可能需要 J2EE 集群的可管理性以实现规模化。您可以将 Jython 中的逻辑包装在 EAR/WAR 中，然后部署组将看到另一个 J2EE 捆绑包像所有其他 J2EE 捆绑包一样进行管理。

即，它是一种处理阻抗失配的方法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T21:02:57.223

语法糖。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T21:04:14.473

在你的情况下，这没有多大意义。但这并不意味着它永远不会。例如，如果您正在开发一种允许最终用户创建扩展或插件的产品，那么可编写脚本可能会很好。

# visual-studio - Visual Studio Import UI Widget 叫什么名字（内图）

> ID：96923
> 
> 赞同：4
> 
> 时间：2008-09-18T21:01:43.730
> 
> 标签：visual-studio

这里圈出的 UI 元素的名称是什么？以及如何使用键盘快捷键访问它？有时几乎不可能让鼠标专注于它。

```
catch (ItemNotFoundException e)
{

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T21:03:08.597

我不知道名称，但快捷键是 CTRL-句点 (.) 和 ALT-SHIFT-F10。方便知道:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T21:03:44.507

它被称为智能标签

# java - 加密 clob 的最佳方法是什么？

> ID：96945
> 
> 赞同：3
> 
> 时间：2008-09-18T21:03:48.080
> 
> 标签：java, oracle, encryption, jdbc, plsql

我正在使用 Oracle 9 和 JDBC，并希望在将 clob 插入数据库时​​对其进行加密。理想情况下，我希望能够插入明文并通过存储过程对其进行加密：

```
String SQL = "INSERT INTO table (ID, VALUE) values (?, encrypt(?))";
PreparedStatement ps = connection.prepareStatement(SQL);
ps.setInt(id);
ps.setString(plaintext);
ps.executeUpdate(); 
```

明文预计不会超过 4000 个字符，但加密会使文本更长。我们当前的加密方法使用 dbms_obfuscation_toolkit.DESEncrypt() 但我们只处理 varchars。下面的工作吗？

```
FUNCTION encrypt(p_clob IN CLOB) RETURN CLOB
IS
    encrypted_string        CLOB;
    v_string                CLOB;
BEGIN
  dbms_lob.createtemporary(encrypted_string, TRUE);
  v_string := p_clob;
  dbms_obfuscation_toolkit.DESEncrypt(
    input_string => v_string,
    key_string => key_string,
    encrypted_string => encrypted_string );
  RETURN UTL_RAW.CAST_TO_RAW(encrypted_string);
END; 
```

我对临时的clob感到困惑；我需要关闭它吗？还是我完全偏离了轨道？

编辑：混淆的目的是防止对数据的琐碎访问。我的另一个目的是以与我们已经混淆 varchar 列相同的方式混淆 clob。oracle 示例代码不处理我的具体问题所在的 clob；加密 varchars（小于 2000 个字符）很简单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T22:03:14.333

Oracle 文档中有一个示例：

[http://download.oracle.com/docs/cd/B10501_01/appdev.920/a96612/d_obtoo2.htm](http://download.oracle.com/docs/cd/B10501_01/appdev.920/a96612/d_obtoo2.htm)

你不需要关闭它

```
DECLARE
   input_string        VARCHAR2(16) := 'tigertigertigert';
   raw_input           RAW(128) := UTL_RAW.CAST_TO_RAW(input_string);
   key_string          VARCHAR2(8)  := 'scottsco';
   raw_key             RAW(128) := UTL_RAW.CAST_TO_RAW(key_string);
   encrypted_raw               RAW(2048);
   encrypted_string            VARCHAR2(2048);
   decrypted_raw               RAW(2048);
   decrypted_string            VARCHAR2(2048); 
   error_in_input_buffer_length EXCEPTION;
   PRAGMA EXCEPTION_INIT(error_in_input_buffer_length, -28232);
   INPUT_BUFFER_LENGTH_ERR_MSG VARCHAR2(100) :=
    '*** DES INPUT BUFFER NOT A MULTIPLE OF 8 BYTES - IGNORING 
EXCEPTION ***';
   double_encrypt_not_permitted EXCEPTION;
   PRAGMA EXCEPTION_INIT(double_encrypt_not_permitted, -28233);
   DOUBLE_ENCRYPTION_ERR_MSG VARCHAR2(100) :=
    '*** CANNOT DOUBLE ENCRYPT DATA - IGNORING EXCEPTION ***';

    -- 1\. Begin testing raw data encryption and decryption
       BEGIN
   dbms_output.put_line('> ========= BEGIN TEST RAW DATA =========');
   dbms_output.put_line('> Raw input                        : ' || 
             UTL_RAW.CAST_TO_VARCHAR2(raw_input));
   BEGIN 
      dbms_obfuscation_toolkit.DESEncrypt(input => raw_input, 
               key => raw_key, encrypted_data => encrypted_raw );
      dbms_output.put_line('> encrypted hex value              : ' || 
           rawtohex(encrypted_raw));
  dbms_obfuscation_toolkit.DESDecrypt(input => encrypted_raw, 
           key => raw_key, decrypted_data => decrypted_raw);
  dbms_output.put_line('> Decrypted raw output             : ' || 
                UTL_RAW.CAST_TO_VARCHAR2(decrypted_raw));
  dbms_output.put_line('>  ');      
  if UTL_RAW.CAST_TO_VARCHAR2(raw_input) = 
                UTL_RAW.CAST_TO_VARCHAR2(decrypted_raw) THEN
     dbms_output.put_line('> Raw DES Encyption and Decryption successful');
  END if;
   EXCEPTION
      WHEN error_in_input_buffer_length THEN
             dbms_output.put_line('> ' || INPUT_BUFFER_LENGTH_ERR_MSG);
   END;
   dbms_output.put_line('>  '); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T09:25:29.280

有点题外话：首先加密/混淆有什​​么意义？有权访问您的数据库的攻击者将能够获得明文——找到上述存储过程将使攻击者能够执行解密。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T05:21:41.983

我注意到您使用的是 Oracle 9，但只是为了记录在 Oracle 10g+ 中，dbms_obfuscation_toolkit 已被弃用，取而代之的是 dbms_crypto。

[dbms_crypto](http://68.142.116.68/docs/cd/B28359_01/appdev.111/b28419/d_crypto.htm#i1005082)确实包含 CLOB 支持：

```
DBMS_CRYPTO.ENCRYPT(
   dst IN OUT NOCOPY BLOB,
   src IN            CLOB         CHARACTER SET ANY_CS,
   typ IN            PLS_INTEGER,
   key IN            RAW,
       iv  IN            RAW          DEFAULT NULL);

DBMS_CRYPT.DECRYPT(
   dst IN OUT NOCOPY CLOB         CHARACTER SET ANY_CS,
   src IN            BLOB,
   typ IN            PLS_INTEGER,
   key IN            RAW,
   iv  IN            RAW          DEFAULT NULL); 
```

# mysql - 如何从mysql函数中的字母数字文本中修剪前导零

> ID：96952
> 
> 赞同：76
> 
> 时间：2008-09-18T21:04:11.697
> 
> 标签：mysql

有哪些 mysql 函数（如果有）可以从字母数字文本字段中修剪前导零？

值为“00345ABC”的字段需要返回“345ABC”。

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2008-09-18T21:06:01.770

您正在寻找[trim() 函数](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_trim)。

好的，这是你的例子

```
SELECT TRIM(LEADING '0' FROM myfield) FROM table 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-01-04T12:13:17.950

提示：

如果您的值是纯数字的，您也可以使用简单的转换，例如

```
SELECT * FROM my_table WHERE accountid = '00322994' * 1 
```

实际上会转换成

```
SELECT * FROM my_table WHERE accountid = 322994 
```

这在许多情况下是足够的解决方案，而且我相信性能更有效。（警告 - 值类型从 STRING 更改为 INT/FLOAT）。

在某些情况下，使用一些强制转换功能可能也是一种方法：

[http://dev.mysql.com/doc/refman/5.0/en/cast-functions.html](http://dev.mysql.com/doc/refman/5.0/en/cast-functions.html)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2016-02-02T04:19:16.757

如果要更新表的一整列，可以使用

```
USE database_name;
UPDATE `table_name` SET `field` = TRIM(LEADING '0' FROM `field`) WHERE `field` LIKE '0%'; 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-18T21:08:22.623

我相信你最好这样做：

```
SELECT TRIM(LEADING '0' FROM myField) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-08-07T21:55:48.883

简直完美：

```
SELECT TRIM(LEADING '0' FROM myfield) FROM table 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-05-31T07:50:59.510

只需删除`TRIM ( LEADING` 使用之间的空间

```
SELECT * FROM my_table WHERE TRIM(LEADING '0' FROM accountid ) = '00322994' 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-12-05T17:54:04.593

TRIM 将允许您删除尾随、前导或所有字符。MySQL中使用TRIM函数的一些例子：

```
select trim(myfield) from (select '   test' myfield) t;
>> 'test'
select trim('0' from myfield) from (select '000000123000' myfield) t;
>> '123'
select trim(both '0' from myfield) from (select '000000123000' myfield) t;
>> '123'
select trim(leading '0' from myfield) from (select '000000123000' myfield) t;
>> '123000'
select trim(trailing '0' from myfield) from (select '000000123000' myfield) t;
>> '000000123' 
```

如果您只想删除选定数量的前导/尾随字符，请查看 LEFT/RIGHT 函数，以及 LEN 和 INSTR 函数的组合

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-03-02T07:11:52.253

```
SELECT TRIM(LEADING '0' FROM *columnName*) FROM *tableName* ; 
```

这也可以正常工作

# vb.net - IE 自动化书籍或资源？使用 MSHTML/ShDocVw VB.Net

> ID：96979
> 
> 赞同：-1
> 
> 时间：2008-09-18T21:06:43.767
> 
> 标签：vb.net, internet-explorer, automation, mshtml, shdocvw

任何人都可以推荐一本书或一个网站来解释使用 VB.NET 的 Internet Explorer 自动化吗？我知道 mshtml 和 ShDocVw.dll 可以做到这一点，但我需要一个资源来向我解释。我想读/写值以及单击按钮。

到目前为止，我遇到的唯一一本书是 .Net Test Automation Recipes。这是给我的吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T21:17:41.353

如果您想要一些在自动化 IE 方面深入的源代码，您可以查看[WatiN 。](http://watin.sourceforge.net/index.html)事实上，它可能会做你想做的事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T14:05:29.773

我所知道的唯一一本专门针对 IE COM 级别的主题的书是 Nikit Zykov 的数字 Wrox 出版物[Introduction to Programming Internet Explorer in C#](http://www.certificationworks.com/books/B00007FYZP.htm)。尽管示例是用 C# 编写的，但内容对 VB.NET 程序员同样有用。但正如已经提到的，您可能最好使用更简单的 IE COM 包装器 API 之一，例如[WatiN](http://watin.sourceforge.net)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T15:42:15.533

查看这篇文章：Internet Explorer 后期绑定自动化 Internet Explorer 自动化示例代码使用后期绑定，没有 Microsoft.mshtml 和 shdocvw 依赖项。

[http://www.codeproject.com/KB/cs/IELateBindingAutowod.aspx](http://www.codeproject.com/KB/cs/IELateBindingAutowod.aspx)

# jakarta-ee - 支持 Java EE 应用程序服务器的主机控制面板？

> ID：96982
> 
> 赞同：3
> 
> 时间：2008-09-18T21:07:04.500
> 
> 标签：jakarta-ee, hosting, controlpanel

我的服务器上目前有 WHM/cPanel，但它没有与任何 Java EE 应用服务器正确集成。我手动安装了 Tomcat，并通过 Apache 使其工作，但配置比我想要的更脆弱。

因此，我试图找到一个可以正确集成和管理 Java EE App Server 的替代品。

要求：

*   开源/自由软件（即非专有）
*   在 CentOS 上运行（尽管必要时可以选择 Debian/Fedora Core/FreeBSD）
*   支持 Apache + Tomcat（或同等产品）
*   自我监控（例如，如果 MySQL 发生故障，它会自动重新启动）
*   用户帐户管理（轻松设置、限制空间和带宽配额等）
*   友好的最终用户控制面板（用于配置数据库、邮件、统计信息、日志等）
*   任何明显的东西我都忘记了。

是否有任何推荐的软件包可以完成所有这些工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T05:06:14.873

[Plesk](http://www.parallels.com/products/plesk/)是一个类似于 CPanel 的商业主机管理套件，实际上大多数提供 WHM/CPanel 的主机提供商也提供 Plesk，它内置了对 Tomcat 的支持。Plesk 在 CentOS 上原生运行，但只能在一个域上免费使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T11:25:16.837

我们在工作中使用[Apache Geronimo](http://geronimo.apache.org/)已经有两年了，它一直坚如磐石。它有自己的内置控制面板，允许我们分别部署/启动/停止每个应用程序。你可能想试一试。

# .net - 使用 SQLExpress 进行多用户商业应用程序的经验？

> ID：96997
> 
> 赞同：3
> 
> 时间：2008-09-18T21:08:41.717
> 
> 标签：.net, sql-server, installation, user-experience

我继承了我们多年来开发和销售的 VB6/Access 应用程序。我们将使用 SQL Server 2005 Express Edition 和 .Net。

该应用程序可以是多用户的。目前，客户的设置很简单——导航到文件夹以在首次启动时创建数据库；第二个用户浏览到同一个文件。

如果我们使用 SQLExpress，我相信我们的应用程序需要更多的参与才能在服务器上配置 SQLExpress。但我认为我们将获得更好的安全性，并且（无需更改代码）为大客户提供 SQL 版本。

从安装和技术支持的角度来看，我如何才能创造最佳的客户体验？你遇到了哪些问题？哪些安装程序有效？

您是否为服务器/客户端设置了单独的安装，或者只是提供了良好的说明？客户在第一次尝试时会犯什么错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T22:00:56.430

Visual Studio 中的部署项目允许您轻松安装 SQL Server Express 实例。

我们的应用程序有相同的场景，这意味着您确实需要单独安装客户端和服务器。

我们的服务器安装处理安装新的 SQL Server 或在必要时升级现有安装的架构。客户端安装只是将客户端所需的文件打包。您必须考虑升级数据库架构并确保客户端具有适用于新架构的更新客户端版本的场景。我们通过以下简单方式实现这一目标：

在数据库中存储版本 ID，例如 1.0.1 更新客户端应用程序的 AssemblyInfo.cs 并确保程序集版本与存储在数据库中的版本匹配。如果没有，它会提示用户安装新版本。

为了获得最佳用户体验，您希望能够安装新的服务器版本并让所有客户端自动更新。我们有一种方法可以做到这一点，如果需要，我可以为您提供更多详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T21:13:35.653

有多少用户和多少数据？

我不知道是否有关于 SQL Express 2005 有多少用户“太多”的一般准则，但硬数据限制为 4GB。我的猜测是，您不会因为 Access 遗产而受到影响，但知道这将是一件好事。

您可以自动安装 SQL Express。我已经看到它完成了，因为我妻子安装的东西做到了，她是我怀疑安装它的最后一个人。

还有我认为面向 .NET 3.5 和 Windows Mobile的[SQL Server Compact Edition 。](http://en.wikipedia.org/wiki/SQL_Server_Compact)我相信它更类似于 Access 中的“单文件数据库”位。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T21:50:26.953

我建议走 SQL Express 路线并将其包含在安装包中。安装程序有很多命令行选项，您可以使用 SQL 脚本对数据库进行任何安装后配置（即启用/禁用 CLR 集成、OpenRowset 和其他功能）。

此外，它比旧的 MSDE 2000 安装更稳定；我做噩梦支持这一点。我还发现 100 次中有 99 次设置默认的数据库安装参数会让人们感到高兴。

[SQL Express 博客](http://blogs.msdn.com/sqlexpress/archive/2006/09/20/configuring-sql-express-during-installation.aspx)

[如何从命令提示符安装 SQL 2008](http://msdn.microsoft.com/en-us/library/ms144259.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T21:15:24.727

SQL Express 在功能和可靠性方面将比 Access 迈出一大步。它不应该需要任何更多的配置，只要你知道你在做什么，就需要一种不同的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T22:06:53.607

在我的公司，我们经常使用它。在较慢的机器上启动时间慢有一些问题。

安装体验并不完美 - 有一个实用程序可以恢复应用程序用作数据库模板的数据库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T21:11:38.730

由于您仍在考虑使用 SQLExpress，您的团队是否考虑过[SQLite](http://www.sqlite.org/)？您仍然可以拥有所需的数据库功能，而无需在客户端系统上安装引擎。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T21:11:59.947

SQL Server 2005 Express Edition 可以使用任何合适的安装程序轻松安装。几个小时的工作就足够了！如果您一心一意，请不要让安装的恐惧阻碍您。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T23:18:57.567

另一种选择：我相信您也可以在“文件模式”中使用 SQL Server Express，您只需指向 MDF 文件，而不必运行 SQL Server 实例。这与听起来您当前的应用程序使用 Access 的方式非常相似。我不确定这在多用户情况下如何工作，但可能需要调查。*