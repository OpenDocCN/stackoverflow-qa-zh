# StackOverflow 问答 11692000-11692999

# html - 向左增长一个div

> ID：11692008
> 
> 赞同：0
> 
> 时间：2012-07-27T16:35:33.610
> 
> 标签：html, css

这甚至可能吗？基本设置是右侧的侧边栏，其中包含 div 元素。单击这些元素之一将添加一个“弹出” div，该 div 应显示在单击元素的左侧。弹出窗口包含可变数量的按钮。我想只使用 CSS 来设置它的样式，所以我可以从我的脚本中添加正确的 HTML 元素并让样式表进行布局。

*   我已经在侧边栏元素内尝试了弹出窗口，绝对定位，但是我不能使侧边栏元素本身缩放到至少与弹出窗口一样高。（侧边栏元素的高度通常比弹出窗口短）。
*   我尝试将弹出窗口放在元素之前，并使用绝对位置，但由于某种原因，如果我添加更多按钮，弹出窗口不会变宽，而是向下溢出它们。
*   在弹出窗口上使用相对位置将使其在侧边栏中留下空白空间。
*   浮动它会弄乱其他侧边栏元素的宽度。

侧边栏是固定宽度。弹出窗口是固定高度的。按钮是固定大小的。侧边栏元素是全宽但高度可变的。

我已经忘记了我尝试过的所有不同的事情。我目前最接近的尝试是在这个[JsFiddle](http://jsfiddle.net/cUceH/2/)中，弹出窗口的位置正确，但不会向左增长，只会向下溢出。如果我将宽度设置为较大的数字，它将正确排列按钮，但如果我添加一个 :hover 伪类，则会发生奇怪的事情。

这怎么能在 HTML/CSS 中完成？还是只能使用 JavaScript？如果是这样，这样做的简单“偏僻”方法可能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:06:58.303

添加`white-space:nowrap;`到`div.popout`.

这将防止按钮之间的换行。

# php - 使用带有 PDO 的类

> ID：11692012
> 
> 赞同：-1
> 
> 时间：2012-07-27T16:35:52.683
> 
> 标签：php, class, pdo

我决定在这里推荐后使用 PDO，我在下面找到了这段代码。这些代码足以防止 SQL 注入？上课是更好的选择吗？

```
<?
class database {

private $hostname;
private $database;
private $username;
private $password;
private $pdo;
function __construct($hostname, $database, $username, $password) {

$this->pdo = new PDO("mysql:host={$this->hostname};port={$this->port};dbname={$this->database}", $this->username, $this->password, array(PDO::ATTR_PERSISTENT => true));

} catch(PDOException $e) {

print "<b>Error - Connection Failed: </b>" . $e->getMessage() . "<br/>";
die();
}
}

public function query($query, $bind = null) {
global $pdo;

$this->statement = $this->pdo->prepare($query);
$this->statement->execute($bind);
}

$date = date("Y-m-d H:i:s", time());

$database->query('INSERT INTO users_inactive(verCode, username, password, email, date) VALUES (?, ?, ?, ?, ?)', array($verCode, $username, $password, $email, $date));

$success[] = "You account has been created!";

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T16:39:42.550

此代码包含语法错误、速记和全局变量。不，它不够好用。

# mysql - mysql查询统计上一年日期的记录

> ID：11692013
> 
> 赞同：2
> 
> 时间：2012-07-27T16:36:01.530
> 
> 标签：mysql, count

我有一个包含这些字段的表

```
id    sell_date   
a1    27/7/2012
a1    26/7/2012
a1    24/7/2012
a1    24/2/2012 
```

我想要计算当前日期前一年内销售的月份。结果

`a1 = 2`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T16:44:52.263

假设 sell_date 是 DATE 类型：

```
SELECT COUNT(DISTINCT MONTH(sell_date)) FROM `mytable` 
    WHERE id='a1' 
    AND sell_date>=DATE_SUB(NOW(),INTERVAL 1 YEAR); 
```

还，

删除`id='a1' AND`将为您提供与任何 id 关联的销售额（在去年期间）的月数。像这样：

```
SELECT COUNT(DISTINCT MONTH(sell_date)) FROM `mytable` 
    WHERE sell_date>=DATE_SUB(NOW(),INTERVAL 1 YEAR); 
```

还，

您可以获得每个 id 的列表以及去年与该 id 关联的销售额的月数，如下所示：

```
SELECT COUNT(DISTINCT id,MONTH(sell_date)) FROM `mytable` 
    WHERE sell_date>=DATE_SUB(NOW(),INTERVAL 1 YEAR); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T16:42:15.357

您需要 datediff() 函数：

```
select count(id) as N 
from table_name
where datediff(curdate(), sell_date) >= 365; 
```

[http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_datediff](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_datediff) [http://dev.mysql.com/doc/refman/5.1/en/date-and -time-functions.html#function_curdate](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_curdate)

# javascript - 有没有一种简单的方法可以将 ExtJS 4 MVC 应用程序转换为 ExtJS DeftJS MVC？

> ID：11692019
> 
> 赞同：1
> 
> 时间：2012-07-27T16:36:17.253
> 
> 标签：javascript, extjs, extjs4, extjs-mvc

我正在寻找一种简单的方法来将已经使用基于 ExtJS 4 MVC 架构的 ExtJS 应用程序转换为使用[DeftJS](http://deftjs.org/)的 ExtJS 应用程序，以便利用该框架提供的依赖注入的好处。

在 ExtJS MVC 中，我们有一个控制器，但有多个与之关联的视图。然而 DeftJS 建议使用 ViewController 概念，即每个视图一个控制器。这是过渡的主要问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-13T18:42:20.010

应用程序中的每个视图都不一定需要 Deft JS 中的专用 ViewController。在许多情况下，单个 ViewController 可以管理一组视图。在您的情况下，即使您只有一个控制器，您仍然可以将您的应用程序转换为 Deft JS 应用程序。首先，从您的 Application.js 文件开始，并添加注入配置。然后，编辑您的控制器以使其成为 ViewController。根据您的应用程序的大小，可能需要一些时间，特别是对于组件事件处理程序，但您会到达那里。Phoenix 是一款出色的参考应用程序，可以回答您的大部分问题：

[https://github.com/deftjs/Examples/tree/master/phoenix-example-app](https://github.com/deftjs/Examples/tree/master/phoenix-example-app)

如果您想使用 Sencha Cmd，请改用以下示例：

[https://github.com/deftjs/Examples/tree/master/phoenix-cmd](https://github.com/deftjs/Examples/tree/master/phoenix-cmd)

# clickonce - Clickonce 部署 - 如何进行部分更新

> ID：11692021
> 
> 赞同：1
> 
> 时间：2012-07-27T16:36:21.270
> 
> 标签：clickonce, partial

这是我认为很简单的问题，但花了几个小时后我无法解决。

我有一个 .NET 应用程序，并已使用 Clickonce 发布选项 Visual Studio 2010 将其部署到网络共享。

在客户端计算机上成功安装了应用程序。

现在我不得不在我的应用程序中更改一个文件。我替换了“Application Files”文件夹中的文件，使用 Mage UI 更新了 app.exe.maifest 文件。（验证修改后的文件的哈希值已更改）。

现在更新了 .application 文件，以便由于 app.exe.manifest 文件中的更改而重新创建其中的哈希。

但是当我在客户端上启动应用程序时，它无法识别更新。

我不知道为什么应用程序没有更新。

非常感谢任何想法/指针的帮助。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T07:39:47.430

要创建更新，您需要增加版本号并将新版本发布到与原始部署相同的文件夹。

# ajax - Magento 添加到购物车 ajax 按钮不适用于安全（https）购物车

> ID：11692029
> 
> 赞同：0
> 
> 时间：2012-07-27T16:36:42.097
> 
> 标签：ajax, magento, jquery, https

我在我们的 magento 中启用了安全购物车。之后，添加到购物车按钮不起作用。我的主题有自定义 ajax 添加到购物车按钮。然后我在我的模板 js 代码中添加了以下代码并开始工作的产品列表页面的添加到购物车按钮。但是，我无法弄清楚我应该如何更改产品视图（详细信息）页面的添加到购物车按钮代码，因为它也不起作用。我需要它们和我的安全购物车。我的产品详细信息页面在 http 协议下。如果我使用 https 手动输入产品详细信息页面，则添加到购物车按钮有效。但是，我需要它在 http 产品详细信息页面下工作，并与安全购物车页面一起工作。我应该如何更改 javascript 代码或任何其他代码？

我的代码

```
 if (window.location.protocol == "https:") {
        url=url;    
        }else{
        url=url.replace("https://","http://");  
        } 
```

我的主题：[http ://demo.galathemes.com/#gala-gearbox](http://demo.galathemes.com/#gala-gearbox)

这是完成这项工作的主题 javascript 代码：

```
var test;            
Event.observe(window, 'load', function () {
    var containerDiv = $('containerDiv');
    if(containerDiv)
        test = new LightboxAJC(containerDiv);
}); 
function cart_form(url)
{    
    data    =    $('product_addtocart_form').serialize();
    ajax_add(url,data);
}

function ajax_add(url,param)
    {

        tam        =    url.search("checkout/");
        tam2    =    url.search("product/");
        str1    =    url.substr(0,tam)+'ajaxcart/index/add/';
        str2    =    url.substr(tam2,url.length);
        link    =    str1+str2;
        var check = url.search("options");        
        if(check > 0){
            window.location.href = url;
        }
        else{
            var tmp        =    url.search("in_cart");
            test.open();
            new Ajax.Request(link, {
                parameters:param,
                onSuccess: function(data) {
                    if(tmp > 0 ) {
                        var host    =    find_host(url);
                        window.location.href = host+'index.php/checkout/cart/';
                    }
                    else{
                        //result    =    data.responseText;alert(result);                
                        $('ajax_content').innerHTML = data.responseText;

                        if($('ajax_content').down('.top-link-cart')){
                            var count_cart = $('ajax_content').down('.top-link-cart').innerHTML;                                
                            $$('.top-link-cart').each(function (el){
                                el.innerHTML = count_cart;
                            });
                        }

                        if($('ajax_content').down('.block-cart')){
                            var ajax_product = $('ajax_content').down('.block-cart').innerHTML;    
                            $$('.block-cart').each(function (el){
                               el.innerHTML = ajax_product;            
                            });
                        }

                        if($('ajax_content').down('.col-main')){
                            var ajax_result = $('ajax_content').down('.col-main').innerHTML;                
                            $$('.ajaxcart_row1').each(function (el){
                               el.innerHTML = ajax_result;            
                            });
                        }

                        $('ajax_loading').hide();
                        $('ajaxcart_conent').show();
                        Event.observe('closeLink', 'click', function () {                    
                            test.close();
                            $$('.ajaxcart_row1').each(function (el){
                               el.innerHTML = '';            
                            });
                            $('ajax_loading').show();
                        });    
                    }
                }
            });
        }
    }

function setLocation(url){
    if (window.location.protocol == "https:") {
    url=url;    
    }else{
    url=url.replace("https://","http://");     
    }

    var tam        =    url.search("checkout/cart/");
    if(tam > 0)    ajax_add(url);    
    else    window.location.href = url;
}    

document.observe("dom:loaded", function() {

    var cartInt = setInterval(function(){
        if (typeof productAddToCartForm != 'undefined'){

            if(test){
                var tam    =    $('product_addtocart_form').serialize();
                var check = tam.search("ajaxcart");        
                if(check < 0){                        
                    productAddToCartForm.submit = function(url){
                        if(this.validator && this.validator.validate()){                                        
                            cart_form($('product_addtocart_form').readAttribute('action'));
                            clearInterval(cartInt);
                        }
                        return false;
                    }
                }
            }
        } else {
            clearInterval(cartInt);
        }
    },500);

}); 

function find_host(url)
{
    var tmp        =    url.search("index.php");
    var str        =    url.substr(0,tmp)
    return str;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T14:38:31.240

这是适用于所有页面的解决方案！很简单。。

```
if (window.location.protocol == "http:") {
url=url.replace("https://","http://");      
} 
```

# flot - Flot 在时间模式下不会随 xaxis 缩放

> ID：11692031
> 
> 赞同：0
> 
> 时间：2012-07-27T16:36:46.293
> 
> 标签：flot, zooming, mode

在我将 xaxis 更改为模式：“时间”之前，我的图表放大得很好。现在我不能缩放。该图呈现并看起来不错，但不缩放。FLOT 是否支持缩放基于时间的图表？谢谢

$（函数（）{

var line1_data = [[1309507200000,82], [1310112000000,76], [1310976000000,71], [1311235200000,76], [1311753600000,82]]; var line2_data = [[1309507200000,60], [1310112000000,40], [1311235200000,60], [1311753600000,80], [1318233600000,60]];

var 数据 = [line1_data, line2_data];

```
var placeholder2 = $("#placeholder2");
var options = {
    series: { lines: { show: true }, shadowSize: 0  },
    xaxis:  { mode: "time", zoomRange: [0.1, 10]    },
    yaxis:  { zoomRange: [0.1, 10]                  },
    zoom:   { interactive: true }
};

var plot = $.plot(placeholder2, data, options); 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T13:22:26.137

我不确定，但我认为它可能与您的 zoomRange 有关

> “zoomRange”是可以发生缩放的间隔，例如使用 zoomRange: [1, 100] 缩放将永远不会缩放轴，因此 min 和 max 之间的差异小于 1 或大于 100。您可以设置他们为 null 以忽略。

并且在您的数据中，您需要选择图表的一小部分以使差异小于 10

但正如我所说，我可能是错的，我从来没有做过基于时间的图表

# wpf - 列表框项上的按钮

> ID：11692033
> 
> 赞同：0
> 
> 时间：2012-07-27T16:36:51.037
> 
> 标签：wpf, listbox, richtextbox

我有一个装满项目的 ListBox。一些项目可能在 RichTextBlock 内部有按钮或链接。我想在按下项目或按下按钮时触发不同的动作。问题是当我按下按钮时，与项目本身相关的动作也会被触发。当按下内部按钮时，如何防止触发列表项事件？

列表框：

```
<ListBox x:Name="StripesList" SelectionChanged="StripesList_SelectionChanged">
</ListBox> 
```

列表框项目：

```
<Border x:Name="OuterBorder" Width="400">
    <Image x:Name="ThumbnailBox" Width="100" Source="{Binding Thumbnail}" Tap="ThumbnailClick" />
</Border> 
```

代码：

```
private void StripesList_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    if (StripesList != null)
    {
        StripesList.SelectedIndex = -1;
    }
}

private void ThumbnailClick(object sender, System.Windows.Input.GestureEventArgs e)
{
    Image image = sender as Image;
    // handle image click
}

private void ItemClick(object sender, EventArgs e)
{
    // handle item click
} 
```

我从后面的代码注册项目点击事件观察者：

```
item.Tap += new EventHandler(ItemClick); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:05:08.390

在所有事件的处理程序中设置 e.Handled=true 。它将停止事件的冒泡。

# jquery - jquery - 实时拦截、计算和显示列表框选项

> ID：11692042
> 
> 赞同：0
> 
> 时间：2012-07-27T16:37:23.830
> 
> 标签：jquery, listbox, real-time, intercept

我有一个简单而基本的 jquery 函数，用于计算某些产品的数量 * 单价 + 税款和小计，然后是总数。我希望根据用户在列表框中的选择，使用 jquery 实时显示不同税率的税收进口。我找到了一种适用于 2 种产品的基本方法，但对于 3 种或多种产品，我的方法不起作用：请帮帮我？;)

这是我的代码：演示是 [这里] [http://jsfiddle.net/skipperit/px9tb/8/](http://jsfiddle.net/skipperit/px9tb/8/)

```
<script type='text/javascript'> 
$(function(){
$('#q1,#pu1,#tax1,#tax2,#q2,#pu2').change(function() {
var q1 = parseFloat($('#q1').val(), 10);
var qval1 = 0;
if (q1 > 0) {
    qval1 = q1;
}
var q2 = parseFloat($('#q2').val(), 10);
var qval2 = 0;
if (q2 > 0) {
    qval2 = q2;
}

var pu1 = parseFloat($('#pu1').val(), 10);
var puval1 = 0;
if (pu1 > 0) {
    puval1 = pu1;
}

var pu2 = parseFloat($('#pu2').val(), 10);

var puval2 = 0;
if (pu2 > 0) {
    puval2 = pu2;
}

var subtot1 = 0;
subtot1 =  parseFloat(qval1 * puval1);
var subtot2 = 0;
subtot2 =  parseFloat(qval2 * puval2);
var subtot = 0;
subtot = subtot1 + subtot2;
var tax1 = parseFloat($('#tax1').val(), 10);
var tax2 = parseFloat($('#tax2').val(), 10);
var ivaprice1 = 0;
var ivaprice2 = 0;
if (tax1 > 0) {

    ivaprice1 = subtot1 * tax1 / 100;
}
if (tax2 > 0) {

    ivaprice2 = subtot2 * tax2 / 100;
}
 var ivaprice = 0;
 ivaprice = parseFloat(ivaprice1 + ivaprice2);
var ivatext = "";
ivatext = "tax ";

$('#total').html(parseFloat(subtot + ivaprice).toFixed(2));
$('#tasse').html(parseFloat(ivaprice).toFixed(2));
$('#imp').html(parseFloat(subtot).toFixed(2));
$('#subtot1b').html(parseFloat(subtot1).toFixed(2));
$('#subtot2b').html(parseFloat(subtot2).toFixed(2));

if (tax2 == tax1) {
    $('#taxw').html(parseInt(tax1));
    $('#taxtxt2').html('');
    $('#taxw2').html('');
    $('#taxv').html(parseFloat(ivaprice).toFixed(2));
    $('#taxv2').html('');
    $('#taxtxt2b').html('');
}
else
{
    $('#taxw').html(parseInt(tax1));
    $('#taxw2').html(parseInt(tax2));
    $('#taxtxt2').html('tax');
    $('#taxtxt2b').html('%:');
    $('#taxv').html(parseFloat(ivaprice1).toFixed(2));
    $('#taxv2').html(parseFloat(ivaprice2).toFixed(2));
 }

});
});  

</script>

</head>
<body>
<p>q1 : 
<input id="q1" value="0"/>

pu1 :
<input id="pu1" value="0"/> 
tax1:
<select name="tax1" id="tax1">
<option value="4">4</option>
<option value="21">21</option>
<option value="16">16</option>
</select>
</p>
<p>q2 :
<input id="q2" value="0"/>
pu2 :
<input id="pu2" value="0"/>
tax2 :
 <select name="tax2" id="tax2">
<option value="4">4</option>
<option value="21">21</option>
<option value="16">16</option>
 </select>
 <br>
<br>subtot1: <span id="subtot1b"></span><br>
 subtot2: <span id="subtot2b"></span><br>
tax <span id="taxw"></span>%: <span id="taxv"></span><br>
<span id="taxtxt2"></span> <span id="taxw2"></span><span id="taxtxt2b"></span>    <span    id="taxv2"></span><br>

 taxable: €&lt;span id="imp"></span><br>
 Tax: €&lt;span id="tasse"></span><br>
 Total price : €&lt;span id="total"></span></p>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T18:20:13.747

[**在这里演示**](http://jsfiddle.net/WpN6S/)

**html:**

```
​&lt;div id="uguu" data-row="5"></div>​​​​​​​​​​​​​​​​​​​​​​​​ 
```

**js：**

```
$(function() {
    (function($) {
        $.fn.extend({
            autobotTransform: function() {
                return this.each(function() {
                    // variables
                    var _this = $(this);
                    var prodCount = _this.attr("data-row");
                    var _opt = '<option value="4">4</option><option value="21">21</option><option value="16">16</option>';

                    // set-up
                    for (i = 1; i <= prodCount; i++) {
                        _this.append('<p class="priceRow">q' + i + ' :<input id="q' + i + '" value="0" />' +
                                     'pu' + i + ' :<input id="pu' + i + '" value="0" />' +
                                     'tax' + i + ':<select name="tax' + i + '" id="tax' + i + '">' +
                                     _opt + '</select>'
                                    );
                    }
                    for (i = 1; i <= prodCount; i++) {
                        _this.append('subtot' + i + ': <span id="subtot' + i +'"></span> ' +
                                     'tax <span id="taxw' + i + '"></span>%: <span id="taxv' +
                                     i + '"></span><br>'
                                    );
                    }
                    $("input, select", _this).on("change", function() {
                        $('p.priceRow').each(function(index) {
                            var __this = $(this);
                            var i = index + 1;
                            $("#subtot" + i).html(
                                ((($("#q" + i).val() > 0) ? parseFloat($("#q" + i).val(), 10) : 0.00)
                                * (($("#pu" + i).val() > 0) ? parseFloat($("#pu" + i).val(), 10) : 0.00)).toFixed(2)
                            );
                            $("#taxw" + i).html($("#tax" + i).val());
                            $("#taxv" + i).html(($("#subtot" + i).html() * $("#tax" + i).val() * 0.01).toFixed(2));
                        });
                    }).trigger("change");
                });
            }
        });
    })(jQuery);

    $("#uguu").autobotTransform();​
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:04:37.840

这不是一个完整的答案，因为那里有太多我不理解的变量名。希望它会有一些用处。

**第 1 步：**向任何字段添加一个类，该类在更改时应触发重新计算。这将使您能够为所有这些创建一个 jQuery 选择器，例如：

```
<input id="q1" value="0" class="change-trigger" /> 
```

和

```
$('.change-trigger').change(function() { ... }); 
```

**第 2 步：**您似乎需要重新计算任何更改的所有内容，您可以尝试将相关字段中的值读取到对象中，并将对象存储在数组中，例如（在上面的处理函数内部）：

```
var allValues = [];
$('.change-trigger').each(function(idx) // do something with all .change-trigger elements
{
    var values = {};
    values.q = Math.max(0, parseFloat($('#q' + idx).val(), 10));
    values.pu = Math.max(0, parseFloat($('#pu' + idx).val(), 10));
    values.tax = Math.max(0, parseFloat($('#tax' + idx).val(), 10));
    values.pretaxtotal = values.q * values.pu;
    values.taxtotal = (values.pretaxtotal * values.tax) / 100;
    values.linetotal = values.pretaxtotal + values.taxtotal;

    allValues[idx] = values;
}

// later calculations using a loop over the allValues array, e.g.
var taxBandTotals = [], lowTax = 100.0, highTax = 0.0, taxIndex;
for (var i = 0; i < allValues.length; i+=1)
{
    // sum up each tax band by adding to index [tax%] in array
    if (allValues[i].tax > 0)
    {
        lowTax = Math.min(lowTax, allValues[i].tax);
        highTax = Math.max(highTax, allValues[i].tax);
        taxIndex = parseInt(allValues[i].tax, 10);

        // initialise to 0

        if (taxBandTotals[taxIndex] === undefined)
        { taxBandTotals[taxIndex] = 0; }

        // add this entry's tax to the right slot
        taxBandTotals[taxIndex] += allValues[i].taxtotal;

    }

    // aggregate values into totals etc.
    // could play with loop variable to look ahead/behind for
    // comparison with other tax values?
}

for (var j = parseInt(lowTax, 10); j <= parseInt(highTax, 10); j+=1)
{
    if (taxBandTotals[j] !== undefined)
    {
        // this is a total for tax % "j"
    }
} 
```

**第3步：**删除这些`CDATA`东西，不再需要了:)

# javascript - fltr2 目标容器必须在

> ID：11692045
> 
> 赞同：1
> 
> 时间：2012-07-27T16:37:41.180
> 
> 标签：javascript, html, cordova, flotr

我试图让 flotr2 图表在我的 Phonegap 应用程序中工作。我可以让他们的示例图（http://www.humblesoftware.com/flotr2/documentation#usage）在 AVD 上运行，但是如果我尝试在我的实际应用程序中使用它，它会给我错误 Uncaught The target container must在 file:///android_asset/www/flotr2.min.js:27 上可见 我将如何解决这个问题？

与 fltr2 相关的代码：

```
//Flotr2 style contained in head below other styles
<style type="text/css">
    body {
        margin: 0px;
        padding: 0px;
    }
    #container {
        width : 600px;
        height: 384px;
        margin: 8px auto;
    }
</style>
//Accidentally changing </style> to </script> causes the graph to display
//but everything else is wrong, as can be expected 
```

和：

```
//Page meant to contain graph; in body
<!-- Graphs -->
    <div data-role="page" data-theme="a" id="page21">
        <div data-theme="a" data-role="header">
            <h3>
                Graphs
            </h3>
            <a data-role="button" data-direction="reverse" data-transition="slide" href="#page15" data-icon="arrow-l" data-iconpos="left" class="ui-btn-left">
                Back
            </a>
        </div>
        <div data-role="content" style="padding: 15px">
            <div id="container"></div>
                <script type="text/javascript" src="flotr2.min.js"></script>
                <script type="text/javascript">
                (function () {

                    var
                        container = document.getElementById('container'),
                        start = (new Date).getTime(),
                        data, graph, offset, i;

                    // Draw a sine curve at time t
                    function animate (t) {

                        data = [];
                        offset = 2 * Math.PI * (t - start) / 10000;

                        // Sample the sine function
                        for (i = 0; i < 4 * Math.PI; i += 0.2) {
                            data.push([i, Math.sin(i - offset)]);
                        }

                        // Draw Graph
                        graph = Flotr.draw(container, [ data ], {
                            yaxis : {
                                max : 2,
                                min : -2
                            }
                        });

                        // Animate
                        setTimeout(function () {
                            animate((new Date).getTime());
                        }, 50);
                    }

                    animate(start);
                })();
            </script>
        </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T16:47:01.993

通过阅读 flotr2 的源代码，您可以看到在这种情况下 el. [clientWidth](http://help.dottoro.com/ljmclkbi.php)由于某种原因未定义。flotr2 似乎依赖于该属性。没有看到任何其他代码，很难说为什么会发生这种情况。

## 编辑：

由于您使用的是 PhoneGap，因此您可以尝试装配代码以使用[deviceready](http://docs.phonegap.com/en/1.0.0/phonegap_events_events.md.html)并查看是否有帮助。由于尚未设置（尚未加载 CSS 等），可能缺少 clientWidth。总之，值得一试。

# mysql - 在 vb.net 中更新 SQL 语句

> ID：11692047
> 
> 赞同：0
> 
> 时间：2012-07-27T16:37:46.343
> 
> 标签：mysql, database, vb.net, sql-update

我是 VB.NET 和 SQL 的新手。我想更新我的数据库中的记录。我在我的数据库中做了一个假人。

示例值为：ID = 1，name=Cath，age=21

在我用 VB.NET 制作的界面中，我更新了值示例：name = txtName.Text 和 age = txtAge.Text 其中 ID = 1。这是我的主要形式。在我的主表单中，我有“查看”按钮，通知通过单击该按钮，将弹出新表单并查看用户更新的值。该程序没有任何错误，除了当我想再次更新我的SQL中的值时，它会记录但当我再次单击“查看”按钮时，它将显示用户之前输入的内容（运行界面时的第一次更新）。解决方案应该是什么？

这是我的代码：

主窗体：

```
Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    SQLConnection.ConnectionString = ServerString
    Try
        If SQLConnection.State = ConnectionState.Closed Then
            SQLConnection.Open()
            MessageBox.Show("Successful connection")
        Else
            'SQLConnection.Close()
            MessageBox.Show("Connection is closed")
        End If
    Catch ex As Exception
        MsgBox(ex.ToString)

    End Try

End Sub

 Public Sub SaveNames(ByRef SQLStatement As String)
    Dim cmd As MySqlCommand = New MySqlCommand
 With cmd
        .CommandText = SQLStatement
        .CommandType = CommandType.Text
        .Connection = SQLConnection
        .ExecuteNonQuery()
    End With

    MsgBox("Successfully Added!")

End Sub

 Private Sub cmdSave_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdSave.Click
    Dim date_now As String

    date_now = Format(dtpDate.Value, "yyyy-MM-dd")

    Dim SQLStatement As String = "UPDATE people SET name='" & txtName.Text & "', date ='" & date_now & "'  WHERE 1"
    SaveNames(SQLStatement)
End Sub 
```

表格 2：（查看更新数据的地方）

```
 Private Sub Form2_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    SQLConnection.ConnectionString = ServerString
    Try
        If SQLConnection.State = ConnectionState.Closed Then
            SQLConnection.Open()
            '====retrieve / update values in database=============
            Dim SQLStatement As String = "SELECT name, date FROM people"
            ViewInfos(SQLStatement)
        Else
            'SQLConnection.Close()
            MessageBox.Show("Connection is closed")
        End If
    Catch ex As Exception
        MsgBox(ex.ToString)

    End Try
End Sub

 Public Sub ViewInfos(ByRef SQLStatement As String)
    Dim cmd As MySqlCommand = New MySqlCommand

    With cmd
        .CommandText = SQLStatement
        .CommandType = CommandType.Text
        .Connection = SQLConnection
        .ExecuteNonQuery()

    End With
    '--read the records in database in phpmyadmin gui---
    Dim myReader As MySqlDataReader = cmd.ExecuteReader

    If myReader.Read Then
        lblName.Text = myReader.GetString(0)
        lblDate.Text = myReader.GetString(1)

    End If

    myReader.Close()
    MsgBox("Records Successfully Retrieved")

End Sub 
```

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:15:20.023

从 ViewInfos() 方法中取出 .ExecuteNonQuery() 。

通过变量而不是通过表单名称引用您的表单：

```
Dim myForm as New Form2()
myForm.Show() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T18:00:02.840

当您更新 sql 时，您的连接字符串处于打开状态，因此当您尝试检索数据时，您的条件会关闭连接而不读取数据或更新您的文本框。

# jquery - 使用带有动态生成标签 ID 的 jquery 获取文本框值？

> ID：11692051
> 
> 赞同：1
> 
> 时间：2012-07-27T16:38:07.197
> 
> 标签：jquery, html, regex

我有两个文本框：

```
<input type="text" id="xxxxx_SearchBox_xxxxxx_InputBox">
<input type="text" id="xxxxx_xxxxxx_InputBox"> 
```

如何获取第二个文本框的值？`xxxx`不是恒定的并且一直在变化，所以我不能依赖它们。

```
$("input[type='text'][id*='_InputBox']").val() 
```

它会起作用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T16:39:51.597

您可以使用[**eq**](http://api.jquery.com/eq/) jquery 函数通过选择器返回的索引访问元素，

**[现场演示](http://jsfiddle.net/rajaadil/hmN9X/)**

```
$("input[type='text'][id*='_InputBox']").eq(1).val() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T16:40:20.127

" [Attribute Ends With Selector [name$="value"]](http://api.jquery.com/attribute-ends-with-selector/) " 选择器可能会更好，但是如果你可以`InputBox`在服务器端添加一个 " " 类名，那会让你的生活变得更轻松。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T16:44:02.123

```
$("input[type='text']:not([id*=SearchBox])").val() // phew 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T16:48:58.517

试试这个

```
$("input[id$='_InputBox']:not('[id*=SearchBox]')").val(); 
```

[**演示**](http://jsfiddle.net/heera/9yRhn/1/)。

# ruby-on-rails - 如何使用 Rails 3 activerecord 编写这个 sql 查询？

> ID：11692055
> 
> 赞同：0
> 
> 时间：2012-07-27T16:38:12.793
> 
> 标签：ruby-on-rails, activerecord

我正在尝试使用 Rails 3 activerecord 约定编写此查询。

```
SELECT s.name, s.id FROM tripoli_schools_development.campus_programs cp 
  JOIN tripoli_schools_development.career_categories cc ON cp.career_category_id = cc.id 
  JOIN tripoli_schools_development.campuses c ON c.id = cp.campus_id 
  JOIN tripoli_schools_development.schools s ON s.id = c.school_id 
 WHERE cp.enabled = true and c.enabled = true and s.enabled = true and cc.id = 2 
 group by s.id order by s.name 
```

这是我的模型：

```
class CampusProgram < TripoliSchool
  belongs_to :career_category
  belongs_to :campus
end

class CareerCategory < TripoliSchool
  has_many :career_programs
  has_many :campus_programs
end

class Campus < TripoliSchool
  self.table_name = 'campuses'
  belongs_to :school
  has_many :campus_programs
end

class School < ActiveRecord::Base
  has_many :campuses, :class_name => "Campus"
  has_many :campus_programs, :through => :campuses
end 
```

和所有重要的

```
class TripoliSchool < ActiveRecord::Base
  self.abstract_class = true
  establish_connection "tripoli_schools_#{Rails.env}"
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:03:48.270

尝试这个 ：

```
CompusProgram.select("shcools.name, shcools.id").joins([:career_categories, {:campuses => :schools}]).where("campus_programs.enabled = true and campuses.enabled = true and schools.enabled = true and career_categories.id = 2 ") 
```

我不确定，但你有这个想法。您可以在此处查看文档：http: [//api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:25:23.923

这要归功于 Dougui 和 anthonyalberto

```
CampusProgram.select("schools.name, schools.id").joins(:career_category).joins(:campus => :school).where("campus_programs.enabled = true and campuses.enabled = true and schools.enabled = true and career_categories.id = 2").group("schools.id").order("schools.name") 
```

这也有效

```
CampusProgram.select("schools.name, schools.id").joins([:career_category, {:campus => :school}]).where("campus_programs.enabled = true and campuses.enabled = true and schools.enabled = true and career_categories.id = 2").group("schools.id").order("schools.name") 
```

# jquery - .slideToggle() 在一个段落上，而不是在所有其他段落上具有相同的 id

> ID：11692060
> 
> 赞同：0
> 
> 时间：2012-07-27T16:38:31.050
> 
> 标签：jquery, slidetoggle

我希望它像这样工作[http://jsfiddle.net/jfriend00/JrhNz/6/](http://jsfiddle.net/jfriend00/JrhNz/6/)但我有 id 而不是 css 类。

尝试使用 ids 而不是 css 类修改我的代码，但它不起作用。

我的代码：

```
echo "<tr>
        <td>
            <p class=\"question\" id=\"question\">".$rand['nume']."</p>
            <p class=\"answer\" id=\"answer\">".$rand['rasp']."</p>
        </td>
      </tr>";

$(document).ready(function(){
     $("#question").click(function(){
         var prev = $(this).prev("p#answer");
         $(this).siblings("p#answer").not(prev).slideUp("slow");
         prev.slideToggle("slow");
     });

     $("p#answer").click(function(){
         $(this).siblings("p#answer").slideUp("slow");
         $(this).slideToggle("slow");
     });
});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T16:43:13.747

替换代码`"p#answer"`中`"p.answer"`的所有点以定位类。

任何元素都不应具有与另一个元素相同的 ID。如果页面上的两个或多个元素具有相同的 ID，JavaScript 将始终在第一个处停止并忽略其余的。

# ruby - 在 Sinatra 路由中测试实例变量

> ID：11692062
> 
> 赞同：0
> 
> 时间：2012-07-27T16:38:34.563
> 
> 标签：ruby, testing, rspec, sinatra

我需要在 Sinatra 应用程序中测试如下所示的路线。

```
post '/xxx' do

    @yyy.update do |doc|
        ...
        ...
        ...
    end

redirect '/zzz'

end 
```

我的问题是：如何从我的测试中创建变量@yyy（在这种情况下是一个类）和方法“更新”？

# c# - 文档未保存在流中

> ID：11692063
> 
> 赞同：0
> 
> 时间：2012-07-27T16:38:41.490
> 
> 标签：c#, file-io, html-agility-pack

我正在使用 HtmlAgility 包。加载和操作 html 文档后，我尝试将其保存在 Stream 中，但没有保存：

```
 MemoryStream ms = new MemoryStream();
  HtmlDocument newdoc = new HtmlDocument();
  newdoc.load(Inputstream);

   .... manipulate the document ...
  newdoc.Save(ms); 
```

它完美地从流中加载文档但不保存它。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T16:40:40.987

好吧，看：

```
Stream outstream = Stream.Null;
...
newdoc.Save(outstream); 
```

你*希望*它在哪里保存？你需要给它一个流，它实际上会写入你关心的地方......

# facebook - Facebook 中已弃用的离线访问

> ID：11692073
> 
> 赞同：1
> 
> 时间：2012-07-27T16:39:31.550
> 
> 标签：facebook, facebook-graph-api

我上周刚刚创建了一个应用程序，并且我读到离线访问不适用于新创建的应用程序。（我还没有在网络上找到任何教程。我对 facebook 应用程序真的很陌生）在 facebook 中的这一新变化，我不知道如何使用当前的东西。

我非常需要这个功能，因为我不希望用户每次访问并在我的网站以及他的 facebook 墙上发布状态时都在 facebook 上登录。我只想让用户保持联系，并在他授权我的应用程序后自动通过我的网站在他的墙上发帖。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T18:24:10.957

以下文档中有非常清晰和简单的说明来解释切换到长寿命访问令牌需要做什么：
[https ://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)

此外，根据您的描述，您似乎在发送垃圾邮件并违反 Facebook 平台政策。用户会讨厌任何代表他们自动发布的应用程序，所以我建议你不要这样做，因为要么人们会停止使用你的应用程序，要么他们会报告它并被禁止。

# iphone - iPhone 上的自定义光栅/矢量地图

> ID：11692074
> 
> 赞同：1
> 
> 时间：2012-07-27T16:39:34.647
> 
> 标签：iphone, ios, google-maps, maps, raster

我想在 iPhone 上为我正在构建的 iPhone 应用程序访问自定义栅格/矢量地图。有没有办法让地图在 iPhone 上离线？另外如何跟踪路径以及 GPS 位置？有可用的框架吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T11:48:53.393

有几个选项可以离线获取地图。

从 CloudMade 寻找免费的解决方案 - [http://developers.cloudmade.com/projects/show/iphone-sdk](http://developers.cloudmade.com/projects/show/iphone-sdk) - 默认情况下它**不是**离线的，但是它具有缓存地图切片的能力，您可以控制该过程，并且预先缓存所需区域。

此外 - 还有一个名为 RouteMe 的开源项目[https://github.com/route-me/route-me](https://github.com/route-me/route-me) - CloudMade 的地图基于它，您可以使用 RouteMe 源进行深度定制。

其他选项是专有 API，您可以尝试使用：

*   iosphere - [http://www.iosphere.de/quartzmaps.shtml](http://www.iosphere.de/quartzmaps.shtml)
*   MapBox - [http://mapbox.com/mapbox-ios-sdk/](http://mapbox.com/mapbox-ios-sdk/) -*顺便说一下，foursquare 正在使用它们*

# delphi - Delphi 事件监听器只执行第一次

> ID：11692083
> 
> 赞同：1
> 
> 时间：2012-07-27T16:40:06.527
> 
> 标签：delphi, events, listener

概述：我有一个应用程序，我们想要监听/测试事件，理想的是将事件名称传递给存储过程并能够报告事件成功和/或不成功。

问题：事件仅在第一次执行，后续事件不执行。（见通知事件警报）

存储过程：

```
 CREATE PROCEDURE TESTEVENT(EVENTNAME VARCHAR(65))
   AS
   BEGIN
     POST_EVENT(:EVENTNAME);
   END; 
```

通知事件警报：

```
 //Note event is only getting excuted the first time
   procedure TObjApplicationEvents.NotifyEventAlert(Sender: TObject;
   EventName: string; EventCount: Integer; var CancelAlerts: Boolean);
   begin
       if Assigned(Self.OnPostedEvent) then
          Self.OnPostedEvent(Self, Eventname);
   end; 
```

事件发布：

```
 procedure TFrmEventProcessingTestLkp.btnTestEventClick(Sender: TObject);
    var
      c : TCursor;
     ae : TObjApplicationEvents;
     cq : TCustomQuery;
    begin 
        inherited;
        c := Screen.Cursor;
        Screen.Cursor := crHourglass;
        ae := nil;
        cq := nil;
       try
         try
           ae := TObjApplicationEvents.Create;
           ae.OnPostedEvent := Self.OnPostedEvent;

           cq := TCustomQuery.Create(nil);
           cq.StartTransaction;
           cq.SetOperationType(cqotStoredProcedure);
           cq.SetStoredProcName('TESTEVENT');
           cq.Params.CreateParam(ftString, 'EVENTNAME', ptInput);
           cq.ParamByName('EVENTNAME').Value := GetRecordColumnValue(cxColEvent.Index);
           cq.ExecSQL;
           cq.CommitTransaction;
           Sleep(1000);
         except on e: Exception do
         begin
           cq.RollBackTransaction;
           raise Exception.Create(e.message);
         end;
      end;
   finally
      FreeAndNil(ae);
      FreeAndNil(cq);
      Screen.Cursor:= c;
   end;
end; 
```

# asp.net - asp.net 在一个页面上显示元素，而不是另一个

> ID：11692084
> 
> 赞同：0
> 
> 时间：2012-07-27T16:40:15.183
> 
> 标签：asp.net

我正在尝试将 flash 对象添加到这个 asp.net 网站的默认页面。这些页面使用母版页来设置标题等内容，这是我想要这部电影的地方。我想做的基本上是

```
[Pseudo Code]

If(current page == default.aspx)
  show (flash object);
Else
  show static header image;

[/End Pseudo Code] 
```

我对 asp.net 完全陌生，实际上已经在谷歌上搜索了解决方案，但找不到任何东西来确定你在哪个页面上。任何帮助我都会非常感激！

谢谢，迈克

PS 我知道你们中的大多数人会倾向于提供将 C# 代码隐藏文件放入的建议，但它必须是内联的 asp.net，因为我们如何将其分发给客户。再次感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T16:44:17.590

```
<% if( Request.AppRelativeCurrentExecutionFilePath == "~/Default.aspx" ) { %>

<object src="something.swf" type="application/swf"></object>

<% } else { %>

<img src="staticheader.png" alt="header image" />

<% } %> 
```

# magento - Magento：如何修复客户名称搜索

> ID：11692088
> 
> 赞同：0
> 
> 时间：2012-07-27T16:40:21.380
> 
> 标签：magento

在 Magento 管理菜单“客户”->“管理客户”下，如果字符串包含多个单词，我们将无法使用其姓名搜索客户。我在哪里可以找到执行此任务的核心代码？我们没有此部分的扩展名。

问题示例：

如果我想搜索名为 John Smith 的客户，搜索“john smith”不会返回任何结果。分别搜索“john”或“smith”可以工作，但它会显示任何包含“john”或“smith”的名称，类似于 SQL 查询，`LIKE %john%`或`LIKE %smith%`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T10:45:53.800

看起来您使用的是 Magento 1.6 版

这是一个错误，已在 1.7 中修复

这里是需要修改的代码：app/code/core/Mage/Customer/Model/Resource/Customer/Collection.php

我发布了取自 1.7 版的代码：

```
Mage_Customer_Model_Resource_Customer_Collection    

    public function addNameToSelect()
    {
        $fields = array();
        $customerAccount = Mage::getConfig()->getFieldset('customer_account');
        foreach ($customerAccount as $code => $node) {
            if ($node->is('name')) {
                $fields[$code] = $code;
            }
        }

        $adapter = $this->getConnection();
        $concatenate = array();
        if (isset($fields['prefix'])) {
            $concatenate[] = $adapter->getCheckSql(
                '{{prefix}} IS NOT NULL AND {{prefix}} != \'\'',
                $adapter->getConcatSql(array('LTRIM(RTRIM({{prefix}}))', '\' \'')),
                '\'\'');
        }
        $concatenate[] = 'LTRIM(RTRIM({{firstname}}))';
        $concatenate[] = '\' \'';
        if (isset($fields['middlename'])) {
            $concatenate[] = $adapter->getCheckSql(
                '{{middlename}} IS NOT NULL AND {{middlename}} != \'\'',
                $adapter->getConcatSql(array('LTRIM(RTRIM({{middlename}}))', '\' \'')),
                '\'\'');
        }
        $concatenate[] = 'LTRIM(RTRIM({{lastname}}))';
        if (isset($fields['suffix'])) {
            $concatenate[] = $adapter
                    ->getCheckSql('{{suffix}} IS NOT NULL AND {{suffix}} != \'\'',
                $adapter->getConcatSql(array('\' \'', 'LTRIM(RTRIM({{suffix}}))')),
                '\'\'');
        }

        $nameExpr = $adapter->getConcatSql($concatenate);

        $this->addExpressionAttributeToSelect('name', $nameExpr, $fields);

        return $this;
    } 
```

# sql-server-2008 - Sql中的过滤表

> ID：11692090
> 
> 赞同：-4
> 
> 时间：2012-07-27T16:40:24.233
> 
> 标签：sql-server-2008

我有一张桌子 Abc

```
Id    Date      status
C01   Jul 3      A
C02   Jul 5      B
C03   Jul 9      A
C02   Jul 9      A
C05   Jul 3      C
C02   Jul 3      C
C03   Jul 12     C
C05   Jul 13     A 
```

我想过滤这个表然后输出...

```
Id    Date      Status
C01   Jul 3        A
C02   Jul 9        A
C03   Jul 12       C
C05   Jul 13       A 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:01:39.463

如果您的`Date`列是数据类型日期而不是字符串，这将满足您的要求。

```
select *
from
  (
  select *,
         row_number() over(partition by Id order by Date desc) as rn
  from Abc
  ) as T
where T.rn = 1 
```

[SE-数据](https://data.stackexchange.com/stackoverflow/query/76126)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T16:54:46.830

如果您是`group by`您的 ID 和状态，您将无法获得预期的输出。您需要获取`max date`每个 ID，并通过`Join`

```
 Select T1.Id, T1.Date, T2.Status from
    (select Id, max(Date) as 'Date'
    from Abc group by Id) T1
    INNER JOIN Abc T2 on T1.Id = T2.Id and T1.Date = T2.Date order by Id asc 
```

如果一个 ID 有两个相等`dates`，它可能会失败，但如果你正在寻找，`Max`这不应该发生。（或者我们需要更多信息才能知道在这种情况下要这样做）

[SE-数据](https://data.stackexchange.com/stackoverflow/query/edit/76128)

# windows - 以编程方式滚动 Windows 编辑控件

> ID：11692093
> 
> 赞同：1
> 
> 时间：2012-07-27T16:40:30.413
> 
> 标签：windows, winapi, scroll, editcontrol

有没有办法在 Windows 中以编程方式滚动单行编辑控件？

例如，如果编辑控件中的文本太大而无法立即显示，则编辑控件获得焦点时的默认行为是选择所有文本并显示文本的结尾。我想改为显示文本的开头（同时仍然选择所有文本）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T18:29:40.757

尽管（显然）没有用于滚动到开头并选择所有文本的 API，但它似乎可以模拟可以执行相同操作的击键：

```
#ifndef CTRL               
#define CTRL(x) (x&037)    
#endif

SendMessage(edit_handle, WM_KEYDOWN, VK_HOME, 0);
SendMessage(edit_handle, WM_CHAR, CTRL('A'), 0); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-27T16:44:23.903

您可以调用[SetScrollPos](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787597%28v=vs.85%29.aspx)或将[WM_VSCROLL](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787577%28v=vs.85%29.aspx) / [WM_HSCROLL](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787575%28v=vs.85%29.aspx)消息直接发送到窗口。[您可以在此处](http://msdn.microsoft.com/en-us/library/ff486021%28v=VS.85%29.aspx)找到滚动功能的完整列表。

# delphi - 在 DT/RT 创建后如何在自定义组件上绘制额外的东西？

> ID：11692094
> 
> 赞同：2
> 
> 时间：2012-07-27T16:40:31.207
> 
> 标签：delphi, user-interface

我正在尝试使用一种新的边框（圆角）创建一组自定义组件，例如 TEdit、TDBEdit、TComboBox，并且我创建了以下代码：

```
unit RoundRectControls;

interface

uses
  SysUtils, Classes, Controls, StdCtrls, Windows, Messages, Forms;

type
  TRoundRectEdit = class(TEdit)
  private
    { Private declarations }
  protected
    { Protected declarations }
  public
    constructor Create(AOwner: TComponent); override;
    { Public declarations }
  published
    property BorderStyle default bsNone;
    property Ctl3D default False;
    { Published declarations }
  end;

procedure Register;
procedure DrawRoundedRect(Control: TWinControl);

implementation

constructor TRoundRectEdit.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);
  DrawRoundedRect(Self);
end;

procedure Register;
begin
  RegisterComponents('Eduardo', [TRoundRectEdit]);
end;

procedure DrawRoundedRect(Control: TWinControl);
var
   r: TRect;
   Rgn: HRGN;
begin
   with Control do
   begin
     r := ClientRect;
     rgn := CreateRoundRectRgn(r.Left, r.Top, r.Right, r.Bottom, 30, 30) ;
     Perform(EM_GETRECT, 0, lParam(@r)) ;
     InflateRect(r, - 4, - 4) ;
     Perform(EM_SETRECTNP, 0, lParam(@r)) ;
     SetWindowRgn(Handle, rgn, True) ;
     Invalidate;
   end;
end;

end. 
```

但是在我尝试将组件放入表单后，出现了以下消息：

![控件''没有父级](../Images/a92abb708e197dd9252a68fd5ff4b427.png)

那么，我该如何解决呢？我是构建组件的新手，我需要一个很好的网络教程。有些东西告诉我，我需要`DrawRoundedRect`在构造函数之外进行...但是在哪里？

**编辑 1 - 2012-07-27 14:50**

![结果](../Images/0828e0dc74f153d71bffffbd8334277a.png)

Sertac Akyuz 的回答很棒并解决了问题，但结果有点难看。我不知道我做错了什么。EditBox 的文本太靠近左上角。有谁知道我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T17:02:12.570

您正在请求“ClientRect”，但尚未创建编辑控制窗口（没有窗口，没有矩形）。您可以在创建区域修改代码后将其移动到某个位置。例子：

```
type
  TRoundRectEdit = class(TEdit)
  private
    { Private declarations }
  protected
    procedure CreateWnd; override;
    { Protected declarations }
  public
    constructor Create(AOwner: TComponent); override;
    ...

constructor TRoundRectEdit.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);
//  DrawRoundedRect(Self);
end;

procedure TRoundRectEdit.CreateWnd;
begin
  inherited;
  DrawRoundedRect(Self);
end; 
```

错误消息本身反映了 VCL 在请求其句柄后创建窗口的努力。它不能这样做，因为它无法解析将控件放置在哪个窗口中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T18:28:22.580

在其中创建一个新区域`SetBounds()`应该没问题。请务必先调用`inherited`，然后使用更新后的`Width`/`Height`创建新区域。 `CreateWnd()`仍应使用当前`Width`/创建初始区域`Height`。 仅当为 True`SetBounds()`时才应重新创建该区域。`HandleAllocated()`

# java - 如何在 java swing GUI 中创建可移动节点和边？

> ID：11692095
> 
> 赞同：2
> 
> 时间：2012-07-27T16:40:31.767
> 
> 标签：java, wpf, swing, user-interface, graph

在我的 java 项目中，我需要创建一个带有 swing 的 GUI，我将在其中拥有一个类似空间的画布。用户应该能够单击并创建节点，然后将节点与边缘链接（就像您在 MS Visio 中创建 UML 图一样）。用户还应该能够随边移动节点。然后我的应用程序将保存网络并运行自私节点算法，用户应该能够在 GUI 上实时看到它（创建和消除边缘）。我不确定我需要使用哪些挥杆工具来完成这项工作。（并且可以在 WPF 中完成，我必须使用哪些工具）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T16:50:45.890

试试这个

```
<dependency>
        <groupId>jgraph</groupId>
        <artifactId>jgraph</artifactId>
        <version>5.13.0.0</version>
    </dependency> 
```

我们确实使用这个库创建了非常复杂的摆动 UI 屏幕，其中包含许多面向图形的结构。看看这里[http://www.jgraph.com](http://www.jgraph.com)或直接在这里[http://www.jgraph.com/images/business-large.png](http://www.jgraph.com/images/business-large.png)这是你要找的东西吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-27T16:49:07.580

如果您尝试“推出自己的”解决方案，我有一些建议：

*   显然，您将需要使用 MouseListener 和 MouseMotionListener，它们可以通过使用 MouseAdapter 组合成一个实体。
*   您的线条可能会在 JPanel 的 paintComponent 方法中绘制。
*   然后你对节点的选择就会不同。您可以使用 JLabels 等组件，每个组件都附加一个 MouseAdapter（同样作为 MouseListener 和 MouseMotionListener）
*   或者您可以使用添加到 JPanel 的单个 MouseAdapter 并在 JPanel 的`paintComponent(...)`方法中再次将节点呈现为矩形。
*   节点和连接的数据应该与 GUI 分开保存，也许在它自己的“模型”类中，作为 MVC（模型-视图-控制器）应用程序的一部分。
*   MouseAdapter 将成为 MVC 结构的“控件”的一部分，并会更改模型。
*   我更喜欢能够将侦听器添加到我的模型中，例如 PropertyChangeListener，并让视图 Swing GUI 根据触发的侦听器来改变其显示。

由于这可能是家庭作业，因此我将让您制定详细信息和代码，但如果您在特定步骤遇到困难，请随时返回您的代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-27T16:55:37.660

我建议你试试[JUNG](http://jung.sourceforge.net/)库。我用这个库（而不是`JGraph`）创建了一个应用程序，因为我认为 JUNG 比`JGraph`新手更容易学习（即使它提供的功能更少）。我只需要它们之间的简单节点和边。

它看起来像这样（可能这或多或少是你想要做的）： ![应用示例](../Images/cccffb245dc570d36a7d8bc4afb1302b.png)

以下是核心 JUNG 功能的基本代码片段：

```
public ArchitectureEditor(String title, MainWindow mainWindow, ArchObjContextConcern contextConcern) {
    super(title);
    setName(NAME);

    graph = new DirectedSparseGraph<ArchObject, EdgeKey>();

    layout = new StaticLayout<ArchObject, EdgeKey>(graph);
    vv = new AutoCropVisualizationViewer(layout); //extends VisualizationViewer<ArchObject, EdgeKey>
    vv.getRenderContext().setEdgeShapeTransformer(new EdgeShape.Line<ArchObject, EdgeKey>());

    VERTEX_ICON_TRANSFORMER = new ArchObjIconTransformer(vv);
    VERTEX_SHAPE_TRANSFORMER = new ArchObjShapeTransformer(vv);
    vv.getRenderContext().setVertexShapeTransformer(VERTEX_SHAPE_TRANSFORMER);
    vv.getRenderContext().setVertexIconTransformer(VERTEX_ICON_TRANSFORMER);

    graphMouse = new ArchGraphMouse(mainWindow, contextConcern);
    vv.setGraphMouse(graphMouse);
    vv.addKeyListener(new ArchGraphKeyboard(mainWindow, this));
    vv.setBackground(Color.WHITE);

    ComponentUtils.setForcedSize(vv, 1, 1);
    setLayout(new BorderLayout());
    add(new JScrollPane(vv));
} 
```

图中的对象表示为： ![类层次结构](../Images/28ab28cf4c0c68c8342f0729fde14103.png)

# macos - 无法在 Mac OsX 上编辑 bash_profile

> ID：11692100
> 
> 赞同：19
> 
> 时间：2012-07-27T16:41:05.997
> 
> 标签：macos, permissions, osx-snow-leopard, alias, .bash-profile

我正在使用 MacOSX Snow Leopard 10.6.8 .... 我是这台机器上唯一的用户，我应该是管理员。

我试图编辑我的 bash_profile 给它这个简单的别名：

`alias server=' open http://localhost:8000 && python -m SimpleHTTPServer'`

但是，当我使用终端并键入：`vim ~/. bash_profile`并粘贴此别名时，我收到消息说由于权限而无法保存。

然后我显示所有隐藏文件并修复此文件的权限，但文件全部变灰......我无法更改任何内容。我能做些什么？？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-07-27T16:44:37.517

您需要使用 sudo 打开它。

```
sudo vim ~/.bash_profile 
```

当您显示隐藏文件时，该文件显示为灰色，因为 Mac OS X 将隐藏文件显示为灰色，以便您可以将它们与非隐藏文件区分开来。您仍然应该能够编辑文件的权限（但您不需要）。

如果您希望能够在没有 root 身份的情况下进行编辑，您可以更改文件的所有者。

```
sudo chown your_user_name ~/.bash_profile 
```

# drupal - Drupal 7 模板中的显示速率模块

> ID：11692101
> 
> 赞同：1
> 
> 时间：2012-07-27T16:41:09.507
> 
> 标签：drupal, drupal-7, rate

在 Drupal 6 中，如果我想显示 RATE 模块，我可以使用代码（

```
<?php print $node->rate_rate['#value'];?> 
```

在 Drupal 7 模板中显示它的代码是什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-14T19:33:16.703

您可以选择不自动将小部件添加到节点模板。在这种情况下，小部件可以用作：

```
<?php print $node->rate_NAME['#markup']; ?> 
```

将 NAME 替换为小部件的机器可读名称。

# javascript - IE 中的“对象不支持此属性或方法”

> ID：11692109
> 
> 赞同：1
> 
> 时间：2012-07-27T16:41:47.130
> 
> 标签：javascript, internet-explorer

我已经查看了有关此问题的许多其他问题，但我找不到任何可以帮助我解决特定问题的内容。我已经尝试了很多没有帮助的建议...

这是我正在处理的错误（当然，仅在 IE 中，它在 Chrome 和 FF 中可以正常工作）：

```
var Lights = {};
var light_data = {
    id: "",
    location: "",
    week: [],
    stats: [],
    run: function(){
        run_statistics();
    }
}

Lights.APIEvents = Object.create(light_data); //complains about this line 
```

我想为 Lights 的属性创建一个 light_data 对象......但它不起作用并抱怨该对象不支持它......有什么想法吗？

非常感谢你的帮助！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T16:59:37.323

在打电话之前使用它`Object.create`

```
if (typeof Object.create !== 'function') {
    Object.create = function (o) {
        function F() {}
        F.prototype = o;
        return new F();
    };
} 
```

所以`Object.create`也会起作用`IE`。

# php - 如何使用 PHP 转换 JSON 数据中的十六进制代码

> ID：11692110
> 
> 赞同：0
> 
> 时间：2012-07-27T16:41:47.113
> 
> 标签：php, json, unicode, format, hex

我有一些由 Drupal CMS 生成的内容，其中包含以下字符串：

```
"... \n Proficient knowledge of \x3cstrong\x3emedical\x3c/strong\x3e terminology; typing skills at 40 wpm. Excellent communication and ... which involves access to sensitive and/or confidential \x3cstrong\x3emedical\x3c/strong\x3e information. Must demonstrate leadership skills in decision making and ..." 
```

我正在尝试将此数据作为 json 传输，但它没有验证。我认为这是因为像这样的字符`\x3c`可能需要采用更长的 6 字符格式（请参阅[https://www.rfc-editor.org/rfc/rfc4627](https://www.rfc-editor.org/rfc/rfc4627)，第*2.5 节 - 字符串*）。

这真的是问题吗？如果是这样，有没有一种转换格式的好方法？

**编辑：**这里有两个未通过验证的完整 json 样本

```
{ "results": [ { "link": "http://dev.careersatnmc.org/content/clinical-information-clerk-patient-financial-services-11-12", "type": "", "title": "Clinical Information Clerk, Patient Financial Services, #11-12", "user": "", "date": "1337699702", "node": "", "extra": "", "score": 1.9532660466727E+25, "snippet": "... \n Proficient knowledge of \x3cstrong\x3emedical\x3c/strong\x3e terminology; typing skills at 40 wpm. Excellent communication and ... which involves access to sensitive and/or confidential \x3cstrong\x3emedical\x3c/strong\x3e information. Must demonstrate leadership skills in decision making and ..." }, { "link": "http://dev.careersatnmc.org/content/medical-assistant-northwestern-walk-clinic-11-44", "type": "", "title": "Medical Assistant, Northwestern Walk-In Clinic, #11-44", "user": "", "date": "1334178982", "node": "", "extra": "", "score": 1.6696042412062E+25, "snippet": "... \n Yes \n \n \n The \x3cstrong\x3eMedical\x3c/strong\x3e Assistant performs patient screening care under the direction of the \x3cstrong\x3eMedical\x3c/strong\x3e Director/On-site provider including, but not limited to, EKG’s. ..." }, { "link": "http://dev.careersatnmc.org/nursing-jobs", "type": "", "title": "Nursing Opportunities at Northwestern", "user": "", "date": "1333132723", "node": "", "extra": "", "score": 1.5935361158907E+25, "snippet": "... environment for caregivers. Here at Northwestern \x3cstrong\x3eMedical\x3c/strong\x3e Center, in addition to being a destination of choice for patients, we ..." }, { "link": "http://dev.careersatnmc.org/nursing-careers/rn/registered-nurse-float-pool-11-106", "type": "", "title": "Registered Nurse, Float Pool #11-106 ", "user": "", "date": "1333040298", "node": "", "extra": "", "score": 1.5869853268872E+25, "snippet": "... safe nursing care in a timely manner to patients on the \x3cstrong\x3eMedical\x3c/strong\x3e Surgical Unit and Intensive Care Units with a high degree of ... Float Pool RN will be required to rotate to both ICU and \x3cstrong\x3eMedical\x3c/strong\x3e Surgical Units based on patient census and staffing need. These ..." }, { "link": "http://dev.careersatnmc.org/content/medical-assistant-northwestern-walk-clinic-11-68", "type": "", "title": "Medical Assistant, Northwestern Walk-In Clinic, #11-68", "user": "", "date": "1327941682", "node": "", "extra": "", "score": 1.2643954777586E+25, "snippet": "... \n Yes \n \n \n The \x3cstrong\x3eMedical\x3c/strong\x3e Assistant performs patient screening care under the direction of the \x3cstrong\x3eMedical\x3c/strong\x3e Director/On-site provider including, but not limited to, EKG’s. ..." }, { "link": "http://dev.careersatnmc.org/content/clinical-support-associate-diagnostic-imaging-10-126", "type": "", "title": "Clinical Support Associate, Diagnostic Imaging, #10-126", "user": "", "date": "1327936594", "node": "", "extra": "", "score": 1.2641087846662E+25, "snippet": "... \n Three years experience in a \x3cstrong\x3emedical\x3c/strong\x3e office required. Prior clerical work experience in a \x3cstrong\x3emedical\x3c/strong\x3e office, knowledge of \x3cstrong\x3emedical\x3c/strong\x3e terminology, typing skills required. ..." }, { "link": "http://dev.careersatnmc.org/content/licensed-practical-nurse-cardiology-11-61", "type": "", "title": "Licensed Practical Nurse, Cardiology, #11-61", "user": "", "date": "1327443988", "node": "", "extra": "", "score": 1.2366575548271E+25, "snippet": "... \n Previous experience with electronic \x3cstrong\x3emedical\x3c/strong\x3e records preferred. \n \n \n \n Special Skills / ..." }, { "link": "http://dev.careersatnmc.org/equal-opportunity-policy", "type": "", "title": "Equal Opportunity", "user": "", "date": "1319564835", "node": "", "extra": "", "score": 8.704398538793E+24, "snippet": " Northwestern \x3cstrong\x3eMedical\x3c/strong\x3e Center is an equal opportunity employer that is committed to fair and ..." }, { "link": "http://dev.careersatnmc.org/NMC-Hospital-Video", "type": "", "title": "NMC Hospital Video", "user": "", "date": "1317216552", "node": "", "extra": "", "score": 7.8394368227485E+24, "snippet": "... more about what it\x26#39;s like to work at Northwestern \x3cstrong\x3eMedical\x3c/strong\x3e Center from some of the hospital\x26#39;s providers. \x26nbsp; \n \n ..." }, { "link": "http://dev.careersatnmc.org/overview", "type": "", "title": "About NMC", "user": "", "date": "1305051468", "node": "", "extra": "", "score": 4.5584239764666E+24, "snippet": "... environment for caregivers.\x26nbsp; Here at Northwestern \x3cstrong\x3eMedical\x3c/strong\x3e Center, in addition to being a destination of choice for patients, we ..." } ], "total": "36" }

{ "results": [ { "link": "http://dev.northwesternmedicalcenter.org/courtyard-cafe", "type": "", "title": "The Courtyard Café", "user": "", "date": "1341844260", "node": "", "extra": "", "score": 0.54264448532277, "snippet": " Meals \u0026amp; Snacks \n The NMC Courtyard Café serves a wide variety of options, whether you need a full meal or just a snack or drink.\u0026nbsp; There are always healthy options available to choose from in the Courtyard Café during hours of operation. \n T ..." }, { "link": "http://dev.northwesternmedicalcenter.org/overview", "type": "", "title": "Welcome to Northwestern Medical Center!", "user": "", "date": "1308682802", "node": "", "extra": "", "score": 0.54083665338769, "snippet": " Northwestern \u003cstrong\u003eMedical\u003c/strong\u003e Center is a\u0026nbsp;vibrant, not-for-profit, primary care hospital nestled ... we pride ourselves on bringing a broad range of high-tech \u003cstrong\u003emedical\u003c/strong\u003e equipment \u0026amp; services to our region. Thanks to that balance and the ..." }, { "link": "http://dev.northwesternmedicalcenter.org/stories-nmc", "type": "", "title": "Stories at NMC", "user": "", "date": "1340734687", "node": "", "extra": "", "score": 0.51676585442723, "snippet": "... Birth Center nurses and the IT folks at Northwestern \u003cstrong\u003eMedical\u003c/strong\u003e Center, to experience the birth of his daughter Payton while on duty in ..." }, { "link": "http://dev.northwesternmedicalcenter.org/medical-executive-committee", "type": "", "title": "Medical Executive Committee", "user": "", "date": "1306856292", "node": "", "extra": "", "score": 0.41599960274235, "snippet": " \u003cstrong\u003eMedical\u003c/strong\u003e Executive Committee \n The NMC \u003cstrong\u003eMedical\u003c/strong\u003e Staff is made up of more than 75 active staff physicians and more than 200 other physicians, dentists, and \u003cstrong\u003emedical\u003c/strong\u003e providers who have privileges at the hospital.\u0026nbsp; The \u003cstrong\u003eMedical\u003c/strong\u003e Staff ..." }, { "link": "http://dev.northwesternmedicalcenter.org/medical-cardiology", "type": "", "title": "Medical Cardiology", "user": "", "date": "1327606268", "node": "", "extra": "", "score": 0.40720084861885, "snippet": " ..." }, { "link": "http://dev.northwesternmedicalcenter.org/news-and-updates/dr-lowrey-sullivan-named-chief-medical-officer", "type": "", "title": "Dr. Lowrey Sullivan Named Chief Medical Officer", "user": "", "date": "1326989520", "node": "", "extra": "", "score": 0.40509813494658, "snippet": "... that Dr. Sullivan has accepted the position of Chief \u003cstrong\u003eMedical\u003c/strong\u003e Officer,\u0026rdquo; said Jill Bowen, NMC\u0026rsquo;s Chief Executive ... Having a physician who already has the respect of our \u003cstrong\u003emedical\u003c/strong\u003e staff provides a strong foundation for the success of this ... his Bachelors degree from Middlebury College and his \u003cstrong\u003eMedical\u003c/strong\u003e Degree from the University of Vermont.\u0026nbsp; He did his Internship and ..." }, { "link": "http://dev.northwesternmedicalcenter.org/nmc.overview-video", "type": "", "title": "NMC Overview Video", "user": "", "date": "1327331110", "node": "", "extra": "", "score": 0.33907030714933, "snippet": " View the video below to learn more about St. Alban\u0026rsquo;s lifestyle offerings. The city has much to offer and its central location between Burlington and Montreal makes it a great place to enjoy the pace and intimacy of a small town with access to bi ..." }, { "link": "http://dev.northwesternmedicalcenter.org/nmc-overview-video", "type": "", "title": "NMC Overview Video", "user": "", "date": "1327331316", "node": "", "extra": "", "score": 0.33905170147781, "snippet": " View the video below to learn more about St. Alban\u0026rsquo;s lifestyle offerings. The city has much to offer and its central location between Burlington and Montreal makes it a great place to enjoy the pace and intimacy of a small town with access to bi ..." }, { "link": "http://dev.northwesternmedicalcenter.org/news-and-updates/test-story", "type": "", "title": "Test Story", "user": "", "date": "1326989380", "node": "", "extra": "", "score": 0.33538503005686, "snippet": " Story Details \n Full Story:\u0026nbsp; \n \n \n Wolf cred veniam sunt. Nesciunt PBR four loko blog american apparel labore. Sint reprehenderit american apparel nihil, mcsweeney\u0026#39;s freegan voluptate velit al ..." }, { "link": "http://dev.northwesternmedicalcenter.org/news-and-updates/nmc-laboratory-featured-video", "type": "", "title": "NMC Laboratory Featured in a Video", "user": "", "date": "1326989494", "node": "", "extra": "", "score": 0.33522577107044, "snippet": " Story Details \n Full Story:\u0026nbsp; \n \n \n This electronic approach, which is being used as a model throughout the state, is quicker, more efficient, more accurate, and less costly way of sharing informat ..." } ], "total": "236" } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-23T00:23:22.650

`\x`通常代表十六进制，而代表`\u`unicode。您的问题与 Unicode 或 unicode 代码点无关。

使用它是安全的，`chr()`因为它`\xFF`是`255`最大值并且在 ASCII 范围内。

```
function weird_answer_to_weird_question($string)
{
    return preg_replace_callback('#\\\\x([[:xdigit:]]{2})#ism', function($matches)
    {
        return chr(hexdec($matches[1]));
    },
    $string);
} 
```

输出：

> “... \n 精通**医学**术语；打字技能为 40 wpm。出色的沟通和...涉及访问敏感和/或机密的 **医疗**信息。必须在决策和...方面表现出领导能力...”

附言

您还必须执行`$string = str_replace('\n', "\n", $string);`或类似操作，因为`json_encode()`会对其进行双重编码。感谢*@netcoder*指出。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-23T00:53:38.023

关于什么 ：

```
echo iconv('ASCII', 'UTF-8', "Proficient knowledge of \x3cstrong\x3emedical\x3c/strong\x3e terminology");
// returns Proficient knowledge of <strong>medical</strong> terminology
$jsonString = "... \n Yes \n \n \n The \x3cstrong\x3eMedical\x3c/strong\x3e Assistant performs patient screening care under the direction of the \x3cstrong\x3eMedical\x3c/strong\x3e Director/On-site provider including, but not limited to, EKG’s. ...";
$jsonString = str_replace(array('’'), array("'"), $jsonString);
echo iconv('ASCII', 'UTF8//IGNORE//TRANSLIT', nl2br($jsonString));
// returns ... <br>Yes <br><br><br>The <strong>Medical</strong> Assistant performs patient screening care under the direction of the <strong>Medical</strong> Director/On-site provider including, but not limited to, EKG's. ... 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-08-16T21:28:13.493

好的，这会做到：

```
/**
 * Converts all UTF-8 Units ( \xXX ) back into ascii characters.  
 * 
 * @param string $input   String which includes some UTF-8 units
 * @return string
 */
function convertUTF8Units($input) {
    include $path;
    $part = "";
    $output = $input;
    $len = strlen($input)-4;

    for($i=0; $i<=$len; $i++) {
      $part = substr($input, $i, 4);

      if ((substr($part, 0, 2) === "\\x")) {          
        $raw = hex2bin( $part );
        $raw = trim($raw);
        $pattern = "/\\".$part."/";
        $output = preg_replace($pattern, $raw, $output);
      }

    }
    return $output;
}

/**
 * Function to convert a hex code back to ascii string.  Taken from 
 * http://devcorner.georgievi.net/pages/programming/php/hex2bin-php.
 * 
 * @param string $hex_string   String of format: \xXX
 * @return string
 */
define('HEX2BIN_WS', " \t\n\r");
function hex2bin($hex_string) {
  $pos = 0;
    $result = '';
    while ($pos < strlen($hex_string)) {
      if (strpos(HEX2BIN_WS, $hex_string{$pos}) !== FALSE) {
        $pos++;
      } 
    else {
        $code = hexdec(substr($hex_string, $pos, 2));
      $pos = $pos + 2;
        $result .= chr($code); 
      }
    }
    return $result;
} 
```

我对我要转换的内容有点模糊；我所确定的是它现在通过了所有 JSON 验证器。在追求这个 UTF-8 的同时，UTF-8 Units、Binary things、Hex 值和 ascii 字符都出现了。我实际上无法明确表达差异，也无法明确说出这些函数的输入、转换或输出是什么。

谁能告诉我我的代码在做什么？:P

# python - 让 Django 识别 PIL JPEG 支持

> ID：11692111
> 
> 赞同：6
> 
> 时间：2012-07-27T16:41:48.487
> 
> 标签：python, django, python-imaging-library, virtualenv, libjpeg

我正在运行`Django 1.4`并`PIL 1.1.7`在`virtualenv`管理中使用`pip`. 每当我通过管理界面上传 JPEG 文件时，都会收到以下错误：`Upload a valid image. The file you uploaded was either not an image or a corrupted image.`

正如许多 Ubuntu 用户所报告的那样，在安装时，PIL 错误地查找了`/usr/lib/`. `libjpeg`，而它的真实位置在`/usr/lib/i386-linux-gnu/`. 已经处理好了；我遵循了这些帖子中的答案：

[Django ImageField“上传一个有效的图像。您上传的文件不是图像或损坏的图像。”](https://stackoverflow.com/questions/7606614/django-imagefield-upload-a-valid-image-the-file-you-uploaded-was-either-not-an)

[为什么我不能通过 admin/ 将 jpg 文件上传到我的 Django 应用程序？](https://stackoverflow.com/questions/1402002/why-cant-i-upload-jpg-files-to-my-django-app-via-admin)

现在安装的最终输出如下所示：

* * *

```
PIL 1.1.7 SETUP SUMMARY
--------------------------------------------------------------------
version       1.1.7
platform      linux2 2.7.3 (default, Apr 20 2012, 22:44:07)
              [GCC 4.6.3]
--------------------------------------------------------------------
--- TKINTER support available
--- JPEG support available
--- ZLIB (PNG/ZIP) support available
--- FREETYPE2 support available
*** LITTLECMS support not available
--------------------------------------------------------------------
To add a missing option, make sure you have the required
library, and set the corresponding ROOT variable in the
setup.py script.

To check the build, run the selftest.py script.
changing mode of build/scripts-2.7/pilfile.py from 644 to 755
changing mode of build/scripts-2.7/pilfont.py from 644 to 755
changing mode of build/scripts-2.7/pilconvert.py from 644 to 755
changing mode of build/scripts-2.7/pilprint.py from 644 to 755
changing mode of build/scripts-2.7/pildriver.py from 644 to 755

changing mode of /usr/local/bin/pilfile.py to 755
changing mode of /usr/local/bin/pilfont.py to 755
changing mode of /usr/local/bin/pilconvert.py to 755
changing mode of /usr/local/bin/pilprint.py to 755
changing mode of /usr/local/bin/pildriver.py to 755
Successfully installed PIL 
```

* * *

但是，Django*仍然*不允许我上传 BMP 文件以外的任何内容，这对于这个项目是不可接受的。与第二个链接中的用户不同，我没有使用 Apache，所以我的问题可能不相关。我怀疑 Django 仍在使用旧的 PIL 安装。问题是我不知道它是从哪里得到的。中的文件`~/.virtualenvs/project/local/lib/python2.7/site-packages`对我来说似乎是最新的。有任何想法吗？

编辑 1：另请注意，我已尝试注销并重新登录管理员，以及安装`pillow`，如这篇文章中所示：[通过 Django 上传 JPEG 图像显示错误](https://stackoverflow.com/questions/9271267/uploading-a-jpeg-image-via-django-displays-error?rq=1)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T15:59:40.657

`pip`事实证明，由于对实际工作方式的误解，这整件事都是我的错。根据习惯，我将任何和所有安装都与超级用户权限相关联，这不仅在这种情况下不是必需的，而且会造成混淆。

我第一次安装`PIL`时，我没有在它前面加上前缀`sudo`，但之后我每次都这样做。因此，根据 Meitham 的建议，我检查了导入的来源。它来自正确的地方，但它没有我想要的扩展，尽管安装后的输出说我有。长话短说，我从我的站点包中删除了该目录，然后`pip freeze`继续告诉我我没有，`PIL`但`sudo pip install`告诉我我有。

经验教训：**`virtualenv`是基于用户的目录，基于用户的权限。`sudo`在将and组合`pip`在同一个命令中之前，请三思**。

# c# - Sharepoint 2010 - webpart 树视图不工作

> ID：11692115
> 
> 赞同：0
> 
> 时间：2012-07-27T16:42:20.913
> 
> 标签：c#, visual-studio-2010, sharepoint-2010

您好我正在使用 sharepoint 2010 并在 Web 部件中创建树视图以显示文档库中的项目。这段代码对我不起作用，它在同一个网络中显示所有内容......我希望能够指定要使用的文档库。

它还放入了重复的节点，所以如果我去编辑页面，它会添加一个副本，如果我离开编辑模式，它会添加另一个副本。![在此处输入图像描述](../Images/789fa754257c111c85d60e565815bd13.png)

任何人都可以帮忙吗？

```
using System;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using Microsoft.SharePoint;
using Microsoft.SharePoint.Utilities;
using System.Web;
using System.IO;

namespace VisualWebPartProject1.VisualWebPart1 
{
    public partial class VisualWebPart1UserControl : UserControl 
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            SPWeb thisWeb = null;
            TreeNode node;
            using (thisWeb = SPContext.Current.Web)
            {

                //Add the Web's title as the display text for the tree node, and add the URL as the NavigateUri.
                node = new TreeNode(thisWeb.Title, null, null, thisWeb.Url, "_self");
                //The Visual Web Part has a treeview control called siteStructure.
                siteStructure.Nodes.Add(node);
                //Get a reference to the current node, so child nodes can be added in the correct position.
                TreeNode parentNode = node;
                //Iterate through the Lists collection of the Web.

                /*
                foreach (SPListItem item in myList.Items)
                {
                    SPFieldUrlValue data = item["Url"] as SPFieldUrlValue;
                    // now you have data.Description, data.Url
                    node = new TreeNode(Path.GetFileName(data.Url), null, null, data.Url, "_self");
                    parentNode.ChildNodes.Add(node);

                }
                */

                foreach (SPList list in thisWeb.Lists)
                {
                    if (!list.Hidden)
                    {
                        node = new TreeNode(list.Title, null, null, list.DefaultViewUrl, "_self");
                        parentNode.ChildNodes.Add(node);
                    }
                }
                foreach (SPWeb childWeb in thisWeb.Webs)
                {
                    //Call our own helper function for adding each child Web to the tree.
                    addWebs(childWeb, parentNode);
                    childWeb.Dispose();
                }

                siteStructure.CollapseAll();

            }
        }
        void addWebs(SPWeb web, TreeNode parentNode)
        {
            TreeNode node;
            node = new TreeNode(web.Title, null, null, web.Url, "_self");
            parentNode.ChildNodes.Add(node);
            parentNode = node;
            foreach (SPList list in web.Lists)
            {
                if (!list.Hidden)
                {
                    node = new TreeNode(list.Title, null, null, list.DefaultViewUrl, "_self");
                    parentNode.ChildNodes.Add(node);
                }
            }
            foreach (SPWeb childWeb in web.Webs)
            {
                //Call the addWebs() function from itself (i.e. recursively) 
                //to add all child Webs until there are no more to add.
                addWebs(childWeb, parentNode);
                childWeb.Dispose();

            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T03:20:15.397

尝试在您的 using 语句之前添加此内容：

```
If(node.Nodes.Count == 0) { // The rest of your code here } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-24T19:39:56.880

将[WebProperties](https://msdn.microsoft.com/en-us/library/dd584174(v=office.11).aspx)添加到您的 WebPart 以便能够配置例如您想要使用的库，而不是硬编码的库。在此属性中，您可以指定列表名称并读取它以加载此列表。

还要避免在编辑等时多次插入，请在里面的 Page_Load 事件中添加您的代码

```
if (!Page.IsPostBack)
{
    Your code goes here...
} 
```

这样可以避免每次加载甚至回发页面时都执行代码，这会导致每次向树中添加一个新节点。

# php - 在 PHP 中执行 shell 命令

> ID：11692119
> 
> 赞同：1
> 
> 时间：2012-07-27T16:42:35.650
> 
> 标签：php, shell, pdf-to-html

在终端上，我在 Web 应用程序的目录中成功运行：

```
pdftohtml -c -noframes "documents/document1.pdf" 
```

现在我想通过 PHP 做到这一点，所以我写了一个`shell.sh`看起来像这样的文件：

```
sudo pdftohtml -c -noframes "documents/$file"
exit 0 
```

然后我用php写了这个：

```
$output = shell_exec("file='document1.pdf' shell.sh"); 
```

它不起作用，我希望看到生成的 html 文件，但是我得到了一些空的 html 文件。由于该命令通过终端运行良好，那么我认为问题出在我从 php 执行它的方式上

回显 $output 没有显示任何内容..我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T16:52:11.990

您需要指定脚本的路径（或者`./`如果它是当前目录）：

```
shell_exec("file='document1.pdf' ./shell.sh") 
```

# git - 链接 Bitbucket Git 存储库上的最新文件

> ID：11692124
> 
> 赞同：94
> 
> 时间：2012-07-27T16:43:11.173
> 
> 标签：git, hyperlink, bitbucket

我在 Bitbucket 上有一个公共 Git 存储库。我想链接最新版本的自述文件。这是修订/提交的链接：

[https://bitbucket.org/wordless/thofu-interpreter/raw/5bfc37864c5d/ThoFu%20Interpreter/ReadMe.txt](https://bitbucket.org/wordless/thofu-interpreter/raw/5bfc37864c5d/ThoFu%20Interpreter/ReadMe.txt)

我试图用**tip**和**default**替换修订号，但没有奏效。**有什么方法可以永久链接到我的最新文件？**

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-07-27T17:17:12.110

两个想法：

在网址中使用`master`（这似乎有效）：

```
https://bitbucket.org/wordless/thofu-interpreter/raw/master/ThoFu%20Interpreter/ReadMe.txt 
```

另一个想法是为您的项目创建一个 wiki 页面，然后使用 wiki 的功能链接到具有以下语法[的文件的最新版本：](https://confluence.atlassian.com/display/BITBUCKET/Macro+Reference+for+Creole+Markup#MacroReferenceforCreoleMarkup-File)

```
<<file path/to/file [revision] [linenumber]>> 
```

只需省略修订和行号参数，它们是可选的。

然后，在您想要链接到自述文件的其他任何地方参考 wiki 页面。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2014-01-03T14:06:07.160

通过将您的相对链接更新到`src/[branch_name]/path/to/file`. 对我来说就像一个魅力。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-11-16T02:46:19.000

使用 Markdown（自述文件和 Wiki 页面的默认设置）向存储库中的文件添加链接的规范方法是链接到文件的相对路径。

例如，如果我有这样的结构：

```
<repo root>
|-- my-file.txt
|    
|-- my-dir 
|    |-- my-other-file 
```

我可以按如下方式链接到它们：

```
[my-file](my-file.txt)
[my-dir](my-dir)
[some-other-file](my-dir/some-other-file) 
```

然后，Bitbucket 将自动链接到您正在查看文件的当前分支处的文件。如果您正在查看概述中的自述文件，这将意味着默认分支（通常是“主”）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-06-24T18:09:18.867

我正在使用这样的 master 作为代码的最后一个 zip 文件：

```
https://bitbucket.org/MIUSER/MIREPO/get/master.zip 
```

其中 MIUSER 是我的用户，MIREPO 是我的应用程序的名称。

希望这有效：D。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-11-27T14:13:17.647

以下是工作链接：

### 生的：

```
https://bitbucket.org/wordless/thofu-interpreter/raw/HEAD/TODO.txt?at=master&fileviewer=file-view-default 
```

### 资源：

```
https://bitbucket.org/wordless/thofu-interpreter/src/HEAD/TODO.txt?at=master&fileviewer=file-view-default 
```

# javascript - javascript中的异步控制流

> ID：11692128
> 
> 赞同：0
> 
> 时间：2012-07-27T16:43:33.440
> 
> 标签：javascript, asynchronous, control-flow

我正在为 chrome 编写一个使用 Web SQL 进行本地存储的浏览器扩展。这两个组件的代码似乎都严重依赖异步操作。我对异步操作有很好的理解，但没有很多编写严重依赖异步操作的代码的经验。

例如：

```
 var CSUID = "";
 //this is an async callback for handling browser tab updates
 function checkForValidUrl(tabId, changeInfo, tab) {
      getCookies("http://www.cleansnipe.com/", "CSUID", handleCookie);

      if(CSUID != ""){ //this could be in handleCookie if i could access the tab
         //do stuff with the tab
      } 
  }
  function handleCookie(cookie) {
     if (cookie != "" && cookie != null) {
        CSUID = cookie;
     }
  } 
```

为了克服无法将变量传递/返回这些处理程序的能力，我发现自己创建了全局变量并将它们设置在处理程序中。当然，这不会按预期工作，因为该变量通常在回调执行之前被访问。

处理这种情况的最佳做法是什么？我想使用带有 while 循环的全局标志/计数器来暂停执行，但这似乎很容易导致应用程序挂起。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:03:10.213

如果 jQuery 是一个选项，它有一个漂亮的系统，称为延迟对象。它允许对异步情况进行优雅和有效的管理 - 或者实际上是同步的，视情况而定或有所不同。

（Deferred 不仅限于 jQuery，而且 jQuery 为它们提供了一个不错的 API）。

这是一个简单的例子，纯粹是为了演示这个概念。

```
//get data func
function get_data(immediate) {
    //if immediate, return something synchonously
    if (immediate)
        return 'some static data';
    //else get the data from something over AJAX
    else
        return $.get('some_url');
}

//two requests two get data - one asynchronous, one synchronous
var data1 = get_data(true), data2 = get_data();

//do something when both resolved
$.when(data1, data2).done(function(data1, data2) {
    //callback code here...
}); 
```

延期不必涉及 AJAX；您可以创建自己的延迟对象（jQuery 的 AJAX 请求会自动生成并返回它们）并手动解析/拒绝它们。几个月前我[写了一篇关于这个的博客文章——它可能会有所帮助。](http://www.mitya.co.uk/blog/2012/Apr/Non-AJAX-use-for-jQuerys-deferred-objects-207)

# android - Android : 圆角在不同的 Android 版本中工作方式不同

> ID：11692129
> 
> 赞同：6
> 
> 时间：2012-07-27T16:43:38.817
> 
> 标签：android, android-layout

我对角标签有问题。

这是我的形状文件。

```
<stroke
    android:width="1dp"
    android:color="#ff999999" />

<size android:height="40dp" />

<gradient
    android:angle="90"
    android:centerColor="#f5f5f5"
    android:endColor="#fcfcfc"
    android:startColor="#efefef"
    android:type="linear" />

<corners
    android:bottomLeftRadius="0dip"
    android:bottomRightRadius="8dip"
    android:topLeftRadius="8dip"
    android:topRightRadius="0dip" /> 
```

但是当我将它设置为视图的背景时。它在 Android 2.2 和 Android 4.0.3 中显示不同的形状。在 Android 4.0.3 上运行时：[在 Android 4.0.3](http://imageshack.us/photo/my-images/94/screenshot20120727at110.png/) 上运行 在 Android 2.2 上：[在 Android 2.2 上运行](http://imageshack.us/photo/my-images/651/screenshot20120727at111.png/)

请参阅“公告”按钮。你知道为什么吗 ？我该如何解决？请帮我 ！对不起，因为我的英语不是很好。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-27T16:48:16.467

这是 SDK 的 pre-API 12 版本中的一个错误，其中左下角和右下角的半径被颠倒了。[您可以做的（并且在此链接](http://code.google.com/p/android/issues/detail?id=9161)上有更多信息）是创建一个`res/drawable-v12`文件夹，并将这些可绘制对象复制到其中，半径反转（即左下半径变为右下半径，反之亦然），这些可绘制对象将为 API 12 以上的设备自动选择。

# ios - ios - 编码 url 字符串后的问题

> ID：11692131
> 
> 赞同：0
> 
> 时间：2012-07-27T16:44:09.240
> 
> 标签：ios, ios5

我有一些代码可以将 url 发送到远程服务器。如果我不对 url 进行编码，它会完美运行。但是，如果我对 url 进行编码，它就不起作用。所以我很确定我编码 url 查询字符串的方式有问题。

这是我的代码：

```
 // URL TO BE SUBMITTED.
        NSString *urlString = 
        @"http://www.mydomain.com/test.php?";

        // NOW CREATE URL QUERY STRING    
        NSString *unencoded_query_string = 
        @"name=%@&user_id=%@&person_name=%@&person_email=%@&privacy=%@";

// PUT PREVIOUSLY SET VALUES INTO THE QUERY STRING
        NSString *unencoded_url_with_params = 
        [NSString stringWithFormat:unencoded_query_string, business , user_id , name , email , privacy_string]; 

        // ENCODE THE QUERY STRING
        NSString *escapedString = (__bridge_transfer NSString *)CFURLCreateStringByAddingPercentEscapes(
                                                                                      NULL,
                                                                                      (__bridge CFStringRef)unencoded_url_with_params,
                                                                                      NULL,
                                                                                      (CFStringRef)@"!*'();:@&=+$,/?%#[]",
                                                                                      kCFStringEncodingUTF8);

        // NOW APPEND URL TO QUERY STRING
        NSString *full_encoded_url_string = 
        [urlString  stringByAppendingString: escapedString]; 
```

然后我将此字符串发送到服务器，服务器确实调用了正确的请求文件，但无法读取参数。

有谁知道我在这里做错了什么？顺便说一句，我正在使用弧。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T18:03:44.037

我认为您可能想逃避每个参数，而不是整个请求。基本上你想逃避出现在你的get变量中的&符号、空格等。您的编码 URL 可能如下所示：

```
http://www.mydomain.com/test.php?name%3DPeter%20Willsey%26user_id%3DUSERID%26person_name%3DPeter%20Willsey%26person_email%3Dpeter%40test.com%26privacy%3D1 
```

它应该是这样的：

```
http://www.mydomain.com/test.php?name=Peter%20Willsey&user_id=25&person_name=Peter%20Willsey&person_email=peter%40test.com&privacy=1 
```

# asp.net-mvc-3 - Mvc 3 - 对标准和管理屏幕使用相同的视图和视图模型？

> ID：11692132
> 
> 赞同：0
> 
> 时间：2012-07-27T16:44:10.007
> 
> 标签：asp.net-mvc-3, viewmodel

我有两个屏幕，一个标准用户屏幕和一个管理员屏幕。两者之间的变化相当小——管理屏幕上有一些额外的按钮和选项。

就 MVC 最佳实践而言，最好：

1.  对管理员和标准用户屏幕使用**相同的视图和相同的视图模型。**这样就没有代码重复，但我将在视图和控制器中有几个 if...else 语句

2.  为管理员和用户屏幕使用**单独的视图和视图模型。**这会导致一些代码重复，但如果屏幕最终的分歧比现在更大，那么最终是最灵活的。

3.  其他一些很好的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T16:52:25.817

我会使用单独的视图模型并将**继承**应用到您的`ViewModel`. 所以您不会复制代码。

```
public class CustomerCreateViewModel
{
  //Here i i have properties common to both user and admin
  public string FirstName { set;get;}
  public string LastName { set;get;}
}
public class AdminCustomerCreateViewModel : CustomerCreateViewModel
{
  //This property is only for admin
  public string ReasonForFiring { set;get;}
} 
```

我个人更喜欢保留单独的视图，因为它使事情变得干净且更具可读性/可维护性。现在你有 2 个单独的 ViewModel，所以有单独的视图。您可以根据需要考虑渲染局部视图（在两个视图中）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:05:41.857

这真的只是一个你可以回答的问题。您基本上说过，如果更改很小，那么我们使用单个视图并将管理功能包装在检查用户角色的 if 语句中。

但是，只有在管理员版本和非管理员版本之间没有模型更改时，我才会这样做。添加其他模型项后，我建议使用单独的模型和视图。

# 64-bit - 32 位机器上的狮身人面像 sql_attr_bigint

> ID：11692133
> 
> 赞同：0
> 
> 时间：2012-07-27T16:44:14.073
> 
> 标签：64-bit, sphinx, 32-bit

我在 32 位机器上运行 sphinx，并想让 sql_attr_bigint 工作。

1.  这可以做到吗？
2.  它应该默认工作吗？
3.  我是否必须在编译时重新编译并进行任何更改？
4.  会对性能产生什么影响？

我的表 id 适合 32 位。我只需要一个属性，它必须是 64 位。

问题可能出在PHP中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T10:06:41.347

问题出在 PHP 中。当我将结果数组中的值分配给变量时，PHP 将值弄乱了。Sphinx 在 32 位 comp 上与 bigints 配合得很好。

这仍然可以在 PHP 上工作，因为 sphinx 在结果数组中将属性值作为字符串返回（不管它们如何存储在索引中）。所以我可以在 PHP 代码中使用字符串值。

# cocoa - 允许应用在 Power Nap 期间下载数据

> ID：11692138
> 
> 赞同：6
> 
> 时间：2012-07-27T16:44:30.373
> 
> 标签：cocoa, osx-mountain-lion

作为开发人员，我想使用 Power Nap 为我的应用下载数据。自动唤醒功能是一件好事。这可以通过 Mac App 实现吗？

我知道苹果允许什么；它到处都写着。

但是，我可以更新我的应用程序中的数据（也就是说，不是云中的文档、邮件、提醒等），也许是大数据，比如新地图？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-27T17:02:59.667

不 - 没有可供第三方开发人员使用的与 Power Nap 相关的公共 API。对不起！

# objective-c - 设置 Storyboard 选项卡控制器，更多选项卡的导航栏颜色

> ID：11692142
> 
> 赞同：0
> 
> 时间：2012-07-27T16:44:44.090
> 
> 标签：objective-c, ios, storyboard, uinavigationbar

因此，在我的整个应用程序中，我`Navigation Bars`使用 Black Opaque 样式实现。

**问题**

当用户选择自动生成的时，我似乎无法设置`Navigation Bar`呈现的颜色`More Tab`

**问题**

如何将此导航栏的颜色设置为黑色不透明？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T14:28:06.347

是的，我是那些现在正在回答自己的问题的伤心人之一：P 希望它有所帮助..

因此，您需要`TabBarController`在您的应用程序委托中获取对 的引用，然后从那里更改更多导航控制器的样式。下面的代码向您展示了如何以及在哪里..

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Override point for customization after application launch.
    UITabBarController *_tabController = (UITabBarController*)_window.rootViewController;
    _tabController.moreNavigationController.navigationBar.barStyle = UIBarStyleBlackOpaque;
    return YES;
} 
```

# matplotlib - 在 python 颜色图中设置颜色限制

> ID：11692156
> 
> 赞同：1
> 
> 时间：2012-07-27T16:46:02.637
> 
> 标签：matplotlib

我需要在灰色颜色图中显示来自 2D 矩阵的数据，但我需要以这样的灰度定义它，即白色和黑色不是矩阵的最小值和最大值的颜色，以免使图像饱和. 我需要的是一个灰度颜色图，灰度在 20% 到 70% 之间，灰度之间至少有 20% 的差异。有什么建议么？我正在使用 imshow 任务表单 matplotlib。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T14:53:47.663

你解决了你的问题吗？我想这就是你想要的，试试这个：

pylab模式下的所有代码：

```
a = np.arange(100).reshape(10,10)
#here is the image with white and black end
imshow(a,cmap=mat.cm.binary)
colorbar()

#we extract only the 0.2-->0.7 part of original colormap and make a new one
#so that the white and black end are removed
rgba_array = mat.cm.binary(np.linspace(0,1,num=10,endpoint=True))
extract_rgba_array_255 = rgba_array[2:8,0:3]
imshow(a,cmap=mat.colors.ListedColormap(extract_rgba_array_255))
colorbar() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T18:21:08.127

您可以通过使用您喜欢的颜色创建[自定义颜色](http://matplotlib.sourceforge.net/examples/pylab_examples/custom_cmap.html)图来做到这一点，或者通过使用[`vmin`,`vmax`](http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.imshow)关键字`imshow`来强制颜色栏上的范围比您想要在绘图中使用的范围更大。

# perl - 使用 LibXML 提取一个节点

> ID：11692157
> 
> 赞同：1
> 
> 时间：2012-07-27T16:46:07.690
> 
> 标签：perl, xpath, xml-parsing, libxml2

这对我来说可能是个新手，但我是 Perl LibXML（以及 XPath）的新手。我有这个 XML 文档：

```
<Tims
    xsi:schemaLocation="http://my.location.com/namespace http://my.location.com/xsd/Tims.xsd"
    xmlns="http://my.location.com/namespace"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xlink="http://www.w3.org/1999/xlink">
        <Error>Too many entities for operation.  Acceptable limit is 5,000 and 8,609 were passed in.</Error>
        <Timestamp>2012-07-27T12:06:24-04:00</Timestamp>
        <ExecutionTime>41.718</ExecutionTime>
</Tims> 
```

我想做的就是获得`<Error>`. 就这样。我尝试了很多方法，最近一次是[这个](https://stackoverflow.com/questions/8411684/xmllibxml-replace-element-value)。我已经彻头彻尾地阅读了这些文档。这是我目前在我的代码中的内容：

```
#!/usr/bin/perl -w

my $xmlString = <<XML;
<?xml version="1.0" encoding="ISO-8859-1"?>
<Tims
    xsi:schemaLocation="http://my.location.com/namespace http://my.location.com/xsd/Tims.xsd"
    xmlns="http://my.location.com/namespace"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xlink="http://www.w3.org/1999/xlink">
    <Error>Too many entities for operation.  Acceptable limit is 5,000 and 8,609 were passed in.</Error>
    <Timestamp>2012-07-27T12:06:24-04:00</Timestamp>
    <ExecutionTime>41.718</ExecutionTime>
</Tims>
XML

use XML::LibXML;

my $parser = XML::LibXML->new();
my $doc = $parser->parse_string($xmlString);
my $root = $doc->documentElement();
my $xpc = XML::LibXML::XPathContext->new($root);

$xpc->registerNs("x", "http://my.location.com/namespace");

foreach my $node ($xpc->findnodes('x:Tims/x:Error')) {
        print $node->toString();
} 
```

任何建议，链接，任何东西都会受到赞赏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T16:49:42.777

只需`/`在 XPath 的开头添加一个（即 into `findnodes`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T00:43:07.287

您的代码不起作用，因为您`<Tims>`在创建 XPath 上下文时使用文档元素作为上下文节点`$xpc`。该`<Error>`元素是它的直接子元素，因此您需要编写的只是

```
$xpc->findnodes('x:Error') 
```

或者另一种方法是使用绝对 XPath，它指定从文档根目录开始的路径

```
$xpc->findnodes('/x:Tims/x:Error') 
```

这样，上下文节点的内容无关紧要`$xpc`。

但正确的方法是完全忘记获取元素节点并使用文档根作为上下文节点。您还可以使用`findvalue`而不是`findnodes`获取不带封闭标签的错误消息的文本：

```
my $parser = XML::LibXML->new;
my $doc = $parser->parse_string($xmlString);

my $xpc = XML::LibXML::XPathContext->new($doc);
$xpc->registerNs('x', 'http://my.location.com/namespace');

my $error= $xpc->findvalue('x:Tims/x:Error');
print $error, "\n"; 
```

**输出**

```
Too many entities for operation.  Acceptable limit is 5,000 and 8,609 were passed in. 
```

# android - 布局隐形，扣在他身上

> ID：11692159
> 
> 赞同：-1
> 
> 时间：2012-07-27T16:46:30.593
> 
> 标签：android, android-layout

（我已将代码放在帖子末尾）

我想做一个隐藏菜单。

我不知道我是否采取了好方法。

我有一些可见的按钮，一些不可见的按钮和另一个可见的按钮。第一个布局中的一个按钮必须设置可见的隐藏按钮。

我想在第一束之后有最后一个按钮。但就像我已经把布局看不见一样，所以我有一个空白空间。

我想当我按下设置可见的按钮时，最后一个按钮会按下。

我希望你能理解我想要做什么以及我做了什么。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
   xmlns:android="http://schemas.android.com/apk/res/android"
   android:layout_width="fill_parent"
   android:layout_height="fill_parent"
   android:orientation="vertical"
   android:background="@drawable/fond"
   >

    <ImageView
        android:id="@+id/imageView1"
        android:contentDescription="@string/desc"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/top" 
        android:layout_gravity="top" 
        android:adjustViewBounds="true" 
    />

    <LinearLayout 
        android:layout_below="@+id/imageView1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:background="@drawable/fond2"
        >
        <LinearLayout 
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:layout_marginLeft="30dp" 
            android:layout_marginRight="30dp"

            >
            <LinearLayout 
                xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:weightSum="3"
                >
                <Button 
                    android:id="@+id/button_garçon"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="@string/Bg"
                    android:background="@drawable/button_purple" 
                    android:layout_weight="1"
                    android:textColor="#ffffff"
                    android:onClick="actionGarçon"
                />
                <Button 
                    android:id="@+id/button_mixte"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="@string/Bm"
                    android:background="@drawable/button_purple" 
                    android:layout_weight="1"
                    android:textColor="#ffffff"
                    android:onClick="actionMixte"
                />
                <Button
                    android:id="@+id/button_fille"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="@string/Bf"
                    android:background="@drawable/button_purple" 
                    android:layout_weight="1"
                    android:textColor="#ffffff"
                    android:onClick="actionFille"           
                />
            </LinearLayout>
            <LinearLayout 
                xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:weightSum="1"
                >

                <Button
                    android:id="@+id/button_param"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="@string/Bp"
                    android:background="@drawable/button_green" 
                    android:layout_weight="1"
                    android:textColor="#ffffff"
                    android:onClick="actionParametre"           
                />
            </LinearLayout>
            <!-- invisible -->
            <LinearLayout 
                xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical"
                android:visibility="invisible"
                >
                <TextView
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:text="@string/Tq" 
                    android:textColor="#000000"
                />
                <EditText android:id="@+id/edit_message"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:hint="@string/Emc"
                    android:singleLine="true"
                />
                 <TextView
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:text="@string/Tpre"
                    android:textColor="#000000"
                />
                <EditText android:id="@+id/edit_message"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:hint="@string/Epre"
                    android:singleLine="true"
                />
                <TextView
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:text="@string/Tsuf" 
                    android:textColor="#000000"
                />
                <EditText 
                    android:id="@+id/edit_message"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:hint="@string/Esuf"
                    android:singleLine="true" 
                />

                <TextView
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:text="@string/Tl"
                    android:textColor="#000000"
                />
                <LinearLayout 
                    xmlns:android="http://schemas.android.com/apk/res/android"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:orientation="horizontal" 
                    android:weightSum="100"
                    >

                    <Button android:id="@+id/button_court"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/Blc" 
                            android:layout_weight="25"
                            android:background="@drawable/button_purple"
                            android:textColor="#ffffff" 
                            android:onClick="actionCourt"
                    />
                    <Button android:id="@+id/button_moyen"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/Blm" 
                            android:layout_weight="25"
                            android:background="@drawable/button_purple"
                            android:textColor="#ffffff" 
                            android:onClick="actionMoyen"
                    />
                    <Button android:id="@+id/button_long"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/Bll"
                            android:layout_weight="25" 
                            android:background="@drawable/button_purple"
                            android:textColor="#ffffff"
                            android:onClick="actionLong" 
                    />
                    <Button android:id="@+id/button_tous"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/Blt"
                            android:layout_weight="25" 
                            android:background="@drawable/button_purple"
                            android:textColor="#ffffff"
                            android:onClick="actionTous" 
                            android:state_pressed="true"
                    />
                </LinearLayout>

                <Button android:id="@+id/button_orig"
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content"
                        android:text="@string/Bo"
                        android:background="@drawable/button_purple" 
                        android:textColor="#ffffff"
                        android:onClick="actionOrigine"
                />
            </LinearLayout>
            <!-- /invisible -->
            <Button android:id="@+id/button_recher"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="@string/Br"
                android:background="@drawable/button_green"
                android:textColor="#ffffff"
                android:onClick="actionRecherche"
            />
        </LinearLayout>
    </LinearLayout>      
</LinearLayout> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T16:50:30.913

如果我理解正确，您想要使用`android:visibility="gone"`这样您设置的内容`"gone"`不会占用布局上的任何空间。

基本上，而不是`android:visibility="invisible"`你应该使用`android:visibility="gone"`

看看这是否有效。

# android - Android：获取活动窗口的尺寸

> ID：11692160
> 
> 赞同：2
> 
> 时间：2012-07-27T16:46:31.140
> 
> 标签：android, android-activity, window

在我的某些活动中，我正在使用主题 -

> android:theme="@android:style/Theme.Dialog"

有什么办法可以找出屏幕上这个窗口的实际尺寸？我最后的努力以：

```
Display display = getWindowManager().getDefaultDisplay();
Point size = new Point(); 
```

这给了我整个屏幕的实际分辨率。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-15T12:28:59.837

从 API 级别 13： `Point screenSize = new Point(); getActivity().getWindowManager().getDefaultDisplay().getSize(screenSize);`

见这里： http: [//developer.android.com/reference/android/view/Display.html#getSize(android.graphics.Point)](http://developer.android.com/reference/android/view/Display.html#getSize(android.graphics.Point))

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:05:13.957

不确定这是完全正确的解决方案，但我通过从您为对话框膨胀的布局中获取根视图解决了这个问题（在这种情况下，您需要分配 id），然后很容易获得尺寸：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/root"
    android:layout_width="300dp"
    android:layout_height="wrap_content"
    android:layout_gravity="right"
    android:layout_marginTop="103dp"
    android:background="#FFFFFF">

    <RelativeLayout 
        android:id="@+id/report_header"
        android:layout_height="wrap_content"
        android:layout_width="match_parent"
        android:paddingLeft="15dp">
        ....
    </RelativeLayout>
</RelativeLayout> 
```

在您的对话活动中，您需要获取您的根：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.dialog_layout);
    View root = findViewById(R.id.root);
} 
```

之后，您可以通过以下方式获取对话框尺寸：

```
Rect r = new Rect ( 0, 0, 0, 0 );
root.getHitRect ( r ); 
```

在此调用之后，`r`将包含您正在寻找的尺寸

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-24T13:50:10.610

有一个非常简单的方法

```
 <RelativeLayout mlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:id="@+id/rootView"
        >
... some other views
    </RelativeLayout> 
```

而且，在您的活动中，您需要在绘制视图后获取视图。

像这样：

```
private View mRoot;

    @Override
    protected void onResume() {
        super.onResume();

        mRoot = findViewById(R.id.rootView);

        /* after the main view is loaded, start positioning the views */
        mRoot.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {
            @Override
            public void onGlobalLayout() {
// in here, the view is already loaded, you can get his size.
// without the navigation / status / title bar
                // remove the observer, we don't need it anymore
mRoot.getViewTreeObserver().removeOnGlobalLayoutListener(this);
                mButton.setRadius(1000);
                mButton.setMinimumWidth(mRoot.getWidth() / 2);
                mButton.setY(mRoot.getHeight() / 3 * 2);
            }
        });
    } 
```

希望有帮助。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-27T19:44:18.920

您可以使用两种方法：第一种方法是这样的：

```
 Display display = getActivity().getWindowManager().getDefaultDisplay(); 
           int width = display.getWidth();
           int widthdp = (int) (width / getResources().getDisplayMetrics().density);
           int height = display.getHeight();
           int heightdp = (int) (height / getResources().getDisplayMetrics().density); 
```

您可以使用的第二个是：

```
 Point size = new Point();
                display.getSize(size);
                int width_one = size.x;
                int height_one = size.y; 
```

# android - Android：更改片段的背景颜色

> ID：11692162
> 
> 赞同：34
> 
> 时间：2012-07-27T16:46:35.223
> 
> 标签：android, layout, background, fragment

我尝试更改片段的背景颜色，但出现了一个小问题。

```
public class MainActivity extends FragmentActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }
} 
```

因此，**上面**显示的是我的主类的代码，它为片段调用 XML 文件。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <fragment
        android:id="@+id/fragment1"
        android:name="com.northreal.practice.FirstFragment"
        android:layout_width="0dip"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:background="#CBA" />

</LinearLayout> 
```

**以上**是主类（MainActivity）调用的main.xml布局。

```
public class FirstFragment extends Fragment {
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup parent,
            Bundle savedInstanceState) {
        return inflater.inflate(R.layout.main, parent, false);
    }
} 
```

**上面**带有片段的 XML 文件调用了这个类。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal"
     >

    <TextView
        android:id="@+id/tv"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="BLAHHHH"
        android:layout_gravity="center_vertical" />

</LinearLayout> 
```

**上面**的这个布局被 FirstFragment 类夸大了

那么，为什么这实际上并没有改变我的片段背景的颜色呢？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-04-11T05:40:38.933

片段不从 View 继承，因此没有设置背景方法。

任何简单的解决方法就是抓住片段[的根视图并设置它的背景](http://developer.android.com/reference/android/app/Fragment.html#getView%28%29)

```
fragment.getView().setBackgroundColor(Color.WHITE); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-27T16:46:35.223

这不起作用的原因是因为片段被视为类似于活动。它是一个容器，是主要活动的子活动，用于显示其他项目。

您需要将 android:background="#CBA" 放在包含 TextView 而不是片段本身的实际布局中。像这样：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#CBA"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/tv"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_vertical"
        android:text="BLAHHHH" />
</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-02-13T14:22:00.763

获取片段对象，如：

```
Fragment fragment = (Fragment) getFragmentManager().findFragmentById(R.id.fragmentId); 
```

改变它的背景，如：

```
fragment.getView().setBackgroundColor(Color.WHITE); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-05-15T09:25:13.360

在 AndroidX 中，您可以使用 FragmentContainerView 而不是 Fragment 来设置背景：

```
<androidx.fragment.app.FragmentContainerView
    ...
    android:background="#FFFFFF"/> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-11T18:29:29.930

我遇到了同样的问题，但我的要求是设置或更改片段的背景可绘制图像。正如亚当回答的那样，这种方法是正确的，我想展示从片段到活动的联系。

最佳做法是使用名为“连接器”（或任何名称）的接口。然后从您的片段中：

```
Connector connector = (Connector) getActivity();
connector.setIt(this); 
```

然后在您的活动中实现“连接器”接口并拥有该方法。

```
@Override
public void setIt(Fragment fragment){
    FirstFragment firstFrag = (FirstFragment) getSupportFragmentManager().findFragmentByTag("first");
    firstFrag.getView().setBackgroundDrawable(getResources().getDrawable(R.drawable.app_background));
    //or for color set
    firstFrag.getView().setBackgroundColor(Color.WHITE);
} 
```

# c# - 这应该被嘲笑或存根吗？

> ID：11692165
> 
> 赞同：2
> 
> 时间：2012-07-27T16:46:42.497
> 
> 标签：c#, unit-testing, c#-4.0, dependency-injection, moq

我有以下方法来测试，我已经编写了两个测试，测试抛出异常的场景，我想知道哪个是正确的。

```
namespace JimBob.CsvImporter.Entity
{

    public interface IIOManager
    {
        Stream OpenFile(string path);

        TextReader ReturnReader(string path);
    }

    public class IOManager : IIOManager
    {
        public Stream OpenFile(string path)
        {
            return File.Open(path, FileMode.Open);
        }

        public TextReader ReturnReader(string filePath)
        {
            return new StreamReader(filePath);
        }
    }

public class EntityVerification
{

    private IIOManager _iomgr;

    public EntityVerification(IIOManager ioManager)
    {
        this._iomgr = ioManager;
    }

    ...

    /// <summary>
    /// Ensures user can open file.
    /// </summary>
    /// <param name="errorMessageList">A running list of all errors encountered.</param>
    public void ValidateAccessToFile(string filePath, List<string> errorMessageList)
    {
        try
        {
            using (FileStream fs = (FileStream)_iomgr.OpenFile(filePath))
            {
                if (fs.CanRead && fs.CanWrite) { }
                else
                {
                    errorMessageList.Add("Can not read/write to the specified file.");
                }
            }
        }
        catch (Exception e)
        {
            errorMessageList.Add(e.Message);
        }
    } 
```

测试：

```
 [Test]
    public void ValidateAccessToFile_CanReadWriteToFile_ThrowException()
    {
        List<String> errorMessageList = new List<string>();
        StubService stub = new StubService();
        EntityVerification testObject = new EntityVerification(stub);
        testObject.ValidateAccessToFile("ergesrg", errorMessageList);
        Assert.AreEqual(errorMessageList.Count, 0);
    }

    [Test]
    public void ValidateAccessToFile_CanReadWriteToFile_ThrowsException()
    {
        Mock<IIOManager> mock = new Mock<IIOManager>();
        mock.Setup(x => x.ReturnReader(It.IsAny<string>())).Throws(new InvalidOperation("throw baby."));
        EntityVerification testObject = new EntityVerification(mock.Object);
        List<String> errorMessageList = new List<string>();
        testObject.ValidateAccessToFile("blabla.txt", errorMessageList);
        Assert.AreEqual(errorMessageList.Count, 0);
    }

    public class StubService : IIOManager
    {
        public Exception ex;
        public Stream OpenFile(String path)
        {
            throw ex;
        }
    } 
```

两个测试都只是检查测试的局部变量（在本例中为 errorMessageList）是否包含某些内容，因此我不确定应该使用哪个。

任何意见将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:01:40.180

首先，您不应该检查您**是否**将错误消息添加到列表中？

```
Assert.AreEqual(errorMessageList.Count, 1); 
```

其次，虽然第二个测试不那么冗长，并且更具可读性（因为您不需要实现另一个类），**但这并不重要**- 这两个测试都是实现相同目标的有效方法。只需选择一个并继续您的下一个功能...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T20:03:33.560

第二个测试看起来更好。我认为您`IIOManager`应该使用其他方法来维护第一个测试（更新存根），但对第二个测试不做任何事情。

about `IOManager`, `FileSystem`- 看起来更合适的类名

# c# - 'particleEngine' 被绘制在一个向量上

> ID：11692166
> 
> 赞同：0
> 
> 时间：2012-07-27T16:46:45.787
> 
> 标签：c#, windows-phone-7, vector, xna

我正在使用 XNA 和 C#。

我从我的`particleEmitter`. 如果粒子是静态的或不移动的，我可以很好地绘制粒子。当我有一个向量变量设置为 (x,y) 的固定位置时，它可以在屏幕上绘制。但是，如果我有一个向量变量被设置为在 x 或 y 轴上移动，它根本不会绘制。

声明的变量：

```
Vector2 shipPos;
float shipMovement;
ParticleEngine particleEngine; 
```

还有一种方法可以加载有关向量应该发生的事情及其行为方式的内容：

```
public void loadEmitter(GameTime gameTime)
{
    shipMovement = 2f;
    shipPos.Y -= shipMovement;          
    particleEngine.EmitterLocation = new Vector2(shipPos.X,shipPos.Y);
} 
```

我正试图`particleEngine`追踪一艘船的运动。当我设置它发生时，我似乎无法做的是让它绘制。

**其他信息：** `ParticleEngine`它本身就是一个类，基本上设置了一些关于我将要绘制的粒子应该如何表现的参数。我有其他屏幕与`spritebatch` `Begin`和`End`电话。除此之外，这是我的主要课程的代码：

```
namespace PlanetDrill2
{
class LaunchScreen : Screen
{
    Texture2D LaunchScreenTexture;
    Texture2D shipLaunch;

    Vector2 shipPos;
    float shipMovement;
    ParticleEngine particleEngine;

    Vector2 smokePos;

    public LaunchScreen(Game game, SpriteBatch batch, ChangeScreen changeScreen)
        : base(game, batch, changeScreen)
    {            
    }

    protected override void SetupInputs()
    {
        base.SetupInputs();
    }

    public override void Activate()
    {
        base.Activate();
    }

    public void LaunchShip()
    {
    }

    public void loadEmitter(GameTime gameTime)
    {
        shipMovement = 2f;
        shipPos.Y -= shipMovement;        
        particleEngine.EmitterLocation = new Vector2(shipPos.X,shipPos.Y);
    }

    protected override void LoadScreenContent(ContentManager content)
    {
        LaunchScreenTexture = content.Load<Texture2D>("launchTest");
        shipLaunch = content.Load<Texture2D>("shipLaunch");

        List<Texture2D> textures = new List<Texture2D>();
        textures.Add(content.Load<Texture2D>("smoketexture"));
        particleEngine = new ParticleEngine(textures, new Vector2(0, 0));
        base.LoadScreenContent(content);
    }

    protected override void UpdateScreen(GameTime gameTime, DisplayOrientation screenOrientation)
    {
        //if (gameTime.TotalGameTime.Seconds>10)
        //{
        //    changeScreenDelegate(ScreenState.UMA);
        //}

        loadEmitter(gameTime);
        particleEngine.Update();
        base.UpdateScreen(gameTime, screenOrientation);
    }

    protected override void DrawScreen(SpriteBatch batch, DisplayOrientation screenOrientation)
    {
        batch.Draw(LaunchScreenTexture, Vector2.Zero, Color.White);
        batch.Draw(shipLaunch, new Vector2(80, 450) +shipPos, Color.White);
        particleEngine.Draw(batch);
        base.DrawScreen(batch, screenOrientation);
    }

    protected override void SaveScreenState()
    {
        base.SaveScreenState();
    }
} // end class LaunchScreen
} // end namespace PlanetDrill2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T18:22:06.813

从这里

```
batch.Draw(shipLaunch, new Vector2(80, 450) +shipPos, Color.White);
particleEngine.Draw(batch); 
```

看起来您正在相对于 [80, 450] 绘制船，但您没有将此偏移量应用于粒子引擎。

# android - 使用 Google 地图进行地理定位无法使用 PhoneGap

> ID：11692172
> 
> 赞同：0
> 
> 时间：2012-07-27T16:47:04.820
> 
> 标签：android, cordova, geolocation, position

我正在使用 Phonegap (cordova-2.0.0)，并且我已将 cordova-2.0.0.js 与其他文件一起放在 assets/www 目录中，我已将 cordova-2.0.0.jar 放在引用的库中。我在 Android 清单和 config.xml 中添加了所需的代码。我制作了一个名为“storelocation.html”的 html 文件，我希望该文件获取用户的当前坐标并将其传递到 Google 地图中，这将使这些坐标位于地图的中心。我不确定这个文件中的代码有什么问题，有人可以检查一下我是否只是愚蠢吗？

```
<!DOCTYPE html "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>

<title>Device Properties Example</title>

<script type="text/javascript" charset="utf-8" src="cordova-2.0.0.js"></script>
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=AIzaSyBlNOgoh-8Xg9_OYqUUxReMJZk4syLFayM&sensor=true"type="text/javascript"></script>
<script type="text/javascript">

// Wait for Cordova to load

document.addEventListener("deviceready", onDeviceReady, false);

// Cordova is ready
//
function onDeviceReady() {
navigator.geolocation.getCurrentPosition(onSuccess, onError,         {enableHighAccuracy:true });
}

// onSuccess Geolocation
//
/* function onSuccess(position) {
    var element = document.getElementById('geolocation');
    element.innerHTML = 'Latitude: '           + position.coords.latitude              +   '<br />' +
                        'Longitude: '          + position.coords.longitude             + '<br />' +
                        'Altitude: '           + position.coords.altitude              + '<br />' +
                        'Accuracy: '           + position.coords.accuracy              + '<br />' +
                        'Altitude Accuracy: '  + position.coords.altitudeAccuracy      + '<br />' +
                        'Heading: '            + position.coords.heading               + '<br />' +
                        'Speed: '              + position.coords.speed                 + '<br />' +
                        'Timestamp: '          +                                   position.timestamp          + '<br />';
} 

// onError Callback receives a PositionError object
//
function onError(error) {
    alert('code: '    + error.code    + '\n' +
          'message: ' + error.message + '\n');
} */
            var element = document.getElementById('geolocation');

function initialize() {
if (GBrowserIsCompatible()) {
var map = new GMap2(document.getElementById("map_canvas"));
map.setCenter(new GLatLng(position.coords.latitude, position.coords.longitude), 13);
map.setUIToDefault();

}
}

</script>
</head>
<body onload="initialize()" onunload="GUnload()">
<div id="map_canvas" style="width: 500px; height: 300px"></div>
</body>
</html> 
```

提前非常感谢，如果你们中的一个天才可以帮助我，我真的很感激，我已经尝试了 2 天来看看出了什么问题。顺便说一句，找不到用户的坐标，找到它们的唯一方法（我发现）是使用 telnet 使用 geo fix，但我希望手机找到坐标而不是我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T06:46:44.990

请注意您使用的是 Google Api SDK 而不是 Android SDK。检查 eclipse 你的构建路径 => 配置构建路径 => 点击 Android 并选择例如 Google Api 2.3.3 / 10。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T10:21:45.523

您好，我基本上正在尝试与您相同的事情。谷歌地图上的地理位置与phonegap。

您能否澄清一下：“顺便说一句，找不到用户的坐标，找到它们的唯一方法（我发现）是使用 telnet 使用地理修复，但我希望手机找到坐标而不是我。”

一台电脑显然没有 GPS，所以要让它在你的模拟器上工作，你需要模拟（假）GPS 坐标。

您是否将谷歌地图添加到白名单权限？

链接到我的线程[电话间隙地理定位与谷歌地图](https://stackoverflow.com/questions/11688457/phone-gap-geolocation-with-google-maps) 虽然我正在使用其他代码，但我正在尝试完成相同的操作。

# asp.net - 在 SOAP 中导出实体引用的完整属性

> ID：11692177
> 
> 赞同：0
> 
> 时间：2012-07-27T16:47:20.033
> 
> 标签：asp.net, linq, web-services, entity-framework, soap

为什么在 SOAP 中，linq 不导出实体引用的完整属性，在此示例中仅导出 ImagesReference 的 EntityKeyMember 而没有导出 Images 实体的其他属性

```
<images_likes>
<EntityKey>
    <EntitySetName>Images_Likes</EntitySetName>
    <EntityContainerName>WiredinEntities</EntityContainerName>
    <EntityKeyValues>
        <EntityKeyMember>
        <Key>LikeId</Key>
        <Value xsi:type="xsd:int">96</Value>
        </EntityKeyMember>
    </EntityKeyValues>
</EntityKey>
<LikeId>96</LikeId>
<Date>2012-07-27T09:00:35.697</Date>
<ImagesReference>
    <EntityKey>
        <EntitySetName>Images</EntitySetName>
        <EntityContainerName>WiredinEntities</EntityContainerName>
        <EntityKeyValues>
            <EntityKeyMember>
            <Key>ImageId</Key>
            <Value xsi:type="xsd:int">26</Value>
            </EntityKeyMember>
        </EntityKeyValues>
    </EntityKey>
</ImagesReference> 
```

```
public static List<Images_Likes> GetLikes(int ImageId)
{
    using (WiredinEntities context = new WiredinEntities("name=WiredinEntities"))
    {
        var items = from item in context.Images_Likes.Include("Images")
                    where item.Images.ImageId == ImageId
                    select item;

        return items.ToList();
    }
} 
```

# javascript - 为什么 JSON.parse() 在尝试解析简单的 json 对象时会抛出 Uncaught SyntaxError: Unexpected token？

> ID：11692178
> 
> 赞同：1
> 
> 时间：2012-07-27T16:47:28.940
> 
> 标签：javascript, json

以下两行 javascript 代码导致 Uncaught SyntaxError：

```
 var testObj = JSON.parse('{ testFunc: function () { console.log("whoa there"); }}');

    testObj["testFunc"](); 
```

我不明白我的 json 字符串有什么无效之处。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T16:49:01.810

据我所知，这不是 JSON 字符串，而是由字符串文字保存的 javascript。就像 XML 一样，JSON 是一种跨多个平台表示数据的方法。请查看 JSON 的规范：

[http://www.json.org](http://www.json.org)

如果要传递实际是函数的值，则需要使用 javascript`eval`方法或者让 JSON 字符串值作为维护这些方法的对象的键。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T16:49:16.630

JSON 不允许内联函数定义……那是 JavaScript。

[http://json.org/](http://json.org/)

# keymando - keymando 1.2.2 是否支持 OSX 10.8 Mountain Lion？

> ID：11692181
> 
> 赞同：1
> 
> 时间：2012-07-27T16:47:52.327
> 
> 标签：keymando

刚刚在 OSX Mountain Lion 实例上安装了 Keymando 1.2.2 的试用版。似乎没有任何效果 - 我添加了简单的键映射，重新加载配置，确保启用 Keymando - 没有任何反应。

如果 1.2.2 在 Mountain Lion 上应该没问题，有没有人有任何调试提示？

**编辑**我应该清楚：我以前从未安装或使用过 Keymando，所以配置是安装中的基本配置。这是我添加的地图：

```
# Start Keymando at login
# -----------------------------------------------------------
start_at_login

# Disable Keymando when using these applications
# -----------------------------------------------------------
disable "Remote Desktop Connection"
# disable /VirtualBox/

# Basic mapping
# -----------------------------------------------------------
# map "<Ctrl-[>", "<Escape>"
# map "<Ctrl-m>", "<Ctrl-F2>"
map "<Ctrl-S>" { say "Keymando." }

# vi type movement, select
except /iTerm/, "MacVim" do
  map "<Ctrl-j>", "<Down>"
  map "<Ctrl-k>", "<Up>"
  map "<Ctrl-h>", "<Left>"
  map "<Ctrl-l>", "<Right>"
  map "<Ctrl-f>", "<PageUp>"
  map "<Ctrl-b>", "<PageDown>"

  map "<Ctrl-Shift-j>", "<Shift-Down>"
  map "<Ctrl-Shift-k>", "<Shift-Up>"
  map "<Ctrl-Shift-h>", "<Shift-Left>"
  map "<Ctrl-Shift-l>", "<Shift-Right>"

  # Right mouse click
  map "<Ctrl-r>" do
    right_click
    # alert(mouse_x)
  end

end

# Commands
# -----------------------------------------------------------

# Command launcher window via Cmd-Space
map "<Cmd- >" do                                                                                                                                                                                                         
  trigger_item_with(Commands.items, RunRegisteredCommand.new)                                                                                                                                                             
end 

# Register commands 
# -----------------------------------------------------------
command "Volume Up" do 
  `osascript -e 'set volume output volume (output volume of (get volume settings) + 7)'`
end

command "Volume Down" do 
  `osascript -e 'set volume output volume (output volume of (get volume settings) - 7)'`
end

# Repeat last command via Cmd-.
map "<Cmd-.>", RunLastCommand.instance 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T05:14:28.563

Keymando 1.2.3 修复了这个问题。

看：

*   [https://groups.google.com/forum/?fromgroups=#!topic/keymando/DuFYbAGxRFk](https://groups.google.com/forum/?fromgroups=#!topic/keymando/DuFYbAGxRFk)
*   [http://updates.keymando.com/](http://updates.keymando.com/)

# javascript - JavaScript 二维数组

> ID：11692183
> 
> 赞同：0
> 
> 时间：2012-07-27T16:48:05.550
> 
> 标签：javascript, multidimensional-array

我有 3 个数组

```
var city = [
  ['Kaunas', 54.896872,23.892426],
  ['Vilnius', 54.711136,25.280685],
  ['Klaipeda', 55.720149,21.131401],
  ['Utena', 55.536403,25.59494],
];

var lake = [
  ['Ezeras Bijote', 55.785092,23.062956],
  ['Ezeras Druksiai', 55.627996,26.565228],
  ['Ezeras Sartai', 55.804368,25.832863],
  ['Ezeras Metelys', 54.300299,23.767004],
];

var shop = [
  ['Kauno Akropolis', 54.891665,23.917744],
  ['Panorama', 54.709549,25.257454],
  ['Europa', 54.687514,25.262886],
  ['Ozas', 54.638628,25.135685],
]; 
```

我想将这 3 个数组添加到 1 个数组中，但不知道该怎么做，如果我可以像这样调用表单元素会非常好`bigArr[city][1]`，，`bigArr[shop][1]``bigArr[lake][1]`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T16:51:31.700

您可能对[compact()](http://phpjs.org/functions/compact:371)感兴趣。

或者，只需将其声明为一个对象：

```
var myObject = {
    city: [
        ....
    ],
    lake: [
        ....
    ],
    shop: [
        ....
    ]
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T16:52:13.723

您可能想要创建一个对象而不是多维数组 -

```
var bigArr = {
    "city": {
        Kaunas: {
            "lat": 54.896872,
            "lon": 23.892426 
        },
        Vilnius: {
            "lat": 54.711136,
            "lon": 25.280685
        },
        Klaipeda: {
            "lat": 55.720149,
            "lon": 21.131401
        },
        Utena: {
            "lat": 55.536403,
            "lon": 25.59494
        }
    },

    "lake": {
        ...
    },

    "shop": {
        ...
    }
} 
```

然后你可以使用它，比如`bigArr.city.Kaunas.lat`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T16:53:32.347

使用您已有的：

`var bigArr = {"city": city, "lake": lake, "shop": shop};`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-27T16:59:32.173

您应该使用对象而不是数组。您可以通过字符串键访问它们。将它们创建为文字：

```
var coordinates = {
    "city": {
        Kaunas:   [54.896872,23.892426],
        Vilnius:  [54.711136,25.280685],
        Klaipeda: [55.720149,21.131401],
        Utena:    [55.536403,25.59494]
    },
    "lake": {
        ...
    },
    "shop": {
        ...
    }
} 
```

然后使用[成员运算符](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Member_Operators)访问它们的属性：

*   点符号：`coordinates.shop`
*   括号符号：`coordinates["lake"]`

要获取 Utena 的坐标数组，您可以使用`coordinates.city["Utena"]`

# regex - 正则表达式——提取mailto：邮件地址

> ID：11692184
> 
> 赞同：1
> 
> 时间：2012-07-27T16:48:14.367
> 
> 标签：regex

例如：mailto:info@info.com?subjectsomething 或 mailto:info@info.com

我只想获取没有主题的电子邮件地址（如果有）

这个表达式是不够的，我不能让它工作：

```
mailto:(.*) 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T16:51:13.693

试试这个正则表达式：

```
mailto:([^\?]*) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T16:56:57.947

您需要将匹配的字符保存在捕获组中：

```
mailto:([^?]+) 
```

现在您的地址在 $1 中（或其他变量；取决于语言）。

如果可能在电子邮件地址之后出现其他内容，则必须指定分隔符。例如，如果是空格：

```
mailto:([^?\S]+)[\s?] 
```

你也可以使用非贪婪的 re：

```
mailto:(.+?)[\s?] 
```

这意味着“一遇到`\s`（空间）或`?`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T16:56:17.563

这将在单词边界内查找匹配的字符串。您需要使用您选择的语言从第一个带括号的子模式中获取电子邮件的值（通常对它的引用是 $1）。第二个子模式将捕获主题（以 ? 开头）。

```
\bmailto:(.*)(\?.*)?\b 
```

# macos - 在 Mac 上安装 Perl 模块 WWW::Mechanize

> ID：11692185
> 
> 赞同：2
> 
> 时间：2012-07-27T16:48:15.583
> 
> 标签：macos, perl, www-mechanize

我无法在 Mac OS X 上使用 CPAN 安装 perl 模块。你有什么想法或链接供我参考吗？谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T17:08:52.087

我强烈建议您安装[perlbrew](http://perlbrew.pl/)以创建一个本地环境，您可以在其中安全地从 CPAN 安装 Perl 模块，而无需破坏或担心标准 OS Perl。您还将获得当前 Perl 版本的好处，该版本远高于 MAC 的标准版本。

您将需要一个 C 编译环境“XCode 4”才能安装`perlbrew`. 您的安装盘或在线 Apple APP 商店提供这些。注册为 Apple Developer，您可以下载工具集。

# java - 获取网页的发布日期

> ID：11692189
> 
> 赞同：0
> 
> 时间：2012-07-27T16:48:38.797
> 
> 标签：java

您好，在 Google 中搜索时，我可以看到任何 URL 的发布日期。

我可以在 Android 中做点什么吗，我有 url 列表，我想获取这些 URL 的发布日期。

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T16:52:28.310

一种方法是将`HEAD`请求发送到 URL，然后查看`Last-Modified`响应的标头。请注意，尽管某些 Web 服务器可能不提供`LastModified`标头，在这种情况下您将无法确定此日期，但在大多数情况下您应该得到它。代码将如下所示：

```
HttpClient client = new DefaultHttpClient();  
String url = "http://example.com/getmethod.aspx?id=111&method=Test";
HttpHead req = new HttpHead(url);
HttpResponse resp = client.execute(req);  
String lastMod = resp.getFirtHeader("Last-Modified")
if(lastMod != null) {
    //parse this string to get a date
    //it will be in this format: Wed, 15 Nov 1995 04:58:08 GMT
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:08:08.220

我会看看 Apache HttpComponents。你可以在这里找到它：http: [//hc.apache.org/](http://hc.apache.org/)

编辑：您也可以使用 AndroidHttpClient。

# python - string.translate() 与 python 中的 unicode 数据

> ID：11692199
> 
> 赞同：24
> 
> 时间：2012-07-27T16:49:09.743
> 
> 标签：python, unicode, dictionary

我有 3 个将 json 数据返回到 3 个字典变量的 API。我正在从字典中获取一些值来处理它们。我阅读了我想要列出的特定值`valuelist`。其中一个步骤是从它们中删除标点符号。我通常`string.translate(None, string.punctuation)`用于此过程，但因为字典数据是 unicode 我收到错误：

```
 wordlist = [s.translate(None, string.punctuation)for s in valuelist]
TypeError: translate() takes exactly one argument (2 given) 
```

有没有解决的办法？通过编码 unicode 或替换`string.translate`?

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-27T18:50:26.113

translate 方法在 Unicode 对象上的工作方式与在字节字符串对象上的工作方式不同：

```
>>> 帮助（unicode.translate）

S.translate(table) -> unicode

返回字符串 S 的副本，其中所有字符都已映射
通过给定的转换表，它必须是
Unicode 序数到 Unicode 序数、Unicode 字符串或无。
未映射的字符保持不变。映射到无的字符
被删除。

```

所以你的例子会变成：

```
remove_punctuation_map = dict((ord(char), None) for char in string.punctuation)
word_list = [s.translate(remove_punctuation_map) for s in value_list] 
```

但是请注意，它`string.punctuation`仅包含 ASCII 标点符号。完整的 Unicode 有更多的标点符号，但这完全取决于您的用例。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-27T17:14:31.903

我注意到 string.translate 已被弃用。由于您要删除标点符号，而不是实际翻译字符，因此您可以使用 re.sub 函数。

```
 >>> import re

    >>> s1="this.is a.string, with; (punctuation)."
    >>> s1
    'this.is a.string, with; (punctuation).'
    >>> re.sub("[\.\t\,\:;\(\)\.]", "", s1, 0, 0)
    'thisis astring with punctuation'
    >>> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-01T11:12:57.093

在这个版本中你可以相对地给别人写信

```
def trans(to_translate):
    tabin = u'привет'
    tabout = u'тевирп'
    tabin = [ord(char) for char in tabin]
    translate_table = dict(zip(tabin, tabout))
    return to_translate.translate(translate_table) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-27T17:35:57.960

Python`re`模块允许使用[函数作为替换参数](https://docs.python.org/2/library/re.html#re.sub)，它应该接受一个`Match`对象并返回一个合适的替换。我们可以使用这个函数来构建一个自定义的字符翻译函数：

```
import re

def mk_replacer(oldchars, newchars):
    """A function to build a replacement function"""
    mapping = dict(zip(oldchars, newchars))
    def replacer(match):
        """A replacement function to pass to re.sub()"""
        return mapping.get(match.group(0), "")
    return replacer 
```

一个例子。匹配所有小写字母 ( `[a-z]`)，将 'h' 和 'i' 分别翻译成 'H' 和 'I'，删除其他匹配：

```
>>> re.sub("[a-z]", mk_replacer("hi", "HI"), "hail")
'HI' 
```

如您所见，它可能与短（不完整）替换集一起使用，并且可能用于删除某些字符。

一个 Unicode 示例：

```
>>> re.sub("[\W]", mk_replacer(u'\u0435\u0438\u043f\u0440\u0442\u0432', u"EIPRTV"), u'\u043f\u0440\u0438\u0432\u0435\u0442')
u'PRIVET' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-16T15:27:02.010

当我偶然发现同样的问题并且西蒙的回答是帮助我解决问题的答案时，我想展示一个更简单的例子来澄清一下：

```
from collections import defaultdict 
```

然后对于翻译，假设您要删除 '@' 和 '\r' 字符：

```
remove_chars_map = defaultdict()
remove_chars_map['@'] = None
remove_chars_map['\r'] = None

new_string = old_string.translate(remove_chars_map) 
```

还有一个例子：

> old_string = "word1@\r word2@\r word3@\r"
> 
> new_string = "word1 word2 word3"
> 
> '@' 和 '\r' 已删除

# networking - 网络设备上的 ROMMON 和 u-boot

> ID：11692201
> 
> 赞同：-1
> 
> 时间：2012-07-27T16:49:14.713
> 
> 标签：networking, bootloader, u-boot

网络设备中的rommon和u-boot有什么区别？我正在阅读一些设备文档，但我不太清楚有什么区别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T04:59:39.493

Rommon 是思科路由器设备的引导加载程序

而 U-boot 是一个非常通用的引导加载程序，适用于许多嵌入式设备

U-boot 和 Rommon 都支持 tftp

U-boot 支持`sntp nfs`而 Rommon 不支持

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:17:45.800

u-BOOT 可能不支持启动原始 vmlinux 映像，但 ROMMMON(rom on monitor) 支持加载和启动原始 vmlinux 映像。

# java - 在多显示器环境中将 JFrame 限制为单屏

> ID：11692206
> 
> 赞同：1
> 
> 时间：2012-07-27T16:49:38.683
> 
> 标签：java, applet, jframe, multiple-monitors

我正在开发一个网络小程序并遇到了问题。如果用户在多屏幕环境中使用 Windows 经典主题，并且表示用户尝试将 JFrame 从一个监视器移动到另一个 Java 将挂起。我一直无法找到解决此问题的方法，因此作为一种解决方法，我想看看是否有任何方法可以阻止用户将 JFrame 移动到不同的监视器。有没有办法限制窗口移动？

# python - 重新加载模块导致不同的结果

> ID：11692210
> 
> 赞同：1
> 
> 时间：2012-07-27T16:49:56.350
> 
> 标签：python, import, module, python-module

在测试期间，我向我的测试用例添加了一个重新加载命令，这样我就可以在几个不同的地方更改代码，而不必手动重新加载所有内容，我注意到重新加载似乎会影响测试结果。

这是我所做的：

```
import mymodule
import mymodule.rules as rules

def testcase():
    reload(mymodule)
    reload(rules)

    # The rest of the test case 
```

一切都像这样正常工作，或者当两次重新加载都被注释掉时，但是当我注释掉第二次重新加载时，测试的结果是不同的。在重新加载过程中是否发生了一些我不知道的事情，一旦重新加载模块，就需要重新加载模块中的所有脚本？还有其他解释吗？

我不确定这是否相关，但 rules 是包含此行的包内的单独脚本：

```
from mymodule import Rule 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T16:59:56.197

您问题中的信息相当模糊，您的术语也相当不标准。从

> rules 是 mymodule 中的一个单独脚本。

我推断它`mymodule`实际上是一个包，它似乎在导入时不会自动`rules`导入。这意味着执行后

```
import mymodule 
```

不会有`mymodule.rules`，但执行后

```
import mymodule.rules as rules 
```

该模块`rules`将被导入到`mymodule`. （旁注：后面的代码行通常写为`from mymodule import rules`。）

执行第一条语句后，您将获得一个不包含`reload()`的 frsh 副本- 这只会在第二条语句之后重新创建。`mymodule``mymodule.rules``reload()`

我不得不为这个答案做很多猜测，所以我可能弄错了。[从它的文档](http://docs.python.org/library/functions.html#reload)`reload()`中可以看出，该语句有很多微妙之处，因此最好仅在您非常熟悉 Python 的导入机制时使用它。

（另一个注意事项：如果`rule.py`位于 package 内`mymodule`，就像您的设置一样，您应该在那里使用相对导入。而不是

```
from mymodule import Rule 
```

你应该做

```
from . import Rule 
```

我还建议`from __future__ import absolute_import`使用更透明的导入规则。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T17:00:25.223

我不确定到底是什么导致了您的问题，但我认为您可能在滥用`reload()`.

根据[文档](http://docs.python.org/library/functions.html#reload)，`reload()`将

> 重新加载以前导入的模块。

但是，如果您在测试用例中运行它，则在导入模块和重新加载模块之间不会对模块进行任何更改，对吗？为了进行更改，我认为您必须在测试用例运行时更改这些文件，这可能不是一个好主意。

# ssl - SSL 丢失密码恢复

> ID：11692214
> 
> 赞同：1
> 
> 时间：2012-07-27T16:50:11.087
> 
> 标签：ssl, openssl

今天是星期五，我是一个绝望的系统管理员。我发出了一个 HTTPS 服务器的证书需求，经过一个多星期的漫长等待后才收到它，但是在处理我的请求时，我丢失了保护我的私钥的密码。

鉴于我拥有与密码共同生成的私钥和公钥（我当时就知道），是否有一种聪明的方法可以恢复丢失的密码。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:22:57.033

并不真地。这些保护的目的正是使恢复密码变得不可行。

如果密码不是太长，您可以尝试暴力破解...

您最好的选择可能是联系您的 CA 并要求他们重新颁发带有新 CSR 的证书。有些人可能允许在证书有效期内重新输入密钥而无需支付额外费用。

# java - 从 Logcat 打印最后 200 行

> ID：11692215
> 
> 赞同：0
> 
> 时间：2012-07-27T16:50:14.487
> 
> 标签：java, android

我正在尝试在我的应用程序中打印来自 Android Logcat 的最后 200 行左右。到目前为止，我已经能够使用 InputStreamReader 将 Logcat 放入 BufferedReader。问题是我不知道如何跳到缓冲阅读器的末尾然后向后阅读，或者跳到最后 200 行上方并从那里打印。我不想在阅读整个日志时使用蛮力方法。我希望有一个更优雅的解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:04:42.353

BufferedReader 不知道行的概念，只知道数据流。如果您不知道一条线有多长，您将很难找到跳转到（EOF - 200 行）的方法。

我建议在它之后填充一个 RingBuffer，存储 200 行，用最新的替换最旧的。这样 BufferedReader 会继续填充 ringBuffer 并使用它来读取。

另一种选择是每 200 行清除一次日志...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T13:59:50.420

所以这不是我正在寻找的解决方案，而是我想要的。而不是将日志放入 BufferedReader 中，然后将其整理出来并打印出来。我使用 logcat 标签来指定输出文件的大小。

```
Runtime.getRuntime.exec("logcat -r 160 -f mylog.log") 
```

然后读回文件。

# java - 如何在运行到可执行 jar 的码头嵌入式服务器中部署战争？

> ID：11692216
> 
> 赞同：1
> 
> 时间：2012-07-27T16:50:15.147
> 
> 标签：java, eclipse, jar, jetty, war

我想在嵌入式码头上部署一个战争文件，我们称之为 app.war。

所以最简单的代码是：

```
new WebAppContext(server, path, "/"); 
```

其中路径最终类似于“./dist/app.war”。从 Eclipse 运行时，它就像一个魅力，但当我想从我的项目的可运行 jar 中做同样的事情时，情况会变得更糟。

即使 jar 架构很好：

*   元信息
*   距离
    *   应用程序战争
*   ...

未找到该文件。我知道标准路径在运行 jar 文件时并不一致，但尝试使用“jar:file:.../project.jar!/dist/app.jar”并没有更好。这个问题有什么解决方案吗？谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:01:48.813

我将使用 uber 插件来制作可执行的 jar。使用 Maven，您可以简单地添加

```
<plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-shade-plugin</artifactId>
            <executions>
                <execution>
                    <phase>package</phase>
                    <goals>
                        <goal>shade</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <finalName>uber-${artifactId}-${version}</finalName>
            </configuration>
        </plugin> 
```

检查这里[http://maven.apache.org/plugins/maven-shade-plugin/](http://maven.apache.org/plugins/maven-shade-plugin/) 这将创建包含所有资源、类和依赖项的完全独立的 jar

# mysql - 为什么 sql-query 字段中的尾随空格会产生“错误”的结果？

> ID：11692219
> 
> 赞同：2
> 
> 时间：2012-07-27T16:50:36.740
> 
> 标签：mysql

假设，我们在 MySql 中有一个测试表：

```
CREATE TABLE `test_table` (
    `_id` INT(10) UNSIGNED NOT NULL,
    `testfield` TEXT NULL COLLATE 'utf8_unicode_ci',
    PRIMARY KEY (`_id`)
)
COLLATE='utf8_unicode_ci'
ENGINE=MyISAM; 
```

它包含一行：

```
INSERT INTO `test_table` (`testfield`) VALUES ('testValue'); 
```

然后当我做这个查询时：

```
SELECT * FROM `test_table` WHERE `testField` = 'testValue'; 
```

或这个：

```
SELECT * FROM `test_table` WHERE `testField` = 'testValue '; 
```

甚至这个：

```
SELECT * FROM `test_table` WHERE `testField` = 'testValue  '; 
```

我总是收到相同的结果，这是单行，但我只在第一种情况下想要这一行。

为什么mysql在末尾截断空格`'testVaue '`？主要问题是，我应该怎么做才能消除这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T16:55:48.670

我不知道为什么它会修剪 WHERE（它有什么意义？）。它可能与二进制文件等有关，因为您可以通过将`TEXT`字段设为二进制 ( `BLOB`) 来修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T16:56:07.980

这是记录在案的行为：[http](http://bugs.mysql.com/bug.php?id=5412) ://bugs.mysql.com/bug.php?id=5412 。出于比较目的，TEXT 字段被视为与 CHAR/VARCHAR 相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T17:01:34.693

当 MySQL 比较字符串时，它会修剪所有尾随空格（`'x ' = 'x'`为真）。
有关更多信息，请参阅[此问题](https://stackoverflow.com/questions/10495692/mysql-comparison-operator-spaces)。

# iphone - UITableView 单元格为空

> ID：11692230
> 
> 赞同：0
> 
> 时间：2012-07-27T16:51:24.377
> 
> 标签：iphone, objective-c, ipad, uitableview

我的 UITableView 有一个真正的问题，让我带您了解一下。

我的故事板中有一个 UITableViewController，它有四个不同的原型单元，每个单元都有自己的标识符。

然后我在我的课堂上有这个控制器：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"name";

    if (indexPath.section == 0) CellIdentifier = @"name";
    else if (indexPath.section == 1) CellIdentifier = @"name";
    else if (indexPath.section == 2 && indexPath.row == 0) CellIdentifier = @"segment";
    else if (indexPath.section == 2 && (indexPath.row == 1 || indexPath.row == 2 || indexPath.row == 3)) CellIdentifier = @"switch";
    else if (indexPath.section == 3) CellIdentifier = @"segment";
    else if (indexPath.section == 4) CellIdentifier = @"segment2";
    else if (indexPath.section == 5) CellIdentifier = @"name";
    else if (indexPath.section == 6) CellIdentifier = @"name";
    else if (indexPath.section == 7) CellIdentifier = @"name";

    GuestDetailCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil)
    {
        cell = [[GuestDetailCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    //Configure my cells here, like so:
    if (indexPath.section == 0)
    {
        cell.title.text = @"title";
    }
    else if (indexPath.section == 1)
    {

    }
    //etc

    return cell;
} 
```

我认为这就是我的问题所在，因为我已经成功使用了一些不同的代码（如果您可能需要查看它，我会添加这些代码，请告诉我。

表格中显示了正确数量的单元格和正确数量的部分，如果您选择一个单元格，它会将您带到正确的子视图控制器，但实际的单元格本身只是空白。为什么他们都可能返回零？

现在显示视图时，所有单元格都是空白的。`cell = [[GuestDetailCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];`这似乎被一遍又一遍地调用，与配置显示的我的单元格相反。

我通过调用此代码来获得此视图：

```
- (void)addNewGuest
{
    newGuestViewController *addGuestViewController = [[newGuestViewController alloc] initWithStyle:UITableViewStylePlain];
    addGuestViewController.delegate = self;

    //Create a new managed object context for the new guest -- set its persistent store coordinator to the same as that from the fetched results controller's context.
    NSManagedObjectContext *addingContext = [[NSManagedObjectContext alloc] init];
    self.addingManagedObjectContext = addingContext;

    [addingManagedObjectContext setPersistentStoreCoordinator:[[fetchedResultsController managedObjectContext] persistentStoreCoordinator]];

    addGuestViewController.guest = (GuestInfo *)[NSEntityDescription insertNewObjectForEntityForName:@"GuestInfo" inManagedObjectContext:addingContext];

    UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:addGuestViewController];

    [self.navigationController presentModalViewController:navController animated:YES];
} 
```

任何想法，或需要更多信息？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T01:07:11.627

这让我发疯了。在客户面前难倒了我。jrturton 的评论有我需要的答案。最初忽略了这个问题，因为它没有任何答案。发布 jrturton 的评论作为答案，这样它就不太可能被忽视。这是他的评论（答案）：

> 您必须在情节提要中设置与在代码中使用的相同的重用标识符。如果这样做，出队将始终返回一个单元格，而您永远不需要实例化一个单元格。

# wpf - WPF 路由事件，订阅自定义事件

> ID：11692231
> 
> 赞同：5
> 
> 时间：2012-07-27T16:51:27.953
> 
> 标签：wpf, routed-events

我试图让路由事件与将手动触发这些事件的子控件一起使用，它们将冒泡并在主网格级别进行处理。我基本上想做这样的事情：

```
<Grid Name="Root" WpfApplication5:SpecialEvent.Tap="Catcher_Tap">
    <Grid.RowDefinitions>
        <RowDefinition Height="40" />
        <RowDefinition Height="40" />
        <RowDefinition Height="*" />
    </Grid.RowDefinitions>
    <WpfApplication5:UserControl2 Grid.Row="0" x:Name="Catcher" />
    <WpfApplication5:UserControl1 Grid.Row="1" />
    <Frame Grid.Row="2" Source="Page1.xaml" />
</Grid> 
```

但是当我运行我的示例时，我在演示框架中得到一个空引用，应用程序永远不会初始化，它在尝试加载/初始化 XAML (InitializeComponent()) 时失败。这是包含该事件的小文件：

```
public class SpecialEvent
{
    public static readonly RoutedEvent TapEvent = EventManager.RegisterRoutedEvent(
        "Tap", RoutingStrategy.Direct, typeof(RoutedEventHandler), typeof(UserControl1));

    // Provide CLR accessors for the event
    public event RoutedEventHandler Tap;
} 
```

我基本上想复制 ButtonBase.Click 如何允许父母为他们的孩子订阅任何按钮 click() 方法的行为。但是，这似乎不适用于 ButtonBase.Click()。也就是说，当我将自定义切换`WpfApplication5:SpecialEvent.Tap="Catcher_Tap"`为`ButtonBase.Click="Catcher_Tap"`它时，它会起作用。任何想法为什么？ButtonBase 在做什么而我没有做什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T18:02:43.300

在玩了一些之后，我发现可以在主窗口后面的代码中完成我需要的东西，如下所示：

```
public MainWindow()
    {
        InitializeComponent();
        Root.AddHandler(SpecialEvent.TapEvent, new RoutedEventHandler(Catcher_Tap));
    } 
```

出于某种原因，像在 ButtonBase() 中那样在 XAML 中指定它*不起作用*，但`Handler`在后面的代码中添加它会起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-11T02:23:16.943

您提供的代码确实注册了一个自定义事件，但是，它没有注册*附加*的自定义事件。如果您想在事件中使用附加的语法，则必须显式实现`Add*Handler`and方法。`Remove*Handler`请参阅[此 MSDN 文章](http://msdn.microsoft.com/en-us/library/bb613550.aspx)中的“将您自己的附加事件定义为路由事件”部分。

# jquery - 带有acts_as_taggable_on的Jquery TokenInput不在搜索框中创建令牌

> ID：11692233
> 
> 赞同：0
> 
> 时间：2012-07-27T16:51:50.483
> 
> 标签：jquery, ruby-on-rails, jquery-tokeninput

我正在使用带有 Jquery TokenInput 的 Railsacts_as_taggable_on 插件，但是当输入标签并按下空格键（将分隔符更改为空格）时，不会创建令牌云。另外，我的 Json 输出文件看起来有点奇怪，它没有输出正确的数字 ID。

**JSON 输出**

```
{"id":"Funny","name":"Funny"},{"id":"Basketball","name":"Basketball"} 
```

**用户控制器**

```
 def tags 
  @tags = ActsAsTaggableOn::Tag.where("tags.name LIKE ?", "%#{params[:q]}%") 
  respond_to do |format|
    format.json { render :json => @tags.collect{|t| {:id => t.name, :name => t.name }}}
  end
end 
```

**用户模型**

```
class User < ActiveRecord::Base
   attr_accessible :name, :tag_list
   acts_as_taggable_on :tags
end 
```

**Javascript 文件**

```
$(function() {
  $("#user_tags").tokenInput("/users/tags.json", {
    prePopulate:       $("#user_tags").data("pre"),
    preventDuplicates: true,
    noResultsText:     "No results, needs to be created.",
    animateDropdown:   false
  });
}); 
```

**看法**

```
<h2>Enter new user:</h2>

<%= form_for @user do |f| %>

Name: <%= f.text_field :name %><br />
Tags: <%= f.text_field :tag_list,  :id => "user_tags",
                 "data-pre" => @user.tags.map(&:attributes).to_json %>

<%= f.submit %><br />
<% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T11:53:47.190

试着做

```
format.json { render :json => @tags} 
```

你也看不到将分隔符更改为空格..

# php - 使用 Facebook PHP SDK 传递变量

> ID：11692236
> 
> 赞同：-1
> 
> 时间：2012-07-27T16:52:21.480
> 
> 标签：php, facebook, sdk

我现在有这些代码：

```
$signed_request = $facebook->getSignedRequest();<br/>
$uid = $signed_request['app_data']; 
```

我正在使用 Facebook PHP SDK，但我似乎无法让它工作我的链接是

[https://www.facebook.com/xxxxxx?sk=app_1234567&app_data=uid%3Daaaaaaa](https://www.facebook.com/xxxxxx?sk=app_1234567&app_data=uid%3Daaaaaaa)

我正在尝试传递变量`uid=aaaaaaaaa`

但不工作。谁能帮忙？？？

我需要这些，因为我对每个用户图片都有一个带有不同 ID 的类似按钮，但我需要传递这些变量，所以当他们从类似链接返回我的页面时，我需要知道用户 ID 是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T16:45:45.977

我修复了，我必须页面，index.php 检测到用户是否喜欢该页面，所以在发送页面中变量没有通过，这就是它不起作用的原因

# c - 如何强制用户输入正整数？

> ID：11692238
> 
> 赞同：4
> 
> 时间：2012-07-27T16:52:26.067
> 
> 标签：c, command-line

强制用户输入一个正整数并将用户置于循环中，直到他们输入。

所以我想要所有内容，包括不允许超过 > 0 的字符

我尝试了以下方法：

```
while (i < 0) do { 
    printf("please input a number that's positive"); 
    scanf("%d", i); 
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-27T17:24:44.990

对于正整数，使用以下代码

```
int i;
do 
{ 
  printf("please input a number that's positive"); 
  scanf("%d", &i); 
}while (i < 0); 
```

c 语言不提供对用户输入的错误检查。用户应输入正确的数据类型。例如，如果用户在预期整数值时输入了字符，则程序可能会进入无限循环或异常中止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-02T19:26:08.083

这两个 while 函数都管理数字，int k 是设置的整数，只能设置为 20 以下，第一个 while 循环发出一个语句，如果数字大于 20，则调用另一个扫描，第二个循环打印 ak* k框。希望这可以帮助。

```
 int main ( )
{
int i, j,k;
printf("Please enter Box size:\n\n");
scanf("%d",&k);
while(k>20){
     printf("Please enter a value below 20\n\n");
     scanf("%d"),&k;
}
while(k<=20)
{
    for (i = 0; i < k; i++)
    {
        printf("\n");
        for (j = 0; j < k; j++)
        {
            printf("#");

        }
    }
     return 0;
}

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-06T15:24:06.377

我会这样做：声明`char term`和`int wrong = 0`.

```
do {
    printf("Enter a number: ");
    fflush(stdin);
    if (scanf("%d%c", &n, &term) != 2 || term != '\n' || n <= 0) {
        printf("Only positive numbers.\n");
        wrong = 1;
    }
    else {
        wrong = 0;
        //do something here if correct;
    }
} while (wrong); 
```

**如果用户混合输入了字符和数字或负数（和零），**上面的代码将检测到无效输入。

但是，它不会检测用户是否在前面输入了尾随零，然后是有效数字，例如。`001`或`00000738`。如果其他人可以解决这个问题，请在下面分享。谢谢！:)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-03-06T21:43:47.663

这是另一个函数的替代方案，它接受 a `char str[20]`（比如说，可能是 20 个元素），分析字符串以检查正整数，并相应地返回 a`0`或`1`。最后，使用 . 将该字符串转换为整数`atoi()`。

```
int checkPositiveIntegers(char str[]) {
    char *ptr = str;
    if (*ptr == '-' || *ptr == '0') //checks for negative numbers or zero
        return 1;
    else {
        do {
            if (isdigit(*ptr) == 0) { //checks for non-digit at ptr location; isdigit() returns 0 if non-digit
                return 1;
                break;
            }
            ptr++;
        } while (*ptr != '\0' && *ptr != '\n');
        return 0; //returns 0 if positive integer
    }
} 
```

`char str[]`所以该函数只接受从 1 到 9,999,999,999,999,999,999 的正数（如果包含 20 个元素，则最多 19 位）。

但是，如果将字符串转换回`int n = atoi(str);`，它可以达到的最大值将是 2,147,483,647，因为`n`它被声明为有符号整数。使用不同的数据类型进行探索。

希望这可以帮助！:)

# ios - 为什么 VM Tracker 是空的？

> ID：11692242
> 
> 赞同：10
> 
> 时间：2012-07-27T16:53:14.127
> 
> 标签：ios, memory, instruments

我正在使用分配模板在 iPhone 上分析我的应用程序，但 VM Tracker 始终为空。为什么？如何让它显示数据？

![在此处输入图像描述](../Images/7faab9d52938d47d8dc96529a7030ab0.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-27T16:58:08.507

您必须告诉它定期拍摄快照。在启动应用程序之前...

1.  单击 VM Tracker Instrument 以激活它。
2.  如果您还没有看到，请显示详细视图 (Command-D)。
3.  在左侧（蓝色）侧栏中，激活“自动快照”。
4.  跑。

或者，您可以选择在应用程序中有趣事件之前和之后手动拍摄快照。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-04-22T17:30:19.320

在 Xcode 10 中，此选项位于窗口底部，即“快照”按钮：

[![在此处输入图像描述](../Images/7fa26d73e568531e769cebfea82d3874.png)](https://i.stack.imgur.com/4LrTh.png)

# algorithm - 如何得到一个越来越细粒度的序列：1、16、8、4、12、...？

> ID：11692243
> 
> 赞同：2
> 
> 时间：2012-07-27T16:53:15.893
> 
> 标签：algorithm, recursion, breadth-first-search

如果有一个测试，需要将增量添加到特定值，则可以按以下顺序测试增量：1、2、3、... 15、16。

但是用越来越细的粒度来测试，delta可以是这样的序列：1,16,8,4,12,...（也就是我们尝试1和16，这是两种极端情况，然后我们尝试8 ，它是一个中间数字，然后是 4，它是 1 和 8 的中间，然后是 12，它是 8 和 16 的中间）。

如何优雅地生成这个序列而没有重复？

现在我在 Ruby 1.9.3 中有这个：

```
$deltas = []

def getMidPoint(a, b)
  return if (a - b).abs <= 1

  midPoint = ((a + b) / 2).to_i
  puts "a = #{a}, b = #{b}, midPoint = #{midPoint}"

  $deltas << midPoint
  getMidPoint(a, midPoint)
  getMidPoint(midPoint, b)
end

$deltas << 1
$deltas << 16
getMidPoint(1, 16)

p $deltas 
```

但结果是：

```
[1, 16, 8, 4, 2, 3, 6, 5, 7, 12, 10, 9, 11, 14, 13, 15] 
```

我实际上可以在数字上加一个“级别”（存储为元组）：所以对于 8，它是级别 2，对于 12，它也是级别 2（级别是递归级别），然后在最后，我可以收集1级，然后2级等的数字，以获得最终的数组，它应该可以工作，但是有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:10:24.633

您的算法的问题在于它会在进入“右侧”之前遍历整个“左侧”，因为在执行`getMidPoint(a, midPoint)`之前会导致许多递归`getMidPoint(midPoint, b)`。

一种可能的解决方案是使用队列。将调用排入队列，而不是直接调用这两个函数，并且始终调用队列中的第一个元素。

因此，在第一步中，您将输出 8 并获得队列 <1,8>、<8,16>，然后您将调用 <1,8>，输出 4。接下来您将获得 <8,16><1,4 ><4,8> 并且您将调用 <8,16> 并输出 12 并拥有队列 <1,4><4,8><8,12><12,16> 等等。

我认为它更接近您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T18:06:40.773

如果项目的数量不大（在我的实际情况下，它可以是 16 或最多 300），也就是说，如果时间复杂度不是问题，那么实际上可以通过越来越小的粒度来完成：

```
starting_value = 1
ending_value = 16
queue = [] << starting_value << ending_value

each_step = ((starting_value + ending_value) / 2).to_i
begin
  starting_value.step(ending_value, each_step) {|i| queue << i if not queue.include? i}
  each_step = (each_step / 2).to_i
end while each_step > 0

p queue 
```

结果是：

```
[1, 16, 9, 5, 13, 3, 7, 11, 15, 2, 4, 6, 8, 10, 12, 14] 
```

`queue.include?`可以做算法，但是如果用`O(n * n * log n)`一个哈希表来检查这个数字是否已经被添加，那么它就可以变成`O(n log n)`它的样子。

# c# - 我可以使用多个网格来占用同一个空间吗？

> ID：11692244
> 
> 赞同：0
> 
> 时间：2012-07-27T16:53:17.003
> 
> 标签：c#, wpf

我是 WPF 的新手，我正在计划一个桌面应用程序，它将为它提供的每个功能提供多个屏幕。每个“屏幕”将占据相同的空间，只是不同时。我可以使用选项卡控件，但想尝试不同的外观。我在想我可以创建多个网格，然后通过使用动画更改边距属性将它们移入和移出。

这可能吗？还是有更好的选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:00:59.300

我会使用某种父面板，然后将每个网格放在父面板的根部。然后，显示/隐藏每个都是设置可见性的简单问题。假设面板没有任何填充/边距，设置为拉伸的网格将占据整个屏幕。

# mysql - MySQL、c3p0 和 Apache Felix 集成

> ID：11692247
> 
> 赞同：0
> 
> 时间：2012-07-27T16:53:24.427
> 
> 标签：mysql, osgi, c3p0

我将 MySQL 集成到 Apache Felix 中。首先，我使用 bndtools 生成 MySQL bundle 和 c3p0 bundle。然后我将它们全部添加到我的 Apache Felix 环境中。我为连接池创建了一个类，如下所示：

```
    公共最终类 C3P0Manager {

        私有静态 C3P0Manager 实例；
        私有数据源池；

        私人 C3P0Manager() {
            // 当然，最好把所有的属性都放到一个配置文件中。
            // 我只是在这里列出它们以方便阅读。

            ComboPooledDataSource cpds = new ComboPooledDataSource();
            cpds.setDriverClass("com.mysql.jdbc.Driver"));
            cpds.setJdbcUrl("jdbc:mysql://localhost/my-database?autoReconnect=true&characterSetResults=UTF-8&characterEncoding=UTF-8&useUnicode=yes");
            cpds.setUser("用户");
            cpds.setPassword("密码");
            cpds.setInitialPoolSize(3);
            cpds.setMaxPoolSize(15);
            cpds.setMaxIdleTime(1800);
            cpds.setAutoCommitOnClose(true);
            汇集（cpds）；
        }

        公共静态 C3P0Manager 实例（）抛出异常 {
            如果（实例==空）{
                实例 = 新 C3P0Manager();
            }
            返回实例；
        }

        公共数据源 getPooled() 抛出 SQLException {
            归集归还；
        }
    }

```

如果我运行 JUnit 测试，它工作正常。但是在我的 Apache Felix 捆绑包上运行时失败，出现异常消息。在 Activator 类中的用法：

```
    Class.forName("com.mysql.jdbc.Driver");
    DataSource pooled = C3P0Manager.instance().getPooled();
    连接 con = pooled.getConnection();
    PreparedStatement stmt = null;
    结果集 rs = null;
    整数；

    尝试 {
        stmt = con.prepareStatement("SELECT count(*) FROM users", Statement.NO_GENERATED_KEYS);
        rs = stmt.executeQuery();
        如果（rs.next（））{
            总计 = rs.getInt(1);
        }
    } 捕捉（异常 e）{
        e.printStackTrace();
    } 最后 {
        尝试 {
            rs.close();
            stmt.close();
        } 捕捉（异常前）{
            ex.printStackTrace();
        }
    }
    System.out.println("总计 = " + 总计);

```

错误信息：

```
    java.sql.SQLException：无法从底层数据库获取连接！
        在 com.mchange.v2.sql.SqlUtils.toSQLException（SqlUtils.java:106）
        在 com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:529)
        在 com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:128)
    ...
    原因：com.mchange.v2.resourcepool.CannotAcquireResourceException：ResourcePool 无法从其主工厂或源获取资源。
        在 com.mchange.v2.resourcepool.BasicResourcePool.awaitAvailable(BasicResourcePool.java:1319)
        在 com.mchange.v2.resourcepool.BasicResourcePool.prelimCheckoutResource(BasicResourcePool.java:557)
        在 com.mchange.v2.resourcepool.BasicResourcePool.checkoutResource(BasicResourcePool.java:477)
        在 com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:525)
    ...

```

如果我只使用（没有 c3p0），MySQL 就可以工作：

```
    Class.forName("com.mysql.jdbc.Driver");
    连接 con = DriverManager.getConnection("jdbc:mysql://localhost/my-database?autoReconnect=true&characterSetResults=UTF-8&characterEncoding=UTF-8&useUnicode=yes","user","password");
    语句语句 = connect.createStatement();
    ResultSet resultSet = statement.executeQuery("SELECT count(*) FROM users");

```

所以我认为问题是由于c3p0。请帮我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T03:36:02.063

我懒得修改 c3p0 源代码并再次构建新的 c3p0 捆绑版本:)。所以我尝试使用 Apache DBCP 包：

```
org.apache.servicemix.bundles.commons-pool-1.5.4
org.apache.servicemix.bundles.commons-dbcp-1.4.0
(dbcp needs pool to work) 
```

可以对 MySQL 数据库进行 CRUD。

如果有人想使用这些捆绑包，它们是：

```
http://mvnrepository.com/artifact/org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-pool
http://mvnrepository.com/artifact/org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-dbcp 
```

当我有时间时，如果有人已经为它构建了一个捆绑包，我会看看bonecp。或者修改 c3p0 来使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-29T07:16:30.030

在 OSGi 中这样工作（使用 Java EE 模式）会让你陷入很多痛苦，因为许多 Java EE 模式都是反模块化的，它们需要对类路径的深入可见性。由于 OSGi 具有很强的模块化，这不能很好地工作，需要像 Context Classloader 和其他容易出错的东西，最终通常不起作用。OSGi µservices 被发明来以模块化和更优雅的方式处理此类问题。

OSGi-JDBC 规范（第 125 章）指定了如何在 µservice 世界中使用 JDBC：驱动程序包应该注册一个[org.osgi.service.jdbc.DataSourceFactory](http://www.osgi.org/javadoc/r4v42/org/osgi/service/jdbc/DataSourceFactory.html)服务。使用此服务，创建您的池化数据源是微不足道的。我从经验中知道 H2 数据库是开箱即用的（感谢 H2 的家伙！很棒的产品）。幸运的是，[Ops4j 这里有一个项目](https://ops4j1.jira.com/wiki/display/PAXJDBC/Documentation)，为 MySql 提供了一个适配器。由于 MySql 不是作为 OSGi 捆绑包提供的标准，您可能会[在这里查看](http://jpm4j.org/#!/p/com.mysql.jdbc/com.springsource.com.mysql.jdbc)

因此，在安装 MySql Driver 和 PAX JDBC MySql Adapter 之后，您现在可以以真正模块化的方式使用 DataSource：

```
@Component
public class DataSourceDemo {
   DataSource ds;

   @Activate
   void start() {
       Connection con = ds.getConnection();
       PreparedStatement stmt = con.prepareStatement("SELECT count(*) FROM users", Statement.NO_GENERATED_KEYS);
       ResultSet rs = stmt.executeQuery();
       if (rs.next()) {
        System.out.println(rs.getInt(1));
       }
   }

   @Reference
   void setDataSourceFactory( DataSourceFactory dsf ) throws Exception {
     ds = dsf.createDataSource();
   }
} 
```

请注意，这还如何从您的代码、单例、静态（全局变量）和动态类加载中删除 MySql 依赖项。当然，如果您生成依赖于 MySQL 的 SQL，您可以明确说明这一点。你要么使用`@Reference`这样的：

```
 @Reference(target="(osgi.jdbc.driver.name=mysql)") 
```

或者，更好的是，您允许应用程序的部署者使用配置管理员进行设置。只需将 DataSourceFactory.target 属性设置为“(osgi.jdbc.driver.name=mysql)”，这允许您动态连接服务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T17:17:34.357

请检查您的日志。在您在上面显示的异常之前，c3p0 将记录堆栈跟踪，详细说明至少一次尝试从数据库获取连接的失败。如果您将日志记录级别设置为 FINE（如果您需要特定的记录器，请使用 com.mchange.v2.resourcepool.BasicResourcePool），您将看到记录的每次失败尝试。如果您将日志级别保留在常规 INFO（或 WARN），您将只看到“一轮”失败尝试中的最后一次失败尝试（默认情况下 30 次失败尝试，重试延迟为 1 秒）。如果您一直在 INFO 上登录，您应该已经能够在您的日志中找到这些异常。

# android - 安装应用程序时出错

> ID：11692249
> 
> 赞同：0
> 
> 时间：2012-07-27T16:53:35.563
> 
> 标签：android

我已经提出申请。我使用了 google API target 4.0，但是当我运行活动时，而不是安装它给了我错误。我也杀死了服务器然后启动它，但我仍然遇到同样的错误。

```
installation error: install_failed_missing_shared_library 
```

# android - 如何读取文本文件并更改奇数行和偶数行的颜色和字体大小

> ID：11692252
> 
> 赞同：0
> 
> 时间：2012-07-27T16:53:50.323
> 
> 标签：android, textview

以上帝的名义

你好，我有一个文本文件，想要读取并显示到 textview 中，奇数行和偶数行使用不同的字体和颜色，如何更改此读取代码：

代码 ：

```
File sdcard = Environment.getExternalStorageDirectory();
File file = new File(sdcard,"komeil.txt");

    StringBuilder text = new StringBuilder();

    try {
        BufferedReader br = new BufferedReader(new FileReader(file));
        String line;

        text.append('\n');

        while ((line = br.readLine()) != null) {
            text.append(line);
            text.append('\n');

        }
    }
    catch (IOException e) {
        //You'll need to add proper error handling here
    } 
```

像这个文本文件：

文件 ：

```
hello people i am student //black
i want to rad this file   //green
different color           //black
different font            //green
how to do this            //black
...                       //green
...                       //black
.                         //green
.                         //black
.                         //green 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T09:43:28.280

这在 textview 中是不可能的，因为 textview 只接受一种颜色。为此，您必须使用 webview，创建带有不同颜色线条的 html 页面

# google-maps - 如何使用谷歌地图 api 搜索邮政编码给定半径内的所有点？

> ID：11692253
> 
> 赞同：1
> 
> 时间：2012-07-27T16:53:56.563
> 
> 标签：google-maps, google-maps-api-3

Google Maps API 有没有办法让我可以在某个邮政编码的给定半径（以英里为单位）内找到所有红色气球点（固定在我的谷歌地图上的地址）？

例如...

*   第一个输入框要求您输入邮政编码。输入它。

*   第二个输入框（带有 < options > 的部分框）询问您以英里、10 英里、20 英里、30 英里等为单位的半径

*   然后你点击提交

*   然后谷歌地图将所有地址（从 json 文件中存储）显示在红色气球中的谷歌地图上。

网络上是否有免费的学习材料可以帮助我构建这样的东西？

我整个早上都在阅读 google maps api 的东西，但没有找到任何可以提供这个的例子。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:33:17.267

当您只想要一个近似值和一个快速的结果时，您还可以尝试空间填充曲线，即空间索引。以 xkcd 漫画中的互联网地图为例。它使用希尔伯特曲线从互联网上打印地图。然后您可以使用曲线来转换地理位置并放宽最近邻搜索。许多具有点数据类型和空间索引的数据库引擎都使用相同的曲线。

在这里，您有一个 javascript 希尔伯特曲线：[https](https://github.com/chrisdew/jshilbert) ://github.com/chrisdew/jshilbert 。这里有一篇关于空间索引的博客：http: [//blog.notdot.net/2009/11/Damn-Cool-Algorithms-Spatial-indexing-with-Quadtrees-and-Hilbert-Curves](http://blog.notdot.net/2009/11/Damn-Cool-Algorithms-Spatial-indexing-with-Quadtrees-and-Hilbert-Curves)。我写了一个 php 类 hilbert-curve@phpclasses.org。它还使用墨卡托投影。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T17:57:48.497

以下是实现此功能需要遵循的两个高级步骤：

1) 您想使用 Google Geocoder API 将该邮政编码（或许多不同形式的地址！）转换为纬度和经度坐标。

2) 根据用户输入的距离（5 英里、10 英里等）动态创建对查询数据库的脚本的 GET 请求，如下所示：

```
var searchUrl = 'phpsqlajax_search.php?lat=' + center.lat() + '&lng=' + center.lng() + '&radius=' + radius; 
```

查看我对这个相关问题的回答，以便您可以接受用户输入并对地址进行地理编码：[商店定位，如何使用/输入我的位置？](https://stackoverflow.com/questions/11663765/store-locatore-how-to-use-input-my-postion/11674732#11674732)

Google Maps API 提供了有关在数据库中查找与某个纬度和经度坐标最近的项目的大量文档。可以在这里找到：[https ://developers.google.com/maps/articles/phpsqlsearch_v3](https://developers.google.com/maps/articles/phpsqlsearch_v3)

注意：文档使用 PHP、Javascript 和 MySQL。

# java - 二维形状的可点击数组

> ID：11692256
> 
> 赞同：0
> 
> 时间：2012-07-27T16:54:11.320
> 
> 标签：java, arrays, graphics

我有一个二维对象数组，我想让这些对象可点击，在鼠标点击时它必须在数组中返回自己的索引，然后我想改变点击对象的颜色。假设我怎么做，我真的需要建议:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T16:59:05.037

鼠标点击

*   遍历数组并查看单击的 (X,Y) 是否与形状 oooorrrr 相交...

*   如果形状索引说明了它的位置，那么您可以根据鼠标的 X、Y 来计算它，而不是检查碰撞（例如，640x480 res 上的 5x5 网格意味着每个正方形都是 128x96px 大，因此您可以获得正方形

    ```
    indexX = mouse.getX() / square.getWidth();
    indexY = mouse.getY() / square.getHeight();
    printLocationAndChangeColor(squares[indexX][indexY]); 
    ```

printLocationAndChangeColor() 回调将打印它的参数（x，y 坐标）并将参数的颜色更改为您想要的任何颜色。

# jquery - jQuery 中 $(this) 的意外作用域使用 each 和函数

> ID：11692257
> 
> 赞同：2
> 
> 时间：2012-07-27T16:54:11.410
> 
> 标签：jquery, scope

当我执行以下代码时，我希望相同的元素 id 会被警告两次，但相反，第一个是正确的，而第二个总是显示集合中第一个元素的名称。

```
$("div.someClass").each(function (index) {
  $(this).click(function () {
    alert($(this).attr("id")); // Here i get the actually clicked element
    $.when($("div.someClass").animate({ }, 0)).then(function () {
      alert($(this).attr("id")); // Here i get the first element in of that class
    });
  });
}); 
```

为什么会这样？如何解决？我尝试将元素的名称传递给函数，但它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T17:00:19.053

的值`this`会在每次函数调用时自动更改。因此，除非多个函数调用合谋通过传入某个特定值来故意保留`this`它，然后在调用回调之前使用`.apply()`或`.call()`设置它，否则它会有所不同。Javascript 遵循以下规则：

*   如果您进行方法调用，则 的值将`this`设置为其方法所在的对象。
*   如果进行普通函数调用，`this`则设置为全局对象（通常`window`）。
*   如果使用`fn.apply()`or `fn.call()`，则`this`根据第一个参数设置。

最简单的解决方案是将 的值保存`this`在局部变量中，然后引用它。

```
$("div.someClass").each(function (index) {
  var self = $(this);
  self.click(function () {
    alert(self.attr("id")); // Here i get the actually clicked element
    $.when($("div.someClass").animate({ }, 0)).then(function () {
      alert(self.attr("id")); // Here i get the first element in of that class
    });
  });
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-27T16:56:03.207

例如保存`$(this)`一些变量，`that`然后在`animate`

```
$("div.someClass").each(function (index) {
  $(this).click(function () {
    alert($(this).attr("id")); // Here i get the actually clicked element
    var that = $(this);
    $.when($("div.someClass").animate({ }, 0)).then(function () {           
      alert(that.attr("id")); // Here i get the first element in of that class
      alert($(this).attr("id")); 
    });
  });
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-27T17:01:50.743

您需要访问每个函数的元素：http: [//api.jquery.com/each/](http://api.jquery.com/each/)

```
$("div.someClass").each(function (index, element) {
  $(element).click(function () {
    var $this = $(this);
    alert($this.attr("id")); // Here i get the actually clicked element
    $.when($("div.someClass").animate({ }, 0)).then(function () {
      alert($this.attr("id")); // Here i get the first element in of that class
    });
  });
}); 
```

还有助于阅读“this”的含义：[https](https://developer.mozilla.org/en/JavaScript/Reference/Operators/this) ://developer.mozilla.org/en/JavaScript/Reference/Operators/this jQuery 可能会混淆您对“this”应该是什么的理解与所有上下文的变化它用于事件处理。

# iphone - 未调用委托方法 didReceiveAuthenticationChallenge

> ID：11692259
> 
> 赞同：0
> 
> 时间：2012-07-27T16:54:16.780
> 
> 标签：iphone, ipad

```
 - (BOOL)connection:(NSURLConnection *)connection canAuthenticateAgainstProtectionSpace:(NSURLProtectionSpace *)protectionSpace {

            return [protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust];
        }

       - (void)connection:(NSURLConnection *)connection didReceiveAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge {

        NSLog(@"got auth challange");
        NSURLCredential *newCredential;
        newCredential=[NSURLCredential credentialWithUser:    (NSString*)@"company//A1234"    
password:(NSString*)@"apple@999"
persistence:NSURLCredentialPersistencePermanent];
   [[challenge  sender] useCredential:newCredential     forAuthenticationChallenge:challenge];

        NSLog(@"Auth error: %@",[[challenge  error] description]);
        NSLog(@"Failure count:%d",[challenge previousFailureCount]); 
        }
        //- (id)initWithProxyHost:(NSString *)host port:(NSInteger)port type:(NSString *)type realm:(NSString *)realm  authenticationMethod:(NSString *)authenticationMethod{
        //    
        //    return self;
        //} 
```

我使用这种方法从代理网络访问公共 url，但它的委托`didReceiveAuthenticationChallenge`没有被调用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T15:02:38.973

```
 - (BOOL)connection:(NSURLConnection *)connection canAuthenticateAgainstProtectionSpace:(NSURLProtectionSpace *)protectionSpace {

        return YES;
    } 
```

然后它会调用！

# javascript - 为什么我的下拉菜单在我的本地服务器上工作，但当我推送到 heroku 时却不行？

> ID：11692260
> 
> 赞同：0
> 
> 时间：2012-07-27T16:54:25.363
> 
> 标签：javascript, css, ruby-on-rails, drop-down-menu, twitter-bootstrap

当我在本地测试我的网站时，它工作正常，但是一旦我推送到 heroku，下拉菜单就不起作用。

我的 application.js 文件包含以下内容：

```
 //= require bootstrap
    //= require jquery
    //= require jquery_ujs
    //= require_tree . 
```

我的 application.html.erb 文件包含这个

```
<!DOCTYPE html>
<html>
<head>
    <title> <%= full_title(yield(:title)) %> </title>
    <%= stylesheet_link_tag    "application", :media => "all" %>
    <%= javascript_include_tag "application" %>
    <%= csrf_meta_tags %>
    <%= render 'layouts/shim' %>
</head>

<body>
    <%= render 'layouts/header' %>  
    <div class="container">
        <%= yield %>
    </div>
</body>
</html> 
```

我的标题部分是下拉菜单所在的位置，包含这个

```
<header class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <ul class="nav pull-left">
        <li>
      <%= link_to image_tag("WML_header2.png", :alt => 'Wheres My Lan'), home_path%> 
        </li>
      </ul>
      <nav>
        <ul class="nav pull-right">
            </br>
            <li><%= link_to "Heat Map",  heatMap_path %></li>
            <% if signed_in? %>
            <li><%= link_to "New Update",  new_message_path %></li>

            <li id="fat-menu" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                View <b class="caret"></b>
              </a>
          <ul class="dropdown-menu">
            <li><%= link_to "Users", users_path %></li>
            <li><%= link_to "Reports", reports_path %></li>
            <li><%= link_to "Statistics", stats_path %></li>
          </ul>
        </li>

        <li id="fat-menu" class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">
            Account <b class="caret"></b>
          </a>
              <ul class="dropdown-menu">
                <li><%= link_to "Profile", current_user %></li>
                <li><%= link_to "Settings", settings_path %></li>
                <li class="divider"></li>
                <li>
                  <%= link_to "Sign out", signout_path, method: "delete" %>
                </li>
              </ul>
            </li>
          <% else %>
            <li><%= link_to "Admin sign in", signin_path %></li>

          <% end %>
          <li><%= link_to "About",  about_path %></li>
          <li><%= link_to "Contact", contact_path %></li>
        </ul>
      </nav>
    </div>
  </div>
</header> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T18:08:13.120

检查 jQuery 加载的顺序。jQuery“首先”，所有其他插件都在后面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T16:58:37.790

生成的 HTML 是什么？Chrome 的开发者工具栏是否报告了任何错误？

我猜它期望在某个位置有一个 javascript 文件，但在那里看不到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T16:14:25.793

`//=require bootstrap`之后你有没有尝试过移动`//= require jquery`？这解决了我的类似问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-18T16:31:19.920

我遇到了类似的问题，Paolo del Mundo 的建议帮助我找到了我做错的地方。我在 Google Chrome 中查看了 HTML，发现出现了几个错误：

*   加载资源失败：服务器响应状态为 404（未找到）

我对那个错误进行了 StackOverflow 搜索，嘿，你猜怎么着？原来我忘了在 config/environments/production.rb 中设置“config.assets.compile = true”。

/Picardfacepalm

我设置了它，添加/提交/推送到 Git，推送到 Heroku，刷新 Heroku 页面——宇宙中一切都很好。

# ios - Core Data 创建的 SQLite 文件没有显示模式

> ID：11692261
> 
> 赞同：0
> 
> 时间：2012-07-27T16:54:28.510
> 
> 标签：ios, sqlite, core-data

我已经使用主/详细模板创建了一个新的 iOS 项目。插入的列表条目存储在应用程序重新启动之间，因此创建的 SQLite 数据库中必须有架构和数据。但无论我插入多少项目，该文件 ( `~/Library/Application Support/iPhone Simulator/5.1/Applications/<GUID>/Documents/listtest.sqlite`) 保持原始大小并且没有模式（使用`.schema`sqlite3 的命令）。

那么实际的数据库在哪里呢？

# ssl - 密码学中有哪些不同的证书类型和格式

> ID：11692263
> 
> 赞同：8
> 
> 时间：2012-07-27T16:54:36.160
> 
> 标签：ssl, certificate, base64, pem, der

我们正在为我们的一位客户添加 SSL 握手中的服务器证书验证。作为密码学和 C 世界的新手，我想我首先要弄清楚我对这些东西的概念，然后再开始实施。

所以，我在 Google 上搜索了很多，主要是为了寻找证书概念，但无法更好地清理我的概念，让我更满意。实际上它增加了更多的混乱。:)

这里有一些我几乎不明白的东西： 1.什么是base64格式？它和DER一样吗？2\. PEM文件总是包含base64内容？3\. Windows 证书存储使用什么格式？是二进制的吗？

有人可以在这里帮助我吗？如果这些事情为我清除，将非常感谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-27T17:18:03.740

X.509 证书的结构是使用[ASN.1](http://en.wikipedia.org/wiki/ASN.1)定义的。[以下是X.509 证书](https://www.rfc-editor.org/rfc/rfc5280#section-4.1)的整体结构定义的摘录：

> ```
> Certificate  ::=  SEQUENCE  {
>     tbsCertificate       TBSCertificate,
>     signatureAlgorithm   AlgorithmIdentifier,
>     signatureValue       BIT STRING  }
> 
> TBSCertificate  ::=  SEQUENCE  {
>     version         [0]  EXPLICIT Version DEFAULT v1,
>     serialNumber         CertificateSerialNumber,
>     signature            AlgorithmIdentifier,
>     issuer               Name,
>     validity             Validity,
>     subject              Name,
>     subjectPublicKeyInfo SubjectPublicKeyInfo,
>     issuerUniqueID  [1]  IMPLICIT UniqueIdentifier OPTIONAL,
>                          -- If present, version MUST be v2 or v3
>     subjectUniqueID [2]  IMPLICIT UniqueIdentifier OPTIONAL,
>                          -- If present, version MUST be v2 or v3
>     extensions      [3]  EXPLICIT Extensions OPTIONAL
>                          -- If present, version MUST be v3
>     } 
> ```

[使用DER](http://en.wikipedia.org/wiki/Distinguished_Encoding_Rules)格式（一种二进制格式）`Certificate`对值（填充了包含的值）进行编码。

[Base64](http://en.wikipedia.org/wiki/Base64)是一种将二进制序列编码为文本的通用方法，通过减少用于可读 ASCII 字符的字节集（因此这种表示形式更长）。

PEM 格式的证书是证书的 DER 编码的 Base64 编码，每个 64 字符块的末尾有一个换行符，放置在分隔符之间：

```
-----BEGIN CERTIFICATE-----
MIIB2zCCAUSgAwIBAwIBADANBgkqhkiG9w0BAQQFADAYMRYwFAYDVQQDEw1OZXRn
...
-----END CERTIFICATE----- 
```

您还可以拥有 PEM 格式的私钥，例如，在这种情况下，分隔符将是`-----BEGIN RSA PRIVATE KEY-----`（并且匹配`END`）。

在网络上，在 TLS 连接期间，使用 DER。

Windows 证书存储在内部使用什么并不重要，它应该能够导入/导出 DER 或 PEM/Base64 证书。

* * *

证书“类型”是比 DER/base64 格式更广泛的主题。大多数用于 SSL/TLS 的证书都是 X.509 证书。然后你会得到使用配置文件。最常见的是[*Internet X.509 公钥基础设施证书和证书撤销列表 (CRL) 配置文件*](https://www.rfc-editor.org/rfc/rfc5280)，它基本上定义了证书颁发机构应如何颁发证书以及实体应如何验证远程证书。

您可能还对这些问题感兴趣：

*   [数字证书被“签名”是什么意思？](https://security.stackexchange.com/q/16595/2435)
*   [SSL 证书旨在证明什么，它是如何做到的？](https://security.stackexchange.com/q/6737/2435)

更一般地说，买一本关于 PKI 的书应该会有所帮助。

# c# - 在 C# 中报告每个时间间隔的操作

> ID：11692268
> 
> 赞同：0
> 
> 时间：2012-07-27T16:54:47.703
> 
> 标签：c#, time-series

我有一系列事件，在高峰时间可能每秒数百个。我希望能够跟踪和报告每个时间间隔的事件数（例如过去 5 分钟、最后一小时、过去 24 小时、过去 7 天）。在 C# 中跟踪此类数据的一些选项是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:54:23.830

考虑到到目前为止我所知道的所有问题，我将简单地分别用整数变量或长变量来计算接收到的事件的数量。

要在没有手头项目时间戳的情况下计算特定时间段内的事件，您必须先确定时间粒度并根据结果时间范围跟踪传入事件。要测量经过的时间，您可以使用并发线程。

这意味着如果您决定 5 分钟的粒度，您将不得不实现一个维护一个计数器的线程。此计数器在每个传入事件时递增。每隔 5 分钟，线程会将当前计数器存储在一个列表中并将其重置为 0。比如说 60 分钟后，您将拥有一个包含 12 个项目的列表，反映收到的消息数量。使用该列表，您可以处理以下查询

*   前 5 分钟有多少事件？
*   前 10 分钟有多少活动？
*   接收 15 分钟后 5 分钟内有多少事件。
*   ...

从那时起，只需解释随时间收集并存储到列表中的计数器。

* * *

**另一方面**，如果您希望能够查询任何粒度的时间间隔（意味着后验决定您想知道收到多少事件的时间间隔），我认为您别无选择来维护数据结构带有时间戳。

因此，对于每一个事件，您都必须存储它收到的时间，以便回答上述查询。如果您每秒收到数百个事件，那可能不是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T11:46:14.693

我建议为事件分配时间戳。我想你会继续以任何方式处理这些事件。因此，您可能会以某种方式存储事件和/或其数据。只需通过时间戳成员扩展数据结构并在事件发生时添加时间戳。这样，您可以在稍后的某个时间点在您的代码中的某个时间点构建您的“传入”统计信息。您可以简单地评估在特定时间范围内发生了哪些事件。

作为合理时间戳的来源，我建议使用`GetSystemTimeAsFileTime()`API。当您的最大事件速率高达每秒几百个时，这应该能够提供唯一值。然而，当时间戳的目的仅仅是为了说明它们落在哪个时间范围内时，时间戳不必具有唯一值。当需要更高的分辨率时，查看`QueryPerformanceCounter()`API 可能会有所帮助。此处描述的两个 API 的组合可以导致时间戳分辨率**和**几微秒的精度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-28T11:52:07.050

根据问题描述，我假设您想要监控系统性能、负载和吞吐量。如果是这样，我想您可以为此使用 WMI。

很抱歉我无法提供更详细的信息，但我认为您可以从这里开始：http: [//msdn.microsoft.com/en-us/library/ms186147%28v=vs.80%29](http://msdn.microsoft.com/en-us/library/ms186147%28v=vs.80%29)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-27T17:02:20.627

您在这里有一个两阶段的问题 - 记录事件并呈现它们。如果您跟踪上个月的所有事件，您可以选择仅显示过去 5 分钟、过去 7 天内发生的事件，或者甚至更复杂的事件，例如“12 天凌晨 1 点到下午 3 点之间的所有事件”前”。

可以在[此处](http://www.dotnetlogging.com/)找到 .NET 的一些日志记录选项。祝你的问题好运！

# php - PHP - 使用 mod_rewrite 的 Facebook Canvas 应用程序上的身份验证问题

> ID：11692269
> 
> 赞同：0
> 
> 时间：2012-07-27T16:54:55.990
> 
> 标签：php, facebook, mod-rewrite, facebook-canvas

我有一个使用 id 的 Facebook Canvas 应用程序 ?id= 并且我想让网址看起来更好一些，所以我将它添加到我的 htaccess 文件中。

```
RewriteEngine On

RewriteRule ^u(.*?)\.php$ index.php?id=$1 
```

这是 facebook 的登录网址

```
$facebook->getLoginUrl(array('canvas' => 1, 'scope' => 'permissions', 'redirect_uri' => 'http://domain.com/u'.$id.'.php')); 
```

所以它在认证后转到u123456789.php。现在我的问题是 $facebook->getUser(); 即使用户已通过身份验证并由于该重定向而允许该应用程序，也始终返回 0。

如果我在验证后重定向到 index.php，它工作正常。

我认为这是由会话或其他原因引起的。有什么解决方案可以让它工作吗？

提前致谢

# symfony - 蛞蝓中的 Doctrine2 自定义唯一性

> ID：11692274
> 
> 赞同：0
> 
> 时间：2012-07-27T16:55:14.680
> 
> 标签：symfony, doctrine-orm, unique, slug

我正在尝试为名为 Page 的实体制作独特的 url slug。slug 应该只在与站点相关的页面上是唯一的。

因此，页面 {site1.com/about、site2.com/about} 的 url slug 足以识别页面。在所有网站上拥有唯一的页面将没有吸引力：site3.com/about-21 很奇怪。

我试图用 DoctrineExtensions sluggable 来做到这一点，但得到了[写](https://github.com/l3pp4rd/DoctrineExtensions/issues/410)一些自定义的建议。下面是我的第一次尝试。因为我无法在 Entity 中获取 EntityManager，所以我无法让其他 slug 检查它们是否是唯一的。

有什么建议么？

```
/** 
 * Slugify Title.  To "re-slugify", set titleSlug to empty
 * @ORM\PrePersist
 */
public function slugifyTitle($override = false) {
  // We only slugify is titleSlug is empty
  if (empty($this->titleSlug) or $override) {

    if (!empty($this->title)) {
      // Title not empty?  slugify the title.  SluggableListener line 220
      $slug = Urlizer::transliterate($this->title);
    } else {
      // Title empty?  make a slug based on the classname
      $slug = get_class($this);
    }
    $this->titleSlug = Urlizer::urlize($slug);  
    $this->titleSlug = $this->uniqueify($this->titleSlug);
    echo $this->titleSlug;
  };
}

/**
 * Make the string unique in the domain of:  This site, this pagetype
 */
public function uniqueify($someSlug) {
  //return $someSlug . rand();
  // FIXME :-)
  $em = $this->get('doctrine')->getEntityManager();
  $pageType = get_class($this);
  $query = $em->createQuery("SELECT slug FROM Powma\ServiceBundle\Entity\$pageType pt");
  $slugs = $query->getResult();
  // find a unique one.
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T22:24:31.277

作为参考，解决方案是制作一个事件监听器，如下所述：

[http://symfony.com/doc/current/cookbook/doctrine/event_listeners_subscribers.html](http://symfony.com/doc/current/cookbook/doctrine/event_listeners_subscribers.html)

# objective-c - NSMutableURLRequest：使用 setHTTPBodyStream 而不是 setHTTPBody 上传文件

> ID：11692275
> 
> 赞同：1
> 
> 时间：2012-07-27T16:55:19.090
> 
> 标签：objective-c, ios, nsmutableurlrequest

我目前正在通过 HTTP Post 上传文件，使用`[body appendData: [NSData dataWithData:data]];`where data 是我的文件的 NSMutableData 表示。

```
// Set content type to be form data
NSString *boundary = [NSString stringWithString:@"---------------------------14737809831466499882746641449"];
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@", boundary];
[request addValue:contentType forHTTPHeaderField:@"Content-Type"];

// Set content type to be form data
NSString *boundary = [NSString stringWithString:@"---------------------------14737809831466499882746641449"];
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@", boundary];
[request addValue:contentType forHTTPHeaderField:@"Content-Type"];

// Set up web request with HTTP post headers for 1 form field which is the image
NSMutableData *body = [NSMutableData data];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"Content-Disposition: form-data; name=\"userfile\"; filename=\".jpg\"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding: NSUTF8StringEncoding]];
[body appendData: [NSData dataWithData:data]];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding: NSUTF8StringEncoding]];

// Set the body
[request setHTTPBody: body]; 
```

由于内存限制，我已经读过最好使用`setHTTPBodyStream`和传递文件在磁盘上的位置上传 - 我将如何使用这种方法设置其他属性，例如内容处置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T18:31:00.663

您必须准备一个包含整个 HTML 请求正文的文件，包括多部分边界、内容类型和处置，并将其用于`setHTTPBodyStream`.

还有其他替代方案（子类`NSInputStream`化，这似乎有点棘手，还有 3rd 方库，例如 ASIHTTPRequest）。[这篇](https://stackoverflow.com/questions/11209249/using-nsoutputstream-to-post-to-url/11209766#11209766)文章提供了更多信息和链接。

# google-maps - 使用 PostGIS 围绕线串创建多边形

> ID：11692276
> 
> 赞同：4
> 
> 时间：2012-07-27T16:55:23.710
> 
> 标签：google-maps, gis, postgis

我是 PostGIS 新手，需要在这里寻求帮助。我有一条来自谷歌地图的折线（代表一个行程），需要在它周围建立一个多边形（缓冲区），以米或公里为单位的特定距离。

对于输入，我有纬度/经度点列表和所需的缓冲距离。

谁能帮我构建查询，以便返回的结果是纬度/经度坐标中的多边形，准备好在地图上绘制？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-29T19:04:36.040

1.  在末尾再次添加线串的第一个顶点，以便能够创建多边形。
2.  将线串转换为多边形
3.  在多边形周围创建一个缓冲区

```
SELECT
    ST_Buffer(ST_Polygon(ST_AddPoint(the_geom, ST_StartPoint(the_geom))),100)
FROM
    mytable 
```

1.  如果您的缓冲区以米/公里为单位，而您的数据以纬度/经度为单位，您可能希望首先将多边形转换为适当的投影（我不知道您在哪里），然后再转换为纬度/经度。

```
SELECT
    ST_Transform(ST_Buffer(ST_Transform(ST_Polygon(ST_AddPoint(the_geom,ST_StartPoint(the_geom)),4326),XXXX),100),4326)
FROM
    mytable 
```

我还没有尝试过代码，但它应该可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T18:00:20.107

这没有使用 PostGIS，但[Google Maps API v3 中有一个 RouteBoxer 实用程序，](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/routeboxer/)它可以执行您所要求的操作。

另一种选择：[JSTS 库](https://github.com/bjornharrtell/jsts)。

[例子](http://www.geocodezip.com/v3_GoogleEx_directions-buffered.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-31T22:32:58.937

对于 lon/lat 几何图形上的缓冲区，您可以`ST_Buffer`在`geography`数据类型上使用。这种方法可以避免找到合适的投影。PostGIS 实际上为此使用了 UTM 区域。

例如，`geometry(ST_Buffer(georgaphy(geom), 100))`为 geometry 返回 100 米的缓冲区多边形`geom`。

因此，对于具有 seq、lon 和 lat 列的表，它看起来像：

```
SELECT geometry(ST_Buffer(georgaphy(ST_MakeLine(ST_MakePoint(lon, lat))), dist))
FROM sometable
ORDER BY seq 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-09-01T07:26:41.263

经过测试，发现postgis生成的多边形缓冲区不可靠。也就是说，如果我想在折线周围有一个 5 公里的缓冲区，postgis 将返回一个最多 5 公里的多边形**，**但在某些点上却比这小。

放弃 postgis

# python - 在 Python 中自动进行多个 SCP 传输，无需密钥

> ID：11692285
> 
> 赞同：0
> 
> 时间：2012-07-27T16:56:26.843
> 
> 标签：python, ssh, automation, scp

在使用自动非交互式 python 脚本编译后，我需要将两个程序从一台服务器复制到另一台服务器。密钥不是一个选项，因为此脚本适用于公司服务器上的多个用户，并且需要密钥和密码。密码不会存储在程序中，而是在程序开始时使用 getpass() 询问一次，然后用于两次 SCP 传输，这样用户就不必为每个 scp 调用输入密码。我正在使用 os.system 调用 scp：

```
os.system("/usr/bin/scp %s %s@server:directory" %(prg, uname))
os.system("/usr/bin/scp %s %s@server:directory2" %(prg2, uname)) 
```

scp 是为另一个程序定义的，因此是 /usr/bin/scp。prg/prg2 是程序的位置，uname 是远程服务器上的用户名。

我尝试使用管道输入密码，如此[处所述](https://serverfault.com/a/318482)，但它不起作用。

我无法安装 sshpass、expect、paramiko 或 fabric，也无法使用未安装在接收服务器上的 rsync b/c。我能做些什么来自动化这个吗？

我正在运行 AIX 6.1、Python 2.6.2

更新：我无法安装外部库，例如 pexpect，因为 AIX 在 python 安装目录中没有 /config 文件夹。解决方法是[为 AIX 安装 python-devel](ftp://ftp.software.ibm.com/aix/freeSoftware/aixtoolbox/RPMS/ppc/python/python-devel-2.6.2-1.aix5.3.ppc.rpm)，但我无法安装程序，所以我仍然卡住了。

更新 2：我决定放弃 SCP 以支持 FTP。我结合使用了[这个](https://stackoverflow.com/a/11029097)和[这个](http://zephyrfalcon.org/weblog/arch_d7_2003_06_28.html#e262)来制作我的 FTP 脚本。感谢您的回答和帮助指导我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T22:54:58.770

由于您必须在没有安装权限的纯 Python 中实现此功能，因此您只能重新发明轮子，这很糟糕。在这种情况下，您需要的是`SSH_ASKPASS`漏洞。

SSH 真的不希望你只给它一个密码——毕竟，这就是密钥文件的用途。但是，如果设置了 SSH_ASKPASS 环境变量， *并且*设置了 DISPLAY 环境变量，*并且*ssh 没有在 TTY 中运行，它将执行 ASKPASS 程序（同时将其环境变量保留在调用 ASKPASS 程序的上下文中） ）。因此，如果您很聪明，您可以设置一个回显程序作为您的 ASKPASS 并强制 ssh 以这种方式执行您想要的操作。

这是我见过的用于执行此操作的代码片段 - 这并不完整（它是从模块的中间提取的），但它应该可以帮助您入门。我们使用 base64 为我们的密码添加了遮羞布。

```
def createConnection(self, hostName, username, password):
    """ Because we're setting both stdout and stderr to be pipes, we have
        to worry about one of them clogging - We'll be reading stdout
        constantly through the code, but stderr needs a worker to handle
        it. """

    env = {'SSH_ASKPASS': '/path/to/echo/script',
           'DISPLAY': 'required',
           'ENCODED_PASSWORD': base64.b64encode(password)}
    self.username = username
    self.hostName = hostName
    self.sshProcess = subprocess.Popen(
        ['/usr/bin/ssh', '-T',
         '-o', 'UserKnownHostsFile=/dev/null',
         '-o', 'StrictHostKeyChecking=no',
         '-o', 'NumberOfPasswordPrompts=1',
         '-o', 'ConnectTimeout=10',
         '%s@%s' % (username, hostName),
         '-s', 'xmlagent',
        ],
        stdin=subprocess.PIPE,
        stdout=subprocess.PIPE,
        stderr=subprocess.PIPE,
        env=env,

        #this kicks it out of the controlling tty session
        preexec_fn=os.setsid
    )

    self.sshStderr = ''
    self.errorThread = threading.Thread(target=self.readStderr)
    self.errorThread.daemon = True
    self.errorThread.start() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T16:58:49.600

你需要使用`pexpect`.

使用示例（来自[Automate SSH without using public key authentication 或 expect(1)](https://stackoverflow.com/questions/271090/automate-ssh-without-using-public-key-authentication-or-expect1)）：

```
import pexpect

FILE="/path/to/file"
REMOTE_FILE=""
USER="user"
HOST="example.com"
PASS="mypass"
COMMAND="scp -oPubKeyAuthentication=no %s %s@%s:%s" % (FILE, USER, HOST, REMOTE_FILE)

child = pexpect.spawn(COMMAND)
child.expect('password:')
child.sendline(PASS)
child.expect(pexpect.EOF)
print child.before 
```

您也可以尝试`expect`（然后从 运行脚本`python`；如果无法安装，这是一个很好的解决方案`pexpect`）：

```
#!/usr/bin/expect -f
set filename [lindex $argv 0]
set timeout -1
spawn scp $filename myusername@192.168.1.123:/home/myusername/
set pass "mypassword"
expect {
         password: {send "$pass\r" ; exp_continue}
         eof exit
} 
```

# entity-framework - 如何为多个 DbContext 预生成视图？

> ID：11692288
> 
> 赞同：2
> 
> 时间：2012-07-27T16:56:33.720
> 
> 标签：entity-framework, entity-framework-4.1

我们有一个使用实体框架 4.1 和 DbContext API 的应用程序。该应用程序有**多个 DbContexts**映射到不同的数据库和表。本周，我们使用[Code first T4 模板为](http://blog.3d-logic.com/2012/06/13/entity-framework-codefirst-view-generation-templates-on-visual-studio-code-gallery/)DbContext 预先生成了视图，以节省启动时间，一切都很棒......直到我们需要使用第二个 DbContext。那时，我们得到了以下异常：

> “EntityContainer 'CodeFirstContainer' 的映射和元数​​据信息不再匹配用于创建预生成视图的信息。”

无论我们是否为一个或多个 DbContexts 生成了视图，我们都会得到该异常。

**如何为多个 DbContexts 预生成视图并且仍然有一个工作的应用程序？**

我查看了消息中可疑的“CodeFirstContainer”，发现它位于两个预生成视图构造函数中，如下所示：

```
public ViewsForBaseEntitySetsCE5A4DE7E067A5879A835C5C494F186A390ADC2D26E82631FDC17C61E7E3D076
{
    this.EdmEntityContainerName = "CodeFirstContainer";
    this.StoreEntityContainerName = "CodeFirstDatabase";
    this.HashOverMappingClosure = "198099ba4b299a8dc37402a5c4c65096d216c3ca5f3c1e6c796d33e723483d74";
    this.HashOverAllExtentViews = "85be433ad451c345f4d8e92827653fd9203be3008dd387745798f939514a0b2f";
    this.ViewCount = 14;
} 
```

两个视图构造函数之间的唯一区别是最后 3 个属性。

或者，如果有人知道我如何告诉 EF 不要对两个 DbContexts 使用 CodeFirstContainer，那么我可以自己更改生成视图或 DbContext 并让事情正常工作......除非这包含在哈希中。

# django - Django 视图功能似乎不起作用

> ID：11692293
> 
> 赞同：0
> 
> 时间：2012-07-27T16:56:58.150
> 
> 标签：django, django-views

这是我的 django 视图中的 2 个函数。第一个和第二个应该做同样的事情。但是当我使用第一个函数时，它在最后一行显示“外部函数”，即“返回 HttpResponse(output)”。

这是为什么？

谢谢， 希亚姆

```
def main_page(request):
    output = '''
        <html>
            <head><title>%s</title></head>
            <body>
                <h1>%s</h1><p>%s</p>
            </body>
        </html>
    ''' % (
        'Django Learning',
        'Welcome',
        'WYou can share book marks here!'
)
return HttpResponse(output)

def main_page(request):
    title_sowl = "Django Learning"
    header_sowl = "Welcome"
    text_sowl = "You can share book marks here"
    output = u"<html><head><title>%s</title></head><body><h1>%s</h1><p>%s</p></body></html>" % (title_sowl,header_sowl,text_sowl)
    return HttpResponse(output) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:06:00.850

这是因为您需要缩进该行才能将其视为`main_page`方法的一部分。

# vb.net - 带循环的多线程

> ID：11692294
> 
> 赞同：0
> 
> 时间：2012-07-27T16:57:02.377
> 
> 标签：vb.net, multithreading, loops, custom-controls

我已经制作了一个用于读取 RSS 并将其输出到标签的应用程序，但我使用的是一个计时器，因为我想循环它。我希望我的线程完成后，等待 3 分钟，然后重新启动它。线程/计时器的作用是制作一个带有 2 个标签的面板，一个用于标题，一个用于描述，我在其中放置了 rss 项目的值。

计时器可以满足我的需要，但控件变得无响应。

顺便提一句。我正在使用自定义控件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:23:12.980

（假设 4.0）首先，在你的项目的一个模块中制作这个扩展方法。这将处理跨线程 UI 操作。

```
<Extension()> _
Public Sub SomeCrossThreadAction(Of T As ISynchronizeInvoke)(ByRef objTarget As T, ByVal actCrossThreadAction As Action(Of T))

    If objTarget.InvokeRequired Then

        objTarget.Invoke(actCrossThreadAction, New Object() {objTarget})

    Else

        actCrossThreadAction(objTarget)

    End If

End Sub 
```

其次，定义将由您的线程调用的方法，该方法利用扩展方法向表单添加控件。这是一个示例（在这种情况下，我是表单。如果您希望传递一个表单参数（或其他类型）来替换“我”，则可以向此方法添加一个表单参数）：

```
Private Sub ThreadsWork()

    Dim lblTest As New Label
    lblTest.Text = "Some Text."

    Me.SomeCrossThreadAction(Sub(frm As Form) frm.Controls.Add(lblTest))

End Sub 
```

在您的 Timer Elapsed 事件处理程序中：

```
 Dim t As New Threading.Thread(Sub(x) ThreadsWork())
    t.Start() 
```

显然，这并不*完全*是您正在寻找的内容，但对您来说可能已经足够了。该扩展方法不仅适用于表单类型。

# ruby-on-rails - Thin / Capistrano 无法连接到数据库

> ID：11692296
> 
> 赞同：1
> 
> 时间：2012-07-27T16:57:06.893
> 
> 标签：ruby-on-rails, capistrano, thin

我正在尝试设置我的 Ruby on Rails 应用程序以部署到瘦集群。当我在服务器上手动启动瘦集群时，`bundle exec thin start -C config/thin.yml`一切正常。但是，当我通过 Capistrano 运行相同的命令时，它就会死掉并且日志显示：

`/shared/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/connection_specification.rb:45:in `resolve_hash_connection': database configuration does not specify adapter (ActiveRecord::AdapterNotSpecified)`

我不知所措，我使用与 capistrano 脚本中定义的用户帐户相同的用户帐户登录服务器。

我的 capistrano Thin 任务：

```
 namespace :deploy do
    task :start do
      run "cd #{current_path}; bundle exec thin start -C config/thin.yml"
    end
    task :stop do
      run "cd #{current_path}; bundle exec thin stop -C config/thin.yml"
    end
    task :restart do
      run "cd #{current_path}; bundle exec thin restart -C config/thin.yml"
    end
  end 
```

这是我的thin.yml：

```
---
chdir: /var/www/rails/myapp/current
environment: staging
address: 0.0.0.0
port: 3000
timeout: 30
log: log/thin.log
pid: tmp/pids/thin.pid
max_conns: 1024
max_persistent_conns: 512
require: []
wait: 30
servers: 2
daemonize: true 
```

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T18:17:40.800

我需要在每一步显式设置 RAILS_ENV。

`run "cd #{current_path}; RAILS_ENV=#{rails_env} bundle exec thin start -C config/thin.yml"`

Capistrano 似乎没有选择我们的环境变量

这是一个相关的帖子：

[如何为我的linux系统下的每个人设置环境变量？](https://stackoverflow.com/questions/1641477/how-to-set-environment-variable-for-everyone-under-my-linux-system)

# coldfusion - 我怎么知道这个变量是否是一个文件句柄？

> ID：11692302
> 
> 赞同：2
> 
> 时间：2012-07-27T16:57:36.713
> 
> 标签：coldfusion

说我有这个代码：

```
function doFileStuff(){
    var file = "";
    try {
        file = fileOpen(filePath);
        // do stuff with file
    }
    finally {
        fileClose(file);
    }
} 
```

如果该`fileOpen()`过程失败，`fileClose()`调用将出错。我需要做的是这种事情（伪代码）：

```
if (isFile(file)){
    fileClose(file);
} 
```

我知道我可以测试文件是否仍然是一个空字符串，这对我有用，但它没有测试我应该测试的内容：是否`file`是文件句柄。我可以检查对象的 Java 类，但这对我来说又有点 hacky，应该有一个 CFML 方法来做这件事。

应该有类似 just 的东西`isFile()`，不是吗？我在文档中找不到这样的东西。

有什么想法/提示吗？我在我的[博客](http://adamcameroncoldfusion.blogspot.co.uk/2012/07/how-do-i-know-if-this-variable-is-file.html)上进行了更深入的调查。这里太罗嗦了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T14:47:11.827

Interesting problem. I'd use the `java.io.File` class. It's what CF uses internally for its file operations, with the exception of the new vfs feature.

Leveraging java shouldn't be considered hacky. It's a down right necessity sometimes ;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T10:27:04.840

我将此标记为已回答：基本上没有本地方法可以做到这一点。我已经[向 Adob​​e 提出了一张票，](https://bugbase.adobe.com/index.cfm?event=bug&id=3299625)以便对其进行排序。

感谢所有的反馈。

更新：根据我提出的那张票，这已`isFileObject()`在 ColdFusion 11 中实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-06T15:57:54.127

我扩展了现有 TypeOf() UDF 的功能以添加支持以返回任何变量类型。您可以使用它来确定变量是否为“FileHandler”（或“FileHandlerJava”）类型，然后相应地关闭它。它适用于 ColdFusion 9+。我发布此解决方案是因为我们没有升级到 CF11。

**TypeOf() UDF（和示例用法）**

[https://gist.github.com/JamoCA/1ed396431dfb8e0e9f58](https://gist.github.com/JamoCA/1ed396431dfb8e0e9f58)

```
 /* Detect CF's fileOpen() */
if (typeOf(theFile) is "fileHandler"){
    fileClose(file);

/* Detect createobject("java","java.io.FileReader") */
else if (typeOf(theFile) is "fileHandlerJava"){
    variables['file'].close();
} 
```

# java - 在java中将bean转换为Json

> ID：11692303
> 
> 赞同：1
> 
> 时间：2012-07-27T16:57:37.410
> 
> 标签：java, json

我有一个要转换为 JSON 的类，但构造函数不允许我这样做。该类称为 CourseKeyInfo：

```
public class CourseKeyInfo
{
    private String courseKey;
    private String institutionID;
    public CourseKeyInfo(String courseKey, String institutionId)
    {
        this.courseKey = courseKey;
        this.institutionID = institutionId;
    }
    public String getCourseKey()
    {
        return courseKey;
    }
    public void setCourseKey(String courseKey)
    {
        this.courseKey = courseKey;
    }
    public String getInstitutionID()
    {
        return institutionID;
    }
    public void setInstitutionID(String institutionID)
    {
        this.institutionID = institutionID;
    }
} 
```

我曾经`JSONObject body = new JSONObject(responseEntity);`将其转换为 json，但它给了我“构造函数 JSONObject(CourseKeyInfo) 未定义”错误。知道如何将我的课程变成 json 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T17:08:45.723

构造函数[JSONObject(Object)](http://javadox.com/org.json/json/20151123/org/json/JSONObject.html#JSONObject-java.lang.Object-)确实存在。

```
CourseKeyInfo courseKeyInfo = new CourseKeyInfo("This Works!", "101");
JSONObject jsonObject = new JSONObject(courseKeyInfo); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T06:14:33.570

如果您使用[GSON](http://code.google.com/p/google-gson/)，您可以这样做：

```
CourseKeyInfo courseKeyInfo = new CourseKeyInfo("This Works!", "101");
String json = new Gson().toJson(courseKeyInfo);
System.out.println(json); 
```

为了这个工作

*   下载[GSON JAR](http://google-gson.googlecode.com/files/google-gson-2.2.2-release.zip)
*   添加到您的项目构建路径
*   就这样

结果是：

```
{"courseKey":"This Works!","institutionID":"101"} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T17:05:19.030

对于 http 请求，这里是使用 json array+ json beans 的示例

```
JSONArray jsonArray = new JSONArray();
    for (Credentials credentials : ((PropertiesManager) propertiesManager.get()).getJsonPropertiesManager().getAllCredentials()) {
        JSONObject jsonObject = new JSONObject();
        jsonObject.put("credentialsName", credentials.getName());
        jsonArray.add(jsonObject);
    }

    req.setAttribute(JSON_RESULT_OBJ_ATTR, jsonArray.toString()); 
```

# encryption - OpenSAML 3DES 错误的密钥大小：必须等于 112 或 168

> ID：11692305
> 
> 赞同：0
> 
> 时间：2012-07-27T16:57:42.897
> 
> 标签：encryption, opensaml

我正在使用 OpenSAML 来加密我的 SAML 响应。我将算法从 AES 更改为 TRIPLEDES，如下所示，现在它开始向我抛出异常

//数据加密参数-秘钥

```
EncryptionParameters encParams = new EncryptionParameters();
encParams.setAlgorithm(EncryptionConstants.ALGO_ID_BLOCKCIPHER_TRIPLEDES);

java.security.InvalidParameterException: Wrong keysize: must be equal to 112 or 168
    com.sun.crypto.provider.DESedeKeyGenerator.engineInit(DashoA13*..)
    javax.crypto.KeyGenerator.init(DashoA13*..)
    javax.crypto.KeyGenerator.init(DashoA13*..) 
```

我知道我需要将密钥大小设置为 168，但如何在 OpenSAML 中设置它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T10:24:01.727

不能使用该方法，而应使用 SecurityHelper 的另一种方法 generateKey，如下所示：

```
SecurityHelper.generateKey("DESede", 168, "SunJCE"); 
```

此处的区别在于您需要提供所有详细信息，例如算法名称（在 SunJCE 中，DESede 是三重 DES）、密钥长度和 JCA 提供者名称（此处为 SunJCE）。

所以你应该做这样的事情：

//生成对称密钥用于数据加密

```
Credential symmetricCredential = SecurityHelper.getSimpleCredential(

                                SecurityHelper.generateKey("DESede", 168, "SunJCE")); 
```

//指定数据加密参数

```
 EncryptionParameters encParams = new EncryptionParameters();
    encParams.setAlgorithm(EncryptionConstants.ALGO_ID_BLOCKCIPHER_TRIPLEDES);  
    encParams.setEncryptionCredential(symmetricCredential); 
```

希望这可以帮助。

# java - 您如何通过 Java 开发工具包确定您在 AWS S3 中的权限？

> ID：11692310
> 
> 赞同：9
> 
> 时间：2012-07-27T16:58:18.523
> 
> 标签：java, amazon-web-services, amazon-s3, permissions

我知道您可以尝试通过 Java SDK 读取 ACL 或存储桶策略，但是有没有简单的方法来检查您是否具有对存储桶和/或其内容的读取和/或写入权限？我在 AmazonS3 类中看不到任何“haveReadPermissions()”方法或任何东西，但也许我遗漏了什么？我很难相信没有简单的方法来检查权限。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-06-24T20:36:52.370

我认为答案是没有万无一失的方法可以做到这一点，至少目前没有。您可以使用其他几种方法来尝试解决此问题。我最初尝试使用 getBucketLocation() 方法来确定我的给定用户是否具有对存储桶的读取权限，但事实证明您*必须是*存储桶的所有者才能使用此方法......所以这不起作用。

对于读取访问，您可以使用另一种技巧。只需使用以下内容`getObject(bucketName, UUID.randomUUID().toString())`- 这将引发异常，因为您正在尝试获取不存在的密钥。捕获 AmazonServiceException（或 AmazonS3Exception）并检查`e.getErrorCode()`equals `"NoSuchKey"`。如果是这种情况，那么您对存储桶具有读取权限。如果是任何其他错误代码，那么您无权访问，或者存储桶不存在，等等（可能是任意数量的东西）。确保您明确检查错误代码而*不是*状态代码，因为如果存储桶不存在，您还将获得 404 状态代码（这与密钥不存在时获得的状态代码相同）。以下是 S3 错误/状态代码的完整列表：[http://docs.aws.amazon.com/AmazonS3/latest/API/ErrorResponses.html](http://docs.aws.amazon.com/AmazonS3/latest/API/ErrorResponses.html)

对于写访问，它并不那么简单。最好的方法是实际将一个小测试文件写入存储桶（然后可能尝试删除它）。除此之外，如果您想检查更通用的权限，使用像 PutObjectAcl 这样的方法将确定您的用户是否具有`"s3:Put*"`权限（您可以将 ACL 设置为与当前 ACL 完全相同，方法是先读取它然后使用它来设置它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T07:53:57.347

试试`getBucketACL(String bucketName)`哪一种方法`AmazonS3`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-08T20:09:24.970

`getBucketACL`如果没有定义存储桶策略，则使用很好，但策略可以覆盖 ACL。

此外，您可能没有查看 ACL 的权限。因此，除非您可以要求`READACL`访问存储桶并且不允许策略，否则您将需要使用`getBucketACL`和的某种组合`getBucketPolicy`。

到那时，尝试检查这些权限所需的操作可能会更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-02T06:15:39.500

在这里你可以如何做到这一点：

```
// get list of bucket permission
List<String> bucketPermissions = s3Client
    .getBucketAcl(bucketName)
    .getGrantsAsList().stream().distinct()
    .map(t -> t.getPermission().toString())
    .collect(Collectors.toList());

// check read/write or full control permission
if (
    !((bucketPermissions.contains("READ")
    && bucketPermissions.contains("WRITE"))
    || (bucketPermissions.contains("FULL_CONTROL")))) {
throw new InsufficentBucketPermissionException();
} 
```

请随时改进此解决方案。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-27T18:32:30.333

我认为没有更简单的方法，除非您创建自己的扩展 AWS API 的类。如果您正在执行与 Amazon S3 相关的大型程序，这可能不是一个坏主意。

# javascript - 具有多层的谷歌地图和融合表 API

> ID：11692316
> 
> 赞同：0
> 
> 时间：2012-07-27T16:58:55.387
> 
> 标签：javascript, google-maps, google-maps-api-3, google-fusion-tables

我正在尝试显示允许用户单击复选框以按方向过滤的公交路线图。我不断收到“数据可能仍在加载..”错误，似乎无法在刷新/缩放/等上解决。

有两层（一层带有路线，另一层带有停靠点）引用了两个谷歌融合表。相同的方向过滤器输入两个表的查询（即，停止和路线的 NB 过滤器）

我尝试只显示一层（通过注释掉另一层），并且两者似乎都可以正常工作。另外，stops 数据表有大约 600 个条目，所以我不认为这是一个限制问题？

这是中的代码`<head>`

```
<script type="text/javascript">
  function initialize() {

    // Change these variables for each route
    var routeNumber = '257';                // Route number as string
    var mapLatitude = 37.9985;              // Center of map latitude
    var mapLongitude = -122.5372;           // Center of map longitude
    var zoomLevel = 13;                     // Map zoom level

    // Map display options
    var myOptions = {
      center: new google.maps.LatLng(mapLatitude, mapLongitude),
      zoom: zoomLevel,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    // Create map
    var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

    // Create fusion table layers
    var stopLayer = new google.maps.FusionTablesLayer();
    var routeLayer = new google.maps.FusionTablesLayer();
    filterMap(routeLayer, stopLayer, map, routeNumber);

    // Call filter function on click action
    google.maps.event.addDomListener(document.getElementById('NB'),
        'click', function() {
            filterMap(routeLayer, stopLayer, map, routeNumber);

    });

    google.maps.event.addDomListener(document.getElementById('SB'),
        'click', function() {
            filterMap(routeLayer, stopLayer, map, routeNumber);
    });

    // Filter function to create query
    function filterMap(routeLayer, stopLayer, map, routeNumber) {
        var where = generateWhere();    

        if (where) {
            if (!routeLayer.getMap()) {
                routeLayer.setMap(map);
            }
            if (!stopLayer.getMap()) {
                stopLayer.setMap(map);
            }

            routeLayer.setOptions({
                query: {
                    select: 'Location',
                    from: '1RG-EcymqePVLwa-7lmmkQVdn0RCW4fjQJFouTsc',
                    where: "'Route Number' LIKE " + routeNumber + " AND " + where
                }
            });

            stopLayer.setOptions({
                query: {
                    select: 'latitude',
                    from: '1GTjjCaqkYTM3IDhrt2x8pWO73wCu7KTM1bbEcG8',
                    where: "'Marin Transit Routes' LIKE '%" + routeNumber + "%' AND " + where
                }
            });

        } else {
            stopLayer.setMap(null);
        }
    }

    // Generates string of checked options to feed into query
    function generateWhere() {
        var filter = [];
        var directions = document.getElementsByName('direction');
        for (var i = 0, direction; direction = directions[i]; i++) {
            if (direction.checked) {
                var directionName = direction.value.replace(/'/g, '\\\'');
                filter.push("'" + directionName + "'");
            }
        }
        var where = '';
        if (filter.length) {
            where = "'Direction' IN (" + filter.join(',') + ')';
        }
        return where;
    }

}
</script> 
```

这是中的代码`<body>`

```
<div>
    <input type="checkbox" checked="checked" name="direction" id="NB" value="NB" /><label>NB</label>
    <input type="checkbox" checked="checked" name="direction" id="SB" value="SB" /><label>SB</label>
</div> 
```

**更新**

好的，所以我尝试在第二天左右将图层切换回来，它奏效了！但是在对代码和/或融合表数据进行了一些编辑之后，我遇到了类似的问题，一些停止/样式没有渲染。大约一个小时左右后，一些点的样式开始显示..（停止都应该是大的或小的*绿色*图标）

![地图截图](../Images/0793b0a485bf4fc76a3e5950f789fae3.png)

也许这是刷新瓷砖的问题？因为正确显示的站点看起来都在一个地图图块中，并且随着我缩放而变化。有没有人遇到过这个？如果是这样，是否有某种方法可以强制刷新或防止这种情况发生？

代码在这里：http: [//jsfiddle.net/mobilemelody/u9vhD/4/](http://jsfiddle.net/mobilemelody/u9vhD/4/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T21:26:28.563

我想我现在想出了一个解决方法。出于某种原因，当我切换图层的顺序时，它可以工作。

这是脚本的更新部分

```
// Filter function to create query
    function filterMap(routeLayer, stopLayer, map, routeNumber) {
        var where = generateWhere();

        if (where) {
            if (!stopLayer.getMap()) {
                stopLayer.setMap(map);
            }
            if (!routeLayer.getMap()) {
                routeLayer.setMap(map);
            }

            stopLayer.setOptions({
                query: {
                    select: 'latitude',
                    from: '1GTjjCaqkYTM3IDhrt2x8pWO73wCu7KTM1bbEcG8',
                    where: "'Marin Transit Routes' LIKE '%" + routeNumber + "%' AND " + where
                }
            });

            routeLayer.setOptions({
                query: {
                    select: 'Location',
                    from: '1RG-EcymqePVLwa-7lmmkQVdn0RCW4fjQJFouTsc',
                    where: "'Route Number' LIKE " + routeNumber + " AND " + where
                },
                suppressInfoWindows: true
            });

        } else {
            stopLayer.setMap(null);
            routeLayer.setMap(null);
        }
    } 
```

但是，以这种方式订购时，路线最终会位于停靠点的顶部，这使得单击停靠点并弹出信息窗口有点棘手。如果有人有更好的解决方案，它'非常感谢

# unit-testing - 通过 maven-surefire-plugin 测试我的项目时遇到问题

> ID：11692321
> 
> 赞同：1
> 
> 时间：2012-07-27T16:59:35.823
> 
> 标签：unit-testing, testing, maven-surefire-plugin

我在 Netbeans 中编写了我的 maven 项目。我为我的项目（dao、service..）编写了测试。所有测试都是正确的，但是当我构建或测试我的项目时，maven 显示没有要编译的测试。我使用的是 maven-surefire-plugin，所以将它包含到 pom.xml 中：

```
<plugin>
   <groupId>org.apache.maven.plugins</groupId>
   <artifactId>maven-surefire-plugin</artifactId>
   <version>2.10</version>

                <dependencies>
                    <dependency>
                        <groupId>org.apache.maven.surefire</groupId>
                        <artifactId>surefire-junit47</artifactId>
                        <version>2.10</version>                          
                   </dependency>
                </dependencies>

                <configuration>
                    <testFailureIgnore>true</testFailureIgnore>
                    <reportsDirectory>${project.build.directory}/surefire-reports</reportsDirectory>
                </configuration> 
```

我认为surefire插件有问题..

那是：

```
Scanning for projects...

------------------------------------------------------------------------
Building Employeers 1.0.0-BUILD-SNAPSHOT
------------------------------------------------------------------------

[aspectj:compile]

[resources:resources]
[debug] execute contextualize
Using 'UTF-8' encoding to copy filtered resources.
Copying 4 resources

[compiler:compile]
Nothing to compile - all classes are up to date

[aspectj:test-compile]

[resources:testResources]
[debug] execute contextualize
Using 'UTF-8' encoding to copy filtered resources.
Copying 1 resource

[compiler:testCompile]
Nothing to compile - all classes are up to date

[surefire:test]
Surefire report directory: C:\Users\Администратор\Documents\NetBeansProjects\Employeers\target\surefire-reports
Using configured provider org.apache.maven.surefire.junitcore.JUnitCoreProvider

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Error: An unexpected error occurred while trying to open file C:\Users\?????????????\Documents\NetBeansProjects\Employeers\target\surefire\surefirebooter472050683580306804.jar

Results :

Tests run: 0, Failures: 0, Errors: 0, Skipped: 0

[war:war]
Packaging webapp
Assembling webapp [Employeers] in [C:\Users\Администратор\Documents\NetBeansProjects\Employeers\target\Employeers-1.0.0-BUILD-SNAPSHOT]
Processing war project
Copying webapp resources [C:\Users\Администратор\Documents\NetBeansProjects\Employeers\src\main\webapp]
Webapp assembled in [590 msecs]
Building war: C:\Users\Администратор\Documents\NetBeansProjects\Employeers\target\Employees.war
Warning: selected war files include a WEB-INF/web.xml which will be ignored 
(webxml attribute is missing from war task, or ignoreWebxml attribute is specified as 'true')
------------------------------------------------------------------------
BUILD SUCCESS
------------------------------------------------------------------------
Total time: 5.258s
Finished at: Fri Jul 27 19:47:07 EEST 2012
Final Memory: 6M/16M
------------------------------------------------------------------------ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:06:29.283

可能涉及带有西里尔字符的用户名。

虽然插件最初声明以下目录：

```
C:\Users\Администратор\Documents\NetBeansProjects\Employeers\target\surefire-reports 
```

它后来将其称为以下（注意问号）：

```
C:\Users\?????????????\Documents\NetBeansProjects\Employeers\target\surefire\surefirebooter472050683580306804.jar 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T10:54:52.543

那是我的pom：

```
 <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.mycompany</groupId>
    <artifactId>Employeers</artifactId>

    <version>1.0.0-BUILD-SNAPSHOT</version>
    <packaging>war</packaging>

    <name>Employeers</name>

    <properties>
        <endorsed.dir>${project.build.directory}/endorsed</endorsed.dir>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <java-version>1.7</java-version>
        <org.aspectj-version>1.6.9</org.aspectj-version>
        <org.slf4j-version>1.5.10</org.slf4j-version>
        <org.springframework.roo-version>1.0.2.RELEASE</org.springframework.roo-version>

  </properties>

    <dependencies>

       <!--              SERVLET                                  -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>servlet-api</artifactId>
            <version>2.5</version>
        </dependency>
        <dependency>
            <groupId>javax.transaction</groupId>
            <artifactId>jta</artifactId>
            <version>1.1</version>
        </dependency>
        <dependency>
            <groupId>javax.xml.bind</groupId>
            <artifactId>jaxb-api</artifactId>
            <version>2.1</version>
        </dependency>
        <dependency>
            <groupId>com.sun.xml.bind</groupId>
            <artifactId>jaxb-impl</artifactId>
            <version>2.1.3</version>
        </dependency>
        <dependency>
            <groupId>javax.servlet.jsp</groupId>
            <artifactId>jsp-api</artifactId>
            <version>2.2</version>
        </dependency>
        <!--                                               -->
         <dependency>
            <groupId>javax.persistence</groupId>
            <artifactId>persistence-api</artifactId>
            <version>1.0</version>
        </dependency>
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>ejb3-persistence</artifactId>
            <version>1.0.1.GA</version>
        </dependency>
        <!--   Hibernate                                     -->
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate</artifactId>
            <version>3.2.6.ga</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>3.3.2.GA</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-annotations</artifactId>
            <version>3.4.0.GA</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-commons-annotations</artifactId>
            <version>3.2.0.Final</version>
        </dependency>
        <!-- Support of transaction -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-tx</artifactId>
            <version>3.0.6.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-orm</artifactId>
            <version>3.0.6.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-beans</artifactId>
            <version>3.0.6.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>3.0.6.RELEASE</version>
            <exclusions>
                <!-- Exclude Commons Logging in favor of SLF4j -->
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                 </exclusion>
        </exclusions>   
        </dependency>

        <!--                       ROO                    -->
        <dependency>
            <groupId>org.springframework.roo</groupId>
            <artifactId>org.springframework.roo.annotations</artifactId>
            <version>${org.springframework.roo-version}</version>
            <scope>provided</scope>
        </dependency>

        <!--                        Aspectj                 -->
        <dependency>
            <groupId>org.aspectj</groupId>
            <artifactId>aspectjrt</artifactId>
            <version>${org.aspectj-version}</version>
        </dependency>   
        <dependency>
                        <groupId>org.aspectj</groupId>
                        <artifactId>aspectjweaver</artifactId>
                        <version>1.6.10</version>
        </dependency>
        <!--                        LOGGING                 -->
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>jcl-over-slf4j</artifactId>
            <version>${org.slf4j-version}</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-log4j12</artifactId>
            <version>${org.slf4j-version}</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.15</version>
            <exclusions>
                <exclusion>
                    <groupId>javax.mail</groupId>
                    <artifactId>mail</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>javax.jms</groupId>
                    <artifactId>jms</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>com.sun.jdmk</groupId>
                    <artifactId>jmxtools</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>com.sun.jmx</groupId>
                    <artifactId>jmxri</artifactId>
                </exclusion>
            </exclusions>
            <scope>runtime</scope>
        </dependency>

             <!--                            @Inject                              -->
    <dependency>
        <groupId>javax.inject</groupId>
        <artifactId>javax.inject</artifactId>
        <version>1</version>
    </dependency>

            <!--                            TEST                                 -->
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.10</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.easymock</groupId>
            <artifactId>easymock</artifactId>
            <version>2.4</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-test</artifactId>
            <version>3.0.6.RELEASE</version>
        </dependency>     

             <!---->    
         <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.13</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-web</artifactId>
            <version>3.0.6.RELEASE</version>
        </dependency>
        <!--                        Security                    -->
         <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-web</artifactId>
            <version>3.0.6.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-config</artifactId>
            <version>3.0.6.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-core</artifactId>
            <version>3.0.6.RELEASE</version>
        </dependency>
        <!--                   Spring mvc                          -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>3.0.6.RELEASE</version>
            <type>jar</type>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>4.0.2.GA</version>
        </dependency>
        <dependency>
            <groupId>javax.validation</groupId>
            <artifactId>validation-api</artifactId>
            <version>1.0.0.GA</version>
        </dependency>

    </dependencies>

    <build>
        <plugins>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.7</source>
                    <target>1.7</target>
                    <compilerArguments>
                        <endorseddirs>${endorsed.dir}</endorseddirs>
                    </compilerArguments>
                </configuration>
            </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <version>2.1.1</version>
                <configuration>
                    <warName>Employees</warName>
                </configuration>
            </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-dependency-plugin</artifactId>
                <version>2.1</version>
                <executions>
                    <execution>
                        <phase>install</phase>
                        <goals>
                            <goal>sources</goal>
                        </goals>
                        <!--
                        <configuration>
                            <outputDirectory>${endorsed.dir}</outputDirectory>
                            <silent>true</silent>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>javax</groupId>
                                    <artifactId>javaee-endorsed-api</artifactId>
                                    <version>6.0</version>
                                    <type>jar</type>
                                </artifactItem>
                            </artifactItems>
                        </configuration>
                        -->
                    </execution>
                </executions>
            </plugin>

          <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>aspectj-maven-plugin</artifactId>
                <version>1.2</version>
                <dependencies>
                    <dependency>
                        <groupId>org.aspectj</groupId>
                        <artifactId>aspectjrt</artifactId>
                        <version>${org.aspectj-version}</version>
                    </dependency>
                    <dependency>
                        <groupId>org.aspectj</groupId>
                        <artifactId>aspectjtools</artifactId>
                        <version>${org.aspectj-version}</version>
                    </dependency>

                </dependencies>

                <executions>
                    <execution>
                        <goals>
                            <goal>compile</goal>
                            <goal>test-compile</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <outxml>true</outxml>
                    <source>${java-version}</source>
                    <target>${java-version}</target>
                </configuration>
            </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <version>2.10</version>
                <dependencies>
                    <dependency>
                        <groupId>org.apache.maven.surefire</groupId>
                        <artifactId>surefire-junit47</artifactId>
                        <version>2.10</version>

                   </dependency>
                </dependencies>
                <configuration>
                    <testFailureIgnore>true</testFailureIgnore>
                    <reportsDirectory>${project.build.directory}/surefire-reports</reportsDirectory>
                </configuration>

            </plugin>

          <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>tomcat-maven-plugin</artifactId>
                <version>1.0-beta-1</version>

          </plugin>

        </plugins>
    </build>

    <repositories>
                <!-- For developing against latest Spring milestones -->
        <repository>
            <id>org.springframework.maven.milestone</id>
            <name>Spring Maven Milestone Repository</name>
            <url>http://maven.springframework.org/milestone</url>
            <snapshots><enabled>false</enabled></snapshots>
        </repository>
                <!-- For testing against latest Spring snapshots -->
        <repository>
                        <id>org.springframework.maven.snapshot</id>
                        <name>Spring Maven Snapshot Repository</name>
                        <url>http://maven.springframework.org/snapshot/</url>
                        <snapshots><enabled>true</enabled></snapshots>
                        <releases><enabled>false</enabled></releases>
        </repository>
        <repository>
            <url>http://repo1.maven.org/maven2/</url>
            <id>junit_4</id>
            <layout>default</layout>
            <name>Repository for library Library[junit_4]</name>
        </repository>
    </repositories>

</project> 
```

# cuda - 我可以使用thrust::host_vector 还是必须使用cudaHostAlloc 进行Thrust 的零拷贝？

> ID：11692326
> 
> 赞同：7
> 
> 时间：2012-07-27T16:59:58.180
> 
> 标签：cuda, gpu, thrust, zero-copy

我想在映射内存上使用零拷贝`cudaHostGetDevicePointer`。我可以使用`thrust::host_vector`还是必须使用`cudaHostAlloc(...,cudaHostAllocMapped)?` 或者使用 Thrust 是否更容易？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T17:34:29.757

我很确定仍然无法使用推力::host_vector 作为映射的主机分配。有一个固定的内存分配器，但我不相信映射内存可用。你需要做的是这样的：

1.  分配的映射，固定主机内存`cudaHostAlloc`
2.  使用获取零拷贝内存的设备指针`cudaHostGetDevicePointer`
3.  在该设备指针上创建`thrust::device_ptr`using （有关更多信息，请参见[此处）](http://code.google.com/p/thrust/source/browse/examples/cuda/wrap_pointer.cu)`thrust::device_pointer_cast`

您可以`thrust::device_vector`使用`thrust::device_ptr`或直接将 传递`thrust::device_ptr`给任何接受迭代器的算法。

# c# - 在另一个列表中的列表中查找项目？

> ID：11692329
> 
> 赞同：7
> 
> 时间：2012-07-27T17:00:06.563
> 
> 标签：c#, .net, list, collections

好的，假设我有一个`List<car>`. 每辆车还包含一个`List<part>`. 每个部分都有一个`ID`与之关联的。我只得到了`ID`a `part`，我想找到`car`包含那个的`part`。找到这个的最好方法是什么`car`？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-27T17:07:10.060

使用 LINQ 怎么样？

```
List<Car> cars = ...
var carToFind = cars.FirstOrDefault(car => car.Parts.Any(part => part.Id == idToFind)); 
```

用英语：“查找第一辆汽车（如果不存在这样的汽车，则为 null），其任何部件的 Id 与所需的 Id 匹配。”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-27T17:05:03.167

```
var id = 123;
var cars = new List<Car>();
var theCar = cars.Single(
          car => car.parts
                    .FirstOrDefault(part => part.Id == id) != null
          ); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-27T17:06:46.257

您可以像这样执行 LINQ 查询：

```
// List<car> cars;
int id = 101;
var result = Cars.Where (c => c.parts.Where (p => p.ID == id).Any ()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-27T17:03:57.217

怎么样：

```
foreach(Car car in listOfCars)
{
    if (car.parts.Contains(partID))
    {
        return car;
    }
} 
```

**Edit2：**啊，我误解了，以为你的车有一个 partID 列表。

那么，在那种情况下...

```
foreach(Car car in listOfCars)
{
    foreach(Part part in car.parts)
    {
        if (part.id == partId)
        {
            return car;
        }
    }
} 
```

**Edit1：**根据您的用例，维护一个从零件 ID 映射到汽车的“索引”也可能有意义。就像是：

```
var partIDToCar = Dictionary<string, Car>(); 
```

当您将零件放入汽车时，您会更新索引：

```
partIDToCar[partID] = car; 
```

然后，快速检查取车：

```
if (partIDToCar.ContainsKey(partID))
{
    return partIDToCar[partID];
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-27T17:11:33.993

在查找中查找

```
List<car> cars = new List<Car>();
List<car> carWithParts = cars.Find(x => x.parts.Any(y => y.PartID=123)); 
```

如果多辆汽车可以包含相同的 PartID，这将起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-27T17:04:18.600

```
 var thePart;

 foreach (var part in list<parts>)
 {
 if (part.id = ID)
 thePart = part;
 }

 foreach (var car in list<cars>)
 {
 if (car.Part = thePart)
 return car;
 } 
```

# mysql - 重复 SELECT 语句

> ID：11692345
> 
> 赞同：0
> 
> 时间：2012-07-27T17:01:37.827
> 
> 标签：mysql

该`SELECT`语句运行良好，但我希望能够重复它以进一步完善搜索。

```
SELECT id1 
FROM table1 
WHERE id2 IN (SELECT id 
              FROM table2 
              WHERE name="country" 
                AND value="Mexico") 
```

例如，如果我只想在墨西哥找到有“海滩”的地点，那就是：

```
name="features" AND value="Beaches" 
```

`SELECT`...我将如何通过我的陈述进一步削减结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:06:54.070

可能最好的方法是执行一个新查询并添加额外的过滤。可以在客户端应用程序中“手动”过滤，但在大多数情况下效率可能会降低。所以运行一个有更多限制的新查询：

```
SELECT id1 FROM table1 WHERE id2 IN 
        (SELECT id FROM table2 WHERE 
               name="country" AND 
               value="Mexico" AND
               name2 = "features" AND 
               value2 = "Beaches" ) 
```

请注意，我将两个新列名称更改为不同的名称（原始查询结果不会包含给定原始名称的其他值）。如果通过“优化”，您想添加，那么查询应该是：

```
SELECT id1 FROM table1 WHERE id2 IN 
        (SELECT id FROM table2 WHERE 
               ( name="country" AND 
               value="Mexico" ) OR
               ( name = "features" AND 
               value = "Beaches" )) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:22:28.177

Vecta，您需要通过添加额外的 IN 来扩展您的查询：

```
SELECT id1 
FROM table1 
WHERE id2 IN (SELECT id 
          FROM table2 
          WHERE name="country" 
            AND value="Mexico")
AND id2 IN (SELECT id 
          FROM table2 
          WHERE name="featues" 
            AND value="Beach") 
```

但请考虑到，这将导致性能迅速下降。:-)

# asp.net-mvc-3 - 为什么我在另一个列表中包含的对象中的列表没有返回到控制器？

> ID：11692348
> 
> 赞同：1
> 
> 时间：2012-07-27T17:01:41.157
> 
> 标签：asp.net-mvc-3, data-binding, razor, nested-lists

我确信这已经在某个地方的某个地方得到了回答，但是经过一个多小时的寻找，我还是找不到它。

我正在使用 C#、MVC3 和 AJAX/jQuery。

我有一个名为 FormulaModel 的自定义对象，它有一些属性和一个变量列表。在该变量列表中是一个类别和一个选项对列表。在该 OptionPairs 列表中是一个由名称和值组成的 OptionPair。

我有一个显示公式的部分视图，以及一个用于变量和选项对的 EditorTemplate。

一切都按预期显示，带有选项对值的文本框。但是，在提交包含部分视图的表单后，我没有得到变量内的 OptionPairs 列表。FormCollection 显示这些值的格式看起来是正确的，但模型不包含 OptionPairs 列表。我究竟做错了什么？我是否忽略了一些愚蠢的事情，或者试图做一些比常规数据绑定可以处理的更复杂的事情？

非常感谢您的帮助！

为了简洁起见，我将剪掉一些标准的东西。

--- 公式.cs ---

```
public int formulaId { get; set; }
public string name { get; set; }
public string formulaCypher { get; set; }
public System.DateTime dateCreated { get; set; }
public bool isActive { get; set; } 
```

--- 公式变量.cs ---

```
[Serializable]
public class FormulaVariable
{
    public string Category { get; set; }
    public List<OptionPair> Options;
} 
```

--- OptionPair.cs ---

```
[Serializable]
public class OptionPair
{
    public string OptionName { get; set; }
    public int Value { get; set; }
} 
```

--- 公式模型.cs ---

```
private Formula _formula;
public List<FormulaVariable> Variables { get; set; }
public Formula MyFormula
{
    get { return _formula; }
    set { _formula = value; }
}

public void DecodeFormula()
{
    this.VariableList = this.DecodeFormula(this._formula.formulaCypher);
}

public void EncodeFormula()
{
    _formula.formulaCypher = EncodeFormula(this.VariableList);
} 
```

--- EditFormula.cshtml ---

```
@model Models.FormulaModel
@using (Ajax.BeginForm("SaveFormula", "Management", new { area = "Admin" }, null, new { id = "frmManageFormula" }))
{
@Html.HiddenFor(x => x.MyFormula.dateCreated)
@Html.HiddenFor(x => x.MyFormula.dateEdited)
@Html.HiddenFor(x => x.MyFormula.dateEnacted)
@Html.HiddenFor(x => x.MyFormula.dateRetired)
@Html.HiddenFor(x => x.MyFormula.dealerId)
@Html.HiddenFor(x => x.MyFormula.formulaId)
@Html.HiddenFor(x => x.MyFormula.isActive)
@Html.HiddenFor(x => x.MyFormula.name)

<table style="border: 0; padding: 2px; border-spacing: 2px;">
    <thead>
        <tr>
            <th colspan="2">
                Formula "@Model.MyFormula.name" 
            </th>
        </tr>
    </thead>
    <tbody>
        @Html.EditorFor(x => x.Variables)
        <tr>
            <td colspan="2">
                <input type="button" id="btnSaveFormula" value="Save" />
            </td>
        </tr>
    </tbody>
</table>
} 
```

--- 公式变量.cshtml ---

```
@model Models.FormulaVariable
<tr>
    <td colspan="2" style="border: 1px solid #000000;">
        @Model.Category
        @Html.HiddenFor(x => x.Category)        
    </td>
</tr>
@Html.EditorFor(x => x.Options) 
```

--- OptionPair.cshtml ---

```
@model Models.OptionPair
<tr>
    <td>
        @Model.OptionName
        @Html.HiddenFor(x => x.OptionName)
    </td>
    <td>
        @Html.TextBoxFor(x => x.Value, new { style = "width: 75px;" })        
    </td>
</tr> 
```

--- jQuery ---

```
$("#btnSaveFormula").click(function btnSaveFormula_Click(e) {
    $.ajax({
        type: 'POST',
        url: $("#frmManageFormula").attr("action"),
        data: $("#frmManageFormula").serialize(),
        success: function (content) {
            alert(content);
        },
        error: function (xhr, status) {
            alert(xhr.responseText);
        }
    });
}); 
```

--- 控制器方法 ----

```
[HttpPost]
public ActionResult SaveFormula(FormulaModel model, FormCollection formFields)
{
    string errorMsg = string.Empty;
    try
    {   
        model.EncodeFormula();
        errorMsg = model.SaveFormulaCypher();
    }
    catch (Exception ex)
    {
        throw ex;
    }
    return Json(errorMsg);
} 
```

---点击视图前的模型---

![击中视图前的模型](../Images/6e44abd0850ba8b80120f2634fb77d58.png)

--- 回来后的模型 ---

![回来后的模型](../Images/2f0539e36df0245c881d9c96f2072131.png)

--- 回来后的FormCollection ---

![返回后的FormCollection](../Images/ef53545c1b4331bf54c2e4a5cbcd1b60.png)

再次感谢您提供的任何帮助！

# r - 如何处理“参数'无与伦比！= FALSE'未使用（尚未）”？

> ID：11692349
> 
> 赞同：1
> 
> 时间：2012-07-27T17:01:41.610
> 
> 标签：r, dataframe

我想检查 data.frame() 中的一行是否与现有行重复。[正如这里](https://stackoverflow.com/questions/5916854/existing-function-for-seeing-if-a-row-exists-in-a-data-frame)已经指出的那样，一种方法可能是使用重复功能。但是，如果我正在使用该功能，则会收到以下错误：

```
Error: argument 'incomparables != FALSE' is not used (yet) 
```

在一封相当古老的邮件中，有人指出这实际上是 R 中的一个错误（更多信息在[这里](https://stat.ethz.ch/pipermail/r-help/2009-March/193409.html)）。我的 data.frame() 看起来像这样：

```
data.frame(val1=int,val2=int,val3=int,val4=float); 
```

我想知道问题到底是什么，因为我的data.frame中似乎没有“NA”值，因为

```
?duplicate 
```

指出。这可能是一个非常愚蠢的问题，但我对 R 很陌生，并且很高兴获得有关此问题的任何提示！

在此先感谢，迈克尔

PS：我已经按照建议提供了一个示例

```
table <- NULL;

foo <- function(n, d, nh, v){
  newEntry <- data.frame(node_i=n, node_j=nh, dst=d, phi=v);

  if(length(table != 0)){
    if(!duplicated(table, newEntry)){
      add(n, nh, d, v);
    }else{
      print("it is a duplicate!")    
    }
  }else{
    add(n, nh, d, v);
  }
}

add <- function(n, d, nh, v){
  rbind(table, data.frame(node_i=n, node_j=nh, dst=d, phi=v)) ->> table;
}

bar <- function(){
  foo(23,42,5,4.0);
  print(table);
  foo(22,42,5,4.0);  
  print(table);
  foo(23,42,5,4.0);
  print(table);
} 
```

但是，这似乎根本不是 duplicate() 的问题。如果我尝试添加另一行*sigh* ，我会得到同样的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-03-21T07:10:42.497

如果您将`duplicated`function替换为`match_df`from `plyr`，则该问题应该得到解决。

```
library(plyr) # for match_df
table <- NULL;

foo <- function(n, d, nh, v){
  newEntry <- data.frame(node_i=n, node_j=nh, dst=d, phi=v);

  if(length(table != 0)){
    if(nrow(plyr::match_df(table, newEntry))){
      add(n, nh, d, v);
    }else{
      print("it is a duplicate!")    
    }
  }else{
    add(n, nh, d, v);
  }
}

add <- function(n, d, nh, v){
  rbind(table, data.frame(node_i=n, node_j=nh, dst=d, phi=v)) ->> table;
}

bar <- function(){
  foo(23,42,5,4.0);
  print(table);
  foo(22,42,5,4.0);  
  print(table);
  foo(23,42,5,4.0);
  print(table);
} 
```

# 输出

```
> bar()
node_i node_j dst phi
1     23     42   5   4
Matching on: node_i, node_j, dst, phi
[1] "it is a duplicate!"
node_i node_j dst phi
1     23     42   5   4
Matching on: node_i, node_j, dst, phi
[1] "it is a duplicate!"
node_i node_j dst phi
1     23     42   5   4
> table
node_i node_j dst phi
1     23     42   5   4 
```

# javascript - 将小型 Web 应用程序从普通网站迁移到 Wordpress 网站？

> ID：11692350
> 
> 赞同：1
> 
> 时间：2012-07-27T17:01:46.347
> 
> 标签：javascript, jquery, wordpress

我有一个用 JQuery 构建的网站的小型成本计算器。在某个时候，这个人决定他们想要一个 Wordpress 网站，而我在将它迁移到页面时遇到了一些麻烦。我已经阅读了关于添加 Javascript 的 WP 文档，但老实说我还是有点困惑。

到目前为止，我在迁移网站时所做的就是拆开默认的“twentyeleven”主题并弄乱它的 CSS 以使设计与我的网站相匹配。否则主题不受影响。

我已经整理了应用程序的 HTML 和 CSS，即它可以正确显示。现在我只需要让它工作。

如果我有这些文件：

```
jquery.min.js
quick-quote-tool.js
jquery.rollbar.min.js
jquery.mousewheel.js
query.easing.1.3.js
jquery.cookie.js 
```

我到底如何将它们添加到特定页面并使我的应用程序再次正常运行？如果你花时间，谢谢你帮助一个菜鸟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:24:17.440

根据我所拥有的一点 wordpress 知识，我不知道您是否可以将脚本专门添加到此页面。

但是，通过外观 --> 编辑器菜单，您可以更改 index.php 或 page.php 的模板以满足您的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:25:43.990

> 我到底如何将它们添加到特定页面并使我的应用程序再次正常运行？

这些脚本调用进入`header.php`模板中的文件。该文件包含 HTML 文档正文的开头。

无需区分您在哪些页面上加载这些脚本：如果 Web 服务器配置正确，则脚本文件将只加载一次然后缓存。

# google-apps-script - 移动设备上带有 listBox 的处理程序

> ID：11692352
> 
> 赞同：-1
> 
> 时间：2012-07-27T17:01:48.313
> 
> 标签：google-apps-script

客户端和服务器处理程序是否分配给在桌面上工作的列表框，假设在移动浏览器上以相同的方式运行？

我在桌面（工作正常）和我的移动浏览器（没有触发）上通过 Serge尝试了[这个例子。](https://script.google.com/macros/s/AKfycbwpo1YtexOD873ioYU0xXnClL-asiBM8UBazfAoRRRaM5gDqga2/exec)

[我自己的示例](https://script.google.com/macros/s/AKfycbwnY60555lBPe0jWdcFWG3DHIz-3ZO98uY7Xz2fh6Sqz2EUVIH6/exec)是相同的方式，客户端或服务器处理程序都不会在移动端执行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T18:14:22.513

[问题 1092](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1092)可能是相关的。您需要在 iPhone 和 Android 上轻按两次。

# html - 如何仅使用 JavaScript 在网站上显示外部文件创建日期？

> ID：11692359
> 
> 赞同：0
> 
> 时间：2012-07-27T17:01:59.853
> 
> 标签：html

我什至不知道这是否可行。我正在使用直接的 HTML。这真的是我唯一的选择。没有 PHP，没有 .Net，没有 Java，有 JAVASCRIPT。

我有 URL，我正在尝试显示上次修改日期。

我遇到了这段代码，但它显示的是文件，而不是最后修改日期。代码是否有问题，或者是否有另一种仅使用 HTML 和 JavaScript 的方法？

我无法在这里分享真实的 URL。

```
<body><p>
<script src="https://www.website.com/wiki_form.html?nodeid=1103951244" type="text/javascript">// <![CDATA[
function getLastMod(){
var myFrm = document.getElementById('myIframe');
var lastModif = new Date(myFrm.contentWindow.document.lastModified);
document.getElementById('LastModified').innerHTML = "Prices correct as at: " + lastModif.toLocaleString();
}
// ]]></script>
<span id="LastModified"></span></p>
<p><iframe id="myIframe" src="https://www.website.com/wiki_form.html?nodeid=1103951244" style="display: none;"></iframe></p></body> 
```

谢谢！李

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:07:05.130

仅使用 HTML（HTML 是静态的）无法实现此解决方案，如果您使用 JavaScript 与文件进行任何交互，则需要将其托管在 Web 服务器上。如果是这样的话，你肯定有理由使用 PHP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:11:51.633

如果您正在通过服务器解析文件并且您真的不能使用 PHP，您也许可以使用服务器端包含 (SSI)；尝试在您的 HTML 文件中包含以下代码：

```
<!--#flastmod file="page.html" --> 
```

您可能需要将文件扩展名更改为 .shtml，以便服务器知道它必须对其进行特殊处理。

# ruby-on-rails - Rails 3：为 after_create 回滚

> ID：11692363
> 
> 赞同：7
> 
> 时间：2012-07-27T17:02:21.323
> 
> 标签：ruby-on-rails, ruby

我有一张报名表。

当用户注册时，应用程序应该将数据保存在`enrollments`表和`users`表中。（我需要这种分离，因为用户的个人资料可以更改，但他为该特定注册输入的数据必须存档。所以即使稍后用户更改了他的姓氏，在注册表格中我也会有他的初始信息。）

所以我正在考虑在`enrollments`表中保存数据然后有一个 after_create 调用，像这样......

```
class Enrollment < ActiveRecord::Base

  after_create :save_corresponding_user

  def save_corresponding_user
    user = User.new
    user.full_name = self.user_full_name
    user.email = self.user_email
    user.mobile_phone = self.user_mobile_phone
    user.save
  end
end 
```

问题是，如果保存用户因任何原因失败怎么办。如何回滚和销毁`enrollments`表中刚刚保存的数据？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-11-03T20:33:36.670

`false`从那里回来`after_create`不会做任何事情。

> 整个回调链被包装在一个事务中。如果任何 before 回调方法完全返回 false 或引发异常，则执行链将停止并发出 ROLLBACK；after 回调只能通过引发异常来实现。

此外，您必须`raise ActiveRecord::Rollback`：

> 任何不是 ActiveRecord::Rollback 的异常都会在回调链停止后被 Rails 重新引发。引发除 ActiveRecord::Rollback 之外的异常可能会破坏不期望像 save 和 update_attributes 等方法（通常尝试返回 true 或 false）引发异常的代码。

[http://guides.rubyonrails.org/active_record_callbacks.html#halting-execution](http://guides.rubyonrails.org/active_record_callbacks.html#halting-execution)

我做这样的事情：

```
after_create do
  if condition
    errors.add(:attr, 'Blah blah blah.')
    raise ActiveRecord::Rollback
  end
end 
```

对于 Rails 3： http: [//guides.rubyonrails.org/v3.2.13/active_record_validations_callbacks.html#halting-execution](http://guides.rubyonrails.org/v3.2.13/active_record_validations_callbacks.html#halting-execution)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-27T17:29:25.607

after_create 是保存当前模型的事务的一部分。因此，如果您的代码崩溃或 after_create 返回 false，它应该回滚当前事务并使`enrollment`保存无效。

如果您想模拟这一点，请将其添加到您的 after_create 中，看看是否一切都按预期工作：

```
raise Exception.new("CRASH") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T18:28:13.737

正如@anthonyalberto 提到的， after_create 已经是交易的一部分。要定义一个事务，你可以在你的控制器中使用这样的东西：

```
Enrollment.transaction do
  @enrollment.save!
end 
```

这就是您真正需要做的所有事情，如果注册保存失败或用户保存失败，它将回滚您的整个事务。这里有更多信息：[http ://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-07-29T10:37:09.093

在 rails 5 中，您需要使用`throw :abort`ActiveRecord 链来回滚。

[![在此处输入图像描述](../Images/2d0a0786d71dc43f36ef9d08461b3052.png)](https://i.stack.imgur.com/UkQMg.png)

您可以看到不同版本的 Rails 中的操作处理列表以及之前和之后的回调。为了更好地说明，请查看停止执行的概念。请按照下面给定的链接。

[https://guides.rubyonrails.org/active_record_callbacks.html#halting-execution](https://guides.rubyonrails.org/active_record_callbacks.html#halting-execution)

# sql - 使用 DATETIME 计算的低效 SQL 查询。如何优化？

> ID：11692368
> 
> 赞同：1
> 
> 时间：2012-07-27T17:03:00.273
> 
> 标签：sql, sql-server

问题来自真实环境，其中`production_plan`表格捕获每行中的订单标识和其他详细信息。在开始生产产品时和生产后更新每一行——以捕获事件的 UTC 时间。

有一个单独的表格`temperatures`收集生产线上的多个温度 - 定期，独立于任何东西，与 UTC 一起存储。

目标是提取每个产品生产的测量温度序列。（然后应处理温度，创建值图表并将其附加到产品项目文档中以供审核。）

**在 marc_s 评论后**更新。**最初的问题没有考虑任何索引。更新后的文本考虑了以下内容。评论中提到的原始测量。**

 **表和索引是通过以下方式创建的：

```
CREATE TABLE production_plan (
        order_id nvarchar(50) NOT NULL,
        production_line uniqueidentifier NULL,
        prod_start DATETIME NULL,
        prod_end DATETIME NULL
);

-- About 31 000 rows inserted, ordered by order_id.
...

-- Clusteded index on ind_order_id.
CREATE CLUSTERED INDEX ind_order_id
ON production_plan (order_id ASC);

-- Non-clustered indices on the other columns.
CREATE INDEX ind_times
ON production_plan (production_line ASC, prod_start ASC, prod_end ASC);

------------------------------------------------------

-- There is actually more temperatures for one time (i.e. more
-- sensors). The UTC is the real time of the row insertion, hence
-- the primary key.
CREATE TABLE temperatures (
        UTC datetime PRIMARY KEY NOT NULL,
        production_line uniqueidentifier NULL,
        temperature_1 float NULL  
);

-- About 91 000 rows inserted ordered by UTC.
...

-- Clusteded index on UTC is created automatically 
-- because of the PRIMARY KEY. Indices on temperature(s)
-- do not make sense.

-- Non-clustered index for production_line
CREATE INDEX ind_pl
ON temperatures (production_line ASC);

-- The tables were created, records inserted, and the indices
-- created for less than 1 second (for the sample on my computer). 
```

想法是首先在标识上加入表格`production_line`，其次是温度 UTC 时间适合项目生产开始/结束的 UTC 时间：

```
-- About 45 000 rows in about 24 seconds when no indices were used.
-- The same took less than one second with the indices (for my data
-- and my computer).
SELECT pp.order_id,      -- not related to the problem 
       pp.prod_start,    -- UTC of the start of production
       pp.prod_end,      -- UTC of the end of production
       t.UTC,            -- UTC of the temperature measurement
       t.temperature_1   -- the measured temperature
  INTO result_table02
  FROM production_plan AS pp
       JOIN temperatures AS t
         ON pp.production_line = t.production_line
            AND t.UTC BETWEEN pp.prod_start
                          AND pp.prod_end
  ORDER BY t.UTC; 
```

大约 24 秒的时间是不可接受的。很明显，索引是必要的。相同的操作用时不到 1 秒（Microsoft SQL Management Studio 中结果选项卡下方黄线中的时间）。

然而...

**第二个问题依然存在**

由于温度测量不是太频繁，而且测量位置在开始生产的时间上略有偏移，因此必须进行时间校正。换言之，必须将两个偏移量添加到时间范围边界。我以这样的查询结束：

```
-- About 46 000 rows in about 9 minutes without indices.
-- It took about the same also with indices 
-- (8:50 instead of 9:00 or so).
DECLARE @offset_start INT;
SET @offset_start = -60  -- one minute = one sample before

DECLARE @offset_end INT;
SET @offset_end = +60    -- one minute = one sample after

SELECT pp.order_id,      -- not related to the problem 
       pp.prod_start,    -- UTC of the start of production
       pp.prod_end,      -- UTC of the end of production
       t.UTC,            -- UTC of the temperature measurement
       t.temperature_1   -- the measured temperature
  INTO result_table03
  FROM production_plan AS pp
       JOIN temperatures AS t
         ON pp.production_line = t.production_line
            AND t.UTC BETWEEN DATEADD(second, @offset_start, pp.prod_start)
                          AND DATEADD(second, @offset_end, pp.prod_end)
  ORDER BY t.UTC; 
```

通过`DATEADD()`计算，大约需要 9 分钟 - 几乎与是否创建索引无关。

更多地考虑如何解决问题，在我看来，更正的时间边界（带有附加偏移的 UTC）需要它们自己的索引来进行有效处理。我想到了创建一个临时表。然后可以为其更正的列创建索引。之后再使用一个 JOIN 应该会有所帮助。然后可以删除表。

临时表的基本思想是否正确？有没有其他技术可以做到这一点？

感谢您的建议。引入您建议的索引后，我将更新时间结果。请解释预期改进的原因。在编写 SQL 解决方案时，我是关于动手经验的初学者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:18:52.437

您通常可以通过以下方式优化查询：

*   在你的桌子上选择一个**好的**`narrow, unique, static, ever-increasing`聚类键——好存在。`INT IDENTITY`是经典的好键 - GUID 是一个非常糟糕的例子（因为它们会导致过多的索引碎片 - 阅读 Kim Tripp 的[GUID 作为主键和/或集群键](http://www.sqlskills.com/BLOGS/KIMBERLY/post/GUIDs-as-PRIMARY-KEYs-andor-the-clustering-key.aspx)以获得更多详细信息）

*   确保子表中的所有外键列都被**索引**，以便更快地执行 JOIN 和查找

*   选择你真正需要的尽可能少的列（你似乎做得很好）

*   试图*覆盖查询*，例如在包含所有必要列的相关表上创建索引 - 直接作为索引列或*包含*列（SQL Server 2008 及更高版本）

*   可能添加额外的索引来加速范围查询，和/或帮助排序/排序

查看您的查询和表定义：

*   我似乎没有看到任何主键 - 添加这些！

*   你必须确保有外键索引`pp.production_line`（假设`t.production_line`是另一个表的主键）

*   你应该看看你是否能找到一个好的索引来处理范围查询`t.UTC`

*   `production_plan2`您应该检查创建索引以包含所有列 ( `order_id, pp.prod_start, pp.prod_end`) 是否有意义

*   `temperatures2`您应该检查创建索引以包含所有列 ( `UTC, temperature_1`) 是否有意义

**更新：**您可以通过从 SSMS 工具栏中启用该选项来捕获实际执行计划：

![在此处输入图像描述](../Images/35267ec33fcf32624da35d3cbedff255.png)

或从下面的菜单中`Query > Include Actual Execution Plan`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T16:16:24.990

计算列可以帮助您 [http://msdn.microsoft.com/en-us/library/ms189292%28v=sql.105%29.aspx](http://msdn.microsoft.com/en-us/library/ms189292%28v=sql.105%29.aspx)

```
ALTER TABLE production_plan ADD 
        offset_start int NOT NULL CONSTRAINT DF__production_plan__offset_start DEFAULT 0,
        offset_end int NOT NULL CONSTRAINT DF__production_plan__offset_end DEFAULT 0,
        prod_start_UTC as CAST(DATEADD(second,offset_start,prod_start) as DATETIME) PERSISTED  NOT NULL ,
        prod_end_UTC as CAST(DATEADD(second,offset_end,prod_end) as DATETIME) PERSISTED  NOT NULL

-- or just
--ALTER TABLE production_plan ADD 
--        prod_start_UTC as CAST(DATEADD(second,-60,prod_start) as DATETIME) PERSISTED  NOT NULL ,
--        prod_end_UTC as CAST(DATEADD(second,60,prod_end) as DATETIME) PERSISTED  NOT NULL

IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[temperatures]') AND name = N'ind_pl')
    DROP INDEX [ind_pl] ON [dbo].[temperatures] WITH ( ONLINE = OFF )

CREATE INDEX ind_times_UTC
ON production_plan (production_line ASC, prod_start_UTC ASC, prod_end_UTC ASC);

SELECT pp.order_id,      -- not related to the problem 
       pp.prod_start,    -- UTC of the start of production
       pp.prod_end,      -- UTC of the end of production
       t.UTC,            -- UTC of the temperature measurement
       t.temperature_1   -- the measured temperature
  INTO result_table05
  FROM production_plan AS pp
       JOIN temperatures AS t
         ON pp.production_line = t.production_line
            AND t.UTC BETWEEN pp.prod_start_UTC
                          AND pp.prod_end_UTC
ORDER BY t.UTC; 
```

以及 marc_s 提出的建议

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T13:47:11.683

要尝试的事情：

```
CREATE INDEX ind_pl
    ON temperatures (production_line ASC, UTC); 
```

将为连接提供覆盖索引。

使用非等连接应用（sql server 2005+）可能会更快：

```
SELECT pp.order_id,      -- not related to the problem 
       pp.prod_start,    -- UTC of the start of production
       pp.prod_end,      -- UTC of the end of production
       t.UTC,            -- UTC of the temperature measurement
       t.temperature_1   -- the measured temperature
  INTO result_table02
  FROM production_plan AS pp
 CROSS APPLY
 (
   SELECT t1.utc, t1.temperature_1
     FROM temperatures AS t1
    WHERE t1.production_line = pp.production_line
      AND t1.UTC BETWEEN DATEADD(second, @offset_start, pp.prod_start)
                     AND DATEADD(second, @offset_end, pp.prod_end)
 ) t
 ORDER BY t.UTC; 
```

如果这不起作用，下一个选项是编写存储过程，通过声明两个游标，一个用于 pp，一个用于 t，并在插入匹配项时一次推进一侧，从而确保每个表只被读取一次进入临时表。这种技术可能非常复杂，因为存在 n:m 关系。但是，如果上述方法不适合您，我很乐意试一试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-30T20:51:00.540

我用临时表尝试了以下解决方案：

```
-- UTC range expanded by the offsets -- temporary table used.
-- (Much better -- less than one second.)

DECLARE @offset_start INT;
SET @offset_start = -60  -- one minute = one sample before

DECLARE @offset_end INT;
SET @offset_end = +60    -- one minute = one sample after

-- Temporary table with the production_plan UTC range expanded.
SELECT production_line,
       order_id,
       prod_start,
       prod_end,
       DATEADD(second, @offset_start, prod_start) AS start,
       DATEADD(second, @offset_end, prod_end) AS bend
  INTO #pp     
  FROM production_plan;

CREATE INDEX ind_UTC
  ON #pp (production_line ASC, start ASC, bend ASC);

SELECT order_id,
       prod_start,
       prod_end,
       UTC,
       temperature_1
  INTO result_table06
  FROM #pp JOIN temperatures AS t
             ON #pp.production_line = t.production_line
                AND UTC BETWEEN #pp.start AND #pp.bend
  ORDER BY UTC;

DROP TABLE #pp;

CREATE CLUSTERED INDEX ind_UTC
  ON result_table06 (UTC ASC); 
```

结果在不到一秒的时间内准备好（与 9 分钟相比）。但我想听听你的批评。一个问题是，如果温度表增长到一张大表，它的效率会有多高。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-30T12:19:33.840

这是你的第二个问题。

我还没有检查过它的性能，但是您可以尝试通过将 DATEADD 函数替换为常量浮点数的加减法来跳过它。

就像如果你想添加第二个你可以使用：

```
select getdate()+1.000/(24.00*60.00) 
```

或者用一个常数：

```
select getdate()+0.000694444 
```

如您所见，添加 1（一）将恰好增加 1 天。所以这不会完全是 60 秒，但在这种情况下可能没关系？**

# python - 为 pyqt GUI 应用程序制作 CMD

> ID：11692369
> 
> 赞同：0
> 
> 时间：2012-07-27T17:03:07.443
> 
> 标签：python

我一直在寻找如何将 CMD 嵌入到 pyqt gui 中。我找到了 CMD 模块，但即使我进行了多线程和处理，它也不能与 pyqt 一起使用。有没有人有关于如何做的想法或例子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:34:30.290

pycrust/pyshell 是很好的 python 嵌入式终端

如果您只需要标准的 DOS cmd，您可以这样做

```
os.system("cmd") 
```

不确定你是否想要一个 linux 终端

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:36:30.493

我不知道我是否有这个权利，因为这个问题有点模糊，但我会尝试。这是我的想法。在您的 pyqt gui 中创建一个文本编辑小部件。然后创建一个 cmd.Cmd 实例并将文本编辑小部件的文件对象作为第一个和第二个参数（stdout 和 stdin）传递。这可能不起作用，因为我不知道文本编辑小部件是否可以充当文件对象. 下面是它的外观：

```
c = cmd.Cmd(stdin = widget, stdout = widget) 
```

如果我犯了错误，请告诉我，因为我不是 100% 确定。

# java - 小程序问题 - NoClassDefFoundError

> ID：11692373
> 
> 赞同：5
> 
> 时间：2012-07-27T17:03:25.053
> 
> 标签：java, applet, noclassdeffounderror

我意识到有一百万个这样的帖子，但没有一个对我有帮助，所以这里是：我正在尝试部署一个无法正确加载的非常非常简单的小程序。我的 HTML：

```
<html>
<head>
    <meta http-equiv="Content-Type" content"text/html; charset=utf-8">
</head>
<body>
   <applet code = "SimpleApplet.class"
   width = "320" height = "100"></applet>
</body>
</html> 
```

我的爪哇：

```
package test;

import javax.swing.*;   

public class SimpleApplet extends JApplet{
   public void init(){
      try{
        SwingUtilities.invokeAndWait(new Runnable(){
          public void run(){
            JLabel lbl = new JLabel("Hello World");
            add(lbl);
          }
        });             
      }
      catch(Exception e){
        System.out.println(e);
      }
   }
} 
```

两个文件位于同一目录中

```
/home/me/workspace/myProject/bin/test 
```

如果我通过 Eclipse 自己运行小程序，它可以正常工作。当我打开页面时出现错误

```
java.lang.NoClassDefFoundError: SimpleApplet (wrong name: test/SimpleApplet) 
```

该错误表明我错误地放置或命名了某些东西。然而，尝试后

```
<applet code = "test/SimpleApplet.class"
width = "320" height = "100"></applet>

<applet code = "SimpleApplet.class"
codebase = "/test"
width = "320" height = "100"></applet> 
```

连同其他尝试，包括删除“，尝试绝对路径名和所有部分路径名，以及使用.java，它仍然不起作用，我最终得到一个 ClassNotFoundException。[其他](https://stackoverflow.com/questions/11396646/load-class-myapplet-not-found-java-lang-classnotfoundexception-why-am-i-gett) [答案](https://stackoverflow.com/questions/34413/why-am-i-getting-a-noclassdeffounderror-in-java)指出类路径和代码库（通常与存档有关）问题是发生这种情况的主要原因。但是，我没有使用 jar 文件，并且两个文件都在同一个目录中。有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-29T00:30:11.173

*   **/home/me/workspace/myProject/bin**
    *   小程序.html
    *   **/home/me/workspace/myProject/bin/test**
        1.  简单小程序类

如果类`SimpleApplet`在包`test`中，则将 HTML 放在父目录中（如上所述），并使用此 HTML。

```
<html>
<head>
    <meta http-equiv="Content-Type" content"text/html; charset=utf-8">
</head>
<body>
   <applet code = "test.SimpleApplet"
   width = "320" height = "100"></applet>
</body>
</html> 
```

## 侧面提示：

*   发布代码时，也要发布 import 和 package 声明，或者换句话说，**全部**发布。事实上，我们需要对事物进行猜测；但是有了完整的代码，我们就不必这样做了。
*   在这个阶段不要尝试小程序。您应该理清在命令行上使用包的工作，小程序比使用 GUI 的应用程序更难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:48:35.437

判断从

> 以及其他尝试，包括删除 "、尝试绝对路径名和所有部分路径名，以及使用 .java

您正在尝试获取 test/SimpleApplet.java 而不是 test/SimpleApplet.class。您需要将 SimpleApplet.java 文件编译成 SimpleApplet.class 文件

确保当你这样做时，你使用

```
<applet code = "SimpleApplet.class"
codebase = "/test"
width = "320" height = "100"></applet> 
```

因为 /test 是代码库，而不是包名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-03T21:26:12.707

`NoClassDefFoundError: Ahmed (wrong name: intoapplet/Ahmed )`

我一直在寻找解决方案 3 天。

你的建议：

如果您将类命名为“测试”，编码约定建议它应该是“测试”。

这有助于我在我的 Java 类中不包括包声明。通过将项目名称的第一个字母作为大写字母保存。（使用eclipse）。

----------------------------------Java 代码：------------- ------------------

```
 import java.awt.*;
    import javax.swing.*;

    public  class  Ahmed extends JApplet {

    private static final long serialVersionUID = 1L;

    public void paint(Graphics g){
    super.paint(g);
    g.drawString("my name is Ahmed Zaki wow this actually
    works",300,300);                     
    }
    } 
```

----------------------------------HTML代码-------------- --------------------

```
 <html>
    <head>
    <title>Tutorial applet</title>
    </head>
    <body>

    <Applet code="Ahmed.class"   width="400"; height="300";> 

    </Applet>
    </body>
    </html> 
```

-------开源SFTP、FTP、WebDAV和SCP客户端目录-------

使用“WinSCP”在 /public_html/ 文件夹中的 class 和 html 文件，WinSCP 是适用于 Microsoft Windows 的免费和开源 SFTP、FTP、WebDAV 和 SCP 客户端。它的主要功能是本地和远程计算机之间的安全文件传输。

```
 example:

    directory for html file = /public_html/index.html
    directory for class file = /public_html/Ahmed.class

    example no2:

    +-- public_html
    |   +-- index.html
    |   +-- Ahmed.class 
```

# javascript - 两个脚本之间可能存在冲突

> ID：11692374
> 
> 赞同：1
> 
> 时间：2012-07-27T17:03:32.043
> 
> 标签：javascript, jquery

我有这个随机显示/隐藏 div 的脚本。但是由于某种原因，加载页面时它没有显示任何内容：

```
$(document).ready(function() {
      $('.control').on('click', function(e) {
          e.preventDefault();
          var field = $(this).data('field');
          $('.hider:visible').fadeOut("slow", function() {
              $('#' + field + '-gallery, #' + field + '-tag').fadeIn("slow");
          });
      });

      var randomIndex = Math.floor((Math.random() * 100) + 1) % 5;
      console.log(randomIndex);

      var field = $($('a').get(randomIndex)).data('field');
      $('#' + field + '-gallery, #' + field + '-tag').fadeIn("slow");
  }); 
```

我有这个（在页脚中）：

```
/* jQuery.noConflict() for using the plugin along with other libraries. 
           You can remove it if you won't use other libraries (e.g. prototype, scriptaculous etc.) or 
           if you include jQuery before other libraries in yourdocument's head tag. 
           [more info: http://docs.jquery.com/Using_jQuery_with_Other_Libraries] */
        //jQuery.noConflict(); 
        /* calling thumbnailScroller function with options as parameters */
        (function($){
        window.onload=function(){ 
            $("#tS2").thumbnailScroller({ 
                    scrollerType:"clickButtons", 
                    scrollerOrientation:"horizontal", 
                    scrollSpeed:2, 
                    scrollEasing:"easeOutCirc", 
                    scrollEasingAmount:600, 
                    acceleration:10, 
                    scrollSpeed:900, 
                    noScrollCenterSpace:10, 
                    autoScrolling:0, 
                    autoScrollingSpeed:2000, 
                    autoScrollingEasing:"easeInOutQuad", 
                    autoScrollingDelay:500 

            });
        }
        })(jQuery); 
```

我注意到，如果我在页脚的脚本中启用 jQuery.noConflict，则会在顶部脚本的检查器中收到错误消息：

```
$(document).ready(function() {
      $('.control').on('click', function(e) {
Uncaught TypeError: Property '$' of object [object Window] is not a function
          e.preventDefault(); 
```

但是如果我在页脚脚本中禁用 noConflict ，则没有错误，但顶部脚本仍然不起作用。我是否需要在顶部脚本中添加另一个 noConflict，或者我是否将 $(document).ready 称为错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:05:04.977

您也可以使用`jQuery` 代替`$`. 并离开`$`其他图书馆。这样你就不会面临冲突问题。

像这样试试。

```
jQuery(document).ready(function() {
      jQuery('.control').on('click', function(e) {
          e.preventDefault(); 
```

# shell - Unix - 如何将下一行附加到文件中的上一行

> ID：11692375
> 
> 赞同：2
> 
> 时间：2012-07-27T17:03:35.570
> 
> 标签：shell

如何将下一行附加到文件中的上一行，由管道符号分隔？

**预期输入——input.txt 的内容**

```
ABC    
BCD    
DEF    
EFG    
FGH 
```

**预期输出——output.txt 的内容**

```
|ABC|BCD|    
|BCD|DEF|    
|DEF|EFG|    
|EFG|FGH|    
|FGH|| 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:07:35.507

```
paste - - < input-txt 
```

是一个好的开始，但它不会添加您想要的分隔符。为此，请尝试：

```
 paste - - < input-txt | awk '{$1=$1; print OFS $0 OFS}' OFS=\| 
```

（或者`|`在字段之间插入符号的许多其他方法中的任何一种！这个版本发出`|FGH|`而不是`|FGH||`在最后一行。）

或者：

```
 sed 1d input-txt | paste -d \| input - | sed 's/^\|$/|/g' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T17:50:12.307

[http://www.gnu.org/software/gawk/manual/html_node/Field-Separators.html](http://www.gnu.org/software/gawk/manual/html_node/Field-Separators.html)

```
awk -v ORS="|\n" -v OFS="|" 'NR>1{print p, $1} {p=$1} END{print p, ""}' foo.txt 
```

或者没有 ORS

```
awk -v OFS="|" 'NR>1{print p, $1, ""} {p=$1} END{print p, "", ""}' foo.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T17:20:05.900

在 Linux 上使用 bash

```
 join -o 1.2,2.2,2.3 -t'|' -1 1 -2 1 -a 1 <(awk '{print(NR"|"$0)}' input.txt | sort -k1,1 -t'|' -n) <(awk '{print(NR - 1"|"$0"|")}' input.txt | sort -k1,1 -t'|' -n) 
```

# jquery - 如何将 PHP 脚本加载到 JQuery 中的 div 相同窗口中

> ID：11692380
> 
> 赞同：0
> 
> 时间：2012-07-27T17:04:01.717
> 
> 标签：jquery, html, refresh

我有错误：数据未定义。我想从打印 html 的 php 脚本中刷新内容

我的父页面：

```
<body>
variables ...
 <div id="comparateur2">
....
</div> 
```

Javascript：

```
<script type="application/javascript">
$(document).ready(function(){
$("form").submit(function(e){
var format = $("#format").val();
var qtephotos = $("#qtephotos").val();
var option1 = $('input[name=option1]:checked', '#formulaire').val();
var offre = $('input[name=offre]:checked', '#formulaire').val();    
var val = [];
    $(':checkbox:checked').each(function(i){
        val[i] = $(this).val();
    });
var dataString =  'format='+ format + '&qtephotos=' + qtephotos + '&option1=' + option1 + '&valoption=' + val; 
$.ajax ({
type: "POST",
url: "scripts/ajax_comparateur.php",
data: dataString,
success: function(){
        $('#comparateur2').html(data);
    }
});     
 });
});
</script> 
```

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:07:59.077

如果您的 PHP 脚本实际上正在返回数据，那么您应该将您的成功调用更新为：

```
success: function(data){
        $('#comparateur2').html(data);
} 
```

函数参数中缺少数据参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:09:15.570

您没有创建匿名函数来接受返回的数据作为参数。data 变量在您的函数范围内不存在。

所以而不是`function()`put `function(data)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T17:09:51.900

您`dataType:`在`function()`

如果没有 dataType，返回的任何内容都将被忽略，如果函数中没有数据，返回的任何内容都将不可用。

```
$.ajax ({
type: "POST",
url: "scripts/ajax_comparateur.php",
data: dataString,
dataType: "html",
success: function(data){
        $('#comparateur2').html(data);
    }
}); 
```

# sql - SQL 语句中的除法。

> ID：11692384
> 
> 赞同：4
> 
> 时间：2012-07-27T17:04:15.423
> 
> 标签：sql, division

好的，所以我的问题：

我有一个表 itemconfig，其中有很多关于存储在我们仓库中的物品的数据。我需要选择一个特殊`group`的项目，以便我可以进行一些与工作相关的测试。到目前为止，当我滚动浏览数据库时，我一直在脑海中进行数学运算，但必须有一种更简单的方法。

在 itemconfig 中，我想专门查看 case_qty 和 pal_qty 以及 itm_num 列。我想做的是选择`pal_qty / case_qty`大于 say 的所有 itm_num `500`。这将`itm_num`立即为我提供与我的测试相关的所有内容。可悲的是，我不熟悉如何做到这一点，或者它是否可能。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T17:07:21.370

在大多数 SQL 方言中都实现除法： use `/`，如下所示：

```
select * from table
where  pal_qty / case_qty > 500 
```

假设`case_qty`是非负数，您可以`pal_qty`通过将两边乘以 来保护自己免于被零除（并在 上使用索引，如果有的话*）`case_qty`：

```
select * from table
where  pal_qty > 500 * case_qty 
```

* * *

* 感谢[文森特萨瓦德](https://stackoverflow.com/users/476496/vincent-savard)的观察。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T17:07:17.487

这是可能的，使用一个简单的`WHERE`子句：

```
SELECT 
  itm_num
FROM itemconfig
WHERE 
  /* Make sure you don't divide by zero */
  case_qty > 0 AND
  pal_qty / case_qty > 500 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T17:07:01.420

您可以在`WHERE`子句中使用除法。

```
SELECT itm_num
FROM itemconfig
WHERE (pal_qty/case_qty) > 500 
```

如果你的 case_qty 等于零，那么你需要确保你不被零除

```
SELECT itm_num
FROM itemconfig
WHERE (pal_qty/case_qty) > 500
    AND case_qty > 0 
```

# django - 第一次在 Heroku 上运行 manage.py syncdb 时出错：“您需要在 Django 设置文件中指定名称”

> ID：11692386
> 
> 赞同：3
> 
> 时间：2012-07-27T17:04:19.110
> 
> 标签：django, heroku

`heroku run python manage.py syncdb`在我最近部署到 heroku 的 django 应用程序上执行时，出现以下错误：

```
raise ImproperlyConfigured("You need to specify NAME in your Django settings file.") 
```

我理解错误的含义。我只是不确定它为什么会发生。我非常遵循当前的[heroku 部署指南](https://devcenter.heroku.com/articles/django)。

我的 requirements.txt 中有 dj_database_url==0.2.1 和 pycopg2==2.4.4。我用`heroku-postgresql:crane`. 在我的 settings.py 中，我有：

```
import dj_database_url
DATABASES = {'default': dj_database_url.config(default='postgres://localhost')} 
```

奇怪的是，我已经在同一个 repo 的 Heroku 上成功部署了 3 次，所以这不像我在这里从头开始。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-27T17:22:40.340

我想通了。我需要跑步

```
heroku pg:promote HEROKU_POSTGRESQL_<COLOR> 
```

这部分在教程中明显没有，我记得上次我这样做时不得不寻找这个。

# c# - 在更新时排序和显示时在并发字典中获取参数异常

> ID：11692389
> 
> 赞同：8
> 
> 时间：2012-07-27T17:04:35.460
> 
> 标签：c#, multithreading, concurrency, race-condition, concurrentdictionary

我在以下程序中遇到难以重现的错误，其中多个线程并行更新并发字典，并且主线程在固定时间间隔后按排序顺序显示字典的状态，直到所有更新线程完成。

```
public void Function(IEnumerable<ICharacterReader> characterReaders, IOutputter outputter)
{
    ConcurrentDictionary<string, int> wordFrequencies = new ConcurrentDictionary<string, int>();
    Thread t = new Thread(() => UpdateWordFrequencies(characterReaders, wordFrequencies));
    bool completed = false;
    var q = from pair in wordFrequencies orderby pair.Value descending, pair.Key select new Tuple<string, int>(pair.Key, pair.Value);
    t.Start();
    Thread.Sleep(0);

    while (!completed)
    {
        completed = t.Join(1);
        outputter.WriteBatch(q);
    }            
} 
```

该函数有一个字符流列表和一个输出器。该函数维护从每个字符流（并行）读取的单词的单词频率的并发字典。单词被一个新线程读入，主线程每 1 毫秒输出字典的当前状态（按排序顺序），直到所有输入流都被读取（实际上输出将类似于每 10 秒，但错误似乎只出现在非常小的值上）。WriteBatch 函数只是写入控制台：

```
public void WriteBatch(IEnumerable<Tuple<string, int>> batch)
{
    foreach (var tuple in batch)
    {
        Console.WriteLine("{0} - {1}", tuple.Item1, tuple.Item2);
    }
    Console.WriteLine();
} 
```

大多数执行都很好，但有时我在 WriteBatch 函数的 foreach 语句中收到以下错误：

“未处理的异常：System.ArgumentException：索引等于或大于数组的长度，或者字典中的元素数大于从索引到目标数组末尾的可用空间。”

如果主线程在启动更新线程之后和开始显示循环之前休眠一小会儿，错误似乎确实消失了。如果删除 orderby 子句并且字典未在 linq 查询中排序，它似乎也消失了。有什么解释吗？

WriteBatch 函数中的`foreach (var tuple in batch)`语句给出了错误。堆栈跟踪如下：

未处理的异常：System.ArgumentException：索引等于或大于数组的长度，或者字典中的元素数大于从索引到目标数组末尾的可用空间。在 System.Collections.Concurrent.ConcurrentDictionary2.System.Collections.Generic.ICollection>.CopyTo(KeyValuePair2[] 数组，Int32 索引) 在 System.Linq.Buffer1..ctor(IEnumerable1 源) 在 System.Linq.OrderedEnumerable1。 d__0.MoveNext() at System.Linq.Enumerable.WhereSelectEnumerableIterator2.MoveNext() at MyProject.ConsoleOutputter.WriteBatch(IEnumerable1 batch) in C:\MyProject\ConsoleOutputter.cs:line 10 at MyProject.Function(IEnumerable1 characterReaders, IOutputter outputter)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-28T09:21:29.457

正如其他人所说，内部类的构造函数中存在竞争，`System.Linq.Buffer<T>`由 调用`OrderBy`。

这是有问题的代码片段：

```
TElement[] array = null;
int num = 0;
if (collection != null)
{
    num = collection.Count;
    if (num > 0)
    {
        array = new TElement[num];
        collection.CopyTo(array, 0);
    }
} 
```

`collection`在调用到之后`collection.Count`但在调用到之前将项目添加到 时，将引发异常`collection.CopyTo`。

* * *

作为一种解决方法，您可以在对字典进行排序之前制作字典的“快照”副本。

您可以通过调用来做到这一点，`ConcurrentDictionary.ToArray.`
因为这是在`ConcurrentDictionary`类本身中实现的，所以它是安全的。

使用这种方法意味着您不必使用锁来保护集合，正如您所说，这首先破坏了使用并发集合的目的。

```
while (!completed)
{
    completed = t.Join(1);

    var q =
      from pair in wordFrequencies.ToArray() // <-- add ToArray here
      orderby pair.Value descending, pair.Key
      select new Tuple<string, int>(pair.Key, pair.Value);

    outputter.WriteBatch(q);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T17:52:27.797

在评论中与 ChrisShain 讨论后，得出的结论是，您应该在打印出来之前获得对字典的互斥访问权限，或者使用 a `mutex`of`lock`声明。

用锁做：

```
public void WriteBatch(IEnumerable<Tuple<string, int>> batch)
{
    lock (myLock) 
    {
        foreach (var tuple in batch)
        {
            Console.WriteLine("{0} - {1}", tuple.Item1, tuple.Item2);
        }
        Console.WriteLine();
    }
} 
```

`myLock`假设您在类级别分配了一个对象。见[例子](http://msdn.microsoft.com/en-us/library/c5kehkcz.aspx)。

使用互斥锁执行此操作：

```
public void WriteBatch(IEnumerable<Tuple<string, int>> batch)
{
    mut.WaitOne();

    foreach (var tuple in batch)
    {
        Console.WriteLine("{0} - {1}", tuple.Item1, tuple.Item2);
    }
    Console.WriteLine();

    mut.ReleaseMutex();
} 
```

`Mutex`同样，假设您在类级别分配了一个对象。见[例子](http://msdn.microsoft.com/en-us/library/system.threading.mutex.aspx)。

# php - 未定义变量 $_POST['data'] PHP /Ajax jquery

> ID：11692393
> 
> 赞同：2
> 
> 时间：2012-07-27T17:04:49.347
> 
> 标签：php, jquery, ajax

大家好，这是不正常的:) !!

foo.php

```
 <?php 
         if (isset($_POST['data']))
         $stringData = $_POST['data'];
         $file = "ciao.txt"; 
         $fh = fopen($file, 'w') or die("can't open file");
         fwrite($fh, $stringData);
         fclose($fh); 

         ?>

file.js

    function WriteToFile() {
        var dataa = "foo bar";
     $.post("foo.php", {data: dataa}, function(result){ alert("ciaoooo!!");}            
           , "json");
    } 
```

这是错误，我无法在 file.txt 上写入

注意：未定义变量：stringData

我也尝试过那种功能

```
function WriteToFile() {
    var data = "foo bar";
$.ajax({
    url: 'foo.php',
    type: 'POST',
    data: { 'data' : 'data'},
    success: function() {
        alert('the data was successfully sent to the server');
    }
});

but the result is the same!! Anyone have some idea??? 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T17:07:59.413

您缺少大括号：

```
if (isset($_POST['data'])) {
         $stringData = $_POST['data'];
         $file = "ciao.txt"; 
         $fh = fopen($file, 'w') or die("can't open file");
         fwrite($fh, $stringData);
         fclose($fh); 
 } 
```

没有它们，你基本上有这个：

```
 if (isset($_POST['data'])) {
         $stringData = $_POST['data'];
 }
 $file = "ciao.txt"; 
 $fh = fopen($file, 'w') or die("can't open file");
 fwrite($fh, $stringData);
 fclose($fh); 
```

这解释了为什么你会得到 undefined `$stringData`，因为 POST 没有正确执行。

请注意，这并不能解决您的 JS / jQuery 问题。为此，请参阅其他答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T17:44:04.910

好的，我认为这就是正在发生的事情：

您发布的代码（示例 1 中的 foo.php/file.js）是正确的，并且可以正常工作。我不确定您是否尝试直接在浏览器中点击 foo.php URL。在这种情况下，没有发布任何内容，因此 $stringData 将是未定义的，它会抛出您所看到的通知。

您需要做的是： 1\. 在 HTML 文件中包含 file.js 脚本。2\. 确保您已包含 jquery 库 3\. 确保 $.POST 中的 PHP (foo.php) 文件路径正确 4\. 在 HTML 正文 onLoad 函数上调用 WriteToFile()

这是一个应该可以工作的示例 HTML（如果需要，更新 foo.php 的路径）

```
<script src ="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
<script>
function WriteToFile() 
{
    var dataa = "foo bar";
    $.post("foo.php", {data: dataa}, function(result){ alert("ciaoooo!!");}, "json");
}
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T17:07:44.037

此时不要使用引号：

```
data: { 'data' : 'data'}, 
```

将其替换为：

```
data: {data : data}, 
```

此外，在您需要括号的第一个代码片段中，像这样更正它：

```
if (isset($_POST['data'])) {
  /* Your code here */
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T17:08:06.723

我想你想要这样的东西：

```
function WriteToFile() {
    var data = "foo bar";
    $.ajax({
    url: 'foo.php',
    type: 'POST',
    data: data,
    success: function() {
        alert('the data was successfully sent to the server');
    }
}); 
```

# ruby-on-rails - 模型/表格无法正常工作 heroku

> ID：11692394
> 
> 赞同：0
> 
> 时间：2012-07-27T17:04:58.843
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku

我正在关注使用 Rails 进行敏捷 Web 开发（rails 3.2+），我在第 16 章，关于部署。但是，我计划使用 Heroku 的大部分 b/c 都跳过了它，我目前正在尝试解决这个问题。无论如何，我昨天成功地解散了我的应用程序，它运行良好，除了我的一个模型。我的“订单”模型总是返回“我们很抱歉，但出了点问题”。错误，我不知道为什么。这是'heroku日志'

```
2012-07-27T16:46:00+00:00 app[web.1]: => Booting WEBrick
2012-07-27T16:46:00+00:00 app[web.1]: => Rails 3.2.6 application starting in production on http://0.0.0.0:59115
2012-07-27T16:46:00+00:00 app[web.1]: => Call with -d to detach
2012-07-27T16:46:00+00:00 app[web.1]: => Ctrl-C to shutdown server
2012-07-27T16:46:00+00:00 app[web.1]: Connecting to database specified by DATABASE_URL
2012-07-27T16:46:00+00:00 app[web.1]: [2012-07-27 16:46:00] INFO  WEBrick 1.3.1
2012-07-27T16:46:00+00:00 app[web.1]: [2012-07-27 16:46:00] INFO  ruby 1.9.3 (2012-04-20) [x86_64-linux]
2012-07-27T16:46:00+00:00 app[web.1]: [2012-07-27 16:46:00] INFO  WEBrick::HTTPServer#start: pid=2 port=59115
2012-07-27T16:46:01+00:00 heroku[web.1]: State changed from starting to up
2012-07-27T16:46:04+00:00 app[web.1]: 
2012-07-27T16:46:04+00:00 app[web.1]: Started POST "/en/orders" for 68.110.76.153 at 2012-07-27 16:46:04 +0000
2012-07-27T16:46:04+00:00 app[web.1]: 
2012-07-27T16:46:04+00:00 app[web.1]: Processing by OrdersController#create as HTML
2012-07-27T16:46:04+00:00 app[web.1]:   Parameters: {"utf8"=>"✓", "authenticity_token"=>"MGaN236tlISbAvzPPHogMMyRPIOux+VjAhjCYv/Uv8g=", "order"=>{"name"=>"Tim Turner", "address"=>"9393 E Thorougbh ", "email"=>"xrobertquinnx@aol.com", "pay_type"=>"Check"}, "commit"=>"Place Order", "locale"=>"en"}
2012-07-27T16:46:05+00:00 app[web.1]:   Rendered collection (0.0ms)
2012-07-27T16:46:05+00:00 app[web.1]:   Rendered order_notifier/received.html.erb (58.4ms)
2012-07-27T16:46:05+00:00 app[web.1]:   Rendered collection (0.0ms)
2012-07-27T16:46:05+00:00 app[web.1]:   Rendered order_notifier/received.text.erb (0.8ms)
2012-07-27T16:46:08+00:00 app[web.1]: 
2012-07-27T16:46:08+00:00 app[web.1]: Sent mail to johndoe@aol.com (3050ms)
2012-07-27T16:46:08+00:00 app[web.1]: 
2012-07-27T16:46:08+00:00 app[web.1]: Completed 500 Internal Server Error in 3619ms
2012-07-27T16:46:08+00:00 app[web.1]: Errno::ECONNREFUSED (Connection refused - connect(2)):
2012-07-27T16:46:08+00:00 app[web.1]:   app/controllers/orders_controller.rb:59:in `block in create'
2012-07-27T16:46:08+00:00 app[web.1]:   app/controllers/orders_controller.rb:55:in `create'
2012-07-27T16:46:08+00:00 app[web.1]: 
2012-07-27T16:46:08+00:00 app[web.1]: 
2012-07-27T16:46:08+00:00 heroku[router]: POST depot-app-test.herokuapp.com/en/orders dyno=web.1 queue=0 wait=0ms service=3791ms status=500 bytes=643
2012-07-27T16:46:08+00:00 heroku[router]: GET depot-app-test.herokuapp.com/favicon.ico dyno=web.1 queue=0 wait=0ms service=6ms status=304 bytes=0
2012-07-27T16:46:08+00:00 app[web.1]: [2012-07-27 16:46:08] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true 
```

如您所见，有一个 500 内部服务器错误。但是，我不知道是什么原因造成的。我所有的其他模型都工作得很好。这不像我添加了“订单”模型而忘记了迁移。我知道“订单”表正在工作，因为我安装了一个 sql 控制台，我可以看到所有正在记录的条目。此外，它在本地工作得很好。我也这样做是为了查看更多错误报告：

```
config.consider_all_requests_local       = true 
```

但是，我没有得到比“heroku 日志”中更多的信息。任何和所有输入将不胜感激。

**编辑**

订单控制器代码：

```
class OrdersController < ApplicationController
    skip_before_filter :authorize, only: [:new, :create]

  # GET /orders
  # GET /orders.json
  def index
    @orders = Order.paginate page: params[:page], order: 'created_at desc',
      per_page: 10

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @orders }
    end
  end

  # GET /orders/1
  # GET /orders/1.json
  def show
    @order = Order.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @order }
    end
  end

  # GET /orders/new
  # GET /orders/new.json
  def new
    @cart = current_cart
    if @cart.line_items.empty?
      redirect_to store_url, notice: "Your cart is empty"
      return
    end

    @order = Order.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @order }
    end
  end

  # GET /orders/1/edit
  def edit
    @order = Order.find(params[:id])
  end

  # POST /orders
  # POST /orders.json
  def create
    @order = Order.new(params[:order])
    @order.add_line_items_from_cart(current_cart)

    respond_to do |format|
      if @order.save
        Cart.destroy(session[:cart_id])
        session[:cart_id] = nil
        OrderNotifier.received(@order).deliver
        format.html { redirect_to store_url, notice: 
          I18n.t('.thanks') }
        format.json { render json: @order, status: :created,
          location: @order }
      else
        @cart = current_cart
        format.html { render action: "new" }
        format.json { render json: @order.errors,
          status: :unprocessable_entity }
      end
    end
  end

  # PUT /orders/1
  # PUT /orders/1.json
  def update
    @order = Order.find(params[:id])

    respond_to do |format|
      if @order.update_attributes(params[:order])
        format.html { redirect_to @order, notice: 'Order was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @order.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /orders/1
  # DELETE /orders/1.json
  def destroy
    @order = Order.find(params[:id])
    @order.destroy

    respond_to do |format|
      format.html { redirect_to orders_url }
      format.json { head :no_content }
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T17:43:54.507

我认为问题出在您的邮件程序上，请尝试使用 sendgrid

devcenter.heroku.com/articles/sendgrid#usage

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:50:30.043

我在您的错误日志中注意到您正在发送电子邮件，这可能会导致问题。Heroku 不会为您发送电子邮件，因此您需要使用 gmail 或获取附加组件。

Heroku 电子邮件参考：[https ://devcenter.heroku.com/articles/smtp](https://devcenter.heroku.com/articles/smtp)

关于 gmail 和 actionmailer 的 Stackoverflow 帖子：[在 Rails 3 中设置 Gmail 帐户以使用 ActionMailer](https://stackoverflow.com/questions/4929680/setting-up-a-gmail-account-to-work-with-actionmailer-in-rails-3)

# httpmodule - 输出缓存和 HttpModule

> ID：11692398
> 
> 赞同：0
> 
> 时间：2012-07-27T17:05:07.087
> 
> 标签：httpmodule, outputcache

我有一个 HTTP 模块，它用我们的 CDN 的 URL 替换静态内容的相对 URL。然而，当这个模块被添加到 web.config 时，它会导致我们的 Outputcache 不再工作。

我试过在 web.config 中弄乱 httpModules 的顺序，但没有运气。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T11:33:47.357

也许您在 HttpModule 中调用 Response.End()。里克斯特拉尔写道：

> ...在请求结束时指定 Response.End() 代码会导致 UpdateRequestCache() 永远不会触发并将内容放入缓存中。更多信息：[不要将 Response.End() 与 OutputCache 一起使用](http://www.west-wind.com/weblog/posts/2009/May/21/Dont-use-ResponseEnd-with-OutputCache)

# python - 在 django 中验证 url 而无需在运行时进行

> ID：11692401
> 
> 赞同：0
> 
> 时间：2012-07-27T17:05:10.313
> 
> 标签：python, django, validation, hyperlink

我的问题是我用 django 建立的网站有 100 个指向 YouTube 视频的链接，因此我们可以将它们嵌入到我们的页面中。

我不想验证模板中是否存在 url，因为这似乎是资源的腰部。有没有办法每天测试一次所有链接并在 MySQL 数据库中对它们进行标记？这样，模板甚至不会查看坏链接，这应该会加快页面加载时间。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:17:08.257

这似乎[是重复的](https://stackoverflow.com/questions/1383073/how-do-i-check-if-a-video-exists-on-youtube-using-php)，但由于您是 StackOverflow 的新手，我只会说“嗨”，欢迎您。

转到我引用的帖子以获取有关如何解决问题的一些建议，然后阅读[python`urllib2`文档](http://docs.python.org/library/urllib2.html)，然后您应该能够在 django 之外编写一个连接到您的数据库并检查 YouTube API 的小型 python 脚本对于每个 URL。标记那些不存在的，你就是金色的。

# c++ - 本地坐标到地心

> ID：11692407
> 
> 赞同：0
> 
> 时间：2012-07-27T17:05:32.927
> 
> 标签：c++, vector

我已经花了一个多星期的时间试图为此研究解决方案，但到目前为止一无所获。

给定一个单位矩阵作为我们的起始位置和方向。然后使用 geotrans 和已知的起始位置的纬度、经度和高度，我得到一个 x、y、z 地心坐标。从 (0,0,0) 的原点开始的归一化向量给出了矩阵的向上和平移。但是，我需要向前和向右，以便我可以将距离原点以米为单位的距离传递到变换矩阵中，并获得大致准确的 GCC。我是否拥有计算正确和向前所需的所有输入？

输入
原点：0、0、0
全局：-1645380、-4885138、3752889
向上（标准化）：全局 - 原点

所需的输出
正确：？? ?
向前： ？? ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T20:24:44.133

这个答案和其他两个也可以在这里找到。
[https://gis.stackexchange.com/questions/30448/local-coordinate-to-geocentric](https://gis.stackexchange.com/questions/30448/local-coordinate-to-geocentric)

给定大地坐标 (GDC) 的单个输入

前两个步骤由 geotrans 在“后台”完成了很多工作，至少可用于 C/C++ 和 Java。它解释了地球的椭圆体性质，并且可以从一个坐标系到另一个坐标系进行多次转换。
1) 将 GDC 转换为地心坐标 (GCC) = vector3 原点
2) 获取原点上方 100m 的点的 GCC = vector3 AboveOrigin

矩阵的“向上”分量非常简单，只是从原点上方的点到原点的向量。当我实现这个时，我认为它是倒退的，应该是 AboveOrigin - Origin 但由于我不明白的原因，它与描述的一样。
3) vector3 Up = Origin - AboveOrigin
4) 向上标准化

你需要一个垂直于你真正的前向或北向矢量和你的真正权利的矢量。你的真正向上和直向上正 Z 的叉积，它是通过 GCC 中用于地理传输的轴，将为你提供一个临时右向量。
5) vector3 temp = 与 vector3 (0,0,1) 交叉
6) 归一化 temp

这是您的最终前向或北向矢量
7) vector3 forward = Up cross temp
8) Normalize forward

现在重新计算右或东向量
8) vector3 right = Up cross temp
9) Normalize right
10) 用 forward、right、up 和 origin 初始化你的 4x4 矩阵

例如：在我们的地图上，我们有标签以十进制度数描述地图的顶部、底部、左侧和右侧边缘。从那里我们得到中心并指向中心上方。

中心 - (-1645379.875, -4885137.5, 3752889)
上方 - (-1645406, -4885214, 3752948)

只需这两点，您就可以按照这些步骤获得一个矩阵，该矩阵可以应用于局部空间中的坐标，并在 GCC 中取回一个相当准确的点。

为了测试这一点，我通过 geotrans 在地图上找到了 9 个点、地图的中心、四个角以及每个边缘中间的四个点。忽略地球的曲率并知道这是一张小地图，我只取了 GCC 中地图中心到四个边缘的平均距离。然后，我使用该 X/Y 距离生成 9 个局部坐标以通过矩阵并与通过 geotrans 找到的点进行比较。在测试转换点与 geotrans 点的距离时，最差的结果是顶部中间和右上角，误差为 57.3 厘米，左侧中间为 0 或接近 0。

# file-upload - ZF2的文件上传模块

> ID：11692408
> 
> 赞同：2
> 
> 时间：2012-07-27T17:05:37.567
> 
> 标签：file-upload, module, zend-framework2

我想将文件上传功能集成到使用`ZF2`. 我在互联网上找到了一些材料（[link1](http://www.deanclatworthy.com/2012/07/unique-filenames-when-uploading-using-zend_filter_file_rename-zend-framework/)，[link2](http://www.fgsoft.se/blog/26-upload-file-using-zend-framework)），但每次文件上传都是通过当前控制器中的表单处理的。

在我的应用程序中，有许多控制器可供用户上传文件，我也对每个上传的文件进行了相当多的处理（*例如授权、创建缩略图、收集文件大小、图像尺寸、页数等信息）在文档中...*），因此我想将与文件上传相关的代码集中在一个地方。

我在想我可以从不同的控制器渲染文件上传表单，但`form` `action`总是指向相同的`URL`（例如`/uploads`）并让我的路由将这些文件发送到一个`Uploads`模块。我一直没有成功地寻找`ZF2`文件上传模块，`google`所以[`ZF2 modules site`](http://modules.zendframework.com/)我认为这可能不是一个好主意，因此我的问题是：

**在一个控制器中生成文件上传表单并在单独模块的控制器中处理文件上传的限制是什么（*我无法使用哪些有用的功能）？***

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-28T22:27:58.413

要创建文件上传表单字段，您需要执行以下操作：

```
use Zend\Form\Element;
use Zend\Form\Form;

$file = new Element('file');
$name->setAttributes(array(
    'type' => 'Zend\Form\Element\File',
    'label' => 'Upload file',
));

$form = new Form('myform');
$form->add($file); 
```

在视图方面：

```
<?php
$form->setAttribute('action', $this->url('one_of_the_routes'));
$form->setAttribute('method', 'post');
$form->setAttribute('enctype', 'multipart/form-data');
?>

<?php echo $this->form()->openTag($form); ?>
<p>
    <?php echo $this->formLabel($form->get('file')); ?>
    <?php echo $this->formInput($form->get('file')); ?>
</p>
<?php echo $this->form()->closeTag(); ?> 
```

目前验证器方面存在问题（至少在我上次检查时），但我相信它会很快得到修复。同时，我只是从模型中接近 $_FILES。

注： http: [//framework.zend.com/issues/browse/ZF2-327](http://framework.zend.com/issues/browse/ZF2-327)

并阅读该人：[http ://packages.zendframework.com/docs/latest/manual/en/modules/zend.form.quick.start.html](http://packages.zendframework.com/docs/latest/manual/en/modules/zend.form.quick.start.html)

# c# - 无法使用 c# webbrowser 注销网站

> ID：11692411
> 
> 赞同：0
> 
> 时间：2012-07-27T17:05:43.620
> 
> 标签：c#, webbrowser-control

我正在尝试使用 c# webbrowser 控件来查看 twitter 的移动版本。我的 Windows 窗体中有一个按钮，用于让我退出该站点，但我无法让它工作。

这是直接的html代码：

> span class="w-button-common w-button"> input name="commit" type="submit" value="Sign out" /

我努力了：

**webBrowser1.Document.Forms[0].InvokeMember("submit");**

但是页面上有几个带有 type="submit" 的按钮。

我如何让它点击正确的？

如果您希望我提供页面的完整来源，请询问:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:34:33.687

过去，我使用 WebBrowser 控件通过 javascript 调用直接与 DOM 交互，如下所示：

```
browser.Navigate(string.Format(@"javascript:void({0})", jsAction)); 
```

当然我知道你已经用 InvokeMemeber() 做过类似的事情，但是由于我对 WebBrowser 界面没有进一步的经验，所以我只能谈谈我之前所说的。使用 javascript，我可以实现真实用户可以实现的任何结果。使用我描述的方法，您可以尝试在 javascript 上下文中枚举您尝试处理的控件，然后调用该`.click`函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-06T08:25:54.027

嗯，用正常的点击方法试试吧。

获取一个 HtmlElementCollection

`HtmlElementCollection collection = webBrowser1.Document.getElementsByTagName("select");`

在调试模式下查看它，直到您知道哪个是您的按钮。

比执行点击：

```
collection[x(whereever your button is)].InvokeMember("click"); 
```

# asp.net - 我无法将面板的可见属性（1 到 6）从 false 更改为 true，它们包含在 loginview 中，任何人都可以帮助我

> ID：11692412
> 
> 赞同：0
> 
> 时间：2012-07-27T17:05:54.023
> 
> 标签：asp.net, vb.net, panel, visible

```
Partial Class Details
    Inherits System.Web.UI.Page
    Private Sub Hiding()
        Dim Panel1 As Panel
        Dim Panel2 As Panel
        Dim Panel3 As Panel
        Dim Panel4 As Panel
        Dim Panel5 As Panel
        Dim Panel6 As Panel
        Dim menu1 As Menu

        Panel1 = LoginView1.FindControl("Panel1")
        Panel2 = LoginView1.FindControl("Panel2")
        Panel3 = LoginView1.FindControl("Panel3")
        Panel4 = LoginView1.FindControl("Panel4")
        Panel5 = LoginView1.FindControl("Panel5")
        Panel6 = LoginView1.FindControl("Panel6")
        menu1 = LoginView1.FindControl("Menu1")

        Panel1.Visible = False
        Panel2.Visible = False
        Panel3.Visible = False
        Panel4.Visible = False
        Panel5.Visible = False
        Panel6.Visible = False
    End Sub

    Protected Sub Menu1_MenuItemClick(sender As Object, e As System.Web.UI.WebControls.MenuEventArgs)
        Dim Panel1 As Panel
        Dim Panel2 As Panel
        Dim Panel3 As Panel
        Dim Panel4 As Panel
        Dim Panel5 As Panel
        Dim Panel6 As Panel
        Dim menu1 As Menu

        Panel2 = LoginView1.FindControl("Panel2")
        Panel3 = LoginView1.FindControl("Panel3")
        Panel4 = LoginView1.FindControl("Panel4")
        Panel5 = LoginView1.FindControl("Panel5")
        Panel6 = LoginView1.FindControl("Panel6")
        menu1 = LoginView1.FindControl("Menu1")

        If menu1.ID = "Medical and Nursing MDT" Then
            Panel1 = LoginView1.FindControl("Panel1")
            Panel1.Visible = True
        ElseIf menu1.ID = "STACO" Then
            Call Hiding()
            Panel2.Visible = True
        ElseIf menu1.ID = "Infection alerts" Then
            Call Hiding()
            Panel3.Visible = True
        ElseIf menu1.ID = "Discharge and Health" Then
            Call Hiding()
            Panel4.Visible = True
        ElseIf menu1.ID = "Delays" Then
            Call Hiding()
            Panel5.Visible = True
        ElseIf menu1.ID = "Out of hours communcation" Then
            Panel6.Visible = True
        End If

    End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:18:52.107

尝试这样的事情......我知道这段代码是原始的，但它可能会对你有所帮助。

```
'declare local variables

Dim p1 As Panel
'search in the control tree for specific panel - Panel1 is the panel control name
Dim myControls As Control() = Me.Controls.Find("Panel1", False)
'direct cast and assign to local variable
p1 = DirectCast(myControls(0), Panel)

If (myControls.Length > 0) Then
'code for panel logic
End If 
```

HTH - 尼莱什

# regex - 正则表达式获取匹配的子字符串

> ID：11692414
> 
> 赞同：1
> 
> 时间：2012-07-27T17:06:09.570
> 
> 标签：regex

对不起，奇怪的措辞，我不知道如何简洁地描述我需要做的事情......

我需要从系统数据库返回的字符串中提取零件编号的第一部分。零件编号通常具有以下格式：

```
VENDOR FIRST123-SECOND123 
```

`VENDOR`是可选的，分隔连字符也是如此。`FIRST123`如果没有连字符，我需要以, 或最后一个完整的“单词”结尾。

到目前为止，我可以获得`FIRST123-SECOND123`以下内容：

```
[^ ]*$ 
```

我无法弄清楚如何拆分结果匹配以获取任何连字符之前的所有内容。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:11:03.260

您可以使用[前瞻](http://www.regular-expressions.info/lookaround.html)：

```
/[^-\s]+(?=\S*$)/ 
```

这将捕获第一个非连字符、非空白字符序列，该序列仅由非空白字符与结尾分隔。

然而，我想说字符串方法会更有帮助。获取`lastIndexOf(" ")`, 并从那里获取`firstIndexOf("-")`, 然后获取它们之间的子字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T17:11:54.373

这是我得到你想要的东西的正则表达式：

```
[^ ]*\w*(?=-) 
```

你开局不错。`\w*`说“获取所有单词字符”（字母和数字）并`(?=-)`说“最多一个后跟一个破折号”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T17:34:18.943

不妨把我的建议扔在那里。断言在第二个部件号之后没有更多文本。

`/[a-zA-z]\+\d\+[^$]`

# asp.net - 谷歌浏览器在浏览器关闭后保留会话变量

> ID：11692421
> 
> 赞同：9
> 
> 时间：2012-07-27T17:07:01.777
> 
> 标签：asp.net, security, google-chrome, session-state

我正在使用 asp.net 表单版本 4 并使用内置的 FormsAuthentication。我已选择不保留用户。

```
 FormsAuthentication.RedirectFromLoginPage(userIAmUsing, false); 
```

当我在 IE 和 Firefox 中关闭浏览器时。我的会话变量被破坏，当我返回页面时被要求重新登录。但是，在我的 Chrome 设置中，我选中了“从上次中断的地方继续”设置。当我在 Chrome 中关闭浏览器时，它会根据我（开发人员）的意愿保留 cookie。事实上，即使在我退出我的机器之后，会话仍然存在。在这种情况下，有没有人知道我作为开发人员可以做些什么来覆盖这种行为并且不允许会话在浏览器关闭后持续存在？换句话说，即使用户检查了该设置，我能否让 Chrome 的行为与其他浏览器完全一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:26:48.500

Cookie 和会话都有超时。您可以将超时设置为较短，这样 Chrome 就不会在超时后尝试重复使用它们。

*   [设置 .net 会话的超时时间](http://msdn.microsoft.com/en-us/library/h6bb9cz9%28vs.80%29.aspx)
*   [设置 cookie 的超时时间](http://msdn.microsoft.com/en-us/library/system.net.cookie.expires%28v=vs.80%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T11:21:18.930

您唯一能做的就是手动尝试删除卸载处理程序中的 cookie；

```
$(window).unload(function () { /* delete session cookie */ } ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T17:18:35.853

没有资源管理器特定的代码。您可以做的是，跟踪 IP 和浏览器，然后在请求详细信息更改时注销用户。

有帮助吗？

# java - Java项目找不到文件

> ID：11692425
> 
> 赞同：0
> 
> 时间：2012-07-27T17:07:11.910
> 
> 标签：java, file, io

我有一个项目，它找到一个文本文件并将其变成一个字符数组。但是，由于某种原因，它没有找到该文件。这是涉及打开/读取文件的所有代码：

```
public void initialize(){
    try{
    File file = new File(getClass().getResource("/worlds/world1.txt").toString());
    BufferedReader reader = new BufferedReader(
            new InputStreamReader(
                new FileInputStream(file),
                Charset.forName("UTF-8")));
    int c;
    for(int i = 0; (c = reader.read()) != -1; i ++) {
      for(int x = 0; x < 20; x++){
          worlds[1][x][i] = (char) c;
          c = reader.read();
      }
    }
    }catch(IOException e){
        e.printStackTrace();
    }

} 
```

运行时，它在控制台中显示它指向正确的文件，但声称那里不存在任何文件。我已经检查过了，该文件完好无损并且存在。这里可能出了什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T17:13:14.867

你不应该得到这样的资源。您可以使用

```
BufferedReader reader = new BufferedReader(new InputStreamReader(
    getClass().getResourceAsStream("/worlds/world1.txt")
)); 
```

另外，如果在 IDE 中开发应用程序，在打包应用程序时要小心，否则会遇到常见`CLASSPATH`问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:17:21.207

嵌入资源的文件路径是从包根文件夹计算的。假设该`src`文件夹是根包文件夹，请确保该`world1.txt`文件位于`src/worlds/`文件夹中且完整路径为`src/worlds/world1.txt`

第二点，使用以下代码获取嵌入式文件阅读器对象：

```
// we do not need this line anymore
// File file = new File(getClass().getResource("/worlds/world1.txt").toString());

// use this approach
BufferedReader reader = new BufferedReader(
        new InputStreamReader(
            getClass().getResourceAsStream("/worlds/world1.txt"),
            Charset.forName("UTF-8"))); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T17:20:25.667

您尚未指明文件所在的位置。

`getClass().getResource`用于在类路径中定位资源/文件；例如，资源可能被打包在您的 jar 中。在这种情况下，您不能将其打开为`File`; 见拉斐尔的回应。

如果要在文件系统上定位资源/文件，则直接创建 File 对象，无需`getResource()`：

> 新文件（“/worlds/world1.txt”）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-09T06:07:01.833

我正在使用 Netbeans，我得到了类似的结果。当我从 C 驱动器定义文件路径并运行我的代码时，它指出：访问已被拒绝。

以下代码运行良好，只需将您的文件位置回溯到源（src）文件。

```
//EXAMPLE FILE PATH
String filePath = "src\\solitaire\\key.data";

try {
    BufferedReader lineReader = new BufferedReader(new FileReader(filePath));

    String lineText = null;

    while ((lineText = lineReader.readLine()) != null) {
        hand.add(lineText);

        System.out.println(lineText); // Test print of the lines
    }

    lineReader.close(); // Closes the bufferReader

    System.out.print(hand); // Test print of the Array list
} catch(IOException ex) {
    System.out.println(ex);
} 
```

# java - 是否有一种独立于平台的方式以编程方式从 zip/jar 中删除文件？

> ID：11692430
> 
> 赞同：1
> 
> 时间：2012-07-27T17:07:19.503
> 
> 标签：java, io, zip

希望不必解压和重新打包存档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:09:25.123

是的！使用[TrueZip](http://truezip.java.net/)。

> TrueZIP 是一个基于 Java 的虚拟文件系统 (VFS)，它使客户端应用程序能够对存档文件执行 CRUD（创建、读取、更新、删除）操作，就好像它们是虚拟目录一样，即使在多线程环境中使用嵌套的存档文件也是如此。

完全理解 API 需要一些工作，但是一旦你这样做了，你就会发现它在处理涉及压缩文件的各种任务时是多么容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T17:19:55.557

看一下 JDK7 中的[Zip File System Provider](http://download.oracle.com/javase/7/docs/technotes/guides/io/fsp/zipfilesystemprovider.html)，它允许您将 zip 文件视为文件系统，这意味着您可以像处理普通文件一样执行移动、复制、删除、重命名等操作.

另请参阅这篇文章[Java 7：使用 Zip 文件](http://fahdshariff.blogspot.co.uk/2011/08/java-7-working-with-zip-files.html)，其中更详细地解释了如何创建 zip 文件系统并对其执行各种操作。

# c++ - 在 C++ 中将一个指针复制到另一个指针

> ID：11692438
> 
> 赞同：8
> 
> 时间：2012-07-27T17:07:54.570
> 
> 标签：c++, pointers

```
#include <iostream>

using namespace std;

int main(int argc, char **argv) {
    int a=5;
    int *p,*q;

    *p = a;
    *q = *p;  //line 6

    cout<<*p<<p<<*q<<q;

    return 0;
} 
```

该程序挂起。看来问题出在第 6 行。这是为什么呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-27T17:09:00.030

是的，这些是悬空指针，您遇到了未定义的行为。

您不能取消引用指向您不拥有的内存的指针：

```
int* p;
*p; //illegal

int* x = NULL;
*x; //illegal

int* y = new int;
*y; //OK! 
```

正确的版本是：

```
int main(int argc, char **argv) {
    int a=5;
    int *p = new int; 
    int *q = new int;

    *p = a;
    *q = *p;  //line 6

    cout<<*p<<p<<*q<<q;

    delete p; 
    delete q;

    return 0;
} 
```

或者

```
int main(int argc, char **argv) {
    int a=5;
    int *p;
    int *q;

    p = &a;
    q = p;  //line 6

    cout<<*p<<p<<*q<<q;

    return 0;
} 
```

一个更正确的版本：

```
int main(int argc, char **argv) {
    int a=5;
    int p,q;

    p = a;
    q = p;  //line 6

    cout<<p<<p<<q<<q;

    return 0;
} 
```

没有指针:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-27T17:11:52.850

第5行也有问题。你已经声明了指针，但你没有让它们指向任何东西，这不会自动发生。并且像您一样取消引用未初始化的指针可能会使您的程序崩溃。

像这样的东西会更好。

```
int main(int argc, char **argv) {
    int a=5;
    int b, c;
    int *p,*q;

    p = &b; // make p point at b
    q = &c; // make q point at c
    *p = a;
    *q = *p;  //line 6

    cout<<*p<<p<<*q<<q;

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-27T17:12:36.123

您拥有的代码假设没有存储在 p 的东西。

这是你想做的吗？

```
int a=5;
int *p,*q;

p = &a;
q = p;  //line 6

cout<<(*p)<<p<<(*q)<<q; 
```

在上面的代码中，在程序的最后，p和q指向同一个地址——整数a的存放地址

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T17:48:20.027

可以使用另一个变量复制两个指针，如下所示

```
#include<iostream>
using namespace std;

int main()
{
int *p,*q;
int a = 5;
p = &a;
q = &(*p);
a = 10;
std::cout<<*p<<std::endl;
std::cout<<*q<<std::endl;
} 
```

然而，在上面的这个例子中，两个指针指向的地址并不相同。这将使两个指针都由变量 a 在 C++ 中另一种好方法是使用引用

```
int a = 5;
int& p = a;
int& q = p;
std::cout<<p<<std::endl;
std::cout<<q<<std::endl;
std::cout<<&p<<std::endl;
std::cout<<&q<<std::endl; 
```

结果：
5
5
0xbf9e7498
0xbf9e7498

# bash - 如何使用 bash 在后台选择性地执行命令？

> ID：11692439
> 
> 赞同：0
> 
> 时间：2012-07-27T17:07:57.643
> 
> 标签：bash, background, parallel-processing

我想在后台和 bash 中*选择性地执行一组命令。*像这样的东西

```
#!/bin/bash
BGR=""
if [ foo ] ; then
   BGR=\&
fi
cmd1 $BGR
cmd2 $BGR
cmd3 $BGR
wait 
```

但这对于 bash 来说似乎是不可能的。如果`foo`为真，则命令评估为

```
+ cmd1 '&'
+ cmd2 '&'
+ cmd3 '&' 
```

所以 & 只是另一个论点。

**有没有其他方法可以实现这一目标？**除了代码重复之外，我还编写了具有不同行为的 if/then/else 块。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T17:13:04.273

您可以将 if-else-clause 移动到函数中以避免代码重复，例如：

```
function execute() {
    if [[ -n "$BGR" ]]; then
        "$@" &
    else
        "$@"
    fi
}

execute cmd1 arg1
execute cmd2 arg2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-22T10:11:51.170

```
eval cmd1 $BGR
eval cmd2 $BGR
eval cmd3 $BGR
wait 
```

# .htaccess - 通过 301 重定向重定向过时的类别和子产品

> ID：11692457
> 
> 赞同：0
> 
> 时间：2012-07-27T17:09:12.980
> 
> 标签：.htaccess, redirect

我目前（合并）移动类别，子产品将不复存在。由于我们有很多产品，因此重定向父类别下的所有产品是有意义的。

**示例网址：**

```
http://www.domain.com/chandeliers/modern-chandeliers/* 
```

（其中 '*' = 子产品/网址）

**重定向网址：**

```
http://www.domain.com/chandeliers/ 
```

**当前显示为：**

```
RewriteCond %{HTTP_HOST} ^.*$
RewriteRule ^chandeliers\/modern-chandeliers\/$ "http\:\/\/www\.domain\.com\/chandeliers\/" [R=301,L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T18:20:59.803

将您的规则更改为：

```
RewriteRule ^chandeliers/modern-chandeliers/ http://www.domain.com/chandeliers/ [R=301,L] 
```

被`$`删除，因为我们只想匹配`modern-chandeliers/`. 还删除了引号和不需要的转义。您也不需要`RewriteCond`，因为它不会影响任何东西。请注意，这使得如果有人去`http://www.domain.com/chandeliers/modern-chandeliers/a-product-uri`，他们会被重定向到`http://www.domain.com/chandeliers/`，无论`modern-chandeliers/`. 如果您还想在 之后包含所有内容`modern-chandeliers/`，则您的规则需要如下所示：

```
RewriteRule ^chandeliers/modern-chandeliers/(.*)$ http://www.domain.com/chandeliers/$1 [R=301,L] 
```

这使得当有人请求时`http://www.domain.com/chandeliers/modern-chandeliers/a-product-uri`，他们会被重定向到`http://www.domain.com/chandeliers/a-product-uri`.

或者，您可以放弃 mod_rewrite 并为此使用 mod_alias ：

```
Redirect 301 /chandeliers/modern-chandeliers /chandeliers 
```

# jquery - 无法让 submit() 工作

> ID：11692464
> 
> 赞同：4
> 
> 时间：2012-07-27T17:09:59.627
> 
> 标签：jquery

每当我尝试提交表单时，我都会收到错误，或者如果我在控制台中手动输入，则会收到以下错误：

```
RangeError: Maximum call stack size exceeded 
```

这是我的代码：

```
$(document).ready(function() {
    $('#contact').on('submit', function(event) {
        event.preventDefault();
        var valid = 1;
        var name = $('input[name$="name"]');
        var email = $('input[name$="email"]')
        var phone = $('input[name$="phone"]');
        var comment = $('input[name$="comment"]');
        if (!name.val() && valid == 1) {
            valid = 0;
            alert('Please fill out the Name field');
            name.focus();
        }
        if (!email.val() && valid == 1) {
            valid = 0;
            alert('Please fill out the E-mail Address field');
            email.focus();
        }
        if (!phone.val() && valid == 1) {
            valid = 0;
            alert('Please fill out the Phone field');
            phone.focus();
        }
        if (valid == 1) {
            $('#contact').submit();
        }
    })
}); 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-27T17:11:57.727

您正在从提交处理程序调用提交，因此它是无限递归。`true`如果有效，您想返回，`false`否则。

**编辑：**哦，我不确定在这种情况下你想阻止默认。

# c# - 如何使用.net webapi保存对象

> ID：11692470
> 
> 赞同：3
> 
> 时间：2012-07-27T17:10:20.353
> 
> 标签：c#, windows-8, windows-runtime, asp.net-web-api, azure-sql-database

我在 .net 中创建了 WebAPI（我的第一个）。使用这个 api 从数据库中获取对象、查询数据库等对我来说很容易。没什么新鲜的

但我想知道如何使用这个 webapi 保存一个对象？

我有一个与我的 webapi 通信的 clinet 应用程序（平板电脑、手机、PC）。从我的应用程序中可以保存用户新闻。现在我需要将它保存在数据库中。我使用 Azure SQL。现在我怎样才能将这个对象传递给 API 以便我可以保存它？

对于我的应用程序，我使用 C#/XAML 对于我的 WebAPI，我使用 .NET

我正在使用以下代码：

```
HttpClient httpClient = new HttpClient();
        String u = this.apiUrl + "sd/Localization/insert";
        Uri uri = new Uri(u);
        HttpRequestMessage httpRequestMessage = new HttpRequestMessage(HttpMethod.Post, uri); 
```

但我不知道如何发送对象？我应该序列化它吗？如果是，如何通过邮寄方式发送。

// 更新

我已经构建了这个

```
 HttpClient httpClient = new HttpClient();
        String u = this.apiUrl + "sd/Localization/insert";
        Uri uri = new Uri(u);
        HttpRequestMessage httpRequestMessage = new HttpRequestMessage(HttpMethod.Post, uri);
        httpRequestMessage.Content = new StringContent("{'Name':'Foo', 'Surname':'Bar'}");
        await httpClient.PostAsync(uri, httpRequestMessage.Content); 
```

但在我的 API 中，变量为空

这是来自我的 api 的代码

```
 // POST sd/Localization/insert
    public void Post(string test)
    {
        Console.WriteLine(test);
    } 
```

“测试”变量为空。我究竟做错了什么 ？

// 更新 2

```
 using (HttpClient httpClient = new HttpClient())
        {
            String u = this.apiUrl + "sd/Localization/insert";
            Uri uri = new Uri(u);
            HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, uri)
            {
                Method = HttpMethod.Post,
                Content = new StringContent("my own test string")
            };

            await httpClient.PostAsync(uri, request.Content);
        } 
```

路由配置

```
public class RouteConfig
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "sd/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional }
        );

        routes.MapRoute(
            name: "Default",
            url: "{controller}/{action}/{id}",
            defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
        );
    }
} 
```

在你所有的答案之后，我已经创建了这个，但我的 api 中的参数仍然为空。错误在哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T17:22:03.120

WebAPI*非常*擅长解析发送给它的数据并将其转换为 .NET 对象。

我不习惯使用带有 WebAPI 的 C# 客户端，但我会尝试以下方法：

```
var client = new HttpClient();
client.PostAsJsonAsync<YourObjectType>("uri", yourObject); 
```

注意：您需要使用`System.Net.Http`（来自具有相同名称的程序集）以及`System.Net.Http.Formatting`（也来自具有相同名称的程序集）为此。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T22:49:42.013

该类`HttpRequestMessage`有一个名为（抽象类）`Content`类型的属性。`HttpContent`您可以在那里设置请求正文。例如，您可以在此处设置 JSON 内容，然后将其发送到 API：

```
HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, uri) { 

    Content = new StringContent("{'Name':'Foo', 'Surname':'Bar'}")
}; 
```

您还可以使用格式化功能并将 CLR 对象提供给格式化程序`ObjectContent`并将序列化委托给格式化程序。

这里有很多关于 HttpClient 和 Web API 的示例：http: [//blogs.msdn.com/b/henrikn/archive/2012/07/20/asp-net-web-api-sample-on-codeplex.aspx](http://blogs.msdn.com/b/henrikn/archive/2012/07/20/asp-net-web-api-sample-on-codeplex.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-27T23:12:52.653

假设您的 Web API 控制器上有一个支持 POST 操作的操作方法，该操作类似于：

```
[HttpPost()]
public HttpResponseMessage Post(YourObjectType value)
{
    try
    {

        var result      = this.Repository.Add(value);

        var response = this.Request.CreateResponse<YourObjectType>(HttpStatusCode.Created, result);

        if (result != null)
        {
            var uriString               = this.Url.Route(null, new { id = result.Id });
            response.Headers.Location   = new Uri(this.Request.RequestUri, new Uri(uriString, UriKind.Relative));
        }

        return response;
    }
    catch (ArgumentNullException argumentNullException)
    {
        throw new HttpResponseException(
            new HttpResponseMessage(HttpStatusCode.BadRequest)
            {
                ReasonPhrase    = argumentNullException.Message.Replace(Environment.NewLine, String.Empty)
            }
        );
    }
} 
```

您可以使用 HttpClient 将您的对象序列化为 JSON 并将内容发布到您的控制器方法：

```
using (var client = new HttpClient())
{
    client.BaseAddress  = baseAddress;
    client.Timeout      = timeout;

    using (var response = client.PostAsJsonAsync<YourObjectType>("controller_name", yourObject).Result)
    {
        if (!response.IsSuccessStatusCode)
        {
            // throw an appropriate exception
        }

        result  = response.Content.ReadAsAsync<YourObjectType>().Result;
    }
} 
```

*   ASP.NET MVC 4 的 NuGet 包（它为您提供 Web API 框架）可在[http://nuget.org/packages/AspNetMvc](http://nuget.org/packages/AspNetMvc)获得。
*   [位于http://msdn.microsoft.com/en-us/library/hh849329(v=vs.108).aspx](http://msdn.microsoft.com/en-us/library/hh849329%28v=vs.108%29.aspx)的 Web API 参考 。

我还建议看一下[创建支持 CRUD 操作的 Web API](http://www.asp.net/web-api/overview/creating-web-apis/creating-a-web-api-that-supports-crud-operations)，它涵盖了您所描述的场景，特别是*创建资源*部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-29T14:39:34.543

我想我找到了解决方案，这就是为什么我将其发布为答案而不是评论，以便以后的任何讨论都可以分组。

如果我这样发送请求

```
using(HttpClient client = new HttpClient()) {
    await client.PostAsync(uri, new StringContent("my own string");
} 
```

比我可以在我的 webapi 中得到它

```
await Request.Content.ReadAsStringAsync(); 
```

IMO 这不是完美的解决方案，但至少我正在追踪。我看到函数定义中的参数只有在我发送 POST 请求时才能在 URL 中获得。

当我使用比 String 更复杂的对象时，这个解决方案可能也会起作用（我还没有检查过）。

来自某人的任何想法。您认为这是一个好的解决方案吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-20T18:05:53.730

我希望这将是您正在寻找的。

我创建了一个通用帖子，它将接受任何对象并将其发布到
**客户端**

```
public async Task<HttpResponseMessage> Post<T>(string requestUri, T newObject) where T : class
{
  using (var client = new HttpClient())
  {
     client.BaseAddress = this.HttpClientAddress;
     client.DefaultRequestHeaders.Accept.Clear();
     client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue("application/json"));
     var content = JsonConvert.SerializeObject(newObject, this.JsonSerializerSettings);
     var clientAsync = await client.PostAsync(requestUri, new StringContent(content, Encoding.UTF8, "application/json"));
     clientAsync.EnsureSuccessStatusCode();

     return clientAsync;
   }
} 
```

对此的调用将非常简单

```
public async Task<int> PostPerson(Models.Person person)
{
  //call to the generic post 
  var response = await this.Post("People", person);

  //get the new id from Uri api/People/6 <-- this is generated in the response after successful post
  var st =  response.Headers.Location.Segments[3];

  //do whatever you want with the id
  return response.IsSuccessStatusCode ? JsonConvert.DeserializeObject<int>(st) : 0;
} 
```

此外，如果您的用例需要，您可以在发布后使​​用 ReadAsStringAsync() 读取对象。

**服务器端**

```
// POST: api/People
  public IHttpActionResult Post(Models.Person personDto)
    {

        if (!ModelState.IsValid)
        {
            return BadRequest(ModelState);
        }

        var person = new Entities.Person
                     {
                             FirstName = personDto.FirstName,
                             LastName = personDto.LastName,
                             DateOfBirth = personDto.DateOfBirth,
                             PreferedLanguage = personDto.PreferedLanguage

                     };
        _db.Persons.Add(person);
        _db.SaveChanges();
        return CreatedAtRoute("DefaultApi", new { id = person.Id }, personDto);
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-27T17:27:36.543

我不熟悉 HttpClient（我相信它是 .NET 4.5），但 WebAPI 背后的概念是使用标准的 RESTful 结构。如果要通过 WebAPI 插入对象，则需要向服务发送 POST 请求。您应该将对象的内容放入请求的 BODY 中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-25T16:51:46.227

将空构造函数添加到您的 webapi 模型人员。这将为您节省我浪费在试图弄清楚为什么我的对象为空的所有时间。序列化（我想是反序列化）需要默认构造函数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-06-30T04:13:54.343

这是我的方式。它成功了。我希望它有帮助 Fisrt：是你必须拥有的所有库。你可以从 nuget 下载

**使用 Newtonsoft.Json；**并 **使用 Newtonsoft.Json.Linq；**

## 客户 ：

```
HttpClient client = new HttpClient();

//this is url to your API server.in local.You must change when u pushlish on real host
Uri uri = new Uri("http://localhost/");
client.BaseAddress = uri;

//declared a JArray to save object 
JArray listvideoFromUser = new JArray();

//sample is video object
VideoModels newvideo = new VideoModels();

//set info to new object..id/name...etc.
newvideo._videoId = txtID.Text.Trim();

//add to jArray
listvideoFromUser.Add(JsonConvert.SerializeObject(newvideo));

//Request to server
//"api/Video/AddNewVideo" is router of API .you must change with your router
HttpResponseMessage response =client.PostAsJsonAsync("api/Video/AddNewVideo", listvideoFromUser).Result;
if (response.IsSuccessStatusCode){
    //show status process
     txtstatus.Text=response.StatusCode.ToString();
}
else{
    //show status process
    txtstatus.Text=response.StatusCode.ToString();
} 
```

**服务器端：**

```
[Route("api/Video/AddNewVideo")]
[System.Web.Http.HttpPost]
public HttpResponseMessage AddNewVideo(JArray listvideoFromUser){
    if (listvideoFromUser.Count > 0){
        //DeserializeObject: that object you sent from client to server side. 
        //Note:VideoModels is class object same as model of client side
        VideoModels video = JsonConvert.DeserializeObject<VideoModels>(listvideoFromUser[0].ToString());

        //that is just method to save database
        Datacommons.AddNewVideo(video);

        //show status for client
        HttpResponseMessage response = new HttpResponseMessage { StatusCode = HttpStatusCode.Created };
        return response;
    }
    else{
        HttpResponseMessage response = new HttpResponseMessage { StatusCode = HttpStatusCode.InternalServerError };
        return response;
    }
} 
```

**全部做完 ！**

# asp.net - 使用自定义数据库的登录控制

> ID：11692471
> 
> 赞同：0
> 
> 时间：2012-07-27T17:10:23.527
> 
> 标签：asp.net, database

我有个问题！

我有一个数据库。有两个字段用户名和密码。

我在 VS 中使用登录控制。

现在我想使用登录控制连接到我的数据库。

我怎么能做到！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T17:12:25.663

您必须设置自定义成员资格提供程序并在 web.config 文件中对其进行配置。阅读：[http ://www.asp.net/web-forms/videos/how-do-i/how-do-i-create-a-custom-membership-provider](http://www.asp.net/web-forms/videos/how-do-i/how-do-i-create-a-custom-membership-provider)

登录控件使用成员资格提供程序的 ValidateUser 方法来检查用户是否有效。

或者：覆盖 LoggingIn 事件，覆盖默认行为以通过用户 ID 和密码手动查找用户。这种方法不需要会员提供者。

# c# - 表单关闭时如何退出后台线程？

> ID：11692473
> 
> 赞同：0
> 
> 时间：2012-07-27T17:10:24.367
> 
> 标签：c#

我`tcpListener.AcceptTcpClient()`在它自己的线程中调用。因为这会永远阻塞，所以当我的表单关闭时线程不会退出。我尝试调用`listenThread.Abort()`，但线程没有退出。它卡在`AcceptTcpClient()`.

当我关闭主窗体时，如何让我的整个程序关闭？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T17:12:33.780

`Thread.IsBackgroundThread`在启动侦听器线程之前设置为 true。这将阻止它在所有其他（非后台）线程退出时保持进程运行。

一个可能更好（如果更复杂）的解决方案是切换到异步 API，如@JohnKoerner 链接的问题的公认答案中所述。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T17:26:27.877

两个单独的问题：

1.  如何停止线程阻塞应用程序退出（在其他答案中处理）

2.  如何解除阻塞的 Socket 方法调用（从而在您想要停止接受客户端但保持应用程序运行时使您的代码更具可重用性）

要让线程优雅地退出，您可以在侦听套接字上调用 Dispose：

```
tcpListener.Server.Dispose() 
```

这将导致所有被阻止的操作失败并出现 SocketException。抓住这个，处理它并让线程终止。

# r - 使用某种 bind() 函数创建一个带有嵌套模型系数的 data.frame？

> ID：11692475
> 
> 赞同：3
> 
> 时间：2012-07-27T17:10:28.220
> 
> 标签：r

我认为我有一个好主意，但不知道如何实施。我目前正在运行许多嵌套模型。例如：

```
y<-c(1, 0, 1, 1, 1, 1, 1, 1, 0)
x1<-c(1, 0, 9, 9, 1, 9, 2, 1, 0)
x2<-c(1, 2, 3, 5, 4, 2, 4, 5, 1)
x3<-c(1, 2, 1, 4, 1, 3, 4, 8, 3)

model1 <-lm(y~x1)
model2 <-lm(y~x1+x2)
model3 <-lm(y~x1+x2+x3)

model1_output<-(summary(model1 )$coefficients[1])
model2_output<-(summary(model1 )$coefficients[1])
model3_output<-(summary(model1 )$coefficients[1]) 
```

然后，我想将我的所有输出放在一个数据表中，该数据表沿行（变量名）匹配，但将新系数插入到它们自己的列中。我希望 data.frame 将我的示例的输出显示为：

```
 b(Model 1)  b(Model 2) b(Model 3)
 (Intercept)  0.59217    0.2555     0.27983
 x1           0.05220    0.04116    0.0375
 x2              NA      0.12530    0.15142
 x3              NA      NA        -0.02994 
```

我确信使用 plyr() 包（或其他包！）必须有一些聪明的方法来做到这一点，但似乎无法弄清楚。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T17:58:15.313

使用另一个问题的[答案](https://stackoverflow.com/questions/7962267/cbind-a-df-with-an-empty-df-cbind-fill)：

```
cbind.fill<-function(...){
    nm <- list(...) 
    nm<-lapply(nm, as.matrix)
    n <- max(sapply(nm, nrow)) 
    do.call(cbind, lapply(nm, function (x) 
    rbind(x, matrix(, n-nrow(x), ncol(x))))) 
} 
```

你可以这样做：

```
do.call(cbind.fill,lapply(list(model1,model2,model3),function(x){coef(x)}))

                  [,1]       [,2]        [,3]
(Intercept) 0.59216966 0.25551154  0.27982881
x1          0.05220228 0.04116431  0.03754457
                    NA 0.12530141  0.15142340
                    NA         NA -0.02993768 
```

然后手动设置行名和列名。（请注意，如果这对您很重要，这将返回一个矩阵，而不是数据框。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:59:04.353

试试下面的。我尽量保持一般性，并从[这里](https://stackoverflow.com/questions/5542542/using-cbind-on-an-arbitrarily-long-list-of-objects)借了一些帮助。

```
models <- list(model1=model1,model2=model2,model3=model3)    

#Find out which model (by index) has the most coefficients.
max.model <- which.max(unlist(lapply(models, function(x) length(x[[1]]))))

#How many coefficients there are in the 'biggest' model (including intercept)
max <- length(models[[max.model]][[1]])

#Create list of coefficients, replacing blank spaces with NA
coeff <- lapply(models, function(x) c(x[[1]],rep(NA,max-length(x[[1]]))))

#See the link above
result <- do.call(cbind,coeff)

colnames(result) <- names(models)

rownames(result) <- names(models[[max.model]][[1]]) 
```

结果：

```
> result
                model1     model2      model3
(Intercept) 0.59216966 0.25551154  0.27982881
x1          0.05220228 0.04116431  0.03754457
x2                  NA 0.12530141  0.15142340
x3                  NA         NA -0.02993768 
```

我试图保持通用的意思是这适用于任何数量的模型。只有第一行代码需要更改。

# c++ - 查看 Doxygen 文档中的 .cxx 文件以及 .h 文件

> ID：11692476
> 
> 赞同：0
> 
> 时间：2012-07-27T17:10:29.640
> 
> 标签：c++, doxygen

我正在尝试为 C++ 代码包创建 Doxygen 文档。查看生成的 HTML 文档时，我可以查看包的头文件，但无法查看 .cxx 文件，尽管 Doxygen 正在检测 .cxx 文件。您能否建议我如何将 .cxx 文件包含在 HTML 文档中以供查看？

先发制人的感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:24:19.177

尝试设置 SOURCE_BROWSER 变量并告诉我是否有帮助。

# gnuplot - Gnuplot 从文件中垂直绘制

> ID：11692477
> 
> 赞同：2
> 
> 时间：2012-07-27T17:10:33.193
> 
> 标签：gnuplot

我有一个具有以下结构的文件 VERTICAL.txt：

```
201
269
614
669
705 
```

使用脚本 traffic.gp ：

```
set terminal jpeg size 1024,768
set title "traffic path 0" 
set xlabel "Simulation duration"
set ylabel "Link load (%)"
set grid
set xtics 0,50,1100 
set ytics 0.0,10.0,100.0 
set key below center
plot [0:1100] [0.0:100.0] 'traffic_path0.txt' with lines title "path 0" 
```

我想在 traffic.gp 中使用 VERTICAL.txt 来查看相应的行。

我试图添加：

```
set parametrics
set trange [0:100]
plot VERTICAL.txt , t 
```

但出现以下错误：`"scripts/traffic.gp", line 11: parametric function not fully specified`

我怎么能做到这一点？非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:47:22.990

这是一个有点肮脏的技巧，只有在您不自动缩放 y 轴时才有效：

```
YMIN=0
YMAX=100.0
set yrange [YMIN:YMAX]
plot 'test.dat' u 1:2 w lines, \
     'VERTICAL.txt' u 1:(YMAX) w impulses ls 2, \
     'VERTICAL.txt' u 1:(YMIN) w impulses ls 2 
```

（如果 YMIN 为 0，则 YMIN 部分实际上是不必要的）。

您可以玩的另一个肮脏的技巧是使用箭头和系统命令：

```
set for [a in system("tr '\n' ' '<VERTICAL.txt")] arrow from first a,graph 0 to first a,graph 1 nohead 
```

# javascript - 创建一个 cookie 来控制 Jquery 切换的内容

> ID：11692478
> 
> 赞同：0
> 
> 时间：2012-07-27T17:10:44.587
> 
> 标签：javascript, jquery, html, css, cookies

我想添加一个 cookie 来控制我的可折叠内容是显示还是隐藏。显示站点加载时的默认值。到目前为止，我已经尝试并未能实现 cookie，因此原始代码如下所示。

```
<script type="text/javascript"> 
  $(document).ready(function(){
      $(".toggle_parent").toggle(function(){
      $(".toggled_content").slideUp();
      $("img.upmid").attr('src',"images/downmid.png");
    },function(){
      $(".toggled_content").slideDown();
      $("img.upmid").attr('src',"images/upmid.png");
    });
  });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:17:26.860

您可以通过在每次状态更改时设置 cookie 值并在页面加载时检查该 cookie 值以设置初始状态以匹配先前设置的 cookie 值来执行此操作：

添加此 CSS 以通过关闭使默认状态，因此如果所需的最终状态是关闭的，它最初不会显示为打开然后关闭：

```
.toggled_content {display: none;} 
```

添加这个javascript：

```
<script type="text/javascript"> 
  $(document).ready(function(){

      function hideContent() {
          $(".toggled_content").slideUp();
          $("img.upmid").attr('src',"images/downmid.png");
      }

      function showContent() {
          $(".toggled_content").slideDown();
          $("img.upmid").attr('src',"images/upmid.png");
      }

      // set initial state based on cookie value
      // assumes default state is closed
      if (readCookie("updown") == "down") {
          showContent();
      }

      $(".toggle_parent").toggle(function(){
          hideContent();
          createCookie("updown", "up", 30)
      },function(){
          showContent();
          createCookie("updown", "down", 30);
    });
  });

function createCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function eraseCookie(name) {
    createCookie(name,"",-1);
}

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:18:53.560

去商店，买一包随机饼干。当你来吃每一个时，如果饼干含有巧克力，则折叠内容，否则展开它。:P

更严肃地说，我推荐[jQuery cookies 插件](http://archive.plugins.jquery.com/project/Cookie)——它允许你设置、获取或删除 cookie。在父级上放置一个 ID，并在折叠内容时设置一个包含名称中 ID 的 cookie。展开时取消设置。在页面加载时检查 cookie；如果存在，请进行 slideUp 调用等。

您可能还想查看[jQuery UI](http://jqueryui.com/) - 那里有一些有用的功能可以显示和隐藏内容，例如手风琴。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T17:19:49.467

如果你不介意使用 jQuery 插件，你可以使用[jquery-cookie](https://github.com/carhartl/jquery-cookie)。使用起来非常简单。

设置 cookie：

```
$.cookie("cookie name", "value"); 
```

获取 cookie 值：

```
alert($.cookie("cookie name")); 
```

# php - Css 和不同的浏览器问题

> ID：11692480
> 
> 赞同：2
> 
> 时间：2012-07-27T17:10:49.080
> 
> 标签：php, html, css, coding-style

我正在使用 Html&Css、Php 和 MySql 编写我的第一个博客。

在编写“style.css”代码时，我在网上搜索了任何有用的教程，并且在我阅读的每一篇文章中：关于 Internet Explorer 和 Mac 的注释相同，例如：

```
/* IE5 Mac Hack \*/ 
/*/ 
#main-nav { padding-left: 11px; overflow: hidden; } 
/* End Hack */ 
```

因此，我阅读了一些关于 IE 与 Css 的问题的文章，并找到了描述它的很棒的网站，例如：

```
http://www.webcredible.co.uk/user-friendly-resources/css/internet-explorer.shtml 
```

但是，即使在阅读了这么多文章\网站之后，我仍然是一个不完全了解如何确保我的博客在每个浏览器上都能正常工作的初学者（例如 IE5\6\7、chrome\firefox\mozilla\opera ..等.) ?!

是否有我必须涵盖（照顾）的常见 Browser\Css 问题？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T17:25:57.627

没有为人类已知的每个浏览器编写代码，在每个操作系统上都没有办法证明你的 CSS/HTML 或其他客户端脚本可以在每个浏览器中完全一样地工作，我不在乎你是否在 Mac 上， Linux、微软、Chrominum 等。每个操作系统都有自己的怪癖，每个浏览器和每个操作系统的浏览器版本也是如此。

但是就像其他人指出的那样，除了你做一些非常复杂的事情，几乎所有标准的 CSS xx 和 HTML xx 和 JavaScript 都可以在所有新旧浏览器上正常工作，你肯定会遇到偶尔的打嗝，但同样没有解决这个问题，在我作为开发人员的时候，我认为避免 css “hacks”作为尝试补偿每个浏览器需求的措施，这些浏览器需要通过 php/javascript 使用浏览器检测并提供替代版本特定于该浏览器支持的问题。

还要在您的网站上某个地方知道您在开发中支持哪些浏览器。如果您刚刚开始学习大多数文档，您会发现在以后的几年中将涵盖 CSS3 和 CSS2 以及 HTML5（这与 4 几乎相同，但有一些增强）。因此，在这一天学习起来几乎很容易，您可能会轻松支持 IE 8+、Chrome 10+、Firefox 4+、Opera 8+.. 并且您最大的宝座将是仍在使用 IE 7 的人, 或 Firefox 3-13.5

至于常见的问题，那是一个棘手的问题。虽然我认为最大的一个是位置样式。当谈到固定和绝对时，例如 IE 不喜欢固定位置或者它是绝对的，它的一个或另一个。但通常处理从 DOM 流中分离元素的任何事情都是常见的。在一些旧浏览器中，边距和填充的处理方式也不同。总而言之，如果您非常担心 css/html 和其他客户端脚本并支持尽可能多的浏览器，那么您最终会得到一个非常单调的网站，并且最终会因崩溃而陷入困境。选择一组浏览器，支持这些浏览器，并为自己省点麻烦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T17:16:23.903

[**您可以在此处**](http://www.quirksmode.org/css/contents.html)查看 CSS 浏览器支持图表[](http://www.quirksmode.org/css/contents.html)

 **这让您知道哪个浏览器支持什么。您可以制作多个 css 文件并根据浏览器切换它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-27T17:28:39.183

当您使用 IE9（我也认为是 10）时，在页面上按 F12，它将显示控制台（就像在 chrome 中一样）。控制台实际上有一个功能，您可以选择查看页面，就像在 IE 6、7、8 或 9 中查看的一样。它并不完美，但它非常好。

至于您使用的实际属性和选择器，如果您是初学者，我建议您慢慢来，在使用之前查看每个选择器和属性，并运行快速搜索以找出任何兼容性问题/解决方法.

您还应该记住的一件事是，有时，尽管我们尽最大努力将其最小化，但有些东西无法在那个过时的浏览器（通常是 IE 浏览器）中呈现。这并不总是意味着您永远不应该将这些内容包含在另一个页面中-查看如何在这些情况下制作特定于浏览器的代码和样式-但同时，请确保您没有制作两个完全不同的页面.

尤其是当你刚开始的时候，尽你所能尝试一切，尽你所能。要有创意，最重要的是，玩得开心！

PS 我的第一个完整站点也是一个博客站点（PHP、MySQL、HTML、CSS）。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-27T17:15:05.927

除非你正在做更复杂的 CSS，否则现在大多数东西都可以跨浏览器运行，没有任何问题。您可以使用[http://caniuse.com/](http://caniuse.com/)获取特定的支持详细信息，PPK 的站点 ( [http://quirksmode.org/](http://quirksmode.org/) ) 提供了有关旧浏览器中更多基本支持的信息。

至于在旧版本的 Internet Explorer 中测试，您可以使用微软提供的虚拟机：[https ://www.microsoft.com/en-us/download/details.aspx?id=11575](https://www.microsoft.com/en-us/download/details.aspx?id=11575)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-27T17:15:58.187

根据我的经验，唯一真正知道的方法是自己测试。在大多数情况下，您不应该遇到任何问题，而且通常当您这样做时，它们并不是什么大问题。我还了解到，一起“破解”事物可能看起来是最简单/最好的做事方式，而实际上它只是你身边糟糕的 CSS 可以调整的。话虽如此，您绝对有无法绕过它的时候，这就是野兽的本性。对我来说，最大的麻烦来自于 div。随着您作为开发人员的成长，您将毫无疑问地了解每次都能有效的方法，以及您必须一遍又一遍地测试才能正确的方法。这只是一个实践问题。话虽如此，只要您保持设计简洁明了，就不会太难。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-27T17:18:10.237

您可以使用[Adob​​e browserlab](https://browserlab.adobe.com/en-us/index.html)试验您的 css 并测试每个浏览器上的差异。我建议尝试您的 css 以及您在互联网上找到的内容，然后测试与 browserlab 的兼容性。

据我了解，它是 adobe 的一项补充服务，所以试试吧！

如果这不起作用，您也可以尝试[http://browsershots.org/](http://browsershots.org/)，虽然我从未使用过它，但它应该可以满足您的要求。**

# chef-infra - 从 Ruby 脚本调用 Knife 命令，无需脱壳

> ID：11692486
> 
> 赞同：3
> 
> 时间：2012-07-27T17:11:13.210
> 
> 标签：chef-infra

我继承了一些 shell 脚本，这些脚本有助于使用 Chef 和 Knife 设置我们的应用程序环境。那很好。

但我真正想做的是拥有 Ruby 脚本的强大功能和灵活性来做同样的事情。

如果我全力以赴，`knife`我会丢失命令的实时输出。

似乎我应该能够通过包含“厨师”gem 以及我使用的“cloudstack-fog”插件来从 Ruby 中调用刀的所有功能。

但我还没有找到任何示例或 API 文档。试图挖掘 Chef gem 的来源是一种挫败感。

我不应该能够`knife cloudstack server create -E ...`从 Ruby 脚本中执行等价的操作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T17:57:37.997

您可以使用`Kernel`模块的`system`方法 [1] 来执行此操作，该方法将在子 shell 中执行您的命令并将其输出通过管道传输到您当前的 shell。当我希望能够看到以编程方式构建的参数 Knife 命令（如`knife ssh`.

这是一个示例，我在其中构造和执行可能是非常复杂的命令：

```
查询=“厨师环境：#{环境名称}”
options = [ "-x #{::Chef::Config[:node_name]}" ].join(' ')
command = %Q{knife ssh "#{query}" #{options} "#{chef_command}"}
系统（命令）

```

[1] [http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-system](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-system)

# mysql - sql where 子句中的最后 n 个工作日

> ID：11692490
> 
> 赞同：0
> 
> 时间：2012-07-27T17:11:41.903
> 
> 标签：mysql, timestamp, period

我们使用 MySQL 作为我们的数据库来存储带有时间戳的消息。是否可以创建一个返回最近 n 个工作日的消息的查询？

即如果 n 是 4 并且今天是星期二，我想要来自本周星期一、上周星期五、上周星期四和上周星期三的消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:37:48.257

如果你想直接用 mysql 做这个会有点复杂。正如 Vatev 建议的那样，您应该提前计算日期星日期，但如果您真的想这样做，您可能需要以下函数：

*   [`ADD_DATE`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-add)， 和`INTERVAL -N WEEKS`
*   [`FLOOR`](http://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_floor), 在 C`int/int`中就可以了
*   [`MOD`](http://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_mod), `a % b`:)
*   [`WEEKDAY`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_weekday)

首先你需要计算你应该回去多少周，这很容易......对你来说`one week = 5 days`，这意味着

```
weeks = FLOOR(days / 5) 
```

我们已经处理了几个星期，所以我们现在必须与其他人一起工作：

```
rest = days MOD 5 
```

现在我们有两个案例，周末是否发生，对于没有周末的情况是好的。我们必须增加 2 天才能跳过它。如果周末发生`(WEEKDAY(now) - rest) < 0`

```
rest = IF( (WEEKDAY(now) - rest) < 0, rest + 2, rest) 
```

现在我们可以将其构建为一个标准（假设您已经预先计算过）`{days}`：`{rest}`

```
WHERE date >= ADD_DATE(
    ADD_DATE (
        {now},
        INTERVAL -IF( (WEEKDAY({now}) - {rest}) < 0, {rest} + 2, {rest}) DAYS, 
    ),
    INTERVAL -FLOOR({days} / 5) WEEKS
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T17:21:50.860

我能想到的最好的方法是以您选择的语言计算开始日期（查询中的 {start_date} ），然后运行如下所示：

```
SELECT some_things
FROM your_table
WHERE 
    WEEKDAY(time_column) < 5
    AND time_column >= {start_date}
ORDER BY time_column DESC 
```

您还可以创建一个存储函数来计算“x 周前的日期”并将其用于 {start_date}。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T17:25:58.390

```
COL >= date_sub( NOW(), interval 1 week) and
weekday( COL ) < 5 
```

*   date_sub 是寻找上周创建的行
*   weekday 是排除周日或周六

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T17:19:37.803

你有没有尝试过这样的事情？

```
SELECT columns 
FROM table
WHERE datediff(column_with_timestamp,NOW()) > n 
```

其中 N 是您在上面定义的，您要查找的天数。

# hadoop - HBase completebulkload 返回异常

> ID：11692497
> 
> 赞同：1
> 
> 时间：2012-07-27T17:12:04.803
> 
> 标签：hadoop, mapreduce, hbase, guava

我正在尝试使用Hadoop 文档中[描述的批量加载方法从文本文件（几 GB）中快速批量填充 HBase 表。](http://hbase.apache.org/book.html#arch.bulk.load)

我创建了一个 HFile，现在我想将它推送到我的 HBase 表中。

当我使用这个命令时：

```
hadoop jar /home/hxcaine/hadoop/lib/hbase.jar completebulkload /user/hxcaine/dbpopulate/output/cf1 my_hbase_table 
```

工作开始，然后我得到这个异常：

```
Exception in thread "main" java.lang.NoClassDefFoundError: com/google/common/util/concurrent/ThreadFactoryBuilder
        at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles.doBulkLoad(LoadIncrementalHFiles.java:195)
        at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles.run(LoadIncrementalHFiles.java:696)
        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)
        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:79)
        at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles.main(LoadIncrementalHFiles.java:701)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:68)
        at org.apache.hadoop.util.ProgramDriver.driver(ProgramDriver.java:139)
        at org.apache.hadoop.hbase.mapreduce.Driver.main(Driver.java:49)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.hadoop.util.RunJar.main(RunJar.java:197)
Caused by: java.lang.ClassNotFoundException: com.google.common.util.concurrent.ThreadFactoryBuilder
        at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:248)
        ... 17 more 
```

但是，我可以看到 Guava jar 在我的类路径中，当我检查 jar 内部时，我可以看到`ThreadFactoryBuilder.class`.

我正在使用这些版本（并坚持使用它们）：

*   Hadoop 0.20.2-cdh3u3
*   HBase 0.90.4-cdh3u3
*   番石榴罐：/usr/lib/hadoop-0.20/lib/guava-r09-jarjar.jar

我的类路径中确实有一个较旧的 Guava jar，但我不知道它来自哪里，我不认为它应该有效果。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T17:27:53.287

如果你运行会发生什么：

```
export HADOOP_CLASSPATH=`hbase classpath` 
```

在运行负载之前？从堆栈跟踪来看，其中一项实际任务似乎需要 jar，尽管我很惊讶地看到这实际上启动了 M/R 工作。

# java - 如何将我们的 PC 变成使用 tomcat 的网络服务器

> ID：11692499
> 
> 赞同：0
> 
> 时间：2012-07-27T17:12:11.683
> 
> 标签：java, tomcat, xampp, dsl, router

我正在尝试使用 tomcat 使我的 PC 成为网络服务器。我最后一次这样做是在 6 个月前，我完全做到了。然而，这一次我做不到。我的步骤是：

*   通过转到局域网属性并转到 TCP/IP 4 设置静态 IP，检查使用以下 IP 地址并输入：

![在此处输入图像描述](../Images/d31937e6383b46bd2ae718217e327a6c.png)

*   打开浏览器并输入 192.168.1.1 以访问 DSL 路由器，进行 NAT 并输入如下

![在此处输入图像描述](../Images/9e4fd2a7d6e170ef48f5495e2b47f101.png)

*   去 ip2location.com 查看我的路由器 IP 地址。然后在我的手机浏览器上（使用3G，和我的电脑不一样），输入ip地址+8080端口+/+myproject名称。显示未找到。

![在此处输入图像描述](../Images/3c60cd40664aa1f3dedbc6a75c1be901.png)

我也有xampp，除了这一次，我通常把它关掉来访问tomcat服务器。:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T17:31:04.373

显示的页面可能正在由您的路由器提供服务。

您将路由器配置为将端口（外部）上的所有传入请求重定向到端口（内部）`80`具有 IP 的机器。另一方面，您的手机正在端口上向您的路由器发出请求。`192.168.1.2``80``8080`

我建议`8080`同时设置“Internal Port Start”和“Internal Port End”，并在没有端口的情况下在手机上请求页面，即仅使用从 ip2location 获得的外部 IP。

# php - 停止暴力破解的更好方法？

> ID：11692502
> 
> 赞同：0
> 
> 时间：2012-07-27T17:12:27.333
> 
> 标签：php

> **可能重复：**
> [如何在 PHP 中限制用户登录尝试](https://stackoverflow.com/questions/2090910/how-can-i-throttle-user-login-attempts-in-php)

我有一个系统会在任何人登录失败 3 次后自动拒绝任何人登录十五分钟。我很想知道是否有更好的方法来停止暴力破解而不必使用这个系统，这对我的用户来说可能是一种痛苦？

谢谢。

# android - 滚动视图 + 缩放图像 = 不能正确滚动，为什么不呢？

> ID：11692504
> 
> 赞同：2
> 
> 时间：2012-07-27T17:12:31.700
> 
> 标签：android, xml, imageview, scrollview, scale

我有一张可以缩放到手机/平板电脑宽度的图像。它是 224x1632。图像视图在滚动视图中，我需要能够在该图像上上下滚动。

问题是滚动视图在创建时根据图像大小（长度为 1632）设置，但是当图像缩放/拉伸时，它比原始图像高 3 倍。现在滚动视图太小而无法滚动整个图像。

有什么方法可以使滚动视图适合图像？

注意：每个手机的图像长度会有所不同，因此我无法将其设置为预定大小。

XML 代码：

```
<ScrollView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

   <ImageView
       android:id="@+id/imageView1"
       android:layout_width="fill_parent"
       android:layout_height="fill_parent"
       android:scaleType="centerCrop"
       android:scrollbars="vertical"
       android:src="@drawable/tiles" />

</ScrollView> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T18:46:45.847

您将 ScrollView 的高度设置为 wrap_content，这意味着“与我的内容一样大”。您还将 ImageView 的高度设置为 fill_parent，这意味着“与我的父母一样大”。这些语句中的任何一个都足以防止滚动。你的 ImageView 应该是 wrap_content，你的 ScrollView 应该是 fill_parent。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T13:06:20.940

尝试`scaleType="center"`代替`"centerCrop"`

# ruby-on-rails-3 - View 的测试表明嵌套资源的“无路由匹配”

> ID：11692510
> 
> 赞同：1
> 
> 时间：2012-07-27T17:13:06.177
> 
> 标签：ruby-on-rails-3, rspec, nested-routes

我有一个`Training`嵌套在模型下的`devise` `User`模型。

**/config/routes.rb**

```
devise_for :users, path: 'u'

resources :users, only: ['index','show'], shallow: true do
  resources :trainings
end 
```

**> 耙路线**

```
 new_user_session GET    /u/sign_in(.:format)                    {:action=>"new", :controller=>"devise/sessions"}
            user_session POST   /u/sign_in(.:format)                    {:action=>"create", :controller=>"devise/sessions"}
    destroy_user_session DELETE /u/sign_out(.:format)                   {:action=>"destroy", :controller=>"devise/sessions"}
           user_password POST   /u/password(.:format)                   {:action=>"create", :controller=>"devise/passwords"}
       new_user_password GET    /u/password/new(.:format)               {:action=>"new", :controller=>"devise/passwords"}
      edit_user_password GET    /u/password/edit(.:format)              {:action=>"edit", :controller=>"devise/passwords"}
                         PUT    /u/password(.:format)                   {:action=>"update", :controller=>"devise/passwords"}
cancel_user_registration GET    /u/cancel(.:format)                     {:action=>"cancel", :controller=>"devise/registrations"}
       user_registration POST   /u(.:format)                            {:action=>"create", :controller=>"devise/registrations"}
   new_user_registration GET    /u/sign_up(.:format)                    {:action=>"new", :controller=>"devise/registrations"}
  edit_user_registration GET    /u/edit(.:format)                       {:action=>"edit", :controller=>"devise/registrations"}
                         PUT    /u(.:format)                            {:action=>"update", :controller=>"devise/registrations"}
                         DELETE /u(.:format)                            {:action=>"destroy", :controller=>"devise/registrations"}
          user_trainings GET    /users/:user_id/trainings(.:format)     {:action=>"index", :controller=>"trainings"}
                         POST   /users/:user_id/trainings(.:format)     {:action=>"create", :controller=>"trainings"}
       new_user_training GET    /users/:user_id/trainings/new(.:format) {:action=>"new", :controller=>"trainings"}
           edit_training GET    /trainings/:id/edit(.:format)           {:action=>"edit", :controller=>"trainings"}
                training GET    /trainings/:id(.:format)                {:action=>"show", :controller=>"trainings"}
                         PUT    /trainings/:id(.:format)                {:action=>"update", :controller=>"trainings"}
                         DELETE /trainings/:id(.:format)                {:action=>"destroy", :controller=>"trainings"}
                   users GET    /users(.:format)                        {:action=>"index", :controller=>"users"}
                    user GET    /users/:id(.:format)                    {:action=>"show", :controller=>"users"}
                    root        /                                       {:controller=>"team", :action=>"index"}
                   teams GET    /teams(.:format)                        {:action=>"index", :controller=>"teams"}
                         POST   /teams(.:format)                        {:action=>"create", :controller=>"teams"}
                new_team GET    /teams/new(.:format)                    {:action=>"new", :controller=>"teams"}
               edit_team GET    /teams/:id/edit(.:format)               {:action=>"edit", :controller=>"teams"}
                    team GET    /teams/:id(.:format)                    {:action=>"show", :controller=>"teams"}
                         PUT    /teams/:id(.:format)                    {:action=>"update", :controller=>"teams"}
                         DELETE /teams/:id(.:format)                    {:action=>"destroy", :controller=>"teams"} 
```

测试视图时我有以下输出：

```
Failures:

1) trainings/edit renders the edit training form
   Failure/Error: render
   ActionView::Template::Error:
     No route matches {:controller=>"trainings"}
   # ./app/views/trainings/edit.html.erb:6:in `_app_views_trainings_edit_html_erb___268980906337666865_45435220'
   # ./spec/views/trainings/edit.html.erb_spec.rb:12:in `block (2 levels) in <top (required)>'

2) trainings/index renders a list of trainings
   Failure/Error: render
   ActionView::Template::Error:
     No route matches {:action=>"new", :controller=>"trainings"}
   # ./app/views/trainings/index.html.erb:25:in `_app_views_trainings_index_html_erb___2979006340799666900_47907140'
   # ./spec/views/trainings/index.html.erb_spec.rb:18:in `block (2 levels) in <top (required)>'

3) trainings/show renders attributes in <p>
   Failure/Error: render
   ActionView::Template::Error:
     No route matches {:controller=>"trainings"}
   # ./app/views/trainings/show.html.erb:10:in `_app_views_trainings_show_html_erb__2049701071134787176_46584480'
   # ./spec/views/trainings/show.html.erb_spec.rb:12:in `block (2 levels) in <top (required)>'

4) trainings/new renders new training form
   Failure/Error: render
   ActionView::Template::Error:
     undefined method `trainings_path' for #<#<Class:0x00000004a54688>:0x0000000686bec8>
   # ./app/views/trainings/_form.html.erb:1:in `_app_views_trainings__form_html_erb__4221989810981841567_45123700'
   # ./app/views/trainings/new.html.erb:3:in `_app_views_trainings_new_html_erb__472203814357098165_54200400'
   # ./spec/views/trainings/new.html.erb_spec.rb:12:in `block (2 levels) in <top (required)>' 
```

我不会发布所有测试和所有布局文件，因为它会变得太大。相反，我将为一个视图发布测试和布局文件，并尝试将更正扩展到其他视图。

测试`training#index`是

**/spec/views/trainings/index.html.erb_spec.rb**

```
require 'spec_helper'

describe "trainings/index" do
  before(:each) do
    assign(:trainings, [
      stub_model(Training,
        :user_id => 1,
        :training => "MyText"
      ),
      stub_model(Training,
        :user_id => 1,
        :training => "MyText"
      )
    ])
  end

  it "renders a list of trainings" do
    render
    # Run the generator again with the --webrat flag if you want to use webrat matchers
    assert_select "tr>td", :text => 1.to_s, :count => 2
    assert_select "tr>td", :text => "MyText".to_s, :count => 2
  end
end 
```

**/app/views/index.html.rb**

```
<h1>Listing trainings</h1>

<table>
  <tr>
    <th>User</th>
    <th>Training</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>

<% @trainings.each do |training| %>
  <tr>
    <td><%= training.user_id %></td>
    <td><%= training.training %></td>
    <td><%= link_to 'Show', training %></td>
    <td><%= link_to 'Edit', edit_training_path(training) %></td>
    <td><%= link_to 'Destroy', training, confirm: 'Are you sure?', method: :delete %></td>
  </tr>
<% end %>
</table>

<br />

<%= link_to 'New Training', new_user_training_path(@user) %> 
```

它表明路由不匹配，但它们在那里。为什么会这样？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T15:32:36.483

您的索引视图有`new_user_training_path(@user)`，但您的索引规范没有创建`@user`。就像您创建的一样，`@trainings`您还需要`@user`在视图规范中创建，例如：

```
 before(:each) do
    assign(:user, 
      stub_model(User,
        :id => 1
      )
    )
    # ...
  end 
```

此外，`ActionView::Template::Error: undefined method 'trainings_path' for #<#<Class:...>>`通过将新视图从更改`form_for @training`为`form_for [@user, @training]`（嵌套）来修复错误。

# php - 如何在 Assetic 中为 Compass 和 Yui CSS 使用过滤器？

> ID：11692512
> 
> 赞同：2
> 
> 时间：2012-07-27T17:13:26.163
> 
> 标签：php, symfony, sass, compass-sass, assetic

我有 2 个文件，一个是 .css（在 vendor/somevendor/somelibrary/css/ 内），另一个是 .scss（在 @ProjectMainBundle/Resources/public/css/ 内）。

我希望使用 Sass 过滤器将 .scss 编译为 .css，然后使用 Yui 过滤器缩小两个 .css 文件。我尝试了不同的变体：

```
 {% stylesheets
        '%kernel.root_dir%/../vendor/somevendor/somelibrary/css/somelibrary.css'
        '@ProjectMainBundle/Resources/public/css/*'
        filter='compass,yui_css' %}
        <link rel="stylesheet" type="text/css" media="screen" href="{{ asset_url }}" />
    {% endstylesheets %} 
```

问题是 Sass 过滤器也被应用于 .css 文件，这会引发缩进错误。

在我的 config.yml 中，我添加了相应的“apply_to”参数，但没有帮助：

```
 # Assetic Configuration
    assetic:
            debug:          %kernel.debug%
            use_controller: false
            bundles:        [ProjectMainBundle]
            #java: /usr/bin/java
            filters:
                    cssrewrite: ~
                    #closure:
                    #    jar: %kernel.root_dir%/Resources/java/compiler.jar
                    sass:
                            bin: /usr/local/bin/sass        
                            apply_to: "\.scss$"
                    compass:
                            bin: /usr/local/bin/compass
                            apply_to: "\.scss$"
                    yui_css:
                            jar: %kernel.root_dir%/../vendor/yahoo/yui-compressor/build/yuicompressor-2.4.7.jar
                            apply_to: "\.css$"
                    yui_js:
                            jar: %kernel.root_dir%/../vendor/yahoo/yui-compressor/build/yuicompressor-2.4.7.jar
                            apply_to: "\.js$" 
```

那么我该怎么做呢？我不想有超过 1 个结果 .css。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T17:31:58.757

找到它：[https ://github.com/kriswallsmith/assetic/issues/101](https://github.com/kriswallsmith/assetic/issues/101)

删除 'filter=compass,yui_css' 部分。

# javascript - MVC3 AJAX 将数据传递给控制器 。它被提交了两次

> ID：11692516
> 
> 赞同：0
> 
> 时间：2012-07-27T17:14:10.747
> 
> 标签：javascript, ajax, asp.net-mvc, asp.net-mvc-3

所以我有一个表格，它使用以下方法转换为数组：

```
var result = $("#enrolledStudents").sortable('toArray'); 
```

但是当我把它传给我的控制器时，就像这样：

```
$("#update-enroll").click(function () {
            var result = $("#enrolledStudents").sortable('toArray');
            $.ajax({
                url: '@Url.Action("Enrollment", "Classroom")',
                data: { students: result },
                type: 'POST',
                traditional: true
            });
        }); 
```

我的调试断点设置了两次，导致出现问题。在 POST 上向我的控制器提交数据的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T17:26:35.217

根据我的评论，有几件事可能导致这种情况。

1.  您已多次加载不显眼的文件
2.  您的表单定义了一个操作方法，并且您的按钮在表单标记内作为提交按钮。这将提交表单，然后单击也将提交表单 - 参见示例

**例子**

```
<form action="/somerowout/someaction">
  <input type="text" id="text1"/>
  <input type="text" id="text1"/>
  <input type="submit" />
</form> 
```

如果您需要在发布之前验证表单上的值，请不要连接额外的 Ajax 调用。您的 javascript 将类似于：

```
$(document).ready(function () {
    $("form").submit(function(){
        var result = $("#enrolledStudents").sortable('toArray');
        if(result == null){
            //do something to show validation failed
            return false;
        }
        return true;        
    });
}); 
```

然后您的表单代码将如下所示：

```
@using (@Ajax.BeginForm(new AjaxOptions { })) { 
    <input type="text" id="text1"/>
    <input type="text" id="text1"/>
    <input type="submit" />
} 
```

* * *

如果您想使用 Ajax 而不是 Html Helpers，请使用 div 而不是表单，这样您就不会收到重复的帖子。以下是您如何实现这一目标：

```
<div id="enrolledStudents">
  <--! your elements -->
  <button id="saveStudents">Save</button>
</div> 
```

**JavaScript**

```
$(document).ready(function () {
    $("saveStudents").click(function(){
        var result = $("#enrolledStudents").sortable('toArray');
        if(result !== null){ /* do some kind of check here. */
            $.ajax({
                url: '@Url.Action("Enrollment", "Classroom")',
                data: { students: result },
                type: 'POST',
                traditional: true,
                success : function(data) {
                    if (data.status) {
                        window.location = data.route;
                    }               
                }
            })
        } else {
            /* notify ui that save didn't happpen */
        }           
    });
}); 
```

**示例控制器操作** 使用 Ajax 发布数据时，这里有一个如何传递路由的示例

```
[HttpPost]
public ActionResult SomethingPost(SomeModel model) {
    if (Request.IsAjaxRequest()) {
        var json = new {
                   status = true,
                   route = @Url.RouteUrl("MyRouteName", new { /* route values */ })
        };
        return Json(json, JsonRequestBehavior.AllowGet);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T17:17:00.580

您确定要阻止提交按钮的默认行为（表单 POSTING）吗？用来`preventDefault`这样做。

```
$("#update-enroll").click(function (e) {
  e.preventDefault();
 //rest of the code

}); 
```

**编辑：根据评论**

要在 ajax 处理程序中进行重定向，您需要在`JSON`响应中将要重定向的 URL 返回给被调用方。

```
[HttpPost]
public ActionResult Classroom(string students)
{
  //do some operaton
  if(Request.IsAjax())
  {
     //This is an Ajax call
     return Json(new
                   {
                     Status="Success",
                     NewUrl = Url.Action("Index","Home")
                   });
  }
  else
  {
     //Normal request. Use RedirectToActiom
      return RedirectToAction("Index","Home");
  }

} 
```

现在在您的 ajax 调用中检查 JSON 结果并进行重定向。

```
 $.ajax({
         url: '@Url.Action("Enrollment", "Classroom")',
         data: { students: result },
         type: 'POST',           
         dataType: "json",
         contentType: "application/json; charset=utf-8",
         success: function (data) {
               if(data.Status=="Success")
               {
                  window.location.href = data.Newrl;
               }
               else
               {
                   alert("some error");
               }
         }

}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T17:26:55.593

检查您是否没有两次加载 jquery 文件。我有这种行为，问题是文件加载了两次。

# java - OnetoOne 休眠映射

> ID：11692519
> 
> 赞同：0
> 
> 时间：2012-07-27T17:14:16.927
> 
> 标签：java, hibernate, one-to-one

在一对一映射中，我编写了以下代码行。

```
@GenericGenerator(name = "generator", strategy = "foreign", parameters = @Parameter(name="property", value= "post"))
@Id
@GeneratedValue(generator = "generator")
public int getContent_id() {
    return content_id;
} 
```

**@Parameter(name="property", value="post")**的意义是什么。如果我不写那行，我会收到错误

*调用 init 方法失败；嵌套异常是 org.hibernate.MappingException：无法实例化 id 生成器 [entity-name=in.codejava.personal.model.Content]*

**编辑**

当我将 value = "post" 更改为 value="post123" 等其他内容时，它可以工作。但是当我完全删除它时它不起作用。部分代码[http://pastebin.com/CjEpqtXV](http://pastebin.com/CjEpqtXV)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:25:22.417

它允许告诉生成器必须从哪个属性中提取 ID（在本例中：“post”）。一个实体可以有多个 OnetoOne 关联。您需要告诉它其中哪一个包含您的实体的 ID。

请注意，此生成器可以替换为 OneToOne 关联上的标准 JPA 注释，其中包含 ID：[@MapsId](http://docs.oracle.com/javaee/6/api/javax/persistence/MapsId.html)。Hibernate 文档[推荐使用它](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#d0e5617)而不是外部生成器。

# java - 尝试复制哈希图存储时出错

> ID：11692523
> 
> 赞同：0
> 
> 时间：2012-07-27T17:14:37.747
> 
> 标签：java, copy, hashmap

当我尝试复制商店时，我遇到了一些错误。错误是：

```
 choice:java.io.NotSerializableException: Employee
    at java.io.ObjectOutputStream.writeObject0(Unknown Source)
    at java.io.ObjectOutputStream.writeObject(Unknown Source)
    at java.util.HashMap.writeObject(Unknown Source)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at java.io.ObjectStreamClass.invokeWriteObject(Unknown Source)
    at java.io.ObjectOutputStream.writeSerialData(Unknown Source)
    at java.io.ObjectOutputStream.writeOrdinaryObject(Unknown Source)
    at java.io.ObjectOutputStream.writeObject0(Unknown Source)
    at java.io.ObjectOutputStream.defaultWriteFields(Unknown Source)
    at java.io.ObjectOutputStream.writeSerialData(Unknown Source)
    at java.io.ObjectOutputStream.writeOrdinaryObject(Unknown Source)
    at java.io.ObjectOutputStream.writeObject0(Unknown Source)
    at java.io.ObjectOutputStream.writeObject(Unknown Source)
    at FileUtility.save(FileUtility.java:27)
    at MainApp.start(MainApp.java:190)
    at MainApp.main(MainApp.java:16) 
```

这也是我的代码：MainApp

```
//---------------------------------------------------------------------------------------
//  Name:        Case 7: Store.
//  Description: Choice 7 gives the user an option to copy and read a store
//               using read and write class from Java.
//---------------------------------------------------------------------------------------
            case 7:
                System.out.println("Store");
                EmployeeStore copyMyStore = Store.copy();
                System.out.println(copyMyStore); //print contents to check equality
                //shallow copy would look like this...
                EmployeeStore shallowCopyMyStore;
                //both variables point to same object
                shallowCopyMyStore = Store; 
                //lets store and re-load the mystore object
                FileUtility.save("myStore.store", Store);
                /*EmployeeStore loadedStore 
                            = (EmployeeStore)FileUtility.load("myStore.nmcg");
                System.out.println("\n--- RELOADED STORE CONTENTS ---");
                loadedStore.print();
                //System.out.println("\n(static) Count: "  + EmployeeStore.print);*/

                break; 
```

文件实用程序

```
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;

/**
  * <i>Use this class to save and load any type of object (i.e. a container class (e.g. PersonStore), an account, a task, a person)
 *   @author     NMCG
 *   @version    1.0            
*/
public class FileUtility /*serialization - step 2*/
{

    /**
     * @param fileName relative or absolute file path (e.g. "name.txt" or "c:\\temp\\name.txt"
     * @param obj      address of any object to be stored (i.e. a container class (e.g. PersonStore), an account, a task, a person)
     */

    public static void save(String fileName, Object obj)
    {
        try
        {
            FileOutputStream fos = new FileOutputStream(fileName);
            ObjectOutputStream oos = new ObjectOutputStream(fos);

            oos.writeObject(obj);
            oos.flush();
            oos.close();
            fos.close();
        }
        catch(Exception e)
        {
            System.out.println("Something bad happened during the save phase!");
            e.printStackTrace();
        }
    }

    /**
     * @param  fileName relative or absolute file path (e.g. "name.txt" or "c:\\temp\\name.txt")
     * @return Object   address of the object loaded into RAM from file
     */

    public static Object load(String fileName)  // "test.txt"
    {
        Object objectIn = null;
        try
        {
            FileInputStream fis = new FileInputStream(fileName);
            ObjectInputStream ois = new ObjectInputStream(fis);

            objectIn = ois.readObject();

            ois.close();
            fis.close();
        }
        catch(Exception e)
        {
            System.out.println("Something bad happened during the save phase!");
            e.printStackTrace();
        }
        return objectIn;
    }
} 
```

复制

```
// ---------------------------------------------------------------------------------------
// Name: Store copy.
// ---------------------------------------------------------------------------------------
public EmployeeStore copy()
{
    // instanciate the destination copy and give same name
    EmployeeStore Copy = new EmployeeStore();

    // by specifying the type of the entry in the for loop i.e. <>
    // we don't have to typecast the getKey() and getValue() methods
    // as shown in the commented out line inside the for loop
    for (Map.Entry<String, Employee> entry : map.entrySet()) 
    {
        // getting each key-value and putting into the copy
        // theCopy.add((MovieKey)entry.getKey(), (Movie)entry.getValue());
        Copy.add(entry.getValue());
    }
    // return address of the new MovieStore object
    return Copy;
}
// --------------------------------------------------------------------------------------- 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:17:53.530

错误消息说明了一切：`Employee`该类不可序列化。它没有实现接口`java.io.Serializable`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T17:18:10.153

抬头看`NotSerializableException`。顾名思义，当一个对象期望实现`Serializable`接口但没有实现时，就会抛出它。在您的情况下，异常报告甚至会告诉您需要实现接口的类`Employee`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T17:17:56.087

选择：java.io.NotSerializableException：员工

您的 Employee 类应该实现 Serializable 接口。您发布的代码有些无关紧要且无用...

# sql - ORA-00905: 缺少关键字

> ID：11692528
> 
> 赞同：3
> 
> 时间：2012-07-27T17:15:00.177
> 
> 标签：sql, oracle, case, ora-00905

`ORA-00905: missing keyword`尝试在 Oracle 中运行以下查询时出现错误：

```
select distinct MONTH_ID
from    DSS_MAIN.DIM_TIME a1
where   Case When TO_CHAR(SYSDATE,'MM') < 3
Then TO_CHAR(a1.MONTH_START_DATE,'YYYYMM') Between (TO_CHAR(SYSDATE,'YYYY')-1)||'03' And TO_CHAR(SYSDATE,'YYYYMM')
Else TO_CHAR(a1.MONTH_START_DATE,'YYYYMM') Between TO_CHAR(SYSDATE,'YYYY')||'03' And TO_CHAR(SYSDATE,'YYYYMM')
End; 
```

各个`Between`子句工作正常，所以我假设`Case`语法有问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T17:24:13.277

试试这个：

```
SELECT DISTINCT MONTH_ID
  FROM DSS_MAIN.DIM_TIME A1
 WHERE TO_CHAR(A1.MONTH_START_DATE, 'YYYYMM') 
            BETWEEN CASE
                        WHEN TO_CHAR(SYSDATE, 'MM') < '03' THEN
                            (TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - 1) || '03'
                        ELSE
                            TO_CHAR(SYSDATE, 'YYYY') || '03'
                    END
                AND  TO_CHAR(SYSDATE, 'YYYYMM') 
```

Case 返回一个值以供进一步使用，它不会以您使用它的方式有用。

# php - 关于实施让项目随时间减少的评级系统的概念性帮助

> ID：11692531
> 
> 赞同：1
> 
> 时间：2012-07-27T17:15:11.143
> 
> 标签：php, mysql, math, rating

我正在运行一个网站，让用户通过上传特定主题的文件来做出贡献。现在我的评分系统是最差的（文件的下载次数）。这不仅在质量控制方面非常不准确，而且还会阻止新内容很快被列在首位。这就是为什么我想更改我的评分系统，以便用户可以对每个项目进行投票/否决。然而，这不应该是显示此类项目受欢迎程度的唯一因素。我想让较旧的内容随着时间的推移而降低评级。也许我什至可以考虑下载量，但比例很低。

所以，我的问题是：

1.  假设每天有 1 次新上传，您会建议哪个公式？
2.  您将如何在 php/mysql 环境中实现这一点？

我的问题是，现在我只是按`downloads`数据库中的行对我的东西进行排序。如何按外部计算的因子（在 php 中）对查询进行排序，或者每次有人在浏览器中调用站点时，我是否必须使用评级因子更新表中的新行？

（请原谅任何错误，我不是母语人士）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T18:06:10.690

我对php或mysql不是很流利，但是对于评分系统，如果您想及时进行阻尼，您是否考虑过衰减指数？在我的脑海中，我可能会做类似的事情

```
$rating = $downloads * exp(-1*$elapsedTime) 
```

你可以在这里阅读 [http://en.wikipedia.org/wiki/Exponential_decay](http://en.wikipedia.org/wiki/Exponential_decay)。在你开始抑制结果之前，可能会在一周或一个月内构建，或者延迟一些时间，或者人们会立即降低他们的上传速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:16:40.870

首先，无论如何，您**都需要**在表格中添加至少一列。最好的办法是有一个单独的表，其中包含`id`, `upvotes`, `downvotes`,`datetime`

如果您想考虑帖子（或上传或评论或......）的*新鲜度*，我认为最好的实际方法是带有***重力参数*****的威尔逊分数***。*

 *要在 PHP 中使用 Wilson 分数实现一个良好的开端，请[查看](http://www.derivante.com/2009/09/01/php-content-rating-confidence/).

然后您将需要阅读[本文](http://www.evanmiller.org/how-not-to-sort-by-average-rating.html)以了解其他解决方案的优缺点并直接使用 SQL。
备注：*重力*在 SQL 代码中没有明确详细说明，但多亏了 PHP，您应该能够使其工作。

请注意，如果您想要更简单但仍然不蹩脚的东西，您可以使用[Bayesian Average](http://en.wikipedia.org/wiki/Bayesian_average)进行检查。**IMDB**使用贝叶斯估计来计算其[Top 250](http://www.imdb.com/chart/top)。

实施您自己的统计模型只会导致您最初没有想到的缺点（离平均值太远，反对票比赞成票更重要，衰减太快等......）

Finally you are talking about rating uploads directly, not the user who uploads the files. If you would like to do the same with the user, the simpler would be to use a Bayesian estimate with the results from your uploads ratings.

You have a lot to read, just in StackOverflow, to dry the subject.

Your journey starts [here](https://stackoverflow.com/search?q=rating+algorithm+php)...*

# c# - 无编码的 HTTP 请求

> ID：11692532
> 
> 赞同：1
> 
> 时间：2012-07-27T17:15:18.833
> 
> 标签：c#

我需要发送一个没有编码的 http 请求（如果你对你的 url 进行编码，我必须使用一个愚蠢的供应商 API，它会中断）

所以目前我有

```
 string address = "https://www.eco-bb.bt.com/bbxml33/batchstatus.asp?b_customerId=[O/M12346800]&batchid=[" + batchID + "]";
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(address); 
```

哪个生产

> 发布 [https://www.eco-bb.bt.com/bbxml33/Upload.asp?b_customerId=%5BO/M12346800%5D](https://www.eco-bb.bt.com/bbxml33/Upload.asp?b_customerId=%5BO/M12346800%5D)

我希望它产生

> 发布 https://www.eco-bb.bt.com/bbxml33/Upload.asp?b_customerId=[O/M12346800]

我有点难过。关于如何进行的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T17:28:44.830

试试这个，你创建一个`Uri`对象并承诺你已经转义了字符串的构造函数（你没有：p）

```
string address = "https://www.eco-bb.bt.com/bbxml33/batchstatus.asp?b_customerId=[O/M12346800]&batchid=[" + batchID + "]";
Uri uri = new Uri(address, true);
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T18:03:12.180

如果您运行的是 .NET 4 或更高版本，您可以添加以下[配置](http://msdn.microsoft.com/en-us/library/ee656539.aspx)

```
<configuration>
  <uri>
    <schemeSettings>
      <add name="http" genericUriParserOptions="DontUnescapePathDotsAndSlashes"/>
    </schemeSettings>
  </uri>
</configuration> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T17:56:07.580

好吧，作为一个恐龙，我记得在过去，您有时会手动编码您的 URL 数据，方法是用您自己的特定名称替换特殊字符，然后在服务器端解析它们。如果这是您的供应商构建他们的网络应用程序的方式，那么他们只需要告诉您他们期望的特殊字符替换，例如

```
http://www.this.com?variable=[12] 
```

可能预期为；

```
http://www.this.com?variable=lBracket12rBracket 
```

顺便说一句，在没有 HTTPS 的情况下调用他们的服务会产生一些有趣的 JavaScript 函数！

```
 <script> 
   function Homepage(){
<!--
// in real bits, urls get returned to our script like this:
// res://shdocvw.dll/http_404.htm#http://www.DocURL.com/bar.htm 

    //For testing use DocURL = "res://shdocvw.dll/http_404.htm#https://www.microsoft.com/bar.htm"
    DocURL=document.URL;

    //this is where the http or https will be, as found by searching for :// but skipping the res://
    protocolIndex=DocURL.indexOf("://",4);

    //this finds the ending slash for the domain server 
    serverIndex=DocURL.indexOf("/",protocolIndex + 3);

    //for the href, we need a valid URL to the domain. We search for the # symbol to find the begining 
    //of the true URL, and add 1 to skip it - this is the BeginURL value. We use serverIndex as the end marker.
    //urlresult=DocURL.substring(protocolIndex - 4,serverIndex);
    BeginURL=DocURL.indexOf("#",1) + 1;
    urlresult=DocURL.substring(BeginURL,serverIndex);

    //for display, we need to skip after http://, and go to the next slash
    displayresult=DocURL.substring(protocolIndex + 3 ,serverIndex);
    InsertElementAnchor(urlresult, displayresult);
}

function HtmlEncode(text)
{
    return text.replace(/&/g, '&amp').replace(/'/g, '&quot;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
}

function TagAttrib(name, value)
{
    return ' '+name+'="'+HtmlEncode(value)+'"';
}

function PrintTag(tagName, needCloseTag, attrib, inner){
    document.write( '<' + tagName + attrib + '>' + HtmlEncode(inner) );
    if (needCloseTag) document.write( '</' + tagName +'>' );
}

function URI(href)
{
    IEVer = window.navigator.appVersion;
    IEVer = IEVer.substr( IEVer.indexOf('MSIE') + 5, 3 );

    return (IEVer.charAt(1)=='.' && IEVer >= '5.5') ?
        encodeURI(href) :
        escape(href).replace(/%3A/g, ':').replace(/%3B/g, ';');
}

function InsertElementAnchor(href, text)
{
    PrintTag('A', true, TagAttrib('HREF', URI(href)), text);
}

//-->
</script> 
```

# python - 浏览器延迟在 django admin 中更改页面内容（缓存，python/django）

> ID：11692538
> 
> 赞同：2
> 
> 时间：2012-07-27T17:15:45.717
> 
> 标签：python, django, caching, django-admin, django-middleware

我在 django 的项目中缓存了一个奇怪的问题。

我可以在 django-admin 中编辑我的页面内容。当我这样做并刷新站点时-什么都没有发生。我必须等待几分钟才能进行更改。有趣的是，当我更改浏览器（或计算机）时 - 我不必等待 - 更改已开启。是django，浏览器的问题还是什么？是否可以设置 setting.py 以立即获得更改？

顺便说一句，我已经发现当我关闭“django.middleware.cache.FetchFromCacheMiddleware”时 - 问题消失了，但我不想关闭缓存......

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T02:49:48.743

是的。如果您想保持站点范围的缓存打开，但又想确保在更新或添加内容时清除缓存，您可以实现 django 信号来检测添加/更新/删除事件并清除缓存。

Django 信号 - [https://docs.djangoproject.com/en/dev/ref/signals/](https://docs.djangoproject.com/en/dev/ref/signals/)

这是一个代码片段示例：-

```
from django.db.models.signals import post_save

@receiver(post_save, sender=BlogPost)
def clear_cache(sender, instance, created, **kwargs):
    if instance.published_on is not None:
        cache.delete('feed') 
```

在这个例子中，只要 BlogPost 模型被“保存”（添加或更新），`feed`缓存中的键就会被删除。在您的情况下，您将必须实施`page-content`（类似这样的事情`cache.delete('page-content')`并决定哪个相应的模型将是您`sender`的，它会在保存时触发清除缓存。

# regex - 简单编辑 app.yaml 文件以访问 html 文件

> ID：11692539
> 
> 赞同：0
> 
> 时间：2012-07-27T17:15:48.587
> 
> 标签：regex, google-app-engine

我希望能够（静态地）访问我的根目录中的特定文件 google.html。

我在编辑 app.yaml 文件以使其正常工作时遇到问题，因为我不断收到 404 错误。

这是我目前正在做的事情

```
- url: /(google\.html)
  static_files: /\1
  upload: /(google\.html) 
```

我也试过

```
 - url: /google.html
      static_files: google.html
      upload: /google.html 
```

（这是在所有其他处理程序之前添加的）它应该是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:21:04.803

您需要在项目的根目录中有一个 google.html 文件（小写文件）。
请发布您的目录结构，以防您认为您拥有它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T04:55:32.807

似乎应用引擎不喜欢根目录中的静态文件。将 google.html 文件移动到 /static 解决了这个问题。

所以处理程序变成：

```
- url: /google.html
  static_files: static/google.html
  upload: static/google.html 
```

这样，即使文件本身位于静态目录中，端点仍然是 /。

# php - 如何在 PHP 中使用 XQuery 访问 MySQL？

> ID：11692545
> 
> 赞同：0
> 
> 时间：2012-07-27T17:16:33.293
> 
> 标签：php, mysql, xquery, zorba

我是 PHP 新手，我只听说过 Zorba。基本上我们需要通过 XQuery 将 MySQL 表转换为我们的 JSON 格式。

是否有将 Zorba 连接到 MySQL 的库？Zorba 似乎还需要在目标服务器上进行本机扩展，这对我们来说毫无用处。

我们想使用 XQuery，因为我们的整个系统都基于并且我们必须处理数百个查询。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-15T22:07:41.097

Zorba 最近获得了一个 JDBC 模块，它允许您连接到任何 JDBC 数据源，从而允许您进行查询或更新。该模块的文档可在[http://www.zorba.io/documentation/2.9/modules/www.zorba-xquery.com_modules_jdbc.html](http://www.zorba.io/documentation/2.9/modules/www.zorba-xquery.com_modules_jdbc.html)获得。

# javascript - Javascript：如何保护您的代码

> ID：11692548
> 
> 赞同：0
> 
> 时间：2012-07-27T17:16:51.620
> 
> 标签：javascript, security

如果您使用 JS 渲染页面并需要实现安全功能，则归结为以下内容：

```
var userID = getUserID();
if (userID == 1) {
   html += renderDeleteButton();
} 
```

但是用户不能只打开调试器并更改 userID 的值吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T17:18:19.910

是他们会。使用 JS，用户可以为所欲为。这就是为什么安全内容应该放在服务器端代码（PHP / ASP / 等）中的原因，因为用户无法修改它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T17:20:34.747

不要相信来自像 JS 这样的客户端脚本的任何东西。所有客户端脚本都可以由用户操作。任何安全类型的代码都应该驻留在服务器端脚本中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T17:28:04.270

javascript 中的验证/安全检查始终只是为了节省用户往返服务器的时间。它们仅用于性能。

如果你想要真正的安全，它必须在服务器上实现。

# ruby - Ruby 探查器堆栈级别太深错误

> ID：11692559
> 
> 赞同：4
> 
> 时间：2012-07-27T17:17:41.557
> 
> 标签：ruby, profiler, ruby-prof

似乎我总是在我的一个脚本上收到此错误：

```
/Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/ruby-prof-0.11.2/lib/ruby-prof/profile.rb:25: stack level too deep (SystemStackError) 
```

有没有人遇到过这个错误？什么可能导致它，我能做些什么来防止它发生？

我使用命令运行我的 ruby​​-prof 脚本

```
ruby-prof --printer=graph --file=profile.txt scraper.rb -- "fall 2012" 
```

**编辑**我在 Mac OS X 上，如果这很重要的话。不幸的是，这样做`ulimit -s 64000`似乎没有多大帮助。这是`ulimit -a`给出的：

```
$ ulimit -a
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
file size               (blocks, -f) unlimited
max locked memory       (kbytes, -l) unlimited
max memory size         (kbytes, -m) unlimited
open files                      (-n) 256
pipe size            (512 bytes, -p) 1
stack size              (kbytes, -s) 64000
cpu time               (seconds, -t) unlimited
max user processes              (-u) 709
virtual memory          (kbytes, -v) unlimited 
```

**编辑 2**

Andrew Grimm 的解决方案可以很好地防止 ruby​​-prof 崩溃，但分析器似乎有其自身的问题，因为我看到一个进程所花费的总时间的百分比为 679.50%......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-31T23:23:51.447

一种解决方法是[打开尾调用优化](http://ephoz.posterous.com/ruby-and-recursion-whats-up-in-19)。

以下是在 TCO 打开时工作但在 TCO 关闭时不起作用的示例。

```
RubyVM::InstructionSequence.compile_option = {
  :tailcall_optimization => true,
  :trace_instruction => false
}

def countUpTo(current, final)
  puts current
  return nil if current == final
  countUpTo(current+1, final)
end

countUpTo(1, 10_000) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T17:57:39.920

堆栈级别太深通常意味着无限循环。如果您查看[发生错误的 ruby​​-prof 代码，](https://github.com/rdp/ruby-prof/blob/master/lib/ruby-prof/profile.rb#L25)您会发现它是一种在调用堆栈中检测递归的方法。

试着查看你使用递归的代码（你的代码中有多少地方可以使用递归？），看看是否有一个条件会导致它永远不会触底？

这也可能意味着您的系统堆栈不足以处理您正在尝试做的事情。也许您正在递归处理大型数据集？您可以检查堆栈大小（unixy 系统）：

`$ ulimit -a`

并[增加堆栈大小](http://dalibornasevic.com/posts/5-ruby-stack-level-too-deep-systemstackerror)：

`$ ulimit -s 16384`

你也可以考虑调整你的算法。[看到这个堆栈溢出问题](https://stackoverflow.com/questions/242617/how-to-increase-stack-size-for-a-ruby-app-recursive-app-getting-stack-level-to)

我希望我不只是重新散列一个现有的问题......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-11T21:40:22.787

Ruby-prof 中的百分比超过 100% 是[一个已知错误](https://github.com/rdp/ruby-prof/issues/84)，但现在应该修复。

# elasticsearch - Elasticsearch、Tire 和嵌套查询/与 ActiveRecord 的关联

> ID：11692560
> 
> 赞同：28
> 
> 时间：2012-07-27T17:17:47.973
> 
> 标签：elasticsearch, tire

我正在使用 ElasticSearch 和 Tire 来索引和搜索一些 ActiveRecord 模型，并且我一直在寻找索引和搜索关联的“正确”方式。我还没有找到似乎是最佳实践的方法，所以我想问问是否有人有他们认为非常有效的方法。

作为示例设置（这是编造的，但说明了问题），假设我们有一本书，有章节。每本书都有一个标题和作者，以及一堆章节。每章都有文字。我们希望为图书的字段和章节文本编制索引，以便您可以按作者搜索图书，或搜索其中包含特定单词的任何图书。

```
class Book < ActiveRecord::Base
  include Tire::Model::Search
  include Tire::Model::Callbacks

  has_many :chapters

  mapping do
    indexes :title, :analyzer => 'snowball', :boost => 100
    indexes :author, :analyzer => 'snowball'
    indexes :chapters, type: 'object', properties: {
      chapter_text: { type: 'string', analyzer: 'snowball' }
    }
  end
end

class Chapter < ActiveRecord::Base
  belongs_to :book
end 
```

因此，我使用以下方法进行搜索：

```
s = Book.search do
  query { string query_string }
end 
```

这不起作用，即使看起来索引应该这样做。相反，如果我索引：

```
indexes :chapters, :as => 'chapters.map{|c| c.chapter_text}.join('|'), :analyzer => 'snowball' 
```

这使得文本可搜索，但显然它不是一个很好的 hack，它会丢失实际的关联对象。我尝试了搜索的变体，例如：

```
s = Book.search do
  query do
    boolean do
      should { string query_string }
      should { string "chapters.chapter_text:#{query_string}" }
    end
  end
end 
```

那里也没有运气。如果有人有一个使用 Tire 索引和搜索关联 ActiveRecord 对象的良好、清晰的示例，那么这似乎是对这里知识库的一个非常好的补充。

感谢您的任何想法和贡献。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-07-29T17:42:13.160

Tire 中对 ActiveRecord 关联的支持正在运行，但需要在您的应用程序中进行一些调整。毫无疑问，图书馆应该在这里做得更好，而且将来肯定会做得更好。

也就是说，这是一个完整的轮胎配置示例，可与 Rails 在 elasticsearch 中的关联一起使用：[active_record_associations.rb](https://gist.github.com/3200212)

让我在这里强调几件事。

### 抚摸父母

首先，您必须确保将关联的更改通知关联的父模型。

鉴于我们有一个`Chapter`“属于” a 的模型`Book`，我们需要这样做：

```
class Chapter < ActiveRecord::Base
  belongs_to :book, touch: true
end 
```

这样，当我们做类似的事情时：

```
book.chapters.create text: "Lorem ipsum...." 
```

`book`实例会收到有关添加章节的通知。

### 响应触摸

对这部分进行排序后，我们需要将更改通知*Tyre*，并相应地更新 elasticsearch 索引：

```
class Book < ActiveRecord::Base
  has_many :chapters
  after_touch() { tire.update_index }
end 
```

（毫无疑问， *Tire*应该自行拦截`after_touch`通知，而不是强迫您这样做。另一方面，这证明了以不伤害您的眼睛的方式绕过库限制是多么容易.)

### Rails < 3.1 中正确的 JSON 序列化

尽管 README 提到您必须在 Rails < 3.1 中禁用自动“在 JSON 中添加根密钥”，但许多人忘记了它，因此您还必须将其包含在类定义中：

```
self.include_root_in_json = false 
```

### 弹性搜索的正确映射

现在是我们工作的重点——为我们的文档（模型）定义正确的映射：

```
mapping do
  indexes :title,      type: 'string', boost: 10, analyzer: 'snowball'
  indexes :created_at, type: 'date'

  indexes :chapters do
    indexes :text, analyzer: 'snowball'
  end
end 
```

请注意，我们使用 boosting 索引`title`，`created_at`作为“日期”，以及来自关联模型的章节文本。在 elasticsearch 中，所有数据都被有效地“反规范化”为单个文档（如果这样的术语有点意义的话）。

### 正确的文档 JSON 序列化

作为最后一步，我们必须正确序列化 elasticsearch 索引中的文档。请注意我们如何利用*ActiveRecord*`to_json`中的便捷方法：

 *```
def to_indexed_json
  to_json( include: { chapters: { only: [:text] } } )
end 
```

完成所有这些设置后，我们可以在文档的 the`Book`和`Chapter`part 中搜索属性。

请运行开头链接的[active_record_associations.rb](https://gist.github.com/3200212) Ruby 文件以查看全貌。

如需更多信息，请参阅以下资源：

*   [https://github.com/karmi/railscasts-episodes/commit/ee1f6f3](https://github.com/karmi/railscasts-episodes/commit/ee1f6f3)
*   [https://github.com/karmi/railscasts-episodes/commit/03c45c3](https://github.com/karmi/railscasts-episodes/commit/03c45c3)
*   [https://github.com/karmi/tire/blob/master/test/models/active_record_models.rb#L10-20](https://github.com/karmi/tire/blob/master/test/models/active_record_models.rb#L10-20)

请参阅此 StackOverflow 答案：[ElasticSearch 和轮胎：使用映射和 to_indexed_json](https://stackoverflow.com/questions/11672072/elasticsearch-tire-using-mapping-and-to-indexed-json/11700251#11700251)了解有关`mapping`/`to_indexed_json`相互作用的更多信息。

请参阅此 StackOverflow 答案：[Index the results of a method in ElasticSearch (Tire + ActiveRecord)](https://stackoverflow.com/questions/13600086/index-the-results-of-a-method-in-elasticsearch-tire-activerecord/13847929#13847929)以了解在为具有关联的模型编制索引时如何应对 n+1 个查询。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T07:26:51.720

我在我的一个应用程序中创建了这个作为解决方案，它索引了一组深度嵌套的模型

[https://gist.github.com/paulnsorensen/4744475](https://gist.github.com/paulnsorensen/4744475)

更新：我现在发布了一个可以执行此操作的 gem： [https ://github.com/paulnsorensen/lifesaver](https://github.com/paulnsorensen/lifesaver)*

# blogger - Syntaxhighlighter 不适用于博主

> ID：11692563
> 
> 赞同：2
> 
> 时间：2012-07-27T17:18:02.337
> 
> 标签：blogger, syntaxhighlighter

嗨，我使用了以下链接：

[http://www.cyberack.com/2007/07/adding-syntax-highlighter-to-blogger.html](http://www.cyberack.com/2007/07/adding-syntax-highlighter-to-blogger.html)

我一步一步地跟着，但我无法让它在我的博客上运行。它打印在那里写的任何内容，就好像它忽略了标签本身一样。

任何帮助将不胜感激。因为这似乎是一个非常简单的任务，但我发现它为什么不适合我很奇怪。

这是我的测试博客的链接：http: [//nishantcop.blogspot.sg/2012/07/blog-post_27.html](http://nishantcop.blogspot.sg/2012/07/blog-post_27.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T13:02:24.980

我猜你正在将你的 HTML 代码粘贴到 Compose 部分。将您的帖子视图更改为 HTML 视图，然后进行更改。它现在应该可以工作了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-01T20:35:40.833

没错。只需从撰写选项卡切换到 HTML 选项卡。该按钮位于博客的右上角。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-25T10:44:41.477

有关 Syntaxhighlighter 设置的稍微优化的博客配置的教程。 [http://modelarchitecture.blogspot.com/2013/12/configuring-javascript-syntaxhighligher.html](http://modelarchitecture.blogspot.com/2013/12/configuring-javascript-syntaxhighligher.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-01T03:44:10.663

HTTP 协议不适用于博主。我尝试了 .js 和 .css 文件托管在 Google Dive 上。它对我有用。

博客主题 HTML 截图 [![在此处输入图像描述](../Images/cda635eabf71202abc49b31cd7791c29.png)](https://i.stack.imgur.com/sYXAl.jpg)

您也可以阅读我的博客以获取更多详细信息，请单击博客中的[Syntaxhighlighter](https://my-tech-expert.blogspot.com/2018/08/how-to-use-syntaxhighlighter-in-blogger.html)

# php - 用php发送html邮件时的默认字体，在outlook中查看

> ID：11692571
> 
> 赞同：2
> 
> 时间：2012-07-27T17:18:19.970
> 
> 标签：php, outlook

我正在尝试找出一种方法来为传出的 HTML 电子邮件指定默认字体。这样做的原因是因为 Outlook 的默认字体是 Times New Roman，而我希望它是 Arial。

我试着做`<body style="font-family: Arial, Helvetica, sans-serif;">`

但是，例如，在我的电子邮件中，<table> 中的 <a href> 标记仍会显示在 Outlook 中的 Times 中。

我也尝试过做一个全局 css 声明，比如

```
<style> 
body {font-family:Arial, Helvetica, sans-serif; }
</style> 
```

这也没有做到。

有没有办法为我的 HTML 指定默认字体，而不必在每个链接中硬编码字体？

这将在前景中明显起作用 `< a href=# style="font-family: Arial, Helvetica, sans-serif;">`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T17:20:29.620

你为什么不简单地`div`用你想要的风格把整个东西包起来呢？

```
<div style="font-family: Arial, Helvetica, sans-serif;">
...
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T17:30:47.840

许多电子邮件客户端完全忽略代码中的任何`<style>`块。您必须单独设置每个元素的样式，然后使用电子邮件测试服务（有些是免费的）对其进行测试。

[谷歌搜索结果](https://www.google.com/webhp?sourceid=chrome-instant&ie=UTF-8&ion=1#hl=en&gs_nf=1&tok=cLzJ7X3nol801eVIYL0gkw&cp=11&gs_id=6&xhr=t&q=email%20testing&pf=p&output=search&sclient=psy-ab&oq=email%20testi&gs_l=&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&fp=a0113e784c26b9f8&biw=1280&bih=939&ion=1)

# jsp - 根据另一个变量从消息包中选择一个变量

> ID：11692573
> 
> 赞同：0
> 
> 时间：2012-07-27T17:18:31.390
> 
> 标签：jsp, jsf, el

在我的课堂上，我有一个函数：

```
public List<String> getDeclaredFields() {
  List<String> fieldList = new ArrayList<String>();

  for(Field field : Equipment.class.getDeclaredFields()){
    if(!field.getName().contains("_") && !field.getName().equals("id") && !field.getName().equals("serialVersionUID") ) {
      fieldList.add(field.getName());
    }
  }
  Collections.sort(fieldList); 
  return fieldList;
} 
```

它返回类中所有声明字段的字符串列表。

在我的 facelet 文件中，我想执行以下操作：

```
<c:forEach var="field" items="#{bean.entity.declaredFields}">
  <h:outputText value="#{msg.#{field}}" />
</c:forEach> 
```

但是，这将导致错误。

> javax.el.E​​LException：错误解析：#{msg.#{field}}

我想这样做，因为当我对班级中的字段进行一些更改时，我只需在消息包中添加一个与字段同名的变量。这样，我在修改字段时不必更新我所有的 facelet 文件。只需在消息包文件中删除或添加新变量即可。

你有什么想法吗？

最好的祝福

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T18:38:30.947

您应该能够使用 [] 表示法来引用它：

```
#{msg[ field ]} 
```

试试看

# android - onStop()、onPause()、onCreate()、onResume() 和 GPS

> ID：11692575
> 
> 赞同：2
> 
> 时间：2012-07-27T17:18:44.200
> 
> 标签：android, gps

我有一个`GPS`基于应用程序的工作。它有许多活动，并且都使用`GPS`. 例如，一个活动显示到某个位置的距离，另一个活动显示速度和方向。我设置并呼入`requestLocationUpdates()`并`onCreate()`呼入`removeUpdates()`。`onPause()`

这一切都有效，但`GPS`在切换活动时会闪烁并且必须重新获取。我做了一个测试，如果我把`removeUpdates()`in`onStop()`而不是 in`onPause()`没有闪烁。显然`onStop()`是在新活动开始后调用，这解释了没有闪烁。

我已阅读有关此主题的帖子，似乎存在意见分歧。但是，看起来我应该使用`onStop()`并且想知道是否有任何理由不应该使用。

第二个问题是没有`onResume()`代码，因此`GPS`在后退箭头或关闭和打开屏幕后没有代码。我应该解决这个问题。现在我的`onCreate()`代码创建了位置管理器，基本上我所有的代码都在里面。看起来我应该按照生命周期流程图移动`removeUpdates()`到 onStop 并将 lm 和 ll 的创建移动到`onStart()`. 它是否正确？

这是我的`onCreate()`代码：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.set);
    textView1 = (TextView)findViewById(R.id.textView1);
    lm = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
    ll = new mylocationlistener();
    lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, ll);
} 
```

这是我的 onPause 代码：

```
 @Override
    protected void onPause() {
        super.onPause();
        if(lm != null) {
            lm.removeUpdates(ll);
        }
        ll = null;
        lm = null;
    } 
```

所以我认为我应该将 onPause() 更改为 onStop() 并将 onStart() 设为：

```
@Override
public void onStart() {
    super.onStart();
    lm = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
    ll = new mylocationlistener();
    lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, ll);
} 
```

我的 onCreate 代码是这样的；

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.set);
    textView1 = (TextView)findViewById(R.id.textView1);
  } 
```

This said, I am kind of new to all this and this is my first application so I would like to know what I am missing here.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T17:42:55.443

I've done something similar to your app, except that I've delegated the GPS functionality to a service which stops the GPS when no activities are bound to it and starts it when an activity binds to it. I bind to the service in the onStarts and unbind in the onStops. Logging the on.. methods when I switch activities gives a sequence like this:

```
FIRST Activity onCreate
FIRST Activity onStart
FIRST Activity onResume
FIRST Activity onPause
SECOND Activity onCreate
SECOND Activity onStart
SECOND Activity onResume
FIRST Activity onStop 
```

If done it via a service so that I've only got one LocationManager to control, you could either take the same approach, or requestUpdates in the onStarts() and remove them in the onStops()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T17:39:16.693

First of all I'd suggest following good read about [location strategies](http://developer.android.com/guide/topics/location/strategies.html).

If you just want a one-time location fix you need to make it a bit more independent from the activity life cycle because acquiring the GPS location can take longer than the user switches your activities.

So don't stop the request in onPause or onStop. You could use a special location query handler that lives as a singleton instance in your Application object (create a derivative of Application for that).

Tell that location handler to get a fresh fix if necessary in your activities' onStart or onResume method for example. Let the handler keep the latest and best location data which can be immediately used as needed.

You could query for the first time a NETWORK_PROVIDER location because this should be faster than GPS and you immediately have something to work with even though it's not accurate. On top of that you'd also get a location in case the user turned off the GPS module.

However, that depends on how accurate the result has to be. You could also create a local service that queries the GPS location and waits for its result to come. When the result is there you can notify your currently running activity via a local broadcast intent.

In any case, you can get the last known location with locationManager.getLastKnownLocation

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T17:56:24.027

First, I'm not 100% what question you're asking here, but I will try to help you out. `OnPause` is called whenever the Activity loses focus. This is primarily for popups and such that cause the Activity to be in the background, but blurred. `OnStop` is called whenever a new activity is started. You should put your location retrieval code in `OnResume`. `OnResume` is called any time that the application begins again. This includes any calls to `OnCreate` or `OnStart`. You should put your `lm.removeUpdates(ll);` logic in OnStop as well. This is the generally accept method for location retrieval in a life cycle; I just ended a sentence with a semicolon... I've been coding too much.

# objective-c - 我的 UINavBar 不响应触摸，并使用 tableview 滚动

> ID：11692576
> 
> 赞同：0
> 
> 时间：2012-07-27T17:18:47.703
> 
> 标签：objective-c, ios, uinavigationcontroller, uitableview

我有一个 UITableViewController 的子类，我想向它添加一个 UINavBar。这是一个与本地联系人应用程序非常相似的设置，您可以在其中点击“添加联系人”，它会显示一个分组的表格视图，顶部有一个导航栏，带有“取消”和“完成”选项。关键是我需要它使用垂直过渡来呈现（有效地使用 presentModalViewController:animated:yes），但我尝试使用 Interface Builder 并以编程方式添加它，在这两种情况下，按钮都没有响应，并且栏滚动与 tableview，而不是停留在顶部。

提前致谢，

哈尔加瓦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T18:58:25.393

听起来您正在使导航栏成为表格视图的子视图，这解释了为什么导航栏会随着表格视图滚动。

在 action 方法中试试这个：

```
MyTableViewController *table = [MyTableViewController alloc] initWithStyle:UITableViewStyledGrouped];
UINavigationController *nav = [UINavigationController alloc] initWithRootViewController:table];

[self presentModalViewController:nav animated:YES]; 
```

然后在您的表视图控制器中`viewDidLoad`：

```
UIBarButtonItem *doneButton = [UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(done:)];
self.navigationItem.rightBarButtonItem = doneButton; 
```

# java - 将字符串与来自 html 输入的正则表达式匹配

> ID：11692577
> 
> 赞同：0
> 
> 时间：2012-07-27T17:18:47.600
> 
> 标签：java, regex

我有点不知道该怎么做。

基本上使用java我试图：

*   从网站读取 html
*   在这种情况下，我想在某个字符串之后找到内容

    ```
     title=" 
    ```

*   将其存储在字符串中。

第一步和最后一步对我来说很简单，但我没有运气（而且从来没有使用过正则表达式）。

我相信这是我需要的开始：

```
 String regex = "(?<=title=\")\\S+";
   Pattern name = Pattern.compile(regex); 
```

之后我就没有头绪了。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:25:29.193

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

String EXAMPLE_TEST = "......";
Pattern pattern = Pattern.compile("(?<=title=\")(\\S+)")
Matcher matcher = pattern.matcher(EXAMPLE_TEST);
while (matcher.find()) {
  System.out.println(matcher.group());
} 
```

注意：您可能会考虑使用正则表达式模式`(?<=title=\")([^\"]*)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:30:26.407

```
List<String> result_list = new ArrayList<String>();
Pattern p = Pattern.compile("title=\"(.*)\"");
Matcher m = p.matcher("title=\"test\"");
boolean result = m.find();

while(result)
{
    result_list.add(m.group(0));
    result = m.find();
} 
```

# dependencies - 为并行构建调试 CMake/Make 依赖项

> ID：11692584
> 
> 赞同：2
> 
> 时间：2012-07-27T17:19:10.870
> 
> 标签：dependencies, makefile, cmake, parallel-builds

我管理一个复杂的 C++ 项目，它的构建定义被写入，`CMake`构建本身是通过调用`make`. 源代码树由许多模块组成，具有高度的可并行性。

线性构建总是成功的，而并行构建大多数时候都是成功的。当在这样的构建过程中遇到依赖问题时，我通常会去修复它，但我想以编程方式测试依赖关系，而不是在问题发生时修复它们。

理想的解决方案是遍历所有依赖`CMake`项并修复它们，但这在实践中并不总是可行的，因为我们大量使用自定义宏来处理特定于我们的源树的某种依赖项（我无法详细说明， 对不起）。因此，我正在考虑以不同的方式（并且可能有效地）解决问题，尝试尽可能多地重用标准工具。

1.  `Make`我的第一个想法是在作业调度中注入某种“随机性” ，因此构建机器可以通过重建树来无限期地尝试不同的编译路径，直到遇到故障。然而，另一个问题[（此处）](https://stackoverflow.com/questions/9437459/trigger-missing-dependencies-in-parallel-gnu-make-by-changing-order-of-executi)指出，此功能在`Make`.

2.  所以我尝试了另一种解决方案：我创建了一个包装脚本，`g++`它会休眠几秒钟，以在作业调度程序`$RANDOM`中带来一些噪音。`Make`当然，这种解决方案的缺点是增加了编译时间。
    然而，这种部分解决方案有一个根本性的缺陷：如果发现问题，则证明缺少依赖项，但如果没有产生错误，则无法证明所有依赖项都是正确的。

你怎么看？我怎样才能实现我的目标？我更喜欢重用标准工具并且可以应用于广泛受众的解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T17:57:16.723

`make`如果你真的想有效地解决这个问题，我认为你需要使用更好的。Electric Make（ElectricAccelerator 的一部分）是与 GNU make 兼容的变体，`make`它在构建期间监视文件系统访问，并会自动[检测和纠正由无序执行引起的问题](http://blog.melski.net/2011/07/05/how-electricmake-guarantees-reliable-parallel-builds/)。此外，ElectricMake 可以生成带[*注释*的构建日志](http://www.electric-cloud.com/blog/2009/03/31/data-mining-electricaccelerator-annotation-bill-of-materials/)，该日志将向您显示构建中的每个作业访问了哪些文件，以及作业之间的依赖关系（显式和隐式），您可以使用它来纠正 makefile 中缺少的依赖关系.

您可以下载并试用[ElectricAccelerator Huddle](http://electric-cloud.com/products/electricaccelerator/huddle/)，它是 ElectricAccelerator 的免费增值版。

*免责声明：我是 ElectricAccelerator 的架构师和技术主管。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-28T04:10:23.110

您可以尝试分析依赖关系本身。Cmake 可以相当容易地在 dot/graphviz 中生成依赖关系图： [http ://www.cmake.org/Wiki/CMake:For_CMake_Hackers](http://www.cmake.org/Wiki/CMake:For_CMake_Hackers)

一些图论可能有助于您的分析： [http ://en.wikipedia.org/wiki/Graph_theory](http://en.wikipedia.org/wiki/Graph_theory)

# r - 贝叶斯层次模型的 WinBUGS 代码

> ID：11692587
> 
> 赞同：3
> 
> 时间：2012-07-27T17:19:28.070
> 
> 标签：r, bayesian, winbugs, winbugs14

我正在阅读这篇[论文](http://www-bcf.usc.edu/~qianghua/papers/P18.pdf)（旨在使用贝叶斯分层方法对纳米线 (NW) 生长进行建模）。在第 7 页，作者提出了一个模型来描述纳米线的生长。我正在尝试编写 WinBUGS 代码（请参见下文），但我不确定它是否正确。

我从论文中引用了这一点作为摘要：

> 案例研究将展示不确定性下 NW 增长过程的分层建模和估计过程。...其中的数据是在六种生长条件（T = 365°C、380°C、400°C、420°C、430° C，440°C）。前四个条件用于模型构建。我们不考虑这两种高温条件，因为在 180 秒和 900 秒时没有观察到。“</p>

所以我们要处理三个变量，包括时间（以秒为单位）、温度（以摄氏度为单位）和纳米线的长度（以厘米为单位）。有四个温度级别（365°C、380°C、400°C 和 420°C）和四个时间点（15 秒、30 秒、180 秒、900 秒）。我没有每个条件下的确切长度值，因此我通过查看论文中的图 6 生成了一些值。

这是 WinBUGS 代码。它运行完美，但我不确定它是否正确。我很感激任何意见。谢谢！

```
model
{
    for(j in 1 : 4) {
        for(i in 1 : 4) {
            X[i,j] ~ dnorm(mu[i,j], tau)
            mu[i,j] <- (step(t0[j] - t[i]))  * ((a1[j]*(exp(-alpha2[j]/t[i])))) + (step(t[i] - t0[j])) * ((a3[j]*t[i]) + (a1[j]*(exp(-alpha2[j]/t0[j]))) -a3[j]*t0[j])
        }

        t0[j] ~ dunif(1,40)
        alpha2[j] ~ dunif(1,20)

        a1[j]~ dnorm(mua1[j], tau1)
        a3[j]~ dnorm(mua3[j], tau3)

        alpha1[j] <- exp(a11)
        alpha3[j] <- exp(a33)

        log(mua1[j]) <- log(alpha1[j]) - (230/(T[j]*1.3806503*pow(10, -23)))
        log(mua3[j]) <- log(alpha3[j]) - (230/(T[j]*1.3806503*pow(10, -23)))
    }

    a11~ dnorm(0,0.001)
    a33~ dnorm(0, 0.001)

    tau1 <- pow(sigma1, -2)
    sigma1 ~ dunif(0,10)

    tau3 <- pow(sigma3, -2)
    sigma3 ~ dunif(0,10)

    tau <- pow(sigma, -2)
    sigma ~ dunif(0,20)
}

list(X= structure(.Data= c(0.00011E+00, 0.00022E+00, 2.00000E-02, 3.50000E-02, 7.00000E-03, 7.00000E-03, 3.00000E-01, 3.00000E-01, 3.50000E-02, 7.00000E-02, 2.50000E-01, 5.00000E-01, 2.00000E-01, 2.25000E-01, 5.50000E-01, 2.30000E+00), .Dim=c(4, 4)), T=c(3.65000E+02, 3.80000E+02, 4.00000E+02, 4.20000E+02), t=c(1.50000E+01, 3.00000E+01, 1.80000E+02, 9.00000E+02)) 
```

# c# - .Net RouteTable 用于未触发的图像

> ID：11692589
> 
> 赞同：0
> 
> 时间：2012-07-27T17:19:36.127
> 
> 标签：c#, .net, dynamic

我在 global.asax 文件中为已移动到数据库的图像设置了一个路由表。当我使用将 EmpImages/[numeric id] 作为基本格式的 url 时，如果我使用与 ~/EmpImages/42 相同的 url，它就可以正常工作，但是我们有数百个硬编码链接是 ~/EmpImages/42 .png。当我尝试使用 EmpImages/[numeric id].png 时，永远不会调用处理程序。

我查看了几个显示 .ext 的示例，但它们使用的是页面路由而不是处理程序。使用下面的代码，您能告诉我我缺少什么吗？

这部分工作：

```
RouteTable.Routes.Add(new Route("EmpImages/{id}/{size}", new EmployeeImageRouteHandler()));
RouteTable.Routes.Add(new Route("EmpImages/{id}", new EmployeeImageRouteHandler())); 
```

使用网址时：

```
~/EmpImages/42
~/EmpImages/42/256 
```

但是当我尝试时：

```
RouteTable.Routes.Add(new Route("EmpImages/{id}/{size}.png", new EmployeeImageRouteHandler()));
RouteTable.Routes.Add(new Route("EmpImages/{id}.png", new EmployeeImageRouteHandler())); 
```

使用网址时：

```
~/EmpImages/42.png
~/EmpImages/42/256.png 
```

它失败。处理程序永远不会被调用。

我错过了什么简单的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:53:22.357

根据 Route 的文档，[您](http://msdn.microsoft.com/en-us/library/system.web.routing.route)指定路线的方式似乎不受支持。

引用文档：

> URL 模式由 HTTP 请求中应用程序名称之后的段组成……每个段由 / 字符分隔。当一个段括在大括号（ { 和 } ）中时，该段被称为一个 URL 参数。ASP.NET 路由从请求中检索值并将其分配给 URL 参数...如果段未括在大括号中，则该值被视为文字值。

显然，它不支持具有混合 URL 参数和文字的段。

您需要让您的 EmployeeImageRouteHandler 在内部处理带有字符串处理的大小参数的“.png”扩展名。

编辑：除此之外，在处理带有点的 URL 时似乎存在一个已知问题，[请参阅这个 StackOverflow 问题](https://stackoverflow.com/questions/294495/semantic-urls-with-dots-in-net)。提出的解决方案包括

```
<httpRuntime relaxedUrlToFileSystemMapping="true" /> 
```

在您的 web.config 中，但这仅适用于 ASP 4.0 和 IIS 7.0 及更高版本。如所示问题中所述，此问题的详细信息在[Haacked](http://haacked.com/archive/2010/04/29/allowing-reserved-filenames-in-URLs.aspx)上进行了讨论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T18:37:41.230

据我所知，[上面](https://stackoverflow.com/a/11693089/1105881)的 dmi_ 关于路由解析限制是正确的。但是您可以从那里得出一个简单的解决方法：

注册您的路线如下：

```
RouteTable.Routes.Add(new Route("EmpImages/{id}/{size}/i.png", new EmployeeImageRouteHandler()));
RouteTable.Routes.Add(new Route("EmpImages/{id}/i.png", new EmployeeImageRouteHandler())); 
```

并要求他们：

```
~/EmpImages/42/i.png
~/EmpImages/42/256/i.png 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T13:35:40.833

问题是您尝试通过路由捕获的路径是静态资源。如果路由所在位置存在文件，则忽略路由。这是设计使然，既可以防止静态 url 引用之间的冲突，又可以防止每个请求都使用路由引擎。

尝试在您的处理程序中放置一个断点，然后指定一个您知道不存在的 id 以查看是否是这种情况。

# actionscript-3 - TextField 单词被剪切 AS3

> ID：11692591
> 
> 赞同：0
> 
> 时间：2012-07-27T17:19:40.557
> 
> 标签：actionscript-3, flash, textfield, cut, words

即使 wordWrap 属性设置为 true，我也遇到了 TextField 组件在每行末尾剪切单词的问题。

例子：

```
This is a test te
xt, this is a tes
t text. This is a
test text. 
```

如何解决这个问题？谢谢

编辑1：

我有一个使用参数 .size=20 应用的 textFormat。

编辑2：

以下是相关代码：

```
var tx:TextField = new TextField();
var tf:TextFormat = new TextFormat();

tf.size = 18;

tx.defaultTextFormat = tf;      
tx.autoSize = TextFieldAutoSize.CENTER;
tx.multiline = true;
tx.wordWrap = true;
tx.width = 835;

tx.text = "Long text.."; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-02T09:30:55.753

你可以用右边距解决这个问题。您需要多少边距取决于字体大小。你必须测试一下。

只需将 x px 宽度添加到您的 textField

tf.width += 10;

并在 tf 中添加相同数量的右边距：

tf.rightMargin = 10;

现在没有话被删减

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T18:18:02.157

这个应用程序适合我。它和你的一样，除了我在应用程序中指定没有缩放，并且对齐为左上角。如果我不这样做，文本将无法正确呈现。

```
package
{
    import flash.display.Sprite;
    import flash.display.StageAlign;
    import flash.display.StageScaleMode;
    import flash.text.TextField;
    import flash.text.TextFieldAutoSize;
    import flash.text.TextFormat;

    public class Woot extends Sprite
    {
        public function Woot()
        {
            super();
            stage.align=StageAlign.TOP_LEFT;
            stage.scaleMode=StageScaleMode.NO_SCALE;
            var tx:TextField = new TextField();
            var tf:TextFormat = new TextFormat();
            tf.size = 18;
            tx.defaultTextFormat = tf;
            tx.autoSize = TextFieldAutoSize.CENTER;
            tx.multiline = true;
            tx.wordWrap = true;
            tx.width = 835;
            tx.text = "this is some long text. this is some long text. this is some long text.this is some long text. this is some long text. this is some long text.this is some long text. this is some long text. this is some long text.this is some long text. this is some long text. this is some long text.this is some long text. this is some long text. this is some long text.this is some long text. this is some long text. this is some long text.this is some long text. this is some long text. this is some long text.this is some long text. this is some long text. this is some long text.this is some long text. this is some long text. this is some long text.this is some long text. this is some long text. this is some long text.this is some long text. this is some long text. this is some long text.this is some long text. this is some long text. this is some long text.this is some long text. this is some long text. this is some long text.";
            addChild(tx);
        }
    }
} 
```

# java - 失败的“重试”逻辑的设计模式？

> ID：11692595
> 
> 赞同：68
> 
> 时间：2012-07-27T17:19:50.387
> 
> 标签：java, design-patterns, io

我正在编写一些重新连接逻辑，以定期尝试建立与已关闭的远程端点的连接。本质上，代码如下所示：

```
public void establishConnection() {
    try {
        this.connection = newConnection();
    } catch (IOException e) {
        // connection failed, try again.
        try { Thread.sleep(1000); } catch (InterruptedException e) {};

        establishConnection();
    }
} 
```

我已经多次使用与上述类似的代码解决了这个普遍问题，但我对结果很不满意。是否有专门用于处理此问题的设计模式？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-27T17:45:33.693

无耻插件：我已经实现了一些允许重试操作的类。~~该库尚未提供，但您可以[在 github 上 fork](https://github.com/Ninja-Squad/ninja-core/tree/master/src/main/java/com/ninja_squad/core/retry)~~. 并且存在一个[叉子](https://github.com/rholder/guava-retrying)。

它允许构建具有各种灵活策略的重试器。例如：

```
Retryer retryer = 
    RetryerBuilder.newBuilder()
                  .withWaitStrategy(WaitStrategies.fixedWait(1, TimeUnit.SECOND))
                  .withStopStrategy(StopStrategies.stopAfterAttempt(3))
                  .retryIfExceptionOfType(IOException.class)
                  .build(); 
```

然后您可以使用重试器执行一个可调用的（或多个）：

```
retryer.call(new Callable<Void>() {
    public Void call() throws IOException {
        connection = newConnection();
        return null;
    }
} 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-07-27T17:26:36.607

您可以尝试[Idempotent Retry Pattern](http://servicedesignpatterns.com/WebServiceInfrastructures/IdempotentRetry)。

![在此处输入图像描述](../Images/856df47bf8d5cbf091db1f36baa8b1da.png)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2018-05-25T17:03:31.487

[我真的很喜欢这个博客](https://myadventuresincoding.wordpress.com/2014/07/30/java-creating-a-simple-retry-command-with-function-passing-in-java-8/)中的 Java 8 代码，并且你的类路径上不需要任何额外的库。

您只需将一个函数传递给重试类。

```
@Slf4j
public class RetryCommand<T> {

    private int maxRetries;

    RetryCommand(int maxRetries)
    {
        this.maxRetries = maxRetries;
    }

    // Takes a function and executes it, if fails, passes the function to the retry command
    public T run(Supplier<T> function) {
        try {
            return function.get();
        } catch (Exception e) {
            log.error("FAILED - Command failed, will be retried " + maxRetries + " times.");
            return retry(function);
        }
    }

    private T retry(Supplier<T> function) throws RuntimeException {

        int retryCounter = 0;
        while (retryCounter < maxRetries) {
            try {
                return function.get();
            } catch (Exception ex) {
                retryCounter++;
                log.error("FAILED - Command failed on retry " + retryCounter + " of " + maxRetries, ex);
                if (retryCounter >= maxRetries) {
                    log.error("Max retries exceeded.");
                    break;
                }
            }
        }
        throw new RuntimeException("Command failed on all of " + maxRetries + " retries");
    }
} 
```

并使用它：

```
new RetryCommand<>(5).run(() -> client.getThatThing(id)); 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-07-26T23:01:43.800

使用[故障安全](https://github.com/jhalterman/failsafe)（作者在这里）：

```
RetryPolicy retryPolicy = new RetryPolicy()
  .retryOn(IOException.class)
  .withMaxRetries(5)
  .withDelay(1, TimeUnit.SECONDS);

Failsafe.with(retryPolicy).run(() -> newConnection()); 
```

没有注释，没有魔法，不需要是 Spring 应用程序等。简单明了。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-02-03T08:39:14.860

我正在使用 AOP 和 Java 注释。[jcabi-aspects](http://aspects.jcabi.com/annotation-retryonfailure.html)中有一个现成的机制（我是开发者）：

```
@RetryOnFailure(attempts = 3, delay = 1, unit = TimeUnit.SECONDS)
public void establishConnection() {
  this.connection = newConnection();
} 
```

附言。您也可以`RetryScalar`从[Cactoos](http://www.cactoos.org)尝试。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-02-19T22:14:27.013

你可以试试[spring-retry](https://github.com/spring-projects/spring-retry)，它有一个干净的界面，而且很容易使用。

例子：

```
 @Retryable(maxAttempts = 4, backoff = @Backoff(delay = 500))
 public void establishConnection() {
    this.connection = newConnection();
 } 
```

如果出现异常，它将重试（调用）方法**建立连接（** ）最多 4 次，退避策略为 500 毫秒

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-08-08T05:10:59.107

[Sarge](https://github.com/jhalterman/sarge)是一个值得一试的库，它会根据定义的计划自动执行重试。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-02-27T16:07:09.177

您还可以创建一个包装器函数，该函数仅对预期操作进行循环，并且何时完成就跳出循环。

```
public static void main(String[] args) {
    retryMySpecialOperation(7);
}

private static void retryMySpecialOperation(int retries) {
    for (int i = 1; i <= retries; i++) {
        try {
            specialOperation();
            break;
        }
        catch (Exception e) {
            System.out.println(String.format("Failed operation. Retry %d", i));
        }
    }
}

private static void specialOperation() throws Exception {
    if ((int) (Math.random()*100) % 2 == 0) {
        throw new Exception("Operation failed");
    }
    System.out.println("Operation successful");
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-04-12T17:52:09.533

如果您使用的是 java 8，这可能会有所帮助。

```
import java.util.function.Supplier;

public class Retrier {
public static <T> Object retry(Supplier<T> function, int retryCount) throws Exception {
     while (0<retryCount) {
        try {
            return function.get();
        } catch (Exception e) {
            retryCount--;
            if(retryCount == 0) {
                throw e;
            }
        }
    }
    return null;
}

public static void main(String[] args) {
    try {
        retry(()-> {
            System.out.println(5/0);
            return null;
        }, 5);
    } catch (Exception e) {
        System.out.println("Exception : " + e.getMessage());
    }
}
} 
```

谢谢，

普拉文·R。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-27T17:29:29.380

重试没有什么特别的 - 以这个类为例[http://www.docjar.com/html/api/org/springframework/jms/listener/DefaultMessageListenerContainer.java.html](http://www.docjar.com/html/api/org/springframework/jms/listener/DefaultMessageListenerContainer.java.html) 正如你所看到的，即使是spring开发人员仍在写作重试代码 - 第 791 行......没有这样的特殊模式 AFAIK..

我可以建议处理资源的是使用 apache commons pool library - 检查这个[http://commons.apache.org/pool/apidocs/org/apache/commons/pool/impl/GenericObjectPool.html](http://commons.apache.org/pool/apidocs/org/apache/commons/pool/impl/GenericObjectPool.html)并访问[http:// /commons.apache.org/pool](http://commons.apache.org/pool)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-12-06T09:38:21.763

我正在使用[retry4j](https://github.com/elennick/retry4j)库。测试代码示例：

```
public static void main(String[] args) {
    Callable<Object> callable = () -> {
        doSomething();
        return null;
    };

    RetryConfig config = new RetryConfigBuilder()
            .retryOnAnyException()
            .withMaxNumberOfTries(3)
            .withDelayBetweenTries(5, ChronoUnit.SECONDS)
            .withExponentialBackoff()
            .build();

    new CallExecutorBuilder<>().config(config).build().execute(callable);
}

public static void doSomething() {
    System.out.println("Trying to connect");
    // some logic
    throw new RuntimeException("Disconnected"); // init error
    // some logic
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-05-09T19:45:08.523

这是执行重试的另一种方法。没有库，没有注释，没有额外的实现。导入 java.util.concurrent.TimeUnit；

```
public static void myTestFunc() {
        boolean retry = true;
        int maxRetries = 5;   //max no. of retries to be made
        int retries = 1;
        int delayBetweenRetries = 5;  // duration  between each retry (in seconds)
        int wait = 1;
    do {
        try {
            this.connection = newConnection();
            break;
        }
        catch (Exception e) {
            wait = retries * delayBetweenRetries;
            pause(wait);
            retries += 1;
            if (retries > maxRetries) {
                retry = false;
                log.error("Task failed on all of " + maxRetries + " retries");
            }
        }
    } while (retry);

}

public static void pause(int seconds) {
    long secondsVal = TimeUnit.MILLISECONDS.toMillis(seconds);

    try {
        Thread.sleep(secondsVal);
    }
    catch (InterruptedException ex) {
        Thread.currentThread().interrupt();
    }
} 
```

}

# java - BufferedImage 图像指针数据作为 C 函数的 JNI 参数

> ID：11692598
> 
> 赞同：3
> 
> 时间：2012-07-27T17:20:14.633
> 
> 标签：java, c, pointers, java-native-interface, bufferedimage

我正在开发一个使用 JNI（C 动态/共享库的桥）的 Java 应用程序。在应用程序的 Java 端，我生成了一系列图像，在 C 代码中，我将它们编码为视频。

我知道我可以将图像保存在某种临时文件中，然后将文件路径传递给 C，但这看起来很笨拙而且很慢。

我可以获取 BufferedImage RGB24 数组数据并将其传递给 C 吗？

我是 Java 和 JNI 的新手。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T17:25:13.000

将 byte[] 从 Java 转移到 C 是完全可能的。

它实际上很简单，但你真的需要注意你的方法签名。寻找示例代码..

```
 JNIEXPORT jbyteArray passToC(JNIEnv* env, jobject obj, jbyteArray array)
  {
      int length = (*env)->GetArrayLength(env, array);
      byte data[256];
      (*env)->GetByteArrayRegion(env, array, 0, 256, data);
      //data should hold your bytes now.
  } 
```

这里也是一个有用的链接[http://docs.oracle.com/javase/1.4.2/docs/guide/jni/spec/functions.html](http://docs.oracle.com/javase/1.4.2/docs/guide/jni/spec/functions.html)

编辑：但就像我说的那样，对方法名称要非常小心，因为它需要在其中的某个地方有一个包/类......

也看看这个，[JNI Calls 在 C 和 C++ 中不同吗？](https://stackoverflow.com/questions/935379/jni-calls-different-in-c-vs-c/9095100#9095100) 它将极大地阐明 JNI，因为在线教程似乎从未真正提出**JNI 对于 C++ 与 C 不同**的事实足够清楚......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T17:29:10.823

是啊，就是。

`jintArray`或者`jbyteArray`是您应该使用的结构。

如果我没记错的话，有`getRGB(...)`一种方法`BufferedImage`可以返回一个表示 RGB 值的整数数组。

所以，把这两个放在一起，你就会上路。

有关方法签名等，请参阅[本文档。](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/jnistring.html)

# ajax - 通过ajax调用重定向页面

> ID：11692601
> 
> 赞同：0
> 
> 时间：2012-07-27T17:20:19.597
> 
> 标签：ajax

我正在通过 ajax 请求发送带有字段电子邮件和密码的表单。如果它们不匹配，我会在 Div id 中收到“用户名和密码不正确”的响应。如果名称和密码匹配页面应该重定向到另一个页面。但我是在相同的 div id 中获取整个页面。如果密码和名称匹配而不是页面重定向到另一个页面，并且如果密码和名称不匹配，那么它会在相同的 id 中给出响应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:22:58.507

为什么不让你的 webapp 重定向到不同的页面而不是依赖 ajax？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:25:58.350

加载 (onload/onComplete (prototypejs)/done (jQuery)) 后，您可以简单地检查 div（或 responseText）是否包含`username and password is not correct`. 如果不是（例如使用 indexOf），则只需`window.location.href = 'loggedin.php';`.

# spring - 在 Spring MVC 3.1 中强制初始化 @ModelAttributes

> ID：11692604
> 
> 赞同：2
> 
> 时间：2012-07-27T17:20:27.410
> 
> 标签：spring, session, spring-mvc

我正在编写一个类似向导的控制器来处理跨多个视图的单个 bean 的管理。我使用 @SessionAttributes 来存储 bean，并使用 SessionStatus.setComplete() 在最终调用中终止会话。但是，如果用户放弃向导并转到应用程序的另一部分，我需要强制 Spring 在他们返回时重新创建 @ModelAttribute。例如：

```
@Controller
@SessionAttributes("commandBean")
@RequestMapping(value = "/order")
public class OrderController
{
  @RequestMapping("/*", method=RequestMethod.GET)
  public String getCustomerForm(@ModelAttribute("commandBean") Order commandBean)
  {
    return "customerForm";
  }

  @RequestMapping("/*", method=RequestMethod.GET)
  public String saveCustomer(@ModelAttribute("commandBean") Order commandBean, BindingResult result)
  {
    [ Save the customer data ];
    return "redirect:payment";
  }

  @RequestMapping("/payment", method=RequestMethod.GET)
  public String getPaymentForm(@ModelAttribute("commandBean") Order commandBean)
  {
    return "paymentForm";
  }

  @RequestMapping("/payment", method=RequestMethod.GET)
  public String savePayment(@ModelAttribute("commandBean") Order commandBean, BindingResult result)
  {
    [ Save the payment data ];
    return "redirect:confirmation";
  }

  @RequestMapping("/confirmation", method=RequestMethod.GET)
  public String getConfirmationForm(@ModelAttribute("commandBean") Order commandBean)
  {
    return "confirmationForm";
  }

  @RequestMapping("/confirmation", method=RequestMethod.GET)
  public String saveOrder(@ModelAttribute("commandBean") Order commandBean, BindingResult result, SessionStatus status)
  {
    [ Save the payment data ];
    status.setComplete();
    return "redirect:/order";
  }

  @ModelAttribute("commandBean")
  public Order getOrder()
  {
    return new Order();
  }
} 
```

If a user makes a request to the application that would trigger the "getCustomerForm" method (i.e., [http://mysite.com/order](http://mysite.com/order)), and there's already a "commandBean" session attribute, then "getOrder" is not called. I need to make sure that a new Order object is created in this circumstance. Do I just have to repopulate it manually in getCustomerForm?

Thoughts? Please let me know if I'm not making myself clear.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T01:08:23.220

Yes, sounds like you may have to repopulate it manually in `getCustomerForm` - if an attribute is part of the `@SessionAttributes` and present in the session, then like you said `@ModelAttribute` method is not called on it.

An alternative may be to define a new controller with only `getCustomerForm` method along with the `@ModelAttribute method` but without the @SessionAttributes on the type so that you can guarantee that @ModelAttribute method is called, and then continue with the existing @RequestMapped methods in the existing controller.

# ruby - Google Drive 根文件夹文件未找到错误

> ID：11692610
> 
> 赞同：2
> 
> 时间：2012-07-27T17:21:13.763
> 
> 标签：ruby, google-drive-api

我编写了一个创建文件对象的程序，如果没有指定父级，默认情况下会在根文件夹中创建该文件对象。然后给定文件父级的 id，它会检索根文件夹。

由于某种奇怪的原因，这不再有效，而不是返回根文件夹，我得到一个 File Not Found 错误。有任何想法吗？

谢谢

**更新**

我尝试通过将“root”作为 file_id 传递来检索文件，但遇到了同样的错误。

```
Get File By ID Error: File not found: 0AFrTA6Qc9-_TU9PVA 
```

下面是用到的函数

```
def get_file_by_id session, file_id
  drive = session.discovered_api("drive", "v2")
  result = session.execute api_method: drive.files.get, parameters: {'fileId' => file_id}
  if result.status == 200
    return result.data
  else
    raise "Get File By ID Error: #{result.data['error']['message']}"
  end
end 
```

但是，我可以通过 ID 获取除根以外的其他文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T18:01:41.480

没有看到代码，很难说你做错了什么。但是，有一种比您正在做的更容易为用户获取根文件夹的方法！

您可以使用特殊的“根”ID 来引用当前用户的根文件夹。

获取[https://www.googleapis.com/drive/v2/files/root](https://www.googleapis.com/drive/v2/files/root)

这将返回有关根文件夹的信息。它也可以在[about 集合](https://developers.google.com/drive/v2/reference/about/get)中找到。

更新：有关根文件夹的详细信息只能使用[https://www.googleapis.com/auth/drive](https://www.googleapis.com/auth/drive)范围。使用文件范围时，无法从 Drive UI 或选取器“打开”根文件夹以授权应用访问。

# razor - 带有 img 不需要的填充的 Razor jQuery 手风琴标题

> ID：11692612
> 
> 赞同：0
> 
> 时间：2012-07-27T17:21:18.310
> 
> 标签：razor, image, jquery-ui-accordion

Razor，MVC3 代码优先，JQuery Accordion 1.8.22，jQuery 1.7.2。

当我在 Razor 视图中将图像添加到我的 jQuery 手风琴 h3 标题时，图像周围有额外的填充。我从 jQuery 站点创建了手风琴代码，当我将它作为 html 页面运行时，img 完全适合标题，没有额外的填充，当手风琴折叠时，标题之间有一个像素。当我使用相同的 jQuery、样式表和图像获取完全相同的代码并将它们放在剃刀视图中时，图像会在标题中浮动，从而在其周围产生大量不需要的空间。我已经在 IE9 和最新的 Chrome 以及不同的图像中尝试过这个，但问题仍然存在。

任何人都可以复制这个问题吗？有没有人成功地将图像添加到 Razor 中的手风琴 h3 标题并让图像填充标题而没有任何额外的填充？

```
<script type="text/javascript">
  $(function () { $("#accordion").accordion({  });   }); </script>

<div id="accordion">

<h3 style="height: 42px"><a href="#">
  <img src="@Url.Content"~/Content/themes/base/images/part1.jpg")"
                                alt="Part 1" style="border-style: none"/></a></h3> 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T14:28:15.260

我想到了。它与 Razor 视图无关。由 jQuery 站点生成的自定义 css 文件具有手风琴标题的填充设置。一旦我从项目中删除了那个css，问题就解决了。

# python - Python - 字典中的总和值

> ID：11692613
> 
> 赞同：84
> 
> 时间：2012-07-27T17:21:44.230
> 
> 标签：python, list, dictionary

我有一个非常简单的清单：

```
example_list = [
    {'points': 400, 'gold': 2480},
    {'points': 100, 'gold': 610},
    {'points': 100, 'gold': 620},
    {'points': 100, 'gold': 620}
] 
```

我怎样才能总结所有*的黄金*价值？我正在寻找漂亮的oneliner。

现在我正在使用这段代码（但这不是最好的解决方案）：

```
total_gold = 0
for item in example_list:
    total_gold += example_list["gold"] 
```

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2012-07-27T17:22:53.713

```
sum(item['gold'] for item in myList) 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-07-27T19:16:13.717

如果你有记忆意识：

```
sum(item['gold'] for item in example_list) 
```

如果你非常注重时间：

```
sum([item['gold'] for item in example_list]) 
```

在大多数情况下，只使用生成器表达式，因为性能提升仅在非常大的数据集/非常热的代码路径上才明显。

请参阅[此答案](https://stackoverflow.com/questions/1247486/python-list-comprehension-vs-map/1247490#1247490)以了解为什么应避免使用地图。

有关列表理解与生成器表达式的一些真实时间比较，请参阅[此答案](https://stackoverflow.com/questions/5889611/one-liner-to-determine-if-dictionary-values-are-all-empty-lists-or-not/5889662#5889662)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-07-27T17:23:51.057

如果您愿意`map`，这也可以：

```
 import operator
 total_gold = sum(map(operator.itemgetter('gold'),example_list)) 
```

但我认为 gddc 发布的生成器要好得多。这个答案真的只是为了指出存在`operator.itemgetter`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-25T12:07:13.093

```
example_list = [
    {'points': 400, 'gold': 2480},
    {'points': 100, 'gold': 610},
    {'points': 100, 'gold': 620},
    {'points': 100, 'gold': 620}
]

result = np.sum([x['gold'] for x in example_list])

print(result) 
```

输出

```
 4330 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-24T00:58:29.400

```
from collections import Counter
from functools import reduce
from operator import add

sum_dict = reduce(add, (map(Counter, example_list)))
# Counter({'points': 700, 'gold': 4330})
total_gold = sum_dict['gold'] 
```

# jquery - jQuery动态创建单选按钮和属性

> ID：11692616
> 
> 赞同：0
> 
> 时间：2012-07-27T17:21:50.713
> 
> 标签：jquery

我正在使用 smarty 并创建一个动态 html 表，其中每个选择都有单选按钮。当我选择一个单选按钮时，我希望在我刚刚选择的单选按钮下方显示一个隐藏行（带有评论文本区域）。当我运行以下代码时，它将在每个单选按钮下方显示一行，而不是我刚刚选择的那个：

**Smarty 单选按钮：**

```
<tr>
  <td>
    <input 
       type="radio" 
       name="refund_selected" 
       id="refund_selected" 
       value="{smartydynamictag}" />
  </td>
</tr> 
```

**隐藏的评论行：**

```
<tr id="refund_comments" style="display: none;">
  <th colspan="6">Test Here</th>
</tr> 
```

**我的 jQuery：**

```
$("input[name=refund_selected]").click(function() { 
    if ($("input[name=refund_selected]").attr('checked')) {
        $("tr#refund_comments").show(); 
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:24:50.873

我在这里对您的标记的组织方式进行了有根据的猜测，但这*可能*有效：

```
$("input[name=refund_selected]").click(function() { 
        if ($("input[name=refund_selected]").attr('checked')) {
            $(this).parent().parent().next('#refund_comments').show(); 
        }
}); 
```

另外，你有多个相同的ID吗？因为上面的代码修改甚至不应该是必要的；不允许重复 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:26:22.930

尝试参考 THIS，因为您只想检查刚刚检查过的收音机

> ```
> $("input[name=refund_selected]").click(function() { 
>   if ($(this).is(':checked')) {
>     $("tr#refund_comments").show(); 
>   }});
> }); 
> ```

# static - 错误 85 参数 1：无法从“System.Reflection.ConstructorInfo”转换为“Mono.Cecil.TypeReference”

> ID：11692617
> 
> 赞同：1
> 
> 时间：2012-07-27T17:21:51.280
> 
> 标签：static, analysis, gendarme

目前我正在尝试使用 Visual Studio 2010 构建 Gendarme 2.10。以下是我收到的一些错误：

```
Error   85  Argument 1: cannot convert from 'System.Reflection.ConstructorInfo' to 'Mono.Cecil.TypeReference'   C:\Tools\mono-tools\external\cecil\Test\Mono.Cecil.Tests\CustomAttributesTests.cs   359 45  Mono.Cecil.Tests
Error   12  Argument 1: cannot convert from 'System.Reflection.FieldInfo' to 'Mono.Cecil.TypeReference' C:\Tools\mono-tools\external\cecil\Test\Mono.Cecil.Tests\ImportReflectionTests.cs   103 45  Mono.Cecil.Tests
Error   24  Argument 1: cannot convert from 'System.Reflection.FieldInfo' to 'Mono.Cecil.TypeReference' C:\Tools\mono-tools\external\cecil\Test\Mono.Cecil.Tests\ImportReflectionTests.cs   149 44  Mono.Cecil.Tests
Error   46  Argument 1: cannot convert from 'System.Reflection.FieldInfo' to 'Mono.Cecil.TypeReference' C:\Tools\mono-tools\external\cecil\Test\Mono.Cecil.Tests\ImportReflectionTests.cs   198 44  Mono.Cecil.Tests
Error   60  Argument 1: cannot convert from 'System.Reflection.FieldInfo' to 'Mono.Cecil.TypeReference' C:\Tools\mono-tools\external\cecil\Test\Mono.Cecil.Tests\ImportReflectionTests.cs   276 39      Mono.Cecil.Tests
Error   14  Argument 1: cannot convert from 'System.Reflection.MethodInfo' to 'Mono.Cecil.TypeReference'    C:\Tools\mono-tools\external\cecil\Test\Mono.Cecil.Tests\ImportReflectionTests.cs   117 43  Mono.Cecil.Tests 
```

删除所有测试项目后，以下是我得到的错误：

```
Error   4   Argument 1: cannot convert from 'System.Type' to 'Mono.Cecil.TypeReference' C:\Tools\mono-tools\gendarme\framework\Gendarme.Framework.Helpers\PrimitiveReferences.cs    53  25  Gendarme.Framework
Error   3   The best overloaded method match for 'Mono.Cecil.ModuleDefinition.Import(Mono.Cecil.TypeReference)' has some invalid arguments  C:\Tools\mono-tools\gendarme\framework\Gendarme.Framework.Helpers\PrimitiveReferences.cs    53  10  Gendarme.Framework 
```

这是上面两个错误引用的代码：

```
static TypeReference GetReference (Type type, IMetadataTokenProvider metadata)
{
    ModuleDefinition module = metadata.GetAssembly ().MainModule;
    TypeReference tr;
    if (!module.TryGetTypeReference (type.FullName, out tr))
        tr = module.Import (type);
    return tr;
} 
```

有没有人有什么建议？TIA。

罗杰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T09:51:38.790

这是我放在一起的临时解决方案。请随意发表评论：

```
 static TypeReference GetReference (Type type, IMetadataTokenProvider metadata)
    {
        ModuleDefinition module = metadata.GetAssembly ().MainModule;
        ModuleKind kind = ModuleKind.Windows;
        ModuleDefinition definition = ModuleDefinition.CreateModule(module.Name, kind);
        Version version = new Version(1, 0);
        AssemblyNameDefinition nameDefinition = new AssemblyNameDefinition(module.Name, version);
        AssemblyDefinition assemblyDefinition = AssemblyDefinition.CreateAssembly(nameDefinition, definition.Name, kind);
        assemblyDefinition = AssemblyDefinition.ReadAssembly(module.Name);
        definition.Assembly = assemblyDefinition;
        IMetadataScope scope = new ModuleReference(module.Name);
        scope.MetadataToken = assemblyDefinition.MetadataToken;

        TypeReference tr = new TypeReference(type.Namespace, type.Name, definition, scope);
        //if (!module.TryGetTypeReference(type.FullName, out tr))
        //    tr = module.Import(type);
        return tr;
    } 
```

# android - android中的https文件下载导致异常

> ID：11692622
> 
> 赞同：0
> 
> 时间：2012-07-27T17:22:03.603
> 
> 标签：android, https

我有一个 servlet，我正在尝试将文件写入响应输出流。

```
response.setContentType("application/octet-stream");
String value = "attachment;filename=\"" + appName + "\"";
response.setHeader("Content-Disposition", value);
response.setContentLength((int) file.length());
response.setBufferSize(99999);
while ((length = fis.read(buffer)) > 0) {
    sumBytes = sumBytes + length;
os.write(buffer, 0, length);
}
os.flush();
fis.close(); 
```

这对 http 工作正常，但是当我尝试通过 https 下载相同的文件时，会出现 SocketException。

我认为 https 连接在请求之后就关闭了。

请为此提供解决方案。

这是例外。

```
ClientAbortException:  java.net.SocketException: Broken pipe
        at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:369)
        at org.apache.tomcat.util.buf.ByteChunk.flushBuffer(ByteChunk.java:439)
        at org.apache.tomcat.util.buf.ByteChunk.append(ByteChunk.java:354)
        at org.apache.catalina.connector.OutputBuffer.writeBytes(OutputBuffer.java:392)
        at org.apache.catalina.connector.OutputBuffer.write(OutputBuffer.java:381)
        at org.apache.catalina.connector.CoyoteOutputStream.write(CoyoteOutputStream.java:89)
        at com.mfino.appselector.DownloadApp.writeFile(DownloadApp.java:139)
        at com.mfino.appselector.DownloadApp.doGet(DownloadApp.java:101)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:291)
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
        at java.lang.Thread.run(Thread.java:662)
Caused by: java.net.SocketException: Broken pipe
        at java.net.SocketOutputStream.socketWrite0(Native Method)
        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)
        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)
        at com.sun.net.ssl.internal.ssl.OutputRecord.writeBuffer(OutputRecord.java:297)
        at com.sun.net.ssl.internal.ssl.OutputRecord.write(OutputRecord.java:286)
        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.writeRecordInternal(SSLSocketImpl.java:743)
        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.writeRecord(SSLSocketImpl.java:731)
        at com.sun.net.ssl.internal.ssl.AppOutputStream.write(AppOutputStream.java:59)
        at org.apache.coyote.http11.InternalOutputBuffer.realWriteBytes(InternalOutputBuffer.java:760)
        at org.apache.tomcat.util.buf.ByteChunk.append(ByteChunk.java:359)
        at org.apache.coyote.http11.InternalOutputBuffer$OutputStreamOutputBuffer.doWrite(InternalOutputBuffer.java:784)
        at org.apache.coyote.http11.filters.IdentityOutputFilter.doWrite(IdentityOutputFilter.java:118)
        at org.apache.coyote.http11.InternalOutputBuffer.doWrite(InternalOutputBuffer.java:593)
        at org.apache.coyote.Response.doWrite(Response.java:560)
        at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:364) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:34:36.073

请发布 logcat 消息。同时只是盲目的拍摄，你有自签名证书。

看看[这里](https://stackoverflow.com/questions/1217141/self-signed-ssl-acceptance-android)和[这里](https://stackoverflow.com/questions/2642777/trusting-all-certificates-using-httpclient-over-https)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:43:09.323

可能是您在 UI 线程中下载数据，请在其他线程或 AsyncTask 中进行

# javascript - jQuery闪烁效果按钮动画（提供小提琴）

> ID：11692626
> 
> 赞同：1
> 
> 时间：2012-07-27T17:22:24.903
> 
> 标签：javascript, jquery, animation, mobile

请看看我的小提琴。为什么闪光效果只发生在第一次点击。之后它不再闪烁：

[http://jsfiddle.net/vyAkk/](http://jsfiddle.net/vyAkk/)

```
 $("#button").click(function (e) {
$(this).css('background', '#03182B').delay(500).queue(function(d) {
    $(this).css('background', '');
});
 }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T17:28:36.987

你没有出队。

```
$("#button").click(function(e) {
    $(this).css('background', '#03182B').delay(500).queue(function(d) {
        $(this).css('background', '');
        $(this).dequeue();
    });
});​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/vyAkk/8/)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T17:26:57.533

事件队列中出现了问题。`stop()`每次在运行动画之前尝试事件链：

```
$("#button").click(function (e) {
  $(this).stop().css('background', '#03182B').delay(500).queue(function(d) {
    $(this).css('background', '');
  });
}); 
```

[小提琴](http://jsfiddle.net/kva4a/)

# java - Spring MVC 没有记录所有异常

> ID：11692635
> 
> 赞同：6
> 
> 时间：2012-07-27T17:23:13.993
> 
> 标签：java, spring, exception, logging, spring-mvc

我有 Spring MVC 设置以使用公共日志记录来记录异常，但发现一些运行时异常没有被记录。

这是spring提供的默认异常解析器的bean配置：

```
<bean class="org.springframework.web.servlet.handler.SimpleMappingExceptionResolver">
    <property name="exceptionMappings">
        <props>
            <prop key="java.lang.Exception">error</prop>
        </props>
    </property>
</bean> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T17:25:41.153

为了让它记录*大多数*异常，我必须将以下行添加到我的配置中：

```
 <property name="warnLogCategory" value="someCategoryStringYouMakeUp" /> 
```

所以最终变成了下面这样：

```
<bean class="org.springframework.web.servlet.handler.SimpleMappingExceptionResolver">
    <property name="warnLogCategory" value="apperror" />
    <property name="exceptionMappings">
        <props>
            <prop key="java.lang.Exception">error</prop>
        </props>
    </property>
</bean> 
```

warnLogCategory[在这里有详细描述](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/portlet/handler/AbstractHandlerExceptionResolver.html#setWarnLogCategory%28java.lang.String%29)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T17:32:29.090

为了增强@Brad Parks 所说的内容，我建议您还制作一个 HttpServlet 过滤器，它将首先运行（最后完成）以捕获 Spring 将错过的异常。还因为有可能失败的 Spring 代码，如 Spring Security 和自定义 Http 拦截器，它们不在 SimpleMappingException Resolver 范围内（即，如果 DispatchServlet 或拦截器失败，您将不会收到异常）。

这是我在 SimpleMappingExceptionResolver 之上使用的示例过滤器。

```
public class ExceptionLoggerServletFilter implements Filter {

    private CommonAccessLogFormatter requestFormat = new CommonAccessLogFormatter();

    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
    }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException,
            ServletException {
        try {
            chain.doFilter(request, response);
        } catch (Exception e) {
            StringBuilder sb = new StringBuilder("Very Bad shit has happened:");
            if (request instanceof HttpServletRequest)
                requestFormat.appendLogEntry((HttpServletRequest) request, sb);
            log.fatal(sb.toString(), e);
            throw new ServletException(e);
        }
    }

    @Override
    public void destroy() {
    }

    private static final Logger log = Logger.getLogger(ExceptionLoggerServletFilter.class);

} 
```

我推荐这样做的原因是，对于大多数 servlet 容器，未捕获的异常可能会或可能不会记录在您的日志框架中（对于 Tomcat，它的 JULI）。

*公共日志访问格式化程序只记录类似于 Apache 日志文件的请求。*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-02-10T14:39:15.277

在我的测试中，使用`SimpleMappingExceptionResolver`can't log `MissingServletRequestParameterException`，我结合`@ControllerAdvice`并`Filter`做 log。

用于`ControllerAdvice`捕获 Spring MVC 控制器中引发的 Throwable。

```
@ControllerAdvice
public class GlobalDefaultExceptionHandler {

    private static final Logger logger = LoggerFactory.getLogger("global_controller_exception_logger");

    @ExceptionHandler(value = Throwable.class)
    public void defaultErrorHandler(Throwable e) throws Throwable {
        // If the exception is annotated with @ResponseStatus rethrow it and let
        // the framework handle it.
        // AnnotationUtils is a Spring Framework utility class.
        if (AnnotationUtils.findAnnotation
                (e.getClass(), ResponseStatus.class) != null) {
            throw e;
        }

        // Otherwise log exception
        logger.error("global controller default exception handler", e);
        throw e;
    }

    @ExceptionHandler(MissingServletRequestParameterException.class)
    public void httpBadRequest(Exception e, HttpServletRequest request) throws Exception {
        StringBuffer requestURL = request.getRequestURL();
        logger.warn("{}   HTTP Status 400 - {}", requestURL, e.getMessage());
        throw e;
    }
} 
```

用于`Filter`捕获额外的异常。

```
@WebFilter(
        filterName = "ExceptionLogFilter",
        urlPatterns = "/*",
        dispatcherTypes = {DispatcherType.REQUEST, DispatcherType.ASYNC, DispatcherType.ERROR}
)
public class ExceptionLogFilter implements Filter {

    private static final Logger logger = LoggerFactory.getLogger("global_filter_exception_logger");

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
            throws IOException, ServletException {
        try {
            chain.doFilter(request, response);
        } catch (IOException | ServletException e) {
            logger.error("bad thing happened during doFilter", e);
            throw e;
        }
    }

    ......
} 
```

回退配置

```
<logger name="global_controller_exception_logger" level="info"/>

<logger name="global_filter_exception_logger" level="info"/> 
```

您可以查看[我的要点](https://gist.github.com/cmicat/18843ce2e36740256e02b30494a39685)以获取完整代码。

# eclipse - 如何获取 Eclipse 工作区位置 URI

> ID：11692636
> 
> 赞同：9
> 
> 时间：2012-07-27T17:23:21.757
> 
> 标签：eclipse, eclipse-plugin

我正在开发一个插件，它将当前工作区的位置 URI 传递给其他方法。

```
IWorkspace workspace = ResourcesPlugin.getWorkspace(); 
```

我对 Eclipse PDE 很陌生。什么方法返回工作空间的 URI 位置。如果工作区是 C:\Eclipse\Workspace，则为 Ex。我需要路径 C:\Eclipse\Workspace

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-27T17:34:10.910

你要：

```
ResourcesPlugin.getWorkspace().getRoot().getLocation().toString(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-27T18:22:05.957

您确定需要工作区 URL 吗？您唯一可能依赖的是它将包含 .metadata 文件夹 - 其他所有内容都可能位于其他地方：

1.  可以在工作区之外创建项目。
2.  工作区文件/文件夹实际上可能是外部资源的链接（甚至可能不是本地文件）。

我的建议：

1.  如果您想查找一些资源 - 使用 IResource::getLocationURI 并检查它是否是本地文件（如果 URL 是 EFS，您可以下载内容）
2.  如果您想访问您的插件数据（即在 .metadata 中），请使用 Plugin.getStateLocation
3.  如果您仍然认为您需要工作区根 - Platform.getInstanceLocation

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T17:29:40.083

获取任何资源的绝对文件系统路径：

```
IResource.getLocation() 
```

# scala - 从 trait 中获取类字段

> ID：11692639
> 
> 赞同：2
> 
> 时间：2012-07-27T17:23:35.470
> 
> 标签：scala

我有一个特点：

```
trait A {
  /*Some methods*/
} 
```

我有很多课：

```
class B(val argument: SomeClass) extends A {
  /*Some methods*/
} 
```

我想从特质中得到一个论点。我可以在每个类和特征中创建方法 getArgument：

```
trait A {
  def getArgument: SomeClass
  /*Some methods*/
}
class B(val argument: SomeClass) extends A {
  def getArgument = argument
  /*Some methods*/
} 
```

或使用反射：

```
trait A {
  def getArgument = {
    val f =  this.getClass.getDeclaredField("argument")
    f.setAccessible(true)
    f.get(this).asInstanceOf[SomeClass]
  }
  /*Some methods*/
}
class B(val argument: SomeClass) extends A {
  /*Some methods*/
} 
```

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:41:31.390

你可以有抽象的 val：

```
trait A {
  val argument: SomeClass
}

class B(val argument: SomeClass) extends A 
```

您甚至不需要将其限制为 val：

```
trait A {
  def argument: SomeClass
}

class B(val argument: SomeClass) extends A

class C extends A {
  def argument : SomeClass = ....
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-19T16:54:13.437

一个老问题，但为了搜索者......您可以定义类型`this`并访问其成员：

```
class ArgContainer(val argument: SomeClass)

class B(argument: SomeClass) extends ArgContainer(argument) with A
class C(argument: SomeClass) extends ArgContainer(argument) with A

trait A {
  this: ArgContainer =>

  def print() = {
    println(this.argument)
  }
} 
```

在这里查看更多[如何使用带有`self`引用的scala trait？](https://stackoverflow.com/questions/10291176/how-to-use-scala-trait-with-self-reference)

# xml - Spring 显示 application/*+xml 而不是 application/xml

> ID：11692642
> 
> 赞同：0
> 
> 时间：2012-07-27T17:23:54.423
> 
> 标签：xml, spring, google-chrome, spring-mvc

我已经配置 spring 来为我们的 API 解析 xml 和 json 响应，如下所示：

```
<!-- oxm integration -->
    <bean id="objectXmlMarshaller" class="org.springframework.oxm.xstream.XStreamMarshaller" />

<bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
        <property name="ignoreAcceptHeader" value="false" />
            <property name="favorPathExtension" value="true" /> 
        <property name="mediaTypes">
            <map>
                <entry key="xml"  value="application/xml" />
                <entry key="json" value="application/json" />
            </map>
        </property>
        <property name="defaultViews">
            <list>
                <bean class="org.springframework.web.servlet.view.json.MappingJacksonJsonView" />
                <bean class="org.springframework.web.servlet.view.xml.MarshallingView">
                    <property name="marshaller" ref="objectXmlMarshaller" />
                </bean>
            </list>
        </property>
    </bean> 
```

不幸的是，spring 使用 application/*+xml 返回 xml 响应。似乎 chrome 无法打开此类扩展并将其发送到 windows 以打开它们（因此，我必须通过 windows 打开它，而不是在浏览器上看到响应）。

有谁知道为什么它返回 application/*+xml 而不是配置的 application/xml？

如果没有，有谁知道如何强制 chrome 显示它？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T08:16:50.980

我发现解决这个问题的唯一方法是直接将控制器映射到所需的：

```
@RequestMapping(produces = { "application/json", "application/xml" }) 
```

太糟糕了 spring 不允许你有一个全局定义。

# php - 在外部对 Youtube 视频发表评论？

> ID：11692643
> 
> 赞同：1
> 
> 时间：2012-07-27T17:23:56.740
> 
> 标签：php, youtube, comments

我正在尝试寻找一种方法来从我的（正在建设的）网站上对 youtube 视频发表评论。我能够通过使用 XML 获得用户在视频上发布的评论，但想知道如何让我网站上的用户无需访问 Youtube 网站就可以对他们正在观看的嵌入视频发表评论？

我目前正在使用 PHP 在我的网站内进行所有处理，以获取嵌入式视频的 url、推荐视频和用户评论，但我愿意尝试其他语言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:28:01.307

YouTube 有一个 API，以及[使用 PHP 访问它的明确指示。](https://developers.google.com/youtube/2.0/developers_guide_php#Using_community_features).

# qt - Qt：将事件传递给子小部件而无需无限递归

> ID：11692644
> 
> 赞同：0
> 
> 时间：2012-07-27T17:23:57.187
> 
> 标签：qt, events, widget

我想将一个事件转移给一个小部件的孩子。我当前的实现是（`_table`的`QTableWidget*`数据成员在哪里`MyWidget`）

```
void MyWidget::mousePressEvent(QMouseEvent *event)  
{  
    QHeaderView *headerview = _table->horizontalHeader();
    QPoint headerpoint = headerview->mapFromGlobal(event->globalPos());
    const int index = headerview->logicalIndexAt(headerpoint);
    if ((index >= 0) && (index < headerview->count())) {
        QApplication::postEvent(headerview, new QMouseEvent(QEvent::MouseButtonPress, headerpoint, event->button(), event->buttons(), Qt::NoModifier));
    }
    QWidget::mousePressEvent(event);  
} 
```

问题是这个实现似乎产生了一个无限循环或递归。

什么是正确的实现？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:39:03.770

我相信您想确保将其标记`event`为`accepted`ie：

`event->setAccepted( true );`

或者

`event->accept();`

其他根据文档“设置接受参数表示事件接收器想要事件。**不需要的事件可能会传播到父小部件。** ”

[http://doc.qt.nokia.com/4.7-snapshot/qevent.html#accepted-prop](http://doc.qt.nokia.com/4.7-snapshot/qevent.html#accepted-prop)

# visual-studio-2010 - 在调试时，如何避免在 asp classic 和 VBScript 中单步执行位于不同文件中的代码？

> ID：11692649
> 
> 赞同：0
> 
> 时间：2012-07-27T17:24:12.980
> 
> 标签：visual-studio-2010, asp-classic

在 Visual Studio 中调试**asp.net**代码时，除非您在被调用的代码中放置断点，否则流程不会转到依赖文件。这是我第一次调试**asp/VBScript**代码。在我看来，我必须经历所有的依赖

```
<!--#include virtual="path"--> 
```

这有点烦人，让我失去了对大局的关注。

无论如何我可以跳过这些文件并仅将流程保留在当前的 asp 页面上吗？

感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T18:22:12.483

这里的区别在于，在经典 ASP 中，包含文件不是传统意义上的“依赖项”。使用经典 ASP，所有这些包含都被编译到当前请求的“页面”中，从而创建单个资源。就像您无法在 If/Then 语句中有条件地添加这些文件一样，您也无法有条件地删除它们。

我的建议是在断点之间跳转并检查变量，而不是跨过每一行。

# c++ - 在基于对话框的 MFC 应用程序中保存和恢复元素的状态

> ID：11692652
> 
> 赞同：1
> 
> 时间：2012-07-27T17:24:27.730
> 
> 标签：c++, mfc

我正在编写简单的基于 C++ 对话框的 MFC 应用程序。它有几个输入、复选框、时间选择。作为其功能的一部分，它应该有保存和加载按钮，可以保存/恢复这些元素的状态。例如输入中的文本，如果某些元素被禁用，它们的值。

问题是——正确的方法是什么？最简单直接的方法是以特定顺序（例如`text1,text2,checkbox1_state,time_select1`）保存值，然后以相同的顺序一一恢复它们。

还有其他选择吗？我不想使用其他一些库（在序列化方面经常提到 Boost）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:32:41.503

MFC 有一个[CArchive](http://msdn.microsoft.com/en-us/library/caz3zy5s%28v=vs.80%29.aspx)类，您可以考虑将其用于控件或对话框的序列化。您还可以使用文件流滚动您自己的序列化。

# sql - 延迟添加 DataMapper 导致循环

> ID：11692654
> 
> 赞同：0
> 
> 时间：2012-07-27T17:24:33.773
> 
> 标签：sql, ruby, datamapper

当我想使用 DataMapper 进行 OR 查询时，我使用

```
result = MyModel.all(:first_name.like => '%john%') + MyModel.all(:last_name.like => '%john%') 
```

这工作正常并且只生成一个 SQL 查询。如何使用数组中给定的属性创建相同的结果？

```
result = [ :first_name, :last_name ].reduce([]) do |sum, prop|
  sum + MyModel.all(prop.like => '%john%')
end 
```

虽然这可行，但它使用两个单独的 SQL 查询，这不是我想要的。有没有办法在循环中创建这样一个“惰性”查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T18:33:15.460

您必须手动构建 WHERE 子句。像这样的东西：

```
props = []
values = []
[ :first_name, :last_name ].each do |prop|
  props << "(#{prop} LIKE ?)"
  values << '%john%'
end
MyModel.all :conditions => [props.join(' OR ')] + values 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T16:09:32.670

我自己想通了。问题是您不能使用空的常规数组 ( `[]`) 作为结果变量的初始值。我不想深入研究 DataMapper 内部，所以我只是对 的第一个分配进行了额外的检查`result`，如下所示：

```
result = nil
[ :first_name, :last_name ].each do |prop|
  cur = MyModel.all(prop.like => '%john%')
  next unless cur
  result ? result.nil? cur : result + cur
end 
```

# facebook - DestroySession 功能防止退出 facebook

> ID：11692656
> 
> 赞同：0
> 
> 时间：2012-07-27T17:24:44.303
> 
> 标签：facebook, session, facebook-php-sdk, logout

我正在尝试重新设计我的 Zend 站点的注销系统，以使用户也退出 facebook，以符合 facebook 应用程序政策，但我没有任何运气。这是我的注销操作中的代码，用于检查用户是否已登录 facebook，如果已登录则将其注销。

```
require_once(BASE_PATH . "/library/facebook-php/src/facebook.php");
    $facebook = new Facebook( array('appId'=>'app id', 
                        'secret'=>'secret') );
    $fbid = $facebook->getUser();
    if($fbid){
        $facebook->destroySession();
        $this->_redirect( $facebook->getLogoutUrl(array('next'=>'http://completeset.us/organizer/index') ) );
    } 
```

有了destroySession，我退出了我的网站，但由于某种原因没有退出facebook。如果我把它拿出来，我会从两个站点注销，但由于会话仍然存在，我会立即重新登录到我的站点，因为它检测到该会话并能够将其与我的帐户相匹配。如何将用户从 facebook 注销并销毁会话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T18:30:49.567

我猜 facebook 需要会话才能将用户注销或其他东西。在我的注销操作中重定向到注销 url，然后在我的回调 url 中删除会话，而不是首先尝试删除它，效果很好。

# javascript - 将鼠标悬停在同一表格中的另一行上时更改表格行的背景颜色

> ID：11692665
> 
> 赞同：3
> 
> 时间：2012-07-27T17:25:19.530
> 
> 标签：javascript, html, css

这是我在这里的第一篇文章，我绝不是一个熟练的 HTML/CSS/JavaScript 程序员，所以如果我表达得不够清楚，请多多包涵——如果太罗嗦，抱歉！

我正在为表格内容使用经典的 HTML 表格，并且希望能够更改与我当前悬停的行不同的行的背景颜色。

这样做的原因是我有很多表被分成“子表”，每个表都有自己的标题和下面的一或多行。这些子表 - 都具有相同的样式 - 但是没有编码为表，而是我只是使用不同的类来设置它们的样式（这主要是因为它们太多太小，每个包含 1-6 行包括标题）。

我想要做的是，一旦你悬停任何子表，它的标题和你当前指向的行都应该改变背景颜色（后者很容易用 CSS 实现）。多亏了在网上找到的 JavaScript，我设法实现了这一点 - 请参阅可能更好地解释这一点的[**示例代码**](http://jsfiddle.net/8DFkr/1/) ，另请参阅下面的代码 - 但是这需要每个子标题的唯一 ID。（请注意，每个子表都使用单独的 tbody - 如果将`onMouseover`事件改为应用于每一行，则子标题的颜色会在从一行悬停到另一行时闪烁/继续 - 这不会发生在 CSS 中，但只有使用 JavaScript - 当然，还要创建更多代码。）

而不是必须为每个子标题分配唯一的 ID，我想要一个使用类的解决方案，因为每个子表都使用相同的子表（我当然会分配一个类`tbody`）。我想这个棘手的部分可能是确保只有当前子表的标题受到影响，而不是同时受到影响。如果更容易创建一个解决方案，其中每个子表实际上都被编码为一个单独的表（从语义的角度来看这也可能更好？），那么请这样做。如果 JavaScript 自己应用 etc 事件当然更好`onMouseover`，这样我就不必将它放入每个子表的内联代码中 - 我已经看到这可以用于按钮等，所以我假设这是可能的。

我从未使用过 jQuery，因此更喜欢纯 JavaScript 解决方案。

对于示例代码，请再次查看**[我的小提琴](http://jsfiddle.net/8DFkr/1/)**

非常感谢您的任何意见！

JavaScript：

```
function changeTo(myId) { document.getElementById(myId).className='sub-header-highlight'; }
function changeBack(myId) { document.getElementById(myId).className='sub-header'; } 
```

CSS：

```
thead { color: #FFF; background: #000; }
.sub-header { color: #FFF; font-weight: bold; background: #F00; }
.sub-header-highlight { color:# FFF; font-weight: bold; background: #0F0; }
tr.sub-header:hover { background: #0F0; } /* if JS turned off */

.sub-row1 { color: #000; background: #FFF; }
.sub-row2 { color: #000; background: #EEE; }
tr.sub-row1:hover, .sub-row2:hover { background: #FF0; } 
```

HTML 的一部分：

```
<tbody onMouseover="changeTo('sub1');" onMouseout="changeBack('sub1');">
   <tr class="sub-header" id="sub1">
      <td>Sub-Header 1</td>
   </tr>
   <tr class="sub-row1">
      <td>Contents of row 1</td>
   </tr>
   <tr class="sub-row2">
      <td>Contents of row 2</td>
   </tr>
   <tr class="sub-row1">
      <td>Contents of row 3</td>
   </tr>
</tbody> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:33:11.910

您可以使用纯 CSS（具有通常的浏览器兼容性条件）来实现这一点，因此假设您使用的是相对现代的 Chrome、Safari、Firefox、Opera 或者可能是 IE 9（或更高版本）：

```
tbody:hover tr.sub-header {
    background-color: #0f0;
}

tbody tr.sub-row:hover {
    background-color: #f90;
}​ 
```

[JS Fiddle 演示](http://jsfiddle.net/davidThomas/8DFkr/2/)（显然，根据您的喜好调整颜色；这些只是为了演示的目的）。

当然，值得一提的是，某些浏览器可能不会显示`tr`元素的`background-color`（因为它显示在元素的*后面*），在这种情况下，您可能需要修改选择器以定位相关元素：`background-color``td``td`

```
tbody:hover tr.sub-header td {
    background-color: #0f0;
}

tbody tr.sub-row:hover td {
    background-color: #f90;
}​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T18:10:19.693

您可以大大简化 HTML 标记和 CSS，并且无需使用 Javascript。

*   首先，除了你的备用行样式之外，所有的类都可以出来（除非你不关心 IE 8 及以下，在这种情况下你可以取出 IE 条件 CSS 和类名。请参阅[浏览器 CSS 选择器兼容性图表](http://kimblim.dk/css-tests/selectors/)。）
*   其次，将其中`td`的每个子标题更改为`th`.
*   第三，使用`:hover`父级上的伪选择器来设置指定`tbody`样式。`th`

看到这个[在 jsfiddle](http://jsfiddle.net/j42Cz/7/)中工作，经过测试可以在 IE 7 和 Firefox 14 中完美运行。

这是CSS：

```
table { border-collapse:collapse; }
thead { color: #FFF; background-color: #000; }

tbody th { color: #FFF; font-weight: bold; background-color: #F00; text-align:left; }
tbody:hover th { background: #0F0; }

tbody tr:nth-child(odd) { background-color:#EEE; }
tbody tr:hover td { background: #FF0; } 
```

风格注释：

*   CSS 属性“背景”不仅需要颜色，还会重置其他属性。当您想要设置样式时，请使用“背景颜色”。
*   为了使特定规则使 IE 赋予它比奇数行的特殊着色更高的优先级，需要额外`td`的。`tr:hover`
*   “奇数”行实际上是数据的偶数行，因为子标题消耗了第一个奇数行。
*   使用 CSS`border-collapse:collapse`而不是`cellspacing`直接放在桌子上。

我不得不将 IE 的条件 CSS 放在小提琴的 HTML 部分，因为它必须在`style`标签之外。

```
<!--[if lte IE 8]>
<style type="text/css">
  tbody tr.odd { color: #000; background: #EEE; }
</style>
<![endif]--> 
```

这是HTML。看看现在有多干净？

```
<table>
   <thead>
      <tr>
         <th>MAIN HEADER</th>
      </tr>
   </thead>
   <tbody>
      <tr>
         <th>Sub-Header 1</th>
      </tr>
      <tr>
         <td>Contents of row 1</td>
      </tr>
      <tr class="odd">
         <td>Contents of row 2</td>
      </tr>
      <tr>
         <td>Contents of row 3</td>
      </tr>
   </tbody>
   <tbody>
      <tr>
         <th>Sub-Header 2</th>
      </tr>
      <tr>
         <td>Contents of row 1</td>
      </tr>
   </tbody>
   <tbody>
      <tr>
         <th>Sub-Header 3</th>
      </tr>
      <tr>
         <td>Contents of row 1</td>
      </tr>
      <tr class="odd">
         <td>Contents of row 2</td>
      </tr>
   </tbody>
</table> 
```

最后，我意识到颜色可能只是示例，所以我可以建议明亮的原色不适用于人类的认知反应吗？您可以改为使用一种突出显示效果。请参阅我为您整理[的一个工作示例](http://jsfiddle.net/uTp4C/1/)，使用（在我看来）更令人愉悦的颜色。当您将鼠标悬停在该部分上时，看看它是如何“发光”的？美丽的！

[![更漂亮的表格示例](../Images/a7691f7912715845ec36168cb1ca736a.png)](http://jsfiddle.net/uTp4C/1/)

注意：在 IE8 及之前的版本中，右侧会有一个额外的边框。如果您有一个多列表并且您喜欢内部边框并且想要支持 IE8 及更低版本，您需要在每行的最后一个单元格中添加一个类，以便移除其右边框。

# windows - .NET 取消关闭窗体可防止它在 Windows 关闭时关闭

> ID：11692666
> 
> 赞同：3
> 
> 时间：2012-07-27T17:25:21.307
> 
> 标签：windows, vb.net, shutdown, formclosing

```
 Private Sub frmMain_FormClosing(sender As Object, e As System.Windows.Forms.FormClosingEventArgs) Handles Me.FormClosing
    e.Cancel = True
    Me.WindowState = FormWindowState.Minimized
End Sub 
```

你好！

我在上面使用这个简单的代码。但是，如果在我关闭计算机时应用程序处于打开状态，Windows 会等待它关闭或希望我终止它以继续。我找不到知道用户是试图关闭应用程序还是 Windows 是的方法。我所知道的是，在这两种情况下，Windows 都会向窗口发送关闭消息，这并没有真正帮助我。我可以想到其他一些方法，但应该有一种“清晰”的认识方式。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T17:32:14.490

还有一个密切的原因：

```
Protected Overrides Sub OnFormClosing(ByVal e As FormClosingEventArgs)
  If e.CloseReason <> CloseReason.WindowsShutDown Then
    e.Cancel = True
    Me.WindowState = FormWindowState.Minimized
  End If
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T17:35:16.700

您应该能够从此[列表](http://msdn.microsoft.com/en-us/library/system.windows.forms.closereason.aspx)中实现关闭原因枚举。这将允许您这样做，以便您的计算机将关闭。您必须在 e.CloseReason 中实现 WindowsShutDown 和/或 TaskManagerClosing 枚举。

# asp.net-mvc-3 - StackOverflow 的 Ask Form 机制？

> ID：11692671
> 
> 赞同：0
> 
> 时间：2012-07-27T17:25:32.470
> 
> 标签：asp.net-mvc-3, page-caching

我们都看到，

当我们在 StackOverflow 上写一个问题时，在我们发布我们的问题之前。如果我们关闭浏览器或刷新它，我们仍然可以看到，我们在表单中输入的所有内容仍然可用。

它是如何编程的。

我想在我的应用程序中做类似的事情。

我可以考虑存储两个会话变量

1.  标题 - 问题
2.  正文 - 消息

以最短时间间隔更新会话变量并在单击“发布您的问题”按钮时终止变量

如果这是 StackOverflow 处理这个问题的方式，我不肯定。

有人可以建议最好的方法吗？

我的平台是 ASP.Net C# MVC 3.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T18:03:23.923

查看它是如何工作的最好方法是使用带有一些`inspector`示例的浏览器`Firefox`+ `Firebug`。

您会看到，该页面不时发布答案字段的内容，并通过 ajax 调用将其保存在服务器上（因此有时在键入时也会显示“草稿已保存”消息）。

后台还有其他连接：例如 websockets，这会导致站点确实已更新`on-life`。

# javascript - 如何将带双引号的字符串返回给客户端脚本，将其解析为 JSON 对象？

> ID：11692672
> 
> 赞同：0
> 
> 时间：2012-07-27T17:25:33.197
> 
> 标签：javascript, json, escaping

我有一个由 JavaScript 调用以从数据库中获取数据的 WebMethod。数据库对此是禁止的，所以我不能在那里改变任何东西。我想在 JavaScript 中做到这一点。

当它到达 JavaScript 时，字符串看起来像这样：

```
"[{"id":"0", "value":"Avery Bradley"},{"id":"31", "value":"Jason "Jet" Terry"}]" 
```

我尝试替换`('\"', '\\\"')`以添加转义字符。我让它以这种方式在 .NET 端工作`Replace("\"", "\\\"")`。但是，这是一个将使用它的自包含控件，并且应该在那里进行验证。

我究竟做错了什么？

函数 GetDataCallBack(childId, senderParam, senderValue, callback) { var values;

```
$.ajax({
    type: "POST",
    async: false,
    url: callback,
    data: "{'id': '" + childId + "', 'parameter': '" + senderParam + "', 'value': '" + senderValue + "'}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function (json) {
        values = json.d;
    }
});
return values; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:45:56.620

问题出在服务器端。它提供无效的 JSON。具体来说，这在数组中的最后一个对象内：

```
"value":"Jason "Jet" Terry" 
```

周围的那些引号`"Jet"`需要转义。服务器给你无效的 JSON。

您可以尝试纠正损坏的 JSON，但它会很笨拙并且可能不完美。

需要修复服务器端，以便它提供有效的 JSON。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:41:31.983

我认为你在这里做错了什么。JSON 文件应该只是 JSON，没有其他内容。它不应该是 JSON 的字符串表示，它被字符串解析为字符串并从那里解析为对象 - 只需将文件/流/任何内容视为字符串。

如果您需要将 JSON 嵌入到某些标记（XML、HTML）中，请在 JSON 字符串上使用该语言的指定转义方法。

如果您需要将 JSON 嵌入到某个程序文件中，请尝试使用编码对象的匹配文字表示（例如，在 Javascript 中非常简单）。如果您使用的语言没有很好的表示，请将其存储到一个额外的文本文件中并从那里读取。

# django - Django - 安装 django-tables2

> ID：11692674
> 
> 赞同：1
> 
> 时间：2012-07-27T17:25:34.663
> 
> 标签：django, django-tables2

我是 python 和 Django 的菜鸟，我尝试使用 django-tables2，但是当我想要导入时，我的项目找不到 django-tables2。

我的 Python 路径是`c:/Python27`，我正在尝试使用（Windows XP、2.7.3 和 Django 1.4）安装 django-tables2：

```
pip install django-tables2 
```

`\Lib\site-packages\django_tables2-0.11.0-py2.7.egg-info`仅使用这些文件创建此文件夹

```
 27/07/2012  16:45 1      dependency_links.txt
 27/07/2012  16:45 1.422  installed-files.txt
 27/07/2012  16:45 662    PKG-INFO
 27/07/2012  16:45 12     requires.txt
 27/07/2012  16:45 1.271  SOURCES.txt
 27/07/2012  16:45 15     top_level.txt 
```

但在 installed-files.txt 中还有更多文件尚未创建。

在我的项目中，导入无法解析“ `import django-tables2`”

你知道会发生什么吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T07:39:20.997

使用命令就OK了：

```
pip install django-tables2 
```

下面是命令输出：

```
Downloading/unpacking django-tables2
  Downloading django-tables2-0.11.0.tar.gz
  Running setup.py egg_info for package django-tables2

Requirement already satisfied (use --upgrade to upgrade): Django>=1.3 in /usr/local/lib/python2.7/dist-packages (from django-tables2)
Installing collected packages: django-tables2
  Running setup.py install for django-tables2

Successfully installed django-tables2
Cleaning up... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T20:23:45.237

try to use [easy_install](http://packages.python.org/distribute/easy_install.html) or [setup_tools](http://pypi.python.org/pypi/setuptools/) and install all packs with pip install or etc.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-08-15T05:55:18.423

试试 sudo pip ... mybe 你需要 root 来安装它

# javascript - 是否可以使用后退按钮保留表单单选选项？

> ID：11692695
> 
> 赞同：0
> 
> 时间：2012-07-27T17:26:49.577
> 
> 标签：javascript, jquery, html, jquery-plugins, webforms

用户可以选择一个单选按钮，并且根据选择的单选按钮，输入字段可以显示询问附加信息。用户提交表单；然后说他们需要返回并更改表格。当他们返回时，输入字段不再显示，但选择了正确的单选按钮。

答案只需要在 IE8+ 中工作。使用 jQuery 作为解决方案的一部分也是一种选择。

--==2012 年 7 月 31 日更新，使用 jQuery 插件 simsalabim ==--

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>

<!---<script src="sisyphus.min.js"></script>--->
<script type="text/javascript" src="https://raw.github.com/simsalabim/sisyphus/master/sisyphus.min.js"></script>
<script>
$(document).ready(function(){
    $('#form1').sisyphus();
});
</script>
</head>

<body>
<script>
    function ToggleColorOptions(el) {
    if (el == 'Std')
            {
        $('#Option1').show();
        $('#Option2').hide();
    }
        else if (el == 'Non')
            {
                $('#Option1').hide();
                $('#Option2').show();
            }
        }
</script>

<form id="form1" action="myTesta.cfm" method="post">
<input name="StdRNonStdOption" type="radio" id="StdRNonStdOption_std" onclick="ToggleColorOptions('Std');" value="Std" />
Standard <br />
<input name="StdRNonStdOption" type="radio" id="StdRNonStdOption_non" onclick="ToggleColorOptions('Non');" value="Non" />
Non-Standard <br />

<div id="Option1" style="display:none;">
    <select name="ThisColor" >
        <option></option>
        <option>Blue</option>
        <option>Green</option>
    </select>
</div>
<div id="Option2" style="display:none;">
    <input name="ThisColor" type="text" size="20" maxlength="51" />
</div>
<input type="submit" value="Save" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T16:50:57.677

使用类似 Sisyphus，类似 gmail 的客户端 localStorage 插件。可能是你最好的选择...

[http://simsalabim.github.com/sisyphus/](http://simsalabim.github.com/sisyphus/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:31:23.500

您在 JQuery 中的解决方案：

制作输入类型按钮

将扩展的 onclick 选项放在类名 someexpandedoptions 的 div 中

在点击事件切换可见性

```
$('.someexpandedoptions').css('display','inline');

$('.someexpandedoptions').css('display','none'); 
```

就这么简单。

只要确保正确初始化您的按钮。

# javascript - chrome.storage.local.set 使用变量键名

> ID：11692699
> 
> 赞同：33
> 
> 时间：2012-07-27T17:27:07.603
> 
> 标签：javascript, google-chrome-extension

在 Google Chrome 扩展程序中，我想使用[`chrome.storage.local`](http://code.google.com/chrome/extensions/storage.html#property-local)（而不是 localStorage），因为：

1.  使用键值对，值可以是任何对象（而不是仅字符串）
2.  使用 setter 更改数据模型`storage.set`可以触发事件侦听器

使用`storage.set`，我怎样才能有一个变量键名？

注意：如果我不使用 setter，我可以这样做`storage[v1]`，但对对象的更改不会触发事件侦听器。

```
var storage = chrome.storage.local;
var v1 = 'k1';

storage.set({v1:'s1'});

storage.get(v1,function(result){
    console.log(v1,result);
    //console output = k1 {}
});
storage.get('v1',function(result){
    console.log(result);
    //console output = {v1:'s1'}
}); 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-07-27T20:02:13.303

这就是你要找的东西吗？

```
var storage = chrome.storage.local;

var v1 = 'k1';

var obj= {};

obj[v1] = 's1';

storage.set(obj);

storage.get(v1,function(result){
  console.log(v1,result);
  //console output = k1 {v1:'s1'}
});

storage.get('v1',function(result){
  console.log(result);
  //console output = {v1:'s1'}
}) 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2016-10-27T14:22:04.260

现在是 2016 年，Chrome（以及 Firefox 和 Edge - 每个使用 Chrome 扩展模型的人）都支持 ES6 [Computed Property Names](http://es6-features.org/#ComputedPropertyNames)。

这样，任务就变得简单了：

```
var storage = chrome.storage.local;
var v1 = 'k1';

storage.set({
  [v1]: 's1' // Will evaluate v1 as property name
});

storage.get(v1, function(result) {
    console.log(v1, result);
}); 
```

# java - java创建从不同类继承的对象的ArrayList

> ID：11692700
> 
> 赞同：0
> 
> 时间：2012-07-27T17:27:15.893
> 
> 标签：java, inheritance, arraylist

我很困惑。
我创建了一个抽象类“Person”，然后从 Person 扩展类“Part-Time Employee”。然后我从 Person 扩展了一个名为“全职员工”的抽象类。
然后我创建了两个新类，称为“新全职员工”和“终身全职员工”，它们都从全职员工扩展而来。

我想跟踪 ArrayList 中的所有员工......这就是我在概念上陷入困境的地方。我创建了一个从 ArrayList 扩展的名为 Database 的类。

如何确保数组可以容纳我需要的所有 3 个类？我是否制作抽象类类型的数组？这让我觉得我无法访问我在继承类中定义的方法......我还读到从 ArrayList 扩展不是一个好习惯......所以创建一个带有 ArrayList 的数据库类？那仍然允许我访问我已经定义的所有内容吗？

就像我想显示整个列表一样，它如何知道要使用哪个显示功能？是tenuredFullTimeEmployee 还是NewFullTimeEmployee？

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:43:23.790

你确实有一些选择。如果类仅在行为上有所不同，那么您可以使用策略模式。如果您确实需要在 List 对象中保留不同类型的对象，然后根据该类型执行不同的操作，则可以使用访问者模式。我的猜测是，您应该放弃一些继承并采用类似策略的方法来抽象类中不同的行为。

[http://www.oodesign.com/strategy-pattern.html](http://www.oodesign.com/strategy-pattern.html)

[http://www.oodesign.com/visitor-pattern.html](http://www.oodesign.com/visitor-pattern.html)

要回答你的第二个问题，你是对的......而不是扩展 ArrayList，你应该有类似的东西

```
List<Person> people = new ArrayList<Person>(); 
```

然后使用上面建议的两种模式之一，您可以处理不同的行为。

# jquery - 使用jQuery取消选中前面的复选框时如何隐藏文本框

> ID：11692704
> 
> 赞同：0
> 
> 时间：2012-07-27T17:27:41.963
> 
> 标签：jquery

我有一个用于在复选框之后隐藏/显示文本框的功能，它工作得很好，直到有一天我将检查组更改为单选按钮组。我使用的功能是这样的

```
var U={
HideOptions: function() {
    $(".option").each(function() {
        if ($(this).closest("li").find(".extra").length) {
            if ($(this).find("input").is(":not(:checked)")) $(this).closest("li").find(".extra").hide();
            $(this).find("input").change(function() {
                $(this).closest("li").find(".extra").toggle().find(".checkgroup .extra").each(function() {
                    $(this).hide();
                    if ($(this).closest("li").find(".option input").is(":checked")) $(this).show();
                });
            });
        }
    });
},
ChangeToRadio: function(selector) {
    var $checkbox = $("input[name=" + selector + "]");
    $checkbox.click(function() {
        if ($(this).attr('checked')) {
            $checkbox.removeAttr('checked');
            $(this).attr('checked', true);
        }
    });
  }
} 
```

我的html结构是这样的

```
<ul class="checkgroup>
    <li>
        <div class="option"> 
             <input id="abc" type="checkbox" value="0" name="chk">Yes
        </div>
        <div class="extra"><input id="abc1"  type="text" value="" > </div>
    </li>
    <li>
        <div class="option"> 
             <input id="edf" type="checkbox" value="1" name="chk"> No   
        </div>
        <div class="extra"> <input id="edf1"  type="text" value="" > </div>
    </li>
    ....
 </ul>

 <script type="javascript">
       U.HideOptions();
       U.ChangeToRadio("chk");
 </scripot> 
```

通常，有几个

*   中，我使用 ChangeToRadio 函数后，发现 HideOptions 并不能很好地工作。例如，如果您选中其他“选项”，“额外”部分将不会被隐藏。

    任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:43:18.267

在您的 if 条件下，您说`$(this).attr('checked')`但是 .attr() 返回一个字符串而不是布尔值。将其更改为`$(this).attr('checked') == "checked"`并重试。

另外，如果可以的话，请尝试发布一个小提琴，以便我们一次调试多个步骤。谢谢 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:41:30.367

[http://jsfiddle.net/f26Vs/](http://jsfiddle.net/f26Vs/)

```
$('.option input:checkbox').on('click', function () {
  // you want to use .prop (it returns a boolean and is instant result) 
  //unlike .attr('checked') which has it's issue cross browser checking for true-ness

  var checked = $(this).prop('checked'), 
      _txtArea = $(this).closest('li').find('.extra');            

  if (checked) {
      _txtArea.show();
  }

  else { _txtArea.hide(); }
}); 
```

​</p>

# javafx-2 - 如何在 Javafx2 的 webstart/浏览器模式下传递参数

> ID：11692709
> 
> 赞同：0
> 
> 时间：2012-07-27T17:28:00.903
> 
> 标签：javafx-2, java-web-start

我已经阅读了有关如何执行此操作的材料，但我一直试图弄清楚如何在浏览器模式或 webstart 模式下将参数传递给我的 JavaFX2 应用程序。
我也在[这里在 OTN 论坛上问过这个问题](https://forums.oracle.com/forums/thread.jspa?messageID=10479265&#10479265)

所以我将 ColorfulCircles 项目从 Ensemble 导入到 Netbeans。然后我修改了代码并放入了一个小片段以在 init 方法之后提取一个参数，就像这样。我只是获取参数并将其设置为舞台的标题。

```
 @Override public void start(Stage primaryStage) throws Exception {
                init(primaryStage);

                Parameters params = getParameters();
                String myTitle = params.getNamed().get("myTitle");
                primaryStage.setTitle(myTitle);

                primaryStage.show();
                play();
                } 
```

然后我做了一个清理并在netbeans中构建......所有的html、jar、jnlp等都生成了。

然后我手动修改了 HTML，如下所示。但是对于任何一种模式，舞台的标题都不会更新/显示。这里缺少什么？

```
 <html><head>
              <SCRIPT src="./web-files/dtjava.js"></SCRIPT>
            <script>
                function launchApplication(jnlpfile) {
                dtjava.launch(            {
                    url : 'ColorfulCircles.jnlp',
                    jnlp_content : 'PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjxqbmxwIHNwZWM9IjEuMCIgeG1sbnM6amZ4PSJodHRwOi8vamF2YWZ4LmNvbSIgaHJlZj0iQ29sb3JmdWxDaXJjbGVzLmpubHAiPg0KICA8aW5mb3JtYXRpb24DQogICAgPHRpdGxlPkNvbG9yZnVsQ2lyY2xlczwvdGl0bGUDQogICAgPHZlbmRvcj5kZW1vPC92ZW5kb3IDQogICAgPGRlc2NyaXB0aW9uPlNhbXBsZSBKYXZhRlggMi4wIGFwcGxpY2F0aW9uLjwvZGVzY3JpcHRpb24DQogICAgPG9mZmxpbmUtYWxsb3dlZC8DQogIDwvaW5mb3JtYXRpb24DQogIDxyZXNvdXJjZXMDQogICAgPGpmeDpqYXZhZngtcnVudGltZSB2ZXJzaW9uPSIyLjArIiBocmVmPSJodHRwOi8vamF2YWRsLnN1bi5jb20vd2ViYXBwcy9kb3dubG9hZC9HZXRGaWxlL2phdmFmeC1sYXRlc3Qvd2luZG93cy1pNTg2L2phdmFmeDIuam5scCIvPg0KICA8L3Jlc291cmNlcz4NCiAgPHJlc291cmNlcz4NCiAgICA8ajJzZSB2ZXJzaW9uPSIxLjYrIiBocmVmPSJodHRwOi8vamF2YS5zdW4uY29tL3Byb2R1Y3RzL2F1dG9kbC9qMnNlIi8DQogICAgPGphciBocmVmPSJDb2xvcmZ1bENpcmNsZXMuamFyIiBzaXplPSIxNzg3NSIgZG93bmxvYWQ9ImVhZ2VyIiAvPg0KICA8L3Jlc291cmNlcz4NCiAgPGFwcGxldC1kZXNjICB3aWR0aD0iODAwIiBoZWlnaHQ9IjYwMCIgbWFpbi1jbGFzcz0iY29tLmphdmFmeC5tYWluLk5vSmF2YUZYRmFsbGJhY2siICBuYW1lPSJDb2xvcmZ1bENpcmNsZXMiID4NCiAgICA8cGFyYW0gbmFtZT0icmVxdWlyZWRGWFZlcnNpb24iIHZhbHVlPSIyLjArIi8DQogIDwvYXBwbGV0Pg0KICA8amZ4OmphdmFmeC1kZXNjICB3aWR0aD0iODAwIiBoZWlnaHQ9IjYwMCIgbWFpbi1jbGFzcz0iQ29sb3JmdWxDaXJjbGVzU2FtcGxlIiAgbmFtZT0iQ29sb3JmdWxDaXJjbGVzIiAvPg0KICA8dXBkYXRlIGNoZWNrPSJiYWNrZ3JvdW5kIi8DQo8L2pubHADQo='
                    ,
                    params: {myTitle: "MyColorfulCircles"}
                    },
                    {
                    javafx : '2.0'
                    },
                    {}
                );
                return false;
                }
            </script>

            <script>
                function javafxEmbed() {
                dtjava.embed(
                    {
                    url : 'ColorfulCircles.jnlp',
                    placeholder : 'javafx-app-placeholder',
                    width : 800,
                    height : 600,
                    jnlp_content : 'PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjxqbmxwIHNwZWM9IjEuMCIgeG1sbnM6amZ4PSJodHRwOi8vamF2YWZ4LmNvbSIgaHJlZj0iQ29sb3JmdWxDaXJjbGVzLmpubHAiPg0KICA8aW5mb3JtYXRpb24DQogICAgPHRpdGxlPkNvbG9yZnVsQ2lyY2xlczwvdGl0bGUDQogICAgPHZlbmRvcj5kZW1vPC92ZW5kb3IDQogICAgPGRlc2NyaXB0aW9uPlNhbXBsZSBKYXZhRlggMi4wIGFwcGxpY2F0aW9uLjwvZGVzY3JpcHRpb24DQogICAgPG9mZmxpbmUtYWxsb3dlZC8DQogIDwvaW5mb3JtYXRpb24DQogIDxyZXNvdXJjZXMDQogICAgPGpmeDpqYXZhZngtcnVudGltZSB2ZXJzaW9uPSIyLjArIiBocmVmPSJodHRwOi8vamF2YWRsLnN1bi5jb20vd2ViYXBwcy9kb3dubG9hZC9HZXRGaWxlL2phdmFmeC1sYXRlc3Qvd2luZG93cy1pNTg2L2phdmFmeDIuam5scCIvPg0KICA8L3Jlc291cmNlcz4NCiAgPHJlc291cmNlcz4NCiAgICA8ajJzZSB2ZXJzaW9uPSIxLjYrIiBocmVmPSJodHRwOi8vamF2YS5zdW4uY29tL3Byb2R1Y3RzL2F1dG9kbC9qMnNlIi8DQogICAgPGphciBocmVmPSJDb2xvcmZ1bENpcmNsZXMuamFyIiBzaXplPSIxNzg3NSIgZG93bmxvYWQ9ImVhZ2VyIiAvPg0KICA8L3Jlc291cmNlcz4NCiAgPGFwcGxldC1kZXNjICB3aWR0aD0iODAwIiBoZWlnaHQ9IjYwMCIgbWFpbi1jbGFzcz0iY29tLmphdmFmeC5tYWluLk5vSmF2YUZYRmFsbGJhY2siICBuYW1lPSJDb2xvcmZ1bENpcmNsZXMiID4NCiAgICA8cGFyYW0gbmFtZT0icmVxdWlyZWRGWFZlcnNpb24iIHZhbHVlPSIyLjArIi8DQogIDwvYXBwbGV0Pg0KICA8amZ4OmphdmFmeC1kZXNjICB3aWR0aD0iODAwIiBoZWlnaHQ9IjYwMCIgbWFpbi1jbGFzcz0iQ29sb3JmdWxDaXJjbGVzU2FtcGxlIiAgbmFtZT0iQ29sb3JmdWxDaXJjbGVzIiAvPg0KICA8dXBkYXRlIGNoZWNrPSJiYWNrZ3JvdW5kIi8DQo8L2pubHADQo='
                    ,
                    params: {myTitle: "MyColorfulCircles"}
                    },
                    {
                    javafx : '2.0'
                    },
                    {}
                );
                }
                <!-- Embed FX application into web page once page is loaded -->
                dtjava.addOnloadCallback(javafxEmbed);
            </script>

            </head><body>
            <h2>Test page for <b>ColorfulCircles</b></h2>
              <b>Webstart:</b> <a href='ColorfulCircles.jnlp' onclick="return launchApplication('ColorfulCircles.jnlp');">click to launch this app as webstart</a><br><hr><br>

              <!-- Applet will be inserted here -->
              <div id='javafx-app-placeholder'></div>
            </body></html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T08:10:37.830

这已在 JavaFX 2.2 中修复，您可以在此处尝试开发人员版本：[http ://www.oracle.com/technetwork/java/javafx/downloads/devpreview-1429449.html](http://www.oracle.com/technetwork/java/javafx/downloads/devpreview-1429449.html)

但请确保使用新的 ant-javafx.jar 重新生成 html/jnlp 文件（或从示例中复制它们）

# c - sprintf 总是将格式写入字符串，在 64 位 linux 上出错？

> ID：11692713
> 
> 赞同：-1
> 
> 时间：2012-07-27T17:28:15.580
> 
> 标签：c, linux

我在 64 位 linux 上使用 sprintf 的功能。当我测试由 sprintf 或 snprintf 编写的字符串时，发生了奇怪的事情。我使用它的方式：

```
char s[256];
int current=0;
for (int i=0; i<5; i++)
{
    current += sprintf(s+current, "d", i);
}

printf("string is %s \n", s); 
```

我得到的只是：字符串是 ddddd，如果我将 sprintf(s,"d", i) 更改为 "c" 或 "lf"，我得到的只是 ccccc 或 lflflflflf。有人对此有任何线索吗？非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T17:31:15.923

我认为您想使用 %d 而不是 d

见[man 3 printf](http://www.manpagez.com/man/3/printf/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T17:30:57.263

你应该`man printf`在命令行上查找。它会告诉你，你的格式字符串应该是“%d”

# sql-server-2008 - 在 SQL 中不使用任何变量即可获得结果

> ID：11692714
> 
> 赞同：0
> 
> 时间：2012-07-27T17:28:18.983
> 
> 标签：sql-server-2008

我有一个名为 JOBS 的数据库表，其中包含 ID、STATUS 和 COMPLETION_TIME 作为列。STATUS 0,1 成功，STATUS 2,3 失败，STATUS 4,5 被杀死。它只能有一种状态。我想找出过去 10 小时内成功、失败和终止的工作数量。我必须只使用 SELECT 进行查询，不能使用任何变量进行查询。我使用以下查询进行操作。

```
SELECT
(SELECT COUNT(*) 
WHERE STATUS IN (0,1))AS SuccessCount, 

(SELECT COUNT(*)
WHERE STATUS IN (2,3))AS FailedCount , 

(SELECT COUNT(*)
WHERE STATUS IN (4,5))AS KilledCount,

FROM JOBS 

WHERE COMPLETION_TIME >= (SELECT DATEDIFF(s, '1970-01-01 00:00:00', GETUTCDATE()) - (10 * 60 * 60))
AND COMPLETION_TIME <= (SELECT DATEDIFF(s, '1970-01-01 00:00:00', GETUTCDATE())); 
```

但是这个查询不起作用。它给了我成功、失败或被杀的工作，而不是他们的数量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T18:49:11.690

尝试这个：

```
select sum(case when status in (0, 1) then 1 else 0 end) as succeeded,
       sum(case when status in (2, 3) then 1 else 0 end) as failed,
       sum(case when status in (4, 5) then 1 else 0 end) as killed
from jobs
WHERE COMPLETION_TIME >= (SELECT DATEDIFF(s, '1970-01-01 00:00:00', GETUTCDATE()) - (10 * 60 * 60)) and
      COMPLETION_TIME <= (SELECT DATEDIFF(s, '1970-01-01 00:00:00', GETUTCDATE())); 
```

您的原始查询在语法上不正确。我看不到它是如何返回任何数据的，因为子查询：

```
(SELECT COUNT(*) WHERE STATUS IN (0,1)) 
```

没有“FROM”子句来定义变量状态。

# java - 在 AS400 上通过 Java 流式传输运行时进程执行（cobol obj）的结果时出现 MalformedInputException

> ID：11692715
> 
> 赞同：0
> 
> 时间：2012-07-27T17:28:21.167
> 
> 标签：java, encoding, ibm-midrange, cobol

我正在尝试通过 java 调用一个简单的 Hello World Cobol 程序。Java 代码在 IFS 文件结构中，cobol 对象存放在库中。我面临多个问题：

1.  流程执行返回的错误流不是可读格式。
2.  即使 cobol 代码的终止返回 0，我也会收到错误流结果。
3.  我在进程的输入流中看不到 cobol 输出结果。（如果我理解错误流，我可以解决这个问题）

cobol 代码在独立调用时起作用。我尝试过编码 UTF8、UTF16、Cp943 和默认值。当我使用 UTF8、UTF16 时，我得到 MalformedInputException，否则是一个垃圾值。

Java代码：（编译@ AS 400本身-java 1.5）

```
    导入java.io.*；

    公共类 CallCLPgm
    {
       公共静态无效主要（字符串 [] 参数）
       {
          尝试
          {
          Process theProcess = Runtime.getRuntime().exec("system CALL PROG6");
          //错误流
            BufferedReader inStream1 = new BufferedReader(new InputStreamReader
                     (theProcess.getErrorStream(),"UTF8"));
             System.out.println(inStream1.readLine());
            inStream1.close();
          //输入流   
             BufferedReader inStream = new BufferedReader(new InputStreamReader
                     (theProcess.getInputStream()));
             System.out.println(inStream.readLine());
             inStream.close();

             System.out.println("终止："+theProcess.waitFor());

```

```
 //Cobol code
      PROCEDURE DIVISION.        
      PROGRAM-BEGIN.     
          DISPLAY "Hello World".   
          STOP RUN. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T18:02:34.413

我应该专注于 IBM 编码格式 [http://publib.boulder.ibm.com/html/as400/v4r5/ic2924/index.htm?info/java/rzaha/fileenc.htm](http://publib.boulder.ibm.com/html/as400/v4r5/ic2924/index.htm?info/java/rzaha/fileenc.htm)

我在美国使用“Cp037”而不是 UTF8 和其他格式。

BufferedReader inStream1 = new BufferedReader(new InputStreamReader (theProcess.getErrorStream(),"Cp037"));

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T18:07:19.073

我不是 Cobol 程序员，但我认为 Cobol 动词 DISPLAY 不会写入标准输出。检查 Cobol 手册，但我猜你需要在 Cobol 程序中实际打开 stdout 并写入它而不是使用 DISPLAY。

当我想在 IBM i 上调用程序时，我使用[JTOpen IBM Toolbox for Java](http://jt400.sourceforge.net/)。如果您不熟悉[IBM Infocenter](http://publib.boulder.ibm.com/infocenter/iseries/v7r1m0/index.jsp?topic=/rzahh/page1.htm)，可能很难找到[Javadoc](http://publib.boulder.ibm.com/infocenter/iseries/v7r1m0/index.jsp?topic=/rzahh/javadoc/overview-summary.html)。

# php - curl 到 google 时的 invalid_request 响应

> ID：11692720
> 
> 赞同：0
> 
> 时间：2012-07-27T17:28:36.200
> 
> 标签：php, curl

我正在编写以下代码来获取授权令牌。

将授权分配给代码变量

```
$code =  $this->request->query['code']; 
```

我已删除我的客户密码以发布问题。

```
$clientSecret = ""; 
```

初始化卷曲

```
 $ch = curl_init();
        $header[]         = "Content-Type: application/x-www-form-urlencoded";

        curl_setopt($ch, CURLOPT_HTTPHEADER,     $header);
        curl_setopt($ch, CURLOPT_POST,        true);
        curl_setopt($ch, CURLOPT_POSTFIELDS, urlencode("code=".$code."&
                client_id=289710071999.apps.googleusercontent.com&
                client_secret=".$clientSecret."&
                redirect_uri=http://budzzflorist.localhost.com/users/google&
                grant_type=authorization_code"));
        curl_setopt($ch, CURLOPT_URL, "https://accounts.google.com/o/oauth2/token");
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        $request_result = curl_exec($ch);
        print_r(curl_getinfo($ch));
        echo "\n\ncURL error number:" .curl_errno($ch); // print error info
        echo "\n\ncURL error:" . curl_error($ch);
        var_dump( json_decode($request_result,true)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:39:14.870

你的电话`urlencode`是错误的。事实上，它实际上是对整个 post 参数字符串进行编码，只有值（而不是键）应该是 URL 编码的。

此外，您应该考虑使用以下行而不是您的行，因为 cURL 会自动为您对所有内容进行 URL 编码：

```
curl_setopt($ch, CURLOPT_POSTFIELDS, array(
  'code' => $code,
  'client_id' => $clientId,
  'client_secret' => $clientSecret,
  'redirect_uri' => 'http://example.org',
  'grant_type' => 'authorization_code'
)); 
```

**更新：**这对我有用：

**请求令牌**

```
curl_setopt_array($ch, array(
  CURLOPT_POST => false,
  CURLOPT_POSTFIELDS => array(
    'response_type' => 'code',
    'client_id' => $clientId,
    'redirect_uri' => 'http://example.org/auth/google/callback',
    'scope' => 'https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile'
  ),
  CURLOPT_URL => 'https://accounts.google.com/o/oauth2/auth',
  CURLOPT_SSL_VERIFYPEER => false,
  CURLOPT_RETURNTRANSFER => true
));

$request_result = curl_exec($ch); 
```

**打回来**

```
curl_setopt_array($ch, array(
  CURLOPT_POST => true,
  CURLOPT_POSTFIELDS => array(
    'code' => $code,
    'client_id' => $clientId,
    'client_secret' => $clientSecret,
    'redirect_uri' => 'http://example.org',
    'grant_type' => 'authorization_code'
  ),
  CURLOPT_URL => 'https://accounts.google.com/o/oauth2/token',
  CURLOPT_SSL_VERIFYPEER => false,
  CURLOPT_RETURNTRANSFER => true
));

$request_result = curl_exec($ch); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T18:07:51.663

看起来谷歌希望表单是`application/x-www-urlencoded`.

试试这个：

```
$ch           = curl_init();
$code         = '123';
$clientSecret = '45686';

$postFields = array('code'          => $code,
                    'client_id'     => '289710071999.apps.googleusercontent.com',
                    'client_secret' => $clientSecret,
                    'redirect_uri'  => 'http://budzzflorist.localhost.com/users/google',
                    'grant_type'    => 'authorization_code');

curl_setopt($ch, CURLOPT_POST,        true);
curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($postFields));
curl_setopt($ch, CURLOPT_URL, "https://accounts.google.com/o/oauth2/token");
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$request_result = curl_exec($ch);

var_dump( json_decode($request_result,true)); 
```

结果：`invalid_client`因为我的令牌不正确，但不是`invalid_request`.

如果您将数组传递给`CURLOPT_POSTFIELDS`，cURL 将强制内容类型为`multipart/form-data`导致无效请求的原因。而是使用[`http_build_query`](http://php.net/http_build_query)which 从基于键值对的数组中创建一个 url 编码的查询字符串。然后将结果传递给`CURLOPT_POSTFIELDS`.

# arrays - CakePHP 选择输入：是否可以设置显示成员和值成员？

> ID：11692728
> 
> 赞同：0
> 
> 时间：2012-07-27T17:29:00.457
> 
> 标签：arrays, cakephp, select, input

我有这个表单输入：

```
echo $this->Form->input('category_id',array('label'=>'Cat&eacute;gorie','type'=>"select",'options'=>$categories,'empty'=>false)); 
```

现在， $category 填充了这些信息：

```
Array
(
[0] => Array
    (
        [categories] => Array
            (
                [id] => 1
                [nom] => Autre
            )

    )

[1] => Array
    (
        [categories] => Array
            (
                [id] => 2
                [nom] => Véhicule
            )

    )

[2] => Array
    (
        [categories] => Array
            (
                [id] => 3
                [nom] => Audio/video
            )

    )

) 
```

我希望 Select 输入仅显示“nom”字段（名称），但它会在提交表单时发送 ID。在 CakePHP 中可能吗？我已经在 Google 和 CakePHP 的文档和论坛中爬行了一段时间，但没有成功：-/

提前谢谢你们，祝你们有美好的一天！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:36:02.627

Cakephp 使用一维数组来选择选项。您将您的 id 作为键和 nom 作为选项标签的文本更改为单维，然后将其传递给选项键：

```
$categories = Set::combine($categories,'{n}.categories.id','{n}.categories.nom'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:38:10.040

你应该尊重 Cakephp 的约定。在你的数据库中用“name”替换“nom”，如果你的关联做得很好，cakephp 会自动完成。

# bash - egrep 结果到 vim 作为行引用的文件列表

> ID：11692730
> 
> 赞同：5
> 
> 时间：2012-07-27T17:29:08.047
> 
> 标签：bash, shell, vim, grep

在 shell 中，我使用以下函数创建文件列表并将其传递给 vim。

感觉不错，但是我丢失了行参考，我以正确的顺序打开文件，但是当光标从第一行开始时，我必须再次搜索文本。

~/.bashrc 上的实际功能

```
function vimgrep(){
   vim `grep -IR "$1" * | awk -F: '$1!=f{print ""$1"";f=$1}' | grep -v 'Test\|test'` +ls
}

function vimgrep2(){
   vim `grep -IR "$1" * | awk -F: '$1!=f{print ""$1"";f=$1}' ` +ls
} 
```

Obs.: filelist 必须来自 shell 到 vim，然后它必须保留缓冲文件的行引用，就像 :make 捕获任何错误时的结果一样（但没有底部窗口 [:cwindow]）。

编辑：好的...不是那么优雅，但我可以将搜索到的字符串作为 +/"$1" 传递给 vim，例如：

```
 vim `grep -IR "$1" * | awk -F: '$1!=f{print ""$1"";f=$1}' ` +/"$1" 
```

如果脚本不使用临时文件会更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T18:54:29.297

### 使用带有外部 Grep 的行号

据我所知，不能使用行号选项标志一次打开多个文件，因为 Vim 只会将该标志应用于列表中的第一个文件。手册页说：

> ```
>  +[num]      For the first file the cursor will be positioned on line  
>              "num". If "num" is missing, the cursor will be positioned
>              on the last line. 
> ```

因此，您可以一次对每个文件调用一个函数，或者将函数调用放在一个循环中，该循环一次对两个位置参数（文件名和正则表达式）进行操作。前者当然更容易。例如：

```
vimgrep () {
    local file="$1"
    shift || return 1
    vim +$(egrep -n "$1" "$file" | cut -d: -f1) "$file"
}

# Sample function call.
vimgrep /etc/password '^www-data' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T12:04:37.883

这里有一些功能可以为您提供您想要的功能。它将打开缓冲区中的每个文件，并将行设置为与给定正则表达式匹配的第一行。

我倾向于喜欢这样简短的描述性 bash 函数，因为 bash 在不使用大量代码块的情况下很难理解。

唯一的缺陷是它不能有效地过滤掉二进制文件。该功能的更新`find_nonbinary`将解决此问题。

**这些是辅助函数。它们不能直接运行。**

```
# Using print0 to handle files with weird names.
# This is just a quick placeholder.
# You can play with this to get better results.
function __find_nonbinary() {
    find -type f -print0
}

function __generate_vim_cmds() {
    xargs -0 awk -v regex="$regex" \
        '$0 ~ regex {printf "e +%s %s\n", FNR, FILENAME; nextfile}'
}

function __combine_vim_cmds() {
    declare -a vim_cmds

    while read line; do
        vim_cmds+=( " $line " )
    done

    # Force subshell to prevent IFS from being clobbered.
    (
        IFS="|"
        echo "${vim_cmds[*]}"
    )
} 
```

这是要使用的实际功能。

```
function vimgrep() {
    local regex="$1"

    if [[ -z "$regex" ]]; then
        echo "Usage: $0 regex" 1>&2
        exit 1
    fi

    local vim_cmds=$(
        __find_nonbinary    |
        __generate_vim_cmds |
        __combine_vim_cmds
    )

    if [[ -z "$vim_cmds" ]]; then
        echo "No files matching $regex found." 1>&2
        exit 1
    fi

    vim -c "$vim_cmds"
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T16:36:03.010

`cn`有了这个，你可以通过, `cp`, `cc`..等在比赛之间移动：

```
function vimgrep(){
   vim -c "exec(\"grep $1 *\")"
} 
```

突出显示：

```
function vimgrep(){
   vim -c "exec(\"grep -IR $1 *\")" -c "let @/='$1'" -c "set hls"
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-30T20:51:25.923

*免责声明：*我对此一无所知`vim`

手册页带有一个参数，例如`+<line no>`它将跳转到所提供文件的该行。根据这些信息，我编写了这个脚本。它依赖于如下命令行来启动 vim：

```
$ vim +n1 file1 +n2 file2 
```

你也可以把它作为一个shell函数放在你的`'~/.bashrc`，因为它很小。

**用法：** `vimgrep -e <search pattern> <fileglob>`

搜索模式可以是任何可以理解的正则表达式`grep`，文件 glob 是可以理解的 shell glob `bash`。

```
#!/bin/bash

# set -o xtrace # uncomment to debug

# declare variables
declare -a grepopts files

[[ $1 =~ -e$ ]] && grepopts+=("-e") && grepopts+=("$2") && shift 2

files=("${@}")

vim $(egrep -n -m1 -H "${grepopts[@]}" "${files[@]}" | \
        sed -e 's/^\(.\+\):\([0-9]\+\):.\+$/+\2 \1/') 
```

**警告：**`:`如果文件名中包含字符，此脚本将失败。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-31T12:46:49.767

Vim 还附带了一个`vimgrep`你可以使用的命令

```
function vimgrep() {
    local regex="$1"

    if [[ -z "$regex" ]]; then
        echo "Usage: $0 regex" 1>&2
        exit 1
    fi

    vim -c "vimgrep /$regex/ **"
} 
```

小心在其下有很多文件的目录中运行它。

# iphone - iOS - 帮助我了解多个目标和应用内升级/购买

> ID：11692736
> 
> 赞同：0
> 
> 时间：2012-07-27T17:29:26.580
> 
> 标签：iphone, ios, in-app-purchase, target, storekit

好吧，伙计们，请放轻松。多年来，我一直在玩这个板，并得到了很多帮助，我什至无法开始思考没有它我会在哪里。所以感谢多年来的帮助！

我有一个典型的场景：免费应用程序和付费应用程序。一年前我发布了我的免费版本，最近才发布了我的付费版本。我的目标是通过升级到付费版本的能力来更新我的免费版本。在对此进行研究之后，似乎我最好的选择是构建 2 个目标，然后使用 #ifdef 打开和关闭我想要限制的某些功能。

所以我继续复制我的付费目标，进行所有需要的 plist 更改并输入这样的代码......

```
#ifdef LITE_VERSION
    NSLog(@"Lite Version");
    [self loadAds];  
#endif 
```

这很好用，我现在有一个带有广告的 Lite 目标和一个没有广告的付费目标。（当然还有其他一些功能）

但现在我有点困惑从这里去哪里。
我是否使用 StoreKit 将升级按钮链接到我的付费版本？如果是这样，怎么做？
还是有更好的方法来实现这一点？

我知道已经提出并回答了类似的问题，但它们似乎都涵盖了编程部分，但没有涵盖除此之外的内容。

谢谢梅林

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-31T16:11:17.623

`#define`在编译时工作，因此如果您想要一个代码库来创建应用程序的单独版本 - 例如带有广告或有限功能的“免费”版本，以及完整的“付费”版本，它会很有用。

添加方法如下：

*   在您的项目中创建一个附加目标（这将是“免费”版本）
*   在免费应用程序的编译选项中，在**Other C Flags**下，添加`-DFREE_VERSION`
*   与您最初的问题一样，使用定义来控制免费/付费版本中的内容。

```
#ifdef FREE_VERSION
[self showAds];
#endif 
```

注意：要使用户能够在运行时购买/解锁功能（例如使用 StoreKit），您不能使用该`#define`技术。

# c - findnext() 函数调用在第二次调用时失败。程序崩溃

> ID：11692739
> 
> 赞同：1
> 
> 时间：2012-07-27T17:29:49.210
> 
> 标签：c, msvcrt

第二次调用时该`_findnext()`函数不起作用。这是代码。

```
int main() {
    struct _finddata_t ffblk;
    intptr_t done;

    chdir("tmp");
    printf("Directory changed to dir successfully\n");

    done=_findfirst("*.txt",&ffblk);
    printf("Call to findfirst successful\n");
    printf("%s\n",ffblk.name);
    do{
        done=_findnext(done,&ffblk);
        printf("%s\n",ffblk.name);
    } while(!done);
    printf("Exited the main loop\n");
    getch();
} 
```

程序一旦获取并打印文件夹中前两个文件的名称就会崩溃`tmp`。打印的第一个文件名来自`findfirst()`函数。下一个文件名由 打印`findnext()`。我已经通过调试检查过。

现在当`findnext()`在循环中第二次调用时，程序崩溃了。我正在使用 gcc 并尝试了大多数返回值的东西，但没有成功。有任何想法吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:36:00.323

您的问题是您无法将值分配`_findnext`给您的句柄，您需要两个变量：

```
intptr_t handle = 0;
int done = 0;

handle = _findfirst("*.txt",&ffblk);
while(handle && done != -1)
{
    printf("%s\n",ffblk.name);
    done = _findnext(handle,&ffblk);
} 
```

# build - 使用带有 Ext.Loader 的 Sencha Touch 2 构建应用程序时出错

> ID：11692740
> 
> 赞同：0
> 
> 时间：2012-07-27T17:30:09.523
> 
> 标签：build, sencha-touch-2

我有这个错误：

```
GET http://localhost/ejemplo/build/production/src/log/Logger.js?_dc=1343409099716 404 (Not Found) Logger.js:1
Uncaught Error: [Ext.Loader] Failed loading 'src/log/Logger.js', please verify that the file exists 
```

我读了几个线程，这个问题的解决方案是编辑 app.json。但是我已经将我的“buildOptions”配置到 app.json

我有这个：

```
 /**
     * Build options
     */
    "buildOptions": {
        "product": "touch",
        "minVersion": 3,
        "debug": false,
//        "logger": "no"
        "logger": false
    } 
```

但是当我尝试从我的浏览器访问时我仍然有同样的错误`http://localhost/myProject/build/production/`，虽然我创建了一个快速简单的应用程序来查看我是否可以构建另一个应用程序并且我没有这些错误，

我只有在我的真实项目（重要的事情）中才有这个错误，从我的浏览器控制台向我显示：

```
Document was loaded from Application Cache with manifest http://localhost/ejemplo/build/production/cache.manifest
Application Cache Checking event
Application Cache NoUpdate event
GET http://localhost/ejemplo/build/production/src/log/Logger.js?_dc=1343409099716 404 (Not Found) Logger.js:1
Uncaught Error: [Ext.Loader] Failed loading 'src/log/Logger.js', please verify that the file exists 
```

最近给我看这个：

```
Document was loaded from Application Cache with manifest http://localhost/myMoney/build/production/cache.manifest
Application Cache Checking event
Application Cache Downloading event
Application Cache Progress event (0 of 2) http://localhost/myMoney/build/production/index.html
Application Cache Progress event (1 of 2) http://localhost/myMoney/build/production/
Application Cache Progress event (2 of 2) 
Application Cache UpdateReady event
Failed to load resource: the server responded with a status of 404 (Not Found) http://localhost/myMoney/build/production/src/log/Logger.js?_dc=1343959487711
Uncaught Error: [Ext.Loader] Failed loading 'src/log/Logger.js', please verify that the file exists /myMoney/build/production/:1 
```

**重要提示：** 我尝试`http://localhost/myProject/build/production/`在我的网络浏览器中加载并出现错误（如果我加载`http://localhost/myProject/`应用程序成功加载）。要么我无法以本地红色从我的 iPhone 访问，在我的 iPhone 中只能看到加载动画等等。

提前致谢。

为了说明问题，请参阅此图片：

当我建立：

[http://www.mediafire.com/?8owcezy2wkh3oh8](http://www.mediafire.com/?8owcezy2wkh3oh8)

当我尝试访问`http://localhost/myProject/build/production/`：

[http://www.mediafire.com/view/?i441n3o9n4bi10e](http://www.mediafire.com/view/?i441n3o9n4bi10e)

**PD：我的应用程序有一个指向 PHP 的链接，我必须为这些过程做些什么吗？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T17:39:48.380

每当出现记录器错误时，通常是因为 app.json 文件中的一个众所周知的错误。我认为这在最近的版本（2.0.1.1+）中已修复，但我并不积极。

当您第一次创建项目时，app.json 文件包含这样的 buildOptions

```
"buildOptions": {
        "product": "touch",
        "minVersion": 3,
        "debug": false,
        "logger": "no"
    }, 
```

记录器行需要更改..

```
"buildOptions": {
        "product": "touch",
        "minVersion": 3,
        "debug": false,
        "logger": "false"
    }, 
```

重要的是 false 在引号中，这是一个字符串而不是布尔数据类型。

```
"logger": "false" 
```

仔细检查您的 app.json 文件。

如果您没有最新版本的 touch，您应该升级。通过在浏览器的调试控制台中键入以下命令来检查您的版本（萤火虫或其他东西）

```
Ext.version.version 
```

最新的稳定版本是 2.0.1.1。通过下载版本并导航到终端中的新版本文件夹并键入以下命令来升级到此版本

```
sencha app upgrade -p c:\wamp\www\myMoney 
```

这应该在您的应用程序目录中创建一个新的 sdk 文件夹，并将您的旧文件夹重命名为 sdk 存档

# jquery - 循环通过json里面的json

> ID：11692743
> 
> 赞同：0
> 
> 时间：2012-07-27T17:30:34.920
> 
> 标签：jquery, json

我有一个 json 集合，在每个项目中我都有其他集合：

我走在第一个 json 项目中：

```
$.each(data, function (index, element) {
    var tmp = $('#itemBusca').html();
    $('#buscas').append(_.template(tmp, element));
});

[{
    "Codigo": "692547",
    "Afiliacao": "RS",
    "Nome": "155 HOTEL",
    "Provincia": "BRSAO",
    "NomeProvincia": "SAO PAULO",
    "Categoria": "3",
    "DataEntrada": "20120728",
    "DataSaida": "20120730",
    "Marca": null,
    "Endereco": "RUA MARTINHO PRADO, 173",
    "Descricao": "O 155 Hotel trabalha com o conceito de Low Cost de hotel econômico, oferecendo praticidade e comodidade a um baixo custo. Nosso Hotel está instalado no bairro Consolação, num dos melhores pontos do centro da cidade de São Paulo, pois está cercado por ótimas opções gastronômicas e da Avenida Augusta, além de fácil acesso para shoppings, aeroportos, teatros, cinemas, roteiros de compras e a poucos metros do metrô Anhangabaú. Além de oferecer aos seus hóspedes um espaço incomparável em São Paulo, o Hotel 155 busca através de novas tecnologias de inteligência ambiental manter-se como uma instituição sustentável com o reuso das águas da chuva e também sistema economizador de energia. Juntos estes fatores permitem  o 155 a ser um hotel econômico, oferecendo um preço justo aos visitantes da cidade de São Paulo.\r\nOs hóspedes do hotel poderão contar com serviço de Concierge para orientação e apoio e internet central gratuita. Na área de convenções serão duas salas de reuniões para pequenos e médios eventos, além de serviço ágil e prático.\r\n\r\n",
    "Thumbnail": "http://hoteles.internos.hotusa.com/upload/hoteles/web/thum/692547.jpg",
    "Foto": "http://www.hotelresb2b.com/images/hoteles/264280_fotpe1_FACHADA.jpg",
    "Latitude": "-23.550278",
    "Longitude": "-46.645846",
    "Tarifas": [{
        "CodigoQuarto": "SG",
        "Descricao": "Individual",
        "CodigoRefeicao": "BB",
        "Preco": "267.84",
        "Moeda": "DO",
        "Disponibilidade": "OK",
        "Linhas": ["SG#2#VR#133.92#0#BB#OK#20120728#20120729#DO#1-0#0#0#0#", "SG#2#VR#133.92#0#BB#OK#20120729#20120730#DO#1-0#0#0#0#"]
    }, {
        "CodigoQuarto": "DU",
        "Descricao": "Dobleuso (para 1 pers)",
        "CodigoRefeicao": "BB",
        "Preco": "267.84",
        "Moeda": "DO",
        "Disponibilidade": "OK",
        "Linhas": ["DU#2#VR#133.92#0#BB#OK#20120728#20120729#DO#1-0#0#0#0#", "DU#2#VR#133.92#0#BB#OK#20120729#20120730#DO#1-0#0#0#0#"]
    }]
}] 
```

我需要走进一个存在于实际项目中的集合。

我该怎么做？

此致，

弥尔顿

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:48:18.343

假设您要遍历 JSON 数据中的所有 Tarifas。您可以使用 JSON.Parse，假设数据是 JSON 对象。

```
 var items = JSON.parse(data);
    if (items != null || !($.isEmptyObject(items))) {

        var firstLevel;
        var i;
        var cnt = items.length;

        for (i = 0; i < cnt; i++) {

            firstLevel = items[i];

            if (firstLevel) {

                var tarifas = firstLevel.Tarifas;
                var x;
                var xcnt = tarifas.length;
                for (x = 0; x < xcnt; x++) {
                    var currentTarifas = tarifas[x];
                    if (currentTarifas) {
                        if (currentTarifas.CodigoQuarto == "SG") {

                            // do some stuff, you can alert all the current tarifas properties if you want
                            alert(currentTarifas.CodigoRefeicao);
                            alert(currentTarifas.Moeda);
                        }

                    }
                }
            }

        }

    } 
```

假设我了解执行此操作的 jquery 方式，这应该可以

```
 $.each(data, function (i, element) {
        var tmp = $('#itemBusca').html();
        $('#buscas').append(_.template(tmp, element));

        $.each(element.Tarifas, function (x, tarifas) {
            alert(tarifas.CodigoQuarto);
        });
    }); 
```

# jquery - JsLint超出范围警告ajax错误处理

> ID：11692744
> 
> 赞同：0
> 
> 时间：2012-07-27T17:30:41.787
> 
> 标签：jquery, ajax, error-handling

我正在运行一个混合的 PHP / jQuery AJAX 函数，并希望在开始处理数据之前检查格式错误的 JSON。使用下面的代码，我得到解析的 JSON 的“超出范围”错误。但是，如果我将它移到块上方`try`，那么我不知道在里面放什么`try`

```
 jQuery.post(ajaxurl, data, function(response) {
        try {
            var obj = jQuery.parseJSON(response);
        }
        catch(e) {
            // error catch, malformed JSON
        }

        if(obj.success === true) {
            // do something
        }
        else {
            // do something else
        }
    }); 
```

我完全愿意接受更好的处理方法的想法，但是`obj`我需要执行许多不同的检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:32:09.887

您应该在外部*声明*变量`try`，但在内部分配它。

```
 var obj;
    try {
        obj = jQuery.parseJSON(response);
    }
    catch(e) {
        // error catch, malformed JSON
    } 
```

# asp.net - 鼠标悬停手形图标不显示

> ID：11692747
> 
> 赞同：3
> 
> 时间：2012-07-27T17:30:57.917
> 
> 标签：asp.net, onmouseover, onmouseout

我有一个网格视图：

```
 <asp:GridView ID="gvwProd" runat="server" CssClass="gridview" ShowHeaderWhenEmpty="true"
                                        AllowPaging="true" BackColor="ButtonFace" OnRowDataBound="gvwProd_OnRowDataBound"
                                        OnRowCreated="gvwProd_RowCreated" OnSorting="gvw_OnSorting" AllowSorting="true"
                                        AutoGenerateColumns="false" ShowFooter="false"> 
```

我正在尝试为每一行的特定单元格设置手悬停图标：

```
protected void gvwProd_OnRowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        e.Row.Cells[2].Attributes.Add("onmouseover", "document.body.style.cursor='hand'");
        e.Row.Cells[2].Attributes.Add("onmouseout", "document.body.style.cursor='auto'");
    }
} 
```

onmousover 和 onmouseout 事件出现在标记中：

```
 <td onmouseover="document.body.style.cursor=&#39;hand&#39;" onmouseout="document.body.style.cursor=&#39;auto&#39;" style="white-space:nowrap;">05-07-2012</td> 
```

然而，手上没有可见的痕迹，似乎也没有发生任何事情。我究竟做错了什么？使用 IE 8

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T17:38:39.177

第一：`cursor: pointer`不使用`cursor: hand`（如果您希望它在多个浏览器中工作）

第二：而不是使用`document.body` 我会使用`this`：

```
e.Row.Cells[2].Attributes.Add("onmouseover", "this.style.cursor='pointer'"); 
```

因为您希望光标悬停在单元格上。

# google-bigquery - 2 小时后 2MM 行加载作业失败，但未生成有用的错误消息

> ID：11692750
> 
> 赞同：1
> 
> 时间：2012-07-27T17:31:08.760
> 
> 标签：google-bigquery

这是我的加载作业的屏幕截图。它说“意外。请再试一次。” 没有任何额外的信息。有什么方法可以获取更多细节吗？或者谷歌的某个人可以仔细查看日志并告诉我为什么它失败了？

bq 显示：

工作 tzgqnxt:job_016afefcfc0a42089822d621cf3d6ace

作业类型 状态 开始时间 持续时间 已处理字节数

* * *

加载失败 27 Jul 10:32:05 2:00:09

作业执行期间遇到的错误。意外。请再试一次。

![截屏](../Images/fe2c1d5a17dba7a8b145900e29bcf7ab.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T07:05:08.227

你`bq`安装了吗？如果是这样，您可以尝试致电`bq show -j <that job id>`以查看是否有任何其他信息。

请注意，如果您遇到超时问题，您可以通过将文件分成几个块并执行多个导入来解决它，所有这些都具有相同的目标表。最终结果将是相同的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T17:35:25.170

鉴于此作业几乎在 2 小时内被终止，您似乎达到了导入和导出作业的两小时限制。不过，这项工作可能不应该花费 2 多个小时——我查看了工作日志，看起来我们在 CSV 大约 550 万行时遇到了一些问题。你有没有机会给我（tigani@google.com）对谷歌存储中文件的读取权限，以便我可以进一步调试？

# sql-server - SQL Service Broker -- 一个中央 SQL 和多个附属 SQL

> ID：11692754
> 
> 赞同：4
> 
> 时间：2012-07-27T17:31:21.540
> 
> 标签：sql-server, service-broker

该系统由一台中央 SQL 服务器和两台或多台卫星服务器组成。卫星服务器收集测量数据并将其发送到中央服务器。看图片： ![在此处输入图像描述](../Images/4a0bc9629b7e0314adeac0b1d3e3076d.png)

（图片取自官方的[Service Broker Communication Protocols](http://msdn.microsoft.com/en-us/library/ms166061%28v=sql.105%29.aspx)文章并进行了修改。）

我需要使添加另一个卫星 SQL 的行为尽可能简单。我的意思是，设置新添加的卫星 SQL 可能与其他卫星 SQL 机器的设置相同。有可能吗？

所有 SQL 服务器都位于同一个域中，不需要基于证书的加密——至少现在不需要。部署的简易性和速度是现在的首要任务。后期可以提高安全性。

换句话说，卫星 SQL 是否可以使用相同的消息类型、相同的合约创建代码、相同的端点设置、......

我对路由和目标绑定有点困惑。你能对此发表评论吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-28T21:01:38.983

最简单的部署是以下配置：

1.  到处使用相同的消息类型和合同。这在任何情况下都是必须的，所以这是不言而喻的。
2.  不要使用[对话安全](http://msdn.microsoft.com/en-us/library/ms166036%28v=sql.105%29.aspx)。简直`GRANT SEND ON SERVICE::[<servicename>] TO [public]`无处不在。这消除了对数据库证书和远程服务绑定的需要。
3.  *为端点使用证书，但不要交换它们（导出、导入、创建登录等）*。*有一个技巧：*即使不交换证书*`GRANT CONNECT ON ENDPOINT::[<brokerendpointname>] TO [public]`，也允许两个端点使用 SSL（证书）进行连接。*
***   使用传输路由（意味着启用特殊路由并使用约定`TRANSPORT`命名您的服务。`[tcp://hostname:port/servicename]`**

 **让我解释一下为什么我推荐这个设置：

*   删除对话安全性将部署简化了 10 倍。对话安全性允许服务对每条消息的发送者进行身份验证和自动化，但在相对受控的环境（内联网）中，您可以基于信任进行部署：服务接收到的*任何*消息都被信任来自授权的发送者。
*   为端点使用证书通常被认为很复杂，因为需要交换证书以允许连接，但是在`public`代理端点上授予连接的技巧消除了交换证书的要求。所有使用此技巧的机器都可以在*没有任何先前设置*的情况下相互通信，这甚至比在端点上使用 Windows 身份验证更好（需要授予连接到`domain\machine$`ro 需要使用特定域帐户部署 SQL Server 实例）。同样，您失去了对连接说“不”的能力，您将接受来自Intranet 中*任何SQL 实例的连接。*
*   使用 TRANSPORT 路由，任何加入“party”的 SQL Server 实例都准备好了：因为服务名包含主机名，所有其他机器已经*知道*如何与这台机器通信，并且不需要添加显式路由。

这种配置真的很接近“即插即用”。新机器可以立即加入与任何现有 SQL Server SSB 服务的通信，*而无需对其他现有机器进行任何配置更改*。

以下是如何为此类部署配置机器的示例。假设您想首先在以下位置部署中​​央服务器`MACHINE1`：

```
use master;
go

create database master key...
create certificate [MACHINE1] with subject 'MACHINE1';
create endpoint BROKER as tcp (listener_port 4022) for service_broker 
  (authentication certificate [MACHINE1]);
grant connect on endpoint::BROKER to [public];
go

use db1;
create message type...
create contract ...
create queue ...
create service [tcp://MACHINE1:4022/CentralService] 
   on ...
   ([...]);
grant send on service::[tcp://MACHINE1:4022/CentralService] to [public];
create route transport with address = 'TRANSPORT';
go 
```

而已。现在让广告一个节点，比如在主机 MACHINE2 上：

```
use master;
go

create database master key...
create certificate [MACHINE2] with subject 'MACHINE2';
create endpoint BROKER as tcp (listener_port 4022) for service_broker 
  (authentication certificate [MACHINE2]);
grant connect on endpoint::BROKER to [public];
go

use db2;
create message type...
create contract ...
create queue ...
create service [tcp://MACHINE2:4022/Satellite] 
   on ...
   ([...]);
grant send on service::[tcp://MACHINE2:4022/Satellite] to [public];
create route transport with address = 'TRANSPORT';
go 
```

而已。现在发生了两件事：

*   因为 MACHINE1 和 MACHINE2 上的两个端点都使用基于证书的身份验证并已授予连接到公共的权限，所以它们可以*按原样*连接和交换消息，而无需交换（导出和导入）它们的端点证书
*   因为两个数据库都创建了特殊的 TRANSPORT 路由，并且服务名称具有特殊的`[tcp://machine:port/service]`语法，所以两个服务可以立即*按原样*交换消息，而无需任何显式路由。

最好的是如何添加一个新节点，比如 MACHINE3：

```
use master;
go

create database master key...
create certificate [MACHINE3] with subject 'MACHINE3';
create endpoint BROKER as tcp (listener_port 4022) for service_broker 
  (authentication certificate [MACHINE3]);
grant connect on endpoint::BROKER to [public];
go

use db2;
create message type...
create contract ...
create queue ...
create service [tcp://MACHINE3:4022/Satellite] 
   on ...
   ([...]);
grant send on service::[tcp://MACHINE3:4022/Satellite] to [public];
create route transport with address = 'TRANSPORT';
go 
```

现在，*忽略对 MACHINE1 或 MACHINE2*的任何单个更改，新节点 MACHINE3 可以与中央服务交换消息，如果需要，实际上也可以与 MACHINE2 的卫星交换消息。端点接受*任何人*连接，因此欢迎使用 MACHINE3，并且使用的服务名称由特殊的 TRANSPORT 路由机制自动路由。这就是这种配置的美妙之处，即插即用：添加一个新节点需要其他节点上的 0 配置。

那么给了什么？最大的问题是安全性。任何员工都可以在其桌面上下载 SQL Server Express，设置未经授权的 Satellite 节点并开始与 Central 服务交换消息。真的没有什么可以阻止他，你已经明确地打开了所有的大门。一个更微妙的问题是服务何时*移动*。当服务`[tcp://MACHINE3:4022/Satellite]`被移动（例如，通过数据库备份/恢复）时`MACHINE4`，服务的名称仍然是有效的 TRANSPORT 路由语法名称，但*不正确*。根据保留现有对话的重要性，您可以选择取消服务并创建一个新服务，命名为`[tcp://MACHINE4:4022/Satellite]`派对（您不能*重命名*服务，您必须删除并创建一个新服务）。*如果*维护现有对话至关重要，那么有一些变通方法，因为在中央服务数据库上为其添加*显式*路由将优先于最后的 TRANSPORT 路由，并且消息将被正确重定向。重要的是*有*解决方案:)**

# objective-c - Core Data expressionForFunction:@"max:" with setPropertiesToGroupBy 给出错误

> ID：11692757
> 
> 赞同：2
> 
> 时间：2012-07-27T17:31:39.777
> 
> 标签：objective-c, ios, core-data

我收到一个错误（iOS）：由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“使用 GROUP BY 组件的查询中的 SELECT 子句只能包含在 GROUP BY 或聚合函数中命名的属性（logtijd 不在 GROUP BY 中） )'

在下面的代码中，我错过了什么吗？我使用 max: 聚合函数，所以我会得到这个错误吗？“logtijd” - 核心数据日期 (NSDate)。

max: 功能是否适用于 iOS？请参阅此链接： [https](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSExpression_Class/Reference/NSExpression.html#//apple_ref/occ/clm/NSExpression/expressionForFunction:arguments) ://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSExpression_Class/Reference/NSExpression.html#//apple_ref/occ/clm/NSExpression/expressionForFunction:arguments ：

聚合函数 @"average" 有效！

```
 NSFetchRequest *request = [[NSFetchRequest alloc] init];

    [request setEntity:[NSEntityDescription entityForName:@"Tijden" inManagedObjectContext:self.context]];

NSExpression *keyPathExpression = [NSExpression expressionForKeyPath:@"logtijd"];    
NSExpression *maxExpression = [NSExpression expressionForFunction:@"max:" arguments:[NSArray arrayWithObject:keyPathExpression]];

NSExpressionDescription *expressionDescription = [[NSExpressionDescription alloc] init];

[expressionDescription setName:@"maxlogtijd"];
[expressionDescription setExpression:maxExpression];
[expressionDescription setExpressionResultType:NSDateAttributeType];

    [request setResultType:NSDictionaryResultType];
[request setPropertiesToFetch:[NSArray arrayWithObjects:@"starttijd", expressionDescription, nil]];
    [request setPropertiesToGroupBy:[NSArray arrayWithObject:@"starttijd"]];
    [request setPredicate:[NSPredicate predicateWithFormat:@"atleet == %@ AND workout == %@", self.atleetGeselecteerd, self.workoutGeselecteerd]];

    return [self.context executeFetchRequest:request error:nil]; 
```

# icons - Eclipse RCP 导出窗口品牌：图标 (ico) 仅适用于低分辨率

> ID：11692758
> 
> 赞同：3
> 
> 时间：2012-07-27T17:31:40.260
> 
> 标签：icons, eclipse-rcp, branding

我正在尝试为我的 RCP 应用程序打上烙印。对于 Windows，我创建了以下 ico 文件：

[http://data.icg.tugraz.at/caleydo/download/2.0.2/caleydo.ico](http://data.icg.tugraz.at/caleydo/download/2.0.2/caleydo.ico)

它包含 Eclipse 导出向导所需的所有分辨率，以及几个更高分辨率的版本。

但是，当我在 Windows 中查看导出的产品时，只有低分辨率版本的图标是我的。当我查看更高分辨率的版本（例如桌面上的链接）时，我的图标被替换为 Eclipse 图标。

在 Windows 中查看 ico 文件时，它会按预期缩放。

我的图标不正确，还是我可以做其他事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:34:25.757

我在 eclipse 新闻组中收到了答复：

哪个版本的 Eclipse？高分辨率支持仅适用于 Juno！并且有一些限制：

[https://bugs.eclipse.org/bugs/show_bug.cgi?id=378662](https://bugs.eclipse.org/bugs/show_bug.cgi?id=378662)

检查您的构建日志，因为在图标品牌化过程中可能存在错误。

# php - 如何获取 PUT 请求的内容？

> ID：11692767
> 
> 赞同：1
> 
> 时间：2012-07-27T17:32:34.780
> 
> 标签：php, rest

如果客户端发送带有数组的 PUT 请求，例如：

```
$a = array('age' => 18);
$rest->put('/api/users/9', $a); 
```

您的其余 API 如何获取 $a 数组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T18:54:13.200

您可以在 处阅读请求正文[`php://input`](http://php.net/manual/en/wrappers.php.php)，但请注意它是易失性的，并且只能阅读一次*。

```
file_get_contents('php://input');‌​ 
```

然后，您需要将其解析为 URL 以将其用作数组。

[*详细信息在链接页面上]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:34:49.410

它应该在请求的正文中。

# php - 四舍五入到最接近的 50 美分

> ID：11692770
> 
> 赞同：11
> 
> 时间：2012-07-27T17:32:56.330
> 
> 标签：php, rounding

我有以下代码将我的金额四舍五入到最接近的美元：

```
 switch ($amazonResult['SalesRank']) {
    case ($amazonResult['SalesRank'] < 1 || trim($amazonResult['SalesRank'])===''|| !isset($amazonResult['SalesRank']) || $amazonResult['SalesRank']=== null):
        $Price=((float) $lowestAmazonPrice) * 0.05;
        $payPrice = round($Price, 0);  //to round the price up or down to the nearest $
        break; 
    case ($amazonResult['SalesRank'] > 0 && $amazonResult['SalesRank'] <= 15000):
        $Price=((float) $lowestAmazonPrice) * 0.20;
        $payPrice = round($Price, 0);  //to round the price up or down to the nearest $
        break; 
```

我知道如果我使用 round($Price, 2); 我会有 2 位小数，但有没有办法四舍五入到最接近的 50 美分？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-27T17:36:57.913

一些简单的数学应该可以解决问题。不是四舍五入到最接近的 50 美分，而是四舍五入到`$price`最接近的美元，然后是一半。

```
$payprice = round($Price * 2, 0)/2; 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-07-27T17:36:38.037

乘以 2，在您想要四舍五入到 0.5 的数字中四舍五入到 0（在您的情况下四舍五入到小数位），然后除以 2。

这将使您四舍五入到最接近的 0.5，加上一个 0，您将四舍五入到最接近的 0.50。

如果您想要最接近的 0.25，请执行相同的操作，但要乘以并除以 4。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-07-18T13:20:49.600

```
function roundnum($num, $nearest){ 
  return round($num / $nearest) * $nearest; 
} 
```

例如：

```
$num = 50.55;
$nearest = .50;
echo roundnum($num, $nearest); 
```

返回

```
50.50 
```

这可以用来四舍五入到任何东西，5cents，25cents，等等......

归功于 ninjured： [http ://forums.devshed.com/php-development-5/round-to-the-nearest-5-cents-537959.html](http://forums.devshed.com/php-development-5/round-to-the-nearest-5-cents-537959.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-18T15:04:09.463

将数字除以最近，做 ceil，然后乘以最近以减少有效数字。

```
function rndnum($num, $nearest){
    return ceil($num / $nearest) * $nearest;
} 
```

前任。

echo rndnum(95.5,10) 返回 100

echo rndnum(94.5,1) 返回 95

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-11T10:33:51.380

请注意，如果您使用 floor 而不是 round，由于浮点数的内部精度，您需要额外的一轮。

```
function roundnum($num, $nearest){ 
  return floor(round($num / $nearest)) * $nearest; 
} 

$num = 16.65;
$nearest = .05;
echo roundnum($num, $nearest); 
```

否则它将返回 16.60 而不是 16.65

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-27T17:39:00.277

[手动的](http://php.net/manual/en/function.round.php)

从手册：`echo round(1.95583, 2); // 1.96`

```
float round ( float $val [, int $precision = 0 [, int $mode = PHP_ROUND_HALF_UP ]] )

val
The value to round

precision
The optional number of decimal digits to round to.

mode
One of PHP_ROUND_HALF_UP, PHP_ROUND_HALF_DOWN, PHP_ROUND_HALF_EVEN, or PHP_ROUND_HALF_ODD. 
```

只需更改为：`echo round(1.54*2, 0)/2; // 1.5`

# php - PHP mysql PDO拒绝设置NULL值

> ID：11692773
> 
> 赞同：15
> 
> 时间：2012-07-27T17:33:14.300
> 
> 标签：php, mysql, pdo

我无法使用 mysql pdo 将默认值为 null 的可空字段设置为 null。我可以使用直接 sql 来做到这一点。

我试过：（主要来自这个问题[How do I insert NULL values using PDO?](https://stackoverflow.com/questions/1391777/how-do-i-insert-null-values-using-pdo)）

1.  空整数

    ```
    bindValue(':param', null, PDO::PARAM_INT); 
    ```

2.  空空

    ```
    bindValue(':param', null, PDO::PARAM_NULL); 
    ```

3.  '空'，整数

    ```
    bindValue(':param', 'NULL', PDO::PARAM_INT); 
    ```

4.  '空'，空

    ```
    bindValue(':param', 'NULL', PDO::PARAM_NULL); 
    ```

5.  空值

    ```
    bindValue(':param', null); 
    ```

6.  '空值'

    ```
    bindValue(':param', 'NULL'); 
    ```

7.  以及`bindParam`5 和 6 的对应项，其中包含一个保存绑定值的变量。

**PDO 中的所有内容都会导致值设置为 0。**

**PHP版本：** `PHP 5.3.2-1ubuntu4.10`

**MYSQL 服务器版本：** `5.1.63-0ubuntu0.10.04.1`

**编辑** 栏信息截图

![图片](../Images/0edc7bec2c553dd92f0fbff9309cdd6a.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-27T18:22:07.703

以下对我有用：

```
<?php

$pdo = new PDO("mysql:host=localhost;dbname=test", "root", "pass");
$pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);

$stmt = $pdo->prepare("INSERT INTO `null_test` (`can_be_null`) VALUES (:null)");
$stmt->bindValue(":null", null, PDO::PARAM_NULL);

$stmt->execute(); 
```

传入 PHP 的`null`，类型为`PDO::PARAM_NULL`. 此外，请确保您的准备模拟设置为 false。这可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-23T09:47:00.233

我强烈建议首先将所有参数分配给变量，然后将这些变量传递给`bindParam()`方法。

您可以通过将 NULL 传递给这些变量来进行分配，它会正常工作。

```
$myVar = NULL;
$conn->bindParam(':param1' , $myVar , PDO::PARAM_STR); 
```

# sql - Oracle SQL 更新基于两个表之间的子查询

> ID：11692778
> 
> 赞同：12
> 
> 时间：2012-07-27T17:33:35.527
> 
> 标签：sql, oracle

我目前正在编写更新语句以保持可查询表不断更新。两个表之间的架构是相同的，内容并不重要：

```
STAGING  

ID  
NAME  
COUNT    

PRODUCTION  

ID  
NAME  
COUNT 
```

我的更新语句如下所示：

```
update PRODUCTION  
set name = (select stage.name from staging stage where stage.name=name  and rownum <2),  
    count =   (select stage.countfrom staging stage where stage.count=count  and rownum <2); 
```

需要注意的两件事是 1）我的更新结束时没有 where 子句（这可能是问题所在）和 2）更新后的所有记录都具有相同的值。我的意思是：

```
BEFORE UPDATE:  

1,"JOHN", 12;  
2,"STEVE",15;  
3,"BETTY",2;  

AFTER UPDATE  

    1,"JOHN", 12;  
    2,"JOHN",12;  
    3,"JOHN",12; 
```

我的问题是如何解决这个问题，以便表正确反映来自暂存的“新”数据作为正确的 SQL 更新？

**更新**

因此，我的暂存数据可能会巧合地反映其中的内容，`PRODUCTION`并且为了讨论，它将：

```
STAGING DATA TO MERGE:  

    1,"JOHN", 12;  
    2,"STEVE",15;  
    3,"BETTY",2; 
```

**更新第二个**

我想运行的查询是这样的：

```
update PRODUCTION
set production.name = staging.name,  
    production.count = staging.count

where production.name = staging.name; 
```

然而，这会导致“staging.name”上出现无效标识符问题

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-07-27T18:33:15.947

有两种方法可以做你正在尝试的事情

一个是[多列相关更新](http://psoug.org/reference/update.html)

```
UPDATE PRODUCTION a
SET (name, count) = (
  SELECT name, count
  FROM STAGING b
  WHERE a.ID = b.ID); 
```

[演示](http://sqlfiddle.com/#!4/ed89f/2)

您可以使用[合并](http://psoug.org/reference/merge.html)

```
MERGE INTO PRODUCTION a
USING ( select id, name, count 
          from STAGING ) b
ON ( a.id = b.id )
WHEN MATCHED THEN 
UPDATE SET  a.name = b.name,
            a.count = b.count 
```

[演示](http://sqlfiddle.com/#!4/ed89f/3)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-29T07:11:28.823

**尝试一下 ..**

```
UPDATE PRODUCTION a
SET (name, count) = (
SELECT name, count
        FROM STAGING b
        WHERE a.ID = b.ID)
WHERE EXISTS (SELECT 1
    FROM STAGING b
    WHERE a.ID=b.ID
 ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T17:42:33.640

正如您所注意到的，您对更新语句没有选择性，因此它正在更新您的整个表。如果您想更新特定行（即 ID 匹配的位置），您可能需要执行协调子查询。

但是，由于您使用的是 Oracle，因此为查询表创建物化视图并让 Oracle 的事务机制处理细节可能更容易。MV 的工作方式与查询语义的表完全一样，非常容易设置，并允许您指定刷新间隔。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-27T17:44:18.703

如果没有 staging 数据集的示例，这是在黑暗中拍摄，但是您是否尝试过类似的方法？

```
update PRODUCTION p,
       staging s
set p.name = s.name  
    p.count = s.count
where p.id = s.id 
```

假设两个表上的 id 列都匹配，这将起作用。

# php - FormMail 不发送图片

> ID：11692779
> 
> 赞同：0
> 
> 时间：2012-07-27T17:33:35.950
> 
> 标签：php, formmail

我正在使用最新版本的 Matts formmail，但由于某种原因，我无法配置图像上传。脚本可以上传图片吗？或者这是我表单中的 html 问题？

它正在上传这个表格。愿意向任何帮助的人捐款。

```
 <form id="buy-online" class="automatic-pricing c7" action="FormMail/formmail.pl"      method="post" enctype="multipart/form-data">

<div class="c1" id="buy-online-header">Get a QuickQuote</div>
<br />
<div class="row c2"><label id="label-product" for="ddl-product"><span>Product:</span>           </label> <select id="product-data" name="ddl_product">
<option value="">Select a product...</option>
<option value="Luxury">Luxury Lawn</option>
<option value="Lush">Lush Lawn</option>
<option value="Natural">Natural Lawn</option>
<option value="RG Basic">RG Basic</option>
<option value="------">-------</option>
<option value="Multiple">Multiple, please state below</option>
</select></div>
<div class="row c2">
<label><br>
Width: <input type="text" name="Width" id="Width" /></label></div>
<div class="row c2">
<label><br>
Length: <input type="text" name="Length" id="Length" /></label></div>
<div>
<br>
Ground Conditions
<textarea style="width:450px" name="Ground Conditions"></textarea>

</div>
<div>
<br>
<div>Comments and Requests
  <textarea style="width:450px" name="Ground Conditions3"></textarea>
</div>
</div><br />
  <div class="c3">
  Area Photos</div>
<div class="c4" id="file1"><input name="Image 1" type="file" /></div>
<div class="c5" id="file1"><input name="Image 1" type="file" /></div>
<div class="c4" id="file1"><input name="Image 1" type="file" /></div>
<div class="c4" id="file1"><input name="Image 1" type="file" /></div>
<div class="c5" id="file1"><input name="Image 1" type="file" /></div>
<div class="c3"><br />
Your Garden Plan<br />
<div class="c6" id="file1"><input name="Image 1" type="file" /></div>
<br /></div>
<div>
Phone Number<br>
<label>
  <input type="text" name="phone" id="phone">
</label>
<textfield style="width:450px" name="phonenumber"></textfield>
<br>
<br>
</div>
<div>
Post Code<br>
<label>
  <input type="text" name="phone" id="phone">
</label>
<textfield style="width:450px" name="phonenumber"></textfield>
<br>
<br>
</div>
<div class="row-button"><button id="button-buy-now" name="btn_buy_now" type="submit">        <span>Get a Quote</span></button></div>
<input type="hidden" name="redirect"    value="http://www.sgsgrass.co.uk/submitconfirmation.php" /> 
</form> 
```

# sql - LINQ to SQL 关闭连接后如何提交更改？

> ID：11692782
> 
> 赞同：0
> 
> 时间：2012-07-27T17:33:44.703
> 
> 标签：sql, linq, submitchanges

我正在使用 LINQ 访问数据库，并对记录进行更改。我像这样检索记录：

```
using(var db = new DatabaseDataContext(connectionString))
{
    var query =
        from item in db.table
        where item.senddate == null
        select item;

    results = query.ToList();
} 
```

获得项目后，我会处理每个项目，这需要与 Web 服务进行通信，并且每条记录可能需要一分钟以上的时间。记录更新后，我需要提交更改，但我不知道如何继续。目前，我执行以下操作：

```
List<table> toProcess = QueryDb();  // Calls the previously displayed method

foreach (table item in toProcess)
{
     item.result = QueryDb(item.xmlrequest);
     PostToDb(item);
} 
```

...

```
private bool PostToDb(table submit)
{
    submit.senddate = DateTime.Now;

    using (var db = new DatabaseDbDataContext(connectionString))
    {
        db.SubmitChanges();
    }

    return result;
} 
```

`db.SubmitChanges()`不提交任何更改，但我还没有真正设置对象“提交”包含更改。在一次处理一个文件时，如何在不保持 Db 连接打开几分钟的情况下提交对条目所做的更改？

提前感谢您的任何帮助。

## 部分解决

我不认为这是最好的解决方案，但我能够让它与我的代码的以下更改一起工作：

```
private bool PostToDb(table submit)
{
    using (var db = new DatabaseDataContext(connectionString))
    {
        var query =
            from item in db.table
            where item.iprimaryid.Equals(submit.iprimaryid)
            select item;

        //  There can only be one result, but this was the only 
        //  way I could think to access it
        foreach (var item in query)
        {
            item.senddate = DateTime.Now;
            item.result = submit.result;
        }

        db.SubmitChanges();
    }

    return result;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T17:57:56.957

您需要`Attach`为您的`DataContext`. 所以，你的步骤是：

1）使用您的一个实例从数据库中查询对象`DataContext`
2）进行一些更改
3）创建新`DataContext`实例并附加修改后的实体。

```
using (var dataContext = new DataContext(ConnectionString))
{
     dataContext.TABLE_NAME.Attach(modifiedEntity);
     dataContext.SubmitChanges();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:45:44.847

您可以在外部范围内声明数据上下文并将其作为参数传递给需要访问数据库的方法吗？像这样的东西：

```
using (var db = new DatabaseDbDataContext(connectionString))
{
    var toProcess = QueryDb(db);

    // Do whatever processing you need to do...

    toProcess.ForEach(t => t.SendDate = DateTime.Now);

    db.SubmitChanges();
} 
```

# java - 点对点聊天安全选项？

> ID：11692784
> 
> 赞同：2
> 
> 时间：2012-07-27T17:33:56.463
> 
> 标签：java, security, sockets

好的，为了好玩，我正在用 Java 编写一个信使程序。好玩吧？:)

我想创建一个在两台 PC 之间工作的信使，无需咨询其他任何人，您只需输入您希望与之聊天的 IP。稍后我将实施一个用户名系统，您可以在其中联系服务器以找出他们的 IP。

我让 AES 和 RSA 完美地工作，然后我意识到当你进行公钥私钥交换时，中间人攻击是可能的。这有点让我生气...

除了使用 CA 或让服务器交换用户名和/或公钥信息之外，是否有任何解决中间人攻击的方法？

有没有这样的程序我可以看看？

多谢你们！

**请注意：目标是在没有服务器的情况下进行安全的点对点通信。也没有像中间人这样的漏洞。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:31:09.657

您必须选择：CA 或共享密钥。没有其他办法。因为否则你怎么能认证对方呢？当然，您可以将其包装在 ssl、pgp、密码、OTR 协议或许多其他协议中，但这只是一个抽象层。如果您当然不想要 CA，那么您必须选择 common secret。正如@Shark 所说，OTR 显示了一个很好的方向 - 你提出问题，对方的回应，如果你的回应是正确的，另一方就被认证了

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T19:48:38.860

基本上你要求太多了。如果您正确使用它们，公钥是安全的。如果您进行听起来不安全的“公钥交换”。私钥永远不会离开生成它们的主机。

公钥是公开的，只是字节。是一对数字！！没有其他信息。所以这里**需要**选择：

1.  让受信任的**第三方**拥有将公钥与身份相关联的共享服务器。这就是所谓的 CA :)
2.  以其他安全方式交换公钥。示例：在一个人的 Facebook 个人资料上发帖（使用 HTTPS 浏览它！），与其他人会面等。

您可能想了解 PGP 和 Web Of Trust 的工作原理。使用 WOT，您可以以社交网络方式进行非常安全的 P2P 聊天。基本上，您仍然永远无法通过键入 IP 地址第一次加入 P2P 聊天，但在您进行初步工作后，您可以获得良好的结果。

首先，获取某人的公钥：**遇见他/她**。届时，您可以验证该方，他可以验证您，而不会受到攻击。

第二阶段包括建立信任链。我将用社交网络术语解释这一点。你是甲方，你遇到了乙方。你们彼此认识。B认识C、D、E，然后你遇到了B不认识的F。

问 B 谁是他的朋友（并得到他们的公钥），你会了解 C、D 和 E，然后你就可以联系他们了。告诉 B 你知道 F，他可以联系他们。

你可能想告诉 F 你通过 A 知道的 C、D 和 E。这是非常敏感的，因为如果这个过程不分青红皂白地重复，坏人很容易进入网络。如果您将信任限制在“朋友的朋友”或达到一定程度的间接知识，您可以平衡安全性。

我以这种方式向您提出建议，因为您告诉您这样做是为了好玩，而不是在商业场景中！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T17:38:05.220

你需要OTR。[http://www.cypherpunks.ca/otr/](http://www.cypherpunks.ca/otr/)

一旦它稳定了，我会帮你测试它。一段时间以来一直有同样的想法。

# c++ - 高效的 Xorshift 跳过

> ID：11692785
> 
> 赞同：3
> 
> 时间：2012-07-27T17:34:09.960
> 
> 标签：c++, algorithm, random

我需要一个快速的随机数生成器，它允许我在随机数序列的不同位置随机访问数字。我选择了 Xorshift，因为它快速且易于实施。

为了从序列中获取特定的随机数，我实现了以下方法（`mPos`保存下一个随机数的位置）：

```
void XorshiftRandomGenerator::skipTo(unsigned int pos)
{
    // Reset if we passed the position
    if (mPos>pos)
        reset();

    // Generate random numbers until we're done
    while (mPos<pos)
        random();
} 
```

随后`random()`将返回所需的数字，但这种方法非常昂贵。有没有办法用 Xorshift 跳过大量随机数，而不计算其间的每个随机数？

作为替代方案，我可以使用另一个随机数生成器。你能推荐一个允许快速跳过的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-13T12:35:18.970

Forest B. Brown 在 1994 年发表了一篇名为[Random Number Generation with Arbitrary Strides](https://laws.lanl.gov/vhosts/mcnp.lanl.gov/pdf_files/anl-rn-arb-stride.pdf)的论文，该论文广泛讨论了这个主题。

正如 Nabb 在评论中所说，**线性同余生成器**可用于有效跳过。当然，液化天然气通常的[优点和缺点](https://en.wikipedia.org/wiki/Linear_congruential_generator#Advantages_and_disadvantages_of_LCGs)也适用：事情简单且速度极快，但伪随机数的质量不是很高。公式在[这里](https://www.nayuki.io/page/fast-skipping-in-a-linear-congruential-generator)详细解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-19T04:53:18.457

你当然可以跳入 xorshift，[这里](https://arxiv.org/pdf/1404.0390.pdf)描述了这个过程，但我自己没有读过，所以我不知道它是多么容易遵循。

或者，您可以查看[PCG](http://www.pcg-random.org/)，它通过使用底层 LCG（与@Daerst 的答案相同）提供跳转功能，但对其进行后处理以改善其统计属性，或者[此处](http://on-demand.gputechconf.com/gtc/2016/presentation/s6665-guy-steele-fast-splittable.pdf)描述的一些可拆分生成器。例如，SplitMix 生成器只有一个常数的循环加法，因此要跳跃任意距离，您只需将跳跃距离乘以常数并加上（[这里](http://xoroshiro.di.unimi.it/splitmix64.c)是一个显然通过 BigCrush 的 SplitMix 导数）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T17:48:29.620

您可以使用随机数生成器的层次结构。即，您使用生成器 A 生成的每个数字都用作生成器 B 的种子，生成器 B 会生成 100 个数字，然后再从 A 获取下一个数字以重新初始化自身并生成接下来的 100 个数字等。这样您可以分步向前跳过乘以 100。您当然可以将其级联到生成器树中。

# cocoa - AVFoundation (OS X) 是否支持透明播放带有 alpha 通道的视频？

> ID：11692788
> 
> 赞同：2
> 
> 时间：2012-07-27T17:34:18.913
> 
> 标签：cocoa, avfoundation

有没有办法播放包含 Alpha 通道的视频文件`AVFoundation`？我想将一个`AVPlayerLayer`作为子层添加到我的图层树中以保留透明度，这样它就可以像叠加层一样工作。

或者是否可以使用第二个灰度视频作为主要电影的 alpha 蒙版？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-27T04:01:09.773

据我所知，OS X 上的 AVFoundation 只能播放 h.264。如果你让它与包含 Alpha 通道的旧 Quicktime 电影一起使用，那么它可能是可能的。一个短期的解决方法是使用一系列 PNG 图像而不是电影，但这不会涉及 AVFoundation。[您还可以在此 anwser](https://stackoverflow.com/questions/3660482/ipad-video-with-transparency/12128695#12128695)上阅读有关可用于此类的我的库。答案是关于 iOS，但该库可以与 iOS 或 OS X 一起使用。

# date - 无法让 pubDate 在 Yahoo! 中输出 管道？

> ID：11692791
> 
> 赞同：4
> 
> 时间：2012-07-27T17:34:31.807
> 
> 标签：date, rss, feed, yahoo-pipes, pubdate

在我的 Yahoo! RSS 提要之一中 管道，我正在使用 Date Formatter 模块和格式 %K 格式化日期，因此它们是 pubDate 兼容的。在管道输出中，我的四个日期如下所示：`Wed, 25 Jul 2012 03:30:00 +0000`、`Mon, 16 Jul 2012 06:30:00 +0000`、`Wed, 11 Jul 2012 07:00:00 +0000`和`Wed, 27 Jun 2012 13:00:00 +0000`。

但是，在 RSS 提要输出中，这些日期都没有出现。它们的格式是否错误？为什么雅虎！管道不输出这些日期？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T21:37:36.713

好的，所以我现在意识到我需要将日期输出到`y:published`而不是`pubDate`. 这似乎没有被广泛记录。即使谷歌搜索`y:published`也不会返回很多结果。

以下是更详细的步骤：

1.  您有一个易于阅读的日期，例如`8 Jan 2013`在其自己的字段中，例如`pubDate`（名称无关紧要；它只是用于`Step 2`）。
2.  将您的提要连接到`Loop`模块。在该模块内，放置`Date Builder`模块，并指定找到日期的字段（例如`pubDate`）。
3.  仍在`Loop`模块中，选择“将结果分配给”并输入`item.y:published`.

这应该在字段的 RSS 输出中输出日期，`pubDate`因此它应该在任何 RSS 阅读器中都可以读取。

# eclipse - 使用eclipse在tomcat上调试GWT

> ID：11692795
> 
> 赞同：7
> 
> 时间：2012-07-27T17:34:42.080
> 
> 标签：eclipse, debugging, gwt, tomcat

我正在使用 GWT 2.4 并且已经编写了大量代码。我知道 GWT 插件附带的 Jetty 服务器对可以在项目中使用的 jar 进行非常严格的控制，以尽可能接近地模仿应用程序引擎。我需要部署到 tomcat 7。我在 eclipse 中修改了我的项目并将其“祝福”为动态 Web 项目，因此我可以导出...WAR 并将其上传到我的 QA 和生产 tomcat。

我需要帮助让应用程序在嵌入式 tomcat 上运行（和调试）（就像一个诚实的动态 Web 项目一样）。我已经在 eclipse 中设置了 tomcat，并且我已经部署了我的 CAS 服务器 Web 应用程序。

我在这里和其他地方准备了大量旧的或令人困惑的帖子。基本上，我正在寻找与打包的 Jetty 服务器相同的调试环境，但是在我自己的 eclipse 中配置了 WTP 的 tomcat 上......所以我可以模仿我的生产环境（就像 Jetty 模仿应用程序引擎一样）

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-28T11:37:12.470

它可能应该更容易一些，但它是可能的。这是我的做法：

### 1\. 设置网络服务器

*   使用 Eclipse 的**JavaEE**版本，我设置了 Tomcat 7.0 服务器适配器，并在`Preferences > Server > Runtime Environments`
*   `File > New > Project... > Web/Dynamic Web Project`
    *   选择我第一步设置的目标运行时
    *   **重要：**在上下文根中，输入`/`
*   我创建了一个 HTML 文件和一个 Servlet，然后尝试使用`Debug As > Debug On Server`

### 2.添加GWT代码服务器

*   `Project > Properties > Google > Web Toolkit > Use Google Web Toolkit`
*   **重要提示：**我总是需要更改 Java 构建路径 ( `Project > Properties > Java Build Path > Order and Export`) 中的顺序，请参阅[http://code.google.com/p/google-web-toolkit/issues/detail?id=4479](http://code.google.com/p/google-web-toolkit/issues/detail?id=4479) - gwt-dev.jar 必须几乎处于领先地位。
*   `Project > Properties > Google > Web Application`: War directory = "WebContent", 还要勾选 "Launch and deploy from this directory"
*   我创建了一些示例 GWT 内容（我创建了一个示例 GWT 项目，并将其中的大部分内容复制过来）
*   我尝试用 GWT 编译项目。这告诉我，如果我得到正确的构建路径顺序 - 否则，编译器会因“java.lang.NoSuchFieldError：warningThreshold”而提前失败。
*   `Debug As > Web Application`- 只是为了创建一个调试配置。停止调试。编辑调试配置 ( `Run > Debug Configurations...`)，取消选择“运行内置服务器”。再次开始调试。

现在，终于，我可以调试服务器和客户端部分（我仍然需要单击两个调试图标来启动两者！）我可以从“开发模式”视图管理客户端，从“服务器”视图管理服务器端“ 看法。归根结底，它运行良好，并且使用“资源更改时自动发布”功能 ( `Servers view > myServerName > Open > Publishing`)，有时甚至比使用集成的 Jetty 更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T17:05:58.667

乍一看，我真的不明白你为什么会遇到问题。也许，Eclipse 的布局方式过于混乱和令人生畏。

在我的 Eclipse 上，我在 GWT 调试期间一直使用默认码头作为服务器。但是，当部署在 Tomcat 或 JBoss 上时，有些问题不会被 jetty 捕获。

当我将 Tomcat 或 JBoss 实例添加到 Eclipse 并将我的应用程序添加到这些服务器实例时，调试立即工作。您是否错过了一项重要但简单的信息？

让我假设以下内容将填补您缺少的链接...

1.  定位/添加您的服务器实例：

    在 Eclipse 中的 Package Explorer（或 Project Explorer，其中之一）上，除了您的个人项目之外，您还会看到一个“服务器”项目。在它下面是列出所有 Tomcat 实例的配置节点。

    如果您在包资源管理器中看不到“服务器”节点，可能是由于您的工作集过滤器。（如果你不知道什么是工作集......我想你需要加强你在 Eclipse 中的灵巧性）。

    如果您还没有 Tomcat 实例，只需右键单击“服务器”项目以添加新服务器（Package Explorer -> New -> Server ...）。系统会询问您 Tomcat 家的位置。以及您想要的服务器实例端口号。当然，您必须确保端口号不会与您机器上任何其他 inet 操作使用的端口冲突。

2.  第二次配置端口号

    在 Package Explorer 中的服务器实例节点上，您会找到应该编辑的文件，以设置端口号以匹配您在创建新 Tomcat 实例时指定的端口号。如果您不知道要编辑哪个文件，则需要阅读您创建的 Tomcat 版本以找出哪个文件包含端口号配置。

    您需要第二次配置端口，因为第一次告诉 Eclipse 期望服务器实例运行的位置和端口。第二次是配置服务器实例本身。

3.  将您的应用程序添加到服务器

    但是，“服务器”项目中的节点只允许您配置 Tomcat 实例。还有另一个称为“服务器视图”的视图来进一步配置您的 tomcat 实例。您需要从 Window->Show View->Server->Servers 启用服务器视图。

    右键单击“服务器视图”中的服务器实例以添加您的应用程序。

4.  在 Maven 生成的目标上运行调试。

    有时您希望调试战争结构以找出战争中缺少哪些罐子。并逐渐从你的战争中删除罐子，以找出服务器已经提供的罐子。由于 JBoss 已经提供了许多 jar，因此您必须确定您的开发 jar 是否与 JBoss 期望的版本相同。

    您将在您的工作区中创建另一个 Eclipse 项目，并在您的第二个项目中创建一个 Eclipse 文件夹软链接，以指向您的第一个项目的 Maven 生成目标。您将 target/{maven generated webapp directory} 指定为第二个项目的 webapp 目录。我所说的“maven 生成的 webapp 目录”是指 Maven 生成的解压缩中间目录（Maven 使用它来生成压缩的 war 文件）。

    如果您可以在 Eclipse 开发盒上忠实地复制生产 tomcat/jboss 服务器，那么这是调试生产战争的最干净的方法。

5.  如果你更喜欢 JBoss。

    不知何故，JBoss 配置节点未列在 Package/Project Explorers 的“服务器”节点中。您需要转到您的 JBoss 安装目录来编辑它们。

6.  远程调试。

    如果你想在你的生产机器上调试应用程序，或者在另一个机器上的服务器上调试，你必须在调试下启动那个 tomcat 实例。你应该读一读。您必须指定调试端口。

    然后在 Eclipse 中，在 Run->Debug Configuration->Remote Java Application 中指定应用程序和调试端口。

    第一次调试时，Eclipse “可能不知道”源文件在哪里，尤其是当您的应用程序具有多个项目依赖项时。（为什么 Eclipse 不能从我的项目列表中搜索源文件？）无论如何，您必须指定在哪里可以找到您的源文件。然后，当您的调试遍历到另一个项目依赖项时，您将不得不覆盖源文件的位置。

所以，瞧！这就是我进行调试的方式。我建议您尽可能避免远程调试，除非您需要诊断生产问题。除非您正在进行远程调试，否则不要尝试将战争部署到本地服务器，而只需将项目与服务器实例相关联即可。

**Eclipse 太混乱了**

我知道 Eclipse 太混乱了，你必须深入了解它的特性。你只需要忍受它。Eclipse 菜单和视图显然针对以插件程序员为中心而非以用户为中心进行了优化。

例如，我为什么要去“帮助”安装新软件？我曾经期望“帮助->安装新软件”是安装新软件的指导手册。

Eclipse 团队没有将这些操作组合在一起，以便我可以在 Package Explorer 中将应用程序添加到服务器实例，这让我很生气（也让我很恼火）。为什么不？作为用户，我希望只看到一个配置服务器的入口点。

为了减轻困惑，我喜欢鼓励人们下载并安装 Springsource 的 Eclipse (STS) 版本。它与 Eclipse 相同，只是 STS 安装了基本部件，并且有一个指向可兼容安装插件的仪表板。Tomcat 预装为 VMware tc Server。并且视图已正确配置以显示服务器实例。并且预装了正确的可使用的 Eclipse-Maven 桥接插件。

# javascript - Javascript：仅替换某些短语中的字母

> ID：11692800
> 
> 赞同：1
> 
> 时间：2012-07-27T17:34:58.540
> 
> 标签：javascript, regex

在[这里，](https://stackoverflow.com/questions/11681822/javascriptreplacing-a-but-not-the-a-in-ab)我被要求用我的一条评论形成一个新问题，所以我在这里。我想知道是否可以仅在某些单词中替换短语。例如：替换`BAB`in`CBABAC`但不是`BAB`in`DABABCC`谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:44:09.313

**使用[前瞻](http://www.regular-expressions.info/lookaround.html)：**

```
BAB(?=AC) 
```

**解释**

```
"BAB" +      // Match the characters “BAB” literally
"(?=" +      // Assert that the regex below can be matched, starting at this position (positive lookahead)
   "AC" +       // Match the characters “AC” literally
")" 
```

或者

```
BAB(?!CC) 
```

**解释**

```
"BAB" +      // Match the characters “BAB” literally
"(?!" +      // Assert that it is impossible to match the regex below starting at this position (negative lookahead)
   "CC" +       // Match the characters “CC” literally
")" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T18:02:22.087

你没有说替换逻辑的依据是什么，所以这是一个笼统的答案。

正如一些人所提到的，您可以使用前瞻，但 JavaScript 的主要烦恼之一是它本身不支持后瞻，因此您只有一半的解决方案。

缺少后视的常见解决方法是匹配（而不是锚定到）您感兴趣的位之前的内容，然后将其重新插入回调中。

假设我想替换`foo`with的所有实例`bar`，它的前面和后面是一个数字。

```
var str = 'foo 1foo1 foo2';
console.log(str.replace(/(\d)foo(?=\d)/g, function($0, $1) {
    return $1+'bar';
})); //foo 1bar1 foo1 
```

所以我对简单的部分使用了前瞻，并使用回调来弥补后瞻的不足。

JS 中有后向*的实现，***[包括我写的一个](http://www.mitya.co.uk/scripts/Simulating-REGEX-look-behinds-JavaScript-164)**，其中正或负的后向作为额外参数传递。使用它，这将得到与上面相同的结果：

```
console.log(str.replace2(/foo(?=\d)/g, 'bar', '(?<=\\d)')); 
```

# iphone - UIWebView 无法在 iPhone 中正确加载页面

> ID：11692801
> 
> 赞同：1
> 
> 时间：2012-07-27T17:34:58.913
> 
> 标签：iphone, ios, ipad, uiwebview, epub

我是 iPhone 新手，

我制作了 ePub 阅读器应用程序，在其中我将本地`.html`页面加载到我的`webview`.

当我加载我的`.html`页面时，它可以正常工作，但一段时间后它无法正常加载。一些意想不到的事情在我的 web 视图中加载，例如 html 页面的文本颜色发生变化，背景颜色发生变化，图像被调整大小，并且所有一些意想不到的事情都会发生，当我点击按钮和点击时同时发生这些事情时我打电话`[webview reload]` 然后一切都恢复正常。

**为什么会发生这种情况？**

我正在创建 webview`viewDidLoad`

```
webView = [[UIWebView alloc] init];
webView.delegate = self;
[self addSubview:webView]; 
[webView release]; 
```

**任何帮助都会得到帮助。**

# ruby-on-rails - 如何将 postgresql 数据库连接到 ruby 表单上的组合框

> ID：11692805
> 
> 赞同：-1
> 
> 时间：2012-07-27T17:35:31.393
> 
> 标签：ruby-on-rails, forms, combobox

我的问题是，我有一个名为 gas_stations 的 postgres 数据库，并且只有一个名为 name 的字段，我需要表单显示表中组合框中的所有数据。还有一个选项应该出现“新站”，而我不知道该怎么做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:42:16.067

我认为您是关于表而不是数据库的故事。为此，您必须创建一个名为 GasStation 的模型，如下所示：

```
class GasStation < ActiveRecord::Base
end 
```

之后，您可以像这样在视图中创建一个列表：

```
select("gas_station", "name", GasStation.all.collect {|gs| [ gs.name, gs.id ] }, { :include_blank => true }) 
```

请参阅此处的指南：http: [//guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:42:34.400

```
select("form_name", "gas_station_id", GasStation.all.collect {|g| [ g.name, g.id ] }, { :include_blank => true }) 
```

这样的事情应该让你开始。当然，您需要创建模型等...

如果您不知道怎么做，请使用快速教程来学习 Rails 基础知识！

# c++ - 错误“成员'学生'[-fpermissive]的额外资格'学生::'”

> ID：11692806
> 
> 赞同：19
> 
> 时间：2012-07-27T17:35:34.467
> 
> 标签：c++, constructor

我收到一个错误`extra qualification ‘student::’ on member ‘student’ [-fpermissive]`。
还有为什么`name::name`在构造函数中使用这种语法？

```
#include<iostream>
#include<string.h>
using namespace std;
class student
{
 private:
     int id;
     char name[30];
 public:
/*   void read()
     {
        cout<<"enter id"<<endl;
        cin>>id;
        cout<<"enter name"<<endl;
        cin>>name;
     }*/
     void show()
     {
        cout<<id<<name<<endl;
     }
     student::student()
     {
        id=0;
        strcpy(name,"undefine");
     }
};
main()
{
 student s1;
// s1.read();
 cout<<"showing data of s1"<<endl;
 s1.show();
// s2.read();
  //cout<<"showing data of s2"<<endl;
 //s2.show();
} 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-07-27T17:38:18.743

成员函数/构造函数/析构函数的类内定义不需要诸如`student::`.

所以这段代码，

```
 student::student()
 {
    id=0;
    strcpy(name,"undefine");
 } 
```

应该是这样的：

```
 student()
 {
    id=0;
    strcpy(name,"undefine");
 } 
```

仅当您在类之外定义成员函数时才需要限定`student::`，通常在 .cpp 文件中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T17:38:55.687

如果构造函数的定义出现在类定义之外，那将是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-19T02:02:17.057

类似代码：

* * *

更改自：

```
class Solution {
public:
  static int Solution::curr_h; // ----------------- ISSUE: "Solution::" is extra
  static int Solution::curr_m; // ----------------- ISSUE: "Solution::" is extra
};

int Solution::curr_h = 0;
int Solution::curr_m = 0; 
```

至：

```
class Solution {
public:
  static int curr_h;  // ----------------- FIX: remove "Solution::"
  static int curr_m;  // ----------------- FIX: remove "Solution::"
};

int Solution::curr_h = 0; // <------ good here - "Solution::" is required
int Solution::curr_m = 0; // <------ good here - "Solution::" is required 
```

* * *

*   发生这种情况是因为复制粘贴`static`需要在类之外进行初始化，但也需要所有声明 ( `int`)。
*   虽然它是正确的，但希望有一种更简单/更好的方法来做同样的事情。

# google-apps-script - 更改应用程序脚本 webapp 的状态

> ID：11692809
> 
> 赞同：1
> 
> 时间：2012-07-27T17:35:44.907
> 
> 标签：google-apps-script

我正在 Google Apps 脚本中制作独立的网络应用程序。我在应用程序中有某种任务流程。首先从电子表格中搜索某些内容，然后对收集的数据进行一些选择，然后用一些用户输入填充电子表格行。所以我需要在几个州之间奔跑。

我很确定我对网络技术知之甚少，所以这可能是一个非常愚蠢的问题，但它就在这里。

我知道 e.parameters 来自这样的网址 www.google.com&value=helloworld ， e.parameters.value 返回 helloworld。

所以现在的问题是：如何在 doGet(e) 中设置参数 e 值并在同一脚本项目中调用同一页面甚至不同的页面/脚本？换句话说，我如何调用 self&value=helloworld ？

还有其他方法可以做到这一点吗？在 GWT 中，我只是将所有内容存储到数据库中，并将会话保存在 cookie 中。但是不允许使用 cookie，那么如何在 google apps 脚本中保持 webapp 的状态？

编辑：这就是我为 doGet(e) 传递参数的方式。

```
function doGet(e) {
  var app = UiApp.createApplication();
  var newValue = 0;
  if(e.parameter == undefined || e.parameter.value == undefined){
    newValue = 1;
  }else{
    newValue = 1+parseInt(e.parameter.value);
  }
  var link = 'https://script.google.com/a/macros/domain.com/s/<insertidhere>/dev';
  var anchor = app.createAnchor('Next',link+'?&value='+newValue);
  anchor.setTarget('_self');
  app.add(anchor);
  var label = app.createLabel(newValue);
  app.add(label);
  return app;
} 
```

链接格式发生了一些变化，因此您需要添加而不是连接 &value=... 首先像这样？&value1=helloworld&value2=....

使用失败？导致我认为存在错误，我需要对链接使用旧格式并使用旧格式禁止使用它的脚本所有者以外的任何其他人。

希望这可以帮助某人解决类似的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T18:08:28.943

你几乎已经回答了自己。将 URL 参数附加到 Web 应用程序 URL 的末尾，您可以在脚本中访问它们。

假设您有一个类似的网址

> [http://script.google.com/.../exec](http://script.google.com/.../exec)

当你点击 URL

> [http://script.google.com/.../exec?value=helloworld](http://script.google.com/.../exec?value=helloworld)

，在 doGet 中，您可以将这些 URL 参数读取为

```
e.parameter.value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T16:56:23.947

IMO - 而不是使用 ? 分隔多个参数尝试将所有值与您选择的其他字符分隔符保持在一个锚点中，例如 # since the first ? 它可能会忽略另一个和之后的一切。很高兴听到你的发现。

# pdf - PDF 中的 FileAttachment 注释：同一文件的注释很少

> ID：11692810
> 
> 赞同：1
> 
> 时间：2012-07-27T17:35:47.367
> 
> 标签：pdf, annotations, itextsharp

我正在尝试使用 iTextSharp 将 FileAttachment 注释添加到我的 PDF 文档中。通常，任务是向文件添加附件（附件类型可能不同 - 图像、pdf、txt、doc 等），并在文档的不同位置创建指向这些文件的链接。问题是，当在 Adob​​e Reader 中打开文档时，我无法弄清楚如何在没有重复的附件选项卡（带有回形针图标的那个）中向同一个文件添加一些注释。

现在我可以将注释放置在应该在的位置，但在这种情况下，我的文档中有一个物理文件，附件选项卡中有多个重复文件。

我可以做的另一件事是在没有重复的情况下向多个页面添加注释，但在这种情况下，我无法定位注释编号 2、3 等。它们始终保持与第一个注释相同的位置。

我一直在尝试的另一个选项是 GoToE(mbedded) 操作。但是带有此类操作的注释不起作用。这是我试图建立的行动结构：

```
1 0 obj
<< /Type /Action
   /S /GoToE
   /T << /R /C
         /N (Embedded document) >> 
```

基本上，我的任务将如何实施对我来说没有什么不同。唯一的要求 - 文档中没有 JS。如果有人有一些解决方案 - 请帮助。

关于维克托

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T08:02:10.307

我发现没有JS就没有解决方案。FileAttachment 注释将始终在 Attachments 选项卡中生成一个条目，但是有一种方法可以将注释与 JavaScript 操作一起使用，如下所示：

```
this.exportDataObject({cName:"[attached_file_name_here]", nLaunch:2}); 
```

这也适用于书签。对我来说幸运的是，我错误地认为我不能在需要此功能的文档中使用 JS。

# excel - 如何在 Excel 中使用 vba 创建和填充 activex 组合框。

> ID：11692816
> 
> 赞同：3
> 
> 时间：2012-07-27T17:35:57.370
> 
> 标签：excel, combobox, vba

尝试在 vba 中为 excel 创建并填充 activex 组合框时遇到问题。下面的代码在作为两个单独的宏运行时有效，但是当我尝试将两者放在一起时，会创建一个空的组合框。谁能告诉我为什么会这样以及如何克服这个问题？

在此先感谢，JW

```
 Sub CreateComboBox1()
    'Creating ComboBox1:
    ActiveSheet.OLEObjects.Add(ClassType:="Forms.ComboBox.1", _
                Link:=False, DisplayAsIcon:=False, Left:=50, Top:=80, Width:=100, _
                Height:=15).Select
    End Sub

    Sub PopulateComboBox1()
    'Populating ComboBox1
    Sheet1.ComboBox1.AddItem "Date", 0
    Sheet1.ComboBox1.AddItem "Player", 1
    Sheet1.ComboBox1.AddItem "Team", 2
    Sheet1.ComboBox1.AddItem "Goals", 3
    Sheet1.ComboBox1.AddItem "Number", 4
    End 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T17:45:05.413

尝试这个

```
Sub CreateComboBox1()
    With ActiveSheet.OLEObjects.Add(ClassType:="Forms.ComboBox.1", _
                Link:=False, DisplayAsIcon:=False, Left:=50, Top:=80, Width:=100, _
                Height:=15)
        With .Object
            .AddItem "Date"
            .AddItem "Player"
            .AddItem "Team"
            .AddItem "Goals"
            .AddItem "Number"
        End With
    End With
End Sub 
```

# c# - Selenium WebDriver 测试登录验证

> ID：11692817
> 
> 赞同：0
> 
> 时间：2012-07-27T17:35:59.057
> 
> 标签：c#, testing, selenium, webdriver

我正在尝试将 Visual Studio MVC3 与 C# 和 Selenium Webdriver 一起使用来测试登录页面上的字段验证。我需要 Selenium 脚本能够通过显示的错误文本来判断登录是否失败。我有哪些选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:43:48.953

您可以登录 selenium，然后在页面上查找一些文本，或者如果警告/错误文本在元素内，您可以使用类似 -

```
element.Text.Equals("text"); 
```

当然，这确实是通用的，无需您显示任何代码。

# version-control - .net 兼容的版本控制系统，可以安装在共享主机上（没有 SSH/root 访问权限）

> ID：11692820
> 
> 赞同：0
> 
> 时间：2012-07-27T17:36:06.510
> 
> 标签：version-control, shared-hosting, windows-hosting

我在 SO 和其他网站上搜索了很多版本控制系统，该系统可以安装在共享 Windows 主机上，让我可以创建存储库以将我的项目文件放在上面并为我提供版本控制设施，但我没有找到。我查看是否可以在共享主机中安装 git、Mercurial 或 TFS，但没有找到任何答案。我想知道您是否知道任何可以安装在共享 Windows 主机上的系统，如果您以前有过经验，请告诉您的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T11:02:46.753

没有这样的解决方案。但是[bitbucket.org](http://bitbucket.org)是一个非常好的 repo，它提供了免费的私人 repos。

# php - 评论部分的日期时间mysql

> ID：11692828
> 
> 赞同：1
> 
> 时间：2012-07-27T17:36:37.727
> 
> 标签：php, mysql, date, time

我对 MYSQL 的日期和时间有疑问。基本上我开始为我正在进行的一个网络项目建立一个评论部分。我正在构建数据库表，想知道数据库如何存储日期和时间。

例如，如果我在洛杉矶，时间是晚上 7:00，它会在晚上 7 点存储评论并说我显然来自纽约，我看到评论是晚上 10 点，那么我什么时候会看到晚上 7 点说得通。我想知道您如何解决这个问题并区分不同的时区。

我想象服务器有自己的时区与之相关联，所以所有时间都被划定出来，这会使事情变得容易得多。但是，当一个人在晚上 7 点发布的帖子中将他们的时间视为晚上 10 点，这是否正确。这一切都让我很困惑。任何有关如何定期处理此问题的信息或我是否有任何信息都将不胜感激。我正在使用 PHP 和 Codeigniter 构建我的网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:42:46.360

我个人只是将时间存储在 INT ( 11 ) 下的数据库中，并使用原生 PHP time() 函数来获取时间，然后您可以使用一些 PHP 函数[http 将其转换为更好的日期格式： //php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)可以获取年月日时分等

然后，您可以轻松地根据时区添加或减去小时数（每小时 3600 秒）。可能是一种更简单的方法，但这就是我目前的做法:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T17:39:21.943

1.  询问用户他们的时区并相应地调整时间。
2.  显示带有日期的时区（“9pm ET”）
3.  做 StackOverflow 所做的，然后说“2 分钟前”。

# c# - WPF DataGrid 多线程崩溃

> ID：11692830
> 
> 赞同：0
> 
> 时间：2012-07-27T17:36:50.020
> 
> 标签：c#, wpf, multithreading, datatable, wpfdatagrid

我有一个视图，`DataGrid`里面有一个。`DataContext`我可以`DataTable`在后台对象中访问的ViewModel 。背景对象必须使用`DataTable`并保持更新。还允许用户对其进行更改`DataTable`。

如果我创建它的副本，`DataTable`它会停止崩溃，但用户显然没有处理数据。

如果我为用户保留访问权限，则程序不可避免地崩溃了。

这是一个会崩溃的简短程序：

应用程序.cs

```
public partial class App : Application
{
    public App()
    {
        SomeBackgroundThing background = new SomeBackgroundThing();
        MainWindowViewModel viewmodel = new MainWindowViewModel(background);
        MainWindowView view = new MainWindowView(viewmodel);
        view.Show();
    }
} 
```

主文件

```
<Window x:Class="NullPointerDataGrid.MainWindowView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <DataGrid Name="datagrid" ItemsSource="{Binding Path=table, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
    </Grid>
</Window> 
```

和程序代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Media;
using System.Data;
using System.Diagnostics;
using System.Timers;
using System.ComponentModel;

namespace NullPointerDataGrid
{
    public partial class MainWindowView : Window
    {
        public MainWindowView(MainWindowViewModel model)
        {
            DataContext = model;
            InitializeComponent();
            datagrid.Loaded += new RoutedEventHandler(ScrollToBottom);
            datagrid.AutoGeneratedColumns += new EventHandler(StarSizeLastRow);

        }

    void ScrollToBottom(object sender, RoutedEventArgs e)
    {
        Debug.WriteLine("TableGrid_ScrollToBottom");
        if (datagrid.Items.Count > 0)
        {
            var border = VisualTreeHelper.GetChild(datagrid, 0) as Decorator;
            if (border != null)
            {
                var scroll = border.Child as ScrollViewer;
                if (scroll != null) scroll.ScrollToEnd();
            }
        }

    }

    void StarSizeLastRow(object sender, EventArgs e)
    {
        Debug.WriteLine("TableGrid_StarSizeLastColumn");
        try
        {
            datagrid.Columns[datagrid.Columns.Count - 1].Width = new DataGridLength(1, DataGridLengthUnitType.Star);
        }
        catch { }
    }

    }

public class MainWindowViewModel : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    private SomeBackgroundThing thing;
    public DataTable table
    {
        get
        {
            lock (thing.table)
            {
                //DataTable wpfcopy = thing.table.Copy();
                return thing.table;
            };
        }
        set
        {
            Debug.Write("This never happens");
        }
    }

    public MainWindowViewModel(SomeBackgroundThing thing)
    {
        this.thing = thing;
        thing.Changed += new EventHandler(thing_Changed);
    }

    void thing_Changed(object sender, EventArgs e)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs("table"));
        }
    }
}

public class SomeBackgroundThing : IDisposable
{
    public DataTable table;
    private DataTable tablecopy;
    private System.Timers.Timer timer, slowrowchanger;

    public event EventHandler Changed = new EventHandler((o, e) => { ;});
    protected void CallChanged(object sender, EventArgs e)
    {
        Changed(sender, e);
    }

    public SomeBackgroundThing()
    {
        CreateTable();
        UpdateB(this, null);
        tablecopy = table.Copy();
        InitAndStartTimer(1);
    }

    #region timer

    private void UpdateA()
    {
        Boolean haschanged = false;
        DataTable newcopy = table.Copy(); ;
        if (newcopy.Rows.Count != tablecopy.Rows.Count)
        {
            Debug.WriteLine("Different ammount of rows");
            haschanged = true;
        }
        else if (newcopy.Columns.Count != tablecopy.Columns.Count)
        {
            Debug.WriteLine("Different ammount of columns");
            haschanged = true;
        }
        else
        {
            for (int i = 0; i < newcopy.Rows.Count; i++)
            {
                for (int j = 0; j < newcopy.Columns.Count; j++)
                {
                    if (newcopy.Rows[i][j].ToString() != tablecopy.Rows[i][j].ToString())
                    {
                        Debug.WriteLine(String.Format(
                            "Element [{0}/{1}]: {2} is different from {3}",
                            i, j, newcopy.Rows[i][j], tablecopy.Rows[i][j]
                            ));
                        haschanged = true;
                    }
                    if (haschanged) break;
                }
                if (haschanged) break;
            }
        }
        if (haschanged)
        {
            tablecopy = newcopy;
        }
    }

    private void InitAndStartTimer(int interval)
    {
        timer = new System.Timers.Timer();
        timer.Interval = interval;
        timer.AutoReset = true;
        timer.Elapsed += new ElapsedEventHandler((s, e) =>
        {
            UpdateA();
        });
        timer.Enabled = true;

        slowrowchanger = new System.Timers.Timer();
        slowrowchanger.Interval = 3000;
        slowrowchanger.AutoReset = true;
        slowrowchanger.Elapsed += new ElapsedEventHandler((s, e) =>
        {
            UpdateB(null, null);
        });
        slowrowchanger.Enabled = true;

    }

    public void Dispose()
    {
        timer.Enabled = false;
        slowrowchanger.Enabled = false;
        timer.Dispose();
        slowrowchanger.Dispose();
    }

    #endregion

    #region editlastrow

    void UpdateB(object sender, EventArgs e)
    {
        Random rnd = new Random();
        List<String> cells = new List<string>{
                "The SAME", 
                rnd.Next(0,100).ToString(), 
                rnd.ToString(), 
                rnd.NextDouble().ToString()};
        lock (table)
        {
            OverwriteOrAppendLastRow(ref table, cells);
            table.AcceptChanges();
        }
        CallChanged(this, null);
    }

    private void OverwriteOrAppendLastRow(ref DataTable table, List<string> newrow)
    {
        if (table.Rows.Count == 0) CreteEmptyRow(ref table);
        if (newrow[0].ToString() != table.Rows[table.Rows.Count - 1][0].ToString())
        {
            Debug.WriteLine(String.Format("Creating row because '{0}' is different from '{1}'", newrow[0], table.Rows[table.Rows.Count - 1][0]));
            CreteEmptyRow(ref table);
        }
        OverwriteLastRow(ref table, newrow);
    }

    private void OverwriteLastRow(ref DataTable table, List<string> newrow)
    {
        for (int i = 0; i < newrow.Count() && i < table.Columns.Count; i++)
        {
            table.Rows[table.Rows.Count - 1][i] = newrow[i];
        }
    }

    private void CreteEmptyRow(ref DataTable table)
    {
        table.Rows.Add(new String[table.Columns.Count]);
    }

    #endregion

    private void CreateTable()
    {
        table = new DataTable();
        table.Columns.Add("FirstCell", typeof(String));
        table.Columns.Add("BananaCell", typeof(String));
        table.Columns.Add("CherryCell", typeof(String));
        table.Columns.Add("Blue", typeof(String));
        Random rnd = new Random();
        for (int i = 0; i < 145; i++)
        {
            table.Rows.Add(new String[]{
                rnd.Next().ToString(), 
                rnd.Next(0,i+1).ToString(), 
                rnd.ToString(), 
                rnd.NextDouble().ToString()});
        }
    }

}

} 
```

我怎样才能阻止这个多线程崩溃？

* * *

编辑：

我不知道这段代码崩溃的原因是否不止一个。但我尽我所能收集有关崩溃原因的一些信息：

App.g.cs 中的 Nullpointer 异常 - 自动生成的部分。调试器不会介入它 - 所以我不能说它崩溃的行。

这是异常详细信息，对德国人感到抱歉。

```
System.NullReferenceException wurde nicht behandelt.
  Message=Der Objektverweis wurde nicht auf eine Objektinstanz festgelegt.
  Source=PresentationFramework
  InnerException: 
```

Stacktrace 仅显示“外部代码”，因此没有要跟踪的堆栈。

问题是 WPF 崩溃了——我的代码可以处理它……不知何故我需要封装 WPF，这样它就不会崩溃，一种方法是复制 DataTable——但后来我失去了写回该表的能力，因为它编辑某些内容时不会调用 setter。

编辑＃2：

我重新创建了这个示例以显示我在另一个程序中遇到的错误，我刚刚发现崩溃实际上与滚动条有关。如果我将显示数据的数量更改为较低的数字以便没有滚动条，则代码不会崩溃。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T16:00:57.133

对视图模型的以下更改解决了该问题。

我现在正在使用 wpf 的副本来处理，并且只注意它们发生时的变化。该代码存在改进机制不佳的问题 - 但这超出了此问题的范围。

```
public class MainWindowViewModel : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    private SomeBackgroundThing thing;

    private DataTable wpftable;
    public DataTable table
    {
        get
        {
            lock (wpftable)
            {
                return wpftable;
            }

        }

        set
        {
            lock (wpftable)
            {
                wpftable = value;
            }
        }
    }

    public MainWindowViewModel(SomeBackgroundThing thing)
    {
        wpftable = thing.table.Copy();
        this.thing = thing;
        thing.Changed += new EventHandler(thing_Changed);
    }

    void thing_Changed(object sender, EventArgs e)
    {
        if (PropertyChanged != null)
        {
            DataTable wpftablecopy = wpftable.Copy();
            DataTable thintablecopy = thing.table.Copy();
            int rowcount = wpftablecopy.Rows.Count;
            for (int col = 0; col < 4; col++)
            {
                for (int row = 0; row < rowcount; row++)
                {
                    if (wpftablecopy.Rows[row][col] != thintablecopy.Rows[row][col])
                        wpftable.Rows[row][col] = thintablecopy.Rows[row][col];
                }
            }
            PropertyChanged(this, new PropertyChangedEventArgs("table"));
        }
    }
} 
```

# mysql - mysql通过参数关系选择数据

> ID：11692831
> 
> 赞同：0
> 
> 时间：2012-07-27T17:36:52.483
> 
> 标签：mysql, select

请对（高级）mysql提供一些帮助。示例更好地说明了这个问题。所以..

我有一个带有 partner1 和 partner2 列的预定义值对表 PARTNER。然后还有另一个表 PROJECTS，其中包含 partner1 和 partner2 列。

因此，我想选择列 partner1 和 partner2 在上述实际合作伙伴表中的所有 PROJECTS。

显然，我不能简单地指出“partner1=... 和/或 partner2=...”，因为不会检查这两个是否是合作伙伴（如 PARTNERS 表中所定义）。（以防万一：partner1 和 partner2 的项目不在合作伙伴关系中。）

我认为这种查询根本不可能，因为它的条件存储在结果中。但是，如果有人可以证明并非如此，那将很高兴。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:42:51.460

听起来您需要一个查询，该查询将为您提供 PROJECTS 中的行，其中合作伙伴 1 和合作伙伴 2 都与 PARTNERS 中的任何行相同。所以做一个内部连接：

```
SELECT * FROM projects
INNER JOIN partners
    ON projects.partner1 = partners.partner1
    AND projects.partner2 = partners.partner2 
```

如果您准备重组表，则为 PARTNERS 中的每一行分配一个唯一 ID 并在 PROJECTS 表中使用该 ID 可能更有意义。这样一来，您就无需存储两列冗余数据，而只需一列来指示项目中的哪对学生。

# ruby - ruby watir-webdriver 无法访问弹出窗口

> ID：11692834
> 
> 赞同：1
> 
> 时间：2012-07-27T17:37:10.977
> 
> 标签：ruby, watir-webdriver, selenium-chromedriver

大家好，我在单击链接后打开的弹出窗口中访问表单时遇到问题。一旦我点击了链接，我就会出现，它会导致脚本挂起，甚至不会超时。我需要能够访问表单、设置一些文本字段并单击提交按钮。

链接代码： `<a id="ctl00_ContentPlaceHolder2_ctrlPageHeader1_aFilter" class="RightTextHeading" onclick="javascript:openMdlWindow('InvestmentDetailOptions.aspx?IDAssetType=','620','600');if(window.document.RetValue == '2'){window.parent.LoadinIframe('InvestmentDetail.aspx?FromMenu=N&amp;IDAssetType=','Investment Details &gt; Full View','false');}" style="text-decoration:none;">Filter</a>`

我已经尝试了一切，但似乎没有任何效果。有没有人遇到过这个并有解决方案？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T08:12:51.207

你试过这个：

```
browser.window(:title => "annoying popup").use do
  browser.button(:id => "close").click
end 
```

更多信息：[http ://watirwebdriver.com/browser-popups/](http://watirwebdriver.com/browser-popups/)

# javascript - 使用 node.js 覆盖文件中的一行

> ID：11692835
> 
> 赞同：8
> 
> 时间：2012-07-27T17:37:15.730
> 
> 标签：javascript, node.js, filesystems

使用 node.js 覆盖大型（2MB+）文本文件中的一行的最佳方法是什么？

我目前的方法涉及

*   将整个文件复制到缓冲区中。
*   通过换行符 ( `\n`) 将缓冲区拆分为数组。
*   使用缓冲区索引覆盖该行。
*   然后在加入后用缓冲区覆盖文件`\n`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T16:08:47.803

首先，您需要搜索行的开始位置和结束位置。接下来，您需要使用一个函数来替换该行。我有使用我的一个库的第一部分的解决方案：[Node-BufferedReader](https://github.com/Gagle/Node-BufferedReader/wiki/Reference)。

```
var lineToReplace = "your_line_to_replace";
var startLineOffset = 0;
var endLineOffset = 0;

new BufferedReader ("your_file", { encoding: "utf8" })
    .on ("error", function (error){
        console.log (error);
    })
    .on ("line", function (line, byteOffset){
        startLineOffset = endLineOffset;
        endLineOffset = byteOffset - 1; //byteOffset is the offset of the NEXT byte. -1 if it's the end of the file, if that's the case, endLineOffset = <the file size>

        if (line === lineToReplace ){
            console.log ("start: " + startLineOffset + ", end: " + endLineOffset +
                    ", length: " + (endLineOffset - startLineOffset));
            this.interrupt (); //interrupts the reading and finishes
        }
    })
    .read (); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-13T04:11:17.080

也许你可以试试包[替换文件](https://www.npmjs.com/package/replace-in-file#multiple-values-with-different-replacements)

假设我们有一个如下的txt文件，我们要替换：

第 1 行 -> 第 3 行

第 2 行 -> 第 4 行

```
// file.txt
"line1"
"line2"
"line5"
"line6"
"line1"
"line2"
"line5"
"line6" 
```

然后，我们可以这样做：

```
const replace = require('replace-in-file');

const options = {
    files: "./file.txt",
    from: [/line1/g, /line2/g],
    to: ["line3", "line4"]
};

replace(options)
.then(result => {
    console.log("Replacement results: ",result);
})
.catch(error => {
    console.log(error);
}); 
```

更多细节请参考其文档：[https ://www.npmjs.com/package/replace-in-file](https://www.npmjs.com/package/replace-in-file)

# spring - URL 映射问题 - Spring Web MVC

> ID：11692837
> 
> 赞同：15
> 
> 时间：2012-07-27T17:37:20.657
> 
> 标签：spring

我是 Spring 和 web MVC 模块的新手。基本上，我有以下内容：

web.xml

```
<servlet>
    <servlet-name>abc-dispatcher</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>abc-dispatcher</servlet-name>
    <url-pattern>/user/*</url-pattern>
</servlet-mapping> 
```

abc-调度程序-servlet.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:context="http://www.springframework.org/schema/context"
   xsi:schemaLocation="http://www.springframework.org/schema/beans
   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
   http://www.springframework.org/schema/context
   http://www.springframework.org/schema/context/spring-context-3.0.xsd">

<context:component-scan base-package="myPkg" />

<bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/>
    <property name="prefix" value="/WEB-INF/pages/"></property>
    <property name="suffix" value=".jsp"></property>        
</bean> 
```

我有一个控制器，相关部分是：

```
@Controller
public class ABCController {

@RequestMapping("/user/welcome")
public String printWelcome(ModelMap model) {

    //code

} 
```

现在每当我尝试访问`http://localhost:8080/myapp/user/welcome`

它给了我404。

日志说“将 url '/user/welcome' 映射到处理程序 'ABCController' 但它未能在 DispatcherServlet 中映射 URI [/ **MYAPP** /user/welcome] 名称为 'abc-dispatcher' 。

完全糊涂了。我已经检查了我们两次指定映射的所有线程，但这里不是这种情况。我肯定错过了什么！

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-27T21:43:37.037

URL 应该是`http://localhost:8080/myapp/user/user/welcome`. 实际上，除非处理程序的 alwaysUseFullPath 属性设置为 true，否则 servlet-mapping 会附加到请求映射 URL 以形成完整路径。

有关详细信息，请参阅[http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/htmlsingle/spring-framework-reference.html#mvc-handlermapping](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/htmlsingle/spring-framework-reference.html#mvc-handlermapping)：

> 始终使用完整路径
> 
> 如果为 true ，Spring 使用当前 Servlet 上下文中的完整路径来查找合适的处理程序。如果为 false（默认值），则使用当前 Servlet 映射中的路径。例如，如果使用 /testing/* 映射 Servlet 并且 alwaysUseFullPath 属性设置为 true，则使用 /testing/viewPage.html，而如果该属性设置为 false，则使用 /viewPage.html。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-11T03:02:28.883

它已被添加`context:component-scan`到示例上下文文件片段中，但没有`<annotation-driven/>`元素表明 spring 框架可以查找带有注释的控制器`@Controller`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-04-26T22:45:22.497

对我来说，问题是我使用了已弃用的**DefaultAnnotationHandlerMapping**，即使将*alwaysUseFullPath*设置为 true，它也没有生效，但是将 DefaultAnnotationHandlerMapping 替换为**RequestMappingHandlerMapping**并将*alwaysUseFullPath*设置为 true 解决了问题。

```
<bean id="handlerMapping" class="org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping">
    <property name="alwaysUseFullPath" value="true"></property>
</bean> 
```

# c# - 流利的 NHibernate 双向 HasMany 映射留下孤立的记录

> ID：11692838
> 
> 赞同：0
> 
> 时间：2012-07-27T17:37:21.167
> 
> 标签：c#, nhibernate, fluent-nhibernate, mapping

我有一个问题，似乎无法弄清楚我做错了什么。我有一个公司有很多组，一个组有很多用户，一个用户属于一个组。将组添加到公司工作正常，但是我无法将用户添加到组。

这是我的映射：

```
 public GroupMapping()
  {
     Id(x => x.Id);
     Map(x => x.Name);

     References(x => x.Company).Column("Company_Id");

     HasMany(x => x.Users)
        .Table("User")
        .KeyColumn("Group_Id")
        .Cascade.None();
  }

  public UserMapping()
  {
     Id(x => x.Id);

     References(x => x.Group).Column("Group_Id");

     HasMany(x => x.Role)
        .KeyColumn("User_Id")
        .Cascade.All();
  } 
```

在数据库上，我将 FK 设置为 Not Null。密钥位于名为 Group_Id 的用户表上。我正在使用以下方法将我的用户分配给该组：

```
 public JsonResult AssignGroup(int id, int groupId)
  {
     var user = UserRepository.GetById(id);
     var group = GroupRepository.GetById(groupId);

     user.Group = group;

     UserRepository.Save(user);

     return Json(new {});
  } 
```

我没有收到任何错误，但是从未设置 Group_Id。任何帮助，将不胜感激！

谢谢，乔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T13:14:22.370

*   `HasMany(x => x.Users)`缺少一个，`Inverse()`否则当您添加用户时它会抛出。只有用户应该维护 FK
*   您很可能丢失`session.Flush()`或`transaction.Commit();`在您的存储库方法中

# asp.net-mvc - MVC 3 Entity Framework 简单的键映射

> ID：11692839
> 
> 赞同：1
> 
> 时间：2012-07-27T17:37:24.183
> 
> 标签：asp.net-mvc, entity-framework

模型类：

```
public class User {
    [Key]
    public Guid UserId { get; set; }

    [Display(Name = "User Name")]
    public string UserName { get; set; }

    public virtual ICollection<Asp_Membership> CreateDates { get; set; }
}

public class Asp_Membership {
    [Key]
    public Guid UserId { get; set; }

    [Display(Name = "Date Created")]
    public DateTime CreateDate { get; set; }
} 
```

数据库上下文

```
public class UsersContext : DbContext {
        public UsersContext() : base("ApplicationServices") { }
        public DbSet<User> Users { get; set; }
        public DbSet<Asp_Membership> Asp_Memberships { get; set; }

        protected override void OnModelCreating(DbModelBuilder modelBuilder) {
           //mapping of Users and Membership
           //what exactly do i put here to join the two tables by UserId
        } 
```

我的问题很简单，您可能会说，这是我第一次尝试了解 EF 的实际工作原理。我要做的是加入基于 UserId 的 aspnet_Users 表和 aspnet_Membership 表。我该怎么做？

但更重要的是，我真的找不到好的实体框架教程，有什么建议吗？

- 更新 -

**DbContext**（同上）

**型号类：**

```
public class User {
    [Key]
    public Guid UserId { get; set; }

    [Display(Name = "User Name")]
    public string UserName { get; set; }

    public virtual Asp_Membership asp_Membership { get; set; }
}

public class Asp_Membership {
    [Key]
    public Guid UserId { get; set; }

    [Display(Name = "Date Created")]
    public DateTime CreateDate { get; set; }
} 
```

**控制器：**

```
private UsersContext db = new UsersContext();

// GET: /Users/Index
public ActionResult Index() {
    return View(db.Users.ToList());
} 
```

**索引页面：（**删除了不必要的元素......）

```
@model IEnumerable<ReservationPro.Models.User>
...
@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.UserName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.asp_Membership.CreateDate)
        </td>
    </tr>
} 
```

我要做的就是弄清楚如何从默认的 aspnetdb 中加入两个单独的表“aspnet_Users”和“aspnet_Membership”。如模型类中所述，它们都有“UserId”列。我知道这是一个简单的问题，我很抱歉让这个混乱。正如您可能知道的那样，我刚刚开始使用 EF，只是想用一些简单的代码让我的手“变脏”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:42:36.953

你快到了。尝试这个：

```
public class User {
    [Key]
    public Guid UserId { get; set; }

    [Display(Name = "User Name")]
    public string UserName { get; set; }

    public virtual Asp_Membership asp_membership { get; set;}
}

public class Asp_Membership {
    [Key]
    public Guid UserId { get; set; }

    [Display(Name = "Date Created")]
    public DateTime CreateDate { get; set; }

    public virtual User user { get; set;}
} 
```

这样，您就可以从一个方向访问另一个方向。如果您只希望它在一个方向上，只需将它放在您想要访问另一个方向的类中。此外，这假设关系是 1 对 1。从您的问题中很难判断。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T10:50:50.763

使用 UPDATE 中的模型类，您可以尝试以下映射：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<User>()
        .HasOptional(u => u.asp_membership)
        .WithRequired();
} 
```

映射意味着用户*可以*拥有成员资格（不超过一个），但不是必需的（`HasOptional`/ `0..1`）。另一方面，会员资格始终*必须*有一个相关用户（`WithRequired`/ `1`）。

在 ASP.NET 成员表中，`User`表用关系的主键表示主体，`Membership`表用外键表示依赖。但外键同时是表的主键（`UserId`）`Membership`。因此，该关系是共享主键一对一的关系。您必须使用上面的映射显式定义它，否则默认情况下 EF 会从您的模型中推断出一对多的关系。

# c++ - c ++：测试代码是否在catch块中

> ID：11692840
> 
> 赞同：1
> 
> 时间：2012-07-27T17:37:28.010
> 
> 标签：c++, exception, boost

我正在尝试基于 boost::exception 制作一个通用的异常框架。为此，我使用这样的宏：

```
#define AR_THROW_EXCEPTION(internalMessage)\
BOOST_THROW_EXCEPTION(boost::enable_current_exception(ArException())\
<< internal_message(internalMessage)\
<< inner_exception(boost::current_exception())) 
```

我的问题是“boost::current_exception()”如果不是从 catch 块中调用，它将终止我的程序。为了避免定义第二个宏“AR_RETHROW_EXCEPTION”，我希望能够做到

```
#define AR_THROW_EXCEPTION(internalMessage)\
BOOST_THROW_EXCEPTION(boost::enable_current_exception(ArException())\
<< internal_message(internalMessage)\
if (IS_IN_CATCH_BLOCK)\
<< inner_exception(boost::current_exception())) 
```

有人知道方法吗？

# sql - 什么更有效：字符串搜索，还是通过 SQL 连接？

> ID：11692843
> 
> 赞同：0
> 
> 时间：2012-07-27T17:37:48.833
> 
> 标签：sql, string, function, search, optimization

我有两个单词列表，我需要找到匹配项（两组的交集。）我应该将每个列表存储为字符串并通过字符串函数（如正则表达式）查找匹配项还是将单词存储在表中，并拥有SQL 通过加入来查找匹配项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T18:04:17.293

如果没有有关该问题的更多信息，几乎不可能说。这里有一些要考虑的事情：

*   你有多少不同的物品？
*   典型的行上有多少种不同的组合？
*   您的搜索是否需要查找通配符？
*   单个项目多长时间？
*   您正在运行的数据库引擎和硬件的详细信息。

我想强调的是，在几乎所有情况下，您都希望将值存储在另一个表中。性能不一定是主要原因。更重要的是易于更新和删除单个值，以及支持更多类型的查询（例如所有可用值的列表）的能力。

但是，我们仍然可以考虑性能问题。将值存储在单个字符串中只需要获取带有记录的页面，然后应用一个遍历字符串的函数。对于简单的模式（例如识别固定子字符串的存在），这应该很快。计算机做的事情很少比遍历字符串和比较值更快（假设一个合理的实现）。

在可能的最快连接中，需要读入两个表，并且需要匹配键。这需要额外的努力。情况更糟，因为您确实需要两个额外的表，一个用于单个字符串项，另一个用于原始记录与项之间的关系。

此时，您可能会认为“天哪，字符串似乎是一个更好的主意”。这是错误的。最大的区别之一是平均尺寸。如果您的项目平均长于 4 个字符，那么您可以通过使用参考表来节省空间。节省的空间会立即转化为性能的提高，因为 I/O 更少。有了索引，额外的表无论如何都会在内存中，所以匹配会很快。

而且，还有查询的问题。您可以将标准 SQL 函数用于查询，例如具有 A 和 B 的记录（许多字符串函数是特定于数据库的）。您可以轻松地准确找出数据库中有哪些项目，并且相对容易地找到记录中存在哪些对。您可以跟踪项目何时添加到记录，以及它第一次出现在数据库中的时间。通常，这种灵活的功能——它只是基本的 SQL 功能——是您在管理此类数据时所需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:50:09.183

在大多数情况下，存储在表中会比 SQL 字符串操作函数快得多，尤其是在您可以索引单词的情况下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T18:05:27.920

我*想*你是在问这个：

```
SELECT word FROM table_one WHERE word in (SELECT word FROM table_two) 
```

比这更快：

```
SELECT table_one.word FROM table_one 
INNER JOIN table_two ON table_one.word = table_two.word 
```

第一个答案应该更快，因为第二个会创建一个（可能很大）临时对象（连接表）。

请注意，我假设您在`word`. 另外：如果字符串很长（例如 URL），这将非常慢，您应该改为匹配哈希。

# javascript - 如何在 jquery 中使用单个取消委托方法删除多个事件委托

> ID：11692844
> 
> 赞同：9
> 
> 时间：2012-07-27T17:37:59.347
> 
> 标签：javascript, jquery

我可以使以下内容更简单（而不是使用两次“取消委托”）吗？

```
$("#div1").undelegate("div", "mouseenter").undelegate("div", "mouseleave"); 
```

我不希望 mouseenter 和 mouseleave 以外的事件处理程序受到干扰。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-27T17:42:45.267

用空格分隔您的活动。

```
$("#div1").undelegate("div", "mouseenter mouseleave"); 
```

你应该使用`on`和`off`虽然。

```
$("#div1").off("mouseenter mouseleave", "div"); 
```

[http://api.jquery.com/undelegate/](http://api.jquery.com/undelegate/)

> .undelegate() 方法是一种删除已使用 .delegate() 绑定的事件处理程序的方法。从 jQuery 1.7 开始，.on() 和 .off() 方法是附加和删除事件处理程序的首选方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T17:52:08.637

在这种特定情况下，您可以使用和的简写[`.hover()`](http://api.jquery.com/hover/)。`mouseenter``mouseleave`

```
​$("#div1").off("hover", "div"); 
```

​是 [`.off()`](http://api.jquery.com/off/)从 jQuery 1.7 开始删除事件处理程序的推荐方法。

# sql - 如何选择具有相应员工的所有经理

> ID：11692845
> 
> 赞同：-3
> 
> 时间：2012-07-27T17:38:00.243
> 
> 标签：sql

```
ID  EMP_ID  EMP_NAE  MANAGER_ID
1     1      KARAN      2
2     2      K VEDI     3
3     3      SOMYA      2
4     4      KAVITA     3
5     5      AMAN       2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:41:32.090

对于员工及其经理的列表，请使用：

```
select emp_nae as [Employee name], man.emp_nae as [Manager name]
from tablename as emp
left join tablename as man on man.emp_id = emp.manager_id 
```

对于经理及其员工的列表，请使用：

```
select emp_nae as [Employee name], man.emp_nae as [Manager name]
from tablename as man
join tablename as emp on man.emp_id = emp.manager_id 
```

# java - Liquibase：使用序列

> ID：11692847
> 
> 赞同：2
> 
> 时间：2012-07-27T17:38:05.480
> 
> 标签：java, oracle11g, liquibase

我正在使用`InsertStatement`该类，并且我想传递序列生成代码。我怎么做？我尝试了以下，但没有奏效。

```
InsertStatement statement1 = new InsertStatement("saas", "OAuth2AppTemplate");
statement1.addColumnValue("id", 
    new SelectSequencesStatement("saas.seq.nextval")); 
```

有什么输入吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T19:07:50.700

好的，经过大量研究 Liquibase 文档后，我找到了它。

```
InsertStatement statement1 = new InsertStatement("saas", "OAuth2AppTemplate");
final Sequence sequence = new Sequence();
sequence.setName("saas.OAuth2AppTemplate_id_seq.nextval");
statement1.addColumnValue("id", sequence); 
```

然后这会适当地生成查询。

# jquery - 如何对 ASP.NET MVC / jQuery 中的动态内容应用 OBTRUSIVE 验证？

> ID：11692849
> 
> 赞同：0
> 
> 时间：2012-07-27T17:38:17.553
> 
> 标签：jquery, asp.net-mvc, validation, dynamic, jquery-validate

有很多关于如何在 MVC 3 中对动态内容应用“不显眼”验证的参考资料。例如，如果我通过 jQuery ajax 加载或刷新表单，我可能希望使用“$.验证器.unobtrusive.parse ...”。但是，我正在使用 OBTRUSIVE 验证，但我似乎无法找到一种方法来做到这一点。

有没有办法做到这一点？:)

请记住，在我调用 AJAX 之前，表单元素可能从未存在于表单上。

IE：

1.  页面已加载
2.  用户执行某些操作来触发 AJAX 调用，通过包含表单的 jQuery.ajax 加载部分视图
3.  将客户端验证附加到新表单

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:48:20.917

我找到了“一种方法”来做到这一点。这可能不是最好的方法，所以我想听听任何其他解决方案。如果提供更好的，我会选择它作为解决方案。

基本上我发现我可以重新填充

```
window.mvcClientValidationMetadata 
```

...数组，然后调用：

```
Sys.Mvc.FormContext._Application_Load() 
```

这将清空数组并解析验证 JSON。

# objective-c - 查找数字的下一个倍数的快速方法

> ID：11692851
> 
> 赞同：9
> 
> 时间：2012-07-27T17:38:22.863
> 
> 标签：objective-c, c, math

我需要找到从基数开始的数字的第一个倍数。例如：7 中 3 的第一个倍数是 9。我的第一次尝试是这样做：

```
multiple = baseNumber
while(multiple%number !=0 )
    multiple++ 
```

最后，“multiple”将具有`number`after的第一个倍数`baseNumber`。问题是当`number`变得太大时，迭代次数变得太多。所以我的问题是：有没有更快的方法来做到这一点？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-27T17:43:26.563

如果一切都保证是积极的，请尝试

```
multiple = baseNumber + number - 1;
multiple -= (multiple % number); 
```

这是在恒定时间内完成的。

首先，我们添加`number - 1`以确保我们有一个至少与下一个倍数一样大但小于之后的倍数的数字。然后我们减去除以的余数，`number`以确保我们有所需的倍数。

if`baseNumber`可以是负数（但`number`仍然是正数），我们面临的问题`multiple % number`是 if 可能是负数`multiple < 0`，所以上面可以跳过 的倍数`number`。为了避免这种情况，我们可以使用例如

```
remainder = multiple % number;
if (remainder < 0) remainder += number;
multiple -= remainder; 
```

如果分支太昂贵，我们可以避免`if`以两个部门而不是一个部门为代价，

```
multiple -= (number + (multiple % number)) % number; 
```

不过，一般来说，这`if`似乎更可取。

如果`number`可以是负数，先用它的绝对值代替。

注意：`baseNumber`如果它已经是`number`. 如果不需要，请删除`- 1`第一行中的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-27T17:45:14.317

试试这个（需要整数除法）：

```
multiple = ((base/number) + 1) * number; 
```

7/3 = 2。3*(2+1) = 9。

您有一个极端情况，其中`baseNumber`已经是 的倍数`number`，您必须使用模数运算对其进行测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-27T18:09:21.640

为什么需要循环？

倍数 = (楼层(number/baseNumber)+1)*baseNumber

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T17:44:37.233

```
 while(multiple * number < baseNumber)
      multiple++; 
```

所以对于 baseNumber = 3，number = 7，你的倍数是 3；

不过，有些事情告诉我bignums即将出现在这里。

# javascript - Joomla2.5 框架似乎干扰了 javascript 语法

> ID：11692855
> 
> 赞同：0
> 
> 时间：2012-07-27T17:38:36.170
> 
> 标签：javascript, jwplayer, joomla2.5

以下代码在 Joomla2.5 之外完美运行。以及在早期版本的 Joomla 中，但在 Joomla2.5 文章中或由 Joomla2.5 插件呈现时失败。

有问题的行是这一行。

`s1.addVariable('playlistfile', 'http://www.myserver.com/playlist.php?s=123&u=789`

它返回一个 XML 播放列表，播放器通常会按预期加载和播放，但它是 cuplprit，因为使用带有 XML 扩展名的硬编码文件名可以正常工作。我已经尝试了所有常用的编码例程，但没有运气。是否有一种方法或语法可以在 Joomla2.5 中使用？

**完整的上下文：**

```
<script type='text/javascript'>
  var s1 = new SWFObject('http://www.myserver.com/v5.7/player.swf', 'player', '420', '315', '9.0.124', '#FFFFFF');
  s1.addParam('allowfullscreen',    'true');
  s1.addParam('allowscriptaccess',  'always');
  s1.addVariable('streamer',        'rtmp://streaming.myserver.com/');
  s1.addVariable('playlistfile',    'http://www.myserver.com/playlist.php?s=123&u=789');
  s1.write('mediaspace1');
</script> 
```

另外，我知道有更新的和其他加载 JW 播放器的方法，但这是转换许多网站的临时步骤，并且必须保留一些旧代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T17:21:22.173

在“通常的编码”中，您是否在添加播放列表文件变量时尝试过“encodeURIComponent()”？不确定 PHP 编码是否会完成它，但 Flash 将无法正确处理它。

# php - 当我已经有了 GET 方法时使用？在我的查询字符串中

> ID：11692856
> 
> 赞同：2
> 
> 时间：2012-07-27T17:38:35.847
> 
> 标签：php, forms, get

这似乎是一个很容易回答的问题，但我不知道该怎么做，或者是否有可能。

我正在构建一个搜索栏，以便用户可以在网站上搜索优惠。它使用该`POST`方法工作，但它不会更新查询字符串，我希望用户能够看到他们搜索的内容，所以我必须使用该`GET`方法。

我的网址设置如下：

`http://mysitename.com/index.php?rs=offers`

定义在`?rs=offers`报价页面上。如果没有`?rs=`它，它将直接注册为访问 index.php 文件，并给出错误。这就像一个反黑客的东西。

我想知道的是如何在`GET`之后启动该方法，`?rs=offers`因此它的内容如下：

`http://mysitename.com/index.php?rs=offers&find=whatisearched`

现在它看起来像这样：

`http://mysitename.com/index.php?find=whatisearched`

这给出了我上面描述的错误。

这也是当前的表单布局，因此您可以查看其中是否存在我可能定义错误的内容。

```
<form method='get' action='index.php?rs=offers'>
    <table class='offers'>
<tr>
    <th>Search All Offers</th>
</tr>
<tr> 

    <td>

      <input type='text' name='find' maxlength='255' style='width:200px' value='' />

      <input type='submit' value='Search' />

    </td>

  </tr>

</table>
</form> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T17:42:07.827

试试这个：

```
<form method='get' action='index.php'>
    <input type='hidden' name='rs' value='offers' />
    .
    .
    .
</form> 
```

# go - 如何使用 Go 有效地下载大文件？

> ID：11692860
> 
> 赞同：126
> 
> 时间：2012-07-27T17:38:52.083
> 
> 标签：go

有没有办法使用 Go 下载大文件，将内容直接存储到文件中，而不是在将内容写入文件之前将其全部存储在内存中？因为文件太大，所以在将其写入文件之前将其全部存储在内存中会耗尽所有内存。

* * *

## 回答 #1

> 赞同：236
> 
> 时间：2012-07-27T17:50:30.117

我假设您的意思是通过 http 下载（为简洁起见，省略了错误检查）：

```
import ("net/http"; "io"; "os")
...
out, err := os.Create("output.txt")
defer out.Close()
...
resp, err := http.Get("http://example.com/")
defer resp.Body.Close()
...
n, err := io.Copy(out, resp.Body) 
```

http.Response 的主体是一个 Reader，因此您可以使用任何带有 Reader 的函数，例如一次读取一个块而不是一次读取所有块。在这种特定情况下，`io.Copy()`会为您完成繁重的工作。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2015-11-22T10:38:43.267

史蒂夫 M 答案的更具描述性的版本。

```
import (
    "os"
    "net/http"
    "io"
)

func downloadFile(filepath string, url string) (err error) {

  // Create the file
  out, err := os.Create(filepath)
  if err != nil  {
    return err
  }
  defer out.Close()

  // Get the data
  resp, err := http.Get(url)
  if err != nil {
    return err
  }
  defer resp.Body.Close()

  // Check server response
  if resp.StatusCode != http.StatusOK {
    return fmt.Errorf("bad status: %s", resp.Status)
  }

  // Writer the body to file
  _, err = io.Copy(out, resp.Body)
  if err != nil  {
    return err
  }

  return nil
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2016-01-19T11:21:30.220

上面使用的答案`io.Copy`正是您所需要的，但如果您对恢复中断下载、自动命名文件、校验和验证或监控多个下载的进度等附加功能感兴趣，请查看[抓取](https://github.com/cavaliercoder/grab)包。

* * *

## 回答 #4

> 赞同：-7
> 
> 时间：2014-01-25T13:59:02.723

1.  这是一个示例。[https://github.com/thbar/golang-playground/blob/master/download-files.go](https://github.com/thbar/golang-playground/blob/master/download-files.go)

2.  另外我给你一些代码可能会对你有所帮助。

代码：

```
func HTTPDownload(uri string) ([]byte, error) {
    fmt.Printf("HTTPDownload From: %s.\n", uri)
    res, err := http.Get(uri)
    if err != nil {
        log.Fatal(err)
    }
    defer res.Body.Close()
    d, err := ioutil.ReadAll(res.Body)
    if err != nil {
        log.Fatal(err)
    }
    fmt.Printf("ReadFile: Size of download: %d\n", len(d))
    return d, err
}

func WriteFile(dst string, d []byte) error {
    fmt.Printf("WriteFile: Size of download: %d\n", len(d))
    err := ioutil.WriteFile(dst, d, 0444)
    if err != nil {
        log.Fatal(err)
    }
    return err
}

func DownloadToFile(uri string, dst string) {
    fmt.Printf("DownloadToFile From: %s.\n", uri)
    if d, err := HTTPDownload(uri); err == nil {
        fmt.Printf("downloaded %s.\n", uri)
        if WriteFile(dst, d) == nil {
            fmt.Printf("saved %s as %s\n", uri, dst)
        }
    }
} 
```

# c# - 没有绑定的组合框验证

> ID：11692862
> 
> 赞同：0
> 
> 时间：2012-07-27T17:38:56.763
> 
> 标签：c#, wpf, validation, data-binding, combobox

这个问题是基于[这个解决方案](https://stackoverflow.com/questions/6236047/validationrules-without-binding)的，但我不知何故无法使用组合框来解决这个问题。我想验证单击提交按钮后，组合框有一个选定的项目并且不为空。请注意，我不是故意绑定任何东西，也不是因为我不知道如何绑定。但是，如果答案是我无法在没有绑定的情况下使用验证规则（特别是针对 ComboBoxes，我已经通过链接解决方案对文本框进行了此操作），请告诉我。

这是我到目前为止所拥有的：

XAML：

```
<ComboBox DataContext="{StaticResource ChargeAssigneeViewSource}" Name="ChargeAssigneeBox" ItemsSource="{Binding}" Width="85">
    <ComboBox.SelectedItem>
        <Binding RelativeSource="{RelativeSource Self}" Path="GetType" Mode="TwoWay">
            <Binding.ValidationRules>
                <my:ComboBoxValidationRule ErrorMessage="Please select an Assignee" />
            </Binding.ValidationRules>
        </Binding>
    </ComboBox.SelectedItem>
</ComboBox> 
```

验证规则：

```
class ComboBoxValidationRule : ValidationRule
{
    private string errorMessage;

    public string ErrorMessage
    {
        get { return errorMessage; }
        set { errorMessage = value; }
    }
    public override ValidationResult Validate(object value, CultureInfo cultureInfo)
    {
        if (value == null)

            return new ValidationResult(false, ErrorMessage);

        return new ValidationResult(true, null);

    }
} 
```

按钮点击：

```
private void AddAnHours()
    {
        Employee currEmployee;

        if (!ValidateElement.HasError(ChargeAssigneeBox))
        {
            if (!ValidateElement.HasError(analystTimeTxtBox))
            {
                currEmployee = ChargeAssigneeBox.SelectedItem as Employee;
                item.AddTime(currEmployee, DateTime.Now, double.Parse(analystTimeTxtBox.Text));
                analystTimeTxtBox.Clear();
                ChargeAssigneeBox.SelectedItem = null;
            }
        }

        UpdateTotals();

    } 
```

我得到的错误在这一行：

```
currEmployee = ChargeAssigneeBox.SelectedItem as Employee; 
```

但是我的 ItemsSource 绑定正确，因此即使我选择了一个项目，所选项目也不会将其转换为员工对象。我怀疑这与我将其绑定到的内容有关：

```
<Binding RelativeSoruce="{RelativeSource Self}" Path="GetType"....> 
```

帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:20:50.280

您不能将属性绑定到组合框上的 selectedItem，然后检查该属性是否为空？

```
 Public string SelectedComboboxItem { get; set; }

     <ComboBox DataContext="{StaticResource ChargeAssigneeViewSource}"  SelectedItem="{Binding SelectedComboboxItem}" Name="ChargeAssigneeBox" ItemsSource="{Binding}" Width="85"> 
```

# jquery - 为什么设置时我的文本输入边框不显示？

> ID：11692868
> 
> 赞同：2
> 
> 时间：2012-07-27T17:39:17.230
> 
> 标签：jquery, css

我正在尝试将红色边框颜色的错误类应用于我的文本输入字段，如下所示：

jQuery

```
//save
...
$("input.required").each(function(){
    if ($.trim($(this).val()).length == 0){                               
        $(this).addClass("form_error");
        formValid = false;
    }
    else{
        $(this).removeClass("form_error");
    }
}); 
```

HTML

```
<div class="control-group">
  <label class="control-label" for="city_id">City</label>
  <div class="controls">
    <input class="span2 required" type="text" value="" name="test" id='testId'/>
  </div>
</div> 
```

CSS

```
textarea,
input[type="text"]{
  border: 1px solid #cccccc;
}

.form_error {
  border-color: #ee5f5b;
  border: 1px solid #ee5f5b;
} 
```

这适用于我的选择元素，但不适用于文本输入。知道我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:59:31.667

如果我删除了这对我有用

```
textarea,
input[type="text"]{
  border: 1px solid #cccccc;
} 
```

部分。我猜你的课程正在被应用，但元素样式最后被应用并最终获胜。

如果删除上面的部分不是一个选项，您也可以尝试将 .form_error 更改为

```
.form_error {
  border-color: #ee5f5b;
  border: 1px solid #ee5f5b !important;
} 
```

这将确保 .form_error 的样式优于元素样式。这有点笨拙，但它会起作用（至少在我正在测试的 Chrome 中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:42:21.077

您可能还需要指定边框样式：

```
border: 1px solid #ee5f5b; 
```

# javascript - d3.js 的正式分类是什么？框架？图书馆？包裹？

> ID：11692871
> 
> 赞同：0
> 
> 时间：2012-07-27T17:39:25.267
> 
> 标签：javascript, frameworks, packages, d3.js

我一直在使用 d3.js，但不知道它如何融入软件开发的宏大范围。

*   它使用 JavaScript
*   它位于 DOM 之上
*   有一种非常有趣的（有时甚至是声明式的）编码风格
*   它可以使用 SVG，但不必

它的正式分类是什么？

它真的可以是一个框架吗？它实际上是否提供了控制的骨架/反转？或者它基本上只是一个图书馆？或者它是一个包等？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T18:57:14.460

> *“D3.js 是一个用于操作文档的**JavaScript 库[…]”***

来源：[http ://d3js.org](http://d3js.org)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-09T03:05:42.490

它基本上是一个结合了 DOM 操作框架的数据处理/几何库。D3 有很多有用的通用函数，可用于任何与数据相关的事情。但它还包括一个专门用于操作 DOM 的框架。

使用 d3 DOM 框架时，控制反转非常明显。例如 attr() 方法接受 2 个参数，一个字符串和一个函数，d3 执行该函数并将其返回值分配给 DOM 元素作为字符串中指定的属性。

所以，正式地，我将 d3 归类为框架或库......？？也许？或者，如果这仍然太不正式，那么无论如何，我们是程序员，无论如何我们都会为所有这些词编造意义。

# java - 在 Ubuntu 服务器上安装 Java

> ID：11692901
> 
> 赞同：14
> 
> 时间：2012-07-27T17:41:27.100
> 
> 标签：java, ubuntu, amazon-ec2

有人知道在 Ubuntu 上安装 java 的过程吗？

我在云中使用 Amazon 设置了我的服务器。

我希望在我的服务器上运行一些 java 服务器，并很快注意到我需要安装 java。

有人可以通过一些步骤为我指明正确的方向吗？

我查看了一些网站，但是在命令行中，当我输入 sudo nano /etc/apt/source.list 时，该文件是一个新文件……我读过应该是一个现有文件。正确的？

提前致谢。:)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-27T17:47:52.727

如果您具有终端访问权限，具体取决于您正在寻找的 Java 版本，它将是这样的。

```
sudo apt-get install openjdk-6-jre 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T17:57:45.937

我使用 Sun/Oracle JDK。您可以下载 JDK .sh 文件。运行它，它会自行解压。将 bin 目录添加到您的路径中，您就可以使用它了。这不需要 root 访问权限，您可以通过这种方式安装任意数量的版本。

# linux - 运行 xmodmap ~/.xmodmap-`uname-n` 时出错

> ID：11692908
> 
> 赞同：0
> 
> 时间：2012-07-27T17:41:36.093
> 
> 标签：linux, xmodmap

我刚刚安装了 xkeycaps 并修改了我的键盘布局中的一个键。所以保存后，xkeycaps 说我应该修改登录脚本添加：

```
xmodmap ~/.xmodmap-`uname-n` 
```

但是当我运行那条线时，我得到了这个：

```
xmodmap ~/.xmodmap-`uname-n`
uname-n: command not found
xmodmap:  unable to open file '/home/tirengarfio/.xmodmap-' for reading 
```

知道为什么会出现这个错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T18:02:17.317

你要

```
xmodmap ~/.xmodmap-`uname -n` 
```

`uname`注意和之间的额外空格`-n`。

# python - 在 Windows 上部署 Python 程序并获取大型库依赖项

> ID：11692909
> 
> 赞同：4
> 
> 时间：2012-07-27T17:41:38.347
> 
> 标签：python, windows, deployment, opencv, numpy

我有一些依赖于几个大库的小型 Python 程序，例如：

*   NumPy 和 SciPy
*   matplotlib
*   PyQt
*   开放式CV
*   太平船务

我想让 Windows 用户更容易安装这些程序。目前我有两个选择：

*   使用 PyInstaller、py2exe 或类似工具创建*巨大的可执行包，*
*   或编写分步手动安装说明。

可执行包太大了。我总是觉得发生了一些神奇的事情，下次我使用不同的库或新的库版本时，它可能会或可能不会起作用。我也不喜欢浪费空间。手动安装太容易出错，步骤太多：*下载这个特定的解释器版本，下载numpy、scipy、pyqt、pil二进制文件，确保它们都是为相同的python版本和相同的平台构建的，然后安装一个另一个，下载并解压 OpenCV，将它的 .pyd 文件复制到 Python 安装的深处，设置环境变量和文件关联......*你看，很少有用户会有耐心和自信去做这一切。

我想做的事：只分发一个小的 Python 源代码，可能还有一个安装脚本，它获取并安装所有*缺少*的依赖项（正确的版本、正确的平台、以正确的顺序安装它们）。对于任何 Linux 包管理器来说，这都是一项微不足道的任务，但我只是不知道哪些工具可以在 Windows 上完成它。^(是否有可以从依赖项1)的 URL 列表生成 Windows 安装程序的简单工具？

¹ *您可能已经注意到，我列出的大多数库都不能使用 pip/easy_install 安装，但需要运行它们自己的安装程序并修改一些文件和环境变量。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:03:16.920

npackd 存在[http://code.google.com/p/windows-package-manager/](http://code.google.com/p/windows-package-manager/) 它可以通过这里完成或使用带有easy_install的distribute（python 3.x）或setuptools（python 2.x），可能是pip（don '不知道它的Windows兼容性）。但我会选择 npackd，因为 PyQt 和 pip/easy_install 的不寻常设置（不能很好地使用它们，使用 configure.py 而不是 setup.py）。尽管您必须为 npackd 创建自己的存储库以用于其中一些。我忘记了它对 python 库的贡献。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T18:29:01.333

AFAIK 没有工具（我假设你用谷歌搜索），所以你必须自己制作一个。

获取正确的库版本似乎很简单——使用 python 的[ftplib](http://docs.python.org/library/ftplib.html)，您可以为每个库获取正确的安装程序。你怎么知道哪个版本与用户的 python 兼容？您可以存储不同的下载 URL 列表，每个列表用于不同的 python 版本（这个方法突然出现在我的脑海中，可能有更好的方法；如果它简单并且有效，这并不重要）。

在弄清楚如何让每个安装程序运行之后，您可以 py2exe 安装程序脚本，甚至使用它来获取程序本身。

* * *

### 编辑

### 一些注意事项

正如我发布的那样，有几件事突然出现在我的脑海中：首先，一些伪代码（无论如何我将如何处理它）

```
#first, we check modules
try:
    import numpy
except ImportError:
    #flag numpy for installation
#lather, rinse repeat for all dependencies

#next we check version compatibility -- note that if a library version you need 
#is not backwards-compatible, you're in DLL hell, and there is little we can do.
<insert version-checking code here>

#once you have your unavailable dependencies, you install them
import ftplib
<all your file-downloading here>

#now you install. sorry I can't help you here. 
```

您可以做一些事情来使您的实用程序可重用——

*   将所有 URL 列表、最低版本号、所需库名称等放入配置文件
*   编写一个脚本来帮助您设置安装程序
*   Py2exe 安装程序制造商脚本
*   卖掉
*   更好的是，在 GPL 下发布它，这样我们就可以尽情享受您的劳动成果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-06T20:59:36.790

我和你有类似的需求，但另外我需要打包的应用程序在多个平台上工作。我目前正在探索当前可用的解决方案，这里有一些有趣的解决方案：

*   使用[SnakeBasket](https://github.com/prezi/snakebasket)，它环绕 Pip 并添加递归依赖解析和启发式方法，以便在发生冲突时选择正确的版本。
*   将所有依赖项打包为一个鸡蛋，但不是您的源代码，它仍然可以编辑：[https ://stackoverflow.com/a/528064/1121352](https://stackoverflow.com/a/528064/1121352)
*   将所有依赖项打包在一个 zip 文件中并直接动态导入模块：[py2exe 的跨平台替代方案](https://stackoverflow.com/questions/9035424/cross-platform-alternative-to-py2exe)或[http://davidf.sjsoft.com/mirrors/mcmillan-inc/install1.html](http://davidf.sjsoft.com/mirrors/mcmillan-inc/install1.html)
*   使用构建：[http ://www.buildout.org/en/latest/install.html](http://www.buildout.org/en/latest/install.html)
*   将[virtualenv](http://dabapps.com/blog/introduction-to-pip-and-virtualenv-python/)与[virtualenv-tools](https://github.com/fireteam/virtualenv-tools)一起使用（而不是“重新定位”）
*   如果您在使用 PyInstaller 或类似工具冻结代码时的主要问题是您最终得到一个大的单个文件，您可以自定义该过程以便获得多个文件，每个文件对应一个依赖项，而不是一个大的可执行文件。

如果我找到能满足我的账单的东西，我会在这里更新。

# xml - TFS and SSIS - Automatic checkout issue

> ID：11692916
> 
> 赞同：1
> 
> 时间：2012-07-27T17:41:50.037
> 
> 标签：xml, tfs, ssis

Is there a way to ignore the xml changed in a dtsx file when it checks out automatically (opens, executes), even if there have not been any changes to package behaviour?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-23T16:01:59.693

I also had a similar issue to this recently and I have seen it in the past when working on previous projects.

I believe that the issue stems from the fact that the .database file is not included in the source control by default and this causes the dtproj file to be amended each time it is opened.

I found a fix for it that worked in my situation and blogged it here: [http://blogs.adatis.co.uk/blogs/jeoc/archive/2015/03/20/18156.aspx](http://blogs.adatis.co.uk/blogs/jeoc/archive/2015/03/20/18156.aspx)

To summarise the changes that you need to make (if it is caused by the same issue) you should do the following:

1.  Unload the affected SSIS project(s)
2.  Edit the .dtproj files to point to the correct .database file
3.  Add the .database file to source control
4.  Check in the changes.
5.  Reload the project and ensure it doesn't automatically check-out
6.  Ensure all users do a get latest on the solution.

Hopefully this helps, if not please let me know what happens and perhaps there is another solution. Kind regards

Jon

# c# - 具有内置审计跟踪的 ORM

> ID：11692917
> 
> 赞同：3
> 
> 时间：2012-07-27T17:41:55.867
> 
> 标签：c#, asp.net-mvc, orm, audit-trail

我正在设计一个带有数据库后端的 ASP.NET MVC Web 应用程序，该应用程序需要完整的审计跟踪以用于监管目的。

我过去已经实现了审计跟踪，但感觉使用带有内置功能的 ORM 工具会更安全。看起来 NHibernate 将是一种方法——你能推荐其他选择吗？

澄清一下 - 我对辩论或 ORM 比较不感兴趣。我实际上是在询问哪些 ORM 工具内置了对审计跟踪的支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T12:33:33.287

我认为您可以在所有完整的 ORM 中拦截实际的 db 操作（但通常不能在像 dapper 这样的微 ORM 中）。您可以捕获新记录、删除和修改，包括对象的原始和修改状态。

这是 Linq2SQL 中的一个示例，它使用 Newtonsoft 将属性转储到 StringBuilder（将代码添加到 DataContext 类）：

```
 public override void SubmitChanges(System.Data.Linq.ConflictMode failureMode)
    {
        var changes = GetChangeSet();
        var inserts = changes.Inserts;
        var deletes = changes.Deletes;
        var updates = changes.Updates;

        var sbLog = new StringBuilder();

        sbLog.AppendLine("Inserts:");
        sbLog.AppendLine(Newtonsoft.Json.JsonConvert.SerializeObject(inserts, Newtonsoft.Json.Formatting.Indented,
            new Newtonsoft.Json.JsonSerializerSettings { ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore }));

        sbLog.AppendLine("Deletes:");
        sbLog.AppendLine(Newtonsoft.Json.JsonConvert.SerializeObject(deletes, Newtonsoft.Json.Formatting.Indented,
            new Newtonsoft.Json.JsonSerializerSettings { ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore }));

        sbLog.AppendLine("Updates:");
        foreach(object x in updates) {
            var original = this.GetTable(x.GetType()).GetOriginalEntityState(x);

            sbLog.AppendLine(Newtonsoft.Json.JsonConvert.SerializeObject(new { original = original, mod = x },
                Newtonsoft.Json.Formatting.Indented,
                new Newtonsoft.Json.JsonSerializerSettings { ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore }));
        }

        //"logger" can be anything, you use to log the changes...
        logger.Info(("db operations:" + Environment.NewLine + sbLog.ToString()).Replace(Environment.NewLine, Environment.NewLine + " | "));

        base.SubmitChanges(failureMode);
     } 
```

# android - Android菜单到CustomDailog - 应用程序强制关闭自己

> ID：11692921
> 
> 赞同：0
> 
> 时间：2012-07-27T17:42:09.647
> 
> 标签：android, android-menu, customdialog

这是我用于菜单项选择的代码：

```
public boolean onOptionsItemSelected(MenuItem item) {
      switch (item.getItemId()) {
      case R.id.menu_settings:
            showDialog(1);
            return true;

      default:
            return super.onOptionsItemSelected(item);
      }
 } 
```

菜单中只有一个选项，我使用以下代码设计了一个 customDialog：

```
protected Dialog onCreateDialog(int id) {

        Context mContext = getApplicationContext();
        Dialog dialog = new Dialog(mContext);

        dialog.setContentView(R.layout.custom_dialog);
        dialog.setTitle("About Us");

        TextView text = (TextView) dialog.findViewById(R.id.text);
        text.setText("App Created By: Prateek Garg (garg.prateek1@gmail.com)");
        ImageView image = (ImageView) dialog.findViewById(R.id.image);
        image.setImageResource(R.drawable.logo_resumes);
        return dialog;
        }
} 
```

问题是每当我按下菜单项“关于我们”时，应用程序都会自行关闭。我无法纠正任何错误，但我希望你们可以。

提前致谢。PS。我在 onCreateOptionsMenu() 中创建了 menuInflator() 。

干杯

LOGCAT 显示以下错误：[我不知道如何理解或删除它们... :( ]

> 07-27 23:35:04.569: W/dalvikvm(648): threadid=1: 线程以未捕获的异常退出 (group=0x40a13300)
> 
> 07-27 23:35:04.659：E/AndroidRuntime(648)：致命异常：主要
> 
> 07-27 23:35:04.659: E/AndroidRuntime(648): android.view.WindowManager$BadTokenException: 无法添加窗口 -- 令牌 null 不适用于应用程序
> 
> 07-27 23:35:04.659: E/AndroidRuntime(648): 在 android.view.ViewRootImpl.setView(ViewRootImpl.java:589)
> 
> 07-27 23:35:04.659: E/AndroidRuntime(648): at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:326) 等等。

如果你们这么说，我也会包括其余的错误，但我认为它们只是因为前 1 或 2 个而形成的，通常情况下

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:52:12.077

强制关闭很可能是空指针异常。实际上有几种方法可能会发生这种情况，但很可能其中一个 UI 元素不可用。这可能是因为它不在您为视图/对话框指定的布局中，或者因为您未能为视图调用 setContentView(R.layout.layoutName)。另一种可能性是像 TextView 这样没有指定高度和宽度值的项目。在大多数 UI 元素上，这是必需的，并且会导致运行时错误。为了看到logcat goto window->show view -->logcat

运行时错误将显示为红色。如果它关闭应用程序，它通常会包含致命的单词。所以转到 logcat 中的那个点。查找第一行，您可以在其中看到类似 com.mypackage.test.MyActivity 或 MyDialog 的内容。这条线将是红色的。确保它是带有您的包名称的一个，因为该错误也会指向很多系统内容。单击该行，它将带您到代码中发生崩溃的位置。同时发布错误。您应该始终在 StackOverflow 上发布错误消息。

# android - 有什么方法可以知道设备是否从 fastboot 启动？

> ID：11692923
> 
> 赞同：5
> 
> 时间：2012-07-27T17:42:15.427
> 
> 标签：android, android-intent

自从 HTC 开始使用 Fastboot 设置以来，应用程序依赖于

> **android.intent.action.BOOT_COMPLETED**

与HTC设备上的设备启动一起努力启动。我有一个类似的应用程序，它取决于上述意图操作。但是由于 HTC 通过使用 fastboot（使用的其他术语 - 休眠）以不同的方式关闭和打开电源，我的应用程序永远无法正常工作。我尝试使用[ACTION_USER_PRESENT](http://developer.android.com/reference/android/content/Intent.html#ACTION_USER_PRESENT)和[ACTION_SCREEN_ON](http://developer.android.com/reference/android/content/Intent.html#ACTION_SCREEN_ON)，但它似乎更像是破解而不是解决我的问题。你们中是否有人遇到过同样的问题并找到了更好的方法来处理它？请帮忙。库存单位

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-14T01:24:40.500

如果有人以 HTC Droid DNA 作为目标进行编程，我发现它的“快速启动”不会发送“ **android.intent.action.QUICKBOOT_POWERON** ”，而是发送“ **com.htc.intent.action.QUICKBOOT_POWERON** ” .

我希望这对某个地方的人有所帮助，因为我花了几个小时才弄清楚这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-27T23:52:09.703

我发现了 HTC 在快速启动开机和关机期间使用的意图操作。我想在这里分享它，因为它可能对与我面临同样问题的其他人有用。

这是您需要在 Receiver 下的 AndroidManifest.xml 中注册的意图操作。

```
<receiver android:name="com.my.app.MyReceiver">
     <intent-filter>
         <action android:name="android.intent.action.BOOT_COMPLETED"/>
         <action android:name="android.intent.action.QUICKBOOT_POWERON"/>
     </intent-filter>
</receiver> 
```

希望对您有所帮助

# c# - 跨多个方法处理变量的正确方法是什么？

> ID：11692924
> 
> 赞同：2
> 
> 时间：2012-07-27T17:42:18.713
> 
> 标签：c#

说我有一个`List<Objects>`. 我想在一种方法中定义对象列表，并在其他几种方法中使用它们。

这是我想出的方法，我正在寻找更多或正确的方法。

1.  您可以`List<Objects>`在使用它的每个方法中进行定义。
    *   优点：它有效。没有机会得到错误的变量。
    *   缺点：代码重复。
2.  您可以使用`List<Objects>`类中定义的私有并使用更新它`(ref ListObjects)`
    *   优点：我只需要定义一次。
    *   缺点：我觉得这是一种混乱和不好的做法。
3.  您可以`List<Objects>`作为参数传递给使用它的方法。
    *   优点：防止代码重复
    *   缺点：必须让我的填充函数返回函数，并向我的其他方法添加参数。可能与事件发生冲突？

所以这就是我想出的。我真的不确定使用哪个，或者是否有更好的方法来做到这一点。想法？

编辑：根据要求包括一些代码。

```
private List<MedicalPlan> medicalPlansList; 
```

这是清单。这是一个从数据库中获取信息的列表，这里：

```
private void BindMedicalList()
{
   medicalPlansList = new MedicalPlanRepository().RetrieveAll().Where(x => x.Year == year).ToList();
} 
```

然后它用于在该列表中查找对象，例如

```
var result =
                    medicalPlansList.FirstOrDefault(
                        c => c.CoverageLevels.Any(p => p.Id == id)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:46:02.150

一般来说，我会这样做。如果您总是在列表上使用相同的函数序列，请考虑创建一个链式函数来处理它。您也可以直接在其他函数调用之一中传递函数调用（只要它返回一个列表），但这往往看起来很混乱。

```
public List<int> DoSomethingWithList(List<int> list)
{
    //do stuff
    return list;
}

public List<int> DoSomethingElseWithList(List<int> list)
{
    //do other stuff
    return list;
}

public void SomeOtherFunction(string[] args)
{
    var list = new List<int>() { 1, 2, 3, 4 }; //create list
    list = DoSomethingWithList(list); //change list
    list = DoSomethingElseWithList(list); //change list further
} 
```

如果您正在使用具有`List<T>`字段的对象，我会这样做：

```
public class MyBigClass
{
    private List<int> myList;
    public MyBigClass()
    {
        //instantiate list in constructor
        myList = new List<int>() { 1, 2, 3, 4 }; 
    }

    public void PublicListAdder(int val)
    {
        myList.Add(val);
    }

    private void PrivateListCleaner()
    {
        //remove all even numbers, just an example
        myList.RemoveAll(x => x % 2 == 0);
    }
} 
```

您很少需要`ref`在 C# 中使用，因为它会自动为您处理指针。您（通常）不是在传递一个结构，而是在传递一个对象引用（基本上是一个指针）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:48:40.087

你的 #1 和 #2 真的没有意义：

1.  如果您在使用它的每个方法中定义不同的列表，那么您每次都使用不同的列表。这不是共享列表；这*不起作用*。如果您的意思是“调用从使用它的每个方法创建列表的方法”，那么同样适用：您每次都使用不同的列表。
2.  您不需要使用`ref ListObjects`来更新私人会员；私有成员仅通过其名称访问。这不是坏习惯。这是标准的面向对象实践。
3.  将所有必需的数据作为参数传递*到*方法中，使方法本质上更具可重用性，因为它减少了与方法所属类的耦合。

简而言之：#3 在一定程度上是一种很好的做法，因为它增加了代码的可重用性。然而，#2 的使用是我们进行面向对象编程的根本原因：使*您*免于向所有方法重复传递参数。这正是私有字段的设计目的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T17:55:07.997

在大多数情况下，我可能会选择安德斯的回答。根据您的情况，另一种值得考虑的方法是为 List 编写[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)。

```
namespace ExtensionMethods
{
    public static class MyExtensions
    {
        public static object DoSomething(this List<T> list)
        {
            //do the something with list
        }
    }   
} 
```

然后你可以像这样使用它：

```
var list = new List<int>();
list.DoSomething(); 
```

在该示例中，`list`作为参数传递给扩展方法。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-27T17:46:17.580

通常 a`List<T>`不应该属于实例的状态并公开，因为它是可变的，否则您可以从外部更改状态 - 除非您的 getter 旨在返回只读列表。除非您的设计明确允许这种可能性发生时。我的回复并没有真正回答您的问题，只是对良好的面向对象设计的建议。正如有人已经建议比我更好的那样，您可以在每种方法中来回传递一个列表并直接修改它。

# javascript - 悬停和移动没有给出预期的结果

> ID：11692927
> 
> 赞同：0
> 
> 时间：2012-07-27T17:42:30.553
> 
> 标签：javascript, jquery, html, css

因为我正在使用 Jquery 创建 DOM，所以很难复制输出，所以我添加了一张我使用一种工具捕获的代码图像

![在此处输入图像描述](../Images/f6384f464a210d4c2984a0cafa808ba4.png)

我已将悬停和鼠标悬停事件附加到`id='nf1'`使用此代码

```
$("#nf"+n).hover(function(){
    $("#nf"+$(this).attr("post_id")+"post_delete").show();
});
$("#nf"+n).mouseout(function(){
    $("#nf"+$(this).attr("post_id")+"post_delete").hide();
}); 
```

这里n是post_id，我正在循环从响应中获得的所有post_id。这个附加事件但没有给出预期的行为就像鼠标悬停在`id='nf1post_delete'`它上面时一样

请询问是否有任何疑问

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:49:38.573

按照您描述的方式，您实际上希望将两个函数传递给`.hover()`，一个用于 mouseenter 上的操作，一个用于 mouseleave 上的操作。您只能将一个函数传递给`.hover()`，但它会在您翻转和推出时运行该函数。

[http://api.jquery.com/hover/](http://api.jquery.com/hover/)

所以，试试这个：

```
$("#nf"+n).hover(function(){
    $("#nf"+$(this).attr("post_id")+"post_delete").show();
},function(){
    $("#nf"+$(this).attr("post_id")+"post_delete").hide();
}); 
```

`.mouseout()`根本不需要这个功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T17:52:13.107

首先，.hover() 包括 mouseenter 和 mouseleave。您是否将这两个功能都放在那里并且不使用其他事件。也不要使用 mouseout()。改用 mouseleave()。

所以你要么使用 hover(function(){},function(){}); 单独使用，或者使用 mouseenter() 和 mouseleave()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T17:56:25.323

由于您正在操作 DOM，因此我建议您使用 jQuery`.on()`而不是`.hover()`：

```
$(document).on({
  mouseover: function(){
    $("#nf"+$(this).attr("post_id")+"post_delete").show();
  },
  mouseout: function(){
    $("#nf"+$(this).attr("post_id")+"post_delete").hide();
  }
}, "#nf"+n); 
```

如果您在页面加载后在 DOM 中创建某些内容，则`.on()`有助于将事件侦听器附加到它。

[.on() 的 jQuery API](http://api.jquery.com/on/)

# ftp - 使用 ncftp 删除文件夹中所有文件和文件夹的命令

> ID：11692928
> 
> 赞同：3
> 
> 时间：2012-07-27T17:42:30.297
> 
> 标签：ftp, windows-server

我在远程服务器上有一个需要清除的文件夹。我需要删除此文件夹中的所有文件和文件夹。我不能删除并重新创建父文件夹，因为我不想弄乱权限。

例如：远程文件夹是 Development/
该文件夹包含几个文件和几个文件夹。
我想运行一个命令来完全清空 Development/ 文件夹并给我一个新的空版本。

我还需要它与 Windows FTP 客户端兼容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-30T22:52:05.183

由于您澄清了您不限于 ncftp，因此您应该使用[lftp](http://lftp.yar.ru/)代替，它内置了对使用`glob`and等操作的支持`rm -r`。这是一个完整的演示：

```
~/ftptest$ find .    # Test folder with a number of files and directories in it.
.
./dir1
./dir1/subdir1
./dir1/subdir1/subsubfile1
./dir1/subfile1
./dir2
./file1
./file2

~/ftptest$ lftp localhost    # Connect
Password:
lftp blahdiblah@localhost:~> cd ~/ftptest/    # cd to test folder
cd ok, cwd=/Users/blahdiblah/ftptest

lftp blahdiblah@localhost:~ftptest> ls    # The files are there...
total 0
drwxr-xr-x  4 blahdiblah  staff  136 Jul 30 15:40 dir1
drwxr-xr-x  2 blahdiblah  staff   68 Jul 30 15:40 dir2
-rw-r--r--  1 blahdiblah  staff    0 Jul 30 15:40 file1
-rw-r--r--  1 blahdiblah  staff    0 Jul 30 15:40 file2

lftp blahdiblah@localhost:~/ftptest> glob -a rm -r *    # the magic happens...
rm ok, 7 files removed

lftp blahdiblah@localhost:~/ftptest> bye
~/ftptest$ find .    # ...and then they're gone!
.
~/ftptest$ 
```

[文档](http://lftp.yar.ru/lftp-man.html)给出了完整的解释：

> **rm** [ **-r** ] [ **-f** ]*文件*
> 
> 删除远程文件。不扩展通配符，使用**mrm**。-r 用于递归目录删除。请注意，如果出现问题，您可能会丢失文件。-f 抑制错误消息。
> 
> **glob** [ **-d** ] [ **-a** ] [ **-f** ]*命令模式*
> 
> Glob 包含元字符的给定模式并将结果传递给给定命令。例如
> `glob echo *`
> 
> -f 普通文件（默认）
> -d 目录
> -a 所有类型

（请注意，`mrm`在这种情况下不可用，因为它也不会扩展`*`到包含目录。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-12-16T23:29:37.953

使用 ncftp -u [user.ftp] [backup.server] 登录 ftp 服务器

运行命令

> rmdir -r [文件夹]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-26T10:37:51.770

为了直接解决 OP 的问题，以下命令完全符合要求：

```
rm -r * 
```

确保导航到要删除内容的目录并发出命令。它删除当前目录内的所有目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T18:51:21.517

这是一个执行删除的 bash 脚本。

```
#!/bin/bash

# Script for retrieving all files on a an ftp server then deleting them.
#
# Requires ncftp and stock ftp client.
#
# We have to do some funkyness since there is no easy way of recursively deleting
#   remote directories.  We use ncftp to download all files and delete them on successfull
#   download. This ,however, leaves empty directories.  So we download the empty directory
#   tree to FSTREEDIR to list all directories to delete(we can't trust the download directory
#   because other directories may exist there). Those directories are then passed to the
#   usual ftp client to delete. 

# @todo - store credentials in a file

FTPSERVER=10.0.1.150
DOWNLOADDIR=/tmp/dl
FSTREEDIR=$DOWNLOADDIR/fstree
USERNAME=bart
PASSWORD=dude
DELETEREMOTEFILES=1

if [ $DELETEREMOTEFILES -eq 1 ]
 then
  DELFILESFLAG="-DD"
 else
  DELFILESFLAG=""
fi

echo "Downloading Reports...
"

cd $DOWNLOADDIR
ncftpget -u $USERNAME -p $PASSWORD -R $DELFILESFLAG ftp://$FTPSERVER

# Delete Files after download
if [ $DELETEREMOTEFILES -eq 1 ]
 then
    echo "Deleting Remote Reports...
    "

    RMSTRING=""

    # if fstree dir exists empty it and recreate it
    if [ ! -d "$FSTREEDIR" ]; then 
      mkdir $FSTREEDIR
    else
      rm -rf $FSTREEDIR/*
    fi

    # Copy remote directory structure to FSTREEDIR
    cd $FSTREEDIR
    ncftpget -u $USERNAME -p $PASSWORD -R $DELFILESFLAG ftp://$FTPSERVER

    # Generate list of directories to delete
    for D in `find $FSTREEDIR -type d| sort -r`
    do
      if [ ! "$D" = "$FSTREEDIR" ]; then
        RMSTRING="$RMSTRING 
        rmdir ${D#$FSTREEDIR/}"
      fi
    done

# Delete remote file structure
ftp -i -n <<EOF
open $FTPSERVER
user $USERNAME $PASSWORD
$RMSTRING
EOF

    # delete old FSTREEDIR
    rm -rf $FSTREEDIR

fi 
```

# html - 我无法让字体工作

> ID：11692935
> 
> 赞同：1
> 
> 时间：2012-07-27T17:42:40.167
> 
> 标签：html, css, font-face

我无法开始`font-face`工作（这就是我通常使用 Google 字体的原因）。但是客户有我必须使用的自己的字体。

我正在测试并与**[此站点](http://www.cphvision.dk/)**进行比较（主菜单）

这是我的**[小提琴](http://jsfiddle.net/5jMN3/1/)**

为什么我不能得到这份工作？另一个网站上的字体工作得很好。

这是我的CSS：

```
@font-face{
  font-family:'testFont';
  src:url('http://www.cphvision.dk/sites/all/themes/vision/webfonts/21B1BE_0_0.eot');
  src:url('http://www.cphvision.dk/sites/all/themes/vision/webfonts/21B1BE_0_0.ttf'), format('truetype');
}

ul li a {
font-family:'testFont', sans-serif;
  font-weight:normal;
} 
```

我也在我的本地服务器上进行了测试。也不在那里工作。
我之前曾在从 Google 下载的字体上使用 font-face 进行过测试。没有成功。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T17:50:42.287

我以前也遇到过字体问题。我知道当我使用它时，我没有用引号（​​单引号或双引号）包围 font-family 属性。此外，由于某种原因，将字体规则放在主样式表中似乎存在某种冲突，因此我将它们放在单独的样式表中，并将其放在主样式表的顶部：

```
@import url('font.css'); 
```

这是我的此规则的一个实例的快速示例，直接从文件中复制：

```
@font-face{
  font-family: Kalinga;
  src:url(kalinga.ttf);
}

@font-face{
  font-family: Kalinga;
  font-weight: bold;
  src: url(kalingab.ttf);
} 
```

我知道我没有在此处同时添加 ttf 和 eot，但这是一个很好的示例供您参考。我建议从 eot 或 ttf 开始，让一个工作，然后在完成后添加另一个（修补时要做的更改较少）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T18:23:53.803

我将推荐使用像[Font Squirrel](http://www.fontsquirrel.com/fontface/generator)这样的服务。我这样说是因为您可以上传字体，它会自动将其转换为`eot`、`ttf`等，并为您提供包含您的字体和一些示例文件的 zip 文件以帮助您入门。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T22:04:53.660

我知道这听起来很疯狂，但我很难让@font-face 使用绝对路径。但是，我一直将它与相对路径一起使用，并且效果很好。我也推荐[Font Squirrel](http://www.fontsquirrel.com)。您需要做的就是调整相对于您的字体来自其提供的生成工具包和代码的位置的 CSS 路径。当然，对于 Worpress，始终使用子主题来规避默认字体声明。

# objective-c - 如何将对象从一个数组移动到另一个数组

> ID：11692944
> 
> 赞同：0
> 
> 时间：2012-07-27T17:43:07.020
> 
> 标签：objective-c, nsmutablearray

我知道这个话题之前已经做过，但出于特定原因我想再次提出它，我有一个函数旨在将一个项目从一个数组移动到另一个数组，从它最初所在的数组中删除该项目，但无论何时我测试了一下，好像不行

```
-(void) moveOpperand: (NSMutableArray *) moveFrom :(NSMutableArray *) moveTo{
    NSString *opperandObject = [moveFrom lastObject];
    if (opperandObject) {
    [moveTo addObject:moveFrom.lastObject];
        [moveFrom removeLastObject];
    }
} 
```

上面的方法在这个方法中被调用

```
-(NSMutableArray *) giveHand: (NSMutableArray *) hand : (NSMutableArray *)refrenceDeck{

    for (int i=0; i<6; i++) {
        [self moveOpperand:refrenceDeck :hand];
    }
    return hand;
} 
```

当我尝试实现 currentHand 方法时，似乎发现了测试时的错误

```
-(NSMutableArray *) currentHand{
    if (_currentHand == nil) {

        self.currentHand = [self.myDeck giveHand:self.currentHand :self.myDeck.currentDeck];

    }
    return _currentHand;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T18:22:33.810

您可能没有在适当的时间将`_currentHand`变量设置为 nil，因此您可能没有正确的当前手牌，这可能使其“看起来”像是数组交换的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T18:01:31.070

如果你正在尝试做我认为这里是一个非常非常简单的类别，它应该适用于任何对象。

NSObject+Move.h

```
#import <Foundation/Foundation.h>

@interface NSObject (Move)

/*
 Returns true if it sucessfully moves the object between arrays.
 */
- (BOOL)moveFromArray:(NSMutableArray *)arrayA toArray:(NSMutableArray *)arrayB;

@end 
```

NSObject+Move.m

```
#import "NSObject+Move.h"

@implementation NSObject (Move)

- (BOOL)moveFromArray:(NSMutableArray *)arrayA toArray:(NSMutableArray *)arrayB
{
    if ([arrayA containsObject:self]) {
        [arrayA removeObject:self];
        [arrayB addObject:self];

        return YES;
    } else {
        return NO;
    }
}

@end 
```

# safari - Safari 6 的新开发者工具栏不会在 XHR/AJAX 请求中显示表单数据

> ID：11692946
> 
> 赞同：19
> 
> 时间：2012-07-27T17:43:15.280
> 
> 标签：safari

Safari 最近升级到第 6 版（Lion/Mtn Lion），他们已经从标准的 webkit 开发工具转变为一个更像 XCode 的工具，除了不喜欢事物变化的强迫症之外，我的问题是在资源选项卡中（或任何你可以追踪 DataService.aspx/AJAX 调用的地方）我再也看不到我正在传递的表单数据。

谁能指出我可以在哪里找到这些数据，这样我在测试新的数据服务/后端调用时就不必安慰我的参数了？

我已经向 Apple 记录了一个错误，他们已将其标记为重复，因此希望他们已收到足够的请求来修复此问题，在此之前我将继续使用 chrome，因为 webkit 开发人员与 safari 的旧版本相同。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-01T11:56:24.953

您可以在仪器选项卡（秒表图标）中找到此信息。在左侧边栏中的 Timelines 行中，单击右侧的灰色圆圈（录制按钮）。然后单击网络请求，您可以在其中看到所有请求，并且您必须单击右侧 oc 请求上的小图标以显示响应标头，并且所有表单数据都在右侧面板中可用。面板可以像左边一样隐藏（以防你看不到它）。[不幸的是，根据这个讨论](https://discussions.apple.com/thread/4142475?start=0&tstart=0)，没有列出查询参数。我相信它是 Safari 中的一个错误

2013 年 5 月 15 日编辑：此错误已在 Safari 6.0.3 中修复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T17:16:08.710

据我所知，没有办法显示请求参数。

这更进一步。我也看不到 JSON 响应数据（没有可点击的箭头来显示 JSON 中包含的 Javascript 对象，只是纯文本）

我认为我们必须切换到 Firefox /w Firebug 或常规 Webkit 才能获得 XHR 监控......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T19:49:56.043

伙计们，如果您想在 safari 6 中查看现在无法实现的发布数据，请安装 firebug lite 扩展程序，然后您就可以获得发布数据。我用过它，它适用于 safari 6

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T18:35:44.247

实际上，在使用资源视图或单击在时间线/网络请求视图中查看请求的内容时，请求标头、响应标头和查询参数位于右侧的详细信息侧边栏中。我也花了几分钟才找到。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-10-24T11:34:16.037

如果您需要查看设备实际发送的内容并且您的服务器在 Windows 机器上，我使用[http://www.Wireshark.org](http://www.Wireshark.org)并检查服务器端的事情。没有任何 WebKit 东西的解释并且非常有价值（例如 iOS 问题和“Blob”数据）。Mac 上也应该存在类似的网络监听。

# image - 使用输入参数动态创建图像

> ID：11692950
> 
> 赞同：1
> 
> 时间：2012-07-27T17:43:19.267
> 
> 标签：image, image-processing

我想动态地从头开始创建或使用一些输入参数更新图像来调整/播种图像。假设我有这张图片 - [http://cdn.smashingapps.com/wp-content/uploads/2009/07/patterns-mix.jpg](http://cdn.smashingapps.com/wp-content/uploads/2009/07/patterns-mix.jpg) - 我想通过增大花朵大小或改变颜色来调整它花。我想更新现有图像比从组中创建它更难。

我不是在寻找最终解决方案，但任何指向正确资源的指针都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:53:44.150

考虑使用[Processing](http://processing.org/)以编程方式生成此类图像。

它是一种简单的编程语言和环境，易于学习和上手。有[一系列免费教程](http://processing.org/learning/)可供使用。[马特·皮尔森 (Matt Pearson) 的《生成艺术](http://www.manning.com/pearson/)》一书是一本更具艺术倾向的介绍。

# bada - 如何下载 1.0.0 和 1.2.0 等低版本 SDK？

> ID：11692952
> 
> 赞同：0
> 
> 时间：2012-07-27T17:43:23.337
> 
> 标签：bada

我们正在开发一个 bada 基础 c++ 应用程序。我们需要为 Bada 1.0.0、Bada 1.2.0 和 Bada 2.0.x 提供应用兼容性。我们已经在 Bada 2.0.x 上成功构建和测试。现在我们正在尝试在 1.0 和 1.2 上测试应用程序，并且应用程序没有在这些版本的 Bada 操作系统上运行。所以，我认为我们需要在各自的 1.0 和 1.2 SDK 上构建应用程序。我们正在尝试查找上述 SDK 来构建应用程序，但我们无法从网络上找到 SDK 下载链接。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T13:40:35.793

首先，你需要知道bada 2.0环境支持所有版本的sdk，也就是说你可以用2.0环境构建1.0的bada应用程序，你应该在你的manifest中提到这一点

其次，并非所有版本都支持所有分辨率，这是说明这一点的模式：

版本的bada | 决议| 设备

* * *

1.0 | 480x800 | 第一波

* * *

1.1 | 240x400 | 波 575 , 波 578 , 波 723

* * *

1.2 | 480x800 | 第二波

* * *

2.0 | 480x800 | 第 3 波 2.0 | 320x480 | 波 M/Y 2.0 | 240x400 | 没有官方设备

因此，如果您在应用程序中选择例如 1.0，它应该在 1.0、1.2 和 2.0 设备上运行，您应该只注意 2.0 中支持和 1.2 和 1.1 中不支持的功能，以及方法在 2.0 SDK 中已弃用

希望我很清楚，如果没有，请询​​问；），最好的问候

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-21T06:56:06.973

查看三星 SDK 档案 - [http://developer.bada.com/devtools/archives#](http://developer.bada.com/devtools/archives#)

# git - 远程服务器更改 IP 地址后“git 似乎不是 git 存储库”

> ID：11692954
> 
> 赞同：1
> 
> 时间：2012-07-27T17:43:28.563
> 
> 标签：git

git 存储库托管在挂载到 Linux Ubuntu 的共享驱动器上。共享驱动器的 IP 地址已更改，环境变量（主机）已相应更新。但是，当推送到 shard 驱动器时，我得到“似乎不是 git 存储库”错误。这有什么原因以及如何解决它？谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T18:14:48.027

我感觉您的本地 git repo 使用硬编码的 IP 而不是环境变量。跑`git remote -v`看看是不是这样。如果是，则运行`git remote set-url <URL>`将其更改为环境变量。

# javascript - 如何检查是否在特定表单中选中了复选框？

> ID：11692955
> 
> 赞同：3
> 
> 时间：2012-07-27T17:43:30.650
> 
> 标签：javascript, jquery

我创建了一个 jQuery 函数来检查复选框是否被选中，如下所示：

```
if ($('input:checkbox:checked').length > 0){ } 
```

我有两个不同形式的两组复选框。当我使用上面的代码时，它会检查两种形式的复选框。我只想要`if`一种形式的条件。我怎样才能实现它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T17:45:04.223

你可以通过使用它的或等来包含你`form`的，`selector``id``class`

通过使用表单 ID

```
if ($('#yourFormId input:checkbox:checked').length > 0){ } 
```

通过使用表单类

```
if ($('.yourFormClass input:checkbox:checked').length > 0){ } 
```

通过使用形式的索引，eq(0) 为您提供第一种形式，而 eq(1) 为您提供第二种形式，依此类推...

```
if ($('form:eq(0) input:checkbox:checked').length > 0) { } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T17:47:16.137

您可以使用`:eq()`选择器。尝试以下操作：

```
if ($('form:eq(0) input[type="checkbox"]:checked').length > 0) { } // first form checkboxes
if ($('form:eq(1) input[type="checkbox"]:checked').length > 0) { } // second form checkboxes 
```

请注意，`:checkbox`选择器已*弃用*，您可以`input[type="checkbox"]`改用。

# postgresql - 在 Rails 3.1 中使用带有 .include 的 .where IN 子句向下和向上许多嵌套级别查找一组 ID

> ID：11692957
> 
> 赞同：1
> 
> 时间：2012-07-27T17:43:38.673
> 
> 标签：postgresql, ruby-on-rails-3.1

我想按班级学生过滤家长电子邮件地址列表。

这是我的模型的简化：

```
Class District
 has_many :schools
 has_many :families
 has_many :children, :through => :families
 has_many :parents, :through => :families
 has_many :enrollments, :through => :children
end

Class Enrollments
 belongs_to :child
 belongs_to :classroom
end 
```

电子邮件地址与父记录相关联，我想通过一组教室 ID 过滤电子邮件。

我可以让它工作：

```
idees = [49, 50]
current_district = District.first
@emails = current_district.parents.includes(:family => { :children => { :enrollments => {:classroom => { :program => :location }}}}).where("family_id IN (?)", idees)
# Returns families with ID 49 and 50 
```

但我无法让这样的事情发挥作用

```
idees = [49, 50]
current_district = District.first
@emails = current_district.parents.includes(:family => { :children => { :enrollments => {:classroom => { :program => :location }}}}).where("family.children.enrollments.classroom_id IN (?)", idees)
# Returns: PGError: ERROR:  cross-database references are not implemented: family.children.enrollment.classroom_id 
```

我做错了什么还是有另一种更好的方法来编写这个查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:32:23.650

下面的行是问题所在。

```
where("family.children.enrollments.classroom_id IN (?)", idees) 
```

将其更改为：

```
where("enrollments.classroom_id IN (?)", idees) 
```

# php - URL POST 未命中 isset($_POST)

> ID：11692959
> 
> 赞同：2
> 
> 时间：2012-07-27T17:43:53.223
> 
> 标签：php

我有一个简单的php测试页面如下

```
<?php
if(isset($_POST['hitme']))
{
    echo "hello world";
}
?> 
```

我正在点击此页面，`http://www.abc.com/page.php?hitme=true`但这并没有回应任何内容。这有什么问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T17:44:57.873

使用`$_GET['hitme']`，而不是`$_POST`，因为您在查询字符串中传递了值。 `$_POST`将保存通过 a 发送的值`<form action='post'>`，但不保存在查询字符串中传递的值。

```
if(isset($_GET['hitme'])) {...} 
```

建议阅读[PHP 的超全局数组之间的差异。](http://php.net/manual/en/language.variables.superglobals.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T17:45:18.747

`$_POST`仅包含作为 HTTP POST 请求的一部分*发布*到页面的变量。如果您在浏览器地址栏中输入地址，您发出的是 GET 请求，而不是 POST 请求，并且不会在`$_POST`. 即使您发出 POST 请求，查询字符串上指定的变量*仍将*仅在内部可用`$_GET`，因此对于此示例，无论哪种方式，您都使用了错误的数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T17:45:02.537

您必须在 URL 中使用`$_GET`而不是`$_POST`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-27T17:50:05.567

如果它在 URL 中，例如`http://example.com/index.php?hitme=true`，它在`$_GET`.

但是，如果您希望它在 中`$_POST`，则必须执行以下操作（非常基本的示例）：

```
<form method="post" action="page.php">
    <input type="checkbox" name="hitme" value="true" />
    <input type="submit" value="Post data!" />
</form> 
```

该脚本将允许用户根据需要进行检查，然后单击“发布数据！”。

`$_POST`但是，只要用户没有点击按钮，它就不会出现。至于`$_GET`，只要它在 URL 中，它就会在那里。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-27T17:56:20.400

或者你可以使用[`$_REQUEST['hitme']`](http://php.net/manual/en/reserved.variables.request.php)，这个会同时检查`$_POST['hitme']`和`$_GET['hitme']`

# javascript - 如何根据动态变化的百分比值为图像着色？

> ID：11692962
> 
> 赞同：1
> 
> 时间：2012-07-27T17:43:57.317
> 
> 标签：javascript, jquery, image, fill

我有一个图像，我想根据代表百分比的动态变化值填充一些颜色，例如，如果该值是 50%，则图像的一半应该被着色。

如何使用 JavaScript 来实现（可以使用 jQuery）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T18:30:27.910

您可以通过利用`clip`CSS 属性和一些添加的标记来为不显眼的背景颜色提供底层容器来实现这一点。

## 抽象的

在图像下方放置一个元素以进行人造颜色填充，并设置其尺寸和位置以匹配图像'。然后使用 JavaScript 动态剪辑图像 - 从而显示底层颜色 -`clip`根据您的需要更改图像元素的值（当然，您可以单独控制每个偏移量，例如左、下）。

***注意：**要具体实现您想要的效果，您可以更改底层元素以包含另一个适合您需要的图像（即空桶的顶部图像和满桶的底部图像）。*

## 执行

在此示例中，滑块用于触发值更改。

### 标记

```
<input type="range"  min="0" max="100" id="slider" value="100" />
<div id="underlay"></div>
<img src="http://placekitten.com/500/207" id="image" /> 
```

### 风格

```
#slider,
#image,
#underlay {
    /* absolute positioning is mandatory for clipped elements (#image) */
    position: absolute;
    left: 50px;
    width: 500px;
}
#image,
#underlay {
    top: 100px;
    height: 207px;
}
#image {
    /* initial clip state */
    clip: rect(auto, auto, auto, 500px);
}
#slider {
    top: 50px;
}
#underlay {
    background-color: #4C76A5;
} 
```

### 功能性

```
var img = document.getElementById('image');
var sld = document.getElementById('slider');

sld.addEventListener('change', function(e) {

    // get the slider value
    var val = e.srcElement.value;
    // calc the percentage to pass an absolute length value to the clip property
    var perc = img.width / 100 * val;

    // set the images' left offset clip accordingly
    img.style.clip = 'rect(auto, auto, auto, ' + perc + 'px)';
}); 
```

## 现场演示

*   **[在 jsFiddle 上](http://jsfiddle.net/eliranmal/WVeGM/)**

## 参考

*   [`clip`在 Mozilla 开发者网络上](https://developer.mozilla.org/en/CSS/clip)
*   [浏览器支持](http://caniuse.com/#search=clip)

# sed - 在模式后的第 n 行插入打印

> ID：11692964
> 
> 赞同：0
> 
> 时间：2012-07-27T17:44:05.737
> 
> 标签：sed

我最初的要求是在每个函数的入口处插入一个打印。由于非常困难，使用正则表达式，我找到了一个部分解决方案，为了实现相同的功能，我需要在我的函数名称后插入 printf。我认为它应该是函数名之后的一行。所以无论我的函数定义（这里的模式是我的函数名）出现，打印应该出现在该函数名之后的第二行（第一行可以是花括号。这就是我选择第二行的原因）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T18:06:44.433

`1`打印每一行。

```
awk -v fn=main '$2==fn{f=1} f{s++} s==3{print "  printf(\"%i\", 10);"; s=f=0} 1' foo.txt 
```

**foo.txt**

```
int main 
{
  return 0;
} 
```

**输出**

```
int main 
{
  printf("%i", 10);
  return 0;
} 
```

# c++ - 我如何在 void* 和 boost shared ptr 之间转换

> ID：11692968
> 
> 赞同：4
> 
> 时间：2012-07-27T17:44:12.393
> 
> 标签：c++, boost, casting, shared-ptr, void-pointers

我有这些行：

```
typedef boost::shared_ptr<A> A_SPtr;
void *f(void* var){ ... 
```

我希望能够做这样的事情：

```
A_SPtr instance = (void*)(var); 
```

我该怎么做？另外，我如何才能将含义从 shared_ptr 转换为 void*？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T17:54:42.097

只需将指向和来自的共享指针的指针强制转换为`void *`.

1.  `shared_ptr`至`void *`：

    ```
    f (reinterpret_cast<void *>;(&A_SPtr)); 
    ```

2.  `void *`回到`shared_ptr`：

    ```
    A_SPtr instance = * reinterpret_cast(boost::shared_ptr<A>*)(var); 
    ```

**注意：**这会将指向共享指针的指针传递给线程。如果共享指针在线程函数的生命周期内不存在，这将不起作用——否则，线程将拥有一个指向不再存在的对象（共享指针）的指针。如果您不能满足该要求，请在线程完成时将指针传递给**新**的shared_ptr 和`delete`它。（或使用`boost:bind`which 直接与共享指针一起使用。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T18:16:20.147

只要您确定可以假定`void*`f 中传递给您的所有权是可以的，`void*`并且实际上确实引用了一个`A`对象，并且您知道清理的正确方法，那么您就可以继续使用 smart指向所有权的指针：

```
typedef boost::shared_ptr<A> A_SPtr;

void *f(void *var){
    A_SPtr instance(static_cast<A*>(var));
} 
```

* * *

编辑：从问题中不清楚，但一些评论表明您实际上试图通过使用`void*`. 您可以按照对任何类型执行此操作的方式执行此操作：

```
void *f(void *var){
    A_SPtr *instance = static_cast<A_SPtr *>(var);
} 
```

你像这样传递指针：

```
A_SPtr a;
f(&a); 
```

与任何指针一样，您必须确保对象的生命周期足以使指针在`f`接收到它时有效。

# google-apps-script - 如何从 RESTful Web 服务获取 JSON 响应并对其进行解析以填充谷歌电子表格？

> ID：11692976
> 
> 赞同：1
> 
> 时间：2012-07-27T17:44:40.700
> 
> 标签：google-apps-script

我得到了这个使用 XML 的工作（感谢这里的帮助），但现在我需要对 JSON 响应做同样的事情。我需要解析响应并填充谷歌电子表格。非常感谢任何有关代码的帮助或指向我可以在哪里找到示例的指针！

这是网址“http://www.sciencebase.gov/catalog/items?s=Search&q=water&format=json&max=3”

这就是它返回的内容

{

```
"rel": "self",
"url": "https://www.sciencebase.gov/catalog/items?max=3&s=Search&q=water&
format=json",
"total": 475972,
"nextlink": {
    "rel": "next",
    "url": "https://www.sciencebase.gov/catalog/items?max=3&s=Search&q=water
     &format=json&offset=3"
},
"items": [
    {
        "link": {
            "rel": "self",
            "url": "https://www.sciencebase.gov/catalog/item/
         4f4e4a0ae4b07f02db5fb83c"},
        "id": "4f4e4a0ae4b07f02db5fb83c",
        "oldId": 1796213,
        "title": "Water Resources Data, Iowa, Water Year 2003--Volume 2\. 
         Ground Water and Quality of Precipitation", 
        "summary": "Water 
         resources data for Iowa for the 2003 water year consists of 
         records of ground water levels and water quality of ground-water 
         wells. This report volume contains water-level records for 166 ground-
         water observation wells; water-quality data for 150 municipal wells; 
         and precipitation-quality data for 2 precipitation sites.",
        "hasChildren": false
    },
    {
        "link": {
            "rel": "self",
            "url": "https://www.sciencebase.gov/catalog/item/
        4f4e4a62e4b07f02db6369dc"
        },
        "id": "4f4e4a62e4b07f02db6369dc",
        "oldId": 1800335,
        "title": "Reconnaissance of the water resources of Beaver County, 
         Oklahoma",
        "summary": "Ground water is the major source of water supply in 
         Beaver County. Because of the rapidly increasing demand for the 
         limited supply of water for irrigation, additional geologic and 
         hydrologic data are needed for management of ground-water resources. 
         This report presents general information on the availability of 
         ground water, on the chemical quality of water, and on streamflow. 
         The chemical quality of water generally is poorer than that of 
         water elsewhere in the Oklahoma Panhandle, and the ability to obtain 
         good quality water may become increasingly difficult as the water 
         resources are developed.\r\nFurther studies are needed to determine 
         the annual change in water levels, the rate of water-level decline in 
         heavily pumped areas, the volume of water stored in the ground-
         water reservoir, and the quantity of water that may be withdrawn 
         safely in a given area.",
        "hasChildren": false
    },
    {
        "link": {
            "rel": "self",
            "url": "https://www.sciencebase.gov/catalog/item/
        4f4e4a0de4b07f02db5fd2c3"
        },
        "id": "4f4e4a0de4b07f02db5fd2c3",
        "oldId": 1794688,
        "title": "Water Resources Data - Texas, Water Year 2003, Volume 6\. 
         Ground Water",
        "summary": "Water-resources data for the 2003 water year for Texas 
         consists of records of stage, discharge, and water quality of 
         streams; stage and contents in lakes and reservoirs; and water 
         levels and water quality in wells. Volume 6 contains water levels for 
         880 ground-water observation wells and water-quality data for 158 
         monitoring wells. These data represent that part of the National 
         Water Data System operated by the U.S. Geological Survey and 
         cooperating Federal, State, and local agencies in Texas.",
        "hasChildren": false
    }
] 
```

}

这是我拥有的代码，这是基于获取 XML 的返回

函数响应搜索（）
{

```
 var ss = SpreadsheetApp.getActiveSpreadsheet(); 
   var sheet1 = ss.getSheets()[0].setColumnWidth(2, 500);
   var cellSearch = sheet1

   // Get the response back from the url as a string
   var response = UrlFetchApp.fetch("http://www.sciencebase.gov/catalog/items?
   s=Search&q=water&format=json&max=3");

   // Parse the xml string, returns and xml document
   var parsedResponse = Utilities.jsonParse(response.getContentText());

   // for loop to display imported data down (a1:a10) the spreadsheet. Sets 
   a wider column width for 
   for (var i = 0; i < parsedResponse.items.item; i++) {
       var result = parsedResponse.items[i];
       var print = result.getElement("title").getText();
       var cellLtrs = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", 
       "l", "m", "n"];
       var cellLetter = cellLtrs[0];
       var cellNum = [i + 1];
       var both = cellLetter + cellNum;

  sheet1.setColumnWidth(1, 
  100).setActiveCell(both).setFontSize("9").setHorizontalAlignment("left").
  setVerticalAlignment("top").setValue(print);
 } 
```

}

再次感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T18:05:31.753

采用

```
var print = parsedResponse.items[i].title; 
```

# python - 用 swig 和 python 扩展全局 c 变量数组

> ID：11692985
> 
> 赞同：3
> 
> 时间：2012-07-27T17:45:21.103
> 
> 标签：python, arrays, global-variables, swig, extend

我在 c 中有一个全局变量数组，我想将其拉入 python。而且我在使用`varout`typemap 时遇到了困难：

```
/* example.c */
int foo[] = {0, 1}; 
```

这是非常普通的界面：

```
/* example.i */
%module example
%{     
 extern int foo[2];
%}

%typemap(varout) int foo[] {
  int i;
  //$1, $1_dim0, $1_dim1
  $result = PyList_New($1_dim0);
  for (i = 0; i < $1_dim0; i++) {
    PyObject *o = PyInt_FromLong((double) $1[i]);
    PyList_SetItem($result,i,o);
  }
}

%include "example.c" 
```

当我尝试使用以下 SConstruct 构建它时：

```
import distutils.sysconfig
env = Environment(SWIGFLAGS='-python -shadow -Wall'.split(),
                  CPPPATH=[distutils.sysconfig.get_python_inc()],
                  SHLIBPREFIX="")
env.SharedLibrary('_example.so', ['example.c', 'example.i']) 
```

`$1_dim0`未填充特殊变量，导致以下不可编译代码`example_wrap.c`：

```
SWIGINTERN PyObject *Swig_var_foo_get(void) {
  PyObject *pyobj = 0;

  {
    int i;
    //foo, , foo_dim1
    pyobj = PyList_New();
    for (i = 0; i < ; i++) {
      PyObject *o = PyInt_FromLong((double) foo[i]);
      PyList_SetItem(pyobj,i,o);
    }
  }
  return pyobj;
} 
```

很明显，类型映射匹配已经发生，但是缺少数组的维数。我错过了什么？对维度进行硬编码确实有效。

**一般来说，有没有办法`cvar`用 swig 扩展全局变量？**

```
$ swig -version
SWIG Version 2.0.4
Compiled with g++ [i686-pc-linux-gnu]
Configured options: +pcre
Please see http://www.swig.org for reporting bugs and further information 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T21:01:35.467

你的类型图几乎就在那里`varout`。你需要做两个小改动：

1.  您需要将大小添加`ANY`到`int foo[]`类型映射：

    ```
    %typemap(varout) int foo[ANY] {
      int i;
      //$1, $1_dim0, $1_dim1
      $result = PyList_New($1_dim0);
      for (i = 0; i < $1_dim0; i++) {
        PyObject *o = PyInt_FromLong((double) $1[i]);
        PyList_SetItem($result,i,o);
      }
    } 
    ```

    这确保您的类型映射与（任何）已知大小的数组匹配，而不仅仅是等价于`int *foo`.

2.  您需要修改 example.c 以使大小`foo`更清晰。就目前而言，它是合法且正确的 C，但推断数组的大小很棘手，除非您碰巧是一个完整的 C 编译器。将其更改为：

    ```
    int foo[2] = {0, 1}; 
    ```

    足以确保它与类型映射匹配`varout`。

通过这两项更改，生成的代码可以按您希望的方式工作：

```
SWIGINTERN PyObject *Swig_var_foo_get(void) {
  PyObject *pyobj = 0;

  {
    int i;
    //foo, 2, foo_dim1
    pyobj = PyList_New(2);
    for (i = 0; i < 2; i++) {
      PyObject *o = PyInt_FromLong((double) foo[i]);
      PyList_SetItem(pyobj,i,o);
    }
  }
  return pyobj;
} 
```

是这些更改在我的机器上生成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-20T16:12:43.710

对于像我这样思考如何处理非简单类型数组的人来说——这是一种方法：

非简单类型：

```
typedef struct {
    int a;
    float b;
} Foo; 
```

和一个全局数组：

```
extern Foo *foov[40];

%typemap(varout) Foo *foov[ANY] {
    int i;
    $result = PyList_New($1_dim0);
    for (i = 0; i < $1_dim0; i++) {
        PyObject *o = SWIG_NewPointerObj($1[i], SWIGTYPE_p_Foo, 0);
        PyList_SetItem($result, i, o);
  }
} 
```

刚刚分享了这个，因为我花了很长时间才发现，这篇文章很有帮助。只需要找出如何分配我的非简单类型的 SWIG 版本——发现埋在这里：

[http://www.swig.org/Doc2.0/Python.html#Python_nn64](http://www.swig.org/Doc2.0/Python.html#Python_nn64)

# java - 聊天应用程序，套接字与 RMI

> ID：11692994
> 
> 赞同：0
> 
> 时间：2012-07-27T17:45:56.737
> 
> 标签：java, sockets, rmi

我想构建一个聊天应用程序，并且对决定是使用套接字还是 RMI 来构建应用程序感到困惑。我听说 RMI 很难通过 Internet 配置和部署，因为这是我的意图，我想知道使用套接字或 RMI 哪个更合适。由于套接字或 RMI 中的 NAT 是否更容易解决问题？

如果我想在以后添加语音支持怎么办，它有助于决定走哪条路吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T18:59:02.360

**1.**对于像**Chat Messenger**这样的应用，我的**赌注是** `Sockets.`

**2.** `RMI`这里会**过杀**。

**3.**此外，`NAT`问题**不是**关于`Socket`或`RMI`，而是**关于静态IP。**

**4.**如果你想在网络上部署聊天服务器，**那么首先你必须有一个静态 IP，你需要让你的 ISP 为你提供其中一个，需要额外付费，或者互联网上有网站，那使您的动态 ips 为静态。**

**5.**但是如果你的服务器位于**本地局域网环境中，那么我认为你这样做不会有问题。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T18:03:05.677

两者都是可用于构建聊天服务器/客户端的合理选择。可以设置一个套接字来接收传入连接并为每个“chatter”启动一个新线程，或者可以使用 RMI 来创建一个分布式对象，客户端可以在该对象上调用方法。

RMI 基本上是在需要一些透明度和需要调用远程方法的分布式计算中经常使用的套接字层。它还允许到服务器的无状态连接。

如果您选择在 RMI 中实现服务器，请注意线程安全可能是一个问题。

对于本地服务器，使用纯套接字可能更容易。

有关 RMI 的更多详细信息： [http ://www.oracle.com/technetwork/java/javase/tech/index-jsp-136424.html](http://www.oracle.com/technetwork/java/javase/tech/index-jsp-136424.html)

# c# - VS2008找不到Winforms Trackbar控件

> ID：11692995
> 
> 赞同：0
> 
> 时间：2012-07-27T17:46:01.457
> 
> 标签：c#, winforms, visual-studio-2008

我一直在查看工具箱，但似乎找不到轨迹栏控件。

它隐藏在某个地方吗？或者它只是在设计器上不可用，而是我必须对其进行编码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:57:59.907

查看所有 Windows 窗体工具箱：

![在此处输入图像描述](../Images/b17a32ee8cc4dfe2a139f49cbc807cbf.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T18:05:10.417

右键单击`Controls`面板并选择`Choose Items ...`。

然后您可以向下滚动以选择它并确保它已启用。

# qt - 从 Qt Designer 上的不同项目中读取“资源”文件

> ID：11692999
> 
> 赞同：3
> 
> 时间：2012-07-27T17:46:16.720
> 
> 标签：qt, qt4, qt-creator, qt-designer

我正在使用 Qt 构建多个项目，我只想存储`resources`其中一个（普通项目），其中`resources`文件被集成到`.so`文件中。在其他项目中，我知道如何通过 引用这些`resources`文件`.so`，但不知道在 Qt Designer 上是否/如何实现。

我通过 New File 或 Project --> Qt --> Qt Resource File（文件和其他文件在选择对话框中被禁用）导入了包含文件的公共 prj 中的`.qrc`文件夹以及包含资源文件的子文件夹。`.qrc`“选择资源”对话框中仍然没有显示任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-07-03T06:44:14.533

有点晚了，但自从我来到这里...

选择资源对话框仍为空。你必须告诉 QT 在哪里可以找到资源。

1.  点击编辑资源
2.  单击按钮添加资源并选择 *.qrc 文件 资源（图标等）应该会显示出来并可以使用。