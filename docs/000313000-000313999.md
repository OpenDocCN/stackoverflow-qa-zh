# StackOverflow 问答 000313000-000313999

# css - IE CSS定位问题

> ID：313001
> 
> 赞同：1
> 
> 时间：2008-11-23T21:41:04.453
> 
> 标签：css, internet-explorer

我有一些在 Firefox 中有效但在 IE 中无效的弹出菜单的标记。问题是弹出窗口在其他元素下弹出并且不受 z-index 值的影响。下面是一个完整的可运行示例。

现在，我知道一个解决方法是不要将 div 定位为相对，但我不能这样做，因为在实际代码中，我使用的是 scriptaculous，它添加​​了“位置：相对”来做它需要做的事情做。此外，我认为这无关紧要。

是否有另一个修复程序可以使此代码同时适用于 IE 和 firefox？

例子：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><title>IE Problem</title>
<style type="text/css">
.mydiv{
  position: relative;
  background: yellow;
  border: solid 1px black;
}
table{background:black;} 
td.menu{background:lightblue}
table.menu
{
  position:absolute;
  visibility:hidden;
  z-index:999;
}
</style>
<script type="text/javascript">
function showmenu(elmnt){
   document.getElementById(elmnt).style.visibility="visible";
}
function hidemenu(elmnt){
   document.getElementById(elmnt).style.visibility="hidden";
}
</script>
</head>

<body>
<div class="mydiv" onmouseover="showmenu('one')" onmouseout="hidemenu('one')">

   <a href="#">div one</a><br />
   <table class="menu" id="one" width="120">
     <tr><td class="menu"><a href="#">Item 1</a></td></tr>
     <tr><td class="menu"><a href="#">Item 2</a></td></tr>
   </table>

</div>
<div class="mydiv" onmouseover="showmenu('two')" onmouseout="hidemenu('two')">

   <a href="#">div two</a><br />
   <table class="menu" id="two" width="120">
     <tr><td class="menu"><a href="#">Item 1</a></td></tr>
     <tr><td class="menu"><a href="#">Item 2</a></td></tr>
   </table>

</div>  
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-23T21:52:10.920

如果父级具有 position: relative 或 position: absolute，则 z-index 的范围在父级内。

您的示例的解决方案是添加 style="z-index: 2;" 到第一个“mydiv”和z-index：1；到第二个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-23T21:51:28.347

如果将 TABLE 移到 DIV 之外，它会起作用。希望这能满足您的需求？我想如果我是一个 DIV 并且你让我对我上面包含的东西进行 Z 排序，我也会感到困惑。

# .net - 奇怪的断断续续的 WPF 动画

> ID：313003
> 
> 赞同：2
> 
> 时间：2008-11-23T21:43:02.593
> 
> 标签：.net, wpf, animation

我正在制作一个在桌面上滚动信息的应用程序。窗户是透明的。我一开始很简单，试图找到用于动画制作的最低 CPU 使用率，我从一个简单的 TextBlock 开始。

在我的开发机器上，我通过设置 Canvas.Left 属性和 DoubleAnimation 在屏幕上获得了非常流畅的动画。但是，在另一台 Vista 计算机上，我每 6 到 7 秒就会出现大约 1 秒的延迟。在 XP 机器上，它再次非常流畅。我在其他 3 台机器上试过，它的好坏各占 50%。我在所有机器上都安装了 3.5 SP1。

系统上的 CPU 使用率永远不会超过 10%。我可以看到我没有做任何软件渲染。我桌面上的显卡是 nVidia Geforce 7xxx 系列，其中一台不稳定的机器使用的是 nVidia Geforce 88xx 卡。所有人都使用相同的驱动程序版本和最新的。屏幕分辨率通常是 1920x1080，除了我的开发机器要大得多（2560x1600）

但是 - 如果我使用 Perforator 来禁用脏区支持 - 它在所有机器上都很流畅，但 CPU 现在是 30%

我搞不清楚了。波涛汹涌的几乎就像发条一样。有问题的机器上没有其他事情发生，所有测试的机器都是 Core 2 Duos，大量的内存，最新的驱动程序，最新的服务包，我只是不知道还能做什么。我希望只是更高的 CPU 使用率，而不是滞后。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T09:06:38.953

如果您使用 AllowsTransparency 属性，您将遇到性能和兼容性问题。

技术解释在这里：

[http://blogs.msdn.com/dwayneneed/archive/2008/09/08/transparent-windows-in-wpf.aspx](http://blogs.msdn.com/dwayneneed/archive/2008/09/08/transparent-windows-in-wpf.aspx)

根据我个人（和痛苦）的经验，当您在屏幕上长时间显示 WPF 透明窗口时，一些显示驱动程序会破坏您的程序，而其他显示驱动程序会使 Windows 无法正常工作，我建议您尝试重新编写 GUI 以不使用透明度.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T01:52:42.253

我最近使用 WPF 创建的程序遇到了非常相似的问题。它在我正在使用的运行 windows server 2003 的构建机器上运行良好，但是当我将它切换到具有足够资源来运行程序的 XP 机器时，它变得非常不稳定。基本上它每秒获得一帧。动画的每一个刻度都会移动。我听说过这个问题，它会在动画完成一个周期（通过动画）后消失，但对我来说，它永远保持这种状态。

而且我没有使用 AllowsTransparency 属性，所以如果其他人有任何想法，我将非常感激。

（失败的机器也是Core 2 Duo）

谢谢，埃里克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T02:07:10.947

好的，我在发布我之前的声明后刚刚解决了这个问题。原来我还没有在这台电脑上安装我的图形驱动程序，并且在我安装之后它开始运行非常顺利。也许它以前使用了一些软件图形渲染或其他东西。因此，我建议您将图形驱动程序更新到可用的最新版本，看看这是否有助于解决问题。然而，原始海报似乎有一个不同的问题，因为他似乎正确安装了他的 fx 驱动程序。我不确定带有directx的nvidia 8800卡是否有任何问题。

谢谢，埃里克

# debugging - 如何一致地组织调试代码？

> ID：313004
> 
> 赞同：4
> 
> 时间：2008-11-23T21:44:48.610
> 
> 标签：debugging, logging, oop, coding-style

在需要调试的大型项目（就像每个项目一样）中工作时，您会意识到在 IDE 的内置调试器之前有多少人喜欢“printf”。我的意思是

*   有时您需要将变量值呈现到屏幕上（特别是用于交互式调试）。
*   有时将它们记录在文件中
*   有时您必须将可见性（使其公开）更改为另一个类才能访问它（例如记录器或渲染器）。
*   有时您需要将先前的值保存在成员中，以便在调试期间将其与新值进行对比
*   ...

当一个项目变得庞大而有很多人在做它时，所有这些调试特定的代码都会变得混乱，并且很难与普通代码区分开来。对于那些必须更新/更改其他人的代码或准备发布的人来说，这可能很疯狂。

你如何解决这个问题？

有命名标准总是好的，我猜*调试编码标准*应该非常有用（比如用 _DBG 后缀标记每个调试变量）。但我也猜想命名是不够的。也许将其集中到一个友好的跟踪器类中，或者创建一个强大的宏库以便在发布时将其全部删除。我不知道。

*如果您被要求为项目中的所有其他人编写调试编码文档以遵循，您会采用哪些设计技术、模式和标准？*

我不是在谈论工具、库或特定于 IDE 的命令，而是针对 OO 设计决策。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-23T22:06:49.627

不要提交调试代码，只需调试工具。

Loggin OTOH 在执行处理例程等中具有天然的地位。此外，一些常用 API 中的一些良好放置的日志记录语句也有助于调试。

就像一个日志语句来记录从系统执行的所有 SQL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-23T21:58:03.263

我的投票将支持您所描述的友好跟踪器课程。此类将保持所有这些集中，甚至可能允许您动态更改调试/日志记录策略。

我会避免使用宏之类的东西，因为那是编译器技巧，而不是真正的 OO。通过抽象调试/日志记录的概念，您有机会用它做很多事情，包括在需要时使其成为空操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-23T21:59:16.693

记录或调试？我相信设计良好且经过适当单元测试的应用程序不应该需要永久地进行调试。另一方面，日志在查找错误和审计程序操作方面都非常有用。我不会涵盖您可以在其他地方获得的大量信息，而是将您指向[logging.apache.org](http://logging.apache.org)以获得您可以使用的具体实现或用于合理设计日志基础设施的模板。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-23T22:05:52.140

我认为避免直接使用 System.outs / printfs 而是使用（甚至是自定义）日志记录类尤为重要。这至少为您提供了所有日志记录的集中终止开关（减去 Java 中的调用成本）。

让该日志类具有 info/warn/error/caveat 等也很有用。

我会小心错误级别、用户 ID、元数据等，因为人们并不总是添加它们。

此外，我见过的最常见的问题之一是人们在调试某些东西时将临时 printfs 放入代码中，然后忘记将它们放在哪里。我使用一个工具来跟踪我所做的一切，以便我可以快速识别自抽象检查点以来我最近的所有编辑并删除它们。但是，在大多数情况下，您可能希望对可以检入源代码控制的调试代码设置特殊规则。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T02:00:38.000

在我参与的每个项目中，我都被同样的问题所困扰，所以现在我养成了从一开始就广泛使用日志库（无论语言/平台提供什么）的习惯。任何[Log4X 端口](http://en.wikipedia.org/wiki/Log4J)都适合我。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-23T23:53:30.567

在VB6中你有

```
Debug.Print 
```

它将输出发送到 IDE 中的窗口。对于小型项目来说是可以忍受的。VB6也有

```
#If <some var set in the project properties>
'debugging code
#End If 
```

我有一个日志记录类，我在顶部声明

```
Dim Trc as Std.Traces 
```

并在各个地方使用（通常在#If/#End If 块内）

```
Trc.Tracing = True
Trc.Tracefile = "c:\temp\app.log"
Trc.Trace 'with no argument stores date stamp
Trc.Trace "Var=" & var 
```

是的，它确实变得一团糟，是的，我希望有更好的方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T00:12:33.913

我们通常开始使用我们写入跟踪消息的静态类。它非常基本，仍然需要从执行方法中调用，但它符合我们的目的。

在 .NET 世界中，已经有相当多的内置跟踪信息可用，因此我们无需担心调用了哪些方法或执行时间是多少。这些更适用于代码执行过程中发生的特定事件。

如果您的语言不支持通过其跟踪结构对消息进行分类，则应该将其添加到跟踪代码中。可以识别不同级别的重要性和/或功能领域的效果是一个很好的开始。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-24T00:23:07.340

只需避免通过修改代码来检测您的代码。学习使用调试器。使日志记录和错误处理变得容易。看看[面向方面的编程](http://en.wikipedia.org/wiki/Aspect-oriented_programming)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-24T00:44:44.050

调试/记录代码确实是侵入性的。在我们的 C++ 项目中，我们将常见的调试/日志代码包装在宏中——非常类似于断言。我经常发现日志记录在较低级别的组件中最有用，因此它不必无处不在。

同意和不同意的其他答案中有很多:) 拥有调试/记录代码可能是解决问题的非常有价值的工具。在 Windows 中，有许多技术 - 两个主要的技术是：

*   广泛使用已检查 (DBG) 构建断言*和*对 DBG 构建的大量测试。
*   在我们所说的“fre”或“retail”构建中使用 ETW。

已检查的构建（大多数人称之为 DEBUG 构建）对我们也非常有帮助。我们在 'fre' 和 'chk' 版本上运行所有测试（同样在 x86 和 AMD64 上，所有服务器的东西也在 Itanium 上运行......）。有些人甚至在已检查的版本上自行托管（dogfood）。这有两件事

1.  发现许多其他情况下不会发现的错误。
2.  快速消除嘈杂或不必要的断言。

在 Windows 中，我们广泛使用[Windows 事件跟踪](http://msdn.microsoft.com/en-us/library/bb968803.aspx)(ETW)。ETW 是一种高效的静态日志记录机制。NT 内核和许多组件都被很好地检测了。ETW有很多优点：

*   任何 ETW 事件提供程序都可以在运行时动态启用/禁用 - 无需重新启动或进程重新启动。大多数 ETW 提供程序提供对单个事件或事件组的精细控制。
*   来自任何提供者（最重要的是内核）的事件都可以合并到单个跟踪中，因此所有事件都可以关联起来。
*   合并后的迹线可以从盒子中复制出来并进行完全处理 - 带有符号。
*   NT 内核示例 pofile 中断可以生成 ETW 事件 - 这产生了一个非常轻量级的示例分析器，可以随时*使用*
*   在 Vista 和 Windows Server 2008 上，记录事件是无锁且完全支持多核的 - 每个处理器上的线程可以独立记录事件，而无需在它们之间进行同步。

这对我们来说非常有价值，也适用于您的 Windows 代码 - ETW 可用于任何组件 - 包括用户模式、驱动程序和其他内核组件。

我们经常做的一件事是编写一个流媒体 ETW 消费者。我没有将 printfs 放入代码中，而是将 ETW 事件放在有趣的地方。当我的组件运行时，我可以随时运行我的 ETW 观察程序 - 观察程序接收事件并显示它们、控制它们或用它们做其他有趣的事情。

我非常尊重地不同意 tvanfosson。即使是最好的代码也可以从良好实现的日志记录中受益。良好实施的静态运行时日志记录可以直接发现许多问题 - 没有它，您对组件中发生的事情的可见性为零。您可以查看输入、输出和猜测——仅此而已。

他们在这里的关键是“很好地暗示”这个词。仪表必须在正确的位置。像其他任何事情一样，这需要一些思考和计划。如果它不在有用/有趣的地方，那么它不会帮助您在开发、测试或部署场景中发现问题。您还可能有太多的仪器在打开时导致性能问题 - 甚至关闭！

当然，不同的软件产品或组件会有不同的需求。有些事情可能需要很少的工具。但是，一个广泛分散或关键的组件可以极大地受益于精心设计的仪器。

这是适合您的场景（请注意，这很可能不适用于您...:)）。假设您在公司的每个桌面上部署了一个业务线应用程序 - 成百上千的用户。当有人遇到问题时你会怎么做？你会在他们的办公室停下来连接调试器吗？如果是这样，你怎么知道他们有什么版本？你从哪里得到正确的符号？你如何在他们的系统上安装调试器？如果它每隔几个小时或几天才发生一次怎么办？您是否要让系统在一直连接调试器的情况下运行？

正如您所想象的那样 - 在这种情况下连接调试器是具有破坏性的。

如果您的组件使用 ETW 检测，那么您可以要求您的用户简单地打开跟踪；继续做他/她的工作；然后在问题发生时点击“WTF”按钮。更好的是：您的应用程序可能能够自我记录 - 在运行时检测问题并自动神奇地打开记录。它甚至可以在出现问题时向您发送 ETW 文件。

这些只是简单的示例 - 日志记录可以通过多种不同的方式进行处理。我在这里的主要建议是考虑日志记录如何能够帮助您在开发时、测试时和部署后发现、调试和修复组件中的问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-24T12:26:59.080

为自己构建一些适当的调试工具可能非常有价值。例如，在 3D 环境中，您可以选择显示八叉树，或渲染计划的 AI 路径，或绘制通常不可见的航点。您可能还需要一些屏幕显示来帮助进行分析：当前帧速率、屏幕上的多边形数量、纹理内存使用情况等等。

虽然这需要一些时间和精力来完成，但从长远来看，它可以为您节省大量时间和挫败感。

# c# - C#中的sprintf？

> ID：313006
> 
> 赞同：21
> 
> 时间：2008-11-23T21:46:16.050
> 
> 标签：c#, string, printf

`sprintf()`在 C# 中有类似的东西吗？

例如，我想将整数转换为 2 字节字节数组。

就像是：

```
int number = 17;
byte[] s = sprintf("%2c", number); 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-23T21:49:48.443

```
string s = string.Format("{0:00}", number) 
```

第一个0表示“第一个参数”（即数字）；冒号后的 00 是格式说明符（2 个数字）。

但是，请注意 .NET 字符串是 UTF-16，因此 2 个字符的字符串是 4 个字节，而不是 2

（编辑：问题从更改`string`为`byte[]`）

要获取字节，请使用`Encoding`：

```
byte[] raw = Encoding.UTF8.GetBytes(s); 
```

（显然不同的编码可能会产生不同的结果；UTF8 会为此数据提供 2 个字节）

实际上，第一位的较短版本是：

```
string s = number.ToString("00"); 
```

但`string.Format`版本更灵活。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-23T22:12:18.977

编辑：我假设您想将整数的值转换为字节数组，而不是将值先转换为字符串，然后再转换为字节数组（检查 marc 对后者的回答。）

要将 int 转换为字节数组，您可以使用：

```
byte[] array = BitConverter.GetBytes(17); 
```

但这会给你一个 4 个字节而不是 2 个字节的数组（因为 int 是 32 位。）要获得一个 2 个字节的数组，你应该使用：

```
byte[] array = BitConverter.GetBytes((short)17); 
```

如果您只想将值 17 转换为两个字符，请使用：

```
string result = string.Format("{0:00}", 17); 
```

但正如 marc 指出的那样，结果将消耗 4 个字节，因为 .NET 中的每个字符都是 2 个字节（UTF-16）（包括保存字符串长度的两个字节，它将是 6 个字节）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-23T22:14:51.513

原来，我真正想要的是这样的：

```
short number = 17;
System.IO.BinaryWriter writer = new System.IO.BinaryWriter(stream);
writer.Write(number);
writer.Flush(); 
```

这里的关键是 BinaryWriter 类的 Write-function。它有 18 个重载，将不同的格式转换为写入流的字节数组。在我的情况下，我必须确保我要写入的数字保存在一个短数据类型中，这将使 Write 函数写入 2 个字节。

# ios - 如何使用 Core Graphics 绘制点？

> ID：313018
> 
> 赞同：17
> 
> 时间：2008-11-23T21:55:39.057
> 
> 标签：ios, cocoa-touch, core-graphics, pixel, point

我在 Quartz 中看到了用于绘制线和圆的 API。但我想要做的就是指定 (x,y) 笛卡尔坐标以将像素着色为特定值。我怎么做？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-26T22:58:28.727

```
CGContextFillRect(context, CGRectMake(x,y,1,1)); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-24T08:59:22.180

Quartz 不是面向像素的 API，它的上下文不一定是像素缓冲区。如果要绘制像素图，请使用`CGBitmapContextCreate()`. 您提供一个缓冲区，您可以直接对其进行操作，并且可以通过使用和绘制该`CGImage`缓冲区从同一个缓冲区创建一个来复制到另一个上下文。`CGImageCreate()`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-11-28T00:47:32.703

Draw a very small ellipse/circle and fill it!

```
CGContextAddEllipseInRect(Context,(CGRectMake (x_dot, y_dot, 3.0, 3.0));
CGContextDrawPath(Context, kCGPathFill);
CGContextStrokePath(Context); 
```

I am using this code to create a small dot (3x3 pixels) in a dotted music note.

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-02-06T01:01:04.143

在将线帽设置为 kCGLineCapRound 后，我得到了一个要绘制的点（零长度线）。默认 line-cap 没有长度，因此无法绘制。

点没有大小的论点是愚蠢的。线条没有宽度，但我们可以绘制它们（通过使用绘制状态的“线宽”）。一个点应该以完全相同的方式绘制，并且我相信它使用不同的线帽。

也许这种行为是新的？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-23T22:27:43.297

您可以在相关坐标处绘制一条 1 像素长的线；那应该完成你想要的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-29T23:05:55.417

我有同样的问题 - 我发现最好的解决方案与上一个类似，但至少它不会留下看起来像“破折号”的东西......当然，应该确保 x/y 都 > 0 .

CGContextFillRect(context, CGRectMake(x - 0.5, y - 0.5, 1.0 , 1.0));

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-29T09:19:47.617

迅速3：

```
 UIRectFill(CGRect(x: x, y: y, width: 1, height: 1)) 
```

# visual-studio - 如何在 Visual Studio 中轻松识别实现 IDispose 的类？

> ID：313024
> 
> 赞同：1
> 
> 时间：2008-11-23T22:01:45.207
> 
> 标签：visual-studio

是否可以识别实现 IDisposable 的类。我希望在 Visual Studio 颜色设置或插件中这样做。

我不使用 Resharper，我听说 FXcop 有这个功能。我一直在寻找与这些选项不同的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T00:38:16.810

您可以右键单击类型并选择转到定义。它应该向您展示该类的公共成员及其实现的接口。对象浏览器也可以用来查看这一点。

然而，Brody 的答案通常是最简单的方法，只要有人没有实现称为 Dispose 的方法但没有实现 IDisposable 接口，它就可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T00:34:27.957

在类上查找方法 Dispose()。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T00:46:02.910

您可以使用类视图和对象浏览器来确定它。但是去定义是最好的主意，因为生成的元数据会向你展示所有的方法和类的继承

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-24T00:48:19.503

没有遇到错误方式的风险（所以请不要那样做），但最好的方法是了解您的代码并了解框架。您只需要查看几次即可了解哪些是哪些。除了检查 .Dispose() 是否是一种方法（它总是不起作用，因为 Dispose 在某些框架类上可以是私有的，例如受保护的 ManualResetEvent ）之外，没有真正可靠的方法，或者通过找到它的定义。

这并不是说有人无法编写可以做到这一点的加载项。我认为这在技术可行性方面没有任何问题。粗略搜索谷歌并没有找到任何现有的插件，但可能已经有一些东西了。

# c# - Rhino Mocks：如何从模拟对象方法返回条件结果

> ID：313030
> 
> 赞同：2
> 
> 时间：2008-11-23T22:07:00.717
> 
> 标签：c#, rhino-mocks, anonymous-methods

我想做类似以下的事情，但似乎无法完全正确地获得 Do 方法的语法。

```
var sqr = new _mocks.CreateRenderer<ShapeRenderer>();
Expect.Call(sqr.CanRender(null)).IgnoreArguments().Do(x =>x.GetType() == typeof(Square)).Repeat.Any(); 
```

所以基本上，如果输入是 Square 类型，我想设置 sqr.CanRender() 方法返回 true，否则返回 false。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-23T23:06:47.197

你在找这个吗？

```
Expect.Call(sqr.CanRender(null)).IgnoreArguments()
    .Do((Func<Shape, bool>) delegate(Agent x){return x.GetType() == typeof(Square);})
    .Repeat.Any(); 
```

编辑：答案在精神上是正确的，但原始语法并不完全有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T10:35:26.700

如果您无法使用 .Net Framework 3.5（[Cristian 的回答](https://stackoverflow.com/questions/313030/rhino-mocks-how-to-return-conditonal-result-from-a-mock-object-method/313080#313080)要求），因此无法访问[System.Func](http://msdn.microsoft.com/en-us/library/bb534960.aspx)委托，那么您需要定义自己的委托。

添加到类成员：

```
private delegate bool CanRenderDelegate(Shape shape) 
```

期望变为：

```
Expect.Call(sqr.CanRender(null))
    .IgnoreArguments()
    .Do((CanRenderDelegate) delegate(Agent x){return x.GetType() == typeof(Square);})
    .Repeat.Any(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-16T06:13:13.920

从 Rhino Mocks 3.5 开始，您现在可以执行以下操作：

```
Expect.Call( sqr.CanRender( Arg<Shape>.Is.TypeOf<Square>() ).Repeat.Any(); 
```

Look at this [wiki article](http://ayende.com/Wiki/Rhino+Mocks+3.5.ashx) for more information.

# c# - 泛型类用作 C# 中泛型方法的约束？

> ID：313036
> 
> 赞同：0
> 
> 时间：2008-11-23T22:18:05.547
> 
> 标签：c#, .net, generics, db4o

我做错了什么还是不能将泛型类指定为泛型方法的约束？

我一直在玩泛型和[db4o](http://developer.db4o.com/)（开源对象数据库），并且正在编写一个测试程序（参见下面的代码）来存储和检索一些用户定义的泛型集合。

我正在尝试编写一个通用方法（请参阅下面的**GetCollectionFromDb**）来从数据库中检索特定类型的集合。不幸的是，下面的代码为该行返回了编译器生成的错误：

```
 MyCollection1 collection3 =
                  GetCollectionFromDb<MyCollection1>(Collection1Name); 
```

错误信息是：

```
The type 'GenericsTest.MyCollection1'cannot be used as type parameter 'T'
in the generic type or method 'GenericsTest.Program.GetCollectionFromDb<T>(string)'.
There is no implicit reference conversion from'GenericsTest.MyCollection1' to
'GenericsTest.MyCollectionBase<GenericsTest.MyCollection1>'. 
```

对于我可能做错了什么或如何以不同的方式处理此问题以达到预期结果的任何建议，我将不胜感激。

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using Db4objects.Db4o;

 namespace GenericsTest 
    {
        public class Entity1
        {
            public string SomeProperty { get; set; }
        }

        public class Entity2
        {
            public string SomeProperty { get; set; }
        }

        public abstract class MyCollectionBase<T> : Collection<T>
        {
            protected MyCollectionBase() : this("") { }

            protected MyCollectionBase(string pCollectionName) 
            {
                CollectionName = pCollectionName; 
            }

            public string CollectionName { get; set; }
        }

        public class MyCollection1 : MyCollectionBase<Entity1>
        {
            public MyCollection1(string pCollectionName) :
                                          base(pCollectionName) { }

            public void DoSomeWorkOnCollection1() {}
        }

        public class MyCollection2 : MyCollectionBase<Entity2>
        {
            public MyCollection2(string pCollectionName) :
                                          base(pCollectionName) { }

            public void DoSomeWorkOnCollection2() { }
        }

        public class Program
        {
            public static IObjectContainer db = null;

            public static void Main(string[] args)
            {
                const string Collection1Name = "Entity1Collection";
                const string Collection2Name = "Entity2Collection";
                db = Db4oFactory.OpenFile("Test.db");

                Entity1 entity1 = new Entity1();
                MyCollection1 collection1 = new MyCollection1(Collection1Name);
                collection1.Add(entity1);
                db.Store(collection1);

                Entity2 entity2 = new Entity2();
                MyCollection2 collection2 = new MyCollection2(Collection2Name);
                collection1.Add(entity1);
                db.Store(collection2);

                db.Commit();
                db.Close();
                db = Db4oFactory.OpenFile("Test.db");

                MyCollection1 collection3 = 
                       GetCollectionFromDb<MyCollection1>(Collection1Name);
            }

            private static T GetCollectionFromDb<T>(string pCollectionName) 
                                                 where T : MyCollectionBase<T>
            {
                IList<T> queryResult = db.Query((T c) => 
                                         c.CollectionName == pCollectionName);
                if (queryResult.Count != 0) return queryResult[0];

                return null;
            }
        } 
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-23T22:53:05.587

您的类型不满足约束。您提供`MyCollection1`了源自`MyCollection<Entity1>`. 但是，这并不意味着它源自`MyCollection<MyCollection1>`.

也许您想表达对两个类型参数而不是一个类型参数的约束：

```
private static T GetCollectionFromDb<T, U>(string pCollectionName) 
                                             where T : MyCollectionBase<U> 
```

然后调用它：

```
GetCollectionFromDb<MyCollection1, Entity1>(Collection1Name); 
```

如果这不起作用，请告诉我们原因。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-23T22:30:00.157

只需按照 T：

```
 // ...
    {
       //...
       MyCollection1 collection3 = GetCollectionFromDb<MyCollection1>(Collection1Name);

    }

    private static T GetCollectionFromDb<T>(string pCollectionName) where T : MyCollectionBase<T>
    {
        IList<T> queryResult = db.Query((T c) => c.CollectionName == pCollectionName);
        if (queryResult.Count != 0) return queryResult[0];
        return null;
    } 
```

将转化为：

```
 private static MyCollection1 GetCollectionFromDb<MyCollection1>(string pCollectionName) where T : MyCollectionBase< MyCollection1 >
    {
        IList< MyCollection1 > queryResult = db.Query((MyCollection1 c) => c.CollectionName == pCollectionName);
        if (queryResult.Count != 0) return queryResult[0];
        return null;
    } 
```

这不是您想要的，因为 MyCollection1 派生自 MyCollectionBase< Entity1 > 而不是 MyCollectionBase< MyCollection1 >，这就是您收到错误的原因。如果您希望约束起作用，您可能必须使用第二个类型标识符来表示泛型集合中使用的类型。

# sharepoint - SharePoint 和 Office Open XML 交互问题

> ID：313047
> 
> 赞同：1
> 
> 时间：2008-11-23T22:35:08.867
> 
> 标签：sharepoint, ms-word, openxml

我整个周末都为此感到沮丧，再加上一两天，所以任何帮助都将不胜感激。

我正在尝试编写一个程序，该程序可以以编程方式进入 SharePoint 2007 文档库，打开文件，更改文件内容，然后将文件放回原处。除了最后一部分之外，我已经完成了所有工作。涉及 Office Open XML 的原因是我通过 Office Open XML SDK 打开和修改文档的方式。我的问题是：如何将它从文档中取回图书馆？

我看到的问题是 WordprocessingDocument 对象本身没有保存功能。这使我无法将其保存到 SPFile 的 SaveBinary 函数中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T14:17:26.390

您应该使用流将更改的 OOXML 写回 SPFile。我希望这个例子有帮助！

> ```
> Stream fs = mySPFile.OpenBinaryStream();
> 
> using (WordprocessingDocument ooxmlDoc = WordprocessingDocument.Open(fs, true))
> {
> 
>     MainDocumentPart mainPart = wordDoc.MainDocumentPart;
>     XmlDocument xmlMainDocument = new XmlDocument();
>     xmlMainDocument.Load(mainPart.GetStream());
> 
>    // change the contents of the ooxmlDoc / xmlMainDocument
> 
>    Stream stream = mainPart.GetStream(FileMode.Open, FileAccess.ReadWrite);
>    xmlMainDocument.Save(stream);
>    // the stream should not be longer than the DocumentPart
>    stream.SetLength(stream.Position); 
> }
> mySPFile.SaveBinary(fs);
> fs.Dispose(); 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-23T23:16:45.447

昨天我看到了 Andrew Connell 的网络广播，他从文档库中打开了一个文档，添加了水印并再次保存了文件。听起来您确实应该看一下该网络广播： [https ://msevents.microsoft.com/CUI/WebCastRegistrationConfirmation.aspx?culture=en-US&RegistrationID=1299758384&Validate=false](https://msevents.microsoft.com/CUI/WebCastRegistrationConfirmation.aspx?culture=en-US&RegistrationID=1299758384&Validate=false)

顺便说一句，我发现该系列中的所有 10 个网络广播都非常好。

# javascript - 我可以设置实例化函数的原型吗？

> ID：313049
> 
> 赞同：4
> 
> 时间：2008-11-23T22:35:59.613
> 
> 标签：javascript

这失败了'Xm不是一个函数'......

```
var Y = function () {
    this.m = function () {
        alert('this is m');
    };
};

var X = new function () { };

X.prototype = new Y();
X.m(); 
```

如果我跳过 X 定义中的 new 关键字，然后在调用 m() 之前实例化 X，它肯定会起作用。为什么我不能这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-23T22:50:02.333

不，您不能设置原型并具有以前存在的实例的更改效果。但是，您可以修改原型对象以获得所需的效果。但不是你尝试的方式。这是因为您的实例 X 是一个对象，而不是一个类。（这是因为您在定义类之前使用了“new”运算符。）

简单测试：

```
var X = new function () { };
alert(X.prototype);  // displays "undefined" because X is an 
                     // object not a class 
```

因此，当您在 X 上设置“原型”属性时，您不会将模板对象存储在类中，您只是在对象 X 上创建一个名为“原型”的新属性，因此，如果您这样做：

```
var Y = function () {
    this.m = function () {
        alert('this is m');
    };
};

var X = new function () { };
X.prototype = new  Y();
X.prototype.m();  // displays "this is m" 
```

然后你会得到你之前期望的输出。

即使您将 X 创建为匿名类的实例，您仍然可以通过“构造函数”属性访问该类。一旦你有了那个引用，你就可以修改原型对象。像这样：

```
X.constructor.prototype.m = new Y().m;
X.m();  // displays "this is m" 
```

但是，您应该注意，这不起作用：

```
X.constructor.prototype = new Y();
X.m();  // fails 
```

因为更改整个原型对象只会影响将来创建的实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-23T23:20:45.967

在实际调用构造函数之前，应该将原型属性分配给您用作构造函数的函数。因此，例如，这将按您的预期工作：

```
var Y = function () {
    this.m = function () {
        alert('this is m');
    };
};

var X = function () { };
X.prototype = new Y();

new X().m(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-23T22:55:00.903

`object`当您应该在.prototype 上使用它时，您正在尝试在 .prototype 上使用它`function`。

`alert(typeof Y); alert(typeof X);`

您实际上是在 X 上创建一个名为原型的属性，而不是使用“魔术”原型（尝试`X.prototype.m()`了解我的意思）。

# python - Django 管理界面不使用子类的 __unicode__()

> ID：313054
> 
> 赞同：5
> 
> 时间：2008-11-23T22:44:57.677
> 
> 标签：python, django, django-admin

（Django 1.x，Python 2.6.x）

我有以下模型：

```
class Animal(models.Model):
  pass

class Cat(Animal):
  def __unicode__(self):
    return "This is a cat"

class Dog(Animal):
  def __unicode__(self):
    return "This is a dog"

class AnimalHome(models.Model):
  animal = models.ForeignKey(Animal) 
```

我没有实例化动物，因为这应该是一个虚拟类。我已经实例化了 Cats 和 Dogs，但是在 AnimalHome 的管理页面中，我对 Animals 的选择显示为“Animal object”（我猜是默认的 __unicode__()），而不是我为两个子类定义的 __unicode__。帮助。

* * *

我认为，抽象基类问题是这个问题的一个红鲱鱼。即使 Animal 不应该是抽象的，我仍然有一个问题，由于某种原因，ForeignKey 是在 Animal 而不是它的子类之一上定义的，因此调用的是超类方法而不是子类。在 OO 编程中，当您调用 object.method() 时，您应该获得最低子类的实现，并且您必须做额外的工作才能获得任何超类的实现。那么为什么在子类上定义 __unicode__ 是不够的——实际上问题可能是根本没有调用 __unicode__ 因为对 Animal 类的自省表明它没有被定义。所以也许如果我为 Animal 定义 __unicode__ 并让它调用子类'

* * *

好的，我想我了解 ORM 问题。这两个答案都帮助我理解了这一点，谢谢。在对此进行试验时，我发现当 Django 保存子类模型时，它会做两件事：（1）它为超类表中的子类对象创建一行，以及（2）它使子类表中的 PK 与在超类表中分配的 PK。子类表中的这个 PK 被命名为 superclass_ptr。基于此，我炮制了以下内容。我很感激反馈。

```
Class Animal(models.Model)
  def __unicode__(self):
    if Dog.objects.filter(pk=self.pk).count() > 0:
      return unicode(Dog.objects.get(pk=self.pk))
    elif Cat.objects.filter(pk=self.pk).count() > 0:
      return unicode(Cat.objects.get(pk=self.pk))
    else:
      return "An Animal!" 
```

* * *

劳伦斯似乎在这个问题上最准确。Cat 和 Dog 将有不相交的 PK 集（并且 Animal 的任何子类都将具有与其超类的记录相同的 PK），但不幸的是 Django 并没有在幕后执行任何工作，例如：“我是动物。我知道动物有子类Dog和Cat。具体来说，我是3号动物，而且我刚刚查了一下，也有3号猫。这意味着我实际上是3号猫”。尽管使用 Python 的内省，这似乎完全有可能并且非常合理（因为 Cat 不会做 Animal 自己做不到的任何事情）。谢谢你们。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-23T23:23:44.277

你想要一个[抽象基类](http://docs.djangoproject.com/en/dev/topics/db/models/#id5)（“虚拟”在 Python 中没有任何意义。）

从文档中：

```
class CommonInfo(models.Model):
    name = models.CharField(max_length=100)
    age = models.PositiveIntegerField()

    class Meta:
        abstract = True 
```

* * *

编辑

“在 OO 编程中，当您调用 object.method() 时，您应该获得最低子类的实现。”

真的。但不是全部。

这不是 OO 问题。甚至是 Python 或 Django 问题。这是一个 ORM 问题。

问题是“在 FK 引用的末尾重建了什么对象？” 答案是，对于如何处理从 FK 值到对象的转换，没有标准的、明显的答案。

我有`AnimalHome`一个`animals`值为 42 的行。它指的是`Animal.objects.get(pk=42)`. 动物的哪个子类？猫？狗？ORM 层如何知道它是否应该做`Dog.objects.get(pk=42)`或`Cat.objects.get(pk=42)`？

“但是等等，”你说。“它应该获取 Animal 对象，而不是 Dog 或 Cat 对象。” 你可以对此抱有希望，但这不是 Django ORM 的工作方式。每个类都是一个不同的表。Cat 和 Dog——根据定义——是独立的表，具有独立的查询。您没有使用对象存储。您正在将 ORM 用于关系表。

* * *

编辑

首先，您的查询仅在 Dog 和 Cat 共享一个公共密钥生成器并且没有一组重叠的 PK 时才有效。

如果你有一只 PK 为 42 的狗和一只 PK 为 42 的猫，你就有问题了。而且由于您无法轻松控制密钥生成，因此您的解决方案无法正常工作。

运行时类型标识不好。它在很多方面都不是面向对象的。几乎你可以做的任何事情来避免 RTTI 都比不断扩展的 if 语句序列来区分子类要好。

但是，您尝试构建的模型——特别是——对于 ORM 系统来说是一个病态问题。的确，如此特别病态，我几乎愿意打赌这是家庭作业。[纯 SQL 系统也存在病态问题。他们经常作为家庭作业出现。]

问题是 ORM 不能做你认为它应该做的事情。所以你有两个选择。

*   停止使用 Django。
*   做一些 Django 直接做的事情。
*   打破 OO 设计准则并求助于诸如 RTTI 之类的脆弱事物，这使得添加另一个动物子类变得异常困难。

考虑这种方式来做 RTTI——它包括类名和 PK

```
KIND_CHOICES = (
   ( "DOG", "Dog" ),
   ( "CAT", "Cat" ),
)

class Animal( models.Model ):
    kind = models.CharField( max_length= 1, choices=KIND_CHOICES )
    fk = models.IntegerField()
    def get_kind( self ):
        if kind == "DOG":
            return Dog.objects.get( pk = fk )
        elif kind == "CAT":
            return Cat.objects.get( pk = fk ) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-24T16:40:56.197

ForeignKey(Animal) 就是这样，对 Animal 表中一行的外键引用。底层 SQL 模式中没有任何内容表明该表正在用作超类，因此您将返回一个 Animal 对象。

要解决此问题：

首先，您希望基类是非抽象的。无论如何，这对于 ForeignKey 是必需的，并且还确保 Dog 和 Cat 将具有分离的主键集。

现在，Django 使用 OneToOneField 实现继承。因此，**具有子类实例的基类实例会获得对该实例的引用，并适当命名。**这意味着您可以执行以下操作：

```
class Animal(models.Model):
    def __unicode__(self):
        if hasattr(self, 'dog'):
            return self.dog.__unicode__()
        elif hasattr(self, 'cat'):
            return self.cat.__unicode__()
        else:
            return 'Animal' 
```

这也回答了您向 Ber 提出的关于依赖于其他子类属性的**unicode () 的问题。**您现在实际上是在子类实例上调用适当的方法。

现在，这确实表明，由于 Django 已经在幕后寻找子类实例，因此代码可以一直返回 Cat 或 Dog 实例而不是 Animal。您将不得不与开发人员讨论这个问题。:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-23T23:22:06.480

Django（以及一般的关系数据库）不能以这种方式工作。即使使用像 Django 这样的 ORM，您也不会使用这样的类层次结构。

您的问题有两种可能的解决方案：

(1) 给Animal模型一个“名称”属性，然后添加名称来自['Dog', 'Cat']的实体。这将在外键选择框中显示动物的名称。

(2) 如果您**确实需要将**外键链接到不同的模型（这确实不是使用 RDBMS 的常用方法），您应该阅读有关内容类型框架的文档中的[通用关系。](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#id1)

不过，我的建议是（1）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T12:28:56.733

这与 S.Lott 建议的内容一致，但没有 if/elif/...，随着您需要支持的子类数量的增加，它会变得越来越尴尬和难以维护。

```
class Cat(models.Model):
    def __unicode__(self):
        return u'A Cat!'

class Dog(models.Model):
    def __unicode__(self):
        return u'A Dog!'        

class Eel(models.Model):
    def __unicode__(self):
        return u'An Eel!'        

ANIMALS = {
    'CAT': {'model': Cat, 'name': 'Cat'},
    'DOG': {'model': Dog, 'name': 'Dog'},
    'EEL': {'model': Eel, 'name': 'Eel'},
}
KIND_CHOICES = tuple((key, ANIMALS[key]['name']) for key in ANIMALS)

class Animal(models.Model):
    kind = models.CharField(max_length=3, choices=KIND_CHOICES)
    fk = models.IntegerField()
    def get_kind(self):
        return ANIMALS[self.kind]['model'].objects.get(pk=self.fk)
    def __unicode__(self):
        return unicode(self.get_kind()) 
```

使用 Django 的多表继承也可以完成非常相似的事情（搜索 Django 的文档）。例如：

```
ANIMALS = {
    'CAT': {'model_name': 'Cat', 'name': 'Cat'},
    'DOG': {'model_name': 'Dog', 'name': 'Dog'},
    'EEL': {'model_name': 'Eel', 'name': 'Eel'},
}
KIND_CHOICES = tuple((key, ANIMALS[key]['name']) for key in ANIMALS)

class Animal(models.Model):
    kind = models.CharField(max_length=3, choices=KIND_CHOICES)
    def get_kind(self):
        return getattr(self, ANIMALS[self.kind]['model_name'].lower())
    def __unicode__(self):
        return unicode(self.get_kind())

class Cat(Animal):
    def __unicode__(self):
        return u'A Cat!'

class Dog(Animal):
    def __unicode__(self):
        return u'A Dog!'        

class Eel(Animal):
    def __unicode__(self):
        return u'An Eel!' 
```

我个人更喜欢第二种选择，因为子类的实例将自动神奇地在父类中定义所有字段，这允许更清晰和更简洁的代码。（例如，如果 Animal 类有一个 'gender' 字段，那么 Cat.objects.filter(gender='MALE') 会起作用）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-25T08:44:04.147

关于通用关系，请注意普通的 Django 查询不能跨越 GenerecForeignKey 关系。使用多表继承可以避免这个问题，但代价是不太通用。

从文档：

> 由于 GenericForeignKey 的实现方式，您不能通过数据库 API 直接将此类字段与过滤器（例如 filter() 和 exclude()）一起使用。它们不是普通的字段对象。这些示例将不起作用：

```
# This will fail
>>> TaggedItem.objects.filter(content_object=guido)
# This will also fail
>>> TaggedItem.objects.get(content_object=guido) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-14T20:41:18.933

您可以使用[django 内容框架](https://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/)

我举了一个例子来说明如何在这里实现你的模型->

[https://github.com/jmg/django_content_types_example/blob/master/generic_models/models.py](https://github.com/jmg/django_content_types_example/blob/master/generic_models/models.py)

在这里你可以看到如何使用 orm ->

[https://github.com/jmg/django_content_types_example/blob/master/generic_models/tests.py](https://github.com/jmg/django_content_types_example/blob/master/generic_models/tests.py)

# silverlight - 作为非 .NET 开发人员学习 Silverlight

> ID：313062
> 
> 赞同：4
> 
> 时间：2008-11-23T22:53:55.460
> 
> 标签：silverlight

有几个人（我自己就是其中之一）已经使用 Flex 和 AJAX 开发 RIA 已有一段时间了。然而，Silverlight 现在就在现场，值得一试。

问题是，作为以前从未研究过 .NET 的人，我应该直接研究 Silverlight 并尝试弥补我缺少的部分，还是从 .NET 的其他地方开始，以便首先获得基础？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-23T22:58:31.410

我坚信首先要学习基础。我将从编写控制台应用程序开始——了解集合、IO、语言本身（无论是 VB 还是 C#，甚至是其他东西）。

之后可能值得学习一些“普通” WPF，因为这种方式可能比使用 Silverlight 本身更容易进行试验。（我不能说我自己写过任何 Silverlight。）

如果您直接进入 Silverlight，当您遇到问题时，您将不知道是因为您不熟悉语言、核心平台还是 Silverlight 本身。你需要更长的时间才能接受我上面的建议，但在我看来，一旦你开始了，这将是一个更顺畅的旅程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T08:26:01.733

尽管我不会先学习 WPF，但我会重复 Jon Skeet 的建议。

Silverlight 更像是 WPF 的一个子集，它缺少一些东西，这意味着您的设计“风格”需要稍有不同。（命令和无法绑定到视觉元素是我发现的两个让我的设计与 WPF 应用程序略有不同的地方）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-23T23:00:39.953

.Net 语言的基础是必不可少的（C# 是我的首选，尽管我也使用过 VB.Net 和 IronPython，它们都是非常有用的语言）。WPF/Silverlight 是其上的另一层。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T03:06:52.580

首先，快速评估一下您希望使用 Silverlight 实现的目标。

如果您计划创建将利用 Silverlight 的多媒体功能的应用程序，您可能希望先使用 Expression Blend，然后再学习 .NET。

如果您计划构建“Line fo Business”应用程序，那么您应该首先学习 .NET。

一旦您在 .NET 中有良好的基础，就可以相对容易地开发利用 Silverlight 强大功能的应用程序。

Silverlight 网站的学习页面是学习 Silverlight 特定内容的好地方。

我可以向想使用 C# 学习 .NET 的人推荐一本好书，这是 Microsoft Press 的 John Sharp 的“Microsoft Visual C# 2008 Step by Step”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-15T17:44:19.990

我建议您密切关注[Technobits.net 的](http://www.technobits.net)Silverlight 页面。这将为您提供 Silverlight 中的每日更新。请参阅以下链接。

*   [http://www.technobits.net/technologies/silverlight/](http://www.technobits.net/technologies/silverlight/)

# .net - 如何使用 C# 从分配的上下文菜单中获取父控件？

> ID：313063
> 
> 赞同：5
> 
> 时间：2008-11-23T22:54:37.267
> 
> 标签：.net, forms, listview, contextmenu

我在 Windows 窗体上有一些列表视图控件，并且我已经使用 VS2005 中的属性网格为它们分配了一个通用的上下文菜单条。

现在，当从任何列表视图中的上下文菜单中进行选择时，有没有办法我可以获得凸起菜单的正确托管控制？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-23T23:11:29.247

[ContextMenuStrip.SourceControl](http://msdn.microsoft.com/en-us/library/system.windows.forms.contextmenustrip.sourcecontrol.aspx)

# php - 使用 PHP 实现 PNG 透明度

> ID：313070
> 
> 赞同：43
> 
> 时间：2008-11-23T22:59:06.667
> 
> 标签：php, png, transparency

嘿，当我从它创建缩略图时，尝试在 png 上保持透明度时遇到了一些麻烦，有人有这方面的经验吗？任何帮助都会很棒，这就是我目前正在做的事情：

```
$fileName= "../js/ajaxupload/tees/".$fileName;

list($width, $height) = getimagesize($fileName);

$newwidth = 257;
$newheight = 197;

$thumb = imagecreatetruecolor($newwidth, $newheight);
imagealphablending($thumb, true);
$source = imagecreatefrompng($fileName);
imagealphablending($source, true);

imagecopyresized($thumb, $source, 0, 0, 0, 0, $newwidth, $newheight, $width, $height);

imagesavealpha($thumb, true);
imagepng($thumb,$newFilename); 
```

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2008-11-23T23:23:17.693

我过去曾成功地这样做过：

```
$thumb = imagecreatetruecolor($newwidth, $newheight);
imagealphablending($thumb, false);
imagesavealpha($thumb, true);  

$source = imagecreatefrompng($fileName);
imagealphablending($source, true);

imagecopyresampled($thumb, $source, 0, 0, 0, 0, $newwidth, $newheight, $width, $height);

imagepng($thumb,$newFilename); 
```

我发现输出图像质量比使用`imagecopyresampled()`好得多`imagecopyresized()`

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-02-22T20:59:10.590

忘记颜色透明度指数，它永远不会在所有渲染产品中起作用。而是使用 alpha 图层蒙版：

```
$image = imagecreatetruecolor($size, $size);

imagealphablending($image, false);
imagesavealpha($image, true);

$trans_layer_overlay = imagecolorallocatealpha($image, 220, 220, 220, 127);
imagefill($image, 0, 0, $trans_layer_overlay); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-23T23:32:41.263

这些函数访问底层的 gdlib 库，这是一个很好的玩具，但不能产生好的结果。如果您可以选择，请改用[imagemagick](http://www.imagemagick.org/)。缺点是目前没有好的 php-bindings，因此您需要通过 shell 访问它，而共享主机上通常不允许这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-23T23:06:38.837

请参阅[dycey 对“我如何调整大小...”的回答](https://stackoverflow.com/questions/279236/how-do-i-resize-pngs-with-transparency-in-php#279310)。本质上，在进行任何其他操作之前，您需要用透明度填充整个背景。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-23T23:12:26.657

[imagecopyresized](http://us3.php.net/manual/en/function.imagecopyresized.php)不正确支持透明度。

[imagecopymerge](http://us3.php.net/manual/en/function.imagecopymerge.php)可以，但不会调整大小。

解决方案？您可能最终会手动调整大小。

# java - 为 SVN 和 CVS 提供通用接口

> ID：313082
> 
> 赞同：0
> 
> 时间：2008-11-23T23:08:28.677
> 
> 标签：java, .net, svn, interface, cvs

SVN 和 CVS 是两个非常不同的系统，旨在解决相同的基本问题 - 源代码控制。

它们都以不同的方式工作，因此可能很难以完全相同的方式处理它们。

我想知道的是，是否可以开发一个公开相同接口的编程库或 API，但在后台，可以设置为与 SVN 或 CVS 存储库一起使用？

我的目标是在 .NET 或 Java（很可能是 .NET）中开发这样的库，但我想了解这将如何可行，以及是否有更好的方法来解决这个问题。

这样做的背景是：我正在构建一个基于 Web 的服务，该服务将涉及源代码控制托管，并且我希望同时支持 SVN 和 CVS，以便为尽可能多的开发人员提供服务。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-23T23:33:22.387

对于新产品，我个人会忽略 CVS。我的感觉是，强迫它看起来像 SVN 的巨大额外努力最好花在其他东西上。我不了解你的市场，所以我可能是错的，但这必须值得考虑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-23T23:15:42.890

MSSCCI API 做了非常相似的事情：

[http://alinconstantin.homeip.net/webdocs/scc/msscci.htm](http://alinconstantin.homeip.net/webdocs/scc/msscci.htm)

从 IDE 的角度来看，MSSCCI 试图使所有源代码控制看起来都一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T04:25:39.223

viewvc 允许您浏览 svn 和 cvs 存储库。也许现有的产品已经可以满足您的需求？

# php - PHP 或普通 Perl CGI 更快吗？

> ID：313083
> 
> 赞同：3
> 
> 时间：2008-11-23T23:08:53.497
> 
> 标签：php, perl

我正在为 Apache 共享托管服务器开发一个 Web 应用程序。我已经用 Perl 编写了一些代码，但我最近发现，令我惊讶的是，共享主机提供商没有提供 mod_perl 或安装它的方法。

我一直有点担心在没有 mod_perl 的情况下通过 CGI 运行 Perl Web 应用程序会使其非常慢？我是否应该将所有代码都切换到 PHP，这样会更快吗？

我首先选择 Perl 的原因是，我对 Perl 比 PHP 更熟悉。此外，我希望能够在 Web 开发领域之外使用我的 Perl 库。

因此，如果你们中的任何人都对 Apache Web 开发有经验，您能否说明我应该采取哪个方向。

对于这个问题，假设 Web 应用程序每天将获得 500 次以上的点击。

如果没有 mod_perl，PHP 和 Perl 哪个会更快？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-24T01:43:02.217

每天只有 500 次点击，您几乎可以用任何东西编写代码，而不必担心速度变慢。每天 500 次点击平均每 3 分钟一页。即使假设点击量的分布是非正态分布的，您也不应该真正担心如此小的流量数字。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-23T23:11:39.463

PHP会更快。

但是，每天只有 500 次点击，使用 cgi 不会有问题。即使每小时点击 500 次也不行。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-24T01:35:01.470

很大程度上取决于您的架构。现代 Perl 框架不太适合用作 CGI（启动时间长）。如果您使用 CGI，Catalyst 可能是个坏主意。也就是说，使用经典架构应该是非常易于管理的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-23T23:28:54.813

除非您的共享主机将 PHP 作为 CGI 应用程序（不是 mod_php 或 FastCGI）运行，否则 PHP 几乎是¹总是会更快。虽然作为 CGI 运行的 Perl 可能每天可以处理 500 次点击，但使用 CGI 开发的应用程序/页面将变得迟缓。

CGI 通过产生一个新进程来为每个请求运行您的程序来工作。mod_php 和 FastCGI 应用程序都通过生成一组进程然后使用这些进程来运行您的应用程序来缓解这种情况。换句话说，不会为每个请求生成一个新进程。（这是一个过于简单的解释，请不要在 CS 学期论文中使用。有关更多信息，请参阅 mod_php 和 FastCGI 文档）

1.  你可以想出不应该的病态例子，但是你会是那种想出事情的病态例子的人，没有人想要那样

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-23T23:27:03.707

速度不应该是您关心的问题。两种语言都适用于 Web 应用程序。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-24T00:22:56.187

扩展[Alan Storm 所说](https://stackoverflow.com/questions/313083/php-or-perl-webapplication#313113)的内容，您也许可以将 Perl 与 FCGI 一起使用。

FCGI 的工作方式是拥有一种独立的服务器，如果你喜欢的话，它是一个守护进程，它通过 FCGI 协议与你的 Web 服务器连接并委托/分派请求。

这比普通 CGI 更快，因为它模拟了一种“servlet”模型，应用程序是持久的，并且不需要像普通 CGI 那样在每次调用时都进行新的初始化。

我自己还没有学会如何做到这一点，但我相信 Catalyst 有这个选项，所以它只是学习如何复制它的问题。

FastCGI/FCGI 应该比普通的旧 mod_perl 在更多的主机上可用，因为 FCGI 应用程序不是特定于 web 服务器的，并且一些 web 服务器通过 fcgi 实用程序实现 PHP。

而且我已经对 FCGI webserving 进行了一些试验，初步测试表明它可以处理至少 500 req/s ，远远快于上述 500/day 或 500/hour 的担忧。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-11-24T03:03:22.710

对于您正在查看的流量，带有 vanilla CGI 的 Perl 应该不是问题，尽管我会支持之前的建议，将 FastCGI 作为您的托管服务可能提供的另一个选项。

或者另一种选择是寻找不同的托管公司......

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-24T14:53:51.623

可以将 fastcgi 支持破解到不支持它的主机帐户中。我编译了 fastcgi 库，并将安装前缀设置为与主机帐户上的主目录相同的内容。然后我同步它并设置催化剂以使用小型 cgi-fcgi 桥。它运作良好。又好又快，因为 cgi 桥接器只是一个很小的可执行文件。催化剂过程在后台运行得很好。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-24T11:07:25.790

每个人心中的答案是：谁在乎。每天 500 个请求不算什么。

只需使用最快的方法来实施/维护并继续前进。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-24T10:46:58.267

对于可以使用 CGI 工作的轻量级 Web 框架，请查看....

*   [蹲着](http://search.cpan.org/dist/Squatting/lib/Squatting.pm)
*   [CGI::应用](http://search.cpan.org/dist/CGI-Application/lib/CGI/Application.pm)
*   [CGI::懒惰](http://search.cpan.org/dist/CGI-Lazy/lib/CGI/Lazy.pm)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-25T14:50:34.653

这主要取决于你的代码有多复杂以及它是如何组合在一起的；如果您将它作为 CGI 运行，perl 将在每次调用时编译您的脚本和模块，并且必须为每个请求重新连接到您的数据库。如果您的代码足够复杂，则每次浏览可能需要几秒钟，这可能会影响用户体验。

如果您的代码库和使用的模块不是很大，那么应该没有问题。

您可以对您的代码执行 perl -c 以了解 perl 的启动时间和编译时间。

# windows - 从程序中测量内存使用的最佳方法是什么？

> ID：313084
> 
> 赞同：3
> 
> 时间：2008-11-23T23:08:55.290
> 
> 标签：windows, memory-management

我一直在尝试优化我正在开发的 Windows 程序，试图找到能够最大限度地减少内存使用的最佳数据结构。它加载大块数据，因此对于大文件，它可以使用大量 RAM。

对于内存测量，我一直在使用 GlobalMemoryStatusEx。请参阅：http: [//msdn.microsoft.com/en-us/library/aa366589 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa366589(VS.85).aspx)

我相信这适用于大多数版本的 Windows，从 Windows 2000 一直到并包括 Windows Vista。

这是从程序中测量内存使用的首选方法，还是有另一种更好的方法？

* * *

附录：找到 Stackoverflow 问题：[How to get memory usage under Windows in C++](https://stackoverflow.com/questions/282194/how-to-get-memory-usage-under-windows-in-c) which references [GetProcessMemoryInfo](http://msdn.microsoft.com/en-us/library/ms683219.aspx)

我会试试那个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-23T23:13:10.833

如果您正在尝试优化自己的程序内存，我建议您为此使用内存分析器工具。那里有很多......有些是免费的，有些不是......你一定会找到你需要的。这些工具是专门为您需要的（以及内存泄漏搜索）而编写的，所以......很难与它们进行比较并从您自己的程序中自己做类似的事情:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-18T22:48:23.727

请参阅我的问题中的附录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-23T23:14:22.003

我使用[valgrind](http://valgrind.org/)来跟踪内存使用情况，以及分析代码和检测内存泄漏。我相信，massif 工具会跟踪堆栈和堆上的内存使用情况。

# user-interface - 您使用过的 CMS 的最佳界面功能是什么？

> ID：313086
> 
> 赞同：2
> 
> 时间：2008-11-23T23:10:32.463
> 
> 标签：user-interface, content-management-system

有一百万零一个 CMS 做得很好，但它的界面和可用性让整个系统崩溃（就像很多网站一样）。

每当我需要开发一个定制的内容管理系统时，我总是会尝试利用我过去的经验和我的客户的经验来找出哪些行之有效，哪些行不通。所以每次我做一个都和上一个有相似之处，但有一些额外的调整让它变得更好。

**所以问题是您觉得使用哪些 CMS 界面/功能感到愉快，为什么？**

注意：这可能是编辑页面、产品、站点地图，以及您需要通过 CMS 管理的任何内容

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-23T23:11:16.690

我个人认为内联编辑对客户和开发人员来说是一个巨大的速度提升。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-23T23:34:45.753

Drupal 6 的可拖动菜单重新排序是一个很棒的功能。它比 Drupal 5 的权重系统和我在其他地方看到的上/下箭头更快、更直观。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T14:48:24.020

我同意 jchrista，拖放非常好。这是最初将我吸引到 Sitefinity 的功能。这里有一个在线演示[。](http://demo.sitefinity.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T01:15:55.800

我讨厌 InterWoven（只是因为我发现它速度慢而且不直观——主观......），但它有一个很好的 WorkFlow 设置，使您能够控制服务器上的版本，介于您正在处理的内容和应该处理的内容之间部署。

也是一个很好的（回到搞砸之前）生产力工具

MOSS 有许多有趣的功能，它们也应该做同样的事情，我期待着在我们向那个平台迈进时对其进行测试。

# path - 使用 htdocs 下的子目录在 XAMMP/apache 2.2 中的 localhost 上打开 HTML 文件

> ID：313093
> 
> 赞同：3
> 
> 时间：2008-11-23T23:13:40.210
> 
> 标签：path, subdirectory, file-not-found, htdocs

我有一个 html (dreamweaver CSS3) 的站点目录，其中包含许多子目录，其中包含许多下拉菜单的 HTML 文件。它们在原处工作正常，但它们都有 JavaScript 菜单，可以保存在单独的文件中。所以，我想使用包含。我不想每次我想测试包含时都将我的文件 FTP 到 HostGator。我想在我的本地机器上安装它。因此，我第一次尝试设置 XAMMP，然后在 localhost 上运行我的 html 文件（站点），这样我就可以在将所有内容通过 ftp 传输到 HostGator 并将其上线之前查看它们的样子。

我尝试将主站点文件夹复制到 htdocs，然后将路径复制到我想在 Firefox 的本地主机前运行的文件，但它给了我找不到文件： [http://localhost/xampp/PL_20080923/0- Sections/000-ComingSoon/PHPTestComingSoonNMBT-Test.html](http://localhost/xampp/PL_20080923/0-Sections/000-ComingSoon/PHPTestComingSoonNMBT-Test.html)

我有太多的子目录吗？为什么找不到文件？它就在那里。

也试过这个： [http://localhost/xampp/htdocs/PL_20080923/0-Sections/000-ComingSoon/PHPTestComingSoonNMBT-Test.html](http://localhost/xampp/htdocs/PL_20080923/0-Sections/000-ComingSoon/PHPTestComingSoonNMBT-Test.html)

不去。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-23T23:43:49.307

[http://localhost/](http://localhost/)应该等同于 xampp/htdocs/ （即相同的文件应该可以访问但由网络服务器提供服务。）这是文档根目录。因此，例如在普通的 Windows xampp 安装中，[http://localhost/index.html](http://localhost/index.html)应该服务于 c:\xampp\htdocs\index.html。

你试过[http://localhost/PL_20080923/0-Sections/000-ComingSoon/PHPTestComingSoonNMBT-Test.html](http://localhost/PL_20080923/0-Sections/000-ComingSoon/PHPTestComingSoonNMBT-Test.html)吗？

# c - 用C读取FAT12图像文件

> ID：313107
> 
> 赞同：3
> 
> 时间：2008-11-23T23:23:53.840
> 
> 标签：c, file, binary, filesystems

我有一个 FAT12 图像文件，我必须打开它并阅读它。我想查看此图像文件（包含 in 的目录/文件），以便了解我应该得到什么结果。有人知道可以让我查看这个 FAT12 图像文件的好软件吗？尝试读取此图像文件的内容时，也有人可以指导正确的方向吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-23T23:28:40.133

周围有许多开源 FAT 文件系统实现。

我认为有一个很好的清晰可移植代码，虽然有错误，特别是在 FAT12 实现中，是[http://www.larwe.com/zws/products/dosfs/index.html](http://www.larwe.com/zws/products/dosfs/index.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-23T23:26:14.537

在 Linux 上，您可以使用环回设备挂载它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T11:55:54.540

有一个名为[emFile](http://www.segger.com/emfile.html)的 Segger 文件系统。它是可移植的 fs，我有 emFile 以最少的（几乎没有，需要为每个操作系统实现的一些简单功能）开发工作来处理许多嵌入式操作系统。它[也不贵](http://www.segger.com/pricelist_emfile.html)，我的意思是，如果你为了好玩而做某事，你可能根本不想花钱，但用于商业用途它很便宜。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T12:32:36.650

[http://hachoir.org/wiki/hachoir-parser](http://hachoir.org/wiki/hachoir-parser)

高温高压

# drawing - wxWidgets：有什么方法可以避免或加速 wxBitmap::ConvertToImage()？

> ID：313108
> 
> 赞同：2
> 
> 时间：2008-11-23T23:24:39.017
> 
> 标签：drawing, wxwidgets, scaling

为了获得一些平滑的图形，我想通过因子 2 绘制过采样然后按比例缩小。

所以我正在做的是在*wxMemoryDC*中的*wxBitmap*上绘制过采样，然后在复制到我的 dc 之前将其缩小。下面的代码工作正常，但*bitmapOversampled.ConvertToImage();* 非常慢。

有没有什么方法可以实现同样的效果，而不必从 wxBitmap 转换为 wxImage，反之亦然？

```
 void OnPaint
    ( wxPaintEvent& event )
    {
        wxBitmap bitmapOversampled(m_width * 2, m_height * 2);
        wxMemoryDC memDC(bitmapOversampled);

        // Draw the elements.
        drawElements(&memDC);

        // Scale to correct size.
        wxImage image = bitmapOversampled.ConvertToImage();
        image.Rescale(m_width, m_height);
        memDC.SelectObject(wxBitmap(image));

        // Copy to dc.
        wxPaintDC dc(this);
        dc.Blit(0, 0, m_width, m_height, &memDC, 0, 0);
    }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-23T23:46:45.743

可悲的是，没有可移植的 wx 方法可以更快地进行缩放。但是在wxBitmap的Gtk端口中有一个Scale方法。您可以将它用于 wxGTK。对于 wxMSW，您可以使用 win32 API 的 StretchBlt。wxDC 中有一些方法可以为您提供 Windows 的本机 HDC 句柄。

如果你直接画，你可以让它更直接一些：

```
wxPaintDC dc(this);
dc.DrawBitmap(image, 0, 0, false); 
```

此外，不要在每个绘制事件中重新创建位图。将其存储为成员，并仅在获得`wxSizeEvent`. 它可能会大大加快您的程序。

另一种方法是完全放弃缩放并使用[wxGraphicsContext](http://docs.wxwidgets.org/stable/wx_wxgraphicscontext.html#wxgraphicscontext)。它在 wxGTK 上使用 Cairo，在 wxMSW 上使用 gdi+。它相对较新，但可以绘制抗锯齿。

# windows - Windows 上有 /dev/null 吗？

> ID：313111
> 
> 赞同：455
> 
> 时间：2008-11-23T23:28:38.573
> 
> 标签：windows

`/dev/null`在 Windows 上相当于什么？

* * *

## 回答 #1

> 赞同：537
> 
> 时间：2008-11-23T23:30:34.527

我认为您希望`NUL`，至少在命令提示符或批处理文件中。

例如：

```
type c:\autoexec.bat > NUL 
```

不创建文件。

（我*相信*如果您尝试以编程方式创建文件也是如此，但我还没有尝试过。）

在 PowerShell 中，您需要`$null`：

```
echo 1 > $null 
```

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2008-11-23T23:32:55.507

根据[GCC 邮件列表上的这条消息](http://gcc.gnu.org/ml/gcc-patches/2005-05/msg01793.html)，您可以使用文件“nul”而不是 /dev/null：

```
#include <stdio.h>

int main ()
{
    FILE* outfile = fopen ("/dev/null", "w");
    if (outfile == NULL)
    {
        fputs ("could not open '/dev/null'", stderr);
    }
    outfile = fopen ("nul", "w");
    if (outfile == NULL)
    {
        fputs ("could not open 'nul'", stderr);
    }

    return 0;
} 
```

（此代码归功于[Danny](http://mailto:danny_smith_0000.yahoo.co.nz)；从他的消息中复制粘贴。）

您也可以通过重定向使用这个特殊的“nul”文件。

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2015-01-05T04:56:21.907

`NUL`在 Windows 中似乎实际上是任何文件夹中的虚拟路径。就像`..`在`.`任何文件系统中一样。

使用任何带有 NUL 的文件夹都可以。

例子，

```
echo 1 > nul
echo 1 > c:\nul
echo 1 > c:\users\nul
echo 1 > c:\windows\nul 
```

`/dev/null`与在 Linux 上的效果相同。

这是在 Windows 7 64 位上测试的。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2008-11-24T01:31:00.290

乔恩斯基特是正确的。这是 Windows Embedded 文档中的[Nul Device Driver](http://msdn.microsoft.com/en-us/library/aa939249.aspx)页面（我不知道为什么它不在其他地方......）。

这是另一个：

*   [注册表中的空设备](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/regentry/29888.mspx?mfr=true)
*   [特殊文件名](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/prork/prdf_fls_zgxb.mspx?mfr=true)
*   [更多关于文件命名](http://msdn.microsoft.com/en-us/library/aa365247(VS.85).aspx)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2017-05-24T16:29:26.307

`NUL`也以编程方式工作。例如以下：

```
freopen("NUL", "w", stderr); 
```

无需创建文件即可按预期工作。(MSVC++ 12.0)

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2018-06-02T00:03:43.180

如果您需要在 Microsoft Windows 中执行与`/dev/null`Linux 中的符号链接等效的操作，您可以打开管理员`cmd`并键入：

**对于文件：**

```
mklink c:\path\to\file.ext NUL: 
```

**或者，对于目录：**

```
mklink /D c:\path\to\dir NUL: 
```

这将使文件/目录始终保持在 0 字节，并且仍然对每次写入尝试返回成功。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-12-02T00:26:10.037

您必须在**Windows PowerShell**中为此使用***start***和***$NUL***：

 **输入此命令，假设`mySum`是您的应用程序的名称，并且`5` `10`是您发送的命令行参数。

```
start .\mySum  5 10 > $NUL 2>&1 
```

该`start`命令将启动一个分离的进程，与`&`. 如果您正在运行的程序是控制台应用程序，该`/B`选项会阻止启动打开新的终端窗口。并且`NUL`是 Windows 的`/dev/null`. 最后`2>&1`将 stderr 重定向到 stdout，这将全部转到`NUL`.

# wpf - WPF UserControl 公开 ActualWidth

> ID：313124
> 
> 赞同：3
> 
> 时间：2008-11-23T23:40:21.170
> 
> 标签：wpf, binding, user-controls, readonly, actualwidth

如何`ActualWidth`向用户公开我的用户控件组件之一的属性？

我找到了很多关于如何通过创建新的依赖属性和绑定来公开普通属性的示例，但没有关于如何公开只读属性（如`ActualWidth`.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-25T15:25:16.817

您需要的是 ReadOnly 依赖属性。您需要做的第一件事是利用`ActualWidthProperty`您需要公开的控件的依赖关系的更改通知。你可以通过使用`DependencyPropertyDescriptor`这样的来做到这一点：

```
// Need to tap into change notification of the FrameworkElement.ActualWidthProperty
Public MyUserControl()
{
   DependencyPropertyDescriptor descriptor = DependencyPropertyDescriptor.FromProperty
       (FrameworkElement.ActualWidthProperty, typeof(FrameworkElement));
   descriptor.AddValueChanged(this.MyElement, new EventHandler
            OnActualWidthChanged);
}

// Dependency Property Declaration
private static DependencyPropertyKey ElementActualWidthPropertyKey = 
      DependencyProperty.RegisterReadOnly("ElementActualWidth", typeof(double), 
      new PropertyMetadata());
public static DependencyProperty ElementActualWidthProperty = 
      ElementActualWidthPropertyKey.DependencyProperty;
public double ElementActualWidth
{
   get{return (double)GetValue(ElementActualWidthProperty); }
}
private void SetActualWidth(double value)
{
   SetValue(ElementActualWidthPropertyKey, value);
}

// Dependency Property Callback
// Called when this.MyElement.ActualWidth is changed
private void OnActualWidthChanged(object sender, Eventargs e)
{
   this.SetActualWidth(this.MyElement.ActualWidth);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T07:50:10.777

`ActualWidth`是一个公共只读属性（来自`FrameworkElement`），默认公开。您要达到的目标是什么？

# .net - .net 和多核

> ID：313127
> 
> 赞同：2
> 
> 时间：2008-11-23T23:43:12.897
> 
> 标签：.net, multicore

从我读过的 .net 4.0 预览到现在，关于下一个 .net 版本将如何处理和使用多核 CPU 的讨论很多。我们将添加诸如 plinq 之类的附加功能，以帮助我们利用多个内核。我的问题是，当我只想让我的应用程序运行得更快时，为什么还要费心处理多个内核。为什么不能有一种虚拟 cpu 层将所有核心作为一个核心暴露给我的应用程序？

编辑：我想重新表述我的问题以避免误解，是否可以制作一个软件来向我的应用程序公开一个虚拟线程，因为它使用 10 个内核，所以速度会快 10 倍。我不想让不同的线程并行做事，我只想让我的一个线程运行得更快。我想今天这不是一个大问题，但很快我们将有 80 个核心处理器可供使用，然后我会觉得只使用其中的一个会有点人手不足。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-23T23:50:10.823

因为没有人的帮助就无法完成并行化。

有一定数量的*可以*完成 - 并且已经在单个核心内完成*。*由于显而易见的原因，微并行比“分析整个程序并使其并行运行”要容易得多。一般来说，编写并行程序时必须做出的许多困难决定取决于您希望程序做什么，以及它在各种条件下的行为方式。

随着时间的推移，更多的东西可能会自动并行化，但我很高兴目前手动操作变得更加容易。

编辑：在你的问题中看到了编辑，没有办法让它更快。有一个非常简单的物理比喻：怀孕需要 9 个月。如果你有9个孕妇，9个月后你可以生9个孩子，但你不能让9个女人在1个月内生1个孩子。它只是不能那样工作。并非所有问题都是可并行的。（弗雷德布鲁克斯：“一个孩子的生育需要九个月，不管有多少女人被分配。”（神话男人月，第 17 页））

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-23T23:49:42.960

您首先误解了多核的意义。

使用多个内核，您可以并行（同时）执行两个或多个不同的操作。这称为线程。

这不能自动完成，因为您编写的“正常”程序是线性的。在不考虑副作用的情况下，您无法轻松地将一系列指令转换为多个指令系列。

例如，GPU（显卡上的专用 CPU）可能包含数百个“核心”（流处理器），它们并行运行以在屏幕上渲染像素。只有一个处理器，您必须在超快处理器上逐像素渲染才能达到相同的效果。

CPU 制造商转向多核的原因是因为以更高的速度制造单核变得越来越困难和昂贵，而且单核会比速度减半的两个核（基本上；并非在所有情况下都是如此）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T11:07:24.373

是也不是。如果您希望能够正常编程，但让系统“神奇地”使用多个线程，那么您需要查看一些多处理框架。例如：[OpenMP](http://openmp.org/wp/)。

如果你想通过一个数组，使用你所有的内核，代码类似于：

```
int main(int argc, char **argv) {
    const int N = 100000;
    int i, a[N];

    #pragma omp parallel for
    for (i = 0; i < N; i++)
        a[i] = 2 * i;

    return 0;
} 
```

Just adding the #pragma makes your code magically multi-threaded. Now, you will have to understand some restrictions, eg. you cannot use the value of one element in the processing of the next (ie you cannot set a[0] to 1, then a[1](http://openmp.org/wp/) to a[0]+1, etc as they'll no doubt be processed by different threads, and therefore may not be computed when you need them) or you'll get an error from the openmp compiler, but if you work within these restrictions (and there are many) then you can get what you want.

The restrictions are what makes your ultimate goal of making your code impossible. As in my example, you simply cannot compute 1 element based on another unless the first element is already computed. This effectively means code like that *can only* be single-threaded, no matter how many cores you have.

It also means that 80-core chips will not really take off anytime soon, not unless they are all 3Ghz general purpose processors, so you don't need to worry too much about having to code for them. Now, add-on co-processors that can crunch arrays coded like in my example, that's another matter, and I expect to see more of that in the future. You'll probably [use the graphics card for that kind of thing](http://en.wikipedia.org/wiki/OpenCL) and have thousands of 'cpus' instead of a mere 80.

# iphone - iPhone 文档 - 我可以观看 Linux 的入门视频吗？

> ID：313135
> 
> 赞同：0
> 
> 时间：2008-11-23T23:54:47.817
> 
> 标签：iphone, documentation, iphone-video

在 Apple iPhone 开发者中心，他们有一些视频，例如“iPhone SDK 简介”、“iPhone 开发工具概述”等。

问题是我的mac还没有到。有什么方法可以在我的 Linux 系统上观看这些视频吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T00:09:37.490

不确定苹果的，但这个非常擅长入门：

[克里斯托斯博客](http://iphone.christosblog.com/)

他们跳入代码和工具，而不是花太多时间解释工具。我想他们会帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T02:24:38.437

我相信您需要从需要 Mac 或 PC 的 iTunes 下载它们，但它们是标准的 mpeg-4 视频，应该可以在 vlc 中查看。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T03:11:44.847

重点是什么？Xcode 和 iPhone SDK 无论如何只能在 Mac OS X 上运行。观看你不能玩的东西的视频只是一种挑逗。

# mysql - 如何使用 Rails 2.1 和 MySQL 定义 BigInt 主键？

> ID：313136
> 
> 赞同：2
> 
> 时间：2008-11-23T23:58:04.457
> 
> 标签：mysql, ruby-on-rails, biginteger

从 Rails 2.1 开始，如果你在迁移中定义一个类型设置为 :integer 且 :limit 设置为 5 或更多的新列，那么在 MySQL 数据库中实际创建的列将是 BigInt 类型。那很完美。

但我无法弄清楚如何使用 BigInt 主键创建表。

有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T00:06:26.030

我只是偶然发现了[这个插件](http://svn.northpub.com/plugins/mysql_bigint/README)：它似乎回答了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-16T15:58:15.057

这适用于rails 3，不确定它是否适用于rails 2。

在我的整个应用程序中，我需要我的主键是 bigint 无符号的。我最终做的是把我的 config/environment.rb

```
require 'active_record/connection_adapters/mysql2_adapter'
ActiveRecord::ConnectionAdapters::Mysql2Adapter::NATIVE_DATABASE_TYPES[:primary_key] =
  "BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY".freeze 
```

这让 rails 可以自动将 id 创建为 BigInts。当我从另一个表进行参考时，我会执行以下操作

```
t.column :product_id, 'BIGINT UNSIGNED' 
```

# sql - 使用 django 如何将来自不同模型的两个查询组合成一个查询？

> ID：313137
> 
> 赞同：12
> 
> 时间：2008-11-23T23:58:18.420
> 
> 标签：sql, django, django-models

在我的具体情况下，我有两种需要检索和分页的“消息”。

我们省略细节，只说第一种在名为Msg1的模型中，另一种称为Msg2

这两个模型的字段是完全不同的，两个模型共同的唯一字段是“日期”和“标题”（当然还有id）。

我可以得到`Msg1.objects.all()`，`Msg2.objects.all()`但我可以将这两个查询组合成一个查询，按日期排序，然后分页吗？

我需要保留查询的惰性。

简单的解决方案是`list(query)`同时查询并将它们组合在 python 列表中。但由于显而易见的原因，这是低效的。

我查看了模型和 dp-api 上的 django 引用，但似乎没有一种方法可以将不同模型/表的查询组合成一个。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-24T00:35:42.353

我建议您使用[模型继承](http://docs.djangoproject.com/en/dev/topics/db/models/#id4)。

创建一个包含日期和标题的基础模型。如所述，子类 Msg1 和 Msg2 关闭它。使用基本模型执行所有查询（以填充页面），然后在最后一刻切换到派生类型。

继承的真正好处是 django 允许您在其他模型的外键中使用基本模型，因此您可以使整个应用程序更加灵活。在引擎盖下，它只是基本模型的一个表，每个子模型包含一个包含一对一键的表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T00:10:39.423

“将这两个查询合并为一个查询，按日期排序，并分页？”

1.  这就是 SQL 联合。离开 Django ORM 并使用 SQL 联合。它的速度并不快，因为 SQL 必须创建一个临时结果，并对其进行排序。

2.  创建可以排序的临时结果。由于列表具有排序方法，因此您必须将两个结果合并到一个列表中。

3.  编写一个接受两个查询集的合并算法，对结果进行分页。

* * *

编辑。这是一个合并算法。

```
def merge( qs1, qs2 ):
    iqs1= iter(qs1)
    iqs2= iter(qs2)
    k1= iqs1.next()
    k2= iqs2.next()
    k1_data, k2_data = True, True
    while k1_data or k2_data:
        if not k2_data:
            yield k1
            try:
                k1= iqs1.next()
            except StopIteration:
                k1_data= False
        elif not k1_data:
            yield k2
            try:
                k2= iqs2.next()
            except StopIteration:
                k2_data= False
        elif k1.key <= k2.key:
            yield k1
            try:
                k1= iqs1.next()
            except StopIteration:
                k1_data= False
        elif k2.key < k1.key: # or define __cmp__.
            yield k2
            try:
                k2= iqs2.next()
            except StopIteration:
                k2_data= False
        else:
            raise Exception( "Wow..." ) 
```

您可以折叠分页：

```
def paginate( qs1, qs2, start=0, size=20 ):
    count= 0
    for row in merge( qs1, qs2 ):
        if start <= count < start+size:
            yield row
        count += 1
        if count == start+size:
            break 
```

# asp.net-mvc - 如何缩小标签的大小

> ID：313139
> 
> 赞同：0
> 
> 时间：2008-11-24T00:03:06.210
> 
> 标签：asp.net-mvc, css

对 css 来说很新，并试图使我页面上的标签在所有方面都更小。修改的最佳设置是什么？保证金似乎没有做我想要的。

```
.story .content .tags .tag
{
    margin: 10px 5px 10px 5px;
    background-color: #99FF33;
    font-weight: 500;
    color: #330099;
    font-style: inherit;
    font-family: 'Times New Roman';
    padding-right: 6px;
} 
```

这是相关的片段，我想让链接垂直变小。那么我需要明确指定高度吗？：

```
<span class="tags"><span class="text">:</span>
                    <% for (int i = 0; i < story.Tags.Length; i++) %>
                    <% { %>
                    <%     string tag = story.Tags[i]; %>
                    <%     if (i > 0) %>
                    <%     { %>
                    <%=         " "%>
                    <%     } %>
                    <%=     Html.ActionLink<StoryController>(c => c.Tag(tag.UrlEncode(), 1), Server.HtmlEncode(tag), new { @class = "tag" })%>
                    <% } %>
                </span> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T00:39:35.123

这完全取决于您要设计的样式。它是像段落这样的文本组件吗？一个分区？

您可以在 div 上使用宽度和高度。

```
 width:200px;
 height:20px; 
```

等等

但是我们需要一些 html 来推荐有意义的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T03:20:02.130

如前所述，如果您试图降低内联元素的垂直高度，则顶部或底部边距/填充将不会做任何事情。但是，您可能想尝试减少文本的行高：

```
 line-height: 12px; 
```

只是不要使 line-height 比 the 小，`font-size`否则您的文本可能会被剪裁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T01:17:11.100

此外，如果您将其应用于 A 或 SPAN 等内联元素，您会发现垂直值不适用。您没有提供足够的上下文让我们做出明智的评论 - 尝试链接到显示问题的页面，我们不必为您猜测解决方案！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T01:28:46.287

仅从实际的类名来看，您似乎正在绑定标签云中的样式标签？如果是这种情况，我认为您可能想尝试使填充更小一些：

```
padding:3px; 
```

如果它们是内联元素，那么您将不会有任何利润。

如果我是读心者，我只能告诉你更多:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T00:41:46.490

我认为您正在寻找填充物。我的猜测是，您希望减少文本边缘与背景颜色停止填充（基本上）以及边框开始位置之间的空间，并且更改填充将产生您想要的效果。

如果要减小字体大小，请查看 font-size 属性。另外，查看 line-height 属性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T09:42:06.057

好的，ASP.NET MVC 中的 HTML.ActionLink 创建锚标记（A，又名“链接”）。默认情况下，A 标记的显示样式为“内联”。这意味着 Bryan M 的答案将适合您的需求。只需将 line-height 声明为大于或等于字体大小的高度。

另一种选择是将显示样式更改为“inline-block”，这将允许您设置明确的高度和宽度。如果您希望所有标签的大小相同，这将很有用。

```
.tag
{
    display: -moz-inline-block; /* For FF2 */
    display: inline-block; /* For everyone else */
    height: 12px;
    overflow: hidden;
} 
```

请注意 FireFox 2 特定的语法。FF3没有这个问题。

阅读您可以在[W3C](http://www.w3.org/)找到的当前[CSS 标准 (2.1)](http://www.w3.org/TR/CSS21/)可能会有所帮助。您可能对[视觉格式化模型部分](http://www.w3.org/TR/CSS21/visuren.html)特别感兴趣。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T11:52:41.427

为了将尺寸和/或填充应用于对象，它应该是块级元素，而不是内联元素。<span> 是内联元素，不太适合像标签列表这样的东西。尝试这样的事情：

```
<style>
.tags {
float: left;
border: 1px solid blue;
list-style-type: none;
}
    .tags li {
    float: left;
    margin-right: 6px;
    font-family: 'Times New Roman';
    }
        .tags li a {
        display: block;
        padding: 0 5px;
        text-decoration: none;
        color: #330099;
        background-color: #99FF33;
        }
            .tags li a:hover {
            background-color: #330099;
            color: #99FF33;
            text-decoration: none;
            }
</style>

<ul class="tags">
    <% for (int i = 0; i < story.Tags.Length; i++) { %>
        <% string tag = story.Tags[i]; %>
        <li><%= Html.ActionLink<StoryController>(c => c.Tag(tag.UrlEncode(), 1), Server.HtmlEncode(tag), new { @class = "tag" })%></li>
    <% } %>
</ul> 
```

这将为您提供语义上正确的标签“列表”，左对齐并能够为每个项目提供填充和边距。我还冒昧地添加了一个 :hover 样式并删除了“:”（蓝色轮廓只是为了向您显示列表本身的大小）。试一试，希望您喜欢结果，并祝您的项目好运！

# c++ - 不一致导致的static_cast混淆

> ID：313141
> 
> 赞同：1
> 
> 时间：2008-11-24T00:03:42.637
> 
> 标签：c++, casting, double, int

为什么每当我在 Visual Studio 2008 中编译和运行以下代码时：

```
double value1 = 10.5;
double value2 = 15.5;
int whole_number = value1 + value2;
Console::WriteLine(whole_number); 
```

当答案是 25 时，我得到了一个不正确的值 26。

但是，当我在双打上使用静态强制转换时，我得到的正确答案是 25。

如何解释错误的输出？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-24T00:07:22.130

这是绝对正确的。

```
double value1 = 10.5;
double value2 = 15.5;
int whole_number = value1 + value2; // int whole_number = 26.0;
Console::WriteLine(whole_number); 
```

相反，你会期待什么？编译器首先计算右侧，然后隐式转换为 int。因此，`26.0`变成`26`

当您在添加之前进行转换时，您将添加`10`and `15`，这会导致`25`:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T01:38:18.343

实际上，在进行自动转换时，您不能依赖浮点数来舍入任何一种方式。如果 26.0 用 26.00005 表示，则四舍五入为 26，如果用 25.999995 表示，则四舍五入为`round`25 `math.h`。这么说*，26.0 变成 26*并不完全正确。

# git - Windows 中的 Git 调试问题 (MsysGit)

> ID：313146
> 
> 赞同：4
> 
> 时间：2008-11-24T00:07:52.347
> 
> 标签：git

我在 windows 上遇到了 git 的一个经常性问题（我从包 Git-1.6.0.2-preview20080923.exe 运行 MSysGit，我也尝试使用 Git-1.5.6.1-preview20080701.exe，结果是一样的）。

当我没有更改它们时，某些文件显示为已更改，并且在 git-gui 中显示删除的内容与添加的内容相同（通常是整个文件），即
`- This line was here before`
`- This line was here before as well`
`- and this line too...`
`+ This line was here before`
`+ This line was here before as well`
`+ and this line too...`

我尝试使用**`git checkout -f`**and **`git reset --hard`**，但文件保持不变。我也尝试在硬重置之前删除文件。我试着用谷歌搜索它，但找不到任何相关的东西。
你能告诉我如何解决这个问题，或者你会采取什么步骤来确认这是 Git 而不是我的系统的问题，所以我可以将其报告为错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T02:09:00.840

如果您没有在文本编辑器或 Git 配置中处理该问题，您可能会遇到行尾问题。

要在 Git 中解决此问题，请在 Git 配置文件中设置 autocrlf 选项：

```
$ git config --global core.autocrlf true 
```

这会导致 git 在签出文件时将换行符转换为系统标准，并在提交时将换行符转换为 LF 换行符。然后您将需要签出一个新的工作副本，它将根据 autocrlf 设置过滤行尾。

```
$ git reset --hard HEAD
$ git commit -a 
```

这会提交通过标准化行尾而更改的任何文件，因此现在您的 repo 是一致的，并且您不会产生更多的行尾问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T18:42:48.937

如果您使用的是 Visual Studio，则可能是 Visual Studio 将制表符转换为空格 (#@%$#)。您可以在 Visual Studio 设置中的某处关闭此“功能”。您也可以将 git 设置为不检查空格更改，但我不建议这样做。

上面设置 autocrlf 的建议可能有效，但在您使用的 Git 版本中默认设置为 true。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-31T18:39:13.080

In VS2008, the setting for converting tabs to spaces is Tools -> Options -> Text Editor -> -> Tabs, where you select the radio button at the buttom of the window.

# java - jconsole 可以与 Java EE 一起使用吗？

> ID：313157
> 
> 赞同：2
> 
> 时间：2008-11-24T00:18:47.380
> 
> 标签：java, jakarta-ee, jmx, jconsole

我看到的所有示例都是通过在命令行传递 JAR 文件来针对 Java SE 应用程序的。JConsole 可以附加到 WAR 或 EAR 并监控应用程序性能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T01:04:01.343

JConsole 用于监控 JVM。我假设您想监控应用程序服务器的性能。为此，您必须在初始化应用程序服务器时设置 com.sun.management.jmxremote 属性。

例如，在 Tomcat（我知道这不是一个完整的 Java EE 容器）中，您可以将容器启动为：

```
>startup.bat -Dcom.sun.management.jmxremote 
```

然后您可以将 JConsole 作为独立应用程序启动

```
>jconsole 
```

然后将 jconsole 附加到运行 Tomcat 的 Java 进程。类似的步骤适用于其他应用程序服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T08:45:44.330

如果您使用的是 Tomcat，您应该尝试[lambda probe](http://www.lambdaprobe.org)。这是一个一旦安装在 tomcat 上的 war 文件，就可以启用一个具有与 jconsole 类似的监控功能的 web 应用程序。

在 lambda probe web 上也有一个 JBoss 下载，但我只在 tomcat 上测试过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-03T11:40:53.273

如前所述，jconsole 监控 JVM，即整个应用程序服务器实例，而不是部署为 war 或 ear 的特定 Web 应用程序。

如果您正在寻找更细粒度的 Web 应用程序性能监控，您可以尝试查看[JAMon 之](http://jamonapi.sourceforge.net/)类的工具。

# asp.net - asp.net CMS 解决方案：在 SQL 中存储数据的最佳机制

> ID：313160
> 
> 赞同：1
> 
> 时间：2008-11-24T00:20:02.430
> 
> 标签：asp.net, content-management-system, content-management

我曾使用.NET 平台开发过许多CMS 系统（CMS 管理系统在ASP.NET 中，呈现内容的站点是ASP.NET 和PHP）。

传统上，我将生成的内容存储在序列化为 XML 的类中，这些类存储在 MSSQL 2005/2008 中的 varchar(max) 字段中。这使得内容的不同消费者在结构上可以方便地使用，并且可以绑定到类（用于重新打开 CMS 记录并对其进行编辑，或用于消费网站）。

但是，我一直想知道其他 CMS 商店流行哪种类型的存储机制，以及是否有人喜欢或对我最熟悉的方法有严重问题。

好，坏，丑？你会怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T01:26:33.983

我个人将数据视为将存储在系统中的任何其他数据，例如，我有一个为 DNN 构建的模块，用于存储文本数据的集合，我在表中有以下列集合。

*   条目 ID
*   更新者
*   更新日期
*   由...制作
*   创建日期
*   排序
*   内容 (NTEXT)
*   隐藏（位）

我发现这使数据易于查找，并且无论调用者如何都易于操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T13:36:21.777

在我们的 CMS 中，我们使用与 Mitchel Sellers 所描述的类似的结构，但我们将内容分隔在其自己的表格中。这在优化数据库时很有用，并允许我们轻松共享内容版本控制的功能。然后，我们为每个“实体类型”（如文档、产品等）提供一个表格，用于描述实体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T23:50:41.060

我们有一个 ASP.NET CMS 作为我们的主要产品，所以我很熟悉这个问题。这取决于您所说的“生成的内容”是什么意思。如果您的意思是用户输入的，那么我们使用表格结构将 HTML 存储为 ntext 和其他页面元素，该结构允许我们为每个页面元素拥有一组灵活的字段（有些配置使用一个或两个字段，其他则有几十个）。

这样做的主要好处是数据库中的数据代表了用户实际输入的内容。将 XML 存储在 SQL 数据库中只是添加了一层我们不需要的重定向。您可能试图让 SQL 像 OO 存储一样工作，这是 ORM 帮助解决的典型问题。

您可能会遇到的一个问题是难以将现有的 SQL 搜索机制与 XML 数据一起使用。

# ruby-on-rails - 从 rails 2.1.1 迁移到 2.2.2

> ID：313176
> 
> 赞同：4
> 
> 时间：2008-11-24T00:39:55.823
> 
> 标签：ruby-on-rails

我正在使用 rails 2.1.1 开发一个项目。随着 2.2.2 的新版本，我想迁移到新版本。为了迁移我的 2.1.1 控制器、视图和模型，我需要更改什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T14:05:08.303

不要忘记运行 update Rake 任务

```
rake rails:update 
```

这将继续并确保它更新任何脚本和配置以反映 2.2。

安装 2.2 后，发出：

```
rake -T 
```

要查看可用的任务，请仔细检查它是否存在，然后继续并启动它，您将启动并运行。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T02:26:14.657

做事的方式没有任何重大变化。这是[弃用列表](http://guides.rubyonrails.org/2_2_release_notes.html#_deprecated)

当然，快速发现变化的最好方法是拥有一个好的测试套件。如果您没有，我建议将 2.2 放入 vendor/rails 并手动单击站点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T15:03:55.597

如果您有任何损坏的插件，请查看 GitHub。我有一堆插件没有官方修复。我搜索了 GitHub，人们已经对其进行了修补。使升级变得更好，然后它本来可以。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T14:51:22.843

并不真地。我必须同意@dasil003 并说要检查弃用，并在更新后相应地运行您的测试。但是，您需要 ruby​​gems 1.3.1 才能升级，所以不要忘记这样做，否则您的应用服务器将无法启动。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-06T00:28:12.610

您还需要清除现有的 /vendor/plugins/activescaffold 目录，并将其替换为与 rails 2.2 兼容的目录。否则你会得到可怕的（并且记录不充分）“没有方法'pick_template'错误”。

为此，您需要在应用程序基目录中运行以下命令：

script/plugin install git://github.com/activescaffold/active_scaffold.git -r 'rails-2.2' # 必要时添加 --force

接下来，添加： script/plugin install git://github.com/ewildgoose/render_component.git -r rails-2.2

我遇到了从 2.1 到 2.3 的迁移，但我在其他地方读到过这个问题从 2.1 到 2.2 也很猖獗。添加以节省其他人的麻烦。

# windows - 在 Windows 中，对 500k 行文件执行 dos2unix 的最佳方法是什么？

> ID：313178
> 
> 赞同：6
> 
> 时间：2008-11-24T00:41:18.660
> 
> 标签：windows, text-files, dos2unix

问题说明了一切，我有一个 500,000 行的文件，它是作为 Windows 机器上自动构建过程的一部分生成的，并且充满了**^M**。当它出门时需要***nix**友好，这里最好的方法是什么，是否有一个方便的代码片段可以为我做到这一点？还是我需要编写一个小 C# 或 Java 应用程序？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-24T01:01:56.747

这是一个 Perl 单行代码，取自[http://www.technocage.com/~caskey/dos2unix/](http://www.technocage.com/~caskey/dos2unix/)

```
#!/usr/bin/perl -pi
s/\r\n/\n/;
```

您可以按如下方式运行它：

```
perl dos2unix.pl < file.dos > file.unix 
```

或者，您也可以以这种方式运行它（转换就地完成）：

```
perl -pi dos2unix.pl file.dos 
```

这是我的（天真的）C 版本：

```
#include <stdio.h>

int main(void)
{
   int c;
   while( (c = fgetc(stdin)) != EOF )
      if(c != '\r')
         fputc(c, stdout);
   return 0;
} 
```

您应该使用输入和输出重定向运行它：

```
dos2unix.exe < file.dos > file.unix 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-24T02:24:09.747

如果安装一个基本的[cygwin](http://www.cygwin.com/)太繁重，网上有许多独立的`dos2unix`和`unix2dos`基于 Windows 独立控制台的程序，其中许多都提供 C/C++ 源代码。如果我正确理解了需求，那么这些解决方案中的任何一个都可以很好地适合自动构建脚本。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-24T01:07:27.797

如果您在 Windows 上并且需要在批处理脚本中运行某些东西，您可以编译一个简单的 C 程序来解决这个问题。

```
#include <stdio.h>

int main() {
    while(1) {
        int c = fgetc(stdin);

        if(c == EOF)
            break;

        if(c == '\r')
            continue;

        fputc(c, stdout);
    }

    return 0;
} 
```

用法：

```
myprogram.exe < input > output 
```

就地编辑会有点困难。此外，您可能出于某种原因想要保留原件的备份（例如，以防您不小心删除了二进制文件）。

该版本删除**了所有**CR 字符；如果您只想删除 CR-LF 对中的那些，您可以使用（这是经典的单字符返回方法 :-)：

```
/* XXX Contains a bug -- see comments XXX */

#include <stdio.h>

int main() {
    int lastc = EOF;
    int c;
    while ((c = fgetc(stdin)) != EOF) {
        if ((lastc != '\r') || (c != '\n')) {
            fputc (lastc, stdout);
        }
        lastc = c;
    }
    fputc (lastc, stdout);
    return 0;
} 
```

您可以使用模式“r+”就地编辑文件。下面是一个通用的 myd2u 程序，它接受文件名作为参数。注意：这个程序使用 ftruncate 在结尾处去掉多余的字符。如果有更好的（标准）方法可以做到这一点，请编辑或评论。谢谢！

```
#include <stdio.h>

int main(int argc, char **argv) {
    FILE *file;

    if(argc < 2) {
        fprintf(stderr, "Usage: myd2u <files>\n");
        return 1;
    }

    file = fopen(argv[1], "rb+");

    if(!file) {
        perror("");
        return 2;
    }

    long readPos = 0, writePos = 0;
    int lastC = EOF;

    while(1) {
        fseek(file, readPos, SEEK_SET);
        int c = fgetc(file);
        readPos = ftell(file);  /* For good measure. */

        if(c == EOF)
            break;

        if(c == '\n' && lastC == '\r') {
            /* Move back so we override the \r with the \n. */
            --writePos;
        }

        fseek(file, writePos, SEEK_SET);
        fputc(c, file);
        writePos = ftell(file);

        lastC = c;
    }

    ftruncate(fileno(file), writePos); /* Not in C89/C99/ANSI! */

    fclose(file);

    /* 'cus I'm too lazy to make a loop. */
    if(argc > 2)
        main(argc - 1, argv - 1);

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-24T00:52:12.243

```
tr -d '^M' < infile > outfile 
```

您将输入 ^M 为： ctrl+V , Enter

*编辑*：您可以使用 '\r' 而不是手动输入回车，[*感谢@strager* ]

```
tr -d '\r' < infile > outfile 
```

*编辑 2 ：'tr' 是一个 unix 实用程序，您可以从*[http://unxutils.sourceforge.net](http://unxutils.sourceforge.net) [*感谢@Rob Kennedy* ]下载本机 Windows 版本或使用[cygwin](http://www.cygwin.com/)的 unix 仿真。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T00:50:05.740

将它从 dos 框 ftp 到 unix 框，作为 ascii 文件，而不是二进制文件。Ftp 将剥离**crlf**并插入**lf**。将其作为二进制文件传回dos box，**lf**会被保留。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-24T01:24:52.707

一些文本编辑器，例如[UltraEdit/UEStudio](http://www.ultraedit.com)内置了这个功能。

`File > Conversions > DOS to UNIX`

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-11-24T02:42:06.577

如果它只是一个文件，我使用记事本++。很好，因为它是免费的。我安装了 cygwin 并使用我为多个文件编写的一个衬里脚本。如果您对脚本感兴趣，请发表评论。（我现在没有它可用。）

# wpf - 如何在 MS Access VBA 表单中托管 WPF 控件？

> ID：313182
> 
> 赞同：2
> 
> 时间：2008-11-24T00:43:22.977
> 
> 标签：wpf, ms-access, migration, vsto, legacy-code

我们有一个大型 MS Access 项目，它需要在 VBA/访问表单环境中难以/不可能完成的 GUI 功能。

随着时间的推移，我们希望重写/迁移到以 WPF 作为表示层的托管 C# 环境。

我们做到这一点的唯一实用方法是在更长的时间内 - 首先转换一些 VBA 表单（这将提供最佳的生产力收益），然后在 12-24 个月的过程中转换整个系统。

你认为什么是最好的方法。MS Access 可以在我们转换 WPF 表单时托管它们吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T01:03:09.317

如果您查看 Visual Studio Tools for Office (VSTO) 会怎样？您可以使用 C# 为 Office 编写托管的 .NET 插件，它将作为功能区与 Office 集成。

现在，问题是 VSTO AFAIK 不支持 Access 加载项。但是，看看[这里](http://blogs.msdn.com/andreww/archive/2008/02/19/vsto-add-ins-for-access.aspx)，似乎并不是那么不可能。

所以，如果你碰巧幸运的话，你可以

*   为 Access 编写一个 C# 功能区，其中包含您需要的所有高级 GUI
*   用 C# 编写可以从 Access 访问的服务，例如封装重要的业务逻辑，这样您不仅可以逐步移动 GUI，还可以在 C# 中构建适当的域对象模型。

如果您决定尝试一下，请告诉我结果如何 :) 无论如何祝您好运。

PS其他可能有帮助的东西？ [访问 2007 开发人员扩展 (ADE)](http://msdn.microsoft.com/en-us/office/bb229700.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T01:59:22.030

谢谢 badbadboy - 我一定会尝试这个（使用 VSTO）。

您建议允许 VSTO 与 ms 访问一起使用的[解决方案](http://blogs.msdn.com/andreww/archive/2008/02/19/vsto-add-ins-for-access.aspx)似乎有点骇人听闻 - 我不介意这一点，但如果它不可靠，我对在生产中使用此解决方法感到紧张，即 MS 不会提供支持.

[据我](http://blogs.msdn.com/andreww/archive/2007/08/15/wpf-in-vsto.aspx)所知，这将允许我托管一个*winforms*控件，而该控件又托管一个 WPF 控件。

有人用生产系统走这条路——有什么警告吗？

请注意，codeplex 上有一个[VSTO 访问项目模板](http://www.codeplex.com/VSTO)，它使该过程更容易一些。

# browser - 浏览器的最佳开发“附加”是什么

> ID：313186
> 
> 赞同：4
> 
> 时间：2008-11-24T00:46:03.987
> 
> 标签：browser

我知道带有 YSlow 的 FireBug 必须是我个人的最爱。当被迫在 IE 中测试页面时，我也使用 IE 开发人员工具栏。有没有其他的珠宝藏在那里？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-24T00:49:59.157

我使用 Firefox 的[Web Developer Extension](https://chrispederick.com/work/web-developer/)，有很多有用的选项。

[![https://addons.mozilla.org/en-US/firefox/images/t/11916/943948800](https://i.stack.imgur.com/RnMOY.png)](https://i.stack.imgur.com/RnMOY.png)
[（来源：[mozilla.org](http://addons.mozilla.org/en-US/firefox/images/t/11916/943948800)）]

也喜欢[Live HTTP Headers](https://addons.mozilla.org/en-US/firefox/addon/3829) Extension。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T00:50:12.730

好吧，您已经提到了 FireBug，所以我经常使用的下一个与 Web 相关的工具是 IE Tester ( [http://www.my-debugbar.com/wiki/IETester/HomePage](http://www.my-debugbar.com/wiki/IETester/HomePage) )。

它是一个单一的浏览器，可让您使用 IE 5.5、6、7 和 8。严格来说，它不是“附加组件”，但我认为它仍然符合条件：)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T01:21:26.520

如果您使用的是 Mac，请退出 Safari，然后将其剪切并粘贴到终端窗口中：

```
defaults write com.apple.Safari IncludeDebugMenu "YES" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T00:52:02.820

[Selenium IDE](http://selenium-ide.seleniumhq.org/index.html) - 验收测试让我的生活更加轻松。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T00:53:07.483

在 Firefox 中，[Live Http Headers](https://addons.mozilla.org/en-US/firefox/addon/3829)和[User Agent Switcher](https://addons.mozilla.org/en-US/firefox/addon/59)都是不可或缺的。

虽然我在 .NET 商店工作，但 Firefox 是我的首选浏览器，只是基于核心浏览器的丰富性和稳定性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T01:35:27.287

正如您所提到的，对于 Internet Explorer，[IE Developer Toolbar](http://en.wikipedia.org/wiki/Internet_Explorer_Developer_Toolbar)非常有用。它允许您浏览呈现的 HTML，并将在屏幕上显示该部分（突出显示的块）。我认为它对于调试渲染的 HTML 至关重要。

[Fiddler](http://www.fiddlertool.com/fiddler/)也很有用。Fiddler 是一个 HTTP 调试代理，它记录您的计算机和 Internet 之间的所有 HTTP 流量。Fiddler 允许您检查所有 HTTP 流量、设置断点以及“摆弄”传入或传出数据。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T01:41:26.340

它不是严格意义上的附加组件，因为它作为浏览器的一部分包含在内，但我一直发现 Dragonfly[1] 非常有用。

它具有 FireBug 的所有大部分功能，并且在 Opera 中开箱即用。

[1] [http://www.opera.com/dragonfly/](http://www.opera.com/dragonfly/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-24T01:46:13.320

我曾经喜欢 fiddler，但讨厌使用 Firefox 工作的难度。此外，本地主机的整体不调试（早期问题，可能在最近的版本中修复）在本地开发过程中是一个很大的烦恼。

然后我发现了[FoxyProxy](http://foxyproxy.mozdev.org/)，从那以后生活一直很甜蜜。我还将 Firebug 与 YSlow 一起使用。我唯一一次使用 IE 是为了最终的脚本/css/布局测试。

# php - PHP 5.2.6 / IIS CGI 中的空 $_POST 数组

> ID：313188
> 
> 赞同：0
> 
> 时间：2008-11-24T00:46:35.187
> 
> 标签：php, iis

我在 Windows XP 上使用带 IIS 的 PHP 5.2.6 遇到了一个非常奇怪的问题（已尝试过 CGI 和 ISAPI）。我正在使用默认的 php.ini 设置运行全新安装。

首先，假设以下（丑陋但有效）的 HTML 代码：

```
<form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
<input type="hidden" name="test1" value="foo" />
<input type="hidden" name="test2" value="bar" />
<input type="submit">
</form>
<br /><br />
<pre>
<?php print_r($_POST); ?>
</pre> 
```

提交表单时，我希望它会带出一个包含两个隐藏变量的数组。相反，我看到的只是一个空数组。如果我将表单方法更改为“get”并将 print_r($_POST) 更改为 print_r($_GET)，我会看到数组项没有问题。

我尝试过诸如此类的变体`<?php print file_get_contents('php://input'); ?>`，`<?php echo print_r($HTTP_POST_VARS); ?>`但无济于事。问题可能出在哪里的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T01:12:20.250

好吧，如果有什么安慰的话，您的代码可以在 PHP5 和 Apache 中按预期工作。

一个快速的谷歌揭示了其他几个人有同样的问题，但没有明确的解决方案 - 最接近的是[这个](http://bytes.com/archives/php/389664-_post-problem-php5-iis)......

> 检查您的 IIS 配置并查看 PHP 允许使用哪些动词。我的猜测是 POST 不包括在内。您应该至少启用 GET 和 POST，或者只是让您的生活更轻松并允许所有动词。

如果您找到解决方案，请确保更新您的问题；我相信其他人会受益。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-29T19:24:38.683

好吧，我只是有同样的问题。

PHP.ini 文件很挑剔...确保没有“GB”，而应该是“G”。我的“post_max_size”为 1GB 而不是 1G，PHP 运行良好，除了 POST 请求。

# asp.net - Sql 事务：在 ASP.Net 中实现的最佳方式

> ID：313199
> 
> 赞同：4
> 
> 时间：2008-11-24T00:57:55.570
> 
> 标签：asp.net, database, transactions

我有一个应用程序，它有许多不同类型的对象，每个对象都将自己持久化回数据库。到目前为止，这在没有交易的情况下运行良好，我不想疯狂添加它们。但是偶尔需要在整个对象集合开始更新之前启动事务，以确保只有在集合中的所有对象都成功时才真正更新数据库。

例如，假设我有一组苹果。向集合发出命令以更新所有苹果。[事务开始应该在这里] 每个苹果执行代码来更新自己。[事务提交/回滚应该在这里发生]。

我遇到的问题是每个更新现在都是原子的（没有明确地包装在事务中）。我可以将一个 id 传递给每个“苹果”，以识别已隐藏在某种缓存中的事务，但是存在缓存在更新过程中失效并导致不必要问题的风险。

那么最好的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T02:12:43.530

首先，我不会处理页面中的事务逻辑。编写某种业务类来执行此操作 - 服务、数据实用程序类，您可以从 ASP.Net 中抽象出来的东西。

接下来，如果您使用可以订阅分布式事务的数据库（如 SQL Server） ，您可能会考虑使用*TransactionScope类（在 System.Transactions 命名空间中，参考 System.Transactions.dll）。*

```
using(TransactionScope scope = new TransactionScope())
{
  SaveObjectOne(); //these are just psuedo-code statements
  SaveObjectTwo(); //replace these with your code that saves various objs
  SaveObjectThree();
  scope.Complete(); //this commits the transaction, unless exception throws
} 
```

TransactionScope 实现 IDisposable，因此当*使用*调用*Dispose()时，如果**Complete()*从未调用过，事务将回滚。您确实需要启用分布式事务协调器才能使用*TransactionScope*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T10:19:52.720

OP 说该集合管理事务中所有其他对象的保存，因此将事务代码放在这里似乎很明显。如果您使用的是 ADO.Net，打开连接并在集合中开始事务，然后将其传递给其他每个对象，这似乎是最简单的选择。我假设这里的每个对象都继承自层超类型类，并且您使用的是 SQL Server。

```
public void Save()
{
    using (SqlConnection connection = new SqlConnection("Connection String"))
    {
        using (SqlTransaction trans = connection.BeginTransaction())
        {
            foreach (BusinessObject obj in this) 
            { 
                obj.Save(connection); 
            } 
            trans.Commit();
        }            
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-13T16:46:57.250

ado.net 2.0 中的事务非常简单，我建议使用 transactionscope 并让框架为您管理事务：

[在 MSDN 上](http://msdn.microsoft.com/en-us/library/ms973865.aspx)阅读所有相关信息：

> ## 交易流管理
> 
> 事务范围可以直接嵌套也可以间接嵌套。直接范围嵌套只是一个范围嵌套在另一个范围内，如示例 5 所示。
> 
> ### 示例 5\. 直接范围嵌套
> 
> ```
> using(TransactionScope scope1 = new TransactionScope())
> {
>    using(TransactionScope scope2 = new TransactionScope())
>    {
>       scope2.Complete();
>    }
>    scope1.Complete();
> } 
> ```
> 
> `TransactionScope`当在使用自己的范围的方法中调用使用 from 的方法时，会发生间接范围嵌套 ，如`RootMethod()`示例 6 中的情况。
> 
> ### 示例 6\. 间接范围嵌套
> 
> ```
> void RootMethod()
> {
>    using(TransactionScope scope = new TransactionScope())
>    {
>       /* Perform transactional work here */
>       SomeMethod();
>       scope.Complete();
>    }
> }
> 
> void SomeMethod()
> {
>    using(TransactionScope scope = new TransactionScope())
>    {
>       /* Perform transactional work here */
>       scope.Complete();
>    }
> } 
> ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T01:26:26.027

1.  我更喜欢声明性事务而不是尝试进行手动数据库事务。
2.  正如 Mitch Wheat 已经提到的，事务具有上下文并且是基于连接的，因此它将包括您在页面/方法中发生的更改，如果一切正常则提交，或者如果出现异常则回滚。
3.  **我在这里可能错了**，但我感觉“页面事务”正在使用 .NET 1.1 中的企业服务模型并通过 MSDTC（分布式事务协调器，注册的 COM+ 服务）工作......
4.  对于 .NET 2.0 中的声明性事务，我更喜欢 System.Transactions 和 LTM（轻量级事务管理器）
5.  我更喜欢 Spring.NET 框架事务（适用于 ADO.NET 和 NHibernate 版本），因为我相信它们支持更好的基于 AOP（面向方面​​编程）的关注点分离，您不必将代码与事务代码耦合，主要是因为这些人多年来一直在使用 Java 进行交易，我相信他们知道该怎么做。

# mysql - 缓存 SQL 查询数据的技术

> ID：313201
> 
> 赞同：2
> 
> 时间：2008-11-24T00:59:21.337
> 
> 标签：mysql, caching, b-tree

阅读了有关此主题的一些内容：

[缓存 MySQL 查询](https://stackoverflow.com/questions/37157/caching-mysql-queries)

[http://www.danga.com/memcached/](http://www.danga.com/memcached/)

我的 SQL 缓存问题： [http ://www.petefreitag.com/item/390.cfm](http://www.petefreitag.com/item/390.cfm)

[http://framework.zend.com/manual/en/zend.cache.html#zend.cache.introduction](http://framework.zend.com/manual/en/zend.cache.html#zend.cache.introduction)

我有一组非常独特（狭窄）的查询，我认为我可以在我当前的 FastCGI C API 可执行文件（不是 PHP）中很容易地实现一些缓存。

Zend 将他们的框架描述为：缓存记录通过一个灵活的 ID 和标签系统通过后端适配器（文件、Sqlite、Memcache...）进行存储。

这是如何实施的？

由于如果表已更改，相同的查询可能会返回不同的结果，因此我不仅需要监视查询，还需要监视 UPDATE、INSERT 和 DELETE（现在是 MySQL）因为这只发生在我的一个进程中，我可以轻松地添加一个表更改时删除缓存的语句。

客户端只允许 SELECT，在这种情况下，我可以对查询进行哈希处理并将它们与指向包含结果的文件的指针一起存储在哈希表或 btree 索引中。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T01:28:19.237

哦，伙计，这是个好问题。作为一名 .NET 开发人员，我很幸运在过去的 7 年中完全不必担心这一点。我不必担心，因为 .NET 实现了一个非常强大的缓存机制来做你想做的事情。

在中间层或表示层有没有办法做到这一点？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T11:29:50.847

.NET 对于快速开发当然很方便，但它会产生一些不良后果，因为 MS 会成为聋哑人！

我也更喜欢开发自己的解决方案，因为我可以根据自己的需要定制它们。我不需要太多复杂性，只需要一些机制来将入站查询与服务器端的结果集联系起来。演示文稿在存在单独数据库的客户端进行。请求实际上只是为了更新客户端数据库，因此在回答您的问题时，客户端缓存已经实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T22:07:54.023

当我想到这一点时，我意识到虽然缓存结果到磁盘更快，但磁盘上的负载会显着增加。在我的情况下，数据库的查询速度并没有那么慢，最大的问题是结果集所需的内存，每个结果集最多 3MB。这将立即耗尽服务器内存如果我在 xfer 进行时将其全部保存在内存中

# c# - Asp.Net/C# 静态变量持久化

> ID：313217
> 
> 赞同：1
> 
> 时间：2008-11-24T01:13:46.643
> 
> 标签：c#, asp.net, static

当我在我的 C# ASP.Net 应用程序中更新 .dll 时，会优雅地处理转换，并且允许用户在代码切换到新代码之前完成他们的请求。

我的问题是静态变量在完成后是否会重置，或者它们是否会在更新过程中持续存在（当然，如果静态对象本身没有在代码中更新）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T01:16:40.290

是的，它们丢失并重新创建，DLL 强制应用程序域停止并重新启动。所有缓存和其他项目都会根据使用/需要重新填充和创建。

如果这些值要保留任何实际时间量，您必须查看持久存储，因为您的 AppDomain 可以并且确实由于许多其他原因而重新启动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T01:21:08.097

是的，应用程序已重新启动。如果您需要保留这些值，您可能需要查看某种进程外缓存模型，例如进程外缓存、SQL Server 状态管理或位于应用程序之外的第三方缓存解决方案领域。

# mashup - 你建立的最酷的混搭是什么？

> ID：313235
> 
> 赞同：4
> 
> 时间：2008-11-24T01:29:22.557
> 
> 标签：mashup

你建立的最酷的混搭是什么？您使用了哪些 API？混搭比其部分的总和更好？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T01:34:17.010

虽然可能不是真正的混搭，但我创建了一个脚本，可以读取 Apple Movie Trailer RSS 提要，然后访问提要中的链接以下载链接到 RSS 提要中的页面的 HTML。从那里，它将下载容器 .mov 文件，并解析出您可以实际下载的电影的实际 URL。因此，虽然所有信息都来自 Apple，但脚本会从其网站的不同部分下载多个内容，以拼凑出最终的 RSS 提要，其中包含指向实际包含电影预告片的 .mov 文件的链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T02:13:11.953

今年早些时候，我在“春季混搭挑战”中获得了[第二名](http://career-resources.dice.com/tech_challenge/tech_chal_form.html)

谷歌地图 + Flickr

[http://www.desmoinesmashups.com](http://www.desmoinesmashups.com)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T14:05:33.023

我在 2009 年初的“ [RIAthon](http://adoberiathon.wordpress.com/) ”中获得了第二名

这是一个混搭，包括天气+谷歌地图+电话+搜索

它可以用来从某个地方搜索最近的医院，好处是你甚至可以通过它给医院打电话。

到目前为止，它对我来说是最酷的:)

# c# - 如何用 C# 等良好但多继承的截断语言解决“必须是 MarshalByRefObject”？

> ID：313243
> 
> 赞同：19
> 
> 时间：2008-11-24T01:38:08.170
> 
> 标签：c#, multiple-inheritance, marshalbyrefobject

如何用 C# 等良好但多继承的截断语言解决“必须是 MarshalByRefObject”？

问题很简单，在某些情况下你只需要从这个类继承（基础设施要求）。在这里真的无关紧要，哪种情况。那么，如果您已经从其他一些类（您的领域模型要求）继承，您会怎么做？

顺便说一句，好的应用程序框架，如 spring.net 始终确保您不必从此类继承，无论您需要将哪种基础设施应用于您的类。

**我想知道我在这里得到-3票是为了什么？:)**

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-24T02:11:09.837

一般来说，如果您要在 Remoting / WCF 上下文中使用它，您只想创建一个对象 MarshalByRef。这通常是一种足够特殊的情况，它并不痛苦。

假设你有一个通用类型，你想从它派生并专门化它，然后远程派生类型 - 现在你有一个问题，因为要远程一个对象必须从 MarshalByRefObject 继承，而你原来的通用类型没有. 假设你不能改变它，因为你正在做二进制继承，或者因为它本身派生自一个你不能改变的基类？正如提问者指出的那样，由于 C#（和一般的 .NET）不允许 MI，因此您不能从两者继承。

简短的回答是你有点搞砸了。您可以将通用类型更改为从 MarshalByRefObject 继承（或者在链上走得足够远，您可以将其插入有效的地方），或者您可以考虑使用代理对象。

例如，您可以创建一个描述您的类型接口的接口契约，然后构建一个从 MarshalByRefObject 继承的代理类型，该代理类型还通过组合和委托到您的类型的实例（即包装器）来实现该接口。然后，您可以远程该代理类型的实例，该实例将实例化您的类型并按预期完成工作 - 但方法的所有返回类型都必须是 [Serializable]。

```
public interface IMyType
{
    string SayHello();
    string BaseTypeMethodIWantToUse();
}

public class MyType : MyBaseType, IMyType
{
    public string SayHello()
    {
        return "Hello!";
    }
}

public class MyRemoteableType : MarshalByRefObject, IMyType
{
    private MyType _instance = new MyType();

    public string SayHello()
    {
        return _instance.SayHello();
    }

    public string BaseTypeMethodIWantToUse()
    {
        return _instance.BaseTypeMethodIWantToUse();
    }
} 
```

不过，看起来工作量很大。最终，如果您处于这种情况下，我建议您重新设计或重新思考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T02:10:46.593

这取决于您需要如何处理它。使用派生自 MarshalByRefObject 的基类可能会做到这一点。聚合可能会做到这一点。如果没有更具体的示例来说明您需要什么，很难说，但在极少数情况下，多重继承是解决问题的唯一方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T02:12:00.223

您不能从多个类继承。因此，您要么需要 (a) 更改继承层次结构，以便基础继承自它，要么 (b) 以不同的方式编写应用程序。

如果没有更多关于*为什么*需要继承`MarshalByRefObject`或为什么基类不需要（不能？）的信息，那么很难给出更具体的建议。

但是我会说，如果您有一个派生类型需要对其基进行不同的编组语义，那么您可能在某个地方遇到了架构问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T02:44:20.613

“那么，如果你已经从其他类（你的领域模型要求）继承了，你会怎么做？”

您可以为需要从 MarshalByRefObject 继承的域模型创建一个基类吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-02T15:12:01.297

我采用通用方法取得了成功。T 不必是“MarshalByRefObject”。当然，您必须将“RemoteProcess”替换为您用于远程处理的对象。然后，您可以作为 RemotingHost.RemoteObject 访问您的非 MarshalByRefObject。

```
public class RemotingHost<T> : MarshalByRefObject where T: class
{
    RemoteProcess host;
    T remoteObject;
    public T RemoteObject { get { return remoteObject; } }

    public RemotingAdmin()
    {
        host = new RemoteProcess();
        remoteObject = (T)host.CreateObject(typeof(T));
    }
} 
```

# asp.net - 根据登录状态显示不同的数据 - 客户端

> ID：313246
> 
> 赞同：0
> 
> 时间：2008-11-24T01:40:54.703
> 
> 标签：asp.net, jquery, ajax

我只是想知道最好的方法是什么，以及是否可以绕过它。这些是我的想法。

我有一堆链接，单击它们会在下面打开一个详细信息面板，该面板显示更多信息。这是通过ajaxy完成的。然而，事情是......如果用户没有登录，它应该将他们带到登录页面而不显示面板。

因此，如果我要从服务器发回用户的登录状态，然后显示面板或不显示面板......这是否足够安全？这可以以某种方式绕过吗？

有没有更好的方法来做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T01:47:51.037

我很容易被绕过。用户可以创建他们自己的 AJAX 调用（甚至不需要做 AJAX，他们可以创建一个普通的旧 HTTP 请求），设置登录标志，并获取他们不应该访问的数据。您最好只使用会话中的信息来确定用户是否已登录，而不是依赖于 AJAX 请求中发送的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T01:46:09.810

与其发回登录状态，为什么不只在用户登录时才发回登录用户的数据？因此，您执行所有逻辑来确定在服务器上显示什么。AJAX 调用接收数据并显示它无论如何。

如果您有 javascript idisplay 或不显示数据，则意味着您在任何情况下都将数据发送到客户端……这是不安全的。

# nintendo-ds - 为什么 libnds 中的 keysDownRepeat() 在多次调用时似乎不起作用？

> ID：313253
> 
> 赞同：1
> 
> 时间：2008-11-24T01:46:12.507
> 
> 标签：nintendo-ds, libnds

我有这样的代码可以在我的游戏中向左、向右、向上和向下移动玩家：

```
keysSetRepeat(20, 5);

while (lives) {
    scanKeys();

    if (keysDownRepeat() & (KEY_LEFT | KEY_RIGHT | KEY_UP | KEY_DOWN)) {
        u8 new_x = x;
        u8 new_y = y;

        if (keysDownRepeat() & KEY_LEFT) {
            new_x--;
        } else if (keysDownRepeat() & KEY_RIGHT) {
            new_x++;
        } else if (keysDownRepeat() & KEY_DOWN) {
            new_y++;
        } else if (keysDownRepeat() & KEY_UP) {
            new_y--;
        }

        // ...
    }

    // ...

    swiWaitForVBlank();
} 
```

为什么没有检测到密钥？如果我用它替换`keysDownRepeat()`它`keysDown()`（当然没有重复率）。[文档](http://libnds.devkitpro.org/a00020.html)在这里没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T01:46:23.053

我必须找到 libnds 源代码才能解决这个问题。看keysDownRepeat()的实现：

```
uint32 keysDownRepeat(void) {
    uint32 tmp = keysrepeat;

    keysrepeat = 0;

    return tmp;
} 
```

它实际上返回键，然后将它们重置回 0。这没有记录。我通过将结果存储`keysDownRepeat()`到变量中并使用变量来检查键来解决这个问题：

```
keysSetRepeat(20, 5);

while (lives) {
    scanKeys();
    u32 keys_down_repeat = keysDownRepeat();

    if (keys_down_repeat & (KEY_LEFT | KEY_RIGHT | KEY_UP | KEY_DOWN)) {
        u8 new_x = x;
        u8 new_y = y;

        if (keys_down_repeat & KEY_LEFT) {
            new_x--;
        } else if (keys_down_repeat & KEY_RIGHT) {
            new_x++;
        } else if (keys_down_repeat & KEY_DOWN) {
            new_y++;
        } else if (keys_down_repeat & KEY_UP) {
            new_y--;
        }

        // ...
    }

    // ...

    swiWaitForVBlank();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-08T16:12:40.563

Note also that you have keysHeld() to identify keys that are "still hold down" from the previous frame, while keysDown() is typically designed to help you identify "keys that have just beeing pressed this frame" (that is, between two calls of scanKeys()). keysDownRepeat() is obviously useful for people that wants keyboard-like behaviour for scrolling through lists with the DPAD: you'll repeatedly see the key "down again" every X frame. Admittedly, though, the semantic of keysDownRepeat() is poorly defined ...

# wpf - 将 VB.NET 2.0 Winform 迁移到 3.5 WPF

> ID：313256
> 
> 赞同：12
> 
> 时间：2008-11-24T01:46:56.593
> 
> 标签：wpf, vb.net, winforms, .net-3.5, .net-2.0

是否可以将 VB.NET Winform 解决方案迁移到 3.5 WPF 解决方案。如果是这样，有什么建议怎么做？

提前致谢！联合部队

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-24T02:01:50.540

微软正在为我们做所有事情，所以我们不得不扔掉我们两年前写的所有东西。根据乔什·史密斯的说法，

> 有没有办法将 Winforms 应用程序转换为 WPF 应用程序？

不，这两个 UI 平台非常不同，并且没有将 WinForms 应用程序转换为 WPF 应用程序的应用程序。当然，这不会阻止您重用您在 WinForms 中使用的任何 business/DAL/logging/Ioc/etc 库。

但是，您可能想查看[这个](http://rrelyea.spaces.live.com/blog/cns!167AD7A5AB58D5FE!1627.entry)非常基本但功能强大的 WinForms->XAML 转换器，由 WPF 和 Xaml 语言团队的 Rob Relyea 编写。

据他说，“我们（微软）还没有构建真正的转换器，因为我们认为大多数人不仅会移动控件，而且经常会在移动它时重新考虑他们的应用程序。我们希望得到反馈......”

此外，您可能还想查看Rob Relyea[的关于将应用程序从 Windows 窗体迁移到 WPF 的指南。](http://blogs.windowsclient.net/rob_relyea/archive/2008/04/03/guidance-for-migrating-an-app-from-windows-forms-to-wpf.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-24T02:10:04.910

直接的答案是一个很大的不。

如果您想充分发挥新平台的所有真正力量，您需要重建整个 Win 表单 UI 端和大部分相关代码，以实现有效的数据绑定和用户体验。您的 DataLayer 可以在 WPF 中完全重用。

您可以检查在同一问题上提出的大量问题

[将大型 C# winforms 应用程序升级到 WPF 的最简单方法是什么](https://stackoverflow.com/questions/111817/what-is-the-easiest-way-to-upgrade-a-large-c-winforms-app-to-wpf)

[克服从 Winforms 迁移到 WPF 的更大障碍是什么？](https://stackoverflow.com/questions/109620/what-are-the-bigger-hurdles-to-overcome-migrating-from-winforms-to-wpf)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T04:32:22.023

现在有一个项目可以完全满足您的要求。请参阅[Windows 窗体到 Windows Presentation Foundation 转换器](http://wf2wpf.codeplex.com/)。另外，请看[视频](http://video.msn.com/video.aspx?vid=2c995b74-cba6-4307-8bc8-82c9d959235a)。

# flash - 在完全使用 Flash 构建的网站上投放基于上下文的广告？

> ID：313260
> 
> 赞同：0
> 
> 时间：2008-11-24T01:54:37.653
> 
> 标签：flash, adsense, ads

能够在完全使用 Flash 构建的网站上投放基于上下文的广告的 adsense（或同等产品）的状态如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T02:29:46.583

查看[Mochiads](https://www.mochiads.com/)。Adsense ish 类型的服务，用于嵌入到 Flash 应用程序中。

（他们[支持 mochiweb](http://code.google.com/p/mochiweb/)，erlang 网络服务器，这很酷）

# asp.net-mvc - 我可以通过以下路线获得所有路线吗？

> ID：313268
> 
> 赞同：1
> 
> 时间：2008-11-24T02:06:01.860
> 
> 标签：asp.net-mvc, routes

我有 vs.net 在 MVC 应用程序中创建的默认值：

```
routes.MapRoute(
    "Default",                                              // Route name
    "{controller}/{action}/{id}",                           // URL with parameters
    new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
); 
```

我也想抓住这条路线（域名后面的任何文本，但它不能包含 / 即没有文件夹，只有根目录上的“文件”）。

```
www.example.com/blah 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T12:46:06.590

该路由也将匹配到`www.example.com/blah`url，它将使用`blah`带有操作的控制器`Index`。

如果你想创建一个特定的路由`blah`，你也可以这样做：

```
routes.MapRoute("BlahRoute",
    "blah/{action}/{id}",
    new { controller = "YourControllerForBlah", action = "Index", id = "" }
); 
```

只需确保在默认路由之前添加此路由，否则默认路由将首先匹配。

您可以查看[ASP.NET MVC Storefront part 7](http://www.asp.net/learn/mvc-videos/video-356.aspx)，了解一些关于路由的想法，以及来自 Phil Haack 的[ASP.NET Routing Debugger 。](http://haacked.com/archive/0001/01/01/url-routing-debugger.aspx)

# c# - 在 Biztalk 编排中创建新消息的最佳方式是什么？

> ID：313269
> 
> 赞同：6
> 
> 时间：2008-11-24T02:06:53.200
> 
> 标签：c#, biztalk

我正在寻找基于预定义 XSD 模式创建新消息实例的最佳解决方案，以便在 Biztalk 业务流程中使用。

额外的投票用于带有清晰有效示例的答案或带有质量参考链接的答案。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-24T02:23:08.393

当想要在 BizTalk 业务流程中创建消息的新实例时，有几个选项。

我已经描述了我通常最终使用的三个，并在答案的底部添加了一些链接。

如何定义哪个是最好的方法实际上取决于 - XMLDocument 方法在某些方面是最整洁的，除非您的架构发生更改，这可能会在您不知情的情况下中断。[Scott Colestock](http://www.traceofthought.net/CommentView.aspx?guid=c1164c59-72e2-49e2-be7a-47e4e8dc46d4)描述了一些减轻这种风险的方法。

BizTalk 映射方法可能是最容易理解的方法，并且在架构更改时不会中断。对于小型架构，这可能是一个不错的选择。

对于所有这些方法，要记住的重要一点是，如果您想使用可区分字段或提升的属性，您将需要创建空元素来填充。`XLANG`如果您尝试为缺少的元素赋值（即使这些元素可能是可选的），您将遇到运行时错误

## BizTalk 地图

最简单的选择是只使用 BizTalk 映射 - 您甚至不必将任何内容映射到创建的实例中。

要创建空元素，您只需映射一个带有空字符串参数的字符串连接functoid。

## 将一条消息分配给另一条消息

如果要创建消息的新实例，只需将一条消息复制到具有相同架构的另一条​​消息，采用消息分配形状。

## 使用 XMLDocument 变量

为此，您创建一个类型的编排变量，`XMLDocument`然后`message assignment`使用该`LoadXML`方法加载与您的架构匹配的 XML 片段。然后将 分配`XMLDocument`给所需的 BizTalk 消息。

```
varXMLDoc.LoadXml(@"<ns0:SomeXML><AnElementToPopulate></AnElementToPopulate></SomeXML>");  
msgYourMessage = varXMLDom; 
```

包含`AnElementToPopulate`允许您使用属性提升来分配给它。

我很少会突然想起执行此操作的语法，[这](http://blogs.objectsharp.com/post/2004/11/09/Constructing-BizTalk-2004-XML-Messages-(In-an-Orchestration)-Choices.aspx)是我的博客条目，用于提醒自己语法。

[此处的](http://www.sabratech.co.uk/blogs/yossidahan/2008/03/creating-message-from-scratch.html)另一个链接详细介绍了一些方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T02:12:04.297

你到底在找什么？它只是创建具有固定内容的新消息（如某种模板）吗？还是基于别的东西？您确实需要澄清问题并更具体地获得正确的答案。

如果您指的是仅基于某种硬编码内容（或接近）从头开始创建消息，那么我发现将它们作为嵌入式资源放入辅助 C# 程序集中是一种非常干净的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T02:15:23.573

要创建新消息，您可以简单地创建一个`System.Xml.XmlDocument`新消息并将其分配给消息变量。您可以使用它`Load`或`LoadXml`方法来加载符合架构的所需内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T05:34:05.200

本教程可能会有所帮助：

BizTalk Server 2006 教程 - 过程演练 使用 BizTalk Server 2006 R2 和 Windows Communication Foundation 创建具有合同优先设计的服务

[http://dotnet.sys-con.com/node/647092](http://dotnet.sys-con.com/node/647092)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T13:41:44.680

查看我的博客文章 -[在 BizTalk 中创建消息的乐趣](http://www.sabratech.co.uk/blogs/yossidahan/2008/10/fun-with-message-creation-in-biztalk.html)- 了解各种选项之间的基本性能比较。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-25T05:40:43.763

```
xsd.exe /classes /namespace:MyNamespace myschemafile.xsd 
```

您可以使用它为给定的模式文件生成 c# 类。结果是一个 .cs 文件，您可以将其包含在您的一个解决方案项目中。

在“消息分配形状”中使用时，您可以实例化这些生成的类之一，为其所有属性填写值，然后最终将消息部分分配给您的实例。Biztalk 将为您自动神奇地序列化实例。尼斯和OO。不需要任何花哨的 xlang 东西。

对于其他一些解决方案，例如使用硬编码的 XML 加载临时 XmlDocument，或者全力以赴并使用其他人建议的 documentSpecification.GetDocSchema().CreateXmlInstance()，我真的没有太多运气。

# eclipse - 如何让 Eclipse 提示我输入命令行参数

> ID：313270
> 
> 赞同：82
> 
> 时间：2008-11-24T02:08:08.827
> 
> 标签：eclipse

我知道我可以在运行配置中配置命令行参数，但我想使用不同的命令行参数多次运行 java 文件。每次都更改运行配置很痛苦。

有没有一种方法可以让 Eclipse 在我每次运行程序时提示我输入命令行参数？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2008-11-24T02:29:48.550

在配置中添加`string_prompt`为 a 。`Program Argument``Run`

```
 ${string_prompt} 
```

如果您想要专门的文件\文件夹，还有一个`file_prompt`和一个。`folder_prompt`

这些可通过“运行配置”对话框选项卡上的`Variables`按钮获得。`(x)= Arguments`

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2011-07-11T15:31:23.430

这是一个老问题，但因为我真的没有在其他任何地方看到这个额外的信息

您也可以键入`${string_prompt:My Prompt Text:Default Value}`

这将弹出一个窗口询问“*请为我的提示文本输入一个值*”，然后使用默认值“*默认值*”。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-10-12T20:19:20.050

此外，您可以使用 ${string_prompt:My Prompt Text} 将字符串添加到提示中，这将显示带有“请为我的提示文本输入值”的对话框。

# asp.net - 如何将 JsonResult 对象作为字符串获取以便我可以修改它？

> ID：313281
> 
> 赞同：8
> 
> 时间：2008-11-24T02:17:11.820
> 
> 标签：asp.net, asp.net-mvc, json, serialization

我正在使用 FlexiGrid jQuery 插件，我需要从我的 MVC 应用程序中获取一个 JSON 对象，如果 FlexiGrid 只获取该对象，这很简单，但我需要在响应字符串中添加一些项目，以便它与 FlexiGrid 一起正常工作.

所以这是我的控制器代码的一部分：

```
If Request.QueryString("json") IsNot Nothing Then
    Dim data As New StringBuilder()
    data.Append("page: " & pageIndex & "," & vbCrLf)
    data.Append("total: " & ViewData.TotalCount & "," & vbCrLf)
    data.Append("rows: ")
    data.Append(Json(objCustomerList))

    Return Content(data.ToString())
End If 
```

不幸的是，在上面的代码中`Json(objCustomerList)`返回 'System.Web.MVV.JsonResult' 而不是所需的 JSON 字符串数据。我也试着`Json(objCustomerList).ToString()`看看会发生什么，同样的事情再次发生。

有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-24T02:23:34.413

`Json()`ASP.NET MVC 中的方法只是通过[`JavaScriptSerializer`](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)类使用`JsonResult`类。如果您想使用 JSON 将 objCustomerList 对象序列化为字符串，您可以自己使用它。

我的建议是采取稍微不同的方法。

*   创建一个表示您尝试创建的 JavaScript 对象的 .NET 等效项的模型。可能是具有 Page、Total、Rows 和 CustomerList 属性的 FlexiGridModel 对象。
*   然后，当您将 FlexiGridModel 传递给`Json()`它时，它就可以工作，无需使用`StringBuilder`.

如果您只是希望您的代码能够正常工作，那么有一个[覆盖`JavaScriptSerializer.Serialize()`](http://msdn.microsoft.com/en-us/library/bb340417.aspx)可以将对象序列化`StringBuilder`并将结果附加到。这应该正是您正在寻找的。

一些相关链接：

*   [JavaScriptSerializer 示例](http://atsung.wordpress.com/2008/08/07/javascriptserializer-example/)
*   [ASP.NET MVC JsonResult 源](http://www.codeplex.com/aspnet/SourceControl/changeset/view/17272)
*   [代码项目：ASP.NET MVC Flexigrid 示例](http://www.codeproject.com/KB/aspnet/MVCFlexigrid.aspx)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-03-11T12:23:33.287

你也可以这样做：

```
JsonResult json = ... ;
JavaScriptSerializer serializer = new JavaScriptSerializer();
string yourJsonResult = serializer.Serialize(json.Data); 
```

就这么简单：D

编辑：代码高亮

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-25T19:32:08.020

我最终修改了 Codeproject 示例：

```
Imports System.Web.Script.Serialization
Imports System.Reflection

Public Class FlexiGrid

    Public Class FlexigridRow
        Public id As String
        Public cell As New List(Of String)()
    End Class

    Public Class FlexigridObject
        Public page As Integer
        Public total As Integer
        Public rows As New List(Of FlexigridRow)()
    End Class

    Public Shared Function GetFlexiGridJSON(ByVal page As Integer, ByVal total As Integer, ByVal o As Object) As String

        Dim js As New JavaScriptSerializer
        Dim flexiGrid As New FlexigridObject
        Dim i As Integer = 0
        flexiGrid.page = page
        flexiGrid.total = total

        For Each c In o
            Dim r As New FlexigridRow()
            r.id = i
            r.cell = GetPropertyList(c)
            flexiGrid.rows.Add(r)
            i += i
        Next

        Return js.Serialize(flexiGrid)
    End Function

    Private Shared Function GetPropertyList(ByVal obj As Object) As List(Of String)

        Dim propertyList As New List(Of String)()

        Dim type As Type = obj.[GetType]()
        Dim properties As PropertyInfo() = type.GetProperties(BindingFlags.Instance Or BindingFlags.[Public])
        For Each [property] As PropertyInfo In properties
            Dim o As Object = [property].GetValue(obj, Nothing)
            propertyList.Add(If(o Is Nothing, "", o.ToString()))
        Next

        Return propertyList

    End Function

End Class 
```

现在在我的控制器中，我只是调用：

```
Return Content(GetFlexiGridJSON(pageIndex, TotalCount, objCustomerList)) 
```

只要我传递的对象是对象列表，它就可以完美地工作。

# language-agnostic - 什么是“SDK 与'在线比特'”之争？

> ID：313282
> 
> 赞同：7
> 
> 时间：2008-11-24T02:19:13.407
> 
> 标签：language-agnostic

关于“想要一个 SDK 和想要了解底层协议之间的区别”似乎存在一些争论（参见[http://www.tbray.org/ongoing/When/199x/1999/08/18/BitsOnTheWire](http://www.tbray.org/ongoing/When/199x/1999/08/18/BitsOnTheWire)）。

我真的不明白这是指什么，或者为什么它们是相互排斥的。

每种方法的理念是什么，为什么它们会发生冲突？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-24T02:26:39.087

假设客户端 C 需要与厂商 V 提供的服务 S 通信。如果你只有一个 SDK，那么你*必须*在客户端 C 上安装厂商 V 的 SDK 软件才能与 S 通信。另一方面，如果厂商 V 文件究竟*如何*与服务 S 对话到位级别，然后您可以在客户端 C 上编写自己的软件直接与服务 S 对话。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-24T02:40:18.903

它们并不是真正相互排斥的。它更像是一个连续体，但系统背后的开发理念往往倾向于某一端或另一端。

本质上，网络上的位表示通信协议足够简单，可以通过一些相对简单（甚至非正式）的规范向外部开发人员描述。这意味着服务可以以各种不可预见的方式使用，服务消费者不必是官方支持的平台。

另一方面，像 Apple 和 Microsoft 这样提供单一产品的公司可以选择另一种理念，即构建完整的端到端 SDK。从理论上讲，这通过抽象底层协议的复杂性使开发人员的生活更轻松，同时释放产品来做更复杂的事情，并减少开发人员的错误。当然还有一些比特，它们仍然通过网络，它们可以被逆向工程。然而，这将比使用设计为易于理解的协议困难得多（数量级），特别是如果它被故意混淆或加密以服务于商业利益。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T02:37:49.597

虽然在某些情况下了解位级别发生的事情（尤其是对于故障排除）很有帮助，但使用供应商的 SDK 可能是将您的集成与供应商可能对其消息结构进行的任何未来更改隔离开来的最佳方式。

这并不是说在获取最新的 SDK 等方面不会带来不便，但至少如果供应商的工作做得对，您不必担心更改代码，只需使用他们的新开发工具包。

例如，我们曾与一家名为 ISD 的公司合作，该公司专门从事支付交换机产品。我们编码到他们的 SDK。虽然他们的产品经过了一些版本控制，但我们要做的最多的是更新客户端机器上的 DLL。DLL 保留了相同的公共接口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T02:30:48.893

它们不必相互排斥，只是任何提供服务的人都将专注于 SDK 或有线协议作为他们面向客户的公共承诺接口。您可以拥有同时提供两者的服务，并让您的客户选择关注哪一项，但这可能是一种奢侈。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T03:48:35.350

[如果您采用 SDK 路线，那么不要像这个故事](http://thedailywtf.com/Articles/Unix-With-QuikBill!.aspx)中那样提供电线规格上的位，这一点非常重要。

# math - 在 3D 空间中的点之间进行插值以形成光滑表面的简单方法

> ID：313297
> 
> 赞同：12
> 
> 时间：2008-11-24T02:37:24.197
> 
> 标签：math, 3d, geometry

我试图想出一种简单而有效的方法来创建一个与许多给定“样本”点相交的光滑表面。

对于表面上的任何 X、Y 点，我在 4 个方向中的每个方向（X 轴上的下一个较高点和较低点，然后是 Y 轴）中识别出最多 4 个采样点。鉴于这一点，我想要一种方法来计算在 4 个样本点之间插值的 Z 值。

当然，在给定 4 个样本点中任何一个的 X、Y 位置的情况下，该算法应该输出该点的 Z 值。另请注意，样本点可能少于 4 个。

我猜想 4 个样本点的 Z 值的一些函数，以某种方式与样本点的距离成反比，但我不知道如何做到这一点。

任何人都知道一个简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-05T18:34:54.230

您可以通过从 Catmull-Rom 样条构造补丁来做到这一点。这些样条线将撞击每个控制点，并且它们在一阶导数中是连续的（尽管不是二阶导数）。我还发现它们非常容易使用。数学很简单，它们的行为很直观，控制点略有变化。

在最高级别，每个补丁需要 16 个点（在数据集的边缘，您可以在同一样条曲线中使用角点和边缘点两次）。

首先，您需要在 4x4 矩阵的每一行中的点*p[i][j]*上进行插值，以创建一组四个中间控制点*q[i]*。这是我的意思的粗略 ASCII 草图。

```
p00 p01 q0 p02 p03
p10 p11 q1 p12 p13
p20 p21 q2 p22 p23
p30 p31 q3 p32 p33 
```

现在，您可以在这四个中间控制点中的每一个之间进行插值，以找到曲面上的最终样条点。

[这是](http://www.cs.cmu.edu/~462/projects/assn2/assn2/catmullRom.pdf)跨四个点的 Catmull-Rom 样条构造。在此示例中，您使用*p[i-2]*和*p[i+1]*两侧的控制点在点*p[i-1]*和*p[i]*之间进行插值。 *u*是从零到一的插值因子。 *τ*定义为样条上的张力，将影响样条曲面与控制点的紧密程度。

 ***```
 | 0   1   0    0 | | p[i−2] |
                 |−τ   0   τ    0 | | p[i−1] |
p(u) = 1 u u2 u3 | 2τ τ−3 3−2τ −τ | | p[i]   |
                 |−τ  2−τ τ−2   τ | | p[i+1] | 
```

注意：如何在 Stackoverflow 的 gui 中进行布局并不是很明显，但*u2*和*u3*应该分别代表*u squared*和*u cubed*。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T02:56:02.257

您可以利用双线性/双三次插值，但在三个方向（分别为三线性/三次三次）。如果您了解这些插值形式的工作原理，那就很简单了。有关更多信息，请参阅[Wikipedia 上的 Tricubic Interpolation 。](http://en.wikipedia.org/wiki/Tricubic_interpolation)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T01:32:25.203

您是在寻找表面插值还是网格就足够了？

对于表面插值，我看到其他人建议使用三角测量（例如使用这个： [http](http://en.wikipedia.org/wiki/Delaunay_triangulation) ://en.wikipedia.org/wiki/Delaunay_triangulation ）

创建网格：我的一位同事使用热方程 ( [http://en.wikipedia.org/wiki/Heat_equation](http://en.wikipedia.org/wiki/Heat_equation) ) 来计算给定样本点之外的像素值。这产生了极其逼真的地形表面，并且并行化是微不足道的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T02:46:25.553

使用 catmull-rom 补丁

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T01:26:50.363

如果您想要对该点进行简单的线性插值，则中心点的 Z 值只是 4 个相邻 Z 值的平均值，因为距离在 Y 和 X 上都是对称的。

如果距离不对称，但中心点始终位于同一 X 和 Y 线上，则可以计算 Y 和 X 插值，最终值是它们的平均值。

所以 Zc 将是：Zc=(Zx1+x*(Zx2-Zx1)/(x2-x1)+Zy1+y*(Zy2-Zy1)/(y2-y1))/2，其中 x 和 y 是距离x1 和 y1。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T15:21:55.537

使用问题中建议的方案（其中最近邻居的一些子集是从分散的集合中选择的）进行插值时的一个问题是结果不必是连续的。

想想看。假设我要沿着通过 (x,y) 平面的一些平滑、连续的路径移动。只要 4 个最近的邻居不改变，插值将是平滑的，无论您选择如何定义。但是，在某些时候，最近邻居的子集会突然改变。此时，您必须使插值在边界上保持一致。最好是使用自变量集的三角剖分。这确保了数据凸包内的连续（线性）插值。通过更多的工作，也可以通过三角测量来实现更高阶的插值。

如果您碰巧从事地质统计学，径向基函数也通常用于插值或克里金法。由于您正在研究基于距离的方法，因此请考虑径向基函数。例如，搜索“inverse multiquadric interpolation”。

# plsql - 是否有任何函数可以在 PL/SQL 中添加空间

> ID：313306
> 
> 赞同：7
> 
> 时间：2008-11-24T02:48:48.200
> 
> 标签：plsql

在 T-SQL 中，SPACE() 函数用于在字符串中添加空格。例如

```
@s = 'He' + space(5) + 'llo' 
```

输出

```
He     llo 
```

那么PL/SQL中有没有等价于SPACE()的函数呢？

谢谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-24T03:48:01.980

您可以使用 RPAD 或 LPAD 功能

```
select 'He'  || rpad(' ',5,' ') || 'llo'
from dual;
/ 
```

或者在 PL/SQL 中是：

```
declare
  x varchar2(20);
begin
  x:= 'He'  || rpad(' ',5,' ') || 'llo';
end;
/ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T10:12:41.930

杰弗里使用`rpad(' ',n,' ')`给`n+1`空间

```
select RPAD('A',3,'-')||RPAD(' ',4,' ')||RPAD('B',5,'-') from dual 
```

输出

```
A--    B---- 
```

之后`A--`和之前`B`，你会发现 5 个空格而不是 4 个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-17T18:42:30.620

在 Oracle 中，您可以`space()`使用以下命令模拟该函数：

```
rpad(' ',n,' ') 
```

哪里`n`比你想要的空格字符串的总长度少一。

例如对于 40 个空格的字符串：

```
select rpad(' ',39,' ') as "40 spaces" from dual 
```

`dual`是一个虚拟表，您可以使用它来测试计算和字符串操作，而无需从现实生活中的表中提取。

# asp.net-mvc - 捕获默认页面的路线是什么？

> ID：313312
> 
> 赞同：0
> 
> 时间：2008-11-24T02:59:38.380
> 
> 标签：asp.net-mvc, routes

我不想使用 vs.net 创建的默认路由：

```
routes.MapRoute(
    "Default",                                             // Route name
    "{controller}/{action}/{id}",                          // URL with parameters
    new { controller = "Home", action = "Index", id = "" } // Parameter defaults
); 
```

**我只想要获得 www.example.com/ 页面的路由，它是什么？** （注意：我不希望 www.example.com/default 只是简单的 www.example.com 映射到 HomeController Action=Index）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T03:02:48.577

我昨天刚开始玩 MVC（测试版），我的 web 配置中有这个（对于 IIS 6.0，删除 IIS 7.0 的 .aspx）

```
public static void RegisterRoutes(RouteCollection routes)
        {
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
            routes.MapRoute("Default", "{controller}.aspx/{action}/{id}", new { controller = "Home", action = "Index", id = "" });
            routes.MapRoute("Empty", "", new { controller = "Home", action = "Index", id = "" });
        } 
```

# continuous-integration - 在巡航控制、团队城市等中管理多个版本

> ID：313313
> 
> 赞同：2
> 
> 时间：2008-11-24T02:59:45.183
> 
> 标签：continuous-integration, build-management

在我的商店中（正如我所期望的那样），您拥有不同软件组件的多个版本（我们称它们为 foo-client 和 bar-service）。在我的 cc.net 配置中，我目前在主干上有一个 foo-client 的“项目”，一个 foo-client 版本 1.0 的项目和另一个 foo-client 版本 1.1 的项目。

我真正希望在仪表板级别看到的是：

*   > 富客户端

*   > 酒吧服务器

能够深入了解 foo-client 或 bar-server。汇总将显示上次连续构建的状态，我可以查看和/或强制为现有标记版本进行新构建。

你们在做什么，在什么构建管理框架下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T05:51:41.763

您可能想看看 Hudson（它通过插件支持 MSbuild）——它可以部署到 Java 应用程序服务器（推荐：Glassfish 或 Tomcat）。

下载、解压缩和部署大约需要 5-15 分钟 - 然后您就可以开始定义项目构建了。

有相当多的插件来扩展基本功能——而且开发团队似乎会在 3-4 天的发布时间表上发布新功能/错误修复——因此代码活力非常高。

[http://hudson-ci.org/](http://hudson-ci.org/)

在 Glassfish 仪表板中 - 您可以通过特定于您可能想要定义的项目根名称的选项卡来组织您的项目 - 然后您可以轻松实现您想要的组织结构。

# vb.net - 如何在对象命令的 CommandText 中加入 DML 语句

> ID：313321
> 
> 赞同：0
> 
> 时间：2008-11-24T03:06:13.267
> 
> 标签：vb.net, oracle, ora-00911

为了从 SQL Server 数据库中获取数据，我可以使用如下代码

```
Dim sql As String = "SELECT emp_id, emp_name FROM emp; SELECT dep_id, dep_name FROM department;"
Dim da As New SqlClient.SqlDataAdapter(sql, connString)
Dim ds As New DataSet("Data")

da.Fill(ds) 
```

我将在**ds**数据集中得到两个表。如何为 Oracle 数据库编写相同的代码？我尝试按上述方式编写代码，但收到错误消息。**ORA-00911: 无效字符**

此外，我还想使用 DELETE 语句。例如

```
Dim sql As String = "DELETE FROM emp WHERE emp_id = 1; DELETE FROM department WHERE dep_id = 4"
Dim cmd As New SqlCommand(sql, conn)
cmd.ExecuteNonQuery() 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T04:25:33.417

为了通过 Command 对象执行多个 DML 语句，这些语句必须放在块**BEGIN ... END**中。例如

```
Dim sql As String = "BEGIN DELETE FROM emp WHERE emp_id = 1; DELETE FROM department WHERE dep_id = 4; End;"
... 
```

# c# - 在静态类中声明字典

> ID：313324
> 
> 赞同：99
> 
> 时间：2008-11-24T03:07:59.783
> 
> 标签：c#, .net, dictionary

如何在静态类中声明静态字典对象？我试过

```
public static class ErrorCode
{
    public const IDictionary<string, string> ErrorCodeDic = new Dictionary<string, string>()
    {
        { "1", "User name or password problem" }     
    };
} 
```

但编译器抱怨“*只能用 null 初始化非字符串引用类型的 const 字段*”。

* * *

## 回答 #1

> 赞同：241
> 
> 时间：2008-11-24T03:30:42.470

如果您想声明字典一次并且从不更改它，则将其声明为只读：

```
private static readonly Dictionary<string, string> ErrorCodes
    = new Dictionary<string, string>
{
    { "1", "Error One" },
    { "2", "Error Two" }
}; 
```

如果您希望将字典项设为只读（不仅是引用，还有集合中的项），那么您将必须创建一个实现 IDictionary 的只读字典类。

查看 ReadOnlyCollection 以供参考。

BTW const 只能在内联声明标量值时使用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-24T03:23:42.950

正确的语法（在 VS 2008 SP1 中测试过）是这样的：

```
public static class ErrorCode
{
    public static IDictionary<string, string> ErrorCodeDic;
     static ErrorCode()
    {
        ErrorCodeDic = new Dictionary<string, string>()
            { {"1", "User name or password problem"} };
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-03-29T15:08:17.720

老问题，但我发现这很有用。事实证明，还有一个专门的 Dictionary 类，它使用字符串作为键和值：

```
private static readonly StringDictionary SegmentSyntaxErrorCodes = new StringDictionary
{
    { "1", "Unrecognized segment ID" },
    { "2", "Unexpected segment" }
}; 
```

**编辑：**根据克里斯在下面的评论，通常首选使用`Dictionary<string, string>`over `StringDictionary`，但这取决于您的情况。如果您正在处理较旧的代码库，则可能仅限于`StringDictionary`. 另外，请注意以下行：

```
myDict["foo"] 
```

`myDict`如果是 a将返回 null `StringDictionary`，但如果是 将抛出异常`Dictionary<string, string>`。有关更多信息，请参阅[他提到的 SO 帖子](https://stackoverflow.com/questions/627716/stringdictionary-vs-dictionarystring-string)，这是此编辑的来源。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-18T08:29:51.270

> 创建静态构造函数以在 Dictionary 中添加值

```
enum Commands
{
    StudentDetail
}
public static class Quires
{
    public static Dictionary<Commands, String> quire
        = new Dictionary<Commands, String>();
    static Quires()
    {
        quire.add(Commands.StudentDetail,@"SELECT * FROM student_b");
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T03:38:42.640

您最初示例的问题主要是由于使用`const`而不是`static`; 您不能在 C# 中创建非空 const 引用。

我相信这也会奏效：

```
public static class ErrorCode
{
    public static IDictionary<string, string> ErrorCodeDic
        = new Dictionary<string, string>()
            { {"1", "User name or password problem"} };
} 
```

此外，正如 Y Low 所指出的，添加`readonly`也是一个好主意，这里讨论的修饰符都不会阻止字典本身被修改。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T03:13:39.883

您可以使用静态/类构造函数来初始化您的字典：

```
public static class ErrorCode
{
    public const IDictionary<string, string> ErrorCodeDic;
    public static ErrorCode()
    {
        ErrorCodeDic = new Dictionary<string, string>()
            { {"1", "User name or password problem"} };
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T03:21:40.553

使 Dictionary 成为静态的，并且永远不要在静态对象的 ctor 之外添加它。这似乎是一个比摆弄 C# 中的静态/常量规则更简单的解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-05-25T17:17:53.257

好的 - 所以我在 ASP 2.x 中工作（不是我的选择......但是，嘿，谁在婊子？）。

没有一个初始化字典示例将起作用。然后我遇到了这个： http: [//kozmic.pl/archive/2008/03/13/framework-tips-viii-initializing-dictionaries-and-collections.aspx](http://kozmic.pl/archive/2008/03/13/framework-tips-viii-initializing-dictionaries-and-collections.aspx)

...这让我意识到不能在 ASP 2.x 中使用集合初始化。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-10-02T18:31:38.540

使用公共静态属性字典并将静态私有字典包装在里面。然后你只需要关心可变或不可变类型，第一个你需要在包装器中迭代。这允许您阅读字典，但不能编辑它（不是条目，也不是整个参考），并可以选择允许使用您喜欢的任何身份验证模型在 set{} 部分内进行编辑。

（我一直在寻找不同的东西，比如并行编码中的静态性能，看到了这个搜索结果，发现缺少包装器方法。）

对于那些不知道包装是什么的人，这里有一个非静态示例（您可以轻松添加静态关键字）：

```
public Dictionary<string, Boolean> Access
{
    get
    {
        // Same here, iterate if needed..
        return new Dictionary<string, Boolean>(prv_Access);
    }
    set
    {
        MainWindow.NewSession.Renew();
        if (MainWindow.NewSession.Actual)
        {
            prv_HistoryAccess.Add(DateTime.Now, new Dictionary<string, Boolean>(prv_Access));

            // Here you would need to iterate when you deal with mutables..
            prv_Access = value;
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2008-11-24T03:11:50.137

```
public static class ErrorCode
{
    public const IDictionary<string , string > m_ErrorCodeDic;

    public static ErrorCode()
    {
      m_ErrorCodeDic = new Dictionary<string, string>()
             { {"1","User name or password problem"} };             
    }
} 
```

可能在构造函数中初始化。

# asp.net-mvc - 任何只有数字的东西的 MVC 约束

> ID：313326
> 
> 赞同：0
> 
> 时间：2008-11-24T03:10:58.810
> 
> 标签：asp.net-mvc, routes

我需要一个约束方面的帮助：

```
Constraints = new RouteValueDictionary(new { filename = @"" }) 
```

它只能是数字（没有字母、斜线等）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T10:34:15.407

我不确定我是否理解这个问题，但据我所知，您可以简单地在 Constraints 字典中提供正则表达式。

我认为在[MSDN refguide](http://msdn.microsoft.com/en-us/library/system.web.routing.route.constraints.aspx)中甚至有一个例子：

```
reportRoute.Constraints = new RouteValueDictionary { 
  { "locale", "[a-z]{2}-[a-z]{2}" }, 
  { "year", @"\d{4}" } }; 
```

基于此，我认为你必须写什么：

```
Constraints = new RouteValueDictionary(new { filename = @"\d+" }) 
```

# .net - 从 XML 中获取节点值

> ID：313332
> 
> 赞同：0
> 
> 时间：2008-11-24T03:16:25.837
> 
> 标签：.net, xml, xpath

如何使用[XPathNavigator.Evaluate](http://www1.cs.columbia.edu/~lok/csharp/refdocs/System.Xml.XPath/types/XPathNavigator.html#Evaluate(System.String))（或 XPathNavigator 中的其他方法）获取以下 xml 输入的 ISBN 值？

```
<?xml version="1.0"?>
<!-- a fragment of a book store inventory database -->
<bookstore xmlns:bk="urn:samples">
  <book genre="novel" publicationdate="1997" bk:ISBN="1-861001-57-8">
    <title>Pride And Prejudice</title>
    <author>
      <first-name>Jane</first-name>
      <last-name>Austen</last-name>
    </author>
    <price>24.95</price>
  </book>
  <book genre="novel" publicationdate="1992" bk:ISBN="1-861002-30-1">
    <title>The Handmaid's Tale</title>
    <author>
      <first-name>Margaret</first-name>
      <last-name>Atwood</last-name>
    </author>
    <price>29.95</price>
  </book>
  <book genre="novel" publicationdate="1991" bk:ISBN="1-861001-57-6">
    <title>Emma</title>
    <author>
      <first-name>Jane</first-name>
      <last-name>Austen</last-name>
    </author>
    <price>19.95</price>
  </book>
  <book genre="novel" publicationdate="1982" bk:ISBN="1-861001-45-3">
    <title>Sense and Sensibility</title>
    <author>
      <first-name>Jane</first-name>
      <last-name>Austen</last-name>
    </author>
    <price>19.95</price>
  </book>
</bookstore> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T03:29:49.863

```
XPathIterator xit = XPathNavigator1.Select("/bookstore/book/@bk:ISBN");
xit.MoveNext();
String value = xit.Current.Value; 
```

你想要的价值在`xit.Current.Value`

顺便说一句，我建议您查看[这篇](http://www.aspnetpro.com/newsletterarticle/2004/04/asp200404bn_l/asp200404bn_l.asp)关于 xPath 的精彩文章。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T04:42:35.960

amdfan 给出的答案几乎是正确的。这是正确的语法：

```
XPathIterator xit = XPathNavigator1.Select("/bookstore/book/@bk:ISBN");
xit.MoveNext();
String value = xit.Current.Value; 
```

我在 VS 2008 中对此进行了测试。

# reporting-services - Reporting Services - 矩阵中的百分比

> ID：313334
> 
> 赞同：1
> 
> 时间：2008-11-24T03:19:07.407
> 
> 标签：reporting-services

报告服务 2000 SP2

我有一个显示员工人数的矩阵

```
 Business1      Business2      Business3
StartBefore99    9              14             4
StartAfter99     30             20             34 
```

我想显示百分比，例如

```
 Business1      Business2      Business3
StartBefore99    9 (23%)        14 (41%)       4 (10%)
StartAfter99     30 (77%)       20  (59%)      34 (90%) 
```

有什么建议么？我可以在 SQL 中执行此操作，但更愿意在 RS 中执行表达式。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T03:32:56.240

你可以做的是使用一个表达式，例如

= SUM(Fields!StartBefore99.Value) + FORMAT(Sum(Fields!StartBeforeValue99) / Fields!Total.value,2)

Total 是您在数据集中计算的字段。我接触 RS 已经有一段时间了，但这基本上是我之前写的代码。我相信你需要做一个 SUM，因为它是一个矩阵。如果这只是一个表格，它会更简单一些，因为你不需要进行求和。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T04:19:28.157

非常感谢乔希

这是我最终使用的

```
=Sum(Fields!StartBefore99.Value) & " (" & Format( ((Sum(Fields!StartBefore99.Value)/Fields!TotalNumberOfPeopleInPlant.value)*100), "0")  & "%)" 
```

我在 SQL 中做了一个 TotalNumberOfPeopleInPlant 并返回了每一行的值.. 将来某个时候我会考虑在 RS 中做这件事！

# linux - Linux 内核 /proc FIFO/管道

> ID：313342
> 
> 赞同：2
> 
> 时间：2008-11-24T03:23:34.870
> 
> 标签：linux, kernel, pipe, fifo, procfs

我目前正在尝试创建一个内核模块，该模块将根据内核事件生成数据并将它们推送到文件中。在读到这很糟糕（我同意）之后，我决定将数据放在 /proc 文件中，用户程序可以在必要时从中提取数据会更有意义。然而，这个想法导致了各种各样的问题，特别是何时以及如何清除这个文件。所以我想......“为什么我不在 /proc 中创建一个命名管道并从中读取呢？”

我已经掌握了为 proc 文件设置读取函数和写入函数的一般要点，但我仍然在如何处理这个问题上遇到概念上的问题。也就是说，我将如何编写这样一个函数来获取任意数据并将其从内核写入这样的管道？有谁知道如何将数据从内核空间推送到命名管道？最后，它不一定*是*/proc 文件（特别是如果我这样做是错误的），但这是我得出的结论。然后我必须弄清楚如何从用户空间程序附加到它，但我觉得这是一个单独的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T03:33:31.637

您要做的不是创建命名管道，而是创建一个“字符设备”。如果您想要从内核到用户空间并返回的简单交互或流式传输数据，这是通常的方法。我建议在 Linux 内核中查找类似的设备并查看它们的功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T21:32:46.170

我认为通常这样做的方式是使用 netlink 套接字；一个或多个用户空间进程可以绑定到“netlink”地址，并且您的内核设施可以根据需要将消息广播到任何/所有这些进程。

这当然是某些事情所做的，尤其是网络子系统。用户空间程序可以使用这种方法观察网络接口的变化（例如新的 IP 地址、链接状态变化）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T04:22:46.810

我同意 Paul 的观点——实现字符设备可能是最好的方法。也许查看实现 /dev/kmem 或 /dev/rtc[0-9] 的代码。此外，串行驱动程序使用字符设备实现其驱动程序。

只需将其视为虚拟设备即可。:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T04:32:20.457

/proc[实际上不是真正的文件系统](http://en.wikipedia.org/wiki/Procfs)；它是由内核根据当前运行的内容构建的。我认为您不能在其中创建命名管道。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-04T03:01:45.217

有一些很好的建议。内核支持多种方式：

*   Ana betts 和 Michael Trausch 建议的字符/块设备
*   mmap 设备（例如，您可以作为 /proc/memshare/mybuffer 访问）
*   自定义系统。编写内核模块意味着您可以真正创建自己的方法来访问 proc 对象。这个内核中有很多样本。

希望这可以帮助。

# asp.net - VS 2008 的 Crystal Reports -“找不到用户函数管理器 DLL (ufmanager.dll)。”

> ID：313344
> 
> 赞同：0
> 
> 时间：2008-11-24T03:24:00.923
> 
> 标签：asp.net, visual-studio-2008, crystal-reports, windows-server-2003, 64-bit

StackOverflow，你是我唯一的希望！

我很不幸在开发中继承了大约 3/4 的 ASP.NET 3.5 应用程序。本项目使用 Crystal Reports Basic for VS 2008 从数据源生成 PDF 文件。很简单。

无论如何，这个项目在我的开发机器（VS 2008）上编译并运行良好，但是当我将它发布到服务器（安装了 CR Basic for VS 2008 Runtime）时，我在尝试导出报告时收到此错误消息转为 PDF：

```
Error in File C:\WINDOWS\TEMP\Report {D3596595-5217-4888-A770-72427B29DE27}.rpt:
The user function manager DLL (ufmanager.dll) could not be found.
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.Runtime.InteropServices.COMException: Error in File C:\WINDOWS\TEMP\Report {D3596595-5217-4888-A770-72427B29DE27}.rpt:
The user function manager DLL (ufmanager.dll) could not be found. 
```

不幸的是，在谷歌上搜索错误消息只会出现少数结果，而且它们没有帮助。

我的服务器运行的是 Windows 2003 x64 SP2。我尝试在服务器上安装 Crystal Reports 运行时（x86 和 x64 版本）。奇怪的是，该应用程序没有检测到 x64 版本，所以我使用的是 x86 版本。

我在**C:\Program Files (x86)\Business Objects\Common\2.8\bin**中看到文件**ufmanager.dll**，但我不知道我的应用程序在哪里寻找它。我什至尝试将它粘贴在我的应用程序的“bin”文件夹中，但没有运气。

 **如果任何善良的灵魂碰巧以前看到过这个错误并且知道修复，我将*非常*感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-02T05:16:10.113

您是否尝试过为 VS 2008 的 Crystal Reports Basic 安装运行时？[在http://blog.aggregatedintelligence.com/2008/12/crystal-reports-basic-2008-runtime.html](http://blog.aggregatedintelligence.com/2008/12/crystal-reports-basic-2008-runtime.html)查看我关于运行时位置的帖子

请记住，如果您将 CR B 用于 VS 2008 运行时，则必须将 dll 版本从 10.2.x 更新到 10.5.x（需要在 web.config 以及使用 CR 查看器的 aspx 文件中完成） .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T01:38:44.067

我刚刚在这个错误上花了两天时间，并准备把我的头发拉出来。底线是授予 IIS_WPG 用户对水晶 bin 文件夹的完全控制权限做到了。这与在 Windows 2003 服务器上设置水晶时著名的 unknown.rpt 错误非常相似。

重要的是要注意 Crystal 支持人员（我与绝对最好的两个人交谈过）从未见过此错误，并且仅在网络上记录过一次或两次。我们都假设这是由于我使用了 Godaddy 虚拟专用服务器设置，并且虚拟软件导致了这种情况。要阅读有关这些混乱的所有信息，请访问 [https://forums.sdn.sap.com/thread.jspa?forumID=313&threadID=1261161](https://forums.sdn.sap.com/thread.jspa?forumID=313&threadID=1261161)。

这是一个基于社区的论坛，因此您可能需要注册，但它是免费的。

埃德

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T00:36:12.737

我的“解决方案”（如果你可以这么称呼的话）是**不** 使用**Crystal Reports Basic for VS 2008**。我转而使用**.NET Framework 2.0 的 Crystal Reports**，它与 VS 2005 捆绑在一起。然后我在服务器上安装了这个运行时，它运行良好。

![.NET Framework 2.0 参考的 CR 图像](https://content.screencast.com/users/Pandincus/folders/Jing/media/8fa9f026-25a5-48ad-bb0b-fc7407eee6f2/2008-12-06_1931.png)

注意版本号**10.2.3600.0**而不是**10.5.3700.0**。

我不知道为什么我在使用较新版本时遇到此错误，但至少现在我可以重新开始工作了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-02T20:09:05.737

我在 Windows 7 64 位计算机和 Crystal XI R2 上安装了 Crystal 10，尝试在 Crystal 10 中打开报告时出现错误。

我将文件从：C:\Program Files (x86)\Business Objects\Common\3.5\bin 复制到：C:\Program Files (x86)\Crystal Decisions\Crystal Reports 10

问题解决了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-10T22:11:08.260

安装 .net framework 4.5 后我遇到了同样的问题

我在 Windows 7 64 位计算机 R2 上安装了 Crystal 10，尝试在 Crystal 10 中打开报表时出现错误。

我将文件从：C:\Program Files (x86)\Common Files\Crystal Decisions\2.5\bin 复制到：C:\Program Files (x86)\Crystal Decisions\Crystal Reports 10

谢天谢地问题解决了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-25T10:17:48.137

安装 .net framework 4.5 后我遇到了同样的问题

我在 Windows 7 64 位计算机 R2 上安装了 Crystal 10，尝试在 Crystal 10 中打开报表时出现错误。

我将文件从：C:\Program Files (x86)\Common Files\Crystal Decisions\2.5\bin 复制到：C:\Program Files (x86)\Crystal Decisions\Crystal Reports 10 **strong text**

# logging - 何时记录错误是致命的？

> ID：313351
> 
> 赞同：36
> 
> 时间：2008-11-24T03:30:23.297
> 
> 标签：logging, error-handling, log4net, log4j

在 log4j 和 log4net 等日志框架中，您可以记录各种级别的信息。大多数级别都有明显的意图（例如“调试”日志与“错误”的对比）。然而，我一直胆怯的一件事是将我的日志记录归类为“致命”。

什么类型的错误如此严重以至于它们应该被归类为致命错误？虽然这稍微取决于大小写，但在决定将异常记录为致命还是仅仅错误时，您使用的一些经验法则是什么？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-11-24T03:36:18.293

我认为致命错误是指您的应用程序无法完成任何更有用的工作。非致命错误是指出现问题但您的应用程序仍然可以继续运行，即使功能或性能水平降低。

致命错误的示例包括：

*   记录设备上的磁盘空间不足，您需要继续记录。
*   客户端应用程序中的网络连接完全丢失。
*   如果无法使用默认值，则缺少配置信息。

非致命错误包括：

*   单个会话由于某种原因失败但您仍然可以为其他客户端提供服务的服务器。
*   如果可以建立新会话，则会出现间歇性错误，例如会话丢失。
*   如果可以使用默认值，则缺少配置信息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-24T03:34:58.310

如果缺少某些内容或发生应用程序无法继续的情况，则错误是致命的。可能的示例是缺少必需的 config.file 或当异常“冒泡”并被未处理的异常处理程序捕获时

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T03:39:34.917

如果我的下一步是终止应用程序，或者只是不再做任何后续工作，我会使用 fatal。如果应用程序是批处理的一部分或有多个进程正在运行，这对于跟踪发生的事情很有用。

如果有恢复的机会（例如，网络连接丢失并重试一段时间）我不会使用致命的。

如果我有多个由主线程激活的服务线程，其中一个由于输入错误而失败，但应用程序仍然可以服务新请求，我认为这不是致命的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T03:41:41.883

为了使这个答案简短而甜蜜，如果您的应用程序崩溃，我会认为这是致命的。如果您无法连接到数据库或所需服务等重要资源，那将是致命的。总的来说，我会说如果它使您的应用程序无法正常运行并影响用户，我会将其归类为致命错误。

但是对错误进行分类最重要的方法是始终遵循经验法则，例如[C++ 编码标准](http://www.gotw.ca/publications/c++cs.htm)中的规则 69 ：

> “在设计早期制定实用、一致和合理的错误处理策略，然后坚持下去。”

# php - 烦人的 vim (un) 缩进规则

> ID：313359
> 
> 赞同：12
> 
> 时间：2008-11-24T03:39:31.047
> 
> 标签：php, vim, indentation

在编辑 PHP 代码（我不确定它是否特定于该语言）并且我在跨越多行的逗号分隔列表中间创建一个新行时，缩进规则总是取消我要离开的行的缩进。[这是它的视频。](http://toogeneric.com/files/indent2.mov)这发生在数组、函数参数列表等中。

我能做些什么来阻止这种情况的发生，或者有什么比向上移动、重新缩进、向下移动、重新缩进（因为当你离开线路时它被清除）并继续更快速的方法来修复错误？

[.vimrc](https://gist.github.com/2806bf9f0fb1424fd375)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T03:42:55.033

试试看`:set indentexpr=""`是否有帮助。请参阅`:help filetype-indent-off`处理文件类型插件的部分（这可能是这个 indentexpr 的来源）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-26T03:31:41.357

您的缩进由 PHP 缩进脚本（.vimrc 中的“filetype indent on”）控制。我将这些选项用于我的 PHP 缩进，您输入`~/.vim/after/ftplugin`：

```
setlocal autoindent
setlocal cindent
setlocal cinwords=if,else,elseif,do,while,foreach,for,case,default,function,class,interface,abstract,private,public,protected,final
setlocal cinkeys=0{,0},0),!^F,o,O,e

setlocal nosmartindent " don't use smart indent option 
```

[在vim wiki page for source indenting](http://vim.wikia.com/wiki/Indenting_source_code)上有更多关于这个主题的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-04T05:31:04.750

我认为把`cindent`一切都搞砸了，`smartindent`通常是你想要的。

尝试将其放入`~/.vim/filetype.vim`：

```
au BufNewFile,BufRead *.html,*.css setlocal nocindent smartindent 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T18:57:02.910

尝试这个：

```
:let g:PHP_default_indenting=1 
```

见`:h php-indent`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T04:04:18.033

在正常模式下使用“o”似乎可以避免这个问题。从插入模式命中`<esc>o`不是最佳的，但它比硬方式更好（如上所述）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-21T22:53:47.707

你也可以做

```
set cindkeys=-0# 
```

对于 # 字符。如果您遇到与我在使用 css 声明时遇到的问题相同的问题，例如

```
width: 100% 
```

也向左移动，您可以添加

```
set cindkeys-=: 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-20T02:23:35.463

找到你的 php.vim 缩进文件。例如 /usr/share/vim/vim73/indent/php.vim

然后寻找这些行：

```
elseif lastline =~ '^\s*?>.*<?\%(php\)\=\s*$'
    let lnum = lnum - 1 
```

并通过添加引号将它们注释掉，如下所示：

```
"elseif lastline =~ '^\s*?>.*<?\%(php\)\=\s*$'
"    let lnum = lnum - 1 
```

这样就解决了！打开 PHP 标签时不再缩进`<?`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-24T22:50:31.900

你可能想看看缩进键

例如，这些天的默认设置是：

indentkeys=0{,0},:,0#,!^F,o,O,e,*,<>>,,end,:

# php - 初级 PHP 程序员应该考虑框架吗？

> ID：313364
> 
> 赞同：4
> 
> 时间：2008-11-24T03:43:22.707
> 
> 标签：php, frameworks

在编程方面，我是一个完整的初学者。我正在尝试使用 PHP，并且已经看到了这些框架的强大功能。但是我是否应该考虑尝试使用一个框架，直到我对 PHP 本身有了很好的掌握？

注意：我很可能会使用 CodeIgnitor，但这个问题适用于任何框架。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-24T03:46:43.233

最好，在开始使用框架之前，您应该对语言（以及一般的编程）有很强的掌握。框架可以并且将为您节省大量工作，但它们也为您引入了高级概念和实现。

在您获得一些经验并开始想知道解决您之前遇到的一些常见问题的最佳方法是什么之后 - 这将是尝试框架的好时机。

我建议您尝试阅读不同框架的一些源代码，看看它是否对您有意义。如果没有 - 你可能还没有准备好。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-24T04:09:03.093

就我个人而言，我会坚持学习 PHP 并在没有框架帮助的情况下创建一些项目。虽然框架可以将项目中许多杂乱、无聊的部分抽象出来，但仍然重要的是要知道它们是如何工作的，尤其是在调试时。

框架也可能非常复杂，即使对编程语言有很好的理解，学习如何有效地使用框架也可能很困难。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T04:32:34.527

PHP 本身是一门大型语言，您可能应该先了解 PHP 自己可以做什么，然后再研究将您从语言中抽象出来的框架。但是你最终可能会像我一样，害怕使用除语言标准库之外的任何真正的扩展。您是否使用过其他语言的框架？如果你还没有，现在使用一个框架可能有利于将来使用其他语言的其他框架

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T05:00:35.297

我会说是的，因为它使做更复杂的事情变得更快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T04:29:54.877

框架可以将语言的大部分复杂性从你身上抽象出来，但在某些时候，你会遇到一些需要你了解语言的控制结构和标准库的东西。

这完全取决于你，但我建议在使用框架之前至少学习一些语言的基本结构，尤其是处理控制结构。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-24T05:00:28.090

你应该先学习编程。从基础开始：条件、循环、运算符优先级，然后转向面向对象的技术、设计模式。也许在您对这一切感到满意之后（可能需要一段时间），您可能会考虑使用框架。在此过程中，您可能可以研究如何在框架中使用上面提到的东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-24T06:09:56.233

我强烈建议您先学习该语言的基础知识。对于知道如何最好地利用它们的人来说，框架使事情变得更容易。想象一下，如果我有一个建造房屋的框架。如果您是初学者木匠，您仍然会犯很多错误，遇到很多“嘿……你是怎么做到的”的时刻，使用错误的工具，不遵循某些假定的约定等。学习基础知识。

如果你想要一个框架会因为不知道你的东西而让你大吃一惊的例子，请查看 Zend Framework 中的 Zend_Form。您可以构建一个简单的表单没有问题，但在现实生活中，您将需要自定义表单的许多方面。你必须自己扩展它才能得到你真正想要的。用自定义按钮替换标准按钮，更改默认错误消息，自定义用于显示表单各个部分的 html 和 css。使表单尽可能可重用...抽象出它的某些方面以使其具有更广泛的用途。在一些验证和授权中工作......如果你还没有一些编程能力，你很快就会发现自己在你的头上。

# opengl - 通过 PyOpenGL 拼接 2D 图像

> ID：313365
> 
> 赞同：0
> 
> 时间：2008-11-24T03:44:15.327
> 
> 标签：opengl, visualization, pyopengl

我正在尝试拼凑一个基本上包括以下内容的场景：

1.  地球的 2D 图像（想想 NASA 卫星摄影），已旋转成与[此类](http://flickr.com/photos/walterra/2631170956/in/photostream/)似的视图，并且，
2.  我想要放置在特定纬度/经度坐标的圆柱管。

我已经设法按照上面的链接设置了 2d 图像，但我正在努力创建圆柱体。我希望达到的效果应该与[此](http://www.julapy.com/processing/rays.mp4)类似。无论如何，我意识到这个描述并不是很多，我想那是因为我知道的太少了，我不知道该问什么。

有什么提示吗？我应该查找的 GL 函数的名称将特别有用。我正在使用 PyOpenGL 以防万一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T03:55:29.110

本教程解释了如何使用二次曲线来节省在 GL 中绘制对象的时间，有一个靠近底部的圆柱体示例。这个站点也是一个很好的 OpenGL 学习资源。虽然它使用 C，但您可以查看使用的函数并根据需要实现它们。

[http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=18](http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=18)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T04:02:01.377

GLUT 是一个库，它提供常用行为的 opengl 调用集合，包括创建基本形状，例如圆柱体。

一旦您设法使用 GLUT 创建了一个圆柱体，您就可以使用矩阵变换将圆柱体定位到您想要的位置。

如果您还没有检查过这些，它们可能很有用：

[http://pyopengl.sourceforge.net/documentation/](http://pyopengl.sourceforge.net/documentation/)

[http://www.opengl.org/documentation/red_book/](http://www.opengl.org/documentation/red_book/)

[http://www.opengl.org/resources/libraries/glut/](http://www.opengl.org/resources/libraries/glut/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T04:40:08.647

您在原始帖子中提供的视频具有许多您可能会或可能不会尝试效仿的效果。

GLU/GLUT 创建的对象是在您当前模型视图空间的原点创建的，因此您需要将它们翻译/旋转/缩放到您想要的位置。

查看 glColor，在绘制圆柱体之前设置渲染颜色。

对于透明效果，需要做一些额外的工作。

查找“混合”、glEnable (GL_BLEND)、glBlendFunc，以了解透明度的基础知识。

这个 HeNe 教程可能有用：[http ://nehe.gamedev.net/data/lessons/lesson.asp?lesson=08](http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=08)

可能会导致渲染透明图像出现问题的一件事是，您绘制图像的顺序变得很重要，因为 z-buffer 剪辑和混合的工作方式。您可能会发现您需要绘制距离您的观看位置越来越远的圆柱体。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T04:23:17.900

感谢您的回答。

我已经阅读了 nehe 教程，它们非常好。事实上，它们在 PyOpenGL 中包含的演示中被翻译成 python。我想我的问题更多是在我绘制它之后设置圆柱体的属性，我应该更具体，对不起。我可能遗漏了一些简单的东西，但经过几个小时的尝试，我却空空如也。我确实使用了 GLUT 库并尝试绘制一个 glutSolidSphere 作为测试。在我的场景中，我似乎无法让它像我在原始帖子中链接到的光线那样着色。

我想一个更好的问题是我应该寻找什么 GL 命令来产生可以在光线动画中看到的效果（OP 中的链接）。

# php - 如何在 PHP 中初始化对象，然后在自动运行的类中创建什么函数？

> ID：313374
> 
> 赞同：4
> 
> 时间：2008-11-24T03:51:28.637
> 
> 标签：php, oop, object

嗨，我忘记了您必须添加的示例类中的代码以便它自动运行？

是唤醒还是什么？

像这样：

```
class something {
 function automaticxxx_something_which_runs when class is created()
 {
 }
}

$s = new something(); 
```

- 我在类文件中创建什么，以便在类初始化后已经运行某些东西？

我忘记了如何命名函数名称，以便它会自动将其称为第一个函数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T04:54:10.553

如果您想要一个在两个版本中都可以使用的构造函数（尽管，您不应该为 php4 编码，因为它现在已经过时了）

```
class Foobar
{
    function __construct()
    {
        echo "Hello World!\n";
    }
    function Foobar() 
    {
        return $this->__construct();  
    }
} 
```

如果你正在为**Just** php5 编码，你应该养成明确指定可见性的习惯，

```
class Foobar 
{
    public function __construct() 
    { 
    }
} 
```

（可见性定义器在 php4 中不存在）

应该可以解决问题，在 php4 下会有轻微的性能损失。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T04:13:28.233

你在寻找一个构造函数。在 PHP4 中，方法与类同名

```
class Foobar
{
    function Foobar()
    {
        echo "Hello World!\n";
    }
}

new Foobar() 
```

在 PHP5 中上述方法仍然有效，但正确的方法是使用 __construct() 方法

```
class Foobar
{
    function __construct()
    {
        echo "Hello World!\n";
    }
}

new Foobar(); 
```

# .net - WCF 中的 Web 引用

> ID：313376
> 
> 赞同：0
> 
> 时间：2008-11-24T03:55:01.873
> 
> 标签：.net

在 WCF 中，如果我们在客户端项目中使用 webreference，则会为服务中编写的每个参数自动添加名为“IsSpecified of bool”的附加参数。为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T04:39:43.610

对于在序列化期间可以忽略的任何类型，此属性都会添加到代理类中。这是`XMLSerializer`对忽略该类型而不对其进行序列化的通知。

为其生成此属性的类型是值类型 - 包括`bool`、`int`和`DateTime`。

我对此的理解是值类型不能为空，因此您需要某种方式告诉序列化程序您不想发送任何内容。

对于像`string`您这样的引用类型，可以简单地将其设置为 null，然后序列化程序会很高兴地处理其余部分。对于值类型，您需要帮助序列化程序，否则它只需要发送类型的默认值。

我相信其他人可以详细说明这种行为的技术原因，但我认为我所说的从广义上讲是正确的。

[这篇](http://www.distribucon.com/blog/IgnoringSpecifiedElementsDuringXMLSerialization.aspx)文章稍微讨论了这个问题。

# ssl - 什么是 SSL，它与 HTTPS 有什么关系？

> ID：313381
> 
> 赞同：20
> 
> 时间：2008-11-24T04:02:40.983
> 
> 标签：ssl, https

什么是 SSL，它与 HTTPS 有什么关系？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-24T04:11:30.250

SSL 是安全套接字层，一种用于加密网络流量的加密协议。SSL 的最新版本是版本 3，它修复了 SSLv2 中的一些已知问题。HTTPS 是基于 SSL 的 HTTP……或基于 TLS 的 HTTP。

[TLS](http://en.wikipedia.org/wiki/Transport_Layer_Security)（传输层安全）是 SSLv3 的继承者，并且在很大程度上取代 SSLv3 作为 Web 浏览器和服务器中的默认 HTTPS 协议。

附带说明一下，HTTPS 通常侦听端口 443，而不是端口 80。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-24T04:06:04.410

HTTPS 只是基于 SSL 的 HTTP。或安全套接字层上的超文本传输​​协议。

SSL 是用于通信的加密通道。HTTP 是通过网络传输网页和其他 Web 内容的方式。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-24T06:59:04.967

**HTTPS：**（RFC 2818）用于提供安全通信。它是 TCP/IP 堆栈上的应用层协议（类似于 HTTP）。

**SSL：**它是 TCP/IP 堆栈中应用层和传输层之间的一层。它提到了遵循 PKCS（公钥加密标准）的客户端-服务器身份验证（通过握手和基于证书的身份验证完成）；建立后通过安全通道进行消息通信（某些商定的加密标准用于在发送和接收端强制执行适当的加密/解密）。总之，除非建立经过身份验证的加密通道，否则不会发送应用程序数据。

**黑白 SSL 和 HTTPS 的关系：** HTTPS 是基于 SSL 协议的安全 HTTP 通信（如他们所说，HTTP over SSL）。通常，所有敏感信息（如密码、财务详细信息等）都通过这种传输方式发送。常见示例：您的 gmail 登录是通过 HTTPS 通道完成的。

**杂项：** 几乎所有标准浏览器都支持 https。你可以看到他们默认拥有的证书。SSLV2、SSLV3 和 TLS 是受支持的标准（据我回忆）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-24T04:41:21.623

**HTTPS = 基于 SSL 的 HTTP**

SSL 是 TCP 上的一个层，允许安全、加密的数据交换。

HTTP 通常通过 TCP 运行，因此未加密。HTTPS 是 HTTP 协议通过 SSL 而不是直接通过 TCP 运行的地方，因此交换的数据是加密的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-07-15T19:53:44.877

> 将 SSL 证书视为通过网络传输数据的安全加密通道。
> 
> SSL（安全套接字层）在 Web 服务器和 Web 浏览器之间创建编码连接，保护网站记录的敏感个人数据，例如：信用卡信息、登录信息（用户名和密码）、联系信息。通过这种方式，它可以在网络上安全地传输数据，并确保不会窃取、更改或伪造数据。
> 
> SSL 证书有两个特定的功能：
> 
> 1.  **身份验证和验证**：SSL 证书包含有关请求其颁发的个人或公司的 ID 准确性的信息。访问者可以通过单击特征信任标记（例如 Norton™ Secured Seal）上的浏览器挂锁符号来验证网站的身份。证书颁发机构对是否应颁发 SSL 证书进行的检查非常严格，并且根据证书的类型而有所不同。
>     
>     
> 2.  **数据加密**：加密是 SSL 证书背后的过程，允许通过网络安全传输数据（数字、文本或文件）。在交换这些数据的过程中，信息以这样一种方式被加密，第三方在没有加密“密钥”的情况下无法访问或读取数据。

阅读更多：**[SSL 证书终极指南（2017 年更新）](http://ssladvice.com/the-ultimate-guide-to-ssl-certificates/)**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T04:06:47.840

SSL 是一种用于在应用程序级别进行安全隧道或加密网络连接的协议。

HTTPS 只是通过 SSL 使用的 HTTP。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T04:08:01.520

SSL 和 HTTPS 用于加密、安全的网络通信。网上有很多资源可以解释这些协议。这是一个资源的链接：[http ://www.ourshop.com/resources/ssl.html](http://www.ourshop.com/resources/ssl.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-03-20T15:37:38.300

SSL 安全性（安全套接层）是一种用于保护数据的技术，在两个系统（即服务器和客户端）之间或两个不同的服务器之间传输。它使用加密算法对传输中的数据进行加扰，防止黑客在通过连接发送数据时对其进行读取。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-04-17T06:13:23.343

让我把它归结为简单的术语：

*   这是一个简单的文件，位于服务器上

*   SSL 证书由高级权威机构（例如 Amazon 、goDaddy）提供

到网站以使其更安全，并向用户和浏览器保证我们受到保护。

为什么网站需要这些证书？

*   因为用户和大多数浏览器更喜欢安全网站（通过 SSL 认证的网站）而不是其他网站？
*   出于数据保护目的
*   如今，数据安全是重中之重

> 正如其他人提到的 abv：HTTP + SSL = HTTPS

# sql - 需要 ANSI 92 递归 SQL 语句

> ID：313383
> 
> 赞同：2
> 
> 时间：2008-11-24T04:03:51.170
> 
> 标签：sql, recursion, hierarchical-data, ansi-sql, ansi-sql-92

我目前正在将 SQL Server SQL 语句翻译成它们的 ANSI 通用等效语句，并且我坚持使用 WITH 语句的递归语句。

为了集中讨论这个问题，我将问题简化如下

如果我有两张桌子

1.  **报告单位**

    *   col1：键
    *   col2: ParentReportingUnitKey
2.  **设施**

    *   col1：键
    *   col2: ParentReportingUnitKey

此结构描述了向下至设施的报告单位的层次结构，其中报告单位可能有 0 .. 1 个直接父报告单位和 0 .. n 个子报告单位。

设施是链接到报告单位的“叶”记录。

我需要制作一个 ANSI 92 有效的 SQL 语句（或者最坏的情况下可以在 Oracle、DB2 和 SQL Server 上工作的语句），它将返回与层次结构中任何位置的给定报告单元相关的所有设施。

**例如**

*   ReportingUnit R1 具有 ReportingUnit 子 R1.1 和 R1.2
*   ReportingUnit R1.1 有子 R1.1.1、R1.1.2
*   ReportingUnit R1.2 有子 R1.2.1、R1.2.2

*   设施 F1 有一个父报告单元 R1.1.1

*   设施 F2 有一个父报告单元 R1.1.2
*   设施 F3 有一个父报告单元 R1.2.1
*   设施 F4 有一个父报告单元 R1.2.2

请记住，ReportingUnit 表中可能有 0 .. n 级递归，如果给定参数 ReportingUnit=R1，我如何从 SQL 语句中返回所有 4 个工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T04:15:35.467

我可以肯定的是，SQL-92 中没有递归语句。支持的最早版本是 SQL-99。

因此，您无法使用 SQL-92。为什么你认为 SQL-92 是可取的？它是作为 SQL 功能的基本级别，还是有其他原因？

当前版本的 DB2 具有 WITH 子句并且可以实现递归查询。我相信 Oracle 也有 WITH 子句；我不确定它是否可以使用它们实现递归查询。Oracle 还具有完全非标准和非关系的 CONNECT BY PRIOR。我不确定 MS SQL Server 支持什么。

您很有可能无法找到您指定的所有三个 DBMS 都支持的单一语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T06:52:11.733

递归查询没有 SQL-92 解决方案。

最好的选择是使用其中一种编码层次关系的解决方案，以便您可以使用标准 SQL 查询所有后代或祖先。

请参阅此处的简短描述：“[将平面表解析为树的最有效/优雅的方法是什么？](https://stackoverflow.com/questions/192220/what-is-the-most-efficientelegant-way-to-parse-a-flat-table-into-a-tree#192462) ”。

或者阅读Joe Celko[的“Smarties 中的树和层次结构”。](https://rads.stackoverflow.com/amzn/click/com/1558609202)

# azure - 适用于 Windows Azure 的好的定价模型是什么？

> ID：313397
> 
> 赞同：3
> 
> 时间：2008-11-24T04:13:58.340
> 
> 标签：azure, cloud

Windows Azure 看起来像是一个很有前途的云平台。目前最大的未知数是定价模型。微软表示他们仍在努力，但它会很有竞争力。你认为怎样才能成为一个好的定价模型？

让我们希望微软能注意到一群程序员想要什么。

更新：Azure 定价： http: [//www.microsoft.com/azure/pricing.mspx](http://www.microsoft.com/azure/pricing.mspx)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T06:49:35.403

Azure 可以采用以下两种方式之一：

1.  简单的即用即付模式，就像亚马逊一样，具有更高使用率的分层定价（更多使用=更低的单位价格）。这是我想看到的模型。它适用于亚马逊，业界明白，任何阅读定价的人都将很快能够估计它的成本是否会高于或低于他们的预算，等等。

2.  复杂的服务水平协议和黑匣子安排。他们可以使这变得困难。他们可以这样做，如果您是美国特殊计划 XYZ 的合作伙伴，那么您有这个价格表，但如果您是安大略省的 Super-Duper 合作伙伴，那么您有另一个价格，如果您在一家财富 500 强的公司在毛伊岛设有分公司，然后你会得到另一个价格，没有人能自己弄清楚价格是多少。这将是一个很大的错误，并且会使 Azure 几乎所有的小型企业家、业余爱好者和中小型企业客户付出代价。即使他们有面向业余爱好者和学生的 Azure Express，与选项 1 相比，它仍然会失败。

希望他们做一些简单的事情——否则我担心亚马逊会轻松击败他们，和/或谷歌会提供一些免费的东西，也许还有广告支持，他们将很难与之竞争。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T07:18:29.433

我希望他们能做一些简单的事情。亚马逊的定价很简单，尽管我经常在提到 CPU 周期时感到困惑。了解微软后，他们很可能会想出具有多层服务水平和定价的复杂产品。

我是一名 .net 开发人员，但出于某种原因，我对 Azure 并不十分兴奋。它似乎不是很简单易用。我喜欢 Google Apps，因为它很简单，我喜欢 Amazon，因为它非常开放（您不需要在 Amazon 上使用某种技术）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-08T06:53:09.600

Azure 服务平台的定价模型，尤其是 VM 需要考虑处理器的空闲时间。只要他们这样做，我就会很高兴。我只是不想为我根本不使用的处理付费，而当我使用它时，我可以支付它的费用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-15T05:41:07.187

我一直在想同样的事情。谷歌有“成本领先”战略——他们可以提供相当好的服务，从零成本开始，如果你变得受欢迎，他们就会增加。亚马逊通过提供更多管道选项来实现差异化，但您必须为每台虚拟机付费。即使您每个月只有 10 个用户，它也会花费您，但您可以对您的机器进行更多调整。

我怀疑微软会更直接地与亚马逊竞争，但会收取服务而不是虚拟机的费用。他们不像 Google 那样愿意免费赠送东西——他们必须保护许多 IIS 和 SQL Server 安装，如果 Web 安装更便宜，这些安装就会消失。他们还必须解决其他人提供比他们更好的 SQL Server 体验的问题——他们必须是托管您的 MS 相关技术的“场所”。

因此，期望为每个服务实例（网络、存储、同步等）付费 + 一些使用费。服务实例可能需要 20 美元，而不是亚马逊每台服务器的 80 美元（或其他任何价格）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-24T04:17:31.720

[从本质上讲，亚马逊在他们的服务（ CloudFront](http://aws.amazon.com/cloudfront/) 、SimpleDB，可能还有 S3 和 EC2）上打下了烙印，我相信即使 Azure 为 .net 开发人员提供了更多，这是微软可以考虑的定价。

但本质上，我认为必须对流量和数据库请求进行定价，没有或只有非常低的月费和设置成本。

编辑：看看他们如何将自己与传统的网络托管公司抗衡也可能很有趣。毕竟，在**非常**简化的层面上，Azure 是分布式 IIS 托管。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-09T17:03:46.093

Windows Azure 定价自其商业发布以来经历了多次修订。当前定价在[这里](https://www.windowsazure.com/en-us/pricing/calculator/)，包括一个价格计算器，可帮助您查看给定服务的每月费用。

本次讨论中的一条评论是关于空闲时间成本。Windows Azure 服务成本基于核心小时数，而不是 CPU 利用率（类似于酒店租金：您按天支付房间费用，无论您是否占用它）。在开发过程中，通过在测试后删除部署，可以轻松地将成本保持在最低水平（如果使用 MSDN 帐户则免费）。除非运行长期测试，否则在开发过程中没有必要让部署保持 24x7 运行。只是不要删除服务命名空间本身。

# objective-c - NSInvocation 傻瓜？

> ID：313400
> 
> 赞同：140
> 
> 时间：2008-11-24T04:17:49.237
> 
> 标签：objective-c, cocoa, undo-redo

具体是如何`NSInvocation`工作的？有好的介绍吗？

我在理解以下代码（来自*Cocoa Programming for Mac OS X, 3rd Edition*）如何工作时特别有问题，但随后也能够独立于教程示例应用这些概念。编码：

```
- (void)insertObject:(Person *)p inEmployeesAtIndex:(int)index
{
    NSLog(@"adding %@ to %@", p, employees);
    // Add inverse of this operation to undo stack
    NSUndoManager *undo = [self undoManager];
    [[undo prepareWithInvocationTarget:self] removeObjectFromEmployeesAtIndex:index];
    if (![undo isUndoing])
        [undo setActionName:@"Insert Person"];

    // Finally, add person to the array
    [employees insertObject:p atIndex:index];
}

- (void)removeObjectFromEmployeesAtIndex:(int)index
{
    Person *p = [employees objectAtIndex:index];
    NSLog(@"removing %@ from %@", p, employees);
    // Add inverse of this operation to undo stack
    NSUndoManager *undo = [self undoManager];
    [[undo prepareWithInvocationTarget:self] insertObject:p
                                       inEmployeesAtIndex:index];
    if (![undo isUndoing])
        [undo setActionName:@"Delete Person"];

    // Finally, remove person from array
    [employees removeObjectAtIndex:index];
} 
```

我明白它想要做什么。（顺便说一句，`employees`是`NSArray`一个自定义`Person`类。）

作为一个 .NET 人，我尝试将不熟悉的 Obj-C 和 Cocoa 概念与大致类似的 .NET 概念联系起来。这是否类似于 .NET 的委托概念，但没有类型？

这不是从书中 100% 清楚的，所以我正在寻找真正的 Cocoa/Obj-C 专家的补充，目的是让我理解简单（-ish）示例下的基本概念。我真的希望能够独立应用这些知识——直到第 9 章，我都没有遇到任何困难。但现在 ...

提前致谢！

* * *

## 回答 #1

> 赞同：288
> 
> 时间：2008-11-24T05:01:06.030

根据[Apple 的 NSInvocation 类参考](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSInvocation_Class/Reference/Reference.html)：

> An`NSInvocation`是一个渲染为静态的 Objective-C 消息，也就是说，它是一个动作变成了一个对象。

而且，更详细*一点：*

消息的概念是objective-c哲学的核心。任何时候你调用一个方法，或者访问某个对象的一个​​变量，你就是在向它发送一条消息。`NSInvocation`当您想在不同的时间点向对象发送消息或多次发送相同的消息时，它会派上用场。`NSInvocation`允许您*描述*要发送的消息，然后稍后*调用*它（实际上将其发送到目标对象）。

* * *

例如，假设您想将字符串添加到数组中。您通常会`addObject:`按如下方式发送消息：

```
[myArray addObject:myString]; 
```

* * *

现在，假设您想`NSInvocation`在其他时间点发送此消息：

首先，您将准备一个与'选择器`NSInvocation`一起使用的对象：`NSMutableArray``addObject:`

```
NSMethodSignature * mySignature = [NSMutableArray
    instanceMethodSignatureForSelector:@selector(addObject:)];
NSInvocation * myInvocation = [NSInvocation
    invocationWithMethodSignature:mySignature]; 
```

接下来，您将指定将消息发送到哪个对象：

```
[myInvocation setTarget:myArray]; 
```

指定您希望发送给该对象的消息：

```
[myInvocation setSelector:@selector(addObject:)]; 
```

并填写该方法的任何参数：

```
[myInvocation setArgument:&myString atIndex:2]; 
```

请注意，对象参数必须通过指针传递。感谢[Ryan McCuaig](https://stackoverflow.com/users/53790/ryan-mccuaig)指出这一点，有关详细信息，请参阅[Apple 的文档。](https://developer.apple.com/documentation/foundation/nsinvocation/1437834-setargument?language=objc)

此时，`myInvocation`是一个完整的对象，描述了可以发送的消息。要实际发送消息，您会调用：

```
[myInvocation invoke]; 
```

这最后一步将导致消息被发送，本质上是执行`[myArray addObject:myString];`.

把它想象成发送电子邮件。您打开一个新的电子邮件（`NSInvocation`对象），填写您要发送的人（对象）的地址，为收件人输入一条消息（指定 a`selector`和参数），然后单击“发送”（调用`invoke`）。

有关更多信息，请参阅[使用 NSInvocation](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/DistrObjects/Tasks/invocations.html)。如果上述方法不起作用，请参阅[使用 NSInvocation 。](https://web.archive.org/web/20121014210741/https://developer.apple.com/library/mac/#/web/20121015003159/https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/DistrObjects/Tasks/invocations.html)

* * *

`NSUndoManager`使用`NSInvocation`对象，以便它可以*反转*命令。本质上，您所做的是创建一个`NSInvocation`对象来说：“嘿，如果您想撤消我刚刚所做的事情，请将此消息发送给该对象，并带有这些参数”。您将`NSInvocation`对象提供给`NSUndoManager`，然后它将该对象添加到可撤消操作的数组中。如果用户调用“撤消”，`NSUndoManager`只需在数组中查找最近的操作，并调用存储的`NSInvocation`对象来执行必要的操作。

有关更多详细信息，请参阅[注册撤消操作](http://developer.apple.com/documentation/Cocoa/Conceptual/UndoArchitecture/Tasks/RegisteringUndo.html)。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2010-07-11T21:57:27.807

下面是一个简单的 NSInvocation 示例：

```
- (void)hello:(NSString *)hello world:(NSString *)world
{
    NSLog(@"%@ %@!", hello, world);

    NSMethodSignature *signature  = [self methodSignatureForSelector:_cmd];
    NSInvocation      *invocation = [NSInvocation invocationWithMethodSignature:signature];

    [invocation setTarget:self];                    // index 0 (hidden)
    [invocation setSelector:_cmd];                  // index 1 (hidden)
    [invocation setArgument:&hello atIndex:2];      // index 2
    [invocation setArgument:&world atIndex:3];      // index 3

    // NSTimer's always retain invocation arguments due to their firing delay. Release will occur when the timer invalidates itself.
    [NSTimer scheduledTimerWithTimeInterval:1 invocation:invocation repeats:NO];
} 
```

调用时`[self hello:@"Hello" world:@"world"];`- 该方法将：

*   打印“你好世界！”
*   为自己创建一个 NSMethodSignature。
*   创建并填充一个 NSInvocation，调用它自己。
*   将 NSInvocation 传递给 NSTimer
*   计时器将在（大约）1 秒内触发，从而使用其原始参数再次调用该方法。
*   重复。

最后，你会得到这样的打印输出：

```
2010-07-11 17:48:45.262 Your App[2523:a0f] Hello world!
2010-07-11 17:48:46.266 Your App[2523:a0f] Hello world!
2010-07-11 17:48:47.266 Your App[2523:a0f] Hello world!
2010-07-11 17:48:48.267 Your App[2523:a0f] Hello world!
2010-07-11 17:48:49.268 Your App[2523:a0f] Hello world!
2010-07-11 17:48:50.268 Your App[2523:a0f] Hello world!
2010-07-11 17:48:51.269 Your App[2523:a0f] Hello world!
... 
```

当然，目标对象`self`必须继续存在，NSTimer 才能将 NSInvocation 发送给它。例如，在应用程序期间存在的**Singleton对象或 AppDelegate。**

* * *

**更新：**

如上所述，当您将 NSInvocation 作为参数传递给 NSTimer 时，NSTimer 会自动保留所有 NSInvocation 的参数。

如果您没有将 NSInvocation 作为参数传递给 NSTimer，并打算让它停留一段时间，则必须调用它的`-retainArguments`方法。否则它的参数可能会在调用被调用之前被释放，最终导致你的代码崩溃。这是如何做到的：

```
NSMethodSignature *signature  = ...;
NSInvocation      *invocation = [NSInvocation invocationWithMethodSignature:signature];
id                arg1        = ...;
id                arg2        = ...;

[invocation setTarget:...];
[invocation setSelector:...];
[invocation setArgument:&arg1 atIndex:2];
[invocation setArgument:&arg2 atIndex:3];

[invocation retainArguments];  // If you do not call this, arg1 and arg2 might be deallocated.

[self someMethodThatInvokesYourInvocationEventually:invocation]; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-02-02T00:24:00.830

您可以尝试在这里使用更好的库：http: [//cocoawithlove.com/2008/03/construct-nsinvocation-for-any-message.html](http://cocoawithlove.com/2008/03/construct-nsinvocation-for-any-message.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-28T15:33:26.040

我构建了一个使用 NSInvocation 调用各种方法类型的简单示例。

我在使用 obj_msgSend 调用多个参数时遇到问题

[https://github.com/clearbrian/NSInvocation_Runtime](https://github.com/clearbrian/NSInvocation_Runtime)

# javascript - 从 CDN (Google) 流式传输 jquery(JS 文件)

> ID：313409
> 
> 赞同：5
> 
> 时间：2008-11-24T04:28:47.687
> 
> 标签：javascript, jquery, performance, http

这是一个不做作业的情况。:-)

除了动态加载优势之外，当我可以从我的服务器将其加载为由 19kb jQuery zip 文件 + 附加的 JavaScript 代码组成的单个文件时，从 Google 服务器包含 JavaScript 库（在我的情况下为 jQuery）是否有意义已经写了——全部用 JS 压缩器压缩并提供 HTTP 放气。

使用 Google 服务器，我将进行 2 次（并行）HTTP 往返。一个获取 jquery 文件，另一个获取站点 JavaScript 代码。一个 19kb，另一个说 20-25kb。在正常情况下，它会从我的站点下载一个 30-35kb 的文件。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-24T05:02:51.767

考虑到从谷歌 CDN 下载的 jQuery 脚本很可能已经缓存在访问者的浏览器上，因为无论从哪里下载它都有一致的标头和缓存控制。因此，平均而言，大多数用户只需下载您的站点特定的 javascript 脚本。此外，CDN 通常比单个服务器具有更快的响应时间，因为它们从离您最近的服务器响应。

您的问题没有简单明了的答案，因为这两种方法在现代连接上都提供了良好的性能。您应该在胁迫下分析您的系统，看看哪种解决方案提供了最佳结果（以及是否需要这种优化）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T18:44:40.407

你确定脚本会被并行下载吗？[Cuzillion 的这个例子](http://stevesouders.com/cuzillion/?c0=hj1hfff2_0&c1=hj1hfff2_0&t=1227551978929)似乎是在说只有 IE8 才能做到这一点。

另外值得一提的是，您的网页浏览量中有多少是首次访问者以及有多少人之前访问过该网站，以帮助您确定缓存会影响下载时间的程度。如果您有大量首次访问者，则可能值得将其倾斜以使他们尽可能快地进行首次体验。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T12:35:28.313

httpwatch 对来自 google 的 js 文件进行的基准测试。

[http://blog.httpwatch.com/2008/11/27/google-adds-https-support-to-the-ajax-libraries-api/](http://blog.httpwatch.com/2008/11/27/google-adds-https-support-to-the-ajax-libraries-api/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T04:37:27.513

这是一个真正的问题吗？只需确保您的 HTTP 标头中的 Cache-Control 配置正确，最终用户的客户端只会拉一次。这是绝对微不足道的数据量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T21:20:30.617

在我看来，使用著名的[jQuery CDN](http://docs.jquery.com/Downloading_jQuery)（例如 Google 的）并没有任何真正的缺点，并且有一些潜在的好处，所以我个人更喜欢采用 CDN 方法。如果不出意外，作为我的源代码树的一部分，我需要担心和维护的文件少了一个。

我看到使用 CDN 与单个胖 JavaScript 存档相比有几个优点：

*   减少检索未缓存资源的延迟，因为这些资产是从边缘位置提供的
*   对于第 3 方脚本，用户的浏览器可能已经将它们缓存起来，并且不必为您的站点再次下载它们。
*   通过将资产分布在多个主机名之间来解决并行请求的每个主机浏览器的限制（当然，这也可以通过您自己的服务器使用简单的子域技巧来完成）。
*   减少主服务器上的整体负载，尤其是。在使用高峰期或 YC/Slashdot “攻击”期间很重要。

何时关心 HTML 页面资源的下载时间：

*   当您有大量首次访问者（来自搜索引擎和/或社交媒体）时。研究表明，现在人们不是很有耐心，所以你真的需要不遗余力地给人留下良好的第一印象。（另请参阅 Jakob Nielsen 关于[页面放弃](http://www.useit.com/alertbox/page-abandonment-time.html)、[应答引擎](http://www.useit.com/alertbox/20040816.html)和[响应时间](http://www.useit.com/alertbox/response-times.html)的文章。）
*   对于使用移动设备的访客。移动数据网络通常很慢和/或拥塞。
*   对于实行持续交付并导致资产频繁流失的商店（对于全新的网站和应用程序更常见）

*PS - Aaron Hopkins 有我见过的关于[优化页面加载时间的最佳文章之一。](http://www.die.net/musings/page_load_time/)有点过时了，但仍然很相关。*

*PSS - 你可能想看看 Zepto，一个轻量级（24K 对 100K），与[jQuery](http://zeptojs.com/)的 api 兼容的替代品。*

# javascript - IE 7 不显示简单的 JS 警报？

> ID：313410
> 
> 赞同：1
> 
> 时间：2008-11-24T04:29:06.593
> 
> 标签：javascript, internet-explorer-7, parallels

尝试单击以下页面上的“打印”按钮：（链接已删除 - 一致认为一切正常，问题出在我的设置上）出于调试目的，我用简单的警报替换了一段 javascript("test ")，甚至对我来说也没有出现在 IE7 中。它在 Safari、FF（Mac 和 PC）和 IE6 中运行良好，但由于某种原因它在 IE7 中无法运行。供您参考，按钮中的代码是这样的：

```
<a onclick="makeNewWindow()" href="#"><img src="/print.gif"/></a> 
```

/newsletter/print.js 里面的 JS 是这样的：

```
function makeNewWindow() {
   alert("test");   
} 
```

谁能帮助我了解是否有解决方法，或者这是否与我在 Mac 上通过 Parallels 运行“IE7 Standalone”这一事实有关？任何帮助是极大的赞赏。

谢谢，迈克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T04:36:42.053

刚刚在 IE7 Vista 上对其进行了测试，它运行良好......您的代码看起来也不错，所以我认为这可能是您的设置问题？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T06:52:30.300

在您的 IE7 的特定设置中可能禁用了 Javascript。请参阅此链接如何启用它： [http ://www.tranexp.com/win/JavaScript-enabling.htm](http://www.tranexp.com/win/JavaScript-enabling.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T07:40:44.820

可能是它正在缓存旧版本的 js 文件？试试 ctrl-F5

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T07:43:40.460

我猜您的其他 javascript 代码有错误，导致您的浏览器忽略其他所有内容。

此外，您可能希望将该代码更改为 ... onclick="makeNewWindow();return false" ... 以避免混淆

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-16T15:08:06.703

这可能不是最初的问题，但由于我遇到了同样的问题，所以我给出了我的发现，它可能对其他人有用。

事实上，我只是从 Windows 资源管理器中打开 HTML 来测试它，所以我`file://`在地址栏中有一个 URL。
这在所有浏览器中都可以正常工作，除了 Internet Explorer 7（也许更高版本）。
事实上，当我在 IE7 中打开这个文件时，我收到了一个关于带有脚本的本地文件的安全问题的警报。他们有太多的安全漏洞，以至于他们过度保护...

看来 alert() 只是在此本地模式下被停用，我找不到启用它的安全设置（不要太用力搜索......）。
我终于将文件放到了我本地 Apache 安装的 www 目录中（使用 WampServer 2，但其他发行版可能很好），并通过[http://localhost](http://localhost)打开它，并且 alert() 的行为在那里正常...

我还发现，`javascript:alert("Foo");`在地址栏中完全停用了，一个令人愤怒的“设计”选择……太方便了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-02T13:33:18.793

发布的第一个答案 - 即使用`href='javascript:void(0);'`而不是`href='#`'。在您的情况下，使用`href='javascript:yourFunction();'`它应该可以工作。IE 似乎将 href 优先于 onclick（其他浏览器没有）。此外，如果您没有 href，则会收到页面未找到错误。

# sql - What's the best way to store the days of the week an event takes place on in a relational database?

> ID：313417
> 
> 赞同：51
> 
> 时间：2008-11-24T04:36:08.747
> 
> 标签：sql, database-design

We're writing a records management product for schools and one of the requirements is the ability to manage course schedules. I haven't looked at the code for how we deal with this (I'm on a different project at the moment), but nonetheless I started wondering how best to handle one particular part of this requirement, namely how to handle the fact that each course can be held one or more days of the week, and how best to store this information in the database. To provide some context, a bare-bones `Course` table might contain the following columns:

```
Course          Example Data
------          ------------

DeptPrefix      ;MATH, ENG, CS, ...
Number          ;101, 300, 450, ...
Title           ;Algebra, Shakespeare, Advanced Data Structures, ...
Description     ;...
DaysOfWeek      ;Monday, Tuesday-Thursday, ...
StartTime       
EndTime 
```

What I'm wondering is, what is the best way to handle the `DaysOfWeek` column in this (contrived) example? The problem I'm having with it is that is a multi-valued field: that is, you can have a course on any day of the week, and the same course can take be held on more than one day. I know certain databases natively support multi-value columns, but is there a "best practice" to handle this assuming the database doesn't natively support it?

I've come up with the following possible solutions so far, but I'm wondering if anyone has anything better:

### Possible Solution #1: Treat DaysOfWeek as a bit field

This was the first thing that popped into my head (I'm not sure if that's a good thing or not...). In this solution, `DaysOfWeek` would be defined as a byte, and the first 7 bits would be used to represent the days of week (one bit for each day). A 1 bit would indicate that a class was held on corresponding day of the week.

**Pros**: Easy to implement (the application can deal with the bit manipulations), works with any database.

**Cons**: Harder to write queries that use the `DaysOfWeek` column (although you could deal with this at the application level, or create views and stored procedues in the database to simplify this), breaks relational database model.

### Possible Solution #2: Store DaysOfWeek as a string of characters

This is essentially the same approach as using a bit field, but instead of dealing with raw bits, you assign a unique letter to each day of the week, and the `DaysOfWeek` column just stores a sequence of letters indicating what days a course is held on. For example, you might associate each weekday with a single-character code as follows:

```
Weekday      Letter
-------      ------

Sunday       S
Monday       M
Tuesday      T
Wednesday    W
Thursday     R
Friday       F
Saturday     U 
```

In this case, a course held on Monday, Tuesday, and Friday would have have the value `'MTF'` for `DaysOfWeek`, while a class held only on Wednesdays would have a `DaysOfWeek` value of `'W'`.

**Pros**: Easier to deal with in queries (i.e. You could use `INSTR`, or its equivalent, to determine if a class is held on a given day). Works with any database that supports INSTR or an equivalent function (most, I would guess...). Also friendlier to look at, and easy to see at a glance what is happening in queries that use the `DaysOfWeek` column.

**Cons**: The only real "con" is that, like the bitfield approach, this breaks the relational model by storing a variable number of values in a single field.

### Possible Solution #3: Use a Lookup Table (ugly)

Another possibility would be to create a new table that stores all the unique combinations of days of the week, and have the `Course.DaysOfWeek` column simply be a foreign key into this lookup table. However, this solution seems like the most inelegant one, and I only considered it because it seemed like the The Relational Way^(TM) to do things.

**Pros**: It's the only solution that is "pure" from a relational database point of view.

**Cons**: It's inelegant and cumbersome. For example, how would you design the user interface for assigning corresponding weekdays to a given course around the lookup table? I doubt a user wants to deal with choices alongs the lines of "Sunday", "Sunday, Monday", "Sunday, Monday, Tuesday", "Sunday, Monday, Tuesday, Wednesday", and so on...

### Other Ideas?

So, is there a more elegant way to handle multiple values in a single column? Or would one the proposed solutions suffice? For what it's worth, I think my second solution is probably the best of the three possible solutions that I outlined here, but I'd be curious to see if someone has a different opinion (or indeed a different approach altogether).

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2014-06-12T00:12:15.460

I don't think it's hard to write queries if we use the bit option. Just use simple binary math. I think it's the most efficient method. Personally, I do it all the time. Take a look:

```
 sun=1, mon=2, tue=4, wed=8, thu=16, fri=32, sat=64\. 
```

Now, say the course is held on mon, wed and fri. the value to save in database would be 42 (2+8+32). Then you can select courses on wednesday like this:

```
select * from courses where (days & 8) > 0 
```

if you want courses on thu and fri you would write:

```
select * from courses where (days & 48) > 0 
```

this article is relevant: [http://en.wikipedia.org/wiki/Bitwise_operation](http://en.wikipedia.org/wiki/Bitwise_operation)

you can put days of week numbers, as constants in your code and it will be clear enough.

Hope it helps.

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-11-24T04:51:57.280

I would avoid the string option for the sense of purity: it adds an extra layer of encoding/decoding that you do not need. It may also mess you up in the case of internationalization.

Since the number of days in a week is 7, I would keep seven columns, perhaps boolean. This will also facilitate subsequent queries. This will also be useful if the tool is ever used in countries where the workweek starts on different days.

I would avoid the lookup because that would be over-normalization. Unless your set of lookup items is not obvious or could possibly change, it's overkill. In the case of days-of-the-week (unlike US states, for example), I would sleep soundly with the fixed set.

Considering the data domain, I don't think that a bitfield would achieve any significant space savings for you and would just make your code more complex.

Finally, a word of warning about the domain: a lot of schools do weird things with their schedules where they "swap days" to balance out an equal number of weekdays of each type over the semester despite holidays. I am not clear about your system, but perhaps the best approach would be to store a table of the actual dates in which the course is expected to take place. This way, if there are two Tuesdays in a week, the teacher can get paid for showing up twice, and the teacher for the Thursday that was canceled will not pay.

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-24T04:45:18.840

A possible #4: Why does it need to be a single column? You could add 7 bit columns for each day of the week to the table. Writing SQL against it is simple, just test for a 1 in the column of your choice. And the app code reading from the database just hides this in a switch. I realize that this is not normal form and I usually spend quite a bit of time trying to undo such designs from previous programmers, but I somewhat doubt that we're going to add an eighth day to the week any time soon.

To comment on the other solutions, I would probably groan if I encountered the lookup table. My first inclination as well was the bit field with a few custom database functions to help you write natural queries against that field easily.

I'll be curious to read some of the other suggestions that people come up with.

Edit: I should add that #3 and the suggestion above are easier to add indexes to. I'm not sure how one could write a SQL query like "get me all classes on Thursday" for the #1 or #2 queries that wouldn't result in a table scan. But I may just be dim tonight.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-24T04:50:03.370

Solution number 3 seems to be closest to what I would recommend. An extension on the idea of the look up table. Each course has one or more sessions. Create a session table with attributes: course_id, day, time, lecturer_id, room_id etc.

You now have the ability to assign a different lecturer or room to each session of each course assuming that you may want to store this data later.

The user interface issues are not relevant if you are considering the best database design. You can always create views for displaying the data, and for capturing the data your application can take care of the logic of capturing many sessions for each course and adding them to the database.

The meaning of the tables would be clearer which makes long term maintenance easier.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-24T04:51:15.083

If you choose one or two, your table will not be in 1NF (first normal form) as it contains a multi-valued column.

Nicholas has an excellent idea, although I'd disagree that his idea breaks first normal form: The data is not actually repeating, as each day is being stored independently. The only problem with it is that you have to retrieve more columns.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-24T08:26:51.153

If performance is an issue I would recommend a cleaner varation of #3.

Link your course to a "schedule" table.

Which is in turn linked to a days_in_schedule table.

The days_in_schedule table has columns the schedule_name, and the date in_schedule_day. With a row for each valid day in that schedule.

You need some time opr some clever program to populate the table but once this is done the flexibility is worth it.

You can cope not only with "course on Fridays only", but also "first semester only", "lab closed for refurbishment in third semester" and "Canadian branch has differnet holiday schedule".

Other possible queries are "Whats the end date of 20 day course starting 1st April", which "schedules clash most". If you are really good at SQL you can ask "what possible days are open in course xxx to a student who is already booked for course yyy" -- which I have the feeling is the real puprose of your proposed system.

# algorithm - 集合并集运算的运行时间

> ID：313422
> 
> 赞同：7
> 
> 时间：2008-11-24T04:40:14.933
> 
> 标签：algorithm, language-agnostic, theory, set

给定两个集合 A 和 B，找到它们并集的常用算法是什么，它的运行时间是多少？

我的直觉：

```
a = set((1, 2, 3))
b = set((2, 3, 5))
union = set()
for el in a:
    union.add(el)

for el in b:
    union.add(el) 
```

添加检查碰撞，即 O(1)，然后添加元素，即 (??)。这样做 n 次（其中 n 是 |a| + |b|）。所以这是 O(n * x)，其中 x 是添加操作的平均运行时间。

它是否正确？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T04:54:02.427

add/find(collision) 的复杂性取决于联合的实现。

如果您使用一些基于哈希表的数据结构，那么假设一个良好的哈希函数，您的碰撞操作确实将是恒定的。

否则，对于排序列表/树数据结构，添加可能是 O(Log(N))。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T05:07:59.823

第一个答案：如果您正在处理*数字*集合，您可以将集合实现为不同元素的*排序*向量。然后您可以简单地将 union(S1, S2) 实现为合并操作（检查重复项），这需要 O(n) 时间，其中 n = 基数之和。

现在，我的第一个答案有点天真。Akusete 是对的：您可以并且应该将集合实现为哈希表（集合应该是通用容器，并非所有对象都可以排序！）。然后，搜索和插入都是 O(1)，正如你猜到的，联合需要 O(n) 时间。

（查看您的 Python 代码）Python 集是使用哈希表实现的。通读[这个有趣的线程](http://mail.python.org/pipermail/python-list/2008-January/471938.html)。另请参阅[这个](http://code.activestate.com/recipes/230113/)使用排序向量的实现。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T06:54:20.200

这非常依赖于实现。其他人提到了基于可比较的集合（具有小于排序）或散列（具有良好的散列散列函数）。另一种可能的实现涉及“union-find”，它只支持通常集合操作的一个专门子集，但速度非常快（我认为联合是摊销的常数时间？），你可以在这里阅读

[http://en.wikipedia.org/wiki/Union_find](http://en.wikipedia.org/wiki/Union_find)

并在此处查看示例应用程序

[http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!220.entry](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!220.entry)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T10:00:24.677

如果您可以使用位集（int 数组中的每个位都等于您的集合中的一项），您可以简单地遍历 int 数组并对元素进行 OR。这具有复杂性 O(N)（其中 N 是数组的长度）或 O((m+31)/32)，其中 M 是项目数。

# c++ - C++ 用另一个向量扩展一个向量

> ID：313432
> 
> 赞同：65
> 
> 时间：2008-11-24T04:49:39.657
> 
> 标签：c++, vector

我是 C++ 领域的 C/Python 程序员，第一次使用 STL。

在 Python 中，用另一个列表扩展一个列表使用以下`.extend`方法：

```
>>> v = [1, 2, 3]
>>> v_prime = [4, 5, 6]
>>> v.extend(v_prime)
>>> print(v)
[1, 2, 3, 4, 5, 6] 
```

我目前使用这种算法方法来扩展 C++ 中的向量：

```
v.resize(v.size() + v_prime.size());
copy(v_prime.begin(), v_prime.end(), v.rbegin()); 
```

这是扩展向量的规范方法，还是我缺少一种更简单的方法？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2008-11-24T04:54:49.617

从[这里](http://www.cplusplus.com/reference/stl/vector/insert.html)

```
// reserve() is optional - just to improve performance
v.reserve(v.size() + distance(v_prime.begin(),v_prime.end()));
v.insert(v.end(),v_prime.begin(),v_prime.end()); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-11-24T06:02:51.960

```
copy(v_prime.begin(), v_prime.end(), back_inserter(v)); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-12-12T15:57:40.187

有多种方法可以实现您的目标。

> **标准::向量::插入**

可以通过在指定位置的元素之前插入新元素来扩展向量，从而通过插入的元素数量有效地增加容器大小。您可以遵循以下方法之一。第二个版本使用 C++11，它可以被认为是一个更通用的答案，因为 b 也可以是一个数组。

```
a.insert(a.end(), b.begin(), b.end());
a.insert(std::end(a), std::begin(b), std::end(b)); 
```

有时在使用中最好在使用 std::vector::insert 之前使用保留函数。**std::vector::reserve**函数将容器的容量增加到大于或等于 new_cap 的值。如果 new_cap 大于当前容量（），则分配新存储，否则该方法不执行任何操作。

```
a.reserve(a.size() + distance(b.begin(), b.end())); 
```

不需要使用保留功能，但可能是可取的。如果您重复插入一个您知道最终大小并且该大小很大的向量，那么最好使用保留。否则，最好让 STL 根据需要增长您的向量。

> **标准::复制**

std::copy 是您可以考虑实现目标的第二个选项。此函数将范围 (first,last) 中的元素复制到从 result 开始的范围中。

```
std::copy (b.begin(), b.end(), std::back_inserter(a)); 
```

然而使用 std::copy 比使用 std::vector::insert() 慢，因为 std::copy() 不能预先预留足够的空间（它无法访问向量本身，仅适用于具有的迭代器），而作为成员函数的 std::vector::insert() 可以。由于 std::copy 确实比使用 std::vector::insert 慢。大多数人在不知道这种情况的情况下过度使用 std::copy 。

> **boost::push_back**

您可以考虑的第三个选项是使用 boost 的**push_back**函数。

```
boost::push_back(a, b); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-12-10T18:50:08.083

我需要 C++14 中函数的两种不同变体`extend`，其中一个支持要附加的向量的每个元素的移动语义。

`vec`是你的`v`，`ext`是你的`v_prime`。

```
/**
 * Extend a vector with elements, without destroying source one.
 */
template<typename T>
void vector_extend(std::vector<T> &vec, const std::vector<T> &ext) {
    vec.reserve(vec.size() + ext.size());
    vec.insert(std::end(vec), std::begin(ext), std::end(ext));
}

/**
 * Extend a vector with elements with move semantics.
 */
template<typename T>
void vector_extend(std::vector<T> &vec, std::vector<T> &&ext) {
    if (vec.empty()) {
        vec = std::move(ext);
    }
    else {
        vec.reserve(vec.size() + ext.size());
        std::move(std::begin(ext), std::end(ext), std::back_inserter(vec));
        ext.clear();
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-02-11T14:16:16.630

使用[`std::vector::insert`](http://devdocs.io/cpp/container/vector/insert);

```
A.reserve(A.size() + B.size());
A.insert(A.end(), B.begin(), B.end()); 
```

`reserve()`是可选的，但使用它有助于提高性能。

* * *

方便的代码生成器可节省宝贵的时间：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/css/materialize.min.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/js/materialize.min.js"></script><script src="https://cdn.jsdelivr.net/clipboard.js/1.6.0/clipboard.min.js"></script><script>function generateCode(){codeTemplate="{0}.reserve({0}.size() + {1}.size()); \n{0}.insert({0}.end(), {1}.begin(), {1}.end());",first=document.getElementById("1").value,second=document.getElementById("2").value,""==first&&(first="A"),""==second&&(second="B"),document.getElementById("c").innerHTML=String.format(codeTemplate,first,second)}String.format||(String.format=function(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/{(\d+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a})});</script><div class="A" style="margin:3% 10% 1% 10%;"><label for="1">First vector name:</label><input id="1"/><br/><label for="1">Second vector name:</label><input id="2"/><div class="D"><a class="waves-effect waves-light btn red col" onclick="generateCode();" style="margin:0 0 4% 0;">Generate Code</a></div><textarea id="c" onclick="this.select()" style="border:none;height:auto;overflow: hidden;font-family:Consolas,Monaco;">A.reserve(A.size() + B.size());&#13;&#10;A.insert(A.end(), B.begin(), B.end());</textarea></div>
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-09-28T12:37:09.043

仅使用以下语法：

```
a.insert(a.end(), b.begin(), b.end()); 
```

**除非您知道自己在做什么，否则不应使用 Reserve\Resize**。

预留可能会导致大量开销，因为它不一定会分配大小的指数增长，因此每个预留都可能导致 O(n) 时间。

**如果只**执行一次，这可能不会非常昂贵，并且在这种情况下实际上可能会证明更多的时间\内存效率。另一方面，如果您继续以这种方式使用相对较小的数组扩展数组，这将证明效率极低**。**以下示例显示了一个导致 x10,000 时间增加的简单误用

例子：

```
#include <vector>
#include <iostream>
#include <chrono>

int main() {
    std::vector<int> a, b(50);
    auto t1 = std::chrono::high_resolution_clock::now();
    for (int i = 0; i < 5e4; i++) {
        a.reserve(a.size() + b.size());      // line in question.
        a.insert(a.end(), b.begin(), b.end());
    }
    auto t2 = std::chrono::high_resolution_clock::now();
    auto duration = std::chrono::duration_cast<std::chrono::nanoseconds>( t2 - t1 ).count();

    std::cout << 1.0 * duration / 1e9;
    return 0;
}

//run              time        complexity      speed up
//with reserve     114.558 s   O(N)            x1
//without reserve    0.012 s   O(N^2)          x10000 (~O(N/50)) 
```

在 gcc 17、intel i5 上使用 -O3 编译。

# asp.net - 在 mvc 应用程序中设置 jquery 路径的问题

> ID：313434
> 
> 赞同：3
> 
> 时间：2008-11-24T04:50:06.520
> 
> 标签：asp.net, asp.net-mvc

我无法在 mvc 应用程序中设置 jquery 的路径。在我的母版页中，我声明了脚本，并且 jquery 在我的应用程序的根目录下工作。当我导航到我的应用程序中的内容视图页面时，jquery 没有正确加载。我是否还需要在内容页面中设置路径或以不同方式声明路径？

```
<script src="Views/Scripts/jquery-1.2.6.min.js" type="text/javascript"></script> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-24T10:44:58.410

虽然使用绝对路径适用于某些安装，但在子目录中安装时会出现问题。更安全的解决方案是使用 Url.Content ，它将始终正确解析路径：

```
<script src="<%= Url.Content("~/Content/jquery-1.2.6.min.js") %>" type="text/javascript"></script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T04:56:22.343

母版页上的 src 是相对的，不适用于子页。如果您将路径声明为绝对路径（例如“/Views/Scripts/jquery-1.2.6.min.js”），它应该可以工作；

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T19:45:14.653

我建议使用辅助方法

```
public static class Helper
{
    private static string ScriptsRoot = "~/views/scripts/";

    public static string ScriptUrl (string scriptFile)
    {
        return VirtualPathUtility.ToAbsolute (ScriptsRoot + scriptFile);
    }
} 
```

然后像这样引用您的脚本：

```
<script type="text/javascript" src="<%= Helper.ScriptUrl("jquery-1.2.6.min.js") %>"></script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T22:52:41.187

当您在母版页上时，您可以使用

```
<script src="<%=ResolveUrl(~/Views/Scripts/jquery-1.2.6.min.js) %>" type="text/javascript"></script> 
```

ResolveUrl 是从 Control 继承的方法。因此，从 Control 派生的 MasterPage 可以使用它。

# linux - 是否有任何命令通常用于比较 bash shell 脚本中的时间？

> ID：313437
> 
> 赞同：2
> 
> 时间：2008-11-24T04:51:39.327
> 
> 标签：linux, bash, datetime, time, shell

这是一个旧的计算机类项目，我已经完成了，现在想知道是否有更好的做事方式。

我们曾经编写了一个约会.sh 程序，我在其中使用一种算法解决了比较时间，该算法将时间转换为您可以比较今天和明天的某个数字，当然会发生什么是它计算出明天更大，而不是今天，您可以通过比较所述转换时间，根据是否采用日期/小时来安排约会。

我想知道是否有一个操作系统命令来告诉 linux 中的 bash 时间？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T04:55:44.077

`date`告诉你当前时间。您可以使用命令行参数来指定格式，请参阅`man date`.

例如对于 UNIX 时间戳（您可以轻松比较的数字），您可以调用`date +%s`.

# c# - 如何在 C# 中使用反射读取平面文件的架构

> ID：313438
> 
> 赞同：1
> 
> 时间：2008-11-24T04:51:52.990
> 
> 标签：c#, file, reflection, flat

如何在 C# 中使用反射读取平面文件的架构 我的简要概述是 - 有一些服务器将数据存储为平面文件，我必须将数据从 SQL Server 推送到这些平面文件。为此，我需要知道他们的架构。我对此一无所知，任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T10:33:10.867

很难知道从哪里开始这个问题，因为听起来反射不太可能有帮助，但您指定它必须出现在解决方案中！:)

因此，这个答案主要是猜测，并且可能会随着您透露更多信息而演变。这可以; 在你知道问题是什么之前，你无法得到答案 (42)。

平面文件是什么并没有单一的定义。您可能需要一个解析文件中“记录”的函数。通常的方法是在十六进制编辑器中打开文件，并从一些示例记录中推断出格式。寻找有关重复图案形状的线索。每个“记录”是否似乎由多个“字段”组成？它们是否每次都以明确的顺序出现，还是每个字段都以名称或数字作为前缀以表明其含义？它看起来像纯文本吗，即您可以在记事本中打开它而不会丢失重要信息吗？

声明一个类来表示一条记录：

```
public class FlatFileRecord
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    // etc.
} 
```

然后编写一个从流中读取并产生记录的函数：

```
public static IEnumerable<FlatFileRecord> ParseFlatFile(StreamReader stream)
{
    // etc. 
```

如果文件是“纯文本”（即，它具有以某种重要方式用于分隔记录或字段的回车/换行字符），则使用 StreamReader 将是合适的。

假设每条记录是一行纯文本（换句话说，每条记录由一个特殊的行尾序列分隔）。在该行中有多个字段，以某种方式由其他特殊字符分隔。您的解析器可能被构造为一个循环：

```
string line;
while ((line = r.ReadLine()) != null)
    yield return new FlatFileRecord(line); 
```

这将问题分解为两个层次。外层一次通过一条线，每条线产生一条记录。然后有一个我想象的内部级别放入 FlatFileRecord 的构造函数中。通过一行，它会用它知道如何从该行中提取的字段值填充自己。所以现在你必须编写 FlatFileRecord 的构造函数。

# asp.net - 内容控件必须是顶级控件

> ID：313442
> 
> 赞同：7
> 
> 时间：2008-11-24T04:54:21.643
> 
> 标签：asp.net

我有一个可以从 www.blahblah.com 和 special.blahblah.com 访问的网站。www 站点始终有效，但有时我会在特殊站点上收到“内容控件必须是内容页面中的顶级控件或引用母版页的嵌套母版页”错误。

在这两种情况下运行的代码完全相同，并且有问题的页面甚至没有母版页。为什么它总是在一个上工作而有时在另一个上失败？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-10T10:30:55.987

如果有人在动态切换母版页时收到此错误消息，请确保您的代码是

```
MasterPageFile = "TheMasterPage.master" 
```

不是

```
this.master.MasterPageFile = "TheMasterPage.master" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-11-29T04:18:54.917

刚遇到这个问题。这是因为我们有一个以双斜杠结尾的标签：

```
<//asp:HyperLink> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-28T15:16:40.677

在您的一个服务器控件中查找未关闭的标签，我正在运行 VS2010 并且 IDE aspx 验证器没有选择未关闭的标签

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-07-11T11:38:59.493

如果您在网站上放置一个标签，然后在该网站中间放置另一个标签，然后您将第二个标签关闭在第一个标签之外，那么如果您知道我的意思，他们就有点割伤自己了

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-25T21:12:52.490

我的问题是我混淆`<ASP:CONTENT`了`<ASP:ContentPlaceholder`

`<ASP:CONTENT`继续内容文件...不是母版页！确保您使用正确的控件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-06T17:09:18.433

就我而言，我试图让RequiredFieldValidator 自动关闭。控件必须有单独的结束标记：`</asp:RequiredFieldValidator>.`

这将导致错误： `<asp:RequiredFieldValidator ID="rfvx"` `runat="server"ErrorMessage="`*`</b>"ControlToValidate="xxx" />`

好的语法： `<asp:RequiredFieldValidator ID="rfvx" runat="server" ErrorMessage="`*`</b>"ControlToValidate="xxx" ></asp:RequiredFieldValidator>`

# java - 任何人都可以量化 C++ 和 Java 之间的性能差异吗？

> ID：313446
> 
> 赞同：16
> 
> 时间：2008-11-24T04:55:02.080
> 
> 标签：java, c++, performance, comparison

Java 在 JIT 之前最初很慢，但今天的性能非常接近 C++。我想知道是否有人在两种语言之间进行了可衡量的性能比较？ **与 C++ 相比，Java 的不足之处在哪里？** Java 为开发人员提供了许多生产力提升，因此他们可以更快地编写应用程序，因为垃圾大学、缺乏指针等。例如，Firefox、Webkit 和 Open Office 等应用程序如果以 100 编写，则可以更快、更可靠地开发% Java，可能是 2 倍，但出于性能原因，开发人员仍然选择 C/C++。有人可以证明 Java 不能像我提到的应用程序那样在 C++ 中表现得一样好。

让我补充一点，很多应用程序工作仍在 C++ 中完成是有原因的。这不仅仅是一个主观问题。具有更高抽象级别的语言经常会付出性能损失。如果不存在这种惩罚，我们都将使用高级语言进行编程。与 C++ 相比，Java 的优势在哪里？请明确点。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-24T09:24:07.653

语言没有速度。Java 或 C++ 语言规范都没有指定“并且程序必须编译为*如此*高效”。

每种语言都指定了程序必须做的事情的列表，或者至少*看起来要做的事情*，这在某些情况下为程序的效率设定了上限，但通常，聪明的编译器可以在单个程序中忽略这些规则，因为重要的是程序的行为*就像*遵循了规范一样。函数可以内联，堆数据可以移动到堆栈等等。

程序的性能取决于三件事：编译器、底层平台/硬件和程序代码本身。

不是“语言”。你得到的最接近的是编译器。

两种语言都比另一种更快是有充分理由的。C++ 做出的承诺可能会减慢程序执行速度，但 Java 是 JIT 的，这意味着它可能会利用运行时信息来优化代码，而 C++ 不能轻易做到这一点......规范是否说 C++*不能*被 jit'ed。就像我相信也有 Java 编译器生成本机代码而不是 JVM 字节码一样。

只有当您有一台正在运行的特定计算机、每种语言的特定编译器以及每种语言的程序的特定实现时，您的问题才有意义，*在这种情况下，您可以同时运行两者以查看哪个是最快*的。

垃圾收集是另一个很好的例子。当然，垃圾收集意味着一些开销，但它也启用了一些重要的捷径。在 Java 或 .NET 等托管语言中，堆分配非常便宜，*因为*它是托管和垃圾收集的。在 C++ 中，它是....未指定，当然，但在实践中，通常非常慢，因为操作系统必须遍历堆才能在或多或少碎片化的内存空间中找到空闲的内存块。哪个最快？取决于操作系统。取决于编译器。取决于源代码。

源代码也有很大的不同。如果你将一个 Java 程序天真地移植到 C++ 中，它的表现会像垃圾一样。C++ 不能很好地处理虚函数，通常有更好的替代方案可供您使用。堆分配在 C++ 中可能非常慢，因此再次天真地重新实现 Java 程序将是极其低效的。当走相反的路时也是如此。如果直接移植到 Java，许多 C++ 习惯用法会不必要地变慢。因此，即使您选择了一个平台和一个编译器，您如何比较程序的性能？甚至要让它编译器，你必须编写它的两个实现，然后它就不再是同一个程序。

但是，我认为公平地说，在大多数现代硬件上，使用现代 Java 编译器和现代 C++ 编译器，大多数程序都可以非常高效地实现，而且速度肯定足够快。但前提是您了解您正在使用的语言并遵守其规则。如果您尝试用 C++ 编写 Java 代码，那么 Java 会神奇地变得更加高效，反之亦然。

我想对您的问题最简洁的回答是“不。没有人可以量化 C++ 和 Java 之间的性能差异”；）

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-24T05:28:58.063

对于许多单独的代码构造，JIT 编译器可以更快，因为它们可以利用代码的运行时分析。

例如，VonC 在他对这个问题的回答中提到了所有对象的堆分配。这实际上是不正确的：如果 JIT 可以通过[转义分析](https://www.ibm.com/developerworks/java/library/j-jtp09275/index.html#2.1 "逃逸分析")证明对对象的引用不会超过堆栈帧，则它可以在堆栈上分配对象。通过这种方式，编译器可以获得堆栈分配的性能优势，而程序员可以放心假定的 GC 堆分配的安全性。

类似地，Uri 提到了虚函数（在大多数非 C++ 语言中称为虚方法）。这是另一种情况，JIT 编译器具有提前 (AOT) 编译器几乎永远无法获得的优势：JIT 可以插入内联的廉价类型检查（取消引用的字比较），并且实际上内联虚拟方法调用，如果该特定调用站点恰好是单态的（即实际类型在实践中总是相同的）。事实证明，在实践中，多达[95% 的虚拟方法调用](http://blogs.azulsystems.com/cliff/2008/11/a-brief-conversation-with-david-moon.html "Azul Systems - Cliff Click Jr. 的博客")都是单态的，所以这可能是一个很大的胜利——而且对于 AOT 编译器来说，这是一个很难利用的胜利，因为运行时代码加载可能会改变运行时特性动态的。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-24T05:10:38.290

为了完成 Pax 和 Uri 的回答，这里有一些*最近的*基准：

*   [性能比较 - C++/Java/Python/Ruby/Jython/JRuby/Groovy](http://blog.dhananjaynene.com/2008/07/performance-comparison-c-java-python-ruby-jython-jruby-groovy/)
*   [Java 性能（维基百科）](http://en.wikipedia.org/wiki/Java_performance#Java_SE_6)

如前所述，这是两种截然不同的语言，有些人相信[Java 将永远比 C++ 慢，](http://www.jelovic.com/articles/why_java_is_slow.htm)因为：

*   *所有*对象的堆分配（即使是像迭代器这样的小对象）
*   大量动态铸件
*   内存使用量增加

[幽默]

> “Java 是高性能。高性能意味着足够。足够意味着慢。” [兔子先生](http://www.mrbunny.com/)

正如[dribeas](https://stackoverflow.com/users/36565/dribeas)在评论中提到的，堆分配不是一个好的论据。
这部《[都市表演传奇，重温](http://www.ibm.com/developerworks/java/library/j-jtp09275.html)》提到：

> “垃圾收集永远不会像直接内存管理那样高效。” 而且，在某种程度上，这些陈述是正确的——**动态内存管理没有那么快——它通常要快得多**。
> malloc/free 方法一次处理一个内存块，而垃圾收集方法倾向于处理大批量的内存管理，从而产生更多优化机会（以损失一些可预测性为代价）。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-24T07:39:40.640

另一个板凳：[枪战](http://shootout.alioth.debian.org/)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-24T05:01:16.030

在许多方面，这就像将苹果与橙子进行比较。

C++ 建立在这样一个概念之上，即您无需为不使用的任何东西付费。如果您自己管理内存，如果您不使用虚拟功能等。

Java 没有给你这种自由。它为您提供了您甚至可能不想要的功能。对于您可能想要自己分配内存的所有内容，您必须对所有内容使用堆对象，因此您将受到垃圾收集的影响。

一旦您开始谈论 GUI，就很难进行比较，因为不同的 UI 框架和工具包具有不同的性能问题。例如，Swing/AWT 通常会比直接为本机操作系统编写的内容要慢。在 C++ 中，您很少会找到真正可移植的工具包等。

我认为当开发人员开始使用 openoffice 时，Java 速度要慢得多，UI 工具包又慢又丑。Eclipse 之类的工具证明即使在 Java 中您也可以构建相对不错的 UI，尽管不可否认，SWT 是一个在本机级别上做很多事情的工具包。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-24T13:26:00.287

许多人忘记的是，JIT 技术可以应用于任何类型的二进制文件，甚至是由 C++ 编译器生成的二进制文件。如果您使用诸如 HP 的 Dynamo 之类的东西（一个运行可执行文件的仿真器比它运行和仿真的本机芯片更快），Java 的 JIT 编译的大部分好处也适用于 C++。运行时分析并不是 Java 的真正性能优势，而是 JIT 编译的一般优势。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-11-24T05:22:42.447

对我来说，这个问题有点牵强附会（也许不是故意的）。它确实是一个错误的问题。

首先要问的问题是这些

1.  是什么让我的程序运行缓慢？
2.  对于我的新程序，关键性能设计考虑因素是什么？

这里有一些很好的“为什么”问题

*   是否有太多不必要的 I/O？
*   是否使用了太多内存？
*   内存分配器是否被破坏（分配器太多，细粒度对象太多）
*   我的程序是否在网络 I/O 上长时间阻塞
*   把锁放在错误的地方

我怀疑您确实需要首先关注程序的性能方面（带有大写“P”）而不是**性能**（小“p”）方面**。**如果你能达到语言障碍的地步，那么你在性能方面做得非常好。

对于新代码 - 提前计划性能和效率很重要。我总是建议像对待任何其他特性（它们是特性）一样对待性能和效率：就像 UI bling 或可靠性一样。 *当然，*这取决于很多事情——但是当它很重要时，你需要预先计划：

*   选择适合数据集和预期扩展的数据结构和算法
*   适当的基于多线程 UI 的应用程序（UI 线程、后台/处理线程）
*   *规划*较长的网络 I/O 延迟
*   *计划*设定目标并预先衡量绩效 - 定期运行回归测试
*   测量内存使用 - 内存消耗很慢（让笑话开始:)）
*   有事件、回调或其他通知机制时不要轮询

我认为这是一个红鲱鱼的原因是很少有人可以在 C++ 和 Java 之间进行选择——它们是非常非常不同的语言，具有非常不同的运行时间。我怀疑更常见的是，您有其他约束以一种或另一种方式推动您-这些将是比语言表现更高的阶数。现有代码的可计算性、现有员工的技能和经验等。

环境也有所不同。例如，Java 几乎永远不会成为 widows 客户端（相对于 Web）应用程序的正确选择。相反，原生 C++ 几乎永远不会成为基于 Web 的应用程序的选择。（注意，我是一个 Windows 人——在 *nix 中情况可能非常不同）。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-11-24T05:02:46.933

我不相信任何人可以证明 C++ 总是比 Java 快得多，因为你总是可以恢复到 JNI 以从 Java 获得本机速度。

例如，请参阅 SWT，它是 IBM（我认为）构建的图形工具，旨在取代 Swing 并提供本机性能和外观。

一方面，我更喜欢易于开发而不是速度，因为我认为最短的开发时间比原始应用程序速度更重要，特别是当我仍然可以达到那个速度时 - 我可以同时拥有 Java 的易于开发**和**编译语言的速度。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-11-24T09:55:22.940

需要考虑的几点：

*   如果你得到一个更好的 C++ 编译器，你的代码不会变得更快。您需要先重新编译它。如果你有一个更好的 JVM，你所有的 Java 代码都会运行得更快

*   如果您获得更好的 C++ 编译器/JVM，您将看到执行速度提高 10-20%，通常是在极端情况下。如果您找到更好的算法来实现您所需要的，您可以轻松获得 1,000%-10,000% 的性能提升，有时甚至更多。

所以今天，如果性能是一个问题，你应该看看这两个事实：

*   该语言使用另一种算法替换一种算法变得多么容易？（又名“重构”）
*   您可以在其中编写代码多快？

其他任何事情都只是 FUD。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-06-22T21:03:25.347

我已经用 C 和 Java 实现了对性能敏感的应用程序（物理模拟、金融模型）。现实情况是，通过更改算法比通过调整实现来获得更大的性能提升——但实现也很重要。就目前而言，我的观点是 Java 比 C 慢（我对 C++ 中的数字没有太多经验），但是通过仔细调整可以获得很多东西，而且这种调整在 Java 中要容易得多，因为你不必处理分段错误、双重释放等。C++ 在这里占据了中间位置，因为现代 C++ 技术（智能指针、模板、STL 容器）提供了速度和相对安全的使用。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-07-01T23:37:13.690

> 与 C++ 相比，Java 的不足之处在哪里？

很好的问题。与 C++ 相比，Java 和 JVM 有两个主要缺陷会削弱性能：

*   基于类型擦除的泛型。

*   缺少值类型。

前者意味着通用代码会导致装箱和拆箱，这会导致大量不必要的分配和额外的对缓存不友好的间接级别。

后者意味着程序员不可能拆箱任意数据结构，如复数（浮点数对）、哈希表条目（键值对）和顶点数据。

这两个问题结合在一起，使得在 Java 中实现高效的通用哈希表成为不可能。特别是，.NET 解决了这两个问题。例如，[Java 的通用哈希表可能比 .NET 慢 17 倍`Dictionary`](http://fsharpnews.blogspot.com/2010/05/java-vs-f.html)。

此外，与 C++ 相比，JVM 的 FFI 非常慢。我听说简单地从 Java 调用外部 C 函数可能需要 1,000 个周期。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-24T08:03:20.687

有些东西最好用 Java、C# 或任何托管编程语言构建。使用非托管编程语言（如 C 或 C++）构建其他东西*总是会更好*

前一类通常包括“应用程序”，而第二类通常包括“平台”。

用 Java 构建 FireFox 或 WebKit 不仅愚蠢，而且会使最终产品变得非常非常缓慢、糟糕，并为最终用户浪费大量资源。就此而言，Open Office 可能是 Java、C# 或*SmallTalk的理想选择。*但是用 Java（或 C#）构建 FireFox 或 WebKit 是愚蠢的，而且是失败的保证......

对于许多事情，C++ 和 C 会快几个数量级，此外它会使用一小部分内存。就是那样子。只要 Java 和 C# 是“托管”编程语言，这将永远不会改变。也许有一天 CPU 如此之快以至于“没关系”。但我对此表示怀疑，因为随着更多 CPU 的分配，人们往往会调整他们的要求……

如果您想构建浏览器，很抱歉您需要自学 C 或 C++ ;)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-10-25T02:19:27.717

Java 应用程序具有 C++ 程序没有的初始化开销。当 JITed 时，它们不像 C++ 程序那样进行微优化。此外，运行时开销很小（GC + 间接调用开销）。总的来说，这些可量化的差异加起来并不多。但...

众所周知，当 Java 应用程序第一次启动时，它必须激活其磁通电容器才能将其环境带回 1995 年。这会在启动时引入一点延迟。但是一旦结束，JVM 的性能就与 1995 年在硬件上运行的可比 C++ 程序差不多。

# iphone - 活动连接名称 - Iphone

> ID：313451
> 
> 赞同：0
> 
> 时间：2008-11-24T04:59:08.560
> 
> 标签：iphone

我想在 iPhone 中获取 Internet 连接类型的名称？

任何帮助，将不胜感激。

问候

乌达拉卡

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-25T00:24:28.537

With the SCNetworkReachability API you can tell if you're in one of three states:

*   no network
*   cellular network (EDGE or 3G)
*   Wifi network

There's no way to distinguish what type of cellular network you're on (EDGE or 3G), only that you're on a cellular network.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T12:36:30.683

看一下[可达性](http://developer.apple.com/iphone/library/samplecode/Reachability/index.html)示例。认为它将使用最佳可用连接（WiFi、3G 或 Edge）。

# c# - C# 中的 RayTracer 项目

> ID：313461
> 
> 赞同：2
> 
> 时间：2008-11-24T05:04:27.647
> 
> 标签：c#, .net, graphics, raytracing

当我在大学时，我学习了光线追踪（图形合成）的课程，我们有机会用 C++ 编写了一个 3D 光线追踪器。这很有趣，除了我很久以前在“04”的硬盘驱动器崩溃中丢失了我的代码......许多文件丢失了......

是否有我可以在 C# 中使用的不是一行编写的 RayTracer？以正确的面向对象编写的东西，以便我可以扩展它？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T20:22:04.673

[CodeProject](http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=3589667)的用户 Andalmeida有一些关于 C# 光线跟踪的好文章，似乎符合要求。

# visual-studio - Visual Studio：向上/向下移动行和浏览最近更改的热键

> ID：313462
> 
> 赞同：40
> 
> 时间：2008-11-24T05:05:32.497
> 
> 标签：visual-studio, eclipse, hotkeys

我正在从 Eclipse 迁移到 Visual Studio .NET，并且找到了所有我心爱的热键，除了两个：

*   在 Eclipse 中，您可以按`ALT`-`←</kbd> and `ALT`-`→</kbd> to visit recent changes you have made, something I use frequently to go back to where I was in some other file and then return. Apparently in VS.NET the `CTRL`-`-` and `CTRL`-`SHIFT`-`-` do this but they don't seem to always work (e.g. on laptop, may be a numkey issue with the minus) and don't seem to follow the same algorithm of "where I was" as I am used to in Eclipse. Has anyone gotten this to work and rely on it daily, etc.?``
*   在 Eclipse 中，要向上或向下移动一行，你按下`ALT`-`uparrow`或`ALT`-`downarrow`你只需在代码中移动它，直到你把它拿到你想要的地方，非常好。此外，要复制一行，您可以按`SHIFT`- `ALT`-`uparrow`或`SHIFT`- `ALT`- `downarrow`。这两个热键甚至适用于您选择的行块。

有没有人在 Visual Studio .NET 中发现这些热键功能？

**附录：**

使用上述第二个功能的一个示例是将此处的底线向上移动到 for 循环中。在 Eclipse 中，您可以将光标放在 Console.WriteLine 上，然后按 ALT-（向上箭头），我一直使用它：一键上下移动线条。

```
for (int i = 0; i < 10; i++) {

}
Console.WriteLine(i); 
```

好的，用 no-selection-ctrl-c 推断 Charlie 的想法来选择一行，在 Visual Studio 中，您可以将光标放在 Console.WriteLine 上，（无选择）按`CTRL`-`X`然后向上移动并按`CTRL`- `V`。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-06-10T00:08:52.317

提出的答案是可行的，但在如何保存现有的粘贴缓冲区、当前选择的字符以及不允许用户对一系列行进行操作方面，没有一个比 eclipse 好。这是我想出的一个解决方案，它保留了粘贴缓冲区、当前字符选择，并在有或没有选择的情况下工作（可能跨越也可能不跨越多行）：

```
'' Duplicates the current line (or selection of lines) and places the copy
'' one line below or above the current cursor position (based upon the parameter)
Sub CopyLine(ByVal movingDown As Boolean)
    DTE.UndoContext.Open("CopyLine")
    Dim objSel As TextSelection = DTE.ActiveDocument.Selection

    ' store the original selection and cursor position
    Dim topPoint As TextPoint = objSel.TopPoint
    Dim bottomPoint As TextPoint = objSel.BottomPoint
    Dim lTopLine As Long = topPoint.Line
    Dim lTopColumn As Long = topPoint.LineCharOffset
    Dim lBottomLine As Long = bottomPoint.Line
    Dim lBottomColumn As Long = bottomPoint.LineCharOffset()

    ' copy each line from the top line to the bottom line
    Dim readLine As Long = lTopLine
    Dim endLine As Long = lBottomLine + 1
    Dim selectionPresent As Boolean = ((lTopLine <> lBottomLine) Or (lTopColumn <> lBottomColumn))
    If (selectionPresent And (lBottomColumn = 1)) Then
        ' A selection is present, but the cursor is in front of the first character
        ' on the bottom line. exclude that bottom line from the copy selection.
        endLine = lBottomLine
    End If

    ' figure out how many lines we are copying, so we can re-position
    ' our selection after the copy is done
    Dim verticalOffset As Integer = 0
    If (movingDown) Then
        verticalOffset = endLine - lTopLine
    End If

    ' copy each line, one at a time.
    ' The Insert command doesn't handle multiple lines well, and we need
    ' to use Insert to avoid autocompletions
    Dim insertLine As Long = endLine
    While (readLine < endLine)
        ' move to read postion, and read the current line
        objSel.MoveToLineAndOffset(readLine, 1)
        objSel.EndOfLine(True) 'extend to EOL
        Dim lineTxt As String = objSel.Text.Clone
        ' move to the destination position, and insert the copy
        objSel.MoveToLineAndOffset(insertLine, 1)
        objSel.Insert(lineTxt)
        objSel.NewLine()
        ' adjust the read & insertion points
        readLine = readLine + 1
        insertLine = insertLine + 1
    End While

    ' restore the cursor to original position and selection
    objSel.MoveToLineAndOffset(lBottomLine + verticalOffset, lBottomColumn)
    objSel.MoveToLineAndOffset(lTopLine + verticalOffset, lTopColumn, True)
    DTE.UndoContext.Close()
End Sub

'' Duplicates the current line (or selection of lines) and places the copy
'' one line below the current cursor position
Sub CopyLineDown()
    CopyLine(True)
End Sub

'' Duplicates the current line (or selection of lines) and places the copy
'' one line above the current cursor position
Sub CopyLineUp()
    CopyLine(False)
End Sub

'' Moves the selected lines up one line. If no line is
'' selected, the current line is moved.
''
Sub MoveLineUp()
    DTE.UndoContext.Open("MoveLineUp")
    Dim objSel As TextSelection = DTE.ActiveDocument.Selection
    ' store the original selection and cursor position
    Dim topPoint As TextPoint = objSel.TopPoint
    Dim bottomPoint As TextPoint = objSel.BottomPoint
    Dim lTopLine As Long = topPoint.Line
    Dim lTopColumn As Long = topPoint.LineCharOffset
    Dim lBottomLine As Long = bottomPoint.Line
    Dim lBottomColumn As Long = bottomPoint.LineCharOffset()

    Dim textLineAbove As TextSelection = DTE.ActiveDocument.Selection
    textLineAbove.MoveToLineAndOffset(lTopLine - 1, 1, False)
    textLineAbove.MoveToLineAndOffset(lTopLine, 1, True)
    Dim indentChange As Integer = CountIndentations(textLineAbove.Text) * -1

    ' If multiple lines are selected, but the bottom line doesn't
    ' have any characters selected, don't count it as selected
    Dim lEffectiveBottomLine = lBottomLine
    If ((lBottomColumn = 1) And (lBottomLine <> lTopLine)) Then
        lEffectiveBottomLine = lBottomLine - 1
    End If

    ' move to the line above the top line
    objSel.MoveToLineAndOffset(lTopLine - 1, 1)
    ' and move it down, until its below the bottom line:
    Do
        DTE.ExecuteCommand("Edit.LineTranspose")
    Loop Until (objSel.BottomPoint.Line >= lEffectiveBottomLine)
    ' Since the line we are on has moved up, our location in the file has changed:
    lTopLine = lTopLine - 1
    lBottomLine = lBottomLine - 1

    IndentBlockAndRestoreSelection(objSel, lBottomLine, lBottomColumn, lTopLine, lTopColumn, indentChange)

    DTE.UndoContext.Close()
End Sub

'' Moves the selected lines down one line. If no line is
'' selected, the current line is moved.
''
Sub MoveLineDown()
    DTE.UndoContext.Open("MoveLineDown")
    Dim objSel As TextSelection = DTE.ActiveDocument.Selection
    ' store the original selection and cursor position
    Dim topPoint As TextPoint = objSel.TopPoint
    Dim bottomPoint As TextPoint = objSel.BottomPoint
    Dim lTopLine As Long = topPoint.Line
    Dim lTopColumn As Long = topPoint.LineCharOffset
    Dim lBottomLine As Long = bottomPoint.Line
    Dim lBottomColumn As Long = bottomPoint.LineCharOffset()

    ' If multiple lines are selected, but the bottom line doesn't
    ' have any characters selected, don't count it as selected
    Dim lEffectiveBottomLine = lBottomLine
    If ((lBottomColumn = 1) And (lBottomLine <> lTopLine)) Then
        lEffectiveBottomLine = lBottomLine - 1
    End If

    Dim textLineBelow As TextSelection = DTE.ActiveDocument.Selection
    textLineBelow.MoveToLineAndOffset(lEffectiveBottomLine + 1, 1, False)
    textLineBelow.MoveToLineAndOffset(lEffectiveBottomLine + 2, 1, True)
    Dim indentChange As Integer = CountIndentations(textLineBelow.Text)

    ' move to the bottom line
    objSel.MoveToLineAndOffset(lEffectiveBottomLine, 1)
    ' and move it down, which effectively moves the line below it up
    ' then move the cursor up, always staying one line above the line
    ' that is moving up, and keep moving it up until its above the top line:
    Dim lineCount As Long = lEffectiveBottomLine - lTopLine
    Do
        DTE.ExecuteCommand("Edit.LineTranspose")
        objSel.LineUp(False, 2)
        lineCount = lineCount - 1
    Loop Until (lineCount < 0)
    ' Since the line we are on has moved down, our location in the file has changed:
    lTopLine = lTopLine + 1
    lBottomLine = lBottomLine + 1

    IndentBlockAndRestoreSelection(objSel, lBottomLine, lBottomColumn, lTopLine, lTopColumn, indentChange)

    DTE.UndoContext.Close()
End Sub

'' This method takes care of indenting the selected text by the indentChange parameter
'' It then restores the selection to the lTopLine:lTopColumn - lBottomLine:lBottomColumn parameter.
'' It will adjust these values according to the indentChange performed
Sub IndentBlockAndRestoreSelection(ByVal objSel As TextSelection, ByVal lBottomLine As Long, ByVal lBottomColumn As Long, ByVal lTopLine As Long, ByVal lTopColumn As Long, ByVal indentChange As Integer)
    ' restore the cursor to original position and selection
    objSel.MoveToLineAndOffset(lBottomLine, lBottomColumn)
    objSel.MoveToLineAndOffset(lTopLine, lTopColumn, True)
    If (indentChange = 0) Then
        ' If we don't change the indent, we are done
        Return
    End If

    If (lBottomLine = lTopLine) Then
        If (indentChange > 0) Then
            objSel.StartOfLine()
        Else
            objSel.StartOfLine()
            objSel.WordRight()
        End If
    End If
    objSel.Indent(indentChange)

    ' Since the selected text has changed column, adjust the columns accordingly:
    ' restore the cursor to original position and selection
    Dim lNewBottomColumn As Long = (lBottomColumn + indentChange)
    Dim lNewTopColumn As Long = (lTopColumn + indentChange)
    ' ensure that we we still on the page.
    ' The "or" clause makes it so if we were at the left edge of the line, we remain on the left edge.
    If ((lNewBottomColumn < 2) Or (lBottomColumn = 1)) Then
        ' Single line selections, or a bottomColumn that is already at 1 may still have a new BottomColumn of 1
        If ((lTopLine = lBottomLine) Or (lBottomColumn = 1)) Then
            lNewBottomColumn = 1
        Else
            ' If we have multiple lines selected, don't allow the bottom edge to touch the left column,
            ' or the next move will ignore that bottom line.
            lNewBottomColumn = 2
        End If
    End If
    If ((lNewTopColumn < 2) Or (lTopColumn = 1)) Then
        lNewTopColumn = 1
    End If

    ' restore the selection to the modified selection
    objSel.MoveToLineAndOffset(lBottomLine, lNewBottomColumn)
    objSel.MoveToLineAndOffset(lTopLine, lNewTopColumn, True)
End Sub

'' This method counts the indentation changes within the text provided as the paramter
Function CountIndentations(ByVal text As String) As Integer
    Dim indent As Integer = 0
    While (Text.Length > 0)
        If (Text.StartsWith("//")) Then
            Dim endOfLine As Integer = Text.IndexOf("\n", 2)
            If (Equals(endOfLine, -1)) Then
                ' The remaining text is all on one line, so the '//' terminates our search
                ' Ignore the rest of the text
                Exit While
            End If
            ' continue looking after the end of line
            Text = Text.Substring(endOfLine + 1)
        End If

        If (Text.StartsWith("/*")) Then
            Dim endComment As Integer = Text.IndexOf("*/", 2)
            If (Equals(endComment, -1)) Then
                ' This comment continues beyond the length of this line.
                ' Ignore the rest of the text
                Exit While
            End If
            ' continue looking after the end of this comment block
            Text = Text.Substring(endComment + 1)
        End If

        If (Text.StartsWith("{")) Then
            indent = indent + 1
        Else
            If (Text.StartsWith("}")) Then
                indent = indent - 1
            End If
        End If
        Text = Text.Substring(1)
    End While
    Return indent
End Function 
```

我编辑了这篇文章以在 MoveLineUp() 和 MoveLineDown() 方法的开头添加 UndoContext 机制（由 Nicolas Dorier 建议）并在其末尾关闭它。2011 年 11 月 23 日 - 我再次更新了此内容，以允许移动的行在您越过括号边界时缩进

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2010-07-13T19:14:02.030

对于希望在 Visual Studio 2010 中执行此操作的任何人，免费的 Visual Studio 2010 Pro Power Tools 扩展增加了上下移动线条的功能。

[http://visualstudiogallery.msdn.microsoft.com/en-us/d0d33361-18e2-46c0-8ff2-4adea1e34fef](http://visualstudiogallery.msdn.microsoft.com/en-us/d0d33361-18e2-46c0-8ff2-4adea1e34fef)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-24T05:16:35.453

如果您还没有找到它，设置这些键盘快捷键的位置在工具 | 下。选项 | 环境 | 键盘。只需浏览列表就可以找到许多方便的命令，但不幸的是，我从未找到任何好的参考来描述每个命令的用途。

至于具体命令：

*   我相信您所指的前进/后退导航命令是 View.NavigateBackward 和 View.NavigateForward。如果您的键盘与 VS 键绑定不合作，您可以将它们重新映射到您首选的 Eclipse 键。不幸的是，我不知道有什么方法可以改变它用来实际决定去哪里的算法。

*   我认为没有用于复制行的内置命令，但是在未选择文本的情况下按 Ctrl+C 会将当前行复制到剪贴板上。鉴于此，这是一个简单的宏，它将当前行复制到下一行：

```
 Sub CopyLineBelow()
        DTE.ActiveDocument.Selection.Collapse()
        DTE.ActiveDocument.Selection.Copy()
        DTE.ActiveDocument.Selection.Paste()
    End Sub

    Sub CopyLineAbove()
        DTE.ActiveDocument.Selection.Collapse()
        DTE.ActiveDocument.Selection.Copy()
        DTE.ActiveDocument.Selection.LineUp()
        DTE.ActiveDocument.Selection.Paste()
    End Sub 
```

*   为了移动一行文本，Edit.LineTranspose 将向下移动选定的行。我不认为有移动一行的命令，但这里有一个快速宏可以做到这一点：

```
 Sub MoveLineUp()
        DTE.ActiveDocument.Selection.Collapse()
        DTE.ActiveDocument.Selection.Cut()
        DTE.ActiveDocument.Selection.LineUp()
        DTE.ActiveDocument.Selection.Paste()
        DTE.ActiveDocument.Selection.LineUp()
    End Sub 
```

如果您还没有开始使用宏，它们真的很有用。工具 | 宏 | 宏 IDE 将带您进入编辑器，一旦定义它们，您就可以通过我上面提到的相同 UI 设置键盘快捷键。我使用非常方便的 Record Temporary Macro 命令生成了这些宏，也在工具 | 下。宏。此命令可让您记录一组键盘输入并多次重播，这对于构建高级编辑命令以及自动执行重复性任务（例如代码重新格式化）非常有用。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-24T12:51:42.867

我最近做了同样的事情，当我转移到一个新项目时，我从 Eclipse 转移到了 Visual Studio。 **强烈推荐****[Resharper 插件](http://www.jetbrains.com/resharper/)**- 它添加了 Eclipse 对 VS 的一些丰富的编辑、导航和重构功能**。**

Resharper 还允许您使用与 InteliJ 非常相似的键盘映射方案。对于 Java 逃逸者来说非常方便......

关于您的第二个问题，Resharper 具有与 eclipse 相同的向上/向下移动代码功能，*但有一些警告*。首先，使用 InteliJ 键盘映射，按键组合相当曲折。

> 上移代码：**ctrl + shift + alt + 上光标**
> 
> 下移代码：**ctrl + shift + alt + 下光标**

其次，它并不总是只移动一行，而是实际跳转代码块。因此它不能将一条线从 if 语句的外部移动到它的内部——它会将选定的行直接跳过 if 块。为此，您需要使用“左”和“右”移动

> 将代码移动到外部代码块：**ctrl + shift + alt + 左光标**
> 
> 将代码移动到下一个内部代码块：**ctrl + shift + alt + 右光标**

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-24T05:33:22.067

在 Visual Studio 中录制一个宏来做 alt-arrow 的事情：

```
ctrl-alt-r -- record mode
ctrl-c -- copy a line
up arrow -- go up a line
home -- beginning of line (maybe there is a way to paste before the current line without this)
ctrl-v -- paste
ctrl-alt-r -- end record mode 
```

现在，您可以使用宏 ide 和键盘首选项将此宏映射到您喜欢的任何击键集。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-11T14:00:33.957

Edit.LineTranspose 但这对向上移动一行不起作用...这是向上移动的宏

```
Sub LineTransposeUp()
    Dim offset As Integer
    Dim sel As TextSelection

    DTE.UndoContext.Open("LineTransposeUp")

    Try
        sel = DTE.ActiveDocument.Selection
        offset = sel.ActivePoint.LineCharOffset
        sel.LineUp()
        DTE.ExecuteCommand("Edit.LineTranspose")
        sel.LineUp()
        sel.MoveToLineAndOffset(sel.ActivePoint.Line, offset)
    Catch ex As System.Exception
    End Try

    DTE.UndoContext.Close()
End Sub 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-03T12:32:22.520

使用[MoveLine 扩展](http://visualstudiogallery.msdn.microsoft.com/b3ee08dc-a28f-4aec-9efa-69215ab5ee52)在 VS 2010/2012 中向上或向下移动一条线（或一组线）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-24T05:14:56.703

我不知道 VS 是否支持您在本机谈论的功能，但我知道 resharper 插件允许您使用 CTRL + SHIFT + BACKSPACE 转到以前的编辑。我认为它不支持上下移动一条线（我还没有找到）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-05-07T06:21:28.593

Paul Ostrowski 我试过你的工具。它几乎可以正常工作。

eclipse 所做的另一件事是将行移动到当前缩进级别。

例如：

```
function test()
{
    // do stuff
}
Console.WriteLine("test"); 
```

在 console.writeline 上进行换档会将其更改为

```
function test()
{
    // do stuff
    Console.WriteLine("test"); 
} 
```

但是您的工具似乎可以这样做：

```
function test()
{
    // do stuff
Console.WriteLine("test"); 
} 
```

# vim - 用文档存储 vim 设置

> ID：313463
> 
> 赞同：54
> 
> 时间：2008-11-24T05:07:04.677
> 
> 标签：vim, settings

有没有办法用文档保存 vim 设置的状态？

澄清一下：我正在编辑一个文档并更改了一堆设置。我不一定记得是哪个；我不想再次使用这些设置，除了当前文档。我不想手动尝试记住我所做的更改；或者我更改的设置的神奇缩写是什么。我只想拥有，比如说，对于“mydoc.txt”，一个“mydoc.vim”文件，它可以让我回到我离开的地方，并且设置文件将根据 vim 设置自动保存，比如，或者可能是ctrl-key 在我退出之前执行它。如果 vim 可以自动查找这样的文件，那将很方便。

并且最好不必将设置编辑到文档本身和从文档中移出。

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2008-11-24T05:10:43.577

是的，vim 设置可以包含在文档中。

它们大多出现在评论中，因此它们不会弄乱原始文件。选项卡特定设置的示例是：

```
/* ex: set tabstop=8 expandtab: */ 
```

请注意，此命令在大多数情况下都有效，但是`modeline`出于安全原因，通常在未打开服务器的情况下设置服务器。要打开该功能，请在 $HOME/.vimrc 或系统 $VIM/vimrc 中添加以下内容：

```
set modeline 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-11-24T08:58:55.880

你可以使用 Vim 的 Session 支持：

```
:mksession 
```

您可以稍后通过运行`vim -S Session.vim`或使用来加载它`source Session.vim`

还有 vim 插件可以自动加载/保存会话

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-24T05:12:39.843

您可以通过编辑[.vimrc](http://vim.wikia.com/wiki/Open_vimrc_file)文件来全局保存您的设置。

Vim 还允许您使用模式线保存每个文件的[设置](http://vim.wikia.com/wiki/Modeline_magic)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-24T06:37:19.893

以下是将所有当前设置保存到文件的方法：

```
:redir > textfile.txt 
:set all 
:redir END 
```

如果您愿意，只需将该文件重命名`~/.vimrc`即可。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-24T09:51:10.093

您可以将文件保存为特定类型，例如特殊文件名格式或扩展名，然后在 .vimrc 中为该文件类型定义一个自动命令。

我为我的 makefile 执行此操作，以确保我拥有特定文件所需的各种设置。

例如，这是我的自动命令 dec。

```
if has("autocmd")
  autocmd BufRead,BufNewFile Makefile*  :set noexpandtab
  autocmd BufRead,BufNewFile mirror.conf    :set noexpandtab
  autocmd BufRead,BufNewFile *.html*    :set shiftwidth=2
  autocmd BufRead,BufNewFile diff_files :set autowrite
  autocmd BufRead,BufNewFile lbnamed*   :set ft=perl
  autocmd BufRead,BufNewFile *.t        :set ft=perl
endif 
```

# jquery - 在 asp.net mvc 应用程序中无法立即圆角的 jquery 出现圆角问题

> ID：313467
> 
> 赞同：0
> 
> 时间：2008-11-24T05:10:48.383
> 
> 标签：jquery, asp.net-mvc

我正在为 jquery 使用圆角插件，并让它在我的页面中使用舍入元素。我遇到的唯一问题是元素出现在页面上未舍入然后舍入。我需要做什么才能使元素仅显示为圆形？

我最初将脚本标签放在 head 元素中，但它们是否应该放在母版页中的其他位置以提高性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T05:23:23.553

这是因为默认情况下元素不被舍入；它是围绕它们的javascript。听起来您的 js 需要一段时间才能加载，这就是您看到 flash 的原因。

要修复它，你将不得不让你的 .js 加载得更快。通常这意味着减少页面大小。此外，虽然不推荐，但您可以将 Javascript 移动到页面顶部，以便提前加载，看看是否有任何效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T06:07:47.923

还有使用 jQuery 创建圆角框的不同方法。你用什么插件？我的建议是[http://jrc.meerbox.nl/?page_id=4 （](http://jrc.meerbox.nl/?page_id=4)[这里](http://jrc.meerbox.nl/demo/)是演示）

# html - 为什么使用表格进行网站布局如此邪恶

> ID：313468
> 
> 赞同：18
> 
> 时间：2008-11-24T05:11:50.127
> 
> 标签：html, layout, html-table

我是一名 Winforms 和业务引擎开发人员，两年多来第一次使用 asp.net，在那段时间里我注意到了一些约定的变化。

反“布局表格”运动背后的逻辑是什么？

是否允许使用 css 类来处理布局，如果是这样，这是否真的是页面上的一个问题，你相当肯定会保持静态，或者它只是被认为是“丑陋的”？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-11-24T05:47:22.973

补充几点：

*   不要对此狂热。CSS 并不完美，有些事情可以通过表格更轻松地完成。因此，如果需要，请在其中放一张小桌子。它不会杀了你。

*   基于表格的布局的主要“邪恶”是那种深度嵌套的混乱，它曾经是精确控制页面的唯一方法。您将在表格中的表格中放置表格，并策略性地放置透明图像以控制间距。我认为这在当今非常罕见，而 CSS 会让你清理 90% 的混乱。

*   “语义网”是一个很好的目标，其中的标签是为了给页面赋予意义，而不是描述布局。然而，当前版本的 HTML 并没有走得太远。因此，您的页面中总是会有大量标签用于布局，没有其他意义。这并不意味着您不应该尝试尽可能地分离内容和布局；这只是意味着你不会 100% 到达那里。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-11-24T05:16:57.263

它使可访问性变得困难。想象一下，您是一个文本浏览器，您想向盲人大声朗读网站的内容。大多数基于表格的布局往往很难抓取和“理解”机器。

在这些关于表格与 CSS 的讨论中存在很多精英主义/政治/狂热主义，但在很大程度上，CSS 布局比基于表格的布局更干净。

从理论上讲，它们也更容易维护。比如说，你想把导航从左边移到右边吗？当然，只需更改一个 CSS 文件就可以了。但是话又说回来，这通常在更复杂的网站上表现平平，在这些网站上，CSS 通常是深度嵌套的，并且非常复杂以至于更改不容易，而模板系统使基于表格的布局并非完全不可维护。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-11-24T07:38:32.623

值得一提的是，在显示表格数据时仍然可以合法使用 <table> 标签。我使用的经验法则是，如果我要显示的东西可以很容易地存在于电子表格中，那么表格标签就是要走的路。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-24T05:15:10.370

有很多原因。一个原因是可访问性......布局表不会向内容添加语义，因此屏幕阅读器会遇到麻烦。因此，仅将表格用于表格数据。

[这里](http://davespicks.com/essays/notables.html)有几点可以更详细地回答这个问题

*   [表很慢](http://davespicks.com/essays/notables.html#slow)
*   [表格可能不灵活](http://davespicks.com/essays/notables.html#inflexible)
*   [使用 CSS 更容易解决可访问性问题](http://davespicks.com/essays/notables.html#accessibility)
*   [桌子不会降级](http://davespicks.com/essays/notables.html#dontdegrade)
*   [表格也不打印](http://davespicks.com/essays/notables.html#printing)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-24T05:29:29.360

有一篇关于 sitepoint 的[非常好的文章](http://www.sitepoint.com/article/tables-vs-css/)，它将在表格中设计页面与 css 并肩作战。这是一本非常有趣的读物，并突出了设计人员/开发人员在使用表格时的一些主要陷阱，例如带有表格的源代码错位，通常需要额外的源代码，并且未来的更改不可避免地会变得复杂。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-24T09:57:26.807

对基于表格的布局的主要批评之一是它们是*死板*的。它们用于在所有浏览器中创建像素完美的页面。这样做的代价是僵化，这会损害可访问性。800x600 像素屏幕的布局设计可能会导致拥有宽屏高清显示器的人不得不真正眯着眼睛阅读所有内容。当访问者在浏览器中强制增加字体大小时，它会破坏布局，有时会非常糟糕。

CSS 驱动的布局很*灵活*，可用于创建在任何屏幕/字体大小下看起来都不错（并且相似，但不一样）的布局。改进的内部结构还有助于屏幕阅读器和其他可访问性工具，以及移动平台/设备。

表格标签没有被弃用，并且仍然在 CSS 驱动的布局中发挥作用：它应该在显示表格数据时使用（如在电子表格中）。为此，它是完美的——但它不应再用于页面布局。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-24T06:45:01.360

我强烈推荐阅读[Designing with Web Standards](http://www.zeldman.com/dwws/)一书。它适合设计师、开发人员和具有更多业务导向角色的人员。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-24T06:55:09.887

这个想法是标记页面的*内容*/*含义*是一件更好的事情，不仅因为它使它易于修改和样式化，而且（可能更重要的是）因为它提高了可访问性，对于那些使用屏幕阅读器等的人来说（和搜索引擎！）。有时阅读[深入了解可访问性。](http://diveintoaccessibility.org/)[如果你有表格数据，你当然应该使用表格。]

虽然“尽量使用 CSS，而不是表格来布局”是一个非常重要的规则，你应该尽可能地遵循，但最终，“做正确的事”是有一定成本的，当它变得太高时，你应该重新考虑你的优先事项。看[http://giveupandusetables.com/](http://giveupandusetables.com/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-24T07:59:34.220

这可能不是正确的主题，但我对 CSS 布局最常见的问题是它们可能难以设置，因此它们总是拉伸父节点而不是溢出它。当您遇到 IE 做一些与 FF 完全不同的事情时，这会变得更加痛苦。使用表格修复这种混乱通常比您被迫使用的各种 JS 变通方法更容易且更合规。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-24T23:10:13.757

老实说，反餐桌的人群常常因为只是标准的纳粹分子而感到内疚。事实是，自从“引导”涉及使用实际引导以来，人类一直在使用表格进行布局。

反对表格的主要论据是可访问性。这是一个重要的话题。然而，对于真正的罪魁祸首，CSS 只是一个创可贴的解决方案：HTML 是一种可怕的标记语言！

如果 HTML 不应该用于布局，那么为什么我们有 <center>、<b>、<u> 或 <i>？为什么我们没有一个 <story> 标签来对段落进行语义分组？为什么我们有 6 个标题标签？

我们需要停止假装 HTML 是严格语义的，而显然它不是。虽然 CSS 擅长实现表示，但定义它并不是那么好。如果是这样，我们就不需要 div soup 来进行 3 列布局。HTML5 真正应该发生的事情（当然不是）是让布局标签具有明确的角色，并使用 CSS 来阐明这些标签的作用。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-24T06:12:32.283

老实说，不要太担心使用表格。如果文档流更容易，即使是一些最好的、语义上最正确的人也建议使用表格。只需使用有用的东西 - 使用表格的缺点并不是那么好。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-24T07:07:48.457

随着 IE8 支持更新的 CSS 显示属性，关于表格与 CSS 的争论可能很快就会结束。由于以网格/表格格式考虑布局更容易和明智，因此*表格、表格行、表格单元格、表格标题、表格列、表格行组*等的可用性，因为 CSS 属性将轻松布局实现显着。

这篇[文章](http://www.digital-web.com/articles/everything_you_know_about_CSS_Is_wrong)有一个详细的概述。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-24T07:48:17.533

*   加载速度较慢
*   语义不正确

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-24T08:41:19.643

已经提到了大多数优点（更快，没有 spacer.gif，可访问性，内容与标记等），但令我惊讶的是，没有人提到 css[可以](http://meyerweb.com/eric/css/edge/complexspiral/glassy.html)做表格不能或至少更容易的事情。

此外，这只是为正确的工作使用正确的工具。表格用于表格数据，css 用于设置内容样式。人们往往会忘记的是，您还可以为[您的桌子设计样式](http://icant.co.uk/csstablegallery/index.php?css=62)......

问题是缺乏浏览器支持。因此，人们使用黑客。因此，浏览器以不同的方式解释 css 以适应这些 hack。这是一个永无止境的循环。

# misv - 程序员的兼职业务

> ID：313477
> 
> 赞同：4
> 
> 时间：2008-11-24T05:17:23.127
> 
> 标签：misv

除了我的全职编程工作之外，我还想开一家小型兼职企业。你们以前做过吗？我认识一些下班后在夜校教书的程序员。但话又说回来，这不是生意。你会推荐什么来获得另一个收入来源？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T05:36:38.207

我有一份全职的编程工作，今年我刚刚创办了一家小型软件企业。

我的建议是从小处着手，确保在完成日常工作后有时间和精力去做某事。如果可能，请选择您编写的代码与您在工作中编写的代码不同的业务。不同的语言是一个好的开始，但不同类型的问题将是一个更好的目标。如果你最终一天工作 12 小时（工作 8 小时，副业 4 小时），你会在不到两周的时间内完全发疯。

至于开始什么类型的业务，请考虑以下几点：

1.  你喜欢从事什么样的项目？
2.  你有什么技能，或者你能学到什么来完成这件事？
3.  你有多少空闲时间？
4.  你的时间值多少钱？

一旦你弄清楚了这一点，你就会知道哪些项目对你有意义。

我能想到的唯一其他建议就是专业化。如果你是一个人的操作，你就无法与微软竞争。选择一个市场，您可以在其中为一小部分人提供真正好的东西。这些小利基市场是小型软件公司蓬勃发展的最佳场所。

祝好运并玩得开心点！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T05:31:06.377

当您说“小型企业”时，我假设您的意思是咨询。与您在现实生活中认识的人建立联系。沟通技巧为王。准确了解您的客户的需求并及时交付。永远不要承诺你无法兑现的东西，它会对你产生不良影响。概述项目的所有要求，并开始与您的客户在一张纸上绘制模型/规范。概述他们的预算，看看他们的要求对于他们的预算是否可行。如果您正在为中型企业开发软件，请与将作为最终用户使用您的产品的员工交谈。如果他们目前有解决方案，请询问他们在功能和可用性方面不喜欢它的哪些方面。看看如何改进。

尽可能地提供真正的帮助和知识。如果该项目超出了您的范围，请将他们带到可以提供帮助的人那里。你可能不会得到那份工作，但他们可能会告诉他们的三四个朋友你可能会在一两年后回来。

我发现一个相对未开发的市场是寻找最近外包的人。不做任何概括，但“外包热潮”产生了一堆低于标准的软件，留下大量代码需要挽救。我找到了一些生意，找到了软件半成品的人，并将他们的代码重新编写成可行的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T05:30:14.473

我建议制定某种商业计划。不要只是开始编写一些应用程序或创建一些网站并认为它会销售。对您的产品的实际市场进行一些研究。

另外，之前做过，我建议在业务中至少有 1 个其他合作伙伴。自己快速完成这一切变得浪费精力。你可以做到，但如果你有人在想法、编程、会计、网页设计等方面提供帮助，那肯定会容易得多。

此外，请认真考虑您是否真的想要在当前工作之外的另一份工作。我不知道您在日常工作之外的生活是什么样的，但是从事另一份工作（尤其是需要每天关注的工作，例如必须不断更新的网站）可能会真正消耗您的生活。

如果您确实提出了商业计划并开始创业，那就让它成为您非常喜欢的事情！如果你这样做了，那将是非常有益的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T06:54:45.583

我不知道你为什么拒绝“失控”的教学。在行业工作了 10 年后，我开始在一所社区学院教授“成人教育”夜校。我发现这是一个很好的收入来源，与我的日常工作（IT 咨询）没有冲突。这也是在我选择的语言（最初是 C）中保持“新鲜”的绝佳方式。

教学让您保持警觉，让您在非常有趣的氛围中结识很多有趣的人（老师和学生）。

此外，当你准备好在未来寻求另一份职业时，教学是一个很好的选择。教学也明显不受经济动荡的影响，因为经济低迷往往会让人们接受培训作为前进的方向。

另外-您正在回馈一些东西。

干杯，

-理查德

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T05:32:16.450

作为一名开发人员，我在一个开源项目 (DotNetNuke) 上做了一些工作，并通过它建立了一些良好的联系，并成为一名顾问，为各种客户做 DNN 工作。

您显然必须进行投资以了解您正在从事的 OSS 项目是什么，但另一方面，您很有可能为自己开辟一个相当不错的利基市场。

# javascript - 如何最好地使链接提交表单

> ID：313478
> 
> 赞同：36
> 
> 时间：2008-11-24T05:18:27.057
> 
> 标签：javascript, html, forms

获得常规锚点（`<a href="...">`）以提交单击时嵌入的表单的最佳方法是什么？

```
<form>
    <ul>
        <li>
            <p>
                The link could be <span>embedded <a href="" onclick="?">at any level</a></span>
                in the form, so "this.parentNode.parentNode..." is no good. :(
            </p>
        </li>
    </ul>
</form> 
```

我知道使用 jQuery 的最简单方法是

```
$('#myLink').click(function() {
    $(this).parents('form:first').submit();
}); 
```

...但我试图找到一种不使用库的方法来做到这一点。

* * *

**编辑**：我真的想找到一种不需要表单知识的方法（例如：它的名称、id 等）。这类似于您如何将其放在输入元素上：`<input onclick="this.form.submit()" />`

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-24T05:22:08.047

你为什么不使用`<input>`or`<button>`元素而只用 CSS 调整它呢？然后它可以在没有 Javascript 的情况下工作，因此更可靠。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-11-24T05:25:10.787

最简单的方法是使用这样的东西：

```
 <a href="#" onclick="document.formName.submit();"> 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-12-10T07:27:15.097

我现在每次都用这个。因为我项目中的提交按钮通常是一个链接（通过包装图像或 CSS），所以我使用这个：

```
<a href="#" onclick="$(this).closest('form').submit(); return false;">Submit</a> 
```

不要忘记它也在使用 jQuery。

您可以包装自己的功能。所以它总是在那个链接上提交父元素（表单）。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2010-06-02T23:20:48.610

只要链接是表单的直接子级，您就可以使用它。您不需要知道表单的名称。至少适用于 Firefox 和 Chrome。

```
<form action="">
    <a href="" onclick="parentNode.submit();return false;">Submit</a>
</form> 
```

quirksmode.org 告诉我 x.parentNode 适用于所有浏览器，所以这*应该*适用于任何地方。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-11-24T07:54:54.777

遍历父节点，直到找到一个带有标记名的元素，表明它是一个表单！

```
<form>
    <ul>
        <li>
            <p>
                The link could be <span>embedded <a href="" onclick="get_form(this).submit(); return false">at any level</a></span>
                in the form, so "this.parentNode.parentNode..." is no good. :(
            </p>
        </li>
    </ul>
</form>

<script type="text/javascript">
    //<![CDATA[
    function get_form( element )
    {
        while( element )
        {
            element = element.parentNode
            if( element.tagName.toLowerCase() == "form" )
            {
                //alert( element ) //debug/test
                return element
            }
        }
        return 0; //error: no form found in ancestors
    }
    //]]>
</script> 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-06-13T19:45:53.103

使用如下标记将提交按钮转换为链接：

```
<input id="submitlink" type="submit" value="Text" /> 
```

像这样的CSS：

```
input#submitlink {
    background: transparent;
    border: 0;
    cursor:pointer;
    margin: 0;
    padding: 0;
    color: #034af3;
    text-decoration: underline;
}

input#submitlink:visited {
    color: #505abc;
}

input#submitlink:hover {
    color: #1d60ff;
    text-decoration: none;
}

input#submitlink:active {
    color: #12eb87;
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-24T07:45:56.183

最好的方法是

```
<a href="#" onclick="document.forms[0].submit();return false;">Submit Form</a> 
```

但是您可能不想这样做，因为它会使禁用 JS 的用户无法提交

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-24T09:16:32.443

与[hasen j](https://stackoverflow.com/users/35364/hasen-j)类似的[解决方案](https://stackoverflow.com/questions/313478/how-best-to-make-a-link-submit-a-form#313624)，但使用递归函数来遍历文档。

```
function findParentForm(element) {
    if (element.parentNode.tagName.toLowerCase() == 'html') {
        throw('No Parent Form Found');
    } else if (element.parentNode.tagName.toLowerCase() == 'form') {
        return element.parentNode;
    } else {
        return findParentForm(element.parentNode);
    }
} 
```

当然，形式...

```
<form>
    <ul>
        <li>
            <p>
                The link could be <span>embedded <a href="" onclick="findParentForm(this).submit(); return false;">at any level</a></span>
                in the form, so "this.parentNode.parentNode..." is no good. :(
            </p>
        </li>
    </ul>
</form> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-24T10:55:00.760

就个人而言，我更喜欢`javascript:`在 href 中使用协议而不是使用 onclick 事件......如果有任何问题，我很乐意得到纠正。

如果页面中只有一个表单，这是一种很常见的情况，您可以简单地执行以下操作：

```
<li><p><a href="javascript:document.forms[0].submit();">Click here to submit</a></p></li> 
```

否则，像上面那样冒泡元素是一种解决方案。

[编辑] 我保留答案，即使它被否决，作为参考（评论中给出的信息很有趣）。
协议技术的另一个缺点：它不生成事件对象。我给出的片段中没有问题，但在调用处理程序时很烦人。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-25T00:16:50.800

您应该使用按钮（以及输入或提交类型的按钮）来提交表单。

如果您需要链接具有但输入元素没有的任何附加功能（例如悬停），那么使用 javascript 实现这些功能比提交表单更容易。对于没有 javascript 的人来说，它也会更优雅地降级。

您甚至可以使用特定于 MSIE 的代码来解决这个问题（并将 :hover 用于其他浏览器）：

```
<input type="submit" value="send" class="linkstyles"
       onmouseenter="this.className+=' hovered';"
       onmouseleave="this.className=this.className.replace(/(^|\s)hovered(\s|$)/g, '');" /> 
```

如果您仍然真的很想倒退，那么我不会这样做：

```
function submitByLink ( elm ) {
  // Move up domtree until we hit no parentNode or find a form
  while (elm) {
    elm = elm.parentNode;
    if (elm && elm.tagName == 'FORM') {
      // First chance we get, we submit the form and exit.
      // The return on the node it kills the event bubble by forwarding false to browser
      elm.submit(); 
      return false;
    }
  }
  // If we got here then there is no form parent and user will be sent to link href
} 
```

HTML 看起来像这样：

```
<a href="aPageExplainingWhyYouNeedJavascript.html" onclick="return submitByLink(this);">Send</a> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-07-09T15:08:18.703

```
$(document).ready(function(){$('#submit').click(function(){$('#signup').submit();});}); 
```

使用 Jquery，我们检查文档是否已加载，然后等待单击 id 为“提交”的锚标记。然后，它会提交 id 为“signup”的表单。更改“提交”和“注册”以适应。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-06-15T13:56:40.523

继续上面的答案[How best to make a link submit a form](https://stackoverflow.com/questions/313478/how-best-to-make-a-link-submit-a-form/313480#313480)，我最近一直在做的方式是

```
<button class="submit" type="submit"><a href="#" onclick="return false;">Link Text</a></button> 
```

和 CSS

```
.submit {
    background: transparent;
    border:0;
    display: inline;
    margin: 0;
    padding: 0;
    cursor:pointer;
}
.submit a 
{
    color: #CEA249;
}
.submit:hover a
{
    color: white;
} 
```

我发布了这个，因为我找不到完成的 html / css 示例。如果有人有任何改进将更新。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-04-12T03:13:57.793

```
<form>
<input type="submit" id="submit" style="display:none;"/>
<a href="#" onclick="$('#submit').click();">Sample Submit Trick</a> 
</form> 
```

# php - 包括：用于单独文件中基本 HTML 和 Javascript 的 SSI 或 PHP

> ID：313483
> 
> 赞同：0
> 
> 时间：2008-11-24T05:23:10.573
> 
> 标签：php, javascript, file, include, ssi

我的 Xampp 服务器正在运行，现在也可以在子目录中运行我的 html（子目录名称中不能有空格）。

**SSI 包含或 PHP 包含：**

Xampp 说 SSI 已停用。尝试取消注释包含的行，但它不会更改停用。

如何激活 SSI？

那么，如何在我的 html 中实现 SSI 包含语句或 PHP 包含语句以调用包含 html、图像、javascript 和调用其他 javascript 菜单文件的命令的 html 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T05:36:12.217

我不知道 Xampp 是否有激活 SSI 的特殊方式，但[正常的 Apache 方式](http://httpd.apache.org/docs/2.2/howto/ssi.html#configuring)应该可以工作。

在 SSI 中包含文件的正常方法是

```
<!--#include virtual="/something/file.html" --> 
```

该文件的网址实际上是[http://www.example.com/something/file.html](http://www.example.com/something/file.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T06:11:19.193

If XAMPP says SSI are disabled by default, you need to edit your server configuration (**not your .HTACCESS file**) to change this. *Otherwise, you could try installing a plugin for your server to fix the issue.*

Hope this helps!

*~ Nate.*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-21T17:12:43.263

PHP 包含非常简单。只需将您的文件命名为 something.php 并执行以下操作：

```
<?php include('path/to/file.php'); ?> 
```

该文件将由 php 解析，因此它可以包含 PHP/HTML 标记的标准组合或您想要的任何其他文本。

# .net - 在未安装 MS Word 的情况下打印 OOXML 文档

> ID：313503
> 
> 赞同：5
> 
> 时间：2008-11-24T05:40:00.740
> 
> 标签：.net, docx, openxml

有什么方法可以在不安装 MS Word 的情况下打印 OOXML 文档（.docx 文件）？

它通过 MS Word 界面运行良好，但我需要找到一种方法在未安装 MS Word 的服务器上使用它。我一直在挖掘 API 并没有发现任何明显的东西，所以我倾向于相信没有办法。是这样吗？

**编辑：**德文的回答基本上就是我所理解的情况。我应该提到我正在使用 .NET 框架。所以我想知道是否有一个 .NET 库可以处理 docx 文件进行打印？我看到将作业添加到`DefaultPrinterQueue`（`LocalPrintServer`在`System.Printing`命名空间中）时，它可以处理 XPS 文档。所以也许这就是要走的路。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T05:44:48.673

我自己对答案很好奇，所以我用谷歌搜索了它。似乎在一些 Novel 和 IBM 产品中有支持。这是一个部分答案的链接，似乎说 OpenOffice 的支持正在开发中。[http://wiki.services.openoffice.org/wiki/Office_Open_XML](http://wiki.services.openoffice.org/wiki/Office_Open_XML)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T06:10:05.937

好吧，是的，不是的。是的，没有 MSWord 也是可能的，但您需要一个能够理解 ooxml 的应用程序或库。现在有许多其他产品确实支持（正如 Devin 所指出的那样），但如果您的要求表明您不能在服务器上拥有它们中的任何一个，那么......使用一个库并自己做。

然后它将取决于您正在开发的平台......例如，有一个用于 Java 的[OOXML4J](http://www.openxml4j.org/Documentation/Overview.html)库。[您可以在此处](http://openxmldeveloper.org/)找到适用于其他平台的其他库。

# asp-classic - ASP 最佳实践开销

> ID：313506
> 
> 赞同：0
> 
> 时间：2008-11-24T05:45:01.840
> 
> 标签：asp-classic

假设一个典型的、数据库和会话驱动的 ASP 应用程序是在 .NET 的第一个版本之前使用最佳实践开发的。分配经验丰富的专业人员正确有效地实施它所需的工作量为 1.0。

从那时到现在，您估计使用最佳非积极重构实践来维护它所需的工作量是多少？

这会是一个很好的投资（选项A）吗？还是使用当前的最佳实践完成新工作但不进行重构会更好（选项 B）？或者（选项 C）最好通过对旧架构进行新工作来保持架构一致？

鉴于你的选择，从现在开始你应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T13:09:30.880

我认为你没有给我们足够的信息来给出一个明智的答案。

*   这是产品还是内部系统？
*   历史是什么？
*   是否有当前项目或当前预算？
*   是否有任何政治、历史或当前？
*   系统背后的业务领域是否得到很好的理解和记录？
*   等等等等。

一般来说，在所有其他问题相同的情况下，我总是从选项 C 开始，以确保决策是由业务而非技术人员驱动的。

# ssl - 在 Websphere 应用服务器上禁用 SSL

> ID：313513
> 
> 赞同：2
> 
> 时间：2008-11-24T06:02:43.207
> 
> 标签：ssl, websphere

有没有办法在 WAS 上禁用 SSL？因此，您只需使用用户名和密码登录即可。这不是与禁用全球安全有关吗？

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T07:50:39.300

首先，应用程序的登录部分与您用于访问应用程序的协议无关，例如，您可以使用登录对话框（表单、http auth...等），使用“正常”http 或 http over SSL（如果应用程序不是仅在内部使用，则首选 SSL，即使是，我也会考虑使用 SSL）。

在 WebSphere 中，您将应用程序部署在[虚拟主机](http://publib.boulder.ibm.com/infocenter/wasinfo/v6r1/topic/com.ibm.websphere.nd.doc/info/ae/ae/ccws_vhost.html?resultof=%22%76%69%72%74%75%61%6c%22%20%22%68%6f%73%74%22%20)上。虚拟主机是主机名和端口（称为主机别名）的集合，您的应用程序应该可以从中访问。因此，为了获得您想要的行为，我将创建一个新的虚拟主机（描述适用于 6.1 中的 WebSphere 管理控制台应用程序）：

```
Environment > Virtual Host > New 
```

给它一个描述性的名称，例如 http_only。之后你做：

```
Environment > Virtual Host > http_only > Host Aliases > New 
```

在此处添加主机名或星号（'*'，不带引号）和端口号（在本例中为 http 的端口。接下来是更改应用程序绑定的虚拟主机：

```
Applications > Enterprise Applications > app_name > Virtual hosts 
```

您可以从下拉框中选择虚拟主机。之后保存，该应用程序应该只能通过 http 访问。

# algorithm - 缩短一系列动作的算法？

> ID：313515
> 
> 赞同：4
> 
> 时间：2008-11-24T06:02:53.723
> 
> 标签：algorithm

自从我在学校上算法课已经有一段时间了，如果我的术语不准确，请原谅我。

我有一系列动作，在运行时会产生一些所需的状态（基本上是一组重现错误的步骤，但就这个问题而言，这并不重要）。

我的目标是找到仍然产生所需状态的最短步骤系列。任何给定的步骤都可能是不必要的，所以我试图尽可能有效地删除这些步骤。

我想保留步骤的顺序（这样我可以删除步骤，但不能重新排列它们）。

我采取的天真的方法是采取整个系列并尝试删除每个动作。如果我可以成功移除一个动作（不改变最终状态），我会从系列的开头重新开始。在最坏的情况下，这应该是 O(n^2)。

我开始尝试提高效率的方法，但我很确定这是一个已解决的问题。不幸的是，我不确定谷歌到底是什么——这个系列并不是真正的“路径”，所以我不能使用路径缩短算法。任何帮助——即使只是给我一些搜索条件——都会有所帮助。

更新：有几个人指出，即使是我的幼稚算法也找不到最短的解决方案。这是一个很好的观点，所以让我稍微修改一下我的问题：关于同一问题的近似算法的任何想法？我宁愿有一个快速接近最短解决方案的简短解决方案，也不愿花很长时间来保证绝对最短的系列。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T06:30:27.863

您天真的 n^2 方法并不完全正确；在最坏的情况下，您可能必须查看所有子集（实际上，更准确的说法是这个问题可能是 NP 难的，这并不意味着“可能必须查看所有子集”，但无论如何.. .)

例如，假设您当前正在运行步骤 12345，并且您开始尝试单独删除每个步骤。然后你可能会发现你不能去掉 1，你可以去掉 2（所以你去掉它），然后你看 1345，发现它们每个都是必不可少的——一个都不能去掉。但实际上，如果你保留 2，那么“125”就足够了。

如果产生给定结果的集合家族不是单调的（即，如果它不具有如果某组动作有效，那么任何超集都有效的性质），那么您可以证明没有办法找到不查看所有子集的最短序列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T06:28:23.453

如果您对每个动作的效果完全不做任何假设，并且想要找到最小的子集，那么您将需要尝试所有可能的动作子集以找到最短的序列。

所述的二进制搜索方法仅在单个步骤导致您想要的状态时就足够了。

对于更一般的状态，即使一次删除一个动作也不一定会给你*最短*的序列。如果您考虑一些病态的例子，其中动作可能一起不会导致问题，但会单独触发您想要的状态，就会出现这种情况。

您的问题似乎可以简化为更一般的搜索问题，并且您可以创建的假设越多，您的搜索空间就会变得越小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T08:54:41.847

[Delta Debugging](http://en.wikipedia.org/wiki/Delta_Debugging)，一种用于最小化一组故障诱导输入的方法，可能是一个不错的选择。
我以前使用[Delta](http://delta.tigris.org/)（根据趣味性测试最小化“有趣”文件）将约 1000 行的文件减少到大约 10 行，以获取错误报告。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T06:07:33.307

想到的最明显的事情是受二分搜索启发的递归分割成两半，你交替地省略每一半。如果在递归的任何阶段遗漏一半仍然重现结束状态，则将其遗漏；否则，将其放回并在该一半的**两**半上递归，等等。

在两半上递归意味着它在放弃并尝试这些块中的较小块之前尝试消除大块。在最坏的情况下，运行时间将是 O(n log(n))，但如果你有一个很大的 n 并且很可能有许多不相关的步骤，它应该在 O(n) 尝试省略的方法之前获胜每一步一次（但不重新开始）。

该算法只会找到一些最小路径，但是，由于组合步骤间效应（如果步骤确实具有这种性质），它无法找到可能存在的较小路径。但是，找到所有这些将导致组合爆炸，除非您有更多关于推理步骤的信息（例如依赖关系）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T08:45:35.250

您的问题域可以映射到有向图，其中状态为节点，步骤为链接，您想在图中找到最短路径，为此存在许多众所周知的算法，例如[Dijkstra](http://en.wikipedia.org/wiki/Dijkstra's_algorithm/)或[A*](http://en.wikipedia.org/wiki/A*_search_algorithm)

更新：

让我们考虑一个简单的情况，您有一个步骤从状态 A 到状态 B，这可以绘制为由链接连接的 2 个节点。现在你有另一个步骤从 A 到 C 和从 C 你有一步到 B乙）。因此，您可以看到成本函数实际上非常简单，您为达到目标所采取的每一步都加 1。

# c# - 内部全球财产..难闻的气味？

> ID：313518
> 
> 赞同：1
> 
> 时间：2008-11-24T06:05:34.357
> 
> 标签：c#, design-patterns, com, word-wrap

我在处理一些代码时遇到了一些设计问题：

我的代码基本如下所示：

**主要的 COM 包装器：**

```
public class MapinfoWrapper 
{
    public MapinfoWrapper()
    {
        Publics.InternalMapinfo = new MapinfoWrapper();
    }

    public void Do(string cmd) 
    {
        //Call COM do command
    }

    public string Eval(string cmd)
    {
        //Return value from COM eval command
    }
} 
```

**公共静态类保存对包装器的内部引用**：

```
internal static class Publics
{
    private static MapinfoWrapper _internalwrapper;
    internal static MapinfoWrapper InternalMapinfo 
    { 
        get
        {
            return _internalwrapper;     
        }
        set
        {
            _internalwrapper = value;
        }
    }
} 
```

**使用内部包装实例的代码：**

```
 public class TableInfo
    {
        public string Name {
            get { return Publics.InternalMapinfo.Eval("String comman to get the name"); }
            set { Publics.InternalMapinfo.Do("String command to set the name"); }
        }
    } 
```

这对任何人来说都难闻吗？我应该使用内部属性来保存对主包装对象的引用，还是应该在这里使用不同的设计？

注意： MapinfoWrapper 对象将被外部世界使用，所以我真的不想让它成为单例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T07:49:01.730

您通过不将 MapInfoWrapper 注入类本身来降低 TableInfo 类的可测试性。是否使用这些 MapInfoWrapper 类的全局缓存取决于类 - 您需要确定是否有必要，但将包装器传递到 TableInfo 并在那里使用它而不是直接引用全局副本会改进您的设计在 TableInfo 方法中。结合接口的定义（即“重构接口”）执行此操作。

我还将在 Publics 的 getter(s) 中进行延迟实例化，以确保该对象在尚未创建时可用，而不是在 MapInfoWrapper 的构造函数中设置它。

```
public class TableInfo
{
     private IMapinfoWrapper wrapper;

     public TableInfo() : this(null) {}

     public TableInfo( IMapinfoWrapper wrapper )
     {
          // use from cache if not supplied, could create new here
          this.wrapper = wrapper ?? Publics.InternalMapInfo;
     }

     public string Name {
        get { return wrapper.Eval("String comman to get the name"); }
        set { wrapper.Do("String command to set the name"); }
     }
}

public interface IMapinfoWrapper
{
    void Do( string cmd );
    void Eval( string cmd );
}

public class MapinfoWrapper 
{
    public MapinfoWrapper()
    {
    }

    public void Do(string cmd) 
    {
        //Call COM do command
    }

    public string Eval(string cmd)
    {
        //Return value from COM eval command
    }
}

internal static class Publics
{
    private static MapinfoWrapper _internalwrapper;
    internal static MapinfoWrapper InternalMapinfo 
    { 
        get
        {
            if (_internalwrapper == null)
            {
                _internalwrapper = new MapinfoWrapper();
            }
            return _internalwrapper;     
        }
    }
} 
```

现在，当您测试 TableInfo 方法时，您可以通过向构造函数提供您自己的实现来轻松模拟 MapInfoWrapper。前（假设一个手模拟）：

```
[TestMethod]
[ExpectedException(typeof(ApplicationException))]
public void TestTableInfoName()
{
     IMapinfoWrapper mockWrapper = new MockMapinfoWrapper();
     mockWrapper.ThrowDoException(typeof(ApplicationException));

     TableInfo info = new TableInfo( mockWrapper );
     info.Do( "invalid command" );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T08:05:27.157

**我考虑将其添加到我的原始回复中，但这确实是一个不同的问题。**

如果您存储和使用缓存副本，您可能需要考虑 MapinfoWrapper 类是否需要是线程安全的。每当您使用单个全局副本时，您都需要考虑一次是否会被多个线程使用并构建它，以便任何关键部分（任何可能更改或必须假定不更改的数据）都是线程-安全的。如果必须支持多线程环境（例如在网站中），那么这可能会反对使用单个全局副本，除非创建类的成本非常高。当然，如果你的类依赖于其他也不是线程安全的类，那么你可能需要让你的类成为线程安全的。

# algorithm - 简单的算法教程？

> ID：313527
> 
> 赞同：27
> 
> 时间：2008-11-24T06:10:55.920
> 
> 标签：algorithm

我想使用一些非常基本的简单教程来学习算法。外面有吗？我听说过递归之类的东西，我想擅长它。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-24T06:17:51.197

我将首先看一下[EternallyConfuzzled](http://www.eternallyconfuzzled.com/jsw_home.aspx)，其中包含有关基本数据结构和算法的精彩教程，包括链表和二叉搜索树、排序和搜索算法。如果您想在此之后了解更多信息，我会按照复杂性、完整性和所需数学知识的顺序推荐以下书籍：

*   [C 中的算法](https://rads.stackoverflow.com/amzn/click/com/0201756080)（也可用于 C++ 和 Java）
*   [算法简介](https://rads.stackoverflow.com/amzn/click/com/0072970545)
*   [计算机编程的艺术](https://rads.stackoverflow.com/amzn/click/com/0201485419)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-24T06:15:26.410

如果你想学习算法，[这本书](http://highered.mcgraw-hill.com/sites/0070131511)是最好的选择。

[![替代文字](https://i.stack.imgur.com/JeXvg.jpg)](https://i.stack.imgur.com/JeXvg.jpg)
[（来源：[mcgraw-hill.com](http://highered.mcgraw-hill.com/sites/dl/free/0070131511/cover/cormen-lg_cover.jpg)）]

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-24T06:15:12.107

麻省理工学院的 OCW 有他们算法课程的[视频讲座](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-046JFall-2005/LectureNotes/)。这位教授是《算法导论》一书的作者之一，另一位海报提出了这本书。

它假设具有离散数学的基本知识。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-05-07T14:18:12.337

如果您对教程感兴趣，请避免阅读上面推荐的 CLRS 书籍。它采用严格的理论方法来研究算法，这与教程方法有很大不同。

**你通过做**它们来学习算法。因此，请找到提供算法问题和解决问题指导的资源。如果您想要一本教科书，请查看算法设计手册，其中也有一个在线[算法存储库](http://www.cs.sunysb.edu/~algorith/)。如果您更喜欢在线课程，[Udacity](https://www.udacity.com/course/cs215)提供基于 Python 的算法课程，而 Coursera 提供[通用](https://www.coursera.org/course/algo)和[基于 Java 的](https://www.coursera.org/course/algs4partI)课程。

由于重要的部分是练习算法，你可以跳过视频课程，只解决挑战。其他答案建议的网站有挑战，一旦你擅长算法，你就可以练习。一开始您会需要更多**指导**，因此请找到提供算法挑战并帮助解决这些挑战的资源。为此，我创建了[Learneroo](http://www.learneroo.com)。**[您可以从递归教程](http://www.learneroo.com/modules/71/nodes/398)**开始学习递归的基础知识。

![算法设计手册](https://i.stack.imgur.com/jM8BB.jpg) ![学习者截图](https://i.stack.imgur.com/AuBvY.png)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-12-17T15:03:30.527

TopCoder 有一些很好的[算法教程](http://www.topcoder.com/tc?module=Static&d1=tutorials&d2=alg_index)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-24T06:21:35.417

递归真的不是算法。由于您没有任何您感兴趣的具体内容，我建议您阅读[维基百科的算法列表，](http://en.wikipedia.org/wiki/List_of_algorithms "维基百科的算法列表")或者其他人建议您拿一本书。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-24T19:46:36.710

我将从[Stony Brook Algorithm Repository](http://www.cs.sunysb.edu/~algorith/)开始。该站点对不同类型的算法有一些非常好的解释，并且它引用了它使用的书籍和其他资源，因此您可以了解可用的内容。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-11-24T02:31:00.620

遍历 topcoder 问题的解决方案是学习算法的好方法。单靠阅读理论无济于事

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-25T06:02:58.697

对于那些评论这本书 xyz 并不简单的人，我要指出算法不是一个简单的话题。您至少需要大学入门级数学才能理解这些概念，以及在适当抽象的水平上推理计算的能力。如果你找到一本“傻瓜算法”一书，不要浪费你的钱！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-12-07T20:49:32.813

我的选择[http://aduni.org/courses/algorithms/](http://aduni.org/courses/algorithms/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-24T06:53:08.770

我建议你从排序算法开始。阅读相关的[维基百科页面](http://en.wikipedia.org/wiki/Sorting_algorithm)，跳过 O(n log n) 的内容，并专注于插入排序、合并排序和快速排序的实现。熟悉[二分查找](http://en.wikipedia.org/wiki/Binary_search)。此外，了解一些基本 的[数据结构](http://en.wikipedia.org/wiki/Data_structure)，例如向量、链表、堆栈、它们的实现以及它们的用途。（解决问题的算法通常与合适的数据结构一起使用。）一旦您对不同的算法和数据结构有信心，您就可以深入研究更完整的论文，例如[Cormen 等人的书。](https://rads.stackoverflow.com/amzn/click/com/0262032937)

至于递归，它本身并不是一种算法。相反，它是一些算法用来解决问题的一种技术，当后者可以自然地分解为子问题时。拆分问题，分别解决子问题，然后合并它们的解决方案以获得原始问题的解决方案的技术称为“divide et impera”或“分而治之”。（递归也是大多数编程语言的相关特性，它基本上意味着“调用自身的函数”。）

“递归算法”中被引用最多、最琐碎和最无用的示例是计算阶乘的示例。别介意。相反，阅读[河内塔](http://en.wikipedia.org/wiki/Tower_of_Hanoi)问题，它承认一个简单而优雅的递归解决方案，并再次研究一些排序算法，因为其中许多确实是递归的。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-03-18T08:08:48.363

可汗学院开设了一个关于算法的优秀交互式自学课程 - [https://www.khanacademy.org/computing/computer-science/algorithms](https://www.khanacademy.org/computing/computer-science/algorithms)。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-12-19T18:05:25.297

解决各种网站上的问题，如 SPOJ 等。并阅读有关算法简介的书籍，还有一些在线课程以及 coursera 。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-07-25T06:05:10.033

我最喜欢的算法问题列表之一是[Project Euler](http://projecteuler.net/)，它们非常多样化，您可以多次解决相同的问题以进行优化，并且您会发现很多社区（C++、C#、Python 等）发布他们的基准对于每一个问题

太有趣了，*极客的乐趣*

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-07-16T22:37:15.507

USA Computing Olympiad 有一个很好的算法[培训网站](http://train.usaco.org/)，到目前为止，任何人都可以注册，而且几乎是类似课程的格式。阅读一点，做一个练习，阅读更多，做一个练习等。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-24T06:15:45.803

递归是一种语言特性，而不是一种“算法”本身。所有递归都可以用适当的数据结构（如堆栈）替换。

我建议拿一本书。算法的问题在于它是一个相对进步的话题。在学习排序之前，您首先需要学习简单的搜索，并且在学习最小生成树等之前需要排序。一本书会正确排序这些，如果文本没有为您提供足够的信息，那么互联网是一个很好的下一个步。试试亚马逊，看看新人的评论。

不过，请确保在尝试执行此操作之前先学习一种实现语言，直到您了解该语言的工作原理之前，很难找出逻辑中的错误，而不是对给定命令序列发生的事情的误解。

# php - 禁用 php.ini 功能的解决方法---

> ID：313538
> 
> 赞同：1
> 
> 时间：2008-11-24T06:25:41.600
> 
> 标签：php, hosting, shared-hosting

我们正在使用共享主机，以下功能被禁用。

```
file_uploads = Off
allow_url_fopen = Off
allow_url_include = Off 
```

我们无法更改托管，需要找出一些解决方法。托管公司也无法/愿意启用这些功能。

例如：我们从另一个服务器调用 1 个服务器以获取内容。所以我们做了一个包含，但由于 URL 文件包含被禁用，我们不确定我们必须使用哪些选项来获取第二台服务器上的内容并使用某种缓存将其存储在那里。

我们完全（专用）控制内容服务器，因此我们可以做任何必要的事情，只是不确定是否有一些简单的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T06:31:21.557

由于您要检索远程内容，因此最简单的方法是编写功能以自己使用 curl ( [php.net/curl](http://php.net/curl) )之类的方式获取内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T06:51:47.883

你有没有尝试过这样的事情： [http ://www.humanumbrella.com/2007/12/08/how-to-download-a-remote-file-in-php-and-then-save-it/](http://www.humanumbrella.com/2007/12/08/how-to-download-a-remote-file-in-php-and-then-save-it/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T09:12:06.477

这取决于服务器的锁定程度。给定的示例（使用 curl 函数或 fsockopen）不应受到您提到的限制的阻碍。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-23T23:18:28.990

你可以像这样解决你的问题

a）在专用服务器中创建机制以获取任何文件（加上某种基于密钥的身份验证和对可以从中获取文件的路径的限制）

例如：一个 url，上面写着 get_file?path=/path/to/file&key=security_key

b）编写一个函数来获取它，就像从本地文件中一样

```
function fetch_file($path) {
    $ch = curl_init("http://www.example.com/get_file?path=$path&key=security_key");
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_BINARYTRANSFER, true);
    $output = curl_exec($ch);
    curl_close($ch);
    return $output;
} 
```

然后你可以评估返回的字符串，这就像包括文件

```
eval fetch_file($path); 
```

如果阻止 php 文件上传，另一种写入服务器的解决方案是将文件 ftp 到您的服务器并包含该文件。

# c# - Java和C#之间的交互

> ID：313543
> 
> 赞同：4
> 
> 时间：2008-11-24T06:34:11.350
> 
> 标签：c#, java, programming-languages, user-interface

是否可以用 Java 为用 C# 编写的应用程序编写用户界面？

我正在开发一个用 C# 编写的项目的用户界面，但我没有使用 C# 的经验，而且我是一个狂热的 Java 用户。是否可以使用 Java 的 Swing 和 AWT 库在 Java 中构建用户界面，这些库操作主要用 C# 编写的应用程序。

如果这听起来像一个非常愚蠢的问题，我提前道歉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T06:48:01.103

您也许可以利用集成到 Mono 2.0 中的一些互操作性功能

[http://www.mono-project.com/Main_Page](http://www.mono-project.com/Main_Page)

JNBridge 是另一种可能的互操作性解决方案：

[http://www.jnbridge.com/](http://www.jnbridge.com/)

但是，更理想的方法可能是将您的 .NET 代码公开为服务 - 然后从 Java 客户端（或通过轻量级 ESB）访问它们。

当然，时间、预算、资源是您必须考虑的限制因素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T07:32:48.017

我们最近这样做了，并采用了使用低级套接字连接的路线，但通过它推送 xml。C# 是服务器端，我们使用 Microsoft 的“xsd”工具为对象生成 XSD 模式，然后在 java 端使用 JAXB 生成 java 代码来解析和保存相同的对象。

正如 Barry 提到的，大部分工作/问题都与套接字连接有关——但这取决于您对此的适应程度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T12:37:51.257

除了[http://www.jnbridge.com](http://www.jnbridge.com)（专有），您还可以尝试[http://www.janetdev.org](http://www.janetdev.org) - .NET 平台的 Java 5 SE JDK 环境的开源实现。目前它仅支持 .Net 3.5（不支持 Mono）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T10:26:27.363

此外，对于交叉编译您的 java 以在 CLR 中运行的解决方案：[http ://www.ikvm.net/](http://www.ikvm.net/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-31T19:12:45.783

我是[jni4net](http://jni4net.sf.net/)的作者，它是 JVM 和 CLR 之间的开源进程间桥梁。它建立在 JNI 和 PInvoke 之上。无需 C/C++ 代码。我希望它会帮助你。

# c - Light C Unicode 库

> ID：313555
> 
> 赞同：55
> 
> 时间：2008-11-24T06:48:02.680
> 
> 标签：c, unicode, utf-8

我正在寻找一个小型 C 库来处理 utf8 字符串。

具体来说，基于 unicode 分隔符的拆分用于词干算法。

相关帖子建议：

ICU [http://www.icu-project.org/](http://www.icu-project.org/)（我发现它对于我在嵌入式设备上的用途来说太笨重了）

UTF8-CPP：[http](http://utfcpp.sourceforge.net/) ://utfcpp.sourceforge.net/ （非常好，但 C++ 不是 C）

有没有人找到任何独立于平台的小型代码库库来处理 unicode 字符串（不需要进行归化）。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-11-24T06:52:10.377

我成功使用的一个漂亮、轻便的库是[utf8proc](https://github.com/JuliaLang/utf8proc)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2011-10-30T12:28:40.673

还有[MicroUTF-8](https://puszcza.gnu.org.ua/projects/microutf8)，但它可能需要登录凭据才能查看或下载源代码。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-24T07:30:02.440

UTF-8 是专门设计的，因此许多面向字节的字符串函数可以继续工作或只需要稍作修改。

**`strstr`**例如，只要 C 的两个输入都是有效的、以 null 结尾的 UTF-8 字符串，C 的函数就可以完美运行。**`strcpy`**只要其输入字符串从字符边界开始（例如 的返回值**`strstr`**），它就可以正常工作。

因此，您甚至可能不需要单独的库！

# php - 如何确定 PHP 中的 SQLite 2 查询中受影响的行数

> ID：313567
> 
> 赞同：3
> 
> 时间：2008-11-24T06:57:36.777
> 
> 标签：php, sql

我正在用 PHP 5 编写一个应用程序。我想删除 SQLite v2 数据库文件中的一些行。我正在做这样的事情：

```
$sqliteConnection = new SQLiteDatabase('path/to/db');
$queryString = "DELETE FROM myTable WHERE status='not good'";
$result = $sqliteConnection->query($queryString); 
```

我怎么知道这个查询影响了多少行？我删除了多少行？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T07:05:06.047

PHP 函数[`sqlite_changes()`](http://de2.php.net/sqlite_changes)会为您执行此操作。

> 返回最近对`dbhandle`数据库句柄执行的 SQL 语句更改的行数。

以程序样式调用它：

```
echo 'Number of rows modified: ', sqlite_changes($sqliteConnection); 
```

或以对象样式：

```
echo 'Number of rows modified: ', $sqliteConnection->changes(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T00:09:19.817

我建议使用[PDO](http://www.php.net/manual/en/book.pdo.php)和[PDO:exec](http://www.php.net/manual/en/pdo.exec.php)，它返回受影响的行数。（或[rowCount](http://www.php.net/manual/en/pdostatement.rowcount.php)如果您使用准备好的语句。）

# java - Java中的层次表列

> ID：313570
> 
> 赞同：3
> 
> 时间：2008-11-24T07:00:19.813
> 
> 标签：java, grid, hierarchical

有没有支持分层列的Java库？

例如（前三行是列）：

```
------------------------------------------------
2008                                           |
------------------------------------------------
January               | February               |
------------------------------------------------
Week1 | Week2 | Week3 | Week 1 | Week2 | Week3 |
------------------------------------------------
10    | 20    | 14    | 12     | 15    | 3     |
------------------------------------------------ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T07:08:10.500

可能是来自[SwingLab的](https://swinglabs.dev.java.net/)[JXTree](http://javadesktop.org/swinglabs/build/weekly/latest/swingx-HEAD/javadoc/org/jdesktop/swingx/JXTree.html)可以接近您正在寻找的东西。

[此处](http://avatar21.superihost.com/index.php?entry=entry060514-170809)的插图，来自[Swingx](https://swingx.dev.java.net/)项目

[http://avatar21.superihost.com/images/JXTableJXTreeTable.png](http://avatar21.superihost.com/images/JXTableJXTreeTable.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T07:20:10.320

[JSF 的基础设施 WebGrid](http://www.infragistics.com/java/netadvantage/jsf/webgridoverview.aspx)：

[替代文字 http://www.infragistics.com/uploadedImages/Products/NetAdvantage_for_JSF/Features/WebGrid/Gallery/WebGrid_Hierarchical.png](http://www.infragistics.com/uploadedImages/Products/NetAdvantage_for_JSF/Features/WebGrid/Gallery/WebGrid_Hierarchical.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T07:25:58.297

[Estima Visual Java/SWING 组件库 4.0](http://www.eltima.com/products/screenshots/visual-java-library/)：（ [来源：][[eltima.com](http://www.eltima.com/images/screenshots/ELTable.jpg)][）][![新的强大的 Java 表格组件](https://i.stack.imgur.com/Cw2jL.jpg)](https://i.stack.imgur.com/Cw2jL.jpg)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T12:27:57.440

如果您正在寻找 JavaEE 解决方案，您可能想看看[[fleXive]](http://www.flexive.org "[灵活]")，一个开源（LGPL 用于框架，GPL 用于带有可视化编辑器的可选后端）。请随时在[论坛](http://forum.flexive.org "论坛")上提出任何问题。

[![内容编辑](https://i.stack.imgur.com/We3gx.png)](https://i.stack.imgur.com/We3gx.png)
[（来源：[flexive.org](http://www.flexive.org/fileadmin/screenshots/flexive_cp_screenshot_04.png)）]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T16:45:44.190

感谢您的回答。实际上，我的基于桌面的应用程序需要它。目前我正在评估 SWT 表，但似乎它不支持分层表列。也许我会看看 Swing JTable。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-29T23:08:51.240

或者只是按照本教程一起使用原生 JTable 和 JTree： [java_sun_articles_treetable1](http://java.sun.com/products/jfc/tsc/articles/treetable1/index.html)

# asp.net-mvc - 什么是 TempData 集合在 asp.net MVC 中使用？

> ID：313572
> 
> 赞同：7
> 
> 时间：2008-11-24T07:02:24.943
> 
> 标签：asp.net-mvc, tempdata

TempData 集合在 asp.net MVC 中的实际用途是什么，我需要该集合的优缺点，何时需要使用它，共享它的视图，或有关它的任何有用信息，最后是否有人可以告诉我何时使用它而不是 ViewData？

提前致谢

**关闭**作为[ViewData 和 TempData 之间的差异的完全相同的副本？](https://stackoverflow.com/questions/173159/difference-between-viewdata-and-tempdata)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-24T07:23:30.783

TempData 用于在控制器操作之间共享数据。如果您的控制器执行 RedirectToAction 并且目标操作需要数据（可能是特定模型实例）来执行操作，您可以将此数据存储在 TempData 中。使用 TempData 类似于将其存储在会话中，但仅用于一次往返。当您需要将数据传递给另一个控制器操作而不是渲染视图时，您可以使用 TempData。

# networking - LDAP 套接字保持活动状态

> ID：313575
> 
> 赞同：2
> 
> 时间：2008-11-24T07:07:16.337
> 
> 标签：networking, tcp, ldap, openldap, keep-alive

我们正在使用 OpenLDAP 客户端库连接到 LDAP 服务器。问题是，如果一段时间内没有活动，服务器（或中间的防火墙）会断开 TCP 连接。

我们当前的“keep-alive”实现只是不时搜索baseDN - 有更好的想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-07T11:12:19.013

`LDAP_OPT_RECONNECT`在 OpenLdap 中不可用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-04T17:06:00.697

LDAP Abandon 可能会起作用：

```
if (ldap_abandon(ld, 0, sctrls, cctrls) != LDAP_SUCCESS)
    {
       /* handle ldap error */
    };
```

在 OpenLDAP 邮件列表上对此进行了讨论：

[http://www.openldap.org/lists/openldap-devel/200905/msg00008.html](http://www.openldap.org/lists/openldap-devel/200905/msg00008.html)

简而言之：放弃请求向服务器发送消息，但是服务器不会向客户端发送放弃请求的响应。对于 LDAP 请求，零不是有效的 MSGID。由于零是无效的 MSGID，并且服务器不响应放弃请求，理论上服务器将忽略 msgid 零的放弃请求。这将在 TCP 套接字上提供活动，防止防火墙断开连接。

看：

*   RFC 4511，第 4.11 节：放弃操作
*   RFC 4511，第 4.1.1.1 节：消息 ID

[https://www.rfc-editor.org/rfc/rfc4511](https://www.rfc-editor.org/rfc/rfc4511)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T20:39:54.590

唯一的选择似乎是重新连接：

```
ldap_set_option( ld, LDAP_OPT_RECONNECT, LDAP_OPT_ON ); 
```

# c# - 填充 TreeView 控件

> ID：313581
> 
> 赞同：1
> 
> 时间：2008-11-24T07:12:58.167
> 
> 标签：c#, data-structures, treeview

我有一个 N-Ary 非以任何方式排序的树，每个节点可以有 0-N 个子节点。给定下面的数据结构，假设您有一个 TermNode 数组并且该数组是 TreeView 的第一级，我该如何填充树视图？我一直无法想出一个递归的方式来做到这一点。

```
class TermNode
{
   public string Name;
   public string Definition;
   public List<TermNode> Children
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T07:34:41.570

这里有一些代码可以帮助您开始递归。它没有经过测试（我现在不能），但你应该明白：

```
public static void BuildTreeView(TreeNodeCollection Parent, List<TermNode> TermNodeList)
{
  foreach (TermNode n in TermNodeList)
  {
    TreeNode CurrentNode = Parent.Add(n.Name);
    // no need to recurse on empty list
    if (n.List.Count > 0) BuildTreeView(CurrentNode.Nodes, n.List);
  }
}

// initial call
List<TermNode> AllTermNodes = /* all your nodes at root level */;

BuildTreeView(treeView1.Nodes, AllTermNodes); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T11:09:56.770

刚拿出泛型来试一试……效果很好。值得一看...

```
public interface INode<T>
{
    List<T> Children { get; }
}
class TermNode:INode<TermNode>
{
   public string Name;
   public string Definition;
   public List<TermNode> Children { get; set; }
   public TermNode()
   {
       this.Children = new List<TermNode>();
   }
}

public class TreeBuilder<T> where T : INode<T>
{
    public Func<T, TreeNode> obCreateNodeFunc;

    public void AddNode(TreeView obTreeView, T obNodeToAdd, TreeNode obParentNodeIfAny) 
    {
        TreeNodeCollection obNodes;
        if (obParentNodeIfAny == null)
        {
            obNodes = obTreeView.Nodes;
        }
        else
        {
            obNodes = obParentNodeIfAny.Nodes;
        }
        int iNewNodeIndex = obNodes.Add(obCreateNodeFunc(obNodeToAdd));
        TreeNode obNewNode = obNodes[iNewNodeIndex];

        foreach (T child in obNodeToAdd.Children)
        {
            AddNode(obTreeView, child, obNewNode);
        }
    }
}

// calling code - Some class
    static TreeNode GetTreeNodeFor(TermNode t)
    {
        return new TreeNode(t.Name);  // or any logic that returns corr TreeNode for T
    }

    void Main()...
    {
       TermNode[] arrNodesList;    
       // populate list with nodes

       TreeBuilder<TermNode> tb = new TreeBuilder<TermNode>();
       tb.obCreateNodeFunc = GetTreeNodeFor;
       foreach (TermNode obNode in arrNodesList)
       {
           tb.AddNode(treeView, obNode, null);
       }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T08:35:31.043

谢谢大家我很困惑，因为我没有意识到对于给定的 TreeNode tn，tn.Nodes.Add 将返回添加的 TreeNode 一旦您知道解决方案是直截了当的，就像这样

```
private void /*TreeNode*/ RecursiveAdd(OntologyNode on, TreeNode tn)
{
    if (on.Children.Count == 0)
    {
        return;             
    }
    foreach (OntologyNode child in on.Children)
    {
        TreeNode tCur = tn.Nodes.Add(child.Name);
        tCur.Tag = child;//optional for some selected node events
        RecursiveAdd(child, tCur);               
    }
 } 
```

并开始递归调用

```
foreach( OntologyNode on in Nodes )
 {
     if (on.IsTopLevelNode == true)// internal not pertinent to this code snippet
     {
          TreeNode tn = tvOntoBrowser.Nodes.Add(on.Name);
          tn.Tag = on;
          if (on.Children.Count > 0)
          {
               RecursiveAdd(on, tn);
          }
     }

  } 
```

# java - Java泛型中擦除的概念是什么？

> ID：313584
> 
> 赞同：153
> 
> 时间：2008-11-24T07:20:47.823
> 
> 标签：java, generics

Java泛型中擦除的概念是什么？

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2008-11-24T07:25:10.903

这基本上是通过编译器技巧在 Java 中实现泛型的方式。编译后的泛型代码*实际上*只使用`java.lang.Object`您谈论的任何地方`T`（或其他一些类型参数） - 并且有一些元数据告诉编译器它确实是一个泛型类型。

当您针对泛型类型或方法编译一些代码时，编译器会计算出您真正的意思（即类型参数的含义`T`）并在*编译*时验证您正在做正确的事情，但发出的代码再次只是在说话就`java.lang.Object`- 编译器在必要时生成额外的强制转换。在执行时，a`List<String>` 和 a`List<Date>`完全一样；额外的类型信息已被编译器*删除。*

将其与 C# 进行比较，其中信息在执行时保留，允许代码包含表达式，例如`typeof(T)`which 等价于`T.class`- ，但后者无效。（请注意，.NET 泛型和 Java 泛型之间还有进一步的区别。）在处理 Java 泛型时，类型擦除是许多“奇怪”警告/错误消息的来源。

其他资源：

*   [甲骨文文档](https://docs.oracle.com/javase/tutorial/java/generics/erasure.html)
*   [维基百科](http://en.wikipedia.org/wiki/Generics_in_Java)
*   [Gilad Bracha 的 Java 泛型指南](http://www8.cs.umu.se/kurser/tdbb24/HT05/jem/download/generics-tutorial.pdf)（PDF - 强烈推荐；链接可能需要定期更改）
*   [Angelika Langer 的 Java 泛型常见问题解答](http://www.angelikalanger.com/GenericsFAQ/FAQSections/Index.html)

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-06-05T19:01:57.780

顺便说一句，实际查看编译器在执行擦除时正在做什么是一个有趣的练习——使整个概念更容易掌握。有一个特殊标志，您可以通过编译器来输出已删除泛型并插入强制转换的 java 文件。一个例子：

```
javac -XD-printflat -d output_dir SomeFile.java 
```

这`-printflat`是传递给生成文件的编译器的标志。（这`-XD`部分是告诉`javac`将它交给实际执行编译的可执行 jar 而不仅仅是`javac`.，但我离题了......）这`-d output_dir`是必要的，因为编译器需要一些地方来放置新的 .java 文件。

当然，这不仅仅是擦除；编译器所做的所有自动操作都在这里完成。例如，还插入了默认构造函数，新的 foreach 样式`for`循环扩展为常规`for`循环等。很高兴看到自动发生的小事情。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2011-12-13T09:32:47.170

擦除，字面意思是从编译的字节码中擦除源代码中存在的类型信息。让我们用一些代码来理解这一点。

```
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

public class GenericsErasure {
    public static void main(String args[]) {
        List<String> list = new ArrayList<String>();
        list.add("Hello");
        Iterator<String> iter = list.iterator();
        while(iter.hasNext()) {
            String s = iter.next();
            System.out.println(s);
        }
    }
} 
```

如果您编译此代码，然后使用 Java 反编译器对其进行反编译，您将得到类似这样的结果。**请注意，反编译的代码不包含原始源代码中存在的类型信息的痕迹。**

```
import java.io.PrintStream;
import java.util.*;

public class GenericsErasure
{

    public GenericsErasure()
    {
    }

    public static void main(String args[])
    {
        List list = new ArrayList();
        list.add("Hello");
        String s;
        for(Iterator iter = list.iterator(); iter.hasNext(); System.out.println(s))
            s = (String)iter.next();

    }
} 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2008-11-24T07:38:50.283

要完成已经非常完整的 Jon Skeet 的答案，您必须意识到**[类型擦除](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.6)**的概念源于**与 Java 早期版本兼容**的需要。

最初在 EclipseCon 2007（不再可用）上提出，兼容性包括以下几点：

*   源兼容性（很高兴...）
*   二进制兼容性（必须具备！）
*   迁移兼容性
    *   现有计划必须继续有效
    *   现有库必须能够使用泛型类型
    *   一定有！

原答案：

因此：

```
new ArrayList<String>() => new ArrayList() 
```

有人提议进行更大程度的**[物化](http://www.weiqigao.com/blog/2007/01/20/java_generics_let_the_other_shoe_drop.html)**。物化是“将抽象概念视为真实”，其中语言构造应该是概念，而不仅仅是句法糖。

我还应该提到[`checkCollection`](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#checkedCollection%28java.util.Collection%2C%20java.lang.Class%29)Java 6 的方法，它返回指定集合的​​动态类型安全视图。任何插入错误类型元素的尝试都将导致立即`ClassCastException`.

语言中的泛型机制**提供了编译时（静态）类型检查，但也有可能使用未经检查的强制转换来破坏这种机制**。

通常这不是问题，因为编译器会对所有此类未经检查的操作发出警告。

但是，有时仅静态类型检查是不够的，例如：

*   当集合被传递给第三方库时，库代码必须不通过插入错误类型的元素来破坏集合。
*   程序失败并`ClassCastException`显示 ，表示将错误类型的元素放入参数化集合中。不幸的是，在插入错误元素后的任何时候都可能发生异常，因此它通常很少或根本没有提供有关问题真正来源的信息。

* * *

2012 年 7 月更新，差不多四年后：

现在（2012）在“ [API 迁移兼容性规则（签名测试）](http://docs.oracle.com/javame/test-tools/sigtest/2_2/html/a-compat.html#Z4000c521043377) ”中有详细说明

> Java 编程语言使用擦除实现泛型，这可以确保遗留版本和泛型版本通常生成相同的类文件，除了一些关于类型的辅助信息。二进制兼容性没有被破坏，因为可以用通用类文件替换遗留类文件，而无需更改或重新编译任何客户端代码。
> 
> 为了便于与非泛型遗留代码交互，还可以将参数化类型的擦除用作类型。这种类型称为**原始类型**（[Java 语言规范 3/4.8](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.8)）。允许原始类型还可以确保源代码的向后兼容性。
> 
> 据此，`java.util.Iterator`该类的以下版本是二进制和源代码向后兼容的：

```
Class java.util.Iterator as it is defined in Java SE version 1.4:

public interface Iterator {
    boolean hasNext();
    Object next();
    void remove();
}

Class java.util.Iterator as it is defined in Java SE version 5.0:

public interface Iterator<E> {
    boolean hasNext();
    E next();
    void remove();
} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-11-24T08:29:18.043

补充已经完成的 Jon Skeet 答案......

已经提到通过擦除实现泛型会导致一些烦人的限制（例如 no `new T[42]`）。也有人提到，这样做的主要原因是字节码的向后兼容性。这也是（大部分）正确的。生成的字节码 -target 1.5 与仅脱糖转换的 -target 1.4 有所不同。*从技术上讲，甚至有可能（通过巨大的诡计）在运行时*访问泛型类型实例，证明字节码中确实存在某些东西。

更有趣的一点（尚未提出）是使用擦除实现泛型为高级类型系统可以完成的工作提供了相当多的灵活性。Scala 的 JVM 实现与 CLR 就是一个很好的例子。在 JVM 上，可以直接实现更高级的类型，因为 JVM 本身对泛型类型没有限制（因为这些“类型”实际上不存在）。这与 CLR 形成对比，后者具有参数实例化的运行时知识。正因为如此，CLR 本身必须对应该如何使用泛型有一些概念，从而消除使用意外规则扩展系统的尝试。因此，Scala 在 CLR 上的高级类型是使用编译器本身模拟的一种奇怪的擦除形式来实现的，

当您想在运行时做一些顽皮的事情时，擦除可能不方便，但它确实为编译器编写者提供了最大的灵活性。我猜这就是为什么它不会很快消失的部分原因。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-24T07:25:50.200

据我了解（作为[.NET](http://en.wikipedia.org/wiki/.NET_Framework)人员），[JVM](http://en.wikipedia.org/wiki/Java_virtual_machine)没有泛型的概念，因此编译器将类型参数替换为 Object 并为您执行所有转换。

这意味着 Java 泛型只不过是语法糖，对于通过引用传递时需要装箱/拆箱的值类型没有任何性能改进。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-03-08T21:23:18.150

有很好的解释。我只添加一个示例来说明类型擦除如何与反编译器一起使用。

原班，

```
import java.util.ArrayList;
import java.util.List;

public class S<T> {

    T obj; 

    S(T o) {
        obj = o;
    }

    T getob() {
        return obj;
    }

    public static void main(String args[]) {
        List<String> list = new ArrayList<>();
        list.add("Hello");

        // for-each
        for(String s : list) {
            String temp = s;
            System.out.println(temp);
        }

        // stream
        list.forEach(System.out::println);
    }
} 
```

从其字节码反编译代码，

```
import java.io.PrintStream;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.Objects;
import java.util.function.Consumer;

public class S {

   Object obj;

   S(Object var1) {
      this.obj = var1;
   }

   Object getob() {
      return this.obj;
   }

   public static void main(String[] var0) {

   ArrayList var1 = new ArrayList();
   var1.add("Hello");

   // for-each
   Iterator iterator = var1.iterator();

   while (iterator.hasNext()) {
         String string;
         String string2 = string = (String)iterator.next();
         System.out.println(string2);
   }

   // stream
   PrintStream printStream = System.out;
   Objects.requireNonNull(printStream);
   var1.forEach(printStream::println);

   }
} 
```

# java - JDBC 简化连接

> ID：313586
> 
> 赞同：0
> 
> 时间：2008-11-24T07:23:04.917
> 
> 标签：java, jdbc

是否有任何库可以简化使用 JDBC 连接到服务器的任务？可以带字符串的东西，`mysql://username:password@host/db`类似于[此处](http://pear.php.net/package/MDB2/docs/latest/MDB2/MDB2.html#methodparseDSN)的操作。`PHP MDB2`

我对任何 ORM 或复杂库都不感兴趣，例如`Spring`我什至没有从`Java`语言中这样做（但仍在 JVM 上）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-05-06T19:53:21.590

这是一个使用Spring中的[JdbcTemplate的示例。](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/jdbc/core/JdbcTemplate.html)

```
static void jdbcTemplateExample() {
    DataSource ds = DataSourceBuilder
            .create()
            .username(username)
            .password(password)
            .url(url)
            .build();

    JdbcTemplate jt = new JdbcTemplate(ds);

    List<Object> results = jt.query("SELECT * FROM table", (ResultSet rs, int rowNum) -> {
        //Create whatever Object you want with the resultSet.
        //Will convert to Map as example.
        Map results = new HashMap<>();
        ResultSetMetaData md = rs.getMetaData();
        int columns = md.getColumnCount();
        for (int i = 1; i <= columns; ++i) {
            results.put(md.getColumnName(i), rs.getObject(i));
        }
        return results;
    });

    //use the results
} 
```

# java - 如何为 SimpleHistogramDataset 中的 SimpleHistogramBin bin 设置高度？

> ID：313598
> 
> 赞同：1
> 
> 时间：2008-11-24T07:30:50.267
> 
> 标签：java, jfreechart

我使用方法来管理我from`setItemsCount()`中垃圾箱的高度。然而，它做了一些奇怪的事情：当我设置例如 1 时，它显示 1.4`SimpleHistogram``JFreeChart`

除了这个方法的论点是`Integer`，而我需要`double`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-08-13T02:04:09.130

我建议在[JFreeChart 论坛上提问](http://www.jfree.org/phpBB2/viewforum.php?f=3)

# jquery - JQuery 模式中的 ASP.NET 控件

> ID：313611
> 
> 赞同：2
> 
> 时间：2008-11-24T07:43:47.653
> 
> 标签：jquery, controls, asp.net-3.5

好的，我是 JQuery 的新手，我有一个带有 asp:Literal 控件的模式。文字由单击以激活模式的任何链接控制。所以，我曾希望它就像给出链接的文字值 onClick 一样简单，但事实并非如此。

我希望：文字的值是在页面加载时设置的，所以我必须将它放在更新面板中，以便在单击链接时它会改变。

或者它可能是：像 javascript 一样，您必须使用 JQuery onClick 动态设置文字的值。

感谢您的帮助。

**更新**

这是模式的 HTML：

```
<div class="modal-holder" id="landing-page-modal" style="display:none">
  <div class="modal">
    <div class="modal-t">
      <a href="#" class="modal-close">
        <img src="images/modal-close.gif" border="0" alt="" />
      </a>
      <div class="modal-scroll">
        <a href="#" class="modal-top-arrow">
          <img src="images/modal-arr-t.gif" alt="" />
        </a>
        <a href="#" class="modal-bottom-arrow">
          <img src="images/modal-arr-b.gif" alt="" />
        </a>
      </div>
      <div class="modal-b">
        <div class="modal-content">
          <h2><asp:Label ID="lblModal" Text="Title" runat="server" /></h2>
          <p>
            <asp:Literal ID="litModal" Text="Test Data Lives Here For Now" runat="server" />
          </p>
        </div>
      </div>
    </div>
  </div>
</div> 
```

这是单击链接时激活模式的 JQuery：

```
$('.article a, #menu a, #features a').click(function(){
  $('.modal-holder').css({'display': 'block'});
  return false;
});

$('.modal-close').click(function(){ 
  $('.modal-holder').css({'display': 'none'}); 
}); 
```

我想知道如何在模式激活之前更改模式中的“litModal”控件的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T08:34:15.350

好的，所以你的`<p>`. 这意味着您没有直接的选择器/句柄，就像它是带有 ID 的标签一样。

但你可以说它是ID 元素的所有部分的`<p>`内部：`<div class="modal-content">``landing-page-modal`

```
"#landing-page-modal div.modal-content p" 
```

因此，您需要修改使整个内容可见的函数：

```
$('.article a, #menu a, #features a').click( function(clickTarget){
  // set the text of the <p> to whatever you like. I took 
  // the text of the element that was clicked by the user.
  $('#landing-page-modal div.modal-content p').text( $(clickTarget).text() ); 

  // now make the whole thing visible
  $('#landing-page-modal').css({'display': 'block'});
  return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T08:21:05.067

如果您希望在单击链接时更改客户端模式，则需要在链接的 onClick 处理程序中设置它。我将假设模态文本基于单击的锚标记。 `litModal`将变成客户端的跨度，因此我们以这种方式找到它。

```
 $('.article a, #menu a, #features a').click(function(anchor){
             var val = jQuery(anchor).text();
            // modify val as needed
            $('span#litModal').text(  val );
            $('.modal-holder').css({'display': 'block'});
            return false;
    });
    $('.modal-close').click(function(){ $('.modal-holder').css({'display': 'none'}); }); 
```

注意：我假设您每页只有一个。如果没有，那么您需要弄清楚如何引用适用于相关链接的特定模式。

# jquery - json还是html？怎么讲？

> ID：313615
> 
> 赞同：0
> 
> 时间：2008-11-24T07:48:10.640
> 
> 标签：jquery, asp.net-mvc, ajax

我有一个控制器，它根据用户是否登录返回 JSON 或部分 html。

一旦返回结果，是否有区别？什么是最好的方法。

显然，如果响应是 json 或者它是部分 html，我有不同的操作要完成。使用json我重定向到登录页面，使用html我只是显示它。如果我能渲染 html 服务器端并以 json 格式发送回来？据我所知，目前还无法做到这一点。想法？

干杯。

**重复：[我可以在成功回调中评估 $.ajax() 调用的响应类型吗？](https://stackoverflow.com/questions/291466/can-i-evaluate-the-response-type-of-an-ajax-call-in-success-callback)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T07:59:43.610

您可以使用[JSON.js](http://www.devpro.it/JSON/files/JSON-js.html)来确定给定字符串是否为 JSON。

> **JSON 编码器/解码器**
> 这个对象使用良好的实践来快速编码/解码各种 JSON 兼容变量，并且更安全一些。

它提供了一个`decode()`返回对象或返回的函数`undefined`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T07:58:38.463

我想说，假设您可以控制返回 JSON 或部分 HTML 的内容，您应该将 JSON 结果的 Content-Type 标头更改为类似`application/x-format-json`或同样明显的类型。

# windows - 用于更改服务帐户的 Powershell 脚本

> ID：313622
> 
> 赞同：45
> 
> 时间：2008-11-24T07:53:19.443
> 
> 标签：windows, powershell

有没有人有一个 Powershell 脚本来更改 Windows 服务使用的凭据？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-11-24T21:46:59.417

简单一点 - 使用 WMI。

```
$service = gwmi win32_service -computer [computername] -filter "name='whatever'"
$service.change($null,$null,$null,$null,$null,$null,$null,"P@ssw0rd") 
```

在过滤器中适当更改服务名称；适当地设置远程计算机名称。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2010-12-06T20:59:46.677

我为 PowerShell 编写了一个函数，可以更改用户名、密码并在远程计算机上重新启动服务（如果要更改本地服务器，可以使用 localhost）。我已将其用于数百台服务器上的每月服务帐户密码重置。

[您可以在http://www.send4help.net/change-remote-windows-service-credentials-password-powershel-495](http://www.send4help.net/change-remote-windows-service-credentials-password-powershel-495)找到原件的副本

与其他答案之一不同，它还会等到服务完全停止后再尝试重新启动它。

```
Function Set-ServiceAcctCreds([string]$strCompName,[string]$strServiceName,[string]$newAcct,[string]$newPass){
  $filter = 'Name=' + "'" + $strServiceName + "'" + ''
  $service = Get-WMIObject -ComputerName $strCompName -namespace "root\cimv2" -class Win32_Service -Filter $filter
  $service.Change($null,$null,$null,$null,$null,$null,$newAcct,$newPass)
  $service.StopService()
  while ($service.Started){
    sleep 2
    $service = Get-WMIObject -ComputerName $strCompName -namespace "root\cimv2" -class Win32_Service -Filter $filter
  }
  $service.StartService()
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-07-01T09:48:41.650

我创建了一个包含以下脚本的文本文件“changeserviceaccount.ps1”：

```
$account="domain\user"
$password="passsword"
$service="name='servicename'"

$svc=gwmi win32_service -filter $service
$svc.StopService()
$svc.change($null,$null,$null,$null,$null,$null,$account,$password,$null,$null,$null)
$svc.StartService() 
```

在开发 Windows 服务期间，我将其用作构建后命令行的一部分：

Visual Studio：项目属性\生成事件

预构建事件命令行：

```
"C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\installutil.exe" myservice.exe /u 
```

构建后事件命令行：

```
"C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\installutil.exe" myservice.exe
powershell -command - < c:\psscripts\changeserviceaccount.ps1 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2018-04-03T21:56:13.570

PowerShell 6 版本[`Set-Service`](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/set-service?view=powershell-6#notes)现在有这个`-Credential`参数。

这是一个例子：

```
$creds = Get-Credential
Set-Service -DisplayName "Remote Registry" -Credential $creds 
```

目前，它只能通过[GitHub](https://github.com/PowerShell/PowerShell#get-powershell)下载。

享受！

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-09-01T11:22:39.347

下面是其他脚本的细微变化。这将为在给定登录帐户下运行的任何/所有服务设置凭据。如果服务已经在运行，它只会尝试重新启动服务，这样我们就不会意外启动因某种原因停止的服务。该脚本必须从和提升的 shell 运行（如果脚本开始告诉您有关 的信息`ReturnValue = 2`，您可能在未提升的情况下运行它）。一些使用示例如下：

*   在本地主机上以当前登录用户身份运行的所有服务：

    `.\set-servicecredentials.ps1 -password p@ssw0rd`

*   以用户身份运行的所有服务：`somedomain\someuser`在主机上`somehost.somedomain`：

    `.\set-servicecredentials.ps1 somehost.somedomain somedomain\someuser p@ssw0rd`

*设置ServiceCredentials.ps1：*

```
param (
  [alias('computer', 'c')]
  [string] $computerName = $env:COMPUTERNAME,

  [alias('username', 'u')]
  [string] $serviceUsername = "$env:USERDOMAIN\$env:USERNAME",

  [alias('password', 'p')]
  [parameter(mandatory=$true)]
  [string] $servicePassword
)
Invoke-Command -ComputerName $computerName -Script {
  param(
    [string] $computerName,
    [string] $serviceUsername,
    [string] $servicePassword
  )
  Get-WmiObject -ComputerName $computerName -Namespace root\cimv2 -Class Win32_Service | Where-Object { $_.StartName -eq $serviceUsername } | ForEach-Object {
    Write-Host ("Setting credentials for service: {0} (username: {1}), on host: {2}." -f $_.Name, $serviceUsername, $computerName)
    $change = $_.Change($null, $null, $null, $null, $null, $null, $serviceUsername, $servicePassword).ReturnValue
    if ($change -eq 0) {
      Write-Host ("Service Change() request accepted.")
      if ($_.Started) {
        $serviceName = $_.Name
        Write-Host ("Restarting service: {0}, on host: {1}, to implement credential change." -f $serviceName, $computerName)
        $stop = ($_.StopService()).ReturnValue
        if ($stop -eq 0) {
          Write-Host -NoNewline ("StopService() request accepted. Awaiting 'stopped' status.")
          while ((Get-WmiObject -ComputerName $computerName -Namespace root\cimv2 -Class Win32_Service -Filter "Name='$serviceName'").Started) {
            Start-Sleep -s 2
            Write-Host -NoNewline "."
          }
          Write-Host "."
          $start = $_.StartService().ReturnValue
          if ($start -eq 0) {
            Write-Host ("StartService() request accepted.")
          } else {
            Write-Host ("Failed to start service. ReturnValue was '{0}'. See: http://msdn.microsoft.com/en-us/library/aa393660(v=vs.85).aspx" -f $start) -ForegroundColor "red"
          }
        } else {
          Write-Host ("Failed to stop service. ReturnValue was '{0}'. See: http://msdn.microsoft.com/en-us/library/aa393673(v=vs.85).aspx" -f $stop) -ForegroundColor "red"
        }
      }
    } else {
      Write-Host ("Failed to change service credentials. ReturnValue was '{0}'. See: http://msdn.microsoft.com/en-us/library/aa384901(v=vs.85).aspx" -f $change) -ForegroundColor "red"
    }
  }
} -Credential "$env:USERDOMAIN\$env:USERNAME" -ArgumentList $computerName, $serviceUsername, $servicePassword 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-24T08:08:45.200

考虑到这个类：

```
$class=[WMICLASS]'\\.\root\Microsoft\SqlServer\ComputerManagement:SqlService' 
```

有一个名为 的方法**`setserviceaccount()`**，可能这个[脚本](http://www.vistax64.com/powershell/81415-change-service-account-passwords.html#post404589)会做你想做的事：

```
# Copyright Buck Woody, 2007
# All scripts provided AS-IS. No functionality is guaranteed in any way.
# Change Service Account name and password using PowerShell and WMI
$class = Get-WmiObject -computername "SQLVM03-QF59YPW" -namespace
root\Microsoft\SqlServer\ComputerManagement -class SqlService

#This remmed out part shows the services - I'll just go after number 6 (SQL
#Server Agent in my case):
# foreach ($classname in $class) {write-host $classname.DisplayName}
# $class[6].DisplayName
stop-service -displayName $class[6].DisplayName

# Note: I recommend you make these parameters, so that you don't store
# passwords. At your own risk here!
$class[6].SetServiceAccount("account", "password")
start-service -displayName $class[6].DisplayName 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-04-13T08:11:03.517

给定的答案可以完成工作。

虽然，还有另一个重要的细节；为了更改凭据并成功运行服务，您首先必须**授予该用户帐户权限以“作为服务登录”**。

要将该权限授予用户，请使用[此处](https://gallery.technet.microsoft.com/scriptcenter/Grant-Log-on-as-a-service-11a50893)提供的 Powershell 脚本，只需提供帐户的用户名，然后运行其他命令来更新其他答案中提到的服务凭据，即

```
$svc=gwmi win32_service -filter 'Service Name'

$svc.change($null,$null,$null,$null,$null,$null,'.\username','password',$null,$null,$null) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-06-23T10:29:56.963

```
$svc = Get-WmiObject win32_service -filter "name='serviceName'" 
```

用户名和密码的位置可以更改，因此请尝试此行以找到正确的位置`$svc.GetMethodParameters("change")`

```
$svc.change($null,$null,$null,$null,$null,$null,$null,$null,$null,"admin-username","admin-password") 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-03-16T06:48:05.750

只是让@alasairs 的评论更明显：第 6 个参数必须是`$false`，而不是`$null`当您使用域帐户时：

```
$service = Get-WMIObject -class Win32_Service -filter 'Service Name'
$service.change($null, $null, $null, $null, $null, $false, "DOMAIN\account", "mypassword") 
```

没有它，它适用于我尝试更改的 4/5 服务，但有些拒绝更改（错误 21）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-04-20T17:50:34.470

我在默认 PS 堆栈中找不到的内容，我发现它在以下位置实现`Carbon`：

[http://get-carbon.org/help/Install-Service.html](http://get-carbon.org/help/Install-Service.html)

[http://get-carbon.org/help/Carbon_Service.html](http://get-carbon.org/help/Carbon_Service.html)（仅限 Carbon 2.0）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-04-30T00:57:52.557

Sc 配置示例。首先允许修改访问某个目标文件夹，然后使用锁定的“本地服务”帐户。如果我到处都有 PS 6 或更高版本，我会使用 set-service -credential。

```
icacls c:\users\myuser\appdata\roaming\fahclient /grant "local service:(OI)(CI)(M)"
sc config "FAHClient" obj="NT AUTHORITY\LocalService" 
```

# ruby - Ruby 中的工作线程

> ID：313629
> 
> 赞同：6
> 
> 时间：2008-11-24T07:58:42.817
> 
> 标签：ruby, qtruby

我正在使用 ruby​​ + qt 编写一个简单的记忆游戏（试图暂时摆脱 c++ ......）
为了允许 X 秒超时查看两个打开的部分，我需要计时器或在后台线程中完成工作.

在不重新发明轮子的情况下实现这一点的最简单方法是什么？
红宝石线程？Qt线程？Qt 计时器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T18:25:38.190

我不知道这是否是最好的解决方案，但是：

```
block=Proc.new{ Thread.pass }
timer=Qt::Timer.new(window)
invoke=Qt::BlockInvocation.new(timer, block, "invoke()")
Qt::Object.connect(timer, SIGNAL("timeout()"), invoke, SLOT("invoke()"))
timer.start(1) 
```

使红宝石线程工作！根据您的需要调整 start(x)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T10:58:19.803

选择 QT 线程/定时器还是 Ruby 的决定可能是个人决定，但您应该记住 Ruby 线程是绿色的。这意味着它们由 Ruby 解释器实现，不能跨多个处理器内核扩展。不过，对于一个带有计时器的简单记忆游戏，我猜你可能不需要担心这一点。

虽然有些无关，[但 Midiator](http://github.com/bleything/midiator)是 MIDI 设备的 Ruby 接口，它使用[Ruby 线程来实现计时器](http://github.com/bleything/midiator/tree/master/lib%2Fmidiator%2Ftimer.rb)。

另外，看看[Leslie Viljoen 的文章](http://www.lesismore.co.za/2008/02/qt-and-ruby.html)，他说当 QT 表单小部件等待输入时，Ruby 的线程会锁定。他还提供了一些示例代码来实现 QT 计时器（看起来很简单并且适合您正在做的事情）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T06:16:44.443

谢谢。

使用 QTimer::singleShot 解决了它。足够了 - 在我的情况下，每次显示两个瓷砖时都会触发一次计时器。

# iphone - 使用一个委托管理两个 UIActionSheets

> ID：313639
> 
> 赞同：7
> 
> 时间：2008-11-24T08:12:44.677
> 
> 标签：iphone, cocoa-touch

我有两个 UIActionSheets，我想我将使用一个委托（实例化它们的 UIViewController）来控制它们。委托将捕获一个 actionSheet 调用并尝试找出两者中的哪一个引发了事件。

我试图让modalView的标题来区分，但它似乎是无效的......

这应该工作吗？

如果没有，是否有其他方法可以区分哪个 UIActionSheet 执行了该事件？

或者我是否需要创建两个不同的类，它们将是每个 UIActionSheet 的单独代表？

提前致谢。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-11-24T08:33:12.607

我认为您需要*UIActionSheet的**tag*属性。

 *就像是：

```
UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle ... ];
actionSheet.tag = 10;
[actionSheet showInView:self.view]; 
```

然后在你的代表中：

```
- (void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex {
  switch (actionSheet.tag) {
    case 10:
      ...
  }
} 
```

*tag*是*UIView*的一个属性，也可以在 Interface Builder 中为出现在那里的组件设置。非常方便，尽管我自己从未在这种情况下实际使用过它。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-24T14:10:43.877

为此目的，Cocoa 中的委托方法包括发送对象。在控制器类中保留对每个操作表的引用作为实例变量，您可以将其与委托方法中的 actionSheet 参数进行比较，以决定需要执行哪些操作。

使用视图的标记属性会起作用，但保留引用会更容易。如果您正在查看子视图的层次结构并且没有对所需对象的引用，则 tag 属性旨在帮助您找到视图。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-09T16:53:45.230

正如 Marc 所说，您应该使用传递给委托方法的 actionSheet 指针。例如：

```
- (void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex {
    if(actionSheet == myDoSomethingActionSheet) {
        if(buttonIndex == 0) {
            [self doThingA];
            return;
        }
        if(buttonIndex == 1) {
            [self doThingB];
            return;
        }
    }
    if(actionSheet == myOtherActionSheet) {
        if(buttonIndex == 3) {
            [self doImportantThing];
            return;
        }
    }
} 
```

# automation - 什么是工作流系统？

> ID：313643
> 
> 赞同：4
> 
> 时间：2008-11-24T08:19:03.183
> 
> 标签：automation, workflow

如何将工作流系统与自动化某些工作的普通应用程序区分开来？系统是否有任何特定功能必须被归类为工作流系统？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-24T08:35:09.687

工作流系统管理具有关联状态的对象（通常是逻辑上或实际的文档电子替代品）。[系统中对象的状态是状态机](http://en.wikipedia.org/wiki/State_diagram)（或[Petri 网](http://en.wikipedia.org/wiki/Petri_net)）中的节点。

状态转换将对象从一种状态移动到另一种状态。转换可以由人、自动事件、计时器、日历等触发。通常，转换代表现实世界中流程中的步骤。

这很抽象，所以考虑一个例子：错误跟踪软件。错误报告可能在开始时未经验证，因此在 QA 测试人员的队列中。QA 测试人员将验证报告并确保步骤清晰，对报告进行严重程度等分级，并将其分配给开发人员或开发人员组。然后在开发人员的队列中，最终将修复或决定不修复错误，这会将其发送回 QA 进行验证。如果对 bug 有争议，它可能会进入管理堆栈冒泡的状态。

上面的一个简单实现是对与每个对象关联的状态使用枚举，并使每个人的收件箱成为对具有特定枚举值状态的对象的查询。

这就是它的要点，但事情可能会变得更复杂，例如拆分新对象、对非人类事件（例如时间、内部或外部（即第三方）服务等）做出反应。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T09:46:13.270

[工作流管理系统](http://en.wikipedia.org/wiki/Workflow_engine)推动用户通过一个过程，该过程跨越系统内的多个功能，并且可能跨越工作流中的多个参与者。工作流引擎知道流程的状态，并将其存储在自己的存储中，该存储可能是也可能不是主应用程序数据库的一部分。

可以使用[状态机](http://en.wikipedia.org/wiki/State_machines)、[Petri 网](http://en.wikipedia.org/wiki/Petri_net)或[各种其他结构](http://en.wikipedia.org/wiki/Windows_Workflow_Foundation#Types_of_Workflows)（包括普通的旧脚本语言）[对工作流进行建模。](https://stackoverflow.com/questions/325721/is-a-process-design-really-declarative-programming#325769)独立的[编排系统](http://en.wikipedia.org/wiki/Orchestration_(computers))可用于管理跨多个应用程序的工作流。许多（但不是全部）支持[BPEL（业务流程执行语言）](http://en.wikipedia.org/wiki/BPEL)作为工作流的标准描述语言。如果您的应用程序设置为[面向服务的体系结构](http://en.wikipedia.org/wiki/Service-oriented_architecture)，则工作流系统可以控制应用程序功能来执行此操作。工作流引擎的另一个特性是它应该可以中止工作流并撤消任何状态更改，同时[保持数据库的一致性](http://en.wikipedia.org/wiki/Long_running_transaction)。

[www.workflowpatterns.com](http://www.workflowpatterns.com/)拥有一系列关于工作流系统的文档，以及一个模式库。

工作流系统的应用示例：

*   保险索赔管理。基本上是他们所有人的祖父。通常，此流程将包含规则，包括谁可以授权多少，谁可以处理不同业务类别的索赔，需要提供哪些文件并链接以提供审计跟踪，签发和跟踪付款问题以及授权损失调整工作. 典型的索赔工作流程将跟踪索赔，从通知到准备金和付款授权，再到发放付款，以及安排损失调整工作（可能通过第三方）的辅助流程，持有付款权限直到完成并发放和发放支付理赔费用。在实践中，这些过程会变得相当复杂。

*   复杂产品（如计算机系统）的订购、报价和配置管理。

*   一个不寻常的例子是由制药商开发的一个系统，用于跟踪新药品的批准过程。这还包含了一个专家系统，该系统中编码了监管框架，并且可以选择一条通过监管圈的最短路径。这将他们的平均研发生命周期上市时间从 9 年缩短到 5.5 年。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T08:56:41.610

如果用户被引导完成业务流程，而无需参考该业务流程的任何外部文档，我会将应用程序视为工作流系统。

扩展 Barry 的错误跟踪示例我会说您的错误跟踪应用程序是一个工作流应用程序，例如，如果有一个名为“关闭”的按钮，按下该按钮会将错误转换为关闭状态，可能允许用户输入关闭评论，记录时间戳和用户名，然后发送通知电子邮件。

如果用户必须从下拉列表中选择新状态，然后自己发送通知电子邮件，则它不是工作流系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T08:46:13.797

我不认为有一个精确的定义。以下是一些宽松的标准：

*   协调不止一个人的工作（但不是群件），
*   在复杂的组织环境中，
*   通常作为托管业务流程的一部分（如在 BPM 中）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T09:00:15.050

[什么是工作流？](http://www.e-workflow.org/)

> 业务流程的全部或部分自动化，在此期间，文档、信息或任务根据一组程序规则从一个参与者*传递给另一个参与者以采取行动。

```
*participant = resource (human or machine) 
```

在我看来，就软件而言，有两种类型的工作流程。静态（或内置）工作流程和动态（可编程）工作流程。许多文档管理、错误跟踪，甚至博客软件都有使用简单状态转换的内置工作流程。

当人们说“工作流”时，我认为他们通常是指您可以将业务逻辑编程到一些现有软件中的那些，例如如果库存缺少胡萝卜，则自动调用 sysco。

有关工作流功能的真实示例，请参阅[Microsoft Dynamics CRM](http://msdn.microsoft.com/en-us/library/cc151140.aspx)。

# asp.net - 当我在 RELEASE 模式下发布我的 ASP.NET 站点时，跟踪是否仍然有效？

> ID：313649
> 
> 赞同：0
> 
> 时间：2008-11-24T08:23:06.420
> 
> 标签：asp.net, publish, trace

当我在 RELEASE 模式下发布我的 ASP.NET 站点并设置编译 debug="false" 时，我的 ASP.NET 和 System.Diagnostics Tracing 是否仍然有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T08:25:01.080

我相信跟踪是与配置中的调试分开设置的，所以是的，如果配置正确的话。

```
<configuration>
 <system.web>
  <trace enabled="true" requestLimit="40" localOnly="false"/>
 </system.web>
</configuration> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T09:54:33.083

请注意，跟踪会完全破坏您正在进行的任何 msajax 内容

# c++ - 如何将指定类型的文件与我的程序相关联？

> ID：313652
> 
> 赞同：1
> 
> 时间：2008-11-24T08:24:15.527
> 
> 标签：c++, file, associate

我有一个自己开发的程序，我想将其用作 .jpg 和 .bmp 文件的默认打开工具。如何以编程方式实现目标？

有人说我必须添加一些注册表项。但我不知道我应该做什么。谁能告诉我方法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T08:43:05.600

如果是 Windows：

[CodeProject.com](http://www.codeproject.com/KB/shell/cgfiletype.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T08:52:22.710

在 OS X 上，更新应用程序包中的 Contents/Info.plist 以保存[CFBundleDocumentTypes](http://developer.apple.com/documentation/MacOSX/Conceptual/BPRuntimeConfig/Articles/PListKeys.html#//apple_ref/doc/uid/20001431-101685)数组。您可以在其中指定扩展名 (CFBundleTypeExtensions)、文档类型名称、自定义图标等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T08:46:06.233

您必须更改这些注册表项（对于 Windows，.REG 语法）：

```
[HKEY_CLASSES_ROOT\.txt]
@="textfile"

[HKEY_CLASSES_ROOT\textfile\shell\open\command]
@="C:\\WINDOWS\\NOTEPAD.EXE %1"

[HKEY_CLASSES_ROOT\textfile\shell\print\command]
@="C:\\WINDOWS\\NOTEPAD.EXE /p %1"

[HKEY_CLASSES_ROOT\textfile\DefaultIcon]
@="C:\\WINDOWS\\SYSTEM\\shell32.dll,-152" 
```

当然，您必须更改要打开的程序，也许还有图标。

# tfs - 在 Team Foundation Server 中脱机工作

> ID：313653
> 
> 赞同：62
> 
> 时间：2008-11-24T08:24:58.613
> 
> 标签：tfs, offline-mode

有没有办法在 TFS 中设置“脱机工作”，而不必尝试打开解决方案，等待它超时，然后让 Visual Studio 发现它失败了？

我不能只勾选一个框来告诉自己，这似乎有点荒谬，因为我可能是最有资格知道我不在办公室的人！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2011-02-26T07:45:19.403

这个扩展应该可以解决你的问题（对于 VS 2010）：

[http://visualstudiogallery.msdn.microsoft.com/425f09d8-d070-4ab1-84c1-68fa326190f4?SRC=Home](http://visualstudiogallery.msdn.microsoft.com/425f09d8-d070-4ab1-84c1-68fa326190f4?SRC=Home)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-11-23T12:52:00.290

这是带有 TFS 的 VS 2008 的解决方案

1.  导航到 Visual Studio 菜单 ---- 文件 > 源代码管理 > 更改源代码管理 > 单击解决方案/项目 > 选中/取消选中项目复选框 > 单击顶部的“取消绑定”按钮。

这会使您的完整解决方案或解决方案中的选定项目从 TFS 脱机。

1.  当您想上网时，请按照相同的步骤并单击“绑定”按钮

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-02-16T06:58:24.287

Ben Ryan 有你在他的博客上寻找的 regkeys：

*   [http://blogs.msdn.com/benryan/archive/2007/12/12/when-and-how-does-my-solution-go-offline.aspx](http://blogs.msdn.com/benryan/archive/2007/12/12/when-and-how-does-my-solution-go-offline.aspx)
*   [http://blogs.msdn.com/benryan/archive/2007/12/12/how-to-make-tfs-offline-strictly-solution-based.aspx](http://blogs.msdn.com/benryan/archive/2007/12/12/how-to-make-tfs-offline-strictly-solution-based.aspx)

大多数这些控件也内置在最新的[Power Tools](http://msdn.microsoft.com/en-us/teamsystem/bb980963.aspx)中：

```
C:\Users\Richard> tfpt tweakui /?
tfpt tweakui - Enhance how client connects to Team Foundation Server

Allows configuration of how and when the client connects to a 
Team Foundation Server.  This includes client certificates, auto
reconnect, offline, compression, maximum connections, timeouts, 
and bypassing the proxy. 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-03-08T13:41:46.813

当我必须离线工作时，我只需拔下以太网电缆并启动 TFS 2008。它会在离线模式下启动我。然后重新插入，在解决方案资源管理器中右键单击“在线工作”，TFS 会要求您签入离线更改。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-27T22:16:30.690

添加主机条目 127.0.0.1 tfs.foo.com

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-27T14:36:15.243

Team Foundation Server 2008 确实支持脱机工作。

[该视频](http://msdn2.microsoft.com/en-us/teamsystem/bb898913.aspx)演示了如何使用此功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-09T15:07:36.620

如果 TFS 关闭，您可能无法进入离线模式。如果您关闭并重新打开解决方案，将出现一个漂亮的小对话框，询问您是否要脱机。

或者，如果您不想关闭/重新打开解决方案，您可以安装[TFS Go-Offline 插件](https://visualstudiogallery.msdn.microsoft.com/6e54271c-2c4e-4911-a1b4-a65a588ae138)，然后单击：

```
TEAM -> Go Offline 
```

# merge - 从 PROD 合并到 HEAD 还是从 HEAD 合并到 PROD？

> ID：313657
> 
> 赞同：3
> 
> 时间：2008-11-24T08:26:17.583
> 
> 标签：merge, branch, trunk

我们有两个分支：1\. HEAD - 最新版本 (AKA Trunc) 2\. PROD - 发布版本

当您修复已发布版本中的错误时，您会执行以下哪些操作：

1.  在 PROD 中修复它，然后合并到 HEAD
2.  在 HEAD 中修复它，然后合并到 PROD

(1) 的优点是，这样您绝对不会通过意外从 HEAD 引入未经测试的代码来损害已发布的版本（假设 PROD 总是比 HEAD 更稳定/经过测试）。

(2) 的优点是一段代码在 HEAD 中的用法可能比在 PROD 中更多，因此如果您仅在 PROD 中修复，您可能无法找到所有此类用法，因此会将错误放入 HEAD。

我个人赞成（1）。你怎么看？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T08:30:22.347

错误修复应应用于分支并合并到开发主线。您需要这样做以避免将不打算存在的新功能引入生产版本。请注意，如果您需要在 HEAD 中进行更改，最简单的方法可能是在两个分支中应用相同的更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T08:45:18.417

(1) 也一样。

不要忘记，**不是每个修复到 PROD 中的错误都必须合并回 HEAD**中。

有时，您当前的代码已经以这样的方式发展，修复到 PROD 中的错误不再相关。

# .net - Wcf 客户端

> ID：313675
> 
> 赞同：2
> 
> 时间：2008-11-24T08:36:56.110
> 
> 标签：.net

“客户端无法检索服务元数据。确保服务正在运行并公开元数据”此错误发生在 .net 2008 中，同时执行 wcf 应用程序。我用的是wcf服务库模板？报错是什么原因？IIS必须为此吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T21:24:57.747

You have to enable metadata publishing on the server-side first.

See:

*   [https://blogs.msdn.com/brajens/archive/2007/04/26/accessing-description-metadata-wsdl-of-wcf-web-service.aspx](https://blogs.msdn.com/brajens/archive/2007/04/26/accessing-description-metadata-wsdl-of-wcf-web-service.aspx)
*   [http://www.request-response.com/blog/PermaLink,guid,c9513d28-f580-4a33-b4e8-c15476799a9d.aspx](http://www.request-response.com/blog/PermaLink,guid,c9513d28-f580-4a33-b4e8-c15476799a9d.aspx)

You can expose either WSDL or MEX or both.

Or else you must share the metadata before hand, i.e. use the same interface on both side of the wire.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T09:34:05.840

它必须允许匿名访问，并发布“mex”端点。如果（作为临时措施）您在 IIS 中托管服务并导航到 .svc，它将为您提供有关如何发布“mex”的详细说明。

或者只是启动一个干净的 WCF 项目来获取此信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T21:22:52.790

This really bugged me too but I think I got it fixed, if not solved.

**Quick answer:** Exclude every .cs file from the project that is not related to the service itself. Especially unit tests should be in a separate project.

**What did I try?**

I first tried to check namespaces according to [Julie Lerman's blog post](http://www.thedatafarm.com/blog/2008/01/18/mydumbwcflessonfortheday.aspx). It didn't help.

Second, I created a new WCF project and copied the original code piece by piece. Everything worked fine until I added a nunit test case .cs file and got the error. I changed the namespace of the test class but this didn't help. I tried to take the test methods out but even an empty test class triggered the error.

Finally, I excluded the test cases from the original project and it worked too.

I guess that something confuses the metadata generation here.

# ruby-on-rails - Rails 2.1+ 中的脚手架生成器问题

> ID：313679
> 
> 赞同：1
> 
> 时间：2008-11-24T08:41:29.113
> 
> 标签：ruby-on-rails

我安装了新的 Rails 2.2，事情是一切正常，直到我使用脚手架生成器。

```
$ script/generate scaffold pages \
  title:string description:string content:text

$ rake db:migrate 
```

但是当我使用这个地址启动服务器时：[http://localhost:3000/pages/](http://localhost:3000/pages/)我得到这个：

```
NoMethodError in PagesController#index
undefined method `find' for ActionController::Caching::Pages:Module

app/controllers/pages_controller.rb:5:in 'index'
/Library/Ruby/Gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:1253:in 'send'
/Library/Ruby/Gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:1253:in 'perform_action_without_filters'
/Library/Ruby/Gems/1.8/gems/actionpack-2.2.2/lib/action_controller/filters.rb:617:in 'call_filters'
... 
```

我无法理解我做错了什么？那是新的 Rails 特定的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T09:17:50.100

资源名称应为单数。所以试试

```
script/generate scaffold page title:string description:string content:text 
```

而不是**pages**。

此外，您对脚手架生成器的调用会创建 Pages 模型，该模型与您的控制器中可用的模块 ActionController::Caching::Pages 具有相同的名称，并且 Rails 会感到困惑（因为 Pages 模块没有 find 这样的方法）。

# c# - 如何在终端服务器上计算/保存 .NET 应用程序的内存使用量？

> ID：313691
> 
> 赞同：1
> 
> 时间：2008-11-24T08:46:59.490
> 
> 标签：c#, .net, terminal

我在 Citrix/Terminal Server 上做了一些 C# fat 应用程序。

如何测量每个会话的实际内存使用情况？我能做些什么来减少总内存使用量？

我们仍在开发 .NET 1.1。如果我们升级我们的 .NET 运行时会有什么不同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T01:37:32.757

在 .NET 中获取实际内存使用情况的指标非常困难。通过调用 Marshal.SizeOf()，您可以获得的最接近的近似值是基于每个对象。我对这种方法的理解是，它本质上是在测量对象的序列化版本的大小，内存中的占用空间可能接近这个值，并不准确。但它是一个很好的估计。

您可能还想研究 .NET 下的 SMS API。它们提供了从操作系统查询有关您的进程（或其他进程）的各种内存统计信息的方法。它与“perfmon”使用的库相同。您可以使用它以编程方式检查您的流程。

此外，您还需要购买一个好的 .NET 分析工具。我已经评估了 ANTS 和 dotTrace。他们都很好。我更喜欢 dotTrace 的简单性。大多数分析器都有非常不直观的界面。这正是我所期待的。按照这些标准，dotTrace 实际上相当不错。我认为 ANTS 可能更先进（不确定，只是我对它们进行的简短评估的意见）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T09:23:58.620

这是来自 MSDN[的一篇关于测量应用程序性能的文章。](http://msdn.microsoft.com/en-us/library/ms998579.aspx)它包括对内存使用情况进行测量。

我认为升级 .NET 运行时不会对应用程序产生重大影响，您最好以其他方式优化应用程序。尝试在不需要时处理资源。

# c# - 我想在后台运行程序。首选 C#

> ID：313693
> 
> 赞同：2
> 
> 时间：2008-11-24T08:48:44.107
> 
> 标签：c#

我想在后台运行程序。pref C# 我想将图标放在托盘中。在指定时间同步文件夹（我知道如何同步文件夹）。如何在后台运行它并开始同步（例如凌晨 2 点）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T08:56:59.643

您需要考虑使用[windows 调度程序服务](http://msdn.microsoft.com/msdnmag/issues/07/10/WindowsCPP/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T21:05:44.783

好吧，如果你从一个 Windows 窗体应用程序开始，并希望它在后台运行，挂在系统托盘上，你必须创建系统托盘，在 Application.Run(MainForm) 之前隐藏主窗体，然后你就可以了.

要隐藏表单，我使用：

```
MainForm.WindowState = System.Windows.Forms.FormWindowState.Minimized;
MainForm.ShowInTaskBar = false; 
```

（因为设置 visible= false 将被 Run() 方法重新打开。）

要创建系统托盘，我使用了[此处](http://alanbondo.wordpress.com/2008/06/22/creating-a-system-tray-app-with-c/)的说明：

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T08:57:14.150

“在后台”运行

```
Form.Visible = False
Form.ShowInTaskbar = False 
```

要开始同步，请使用计时器并...

*   每分钟检查一次时间，如果时间匹配则开始同步
*   或计算间隔 Now->TimeToStart，设置它，启动 Timer，并在第一个滴答时将其重置为 24 小时

如果您希望它只是一个后台进程，您也可以考虑创建一个服务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T08:57:57.613

我经常在我的 Visual Studio 附带的应用程序上使用通知图标，[http://www.developer.com/net/csharp/article.php/3336751](http://www.developer.com/net/csharp/article.php/3336751)至于开始同步，你可以在另一个线程上调用一个函数来测量每秒计时一次，如果是凌晨 2 点，您可以在另一个线程中调用另一个函数来同步文件夹（您也可以使用计时器组件）。

资源：

通知图标： http: [//www.developer.com/net/csharp/article.php/3336751](http://www.developer.com/net/csharp/article.php/3336751)

C# 线程：[http ://www.albahari.com/threading/](http://www.albahari.com/threading/)

计时器组件： http: [//msdn.microsoft.com/en-us/library/system.windows.forms.timer.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.aspx)和[http://www.codeproject.com/KB/miscctrl/TimeSheet.aspx](http://www.codeproject.com/KB/miscctrl/TimeSheet.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T09:23:41.727

如果我是你，我会使用 Windows 中的调度程序服务。

拥有一项服务、在托盘中保留一个图标等意味着您将占用宝贵的屏幕空间并消耗资源。更重要的是，用户将需要某种方式来配置应用程序，以便他们可以选择是否从 Windows 启动；如果您提供此配置，它必然与其他所有应用程序的配置方式不同。

另一方面，调度程序任务只需要一个进程 - 任务调度程序本身 - 用户可以自己禁用或删除任务。例如，Apple 和 Google 自动更新程序现在都以这种方式运行。

# shared-hosting - 设置内容服务器

> ID：313701
> 
> 赞同：3
> 
> 时间：2008-11-24T08:54:52.360
> 
> 标签：shared-hosting, content-management

这更像是一个策略问题，而不是“代码帮助”问题。

我有一个内容服务器，需要为各种共享主机提供内容，我很想知道你们将如何设置它。我们希望将内容“缓存”在服务器上，使其看起来是静态的（并减少内容服务器上的负载）。

任何帮助，将不胜感激。基本问题是关于如何交付和处理共享主机的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T09:46:25.657

通常的方法是使用[rsync](http://www.samba.org/rsync/)使“从”服务器与“主”服务器保持同步。然后将从站配置为简单地显示本地文件。rsync 将确保文件被有效和正确地复制（包括时间戳和权限）。它还将确保客户看不到部分文件，它会返回有用的错误代码，以及许多只有几十年来一直这样做的人才会想到的问题。

# c++ - 在linux下用c ++ ping的最佳方法是什么？

> ID：313712
> 
> 赞同：8
> 
> 时间：2008-11-24T08:59:19.293
> 
> 标签：c++, linux

我必须从 C++ 代码中调用 ping。我想轻松读取输出以供进一步使用。

我想出了两个解决方案：

*   使用叉子和管道，将 ping 输出重定向到管道，然后解析它
*   找到一个适合直接使用 ping(ip_addresss) 函数的库

我想要后者，但我没有找到任何明显是标准解决方案的东西。

你会怎么做？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-24T09:45:56.173

从教育的角度来看，调用外部二进制文件是非常**不可取**的。特别是对于发送 ICMP 回显请求这样的简单任务，您应该学习一点套接字。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-22T15:05:16.843

```
#include <fcntl.h>
#include <errno.h>
#include <sys/socket.h>
#include <resolv.h>
#include <netdb.h>
#include <netinet/in.h>
#include <netinet/ip_icmp.h>

#define PACKETSIZE  64
struct packet
{
    struct icmphdr hdr;
    char msg[PACKETSIZE-sizeof(struct icmphdr)];
};

int pid=-1;
struct protoent *proto=NULL;
int cnt=1;

/*--------------------------------------------------------------------*/
/*--- checksum - standard 1s complement checksum                   ---*/
/*--------------------------------------------------------------------*/
unsigned short checksum(void *b, int len)
{
    unsigned short *buf = b;
    unsigned int sum=0;
    unsigned short result;

    for ( sum = 0; len > 1; len -= 2 )
        sum += *buf++;
    if ( len == 1 )
        sum += *(unsigned char*)buf;
    sum = (sum >> 16) + (sum & 0xFFFF);
    sum += (sum >> 16);
    result = ~sum;
    return result;
}

/*--------------------------------------------------------------------*/
/*--- ping - Create message and send it.                           ---*/
/*    return 0 is ping Ok, return 1 is ping not OK.                ---*/
/*--------------------------------------------------------------------*/
int ping(char *adress)
{
    const int val=255;
    int i, sd;
    struct packet pckt;
    struct sockaddr_in r_addr;
    int loop;
    struct hostent *hname;
    struct sockaddr_in addr_ping,*addr;

    pid = getpid();
    proto = getprotobyname("ICMP");
    hname = gethostbyname(adress);
    bzero(&addr_ping, sizeof(addr_ping));
    addr_ping.sin_family = hname->h_addrtype;
    addr_ping.sin_port = 0;
    addr_ping.sin_addr.s_addr = *(long*)hname->h_addr;

    addr = &addr_ping;

    sd = socket(PF_INET, SOCK_RAW, proto->p_proto);
    if ( sd < 0 )
    {
        perror("socket");
        return 1;
    }
    if ( setsockopt(sd, SOL_IP, IP_TTL, &val, sizeof(val)) != 0)
    {
        perror("Set TTL option");
        return 1;
    }
    if ( fcntl(sd, F_SETFL, O_NONBLOCK) != 0 )
    {
        perror("Request nonblocking I/O");
        return 1;
    }

    for (loop=0;loop < 10; loop++)
    {

        int len=sizeof(r_addr);

        if ( recvfrom(sd, &pckt, sizeof(pckt), 0, (struct sockaddr*)&r_addr, &len) > 0 )
        {
            return 0;
        }

        bzero(&pckt, sizeof(pckt));
        pckt.hdr.type = ICMP_ECHO;
        pckt.hdr.un.echo.id = pid;
        for ( i = 0; i < sizeof(pckt.msg)-1; i++ )
            pckt.msg[i] = i+'0';
        pckt.msg[i] = 0;
        pckt.hdr.un.echo.sequence = cnt++;
        pckt.hdr.checksum = checksum(&pckt, sizeof(pckt));
        if ( sendto(sd, &pckt, sizeof(pckt), 0, (struct sockaddr*)addr, sizeof(*addr)) <= 0 )
            perror("sendto");

        usleep(300000);

    }

    return 1;
}

/*--------------------------------------------------------------------*/
/*--- main - look up host and start ping processes.                ---*/
/*--------------------------------------------------------------------*/
int main(int argc, char *argv[])
{

    if (ping("www.google.com"))
        printf("Ping is not OK. \n");
    else
        printf("Ping is OK. \n");

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-24T09:02:21.817

我会选择你的第一个选择。Linux 是围绕着这样一个概念构建的，即拥有小型、专门的应用程序，这些应用程序可以很好地完成一件事，即与管道通信。您的应用程序不应包含用于实现 ping 的库，因为已经有一个内置命令可以执行此操作，而且效果非常好！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T09:44:02.200

查看 BusyBox 的[“ping”源](http://git.busybox.net/busybox/tree/networking/ping.c)- 您可以使用`ping4`和`ping6`函数。请注意 GPL。

生成 'ping' 也应该可以工作 - 查看`popen(2)`一个更简单的 API，它也运行一个 shell。如果有问题，`pipe`++`fork`应该`exec`可以工作。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-03T13:10:47.040

我设法做到了：

我使用 popen，它基本上创建了一个管道、fork 和 exec 然后，如果我需要，我可以用 pclose 等待。

# c# - 什么可能导致 Visual Studio / C# 错误 MSB3105：重复资源

> ID：313718
> 
> 赞同：12
> 
> 时间：2008-11-24T09:02:44.310
> 
> 标签：c#, visual-studio

在处理现有项目时，我在尝试编译解决方案时突然遇到以下错误：

*错误 MSB3105：在“资源”参数中多次指定了项目“[文件名]”。“资源”参数不支持重复项。*

现在，据我所知，我没有对影响资源的项目进行任何更改。我还检查了项目中的每个文件，但在任何地方都没有对该文件的重复引用。现在我已经找到了一些关于这个错误的论坛条目：

1) 打开 .csproj 文件并删除重复的引用。[试过这个，但我找不到任何重复项]

2）在“部分类”项目中，将所有内容移至一个类。[可以试试这个，但是项目从一开始就被分成了部分类，我不想仅仅因为错误而改变它]

那么还有什么可能导致这种情况呢？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-25T20:24:25.620

您是否尝试在解决方案资源管理器中显示所有文件？您可能在其中的某处有一个重复的 .rsx 文件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-28T07:21:57.833

[我在 Roy Green发布的 .NET 论坛](http://archives.devshed.com/forums/net-206/main-form-and-partial-class-1918921.html)中找到了答案，Theresa 毕竟是对的，尽管我不认识它。
如果您将主表单类拆分为部分类，则部分部分最终会作为单独的项目出现在解决方案资源管理器中。如果您双击它们，它们会以正常形式显示在设计器模式中。但是，如果您（不小心）在这些窗体上放置了一个控件，Visual Studio 会为其创建一个新的 .resx 文件和一个 InitializeComponent 例程。但由于此表单实际上只是 Main Form 类的一部分，因此会导致“重复资源”错误。除了删除 InitializeComponent 例程并手动删除 .resx 文件之外，没有其他解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-09T14:29:40.823

确保在 yourForm.cs 下没有定义重复的资源 (.resx)。如果您重命名了表单，请删除旧资源，因为在编译期间将使用新名称创建新资源。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-12-13T03:26:01.140

我只是犯了同样的错误。删除mainform.designer.vb，然后我又从回收站恢复了，编译的时候发现这个错误信息。我尝试在谷歌上搜索，有人建议检查 .vbproj。这样做并在某些行上找到了重复项。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-24T14:29:32.670

我也有这个，在VB中。有“真实形式”文件 frmMain，然后我创建了新的类文件并将它们修改为**Partial Public Class frmMain**。例如，我有一个**ImportFromExcel.vb** Partial Class 文件（我不想用相当复杂的 Excel 导入代码弄乱**frmMain.vb 。）**

一切正常，直到我决定要在 Sub **ImportFromExcel中使用****OpenFileDialog**。我将 OFD 从工具箱拖到**ImportFromExcel**文件的设计器视图中。 *（我不知道为什么这个视图存在，如果你不能用它做任何事情！）* 但无论如何......将 OFD 拖到 Partial Class Designer 创建了一个**ImportFromExcel.resx**文件。拖放操作还在**ImportFromExcel**中创建了 InitializeComponent 子，这是多余的并显示错误 - 只需稍加编辑即可轻松纠正。

 *******最终，我选择不使用拖动的资源，而是将代码本地化到**ImportFromExcel.vb**文件中。

您真正需要做的就是右键单击**ImportFromExcel.resx**文件，然后选择删除。其他一切似乎都在“自我修复”，并且现在构建良好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-01-27T15:59:40.893

就我而言，发生此问题是因为 GIT 存储库中的文件具有相同的名称但大小写不同。例如`MyFile.cs`和`myFile.cs`。

如果您在 Windows 上进行结帐，则其中一个文件会被另一个文件覆盖（没有消息，没有警告）。所以，它正在编译，我们没有注意到任何东西。但是，如果您尝试在 Linux（使用 .NET Core）上编译，这两个文件都存在，并且在编译时会出现此错误。

# javascript - GoogleMaps getLatLng 你是说建议吗

> ID：313722
> 
> 赞同：2
> 
> 时间：2008-11-24T09:04:44.820
> 
> 标签：javascript, google-maps, google-api

我正在尝试将该功能集成到地图中，您可以在其中输入地址并在地图上放置一个标记。但是使用 Google Maps getLatLng 如果地址名称有轻微错误，它就不再起作用了，你的意思是功能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T09:11:55.493

[“您的意思是？”的 API 教程](http://econym.googlepages.com/didyoumean.htm)

# c# - 如何在 .net 中实现和扩展 Joshua 的构建器模式？

> ID：313729
> 
> 赞同：19
> 
> 时间：2008-11-24T09:12:31.017
> 
> 标签：c#, .net

*   我们如何在 C#中实现[Joshua 的 Effective Java的 Builder 模式？](http://developers.sun.com/learning/javaoneonline/2006/coreplatform/TS-1512.pdf?)

下面是我尝试过的代码，有没有更好的方法来做到这一点？

```
 public class NutritionFacts
    {
        public static NutritionFacts.Builder Build(string name, int servingSize, int servingsPerContainer)
        {
            return new NutritionFacts.Builder(name, servingSize, servingsPerContainer);
        }

        public sealed class Builder
        {
            public Builder(String name, int servingSize,
            int servingsPerContainer)
            {
            }
            public Builder totalFat(int val) { }
            public Builder saturatedFat(int val) { }
            public Builder transFat(int val) { }
            public Builder cholesterol(int val) { }
            //... 15 more setters
            public NutritionFacts build()
            {
                return new NutritionFacts(this);
            }
        }
        private NutritionFacts(Builder builder) { }
        protected NutritionFacts() { }
    } 
```

*   我们如何扩展这样的类？我们是否需要为每个派生类编写单独的构建器类？

    ```
    public class MoreNutritionFacts : NutritionFacts
    {
        public new static MoreNutritionFacts.Builder Build(string name, int servingSize, int servingsPerContainer)
        {
            return new MoreNutritionFacts.Builder(name, servingSize, servingsPerContainer);
        }
        public new sealed class Builder
        {
            public Builder(String name, int servingSize,
            int servingsPerContainer) {}
            public Builder totalFat(int val) { }
            public Builder saturatedFat(int val) { }
            public Builder transFat(int val) { }
            public Builder cholesterol(int val) { }
            //... 15 more setters
            public Builder newProperty(int val) { }
            public MoreNutritionFacts build()
            {
                return new MoreNutritionFacts(this);
            }
        }
        private MoreNutritionFacts(MoreNutritionFacts.Builder builder) { }
    } 
    ```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-24T09:32:13.860

在 Protocol Buffers 中，我们实现了这样的构建器模式（大大简化）：

```
public sealed class SomeMessage
{
  public string Name { get; private set; }
  public int Age { get; private set; }

  // Can only be called in this class and nested types
  private SomeMessage() {}

  public sealed class Builder
  {
    private SomeMessage message = new SomeMessage();

    public string Name
    {
      get { return message.Name; }
      set { message.Name = value; }
    }

    public int Age
    {
      get { return message.Age; }
      set { message.Age = value; }
    }

    public SomeMessage Build()
    {
      // Check for optional fields etc here
      SomeMessage ret = message;
      message = null; // Builder is invalid after this
      return ret;
    }
  }
} 
```

这与 EJ2 中的模式不太一样，但是：

*   构建时不需要数据复制。换句话说，当你设置属性时，你是在真实的对象上这样做的——你只是还看不到它。这类似于做什么`StringBuilder`。
*   构建器在调用`Build()`以保证不变性后变得无效。不幸的是，这意味着它不能像 EJ2 版本那样用作一种“原型”。
*   在大多数情况下，我们使用属性而不是 getter 和 setter - 这非常适合 C# 3 的对象初始化程序。
*   我们还为`this`C#3 之前的用户提供了返回的 setter。

我还没有真正研究过构建器模式的继承——协议缓冲区无论如何都不支持它。我怀疑这很棘手。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T10:05:36.883

[此博客条目](http://elegantcode.com/2008/04/26/test-data-builders-refined/)可能会引起您的兴趣

C# 中模式的一个巧妙变体是使用隐式强制转换运算符来使对 Build() 的最终调用变得不必要：

```
public class CustomerBuilder
{

   ......     

   public static implicit operator Customer( CustomerBuilder builder ) 
   {  
      return builder.Build();
   } 
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-26T01:54:37.700

**Edit:** I used this again and simplified it to remove the redundant value-checking in setters.

I recently implemented a version that is working out nicely.

Builders are factories which cache the most recent instance. Derived builders create instances and clear the cache when anything changes.

The base class is straightforward:

```
public abstract class Builder<T> : IBuilder<T>
{
    public static implicit operator T(Builder<T> builder)
    {
        return builder.Instance;
    }

    private T _instance;

    public bool HasInstance { get; private set; }

    public T Instance
    {
        get
        {
            if(!HasInstance)
            {
                _instance = CreateInstance();

                HasInstance = true;
            }

            return _instance;
        }
    }

    protected abstract T CreateInstance();

    public void ClearInstance()
    {
        _instance = default(T);

        HasInstance = false;
    }
} 
```

The problem we are solving is more subtle. Let's say we have the concept of an `Order`:

```
public class Order
{
    public string ReferenceNumber { get; private set; }

    public DateTime? ApprovedDateTime { get; private set; }

    public void Approve()
    {
        ApprovedDateTime = DateTime.Now;
    }
} 
```

`ReferenceNumber` does not change after creation, so we model it read-only via the constructor:

```
public Order(string referenceNumber)
{
    // ... validate ...

    ReferenceNumber = referenceNumber;
} 
```

How do we reconstitute an existing conceptual `Order` from, say, database data?

This is the root of the [ORM](http://en.wikipedia.org/wiki/Object-relational_mapping) disconnect: it tends to force public setters on `ReferenceNumber` and `ApprovedDateTime` for technical convenience. What was a clear truth is hidden to future readers; we could even say it is an incorrect model. (The same is true for extension points: forcing `virtual` removes the ability for base classes to communicate their intent.)

A `Builder` with special knowledge is a useful pattern. An alternative to nested types would be `internal` access. It enables mutability, domain behavior (POCO), and, as a bonus, the "prototype" pattern mentioned by Jon Skeet.

First, add an `internal` constructor to `Order`:

```
internal Order(string referenceNumber, DateTime? approvedDateTime)
{
    ReferenceNumber = referenceNumber;
    ApprovedDateTime = approvedDateTime;
} 
```

Then, add a `Builder` with mutable properties:

```
public class OrderBuilder : Builder<Order>
{
    private string _referenceNumber;
    private DateTime? _approvedDateTime;

    public override Order Create()
    {
        return new Order(_referenceNumber, _approvedDateTime);
    }

    public string ReferenceNumber
    {
        get { return _referenceNumber; }
        set { SetField(ref _referenceNumber, value); }
    }

    public DateTime? ApprovedDateTime
    {
        get { return _approvedDateTime; }
        set { SetField(ref _approvedDateTime, value); }
    }
} 
```

The interesting bit is the `SetField` calls. Defined by `Builder`, it encapsulates the pattern of "set the backing field if different, then clear the instance" that would otherwise be in the property setters:

```
 protected bool SetField<TField>(
        ref TField field,
        TField newValue,
        IEqualityComparer<T> equalityComparer = null)
    {
        equalityComparer = equalityComparer ?? EqualityComparer<TField>.Default;

        var different = !equalityComparer.Equals(field, newValue);

        if(different)
        {
            field = newValue;

            ClearInstance();
        }

        return different;
    } 
```

We use [`ref`](http://msdn.microsoft.com/en-us/library/14akc2c7.aspx) to allow us to modify the backing field. We also use the default equality comparer but allow callers to override it.

Finally, when we need to reconstitute an `Order`, we use `OrderBuilder` with the implicit cast:

```
Order order = new OrderBuilder
{
    ReferenceNumber = "ABC123",
    ApprovedDateTime = new DateTime(2008, 11, 25)
}; 
```

This got really long. Hope it helps!

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-12T19:45:59.400

使用 Joshua Bloch 的构建器模式的原因是为了从部分中创建一个复杂的对象，同时使其不可变。

在这种特殊情况下，在 C# 4.0 中使用可选的命名参数更为简洁。您放弃了一些设计灵活性（不要重命名参数），但您会获得更好的可维护代码，更容易。

如果 NutritionFacts 代码是：

```
 public class NutritionFacts
  {
    public int servingSize { get; private set; }
    public int servings { get; private set; }
    public int calories { get; private set; }
    public int fat { get; private set; }
    public int carbohydrate { get; private set; }
    public int sodium { get; private set; }

    public NutritionFacts(int servingSize, int servings, int calories = 0, int fat = 0, int carbohydrate = 0, int sodium = 0)
    {
      this.servingSize = servingSize;
      this.servings = servings;
      this.calories = calories;
      this.fat = fat;
      this.carbohydrate = carbohydrate;
      this.sodium = sodium;
    }
  } 
```

然后客户会将其用作

```
 NutritionFacts nf2 = new NutritionFacts(240, 2, calories: 100, fat: 40); 
```

如果构造更复杂，则需要对其进行调整；如果卡路里的“构建”不仅仅是输入一个整数，那么可以想象需要其他辅助对象。

# java - 在生产服务器上启用 jmx（lambda 探针）是个好主意吗？

> ID：313730
> 
> 赞同：25
> 
> 时间：2008-11-24T09:14:10.340
> 
> 标签：java, performance, security, tomcat, jmx

我们在运行在 Sun VM 1.5.0_06-b05 上的 Tomcat 5.5.17 上部署的 Web 应用程序遇到了一些减速，并且我们的托管公司没有提供足够的数据来发现问题。

我们正在考虑在生产服务器上安装[lambda 探针](http://www.lambdaprobe.org)，但它需要启用 JMX (com.sun.management.jmxremote) 以获得内存和 CPU 统计信息。

启用 JMX 会导致严重的性能损失吗？

如果我们启用 JMX，我们是否会打开任何安全漏洞？如果我们只启用对 JMX 的本地访问，是否需要设置安全身份验证？

是否有人使用相同的（tomcat + lambda 探针）在生产中没有问题？

### 更新

查看答案似乎单独启用 JMX 不会对 VM 产生重大开销。如果附加到 VM 的监视应用程序（无论是*JConsole*、*lambda 探针*还是任何其他应用程序）过度投入地轮询，则可能会产生额外的工作。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-24T21:34:49.130

您可以使用安全身份验证消除安全漏洞。仅保持 JMX 服务就绪不会产生任何重大开销，通常是一个好主意。[这里](http://weblogs.java.net/blog/emcmanus/archive/2006/07/how_much_does_i.html)有一个关于这个的基准。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-11T00:41:08.560

JMX 的开销很低，您可以通过使用 SSL 和身份验证来修复安全性。设置 -Dcom.sun.management.jmxremote.ssl=true 和 -Dcom.sun.management.jmxremote.authenticate=true

有关设置证书等的更多信息，请参见此处[。](http://java.sun.com/j2se/1.5.0/docs/guide/management/agent.html)

当您开始检测代码时，开销成为一个问题。开销可能很大，并且检测可能会影响应用程序的行为。你不会看到你得到了什么，即所谓的[海森堡效应](http://en.wikipedia.org/wiki/Uncertainty_principle)。

如果您想要低开销，我会使用[JRockit](http://www.oracle.com/technology/products/jrockit/missioncontrol/index.html)附带的工具。他们捎带 JVM 一直收集的信息。JVM 会统计哪些方法运行得最多，以决定它应该优化哪些方法。JVM 还跟踪内存使用/模式以决定选择哪个 gc-stategy。JRockit 将此类数据公开给 JRockit 工具，而不会增加您通常会从单独的[JMVTI](http://java.sun.com/j2se/1.5.0/docs/guide/jvmti/index.html) -agent 获得的检测开销。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T09:34:50.503

JMX 只是一个等待连接并允许外部进程访问无论如何收集的数据的套接字。这样做的惩罚通常非常低（当然，除非你用请求锤击 JMX 服务器）。

JMX 允许您深入了解 Java VM。有一些命令可以运行 GC 并将其关闭。也就是说，JMX 提供了一种使用公钥和身份验证的安全连接模式。请阅读文档以获取详细信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-27T20:13:27.577

我们在生产服务器中使用 lambda 探针，我们没有看到任何显着的开销。我可以推荐将探针作为可用于生产的可靠产品（Tomcats 5.5 和 6.0、JDK 5 和 JDK 6）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T15:40:29.140

这取决于 JMX 实现以及您想要监控的东西的成本。我现在至少有一个 JMX 应用程序，它具有比较高的内存开销。

# c# - 访问DataList.ItemCreatedCommand中的DropDownList.SelectedIndex（EventBubbling或其他解决方案）

> ID：313735
> 
> 赞同：0
> 
> 时间：2008-11-24T09:21:47.407
> 
> 标签：c#, asp.net, drop-down-menu, event-bubbling

我如何冒泡在下拉列表中更改 itemIndex 时引起的事件 - 以便我可以在我的 ItemCreatedCommand 函数中使用 itemindex-value？

在以下位置找到解决方案：

[http://209.85.129.132/search?q=cache:cYDzeE8Swf0J:authors.aspalliance.com/hmcheung/Articles/030331/Default.aspx+dropdownlist+datalist+selectedindex&hl=no&ct=clnk&cd=11&gl=no&client=firefox-a](http://209.85.129.132/search?q=cache:cYDzeE8Swf0J:authors.aspalliance.com/hmcheung/Articles/030331/Default.aspx+dropdownlist+datalist+selectedindex&hl=no&ct=clnk&cd=11&gl=no&client=firefox-a)

*   但这是在 VB.net 中，我对 VB.net 的“讲”不够好，无法将其复制到 C#。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T11:41:38.233

据我所知，这是不可能的 - 必须冒泡到 ItemCommand，而不是 ItemCreated-command。因此，让您处理事件并获取作为 datalistitem 的 senders.parent。

# winforms - 如何防止 Winforms 控件监听键盘

> ID：313737
> 
> 赞同：2
> 
> 时间：2008-11-24T09:22:07.157
> 
> 标签：winforms, controls, click, key, enter

对于某种输入形式，我想让键盘输入成为可能。我知道如何通过 KeyPressed 和 KeyUp 读取键，但问题是当控件获得焦点并且用户按下 Enter 键时，该控件会收到 Click 事件。是否可以防止这种行为？或者是否有可能知道鼠标或键盘是否触发了 Click 事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T09:30:09.717

这有帮助吗？来自[Microsoft 知识库](http://kbalertz.com/955938/Remove-ability-keyboard-trigger-button-click.aspx)

> 将 Button 的代码从 button.Click() 移动到 button.MouseClick()

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T09:58:15.370

如果你能描述你想要的情况和确切的行为，这会更容易...... :)

您可以设置：

```
Form.KeyPreview = True 
```

这会首先将 Key Events 发送到 Form，然后再发送到 Control。这使您有机会在表单上捕获关键事件并“取消”它们：

```
e.Handled = True 
```

[更多信息](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.keypreview.aspx)

还要确保您没有为表单设置 AcceptButton！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T09:33:31.003

您还可以侦听键盘事件并过滤掉键。

# perl - 有没有用 Perl 编写的类似 cron 的服务？

> ID：313746
> 
> 赞同：2
> 
> 时间：2008-11-24T09:31:50.070
> 
> 标签：perl, cron

我正在考虑在 Perl 中创建一个允许用户创建错误监视器的 Web 应用程序。所以基本上每个“bug watch”都是一个bug ID，它将与“sleep”时间一起传递给子例程，一旦“sleep time”结束，它必须在不阻塞父进程或对等进程的情况下再次出现。

*   我试过[Schedule::Cron](http://search.cpan.org/dist/Schedule-Cron)。它支持类似 cron 的格式，但这里 subs 的参数必须是简单的标量，因此我排除了它。

*   POE/Coro 似乎是另一种选择，但我对此不太了解/ :(

有什么见解吗？TIA

-马特。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T10:13:17.787

Schedule::Cron 有什么问题？您可以创建任何您喜欢的子例程引用，因此您可以创建引用您需要的额外或特定数据的闭包。您不必依赖参数列表。该模块是否还有其他不适合您的地方？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T15:39:58.830

> 我尝试了 Schedule::Cron。它支持类似 cron 的格式，但这里 subs 的参数必须是简单的标量，因此我排除了它。

Schedule::Cron 文档说*arguments*是*对包含在调用 subroutine 时使用的参数的数组的引用*。如果您愿意，可以传递对参数的命名数组的引用。由于 cron 条目包含对 @data 的引用，因此您可以根据需要在代码中添加或删除 @data 元素。

```
$cron->add_entry(
    '* * * * *',
    subroutine => \&mysub,
    arguments => \@data,
); 
```

正如布赖恩建议的那样，您也可以使用闭包：

```
my $var = 42;
my @arr = get_stuff();

$cron->add_entry(
    '* * * * *',
    sub { mysub($var, @arr) },
); 
```

有关闭包的更多信息，请参见[perlref](http://perldoc.perl.org/perlref.html)手册页。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T12:17:42.310

如果您确实决定研究[Coro](http://search.cpan.org/dist/Coro/Coro.pm)，那么可能值得一看[Continuity](http://search.cpan.org/dist/Continuity/lib/Continuity.pm)，因为这是一个围绕 Coro 构建的 Web 库/框架。

另请查看默认情况下“蹲”在[Continuity](http://search.cpan.org/dist/Squatting/lib/Squatting/On/Continuity.pm)之上的[Squatting](http://search.cpan.org/dist/Squatting/lib/Squatting.pm) web microframework 。Squatting 发行版附带了一些使用[Coro::Event](http://search.cpan.org/dist/Coro/Event/Event.pm)的示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T11:05:07.247

@(brian d foy)：我认为 Schedule::Cron 对我有好处的原因 1：$cron->add_entry 似乎没有为我提供将 @arrays/$vars 传递给潜艇的选项。

$cron->add_entry("$temp",{'subroutine' => \&test1,'arguments' => \@array}); 不被允许。

2：我不确定是否有办法在 cron->run(detach=>1); 之后添加新的 cron 条目 已被解雇而没有重新启动脚本..

# .net - 字符数组到一个类

> ID：313753
> 
> 赞同：3
> 
> 时间：2008-11-24T09:37:15.257
> 
> 标签：.net, c++, managed

我有一个来自文件或网络的传入字节流（无符号字符）。我需要将这些数据放在一个类中，并且正在寻找一种 NET 方式来执行此操作。

我敢打赌，有些人总是这样做，所以我想有比使用 BitConverter 更好的方法来做到这一点。

我意识到我提供的信息太少了。让我尝试一个示例类：

```
class data { 
void doSmething(); 
int var1; 
float var2; 
} 
```

然后我想通过 f.ex 传输这个类中包含的数据（var1 和 var2）。一个网络套接字并在另一端接收数据

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T09:49:27.120

正如乔恩所提到的，尚不清楚您需要什么。也许您在谈论也许您正在寻找的是[二进制序列化？](http://msdn.microsoft.com/en-us/library/72hyey7b(VS.71).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T09:44:13.883

尚不完全清楚您的意思，但是如果您基本上是在寻找一种缓冲数据的方法以便以后可以使用，那么[MemoryStream](http://msdn.microsoft.com/en-us/library/system.io.memorystream.aspx)可能是您最好的选择。将所有数据写入其中，然后将[Position](http://msdn.microsoft.com/en-us/library/system.io.memorystream.position.aspx)设置为 0，您可以再次读取数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T10:16:36.517

您有 2 个选项或二进制序列化（如 PiRX 所说）或 XML 序列化，为了性能，二进制更好，但我更喜欢 xml 序列化的可读性：

```
 [Serializable]
    [XmlRoot("CONFIGURATION")]
    public class Configuration
    {
        EnterpriseCollection enterprises;
        public Configuration()
        {

            enterprises= new EnterpriseCollection();
        }
        [XmlElement("ENTERPRISE")]
        public EnterpriseCollection Enterprises
        {
            get
            {
                return this.enterprises;
            }
            set
            {
                this.enterprises = value;
            }
        }
        private string name;
        [XmlElement("NAME")]
        public string Name
        {
            get
            {
                return name;
            }
            set
            {
                name = value;
            }
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T01:40:02.520

您可以使用 std::string 类。它的一个构造函数将 char* 作为参数，因此您可以直接从 char* 转到字符串。string 是存储字符串的好方法。 有关字符串的更多信息，请访问[http://www.cppreference.com/](http://www.cppreference.com/)

# delphi - 将控制集中在调整大小上的首选方式

> ID：313754
> 
> 赞同：5
> 
> 时间：2008-11-24T09:38:31.103
> 
> 标签：delphi, vcl

当父级更改宽度或高度时，您首选的保持控件以父级为中心的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T10:11:26.573

如果“居中”是指“它已经在中间，并且您想将其保留在那里而不调整其大小”，则删除所有锚点。如果应该调整大小，gabr 的解决方案是:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-24T09:49:24.827

将控件的 Anchors 属性设置为 [akLeft, akTop, akRight, akBottom]。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T10:49:52.160

如果您的意思是一种“更新，请稍候......”类型的东西，我在 Form 的 OnResize 事件中手动移动它。这使我可以在设计过程中保持面板不碍事，并正常隐藏，但我可以在需要时使其可见。

```
procedure TMyForm.FormResize(Sender: TObject);
var
  nNewTop : Integer;
begin
  inherited;
  pnlRegenerating.Left := (ClientWidth - pnlRegenerating.Width) div 2;
  nNewTop := (ClientHeight div 5) {* 4};
  if (nNewTop + pnlRegenerating.Height) > ClientHeight then
    nNewTop := ClientHeight - pnlRegenerating.Height - 4;
  pnlRegenerating.Top := nNewTop;
end; 
```

# multilingual - 多语言项目的最佳实践

> ID：313756
> 
> 赞同：0
> 
> 时间：2008-11-24T09:40:39.883
> 
> 标签：multilingual

有没有人有这样做的经验？我现在正在使用 C++ 开发 Java 反编译器，但希望使用更高级别的语言来执行内部树的实际转换。我很好奇在语言之间编组数据的开销是否值得使用更具表现力的语言来更好地表达我想要完成的事情（如 Haskell）。这实际上是在“现实世界”中完成的，还是通常在项目开始时选择一种语言并坚持下去？尝试过的人有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T09:47:14.050

我大力提倡始终为每个挑战选择正确的编程语言。如果有另一种语言可以轻松处理一些其他棘手的任务，我会说去吧。

它发生在现实世界中吗？是的。我目前正在开发一个由 PHP 和 Objective-c 代码组成的项目。

正如您所指出的，诀窍在于两种语言之间的交流。如果可能的话，让每种语言都坚持自己的领域，并让两个部分以最简单的方式进行交流。在我的例子中，它是通过 http 发送的 XML 文档。在您的情况下，某种格式化的文本文件可能是答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T09:47:29.260

编组成本取决于您使用的语言和架构。例如，如果您在 CLR 或 JVM 上，则有可用的低成本互操作解决方案 - 尽管我知道您可能正在使用非托管 C++。

另一种途径是嵌入式领域特定语言。树转换通常可以通过模式匹配和应用相对少量的函数来表达。您可以考虑编写一个简单的树模式匹配器 - 例如，看起来像 Lisp s-exprs 但使用占位符来捕获变量的东西 - 具有关联的操作，这些操作是转换匹配的子树的函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T10:18:04.330

[Tcl/Tk](http://www.tcl.tk/)的发明者[John Ousterhout](http://en.wikipedia.org/wiki/Ousterhout%27s_dichotomy)是多语言编程的坚定拥护者，并写了很多关于它的文章。为了做到这一点，您需要在您使用的语言之间建立一个干净的接口机制。有很多机制可以做到这一点。执行此操作的不同机制的示例如下：

*   [SWIG（Simplified Wrapper and Interface Generator](http://www.swig.org/)）可以获取 ac 或 c++（或其他几种语言）头文件，并为 perl 或 python 等高级语言生成一个接口，允许您访问 API。还有其他系统使用这种方法.

*   Java 支持[JNI ，而 Python 的](http://en.wikipedia.org/wiki/Java_Native_Interface)[ctypes](http://python.net/crew/theller/ctypes/)、VisualWorks [DLL/C connect](http://www.cincomsmalltalk.com/documentation/current/COMConnectGuide.pdf)等各种其他系统 都是本机机制，允许您显式构造对较低级别子系统的调用。

*   Tcl/Tk 被明确地设计为嵌入的，并且具有用于 C 库的[本地 API](http://wiki.tcl.tk/11541) 以将钩子添加到语言中。它的结构类似于 C 中的 argv[] 结构，旨在使基于命令行的 C 程序与 Tcl 的接口相对容易。这与上面的示例类似，但来自相反的方向。Python、Lua 和 Tcl 等许多脚本语言都支持这种机制。

*   Explicit glue mechanisms such as [Pyrex](http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/), which are similar to a wrapper generator, but have their own language for defining the interface. Pyrex is actually a complete programming language. Middleware such as [COM](http://msdn.microsoft.com/en-us/library/ctkast1b(VS.80).aspx) or [CORBA](http://www.omg.org/gettingstarted/corbafaq.htm) allow a generic interface definition to be built externally to the application in an [interface definition language](http://msdn.microsoft.com/en-us/library/aa367300(VS.85).aspx) and language bindings for the languages concerned to use the common interface mechanism.

# mysql - MYSQL - STRAIGHT_JOIN 在这段代码中做了什么？

> ID：313759
> 
> 赞同：12
> 
> 时间：2008-11-24T09:42:58.863
> 
> 标签：mysql, join

这段代码做了什么`STRAIGHT_JOIN`？

```
SELECT  STRAIGHT_JOIN ClosingBalance    
FROM   Accounts 
WHERE idAccounts = FidDebit; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-24T09:47:04.597

STRAIGHT_JOIN 旨在作为 MySQL 查询优化器的指令，表必须按照它们在查询中列出的顺序从左到右连接。

[http://dev.mysql.com/doc/refman/5.0/en/join.html](http://dev.mysql.com/doc/refman/5.0/en/join.html)

由于您在此查询中只有一个表，因此它似乎没有做任何事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T09:47:04.190

从[这里](http://dev.mysql.com/doc/refman/5.0/en/join.html)：

> STRAIGHT_JOIN 与 JOIN 类似，只是左表总是在右表之前读取。这可用于连接优化器以错误顺序放置表的那些（少数）情况。

# asp.net - 从 VS2008 发布的等效 msbuild 命令

> ID：313762
> 
> 赞同：6
> 
> 时间：2008-11-24T09:44:59.640
> 
> 标签：asp.net, visual-studio-2008, msbuild

任何想法哪个是在 msbuild 中发布的命令对应于 VS2008 中的命令？我想要的是结果输出是相同的，没有那个 _PublishedWebSites 子目录。这可以从命令行实现还是我应该使用构建文件？

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-25T09:54:17.093

通过指定 WebProjectOutputDir 属性解决了这个问题。
它看起来像这样：
MSBuild.exe /t:Rebuild "MyTestProject.sln" /p:OutDir=c:\Project\bin\ /p:WebProjectOutputDir=C:\Project\ /p:Configuration=Debug

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-02-27T11:23:36.293

您还可以查看这些博客文章：
- [http://blog.m.jedynak.pl/2008/03/publishing-web-application-with-msbuild.html](http://blog.m.jedynak.pl/2008/03/publishing-web-application-with-msbuild.html)
- [http://codingcockerel.co.uk/2008/ 05/18/如何发布-a-web-site-with-msbuild/](http://codingcockerel.co.uk/2008/05/18/how-to-publish-a-web-site-with-msbuild/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T09:57:53.247

你可以看看[Vs2008 Web Deployment](http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx "ScottGu 对此的评论")的东西。在下面，它使用[AspNetCompiler Task](http://msdn.microsoft.com/en-us/library/ms164291.aspx "MSDN 链接")，因此您可以将其破解到您的 .*proj 文件中。

# asp.net - 移动网站的日期选择器？

> ID：313769
> 
> 赞同：0
> 
> 时间：2008-11-24T09:46:48.857
> 
> 标签：asp.net, mobile, usability

允许用户从可用性角度从移动设备中选择日期的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-18T21:06:11.850

使用移动应用程序时，我讨厌任何形式的下拉选择列表。

不幸的是，三个单独的框（日、月和年）在 MIDP 配置文件设备上同样痛苦。

我几乎建议使用一个文本框，然后执行 a`DateTime.TryParse(String, out DateTime)`以获得结果。这允许他们输入任意数量的格式..并且大部分时间它都可以正常工作。

此外，如果您在表格上提示他们正确的格式（例如 2009 年 3 月 12 日），那么它可能就是他们使用的格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T12:53:00.820

您是否在 asp.net 中构建 WAP 页面？您在移动工具集中有一个 DatePicker 控件。在支持它的设备上，这将呈现为常规日期选择器（如在常规 asp.net 中），而在更有限的设备上，它将呈现为一系列选择器，您首先选择年份，然后是月份，最后是日期。除非您有充分的理由这样做，否则我认为您应该使用它。

# networking - iSeries v5r4 上的端口 443 被 Internet 客户端“过滤”，即使在防火墙规则中也是允许的。我怎样才能让它“开放”？

> ID：313777
> 
> 赞同：1
> 
> 时间：2008-11-24T09:49:44.997
> 
> 标签：networking, ibm-midrange

端口被 ISP 过滤。

问题是无法从 Internet 访问 HTTPS 443 端口，但它在我们的本地网络中是开放的。我们的 iSeries v5r4 通过没有 IPSec 的 L2TP 连接到 inet。如果没有数据包过滤器处于活动状态，nmap 会显示端口 25、80、110 甚至 10322（WAS 管理控制台）在 Internet IP 地址上处于“打开”状态。443 已“过滤”状态。

如果我激活以下数据包规则：

```
# -----------------------------------------------
# Statements to permit inbound HTTP over STATICIP
# -----------------------------------------------
INCLUDE   FILE = /QIBM/UserData/OS400/TCPIP/PacketRules/Services.i3p
FILTER SET HTTP_INBOUND   ACTION = PERMIT   DIRECTION = OUTBOUND   SRCADDR = *   DSTADDR = *   SERVICE = HTTP_80_FS   JRN = OFF
FILTER SET HTTP_INBOUND   ACTION = PERMIT   DIRECTION = INBOUND   SRCADDR = *   DSTADDR = *   SERVICE = HTTP_80_FC   JRN = OFF
FILTER SET HTTP_INBOUND   ACTION = PERMIT   DIRECTION = OUTBOUND   SRCADDR = *   DSTADDR = *   SERVICE = HTTP_443_FS   JRN = OFF
FILTER SET HTTP_INBOUND   ACTION = PERMIT   DIRECTION = INBOUND   SRCADDR = *   DSTADDR = *   SERVICE = HTTP_443_FC   JRN = OFF
FILTER_INTERFACE   INTERFACE = STATICIP   SET = HTTP_INBOUND
# ----------------------------------------------- 
```

端口 80 是“开放的”，443 是“过滤的”。

我怎样才能让它“开放”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T10:41:27.433

一些 ISP 过滤特定端口，例如用于过滤我的网络服务器的 RoadRunner。这很奇怪，因为 80 没有被过滤，但这是可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T15:39:18.427

[IBM 关于 IP 过滤和 NAT 的在线文档](http://publib.boulder.ibm.com/infocenter/iseries/v5r3/index.jsp?topic=/rzajb/rzajbrzajb0ippacketsecuritysd.htm)可能有助于解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T09:52:51.650

您应该配置防火墙以打开和关闭 TCP/IP 端口。

每个防火墙都有一个端口（或端口范围）列表，这些端口（或端口范围）为流量打开或关闭。请咨询您的防火墙/路由器文档或咨询您的系统管理员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T10:05:53.137

端口 443 是 SSL 端口，因此很可能您的防火墙或 iSeries 有一个需要设置的进一步过滤器以允许 ssl 流量到它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T11:51:28.370

感谢您的回答！防火墙配置为打开端口 80 和 443。但无论如何都会过滤 443。我们的 ISP 不过滤任何端口。

# c++ - 为 C/C++ 中的项目的 makefile 生成依赖项

> ID：313778
> 
> 赞同：39
> 
> 时间：2008-11-24T09:49:58.677
> 
> 标签：c++, c, makefile, dependencies

我有一个项目，其生成文件的依赖项已损坏。除了手动检查每个源文件或使用手写的 perl 脚本之外，是否有任何最知名的方法可以为我可以在 makefile 中使用的项目生成依赖项列表？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-11-24T09:56:04.327

[GNU make](https://make.mad-scientist.net/papers/advanced-auto-dependency-generation/#combine)的文档提供了一个很好的解决方案。

绝对地。`g++ -MM <your file>`将生成一个与 GMake 兼容的依赖项列表。我使用这样的东西：

```
# Add .d to Make's recognized suffixes.
SUFFIXES += .d

#We don't need to clean up when we're making these targets
NODEPS:=clean tags svn
#Find all the C++ files in the src/ directory
SOURCES:=$(shell find src/ -name "*.cpp")
#These are the dependency files, which make will clean up after it creates them
DEPFILES:=$(patsubst %.cpp,%.d,$(SOURCES))

#Don't create dependencies when we're cleaning, for instance
ifeq (0, $(words $(findstring $(MAKECMDGOALS), $(NODEPS))))
    #Chances are, these files don't exist.  GMake will create them and
    #clean up automatically afterwards
    -include $(DEPFILES)
endif

#This is the rule for creating the dependency files
src/%.d: src/%.cpp
    $(CXX) $(CXXFLAGS) -MM -MT '$(patsubst src/%.cpp,obj/%.o,$<)' $< -MF $@

#This rule does the compilation
obj/%.o: src/%.cpp src/%.d src/%.h
    @$(MKDIR) $(dir $@)
    $(CXX) $(CXXFLAGS) -o $@ -c $< 
```

**注意：** `$(CXX)` /`gcc`命令必须以[硬制表符开头](https://stackoverflow.com/questions/14109724/makefile-missing-separator)

这将自动为每个已更改的文件生成依赖项，并根据您现有的任何规则编译它们。这允许我将新文件转储到`src/`目录中，并自动编译它们、依赖项和所有内容。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-04-16T03:29:26.220

现在特别阅读[了这部分，](http://make.paulandlesley.org/autodep.html#combine)我认为有一个更简单的解决方案，只要你有一个合理的最新版本的 gcc/g++。如果您只是添加`-MMD`到您的`CFLAGS`，定义一个代表所有目标文件的变量`OBJS`，然后执行：

```
-include $(OBJS:%.o=%.d) 
```

那么这应该为您提供一个高效且简单的自动依赖构建系统。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-24T09:52:45.583

GNU C 预处理器 cpp 有一个选项 -MM，它根据包含模式生成一组合适的依赖项。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-24T21:04:28.947

我只是将它添加到 makefile 中，它工作得很好：

```
-include Makefile.deps

Makefile.deps:
    $(CC) $(CFLAGS) -MM *.[ch] > Makefile.deps 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T16:28:26.733

Digital Mars C/C++ 编译器带有一个[makedep](http://www.digitalmars.com/ctg/makedep.html)工具。

# c# - 使用自定义模式本地化日期时间

> ID：313781
> 
> 赞同：1
> 
> 时间：2008-11-24T09:52:47.940
> 
> 标签：c#, datetime, localization

我正在为使用自定义模式来格式化日期时间的应用程序进行本地化。

一个例子是：dd-MM HH:mm

我需要获取此自定义日期格式的本地化版本，以便使用数字和时间获取日期，基本上使用本地顺序（dd MM 或 MM dd）以及日期和时间的本地分隔符。

这很简单，只要我使用默认格式，但是一旦我偏离这些格式，格式就会变成硬编码。

有任何想法吗？

谢谢，乔纳斯

编辑：我有cultureInfo对象，问题是当我做一个DateTime.ToString（“ES-es”）时，我得到太多信息 - 我只需要月+日，但使用默认的ToString，我得到年+月+日

再次编辑：我了解如何更改我使用的每个 CultureInfo 对象的 ShortDate 模式。但是，在某些情况下，我还需要默认的 ShortDate 模式，因此不幸的是，更改它会给我留下另一个等效的问题。

最后编辑：以防万一。我从来没有找到解决方案，所以我最终编写了一个静态函数来检查当前的 CultureInfo，并返回格式正确的日期，无年份。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T10:28:15.403

查看 DateTimeFormatInfo 类（CultureInfo.DateTimeFormat 属性），特别是属性 DateSeparator、TimeSeparator、ShortDatePattern。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T10:06:46.023

也许你可以试试这个：

```
DateTime.Now.ToString(new System.Globalization.CultureInfo(Thread.CurrentThread.CurrentCulture.Name)); 
```

例如，如果我想显示特定文化的时间，我会这样做：

```
DateTime.Now.ToString(new System.Globalization.CultureInfo("ES-es")) 
```

文化信息充当 IFormatProvider。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-24T09:59:38.860

[CultureInfo](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx)类将是一个开始寻找的好地方。

# c# - 空数组的底层对象类型

> ID：313786
> 
> 赞同：4
> 
> 时间：2008-11-24T09:55:56.327
> 
> 标签：c#, reflection

嘿嘿，

假设我有一个看起来像这样的代码：

```
List<User> userList = GetUserByName (u => u.Name == name);
DoSomethingWithTheUsers (userList.ToArray ()); 
```

现在我想知道方法*DoSomethingWithTheUsers (object[] myObjects)中 Array 中对象的类型*

只需通过*myObjects.First ().GetType ()*完成，但如果数组为空怎么办？是否仍有可能获得 Type？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-24T09:57:17.383

数组类型将是一个用户数组，即User[]。为什么不在数组的 GetType() 上使用 Type.GetElementType() 呢？即使用您的示例：

```
myObjects.GetType().GetElementType() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T09:59:22.107

这就是我所期望的，但我想要的是： *用户* 我需要保存该类型的 FullName 以供以后使用，我想知道是否有更好的方法，然后通过字符串替换（或类似的方法）删除*[]*

# asp.net-mvc - 重定向到其他控制器中的操作

> ID：313789
> 
> 赞同：7
> 
> 时间：2008-11-24T09:57:13.997
> 
> 标签：asp.net-mvc, cross-controller-redirect

我想从一个控制器中的动作重定向到第二个控制器中的动作。通常我会使用 RedirectToAction("actionName", "controllerName", objects); 我要重定向到的方法有两个重载：

*   一种用于直接链接的 HttpVerbs.Get
*   一种用于 HttpVerbs.Post 接受通过模型绑定填充的引用类型

当我使用 RedirectToAction 方法进行重定向时，默认情况下我会重定向到 GET 方法，这当然与我的参数不匹配。
如何确保它重定向到正确操作的重载？

**--EDIT--**
根据要求提供一些更具体的细节：
我要重定向到的操作根据参数填充 viewData，然后调用正确的视图。

```
public ActionResult OverView(SearchBag searchBag, IngredientBag ingredientBag) { 
```

它有第二个 Gets 版本，因此它也可以通过 GET 工作：

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult OverView(int colorId, string paintCode, string name, int formulaId) {
    return OverView(new SearchBag() 
        { ColorId = colorId, PaintCode = paintCode, ColorName = name, FormulaId = formulaId }
            , formulaViewData.IngredientBag);
} 
```

我现在打电话的那个在另一个控制器中。它会进行一些预先计算，获取所需的信息，然后执行与之前的操作完全相同的操作。我可以从第一个动作中复制代码，但我宁愿只调用那个动作。

```
[AcceptVerbs(HttpVerbs.Post)]
public RedirectToRouteResult ReCalculate(SearchBag searchBag, IngredientBag ingredientBag) { 
```

我可以创建下一个控制器的临时本地实例，但我注意到它没有正确的 HTTPContext 并且没有命中初始化方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T10:30:59.623

您不能使用 RedirectToAction（或其他任何东西）使浏览器使用 HTTP POST 重定向。你也许可以用一些 JavaScript 来破解它，但它会很丑陋。

如果您可以提供有关您希望将用户重定向到的目标操作的更多详细信息，我们可以为您提供更好的答案。请使用目标操作的签名和您想要作为参数值提供的详细信息来更新您的问题，以便人们可以提供体面的指导。

我猜你想要做的是将一些数据存储在 TempData 中，调用 RedirectToAction，从目标 Controller/Action 中的 TempData 加载并处理。

有关 TempData 的更多信息，请参阅这些问题；[http://www.google.com/search?q=tempdata+site%3Astackoverflow.com](http://www.google.com/search?q=tempdata+site%3Astackoverflow.com)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-09T01:50:01.213

由于您已经填写了对象，因此您可能会考虑从第一个操作返回相同的视图，而不是重定向。

# delphi - 在 Vista Aero 上禁用进度条动画

> ID：313792
> 
> 赞同：9
> 
> 时间：2008-11-24T09:57:47.540
> 
> 标签：delphi, windows-vista, progress-bar, vcl, aero

我正在使用 Delphi 2009 VCL TProgressBar 作为一种“空/满”量规。

在 Vista 上，启用 Aero 主题时，它有一个与之相关的动画，这很烦人并且不适合仪表。

有没有办法禁用它（不是通过调整用户的主题设置！）以防止此控件上的动画？

为了澄清，我想要一些与 Windows 资源管理器中的“已用磁盘空间”表基本相同的东西。没有动画，但仍然有漂亮的边框和阴影效果。

更新：

我知道我需要一个“仪表”，而不是一个真正的进度条。如何使用标准 Windows 进度条控件实现主题仪表？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-24T15:08:07.240

根据[进度条的 Vista UI 指南，](http://msdn.microsoft.com/en-us/library/aa511486.aspx)您根本不应该将 TProgressBar 用于此类目的，它指出：

> 仅将进度条用于进度。使用仪表来指示与进度无关的百分比。

有很多针对流程自动化应用程序等的第三方组件（例如[Abakus VCL](http://www.abaecker.biz/)），也许您可​​以使用这些控件之一来代替？

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-24T22:33:47.607

您可以尝试关闭该控件的主题；

```
SetWindowTheme(ProgressBar.Handle, ' ', ' '); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-05-05T16:20:45.897

[在http://rmklever.com/](http://rmklever.com/?p=203)上试试 VistaProBar 它没有*与之*关联的动画。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-05T13:41:50.467

我还没有尝试过，但是这个问题看起来对winforms有一个有用的答案。

[如何使用仪表式进度条？](https://stackoverflow.com/questions/2671366/how-can-i-use-a-meter-style-progress-bar)

现在将其转换为Delphi ...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T21:37:34.943

看看[这个论坛主题](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=1127776&SiteID=1)。这是我发现的唯一有希望的链接，第一个帖子提到了不同的进度条状态，因此更改属性 Smooth、State 和 Style 可能无济于事。

如果上一篇文章中的提示确实是以仪表样式绘制进度条的唯一方法，那么您最好的选择是创建 TProgressBar 的后代类，覆盖 WM_PAINT 处理程序，检查 Vista 和启用的主题，然后case 使用 UxTheme 中的函数来绘制控件的不同部分。

# deployment - 如何以编程方式将 BIDS 工件部署到远程 SQL Server 实例？

> ID：313794
> 
> 赞同：5
> 
> 时间：2008-11-24T09:57:59.567
> 
> 标签：deployment, tfs, ssis, ssas, bids

我想按计划自动将我的 SSIS 和 SSAS 工件部署到远程开发 SQL Server 2005 和 2008 实例。

什么是最好的解决方案？我使用 TFS 2008 作为源代码控制系统，因此我想将该解决方案与 MSBuild 和计划的 Team Build 集成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T14:03:40.617

SSIS 是最简单的，当我使用 SSIS 时，我们将包存储在一个文件中，我们要做的就是将文件复制到 C:\Program Files\Microsoft SQL Server\90\DTS\Packages 中的正确目录。您可以通过将复制任务添加到 MSBuild 的末尾来执行此操作。我不确定 xml 在输出目录中是否默认可用，因此请注意。

至于 SSAS，我从来没有把它自动化，但是，你会想要查看分析管理对象 (AMO)，从网上的书籍中提取它说：

> 分析管理对象 (AMO) 为开发人员可用的 Analysis Services 的完整命令集提供了一个编程接口。因此，AMO 可用于部署，也可用于它所支持的许多管理命令。有关使用 AMO 自动执行任何类型的管理任务的更多信息，请参阅分析管理对象 (AMO)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-04T04:51:31.210

无法帮助 SSIS，但我可以帮助 SSAS 和 TFS 2010。

SSAS 项目不会在 2010 年使用 Team Build 构建。要使构建工作需要调用 devenv.exe 进行构建的 msbuild 项目，然后将文件复制到 Team Build 输出目录。

这是我之前使用过的示例项目：

```
 <Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
        <Target Name="Build">
             <PropertyGroup>
                  <DevEnvTool Condition="'$(DevEnvTool)'==''">C:\Program Files (x86)\Microsoft Visual Studio 9.0\Common7\IDE\devenv.exe</DevEnvTool>
                  <DevEnvBuildCommand>"$(DevEnvTool)" "$(MSBuildProjectDirectory)\Nexus_VS2008.sln" /Build</DevEnvBuildCommand>
             </PropertyGroup>
             <Exec Command="$(DevEnvBuildCommand)" />
             <ItemGroup>
                 <SSASSourceFiles Include="$(MSBuildProjectDirectory)\Readify.Nexus.Analysis\bin\Readify.Nexus.Analysis.*"/>
             </ItemGroup>

             <Copy SourceFiles="@(SSASSourceFiles)" DestinationFolder="$(OutDir)" />
        </Target>
    </Project> 
```

这将在 TFS 构建的放置文件夹中创建 SSAS 工件。使用一点 powershell，可以在 TFS Deployer 的帮助下创建和部署 SSAS 多维数据集。powershell 脚本至少需要执行“microsoft.analysisservices.deployment.exe”。该脚本还可用于更改 SSAS 的各种配置设置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T06:31:43.847

首先，我总是建议将构建和部署过程分开。它们不是一回事，分离使使用更成熟的配置管理工作流变得更容易。这方面的一个例子是能够将以前的构建（通过 systest 环境并给出全部清除）提升到 UAT 环境作为发布候选。您不想*重建*来执行此操作。捕获您的构建工件，并从它们单独部署。

反正...

SSIS 相当简单：所有构建实际上都是将包复制到输出文件夹中，因此您只需要以某种方式获取它们（取决于您用于构建的内容 - 我使用 TeamCity）。然后在您的部署过程中，您可以相当轻松地使用[SMO](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.dts.runtime.application.savetosqlserveras%28v=sql.105%29.aspx)将它们上传到 SSIS 服务器：

```
$app = new-object Microsoft.SqlServer.Dts.Runtime.Application
$app.SaveToSqlServerAs($packageObj, $null, "\\$folderName\$($packageObj.Name)$packageNameSuffix", $serverName, $null, $null); 
```

（有趣的是，这似乎不是通过 SSIS 服务本身，而是通过 MSDB 存储的 proc API。这两种方式都没有太大区别，但即使用户无法远程访问 SSIS 服务，它也可以工作，因为[那个 DCOM](http://social.msdn.microsoft.com/forums/en-US/sqlintegrationservices/thread/24eed7bd-b21a-4c64-9af2-8d0756ef727d/)问题）

SSAS 更难。虽然您可以使用[AMO](http://msdn.microsoft.com/en-us/library/ms146720%28v=sql.105%29)做很多事情，这是我部署的*一部分*，但我从来没有找到一种简单的方法来从解决方案构建中获取输出（如 .asdatabase 文件）并将它们转换为所需的 XMLA从头开始创建 olap 数据库模式。缺少一个转换，我懒得写。

相反，我使用[SSAS 部署实用程序](http://msdn.microsoft.com/en-us/library/ms162758%28v=sql.90%29.aspx)，它可以作为部署过程的一部分从命令行使用，*让它*生成 XMLA，然后执行它：

```
$asDeploy = "$programfiles32\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE\Microsoft.AnalysisServices.Deployment.exe"

write-host "Generating XMLA"
start-process -wait -FilePath:$asDeploy -ArgumentList:"$pwd\..\bin\MyOlap\MyOlap.asdatabase","/d","/o:$pwd\MyOlap.xmla"
if (-not $?){
    throw "Failed to generate XMLA: errors were reported above";
}

write-host "Deploying SSAS Database"
.\ascmd.exe -S $olapServer -i "$pwd\MyOlap.xmla"
if (-not $?){
    throw "Failed to deploy cube: errors were reported above";
} 
```

我确保上面的部署不处理多维数据集（我重写了 .deploymentoptions 文件），以便我可以随后使用 AMO 运行已部署的多维数据集，并根据该环境的需要更新数据源。*然后*我开始一个过程。

您没有问，但是对于 SSRS，您可以从构建中获取 RDL，并使用 web 服务 API 来部署它们，显然对于数据库，您将使用 SQL GDR 项目，并在那里使用命令行部署工具。总之，您可以从单个脚本部署整个 BI 项目，并对版本控制等进行相当严格的控制......

在过去 5 年左右的时间里，我在各种项目中使用了这些方法，并为此积累了一个非常有用的 PowerShell 库。有一天我会清理这些并释放它们。

[5 月 17 日]**注意：** SQL 2008 R2 版本的部署向导（在 SQL/100/ 文件夹中）被标记为 GUI 应用程序，而不是控制台应用程序（如 2005 年那样），因此之前编写的脚本没有不要等待它完成！上面的代码改为使用带有显式“-wait”的启动进程。这是一个[讨厌的问题](http://piers7.blogspot.com.au/2012/05/analysis-services-2008-r2-breaking.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-07T12:06:45.733

我发现很多帖子提倡使用脚本 VS 来自动化构建，这在 CI 环境中并不总是可行的。

通过更多的挖掘，我还发现了[http://sqlsrvanalysissrvcs.codeplex.com/](http://sqlsrvanalysissrvcs.codeplex.com/)，其中包含一个用于在 msbuild 中创建 .asdatabase 文件的 msbuild 任务。

# dependency-injection - 与城堡温莎的多接口注入

> ID：313796
> 
> 赞同：8
> 
> 时间：2008-11-24T09:59:05.743
> 
> 标签：dependency-injection, inversion-of-control, castle-windsor

当容器中有多个实现时，如何让 Castle Windsor 在运行时选择正确的接口植入。

例如，假设我有一个名为 IExamCalc 的简单界面，它可以计算某人在考试中的表现。

不，我们有几个这样的实现，例如，

```
public interface IExamCalc
{
    int CalculateMark(ExamAnswers examAnswers)
}

public class WritenExam : IExamCalc
{
    public int CalculateMark(ExamAnswers examAnswers)
    {
         return 4;
    }
}

public class OralExam : IExamCalc
{
    public int CalculateMark(ExamAnswers examAnswers)
    {
         return 8;
    }
}

public class ExamMarkService
{
    private IExamCalc _examCalc;
    public ExamMarkService(IExamCalc examCalc)
    {
        _examCalc = examCalc;
    }

    public int[] CalculateExamMarks(ExamAnswers[] examAnswers)
    {
        IList<int> marks = new List<int>;
        foreach(ExamAnswers examanswer in examaAnswers)
        {
            marks.Add(_examCalc.CalculateMark);
        }
    }
} 
```

假设正在通过 Windor 重新使用 ExamMarkService 我如何确保在构造函数中注入了正确的实现，这是多租户问题的一个例子吗？

希望一切都有意义

科林·G

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-25T23:32:11.077

正如大卫所说，你不能，但 IHandlerSelector 会让你控制。查看测试以了解如何使用它们：[https ://svn.castleproject.org/svn/castle/trunk/InversionOfControl/Castle.Windsor.Tests/HandlerSelectorsTestCase.cs](https://svn.castleproject.org/svn/castle/trunk/InversionOfControl/Castle.Windsor.Tests/HandlerSelectorsTestCase.cs)

基本上，您会执行以下操作：

```
public class WritenExamHandler : IHandlerSelector
    {
        public bool HasOpinionAbout(string key, Type service)
        {
            // Decision logic here
            return somethingThatWouldBeTrueToSelectWritenExam && service == typeof(IExamCalc);
        }

        public IHandler SelectHandler(string key, Type service, IHandler[] handlers)
        {
            return handlers.Where(handler => handler.ComponentModel.Implementation == typeof (WritenExam)).First();
        }
    } 
```

然后你注册它：

```
container.Kernel.AddHandlerSelector(new WritenExamHandler()); 
```

这将使您能够轻松处理多租户问题:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T10:41:55.797

多租户定义为能够在一个实例上运行您的软件，为多个租户/客户/客户提供服务。我猜你可能会在多租户设置中更频繁地遇到像你这样的问题。

您所有的组件都有唯一字符串的键，因此您可能总是这样`container.Resolve("someKey")`才能获得特定的实现。

如果你想自动注入一个特定的实现，你可以像这样配置你的组件（在我的记忆中，可能不是 100% 精确）：

```
<component id="someService.customer1" service="ISomeService" type="Customer1SomeService" />

<component id="anotherId" service="IAnotherService" type="AnotherService">
    <parameters>
        <parameterName> <!-- as written in the ctor's signature -->
           ${someService.customer1}
        </parameterName>
    </parameters> 
</component> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T10:03:28.010

简短的回答是，你不能。这种选择取决于应用程序代码，所以如果您只是这样做`container.Resolve<IExamCalc>`，那么温莎将无法知道您想要哪个。

要问的问题是*您*如何知道使用哪种类型？

# .net - 有人在 mscorwks.dll 中遇到过 INT 3 调试器中断吗？

> ID：313802
> 
> 赞同：4
> 
> 时间：2008-11-24T10:00:26.940
> 
> 标签：.net, delphi, winapi, debugging

我们将 .NET 运行时作为 Win32 程序的一部分托管，最近它开始在 mscorwks.dll 中的特定地址处持续中断。

在指定的地址，有一个 0xCC 字节，这是一条 INT 3 指令，它会触发调试器。

有没有其他人看过这个？

我在 dll 中看不到足够的信息来具体知道它在哪里，函数或源代码，但它绝对不在我们的任何库中。

调用堆栈如下所示（来自 Delphi 2007）：

```
:7a04f02a ; C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorwks.dll
:7a052fc6 ; C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorwks.dll
:7a053e72 ; C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorwks.dll
:7a03b970 ; C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorwks.dll
:7a00351e ; C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorwks.dll
:7a0255e0 ; C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorwks.dll
:79e71e6d ; C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorwks.dll
:7e42b372 USER32.MoveWindow + 0xd4
:7e4565b7 USER32.GetRawInputDeviceInfoW + 0x5f
:7e42ce7c USER32.SetLayeredWindowAttributes + 0x6a 
```

它失败的地址是 0x7A04F029，内存中的反汇编如下所示：

```
7A04F020 call $7a14be35
7A04F025 cmp [esi],ebx
7A04F027 jz $7a04f02a
7A04F029 int 3                      <-- here's the culprit
7A04F02A mov byte ptr [ebp-$04],$02
7A04F02E lea ecx,[ebp-$00000224]
7A04F034 call $79e82214 
```

摆脱它很容易，每次只需用 0x90 (NOP) 修补内存中的那个字节，但是下次我们启动调试器时，dll 当然会重新加载。

我想尝试修补文件本身，但我也不确定这是否是个好主意。我已经验证 CC 字节是 dll 的一部分，用十六进制编辑器找到了周围的字节模式。

有关如何解决此问题的任何提示？还有人看到这个吗？

## 解决了

正如答案中提到的，这是一个 LoaderLock 问题。在 Win32 中构建的 DLL 需要为我们的 .NET 系统公开几个函数，这与我们托管 .NET 运行时的方式无关。该项目包括几个单元，其中包含将要公开的函数，但不幸的是，还添加了许多在应用程序中有用的代码，但不适用于此 DLL。

分离出我需要的函数将 DLL 的大小从 7MB 减少到大约 100KB，并且还去掉了 LoaderLock。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T10:07:01.747

[这里](http://social.msdn.microsoft.com/forums/en-US/netfxbcl/thread/d2a864b0-339b-49d3-9c15-5b918f4bf711)有一个关于类似问题的讨论。最有趣的部分是：

> Mscorwks.dll 只是信使。它告诉你它检测到一个加载程序锁。是你的代码导致了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T10:22:13.637

您应该能够获得 mscorwks 的符号 - 我在这里有几个版本，所以 MS symserv 过去肯定为它们服务过。

这可能有助于更多地了解正在发生的事情。

从您在 USER32.dll 中跟踪的事实来看，我怀疑您已经配置了一些符号内容，但如果您没有配置，那么这可能会有所帮助： http: [//www.microsoft.com/whdc/devtools/debugging/调试启动.mspx](http://www.microsoft.com/whdc/devtools/debugging/debugstart.mspx)

我自己不使用 Delphi，但我猜它使用 dbghelp.dll 来做符号/PDB 的东西，所以即使它没有任何明确的 UI 来提供帮助，它也可以使用 symserv 进行设置。

# google-maps - 有没有办法在不让用户安装 Google Gears 的情况下获取用户的位置？

> ID：313805
> 
> 赞同：7
> 
> 时间：2008-11-24T10:04:04.843
> 
> 标签：google-maps, geolocation, google-gears

我不想让用户安装 Google Gears，这样我就可以告诉他他猜到的位置。有没有办法在不使用 Google Gears 的情况下获取位置？

我找到了[http://www.wipmania.com/de/blog/google-geolocation-api/](http://www.wipmania.com/de/blog/google-geolocation-api/)但它没有提供示例。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-24T11:39:04.183

Google 提供了一种通过[AJAX API loader](http://code.google.com/apis/ajax/documentation/#ClientLocation)获取用户位置的方法。这甚至可以在没有安装 Gears 的情况下工作。只需包含一个指向 JsAPI 的脚本标记：

```
<script type="text/javascript" 
   src="http://www.google.com/jsapi?key=ABCDEFG">
</script> 
```

当应用程序使用 AJAX API 加载器时，加载器会尝试根据客户端的 IP 地址对客户端进行地理定位。如果此过程成功，则在 google.loader.ClientLocation 属性中提供范围为 Metro 级别的客户端位置。如果进程找不到匹配项，则此属性设置为 null。

```
if (google.loader.ClientLocation){
  var center = new google.maps.LatLng(
    google.loader.ClientLocation.latitude,
    google.loader.ClientLocation.longitude
  );
  map.setCenter(center);
} 
```

填充后，google.loader.ClientLocation 对象将填充以下 Metro 级别粒度属性：

*   `ClientLocation.latitude`— 提供与客户端 IP 地址相关的低分辨率纬度
*   `ClientLocation.longitude`— 提供与客户端 IP 地址相关的低分辨率经度
*   `ClientLocation.address.city`— 提供与客户端 IP 地址关联的城市名称
*   `ClientLocation.address.country`— 提供与客户 IP 地址相关的国家名称
*   `ClientLocation.address.country_code`— 提供与客户端 IP 地址相关的 ISO 3166-1 国家代码的名称
*   `ClientLocation.address.region`— 提供与客户端 IP 地址关联的国家特定地区名称

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-24T10:08:36.223

这通常称为 IP 地理位置。

一个例子是[here](http://www.geody.com/geoip.php)。

问题是，大多数网站（如果您打算将其称为 Web 服务）会向您收费。否则，将抓取地理定位页面、解析它的地址并返回该信息的 Web 服务组合在一起。

在 PHP 中，这似乎工作得很好：

```
<?php
 if(isset($_GET["ip"])){
   echo geolocate($_GET["ip"]);
 }

 function geolocate($ip){
   $raw_html = file_get_contents("http://www.geody.com/geoip.php?ip=$ip");
   if(preg_match('/Location:(.*)/',$raw_html,$matches)){
     $location_raw = $matches[1];

     //Get rid of pesky HTML tags
     $location = preg_replace("/<[^>]*>/","",$location_raw);
     return $location;
   }else{
     return "ERROR";
   }
 } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-24T10:40:38.763

使用地理定位服务或图书馆需要注意的一件事是，它们永远不会 100% 准确。我们使用一个[IP2Location](http://www.ip2location.com/)，它实际上一直是我们客户服务部门投诉的稳定来源。我们正在寻找改变网站行为的方法，并权衡完全删除它的因素。

问题在于将 IP 与用户相关联的负担在于用户的 ISP。它们有大块的 IP 范围，并且它们注册哪些块属于特定位置。问题是 ISP 在移动区块或区块覆盖过大区域时通常不会更新此信息。

例如，我住在曼哈顿以北约 60 英里处，但我的 IP 经常显示我在芝加哥，使用大多数查找工具。我有 FIOS，并与其他几个确认相同行为的人交谈过。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-09T03:51:09.803

您可以为此目的使用 HTML5。这很简单。[这](http://www.w3schools.com/html5/html5_geolocation.asp)是示例。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-12T22:23:38.933

如果您的用户使用移动设备，[Xitfy](http://xtify.com)也是一个免费选项。他们有一个小客户端，用户同意后可以无缝安装到手机上。然后，您可以调用基于 REST 的 api 以从 gps / wifi 或手机信号塔获取准确的纬度/经度。

它们支持几乎涵盖所有智能手机的 Android、Windows Mobile、BlackBerry 和 Symbian。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-19T07:33:33.770

您可以使用这个简单的代码对 IP 地址进行地理编码。它工作得很好。试试这个：

```
function functionname(Your IP Here)
{

    $ip = $ClientIP;

    $json = file_get_contents("http://api.easyjquery.com/ips/?ip=".$ip."&full=true");

    $json = json_decode($json,true);

    return $json;
} 
```

# php - 面向对象的 PHP

> ID：313813
> 
> 赞同：-1
> 
> 时间：2008-11-24T10:10:08.403
> 
> 标签：php

```
<?php
class Box {
    var $contents;

    function Box($contents) {
        $this-&gt;contents = $contents;
    }

    function get_whats_inside() {
        return $this-&gt;contents;
    }
}
?> 
```

我正在学习一个 OO 教程。我熟悉 PHP 和 OO 的概念，但大多数时候它仍然是一场艰苦的斗争！但是，上面的代码返回错误“Unexpected & on line 7”。我找不到其他人对本教程有问题。我正在使用 php 版本 5.2.5 运行 MAMP。有人有想法么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T10:11:08.243

它应该读取 $this->contents 而不是 $this->contents

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T10:11:20.960

我想应该是

```
$this->contents = $contents;
return $this->contents; 
```

代替

```
$this-&gt;contents = $contents;
return $this-&gt;contents; 
```

似乎有一些HTML涉及......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T10:11:52.207

不知何故，您的代码已被 HTML 编码。

“>”应该是“>”符号

# winapi - 如何在 VC++ MFC GUI 中访问 win32 控制台应用程序数据

> ID：313814
> 
> 赞同：0
> 
> 时间：2008-11-24T10:10:17.623
> 
> 标签：winapi, visual-c++, mfc, console-application

我有两个应用程序：

1.  Win32 控制台应用程序。

2.  MFC GUI 应用程序。

我想在 MFC GUI 中执行控制台应用程序，我想从该控制台应用程序获取数据并在 GUI 中显示它们。

编译时出现此错误：

> 致命错误 C1189：#error：使用 /MD[d]（CRT dll 版本）构建 MFC 应用程序需要 MFC 共享 dll 版本。请#define _AFXDLL 或不要使用 /MD[d]

IPC 是答案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T10:32:17.423

您得到的构建错误与您要实现的目标无关。要在窗口中捕获控制台应用程序的输出，请参阅[CodeProject中的](http://www.codeproject.com/)[这篇](http://www.codeproject.com/KB/dialog/quickwin.aspx)优秀文章。

# c# - 如何在运行时修改 PropertyGrid（添加/删除属性和动态类型/枚举）

> ID：313822
> 
> 赞同：27
> 
> 时间：2008-11-24T10:14:04.777
> 
> 标签：c#, .net, winforms, propertygrid

如何在运行时以各种方式修改属性网格？我希望能够添加和删除属性并添加“动态类型”，我的意思是这种类型会导致使用 TypeConverter 在 propertygrid 中生成运行时下拉列表。

我实际上已经能够做这两件事（添加/删除属性和添加动态类型），但不能同时单独做。

为了实现在运行时添加和删除属性的支持，我使用[了这篇 codeproject 文章](http://www.codeproject.com/KB/tabs/Dynamic_Propertygrid.aspx?msg=1027628)并稍微修改了代码以支持不同的类型（不仅仅是字符串）。

```
private System.Windows.Forms.PropertyGrid propertyGrid1;
private CustomClass myProperties = new CustomClass();

public Form1()
{
    InitializeComponent();

    myProperties.Add(new CustomProperty("Name", "Sven", typeof(string), false, true));
    myProperties.Add(new CustomProperty("MyBool", "True", typeof(bool), false, true));
    myProperties.Add(new CustomProperty("CaptionPosition", "Top", typeof(CaptionPosition), false, true));
    myProperties.Add(new CustomProperty("Custom", "", typeof(StatesList), false, true)); //<-- doesn't work
}

/// <summary>
/// CustomClass (Which is binding to property grid)
/// </summary>
public class CustomClass: CollectionBase,ICustomTypeDescriptor
{
    /// <summary>
    /// Add CustomProperty to Collectionbase List
    /// </summary>
    /// <param name="Value"></param>
    public void Add(CustomProperty Value)
    {
        base.List.Add(Value);
    }

    /// <summary>
    /// Remove item from List
    /// </summary>
    /// <param name="Name"></param>
    public void Remove(string Name)
    {
        foreach(CustomProperty prop in base.List)
        {
            if(prop.Name == Name)
            {
                base.List.Remove(prop);
                return;
            }
        }
    } 
```

ETC...

```
public enum CaptionPosition
{
    Top,
    Left
} 
```

我的完整解决方案可以在[这里](http://helgo.net/salle/misc/PropertyGrid_2005.zip)下载。

当我添加字符串、布尔值或枚举时它工作正常，但是当我尝试添加像 StatesList 这样的“动态类型”时它不起作用。有谁知道为什么并且可以帮助我解决它？

```
public class StatesList : System.ComponentModel.StringConverter
{
    private string[] _States = { "Alabama", "Alaska", "Arizona", "Arkansas" };

    public override System.ComponentModel.TypeConverter.StandardValuesCollection
    GetStandardValues(ITypeDescriptorContext context)
    {
        return new StandardValuesCollection(_States);
    }

    public override bool GetStandardValuesSupported(ITypeDescriptorContext context)
    {
        return true;
    }

    public override bool GetStandardValuesExclusive(ITypeDescriptorContext context)
    {
        return true;
    }
} 
```

当您不尝试在运行时添加属性时，使用 TypeConverter 的方法可以正常工作，例如，[此代码](http://www.megasolutions.net/cSharp/PropertyGrid-dynamic-Dropdown-List-4124.aspx)可以正常工作，但我希望两者都能做到。

请看看[我的项目](http://helgo.net/salle/misc/PropertyGrid_2005.zip)。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-24T10:52:05.587

您所做的是将StatesList（一个TypeConverter）添加为属性。
您应该做的是添加一个以 StatesList 作为其 TypeConverter 的属性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-24T12:26:49.983

啊，当然！

```
myProperties.Add(new CustomProperty("Custom", "", typeof(States), false, true));

[TypeConverter(typeof(StatesList))]
public class States
{
} 
```

像魅力一样工作，谢谢！

我已经更新了我的项目，希望对其他人有所帮助，可以在[这里](http://helgo.net/salle/misc/DynamicPropertyGrid_Working.zip)找到。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-08-03T13:03:07.383

这个问题和答案对我很有用。但是，我需要通过允许运行时生成的下拉列表值来进一步扩展一些东西。我想我会发布一些关于它需要什么的示例代码，以防有人发现它有用。

首先，我在 CustomProperty 构造函数中添加了一个 options 参数，并添加了一个 Options 属性：

```
 private List<string> lOptions;

    public CustomProperty(string sName, object value, Type tType, bool bReadOnly, bool bVisible, List<string> lOptions)
    {
        this.lOptions = lOptions;
    }

    public List<string> Options
    {
        get { return lOptions; }
    } 
```

其次，我在 CustomPropertyDescriptor 类中添加了一个 Options 属性：

```
 public List<string> Options
    {
        get
        {
            return m_Property.Options;
        }
    } 
```

第三，我必须修改动态类型类（即 StatesList）中的 GetStandardValues 方法，以利用 CustomPropertyDescriptor 对象上的新 Options 属性：

```
 public override StandardValuesCollection
                 GetStandardValues(ITypeDescriptorContext context)
    {
        CustomPropertyDescriptor descriptor = (CustomPropertyDescriptor)context.PropertyDescriptor;
        return new StandardValuesCollection(descriptor.Options);
    } 
```

最后，在创建新的 CustomProperty 对象时，我必须传入我的选项列表：

```
 List<string> optionsList = new List<string>(new string[] { "test1", "test2", "test3" });        
    CustomProperty myProperty = new CustomProperty(attr.Name, attr.Value, valueType, false, true, optionsList); 
```

代替我在此示例中传递的静态列表，您可以以任何您喜欢的方式为您的下拉列表生成选项列表，让您完全控制可用的选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-26T07:44:45.467

就我而言，TypeConverter 不适用于 States 类

```
[TypeConverter(typeof(StatesList))] // not work
public class States
{
} 
```

所以我在 CustomPropertyDescriptor 中添加了覆盖

```
public override TypeConverter Converter
{
    get {
        if (this.PropertyType.Equals(typeof(States)) ) {
            return new StatesList(); ; 
        }
        return base.Converter;
    }
} 
```

# stack - 使用 OMP 的分段错误

> ID：313824
> 
> 赞同：2
> 
> 时间：2008-11-24T10:16:52.197
> 
> 标签：stack, overflow, openmp

全部！来自意大利的打字 如果矩阵大小小于 800 并且因分段错误而失败，则此小段代码有效。似乎问题出在堆栈大小......我该如何增加它？如何解决更大矩阵尺寸的问题？代码在串行放置中运行良好，在并行执行中失败。谢谢。

```
#include <omp.h>
#include <stdio.h>
#define Nu 4000
int main() {
float A[Nu][Nu],B[Nu][Nu],C[Nu][Nu];
int i,j;
#pragma omp parallel
printf("Hello from thread %d, nthreads %d\n", omp_get_thread_num(), omp_get_num_threads());
#pragma omp parallel for private(j,i) shared(A,B,C) schedule(static)
for(j=0;j<Nu;j++){
for(i=0;i<Nu;i++){
//printf("Hello from thread %d, i,j %d %d\n", omp_get_thread_num(),i,j );
A[i][j]=0;
B[i][j]=0;
C[i][j]=0;

}}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T10:21:23.793

OpenMP 中的默认堆栈大小为 4-8 MB。您可以更改一个名为 STACKSIZE 的环境变量（例如更改为 16384，即 16 MB）。[请参阅本 PDF](http://dlc.sun.com/pdf/819-3694/819-3694.pdf)的第 5-5 章。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T10:55:26.330

你真的必须在堆栈上分配矩阵吗？

您可以改用堆。对于大量内存，它甚至可以更有效（分配器实现可以使用诸如匿名 mmap 之类的东西，它允许在释放内存时将内存释放回操作系统）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-14T16:39:46.190

OpenMP 线程是使用由 OMP_STACKSIZE 环境变量定义的堆栈大小创建的（这是从 OpenMP 3.0 开始的标准）。如果环境变量不存在，则默认堆栈大小是特定于实现的。您可能宁愿将堆用于如此大的分配，但是想要更改 OpenMP 线程的堆栈大小可能有正当理由。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T16:16:34.850

您可以通过外壳调整堆栈大小

`'ulimit -s newstacksize'`

-- 尝试 1000000

# vb.net - 客户端调用同时调用另一个 Web 服务的 Web 服务时出现错误请求

> ID：313830
> 
> 赞同：2
> 
> 时间：2008-11-24T10:22:37.613
> 
> 标签：vb.net, web-services, .net-2.0

我有一个客户端应用程序调用本地网络中 server1 上 webservice1 上的函数 1。然后 webservice1 调用远程 server2 上的另一个 webservice2。

如果在 server1 上打开 Internet Explorer 并将其指向 webservice1 上的 function1 并运行该函数，一切正常。

但如果我从客户端计算机运行它，我会收到“错误请求”、“协议错误”。所有其他 web 服务功能在客户端上都可以正常工作，只有在另一台服务器上调用另一个函数的函数才会出现此错误。

是否有任何我必须处理的我不知道的安全上下文，或者你可以从我描述的内容中猜到的任何其他内容？

客户端是winXP和win2003，server1是物理win2008服务器上的虚拟2003服务器。

谷歌在这里帮不了我，我可以找到其他有同样问题但没有解决方案的人。

当我在我的开发设置中运行时（我的计算机上的 webservice1 和客户端，没有问题）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T11:07:00.300

确保您的第一个 Web 服务的匿名访问帐户 (IUSR_blahblahblah) 是有权访问第二个 Web 服务器的网络组的成员。

# powershell - 使用powershell，如何将“作为服务登录”授予帐户？

> ID：313831
> 
> 赞同：30
> 
> 时间：2008-11-24T10:23:56.487
> 
> 标签：powershell

我正在尝试使用 powershell 配置帐户凭据，但我需要授予帐户“作为服务登录”的权限才能使其正常工作。如何在 powershell 中执行此操作？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-01-20T13:33:46.110

下面的 Powershell 脚本会将 computerName 指定的主机上的 SeServiceLogonRight 授予*username*指定***的***用户*（*该脚本摘自此处：[https](https://gist.github.com/grenade/8519655) ://gist.github.com/grenade/8519655 ）：

 **```
<#
.Synopsis
  Grant logon as a service right to the defined user.
.Parameter computerName
  Defines the name of the computer where the user right should be granted.
  Default is the local computer on which the script is run.
.Parameter username
  Defines the username under which the service should run.
  Use the form: domain\username.
  Default is the user under which the script is run.
.Example
  Usage:
  .\GrantSeServiceLogonRight.ps1 -computerName hostname.domain.com -username "domain\username"
#>
param(
  [string] $computerName = ("{0}.{1}" -f $env:COMPUTERNAME.ToLower(), $env:USERDNSDOMAIN.ToLower()),
  [string] $username = ("{0}\{1}" -f $env:USERDOMAIN, $env:USERNAME)
)
Invoke-Command -ComputerName $computerName -Script {
  param([string] $username)
  $tempPath = [System.IO.Path]::GetTempPath()
  $import = Join-Path -Path $tempPath -ChildPath "import.inf"
  if(Test-Path $import) { Remove-Item -Path $import -Force }
  $export = Join-Path -Path $tempPath -ChildPath "export.inf"
  if(Test-Path $export) { Remove-Item -Path $export -Force }
  $secedt = Join-Path -Path $tempPath -ChildPath "secedt.sdb"
  if(Test-Path $secedt) { Remove-Item -Path $secedt -Force }
  try {
    Write-Host ("Granting SeServiceLogonRight to user account: {0} on host: {1}." -f $username, $computerName)
    $sid = ((New-Object System.Security.Principal.NTAccount($username)).Translate([System.Security.Principal.SecurityIdentifier])).Value
    secedit /export /cfg $export
    $sids = (Select-String $export -Pattern "SeServiceLogonRight").Line
    foreach ($line in @("[Unicode]", "Unicode=yes", "[System Access]", "[Event Audit]", "[Registry Values]", "[Version]", "signature=`"`$CHICAGO$`"", "Revision=1", "[Profile Description]", "Description=GrantLogOnAsAService security template", "[Privilege Rights]", "$sids,*$sid")){
      Add-Content $import $line
    }
    secedit /import /db $secedt /cfg $import
    secedit /configure /db $secedt
    gpupdate /force
    Remove-Item -Path $import -Force
    Remove-Item -Path $export -Force
    Remove-Item -Path $secedt -Force
  } catch {
    Write-Host ("Failed to grant SeServiceLogonRight to user account: {0} on host: {1}." -f $username, $computerName)
    $error[0]
  }
} -ArgumentList $username 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-03-03T19:20:52.003

这就是我解决它的方法：

依据：[本文](http://www.morgantechspace.com/2013/11/Set-or-Grant-Logon-As-A-Service-right-to-User.html)

你可以从这里下载[碳](http://get-carbon.org/)

首先导入 Carbon 模块如下：

```
Import-Module -Name $Path_To_Carbon -Global -Prefix CA

[array]$UserPrivileges = Get-CAPrivileges -Identity $UserName;
[bool]$LogOnAsAServiceprivilegeFound = $false;

if ($UserPrivileges.Length > 0)
{
    if ($UserPrivileges -contains "SeServiceLogonRight")
    {
        $LogOnAsAServiceprivilegeFound = $true;
    }
}

if ($LogOnAsAServiceprivilegeFound -eq $false)
{
    Grant-CAPrivilege -Identity $UserName "SeServiceLogonRight"
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-25T15:43:34.970

这是一个您也可以在 PS 中执行的链接：[原始](http://www.derkeiler.com/Newsgroups/microsoft.public.windowsxp.security_admin/2003-12/2865.html)| [存档](http://web.archive.org/web/20170421105857/http://www.derkeiler.com/Newsgroups/microsoft.public.windowsxp.security_admin/2003-12/2865.html)。

问题是实际上并没有任何公共 API 来管理这些设置，因此您在使用 ResKits 中提供的命令行工具时有点卡住了。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-06-07T14:13:20.877

这不是纯 PowerShell，但至少您不需要第三方工具。
一切都已经在您的计算机上，并且可以从命令行运行。

```
#Requires -RunAsAdministrator

#The SID you want to add
$AccountSid = 'S-1-5-21-1234567890-1234567890-123456789-500'

$ExportFile = 'c:\temp\CurrentConfig.inf'
$SecDb = 'c:\temp\secedt.sdb'
$ImportFile = 'c:\temp\NewConfig.inf'

#Export the current configuration
secedit /export /cfg $ExportFile

#Find the current list of SIDs having already this right
$CurrentServiceLogonRight = Get-Content -Path $ExportFile |
    Where-Object -FilterScript {$PSItem -match 'SeServiceLogonRight'}

#Create a new configuration file and add the new SID
$FileContent = @'
[Unicode]
Unicode=yes
[System Access]
[Event Audit]
[Registry Values]
[Version]
signature="$CHICAGO$"
Revision=1
[Profile Description]
Description=GrantLogOnAsAService security template
[Privilege Rights]
{0}*{1}
'@ -f $(
        if($CurrentServiceLogonRight){"$CurrentServiceLogonRight,"}
        else{'SeServiceLogonRight = '}
    ), $AccountSid

Set-Content -Path $ImportFile -Value $FileContent

#Import the new configuration 
secedit /import /db $SecDb /cfg $ImportFile
secedit /configure /db $SecDb 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2021-02-18T00:41:24.493

这个函数在简洁和实用之间取得了很好的平衡。在尝试授予权限之前，它会检查用户是否已经拥有该权限。

我没有对所有类型的特权进行测试，但它应该适用于大多数。

```
function Add-RightToUser([string] $Username, $Right) {
    $tmp = New-TemporaryFile

    $TempConfigFile = "$tmp.inf"
    $TempDbFile = "$tmp.sdb"

    Write-Host "Getting current policy"
    secedit /export /cfg $TempConfigFile

    $sid = ((New-Object System.Security.Principal.NTAccount($Username)).Translate([System.Security.Principal.SecurityIdentifier])).Value

    $currentConfig = Get-Content -Encoding ascii $TempConfigFile

    if ($currentConfig | Select-String -Pattern "^$Right .*$sid.*$") {
        Write-Host "Already has right"
    }
    else {
        Write-Host "Adding $Right to $Username"

        $newConfig = $currentConfig -replace "^$Right .+", "`$0,*$sid"

        Set-Content -Path $TempConfigFile -Encoding ascii -Value $newConfig

        Write-Host "Importing new policy on temp database"
        secedit /import /cfg $TempConfigFile /db $TempDbFile

        Write-Host "Applying new policy to machine"
        secedit /configure /db $TempDbFile /cfg $TempConfigFile

        Write-Host "Updating policy"
        gpupdate /force

        Remove-Item $tmp* -ea 0
    }
}

#Example
Add-RightToUser -Username 'MyDomain\MyUser' -Right 'SeServiceLogonRight' 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-01-30T07:02:58.707

有一个 Windows API 提供对本地安全策略的访问：`AdvAPI32.dll`和`Lsa*`方法。

您可以利用 PowerShell 将 .NET 类型添加到当前会话的能力，以及 .NET 的 P/Invoke 调用 Windows API，以便从 PowerShell 授予用户“作为服务登录”权限。

作为一个最小示例*，您首先需要将一些新的 .NET 类型添加到当前 PowerShell 会话以使用 Windows API：

```
Add-Type @'
using System;
using System.Runtime.InteropServices;

public enum LSA_AccessPolicy : long
{
    // Other values omitted for clarity
    POLICY_ALL_ACCESS = 0x00001FFFL
}

[StructLayout(LayoutKind.Sequential)]
public struct LSA_UNICODE_STRING
{
    public UInt16 Length;
    public UInt16 MaximumLength;
    public IntPtr Buffer;
}

[StructLayout(LayoutKind.Sequential)]
public struct LSA_OBJECT_ATTRIBUTES
{
    public UInt32 Length;
    public IntPtr RootDirectory;
    public LSA_UNICODE_STRING ObjectName;
    public UInt32 Attributes;
    public IntPtr SecurityDescriptor;
    public IntPtr SecurityQualityOfService;
}

public static partial class AdvAPI32 {
    [DllImport("advapi32.dll", SetLastError = true, PreserveSig = true)]
    public static extern uint LsaOpenPolicy(
        ref LSA_UNICODE_STRING SystemName,
        ref LSA_OBJECT_ATTRIBUTES ObjectAttributes,
        uint DesiredAccess,
        out IntPtr PolicyHandle);

    [DllImport("advapi32.dll")]
    public static extern Int32 LsaClose(IntPtr ObjectHandle);

    [DllImport("advapi32.dll", SetLastError = true, PreserveSig = true)]
    public static extern uint LsaAddAccountRights(
        IntPtr PolicyHandle,
        byte[] AccountSid,
        LSA_UNICODE_STRING[] UserRights,
        uint CountOfRights);
}
'@ 
```

然后，您需要打开本地安全策略的句柄：

```
function Get-LsaPolicyHandle() {
    $system = New-Object LSA_UNICODE_STRING
    $attrib = New-Object LSA_OBJECT_ATTRIBUTES -Property @{
        Length = 0
        RootDirectory = [System.IntPtr]::Zero
        Attributes = 0
        SecurityDescriptor = [System.IntPtr]::Zero
        SecurityQualityOfService = [System.IntPtr]::Zero
    };

    $handle = [System.IntPtr]::Zero

    $hr = [AdvAPI32]::LsaOpenPolicy([ref] $system, [ref]$attrib, [LSA_AccessPolicy]::POLICY_ALL_ACCESS, [ref]$handle)

    if (($hr -ne 0) -or ($handle -eq [System.IntPtr]::Zero)) {
        Write-Error "Failed to open Local Security Authority policy. Error code: $hr"
    } else {
        $handle
    }
} 
```

要添加新权限，您首先需要创建一个新权限：

```
function New-Right([string]$rightName){
    $unicodeCharSize = 2
    New-Object LSA_UNICODE_STRING -Property @{
        Buffer = [System.Runtime.InteropServices.Marshal]::StringToHGlobalUni($rightName)
        Length = $rightName.Length * $unicodeCharSize
        MaximumLength = ($rightName.Length + 1) * $unicodeCharSize
    }
} 
```

然后您可以将该权限添加到安全策略中：

```
function Grant-Rights([System.IntPtr]$policyHandle, [byte[]]$sid, [LSA_UNICODE_STRING[]]$rights) {
    $result = [AdvAPI32]::LsaAddAccountRights($policyHandle, $sid, $rights, 1)
    if ($result -ne 0) {
        Write-Error "Failed to grant right. Error code $result"
    } 
} 
```

因此，将它们放在一起，您就可以使用这些功能：

```
function Grant-LogonAsServiceRight([byte[]]$sid) { 
    $logonAsServiceRightName = "SeServiceLogonRight"

    try {
        $policy = Get-LsaPolicyHandle
        $right = New-Right $logonAsServiceRightName
        Grant-Rights $policy $sid @($right)
    }
    finally {
        if($null -ne $policy){
            [AdvAPI32]::LsaClose($policy) | Out-Null
        }
    }
} 
```

还有其他方法`AdvAPI32`可以枚举用户的帐户权限、删除权限等。

--

*我按照[Azure DevOps Pipeline Agent 存储库](https://github.com/microsoft/azure-pipelines-agent/blob/master/src/Agent.Listener/Configuration.Windows/NativeWindowsServiceHelper.cs)中的代码来了解如何使用`AdvAPI32`.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-04-08T19:01:42.243

使用碳！上面的一些建议已经过时了，这对我有用：

（在具有提升权限的 powershell 中）

```
Install-Module -Name 'Carbon' -AllowClobber
Import-Module 'Carbon'
$Identity = "<username>"
$privilege = "SeServiceLogonRight"
$CarbonDllPath = "C:\Program Files\WindowsPowerShell\Modules\Carbon\2.10.2\bin\fullclr\Carbon.dll"
[Reflection.Assembly]::LoadFile($CarbonDllPath)
[Carbon.Security.Privilege]::GrantPrivileges($Identity, $privilege) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-25T15:42:23.817

PowerShell 没有执行此操作的任何本机方法，这意味着您可能会查看 WMI 或 ADSI - 您更有可能在 VBScript 中找到示例，它已经存在了更长的时间，尽管我个人认为没有我曾经想出如何以编程方式分配用户权限。但这并不意味着它不能完成，但您可能会专门寻找 PowerShell 领域之外的东西。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-11-22T21:55:23.740

不导入整个数据库的解决方案

```
function setSecurityPolicy {
Param
(
    [Parameter(Mandatory=$true, Position=0)]
    [string] $username,
    [Parameter(Mandatory=$true, Position=1)]
    [string] $securityField
)
$sid;
if($username -like "*\*"){
    $user = $username.split('\')
    $domain=$user[0]
    $usernametemp=$user[1]
    $sid=(get-wmiobject Win32_useraccount -filter "name='$usernametemp' and Domain='$domain'").SID
} else {
    $sid=(get-wmiobject Win32_useraccount -filter "name='$username' and Domain='$($env:COMPUTERNAME)'").SID
}
if(-not($sid)){
    try{
        $sid= (Get-Localgroup "$username").SID.VALUE
    } catch{

    }
}

if(-not($sid)) {
    $Host.UI.WriteErrorLine("setSecurityPolicy error : Account $username not found!")
    exit 1
}
$tmp = [System.IO.Path]::GetTempFileName()
secedit.exe /export /cfg "$tmp" | Out-Null

$currentSetting = Select-String -Pattern "$securityField = (.*)" -path $tmp | select -Expand Matches |  % { $_.Groups[1].Value }
remove-item $tmp -Force

if($currentSetting -notlike  "*$sid*" ){
    Write-Host "Modify Setting ""$securityField"""
    if( [string]::IsNullOrEmpty($currentSetting) ) {
        $currentSetting = "*$sid"
    } else {
        $currentSetting = "*$sid,$currentSetting"
    }
    $outfile = @"
[Unicode]
Unicode=yes
[Version]
signature="`$CHICAGO`$"
Revision=1
[Privilege Rights]
$securityField = $currentSetting
"@
    $tmp2 = [System.IO.Path]::GetTempFileName()
    Write-Host "Import new settings to Local Security Policy"
    $outfile | Set-Content -Path $tmp2 -Encoding Unicode -Force

    try {
        secedit.exe /configure /db "secedit.sdb" /cfg "$tmp2" /areas USER_RIGHTS 
    } finally { 
        remove-item $tmp2 -Force
    }
}
}
#example usage
setSecurityPolicy -username 'IIS_IUSRS' -securityField 'SeServiceLogonRight'
setSecurityPolicy -username 'IIS_IUSRS' -securityField 'SeBatchLogonRight'
setSecurityPolicy -username 'IIS_IUSRS' -securityField 'SeImpersonatePrivilege' 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-01-06T19:42:27.687

扩展@Brendan Lane 的答案。

要为用户获取“Sid”，请使用此函数：

```
function Get-SidForUser {
    param ([string]$UserName)
    $sid = ((New-Object System.Security.Principal.NTAccount($UserName)).Translate([System.Security.Principal.SecurityIdentifier]))
    [byte[]]$bytes = New-Object byte[] $sid.BinaryLength;
    $sid.GetBinaryForm($bytes, 0);
    return $bytes
} 
```

把它们放在一起：

```
Grant-LogonAsServiceRight (Get-SidForUser -UserName $ServiceAccount) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-01-12T00:33:55.660

您可以使用以下脚本远程和本地修改安全策略，使用我的脚本，您可以针对多台机器、用户和用户权限运行： [链接到 GitHub 上的 Powershell 脚本](https://github.com/blakedrumm/SCOM-Scripts-and-SQL/blob/master/Powershell/General%20Functions/Add-UserRights.ps1)。

您可以将脚本复制并粘贴到 Powershell ISE，只需**编辑第 290 行** *（靠近脚本底部）*以包含所需的参数`-UserRight`。其他参数是可选的`-ComputerName`，`-UserName`：

```
<#
    .Synopsis
        Grant User Right(s) to defined user(s) and computer(s).

    .DESCRIPTION
        Add User Rights via Powershell.

    .Parameter ComputerName
        Defines the name of the computer where the user right should be granted. This can be multiple values, comma seperated.
        Default is the local computer on which the script is run.

    .Parameter Username
        Defines the Username under which the service should run. This can be multiple values, comma seperated.
        Use the form: domain\Username.
        Default is the user under which the script is run.

    .PARAMETER UserRight
        Defines the User Right you want to set. This can be multiple values, comma seperated.
        Name of the right you want to add to: SeServiceLogonRight
        There is no default for this argument

        Some (but not all) of the Options you can use:
            "Log on as a batch job (SeBatchLogonRight)"
            "Allow log on locally (SeInteractiveLogonRight)"
            "Access this computer from the network (SeNetworkLogonRight)"
            "Allow log on through Remote Desktop Services (SeRemoteInteractiveLogonRight)"
            "Log on as a service (SeServiceLogonRight)"
            "Deny log on as a batch job (SeDenyBatchLogonRight)"
            "Deny log on locally (SeDenyInteractiveLogonRight)"
            "Deny access to this computer from the network (SeDenyNetworkLogonRight)"
            "Deny log on through Remote Desktop Services (SeDenyRemoteInteractiveLogonRight)"
            "Deny log on as a service (SeDenyServiceLogonRight)"

    .Example
        Usage:
        Single Users
        Add User Right "Log on as a service" to CONTOSO\User:
        .\Add-UserRights.ps1 -Username CONTOSO\User -UserRight SeServiceLogonRight

        Add User Right "Log on as a batch job" to CONTOSO\User:
        .\Add-UserRights.ps1 -Username CONTOSO\User -UserRight SeBatchLogonRight

        Add User Right "Allow log on locally" to current user:
        .\Add-UserRights.ps1 -UserRight SeInteractiveLogonRight

        Multiple Users / Services / Computers
        Add User Right "Log on as a service" and "Log on as a batch job" to CONTOSO\User and run on, local machine and SQL.contoso.com:
        .\Add-UserRights.ps1 -UserRight SeServiceLogonRight, SeBatchLogonRight -ComputerName $env:COMPUTERNAME, SQL.contoso.com -UserName CONTOSO\User1, CONTOSO\User2

    .Notes
        Original Creator: Bill Loytty (weloytty)
        Based heavily on the script found here: https://github.com/weloytty/QuirkyPSFunctions/blob/ab4b02f9cc05505eee97d2f744f4c9c798143af1/Source/Users/Grant-LogOnAsService.ps1
        I modified to my own needs: https://github.com/blakedrumm/SCOM-Scripts-and-SQL/blob/master/Powershell/Add-UserRights.ps1

        My blog post: https://blakedrumm.com/blog/add-and-check-user-rights-assignment/#/

        Author: Blake Drumm (blakedrumm@microsoft.com)
        First Created on: January 5th, 2022
        Last Modified on: January 11th, 2022
#>
param
(
    [Parameter(Position = 0)]
    [Alias('computer')]
    [array]$ComputerName,
    [Parameter(Position = 1)]
    [Alias('user')]
    [array]$Username,
    [Parameter(Mandatory = $false,
               Position = 2)]
    [ValidateSet('SeAssignPrimaryTokenPrivilege', 'SeAuditPrivilege', 'SeBackupPrivilege', 'SeBatchLogonRight', 'SeChangeNotifyPrivilege', 'SeCreateGlobalPrivilege', 'SeCreatePagefilePrivilege', 'SeCreateSymbolicLinkPrivilege', 'SeDebugPrivilege', 'SeDelegateSessionUserImpersonatePrivilege', 'SeImpersonatePrivilege', 'SeIncreaseBasePriorityPrivilege', 'SeIncreaseQuotaPrivilege', 'SeIncreaseWorkingSetPrivilege', 'SeInteractiveLogonRight', 'SeLoadDriverPrivilege', 'SeManageVolumePrivilege', 'SeNetworkLogonRight', 'SeProfileSingleProcessPrivilege', 'SeRemoteInteractiveLogonRight', 'SeRemoteShutdownPrivilege', 'SeRestorePrivilege', 'SeSecurityPrivilege', 'SeServiceLogonRight', 'SeShutdownPrivilege', 'SeSystemEnvironmentPrivilege', 'SeSystemProfilePrivilege', 'SeSystemtimePrivilege', 'SeTakeOwnershipPrivilege', 'SeTimeZonePrivilege', 'SeUndockPrivilege', IgnoreCase = $true)]
    [Alias('right')]
    [array]$UserRight
)
BEGIN
{

    Write-Output '==================================================================='
    Write-Output '==========================  Start of Script ======================='
    Write-Output '==================================================================='

    $checkingpermission = "Checking for elevated permissions..."
    $scriptout += $checkingpermission
    Write-Output $checkingpermission
    if (-NOT ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator"))
    {
        $currentPath = $myinvocation.mycommand.definition
        $nopermission = "Insufficient permissions to run this script. Attempting to open the PowerShell script ($currentPath) as administrator."
        $scriptout += $nopermission
        Write-Warning $nopermission
        # We are not running "as Administrator" - so relaunch as administrator
        # ($MyInvocation.Line -split '\.ps1[\s\''\"]\s*', 2)[-1]
        Start-Process powershell.exe "-File", ('"{0}"' -f $MyInvocation.MyCommand.Path) -Verb RunAs
        break
    }
    else
    {
        $permissiongranted = " Currently running as administrator - proceeding with script execution..."
        Write-Output $permissiongranted
    }

    Function Time-Stamp
    {
        $TimeStamp = Get-Date -Format "MM/dd/yyyy hh:mm:ss tt"
        return "$TimeStamp - "
    }
}
PROCESS
{
    function Add-UserRights
    {
        param
        (
            [Parameter(Position = 0)]
            [Alias('computer')]
            [array]$ComputerName,
            [Parameter(Position = 1)]
            [Alias('user')]
            [array]$Username = ("{0}\{1}" -f $env:USERDOMAIN, $env:Username),
            [Parameter(Mandatory = $true,
                       Position = 2)]
            [ValidateSet('SeAssignPrimaryTokenPrivilege', 'SeAuditPrivilege', 'SeBackupPrivilege', 'SeBatchLogonRight', 'SeChangeNotifyPrivilege', 'SeCreateGlobalPrivilege', 'SeCreatePagefilePrivilege', 'SeCreateSymbolicLinkPrivilege', 'SeDebugPrivilege', 'SeDelegateSessionUserImpersonatePrivilege', 'SeImpersonatePrivilege', 'SeIncreaseBasePriorityPrivilege', 'SeIncreaseQuotaPrivilege', 'SeIncreaseWorkingSetPrivilege', 'SeInteractiveLogonRight', 'SeLoadDriverPrivilege', 'SeManageVolumePrivilege', 'SeNetworkLogonRight', 'SeProfileSingleProcessPrivilege', 'SeRemoteInteractiveLogonRight', 'SeRemoteShutdownPrivilege', 'SeRestorePrivilege', 'SeSecurityPrivilege', 'SeServiceLogonRight', 'SeShutdownPrivilege', 'SeSystemEnvironmentPrivilege', 'SeSystemProfilePrivilege', 'SeSystemtimePrivilege', 'SeTakeOwnershipPrivilege', 'SeTimeZonePrivilege', 'SeUndockPrivilege', IgnoreCase = $true)]
            [Alias('right')]
            [array]$UserRight
        )
        if (!$ComputerName)
        {
            $ComputerName = $env:ComputerName
        }
        foreach ($user in $Username)
        {
            foreach ($rights in $UserRight)
            {
                foreach ($computer in $ComputerName)
                {
                    if ($computer -match $env:COMPUTERNAME)
                    {
                        Function Time-Stamp
                        {
                            $TimeStamp = Get-Date -Format "MM/dd/yyyy hh:mm:ss tt"
                            return "$TimeStamp - "
                        }
                        $tempPath = [System.IO.Path]::GetTempPath()
                        $import = Join-Path -Path $tempPath -ChildPath "import.inf"
                        if (Test-Path $import) { Remove-Item -Path $import -Force }
                        $export = Join-Path -Path $tempPath -ChildPath "export.inf"
                        if (Test-Path $export) { Remove-Item -Path $export -Force }
                        $secedt = Join-Path -Path $tempPath -ChildPath "secedt.sdb"
                        if (Test-Path $secedt) { Remove-Item -Path $secedt -Force }
                        try
                        {
                            foreach ($right in $UserRight)
                            {
                                $UserLogonRight = switch ($right)
                                {
                                    "SeBatchLogonRight"                 { "Log on as a batch job (SeBatchLogonRight)" }
                                    "SeDenyBatchLogonRight"             { "Deny log on as a batch job (SeDenyBatchLogonRight)" }
                                    "SeDenyInteractiveLogonRight"       { "Deny log on locally (SeDenyInteractiveLogonRight)" }
                                    "SeDenyNetworkLogonRight"           { "Deny access to this computer from the network (SeDenyNetworkLogonRight)" }
                                    "SeDenyRemoteInteractiveLogonRight" { "Deny log on through Remote Desktop Services (SeDenyRemoteInteractiveLogonRight)" }
                                    "SeDenyServiceLogonRight"           { "Deny log on as a service (SeDenyServiceLogonRight)" }
                                    "SeInteractiveLogonRight"           { "Allow log on locally (SeInteractiveLogonRight)" }
                                    "SeNetworkLogonRight"               { "Access this computer from the network (SeNetworkLogonRight)" }
                                    "SeRemoteInteractiveLogonRight"     { "Allow log on through Remote Desktop Services (SeRemoteInteractiveLogonRight)" }
                                    "SeServiceLogonRight"               { "Log on as a service (SeServiceLogonRight)" }
                                    Default                             { "($right)" }
                                }
                                Write-Output ("$(Time-Stamp)Granting `"$UserLogonRight`" to user account: $Username on host: $computer.")
                                $sid = ((New-Object System.Security.Principal.NTAccount($Username)).Translate([System.Security.Principal.SecurityIdentifier])).Value
                                secedit /export /cfg $export | Out-Null
                                #Change the below to any right you would like
                                $sids = (Select-String $export -Pattern "$right").Line
                                foreach ($line in @("[Unicode]", "Unicode=yes", "[System Access]", "[Event Audit]", "[Registry Values]", "[Version]", "signature=`"`$CHICAGO$`"", "Revision=1", "[Profile Description]", "Description=Grant $UserLogonRight to $Username", "[Privilege Rights]", "$sids,*$sid"))
                                {
                                    Add-Content $import $line
                                }
                            }

                            secedit /import /db $secedt /cfg $import | Out-Null
                            secedit /configure /db $secedt | Out-Null
                            gpupdate /force | Out-Null
                            Write-Verbose "The script will not delete the following paths due to running in verbose mode, please remove these files manually if needed:"
                            Write-Verbose "`$import : $import"
                            Write-Verbose "`$export : $export"
                            Write-Verbose "`$secedt : $secedt"

                            if ($VerbosePreference.value__ -eq 0)
                            {
                                Remove-Item -Path $import -Force | Out-Null
                                Remove-Item -Path $export -Force | Out-Null
                                Remove-Item -Path $secedt -Force | Out-Null
                            }
                        }
                        catch
                        {
                            Write-Output ("$(Time-Stamp)Failure occurred while granting `"$right`" to user account: $Username on host: $computer.")
                            Write-Output $error[0]
                        }
                    }
                    else
                    {
                        Invoke-Command -ComputerName $Computer -Script {
                            param ([string]$Username,
                                [Parameter(Mandatory = $true)]
                                [array]$UserRight,
                                [string]$ComputerName,
                                [int]$VerbosePreference)
                            Function Time-Stamp
                            {
                                $TimeStamp = Get-Date -Format "MM/dd/yyyy hh:mm:ss tt"
                                return "$TimeStamp - "
                            }
                            $tempPath = [System.IO.Path]::GetTempPath()
                            $import = Join-Path -Path $tempPath -ChildPath "import.inf"
                            if (Test-Path $import) { Remove-Item -Path $import -Force }
                            $export = Join-Path -Path $tempPath -ChildPath "export.inf"
                            if (Test-Path $export) { Remove-Item -Path $export -Force }
                            $secedt = Join-Path -Path $tempPath -ChildPath "secedt.sdb"
                            if (Test-Path $secedt) { Remove-Item -Path $secedt -Force }
                            try
                            {
                                foreach ($right in $UserRight)
                                {
                                    $UserLogonRight = switch ($right)
                                    {
                                        "SeBatchLogonRight"                 { "Log on as a batch job (SeBatchLogonRight)" }
                                        "SeDenyBatchLogonRight"             { "Deny log on as a batch job (SeDenyBatchLogonRight)" }
                                        "SeDenyInteractiveLogonRight"       { "Deny log on locally (SeDenyInteractiveLogonRight)" }
                                        "SeDenyNetworkLogonRight"           { "Deny access to this computer from the network (SeDenyNetworkLogonRight)" }
                                        "SeDenyRemoteInteractiveLogonRight" { "Deny log on through Remote Desktop Services (SeDenyRemoteInteractiveLogonRight)" }
                                        "SeDenyServiceLogonRight"           { "Deny log on as a service (SeDenyServiceLogonRight)" }
                                        "SeInteractiveLogonRight"           { "Allow log on locally (SeInteractiveLogonRight)" }
                                        "SeNetworkLogonRight"               { "Access this computer from the network (SeNetworkLogonRight)" }
                                        "SeRemoteInteractiveLogonRight"     { "Allow log on through Remote Desktop Services (SeRemoteInteractiveLogonRight)" }
                                        "SeServiceLogonRight"               { "Log on as a service (SeServiceLogonRight)" }
                                        Default                             { "($right)" }
                                    }
                                    Write-Output ("$(Time-Stamp)Granting `"$UserLogonRight`" to user account: $Username on host: $ComputerName.")
                                    $sid = ((New-Object System.Security.Principal.NTAccount($Username)).Translate([System.Security.Principal.SecurityIdentifier])).Value
                                    secedit /export /cfg $export | Out-Null
                                    #Change the below to any right you would like
                                    $sids = (Select-String $export -Pattern "$right").Line
                                    foreach ($line in @("[Unicode]", "Unicode=yes", "[System Access]", "[Event Audit]", "[Registry Values]", "[Version]", "signature=`"`$CHICAGO$`"", "Revision=1", "[Profile Description]", "Description=Grant $UserLogonRight to $Username", "[Privilege Rights]", "$sids,*$sid"))
                                    {
                                        Add-Content $import $line
                                    }
                                }

                                secedit /import /db $secedt /cfg $import | Out-Null
                                secedit /configure /db $secedt | Out-Null
                                gpupdate /force | Out-Null
                                Write-Verbose "The script will not delete the following paths due to running in verbose mode, please remove these manually if needed:"
                                Write-Verbose "`$import : $import"
                                Write-Verbose "`$export : $export"
                                Write-Verbose "`$secedt : $secedt"

                                if ($VerbosePreference.value__ -eq 0)
                                {
                                    Remove-Item -Path $import -Force | Out-Null
                                    Remove-Item -Path $export -Force | Out-Null
                                    Remove-Item -Path $secedt -Force | Out-Null
                                }
                            }
                            catch
                            {
                                Write-Output ("$(Time-Stamp)Failure occurred while granting `"$right`" to user account: $Username on host: $ComputerName.")
                                Write-Output $error[0]
                            }
                        } -ArgumentList $user, $rights, $Computer, $VerbosePreference
                    }
                }
            }
        }

    }
    if ($ComputerName -or $Username -or $UserRight)
    {
        foreach ($user in $Username)
        {
            Add-UserRights -ComputerName $ComputerName -Username $user -UserRight $UserRight
        }
    }
    else
    {

     <# Edit line 290 to modify the default command run when this script is executed.
       Example: 
       Add-UserRights -UserRight SeServiceLogonRight, SeBatchLogonRight -ComputerName $env:COMPUTERNAME, SQL.contoso.com -UserName CONTOSO\User1, CONTOSO\User2
       #>
        Add-UserRights
    }
}
END
{
    Write-Output "$(Time-Stamp)Script Completed!"
} 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2020-06-23T07:25:21.607

作为 powershell 中的简单解决方案

赶紧跑

```
.".\Add Account To LogonAsService.ps1" "DOMAIN\Account" 
```

[https://gallery.technet.microsoft.com/scriptcenter/Grant-Log-on-as-a-service-11a50893](https://gallery.technet.microsoft.com/scriptcenter/Grant-Log-on-as-a-service-11a50893)

# delphi - 如何从项目中查找和删除未使用的 Delphi 包

> ID：313832
> 
> 赞同：5
> 
> 时间：2008-11-24T10:28:09.803
> 
> 标签：delphi, packages

如何从使用包的项目中查找和删除未使用的 Delphi 运行时包？

我有一个由几个包组成的 Delphi 项目，在包的需要部分中列出了几个 Borland/3rd 方包（rtl.dcp、vcl.dcp 等）我知道我需要其中的大部分，但是有我知道我不需要的那些随着时间的推移悄悄地出现在那里，也许一个组件曾经使用过它们，但后来那个组件被删除了，或者它可能来自我的测试代码。

我如何找出哪些需要哪些不需要？如果不需要它们，它们是否仍需要与最终应用程序一起分发，或者对应用程序的大小/内存要求有任何影响？

我正在努力使这一切尽可能精简。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T10:36:31.063

如果您指定一个包用作 runime 包，则该包所需的所有包也需要部署为运行时包。Delphi 的编译器会自动检查是否是这种情况。因此，您不需要明确要求 rtl.dcp，只要您需要其他软件包之一即可。这意味着您只能指定您确定需要的运行时包，其余的将由编译器添加。然后你只需要检查你最终需要部署哪些包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-26T15:01:20.263

ICARUS - 我认为它仅适用于 .pas 文件，但刚刚检查过......也适用于包！自由。 [http://peganza.com/#ICARUS](http://peganza.com/#ICARUS)

Pascal Analyzer - 比 ICARUS 提供的测试更多，不是免费的。 [http://peganza.com/#PAL](http://peganza.com/#PAL)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T16:08:20.000

我收到了一个我没有隐式调用并且无法弄清楚如何摆脱的包的编译错误。我问了我的大师并得到了以下效果很好的解决方案。

“你可以删除 .dproj 并使用 .dpr 文件打开应用程序（通过 RAD）。进行构建并保存。然后你应该有一个 .dproj 引用你在 Delphi 中加载的包。” （而不是它从以前的版本中记住的）

# .net - 编写事件日志条目的最佳方法是什么？

> ID：313839
> 
> 赞同：15
> 
> 时间：2008-11-24T10:33:23.270
> 
> 标签：.net, event-log

我最近在部署 Windows 服务时遇到了问题。四台计算机没有引起任何问题，但在第五台计算机上，任何启动服务的尝试都因异常而失败。异常堆栈跟踪被写入事件日志，所以我认为应该很容易确定原因：

```
protected override void OnStart(string[] args)
{
    EventLog.WriteEntry("Starting service", EventLogEntryType.Information);

    try
    {
        //...
        base.OnStart(args);
    }
    catch (Exception ex)
    {
        EventLog.WriteEntry("Service can not start. Stack trace:" + ex.StackTrace, EventLogEntryType.Error);
        Stop();
        return;
    }

    EventLog.WriteEntry("Service started", EventLogEntryType.Information);           
} 
```

但是很遗憾，没有任何信息被写入日志。我终于将其追溯到正在写入的第一个日志条目。它引发了异常，因为应用程序事件日志中充满了最近的条目，并且配置为仅覆盖超过 7 天的条目。

考虑到我无法更改应用程序事件日志的配置，写入事件日志的最佳做法是什么？

我是否应该总是放入`EventLog.WriteEntry`一个 try 块，如果是，我应该如何处理异常（将其写入事件日志可能是个坏主意），我应该在我的`OnStart`方法中检查事件日志状态，还是你有更好的建议？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-24T10:46:50.700

使用 log4net

使用 log4net 的优点是您可以检查日志并以比您在代码中考虑的更大的灵活性来控制它。

如果您正在记录到事件日志，并且看到问题并且没有事件日志条目，那么您总是可以切换到文件附加器日志并看到它工作......然后会告诉您它与事件日志。

log4net 也是防御性的，如果它无法写入日志条目，它不会使您的程序崩溃。所以你不会看到这种情况发生（所以你不会有你的日志文件，但你的程序会运行，你可以再次指定第二种日志记录方法来获取日志文件）。

log4net 文档中的关键位是：

> [log4net] 是一个尽力而为和故障停止的日志系统。
> 
> 通过故障停止，我们的意思是**log4net 不会在运行时抛出意外异常，可能导致您的应用程序崩溃**。如果由于任何原因，log4net 抛出未捕获的异常（可能抛出的 ArgumentException 和 ArgumentNullException 除外），请发送电子邮件至 log4net-user@logging.apache.org 邮件列表。未捕获的异常作为需要立即关注的严重错误处理。
> 
> 此外，log4net 在其指定的输出流未打开、不可写或已满时，不会恢复为 System.Console.Out 或 System.Console.Error。这避免了由于日志记录失败而导致用户终端泛滥而破坏其他工作程序。但是，log4net 将向 System.Console.Error 和 System.Diagnostics.Trace 输出一条消息，指示无法执行日志记录。

（我的重点）

对于大多数事情，有一个库比你做得更好。最好的事情是永远不要重新发明，log4net 解决了登录 .Net 的问题，让您的生活更轻松。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T13:25:04.187

```
System.Diagnostics.EventLog log = 
    new System.Diagnostics.EventLog("YourLogNameHere");
log.ModifyOverflowPolicy(
    System.Diagnostics.OverflowAction.OverwriteAsNeeded, 0); 
```

这应该可以解决您的溢出问题。一旦正确配置，事件日志通常非常可靠。在使用事件日志时，我曾经添加一个快速的紧急备份记录器，它只是写入一个文本文件（这需要大约 5 分钟的时间来写入）。它从来没有被调用过。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-25T07:12:30.303

您不能只使用 ServiceBase 类已经提供的默认事件日志机制吗？如果您的服务没有启动，它将自动向事件日志写入一个条目，说明如此（使用堆栈跟踪）。

除此之外，关于关于 log4net（或任何其他尽力而为，如日志系统）的评论，我认为这真的取决于你想要实现的目标。

在您的示例中，使用 log4net（或对 ServiceBase 的事件记录的内置支持）很可能是可以的。

但是，在某些情况下，即使发生错误并且无法在某处记录该事实也是一个问题。例如，假设一个身份验证或授权系统。如果您无法成功且可靠地记录密码身份验证由于错误的凭据而失败，则可能不允许您继续（顺便说一句，如果密码身份验证成功，则同样如此）。

因此，有时您需要知道日志记录尝试何时失败并自行处理。当然，这是有限制的（鸡-蛋-问题），并且您所做的事情是针对特定应用程序或场景的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T10:49:17.153

我认为记录异常是您最好吞下异常的罕见情况之一。在大多数情况下，您不希望您的应用程序因此而失败。

但是你为什么还要自己编写日志代码呢？使用 NLog 或 Log4Net 之类的框架！这些也会像我刚才所说的那样吞下异常，但您只需更改配置即可将日志记录输出重定向到不同的位置（文件、消息框等）。这使得解决此类问题变得更加容易。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-24T10:49:46.840

研究使用[Logging App Block](http://msdn.microsoft.com/en-us/library/cc309257.aspx)。

> 企业库日志记录应用程序块简化了常见日志记录功能的实现。开发人员可以使用 Logging Block 将信息写入各种位置：
> 
> *   事件日志
> *   一封电子邮件
> *   一个数据库
> *   消息队列
> *   一个文本文件
> *   WMI 事件
> *   使用应用程序块扩展点的自定义位置

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-04T12:17:09.173

让我们退后一步：

系统事件日志用于提醒系统管理员系统出现问题。您应该允许服务启动失败。这将显示在系统错误日志中，并报告了“服务控制管理器”的来源。这意味着系统管理员将知道失败。

接下来，如果您需要排除故障，则应将异常记录到程序顶层磁盘上的文件中。您还应该重新抛出它们，以便服务启动失败。

然后，您可以识别系统事件日志中的任何问题，并将故障时间交叉引用到您的应用程序日志中。

# asp.net - 我真的需要使用全局程序集缓存 (GAC) 吗？

> ID：313842
> 
> 赞同：2
> 
> 时间：2008-11-24T10:35:04.903
> 
> 标签：asp.net, deployment, global-assembly-cache

多年来我一直在构建 .NET Web 应用程序，但我从未使用过 GAC？

我错过了什么？还是我最好远离它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T10:38:26.630

GAC 仅在您注册要重用的库时才有用。在没有共享库的情况下运行 WebApp 绝不是强制性的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T10:39:51.057

GAC 主要用于存储共享库，尤其是当您的应用程序需要特定版本时。这样，我可以在同一台机器上安装 FooLib 1.0 和 FooLib 2.0，并且需要其中任何一个的应用程序都可以找到他们想要的。无论如何，Web 应用程序似乎并没有使用大量的外部库。

在另一个示例中，SSIS 要求您的自定义工具在 GAC 中。大痛。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T10:41:46.983

正如 Vincent 所说，GAC 主要对希望支持独立于客户端应用程序的服务的第三方库供应商很重要。换句话说，如果库中存在错误，您可以升级库并修复所有使用该库的应用程序，而无需知道它们是哪些应用程序等。

在实践中，大多数 .NET 应用程序（到目前为止）都是 Web 应用程序，因此事实证明它对 Microsoft 最有用，因为很少有其他人具有将更新推送到最终用户计算机的常规能力。

# regex - 正则表达式匹配以 '\\' 为前缀的非空白或空格

> ID：313848
> 
> 赞同：3
> 
> 时间：2008-11-24T10:41:02.163
> 
> 标签：regex

我有一个以空格分隔的文件名列表，其中文件名中的空格以'\'为前缀

例如“第一个\文件第二个\文件”

如何让我的正则表达式匹配每个文件名？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-24T10:45:15.367

```
(\\ |[^ ])+ 
```

除了空格之外的所有内容，除非它们被转义。应该可以，很抱歉最初误解了您的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-24T10:54:15.693

```
(\S|(?<=\\) )+ 
```

解释：

`\S`您正在多次查找非空白字符 ( ) 或前面有反斜杠的空格。

所有匹配都将保存到马赫组 1，全局应用模式以获取字符串中的所有匹配。

编辑

考虑一下，您甚至不需要捕获到子组。仅匹配就足够了，因此这可能会更有效（`?:`切换到非捕获组）：

```
(?:\S|(?<=\\) )+ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T12:34:41.497

我会这样做：

```
/[^ \\]*(?:\\ [^\\ ]*)*/ 
```

这是弗里德尔的“展开循环”习语。相对于其他字符，目标字符串中的转义空格可能很少，因此每次有机会时，您都会尽可能多地吞噬其他字符。这比一次匹配一个字符的交替要有效得多。

编辑：（Tomalak）我在正则表达式周围加上斜线，因为语法荧光笔似乎可以识别它们并将整个正则表达式绘制成一种颜色。没有它们，它可以识别其他字符，如引号，并错误地（并且令人困惑地）将正则表达式的部分绘制成不同的颜色。

(Brad) OP 只提到了空格，所以我只允许引用它们，但你是对的。书中最初的展开循环示例用于双引号字符串，它可能包含多个转义序列中的任何一个，其中一个是转义引号。这是正则表达式：

```
/"[^\\"]*(?:\\.[^\\"]*)*"/ 
```

（Tomalak）当您说它与“字符串开头的文件名”不匹配时，我不知道您的意思。它似乎与 OP 示例中的两个文件名匹配。但是，它也匹配一个空字符串，这是不好的。这可以解决，但除非效率被证明是一个问题，否则不值得付出努力。Stefan 的解决方案效果很好。

# single-sign-on - 什么是 SSO

> ID：313853
> 
> 赞同：6
> 
> 时间：2008-11-24T10:42:37.637
> 
> 标签：single-sign-on

我将 SSO 理解为所有连接的应用程序的一次性登录。我想更多地了解 SSO 以及它是如何实现的

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-24T10:59:09.333

> 这是唐尼。他是我的一个朋友。

基本机制是信任你朋友的朋友。

使用的另一个比喻是当您进入安全建筑物时他们给您的贴纸。早上，您向安全人员出示您的有效身份证件（凭证），而在一天的剩余时间里，贴纸充当通行证（令牌）。第二天回来时，您必须再次出示您的身份证。

关键技术是您如何信任您的朋友或安全人员或敌对网络中的任何人。了解 Kerberos 或非对称加密的工作原理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-16T19:47:49.043

单点登录允许最终用户登录到单个门户并无缝访问多个应用程序，通过中央入口点减少多个登录屏幕并提高安全性。

解决最终用户对必须记住多个密码的抱怨是许多组织的共同目标。为 Web 应用程序拥有多个登录访问点不仅是最终用户的痛点，也是一种安全风险，可能使您的公司容易受到网络攻击。单点登录门户解决方案可以消除多个密码提示的麻烦并简化用户的访问。然而，许多 SSO 解决方案成本高且难以实施以有效处理所有用户访问场景。当试图让外部用户（从客户、合作伙伴、供应商甚至供应商）继续实现单点登录体验时，集成尤其困难，他们都希望无缝访问托管的 Web 应用程序。

我最近一直在研究不同的 SSO 解决方案——有很多！我偶然发现了这个小视频，并认为它非常聪明！[http://youtu.be/KTweSfRW18M?list=UUJD2scx1baSeUDSIk7N35Ww](http://youtu.be/KTweSfRW18M?list=UUJD2scx1baSeUDSIk7N35Ww)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T07:51:23.850

SSO 是指当我们使用基于声明的身份验证以及基于表单的身份验证或窗口身份验证时默认实现的单点登录。主要用途是声明，称为发行者的第三方将通过提供包含声明和数字签名的令牌来授权用户访问应用程序，以便应用程序识别发行者。你可以在这里获得更多信息：

[http://en.wikipedia.org/wiki/Single_sign-on](http://en.wikipedia.org/wiki/Single_sign-on)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-30T11:45:43.530

“单点登录 (SSO) 是一种身份验证过程，允许用户使用一组登录凭据访问多个应用程序。SSO 是企业中的常见过程，其中客户端访问连接到局域网 (LAN) 的多个资源"

**你可以在这里阅读更多** [https://auth0.com/blog/2015/09/23/what-is-and-how-does-single-sign-on-work/](https://auth0.com/blog/2015/09/23/what-is-and-how-does-single-sign-on-work/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-06T06:56:31.387

在部署在**同一域下的****Web 应用程序**的上下文中，实现**SSO**的一种方法是使用**基于 Cookie 的机制**。

 ******假设我们有*app1.example.com*和*app2.example.com*，我们希望在它们之间启用 SSO。正如您已经提到的，这意味着我登录到 app1，如果我在同一个 Web 浏览器会话 app2 中访问，那么我将不再需要登录到 app2。

从技术上讲，这两个应用程序都需要一种方法来创建安全令牌（Cookie）并读取它。对于我们的示例，Cookie 可以存储有关登录用户的信息。甚至可以使用两个应用程序都知道的密钥将此信息加密到 Cookie 中。

1.  **第一个登录场景**- app1 创建 cookie：

用户登录*app1.example.com*。app1登录成功后，app1会触发为登录用户为*example.com*的域和子域创建cookie（设置cookie为' *.example.com* '）。此时 cookie 在客户端的浏览器中。

2.  **无需登录即可访问第二个应用程序**- app2 读取 cookie。

在新的浏览器选项卡中，用户正在访问*app2.example.com*。浏览器会将 app1 创建的 cookie 附加到对*app2.example.com*的请求中，因为它位于同一个域中。app2 将有一个过滤器，它正在读取 cookie 提取用户名并创建 app2 会话，绕过整个登录过程，瞧！SSO 实现。

同样的场景可以通过登录到 app2 并在不登录的情况下访问 app1 来实现，条件是这次 app2 应该能够创建 cookie 并且 app1 应该能够读取它并将其用于会话创建。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-08-28T08:25:35.673

单点登录是我们实现基于声明的身份验证时默认提供的一项功能。它涉及在从希望访问应用程序的用户那里获得凭据后将提供令牌的发行者的额外第三方身份验证。

# windows - 以编程方式读取本地密码策略

> ID：313859
> 
> 赞同：7
> 
> 时间：2008-11-24T10:46:39.250
> 
> 标签：windows, security, winapi

是否有允许读取当前密码策略的 Windows API 函数？例如，最小长度、复杂度等。

如果不阅读，有没有办法以编程方式根据策略验证密码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T11:20:04.020

请参阅[安全观察 Windows 域密码策略](http://technet.microsoft.com/en-us/magazine/cc137749.aspx)。[您可以使用ADSI](http://msdn.microsoft.com/en-us/library/aa772170.aspx)或其包装器点击 AD 。我找到了一个[VBScript 示例](http://www.activexperts.com/activmonitor/windowsmanagement/adsi/samples/)。您可以将其翻译成您想要的任何语言：

```
Sub ListPasswordPolicyInfo( strDomain )
    Dim objComputer
    Set objComputer = GetObject("WinNT://" & strDomain )
    WScript.Echo "MinPasswordAge: " &  ((objComputer.MinPasswordAge) / 86400)
    WScript.Echo "MinPasswordLength: " &  objComputer.MinPasswordLength
    WScript.Echo "PasswordHistoryLength: " &  objComputer.PasswordHistoryLength
    WScript.Echo "AutoUnlockInterval: " &  objComputer.AutoUnlockInterval
    WScript.Echo "LockOutObservationInterval: " &  objComputer.LockOutObservationInterval
End Sub

Dim strDomain
Do
    strDomain = inputbox( "Please enter a domainname", "Input" )
Loop until strDomain <> ""

ListPasswordPolicyInfo( strDomain ) 
```

作为奖励，请查看[LDAP Admin](http://ldapadmin.sourceforge.net/)。它是一个开源的 LDAP 目录编辑器，您可以使用它来测试事物，也可以检查用 Delphi 编写的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T10:39:49.737

尤金的回答很有帮助，但不是我所需要的。密码复杂度过滤器其实是可以自定义的，请问Windows，这个密码符合要求吗？

我花了一段时间才找到它，但功能是`NetValidatePasswordPolicy`. 这个函数的 MSDN 文档很糟糕；请查看此[MSDN 博客条目](http://blogs.msdn.com/b/david_leblanc/archive/2007/10/11/checking-password-complexity.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-23T14:18:37.447

查询 ActiveDirectory 仅适用于加入域的计算机；以及用户能够查询域控制器的位置（这是可以取消授予的）。

@NicholasWilson 的使用答案`NetValidatePasswordPolicy`很好；因为它可以为您做很多繁重的工作。它甚至可以执行您必须自己重新实现的密码质量检查。但是`NetValidatePasswordPolicy`当您使用加盐哈希存储密码（例如 BCrypt 或 Scrypt）时，检查您的自定义密码历史记录确实会失败。

但真正的问题是如何查询当前机器（甚至是未加入域的机器）的密码策略。您可以使用以下方法查询：

[**`NetUserModalsGet`**](https://msdn.microsoft.com/en-us/library/windows/desktop/aa370656%28v=vs.85%29.aspx?f=255&MSPPError=-2147217396)

```
struct USER_MODALS_INFO_0
{
    DWORD usrmod0_min_passwd_len;
    DWORD usrmod0_max_passwd_age;
    DWORD usrmod0_min_passwd_age
    DWORD usrmod0_force_logoff; 
    DWORD usrmod0_password_hist_len;
}
PUSER_MODALS_INFO_0 = ^USER_MODALS_INFO_0;    

PUSER_MODALS_INFO_0 info0;

NET_API_STATUS res = NetUserModalsGet(nil, 0,  out info0);

if (res <> NERR_Success)
   RaiseWin32Error(res);
try
   //Specifies the minimum allowable password length. 
   //Valid values for this element are zero through PWLEN.
   Log(info0.usrmod0_min_passwd_len);

   //Specifies, in seconds, the maximum allowable password age. 
   //A value of TIMEQ_FOREVER indicates that the password never expires. 
   //The minimum valid value for this element is ONE_DAY. 
   //The value specified must be greater than or equal to the value for the usrmod0_min_passwd_age member.
   Log(info0.usrmod0_max_passwd_age);

   //Specifies the minimum number of seconds that can elapse between the time
   //a password changes and when it can be changed again. 
   //A value of zero indicates that no delay is required between password updates. 
   //The value specified must be less than or equal to the value for the usrmod0_max_passwd_age member.
   Log(info0.usrmod0_min_passwd_age);

   //Specifies, in seconds, the amount of time between the end of the valid
   // logon time and the time when the user is forced to log off the network. 
   //A value of TIMEQ_FOREVER indicates that the user is never forced to log off. 
   //A value of zero indicates that the user will be forced to log off immediately when the valid logon time expires.
   Log(info0.usrmod0_force_logoff);

   //Specifies the length of password hi'+'story maintained. 
   //A new password cannot match any of the previous usrmod0_password_hist_len passwords. 
   //Valid values for this element are zero through DEF_MAX_PWHIST
   Log(info0.usrmod0_password_hist_len);
finally
   NetApiBufferFree(info0);
end; 
```

# java - Java RMI 跟踪

> ID：313864
> 
> 赞同：13
> 
> 时间：2008-11-24T10:48:00.573
> 
> 标签：java, logging, rmi, trace

是否有跟踪和记录 Java 应用程序的所有 RMI 活动的工具？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-24T11:10:34.553

有[JDK RMI 调试/日志记录选项](http://docs.oracle.com/javase/8/docs/technotes/guides/rmi/javarmiproperties.html)，我还发现了[这篇关于 RMI 调试的 javaworld 文章](http://www.javaworld.com/javaworld/javatips/jw-javatip56.html)——希望它们有所帮助。

# asp.net - 我可以在 IIS 中自动创建 .NET Web 应用程序吗？

> ID：313877
> 
> 赞同：6
> 
> 时间：2008-11-24T10:57:05.407
> 
> 标签：asp.net, iis, deployment, installation

我需要在几台笔记本电脑上部署一个 Web 应用程序（虽然它是一个 Web 应用程序，但它`localhost`只能通过它运行 - 因此需要在几台不同的机器上部署）。

通常我会去 IIS 并右键单击一个目录来创建一个 Web 应用程序，但我非常希望自动化安装的这一部分。可以做到吗？

**我想使用 IIS，但我想在不打开 IIS Microsoft 管理控制台 (MMC) 的情况下自动创建 Web 应用程序。**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-24T11:54:30.983

[如果您在 IIS 6上](http://learn.iis.net/page.aspx/114/getting-started-with-appcmdexe/)部署，我可以建议您[查看此链接](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/1805162e-6ac5-4a98-9a08-919c4c10827d.mspx?mfr=true)，如果是 IIS 7，请查看此链接（我可以推荐[Mike Volodarsky 的博客](http://mvolo.com/blogs/serverside/default.aspx)以获取有关 IIS 7 的一般信息）。

编写一些批处理文件来自动创建站点应该很简单。

例子：

*   IIS6 : iisweb /create C:\Rome "我的假期" /d www.reskit.com /dontstart
*   IIS7 : %windir%\system32\inetsrv\AppCmd 添加站点 /name:MyNewSite /bindings:http/*:81: /physicalPath:c:\inetpub\mynewsite

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T11:12:18.060

你真的在问两个不同的问题。首先，为什么要重新发明轮子？很可能，这些笔记本电脑已经能够运行 IIS——它在所有“现代”Windows 版本上都可用，可能除了 Vista Home。其次，VS.NET 安装程序可以轻松定位和自动安装到 IIS。如果您使用 Wix 或其他第三方安装程序，则需要更多的手动工作，但仍然可以完成。

编辑：在重新阅读您的问题时，这听起来像是您真正要问的 - 您已经知道 IIS 在目标计算机上可用，但只是不想在每台计算机上手动安装。正确的？在这种情况下，请务必查看 VS.NET 安装项目——它们有一个用于 IIS 部署的内置目标。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T11:01:15.383

要实现最小的 Web 服务器，您可以使用 HTTP.SYS（使用 Windows XP SP2 或更高版本部署的 IIS 的核心组件）。在 .NET 中，这可以通过使用[System.Net](https://docs.microsoft.com/en-us/dotnet/api/system.net?view=netframework-4.8)命名空间中的 HttpListener 类来完成。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T11:06:03.593

您可以查看[Cassini 示例 Web 服务器](http://www.asp.net/downloads/archived/cassini/)内部（带有源代码）：

> ASP.NET Cassini Web 服务器示例是使用 Microsoft® .NE​​T® Framework 编写的示例 Web 服务器，并演示了使用 ASP.NET 托管 API (System.Web.Hosting) 托管 ASP.NET。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-24T11:09:57.563

你也可以试试[Mono](https://en.wikipedia.org/wiki/Mono_%28software%29)。它适用于 Linux、Mac OS X 和 Windows。

他们有 xsp 一个用于 .NET 应用程序的 Web 服务器。

ASP.NET中有关于此的文档*[| 单声道](http://www.mono-project.com/ASP.NET)*。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-24T14:36:50.330

您可以使用 system.DirectoryServices 类，例如

[http://www.gafvert.info/iis/article/cs_create_website_iis6.htm](http://www.gafvert.info/iis/article/cs_create_website_iis6.htm)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-24T11:18:19.497

创建一个类型为“Setup and Deployment”的新 Visual Studio 项目，并使用“Web Setup”类型。

这将创建一个 .msi 安装程序，它将在 IIS 中自动为您创建 Web 应用程序。

然后，您还将获得执行网络安装的能力，因此如果您拥有正确的权限，您可以集中管理它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-24T11:26:16.907

[您可以在不使用 MMC 控制台的情况下使用项目msbuildtasks](http://msbuildtasks.tigris.org/)中提供的 WebDirectoryCreate 任务来创建虚拟目录

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-24T11:22:36.587

看看[这个帖子](http://weblogs.asp.net/rmclaws/archive/2005/10/25/428422.aspx)。它解释了如何从命令行启动[Cassini Web 服务器并将其添加为 shell 扩展。](https://www.developer.com/net/deciding-on-a-microsoft-web-server-cassini-iis-and-iis-express.html)

CarlosAg 的博客有一些关于[IIS 管理抛出 PowerShell](http://blogs.msdn.com/carlosag/archive/2008/02/11/MicrosoftWebAdministrationInPowershell.aspx)和[托管代码](http://blogs.msdn.com/carlosag/archive/2008/06/12/FasterIISProvisioningUsingMWA.aspx)的精彩文章。

# php - 使用 PHP 查找 SRV 记录

> ID：313880
> 
> 赞同：3
> 
> 时间：2008-11-24T11:00:38.770
> 
> 标签：php, dns, srv

如果你输入

```
nslookup -type=SRV _xmpp-server._tcp.gmail.com 
```

（或在 OSX 中使用 dig 命令）你会得到一些与 google chat 相关的 SRV 记录

我想在 PHP 中复制这个功能，有没有人有任何好主意如何做到这一点？

我想避免使用 exec() 因为这不会在 OSX/*NIX/WINDOWS 中返回 100% 标准响应

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-24T11:13:33.173

有[`dns_get_record()`](http://php.net/manual/en/function.dns-get-record.php)。根据文档，它可以接受一个`int $type`参数，该参数指的是一组常量，其中一个是`DNS_SRV`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-24T11:11:41.150

您可以使用[Pear Net_DNS](http://pear.php.net/package/Net_DNS)。我设法让它在 Linux 上工作，但还没有在 Windows 或任何其他上测试它：

```
require_once('Net/DNS.php');
$resolver = new Net_DNS_Resolver();
$response = $resolver->query('_xmpp-server._tcp.gmail.com', 'SRV');
if ($response) {
    foreach ($response->answer as $rr) {
        $rr->display();
    }
} 
```

我从他们的文档中修改了示例。希望这可以帮助

# c++ - 您可以在 C++ 中显式调用实例化对象的类构造函数吗？

> ID：313882
> 
> 赞同：10
> 
> 时间：2008-11-24T11:01:32.120
> 
> 标签：c++, constructor

创建类的实例后，我们可以显式调用构造函数吗？例如

```
class A{
    A(int a)
    {
    }
}

A instance;

instance.A(2); 
```

我们可以这样做吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-24T11:04:49.853

您可以使用[placement new](http://en.wikipedia.org/wiki/Placement_new)，它允许

```
new (&instance) A(2); 
```

但是，从您的示例中，您将在对象上调用构造函数两次，这是非常糟糕的做法。相反，我建议你这样做

```
A instance(2); 
```

放置 new 通常仅在您需要预先分配内存（例如在自定义内存管理器中）并稍后构造对象时使用。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-24T11:18:28.437

不。

为集合创建一个方法并从构造函数中调用它。以后也可以使用此方法。

```
class A{
    A(int a) { Set(a); }
    void Set(int a) { }
}

A instance;

instance.Set(2); 
```

您可能还需要一个默认值或默认构造函数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-24T11:51:11.787

不

```
Calling instance.A() or A(1) is seens as casting  'function-style cast' : illegal as right side of '.' operator 
```

通常，如果在构造函数中以及在构造对象之后需要函数/功能，则将其放置在 init() 方法中并在构造函数和其他地方使用。

例子：

```
 class A{
      A(int a)
       { 
        init(a);
       }

     void init(int a) { } 
     }

        A instance;

        instance.init(2); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-24T11:08:46.523

我很确定你不能那样做。这就是重点，构造函数是创建类的实例。

如果一个构造函数根本没有被调用，或者被调用了两次——它会产生什么后果？

当然，您可以做的是将一些构造函数逻辑提取到方法中，并在构造函数中和创建对象后调用该方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T18:50:35.357

顺便说一句，这听起来像是一个设计缺陷。一旦构建了一个对象，就永远不需要重新构建它。这种变量名重用使代码更难理解。出于这个原因，通过额外的函数来提供类似构造函数的功能`init`通常`set`是错误的（但有时是不可避免的）。

正如 Michael 所说，placement new 可以在这里使用，但实际上是为了不同的用途。此外，在内存位置构造新对象之前，您必须显式销毁旧对象：

```
instance.~A(); 
```

此外，`placement new`可能会对您的内存产生不利影响，因为重载可能会认为它传递的内存属于堆！结论：*不要*。做。这。

**编辑**为了证明调用析构函数确实是必要的*（*对于非 POD），请考虑以下示例代码：

```
#include <iostream>

struct A {
    A(int a) { std::cerr << "cons " << a << std::endl; }
    ~A() { std::cerr << "dest" << std::endl; }
};

int main() {
    A instance(2);
    new (&instance) A(3);
} 
```

正如预期的那样，程序产生以下输出：

```
cons 2
cons 3
dest 
```

…这意味着第一个对象的析构函数*没有*被调用。任何`A`可能已经获得的资源也是如此。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-18T05:38:19.767

不，你不能那样做。调用构造函数的唯一方法是使用关键字“new”。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-11-24T18:27:58.820

总结一下，指定显式构造函数的三种方法是通过

1.  一个实例（2）；// 做 A 实例 = 2; 曾经工作过吗？

2.  A *实例 = 新 A(2); //我自己从不知道 & 和 * 的区别

3.  新的 (&instance) A(2);

和那些味道。这个~~想法~~的目标是安排任何时候构造的对象都没有处于正确的初始化状态，并且构造函数旨在确保这一点。（这意味着方法不必检查某些 .init(...) 方法是否已成功调用。）

这让我觉得这是一种更实用的方法，特别是对于作为框架一部分并在库中重用的类。如果这是您感兴趣的内容，请努力让所有构造函数（包括任何默认构造函数）交付一个完整工作的实例。

异常情况：如果构造函数操作可能会失败，那么您可能在构造函数操作中没有某些东西，除非从构造函数抛出异常是合适的。有些人喜欢使用后续方法甚至暴露给初始化成员传播的“空白”实例。探索减轻这种情况的方法并拥有健壮的实例是很有趣的，这些实例没有需要在方法实现和使用中受到保护的不良状态。

PS：在某些复杂的情况下，将初始化实例（引用）作为“工厂”类上的函数或方法的结果传递可能很有用，这样中间的、设置不足的实例就不会出现在封装工厂类实例或函数之外。这给了我们，

+4。A *实例 = MakeAnA(2);

+5。A *instance = InterestingClass.A(2);

# wpf - WPF：将 GridView 标题溢出到两行，其中底行分为两列

> ID：313889
> 
> 赞同：2
> 
> 时间：2008-11-24T11:07:11.347
> 
> 标签：wpf, listview, gridviewheader

我正在尝试将 gridViewColumn 分成两行。我使用 listView 的默认样式。将列标题分成两行没有问题，但似乎内容被放置在原始样式上，边框等隐藏在我自定义的 gridViewHeader 内容下。代码如下所示：

```
<GridViewColumnHeader>
    <GridViewColumnHeader.Template>
        <ControlTemplate>
            <Grid VerticalAlignment="Center" HorizontalAlignment="Center">
                <Grid ShowGridLines="False" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Text="SomeHeaderText" HorizontalAlignment="Center"/>
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="SubHeaderText1" Padding="5"  HorizontalAlignment="Center" />
                            <TextBlock Grid.Column="1" Text="SubHeaderText1" Padding="5" HorizontalAlignment="Center" />                                                
                        </Grid>
                    </Grid>
            </Grid>
        </ControlTemplate>
    </GridViewColumnHeader.Template>
</GridViewColumnHeader> 
```

任何人都知道如何像这个例子一样裁剪 GridViewHeader 并保持 GridViewHeader 的外观

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T20:00:59.630

您应该将自定义模板作为 GridViewColumnHeader 的内容，而不是作为其模板。这是正确的 XAML：

```
<GridViewColumnHeader>
   <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
      <Grid HorizontalAlignment="Center" VerticalAlignment="Center" ShowGridLines="False">
         <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
         </Grid.RowDefinitions>
         <TextBlock Grid.Row="0" HorizontalAlignment="Center" Text="SomeHeaderText"/>
         <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
               <ColumnDefinition Width="*"/>
               <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <TextBlock
               Grid.Column="0"
               HorizontalAlignment="Center"
               Padding="5"
               Text="SubHeaderText1"/>
            <TextBlock
               Grid.Column="1"
               HorizontalAlignment="Center"
               Padding="5"
               Text="SubHeaderText1"/>
         </Grid>
      </Grid>
   </Grid>
</GridViewColumnHeader> 
```

# automated-tests - 自动化 BDD 场景的隔离级别？

> ID：313891
> 
> 赞同：2
> 
> 时间：2008-11-24T11:07:37.243
> 
> 标签：automated-tests, bdd

在自动化场景时，您应该瞄准什么隔离级别？它们应该像适当的单元测试（即使用模拟等）那样完全隔离，还是更类似于集成测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T08:43:10.460

场景通常在集成测试级别。

理想情况下，场景用于与客户沟通，或者至少使用客户的术语和语言。一个合格的场景提供了具体的证据，证明该软件可以满足客户的需求。客户不关心单个组件，而是关心整个系统。

# javascript - 如何测量函数执行所花费的时间

> ID：313893
> 
> 赞同：1527
> 
> 时间：2008-11-24T11:09:14.010
> 
> 标签：javascript, profiling

我需要以毫秒为单位获取执行时间。

> 我最初在 2008 年问过这个问题。当时接受的答案是使用[`new Date().getTime()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/getTime)但是，我们现在都同意使用标准[`performance.now()`](https://developer.mozilla.org/en-US/docs/Web/API/Performance.now)API 更合适。因此，我正在将接受的答案更改为这个答案。

* * *

## 回答 #1

> 赞同：2373
> 
> 时间：2009-12-29T15:05:42.183

## 使用 [**performance.now()**](https://developer.mozilla.org/en-US/docs/Web/API/Performance.now)：

```
var startTime = performance.now()

doSomething()   // <---- measured code goes between startTime and endTime

var endTime = performance.now()

console.log(`Call to doSomething took ${endTime - startTime} milliseconds`) 
```

> 在`Node.js`它需要导入[`performance`](https://nodejs.org/api/perf_hooks.html#perf_hooks_class_performance)类

进口业绩

```
const { performance } = require('perf_hooks'); 
```

* * *

## 使用**[console.time](https://developer.mozilla.org/en-US/docs/DOM/console.time)** : ([生活水平](https://console.spec.whatwg.org/#time))

```
console.time('doSomething')

doSomething()   // <---- The function you're measuring time for 

console.timeEnd('doSomething') 
```

***注意：***
传递给`time()`and`timeEnd()`方法的字符串必须匹配
（*定时器才能按预期完成*）。

> ### `console.time()`文件：
> 
> *   [MDN 文档](https://developer.mozilla.org/en-US/docs/Web/API/Console/time)
> *   [Node.js 文档](https://nodejs.org/api/console.html#console_console_timeend_label)

* * *

## 回答 #2

> 赞同：685
> 
> 时间：2008-11-24T11:15:23.857

使用[新的 Date().getTime()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/getTime)

> getTime() 方法返回自 1970 年 1 月 1 日午夜以来的毫秒数。

前任。

```
var start = new Date().getTime();

for (i = 0; i < 50000; ++i) {
// do something
}

var end = new Date().getTime();
var time = end - start;
alert('Execution time: ' + time); 
```

* * *

## 回答 #3

> 赞同：436
> 
> 时间：2013-03-26T15:49:04.993

## 不要使用日期（）。参见下文。

**使用[`performance.now()`](http://updates.html5rocks.com/2012/08/When-milliseconds-are-not-enough-performance-now)**：

```
<script>
var a = performance.now();
alert('do something...');
var b = performance.now();
alert('It took ' + (b - a) + ' ms.');
</script> 
```

它适用于：

*   IE 10++

*   火狐 15++

*   铬 24 ++

*   野生动物园 8 ++

*   歌剧 15 ++

*   安卓 4.4++

*   [等等等等](http://caniuse.com/#search=performance.now)

`console.time`**对你**来说可能是可行的，但它是非标准的[§](https://developer.mozilla.org/en-US/docs/Web/API/Console.time)：

> 此功能是非标准的，不在标准轨道上。不要在面向 Web 的生产站点上使用它：它不适用于每个用户。实现之间也**可能存在很大**的不兼容性，并且行为可能会在未来发生变化。

除了浏览器支持之外，它`performance.now`似乎有*可能*提供更准确的计时，因为它似乎是`console.time`.

* * *

<rant> 另外，**永远不要使用`Date`任何*东西***，因为它会受到“系统时间”变化的影响。这意味着当用户没有准确的系统时间时，我们**将得到无效的结果——比如“负计时”：**

> 2014 年 10 月，我的系统时钟失控了，*猜猜怎么着*……我打开 Gmail，看到我一天的*所有*电子邮件“ **0 分钟前**发送”。我还以为 Gmail 应该是由 Google 的世界级工程师打造的......

（将您的系统时钟设置为一年前，然后转到 Gmail，这样我们都可以开怀大笑。也许有一天我们会有一个JS[的耻辱堂](http://www.damnyouautocorrect.com/)`Date`。）

Google Spreadsheet 的[`now()`](https://support.google.com/docs/answer/3092981)功能也存在这个问题。

您将使用的唯一时间`Date`是您想向用户显示**他的**系统时钟时间。不是当你想获得[**时间**或](http://vancouver-webpages.com/time/)测量任何东西时。

* * *

## 回答 #4

> 赞同：60
> 
> 时间：2014-01-14T19:01:22.837

**如果您需要在本地开发机器上获取函数执行时间**，您可以使用浏览器的分析工具或控制台命令，例如[`console.time()`](https://developer.mozilla.org/en-US/docs/Web/API/console.time)和[`console.timeEnd()`](https://developer.mozilla.org/en-US/docs/Web/API/console.timeEnd)。

所有现代浏览器都内置了 JavaScript 分析器。这些分析器应该提供最准确的测量结果，因为您不必修改现有代码，这可能会影响函数的执行时间。

要分析您的 JavaScript：

*   在**Chrome**中，按*F12*并选择*Profiles*选项卡，然后选择*Collect JavaScript CPU Profile*。
*   在**Firefox**中，安装/打开 Firebug，然后单击*Profile*按钮。
*   在**IE 9+**中，按*F12*，单击*Script*或*Profiler*（取决于您的 IE 版本）。

**或者，在您的开发机器上**[`console.time()`](https://developer.mozilla.org/en-US/docs/Web/API/console.time)，您可以使用和将检测添加到您的代码中[`console.timeEnd()`](https://developer.mozilla.org/en-US/docs/Web/API/console.timeEnd)。Firefox11+、Chrome2+ 和 IE11+ 支持这些功能，报告您通过`console.time()`. `time()`将用户定义的计时器名称作为参数，`timeEnd()`然后报告自计时器启动以来的执行时间：

```
function a() {
  console.time("mytimer");
  ... do stuff ...
  var dur = console.timeEnd("myTimer"); // NOTE: dur only works in FF
} 
```

请注意，只有 Firefox 在`timeEnd()`调用中返回经过的时间。其他浏览器只是将结果报告给开发者控制台：返回值`timeEnd()`是未定义的。

**如果你想在野外获得函数执行时间**，你将不得不检测你的代码。你有几个选择。您可以通过查询简单地保存开始和结束时间`new Date().getTime()`：

```
function a() {
  var start = new Date().getTime();
  ... do stuff ...
  var end = new Date().getTime();
  var dur = end - start;
} 
```

但是，该`Date`对象只有毫秒分辨率，并且会受到任何操作系统的系统时钟变化的影响。在现代浏览器中，有更好的选择。

更好的选择是使用[高分辨率时间](http://www.w3.org/TR/hr-time/)，也就是`window.performance.now()`。 在两个重要方面`now()`优于传统：`Date.getTime()`

1.  `now()`是具有亚毫秒分辨率的双精度数，表示自页面导航开始以来的毫秒数。它以小数形式返回微秒数（例如，1000.123 的值是 1 秒和 123 微秒）。

2.  `now()`是单调递增的。这很重要，因为在后续调用`Date.getTime()`中可能*会*向前甚至向后跳跃。值得注意的是，如果操作系统的系统时间被更新（例如原子钟同步），`Date.getTime()`也会被更新。 `now()`保证总是单调递增的，所以它不受操作系统系统时间的影响——它总是挂钟时间（假设你的挂钟不是原子的……）。

`now()`几乎可以在所有`new Date().getTime()`, `+ new Date`andt`Date.now()`的地方使用。例外是`Date`和`now()`时间不会混合，因为`Date`它基于[unix-epoch](http://en.wikipedia.org/wiki/Unix_time)（自 1970 年以来的毫秒数），而`now()`自页面导航开始以来的毫秒数（因此它将比 小得多`Date`）。

这是一个如何使用的示例`now()`：

```
function a() {
  var start = window.performance.now();
   ... do stuff ...
  var end = window.performance.now();
  var dur = end - start;
} 
```

`now()`在 Chrome stable、Firefox 15+ 和 IE10 中受支持。还有几个[polyfills](https://gist.github.com/paulirish/5438650)可用。

**在野外测量执行时间的另一种选择是[UserTiming](http://www.w3.org/TR/user-timing/)**。UserTiming 的行为与`console.time()`and类似`console.timeEnd()`，但它使用与使用相同的高分辨率时间戳`now()`（因此您可以获得亚毫秒单调递增的时钟），并将时间戳和持续时间保存到[PerformanceTimeline](http://www.w3.org/TR/performance-timeline/)。

UserTiming 具有*标记*（时间戳）和*度量*（持续时间）的概念。您可以根据需要定义任意多个，它们会在[PerformanceTimeline](http://www.w3.org/TR/performance-timeline/)上公开。

要保存时间戳，请调用`mark(startMarkName)`. 要获得自第一次标记以来的持续时间，您只需调用`measure(measurename, startMarkname)`. 然后，持续时间与您的标记一起保存在 PerformanceTimeline 中。

```
function a() {
  window.performance.mark("start");
  ... do stuff ...
  window.performance.measure("myfunctionduration", "start");
}

// duration is window.performance.getEntriesByName("myfunctionduration", "measure")[0]; 
```

UserTiming 在 IE10+ 和 Chrome25+ 中可用。还有一个[polyfill](https://github.com/nicjansma/usertiming.js)可用（我写的）。

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2015-02-26T16:13:11.293

要获得精确值，您应该使用[Performance interface](https://developer.mozilla.org/en-US/docs/Web/API/Performance)。现代版本的 Firefox、Chrome、Opera 和 IE 都支持它。这是如何使用它的示例：

```
var performance = window.performance;
var t0 = performance.now();
doWork();
var t1 = performance.now();
console.log("Call to doWork took " + (t1 - t0) + " milliseconds.") 
```

`Date.getTime()`或者`console.time()`不适合测量精确的执行时间。如果快速粗略估计适合您，您可以使用它们。通过粗略估计，我的意思是您可以从实时获得 15-60 毫秒的偏移。

查看这篇关于在 JavaScript 中测量执行时间的精彩[文章](https://blog.mariusschulz.com/2013/11/22/measuring-execution-times-in-javascript-with-consoletime)。作者还给出了几个关于 JavaScript 时间准确性的链接，值得一读。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2008-11-24T11:14:43.297

使用 Firebug，同时启用 Console 和 Javascript。单击配置文件。重新加载。再次单击配置文件。查看报告。

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2018-07-02T11:56:32.487

一个简单的解决方案，您也可以在这里使用 add 运算符

```
 var start = +new Date();
 callYourFunctionHere();
 var end = +new Date();
 var time = end - start;
 console.log('total execution time = '+ time + 'ms'); 
```

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2015-03-11T09:49:04.727

process.hrtime() 在**Node.js**中可用- 它以纳秒为单位返回一个值

```
var hrTime = process.hrtime()
console.log(hrTime[0] * 1000000 + hrTime[1] / 1000) 
```

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2013-08-08T18:54:31.193

```
var StopWatch = function (performance) {
    this.startTime = 0;
    this.stopTime = 0;
    this.running = false;
    this.performance = performance === false ? false : !!window.performance;
};

StopWatch.prototype.currentTime = function () {
    return this.performance ? window.performance.now() : new Date().getTime();
};

StopWatch.prototype.start = function () {
    this.startTime = this.currentTime();
    this.running = true;
};

StopWatch.prototype.stop = function () {
    this.stopTime = this.currentTime();
    this.running = false;
};

StopWatch.prototype.getElapsedMilliseconds = function () {
    if (this.running) {
        this.stopTime = this.currentTime();
    }

    return this.stopTime - this.startTime;
};

StopWatch.prototype.getElapsedSeconds = function () {
    return this.getElapsedMilliseconds() / 1000;
};

StopWatch.prototype.printElapsed = function (name) {
    var currentName = name || 'Elapsed:';

    console.log(currentName, '[' + this.getElapsedMilliseconds() + 'ms]', '[' + this.getElapsedSeconds() + 's]');
}; 
```

基准

```
var stopwatch = new StopWatch();
stopwatch.start();

for (var index = 0; index < 100; index++) {
    stopwatch.printElapsed('Instance[' + index + ']');
}

stopwatch.stop();

stopwatch.printElapsed(); 
```

输出

```
Instance[0] [0ms] [0s]
Instance[1] [2.999999967869371ms] [0.002999999967869371s]
Instance[2] [2.999999967869371ms] [0.002999999967869371s]
/* ... */
Instance[99] [10.999999998603016ms] [0.010999999998603016s]
Elapsed: [10.999999998603016ms] [0.010999999998603016s] 
```

[performance.now()](http://updates.html5rocks.com/2012/08/When-milliseconds-are-not-enough-performance-nowhttp://updates.html5rocks.com/2012/08/When-milliseconds-are-not-enough-performance-now)是可选的 - 只需将 false 传递给 StopWatch 构造函数。

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2019-02-01T07:13:38.567

可以只使用一个变量：

```
var timer = -performance.now();

// Do something

timer += performance.now();
console.log("Time: " + (timer/1000).toFixed(5) + " sec.") 
```

`timer/1000`- 将毫秒转换为秒

`.toFixed(5)`- 修剪多余的数字

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2013-08-04T04:23:45.973

要进一步扩展 vsync 的代码以能够在 NodeJS 中将 timeEnd 作为值返回，请使用这段代码。

```
console.timeEndValue = function(label) { // Add console.timeEndValue, to add a return value
   var time = this._times[label];
   if (!time) {
     throw new Error('No such label: ' + label);
   }
   var duration = Date.now() - time;
   return duration;
}; 
```

现在像这样使用代码：

```
console.time('someFunction timer');

someFunction();

var executionTime = console.timeEndValue('someFunction timer');
console.log("The execution time is " + executionTime); 
```

这给了你更多的可能性。您可以存储执行时间以用于更多目的，例如在方程式中使用它，或存储在数据库中，通过 websockets 发送到远程客户端，在网页上提供服务等。

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2018-09-12T01:41:07.727

这是**计时功能的装饰器**

它包装了函数，以便它们每次运行时都会计时

```
let timed = (f) => (...args) => {
    let start = performance.now();
    let ret = f(...args);
    console.log(`function ${f.name} took ${(performance.now() - start).toFixed(3)}ms`);
    return ret;   
} 
```

用法：

```
let test = () => { /* does something */ }
test = timed(test)   // turns the function into a timed function in one line
test()               // run your code as normal, logs 'function test took 1001.900ms' 
```

如果您使用的是异步函数，则可以进行`timed`异步并在 f(...args) 之前添加一个`await`，这应该适用于这些函数。如果您希望一个装饰器同时处理同步和异步功能，它会变得更加复杂。

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2019-04-23T09:14:33.027

有多种方法可以实现这一目标：

1.  **使用控制台时间**

    ```
    console.time('function');
    //run the function in between these two lines for that you need to 
    //measure time taken by the function. ("ex. function();")
    console.timeEnd('function'); 
    ```

2.  这是最有效的方法： **使用 performance.now()**，例如

    ```
    var v1 = performance.now();
    //run the function here for which you have top measure the time 
    var v2 = performance.now();
    console.log("total time  taken = "+(v2-v1)+"milliseconds"); 
    ```

3.  使用 +(add operator) 或 getTime()

    ```
    var h2 = +new Date(); //or
    var h2 = new Date().getTime();
    for(i=0;i<500;i++) { /* do something */}
    var h3 = +new Date();   //or 
    var h3 = new Date().getTime();
    var timeTaken = h3-h2;
    console.log("time ====", timeTaken); 
    ```

将一元加号运算符应用于 Date 实例时会发生以下情况： 获取相关 Date 实例的值 将其转换为数字

注意：`getTime()`提供比一元 + 运算符更好的性能。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2018-03-16T07:00:29.330

它可能会帮助你。

`var t0 = date.now(); doSomething(); var t1 = date.now(); console.log("Call to doSomething took approximate" + (t1 - t0)/1000 + " seconds.")`

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2014-09-18T11:14:19.483

由于某些主要浏览器（即 IE10）不支持`console.time`并且`performance.now`不受支持，因此我创建了一个使用最佳可用方法的超薄实用程序。但是，它缺乏对错误用法的错误处理（调用`End()`未初始化的计时器）。

使用它并根据需要改进它。

```
Performance: {
    Timer: {},
    Start: function (name) {
        if (console && console.time) {
            console.time(name);
        } else if (window.performance.now) {
            this.Timer[name] = window.performance.now();
        } else {
            this.Timer[name] = new Date().getTime();
        }
    },
    End: function (name) {
        if (console && console.time) {
            console.timeEnd(name);
        } else {
            var result;
            if (window.performance.now) {
                result = window.performance.now() - this.Timer[name];
            } else {
                result = new Date().getTime() - this.Timer[name];
            }
            console.log(name + ": " + result);
        }
    }
} 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2017-04-03T11:11:46.857

这是一个**定时器功能**。如果要测量未嵌套的多个事物之间的时间：

```
function timer(lap){ 
    if(lap) console.log(`${lap} in: ${(performance.now()-timer.prev).toFixed(3)}ms`); 
    timer.prev = performance.now();
} 
```

类似于`console.time()`，但如果您不需要跟踪以前的计时器，则更易于使用。

* * *

用法：

```
timer()              // set the start
// do something 
timer('built')       // logs 'built in: 591.815ms'
// do something
timer('copied')      // logs 'copied in: 0.065ms'
// do something
timer('compared')    // logs 'compared in: 36.41ms' 
```

* * *

如果你喜欢蓝色`console.time()`，你可以用这条线代替

```
console.log(`${lap} in: %c${(performance.now()-timer.prev).toFixed(3)}ms`, 'color:blue'); 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2018-03-18T13:45:30.860

几个月前，我整理了自己的例程，使用 Date.now() 对函数计时——即使当时接受的方法似乎是 performance.now()——因为性能对象尚不可用（已构建-in) 在稳定的 Node.js 版本中。

今天我做了更多的研究，发现了另一种计时方法。由于我还发现了如何在 Node.js 代码中使用它，所以我想在这里分享一下。

下面结合[w3c](https://w3c.github.io/performance-timeline/)和[Node.js](https://nodejs.org/api/perf_hooks.html#perf_hooks_class_performance)给出的例子：

```
function functionTimer() {
    performance.mark('start')
    functionToBeTimed()
    performance.mark('end')
    performance.measure('Start to End', 'start', 'end')
    const measure = performance.getEntriesByName('Start to End')[0]
    console.log(measure.duration)
} 
```

***笔记：***

如果您打算`performance`在 Node.js 应用程序中使用该对象，则必须包含以下要求： `const { performance } = require('perf_hooks')`

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2015-12-18T15:29:46.653

谢谢，Achim Koellner，将扩大您的答案：

```
var t0 = process.hrtime();
//Start of code to measure

//End of code
var timeInMilliseconds = process.hrtime(t0)[1]/1000000; // dividing by 1000000 gives milliseconds from nanoseconds 
```

请注意，除了要测量的内容之外，您不应该做任何事情（例如，`console.log`执行也需要时间并且会影响性​​能测试）。

请注意，为了衡量异步函数的执行时间，您应该`var timeInMilliseconds = process.hrtime(t0)[1]/1000000;`在回调中插入。例如，

```
var t0 = process.hrtime();
someAsyncFunction(function(err, results) {
var timeInMilliseconds = process.hrtime(t0)[1]/1000000;

}); 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2021-07-31T18:44:45.200

`console.time('some label here')`在函数之前和函数之后使用`console.timeEnd('some label here')`。它会给你函数的运行时间。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2019-01-28T23:17:08.993

## 具有累积周期的秒表

与服务器和客户端（节点或 DOM）一起使用，使用`Performance`API。当您有许多小循环时很好，例如在一个调用 1000 次的函数中处理 1000 个数据对象，但您想查看此函数中的每个操作如何加起来总计。

所以这个使用了一个模块全局（单例）定时器。与类单例模式相同，只是使用起来更简单一些，但您需要将其放在单独的 eg`stopwatch.js`文件中。

```
const perf = typeof performance !== "undefined" ? performance : require('perf_hooks').performance;
const DIGITS = 2;

let _timers = {};

const _log = (label, delta?) => {
    if (_timers[label]) {
        console.log(`${label}: ` + (delta ? `${delta.toFixed(DIGITS)} ms last, ` : '') +
            `${_timers[label].total.toFixed(DIGITS)} ms total, ${_timers[label].cycles} cycles`);
    }
};

export const Stopwatch = {
    start(label) {
        const now = perf.now();
        if (_timers[label]) {
            if (!_timers[label].started) {
                _timers[label].started = now;
            }
        } else {
            _timers[label] = {
                started: now,
                total: 0,
                cycles: 0
            };
        }
    },
    /** Returns total elapsed milliseconds, or null if stopwatch doesn't exist. */
    stop(label, log = false) {
        const now = perf.now();
        if (_timers[label]) {
            let delta;
            if(_timers[label].started) {
                delta = now - _timers[label].started;
                _timers[label].started = null;
                _timers[label].total += delta;
                _timers[label].cycles++;
            }
            log && _log(label, delta);
            return _timers[label].total;
        } else {
            return null;
        }
    },
    /** Logs total time */
    log: _log,
    delete(label) {
        delete _timers[label];
    }
}; 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2019-05-06T19:00:03.020

最好的方法是使用该`performance hooks`模块。虽然不稳定，但您可以在代码的`mark`特定区域和标记区域之间进行标记。`measure``duration`

```
const { performance, PerformanceObserver } = require('perf_hooks');

const measures = []

const obs = new PerformanceObserver(list => measures.push(...list.getEntries()));
obs.observe({ entryTypes: ['measure'] });
const getEntriesByType = cb => cb(measures);

const doSomething = val => {
  performance.mark('beginning of the process');

  val *= 2;

  performance.mark('after multiplication');

  performance.measure('time taken', 'beginning of the process', 'after multiplication');

  getEntriesByType(entries => {
    entries.forEach(entry => console.log(entry));
  })

  return val;
}

doSomething(4); 
```

[在这里](https://repl.it/@toondaey/Performance-Hooks-Demo)试试

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2019-07-03T12:32:59.130

有性能

NodeJs：需要导入性能类

```
var time0 = performance.now(); // Store the time at this point into time0

yourFunction();   // The function you're measuring time for 

var time1 = performance.now(); // Store the time at this point into time1

console.log("youFunction took " + (time1 - time0) + " milliseconds to execute"); 
```

使用控制台时间

```
console.time('someFunction');

someFunction(); // Whatever is timed goes between the two "console.time"

console.timeEnd('someFunction'); 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2018-08-14T13:38:54.130

```
export default class Singleton {

  static myInstance: Singleton = null;

  _timers: any = {};

  /**
   * @returns {Singleton}
   */
  static getInstance() {
    if (Singleton.myInstance == null) {
      Singleton.myInstance = new Singleton();
    }

    return this.myInstance;
  }

  initTime(label: string) {
    this._timers[label] = Date.now();
    return this._timers[label];
  }

  endTime(label: string) {
    const endTime = Date.now();
    if (this._timers[label]) {
      const delta = endTime - this._timers[label];
      const finalTime = `${label}: ${delta}ms`;
      delete this._timers[label];
      return finalTime;
    } else {
      return null;
    }
  }
} 
```

InitTime 相关`string`。

`return Singleton.getInstance().initTime(label); // Returns the time init`

`return Singleton.getInstance().endTime(label); // Returns the total time between init and end`

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2018-09-29T19:45:13.803

就我而言，我更喜欢使用@语法 suger 并用 babel 编译它。
这种方法的问题是函数必须在对象内部。

示例 JS 代码

```
function timer() {
    return (target, propertyKey, descriptor) => {
        const start = Date.now();
        let oldFunc = descriptor.value;

        descriptor.value = async function (){
            var result = await oldFunc.apply(this, arguments);
            console.log(Date.now() - start);
            return result;
        }
    }
}

// Util function 
function delay(timeout) {
    return new Promise((resolve) => setTimeout(() => {
        resolve();
    }, timeout));
}

class Test {
    @timer()
    async test(timout) {
        await delay(timout)
        console.log("delay 1");
        await delay(timout)
        console.log("delay 2");
    }
}

const t = new Test();
t.test(1000)
t.test(100) 
```

.babelrc（用于 babel 6）

```
 {
    "plugins": [
        "transform-decorators-legacy"
    ]
 } 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2019-11-17T20:05:27.493

1.  启动**定时器**使用`console.time("myTimer");`
2.  *可选：*要**打印**经过的时间，请使用 `console.timeLog("myTimer");`
3.  最后，**停止计时器并打印**最终时间：`console.timeEnd("myTimer");`

[您可以在MDN](https://developer.mozilla.org/en-US/docs/Web/API/Console/timeLog)和[Node.js 文档](https://nodejs.org/api/console.html#console_console_timelog_label_data)中阅读更多相关信息。

*适用于 Chrome、Firefox、Opera 和 NodeJS。（不在 Edge 或 Internet Explorer 上）。*

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2021-11-16T07:19:11.500

使用此代码格式

```
const startTime =new Date().getTime();

//do something 
const endTime = new Date().getTime();
console.log(`time taken ${(endTime - startTime)/1000} seconds`); 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2022-02-10T01:11:06.223

支持标记的基本 TypeScript 示例。调用`start('something')`将启动计时器并`stop('something')`结束计时器并返回包含经过时间的格式化字符串。

[查看弗莱姆斯示例](https://flems.io/#0=N4IgtglgJlA2CmIBcBGADGgNCAzvBAxgC7xTIgB0ROI2AZhAjUgNqgB2AhmIkpdbRAEA9uxJjy8AB4AHYQCciAAhHscysJ3kBrHEiXAlLaPvXyI7AOYBdfewCuYAEbx5SgL5KAvAfcBuAB12IOk5RRVRdSV1LWUfAAoTaKJzKwBKbwA+AyClJXl4Int5diUAeScAK3hiCk4cHAhLdnjNHRxMA2MoWyUAEU4SCnZhAHd4jPc07usg9yCQ2QVlVSiCBC1vJQmsnNKlOgVt1eVoJQslNt0MqHxC+EutXRm-JTnA4PZQ5Yi1ZXVhDItokoKYUhZLBkvNlgLlflEwDgtgMhiNxhkALSPdovOG3BAkbHPaDWD55ApFEqXJHZdAYN77PIAfiUAAMACTAVpIgD0SjpaDSVGEADEIFJSPFBe4kZyANSI4ViiVQKVCnCwCAEeDxFBpdyI1kMvJ5fQc4CKoii8WS6WGj7+BbsHl8gCiAA0AIIAWQACgAZV0AZQZMUU8QA5IdhBG0kEw0RI04tLGnXgiAAVCA8YT2RM7aF7PIJpOcABesaULuSsSUnCUX1GSiI2dccNWwgQFFgwkskYAwsUCmIlFmePI9BHOlccHH9h2uz2+6zo83hMJtEpOQCZJHo7H3Ky5+5OgK5-HCmP4Ln81CYXCSxGAI72KSp+eRTvwbu9gdD+AjleE5IFORKzu2n6Lr+rLJm4VobluwA7qW8gHkecydAATBggppperY3vEBb3h+ahfj+fYRoO8jDsoQGTtOTzgaRODkUu8Ssi+Uhrgh25Wruz6vmhx5YQArBg55qPhOZ5kRd5FvCbG-lR-6Aa2wGgTOc55Au37sTB5Y8ZufGAqWFb6uhLFKZR9F1gUSjwGAMhEAAniBnTlFUNREBQ2jwC5OCtExQoIFYRAABbeF4Pi4ewJ5KAAzDhkmCCITmMK45ACNgeCEC2kTkCgABsSCYRiaBIGgIDuNY7hAA)

```
/**
 * Mark entries
 */
export const marks: { [id: string]: number } = {};

/**
 * Start timing 
 */
export const start = (id: string) => {
  return Object.assign(marks, {[id]: Date.now() })[id]
}

/**
 * Clear all 
 */
export const clear = () => {
  for (const id in marks) delete marks[id]; 
};

/**
 * Stop timing and return formatted elapsed time
 */
export const stop = (id: string) => {
  const ms = Date.now() - marks[id];
  delete marks[id];
  return ms > 1000 
    ? `${(ms / 1000).toFixed(0)}s ${+ms.toFixed(0).slice(1)}ms` 
    : `${ms.toFixed(0)}ms`;
}; 
```

示例代码正在导出每个函数。您可以将其放入项目中并从默认`as`导入中相应地调用方法，例如：

```
import * as time from './timer.js'

time.start('foo')

// do something

console.log('elapsed time: ' + time.stop('bar')) 
```

* * *

## 回答 #28

> 赞同：-3
> 
> 时间：2014-03-16T21:21:11.253

如前所述，检查并使用内置计时器。但是，如果您想或需要自己编写，这是我的两分钱：

```
//=-=|Source|=-=//
/**
 * JavaScript Timer Object
 *
 *      var now=timer['elapsed'](); 
 *      timer['stop']();
 *      timer['start']();
 *      timer['reset']();
 * 
 * @expose
 * @method timer
 * @return {number}
 */
timer=function(){
    var a=Date.now();
    b=0;
    return{
        /** @expose */
        elapsed:function(){return b=Date.now()-a},
        start:function(){return a=Date.now()},
        stop:function(){return Date.now()},
        reset:function(){return a=0}
    }
}();

//=-=|Google Advanced Optimized|=-=//
timer=function(){var a=Date.now();b=0;return{a:function(){return b=Date.now()-a},start:function(){return a=Date.now()},stop:function(){return Date.now()},reset:function(){return a=0}}}(); 
```

### 编译成功！

*   原始大小：压缩后 219 字节（未压缩 405 字节）
*   编译大小：压缩后 109 字节（未压缩 187 字节）
*   gzip 压缩后的大小节省了 50.23%（不使用 gzip 时节省了 53.83%

* * *

## 回答 #29

> 赞同：-3
> 
> 时间：2021-05-03T16:39:33.153

您还应该考虑阅读有关 bigO 表示法的信息。它可能比计时功能更好地了解正在发生的事情

* * *

## 回答 #30

> 赞同：-7
> 
> 时间：2015-02-03T16:02:59.183

接受的答案是**错误**的！

由于 JavaScript 是异步的，因此接受答案的变量 end 的值是错误的。

```
var start = new Date().getTime();

for (i = 0; i < 50000; ++i) {
// JavaScript is not waiting until the for is finished !!
}

var end = new Date().getTime();
var time = end - start;
alert('Execution time: ' + time); 
```

for 的执行可能非常快，所以你看不到结果是错误的。您可以使用执行某些请求的代码对其进行测试：

```
var start = new Date().getTime();

for (i = 0; i < 50000; ++i) {
  $.ajax({
    url: 'www.oneOfYourWebsites.com',
    success: function(){
       console.log("success");
    }
  });
}

var end = new Date().getTime();
var time = end - start;
alert('Execution time: ' + time); 
```

因此警报会很快提示，但在控制台中您会看到 ajax 请求仍在继续。

这是你应该怎么做的：[https ://developer.mozilla.org/en-US/docs/Web/API/Performance.now](https://developer.mozilla.org/en-US/docs/Web/API/Performance.now)

# regex - 为什么正则表达式“[^<]*<\\?” 当文本没有“<”时表现出指数时间？

> ID：313900
> 
> 赞同：3
> 
> 时间：2008-11-24T11:12:43.660
> 
> 标签：regex

使用 ICU 4.0 正则表达式库，我发现以下正则表达式呈现指数时间：

```
actual: "[^<]*<\?"
C code: "[^<]*<\\?" 
```

目标：找到“<?” 在它之前没有其他“<”的地方

在根本没有“<”字符的纯文本上运行此正则表达式时，它似乎需要指数时间。如果文本至少有一个“<”，那么它很快。我不明白为什么。

“<”上的要求不应该匹配吗？防止这需要回溯？我原以为它会尝试找到第一个“<”，然后测试表达式的其余部分。如果它找不到“<”，那么它就会放弃，因为模式显然无法匹配。

这是 ICU 正则表达式中的错误还是预期的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T11:36:23.283

您将在[正则表达式匹配可以简单快速](http://swtch.com/~rsc/regexp/regexp1.html "正则表达式匹配可以简单快速（但在 Java、Perl、PHP、Python、Ruby 等中很慢）")中找到解释。
正如 MizardX 所说，如果在位置 0 匹配失败，引擎将在位置 1、2 等处再次尝试。如果文本很长，请准备好等待相当长的时间......

解决方案是锚定您的表达式：`"^[^<]*<\?"`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T12:12:14.880

这就是所有格量词和原子团发挥作用的地方。在 Java 中，我会这样做：

```
String regex = "[^<]*+<\\?"; 
```

或这个：

```
String regex = "(?>[^<]*)<\\?"; 
```

无论哪种方式，一旦`[^<]*`零件匹配了所有可能的内容，它就拒绝回溯。如果下一部分在下一个位置无法匹配，则匹配失败。Java 和 PHP 都有这两种特性，而 .NET 有原子组；我不知道其他语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T11:30:37.103

正则表达式引擎不是那么聪明。它将尝试从*每个*位置进行匹配，并且*每次*从末尾开始搜索`<?`，然后回溯到匹配尝试的开始。这给出了二次时间复杂度 O( *n* ² )。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T11:36:07.980

不幸的是，这是意料之中的。来自[RegularExpressions.info](http://www.regular-expressions.info/engine.html)

> 理解这一点非常重要：
> **正则表达式导向的引擎将始终返回最左边的匹配，即使稍后可以找到“更好”的匹配**。
> 
> 将正则表达式应用于字符串时，引擎将从字符串的第一个字符开始。它将在第一个字符处尝试正则表达式的所有可能排列。
> 只有在尝试了所有可能性并发现失败时，引擎才会继续处理文本中的第二个字符。
> 同样，它将以完全相同的顺序尝试所有可能的正则表达式排列。
> 结果是正则表达式导向的引擎将返回最左边的匹配。

因此，在 ABC 上，它尝试“ABC”，失败，尝试“BC”，失败，然后尝试“C”并失败。如果不是因为贪婪的“[^<]”实际上一直成功到最后，它没有找到<？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T18:27:47.633

# [Perl 重新转储](http://search.cpan.org/perldoc?re)

*抱歉发了这么长的帖子。为清楚起见，对示例输出进行了编辑。*

## Perl 正则表达式引擎采用捷径。所以我的第一次运行并没有输出任何有用的东西。

```
perl -Mre=debug -e' "abcdefghijklm" =~ /[^<]*<[?]/; '

Compiling REx "[^<]*<[?]"
Final program:
   1: STAR (13)
   2:   ANYOF[\0-;=-\377{unicode_all}] (0)
  13: EXACT <<?> (17)
  17: END (0)
floating "<?" at 0..2147483647 (checking floating) minlen 2 
Guessing start of match in sv for REx "[^<]*<[?]" against "abcdefghijklm"
Did not find floating substr "<?"...
Match rejected by optimizer
Freeing REx: "[^<]*<[?]" 
```

## 所以为了让它输出一些有用的东西，我必须欺骗正则表达式引擎，让它认为它可能会成功。

```
perl -Mre=debug -e' "ab<?" =~ /[^<]*(?!<)<[?]/; '

Compiling REx "[^<]*(?!<)<[?]"
Final program:
   1: STAR (13)
   2:   ANYOF[\0-;=-\377{unicode_all}] (0)
  13: UNLESSM[0] (19)
  15:   EXACT <<> (17)
  17:   SUCCEED (0)
  18: TAIL (19)
  19: EXACT <<?> (23)
  23: END (0)
floating "<?" at 0..2147483647 (checking floating) minlen 2 
Guessing start of match in sv for REx "[^<]*(?!<)<[?]" against "ab<?"
Found floating substr "<?" at offset 2...
Guessed: match at offset 0
Matching REx "[^<]*(?!<)<[?]" against "ab<?"

# Start at first pos()
#      |
#      V
   0 <> <ab<?>               |  1:STAR(13)
                                  ANYOF[\0-;=-\377{unicode_all}] can match 2 times out of 2147483647...
   2 <ab> <<?>               | 13:  UNLESSM[0](19)
   2 <ab> <<?>               | 15:    EXACT <<>(17)
   3 <ab<> <?>               | 17:    SUCCEED(0)
                                      subpattern success...
                                    failed...
# try with one fewer [^<]*
   1 <a> <b<?>               | 13:  UNLESSM[0](19)
   1 <a> <b<?>               | 15:    EXACT <<>(17)
                                      failed...
# try with one fewer [^<]* again
   1 <a> <b<?>               | 19:  EXACT <<?>(23)
                                    failed...
# try with zero [^<]*
   0 <> <ab<?>               | 13:  UNLESSM[0](19)
   0 <> <ab<?>               | 15:    EXACT <<>(17)
                                      failed...
   0 <> <ab<?>               | 19:  EXACT <<?>(23)
                                    failed...
                                  failed...

# Start at second pos()
#       |
#       V
   1 <a> <b<?>               |  1:STAR(13)
                                  ANYOF[\0-;=-\377{unicode_all}] can match 1 times out of 2147483647...
   2 <ab> <<?>               | 13:  UNLESSM[0](19)
   2 <ab> <<?>               | 15:    EXACT <<>(17)
   3 <ab<> <?>               | 17:    SUCCEED(0)
                                      subpattern success...
                                    failed...
   1 <a> <b<?>               | 13:  UNLESSM[0](19)
   1 <a> <b<?>               | 15:    EXACT <<>(17)
                                      failed...
   1 <a> <b<?>               | 19:  EXACT <<?>(23)
                                    failed...
                                  failed...

# Start at third and final pos()
#        |
#        V
   2 <ab> <<?>               |  1:STAR(13)
                                  ANYOF[\0-;=-\377{unicode_all}] can match 0 times out of 2147483647...
   2 <ab> <<?>               | 13:  UNLESSM[0](19)
   2 <ab> <<?>               | 15:    EXACT <<>(17)
   3 <ab<> <?>               | 17:    SUCCEED(0)
                                      subpattern success...
                                    failed...
                                  failed...
Match failed
Freeing REx: "[^<]*(?!<)<[?]" 
```

万一你错过了它，它`'[^<]*'`会在失败之前尝试尽可能地匹配。想象一下，如果您尝试对一个大文件运行此匹配，却发现最后两个字符不是`'<?'`.

## 一个更好的主意是使用最大匹配，以及行首，零宽度断言。

*`^`在下文中是 BOL（行首）。*

```
perl -Mre=debug -e' "abcdefghijklm<?" =~ /^[^<]*+(?!<)<[?]/; '

Compiling REx "^[^<]*+(?!<)<[?]"
Final program:
   1: BOL (2)
   2: SUSPEND (18)
   4:   STAR (16)
   5:     ANYOF[\0-;=-\377{unicode_all}] (0)
  16:   SUCCEED (0)
  17: TAIL (18)
  18: UNLESSM[0] (24)
  20:   EXACT <<> (22)
  22:   SUCCEED (0)
  23: TAIL (24)
  24: EXACT <<?> (28)
  28: END (0)
floating "<?" at 0..2147483647 (checking floating) anchored(BOL) minlen 2 
Guessing start of match in sv for REx "^[^<]*+(?!<)<[?]" against "abcdefghijklm<?"
Found floating substr "<?" at offset 13...
Guessed: match at offset 0
Matching REx "^[^<]*+(?!<)<[?]" against "abcdefghijklm<?"
   0 <> <abcdefghij>         |  1:BOL(2)
   0 <> <abcdefghij>         |  2:SUSPEND(18)
   0 <> <abcdefghij>         |  4:  STAR(16)
                                    ANYOF[\0-;=-\377{unicode_all}] can match 13 times out of 2147483647...
  13 <defghijklm> <<?>       | 16:    SUCCEED(0)
                                      subpattern success...
  13 <defghijklm> <<?>       | 18:UNLESSM[0](24)
  13 <defghijklm> <<?>       | 20:  EXACT <<>(22)
  14 <defghijklm<> <?>       | 22:  SUCCEED(0)
                                    subpattern success...
                                  failed...
Match failed
Freeing REx: "^[^<]*+(?!<)<[?]" 
```

您应该注意到，这比前面的示例失败得更快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T04:56:07.937

我不是正则表达式引擎实际工作原理的专家，但我知道有些（全部？）是贪婪的，并且会尽可能早地尝试匹配。因此，假设您有`s`要匹配的字符串，该字符串没有`'<'`字符。它将首先匹配`[^<]*`正则表达式的一部分，基本上匹配从`s[0]`to `s[n-1]`(`s`是零索引并且没有 c 字符串的细微之处，所以这是整个字符串)。然后它将在模式中的下一个元素（`'<'`字符）上失败。接下来，它将回溯到匹配`[^<]*`from `s[0]`to `s[n-2]`，尝试匹配`'<'`，然后再次失败。这将重复，直到它在位置 0 匹配长度为 0 的字符串（注意`*`匹配零次或多次重复，最后一种情况是零次重复）。因此，它将确定从位置 0 开始不会导致成功匹配，因此它将重复上述操作，这次从 开始匹配字符的范围`s[1]`，只是在用完所有这些范围后再次失败。然后它将从位置 2 开始，依此类推，直到它尝试在最后一个字符之后匹配。然后就会放弃。

**编辑：**`<?`您的正则表达式将基本上匹配以结尾且不包含另一个 的字符串的任何部分，`<`例如在`<<?`它匹配`<?`和在`ba<abc<?def`它匹配`abc<?`。提供的其他一些建议的行为会有所不同。特别是，`^[^<]*<\?`将不匹配这两个示例中的任何内容。

# c# - 我可以向函数添加属性以防止重入吗？

> ID：313910
> 
> 赞同：8
> 
> 时间：2008-11-24T11:22:51.843
> 
> 标签：c#, function, attributes, reentrancy

目前，我有一些看起来像这样的功能：

```
private bool inFunction1 = false;
public void function1()
{
    if (inFunction1) return;
    inFunction1 = true;

    // do stuff which might cause function1 to get called
    ...

    inFunction1 = false;
} 
```

我希望能够像这样声明它们：

```
[NoReEntry]
public void function1()
{
    // do stuff which might cause function1 to get called
    ...
} 
```

有没有我可以添加到函数中以防止重新进入的属性？如果没有，我将如何制作一个？我听说过可用于在函数调用前后添加代码的 AOP 属性；他们合适吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-24T11:47:45.430

不要使用 bool 并直接设置它，而是尝试使用 long 和 Interlocked 类：

```
long m_InFunction=0;

if(Interlocked.CompareExchange(ref m_InFunction,1,0)==0)
{
  // We're not in the function
  try
  {
  }
  finally
  {
    m_InFunction=0;
  }
}
else
{
  // We're already in the function
} 
```

这将使检查线程安全。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-24T11:37:41.097

如果没有汇编和 IL 重写，您将无法创建自定义属性来以您描述的方式修改代码。

我建议您改用基于委托的方法，例如对于单个参数的函数：

```
static Func<TArg,T> WrapAgainstReentry<TArg,T>(Func<TArg,T> code, Func<TArg,T> onReentry)
{
    bool entered = false;
    return x =>
    {
        if (entered)
            return onReentry(x);
        entered = true;
        try
        {
            return code(x);
        }
        finally
        {
            entered = false;
        }
    };
} 
```

此方法采用要包装的函数（假设它与 Func<TArg,T> 匹配 - 您可以编写其他变体，或者更努力地编写完全通用的版本）和在重新进入的情况下调用的替代函数。（备用函数可能会抛出异常，或立即返回等。）然后，在您通常调用传递方法的整个代码中，您改为调用 WrapAgainstReentry() 返回的委托。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-24T14:57:10.757

您可以构建一个 PostSharp 属性来检查该方法的名称是否在当前堆栈跟踪中

```
 [MethodImpl(MethodImplOptions.NoInlining)]
    private static bool IsReEntry() {
        StackTrace stack = new StackTrace();
        StackFrame[] frames = stack.GetFrames();

        if (frames.Length < 2)
            return false;

        string currentMethod = frames[1].GetMethod().Name;

        for (int i = 2; i < frames.Length; i++) {
            if (frames[i].GetMethod().Name == currentMethod) {
                return true;
            }
        }

        return false;
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T11:32:18.830

您可能会发现您可以使用[PostSharp](http://www.postsharp.org/)来完成此任务 - 以及 Anthony 关于使用 try/finally 的建议。不过很可能会很乱。还要考虑您是否希望重入基于每个线程或每个实例。（多个线程是否可以调用方法开始？）

框架本身没有这样的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T11:30:23.873

没有预定义的此类属性。您可以创建新属性，但这对您没有帮助。问题是使自定义属性阻止再次调用该方法，我认为这是不可行的。

lock 语句不是您想要的，因为这会导致调用阻塞和等待，而不是立即返回。

PS：在上面的示例中使用 try ... finally 块。否则，如果在函数中间抛出异常，inFunction1 将保持为真，所有调用将立即返回。

例如：

```
if (inFunction1) 
   return;

try
{
  inFunction1 = true;

  // do stuff which might cause function1 to get called
  ...
}
finally 
{
  inFunction1 = false;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-24T11:34:34.817

如果这是为了线程安全，您必须小心该变量。

在第一个线程设置变量之前，另一个线程可能会进入函数并通过检查。

确保它被标记为 volatile，如下所示：

```
private volatile bool inFunction1 = false; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-14T03:48:37.847

这个线程有点旧，但我认为值得将它带到 2012 年，因为这个问题仍然存在（或多或少）。我能够使用使用 Reflection.Emit （特别是使用[LinFu.DynamicProxy](http://www.codeproject.com/Articles/20884/Introducing-the-LinFu-Framework-Part-I-LinFu-Dynam)）生成的代理对象来解决这个问题。LinFu 文章比这篇文章更早，所以我认为它讨论的所有内容在被问到时都是相关的（但不知何故今天仍然存在）。

我使用 LinFu 是因为我已经将它用于其他目的，但我确信其他一些可用的 DynamicProxy 框架对您有用（例如 Castle.DynamicProxy），或者您可以基于 Reflection.Emit 推出自己的框架（不适用于那些性格软弱）。它们提供了一种机制，可以填补 AOP 的大部分角色，同时让您控制自己的代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-24T11:30:55.480

我不认为这是可能的。

最接近的是“同步”属性，但这将阻止所有后续调用。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-02-22T12:24:17.597

您可能需要考虑通过修改您的设计来避免重入，以便它在之前的调用完成之前永远不会调用 function1()。对我来说，上面的function1（）似乎缺少一层。

# java - Swing JDialog 中的自定义光标

> ID：313916
> 
> 赞同：4
> 
> 时间：2008-11-24T11:27:08.077
> 
> 标签：java, swing, jdialog, joptionpane, custom-cursor

我有一个 Java Swing 应用程序，使用 Java 1.5 在 Mac OS X 10.5 上开发。

当用户将鼠标移动到对话框中的某些文本上时，我试图使自定义光标出现。但是，光标永远不会改变。

当我不使用 JFrame 而不是 JDialog 时，光标会发生变化。但是我必须自己编写所有的对话代码。

如何让光标出现？

这是我可以创建来演示问题的最简单的代码：

```
import javax.swing.*;
import java.awt.*;

public class CursorTest {

    public static void main(String[] args) {
        JLabel label = new JLabel("Move mouse here for hand cursor");
        label.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
        JOptionPane pane = new JOptionPane(label);
        pane.setOptions(new Object[]{"OK"});

        JDialog dialog = pane.createDialog(null, "Test Dialog");
        dialog.setVisible(true);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T11:55:46.567

看起来这是 Java 1.5 中的一个错误：我首先尝试使用 Java 1.6.0_07，它按预期工作（在 Windows XP 上）。然后我用 Java 1.5.0_06 重新编译，确实光标保持在默认状态。

知道 Java 1.6 在 MacOS 上的困难，我认为很难解决这个问题......

[错误 ID：5079694 JDialog 不尊重 setCursor](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=5079694 "错误 ID：5079694 JDialog 不尊重 setCursor")
他们提供了一种解决方法...

[编辑]经过测试的解决方法：

```
public class CursorTest extends JFrame
{
  private CursorTest()
  {
  }

  private void ShowDialog()
  {
        JLabel label = new JLabel("Move mouse here for hand cursor");
        label.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
        JOptionPane pane = new JOptionPane(label);
        pane.setOptions(new Object[] { "OK" } );

        JDialog dialog = pane.createDialog(this, "Test Dialog");
        dialog.setVisible(true);
  }

  public static void main(String[] args)
  {
    SwingUtilities.invokeLater(new Runnable()
    {
      public void run()
      {
        CursorTest testFrame = new CursorTest();
        testFrame.setTitle("Test GUI");
        testFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        testFrame.setSize(500, 300);
        testFrame.setVisible(true);
        testFrame.ShowDialog();
      }
    });
  }
} 
```

适用于我的 JDK 和系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T12:13:54.720

感谢 PhiLho，Sun 的错误报告给了我解决方案。所有者（父框架）必须为非空且显示。作为记录，这是我的示例代码的修改版本，它*确实*显示了手形光标。

```
import javax.swing.*;
import java.awt.*;

public class CursorTest {

    public static void main(String[] args) {
        JLabel label = new JLabel("Move mouse here for hand cursor");
        label.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
        JOptionPane pane = new JOptionPane(label);
        pane.setOptions(new Object[]{"OK"});

        JFrame parent = new JFrame();
        parent.setVisible(true);
        JDialog dialog = pane.createDialog(parent, "Test Dialog");
        dialog.setModal(false);
        dialog.setVisible(true);
    }
} 
```

# language-agnostic - 计算数组中的上一个和下一个索引

> ID：313917
> 
> 赞同：0
> 
> 时间：2008-11-24T11:27:41.773
> 
> 标签：language-agnostic

我有一个需要遍历的四个项目的基于 1 的数组。对于数组中的给定索引，我需要计算出下一项的索引和上一项的索引。这听起来很简单，但数组需要环绕。所以当你在数组的开头时，前一项被认为是最后一项。同样，如果您位于数组的末尾，则下一项被视为第一项。

我意识到这可以通过使用条件语句来解决，但我想知道是否可以使用数学方程式来解决。我有一个非常适合下一个项目

```
NextItem = Modulus(CurrentItem, 4) + 1 
```

（模函数返回一个数字除以另一个数字的余数）。

有没有人对我如何解决上一个项目有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T11:31:23.107

由于模数始终在基于 0 的范围上效果更好，因此您可以使用`CurrentItem - 1`.

然后，对于模 4，加 3 与减 1 相同，但具有永远不会变为负数的优点（某些模运算符可能不喜欢负数）。

然后您再次加 1 以返回基于 1 的数字。

这给出了：

```
PrevItem = Modulus(CurrentItem - 1 + 3, 4) + 1 
```

或者，简化：

```
PrevItem = Modulus(CurrentItem + 2, 4) + 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T11:42:01.727

有两件事需要理解，首先，`Modulus(-1,n) = n-1`，其次`Modulus()`最适合`0`基于 - 的索引。结合这两者给出：

```
NextItem = Modulus((CurrentItem-1)+1, NumberOfItems) + 1
PrevItem = Modulus((CurrentItem-1)-1, NumberOfItems) + 1 
```

对于 , 的特定情况`NumberOfItems = 4`，`Modulus(-2,4) = 2`它给出了 Pax 的答案，如果您的系统的 Modulus() 不支持负数但不是很清楚，这可能是必要的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-24T11:44:16.963

它可能取决于您的 Modulus 对负值的属性，但在 Lua 中，以下工作：

```
for i = 1, 8 do
  local idxF = i % 4 + 1
  local idxB = (i - 2) % 4 + 1
  print(i .. " " .. idxF .. " " .. idxB)
end 
```

应该使用`PreviousItem = Modulus(CurrentItem - 2, 4) + 1`您未指定的语言。

# c# - 反序列化字符串列表而不创建新类？

> ID：313918
> 
> 赞同：3
> 
> 时间：2008-11-24T11:27:48.073
> 
> 标签：c#, .net, xml-serialization

我有一个 XML 配置文件，其中包含一组字符串，如下所示：

```
<SomeSetting>value</SomeSetting>
<SomeOtherSetting>value</SomeOtherSetting>
<TypesOfThings>
  <Thing>Type 1</Thing>
  <Thing>Type 2</Thing>
  <Thing>Type 3</Thing>
</TypesOfThings> 
```

这些“事物”成为应用程序前端的选项，供用户选择。

我的问题是我是否必须创建一个事物类才能正确使用序列化，或者有没有办法使用属性将字符串直接读入列表？

例如（为简洁起见，删除了正文和私有变量，这是 .NET 2.0）：

```
[Serializable]
public class Config
{
   public string SomeSetting
   { 
        get;
        set;
   }

   public string SomeOtherSetting
   { 
        get;
        set;
   }

   public List<string> TypesOfThings
   {
      get;
      set;
   }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T11:41:17.767

[您可以使用XmlArrayAttribute](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlarrayattribute.aspx)指定它应该被序列化的方式：

```
[XmlArray(ElementName = "TypesOfThings")]
[XmlArrayItem(ElementName="Thing")]
public List<string> TypesOfThings
{
   get;
   set;
} 
```

编辑：项目的名称是使用[XmlArrayItemAttribute指定的实际情况](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlarrayitemattribute.aspx)

# php - 只返回一个元素，OO PHP

> ID：313921
> 
> 赞同：1
> 
> 时间：2008-11-24T11:29:45.857
> 
> 标签：php, oop

```
class Score
{
    var $score;
    var $name;
    var $dept;
    var $date;

    function Score($score, $name, $dept, $date)
    {
        $this->scores = ($score);
        $this->name = ($name);
        $this->dept = ($dept);
        $this->date = ($date);
    }

    function return_score(){
        return $this->scores;
        return $this->name;
        return $this->dept;
        return $this->date;
    }
}

$newscore = new Score("131313","James", "Marketing", "19/05/2008");
echo $newscore->return_score(); 
```

上面的代码只是回显131313。我刚刚开始学习OO PHP，所以请放轻松！完全迷路了，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T11:34:53.100

每个函数或方法只能返回一个值。

在您的情况下，您应该为每个班级成员提供一个方法：

```
public function getScore() {
   return $this->score;
}

public function getName() {
   return $this->name;
}

public function getDept() {
   return $this->dept;
}

public function getDate() {
   return $this->date;
} 
```

评论后编辑：

您可能还需要一个将所有成员作为单个字符串返回的方法：

```
public function getAll() {
   return $this->getScore(). " " .$this->getName() . " " .$this->getDept(). " " .$this->getDate();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T11:48:17.423

你不能在一个函数中多次返回。您*可以*返回一个连接的字符串：

```
return $this->scores.' '.this->name.' '.$this->dept.' '.$this->date;
//added spaces for readability, but this is a silly thing to do anyway... 
```

我不会推荐它，因为您会将对象的演示与其功能混合在一起 - 不要。

我建议制作某种模板（我想您可能想将这些数据制成表格？）。每行看起来像：

```
<tr>
  <td><?php echo $score->name; ?></td>
  <td><?php echo $score->scores; ?></td>
  <!-- more cells for more properies? -->
</tr> 
```

并给它你的对象或数组中的对象（你知道 foreach{} 吗？）。我知道它看起来更冗长，但从长远来看，将这些问题分开对你**来说**会更好。

用 = 赋值：你不需要在被赋值的东西周围加上括号（通常）。

**另外：** 你在运行 PHP4 吗？您的构造函数表明您是。如果可能的话，我建议迁移到 5.21 或更高版本，因为类和对象要好得多。您还可以使用相当有用的 __construct 方法（而不是使用类命名方法 - 在您的情况下：Score()）。这使得继承和扩展更容易，因为您的类不再需要在两个地方记住它们从哪个类扩展。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T11:52:42.407

首先你应该使用 public、protected 或 private 而不是 var

```
var $score;
var $name;
var $dept;
var $date; 
```

如

```
protected $score; 
```

或带有编码标准前缀的受保护/私有变量和带有下划线的方法

```
protected $_score; 
```

这个方法也可以称为[__construct](http://www.php.net/manual/en/language.oop5.decon.php)

```
function Score($score, $name, $dept, $date)
{ 
```

var 被声明为 score，但您为 score 分配了一个变量。我也不明白为什么你在变量周围有括号。

```
 $this->scores = ($score);
        $this->name = ($name);
        $this->dept = ($dept);
        $this->date = ($date); 
```

用。。。来代替

```
 $this->score = $score;
    $this->name = $name;
    $this->dept = $dept;
    $this->date = $date;

} 
```

遇到的第一个返回将从函数/方法返回该值。我建议您重新编码为每个变量添加 get/set，即 getScore() 或使用 PHP5 方法重载 __set、__get 和 __call。

```
public function getScore() {
        return $this->score;
} 
```

}

您还可以查看设置和获取变量的自动方法[重载](http://www.php.net/manual/en/language.oop5.overloading.php)

# git - 与 GitHub 一起使用的项目管理

> ID：313924
> 
> 赞同：96
> 
> 时间：2008-11-24T11:30:23.920
> 
> 标签：git, open-source, project-management, github, fogbugz

（编辑：对于我的特定问题，这个问题现在已经过时了，因为谷歌代码现在支持 git 并且我已经将协议缓冲区转换为 Mercurial。但是，IMO 仍然很感兴趣。）

我的[C# Protocol Buffers Port](http://github.com/jskeet/dotnet-protobufs/tree/master)使用 github 进行源代码控制，我开始真正喜欢使用 git。然而，据我所知，github 没有提供任何项目管理工具：缺陷和功能跟踪、讨论、功能请求、文档等。鉴于我的隶属关系，[Google Code](http://code.google.com)将是一个自然的选择，但看起来很奇怪在那里创建一个项目，但在 github 上托管源代码。

[这个关于 Fogbugz/Assembla](https://stackoverflow.com/questions/39186/should-i-use-githubfogbugz-or-assembla)的问题似乎主要集中在缺陷跟踪上。我想知道其他人在更“完整”的项目管理解决方案方面有什么经验。Fogbugz 真的能做我需要的一切吗？（将 wiki 用于文档有其优势，尽管我也希望能够随代码一起分发文档。）除了第一段中提到的明确功能之外，还有其他我可能错过的项目方面我*应该考虑吗？*

这肯定会成为一个开源项目，虽然我宁愿不付钱，但我不介意是否需要少量费用。目前我是唯一的开发人员，但这可能会改变，很可能会有很多人提交错误和功能请求。（换句话说，我希望并期待它很受欢迎，但大部分工作都是由我完成的。）

以前我为各种开源项目做出了贡献，但在运行一个非常可见和活跃的项目方面做得并不多*。*（[MiscUtil](http://pobox.com/~skeet/csharp/miscutil)目前仍然“托管”在我的网站上，偶尔会发布 - 实际的源代码控制在我的本地 NAS 上。）

有人愿意分享他们的经验吗？

编辑：我现在正在考虑的另一个选择是谷歌代码项目（我真的很想忠于我的雇主）和偶尔从 git 合并到 svn（至少，每次我发布）。这也将允许非 git 用户轻松获取源代码。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-11-24T18:02:53.143

如果您认为您真的会成为[唯一的开发人员](https://stackoverflow.com/questions/3180/anyone-soloing-using-fogbugz#3274)，Fogbugz 将帮助您保持理智。Fogbugz 是一个很棒的产品，它建立了有针对性的沟通，可以把任何事情变成一个案例（问题）。它和我见过的任何系统一样好。

但它的定位是商业的——用户和技术支持之间的有效沟通、提高日程安排的可靠性、关注和优先考虑正在处理的事情、分开内部和外部讨论、一些好的报告来跟踪事情的处理情况。（关于我能想到的唯一批评是它没有进行大小写阻塞和依赖跟踪，这对于那些深埋的错误非常有用。）

此功能集几乎不会帮助您构建一个活跃的开源项目，具有开放活跃的沟通和构建社区的需求，并随着项目的发展让用户演变为开发人员。因此，如果这就是您想要结束的地方，您可能真的想要这些轻量级跟踪系统之一的不太集中的通信渠道。

我还没有在项目中使用过 Google Code，但在透明和开放的沟通方面，它看起来像是对活跃的开源项目的良好支持。再加上你已经知道了。如果您想增加对项目的参与，Google 代码看起来是不错的选择。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-04-16T22:34:57.763

GitHub 最近推出了自己的[问题跟踪器；](http://github.com/blog/411-github-issue-tracker)不过，我还没有进行竞争分析来确定它如何衡量该线程中提到的其他选项。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-24T13:51:06.553

我使用 GitHub 和[Lighthouse](http://lighthouseapp.com/)进行问题跟踪。与其他一些选项相比，它有点简单，但同时，如果您只想要一个不必太担心的轻量级工具，它也能很好地工作。如果您愿意，它可以与 GitHub 集成，并且对于开源项目也是免费的。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-22T23:31:02.077

像往常一样，当有人问这个问题时，我在[这个](https://stackoverflow.com/questions/349605/what-is-a-good-project-management-software-for-many-small-projects)问题中提到了[Redmine 。](http://redmine.org/)我知道这个问题已经有了它的“最佳答案”，但我认为值得一提。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-11-24T12:29:47.467

我们使用[bitbucket.org](http://bitbucket.org/)，它不是 GIT，它是 Mercurial* ，但它确实有每个分支的错误/问题跟踪等。

我认为将这些东西与您管理源代码的位置集成以在提交消息中交叉引用诸如问题编号之类的东西会非常有用。或修复了包含代码修订号的问题的消息。如果您选择单独的 BTS（如 Google 代码），您将失去此功能。正如其他答案中提到的，Trac 非常擅长集成。

编辑：我应该说，对于我最广泛使用的开源项目，我们确实有它：

1.  Bitbucket（源代码管理）
2.  Launchpad（用户错误报告、翻译管理）
3.  自托管 Trac（wiki、项目和开发人员问题跟踪、源代码镜像）
4.  谷歌代码（文件下载）

我知道这听起来很疯狂，但我们会从每项服务中挑选出最好的部分。令人惊讶的是，没有人抱怨。

`*`无论如何，这在我看来更好，但请不要喷我。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-11-24T12:16:09.413

你考虑过[Trac](http://trac.edgewall.org/)吗？

似乎对[git-Trac 集成](http://news.ycombinator.com/item?id=167887)有“热情”的评论。

我对这些工具没有个人经验，但您可能想查看集成。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-26T23:52:02.987

我在某些地方使用 github 和 google 代码。谷歌代码的问题跟踪器足够好，但我无法处理颠覆。

看一下我的[java memcached 客户端](http://code.google.com/p/spymemcached/)的例子——尤其是顶部的源选项卡。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-22T23:17:11.433

在工作中，我们使用 FogBugz，在我看来，它是迄今为止同类产品中最好的工具。我会将它用于我从事的非盈利项目，除了超过 2 个用户它是如此昂贵。

对于非盈利项目，我们使用[Lighthouse](http://lighthouseapp.com)进行问题跟踪。它的成本没问题，坦率地说，我在它的价格范围内找不到任何合适的替代品。Trac 的问题跟踪比 Bugzilla 的要好一点……我知道很多人都喜欢 Trac，但我发现它非常不灵活。Trac 的不足将我们引向了 Lighthouse。

我的非营利项目正在考虑迁移到[Bitbucket](http://bitbucket.org)。除了问题跟踪之外，它还可以让我们从 beanstalkapp.com 整合我们的存储库，以及添加一个 wiki。

话虽如此，如果 FogBugz-on-Demand 的定价甚至与 Lighthouse.app 的小用户数量相差无几，我会立即将我们转移到那里。当你在工作中使用 FB，然后在晚上使用 Lighthouse.app 时......使用 Lighthouse 感觉就像你的手臂被砍掉了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-18T07:58:33.790

[Mingle通过](http://studios.thoughtworks.com/mingle-agile-project-management)[mingle_git](http://github.com/donmullen/mingle_git/)插件支持 git 。Mingle 拥有开源项目的免费[社区许可证。](http://studios.thoughtworks.com/mingle-agile-project-management/pricing-and-license)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-29T20:18:33.343

我也将 github 与 Lighthouse 一起使用。如果您的提交消息包含类似

[#32 状态：已解决]

Lighthouse 将根据提交解决票证 #32，我发现它快速且有用。除此之外，Lighthouse 有点，呃，功能很简单。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-07-27T08:08:52.767

我建议使用[JavaForge](http://www.javaforge.com)作为替代方案，因为它拥有您想要的一切：

*   它提供**Mercurial 和 Git**（或混合）的免费托管。
*   它的问题跟踪器比 GitHub 领先几光年。它非常强大且可定制，可以跟踪需求、功能请求、错误、任务等。
*   它提供文档管理，还提供 WebDAV 访问（与共享文件夹一样容易共享）。
*   它具有内置的 wiki，用于协作创作文档、需求等。
*   它有论坛供讨论。

请注意，该站点由[codeBeamer](http://www.intland.com/products/codebeamer/overview/)提供支持，这是我们经过全球公司实战测试的商业产品。

（免责声明：我们是敏捷 ALM 解决方案的商业提供商。）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-07-20T17:14:44.083

`<plug>`我正在建造[机场](https://airport.runway7.net)。`</plug>`

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-02-01T15:52:38.103

您也可以尝试使用[BusyFlow 之](http://busyflow.com)类的工具。在那里您可以跟踪 GitHub 提交并对其发表评论（评论与 GitHub 同步）。对于其他项目管理方面，BusyFlow 与 Google Calendar、Trello、Basecamp、Pivo​​tal Tracker 等集成。因此您可以在任务、文件和日历事件旁边查看您的 GitHub 项目。

（免责声明：我是 BusyFlow 的联合创始人。）

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-02-09T10:04:37.623

你考虑过 CodePlex 吗？

# .net - 将我的应用程序转换为 .Net 真的是个好主意吗？

> ID：313931
> 
> 赞同：2
> 
> 时间：2008-11-24T11:33:13.727
> 
> 标签：.net

我所有的应用程序都是用本机代码开发的。由于我听到的所有负面消息，我对是否迁移到 .Net 犹豫不决，例如：

1.  响应时间慢
2.  锁定到 Windows
3.  对庞大的 .Net 运行时的依赖使安装变得痛苦和缓慢。

等等等等

您的建议将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T11:38:25.213

不要仅仅为了转换而这样做。

如果您有其他技术原因需要转换，那么您应该考虑它，但要注意这不是一个小改动，尤其是对于较大的项目。

编辑：我还想补充一点，如果您在 .NET 中启动一些小项目会更好，只是为了知道会发生什么，然后再决定是否转换现有项目的有效选项。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-24T11:44:46.917

您的所有三个观点至少有点正确，尽管“1”非常模糊 - 琐碎的 .NET 应用程序确实往往比本机应用程序具有更长的启动时间 - 也许这就是你的意思？

在某些情况下，Mono 是对“2”点的缓解。

MS 对第 3 点的处理速度确实很慢，但我认为他们正在逐渐到达那里，而且互联网速度的普遍提高意味着人们对 10 秒的 Meg 的关心比 5 年前要少得多。

对我来说，最大的问题是几乎所有关于用 C# 编程的东西都比 C++ 好得多（而且我是一个铁杆 C++ 人，书架上有 Meyers 和 Alexandrescu 的书），当你不得不回到 C++ 时，感觉像冷水澡。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T11:39:46.303

缓慢的响应时间可能是错误的。您基本上被锁定在 windows 中（除了不成熟的 Mono），并且您依赖于运行时。也就是说，运行时通常已经安装在大多数系统上（尽管如果失败，您必须确保并提供一种安装它的方法）。

我的问题是，为什么要切换？如果您已经拥有本机代码，那么移植工作将会很痛苦。您的整个开发团队也需要学习新的 .net 语言。为了克服切换到任何语言的障碍，您需要一些陡峭的优势来克服切换到任何语言的障碍，更不用说 .net。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T11:40:05.693

这取决于几个因素。

您的应用程序需要重写吗？.Net 的优势需要多长时间才能抵消重写成本？Windows 锁定对您来说是个问题吗？

.Net 是一个很棒的平台，但它并不适合每个人或每个项目。我会说，当.Net 是新的时，运行时问题是一个更大的问题，在这一点上，IHO 已经变得相当微不足道了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T11:41:15.707

无论第 1 点和第 2 点如何，我都不会太担心 .NET 运行时 - 这些天我很少遇到没有安装它的机器。

至于反应慢，我没有过这种经历。我认为你可以用任何语言编写一个缓慢无响应的应用程序。.NET 从长远来看并不是最糟糕的，使用它对开发人员有巨大的好处。

不过，作为一项规则，我从不在没有真正充分理由的情况下重新开发某些东西。将您的应用程序更新到最新最好的版本可能听起来是个好主意，但通常会导致大量时间损失而收效甚微。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-24T11:42:58.030

重新编写应用程序可能没有令人信服的理由。性能和更小的内存占用将是应用程序的一个持续优势，任何生产力的提高都可能远远超过移植成本。

您可能会从切换到 .Net 的新应用程序中获得一些好处。与 C++ 相比，它会更高效，但代价是运行时依赖、增加的内存占用和一些性能损失。

您还可以选择创建混合系统，将 .Net 前端放在用 C++ 编写的后端上，以提高速度或更好地控制内存消耗。内存消耗对我来说可能是最大的一个。体验过使用大型托管代码应用程序（Oracle Warehouse Builder 和 BIDS）的乐趣，其中应用程序有近半 GB 的内存在使用，这些应用程序的性能是可怕的，即使在高规格的现代 PC 上也是如此。

在这种情况下，控制内存使用（以及相关的 CPU 缓存抖动）、垃圾收集的时间和更简洁的数据结构将是性能上的胜利。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-24T11:52:04.063

切换到**任何**不同的开发语言或框架的开销都非常高。在满足以下所有条件之前，我不会这样做：

*   您的大量客户要求它。
*   您具有进行切换的开发技能。
*   您对当前产品有很好的了解和文档。

因此，这与 .NET 无关。但是假设您确实决定切换（并切换到 .NET），我不会担心响应时间缓慢或 .NET 运行时的可用性。我的 B2B 应用程序都不是一个重大问题。

但是，如果您不想这样做，Windows 锁定肯定会成为一个大问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-24T11:53:13.327

如果您对本机代码感到满意并且决定权在您手中，那为什么要搬家呢？

就个人而言，我不会怀念我使用 C++ 的日子（MFC、COM 等确实没有为生产力做很多事情，恕我直言）。我发现 .Net 和 C# 提供了很好的工具和功能组合。我可以轻松地构建实际上看起来和感觉就像常规 Windows 应用程序的 Windows 应用程序。

我也很高兴 C# 提供了我喜欢的 OO 和声明式编程的有趣组合。该框架并不完整，但还有很多功能仍在添加中。

.Net 最有趣的部分可能是针对该平台的不同语言数量的增加。我欢迎 IronPython 和 IronRuby 的加入，据我了解，随着 Visual Studio 的下一个版本，它们将成为一流的 .NET 语言。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-24T13:04:30.203

您的应用程序不应该明显变慢，但是如果您在终结器队列中留下太多对象，GC 可能会导致执行中的瞬间中断（.Net GC 不是异步的）。从技术上讲，.Net 应该与本机代码一样快，但我已经读过几次它不是：但同时它只是稍微慢一些（正如他们所说，仅在学术或实时情况下相关）。

至于更长的启动时间，您可以生成您的程序集。这会将程序集预编译为本机代码，因此在第一次访问方法时不会产生 JIT 编译成本（请记住，JIT 仅在第一次调用方法时编译，并且在应用程序运行时不再编译跑步）。

我不认为.Net 运行时应该是一个问题：特别是如果您以.Net 2.0 为目标。Windows XP SP2 附带 .Net 2.0，因此任何负责任的客户都不应该有任何问题。

一旦他们在他们的 PC 上安装了该框架，您编译的程序就会*很小*（当您编写 1000 行代码只是为了得到一个小于 1 兆的 DLL 时，这实际上是令人沮丧的）。如果您使用一键部署，则更新成本也非常小（如果您有纪律并将外壳功能放入适当的程序集中）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-24T13:47:17.793

如果您有大量有价值的 C++ 代码，那么这种转换是有意义的。使用 Microsoft C++/CLI，您可以围绕您的本机代码创建一个 .Net 包装类并将这个库出售给其他 .Net 开发人员；）

# sql - 为什么 SQL Server 在使用变量时会变慢？

> ID：313935
> 
> 赞同：20
> 
> 时间：2008-11-24T11:34:37.220
> 
> 标签：sql, sql-server, stored-procedures

我有一个运行超快的 sql 查询，大约一秒钟，当不使用变量时，例如：

```
WHERE id BETWEEN 5461094 and 5461097 
```

但是当我有：

```
declare @firstId int
declare @lastId int

set @firstId = 5461094
set @lastId = 5461097

...
    WHERE id BETWEEN @firstId and @lastId 
```

...查询运行非常缓慢，仅在几分钟后完成。为什么会这样？我需要使用变量。我可以做任何改进来避免这种性能问题吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-24T20:28:03.757

好的，

1.  你是优化者，查询计划是一个工具。
2.  我会给你一个查询，你必须选择车辆。
3.  图书馆里所有的书都有一个序号

我的查询是去图书馆拿 3 到 5 之间的所有书

你会选择一辆合适的自行车，快速、便宜、高效且足够大，可以带回 3 本书。

新查询。

去图书馆取@x 和@y 之间的所有书。

选择车辆。

前进。

这就是发生的事情。如果我要 1 和 Maxvalue 之间的书，你会选择自卸车吗？如果 x=3 和 y=5，那就太过分了。SQL 必须在看到数字之前选择计划。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-24T11:41:04.227

这是因为当值被硬编码时，它可以查找表中数据[的统计信息](http://www.microsoft.com/technet/prodtechnol/sql/2005/qrystats.mspx)，并找出要运行的最佳查询。查看每个查询的执行计划。当您使用变量时，它必须正在扫描。

如果范围总是很小，您可以使用索引提示来帮助解决这个问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T12:30:22.193

有趣的是，这段代码也会很快：

```
DECLARE @sql VARCHAR(8000)

SET @sql = 'SELECT * FROM table_x WHERE id BETWEEN ' + CAST(@firstId AS VARCHAR) + ' AND ' + CAST(@lastId AS VARCHAR)

EXEC (@sql) 
```

(MSSQL 2000)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-24T15:34:28.233

如果这些变量是存储过程的输入变量，您可能会遇到参数嗅探问题。 [http://omnibuzz-sql.blogspot.com/2006/11/parameter-sniffing-stored-procedures.html](http://omnibuzz-sql.blogspot.com/2006/11/parameter-sniffing-stored-procedures.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-18T12:37:50.640

看起来这个查询与存储过程有关，它的执行计划将在第一次执行 proc 时被编译，然后再用于后续执行。

对于 firstid 非常接近 lastid 的情况，编译的计划可能真的很糟糕，但是当值相距很远时它真的很好。

尝试在您的存储过程中启用 WITH RECOMPILE 选项。如果它解决了问题，并且您对每次执行时都重新编译 proc 感到满意（您将受到性能影响），请将其留在那里。如果您仍然对性能不满意，请考虑重新构建 proc，这样它就不需要重新编译。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T11:50:02.413

ID 是否在索引中（例如主键）？如果没有，请尝试添加一个。

另一件事可能是，在第一个（快速）实例中，查询的执行略有不同。我见过的最常见的事情是连接以低效的顺序完成。尝试重新排序连接，或将一些连接转换为子查询。如果您发布更多查询，我们可以提供进一步帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-22T09:31:48.060

实际上，它得到了很好的回答，我只是在这里写了一个解决方法，因为它对我有用：

**使用 SQL 创建存储过程**

```
WHERE id BETWEEN @firstId and @lastId 
```

然后使用参数@firstId 和@lastId 调用存储的过程，它会加速。我仍然不是 100% 为什么它有效，但它有效。

# svn - 颠覆钩子

> ID：313941
> 
> 赞同：8
> 
> 时间：2008-11-24T11:37:22.830
> 
> 标签：svn, hook, svn-hooks

我正在一个项目中工作，其中有配置文件，每个部署应用程序的环境都有一个。

当开发人员修改其中一个文件时，不应允许开发人员单独签入文件，而是将所有文件一起签入，或者至少应通知开发人员需要这样做。

我们怎样才能实现它？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-24T11:48:38.250

我认为您可以编写一个预提交挂钩来执行此操作 - 只需有一个文件列表，如果一个文件被提交，那么它们都必须被提交。

您可以用任何可以编写命令行应用程序的语言编写挂钩。唯一的问题是它们在 SVN 服务器的上下文中运行，并且（至少在传统上，我不知道这是否有所改进），当他们开始时，他们没有得到太多的环境 - 例如，您可能会因为缺少“PATH”而陷入困境。

您的存储库将在“钩子”目录中包含示例批处理文件/shell-script 钩子，但我过去也用 C# 编写过它们。

这个[http://wordaligned.org/articles/a-subversion-pre-commit-hook](http://wordaligned.org/articles/a-subversion-pre-commit-hook)看起来像是对预提交挂钩的一个很好的一般介绍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T12:31:51.923

不，要获取有关交易的信息，您的脚本可以简单地查询 svn 的详细信息。并且 svn 可以提供该信息，它不必在同一台服务器上。

他的意思是，当 subversion 执行你的钩子时，它会在*没有环境*的情况下运行，并且由*svn 服务器本身*运行。您的 svn 挂钩可能需要的任何外部资源都必须可由 svn 服务器帐户访问。根据您的要求，这可能不是问题，假设您不需要某种外部数据库访问等来比较交易。

您最好的选择是查看一些[svn 附带](http://svn.collab.net/viewvc/svn/trunk/contrib/hook-scripts/)的颠覆挂钩作为示例。[SVN Hook Arguments](http://svnbook.red-bean.com/nightly/en/svn-book.html#svn.ref.reposhooks)还列出了每个钩子的调用方式。

# php - PHP/MySQL：检索最后*完整*周的条目

> ID：313962
> 
> 赞同：1
> 
> 时间：2008-11-24T11:46:05.993
> 
> 标签：php, sql, mysql, date

我目前正在使用以下 SQL 从表中检索最近 7 天的条目：

```
purchased >= date_sub(now() ,interval 7 day) 
```

但是，我需要更改它，以便它检索最后一整周的条目（星期六午夜到星期六午夜）。所以基本上，整个星期结果都不会改变，但是当有人在周日早上访问时，他们会焕然一新。

我只是不知道如何计算日子等。另外，是否有内置的 MySQL 函数可以做到这一点？

我希望我已经解释得足够清楚了。这是在 PHP 应用程序中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T12:03:27.643

请参阅 MySQL 函数[YEARWEEK()](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_yearweek)。

所以你可以做类似的事情

```
SELECT * FROM table WHERE YEARWEEK(purchased) = YEARWEEK(NOW()); 
```

您可以使用第二个模式参数更改一周的开始日期

然而，可能更好的是以某种方式计算“上周日 00:00”的日期，然后数据库不必为每一行运行一个函数，但我在 MySQL 中看不到明显的方法. 但是，您可以轻松地在 php 中生成它并执行类似的操作

```
$sunday = date(('Y-m-d H:i:s'), strtotime('last sunday 00:00'));
$sql = "SELECT * FROM table WHERE purchased >= '$sunday'"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T11:55:06.273

MySQL 有一个[WEEK()](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_week)函数，它允许您从日期获取一年中的数字星期。您可以获得（今天的那一周）-1，并将其与您正在过滤的记录的那一周进行比较。

# flash - 当发布的电影具有 wmode="transparent" 时，MouseWheel 不起作用？

> ID：313966
> 
> 赞同：6
> 
> 时间：2008-11-24T11:47:58.627
> 
> 标签：flash, actionscript-2, wmode

我遇到了一个已发布的 Flash 电影的错误。当我将电影嵌入到 HTML 页面（使用 SWFObject 2.1）中，并将 wmode 参数值设置为“透明”时，我所有基于 MouseWheel 事件的函数都停止工作。这部电影是基于AS2。有谁熟悉这个错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T04:00:24.400

当我设置 wmode=transparent 时，鼠标滚轮在 AS3 中也对我不起作用。此外，我的 Flash 应用程序的行为非常奇怪，并且经常使用 wmode=transparent 崩溃。

另外，它在linux下的firefox上似乎根本不起作用……flash应用程序总是高于一切。

我不建议使用 wmode=transparent ，除非您的应用程序适用于非常特定的浏览器并且您已经进行了广泛的测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T19:42:57.030

Adobe Developer Connection 有一个解决方法：

[使用 wmode 支持 FireFox 鼠标滚轮的解决方法](http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&productId=2&postId=13086)

# jquery - 使用 JQuery 将选择属性添加到 Html.DropDownList

> ID：313969
> 
> 赞同：2
> 
> 时间：2008-11-24T11:49:37.640
> 
> 标签：jquery, asp.net-mvc

我有以下html元素：

```
<tr>  
  <td> <label for="casenumber">Case:</label></td>
  <td>
    <%=Html.TextBox("casenumber", "", new Dictionary<string, object>
    {
      {"id", "casenumberID"}
    })%>
  </td>
</tr>
<tr>
  <td><label for="fogbugzUser">Users:</label></td>
  <td>
    <%=Html.DropDownList("UserList", (SelectList)ViewData["UserList"], new Dictionary<string, object>
    {
      {"id", "userlistid"}
    })%>
  </td>
</tr> 
```

现在，当`casenumber`失去焦点时，我想调用数据库以在`UserList`.

这是Javascript：

```
$(function() {
  $("#casenumberID").blur(function() {
    //don't know how to do!!);
  });    
}); 
```

这是客户端脚本：

```
public JsonResult GetOpenByUser(string casenumber)
{
  return Json(userContext.OpenBy(casenumber));
} 
```

问题是如何编写函数“模糊”，以便我可以将文本框的值传递`casenumber`给`GetOpenByUser`？

另外，如何完成该功能`blur`，以便选择与返回的选项具有相同值的选项`GetOpenByUser`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T12:20:22.010

我将[它](http://www.texotela.co.uk/code/jquery/select/)用于 jquery 中的选择框

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T13:53:41.913

您预期的（ASP.NET MVC 独立）方法是正确的：

*   onblur：向数据库发出 Ajax 请求
*   关于 Ajax 成功：读取和解析响应
*   在中选择适当的值`#fogbugzUser`

示例代码，假设您的页面返回带有 ID 的纯字符串，仅此而已。在这里我[`get()`](http://docs.jquery.com/Ajax/jQuery.get#urldatacallbacktype)用来提出请求，但还有更多方法可以做到这一点。

```
$(function() {
  $("#casenumberID").blur(function() {
    $.get(
      "url/to/some.page/fetching.the.userid",
      // this will be turned into URL parameters, e.g.: "casenumberID=15"
      { casenumberID: this.value },
      function(result) {
        /* check if result is a string of numbers only (change for 
         * something that better suits your needs if numbers is not
         * what you expect here */
        if (/^\d+$/.test(result))
          $("#fogbugzUser").val(result);
        else
          alert("Server returned an unexpected result: " + result);
      }
    });    
  });
}); 
```

您还可以在服务器响应中返回 JSON。在这种情况下，[`getJSON()`](http://docs.jquery.com/Ajax/jQuery.getJSON#urldatacallback)将成为你的朋友。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T04:10:18.910

下面是代码，供那些需要它的人使用，测试与 ASP.NET MVC beta 1 一起使用：

服务器端 AJAX：

```
 public JsonResult GetOpenByUser(string casenumber)
    {

        return Json(userContext.OpenBy(casenumber));
    } 
```

的HTML：

```
 <form id="subForm">
    <tr>  
    <td> <label for="casenumber">Case:</label></td>
     <td><%=Html.TextBox("casenumber", "")%> </td>
    </tr>
    <tr>
    <td><label for="fogbugzUser">Users:</label></td>
    <td><%=Html.DropDownList("UserList", (SelectList)ViewData["UserList"])%></td>
    </tr>
</form> 
```

剧本：

```
$(function() {
    $("#casenumber").blur(function() {
        $.getJSON("Home/GetOpenByUser",
    { casenumber: this.value },
    function(result) {
        if (result == "")
            return;

        $("#subForm select[@name='UserList'] option[@selected='selected']").removeAttr("selected"); //remove any selected items
        $("#subForm select[@name='UserList'] option[@value='" + result + "']").attr("selected", "selected"); //select the item that is returned from the server

    });
    });

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T14:31:05.147

或者，或者，对于 JQuery 脚本部分，可以编写

```
$(function() {
    $("#casenumber").blur(function() {
        $.getJSON("Home/GetOpenByUser",
    { casenumber: this.value },
    function(result) {
        if (result == "")
            return;

 $("#UserList").val(this.value)

    });
    });

}); 
```

# c++ - 如何将 std::string 的实例转换为小写

> ID：313970
> 
> 赞同：909
> 
> 时间：2008-11-24T11:49:59.793
> 
> 标签：c++, string, c++-standard-library, tolower

我想将 a 转换`std::string`为小写。我知道这个功能`tolower()`。然而，在过去我遇到过这个函数的问题，无论如何它都不是理想的，因为将它与 a`std::string`一起使用需要遍历每个字符。

有没有 100% 有效的替代方案？

* * *

## 回答 #1

> 赞同：1036
> 
> 时间：2008-11-24T11:59:33.050

改编自[*不太常见的问题*](http://notfaq.wordpress.com/2007/08/04/cc-convert-string-to-upperlower-case/)：

```
#include <algorithm>
#include <cctype>
#include <string>

std::string data = "Abc";
std::transform(data.begin(), data.end(), data.begin(),
    [](unsigned char c){ return std::tolower(c); }); 
```

如果不遍历每个角色，你真的不会逃脱。没有办法知道字符是小写还是大写。

如果你真的讨厌[`tolower()`](https://en.cppreference.com/w/cpp/string/byte/tolower)，这里有一个专门的 ASCII 替代品，我不建议你使用：

```
char asciitolower(char in) {
    if (in <= 'Z' && in >= 'A')
        return in - ('Z' - 'z');
    return in;
}

std::transform(data.begin(), data.end(), data.begin(), asciitolower); 
```

请注意，`tolower()`只能执行每个单字节字符的替换，这对于许多脚本来说是不合适的，尤其是在使用像 UTF-8 这样的多字节编码时。

* * *

## 回答 #2

> 赞同：363
> 
> 时间：2008-11-24T11:57:21.557

[Boost 为此提供了一个字符串算法](https://www.boost.org/doc/libs/1_70_0/doc/html/boost/algorithm/to_lower.html)：

```
#include <boost/algorithm/string.hpp>

std::string str = "HELLO, WORLD!";
boost::algorithm::to_lower(str); // modifies str 
```

[或者，对于非就地](https://www.boost.org/doc/libs/1_70_0/doc/html/boost/algorithm/to_lower_copy.html)：

```
#include <boost/algorithm/string.hpp>

const std::string str = "HELLO, WORLD!";
const std::string lower_str = boost::algorithm::to_lower_copy(str); 
```

* * *

## 回答 #3

> 赞同：296
> 
> 时间：2014-06-05T15:06:39.723

**tl;博士**

**使用[ICU 库](http://www.icu-project.org)。**如果您不这样做，您的转换例程将在您可能甚至不知道存在的情况下静默中断。

* * *

首先你必须回答一个问题：你的*编码*是`std::string`什么？是 ISO-8859-1 吗？或者也许是 ISO-8859-8？还是 Windows 代码页 1252？*您用于将大写转换为小写的任何东西都知道吗？*（或者它是否会因为角色过度而惨遭失败`0x7f`？）

如果您使用 UTF-8（[8 位编码中唯一明智的选择](http://utf8everywhere.org/)）`std::string`作为容器，那么如果您认为自己仍然可以控制事物，那么您已经在欺骗自己了。您将多字节字符序列存储在不了解多字节概念的容器中，并且您可以对其执行的大多数操作也不是！即使是简单的事情`.substr()`也可能导致无效（子）字符串，因为您在多字节序列的中间进行拆分。

一旦你尝试类似`std::toupper( 'ß' )`, 或*任何*`std::tolower( 'Σ' )`编码的东西，你就有麻烦了。因为 1)，该标准一次只对一个字符起作用，所以它根本不可能变成正确的。并且 2)，该标准一次只对一个字符进行操作，因此它无法确定是在一个单词的中间（哪里是正确的），还是在结尾（）。另一个例子是，它应该*根据语言环境产生不同的*结果——几乎在你期望的任何地方，但在土耳其（拉丁小写字母 DOTLESS I）是正确的答案（同样，在 UTF-8 中超过一个字节编码）。*`ß``SS``Σ``σ``ς``std::tolower( 'I' )`*`i``ı`**

 ****因此，*任何*一次在一个字符上工作的大小写转换，或者更糟糕的是，一次一个*字节*，都被设计破坏了。**这包括目前`std::`存在的所有变体。

然后有一点，标准库*的*能力取决于运行您的软件的机器上*支持*哪些语言环境......如果您的目标语言环境不受支持，您会怎么做在您客户的机器上？

所以你*真正*要找的是一个能够正确处理所有这些的字符串类，**而*不是*任何`std::basic_string<>`变体**。

（C++11 注意：`std::u16string`并且*更好*`std::u32string`，但仍然不完美。C++20 带来了，但所有这些都是指定*编码*。在许多其他方面，他们仍然对 Unicode 机制一无所知，如规范化、排序规则、.. .)*`std::u8string`*

 **虽然 Boost*看起来*不错，但在 API 方面，Boost.Locale 基本上是[ICU](http://www.icu-project.org)的包装器。**如果**Boost 是在 ICU 支持下*编译*的……如果不是，Boost.Locale 仅限于为标准库编译的语言环境支持。

相信我，*让*Boost 与 ICU 一起编译有时会很痛苦。（没有包含 ICU 的 Windows 预编译二进制文件，因此您必须将它们与您的应用程序一起提供，*这会*打开一个全新的蠕虫罐......）

所以我个人建议直接从马口中获得完整的 Unicode 支持并直接使用[ICU](http://www.icu-project.org)库：

```
#include <unicode/unistr.h>
#include <unicode/ustream.h>
#include <unicode/locid.h>

#include <iostream>

int main()
{
    /*                          "Odysseus" */
    char const * someString = u8"ΟΔΥΣΣΕΥΣ";
    icu::UnicodeString someUString( someString, "UTF-8" );
    // Setting the locale explicitly here for completeness.
    // Usually you would use the user-specified system locale,
    // which *does* make a difference (see ı vs. i above).
    std::cout << someUString.toLower( "el_GR" ) << "\n";
    std::cout << someUString.toUpper( "el_GR" ) << "\n";
    return 0;
} 
```

编译（本例中使用 G++）：

```
g++ -Wall example.cpp -licuuc -licuio 
```

这给出了：

```
ὀδυσσεύς 
```

注意单词中间的Σ<->σ转换，单词末尾的Σ<->ς转换。没有`<algorithm>`基于 - 的解决方案可以为您提供。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2013-10-09T08:00:34.853

使用 C++11 的基于范围的 for 循环，更简单的代码将是：

```
#include <iostream>       // std::cout
#include <string>         // std::string
#include <locale>         // std::locale, std::tolower

int main ()
{
  std::locale loc;
  std::string str="Test String.\n";

 for(auto elem : str)
    std::cout << std::tolower(elem,loc);
} 
```

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2012-10-10T07:24:12.917

如果字符串包含 ASCII 范围之外的 UTF-8 字符，则 boost::algorithm::to_lower 不会转换这些字符。当涉及 UTF-8 时，最好使用 boost::locale::to_lower。请参阅[http://www.boost.org/doc/libs/1_51_0/libs/locale/doc/html/conversions.html](http://www.boost.org/doc/libs/1_51_0/libs/locale/doc/html/conversions.html)

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2017-01-10T19:53:45.383

另一种使用基于范围的for循环和参考变量的方法

```
string test = "Hello World";
for(auto& c : test)
{
   c = tolower(c);
}

cout<<test<<endl; 
```

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2013-03-28T06:25:54.357

这是对 Stefan Mai 的回应的后续：如果你想将转换的结果放在另一个字符串中，你需要在调用之前预先分配它的存储空间`std::transform`。由于 STL 将转换后的字符存储在目标迭代器中（在循环的每次迭代中递增），因此目标字符串不会自动调整大小，并且您可能会冒着内存踩踏的风险。

```
#include <string>
#include <algorithm>
#include <iostream>

int main (int argc, char* argv[])
{
  std::string sourceString = "Abc";
  std::string destinationString;

  // Allocate the destination space
  destinationString.resize(sourceString.size());

  // Convert the source string to lower case
  // storing the result in destination string
  std::transform(sourceString.begin(),
                 sourceString.end(),
                 destinationString.begin(),
                 ::tolower);

  // Output the result of the conversion
  std::cout << sourceString
            << " -> "
            << destinationString
            << std::endl;
} 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2015-06-12T06:50:29.950

将字符串转换为小写而不用担心 std 命名空间的最简单方法如下

1：带/不带空格的字符串

```
#include <algorithm>
#include <iostream>
#include <string>
using namespace std;
int main(){
    string str;
    getline(cin,str);
//------------function to convert string into lowercase---------------
    transform(str.begin(), str.end(), str.begin(), ::tolower);
//--------------------------------------------------------------------
    cout<<str;
    return 0;
} 
```

2：不带空格的字符串

```
#include <algorithm>
#include <iostream>
#include <string>
using namespace std;
int main(){
    string str;
    cin>>str;
//------------function to convert string into lowercase---------------
    transform(str.begin(), str.end(), str.begin(), ::tolower);
//--------------------------------------------------------------------
    cout<<str;
    return 0;
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-01-29T02:25:50.813

`std::ctype::tolower()`来自标准 C++ 本地化库的内容将为您正确执行此操作。[这是从下面的参考页面](http://en.cppreference.com/w/cpp/locale/ctype/tolower)中提取的示例

```
#include <locale>
#include <iostream>

int main () {
  std::locale::global(std::locale("en_US.utf8"));
  std::wcout.imbue(std::locale());
  std::wcout << "In US English UTF-8 locale:\n";
  auto& f = std::use_facet<std::ctype<wchar_t>>(std::locale());
  std::wstring str = L"HELLo, wORLD!";
  std::wcout << "Lowercase form of the string '" << str << "' is ";
  f.tolower(&str[0], &str[0] + str.size());
  std::wcout << "'" << str << "'\n";
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-09-18T20:20:37.243

**Boost 的替代方案是 POCO (pocoproject.org)。**

POCO 提供了两种变体：

1.  第一个变体在不更改原始字符串的情况下进行复制。
2.  第二个变体更改了原始字符串。
    “就地”版本的名称中始终包含“就地”。

两个版本如下所示：

```
#include "Poco/String.h"
using namespace Poco;

std::string hello("Stack Overflow!");

// Copies "STACK OVERFLOW!" into 'newString' without altering 'hello.'
std::string newString(toUpper(hello));

// Changes newString in-place to read "stack overflow!"
toLowerInPlace(newString); 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2019-05-18T14:40:40.290

我自己的执行大写/小写的模板函数。

```
#include <string>
#include <algorithm>

//
//  Lowercases string
//
template <typename T>
std::basic_string<T> lowercase(const std::basic_string<T>& s)
{
    std::basic_string<T> s2 = s;
    std::transform(s2.begin(), s2.end(), s2.begin(), tolower);
    return s2;
}

//
// Uppercases string
//
template <typename T>
std::basic_string<T> uppercase(const std::basic_string<T>& s)
{
    std::basic_string<T> s2 = s;
    std::transform(s2.begin(), s2.end(), s2.begin(), toupper);
    return s2;
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-01-08T17:48:19.410

**有一种方法可以在不进行 if 测试**的情况下将大写转换为小写，而且非常简单。isupper() 函数/宏对 clocale.h 的使用应该可以解决与您的位置相关的问题，但如果没有，您可以随时调整 UtoL[] 以适应您的需要。

鉴于 C 的字符实际上只是 8 位整数（暂时忽略宽字符集），您可以创建一个 256 字节数组来保存一组替代字符，并在转换函数中使用字符串中的字符作为下标到转换数组。

但是，不是 1 对 1 映射，而是为大写数组成员提供小写字符的 BYTE int 值。您可能会发现[islower() 和 isupper()](http://en.cppreference.com/w/cpp/string/byte/isgraph)在这里很有用。

![在此处输入图像描述](https://i.stack.imgur.com/DBIXl.png)

代码看起来像这样......

```
#include <clocale>
static char UtoL[256];
// ----------------------------------------------------------------------------
void InitUtoLMap()  {
    for (int i = 0; i < sizeof(UtoL); i++)  {
        if (isupper(i)) {
            UtoL[i] = (char)(i + 32);
        }   else    {
            UtoL[i] = i;
        }
    }
}
// ----------------------------------------------------------------------------
char *LowerStr(char *szMyStr) {
    char *p = szMyStr;
    // do conversion in-place so as not to require a destination buffer
    while (*p) {        // szMyStr must be null-terminated
        *p = UtoL[*p];  
        p++;
    }
    return szMyStr;
}
// ----------------------------------------------------------------------------
int main() {
    time_t start;
    char *Lowered, Upper[128];
    InitUtoLMap();
    strcpy(Upper, "Every GOOD boy does FINE!");

    Lowered = LowerStr(Upper);
    return 0;
} 
```

同时，这种方法将允许您重新映射您希望更改的任何其他字符。

这种方法在现代处理器上运行时有一个巨大的优势，不需要进行分支预测，因为没有包含分支的 if 测试。这为其他循环节省了 CPU 的分支预测逻辑，并倾向于防止流水线停顿。

有些人可能会认为这种方法与用于将 EBCDIC 转换为 ASCII 的方法相同。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2019-04-15T09:36:59.740

由于没有一个答案提到即将推出的 Ranges 库，该库自 C++20 起在标准库中可用，目前[在 GitHub 上](https://github.com/ericniebler/range-v3)单独可用`range-v3`，因此我想添加一种使用它执行此转换的方法。

要就地修改字符串：

```
str |= action::transform([](unsigned char c){ return std::tolower(c); }); 
```

要生成新字符串：

```
auto new_string = original_string
    | view::transform([](unsigned char c){ return std::tolower(c); }); 
```

（不要忘记`#include <cctype>`和所需的 Ranges 标题。）

注意：`unsigned char`作为 lambda 参数的使用受[cppreference](https://en.cppreference.com/w/cpp/string/byte/tolower#Notes)启发，其中指出：

> 与 中的所有其他函数一样，如果参数的值既不能表示为也不等于`<cctype>`，则 的行为是未定义的。要在普通s（或s）中安全地使用这些函数，首先应将参数转换为：`std::tolower``unsigned char``EOF``char``signed char``unsigned char`
> 
> ```
> char my_tolower(char ch)
> {
>     return static_cast<char>(std::tolower(static_cast<unsigned char>(ch)));
> } 
> ```
> 
> `char`同样，当迭代器的值类型为or时，它们不应直接与标准算法一起使用`signed char`。相反，将值转换为`unsigned char`first：
> 
> ```
> std::string str_tolower(std::string s) {
>     std::transform(s.begin(), s.end(), s.begin(), 
>                 // static_cast<int(*)(int)>(std::tolower)         // wrong
>                 // [](int c){ return std::tolower(c); }           // wrong
>                 // [](char c){ return std::tolower(c); }          // wrong
>                    [](unsigned char c){ return std::tolower(c); } // correct
>                   );
>     return s;
> } 
> ```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2020-09-29T22:52:22.127

我写了这个简单的辅助函数：

```
#include <locale> // tolower

string to_lower(string s) {        
    for(char &c : s)
        c = tolower(c);
    return s;
} 
```

用法：

```
string s = "TEST";
cout << to_lower("HELLO WORLD"); // output: "hello word"
cout << to_lower(s); // won't change the original variable. 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-08-29T17:18:02.363

在 microsoft 平台上，您可以使用`strlwr`函数系列：http: [//msdn.microsoft.com/en-us/library/hkxwh33z.aspx](http://msdn.microsoft.com/en-us/library/hkxwh33z.aspx)

```
// crt_strlwr.c
// compile with: /W3
// This program uses _strlwr and _strupr to create
// uppercase and lowercase copies of a mixed-case string.
#include <string.h>
#include <stdio.h>

int main( void )
{
   char string[100] = "The String to End All Strings!";
   char * copy1 = _strdup( string ); // make two copies
   char * copy2 = _strdup( string );

   _strlwr( copy1 ); // C4996
   _strupr( copy2 ); // C4996

   printf( "Mixed: %s\n", string );
   printf( "Lower: %s\n", copy1 );
   printf( "Upper: %s\n", copy2 );

   free( copy1 );
   free( copy2 );
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-01-30T21:02:24.137

如果你想要一些简单的东西，这里有一个宏技术：

```
#define STRTOLOWER(x) std::transform (x.begin(), x.end(), x.begin(), ::tolower)
#define STRTOUPPER(x) std::transform (x.begin(), x.end(), x.begin(), ::toupper)
#define STRTOUCFIRST(x) std::transform (x.begin(), x.begin()+1, x.begin(),  ::toupper); std::transform (x.begin()+1, x.end(),   x.begin()+1,::tolower) 
```

但是，请注意@AndreasSpindler 对此[答案](https://stackoverflow.com/a/314320/105539)的评论仍然是一个重要的考虑因素，但是，如果您正在处理的不仅仅是 ASCII 字符。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2017-03-20T05:20:04.203

```
// tolower example (C++)
#include <iostream>       // std::cout
#include <string>         // std::string
#include <locale>         // std::locale, std::tolower

int main ()
{
  std::locale loc;
  std::string str="Test String.\n";
  for (std::string::size_type i=0; i<str.length(); ++i)
    std::cout << std::tolower(str[i],loc);
  return 0;
} 
```

欲了解更多信息：[http ://www.cplusplus.com/reference/locale/tolower/](http://www.cplusplus.com/reference/locale/tolower/)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2019-01-28T21:31:21.767

> 有没有 100% 有效的替代方案？

不

在选择小写方法之前，您需要问自己几个问题。

1.  字符串是如何编码的？纯ASCII？UTF-8？某种形式的扩展 ASCII 传统编码？
2.  无论如何，小写是什么意思？大小写映射规则因语言而异！你想要一些本地化到用户区域的东西吗？你想要在你的软件运行的所有系统上表现一致的东西吗？您是否只想将 ASCII 字符小写并通过其他所有字符？
3.  有哪些库可用？

一旦您对这些问题有了答案，您就可以开始寻找适合您需求的解决方案。没有一种尺寸适合所有地方的所有人！

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2020-03-19T01:12:35.497

试试这个功能:)

```
string toLowerCase(string str) {

    int str_len = str.length();

    string final_str = "";

    for(int i=0; i<str_len; i++) {

        char character = str[i];

        if(character>=65 && character<=92) {

            final_str += (character+32);

        } else {

            final_str += character;

        }

    }

    return final_str;

} 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2017-05-08T07:21:04.207

`fplus::to_lower_case()`从[fplus](https://github.com/Dobiasd/FunctionalPlus)库中使用。

`to_lower_case`在[fplus API](http://www.editgym.com/fplus-api-search/)中搜索

例子：

```
fplus::to_lower_case(std::string("ABC")) == std::string("abc"); 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2018-04-17T12:20:30.167

*复制，因为它不允许改进答案。谢谢所以*

* * *

```
string test = "Hello World";
for(auto& c : test)
{
   c = tolower(c);
} 
```

* * *

**解释：**

`for(auto& c : test)`是一种基于[范围的 for 循环](http://en.cppreference.com/w/cpp/language/range-for)：
`for (`*`range_declaration`*`:`*`range_expression`*`)`*`loop_statement`*

1.  *`range_declaration`*:`auto& c`
    这里的[auto 说明符](http://en.cppreference.com/w/cpp/language/auto)用于自动类型推导。所以类型会从变量初始化器中扣除。

2.  *`range_expression`*:`test`
    本例中的范围是字符串的字符`test`。

字符串的字符`test`可用作 for 循环内的引用 identifier `c`。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2019-03-17T14:35:38.750

C++ 没有为 实现`tolower`或`toupper`实现方法`std::string`，但它可用于`char`. 可以轻松读取字符串的每个字符，将其转换为所需的大小写并将其放回字符串。不使用任何第三方库的示例代码：

```
#include<iostream>

int main(){
    std::string str = std::string("How IS The Josh");
    for(char &ch : str){
        ch = std::tolower(ch);
    }
    std::cout<<str<<std::endl;
    return 0;
} 
```

对于基于字符的字符串操作：[对于字符串中的每个字符](https://stackoverflow.com/questions/9438209/for-every-character-in-string)

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-04-10T19:11:06.857

## 代码片段

```
#include<bits/stdc++.h>
using namespace std;

int main ()
{
    ios::sync_with_stdio(false);

    string str="String Convert\n";

    for(int i=0; i<str.size(); i++)
    {
      str[i] = tolower(str[i]);
    }
    cout<<str<<endl;

    return 0;
} 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-06-22T09:49:44.463

为 ASCII 字符串 to_lower 添加一些可选库，这两个库都是生产级别的，并且具有微优化，预计会比此处现有的答案更快（TODO：添加基准结果）。

Facebook的[愚蠢](https://github.com/facebook/folly/blob/master/folly/String.cpp)：

```
void toLowerAscii(char* str, size_t length) 
```

谷歌的[Abseil](https://github.com/abseil/abseil-cpp/blob/master/absl/strings/ascii.h)：

```
void AsciiStrToLower(std::string* s); 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2022-02-03T10:11:16.957

我写了一个适用于任何字符串的模板版本：

```
#include <type_traits> // std::decay
#include <ctype.h>    // std::toupper & std::tolower

template <class T = void> struct farg_t { using type = T; };
template <template<typename ...> class T1, 
class T2> struct farg_t <T1<T2>> { using type = T2*; };
//---------------

template<class T, class T2 = 
typename std::decay< typename farg_t<T>::type >::type>
void ToUpper(T& str) { T2 t = &str[0]; 
for (; *t; ++t) *t = std::toupper(*t); }

template<class T, class T2 = typename std::decay< typename 
farg_t<T>::type >::type>
void Tolower(T& str) { T2 t = &str[0]; 
for (; *t; ++t) *t = std::tolower(*t); } 
```

用 gcc 编译器测试：

```
#include <iostream>
#include "upove_code.h"

int main()
{

    std::string str1 = "hEllo ";
    char str2 [] = "wOrld";

    ToUpper(str1);
    ToUpper(str2);
    std::cout << str1 << str2 << '\n'; 
    Tolower(str1);
    Tolower(str2);
    std::cout << str1 << str2 << '\n'; 
    return 0;
} 
```

输出：

```
>HELLO WORLD
>
>hello world 
```

* * *

## 回答 #26

> 赞同：-2
> 
> 时间：2018-06-04T02:47:46.877

这可能是将大写转换为小写的另一个简单版本，反之亦然。我用VS2017社区版编译了这个源码。

```
#include <iostream>
#include <string>
using namespace std;

int main()
{
    std::string _input = "lowercasetouppercase";
#if 0
    // My idea is to use the ascii value to convert
    char upperA = 'A';
    char lowerA = 'a';

    cout << (int)upperA << endl; // ASCII value of 'A' -> 65
    cout << (int)lowerA << endl; // ASCII value of 'a' -> 97
    // 97-65 = 32; // Difference of ASCII value of upper and lower a
#endif // 0

    cout << "Input String = " << _input.c_str() << endl;
    for (int i = 0; i < _input.length(); ++i)
    {
        _input[i] -= 32; // To convert lower to upper
#if 0
        _input[i] += 32; // To convert upper to lower
#endif // 0
    }
    cout << "Output String = " << _input.c_str() << endl;

    return 0;
} 
```

注意：如果有特殊字符则需要使用条件检查来处理。

* * *

## 回答 #27

> 赞同：-11
> 
> 时间：2014-07-10T14:20:34.190

我尝试了 std::transform，我得到的只是可恶的 stl criptic 编译错误，只有 200 年前的德鲁伊才能理解（无法转换为 flibidi flabidi 流感）

这工作正常，可以很容易地调整

```
string LowerCase(string s)
{
    int dif='a'-'A';
    for(int i=0;i<s.length();i++)
    {
        if((s[i]>='A')&&(s[i]<='Z'))
            s[i]+=dif;
    }
   return s;
}

string UpperCase(string s)
{
   int dif='a'-'A';
    for(int i=0;i<s.length();i++)
    {
        if((s[i]>='a')&&(s[i]<='z'))
            s[i]-=dif;
    }
   return s;
} 
```

# php - 在 PHP 中展平 PDF？

> ID：313973
> 
> 赞同：6
> 
> 时间：2008-11-24T11:50:29.137
> 
> 标签：php, pdf, flatten

我想知道是否可以使用 PHP 扁平化 PDF？我使用 fpdf 从 PDF 集合中创建和整理，但是当 PHP 处理它时，缺少一些信息，例如注释。

我每个月都会在公司网站上收到数千份 PDF 文件。我确实需要显示评论。我知道我可以使用 JavaScript 调试器 ( ) 在 Acrobat Pro 中将其展平`this.flattenPages()`。无论如何使用PHP自动化和保存信息？只要它显示在文档上，我就不会太在意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T14:42:36.980

这里提到了一堆工具，其中一个可能会做你想做的事：

*   [在 PHP 中编辑 PDF？](https://stackoverflow.com/questions/7364/pdf-editing-in-php)
*   [使用 PHP 生成 PDF](https://stackoverflow.com/questions/265760/generating-pdfs-with-php)

# c# - C#.NET 导入注册表配置单元并解析其内容

> ID：313991
> 
> 赞同：2
> 
> 时间：2008-11-24T11:59:50.677
> 
> 标签：c#, text, registry, parsing, hive

我从注册表中获得了一个 .Hive 文件，我必须对其进行解析并将其内容用作 html 报告的一部分（由此我假设我必须以某种方式转换为文本）。整个事情必须在程序中完成，所以我不能只转换配置单元文件，然后通过我的程序运行它。我目前不知道如何开始这个，所以任何帮助都会很棒。

任何想法都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T12:13:37.607

没有看到输入，很难说出最好的方法是什么。您可能需要使用 RegExp 类来解析您的键和值。如果您可以获得足够干净的值路径，则可以使用 string.Split() 将路径拆分为键数组并使用这些值遍历注册表。

输入集是否包含值的类型，或者您是否可以假设这些值已经存在于注册表中？

关于输入集的更多信息会很有用。一个例子，可能吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-06T14:49:52.993

“.HIVE 文件格式”的快速谷歌指向格式是[binary](http://home.eunet.no/pnordahl/ntpasswd/WinReg.txt)。我将首先查看您是否可以找到正在解析的文件格式的规范。如果您需要解析的文件格式是上面链接的格式，那么您需要使用 System.IO.BinaryReader 来浏览文件。在 C# 中设置一些表示文件格式结构的类或结构并在解析文件时填充它们也可能会有所帮助。然后，您可以对已填充的这些对象进行 HTML 报告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T12:31:36.557

感谢您的回答，我现在设法弄清楚了。它不是解析它正在导入我遇到问题的数据。我创建了一个 hive.out 文件，然后以普通文本方式将其导入。

# c++ - 在 dbx 中单步执行时的 tb_event_death

> ID：313992
> 
> 赞同：2
> 
> 时间：2008-11-24T12:00:15.467
> 
> 标签：c++, multithreading, debugging, solaris, dbx

当我单步执行多线程程序的一个线程时，调试器会中断：

```
0x(some hex ref) : tdb_event_death      : ret
dbx: thread has exited -- next aborted 
```

我的猜测是我正在调试的程序中的某个线程已经停止，但它不是我正在调试的那个，所以我不明白为什么我必须重新启动调试过程才能继续。

我有一个解决方法，我在下一行设置了一个断点然后重新运行，这有效但很烦人，它真的减慢了我的调试速度。有谁知道更好的方法？（例如，单步所有线程）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T09:26:10.557

尝试将环境变量 _THREAD_ERROR_DETECTION 设置为 0

[一些轻松的阅读](http://blogs.oracle.com/quenelle/entry/debugging_tips_for_threaded_programs)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T07:40:32.720

可能发生的情况是某个其他线程已经退出（`next`恢复进程中的所有线程，而不仅仅是您正在调试的线程）。您可以验证这一点：`thread`当您开始调试特定位置时执行此操作，并在收到`next aborted`消息时再次执行此操作。

如果您正在调试的线程不需要与其他线程交互，您可以只恢复那个线程`next <thread_id>`（其中`thread_id`一个`thread`命令打印在哪里）。

提醒一句：如果您的线程需要 malloc() 一些内存，您可能必须恢复其他线程，因为其中一个线程可能持有例如`malloc`锁。

# asp-classic - 经典 ASP：“应用程序”全局对象会导致死锁吗？

> ID：313998
> 
> 赞同：2
> 
> 时间：2008-11-24T12:05:34.457
> 
> 标签：asp-classic, deadlock

在**经典 ASP**中，有一个名为**“应用程序”**的全局对象，所有会话都可以同时访问它。

由于“应用程序”对象是共享资源，它会导致**死锁吗？**

编辑：如果没有，为什么它有**锁定**和**解锁**方法？[参考](http://www.w3schools.com/asp/asp_ref_application.asp)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T12:32:50.207

**死锁**不同于普通的**阻塞**。由于页面是在不同的线程中处理的，如果您想阻止另一个请求修改该共享资源，请使用 Lock，并允许再次修改，您使用 Unlock 方法。问题是，如果您不使用这些方法，*另一个请求可以更改应用程序状态中项目的值，而您依赖的是旧值*。或者两个请求可以尝试同时修改它，这可能会导致问题。Lock 方法导致一个请求等待，直到另一个请求解锁应用程序；之后，它可以继续。

死锁是*线程 A* **锁定** *资源 1*并**等待***资源 2*可用的情况。同时*线程 B*已经**锁定了** *资源 2*需要访问*资源 1*（被*线程 A*锁定）才能继续工作并能够在之后释放资源。在这种情况下，**没有**一个线程可以继续（其中一个**必须终止**以允许继续）。这是一个**僵局**. 如果正确使用，Application.Lock 本身不会导致死锁。但是如果使用不正确，可能会导致死锁（当与另一个需要锁定的共享资源结合使用时，死锁不会得到处理）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T16:03:49.470

锁定 ASP 对象不太可能`Application`导致死锁持续时间超过服务器脚本超时设置。

经典的 ASP`Application`对象具有 Lock 和 Unlock 用于同步对 Application 对象的更改。您可以有多个请求尝试更改相同的值 - 没有锁定，进行更改然后解锁更改可能会丢失。

简单的例子是某种计数器。假设您的代码可以：

```
<%
Application("Count") = Application("Count") + 1
%> 
```

如果您有两个同时请求（req1 和 req2），您可能会“丢失”页面点击 - 实际上是“丢失更新”。

`Application`您可以通过在更新之前锁定变量并在更新后解锁它来防止这种情况：

```
<%
Application.Lock
Application("Count") = Application("Count") + 1
Application.Unlock
%> 
```

如果`Application`在另一个请求线程尝试访问它时被锁定，则该线程将阻塞，直到锁定被释放或超过脚本超时。

如果您忘记解锁一个锁，它将在页面处理完或超过脚本超时后自动释放。

有关详细信息，[请参阅 MSDN](http://msdn.microsoft.com/en-us/library/ms525184.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T12:07:02.223

不，它永远不会阻塞。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T12:08:48.477

死锁是一种情况，其中两个或多个竞争动作正在等待另一个完成，因此永远不会。***************************