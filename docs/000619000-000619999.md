# StackOverflow 问答 000619000-000619999

# javascript - onchange="javascript: document.my_form.submit()" 与普通提交

> ID：619003
> 
> 赞同：0
> 
> 时间：2009-03-06T14:18:58.987
> 
> 标签：javascript, html

我在表单中有一个选择字段：

```
<form id="myform">
<select id="value" onchange="javascript: document.myform.submit()">
    <option>....
</select>
</form> 
```

提交表单后，如果不重新提交表单，就无法使用“返回”按钮。但是，如果我使用常规的“提交”按钮，这是可能的。

您是否知道在仍然能够使用 javascript 'submit()' 的同时获得这种行为的方法？

可访问性不是问题，需要启用 javascript 才能使用此站点，这就是客户想要的方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T14:46:54.927

而是调用一个函数。

```
<select id="value" onchange="sendForm()"> 
```

...脚本块...

```
function sendForm() {
    document.myform.submit()
} 
```

此外，您永远不需要在标签`javascript:`之外指定。`HREF`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T22:47:16.237

“onchange 只在第一次有效？”

您是否重新选择相同的值？onchange 仅在发生更改时触发。如果您希望能够重新选择相同的选项，则需要使用 onblur。

另外你真的应该使用

```
document.getElementById("myform").submit(); 
```

# google-app-engine - Google App Engine - 如何记住用户登录？

> ID：619006
> 
> 赞同：5
> 
> 时间：2009-03-06T14:20:25.630
> 
> 标签：google-app-engine

我无法弄清楚是否可以为使用集成 Google 帐户登录 GAE 应用程序的用户提供“记住我”选项。

有谁知道这是否可行，如果可以，怎么办？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T14:44:25.853

在 Google 登录页面上有*记住我在这台计算机上的复选框。*它对我有用。你需要不同的东西吗？

# hibernate - Hibernate SQL 审计日志

> ID：619010
> 
> 赞同：3
> 
> 时间：2009-03-06T14:20:49.920
> 
> 标签：hibernate

我想在 Hibernate 中审计日志生成的 SQL 语句。我编写了扩展 EmptyInterceptor 的自定义拦截器。我重写**了 onPrepareStatement**方法来获取生成的 SQL。但是当我调试这段代码时，我只会得到没有像这样的参数的生成 SQL。

```
INSERT INTO TableA(Col1,Col2,Col3) VALUES(?,?,?) 
```

如何从 Hibernate 获取包含此类参数值的完整 SQL 语句

```
INSERT INTO TableA(Col1,Col2,Col3) VALUES("Value1","Value2","Value3") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T14:30:51.640

在 hibernate cfg 中，您可以将 hibernate.show_sql 属性设置为 true，这将导致 Hibernate 将执行的语句（没有绑定到查询的参数值）输出到标准输出。

要记录预编译语句和绑定到它们的参数列表，请在您的 commons-logging（或底层日志系统）配置中设置 log4j.logger.org.hibernate.SQL=DEBUG。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-25T01:20:28.233

接受的答案对我不起作用（Postgres 版本 8.3.7-1，驱动程序版本 8.1-407）。

我还必须在日志配置中将“类型”选项设置为 DEBUG：

```
log4j.logger.org.hibernate.type=DEBUG 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T20:18:30.810

看起来，根据您的 log4j 版本，这仍然是一个错误

[https://hibernate.onjira.com/browse/HHH-2835](https://hibernate.onjira.com/browse/HHH-2835)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T21:18:14.743

使用许多为此目的的“JDBC 包装器”之一怎么样？

没有特别的顺序：

1.  P6Spy - [http://sourceforge.net/projects/p6spy/](http://sourceforge.net/projects/p6spy/)
2.  log4jdbc - [http://code.google.com/p/log4jdbc/](http://code.google.com/p/log4jdbc/)
3.  JDBCLogger - [http://jdbclogger.sourceforge.net/](http://jdbclogger.sourceforge.net/)
4.  还有很多很多

# visual-studio-2008 - Visual Studio 2008 - 状态栏图标词汇表？

> ID：619011
> 
> 赞同：6
> 
> 时间：2009-03-06T14:20:50.620
> 
> 标签：visual-studio-2008, ide

我搜索了 Visual Studio 的帮助文件，但找不到任何有关 IDE 主窗口底部状态栏中某些图标含义的信息。

有人知道参考吗？

具体来说，有一个图标在动画页面上显示一副双筒望远镜，并带有向下滚动的框。

[替代文字 http://img515.imageshack.us/img515/358/vs2008statusbar.png](http://img515.imageshack.us/img515/358/vs2008statusbar.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-26T19:01:54.763

在这篇 MSDN 文章的底部，您可以找到带有预定义 VS 状态栏动画的表格：

[http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.shell.interop.ivsstatusbar.animation.aspx](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.shell.interop.ivsstatusbar.animation.aspx)

* * *

0 标准动画图标

1 打印时的动画

2 保存文件时的动画

3 部署解决方案时的动画

4 通过网络同步文件时的动画

5 构建解决方案时的动画

6 搜索时的动画

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-01T10:38:37.380

那将是您的“在文件中查找”动画。

您可以在此图像的底部看到它：

[替代文本 http://msmvps.com/cfs-filesystemfile.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/peterritchie/lean-VS2k8.JPG](http://msmvps.com/cfs-filesystemfile.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/peterritchie/lean-VS2k8.JPG)

我在那里看到的唯一其他图标是构建和保存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T14:27:31.213

AFAIK 只有在您构建项目时出现的图标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T14:29:22.957

你的意思是“错误列表”吗

错误 - 带有白色 X
警告的红色圆圈 - 黄色三角形和黑色！
信息-带蓝色的白色圆圈 i

错误，停止编译代码。
警告，是可以忽略的可能问题（但可能不应该）
信息，告诉你信息

# .net - 是否可以创建 WCF“反向”tcp 通道？

> ID：619015
> 
> 赞同：2
> 
> 时间：2009-03-06T14:24:47.570
> 
> 标签：.net, wcf, .net-3.5

通常，WCF TCP 通道将连接到主机，然后允许您对其进行方法调用。

我想要一个与客户端建立出站连接的服务，但是一旦建立连接，客户端就可以对我的服务进行方法调用，就好像它是一个传统的连接一样。

我怀疑这是某种自定义频道，但想知道是否 a) 这已经完成 b) 是否有任何我应该尝试避免的陷阱

注意-我不是在谈论双工样式回调，而是客户端和服务器继续进行常规样式对话，其中服务器通过标准 wcf 调度程序响应客户端请求-只有底层 tcp 连接的发起者是服务器而不是客户端。

Siz 建议它就像使用双工合同一样简单。稍微扩展要求： a) 禁止客户端与服务器建立连接。因此，如果双工通道建立单独的 tcp 连接，那么这将不起作用。我认为从我的测试中它不会共享 tcp 下的原始连接（有人可以确认吗？）

b) 客户端需要调用服务器上的多个服务，因此设置反向连接的“回调合约”机制会很尴尬，因为需要许多“注册”样式调用才能将它们全部设置好。理想情况下，我想一次设置多个服务 - 使用这种方法可以吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T14:34:06.907

[在此处](http://msdn.microsoft.com/en-us/library/ms730879.aspx)查看 MSDN 。NetTcpBinding 支持双工通信。

在您的情况下，映射到 WCF 术语，所有客户端实际上都将托管服务，而主机实际上是连接到多个主机的客户端。双工通道将允许您双向发送消息。

双工通信并不意味着回调函数，而是整个合约。当客户端打开到主机的双工连接时，它最终会运行自己的服务器，沿着回调合约句柄监听来自服务器的传入调用。发送到客户端 -> 服务器或服务器 -> 客户端的任何消息都将通过所有标准 WCF 基础结构。

公平地说，这并不能完全回答您的问题。但是，要创建任何通道，您将需要连接发起者首先联系某种服务器。所以最简单的方法是双工连接。

# windows - CreateThread 与 fork()

> ID：619019
> 
> 赞同：5
> 
> 时间：2009-03-06T14:26:16.927
> 
> 标签：windows, multithreading, unix, process

我们在 fork() 和 CreateThread 之间有什么关系吗？CreateThread 内部是否调用了 fork()？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-06T14:38:24.760

在 NT 中，基本的工作单元称为线程（即 NT 调度线程，而不是进程。）。用户线程在进程的上下文中运行。当您调用 CreateThread 时，您请求 NT 内核在您的进程上下文中分配一个工作单元（您也有基本上是线程的纤程，您可以自己安排，但这超出了您的问题的主题）。

当您调用 CreateThread 时，您为函数提供了一个入口点，该入口点将在函数被调用后运行。代码必须在进程的虚拟空间内，页面必须有执行权。简单地说，你给了一个函数指针。;)

fork() 是一个 UNIX 函数，它请求内核创建正在运行的进程的副本。父进程获取子进程的pid，子进程获取0（这样你就知道你是谁了）。

如果你想在 Windows 中创建一个进程，你可以调用 CreateProcess 函数，但它的行为不像 fork()。原因是大多数时候您将创建线程，而不是进程。

如您所见，CreateThread 和 fork 之间没有任何关系。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-06T14:32:16.507

fork() 仅存在于 Unix 系统上，它创建一个与调用者状态相同的新进程。CreateThread() 在同一进程中创建一个新线程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T14:40:25.177

Windows 和 Unix 进程模型从根本上是非常不同的，因此无法直接将 API 从一个映射到另一个。

fork() 将当前进程克隆为两个。在父进程中，fork() 返回 pid，在子进程中返回 0。通常这样使用：

```
int pid;
if (pid = fork()) {
    // this code is executed in the parent
} else {
    // this code is executed in the child
} 
```

[Cygwin](http://cygwin.com/)是一个模拟层，用于在 Windows 上构建和运行 Unix 应用程序，它使用 CreateProcess()*模拟*fork() 的行为。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-21T20:14:36.640

您可能想知道 Microsoft 在 Windows 的高端版本中提供了 fork()，其中包含名为*Subsystem for UNIX-based Applications* (SUA) 的组件。您可以在我的回答中找到详细[信息](https://stackoverflow.com/questions/4243880/substitute-for-forking-in-windows/5372260#5372260)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T14:33:02.183

CreateThread - 用于线程，fork - 用于创建重复进程。并且没有本地方法可以为 Windows 提供 fork 功能（至少通过 Win32 ）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-24T16:49:35.130

找到了这个链接，我相信这可能有助于清除一些关于分叉/线程的事实。在这里分享：[http ://www.geekride.com/index.php/2010/01/fork-forking-vs-threading-thread-linux-kernel/](http://www.geekride.com/index.php/2010/01/fork-forking-vs-threading-thread-linux-kernel/)

# c# - Enable/Disable BindingNavigatorItems based on selected row

> ID：619028
> 
> 赞同：0
> 
> 时间：2009-03-06T14:28:25.407
> 
> 标签：c#, .net, winforms, visual-studio-2008, datagridview

I have a winForm with a dataGridView containging members of a team. These members each have an assigned role and other properties that are listed in a column in the grid but for the purpose of what I want to achieve they are irrelevant. I've also added a bindingNavigator with add, edit and delete buttons.

What I would like to implement is that the edit/delete button should be disabled when I select a row containing a team member in a certain role (Key Account Manager and some others) and be enabled when the selected member has no such role.

So, how can I set this up? Is there an event for the current selected row or selecting a new row I can add my code to?

I'm thinking something along he lines of this *pseudocode*:

```
if (SelectedRow.DataboundObject.Role == "KEY_ACCOUNT_MANAGER") 
{
    bindingNavigatorChangeItem.Enabled() = false;
    bindingNavigatordeleteItem.Enabled() = false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T12:27:32.880

I finally figured this out and it's working perfectly. What I had to do was add some code to the SelectionChanged event on my DataGridView:

```
var member = teamRoleBindingSource.Current as TeamRole;

if (member != null && member.RoleCode == "KEY_ACCOUNT_MANAGER")
{
    bindingNavigatorDeleteItem.Enabled = false;
    bindingNavigatorChangeItem.Enabled = false;
} 
```

# java - Java：泛型不适用于我的方法，我还能做什么？

> ID：619031
> 
> 赞同：2
> 
> 时间：2009-03-06T14:30:36.773
> 
> 标签：java, generics

在下面的代码中，我也希望第二种方法是通用的，但是由于我在方法内部创建了 Calendar 对象，**因为[类型擦除](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)，我看不到如何**。一种可能性是传入 Calendar 对象，但这将完全破坏使用此方法的主要目的（不必考虑 Calendar 对象）。

**如何使第二种方法适用于 Calendar 的多个子类，就像第一种方法一样？**

```
public static <U extends Calendar> CalendarMatch<U> tpFromCalendar(U dt)
{
    // we want to do all comparisons on UTC calendars
    dt.setTimeZone(TimeZone.getTimeZone(DEFAULT_TZ_ID));
    return new CalendarMatch<U>(dt);
}

public static CalendarMatch<GregorianCalendar> tpDailyGregorian(int h)
{
    GregorianCalendar dt = new GregorianCalendar(TimeZone.getTimeZone(DEFAULT_TZ_ID));
    dt.clear();
    dt.set(Calendar.HOUR, h);

    // this works because of type inference
    return tpFromCalendar(dt);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T14:42:43.860

这里绝对不需要使用反射。所以不要！

```
public static <U extends Calendar> CalendarMatch<U> tpDailyGregorian(
    int h, CalendarFactory<U> factory
) {
    Calendar dt = factory.create(TimeZone.getTimeZone(DEFAULT_TZ_ID));
    dt.clear();
    dt.set(Calendar.HOUR, h);

    // this works because of type inference
    return tpFromCalendar(dt);
} 
```

在哪里：

```
public interface CalendarFactory<U extends Calender {
     U create(TimeZone timeZone);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T14:34:02.477

签名可以是：

```
public static <U extends Calendar> CalendarMatch<U> tpDailyGregorian(int h, Class<? extends U> clazz); 
```

一种方法是使用反射来实例化您的日历（传入`Calendar`类型）：

```
Constructor<? extends U> c = clazz.getContructor(TimeZone.class);
U dt = c.newInstance(TimeZone.getTimeZone(DEFAULT_TZ_ID)); 
```

当然，对于这个`dt`实例，你只能调用方法`Calendar`而不是`GregorianCalendar`

```
dt.clear();
dt.set(Calendar.HOUR, h);

Date d = dt.getGregorianChange(); //CANNOT CALL THIS! 
```

# sql-server - 从暂存文件中删除重复项

> ID：619032
> 
> 赞同：1
> 
> 时间：2009-03-06T14:30:43.747
> 
> 标签：sql-server, ssis

我有一个临时表，其中包含从数据文件中获取的一系列数据行。

每行都详细说明了对远程系统中行的更改，这些行实际上是每次更改后获取的源行的快照。每行包含用于创建和更新的元数据时间戳。

我现在正在尝试从这些包含所有更新的数据文件中构建一个更新表。我需要一种方法来删除具有重复键的行，只保留具有最新“更新”时间戳的行。

我知道我可以使用 SSIS“排序”转换通过对关键字段进行排序并告诉它删除重复项来删除重复项，但是如何确保它保留的行是具有最新时间戳的行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T14:38:17.553

您可以使用 SSIS 中的排序转换按多列对数据集进行排序。只需按您的主键（或 ID 字段）排序，然后按降序排列您的时间戳列。

有关使用排序转换的更多详细信息，请参阅以下文章？

[http://msdn.microsoft.com/en-us/library/ms140182.aspx](http://msdn.microsoft.com/en-us/library/ms140182.aspx)

有道理？

干杯，约翰

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T15:52:59.103

这将删除与 Col1、Col2 等匹配的行，并且 UpdateDate 不是最新的：

```
DELETE D
FROM   MyTable AS D
       JOIN MyTable AS T
           ON T.Col1 = D.Col1
          AND T.Col2 = D.Col2
          ...
          AND T.UpdateDate > D.UpdateDate 
```

如果 Col1 和 Col2 都为 NULL，则需要将它们视为“匹配”，那么您将需要使用：

```
 ON (T.Col1 = D.Col1 OR (T.Col1 IS NULL AND D.Col1 IS NULL))
      AND (T.Col2 = D.Col2 OR (T.Col2 IS NULL AND D.Col2 IS NULL))
      ... 
```

**编辑**：如果您需要在区分大小写的数据库上进行区分大小写的测试，**那么**在 VARCHAR 和 TEXT 列上使用：

```
 ON (T.Col1 = D.Col1  COLLATE Latin1_General_BIN 
           OR (T.Col1 IS NULL AND D.Col1 IS NULL))
       ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T19:47:08.760

从登台转移到决赛桌时忽略重复是否有意义？

无论如何您都必须这样做，那么为什么不对临时表发出一个查询而不是两个呢？

```
INSERT final
    (key, col1, col2)
SELECT
    key, col1, col2
FROM
    staging s
    JOIN
    (SELECT key, MAX(datetimestamp) maxdt FROM staging ms ON s.key = ms.key AND s.datetimestamp = ms.maxdt 
```

# c# - C# 有扩展属性吗？

> ID：619033
> 
> 赞同：880
> 
> 时间：2009-03-06T14:30:44.747
> 
> 标签：c#, properties, extension-methods

C# 有扩展属性吗？

例如，我可以将扩展属性添加到`DateTimeFormatInfo`调用`ShortDateLongTimeFormat`which 会返回`ShortDatePattern + " " + LongTimePattern`吗？

* * *

## 回答 #1

> 赞同：585
> 
> 时间：2016-01-24T13:22:20.180

### 目前，Roslyn 编译器仍然不支持开箱即用...

到目前为止，扩展属性的价值还不足以包含在以前版本的 C# 标准中。**C# 7**和**C# 8.0**已将此视为提案冠军，但尚未发布，最重要的是，即使已经有实现，他们也希望从一开始就做好。

### 但它会...

**[C# 7 工作列表](https://github.com/dotnet/roslyn/issues/2136)**中有一个**[扩展成员](https://github.com/dotnet/roslyn/issues/112)**项，因此它可能会在不久的将来得到支持。扩展属性的当前状态可以在[Github 的相关项下](https://github.com/dotnet/roslyn/issues/2136)找到。

然而，还有一个更有希望的主题是[“扩展一切”](https://github.com/dotnet/roslyn/issues/6136)，特别关注属性和静态类甚至字段。

### 此外，您可以使用解决方法

如[本文所述](http://www.codeproject.com/Articles/386911/Csharp-Easy-Extension-Properties)，您可以使用`TypeDescriptor`在运行时将属性附加到对象实例的功能。但是，它没有使用标准属性的语法。
它与仅仅添加了定义扩展属性的可能性的语法糖有点不同，例如
`string Data(this MyClass instance)`作为扩展方法的别名，
`string GetData(this MyClass instance)`因为它将数据存储到类中。

我希望 C#7 将提供一个全功能的扩展一切（属性和字段），但是在这一点上，只有时间会证明一切。

并随时做出贡献，因为明天的软件将来自社区。

***更新：2016 年 8 月***

正如 dotnet 团队发布[了 C# 7.0 中的新](https://blogs.msdn.microsoft.com/dotnet/2016/08/24/whats-new-in-csharp-7-0/)功能以及来自[Mads Torgensen](https://social.msdn.microsoft.com/profile/Mads+Torgersen+-+MSFT)的评论：

> 扩展属性：我们有一个（很棒的！）实习生在夏天将它们作为实验实现，以及其他类型的扩展成员。我们仍然对此感兴趣，但这是一个很大的变化，我们需要确信它是值得的。

似乎扩展属性和其他成员仍然是包含在 Roslyn 未来版本中的不错候选者，但可能不是 7.0 版本。

***更新：2017 年 5 月***

[**扩展成员**](https://github.com/dotnet/roslyn/issues/112)已关闭，作为[**扩展所有问题**](https://github.com/dotnet/roslyn/issues/11159)的副本，该问题也已关闭。主要讨论实际上是关于广义上的类型可扩展性。该功能现在[**在此处作为提案**](https://github.com/dotnet/csharplang/issues/192)进行跟踪，并已从[**7.0 里程碑**](https://github.com/dotnet/csharplang/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc+label%3A%22Proposal+champion%22+milestone%3A7.0)中删除。

***更新：2017 年 8 月 - C# 8.0 提议的功能***

虽然它仍然只是一个*提议*的功能，但我们现在对它的语法有了更清晰的认识。请记住，这也将是扩展方法的新语法：

```
public interface IEmployee 
{
    public decimal Salary { get; set; }
}

public class Employee
{
    public decimal Salary { get; set; }
}

public extension MyPersonExtension extends Person : IEmployee
{
    private static readonly ConditionalWeakTable<Person, Employee> _employees = 
        new ConditionalWeakTable<Person, Employee>();

    public decimal Salary
    {
        get 
        {
            // `this` is the instance of Person
            return _employees.GetOrCreate(this).Salary; 
        }
        set 
        {
            Employee employee = null;
            if (!_employees.TryGetValue(this, out employee)
            {
                employee = _employees.GetOrCreate(this);
            }
            employee.Salary = value;
        }
    }
}

IEmployee person = new Person();
var salary = person.Salary; 
```

类似于部分类，但在不同的程序集中编译为单独的类/类型。请注意，您还可以通过这种方式添加静态成员和运算符。正如[Mads Torgensen 播客](https://channel9.msdn.com/Blogs/Seth-Juarez/A-Preview-of-C-8-with-Mads-Torgersen)中提到的，***扩展不会有任何状态（因此它不能将私有实例成员添加到类中），这意味着您将无法添加链接到实例的私有实例数据***。为此调用的原因是它意味着管理内部字典并且可能很困难（内存管理等）。为此，您仍然可以使用前面描述的`TypeDescriptor`/`ConditionalWeakTable`技术，并使用属性扩展，将其隐藏在一个不错的属性下。

[正如这个问题](https://github.com/dotnet/csharplang/issues/840)所暗示的那样，语法仍然会发生变化。例如，`extends`可以替换为`for`某些可能感觉更自然且与 java 相关性较低的部分。

**2018 年 12 月更新 - 角色、扩展和静态界面成员**

*扩展一切都*没有进入 C# 8.0，因为一些缺点解释为这个[GitHub 票](https://github.com/dotnet/csharplang/issues/1711)的结尾。因此，进行了改进设计的探索。[在这里](https://github.com/dotnet/csharplang/issues/1711)，Mads Torgensen 解释了什么是**角色和扩展**以及它们之间的区别：

> 角色允许在给定类型的特定值上实现接口。扩展允许在特定代码区域内对给定类型的所有值实现接口。

可以从两个用例中的先前提案的拆分中看出。扩展的**新语法**如下：

```
public extension ULongEnumerable of ulong
{
    public IEnumerator<byte> GetEnumerator()
    {
        for (int i = sizeof(ulong); i > 0; i--)
        {
            yield return unchecked((byte)(this >> (i-1)*8));
        }
    }
} 
```

那么你就可以做到这一点：

```
foreach (byte b in 0x_3A_9E_F1_C5_DA_F7_30_16ul)
{
    WriteLine($"{e.Current:X}");
} 
```

对于**静态接口**：

```
public interface IMonoid<T> where T : IMonoid<T>
{
    static T operator +(T t1, T t2);
    static T Zero { get; }
} 
```

在上添加**扩展属性**`int`并将其`int`视为`IMonoid<int>`：

```
public extension IntMonoid of int : IMonoid<int>
{
    public static int Zero => 0;
} 
```

* * *

## 回答 #2

> 赞同：439
> 
> 时间：2009-03-06T14:33:40.560

不，它们在 C# 3.0 中不存在，也不会在 4.0 中添加。它在 C# 的功能需求列表中，因此可能会在将来添加。

此时你能做的最好的就是GetXXX风格的扩展方法。

* * *

## 回答 #3

> 赞同：268
> 
> 时间：2009-03-06T14:34:18.543

不，它们不存在。

我知道 C# 团队曾经考虑过它们（或者至少 Eric Lippert 曾经考虑过）——以及扩展构造函数和运算符（这些可能需要一段时间才能让你明白，但是很酷......）但是，我没有没有看到任何证据表明它们将成为 C# 4 的一部分。

* * *

编辑：它们没有出现在 C# 5 中，截至 2014 年 7 月，它看起来也不会出现在 C# 6 中。

[Eric Lippert](https://stackoverflow.com/users/88656/eric-lippert)是微软 C# 编译器团队的首席开发人员，截至 2012 年 11 月，他在 2009 年 10 月的博客中谈到了这一点：

*   [为什么没有扩展属性？– 精彩的编码冒险](https://blogs.msdn.microsoft.com/ericlippert/2009/10/05/why-no-extension-properties/)

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2017-12-04T12:27:34.230

更新（感谢[@chaost](https://stackoverflow.com/users/9033797/chaost)指出此更新）：

> **Mads Torgersen：** “扩展一切并没有进入 C# 8.0。如果你愿意的话，它在关于语言未来的非常激动人心的辩论中被“赶上了”，现在我们要确保我们不会以一种抑制未来可能性的方式添加它。有时语言设计是一场漫长的游戏！

来源：*[https](https://blogs.msdn.microsoft.com/dotnet/2018/11/12/building-c-8-0/)* *: //blogs.msdn.microsoft.com/dotnet/2018/11/12/building-c-8-0/ 中的评论部分*

* * *

我停止计算多年来我打开这个问题的次数，希望看到这个问题得到实施。

好吧，终于我们都可以欢欣鼓舞了！Microsoft 将在其即将发布的 C# 8 版本中引入此功能。

因此，与其这样做...

```
public static class IntExtensions
{
   public static bool Even(this int value)
   {
        return value % 2 == 0;
   }
} 
```

我们终于可以这样做了……

```
public extension IntExtension extends int
{
    public bool Even => this % 2 == 0;
} 
```

来源：[https ://blog.ndepend.com/c-8-0-features-glimpse-future/](https://blog.ndepend.com/c-8-0-features-glimpse-future/)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-04-18T12:54:09.023

正如@Psyonity 提到的，您可以使用 conditionalWeakTable 向现有对象添加属性。结合动态 ExpandoObject，您可以用几行代码实现动态扩展属性：

```
using System.Dynamic;
using System.Runtime.CompilerServices;

namespace ExtensionProperties
{
    /// <summary>
    /// Dynamically associates properies to a random object instance
    /// </summary>
    /// <example>
    /// var jan = new Person("Jan");
    ///
    /// jan.Age = 24; // regular property of the person object;
    /// jan.DynamicProperties().NumberOfDrinkingBuddies = 27; // not originally scoped to the person object;
    ///
    /// if (jan.Age &lt; jan.DynamicProperties().NumberOfDrinkingBuddies)
    /// Console.WriteLine("Jan drinks too much");
    /// </example>
    /// <remarks>
    /// If you get 'Microsoft.CSharp.RuntimeBinder.CSharpArgumentInfo.Create' you should reference Microsoft.CSharp
    /// </remarks>
    public static class ObjectExtensions
    {
        ///<summary>Stores extended data for objects</summary>
        private static ConditionalWeakTable<object, object> extendedData = new ConditionalWeakTable<object, object>();

        /// <summary>
        /// Gets a dynamic collection of properties associated with an object instance,
        /// with a lifetime scoped to the lifetime of the object
        /// </summary>
        /// <param name="obj">The object the properties are associated with</param>
        /// <returns>A dynamic collection of properties associated with an object instance.</returns>
        public static dynamic DynamicProperties(this object obj) => extendedData.GetValue(obj, _ => new ExpandoObject());
    }
} 
```

使用示例在 xml 注释中：

```
var jan = new Person("Jan");

jan.Age = 24; // regular property of the person object;
jan.DynamicProperties().NumberOfDrinkingBuddies = 27; // not originally scoped to the person object;

if (jan.Age < jan.DynamicProperties().NumberOfDrinkingBuddies)
{
    Console.WriteLine("Jan drinks too much");
}

jan = null; // NumberOfDrinkingBuddies will also be erased during garbage collection 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-12T15:33:20.073

因为我最近需要这个，所以我查看了答案的来源：

[c# 通过添加属性来扩展类](https://stackoverflow.com/questions/17616239/c-sharp-extend-class-by-adding-properties)

并创建了一个更动态的版本：

```
public static class ObjectExtenders
{
    static readonly ConditionalWeakTable<object, List<stringObject>> Flags = new ConditionalWeakTable<object, List<stringObject>>();

    public static string GetFlags(this object objectItem, string key)
    {
        return Flags.GetOrCreateValue(objectItem).Single(x => x.Key == key).Value;
    }

    public static void SetFlags(this object objectItem, string key, string value)
    {
        if (Flags.GetOrCreateValue(objectItem).Any(x => x.Key == key))
        {
            Flags.GetOrCreateValue(objectItem).Single(x => x.Key == key).Value = value;
        }
        else
        {
            Flags.GetOrCreateValue(objectItem).Add(new stringObject()
            {
                Key = key,
                Value = value
            });
        }
    }

    class stringObject
    {
        public string Key;
        public string Value;
    }
} 
```

它可能可以改进很多（命名，动态而不是字符串），我目前在 CF 3.5 中使用它和一个 hacky ConditionalWeakTable（[https://gist.github.com/Jan-WillemdeBruyn/db79dd6fdef7b9845e217958db98c4d4](https://gist.github.com/Jan-WillemdeBruyn/db79dd6fdef7b9845e217958db98c4d4)）

# php - MediaWiki 支付网关

> ID：619036
> 
> 赞同：0
> 
> 时间：2009-03-06T14:31:39.907
> 
> 标签：php, wiki, mediawiki, payment-gateway

我想在 MediaWiki 中有一个订阅赞助的 wiki。我希望付费会员能够访问 wiki 的某些部分。我该如何做到这一点？

是否有插件/扩展或是否需要重写？

无论如何，如果我在数据库中标记付费用户，我该如何实现支付网关？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T14:53:07.830

您可以使用页面访问限制扩展：[http](http://www.mediawiki.org/wiki/Extension:Page_access_restriction) ://www.mediawiki.org/wiki/Extension:Page_access_restriction和付费会员的特殊组。

编辑：话虽如此， [mediawiki 不建议您这样做...](http://www.mediawiki.org/wiki/Manual:Preventing_access#Restrict_viewing_of_certain_specific_pages)

# c# - 使用 MVP 模式时我应该在哪里创建 ListViewItem 列表？

> ID：619038
> 
> 赞同：1
> 
> 时间：2009-03-06T14:31:48.177
> 
> 标签：c#, winforms, design-patterns

我编写了一个使用 MVP 模式的小型应用程序，如下所示：

*   我创建了一个名为 IView 的界面
*   我在表单中实现了这个接口
*   将表单实例作为 IView 类型传递到演示者的构造函数中

该表单包含一个 ListView 组件。填充 ListView 的项目是在演示者中创建的。听说在presenter中使用UI组件类不是个好主意。我应该如何以及在哪里创建这些 ListViewItems？我可以在表单本身中创建 ListViewItems，但是表单不需要尽可能轻量级而没有逻辑吗？

编辑：注意这是一个 Windows 窗体应用程序

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T14:57:35.790

> 我可以在表单本身中创建 ListViewItems，但是表单不需要尽可能轻量级而没有逻辑吗？

一个简单的循环和简单的对象创建不被认为是困难的。这样的代码对于视图来说是相当轻量级的：

```
class SomeView 
{
  void SetData(IEnumerable<DataItem> dataItems) 
  {
    foreach(DataItem dataItem in dataItems) 
    {
      ListViewItem lvi = new ListViewItem();
      lvi.Text = dataItem.Text;
      ...
    }
  }
} 
```

此外，您可以使用绑定（如其他人建议的那样）。这将进一步简化 SetData。

尝试保持查看代码如此简单，以便您可以通过快速代码审查来“验证”它:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T14:34:26.203

ListViewItems 是特定于视图的，因此您应该在视图中创建它们。如果您在演示者中创建它们，所有视图都必须依赖于不好的 ListViewItems。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T14:43:58.413

在演示者中创建*数据项*。将这些分配给视图并让视图使用数据绑定来显示数据项：

```
//in presenter
var dataItems = _someService.GetData();
_view.Data = dataItems;

//in view code-behind
public ICollection<DataItem> Data
{
    get; set; //omitted for brevity - will require change notification
}

//in view XAML
<ListView ItemsSource="{Binding Data}">
  <ListView.View>
    <GridView>
      <GridViewColumn DisplayMemberBinding="{Binding Path=Name}"/> 
      <GridViewColumn DisplayMemberBinding="{Binding Path=Age}"/> 
    </GridView>
  </ListView.View>
</ListView> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T14:44:12.687

我最近遇到了同样的难题，但是对于树视图。

为了很好地解决它，您必须使用委托来处理数据到可视元素的创建/转换。

例子：

```
class View
{
  TreeNode Builder(object foo, object bar) { ... }
}

class Presenter
{
  void InitView(View v)
  {
    Model.Build(v.Builder);
  }
} 
```

好的，这很粗略，但它可以让你很容易地构建像树这样的递归结构。:)

注意：模型和视图实际上并不关心彼此的类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T15:17:51.450

WinForms 作为技术不是为 MVP 设计的，所以应该合理地应用关注点分离的好主意。我希望在形式上进行控制，演示者应该没有特定于视图的东西。任何控件本身都会破坏 mvp，因为它包含数据和表示。随着您的应用程序的增长，保持它的 MVP 风格将越来越难。实施 MVP 没有太多好处。通常，使用 WinForms 的传统控件样式（组件样式）效果很好。

# c# - 将 float[] 转换为 byte[] 的最快方法是什么？

> ID：619041
> 
> 赞同：12
> 
> 时间：2009-03-06T14:32:46.880
> 
> 标签：c#, unsafe

我想尽快`byte[]`从 a中得到 a `float[]`，而不是遍历整个数组（可能是通过演员表）。不安全的代码很好。谢谢！

我正在寻找一个比浮点数组长 4 倍的字节数组（字节数组的维度将是浮点数组的 4 倍，因为每个浮点数由 4 个字节组成）。我会将其传递给 BinaryWriter。

**编辑**：对于那些尖叫“过早优化”的批评者：我在优化之前使用 ANTS 分析器对此进行了基准测试。由于文件具有直写缓存，并且浮点数组的大小与磁盘上的扇区大小完全匹配，因此速度显着提高。`pinvoke`二进制编写器包装使用'd win32 API创建的文件句柄。优化是因为这减少了函数调用的数量。

并且，关于内存，这个应用程序创建了使用大量内存的大量缓存。我可以分配一次字节缓冲区并多次重复使用它——在这个特定实例中的双倍内存使用相当于应用程序整体内存消耗的舍入误差。

所以我想这里的教训是不要做出过早的假设；）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-06T15:46:35.983

有一种肮脏的快速*（不是不安全*的代码）方法可以做到这一点：

```
[StructLayout(LayoutKind.Explicit)]
struct BytetoDoubleConverter
{
    [FieldOffset(0)]
    public Byte[] Bytes;

    [FieldOffset(0)]
    public Double[] Doubles;
}
//...
static Double Sum(byte[] data)
{
    BytetoDoubleConverter convert = new BytetoDoubleConverter { Bytes = data };
    Double result = 0;
    for (int i = 0; i < convert.Doubles.Length / sizeof(Double); i++)
    {
        result += convert.Doubles[i];
    }
    return result;
} 
```

这会起作用，但我不确定是否支持[Mono](http://en.wikipedia.org/wiki/Mono_%28software%29)或更新版本的[CLR](http://en.wikipedia.org/wiki/Common_Language_Runtime)。唯一奇怪的是`array.Length`字节长度。这可以解释，因为它查看与数组一起存储的数组长度，并且因为这个数组是一个字节数组，所以长度仍然是字节长度。索引器确实认为 Double 是 8 个字节大，因此不需要计算。

我又找了一些，它实际上在[MSDN](http://en.wikipedia.org/wiki/Microsoft_Developer_Network)上进行了描述，*[如何：使用属性创建 C/C++ 联合（C# 和 Visual Basic）](http://msdn.microsoft.com/en-us/library/acxa5b99.aspx)*，所以将来的版本可能会支持它。不过我不确定Mono。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-06T15:37:32.603

过早优化是万恶之源！@Vlad 建议迭代每个浮点数是比切换到字节 [] 更合理的答案。使用下面的运行时表来增加元素数量（平均 50 次运行）：

```
Elements      BinaryWriter(float)      BinaryWriter(byte[])
-----------------------------------------------------------
10               8.72ms                    8.76ms
100              8.94ms                    8.82ms
1000            10.32ms                    9.06ms
10000           32.56ms                   10.34ms
100000         213.28ms                  739.90ms
1000000       1955.92ms                10668.56ms 
```

对于少量元素，两者之间几乎没有区别。一旦进入大量元素范围，从 float[] 复制到 byte[] 所花费的时间远远超过了好处。

所以选择简单的方法：

```
float[] data = new float[...];
foreach(float value in data)
{
    writer.Write(value);
} 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2010-08-26T16:30:10.227

有一种方法可以避免内存复制和迭代。

您可以使用非常丑陋的 hack 使用（不安全的）内存操作将您的数组临时更改为另一种类型。

我在 32 位和 64 位操作系统中测试了这个 hack，所以它应该是可移植的。

源代码 + 示例用法在[https://gist.github.com/1050703](https://gist.github.com/1050703)维护，但为了您的方便，我也将其粘贴在这里：

```
public static unsafe class FastArraySerializer
{
    [StructLayout(LayoutKind.Explicit)]
    private struct Union
    {
        [FieldOffset(0)] public byte[] bytes;
        [FieldOffset(0)] public float[] floats;
    }

    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    private struct ArrayHeader
    {
        public UIntPtr type;
        public UIntPtr length;
    }

    private static readonly UIntPtr BYTE_ARRAY_TYPE;
    private static readonly UIntPtr FLOAT_ARRAY_TYPE;

    static FastArraySerializer()
    {
        fixed (void* pBytes = new byte[1])
        fixed (void* pFloats = new float[1])
        {
            BYTE_ARRAY_TYPE = getHeader(pBytes)->type;
            FLOAT_ARRAY_TYPE = getHeader(pFloats)->type;
        }
    }

    public static void AsByteArray(this float[] floats, Action<byte[]> action)
    {
        if (floats.handleNullOrEmptyArray(action)) 
            return;

        var union = new Union {floats = floats};
        union.floats.toByteArray();
        try
        {
            action(union.bytes);
        }
        finally
        {
            union.bytes.toFloatArray();
        }
    }

    public static void AsFloatArray(this byte[] bytes, Action<float[]> action)
    {
        if (bytes.handleNullOrEmptyArray(action)) 
            return;

        var union = new Union {bytes = bytes};
        union.bytes.toFloatArray();
        try
        {
            action(union.floats);
        }
        finally
        {
            union.floats.toByteArray();
        }
    }

    public static bool handleNullOrEmptyArray<TSrc,TDst>(this TSrc[] array, Action<TDst[]> action)
    {
        if (array == null)
        {
            action(null);
            return true;
        }

        if (array.Length == 0)
        {
            action(new TDst[0]);
            return true;
        }

        return false;
    }

    private static ArrayHeader* getHeader(void* pBytes)
    {
        return (ArrayHeader*)pBytes - 1;
    }

    private static void toFloatArray(this byte[] bytes)
    {
        fixed (void* pArray = bytes)
        {
            var pHeader = getHeader(pArray);

            pHeader->type = FLOAT_ARRAY_TYPE;
            pHeader->length = (UIntPtr)(bytes.Length / sizeof(float));
        }
    }

    private static void toByteArray(this float[] floats)
    {
        fixed(void* pArray = floats)
        {
            var pHeader = getHeader(pArray);

            pHeader->type = BYTE_ARRAY_TYPE;
            pHeader->length = (UIntPtr)(floats.Length * sizeof(float));
        }
    }
} 
```

用法是：

```
var floats = new float[] {0, 1, 0, 1};
floats.AsByteArray(bytes =>
{
    foreach (var b in bytes)
    {
        Console.WriteLine(b);
    }
}); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-06T15:05:58.453

如果您不希望发生任何转换，我建议使用 Buffer.BlockCopy()。

```
public static void BlockCopy(
    Array src,
    int srcOffset,
    Array dst,
    int dstOffset,
    int count
) 
```

例如：

```
float[] floatArray = new float[1000];
byte[] byteArray = new byte[floatArray.Length * 4];

Buffer.BlockCopy(floatArray, 0, byteArray, 0, byteArray.Length); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-06T15:23:08.503

你最好让 BinaryWriter[为你做这件事](http://msdn.microsoft.com/en-us/library/t7cxfc93.aspx)。无论您使用哪种方法，都会对整个数据集进行迭代，因此使用字节毫无意义。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-06T14:44:53.043

尽管您可以使用and获取`byte*`指针，但您不能将 转换为以便编写器在不执行数据复制的情况下将其作为参数接受。您不想这样做，因为它会使您的内存占用加倍，*并*在不可避免的迭代上添加额外的迭代，以便将数据输出到磁盘。`unsafe``fixed``byte*``byte[]`

 *相反，您最好使用该方法**迭代浮点数组并将每个浮点数`float`单独**`Write(double)`写入编写器。由于写入器内部的缓冲，它仍然会很快。见`sixlettervariables`的数字。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-06T16:39:44.217

我们有一个名为 LudicrousSpeedSerialization 的类，它包含以下不安全的方法：

```
 static public byte[] ConvertFloatsToBytes(float[] data)
    {
        int n = data.Length;
        byte[] ret = new byte[n * sizeof(float)];
        if (n == 0) return ret;

        unsafe
        {
            fixed (byte* pByteArray = &ret[0])
            {
                float* pFloatArray = (float*)pByteArray;
                for (int i = 0; i < n; i++)
                {
                    pFloatArray[i] = data[i];
                }
            }
        }

        return ret;
    } 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-03-06T15:22:02.953

虽然它基本上在幕后做了一个 for 循环，但它确实在一行中完成了这项工作

```
byte[] byteArray = floatArray.Select(
                    f=>System.BitConverter.GetBytes(f)).Aggregate(
                    (bytes, f) => {List<byte> temp = bytes.ToList(); temp.AddRange(f); return temp.ToArray(); }); 
```

# c# - 如何增加 HashTable 中的值？

> ID：619044
> 
> 赞同：2
> 
> 时间：2009-03-06T14:33:54.303
> 
> 标签：c#

我有一个哈希表，我跟踪颜色（这是键）和颜色计数，这是键。

我试图弄清楚当 HashTable 已经包含颜色时如何增加键。这是一个代码片段：

```
Hashtable htColors = new Hashtable();

if (htColors.Contains(color))
{
    // Want to increase the "value" of the key here.       
}
else
{
    htColors.Add(color, 1); //Found color for first time
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T15:15:16.263

我发布这个是迂腐的。我不喜欢与 Dictionary 的接口，因为这种非常常见的访问方式是有成本的——如果你最常见的情况是触及一个已经存在的元素，你必须散列并查找你的值 3 次。不相信我？我在这里写了 DK 的解决方案：

```
static void AddInc(Dictionary<string, int> dict, string s)
{
    if (dict.ContainsKey(s))
    {
        dict[s]++;
    }
    else
    {
        dict.Add(s, 1);
    }
} 
```

当放入 IL - 你得到这个：

```
L_0000: nop 
L_0001: ldarg.0 
L_0002: ldarg.1 
L_0003: callvirt instance bool [mscorlib]System.Collections.Generic.Dictionary`2<string, int32>::ContainsKey(!0)
L_0008: ldc.i4.0 
L_0009: ceq 
L_000b: stloc.0 
L_000c: ldloc.0 
L_000d: brtrue.s L_0028
L_000f: nop 
L_0010: ldarg.0 
L_0011: dup 
L_0012: stloc.1 
L_0013: ldarg.1 
L_0014: dup 
L_0015: stloc.2 
L_0016: ldloc.1 
L_0017: ldloc.2 
L_0018: callvirt instance !1 [mscorlib]System.Collections.Generic.Dictionary`2<string, int32>::get_Item(!0)
L_001d: ldc.i4.1 
L_001e: add 
L_001f: callvirt instance void [mscorlib]System.Collections.Generic.Dictionary`2<string, int32>::set_Item(!0, !1)
L_0024: nop 
L_0025: nop 
L_0026: br.s L_0033
L_0028: nop 
L_0029: ldarg.0 
L_002a: ldarg.1 
L_002b: ldc.i4.1 
L_002c: callvirt instance void [mscorlib]System.Collections.Generic.Dictionary`2<string, int32>::Add(!0, !1)
L_0031: nop 
L_0032: nop 
L_0033: ret 
```

它调用 ContainsKey、get_item 和 set_item，所有这些都进行哈希和查找。

我写了一些不太漂亮的东西，它使用了一个包含 int 的类，并且该类允许您对它产生副作用（由于结构复制语义，您不能真正使用结构而不会受到相同的惩罚）。

```
class IntegerHolder {
    public IntegerHolder(int x) { i = x; }
    public int i;
}
static void AddInc2(Dictionary<string, IntegerHolder> dict, string s)
{
    IntegerHolder holder = dict[s];
    if (holder != null)
    {
        holder.i++;
    }
    else
    {
        dict.Add(s, new IntegerHolder(1));
    }
} 
```

这为您提供了以下 IL：

```
L_0000: nop 
L_0001: ldarg.0 
L_0002: ldarg.1 
L_0003: callvirt instance !1 [mscorlib]System.Collections.Generic.Dictionary`2<string, class AddableDictionary.IntegerHolder>::get_Item(!0)
L_0008: stloc.0 
L_0009: ldloc.0 
L_000a: ldnull 
L_000b: ceq 
L_000d: stloc.1 
L_000e: ldloc.1 
L_000f: brtrue.s L_0023
L_0011: nop 
L_0012: ldloc.0 
L_0013: dup 
L_0014: ldfld int32 AddableDictionary.IntegerHolder::i
L_0019: ldc.i4.1 
L_001a: add 
L_001b: stfld int32 AddableDictionary.IntegerHolder::i
L_0020: nop 
L_0021: br.s L_0033
L_0023: nop 
L_0024: ldarg.0 
L_0025: ldarg.1 
L_0026: ldc.i4.1 
L_0027: newobj instance void AddableDictionary.IntegerHolder::.ctor(int32)
L_002c: callvirt instance void [mscorlib]System.Collections.Generic.Dictionary`2<string, class AddableDictionary.IntegerHolder>::Add(!0, !1)
L_0031: nop 
L_0032: nop 
L_0033: ret 
```

它调用 get_item 一次 - 在对象存在的情况下没有额外的散列。我有点邋遢，并公开了该字段，以避免对属性访问的方法调用。

如果是我，我会将这个整体功能包装到它自己的类中，并将 IntegerHolder 类隐藏在公众视野中——这是一个有限的版本：

```
public class CountableItem<T>
{
    private class IntegerHolder
    {
        public int i;
        public IntegerHolder() { i = 1; }
    }
    Dictionary<T, IntegerHolder> dict = new Dictionary<T, IntegerHolder>();

    public void Add(T key)
    {
        IntegerHolder val = dict[key];
        if (val != null)
            val.i++;
        else
            dict.Add(key, new IntegerHolder());
    }

    public void Clear()
    {
        dict.Clear();
    }

    public int Count(T key)
    {
        IntegerHolder val = dict[key];
        if (val != null)
            return val.i;
        return 0;
    }

    // TODO - write the IEnumerable accessor.
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T14:39:34.320

尝试以下

```
if (htColors.Contains(color))
{
   int old = (int)htColors[color];
   htColor[color] = old + 1;
} 
```

**编辑**对评论的回应

恕我直言，Dictionary 方法要好得多，因为它是 1) 类型安全和 2) 消除了此解决方案中涉及的装箱。

如下所示不会影响键，只会影响值

```
htColor[color] = (int)htColor[color] + 1; 
```

# jsf - JSF commandButton with immediate="true"

> ID：619050
> 
> 赞同：6
> 
> 时间：2009-03-06T14:34:45.377
> 
> 标签：jsf

我有一个 selectOneMenu 具有绑定到支持 bean 的值的情况。

我需要一个不更新模型值的按钮（这就是它具有 immediate="true" 属性的原因）。

该按钮的操作方法更改了 selectOneMenu 绑定的值，但是当页面重新显示时，会显示原始值（提交的值），而不是在操作方法中设置的值。

任何想法为什么会这样？

如果我没有很好地解释问题，请告诉我。

* * *

编辑：这里要求的是有问题的源代码：

### 页面代码：

```
<h:selectOneMenu id="selectedPerson" 
                 binding="#{bindings.selectPersonComponent}" 
                 value="#{bean.selectedPerson}">
   <s:selectItems var="op" value="#{bean.allPersons}" 
                  label="#{op.osoba.ime} #{op.osoba.prezime}" 
                  noSelectionLabel="#{messages.selectAPerson}">
   </s:selectItems>
   <f:converter converterId="unmanagedEntityConverter" />
</h:selectOneMenu>
...
<a4j:commandButton action="#{bean.createNew}" value="#{messages.createNew}"
     immediate="true" reRender="panelImovine">
</a4j:commandButton> 
```

### 爪哇代码：

```
private Person selectedPerson;

public String createNew() {
    log.debug("New created...");
    selectedPerson = null;
    bindings.getSelectPersonComponent().setSubmittedValue(null); //SOLUTION
    return "";
} 
```

解决方案在标有**SOLUTION**的内衬:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T15:02:42.830

由于在发布此问题后几分钟内经常发生这种情况，我找到了答案：

问题的原因在这里详细解释：[ClearInputComponents](https://cwiki.apache.org/confluence/display/MYFACES/Clear+Input+Components)

问题是（如解释的那样）模型值尚未更新，因此提交的输入仍在 component.submittedValue 字段中，如果该字段不为空，则会显示该字段。模型更新后正常清空。

第一个解决方案在我的情况下不起作用，因为视图中还有其他重要状态不能丢失。但是第二种解决方案效果很好：

```
component.setSubmittedValue(null); 
```

这就是所有需要的：这是一些额外的工作，因为组件必须绑定到某个 bean，但还不错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T22:30:55.703

跟进一下，我认为您不需要将组件绑定到 bean。如果您知道组件的客户端 ID，则可以通过来从`FacesContext`实例中获取组件。`UIViewRoot`

它会是这样的：

```
Foo component = (Foo)FacesContext.getCurrentInstance().getViewRoot().getComponent(clientId); 
```

`Foo`您正在使用的组件的类在哪里，并且`clientId`是 JSF 使用的“formId:elementId”格式的组件的客户端 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-03T19:12:29.367

对我来说，这很有效：

```
@ManagedBean(name = "bean")
@ViewScoped
public class Bean {
    private SelectOneMenu component;

    public SelectOneMenu getComponent() {
        return selectComponent;
    }

    public void setComponent(SelectOneMenu component) {
        this.Component = component;
    }
    public void resetComponent() {
        component.resetValue();
    }
    ...
}
<h:selectOneRadio value="#{bean.value}" id = "idRadio" required="true" requiredMessage = "Required Message" binding="#{bean.component}" >
    <f:selectItem itemLabel="Value 1" itemValue="value1"/>
    <f:selectItem itemLabel="Value 2" itemValue="value2" />     
</h:selectOneRadio>

<primefaces:commandButton action="#{bean.resetComponent}" value="Erase" update="idRadio" immediate="true"/>
... 
```

谢谢。

# usability - 如何衡量可用性以获取硬数据？

> ID：619052
> 
> 赞同：2
> 
> 时间：2009-03-06T14:35:18.980
> 
> 标签：usability

有一些关于可用性的帖子，但没有一个对我有用。

我需要对应用程序某些部分的可用性进行定量测量。我需要用硬数字估计它，以便能够将它与未来的版本进行比较（例如用于报告目的）。最简单的方法是计算点击次数和击键次数，但这似乎太简单了（例如，填充文本字段的成本是输入所有字母的简单总和？ - 我想它更复杂）。我需要一些数学模型，这样我才能估计数字。

有人对这个有了解吗？

PS 我不需要有关设计用户界面的资源的链接。我已经有了它们。我需要的是一种数学仪器来测量现有应用程序接口的可用性。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T15:01:15.437

[http://www.techsmith.com/morae.asp](http://www.techsmith.com/morae.asp)

这是微软在花费数百万美元重新设计带有功能区工具栏的 Office 2007 时使用的部分内容。

以下是 Office 2007 的分析方法： [http ://cs.winona.edu/CSConference/2007proceedings/caty.pdf](http://cs.winona.edu/CSConference/2007proceedings/caty.pdf)

请务必查看 PDF 末尾的参考资料，那里有很多好东西。看看微软是如何做 Office 2007 的（不管你怎么看），他们在这些东西上花了很多钱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T14:57:12.420

你在这方面的主要想法是有效性和效率（在某些情况下，效率）。[本网页](http://www.usabilitymetrics.com/usability-metrics.html)概述了要记住的基本要点。

你真正想做的是衡量可用性的“检查”方法。这些通常设置成本更高（无论是在时间还是在财务方面），但如果做得好，可以产生显着的结果。这些方法包括启发式评估之类的东西，它只是将系统接口和系统接口的使用与您的可用性启发式进行比较（尽管，根据您上面所说的，这可能不是您所追求的） .

然而，更适合您使用的是“测试”方法，您可以借此观察用户在您的系统上执行任务。这部分与有效性和效率点有关，但可以包括各种内容，例如“大声思考”概念（在某些情况下非常有效，具体取决于被测试的软件）。

Jakob Nielsen[在他的网站上有一篇不错的（短）文章](http://www.useit.com/alertbox/20010121.html)。还有[一个](http://www.useit.com/alertbox/quantitative_testing.html)，但它更多地与如何测试以具有代表性有关，而不是如何执行测试本身。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T19:36:34.907

您可能想查看[GOMS 模型](http://en.wikipedia.org/wiki/GOMS)（目标、运算符、方法和选择规则）。在我看来，这是一个非常难以使用的研究工具，但它确实为在严格控制的环境中衡量性能提供了“数学”基础。最好与“专家”用户一起使用。请参阅新英格兰电话运营商的欧内斯汀项目这个非常有趣[的案例研究。](http://www.rpi.edu/~grayw/pubs/papers/1993/GJ&A93_HCIj.pdf)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T05:32:31.520

首先，您要定义目标：例如，增加可以完成某组任务的用户百分比，并减少他们所需的时间。

然后，拿两个摄像头，几个用户（5-10）给他们一个要完成的任务列表，让他们大声思考。一半的用户应该使用“旧”系统，其余的应该使用新系统。

查看磁带，测量所用时间，测量成功率，无休止地讨论解释。

或者，您可以开发一个用于桶测试的系统——它的工作方式相同，尽管它使发现新事物变得更加困难。另一方面，它便宜得多，因此您可以进行更多迭代。当然，这仅限于可以公开测试的网站。

这显然意味着您正在尝试获取两种设计之间的比较数据。我想不出一种将可用性表达为价值的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T15:46:06.280

定量测量可用性是一个非常困难的问题。我把这个作为我博士工作的一部分来解决。简短的回答是，是的，你可以测量它；不，您不能在真空中使用结果。您必须了解*为什么*某件事花费的时间更长或更短；简单地比较数字比无用更糟糕，因为它具有误导性。

对于比较备用接口，它可以正常工作。在一项纵向研究中，用户将他们过去对版本 1 的专业知识带到他们对版本 2 的使用中，它不会那么有用。您还需要考虑学习界面的时间，包括在用户离开界面时重新理解界面的时间。最后，如果任务的难度可变（这是现实世界中的常见情况），那么除非您有办法排除这种难度，否则您的数字将遍布地图。

GOMS（上面提到的）是在设计阶段使用的一种很好的方法，可以直观地了解接口 A 在执行特定任务方面是否优于 B。但是，它仅解决专家用户的无错误性能，并且仅测量低级任务执行时间。如果用户找到了一种您没有想到的更有效的工作方式，那么您将无法获得 GOMS 的估算值，并且必须起草一份。

您可以研究的一些具体措施：

*   如果您想知道什么需要很长时间，那么测量标准任务的时钟时间是很好的选择。但是，实验室测试通常涉及测试对象比他们在日常工作中更努力地工作和更专注，因此将实验室结果与真实用户进行比较会产生误导。
*   错误率：用户犯错误或回溯的频率。尤其是当您注意到一次又一次发生相同类型的错误时。
*   变通办法的出现；如果您的用户正在处理某个功能，或者采取了一系列您认为愚蠢的步骤，这可能表明您的界面没有提供工具来解决他们的问题。
*   不要低估简单地询问用户他们认为事情进展得如何。主观可用性是挑剔的，但可以揭示。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T15:02:28.430

考虑测量执行关键任务的时间（使用新用户和有经验的用户）以及执行这些任务的数据输入错误的数量。

# java - 在 Swing 中子类化 JPanel 的最佳方法

> ID：619055
> 
> 赞同：1
> 
> 时间：2009-03-06T14:35:37.777
> 
> 标签：java, swing, jpanel

我目前正在尝试在 Swing 中构建一个扩展面板（类似于 WPF 的`Expander`控件），并且我想保留操作它的常用方法（即`setLayout`、`add`等）。只有它们应该被路由到嵌入式面板（显示或隐藏的面板）。

如何做到这一点？覆盖每种方法`JComponent`并将其重新路由到嵌入式`JPanel`会很麻烦，但这是我看到的唯一方法。

或者我应该让嵌入式面板对外部可见，并强制用户使用类似的东西`ExpanderPanel.getInnerPanel()`。但是，它不是`JPanel`我认为很好的替代品。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T14:40:33.397

查看**Swingx**项目中的**JXTaskPane**。它已经做了你需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T14:49:10.413

在 1.5(ish) Swing 中，将一些方法路由到 、 等中的内容窗格`JFrame`。`JApplet`虽然对于刚开始的人来说似乎有一些可用性优势，但它实际上并不能解决问题。所以每个人都必须处理一个行为非常奇怪的 API。所以我的建议是避免这种方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T14:53:24.257

如果您有一个 Container 小部件，其中包含您要显示和隐藏的面板，为什么不按您的意愿布局您的内部面板，然后将其添加到 Container 面板，然后对 Container 使用静态方法说

JPanel p = 新 JPanel(); //用JPanel做点什么...

ContainerWidget.setContent(p);

ContainerWidget.expandPanel(p,true);

像这样的东西会起作用吗？

# php - FFMPEG - 启用声音时文件大小为零

> ID：619061
> 
> 赞同：2
> 
> 时间：2009-03-06T14:36:28.540
> 
> 标签：php, linux, video, ffmpeg, video-processing

我在使用 FFMPEG 从命令行转换视频文件时遇到了一些问题。我正在使用 CentOS 服务器，但不幸的是我没有 shell 访问权限。

当我使用以下命令抑制声音时，一切正常（当然，没有声音！）

```
ffmpeg -i $infile -an test.flv 
```

但是，当我尝试以*任何*方式启用声音时，输出的文件的文件大小为零 kb。

FFMPEG 在编译时支持 libmp3lame 和 libfaac，并安装了必要的编解码器。这是服务器上FFMPEG的配置：

> FFmpeg 版本 SVN-rUNKNOWN，版权所有 (c) 2000-2007 Fabrice Bellard 等人。配置： --prefix=/usr --libdir=/usr/lib --mandir=/usr/share/man --incdir=/usr/include/ffmpeg --enable-libmp3lame --enable-libogg --enable- libvorbis --enable-libogg --enable-libtheora --enable-libfaad --enable-libfaac --enable-libgsm --enable-xvid --enable-x264 --enable-liba52 --enable-liba52bin --enable- pp --enable-shared --enable-pthreads --enable-gpl --disable-strip

这是我尝试过的一些命令的一个非常小的示例，这些命令导致文件大小为 0Kb：

```
ffmpeg -i $infile test.flv
ffmpeg -i $infile -vcodec copy -acodec ac3 test.flv
ffmpeg -vcodec copy -acodec copy -i $infile -vcodec copy -acodec mp3 test.flv
ffmpeg -vcodec copy -acodec copy -i $infile -vcodec copy -acodec copy $outfile
ffmpeg -vcodec copy -acodec copy -i $infile -vcodec copy -acodec aac $outfile 
```

如果有人可以提供有关这里发生的事情的任何提示，我将非常感激！

**编辑**- 这是我将 stderr 重定向到文件时的结果

FFmpeg 版本 SVN-rUNKNOWN，版权所有 (c) 2000-2007 Fabrice Bellard 等人。配置： --prefix=/usr --libdir=/usr/lib --mandir=/usr/share/man --incdir=/usr/include/ffmpeg --enable-libmp3lame --enable-libogg --enable- libvorbis --enable-libogg --enable-libtheora --enable-libfaad --enable-libfaac --enable-libgsm --enable-xvid --enable-x264 --enable-liba52 --enable-liba52bin --enable- pp --enable-shared --enable-pthreads --enable-gpl --disable-strip libavutil 版本：49.4.0 libavcodec 版本：51.40.4 libavformat 版本：51.12.1 构建于 2007 年 6 月 4 日 11:02:12， gcc：4.1.1 20070105（红帽 4.1.1-52）

输入#0, mov,mp4,m4a,3gp,3g2,mj2, from '/path/to/7b4e37e703ce0a104f027cb9125b1a19.mp4': 持续时间: 00:00:32.4, 开始: 0.000000, 比特率: 122 kb/s Stream #0.0( jpn): 视频: h263, yuv420p, 176x144, 29.97 fps(r) 流#0.1(jpn): 音频: samr / 0x726D6173, 8000 Hz, 单声道

输出 #0，flv，到 '/path/to/test.flv'：流 #0.0：视频：flv，yuv420p，176x144，q=2-31，200 kb/s，29.97 fps(c) 流 #0.1：音频：mp3，8000 Hz，单声道，64 kb/s 流映射：Stream #0.0 -> #0.0 Stream #0.1 -> #0.1

输入流 #0.1 不支持的编解码器 (id=73728)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T14:46:12.323

您对服务器有什么样的访问权限 - 您必须具备在其上运行命令的能力。

既然如此，错误输出是`ffmpeg`什么？

一个适当的冗长论证可能会告诉你更多关于这个问题的信息？

编辑：

让我们看看我们是否可以获得标准错误输出。跑：

```
ffmpeg -version 
```

看看你能不能得到一些输出。一旦您设法提取了一些标准错误输出，我们就可以调查原始问题。

编辑：

所以看起来你正在丢失`stderr`- 现在你需要弄清楚如何找回它。

也许：

```
ffmpeg -version 2>&1 
```

将工作？

编辑：

我们如何到达某个地方 - 不支持输入音频编解码器：

```
Unsupported codec (id=73728) for input stream #0.1 
```

我不知道是什么`Stream #0.1(jpn): Audio: samr / 0x726D6173, 8000 Hz, mono`。

但是你有问题。

我建议您可能想在本地 Linux 机器上进行调查 - 可能更容易发现问题。

编辑：

从[http://www.nabble.com/Convert-3gp-samr-file-td20514476.html](http://www.nabble.com/Convert-3gp-samr-file-td20514476.html)看来 ffmpeg 可以在 support 下编译`--enable-libamr-nb --enable-libamr-wb`。

重新编译`ffmpeg`是一个选项吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-07-23T06:00:53.463

我解决了这个问题。这是我的代码：

```
<?php
   define('FFMPEG_LIBRARY', '/usr/local/bin/ffmpeg');
   $exec_string = FFMPEG_LIBRARY.' -i robot.avi -an output.flv';
   exec($exec_string); //where exec is the command used to execute shell command in php
?> 
```

# web-services - 基于订阅的网络服务业务/网站的最佳框架？

> ID：619062
> 
> 赞同：4
> 
> 时间：2009-03-06T14:36:43.437
> 
> 标签：web-services, frameworks, subscription

我们正在开发一种新的 Web 服务，该服务对低容量用户免费，对高容量用户基于订阅。大多数用户可能会通过他们的 cms 或博客系统的插件来调用它，有些用户会使用各种编程语言的 api 工具包。Web 服务本身很容易向用户公开，但是使用基于订阅的业务模型来配置和管理对其访问权限的全功能 Web 应用程序要复杂得多。

我们需要构建、购买或找到一种支持自助服务网站的解决方案，让人们：

*   注册免费或付费帐户
*   选择和配置服务选项
*   输入付款凭据
*   编辑他们的帐户和帐单资料
*   查看他们的服务使用情况和计费历史记录
*   暂停或取消他们的帐户

从管理员的角度来看，我们还希望系统能够让我们：

*   监控和管理服务状态
*   记录用户活动和服务消费
*   查看和管理用户帐户
*   管理定期计费，标记问题帐户
*   管理用于与用户交流的消息模板
*   配置服务包、选项和折扣代码
*   执行其他类似的行政活动

这似乎是任何基于 Web 的自助订阅系统都可能需要的标准东西。我想知道是否有人知道提供大部分或所有这些功能的软件包？我们愿意考虑各种编程语言和平台，尽管在 linux 系统上部署和运行它会最方便。

如果没有可靠的开源解决方案，那么我们可能有兴趣赞助创建一个。我期待听到来自社区的见解。谢谢！

瑞克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-13T21:29:49.373

订阅管理和计费操作是您自己实施的痛苦。我建议检查一下[Zuora](http://www.zuora.com/)。尽管那里有一些成本，但他们为他们的云服务提供了一个很好的 API。

不确定这是否符合您心目中的模型，但它们确实消除了头痛。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-01T15:51:31.013

与 FastSpring 一起去 www.fastspring.com

它摇滚它解决了你提到的所有事情+更多。

[http://www.fastspring.com/features-subscription.php](http://www.fastspring.com/features-subscription.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T14:38:54.243

考虑到您首选的服务器操作系统，METRO 对我来说是一个合适的选择：

[https://metro.dev.java.net/](https://metro.dev.java.net/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-08-13T16:44:59.180

Wikipedia 有一个很好的 Web 服务框架比较表。这可能是一个很好的起点：[http ://en.wikipedia.org/wiki/List_of_web_service_frameworks](http://en.wikipedia.org/wiki/List_of_web_service_frameworks)

# c# - WPF 文本框覆盖

> ID：619074
> 
> 赞同：2
> 
> 时间：2009-03-06T14:40:18.827
> 
> 标签：c#, wpf

在 WPF 中，是否可以轻松覆盖文本框中的文本？

谢谢托尼
_

编辑：我想我不是很清楚。对不起。

我有一个允许用户输入 6 个字符的文本框。如果用户键入 6 个字符，然后出于某种原因将光标放在 6 个字符的开头或中间某处并开始键入，我希望他们正在键入的内容覆盖字符。基本上就像 Word 中的覆盖模式一样。

再次感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-10-31T18:15:34.480

我会避免反思。最干净的解决方案如下：

> EditingCommands.ToggleInsert.Execute(null, myTextBox);

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T16:53:29.753

在 Reflector 中查看，这似乎是由布尔 TextBoxBase.TextEditor._OvertypeMode 内部属性控制的。你可以通过反思得到它：

```
// fetch TextEditor from myTextBox
PropertyInfo textEditorProperty = typeof(TextBox).GetProperty("TextEditor", BindingFlags.NonPublic | BindingFlags.Instance);
object textEditor = textEditorProperty.GetValue(myTextBox, null);

// set _OvertypeMode on the TextEditor
PropertyInfo overtypeModeProperty = textEditor.GetType().GetProperty("_OvertypeMode", BindingFlags.NonPublic | BindingFlags.Instance);
overtypeModeProperty.SetValue(textEditor, true, null); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-10-25T14:25:45.203

Heyho，我知道这个问题已经过时了，但我一直在寻找一种解决方案来通过 MVVM 模式归档“覆盖”行为。所以我写了以下内容`DependencyProperty`，希望它会对某人有所帮助。

```
public class ElementBehavior
{
   #region ForceOverride

    ///<summary>
    /// DependencyProperty
    ///</summary>
    public static readonly DependencyProperty ForceOverrideProperty = DependencyProperty.RegisterAttached("ForceOverride", typeof(bool), typeof(ElementBehavior), new PropertyMetadata(false, (s, e) =>
    {
        if (s is TextBoxBase t)
        {
            if ((bool)e.NewValue)
            {
                t.PreviewKeyDown += OnForceOverride;
            }
            else
            {
                t.PreviewKeyDown -= OnForceOverride;
            }
        }
    }));

    ///<summary>
    /// Get
    ///</summary>
    ///<param name="target"><see cref="DependencyObject"/></param>
    ///<returns><see cref="bool"/></returns>
    public static bool GetForceOverride(DependencyObject target)
    {
        return (bool)target.GetValue(ForceOverrideProperty);
    }

    ///<summary>
    /// Set
    ///</summary>
    ///<param name="target"><see cref="DependencyObject"/></param>
    ///<param name="value"><see cref="bool"/></param>
    public static void SetForceOverride(DependencyObject target, bool value)
    {
        target.SetValue(ForceOverrideProperty, value);
    }

    private static void OnForceOverride(object sender, KeyEventArgs e)
    {
        Key[] BAD_KEYS = new Key[] { Key.Back, Key.Delete };
        Key[] WRK_KEYS = new Key[] { Key.Left, Key.Up, Key.Right, Key.Down, Key.Enter };
        if (BAD_KEYS.Contains(e.Key))
        {
            e.Handled = true;
        }
        else if (!WRK_KEYS.Contains(e.Key))
        {
            if (sender is RichTextBox r)
            {
                if (!string.IsNullOrEmpty(new TextRange(r.Document.ContentStart, r.Document.ContentEnd).Text))
                {
                    r.Dispatcher.BeginInvoke(System.Windows.Threading.DispatcherPriority.Input, (Action)delegate
                    {
                        TextPointer tp = r.CaretPosition.GetNextInsertionPosition(LogicalDirection.Forward);
                        if (tp != null && tp != r.Document.ContentEnd)
                        {
                            r.Selection.Select(r.CaretPosition, tp);
                        }
                    });
                }
            }
            else if (sender is TextBox t)
            {
                if (!string.IsNullOrEmpty(t.Text))
                {
                    t.Select(t.CaretIndex, 1);
                }
            }
        }
    }
    #endregion
} 
```

用法：

```
 <Style TargetType="{x:Type TextBox}">
       <Setter Property="ElementBehavior.ForceOverride" Value="True"/>
 </Style> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T14:45:37.613

假设您的意思是选择一些文本，然后允许用户在该文本上键入：

```
//select the third character
textBox.Select(2, 1); 
```

# vba - 如何在电子邮件到达时启动 URL

> ID：619079
> 
> 赞同：3
> 
> 时间：2009-03-06T14:41:05.143
> 
> 标签：vba, outlook, shellexecute

我想在电子邮件到达 Outlook 时启动一个 URL。我设置了一个规则并让它触发一个脚本函数。看起来我想调用 ShellExecute 在浏览器中启动 URL，但是当我点击这一行时：

```
 ShellExecute(0&, "open", URL, vbNullString, vbNullString, _
vbNormalFocus) 
```

方法未定义。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T19:40:14.737

ShellExecute 是 Windows dll 中的一个函数。您需要在 VBA 模块中为它添加这样的声明：

```
Public Declare Function ShellExecute Lib "shell32.dll" Alias "ShellExecuteA" ( _
    ByVal hWnd As Long, _
    ByVal lpOperation As String, _
    ByVal lpFile As String, _
    ByVal lpParameters As String, _
    ByVal lpDirectory As String, _
    ByVal nShowCmd As Long) As Long 
```

您的 Shell 解决方案和 ShellExecute 之间的区别在于 ShellExecute 将使用 URL 的默认系统处理程序来打开链接。这不一定是 IE。您的解决方案将始终在 IE 中打开它。您的相当于将 iexplore.exe 放入 Windows 的运行框中。ShellExecute 相当于只是将 url 放在 windows 的运行框中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T09:49:59.233

您还可以使用VBA 中的[Followhyperlink](http://msdn.microsoft.com/en-us/library/aa204494(office.10).aspx)在默认浏览器中打开 URL。它还可用于使用已注册的应用程序打开文档、发送电子邮件和浏览文件夹。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T15:48:23.500

或者，使用`Shell`，如下所示：

```
Sub LaunchURL(Item As Outlook.MailItem)
    Shell ("C:\Program Files\Internet Explorer\IEXPLORE.EXE" & " " & Item.Body)
End Sub 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-07T06:42:37.043

您可以在编写此文件的位置创建批处理文件：

```
start http://someurl.com/?a=1^&b=2 
```

并且您配置 Outlook 规则以启动此批处理文件。注意 ^ 符号在 & 之前。这是批处理文件中 & 的转义序列。另请注意，您需要在 Windows 操作系统中设置默认浏览器，几乎 100% 的概率您拥有它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-13T10:18:47.807

```
Shell ("CMD /C start http://www.spamcop.net"), vbNormalFocus 
```

# c# - 如何获取由 Linq 中的某物排序的记录的索引？

> ID：619087
> 
> 赞同：0
> 
> 时间：2009-03-06T14:43:02.347
> 
> 标签：c#, linq

假设，我有按点排序的学生考试结果集。我想在这个结果集中得到一个学生的订单索引。我怎样才能通过使用 linq 来摆脱它？

假设这样的课程；

```
class ExamResult
{
   int StudentId;
   int Point;
   int ExamId;
}

ExamId StudentId Point
 1        1       5,2
 1        2       5,4
 1        3       3
 1        4       7,2
 1        5       7,9
 1        6       1
 1        7       2,6
 1        8       6
 1        9       11 
```

之后我按点命令学生。学生 2 必须在索引 5 处。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T14:47:12.507

你在使用 LINQ to Objects 吗？如果是这样，就会有一个[`Select`重载](http://msdn.microsoft.com/en-us/library/bb534869.aspx)，它会为您提供索引和值。（[对于`Where`](http://msdn.microsoft.com/en-us/library/bb549418.aspx)其他人也是如此。）`Select`因此，重载使得将原始值转换为“原始值+索引”作为匿名类型变得容易。

您的问题并不完全清楚 - 如果这不是您所追求的，也许您可​​以提供一些示例代码？

# c# - C＃。为遗留代码添加多态性

> ID：619095
> 
> 赞同：1
> 
> 时间：2009-03-06T14:44:25.993
> 
> 标签：c#, polymorphism, legacy-code, duck-typing

假设我们有不能修改的遗留类：

```
class Foo 
{
    public void Calculate(int a) { }
}

class Bar
{
    public void Compute(int a) {}
} 
```

我想用这样的签名写一个助手：

```
void Calc(object obj, int a); 
```

请注意，第一个参数的类型是“对象”。测试代码应该是这样的：

```
ExampleX.Calc((object)new Foo(), 0);
ExampleX.Calc((object)new Bar(), 0); 
```

问题是，除了这些之外，您还可以想象什么实现：

```
// Using If/then
class Example1
{
    public static void Calc(object obj, int a)
    {
        if (obj is Foo)
            ((Foo)obj).Calculate(a);
        else if (obj is Bar)
            ((Bar)obj).Compute(a);
    }
}

// Using reflection
class Example2
{
    private static Dictionary<Type, MethodInfo> _methods = new Dictionary<Type, MethodInfo>();

    static Example2()
    {
        _methods.Add(typeof(Foo), typeof(Foo).GetMethod("Calculate"));
        _methods.Add(typeof(Bar), typeof(Bar).GetMethod("Compute"));
    }

    public static void Calc(object obj, int a)
    {
        _methods[obj.GetType()].Invoke(obj, new object[] { a });
    }
}

// Using delegates
class Example3
{
    private delegate void CalcDelegate(object obj, int a);

    private static Dictionary<Type, CalcDelegate> _methods = new Dictionary<Type, CalcDelegate>();

    static Example3()
    {
        _methods.Add(typeof(Foo), (o, a) => ((Foo)o).Calculate(a));
        _methods.Add(typeof(Bar), (o, a) => ((Bar)o).Compute(a));
    }

    public static void Calc(object obj, int a)
    {
        _methods[obj.GetType()](obj, a);
    }
}

// Using Reflection + overloaded methods
class Example4
{
    private delegate void CalcDelegate(object obj, int a);

    public static void Calc(object obj, int a)
    {
        Type[] types = new Type[] { 
            obj.GetType(), typeof(int)
        };

        typeof(Example4).GetMethod("Calc", types).Invoke(null, new object[] { obj, a });
    }

    public static void Calc(Foo obj, int a)
    {
        obj.Calculate(a);
    }

    public static void Calc(Bar obj, int a)
    {
        obj.Compute(a);
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T14:50:00.643

使用扩展方法本质上将新函数添加到现有类型。

[http://msdn.microsoft.com/en-us/library/bb383977.aspx](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T14:52:02.417

这就是我编写解决方案的方式。它降低了代码中类型安全问题的风险并消除了反射。

```
class Example2
{
    private static Dictionary<Type, Action<object,int>> _methods = new Dictionary<Type, Action<object,int>>();

    static Example2()
    {
        Add<Foo>( (f,a) => f.Calculate(a) );
        Add<Bar>( (b,a) => b.Compute(a) );
    }

    public static void Calc<TSource>(TSource source, int a)
    {
        _methods[typeof(TSource)](source,a);
    }

    public static void Add<TSource>(Action<TSource,int> del) 
    {
        Action<object,int> wrapper = (x,i) => { del((TSource)x, i); }; 
        _methods[typeof(TSource)] = wrapper;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T15:23:29.707

您始终可以使用[适配器模式](http://www.dofactory.com/Patterns/PatternAdapter.aspx)来实现不可更改的遗留对象，而不会破坏任何依赖于其功能的对象，同时仍然能够为对象实现您自己的（新）功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T14:52:22.073

我会以 1 为例，因为它是最简单且最明显的一种。

仅当您期望使用这两种方法之一的新类型的对象时，我才会使用示例 2，并且仅当您有很多（如果不是数百个）对象并且性能开始成为问题时，我才会使用示例 3。

编辑：或扩展方法，如果你是.Net 3

# java - 嵌套 forEach 的 JSF JSTL 问题

> ID：619097
> 
> 赞同：1
> 
> 时间：2009-03-06T14:44:51.123
> 
> 标签：java, jsf, jstl

在嵌套的 foreach 中，访问同一个变量会返回不同的值。这发生在页面重新加载时，而不是第一次加载时。

```
<ui:composition
  xmlns="http://www.w3.org/1999/xhtml"
  (...)
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:h="http://java.sun.com/jsf/html">

  (...)

  <c:forEach items="#{controller.availableTransitions}" var="transition">
    <c:forEach items="#{transition.availableTransitions}" var="transitionItem">
      <h:outputText value="1_#{transitionItem.name} 2_#{transitionItem.name}" />
      3_#{transitionItem.name} 4_#{transitionItem.name}
    </c:forEach>
  </c:forEach>
</ui:composition> 
```

页面重新加载后，transitionItem.Name 为 3 和 4 返回正确的值，而为 1 和 2 返回不同的值。可能是 JSF-JSTL 集成问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T15:04:50.810

我看到您正在使用 Facelets。

也许您可以尝试将您`<c:forEach>`的替换为`<ui:repeat>`...

然后代码将变为：

```
<ui:composition
  xmlns="http://www.w3.org/1999/xhtml"
  (...)
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:h="http://java.sun.com/jsf/html">

  (...)

  <ui:repeat value="#{controller.availableTransitions}" var="transition">
    <ui:repeat value="#{transition.availableTransitions}" var="transitionItem">
      <h:outputText value="1_#{transitionItem.name} 2_#{transitionItem.name}" />
      3_#{transitionItem.name} 4_#{transitionItem.name}
    </ui:repeat>
  </ui:repeat>
</ui:composition> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T20:40:32.860

一般来说，我尝试使用 ui:repeat 大部分时间。当我遇到 c:set 问题时，我发现了这个博客，它非常有帮助，也可能适用于你的情况。

[https://rogerkeays.com/jsf-c-foreach-vs-ui-repeat](https://rogerkeays.com/jsf-c-foreach-vs-ui-repeat)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T18:32:42.463

找到了一种解决方法，摆脱了内部 forEach 循环，从而从控制器返回一个线性列表。

# sql - 从具有不同值的多个表中选择

> ID：619103
> 
> 赞同：0
> 
> 时间：2009-03-06T14:46:32.663
> 
> 标签：sql, database, select, distinct

我在这里使用 SQL 视图有一个简单的问题。我现在似乎无法弄清楚。

*   我有 2 张桌子，TableA 和 TableB。
*   我想检索 TableA 中的 FieldA 和 TableB 中的 FieldB。
*   这两个表使用 INNER JOIN 链接。
*   我只想要 TableA.FieldA 不同的行。
*   返回的值应该是 TableB.FieldB 中的前 10 项

简单地使用 SELECT DISTINCT 似乎是使用这两个字段的组合来确定区别。

有任何想法吗？

这是当前返回所有行的 SQL 的模拟：

```
SELECT dbo.TableA.FieldA, dbo.TableB.FieldB
FROM dbo.TableA INNER JOIN dbo.TableB ON dbo.TableA.ID = dbo.TableB.TableAID 
```

此标准查询返回的数据示例如下：

```
FieldA  FieldB
John    78
John    21
Claire  18
Sam     16
John    25
Claire  48
Paul    53 
```

我希望从查询中返回的是：

```
John    78
Paul    53
Claire  48
Sam     16 
```

**已编辑以尝试使事情更清晰并包括缺失的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-08T04:34:21.543

根据您的[回答](https://stackoverflow.com/questions/619103/select-from-multiple-tables-where-one-has-distinct-values/619468#619468)，我认为您正在尝试做的是：

对 TableB 中的 FieldB 求和，然后将其与 TableA 连接起来。

```
SELECT   TableA.FieldA,
         tmp.SUMFieldB
FROM     TableA
         INNER JOIN
                  (SELECT  TableAID,
                           SUM(FieldB) AS SUMFieldB
                  FROM     TableB
                  GROUP BY FieldA
                  ORDER BY SUMFieldB DESC
                  ) AS tmp
         ON       TableA.ID = tmp.TableAID
ORDER BY tmp.SUMFieldB DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T14:50:03.607

如果基于连接的表 b 中的字段 A 有两个不同的值，您怎么知道要使用哪一个？

你可以试试这个，但它可能不会选择你想要的 b 值

```
SELECT dbo.TableA.FieldA, max(dbo.TableB.FieldA)
FROM dbo.TableA INNER JOIN dbo.TableB ON dbo.TableA.SomeID = dbo.TableB.SomeID
GROUP BY dbo.TableA.FieldA 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T15:34:25.217

这个怎么样？

```
SELECT TableA.FieldA,
       tmp.FieldB
FROM   TableA
       INNER JOIN
              (SELECT  TableAID,
                       FieldB
              FROM     TableB
              GROUP BY FieldA
              ORDER BY FieldB DESC
              ) AS tmp
       ON     TableA.ID = tmp.TableAID
ORDER BY tmp.FieldB DESC 
```

# c# - 如何让命名空间别名运算符 :: 在 C# 下工作？

> ID：619104
> 
> 赞同：16
> 
> 时间：2009-03-06T14:46:45.707
> 
> 标签：c#, .net, namespaces, alias

当我引用两个具有相同命名空间和类型名称的外部程序集时，我遇到了不太可能的情况。当我尝试使用该类型时，编译器会抛出一个错误，它无法解析我想要使用的类型。

我看到 C# 提供了一种使用别名进行引用的机制。您甚至可以通过`Property`Visual Studio 2008 中的引用窗口指定这些别名。如何在我的代码中使用此别名？据我了解，我应该使用`::`运算符，但它失败并出现以下错误：

> `CS0432 - Alias not found`

通常的`.`运算符也会失败。

在输出窗口中，我看到编译器在其命令行中正确传递了别名。

非常感谢任何关于我接下来可以尝试的指示。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-06T14:55:23.703

```
extern alias alias1;
using alias1::Namespace; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T14:56:04.327

试试这个：

```
extern alias asm1;
extern alias asm2;

namespace Client
{
    class Program
    {
        static void Main(string[] args)
        {
            asm1.MyNs.MyClass mc1 = null;
            asm2.MyNs.MyClass mc2 = null;
        }
    }
} 
```

并添加`global,asm1`到 assembly1 和`global,asm2`assembly2的项目参考

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T14:56:37.337

我认为您需要使用 **extern alias**。[Anson Horton](http://blogs.msdn.com/ansonh/archive/2006/09/27/774692.aspx)有一篇关于这个问题以及如何使用**外部别名**来修复它的好博客。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-06T14:59:47.127

当您在项目中引用某些程序集时，它具有默认别名“全局”。当您为该程序集添加另一个别名时，例如“global, AssemblyA”，您将像这样引用它：

```
using SomeTypeAlias = AssemblyA::Company.Product.SomeType; 
```

或者：

```
void SomeMethod(AssemblyA::Company.Product.SomeType someType) { ... } 
```

# c# - 在文本字段上进行关键字搜索的最佳方法是什么？

> ID：619107
> 
> 赞同：0
> 
> 时间：2009-03-06T14:47:04.847
> 
> 标签：c#, algorithm, language-agnostic, text, full-text-search

我有一个数据库表，其中包含有关图像的元数据，所关注的字段是标题字段。我希望用户能够在文本框中输入关键字，并让应用程序根据标题返回与关键字匹配的图像选择。

我已经有了返回用户输入的单个关键字数组的代码，但是进行比较的最佳方法是什么。所以我在想……

```
foreach (Image image in Images)
{
    foreach (string keyword in keywords)
    {
        if (image.Caption.Contains(keyword))
        {
            imageCollection.Add(image);
            break;
        }
    }
} 
```

但这似乎有点过于简单，因为它不支持仅匹配整个单词。更不用说特殊字符，标点符号等。

我觉得应该在这里使用正则表达式，但我不是正则表达式专家。或者我应该将标题分解成单个单词并逐个处理单词的比较。真的在寻找一些建议！

我正在用 c# 编写，但我认为可能与语言无关

**编辑：我也对基于匹配关键字数量的加权结果非常感兴趣。但我不想在这里重新创建谷歌图片！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T14:53:56.720

可能最好的方法是在数据库的标题字段上使用全文索引。让数据库为您完成工作！

# c# - 在 C# 中反序列化 Chrome 书签 JSON 数据

> ID：619120
> 
> 赞同：7
> 
> 时间：2009-03-06T14:51:21.810
> 
> 标签：c#, .net, json, google-chrome, json.net

在回答我几天前提出的一个问题时，我试图让自己稍微舒展一下，做一些我以前没有真正关注过的事情。我已经进行了一些搜索（在这里和一般情况下），但是找不到我想要实现的答案（甚至是合理的提示）（尽管有些事情接近了）。

基本上，我正在尝试使用[Json.NET 库](http://james.newtonking.com/pages/json-net.aspx)对 Google Chrome 书签文件的数据进行反序列化（不过，如果有更好的选择，我完全赞成 - 这个库的文档在某些地方有点令人困惑） . 对于下一步要采取的措施，我有点困惑，主要是因为习惯于 PHP 对 JSON 数据的出色处理（使用[json_decode()](http://uk.php.net/json_decode)），允许单个函数调用，然后是简单的关联数组访问。

库（Json.NET）希望我指定一个对象类型，它可以将 JSON 数据反序列化为，但考虑到书签文件本身的格式，我不确定如何构建这样的对象。格式大致如下：

```
{
   "roots": {
      "bookmark_bar": {
         "children": [ {
            "children": [ {
               "date_added": "12880758517186875",
               "name": "Example URL",
               "type": "url",
               "url": "http://example.com"
            }, {
               "date_added": "12880290253039500",
               "name": "Another URL",
               "type": "url",
               "url": "http://example.org"
            } ],
        "date_added": "12880772259603750",
            "date_modified": "12880772452901500",
            "name": "Sample Folder",
            "type": "folder"
         }, {
            "date_added": "12880823826333250",
            "name": "Json.NET",
            "type": "url",
            "url": "http://james.newtonking.com/pages/json-net.aspx";
         } ],
         "date_added": "0",
         "date_modified": "12880823831234250",
         "name": "Bookmarks bar",
         "type": "folder"
      },
      "other": {
         "children": [  ],
         "date_added": "0",
         "date_modified": "0",
         "name": "Other bookmarks",
         "type": "folder"
      }
   },
   "version": 1
} 
```

现在，在 PHP 中，我更习惯于按照以下方式进行操作，以获取我想要的数据，并以“Json.NET”结束：

```
$data['roots']['bookmark_bar']['children'][0]['name']; 
```

我可以很简单地计算出要创建哪些对象来表示数据（例如根对象，然后是书签列表对象，最后是单个书签对象）-但我真的不确定如何实现它们，然后让库正确反序列化为相关对象。

任何可以提供的建议将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-06T15:18:49.733

不必声明反映 json 结构的类型：

```
 using Newtonsoft.Json;
    using Newtonsoft.Json.Linq;
    using System.IO;
    using System;

    class Program
    {
        static void Main(string[] args)
        {
            string json = 
@"
{
   ""roots"": {
      ""bookmark_bar"": {
         ""children"": [ {
            ""children"": [ {
               ""date_added"": ""12880758517186875"",
               ""name"": ""Example URL"",
               ""type"": ""url"",
               ""url"": ""http://example.com""
            }, {
               ""date_added"": ""12880290253039500"",
               ""name"": ""Another URL"",
               ""type"": ""url"",
               ""url"": ""http://example.org""
            } ],
        ""date_added"": ""12880772259603750"",
            ""date_modified"": ""12880772452901500"",
            ""name"": ""Sample Folder"",
            ""type"": ""folder""
         }, {
            ""date_added"": ""12880823826333250"",
            ""name"": ""Json.NET"",
            ""type"": ""url"",
            ""url"": ""http://james.newtonking.com/pages/json-net.aspx""
         } ],
         ""date_added"": ""0"",
         ""date_modified"": ""12880823831234250"",
         ""name"": ""Bookmarks bar"",
         ""type"": ""folder""
      },
      ""other"": {
         ""children"": [  ],
         ""date_added"": ""0"",
         ""date_modified"": ""0"",
         ""name"": ""Other bookmarks"",
         ""type"": ""folder""
      }
   },
   ""version"": 1
}
";
        using (StringReader reader = new StringReader(json))
        using (JsonReader jsonReader = new JsonTextReader(reader))
        {
            JsonSerializer serializer = new JsonSerializer();
            var o = (JToken)serializer.Deserialize(jsonReader);
            var date_added = o["roots"]["bookmark_bar"]["children"][0]["date_added"];
            Console.WriteLine(date_added);
        }
    } 
```

# ruby-on-rails - 在乘客下的两个应用程序中运行 Thinking Sphinx

> ID：619124
> 
> 赞同：1
> 
> 时间：2009-03-06T14:52:13.337
> 
> 标签：ruby-on-rails, search, sphinx, thinking-sphinx

我有两个运行thinking_shpinx 的不同rails 应用程序，其中一个似乎没有使用正确的索引。

我尝试在 sphinx.yml 中设置端口，但似乎没有任何效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T01:32:13.703

Matthew，您是否在 sphinx.yml 中针对每个环境设置了端口？

IE：

```
development:
  port: 3312
test:
  port: 3313
production:
  port: 3312 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T15:01:45.997

需要杀死 searchd 并清除 /log 中的 pid

# c++ - 如何在不先启动 IE 的情况下使我的 WinCE 应用程序中的网络工作？

> ID：619130
> 
> 赞同：1
> 
> 时间：2009-03-06T14:54:12.943
> 
> 标签：c++, c, winapi, networking, windows-ce

我有一个简单的 WinCE 网络应用程序（在 C、Win32 API 中）。我发现除非我先启动 IE（或其他网络应用程序），否则网络似乎不起作用。我假设 IE 正在以某种方式设置我的网络接口。

我怎样才能为自己做到这一点？

我是否需要向用户显示可用接口列表（例如 WiFi/以太网/3G）？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T15:06:22.180

我所知道的是 Internet Explorer 使用[WinInet](http://msdn.microsoft.com/en-us/library/aa383630(VS.85).aspx) (wininet.dll) 进行联网，您也可以。WinInet 是一个用于处理 http 和 ftp 协议的 MS API。“Internet 选项”控制面板小程序上的许多设置实际上是 WinInet 设置（例如，用于处理 cookie、在 LAN 上设置代理以及在拨号网络上自动拨号）。我 99% 确定 IE 可以做的任何事情，您都可以使用 API 自己做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T17:18:14.843

如果您所说的“网络应用程序”是指套接字，那么 WinCE 绝对不需要启动 IE 来使其工作。您需要提供更多关于您正在尝试做的事情的细节，以获得比这更好的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T15:29:08.570

我想答案可能是

```
InternetAttemptConnect 
```

[http://msdn.microsoft.com/en-us/library/aa383996(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa383996(VS.85).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-05T03:40:33.063

您需要先建立网络连接。您可以使用连接管理器 API 自动化该过程：

[连接管理器](http://msdn.microsoft.com/en-us/library/bb840031.aspx)

用户也可以手动建立数据连接。

# refactoring - 在领域驱动设计中，您如何考虑您的领域（命名空间）？

> ID：619131
> 
> 赞同：4
> 
> 时间：2009-03-06T14:55:01.460
> 
> 标签：refactoring, domain-driven-design

在领域驱动设计中，您如何考虑您的领域（命名空间）？

我一直在转向以下概念：

```
Project.Entity
  Project.Entity.Abstracts
  Project.Entity.Entities
  Project.Entity.Extensions
  Project.Entity.Immutables
  Project.Entity.Interfaces
  Project.Entity.Repositories 
```

例如，我在 CMS 中有一个名为“Content”的实体。因此，我将创建一个名为 Project.Content 的项目，并将类分解为如下所示：

```
interface IContent
class Content : IContent

interface IContentRepository
class ContentRepository : IContentRepository 
```

这个“内容”实体模型将有自己的命名空间。

但是，我发现它在具有十多个“实体”模型项目（尝试 18 个）的大型企业环境中不能很好地扩展。我最终得到了一个包含十几个项目的解决方案，其中一些只有 2 或 3 个类（即 UrlRewriter）。此外，我发现自己引用其他项目只是为了他们的接口。我觉得这污染了我的领域；虽然不是具体的引用，但有时很难避免循环引用。

所以，我有时会回到“层”的概念......

我想知道其他 DDD 专家如何分解企业级应用程序。请随时推荐书籍和文章。

并提前感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T15:05:17.050

我使用遵循[.NET 指南](http://msdn.microsoft.com/en-us/library/893ke618(VS.71).aspx)。我发现它们非常直观，它们允许你设置命名空间，这样你就不需要导入任何你不需要的东西。

我永远不会对功能级别强加严格的命名约定。每个不同项目的设计都应该指导这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T15:08:45.390

一种想法是我做的是添加一些标识有界上下文的东西。

附言。为确保清楚原因，请检查有界上下文中的两个链接： [http](http://dddcommunity.org/discussion/messageboardarchive/BoundedContext.html) ://dddcommunity.org/discussion/messageboardarchive/BoundedContext.html，http : [//devlicio.us/blogs/casey/archive/2009/02/11 /ddd-bounded-contexts.aspx](http://devlicio.us/blogs/casey/archive/2009/02/11/ddd-bounded-contexts.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T15:11:25.617

我与您类似地发现，管理大量项目变得很痛苦。我更喜欢

```
Project.Domain
Project.DataAccess
Project.Presentation (presenters and such) 
Project.Gui (in case of a winforms app) 
```

设置。

在某种程度上，当事情变糟时，让事情变得简单会很有帮助。

问题是当你创建另一个项目时你会得到什么？（这样做很容易，几乎很容易）

您是否想独立使用该项目？您最终可能会得到如此耦合的 .dll，如果没有完全相同的版本等，您甚至无法部署它们。在这种情况下，没有理由将其拆分并弄乱您的 IDE）

如果需要，您总是可以稍后将事情转移到一个新项目中，这有点痛苦，但到那时，您将有充分的理由去做，而不仅仅是感觉它是如何完成的。

# prism - Prism 中的 ShellPresenter 是 MVP 模式中的 (P)resenter 吗？

> ID：619139
> 
> 赞同：1
> 
> 时间：2009-03-06T14:56:57.163
> 
> 标签：prism

我想了解 Prism（复合应用程序指南）。

了解 ShellPresenter 角色的最佳方式是什么？它是模型-视图-演示者中的演示者吗？

是这样，它与壳牌有什么关系？我知道 ShellPresenter 将 Shell 对象作为其构造函数的参数，并负责确保所有模块将其视图放置在正确的区域中。但是还有执行此操作的 RegionManager。

那些一直使用这个术语的人的任何澄清将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T06:59:03.953

是的，ShellPresenter 是 MVP 模式中的 Presenter。

regionManager 确实充当了已知区域的注册表 - 从技术上讲，它是所述 Presenter 的适配器。

因此，虽然从表面上看，ShellPresenter 可以在技术上处理自己的子项管理，但通过使用[适配器模式](http://en.wikipedia.org/wiki/Adapter_pattern)，我们可以解耦这种逻辑并促进整个重用，因为它可能会被不断使用？（即考虑多重继承解决方法）。

这有帮助吗？

**Scott Barnes - 富平台产品经理 - Microsoft。**

# vb6 - 错误 372 的原因是什么 - 无法加载控制您的版本 可能已经过时

> ID：619144
> 
> 赞同：4
> 
> 时间：2009-03-06T14:59:07.517
> 
> 标签：vb6

VB6 运行时错误 372 的已知原因 - 无法加载控制 您的版本可能已过时。

我有一个由几个标准 Windows 控件和一个 Far Point 构建的 activceX 控件。该控件用于 VB6 桌面应用程序。我看到的行为是此活动控件在某些工作站上偶尔会失败。我已经确认工作站上有正确的参考。奇怪的是，控制不会立即失败。它可以在主窗体上正常工作，但在打开另一个窗体时会失败。

它似乎也与运行时 7 内存不足错误有关。当这些错误通常发生时，任务管理器中不会显示异常的 CPU 或内存使用情况。

似乎该问题可能与 MSCOMCT2.OCX 有关。

有任何想法吗。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T20:18:15.270

首先在 NOTEPAD 中打开您的表单文件（扩展名为 FRM 的文件），确保表单确实引用了相同的 ActiveX 控件。参考资料位于表格顶部附近。VB6 可能不匹配不同形式之间的引用，但这种情况并不常见。

从 Micrsoft 再来看看[这个。](http://support.microsoft.com/kb/942870)确保为所有用户安装了控件，看看你的问题是否解决了。

此类问题通常是由预期的 COM 接口和正在加载的控件之间的不匹配引起的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-01T18:19:29.850

我遇到了同样的问题，发现当我创建我的安装包（使用 InstallShield）时，我需要取消选中对话框中的“过滤文件”框，在该对话框中设置 INstallShield 以扫描 Visual Basic 项目的依赖项。它没有将 VB 项目的 MSDatgrd.ocx 控件打包到设置中，并且该控件不在 Win 7 机器中，因此它抛出了这个 372 消息。

当我为我的软件重建我的安装包并且没有过滤文件时，它包含该控件并将其作为安装过程的一部分安装在目标机器上，并且一切运行良好。

# excel - 我们如何在 VBA 中使用 MSHTML？

> ID：619148
> 
> 赞同：7
> 
> 时间：2009-03-06T15:01:32.800
> 
> 标签：excel, vba, mshtml

我在 MSDN 中看到了很多关于如何在 VS 中使用 MSHTML 的示例。有谁知道我们是否以及如何使用 MSHTML 和 VBA 打开网页？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-06T15:19:47.997

在 VBA 编辑器中，您进入工具 -> 引用并添加对 Microsoft HTML 对象库 [MSHTML.TLB] 的引用。这是一个带有 VBA 示例[的链接。](http://p2p.wrox.com/excel-vba/20672-problem-using-mshtml.html)

# .net - 强制 .NET 应用程序以 32 位运行的环境变量

> ID：619155
> 
> 赞同：16
> 
> 时间：2009-03-06T15:03:08.430
> 
> 标签：.net, windows, 64-bit, environment-variables

有人告诉我，您可以设置一个环境变量来强制 .NET 应用程序在 x64 版本的 Windows 上作为 32 位应用程序运行。你知道它是什么，或者知道它的参考吗？恐怕我的 google-fu 今天让我失望了（或者它不存在）。

我正在使用 Resolver One（一个 .NET 电子表格）并希望在不修改可执行文件的情况下访问一些仅限 32 位的功能。如果我可以从环境变量中配置它，那么我可以在需要时访问 32 位功能，还可以在需要时作为 64 位应用程序运行。

（注意：实际上我希望能够在启动时切换应用程序是以 32 位还是 64 位运行，而不是在编译时强制它。）

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-06T16:37:59.947

我得到了 Dino Veihland（Microsoft IronPython 开发人员）的回答。我还没来得及测试...

它是 COMPLUS_ENABLE_64BIT。我认为将其设置为 0 会禁用 64 位。

您应该能够将其设置为环境变量或向 HKLM\Software\Microsoft\.NETFramework 添加一个名为“Enable_64Bit”、类型为 REG_DWORD 和值 0 的值以全局设置它（这就是所有 COMPlus_*变量工作）。这个可能足够特别（它必须在创建进程之前运行），它必须在 reg 键中设置，但我并不完全确定。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-06T15:24:52.730

[这个链接](http://blogs.intesoft.net/post/2007/12/Running-NET-Apps-in-32-bit-mode-on-64-bit-Windows.aspx)怎么样

不完全是环境变量，只是使用CoreFlags工具来回切换。

要切换到 32 位：

```
CorFlags.exe TheApp.exe /32BIT+ 
```

回到 64 位：

```
CorFlags.exe TheApp.exe /32BIT- 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T15:06:58.170

检查这个：[http ://www.hanselman.com/blog/BackToBasics32bitAnd64bitConfusionAroundX86AndX64AndTheNETFrameworkAndCLR.aspx](http://www.hanselman.com/blog/BackToBasics32bitAnd64bitConfusionAroundX86AndX64AndTheNETFrameworkAndCLR.aspx)

顺便说一句，项目属性对话框中的目标平台。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T20:32:37.830

我很快就会尝试这个——基本上是一个 32 位运行的 exe 包装器，然后从中启动你的目标应用程序。父级的 32 位模式应该强制 AnyCPU 编译的二进制文件以 32 位运行。见[http://lostechies.com/gabrielschenker/2009/10/21/force-net-application-to-run-in-32bit-process-on-64bit-os/](http://lostechies.com/gabrielschenker/2009/10/21/force-net-application-to-run-in-32bit-process-on-64bit-os/)

# acrobat - Adobe Reader 命令行参考

> ID：619158
> 
> 赞同：100
> 
> 时间：2009-03-06T15:05:05.477
> 
> 标签：acrobat, adobe-reader

是否有针对不同版本的 Adob​​e（以前称为 Acrobat）Reader的*官方命令行（开关）参考？*

[我在Adob​​e Developer Connection](http://www.adobe.com/devnet/)上没有找到任何东西。

特别是我想：

*   启动 Reader 并打开一个文件
*   在特定位置（页面）打开文件
*   关闭阅读器（或单个文件）

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-03-06T15:19:30.323

您可以在[Adob​​e Developer FAQ](http://partners.adobe.com/public/developer/en/acrobat/sdk/pdf/intro_to_sdk/DeveloperFAQ.pdf)中找到相关内容。（这是一个 PDF 文档而不是网页，我想在这种特殊情况下这并不奇怪。）

常见问题解答指出不支持使用命令行开关。

要打开一个文件，它是：

```
AcroRd32.exe <filename> 
```

可以使用以下开关：

*   `/n`- 启动一个新的 Reader 实例，即使一个已经打开
*   `/s`- 不显示启动画面
*   `/o`- 不显示打开文件对话框
*   `/h`- 作为最小化窗口打开
*   `/p <filename>`- 打开并直接进入打印对话框
*   `/t <filename> <printername> <drivername> <portname>`- 打印指定打印机的文件。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-08-13T18:35:21.273

我找到了这个：

[http://www.robvanderwoude.com/commandlineswitches.php#Acrobat](http://www.robvanderwoude.com/commandlineswitches.php#Acrobat)

打开一个激活导航窗格的 PDF 文件，缩小到 50%，然后搜索并突出显示单词“batch”：

```
AcroRd32.exe /A "zoom=50&navpanes=1=OpenActions&search=batch" PdfFile 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-03-27T18:14:16.717

要在第 100 页打开 PDF，请执行以下操作

```
<path to Adobe Reader> /A "page=100" "<Path To PDF file>" 
```

如果您需要多个参数，请用 & 分隔它们

我在批处理文件中使用以下内容将正在阅读的书打开到我正在阅读的页面。

```
C:\Program Files\Adobe\Reader 10.0\Reader\AcroRd32.exe /A "page=149&pagemode=none" "D:\books\MCTS(70-562) ASP.Net 3.5 Development.pdf" 
```

我发现的 Adob​​e Reader 命令行参数的最佳列表在这里。
[http://partners.adobe.com/public/developer/en/acrobat/PDFOpenParameters.pdf](http://partners.adobe.com/public/developer/en/acrobat/PDFOpenParameters.pdf)

它适用于第 7 版，但我尝试过的所有论点都有效。

至于关闭文件，我认为您将需要使用 SDK，或者如果您从代码中打开文件，您可以在完成后从代码中关闭文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-24T09:01:25.593

在打印作业返回后调用它：

```
oShell.AppActivate "Adobe Reader"
oShell.SendKeys "%FX" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-10-07T03:54:00.317

没有文件名以外的其他参数的 /A 对我不起作用，但以下代码适用于 /n

```
string sfile = @".\help\delta-pqca-400-100-300-fc4-user-manual.pdf";
Process myProcess = new Process();
myProcess.StartInfo.FileName = "AcroRd32.exe"; 
myProcess.StartInfo.Arguments = " /n " + "\"" + sfile + "\"";
myProcess.Start(); 
```

# c# - Linq：双值列表 - 后继值之间的差异

> ID：619162
> 
> 赞同：4
> 
> 时间：2009-03-06T15:05:30.107
> 
> 标签：c#, linq, list, double

我有一个双值列表...

1.23, 1.24, 1.78, 1,74...

所以我想计算后继者之间的差异 - >只添加（负值应该首先是正的）......以上4个值将是0,01 +0,53（-）-0,04（-）->让它积极...

使用for循环，很容易......知道如何用linq解决它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T15:11:04.557

我不确定您对负位的含义是什么，但这可能会满足您的要求。这很可怕，因为它使用副作用，但是......

```
double prev = 0d;
var differences = list.Select(current =>
    {
       double diff = prev - current;
       prev = current;
       return Math.Abs(diff);
    }).Skip(1); 
```

（第一个值被跳过，因为它只是给出了第一个原始值和 0d 之间的差异。）

编辑：可能会稍微好一点的是基于元素对进行投影的扩展方法。这将副作用隔离在一个地方，这很好：

```
using System.Collections.Generic;

// This must be a non-nested type, and must be static to allow the extension
// method.
public static class Extensions
{
    public static IEnumerable<TResult> SelectPairs<TSource, TResult>
        (this IEnumerable<TSource> source,
         Func<TSource, TSource, TResult> selector)
    {
        using (IEnumerator<TSource> iterator = source.GetEnumerator())
        {
           if (!iterator.MoveNext())
           {
               yield break;
           }
           TSource prev = iterator.Current;
           while (iterator.MoveNext())
           {
               TSource current = iterator.Current;
               yield return selector(prev, current);
               prev = current;
           }
        }
    }
} 
```

要在您的特定情况下使用它，您可以：

```
var differences = list.SelectPairs((x, y) => Math.Abs(x-y)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T15:54:53.513

您可以使用为函数提供索引的 Select 方法的重载，以便您可以访问数组中的前一个值：

```
double sum = values.Skip(1).Select((n, i) => Math.Abs(n - values[i])).Sum(); 
```

不是一个完全“干净”的 LINQ 解决方案（Jon 的 SelectPairs 扩展看起来更好），但我认为这是形成对的最简单方法。

# python - 动态设置 wx.GridBagSizer 的大小

> ID：619163
> 
> 赞同：1
> 
> 时间：2009-03-06T15:05:34.710
> 
> 标签：python, wxpython, wxwidgets

我正在创建一个应用程序，我将按钮小部件拖到面板中。我想在我放置小部件的面板中有一个可见的网格，以便小部件与网格对齐。

我想使用 GridBagSizer 制作一个正方形为 15x15 像素的网格并不难（因为小部件将跨越多个单元格），但是如何根据面板的大小动态制作正方形的数量？

我是否必须计算在初始化和每次调整大小时需要填充面板的数量？

顺便说一句，使用 python 和 wxpython。

欧尔扬·彼得森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T16:07:55.357

根本不要使用sizer。只需自己定位按钮，使用您喜欢的任何坐标四舍五入。（使用[wxWindow::SetSize()](http://docs.wxwidgets.org/2.8/wx_wxwindow.html#wxwindowsetsize)）。

（大小调整器的意义[在于](http://docs.wxwidgets.org/2.8/wx_wxsizer.html)，当窗口调整大小时，按钮将被移动和/或调整大小。由于您不想要这种行为，因此您不应该使用大小调整器。）

# linux - 使用 -f 选项时 Egrep 的行为很奇怪

> ID：619167
> 
> 赞同：1
> 
> 时间：2009-03-06T15:06:25.393
> 
> 标签：linux, shell, resultset, grep

我有一个奇怪的表演`egrep -f`。

例子：

```
$ egrep -f ~/tmp/tmpgrep2 orig_20_L_A_20090228.txt | wc -l
3
$ for lines in `cat ~/tmp/tmpgrep2` ; do  egrep $lines orig_20_L_A_20090228.txt ; done | wc -l
12 
```

有人可以给我一个提示可能是什么问题吗？不，文件在执行之间没有改变。egrep 行数的预期答案是 12。

更新文件内容：搜索到的文件包含 cca 13000 行，每行 500 字符长，模式文件包含 12 行，每行 24 字符长。该模式始终（且仅）出现在搜索文件 (26-49) 中的固定位置。

更新模式内容：来自 tmpgrep2 的每个模式都是一个 24 字符长的数字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T15:48:47.897

如果在同一行上找到搜索模式，那么您可以得到您看到的结果：

假设您寻找：

```
abc
def
ghi
jkl 
```

数据文件是：

```
abcdefghijklmnoprstuvwxzy 
```

然后一次性命令将打印 1，循环将打印 4。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T20:38:17.717

您在 ~/tmp/tmpgrep2 中有任何重复项吗？Egrep 只会使用一次欺骗，但您的循环将使用每一次出现。

通过执行以下操作摆脱受骗者：

```
$ for lines in `sort < ~/tmp/tmpgrep2 | uniq` ; do  egrep $lines orig_20_L_A_20090228.txt ; done | wc -l 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T15:18:57.640

在第二个版本中，读取的行是否包含 shell 正在为您扩展/替换的内容？然后，当 grep 读取模式本身时，它不会完成此操作，从而导致匹配不同的模式发送。

我不完全确定外壳是否在这样的调用中对变量值进行任何扩展，但至少这是一个想法。

**编辑：**不，它似乎没有做任何替换。但这可能是引用问题，如果您的模式包含空格，则 for 循环将逐步遍历每个标记，而不是遍历每一行。看看`[read](http://www.vias.org/linux-knowhow/bbg_sect_08_02_01.html)`内置的 bash。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T23:02:09.230

其他人已经提出了我会看的大部分内容。我要检查的下一件事是环境变量 GREP_OPTIONS，或者在您的机器上调用的任何内容。使用干扰环境设置的命令行参数时，我收到了最奇怪的错误消息或行为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T15:23:48.940

我第二个@unwind。

你为什么不跑`wc -l`，看看每次搜索发现了什么？

有可能：

```
for lines in `cat ~/tmp/tmpgrep2` ; do echo $lines ; done 
```

只是看看现在shell正在处理`$lines`吗？

# sql - 如何检查 SQL Server CE 数据库的索引？

> ID：619168
> 
> 赞同：12
> 
> 时间：2009-03-06T15:06:35.160
> 
> 标签：sql, indexing, sql-server-ce

有没有办法列出所有 SQL Server CE 数据库表索引，或者至少列出单个表？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-06T17:07:59.250

> -- 检索有关数据库中包含的索引的信息。SELECT * FROM INFORMATION_SCHEMA.INDEXES
> 
> -- 检索数据库中的所有表，包括系统表。从 INFORMATION_SCHEMA.TABLES 中选择 *

[Arjuna Chiththananda - 检索 SQL CE 数据库的架构信息](http://arjunachith.blogspot.com/2007/08/retrieving-schema-information-of-sql-ce.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-05T00:09:49.700

谢谢阿朱那！您为我指明了正确的方向.....以下工作。

```
SELECT 'Y' FROM INFORMATION_SCHEMA.INDEXES
where table_name = 'PP_JOB_TICKET_LIVE' 
```

和 index_name = 'PP_JOB_TICKET_LIVE_PK'

非常感谢您的宝贵时间。

# javascript - 让 Firefox 3 与 JSUnit 一起工作

> ID：619170
> 
> 赞同：0
> 
> 时间：2009-03-06T15:07:32.520
> 
> 标签：javascript, caching, firefox-3, jsunit

到目前为止，这是我尝试过的，我使用的是 Firefox 3.07

1.  确保在**about:config**中将属性**browser.cache.check_doc_frequency**设置为**1**，浏览器将其解释为“每次检查新页面”。

2.  确保在**about:config**中将属性**security.fileuri.strict_origin_policy**设置为**false**。

3.  打开浏览器时，请务必使用**testpage**参数向**testrunner.html**页面指定要运行的测试，即：*file:///.../testRunner.html?testpage=c:/temp/someTest.html*

****   最后多取一个随机参数以确保缓存消失。*** 

 ***上面的一切似乎都有效，除了它仍然出于某种愚蠢的原因*缓存*我的***.js文件。**我真的认为这与最后更改随机参数以杀死缓存有关，但这似乎并没有起到作用。还可以做些什么来使 JSUnit 与 Firefox 3.07 一起工作？这些文件位于我的硬盘上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T16:33:29.740

您是否尝试过 CTRL + SHIFT + R 在不使用缓存的情况下进行刷新？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-08T02:50:52.587

不，那行不通。问题是它正在缓存 *.js 文件。当您执行 CTRL + SHIFT + R 时，它只会刷新测试运行器页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T21:02:52.110

到目前为止，这是我尝试过的，我使用的是 Firefox 3.07

1.

```
 Make sure in about:config that the property browser.cache.check_doc_frequency is set to 1 which the browser interprets as "check for a new page every time". 
```

2.

```
 Make sure in about:config that the property security.fileuri.strict_origin_policy is set to false. 
```

3.

```
 When opening your browser be sure to specify to the testrunner.html page which test you want to run using the testpage parameter,

  I.E.: file:///.../testRunner.html?testpage=c:/temp/someTest.html 
```

4.

```
 Tak an additional random parameter on the end to ensure that the cache is gone. 
```

上面的一切似乎都有效，除了它仍然出于某种愚蠢的原因缓存我的 *.js 文件。我真的认为这与最后更改随机参数以杀死缓存有关，但这似乎并没有起到作用。还可以做些什么来使 JSUnit 与 Firefox 3.07 一起工作？这些文件位于我的硬盘上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T21:24:30.700

尝试在 about:config 中编辑 network.http.use-cache 属性。

例如，network.http.use-cache = false

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-06T13:02:17.183

用同样的问题把我的头发拉出来。

这终于对我有用：

Firefox 菜单：工具/Web 开发人员/禁用/禁用缓存

# apache - 将内部路径重定向到虚拟主机

> ID：619174
> 
> 赞同：3
> 
> 时间：2009-03-06T15:08:57.010
> 
> 标签：apache, drupal, mod-rewrite, virtual, hosts

我已经在一个drupal测试站点上工作了一段时间，其中有一堆虚拟主机设置如下：

```
<VirtualHost *:80>
ServerAdmin email@example.com
DocumentRoot "/path/to/root"
ServerName testsite1.example.com
</VirtualHost> 
```

我一直在使用修改后的主机文件来查看每个测试站点，大致如下：

```
12.0.0.1 本地主机
20.02.2.22 testsite1.example.com
20.02.2.22 testsite2.example.com
20.02.2.22 testsite3.example.com

```

这工作得很好，但是现在我需要将站点发送给一些技术上不足以修改自己的主机文件并以我的方式查看它的人。

有没有一种方法可以设置 Apache，以便 url “ [http://20.02.2.22/testsite1](http://20.02.2.22/testsite1) ” 在内部转发到 testsite1.example.com？我正在使用 Drupal，站点设置需要查看“testsite1.example.com”，以便正确选择要选择的实例。我一直在研究 apache rewrite，但我对此有点新手，所以非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T15:26:42.023

testsite1.example.com 只会在您的机器上解析，因此您无法重定向。您可以使用 mod_proxy 设置代理。希望这对你有用：

```
<VirtualHost *:80>
  ServerAdmin email@example.com
  DocumentRoot "/path/to/root"
  ServerName testsite1.example.com
  ServerAlias 20.02.2.22
  <Location /testsite1/>
    ProxyPass http://testsite1.example.com/ 
  </Location>
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T22:04:54.967

我展示本地测试站点的方式是动态 DNS 和端口转发的组合。

在内部，我的 Drupal 站点位于 [我的机器 ip] 或 localhost。

我为我的 IP 设置了一个免费的动态 dns 名称，然后在我的路由器上，接受端口上的传入请求以路由到 [我的机器 ip]

这样，他们可以看到 yoursite.dyndns.com，但它会查看您的本地副本。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-10T02:16:52.173

为什么您不购买新域名并将其指向您的服务器 IP 地址...或者有免费的域解决方案，例如：

```
http://www.dot.tk/en/index.html?lang=en
or
http://dyn.com/dns/ 
```

如果你想购买新域名，我推荐你这个，便宜又优质的服务：[http ://server2.elite7hackers.us/recommend.php?site=godaddy](http://server2.elite7hackers.us/recommend.php?site=godaddy)

# sql-server - 表索引是否被复制到我的 sqlce 数据库？

> ID：619176
> 
> 赞同：1
> 
> 时间：2009-03-06T15:09:52.827
> 
> 标签：sql-server, indexing, replication, sql-server-ce

我有一个正在复制到移动 SQL CE 数据库的 MS SQL 数据库。

我的问题如下：

索引是否也传播到 sqlce 数据库表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-26T01:15:51.497

实际上答案是“视情况而定”。有些是，有些不是。它还取决于您如何配置移动数据库。用于配置的不同同步属性对本地数据库的作用非常不同。

1.  Peer to Peer 从不调用 FillSchema 并且不知道索引。
2.  服务器到客户端确实调用了 FillSchema（和 GetSchema()），因此它知道索引。

因此，如果您正在进行对等同步，则默认情况下本地配置的数据库不包括所有索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-22T07:40:26.487

~~如果我没记错的话，答案是否定的。镜像：是，复制：否。~~

我学到了一些新东西。

# javascript - 使用与标题不同的值自动完成

> ID：619178
> 
> 赞同：0
> 
> 时间：2009-03-06T15:10:40.033
> 
> 标签：javascript, jquery, autocomplete

我正在尝试使用 jquery 制作一个自动完成表单，但我遇到了一个问题。我正在努力做到这一点，以便当用户开始输入我们数据库中的某个地点的名称时，它会在自动完成中向他们显示该地点的全名，但是当他们单击它时，文本框会充满可以用谷歌地图定位的地方的地址。实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T01:43:51.307

这里是一些代码的粗略草图，可以帮助您入门。它绝不是完整的，但它应该给你一个很好的起点。希望能帮助到你

```
$("#mySearchBox").change(function(){
/*
    send a ajax request to receive a json object.
    We use the callback function to populate the 
    a div tag "autocomplete" with the names
*/
$.getJSON("http://myurl.com/myPage?search="+$(this).val()
        function(data){
          $.each(data.items, function(i,item){
            /*
                Assume item looks like this

                item = {[{"address": 100 Main st",
                           "name": "Bob and Joe's Dinner"],
                            ...
                       }
            */              
                /* Populate autocomplete with new spans
                   We use the text attribute to hold the address
                   You may want to look in to jquery data() feature. 
                */
                $("#autoComplete").append('<span text="'+ item.address +
                                          '" class="searchResult">'+ item.name +'</span>');
          });
        }); 
```

});

```
$("#autoComplete .searchResults").click(function(){
    /*  
        Here we handle what the user clicks on.
        Pull out the address from the attr and 
        put that back in the mySearchBox
    */
    var address = $(this).attr("text");

    //Load the adress back int the textfield
    $("#mySearchBox").val = address;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T15:13:35.440

可能使用 JSON 对象将整个“Person”对象传入 javascript。然后，您可以选择您希望每个对象的位置。

# sql - 建立过去 12 个月的每月总数

> ID：619179
> 
> 赞同：3
> 
> 时间：2009-03-06T15:10:58.987
> 
> 标签：sql, database, datetime, vb6, date

```
CurrentMonth = Month(CurrentDate)
CurrentYear = Year(CurrentDate)

    SQL = "SELECT Spent, MONTH(Date) AS InvMonth, YEAR(Date) As InvYear FROM Invoices WHERE YEAR(Date) = '" & CurrentYear & "' AND MONTH(Date) = '" & CurrentMonth & "'"
    RecordSet.Open SQL, Connection, adOpenStatic, adLockOptimistic, adCmdText
    Do Until RecordSet.EOF
        MTotal(i) = MTotal(i) + RecordSet.Fields("Spent")
        RecordSet.MoveNext
    Loop
    RecordSet.Close 
```

这是我目前必须建立一个给定月份的总支出的代码。我希望扩展它以检索过去 12 个月每月的总数。

我看到这样做的方法是通过 CurrentMonth 值向后循环，如果 CurrentMonth 值达到 0，则将 CurrentYear 的值回滚 1。使用循环变量 (i) 构建一个包含 12 个值的数组： MTotal()

你们有什么感想？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T15:44:41.340

我会通过将日期“四舍五入”到月份来解决这个问题，然后按该月份日期分组，并总计花费金额：

```
 SELECT SUM(Spent) AS [TotalSpent],
        DATEADD(Month, DATEDIFF(Month, 0, [Date]), 0) AS [MonthDate]
 FROM   Invoices 
 WHERE      [Date] >= '20080301'
        AND [Date] <  '20090301'
 GROUP BY DATEADD(Month, DATEDIFF(Month, 0, [Date]), 0)
 ORDER BY [MonthDate] 
```

[MonthDate] 可以格式化为适当地显示月份/日期，或在单独的列中显示。

WHERE 子句可以参数化以提供合适的记录范围

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T15:18:19.983

一群人应该让你上路。

```
SELECT TOP 12
  SUM(Spent) AS Spent
  , MONTH(Date) AS InvMonth
  , YEAR(Date) AS InvYear
FROM
  Invoices
GROUP BY
  YEAR(Date), MONTH(Date)
WHERE DATEDIFF(mm, Date, GETDATE(()) < 12 
```

* * *

Josh 的 DATEDIFF 是比我原来的 TOP 和 ORDER BY 更好的解决方案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T15:48:33.983

我想出的解决方案是：

```
For i = 0 To 11
    If CurrentMonth = 0 Then
        CurrentMonth = 12
        CurrentYear = CurrentYear - 1
    End If

    SQL = "SELECT Spent, MONTH(Date) AS InvMonth, YEAR(Date) As InvYear FROM Invoices WHERE YEAR(Date) = '" & CurrentYear & "' AND MONTH(Date) = '" & CurrentMonth & "'"
    RecordSet.Open SQL, Connection, adOpenStatic, adLockOptimistic, adCmdText
    Do Until RecordSet.EOF
        MTotal(i) = MTotal(i) + RecordSet.Fields("Spent").Value
        RecordSet.MoveNext
    Loop
    RecordSet.Close

    CurrentMonth = CurrentMonth - 1
Next 
```

我相信这应该按预期工作。但是，我仍然期待看到你们能提出什么解决方案，或者是否有人发现 ym fix 存在问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T15:30:40.687

唯一的问题是我需要过去 12 个月的每个月的总数，而不是过去 12 个月的总数。否则，我会看到改进 SQL 而不是使用 vb6 代码是一个更好的选择。

# asp.net - MVC + 模板

> ID：619190
> 
> 赞同：0
> 
> 时间：2009-03-06T15:15:05.263
> 
> 标签：asp.net, asp.net-mvc

我正在开发一个动态获取模板的系统，它们包含像 {{SomeUserControl}} {{SomeContent}} 这样的标签

我想知道如何使用 MVC 来呈现这些模板并以最佳方式替换标签，因为模板将通过 Web 前端进行编辑，并且内容/宏将从同一个 Web 前端创建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T15:37:54.490

您可能想看看使用另一个视图引擎，这里有一些例子。

[NHaml](http://andrewpeters.net/2007/12/19/introducing-nhaml-an-aspnet-mvc-view-engine/)
[Spark](http://dev.dejardin.org/)
[NVelocity](http://nvelocity.sourceforge.net/)
[盲文](http://www.castleproject.org/monorail/documentation/v1rc2/viewengines/brail/index.html)

我敢肯定还有更多，但这些是我能想到的。

# login - 使用网站的子域登录用户

> ID：619192
> 
> 赞同：4
> 
> 时间：2009-03-06T15:15:24.920
> 
> 标签：login, subdomain, fogbugz-on-demand, 37-signals

Fogbugz-on-demand、37 signals 和 PB-Wiki 都使用带有自定义 url 的子域，供每组用户访问他们的登录页面。因此，使用这些服务的用户似乎甚至不可能登录到通用登录（该服务的任何用户都可以登录。）

起初我认为这是一个可怕的设计缺陷，但现在我认为这是一个非常好的主意，因为：1）额外的安全性，可能不多，但你现在需要 3 条信息：1 个子域 url， 2个登录名，3个密码

2）您可以通过子域url让同一个登录登录到不同的帐户。

3) 这有助于更多的隔离、负载平衡和易于部署，因为您可以让子域在不同的服务器下运行，彼此之间更加隔离。

4) 您可以在将其部署到所有用户之前，逐步将更改部署到标记为 BETA 用户的特定子域集。

Web 应用程序基于子域的登录是未来吗？我没有看到这种设计方法是否存在缺陷？非程序员用户理解子域概念是否过于混乱？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T15:45:22.727

我们改为使用三元素登录。我们要求提供用户名、密码和客户端 ID。与子域的概念相同，但有一个通用的登录 URL。这也很好。但是，我确实在子域过程中看到了一个优势，您可以为登录页面打上烙印，因为您知道所请求的客户端。在我们的方法中，我们无法标记登录页面，因为在您提交登录页面之前我们不知道客户。

# automated-tests - Doh / dijit 机器人 - 没有鼠标动作发生

> ID：619193
> 
> 赞同：0
> 
> 时间：2009-03-06T15:15:28.180
> 
> 标签：automated-tests, dojo, doh-robot

我使用 dijit 机器人编写了一个自动化测试 - 但为了能够在我们的 Web 应用程序中使用相对路径，我为我们的测试创建了一个 OSGi 服务并将测试代码放在速度模板中。当我尝试运行测试时，没有任何反应。如果我在 html 文件中使用相同的脚本并直接从 Windows 资源管理器（而不是通过 localhost）访问它，它工作正常。我发现有很多情况会使 dijit 机器人测试无法运行 - 有没有人遇到过这个问题并发现了所有让 dijit 测试运行的小问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T06:43:06.940

问题可能是如果你用 openjdk 尝试它，在 oracle java 版本上运行它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-13T13:38:28.297

查看 dijit.initRobot()，它可能会为您处理一些事情。

[这篇博](http://mindtrove.info/tidbit-dohrobot-initialization/)文中描述了搞砸了我的很多测试的一件事- 基本上机器人没有初始化，因为我掩盖了机器人点击初始化的特殊 div。

然而，我意识到 doh 机器人仍然存在很多问题 - 它看起来非常脆弱。通常我会有一个工作测试，然后添加 1 个机器人命令，测试就会中断。当我删除该行并再次尝试时......即使它与以前的代码完全相同，机器人也不会运行。

我发现编写机器人代码时最好的办法就是每次都清除缓存并交叉手指。祝你好运。

# vim - vim 复制和替换文本

> ID：619194
> 
> 赞同：10
> 
> 时间：2009-03-06T15:15:55.013
> 
> 标签：vim, copy-paste

可以说我有这个文本：

```
$test = 'lorem';
$test2='ipsum';

```

我想复制lorem并粘贴到ipsum中。我尝试`yi'`在 lorem 上做，然后在 ipsum 上做了，`ci'`但是用 ipsum 替换了我的 pastebin。我以前的副本丢失了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-06T15:26:47.293

**yi'** on lorem, 移到 ipsum 的 i, **vep** ?

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-11T14:45:10.630

简单的：

"kyi' on lorem, 移动到 ipsum 的 i, ve"kp

这将 lorem 拉*入寄存器 k，将其粘贴到**来自*寄存器 k的 ipsum 上，并将其*保存*在寄存器 k 中，以便再次粘贴到您可能想要放置的任何其他位置。ipsum 仍然会在默认寄存器中结束，但这不再是问题并且也可能有用。

如果您已经在寄存器 k 中得到了一些东西，您可以使用不同的寄存器来代替（只需使用不同的键）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-06T15:25:23.180

我通常去 sed 命令。

```
:%s/ipsum/lorem/g 
```

*   `%`意味着对每一行都这样做
*   `s`表示 sed，或搜索和替换
*   `g`最后意味着将每个替换`ipsum`为`lorem`; 如果你省略它，它只会替换第一个。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-06T16:12:15.547

转到 lorem 的 l，ye（拉到词尾）。转到ipsum的i，“_de（删除到词尾，将删除的文本放入黑洞寄存器。P（在光标之前粘贴寄存器）。

总而言之：yej"_deP

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-06T15:24:40.670

为什么不使用 猛拉到命名缓冲区，`"ayi'`然后使用 删除和粘贴`d'i"aP`？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-06T15:25:45.253

我不确定你到底想要什么。

你有两行：

```
$test = 'lorem';
$test2= 'ipsum'; 
```

如果你去 l 和 yw，它会拉取 lorem，然后去 ipsum、cw 和 p 的 i，它将用 lorem 替换 ipsum。您仍然会在寄存器中同时拥有 lorem 和 ipsum。

您可以使用 :reg 获取这些寄存器的内容

如果你想从他们那里粘贴一些东西，那么 "*p, 或 ":p, 或 "0p (当你输入:reg时你会看到它)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-06T15:56:20.733

此处停止 Markdown 将后面的代码视为纯文本的单词。

```
/lorem
"adw
/ipsum
"aP"bdw
``
"bp 
```

第一个文本搜索“lorem”；next 将单词删除到名为“a”的缓冲区中，在文本中留下一对空引号。下一次搜索找到“ipsum”；将`"aP`名为“a”的缓冲区拉入单词 ipsum 之前；将`"bdw`单词删除到名为“b”的缓冲区中，留下“lorem”。双反引号返回上次搜索的来源 - 空引号；并`"bp`在第一个引号之后拉出命名缓冲区。

您也可以省略`"a`and `"b`，但是这样，值在命名缓冲区中`"a`，`"b`并且可以一次又一次地复制，直到您不再需要这些值为止。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-06T16:53:22.000

在您执行`ci'`impsum 之后，您的 lorem 就在 register 中`"0`。因此，您可以执行`ci'^R0`( `^R`means `Ctrl+r`) 并将您的 lorem 粘贴到 ipsum 的位置。

有关编号寄存器的更多信息，请参阅`:help quote_number`。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-06T18:16:24.313

`vi'y`在*lorem*

`vi'p`在*ipsum上*

`gvy`复制回*lorem*以注册可能的宏`vi'p`

( `qa`- `gvy`- `j`- `vi'p`- `q`- `@a`- `@@`- `@@`...)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-06T15:25:48.700

您想用来`y`复制选择和`p`粘贴。

[这是一个很好的清单，可以随身携带。](http://www.pixelbeat.org/vim.tips.html)

# c# - 在运行时转换为多个（未知类型）

> ID：619197
> 
> 赞同：1
> 
> 时间：2009-03-06T15:18:05.817
> 
> 标签：c#, types, serialization

我正在开发一个查看器，它将能够打开我们通过我们的软件生成的所有自定义文档。所有文档都继承自 IDocument，但我不确定如何进行反序列化（以一种好的方式 - 嵌套的 try/catch 可能会起作用，但这会很可怕）。

所以我的方法现在看起来像这样：

```
public Boolean OpenDocument(String filename, Type docType, out IDocument document)
{
    // exception handling etc. removed for brevity

    FileStream fs = null;
    BinaryFormatter bFormatter = new BinaryFormatter();

    fs = new FileStream(filename, FileMode.Open);
    document = (docType)bFormatter.Deserialize(fs);

    return true;
} 
```

显然这不起作用，因为我不能那样使用变量 docType，但我认为它说明了我正在尝试做的事情。这样做的正确方法是什么？

编辑> @John 好的，也许我应该附加另一个问题：如果我有一个界面：

```
public interface IDocument
{
    public Int32 MyInt { get; }
} 
```

和一个班级：

```
public class SomeDocType : IDocument
{
    protected Int32 myInt = 0;
    public Int32 MyInt { get { return myint; } }

    public Int32 DerivedOnlyInt;
} 
```

如果我反序列化为 IDocument，那么 DerivedOnlyInt 是否会成为对象的一部分 - 这样在反序列化后，我可以转换为 SomeDocType 并且会好起来吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T15:21:48.227

为什么不直接投到`IDocument`？您认为在这里转换为确切的类型会有什么好处？

如果您希望调用者以强类型的方式获取结果，我将使用泛型来编写它：

```
public T OpenDocument<T>(String filename) where T : IDocument
{
    using (FileStream fs = new FileStream(filename, FileMode.Open))
    {
        BinaryFormatter bFormatter = new BinaryFormatter();    
        return (T) bFormatter.Deserialize(fs);
    }
} 
```

当然，这依赖于调用者在编译时知道正确的类型。如果他们不这样做，他们无论如何也不可能知道如何*使用*正确的类型，所以只需 return `IDocument`：

```
public IDocument OpenDocument(String filename)
{
    using (FileStream fs = new FileStream(filename, FileMode.Open))
    {
        BinaryFormatter bFormatter = new BinaryFormatter();    
        return (IDocument) bFormatter.Deserialize(fs);
    }
} 
```

编辑：要回答对您问题的编辑，是的，派生属性仍然存在。强制转换实际上并没有改变一个对象——它只是意味着你得到一个编译器知道是适当类型的引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T15:24:20.547

您正在使用将类型信息包含到序列化流中的 BinaryFormatter 类，因此您不需要 docType 变量：

```
public Boolean OpenDocument(String filename, out IDocument document)
{
    // exception handling etc. removed for brevity

    FileStream fs = null;
    BinaryFormatter bFormatter = new BinaryFormatter();

    fs = new FileStream(filename, FileMode.Open);
    document = (IDocument)bFormatter.Deserialize(fs);

    return true;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T15:37:05.367

如果您可以很容易地弄清楚它是什么类型的文档（即：它是文件头的一部分），那么制定针对每种类型的反序列[化策略可能是最简单的。](http://en.wikipedia.org/wiki/Strategy_pattern)

# algorithm - 老化数据集

> ID：619204
> 
> 赞同：3
> 
> 时间：2009-03-06T15:19:33.023
> 
> 标签：algorithm, math

出于我不想讨论的原因，我需要过滤一组值以减少抖动。为此，我需要能够平均一个数字列表，最近的影响最大，最近的影响最小。我使用的样本大小为 10，但在某些时候很容易改变。

我可以在这里应用任何相当简单的老化算法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T15:24:31.840

*   看看[指数平滑](http://en.wikipedia.org/wiki/Exponential_smoothing)。相当简单，可能足以满足您的需求。基本上，最近的观察结果比旧的观察结果相对更重要。
*   此外（取决于应用程序）您可能想要查看各种强化学习技术，例如[Q-Learning](http://en.wikipedia.org/wiki/Q-learning)或[TD-Learning](http://en.wikipedia.org/wiki/Temporal_difference_learning)或一般来说任何涉及*折扣*的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T16:20:53.327

我在嵌入式控制应用程序中遇到了类似的情况。

我遇到的最简单的选择是 3/4 过滤器。这将连续应用于整个数据集：

```
current_value = (3*current_value + new_value)/4 
```

我最终决定改用 16 抽头 FIR 滤波器：

[概述](http://www.dsprelated.com/dspbooks/filters/Example_Zero_Phase_Filter_Design.html)
[FIR 常见问题解答](http://www.dspguru.com/info/faqs/firfaq.htm)
[维基百科文章](http://en.wikipedia.org/wiki/Finite_impulse_response)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T17:09:07.907

可以使用许多加权平均算法。

例如，对于 n = 1 到 N 按顺序（最新到最旧）的项目 I(n)：

```
(SUM(I(n) * (N + 1 - n)) / SUM(n) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T23:25:46.840

从问题中不清楚您是在处理固定长度数据还是数据是否连续进入。后者的一个很好的物理模型将是一个低通滤波器，使用一个电容器和一个电阻器（R 和 C） . 假设您的数据在时间上是等距的（是吗？），这会导致更新处方

U_aged[n+1] = U_aged[n] + deltat/Tau (U_raw[n+1] - U_aged[n])

其中 Tau 是滤波器的时间常数。在零增量的限制下，这会产生指数衰减（旧值将在 Tau 时间后减少到其值的 1/e）。在一个实现中，您只需要保持一个运行加权和 U_aged。

deltat 为 1，Tau 将指定“老化常数”，即减少样本对 1/e 的贡献所需的步数。

# jsf - 如何选择 javax.faces.model.SelectItem

> ID：619215
> 
> 赞同：6
> 
> 时间：2009-03-06T15:23:32.857
> 
> 标签：jsf

我正在创建一个`javax.faces.model.SelectItem`（在 bean 中）列表以供 a 使用，`h:selectManyCheckbox`但我无法弄清楚如何进行`SelectItem`选择。

这该怎么做？应该可以吧？...

```
 public List<SelectItem> getPlayerList(String teamName) {
    List<SelectItem> list = new ArrayList<SelectItem>();

    TeamPage team = (TeamPage) pm.findByName(teamName);

    List<PlayerPage> players = pm.findAllPlayerPages();

    for (PlayerPage player : players) {
        boolean isMember = false;
        if (team.getPlayerPages().contains(player)) {
            isMember = true;
        }
        SelectItem item;
        if (isMember) {
            // TODO: Make SelectItem selected???
            item = null;
        } else {
            item = new SelectItem(player.getId(), createListItemLabel(player), "", false, false);
        }
        list.add(item);         
    }
    return list;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-06T15:49:10.237

假设我们有这个 JSF 代码：

```
<h:selectManyCheckbox value="#{bean.selectedValues}">
    <f:selectItems value="#{bean.playerList}"/>
</h:selectManyCheckbox> 
```

然后选定的值（即选中的复选框）存储在*bean.selectedValues*属性中。

因此，在您的 Java 代码中，您必须通过将正确的 ID 放入*selectedValues*属性来处理 selectValues。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2019-09-02T10:32:05.037

如果有人正在使用 selectOneMenu 并动态填充元素：在创建 SelectItem 时，如果您提供一些值（第一个参数），如下所示：

```
new SelectItem("somevalue", "someLabel", "someDescription", false, false); 
```

它在 html 中转换为：

```
<option value="somevalue">someLabel</option> 
```

如果您不提供如下值：

```
new SelectItem("", "someLabel", "someDescription", false, false); 
```

, 翻译成这个

```
<option value="" selected="selected">someLabel</option> 
```

因此，如果您希望某个元素成为页面加载的默认值（例如“选择其中之一”），请不要提供值。如果您创建了多个没有值的元素，则会在页面加载时选择其中任何一个作为默认值（可能基于字母升序的偏好）。

# asp.net - 缺少 StackTrace 信息

> ID：619218
> 
> 赞同：2
> 
> 时间：2009-03-06T15:24:22.167
> 
> 标签：asp.net, vb.net, exception

我似乎从堆栈跟踪中丢失了一些信息，这就是我得到的：

```
at Foo.Bar(DataTable table) in D:\Foo\Bar\authoring\App_Code\FooBar.vb:line 87 
```

堆栈跟踪信息的其余部分在哪里？

编辑：

Web.Config 中的自定义错误设置为关闭，我正在处理捕获的错误，如下所示：

```
 Catch ex As Exception
     Respose.Write(ex.StackTrace)
 End Try 
```

堆栈跟踪仍然被截断。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T15:30:36.693

确保在 web.config 中将 customErrors 设置为“RemoteOnly”或“Off”以禁用友好错误。

或者可能堆栈跟踪被重置？（尽管如果是这种情况，您仍然应该看到一些东西）

将重置您的堆栈跟踪。

```
catch(Exception ex) 
{
   throw ex; 
} 
```

不会重置您的堆栈跟踪。

```
catch(Exception ex) 
{
   throw; 
} 
```

**编辑：**

*[ex.StackTrace](http://msdn.microsoft.com/en-us/library/system.exception.stacktrace.aspx)*获取当前堆栈。堆栈跟踪从引发异常（发生错误）的位置开始，并在捕获异常的当前堆栈帧处结束。所以它正在反转调用堆栈。由于您一发生就写出堆栈跟踪，因此没有机会在调用堆栈中进一步向上。

根据你在做什么，你可以尝试一些事情。

```
//To just see the stackTrace
Catch ex As Exception
     Throw
 End Try 
```

[Environment.StackTrace](http://msdn.microsoft.com/en-us/library/system.environment.stacktrace.aspx) - 获取当前堆栈跟踪信息

```
//If you are trying to log the stacktrace 
Catch ex As Exception
     Respose.Write(Environment.StackTrace)
     Respose.Write(ex.StackTrace)
 End Try

//If is hiding then try - hiding as in throw ex vs just throw
Catch ex As Exception
     //careful innerException can be null
     //so need to check before using it
     Respose.Write(ex.InnerException)
 End Try 
```

其中一种方法应该适合您。

# java - 您会推荐什么平台来开发 SAAS 应用程序？

> ID：619221
> 
> 赞同：0
> 
> 时间：2009-03-06T15:24:45.023
> 
> 标签：java, .net, ruby, lamp

我应该使用 LAMP、.Net 还是任何其他平台？我可以访问具有 LAMP、.Net、ROR 和 Java 经验的资源。谢谢。

抱歉含糊其辞。你能像保罗一样给我一些优点和缺点吗？感谢您的时间和精力。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T15:46:13.440

如果您打算托管该系统，那么您最好使用一种您熟悉的语言并可以雇用人员来帮助您。这意味着您想要一些相当流行的东西，但也面向您正在实现的功能类型。大概您正在编写某种形式的 Web 应用程序。

就个人而言，我最喜欢的网络应用程序语言是 Perl，但它需要大量的自律才能避免让它变得一团糟。这对大团队来说可能不是很好，而且很难雇佣有经验的人。

PHP 非常适合开发 Web 应用程序，并且拥有大量追随者。除非我没有跟上它 LAMP、.Net、ROR 和 PHP 都受 web 1.0 技术的限制，这意味着如果你想使用 AJAX（这几天风靡一时），可以使用 Dojo 之类的 JavaScript 库来扩充它们）。

如果软件是企业级的，那么 Java 或 C# 更畅销，但既然您自己运行它，那没关系。就我个人而言，我会远离 J2EE，它对于太少的功能来说太复杂了。

我最新的组合是 Java、GWT 和 hibernate，但我发现它们是非常难以掌握的技术。如果您有时间进行长期开发，那很好，但如果您赶时间，那就不是很好。

所以，如果你很着急，在 LAMP 中进行原型设计，用一个非常简单的 1.0 前端可能是最好的，然后一旦你明确了这个概念，用一些更强大的技术重做系统将帮助你进入下一个性能水平。

保罗。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T15:31:54.973

如果它是一个专业项目，那么使用你拥有最好的资源的任何东西，如果你不知道，那么问问你的同事他们最喜欢什么。如果事情真的是平等的（我怀疑他们是平等的），那么使用每个平台来编写一个随机的平台选择器，并使用它来做出你的选择。

相反，如果它是一个个人项目并且您正在寻找新的东西，那么请使用您最不了解的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T15:34:28.320

Waaaay太主观/争论。

他们都有得有失，如今都擅长 SAAS 类型的架构。根据您的目标，使用您最满意或最不满意的任何一种。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T03:14:21.227

尝试查看哪个平台具有专门构建的解决方案。我知道在 .NET 中有 Apprenda 的 SaaSGrid，而在 Java 中，BEA 正在开发一个叫做 Genesis 的东西，但我认为当甲骨文收购它们时它被取消了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-13T13:13:13.610

我的回答和保罗一样。

1.  了解您的用户是谁以及他们是否有软件要求，例如 Microsoft 许可证等。将 Microsoft 应用程序与 .net 绑定比任何其他语言都容易得多。
2.  如果您有预算，请了解您的预算。PHP 将是构建 Web 应用程序的最便宜和最快的方法。您只需要 apache、大约 10 行站点配置和大约 50 行 SAAS 应用程序代码。
3.  它是一次性的开发和忘记吗？大多数应用程序不会，因此您需要使用易于访问且支持良好的语言来开发它。如果您需要高可用性、可访问性和支持，那么使用 Ruby 或 Perl 进行开发毫无意义。

请记住，您可以使用 PHP、Java 和 .NET 开发企业级应用程序。人们使用 .NET 和 Java 为企业级应用程序开发的原因之一是可用的支持、更严格的语言、通常更好的开发人员等。PHP 对企业没有好处是一个神话——每个平台都只有最弱的平台一样强大零件。

您使用的是 Oracle 还是 Microsoft 数据库？虽然 PHP 可以连接到这些系统，但它们需要额外的驱动程序才能这样做。

首先，弄清楚你要构建什么。**用您不会开发最终解决方案**的语言对其进行原型制作（除非该语言是您最强大和最有能力的语言），这样您就无法继续使用原型作为最终解决方案。将业务逻辑、框架脚手架和库创意转换为您选择的语言。

我以前用 PHP 开发过 SaaS 应用程序，根据我的经验，可以说有数百种方法可以给同一只猫剥皮

**优点：**

1.  廉价开发
2.  快速发展
3.  服务器成本低
4.  初始维护成本低

**缺点：**

1.  最有可能不熟悉 OOP 和 SAAS 概念的半胜任开发人员（这几乎总是给定的）
2.  昂贵的维护费用，尤其是第 1 点
3.  没有有效缓存策略的性能开销
4.  每个接触应用程序的开发人员都希望将其开发到自己的系统中
5.  不是强类型语言，因此类型提示非常重要，并且不断验证输入的类型和正确性（单词？）

希望有帮助...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-26T18:38:26.910

您可以使用名为 4WS.Platform 的免费网络 RAD：

www.4wsplatform.org

这是免费的。您可以将其部署在 Google App Engine 中并使用它在云上创建 Web 应用程序，这是一种 Saas 解决方案......

# svn - 在 Mac OS X 的整个目录层次结构中删除所有 .svn 目录的最佳方法是什么？

> ID：619224
> 
> 赞同：23
> 
> 时间：2009-03-06T15:25:03.930
> 
> 标签：svn, macos

有没有有用的命令？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-03-06T15:26:56.170

```
find . -name .svn  -type d -print0 |xargs -0 rm -rf 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-06T15:26:28.293

只需从 subversion 存储库中**导出。**

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-06T15:30:39.440

对于支持它的系统：

```
find . -name .svn -delete 
```

或者，如果他们不支持 -delete 开关：

```
find . -name .svn -exec rm -rf {} \; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-08T14:27:52.270

在工作副本文件夹的根目录中，执行

```
svn export --force . 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-09-04T10:18:27.890

打开终端窗口。转到您的项目文件夹并将文件夹拖到终端窗口中。现在您可以找到文件夹的路径。运行以下命令

```
find . -type d -name .svn -exec rm -rf {} \; 
```

所有 .svn 文件夹都将被删除，您可以再次将新代码上传到 svn。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-01-03T05:10:51.487

在您的文件夹中键入以下命令。

```
find . -name .svn  -type d -print0 |xargs -0 rm -rf 
```

# .net - .Net将NULL值从变量值插入SQL Server数据库

> ID：619230
> 
> 赞同：6
> 
> 时间：2009-03-06T15:26:30.510
> 
> 标签：.net, sql-server, database

有类似的问题，但答案不是我想要的。如果引用为 NULL 或尚未分配值，我想将 NULL 值插入 SQL Server 数据库。目前我正在测试 null ，它看起来像

```
String testString = null;

if (testString == null)
{
    command.Parameters.AddParameter(new SqlParameter("@column", DBNull.Value);
}
else
{
    command.Parameters.AddParameter(new SqlParameter("@column", testString);
} 
```

这对我来说看起来和感觉都非常笨拙。我有很多值要插入数据库并像上面一样测试它们非常冗长。.Net 是否没有以某种方式处理这个问题。我想也许如果我使用字符串而不是字符串，但这似乎也不起作用。环顾四周，我发现了有关使用 Nullable 类型的文章。

```
System.Nullable<T> variable 
```

这似乎适用于原语，int？，char？双倍的？和布尔？所以这可能适用于那些，但字符串呢？我在这里错过了什么吗。我应该为原始值和字符串值使用什么类型，这样我就不必在插入它们之前重复测试值。

编辑：在我得到太多关于三元运算符的答案之前。我喜欢他们，但不是在这种情况下。对我来说，需要测试该值并拥有所有额外的逻辑是没有意义的，当这类事情可以在 .Net 框架的较低位置实现时，如果我知道要给出什么类型，那么它就会得到它免费。

**编辑：** 好的，所以大家帮我制定我的进攻计划。我将 Nullable 用于我的原语（int？，double？等），对于我的字符串，我将使用 String 但 ?? 测试。这使事情变得不那么冗长。我在这里有什么遗漏的吗，比如可能丢失了一些语义？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-06T15:40:32.940

双问号 (??) 运算符甚至比三进制更好。取第一个非空值。所以：

```
string x = null;
command.Parameters.AddParameter(
     new SqlParameter("@column", (object)x ?? DBNull.Value); 
```

会给你一个值为 DBNull.Value 的参数，但是

```
string x = "A String";
command.Parameters.AddParameter(
     new SqlParameter("@column", (object)x ?? DBNull.Value); 
```

会给你一个以“A String”作为值的参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T15:35:27.353

Nullable 适用于基元。我将不得不测试字符串的行为，但至少清理代码的一个选项是定义字符串的扩展方法。

你可以使用?? 字符串运算符：

command.Parameters.AddParameter(new SqlParameter("@column", myNull ?? (object)DBNull.Value);

?? 如果它不为 null，则返回第一项，否则返回第二项。

# 编辑

修复了上面的代码，因此它将编译您需要将 DBNull.Value 转换为对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T15:29:09.660

也许三元运算符是你觉得有用的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T15:31:38.517

我有时会这样做：

```
command.Parameters.Add ("@column", SqlDbType.VarChar).Value = DBNull.Value;

if( String.IsNullOrEmpty (theString) == false )
{
    command.Parameters["@column"].Value = theString;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T15:37:52.463

我同意必须将 SqlParameter.Value 设置为 DbNull.Value 很笨拙而且有点不幸。但是没有办法解决它，所以你必须忍受对 null 的测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T15:40:08.993

`Nullable<T>`不能应用，`String`因为它是引用类型而不是值类型。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-04T05:00:51.330

例子：

```
if (txtDisplayName.Text != "")
{
    insert into table (id,display_name) values ('" + txtID.Text + "','" + txtDisplayName.Text + "');
}
else
{
    insert into table (id) values ('" + txtID.Text + "');
} 
```

这将插入`null`.

# linq - 没有显式外键关系的 Linq To SQL

> ID：619231
> 
> 赞同：15
> 
> 时间：2009-03-06T15:26:31.197
> 
> 标签：linq, linq-to-sql, class, foreign-keys, associations

我正在处理一些具有关系的旧表，但这些关系尚未明确设置为主键/外键。我使用“Linq To Sql Classes”创建了一个 .dbml 文件并建立了正确的 Case.CaseID = CaseInfo.CaseID 关联。我的结果类是 CasesDataContext。

我的表（一对多）：

```
Case
------------------
CaseID (int not null)
MetaColumn1 (varchar)
MetaColumn2 (varchar)
MetaColumn3 (varchar)
...

CaseInfo
------------------
CaseInfoID (int)
CaseID (int nulls allowed)
CaseInfoMeta (varchar)
... 
```

我是 LinqToSQL 的新手，做起来有困难..

```
CasesDataContext db = new CasesDataContext();
var Cases = from c in db.Cases
            where c.CaseInfo.CaseInfoMeta == "some value"
            select c; 
```

*（编辑）我的问题是 CaseInfo 或 CaseInfos 不能作为 Cases 的成员使用。*

我从一位同事那里听说我可能会尝试使用 ADO.Net 实体数据模型来创建我的数据上下文类，但还没有尝试过，想看看我是否会浪费我的时间，或者我应该走另一条路。任何提示、链接、帮助将不胜感激。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-06T23:15:06.670

返回设计器并检查关系是否设置正确。这是一个现实生活中的示例，BillStateMasters 具有“CustomerMasters1”属性（该州的客户）： [![替代文字](https://i.stack.imgur.com/0C8BX.jpg)](https://i.stack.imgur.com/0C8BX.jpg)

附言。正在清理命名...

**更新 1：**您还需要确保两个表都定义了一个主表。如果主键未在数据库中定义（并且无论出于何种原因无法定义），请确保在设计器中定义它们。打开列的属性，并将其设置为主键。也就是说，如果您没有实体的主键，实体跟踪也将不起作用，这对于删除意味着它不会默默地更新实体。因此，请确保检查所有实体并让它们都带有主键（正如我所说，如果它不能在数据库上，那么就在设计器上）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T21:35:13.437

```
CasesDataContext db = new CasesDataContext();
var Cases = from c in db.Cases
            join ci in db.CaseInfo on
            ci.ID equals c.InfoID
            where ci.CaseInfoMeta == "some value"
            select new {CASE=c, INFO=ci}; 
```

我的“加入” linq 有点生疏，但上面应该接近你所追求的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T15:33:20.523

关联设置为一对一还是一对多？如果您将关联设置为一对多，那么您拥有的是 EntitySet，而不是 EntityRef，您需要在依赖集上使用 where 子句来获得正确的值。我怀疑你想要一对一的关系，这不是默认的。尝试将其更改为一对一，看看是否可以构造查询。

注意：我只是在猜测，因为您实际上并没有告诉我们“麻烦”到底是什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T15:36:02.733

您的查询看起来正确，应该返回 Case 对象的查询结果集。

所以有什么问题？

> *（编辑）我的问题是 CaseInfo 在 Cases 下不可用... iecCaseInfo 不存在，我假设如果存在明确的主/外键关系。*

“不可用”是什么意思？如果您按照您所说的那样在设计器中创建了关联，那么查询应该生成类似于以下内容的 SQL

```
SELECT [columns] 
FROM Case INNER JOIN CaseInfo 
   ON Case.CaseID = CaseInfo.CaseID
WHERE CaseInfo.CaseInfoMeta = 'some value' 
```

你调试过你的 linq 查询来生成 SQL 了吗？它返回什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T18:01:35.707

您可能想尝试几件事：

检查关联的属性。确保将 Parent 属性创建为 Public。默认情况下它会这样做，但有些东西可能已经改变了。

由于您没有在 C 上获得 CaseInfo，请尝试从另一个方向输入它以查看您是否获得带有智能感知的 ci.Case。

一起删除并重新创建关联。

如果子成员没有出现，就会出现一些非常基本的问题。最好删除 dbml 并重新创建整个内容。

如果一切都失败了，请切换到 NHibernate。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T18:51:39.830

这是c#吗？我认为你需要`==`而不是 = 在这一行：

```
where c.CaseInfo.CaseInfoMeta = "some value" 
```

应该读

```
where c.CaseInfo.CaseInfoMeta == "some value" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T19:36:21.357

经过几次测试，我很确定无论在 Linq-to-SQL 中创建什么关联，数据库中都需要 FK 关系。即，如果您没有在数据库中明确设置它们，那么您将不得不手动进行连接。

# asp.net-mvc - 在 ASPNETMVC 中将匿名类型传递给 UpdateModel/TryUpdateModel

> ID：619236
> 
> 赞同：2
> 
> 时间：2009-03-06T15:28:44.763
> 
> 标签：asp.net-mvc

给定以下控制器方法：

```
 [AcceptVerbs("POST","GET")]
    public ActionResult apiMapInfo()
    {
        var x = new { Lat = "", Long = "", Name = ""};
        var mapInfo = new DALServices.Models.MapInfo(); 
```

// 正确更新

```
 TryUpdateModel(mapInfo); 
```

// 没有正确更新

```
 TryUpdateModel(x); 

        var svc = new APIServices.Services.ReturnMapInfo() {inputs = mapInfo};
        svc.Run();
        return new ObjectResult<Result>(new Result(svc.errorCode, svc.errorMessage, svc.results), svc.ExtraTypesForSerialization);
    } 
```

TryUpdateModel 方法没有正确更新对象 x，但 mapInfo 对象可以。

我的假设是 TryUpdateModel 方法不处理映射到像 x 这样的匿名类型。

谢谢，

哈尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T15:39:53.473

[匿名类型是不可变的](http://blogs.msdn.com/sreekarc/archive/2007/04/03/immutable-the-new-anonymous-type.aspx)。因此，它们无法更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T15:42:14.700

[匿名类型](http://msdn.microsoft.com/en-us/library/bb397696.aspx)具有只读属性，因此 TryUpdateModel 没有可用的公共设置器来更改属性值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T15:35:08.930

我猜是因为 UpdateModel 和 TryUpdateModel 正在寻找属性和对匿名类型的反射可能有点不同。无论哪种方式，最简单的方法就是创建一个具体类型。

# javascript - 检测 location.hash 中 & 和 %26 之间的差异

> ID：619240
> 
> 赞同：3
> 
> 时间：2009-03-06T15:30:17.520
> 
> 标签：javascript

使用这个简单的 javascript 代码分析 location.hash：

`<script type="text/javascript">alert(location.hash);</script>`

我很难分离出包含 &（编码为 %26）的 GET 变量和用于分隔变量的 &。

示例一：

*   # 代码=php&年龄=15d

示例二：

*   # 代码=php%20%26%20代码&年龄=15d

如您所见，示例 1 没有问题，但是让 javascript 知道示例 2 中的“code=php & code”超出了我的能力范围：

（注意：我并没有真正使用这些变量名，并且将它们更改为其他名称只会在搜索词与搜索键不匹配的情况下起作用，所以我不会认为这是一个有效的解决方案。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-07T01:44:12.240

片段标识符（“哈希”）中的 %26 和 & 之间没有区别。'&' 只是 URI 的查询（“搜索”）段中具有特殊含义的保留字符。转义 '&' 与将 'a' 转义为 '%61' 相比，无需为 to '%26' 提供更多应用程序级别的可见性。

由于没有用于在片段标识符中隐藏结构化数据的标准编码方案，您可以自己制作。例如，使用 '+XX' 十六进制编码对组件中的字符进行编码：

```
hxxp://www.example.com/page#code=php+20+2B+20php&age=15d

function encodeHashComponent(x) {
    return encodeURIComponent(x).split('%').join('+');
}
function decodeHashComponent(x) {
    return decodeURIComponent(x.split('+').join('%'));
}

function getHashParameters() {
    var parts= location.hash.substring(1).split('&');
    var pars= {};
    for (var i= parts.length; i-->0;) {
        var kv= parts[i].split('=');
        var k= kv[0];
        var v= kv.slice(1).join('=');
        pars[decodeHashComponent(k)]= decodeHashComponent(v);
    }
    return pars;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T15:36:56.163

在 Firefox 3.1 上进行测试，看起来浏览器在填充 location.hash 变量时将十六进制代码转换为适当的字符，因此 JavaScript 无法知道原始代码是单个字符还是十六进制代码。

如果您尝试在哈希变量中编码像 & 之类的字符，我建议您将其替换为另一个字符串。

您还可以以奇怪的方式解析字符串，例如（此处为 JS 1.6）：

```
function pairs(xs) {
  return xs.length > 1 ? [[xs[0], xs[1]]].concat(pairs(xs.slice(2))) : []
}

function union(xss) {
  return xss.length == 0 ? [] : xss[0].concat(union(xss.slice(1)));
}

function splitOnLast(s, sub) {
  return s.indexOf(sub) == -1 ? [s] : 
                                [s.substr(0, s.lastIndexOf(sub)),
                                 s.substr(s.lastIndexOf(sub) + sub.length)];
}

function objFromPairs(ps) {
  var o = {};
  for (var i = 0; i < ps.length; i++) {
    o[ps[i][0]] = ps[i][1];
  }
  return o;
}

function parseHash(hash) {
  return objFromPairs(
           pairs(
             union(
               location.hash
                       .substr(1)
                       .split("=")
                       .map(
                         function (s) splitOnLast(s, '&')))))
}

>>> location.hash
"#code=php & code&age=15d"
>>> parseHash(location.hash)
{ "code": "php & code", "age": "15d" } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T15:35:15.853

只需与第一个示例相同，但在拆分 & 然后调用**unescape(** ) 将 %26 转换为 & 并将 %20 转换为空格。

编辑：

看起来我有点过时了，您现在应该使用**decodeURIComponent()**，尽管我没有看到任何关于它与**unescape()**不同之处的明确解释，除了建议它不处理 Unicode适当地。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-05T01:26:08.280

这对我来说很好：

```
var hash = [];
if (location.hash) {
 hash = location.href.split('#')[1].split('&');
} 
```

# indexing - “博客”子域是否有助于您的主站点的页面排名？

> ID：619241
> 
> 赞同：21
> 
> 时间：2009-03-06T15:30:22.310
> 
> 标签：indexing, seo, subdomain, pagerank

我有我的主要应用程序站点[https://drchrono.com ，并且我在](https://drchrono.com)[http://blog.drchrono.com](http://blog.drchrono.com)下有一个博客子域。一些博主告诉我，您网站的博客子域有助于您的主网站的页面排名。您的博客子域的访问量是否有助于您网站的 Google PageRank 并计入您的主站点的访问量？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-06T15:34:05.203

我不认为谷歌对名为“博客”的子域给予任何特殊待遇。如果他们这样做了，那将是滥用的大门，而且他们足够聪明，能够意识到这一点。

有一次，我认为将您的博客放在单独的子域中是有好处的。如果您的博客具有不错的页面排名，则从您的博客到您的主站点的链接可以帮助您的主站点的页面排名。

然而，情况似乎发生了变化。这是一篇关于设置[博客子域与文件夹的有趣帖子。](http://www.searchenginejournal.com/subdomains-or-subfolders-which-are-better-for-seo/6849/) 看起来他们现在实际上被谷歌对待了，尽管除了谷歌之外没有人真正知道他们是如何对待他们的。

关于流量，你的谷歌排名只是偶然地与你的网站获得的流量有关。谷歌排名主要基于传入链接的内容、数量和质量，而不是你获得的流量。这是有道理的，因为除了他们通过谷歌搜索发送到那里的流量之外，谷歌真的无法知道你获得了多少流量到你的网站。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-10T20:39:38.117

**不是直接的，而是...**

我不知道“博客”是否以某种特殊方式特别有助于您网站的 pagerank - google 很好地保护了它的 pagerank 秘密。如果你真的想知道，你会创建两个网站，内容大致相同，但一个在域名中有博客，一个没有。索引它们并查看 pagerank 设置是否不同。我的直觉是——不。

众所周知，谷歌会为网站名称编制索引，如果网站名称与搜索词相对应，它会提高您在搜索结果中列出的机会。因此，可以合理地假设（除非谷歌专门删除了博客这个词的索引）当有人搜索主要搜索词和“博客”时，您的网站出现的机会会略高一些。

例如，它应该有助于搜索：drchrono blog。

顺便说一句，谷歌一直在改变它的算法，所以这只是猜测。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-12T18:43:19.973

根据 hubspot.com 上的一篇文章

> 搜索引擎越来越多地将子域视为主网站的一部分，因此您博客的 SEO 价值将添加到您的主网站域中。如果您希望您的博客被视为您公司的一部分，您应该以这种方式（或下一种方式）。

但是他们继续说 blog.domain.com 和 domain.com/blog 之间没有太大区别

您可以在此处阅读全文：[关于博客域的 hubspot 文章](http://blog.hubspot.com/blog/tabid/6307/bid/3994/Launching-A-Business-Blog-Avoid-This-Common-URL-Mistake-at-Blogspot-and-Typepad.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-11-12T12:05:56.453

使用子域会有所帮助的一件事是您的网站 Alexa 排名。

Alexa 为使用您的主域的所有页面提供排名。如果您使用 Alexa 工具栏，我会看到所有子域与您的主页具有相同的排名。因此，对您的订阅者的点击将计入您的网站 Alexa。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-13T17:24:22.433

我不认为子域对 pagerank 有任何影响，但是，它可能使内容比在文件夹中更容易找到。

假设您在 google 上搜索某些内容，从您的页面中，我可以搜索

```
domain:blog.drchrono.com someTopic or articleImLookingFor 
```

由于它是一个子域，我猜它算作主站点的流量。

就个人而言，如果我要建立一个博客，我会选择子域，并且可能会设置一个来自的重定向

[http://drchrono.com/blog](http://drchrono.com/blog)到 [http://blog.drchrono.com](http://blog.drchrono.com)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-15T09:26:41.887

blog.domain.tld 和 www.domain.tld 不被视为不相关的站点，假设它们由相同的最终 ns 权限处理。我从来不清楚页面是完全独立排名的，还是一个域的声誉，因此它的子域不仅仅是链接到它。

但是，如果我以不同的方式阅读您的问题，我会说两者都没有区别：

我已经尝试过设置页面，`photos.domain.tld/stuffAboutPhotos`并且一次设置`www.domain.tld/photos/stuffAboutPhotos`了一个月。我发现搜索引擎推荐率之间没有明显差异。

但实际上很难独立于其他因素来做到这一点。

因此，我得出结论，尽管人类逻辑表明域更重要，但将关键字放在域中与 url 的其余部分相比没有任何优势，除非确保它被明确分隔（使用斜线、破折号或网址其余部分中的下划线）。

如果谷歌有一个在域名中排名比在 URL 的其余部分中更好的关键词的候选名单，他们肯定*不会与没有戴谷歌校园阻尼爆炸项圈的任何人分享它。*

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-07T14:41:47.727

Google 将子域视为域。如果这不是真的，那么所有那些 blogspot 博客都会有更高的 SERPS。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-10-18T09:27:30.517

有了子域，谷歌“知道”它是一个“独立”的网站，这会更容易一些。使用子目录很棘手。但是，对于子域，它是相同的。在过去的一年里，谷歌会将这些排名在 PR0 和 PR3 之间，目前：PR1：[of-cour.se](http://of-cour.se)

干杯!

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-10T18:49:40.597

并不真地。博客确实为您的网站的 SEO 做了一些好事，但如果它们在网站内部，它的作用就不一样了。

一个更好的选择是拥有一个包含博客的完全独立的域（例如 drchronoblog.com），并且有很多从博客站点到主站点的链接。

这样搜索引擎会看到链接，但不会在博客和主站点之间建立联系，从而使您的页面排名更好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-12T09:40:48.543

它不会仅仅因为你有一个博客就给你的网站更高的优先级。子域。但是我相信如果他们搜索博客，会有更多的人找到您的网站..' 因此更多的流量'，更多的流量，更多的访问量通过搜索引擎等等..

所以我说是的:)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-07-08T15:47:48.393

由于 PageRank 正在处理搜索引擎上的排名。让我们做一个小测试：

[https://www.google.com/search?q=blog](https://www.google.com/search?q=blog)

你可能会看到

```
example.com/blog 
```

排名高于

```
blog.example.com 
```

对于任何领域，这几乎是相同的数字。

但是，如果可能的话，我会更加努力地获得`blog.wordpress.com`它，因为它在任何搜索引擎上都被视为我自己的个人资料，而不是一个名为`wordpress.com/blog`肯定仍属于`wordpress.com`.

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2009-03-13T16:01:42.820

就 SEO 而言，博客可以帮助您的唯一方法取决于您博客中的内容。仅仅拥有一个博客是不够的。

# vb6 - 为什么在 VB6 中使用 Shell 运行 .MSI 文件有时会失败？

> ID：619247
> 
> 赞同：0
> 
> 时间：2009-03-06T15:31:32.743
> 
> 标签：vb6, windows-installer

我正在尝试使用以下代码从 VB6 应用程序启动 .NET CF 安装程序（为简洁起见，我已将安装程序的完整路径替换为“（完整路径）”）：

```
Shell "C:\WINDOWS\system32\msiexec.exe /fa ""(full path)\NETCFSetupv35.msi""" 
```

到目前为止，我已经在四台机器上运行了它。在两个上它工作正常，在另外两个上它失败了。当它工作时，CF 安装程序就会运行。当它失败时，它做的第一件事就是弹出一个对话框，说：“您尝试使用的功能位于 CD ROM 或其他不可用的可移动磁盘上。” 该对话框提供了一个文本框来输入路径和一个浏览按钮来查找它，所以我提供了路径，单击打开按钮并收到此错误，“错误 1706。找不到产品 Microsoft .NET Compact Framework 的有效源3.5\. Windows Installer 无法继续。”

谁能告诉我这里出了什么问题？失败的机器缺少什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-07T08:11:19.907

您是否尝试在 vb6 失败的计算机上手动运行安装程序？

如果它确实有效，那么它可能不是安装程序问题。我的猜测是这是一个执行路径问题，当正确设置 PATH 变量时，shell 会找到正确的组件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T07:28:02.040

可能是 Compact Framework MSI 本身的问题？您可以尝试 Microsoft[支持](http://msdn.microsoft.com/en-gb/aa570318.aspx)（您有 MSDN 订阅吗？），或在[新闻组](http://groups.google.co.uk/group/microsoft.public.dotnet.framework.compactframework/topics?hl=en-GB%3Fie&lnk)上发帖。

或者尝试将日志记录参数添加到命令行“/l* LogFile.txt”（不包括引号），然后[尝试理解日志](http://support.microsoft.com/kb/299803)。

# java - Java实时服务监控框架

> ID：619253
> 
> 赞同：5
> 
> 时间：2009-03-06T15:32:59.510
> 
> 标签：java, performance, monitoring, jmx, snmp

必须为在线服务监控创建某种“计数器” - 即 Foo_Request_Total、Foo_Request_DB_error、Foo_Request_Timedout、Bar_Request_Total...

此外，当计数器超过预定义的限制时，必须生成某种警报（例如，如果每小时超过 5 个请求超时，则 SNMP 陷阱）。

你能为此推荐任何Java框架吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T15:44:32.853

Java 中的标准监控机制是[JMX](http://java.sun.com/javase/technologies/core/mntr-mgmt/javamanagement/)。

您可以远程监控服务，甚至可以执行命令。

您可以使用 JMX/SNMP 连接器将值映射到 MIB 并生成陷阱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-02T13:42:14.207

[http://perf4j.codehaus.org/index.html](http://perf4j.codehaus.org/index.html)或[https://github.com/earnstone/eperf](https://github.com/earnstone/eperf)怎么样？

# c# - 获取所有具有特定 fieldName 的 lucene 值

> ID：619260
> 
> 赞同：2
> 
> 时间：2009-03-06T15:34:54.170
> 
> 标签：c#, lucene

为了解决[这个](https://stackoverflow.com/questions/618227/faster-way-to-get-distinct-values-from-lucene-query)问题，我创建了一个新的 Lucene 索引，其中每个字段的所有可能的不同值都被单独索引。

所以它是一个包含几千个文档的索引，这些文档只有一个术语。
我想提取某个术语的所有值。例如，我想要所有具有字段名称“companyName”的值。
定义通配符查询当然不是解决方案。既不是枚举所有字段，也不是只保存具有正确字段名的字段。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T15:57:46.860

这应该有效（我认为它仍然在 C# 中）

```
IndexReader.Open(/* path to index */).Terms(new Term("companyName", String.Empty)); 
```

# c# - 压缩/解压缩音频数据

> ID：619266
> 
> 赞同：2
> 
> 时间：2009-03-06T15:36:03.840
> 
> 标签：c#, compression, waveform

我在 C# 应用程序中使用 win32 波形 api 来制作 voip 系统。一切都很顺利，但是我需要一些即时压缩音频数据的方法。

所以基本上音频数据进入一个 150 字节大小的“记录”缓冲区，然后这个缓冲区通过 udp 发送，在远程端，150 个字节被接收并放入一个“播放”缓冲区。

所以我需要一些在udp->发送之前和udp->recv之后压缩/解压缩数据的方法。普通压缩算法不适用于音频，包括 .NET GZip 类。

有谁知道我可以使用的图书馆可以帮助我做到这一点？

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T16:06:26.793

150 字节对于音频数据来说是一个令人难以置信的小缓冲区——对于例如 16 KHz 单声道来说不到 5 毫秒。我不是专家，但我认为无论您选择哪种压缩方案，使用如此小的缓冲区，您的压缩率都会受到很大影响。除此之外，您发送的每个数据包都会产生大量开销。

也就是说，如果您要发送语音数据，请查看[Speex](http://en.wikipedia.org/wiki/Speex)的有损压缩（我发现它在压缩语音方面非常有效，但音质对于音乐来说很糟糕。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T16:23:36.003

我认为您希望批量处理这些 150 字节的块以获得更好的压缩。
虽然，即使在像这样小的缓冲区大小下，您仍然可以获得*一些*压缩。

如果内置 GZipStream 不起作用，您可以尝试 DotNetZip 中包含的[GZipStream](http://dotnetzip.codeplex.com)。DotNetZip 中还有一个 ZlibCodec 类可用，它实现了 Codec 模式——这可能有助于压缩 150 字节块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T16:49:28.273

如上所述，我会研究 Speex。它得到了很好的支持，现在是 Flash Player 的事实标准。

我假设根据您设置缓冲区的大小，延迟是一个问题（缓冲区越大，延迟越大），所以不要选择具有高解压缩帧大小的编解码器，因为它会引入高延迟。这或多或少地排除了 MP3 ......对于 5khz 输出采样率的语音（它不会有太大的用途），最小解压缩帧大小为 576 个样本，或大约 100 毫秒必须在发送之前编码的数据. 这意味着在您考虑问题的网络部分之前，双向延迟超过 200 毫秒。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T15:52:40.133

您正在寻找的组件更广为人知的是编码器/解码器或[编解码器](http://en.wikipedia.org/wiki/Audio_codec)，在选择其中一个时有很多选择。

# apache-flex - Flex - 以编程方式清除 DateField

> ID：619268
> 
> 赞同：1
> 
> 时间：2009-03-06T15:36:26.773
> 
> 标签：apache-flex, actionscript-3, datefield

`DateField`在用户选择日期或`myDateField.selectedDate`通过代码设置后，我找不到任何以编程方式清除控件的方法。

文档仅说明如果用户再次选择日期，如何清除它。

但是做`myDateField.selectedDate = myDateField.selectedDate`是不行的

我已经尝试了所有明显的`myDateField.selectedDate = null`，, `myDateField.text = ""`- 但似乎没有任何效果。

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T19:35:47.837

我做了一个最小的测试示例：

```
<?xml 版本="1.0" 编码="utf-8"?>
<mx:应用程序 xmlns:mx="http://www.adobe.com/2006/mxml" layout="horizo​​ntal">
    <mx:脚本>
        <![CDATA[
        私有函数 clearDate():void {
            testField.selectedDate = null;
        }
        ]]>
    </mx:脚本>
    <mx:DateField id="testField"/>
    <mx:Button label="清除" click="clearDate();"/>
</mx:应用>

```

它似乎工作正常。您确定您的代码中没有一些令人费解的错误吗？

（顺便说一下，这里是 FB 3.2，以防是版本问题。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T13:06:47.497

它也适用于 FB2。

# iphone - viewDidAppear：在启动期间出现的模态视图控制器上调用两次

> ID：619269
> 
> 赞同：2
> 
> 时间：2009-03-06T15:36:53.790
> 
> 标签：iphone, cocoa-touch, uiviewcontroller, modalviewcontroller, app-startup

**解决方案：**在尝试在新项目中重新创建此错误以提交给 Apple 时，我发现它特定于 iPhone OS 2.1，并且为 2.2 编译修复了该问题。斯蒂芬，感谢您的帮助；我会接受你的回答，因为如果错误仍然存​​在或者我不愿意为 2.2 编译它会起作用。

* * *

我有一个应用程序从根本上改变了它的数据库模式，这种方式需要我将旧式记录转换为代码中的新式记录。由于用户可能会在此应用程序中存储大量数据，因此我尝试显示带有进度条的模态视图控制器，同时将数据移植过来（即，作为用户看到的第一件事）。这个视图控制器`viewDidAppear:`开始一个数据库事务，然后启动一个后台线程来进行实际的移植，偶尔`performSelectorInMainThread:withObject:waitUntilDone:`用来告诉前台线程更新进度条。

问题是，`viewDidAppear:`被调用了两次。我注意到这一点是因为“启动事务”步骤失败并显示“数据库繁忙”消息，但设置断点表明它确实被调用了两次——一次是`-[UIViewController viewDidMoveToWindow:shouldAppearOrDisappear:]`，一次是`-[UIViewController modalPresentTransitionDidComplete]`。这些名称似乎是私有 UIViewController 方法，所以我猜这要么是一个框架错误，要么我正在做一些 UIKit 不希望我做的事情。

两个相关的代码摘录（一些不相关的代码已经总结）：

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {
    (register some default settings in NSUserDefaults)

    // doing this early because trying to present a modal view controller 
    // before the view controller is visible seems to break it
    [window addSubview:[self.navigationController view]];

    // this is the method that may present the modal view
    [self.databaseController loadDatabaseWithViewController:self.navigationController];

    if(!self.databaseController.willUpgrade) {
        [self restoreNavigationControllerState];
    }
} 
```

从我的 DatabaseController 类：

```
- (void)loadDatabaseWithViewController:(UIViewController*)viewController {
    (open the new database)

    (compute the path the old database would live at if it existed)

    if([[NSFileManager defaultManager] fileExistsAtPath:oldDBPath]) {
        (open the old database)

        [viewController presentModalViewController:self animated:NO];
    }
} 
```

那么，我在这里搞砸了什么，还是应该向 Apple 提交错误报告？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T15:54:02.767

我也在我的应用程序中看到了这一点。我从未得到完全确认，但我认为这就是正在发生的事情：

1.  加载根视图
2.  加载模态视图
3.  操作系统发送视图确实出现了步骤 1 中视图的通知
4.  当前视图控制器（在*本*例中恰好是您的 DatabaseController 类）将其拾取
5.  操作系统发送视图确实出现了模态视图的通知
6.  当前视图控制器收到通知。在这种情况下，它与上次完全相同的控制器

就我而言，我只是重置了第一次调用`viewDidAppear:`.

在您的情况下，您会想到两个选项：一个静态变量，用于跟踪您是否已经开始升级；或者`UIView*`在启动前查看传入的参数。

# c++ - 面向 Delphi 开发人员的 Qt

> ID：619272
> 
> 赞同：10
> 
> 时间：2009-03-06T15:37:14.337
> 
> 标签：c++, delphi, qt

有人知道为 Delphi / C++ Builder / VCL 开发人员解释 Qt 的书或教程吗？

对于具有这种背景的开发人员来说，学习 Qt 的最佳方法是什么？我对如何使用 Qt 完成我知道如何在 Delphi 中完成的事情特别感兴趣。

例如，什么是 Qt 等价于 Delphi Frames？那么表单/框架继承呢？我应该使用 Qt Designer、Qt Creator 还是手动代码来完成这些任务？

另一件事是 Qt 小部件和对象的生命周期。Qt 是否会处理小部件和对象的破坏，还是应该由程序员手动完成？或者可能是 Qt 对某些类型的对象而不是其他类型的对象？

作为旁注，我确实知道 C++，所以语言本身不是问题。我关心图书馆。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T16:08:14.713

一种方法可能是研究[FreeCLX 开源项目](http://freeclx.sourceforge.net/)的源代码。它包含使用 Qt 的 VCL 实现。因此，如果您对哪个 Qt 小部件映射到 VCL 类型感到好奇，那应该会让您上路。但是请注意，Qt 2.xx 使用了多重继承（在当前的 Qt 中不再适用），因此 FreeCLX 通过一个特殊的库与 Qt 接口以将其展平。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T19:17:43.200

如果我没记错的话，Qt Assistant 有一些很好的初学者教程，它们将引导您了解日益复杂的 Qt GUI 应用程序的基本结构。您还将了解父/子层次结构、信号/槽事件系统，这两者都是理解 Qt 应用程序的关键。

我和其他人一起说不要尝试将 Delphi 隐喻映射到 Qt 隐喻。但是，您可能会在您的 Delphi 经验为您提供视角的过程中发现许多相似之处。

祝你好运！

编辑：在我看来， [QtCentre](http://www.qtcentre.org)是 Qt 开发的最佳在线论坛。在那里你会发现很多知识渊博的人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T15:49:26.460

学习新东西最简单、最快的方法就是把所有旧东西放在一边。用 C++ 开发时，不要试图用 Delphi 去思考。

首先学习一些 C++（真的不难），然后选择 Qt。您不必了解所有 C++ 和 STL 即可快速使用 Qt，只需熟悉语法和基本概念（如指针、结构与类等）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-06T16:07:37.570

为了进一步说明 Javier 所说的 - 从一个窗口工具包到另一个地图的概念甚至不如语言。这尤其令人困惑，因为只有这么多的词（框架、窗口、小部件等）可以重复使用。

我会仔细阅读 QT 发行版中包含的（优秀的）示例和教程（您可能必须下载源 dist），然后思考 - 我将如何在 VCL 中做到这一点？

# asp.net - 连接字符串最佳实践

> ID：619276
> 
> 赞同：16
> 
> 时间：2009-03-06T15:38:25.223
> 
> 标签：asp.net, sql, connection-string

从安全的角度来看，在 Web 应用程序中管理连接字符串的最佳方法是什么？我已经用几种不同的方式做到了。我已将它们存储为纯文本 web.config 设置键。我还创建了一个“常量”类，它为每个连接字符串提供了公共只读字符串属性。

是否有人对以我不会担心它们被恶意发现的方式管理连接字符串有任何建议？我绝对愿意接受加密。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T15:44:18.050

您可以在 web.config 文件中[加密连接字符串](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)。

将连接字符串作为属性或常量存储在类中是不安全的。任何使用反汇编程序的人都可以看到您的连接字符串。

最好的方法是配置加密。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T15:46:27.467

您可以使用命令行工具 aspnet_regiis 加密和解密 web.config 的部分：

加密：aspnet_regiis -pef "connectionStrings" "c:\folder\"

解密：aspnet_regiis -pdf "connectionStrings" "c:\folder\"

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T15:57:10.653

如果您可以完全控制服务器，您还可以将连接字符串存储在 Machine.Config 中。如果您有很多应用程序都与同一个数据库服务器一起工作，这会很方便。

我不确定它是否值得加密，因为您必须首先访问服务器才能查看 machine.config。如果您的服务器遭到入侵，Encyrption 不会阻止黑客从配置文件中提取凭据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T15:52:19.933

@vartec：这不是一个 SNAFU ..

如果您使用不会破坏任何 UTF8 或 Unicode 编码的标准 .NET 加密机制对其进行加密，IIS 确实可以读取加密文本。Microsoft 也鼓励将此作为最佳实践。

您可以从中看到有关加密连接字符串的示例：

“如何：使用数据源控件时保护连接字符串”

[http://msdn.microsoft.com/en-us/library/dx0f3cf2.aspx](http://msdn.microsoft.com/en-us/library/dx0f3cf2.aspx)

# c# - .net 日历 - 使整个单元格执行回发（可点击）

> ID：619277
> 
> 赞同：3
> 
> 时间：2009-03-06T15:39:28.527
> 
> 标签：c#, .net, calendar, postback

我已经启动并运行了一个 .net 日历，并从数据库中获取信息。默认情况下，天数应用了回发操作。

我想要做的是让该操作适用于整个单元格，这样用户就不需要只点击文本链接。

我是 dayRenderer 操作，我有以下行来尝试复制操作，但第二个参数我不确定如何设置它。

它似乎给了它一个 id，例如 3315，但我不确定如何为下面的代码手动获取所需的 id。我希望这是有道理的！我是 .NET 的新手，所以不太了解我的术语！

```
e.Cell.Attributes.Add("OnClick", 
    string.Format("javascript:__doPostBack('{0}','{1}')", 
    Calendar1.ClientID, ***ID_NEEDED_HERE***)); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T21:19:23.720

推杆

e.Cell.Attributes.Add("OnClick",e.SelectUrl);

在你的 dayRenderer 中会模拟数字点击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T23:19:42.857

该参数是自 2000 年 1 月 1 日以来日历第一天的天数，前面带有“V”。

因此，“V0”的 ID 表示 2000 年 1 月 1 日，“V5”的 ID 表示 2000 年 1 月 6 日，“V-5”的 ID 表示 1999 年 12 月 27 日。

干杯，

鲁本

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-25T19:48:01.407

*这是我试图弄清楚大约一天后的答案。在 DayRender 事件中，您必须粘贴此代码或创建一个 Sub() 并从那里调用它*

Private AdditionaleText Sub(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.DayRenderEventArgs)

暗淡文本为字符串 = “MyText”

e.Cell.Text = "< ref=" & e.SelectUrl & "" style=""color:#663399 font-size: X-small"">""

'这里还可以自定义文本的样式

e.Cell.Text += text & "
" & e.Day.DayNumberText e.Cell.Attributes.Add("OnClick",e.SelectUrl);

结束子

*您只能使用最后一句话，但不会将文本显示为可点击的，但它可以工作 孔代码看起来要好得多 e.SelectUrl 为您提供相同的引用，您可以检索调用*

"javascript:__doPostBack('ctl00$ctl00$MainContent$ContentPlaceHolder1$CalendarSailingDay$Calendar','" & ID & " style=""color:#663399"" >

*....这实际上非常令人困惑。祝你好运！！！*

# asp.net-mvc - 将 ASP.NET 默认模型绑定器与 DateTime 一起使用

> ID：619290
> 
> 赞同：1
> 
> 时间：2009-03-06T15:42:46.977
> 
> 标签：asp.net-mvc

我一直在尝试使用默认的 ASP.NET MVC 模型绑定器，但在绑定 DateTime 时遇到了问题。[我在这里](http://www.hanselman.com/blog/SplittingDateTimeUnitTestingASPNETMVCCustomModelBinders.aspx)看过 Scott 的帖子，但它似乎太复杂了。有没有更简单的绑定 DateTime 的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T03:53:25.580

如果你不喜欢 Hanselman 的解决方案，你可以试试 Castle 的活页夹。它们像[这样](http://www.castleproject.org/monorail/documentation/trunk/usersguide/smartcontroller.html#date)工作，可以[通过 MvcContrib 使用](http://blogger.forgottenskies.com/?p=258)。

# c# - .NET Linq 加入

> ID：619292
> 
> 赞同：4
> 
> 时间：2009-03-06T15:43:22.620
> 
> 标签：c#, .net, linq, join

我在 SQL 中有 2 个表。

```
Table 1 
Step Id
Step Name

Table 2
Profile Id
Step Id
Completed 
```

即使表 2 中没有匹配项，我也想返回以下结果：

```
Results
Table1.Step Id
Table1.Step Name
Table2.Profile Id
Table2.Completed 
```

我在 SQL 中执行此操作的方式如下：

```
select * from [Table 1] t1
left join [Table 2] t2
on t1.Step Id = t2.Step Id 
```

这产生了我期望的结果。

当我将其翻译成 linq 时：

```
public static List<UserCompletion> GetStepCompletion(string category, string profileid) { 

List<Step> step = GetSteps(category);
List<UserStep> userStep = GetUserSteps(category, profileId);    

var q = from s in step
         join us in userStep
         on s.Id equals us.StepId
         select new UserCompletion
         {
           StepId = s.Id,
           Headline = s.StepName,
           ProfileId = us.ProfileId
           Completed= us.Completed
          };

     return q.ToList();

} 
```

它可以工作，但就像 JOIN 而不是左连接。我只得到匹配的结果。

此外，UserCompletion 是我从此方法返回的对象。

几天来我一直在努力解决这个问题......任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T18:28:04.177

你也可以试试这个（假设 us.Completed 是布尔值）：

```
var q = from s in step
         let us = (from i in userStep where s.Id = i.StepId).SingleOrDefault()
         select new UserCompletion
         {
           StepId = s.Id,
           Headline = s.StepName,
           ProfileId = us.ProfileId
           Completed = us == null ? false : us.Completed
          }; 
```

这不会变成 sql 中的连接，而是像这样的嵌套 select 语句：

```
select 
    StepId, Headline, ProfileId,
    isnull((select top(1) Completed from userStep where StepId = Id), 0) as Completed
from step 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T16:01:45.183

尝试以下方法：

```
var q = from s in step
        join us in userStep 
        on s.Id equals us.StepId into tmpjoin
        from x in tmpjoin.DefaultIfEmpty()
        select new UserCompletion { ... } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T18:54:01.227

找到了。

似乎我需要对“可能”为空的项目添加评估。

我将以下内容添加到我的选择中

```
Completed = (x == null) ? String.Empty : x.Completed 
```

# sql-server - 如何从 Visual Basic 6 运行 SSIS 包？

> ID：619299
> 
> 赞同：0
> 
> 时间：2009-03-06T15:44:58.873
> 
> 标签：sql-server, vb6, ssis

谁能提供一些关于如何从 Visual Basic 6 在 SQL Server 2005 实例上运行集成服务包的信息？

任何帮助都非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-02T11:48:36.953

您需要`xp_cmdshell`启用，如果没有，`sp_configure 'xp_cmdshell', '1'`请在服务器上的 SSMS 中执行：

创建一个存储过程，并将以下代码放入其中：

```
DECLARE @SSISPackage VARCHAR(1000)
DECLARE @cmd VARCHAR(max)
DECLARE @variable_value1 varchar(255)
DECLARE @Result int

SET @SSISPackage = 'C:\path_to_the_package\package_name.dtsx'
SET @cmd = 'dtexec /F "' + @SSISPackage + '"'   
// if you have variables in the package that need to be set up
// add them here
SET @cmd = @cmd + ' /SET \Package.Variables[User::somevariable1].Properties[Value];"' + @variable_value1 + '"'
SET @cmd = @cmd + ' /SET \Package.Variables[User::somevariable2].Properties[Value];"' + @variable_value2 + '"'
SET @cmd = @cmd + ' /SET \Package.Variables[User::somevariable3].Properties[Value];"' + @variable_value3 + '"'

EXECUTE @Result = master..xp_cmdshell @cmd, NO_OUTPUT 
```

然后，通过 ADODB.Command 从 VB6 调用存储过程。

你在这里有例子：

*   **SSIS**：[http ://www.mssqltips.com/tip.asp?tip=1395](http://www.mssqltips.com/tip.asp?tip=1395)
*   **ADODB.Command**： http: [//www.codeproject.com/KB/vbscript/simple_sp_vb6.aspx](http://www.codeproject.com/KB/vbscript/simple_sp_vb6.aspx)

我希望它有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-01-10T01:31:33.960

根据 Dan S 的回答，对我有用的是：

创建一个调用包的存储过程：

1.  右键单击您的 SSIS 包并选择“执行”。
2.  在“执行包”窗口中单击“脚本”按钮。
3.  添加到生成脚本的顶部：

    ```
    CREATE PROCEDURE sp_NewProcedureName
    AS
    BEGIN 
    ```

4.  并添加到生成脚本的底部：

    ```
    END
    GO 
    ```

5.  执行此脚本以创建存储过程。

然后使用代码调用存储过程

6.  这段代码对我有用：

    ```
    Set adodbConn = New ADODB.Connection
    adodbConn.Open "Provider=sqloledb; Data Source=yourSQLServer; Initial Catalog=yourDB; Integrated Security=SSPI;"
    Set adodbCMD = New ADODB.Command
    With adodbCMD
        .ActiveConnection = adodbConn
        .CommandText = "dbo.sp_NewProcedureName"
        .CommandType = adCmdStoredProc
        .CommandTimeout = 0
        .Execute
    End With
    Set adodbCMD = Nothing
    adodbConn.Close
    Set adodbConn = Nothing 
    ```

我需要在我的 VBA 代码中添加对“Microsoft ActiveX 数据对象 2.5 库”的引用。

我知道这是对一个老问题的回答，但希望我的回答将所有内容集中在一个地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T16:37:37.750

可能最简单的方法是掏空并[运行 dtexec](http://msdn.microsoft.com/en-us/library/ms162810.aspx)

或者，您可以在 .NET[中使用 using Microsoft.SqlServer.Dts 程序集](http://blogs.msdn.com/michen/archive/2007/03/22/running-ssis-package-programmatically.aspx)并将其包装在 COM（或 EXE）中，然后从 VB6 中调用它。

第二个链接有一些其他选项，它们可能以某种方式适用于 VB6，但可能都会导致将 .NET 代码包装在 COM 对象或 EXE 中。

# c# - 如何从页面上的控件访问页面上的 GridView？

> ID：619303
> 
> 赞同：0
> 
> 时间：2009-03-06T15:45:49.963
> 
> 标签：c#, asp.net

我有一个 aspx 页面，它有一个 GridView 和一个带有摘要数据的面板。摘要数据位于控件中，而 GridView 位于 aspx 页面上。当有人单击摘要数据中的项目时，我想重新绑定 GridView，但我无法从控件中弄清楚如何做到这一点。

我尝试使用 FindControl，但可能没有正确使用它。

我用 FindControl 试过了，但没有用：

```
GridView gv = (GridView)FindControl("gvSearchResults"); //returns null 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T15:49:59.300

您应该将控件的 GridView 引用作为控件的属性发送（

```
public GridView GridViewToRebind {get; set;} 
```

或者其他的东西）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T16:11:29.590

您的摘要数据属于哪种控制方式？也许您可以将 EventHandler 添加到您单击项目时触发的摘要数据控件。您将在 .aspx 代码隐藏中编写事件处理程序，然后在 .aspx 的 Page_Load() 中将它们链接起来。

这是一个简单的例子：

默认.aspx：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="GridViewEventHandling._Default" %>
<%@ Register TagName="MyControl" TagPrefix="mc" Src="~/SampleData.ascx" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>

        <asp:GridView ID="uxGridView" runat="server" AutoGenerateColumns="true">
        </asp:GridView>

        <mc:MyControl ID="myControl" runat="server" />

    </div>
    </form>
</body>
</html> 
```

默认.aspx.cs：

```
using System;
using System.Collections.Generic;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace GridViewEventHandling
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            myControl.OnLinkClick += new EventHandler(myControl_OnLinkClick);
        }

        private void myControl_OnLinkClick(object sender, EventArgs e)
        {
            uxGridView.DataSource = GetDataSource();
            uxGridView.DataBind();
        }

        private IDictionary<string, string> GetDataSource()
        {
            IDictionary<string, string> dict = new Dictionary<string, string>();
            dict.Add("Product 1", "Description 1");
            dict.Add("Product 2", "Description 2");
            dict.Add("Product 3", "Description 3");
            return dict;
        }

    }
} 
```

样本数据.ascx：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="SampleData.ascx.cs" Inherits="GridViewEventHandling.SampleData" %>

<asp:LinkButton ID="item1" OnClick="HandleClick" CommandName="BindGrid" CommandArgument="1" Text="Item 1" runat="server" /><br />
<asp:LinkButton ID="item2" OnClick="HandleClick" CommandName="BindGrid" CommandArgument="2" Text="Item 2" runat="server" /><br />
<asp:LinkButton ID="item3" OnClick="HandleClick" CommandName="BindGrid" CommandArgument="3" Text="Item 3" runat="server" /><br /> 
```

SampleData.ascx.cs：

```
using System;

namespace GridViewEventHandling
{
    public partial class SampleData : System.Web.UI.UserControl
    {
        public event EventHandler OnLinkClick;

        protected void HandleClick(object sender, EventArgs args)
        {
            if (OnLinkClick != null)
                OnLinkClick(sender, args);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T15:58:04.567

**FindControl**被容器用来查找它包含的子控件，如果使用Page对象查找gridview，应该可以找到。你如何使用你的**FindControl**方法？你能发布一些简单的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T16:00:13.487

如果您的所有控件都在同一页面上，那么您应该看到 GridView（在智能感知中，来自它调用的事件），并且不必使用 FindControl。如果您的摘要数据位于单独的 UserControl 中，请按照以下步骤操作：

从 UserControl，您的摘要数据在哪里，参考父页面（假设它是 SomePage.aspx）：
SomePage parent=(SomePage)this.Page;
在 SomePage.aspx 代码隐藏中，放置一种重新绑定的方法：
public void Rebind() { gridview1.Bind();
然后您可以从您的用户控件调用该 Rebind 方法： parent.Rebind()您
还可以向其添加一些参数或其他一些 UI/biz 逻辑！

# asp.net - 加速您的 IIS

> ID：619318
> 
> 赞同：14
> 
> 时间：2009-03-06T15:50:41.323
> 
> 标签：asp.net, iis, performance

有没有办法通过更改一些配置参数来提高 IIS 的性能？

或者您对如何提高 ASP.NET 应用程序的性能有任何一般性的提示？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-06T15:53:49.023

*   请记住在 web.config 中关闭“调试”
*   不要使用通配符文件映射。
*   使用 httpCompression 提高感知性能
*   节流带宽以提高整体感知性能
*   尝试将 IIS7 用于 .net 应用程序

[http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/71490aae-f444-443c-8b2a-520c2961408e.mspx?mfr=true](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/71490aae-f444-443c-8b2a-520c2961408e.mspx?mfr=true)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-06T15:53:39.633

您的第一个停靠港应该在这里：-

[http://developer.yahoo.com/performance/rules.html](http://developer.yahoo.com/performance/rules.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-06T15:55:13.077

你看过缓存吗？或微缓存看看[http://www.dnrtv.com/default.aspx?showNum=85](http://www.dnrtv.com/default.aspx?showNum=85)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-01-14T21:51:05.033

另一方面，您可以尝试使用[IIS Tuner](http://iistuner.codeplex.com)开源工具进行优化

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-06T18:25:18.113

如果您有权访问 IIS 服务器，则可以使用它修改几项内容，包括：

[HTTP 压缩](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/d52ff289-94d3-4085-bc4e-24eb4f312e0e.mspx?mfr=true)- 非常适合 JS 和 CSS 文件等静态内容。

[禁用日志记录（与安全团队交谈）](http://www.iishacks.com/index.php/2007/09/22/performance-tips-disable-logging-on-windows-server-iis/)

[性能提示](http://msmvps.com/blogs/bernard/archive/2006/01/07/80510.aspx)

[调整 IIS](http://technet.microsoft.com/en-us/magazine/2005.05.resources.aspx)

[调整 IIS 2](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/71490aae-f444-443c-8b2a-520c2961408e.mspx?mfr=true)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-06T15:56:05.307

预编译您的 ASP.NET 应用程序使其更快。发布版本是一个加号。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-01-30T10:28:22.987

一些通用的建议：

*   启用 gzip 压缩
*   仔细检查您的图像并使用编辑软件优化图像，例如：在 Photoshop 中保存为网络
*   把你的 js 文件放在你的身体结束标签之前
*   把你的CSS放在头上
*   使用 asp.net 中的捆绑包或手动将您的 js 文件合并到一个文件中
*   将您的 CSS 与捆绑包或手动合并
*   使所有小的 CSS 和 js 内联而不是链接文件
*   重要：确保正确设置缓存设置
*   如果可能，请使用 cdn，例如：从 cdn 加载 jQuery，从 Google cdn 加载 Google 字体。
*   使用在线工具最小化您的 js、CSS html，无需注释、空格、换行...
*   对图标使用字体而不是图像
*   将小图像（图标...）合并为一张图像并使用 CSS 精神
*   最后用 Google pagespeed 和 yahoo YSlow 检查你的在线网站

祝你好运

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-06T17:03:50.183

简而言之，是的，有很多方法可以通过 iis 设置提高应用程序的性能。但是，您的特定应用程序将需要自己的调整。

一般提示在其他帖子中。但是，您的应用程序也会有一些特定的事情可以调整。例如，如果您有一个或两个目录，与站点的其余部分相比，它们有很多活动，您可以将它们放在单独的应用程序池中。

这是一种艺术形式，如果您在这里遵循一般建议后仍然遇到性能问题，我建议您找一个顾问来为您调整一周。最好也可以查看您的 ASP。

如果您有特定的阻塞点，您可以做的另一件事是在 SO 上发布查询。到目前为止，您只能接受一般性建议。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-01-09T22:34:13.920

查看[http://iistuner.codeplex.com/](http://iistuner.codeplex.com/)它解决了我们在很多地方设置配置值的所有问题。它基本上一键修复了所有奇怪且难以找到的设置。

# windows - 使用 Visual Studio Installer 自动创建新用户并静默用于 Windows 服务安装

> ID：619321
> 
> 赞同：1
> 
> 时间：2009-03-06T15:51:04.973
> 
> 标签：windows, visual-studio-2008, windows-installer

我有一个使用 Visual Studio (2008) 安装程序安装的 Windows 服务。我想避免以系统身份运行，所以我一直在手动 1）在计算机上创建一个新的 Windows 帐户，2）在安装过程中输入计算机名\用户名和密码。

我希望这需要很少的用户干预，所以我有兴趣创建一个新的 Windows 用户并自动提供计算机名称、用户名和密码。

我将如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T15:22:16.830

[取自本网站](http://windowsitpro.com/article/articleid/15064/how-can-i-add-a-user-from-the-command-line.html)

> 简单的答案是使用网络用户 /add (/domain) ，但是不仅可以自动添加用户，还可以自动添加他/她到组和创建模板用户帐户目录结构。许多组织都有一个基本结构，包括 word、excel 目录和一些模板文件。这可以通过基本脚本自动化。例如

```
REM addnew.bat

net user %1 password /add /homedir:\\<server>\users\%1 /scriptpath:login.bat /domain
net localgroup "<local group>" %1 /add

REM repeat for local groups
net group "<groups>" %1 /add /domain

REM repeat for global groups
xcopy \\<server>\users\template \\<server>\users\%1 /e
nltest /sync /server:BDCname

REM repeat for all BDCs you might be authenticating to
sleep 20
cacls \\<server>\users\%1 /e /r Everyone

REM remove the everyone permission to the directory
cacls \\<server>\users\%1 /g %1:F /e
cacls \\<server>\users\%1 /g Administrators:F /e 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T16:59:55.853

在您的 MSI 中创建自定义操作以运行“sc.exe”命令（安装在 WinXP 和更新的系统上）。如果您担心 sc.exe 可能不在系统上，请将其包含在您的 MSI、二进制表中或随产品一起安装。

在您的 MSI 创建服务后，让自定义操作运行以下命令（为您自己的用户/通行证进行修改）：

> sc config **the_service_name** obj= thedomain **\johndoe**密码= **stackoverflow**

但是，请注意，将密码直接以明文形式存储在 MSI 中是一个非常糟糕的主意。

一个简单（也是基本）的解决方案是使用[免费工具 CPAU](http://www.joeware.net/freetools/tools/cpau/index.htm)来加密上面的整个 sc 命令。您将从您自己的系统加密此命令（使用 CPAU），然后将此编码字符串传递给 CPAU（您需要将其包含在您的 MSI 中，或安装在系统上 --- 在您的自定义操作中）。CPAU会解码你传入的字符串，解码成上面的sc命令，会更安全的设置服务上的用户名和密码。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-03-06T16:26:00.087

我认为这会危及用户的安全，如果允许服务应用程序这样做，这也是一种不好的做法。它还会破坏当前的安全凭证。

据我所知，任何类型的 Windows 服务都在运行一个应该是后台任务的任务，并且它总是在后台运行。它总是以这种意图创建的：运行后台任务并且它总是在运行，因此需要用户许可（即用户必须注意）的任何类型的危险操作，例如创建新用户。

如果我没记错的话，那么无论如何，您的服务应用程序将始终在没有任何通知的情况下创建新用户，因为 Windows 服务始终在后台运行并且没有任何 UI。因此，在应用程序可维护性方面，也不建议这样做。更不用说调试 Windows 服务对我们许多人来说是相当困难的。

# javascript - decodeURIComponent vs unescape，unescape有什么问题？

> ID：619323
> 
> 赞同：53
> 
> 时间：2009-03-06T15:51:50.433
> 
> 标签：javascript, encoding, escaping, dhtml

在回答另一个问题时，我意识到我的 Javascript/DOM 知识已经有点过时了，因为我仍在使用`escape`/`unescape`来编码 URL 组件的内容，而现在看来我应该使用`encodeURIComponent`/`decodeURIComponent`代替。

我想知道`escape`/有什么问题`unescape`？有一些模糊的建议表明 Unicode 字符存在某种问题，但我找不到任何明确的解释。

我的网络体验相当偏颇，几乎所有的人都在编写与 Internet Explorer 相关的大型 Intranet 应用程序。这涉及到大量使用`escape`/`unescape`并且所涉及的应用程序多年来一直完全支持 Unicode。

那么`escape`/`unescape`应该有哪些 Unicode 问题呢？有没有人有任何测试用例来证明这些问题？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-03-06T16:24:33.630

> 我想知道 escape/unescape 有什么问题？

它们本身并没有“错误”，它们只是它们自己的特殊字符串格式，看起来有点像 URI-parameter-encoding 但实际上并非如此。尤其是：

*   '+' 表示加号，而不是空格
*   有一种特殊的“%uNNNN”格式用于编码 Unicode UTF-16 代码点，而不是编码 UTF-8 字节

因此，如果您使用 escape() 创建 URI 参数值，对于包含加号或任何非 ASCII 字符的字符串，您将得到错误的结果。

escape() 可以用作内部纯 JavaScript 编码方案，例如转义 cookie 值。然而，既然所有浏览器都支持 encodeURIComponent （最初并非如此），没有理由优先使用转义。

我所知道的转义/取消转义只有一种现代用途，这是一种通过在 URIComponent 处理中利用 UTF-8 处理来实现 UTF-8 编码器/解码器的快速方法：

```
utf8bytes= unescape(encodeURIComponent(unicodecharacters));
unicodecharacters= decodeURIComponent(escape(utf8bytes)); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-07T20:36:37.620

`escape`仅对 0 到 255 范围内的字符（包括 ISO-8859-1，它是可用单个字节表示的有效 unicode 代码点）进行操作。(*)

`encodeURIComponent`适用于 javascript 可以表示的所有字符串（这是 unicode 基本多语言平面的整个范围，即 unicode 代码点 0 到 1,114,111 或 0x10FFFF，几乎涵盖了当前使用的任何人类书写系统）。

这两个函数都生成仅使用代码点 0 到 127（包括 US-ASCII）的 url 安全字符串，后者通过首先将字符串编码为 UTF-8，然后将`%XX`熟悉的十六进制编码从`escape`, 应用于任何不会网址安全。

这就是为什么您可以在 javascript 中[制作一个双功能的 UTF-8 编码器/解码器](http://ecmanaut.blogspot.com/2006/07/encoding-decoding-utf8-in-javascript.html)而无需任何循环或垃圾生成的原因，通过组合这些原语来消除除 UTF-8 处理之外的所有副作用，就像`unescape`和`decodeURIComponent`版本一样反过来也一样。

(*) 脚注：一些现代浏览器（如 Google Chrome）已经过调整，以生成 %uXXXX 用于最初未定义的上述 255 个字符范围的转义，但 Web 服务器对解码该编码的支持并不像解码基于 IETF 标准化的 UTF-8 编码。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-11-16T01:00:16.580

最好的答案是它在这个网站上在线工作[http://meyerweb.com/eric/tools/dencoder/](http://meyerweb.com/eric/tools/dencoder/)

```
function decode() {
    var obj = document.getElementById('dencoder');
    var encoded = obj.value;
    obj.value = decodeURIComponent(encoded.replace(/\+/g,  " "));
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-10-11T12:52:54.260

我遇到的另一个“现代”用途是解析可能包含无效 UTF8 字节序列的 URI 编码字符串。在某些情况下，decodeURIComponent 可能会引发异常。您可能需要捕获此异常并回退到使用 unescape。

一个例子是 'tür' 编码为 't%FCr' 我见过 Firefox 产生的（当字符被粘贴到地址栏之后？）。

# algorithm - 一种生成半正定矩阵的简单算法

> ID：619335
> 
> 赞同：39
> 
> 时间：2009-03-06T15:54:10.770
> 
> 标签：algorithm, math, matrix

我想生成正随机半定矩阵。我正在寻找一种算法，或者最好是用 C、matlab、java 或任何语言实现该算法的简单实现。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-03-06T16:19:16.607

1.  生成随机矩阵
2.  乘以它自己的转置
3.  你得到了一个半正定矩阵。

示例代码（Python）：

```
import numpy as np
matrixSize = 10 
A = np.random.rand(matrixSize, matrixSize)
B = np.dot(A, A.transpose())
print 'random positive semi-define matrix for today is', B 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-06T17:58:31.330

你需要清楚你对“随机”的定义。你对结果矩阵有什么限制？您希望系数均匀分布还是正态分布？您是否希望特征值具有特定分布？（ETC。）

有多种方法可以生成半正定矩阵 M，包括：

1.  给定任意矩阵 A，计算 M = A ^T A（构造[Cholesky 分解](http://en.wikipedia.org/wiki/Cholesky_decomposition)）
2.  给定具有非负对角元素的任意对角矩阵 S 和相同大小的正交矩阵 Q，计算 M = QSQ ^T（构造[奇异值分解](http://en.wikipedia.org/wiki/Singular_value_decomposition)）

出于数字原因，我可能会选择第二种方法，通过生成具有所需属性的对角矩阵，然后生成 Q 作为多个[Householder 反射](http://en.wikipedia.org/wiki/Householder_transformation)的组合（生成随机向量 v，缩放到单位长度，H = I - 2vv ^T ); 我怀疑你想使用 K * N 其中 N 是矩阵 M 的大小，而 K 是 1.5-3 之间的一个数字（我猜这个），以确保它具有足够的自由度。

[您还可以使用Givens 旋转](http://en.wikipedia.org/wiki/Givens_rotation)生成一个正交矩阵 Q ：从 1 到 N 中选择 2 个不同的值，并围绕该对轴生成一个 Givens 旋转，角度从 0 到 2 * pi 均匀分布。然后取其中的 K * N 个（与上段相同的推理），它们的组合产生 Q。

编辑：我*猜*（不确定）如果您有独立生成且正态分布的系数，那么整个矩阵将是“正态分布”（无论这意味着什么）。至少对于向量来说是这样。（N 个独立生成的高斯随机变量，每个分量一个，为您提供一个高斯随机向量）对于均匀分布的分量，情况并非如此。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-06T16:22:39.767

如果您可以用您选择的语言生成一个随机矩阵，那么通过使用矩阵乘以其转置为半正定的性质，您可以生成一个随机半正定矩阵

在 Matlab 中，它就像

```
% Generate a random 3x3 matrix
    A = rand(3,3) 
% Multiply by its tranpose
    PosSemDef = A'*A 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-07-02T10:52:17.987

半正定矩阵上的自然分布是[Wishart 分布](https://en.wikipedia.org/wiki/Wishart_distribution)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-09-21T14:49:15.290

A'*A 将给出一个正半定矩阵当且仅当 A 秩亏时。因此，上述答案以及从维基百科复制的答案通常并不正确。要计算一个半正定矩阵，只需将任何矩形 m × n 矩阵 (m < n) 乘以它的转置。即如果 B 是一个 m × n 矩阵，其中 m < n，那么 B'*B 是一个半定矩阵。我希望这有帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-09-22T16:15:28.727

澄清一点（我希望）。令 A 为随机矩阵（例如，由随机正态变量填充），mxn 且 m >= n。那么如果 A 是满列秩，A'A 将是正定的。如果 A 的秩 < n 则 A'A 将是半正定的（但不是正定的）。

m >= n 的随机正态矩阵几乎肯定是满秩的；要生成秩亏矩阵，可以附加一列或多列，这些列是其他列的线性组合。

# xml - 测试是否存在 xelement

> ID：619350
> 
> 赞同：1
> 
> 时间：2009-03-06T15:57:42.947
> 
> 标签：xml, vb.net, linq-to-xml

我正在阅读一个如下所示的 XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<VehicleList>
 <Vehicle>
  <Item>
   <Name>F-150</Name>
   <Maker>Ford</Maker>
   <Color>Black</Color>
   <Price>30000</Price>
  </Item>
  <ItemSpecific>
   <NameValueList>
    <Name>Mileage</Name>
    <Value>56000</Value>
   </NameValueList>
   <NameValueList>
    <Name>Year</Name>
    <Value>2003</Value>
   </NameValueList>
  </ItemSpecific>
 </Vehicle>
 <!-- more Vehicle nodes here -->
</Vehicles> 
```

这是从 eBay Web 服务返回的示例数据，所以不要在结构上折磨我。

无论如何，我正在使用这样的代码来读取 xml 并将所有车辆放在 List(of Vehicle) 对象中，如下所示：

```
 Dim vehicles = From v in doc...<Vehicle> _
   Let mile = (From x In v.<ItemSpecific>.<NameValueList> Where x.<Name>.Value = "Mileage" Select x.<Value>.Value).Single _
                   Let year = (From z In v.<ItemSpecific>.<NameValueList> Where z.<Name>.Value = "Year" Select z.<Value>.Value).Single _
                   Select New Vehicle With {.Name = v.<Item>.<Name>.Value, .Maker = v.<Item>.<Maker>.Value, .Color = v.<Item>.<Color>.Value, .Mileage = mile, .Year = year} 
```

然后将结果绑定到呈现数据`List(Of Vehicle)`的 ASP.NET控件。*如果*所有需要的节点都存在，`ListView`一切顺利。例如，里程节点是有条件的，有时不存在。每当节点不存在时，我都会收到“ ”错误。*`Sequence contains no elements`*

 *我已经尝试了我所知道的一切来让事情正常工作。有没有办法测试 XElement 是否存在？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T16:04:18.983

It depends on what you want to do when the node is not there. For instance if Nothing is acceptable then you can switch from .Single to .SingleOrDefault. The latter will return Nothing in the case of an empty sequence and will not throw an exception.

```
Dim vehicles = From v in doc...<Vehicle> _
               Let mile = (From x In v.<ItemSpecific>.<NameValueList> Where x.<Name>.Value = "Mileage" Select x.<Value>.Value).SingleOrDefault _
               Let year = (From z In v.<ItemSpecific>.<NameValueList> Where z.<Name>.Value = "Year" Select z.<Value>.Value).SingleOrDefault _
               Select New Vehicle With {.Name = v.<Item>.<Name>.Value, .Maker = v.<Item>.<Maker>.Value, .Color = v.<Item>.<Color>.Value, .Mileage = mile, .Year = year} 
```

# sql-server - 将 XML 从 SQL Server 输出到客户端的最简单方法

> ID：619363
> 
> 赞同：0
> 
> 时间：2009-03-06T16:03:20.670
> 
> 标签：sql-server, xml, stream, infopath

我需要通过单击 URL 将 sql server 中 xml 列的内容返回给客户端。xml 具有打开正确应用程序的处理指令（在本例中为 Infopath）。

对于所有可用的各种 xmlreader 编写器和流，我有点困惑。我想我想将 SQL ExecuteXmlReader 的内容发送到 Response.OutputStream - 但我不确定如何将它们组合在一起。

谢谢是提前

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T16:49:37.377

我建议从数据库中获取 XML 作为文本，然后动态创建一个页面并将标头中的 MIME 类型设置为“application/xml”。这应该告诉浏览器 DTRT（假设它配置正确）。

如果您不使用 Web 应用程序，那么您可能需要考虑使用 RE 来解析文本并确定要启动的应用程序，然后将 XML 提供给它（使用临时文件或通过某种类型的输入重定向）。

由于您没有说明除了 XML 和 SQL Server 还使用了哪些技术，因此很难具体说明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T20:11:31.993

为什么不使用标准 SQL 查询数据库以获取 XML 列的内容，然后在页面中获取该内容并将该字符串流式传输回用户？

就像是：

```
string xmlContents = string.Empty;

using(SqlConnection _con = new SqlConnection("server=(local);database=Northwind;Integrated Security=SSPI;")
{
  string queryStatement = "SELECT XmlColumn FROM dbo.MyTable WHERE id = @ID";

  using(SqlCommand _cmd = new SqlCommand(queryStatement, _con)
  {
    _cmd.Parameters.AddWithValue("@ID", 5555);

    _con.Open();

    xmlContents = _cmd.ExecuteScalar().ToString(); // returns an object
    _con.Close();
  }
} 
```

然后只需将 XML 流式传输回用户，例如使用 Response.Write(xmlContents) - 大致符合这些要求（不包括错误处理 - 我将把它留给你处理:-)）。

这有帮助吗？

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T20:17:49.780

SQL 2005 及更高版本支持该`FOR XML`语句。看[**这里**](http://msdn.microsoft.com/en-us/library/ms190922.aspx)

例如：

```
SELECT * FROM MyTable FOR XML RAW; 
```

还有其他关键字用于将 XML 标记名称调整为与数据库列不同。

然后查看 ExecuteXmlReader 文档，了解您在 C# 中使用的任何 Command 类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T08:58:12.383

我通过简单地使用带有 xml 作为文本的 Response.Write 来实现它，但我仍然不确定我是否真的应该使用 XmlReaders 和流。这是我所做的：

```
SqlCommand cmd = conn.CreateCommand();
cmd.CommandType = CommandType.Text;
cmd.CommandText = "select Name, InfopathDoc from document where id = @id";
cmd.Parameters.AddWithValue("@id", docId);

using (SqlDataReader dr = cmd.ExecuteReader())
{
    if (dr.Read())
    {
        Response.ContentType = "application/xml";
        Response.AppendHeader("Content-disposition", "attachment; filename=" + dr["Name"]);
        Response.Write(dr["InfopathDoc"]);
    } 
```

# silverlight - 为什么这个silverlight动画会让整个布局消失？

> ID：619369
> 
> 赞同：2
> 
> 时间：2009-03-06T16:05:26.657
> 
> 标签：silverlight, animation

我开始关注 Silverlight，我想从小处着手。我看过的所有示例都使用了关键帧动画，所以我想尝试不同类型的动画。我也有点不熟悉从代码中执行动画，所以我决定也试试这个。我的最终目标是制作某种动画面板，但现在我从一个小按钮开始：

```
<UserControl x:Class="TestSilverlight.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="400" Height="300" Background="Azure">
    <Grid x:Name="LayoutRoot" Background="Azure">
        <Button x:Name="btnClick" Content="Animate me!" Height="48" Width="96" Click="btn_Click">
        </Button>
    </Grid>
</UserControl> 
```

我写了这个事件处理程序，我认为它非常简单：

```
private void btn_Click(object sender, EventArgs e)
{
    Storyboard story = new Storyboard();
    story.RepeatBehavior = new RepeatBehavior(3.0);
    story.Duration = new Duration(TimeSpan.FromSeconds(1.0));

    if (btnClick.RenderTransform == null)
        btnClick.RenderTransform = new TranslateTransform();

    DoubleAnimation xAnim = new DoubleAnimation();
    xAnim.To = 50;
    Storyboard.SetTargetProperty(xAnim, new PropertyPath(TranslateTransform.XProperty));
    Storyboard.SetTarget(xAnim, btnClick.RenderTransform);

    story.Children.Add(xAnim);

    story.Begin();
} 
```

当我单击按钮时，我期望看到它向右滑动 50 个单位 3 次。实际发生的是整个布局消失了，因为背景颜色随着按钮的消失。

如果我重写按钮的代码以从 RenderTransform 开始，一切正常！

```
<Button x:Name="btnClick" Content="Animate me!" Height="48" Width="96" Click="btn_Click">
    <Button.RenderTransform>
        <TranslateTransform />
    </Button.RenderTransform>
</Button> 
```

在导致失败的第一种情况下发生了什么？我在做一些根本错误的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T18:49:02.473

您可以通过删除对“btnClick.RenderTransform == null”的检查来解决此问题，而是始终创建一个新的 TranslateTransform，或者检查“btnClick.RenderTransform is TranslateTransform”而不是 null。

您看到此错误的原因是，默认情况下，Button 的 RenderTransform 有一个恒等变换，它恰好是一个 MatrixTransform。因此，您尝试将 MatrixTransform 设置为动画，就好像它是 TranslateTransform 一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T16:12:53.317

我上次使用 Silverlight 是在 2008 年初。在 Silverlight 的 Beta 版本中，有时当发生*任何*错误时整个布局会消失（保持白色和空白），而不是错误消息。

不确定当前版本是否仍然如此。您可以（或者您已经）单步执行代码以检查是否引发了异常......或者以编程方式捕获它并呈现某种错误消息？

希望我能帮到你一点。

马蒂亚斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T16:29:54.583

我一直在研究几乎相同的事情，并且我阅读过的各种资料表明您不能以编程方式添加情节提要。尝试在 XAML 中添加它，然后您可以在代码中对其进行修改——只需确保命名它以便您可以访问它。您可能还必须在 xaml 中添加转换。需要记住的是，silverlight 不是 wpf，它很接近，但很多事情都不同——足以让人感到痛苦。

```
<UserControl x:Class="TestSilverlight.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="400" Height="300" Background="Azure">
    <UserControl.Resources>
        <StoryBoard Name="story" />
    </UserControl.Resources>

<Grid x:Name="LayoutRoot" Background="Azure">
    <Button x:Name="btnClick" Content="Animate me!" Height="48" Width="96" Click="btn_Click">
    </Button>
</Grid> 
```

# python - 使用 Django ORM 轻松执行原始 SQL 的工具

> ID：619384
> 
> 赞同：2
> 
> 时间：2009-03-06T16:11:46.483
> 
> 标签：python, django, orm

经常需要在django中执行自定义的sql查询，每次手动将查询结果转换成对象有点痛苦。我想知道 Slackers 同胞是如何处理这个问题的。也许有人编写了某种库来帮助处理 Django 中的自定义 SQL？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T17:26:39.753

不完全确定您要查找的内容，但您始终可以在模型中添加一个方法以按照[文档](http://docs.djangoproject.com/en/dev/topics/db/sql/#topics-db-sql "文档")执行自定义 SQL ：

```
def my_custom_sql(self):
  from django.db import connection
  cursor = connection.cursor()
  cursor.execute("SELECT foo FROM bar WHERE baz = %s", [self.baz])
  row = cursor.fetchone()
  return row 
```

对于更通用的东西，创建一个[抽象的基本模型](http://docs.djangoproject.com/en/dev/topics/db/models/#id6)，它定义了一个带有“sql”参数的函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-04-20T08:46:11.090

最新的开发版本（未来的 1.2）有 .raw() 方法来帮助你：

```
Person.objects.raw('SELECT * FROM myapp_person') 
```

更多信息可以在[http://docs.djangoproject.com/en/dev/topics/db/sql/](http://docs.djangoproject.com/en/dev/topics/db/sql/)下找到。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T19:33:52.723

由于问题是“手动将查询结果转换为对象”，因此最简单的解决方案通常是查看您的自定义 SQL 是否适合 ORM .extra() 调用，而不是纯 SQL 查询。通常可以，然后您让 ORM 像往常一样完成构建对象的所有工作。

# asp.net - asp.net ajax 日历扩展器（在更新面板中）导致换行

> ID：619389
> 
> 赞同：0
> 
> 时间：2009-03-06T16:13:14.750
> 
> 标签：asp.net, css, asp.net-ajax, calendarextender

这是我的页面的简化版本：

```
<asp:UpdatePanel runat="server" ID="dateUpdatePanel" RenderMode="Inline">
<ContentTemplate>

    <asp:Label runat="server" ID="lblDateFrom" Text="From:" />
    <asp:TextBox runat="server" ID="txtDateFrom" />
    <asp:ImageButton runat="server" ID="cmdDateFrom" ImageUrl="~/images/calendar.jpeg"  />
    <ajax:CalendarExtender runat="server" ID="calendarFrom" TargetControlID="txtDateFrom" 
        PopupButtonID="cmdDateFrom" Format="dd/MM/yyyy" />               

</ContentTemplate>
</asp:UpdatePanel>

<asp:Button runat="server" ID="cmdRunReport" Text="Run Report" OnClick="cmdRunReport_Click" /> 
```

UpdatePanel 设置为内联呈现，因此“运行报告”按钮显示在日历输入右侧的行中。但是，当我单击日历图像按钮 (cmdDateFrom) 时，“运行报告”按钮会移动并呈现在下一行！

任何 CSS 大师都可以提供帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T16:19:49.507

可能是因为日历呈现为 div，默认情况下它有自己的行。一个选项是在绝对位置 div 中使用标准日历控件。这将阻止它强制换行，但您必须正确排列页面，使其不包含任何必要的控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T09:54:14.307

```
<style type="text/css">
    ajax__calendar
        {
            display: inline;
    }
</style> 
```

似乎用 IE6 和 FF3 修复它

# javascript - Javascript 图像滑块

> ID：619390
> 
> 赞同：1
> 
> 时间：2009-03-06T16:13:26.653
> 
> 标签：javascript, slider, photos

您好我正在寻找具有以下功能的简单 Javascript 图像滑块。一个小水平框，显示图像缩略图并滑动它们。选择缩略图后，图像会显示在 div 或页面上的其他位置。我想要一些简单而专业的东西。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T16:18:12.943

如果您可以使用 jQuery，那么有一个名为 jQuery Cycle 的简洁插件可以执行各种图像循环。

[链接文本](http://malsup.com/jquery/cycle/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T16:32:26.483

jQuery 灯箱也可能是一种选择......它非常开箱即用[http://leandrovieira.com/projects/jquery/lightbox/](http://leandrovieira.com/projects/jquery/lightbox/)

# perl - 如何在 Perl 的对齐列中写入文本？

> ID：619393
> 
> 赞同：19
> 
> 时间：2009-03-06T16:14:53.140
> 
> 标签：perl, format

我正在尝试从 Perl 写入文件。我只想以制表符分隔的格式写入数据。但是，我正在编写的数据长度不同，并且没有对齐。

例如，我正在尝试编写如下内容：

```
Name  Education   Fav_Car  MoneyInBank
josh  High School Porche   500
SomeOtherName  PHD  Hyundai   50000 
```

我只希望数据与顶部的标题对齐。

我正在输出这样的数据：

```
 printf FILE ("%s%20s%20s\n", "Name", "Ed", "Car");
 while (($name, $ed, $car) = $sth->fetchrow_array) {
     printf FILE ("%s>>>>>>>>>>>>>%40s%40s\n", $name, $ed, $car);
 }; 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-06T16:19:49.163

在文本编辑器中打开时，制表符分隔的数据（字段长度不一致）不会对齐。

解决方案：

*   在电子表格中打开文件。
*   在文字处理器中打开它，选择所有文本，并定义适当的制表位。（谢谢，[Justsalt](https://stackoverflow.com/users/13693/justsalt)）
*   在文本编辑器中，将选项卡宽度设置为大于任何字段的值。
*   使用空格而不是制表符（例如，[`printf`](http://perldoc.perl.org/functions/sprintf.html)使用字段宽度或[格式](http://perldoc.perl.org/perlform.html)）。

例如，您可以使用

```
printf("%-15s %-15s %-10s %9s\n", $name, $edu, $car, $cash); 
```

`-`后面的会`%`导致字段左对齐。数字（如金钱）通常是右对齐的（这是默认设置）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-06T16:20:31.877

看一下 Perl[格式](http://www.webreference.com/programming/perl/format/)命令。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-06T17:27:00.780

看看[Perl6::Form](http://search.cpan.org/dist/Perl6-Form/) CPAN 模块。

上一个问题/答案哪些其他语言具有类似于堆栈溢出上的*[Perls 格式的功能和或库可能会有所帮助。](https://stackoverflow.com/questions/236629/what-other-languages-have-features-and-or-libraries-similar-to-perls-format/237031#237031)*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-07T20:25:58.097

除了像C的printf这样的方式，还可以用“*”动态调整宽度，

```
printf FILE ("%*s%*s%*s\n", 20, "Name", length($blah), "Ed", 20, "Car"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T16:21:44.137

[printf](https://perldoc.perl.org/perlfunc#printf-FILEHANDLE-FORMAT%2C-LIST)函数在 C 中执行此操作。对于 20 个字符字段：

```
printf("%20s%20s%20s$20S\n", $name, $ed, $car, $money); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-16T06:43:07.133

如果您在 Linux 上工作，一个简单的解决方案是使用带有标志的[column](http://linux.about.com/library/cmd/blcmdl1_column.htm) system 命令。`-t`只需将空格分隔的表打印到文件中，然后在该文件上使用 column 命令。

```
system("column -t file > new_file"); 
```

# wix - 将 ConfigurableDirectory 的值存储在注册表中

> ID：619395
> 
> 赞同：2
> 
> 时间：2009-03-06T16:16:02.467
> 
> 标签：wix, wix3

我们的安装程序允许用户选择他们想要安装某些文件的位置，但我们需要有一个指向该位置的注册表项。我正在使用功能的 ConfigurableDirectory 选项来执行此操作。如何获取用户选择的目录以便将其写入注册表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T19:48:41.877

我错过了“将查找括号中的名称，如果找到，则替换为它们的实际值。” 在[Wix 教程中](http://www.tramontana.co.hu/wix/lesson1.php#1.5)

所以我能够做到以下几点。

```
 <Component Id="DataFileRegEntry" Guid="" >
      <RegistryKey Root="HKCU" Key="keypath" >
        <RegistryValue Type="string" Name="Calibration" Value="[FILES]"  />
      </RegistryKey>
    </Component> 
```

# c# - C# 中的“只读”属性访问器

> ID：619396
> 
> 赞同：19
> 
> 时间：2009-03-06T16:16:03.167
> 
> 标签：c#, .net, properties, readonly, accessor

我有以下课程：

```
class SampleClass
{
   private ArrayList mMyList;

   SampleClass()
   {
       // Initialize mMyList
   }

   public ArrayList MyList
   {
       get { return mMyList;}
   }
} 
```

我希望用户能够获取 mMyList 这就是为什么我通过属性公开“get”但是我不希望他们对对象（即 MyList.Add(new Class());) 进行更改以使其回到我的课堂。

我想我可以返回对象的副本，但这可能会很慢，我正在寻找一种方法来提供编译时错误，通知用户他们不应该期望能够修改返回的值财产。

这可能吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-06T16:17:40.167

使用 ArrayList，您会受到相当的限制，因为 BCL 中没有只读的非泛型集合类。快速而肮脏的解决方案是返回一种 IEnumerable。

```
 public IEnumerable MyList
   {
       get { return mMyList;}
   } 
```

这实际上不会阻止某人投射到 ArrayList 但默认情况下也不允许编辑

您可以通过调用 ArrayList.ReadOnly 返回一个有效的只读列表。但是它的返回类型是 ArrayList，因此用户仍然可以使用 .Add 进行编译，但会产生运行时错误。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-06T16:18:51.477

使用[ArrayList.ReadOnly()](http://msdn.microsoft.com/en-us/library/system.collections.arraylist.readonly.aspx)方法构造并返回列表周围的只读包装器。它不会复制列表，而只是在其周围创建一个只读包装器。为了获得编译时检查，您可能希望按照@Jared 的建议将只读包装器作为 IEnumerable 返回。

```
public IEnumerable MyList
{
     get { return ArrayList.ReadOnly(mMyList); }
} 
```

> 只读集合只是一个带有防止修改集合的包装器的集合。如果对基础集合进行了更改，则只读集合会反映这些更改。
> 
> 此方法是 O(1) 操作。

[参考](http://msdn.microsoft.com/en-us/library/e2abk8wd.aspx)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-06T17:18:25.217

只是为了扩展 JaredPar 的答案。正如他所说，返回实际的支持字段并不完全安全，因为用户仍然可以动态地将`IEnumerable`back 转换为`ArrayList`.

我会写这样的东西来确保不对原始列表进行任何修改：

```
public IEnumerable MyList
{
    get
    {
         foreach (object o in mMyList)
             yield return o;
    }
} 
```

再说一次，我可能还会使用通用列表 ( `IEnumerable<T>`) 来保证类型安全。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-06T17:50:02.583

使用`ReadOnlyCollection`.

> `return new ReadOnlyCollection<object>(mMyList)`.

您也可以创建`ReadOnlyCollection`a 字段，它会自动反映基础列表中的更改。这是最有效的解决方案。

如果您知道 mMyList 仅包含一种类型的对象（例如，它除了 DateTimes 之外什么都没有），您可以返回一个`ReadOnlyCollection<DateTime>`（或一些其他类型）以获得额外的类型安全性。如果您使用的是 C# 3，您可以简单地编写

> `return new ReadOnlyCollection<DateTime>(mMyList.OfType<DateTime>().ToArray())`

但是，这不会自动更新底层列表，效率也较低（它将复制整个列表）。最好的选择是使 mMyList 成为通用的`List<T>`（例如， a `List<DateTime>`）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-06T17:54:46.207

[List(T).AsReadOnly 方法](http://msdn.microsoft.com/en-us/library/e78dcd75.aspx)=)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-06T16:17:45.987

您应该将返回值包装在只读集合中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-25T20:50:05.323

可从 .NET v2.0 获得

```
 public ArrayList MyList { get; private set; } 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-03-06T16:42:44.507

只需将属性设为 Sealed（或 VB.NET 中的 NotInheritable）并且只读，如下所示：

```
 public sealed readonly ArrayList MyList
   {
       get { return mMyList;}
   } 
```

也不要忘记将支持字段设为只读：

```
 private readonly ArrayList mMyList; 
```

但为了初始化 mMyList 的值，您必须仅在构造函数中对其进行初始化，如下例所示：

```
public SampleClass()
{
   // Initialize mMyList
   mMyList = new ArrayList();
} 
```

# sql-server - SQL 优化

> ID：619398
> 
> 赞同：0
> 
> 时间：2009-03-06T16:17:39.187
> 
> 标签：sql-server, tsql, optimization

这两个查询之间是否存在性能差异。显然应该保留 WHERE 用于查询表上的值以符合 SQL 92，是否存在性能原因？

```
SELECT
  Foo.FooId
  (
    SELECT
      Bar.BarId
    FROM
      Bar
    WHERE
      Bar.FooId = Foo.FooId
    FOR XML PATH('Bar'), TYPE 
  ) As 'Bar'
  FROM
    Foo
  FOR XML PATH('Foo'), TYPE 
```

和

```
SELECT
  Foo.FooId
  (
    SELECT
      Bar.BarId
    FROM
      Bar
    JOIN
      Foo
    ON
      Foo.FooId = Bar.FooId
    FOR XML PATH('Bar'), TYPE 
  ) As 'Bar'
  FROM
    Foo
  FOR XML PATH('Foo'), TYPE 
```

同样，这两个查询之间是否存在性能差异？

```
SELECT
  Foo.FooId
FROM
  Foo
WHERE
  Foo.FooId IN
  (
    SELECT
      Bar.FooId
    FROM
      Bar
    WHERE 
      Bar.SomeField = 'SomeValue'
  ) 
```

和

```
SELECT
  Foo.FooId
FROM
  Foo
JOIN
  Bar
ON 
  Bar.FooId = Bar.BarId
WHERE
  Bar.SomeField = 'SomeValue' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T16:22:34.213

一般来说，连接和性能的规则是这样的：首先使用 ON 子句执行 INNER/OUTER/LEFT/RIGHT/CROSS JOIN，然后如果需要，使用 WHERE 子句进一步过滤数据。这更有效的原因是表大小。当您从两个表中选择并加入 WHERE 子句时，您执行 table_size_1 * table_size_2 记录，然后应用 WHERE 子句来获取实际的连接。使用 JOIN 时，实际上首先限制了记录，从而减小了临时表的大小。大多数（如果不是全部）DBMS 都经过优化，可以处理 JOIN ON 而不是 WHERE 上的连接。

我不确定 XML 数据对查询有什么影响，但在实际的表连接上，你的第二个例子都更好。

# sql-server - SQL BOX 中的 CPU 使用率

> ID：619403
> 
> 赞同：-1
> 
> 时间：2009-03-06T16:18:46.763
> 
> 标签：sql-server

是否存在 SQL BOX 的 CPU 使用率的最佳数字。我只想说清楚，最好的数字是多少。请，建议。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T16:25:17.217

您正在寻找数据库服务器的最佳 CPU 利用率？这个问题真的没有答案。在最好的情况下，您的 CPU 利用率将达到 100%，没有进程等待。

纯粹看 CPU 使用率不会告诉你太多。数据库受 CPU 限制，但也受内存和 I/O 限制。

您要解决的实际问题是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T16:29:36.100

没有最好的数字。任何小于 100% 的都是可取的。:-)

这取决于您工作量的可变性。您需要额外的容量来应对工作负载的峰值。

如果您有极其一致的工作负载，那么 80%-90% 的平均 CPU 就可以了。如果它变化很大，那么您的平均 CPU 应该会低很多。

如果 CPU 被固定，那么进程将等待并陷入困境。这是一件坏事。因此，尽可能多地添加 CPU，以防止经常出现 100% CPU。可接受的频率取决于您和您的预算。

# reporting-services - 回发时报告数据消失

> ID：619405
> 
> 赞同：0
> 
> 时间：2009-03-06T16:18:54.813
> 
> 标签：reporting-services, postback, reportviewer

我目前有一个报告服务项目，它显示为 ASP.NET 应用程序的一部分。我有一份包含 2 个日期时间参数的报告。当我在文本框中输入某种日期时，似乎什么都没有发生，但是如果我单击小日历图标并选择一个日期，页面将返回，并且过去显示的数据现在已经消失了。有没有办法防止这种情况？在我点击“查看报告”按钮后，它会使用新参数运行报告，但我的用户有点紧张，如果报告在他们身上消失，他们会在完全恐慌的情况下拨打帮助热线。

帮助开发人员免于愤怒和恐慌的用户？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T17:50:17.903

确保在日历和文本框中设置了 EnabledViewState=true。

# asp.net - 可以在 BoundColumn.DataField 中调用函数吗？

> ID：619410
> 
> 赞同：2
> 
> 时间：2009-03-06T16:19:51.223
> 
> 标签：asp.net, datagrid, boundcolumn, datafield

```
<asp:BoundColumn DataField="pos" HeaderText="Principal Office" /> 
```

有没有可能以某种方式...

```
<asp:BoundColumn DataField="postProccess(pos)" HeaderText="Principal Office" /> 
```

...所以我可以根据需要修改值？

废话：

```
A field or property with the name 'postProcess(pos)' was not found on the selected data source. 
```

任何人都知道我可以如何覆盖那个东西或什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T16:51:01.180

这是您要用于模板列的完整代码段...

```
<asp:TemplateColumn HeaderText="Principal Office">
   <ItemTemplate>
      <%# postProcess(Eval("pos")) %>
   <ItemTemplate>
<asp:TemplateColumn> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T16:25:47.620

在事件中使用[`<asp:templatecolumn>`](http://aspnet.4guysfromrolla.com/articles/032203-1.aspx)并进行后期处理[`ItemDataBound`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datagrid.itemdatabound.aspx)

# resources - 什么是最好的非英语通用编程资源？

> ID：619413
> 
> 赞同：2
> 
> 时间：2009-03-06T16:20:18.977
> 
> 标签：resources, forums, non-english

这可能是我自己的有限观点，但似乎大多数计算机编程网站和资源都是英语或主要是英语。[当然，正如在其他](https://stackoverflow.com/questions/202723/coding-in-other-spoken-languages)一些SO[问题](https://stackoverflow.com/questions/288061/do-there-exist-any-compilers-with-localized-versions-of-programming-languages)中所讨论的那样，英语在编程语言发展中的作用一直是一个因素。

所以我很好奇，有哪些重要的（经过深思熟虑，流量充足等）编程网站/论坛/资源/等，其中讨论主要以英语以外的语言进行？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-18T22:57:54.027

[RSDN](http://www.rsdn.ru)是著名的俄语在线资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T17:13:27.710

[SelfHTML](http://de.selfhtml.org/)是一个相当大且知名的德国参考网站，涉及 Web 技术 HTML、XHTML、CSS、XML/DTD、JavaScript/DOM、Perl、PHP 等。它已经存在了很长时间，背后有一个活跃的社区，不断更新它并添加新内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T16:31:16.267

有很多，但最后大多数都指向英文源，因为内容（即计算机编程内容）大部分时间都是用英文生成的。

你对什么语言感兴趣？

Google 代码网站提供以下语言：中文 - 英语 - 葡萄牙语 - Pусский - 西班牙语 - 日本语</p>

但同样，主要内容是用英语生成的。

此外，英语毕竟不是那么难（尽管掌握英语就像任何其他语言一样）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-25T20:24:24.223

我与西班牙编程学生一起工作。我发现使用所讨论的特定语言搜索短语“编程术语”会发现许多带有术语翻译的站点。

在西班牙语中，“terminos de programación”揭示了世界各地许多花时间翻译这些术语的网站。我会自己做翻译，但不是以西班牙语为母语的人会破坏这项工作。

西班牙语的好资源：[链接](http://www.alegsa.com.ar/)

# versioning - 确定版本号

> ID：619422
> 
> 赞同：6
> 
> 时间：2009-03-06T16:23:12.980
> 
> 标签：versioning

**复制**

[版本号怎么做？](https://stackoverflow.com/questions/615227/how-to-do-version-numbers)

* * *

你好，

所以我最近看到**Groovy**发布到了**1.6**版，在收听 Java Posse Podcast 时，他们评论说这个版本包含了这么多内容，它应该是**2.0**版本。

这让我思考。版本号是任意的吗？我曾经认为它们是有意义的，但我想不是。这一切都只是基于里程碑并将项目设置为项目吗？

您的团队如何控制您的版本号和发布？

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T16:28:25.383

区分用于营销的版本控制和用于技术用途的版本控制。

**对于营销**，答案是：“无论您希望客户怎么想。” 在这种情况下，“主要新版本”可能应该伴随着主要版本号。

还要注意，细心的客户在使用“主要”新版本之前会犹豫不决，直到时间过去并且他们已经在测试环境中尝试过。“构建更改”版本被认为具有错误修复和其他不需要太多安装过程的小东西。

**对于技术用途**，答案是：“您想为开发人员编码的任何信息。” 没有一种正确的方法可以做到这一点。这取决于你的目标。

也许“主要”版本意味着“可能意味着许多新错误的重大变化”。也许每次编译都会出现一个新的“构建”号。也许按日期的每晚构建标签是您的版本。您可以基于时间、Scrum 周期、里程碑、功能等等！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-06T16:34:22.000

他们非常武断。很多人喜欢拥有类似的东西

```
[major].[minor].[release].[revision] 
```

作为他们的版本控制计划，但我也曾在拒绝发布 1.0 品牌产品的公司工作，因为其中一位副总裁不想这样做。营销也可以影响这一点。

增加主要版本的一个好问题可以是：

如果这是付费产品，客户会付费升级到这个新版本吗？

如果是这样，增加主要号码可能会很好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-06T16:28:47.193

MajorRelease.MinorRelease.Hotfix

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T16:29:50.780

版本号是任意的，但有一些经验法则（我认为）。非常小的更改或错误修复通常会增加 0.0.1，即 V1 变为 V1.0.1。对功能的微小更改增加了 0.1.0，即 V1.0.1 变为 V1.1.0。重大更改或重写会增加 1.0.0，即 V2。

也就是说，许多公司似乎试图通过在类似的变化为 0.1.0 时提高 1.0.0 来说服客户某些重要的事情。此外，一些依赖支持合同的公司将免费提供 0.1.0 更新，但对 1.0.0 更新收费。

此外，IIRC，一些项目倾向于将奇数版本的实验版本和稳定版本表示为偶数版本，（所以 V3 很危险，V4 是稳定的）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-28T17:35:36.367

对于库，版本号告诉您两个版本之间**的兼容性级别**，以及升级的难度。

错误修复版本需要保留二进制、源代码和序列化兼容性。

次要版本对不同的项目意味着不同的东西，但通常它们不需要保持源代码兼容性。

主要版本号可以打破所有三种形式。

[我在这里](http://motlin.com/2010/how-to-do-version-numbers/)写了更多关于基本原理的文章。

# vim - 备份-恢复 VIM 中的当前重复动作 (.)

> ID：619423
> 
> 赞同：7
> 
> 时间：2009-03-06T16:23:22.573
> 
> 标签：vim

我想保存当前的单次重复动作（这是按 . 时发生的情况），然后运行宏，然后恢复 . 动作（因为宏通常会改变它）。

这可能吗？

或者，是否可以在不更改当前 . 行动？我想我可以尝试在命令模式下做所有事情，但我不确定这是否可能。

背景：我正在编写一个文件浏览器功能（如 TextMate 中的 command-T，请参阅[http://github.com/mdemare/fuzzy_file_finder](http://github.com/mdemare/fuzzy_file_finder)），我想对用户的环境进行尽可能少的更改，所以更改必须出现在函数中。目前，当您使用此功能切换文件时，您的 . 操作被覆盖，这是非常不受欢迎的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-30T18:11:35.787

在 VIM 中，您可以创建一个宏，该宏将执行您通常在`normal`模式下执行的任何编辑，而不会干扰重做`[.]`功能，方法是将这些编辑包装在用户定义中`:function`，然后使用`:map`ped 键执行该功能。

# 例子

看它的最好方法是举个例子。假设您希望`yyy`每次按 F2 键时都将文本添加到当前行的末尾，但您不希望这会干扰重做命令`[.]`。

这是如何做到的：

1.  打开一个新的 vim 窗口并执行以下命令：

    ```
    :fu JL()
        normal Ayyy
        endfu
    :map <F2> :call JL()<Enter> 
    ```

2.  现在添加一些文本，比如说`xxx`，通过键入`Axxx<Esc>`

3.  现在按下`[F2]`键，你应该看到`xxxyyy`

4.  最后，`[.]`按键，你应该看到`xxxyyyxxx`

正是你想要的！

# 为什么这有效

这是因为 VIM 执行重做命令的方式的本质。VIM 会在您键入命令时跟踪它的字符。当您按下该`[.]`键时，它会将这些字符塞回键盘缓冲区以重新执行它们。不幸的是，一个简单的`q`宏以同样的方式工作——它将字符填充到缓冲区中，这样做会覆盖重做缓冲区。该`:normal`命令也可以执行此操作，但是当放置在用户定义的函数中时，我们会绕过这个限制，因为执行用户定义的函数的代码会在用户定义的函数期间保存和恢复重做缓冲区。

这一切都发生在VIM 源代码中[`eval.c`](https://github.com/vim/vim/blob/master/src/eval.c)。[`getchar.c`](https://github.com/vim/vim/blob/master/src/getchar.c)搜索`saveRedobuff`以查看发生了什么。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T16:31:49.993

您可以将操作记录到寄存器中以供以后使用。按**q**后跟一个*寄存器*（**az**、**AZ**、**0-9**或**"**是有效的寄存器标识符），应用所需的命令/动作，然后按**q**停止录制。可以通过按**@**后跟*寄存器*来调用命令。

有关更详细的说明，请参阅[Vim 文档的](http://www.vim.org/htmldoc/)[复杂重复](http://www.vim.org/htmldoc/repeat.html#complex-repeat)部分。

*注意：不幸的是，序列**qa.qu**不会完全符合您的要求，因为**.** command 将重复当前的最后一个动作，而不是记录命令时的最后一个动作。*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-06T17:32:09.083

我能想到的唯一可以帮助您的方法：重新*映射“。” 保存操作历史记录*，然后您可以在需要时调用。有关这些方面的想法，请参阅[repeat.vim](http://www.vim.org/scripts/script.php?script_id=2136)插件。

# bash - 使用 read 命令解析 linux shell 脚本中的 du -s 输出

> ID：619432
> 
> 赞同：3
> 
> 时间：2009-03-06T16:25:06.187
> 
> 标签：bash, shell

如果用户主目录超过一定大小，我正在尝试编写一个 shell 脚本来执行操作。不幸的是，当我尝试使用 read 命令拆分`du -s`输出时，我得到“找不到命令”，因为它试图将数字传递给 shell，而不是像我想要的那样传递给变量。这是我到目前为止的脚本。

```
#!/bin/bash
cd /home
for i in `ls`
do
    j=`du -s $i`
    #this line gives me the error
    k=`$j |read first;`
done 
```

我得到如下输出：

```
./takehome.sh: line 6: 3284972: command not found 
```

其中 3284972 是目录的大小。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T16:45:03.003

我想你会想要一些类似的东西

```
#!/bin/bash
for i in *
do
    j=`du -s "$i" | cut -f 1`
    echo $i size is $j
done 
```

读入另一个变量，读取并使用它似乎是多余的。

我相信一个更优雅的解决方案是乔纳森莱弗勒的第二种方法（复制粘贴在这里）

```
#!/bin/bash
cd /home
du -s * |
while read size name
do
    ...
done 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-06T17:15:11.170

至少有两种方法可以做到这一点：

### 方法一：

```
#!/bin/bash
cd /home
for i in `ls`
do
    set -- `du -s $i`
    size=$1
    name=$2
    ...
done 
```

### 方法二：

```
#!/bin/bash
cd /home
du -s * |
while read size name
do
    ...
done 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T16:33:25.280

这是可以理解的，因为这就是你告诉它的。反引号的意思是：评估这个字符串，将它作为命令运行并给我输出。

此外，`read name`意味着将数据读入变量`name`。

尝试：

```
echo $j | read k 
```

甚至删除前一行：

```
du -s $i | read k 
```

（**编辑**-正确测试它，它可以正常工作`ksh`但`bash`由于某种原因不能正常工作。我认为这可能与子shell有关。`cut`如果您使用的是bash，请使用下面的反引号和解决方案。）

您可以保留反引号并使用[`cut`](http://linux.die.net/man/1/cut)而不是`read`：

```
k=`$du -s $i | cut -f1` 
```

在这种情况下，它可能不会给你更多，但`cut`比`read`它在未来某个时候可能会帮助你更强大。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T17:09:26.317

如果您只想限制用户可以使用的磁盘空间量，您可能需要查看磁盘配额的概念。

起点：[配额@LQWiki](http://wiki.linuxquestions.org/wiki/Quota)

# c# - 我应该假设两元素枚举将保持这种方式吗？

> ID：619434
> 
> 赞同：0
> 
> 时间：2009-03-06T16:25:26.327
> 
> 标签：c#, syntax, enums, switch-statement, if-statement

我有两个成员 enum 发生了很多事情：

```
 enum  E{
            A,
            B
        } 
```

假设我想根据我的枚举值为 i 分配一个不同的值。

我应该写这个：

```
 int i= (e== E.A)?0:1; 
```

或这个 ：

```
 int i;
        if (e==E.A)
            i=0;
        else if (e==E.B)
            i=1;
        else throw new NotImplementedException("Unknown enum member for E : " + e); 
```

或者这个：

```
 int i;
        switch (e)
        {
            case E.A:
                i = 0;
                break;
            case E.B:
                i=1;
                break;
            default:
                throw new NotImplementedException("Unknown enum member for E : " + e);
        } 
```

我通常选择第一个选项，因为它写起来更快，但我总是觉得有点不对劲。你平常都做什么？

我在 c# 中发布了代码，但这个问题与语言无关。

我真的不知道应该如何标记它，如果需要，请不要犹豫重新标记它。

编辑：也许我的问题还不够清楚：我真正想知道的是：我应该假设我的枚举永远不会改变并采用快速的方式，还是应该考虑它可能会改变（尽管我没有改变它然而），并添加一些错误处理代码，这样我就不用花费数周的时间来跟踪错误的位置（如果它发生了变化）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T16:41:22.590

从维护的角度来看，我会将第一个选项视为潜在的错误，并将其转换为 case 语句以使行为更加明确。我想这取决于代码的预期寿命——它存在的时间越长，你应该让它越明确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T16:29:57.283

如果将值添加到枚举中，则将语句添加到 switch 语句将比其他任何语句更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T16:31:24.380

这个问题确实*与*语言有关，因为不同的语言处理枚举的方式不同。

由于错误处理，第一个版本与其他两个版本非常不同。如果您真的不在乎既不是 A 也不是 B 会发生什么，只需使用（在这种情况下）：

```
int i = (int) e; 
```

如果您想要的 int 值不直接匹配，我会选择 switch 语句，甚至可能使用字典（这会更慢，但使用 C# 3.0 集合初始化程序的代码更紧凑，并且会提供参数检查免费，如果您对它抛出的异常感到满意）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T15:49:26.570

最后一个是*最佳实践*。它更具可读性和可维护性。请不要使用第一个！

# python - PyPy 在 CPython、Jython 和 IronPython 上提供了什么？

> ID：619437
> 
> 赞同：28
> 
> 时间：2009-03-06T16:25:49.353
> 
> 标签：python, interpreter, pypy

根据我在博客上看到和阅读的内容，PyPy 是一个非常雄心勃勃的项目。与它的兄弟姐妹（CPython、Jython 和 IronPython）相比，它将带来哪些优势？是速度、跨平台兼容性（包括移动平台）、在没有 GIL 的情况下使用 c 扩展的能力，还是这更多的是关于可以做什么的技术练习？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-06T16:46:37.197

PyPy 实际上是两个项目：

*   解释器编译器工具链，允许您在 RPython（Python 的静态子集）中编写解释器，并为 JVM、.NET（等）独立编译跨平台解释器
*   在 RPython 中实现 Python

这两个项目允许做*很多*事情。

*   在 Python 中维护 Python 比在 C 中维护它容易得多
*   从单个代码库中，您可以生成在 JVM、.NET 和独立环境上运行的 Python 解释器——而不是有多个稍微不兼容的实现
*   编译器工具链的一部分包括一个实验性的 JIT 生成器（现在是它的第五个化身并且开始工作得很好） -*目标*是让 JITed PyPy 运行*得比*CPython 快得多
*   尝试基本的语言特性要容易得多——比如删除 GIL、更好的垃圾收集、集成无堆栈等等

所以 PyPy 有很多令人兴奋的理由，它终于开始兑现它的所有承诺。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T16:29:52.930

最重要的特性当然是 JIT 编译器。在 CPython 中，文件被编译为字节码 ( `.pyc`) 或优化的字节码 ( `.pyo`)，然后进行解释。使用 PyPy，它们将被编译为本机代码。PyPy 还包括[Stackless Python](http://www.stackless.com/)补丁，包括它令人印象深刻的[特性](http://codespeak.net/pypy/dist/pypy/doc/stackless.html)（tasklet 序列化、轻线程等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T16:30:06.783

如果 Python 获得真正的[JIT](http://en.wikipedia.org/wiki/Just-in-time_compilation)，我认为它将与任何其他实现一样快。

优点是实现新功能要容易得多。今天可以通过观察图书馆看到这一点。模块通常先用 Python 编写，然后再翻译成 C。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T16:33:03.593

> *跨平台兼容性*

是的

# vb.net - 将文件传递给函数的最佳方法

> ID：619441
> 
> 赞同：0
> 
> 时间：2009-03-06T16:26:33.297
> 
> 标签：vb.net, file

我现在正在开发一个 VB.NET DLL，我正在编写的函数之一应该是获取一个文件，然后剪掉一个字节数组（我的方法有效，可以抽象出来这里）。将文件传递给此函数的最佳方法是什么？将文件名传递给它是最好的，或者什么是最好的方法来完成这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T16:29:41.560

[文件流类](http://msdn.microsoft.com/en-us/library/system.io.filestream.aspx)

来自上面链接的示例

```
Private Shared Sub AddText(ByVal fs As FileStream, ByVal value As String)
    Dim info As Byte() = New UTF8Encoding(True).GetBytes(value)
    fs.Write(info, 0, info.Length)
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T17:12:10.257

作为字符串的文件名是处理文件的老派标准方法。它是人们知道如何正确设置和使用的参数。

我同意上面的 Fredou 和 Greg D 的观点，即 FileStream 是最好的方法。他们只是更容易以正确的方式做事。

# c# - 处理不应为空的 C# 属性

> ID：619448
> 
> 赞同：8
> 
> 时间：2009-03-06T16:27:51.487
> 
> 标签：c#, properties

在为我正在处理的项目设置一些引用类型属性时，我遇到了一些需要正确初始化才能使用并且永远不应该为空的属性。我已经看到了一些处理此问题的方法，但无法真正确定我所看到的处理此问题的任何主要方法是否存在任何重大缺点。我想了解社区对处理此问题的最佳方法以及每种方法可能存在的潜在缺点的看法。

给定一个简单的类，我已经看到了几种方法来确保一个属性在一个属性中永远不会有这个类的空版本

```
public class MyClass
{
  //Some collection of code
} 
```

选项 1 - 初始化后备存储

```
public class OtherClass1
    {
        private MyClass _mC = new MyClass();
        public MyClass MC
        {
            get { return _mC; }
            set { _mC = value; }
        }
    } 
```

选项 2 - 在构造函数中初始化属性

```
public class OtherClass2
    {
        public MyClass MC { get; set; }     

        public OtherClass2()
        {
            MC = new MyClass(); 
        }
    } 
```

选项 3 - 根据需要在 Getter 中处理初始化

```
public class OtherClass3
    {
        private MyClass _mC;
        public MyClass MC
        {
            get
            {
                if (_mC == null)
                    _mC = new MyClass();
                return _mC; 
            }
            set { _mC = value; }
        }
    } 
```

我敢肯定还有其他方法，但这些是我想到的并且我已经看到的方法。我主要是想确定在这方面是否有完善的最佳实践，或者是否对上述任何内容有特定的担忧。

干杯，

史蒂夫

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T16:29:44.227

最好的选择，除非你真的*可以*自己创建一个新实例：只提供接受所有必需值的构造函数，并在那时验证它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T16:34:10.503

据我所知，这里*没有*一个既定的最佳实践，原因很简单：您的每个选项都有不同的性能/内存占用配置文件。第一个选项适用于对您知道必须在您确定将使用的类中实例化的对象的引用。不过，老实说，我从不采用这种方法，因为我认为＃2 更合适；只是感觉这就是构造函数的*用途*。

当您不确定是否会使用某个选项时，最后一个选项是合适*的*。它允许您仅在需要时占用资源。

顺便说一句，这个问题是许多其他问题的“隔壁”，例如适当使用单例模式、为您的延迟对象使用抽象类或接口等，这可能对您探索以获得更大的洞察力。

更新：令我震惊的是，至少有一种情况是在类定义中初始化一个实例是合适的（你的选项#1）。*如果实例是静态的，那么这是*初始化它的唯一合适位置：

```
private static readonly DateTime firstClassDate = DateTime.Parse("1/1/2009 09:00:00 AM"); 
```

在我今天编写的一些单元测试中创建上述代码行时，我想到了这一点（*只读*在我看来是可选的，但在我的情况下是合适的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T16:33:42.407

解释我几天前发布的一个问题，但我认为强制执行代码规则并确保在您不想要它们的地方不使用 Nulls 可能会有所帮助：

Microsoft 刚刚发布了[Code Contracts](http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx)，这是一个与 Visual Studio 集成的工具，允许您为 .Net 代码定义合同并获得运行时*和*编译时检查。

观看[第 9 频道上的视频](http://channel9.msdn.com/posts/Peli/Getting-started-with-Code-Contracts-in-Visual-Studio-2008/)，了解如何使用它。

现在它是一个附加组件，但它将成为 .Net 4.0 中基类库的一部分

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T16:34:06.477

假设在实例化 _mC 时没有副作用（即，所有其他条件都相同），我更喜欢选项 3，因为在 MC 的 getter 永远不会的情况下，这可以节省堆上 MyClass 的附加实例的开销叫。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T16:34:20.160

选项（3）的好处是在需要之前不分配对象，它可以很容易地调整为延迟加载的对象（所以当从数据库加载对象时——保留外键以加载完整的子对象在需要的时候）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T16:35:29.907

选项 1 和 2 在语法上不同，但本质上是等价的。选项 3 是我非常一致地使用的惰性初始化方法。
我认为它们都有其用途，这取决于您的需要。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-06T16:35:58.110

首先，该属性在初始化时不应该为空还是从不为空？我怀疑您的意思是前者，在这种情况下，您的设置器代码需要防止设置空值。

这里的基本模式是，如果内部类字段没有得到有效赋值，则外部类状态无效。在这种情况下，setter 不仅应保护该字段免受 null 影响，而且构造函数应确保将其初始化为正确的值。

您的代码暗示外部类可以实例化内部类，而无需从使用代码中进一步输入。在现实世界中，外部类需要来自外部的更多信息，以便接收内部类的现有实例或足够的信息来检索一个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-29T14:42:05.763

选项1是香草方式。因为在过去我们没有自动实现的属性（使用 { get; set;} sintax）所以这是他们指定默认行为的方式。

当引入 Auto-Implemented 时，由于您没有直接使用存储默认值 (_mC) 的字段，因此出现了一个相当好的问题：*“我在哪里初始化它？”*

*   选项 2 称为**急切加载**：一旦创建类。
*   选项 3 称为**延迟加载**：仅在需要时才加载。

我已经看到**普遍接受的方式是选项2：急切加载，**但我相信这只是为了最小化代码，这是完全可以接受的。当您开始拥有多个具有多个签名的构造函数并且最终将所有构造函数都指向某种类型的*void Initialize()方法时，就会出现问题。*

**我特别喜欢 Option 3**，因为它对每个字段/属性都更具声明性，而且它是内存优化的。

看看具有不同风格的 EntityFramework：Code-First 或 Database-first，您会注意到它如何在内置属性中使用急切加载器，而对于导航属性，它支持（默认情况下，可以自定义）惰性加载器。

另外，请考虑此加载程序中发生的情况。在实体框架中，这意味着每次初始化它都会访问数据库并查询其中的一部分。您可能会很快被您的 DBA 唠叨，因为您有多个同时会话，并且可能希望将一些事务集中在单个有效负载中，因此一些重新布线以执行急切的加载程序可能会发挥作用......尽管您最终会查询大量数据并减慢您的用户体验。

在**Code-First**中，您可以看到以下示例：

```
public class Blog
{ 
    public int BlogId { get; set; } 
    public string Name { get; set; } 
    public string Url { get; set; } 
    public string Tags { get; set; } 

    public virtual ICollection<Post> Posts { get; set; } 
} 
```

在上面， Posts 集合被声明为虚拟的，因为它将在运行时根据您的设置进行修改。如果您将其设置为预加载，它将作为**选项 2**执行，而如果您将其设置为惰性，它将类似于**选项 3进行修改**

希望这有帮助

# c# - 在 Web 表单中查找控件

> ID：619449
> 
> 赞同：12
> 
> 时间：2009-03-06T16:28:05.727
> 
> 标签：c#, asp.net, webforms

我有一个 Web 内容表单，需要访问内容面板内的控件。我知道访问控件的两种方法：

1.  `TextBox txt = (TextBox)Page.Controls[0].Controls[3].Controls[48].Controls[6]`
2.  通过编写一个搜索所有控件的递归函数。

有没有其他更简单的方法，因为`Page.FindControl`在这种情况下不起作用。我问的原因是我觉得 Page 对象或 Content Panel 对象应该有一种方法来查找子控件，但找不到类似的东西。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-06T17:08:58.500

问题是 FindControl() 不会遍历某些子控件，例如模板控件。如果您所追求的控件存在于模板中，则不会找到它。

所以我们添加了以下扩展方法来处理这个问题。如果您不使用 3.5 或想要避免扩展方法，您可以使用这些方法制作一个通用库。

您现在可以通过编码获得所需的控制：

```
var button = Page.GetControl("MyButton") as Button; 
```

扩展方法为您完成递归工作。希望这可以帮助！

```
public static IEnumerable<Control> Flatten(this ControlCollection controls)
{
    List<Control> list = new List<Control>();
    controls.Traverse(c => list.Add(c));
    return list;
}

public static IEnumerable<Control> Flatten(this ControlCollection controls,     
    Func<Control, bool> predicate)
{
    List<Control> list = new List<Control>();
    controls.Traverse(c => { if (predicate(c)) list.Add(c); });
    return list;
}

public static void Traverse(this ControlCollection controls, Action<Control> action)
{
    foreach (Control control in controls)
    {
        action(control);
        if (control.HasControls())
        {
            control.Controls.Traverse(action);
        }
    }
}

public static Control GetControl(this Control control, string id)
{
    return control.Controls.Flatten(c => c.ID == id).SingleOrDefault();
}

public static IEnumerable<Control> GetControls(this Control control)
{
    return control.Controls.Flatten();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-26T23:04:24.703

我想将您的`GetControls`功能更改为通用功能，如下所示：

```
public static T GetControl<T>(this Control control, string id) where T:Control
{
    var result = control.Controls.Flatten(c => (c.GetType().IsSubclassOf(typeof(T))) && (c.ID == id)).SingleOrDefault();
    if (result == null)
        return null;
    return result as T;
} 
```

进而，

```
public static Control GetControl(this Control control, string id)
{
    return control.GetControl<Control>(id);
} 
```

这样，调用者会调用类似：

```
var button = Page.GetControl<Button>("MyButton"); 
```

# php - Eclipse PDT 中的包资源管理器在哪里/什么是

> ID：619455
> 
> 赞同：2
> 
> 时间：2009-03-06T16:29:09.313
> 
> 标签：php, eclipse, user-interface, eclipse-pdt

我正在尝试在 Eclipse 中显示隐藏文件（即 .htaccess 文件），并且答案指向在“包资源管理器”中执行某些操作。我正在使用 Eclipse PDT 2.1，我不清楚它是什么/在哪里。我如何到达这个传说中的“包资源管理器”？？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T18:11:59.690

正如这篇[102degrees 博客文章](http://www.102degrees.com/blog/2007/07/11/show-the-right-files-in-php-explorer/)中所说：

> 安装 Eclipse PDT 后，我有两个项目导航器。
> 我关闭了本机并保持打开 PHP Explorer。
> PHP Explorer 显示了我的 php、css、js 等文件。它还在文件名的左侧添加了一个加号。使用此视图，我们可以展开文件以查看文件内部的类和函数，而无需打开它。
> 
> 唯一的问题是，默认情况下，我看不到我的`.htaccess`和`.htpasswd`文件。
> 从好的方面来说，使用 SVN，我看不到我的`.svn`文件夹——这正是我想要的。换句话说，这将问题置于不同的角度 - 必须有某种过滤器限制以点开头的文件。
> 
> 在 PHP Explorer 的顶部，有几个工具栏按钮。
> 单击向下箭头会弹出一个上下文菜单。
> 我选择`filters…</code> menu item. By default, ‘<code>name filter patterns`' 未选中。
> .* 文件和服务器项目在第二个框中被选中。这是有道理的，为什么我没有看到我的 .htaccess 文件。

[替代文字 http://opensource.kruxgames.com/torquedit/torqueditDocs/torquedit_html_m6c4621c0.jpg](http://opensource.kruxgames.com/torquedit/torqueditDocs/torquedit_html_m6c4621c0.jpg)

> 首先，我取消选中我的选项 .* 文件。这解决了问题 - 我能够看到`.htaccess`文件 - 但我也看到了我的`.svn`文件夹以及其他元文件。
> 
> 我选中了“<code>name filter patterns”框并输入了以下字符串：

```
.cache, .settings, .svn, .project, .projectOptions 
```

* * *

如[xcc](http://musetracks.instantspot.com/blog/2007/09/13/Add-Custom-File-Filters-to-the-Eclipse-Explorer)中所述：

对于不提供`name filter pattern`通过 GUI 的插件，可以：

> 1.  找到用于编辑的 Eclipse 插件的目录。这通常类似于`eclipse/plugins/[plugin name]_[version]`.
> 2.  在文本编辑器中打开 plugin.xml 文件。
> 3.  查找点属性值为 的扩展元素`org.eclipse.ui.ide.resourceFilters`。
> 4.  像任何其他已经存在但包含所需文件模式的其他过滤器元素一样，创建一个新的过滤器元素。
> 5.  使用 -clean 开关重新启动 Eclipse。
> 
> 如果 plugin.xml 文件不包含任何资源过滤器，请通过将以下代码添加到 plugin.xml 底部来创建一个：

```
<extension point="org.eclipse.ui.ide.resourceFilters">
   <filter selected="false" pattern=".svn"></filter>
   <filter selected="false" pattern=".project"></filter>
</extension> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T16:36:55.520

> 通过转到 Window>Show View>Other... 菜单，可以在您的工作区中显示 Package Explorer，
> 
> 然后展开*Java*文件夹，单击 *包资源管理器*并确定。它应该在您的“透视”中显示为一个选项卡。
> 
> 您可能已经知道下一步该做什么，但以防万一：查看菜单（右侧的小箭头）-> 过滤器-> 取消选中 .* 资源。

编辑：现在我再次阅读了您的问题，这不适用于您，因为 Java Perspective 中使用了 Package Explorer。

您可能正在使用“PHP Explorer”视图（选项卡）来浏览您的文件，它隐藏了系统文件。要查看项目中的所有文件，请使用*导航器*视图：Window>Show View>Other...>Basic>Navigator。

# keyboard - 我可以将 das 键盘上的键从 QWERTY 重新排列到 Dvorak 吗？

> ID：619459
> 
> 赞同：3
> 
> 时间：2009-03-06T16:29:41.870
> 
> 标签：keyboard, dvorak, qwerty

我不想在这里问这个问题，但是 stackoverflow 上的很多人都谈到了 Das。

我想获得带有印刷钥匙的版本 - 因为他们不出售已经为 Dvorak 设置的印刷钥匙版本，我希望自己重新排列钥匙。

好吧，我知道我*可以*，但是...

我的戴尔 sk-8115 键盘无法优雅地管理从 qwerty 到 dvorak 的转换，因为不同行上的键具有不同的形状/高度/角度。

不幸的是，我找不到任何信息来告诉我键块在不同行上的形状是否不同 - 并且 das 键盘支持尚未与我联系。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-06T19:02:51.237

我终于能够获得支持@ das keyboards，现在有了官方答案。

他们说：

> 我们所有的键帽都具有相同的高度和相同的对称性，因此不会导致键交错。不过，如果您想重新排列键帽，这将使您的键盘保修失效。（请参阅我们网站上的手册。）

取消保修似乎很苛刻，特别是考虑到键帽是多么容易被移除（在 youtube 视频中看到），但我认为这将是值得的。

希望有人会发现这很有用。

# c++ - 替换 C++ 运算符 new 的宏

> ID：619467
> 
> 赞同：27
> 
> 时间：2009-03-06T16:30:34.787
> 
> 标签：c++, gcc, c-preprocessor

是否可以创建宏来替换所有形式的`operator new`重载，包括额外的 args...say`__FILE__`和`__LINE__`？

问题似乎是`operator new`可以使用或不使用括号进行编码，因此：

*   *类对象*宏：

    ```
    #define new new(__FILE__, __LINE__) 
    ```

    将替换如下声明：

    ```
    A* a = new A(); 
    ```

*   和*类似函数的*宏：

    ```
    #define new(A) new (A, __FILE__, __LINE__) 
    ```

    将替换如下声明：

    ```
    A* a = new(std::nothrow) A(); 
    ```

不幸的是，尝试用相同的*标识符*声明两个宏是错误的，即使它们是不同的*类型*，所以以下失败：

```
#define new new(__FILE__, __LINE__)
#define new(A) new (A, __FILE__, __LINE__) // Error: "new" already defined 
```

由于我使用的是 g++，我希望使用他们的[可变参数宏](https://www.redhat.com/docs/manuals/enterprise/RHEL-4-Manual/gcc/variadic-macros.html)语法会取得成功，但不幸的是没有。以下：

```
#define new(...) new(__FILE__, __LINE__, ## __VA_ARGS__) 
```

只匹配`new(xyx) A()`，不匹配`new A()`。

我知道有[文章写过](http://web.archive.org/web/20090513070647/http://www.scs.cs.nyu.edu/~dm/c++-new.html)为什么这是不可能的，但我觉得我已经很接近了，一定有办法。有什么明显的我失踪了吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-09-02T00:57:42.403

这是我使用的：

在新的.cpp

```
const char* __file__ = "unknown";
size_t __line__ = 0;

void* operator new(size_t size) {
    void *ptr = malloc(size);
    record_alloc(ptr,__file__,__line__);
    __file__ = "unknown";
    __line__ = 0;
    return ptr;
}

void delete(void *ptr)
{
   unrecord_alloc(ptr);
   free(ptr);
} 
```

为了简洁起见，我省略了 new 和 delete 的其他定义。“record_alloc”和“unrecord_alloc”是维护包含ptr、行和文件的结构的链接列表的函数）。

在新的.hpp

```
extern const char* __file__;
extern size_t __line__;
#define new (__file__=__FILE__,__line__=__LINE__) && 0 ? NULL : new 
```

对于 g++，“new”只扩展一次。关键是“&& 0”，它使它为假并导致使用真正的新的。例如，

```
char *str = new char[100]; 
```

由预处理器扩展为

```
char *str = (__file__="somefile.c",__line__=some_number) && 0 ? NULL : new char [100]; 
```

因此文件和行号被记录并调用您的自定义新函数。

这适用于任何形式的 new——只要在 new.cpp 中有相应的形式

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-06T16:40:40.033

您应该查看我的同事 Calvin 撰写的这篇出色的博客文章。我们最近遇到了一种情况，我们希望启用这种类型的修复，以便将内存泄漏与在诊断/调试构建中分配它们的行相关联。这是一个有趣的技巧

[https://docs.microsoft.com/en-us/archive/blogs/calvin_hsia/overload-operator-new-to-detect-memory-leaks](https://docs.microsoft.com/en-us/archive/blogs/calvin_hsia/overload-operator-new-to-detect-memory-leaks)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-06T16:56:38.280

> **3.7.4 动态存储时长**
> 
> 2 该库为全局分配和释放函数提供默认定义。一些全局分配和释放函数是可替换的 (18.5.1)。C++ 程序应最多提供一个可替换分配或解除分配函数的定义。任何此类函数定义都会替换库中提供的默认版本 (17.6.4.6) [...]
> 
> **17.6.4.6 替换函数**
> 
> 2.  C++ 程序可以为头文件（3.7.4，第 18 条）中声明的八个动态内存分配函数签名中的任何一个提供定义：
>     
>     
>     *   运算符新（std::size_t）
>     *   运算符新（std::size_t，常量 std::nothrow_t&）
>     *   运算符 new[](std::size_t)
>     *   运算符 new[](std::size_t, const std::nothrow_t&)
>     *   运算符删除（无效*）
>     *   运算符 delete(void*, const std::nothrow_t&)
>     *   运算符 delete[](void*)
>     *   运算符 delete[](void*, const std::nothrow_t&)

希望这能澄清什么是法律超载，什么不是。

这里的一些人可能会感兴趣：

```
#define delete cout <<  "delete called at: " << __LINE__ << " of " << __FILE__  << endl, delete 

using namespace std;

void *operator new(size_t size, ostream& o, char *f, unsigned l) {
    o << "new called at: " << l << " of " << f << endl;
    return ::new char[size];
}

int main() {
    int *a = new(cout, __FILE__, __LINE__) int;
    delete a;
} 
```

***警告讲师***：我在这里做的是一件坏事（TM）——在全球范围内超载 new/delete。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-10T12:02:35.363

我发现以下库“ [nvwa](http://sourceforge.net/projects/nvwa) ”对于跟踪新/删除内存泄漏非常有用——查看文件“debug_new”作为示例，或者直接使用它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T16:40:59.690

您没有说您使用的是什么编译器，但至少使用 GCC，您可以覆盖 new 并记录调用者地址，然后使用 addr2line 将其转换为文件/行信息（或使用 BFD 库立即执行此操作）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-06T20:43:31.310

您可以做的是重载运算符 new 并在那里获取堆栈跟踪（特定于平台）并使用堆栈信息推断调用 new 的位置。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-03-06T16:31:50.197

不，没有办法。

你可以在过去的糟糕日子里做到这一点，`malloc()/free()`但不能做到`new`。

您可以通过全局覆盖运算符来替换内存分配器`new`，但不能注入您正在谈论的特殊变量。

# c# - 将通用列表数组绑定到 GridView

> ID：619477
> 
> 赞同：0
> 
> 时间：2009-03-06T16:32:26.793
> 
> 标签：c#, asp.net, .net, list, gridview

嗨，我有一个返回“问题”数组的列表。我的问题是如何将其绑定到网格视图？当我尝试调用 Question.Ordinal 时，我发现它在数据源中不存在。我正在使用以下代码：

```
GridView1.DataSource = myList.GetQ();
GrdiView1.DataBind(); 
```

myList.GetQ() 返回一个 List，它是一个“问题”数组。

当我将 DataField 列设置为“！” 我得到了对象问题。我的问题是如何获得 objects 属性？我试过“！.Ordinal”不起作用。我正在阅读这篇文章以供参考，[在这里](http://www.mikepope.com/blog/AddComment.aspx?blogid=1419)，非常感谢任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T22:57:37.070

只需将其直接设置为 Ordinal，作为您刚刚链接到的帖子中的第一个示例：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="false">
<Columns>
   <asp:BoundField HeaderText="ID" DataField="CustId" />
   <asp:BoundField HeaderText="Name" DataField="Name" />
   <asp:BoundField HeaderText="City" DataField="City" />
</Columns>
</asp:GridView> 
```

说：

```
<asp:BoundField HeaderText="A Header" DataField="APropertyOfQuestion" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T16:39:48.103

尝试使用以下语法：

```
<%# ((MyObject)Container.DataItem).MyField %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-06T01:06:40.283

您必须将类的属性成员定义为属性，即

```
public string ProductName
{
    get
    {
        return _productName;
    }
    set { }

} 
```

或 VB

公共属性 ProductName() 作为字符串集..

得到...

最终属性

重要：是否需要定义get方法

# macos - 为 Unix 命令提供文档？

> ID：619488
> 
> 赞同：3
> 
> 时间：2009-03-06T16:34:10.970
> 
> 标签：macos, bash, unix, manpage

我创建了一个名为 macmac2unix 的 Unix 命令，它将 Word 文件从 Mac 转换为 Unix。

如何为我的命令提供文档？我想用 man 阅读我的命令

```
$man macmac2unix 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T20:30:44.287

我推荐[Perl 的 POD 格式](http://www.perl.com/doc/manual/html/pod/perlpod.html)。尽管有这个名字，但您可以在 Perl 脚本之外使用它，并且[pod2man](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man1/pod2man.1.html)命令随 OS X 一起提供。 troff 更明智。让我想起了 Markdown。

这是一个[示例 pod 文档](http://code.google.com/p/ddribin/source/browse/trunk/nsurl/nsurl.pod)和[转换脚本](http://code.google.com/p/ddribin/source/browse/trunk/nsurl/pod2man.command)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T22:49:53.033

您显然也可以使用**[DocBook](http://www.docbook.org/)**为 Unix 命令提供文档。

# c - HP-UX 中的堆损坏？

> ID：619497
> 
> 赞同：3
> 
> 时间：2009-03-06T16:35:59.390
> 
> 标签：c, unix, segmentation-fault, heap-memory

我试图了解在 HP-UX 11.11 中运行导致 SIGSEGV（11，分段错误）的程序出了什么问题：

```
(gdb) bt
#0  0x737390e8 in _sigfillset+0x618 () from /usr/lib/libc.2
#1  0x73736a8c in _sscanf+0x55c () from /usr/lib/libc.2
#2  0x7373c23c in malloc+0x18c () from /usr/lib/libc.2
#3  0x7379e3f8 in _findbuf+0x138 () from /usr/lib/libc.2
#4  0x7379c9f4 in _filbuf+0x34 () from /usr/lib/libc.2
#5  0x7379c604 in __fgets_unlocked+0x84 () from /usr/lib/libc.2
#6  0x7379c7fc in fgets+0xbc () from /usr/lib/libc.2
#7  0x7378ecec in __nsw_getoneconfig+0xf4 () from /usr/lib/libc.2
#8  0x7378f8b8 in __nsw_getconfig+0x150 () from /usr/lib/libc.2
#9  0x737903a8 in __thread_cond_init_default+0x100 () from /usr/lib/libc.2
#10 0x737909a0 in nss_search+0x80 () from /usr/lib/libc.2
#11 0x736e7320 in __gethostbyname_r+0x140 () from /usr/lib/libc.2
#12 0x736e74bc in gethostbyname+0x94 () from /usr/lib/libc.2
#13 0x11780 in dnetResolveName (name=0x400080d8 "smtp.org.com", hent=0x737f3334) at src/dnet.c:64
.. 
```

问题似乎发生在 libc 内部的某个地方！系统调用跟踪结束于：

```
Connecting to server smtp.org.com on port 25
write(1, "C o n n e c t i n g   t o   s e ".., 51) .......................... = 51
open("/etc/nsswitch.conf", O_RDONLY, 0666) ............................... [entry]
open("/etc/nsswitch.conf", O_RDONLY, 0666) ................................... = 5
  Received signal 11, SIGSEGV, in user mode, [SIG_DFL], partial siginfo
    Siginfo: si_code: I_NONEXIST, faulting address: 0x400118fc, si_errno: 0
    PC: 0xc01980eb, instruction: 0x0d3f1280
exit(11) [implicit] ............................ WIFSIGNALED(SIGSEGV)|WCOREDUMP 
```

程序的最后一条指令：

```
struct hostent *him;
him = gethostbyname(name); // name == "smtp.org.com" as shown by gdb 
```

这是系统的问题，还是我遗漏了什么？任何深入挖掘的指导将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T11:35:14.947

长话短说：vsnprintf 在 HP-UX 11.11 下损坏了我的堆。vsnprintf 是在 C99 (ISO/IEC 9899:1999) 中引入的，“等效于 snprintf，带有可变参数列表”(§7.19.6.12.2)、snprintf (§7.19.6.5.2)：“如果 n 为零，什么都没有写”。嗯，HP UX 11.11 不符合这个规范。当第二个参数 == 0 时，参数写在第一个参数的末尾。当然，这会破坏堆（当 maxsize==0 时，我不分配空间，因为不**应该**写入任何内容）。

HP[手册页](http://docs.hp.com/en/B2355-90695/printf.3S.html)不清楚（“用户有责任确保有足够的存储空间可用。”），**关于 maxsize==0 的情况没有任何说明**。不错的陷阱.. 至少，手册页的 WARNINGS 部分应该警告符合标准的用户..

这是一个鸡蛋/鸡肉 pb：vnsprintf 是可变参数，因此对于“用户的责任”，以确保有足够的存储可用”，“用户的责任”必须首先知道需要多少空间。做到这一点的最好方法是调用vnsprintf with 2nd arg == 0: 然后它应该返回所需的空间量并且 sprintfs 什么都没有.. 好吧，除了 HP ！在这种 std 冲突下使用 vnsprintf 来确定所需空间的一种解决方案：malloc 1 字节到你的缓冲区（第一个arg) 并调用 vnsprintf(buf+buf.length,1,..)。这只会将 \0 放入您分配的新字节中。愚蠢但有效。如果您处于 wchar 条件下，malloc(sizeof..) .

无论如何，解决方法很简单：永远不要在 HP-UX 下使用 maxsize==0 调用 v/snprintf！我现在有一个快乐的稳定程序！

感谢所有贡献者。

* * *

在 HP-UX B11.11 下通过 vsnprintf 导致堆损坏 该程序在 Linux/Cygwin/.. 下打印“@@”。它在 HP-UX B11.11 下打印“@fooo@”：

```
#include <stdarg.h>
#include <stdio.h>

const int S=2;

void f (const char *fmt, ...) {
        va_list ap;
        int actualLen=0;
        char buf[S];

        bzero(buf, S);

        va_start(ap, fmt);
        actualLen = vsnprintf(buf, 0, fmt, ap);
        va_end(ap);

        printf("@%s@\n", buf);
}

int main () {
        f("%s", "fooo");
        return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T16:43:48.030

每当这种情况发生在我身上（系统库中出现意外的段错误）时，通常是因为我在其他地方做了一些愚蠢的事情，即缓冲区溢出、指针上的双重删除等。

在我的错误不明显的情况下，我使用 valgrind。像下面这样的东西通常就足够了：

valgrind -v --leak-check=yes --show-reachable=yes ./myprog

我假设 valgrind 可以在 HP-UX 中使用...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T22:18:58.240

您的堆栈跟踪`malloc`几乎肯定意味着您在某处损坏了`malloc`'s 的数据结构之一。正如[先前的回答](https://stackoverflow.com/questions/619497/heap-corruption-in-hp-ux/619534#619534)所说，您可能有缓冲区溢出或不足，并损坏了从堆中分配的项目之一。

另一种解释是，您尝试对`free`不是来自堆的东西执行 a 操作，但这不太可能——那可能会在`free`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T16:47:49.423

阅读（OS X）手册页说`gethostbyname()`返回一个指针，但据我所知，可能不会为该指针分配内存。你需要`malloc()`先吗？尝试这个：

```
struct hostent *him = malloc(sizeof(struct hostent));
him = gethostbyname(name);
...
free(him); 
```

这样做效果更好吗？

编辑：我对此进行了测试，这可能是错误的。当然，我使用了裸字符串“stmp.org.com”而不是变量，但是两个版本（有和没有`malloc()`ing）都可以在 OS X 上运行。也许 HP-UX 是不同的。

# visual-studio - 如何保持文档选项卡按其在 Visual Studio 2008 中的上次使用情况排序

> ID：619500
> 
> 赞同：7
> 
> 时间：2009-03-06T16:36:46.533
> 
> 标签：visual-studio

告诉 Visual Studio 始终将当前文档定位在左侧窗口中的注册表更改是什么。

默认实现是这样的，如果您打开了 10 个文档并且您正在编辑第 5 个文档，那么它的选项卡将是组中的第 5 个选项卡。当您单击第 5 个文档的选项卡时，随着注册表的更改，它将成为第一个选项卡。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T16:42:26.940

（来自[Sara Ford 的博客](http://blogs.msdn.com/saraford/archive/2008/10/09/did-you-know-you-can-keep-recently-used-files-from-falling-off-the-file-tab-channel-331.aspx)）：

在**HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\9.0**键下创建一个**DWORD UseMRUDocOrdering = 1**。

顺便说一句：以上适用于 Visual Studio 2008。对于 Visual Studio 2005，将注册表项名称中的**9.0替换为****8.0**。

# actionscript-3 - 关于“this”范围的最佳实践/编码标准是什么是 AS3？

> ID：619505
> 
> 赞同：1
> 
> 时间：2009-03-06T16:37:30.010
> 
> 标签：actionscript-3, scope, coding-style

关于“this”范围的最佳实践/编码标准是什么是 AS3？有吗？我觉得它确实有助于标准化和**我的**可读性，但有时它看起来“太多了”。

例如，在下面使用“this”真的有必要吗（我知道没有“this”也可以）？：

```
private var _item:Object;

private var selectedItem:Object;

public function set item(value:Object):void
{
    this._item = value;

    if (this._item["label"] == "doodad")
        this.selectedItem = value;
}

public function set item(value:Object):void
{
    return this._item;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T19:57:37.753

“this”不是必需的，除非您想防止局部范围变量（例如方法参数）和实例变量之间的命名冲突。

在您的示例中，您已经使用下划线来标​​记私有变量，因此不使用“this”是一个额外的理由，因为您实际上是在说两次相同的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T17:04:03.613

这当然没有必要，但我同意它有助于提高可读性。由于我更多地使用更动态的语言（例如 Perl 和 Python），因此此类约定对于快速确定变量和函数的作用域/定位位置至关重要。如果这个约定对你有用，我认为这本身并不是一件坏事。

因此，我花了数小时重新格式化包含妨碍可读性的笨拙约定的代码。

例如：与我一起工作的一个人写了这样的所有作业：

```
var foo:String= "bar"; 
```

这很烦人（我更喜欢“=”，这样我可以清楚地看到运算符），而且我花了很多时间清理我必须维护的数千行代码。他的惯例（尽管我们争论了好几次，但他拒绝妥协）往往会阻碍我的工作。

与其他与您一起工作的人努力团结。如果他们需要支持您的代码并发现这使情况恶化，那么将其留在其中可能是不值得的。如果您不希望任何人直接使用源代码，请使用有助于您理解代码和文档（某处）内容的约定他们的意思是。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T17:29:42.257

如果您在团队中工作，请遵守团队的编码约定。

但就个人而言，我发现明确使用“this”，当不需要消歧时，过度杀伤会对像 AS3 这样的静态类型语言的可读性产生负面影响（动态语言是另一回事！）。

一个类应该只有一个真正的责任，所以通常不应该有太多的属性。在方法内部，您通常处理三种类型的变量：临时局部变量、方法参数和属性。方法不应该太长，所以应该很容易发现这三种类型之间的区别——如果它没有在本地定义并且没有作为参数传递，那么它就是一个属性。如果整个方法不适合您的屏幕，那么它可能太长了！

我只在需要区分同名属性和参数时才使用“this”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T19:46:12.210

我不想过多地使用“this”，但有时在 Eclipse 中这样做，只是为了获得自动完成功能（可能是这样做的最糟糕的理由！）

如果您的示例是：

```
public function set item(_item:Object):void
{
    this._item = _item;

    if (this._item["label"] == "doodad")
        this.selectedItem = this._item;
} 
```

# javascript - Javascript：如何使控件在方法中发送自己

> ID：619514
> 
> 赞同：42
> 
> 时间：2009-03-06T16:39:27.573
> 
> 标签：javascript, onclick

```
<a href="" id="someId" onclick="SomeMethod(self);"></a> 
```

SomeMethod 可能有的地方：

```
function SomeMethod(item)
{
  item.setAttribute('name', item.id);
} 
```

代替：

```
function SomeMethod(itemId)
{
  var someItem;

  someItem = document.getElementById(itemId);
  someItem .setAttribute('name', someItem .id);

} 
```

愚蠢的例子，但想法不是发送 id 本身，而是调用方法的实际控制。我发誓这可以做到，但没有运气搜索......部分原因是我什至不确定要搜索什么。

我以为是自我，但是当我运行的脚本时，自我似乎不是我想要的。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-03-06T16:42:11.577

使用`this`关键字。

```
<a href="" id="someId" onclick="SomeMethod(this);"></a> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-08T13:27:36.270

您实际上不需要**将此**作为参数传递给您的函数，因为您有一个可以访问的**点击事件对象。**所以：

```
<a href="" id="someId" onclick="clickEventHandler()"></a>
<script>
function clickEventHandler(event) {

    if (!event) {
        event = window.event; // Older versions of IE use 
                              // a global reference 
                              // and not an argument.
    };

    var el = (event.target || event.srcElement); // DOM uses 'target';
                                                 // older versions of 
                                                 // IE use 'srcElement'
    el.setAttribute('name', el.id);

}
</script> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-06T16:59:24.547

我倾向于在来自 HTML 属性的所有函数调用中使用这种方法：-

```
onclick="SomeMethod.call(this)" 
```

然后在javascript中做： -

```
function SomeMethod()
{
   this.setAttribute('name', this.id);
} 
```

当您还可以直接分配给 Javascript 代码中的事件处理程序属性时，这具有明显的优势：-

```
document.getElementById("someID").onclick = SomeMethod 
```

如果 SomeMethod 将上下文元素作为参数，那么设置起来会非常尴尬：-

```
function(id) {
   var elem = document.getElementById(id)
   elem.onclick = function() { SomeMethod(elem); }
}("someID"); 
```

更糟糕的是，这将是内存泄漏关闭。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-06-13T10:59:41.107

此时：`SomeMethod(this)`-`this`返回窗口对象，所以不要使用它。使用`this`关键字的正确方法是使其与上下文相关，所以使用`SomeMethod.call(this)`.

# internet-explorer - 如何在 Firefox 或 Internet Explorer 中模拟双击

> ID：619515
> 
> 赞同：0
> 
> 时间：2009-03-06T16:39:33.267
> 
> 标签：internet-explorer, firefox, browser, user-interface

是否有任何插件可以模拟任何主要浏览器中的双击？

我正在尝试测试一些防止双击表单提交按钮的代码，并且希望能够使用热键或鼠标中键向浏览器发送双击。

谢谢唐

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T19:16:56.427

我自己没有使用过它，但我听说过[Selenium](http://seleniumhq.org/)的好东西，这是一组用于测试网站的工具。我想您可以编写一个可以毫无延迟地单击两次的测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T16:48:51.903

我要做的是：

```
<input id="btn" type="submit" onclick="disableDblClick('btn')"/>

<script type="text/javascript">
function disableDblClick(obj)
{
    document.getElementById(obj).disabled = true;
    setTimeout("document.getElementById('btn').disabled = false", 100);
} 
```

这样做是禁用按钮 100 毫秒。我没有对此进行测试，但它应该可以工作，并且它将是跨浏览器的。并适当改变时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T16:50:05.893

这是用于手动测试吗？如果是这样，您可以使用 Microsoft 鼠标和 IntelliPoint。这将允许您将鼠标滚轮单击配置为双击。我敢肯定还有其他鼠标供应商做类似的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T16:53:29.647

观察：您并没有真正测试双击。您正在测试“不止一次点击”。即使两次单击之间的时间距离为 5 秒，您仍然希望禁用表单提交按钮，不是吗？

所以我认为你已经解决了你自己的问题：只需单击两次！

# c# - 为什么我的 C# 方法没有被调用？

> ID：619518
> 
> 赞同：5
> 
> 时间：2009-03-06T16:39:51.300
> 
> 标签：c#, .net

为什么我`X`下面的方法没有被调用？！

```
static class Program
{
    private static void Main()
    {
       X((IEnumerable<int>)null);
    }

    public static IEnumerable<T> X<T>(IEnumerable<T> e)
    {
        if (e == null)
            throw new ArgumentNullException();
        yield break;
    }
} 
```

我尝试进入调试器，但它没有进入`X`！关键字是否会`yield break`引起一些我不知道的副作用？

如果值得的话，我将使用带有 .NET 3.5 SP1 的 Visual Studio 2008 Express。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-06T16:43:19.717

X2 是一个迭代器并且被延迟执行。在您尝试从返回的 IEnumerable 实例中获取值之前，它不会实际运行。您可以通过将函数分成两部分来解决此问题以获得您实际想要的行为。

```
 public static IEnumerable<T> X2<T>(IEnumerable<T> e)
   {
        if (e == null)
            throw new ArgumentNullException();
        return X2Helper(e);
    }

    private static IEnumerable<T> X2Helper<T>(IEnumerable<T> e)
    {
        yield break;
    } 
```

Eric 有一篇关于这个主题的精彩博文：http: [//blogs.msdn.com/ericlippert/archive/2008/09/08/high-maintenance.aspx](http://blogs.msdn.com/ericlippert/archive/2008/09/08/high-maintenance.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T16:44:02.070

是的，在调用 IEnumerable 的 GetEnumerator 方法之前，不会调用该方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T16:48:38.003

您的 Main() 方法也需要公开。否则，其他程序集无法调用您的类的 Main() 方法作为应用程序的起点。

# c# - 如何告诉 VS 2008 停止在我的文件前面放置字节顺序标记？

> ID：619522
> 
> 赞同：3
> 
> 时间：2009-03-06T16:41:12.123
> 
> 标签：c#, visual-studio, visual-studio-2008, version-control, unicode

默认情况下，Visual Studio 2008 将 Unicode 字节顺序标记放在您保存的任何文件的前面。您可以通过转到*文件>高级保存选项*并选择不同的编码来覆盖每个文件。

如何告诉 VS 对特定项目或解决方案中的所有文件使用默认编码？这极大地破坏了源代码控制，因为我们有一些用户使用 VS 提交文件，而另一些用户则没有，从而创建了“虚幻的”提交。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T13:57:58.840

据我所知，在 VS 2008 中没有全局设置编码的选项。在我拥有“高级另存为”的特快版中，唯一可以更改编码的选项。

但是有一个解决方法 - 您可以通过将计算机区域设置设置为例如英语来让 Visual Studio 使用不同的编码。这反过来会迫使 VS 使用“西欧 - Codepade 1252”而不是“Unicode UTF-8 - Codepage 65001”。同样，这适用于 Express 版本，我很确定它会在完整的应用程序中使用。

希望有帮助...

F。

# .net - 你的 log4net 配置中有什么？黑客、优化、观察？

> ID：619532
> 
> 赞同：19
> 
> 时间：2009-03-06T16:43:09.810
> 
> 标签：.net, optimization, logging, log4net

这是我的 log4net 配置文件

```
<?xml version="1.0" encoding="utf-8" ?>
<log4net debug="true">
  <appender name="ConsoleAppender" type="log4net.Appender.ConsoleAppender" >
    <filter type="log4net.Filter.LevelRangeFilter">
      <acceptOnMatch value="true" />
      <levelMin value="DEBUG" />
      <levelMax value="FATAL" />
    </filter>
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%-5p %5rms [%-17.17t] %-22.22c{1} %-18.18M - %m%n" />
    </layout>
  </appender>

  <appender name="SmtpAppender" type="MySmtpClientSmtpAppender">
    <to value="a@a.com" />
    <from value="admin@x.com" />
    <subject value="Game Server Monitoring Failed!" />
    <smtpHost value="smtp.x.com" />
    <username value="admin" />
    <password value="x" />
    <bufferSize value="256" />
    <lossy value="true" />
    <evaluator type="log4net.spi.LevelEvaluator">
      <threshold value="ERROR" />
    </evaluator>
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%-5p %d [ThreadId: %t] Class:%c{1} Method:%M %nMESSAGE:%n%m%n%n" />
    </layout>
  </appender>

  <appender name="RollingLogFileAppender" type="log4net.Appender.RollingFileAppender">
    <file value="Logs\\wwwlog" />
    <appendToFile value="true" />
    <datePattern value="yyyyMMdd" />
    <maximumFileSize value="10MB" />
    <!--<rollingStyle value="Date" />-->
    <filter type="log4net.Filter.LevelRangeFilter">
      <acceptOnMatch value="true" />
      <levelMin value="INFO" />
      <levelMax value="FATAL" />
    </filter>
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%date [%thread] %-5level %logger [%ndc] - %message%newline" />
    </layout>
  </appender>

  <root>
    <level value="DEBUG" />
    <appender-ref ref="ConsoleAppender" />
    <appender-ref ref="MySmtpAppender" />
    <appender-ref ref="RollingLogFileAppender" />
  </root>
</log4net> 
```

我错过了什么吗？有什么提示/建议可以减少日志大小，同时保持清晰、更好的转换模式？有什么有趣的小技巧吗？

编辑：XMl 文件没有进入代码块。更新。有什么建议吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2011-07-31T15:19:35.463

没有人提到编码。如果您使用中文、日文、阿拉伯文或任何双字节语言记录消息，这一点非常重要。这是一个例子：

```
<appender name="RollingFile" type="log4net.Appender.RollingFileAppender">
  <encoding value="utf-8" />
  <!-- etc. -->
</appender> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-06T17:08:02.340

RollingLogFileAppender 的一个建议是使用最小的lockingModel。使用此设置，日志文件不会被锁定，而是在每次写入时打开然后关闭。

```
<lockingModel type="log4net.Appender.FileAppender+MinimalLock" /> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-06T16:53:29.880

根据消息级别（调试、信息、错误或致命）在控制台上显示时使用不同颜色进行日志记录。第二个附加程序是将其保存在文件中：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
   <configSections>
     <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler,log4net" />
   </configSections>

<log4net debug="false">
  <appender name="trace" type="log4net.Appender.TraceAppender, log4net">
    <layout type="log4net.Layout.PatternLayout,log4net">
      <param name="ConversionPattern" value="%d [%t] %-5p %c - %m%n" />
    </layout>
  </appender>

 <appender name="ColoredConsoleAppender" type="log4net.Appender.ColoredConsoleAppender,log4net">
   <mapping>
    <level value="ERROR" />
    <foreColor value="White" />
    <backColor value="Red" />
  </mapping>
  <mapping>
    <level value="DEBUG" />
    <foreColor value="White" />
  </mapping>
  <mapping>
    <level value="INFO" />
    <foreColor value="Green" />
  </mapping>

  <layout type="log4net.Layout.PatternLayout">
    <param name="ConversionPattern" value="%d [%t] %-5p %c - %m%n" />
  </layout>
</appender>

<appender name="RollingFile" type="log4net.Appender.RollingFileAppender,log4net" >
  <param name="File" value="Logs/NSCurrent.log" />
  <param name="AppendToFile" value="true" />
  <param name="RollingStyle" value="Date" />
  <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
  <datePattern value="yyyy-MM-dd" />
  <layout type="log4net.Layout.PatternLayout,log4net">
    <param name="ConversionPattern" value="%d [%t] %-5p %c - %m%n" />
  </layout>
</appender>

  <root>
    <priority value="DEBUG" />
    <appender-ref ref="RollingFile" />
    <appender-ref ref="ColoredConsoleAppender" />
  </root>
 </log4net>
 </configuration> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-05T10:06:12.947

要减小日志文件大小，您可以尝试调整 ConversionPattern：

这是我使用的格式：

```
 <layout type="log4net.Layout.PatternLayout,log4net">
    <!-- a reduced format, saves bit of log space: -->
    <param name="ConversionPattern" value="%date{MM/dd HH:mm:ss,fff}-{%level}-%message%newline"/>
  </layout> 
```

前：

2012-06-05 10:58:40,819 [1] 信息我的应用程序 [(null)] - 我的应用程序 - ===开始....

后：

06/05 11:17:29,151-{INFO}-我的应用程序 - ===开始...

注意：来自 Apache 的文档对于 log4net 似乎是不正确的——因为它说使用 SSS 毫秒，而 log4net 使用 fff

每条线的小幅节省可能会产生很大的影响:)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-06T16:57:33.207

我运行一个非常小的 log4net 配置并且更喜欢使用 XML 格式，但我建议添加的一件事（对于 Web 应用程序）是 ASP.NET 跟踪附加程序。您只需添加以下内容：

```
<appender name="AspNetTraceAppender" type="log4net.Appender.AspNetTraceAppender" >
   <layout type="log4net.Layout.PatternLayout" />
</appender> 
```

然后在你的根记录器，或者你决定激活它的任何地方：

```
<root>
   <level value="WARN" />
   <appender-ref ref="XmlSchemaFileAppender" />
   <appender-ref ref="AspNetTraceAppender" />
</root> 
```

当我在调试一些细微的 ASP.NET 细节时，这使我可以将所有相关的调试数据放在一个页面上。大多数时候，我将 ASP.NET 跟踪附加程序注释掉以禁用它，但在少数情况下确实起到了帮助作用，尤其是当您试图找出导致应用程序挂起的特定服务器回发方法时.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-06T16:50:09.403

这可能会有所帮助，具体取决于 log4j 和 log4net 的相似程度，我认为它们基于相同的规范，但我不确定。

好吧，我不能告诉你我的 log4net 配置中有什么，但如果足够好，我可以告诉你我的 log4j 配置中有什么......

```
<?xml version="1.0" encoding="UTF-8"?>
<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">

    <!--
    <appender name="CHAINSAW_APPENDER"
            class="org.apache.log4j.net.SocketAppender">
        <param name="RemoteHost" value="localhost" />
        <param name="Port" value="4445" />
        <param name="LocationInfo" value="true"/>
        <param name="ReconnectionDelay" value="10000"/>
    </appender>
    -->

    <appender name="FILE_APPENDER"
        class="org.apache.log4j.RollingFileAppender">
        <param name="File" value="c:/dev/logs/OSB.log" />
        <param name="Append" value="true" />
         <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d [%t] %-5p [[[[%c]]]] (((%F:%L))) ___%C___ - %m%n"/>
            </layout>
    </appender>

    <logger name="org.apache">
        <level value="WARN"/>
    </logger>

    <!--
    <logger name="com.conciliarpress.webapp.filter.GZIPFilte">
        <level value="WARN"/>
    </logger>

    <logger name="com.conciliarpress">
        <level value="DEBUG"/>
    </logger>

    <logger name="BibleFormControllerTest">
        <level value="DEBUG"/>
    </logger>

    <logger name="com.conciliarpress.webapp.action.sample.jmesa.JMesaSampleController">
        <level value="DEBUG"/>
    </logger>

    <logger name="com.conciliarpress.webapp.action.binding">
        <level value="DEBUG"/>
    </logger>

    <logger name="org.springframework.web.servlet.mvc">
        <level value="DEBUG"/>
    </logger>

    <logger name="org.directwebremoting">
        <level value="DEBUG"/>
    </logger>

    <logger name="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <level value="DEBUG"/>
    </logger>

    -->

    <logger name="com.conciliarpress.dao.hibernate">
        <level value="DEBUG"/>
    </logger>

    <logger name="com.conciliarpress.service.impl">
        <level value="DEBUG"/>
    </logger>

    <logger name="com.conciliarpress.service.dwr">
        <level value="DEBUG"/>
    </logger>

    <logger name="com.conciliarpress.webapp.action">
        <level value="DEBUG" />
    </logger>

    <root>
        <level value="WARN" />
        <appender-ref ref="FILE_APPENDER"/>
    </root>

</log4j:configuration> 
```

我也有相应的电锯配置文件：

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE log4j:configuration PUBLIC "-//log4j/log4j Configuration//EN" "log4j.dtd"> 
<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/" debug="true">
   <plugin name="logFileReceiver" class="org.apache.log4j.varia.LogFilePatternReceiver">
     <param name="fileURL" value="file:///c:/dev/logs/OSB.log" />
     <param name="timestampFormat" value="yyyy-MM-d HH:mm:ss,SSS"/> 
     <param name="logFormat" value="TIMESTAMP [THREAD] LEVEL [[[[LOGGER]]]] (((FILE:LINE))) ___CLASS___ - MESSAGE"/> 
     <param name="name" value="DLA_M_LogFile" />
     <param name="tailing" value="true" /> 
   </plugin>

   <root>
      <level value="debug"/>
   </root>
</log4j:configuration> 
```

这里还有一些信息可以帮助您区分后一个文件： [http ://wiki.apache.org/logging-log4j/Configuring_a_log4j_RollingFileAppender_with_Chainsaw](http://wiki.apache.org/logging-log4j/Configuring_a_log4j_RollingFileAppender_with_Chainsaw)

# unix - 在终端中执行自己的 Unix 命令？

> ID：619537
> 
> 赞同：0
> 
> 时间：2009-03-06T16:44:09.823
> 
> 标签：unix, terminal, bash

我创建了一个 Unix 命令 macmac2unix，它将 Mac 的 Word 文件转换为 Unix 平台。

我想将命令运行为

```
$macmac2unix file1 file2 file3 ... 
```

**问题：** 如何在每个路径中运行此命令？

我将以下内容添加到 .bashrc 失败

```
CDPATH=:/Users/Sam/Documents/Unix 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T16:47:21.640

尝试添加

```
export PATH=$PATH:/Users/Sam/Documents/Unix 
```

到你的 .bashrc

确保您的脚本可执行，确保它位于 /Users/Sam/Documents/Unix 中。你可以重新阅读你的 .bashrc ：

```
~> . ~/.bashrc 
```

但是，如果您已经使用了环境变量，那么重新启动终端会更干净。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T16:47:01.797

将它添加到 PATH，而不是 CDPATH。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T16:47:28.270

尝试将其添加到 PATH 中，如下所示：

```
PATH=/Users/Sam/Documents/Unix:$PATH 
```

# web-services - 如何模拟挂起的 Web 服务？

> ID：619541
> 
> 赞同：0
> 
> 时间：2009-03-06T16:45:29.120
> 
> 标签：web-services, http, web-applications, cgi

我正在尝试测试与 Web 服务交互的软件的故障模式，并且我已经报告了如果软件没有得到及时响应（例如，它等待一分钟或更长时间）就会出现问题的问题. 我想对此进行模拟，以便我可以自己追踪并修复问题，但拔掉网络连接并不能解决问题，因为它会立即返回而找不到路由。

我想知道的是，有没有一种简单的方法可以制作一个接受连接但只是坐在那里的 CGI 脚本，让连接保持活动几分钟，而无需执行某种`while (true) {}`循环？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T16:48:58.487

让脚本休眠一段时间（很长时间）怎么样？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T16:50:19.700

我不知道您使用什么语言编写脚本，但在 .net 中您可以执行类似的操作`Thread.Sleep(6000);`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T16:53:21.300

HTTP Fiddler 非常适合这种事情。您可以模拟慢速连接，如果需要，可以在请求进入时让它“中断”，这样您就可以模拟永远不会返回的响应。

从这里获取它... [http://www.fiddlertool.com/fiddler/](http://www.fiddlertool.com/fiddler/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T16:51:28.777

您将不得不以某种方式空闲，因为如果您的 CGI 脚本返回连接将被关闭。

如果您的网络设备支持节流，您可能希望将传出流量限制在非常低的水平。

# windows - 进程优先级是否继承？

> ID：619543
> 
> 赞同：2
> 
> 时间：2009-03-06T16:46:32.097
> 
> 标签：windows, inheritance, process, windows-task-scheduler

想象一下，您有一个 Windows 进程 A 以 AboveNormal 的优先级运行，它启动另一个进程 B 而没有指定优先级。进程 B 的优先级是否继承自进程 A 的优先级？那么，进程 B 的优先级是什么？高于正常、正常还是其他？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-09-26T15:50:04.087

**如果未指定，则在某些情况下****会**继承优先级类。

 **当调用进程在**IDLE_PRIORITY_CLASS**或**BELOW_NORMAL_PRIORITY**类中时会发生这种情况。否则，除非在 CreateProcess 调用期间指定，否则它将获得**NORMAL_PRIORITY_CLASS 。**

MSDN 在 CreateProcess 的 dwCreationFlags 上说：

> 该参数还控制新进程的优先级，用于确定进程线程的调度优先级。有关值的列表，请参阅 GetPriorityClass。如果没有指定优先级类标志，则优先级类默认为 NORMAL_PRIORITY_CLASS，除非创建进程的优先级类是 IDLE_PRIORITY_CLASS 或 BELOW_NORMAL_PRIORITY_CLASS。在这种情况下，子进程接收调用进程的默认优先级。

因此，答案是 NORMAL 优先级。基本上任何高于正常水平的东西都不会传递给孩子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T16:55:43.307

从[CreateProcess](http://msdn.microsoft.com/en-us/library/ms682425.aspx)的文档中：

> dwCreationFlags [in]
> 
> 控制优先级和进程创建的标志。有关值的列表，请参阅进程创建标志。
> 
> 该参数还控制新进程的优先级，用于确定进程线程的调度优先级。有关值的列表，请参阅 GetPriorityClass。如果没有指定任何优先级标志，则优先级默认为 NORMAL_PRIORITY_CLASS，除非创建进程的优先级是 IDLE_PRIORITY_CLASS 或 BELOW_NORMAL_PRIORITY_CLASS。在这种情况下，子进程接收调用进程的默认优先级。

因此，在您的示例中，新进程将具有正常优先级。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-06T16:57:19.777

在 Windows 中，进程优先级不被继承。

# php - 将输出流式传输到文件和浏览器

> ID：619557
> 
> 赞同：13
> 
> 时间：2009-03-06T16:49:12.417
> 
> 标签：php, caching, output-buffering

所以，我正在寻找比这更有效的东西：

```
<?php
ob_start();
include 'test.php';
$content = ob_get_contents();

file_put_contents('test.html', $content);

echo $content;
?> 
```

上述问题：

*   在呈现整个页面之前，客户端不会收到任何内容
*   文件可能很大，所以我宁愿不把整个东西都放在内存中

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T17:14:47.877

有趣的问题；不要以为我以前尝试过解决这个问题。

我认为您需要从您的前端 PHP 脚本向您的服务器发出第二个请求。这可能是对[http://localhost/test.php](http://localhost/test.php)的简单调用。如果您使用 fopen-wrappers，您可以使用 fread() 在渲染时提取 test.php 的输出，并在收到每个块后，将其输出到屏幕并将其附加到您的 test.html 文件中。

以下是它的外观（未经测试！）：

```
<?php
$remote_fp = fopen("http://localhost/test.php", "r");
$local_fp = fopen("test.html", "w");
while ($buf = fread($remote_fp, 1024)) {
    echo $buf;
    fwrite($local_fp, $buf);
}
fclose($remote_fp);
fclose($local_fp);
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-05-07T15:41:27.707

更好的方法是使用`ob_start`:`output_callback`和. 接受的前两个参数`chunk_size`。前者指定一个回调来处理缓冲的输出，后者指定要处理的输出块的大小。

这是一个例子：

```
$output_file = fopen('test.html', 'w');
if ($output_file === false) {
    // Handle error
}

$write_ob_to_file = function($buffer) use ($output_file) {
    fwrite($output_file, $buffer);

    // Output string as-is
    return false;
};

ob_start($write_ob_to_file, 4096);
include 'test.php';
ob_end_flush();

fclose($output_file); 
```

在此示例中，每输出 4096 个字节（并在调用结束时再一次），将刷新（发送）输出缓冲区`ob_end_flush`。每次刷新缓冲区时，`$write_ob_to_file`都会调用回调并传递最新的块。这被写入 test.html。然后回调返回`false`，意思是“按原样输出这个块”。如果您只想将输出写入文件而不是 PHP 的输出流，则可以改为返回一个空字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T18:00:40.530

Pix0r 的答案是你想要的，除非你真的需要它“包含”而不是仅仅执行。例如，如果您在 test.php 之前有登录信息，如果您使用 fopen 调用它，它将不会被传递到文件中。

如果您需要真正包含它，那么您所拥有的是最简单的方法，但如果您想要持续输出，您需要实际编写 test.php 以输出和存储信息的方式。据我所知，没有办法既收集缓冲区又随时输出。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-06T18:12:41.483

在这里你可以使用[x-send-file](http://codeutopia.net/blog/2009/03/06/sending-files-better-apache-mod_xsendfile-and-php/)，使用 mod_xsendfile 来高效地发送文件，真的很简单。

# eclipse - Eclipse：构建并符合不同的 JRE 版本

> ID：619560
> 
> 赞同：1
> 
> 时间：2009-03-06T16:49:38.530
> 
> 标签：eclipse, java

有没有办法使用一个版本的 JRE 构建我的应用程序，但让我的源代码符合另一个版本？

我想使用 1.6 在本地调试我的应用程序，因为 OS X 的 1.6 比 1.4.2 好得多，但由于向后兼容的原因，我们实际上使用 1.4.2 发布。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T16:59:55.323

您可以通过运行配置选项来管理它。创建一个新的运行配置 --> Java 应用程序，然后您可以指定要用于该配置的 JRE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T19:03:25.730

或者可以更改您的运行配置，但您也可以更改项目属性以执行此操作，以便您决定运行的任何类都将执行此操作。

# c# - IEnumerator 和 IEnumerable 有什么区别？

> ID：619564
> 
> 赞同：115
> 
> 时间：2009-03-06T16:50:46.267
> 
> 标签：c#, .net, ienumerable, ienumerator

> **可能重复：**
> [任何人都可以向我解释 IEnumerable 和 IEnumerator 吗？](https://stackoverflow.com/questions/558304/can-anyone-explain-ienumerable-and-ienumerator-to-me)

IEnumerator 和 IEnumerable 有什么区别？

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2009-03-06T16:52:16.480

[IEnumerable](http://msdn.microsoft.com/en-us/library/system.collections.ienumerable.aspx)是一个接口，它定义了一个方法**GetEnumerator**，它返回一个**[IEnumerator](http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.aspx)**接口，这反过来又允许对集合进行只读访问。实现 IEnumerable 的集合可以与 foreach 语句一起使用。

定义

```
IEnumerable 

public IEnumerator GetEnumerator();

IEnumerator

public object Current;
public void Reset();
public bool MoveNext(); 
```

[来自 codebetter.com 的示例代码](http://codebetter.com/blogs/david.hayden/archive/2005/03/08/59419.aspx)

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2009-03-06T17:10:18.387

An`IEnumerator`是一个可以枚举的东西：它具有`Current`属性和`MoveNext`and`Reset`方法（在 .NET 代码中您可能不会显式调用它们，尽管您可以）。

An`IEnumerable`是一个可以枚举的东西......这仅仅意味着它有一个 GetEnumerator 方法，该方法返回一个`IEnumerator`.

你用哪个？使用的唯一原因`IEnumerator`是，如果您有某种非标准的枚举方式（即，一个接一个地返回其各种元素），并且您需要定义其工作方式。您将创建一个实现`IEnumerator`. 但是你仍然需要`IEnumerator`在`IEnumerable`课堂上返回它。

要查看枚举器（实现`IEnumerator<T>`）的样子，请查看任何`Enumerator<T>`类，例如包含在或`List<T>`中的类。要查看实现的类，请参阅任何标准集合类。`Queue<T>,``Stack<T>``IEnumerable`

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-03-06T18:00:44.540

向您显示`Enumerator`列表或集合中的项目。Enumerator 的每个实例都位于某个位置（第 1 个元素、第 7 个元素等），并且可以为您提供该元素 ( `IEnumerator.Current`) 或移动到下一个 ( `IEnumerator.MoveNext`)。当您`foreach`在 C# 中编写循环时，编译器会生成使用枚举器的代码。

An`Enumerable`是一个可以给你`Enumerator`s 的类。它有一个名为的方法`GetEnumerator`，它为您提供了一个`Enumerator`查看其项目的方法。当您`foreach`在 C# 中编写循环时，它生成的代码调用`GetEnumerator`以创建`Enumerator`循环使用的循环。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-06T16:52:03.377

`IEnumerable`并且`IEnumerator`都是接口。`IEnumerable`只有一种方法称为`GetEnumerator`. 此方法返回（因为所有方法都返回包括 void 在内的内容）另一种类型，它是一个接口，该接口是`IEnumerator`. 当您在任何集合类中实现枚举器逻辑时，您就实现`IEnumerable`了（通用或非通用）。`IEnumerable`只有一个方法，而`IEnumerator`有 2 个方法（`MoveNext`和`Reset`）和一个属性`Current`。为了便于理解，将`IEnumerable`其视为一个包含`IEnumerator`在其中的盒子（尽管不是通过继承或包含）。请参阅代码以更好地理解：

```
class Test : IEnumerable, IEnumerator
{
    IEnumerator IEnumerable.GetEnumerator()
    {
        throw new NotImplementedException();
    }

    public object Current
    {
        get { throw new NotImplementedException(); }
    }

    public bool MoveNext()
    {
        throw new NotImplementedException();
    }

    public void Reset()
    {
        throw new NotImplementedException();
    }
} 
```

# java - OSX 上 JVM 的僵尸 http.proxyHost 设置

> ID：619567
> 
> 赞同：5
> 
> 时间：2009-03-06T16:51:37.887
> 
> 标签：java, eclipse, macos, proxy, jvm

我最近更改了网络并从 OSX (Leopard) 上的系统偏好设置/网络面板中删除了所有 HTTP 代理设置。但是，现在每当我使用 Eclipse 时，Java HTTP 代理系统属性似乎都“自动”设置为使用我现在已失效的 HTTP 代理。

**我在我的系统上的任何地方**都找不到对这个代理的**直接引用**，我已经删除并重新安装了 Eclipse，已经监视了网络流量以排除任何代理自动配置，但是这个代理配置仍然存在于 Mac OSX JVM 上。

 **这是我在 Eclipse 配置详细信息中看到的：

```
http.proxyHost=zombie
http.proxyPort=8080
https.proxyHost=zombie
https.proxyPort=8080 
```

我可以通过在 Eclipse 首选项中手动配置没有主机名或端口的代理来解决这个问题，但这似乎并没有坚持下去，僵尸系统代理最终起死回生。

我个人认为这是某种 Apple JVM 错误 - 但谁能告诉我如何在不重新安装操作系统的情况下永久杀死这些僵尸 HTTP 代理设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T18:33:51.043

Check the values in

```
/System/Library/Frameworks/JavaVM.framework/Home/lib/net.properties 
```

There are comments in that file saying proxy settings (from net.properties) are used only *if there are no proxy settings in System Preferences*. I'm wondering if something updated your net.properties file, setting proxy info. Now that you have no proxy settings (in System Preferences), the values in net.properties are actually being used.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T18:30:18.150

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-21T19:41:22.820

我猜你们是任务的东西。查看该属性的评论

```
# MacOSX:
# On MacOSX, setting java.net.useSystemProxies to true or false is a no-op.
# Proxy settings from System Preferences are always used and they override any
# settings specified in this file. Values from this file are only used if there
# are no proxy settings in System Preferences.
# See Release Notes for more information.

java.net.useSystemProxies=false 
```

# python - python 会为代理提供足够的性能吗？

> ID：619575
> 
> 赞同：2
> 
> 时间：2009-03-06T16:52:36.357
> 
> 标签：python, performance, proxy

我想开始编写一个 http 代理，它将根据我将配置的一些规则/过滤器修改响应。但是，在开始编写代码之前，我想确保我在使用 Python 时做出了正确的选择。后来，这个工具必须能够处理很多请求，所以，我想知道我以后可以指望它能够在“迫不得已”时执行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T16:55:56.923

只要大部分处理使用 Python 的内置模块，就性能而言应该没问题。Python 的最大优势在于其清晰的语法和易于测试/可维护性。如果您发现代码的某个部分减慢了进程，您可以重写该部分并将其用作 C 模块，同时将大部分控制代码保留在 Python 中。

但是，如果您希望制作最优化的 Python 代码，您可能需要查看[这篇 SO 帖子](https://stackoverflow.com/questions/172720/speeding-up-python)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T17:00:36.650

这将取决于您使用的库而不是语言本身。众所周知， 扭曲的[框架可以很好地扩展。](http://twistedmatrix.com/trac/)

这是[python/twisted](http://wiki.python.org/moin/Twisted-Examples)中的代理服务器示例，可帮助您入门。

底线：明智地选择您的第三方工具，我相信您会没事的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T17:02:41.980

是的，我认为您会发现 Python 完全可以满足您的需求。有大量的 Web 框架、WSGI 库等可供选择，或者在构建自己的框架时从中学习。

[Python History 博客](http://python-history.blogspot.com/)上有一篇有趣[的文章](http://python-history.blogspot.com/2009/01/microsoft-ships-python-code-in-1996.html)，介绍了 Python 在 1996 年是如何支持高性能网站的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-06T17:11:58.133

Python 在大多数任务上都表现得很好，但是如果你习惯了其他语言，你就需要改变你的编程方式。有关更多信息，请参阅[Python 不是 Java](http://dirtsimple.org/2004/12/python-is-not-java.html)。

如果普通的旧 CPython 不能提供您需要的性能，那么您还有其他选择。
如前所述，您可以在 C 中扩展它（使用[swig](http://www.swig.org/)或[Pyrex](http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/)之类的工具）。我也听说过有关[PyPy](http://codespeak.net/pypy/dist/pypy/doc/)的好消息，但请记住，它使用 Python 的受限子集。最后，很多人使用[psyco](http://psyco.sourceforge.net/)来提高性能。

# asp.net-mvc - ASP.net MVC [HandleError] 未捕获异常

> ID：619582
> 
> 赞同：39
> 
> 时间：2009-03-06T16:54:30.423
> 
> 标签：asp.net-mvc, exception-handling, handleerror

在两个不同的应用程序中，一个是自定义的，另一个是您使用新的 VS2008 MVC 项目获得的示例 MVC 应用程序，[HandleError] 没有捕获异常。

在示例应用程序中，我有：

```
[HandleError]
public class HomeController : Controller
{
    public ActionResult Index()
    {
        ViewData["Message"] = "Welcome to ASP.NET MVC!";
        throw new Exception();
        return View();
    }

    public ActionResult About()
    {
        return View();
    }
} 
```

这只是默认控制器，但会抛出异常以进行测试。

但它不起作用。它不会转到默认的 error.aspx 页面，而是在浏览器中显示调试信息。

该问题首先出现在我正在处理的自定义应用程序中，这导致我使用示例应用程序对其进行测试。考虑到这与我在自定义应用程序中所做的更改有关，我完全没有改变示例应用程序，只在 index 方法中抛出异常（糟糕）。

我难住了。我错过了什么？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-03-06T17:30:36.437

在 Web.config 中，更改 customErrors：

```
<system.web>
  <customErrors mode="On">
  </customErrors> 
```

如果模式为 Off 或 RemoteOnly，那么您将看到黄屏死机，而不是自定义错误页面。原因是开发人员通常希望在黄屏死机上获得更详细的信息。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-20T01:52:06.773

**重要提示：**请注意您的错误页面本身没有错误！

如果是这样，您最终会看到那个 ASP.NET 自定义错误页面，最终会绕圈子，把头发扯掉。只需从页面中删除可能导致错误的所有内容并进行测试。

此外，关于“customErrors”的开启或关闭，是否会显示友好的错误页面（您的 Errors.aspx）页面有几个影响因素。

请参阅[此博客](http://weblogs.asp.net/leftslipper/archive/2008/07/13/httpcontext-iscustomerrorenabled-one-of-asp-net-s-hidden-gems.aspx)（以下除外）

> HttpContext.IsCustomErrorEnabled - 查看三个不同的来源
> 
> 1.  web.config 的 <deployment> 部分的零售属性。这是在将应用程序部署到生产服务器时设置的有用属性。这会覆盖自定义错误的任何其他设置。
> 2.  web.config 的 <customErrors> 部分的 mode 属性。此设置指示是否完全启用自定义错误，如果启用，是否仅对远程请求启用。
> 3.  HttpRequest 对象的 IsLocal 属性。如果仅对远程请求启用自定义错误，您需要知道该请求是否来自远程计算机。

这里的想法是，您可以在开发期间关闭“customErrors” - 当您确实想查看错误时，然后仅将其启用用于生产。

此[MSDN 文章](http://msdn.microsoft.com/en-us/library/dd410203.aspx)进一步讨论了该属性。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-07-27T14:21:30.947

这个问题的另一个原因可能是，

在 Template MVC Application（由 VS2008 / VS2008 Express 生成）中，Error.aspx（由 VS 生成）使用 Master Page。

如果母版页访问任何 ViewData 它将抛出空引用 Exception ，那么 error.aspx 将不会显示。

使用此简单代码作为您的 Error.aspx ，它将解决问题，（连同 CustomErrors=On ）

```
<%@ Page Language="C#"  Inherits="System.Web.Mvc.ViewPage<System.Web.Mvc.HandleErrorInfo>" %>
<%= Model.Exception.Message %> 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-07-15T00:14:57.443

我也一直在努力解决这个问题，我相信我现在明白了这个问题。

简而言之，`[HandleError]`按预期工作的要求是：

***您必须在web.config*中启用自定义错误，并且还必须指定错误视图在`<customErrors>`标记中的位置。**

例子：

```
<customErrors mode="On" defaultRedirect="Error" /> 
```

省略该`defaultRedirect="Error"`部分将在浏览器中产生 500 错误，而不是 ASP.NET 错误页面 (YSOD)。

此外，您不必处于发布模式。我使用 Debug 版本对此进行了测试，效果很好。

我的环境是使用 .NET 4 和标准“ASP.NET MVC 2 Web 应用程序”项目模板的 Visual Studio 2010。

让我感到困惑的是 HandleErrorAttribute 类的 MSDN 文档。它没有明确说您必须在*web.config*中打开自定义错误。我认为我需要的只是`[Handle Error]`属性。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-11-12T15:33:24.437

*我曾经发生过一些愚蠢的情况，因此可能对某人有所帮助。*

确保您已添加`<customErrors mode="On" />`到**正确** `web.config`的文件。

* * *

*有时（尤其是当您使用 Resharper 之类的工具，并通过键入文件名而不是通过解决方案资源管理器打开文件时），您可以简单地从 Views 文件夹甚至从另一个项目打开 web.config。*

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-04-08T00:32:57.477

注意：在我的情况下，我试图让[`HandleError`](http://msdn.microsoft.com/en-us/library/system.web.mvc.handleerrorattribute%28v=vs.118%29.aspx)属性捕获s***构造函数***`exception`中的抛出！它当然不会抓住它。该属性仅捕获在*actions*中引发的异常。它就在 MSDN 页面中（应该更加注意这一点）：`Controller`*`HandleError``Controller`*

 **> 表示用于处理由操作方法引发的异常的属性。

发生的另一件事是控制器的`OnException(ExceptionContext exceptionContext)`重写方法从未被调用。再说一遍：当然不会调用它，因为我在`Controller`' 的构造函数中抛出了异常。

我花了 1 个小时试图弄清楚这一点。:o) 希望它能帮助下一个灵魂......

作为提示：请记住该`HandleError`属性仅捕获`500`错误。对于其他人，您应该[`<customErrors>`](http://msdn.microsoft.com/en-us/library/h0hfz6fc%28v=vs.100%29.aspx)在以下声明部分`Web.config`：

```
<customErrors mode="On">
  <error statusCode="403" redirect="~/403" />
  <error statusCode="404" redirect="~/404" />
</customErrors> 
```

# eclipse - 在 Eclipse 3.4 中是否有快速导出 WAR 文件的方法？

> ID：619584
> 
> 赞同：4
> 
> 时间：2009-03-06T16:55:18.657
> 
> 标签：eclipse

我知道 export->war 文件

我想要类似于 .jardesc 的东西，它允许您定义目的地。所以我可以右键单击那个 .jardesc 并导出。除了 .wardesc 而不是 .jardesc :)

战争导出功能是否与 eclipse ant 任务相关联？

我已经组合了一个 AHK 宏，所以它会为我做 GUI 动作......但这是一个黑客而不是解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T17:25:42.313

> 战争导出功能是否与 eclipse ant 任务相关联？

据我所知，是的。您可以尝试搜索可以为您执行此操作的插件；我找到了几个，例如[war-plugin builder](http://www.bigheadco.com/warplugineclipsebuilder)，但我自己没有尝试过，因为我尽量避免在 eclipse 中使用额外的插件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T00:19:56.587

有 Ant[`WAR`任务](http://ant.apache.org/manual/Tasks/war.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T10:44:54.820

进行“战争导出”的正确方法是使用构建系统（如 Maven）并让它完成繁重的工作。您只需要一个`pom.xml`with `<packaging>war</packaging>`。

Eclipse 的导出是为了人类偶尔的导出，而不是为了自动化。如果你真的想自动化，那就做对吧。你也会从其他事情中受益。相同的 pom 文件将在您的机器、其他开发人员的机器和您的构建服务器上运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T00:05:12.910

Eclipse 有外部命令的概念。如果您可以编写如您喜欢的方式进行导出的 ant 脚本，您可以从菜单/按钮启动它。对于 ant 脚本，您还可以选择要调用的 ant 目标并传递属性。这允许您编辑例如启动配置中的路径名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-15T10:07:31.773

WAR 蚂蚁任务

[http://ant.apache.org/manual/Tasks/war.html](http://ant.apache.org/manual/Tasks/war.html)

从文档中：

假设项目的基本目录中的结构如下：

```
thirdparty/libs/jdbc1.jar
thirdparty/libs/jdbc2.jar
build/main/com/myco/myapp/Servlet.class
src/metadata/myapp.xml
src/html/myapp/index.html
src/jsp/myapp/front.jsp
src/graphics/images/gifs/small/logo.gif
src/graphics/images/gifs/large/logo.gif 
```

然后使用创建的战争文件 myapp.war

```
<war destfile="myapp.war" webxml="src/metadata/myapp.xml">
  <fileset dir="src/html/myapp"/>
  <fileset dir="src/jsp/myapp"/>
  <lib dir="thirdparty/libs">
    <exclude name="jdbc1.jar"/>
  </lib>
  <classes dir="build/main"/>
  <zipfileset dir="src/graphics/images/gifs"
              prefix="images"/>
</war> 
```

将包括

```
WEB-INF/web.xml
WEB-INF/lib/jdbc2.jar
WEB-INF/classes/com/myco/myapp/Servlet.class
META-INF/MANIFEST.MF
index.html
front.jsp
images/small/logo.gif
images/large/logo.gif 
```

# asp.net - 在 ASP.net 中，是在 ASPX 页面中使用服务器控件还是在后面的代码中动态创建它们更好？

> ID：619588
> 
> 赞同：1
> 
> 时间：2009-03-06T16:56:23.977
> 
> 标签：asp.net, dynamic, controls

我通常更喜欢将控件（如表格和通用 html 控件）动态添加到 ASPX 页面，而不是在 ASPX 页面中添加它们并动态设置属性。

哪种方法被认为是“更好的做法”？

动态使用通用 html 控件是否比将格式化的 html 字符串输出到 asp:literal 更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T17:05:04.983

将它们保留在 .aspx 中
动态添加它们会导致视图状态问题，并且必须在每个帖子包中添加它们。我在构建用户生成的表单应用程序时遇到了这个问题。我分解并使用控件可见性属性作为解决方法。也就是说，如果您消除视图状态并从您的应用程序发回，这些对您来说可能不是问题。

[http://aspnet.4guysfromrolla.com/articles/092904-1.aspx](http://aspnet.4guysfromrolla.com/articles/092904-1.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T17:05:22.080

由于在这两种方法中，您最终都会得到一组添加控件并为其属性分配值的代码，因此最佳实践是最易读的方法。

由于复杂的决策逻辑，对于相当静态的控件布局，如果只需要修改属性，将控件放置在 ASPX 中会更直接，因此最好自己动手完成。

# python - 通过 Python/Django 在数据库中表示计划的最佳方式是什么？

> ID：619592
> 
> 赞同：0
> 
> 时间：2009-03-06T16:56:50.790
> 
> 标签：python, django, django-models, backup, django-forms

我正在用 Python 编写一个带有 Django 前端的备份系统。我决定以一种有点奇怪的方式实现调度——客户端将轮询服务器（每 10 分钟左右），以获取需要执行的备份列表。服务器仅在达到备份时间时才会响应。这是为了保持系统平台独立 - 这样我就不会依赖 cronjobs 或类似的东西。因此，Django 前端（它公开了一个 XML-RPC API）必须将调度存储在数据库中，并解释该调度以决定客户端是否应该开始备份。

目前，时间表使用 3 个字段存储：天、小时和分钟。这些是以逗号分隔的整数列表，表示一周中的天数 (0-6)、一天中的小时数 (0-23) 和一小时中的分钟数 (0-59)。要决定客户端是否应该开始备份是一个非常低效的操作——Python 必须循环从过去 7 天开始的所有天，然后是小时，然后是分钟。我已经做了一些优化以确保它不会循环太多 - 但仍然如此！

这工作相对较好，虽然实现相当丑陋。我遇到的问题是如何通过前端的 HTML 表单显示和解释这些信息。目前我只有大量的多选字段列表，这显然效果不佳。

任何人都可以建议一种不同的方法来实现更有效且更容易以 HTML 表单表示的时间表吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T17:39:35.167

看看[django-chronograph](http://code.google.com/p/django-chronograph/)。它有一个非常漂亮的界面，可以按各种时间间隔安排作业。你也许可以从中借鉴一些想法。它依赖于[python-dateutil](http://labix.org/python-dateutil)，您可能还会发现它对于指定重复事件很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-17T14:59:39.027

你的问题有点模棱两可——你的意思是：*“在每个星期日、星期一和星期五的时间 X 备份。”* ?

如果是这样，请使用[位掩码](https://en.wikipedia.org/wiki/Mask_(computing))将重复计划存储为整数：

假设您希望在周日、周一和周五进行上述备份。将星期几编码为整数（以二进制表示）：

```
S M T W T F S
1 1 0 0 0 1 0 = 98 
```

要确定今天（例如星期五）是否是备份日，只需按位执行`and`：

```
>>> 0b1100010 & 0b0000010 != 0
True 
```

要将当前日期作为整数获取，您需要将其偏移一，因为`weekday()`假设一周从星期一开始：

```
current_day = (timezone.now().weekday() + 1) % 7 
```

总之，您的`Schedule`对象的架构将类似于：

```
class Schedule(models.Model):
    days_recurrence = models.PositiveSmallIntegerField(db_index=True)
    time = models.TimeField() 
```

使用此模式，您需要`Schedule`在一天中的每个时间都需要一个新对象来备份。这是一个快速查找，因为按位运算大约需要 2 个周期，并且由于您正在索引 field `days_recurrence`，因此您有一个最坏情况的日查找，`O(logn)`它应该会大大降低您的复杂性。如果您想从中获得更多性能，您还可以使用一个*小时*的位掩码，然后存储分钟。

# apache - 阿帕奇和 c10k

> ID：619595
> 
> 赞同：7
> 
> 时间：2009-03-06T16:57:32.600
> 
> 标签：apache, c10k

Apache 在正常情况下如何处理[c10k 问题？](http://www.kegel.com/c10k.html)比如说在运行数据很少的非常小的脚本时，或者如果我使用 Apache 是否需要横向扩展？

在后台，一些繁重的工作是由一些运行专门软件来处理请求的服务器完成的，但我想使用 Apache 作为前端。这是一个可行的计划吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-30T20:08:51.067

我认为 Apache 更像是一个源服务器——运行类似 mod_php 或 mod_perl 的东西来生成内容，并且很聪明地路由到适当的系统。

如果您的站点前面有数千个并发点击，并且返回了混合类型的数据（静态和动态），那么您可能会发现在它前面放置一个更优化的系统很有用。

Apache 的经典优化后问题不是生成动态内容（或者至少可以在流程的早期进行优化），而只是等待慢速客户端能够接收正在发送的字节。因此，将 Squid 或 Nginx 形式的反向代理放在服务器前以接管慢速网络客户端的“勺子馈送”，同时允许内容生产充分进行，这可能是一个显着的优势速度，并且以本地网络速度 - 100Mb / 秒甚至千兆速度 - 如果它甚至必须遍历网络。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T16:44:40.340

我假设您可能已经看过[这些数据](http://www.acme.com/software/thttpd/benchmarks.html)，但如果没有，它可能会给您一些想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-25T20:46:14.233

伙计们，假设您正在运行具有 10K 连接（同时）的 Web 服务器。怎么会这样？

*   你每秒有很多很多的连接

    *   动态内容

        > 例如，您确定您的 CPU 可以处理那么多 PHP 会话吗？我想不，那你为什么要考虑 C10K 问题？:D

    *   静态内容 - 小文件

        > 还有很多联系吗？在单个服务器上？可能您也遇到了网络/吞吐量问题，或者您是 Google 的未来竞争对手。使用能够解决 C10K 问题且稳定的 lighttpd - fly light。将 Apache 仅用于大型站点的静态文件是显而易见的。

*   您的客户正在长时间下载大文件 - 静态内容

    *   ISO 映像、档案等

        > 如果您是通过 Web 服务器进行操作 - FTP 可能更合适。

    *   视频流

        > 使用 lighttpd 或专门的软件。仍然......其他资源呢？

我在 apache 服务器前使用 Linux 虚拟服务器作为负载平衡器（带有 LVS-NAT 的特定补丁），我很高兴 :) 这个字符串是您想听到的答案。

# windows - 使用 Windows 批处理文件安装 .inf 文件

> ID：619604
> 
> 赞同：6
> 
> 时间：2009-03-06T17:00:29.550
> 
> 标签：windows

当您右键单击 .inf 文件时，您可以选择“安装”。我想使用批处理文件从命令行安装 .inf 文件。这样做的“正确”方法是什么？

谢谢！

[编辑] 我应该澄清我正在尝试在 Windows XP（而不是 Vista）上运行它。尽管我认可（并赞成）以下提到 InfDefaultInstall.exe 的答案，但我相信该程序并未随 XP 一起提供。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-06T17:09:04.367

`HKCR\inffile\shell\Install\command`您可以在查看注册表项时找到该命令。在 Windows XP 上，这是

```
%SystemRoot%\System32\rundll32.exe setupapi,InstallHinfSection DefaultInstall 132 %1
```

在 Windows Vista 及更高版本上，这将是

```
%SystemRoot%\System32\InfDefaultInstall.exe "%1"
```

要在多个 Windows 版本中使用批处理文件，您需要一些技巧。您可以`reg.exe`用来查询键并尝试解析输出（我没有找到只从 中获取值的快速方法`reg`）。如果您知道您正在运行的平台，您还可以对命令行进行硬编码并根据 Windows 版本进行切换（这需要另一个 hack 才能找到。`%OS%`不幸的是，它只能告诉您“Windows NT” .)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-09T02:33:32.613

```
rem 测试/工作

:inf
版本 | findstr /il "版本 6。" > 无
如果 %ERRORLEVEL%==0 转到 :vista

:xp
开始/等待 rundll32.exe setupapi,InstallHinfSection DefaultInstall 4 %_%
转到：eof
:远景
%SystemRoot%\System32\InfDefaultInstall.exe "%_%"

:eof

```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-01-09T05:46:54.147

应该适用于任何具有 IE 4.0+ 的 Windows 系统：

```
RunDll32 advpack.dll,LaunchINFSection <file.inf>,DefaultInstall 
```

# php - 什么是 PHP 字符串是否以另一个字符串结尾的最有效测试？

> ID：619610
> 
> 赞同：129
> 
> 时间：2009-03-06T17:03:46.080
> 
> 标签：php, string, performance

`$str`测试字符串是否以子字符串结尾的标准 PHP 方法`$test`是：

```
$endsWith = substr( $str, -strlen( $test ) ) == $test 
```

这是最快的方法吗？

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2009-03-06T17:37:37.450

阿萨夫说的是对的。PHP中有一个内置函数可以做到这一点。

```
substr_compare($str, $test, strlen($str)-strlen($test), strlen($test)) === 0; 
```

如果`$test`比`$str`PHP 长，会给出警告，所以你需要先检查一下。

```
function endswith($string, $test) {
    $strlen = strlen($string);
    $testlen = strlen($test);
    if ($testlen > $strlen) return false;
    return substr_compare($string, $test, $strlen - $testlen, $testlen) === 0;
} 
```

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2010-01-26T04:40:55.257

这种方法在内存上有点贵，但速度更快：

```
stripos(strrev($haystack), $reversed_needle) === 0; 
```

当您确切地知道针是什么时，这是最好的，因此您可以对其进行硬编码。如果您以编程方式反转指针，它会比以前的方法慢。

* * *

## 回答 #3

> 赞同：63
> 
> 时间：2016-04-12T09:41:42.357

```
$endsWith = substr_compare( $str, $test, -strlen( $test ) ) === 0 
```

负偏移“从字符串的末尾开始计数”。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2011-03-09T23:49:30.820

这是一种检查一个字符串是否以另一个字符串结尾的简单方法，方法是`strpos`在应该找到字符串的位置提供一个偏移量：

```
function stringEndsWith($whole, $end)
{
    return (strpos($whole, $end, strlen($whole) - strlen($end)) !== false);
} 
```

直截了当，我认为这适用于 PHP 4。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-06T17:12:27.727

这取决于您关心哪种效率。

由于使用 substr 产生的额外副本，您的版本使用了更多内存。

另一种版本可能会在原始字符串中搜索子字符串的最后一次出现而不进行复制，但由于更多的测试可能会更慢。

可能最有效的方法是从 -sterlen(test) 位置逐个字符循环到字符串末尾并进行比较。这是您希望进行的最少量比较，并且几乎没有使用任何额外的内存。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2020-08-18T21:44:30.827

在 PHP 8 中：

```
str_ends_with('haystack', 'stack'); // true
str_ends_with('haystack', 'K'); // false 
```

并且：

```
str_starts_with('haystack', 'hay'); // true 
```

[PHP RFC：添加 str_starts_with()、str_ends_with() 及相关函数](https://wiki.php.net/rfc/add_str_begin_and_end_functions)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-03-06T17:14:52.777

另一种方法是使用该[`strrpos`功能](http://docs.php.net/strrpos)：

```
strrpos($str, $test) == strlen($str) - strlen($test) 
```

但这并不是更快。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-10-18T13:04:28.527

我希望以下答案可能有效且简单：

```
$content = "The main string to search";
$search = "search";
//For compare the begining string with case insensitive. 
if(stripos($content, $search) === 0) echo 'Yes';
else echo 'No';

//For compare the begining string with case sensitive. 
if(strpos($content, $search) === 0) echo 'Yes';
else echo 'No';

//For compare the ending string with case insensitive. 
if(stripos(strrev($content), strrev($search)) === 0) echo 'Yes';
else echo 'No';

//For compare the ending string with case sensitive. 
if(strpos(strrev($content), strrev($search)) === 0) echo 'Yes';
else echo 'No'; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-07-15T10:12:23.933

不知道这是否很快，但对于单个字符测试，这些也可以：

```
(array_pop(str_split($string)) === $test) ? true : false;
($string[strlen($string)-1] === $test) ? true : false;
(strrev($string)[0] === $test) ? true : false; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-05-30T13:10:13.210

通过正则表达式检查它的最简单方法

*例如*检查给定的邮件是否为 gmail：

```
echo (preg_match("/@gmail\.com$/","example-email@gmail.com"))?'true':'false'; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-06T18:33:40.997

我在想像 strrchr() 这样的反向函数会帮助你以最快的速度匹配字符串的结尾。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-12-30T18:45:48.153

这是纯 PHP，没有调用外部函数，除了**strlen**。

```
function endsWith ($ends, $string)
{
    $strLength = strlen ($string);
    $endsLength = strlen ($ends);
    for ($i = 0; $i < $endsLength; $i++)
    {
        if ($string [$strLength - $i - 1] !== $ends [$i])
            return false;
    }
    return true;
} 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2019-09-19T02:06:33.907

对于单炭针：

```
if (@strrev($haystack)[0] == $needle) {
   // yes, it ends...
} 
```

# c# - 在对象列表中查找对象数据重复项

> ID：619612
> 
> 赞同：9
> 
> 时间：2009-03-06T17:03:53.583
> 
> 标签：c#, .net

使用 c# 3 和 .Net Framework 3.5，我有一个 Person 对象

```
public Person
{
    public int Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public int SSN { get; set; }
} 
```

我有他们的名单：

```
List<Person> persons = GetPersons(); 
```

如何获取列表中 SSN 不是唯一的人员中的所有人员对象，并将它们从人员列表中删除，理想情况下将它们添加到另一个名为“ `List<Person> dupes`”的列表中？

原始列表可能如下所示：

```
persons = new List<Person>();
persons.Add(new Person { Id = 1, 
                         FirstName = "Chris", 
                         LastName="Columbus", 
                         SSN=111223333 }); // Is a dupe
persons.Add(new Person { Id = 1, 
                         FirstName = "E.E.", 
                         LastName="Cummings", 
                         SSN=987654321 });
persons.Add(new Person { Id = 1, 
                         FirstName = "John", 
                         LastName="Steinbeck", 
                         SSN=111223333 }); // Is a dupe
persons.Add(new Person { Id = 1, 
                         FirstName = "Yogi", 
                         LastName="Berra", 
                         SSN=123456789 }); 
```

最终的结果将是 Cummings 和 Berra 在原始人员列表中，而 Columbus 和 Steinbeck 在一个名为 dupes 的列表中。

非常感谢！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-06T17:13:49.860

这将为您提供重复的 SSN：

```
var duplicatedSSN =
    from p in persons
    group p by p.SSN into g
    where g.Count() > 1
    select g.Key; 
```

重复的列表如下：

```
var duplicated = persons.FindAll( p => duplicatedSSN.Contains(p.SSN) ); 
```

然后只需遍历重复项并删除它们。

```
duplicated.ForEach( dup => persons.Remove(dup) ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T18:35:56.730

感谢 gcores 让我开始走上正确的道路。这就是我最终做的事情：

```
var duplicatedSSN =
    from p in persons
    group p by p.SSN into g
    where g.Count() > 1
    select g.Key;

var duplicates = new List<Person>();

foreach (var dupeSSN in duplicatedSSN)
{
    foreach (var person in persons.FindAll(p => p.SSN == dupeSSN))
        duplicates.Add(person);
}

duplicates.ForEach(dup => persons.Remove(dup)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T17:41:07.190

```
List<Person> actualPersons = persons.Distinct().ToList();
List<Person> duplicatePersons = persons.Except(actualPersons).ToList(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-24T13:25:40.960

基于上述@gcores 的建议。

如果要将重复 SSN 的单个对象添加回人员列表，请添加以下行：

```
IEnumerable<IGrouping<string, Person>> query = duplicated.GroupBy(d => d.SSN, d => d);

        foreach (IGrouping<string, Person> duplicateGroup in query)
        {
            persons.Add(duplicateGroup .First());
        } 
```

我在这里的假设是，您可能只想删除重复值减去重复项派生的原始值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T17:11:43.080

好吧，如果您像这样实现 IComparable ：

```
int IComparable<Person>.CompareTo(Person person)
{
    return this.SSN.CompareTo(person.SSN);
} 
```

那么像下面这样的比较将起作用：

```
for (Int32 i = 0; i < people.Count; i++)
{
    for (Int32 j = 1; j < items.Count; j++)
    {
        if (i != j && items[i] == items[j])
        {
            // duplicate
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T17:14:56.990

遍历列表并保留 SSN/count 对的 Hashtable。然后枚举您的表并删除与 SSN 计数 > 0 的 SSN 匹配的项目。

```
Dictionary<string, int> ssnTable = new Dictionary<string, int>();

foreach (Person person in persons)
{
   try
   {
      int count = ssnTable[person.SSN];
      count++;
      ssnTable[person.SSN] = count;
   }
   catch(Exception ex)
   {
       ssnTable.Add(person.SSN, 1);
   }
}

// traverse ssnTable here and remove items where value of entry (item count) > 1 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-11T14:24:45.183

`persons`必须是一个吗`List<Person>`？如果它是一个`Dictionary<int, Person>`?

```
var persons = new Dictionary<int, Person>();

...

// For each person you want to add to the list:
var person = new Person
{
  ...
};

if (!persons.ContainsKey(person.SSN))
{
  persons.Add(person.SSN, person);
}

// If you absolutely, positively got to have a List:
using System.Linq;
List<Person> personsList = persons.Values.ToList(); 
```

如果您正在使用的唯一实例`Person`（而不是可能碰巧具有相同属性的不同实例），您可能会使用[`HashSet`](http://msdn.microsoft.com/en-us/library/bb359438%28v=VS.90%29.aspx).

# java - Apache Commons HttpClient PostMethod 支持？

> ID：619614
> 
> 赞同：0
> 
> 时间：2009-03-06T17:04:24.487
> 
> 标签：java, apache-commons-httpclient

我很好奇如何在 Apache Commons HttpClient 中设置 PostMethod 的请求属性？

我正在重构一些使用 HttpURLConnection 类编写的代码以发布，如下所示：

```
conn1.setRequestProperty(
    "Content-Type", "multipart/related; type=\"application/xml\"; boundary="
    + boundary);
conn1.setRequestProperty("Authorization", auth); 

... ... 
```

要使用：

```
PostMethod method = new PostMethod(_Server); 
method.setRequestBody(...); or 
method.setRequestHeader(...); 
```

但我不确定这是否/如何映射到我想要对原始 URL 类执行的操作......谁能帮助澄清如何使用 PostMethod 类设置请求属性？

非常感谢！

-亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T12:30:59.477

这些都是请求标头，因此您需要调用 setRequestHeader() 来在连接上建立这些值。HttpClient 还支持处理基本身份验证，因此可以重构“授权”标头，具体取决于更改的深度。

# url - 从 URL 或其他线索识别框架/CMS 的资源？

> ID：619616
> 
> 赞同：3
> 
> 时间：2009-03-06T17:04:43.253
> 
> 标签：url, frameworks

我很想知道根据 URL、标题、内容的线索，网站正在使用哪个 Web 框架或内容管理系统。有谁知道网络上可以提供此资源的资源？例如：

*   .html -> 可能是一个平面文件
*   .php -> 可能是使用 PHP 构建的东西。
*   .jsp -> 使用 Java 服务器页面的东西
*   .asp -> 活动服务器页面
*   0,2097,1-1-1928,00 -> Vignette CMS
*   .do -> ??

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-02-28T10:13:55.457

通过 url 查找 CMS

[http://2ip.ru/cms/](http://2ip.ru/cms/)

在中心输入字段中输入 URL，然后单击下面的蓝色大按钮

结果黑色 - 未找到，红色 - 找到

注意：可以使用 url 路径：使用 http://，带或不带 www。部分——结果可能不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T17:23:23.380

如果您不仅限于查询字符串，那么还有其他一些选项。例如要识别一个 rails 应用程序：

脚本、样式表和图像标签往往会附加一个 10 位数字（这允许您缓存并仍然更改文件）：

```
<script src="/javascripts/all.js?1236037318" type="text/javascript"></script> 
```

您有时还可以从 cookie 中看出框架是什么。例如，Rails 应用程序往往有一个名为 _appName_session 的会话 cookie，并且通常您可以找到包含的 flash。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T17:17:00.650

您的清单在正确的轨道上。如果您只想知道堆栈（LAMP、IIS、Java），那么这就是您真正需要的。

如果查询有问题的 URL 是一个选项，那么您通常也可以从 HTTP 响应标头中提取 Web 服务器的品牌/版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-01T11:09:15.960

有一个漂亮的 Chrome 扩展名为[Wappalyzer](https://chrome.google.com/webstore/detail/wappalyzer/gppongmhjkpfnbhagpmjfkannfbllamg)：

> Wappalyzer 是一个浏览器扩展，它揭示了网站上使用的技术。它检测内容管理系统、电子商务平台、Web 服务器、JavaScript 框架、分析工具等等。

# python - 在 PIL 中使用像素字体

> ID：619618
> 
> 赞同：7
> 
> 时间：2009-03-06T17:05:11.160
> 
> 标签：python, imaging

我正在使用包含许多精确放置的文本字符串的 PIL 创建图像。我的第一次尝试是将像素字体转换为与 pil 兼容的格式，如此[处](http://llbb.wordpress.com/2006/11/24/making-pil-font-for-python-image-library/)所述。例如，我下载 Silkscreen 字体并进行转换：

```
otf2bdf -p 8pt -o fonts/slkscr.bdf fonts/slkscr.ttf 
pilfont.py fonts/slkscr.bdf 
```

然后我可以像这样在 PIL 中使用字体：

```
import Image, ImageDraw, os, sys, ImageFont
im = Image.new("RGB", (40,10))
draw = ImageDraw.Draw(im)
fn = ImageFont.load('fonts/slkscr.pil')
draw.text((0,0), "Hello", font=fn)
del draw
# write to stdout
im.save(sys.stdout, "PNG") 
```

但是，生成的图像 ( ![替代文字](https://i.stack.imgur.com/L4koP.png)) 并不反映字体[应该是什么样子](http://kottke.org/plus/type/silkscreen/)。

我应该使用什么程序来转换和使用像素字体，以便它们按预期呈现？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T18:31:15.760

尤里卡！

只需为 otf2bdf 指定 72 dpi 的分辨率（默认为 100）：

```
otf2bdf -p 8 -r 72 -o fonts/slkscr.bdf fonts/slkscr.ttf 
```

现在，![替代文字](https://i.stack.imgur.com/QReUU.png)看起来很棒！

# python - Django 自定义身份验证后端是否需要输入密码？

> ID：619620
> 
> 赞同：2
> 
> 时间：2009-03-06T17:05:24.470
> 
> 标签：python, django, authentication, django-authentication, custom-backend

这是我的大学处理身份验证的方式：我们将用户重定向到一个网站，他们输入他们的用户名和密码，然后他们使用用户名和在查询字符串中传递的登录密钥被重定向回我们。当我们找回用户时，我们调用大学数据库中的一个存储过程，它获取用户名、登录密钥和 IP 地址，并告诉我们这是否有效。

我已经设置了一个 Django 自定义身份验证后端来处理所有这一切。我是否让它能够接受密码参数（因为我们实际上并没有使用他们的密码）是否有任何不同？现在，我已将其设置为将登录密钥作为密码参数。将其更改为将其作为登录密钥而不是密码对我来说是好是坏还是两者都不是？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T17:29:05.190

[Django 文档](http://docs.djangoproject.com/en/dev/topics/auth/)这样说：

> 无论哪种方式，authenticate 都应该检查它获得的凭据，如果凭据有效，它应该返回一个与这些凭据匹配的 User 对象。如果它们无效，它应该返回 None。

“无论哪种方式”是指 authenticate() 方法是采用用户名/密码组合，还是仅采用令牌。您的情况介于这两者之间，因此我认为“最佳”答案是编写您的 authenticate() 以获取用户名和登录密钥，并根据需要返回正确的 User 或 None 。

# jquery - 选择时如何使用jQuery忽略大小写？

> ID：619621
> 
> 赞同：16
> 
> 时间：2009-03-06T17:05:49.787
> 
> 标签：jquery, css-selectors, case-sensitive

我目前正在尝试使用以下 jQuery 选择器禁用链接：

```
$("a[href$=/sites/abcd/sectors]").removeAttr("href"); 
```

问题是有时页面上的 href 可能并不总是小写。发生这种情况时，选择器不再匹配。

有谁知道如何解决这个问题？我可以更改一次行为以忽略大小写吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-06T17:11:01.537

我自己遇到了这个。我稍微切换了逻辑以允许我在没有大小写的情况下进行比较。它需要更多的工作，但至少它有效。

```
$('a').each(function(i,n) {
    var href = $(n).attr("href");
    href = href.toLowerCase();
    if (href.endsWith('/sites/abcd/sectors'))
        $(n).removeAttr('href');
}); 
```

你必须弄清楚你自己的`endsWith`逻辑。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-06T20:49:17.800

jQuery 是为扩展而构建的。您可以更正它或添加您自己类型的不区分大小写的选择器。

[Rick Strahl：使用 jQuery 搜索内容并创建自定义选择器过滤器](http://www.west-wind.com/weblog/posts/519980.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T10:56:01.850

您可以在 jQuery 中使用函数“is”。它不区分大小写。

```
 $("a").each(function() {
     if ($(this).is("a[href$=/sites/abcd/sectors]")) {
       $(this).removeAttr('href');
     }
   }) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-21T15:22:14.460

首先这是**NOT VALID**表达式，因为它包含`\`,

如果您希望使用任何元字符（例如`!"#$%&'()*+,./:;<=>?@[\]^``{|}~`）作为

名称的文字部分，您必须使用两个反斜杠转义该字符：`\\`.

源：[http ://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

`/`所以你必须逃避`\\/`

所以你的表情将是 `$("a[href$=\\/sites\\/abcd\\/sectors]").removeAttr("href");`

# math - 确定任何基础的位值

> ID：619622
> 
> 赞同：4
> 
> 时间：2009-03-06T17:06:43.497
> 
> 标签：math

我正在寻找一个函数，它将确定给定数字和基数的位置的值。例如，

**鉴于：**

> ```
> Whole Value: 1120
> Base: 10
> Place: Tens place 
> ```

**应该返回：** 2

有人知道这个的数学吗？

编辑：该函数还应以数字方式传递整个值，而不是像“e328fa”之类的字符串。返回值也应该是数字，所以 FindInPlace(60 (整数), 16 (base), 2 (place, 1-based index)) 应该返回 3。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T17:10:18.170

如果数字已经转换为整数（即​​以 10 为底）

```
// Supports up to base 36
char digits[] = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";

char FindPlace(int number, int base, int digit)
{
   if(digit < 0) return 0;

   // Essentially divide the number by [base] to the [digit] power
   for(i=0; i<digit; i++)
   {
      number /= base;      
   }

   // TODO: Verify that the digit is in range of digits    
   return digits[number % base];
} 
```

（`0`给你最右边的数字，`1`给你下一个最右边的数字，等等）

我已将数字返回为`char`，以允许基数超过 10。

请注意，如果您想允许用户输入所需的数字为“ `1`s place, `10`s place, `100`s place”或“ `1`s, `16`s, `256`s”，您只需执行

```
digit = log(PlaceValue, base); 
```

或将代码重写为

```
char FindPlace(int number, int base, int digitAsBaseToAPower)
{
    // TODO: Error checking
    return digits[(number / digitAsBaseToAPower) % base];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T17:23:14.113

```
int getPlace(float x, float place) {

    return (int)(x/place) % 10;
} 
```

这适用于 base-10，并且可以处理小数点右侧或左侧的位置。你会这样使用它：

```
place = getPlace(1120,10);
otherPlace = getPlace(0.1120,1e-3); 
```

任何基础的更通用的解决方案都是棘手的。我会选择字符串解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T22:31:17.180

使用基于 1 的位置索引，公式为：

placeval = floor(number / (base^(place-1))) mod base

在 Python 中：

```
def FindInPlace(number, base, place):
    return number//base**(place-1) % base 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T17:42:34.880

像这样的东西？

```
int place_value(int value, int base, int place)
{
    int value_in_place= value;
    for (int place_index= 1; place_index<place; ++place_index)
    {
        value_in_place/=base;
    }

    return value_in_place % base;
} 
```

其中 place 是您想要从右边开始的数字的从一开始的索引。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T18:14:29.827

以下方法*placeValue*返回一个**char**，因为基数 11-36 的数字大于 9。该方法需要：

*   **int 值：**整个值
*   **int base：**将整数转换为的数字基数；可接受的值为 2-36
*   **int place：**数字的索引；最低有效位的索引为 1

* * *

```
import java.math.BigInteger;

...

    private static char placeValue(int value, int base, int place) {
        BigInteger bigValue = BigInteger.valueOf(value);
        String baseString = bigValue.toString(base);
        int numDigits = baseString.length();
        int digitIndex = numDigits - place;
        char digit = baseString.charAt(digitIndex); 
        return digit;
    } 
```

# c# - 知道任何 C# 语法高亮技巧吗？

> ID：619631
> 
> 赞同：24
> 
> 时间：2009-03-06T17:09:16.003
> 
> 标签：c#, visual-studio, syntax-highlighting

我通常更喜欢使用黑色背景和白色/彩色文本进行编码，但我从未花时间在 Visual Studio 中更改我的语法突出显示。

昨天，当我终于解决它时，我的更改之一是将用户类型和用户类型（值类型）更改为不同的颜色。不知不觉中，我一直在使用结构类型从方法中传递和返回数据，这超出了我的预期。

语法突出显示的这种变化使正在发生的事情变得非常明显。所以这让我想知道是否还有其他设置可以提供类似的帮助。

我通常还会将我的文档和注释颜色设置为更加褪色和被动的颜色，以便实际代码更能跳动你，并更快地快速浏览代码。

您是否还有其他类似的提示可以帮助发现问题或使事情更具可读性？

注意：（我看过[这篇文章](https://stackoverflow.com/questions/174121/syntax-highlighting-what-colors-do-you-like)，但我更多的是寻找实用且提供帮助的技巧，而不是纯粹的外观偏好。）

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-06T17:16:04.177

我让字符串看起来很可怕。黄色背景。胆大。红色前景。提醒我，硬编码字符串通常是不好的，并尽量减少它！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-11T20:52:17.517

*   为了可读性 -

我推荐深色（但不是黑色）背景和浅色（但不是白色）文本。较高的对比度在眼睛上很容易，但是随着时间的推移，过多的对比度会让我（个人）头疼。我也 100% 同意您关于在文档和评论中使用褪色颜色的评论。

*   对于代码理解 -

为用户类型、委托和值类型绝对使用不同的（即使只是稍微）不同的颜色。这使它们流行起来，并且在您尝试快速理解其他人的代码时确实很有帮助。

另外，我支持关于使字符串文字脱颖而出的评论。我不一定使用可怕的颜色，但我将它们与我所有的其他颜色分开，所以它们非常引人注目。

我也喜欢让数字成为一种单独的颜色。很多时候，数字与字符串文字有一些相同的问题，并且将它们单独着色使它们对我来说很突出，并帮助我找到应该用常量、属性等替换数字文字的地方。

*   对于重构 -

我发现它可以帮助我拥有一个单独的主题，其中颜色都被夸大了（例如，界面的亮蓝色而不是柔和的蓝色）以进行重构。我使用我通常使用的相同基本配色方案，但每种类型都使用“更亮”的颜色。（我不喜欢改变配色方案——我的大脑有点连接到我的标准颜色集——切换对我来说失去了目的）。但是，拥有更明亮的版本会使所有内容都“流行”一点，因此对于重构或尝试理解其他人的代码非常有用。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-11T20:44:08.707

人们已经为 Visual Studio 组合了整个“主题”。我发现每 6-12 个月引入一个新的设置主题会给一切带来新的视角，尽管我承认我喜欢的主题很少（我倾向于在两个不同的主题之间切换）。

查看 Scott 关于 VS 主题的文章： [http ://www.hanselman.com/blog/VisualStudioProgrammerThemesGallery.aspx](http://www.hanselman.com/blog/VisualStudioProgrammerThemesGallery.aspx)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-11T20:51:23.087

为交互使用一些漂亮的颜色，为用户定义的类使用一种丑陋的颜色，这有助于解耦。

[Vibrant Ink 主题](http://www.developernotes.com/post/Vibrant-Ink-for-Visual-Studio-2008.aspx)中有一些经过深思熟虑的东西。[我喜欢](http://blog.wekeroad.com/2007/10/17/textmate-theme-for-visual-studio-take-2/)把颜色调低一点，但这是一个好的开始。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-12T11:10:12.337

为什么你不知道什么对你有用？[http://www.frickinsweet.com/tools/Theme.mvc.aspx](http://www.frickinsweet.com/tools/Theme.mvc.aspx)有一个很酷的主题生成器

网站上的完整说明如何备份您当前的设置并导入您创建的设置。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-06T17:16:36.017

尝试将您的字符串文字设置为带有粗体白色文本的亮红色背景。它会鼓励你不要使用魔术字符串 =)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-18T10:18:21.717

它并没有真正突出，但我最近在阅读了一些建议后切换到了比例字体，发现它明显更好。

在切换之前，我主要担心的是事情无法正常排列，但在尝试之后我意识到它运行良好，没有任何明显的缺点。制表符（或空格）将块和在页面上重复的单词排列在一起，因为它们由相同的字母组成。我的恐惧是虚构的，因为我不知何故认为，如果它们*不同*，我需要词来排列。不是这种情况。

它阻止的一件事是对齐表达式中间的单词，而不是左侧的单词。例如，在固定宽度的字体中，您可以执行以下操作：

```
string firstName     = "John";
string lastName      = "Smith";
int age              = 30; 
```

而你不能用比例字体做到这一点。但如今这种做法似乎很少见。也许更多的是 C 或汇编语言的东西。

我还是建议尝试一下。互联网运行在比例字体上，因此使用它们是有意义的，只要它们没有任何缺点。当向我推荐它时，他们声称只需要几天时间就可以习惯，事实证明这是真的。我发现 Arial 11 点在 Visual Studio 中是一个不错的选择。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-16T17:55:26.570

我对类和结构使用不同的颜色。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-17T17:03:14.380

使字符串颜色明亮，以便您在代码中立即注意到它们。我在黑色上使用绿色作为字符串。在灰色上，我曾经使用黄色。

顺便说一句，我对常量、数字等做同样的事情。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-18T17:42:19.060

我真的很喜欢[Resharper 的着色系统](http://www.jetbrains.com/resharper/features/coding_assistance.html#Syntax_Highlighting)。使用它，您可以从编辑器中获得更多细节。例如：字段、局部变量和参数都是不同的颜色。我不知道为什么 VS 没有开箱即用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-16T13:20:15.937

我总是将大括号匹配背景设置为红色，并使其加粗。这样，当我关闭大括号或括号时，我可以看到它匹配的内容。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-17T15:08:44.327

我认为在编程中选择好的等宽字体更重要（我的选择是consolas，对于其他一些好的字体可以看看[这篇](http://www.codinghorror.com/blog/archives/000969.html)关于编码恐怖的文章）。

恕我直言，Visual Studio 的默认主题非常好，如果您在晚上工作，可能太亮了。

# tdd - 测试驱动开发是游戏开发中的正常方法吗？

> ID：619634
> 
> 赞同：31
> 
> 时间：2009-03-06T17:10:11.057
> 
> 标签：tdd

我只是好奇，因为我看到的所有[TDD示例都与 Web 编程相关。](http://en.wikipedia.org/wiki/Test-driven_development)如果这不是一种正常的方法，为什么不是呢？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-03-07T16:38:14.680

TDD 已成为认真对待自己职业的软件开发人员所青睐的方法。[ [IEEE:TDD](http://ieeexplore.ieee.org/xpl/login.jsp?tp=&arnumber=4163026&url=http%3A%2F%2Fieeexplore.ieee.org%2Fiel5%2F52%2F4163008%2F04163026 "付费墙") ] 该方法的好处是显着的，相比之下成本较低。[ [TDD 三大定律](http://butunclebob.com/ArticleS.UncleBob.TheThreeRulesOfTdd)]

没有 TDD 不适合或无效的软件领域。然而，它在某些领域具有挑战性。游戏恰好是其中之一。

实际上，挑战与其说是游戏，不如说是 UI。UI 是一个挑战的原因是，在您看到它之前，您通常不知道您希望 UI 看起来像什么。UI 是您必须摆弄的那些事情之一。做对是一个深度迭代的过程，充满曲折、死胡同和死胡同。*首先*为 UI编写测试可能既困难又浪费。

现在，在每个人都咆哮着说：“鲍勃叔叔说：'不要为 UI 做 TDD'”之前，让我这样说。很难为 UI 做纯 TDD 的事实并不意味着你不能为几乎所有其他东西做纯 TDD。大部分游戏都与算法有关，您可以将 TDD 与这些算法一起使用，让您心满意足。确实，尤其是在游戏中，其中一些算法是您必须摆弄的那种代码，就像 UI 一样，因此可能不适合首先进行*测试*。但是还有很多其他的算法代码可以并且应该首先编写测试。

这里的诀窍是遵循[单一职责原则 (SRP)](http://www.objectmentor.com/resources/articles/srp.pdf)并将那些你必须摆弄的代码与那些确定性的代码分开。不要在你的 UI 中加入易于测试的算法。不要将推测代码与非推测代码混在一起。 *将因 A 原因而改变的事物与因 B 原因而改变的事物分开*。

*另外*，请记住这一点：有些代码很难先测试*，*并不意味着这段代码很难再测试。一旦您对代码进行了修改和调整，并让代码按照您喜欢的方式工作，*那么*您就可以编写测试来证明代码按照您的想法工作。（您会惊讶于这样做时发现错误的次数。）

 **“事后”编写测试的问题在于，代码通常是如此耦合，以至于很难编写最有用的外科测试类型。因此，如果您正在编写一种难以首先测试的代码，*则应*注意遵循[依赖倒置原则（DIP）](http://www.objectmentor.com/resources/articles/dip.pdf)和[开/关原则](http://www.objectmentor.com/resources/articles/ocp.pdf)（OCP），以保持代码足够解耦以进行后续测试事实。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2010-06-04T03:19:08.343

简单的答案是“不”，TDD 不是游戏开发中的常规方法。有些人会指出 Highmoon 和 Neil Llopis 作为反例，但这是一个很大的行业，而且他们是我认识的唯一完全接受 TDD 的人。我敢肯定还有其他人，但他们是我所知道的唯一人（我已经在这个行业工作了 5 年）。

我认为我们中的很多人在某个时候都涉足过单元测试，但由于某种原因，它并没有站稳脚跟。从个人经验来看，游戏工作室很难切换到 TDD。通常一个代码库是从一个项目到另一个项目的，将 TDD 应用到一个大型的现有代码库既乏味又很吃力不讨好。我确信最终它会证明是富有成效的，但是让游戏编码人员接受它是很困难的。

我在为低级游戏引擎代码编写单元测试方面取得了一些成功，因为这些代码往往具有很少的依赖关系并且易于封装。不过，这一直是事后测试，而不是 TDD。更高级别的游戏代码通常更难编写测试，因为它具有更多的依赖关系，并且通常与复杂的数据和状态相关联。以 AI 为例，测试 AI 需要某种上下文，即导航网格和世界上的其他对象。孤立地设置这种测试并非易事，特别是如果所涉及的系统不是为它设计的。

在游戏开发中更常见的，我个人也取得了更多成功的是冒烟测试。您经常会看到冒烟测试与持续集成结合使用，以提供有关代码行为的各种反馈。冒烟测试更容易，因为只需将数据输入游戏并读回信息即可完成，而无需将代码划分为可测试的小片段。再次以 AI 为例，您可以告诉游戏加载一个关卡并提供一个脚本来加载 AI 代理并为其发出命令。然后，您只需确定代理是否执行这些命令。这是一个冒烟测试而不是单元测试，因为您将游戏作为一个整体来运行，而不是孤立地测试 AI 系统。

在我看来，通过对低级代码进行单元测试，同时对高级行为进行冒烟测试，可以获得不错的测试覆盖率。我认为（希望）其他工作室也采取了类似的方法。

如果我对 TDD 的看法听起来有些模棱两可，那是因为确实如此。我仍然对此持怀疑态度。虽然我看到了一些好处（回归测试，在代码之前强调设计），但在使用预先存在的代码库时应用它并强制执行它似乎让人头疼。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-06T17:28:32.883

Games from Within 有[一篇文章](http://gamesfromwithin.com/?p=97)讨论了他们对单元测试的使用，单元测试在游戏方面的局限性，以及他们设置的自动化功能测试服务器来帮助解决这个问题。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-06T20:33:48.260

如果您指的是为每一位代码编写和维护单元测试的做法，我会大胆猜测并声明这在游戏行业中并未广泛使用。这有很多原因，但我可以想到 3 个明显的原因：

*   文化。程序员很保守，游戏程序员更是如此。
*   实际的。TDD 不太适合问题域（移动部件太多）。
*   紧缩的。时间永远不够用。

TDD 范式在不是非常有状态的应用程序域中效果最好，或者至少在移动部件不是全部​​同时移动的应用程序域中，通俗地说。

TDD 适用于部分游戏开发过程（基础库等），但在这方面工作中的“测试”通常意味着运行自动飞越、随机键测试、定时 io 加载、跟踪 fps 峰值，确保玩家可以不要扭扭捏捏地造成视觉不稳定，诸如此类。自动机也经常是人形机器人。

TDD 可能是一个有用的工具，但它作为一种灵丹妙药的地位，即在制作系统时必须无处不在，这是相当值得怀疑的。开发不应该由测试驱动，而应该由理性驱动。RDD 是一个糟糕的首字母缩写词——它不会流行起来。;)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-11T16:33:03.287

可能主要原因是那些语言更利于它的人更喜欢TDD。但除此之外，无论如何，游戏本身都不适合这种范式。

一般来说（是的，我的意思是一般来说，所以请不要用反例来淹没我），测试驱动设计最适合事件驱动系统，而不适合模拟风格的系统。您仍然可以在游戏中的低级组件上使用测试，无论是测试驱动的还是简单的单元测试，但是对于更高级别的任务，几乎没有任何类型的离散事件可以用确定性的结果来模拟。

例如，Web 应用程序通常具有非常不同的输入（HTTP 请求），更改非常少量的状态（例如，数据库中的记录），并生成很大程度上确定性的输出（例如，HTML 页面）。这些可以很容易地检查有效性，并且由于生成输入很简单，因此创建测试很简单。

然而，对于游戏，输入可能难以模拟（尤其是如果它需要在某个时间点发生……想想过去的加载屏幕、菜单屏幕等），您更改的状态量可能很大（例如，如果你有一个物理系统，或者复杂的反应式 AI）并且输出很少是确定性的（随机数的使用是这里的主要罪魁祸首，尽管浮点精度损失是另一个原因，可能是硬件规格或可用的 CPU 时间，或后台线程的性能等）。

要进行 TDD，您需要准确地知道您期望在某个事件中看到什么，并有准确的测量方法，这两个都是模拟的难题，避免离散事件，故意包含随机因素，对不同的事件采取不同的行动机器，并具有图形和音频等模拟输出。

此外，还有一个巨大的实际问题是进程启动时间。您想要测试的许多事情都需要加载大量数据，如果您模拟数据，您并没有真正测试算法。考虑到这一点，拥有任何类型的仅执行单个任务的测试脚手架很快就会变得不切实际。您可以针对 Web 服务器运行测试，而不必每次都关闭 Web 服务器 - 这对于游戏来说是很少可能的，除非您使用嵌入式脚本语言进行测试（这是合理的，并且确实发生在行业中）。

例如，您想为游戏中的建筑物添加体积阴影渲染。因此，您需要编写一个测试来启动所有必要的子系统（例如，渲染器、游戏、资源加载器）、加载建筑物（包括网格、材质/纹理）、加载摄像机、将该摄像机定位到指向建筑物，启用阴影，渲染场景，然后以某种方式确定阴影是否实际出现在帧缓冲区中。这不太实用。实际上，所有这些脚手架都已经以游戏的形式存在，除了代码本身的任何断言之外，您只需启动它来进行可视化测试。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-06T17:33:25.180

就现代开发实践而言，大多数游戏开发人员并不完全同意它。谢天谢地。

但是测试驱动的开发模型强调首先关注如何使用某些东西，然后充实它的作用。一般来说，这样做很好，因为它迫使您专注于特定功能如何真正适合您正在做的任何事情（例如，游戏）。

所以优秀的游戏开发者自然会这样做。只是没有明确。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-07T21:59:27.950

@Rune 再次强调“D”而不是“T”。在单元级别，测试是一种思考工具，可以帮助您了解您想要什么并*推动*代码设计。当然，在单元级别，我发现我最终得到了更清晰、更健壮的代码。我放入系统中的部件质量越好，它们与更少（但不是没有）错误的配合就越好。

这与游戏需要的那种严肃测试完全不同。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-06T17:17:24.253

TDD 在任何地方都不是真正的“正常”方法，因为它仍然相对较新，还没有被普遍理解或接受。这并不是说有些商店现在不那样工作了，但我仍然很惊讶听到有人在这一点上使用它。

# c# - 如何通过单击 asp.net 中的图像按钮来流式传输 zip 文件？

> ID：619643
> 
> 赞同：3
> 
> 时间：2009-03-06T17:12:41.173
> 
> 标签：c#, asp.net, streaming, zip

我的问题：当用户单击 aspx 页面上的图像按钮时，代码隐藏会创建一个 zip 文件，然后我尝试将该 zip 文件流式传输给用户。

要流式传输文件，我使用以下代码：

```
FileInfo toDownload = new FileInfo(fullFileName);
if (toDownload.Exists)
{
   Response.Clear();
   Response.ContentType = "application/zip";
   Response.AppendHeader("Content-Disposition", "attachment;filename=" +
             toDownload.Name);
   Response.AppendHeader("Content-Length", toDownload.Length.ToString());
   Response.TransmitFile(fullFileName);
   HttpContext.Current.ApplicationInstance.CompleteRequest();
} 
```

当我尝试执行此操作时，页面上出现以下错误：

Sys.WebForms.PageRequestManagerParserErrorException：无法解析从服务器接收到的消息。此错误的常见原因是通过调用 Response.Write()、响应过滤器、HttpModules 或启用了服务器跟踪来修改响应。详细信息：在“PK...”附近解析错误。

PK 是 zip 文件中将其标识为 zip 文件的前两个字符，因此我知道它正在尝试将 zip 文件发送到浏览器。但是，我的印象是浏览器正在尝试解释和/或呈现 zip 文件，而我希望它弹出一个下载文件选项。

想法？

编辑：[这是写上述错误消息的人的帖子的链接。](http://weblogs.asp.net/leftslipper/archive/2007/02/26/sys-webforms-pagerequestmanagerparsererrorexception-what-it-is-and-how-to-avoid-it.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T17:17:57.900

例如，这是我在我的一个应用程序中向客户端发送 PDF 的方式（您必须填写/更改一些缺少的变量声明）：

```
 byte[] rendered = uxReportViewer.LocalReport.Render("PDF", null, out mimeType, out encoding, out extension, out streamIds, out warnings);

        Response.Buffer = true;
        Response.Clear();
        Response.ClearHeaders();
        Response.ContentType = mimeType;
        Response.CacheControl = "public";
        Response.AddHeader("Pragma", "public");
        Response.AddHeader("Expires", "0");
        Response.AddHeader("Cache-Control", "must-revalidate, post-check=0, pre-check=0");
        Response.AddHeader("Content-Description", "Report Export");
        Response.AddHeader("Content-Disposition", "attachment; filename=\"" + filename + "." + extension + "\"");

        Response.BinaryWrite(rendered);
        Response.Flush();
        Response.End(); 
```

您将更改内容类型，并将您的 zip 文件转换为字节数组，然后我认为您可以填写其余部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T17:55:45.830

我终于解决了这个问题，还注意到我可能没有在问题中提供足够的信息：图像按钮在 UpdatePanel 中。

解决方案是为控件创建一个 PostBackTrigger：

```
<Triggers>
    <asp:PostBackTrigger ControlID="ibDownload" />
</Triggers> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T17:22:20.840

伙计，您不是使用 DotNetZip 生成 zip 文件吗？如果您没有在磁盘上创建 zip 文件，而只是在内存中创建，该怎么办？此示例使用 DotNetZip 来执行此操作。

```
 Response.Clear();
    Response.BufferOutput = false;
    String ReadmeText= "This is content that will appear in a file " + 
                       "called Readme.txt.\n" + 
                       System.DateTime.Now.ToString("G") ; 
    string archiveName= String.Format("archive-{0}.zip", 
                                      DateTime.Now.ToString("yyyy-MMM-dd-HHmmss")); 
    Response.ContentType = "application/zip";
    Response.AddHeader("content-disposition", "attachment; filename=" + archiveName);

    using (ZipFile zip = new ZipFile())
    {
        // add an entry from a string: 
        zip.AddEntry("Readme.txt", "", ReadmeText);
        zip.AddFiles(filesToInclude, "files");
        zip.Save(Response.OutputStream);
    }
    // Response.End();  // no - see http://stackoverflow.com/questions/1087777
    HttpContext.Current.ApplicationInstance.CompleteRequest(); 
```

# .net - 负载测试 .NET 桌面客户端

> ID：619648
> 
> 赞同：1
> 
> 时间：2009-03-06T17:14:12.920
> 
> 标签：.net, client-server, load-testing

我需要使用自动化脚本在 .NET 桌面应用程序上自动化负载测试，最好是能够记录鼠标点击和键盘输入的脚本。

我将拥有大约 10 个桌面供我使用，并且我想在每个盒子上最多模拟 10 个用户（作为安装 100 个盒子的替代方案）。

是否有任何工具可用于执行此操作？此应用程序没有 HTTP 接口，因此无法使用常规的基于 Web 的负载测试工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T17:39:41.813

看看[QuickTestPro](https://h10078.www1.hp.com/cda/hpms/display/main/hpms_content.jsp?zn=bto&cp=1-11-127-24%5E1352_4000_100__)。我们将它用于 Web 和 Windows 应用程序。

也就是说，如果这些应用程序正在调用数据库后端，您可能会考虑只对数据库本身[进行压力测试。](http://www.sqledit.com/stress/)我认为您将很难使用任何类型的工具获得您正在寻找的数量（100 个并发用户）。也就是说，它如何一次打开您的应用程序的 10 个实例？

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T17:48:41.603

Mercury（我相信现在归惠普所有）长期以来一直致力于提供横向扩展测试工具。

如果您想尝试自己自动化其中一些，请查看Microsoft 现在发布的[UI 自动化框架。](http://msdn.microsoft.com/en-us/library/ms747327.aspx)

# c# - 将关联数组从 c# 传递到 Powershell

> ID：619649
> 
> 赞同：7
> 
> 时间：2009-03-06T17:14:23.697
> 
> 标签：c#, powershell, associative-array

我想将一个关联数组从 C# 传递给 Powershell。作为一个例子，我想执行这个 powershell 代码行：

```
 PS C:\> get-command | select name, @{N="Foo";E={"Bar"}} -first 3

Name                                                        Foo
----                                                        ---
Add-Content                                                 Bar
Add-History                                                 Bar
Add-Member                                                  Bar 
```

我想通过**不同**命令的管道而不是标记为脚本的单个命令来做到这一点。这是代码：

```
 Runspace runspace = RunspaceFactory.CreateRunspace();
runspace.Open();
Pipeline pipeline = runspace.CreatePipeline();

pipeline.Commands.Add("get-command");

Command c = new Command("select-object");
List properties = new List();
properties.Add("name");
properties.Add("@{N=\"Foo\";E={\"Bar\"}}");
c.Parameters.Add("Property", properties.ToArray());
c.Parameters.Add("First", 3);
pipeline.Commands.Add(c);

pipeline.Commands.Add("Out-String");

Collection retval = pipeline.Invoke();
runspace.Close();

StringBuilder stringBuilder = new StringBuilder();
foreach (PSObject obj in retval)
    Console.WriteLine(obj.ToString()); 
```

但是作为参数传递给 Select-Object 的关联数组没有被正确解析。这是另一面的结果：

```
 PS C:\test> c:\test\Bin\Debug\test.exe

Name                                     @{N="Foo";E={"Bar"}}
----                                     --------------------
Add-Content
Add-History
Add-Member 
```

我如何设置 Select-Object 命令参数有什么问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-06T19:45:36.503

通过 c# 创建管道和使用本机 powershell 脚本创建管道有一个实际上非常微妙的主要区别：参数绑定器。

如果我用纯脚本编写你的代码版本，我会得到同样的错误：哈希表文字被视为字符串值。

```
ps> $ps = $ps.Commands.Add("get-process")
ps> $ps = $ps.Commands.Add("select-object")
ps> $ps.Commands[1].Parameters.Add("Property", @("Name", '@{N="Foo";E={"Bar"}}')) 
```

在这种情况下，该命令接收一个由两个字符串组成的数组，即“名称”和哈希表文字字符串。这将以与您的 C# 完全相同的方式被破坏。现在，看看正确的方法（在脚本中）——让我重写第 3 行：

```
ps> $ps.Commands[1].Parameters.Add("Property", @("Name", @{N="Foo";E={"Bar"}})) 
```

那么发生了什么变化？我删除了散列表周围的引号——我将散列表作为对象数组的第二个元素传递！因此，要让您的 C# 示例正常工作，您需要执行参数绑定器在命令行中为我们所做的事情（这非常多！）。代替：

```
properties.Add("@{N=\"Foo\";E={\"Bar\"}}"); 
```

和

```
properties.Add(
    new Hashtable {
        {"N", "Foo"},
        {"E", System.Mananagement.Automation.ScriptBlock.Create("\"Foo\"")}
    }
); 
```

我希望这可以为您解决问题。参数绑定器可能是 powershell 体验中最不可见但最强大的部分。

-Oisin

# vb.net - 一种更好的写法：增长数组

> ID：619653
> 
> 赞同：0
> 
> 时间：2009-03-06T17:14:49.377
> 
> 标签：vb.net, arrays, loops

之前正在查看一些代码，并且我认为必须有一种更优雅的方式来编写这个......

（returnVar.Warnings 是一个字符串数组，它可以根据记录的警告数量以任意大小返回）

```
For Each item In items
  If o.ImageContent.ImageId = 0 Then
    ReDim Preserve returnVar.Warnings(returnVar.Warnings.GetUpperBound(0) + 1)
    returnVar.Warnings(returnVar.Warnings.GetUpperBound(0)) = "Section: " & section.<header>.<title>.ToString & " , Item: " & item.<title>.ToString
  End If
Next 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T17:19:00.927

使用[通用 List(of string)](http://msdn.microsoft.com/en-us/library/6sh2ey19(VS.80).aspx)然后获取包含列表数据的数组（如果需要）

```
dim list = new List(of string)
list.Add("foo")
list.Add("bar")
list.ToArray() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T17:19:43.700

你不能使用 ArrayList 来为你做这件事吗？

[http://msdn.microsoft.com/en-us/library/system.collections.arraylist.aspx](http://msdn.microsoft.com/en-us/library/system.collections.arraylist.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T17:50:24.627

首先将`If`语句移出循环。

如果您使用的是 framework 3.5，则可以使用 LINQ 循环这些项目。

```
If o.ImageContent.ImageId = 0 Then
    returnVar.Warnings = items.Select(Function(item) "Section: " & section.<header>.<title>.ToString & " , Item: " & item.<title>.ToString).ToArray()
Else
    returnVar.Warnings = New String() {}
End If 
```

# linq-to-sql - 在select linq to sql中返回相关对象

> ID：619665
> 
> 赞同：0
> 
> 时间：2009-03-06T17:17:53.753
> 
> 标签：linq-to-sql, associations

我有 2 个表 Account 和 Address 具有 1:1 的关系；account 里面有addressid。我已经在 dbml 文件中创建了关联。现在我想编写一个查询来为给定的 accountid 选择帐户，结果帐户中也应该包含地址对象。

```
 using (var context = new SalesLogixDataClassesDataContext())
        {
            var query = context.ACCOUNTs
                .Where(a => a.ACCOUNTID == id)
                .Select(a => new Account {AccountId = id, AccountName = a.ACCOUNT1, Address=a.ADDRESS});

            return query.FirstOrDefault();
        } 
```

但返回对象中的地址为空。那么我必须在查询中做什么才能检索到地址对象。

**编辑：**对不起，带你去追逐野鹅。我的关联映射错误（Address.AddressId 映射到 Account.AccountId）。我修复了它，现在它工作正常。谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T17:26:12.420

为什么要在选择中创建一个新的 Account 对象，而不是让 LINQ->SQL 为您处理它？如果您让框架选择对象，它应该正确设置属性的 EntityRef 并且关联应该起作用。

```
using (var context = new SalesLogixDataClassesDataContext())
    {
        var query = context.ACCOUNTs
            .Where(a => a.ACCOUNTID == id);

        return query.FirstOrDefault();
    } 
```

只是一个编辑，如果您选择从生成的名称更改属性名称，您也可以通过 DBML 设计器执行此操作，因此您获得的对象是友好的，但仍通过实际列名保持与表的关系。

在对您的代码进行第二次审查后（抱歉，我误读了实体的设置），我从原始答案中删除了一些无效文本。

下面是一些示例 XML，说明如何使模型对象更友好，而不是在查询中手动翻译它们。

```
<Table Name="dbo.ACCOUNT" Member="Accounts">
    <Type Name="Account">
      <Column Name="ACCOUNTID" Member="AccountId" Type="System.Int32" DbType="Int NOT NULL" IsPrimaryKey="true" CanBeNull="false" />
      <Column Name="ACCOUNT1" Member="AccountName" Type="System.String" DbType="VarChar(...) NOT NULL" CanBeNull="false" />
      <Association Name="Address_Account" Member="Address" ThisKey="ThisTablesFKIDToAddress" OtherKey="AddressTablePKID" Type="Address" IsForeignKey="true" />
    </Type>
</Table> 
```

您可以通过设计器做到这一点，这会更容易，也可以让您的地址对象更好地使用。

无论如何，我希望这会有所帮助，我不能确定设置实体发生了什么，如果您想发布帐户对象的代码，它可能会有所帮助，但它会给我们一个从这里出发的地方。

当然，如果您要更改建模对象，则选择代码看起来更像这样：

```
using (var context = new SalesLogixDataClassesDataContext())
{
    return context.Accounts.FirstOrDefault(account => account.AccountId == id);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T22:20:10.437

仔细查看您配置的对象关系，特别是涉及的键。无论想要/需要使用自定义对象，只要关系配置正确并且数据在数据库中，您提供的查询都会为您提供相关地址。

这是一个示例现实生活配置，其中 StateMaster 有一个 CustomerMasters1 属性（正在清理命名：）

[![替代文字](https://i.stack.imgur.com/ou8Wn.jpg)](https://i.stack.imgur.com/ou8Wn.jpg)

# javascript - 有没有办法在 Internet Explorer 中使用 window.hasOwnProperty()？

> ID：619666
> 
> 赞同：4
> 
> 时间：2009-03-06T17:17:54.190
> 
> 标签：javascript, internet-explorer

我有一个在 Firefox 中完美运行的方法，通过它我可以确定特定 javascript 对象的实例的名称（请不要问我为什么需要它......）。举例：

```
var temp = new String("hello!");
var theName = getVarName(temp); //returns "temp" 
```

此方法使用在 Internet Explorer 中不起作用的“window.hasOwnProperty()”：有什么建议吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-07-27T05:04:32.520

如果出于某种原因您确实需要使用窗口，请使用：

```
Object.prototype.hasOwnProperty.call(obj, p) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-07T01:21:09.003

> 我有一个在 Firefox 中完美运行的方法，我可以使用它来确定特定 javascript 对象的实例的名称

我不认为你这样做，因为这在 JavaScript 中是不可能的。JS 是一种按值调用的语言；当你写：

```
var temp= 'hello';
getVarName(temp); 
```

这和说的完全一样：

```
getVarName('hello'); 
```

此时，对“temp”作为变量的引用将丢失。我猜你的 getVarName 函数所做的基本上是这样的：

```
function getVarName(value) {
    for (var name in window) {
        if (window[name]===value)
            return name;
    }
} 
```

这将适用于没有 Object.hasOwnProperty(); 的 IE 和其他浏览器；它只会返回与参数匹配的任何全局变量的名称。可以将 hasOwnProperty() 调用添加到此函数中，以仅允许 window 的直接属性（充当全局变量，包括您明确设置的变量）而不是其任何原型的直接属性来稍微改进它。我猜这就是你的函数版本正在做的事情，但实际上它几乎没有影响，因为原型几乎没有继承到“窗口”。

通过将您的“hello”装箱在一个显式的 String 对象中（这是非常不寻常的并且很少是一个好主意），您会有点混淆事情，这使得使用 == 可以区分两个不同的“hello”对象成为可能=身份比较器，所以这将起作用：

```
var a= new String('hello!');
var b= new String('hello!');
getVarName(a); // 'a'
getVarName(b); // 'b' - distinguishable object from a 
```

但这仍然不能阻止你这样做：

```
var a= new String('hello!');
var b= a;
getVarName(a); // 'a' or 'b', depending on implementation
getVarName(b); // the same 'a' or 'b' as in the previous call 
```

因此，虽然您可以相当无害地丢失上面的 hasOwnProperty() 调用，但您正在做的事情并不能真正正常工作，您可能应该寻找一种更好的方法来实现您想要做的任何事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T17:40:57.223

不要使用全局变量。始终将它们放在名称空间中，以免遇到此类问题。

如果我理解正确，那么在任何范围内给定值时，您都需要全局变量名称。例如，以下内容也应该有效

```
var temp = "hello";
function foo(x) {
     alert(getVarName(x)); //returns "temp" as well.
}
foo(temp); 
```

这是一种对 Window 对象的反向哈希查找，它不仅昂贵，因为您每次都需要遍历 window 对象的所有属性，而且也不可靠（两个变量可以具有相同的值）。

# javascript - 表格/网格布局 - 硬编码 HTML 与 Javascript 生成

> ID：619674
> 
> 赞同：0
> 
> 时间：2009-03-06T17:19:50.987
> 
> 标签：javascript, html

这是创建以下硬编码 HTML 或 Javascript 操作的更有效方法：

预定义的网格，即恒定数量的行和列，具有边界和样式以及事件处理程序。用 HTML 编写许多*div是否更好。*

```
<div class='tl' id='c00' style='top:0px; left:0px;'>A</div>
<div class='tl' id='c01' style='top:0px; left:20px;'>A</div>
<div class='tl r' id='c02' style='top:0px; left:40px;'>A</div> 
```

或使用 Javascript 生成*div*。

```
d1 = "<div class='"
d2 = "' id='"
d3 = "' style='"
d4 = "'>"
d5 = "</div>"
sHTML = ""
for (j = 1; j < 5; ++j)
    for (i = 1; i < 5; ++i)
    {
        sClass = "t l ";

        if ((i+1 % 3) = 0)
            sClass = sClass + "r ";

        if ((j+1 % 3) = 0)
            sClass = sClass + "b ";

        sLine = d1 + sClass;
        sLine = sLine + d2 + "c" + n;
        sLine = sLine + d3 + "top:" + (i*20) + "px; left:" + (i*20) + "px;";
        sLine = sLine + d4 + "A";
        sLine = sLine + d5;
        document.writeln(sLine);
    } 
```

创建 HTML 所花费的时间不是问题，但由于它将在本地运行并且可能在移动设备上运行，因此页面性能更重要。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T17:21:06.380

硬编码会更快。浏览器需要以任何一种方式解析 html。您使用 Javascript 所做的一切都让它变得非常混乱并增加了开销。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T17:24:40.100

如果您只写出标记而不是使用 JavaScript，维护也将变得容易得多。

如果你打算*用*JS 来做……至少要通过[HTML DOM来做](http://www.w3schools.com/js/js_obj_htmldom.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T17:32:25.480

我建议使用重要的标记，而不是在所有需要时都使用 div。在你的情况下，一个 ul 列表就足够了

# java - 为什么我的面板的重绘没有被调用？

> ID：619675
> 
> 赞同：2
> 
> 时间：2009-03-06T17:19:56.977
> 
> 标签：java, multithreading, repaint

我有一个问题，我似乎无法解决涉及一个小动画的问题。对于一个项目，我们正在设计一个在 PDA (DELL Axim X51) 上运行的 J9 应用程序。有问题的代码（如下所示）是检测到鼠标单击以在嵌套面板中运行小动画时。如果动画独立于鼠标单击运行，则它可以正常工作并且可以完美地重新绘制。当识别到鼠标单击时调用该方法时，我们将忽略每个动画间隔的重绘，只有在动画完成后才会重绘面板。

我*认为*这可能与当识别到鼠标单击时应用程序与自身同步停止任何内部方法调用以进行绘制或绘制操作对鼠标单击没有足够高的优先级有关。

### [我的代码：](http://pastebin.com/m33004354)

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Font;
import java.awt.FontMetrics;
import java.awt.Frame;
import java.awt.Graphics;
import java.awt.Panel;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;

public class StatusLoader extends Panel implements Runnable{

        int progress;

        public static void main(String[] args) {
                Frame f = new Frame();
                StatusLoader  mp = new StatusLoader();
                mp.setBackground(Color.yellow);
                f.add(mp);

                f.setSize(300,300);
                f.show();       
                f.addWindowListener(new WindowAdapter() {            
            public void windowClosing(WindowEvent e) {
                System.exit(0);
            }
        });
                mp.start();
        }

        public void start(){
                Thread t = new Thread(this);
                t.run();

        }

        public void run(){
                for (int i = 0; i < 10; i++) {
                        progress+=10;
                        this.repaint(0);
                        System.out.println(i);
                        try{
                                Thread.sleep(100);
                        }catch(InterruptedException ex){}
                }
        }

        public void paint(Graphics g){
                System.out.println("called repaint");
                g.setColor(Color.red);
                g.setFont(new Font("Sansserif",2,24));
                FontMetrics fm = g.getFontMetrics();
                int stringWidth = fm.stringWidth("Loading");
                g.drawString("Loading", getWidth()/2-stringWidth/2, getHeight()/2);
                g.setFont(new Font("Sansserif",2,12));
                fm = g.getFontMetrics();
                stringWidth = fm.stringWidth("Map ziles for the new zoom level");
                g.drawString("Map tiles for the new zoom level", getWidth()/2-stringWidth/2, getHeight()/2+30);
                g.drawRect(getWidth()/2-100, getHeight()/2+60, 200, 10);
                g.setColor(Color.blue);
                g.fillRect(getWidth()/2-100, getHeight()/2+60, progress*2, 10);
        }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T17:42:02.243

在`StatusLoader.start`中，您使用`Thread.run`而不是`Thread.start`。这意味着`StatusLoader.run`在事件线程上执行，这是一件非常糟糕的事情。将其更改为`t.start()`.

# c++ - 调试多线程应用程序

> ID：619677
> 
> 赞同：4
> 
> 时间：2009-03-06T17:20:52.997
> 
> 标签：c++, multithreading, debugging, winapi

我有一个用 C++ 和 MFC 编写的应用程序，它是在 Windows 上运行的多线程。偶尔我会收到一些抱怨，例如死锁或由于这些线程引起的未处理异常。通常我使用 Visual Studio（如果问题是可重现的）或者使用 WinDbg 来分析生成的转储文件。有没有更好的方法来做到这一点？我可以使用其他一些工具来做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T00:31:36.893

如果您有足够的预算，我会推荐[Intel Thread Checker 。](http://www.intel.com/cd/software/products/asmo-na/eng/threading/286406.htm)它在分析正在运行的程序和提醒您可能的竞争条件方面做得很好。

查看[演示视频](http://www.intel.com/software/products/Flash/threading/SPD_nav.swf)了解更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T07:09:48.203

如果您在 CRITICAL_SECTIONs 上死锁，您可以使用 WinDbg 中的[!locks 调试器扩展](http://blogs.msdn.com/greggm/archive/2004/02/05/68232.aspx)来找出哪个线程拥有持有的锁，然后使用 kb 命令查看该线程的调用堆栈。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-07T00:58:55.250

我还没有开始使用它，但是[Relacy Race Detector](http://groups.google.com/group/relacy/web)听起来对于追踪某些类型的线程问题非常有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-07T00:18:04.240

多线程系统很复杂，并且不能仅使用适当的工具来定位阻塞。要查找死锁的原因，您可以将锁定/解锁记录放在表映射中。启动“动作锁定”时，您保存在表中，解锁时会从表中删除记录。在循环结束时，您可以记录表的状态或期望特定事件来执行此操作。
在 dll 中构建此实现，因此您也可以在其他项目中使用它。

# handler - asp.net 中的 ASHX 处理程序文件有什么好处？

> ID：619697
> 
> 赞同：14
> 
> 时间：2009-03-06T17:28:36.910
> 
> 标签：handler, ashx

使用 ashx 或处理程序有什么好处？另外，如果我使用 MVC（为什么不），我需要它们吗？

框架重要吗（2.0+）？

为什么我要使用处理程序？最近有人建议我使用一个来检索图像，但我不知道为什么。

感谢您的时间。

编辑 - 处理程序更快吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-06T17:36:18.187

仅举几个例子：

1.  **动态图像生成**：您可以编写返回数据驱动图像的处理程序，方法是创建一个返回图像数据的 ASHX 处理程序，然后在标签中使用该 URL。例如`<img alt="user's custom icon" src="Icon.ashx?username=bob"></img>`

2.  **将基于 REST 的 XML 或 JSON 数据返回**到客户端上的 AJAX 代码。

3.  **自定义 HTML**：当 ASP.NET Web 窗体或 MVC 框架过于严格时，为页面返回完全自定义的 HTML

我相信这从 1.0 开始就可用

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T17:34:26.473

非 MVC 项目中处理程序的目的是在 HTML 之外提供某种类型的编码响应。通常，处理程序将返回 XML（rss、RESTful 等）、用于 jQuery 或其他 Javascript 的 JSON，或者有时仅返回纯数据，例如文件二进制下载。我使用处理程序甚至返回要在客户端执行的特殊 javascript，作为延迟加载大型二进制文件或“仅需求”方法的要求的一种方式。或多或少，处理程序将用于返回“除 HTML 之外的任何内容”。

在 MVC 中，您将远离处理程序并利用控制器返回您喜欢的任何数据。所以，在这样的方法中：

```
mywebsite.com/restapi/content/56223 
```

您的 RestfulContentController 将有一个 Index() 方法，它不会返回 View()，而是返回纯 XML 或 JSON。

```
public class JSONContentController : Controller
{
  public JsonResult Index(int ContentID)
  {
    // get Content() by ContentID
    //

    // return a JSON version
    return Content().SerializeToJSON();
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T17:30:43.033

如果您在无法访问 IIS 但想要更改诸如未来到期响应标头之类的内容以优化 css、图像、JavaScript 等文件的缓存的环境中工作，它们将非常有用

对于图像，您可以执行动态优化之类的操作，因此您可以请求 image.jpg.ashx?w=180&quality=70 之类的图像，然后使用处理程序根据查询字符串中传递的设置传递图像

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-11T22:53:51.757

aspx 继承了实现 IRequireSessionState 的页面。因此，如果您通过 Ajax 调用它，那么 asp.net 需要在进一步处理之前锁定会话。

对于 ashx 文件，它是无状态的。除非你从 IRequireSessionState 继承它来管理状态。

对所有 Ajax 调用使用 ashx，对纯 asp.net 页面使用 aspx。

# database - 将消费者定义的聚合（例如 SQL 计数）与“纯”模型对象结合起来？

> ID：619698
> 
> 赞同：1
> 
> 时间：2009-03-06T17:28:46.940
> 
> 标签：database, oop, orm, model

将自定义（通常是易失的）数据引入实体模型类的最佳实践是什么？这首先听起来像是一种不好的做法，但它似乎是一种很常见的情况。在我们最近的 Web 应用程序中，我们开发了一个合适的模型，并且在大多数情况下，我们可以很好地加载模型实体。但是在某些情况下，我们无法加载整个实体层次结构；例如，我们需要加载几个 SQL COUNT 的结果，或者可能在模型实体旁边（或嵌入在其中）加载一些附加信息。所以基本上，要求和条件是：

1.  这是一个 Web 应用程序，其中 99.9999999999% 的操作都是读取操作。

2.  他们不需要处理或执行任何复杂的业务逻辑。我们只需要将数据快速转换为 HTML。

3.  在几个性能关键的情况下，我们需要加载不适合任何模型属性的 SQL 聚合结果。

4.  如果需要，我们需要一种可扩展的方式来引入任何新的自定义数据。

你通常如何解决这个问题，而不需要在你的 ORM 上工作太多（例如来自 db 的原始数据）？我相信这已经讨论过很多次了，但我无法找到一个好的谷歌查询来找到任何有用的东西。

**编辑**：由于我后来意识到这个问题的形成不是很好，我决定重新制定它并开始一个[新的](https://stackoverflow.com/questions/621514)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-23T22:22:18.797

如果您只是在浏览器之间获取关系数据，而在两者之间几乎没有或根本没有行为，这听起来像是您试图用 OO 范式解决关系问题。

我可能倾向于完全放弃面向对象的方法。

我的团队最近重写了一个应用程序，问“什么是最简单的可以工作的东西？” 和“最接近问题的语言是什么？”。我们的新应用程序取代了 OO 应用程序，最终变得更小、更快、更便宜了 10 倍。

我们在数据库服务器上使用 SQL、存储过程、XML 库、XSLT（获取 HTML）和 javascript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T17:31:45.777

像我这样的 OOP 纯粹主义者会使用装饰器模式。 [http://en.wikipedia.org/wiki/Decorator_pattern](http://en.wikipedia.org/wiki/Decorator_pattern)

但问题是，有些人可能不需要它提供的灵活性。另外，为每个不同的操作创建新类可能看起来有点过头了，但它提供了良好的编译类型检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-08T01:30:14.433

在我看来，最佳实践是您的应用程序使用[域模型](http://martinfowler.com/eaaCatalog/domainModel.html)模式来使用数据。领域模型可以提供业务逻辑方法来执行有意义且与您的应用程序需求相关的查询类型。

这些可以获取直接映射到数据库行的“实时”结果，因此可以进行编辑和“保存”。

但此外，域模型可以提供获取只读结果的方法，这些结果太复杂而无法轻松保存回数据库。这包括您的分组聚合查询结果示例，还包括连接查询结果集、作为列的表达式等。

域模型模式提供了一种将应用程序的 OO 设计与物理数据库设计分离的方法。

# java - 将 SiteMesh 与 RequestDispatcher 的 forward() 一起使用

> ID：619699
> 
> 赞同：5
> 
> 时间：2009-03-06T17:28:47.300
> 
> 标签：java, jsp, sitemesh, forward

我正在尝试将[SiteMesh](http://www.opensymphony.com/sitemesh/)集成到使用 Tomcat 5 作为我的容器的遗留应用程序中。我有一个`main.jsp`我正在用一个简单的装饰器装饰的东西。

在`decorators.xml`中，我刚刚定义了一个装饰器：

```
<decorators defaultdir="/decorators">
  <decorator name="layout-main" page="layout-main.jsp">
    <pattern>/jsp/main.jsp</pattern>
  </decorator>
</decorators> 
```

如果我手动转到`http://example.com/my-webapp/jsp/main.jsp`. 但是，在某些地方，servlet 不是重定向到 jsp，而是执行[forward](http://java.sun.com/javaee/5/docs/api/javax/servlet/RequestDispatcher.html#forward(javax.servlet.ServletRequest,%20javax.servlet.ServletResponse))：

```
getServletContext().getRequestDispatcher("/jsp/main.jsp").forward(request, response); 
```

这意味着 URL 保留在类似于`http://example.com/my-webapp/servlet/MyServlet`而不是 jsp 文件的位置，因此没有被修饰，我想是因为它与`decorators.xml`.

我不能做 a`<pattern>/*</pattern>`因为还有其他 jsps 不需要用`layout-main.jsp`. 我不能这样做，`<pattern>/servlet/MyServlet*</pattern>`因为有时`MyServlet`可能会转发到其他时间。`main.jsp``error.jsp`

有没有办法在不对 servlet 的工作方式进行广泛更改的情况下解决这个问题？由于它是一个遗留应用程序，我没有太多的自由来改变事情，所以我希望有一些配置方面的东西可以解决这个问题。

SiteMesh 的文档真的不是很好。我大部分时间都在使用发行版附带的示例应用程序。我真的很喜欢 SiteMesh，并希望我能在这种情况下让它工作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-12T13:18:13.297

我的理解是 SiteMesh 作为 Servlet 过滤器集成到应用程序中。默认情况下，仅针对原始传入请求（在您的情况下是对 servlet 的请求）调用 servlet 过滤器。随后的转发或包含请求不会通过过滤器，因此不会通过站点网格。

但是，您可以使用以下方式指示在转发时调用过滤器：

```
<filter-mapping>
    <filter-name>sitemesh</filter-name>
    <servlet-name>MyServlet</servlet-name>
    <dispatcher>FORWARD</dispatcher>
</filter-mapping> 
```

它指示容器仅对 FORWARD 请求进行操作。其他选项是 INCLUDE 和 REQUEST，你可以有几个元素。

因此，您的选择是更改您的过滤器配置以指定 FORWARD，或者更改您的过滤器映射以匹配 servlet 路径，而不是 JSP 路径。任何一个都应该工作。

# javascript - 将 2 个 javascript 对象连接在一起的正确方法是什么？

> ID：619701
> 
> 赞同：16
> 
> 时间：2009-03-06T17:29:26.173
> 
> 标签：javascript, dependency-injection, passive-view

我目前面临一个难题：将 2 个 javascript 对象连接在一起的正确方法是什么？

想象一个像文本编辑器这样的应用程序，它有几个不同的文件。我有一些代表笔记本视图的 HTML 页面。我有一个文件 notebook.js，其中包含 NotebookController 和 Notebook View 的类定义。

NotebookControler 对象负责在 Notebook 上执行业务逻辑，例如“保存 Notebook”、“Load Notebook”、“New Notebook”。NotebookView 负责管理用于演示的 HTML。它执行诸如“获取/设置笔记本正文”“获取/设置笔记本名称”之类的低级操作。它还侦听 DOM 事件 (onClick) 并触发业务事件 (saveNotebook)。这是我对被动视图模式的尝试。

我希望我的 javascript 客户端代码是面向对象的、分离的关注点和可单元测试的。我想用模拟 NotebookView 测试 NotebookController，反之亦然。这意味着我不能只在 NotebookController 中实例化一个 NotebookView。我也是

*   在我的 notebook.js 中加入一些逻辑，将 2 连接在一起
*   在我的应用程序中有一个全局函数，它知道实例化每个函数并将它们连接在一起
*   使用依赖注入，无论是自产的还是类似 SquirrelIoc 的东西

在 Java 中，选择很自然：使用 Spring。但这似乎不太适合 JavaScript。什么是正确的做法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T23:35:37.277

感谢您的洞察力。我最终编写了一个简单的 JavaScript 依赖注入实用程序。经过一段时间的辩论和您的评论，我突然想到 DI 确实是正确的答案，因为：

1.  它将布线的关注点与业务逻辑完全分离，同时保持布线逻辑接近被布线的事物。
2.  它允许我在我的对象上通用地提供“你们都已连接”回调，以便我可以进行 3 阶段初始化：实例化所有内容，将其全部连接，调用每个人的回调并告诉他们已连接。
3.  检查依赖缺失问题很容易。

所以这里是 DI 实用程序：

```
var Dependency = function(_name, _instance, _dependencyMap) {
    this.name = _name;
    this.instance = _instance;
    this.dependencyMap = _dependencyMap;
}

Dependency.prototype.toString = function() {
    return this.name;
}

CONCORD.dependencyinjection = {};

CONCORD.dependencyinjection.Context = function() {
    this.registry = {};
}

CONCORD.dependencyinjection.Context.prototype = {
    register : function(name, instance, dependencyMap) {
        this.registry[name] = new Dependency(name, instance, dependencyMap);
    }, 
    get : function(name) {
        var dependency = this.registry[name];
        return dependency != null ? dependency.instance : null;
    },

    init : function() {
        YAHOO.log("Initializing Dependency Injection","info","CONCORD.dependencyinjection.Context");
        var registryKey;
        var dependencyKey;
        var dependency;
        var afterDependenciesSet = [];
        for (registryKey in this.registry) {
            dependency = this.registry[registryKey];
            YAHOO.log("Initializing " + dependency.name,"debug","CONCORD.dependencyinjection.Context");

            for(dependencyKey in dependency.dependencyMap) {
                var name = dependency.dependencyMap[dependencyKey];
                var instance = this.get(name);
                if(instance == null) {
                    throw "Unsatisfied Dependency: "+dependency+"."+dependencyKey+" could not find instance for "+name;
                }
                dependency.instance[dependencyKey] = instance; 
            }

            if(typeof dependency.instance['afterDependenciesSet'] != 'undefined') {
                afterDependenciesSet.push(dependency);
            }
        }

        var i;
        for(i = 0; i < afterDependenciesSet.length; i++) {
            afterDependenciesSet[i].instance.afterDependenciesSet();
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T20:03:45.710

依赖注入可能是你最好的选择。与 Java 相比，这方面的某些方面在 JS 代码中更容易实现，因为您可以将一个充满回调的对象传递给 NotebookController。其他方面更难，因为您没有静态代码分析来形式化它们之间的接口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T19:54:30.130

我会说，只需将它们连接在一起：

```
function wireTogether() {
  var v = new View();
  var c = new Controller();
  c.setView(v);
} 
```

但是当然还有另一个问题——你如何测试wireTogether()函数？

幸运的是，JavaScript 是一种真正动态的语言，因此您只需为 View 和 Controller 分配新值：

```
var ok = false;

View.prototype.isOurMock = true;
Controller.prototype.setView = function(v) {
  ok = v.isOurMock;
}

wireTogether();

alert( ok ? "Test passed" : "Test failed" ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-06T18:15:40.970

我有一个用于 javascript 的反转控制库，我很满意。 [https://github.com/fschwiet/jsfioc](https://github.com/fschwiet/jsfioc)。它还支持事件，所以如果你想有一个启动事件，那很好。它可以使用更多文档...

[http://github.com/fschwiet/jsfioc](http://github.com/fschwiet/jsfioc)

另一个（较新的？）选项是 requireJS (http://requirejs.org/)，它有更好的文档和支持。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-12-30T13:37:04.537

还有一个 JavaScript 依赖注入框架：[https ://github.com/briancavalier/wire](https://github.com/briancavalier/wire)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T19:21:34.313

我将尝试对此进行尝试，但是如果没有看到任何实际代码，这会有点困难。就个人而言，我从未见过有人在 (M)VC 上使用 JavaScript 或 IoC 进行过如此具体的尝试。

首先，你要测试什么？如果您还没有，请查看[YUI 测试视频](http://video.yahoo.com/watch/3737228/10267335)，其中包含有关使用 javascript 进行单元测试的一些很好的信息。

其次，当您说“连接该聚合的最佳方式”时，我可能只是将其作为带有控制器的设置器

```
// Production
var cont = new NotebookController();
cont.setView( new NotebookView() );

// Testing the View
var cont = new NotebookController();
cont.setView( new MockNotebookView() );

// Testing the Controller
var cont = new MockNotebookController();
cont.setView( new NotebookView() );

// Testing both
var cont = new MockNotebookController();
cont.setView( new MockNotebookView() ); 
```

但这对您已经如何设计控制器和视图对象做出了一些重大假设。

# .net - 我可以使用 ASP.NET 获得“WAR 文件”类型的部署吗？

> ID：619704
> 
> 赞同：5
> 
> 时间：2009-03-06T17:30:42.287
> 
> 标签：.net, asp.net, deployment, archive

有时，精通 J2EE 的人看着 ASP.NET 并想知道，*将应用程序部署为单个单元的支持在哪里*？JSP/Servlet 应用程序可以部署为 WAR 文件，所有页面、内容、元数据和代码都在一个存档中。战争文件可以进行版本控制，轻松移动。可以保证整个应用程序包含在一个单元中。

这不是 ASP.NET 的主流方法。人们做什么？他们是否求助于复制目录和所有无数文件？这对 ASP.NET 开发人员来说不是问题吗？

（这有点作弊，因为我会建议我自己的答案）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T17:37:40.583

虽然不是 ASP.NET 中的主流方法，但这是非常可能的，使用称为`VirtualPathProvider`for ASP.NET 的构造。有了它，您可以从非文件系统的东西中提供网站内容。例如，您可以直接使用 ZIP 文件为 ASP.NET 网站提供服务，而无需先将文件解压缩到磁盘。

[这是一个](http://code.msdn.microsoft.com/DotNetZip/Release/ProjectReleases.aspx?ReleaseId=2269)演示或说明概念的下载，它使用 DotNetZip 库来帮助 ASP.NET 从 zip 中提取内容。

有趣的代码位：

```
using Ionic.Zip;

namespace Ionic.Zip.Web.VirtualPathProvider
{
    public class ZipFileVirtualPathProvider : System.Web.Hosting.VirtualPathProvider
    {
        ZipFile _zipFile;

        public ZipFileVirtualPathProvider (string zipFilename)
            : base () {
            _zipFile =  ZipFile.Read(zipFilename);
        }

        ~ZipFileVirtualPathProvider () {
            _zipFile.Dispose ();
        }

        public override bool FileExists (string virtualPath)
        {
            string zipPath = Util.ConvertVirtualPathToZipPath (virtualPath, true);
            ZipEntry zipEntry = _zipFile[zipPath];

            if (zipEntry != null)
            {
                return !zipEntry.IsDirectory;
            }
            else
            {
                // Here you may want to return Previous.FileExists(virtualPath) instead of false
                // if you want to give the previously registered provider a process to serve the file
                return false;
            }
        }

        public override bool DirectoryExists (string virtualDir)
        {
            string zipPath = Util.ConvertVirtualPathToZipPath (virtualDir, false);
            ZipEntry zipEntry = _zipFile[zipPath];

            if (zipEntry != null)
            {
                return zipEntry.IsDirectory;
            }
            else
            {
                // Here you may want to return Previous.DirectoryExists(virtualDir) instead of false
                // if you want to give the previously registered provider a chance to process the directory
                return false;
            }
        }

        public override VirtualFile GetFile (string virtualPath) {
            return new ZipVirtualFile (virtualPath, _zipFile);
        }

        public override VirtualDirectory GetDirectory (string virtualDir)
        {
            return new ZipVirtualDirectory (virtualDir, _zipFile);
        }

        public override string GetFileHash(string virtualPath, System.Collections.IEnumerable virtualPathDependencies)
        {
            return null;
        }

        public override System.Web.Caching.CacheDependency GetCacheDependency(String virtualPath, System.Collections.IEnumerable virtualPathDependencies, DateTime utcStart)
        {
            return null;
        }
    }
} 
```

VPP 构造适用于 ASP.NET 2.0 或更高版本，适用于任何网站。您当然可以调整这个想法以从数据库、CMS 或...中获取内容？？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T03:21:26.610

部分解决方案是[嵌入式资源](http://aspalliance.com/726)。这会处理所有的静态文件。

解决方案的一部分是使用[Web 部署项目](http://www.microsoft.com/downloads/details.aspx?familyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&displaylang=en)，将所有页面（即网站不可更新）编译为单个程序集。这会处理所有的 .cs 文件。

所以剩下的是 bin 中的 .dll，支持 .dll 文件和 .aspx 存根文件。默认情况下，IIS 希望 aspx 文件在它尝试服务器之前存在，因此是存根。

# asp.net - 禁用 ASP.NET 气球弹出窗口

> ID：619711
> 
> 赞同：9
> 
> 时间：2009-03-06T17:33:22.793
> 
> 标签：asp.net

有没有办法禁用启动 asp.net 应用程序时弹出的烦人的气球通知？这是我正在谈论的图片：

[![烦人的气球通知](https://i.stack.imgur.com/yeh3f.png)](https://i.stack.imgur.com/yeh3f.png)

[http://i41.tinypic.com/2prd3b7.png](http://i41.tinypic.com/2prd3b7.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T17:37:24.390

我查看了 VS 和内置服务器设置，但无论如何都没有看到禁用它，所以我不相信这是可能的。您可以改为[禁用所有气球提示。](http://support.microsoft.com/kb/307729)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T17:38:06.043

使用 IIS 来运行/调试您的应用程序？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T17:50:55.250

您可以查看 Cassini 源代码，看看是什么触发了它（VS 中的“ASP.NET 开发服务器”仍然基于旧的 Cassini Web 服务器）。

此外，我不会停止弹出窗口，因为您有时可能需要记下端口号。

# language-agnostic - 没有标准也没有企业支持的语言的未来

> ID：619715
> 
> 赞同：2
> 
> 时间：2009-03-06T17:35:10.200
> 
> 标签：language-agnostic, programming-languages

多年来，我们已经看到（嗯，我有 :) 多种语言来来去去。有些人更容易接受，有些人则少一些。所以我想知道，您认为哪些因素最能影响该语言的生存？它是否会有未来几年（我的意思是几十年左右）？

例如，fortran 和 C 经受住了时间的考验。虽然它们很受欢迎，但它们也有很好的企业支持、融资和标准规范（ANSI 和 ISO）。

我今天看到的一些现代语言虽然很流行，但没有这些（当前的实现通常被认为是标准的）。暂时这一切都很好，但是 10 或 20 年后，他们的作者可能不再在这里了。我很少看到开源语言过渡到企业融资。

如果你能简单地说几句，在你看来，什么是语言生存的最重要因素，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T17:38:43.030

**Ruby**很受欢迎，尽管它没有企业支持。它已经存在 14 年了。

**Perl**已经存在了 22 年，而且可能还会存在更多年。

**Python**没有公司的支持*（好吧，不知道您是否会算上 Google 的参与度）*，但它却为财富 500 强公司提供了支持。

另一方面：

**帕斯卡**得到了企业的支持并去世了。

**Ada**有公司的支持，它实际上已简化为用于航空电子设备的 DSL。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T17:57:51.190

**每一种未来的语言都需要使现有的问题变得简单**

例如，在当今的大多数语言中，并发编程并不容易。这将通过一种新语言来解决，因为我们不能轻易地将现有的范式哄骗到平行世界中。看看 Java，它是从头开始构建的，考虑到线程，它有很多警告，你甚至敢于进行并发编程。

我们需要一个让并发编程变得如此简单的系统，我们甚至不需要考虑它。我们需要一个记忆模型来保护我们不必考虑这些问题。对于那些无法想象这样一个世界的人来说，你只是停留在我们当前的范式中。我们将需要改变我们开发软件的方式来实现这一点。严重的问题需要改变。

语言生存的另一种方式是将其附加到整个系统。看看Objective C，它是所有苹果产品的苹果语言。我认为这是要走的路。设计一个配得上它自己的语言的系统。

还有很多其他的例子，这个问题我想了很久。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T18:01:57.780

我认为答案很大程度上取决于你定义生存的时间范围。这很重要，因为我认为有三个因素随着时间的推移发生了变化，并且仍在变化：

1.  硬件性能（即速度或内存）
2.  硬件复杂度（即单核与多核）
3.  软件复杂性

我认为 C 语言能够幸存下来的原因是，直到最近几年，许多应用程序仍然非常需要最高性能。也许总会有这种需求，但我认为它在过去几年里变得越来越不重要。我认为它总会存在，但如果它在 20 年后被广泛使用，我会感到惊讶；在过去的五年里，它已经开始被 C#/Java/etc 所取代。

最近（我的意思是过去五年左右）像 Python 这样的语言的兴起也是对这样一个事实的回应：软件变得越来越复杂，而性能已经不再是一个问题。因为消费者重视“现在”，所以有很大的动力去快速发展，如果有的话，以后会担心速度。这对您使用哪种语言进行开发有很大的影响。

如果您将未来延长到 20 年以上，我认为清晰度、可维护性和易用性是生存的最重要因素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T17:45:57.507

据我所知，Fortran 在建立起来之前没有公司的支持。C 得到了 AT&T 的支持，但他们真的不在乎是否有其他人改编它。并且在他们拥有 ANSI 标准之前都已经很好地建立了（另外，请注意 ANSI 和 ISO 提供标准*规范*，而不是实现）

另一方面，IBM 大力支持和推广 PL/I，但从未真正流行起来。美国政府试图让我们所有人都写《艾达》，但这也没有奏效。

那么，有什么作用呢？好问题。让学校教它是件好事（当大学转向 C++ 和 Java 时，Pascal 几乎消失了）。最近有“网络上的嗡嗡声”很好（引用：Java、Ruby）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T17:54:34.240

为了让一门语言生存下来，它需要几件事：

*   它需要比其他类似选项更好地解决问题。这是主观方面，开发人员觉得它更好，所以他们采用它。
*   它需要有良好的工具。没有好的工具，语言永远不会流行起来。
*   它需要围绕它建立一个强大的社区。一个提供帮助、帮助、组件等的社区......

我不认为企业支持对这些项目有直接影响。我认为它可以使诸如开发工具之类的事情变得更有可能，但是有太多的例子表明它有助于或没有帮助采用一种语言。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-06T17:56:00.150

开源社区变得更像是一个巨大的公司，不是吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-06T17:59:22.107

语言在被使用和人们准备好维护它们的过程中仍然存在。人们通常准备在使用语言时维护它。如果不使用一种语言，它就会死亡。

可能有各种各样的事情促成或决定一种语言是否消亡。如果企业赞助商不再看到该语言的好处（利润），或者他们希望人们使用替代方案，并且企业赞助商不愿意将代码发布到开源，那么企业赞助的语言就会消失，并且没有开源选择。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-06T18:17:01.737

我没有看到证据表明企业支持或标准化足以确定一种语言是否存在。有许多公司支持的语言未能获得稳固的立足点（我想到了 ADA）。有许多标准化语言（Common Lisp）也失败了。另一方面，有很多非标准的非企业语言（Perl、PHP、Ruby）越来越受欢迎。那里似乎没有因果关系。

一种语言的生存能力实际上是由它周围的社区决定的。有一个正反馈循环。更多的用户意味着更多的支持和更多的库，这反过来又意味着更多的用户。流行语言可能会衰落，但它们并没有完全消亡。很长时间没有。

如果我正在寻找一种语言来用于必须持久的东西，那么我心中的两个最大标准是：

1.  它适用于我的问题域吗？
2.  社区是否强大到足以自我延续？

如果这两个问题的答案是正确的，请使用该语言。如果任何一个答案都是错误的，请不要。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-06T17:44:15.280

而其他语言几乎被他们的企业支持杀死 = Delphi

# c# - 为什么要转换为接口？

> ID：619716
> 
> 赞同：41
> 
> 时间：2009-03-06T17:35:13.647
> 
> 标签：c#, interface, casting

在 Jesse Liberty 的 Programming C# (p.142) 中，他提供了一个将对象强制转换为接口的示例。

```
 interface IStorable
 {
    ...
 }

 public class Document : IStorable
 {
    ...
 }

 ...
 IStorable isDoc = (IStorable) doc;  
 ... 
```

这有什么意义，特别是如果对象的类无论如何都实现了接口？

EDIT1：澄清一下，我对强制转换的**原因（如果有的话）**感兴趣，*而不是*实现接口的原因。此外，这本书是他 2001 年的第一版（基于 C#1，因此该示例可能与更高版本的 C# 无关）。

EDIT2：我在代码中添加了一些上下文

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-06T17:40:04.713

因为您想将自己限制为仅使用接口提供的方法。如果使用该类，则可能会（无意中）调用不属于接口的方法。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-06T18:07:25.020

真正需要强制转换的原因只有一个：当 doc 是实现 IStorable 的实际对象的基本类型时。让我解释：

```
public class DocBase
{
  public virtual void DoSomething()
  {

  }
}

public class Document : DocBase, IStorable
{
  public override void DoSomething()
  {
    // Some implementation
    base.DoSomething();
  }

  #region IStorable Members

  public void Store()
  {
    // Implement this one aswell..
    throw new NotImplementedException();
  }

  #endregion
}

public class Program
{
  static void Main()
  {
    DocBase doc = new Document();
    // Now you will need a cast to reach IStorable members
    IStorable storable = (IStorable)doc;
  }
}

public interface IStorable
{
  void Store();
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-06T17:39:17.693

如果对象显式地实现了接口（`public void IStorable.StoreThis(...)`），那么强制转换是实际到达接口成员的最简单方法。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-03-06T17:57:04.173

我不确定书中给出的例子是在什么背景下给出的。但是，您通常可以将对象类型强制转换为接口以实现多重继承。我已经给出了下面的例子。

```
public interface IFoo
{
     void Display();
}
public interface IBar
{
     void Display();
}

public class MyClass : IFoo, IBar
{
    void IBar.Display()
    {
        Console.WriteLine("IBar implementation");
    }
    void IFoo.Display()
    {
        Console.WriteLine("IFoo implementation");
    }
}

public static void Main()
{
    MyClass c = new MyClass();
    IBar b = c as IBar;
    IFoo f = c as IFoo;
    b.Display();
    f.Display();
    Console.ReadLine();
} 
```

这将显示

> IBar 实现
> IFoo 实现

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-06T17:41:05.770

如果没有更多的上下文，这很难说。如果变量`doc`被声明为实现接口的类型，则强制转换是多余的。

你读的是哪个版本的书？如果是“Programming C# 3.0”，我今晚在家的时候看看。

编辑：正如我们迄今为止在答案中看到的，这里有三个潜在的问题：

*   为什么要在问题中显示的语句中进行转换？`doc`（答案：如果是适当的编译时类型，您不必这样做）
*   为什么显式转换为已实现的接口或基类是合适的？（答案：如另一个答案所示的显式接口实现，也是为了在将强制转换值作为参数传递时选择不太具体的重载。）
*   为什么要使用界面？（答案：使用接口类型意味着您以后不太容易受到具体类型的变化的影响。）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-06T17:42:45.173

`doc`对象可能是显式实现成员的类型，而`IStorable`不是将它们添加到类的主接口（即，它们只能通过接口调用）。

实际上，“转换”（使用 (T) 语法）没有任何意义，因为 C# 会自动处理向上转换（转换为父类型）（例如，与 F# 不同）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-06T18:24:12.000

这里有很多很好的答案，但我真的不认为他们能回答为什么你真的想使用最严格的界面。

原因不涉及您的初始编码，它们涉及您下次访问或重构代码时 - 或其他人这样做时。

假设您想要一个按钮并将其放在屏幕上。您正在获取传入或来自另一个函数的按钮，如下所示：

```
Button x=otherObject.getVisibleThingy();
frame.add(x); 
```

你碰巧知道 VisibleThingy 是一个按钮，它返回一个按钮，所以这里的一切都很酷（不需要强制转换）。

现在，假设您重构 VisibleThingy 以返回一个切换按钮。您现在必须重构您的方法，因为您对实现了解太多。

由于您只需要 Component 中的方法（按钮和 Toggle 的父级，这可能是一个接口——对于我们的目的来说几乎相同），如果您像这样编写第一行：

```
Component x=(Component)otherObject.getVisibleThingy(); 
```

你不必重构任何东西——它会起作用的。

这是一个非常简单的案例，但它可能要复杂得多。

所以我想总结一下，界面是一种“查看”对象的特定方式——比如通过过滤器查看它……你只能看到一些部分。如果您可以足够地限制您的视图，则该对象可以“变形”在您的特定视图之后，并且不会影响您当前世界中的任何东西——这是一个非常强大的抽象技巧。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-06T18:29:14.080

强制转换为接口的最佳原因是，如果您正在编写针对对象的代码并且您不知道它们是什么具体类型并且您不想这样做。

如果您知道您可能会遇到一个实现特定接口的对象，那么您可以从该对象中获取值，而无需知道该对象的具体类。此外，如果您知道一个对象实现了给定的接口，那么该接口可能会定义您可以执行的方法以对对象执行某些操作。

这是一个简单的例子：

```
public interface IText
{
   string Text { get; }
}

public interface ISuperDooper
{
   string WhyAmISuperDooper { get; }
}

public class Control
{
   public int ID { get; set; }
}

public class TextControl : Control, IText
{
   public string Text { get; set; }
}

public class AnotherTextControl : Control, IText
{
   public string Text { get; set; }
}

public class SuperDooperControl : Control, ISuperDooper
{
   public string WhyAmISuperDooper { get; set; }
}

public class TestProgram
{
   static void Main(string[] args)
   {
      List<Control> controls = new List<Control>
               {
                   new TextControl
                       {
                           ID = 1, 
                           Text = "I'm a text control"
                       },
                   new AnotherTextControl
                       {
                           ID = 2, 
                           Text = "I'm another text control"
                       },
                   new SuperDooperControl
                       {
                           ID = 3, 
                           WhyAmISuperDooper = "Just Because"
                       }
               };

       DoSomething(controls);
   }

   static void DoSomething(List<Control> controls)
   {
      foreach(Control control in controls)
      {
         // write out the ID of the control
         Console.WriteLine("ID: {0}", control.ID);

         // if this control is a Text control, get the text value from it.
         if (control is IText)
            Console.WriteLine("Text: {0}", ((IText)control).Text);

         // if this control is a SuperDooperControl control, get why
         if (control is ISuperDooper)
            Console.WriteLine("Text: {0}", 
                ((ISuperDooper)control).WhyAmISuperDooper);
      }
   }
} 
```

运行这个小程序会给你以下输出：

> 编号：1
> 
> 文本：我是一个文本控件
> 
> 编号：2
> 
> 文本：我是另一个文本控件
> 
> 编号：3
> 
> 文字：只是因为

请注意，我不必在 DoSomething 方法中编写任何代码，这些代码要求我了解有关我正在处理的所有对象的任何事情，这些对象是具体的对象类型。我唯一知道的是我正在处理至少是 Control 类的实例的对象。然后我可以使用该界面找出他们可能还有什么。

有上百万种不同的原因可以让您在对象上使用这种方法，但它为您提供了一种访问对象的松散方式，而无需确切知道它是什么。

想想世界上所有的信用卡，每个公司都有自己的信用卡，但是界面是一样的，所以每个读卡器都可以刷一张符合标准的卡。类似于接口的使用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-06T18:21:44.347

正如已经指出的，铸造是多余的并且不是必需的。然而，它是一种更明确的编码形式，有助于初学者理解。

在入门教材中，最好是显式地行动，而不是让编译器隐式地做事，这样对初学者来说会比较混乱。

“doc”不是“IStorable”类型的，因此初学者看到它被分配给 isDoc 会感到困惑。通过显式转换，作者（本书和代码）说文档可以转换为 IStorable 对象，但它与 IStorable 对象不同。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-06T17:46:21.047

关键是，对象（你从哪里得到的？）可能**没有**实现接口，在这种情况下会抛出异常，可以捕获和处理。当然，您可以使用“is”运算符进行检查，并使用“as”运算符进行强制转换，而不是 C 风格的强制转换。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-09T12:27:37.043

为了允许代码片段之间的最大解耦......

有关更多信息，请参阅以下文章： [接口](http://codebetter.com/blogs/karlseguin/archive/2009/03/04/back-to-basics-interfaces.aspx)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-11-06T18:24:53.013

您将显式转换为接口的主要原因是接口的成员是否被显式实现（即具有 形式的完全限定名称`InterfaceName.InterfaceMemberName`）。这是因为当您使用接口名称完全限定它们时，这些成员实际上并不是实现类 API 的一部分。您*只能*通过转换到界面来获得它们。

这是一个可以按原样运行的示例：

```
using System;

public interface ISomethingDoer {
    void DoSomething();
}

public class ThingA : ISomethingDoer {

    public void DoSomething(){
        Console.WriteLine("ThingA did it!");
    }
}

public class ThingB : ISomethingDoer {

    // This is implemented explicitly by fully-qualifying it with the interface name
    // Note no 'scope' here (e.g. public, etc.)
    void ISomethingDoer.DoSomething(){ 
        Console.WriteLine("ThingB did it!");
    }
}

public static class Runner {

    public static void Main(){

        var a = new ThingA();
        a.DoSomething(); // Prints 'ThingA did it!'

        var b = new ThingB();
        b.DoSomething(); // NOTE: THIS WILL NOT COMPILE!!!

        var bSomethingDoer = (ISomethingDoer)b;
        bSomethingDoer.DoSomething(); // Prints 'ThingB did it!'
    }
} 
```

！

# c# - ASP.Net (C#) 如何从 HTTP 页面 POST 到 HTTPS

> ID：619741
> 
> 赞同：7
> 
> 时间：2009-03-06T17:40:58.563
> 
> 标签：c#, asp.net, https

C# 3.0 ASP.Net 2.0 IIS6

我有一个常规的 [非 https] 页面。页面上有一个标准的 ASP.Net 格式。

但是，页面上有两个功能“区域”。登录并“获取报价”。登录页面需要 POST 到 HTTPS，而页面的其余部分 [包括“其他区域”] 表单不能是 HTTPS。在 Java [JSP] 和常规 Html 中，我们只有两种形式。一个发布到 HTTPS，一个不发布。

在 ASP.Net [从一页] 中处理这个问题的方法是什么。我知道我可以链接到一个 HTTPS login.aspx 页面，但该业务确实希望将上下文放在一起。

有任何想法吗？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-10-05T17:52:16.220

解决方法是使用 asp.net 指定“跨页回发”，即使用任意按钮控件（LinkBut​​ton、Button、ImageButton 等）的 PostBackUrl 属性。此属性允许您回发到您喜欢的任何页面。只需将您的 PostBackUrl 设置为页面的 https 版本，您就可以开始了（还要确保没有活动的 url 重定向会在您的页面上强制使用 http）。

```
// ensure we send credentials over a secure connection
if (!HttpContext.Current.Request.IsSecureConnection)
{
     string postbackUrl = HttpContext.Current.Request.Url.AbsoluteUri.Replace("http", "https");
     LinkButton_Login.PostBackUrl = postbackUrl;
} 
```

在您的特定情况下，您应该将其中一个按钮设置为回发到 https 版本，将另一个按钮设置为 http 版本（如果您没有指定 PostBackUrl，则默认情况下是按原样回发到页面本身）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T15:36:53.910

您可以使用登录事件的 HttpWebRequest 对象通过代码手动发布，然后将返回的响应写回用户的流。

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(webRequest.URL);
request.UserAgent = UserAgent;
request.ContentType = ContentType;
request.Method = "POST";

// Write your bytes of the login section here
 Stream oStream = request.GetRequestStream();
 oStream.Write(webRequest.BytesToWrite, 0, webRequest.BytesToWrite.Length);
 oStream.Close();

 // Send the request and get a response
 HttpWebResponse resp = (HttpWebResponse)request.GetResponse();

 // Read the response
 StreamReader sr = new StreamReader(resp.GetResponseStream());

 // return the response to the screen
 string returnedValue = sr.ReadToEnd();

  sr.Close();
  resp.Close();

  Response.Write(returnedValue); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T18:12:51.233

在一个 aspx 页面上可以有两个表单。你只是不能嵌套它们。

在我建立的一个页面上，我有一个回发到页面的表单，一个回发到 Google Checkout 的表单。

如果您必须混合页面的内容，请将 https 表单放在页面底部（在主表单标记之后）并用隐藏字段填充它。当用户单击按钮时，使用 Javascript 为隐藏字段分配值，然后发布 https 表单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T03:37:35.640

HTTP 和 HTTPS 页面是否位于同一服务器/同一应用程序的一部分？

如果是这样，您也许可以使用 Server.Transfer() 方法来保持表单完整，但也可以使用 HTTPS。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T17:58:53.840

我从您的上下文中假设您正在做一件事或另一件事，而不是同时做两件事。

查看按钮对象的 PostbackURL。
登录按钮可以回发到“ [https://secure.login.com](https://secure.login.com) ”

另一个按钮只能回发到页面本身。

这里的问题是您仍然会将登录字段发回不安全的页面，这意味着它们没有加密，并且可能被嗅探。

如果按下“获取报价”按钮，快速而肮脏的解决方法是让 javascript 在发布之前清除登录字段。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-30T15:27:51.047

在 ASP.Net 3.5 中（可能是 SP1——忘记它是在基础库还是在 SP 中）您现在可以设置“动作”属性。但这会使它为两种“表单”发布到 HTTPS。

如果您想在同一页面上拥有两个表单，并确定在“运行时”发布到哪个表单，则必须使用客户端代码来完成。在所有触发回发或挂钩到 _dopostback （或任何它被称为 - 懒得查找）函数的对象上都有客户端处理程序，并让它检查按下了哪个按钮。如果是非安全页面，则首先清除登录字段中的所有数据。然后自己手动触发回发到正确的页面。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-08T09:24:13.500

你不能只做一个 Response.Redirect(" [https://.../Login.aspx](https://.../Login.aspx) "); 在登录按钮单击事件中。

# c# - 如何从 GAC 正确加载 PresentationFramework 程序集？

> ID：619751
> 
> 赞同：1
> 
> 时间：2009-03-06T17:42:50.510
> 
> 标签：c#, reflection

我需要动态获取 PresentationFramework 程序集中的控件列表。现在，我可以使用这段代码加载程序集：

```
 var asmName = new AssemblyName("PresentationFramework, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35");
var asm = Assembly.Load(asmName); 
```

但是，如果将来框架更新到更高版本，上述代码将无法获取新的程序集。请告诉我如何以正确的方式做到这一点。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T18:00:07.287

我认为没有办法在 GAC 中自动获取最新版本的程序集，因为这可能会再次导致整个“DLL Hell”问题。强命名程序集（GAC 中的所有程序集都必须如此）在其名称中包含其版本号，以确保您加载的正是您期望的版本。这将防止较新版本的程序集破坏您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T13:40:38.770

它已折旧，但您可以使用：

```
Assembly.LoadWithPartialName("PresentationFramework"); 
```

# keyboard-shortcuts - 如何在 Notepad++ 中模仿 Visual Studio 的 CTRL-X、CTRL-V 功能？

> ID：619754
> 
> 赞同：25
> 
> 时间：2009-03-06T17:44:36.403
> 
> 标签：keyboard-shortcuts, notepad++

我在某些项目中使用 Notepad++ 并且错过了 Visual Studio 的`Ctrl`+ `X`、`Ctrl`+`C`功能，该功能会在未选择文本时剪切或复制整个当前行。剪切线快捷键好像是`Ctrl`+ `L`，不如`Ctrl`+方便`X`，复制快捷键好像是`Ctrl`+ `D`, `Ctrl`+ `L`，更不方便。

虽然之前已经问过[类似的问题](https://stackoverflow.com/questions/128625/stand-alone-text-editor-with-visual-studio-editor-functionality)，但没有提供在 Notepad++ 中执行此操作的方法，我在 Notepad++ 网站或其论坛上找不到解决方案。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-29T21:00:51.710

我创建了一个 Notepad++ 插件（不需要 python）。它可以在[https://bitbucket.org/zastrowm/notepad-visualstudiolinecopy](https://bitbucket.org/zastrowm/notepad-visualstudiolinecopy)找到。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-11-29T21:59:33.673

Synthesizing all other answers and comments, plus some additional necessary steps that haven't been mentioned:

Scintilla provides a "copyAllowLine" command that does this. Notepad++ doesn't expose that command in the shortcut mapper, but you can call it from a Python script and map `Ctrl` + `C` to that script. There is no corresponding command for "cutAllowLine", but a bit of extra Python code will do it. These scripts must be added to the menu and Notepad++ must restart before they will become available in the shortcut mapper.

1.  Install [Python Script](http://npppythonscript.sourceforge.net/) plugin(can be done with Notepad++ Plugin Manager)

2.  Create the following two python scripts using the menu Plugins -> Python Script -> New script

    ### copyAllowLine.py

    ```
    editor.copyAllowLine() 
    ```

    ### cutAllowLine.py

    ```
    if editor.getSelectionStart() == editor.getSelectionEnd():
        editor.lineCut()
    else:
        editor.cut() 
    ```

3.  Python Script -> Configuration

    *   under **User Scripts**, add a menu item for each script.

4.  Restart notepad++ (important)

5.  Settings -> Shortcut Mapper...

    *   under **Scintilla Commands**, remove the existing associations for `Ctrl` + `C` and `Ctrl` + `X`.

    *   under **Plugin commands**, find the scripts you just created and map your shortcuts to them.

Note: when installed via plugin manager, version 1.0.6 was installed. When I attempted to run anything python related in Notepad++ I got an unknown exception from plugin manager. The solution was to manually download and install the 1.0.8 .msi from here: [1.0.8 installer](http://sourceforge.net/projects/npppythonscript/files/Python%20Script%201.0.8.0/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-10-03T03:50:37.010

1.  安装[NppPython 插件](http://npppythonscript.sourceforge.net/)（可以使用 Notepad++ 插件管理器完成）
2.  使用菜单 Plugins -> Python Script -> New script 创建这个 python 脚本：

    ```
    if editor.getSelectionStart() == editor.getSelectionEnd():
        editor.lineCut()
    else:
        editor.cut() 
    ```

3.  重启记事本++（重要）

4.  转到菜单设置 -> 快捷方式映射器 -> 插件命令

5.  在列表中找到刚刚创建的脚本，并为其设置 CTRL+X 快捷方式

6.  享受！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-06T17:55:51.307

转到设置->快捷方式映射器，然后单击顶部的“闪烁命令”选项卡。在那里，您应该能够将`Ctrl`+`L`命令更改为`Ctrl` + `X`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-05T08:27:17.520

您可以使用 Python Script Notepad++ 插件添加脚本，并将`Ctrl`+分配`C`给脚本（从快捷方式映射器、Scintilla 命令选项卡中的 SCI_COPY 中删除`Ctrl`+映射）`C`

脚本只是：

```
if editor.getSelectionStart() == editor.getSelectionEnd():
    line = editor.getCurLine()
    editor.copyText(line)
else:
    editor.copy() 
```

显然，只需为 Ctrl-X 添加另一个类似的脚本来删除该行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-06T19:53:23.683

MackieChan的插件[：notepad-visual studio line copy](https://bitbucket.org/zastrowm/notepad-visualstudiolinecopy)

仍然必须设置如下：

1.  放入notepad++/plugin文件夹

2.  打开记事本++（重启）

3.  在设置 -> 快捷方式映射器

    在**Scintilla Commands**下，删除 Ctrl + C,X 的现有关联

    在**Plugin commands**下，找到您刚刚创建的脚本并将您的快捷方式映射到它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-21T18:24:43.310

[在https://github.com/kbilsted/NppPluginCutNCopyLine](https://github.com/kbilsted/NppPluginCutNCopyLine)有一个插件，它是开源的，如果你有额外的需要，代码很容易修改。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2010-09-03T23:20:54.333

您可以编写一个带有全局键事件挂钩的程序，每次您制作`Ctrl`+时都会`X`检查 notepad++ 是否是运行的最重要的应用程序，抓取屏幕，检查是否选择了任何文本（通过查看屏幕截图和您的 notepad++ 颜色设置） , 并将 WM_KEYPRESS 消息发送到模拟`Ctrl`+的 notepad++ 窗口`L`（假设您使用的是 Windows）。

（但这不会将行放入剪贴板，您必须进行一些字符识别才能允许它）

# wpf - WPF 组合框 + MouseLeftButtonDown

> ID：619755
> 
> 赞同：0
> 
> 时间：2009-03-06T17:44:49.820
> 
> 标签：wpf, combobox

希望有人可以提供帮助，因为我无法弄清楚这一点。这是我的弹出/组合框的 xaml 代码，请不要在其余布局之前和之后有其他代码。

```
 <Popup x:Name="popupMethods" Height="400" Width="150" 
       StaysOpen="False" Placement="Bottom" IsOpen="false"
       HorizontalAlignment="Left">
                <ComboBox x:Name="combo" MouseLeftButtonDown="combo_MouseDown">
                    <TextBlock>Hello</TextBlock>
                    <TextBlock>World</TextBlock>
                    <TextBlock>This</TextBlock>
                    <TextBlock>is</TextBlock>
                    <TextBlock>Autocomplete</TextBlock>
                    <TextBlock>Textbox</TextBlock>
                </ComboBox>
    </Popup> 
```

将其设置为在用户开始输入时在屏幕上弹出，这很有效。问题是我希望用户能够单击组合框中的一个单词并将其插入到文本框中。这部分不起作用，因为 MouseLeftButtonDown 永远不会被解雇。我尝试了几种不同的方法，包括来自本网站的一种 方法[http://www.designerwpf.com/2008/12/03/getting-a-mouseleftbuttondown-or-mouseleftbuttonup-event-from-your-textbox/](http://www.designerwpf.com/2008/12/03/getting-a-mouseleftbuttondown-or-mouseleftbuttonup-)

以及我在其他地方看到的一个是 combo.MouseLeftButtonDown += delegate { };

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-12-31T03:24:58.957

而不是`MouseLeftButtonDown`事件处理程序，使用`PreviewMouseLeftButtonDown`您可以实现相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T17:57:53.953

你可能想看看这个`SelectionChanged`事件。It fires whenever an item in the ComboBox's drop down is selected.

我认为 ComboBox 在内部处理该`MouseLeftButtonDown`事件，这导致它不会传递给您的代码。

# java - JAXB 继承，解组到编组类的子类

> ID：619761
> 
> 赞同：45
> 
> 时间：2009-03-06T17:46:59.970
> 
> 标签：java, xml, jaxb

我正在使用 JAXB 来读取和写入 XML。我想要的是使用一个基本的 JAXB 类进行编组和一个继承的 JAXB 类进行解组。这是为了允许发送方 Java 应用程序将 XML 发送到另一个接收方 Java 应用程序。发送方和接收方将共享一个公共 JAXB 库。我希望接收器将 XML 解组为扩展通用 JAXB 类的接收器特定 JAXB 类。

例子：

这是发送方使用的通用 JAXB 类。

```
@XmlRootElement(name="person")
public class Person {
    public String name;
    public int age;
} 
```

这是在解组 XML 时使用的接收器特定的 JAXB 类。接收器类具有特定于接收器应用程序的逻辑。

```
@XmlRootElement(name="person")
public class ReceiverPerson extends Person {
    public doReceiverSpecificStuff() ...
} 
```

编组按预期工作。问题在于解组，`Person`尽管 JAXBContext 使用 subclassed 的包名称，它仍然解组`ReceiverPerson`。

```
JAXBContext jaxbContext = JAXBContext.newInstance(package name of ReceiverPerson); 
```

我想要的是解组到`ReceiverPerson`. 我能够做到这一点的唯一方法是`@XmlRootElement`从`Person`. 不幸的是，这样做可以防止`Person`被编组。就好像 JAXB 从基类开始并向下工作，直到找到`@XmlRootElement`具有适当名称的第一个。我试过添加一个`createPerson()`返回的方法，`ReceiverPerson`但这`ObjectFactory`没有帮助。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-18T03:23:48.220

下面的代码片段是一个带绿灯的 Junit 4 测试方法：

```
@Test
public void testUnmarshallFromParentToChild() throws JAXBException {
  Person person = new Person();
  int age = 30;
  String name = "Foo";
  person.name = name;
  person.age= age;

  // Marshalling
  JAXBContext context = JAXBContext.newInstance(person.getClass());
  Marshaller marshaller = context.createMarshaller();

  StringWriter writer = new StringWriter();
  marshaller.marshal(person, writer);

  String outString = writer.toString();

  assertTrue(outString.contains("</person"));

  // Unmarshalling
  context = JAXBContext.newInstance(Person.class, RecieverPerson.class);
  Unmarshaller unmarshaller = context.createUnmarshaller();
  StringReader reader = new StringReader(outString);
  RecieverPerson reciever = (RecieverPerson)unmarshaller.unmarshal(reader);

  assertEquals(name, reciever.name);
  assertEquals(age, reciever.age);
} 
```

重要的部分是`JAXBContext.newInstance(Class... classesToBeBound)`解组上下文的方法的使用：

```
 context = JAXBContext.newInstance(Person.class, RecieverPerson.class); 
```

通过这个调用，JAXB 将计算指定类的引用闭包并识别`RecieverPerson`. 测试通过。如果你改变参数顺序，你会得到一个`java.lang.ClassCastException`（所以它们**必须**按这个顺序传递）。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-11T22:14:23.467

您使用的是 JAXB 2.0 对吗？（从JDK6开始）

有一个类：

```
javax.xml.bind.annotation.adapters.XmlAdapter<ValueType,BoundType> 
```

哪一个可以子类化，并覆盖以下方法：

```
public abstract BoundType unmarshal(ValueType v) throws Exception;
public abstract ValueType marshal(BoundType v) throws Exception; 
```

例子：

```
public class YourNiceAdapter
        extends XmlAdapter<ReceiverPerson,Person>{

    @Override public Person unmarshal(ReceiverPerson v){
        return v;
    }
    @Override public ReceiverPerson marshal(Person v){
        return new ReceiverPerson(v); // you must provide such c-tor
    }
} 
```

使用方法如下：

```
@Your_favorite_JAXB_Annotations_Go_Here
class SomeClass{
    @XmlJavaTypeAdapter(YourNiceAdapter.class)
    Person hello; // field to unmarshal
} 
```

我很确定，通过使用这个概念，您可以自己控制编组/解组过程（包括选择要构造的正确 [sub|super] 类型）。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-18T09:15:48.980

子类 Person 两次，一次用于接收者，一次用于发送者，并且只将 XmlRootElement 放在这些子类上（留下超类`Person`，没有 XmlRootElement）。请注意，发送者和接收者都共享相同的 JAXB 基类。

```
@XmlRootElement(name="person")
public class ReceiverPerson extends Person {
  // receiver specific code
}

@XmlRootElement(name="person")
public class SenderPerson extends Person {
  // sender specific code (if any)
}

// note: no @XmlRootElement here
public class Person {
  // data model + jaxb annotations here
} 
```

[经过测试并确认可与 JAXB 一起使用]。当继承层次结构中的多个类具有 XmlRootElement 注释时，它可以避免您注意到的问题。

这也可以说是一种更简洁、更面向对象的方法，因为它分离了通用数据模型，所以它根本不是一个“解决方法”。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-12-01T05:24:09.487

创建一个自定义 ObjectFactory 以在解组期间实例化所需的类。例子：

```
JAXBContext context = JAXBContext.newInstance("com.whatever.mypackage");
Unmarshaller unmarshaller = context.createUnmarshaller();
unmarshaller.setProperty("com.sun.xml.internal.bind.ObjectFactory", new ReceiverPersonObjectFactory());
return unmarshaller;

public class ReceiverPersonObjectFactory extends ObjectFactory {
    public Person createPerson() {
        return new ReceiverPerson();
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-06T18:42:00.727

我不确定您为什么要这样做……对我来说似乎并不那么安全。

考虑在 ReceiverPerson 中会发生什么有额外的实例变量......然后你会结束（我猜）这些变量是 null、0 或 false......如果不允许 null 或数字必须大于 0 怎么办?

我认为您可能想要做的是在 Person 中读取，然后从中构造一个新的 ReceiverPerson（可能提供一个接受 Person 的构造函数）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-17T09:26:51.497

由于您确实有两个单独的应用程序，因此请使用“Person”类的不同版本编译它们 - 接收器应用程序没有`@XmlRootElement(name="person")`. `Person`这不仅丑陋，而且还破坏了对发送者和接收者使用相同的 Person 定义所需的可维护性。它的一个可取之处是它可以工作。

# c - 在 c 中表示任意大数字的最佳方法是什么？

> ID：619764
> 
> 赞同：5
> 
> 时间：2009-03-06T17:48:17.860
> 
> 标签：c, biginteger

我正在做一个项目，该项目需要我处理大于 c 中最大数值数据类型的数字。我正在考虑使用带有位字段的结构来表示这一点，但它已经很难闻了。有人有任何提示吗？（不是在寻找一个图书馆，更多的是一个思考过程来做这样的事情。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-06T17:50:28.417

[GNU MP Bignum 库](http://gmplib.org/)是我的首选。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-06T17:55:33.897

我建议首先查看 GNU MP Bignum 库。

如果许可是一个问题，您必须自己动手。我对数据类型的第一选择是一个简单的无符号字符数组以及一些额外的数据来表示该数组有多大。

像这样的东西：

```
typedef struct 
{
  unsigned char * NumberData;
  size_t          AllocatedSize;
} MyBigNum; 
```

应该足够了。

# c# - 使用反射设置对象属性

> ID：619767
> 
> 赞同：364
> 
> 时间：2009-03-06T17:50:10.960
> 
> 标签：c#, .net, reflection, properties

在 C# 中有没有一种方法可以使用反射来设置对象属性？

前任：

```
MyObject obj = new MyObject();
obj.Name = "Value"; 
```

我想设置`obj.Name`反射。就像是：

```
Reflection.SetProperty(obj, "Name") = "Value"; 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：437
> 
> 时间：2009-03-06T17:52:41.517

是的，您可以使用`Type.InvokeMember()`：

```
using System.Reflection;
MyObject obj = new MyObject();
obj.GetType().InvokeMember("Name",
    BindingFlags.Instance | BindingFlags.Public | BindingFlags.SetProperty,
    Type.DefaultBinder, obj, "Value"); 
```

`obj`如果没有名为 的属性`Name`，或者无法设置，这将引发异常。

另一种方法是获取属性的元数据，然后设置它。这将允许您检查属性是否存在，并验证它是否可以设置：

```
using System.Reflection;
MyObject obj = new MyObject();
PropertyInfo prop = obj.GetType().GetProperty("Name", BindingFlags.Public | BindingFlags.Instance);
if(null != prop && prop.CanWrite)
{
    prop.SetValue(obj, "Value", null);
} 
```

* * *

## 回答 #2

> 赞同：319
> 
> 时间：2009-03-06T17:55:33.473

你也可以这样做：

```
Type type = target.GetType();

PropertyInfo prop = type.GetProperty("propertyName");

prop.SetValue (target, propertyValue, null); 
```

其中 target 是将设置其属性的对象。

* * *

## 回答 #3

> 赞同：99
> 
> 时间：2012-01-20T14:05:09.753

反射，基本上，即

```
myObject.GetType().GetProperty(property).SetValue(myObject, "Bob", null); 
```

或者有一些库可以在便利性和性能方面提供帮助；例如使用[FastMember](http://nuget.org/packages/FastMember)：

```
var wrapped = ObjectAccessor.Create(obj); 
wrapped[property] = "Bob"; 
```

（这还有一个好处是不需要提前知道是字段还是属性）

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2013-07-16T19:03:37.160

或者你可以在你自己的扩展类中包装 Marc 的一个衬垫：

```
public static class PropertyExtension{       

   public static void SetPropertyValue(this object obj, string propName, object value)
    {
        obj.GetType().GetProperty(propName).SetValue(obj, value, null);
    }
} 
```

并这样称呼它：

```
myObject.SetPropertyValue("myProperty", "myValue"); 
```

为了更好地衡量，让我们添加一个方法来获取属性值：

```
public static object GetPropertyValue(this object obj, string propName)
{
        return obj.GetType().GetProperty(propName).GetValue (obj, null);
} 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2012-01-20T14:07:23.457

是的，使用`System.Reflection`：

```
using System.Reflection;

...

    string prop = "name";
    PropertyInfo pi = myObject.GetType().GetProperty(prop);
    pi.SetValue(myObject, "Bob", null); 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2015-08-24T14:20:18.053

使用这样的东西：

```
public static class PropertyExtension{       

   public static void SetPropertyValue(this object p_object, string p_propertyName, object value)
   {
    PropertyInfo property = p_object.GetType().GetProperty(p_propertyName);
    property.SetValue(p_object, Convert.ChangeType(value, property.PropertyType), null);
   }
} 
```

或者

```
public static class PropertyExtension{       

   public static void SetPropertyValue(this object p_object, string p_propertyName, object value)
   {
    PropertyInfo property = p_object.GetType().GetProperty(p_propertyName);
    Type t = Nullable.GetUnderlyingType(property.PropertyType) ?? property.PropertyType;
    object safeValue = (value == null) ? null : Convert.ChangeType(value, t);

    property.SetValue(p_object, safeValue, null);
   }
} 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2009-03-06T18:00:20.997

您还可以使用类似的方式访问字段：

```
var obj=new MyObject();
FieldInfo fi = obj.GetType().
  GetField("Name", BindingFlags.NonPublic | BindingFlags.Instance);
fi.SetValue(obj,value) 
```

通过反射，一切都可以成为一本打开的书：) 在我的示例中，我们绑定到一个私有实例级字段。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2014-08-20T18:13:34.590

当您想使用属性名称从另一个对象批量分配一个对象的属性时，您可以试试这个：

```
public static void Assign(this object destination, object source)
    {
        if (destination is IEnumerable && source is IEnumerable)
        {
            var dest_enumerator = (destination as IEnumerable).GetEnumerator();
            var src_enumerator = (source as IEnumerable).GetEnumerator();
            while (dest_enumerator.MoveNext() && src_enumerator.MoveNext())
                dest_enumerator.Current.Assign(src_enumerator.Current);
        }
        else
        {
            var destProperties = destination.GetType().GetProperties();
            foreach (var sourceProperty in source.GetType().GetProperties())
            {
                foreach (var destProperty in destProperties)
                {
                    if (destProperty.Name == sourceProperty.Name && destProperty.PropertyType.IsAssignableFrom(sourceProperty.PropertyType))
                    {
                        destProperty.SetValue(destination,     sourceProperty.GetValue(source, new object[] { }), new object[] { });
                        break;
            }
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-09-21T15:59:41.817

我刚刚发布了一个 Nuget 包，它不仅可以设置第一级属性，还可以设置给定对象中任意深度的嵌套属性。

这是[包裹](https://www.nuget.org/packages/ObjectWriter/)

通过从根开始的路径设置对象的属性值。

对象可以是复杂对象，属性可以是多级深层嵌套属性，也可以是根目录下的属性。`ObjectWriter`将使用属性路径参数查找属性并更新其值。属性路径是从根到我们要设置的结束节点属性访问的属性的附加名称，由分隔符字符串参数分隔。

用法：

要直接在对象根下设置属性：

IE。`LineItem`类有一个名为的 int 属性`ItemId`

```
LineItem lineItem = new LineItem();

ObjectWriter.Set(lineItem, "ItemId", 13, delimiter: null); 
```

用于在对象根下设置多个级别的嵌套属性：

IE。`Invite`类有一个属性叫做`State`，它有一个属性叫做`Invite`（Invite 类型），它有一个属性叫做`Recipient`，它有一个属性叫做`Id`。

更复杂的是，该`State`属性不是引用类型，它是一个`struct`.

以下是如何在单行中设置对象树底部的 Id 属性（设置为“outlook”的字符串值）。

```
Invite invite = new Invite();

ObjectWriter.Set(invite, "State_Invite_Recipient_Id", "outlook", delimiter: "_"); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-02-15T15:06:03.507

根据 MarcGravell 的建议，我构造了以下静态方法。该方法**通常使用****FastMember**将源对象中的所有匹配属性分配给目标

 **```
 public static void DynamicPropertySet(object source, object target)
    {
        //SOURCE
        var src_accessor = TypeAccessor.Create(source.GetType());
        if (src_accessor == null)
        {
            throw new ApplicationException("Could not create accessor!");
        }
        var src_members = src_accessor.GetMembers();
        if (src_members == null)
        {
            throw new ApplicationException("Could not fetch members!");
        }
        var src_class_members = src_members.Where(x => x.Type.IsClass && !x.Type.IsPrimitive);
        var src_class_propNames = src_class_members.Select(x => x.Name);
        var src_propNames = src_members.Except(src_class_members).Select(x => x.Name);

        //TARGET
        var trg_accessor = TypeAccessor.Create(target.GetType());
        if (trg_accessor == null)
        {
            throw new ApplicationException("Could not create accessor!");
        }
        var trg_members = trg_accessor.GetMembers();
        if (trg_members == null)
        {
            throw new ApplicationException("Could not create accessor!");
        }
        var trg_class_members = trg_members.Where(x => x.Type.IsClass && !x.Type.IsPrimitive);
        var trg_class_propNames = trg_class_members.Select(x => x.Name);
        var trg_propNames = trg_members.Except(trg_class_members).Select(x => x.Name);

        var class_propNames = trg_class_propNames.Intersect(src_class_propNames);
        var propNames = trg_propNames.Intersect(src_propNames);

        foreach (var propName in propNames)
        {
            trg_accessor[target, propName] = src_accessor[source, propName];
        }
        foreach (var member in class_propNames)
        {
            var src = src_accessor[source, member];
            var trg = trg_accessor[target, member];
            if (src != null && trg != null)
            {
                DynamicPropertySet(src, trg);
            }
        }
    } 
```

# linq-to-sql - 区分大小写的 C# LINQ 问题

> ID：619771
> 
> 赞同：2
> 
> 时间：2009-03-06T17:50:29.743
> 
> 标签：linq-to-sql, c#-3.0

我有这个：

```
var sortName = Request.Params["sortName"];
var query = Request.Params["query"];

Func<UsuarioEndereco, bool> whereClause = (uen => uen.GetPropValue<string>(sortName).Contains(query)); 
```

将`"uen.GetPropValue<string>(sortName)"`使用用户在页面中键入的 sortName 动态填充。

例如，如果用户查找名为“Joe”的人，则代码段将是：

```
(uen => uen.namePerson.Contains(Joe)) 
```

但是，我遇到了 LINQ 区分大小写搜索的问题。如果我输入“Joe”，我会做一些事情。另一方面，如果我输入“joe”，它什么也没有。

如何使此“包含（排序名称）”与不区分大小写的一起使用？我用 String.Comparer 尝试了一些东西，但它报告了构建解决方案的错误。

谢谢！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T17:58:40.737

我相信以下将生成正确的 SQL：

```
 uen=>(uen.GetPropValue<string>(sortName)).ToLower().Contains(query.ToLower())) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T18:19:36.757

如果这确实是 LINQ-to-SQL，请尝试使用[SqlMethods.Like](http://msdn.microsoft.com/en-us/library/system.data.linq.sqlclient.sqlmethods.like.aspx)方法而不是 String.Contains。

但是，我认为问题在于这不是 LINQ-to-SQL，因为您使用的是委托而不是表达式树。所以这被带到客户端，然后在本地执行（“LINQ to Objects”）。因此， String.Contains 正在做它在本地所做的事情。

这样一来，James 的回答是正确的，因为他在值和查询上都调用了 ToLower()。（不过，请注意文化问题——也许指定你想要的文化。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-29T11:51:01.593

您还可以使用 String.IndexOf 方法（String、Int32、StringComparison）（[http://msdn.microsoft.com/en-us/library/ms224424.aspx](http://msdn.microsoft.com/en-us/library/ms224424.aspx)）。此方法允许您指定匹配是否应区分大小写，以及是否应使用 Invariant 区域性。

所以在你的例子中：

```
Func<UsuarioEndereco, bool> whereClause = (uen => uen.GetPropValue<string>(sortName).IndexOf(query, 0, StringComparison.OrdinalIgnoreCase)); 
```

我不评论这是否比 James Curran 提供的解决方案更好。它可能是或不可能是性能方面的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T18:33:28.907

这是整个代码：

```
var sortOrder    = Request.Params["sortorder"];    
var sortName     = Request.Params["sortname"];
var query        = Request.Params["query"];

IEnumerable<UsuarioEndereco> pagedEndereco;

Func<UsuarioEndereco, bool> whereClause = (uen => uen.GetPropValue<string>(sortName).Contains(query));
pagedEndereco = sortOrder.Equals("asc", StringComparison.CurrentCultureIgnoreCase) ?
                        _agendaServico.SelecionaUsuarioEnderecos(u.codUsuario).Where(whereClause).OrderByDescending(uen => uen.GetPropValue<IComparable>(sortName)) :
                        _agendaServico.SelecionaUsuarioEnderecos(u.codUsuario).Where(whereClause).OrderBy(uen => uen.GetPropValue<IComparable>(sortName)); 
```

扩展方法 GetPropValue 是：

```
public static T GetPropValue<T>(this object component, string propertyName)
{
    return (T)TypeDescriptor.GetProperties(component)[propertyName].GetValue(component);
} 
```

# html - 过滤掉 Twitter 提要中的@replies？

> ID：619773
> 
> 赞同：5
> 
> 时间：2009-03-06T17:50:48.180
> 
> 标签：html, twitter

我的网站顶部有来自我的 Twitter 个人资料的提要，但我想知道是否有办法过滤掉我的@replies 并只显示我的状态更新？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T17:53:23.980

也许与[雅虎管道](http://pipes.yahoo.com/pipes/)。

[Tomalak](https://stackoverflow.com/users/18771/tomalak)[为您](http://pipes.yahoo.com/tomalak/bbeckford_sample)做了一个简单的例子。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T10:58:00.300

如果您使用 Blogger 和类似网站的标准 Twitter 提要网络代码，那么这段 Javascript 就可以解决问题。它位于 Twitter 提要和回调之间，并从服务器响应中删除回复。

对于博客徽章，标准 Twitter 网络代码以两个`<script>`标签结尾。第一个提供显示推文的功能。第二个查询 twitter 以显示要显示的推文。

在 twitter 查询之前将此脚本添加到您的徽章代码中。它提供了一个名为 filterCallback 的新函数，该函数从 Twitter 响应中删除 @replies。

```
<script type="text/javascript">
  function filterCallback( twitter_json ) {
    var result = [];
    for(var index in twitter_json) {
      if(twitter_json[index].in_reply_to_user_id == null) {
        result[result.length] = twitter_json[index];
      }
      if( result.length==5 ) break; // Edit this to change the maximum tweets shown
    }
    twitterCallback2(result); // Pass tweets onto the original callback. Don't change it!
  }
  </script> 
```

twitter 查询本身有一个参数，该参数指定响应返回时要调用的函数。在博主的案例中，该函数称为“twitterCallback2”——您可以在网络代码中搜索它（查找`callback=twitterCallback2`）。要使用新过滤器，您需要将文本替换`twittercallback2`为`filterCallback`. 过滤器是硬编码的，然后`twitterCallback2`在完成时调用。

请注意，如果来自 Twitter 的某些回复是回复，这将减少显示的推文数量，因此您必须增加调用中的 count 参数以允许这样做。然后，新功能将显示的回复数量限制为五个 - 编辑代码以更改它。

这是我的博客文章：[从 Twitter 订阅源中过滤回复](http://t-swamp.blogspot.com/2009/06/filtering-replies-out-of-twitter-badge.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-01-15T00:03:46.730

如果您想使用新的 Twitter 小部件，只需`features:`在小部件源代码的设置中添加这段代码：

```
filters: {
  negatives: /\B@\w{1,20}(\s+|$)/
}, 
```

[我从 Dustin Diaz 的网站http://www.dustindiaz.com](http://www.dustindiaz.com)上拿了这个。Dustin Diaz 是 Twitter 小部件的创建者。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-07T01:08:48.713

将 setUser 调用更改为

```
setUser('name&exclude_replies=true'); 
```

这是一种黑客行为，但它确实有效

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T17:53:51.577

取决于您用来显示条目的内容。如果您使用的是 Twitter 的小部件，那么可能不会。如果您正在使用其他一些编程方式来显示项目，您需要提供有关您正在做什么的更多详细信息（语言、示例代码等），我们可能可以帮助过滤。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T17:56:53.270

您可能想要使用正则表达式。类似于以下内容：

```
[a-zA-Z0-9][a-zA-Z0-9]*: @[a-zA-Z0-9][a-zA-Z0-9]*.* 
```

取决于您在页面上格式化 twitter 提要的方式。此正则表达式假定您的格式如下：

```
username: @username msg txt 
```

如果匹配，则不显示。如果不匹配，则显示它。:) 如果您在文本中添加了标签，请适当调整正则表达式。

# asp.net - 事件处理程序存在

> ID：619777
> 
> 赞同：0
> 
> 时间：2009-03-06T17:52:35.713
> 
> 标签：asp.net, event-handling

如果为 OnClick 或 OnCommand 设置了事件处理程序，我如何在 Web 服务器控件（从 linkbutton 继承）中确定？

我宁愿不覆盖事件并设置变量......等

提前谢谢大家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T17:55:04.800

```
Inside Page_Load or after:

if (ctrl.OnClick != null)
{
    // ...
} 
```

# url - 网址缩短服务

> ID：619783
> 
> 赞同：1
> 
> 时间：2009-03-06T17:54:21.060
> 
> 标签：url, bit.ly

我想写一个网址缩短服务。我试着去想那些会很危险的场景。我想到的一个是如果提交的 url 来自我自己的网站，它会创建一个无限的重定向循环。

你们能想到其他情况吗？（安全漏洞，错误...）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T18:04:03.360

与其尝试考虑“危险”场景，不如尝试考虑如何编写它而不会对自己造成任何风险，而不管任何安全漏洞/错误如何。

可能无法解决您最终遇到的所有问题，但这是避免问题的更好方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T18:10:22.143

你可能已经知道了，但我觉得有必要指出[TinyURL](http://tinyurl.com)正是你想要做的。
也就是说，除了您描述的明显的无限重定向之外，确实不会出现很多技术问题。更大的问题将是政治问题——人们在你的网址后面隐藏垃圾邮件、色情或恶意网站，人们创建“有趣”的网址指向他们认为有趣的地方，等等。
查看[TinyURL 的 Wikipedia 条目，](http://en.wikipedia.org/wiki/TinyURL)了解他们遇到的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T18:07:19.250

编写它以避免由安全漏洞引起的行为。在您的示例中，如果您在 X 时间段内从同一 IP 收到超过 x 个请求。

沿着这些思路思考将消除更多的威胁，而不是试图预先阻止它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T18:09:06.563

像这样的服务中的许多危险对您来说并不像对您的服务用户那样危险。如果你搜索 TinyURL 和 security，你会发现很多这样的东西：

[http://www.readwriteweb.com/archives/tinyurl_being_used_to_bypass_safe_browsing_filters.php](http://www.readwriteweb.com/archives/tinyurl_being_used_to_bypass_safe_browsing_filters.php)

我会对 TinyURL 和 Bit.ly 做很多研究，看看他们是如何解决这些问题的。

就您自己的应用程序而言，所有标准的最佳实践都适用。验证输入，安全地插入您的数据库等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T18:09:07.920

您可以随时检查它是否来自您的服务。

而且，如果您担心它是您较小 URL 的 TinyURL，您可以随时关注该链接，如果它最终回到您的站点，请杀死它。

# winapi - MSXML：如何以编程方式获取转换失败的错误文本？

> ID：619787
> 
> 赞同：3
> 
> 时间：2009-03-06T17:55:05.723
> 
> 标签：winapi, xslt, msxml

当转换失败时，XMLNotepad 提供以下文本（例如）：

> 转换 XML 时出错
> 变量或参数“饱和背景颜色”以相同的导入优先级复制。

我将如何以编程方式获取此错误文本？我的代码如下所示：

```
CComPtr<IXSLTemplate> tmpl;
HRESULT hr = CoCreateInstance(CLSID_XSLTemplate, NULL, CLSCTX_INPROC_SERVER, IID_IXSLTemplate, (void**)&tmpl);
if (SUCCEEDED(hr)) {
    hr = tmpl->putref_stylesheet(xslt_doc);
    if (SUCCEEDED(hr)) {
    // Huzzah; do stuff.
    } else {
    // How do I get the error text?  I want to log it!
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T18:10:19.210

如果`IXSLTemplate`支持`IErrorInfo`（AFAIK，确实如此），那么您可以查询它以获取更多信息。

（jeffamaphone 告诉我正确的方法来获得这个 - 使用`GetErrorInfo()`API :)

```
CComPtr<IErrorInfo> error;
if (SUCCEEDED( GetErrorInfo(0, &error) ) && error)
{
   // call IErrorInfo::GetDescription(), etc.
} 
```

# jquery - jquery：表单提交/页面重新加载后隐藏/显示某些内容

> ID：619792
> 
> 赞同：2
> 
> 时间：2009-03-06T17:55:53.427
> 
> 标签：jquery, html

在我的页面上，我的表单在加载页面时默认为 .hide() 。这两种形式是帐户创建和登录。一旦用户单击相应的链接 (.show())，它们就会显示给用户。

显然，如果任一表单出现故障，我希望表单在提交页面加载后保持打开而不是隐藏。

现在表单正在使用简单的 html 表单发布来访问数据库。有没有更好的方法来使用 jquery 来做到这一点，这不是太复杂？（我对它还很陌生，但正在学习）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T18:02:11.977

您可以将处理程序分配给表单的“提交”操作，并使用它做任何您喜欢的事情。异步发送，再次删除表单，将其留在那里，无论如何。这是一个起点：

```
$('#myloginform').submit( function() {
  var form = $(this);
  $.post(
    form.attr('action'),
    form.serialize(),
    success: function( response ) {
      // do something when all is well
      form.hide();
    },
    failure: function( respones ) {
      // do something when everything explodes
      form.addClass('error');
    }
  );
  return false; // don't fire the regular handler
} ); 
```

jQuery API 文档将为您提供有关`submit`（和类似的）处理程序以及`$.post`和朋友的更多详细信息。

*编辑：*这段代码应该进入你的`$(document).ready`处理程序，我假设你已经有你`show`的 s 和`hide`s 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T18:02:07.857

我会尝试[jQuery Form Plugin](http://malsup.com/jquery/form/)。它允许您使用 ajax 发布表单。

成功后，您可以将浏览器重定向到通常提交时会到达的位置。

出错时，您可以显示错误消息并将用户留在表单上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T18:04:21.877

假设您不能使用 ajax，请在 URL 或页面正文中添加一些内容，说明发生了错误。然后做类似..

```
jQuery(document).ready( function()
{
  if(form_error) // check for the error in some way (query_string, a div with an 'error class'
  {
    jQuery('.form-selector').show();
  }
}); 
```

# c# - 页面加载图片

> ID：619795
> 
> 赞同：0
> 
> 时间：2009-03-06T17:56:14.847
> 
> 标签：c#, asp.net, pageload

我正在制作一个 ASP.NET 网页，当它们没有被缓存时，它会从 SQL 生成页面。它们的加载时间可能在 300 毫秒到 1.5 秒之间（请不要修复您的数据库回复）。

我个人认为这些值太长，并且正在寻找一种解决方案，可以让我通知用户他正在访问的页面需要一些时间来加载。

如果可能的话，我正在寻找可以通过 Page_Load 函数的解决方案。在这种情况下，对我来说完美的解决方案是向用户显示动画 GIF 或说明正在生成页面的文本。

顺便说一句，我主要从事 Windows 应用程序的编程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T18:01:08.063

您将需要首先输出加载图形，然后刷新输出缓冲区，以便使用`Response.Flush()`.

当您输出其余内容时，您需要在其中添加一些 javascript 来删除发送的第一个页面元素，以便加载图形消失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T18:04:51.067

您可以开始渲染页面，并调用 Response.Flush() 刷新缓冲区。它将缓冲区的内容发送到浏览器。然后，您需要在加载图形后关闭图形。

另一种选择是使用 AJAX 加载图像，因此您加载整个页面，没有图像，然后发起另一个请求来获取图像。这可能比尝试呈现部分页面更容易。

1.5 秒的页面加载时间还不错，您确定这值得您花时间和精力吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T18:07:52.837

以下是如何使用 Response 对象将内容刷新到浏览器并继续处理的示例：

```
using System;
using System.Web.UI;
using System.Threading;

public partial class _Default : Page
{
    protected override void OnLoad(EventArgs e)
    {
        base.OnLoad(e);

        Response.Write("<h1>please wait...</h1>");
        Response.Flush();

        // simulate load time
        Thread.Sleep(2000);

        Response.Write("<h1>finished</h1>");
    }
} 
```

# .net - 为什么单击背景区域时 WPF 弹出窗口会关闭？

> ID：619798
> 
> 赞同：25
> 
> 时间：2009-03-06T17:56:58.167
> 
> 标签：.net, wpf, popup, focus

我有一个 WPF`Popup`控件，其中包含一些编辑控件（列表框、文本框、复选框），布局有相当多的空白。

`Popup.StaysOpen`设置为`False`，这是必需的。如果用户单击应用程序中的其他位置，则应认为编辑操作已中止并且弹出窗口应关闭。

不幸的是，每当用户在弹出窗口的背景区域（编辑控件之间的空间）内单击时，弹出窗口也会关闭。

我尝试将弹出窗口设置为`Focusable`. 我还尝试将弹出窗口的子项 (a `Border`) 设置为可聚焦。两方面都没有运气。

此外，鼠标事件似乎在弹出窗口中穿行。当我单击它时，弹出窗口下方的任何元素都会成为焦点。尽管`Popup`和`Border`（我点击进入）都具有`IsHitTestVisible`和`Focusable`设置为`true`。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-06T20:46:24.860

最后，我发现以下工作。鉴于...

```
<Popup x:Name="_popup"
       StaysOpen="False"
       PopupAnimation="Slide"
       AllowsTransparency="True"> 
```

...我在调用后在构造函数中使用了此代码`InitializeComponent`...

```
// Ensure that any mouse event that gets through to the
// popup is considered handled, otherwise the popup would close
_popup.MouseDown += (s, e) => e.Handled = true; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-06T20:48:01.610

它会忽略 Popup 和 Border 上的 Focusable 似乎很奇怪。当鼠标悬停在边框上时，我可以通过在触发器中更改 StaysOpen 来解决您的问题：

```
<Grid xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ToggleButton x:Name="btnPop" Content="Pop!" Width="100" Height="50"/>
    <Popup Placement="Bottom" PlacementTarget="{Binding ElementName=btnPop}" IsOpen="{Binding IsChecked, ElementName=btnPop}">
        <Popup.Style>
            <Style TargetType="{x:Type Popup}">
                <Setter Property="StaysOpen" Value="False"/>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding IsMouseOver, ElementName=brd}" Value="True">
                        <Setter Property="StaysOpen" Value="True"/>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </Popup.Style>
        <Border x:Name="brd" Background="White" BorderThickness="1" BorderBrush="Black">
            <StackPanel>
                <TextBox Margin="10"/>
                <TextBlock Text="Some text is here." Margin="10"/>
                <TextBox Margin="10"/>
            </StackPanel>            
        </Border>
    </Popup>
</Grid> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T20:09:21.407

我最好的猜测是你有一些透明度问题。尝试在弹出窗口上设置背景画笔。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-13T09:19:54.977

您没有将 Popup 嵌套在 ToggleButton 或其他类型的 Button 中吗？然后在 Popup 级别停止路由事件将是合乎逻辑的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-07-17T06:40:24.090

可以设置**StayOpen** =true，并设置一个定时器，在Popup的MouseLeave事件timer.Start()中，比如3秒后关闭这个popup，在MouseEnter事件中，timer.Stop()。它会起作用。

# python - 为包装好的 MySQL 提供密码

> ID：619804
> 
> 赞同：2
> 
> 时间：2009-03-06T17:58:49.660
> 
> 标签：python, mysql, subprocess

问候。

我写了一个在子进程中调用 MySQL 的小 Python 脚本。[是的，我知道正确的方法是使用 MySQLdb，但在 OS X Leopard 下编译它很痛苦，如果我想在不同架构的计算机上使用该脚本，可能会更痛苦。] 子进程技术有效，前提是我在启动进程的命令中提供密码；但是，这意味着机器上的其他用户可以看到密码。

我写的原始代码可以在[这里](http://armagons-isles.blogspot.com/2009/03/python-subprocess-wrapper-for-mysql.html)看到。

下面的这个变体非常相似，尽管我将省略测试例程以使其更短：

```
#!/usr/bin/env python

from subprocess import Popen, PIPE

# Set the command you need to connect to your database
mysql_cmd_line = "/Applications/MAMP/Library/bin/mysql -u root -p"
mysql_password = "root"

def RunSqlCommand(sql_statement, database=None):

    """Pass in the SQL statement that you would like executed.
    Optionally, specify a database to operate on.  Returns the result."""

    command_list = mysql_cmd_line.split()
    if database:
        command_list.append(database)

    # Run mysql in a subprocess
    process = Popen(command_list, stdin=PIPE, stdout=PIPE,
                    stderr=PIPE, close_fds=True)

    #print "Asking for output"
    #needs_pw = process.stdout.readline()
    #print "Got: " + needs_pw

    # pass it in the password
    process.stdin.write(mysql_password + "\n")

    # pass it our commands, and get the results
    #(stdout, stderr) = process.communicate( mysql_password + "\n" + sql_statement)
    (stdout, stderr) = process.communicate( sql_statement )

    return stdout 
```

我怀疑 MySQL 密码提示实际上不在 stdout（或 stderr）上，尽管我不知道那可能是怎么回事，或者这是否意味着我可以捕获它。

在提供密码之前，我确实尝试过先读取输出，但它没有用。我也试过传递密码

同样，如果我在命令行上提供密码（因此在“Popen”和“communicate”函数之间没有代码）我的包装函数可以工作。

* * *

*两个新想法，几个月后：*

1.  使用[pexpect](http://pexpect.sourceforge.net/pexpect.html)可以让我提供密码。它模拟一个 tty 并获得所有输出，即使是绕过 stdout 和 stderr 的输出。

2.  有一个名为[MySQL Connector/Python](https://launchpad.net/myconnpy)的项目，处于早期 alpha 阶段，它将允许提供一个纯 Python 库来访问 MySQL，而无需您编译任何 C 代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T18:22:20.290

您可以简单地构建一个 my.cnf 文件并在 mysql 命令上指向该文件。显然，您需要使用权限/acls 来保护该文件。但它不应该比在你的 python 脚本中拥有密码或你的 python 脚本的配置更安全。

所以你会做类似的事情

```
mysql_cmd_line = "/Applications/MAMP/Library/bin/mysql --defaults-file=credentials.cnf" 
```

你的配置看起来像这样

```
[client]
host     = localhost
user     = root
password = password
socket   = /var/run/mysqld/mysqld.sock 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T18:38:01.750

唯一安全的方法是使用 MySQL cnf 文件，正如其他海报中提到的那样。您也可以传递一个 MYSQL_PWD 环境变量，但这也是不安全的：[http ://dev.mysql.com/doc/refman/5.0/en/password-security.html](http://dev.mysql.com/doc/refman/5.0/en/password-security.html)

或者，您可以使用 Unix 套接字文件与数据库进行通信，并稍作调整，您可以在用户 ID 级别控制权限。

更好的是，您可以使用免费的 BitNami 堆栈 DjangoStack，它为 OS X（以及 Windows 和 Linux）预编译了 Python 和 MySQLDB [http://bitnami.org/stacks](http://bitnami.org/stacks)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T18:15:44.767

这可能是 Windows / SQL Server 功能，但您可以使用受信任的连接（即使用您的操作系统登录名/密码访问数据库）吗？MySQL 可能有一个 OS X 等价物。

或者您可能只需要设置您的数据库以使用操作系统登录名和密码，这样您就不需要将其保存在您的代码中。

无论如何，只是一个想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T18:24:09.177

试试这个：

```
process.stdin.write(mysql_password + "\n")
process.communicate()
(stdout, stderr) = process.communicate( sql_statement )
process.stdin.close()

return stdout 
```

调用communicate() 来强制发送你刚刚写入缓冲区的内容。此外，完成后关闭标准输入也很好。

# .net - 免费的语法高亮 .NET 编辑器

> ID：619807
> 
> 赞同：12
> 
> 时间：2009-03-06T18:00:06.303
> 
> 标签：.net, winforms, wpf-controls, editor

我需要将语法高亮编辑器控件合并到我的应用程序中。要求控件是免费的并且只有本地 .NET 代码，因此 Scintilla.NET 控件不可行。这样做的原因是因为它是一个 ClickOnce 应用程序。

我想要使​​用 WinForms 或 WPF 的答案。它不必来自同一供应商。它需要基本支持语法高亮、行号，并且对于高达 100,000 个的大文件相当快，并且必须是免费的！

我知道之前有人问过这个问题，因为他们通常会混淆需要版税或不免费的商业控件，或者提到不是本机 .NET 代码的 Scintilla.NET 控件。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-06T18:26:41.090

SharpDevelop IDE 是一个开源的 Visual Studio 替代方案，它的编辑器为 C# 和其他语言提供语法着色和自动完成功能。编辑器控件可以与 IDE 的其余部分分开使用，示例中有一个示例显示了如何将其集成到您自己的解决方案中（我认为是示例\CSharpCodeCompletion）。

如果您有任何困难，请尝试社区论坛：

[http://community.sharpdevelop.net/forums/](http://community.sharpdevelop.net/forums/)

它是用 C# 和 WinForms 编写的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T18:12:03.840

您可能想看看为 MonoDevelop 2 构建的文本控件是否会帮助您。它是集成的，您需要查看许可是否适合您。

不过，它确实使用了 GTK+，因此您可能需要在 GTK+ 周围安装 GtkSharp 包装器。但理论上可以将它用作位于您正在编程的 GUI API 系统之上的东西的基础。

**ETA**：您可能还想查看在 Windows 上运行的 SharpDevelop 中使用的代码。这两个项目之间也有共同的程序员。

链接： [SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)，[MonoDevelop](http://monodevelop.com/Main_Page)

# c# - Silverlight 和主机 .aspx 页面之间的服务器端事件

> ID：619813
> 
> 赞同：2
> 
> 时间：2009-03-06T18:01:07.783
> 
> 标签：c#, silverlight, events, user-controls

是否可以在 Silverlight 控件中设置侦听器以侦听托管 aspx 网页上的事件？我想在网页中托管几个 Silverlight 和 ASP.NET 用户控件。我想在一个用户控件上触发一个事件，将一个事件发送到主机页面（需要通知它），然后我想将一个事件广播回表单上的所有控件（Silverlight 和 ASP.NET）。这可能与 Silverlight 相关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T18:09:24.657

Silverlight 是一种客户端技术。它可以与 DOM 交互并且可以侦听 DOM 事件，但它不能与 ASP.NET 控件交互或侦听来自它们的事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-05T15:52:47.730

Silverlight 是一种客户端技术。您可以调用 Javascript 函数。有了它，您就可以利用 ASP.NET AJAX 来调用主机 ASPX 页面上的 Web 方法。更好的是，您可以强制从 Javascript 完整回发 ASPX 页面。

（抱歉回复晚了。我只是在寻找其他东西时遇到了这个）

# asp.net - ASP.NET Web 窗体中的 jQuery 验证插件

> ID：619816
> 
> 赞同：45
> 
> 时间：2009-03-06T18:01:40.637
> 
> 标签：asp.net, jquery, validation, webforms, jquery-validate

我真的很想在我的 ASP.NET Web 窗体应用程序（不是 MVC）中使用 jQuery 验证插件。我发现它比到处添加 asp 验证器并设置控件来验证所有这些验证器更容易。

我只是在设置此类时遇到了一些问题 class="required email" 我认为这与主表单标签中的表单标签有关。

在使用在 asp 控件中被破坏的名称调用 jquery validate 时，我也遇到了问题

```
// validate signup form on keyup and submit
$("#signupForm").validate({
    rules: { 
        username: {
            required: true,
            minlength: 2
        }, },
    messages: { 
        username: {
            required: "Please enter a username",
            minlength: "username at least 2 characters"
        }, 
    }.

.......

        <p>
            <label for="username">
                Username</label>
            <input id="username" name="username" />
        </p> 
```

因为这

```
<asp:TextBox ID="tbUsername"  runat="server"></asp:TextBox> 
```

呈现为

```
<input name="ctl00$ContentPlaceHolder1$tbUsername" type="text" id="ctl00_ContentPlaceHolder1_tbUsername" /> 
```

并破坏名称。我可以使用 ClientID 获取，`<%=tbUsername.ClientID %>`但这不适用于 ClientName

有没有人使用带有 asp.net 的 jquery 验证器插件取得任何成功？如果是这样，那么使用多个表单就像使用单独的验证组一样呢？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-03-06T18:39:30.420

您可以检查[规则添加功能](http://docs.jquery.com/Plugins/Validation/rules#.22add.22rules)，但基本上这是您可以执行的操作：

```
jQuery(function() {
    // You can specify some validation options here but not rules and messages
    jQuery('form').validate(); 
    // Add a custom class to your name mangled input and add rules like this
    jQuery('.username').rules('add', { 
        required: true, 
        messages: { 
            required: 'Some custom message for the username required field' 
        } 
    });
});

<input name="ctl00$ContentPlaceHolder1$tbUsername" type="text" id="ctl00_ContentPlaceHolder1_tbUsername" class="username" /> 
```

这样就无需担心 webforms 引擎生成的蹩脚的标识符。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-02-11T05:18:31.333

以下是[使用带有 WebForms 的 jQuery Validation 插件](http://encosia.com/2009/11/04/using-jquery-validation-with-asp-net-webforms/)并用它[模拟验证组概念的](http://encosia.com/2009/11/24/asp-net-webforms-validation-groups-with-jquery-validation/)示例。一旦你解决了几个问题，它实际上工作得很好。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-08-27T08:22:36.987

```
$("#signupForm").validate({
        rules: { 
                <%= tbUsername.UniqueID %>: {
                        required: true,
                        minlength: 2
                }, },
        messages: { 
                <%= tbUsername.UniqueID %>: {
                        required: "Please enter a username",
                        minlength: "username at least 2 characters"
                }, 
        });

<asp:TextBox ID="tbUsername" runat="server"></asp:TextBox> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-10-21T11:11:17.103

您可以在此处查看 xVal.webForms：http: [//xvalwebforms.codeplex.com/](http://xvalwebforms.codeplex.com/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-05-27T18:14:03.803

测试了 Darin Dimitrov 所说的，它运行良好，但如果您不想为每个字段设置特定的类，您可以使用 jQuery 选择器：

```
$('form').validate();
$('input[id$=Username]').rules('add', { 
    required: true, 
    messages: { 
        required: 'Some custom message for the username required field' 
    } 
});

<input name="ctl00$ContentPlaceHolder1$tbUsername" type="text" id="ctl00_ContentPlaceHolder1_tbUsername" /> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-02T04:30:35.767

最好的解决方案是在 jQuery 规则中使用 "<%=tbUsername.UniqueID %>" 而不是 tbUsername。

```
$("#signupForm").validate({
rules: { 
    "<%=tbUsername.UniqueID %>": {
        required: true,
        minlength: 2
    }, },
messages: { 
    "<%=tbUsername.UniqueID %>": {
        required: "Please enter a username",
        minlength: "username at least 2 characters"
    }, 
}. 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-28T15:34:45.467

我最近为 xVal.WebForms 发布了一个补丁文件，它解决了在著名的 ASP.Net 验证组上中继的多表单问题。此补丁还支持 ASP.Net CausesValidation 属性。

哟可以在这里阅读： http: [//cmendible.blogspot.com/](http://cmendible.blogspot.com/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-23T02:50:49.257

一个很好的方法是使用：

**<%= textbox.Name %>**或**<%= textbox.ClientId %>**每当您需要引用服务器项时。

IE

```
var phoneNumb = $('#<%= tPhone.ClientID %>').val(); 
```

或者

```
$("#signupForm").validate({
        rules: { 
                <%= username.Name %>: {
                        required: true,
                        minlength: 2
                }, },
        messages: { 
                <%= username.Name %>: {
                        required: "Please enter a username",
                        minlength: "username at least 2 characters"
                }, 
        }. 
```

…………

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-08-10T22:03:40.290

对于**SharePoint 2010**，我发现将不同的用户控件加载为视图（通过 ajax），如果您将 javascript 移动到库中并且不能将服务器标签用于控件 ID，则此方法有效，如下所示：

例如`#<%= tPhone.ClientID %>`

```
$('input[id$=tPhone]').rules('add', 
{      
 required: true,      
 messages: 
 {          
  required: 'Some custom message for the username required field'      
 }  
}); 
```

除此之外，如果您通过 Ajax 动态加载用户控件，那么您将无法使用 $(document).ready 如果它在（服务器端事件）页面的用户控件上加载它的罚款，您将不得不将 jQuery 封装在一个函数库中，但是在场景中，它通过 Ajax 加载，带有更新面板，它不会跳舞。

我还没有尝试通过 jQuery 加载用户控件，这看起来很重，并且似乎加载了整个页面，尽管可能稍微快一点或没有。

比较加载技术的测试表明，更新面板的速度与其他技术一样快，并且页面大小相同或更小，并且基本上加载更快或更快或更快速地加载更多数据。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-17T15:31:08.973

我推荐使用 jQuery.simple.validator，它简单、轻量且可定制的验证器与 asp.net 网络表单兼容，因为它基本上可以在任何容器中执行验证，不仅

[https://github.com/v2msoft/jquery.simple.validator](https://github.com/v2msoft/jquery.simple.validator)

我建议您检查插件和文档。用法：

```
<script type="text/javascript" src="/Content/js/jquery-plugins/jquery.simple.validator.js"></script>

<div id="container">
    <!-- REQUIRED FIELD -->
    <label>Required Field: </label><br/>
    <input type="text" id="required_field_control" data-required data-required-msg="Field is required" /><br /><br/>

    <input type="button" value="Validate" onclick='javascript:validate();' />
</div>

<script type="text/javascript">
    function validate() {
        $("#container").initialize();
        var ok = $("#container").validate();
        if (!ok)  alert("There are errors");
        else alert("Form is ok");
    }
</script 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-07-31T03:49:56.640

[本文中](http://www.telerik.com/blogs/the-difference-between-id-clientid-and-uniqueid)的信息引导我在使用 jQuery 查找匹配项时使用 Control.ClientID... 非常有用的信息...

```
<label for="<%= tbName.ClientID %>">Name</label>
<input id="cphBody_tbName" runat="server" .../> 
```

# java - Java中有Perl实现吗？

> ID：619822
> 
> 赞同：11
> 
> 时间：2009-03-06T18:03:49.087
> 
> 标签：java, perl

我正在寻找 Java 中的 Perl 实现。像 Jython 这样的东西适用于 Python。我找到了 PLJava，但它需要安装 JVM 和 Perl 编译器。我需要不需要 Perl 编译器的东西。

我需要在 Java 类中运行一些 Perl 代码。

更新：

*   我发现 PLJAVA 是我需要的。有人知道一些教程吗？
*   有没有人玩过 Inline::Java 模块。
*   我也无法安装 Inline::Java。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T18:46:31.043

Jython 不完全兼容 CPython（或任何您愿意称其为原始 C++ Python 解释器的东西），但是任何与语言规范不同的地方都是一个错误。不幸的是，Perl 5 要复杂得多，并且根本没有任何正式的语言规范——该语言实际上被定义为“`perl`可执行文件的功能”——因此除了 Perl 5 解释器之外，不存在 Perl 5 语言的其他实现. 不幸的是，但那是历史。Perl 6 确实有一个语言规范和多个（不完整的）实现，但这可能对您没有用处。

[PLJava](http://search.cpan.org/dist/PLJava/README.pod)试图做你想做的事，从 Java 调用 Perl。它通过链接到`libperl`. 但是，它自 2004 年以来就没有更新过，我不知道它的效果如何。

### 编辑

我以前没有见过[Inline::Java::PerlInterpreter](http://search.cpan.org/dist/Inline-Java/Java/PerlInterpreter/PerlInterpreter.pod) —— 不幸的是，它似乎不适用于我的系统 Perl。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-03-31T21:01:28.437

更新：还有另一个可行的选择：Jerl。Jerl 使用 NestedVM 将 micro-Perl 解释器翻译成 Java 代码。从这个意义上说，Jerl 几乎是 Perl 的 Java 实现。不过我还没有测试过，预计性能会下降是合理的。尽管如此，这是一个值得研究的解决方案。Jerl 托管在这里：[https](https://code.google.com/p/jerl/) ://code.google.com/p/jerl/ 。

可悲的是不是，至少不是一个完整且可用的。Perl 是一种难以移植到其他 VM 的语言，主要是因为它的高度动态性以及与该语言多年来的发展方式相关的历史原因；在我看来，关于 perl 可解析性的理论问题是次要的。Perl 没有正式的规范，也没有正式的语法：Perl 实现是 Perl 自己的正式规范。这意味着要编写 Perl 的替代实现，必须深入了解当前实现的内部结构，这显然是开发此类项目的一大障碍。这就是将 Perl 移植到其他 VM 的真正困难所在。另外，Perl 的动态特性带来了与 Java 虚拟机上的有效实现相关的其他技术问题，该虚拟机被设计为支持静态类型语言。已经有一些这样的努力，例如： [http://www.ebb.org/perljvm/](http://www.ebb.org/perljvm/)。这里引用了一个较新的：http: [//use.perl.org/~Ovid/journal/38837](http://use.perl.org/~Ovid/journal/38837)。两者都在某个时候被放弃，不是因为不可行，而是因为对于研究/爱好项目所需的努力太大。Mattia Barbon 的 language-P 正在稳步进行中的一个新的有趣替代方案：[http](http://search.cpan.org/dist/Language-P/) ://search.cpan.org/dist/Language-P/ 。它是 NET clr 上的 Perl 实现。实施仍然不完整，但我知道该项目背后的人是一个非常执着的人，并且该项目一直在缓慢而稳定地推进。也许 CLR 上的 Perl 将首先出现。:D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T18:08:12.400

看[睡眠](http://sleep.dashnine.org/ "用于 Java 平台的管道胶带")

> 是 Java 平台的多范式脚本语言
> 
> 使用 Perl 和 Objective-C 启发的语法易于学习
> 
> 以小包大小（~250KB）快速执行脚本
> 
> 擅长数据操作、组件集成和分布式通信
> 
> 无缝使用 Java 对象和 3rd 方库

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T18:08:45.813

如果您不打算使用 Perl 编译器，您究竟在寻找什么？

Java 的 Perl 实现是什么意思？如果你想在你的 Java 程序中嵌入 Perl，你将需要一个 Perl 编译器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T19:11:42.963

在我看来，您遇到的问题是您没有可用的 Perl 编译器/解释器，但您需要执行一些 Perl 代码。不幸的是，我认为 Perl 不存在像 Jython 这样的东西。我所知道的唯一可以满足您要求的项目是 PLJava 和 JPL。不幸的是，看起来这两个项目都被放弃了。

不过，这将是一个很酷的项目，因为我相信需要这样的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-06T19:55:02.640

如果您没有在目标平台上安装 perl，您可以使用 par 包括模块（甚至作为可执行文件）：http: [//metacpan.org/pod/PAR](http://metacpan.org/pod/PAR)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-07-30T17:11:44.343

[Rakudo](http://rakudo.org/)是 Perl 6 的 JVM 实现（与标准 Perl 完全不同）。现在有了[Jerl](https://code.google.com/p/jerl/)（它在 JVM 中运行，但基于 microperl 编译）。两者都有其局限性，但对于大多数用途来说都是可靠的竞争者。

# c# - 从 Wiimote 转移到相机？

> ID：619827
> 
> 赞同：6
> 
> 时间：2009-03-06T18:05:14.997
> 
> 标签：c#, camera, computer-vision, wiimote

我一直在做一些[Johnny Chung Lee 风格的](http://johnnylee.net/projects/wii/)Wiimote 编程，但遇到了 Wiimote 相对狭窄的视野和四点限制的问题。我买了一个Creative Live！具有 85 度视野和高分辨率的相机。

我的原型应用程序是用 C# 编写的，我想留在那里。

所以，我的问题是：我想找到一个 C#.Net 相机/视觉库，它可以让我在相机的视野中跟踪点 - 可能是 LED。未来，我想移动到R/G/B点跟踪，以便更容易跟踪和区分更多的点。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-10T18:20:59.853

您可以查看[Emgu.CV](http://www.emgu.com/wiki/index.php/Main_Page)库，它是 OpenCV 的 .NET (C#) 包装器。OpenCV 被包括我自己在内的许多人认为是最好的（免费）计算机视觉库。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-06T18:19:13.527

查看[AForge.Net](http://code.google.com/p/aforge/) .. 它似乎是一个强大的库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-15T02:06:23.337

在跟踪诸如灯光之类的东西时，特别是如果它们是一种特殊的颜色，我建议您首先对素材应用模糊滤镜。这样可以很好地混合颜色，但准确度稍低，使用的 CPU 更少，您需要进行的阈值调整也更少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T09:07:35.997

使用普通相机，识别和跟踪 LED 的任务更具挑战性，因为所有其他物体都是可见的。我建议您尝试通过减少曝光来最大化对比度（从而关闭自动曝光），如果这在驱动程序中是可能的：您应该瞄准一个值，您的 LED 在图像中仍然具有高强度（> 200）同时没有过度曝光（<255）。然后，您应该能够正确地对图像进行阈值处理并获得更高质量的结果。

如果图像仍然过于杂乱而无法轻松有效地分析，您可以使用红外 LED，移除相机上的 IR 阻挡滤光片（如果您的相机有），并可能添加“红外通过/可见光阻挡”滤光片：然后你应该只在 LED 所在的地方有亮点，但你将无法使用颜色。不过，图像质量可能存在问题。

# c# - Web 服务 SOAP 消息路由

> ID：619829
> 
> 赞同：1
> 
> 时间：2009-03-06T18:06:30.140
> 
> 标签：c#, asp.net, web-services, soap

我有一个案例，我需要通过中间服务器路由 Web 服务 SOAP 消息。任何人都可以指出一些关于如何实现这一目标的好资源的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T12:12:30.653

WSE 已过时，除非没有其他选择，否则不应使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T18:12:21.140

您是否正在寻找设置 WSE 路由器？如果是这样，[这里有一个教程](http://msdn.microsoft.com/en-us/library/aa528755.aspx)。

# ruby-on-rails - Rails：我无法在 /lib 的模块中调用函数 - 我做错了什么？

> ID：619840
> 
> 赞同：50
> 
> 时间：2009-03-06T18:09:14.080
> 
> 标签：ruby-on-rails, ruby

我有一个模块保存在 /lib 作为 test_functions.rb 看起来像这样

```
module TestFunctions
  def abc
    puts 123
  end
end 
```

进入 ruby​​ 脚本/运行程序，我可以看到模块正在自动加载（很好的配置约定等等......）

```
>> TestFunctions.instance_methods
=> ["abc"] 
```

所以方法是已知的，让我们尝试调用它

```
>> TestFunctions.abc
NoMethodError: undefined method `abc' for TestFunctions:Module from (irb):3 
```

没有。这个怎么样？

```
>> TestFunctions::abc
NoMethodError: undefined method `abc' for TestFunctions:Module from (irb):4 
```

再次测试不。

```
defined?(TestFunctions::abc) #=> nil, but
TestFunctions.method_defined? :abc #=> true 
```

就像我在上面说的，我知道我很笨，有人可以让我去笨吗？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-03-06T18:55:45.170

如果您想要`Module`-level 函数，请以下列任何方式定义它们：

```
module Foo
  def self.method_one
  end

  def Foo.method_two
  end

  class << self
    def method_three
    end
  end
end 
```

所有这些方法都将使这些方法可用`Foo.method_one`或`Foo::method_one`等

正如其他人所提到的，`Module`s 中的实例方法是在您使用的地方可用的`include`方法`Module`

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-03-12T09:25:00.657

我将尝试自己总结各种答案，因为每个答案都有一些有价值的东西要说，但没有一个真正得到我现在意识到的可能是最好的回应：

**我问错了问题，因为我做错了。**

由于我无法再解释的原因，我想要一个库中的一组完全独立的函数，它代表了我试图从我的类中删除的方法。这可以实现，使用类似的东西

```
module Foo
  def self.method_one
  end

  def Foo.method_two
  end

  class << self
    def method_three
    end
  end

  def method_four
  end

  module_function :method_four
end 
```

我也可以`include`我的模块，在一个类中，在这种情况下，方法成为类的一部分或在外部，在这种情况下，它们定义在我在里面运行的任何类（对象？内核？Irb，如果我是交互式的? 那么可能不是一个好主意）

问题是，一开始就没有充分的理由不上课——我不知何故进入了一个思路，把我带到了一条很少使用的、坦率地说有点奇怪的分支线上。可能是对 OO 成为主流之前的回忆（我已经足够大，直到今天我已经花了很多年的时间编写程序代码）。

所以这些函数已经转移到一个类中，在那里它们看起来很开心，因此暴露的类方法在任何需要的地方都被愉快地使用。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-03-06T20:05:46.797

您也可以像这样使用 module_function：

```
module TestFunctions
  def abc
    puts 123
  end

  module_function :abc
end

TestFunctions.abc  # => 123 
```

现在您可以在类中包含 TestFunctions 并从 TestFunctions 模块中调用“abc”。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-13T15:39:17.343

我搞砸了一段时间，学到了几件事。希望这会帮助其他人。我正在运行 Rails 3.2.8。

我的模块 (utilities.rb) 如下所示，位于我的 rails 应用程序的 /lib 目录中：

```
module Utilities

  def compute_hello(input_string)
     return "Hello #{input_string}"
  end

end 
```

我的测试 (my_test.rb) 看起来像这样，位于我的 rails 应用程序的 /test/unit 目录中：

```
require "test_helper"
require "utilities"

class MyTest < ActiveSupport::TestCase
  include Utilities

  def test_compute_hello
    x = compute_hello(input_string="Miles")
    print x
    assert x=="Hello Miles", "Incorrect Response"
  end

end 
```

这里有几点需要注意： 我的测试扩展了 ActiveSupport::TestCase。这很重要，因为 ActiveSupport 将 /lib 添加到 $LOAD_PATH。（见http://stackoverflow.com/questions/1073076/rails-lib-modules-and）

其次，我既需要“要求”我的模块文件，也需要“包含”该模块。最后，重要的是要注意，从模块中包含的东西本质上是放在测试类中的。所以......请注意，您包含的模块不以“test_”开头。否则，Rails 将尝试运行您的模块方法作为测试。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-06T18:24:32.907

您不能直接调用模块中的方法。你需要将它包含在一个类中。试试这个：

```
>> class MyTest
>>   include TestFunctions
>> end
=> MyTest
>> MyTest.new.abc
123
=> nil 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-06T18:12:33.170

您需要包含模块

`include Testfunctions`

然后'abc'会返回一些东西。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-09-01T16:34:25.813

您需要在函数前面加上模块名称，因为模块不是类：

你的 /lib/test_functions.rb：

```
module TestFunctions
  def TestFunctions.abc
    puts 123
  end
end 
```

您使用模块方法的代码：

```
require 'test_functions'
TestFunctions.abc 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-07-19T02:36:49.887

今天你可以使用`module_function`符号来做到这一点。

```
module TestFunctions
  def abc
    puts 123
  end
end 
```

现在`TestFunctions.abc`打印“123”

更多关于`module_function`：[https ://apidock.com/ruby/Module/module_function](https://apidock.com/ruby/Module/module_function)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-11-30T18:59:22.123

试试这个代码：

```
service = Class.new { extend TestFunctions }
service.method_four 
```

# licensing - 埃斯珀的替代品？

> ID：619846
> 
> 赞同：15
> 
> 时间：2009-03-06T18:10:46.840
> 
> 标签：licensing, esper, complex-event-processing

我对复杂事件处理非常感兴趣，并且一直在关注 Esper。但是，我的公司有反 GPL 的立场，我想知道在 Apache 或 BSD 等更商业友好的许可下是否有非 GPL 替代方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-10-03T15:29:23.980

很晚了，但在这里你也可以找到一个概述。[CEP 供应商概述](http://rulecore.com/CEPblog/?page_id=47)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-03-01T18:04:52.880

[SiddhiCEP](http://svn.wso2.org/repos/wso2/trunk/commons/siddhi/)是一个 Apache License v2 软件。您可以将其用作库，甚至可以用作 CEP 服务器。[如果您要进行生产，您还可以从名为WSO2](http://wso2.com/)的开源产品公司获得 SiddhiCEP 的生产支持

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-10T13:39:51.927

FWIW，如果这就是您所追求的，Esper 拥有非 GPL 许可证。访问他们的网站 www.espertech.com - 否则社区许可证只是 GPL。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-22T12:34:28.717

Drools Fusion has an ASL-style license ([http://legacy.drools.codehaus.org/Licensing](http://legacy.drools.codehaus.org/Licensing)). Pion is another open-source system with an AGPL license. If you prefer a normal commercial license there's Aleri, Streambase and ruleCore. Aleri and streambase are "normal" software and ruleCore is a CEP cloud.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-07-15T19:09:17.100

关于 CEP 的书即将出版；此处免费提供的第 1 章（无需登录）列出了许多系统，但没有许可证信息： http: [//www.manning.com/etzion/Etzion_MEAPch01_free.pdf](http://www.manning.com/etzion/Etzion_MEAPch01_free.pdf)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-29T20:35:12.030

仅供参考，Esper 企业版不使用 GPL。即没有副本遗留问题...

> **我可以在我的应用程序中自由使用 Esper 吗？**
> 
> Esper 在开源 GPL GNU Public License v2.0 许可下获得许可。您可以根据您的应用程序以及重新分发它的方式检查此许可证。可能会受到限制。您应该考虑将 Esper Enterprise Edition 用于任何生产用途。Esper 企业版不是在病毒式的 copyleft 许可下提供的，它将 Esper、EsperJMX、EsperJDBC 和 Esper Studio 组合在一个经过认证和支持的软件包中，以实现最大的生产力、互操作性和可管理性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T13:48:13.367

您可能想看看 OpenESB 的[智能事件处理器](https://open-esb.dev.java.net/IEPSE.html)。我没有详细查看它，但我确实发现很难确定底层 API 到底是什么。相反，它谈论了很多关于允许您定义事件处理工作流的 NetBeans IDE，这没关系，但我想更好地理解真正的 API 是 IDE 的底层。相比之下，Esper 完全是关于 API 的，并且在辅助工具上要轻得多。

我也不确定许可证是什么，但我认为作为 Sun GlassFish 计划的一部分，它将是 CDDL（正确的首字母缩写词？）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-08-04T08:53:21.897

您可以查看[ERMA (Extremely Reusable Monitoring API)](http://erma.wikidot.com/)。它是由 Orbitz 开发供内部使用的，不久前他们已经开源了它。它使用 Apache 许可证。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-03-30T06:45:53.537

您也可以咨询 Siddhi

[https://github.com/wso2/siddhi](https://github.com/wso2/siddhi)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-01T08:12:15.207

rulecore cep 服务器具有非 gpl（封闭）源代码许可证。如果您从 ruleCore 购买许可证，您可以修改源代码并分发您自己的版本，而无需向任何人展示您修改的源代码。对于具有各种知识产权问题的商业项目来说，这可能是一个好主意。

# asp.net - url 重写 + Asp.Net 登录表单 = 死亡

> ID：619847
> 
> 赞同：1
> 
> 时间：2009-03-06T18:11:32.827
> 
> 标签：asp.net, webforms, url-rewriting, forms

在我们的网站上，我们进行 url 重写以生成大量数据库生成的页面。在每个页面上，都有一个用户登录控件。像这样：

内部aspx页面：/DB.aspx?id=123 用户可见url：/ABC/123.aspx, /ABC/456.aspx ...（url重写）

不幸的是，每个页面上的标签都有一个“DB.aspx?id=123”的动作属性。当用户单击按钮时，浏览器将发布到 /ABC/DB.aspx?id=123 这当然不存在。

我尝试过的解决方案： 1\. 通过子类化 HtmlForm 来更改动作属性。这会破坏网站上的所有其他表格。2.去掉action属性（这样浏览器总是发布到同一个url）。这适用于重写的页面，但在“/”（根目录中的 default.aspx）上，我收到一条消息，指出“/”上不允许动词帖子（iis 6，我无法控制映射）

有人吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T22:37:18.757

查看 scott gu 的这篇非常不错的博文，[http:](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx) //weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx 。

“具体来说，您可以利用新的 ASP.NET 2.0 控件适配器扩展架构来自定义控件的呈现，并用您提供的值覆盖其“动作”属性值。这不需要您更改任何代码在您的 .aspx 页面中”

查看部分：“使用 URL 重写处理 ASP.NET PostBacks”，我已经使用了他发布成功的适配器。

附言。请注意，在使用 cookieless 会话时使用 url 重写时，asp.net 上存在一些问题，并且重写的 url 比原始页面更深，就像你拥有的那样。（/abc/apage 与 /db？）。问题就在框架的源代码中，有一些解决方法，但这是一个完整的主题（需要权衡:( ...您可能希望它们处于同一级别）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T19:56:35.837

语义可能，但操作属性 = “DB.aspx?id=123”还是“/DB.aspx?id=123”？假设您的 URL 重写允许传递到物理页面，这可能是您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T22:44:53.153

我从来没有这样做过，但我看到了使用 Reflector 的代码，我想你可以这样修复它：

在页面上：

```
this.Form.Action = null; 
```

或者：

```
this.Form.SetAttribute("action", null); 
```

如果这不起作用，只需设置您想要的路径：

this.Form.SetAttribute("action", "ABC/123.aspx");

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T22:53:35.753

如果您升级到 ASP.NET 3.5 SP1，[现在可以正确识别 action 属性](https://stackoverflow.com/questions/54929/hidden-features-of-asp-net/75162#75162)并且可以[从 codebehind 设置](http://geekswithblogs.net/ranganh/archive/2008/08/31/setting-the-asp.net-forms-action-attribute-url-rewriting.aspx)。

# database-design - 多对多关系是否应该定义关系以外的任何内容

> ID：619853
> 
> 赞同：3
> 
> 时间：2009-03-06T18:12:50.360
> 
> 标签：database-design

采用典型的产品/类别多对多关系，您通常会有如下关系：

```
table -- ProductsCategories
column - ProductId
column - CategoryId 
```

是否不建议向该关系添加其他属性，仅存在于该特定关系上的事物。比如（请原谅我糟糕的例子，我不擅长例子）：

```
table -- ProductsCategories
column - ProductId
column - CategoryId
column - DiscountForProductsInThisCategory
column - CategoryImageForProductsInThisCategory 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T18:14:45.177

多对多关系只是一个具有 2 个一对多关系的表，将其视为具有 2 个关系的 3 个表，而不是 2 个具有关系和与之关联的数据的表。实现上没有区别。

无论哪种方式都是完全可以接受的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-06T18:17:40.677

除非数据专门针对该特定关系，否则请避免这种情况，因为您最终会复制大量数据。在您的示例中，图像链接到类别，因此应该存储在那里。但是，指示建立和编辑关系的时间以及创建和修改关系的用户 ID 应该在该表中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-06T18:15:11.710

当然，您可以将这些信息存储在那里。在其他任何地方，它都不会被标准化。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-15T13:57:27.703

例如，如果您有一张运动员表和一张比赛表。连接表 AthleteRace 代表该运动员参加了那场比赛，因此您也可以在其中获得他们的比赛时间。

你有两个例子：

```
column - DiscountForProductsInThisCategory
column - CategoryImageForProductsInThisCategory 
```

属于类别表，因为它们与类别相关，而不是类别中产品的成员资格。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-11-10T15:13:38.083

这个问题不是要考虑的问题。

如果是一列，例如。`DiscountForProductsInThisCategory`与 Category 的 PK 是 1::1，那么唯一正确的地方就是 Category。在 ProductCategory 中，这将是大量的数据重复。

如果一列与关系 (ProductId+CategoryId) 是 1::1，那么它的唯一正确位置是 ProductCategory。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-07T04:11:07.363

是的。

关系可以具有属性，IMO。虽然有些设计大师不这么认为。

考虑学生和课程之间的“已注册”关系。如果学生可以注册获得学分或成为审计员，则将此属性存储在其键为 (StudentID, CourseID) 的表中是有意义的。该表是对哪些学生注册了哪些课程进行编目的关系表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-06T18:15:00.433

我认为在这个表中添加其他字段是完全可以的。我所做的一个例子是我通常添加一个时间戳字段，以便我知道两个实体之间的关系何时创建。

# c# - 定义构造函数签名的接口？

> ID：619856
> 
> 赞同：601
> 
> 时间：2009-03-06T18:13:27.020
> 
> 标签：c#, interface, constructor

奇怪的是这是我第一次遇到这个问题，但是：

如何在 C# 接口中定义构造函数？

**编辑**
有些人想要一个例子（这是一个空闲时间项目，所以是的，这是一个游戏）

IDdrawable
+更新
+Draw

为了能够更新（检查屏幕边缘等）并绘制自己，它总是需要一个`GraphicsDeviceManager`. 所以我想确保该对象具有对它的引用。这将属于构造函数。

既然我写下来了，我认为我在这里实现的是`IObservable`并且`GraphicsDeviceManager`应该采取`IDrawable`......似乎我没有得到 XNA 框架，或者框架没有被很好地考虑。

**编辑**
在接口的上下文中我对构造函数的定义似乎有些混乱。接口确实不能被实例化，所以不需要构造函数。我想要定义的是构造函数的签名。就像接口可以定义某个方法的签名一样，接口也可以定义构造函数的签名。

* * *

## 回答 #1

> 赞同：328
> 
> 时间：2009-03-06T18:14:28.810

你不能。偶尔会很痛苦，但无论如何你都无法使用正常的技术来调用它。

在一篇博客文章中，我建议了[静态接口](http://codeblog.jonskeet.uk/2008/08/29/lessons-learned-from-protocol-buffers-part-4-static-interfaces/)，这些接口只能在泛型类型约束中使用——但它可能非常方便，IMO。

关于如果您*可以*在接口中定义构造函数的一点，您将无法派生类：

```
public class Foo : IParameterlessConstructor
{
    public Foo() // As per the interface
    {
    }
}

public class Bar : Foo
{
    // Yikes! We now don't have a parameterless constructor...
    public Bar(int x)
    {
    }
} 
```

* * *

## 回答 #2

> 赞同：191
> 
> 时间：2017-01-16T21:57:06.417

如前所述，您不能在接口上拥有构造函数。但由于这是大约 7 年后在 Google 中排名很高的结果，我想我会在这里插话——特别是展示如何将抽象基类与现有接口结合使用，并可能减少重构量将来需要类似的情况。一些评论中已经暗示了这个概念，但我认为值得展示如何实际做到这一点。

因此，到目前为止，您的主界面如下所示：

```
public interface IDrawable
{
    void Update();
    void Draw();
} 
```

现在使用要强制执行的构造函数创建一个抽象类。实际上，自从您编写原始问题以来，它现在就可用了，我们可以在这里稍微花点心思并在这种情况下使用泛型，以便我们可以将其调整到可能需要相同功能但具有不同构造函数要求的其他接口：

```
public abstract class MustInitialize<T>
{
    public MustInitialize(T parameters)
    {

    }
} 
```

现在您需要创建一个继承自 IDrawable 接口和 MustInitialize 抽象类的新类：

```
public class Drawable : MustInitialize<GraphicsDeviceManager>, IDrawable
{
    GraphicsDeviceManager _graphicsDeviceManager;

    public Drawable(GraphicsDeviceManager graphicsDeviceManager)
        : base (graphicsDeviceManager)
    {
        _graphicsDeviceManager = graphicsDeviceManager;
    }

    public void Update()
    {
        //use _graphicsDeviceManager here to do whatever
    }

    public void Draw()
    {
        //use _graphicsDeviceManager here to do whatever
    }
} 
```

然后只需创建一个 Drawable 实例就可以了：

```
IDrawable drawableService = new Drawable(myGraphicsDeviceManager); 
```

这里很酷的是，我们创建的新 Drawable 类的行为仍然与我们对 IDrawable 的期望相同。

如果您需要将多个参数传递给 MustInitialize 构造函数，您可以创建一个类来定义您需要传入的所有字段的属性。

* * *

## 回答 #3

> 赞同：146
> 
> 时间：2011-11-11T18:33:24.513

一个非常晚的贡献展示了接口构造函数的另一个问题。（我选择这个问题是因为它最清楚地表达了问题）。假设我们可以：

```
interface IPerson
{
    IPerson(string name);
}

interface ICustomer
{
    ICustomer(DateTime registrationDate);
}

class Person : IPerson, ICustomer
{
    Person(string name) { }
    Person(DateTime registrationDate) { }
} 
```

按照惯例，“接口构造函数”的实现被类型名称替换。

现在做一个实例：

```
ICustomer a = new Person("Ernie"); 
```

**我们会说合同`ICustomer`得到遵守吗？**

那么这个呢：

```
interface ICustomer
{
    ICustomer(string address);
} 
```

* * *

## 回答 #4

> 赞同：65
> 
> 时间：2009-03-06T18:15:32.943

你不能。

接口定义了其他对象实现的契约，因此没有需要初始化的状态。

如果您有一些需要初始化的状态，您应该考虑使用抽象基类。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2012-03-02T18:35:26.020

我回顾了这个问题，我心想，也许我们以错误的方式解决了这个问题。当涉及定义具有某些参数的构造函数时，接口可能不是要走的路……但是（抽象）基类是。

如果您在那里创建一个带有构造函数的基类，该构造函数接受您需要的参数，那么从它派生的每个类都需要提供它们。

```
public abstract class Foo
{
  protected Foo(SomeParameter x)
  {
    this.X = x;
  }

  public SomeParameter X { get; private set }
}

public class Bar : Foo // Bar inherits from Foo
{
  public Bar() 
    : base(new SomeParameter("etc...")) // Bar will need to supply the constructor param
  {
  }
} 
```

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2009-03-06T18:40:04.367

不可能创建定义构造函数的接口，但**可以**定义一个强制类型具有无参数构造函数的接口，尽管它是使用泛型的非常丑陋的语法......我实际上不太确定这确实是一个很好的编码模式。

```
public interface IFoo<T> where T : new()
{
  void SomeMethod();
}

public class Foo : IFoo<Foo>
{
  // This will not compile
  public Foo(int x)
  {

  }

  #region ITest<Test> Members

  public void SomeMethod()
  {
    throw new NotImplementedException();
  }

  #endregion
} 
```

另一方面，如果你想测试一个类型是否有一个无参数的构造函数，你可以使用反射来做到这一点：

```
public static class TypeHelper
{
  public static bool HasParameterlessConstructor(Object o)
  {
    return HasParameterlessConstructor(o.GetType());
  }

  public static bool HasParameterlessConstructor(Type t)
  {
    // Usage: HasParameterlessConstructor(typeof(SomeType))
    return t.GetConstructor(new Type[0]) != null;
  }
} 
```

希望这可以帮助。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-06-29T03:43:25.520

我发现解决这个问题的一种方法是将建筑分离成一个单独的工厂。例如，我有一个名为 IQueueItem 的抽象类，我需要一种方法将该对象与另一个对象 (CloudQueueMessage) 相互转换。所以在接口 IQueueItem 我有 -

```
public interface IQueueItem
{
    CloudQueueMessage ToMessage();
} 
```

现在，我还需要一种方法让我的实际队列类将 CloudQueueMessage 转换回 IQueueItem - 即需要像 IQueueItem objMessage = ItemType.FromMessage 这样的静态构造。相反，我定义了另一个接口 IQueueFactory -

```
public interface IQueueItemFactory<T> where T : IQueueItem
{
    T FromMessage(CloudQueueMessage objMessage);
} 
```

现在我终于可以在没有 new() 约束的情况下编写我的通用队列类了，这在我的例子中是主要问题。

```
public class AzureQueue<T> where T : IQueueItem
{
    private IQueueItemFactory<T> _objFactory;
    public AzureQueue(IQueueItemFactory<T> objItemFactory)
    {
        _objFactory = objItemFactory;
    }

    public T GetNextItem(TimeSpan tsLease)
    {
        CloudQueueMessage objQueueMessage = _objQueue.GetMessage(tsLease);
        T objItem = _objFactory.FromMessage(objQueueMessage);
        return objItem;
    }
} 
```

现在我可以创建一个满足我条件的实例

```
 AzureQueue<Job> objJobQueue = new JobQueue(new JobItemFactory()) 
```

希望有一天这可以帮助其他人，显然删除了很多内部代码以尝试显示问题和解决方案

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-04-19T20:46:46.693

解决这个问题的一种方法是利用泛型和 new() 约束。

您可以将其表示为工厂类/接口，而不是将构造函数表示为方法/函数。如果您在需要创建类对象的每个调用站点上指定 new() 通用约束，您将能够相应地传递构造函数参数。

对于您的 IDrawable 示例：

```
public interface IDrawable
{
    void Update();
    void Draw();
}

public interface IDrawableConstructor<T> where T : IDrawable
{
    T Construct(GraphicsDeviceManager manager);
}

public class Triangle : IDrawable
{
    public GraphicsDeviceManager Manager { get; set; }
    public void Draw() { ... }
    public void Update() { ... }
    public Triangle(GraphicsDeviceManager manager)
    {
        Manager = manager;
    }
}

public TriangleConstructor : IDrawableConstructor<Triangle>
{
    public Triangle Construct(GraphicsDeviceManager manager)
    {
        return new Triangle(manager);
    } 
} 
```

现在当你使用它时：

```
public void SomeMethod<TBuilder>(GraphicsDeviceManager manager)
  where TBuilder: IDrawableConstructor<Triangle>, new()
{
    // If we need to create a triangle
    Triangle triangle = new TBuilder().Construct(manager);

    // Do whatever with triangle
} 
```

您甚至可以使用显式接口实现将所有创建方法集中在一个类中：

```
public DrawableConstructor : IDrawableConstructor<Triangle>,
                             IDrawableConstructor<Square>,
                             IDrawableConstructor<Circle>
{
    Triangle IDrawableConstructor<Triangle>.Construct(GraphicsDeviceManager manager)
    {
        return new Triangle(manager);
    } 

    Square IDrawableConstructor<Square>.Construct(GraphicsDeviceManager manager)
    {
        return new Square(manager);
    } 

    Circle IDrawableConstructor<Circle>.Construct(GraphicsDeviceManager manager)
    {
        return new Circle(manager);
    } 
} 
```

要使用它：

```
public void SomeMethod<TBuilder, TShape>(GraphicsDeviceManager manager)
  where TBuilder: IDrawableConstructor<TShape>, new()
{
    // If we need to create an arbitrary shape
    TShape shape = new TBuilder().Construct(manager);

    // Do whatever with the shape
} 
```

另一种方法是使用 lambda 表达式作为初始值设定项。在调用层次结构的早期某个时刻，您将知道需要实例化哪些对象（即，当您创建或获取对 GraphicsDeviceManager 对象的引用时）。获得它后，立即传递 lambda

```
() => new Triangle(manager) 
```

到后续方法，以便他们从那时起知道如何创建三角形。如果你不能确定你需要的所有可能的方法，你总是可以创建一个使用反射实现 IDrawable 的类型字典，并在字典中注册上面显示的 lambda 表达式，你可以存储在共享位置或传递给进一步的函数调用。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-06-28T21:17:33.553

通用工厂方法似乎仍然很理想。您会知道工厂需要一个参数，而这些参数恰好被传递给正在实例化的对象的构造函数。

请注意，这只是经过语法验证的伪代码，我在这里可能缺少运行时警告：

```
public interface IDrawableFactory
{
    TDrawable GetDrawingObject<TDrawable>(GraphicsDeviceManager graphicsDeviceManager) 
              where TDrawable: class, IDrawable, new();
}

public class DrawableFactory : IDrawableFactory
{
    public TDrawable GetDrawingObject<TDrawable>(GraphicsDeviceManager graphicsDeviceManager) 
                     where TDrawable : class, IDrawable, new()
    {
        return (TDrawable) Activator
                .CreateInstance(typeof(TDrawable), 
                                graphicsDeviceManager);
    }

}

public class Draw : IDrawable
{
 //stub
}

public class Update : IDrawable {
    private readonly GraphicsDeviceManager _graphicsDeviceManager;

    public Update() { throw new NotImplementedException(); }

    public Update(GraphicsDeviceManager graphicsDeviceManager)
    {
        _graphicsDeviceManager = graphicsDeviceManager;
    }
}

public interface IDrawable
{
    //stub
}
public class GraphicsDeviceManager
{
    //stub
} 
```

一个可能的用法示例：

```
 public void DoSomething()
    {
        var myUpdateObject = GetDrawingObject<Update>(new GraphicsDeviceManager());
        var myDrawObject = GetDrawingObject<Draw>(null);
    } 
```

当然，您只希望通过工厂创建实例来保证您始终拥有一个适当初始化的对象。也许使用像[AutoFac](http://code.google.com/p/autofac/)这样的依赖注入框架是有意义的；Update() 可以向 IoC 容器“询问”一个新的 GraphicsDeviceManager 对象。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-08-14T07:35:24.557

您可以使用泛型技巧来做到这一点，但它仍然容易受到 Jon Skeet 所写内容的影响：

```
public interface IHasDefaultConstructor<T> where T : IHasDefaultConstructor<T>, new()
{
} 
```

实现此接口的类必须具有无参数构造函数：

```
public class A : IHasDefaultConstructor<A> //Notice A as generic parameter
{
    public A(int a) { } //compile time error
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-02-18T18:31:50.277

接口的目的是强制执行某个对象签名。它不应该明确地关心对象在内部是如何工作的。因此，从概念的角度来看，接口中的构造函数并不真正有意义。

虽然有一些选择：

*   创建一个充当最小默认实现的抽象类。该类应该具有您期望实现类具有的构造函数。

*   如果您不介意过度杀伤，请使用 AbstractFactory 模式并在工厂类接口中声明一个具有所需签名的方法。

*   将`GraphicsDeviceManager`作为参数传递给`Update`和`Draw`方法。

*   使用组合式面向对象编程框架将其传递`GraphicsDeviceManager`到需要它的对象部分。在我看来，这是一个非常实验性的解决方案。

你所描述的情况一般都不容易处理。类似的情况是业务应用程序中需要访问数据库的实体。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-06T18:20:53.117

你没有。

构造函数是可以实现接口的类的一部分。接口只是类必须实现的方法的契约。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-05-18T01:15:23.707

如果可以在接口中定义构造函数，那将非常有用。

鉴于接口是必须以指定方式使用的合约。对于某些情况，以下方法可能是可行的替代方案：

```
public interface IFoo {

    /// <summary>
    /// Initialize foo.
    /// </summary>
    /// <remarks>
    /// Classes that implement this interface must invoke this method from
    /// each of their constructors.
    /// </remarks>
    /// <exception cref="InvalidOperationException">
    /// Thrown when instance has already been initialized.
    /// </exception>
    void Initialize(int a);

}

public class ConcreteFoo : IFoo {

    private bool _init = false;

    public int b;

    // Obviously in this case a default value could be used for the
    // constructor argument; using overloads for purpose of example

    public ConcreteFoo() {
        Initialize(42);
    }

    public ConcreteFoo(int a) {
        Initialize(a);
    }

    public void Initialize(int a) {
        if (_init)
            throw new InvalidOperationException();
        _init = true;

        b = a;
    }

} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-02-12T16:27:45.857

强制某种构造函数的一种方法是仅`Getters`在接口中声明，这可能意味着实现类必须有一个方法，最好是构造函数，为其设置值（`private`ly）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-11-06T19:29:59.733

虽然您不能在接口中定义构造函数签名，但我觉得值得一提的是，这可能是考虑抽象类的地方。抽象类可以以与接口相同的方式定义未实现的（抽象）方法签名，但也可以具有已实现的（具体）方法和构造函数。

缺点是，因为它是一种类，它不能用于接口可以的任何多继承类型场景。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-03-13T13:12:06.170

我使用以下模式使其防弹。

*   从基类派生他的类的开发人员不能意外地创建一个公共可访问的构造函数
*   最终类开发人员被迫通过通用的create方法
*   一切都是类型安全的，不需要铸件
*   它是 100% 灵活的，可以在任何地方重用，您可以在其中定义自己的基类。
*   尝试一下，如果不对基类进行修改，就无法破坏它（除非您定义了一个过时的标志而没有将错误标志设置为 true，但即便如此，您最终也会收到警告）

    ```
     public abstract class Base<TSelf, TParameter>
        where TSelf : Base<TSelf, TParameter>, new()
    {
        protected const string FactoryMessage = "Use YourClass.Create(...) instead";
        public static TSelf Create(TParameter parameter)
        {
            var me = new TSelf();
            me.Initialize(parameter);

            return me;
        }

        [Obsolete(FactoryMessage, true)]
        protected Base()
        {
        }

        protected virtual void Initialize(TParameter parameter)
        {

        }
    }

    public abstract class BaseWithConfig<TSelf, TConfig>: Base<TSelf, TConfig>
        where TSelf : BaseWithConfig<TSelf, TConfig>, new()
    {
        public TConfig Config { get; private set; }

        [Obsolete(FactoryMessage, true)]
        protected BaseWithConfig()
        {
        }
        protected override void Initialize(TConfig parameter)
        {
            this.Config = parameter;
        }
    }

    public class MyService : BaseWithConfig<MyService, (string UserName, string Password)>
    {
        [Obsolete(FactoryMessage, true)]
        public MyService()
        {
        }
    }

    public class Person : Base<Person, (string FirstName, string LastName)>
    {
        [Obsolete(FactoryMessage,true)]
        public Person()
        {
        }

        protected override void Initialize((string FirstName, string LastName) parameter)
        {
            this.FirstName = parameter.FirstName;
            this.LastName = parameter.LastName;
        }

        public string LastName { get; private set; }

        public string FirstName { get; private set; }
    }

    [Test]
    public void FactoryTest()
    {
        var notInitilaizedPerson = new Person(); // doesn't compile because of the obsolete attribute.
        Person max = Person.Create(("Max", "Mustermann"));
        Assert.AreEqual("Max",max.FirstName);

        var service = MyService.Create(("MyUser", "MyPassword"));
        Assert.AreEqual("MyUser", service.Config.UserName);
    } 
    ```

**编辑：** 这是一个基于您的绘图示例的示例，它甚至强制执行接口抽象

```
 public abstract class BaseWithAbstraction<TSelf, TInterface, TParameter>
        where TSelf : BaseWithAbstraction<TSelf, TInterface, TParameter>, TInterface, new()
    {
        [Obsolete(FactoryMessage, true)]
        protected BaseWithAbstraction()
        {
        }

        protected const string FactoryMessage = "Use YourClass.Create(...) instead";
        public static TInterface Create(TParameter parameter)
        {
            var me = new TSelf();
            me.Initialize(parameter);

            return me;
        }

        protected virtual void Initialize(TParameter parameter)
        {

        }
    }

    public abstract class BaseWithParameter<TSelf, TInterface, TParameter> : BaseWithAbstraction<TSelf, TInterface, TParameter>
        where TSelf : BaseWithParameter<TSelf, TInterface, TParameter>, TInterface, new()
    {
        protected TParameter Parameter { get; private set; }

        [Obsolete(FactoryMessage, true)]
        protected BaseWithParameter()
        {
        }
        protected sealed override void Initialize(TParameter parameter)
        {
            this.Parameter = parameter;
            this.OnAfterInitialize(parameter);
        }

        protected virtual void OnAfterInitialize(TParameter parameter)
        {
        }
    }

    public class GraphicsDeviceManager
    {

    }
    public interface IDrawable
    {
        void Update();
        void Draw();
    }

    internal abstract class Drawable<TSelf> : BaseWithParameter<TSelf, IDrawable, GraphicsDeviceManager>, IDrawable 
        where TSelf : Drawable<TSelf>, IDrawable, new()
    {
        [Obsolete(FactoryMessage, true)]
        protected Drawable()
        {
        }

        public abstract void Update();
        public abstract void Draw();
    }

    internal class Rectangle : Drawable<Rectangle>
    {
        [Obsolete(FactoryMessage, true)]
        public Rectangle()
        {
        }

        public override void Update()
        {
            GraphicsDeviceManager manager = this.Parameter;
            // TODo  manager
        }

        public override void Draw()
        {
            GraphicsDeviceManager manager = this.Parameter;
            // TODo  manager
        }
    }
    internal class Circle : Drawable<Circle>
    {
        [Obsolete(FactoryMessage, true)]
        public Circle()
        {
        }

        public override void Update()
        {
            GraphicsDeviceManager manager = this.Parameter;
            // TODo  manager
        }

        public override void Draw()
        {
            GraphicsDeviceManager manager = this.Parameter;
            // TODo  manager
        }
    }

    [Test]
    public void FactoryTest()
    {
        // doesn't compile because interface abstraction is enforced.
        Rectangle rectangle = Rectangle.Create(new GraphicsDeviceManager());

        // you get only the IDrawable returned.
        IDrawable service = Circle.Create(new GraphicsDeviceManager());
    } 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2016-12-20T18:58:22.453

如果我对 OP 的理解正确，我们希望执行一个契约，其中 GraphicsDeviceManager 总是通过实现类来初始化。我有一个类似的问题，我正在寻找一个更好的解决方案，但这是我能想到的最好的：

将 SetGraphicsDeviceManager(GraphicsDeviceManager gdo) 添加到接口，这样实现类将被迫编写需要从构造函数调用的逻辑。

* * *

## 回答 #18

> 赞同：-5
> 
> 时间：2020-03-30T20:12:47.617

从 C# 8.0 开始，接口成员可以声明主体。这称为默认实现。具有主体的成员允许接口为不提供覆盖实现的类和结构提供“默认”实现。此外，从 C# 8.0 开始，接口可能包括：

常量运算符静态构造函数。嵌套类型 静态字段、方法、属性、索引器和事件 使用显式接口实现语法的成员声明。显式访问修饰符（默认访问是公共的）。

# .net - 如何在 .NET 中为多个 SqlConnections 使用单个 SqlTransaction？

> ID：619857
> 
> 赞同：3
> 
> 时间：2009-03-06T18:14:04.693
> 
> 标签：.net, sql, sql-server, sql-server-2000, transactions

1.  我有 SQL Server 2000，**它不支持 MultipleActiveResults**。
2.  我必须进行多次插入，并且每次插入一个连接即可完成。
3.  我想在所有插入之前开始一个事务并在所有插入之后完成它。
4.  我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T18:21:18.593

您没有指定是否使用 .NET 2.0，但我会做出这样的假设。C# 3.0 示例代码如下：

```
using (var tx = new TransactionScope()) {
    // Execute multiple DB statements inside here
    ts.Complete();
} 
```

如果任何 DB 语句失败，则永远不会到达 ts.complete，并且事务将在 using 语句结束时自动回滚。但是，对这种方法的一个警告是，如果您使用多个连接，您最终将利用 DTC，这意味着性能较慢。

编辑将 SqlTransaction 更改为 TransactionScope

强制单个 SQL 连接以避免使用 DTC 的示例：

```
using (var tx = new TransactionScope())
using (var db = new SqlConnection(connString)) {
    // Command 1
    using (var cmd = db.CreateCommand()) {
        cmd.CommandText = "select...";
        using (var reader = cmd.ExecuteReader()) {
           // Process results or store them somewhere for later
        }
    }

    // Command 2
    using (var cmd = db.CreateCommand()) {
        cmd.CommandText = "select...";
        using (var reader = cmd.ExecuteReader()) {
           // Process results or store them somewhere for later
        }
    }

    // Command 3
    using (var cmd = db.CreateCommand()) {
        cmd.CommandText = "select...";
        using (var reader = cmd.ExecuteReader()) {
           // Process results or store them somewhere for later
        }
    }
    tx.Complete();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T18:59:54.990

事务是在连接上创建的，并且没有超出创建它们的连接的范围，因此您无法执行您所要求的操作。重构，以便您可以在连接上按顺序执行插入，而不是同时执行，或者实现不同的机制来实现回滚（例如，插入键的表可以用作查找以在稍后遇到错误时删除插入的记录过程）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T19:10:23.637

您不使用一个连接和多个命令（实际上是在循环中重新创建一个命令）的原因是什么？也许这个解决方案对你有用：

```
 public static void CommandExecNonQuery(SqlCommand cmd, 
       string query, SqlParameter[] prms)
    {
        cmd.CommandText = query;
        cmd.Parameters.AddRange(prms);
        cmd.ExecuteNonQuery();
        cmd.Parameters.Clear();
    }

    static void Main(string[] args)
    {
        string insertQuery = 
           @"INSERT TESTTABLE (COLUMN1, COLUMN2) " + 
             "VALUES(@ParamCol1, @ParamCol2)";
        using (SqlConnection connection = 
          new SqlConnection(connectionString))
        {
            using (SqlCommand command = 
              connection.CreateCommand())
            {
                SqlTransaction transaction = null;
                try
                {
                    // BeginTransaction() Requires Open Connection
                    connection.Open();

                    transaction = connection.BeginTransaction();

                    // Assign Transaction to Command
                    command.Transaction = transaction;
                    for (int i = 0; i < 100; i++)
                        CommandExecNonQuery(command, insertQuery, 
                          new SqlParameter[] { 
                            new SqlParameter("@ParamCol1", i), 
                            new SqlParameter("@ParamCol2", i.ToString()) });
                    transaction.Commit();
                }
                catch
                {
                    transaction.Rollback();
                    throw;
                }
                finally
                {
                    connection.Close();
                }
            }
        }
    } 
```

另请参阅
[Sql Server 事务 - ADO.NET 2.0 - 提交和回滚 - 使用语句 - IDisposable](http://davidhayden.com/blog/dave/archive/2005/10/14/2515.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T18:42:35.187

我不认为一个事务可以跨越多个连接。

在单独的连接中进行多次插入的原因是什么？我认为您通常希望它们在一个连接中。

# c - struct c 动态分配内存

> ID：619858
> 
> 赞同：2
> 
> 时间：2009-03-06T18:14:21.200
> 
> 标签：c, struct, calloc

我正在使用一个结构，我想初始化最多 10 个端口。但是，当程序运行时，它可能会少很多，直到运行时我们才知道。但是，这将是最大值。我以前从未做过这样的 struct ，因为我通常使用 calloc 和 delcare 动态分配 *ports 作为值类型。

但是，我无法理解这一点

```
*ports[MAX_PORTS]. Am I creating 10 pointers that point to port objects? 
```

和

```
*ports = (struct port_t*) calloc(2, sizeof(*ports)); 
```

看起来我正在分配一个指向自由存储上分配的 2 个端口对象的单个指针？

我不明白为什么我将点运算符与箭头运算符一起使用？端口[0]->port_id = 20；printf("port_id: %d\n", 端口[0]->port_id);

```
#include <stdio.h>
#include <stdlib.h>

#define MAX_PORTS 10

struct port_t
{
    int port_id;
    char name;
} *ports[MAX_PORTS];

int main(void)
{
    *ports = (struct port_t*) calloc(2, sizeof(*ports));

    ports[0]->port_id = 20;

    printf("port_id: %d\n", ports[0]->port_id);

    return 0;
} 
```

通常，我在传递中所做的是：

```
struct port_t
{
    int port_id;
    char name;
} *ports;

ports = (struct port_t*) calloc(2, sizeof(*ports)); 
```

然后使用以下任一项进行分配。但是，之前的程序员已经声明了我在顶部显示的所有内容，因此我无法更改任何内容。

```
ports[0].port_id = 10;
ports->port_id = 10; 
```

非常感谢您的任何建议，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T18:41:27.217

你的第一个代码块有

```
struct port_t
{
    int port_id;
    char name;
} *ports[MAX_PORTS]; 
```

这是一个指针数组。这意味着稍后当您使用

```
ports[0]->port_id 
```

您正在取消引用数组中的第一个指针。您实际调用的内容的大小也有一些丑陋。您实际上是用 2 的数组替换了 10 的数组。您所拥有的通常很难看且容易出错。

我相信你的意图更接近于：

```
struct port_t
{
    int port_id;
    char name;
} *ports;

int main(void)
{
    *ports = (struct port_t*) calloc(2, sizeof(*ports));

    ports[0].port_id = 20;

    printf("port_id: %d\n", ports[0].port_id);

    return 0;
} 
```

**由于您使用的是 C99，因此如果您真的想**使用 C99 的变量数组声明，则可以避免使用 calloc()/malloc() 。

```
port_t array_on_mains_stack[some_runtime_port_count];
ports = array_on_mains_stack; 
```

诀窍在于，由于它在堆栈上，因此它仅在该函数及其调用的任何函数中有效。一旦你从那个函数返回，它当然会被释放。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-06T18:50:48.070

```
*ports[MAX_PORTS]. Am I creating 10 pointers that point to port objects? 
```

是的，你正在制作一个由十个指针组成的数组

```
*ports = (struct port_t*) calloc(2, sizeof(*ports)); 
```

...但是这条线是胡说八道。与此相同：

```
ports[0] = (struct port_t*) calloc(2, sizeof(port_t)); 
```

IE。您将第一个指针设置为指向两个端口的足够内存。

对于这么小的事情，制作十个端口但不要全部使用它们会更有意义：

```
#define MAX_PORTS 10

struct port_t
{
    int port_id;
    char name;
} ports[MAX_PORTS];

/* number of ports in use */
int numPorts = 0;

int main(void)
{
    numPorts = 3;
    for (int i=0; i<numPorts; i++) {
     ports[i].port_id = i;
     printf("port_id %d: %d\n", i, ports[i].port_id);
    }
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T18:45:23.637

ports 是指向 port_t 对象的指针数组，因此通过执行 ports[0] 你得到一个指针，而不是一个对象，你需要使用 -> 访问它

在 C 语言中获取关于指针的良好资源并从头到尾阅读它。还有阅读 C 声明的教程。通过获得随机问题的答案，您将无法理解该主题。

[这](http://home.netcom.com/~tjensen/ptr/pointers.htm)是一个值得阅读的链接。

# plone - 自定义 Plone 3 共享选项卡

> ID：619862
> 
> 赞同：0
> 
> 时间：2009-03-06T18:14:48.577
> 
> 标签：plone, plone-3.x

plone 3分享标签中的标题“可以添加”、“可以编辑”、“可以查看”和“可以评论”从何而来？

“可以查看”和“可以评论”有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T18:32:11.030

“可以查看”是指查看权限，它本质上控制谁可以查看给定的内容。

“可以审阅”是指审阅者角色，该角色规定谁将能够在发布工作流程的上下文中“审阅”内容。

这些本地角色在 plone/app/workflow/localroles.py 中定义

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-01T14:34:35.187

值得一提的是，在 Plone 4 中共享选项卡角色将更容易使用 GenericSetup 进行自定义。自定义的sharing.xml 步骤将类似于：

```
<sharing xmlns:i18n="http://xml.zope.org/namespaces/i18n" i18n:domain="plone">
    <role
        id="CopyEditor"
        title="Can edit copy"
        permission="Manage portal"
        i18n:attributes="title"
        />
</sharing> 
```

# sql - 在 SQL Server 表中创建新的文本列：我应该选择哪种类型？

> ID：619863
> 
> 赞同：4
> 
> 时间：2009-03-06T18:14:54.660
> 
> 标签：sql, sql-server, database, database-design, data-structures

我有一个长度可以为 30 个字符的文本字段，但它可以达到大约 2.000 个字符。

为了“未来的安全”，如果这个新列可以支持到 3.000 个字符，那就太好了。我认为这个字段的平均大小是 250 个字符。

**哪种 SQL Server 2000 数据类型更能提高性能和磁盘空间？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-06T18:20:46.567

您需要 unicode 还是非 unicode 数据？使用 varchar(3000) 或 nvarchar (3000)。不要使用 text 或 ntext ，因为它们会导致查询或更新问题。

设计平均长度是没有意义的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T18:18:37.833

如果您的字段最多可容纳 3000 个字符，则您可能应该确保您的数据类型允许这么大的内容。设计基于你的最大值，而不是你的平均值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T18:20:51.900

这听起来像是 VarChar 的完美案例。你在这个领域做任何索引吗？

# iphone - iPhone 本地化：是否可以轻松翻译 nib 文件而无需为每种语言复制 nib？

> ID：619867
> 
> 赞同：10
> 
> 时间：2009-03-06T18:15:15.207
> 
> 标签：iphone, localization, internationalization

我试图找到一种可管理的方式来翻译 iPhone 应用程序中的每个可见字符串。苹果官方文档说使用 .strings 文件作为编程字符串，同时使用 xcode 中内置的“添加本地化文件”选项来本地化 nib 文件。

我看到的问题是，如果在本地化发生后 UI 需要更改，那么我们需要单独更新每种语言的 nib，这不是最佳的。有没有一种更简单的方法可以将 nib 文件中显示的字符串与 .strings 文件中的相关值联系起来？还是我必须以编程方式为每个 ui 元素设置这些字符串（这稍微好一些但仍然很烦人）？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-24T21:24:06.113

Apple 的内置命令行程序 ibtool 可让您执行此操作。您可以从 XIB 中转储字符串，对它们进行本地化，然后基于现有 XIB 但使用本地化字符串创建新的 XIB。因此，您始终可以拥有一组基本的 XIB，并在本地化字符串更改时重新创建它们。更多信息在这里：[http](http://www.bdunagan.com/2009/03/15/ibtool-localization-made-easy/) ://www.bdunagan.com/2009/03/15/ibtool-localization-made-easy/ 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-08T09:46:32.260

您可以做的最好的事情是递归地遍历每个视图，然后在它们上设置文本：

```
static void translateView(NSBundle *bundle, UIView *view)
{
    id idView = view;
    if ([idView respondsToSelector:@selector(text)] && [view respondsToSelector:@selector(setText:)])
        [idView setText:[bundle localizedStringForKey:[idView text] value:nil table:nil]];
    if ([idView respondsToSelector:@selector(title)] && [view respondsToSelector:@selector(setTitle:)])
        [idView setTitle:[bundle localizedStringForKey:[idView title] value:nil table:nil]];
    if ([idView respondsToSelector:@selector(placeholder)] && [view respondsToSelector:@selector(setPlaceholder:)])
        [idView setPlaceholder:[bundle localizedStringForKey:[idView placeholder] value:nil table:nil]];
    if ([idView respondsToSelector:@selector(prompt)] && [view respondsToSelector:@selector(setPrompt:)])
        [idView setPrompt:[bundle localizedStringForKey:[idView prompt] value:nil table:nil]];
    if ([idView respondsToSelector:@selector(titleForState:)] && [view respondsToSelector:@selector(setTitle:forState:)])
        [idView setTitle:[bundle localizedStringForKey:[idView titleForState:UIControlStateNormal] value:nil table:nil] forState:UIControlStateNormal];
    if ([idView isKindOfClass:[UITabBar class]] || [idView isKindOfClass:[UIToolbar class]])
        for (UIBarItem *item in [idView items])
            [item setTitle:[bundle localizedStringForKey:[item title] value:nil table:nil]];
    for (UIView *subview in [view subviews])
        translateView(bundle, subview);
} 
```

警告：您可能必须检查其他选择器集才能捕获所有内容。这不是最佳实践，但似乎工作量要少得多

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T19:14:57.480

我想你想了解一下命令行工具：ibtool。它应该简化您要执行的操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-03T17:28:37.780

您可以按照以下简单指南自动本地化您的笔尖，而无需复制它们：

[http://programminghacks.net/2011/06/03/ios-nib-localization-in-localizable-strings/](http://programminghacks.net/2011/06/03/ios-nib-localization-in-localizable-strings/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-08T09:38:31.890

也许您应该手动更新每个字符串。假设您有一个包含不同语言字符串的数组或 xml 文件，当用户更改语言时，只需从数组中获取翻译后的字符串，然后将其更改为 UI。

马可

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-20T18:32:53.297

我总是在 viewDidLoad() 方法中设置所有需要的字符串，而 .xib 中只有占位符。这样，我只需更新 .string 文件即可轻松本地化任何 .xib

# ruby-on-rails - Rails 表单，在一个表单中创建多个父母和孩子

> ID：619868
> 
> 赞同：2
> 
> 时间：2009-03-06T18:15:19.510
> 
> 标签：ruby-on-rails

我之前问过这个问题，但我要改写一下。我有一个用户可以创建许多目标的工作表，每个目标都有许多属性（选择指定attribute_id）。每个目标都是通过 jscript 添加的。ryan bates 的多模型截屏视频解释了如何动态添加多个孩子，但没有深入研究多个父母。编码

> `<% fields_for "target_attributes[]", Target.new do |target| -%>` `<%= target.select("id",@classification_hash[classification_type.id].collect{|c| [c.name,c.id]}`

给我选择元素（ form_for :worksheet）

> `<select id="worksheet__target_id" class="selectbox" name="worksheet[target_attributes][][attribute_id]">`

并将我所有的目标属性放入传递的参数中的哈希数组中，这很好。所以我想我可以采用这个逻辑并拥有一个嵌套的fields_for，然后将我所有的目标及其属性放入他们自己的数组中

> `<% fields_for "worksheet[]",Worksheet.new do |worksheet| -%>` `<% worksheet.fields_for "target_attributes[]", Target.new do |target| -%>` `<%= target.select("id",@classification_hash[classification_type.id].collect{|c| [c.name,c.id]}`

给我表格

> `<select id="worksheet__target_id" class="selectbox" name="worksheet[][target_attributes][][attribute_id]">`

所以，我想我所有的目标都在他们自己的数组中，并且所有都是肉汁，但我在我的参数中得到了这个：

```
工作表“=>
  [{"target_attributes"=>[{"id"=>"12"}]},
   {"target_attributes"=>[{"id"=>"15"}]},
   {"target_attributes"=>[{"id"=>"17"}]},
   {"target_attributes"=>[{"id"=>"14"}]},
   {"target_attributes"=>[{"id"=>"16"}]},
   {"target_attributes"=>[{"id"=>"17"}]}]

```

（注意，每个目标有 3 个 target_attribute 选择，因此列出了具有 3 个属性的两个目标）所以，显然我不能在控制器中以这种方式分隔每个目标以创建新的目标对象。谁能帮我吗？我想要一个看起来像这样的表格：

`<select id="worksheet__target_id" class="selectbox" name="worksheet[target_attributes][0][][attribute_id]">`（3次，每个目标属性）

`<select id="worksheet__target_id" class="selectbox" name="worksheet[target_attributes][1][][attribute_id]">`等为每个添加的目标

然后，对于每个新任务，我基本上都有一个新的“行”。但是如果没有一些杂乱的 Javascript 来评估选择名称并根据一些 Javascript 迭代器变量对其进行修改，我看不到任何方法。任何想法都非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T04:51:16.080

我不想对 Rails 世界中通常有些困难的问题给出一个简短的回答，但如果可以的话，请考虑升级到 rails 2.3（它现在是一个候选版本，可能会在本周日发布）。

恕我直言，此版本的最大特点是嵌套模型表单更容易。

与其在这里解释，不如看一下 rails 2.3 发行说明： http: [//guides.rubyonrails.org/2_3_release_notes.html#nested-object-forms](http://guides.rubyonrails.org/2_3_release_notes.html#nested-object-forms)

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T06:27:22.590

查看[ActivePresenter](http://jamesgolick.com/2008/7/28/introducing-activepresenter-the-presenter-library-you-already-know)。它会帮助你做你想做的事。

# c# - c#标签可见和调用

> ID：619870
> 
> 赞同：0
> 
> 时间：2009-03-06T18:15:33.567
> 
> 标签：c#, windows-mobile, invoke

我在**Compact Framework 2.0 SP1中开发了一个****Windows Mobile**应用程序。

 **如何使用调用使标签不可见？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T18:59:09.063

您只是想更改标签的 Visible 属性？一般来说，它是这样的：

```
private void SetVisibility(Control target, bool visible)
{
    if (target.InvokeRequired)
    {
        target.Invoke(new EventHandler(
            delegate
            {
                target.Visible = visible;
            }));
    }
    else
    {
        target.Visible = visible;
    }
} 
```

# flash - 我需要帮助重置 ActiveX 和 Flash Player 的默认设置

> ID：619880
> 
> 赞同：0
> 
> 时间：2009-03-06T18:18:44.823
> 
> 标签：flash, security

当我启动 Web 浏览器并想查看网站或在 Flash Player 上查看某些内容时，我收到以下消息：

> 您的安全设置不允许网站使用安装在您计算机上的 ActiveX 控件。此页面可能无法正确显示。单击此处获取选项。

或者我得到这个：

> 如果此站点未加载，请单击此处安装 Flash。

有人可以帮我重置我的设置，这样我就不再有这个问题了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-24T16:45:25.073

我认为您使用的是 Internet Explorer？如果您愿意，请使用更好的浏览器，例如 firefox。

# visual-studio-2008 - 在带有 SQL Server 2005 大小的 VS 2008 中部署数据库时出错，大小必须至少为 3MB？

> ID：619884
> 
> 赞同：5
> 
> 时间：2009-03-06T18:19:35.383
> 
> 标签：visual-studio-2008, sql-server-2005

我在 VS 2008 中使用本地 SQL Server 2005 部署我的数据库时遇到以下错误。我部署了其他数据库，但这个似乎失败了。

> Bsg.COC.Database.dbschema(0,0)Error TSD01268：.Net SqlClient 数据提供者：消息 1803，级别 16，状态 1，第 1 行 CREATE DATABASE 语句失败。主文件必须至少为 3 MB 以容纳模型数据库的副本。

我做了一些搜索，一些建议是禁用 size 属性，但我无法在 IDE 中找到更改此设置的位置，只能在输出的 SQL 查询中找到。你知道在哪里可以找到尺寸属性设置吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T18:29:21.723

修复了它，在 Database\Schema Objects\Database Level Objects\Storage\Files\DATABASENAME.sqlfile.sql 文件中，设置为“size=??”，如果您将其更改为较低的数字，它将部署得很好。

# delphi - 像 RichEdit 这样支持嵌入照片的编辑器组件？

> ID：619888
> 
> 赞同：-1
> 
> 时间：2009-03-06T18:20:21.073
> 
> 标签：delphi, richedit

任何人都可以建议像 RichEdit 这样支持在 delphi 应用程序中嵌入照片的编辑器组件吗？RichEdit 似乎不支持这一点。

我不考虑嵌入 MS Word，因为不是每个人都会这样做。

比你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T20:36:13.137

我推荐 TRichView [http://www.trichview.com/](http://www.trichview.com/)。

我确实使用 WPTools 很长时间了，但最近我发现 TRichView 使用起来要简单得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T08:36:58.240

AFAIR 来自 rxlib 的 TrxRichEdit 支持嵌入图片。由于 rxlib 被合并到 jvcl 中，我想 TJvRichEdit 也应该这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T18:39:42.200

我认为当您插入 bmp 文件时它应该可以工作。不支持其他图像文件。也许您可以先将图像转换为位图？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T18:52:55.210

如果您不介意为组件库付费，我推荐[WP Tools](http://www.wpcubed.com/products/wptools/index.htm)。他们对文档格式有广泛的支持（包括插入图像），并将他们的库作为本机 VCL 包提供（所以你没有“什么版本的 Word”对话）。

# asp.net-mvc - 如何正确处理 ASP.NET MVC 中的 404？

> ID：619895
> 
> 赞同：443
> 
> 时间：2009-03-06T18:21:39.073
> 
> 标签：asp.net-mvc, http-status-code-404

我正在使用 RC2

**使用 URL 路由：**

```
routes.MapRoute(
    "Error",
     "{*url}",
     new { controller = "Errors", action = "NotFound" }  // 404s
); 
```

上面似乎处理了这样的请求（假设默认路由表由初始 MVC 项目设置）：“/blah/blah/blah/blah”

**在控制器本身中覆盖 HandleUnknownAction()：**

```
// 404s - handle here (bad action requested
protected override void HandleUnknownAction(string actionName) {
    ViewData["actionName"] = actionName;
    View("NotFound").ExecuteResult(this.ControllerContext);
} 
```

然而，之前的策略不处理对 Bad/Unknown 控制器的请求。例如，我没有“/IDoNotExist”，如果我请求这个，我会从 Web 服务器获得通用 404 页面，如果我使用路由 + 覆盖，则不是我的 404。

所以最后，我的问题是： *有没有办法在 MVC 框架本身中使用路由或其他东西来捕获这种类型的请求？*

或者我是否应该默认使用 Web.Config customErrors 作为我的 404 处理程序而忘记这一切？我假设如果我使用 customErrors，由于 Web.Config 对直接访问的限制，我将不得不将通用 404 页面存储在 /Views 之外。

* * *

## 回答 #1

> 赞同：278
> 
> 时间：2009-03-06T21:49:26.890

代码取自[http://blogs.microsoft.co.il/blogs/shay/archive/2009/03/06/real-world-error-hadnling-in-asp-net-mvc-rc2.aspx](http://blogs.microsoft.co.il/blogs/shay/archive/2009/03/06/real-world-error-hadnling-in-asp-net-mvc-rc2.aspx)并且有效在 ASP.net MVC 1.0 中也是如此

这是我处理http异常的方法：

```
protected void Application_Error(object sender, EventArgs e)
{
   Exception exception = Server.GetLastError();
   // Log the exception.

   ILogger logger = Container.Resolve<ILogger>();
   logger.Error(exception);

   Response.Clear();

   HttpException httpException = exception as HttpException;

   RouteData routeData = new RouteData();
   routeData.Values.Add("controller", "Error");

   if (httpException == null)
   {
       routeData.Values.Add("action", "Index");
   }
   else //It's an Http Exception, Let's handle it.
   {
       switch (httpException.GetHttpCode())
       {
          case 404:
              // Page not found.
              routeData.Values.Add("action", "HttpError404");
              break;
          case 500:
              // Server error.
              routeData.Values.Add("action", "HttpError500");
              break;

           // Here you can handle Views to other error codes.
           // I choose a General error template  
           default:
              routeData.Values.Add("action", "General");
              break;
      }
  }           

  // Pass exception details to the target error View.
  routeData.Values.Add("error", exception);

  // Clear the error on server.
  Server.ClearError();

  // Avoid IIS7 getting in the middle
  Response.TrySkipIisCustomErrors = true; 

  // Call target Controller and pass the routeData.
  IController errorController = new ErrorController();
  errorController.Execute(new RequestContext(    
       new HttpContextWrapper(Context), routeData));
} 
```

* * *

## 回答 #2

> 赞同：258
> 
> 时间：2010-04-05T05:46:08.477

# 404 的要求

以下是我对 404 解决方案的要求，下面我将展示我如何实现它：

*   我想处理带有错误操作的匹配路线
*   我想用坏控制器处理匹配的路由
*   我想处理不匹配的路由（我的应用程序无法理解的任意 url） - 我不希望这些冒泡到 Global.asax 或 IIS，因为那样[我就无法正确重定向回我的 MVC 应用程序](https://stackoverflow.com/questions/619895/how-can-i-properly-handle-404s-in-asp-net-mvc/620559#comment-2885216)
*   我想要一种以与上述相同的方式处理的方法，自定义 404 - 比如为不存在的对象（可能已删除）提交 ID 时
*   我希望我所有的 404 都返回一个 MVC 视图（不是静态页面），如果需要，我可以稍后将更多数据泵入该视图（[良好的 404 设计](http://www.codinghorror.com/blog/2007/03/creating-user-friendly-404-pages.html)）*，并且*它们*必须*返回 HTTP 404 状态代码

# 解决方案

我认为您应该`Application_Error`在 Global.asax 中保存更高级别的内容，例如未处理的异常和日志记录（如[Shay Jacoby 的回答](https://stackoverflow.com/questions/619895/how-can-i-properly-handle-404s-in-asp-net-mvc/620559#620559)显示），但不是 404 处理。这就是为什么我的建议将 404 内容保留在 Global.asax 文件之外的原因。

## 第 1 步：为 404 错误逻辑有一个共同的地方

这是可维护性的好主意。使用[ErrorController](https://stackoverflow.com/questions/108813/404-http-error-handler-in-asp-net-mvc-rc-5/108830#108830)以便将来对[精心设计的 404 页面](http://www.codinghorror.com/blog/2007/03/creating-user-friendly-404-pages.html)的改进可以轻松适应。另外，**请确保您的回复有 404 代码**！

```
public class ErrorController : MyController
{
    #region Http404

    public ActionResult Http404(string url)
    {
        Response.StatusCode = (int)HttpStatusCode.NotFound;
        var model = new NotFoundViewModel();
        // If the url is relative ('NotFound' route) then replace with Requested path
        model.RequestedUrl = Request.Url.OriginalString.Contains(url) & Request.Url.OriginalString != url ?
            Request.Url.OriginalString : url;
        // Dont get the user stuck in a 'retry loop' by
        // allowing the Referrer to be the same as the Request
        model.ReferrerUrl = Request.UrlReferrer != null &&
            Request.UrlReferrer.OriginalString != model.RequestedUrl ?
            Request.UrlReferrer.OriginalString : null;

        // TODO: insert ILogger here

        return View("NotFound", model);
    }
    public class NotFoundViewModel
    {
        public string RequestedUrl { get; set; }
        public string ReferrerUrl { get; set; }
    }

    #endregion
} 
```

## 第 2 步：使用基本 Controller 类，以便您可以轻松调用自定义 404 操作并连接`HandleUnknownAction`

ASP.NET MVC 中的 404 需要在许多地方捕获。第一个是`HandleUnknownAction`。

该`InvokeHttp404`方法为重新路由到`ErrorController`我们的新`Http404`操作创建了一个公共位置。想想[干](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)！

```
public abstract class MyController : Controller
{
    #region Http404 handling

    protected override void HandleUnknownAction(string actionName)
    {
        // If controller is ErrorController dont 'nest' exceptions
        if (this.GetType() != typeof(ErrorController))
            this.InvokeHttp404(HttpContext);
    }

    public ActionResult InvokeHttp404(HttpContextBase httpContext)
    {
        IController errorController = ObjectFactory.GetInstance<ErrorController>();
        var errorRoute = new RouteData();
        errorRoute.Values.Add("controller", "Error");
        errorRoute.Values.Add("action", "Http404");
        errorRoute.Values.Add("url", httpContext.Request.Url.OriginalString);
        errorController.Execute(new RequestContext(
             httpContext, errorRoute));

        return new EmptyResult();
    }

    #endregion
} 
```

## 第 3 步：在控制器工厂中使用依赖注入并连接 404 HttpExceptions

像这样（不一定是 StructureMap）：

*MVC1.0 示例：*

```
public class StructureMapControllerFactory : DefaultControllerFactory
{
    protected override IController GetControllerInstance(Type controllerType)
    {
        try
        {
            if (controllerType == null)
                return base.GetControllerInstance(controllerType);
        }
        catch (HttpException ex)
        {
            if (ex.GetHttpCode() == (int)HttpStatusCode.NotFound)
            {
                IController errorController = ObjectFactory.GetInstance<ErrorController>();
                ((ErrorController)errorController).InvokeHttp404(RequestContext.HttpContext);

                return errorController;
            }
            else
                throw ex;
        }

        return ObjectFactory.GetInstance(controllerType) as Controller;
    }
} 
```

*MVC2.0 示例：*

```
 protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType)
    {
        try
        {
            if (controllerType == null)
                return base.GetControllerInstance(requestContext, controllerType);
        }
        catch (HttpException ex)
        {
            if (ex.GetHttpCode() == 404)
            {
                IController errorController = ObjectFactory.GetInstance<ErrorController>();
                ((ErrorController)errorController).InvokeHttp404(requestContext.HttpContext);

                return errorController;
            }
            else
                throw ex;
        }

        return ObjectFactory.GetInstance(controllerType) as Controller;
    } 
```

我认为最好在更接近它们起源的地方捕获错误。这就是为什么我更喜欢上面的`Application_Error`处理程序。

这是捕捉 404 的第二个地方。

## 第 4 步：将 NotFound 路由添加到 Global.asax，以获取无法解析到您的应用程序中的 url

这条路线应该指向我们的`Http404`行动。请注意，`url`参数将是一个相对 url，因为路由引擎在这里剥离了域部分？这就是为什么我们在步骤 1 中有所有条件 url 逻辑。

```
 routes.MapRoute("NotFound", "{*url}", 
            new { controller = "Error", action = "Http404" }); 
```

这是在您不自己调用的 MVC 应用程序中捕获 404 的第三个也是最后一个位置。如果您没有在此处捕获不匹配的路由，那么 MVC 会将问题传递给 ASP.NET (Global.asax)，而在这种情况下您并不真正想要这样。

## 第 5 步：最后，当您的应用找不到内容时调用 404

就像将错误的 ID 提交给我的 Loans 控制器时一样（来自`MyController`）：

```
 //
    // GET: /Detail/ID

    public ActionResult Detail(int ID)
    {
        Loan loan = this._svc.GetLoans().WithID(ID);
        if (loan == null)
            return this.InvokeHttp404(HttpContext);
        else
            return View(loan);
    } 
```

如果所有这些都可以用更少的代码连接到更少的地方，那就太好了，但我认为这个解决方案更易于维护、更可测试且相当实用。

感谢您迄今为止的反馈。我很想得到更多。

**注意：这已从我的原始答案中进行了重大编辑，但目的/要求是相同的 - 这就是我没有添加新答案的原因**

* * *

## 回答 #3

> 赞同：241
> 
> 时间：2011-03-31T22:27:46.377

ASP.NET MVC 不能很好地支持自定义 404 页面。自定义控制器工厂，包罗万象的路线，带有`HandleUnknownAction`- 啊！

到目前为止，IIS 自定义错误页面是更好的选择：

# 网络配置

```
<system.webServer>
  <httpErrors errorMode="Custom" existingResponse="Replace">
    <remove statusCode="404" />
    <error statusCode="404" responseMode="ExecuteURL" path="/Error/PageNotFound" />
  </httpErrors>
</system.webServer> 
```

# 错误控制器

```
public class ErrorController : Controller
{
    public ActionResult PageNotFound()
    {
        Response.StatusCode = 404;
        return View();
    }
} 
```

# 示例项目

*   [GitHub 上的 Test404](https://github.com/chuchuva/Test404)
*   [直播网站](http://test-404.azurewebsites.net/)

* * *

## 回答 #4

> 赞同：154
> 
> 时间：2011-09-21T12:02:34.550

### 快速回答/TL;DR

![在此处输入图像描述](https://i.stack.imgur.com/Zl4jh.png)

对于那里的懒人：

```
Install-Package MagicalUnicornMvcErrorToolkit -Version 1.0 
```

然后从`global.asax`

```
GlobalFilters.Filters.Add(new HandleErrorAttribute()); 
```

*这仅适用于 IIS7+ 和 IIS Express。*

如果您使用的是卡西尼 .. 好吧 .. 嗯 .. 呃.. 尴尬 ... ![尴尬的](https://i.imgur.com/g1GTW3v.gif)

* * *

### 长，解释的答案

我知道这已经回答了。但答案真的很简单（为[David Fowler](https://stackoverflow.com/users/45091/dfowler)和[Damian Edwards](https://stackoverflow.com/users/405892/damian-edwards)真正回答这个问题而欢呼）。

没有*必要做任何定制的事情*。

因为`ASP.NET MVC3`，所有的点点滴滴都在那里。

### 第 1 步 -> 在两个位置更新您的 web.config。

```
<system.web>
    <customErrors mode="On" defaultRedirect="/ServerError">
      <error statusCode="404" redirect="/NotFound" />
    </customErrors> 
```

和

```
<system.webServer>
    <httpErrors errorMode="Custom">
      <remove statusCode="404" subStatusCode="-1" />
      <error statusCode="404" path="/NotFound" responseMode="ExecuteURL" />
      <remove statusCode="500" subStatusCode="-1" />
      <error statusCode="500" path="/ServerError" responseMode="ExecuteURL" />
    </httpErrors>    

...
<system.webServer>
...
</system.web> 
```

现在仔细记下我决定使用的路线。你可以使用任何东西，但我的路线是

*   `/NotFound`<- 对于 404 未找到，错误页面。
*   `/ServerError`<- 对于任何其他错误，请包括我的代码中发生的错误。这是 500 内部服务器错误

看看第一部分如何`<system.web>`只有*一个*自定义条目？入口`statusCode="404"`？我只列出了一个状态代码，因为所有其他错误，包括`500 Server Error`（即当您的代码有错误并使用户请求崩溃时发生的那些讨厌的错误）..所有其他错误都由设置处理`defaultRedirect="/ServerError"`..它说，如果你不是404页面没找到，那么请转到路由`/ServerError`。

行。那不碍事了..现在到我列出的路线`global.asax`

### 第 2 步 - 在 Global.asax 中创建路由

这是我的完整路线部分..

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
    routes.IgnoreRoute("{*favicon}", new {favicon = @"(.*/)?favicon.ico(/.*)?"});

    routes.MapRoute(
        "Error - 404",
        "NotFound",
        new { controller = "Error", action = "NotFound" }
        );

    routes.MapRoute(
        "Error - 500",
        "ServerError",
        new { controller = "Error", action = "ServerError"}
        );

    routes.MapRoute(
        "Default", // Route name
        "{controller}/{action}/{id}", // URL with parameters
        new {controller = "Home", action = "Index", id = UrlParameter.Optional}
        );
} 
```

这列出了两个忽略路由 ->`axd's`和`favicons`（哦！奖励忽略路由，给你！）然后（这里的顺序是必要的），我有我的两个明确的错误处理路由..后面是任何其他路由。在这种情况下，默认一个。当然，我还有更多，但这对我的网站来说是特别的。*只需确保错误路由位于列表顶部即可。秩序是势在必行*。

最后，当我们在`global.asax`文件中时，我们不会全局注册 HandleError 属性。不，不，不，先生。纳达。没有。念。消极的。呜呜呜……

从`global.asax`

```
GlobalFilters.Filters.Add(new HandleErrorAttribute()); 
```

### 第 3 步 - 使用操作方法创建控制器

现在..我们添加一个带有两个动作方法的控制器......

```
public class ErrorController : Controller
{
    public ActionResult NotFound()
    {
        Response.StatusCode = (int)HttpStatusCode.NotFound;
        return View();
    }

    public ActionResult ServerError()
    {
        Response.StatusCode = (int)HttpStatusCode.InternalServerError;

        // Todo: Pass the exception into the view model, which you can make.
        //       That's an exercise, dear reader, for -you-.
        //       In case u want to pass it to the view, if you're admin, etc.
        // if (User.IsAdmin) // <-- I just made that up :) U get the idea...
        // {
        //     var exception = Server.GetLastError();
        //     // etc..
        // }

        return View();
    }

    // Shhh .. secret test method .. ooOOooOooOOOooohhhhhhhh
    public ActionResult ThrowError()
    {
        throw new NotImplementedException("Pew ^ Pew");
    }
} 
```

好的，让我们看看这个。首先，这里*没有* `[HandleError]`属性。为什么？因为内置`ASP.NET`框架已经在处理错误，并且我们已经指定了处理错误所需要做的所有事情：）它在这个方法中！

接下来，我有两个动作方法。那里没什么难的。如果您希望显示任何异常信息，那么您可以使用`Server.GetLastError()`来获取该信息。

Bonus WTF：是的，我制作了第三种操作方法，以测试错误处理。

### 第 4 步 - 创建视图

最后，创建两个视图。将 em 放在此控制器的正常视图位置。

![在此处输入图像描述](https://i.stack.imgur.com/xsstR.png)

### 奖金评论

*   你不需要一个`Application_Error(object sender, EventArgs e)`
*   上述步骤都与[Elmah](http://nuget.org/List/Packages/elmah) 100% 完美配合。Elmah fraking wroxs！

我的朋友们，应该就是这样。

现在，恭喜您阅读了这么多内容并获得了独角兽作为奖品！

![在此处输入图像描述](https://i.stack.imgur.com/KluHP.jpg)

* * *

## 回答 #5

> 赞同：90
> 
> 时间：2012-01-26T23:20:26.790

我已经研究**了很多**关于如何在 MVC *（特别是 MVC3）*中正确管理 404 的问题，恕我直言，这是我想出的最佳解决方案：

在 global.asax 中：

```
public class MvcApplication : HttpApplication
{
    protected void Application_EndRequest()
    {
        if (Context.Response.StatusCode == 404)
        {
            Response.Clear();

            var rd = new RouteData();
            rd.DataTokens["area"] = "AreaName"; // In case controller is in another area
            rd.Values["controller"] = "Errors";
            rd.Values["action"] = "NotFound";

            IController c = new ErrorsController();
            c.Execute(new RequestContext(new HttpContextWrapper(Context), rd));
        }
    }
} 
```

错误控制器：

```
public sealed class ErrorsController : Controller
{
    public ActionResult NotFound()
    {
        ActionResult result;

        object model = Request.Url.PathAndQuery;

        if (!Request.IsAjaxRequest())
            result = View(model);
        else
            result = PartialView("_NotFound", model);

        return result;
    }
} 
```

*（选修的）*

**解释：**

AFAIK，ASP.NET MVC3 应用程序可以在 6 种不同的情况下生成 404。

*（由 ASP.NET Framework 自动生成：）*

**(1)** URL 在路由表中找不到匹配项。

*（由 ASP.NET MVC 框架自动生成：）*

**(2)** URL 在路由表中找到匹配项，但指定了一个不存在的控制器。

**(3)** URL 在路由表中找到匹配项，但指定了一个不存在的动作。

*（手动生成：）*

**(4)**动作通过使用HttpNotFound()方法返回一个HttpNotFoundResult。

**(5)**一个动作抛出一个状态码为 404 的 HttpException。

**(6)**一个动作手动将 Response.StatusCode 属性修改为 404。

**通常，您要完成 3 个目标：**

**(1)**向用户显示自定义的 404 错误页面。

**（2）**维护客户端响应上的404状态码（对SEO特别重要）。

**(3)**直接发送响应，不涉及302重定向。

**有多种方法可以尝试完成此操作：**

**(1)**

```
<system.web>
    <customErrors mode="On">
        <error statusCode="404" redirect="~/Errors/NotFound"/>
    </customError>
</system.web> 
```

*此解决方案的问题：*

1.  在情况 (1)、(4)、(6) 中不符合目标 (1)。
2.  不自动符合目标 (2)。它必须手动编程。
3.  不符合目标 (3)。

**(2)**

```
<system.webServer>
    <httpErrors errorMode="Custom">
        <remove statusCode="404"/>
        <error statusCode="404" path="App/Errors/NotFound" responseMode="ExecuteURL"/>
    </httpErrors>
</system.webServer> 
```

*此解决方案的问题：*

1.  仅适用于 IIS 7+。
2.  在情况 (2)、(3)、(5) 中不符合目标 (1)。
3.  不自动符合目标 (2)。它必须手动编程。

**(3)**

```
<system.webServer>
    <httpErrors errorMode="Custom" existingResponse="Replace">
        <remove statusCode="404"/>
        <error statusCode="404" path="App/Errors/NotFound" responseMode="ExecuteURL"/>
    </httpErrors>
</system.webServer> 
```

*此解决方案的问题：*

1.  仅适用于 IIS 7+。
2.  不自动符合目标 (2)。它必须手动编程。
3.  它掩盖了应用程序级别的 http 异常。例如，不能使用 customErrors 部分、System.Web.Mvc.HandleErrorAttribute 等。它不能只显示通用错误页面。

**(4)**

```
<system.web>
    <customErrors mode="On">
        <error statusCode="404" redirect="~/Errors/NotFound"/>
    </customError>
</system.web> 
```

和

```
<system.webServer>
    <httpErrors errorMode="Custom">
        <remove statusCode="404"/>
        <error statusCode="404" path="App/Errors/NotFound" responseMode="ExecuteURL"/>
    </httpErrors>
</system.webServer> 
```

*此解决方案的问题：*

1.  仅适用于 IIS 7+。
2.  不自动符合目标 (2)。它必须手动编程。
3.  在情况 (2)、(3)、(5) 中不符合目标 (3)。

之前对此感到困扰的人甚至尝试创建自己的库（参见[http://aboutcode.net/2011/02/26/handling-not-found-with-asp-net-mvc3.html](http://aboutcode.net/2011/02/26/handling-not-found-with-asp-net-mvc3.html)）。但是之前的解决方案似乎涵盖了所有情况，而没有使用外部库的复杂性。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2010-05-29T20:50:45.297

我真的很喜欢 cottsaks 解决方案，并认为它的解释非常清楚。我唯一的补充是按如下方式更改第 2 步

```
public abstract class MyController : Controller
{

    #region Http404 handling

    protected override void HandleUnknownAction(string actionName)
    {
        //if controller is ErrorController dont 'nest' exceptions
        if(this.GetType() != typeof(ErrorController))
        this.InvokeHttp404(HttpContext);
    }

    public ActionResult InvokeHttp404(HttpContextBase httpContext)
    {
        IController errorController = ObjectFactory.GetInstance<ErrorController>();
        var errorRoute = new RouteData();
        errorRoute.Values.Add("controller", "Error");
        errorRoute.Values.Add("action", "Http404");
        errorRoute.Values.Add("url", httpContext.Request.Url.OriginalString);
        errorController.Execute(new RequestContext(
             httpContext, errorRoute));

        return new EmptyResult();
    }

    #endregion
} 
```

基本上，这会阻止包含无效操作和控制器的 url 两次触发异常例程。例如对于诸如 asdfsdf/dfgdfgd 之类的 url

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2010-07-29T23:43:14.003

我可以让@cottsak 的方法为无效控制器工作的唯一方法是修改 CustomControllerFactory 中的现有路由请求，如下所示：

```
public class CustomControllerFactory : DefaultControllerFactory
{
    protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType)
    {
        try
        {
            if (controllerType == null)
                return base.GetControllerInstance(requestContext, controllerType); 
            else
                return ObjectFactory.GetInstance(controllerType) as Controller;
        }
        catch (HttpException ex)
        {
            if (ex.GetHttpCode() == (int)HttpStatusCode.NotFound)
            {
                requestContext.RouteData.Values["controller"] = "Error";
                requestContext.RouteData.Values["action"] = "Http404";
                requestContext.RouteData.Values.Add("url", requestContext.HttpContext.Request.Url.OriginalString);

                return ObjectFactory.GetInstance<ErrorController>();
            }
            else
                throw ex;
        }
    }
} 
```

我应该提到我正在使用 MVC 2.0。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2011-11-01T14:11:52.403

这是使用 MVC 工具的另一种方法，您可以处理对错误控制器名称、错误路由名称以及您认为适合 Action 方法内部的任何其他条件的请求。就个人而言，我更喜欢尽可能避免使用 web.config 设置，因为它们会执行 302 / 200 重定向并且不支持`Server.Transfer`使用 Razor 视图的 ResponseRewrite ( )。出于搜索引擎优化的原因，我更愿意返回带有自定义错误页面的 404。

其中一些是对上述cottsak技术的新看法。

此解决方案还使用有利于 MVC 3 错误过滤器的最小 web.config 设置。

### 用法

只需从操作或自定义 ActionFilterAttribute 中抛出 HttpException。

```
Throw New HttpException(HttpStatusCode.NotFound, "[Custom Exception Message Here]") 
```

### 第1步

将以下设置添加到您的 web.config。这是使用 MVC 的 HandleErrorAttribute 所必需的。

```
<customErrors mode="On" redirectMode="ResponseRedirect" /> 
```

### 第2步

添加类似于 MVC 框架的 HandleErrorAttribute 的自定义 HandleHttpErrorAttribute，除了 HTTP 错误：

```
<AttributeUsage(AttributeTargets.All, AllowMultiple:=True)>
Public Class HandleHttpErrorAttribute
    Inherits FilterAttribute
    Implements IExceptionFilter

    Private Const m_DefaultViewFormat As String = "ErrorHttp{0}"

    Private m_HttpCode As HttpStatusCode
    Private m_Master As String
    Private m_View As String

    Public Property HttpCode As HttpStatusCode
        Get
            If m_HttpCode = 0 Then
                Return HttpStatusCode.NotFound
            End If
            Return m_HttpCode
        End Get
        Set(value As HttpStatusCode)
            m_HttpCode = value
        End Set
    End Property

    Public Property Master As String
        Get
            Return If(m_Master, String.Empty)
        End Get
        Set(value As String)
            m_Master = value
        End Set
    End Property

    Public Property View As String
        Get
            If String.IsNullOrEmpty(m_View) Then
                Return String.Format(m_DefaultViewFormat, Me.HttpCode)
            End If
            Return m_View
        End Get
        Set(value As String)
            m_View = value
        End Set
    End Property

    Public Sub OnException(filterContext As System.Web.Mvc.ExceptionContext) Implements System.Web.Mvc.IExceptionFilter.OnException
        If filterContext Is Nothing Then Throw New ArgumentException("filterContext")

        If filterContext.IsChildAction Then
            Return
        End If

        If filterContext.ExceptionHandled OrElse Not filterContext.HttpContext.IsCustomErrorEnabled Then
            Return
        End If

        Dim ex As HttpException = TryCast(filterContext.Exception, HttpException)
        If ex Is Nothing OrElse ex.GetHttpCode = HttpStatusCode.InternalServerError Then
            Return
        End If

        If ex.GetHttpCode <> Me.HttpCode Then
            Return
        End If

        Dim controllerName As String = filterContext.RouteData.Values("controller")
        Dim actionName As String = filterContext.RouteData.Values("action")
        Dim model As New HandleErrorInfo(filterContext.Exception, controllerName, actionName)

        filterContext.Result = New ViewResult With {
            .ViewName = Me.View,
            .MasterName = Me.Master,
            .ViewData = New ViewDataDictionary(Of HandleErrorInfo)(model),
            .TempData = filterContext.Controller.TempData
        }
        filterContext.ExceptionHandled = True
        filterContext.HttpContext.Response.Clear()
        filterContext.HttpContext.Response.StatusCode = Me.HttpCode
        filterContext.HttpContext.Response.TrySkipIisCustomErrors = True
    End Sub
End Class 
```

### 第 3 步

将过滤器添加`GlobalFilters.Filters`到`Global.asax`. 此示例将所有 InternalServerError (500) 错误路由到错误共享视图 ( `Views/Shared/Error.vbhtml`)。NotFound (404) 错误也将发送到共享视图中的 ErrorHttp404.vbhtml。我在此处添加了一个 401 错误，以向您展示如何扩展它以获取其他 HTTP 错误代码。请注意，这些必须是共享视图，并且它们都使用`System.Web.Mvc.HandleErrorInfo`对象作为模型。

```
filters.Add(New HandleHttpErrorAttribute With {.View = "ErrorHttp401", .HttpCode = HttpStatusCode.Unauthorized})
filters.Add(New HandleHttpErrorAttribute With {.View = "ErrorHttp404", .HttpCode = HttpStatusCode.NotFound})
filters.Add(New HandleErrorAttribute With {.View = "Error"}) 
```

### 第4步

创建一个基本控制器类并在您的控制器中从它继承。此步骤允许我们处理未知的操作名称并将 HTTP 404 错误引发到我们的 HandleHttpErrorAttribute。

```
Public Class BaseController
    Inherits System.Web.Mvc.Controller

    Protected Overrides Sub HandleUnknownAction(actionName As String)
        Me.ActionInvoker.InvokeAction(Me.ControllerContext, "Unknown")
    End Sub

    Public Function Unknown() As ActionResult
        Throw New HttpException(HttpStatusCode.NotFound, "The specified controller or action does not exist.")
        Return New EmptyResult
    End Function
End Class 
```

### 第 5 步

创建一个 ControllerFactory 覆盖，并在 Application_Start 的 Global.asax 文件中覆盖它。此步骤允许我们在指定无效控制器名称时引发 HTTP 404 异常。

```
Public Class MyControllerFactory
    Inherits DefaultControllerFactory

    Protected Overrides Function GetControllerInstance(requestContext As System.Web.Routing.RequestContext, controllerType As System.Type) As System.Web.Mvc.IController
        Try
            Return MyBase.GetControllerInstance(requestContext, controllerType)
        Catch ex As HttpException
            Return DependencyResolver.Current.GetService(Of BaseController)()
        End Try
    End Function
End Class

'In Global.asax.vb Application_Start:

controllerBuilder.Current.SetControllerFactory(New MyControllerFactory) 
```

### 第 6 步

在您的 RoutTable.Routes 中为 BaseController Unknown 操作包含一个特殊路由。这将帮助我们在用户访问未知控制器或未知操作的情况下引发 404。

```
'BaseController
routes.MapRoute( _
    "Unknown", "BaseController/{action}/{id}", _
    New With {.controller = "BaseController", .action = "Unknown", .id = UrlParameter.Optional} _
) 
```

### 概括

此示例演示了如何使用 MVC 框架向浏览器返回 404 Http 错误代码，而无需使用过滤器属性和共享错误视图进行重定向。它还演示了在指定无效控制器名称和操作名称时显示相同的自定义错误页面。

如果我获得足够的票数来发布一个 =)，我将添加无效控制器名称、操作名称和从 Home/TriggerNotFound 操作引发的自定义 404 的屏幕截图 =)。当我使用此解决方案访问以下 URL 时，Fiddler 返回 404 消息：

```
/InvalidController
/Home/InvalidRoute
/InvalidController/InvalidRoute
/Home/TriggerNotFound 
```

上面cottsak 的帖子和这些文章都是很好的参考。

*   [使用 CustomErrors redirectMode=ResponseRewrite 的问题](https://softwareengineering.stackexchange.com/questions/45195/what-are-the-definitive-guidelines-for-custom-error-handling-in-asp-net-mvc-3)
*   [Elmah + MVC HandleErrorAttribute](http://thecodersperspective.posterous.com/how-to-get-elmah-and-mvc3-error-handling-to-p)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-05-23T13:09:51.227

我的简化解决方案适用于未处理的区域、控制器和操作：

1.  创建一个视图 404.cshtml。

2.  为您的控制器创建一个基类：

    ```
    public class Controller : System.Web.Mvc.Controller
    {
        protected override void HandleUnknownAction(string actionName)
        {
            Http404().ExecuteResult(ControllerContext);
        }

        protected virtual ViewResult Http404()
        {
            Response.StatusCode = (int)HttpStatusCode.NotFound;
            return View("404");
        }
    } 
    ```

3.  创建一个自定义控制器工厂，返回您的基本控制器作为后备：

    ```
    public class ControllerFactory : DefaultControllerFactory
    {
        protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType)
        {
            if (controllerType != null)
                return base.GetControllerInstance(requestContext, controllerType);

            return new Controller();
        }
    } 
    ```

4.  添加到`Application_Start()`以下行：

    ```
    ControllerBuilder.Current.SetControllerFactory(typeof(ControllerFactory)); 
    ```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-05-08T12:59:48.147

在 MVC4 WebAPI 404 中可以通过以下方式处理，

课程API控制器

```
 // GET /api/courses/5
    public HttpResponseMessage<Courses> Get(int id)
    {
        HttpResponseMessage<Courses> resp = null;

        var aCourse = _courses.Where(c => c.Id == id).FirstOrDefault();

        resp = aCourse == null ? new HttpResponseMessage<Courses>(System.Net.HttpStatusCode.NotFound) : new HttpResponseMessage<Courses>(aCourse);

        return resp;
    } 
```

家庭控制器

```
public ActionResult Course(int id)
{
    return View(id);
} 
```

看法

```
<div id="course"></div>
<script type="text/javascript">
    var id = @Model;
    var course = $('#course');
    $.ajax({    
        url: '/api/courses/' + id,
        success: function (data) {
            course.text(data.Name);
        },
        statusCode: {
            404: function() 
            {
                course.text('Course not available!');    
            }
        }
    });
</script> 
```

全球的

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    routes.MapHttpRoute(
        name: "DefaultApi",
        routeTemplate: "api/{controller}/{id}",
        defaults: new { id = RouteParameter.Optional }
    );

    routes.MapRoute(
        name: "Default",
        url: "{controller}/{action}/{id}",
        defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
    );
} 
```

结果

![在此处输入图像描述](https://i.stack.imgur.com/wSCpB.png)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-08-31T04:19:51.367

处理 ASP.NET MVC 中的错误只是一件麻烦事。我在此页面以及其他问题和网站上尝试了很多建议，但没有任何效果。*一个建议是在system.webserver*内处理*web.config*上的错误，但这只是**返回空白页**。

 ***我提出这个解决方案时的目标是；

*   **不重定向**
*   **返回 PROPER STATUS CODES 不是 200/Ok 像默认错误处理**

这是我的解决方案。

**1** .将以下内容添加到*system.web*部分

```
 <system.web>
     <customErrors mode="On" redirectMode="ResponseRewrite">
      <error statusCode="404"  redirect="~/Error/404.aspx" />
      <error statusCode="500" redirect="~/Error/500.aspx" />
     </customErrors>
    <system.web> 
```

上面处理了所有未由*routes.config*处理的 url和未处理的异常，尤其是在视图中遇到的异常。请注意，我使用的是*aspx*而不是*html*。这样我就可以在后面的代码上添加*响应代码。*

**2** . 在项目的根目录下创建一个名为*Error*（或任何您喜欢的文件夹）的文件夹，然后添加两个 Web 表单。下面是我的 404 页面；

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="404.aspx.cs" Inherits="Myapp.Error._404" %>

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title >Page Not found</title>
    <link href="<%=ResolveUrl("~/Content/myapp.css")%>" rel="stylesheet" />
</head>
<body>
    <div class="top-nav">
      <a runat="server" class="company-logo" href="~/"></a>
    </div>
    <div>
        <h1>404 - Page Not found</h1>
        <p>The page you are looking for cannot be found.</p>
        <hr />
        <footer></footer>
    </div>
</body>
</html> 
```

在后面的代码上我设置了响应代码

```
protected void Page_Load(object sender, EventArgs e)
{
    Response.StatusCode = 404;
} 
```

对 500 页执行相同操作

**3** .处理控制器内的错误。有很多方法可以做到这一点。这对我有用。我所有的控制器都继承自一个基本控制器。在基本控制器中，我有以下方法

```
protected ActionResult ShowNotFound()
{
    return ShowNotFound("Page not found....");
}

protected ActionResult ShowNotFound(string message)
{
    return ShowCustomError(HttpStatusCode.NotFound, message);
}

protected ActionResult ShowServerError()
{
    return ShowServerError("Application error....");
}

protected ActionResult ShowServerError(string message)
{
    return ShowCustomError(HttpStatusCode.InternalServerError, message);
}

protected ActionResult ShowNotAuthorized()
{
    return ShowNotAuthorized("You are not allowed ....");

}

protected ActionResult ShowNotAuthorized(string message)
{
    return ShowCustomError(HttpStatusCode.Forbidden, message);
}

protected ActionResult ShowCustomError(HttpStatusCode statusCode, string message)
{
    Response.StatusCode = (int)statusCode;
    string title = "";
    switch (statusCode)
    {
        case HttpStatusCode.NotFound:
            title = "404 - Not found";
            break;
        case HttpStatusCode.Forbidden:
            title = "403 - Access Denied";
            break;
        default:
            title = "500 - Application Error";
            break;
    }
    ViewBag.Title = title;
    ViewBag.Message = message;
    return View("CustomError");
} 
```

**4** .将 CustomError.cshtml 添加到您的*共享*视图文件夹中。下面是我的；

```
<h1>@ViewBag.Title</h1>
<br />
<p>@ViewBag.Message</p> 
```

现在在您的应用程序控制器中，您可以执行以下操作；

```
public class WidgetsController : ControllerBase
{
  [HttpGet]
  public ActionResult Edit(int id)
  {
    Try
    {
       var widget = db.getWidgetById(id);
       if(widget == null)
          return ShowNotFound();
          //or return ShowNotFound("Invalid widget!");
       return View(widget);
    }
    catch(Exception ex)
    {
       //log error
       logger.Error(ex)
       return ShowServerError();
    }
  }
} 
```

现在**警告**一下。它不会处理静态文件错误。因此，如果您有诸如*example.com/widgets*之类的路由并且用户将其更改为*example.com/widgets.html*，他们将获得 IIS 默认错误页面，因此您必须以其他方式处理 IIS 级别错误。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-07-09T14:06:53.140

在 nuget 上尝试 NotFoundMVC。它可以工作，无需设置。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-10-01T10:31:13.600

我的解决方案，以防有人发现它有用。

在 Web.config 中：

```
<system.web>
    <customErrors mode="On" defaultRedirect="Error" >
      <error statusCode="404" redirect="~/Error/PageNotFound"/>
    </customErrors>
    ...
</system.web> 
```

在`Controllers/ErrorController.cs`：

```
public class ErrorController : Controller
{
    public ActionResult PageNotFound()
    {
        if(Request.IsAjaxRequest()) {
            Response.StatusCode = (int)HttpStatusCode.NotFound;
            return Content("Not Found", "text/plain");
        }

        return View();
    }
} 
```

`PageNotFound.cshtml`在文件夹中添加一个`Shared`，就是这样。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2015-03-31T09:37:27.643

在我看来，标准`CustomErrors`配置**应该可以正常工作**，因为依赖`Server.Transfer`它的内部实现似乎`ResponseRewrite`与 MVC 不兼容。

这对我来说就像一个明显的功能漏洞，所以我决定使用 HTTP 模块重新实现这个功能。下面的解决方案允许您通过重定向到任何有效的 MVC 路由来处理任何 HTTP 状态代码（包括 404），就像您通常所做的那样。

```
<customErrors mode="RemoteOnly" redirectMode="ResponseRewrite">
    <error statusCode="404" redirect="404.aspx" />
    <error statusCode="500" redirect="~/MVCErrorPage" />
</customErrors> 
```

这已经在以下平台上进行了测试；

*   集成管道模式下的 MVC4 (IIS Express 8)
*   经典模式下的 MVC4（VS 开发服务器，Cassini）
*   经典模式下的 MVC4 (IIS6)

**好处**

*   可以放入任何 MVC 项目的通用解决方案
*   启用对传统自定义错误配置的支持
*   适用于集成管道和经典模式

* * *

**解决方案**

```
namespace Foo.Bar.Modules {

    /// <summary>
    /// Enables support for CustomErrors ResponseRewrite mode in MVC.
    /// </summary>
    public class ErrorHandler : IHttpModule {

        private HttpContext HttpContext { get { return HttpContext.Current; } }
        private CustomErrorsSection CustomErrors { get; set; }

        public void Init(HttpApplication application) {
            System.Configuration.Configuration configuration = WebConfigurationManager.OpenWebConfiguration("~");
            CustomErrors = (CustomErrorsSection)configuration.GetSection("system.web/customErrors");

            application.EndRequest += Application_EndRequest;
        }

        protected void Application_EndRequest(object sender, EventArgs e) {

            // only handle rewrite mode, ignore redirect configuration (if it ain't broke don't re-implement it)
            if (CustomErrors.RedirectMode == CustomErrorsRedirectMode.ResponseRewrite && HttpContext.IsCustomErrorEnabled) {

                int statusCode = HttpContext.Response.StatusCode;

                // if this request has thrown an exception then find the real status code
                Exception exception = HttpContext.Error;
                if (exception != null) {
                    // set default error status code for application exceptions
                    statusCode = (int)HttpStatusCode.InternalServerError;
                }

                HttpException httpException = exception as HttpException;
                if (httpException != null) {
                    statusCode = httpException.GetHttpCode();
                }

                if ((HttpStatusCode)statusCode != HttpStatusCode.OK) {

                    Dictionary<int, string> errorPaths = new Dictionary<int, string>();

                    foreach (CustomError error in CustomErrors.Errors) {
                        errorPaths.Add(error.StatusCode, error.Redirect);
                    }

                    // find a custom error path for this status code
                    if (errorPaths.Keys.Contains(statusCode)) {
                        string url = errorPaths[statusCode];

                        // avoid circular redirects
                        if (!HttpContext.Request.Url.AbsolutePath.Equals(VirtualPathUtility.ToAbsolute(url))) {

                            HttpContext.Response.Clear();
                            HttpContext.Response.TrySkipIisCustomErrors = true;

                            HttpContext.Server.ClearError();

                            // do the redirect here
                            if (HttpRuntime.UsingIntegratedPipeline) {
                                HttpContext.Server.TransferRequest(url, true);
                            }
                            else {
                                HttpContext.RewritePath(url, false);

                                IHttpHandler httpHandler = new MvcHttpHandler();
                                httpHandler.ProcessRequest(HttpContext);
                            }

                            // return the original status code to the client
                            // (this won't work in integrated pipleline mode)
                            HttpContext.Response.StatusCode = statusCode;

                        }
                    }

                }

            }

        }

        public void Dispose() {

        }

    }

} 
```

**用法**

将此作为最终 HTTP 模块包含在您的 web.config 中

```
 <system.web>
    <httpModules>
      <add name="ErrorHandler" type="Foo.Bar.Modules.ErrorHandler" />
    </httpModules>
  </system.web>

  <!-- IIS7+ -->
  <system.webServer>
    <modules>
      <add name="ErrorHandler" type="Foo.Bar.Modules.ErrorHandler" />
    </modules>
  </system.webServer> 
```

* * *

对于那些关注的人，您会注意到在集成管道模式下，由于其`Server.TransferRequest`工作方式，它将始终以 HTTP 200 响应。要返回正确的错误代码，我使用以下错误控制器。

```
public class ErrorController : Controller {

    public ErrorController() { }

    public ActionResult Index(int id) {
        // pass real error code to client
        HttpContext.Response.StatusCode = id;
        HttpContext.Response.TrySkipIisCustomErrors = true;

        return View("Errors/" + id.ToString());
    }

} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-01-14T14:36:47.353

由于我的评论太长，因此发布答案...

这是对独角兽帖子/答案的评论和问题：

[https://stackoverflow.com/a/7499406/687549](https://stackoverflow.com/a/7499406/687549)

我更喜欢这个答案而不是其他答案，因为它很简单，而且显然咨询了微软的一些人。然而，我收到了三个问题，如果可以回答，那么我将把这个答案称为 ASP.NET MVC (x) 应用程序的互联网上所有 404/500 错误答案的圣杯。

@Pure.Krome

1.  您能否使用 GWB 指出的评论中的 SEO 内容更新您的答案（您的答案中从未提及这一点） -`<customErrors mode="On" redirectMode="ResponseRewrite">`并且`<httpErrors errorMode="Custom" existingResponse="Replace">`？

2.  您能否询问您的 ASP.NET 团队朋友是否可以这样做 - 很高兴得到一些确认 - 也许这是一个很大的禁忌`redirectMode`，`existingResponse`以这种方式能够很好地与 SEO 一起玩？！

3.  `customErrors redirectMode="ResponseRewrite"`在与您在 Microsoft 的朋友交谈后，您能否对所有这些内容（如某人建议的完全删除）`customErrors redirectMode="ResponseRedirect"`添加`httpErrors errorMode="Custom" existingResponse="Replace"`一些说明？`customErrors`

正如我所说; 如果我们能让您的答案更完整，那就太好了，因为这似乎是一个相当受欢迎的问题，有 54 000 多个浏览量。

**更新**：独角兽的答案是 302 Found 和 200 OK 并且不能更改为仅使用路线返回 404。它必须是一个不是 MVC:ish 的物理文件。所以转向另一个解决方案。太糟糕了，因为到目前为止这似乎是最终的 MVC:ish 答案。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-02-03T02:45:09.097

添加我的解决方案，这与 Herman Kan 的几乎相同，但有一点小皱纹，以使其适用于我的项目。

创建自定义错误控制器：

```
public class Error404Controller : BaseController
{
    [HttpGet]
    public ActionResult PageNotFound()
    {
        Response.StatusCode = 404;
        return View("404");
    }
} 
```

然后创建一个自定义控制器工厂：

```
public class CustomControllerFactory : DefaultControllerFactory
{
    protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType)
    {
        return controllerType == null ? new Error404Controller() : base.GetControllerInstance(requestContext, controllerType);
    }
} 
```

最后，为自定义错误控制器添加一个覆盖：

```
protected override void HandleUnknownAction(string actionName)
{
    var errorRoute = new RouteData();
    errorRoute.Values.Add("controller", "Error404");
    errorRoute.Values.Add("action", "PageNotFound");
    new Error404Controller().Execute(new RequestContext(HttpContext, errorRoute));
} 
```

就是这样。无需更改 Web.config。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-02-20T13:21:06.663

1）制作抽象Controller类。

```
public abstract class MyController:Controller
{
    public ActionResult NotFound()
    {
        Response.StatusCode = 404;
        return View("NotFound");
    }

    protected override void HandleUnknownAction(string actionName)
    {
        this.ActionInvoker.InvokeAction(this.ControllerContext, "NotFound");
    }
    protected override void OnAuthorization(AuthorizationContext filterContext) { }
} 
```

2）在所有控制器中从这个抽象类继承

```
public class HomeController : MyController
{} 
```

3) 并在您的 View-Shared 文件夹中添加一个名为“NotFound”的视图。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-04-27T10:26:38.710

我浏览了该线程上发布的大多数解决方案。虽然这个问题可能很老，但即使现在它仍然非常适用于新项目，所以我花了很多时间阅读这里以及其他地方提供的答案。

正如@Marco 指出可能发生 404 的不同情况，我对照该列表检查了我一起编译的解决方案。除了他的要求清单外，我还添加了一项。

*   该解决方案应该能够以最合适的方式处理 MVC 以及 AJAX/WebAPI 调用。（即如果 404 发生在 MVC 中，它应该显示 Not Found 页面，如果 404 发生在 WebAPI 中，它不应该劫持 XML/JSON 响应，以便消费 Javascript 可以轻松解析它）。

* * *

**这个解决方案是 2 折：**

它的第一部分来自[https://stackoverflow.com/a/27354140/2310818](https://stackoverflow.com/a/27354140/2310818)上的 @Guillaume 。他们的解决方案负责处理由于无效路由、无效控制器和无效操作而导致的任何 404。

这个想法是创建一个 WebForm，然后让它调用 MVC 错误控制器的 NotFound 操作。它在没有任何重定向的情况下完成所有这些操作，因此您不会在 Fiddler 中看到单个 302。原始 URL 也被保留，这使得这个解决方案非常棒！

* * *

第二部分来自[https://stackoverflow.com/a/5536676/2310818](https://stackoverflow.com/a/5536676/2310818)上的@Germán 。他们的解决方案以 HttpNotFoundResult() 或 throw new HttpException() 的形式处理您的操作返回的任何 404！

这个想法是过滤器查看响应以及 MVC 控制器抛出的异常，并在错误控制器中调用适当的操作。同样，此解决方案无需任何重定向即可工作，并且保留了原始 url！

* * *

如您所见，这两种解决方案共同提供了一个非常强大的错误处理机制，它们满足了@Marco 列出的所有要求以及我的要求。如果您想查看此解决方案的工作示例或演示，请在评论中留下，我很乐意将它们放在一起。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-07-30T06:23:55.247

我浏览了所有文章，但对我没有任何帮助：我的要求用户在您的 url 自定义 404 页面中输入任何内容。我认为这很简单。但是您应该正确理解 404 的处理：

```
 <system.web>
    <customErrors mode="On" redirectMode="ResponseRewrite">
      <error statusCode="404" redirect="~/PageNotFound.aspx"/>
    </customErrors>
  </system.web>
<system.webServer>
    <httpErrors errorMode="Custom">
      <remove statusCode="404"/>
      <error statusCode="404" path="/PageNotFound.html" responseMode="ExecuteURL"/>
    </httpErrors>
</system.webServer> 
```

我发现这篇文章很有帮助。应该立即阅读。[客户错误页面-Ben Foster](http://benfoster.io/blog/aspnet-mvc-custom-error-pages)

# profiling - 什么是剖析？

> ID：619898
> 
> 赞同：8
> 
> 时间：2009-03-06T18:22:04.847
> 
> 标签：profiling

我是新手，正在努力学习。

*   什么是剖析？
*   分析 .NET、Java EE 的各种免​​费工具有哪些？
*   可以分析 Javascript 吗？
*   如果是这样，通过什么工具？
*   最后，这些分析器是如何工作的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-06T18:24:10.147

分析测量代码的各个部分需要多长时间才能运行。可以使用 firebug 分析 Javascript：http: [//getfirebug.com/js.html](http://getfirebug.com/js.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-06T18:23:26.667

[分析](http://en.wikipedia.org/wiki/Performance_analysis)是测量执行时间并将其与各种类/方法/函数相关联。（有关分析器如何工作的一些评论，请参阅我提供给维基百科页面的链接）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-06T18:40:31.620

将分析器视为执行持续时间错误的调试器。

Profiler 的实现方式也很像调试器，除了让您停止程序并四处寻找之外，它们只是让它运行并跟踪程序的每个部分花费了多少时间。如果您有一些运行速度比您需要的慢的代码，这将特别有用，因为您可以准确地找出所有时间的去向，并集中精力解决该瓶颈。

许多开发人员认为，您*永远不*应该在不使用分析器的情况下手动优化代码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-06T18:31:05.027

您通常使用分析器的方式如下：

1.  启动探查器，使用探查器启动您的应用程序。
2.  使用您的应用程序一段时间，或者只使用您已确定为瓶颈并希望优化的应用程序中的功能。
3.  一旦您的应用程序关闭（有时甚至在此之前），分析器可以向您显示每个函数的执行时间细分。有些还允许您在这些函数之一中获得每行或函数的执行时间细分，以便您可以使用自上而下的方法查看 cpu 大部分时间在哪里用完。
4.  通常，应用程序中的某些功能需要非常长的时间才能执行。查看分析结果后，您应该能够识别它们并消除性能问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-06T18:52:02.607

这里有一些 .NET 分析器供您试用（免费）：

*   [利润](http://dotnet.jku.at/projects/Prof-It/)
*   [教授](http://nprof.sourceforge.net/Site/Description.html)
*   [CLR 探查器](http://msdn.microsoft.com/en-us/library/ms979205.aspx)

我不是这些的忠实粉丝。我会推荐其中一种商业产品以获得最佳效果：

*   [点跟踪](http://www.jetbrains.com/profiler/)
*   [蚂蚁](http://www.red-gate.com/products/ants_profiler/index.htm)

除此之外，请查看 Brad Adams 博客文章[Profilers for the CLR](http://blogs.msdn.com/brada/archive/2005/03/17/398060.aspx)和[.NET Application Profiler](http://blogs.msdn.com/brada/archive/2003/05/07/50041.aspx)。

我个人喜欢[dotTrace](http://www.jetbrains.com/profiler/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-07T22:21:50.283

分析是一种测量执行时间和过程调用次数的技术。

然而，它不是唯一甚至不一定是最好的方法来定位导致时间浪费在代码中的事物。[看这里。](https://stackoverflow.com/questions/566014/why-does-my-c-code-run-slow/567926#567926)

* * *

对于不同的 Wikipedia 文章，请尝试[http://en.wikipedia.org/wiki/Performance_tuning#Bottlenecks](http://en.wikipedia.org/wiki/Performance_tuning#Bottlenecks)

有关简单的操作方法，请尝试[http://www.wikihow.com/Optimize-Your-Program%27s-Performance](http://www.wikihow.com/Optimize-Your-Program%27s-Performance)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-07T18:39:14.033

**维基百科**说：

> *在软件工程中，性能分析，今天更常称为分析，是使用程序执行时收集的信息来调查程序的行为*

**在此处继续阅读** [http://en.wikipedia.org/wiki/Performance_analysis](http://en.wikipedia.org/wiki/Performance_analysis)。

因此，关于 javascript 工具**Firebug** ( [http://getfirebug.com/index.html#install](http://getfirebug.com/index.html#install) ) 是一个很好的选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-29T02:59:47.997

分析是在方法级别（功能统计）以及运行时级别信息收集（例如内存消耗、处理器、线程和应用程序在一段时间内加载的类数（非功能统计））的测量在跑。它属于由一位用户运行的相关应用程序的性能分析（功能和非功能统计信息收集）。JConsole 是用于分析 Java 应用程序的内置工具之一。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-05T04:39:54.110

分析或编程配置文件是对程序进行动态分析的技术，它使用诸如内存空间或程序的时间复杂性、特定指令的使用或频率以及函数调用的持续时间等资源，仅举几例案例。通常，分析信息用于帮助程序优化，更具体地说，用于性能工程。分析是通过检测程序的源代码来完成的。分析器采用不同的方法，例如基于事件的、统计的、仪器化的和模拟方法

# oop - 确定班级责任和合作者

> ID：619900
> 
> 赞同：1
> 
> 时间：2009-03-06T18:23:22.673
> 
> 标签：oop, single-responsibility-principle

我正在使用 ActiveRecord 来维护有关用户的信息。User 类具有预期的 load()、insert()、update() 和 delete() 方法、setter、getter 和其他一些方法。但是我无法决定是否应该将某些其他方法包含在 User 类中，或者由协作者处理。

这是一个例子：

用户可能会请求一些需要确认的交易。这是以传统方式处理的——向用户发送带有链接的电子邮件；点击链接确认用户确实希望交易继续进行。验证密钥的哈希值及其到期日期/时间作为用户记录的一部分保留。

在这个过程中我应该在哪里划清界限？是否应该有一个协作者来处理验证（例如，通过从查询字符串中获取纯文本验证密钥并接受用户对象作为参数）？还是应该由 User 类在内部处理（在方法调用中传递纯文本验证密钥）？

当然，验证后会发生的下一件事是事务将继续进行，需要更新活动记录——在我看来，用户类必须负责。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T18:53:50.200

您应该将此任务委托给管理`confirmations`表的协作者。

您将使用该`Confirmation`模型来跟踪所有确认要求。该模型将属于`User`，并管理确认哈希和要确认的动作（例如`activate_account`，`change_password`或`change_email`等）。

控制器将`Confirmation`负责验证确认哈希并将适当的操作链接到适当的模型（例如`activate_account`-> `user.activate()`，`change_password`->`user.setPassword()`等），并在成功完成后`Confirmation`从表中删除。`confirmations`

这将允许更好地分离逻辑，并允许您更好地扩展，例如，为给定用户提供多个待确认的确认（例如确认更改密码*和*确认更改其他内容。）

# delphi - Delphi 2009 和复制内存

> ID：619902
> 
> 赞同：2
> 
> 时间：2009-03-06T18:24:05.183
> 
> 标签：delphi, memory, delphi-2009

我在 Delphi 2009 上测试[DelphiModbus 库](http://sourceforge.net/projects/delphimodbus)并没有得到我想要的结果。我认为问题在于 IdModbusClient.pas 上的以下行：

```
Move(Buffer, ReceiveBuffer, iSize); 
```

看起来 ReceiveBuffer 被设置为一些垃圾。

缓冲区定义为 TIdBytes（来自 Indy 组件）

ReceiveBuffer 定义为 TCommsBuffer：

```
 TModBusFunction = Byte;

  TModBusDataBuffer = array[0..256] of Byte;

  TCommsBuffer = packed record
    TransactionID: Word;
    ProtocolID: Word;
    RecLength: Word;
    UnitID: Byte;
    FunctionCode: TModBusFunction;
    MBPData: TModBusDataBuffer;
    Spare: Byte;
  end; { TCommsBuffer } 
```

iSize 当然是以字节为单位的缓冲区大小。

我想知道这是否与unicode转换有关？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-07T18:02:47.880

Indy 的`TIdBytes`类型是一个动态数组，定义在*IdGlobal.pas*中：

```
type
  TIdBytes = array of Byte; 
```

您不能将该类型的变量直接传递给`Move`并期望它工作，因为它只会复制存储在该变量中的四字节*引用。*（如果您告诉它复制超过四个字节，那么它将继续复制该变量之后驻留在内存中的任何其他内容 - 谁知道。）鉴于这些声明：

```
var
  Buffer: TIdBytes;
  ReceiveBuffer: TCommsBuffer; 
```

调用`Move`这些变量的方法是这样的：

```
if Length(Buffer) > 0 then
  Move(Buffer[0], ReceiveBuffer, iSize); 
```

它的工作原理是这样的，因为`Move`的参数是[*无类型*](http://www.cs.wisc.edu/~rkennedy/untyped)的，所以您需要传递要复制的*值，而不是指针或对该值的引用。*编译器自己处理引用。

代码有点奇怪，因为*看起来*你只是从 中复制一个字节`Buffer`，但不要让它太困扰你。这是一个德尔福成语；这就是它的工作方式。

此外，这与 Delphi 2009 无关；自从 Delphi 4 引入动态数组以来，它就一直以这种方式工作。并且`Move`一直如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T18:42:11.520

~~在我看来，您缺少几个指针取消引用，因此破坏了内存地址。~~

如果我没记错的话， Move() 调用应该是：

~~`Move(Buffer^, ReceiveBuffer^, iSize);`~~

 `I've removed my totally worthless post content (leaving it for posterity and to give someone a good laugh).

I don't see anything that would be affected by Unicode at all. I'm going to edit the tags to include Delphi (without the 2009), as some of the CodeGear Delphi developers are currently posting there. Perhaps one of them can see what's happening.

I made up a contrived example (actually a pretty useless one):` 

```
uses
  IdGlobal;

type
  TModBusFunction = Byte;
  TModBusDataBuffer = array[0..256] of Byte;

  TCommsBuffer=packed record
    TransactionID: Word;
    ProtocolID: Word;
    RecLength: Word;
    UnitID: Byte;
    FunctionCode: TModBusFunction;
    MBPData: TModBusDataBuffer;
    Spare: Byte;
  end;

procedure TForm1.FormShow(Sender: TObject);
var
  Buffer: TIdBytes;
  ReceiveBuffer: TCommsBuffer;
  //iSize: Word;
begin
  FillChar(ReceiveBuffer, SizeOf(ReceiveBuffer), 0);
  ReceiveBuffer.TransactionID := 1;
  ReceiveBuffer.ProtocolID := 2;
  ReceiveBuffer.RecLength := 3;
  ReceiveBuffer.UnitID := 4;
  ReceiveBuffer.FunctionCode := 5;
  FillChar(ReceiveBuffer.MBPData[0], SizeOf(ReceiveBuffer.MBPData), 6);
  ReceiveBuffer.Spare := 7;
  SetLength(Buffer, SizeOf(ReceiveBuffer));
  Move(ReceiveBuffer, Buffer, SizeOf(ReceiveBuffer));
  Move(Buffer, ReceiveBuffer, SizeOf(ReceiveBuffer));
  ReceiveBuffer.UnitID := 8;
end; 
```

然后我在结束前的最后一行设置了一个断点，然后运行它。当断点被命中时，我使用 ToolTip Evaluation 查看了 ReceiveBuffer 的内容，一切看起来都很好。我可以看到所有正确的值，包括 ReceiveBuffer.Spare 为 7。然后我单步执行，查看 ReceiveBuffer.UnitID；实际上它的值是 8。

但是，按 F9 继续运行（希望能够关闭窗体并结束应用程序），我最终进入 CPU 窗口并从 Vista 收到一条消息，表明应用程序没有响应。我刚刚在 ntdll.DebugBreakPoint、IIRC 之外，单步执行将我带入了 ntdll.RtlReportException。我不太确定发生了什么，但这并不好。还在找。

Edit2：我再次运行它，结果相同。然而，这一次我注意到在我使用 Ctrl+F2 终止应用程序之前，Vista 给了我一个弹出工具托盘窗口，指示“Project1.exe 已关闭”并提到 DEP（我已在这台机器上的硬件中启用）。

# deployment - 是否有支持现代多线程存档器的任务 - 7zip、winrar 等？

> ID：619910
> 
> 赞同：2
> 
> 时间：2009-03-06T18:27:13.773
> 
> 标签：deployment, ant, zip, 7zip

我们正在使用[Ant Zip 任务](http://ant.apache.org/manual/Tasks/zip.html)，它有点过时（大文件的处理速度低）。

谁能给我指出一个成熟的 Ant 任务，准备好用于生产，支持多线程压缩/解压缩？

首先，我希望提高处理归档文件的速度。

我找到了[7ZIP Ant task](http://www.pharmasoft.be/7z/)，但它看起来被遗弃了，而且它不支持多线程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T18:34:54.037

为什么不将[exec 任务](http://ant.apache.org/manual/Tasks/exec.html)与 7zip 的命令行版本一起使用？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T18:48:14.080

Zip/Jar 任务运行良好，因为 Java（因此是 ant）内置了对它们的支持（不确定 tar 支持）。内置支持需要用 Java 编写的 7zip，或者至少包含在一些 ant 任务中。编写 Ant taks 非常容易。写你自己的，然后把壳写成 7zip/pbzip/etc。如果您真的很有进取心，请试一试……[来自 7zip 的 LZMA 库，支持 Java](http://downloads.sourceforge.net/sevenzip/lzma465.tar.bz2)

[7-zip 下载，还有 CLI 版本](http://www.7-zip.org/download.html)

要减少外部依赖，只需捆绑您要使用的 cli 压缩工具版本。

我相信许多可执行文件（特别是 7zip）都有多个平台的 cli 版本。

# c# - 如何对父 List<> 中 List<> 成员的值进行排序

> ID：619912
> 
> 赞同：0
> 
> 时间：2009-03-06T18:27:52.057
> 
> 标签：c#, list, sorting, generics

我有一个列表排序问题。我正在使用 c# 3.0 和这样的通用列表结构：

```
public class myObject
{
    public int ID { get; set; }
    public List<mySetting> setting { get; set; }
}

public class mySetting
{
    public int ID { get; set; }
    public string Name { get; set; }
    public string Value { get; set; }  // sort on this!
} 
```

使用这种结构，我正在使用 LINQ 查询填充 myObject 列表。

```
List<myObject> lmo = new List<myObject>();
lmo.SomeFillOperation(): 
```

我现在要做的是`List<myObject>`根据各个`<mySetting>[].Value`值对整体进行排序。编辑：（所以这将在一个键控索引上排序，例如 mySetting[3].Value）。我意识到我可以在我的 中做到这一点`SomeFillOperation()`，但我想在列表形成之后再做。

有推荐的或简单的方法吗？你见过一个很好的例子吗？提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T18:31:52.873

Well, `List<T>` already has a [`Sort`](http://msdn.microsoft.com/en-us/library/3da4abas.aspx) method if you want to sort it in place - or you could use LINQ's [`OrderBy`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.orderby.aspx) method. `OrderBy` is slightly easier than `Sort`:

```
var sorted = lmo.OrderBy(x => x.Value); 
```

but even `Sort` isn't too bad:

```
lmo.Sort((x, y) => x.Value.CompareTo(y.Value)); 
```

EDIT: Having read the comment to the question, I no longer understand the question! Leaving this answer here as a potentially useful placeholder while I have dinner...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T18:34:07.843

```
int MyObjectComparison(MyObject x, MyObject y)
{
     return x.setting[0].Value.CompareTo(y.setting[0].Value);
}

lmo.Sort(MyObjectComparison); 
```

Of course, this assumes that you want to use the Value of the first element in setting (and that setting is guarunteed to have at least one element). Solution with less assumption will be forthcoming when more info is given.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T18:33:44.553

Since you are using 3.0, use LINQ:

```
var newList = lmo.OrderBy(i => i.Value); 
```

and

```
var newList = lmo.OrderByDescending(i => i.Value); 
```

# c# - How do you hide an encryption key in a .NET application?

> ID：619921
> 
> 赞同：13
> 
> 时间：2009-03-06T18:31:43.683
> 
> 标签：c#, database, security, encryption, obfuscation

I'm developing an intranet application (C#) that uses some data (local to the web server) that we'd like to keep private. This data is encrypted (AES) using a legacy data repository. We can't totally prevent physical access to the machine.

Clearly, we're never going to have perfect security here. However, we want to make it as hard as possible for anyone to gain unauthorized access to the data.

The question is how best to store the key. Encrypting it based on some machine specific ID is an option, but that information would be readily available to anyone running a diagnostic tool on the machine.

Encoding it in the application is an option (it's a one off application). However, .NET assemblies are pretty easy to decompile. So, would it be best to obfuscate it, use an encryption launcher, compile it?

Or is there an option I'm missing?

Just so we're clear, I know it's pretty much a lost cause if someone is determined, but we're looking to make it as hard as possible within the constraints.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T18:34:15.660

Encryption is built into the .NET configuration system. You can encrypt chunks of your app/web.config file, including where you store your private key.

[http://www.dotnetprofessional.com/blog/post/2008/03/03/Encrypt-sections-of-WebConfig-or-AppConfig.aspx](http://www.dotnetprofessional.com/blog/post/2008/03/03/Encrypt-sections-of-WebConfig-or-AppConfig.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-30T17:17:42.787

用混淆术语来说，您所追求的称为*常量隐藏*，即将常量转换为例如在运行时执行以重新实现所述常量的许多函数和计算的方法。

然而，这仍然属于混淆领域，并且容易受到代码提取的影响，攻击者只需映射与此常量相关的代码，并在单独的应用程序中运行它以检索值；或在正确的位置转储应用程序的内存，以便扫描它以获得所需的值。

还有另一种稍微高级的隐藏加密密钥的方法，称为*白盒密码术*，它通过基本上从给定密钥生成密码函数，将它们烘焙在一起来使用无密钥密码。顾名思义，即使在白盒攻击场景中（攻击者可以访问字节码并能够在运行时检查和操作可执行文件），这种方法也被设计为具有弹性。

这些都是通过模糊实现安全性的非常先进的方法，可能值得考虑替代模型，它们一开始就不会强迫您这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T20:38:46.797

如果有人可以将调试器附加到您的程序，那么您绝对无能为力。他们不必弄清楚您的配置、反汇编您的应用程序等。他们所要做的就是运行应用程序 - 使用密钥观看它 - 宾果游戏。

在这种情况下，混淆是没有帮助的。

最好的防御是使用硬件来保护密钥——它会进行加密但不会泄露密钥本身（并且有时会针对诸如探测电线、将内存暴露于低温/辐射/其他新奇事物等攻击进行强化） . IBM 做了一些适当的事情（谷歌 IBM-4764），但它并不便宜。

# code-generation - 如何将 Brail 用作独立的通用模板引擎（如 NVelocity）？

> ID：619923
> 
> 赞同：3
> 
> 时间：2009-03-06T18:31:59.610
> 
> 标签：code-generation, template-engine, brail

我一直在我的文本文件生成器中使用 NVelocity 作为独立的模板引擎。NVelocity 的问题在于宏非常不稳定。我得到的几乎所有错误都来自错误的宏实现。

如果我可以使用其他一些模板引擎，例如 Brail，那就太酷了。这样我只需要编写输出字符串的函数。

嵌入 Brail 引擎的最佳方法是什么？我想只传递一个包含模板的字符串（不是从磁盘读取），并且我想最小化外部依赖项的数量。

**编辑：**我自己找到了答案。[看看这个来自 Castle 的源文件](http://svn.castleproject.org:8080/svn/castle/trunk/MonoRail/Castle.MonoRail.Views.Brail/StandaloneBooViewEngine.cs)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T03:47:47.497

尝试[nHaml](http://andrewpeters.net/2007/12/19/introducing-nhaml-an-aspnet-mvc-view-engine/)或[Spark](http://dev.dejardin.org/)，因为它们都支持完全[独立](http://andrewpeters.net/2008/04/19/standalone-nhaml/)或[直接](http://dev.dejardin.org/trac/spark/browser/trunk/src/Samples/DirectUsage)使用

它们都支持返回字符串等的标准 c# 函数

Spark 是真正的 HTML，nHaml 是 DRY HTML

两者都非常酷！

# perl - 我应该在 Perl 中转义 shell 参数吗？

> ID：619926
> 
> 赞同：15
> 
> 时间：2009-03-06T18:33:03.947
> 
> 标签：perl, shell, arguments

在 Perl 中使用[system()](http://perldoc.perl.org/functions/system.html)调用时，您是否必须转义 shell 参数，还是自动完成？

参数将是用户输入，所以我想确保这是不可利用的。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-06T18:43:52.437

如果您使用`system $cmd, @args`而不是`system "$cmd @args"`（数组而不是字符串），那么您不必转义参数，因为没有调用任何 shell（请参阅[system](http://perldoc.perl.org/functions/system.html)）。 `system {$cmd} $cmd, @args`即使 $cmd 包含元字符并且 @args 为空（这被记录为[exec](http://perldoc.perl.org/functions/exec.html)的一部分），也不会调用 shell。如果 args 来自用户输入（或其他不受信任的来源），您仍将希望消除它们的污点。请参阅`-T`perlrun[文档](http://perldoc.perl.org/perlrun.html)和[perlsec](http://perldoc.perl.org/perlsec.html)文档。

如果您需要读取输出或将输入发送到命令，`qx`并且`readpipe`没有等效项。相反，使用`open my $output, "-|", $cmd, @args`or`open my $input, "|-", $cmd, @args`虽然这不是可移植的，因为它需要一个真实的`fork`，这意味着仅 Unix ......我认为。也许它可以在带有模拟分支的 Windows 上运行。更好的选择是[IPC::Run](http://search.cpan.org/dist/IPC-Run/)之类的，它还将处理管道命令到其他命令的情况，系统的多 arg 形式和 open 的 4 arg 形式都无法处理。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-08T07:11:22.867

在 Windows 上，情况有点糟糕。基本上，所有 Win32 程序都会收到一个长的命令行字符串——shell（通常`cmd.exe`）可能会首先进行一些解释，例如删除`<`和`>`重定向，但它不会*在*程序的字边界处将其拆分。每个程序都必须自己解析（如果他们愿意——有些程序不会打扰）。在 C 和 C++ 程序中，由编译器工具链提供的运行时库提供的例程通常会在`main()`调用之前执行此解析步骤。

问题是，一般来说，*您不知道给定程序将如何解析其命令行*。许多程序是使用某些版本的 MSVC++ 编译的，[这里描述了其古怪的解析规则](http://msdn2.microsoft.com/en-us/library/a1y7w461.aspx)，但许多其他程序是使用使用不同约定的不同编译器编译的。

`cmd.exe`具有自己古怪的解析规则的事实使情况更加复杂。插入符号 ( `^`) 被视为引用以下字符的转义字符，如果满足一系列棘手的条件，则双引号内的文本被视为引用（`cmd /?`有关完整的血腥细节，请参阅 ）。如果您的命令包含任何奇怪的字符，则很容易`cmd.exe`知道文本的哪些部分被“引用”，哪些部分不会与您的目标程序不同步，并且一切都变得松散了。

因此，在 Windows 上转义参数的最安全方法是：

1.  以您正在调用的程序的命令行解析逻辑所期望的方式转义参数。（希望你知道这个逻辑是什么；如果不知道，请尝试一些示例并猜测。）
2.  用空格加入转义参数。
3.  使用 .为结果字符串的*每个非字母数字字符*添加前缀`^`。
4.  附加任何重定向或其他 shell 技巧（例如，使用 加入命令`&&`）。
5.  `system()`使用或反引号运行命令。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-19T02:53:58.190

```
 sub esc_chars {
  # will change, for example, a!!a to a\!\!a
     @_ =~ s/([;<>\*\|`&\$!#\(\)\[\]\{\}:'"])/\\$1/g;
     return @_;
  } 
```

[http://www.slac.stanford.edu/slac/www/resource/how-to-use/cgi-rexx/cgi-esc.html](http://www.slac.stanford.edu/slac/www/resource/how-to-use/cgi-rexx/cgi-esc.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-03T12:02:41.710

如果您使用 system "$cmd @args" （一个字符串），那么您必须转义参数，因为调用了一个 shell。

幸运的是，对于双引号字符串，只有四个字符需要转义：

```
"    - double quote
$    - dollar
@    - at symbol
\    - backslash 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-13T17:11:10.883

你的问题的答案非常有用。最后，我遵循了@runrig 的建议，但随后使用了核心模块 open3() 命令，这样我就可以捕获来自 STDERR 和 STDOUT 的输出。

有关与@runrig 的解决方案一起使用的 open3() 示例代码，请参阅我的相关问答：
[Calling system commands from Perl](https://stackoverflow.com/questions/4413344/calling-system-commands-from-perl/4424781#4424781)

# sql - LEFT JOIN problem within a Stored Procedure

> ID：619936
> 
> 赞同：0
> 
> 时间：2009-03-06T18:34:54.690
> 
> 标签：sql, mysql

I've an odd problem:

```
SELECT a.uid, b.*, c.liveId FROM a
INNER JOIN b ON (a.uid=b.uid AND a.versionNo=b.versionNo)
LEFT JOIN c ON (a.uid=c.uid)
WHERE a.memberId=1; 
```

I call that from a query browser and it returns 3 rows. I call it from within a stored procedure and it gives 2 rows (the LEFT JOIN becomes ineffective).

```
 DELIMITER //

    DROP PROCEDURE IF EXISTS sp_Test //

    CREATE
      DEFINER = CURRENT_USER
      PROCEDURE sp_Test( IN in_mid INTEGER UNSIGNED )

      READS SQL DATA
      NOT DETERMINISTIC

    BEGIN

     SELECT a.uid, b.*, c.liveId FROM a
     INNER JOIN b ON (a.uid=b.uid AND a.versionNo=b.versionNo)
     LEFT JOIN c ON (a.uid=c.uid)
     WHERE a.memberId=in_mid;

    END //

DELIMITER ; 
```

I'm stumped! Any suggestions?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T18:43:21.800

Have you forgotten to COMMIT / ROLLBACK one of the sessions after doing an UPDATE / DELETE / INSERT?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T19:45:18.953

我在 SQL Server 中尝试过，稍作改动后它确实对我有用：

```
CREATE PROCEDURE sp_Test(
@in_mid int)
AS
BEGIN
SELECT a.uid, b.*, c.liveId FROM a
    INNER JOIN b ON (a.uid=b.uid AND a.versionNo=b.versionNo)
    LEFT JOIN c ON (a.uid=c.uid)
    WHERE a.memberId=@in_mid;
END 
```

试试看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T19:24:33.713

我对 MySQL 没有很多经验，但是是否有任何特定于连接的设置会导致 NULL 比较在每种情况下的行为不同？例如，如果 versionNo 可能是 NULL，那么一个连接可能会认为 NULL = NULL，但另一个可能会将其评估为 false。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T21:36:14.303

我用一个完全奇怪和不合逻辑的改变解决了它。

```
SELECT a.uid, b.*, c.liveId FROM a
     INNER JOIN b ON (a.uid=b.uid AND a.versionNo=b.versionNo)
     LEFT JOIN c ON (a.uid=c.uid)
     WHERE a.memberId=in_mid
UNION
SELECT a.uid, b.*, c.liveId FROM a
     INNER JOIN b ON (a.uid=b.uid AND a.versionNo=b.versionNo)
     LEFT JOIN c ON (a.uid=c.uid)
     WHERE a.memberId=in_mid; 
```

在存储过程中执行此操作会为我提供在查询浏览器中执行时获得的所有行。

# c# - 处理意外枚举值的首选方法是什么？

> ID：619945
> 
> 赞同：16
> 
> 时间：2009-03-06T18:38:32.030
> 
> 标签：c#, java, .net, language-agnostic, enums

假设我们有一个接受枚举值的方法。在此方法检查该值是否有效后，它会`switch`覆盖可能的值。所以问题是，在验证值范围*后*，处理意外值的首选方法是什么？

例如：

```
enum Mood { Happy, Sad }

public void PrintMood(Mood mood)
{
    if (!Enum.IsDefined(typeof(Mood), mood))
    {
        throw new ArgumentOutOfRangeException("mood");
    }

    switch (mood)
    {
        case Happy: Console.WriteLine("I am happy"); break;
        case Sad:   Console.WriteLine("I am sad"); break;
        default: // what should we do here?
    } 
```

`default`处理此案的首选方法是什么？

*   发表评论喜欢`// can never happen`
*   `Debug.Fail()`（或`Debug.Assert(false)`）
*   `throw new NotImplementedException()`（或任何其他例外）
*   其他我没想到的方法

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-06T22:09:16.580

我想上面的大多数答案都是有效的，但我不确定任何一个都是正确的。

正确的答案是，您很少切换 OO 语言，这表明您做错了 OO。在这种情况下，它完美地表明您的 Enum 类存在问题。

您应该只调用 Console.WriteLine(mood.moodMessage())，并为每个状态定义 moodMessage。

如果添加了新状态——所有代码都应该自动适应，那么什么都不会失败、抛出异常或需要更改。

编辑：回复评论。

在您的示例中，要成为“Good OO”，文件模式的功能将由 FileMode 对象控制。它可以包含一个委托对象，其中的“打开、读取、写入...”操作对于每个 FileMode 都不同，因此 File.open("name", FileMode.Create) 可以实现为（抱歉不熟悉API）：

```
open(String name, FileMode mode) {
    // May throw an exception if, for instance, mode is Open and file doesn't exist
    // May also create the file depending on Mode
    FileHandle fh = mode.getHandle(name);
    ... code to actually open fh here...
    // Let Truncate and append do their special handling
    mode.setPosition(fh);
} 
```

这比尝试用开关来做要整洁得多......（顺便说一下，这些方法既是包私有的，也可能委托给“模式”类）

如果 OO 做得好，每一个方法看起来都像是几行非常容易理解、简单的代码——太简单了。你总是觉得有一些大杂乱的“奶酪核”把所有的小玉米片放在一起，但你永远找不到它——它一直是玉米片……

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-06T18:39:11.233

我更喜欢`throw new NotImplementedException("Unhandled Mood: " + mood)`. 重点是以后枚举可能会发生变化，这个方法可能不会相应更新。抛出异常似乎是最安全的方法。

我不喜欢该`Debug.Fail()`方法，因为该方法可能是库的一部分，并且可能不会在调试模式下测试新值。在这种情况下，使用该库的其他应用程序可能会面临奇怪的运行时行为，而在引发异常的情况下，错误将立即被知晓。

注意：`NotImplementedException`存在于[`commons.lang`](http://commons.apache.org/proper/commons-lang/javadocs/api-2.0/org/apache/commons/lang/NotImplementedException.html).

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-06T18:54:50.947

在 Java 中，标准方法是抛出`AssertionError`，原因有两个：

1.  这确保即使`asserts`被禁用，也会引发错误。
2.  您断言没有其他枚举值，因此`AssertionError`比`NotImplementedException`（Java 无论如何都没有）更好地记录您的假设。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-06T19:08:06.093

我的观点是，由于这是一个程序员错误，您应该对其进行断言或抛出 RuntimException（Java 或其他语言的等价物）。我有自己的 UnhandledEnumException，它从我用于此的 RuntimeException 扩展而来。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-06T19:24:46.973

正确的程序响应应该是以允许开发人员轻松发现问题的方式 **终止。**[mmyers](https://stackoverflow.com/questions/619945/what-is-the-preferred-method-for-handling-unexpected-enum-values/619999#619999)和[JaredPar](https://stackoverflow.com/questions/619945/what-is-the-preferred-method-for-handling-unexpected-enum-values/620021#620021)都提供了很好的方法来做到这一点。

**为什么会死？** 这似乎太极端了！

原因是，如果您没有正确处理 enum 值并且刚刚*失败*，那么您将程序置于意外状态。一旦你处于一个意想不到的状态，谁知道发生了什么。这可能会导致错误的数据、更难追踪的错误，甚至是安全漏洞。

此外，如果程序死了，那么您在 QA 中发现它的机会就会大得多，因此它甚至不会被淘汰。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-06T19:01:09.557

对于我的代码库中的几乎每个 switch 语句，我都有以下默认情况

```
switch( value ) { 
...
default:
  Contract.InvalidEnumValue(value);
} 
```

该方法将抛出一个异常，详细说明在检测到错误时枚举的值。

```
public static void InvalidEnumValue<T>(T value) where T: struct
{
    ThrowIfFalse(typeof(T).IsEnum, "Expected an enum type");
    Violation("Invalid Enum value of Type {0} : {1}", new object[] { typeof(T).Name, value });
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-06T22:04:38.570

对于 C#，值得了解的[`Enum.IsDefined()`是危险](http://blogs.msdn.com/brada/archive/2003/11/29/50903.aspx)。你不能像现在这样依赖它。得到不符合预期值的东西是抛出异常并大声死亡的好例子。

在 Java 中，这是不同的，因为枚举是类而不是整数，所以你真的不能得到意外的值（除非枚举被更新并且你的 switch 语句没有），这是我更喜欢 Java 枚举的一个重要原因。您还必须满足空值。但是得到一个你不认识的非空情况也是抛出异常的好例子。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-06T18:44:10.033

您可以跟踪默认调用传递的枚举的值。抛出异常是可以的，但在大型应用程序中，会有几个地方你的代码不关心枚举的其他值。
因此，除非您确定代码打算处理枚举的所有可能值，否则您必须稍后返回并删除异常。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-06T19:37:02.170

这是证明为什么测试驱动开发如此重要的问题之一。

在这种情况下，我会选择 NotSupportedException，因为实际上该值未处理，因此不受支持。NotImplementedException 提供了更多的想法：“这还没有完成”；）

调用代码应该能够处理这样的情况，并且可以创建单元测试来轻松测试这些情况。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-06T19:06:22.353

称其为意见或偏好，但枚举背后的想法是它代表可能值的完整列表。如果在代码中传递“意外值”，则枚举（或枚举背后的目的）不是最新的。我个人的偏好是每个枚举都带有一个未定义的默认分配。鉴于枚举是一个已定义的列表，它不应该与您的消费代码过时。

至于如果您的函数在我的情况下获得意外值或 Undefined 该怎么办，通用答案似乎是不可能的。对我来说，这取决于评估枚举值的原因的上下文：是代码执行应该停止的情况，还是可以使用默认值？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-06T19:14:17.730

提供有效输入是调用函数的责任，并且隐含地不在枚举中的任何内容都是无效的（实用程序员似乎暗示了这一点）。也就是说，这意味着无论何时更改枚举，都必须更改接受它作为输入的所有代码（以及一些产生它作为输出的代码）。但无论如何，这可能是真的。如果您有一个经常更改的枚举，则考虑到枚举通常是编译时实体，您可能应该使用枚举以外的东西。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-06T19:31:17.660

我通常尝试定义未定义的值（0）：

```
enum Mood { Undefined = 0, Happy, Sad } 
```

这样我总是可以说：

```
switch (mood)
{
    case Happy: Console.WriteLine("I am happy"); break;
    case Sad:   Console.WriteLine("I am sad"); break;
    case Undefined: // handle undefined case
    default: // at this point it is obvious that there is an unknown problem
             // -> throw -> die :-)
} 
```

至少我通常是这样做的。

# .net - 在构造函数中设置 SqlDateTime.Null

> ID：619956
> 
> 赞同：1
> 
> 时间：2009-03-06T18:41:11.290
> 
> 标签：.net, sql, vb.net, datetime

如何在构造函数中为可选的 DateTime 参数设置空值？

我在下面使用以下构造函数，并且我希望可选参数 admissionDate 为空 DateTime。将其设置为 Nothing 实际上会给它一个值（类似于 #12:00:00 #）。

```
Public Sub New(ByVal obj1 as Object, Optional ByVal admissionDate As DateTime = System.Data.SqlTypes.SqlDateTime.Null) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T18:45:43.837

你需要一个可以为空的日期时间。在 C# 中，它是`Nullable<DateTime>`or `DateTime?`。我不确定 VB.NET 语法，但我认为它类似于`Nullable(Of DateTime)`

```
 Public Sub New(ByVal obj1 as Object, _
        Optional ByVal admissionDate As Nullable(Of DateTime) = Null) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T18:44:31.843

我通常使用 DateTime.MinValue 来表示一个空日期/时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T18:46:01.747

System.Data.SqlTypes.SqlDateTime 与内置日期时间不同。

您可以使用该类型或使用可为空的日期时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-06T19:28:35.590

我建议使用 James Curran 的解决方案，但使用 Overloading 而不是可选参数，作为您提到的错误的解决方法（“可选参数不能具有结构类型”）：

```
Public Sub New(ByVal obj1 As Object, ByVal admissionDate As Nullable(Of DateTime))
  //Your code here
End Sub

Public Sub New(Byval obj1 As Object)
  Me.New(obj1, Nothing)
End Sub 
```

您还可以使用日期时间吗？而不是最新版本的 VB 中的 Nullable(Of DateTime) （不确定旧版本）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T18:45:14.243

你试过`DBNull.Valu`e吗？

# regex - 跟踪号码的正则表达式模式

> ID：619977
> 
> 赞同：63
> 
> 时间：2009-03-06T18:45:52.167
> 
> 标签：regex, fedex, ups

有没有人知道检查哪个公司跟踪号是包裹的给定跟踪号的好地方或模式。想法是在扫描条形码以获取带有图案的包裹检查跟踪号并显示它是由哪家公司运送的。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2011-02-17T00:58:15.487

只是想我会发布一个更新，因为我正在处理这个以通过 jquery 匹配并自动选择合适的运输公司。我为我的项目编制了一个匹配的正则表达式列表，并且我在 UPS FedEX 和 USPS 上测试了很多跟踪号码。

如果您遇到不匹配的内容，请在此处通过评论告诉我，我也会尝试解决此问题。

UPS：

```
/\b(1Z ?[0-9A-Z]{3} ?[0-9A-Z]{3} ?[0-9A-Z]{2} ?[0-9A-Z]{4} ?[0-9A-Z]{3} ?[0-9A-Z]|[\dT]\d\d\d ?\d\d\d\d ?\d\d\d)\b/ 
```

联邦快递：（3 个不同的）

```
/(\b96\d{20}\b)|(\b\d{15}\b)|(\b\d{12}\b)/
/\b((98\d\d\d\d\d?\d\d\d\d|98\d\d) ?\d\d\d\d ?\d\d\d\d( ?\d\d\d)?)\b/
/^[0-9]{15}$/ 
```

USPS：（4 个不同的）

```
/(\b\d{30}\b)|(\b91\d+\b)|(\b\d{20}\b)/
/^E\D{1}\d{9}\D{2}$|^9\d{15,21}$/
/^91[0-9]+$/
/^[A-Za-z]{2}[0-9]+US$/ 
```

请注意，这些不是我自己想出来的。我只是四处搜索并从不同的来源编译了列表，包括这里可能提到的一些。

谢谢

编辑：修复了缺少的结束分隔符。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-08-21T09:09:08.050

我向 Royal Mail 申请了 Recorded Delivery & Special Delivery 跟踪参考的正则表达式，但并没有走得太远。即使是一整套规则，以便我可以自己滚动，也超出了它们。

基本上，即使他们花了大约一周的时间回来并提供了表示服务类型的各种字母组合，我还是能够根据我们的经验提供示例，这些示例表明还有其他组合显然是有效的，但他们没有记录在案。

引用遵循我认为 Jefe 的`/^[A-Za-z]{2}[0-9]+GB$/`正则表达式将描述的明显标准国际格式：

> XX123456789GB

尽管这似乎是一种标准格式，即大多数国际邮件的格式与最后两个字母表示原产国的格式相同，但我无法找到有关此“标准”或其来源的更多信息（欢迎任何澄清！）。

皇家邮政特别使用前两个字母来表示服务水平。我已经设法编译了一个表示特殊交付的前缀列表，但我不相信它是 100% 完成的：

```
AD AE AF AJ AK AR AZ BP CX DS EP HC HP KC KG
KH KI KJ KQ KU KV KW KY KZ PW SA SC SG SH SI
SJ SL SP SQ SU SW SY SZ TX WA WH XQ WZ 
```

如果没有这些前缀之一，则服务是 Recorded Delivery，它提供交付确认但不跟踪。

通常，包含 S、X 或 Z 似乎表示更高的服务水平，我认为我从未见过在前缀中带有任何这些字母的正常记录交付项目。

但是，如您所见，如果要使用正则表达式检查服务级别，则需要测试许多前缀，并且鉴于皇家邮政似乎无法提供全面的规则集，那么尝试测试服务级别可能是徒劳的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-06-23T22:47:20.760

我需要验证 JUST 美国邮政服务 (USPS) 追踪号码。WikiAnswers 说我的数字格式如下：

> USPS 仅提供快递邮件跟踪，通常以“E”开头，另一个字母，后跟 9 位数字，以及另外两个字母。对于长度在 16 到 22 位之间的其他服务，USPS 确实有“标签编号”。
> 
> [http://wiki.answers.com/Q/How_many_numbers_in_a_USPS_tracking_number](http://wiki.answers.com/Q/How_many_numbers_in_a_USPS_tracking_number)

我要补充一点，标签编号以“9”开头，因为过去 2 年我从个人发货中获得的所有标签编号都以 9 开​​头。

所以，假设 WikiAnswers 是正确的，这是我的正则表达式，它匹配两者：

```
/^E\D{1}\d{9}\D{2}$|^9\d{15,21}$/ 
```

这很简单。这是分解：

```
^E       - Begins w/ E  (For express number)
\D{1}    - followed by another letter
\d{9}    - followed by 9 numbers
\D{2}    - followed by 2 more letters
$        - End of string

|        - OR

^9       - Basic Track & Ship Number
\d{15,21}   - followed by 15 to 21 numbers
$        - End of string 
```

使用 www.gummydev.com 的正则表达式测试器，这个模式匹配我的两个测试字符串：

快递邮件：EK225651436US

标签号：9410803699300003725216

**注意：如果您使用的是 ColdFusion（我是），请从模式中删除第一个和最后一个“/”

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-07-07T21:52:47.117

我的用例需要更强大的东西。我不断地遇到不完整、不正确或过于冗长的示例，而正确性没有任何改进。希望这对其他人有帮助！它涵盖了其他答案中的所有不同格式，再加上一些，并且与其他一些答案不同，FedEx 和 USPS 之间没有重叠。

# 追踪号码正则表达式：

## 美国邮政/S10：

[https://postalpro.usps.com/mnt/glusterfs/2020-02/Pub%20199%20Intelligent%20Mail%20Package%20Barcode%20(IMpb)%20Implementation%20Guide%202020_02_11%20TT%20v6.pdf](https://postalpro.usps.com/mnt/glusterfs/2020-02/Pub%20199%20Intelligent%20Mail%20Package%20Barcode%20(IMpb)%20Implementation%20Guide%202020_02_11%20TT%20v6.pdf)

```
\b([A-Z]{2}\d{9}[A-Z]{2}|(420\d{9}(9[2345])?)?\d{20}|(420\d{5})?(9[12345])?(\d{24}|\d{20})|82\d{8})\b 
```

## UPS：

```
\b1Z[A-Z0-9]{16}\b 
```

## 联邦快递：

```
\b([0-9]{12}|100\d{31}|\d{15}|\d{18}|96\d{20}|96\d{32})\b 
```

# 警告/注意事项：

*   FedEx SmartPost [有意] 归类为 USPS；它可以被跟踪
*   USPS 包括用于国际邮政的 S10 格式跟踪号
*   跟踪号有模块校验位；这些正则表达式不检查它们
*   这是通过阅读规格表、阅读其他答案、查看开源代码等发现的。它匹配了大约 6,000 个跟踪号码，我以 100% 的准确率运行它，但我不能确定它在所有情况下都是正确的。
*   这些假设您在应用正则表达式之前已删除所有空格

* * *

# 运单号示例

主要来自：

*   [https://tools.usps.com/go/TrackConfirmAction](https://tools.usps.com/go/TrackConfirmAction)
*   [https://github.com/jkeen/tracking_number_data](https://github.com/jkeen/tracking_number_data)

```
| Tracking Number                    | Kind                                | Tracking Carrier |
|------------------------------------|-------------------------------------|------------------|
| 03071790000523483741               | USPS 20                             | USPS             |
| 71123456789123456787               | USPS 20                             | USPS             |
| 4201002334249200190132607600833457 | USPS 34v2                           | USPS             |
| 4201028200009261290113185417468510 | USPS 34v2                           | USPS             |
| 420221539101026837331000039521     | USPS 91                             | USPS             |
| 71969010756003077385               | USPS 91                             | USPS             |
| 9505511069605048600624             | USPS 91                             | USPS             |
| 9101123456789000000013             | USPS 91                             | USPS             |
| 92748931507708513018050063         | USPS 91                             | USPS             |
| 9400111201080805483016             | USPS 91                             | USPS             |
| 9361289878700317633795             | USPS 91                             | USPS             |
| 9405803699300124287899             | USPS 91                             | USPS             |
| EK115095696SA                      | S10                                 | USPS             |
| 1Z5R89390357567127                 | UPS                                 | UPS              |
| 1Z879E930346834440                 | UPS                                 | UPS              |
| 1Z410E7W0392751591                 | UPS                                 | UPS              |
| 1Z8V92A70367203024                 | UPS                                 | UPS              |
| 1ZXX3150YW44070023                 | UPS                                 | UPS              |
| 986578788855                       | FedEx Express (12)                  | FedEx            |
| 477179081230                       | FedEx Express (12)                  | FedEx            |
| 799531274483                       | FedEx Express (12)                  | FedEx            |
| 790535312317                       | FedEx Express (12)                  | FedEx            |
| 974367662710                       | FedEx Express (12)                  | FedEx            |
| 1001921334250001000300779017972697 | FedEx Express (34)                  | FedEx            |
| 1001921380360001000300639585804382 | FedEx Express (34)                  | FedEx            |
| 1001901781990001000300617767839437 | FedEx Express (34)                  | FedEx            |
| 1002297871540001000300790695517286 | FedEx Express (34)                  | FedEx            |
| 61299998820821171811               | FedEx SmartPost                     | USPS             |
| 9261292700768711948021             | FedEx SmartPost                     | USPS             |
| 041441760228964                    | FedEx Ground                        | FedEx            |
| 568283610012000                    | FedEx Ground                        | FedEx            |
| 568283610012734                    | FedEx Ground                        | FedEx            |
| 000123450000000027                 | FedEx Ground (SSCC-18)              | FedEx            |
| 9611020987654312345672             | FedEx Ground 96 (22)                | FedEx            |
| 9622001900000000000000776632517510 | FedEx Ground GSN                    | FedEx            |
| 9622001560000000000000794808390594 | FedEx Ground GSN                    | FedEx            |
| 9622001560001234567100794808390594 | FedEx Ground GSN                    | FedEx            |
| 9632001560123456789900794808390594 | FedEx Ground GSN                    | FedEx            |
| 9400100000000000000000             | USPS Tracking                       | USPS             |
| 9205500000000000000000             | Priority Mail                       | USPS             |
| 9407300000000000000000             | Certified Mail                      | USPS             |
| 9303300000000000000000             | Collect On Delivery Hold For Pickup | USPS             |
| 8200000000                         | Global Express Guaranteed           | USPS             |
| EC000000000US                      | Priority Mail Express International | USPS             |
| 9270100000000000000000             | Priority Mail Express               | USPS             |
| EA000000000US                      | Priority Mail Express               | USPS             |
| CP000000000US                      | Priority Mail International         | USPS             |
| 9208800000000000000000             | Registered Mail                     | USPS             |
| 9202100000000000000000             | Signature Confirmation              | USPS             | 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-12-19T23:04:01.833

以下是美国主要运营商的一些示例编号：

```
USPS:
70160910000108310009   (certified)
23153630000057728970   (signature confirmation)
RE360192014US          (registered mail)      
EL595811950US          (priority express)
9374889692090270407075 (regular)

FEDEX:
810132562702  (all seem to follow same pattern regardless) 
795223646324
785037759224

UPS:
K2479825491         (UPS ground)
J4603636537         (UPS next day express)
1Z87585E4391018698  (regular) 
```

我正在使用的模式（php 代码）。是的，我放弃了，开始针对我可以使用的所有模式进行测试。不得不写第二个UPS。

```
public function getCarrier($trackingNumber){

    $matchUPS1      = '/\b(1Z ?[0-9A-Z]{3} ?[0-9A-Z]{3} ?[0-9A-Z]{2} ?[0-9A-Z]{4} ?[0-9A-Z]{3} ?[0-9A-Z]|[\dT]\d\d\d ?\d\d\d\d ?\d\d\d)\b/';
    $matchUPS2      = '/^[kKJj]{1}[0-9]{10}$/';

    $matchUSPS0     = '/(\b\d{30}\b)|(\b91\d+\b)|(\b\d{20}\b)/';
    $matchUSPS1     = '/(\b\d{30}\b)|(\b91\d+\b)|(\b\d{20}\b)|(\b\d{26}\b)| ^E\D{1}\d{9}\D{2}$|^9\d{15,21}$| ^91[0-9]+$| ^[A-Za-z]{2}[0-9]+US$/i';
    $matchUSPS2     = '/^E\D{1}\d{9}\D{2}$|^9\d{15,21}$/';
    $matchUSPS3     = '/^91[0-9]+$/';
    $matchUSPS4     = '/^[A-Za-z]{2}[0-9]+US$/';
    $matchUSPS5     = '/(\b\d{30}\b)|(\b91\d+\b)|(\b\d{20}\b)|(\b\d{26}\b)| ^E\D{1}\d{9}\D{2}$|^9\d{15,21}$| ^91[0-9]+$| ^[A-Za-z]{2}[0-9]+US$/i';

    $matchFedex1    = '/(\b96\d{20}\b)|(\b\d{15}\b)|(\b\d{12}\b)/';
    $matchFedex2    = '/\b((98\d\d\d\d\d?\d\d\d\d|98\d\d) ?\d\d\d\d ?\d\d\d\d( ?\d\d\d)?)\b/';
    $matchFedex3    = '/^[0-9]{15}$/';

    if(preg_match($matchUPS1, $trackingNumber) || 
        preg_match($matchUPS2, $trackingNumber))
     {
        echo('UPS');

        $carrier = 'UPS';
        return $carrier;
    } else if(preg_match($matchUSPS0, $trackingNumber) || 
              preg_match($matchUSPS1, $trackingNumber) ||
              preg_match($matchUSPS2, $trackingNumber) ||
              preg_match($matchUSPS3, $trackingNumber) ||
              preg_match($matchUSPS4, $trackingNumber) ||
              preg_match($matchUSPS5, $trackingNumber)) {

        $carrier = 'USPS';
        return $carrier;
    } else if (preg_match($matchFedex1, $trackingNumber) || 
               preg_match($matchFedex2, $trackingNumber) || 
               preg_match($matchFedex3, $trackingNumber)) {

        $carrier = 'FedEx';
        return $carrier;
    } else if (0){
        $carrier = 'DHL';
        return $carrier;
    } 

    return;

} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-08-18T21:52:45.727

对此进行了一段时间的研究，并主要根据此处的答案制作这些内容。
这些应该涵盖所有内容，但不要太宽容。
UPS：
`/^(1Z\s?[0-9A-Z]{3}\s?[0-9A-Z]{3}\s?[0-9A-Z]{2}\s?[0-9A-Z]{4}\s?[0-9A-Z]{3}\s?[0-9A-Z]$|[\dT]\d{3}\s?\d{4}s?\d{3})$/i`

美国邮政：
`/^(EA|EC|CP|RA)\d{9}(\D{2})?$|^(7\d|03|23|91)\d{2}\s?\d{4}\s?\d{4}\s?\d{4}\s?\d{4}(\s\d{2})?$|^82\s?\d{3}\s?\d{3}\s?\d{2}$/i`

联邦快递：
`/^(((96|98)\d{5}\s?\d{4}$|^(96|98)\d{2})\s?\d{4}\s?\d{4}(\s?\d{3})?)$/i`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-06T19:14:16.857

您可以尝试这些（不保证）：

UPS：

```
\b(1Z ?[0-9A-Z]{3} ?[0-9A-Z]{3} ?[0-9A-Z]{2} ?[0-9A-Z]{4} ?[0-9A-Z]{3} ?[0-9A-Z]|[\dT]\d\d\d ?\d\d\d\d ?\d\d\d)\b 
```

UPS：

```
\b(1Z ?\d\d\d ?\d\w\w ?\d\d ?\d\d\d\d ?\d\d\d ?\d|[\dT]\d\d\d ?\d\d\d\d ?\d\d\d)\b 
```

美国邮政：

```
\b(\d\d\d\d ?\d\d\d\d ?\d\d\d\d ?\d\d\d\d ?\d\d\d\d ?\d\d|\d\d\d\d ?\d\d\d\d ?\d\d\d\d ?\d\d\d\d ?\d\d\d\d)\b 
```

但请在使用前进行测试。我推荐[RegexBuddy](http://www.regexbuddy.com/)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-12-04T19:13:39.197

我正在使用 Angular2+ 应用程序，只是将一个组件放在一起来处理常见的美国跟踪号码。它使用标准的 JavaScript RegExp 测试它们，我从[这里](https://www.iship.com/trackit/info.aspx?info=24)和[这里](http://%20AND%20https://www.canadapost.ca/web/en/kb/details.page?article=how_to_track_a_packa&cattype=kb&cat=receiving&subcat=tracking)的资源中汇总，并在带有跟踪链接 URL 的锚标记上设置 href（如果它是好的）。您不必使用 Angular 或 TypeScript 即可轻松地将其适应您的应用程序。我用不同的虚拟数字对其进行了测试，到目前为止似乎是动态工作的。请注意，您还可以在最后一个 else 语句中使用内联注释 url 切换 null，它会将您发送到 Google 搜索。

任何反馈（或者如果您的跟踪号码不起作用）请让我知道我会更新答案。谢谢！

HTML 中的用法：

`<app-tracking-number [trackNum]="myTrackingNumberInput"></app-tracking-number>`

组件.TS

```
import { Component, OnInit, Input } from '@angular/core';

@Component({
  selector: 'app-tracking-number',
  templateUrl: './tracking-number.component.html',
  styleUrls: ['./tracking-number.component.scss']
})
export class TrackingNumberComponent implements OnInit {
    @Input() trackNum:string;
    trackNumHref:string = null;
    // Carrier tracking numbers patterns from https://www.iship.com/trackit/info.aspx?info=24 AND https://www.canadapost.ca/web/en/kb/details.page?article=how_to_track_a_packa&cattype=kb&cat=receiving&subcat=tracking
    isUPS:RegExp = new RegExp('^1Z[A-H,J-N,P,R-Z,0-9]{16}$');               // UPS tracking numbers usually begin with "1Z", contain 18 characters, and do not contain the letters "O", "I", or "Q".
    isFedEx:RegExp = new RegExp('^[0-9]{12}$|^[0-9]{15}$');                 // FedEx Express tracking numbers are normally 12 digits long and do not contain letters AND FedEx Ground tracking numbers are normally 15 digits long and do not contain letters.
    isUSPS:RegExp = new RegExp('^[0-9]{20,22}$|^[A-Z]{2}[0-9,A-Z]{9}US$');  // USPS Tracking numbers are normally 20-22 digits long and do not contain letters AND USPS Express Mail tracking numbers are normally 13 characters long, begin with two letters, and end with "US".
    isDHL:RegExp = new RegExp('^[0-9]{10,11}$');                            // DHL tracking numbers are normally 10 or 11 digits long and do not contain letters.
    isCAPost:RegExp = new RegExp('^[0-9]{16}$|^[A-Z]{2}[0-9]{9}[A-Z]{2}$'); // 16 numeric digits (0000 0000 0000 0000) AND 13 numeric and alphabetic characters (AA 000 000 000 AA).

    constructor() { }

    ngOnInit() {
        this.setHref();
    }

    setHref() {
        if(!this.trackNum) this.trackNumHref = null;
        else if(this.isUPS.test(this.trackNum)) this.trackNumHref = `https://wwwapps.ups.com/WebTracking/processInputRequest?AgreeToTermsAndConditions=yes&loc=en_US&tracknum=${this.trackNum}&Requester=trkinppg`;
        else if(this.isFedEx.test(this.trackNum)) this.trackNumHref = `https://www.fedex.com/apps/fedextrack/index.html?tracknumber=${this.trackNum}`;
        else if(this.isUSPS.test(this.trackNum)) this.trackNumHref = `https://tools.usps.com/go/TrackConfirmAction?tLabels=${this.trackNum}`;
        else if(this.isDHL.test(this.trackNum)) this.trackNumHref = `http://www.dhl.com/en/express/tracking.html?AWB=${this.trackNum}&brand=DHL`;
        else if(this.isCAPost.test(this.trackNum)) this.trackNumHref =`https://www.canadapost.ca/trackweb/en#/search?searchFor=${this.trackNum}`;
        else this.trackNumHref = null; // Google search as fallback... `https://www.google.com/search?q=${this.trackNum}`;
    }

} 
```

组件 .HTML

```
<a *ngIf="trackNumHref" [href]="trackNumHref" target="_blank">{{trackNum}}</a>
<span *ngIf="!trackNumHref">{{trackNum}}</span> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-27T04:55:00.793

我在我编写的 eBay 应用程序中使用这些：

**美国邮政国内：**

```
/^91[0-9]+$/ 
```

**美国邮政国际：**

```
/^[A-Za-z]{2}[0-9]+US$/ 
```

**联邦快递：**

```
/^[0-9]{15}$/ 
```

但是，这可能是 eBay/Paypal 特定的，因为所有 USPS 国内标签都以“91”开头。所有 USPS International 标签均以两个字符开头并以“US”结尾。据我所知，联邦快递只使用 15 个随机数字。

（请注意，这些正则表达式假定所有空格都已删除。但允许空格相当容易）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-02-25T23:33:53.897

查看这个 github 项目，其中列出了许多 PHP 跟踪正则表达式。 [https://github.com/darkain/php-tracking-urls](https://github.com/darkain/php-tracking-urls)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-06-03T01:45:36.073

这是我现在在我的 Java 应用程序中使用的那些。这些是由我从一大堆托运服务中提取运输确认电子邮件中的跟踪号码的经验决定的。我刚刚从头开始制作了一个新的 USPS，因为根据 USPS 网站上的示例号码，我发现没有一个适用于我的一些号码。这些仅适用于美国跟踪代码，因为我们只在美国销售。

```
private final Pattern UPS_TRACKING_NUMBER =
    Pattern.compile("[^A-Za-z0-9](1Z[A-Za-z0-9]{6,})",
        Pattern.CASE_INSENSITIVE | Pattern.MULTILINE);

private final Pattern FEDEX_TRACKING_NUMBER =
    Pattern.compile("\\b((96|98)\\d{18,20}|\\d{15}|\\d{12})\\b",
        Pattern.MULTILINE);

private final Pattern USPS_TRACKING_NUMBER =
    Pattern.compile("\\b(9[2-4]\\d{20}(?:(?:EA|RA)\\d{9}US)?|(?:03|23|14|70)\\d{18})\\b",
        Pattern.CASE_INSENSITIVE | Pattern.MULTILINE); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-07-27T12:21:07.813

这是一个很好的资源，它涵盖了几乎所有的可能性，并且和我发现的一样紧凑：

[https://andrewkurochkin.com/blog/code-for-recognizing-delivery-company-by-track](https://andrewkurochkin.com/blog/code-for-recognizing-delivery-company-by-track)

```
 string[] upsPattern = new string[]
    {
        "^(1Z)[0-9A-Z]{16}$",
        "^(T)+[0-9A-Z]{10}$",
        "^[0-9]{9}$",
        "^[0-9]{26}$"
    };

    string[] uspsPattern = new string[]
    {
        "^(94|93|92|94|95)[0-9]{20}$",
        "^(94|93|92|94|95)[0-9]{22}$",
        "^(70|14|23|03)[0-9]{14}$",
        "^(M0|82)[0-9]{8}$",
        "^([A-Z]{2})[0-9]{9}([A-Z]{2})$"
    };

    string[] fedexPattern = new string[]
    {
        "^[0-9]{20}$",
        "^[0-9]{15}$",
        "^[0-9]{12}$",
        "^[0-9]{22}$"
    }; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-02-27T19:50:58.057

我相信联邦快递是 12 位数字：

```
^[0-9]{12}$ 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-05-10T14:17:16.217

我最近还发现了 FedEx 的 22 位跟踪号码，所以要小心！对于 FedEx 的一般格式，我还没有找到任何好的参考资料。

联邦快递示例 #：9612019059803563050071

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-07-09T21:43:07.890

这是 UPS 的最新正则表达式。它适用于标准和 Mail Innovation 类型的跟踪号码：

```
\b(1Z ?[0-9A-Z]{3} ?[0-9A-Z]{3} ?[0-9A-Z]{2} ?[0-9A-Z]{4} ?[0-9A-Z]{3} ?[0-9A-Z]|[\dT]\d\d\d ?\d\d\d\d ?\d\d\d|\d\d\d ?\d\d\d ?\d\d\d|\d{22,34})\b 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-03-13T10:36:16.477

//UPS - 联合包裹服务最终字符串 UPS = "\b(1Z ?[0-9A-Z]{3} ?[0-9A-Z]{3} ?[0-9A-Z]{2} ? [0-9A-Z]{4} ?[0-9A-Z]{3} ?[0-9A-Z]|T\d{3} ?\d{4} ?\d{3})\ b";

//USPS - 美国邮政服务 - 格式 1 final String USPS_FORMAT1 = "\b((420 ?\d{5} ?)?(91|92|93|94|01|03|04|70|23|13 )\d{2} ?\d{4} ?\d{4} ?\d{4} ?\d{4}( ?\d{2,6})?)\b";

//USPS - 美国邮政服务 - 格式 2 最终字符串 USPS_FORMAT2 = "\b((M|P[AZ]?|D[CZ]|LK|E[AC]|V[AZ]|R[AZ]| CP|CJ|LC|LJ) ?\d{3} ?\d{3} ?\d{3} ?[AZ]?[AZ]?)\b";

//USPS - 美国邮政服务 - FORMAT 3 final String USPS_FORMAT3 = "\b(82 ?\d{3} ?\d{3} ?\d{2})\b";

//FEDEX - 联邦快递最终字符串 FED_EX = "\b(((96\d\d|6\d)\d{3} ?\d{4}|96\d{2}|\d{4} ) ?\d{4} ?\d{4}( ?\d{3})?)\b";

//ONTRAC 最终字符串 ONTRAC = "\b(C\d{14})\b";

//DHL final String DHL = "\b(\d{4}[-]?\d{4}[-]?\d{2}|\d{3}[-]?\d{8}| [AZ{3}\d{7})\b";

```
 Sample tracking number 
    UPS        
    //"1Z 999 AA1 01 2345 6784"  
    Fed-ex
    // "449044304137821"
    USPS
    //"9400 1000 0000 0000 0000 00"

    final Pattern pattern = Pattern.compile(DHL, Pattern.CASE_INSENSITIVE | 
     Pattern.UNICODE_CASE);
    final Matcher matcher = pattern.matcher("1Z 999 AA1 01 2345 6784");

    if (matcher.find()) {
        System.out.println(true + "");
    } 
```

它在java和android中工作。 [https://regex101.com/](https://regex101.com/) 您可以通过此链接将您的正则表达式更改为另一种语言的正则表达式并生成代码。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-09-06T18:49:10.070

我知道已经有很多答案，而且很久以前就有人问过这个问题，但我没有看到一个可以用一个表达式解决所有可能的 USPS 跟踪号的答案。

这是我想出的：

```
((\d{4})(\s?\d{4}){4}\s?\d{2})|((\d{2})(\s?\d{3}){2}\s?\d{2})|((\D{2})(\s?\d{3}){3}\s?\D{2}) 
```

看到它在这里工作：[http ://regexr.com/3e61u](http://regexr.com/3e61u)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-01-25T23:20:38.310

然而，迟到的聚会，下面的内容也适用于 26 个字符的 USPS 号码。

```
/(\b\d{30}\b)|(\b91\d+\b)|(\b\d{20}\b)|(\b\d{26}\b)|^E\D{1}\d{9}\D{2}$|^9\d{15,21}$|^91[0-9]+$|^[A-Za-z]{2}[0-9]+US$/i 
```

# unix - 如何将参数（即二进制文件名称）传递给 Emacs gdb 命令？

> ID：619979
> 
> 赞同：1
> 
> 时间：2009-03-06T18:46:14.087
> 
> 标签：unix, emacs, gdb

现在，我已将 F5 设置为在 emacs 中为我启动 gdb：

（全局设置键 [f5] 'gdb）

这将切换到迷你缓冲区，然后我输入一个可执行文件的路径......我想找到一种方法来绕过这个路径输入......

我编写了一个可执行文件，它查看 Makefile，解析它并找出可执行文件的完整路径并将其打印到标准输出......是否可以从我的 .emacs 调用它......然后以某种方式将输出传递给gdb 命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T20:11:30.823

```
(defun gdb-getpath ()
  "Figures out the path to executable and launches gdb."
  (interactive)
  (let ((path (shell-command-to-string "/path/to/your/executable")))
    (gdb (concat "gdb " path))
    ))

(global-set-key [f5] 'gdb-getpath) 
```

# java - how does one go about copying one xml document's node to another?

> ID：619982
> 
> 赞同：5
> 
> 时间：2009-03-06T18:46:39.030
> 
> 标签：java, xml

I'm trying to insert an element node (that has some children) from one XML into another in java.

What I'm trying (which isn't working) looks like this...

```
Node foo = document1.getChildNodes().item(3).cloneNode(true);

document2.getChildNodes().item(2).appendChild(foo); 
```

I'm getting an exception that complains that i'm trying to use a node created by one document in another.

Is there an alternative, short of recursing through doc1's node and creating the whole thing manually in doc2?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-06T18:53:51.150

I hate asking questions, thinking I've hit a wall, and then suddenly just stumbling on the answer that was there in front of me the whole time!

document.importNode() does the trick nicely.... thanks me! :)

# php - 这个 PHP 代码有多危险？

> ID：619991
> 
> 赞同：3
> 
> 时间：2009-03-06T18:51:42.187
> 
> 标签：php, security, sql-injection

这个 php 代码有多危险？可以做些什么呢？

```
$name = $_POST["user"];
$pwd = $_POST["pwd"];
$query = "SELECT name,pwd FROM users WHERE name = '$name' AND pwd = '$pwd'"; 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-06T18:55:26.247

可能的问题：

1.  SQL 注入
2.  XSS 注入（如果此代码是插入查询，那将是一个明确的问题）
3.  纯文本密码

您的 SQL 语句可能有问题。让自己为 SQL 注入敞开心扉是不好的做法。

[SQL 注入很糟糕](http://en.wikipedia.org/wiki/SQL_injection)。相信我。

如果您想在 HTML 页面上显示 $user ，那么您可能不想让人们通过键入以下命令来“破解”您的布局

```
<H1>HI MOM</H1> 
```

或一堆[javascript](http://en.wikipedia.org/wiki/Cross-site_scripting)。

此外，永远不要以纯文本形式存储您的密码（很好，抓住 cagcowboy！）。它为管理（或破解）您的数据库的人提供了太多的权力。您永远不需要知道某人的密码。

尝试以下策略：

```
// mostly pulled from http://snippets.dzone.com/posts/show/2738
function MakeSafe($unsafestring) 
{
    $unsafestring= htmlentities($unsafestring, ENT_QUOTES);

    if (get_magic_quotes_gpc()) 
    { 
        $unsafestring= stripslashes($unsafestring); 
    }

    $unsafestring= mysql_real_escape_string(trim($unsafestring));
    $unsafestring= strip_tags($unsafestring);
    $unsafestring= str_replace("\r\n", "", $unsafestring);

    return $unsafestring;
} 

// Call a function to make sure the variables you are 
// pulling in are not able to inject sql into your 
// sql statement causing massive doom and destruction.

$name = MakeSafe( $_POST["user"] );
$pwd = MakeSafe( $_POST["pwd"] );

// As suggested by cagcowboy: 
// You should NEVER store passwords decrypted.
// Ever.  
// sha1 creates a hash of your password
// pack helps to shrink your hash
// base64_encode turns it into base64
$pwd = base64_encode(pack("H*",sha1($pwd))) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-06T19:35:51.830

这很危险： ![xkcd 鲍比桌](https://imgs.xkcd.com/comics/exploits_of_a_mom.png)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-06T18:55:41.037

除了 SQL 注入之外，看起来您的密码可能以纯文本形式存储，这不是很好。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-06T18:57:55.430

如果您从不将 $query 传递给 SQL 数据库，那么该代码是非常安全的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-06T19:02:25.997

如果有人要发布`0';drop table users;--`一个名字

你的命令最终会是

```
select name, pwd form users where name='0'; 
drop table users; --'and pwd = '[VALUE OF PWD]' 
```

所以首先它会获取你的数据，然后杀死你的用户表，其余的什么都不做，因为它是一个评论。

php 中的某些 mysql 命令在传递 sql 时会执行多个查询，避免这种情况的最佳方法是参数化查询。

我使用 PDO 进行所有数据库访问，并强烈推荐它。我没有任何链接，但我记得我使用的教程超过了谷歌。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-06T19:03:23.157

它不仅容易发生 SQL 注入，而且在甚至不打算注入的情况下也会失败：

例如，用户想要名称“Guillaume François Antoine, Marquis de L'Hospital”。由于用户名包含引号并且您没有转义它，因此您的查询将失败，尽管用户从不想破坏系统！

要么使用[PDO](http://php.net/PDO) ，要么以这种方式进行：

```
$query = sprintf(
                   "SELECT 1 FROM users WHERE name = '%s' AND password = '%s'",
                   mysql_real_escape_string($_POST['name']),
                   mysql_real_escape_string(md5($_POST['password']))
                 );
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-06T19:27:23.487

信不信由你，这是安全的……如果`magic_quotes_gpc`打开的话。它永远不会出现在 PHP6 中，因此在此之前修复它是个好主意。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-06T20:20:45.840

1.  `$_POST['user'] = "' or 1=1; --";` 任何人都可以即时访问您的应用

2.  `$_POST['user'] = "'; DROP TABLE user; --";` 吻你的（付费？）用户列表再见

3.  如果您稍后在输出中回显 $name，则可能导致 XSS 注入攻击

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-06T18:55:43.127

:O 永远不要这样做，这可能会导致 SQLInjection 攻击。例如，如果用户以某种方式输入： **' drop table users --** as input in $username; 此代码将连接到您的原始代码并删除您的表格。黑客可以做更多事情，并且可以入侵您的网站。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-06T18:56:48.350

这通常是非常危险的。在某些情况下，它可以通过数据库权限来缓解。

您不验证输入（$name 和 $pwd）。用户可以在其中一个或两个字段中发送 SQL。SQL 可以删除或修改数据库中的其他数据。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-06T18:58:53.040

非常非常危险。密码的一个好主意是将密码转换为 MD5 哈希并将其存储为用户的“密码”。
1) 保护用户免于密码被盗 2) 如果用户写入恶意字符串，他们可能会清除您的条目/表/数据库

此外，您应该对名称做一些基本的匹配正则表达式，以确保它只使用 A-Za-z0-9 和一些重音字符（特别是没有特殊字符，*'s，<'s，>'s） .

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-06T18:59:57.517

它不安全，您可能想研究 PDO 之类的东西。 [PHP PDO](http://ca.php.net/pdo)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-06T19:35:02.533

当 SQL 查询中涉及用户数据时，始终使用[`mysql_real_escape_string`](http://docs.php.net/mysql_real_escape_string).

此外，您应该只存储密码的加盐哈希而不是密码本身。您可以使用以下函数生成并检查具有随机盐值的盐化哈希：

```
function saltedHash($data, $hash=null)
{
    if (is_null($hash)) {
        $salt = substr(md5(uniqid(rand())), 0, 8);
    } else {
        $salt = substr($hash, 0, 8);
    }
    $h = $salt.md5($salt.$data);
    if (!is_null($hash)) {
        return $h === $hash;
    }
    return $h;
} 
```

全部一起：

```
$query = 'SELECT pwd FROM users WHERE name = "'.mysql_real_escape_string($_POST['user']).'"';
$res = mysql_query($query);
if (mysql_num_rows($res)) {
   $row = mysql_fetch_assoc($res);
   if (saltedHash($_POST["pwd"], $row['pwd'])) {
       // authentic
   } else {
       // incorrect password
   }
} else {
   // incorrect username
} 
```

# c# - NHibernate 中的映射问题

> ID：619994
> 
> 赞同：2
> 
> 时间：2009-03-06T18:53:12.913
> 
> 标签：c#, .net, nhibernate, orm, mapping

我有以下课程：

```
public class Customer
{
    public virtual int CustomerID { get; protected set; }
    public virtual string AccountNumber { get; protected set; }
    public virtual string CustomerType { get; set; }
    public virtual int TerritoryID { get; set; }
    public virtual SalesTerritory Territory { get; protected set; }
} 
```

它正在使用 Fluent NHibernate 进行映射，如下所示：

```
 public class CustomerMapper : ClassMap<Customer>
{
    private const string schema = "Sales";
    public CustomerMapper()
    {
        SchemaIs(schema);
        Id(x => x.CustomerID);
        Map(x => x.CustomerType).WithLengthOf(1).Not.Nullable();
        Map(x => x.TerritoryID).Not.Nullable();

        Map(x => x.AccountNumber).ReadOnly()
            .Update(false)
            .Insert(false)
            .Generated(Generated.Insert);

        References<SalesTerritory>(x => x.Territory).TheColumnNameIs(ReflectionHelper.GetProperty<Customer>(x => x.TerritoryID).Name).LazyLoad().Update(false).Insert(false);
    }
} 
```

Update 和 Insert 方法只是在生成的映射文件中设置属性的***更新***和***插入***属性的扩展方法。

这是生成的映射文件的外观：

```
<?xml version="1.0" encoding="utf-8"?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" default-lazy="true" assembly="Model" namespace="Model" schema="Sales">
    <class name="Customer" table="`Customer`" xmlns="urn:nhibernate-mapping-2.2">
        <id name="CustomerID" column="CustomerID" type="Int32">
            <generator class="identity" />
        </id>
        <property name="AccountNumber" column="AccountNumber" insert="false" update="false" generated="insert" length="100" type="String">
            <column name="AccountNumber" />
        </property>
        <property name="TerritoryID" column="TerritoryID" not-null="true" type="Int32">
            <column name="TerritoryID" />
        </property>
        <property name="CustomerType" column="CustomerType" not-null="true" length="1" type="String">
            <column name="CustomerType" />
        </property>
        <many-to-one lazy="proxy" update="false" insert="false" name="Territory" column="TerritoryID" />
    </class>
</hibernate-mapping> 
```

我的问题是，当将新客户实例保存到数据库中时，客户实例的 Territory 属性为空。
保存到数据库后，如何使此属性包含正确的值？我正在查看类似于在刷新会话后检索正确值的属性的***生成***属性。
或者我的客户类有什么问题吗？
提前致谢。

**编辑 1：**我用于此模型的数据库是 AdventureWorks (SQL2005)，表 Sales.Customer 和 Sales.SalesTerritory。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-07T00:03:57.597

更明智的映射如下：

```
public class CustomerMapper : ClassMap<Customer>
{
    private const string schema = "Sales";
    public CustomerMapper()
    {
        SchemaIs(schema);
        Id(x => x.CustomerID);
        Map(x => x.CustomerType).WithLengthOf(1).Not.Nullable();
        Map(x => x.AccountNumber).ReadOnly()
           .Generated(Generated.Insert);
        References(x => x.Territory).LazyLoad();
    }
} 
```

几点：

*   这算作一个映射的 SalesTerritory 类。
*   TerritoryID 不是必需的。
*   如果您使用 Insert(false) 和 Update(false)，这些属性将不会保存到数据库中。ReadOnly() 同时执行 Insert(false) 和 Update(false)。
*   CostumerType 完全可以是一个枚举。

这或多或少是一个想法（空气代码）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T19:11:04.447

我认为您的映射很奇怪...... regionId 属性与 Territory 属性的关系是什么？在多对一映射中，您映射 Territory 属性，您不必指定 Territory 的类型吗？（销售区域）。您将 2 个属性映射到同一列，为什么？

# coldfusion - ColdFusion CFC 最佳/推荐实践的集合？

> ID：619998
> 
> 赞同：9
> 
> 时间：2009-03-06T18:54:13.973
> 
> 标签：coldfusion, cfc

我一直在建立一个 CFC 最佳实践列表以供分享。

那里有很多文章，但我认为将通过经验学到的任何技巧和技巧集中在一个地方可能会很巧妙。

我将在此处添加一些链接以使其继续进行，但我认为最好的方法不是可以在 Google 上搜索到的长文章。

[CFC 最佳实践](http://dintenfass.com/cfcbestpractices/)

[Macromedia CFC 最佳实践](http://www.adobe.com/devnet/coldfusion/articles/cfc_practices.html)

**更新：这已成为社区 wiki**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-08T23:29:18.727

[O'Reilly 开发 ColdFusion 组件的十大技巧](http://oreilly.com/pub/a/javascript/2003/09/24/coldfusion_tips.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T18:36:27.173

四件快事：

1.  加入[CFCDev 邮件列表](http://groups.google.com/group/cfcdev)（或现在的 google 群组）。

2.  Sean Corfield 的 CFML 演示文稿[中的设计模式 PDF是一个很好的快速阅读。](http://corfield.org/articles/DesignPatterns.pdf)

3.  [http://www.cfdesignpatterns.com](http://www.cfdesignpatterns.com)有一些好东西，其中包含指向优质 CFC 设计文章的链接。

4.  Rob Brooks-Bilson 博客上关于 CFML 中的[设计模式的文章。](http://www.brooks-bilson.com/blogs/rob/index.cfm?mode=entry&entry=199625AA-A36C-8B2D-3FCA85395D0C93C6)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T21:08:21.873

在使用[ColdBox 框架](http://www.coldboxframework.com)之前，我没有看到任何关于使用 Momentos 捕获属性的帖子。但是，现在我所有的 bean 都有一个 getMomento() 和 setMomento() 方法。对于需要将信息从 bean 传递到 DAO 其他对象的任何人，我会鼓励将此作为最佳实践。

在我的测试中，获得一个时刻比传递 bean 并获得属性要快得多。这是一个例子：

```
<cfcomponent name="userBean" output="true" hint="The account bean holds getter/setter information for a user's account.">

<cfproperty name="idUser"           required="true"     type="string"   rules="noZeroLengthString,validEmail"       invalidMessage="failed_data_validation_email"               hint="Key matching the 'accounts' table.">
<cfproperty name="loginEmail"       required="true"     type="string"   rules="noZeroLengthString,validEmail"       invalidMessage="failed_data_validation_email"               hint="E-mail address.">
<cfproperty name="password"         required="true"     type="string"   rules="noZeroLengthString,validPassword"    invalidMessage="failed_data_validation_password"            hint="Password stored in a SHA-512 hash.">

<cffunction name="init" output="false" returntype="userBean" hint="Initalizes the userBean with default values.">
    <cfset variables.instance               = structNew()>
    <cfset variables.instance.IDUser        = 0>
    <cfset variables.instance.loginEmail    = "">
    <cfset variables.instance.password      = "">
    <cfreturn this>
</cffunction>

<!--- SET LOGIN --->
<cffunction name="setLoginEmail" access="public" returntype="void" output="false">
    <cfargument name="email" type="string" required="true" />
    <cfset variables.instance.loginEmail = trim(arguments.email) />
</cffunction>
<cffunction name="getLoginEmail" access="public" returntype="string" output="false">
    <cfreturn variables.instance.loginEmail />
</cffunction>

<!--- ID --->
<cffunction name="setIDUser" access="public" returntype="void" output="false">
    <cfargument name="id" type="numeric" required="true" />
    <cfset variables.instance.IDUser = arguments.id />
</cffunction>
<cffunction name="getIDUser" access="public" returntype="numeric" output="false">
    <cfreturn variables.instance.IDUser />
</cffunction>

<!--- PASSWORD --->
<cffunction name="setPassword" access="public" returntype="void" output="false">
    <cfargument name="password" type="string" required="true" />
    <cfset var pw = arguments.password>
    <cfif len(pw) EQ 0>
        <cfset variables.instance.password = "">
    <cfelse>
        <!---><cfset variables.instance.password = hash(arguments.password, "SHA-512") />--->
        <cfset variables.instance.password = arguments.password>
    </cfif>
</cffunction>
<cffunction name="getPassword" access="public" returntype="string" output="false">
    <cfreturn variables.instance.password />
</cffunction>

<!--- MOMENTO --->
<cffunction name="setMomento" access="public" returntype="void" output="false">
    <cfargument name="momento" type="struct" required="true" />
    <cfset variables.instance = arguments.momento>
</cffunction>
<cffunction name="getMomento" access="public" returntype="struct" output="false">
    <cfreturn variables.instance />
</cffunction> 
```

干杯，

亚伦格林利 [我的网站](http://www.aarongreenlee.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-24T16:45:42.690

[ColdBox 开发最佳实践](http://wiki.coldbox.org/wiki/DevelopmentBestPractices.cfm)********************