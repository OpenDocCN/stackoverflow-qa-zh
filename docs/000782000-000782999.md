# StackOverflow 问答 000782000-000782999

# windows - 强大的事件记录

> ID：782000
> 
> 赞同：1
> 
> 时间：2009-04-23T14:26:27.037
> 
> 标签：windows, logging

对我来说，这似乎是一个比那些已经问过的问题更具体的问题，所以：如果我正在寻找“即发即弃”的日志服务，Windows 事件日志服务的可靠性如何，因此调用该服务时甚至会出错不会影响调用者，并且以某种方式被操作系统注意到？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T19:08:24.303

在 Windows 端，事件日志很好。被这么多应用程序使用了这么久，它绝对是稳定的。我敢肯定，您可以通过提供足够糟糕的输入来找到使 API 崩溃的创造性方法，但对于每个 API，这可能都是正确的。如果使用得当，它会起作用。

话虽如此，您通常不会在“即发即弃”的上下文中使用事件日志。请记住，它是系统全局日志，应该由管理员阅读。喂给太多事件，从管理员的角度来看，它将变得毫无用处。如果您确实很少使用它并且仅用于重要事件，您可以花时间确保您的输入是有效的，并且没有异常传播回您的主要逻辑。

最后，如果您正在寻找真正的“即发即弃”的日志基础架构，请查看[ETW](http://msdn.microsoft.com/en-us/magazine/cc163437.aspx)，它是内置于 Windows 中的高性能事件跟踪基础架构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T14:34:32.913

根据我的经验，我从来没有遇到过事件服务的程序问题。我确实遇到过一次问题，但这是由我商店的平台“大师”引起的 4201（？）“拒绝访问”错误。但从来没有任何关于任何使用或 API 调用的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T15:05:39.767

Windows 事件日志在实践中对我们很有效。我们在稳定性方面遇到的唯一问题是在 NT4 时代，并且在实践中早已不复存在。只要确保您不会重复地用相同的事件淹没它，否则实际上看会变得很痛苦；）

# .net - 从 DataGridView 中删除选定的行

> ID：782001
> 
> 赞同：1
> 
> 时间：2009-04-23T14:26:37.533
> 
> 标签：.net, winforms

我有一个绑定到对象集合的 DataGridView。

我想在表单上创建一个删除按钮，以便用户可以删除选定的行。

但是如果选择了新行（网格中特殊的最后一行），就会出现问题。如果我选择新行然后尝试单击删除按钮，网格将失去焦点并更改所选行！它使最后一行被选中（新行之前的那一行）。所以在删除按钮处理程序中，已经选择了另一行，而不是新行！

除了隐藏那个特殊的新行（AllowUserToAddRows = false）并为它制作自己的“添加”按钮和代码之外，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T14:35:28.700

You could disable the Delete button when an invalid row (ie the special new row) is selected

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-16T08:38:01.553

Private Sub btnDelete_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 处理 btnDelete.Click

```
 Dim gr As New DataGridViewRow
    For Each gr In DataGridView1.SelectedRows
        ds.Tables(0).Rows(gr.Index).Delete()
    Next
    ds.AcceptChanges() ' Accept Changes
    DataGridView1.Rows.Clear()
    lbltest.Text = ""
    calldata(ds) ' this function is as follow
    'Public Function calldata(ByRef DS As DataSet)
    '    Dim i As Integer = 0
    '    Dim dr As DataRow
    '    Dim dc As DataColumn
    '    For Each dr In DS.Tables(0).Rows  'dt.Rows
    '        Dim j As Integer = 0
    '        DataGridView1.Rows.Add()
    '        For Each dc In DS.Tables(0).Columns 'dt.Columns
    '            DataGridView1.Rows(i).Cells(j).Value = dr(dc).ToString()
    '            lbltest.Text = lbltest.Text & " : " & dr(dc).ToString()
    '            j = j + 1
    '        Next
    '        i = i + 1
    '    Next

    'End Function
    ' the above code only update your dataset not actual data
End Sub 
```

# xna - XNA 项目 - 谁负责绘图？

> ID：782006
> 
> 赞同：3
> 
> 时间：2009-04-23T14:27:08.173
> 
> 标签：xna

我只是在玩 XNA，我需要在每一帧中绘制几个不同的模型。目前，Game 对象持有对我所有模型的引用，并一个接一个地绘制它们。每个人都有自己不同的绘画方式——一个有两个独立的纹理，另一个可能镜像到另一侧，等等。

我想知道是否可以只添加一个

`public void Draw(SpriteBatch spriteBatch)`

方法到我的所有模型（当然来自 BaseModel），并让每个类负责绘制自己，或者我应该坚持让类根据 Update 方法上的事件（KeyboardState）设置它们的数据，并保持Game 类中的所有图形逻辑。

有没有首选的方法来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T14:45:19.080

通常，我有一个基类，其中包含 BaseModel、纹理数据、旋转和缩放数据等。对于游戏中的每种类型的演员，我创建一个派生类。基类提供了一个 Draw 方法，默认情况下，该方法使用类中给出的纹理、旋转和缩放数据来绘制模型。派生类可以覆盖它以绘制他们喜欢的演员。

然后，我有一个 DrawableGameComponent 作为我的场景图。它包含所有活动参与者对象的列表。在组件的 Draw 和 Update 方法中，我遍历演员列表并调用他们的 Draw 和 Update 方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-24T13:42:00.647

这是接近它的一种方法……为了本文的完整性，我将重点介绍另一种方法。基本上，相反的观点指出，没有一个实体应该需要（或拥有）如何呈现自己的自定义知识。实体只是状态的集合......渲染器可以简单地查看该状态，并以正确的方式绘制它。

一个例子……假设你有很多船。有些跑得快，有些发射火箭，有些有卫星围绕它运行，它也可以发射。您的“实体”类可以具有以下属性

*   模型视觉表示
*   矩阵位置
*   实体[] 附加实体

然后，您的渲染器可以遍历您的通用“ `List<Entity>`”，并且

1.  使用位置绘制实体的视觉表示（即模型）
2.  循环遍历 AttachedEntities 并（递归地）绘制它们。

这显然是一个简化的例子……但是这样绘制逻辑完全包含在渲染代码中，并且只需要尽可能少地关注自己的信息。虽然船类可以专注于游戏逻辑本身（即我的飞行速度、我使用的武器、我的盾牌中有多少能量等）。

至于哪个是首选，真正的答案在于您的项目要求，以及您觉得舒服的内容。不要在制作游戏之前尝试制作游戏引擎……只要尽一切努力制作你的游戏，然后*也许你可以提取在你发布游戏**后*工作的组件:-P

# iphone - 在 iphone 上安装应用程序会覆盖最后一个应用程序

> ID：782009
> 
> 赞同：1
> 
> 时间：2009-04-23T14:27:31.043
> 
> 标签：iphone, installation

当我在 iphone 上安装新应用程序时，当前应用程序会覆盖上一个应用程序，因此我们无法维护以前的应用程序。

请帮忙解决这个安装问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T15:20:38.890

如果您更改 info.plist 中的应用标识符，您可以同时在手机上拥有不同的版本...

然而，你真的想这样做吗？大多数应用程序通过加载新版本进行迁移，然后更新旧数据库或首选项以使用新版本的应用程序。仅仅因为您的应用程序被替换并不意味着用户创建的数据被替换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T00:09:48.243

如果您在构建设置中更改产品名称，则会直接影响 .app 包的名称。您可以拥有同一个应用程序的两个副本，只要它们具有不同的名称 - 这有助于在测试新版本的同时保留旧的稳定版本。

正如 Kendall 所说，您可能希望对同一应用程序的较新**发布**版本使用相同的名称。

# sql-server - DBCC CHECKIDENT——模式感知？

> ID：782011
> 
> 赞同：23
> 
> 时间：2009-04-23T14:27:52.650
> 
> 标签：sql-server, schema

我有一个不同的模式（除了 dbo），我在其中创建了一个表，模式“化学”。

我已经尝试了这个 DBCC CHECKIDENT 的 4 种不同的变体，它们都带回了相同的错误：

“'.' 附近的语法不正确”

我试过了：

```
DBCC CHECKIDENT (Chemical.[Products], RESEED, 0)

DBCC CHECKIDENT (Chemical.Products)

DBCC CHECKIDENT ([Chemical].[Products])

DBCC CHECKIDENT (Chemical.Products, RESEED, 0) 
```

是模式感知还是我错过了什么？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-23T14:32:23.403

您可以用单引号或方括号括起来。两者都有效。

```
DBCC CHECKIDENT ('Chemical.Products', RESEED, 0)
DBCC CHECKIDENT ([Chemical.Products], RESEED, 0) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-23T14:30:28.680

尝试用单引号括起来

```
DBCC CHECKIDENT ('Chemical.Products', RESEED, 0) 
```

# php - 如何使用带有 PHPUnit 数据库的 MDB2 进行多项测试？

> ID：782013
> 
> 赞同：1
> 
> 时间：2009-04-23T14:28:25.267
> 
> 标签：php, phpunit, pear, mdb2

我使用 PHPUnit 数据库来测试一些使用 MDB2 的类。

一切都很好，因为我遇到了第二个测试，它返回一个错误：

> 捕获的异常：MDB2_Error 类的对象无法转换为字符串

当我用第二个测试代替第一个时，新的第一个测试是可以的，但第二个返回相同的错误！还有接下来的！

也许在第一次测试后 MDB2 连接关闭了？

这是我的构造函数：

```
public function __construct()
{
    $this->pdo = new PDO('connectionstring', 'user', 'passwd');
    try {
        $this->mdb2 = new MyDBA($this->dsn);
    }
    catch (Exception $e) {
        error_log(' __construct Caught exception: '.$e->getMessage());
    }
} 
```

MyDBA 返回一个单例。构造函数内部没有引发异常......

这是前两个测试：

```
public function testTranslationAdd()
{
    try {
        $id = $this->mdb2->addTranslation("This is the second english translation.","en");
    }
    catch (Exception $e) {
        error_log(' testTranslationAdd Caught exception: '.$e->getMessage());
    }

    $xml_dataset = $this->createFlatXMLDataSet(dirname(__FILE__).'/state/twotranslations.xml');
    $this->assertDataSetsEqual($xml_dataset,
                               $this->getConnection()->createDataSet(array("translation")));
}

public function testTranslationGet()
{
    try {
        $text = $this->mdb2->getTranslation(1,"en");
    }
    catch (Exception $e) {
        error_log(' testTranslationGet Caught exception: '.$e->getMessage());
    }

    $this->assertEquals("This is the first english translation.",$text);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-12-02T09:09:50.397

你真的应该添加断言你的 mdb2 结果没有错误：

```
$this->assertFalse(MDB2::isError($this->mdb2), 'MDB2 error'); 
```

不幸的是，这并没有给你任何提示错误是什么，`getMessage()`如果你没有错误，直接在断言中使用会严重失败。这就是为什么你应该这样写一些东西：

```
if (MDB2::isError($this->mdb2)) {
    $this->fail('MDB2 error: ' . $this->mdb2->getMessage());
} 
```

# c# - 有必要了解代码访问安全（CAS）吗？

> ID：782020
> 
> 赞同：4
> 
> 时间：2009-04-23T14:30:42.063
> 
> 标签：c#

是否有必要了解 C# 桌面应用程序开发的代码访问安全性 (CAS)。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T14:46:01.997

这是一个相当广泛的问题，答案取决于很多事情。然而，最重要的两个因素是您的目标环境和部署方法。

大多数消费者软件都使用安装程序 (MSI) 安装，并在目标计算机上获得完全信任。如果这是您的环境和交付方法，您可能永远不需要学习或掌握代码访问安全性。另一方面，企业客户通常希望对软件能做什么和不能做什么有更多的控制。代码访问安全性为 IT 提供了锁定应用程序的能力，以及他们可以断言所安装机器的控制权。因此，如果您正在为 Enterprise 构建，可能需要了解 CAS。

无论您的目标市场是什么，您如何部署应用程序都可能需要您了解 CAS。默认情况下，XBAP 应用程序不是完全信任的，需要大量步骤才能提升到完全信任。Click-Once 部署的应用程序也不是完全信任的，但可以更轻松地提升到完全信任。因此，如果您计划使用这两种方法中的任何一种来部署软件，您可能需要了解 CAS。

最后，根据定义，Silverlight 作为一个平台并不是完全信任的。事实上，它永远不可能是完全信任的。这不是 CAS 问题，因为深入了解 CAS 无法帮助您克服 Silverlight 不包含执行完全信任活动所需的代码这一事实。但是，我在此处包含 Silverlight 的原因是，在了解平台设计中存在的一些安全限制时，对 CAS 的良好理解可能会派上用场。

希望有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T14:35:06.827

是的，如果您想获得 MCPD。在现实世界中，我从来不需要它。我为政府写申请，他们对安全性非常严格，他们从来没有要求过。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T14:32:38.970

这不是必需的，但它肯定有助于使您的应用程序更安全。对方法的隐式声明使您的意图清晰。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T14:36:24.827

呃，这是个好主意（我猜），但在现实生活中，只有当您尝试从网络驱动器部署或读取文件时，CAS 才会露出丑陋的一面。“学习”并不难，但我不会详述。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-23T14:37:37.010

桌面应用程序被认为是“完全信任”，完全信任应用程序永远不需要 CAS。

我在 .NET 1.0 发布后不久就买了一本关于它的书，我再也不会花时间读它了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-23T14:49:43.203

我从来没有真正遇到过需要代码访问安全的情况。这是获得 MCPD 或 MCSD（或任何新证书）的明确要求，但我认为更好的主意是在开始之前了解安全编码实践（配置加密、处理用户输入等）代码访问安全性。

# ruby-on-rails - 宝石减慢 Rails 测试启动，我可以选择性地禁用这些吗？

> ID：782021
> 
> 赞同：2
> 
> 时间：2009-04-23T14:30:44.060
> 
> 标签：ruby-on-rails, ruby, optimization, testing, startup

我有一个糟糕的 Rails 测试启动时间。在运行可能需要 2 秒才能运行的单个功能测试时，从执行到返回命令行的总时间可能长达 10-15 秒。

我知道有两颗宝石肯定会妨碍您。Facebook 和 Flickr 的瑰宝（Facebooker、Flickraw）。

运行任何测试时，Facebooker 将始终打印以下消息：

```
/vendor/gems/facebooker-0.9.5/lib/facebooker.rb:23: warning: already initialized constant VERSION 
```

Flickraw 似乎每次都在建立网络连接，以检索我认为它可以进行的 API 调用的列表。

我可以在测试期间选择性地关闭这些宝石吗？我真的很想让我的测试运行尽可能接近实际测试的运行时间。另外，我尝试了 rails_test_server gem 并且遇到了一些困难，因为这是一个非常大的项目，并且 gem 在项目中的某个地方遇到了一些我尚未解决的冲突。但我相信这个 Facebook 和 Flickr gem 问题应该在某个地方得到解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T15:29:18.277

你如何使用这些宝石？你在你的某个地方有需求`config/environment.rb`吗？如果是这样，您可以将这些要求添加到开发和生产环境文件中，但不能添加到测试环境文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T17:49:16.123

如果您能够在不加载所有 gem 的情况下运行您的应用程序，这可能很好地表明您一开始并没有真正使用 gem，或者您的测试不充分。

但是，是的，这样做的正确方法是将 gem 加载移动到开发和生产特定的环境文件中。

# .net - 您对 Microsoft 应用程序块的体验如何

> ID：782025
> 
> 赞同：7
> 
> 时间：2009-04-23T14:31:54.260
> 
> 标签：.net, frameworks

与编写自己的解决方案相比，您在使用 Microsoft 应用程序块和其他 Microsoft 解决方案方面的实际经验是什么？

我开始了一个新项目，并决定试一试。我使用了异常处理和日志记录块。异常处理块可以很好地满足我的需要。日志记录块完成了我需要的 95%，其余的需要自定义。花了一段时间研究如何自定义它，然后遇到了一些版本参考问题。记录是一项非常简单的任务，无论是写入文件还是数据库（在这个项目中都是）。事后看来，自己写会更快。

该项目还需要与 PDA 同步数据。通过一些研究，微软所指向的方向似乎很明确，即同步服务。在花了大约 3 天的时间尝试获得不同软件的所有正确版本后，我无法获得示例工作[Windows Mobile Synchronization Error](https://stackoverflow.com/questions/771357/windows-mobile-synchronization-error)。我选择使用简单的 OpenNETCF 桌面通信将文件复制到 pda 或从 pda 复制文件，使用二进制对象序列化，并编写我自己的基本同步代码，这花费了更少的时间，并且完全按照我想要的方式完成了所有事情（并且不觉得好的 ： ））

一些积极的方面：

*   不必重新发明轮子
*   受益于更新
*   受益于其他旨在与他们一起使用的工具
*   庞大的用户群增加了反馈、测试和稳健性
*   很高兴有你的简历
*   加入团队的新开发人员可能对他们很熟悉
*   提供大量可定制的功能

否定：

*   过度设计，尝试成为一把瑞士军刀，提供比以往任何时候都需要的功能更多的解决方案来创造复杂性。
*   即便如此，他们似乎永远无法满足项目的所有要求，最终可能会摇摆不定。我想这取决于您对应用程序的工作方式有多大的影响力。
*   需要学习如何正确实现应用程序块（好的，所以这只需要在第一次使用时完成，所以没什么大不了的）
*   增加了对不同 dll 版本的依赖，这与此有关
*   大而笨重（这些天不是真正的问题）
*   由于其复杂性而难以定制

这是我的学习经历，让我能够更好地决定是使用 Microsoft 解决方案（或其他 3rd 方解决方案）还是自己编写。

你的经历如何？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T14:42:31.927

它们**过度设计**，这是我最大的问题，最后我摆脱了它，不再使用它。

它们不够用，需要在系统中进行过多的配置和修改，并且它们不断地改变其中的内容。要简单地添加一个日志记录功能，您最终需要花费 2 天时间来完成它。

正如您所期望的那样，有一些图书馆可以在 10 分钟内工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T14:41:48.387

我没有太多使用它们，主要是因为其他更强大的东西已经让我摆脱了它。例如，在处理异常时，我使用了 CodePlex.Diagnostics，这是一个在 SQL Server 上记录内容的好包。对于一个网络应用程序来说非常简单和有用。对于日志记录，我在 Log4PostSharp 的控制下使用 log4net。当然，我使用 PostSharp 而不是 PIAB，只是因为根据定义，预编译比动态代理更快。

Unity 应用程序块是一件很酷的事情：它似乎吸取了其他 DI 框架的一些经验教训，并且实际上相当容易使用（当然，还有 PostSharp4Unity）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T14:38:55.353

我实际上并没有在实践中使用任何应用程序块，但我已经阅读了文档并查看了示例。在我看来，当必须非常快速地完成某件事时，它们可能是一个很好的资源，但除此之外，当 Microsoft 发布不一定按您希望的方式工作的更新时，这是一个让自己陷入困境的好方法。

我一直发现最好编写自己的日志记录和异常处理工具。这样，我可以根据我的应用程序的需要来决定添加和删除什么。至于重新发明轮子，这并没有让我很困扰。我宁愿按照我的规范构建一些东西，而不是使用按照我必须破解的一般编程社区的规范构建的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T15:07:07.547

数据访问和异常处理块（我只使用了 2 个）非常棒，如果您不寻找开箱即用的基本功能之外的任何东西。当然还有其他更强大的框架，但只需最少的配置和非常浅的学习曲线，您就可以立即启动并运行这两个模块。

而且由于它们使用工厂模式，因此如果您需要，它们很容易扩展。我们自定义了异常处理块以显示所有类型的 Active Directory 数据以及抛出的异常。它大大减少了我们的支持时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T15:16:15.030

您是否需要维护一个应用程序**？**检查 AB（或任何其他组件）是否可以帮助您，测试它们，如果它们通过集合，则使用它们，否则不能。

您是否有**大量且不断增长的应用程序**需要维护？然后，您将构建相同类型的代码来处理例如日志记录、身份验证和授权、远程通信和类似的重复问题（具体取决于您的业务和 IT 环境）；滚动您自己的代码或组件来解决问题（并维护它！）；或使用现成的东西。这些方法中的一种通常（如果不是总是）往往更适用于大量应用程序和公司内的工作轮换。猜猜哪个！（特别是，永远不要低估培训新的开发人员/维护人员在 2 年以上的应用程序中的生产力所花费的时间，这些应用程序与他们以前从事的其他工作没有相似之处或共享组件！）

我使用 MS 应用程序块是几年前的事了。当时异常处理块和数据库访问块帮了大忙；日志记录 AB 相当不错（尽管我更喜欢 log4net 的细粒度控制）；并且大多数当前的 AB 都不存在。我的观点是**AB 的解决了当前框架中的不足**。如果它们是成功的（并且真正解决了现有的痛点），您应该考虑它们可能会被转移到框架的未来版本中，或者语言和/或框架将被扩展以直接解决痛点。

代码本身永远不会过度设计或设计不足，仅用于特定目的。评估现成组件的最大挑战是找出实际目的是什么，而不是市场言论或过度乐观的拯救世界和厨房水槽宣言。MS 的[P&P 团队](http://msdn.microsoft.com/en-us/practices/default.aspx)似乎与产品开发团队相去甚远，偶尔会解决对最新产品版本洞察力不足[的错误问题......](http://apparchguide.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24681)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-24T09:24:50.110

我们使用 Unity 取得了一些成功。我一般反对 DI 容器，但如果你必须使用一个，Unity 就足够了。

我对其他大多数人不太相信。特别是日志库一直让我发疯。庞大且过度设计，但硬编码到某些特定（和简化）的场景，需要您重新实现大量代码以实际扩展具有一些相当明显的功能的库。除了绝对基础知识之外，文档还粗略地介绍了如何自定义和配置它。

我也没有在数据访问块中看到太多好处。

总的来说，我不是一个大粉丝。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T15:17:16.433

自 .NET 1.1 / 早期的 .NET 2.0 以来，我就没有使用过它们，而且数据的应用程序块非常有限。老实说，我最近没有真正考虑过使用任何东西，我应该看看他们目前有什么。

在实践中对我来说，编写自己的解决方案更容易。通常，我会看到一些非常具体的案例，我确实必须跳过一些障碍才能让事情按照我想要的方式工作。然后我又在做更多的 ASP.NET 东西（看起来一般 Web 开发有很多箍），我现在主要是 Windows 应用程序，这似乎更直接一些。

我认为这确实需要逐案处理。如果它适合您并满足您的需求，请使用现有的。当有完美可行的解决方案时，无需花时间重新创建某些东西。此外，除非您更改框架版本等，如果它们发布了新版本的 DLL，则没有理由必须更新。无论如何，以我的经验。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-24T09:38:53.197

我们正在使用日志记录、异常处理和验证块。

我对 logging AB 的体验与您的相似：它可以帮助您完成 95% 的工作。定制并不容易，并且会导致各种开销（更新、在未知领域进行测试……）。总的来说，我认为我自己的滚动不会更快，特别是因为配置选项非常方便（在开发过程中不是很多，但在部署时，我真的很喜欢编辑器并打开/关闭运行时过滤器等）。我确实围绕它写了一个小包装，因为我发现它提供了比我们需要的更多的选项（例如，单独的严重性/优先级 - 又有什么区别？等等）。

异常处理我们用了一小会儿，但把它扔掉了。最终我们认为这是太多的配置。app.config 中的配置有一个主要问题：它不是模块化的（即您不能轻易地合并来自不同来源的配置）。

验证：不是一个大粉丝。没有特别的原因，只是不太适用。

所以，最后，我们只真正使用了定制的 Logging AB。就整个事情的有用性得出你的结论；）

所以我同意 AB 并不是真正的*指导*——它们提供了广泛的选择，你需要自己决定如何使用它。

We've had bad experience using CAB (Composite UI AB). Unfortunately we're too far along to change it now, but if I would do the same project again, I wouldn't use CAB at all. It just doesn't seem to do quite what we need, so it's more in the way than anything else, and it obfuscates a lot of what's going on.

# visual-studio-2008 - 单击工具箱上的“选择项目”会使 Visual Studio 2008 崩溃

> ID：782032
> 
> 赞同：6
> 
> 时间：2009-04-23T14:33:40.310
> 
> 标签：visual-studio-2008, crash

我在这个上搜索了高低。我没有像许多解决方案所说的那样安装 PowerCommands 来删除它。

关于如何解决此问题的任何其他想法？

我正在运行 Vista Home 64 位，VS 2008 SP1

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-08-05T07:22:34.733

好的，这个问题有点老了，但为了完整起见：你不需要卸载任何东西。

[我在http://www.tech-archive.net/Archive/VisualStudio/microsoft.public.vsnet.ide/2008-03/msg00083.html](http://www.tech-archive.net/Archive/VisualStudio/microsoft.public.vsnet.ide/2008-03/msg00083.html)遇到了以下解决方案 ：

1.  使用以下命令从命令行启动 Visual Studio：devenv.exe /SafeMode
2.  使用通用过程将项目安装到工具箱（选择项目...）

vs 不应该那样崩溃。在没有 SafeMode 开关的情况下重新启动 Visual Studio 后，添加的项目仍然可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T14:36:04.330

一个一个地卸载/禁用 CodeRush 或所有其他插件，直到它工作正常。大多数时候，其中之一就是问题所在。

我和你有同样的设置，在我的情况下是 DxCore

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T14:37:18.227

对我来说是 Visual Studio 2008 Power Commands

**编辑**：我也遇到了另一个其他免费扩展的问题。我根本不记得另一个是哪个:(

**EDIT2**：我只记得，我安装了 SilverLight Tools 2 或 2 beta。这导致了这个问题。它还用旧版本搞砸了 DataAnnotations，并为我搞砸了 Entity Framework。最终不得不重新安装我的机器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-21T07:38:12.793

我通过向 devenv.exe.config 文件添加一些 XML 结构来解决这个问题，如下所述：

[http://code.msdn.microsoft.com/PowerCommands/WorkItem/View.aspx?WorkItemId=30](http://code.msdn.microsoft.com/PowerCommands/WorkItem/View.aspx?WorkItemId=30)

使用下面提到的 XML 代码`<!-NEW STUFF-->`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-30T08:23:27.283

有一个变通方法：将控件添加到 VS2010 的工具箱中。选择工具箱中的控件，右键单击->复制。转到VS2008，在工具箱中选择要添加此控件的选项卡，右键单击->粘贴。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-24T11:50:48.637

我卸载了 PowerCommands 和 SD 设计器。我能够选择项目。

# php - PHP：在继承链的每个对象的上下文中调用方法

> ID：782033
> 
> 赞同：2
> 
> 时间：2009-04-23T14:33:52.633
> 
> 标签：php

看下面的代码片段：

```
<?php

class A {
        function fn() {
                print 'Context: Class:' . get_class($this) 
                        . ' Parent:' . get_parent_class($this) . "\n";
                if(get_parent_class($this)) {
                        parent::fn();
                }
        }
}

class B extends A { }
class C extends B { }

$a = new A();
$c = new C();

$a->fn();

print "\n";

$c->fn();

?> 
```

通过运行它，您将获得以下输出：

```
Context: Class:A Parent:

Context: Class:C Parent:B

Fatal error: Cannot access parent:: when current class scope has no parent in /home/andrei/test/test.php on line 10 
```

我相信它应该是这样的：

```
Context: Class:A Parent:

Context: Class:C Parent:B
Context: Class:B Parent:A
Context: Class:A Parent: 
```

你怎么看？如果`get_parent_class($this)`返回一个非假值，我们是否应该安全地假设 parent:: 已定义？在什么类上下文中`fn()`调用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T15:34:41.913

使用 parent:: 或 self:: 的调用被认为是静态的。这些应该在定义类的上下文中进行评估，而不是在调用对象的范围内。**PHP 5.3 为static**一词添加了新含义，可用于*诸如*parent 和 self 之类的静态调用，但将在**调用类**的上下文中进行评估。这称为**后期静态绑定**。此页面上的更多信息：

[http://www.php.net/lsb](http://www.php.net/lsb)

**编辑：**

经过一番思考，我相信这种行为是完全可以接受的。首先，让我们看看为什么 A 希望它的 foo() 方法调用其父级的 foo() 方法，因为 A 没有父级。因为，它希望无论子项的实现如何，都始终执行该方法。如果是这样，还有其他解决方案，虽然不是很好：

```
class A
{
    final public function __construct()
    {
        echo __METHOD__;

        $this->foo();

        $init = array($this, 'init');
        $args = func_get_args();

        call_user_func_array($init, $args);
    }

    // init would be used as a pseudo-constructor in children
    public function init()
    {}

    final private function foo()
    {
        echo __METHOD__;
    }
}

class B extends A
{}

class C extends B
{}

$c = new C; 
```

如果您试图做的是执行链中的每个 foo() 方法，那么这是预期的行为。如果有一个 B::foo() 函数，那么它就会被执行，如果它包含对 parent::foo() 的调用，那么 A::foo() 也会被执行。

所以，可能 parent::foo() 有点令人困惑。它应该被读成（对不起，但我找不到更好的例子）：

the_first_parent_in_the_inheritance_chain_which_has_a_foo_method::foo()

这就是您真正感兴趣的内容。为什么要在 B 的上下文中调用 foo()？我能想到的唯一原因是从 B 访问私有成员。但是，A 怎么知道 B 有哪些私有成员？它不能。您不能在 A::foo() 中使用 A 未声明的成员。除非 A 是抽象的并且定义了一些抽象方法。当然，A 可以将该属性声明为私有（B 不能为被覆盖的成员提供比在父级中更低的可见性，我们的目标是 B 应该有一个私有的）。然后 B 覆盖该属性，使其成为我们想要的私有。现在，如果您的代码可以工作，A 或 C 将可以访问 B 的私有成员，尽管它不应该。这打破了一个规则。

在任何情况下，您都想要您所询问的行为吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T14:54:54.080

我不是 php 向导，但我猜问题在于父级是静态的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T14:55:58.727

根据您的问题提示的我自己的实验，似乎 parent:: 被解析为该语句所在类的父级。如下更改您的测试用例以查看此行为：

```
<?php
class Z {
        function fn() {
                print "This is Z\n";
        }
}

class A extends Z {
        function fn() {
                print 'Context: Class:' . get_class($this)
                        . ' Parent:' . get_parent_class($this) . "\n";
                if(get_parent_class($this)) {
                        parent::fn();
                }
        }
}
class B extends A { }
class C extends B { }
$a = new A();
$c = new C();
$a->fn();
print "\n";
$c->fn();
?> 
```

我同意这不直观，可能是一个错误。

更新：有趣的是，当您使用它来调用父级时会发生什么：

```
eval(get_parent_class($this). "::fn();"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-26T14:52:41.060

我认为你试图做的是错误的。如果你的 C 类定义了 fn() 函数，那么它永远不会在 A 类中调用 fn()，所以说 parent::fn 是没有意义的，因为你的父类没有名为 fn 的函数，这就是它回归 fn 的原因() 在 A 中定义。

但是，如果您想在当前对象上下文中调用其他函数，请**使用 $this 而不是 parent**。Herez代码为此。

```
<?php

class A {
        function fn() {
                print 'Context: Function:'.__FUNCTION__.' Class:' . get_class($this)
                        . ' Parent:' . get_parent_class($this) . "\n";
                if(get_parent_class($this)) {
                        $this->fB();
                }
        }
}

class B extends A { }
class C extends B {
        function fB(){
                print 'Context: Function:'.__FUNCTION__.' Class:' . get_class($this)
                        . ' Parent:' . get_parent_class($this) . "\n";
        }
}

$a = new A();
$c = new C();

$a->fn();

print "\n";

$c->fn();

?>

**out put**
Context: Function:fn Class:A Parent:

Context: Function:fn Class:C Parent:B
Context: Function:fB Class:C Parent:B 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T14:55:05.000

你能不能试着打电话给 parent->fn() 我以前从来没有试过这样的东西，但那是我的第一个猜测..

# windows-vista - 在 Vista Ultimate 64 位上获取 HDD（而非卷）序列号

> ID：782053
> 
> 赞同：10
> 
> 时间：2009-04-23T14:37:52.047
> 
> 标签：windows-vista, serial-number, hdd

我曾经想在不使用 WMI 的情况下获取 HDD 序列号，结果找到了。[我在 StackOverFlow.com 上找到并发布的代码](https://stackoverflow.com/questions/278062/converting-hdd-serial-vb6-code-into-vb-net-code)在 XP 和 Vista 的 32 位 Windows 上运行良好。当我尝试在 64 位操作系统（特别是 Vista Ultimate 64）上获取序列号时，问题才开始。该代码始终返回 String.Empty 或 Space。

有人知道如何解决这个问题吗？

编辑：

我使用了 Dave Cluderay 建议的工具，结果很有趣：

这是 DiskId32 在 Windows XP SP2 32 位上的输出：

```
To get all details use "diskid32 /d"
Trying to read the drive IDs using physical access with admin rights
Drive 0 - Primary Controller -  - Master drive
Drive Model Number________________: [MAXTOR STM3160215AS]
Drive Serial Number_______________: [            6RA26XK3]
Drive Controller Revision Number__: [3.AAD]
Controller Buffer Size on Drive___: 2097152 bytes
Drive Type________________________: Fixed
Drive Size________________________: 160041885696 bytes

Trying to read the drive IDs using the SCSI back door

Drive 4 - Tertiary Controller -  - Master drive
Drive Model Number________________: [MAXTOR STM3160215AS]
Drive Serial Number_______________: [            6RA26XK3]
Drive Controller Revision Number__: [3.AAD]
Controller Buffer Size on Drive___: 2097152 bytes
Drive Type________________________: Fixed
Drive Size________________________: 160041885696 bytes

Trying to read the drive IDs using physical access with zero rights

**** STORAGE_DEVICE_DESCRIPTOR for drive 0 ****
Vendor Id = []
Product Id = [MAXTOR STM3160215AS]
Product Revision = [3.AAD]
Serial Number = []

**** DISK_GEOMETRY_EX for drive 0 ****
Disk is fixed
DiskSize = 160041885696

Trying to read the drive IDs using Smart

Drive 0 - Primary Controller -  - Master drive

Drive Model Number________________: [MAXTOR STM3160215AS]
Drive Serial Number_______________: [            6RA26XK3]
Drive Controller Revision Number__: [3.AAD]
Controller Buffer Size on Drive___: 2097152 bytes
Drive Type________________________: Fixed
Drive Size________________________: 160041885696 bytes

Hard Drive Serial Number__________:             6RA26XK3

Hard Drive Model Number___________: MAXTOR STM3160215AS 
```

并且 DiskId32 在 Windows Vista Ultimate 64 位上运行：

```
To get all details use "diskid32 /d"

Trying to read the drive IDs using physical access with admin rights

Trying to read the drive IDs using the SCSI back door

Trying to read the drive IDs using physical access with zero rights

**** STORAGE_DEVICE_DESCRIPTOR for drive 0 ****
Vendor Id = [MAXTOR S]
Product Id = [TM3160215AS]
Product Revision = [3.AA]
Serial Number = []

**** DISK_GEOMETRY_EX for drive 0 ****
Disk is fixed
DiskSize = 160041885696

Trying to read the drive IDs using Smart

Hard Drive Serial Number__________:

Hard Drive Model Number___________: 
```

请注意 Vista 上的信息要少得多，以及如何不返回序列号。另一个工具 EnumDisk 将我在 Vista 上的硬盘称为“SCSI”，而不是 Windows XP 上的“ATA”。

有任何想法吗？

编辑2：

我正在发布 EnumDisks 的结果：

在 Windows XP SP2 32 位上：

```
Properties for Device 1

Device ID: IDE\DiskMAXTOR_STM3160215AS_____________________3.AAD___

Adapter Properties
------------------
Bus Type       : ATA
Max. Tr. Length: 0x20000
Max. Phy. Pages: 0xffffffff
Alignment Mask : 0x1

Device Properties
-----------------
Device Type     : Direct Access Device (0x0)
Removable Media : No
Product ID      : MAXTOR STM3160215AS
Product Revision: 3.AAD

Inquiry Data from Pass Through
------------------------------
Device Type: Direct Access Device (0x0)
Vendor ID  : MAXTOR S
Product ID : TM3160215AS
Product Rev: 3.AA
Vendor Str :

***  End of Device List  *** 
```

在 Vista 64 Ultimate 上：

```
Properties for Device 1

Device ID: SCSI\DiskMAXTOR_STM3160215AS_____3.AA

Adapter Properties
------------------
Bus Type       : FIBRE
Max. Tr. Length: 0x20000
Max. Phy. Pages: 0x11
Alignment Mask : 0x0

Device Properties
-----------------
Device Type     : Direct Access Device (0x0)
Removable Media : No
Vendor ID       : MAXTOR S
Product ID      : TM3160215AS
Product Revision: 3.AA

Inquiry Data from Pass Through
------------------------------
Device Type: Direct Access Device (0x0)
Vendor ID  : MAXTOR S
Product ID : TM3160215AS
Product Rev: 3.AA
Vendor Str :

***  End of Device List  *** 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-31T03:17:12.347

此代码在获取序列号时进行了三次尝试：

1.  使用`IOCTL_STORAGE_QUERY_PROPERTY`.
2.  使用`SMART_RCV_DRIVE_DATA`.
3.  使用`IOCTL_SCSI_PASS_THROUGH`.

此代码适用于 64 位：

```
' PhysicalDrive.vb

Option Strict On
Option Explicit On

Imports System.Runtime.InteropServices
Imports System.Text
Imports System.ComponentModel
Imports Microsoft.Win32.SafeHandles

Public Class PhysicalDrive

#Region "Win32 Definitions"
    <StructLayout(LayoutKind.Sequential)> _
    Private Structure IDEREGS
        Public bFeaturesReg As Byte
        Public bSectorCountReg As Byte
        Public bSectorNumberReg As Byte
        Public bCylLowReg As Byte
        Public bCylHighReg As Byte
        Public bDriveHeadReg As Byte
        Public bCommandReg As Byte
        Public bReserved As Byte
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Private Structure SENDCMDINPARAMS
        Public cBufferSize As Int32
        Public irDriveRegs As IDEREGS
        Public bDriveNumber As Byte
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=3)> _
        Public bReserved As Byte()
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=4)> _
        Public dwReserved As Int32()
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=1)> _
        Public bBuffer As Byte()
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Private Structure DRIVERSTATUS
        Public bDriverError As Byte
        Public bIDEError As Byte
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=2)> _
        Public bReserved As Byte()
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=2)> _
        Public dwReserved As Int32()
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Private Structure SENDCMDOUTPARAMS
        Public cBufferSize As Int32
        Public DriverStatus As DRIVERSTATUS
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=IDENTIFY_BUFFER_SIZE)> _
        Public bBuffer As Byte()
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Private Structure GETVERSIONINPARAMS
        Public bVersion As Byte
        Public bRevision As Byte
        Public bReserved As Byte
        Public bIDEDeviceMap As Byte
        Public fCapabilities As Int32
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=4)> _
        Public dwReserved As Int32()
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Private Structure STORAGE_PROPERTY_QUERY
        Public PropertyId As Int32
        Public QueryType As Int32
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=1)> _
        Public AdditionalParameters As Byte()
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Private Structure STORAGE_DEVICE_DESCRIPTOR
        Public Version As Int32
        Public Size As Int32
        Public DeviceType As Byte
        Public DeviceTypeModifier As Byte
        Public RemovableMedia As Byte
        Public CommandQueueing As Byte
        Public VendorIdOffset As Int32
        Public ProductIdOffset As Int32
        Public ProductRevisionOffset As Int32
        Public SerialNumberOffset As Int32
        Public BusType As Byte
        Public RawPropertiesLength As Int32
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=10240)> _
        Public RawDeviceProperties As Byte()
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Private Structure SCSI_PASS_THROUGH
        Public Length As Int16
        Public ScsiStatus As Byte
        Public PathId As Byte
        Public TargetId As Byte
        Public Lun As Byte
        Public CdbLength As Byte
        Public SenseInfoLength As Byte
        Public DataIn As Byte
        Public DataTransferLength As Int32
        Public TimeOutValue As Int32
        Public DataBufferOffset As IntPtr
        Public SenseInfoOffset As Int32
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=16)> _
        Public Cdb As Byte()
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Private Structure SCSI_PASS_THROUGH_WITH_BUFFER
        Public Spt As SCSI_PASS_THROUGH
        Public Filler As Int32
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=64)> _
        Public Buffer As Byte()
    End Structure

    <DllImport("kernel32.dll", SetLastError:=True)> _
    Private Shared Function CreateFile(ByVal lpFileName As String, ByVal dwDesiredAccess As Int32, ByVal dwShareMode As Int32, ByVal lpSecurityAttributes As IntPtr, ByVal dwCreationDisposition As Int32, ByVal dwFlagsAndAttributes As Int32, ByVal hTemplateFile As IntPtr) As SafeFileHandle
    End Function

    <DllImport("kernel32.dll", SetLastError:=True)> _
    Private Shared Function DeviceIoControl(ByVal hDevice As SafeFileHandle, ByVal dwIoControlCode As Int32, <[In]()> ByRef lpInBuffer As SENDCMDINPARAMS, ByVal nInBufferSize As Int32, <[In](), Out()> ByRef lpOutBuffer As SENDCMDOUTPARAMS, ByVal nOutBufferSize As Int32, ByRef lpBytesReturned As Int32, ByVal lpOverlapped As Int32) As Int32
    End Function

    <DllImport("kernel32.dll", SetLastError:=True)> _
    Private Shared Function DeviceIoControl(ByVal hDevice As SafeFileHandle, ByVal dwIoControlCode As Int32, ByVal lpInBuffer As IntPtr, ByVal nInBufferSize As Int32, <[In](), Out()> ByRef lpOutBuffer As GETVERSIONINPARAMS, ByVal nOutBufferSize As Int32, ByRef lpBytesReturned As Int32, ByVal lpOverlapped As Int32) As Int32
    End Function

    <DllImport("kernel32.dll", SetLastError:=True)> _
    Private Shared Function DeviceIoControl(ByVal hDevice As SafeFileHandle, ByVal dwIoControlCode As Int32, <[In]()> ByRef lpInBuffer As STORAGE_PROPERTY_QUERY, ByVal nInBufferSize As Int32, <[In](), Out()> ByRef lpOutBuffer As STORAGE_DEVICE_DESCRIPTOR, ByVal nOutBufferSize As Int32, ByRef lpBytesReturned As Int32, ByVal lpOverlapped As Int32) As Int32
    End Function

    <DllImport("kernel32.dll", SetLastError:=True)> _
    Private Shared Function DeviceIoControl(ByVal hDevice As SafeFileHandle, ByVal dwIoControlCode As Int32, <[In]()> ByRef lpInBuffer As SCSI_PASS_THROUGH_WITH_BUFFER, ByVal nInBufferSize As Int32, <[In](), Out()> ByRef lpOutBuffer As SCSI_PASS_THROUGH_WITH_BUFFER, ByVal nOutBufferSize As Int32, ByRef lpBytesReturned As Int32, ByVal lpOverlapped As Int32) As Int32
    End Function

    Private Const OPEN_EXISTING As Int32 = 3
    Private Const GENERIC_READ As Int32 = &H80000000
    Private Const GENERIC_WRITE As Int32 = &H40000000
    Private Const FILE_SHARE_READ As Int32 = &H1
    Private Const FILE_SHARE_WRITE As Int32 = &H2
    Private Const FILE_SHARE_DELETE As Int32 = &H4
    Private Const SMART_GET_VERSION As Int32 = &H74080
    Private Const SMART_RCV_DRIVE_DATA As Int32 = &H7C088
    Private Const ID_CMD As Int32 = &HEC
    Private Const IDENTIFY_BUFFER_SIZE As Int32 = 512
    Private Const CAP_SMART_CMD As Int32 = &H4
    Private Const IOCTL_STORAGE_QUERY_PROPERTY As Int32 = &H2D1400
    Private Const IOCTL_SCSI_PASS_THROUGH As Int32 = &H4D004
    Private Const SCSI_IOCTL_DATA_IN As Int32 = &H1
    Private Const PropertyStandardQuery As Int32 = 0
    Private Const StorageDeviceProperty As Int32 = 0
    Private Const ERROR_INVALID_FUNCTION As Int32 = &H1
#End Region

    Public Shared Function GetSerialNumberUsingStorageQuery(ByVal diskNumber As Integer) As String
        Using hDisk As SafeFileHandle = OpenDisk(diskNumber)
            Dim iBytesReturned As Int32
            Dim spq As New STORAGE_PROPERTY_QUERY()
            Dim sdd As New STORAGE_DEVICE_DESCRIPTOR()
            spq.PropertyId = StorageDeviceProperty
            spq.QueryType = PropertyStandardQuery

            If DeviceIoControl(hDisk, IOCTL_STORAGE_QUERY_PROPERTY, spq, Marshal.SizeOf(spq), sdd, Marshal.SizeOf(sdd), iBytesReturned, 0) = 0 Then
                Throw CreateWin32Exception(Marshal.GetLastWin32Error(), "DeviceIoControl(IOCTL_STORAGE_QUERY_PROPERTY)")
            End If

            Dim result As New StringBuilder()
            If sdd.SerialNumberOffset > 0 Then
                Dim rawDevicePropertiesOffset As Integer = Marshal.SizeOf(sdd) - sdd.RawDeviceProperties.Length
                Dim pos As Integer = sdd.SerialNumberOffset - rawDevicePropertiesOffset
                While pos < iBytesReturned And sdd.RawDeviceProperties(pos) <> 0
                    result.Append(Encoding.ASCII.GetString(sdd.RawDeviceProperties, pos, 1))
                    pos += 1
                End While
            End If
            Return result.ToString().Trim()
        End Using
    End Function

    Public Shared Function GetSerialNumberUsingSmart(ByVal diskNumber As Integer) As String
        Using hDisk As SafeFileHandle = OpenDisk(diskNumber)
            If IsSmartSupported(hDisk) Then
                Dim iBytesReturned As Int32
                Dim sci As New SENDCMDINPARAMS
                Dim sco As New SENDCMDOUTPARAMS
                sci.irDriveRegs.bCommandReg = ID_CMD
                sci.bDriveNumber = CByte(diskNumber)
                sci.cBufferSize = IDENTIFY_BUFFER_SIZE
                If DeviceIoControl(hDisk, SMART_RCV_DRIVE_DATA, sci, Marshal.SizeOf(sci), sco, Marshal.SizeOf(sco), iBytesReturned, 0) = 0 Then
                    Throw CreateWin32Exception(Marshal.GetLastWin32Error(), "DeviceIoControl(SMART_RCV_DRIVE_DATA)")
                End If
                Dim result As New StringBuilder()
                For index As Integer = 20 To 39 Step 2
                    result.Append(Encoding.ASCII.GetString(sco.bBuffer, index + 1, 1))
                    result.Append(Encoding.ASCII.GetString(sco.bBuffer, index, 1))
                Next
                Return result.ToString().Trim()
            Else
                Return String.Empty
            End If
        End Using
    End Function

    Public Shared Function GetSerialNumberUsingScsiPassThrough(ByVal diskNumber As Integer) As String
        Using hDisk As SafeFileHandle = OpenDisk(diskNumber)
            Dim iBytesReturned As Int32
            Dim spt As New SCSI_PASS_THROUGH_WITH_BUFFER
            spt.Spt.Length = CShort(Marshal.SizeOf(spt.Spt))
            spt.Spt.CdbLength = 16
            spt.Spt.DataIn = SCSI_IOCTL_DATA_IN
            spt.Spt.DataTransferLength = 64
            spt.Spt.DataBufferOffset = New IntPtr(Marshal.SizeOf(spt) - 64)
            spt.Spt.TimeOutValue = 60
            Dim cdb(15) As Byte
            cdb(0) = &H12 ' INQUIRY
            cdb(1) = &H1 ' EVPD bit
            cdb(2) = &H80 ' Page code (indicates Serial Number)
            cdb(4) = 64 ' Allocation length
            spt.Spt.Cdb = cdb
            If DeviceIoControl(hDisk, IOCTL_SCSI_PASS_THROUGH, spt, Marshal.SizeOf(spt), spt, Marshal.SizeOf(spt), iBytesReturned, 0) = 0 Then
                Dim iErrorCode As Int32 = Marshal.GetLastWin32Error()
                If iErrorCode <> ERROR_INVALID_FUNCTION Then
                    Throw CreateWin32Exception(iErrorCode, "DeviceIoControl(IOCTL_SCSI_PASS_THROUGH)")
                End If
            End If
            Dim result As New StringBuilder()
            Dim pos As Integer = IntPtr.Size
            While pos < spt.Spt.DataTransferLength And spt.Buffer(pos) <> 0
                result.Append(Encoding.ASCII.GetString(spt.Buffer, pos, 1))
                pos += 1
            End While
            Return result.ToString().Trim()
        End Using
    End Function

    Private Shared Function CreateWin32Exception(ByVal errorCode As Int32, ByVal context As String) As Win32Exception
        Dim win32Exception As New Win32Exception(errorCode)
        win32Exception.Data("Context") = context
        Return win32Exception
    End Function

    Private Shared Function OpenDisk(ByVal diskNumber As Integer) As SafeFileHandle
        Dim hDevice As SafeFileHandle = CreateFile(String.Format("\\.\PhysicalDrive{0}", diskNumber), GENERIC_READ Or GENERIC_WRITE, FILE_SHARE_READ Or FILE_SHARE_WRITE Or FILE_SHARE_DELETE, IntPtr.Zero, OPEN_EXISTING, 0, IntPtr.Zero)
        If (Not hDevice.IsInvalid) Then
            Return hDevice
        Else
            Throw CreateWin32Exception(Marshal.GetLastWin32Error(), "CreateFile")
        End If
    End Function

    Private Shared Function IsSmartSupported(ByVal hDisk As SafeFileHandle) As Boolean
        Dim iBytesReturned As Int32
        Dim gvi As New GETVERSIONINPARAMS
        If DeviceIoControl(hDisk, SMART_GET_VERSION, IntPtr.Zero, 0, gvi, Marshal.SizeOf(gvi), iBytesReturned, 0) = 0 Then
            Return False
        End If
        Return (gvi.fCapabilities And CAP_SMART_CMD) > 0
    End Function

End Class 
```

这是调用它的代码：

```
' MainModule.vb

Module MainModule

    Sub Main()
        Console.WriteLine("{0}-bit runtime.", IntPtr.Size * 8)
        For drive As Integer = 0 To 4
            Try
                Console.WriteLine("Drive {0}, SMART:             [{1}]", drive, PhysicalDrive.GetSerialNumberUsingSmart(drive))
                Console.WriteLine("Drive {0}, Storage Query:     [{1}]", drive, PhysicalDrive.GetSerialNumberUsingStorageQuery(drive))
                Console.WriteLine("Drive {0}, SCSI Pass Through: [{1}]", drive, PhysicalDrive.GetSerialNumberUsingScsiPassThrough(drive))
            Catch ex As Exception
                If ex.Data("Context") IsNot Nothing Then Console.Error.Write("{0} failed: ", ex.Data("Context"))
                Console.Error.WriteLine(ex.Message)
            End Try
        Next
    End Sub

End Module 
```

**编辑**- 我更改了主要方法以显示每次尝试的结果以进行比较。这有望说明这些技术的成功与否。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T06:16:33.663

将 DeviceIoControl 与[IOCTL_STORAGE_GET_MEDIA_SERIAL_NUMBER一起使用](http://msdn.microsoft.com/en-us/library/aa363411.aspx)

或检查[IOCTL_CHANGER_GET_PRODUCT_DATA](http://msdn.microsoft.com/en-us/library/aa363395(VS.85).aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T06:57:18.013

您需要确保您的 P/Invoke 定义是 64 位友好的。或者，尝试将解决方案中项目的目标 CPU 设置为 32 位。可以在[此处](http://msdn.microsoft.com/en-us/library/ms973190.aspx)找到有关 P/Invoke 和 64 位的更多信息。

**编辑：**

以下重写的代码可能更适合您 - 基本上我已经整理了 P/Invoke 定义并添加了更好的错误处理。该代码两次尝试获取序列号。第一种用途`IOCTL_STORAGE_QUERY_PROPERTY`和第二种用途`SMART_RCV_DRIVE_DATA`。

```
' PhysicalDrive.vb

Option Strict On
Option Explicit On

Imports System.Runtime.InteropServices
Imports System.Text
Imports System.ComponentModel
Imports Microsoft.Win32.SafeHandles

Public Class PhysicalDrive

#Region "Win32 Definitions"
    <StructLayout(LayoutKind.Sequential)> _
    Private Structure IDEREGS
        Public bFeaturesReg As Byte
        Public bSectorCountReg As Byte
        Public bSectorNumberReg As Byte
        Public bCylLowReg As Byte
        Public bCylHighReg As Byte
        Public bDriveHeadReg As Byte
        Public bCommandReg As Byte
        Public bReserved As Byte
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Private Structure SENDCMDINPARAMS
        Public cBufferSize As Int32
        Public irDriveRegs As IDEREGS
        Public bDriveNumber As Byte
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=3)> _
        Public bReserved As Byte()
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=4)> _
        Public dwReserved As Int32()
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=1)> _
        Public bBuffer As Byte()
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Private Structure DRIVERSTATUS
        Public bDriverError As Byte
        Public bIDEError As Byte
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=2)> _
        Public bReserved As Byte()
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=2)> _
        Public dwReserved As Int32()
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Private Structure SENDCMDOUTPARAMS
        Public cBufferSize As Int32
        Public DriverStatus As DRIVERSTATUS
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=IDENTIFY_BUFFER_SIZE)> _
        Public bBuffer As Byte()
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Private Structure GETVERSIONOUTPARAMS
        Public bVersion As Byte
        Public bRevision As Byte
        Public bReserved As Byte
        Public bIDEDeviceMap As Byte
        Public fCapabilities As Int32
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=4)> _
        Public dwReserved As Int32()
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Private Structure STORAGE_PROPERTY_QUERY
        Public PropertyId As Int32
        Public QueryType As Int32
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=1)> _
        Public AdditionalParameters As Byte()
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Private Structure STORAGE_DEVICE_DESCRIPTOR
        Public Version As Int32
        Public Size As Int32
        Public DeviceType As Byte
        Public DeviceTypeModifier As Byte
        Public RemovableMedia As Byte
        Public CommandQueueing As Byte
        Public VendorIdOffset As Int32
        Public ProductIdOffset As Int32
        Public ProductRevisionOffset As Int32
        Public SerialNumberOffset As Int32
        Public BusType As Byte
        Public RawPropertiesLength As Int32
        <MarshalAs(UnmanagedType.ByValArray, SizeConst:=10240)> _
        Public RawDeviceProperties As Byte()
    End Structure

    <DllImport("kernel32.dll", SetLastError:=True)> _
    Private Shared Function CreateFile(ByVal lpFileName As String, ByVal dwDesiredAccess As Int32, ByVal dwShareMode As Int32, ByVal lpSecurityAttributes As IntPtr, ByVal dwCreationDisposition As Int32, ByVal dwFlagsAndAttributes As Int32, ByVal hTemplateFile As IntPtr) As SafeFileHandle
    End Function

    <DllImport("kernel32.dll", SetLastError:=True)> _
    Private Shared Function DeviceIoControl(ByVal hDevice As SafeFileHandle, ByVal dwIoControlCode As Int32, <[In](), Out()> ByRef lpInBuffer As SENDCMDINPARAMS, ByVal nInBufferSize As Int32, <[In](), Out()> ByRef lpOutBuffer As SENDCMDOUTPARAMS, ByVal nOutBufferSize As Int32, ByRef lpBytesReturned As Int32, ByVal lpOverlapped As Int32) As Int32
    End Function

    <DllImport("kernel32.dll", SetLastError:=True)> _
    Private Shared Function DeviceIoControl(ByVal hDevice As SafeFileHandle, ByVal dwIoControlCode As Int32, ByVal lpInBuffer As IntPtr, ByVal nInBufferSize As Int32, <[In](), Out()> ByRef lpOutBuffer As GETVERSIONOUTPARAMS, ByVal nOutBufferSize As Int32, ByRef lpBytesReturned As Int32, ByVal lpOverlapped As Int32) As Int32
    End Function

    <DllImport("kernel32.dll", SetLastError:=True)> _
    Private Shared Function DeviceIoControl(ByVal hDevice As SafeFileHandle, ByVal dwIoControlCode As Int32, <[In](), Out()> ByRef lpInBuffer As STORAGE_PROPERTY_QUERY, ByVal nInBufferSize As Int32, <[In](), Out()> ByRef lpOutBuffer As STORAGE_DEVICE_DESCRIPTOR, ByVal nOutBufferSize As Int32, ByRef lpBytesReturned As Int32, ByVal lpOverlapped As Int32) As Int32
    End Function

    Private Const OPEN_EXISTING As Int32 = 3
    Private Const GENERIC_READ As Int32 = &H80000000
    Private Const GENERIC_WRITE As Int32 = &H40000000
    Private Const FILE_SHARE_READ As Int32 = &H1
    Private Const FILE_SHARE_WRITE As Int32 = &H2
    Private Const FILE_SHARE_DELETE As Int32 = &H4
    Private Const SMART_GET_VERSION As Int32 = &H74080
    Private Const SMART_RCV_DRIVE_DATA As Int32 = &H7C088
    Private Const ID_CMD As Int32 = &HEC
    Private Const IDENTIFY_BUFFER_SIZE As Int32 = 512
    Private Const CAP_SMART_CMD As Int32 = &H4
    Private Const IOCTL_STORAGE_QUERY_PROPERTY As Int32 = &H2D1400
    Private Const PropertyStandardQuery As Int32 = 0
    Private Const StorageDeviceProperty As Int32 = 0
#End Region

    Public Shared Function GetSerialNumber(ByVal diskNumber As Integer) As String
        Dim result As String = GetSerialNumberUsingStorageQuery(diskNumber)
        If String.IsNullOrEmpty(result) Then
            result = GetSerialNumberUsingSmart(diskNumber)
        End If
        Return result
    End Function

    Public Shared Function GetSerialNumberUsingStorageQuery(ByVal diskNumber As Integer) As String
        Using hDisk As SafeFileHandle = OpenDisk(diskNumber)
            Dim iBytesReturned As Int32
            Dim spq As New STORAGE_PROPERTY_QUERY()
            Dim sdd As New STORAGE_DEVICE_DESCRIPTOR()
            spq.PropertyId = StorageDeviceProperty
            spq.QueryType = PropertyStandardQuery

            If DeviceIoControl(hDisk, IOCTL_STORAGE_QUERY_PROPERTY, spq, Marshal.SizeOf(spq), sdd, Marshal.SizeOf(sdd), iBytesReturned, 0) = 0 Then
                Throw CreateWin32Exception(Marshal.GetLastWin32Error(), "DeviceIoControl(IOCTL_STORAGE_QUERY_PROPERTY)")
            End If

            Dim result As New StringBuilder()
            If sdd.SerialNumberOffset > 0 Then
                Dim rawDevicePropertiesOffset As Integer = Marshal.SizeOf(sdd) - sdd.RawDeviceProperties.Length
                Dim pos As Integer = sdd.SerialNumberOffset - rawDevicePropertiesOffset
                While pos < iBytesReturned And sdd.RawDeviceProperties(pos) <> 0
                    result.Append(Encoding.ASCII.GetString(sdd.RawDeviceProperties, pos, 1))
                    pos += 1
                End While
            End If
            Return result.ToString()
        End Using
    End Function

    Public Shared Function GetSerialNumberUsingSmart(ByVal diskNumber As Integer) As String
        Using hDisk As SafeFileHandle = OpenDisk(diskNumber)
            If IsSmartSupported(hDisk) Then
                Dim iBytesReturned As Int32
                Dim sci As New SENDCMDINPARAMS
                Dim sco As New SENDCMDOUTPARAMS
                sci.irDriveRegs.bCommandReg = ID_CMD
                sci.bDriveNumber = CByte(diskNumber)
                sci.cBufferSize = IDENTIFY_BUFFER_SIZE
                If DeviceIoControl(hDisk, SMART_RCV_DRIVE_DATA, sci, Marshal.SizeOf(sci), sco, Marshal.SizeOf(sco), iBytesReturned, 0) = 0 Then
                    Throw CreateWin32Exception(Marshal.GetLastWin32Error(), "DeviceIoControl(SMART_RCV_DRIVE_DATA)")
                End If
                Dim result As New StringBuilder()
                For index As Integer = 20 To 39 Step 2
                    result.Append(Encoding.ASCII.GetString(sco.bBuffer, index + 1, 1))
                    result.Append(Encoding.ASCII.GetString(sco.bBuffer, index, 1))
                Next
                Return result.ToString()
            Else
                Return String.Empty
            End If
        End Using
    End Function

    Private Shared Function CreateWin32Exception(ByVal errorCode As Int32, ByVal context As String) As Win32Exception
        Dim win32Exception As New Win32Exception(errorCode)
        win32Exception.Data("Context") = context
        Return win32Exception
    End Function

    Private Shared Function OpenDisk(ByVal diskNumber As Integer) As SafeFileHandle
        Dim hDevice As SafeFileHandle = CreateFile(String.Format("\\.\PhysicalDrive{0}", diskNumber), GENERIC_READ Or GENERIC_WRITE, FILE_SHARE_READ Or FILE_SHARE_WRITE Or FILE_SHARE_DELETE, IntPtr.Zero, OPEN_EXISTING, 0, IntPtr.Zero)
        If (Not hDevice.IsInvalid) Then
            Return hDevice
        Else
            Throw CreateWin32Exception(Marshal.GetLastWin32Error(), "CreateFile")
        End If
    End Function

    Private Shared Function IsSmartSupported(ByVal hDisk As SafeFileHandle) As Boolean
        Dim iBytesReturned As Int32
        Dim gvo As New GETVERSIONOUTPARAMS
        If DeviceIoControl(hDisk, SMART_GET_VERSION, IntPtr.Zero, 0, gvo, Marshal.SizeOf(gvo), iBytesReturned, 0) = 0 Then
            Return False
        End If
        Return (gvo.fCapabilities And CAP_SMART_CMD) > 0
    End Function

End Class 
```

这是调用它的代码：

```
' MainModule.vb

Module MainModule

    Sub Main()
        Console.WriteLine("{0}-bit runtime.", IntPtr.Size * 8)
        For drive As Integer = 0 To 4
            Try
                Console.WriteLine("Drive {0} - serial number: [{1}]", drive, PhysicalDrive.GetSerialNumber(drive))
            Catch ex As Exception
                If ex.Data("Context") IsNot Nothing Then Console.Error.Write("{0} failed: ", ex.Data("Context"))
                Console.Error.WriteLine(ex.Message)
            End Try
        Next
    End Sub

End Module 
```

我只有一台 64 位机器可以测试，但是这段代码可以在上面运行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T21:11:08.687

[此代码](http://read.pudn.com/downloads47/sourcecode/crypt/159311/DiskSerialNumber.cpp__.htm)应为您提供硬盘序列号。`ReadPhysicalDriveInNTWithAdminRights`它与您链接的代码类似 ( )，但具有几个附加功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-13T21:18:10.657

在 Windows 7 64 上工作：

```
 ManagementObjectSearcher mos = new ManagementObjectSearcher("SELECT * FROM Win32_DiskDrive");

        foreach (ManagementObject obj in mos.Get()) {
            Trace.TraceInformation("Information about disk drive {0}:", obj["Name"]);
            Trace.Indent();
            foreach (PropertyData pd in obj.Properties)
                Trace.TraceInformation("Name \"{0}\": \"{1}\"", pd.Name, pd.Value);
            Trace.Unindent();

            obj.Properties["SerialNumber"]
        } 
```

Win32_PhysicalMedia 类可能不在 64 位平台上提供。

即使是此时的 Disk32 也在工作（除了翻转序列号字节时的错误），因为基于相同的概念。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T01:33:06.940

[从这里](http://social.msdn.microsoft.com/Forums/en-US/Vsexpressvcs/thread/7003d7ae-90b5-41d0-b113-67e9301c8eec)的代码修改：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Management;
using System.Text;

namespace Console_DiskDrive
{
    class Program
    {
        static void Main(string[] args)
        {
            String query = "SELECT * FROM Win32_DiskDrive";

            foreach (ManagementObject item in new ManagementObjectSearcher(query).Get())
            {
                string serialNumber = Convert.ToString(item["SerialNumber"]);

                Console.WriteLine(serialNumber);
            }

            Console.ReadLine();
        }
    }
} 
```

在我运行 Vista Home Premium x64 的系统上，给了我一个 40 个字符的十六进制字符串，我假设它是我的序列号。我会打开盒子稍后再确认，但请尝试一下，看看它是否是您要找的东西。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-27T14:12:43.263

您可能希望使用 Windows 非托管 API 来执行此操作：

使用适当的结构调用[GetVolumeInformation](http://support.microsoft.com/kb/139547) api 并找到 VolumeSerialNumber 整数字段。

这个 API 已经存在了很长时间，并且从 Windows 98 开始就为我工作。不幸的是，无法在 x64 上检查它。

您可以使用其他 Windows 工具查看正确的序列号吗？顺便说一句：“0”是一个有效的序列号！如果磁盘映像是从备份或类似的东西恢复的，则可能会发生这种情况。

# visual-studio-2005 - 有没有办法完全禁用 Visual Studio 中的复制/粘贴功能？

> ID：782058
> 
> 赞同：1
> 
> 时间：2009-04-23T14:38:53.263
> 
> 标签：visual-studio-2005, copy-paste

我正在寻找一种方法来完全禁用 Visual Studio 中的复制/粘贴功能（2005 如果重要的话）。这个请求背后的原因是我想防止自己在编码时做太多的复制/粘贴。

感谢大家的回答！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-23T14:40:49.590

不，请改用自律。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-23T14:44:00.300

是的，有办法。

下载[自动热键](http://www.autohotkey.com/)。将其另存为 GoAwayN00b.ahk 并双击它。

```
#ifWinActive, ahk_class wndclass_desked_gsk

^c::
^v:: MsgBox Go away n00b ! 
```

此外，您可能希望为 xtra 刺激提供可视化。保存此图片并在热键按下时显示（左侧用于练习）：

[替代文字 http://images.paraorkut.com/img/funnypics/images/g/go_away_noob-12269.jpg](http://images.paraorkut.com/img/funnypics/images/g/go_away_noob-12269.jpg)

顺便说一句，复制/粘贴 + [CLCL](http://www.nakka.com/soft/clcl/index_eng.html) = FTW。没有它我不使用VS。

**编辑**：或者，您可以自定义键盘（右键单击工具栏-> 自定义-> 键盘）并删除 Edit.Copy 和 Edit.Paste hotkies。但是，上述脚本适用于任何 VS 和任何计算机，而此解决方案需要单独设置。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-23T14:45:57.597

前几天我女儿问我有没有更钝的锯子，这样她在修剪灌木时就不会那么容易割伤自己。当然现在修剪灌木需要更长的时间......

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-23T15:06:53.053

被问到：前几天我的女儿问我是否有一个更钝的锯，这样她在修剪一些灌木时就不会那么容易割伤自己。当然现在修剪灌木需要更长的时间……重构。

```
For dull saw she asked
No injury while pruning
Free time now all gone 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-23T14:43:48.633

我想你错过了[这篇文章的重点，](http://www.codinghorror.com/blog/archives/001257.html)但你真的很想，[这里有一些](http://www.secretgeek.net/copy_paste_dont_do_it.asp)战斗 copypasta 的资源。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-23T14:44:09.490

正如 Jeff 在他[当前的博客文章](http://www.codinghorror.com/blog/archives/001257.html)中指出的那样，复制和粘贴本身不是问题，而是您如何使用它。由于复制和粘贴也可用于加速“打字”/编辑，因此您不应禁用它。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-23T14:44:47.180

将您的 C 键从键盘中取出。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-23T14:41:21.027

复制和粘贴是一个有价值的工具。你应该小心你复制和粘贴的内容，但你不需要禁用它。看看你在做什么。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-23T14:54:15.580

不要忘记禁用CTRL-拖动！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-23T14:43:23.860

也许您可以找到某种实用程序来允许您全局重新映射组合键。然后，您所要做的就是将复制/粘贴组合重新映射到其他内容。只是一个想法。

虽然我认为你想这样做是疯了。:)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-23T14:44:24.043

编写一个小型服务程序来监视剪贴板的变化，并在收到通知时将剪贴板文本替换为“Content protection from lazy asses”。

# php - 如何使用 PHP 将链接插入到 swf 文件中？

> ID：782065
> 
> 赞同：0
> 
> 时间：2009-04-23T14:40:52.633
> 
> 标签：php

我正在尝试使用 php 自动将链接插入到 swf 横幅中（在其所有表面上）。我几乎可以肯定我在 OpenAds 中看到了这个功能......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T14:44:20.097

抱歉，除了在 SWF 中有一个将点击的位置目标作为参数的点击处理程序之外，无法做到这一点，在这种情况下，该参数被提供给 html 级别的 Flash 文件。

例如

```
<object>
    <param name="movie" value="YOURFLASH.swf" />
    <param name="flashVars" value="clickTag=http%3A//www.example.com/&amp;clickTAG=http%3A//www.example.com/&amp;clicktag=http%3A//www.example.com/&amp;clickTag2=http%3A//www.example.com/" />
    <embed src="YOURFLASH.swf" flashvars="clickTag=http%3A//www.example.com/&amp;clickTAG=http%3A//www.example.com/&amp;clicktag=http%3A//www.example.com/&amp;clickTag2=http%3A//www.example.com/"></embed>
</object> 
```

参数名称 clicktag（在不同的案例变体中）是用于在横幅中设置点击处理程序的常用参数名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T14:50:36.337

您可以尝试在 html 中的 flash 剪辑上放置一个 div 并将您的链接放在那里。这需要非常仔细的定位，并且可能看起来很奇怪。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T14:53:56.657

假设您可以访问 flash 源，您可以从 flash 中使用 PHP（或任何服务器端技术）生成的资源加载链接。

然后你的链接生成为 xml/json/html 并且 flash 显示它们。

谷歌`flash loading data`一堆不同的教程和文章。

# email - 更改 CFMail 中附件的文件名

> ID：782066
> 
> 赞同：5
> 
> 时间：2009-04-23T14:41:01.290
> 
> 标签：email, coldfusion, filenames, attachment, cfmail

我正在尝试使用 ColdFusion 发送包含存储在我们服务器上的附件的电子邮件。

为了管理这些附件，我们称它们为`1.jpg`，`2.doc`...数据库`n.ext`中`n`的键在哪里，我们在其中保存有关文件的其他信息，例如其原始文件名。

我可以使用以下代码：

```
<cfmailparam file="c:\path\1.doc"> 
```

指定文件，但随后将其作为`1.doc`. 无论如何我可以覆盖它并与文件分开指定我自己的文件名吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-01-14T23:18:35.647

您可以尝试添加：

```
<cfmailparam 
file="#actual_file_name#" 
disposition="attachment; filename=""#changed_file_name#"""> 
```

多个引号是故意的......我他们允许文件名中的空格。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T15:37:09.087

Ryan 的建议可能是最简单的解决方案。如果您使用的是 CF 8.01，则可以使用`cfmailparam`'s new`remove`属性。在您使用 重命名附件`cffile`并将它们传递给 后`cfmailparam`，Coldfusion 将在邮件假脱机处理它们后为您从磁盘中删除它们：

```
<cfmailparam file="#File_path#" remove="true" /> 
```

（在 8.01 版本之前，您必须确保您的应用程序在 Coldfusion 的邮件假脱机完成之前没有删除临时文件。）

或者，您可以调用 Coldfusion 的底层 Java 并仅使用内存中的附件构建您的电子邮件消息，使用您喜欢的任何名称。查看[Dan Switzer 的博客](http://blog.pengoworks.com/index.cfm/2007/2/8/Sending-email-attachments-in-CFMX-without-writing-data-to-disk)以获取有关 CF 7.02 的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T14:49:27.777

目前唯一的方法是使用 cffile 并在临时目录中制作文件的副本，重命名它然后附加它。然后，您只想在完成后删除该文件。我认为没有办法附加文件，但在附加到电子邮件时称它为不同的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T16:37:17.083

如果您正在运行 8.0.1（执行 cfdump var="#server#" 以找出答案），那么这可能会让您的生活更轻松一些：

*   cfmail 和 cfmailparam 标签现在有一个 remove 属性，它告诉 ColdFusion 在邮件成功投递后删除所有附件。
*   cfmailparam 标记现在有一个内容属性，允许您将 ColdFusion 变量的内容作为附件发送。为此，请将 # 符号中的变量指定为内容属性值，如下例所示： file 属性指定要包含在邮件头中的文件名，而不是 ColdFusion 系统上的文件

从：

[http://www.adobe.com/support/documentation/en/coldfusion/801/cf801releasenotes.pdf](http://www.adobe.com/support/documentation/en/coldfusion/801/cf801releasenotes.pdf)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-12T15:50:43.777

从 CF8 开始，您可以按照以下方式使用文件和内容：[http ://www.bennadel.com/blog/1220-coldfusion-cfmailparam-s-new-content-attribute-is-awesome.htm](http://www.bennadel.com/blog/1220-coldfusion-cfmailparam-s-new-content-attribute-is-awesome.htm)

```
<cfmailparam
    file="someNiceName.doc"
    content="#fileRead( yourNastyFileName.doc )#"
/> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-08-01T11:40:12.743

ColdFusion 2016 添加了这个名为文件名的新属性来覆盖文件属性中指定的文件名。下面是一个示例

```
<cfmail from="john@sample.com" subject="filename test" to="joanna@sample.org" username="john@sample.com" password="password" server="localhost" spoolenable="false">
    <cfmailparam file="c:\Book2.xlsx" filename="Offers.xlsx">
Check out the new offers sheet
</cfmail> 
```

现在，当邮件发送给用户时，他/她将看到这是 Offers.xslx 而不是 Book2.xslx。更多信息，请访问[https://tracker.adobe.com/#/view/CF-4019518](https://tracker.adobe.com/#/view/CF-4019518)

# wpf - 我应该为整个应用程序创建一次 WCF 连接，还是为每个页面创建一次？

> ID：782072
> 
> 赞同：1
> 
> 时间：2009-04-23T14:42:30.837
> 
> 标签：wpf, wcf, singleton

我正在开发一个使用 WPF 和 WCF 的应用程序。就目前而言，对于每个 WPF 页面，都会创建一个 WCF 连接供该页面使用。这是好习惯吗？或者我应该创建一个 Singleton 对象来包含根据需要传递到我的页面的 WCF 连接？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T18:48:20.437

如果整个应用程序的连接参数和各种授权方面都相同，我肯定会建议使用单个连接。当您的页面就像浏览器选项卡一样时，创建不同的连接可能有意义 - 它们连接到不同的服务器并且基本上是独立的。

此外，考虑在您的 UI 逻辑中根本不使用 WCF 连接，创建一些中间层，通过 WCF 获取数据，并使您的 UI 独立于技术上数据的实际来源。您的 UI 逻辑应该与该中间（业务）层提供的对象一起使用。

# .net - 有人在 Vista/Win7 中创建了 WPF 工具栏控件吗？

> ID：782074
> 
> 赞同：1
> 
> 时间：2009-04-23T14:42:41.973
> 
> 标签：.net, wpf, windows-7, user-interface, explorer

我想向 WPF 应用程序添加一个工具栏，它看起来像 Windows 7 资源管理器中的工具栏（见下图）。因为我是 WPF 的新手，所以我想知道是否有一个 WPF-Control（免费/开源）我可以使用，而不必创建一个新的。我已经搜索过了，但找不到任何有用的东西。

[替代文字 http://www.pic-upload.de/23.04.09/juv56l.png](http://www.pic-upload.de/23.04.09/juv56l.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T12:09:19.263

您可以重新设置 WPF TabControl 的样式，使其看起来像这样。这并不难，只需使用漂亮的 LinearGradientBrush 设置背景就可以让您非常接近。

这是一个（蹩脚的颜色）示例：

```
<ToolBar>
   <ToolBar.Background>
      <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
         <GradientStop Color="White" Offset=".1" />
         <GradientStop Color="LightBlue" Offset=".3" />
         <GradientStop Color="LightSteelBlue" Offset=".8" />
      </LinearGradientBrush>
   </ToolBar.Background>
</ToolBar> 
```

如果你把它放在一个风格中，那就更好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T14:45:45.180

图片好像失效了，给个链接

[http://www.pic-upload.de/23.04.09/juv56l.png](http://www.pic-upload.de/23.04.09/juv56l.png)

# asp.net-mvc - ASP.NET MVC - 母版页和视图页的不同模型

> ID：782077
> 
> 赞同：15
> 
> 时间：2009-04-23T14:43:49.537
> 
> 标签：asp.net-mvc, master-pages, viewmodel

我有一个强类型的母版页，但我想对它的某些子页使用不同的类型。

例如，在母版页上...

```
<%@ Master ... Inherits="System.Web.Mvc.ViewMasterPage<MyWeb.Models.Client>" %> 
```

Client 已经是一个复合对象，因此在某些子页面上我可以保持相同的模型并仅引用成员对象。但是在其他页面上，这样做没有意义，因为我正在处理不同的模型，例如，处理 Customer 模型的子页面。

我的母版页仍然需要客户端模型，但子视图将完全适用于不同的模型。问题是，在控制器中，您只能将一个对象模型传递给视图。有没有办法将一个模型传递给主模型，将另一个模型传递给视图？谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-23T14:53:38.733

您可以创建层次结构并将基本模型传递给母版页，将子模型传递给您的视图。

```
public class BaseModel
{
}

public class ChildModelOne : BaseModel
{
}

public class ChildModelTwo : BaseModel
{
} 
```

这样，您的主视图将只能看到自己的数据（在主模型类中可用），而您的视图将可以访问子模型类中可用的扩展信息。

很简单。

# perl - Apache2 mod_perl Last-Modified 标头被忽略

> ID：782084
> 
> 赞同：2
> 
> 时间：2009-04-23T14:44:49.677
> 
> 标签：perl, apache2, mod-perl, last-modified

我有一个 perl 生成的页面。此页面的内容每 30 分钟更改一次，因此我将 $r->set_last_modified() 设置为内容上次更改的时间。

一切正常，我可以看到正确的标题到达我的浏览器。

当我刷新页面时，我看到我的浏览器在对服务器的请求中使用了正确的“If-Modified-Since”标头，但 Apache2 忽略了这一点并重新发送了整个页面。

如何让 Apache2 正常运行并以“HTTP/1.x 304 Not Modified”响应？

（“last-modified”/“if-modified-since”标头在从同一个 Apache2 进程请求静态内容时得到正确处理。）

谢谢你的帮助。

编辑：我的期望错了吗？我是否必须在我的 perl 脚本中显式处理入站 If-Modified-Since 标头？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T10:45:13.663

可悲的是，是的，您的期望是错误的。

当你基本上对 Apache 说“好的，我正在处理这个请求......”时，Apache 会将所有事情的责任交给你。如果您希望请求遵守 If-Modified-Since，则取决于您的代码。

面对现实，这是正确的行为，因为 Apache 无法知道您在 Perl 处理程序中的“修改”/真正/是什么意思：最好的检查可能是查询您的后端数据库以获取时间戳记录，例如……

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T09:56:09.287

Apache 在处理请求时不会存储您上次修改的值。因此，为了确定是否修改了某些内容，它必须运行您的应用程序。

# perl - 如何使用 Perl 计算文件中的字符、单词和行数？

> ID：782087
> 
> 赞同：19
> 
> 时间：2009-04-23T14:45:25.040
> 
> 标签：perl, file, counting

使用 Perl（不使用 wc）计算文本文件的字符数、单词数和行数的好/最佳方法是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-23T14:54:52.880

这是perl代码。计算单词可能有点主观，但我只是说它是任何不是空格的字符串。

```
open(FILE, "<file.txt") or die "Could not open file: $!";

my ($lines, $words, $chars) = (0,0,0);

while (<FILE>) {
    $lines++;
    $chars += length($_);
    $words += scalar(split(/\s+/, $_));
}

print("lines=$lines words=$words chars=$chars\n"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-23T15:08:59.023

可能会产生更好结果的 bmdhacks 答案的一个变体是使用 \s+（甚至更好的 \W+）作为分隔符。考虑字符串“The quick brown fox”（如果不明显，则添加空格）。使用单个空白字符的分隔符将给出六个而不是四个字数。所以，试试：

```
open(FILE, "<file.txt") or die "Could not open file: $!";

my ($lines, $words, $chars) = (0,0,0);

while (<FILE>) {
    $lines++;
    $chars += length($_);
    $words += scalar(split(/\W+/, $_));
}

print("lines=$lines words=$words chars=$chars\n"); 
```

使用 \W+ 作为分隔符将阻止标点符号（除其他外）计为单词。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-23T14:50:48.833

[字数统计工具](http://en.literateprograms.org/Word_count_(Perl))统计文本文件中的字符、单词和行数

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-02-28T23:02:17.213

这里。试试这个 wc 程序的 Unicode 版本。

*   它跳过非文件参数（管道、目录、套接字等）。

*   它假定 UTF-8 文本。

*   它将任何 Unicode 空白视为单词分隔符。

*   `.ENCODING`如果文件名末尾有 a，它也接受替代编码，例如`foo.cp1252`, `foo.latin1`,`foo.utf16`等。

*   它还可以处理以各种格式压缩的文件。

*   它给出了**段落、行、单词、字素、字符**和**字节的计数。**

*   它理解所有 Unicode 换行序列。

*   它警告带有换行错误的损坏的文本文件。

下面是一个运行它的例子：

```
Paras    Lines    Words   Graphs    Chars    Bytes File
       2     2270    82249   504169   504333   528663 /tmp/ap
       1     2404    11163    63164    63164    66336 /tmp/b3
    uwc: missing linebreak at end of corrupted textfiile /tmp/bad
      1*       2*        4       19       19       19 /tmp/bad
       1       14       52      273      273      293 /tmp/es
      57      383     1369    11997    11997    12001 /tmp/funny
       1   657068  3175429 31205970 31209138 32633834 /tmp/lw
       1        1        4       27       27       27 /tmp/nf.cp1252
       1        1        4       27       27       34 /tmp/nf.euc-jp
       1        1        4       27       27       27 /tmp/nf.latin1
       1        1        4       27       27       27 /tmp/nf.macroman
       1        1        4       27       27       54 /tmp/nf.ucs2
       1        1        4       27       27       56 /tmp/nf.utf16
       1        1        4       27       27       54 /tmp/nf.utf16be
       1        1        4       27       27       54 /tmp/nf.utf16le
       1        1        4       27       27      112 /tmp/nf.utf32
       1        1        4       27       27      108 /tmp/nf.utf32be
       1        1        4       27       27      108 /tmp/nf.utf32le
       1        1        4       27       27       39 /tmp/nf.utf7
       1        1        4       27       27       31 /tmp/nf.utf8
       1    26906   101528   635841   636026   661202 /tmp/o2
     131      346     1370     9590     9590     4486 /tmp/perl5122delta.pod.gz
     291      814     3941    25318    25318     9878 /tmp/perl51310delta.pod.bz2
       1     2551     5345   132655   132655   133178 /tmp/tailsort-pl.utf8
       1       89      334     1784     1784     2094 /tmp/til
       1        4       18       88       88      106 /tmp/w
     276     1736     5773    53782    53782    53804 /tmp/www 
```

给你：

```
#!/usr/bin/env perl 
#########################################################################
# uniwc - improved version of wc that works correctly with Unicode
#
# Tom Christiansen <tchrist@perl.com>
# Mon Feb 28 15:59:01 MST 2011
#########################################################################

use 5.10.0;

use strict;
use warnings FATAL => "all";
use sigtrap qw[ die untrapped normal-signals ];

use Carp;

$SIG{__WARN__}  = sub {
    confess("FATALIZED WARNING: @_")  unless $^S;
};

$SIG{__DIE__}  = sub {
    confess("UNCAUGHT EXCEPTION: @_")  unless $^S;
};

$| = 1;

my $Errors = 0;
my $Headers = 0;

sub yuck($) {
    my $errmsg = $_[0];
    $errmsg =~ s/(?<=[^\n])\z/\n/;
    print STDERR "$0: $errmsg";
}

process_input(\&countem);

sub countem { 
    my ($_, $file) = @_;

    my (
        @paras, @lines, @words,
        $paracount, $linecount, $wordcount, 
        $grafcount, $charcount, $bytecount,
    );

    if ($charcount = length($_)) {
        $wordcount = eval { @words = split m{ \p{Space}+  }x }; 
        yuck "error splitting words: $@" if $@;

        $linecount = eval { @lines = split m{ \R     }x }; 
        yuck "error splitting lines: $@" if $@;

        $grafcount = 0;
        $grafcount++ while /\X/g;
        #$grafcount = eval { @lines = split m{ \R     }x }; 
        yuck "error splitting lines: $@" if $@;

        $paracount = eval { @paras = split m{ \R{2,} }x }; 
        yuck "error splitting paras: $@" if $@;

        if ($linecount && !/\R\z/) {
            yuck("missing linebreak at end of corrupted textfiile $file");
            $linecount .= "*";
            $paracount .= "*";
        } 
    }

    $bytecount = tell;
    if (-e $file) {
        $bytecount = -s $file;
        if ($bytecount != -s $file) {
            yuck "filesize of $file differs from bytecount\n";
            $Errors++;
        }
    } 
    my $mask = "%8s " x 6 . "%s\n";
    printf  $mask => qw{ Paras Lines Words Graphs Chars Bytes File } unless $Headers++;

    printf $mask => map( { show_undef($_) } 
                                $paracount, $linecount, 
                                $wordcount, $grafcount, 
                                $charcount, $bytecount,
                       ), $file;
} 

sub show_undef {
    my $value = shift;
    return defined($value)
             ? $value
             : "undef";
} 

END { 
    close(STDOUT) || die "$0: can't close STDOUT: $!";
    exit($Errors != 0);
}

sub process_input {

    my $function = shift();

    my $enc;

    if (@ARGV == 0 && -t) {
        warn "$0: reading from stdin, type ^D to end or ^C to kill.\n";
    }

    unshift(@ARGV, "-") if @ARGV == 0;

FILE:

    for my $file (@ARGV) {
        # don't let magic open make an output handle

        next if -e $file && ! -f _;

        my $quasi_filename = fix_extension($file);

        $file = "standard input" if $file eq q(-);
        $quasi_filename =~ s/^(?=\s*[>|])/< /;

        no strict "refs";
        my $fh = $file;   # is *so* a lexical filehandle! ☺
        unless (open($fh, $quasi_filename)) {
            yuck("couldn't open $quasi_filename: $!");
            next FILE;
        }
        set_encoding($fh, $file) || next FILE;

        my $whole_file = eval {
            use warnings "FATAL" => "all";
            local $/;
            scalar <$fh>;
        };

        if ($@) {
            $@ =~ s/ at \K.*? line \d+.*/$file line $./;
            yuck($@);
            next FILE;
        }

        $function->($whole_file, $file);

        unless (close $fh) {
            yuck("couldn't close $quasi_filename at line $.: $!");
            next FILE;
        }

    } # foreach file

}

sub set_encoding(*$) {
    my ($handle, $path) = @_;

    my $enc_name = "utf8";

    if ($path && $path =~ m{ \. ([^\s.]+) \z }x) {
        my $ext = $1;
        die unless defined $ext;
        require Encode;
        if (my $enc_obj = Encode::find_encoding($ext)) {
            my $name = $enc_obj->name || $ext;
            $enc_name = "encoding($name)";
        }
    }

    return 1 if eval {
        use warnings FATAL => "all";
        no strict "refs";
        binmode($handle, ":$enc_name");
        1;
    };

    for ($@) {
        s/ at .* line \d+\.//;
        s/$/ for $path/;
    }

    yuck("set_encoding: $@");

    return undef;
}

sub fix_extension {
    my $path = shift();
    my %Compress = (
        Z       =>  "zcat",
        z       => "gzcat",            # for uncompressing
        gz      => "gzcat",
        bz      => "bzcat",
        bz2     => "bzcat",
        bzip    => "bzcat",
        bzip2   => "bzcat",
        lzma    => "lzcat",
    );

    if ($path =~ m{ \. ( [^.\s] +) \z }x) {
        if (my $prog = $Compress{$1}) {
            return "$prog $path |";
        } 
    } 

    return $path; 
```

}

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-24T09:33:40.060

有一个[Perl Power Tools](http://www.metacpan.org/module/PerlPowerTools)项目，其目标是重建所有 Unix bin 实用程序，主要用于那些在没有 Unix 的操作系统上的实用程序。是的，他们做了[wc](https://metacpan.org/source/BDFOY/PerlPowerTools-1.002/bin/wc)。该实现是矫枉过正，但它是[POSIX 兼容](http://www.opengroup.org/onlinepubs/000095399/utilities/wc.html)的。

[当您查看符合 GNU 的true](https://metacpan.org/source/BDFOY/PerlPowerTools-1.002/bin/true)实现时，它会变得有点荒谬。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-08-29T16:44:55.233

我在搜索字符计数解决方案时偶然发现了这一点。诚然，我对 perl 几乎一无所知，所以其中一些可能不符合实际，但这里是我对 newt 解决方案的调整。

首先，无论如何都有一个内置的行数变量，所以我只是使用了它。我猜这可能更有效一些。实际上，字符数包括换行符，这可能不是您想要的，所以我选择了 $_。Perl 还抱怨 split() 的完成方式（隐式拆分，请参阅：[为什么 Perl 抱怨“不推荐使用对 @_ 的隐式拆分”？](https://stackoverflow.com/questions/2436160/why-does-perl-complain-use-of-implicit-split-to-is-deprecated)）所以我对其进行了调整。我的输入文件是 UTF-8，所以我就这样打开了它们。这可能有助于在包含非 ASCII 字符的输入文件中获得正确的字符数。

这是代码：

```
open(FILE, "<:encoding(UTF-8)", "file.txt") or die "Could not open file: $!";

my ($lines, $words, $chars) = (0,0,0);
my @wordcounter;
while (<FILE>) {
    chomp($_);
    $chars += length($_);
    @wordcounter = split(/\W+/, $_);
    $words += @wordcounter;
}
$lines = $.;
close FILE;
print "\nlines=$lines, words=$words, chars=$chars\n"; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-23T14:50:44.887

不严肃的回答：

```
system("wc foo"); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-23T15:44:28.303

以固定大小的块读取文件可能比逐行读取更有效。`wc`二进制文件执行此操作。

```
#!/usr/bin/env perl

use constant BLOCK_SIZE => 16384;

for my $file (@ARGV) {
    open my $fh, '<', $file or do {
        warn "couldn't open $file: $!\n";
        continue;
    };

    my ($chars, $words, $lines) = (0, 0, 0);

    my ($new_word, $new_line);
    while ((my $size = sysread $fh, local $_, BLOCK_SIZE) > 0) {
        $chars += $size;
        $words += /\s+/g;
        $words-- if $new_word && /\A\s/;
        $lines += () = /\n/g;

        $new_word = /\s\Z/;
        $new_line = /\n\Z/;
    }
    $lines-- if $new_line;

    print "\t$lines\t$words\t$chars\t$file\n";
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-23T20:13:35.740

为了能够计算 CHARS 而不是字节，请考虑以下问题：（
尝试使用中文或西里尔字母以及保存在 utf8 中的文件）

```
use utf8;

my $file='file.txt';
my $LAYER = ':encoding(UTF-8)';
open( my $fh, '<', $file )
  || die( "$file couldn't be opened: $!" );
binmode( $fh, $LAYER );
read $fh, my $txt, -s $file;
close $fh;

print length $txt,$/;
use bytes;
print length $txt,$/; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-02-18T09:51:06.950

这可能对 Perl 初学者有帮助。我尝试模拟 MS 字数统计功能并添加了一项在 Linux 中使用 wc 未显示的功能。

*   number of lines
*   number of words
*   number of characters with space
*   number of characters without space (wc will not give this in its output but Microsoft words shows it.)

Here is the url: [Counting words,characters and lines in a file](http://www.aliencoders.com/content/counting-wordscharacters-and-lines-file)

# asp.net - JQuery jVal插件在表单上空间不足

> ID：782092
> 
> 赞同：0
> 
> 时间：2009-04-23T14:48:00.137
> 
> 标签：asp.net, jquery

我正在使用 JQuery 插件 jVal。这个插件验证用户输入。如果用户犯了错误，输入框会变成红色，并且会弹出一条消息，说明出了什么问题。这对于每个可视行有一个标签和一个输入的表单非常有用。当您每行有多个标签和输入时，这就会分崩离析。IE 飞出错误与基础信息混淆。有没有办法让有错误的字段旁边只有一个 *，然后在不同的 DIV 中显示所有字段错误的摘要。我对其他 JQuery 插件持开放态度，这些插件会给我验证和我所追求的演示文稿。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T14:53:01.153

jQuery[验证插件](http://docs.jquery.com/Plugins/Validation)允许您自定义它的错误消息——纯文本，没有弹出窗口。默认消息也可以更改——在后端代码中或通过配置（使用消息选项）。

# c# - 转换列表 反对[]

> ID：782096
> 
> 赞同：26
> 
> 时间：2009-04-23T14:49:04.640
> 
> 标签：c#, arrays, generics

我正在寻找一种可以转换`List<T>`为`object[]`. 它是一个班轮，所以我对诸如`foreach`, 或`for`...之类的解决方案不感兴趣

有接盘侠吗？

提示：不，两者都`List<T>.ToArray()`不起作用`List<T>.ToArray<object>()`。

编辑：为什么`List<T>.ToArray<object>()`不起作用？因为它无法编译。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-04-23T14:50:33.920

```
mylist.Cast<object>().ToArray() 
```

顺便说一句，如果您想知道性能，那只会迭代一次。在）。:)

为什么？好吧，因为[`Cast<object>`](http://msdn.microsoft.com/en-us/library/bb341406.aspx)将使用延迟执行并且在列表被迭代之前实际上不会做任何事情`ToArray()`。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-23T14:56:57.913

```
List<T>.Select(x => x as object).ToArray(); 
```

应该返回一个`object[]`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T15:17:10.757

如果您没有 Linq (.Net 3.0)，那么您可以使用List 中的[ConvertAll()](http://msdn.microsoft.com/en-us/library/73fe8cwf(VS.80).aspx)和[ToArray()方法：](http://msdn.microsoft.com/en-us/library/x303t819(VS.80).aspx)

```
List<T> list = new List<T>();

object[] objects = list.ConvertAll<object>(item => (object)item).ToArray(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T14:53:54.287

```
theList.Cast<object>().ToArray() 
```

或者

```
new List<object>(theList).ToArray() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-23T15:07:45.987

对于 pre-LINQ 解决方案（仅适用于引用类型）。

```
(object[])List<T>.ToArray(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T14:54:02.897

如果您不介意编写一个非常短且可重用的函数，ConvertAll 扩展方法可能会有所帮助：

[http://msdn.microsoft.com/en-us/library/73fe8cwf.aspx](http://msdn.microsoft.com/en-us/library/73fe8cwf.aspx)

编辑：

这也可以

```
List<int> intList = new List<int>() { 1, 3, 4 };
object[] objectList = intList.ConvertAll(item => (object)item).ToArray(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T15:11:19.097

在 .NET 2.0（VS 2008）上的 C# 中，以下编译并且不使用 LINQ（据我所知）作为引用类型。

```
 object[] oArray;
 List<MyObject> oList = new List<MyObject>();
 oArray = oList.ToArray(); 
```

这不需要强制转换，因为所有引用类型都以对象为基础。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-01-10T14:54:45.180

我建议创建一个 ListCastAdapter，

假设您要将列表转换为列表

创建从 List 返回项目的 IList 实现的实现

最有可能我称之为类 ListCastAdapter

祝你有美好的一天

## 实施（未测试）：

**注意**：建议将列表设为只读，因为现在用户可以在原始列表中插入层次结构中的对象。

**注意**：未实现 CopyTo()，您可以为数组创建相同的想法。

```
using System.Collections;
using System.Collections.Generic;

namespace UDF.MyDataLayer
{
    internal class ListCastAdapter<S,T> : IList<T> where T : class where S : class
    {
        private List<S> adaptee;

        public ListCastAdapter(List<S> adaptee )
        {
            this.adaptee = adaptee;
        }

        #region Implementation of IEnumerable

        public class EnumeratorCastAdapter : IEnumerator<T>
        {
            private IEnumerator<S> adaptee;

            public EnumeratorCastAdapter(IEnumerator<S> adaptee)
            {
                this.adaptee = adaptee;
            }

            #region Implementation of IDisposable

            /// <summary>
            /// Performs application-defined tasks associated with freeing, releasing, or resetting unmanaged resources.
            /// </summary>
            /// <filterpriority>2</filterpriority>
            public void Dispose()
            {
                adaptee.Dispose();
            }

            #endregion

            #region Implementation of IEnumerator
            /// <summary>
            /// Advances the enumerator to the next element of the collection.
            /// </summary>
            /// <returns>
            /// true if the enumerator was successfully advanced to the next element; false if the enumerator has passed the end of the collection.
            /// </returns>
            /// <exception cref="T:System.InvalidOperationException">The collection was modified after the enumerator was created. </exception><filterpriority>2</filterpriority>
            public bool MoveNext()
            {
                return adaptee.MoveNext();
            }

            /// <summary>
            /// Sets the enumerator to its initial position, which is before the first element in the collection.
            /// </summary>
            /// <exception cref="T:System.InvalidOperationException">The collection was modified after the enumerator was created. </exception><filterpriority>2</filterpriority>
            public void Reset()
            {
                adaptee.Reset();
            }

            /// <summary>
            /// Gets the element in the collection at the current position of the enumerator.
            /// </summary>
            /// <returns>
            /// The element in the collection at the current position of the enumerator.
            /// </returns>
            public T Current
            {
                get
                {
                    // needs to check if it is an Object or Value Type
                    return adaptee.Current as T;
                }
            }

            /// <summary>
            /// Gets the current element in the collection.
            /// </summary>
            /// <returns>
            /// The current element in the collection.
            /// </returns>
            /// <exception cref="T:System.InvalidOperationException">The enumerator is positioned before the first element of the collection or after the last element.</exception><filterpriority>2</filterpriority>
            object IEnumerator.Current
            {
                get { return Current; }
            }
            #endregion
        }
        /// <summary>
        /// Returns an enumerator that iterates through the collection.
        /// </summary>
        /// <returns>
        /// A <see cref="T:System.Collections.Generic.IEnumerator`1"/> that can be used to iterate through the collection.
        /// </returns>
        /// <filterpriority>1</filterpriority>
        public IEnumerator<T> GetEnumerator()
        {
            return new EnumeratorCastAdapter(adaptee.GetEnumerator());
        }

        /// <summary>
        /// Returns an enumerator that iterates through a collection.
        /// </summary>
        /// <returns>
        /// An <see cref="T:System.Collections.IEnumerator"/> object that can be used to iterate through the collection.
        /// </returns>
        /// <filterpriority>2</filterpriority>
        IEnumerator IEnumerable.GetEnumerator()
        {
            return adaptee.GetEnumerator();
        }
        #endregion

        #region Implementation of ICollection<T>
        /// <summary>
        /// Adds an item to the <see cref="T:System.Collections.Generic.ICollection`1"/>.
        /// </summary>
        /// <param name="item">The object to add to the <see cref="T:System.Collections.Generic.ICollection`1"/>.</param><exception cref="T:System.NotSupportedException">The <see cref="T:System.Collections.Generic.ICollection`1"/> is read-only.</exception>
        public void Add(T item)
        {
            adaptee.Add(item as S);
        }

        /// <summary>
        /// Removes all items from the <see cref="T:System.Collections.Generic.ICollection`1"/>.
        /// </summary>
        /// <exception cref="T:System.NotSupportedException">The <see cref="T:System.Collections.Generic.ICollection`1"/> is read-only. </exception>
        public void Clear()
        {
            adaptee.Clear();
        }

        /// <summary>
        /// Determines whether the <see cref="T:System.Collections.Generic.ICollection`1"/> contains a specific value.
        /// </summary>
        /// <returns>
        /// true if <paramref name="item"/> is found in the <see cref="T:System.Collections.Generic.ICollection`1"/>; otherwise, false.
        /// </returns>
        /// <param name="item">The object to locate in the <see cref="T:System.Collections.Generic.ICollection`1"/>.</param>
        public bool Contains(T item)
        {
            return adaptee.Contains(item as S);
        }

        /// <summary>
        /// Copies the elements of the <see cref="T:System.Collections.Generic.ICollection`1"/> to an <see cref="T:System.Array"/>, starting at a particular <see cref="T:System.Array"/> index.
        /// </summary>
        /// <param name="array">The one-dimensional <see cref="T:System.Array"/> that is the destination of the elements copied from <see cref="T:System.Collections.Generic.ICollection`1"/>. The <see cref="T:System.Array"/> must have zero-based indexing.</param><param name="arrayIndex">The zero-based index in <paramref name="array"/> at which copying begins.</param><exception cref="T:System.ArgumentNullException"><paramref name="array"/> is null.</exception><exception cref="T:System.ArgumentOutOfRangeException"><paramref name="arrayIndex"/> is less than 0.</exception><exception cref="T:System.ArgumentException"><paramref name="array"/> is multidimensional.-or-The number of elements in the source <see cref="T:System.Collections.Generic.ICollection`1"/> is greater than the available space from <paramref name="arrayIndex"/> to the end of the destination <paramref name="array"/>.-or-Type <paramref name="T"/> cannot be cast automatically to the type of the destination <paramref name="array"/>.</exception>
        public void CopyTo(T[] array, int arrayIndex)
        {
            throw new System.NotImplementedException("Not Needed by Me, implement ArrayCastAdapter if needed");
        }

        /// <summary>
        /// Removes the first occurrence of a specific object from the <see cref="T:System.Collections.Generic.ICollection`1"/>.
        /// </summary>
        /// <returns>
        /// true if <paramref name="item"/> was successfully removed from the <see cref="T:System.Collections.Generic.ICollection`1"/>; otherwise, false. This method also returns false if <paramref name="item"/> is not found in the original <see cref="T:System.Collections.Generic.ICollection`1"/>.
        /// </returns>
        /// <param name="item">The object to remove from the <see cref="T:System.Collections.Generic.ICollection`1"/>.</param><exception cref="T:System.NotSupportedException">The <see cref="T:System.Collections.Generic.ICollection`1"/> is read-only.</exception>
        public bool Remove(T item)
        {
            adaptee.Remove(item as S);
        }

        /// <summary>
        /// Gets the number of elements contained in the <see cref="T:System.Collections.Generic.ICollection`1"/>.
        /// </summary>
        /// <returns>
        /// The number of elements contained in the <see cref="T:System.Collections.Generic.ICollection`1"/>.
        /// </returns>
        public int Count
        {
            get { return adaptee.Count; }
        }

        /// <summary>
        /// Gets a value indicating whether the <see cref="T:System.Collections.Generic.ICollection`1"/> is read-only.
        /// </summary>
        /// <returns>
        /// true if the <see cref="T:System.Collections.Generic.ICollection`1"/> is read-only; otherwise, false.
        /// </returns>
        public bool IsReadOnly
        {
            get 
            {
                return true;  // change, to live on the edge
            }
        }
        #endregion

        #region Implementation of IList<T>
        /// <summary>
        /// Determines the index of a specific item in the <see cref="T:System.Collections.Generic.IList`1"/>.
        /// </summary>
        /// <returns>
        /// The index of <paramref name="item"/> if found in the list; otherwise, -1.
        /// </returns>
        /// <param name="item">The object to locate in the <see cref="T:System.Collections.Generic.IList`1"/>.</param>
        public int IndexOf(T item)
        {
            return adaptee.IndexOf(item as S);
        }

        /// <summary>
        /// Inserts an item to the <see cref="T:System.Collections.Generic.IList`1"/> at the specified index.
        /// </summary>
        /// <param name="index">The zero-based index at which <paramref name="item"/> should be inserted.</param><param name="item">The object to insert into the <see cref="T:System.Collections.Generic.IList`1"/>.</param><exception cref="T:System.ArgumentOutOfRangeException"><paramref name="index"/> is not a valid index in the <see cref="T:System.Collections.Generic.IList`1"/>.</exception><exception cref="T:System.NotSupportedException">The <see cref="T:System.Collections.Generic.IList`1"/> is read-only.</exception>
        public void Insert(int index, T item)
        {
            adaptee.Insert(index, item as S);
        }

        /// <summary>
        /// Removes the <see cref="T:System.Collections.Generic.IList`1"/> item at the specified index.
        /// </summary>
        /// <param name="index">The zero-based index of the item to remove.</param><exception cref="T:System.ArgumentOutOfRangeException"><paramref name="index"/> is not a valid index in the <see cref="T:System.Collections.Generic.IList`1"/>.</exception><exception cref="T:System.NotSupportedException">The <see cref="T:System.Collections.Generic.IList`1"/> is read-only.</exception>
        public void RemoveAt(int index)
        {
            adaptee.RemoveAt(index);
        }

        /// <summary>
        /// Gets or sets the element at the specified index.
        /// </summary>
        /// <returns>
        /// The element at the specified index.
        /// </returns>
        /// <param name="index">The zero-based index of the element to get or set.</param><exception cref="T:System.ArgumentOutOfRangeException"><paramref name="index"/> is not a valid index in the <see cref="T:System.Collections.Generic.IList`1"/>.</exception><exception cref="T:System.NotSupportedException">The property is set and the <see cref="T:System.Collections.Generic.IList`1"/> is read-only.</exception>
        public T this[int index]
        {
            get { return adaptee[index] as T; }
            set { adaptee[index] = value as S; }
        }
        #endregion
    }
} 
```

# wpf - 有没有办法以编程方式关闭 WPF 中的菜单项

> ID：782110
> 
> 赞同：9
> 
> 时间：2009-04-23T14:52:09.643
> 
> 标签：wpf, menu, menuitem

我在 wpf 中有一个菜单，上面有一个输入框和一个按钮。用户单击按钮后，我需要关闭菜单。

有没有办法做到这一点？

```
 <Menu x:Name="MainMenu">
        <MenuItem Header="Main">
            <MenuItem Header="SubMenu" x:Name="SubMenu">
                <StackPanel Orientation="Horizontal">
                    <TextBox Width="50" x:Name="TextBox" />
                    <Button Content="Click Me and Close" x:Name="Button" IsDefault="True"/>
                </StackPanel>
            </MenuItem>
        </MenuItem> 
```

谢谢，乔恩

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-23T15:11:37.550

抓住`MenuItem`并做：

```
_menuItem.IsSubmenuOpen = false; 
```

获取它的简单方法：

```
<Button x:Name="_button" Tag="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type MenuItem}, AncestorLevel=2}"/> 
```

代码隐藏：

```
_button.Click += delegate
{
    (_button.Tag as MenuItem).IsSubmenuOpen = false;
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-03-07T11:43:57.177

我发现 using`IsSubmenuOpen`并不能正确地从包含的菜单中消除焦点（特别是如果菜单位于工具栏中 -即使菜单“关闭” `MenuItem`，顶层`MenuItem`仍然存在）。`Selected`我发现向作品发送`MouseUp`事件`MenuItem`更好（在按钮或嵌套控件的 Click 事件处理程序中）：

```
 private void button_Click(object sender, RoutedEventArgs e) {
           Button b = sender as Button;

           if (b == null || !(b.Parent is MenuItem))
              return;

           MenuItem mi = b.Parent as MenuItem;

           mi.RaiseEvent(
              new MouseButtonEventArgs(
                 Mouse.PrimaryDevice, 0, MouseButton.Left
              ) 
              {RoutedEvent=Mouse.MouseUpEvent}
           );
        } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-11T00:11:25.967

史蒂夫感谢您的解决方案。这实际上是正确的答案，最后是除了互联网上大量错误答案之外真正有效的东西。根据您的 anwser，我有一个更短（更安全）的解决方案。因为按钮的直接父级（e.Parent）并不总是 MenuItem（来自 StackPanel 的原始答案），所以您的解决方案将不起作用。因此，只需设置 MenuItem 的 Name 属性 (Name="MyMenuItem") 并将此处理程序挂接到 Button 上：

```
 private void Button_Click(object sender, RoutedEventArgs e) {
        MyMenuItem.RaiseEvent(new MouseButtonEventArgs(Mouse.PrimaryDevice, 0, MouseButton.Left) {
            RoutedEvent = Mouse.MouseUpEvent
        });
    } 
```

# winforms - 控制 Winforms 工具提示的位置

> ID：782111
> 
> 赞同：5
> 
> 时间：2009-04-23T14:53:00.357
> 
> 标签：winforms, tooltip

有没有办法控制工具提示在 Winform 上的位置？我可以处理 Popup 事件，但在事件处理程序中我只能更改大小，而不是位置。我可以使用控件的 OnMouseEnter/Leave 事件来手动显示工具提示，但是我失去了普通工具提示的 AutomaticDelay 属性的好处。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T15:10:41.470

[ToolTip.Show](http://msdn.microsoft.com/en-us/library/system.windows.forms.tooltip.show.aspx)方法有一些允许这样做的重载。一探究竟。

# sql - SQL 在日期时间字段周围加上两个单引号并且无法插入记录

> ID：782117
> 
> 赞同：2
> 
> 时间：2009-04-23T14:53:39.733
> 
> 标签：sql, sql-server-2005, datetime, double-quotes

我正在尝试插入到 SQL 数据库表中，但它不起作用。所以我使用 SQL 服务器分析器来查看它是如何构建查询的；它显示的内容如下：

```
declare @p1 int
set @p1=0
declare @p2 int
set @p2=0
declare @p3 int
set @p3=1
exec InsertProcedureName @ConsumerMovingDetailID=@p1 output, @UniqueID=@p2 output, 
                         @ServiceID=@p3 output, @ProjectID=N'0', @IPAddress=N'66.229.112.168', 
                         @FirstName=N'Mike', @LastName=N'P', @Email=N'mymail@yahoo.com', 
                         @PhoneNumber=N'(254)637-1256', @MobilePhone=NULL, @CurrentAddress=N'', 
                         @FromZip=N'10005', @MoveInAddress=N'', @ToZip=N'33067', 
                         @MovingSize=N'1', @MovingDate=''2009-04-30 00:00:00:000'', 
                               /*        Problem here  ^^^  */
                         @IsMovingVehicle=0, @IsPackingRequired=0, @IncludeInSaveologyPlanner=1
select @p1, @p2, @p3 
```

正如你所看到的，它把~~双引号~~日期时间字段周围有两对单引号，以便在 SQL 中产生语法错误。我想知道是否有什么我必须在某处配置的东西？

任何帮助，将不胜感激。

以下是环境详细信息：

*   视觉工作室 2008
*   .NET 3.5
*   微软 SQL 服务器 2005

这是我正在使用的 .NET 代码....

```
//call procedure for results
strStoredProcedureName = "usp_SMMoverSearchResult_SELECT";

Database database = DatabaseFactory.CreateDatabase();
DbCommand dbCommand = database.GetStoredProcCommand(strStoredProcedureName);
dbCommand.CommandTimeout = DataHelper.CONNECTION_TIMEOUT;

database.AddInParameter(dbCommand, "@MovingDetailID", DbType.String, objPropConsumer.ConsumerMovingDetailID);
database.AddInParameter(dbCommand, "@FromZip", DbType.String, objPropConsumer.FromZipCode);
database.AddInParameter(dbCommand, "@ToZip", DbType.String, objPropConsumer.ToZipCode);
database.AddInParameter(dbCommand, "@MovingDate", DbType.DateTime, objPropConsumer.MoveDate);
database.AddInParameter(dbCommand, "@PLServiceID", DbType.Int32, objPropConsumer.ServiceID);
database.AddInParameter(dbCommand, "@FromAreaCode", DbType.String, pFromAreaCode);
database.AddInParameter(dbCommand, "@FromState", DbType.String, pFromState);
database.AddInParameter(dbCommand, "@ToAreaCode", DbType.String, pToAreaCode);
database.AddInParameter(dbCommand, "@ToState", DbType.String, pToState);

DataSet dstSearchResult = new DataSet("MoverSearchResult");
database.LoadDataSet(dbCommand, dstSearchResult, new string[] { "MoverSearchResult" }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T15:00:57.687

我怀疑您在日期时间字段中添加单引号，并将其作为字符串发送？不要那样做。对参数使用日期时间类型，不要在其中添加任何引号。

如果您向我们展示代码的 .Net 端，将会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-26T15:17:09.290

SP2 或 SP3 应在 Profiler 中解决此问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T14:55:30.383

尝试这个：

```
'2009-04-30 00:00:00.000' 
```

注意单引号和“。” 而不是“：”的毫秒。或者试试这个：

```
'2009-04-30 00:00:00' 
```

以确保它不是毫秒。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T00:29:27.270

objPropConsumer.MoveDate 是字符串吗？看起来它填充了一个在开头和结尾都有撇号的字符串。尝试将 objPropConsumer.MoveDate 替换为常量“2009-04-30 00:00:00”，看看是否可行。如果是这样，则问题出在设置或转换 MoveDate 的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-26T15:27:17.990

我会在你的数据库类中寻找问题。也许该`AddInParameter()`方法使用 DateTime 参数执行了一些 jiggery-pokery，例如添加格式化字符串或类似的愚蠢的东西。

对于与 MSSQL 一起使用，`CreateStoredProc()`绝对应该返回一个实例`SqlCommand`（您不想使用 DbCommand 的其他子类）。验证这一点，然后确保向 Parameters 集合`AddInParameter()`添加一个实例，它的属性是并且它的属性是 type 。`SqlParameter``DbType``DbType.DateTime``Value``System.DateTime`

一旦将参数正确添加到 a `SqlCommand`，它应该可以很好地与 MSSQL 存储过程一起使用，也可以与 DateTime 数据一起使用（对我来说，它有无数次）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-09T05:30:09.087

我刚刚遇到了同样的事情——事实证明这两个单引号只出现在分析器中。潜在的（实际）错误是我向存储过程传递了太多参数。

# c - 有什么方法可以更改链接以避免 HPUX 上的 LD_PRELOAD？

> ID：782124
> 
> 赞同：2
> 
> 时间：2009-04-23T14:54:33.117
> 
> 标签：c, multithreading, linker

我想我理解为什么在加载加载 libcl.2 的单线程库的多线程应用程序时需要[设置 LD_PRELOAD但我想知道是否可以使用一些链接器设置来避免这种情况。](https://stackoverflow.com/questions/752573/why-do-i-have-to-use-ldpreload-for-libcl-2-to-use-xmllibxmlcommon-on-hp-ux/771293#771293)任何帮助表示赞赏。

**更新：**

Perl 加载动态 /usr/lib/libc.2 Perl 加载 DB2.sl DB2 尝试加载动态 /usr/lib/libcl.2

**可能是因为**已经加载了具有该共享对象名称的东西然后失败了。

> /usr/lib>密码
> 
> /usr/lib
> 
> /usr/lib>ls -lt | grep libcl.2
> 
> -r-xr-xr-x 1 bin bin 1261568 2003 年 2 月 14 日 libcl.2
> 
> lrwxr-xr-x 1 根系统 2002 年 11 月 21 日 9 日 libcl.sl -> ./libcl.2

现在，chattr 输出可能解释了拒绝寻找同名内容的原因：

两者都设置了禁用字段，因此它们不会查看环境也不会使用备用名称

perl perl 上的聊天：

> ```
>  shared executable
>      shared library dynamic path search:
>          SHLIB_PATH     disabled  second
>          embedded path  disabled  first  Not Defined
>      shared library list:
>          dynamic   /usr/lib/libnsl.1
>          dynamic   /usr/lib/libnm.sl
>          dynamic   /usr/lib/libdld.2
>          dynamic   /usr/lib/libm.2
>          dynamic   /usr/lib/libsec.2
>          dynamic   /usr/lib/libpthread.1
>          dynamic   /usr/lib/libc.2 
> ```

在 DB2.sl DB2.sl 上聊天：

> ```
>  shared library
>      shared library dynamic path search:
>          SHLIB_PATH     disabled  second
>          embedded path  disabled  first  Not Defined
>      shared library list:
>          dynamic   /opt/IBM/db2/V8.1/lib/libdb2.sl
>          dynamic   /usr/lib/libcl.2 
> ```

也许可以调整其中一个库的chatr设置？

**更新：**为什么不让它们使用相同的库名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T01:33:29.400

根据您的编译器/链接器（想想我十多年前登录的 HPUX 机器让我不寒而栗），`--rpath`可能会有所帮助：据我了解，在您的情况下，rtld 首先在错误的位置查找，所以这就是为什么您想要预加载其他版本的库，对吧？在这种情况下，rpath 会在编译后的二进制文件中嵌入一个额外的搜索位置，您可以使用该位置将其指向您首选版本所在的目录。

希望这可以帮助。-V

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T06:14:36.980

我写了[一篇](http://administratosphere.wordpress.com/2007/10/19/shared-libraries-hp-ux/)关于 HP-UX 上的共享库的文章，并试图使其清晰和全面。我发现自己不得不调试为什么程序找不到它们的库，所以我记录了它。

将影响库搜索的三个主要位置是 1) /etc/SHLIBPATH；2）环境变量；3) 嵌入式库搜索路径。

不幸的是，这是一个极端的过度简化：我必须提供的最佳参考是那篇将所有东西放在一起的文章（在我看来，无论如何）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-07T20:02:44.557

没有链接器标志可以避免这种情况。

# c - 通过scanf输入字符串

> ID：782136
> 
> 赞同：2
> 
> 时间：2009-04-23T14:57:59.690
> 
> 标签：c

我想问有没有办法通过scanf在字符串中输入空白，我正在使用这个[^\n]来输入不包括换行符的内容。它是否正确？但是会产生很多问题，因为它似乎存储在输入缓冲区。输入字符串的最佳方法是什么。gets 和 fgets 都会产生很多问题，

```
 while(strcmp(buf,"quit"))
               {    
            scanf("%*[^\n]",buf);
            n=send(connected,buf,strlen(buf),0);
            if(n<0)
            {
            perror("send");
            printf("error sending");
            exit(1);
            }
            //printf("server has send\n");
            n=recv(connected,buf,100,0);
            if(n<0)
            {
            perror("recv");
            printf("error recieving");
            exit(1);
            }
            //printf("waiting to recieve something\n");
            buf[n]='\0';
            printf("client:%s\n",buf);
        } 
```

这是创建无限循环同样的事情一次又一次地重复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T15:01:34.707

读取一行输入的更好方法是

```
char line[128]; /* Or whatever. */

while(fgets(stdin, line, sizeof line) != NULL)
{
  /* Filter out whitespace before checking tokens. */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T15:14:42.117

如果您遇到的只是空行，请使用`strcmp("\n", buffer) == 0`.

您发布的正则表达式不会很好地工作，因为 C 会将`'\n'`字符转换`"%*[^\n]"`为文字换行符。为了让它更好地工作，您需要对斜线进行转义：.`"%*[^`**`\`**`\n]"`

但是，似乎问题也在于阅读，我建议您为此使用更好的功能。

我之前使用以下代码从文件中读取任意大小的连续行。

不过，请注意几点：

1.  完成后返回的缓冲区需要为`free()`d
2.  代码每次迭代都会浪费几个字节，但这并不明显，除非`BUFFER_SIZE`与行的长度相比非常小。

然而，该代码保证会从 中读取一整行，`FILE *`并以 '\n' 结尾。

```
/*
 * Initial size of the read buffer
 */
#define DEFAULT_BUFFER 1024

/*
 * Standard boolean type definition
 */
typedef enum{ false = 0, true = 1 }bool;

/*
 * Flags errors in pointer returning functions
 */
bool has_err = false;

/*
 * Reads the next line of text from file and returns it.
 * The line must be free()d afterwards.
 *
 * This function will segfault on binary data.
 */
char *readLine(FILE *file){
    char *buffer   = NULL;
    char *tmp_buf  = NULL;
    bool line_read = false;
    int  iteration = 0;
    int  offset    = 0;

    if(file == NULL){
        fprintf(stderr, "readLine: NULL file pointer passed!\n");
        has_err = true;

        return NULL;
    }

    while(!line_read){
        if((tmp_buf = malloc(DEFAULT_BUFFER)) == NULL){
            fprintf(stderr, "readLine: Unable to allocate temporary buffer!\n");
            if(buffer != NULL)
                free(buffer);
            has_err = true;

            return NULL;
        }

        if(fgets(tmp_buf, DEFAULT_BUFFER, file) == NULL){
            free(tmp_buf);

            break;
        }

        if(tmp_buf[strlen(tmp_buf) - 1] == '\n') /* we have an end of line */
            line_read = true;

        offset = DEFAULT_BUFFER * (iteration + 1);

        if((buffer = realloc(buffer, offset)) == NULL){
            fprintf(stderr, "readLine: Unable to reallocate buffer!\n");
            free(tmp_buf);
            has_err = true;

            return NULL;
        }

        offset = DEFAULT_BUFFER * iteration - iteration;

        if(memcpy(buffer + offset, tmp_buf, DEFAULT_BUFFER) == NULL){
            fprintf(stderr, "readLine: Cannot copy to buffer\n");
            free(tmp_buf);
            if(buffer != NULL)
                free(buffer);
            has_err = true;

            return NULL;
        }

        free(tmp_buf);
        iteration++;
    }

    return buffer;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T18:12:25.717

如果您的开发环境支持，您也可以使用[getline()](http://www.gnu.org/software/libc/manual/html_node/Line-Input.html#Line-Input)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-24T03:50:37.077

有两个问题`scanf("%*[^\n]",buf);`：

1.  说明符中的星号导致值被扫描，但不被存储。
2.  它一直扫描到下一个换行符，但不使用该字符。这意味着第一个呼叫之后的每个呼叫都不会读取任何内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-24T03:59:46.490

我认为您正在寻找的 scanf 是：

scanf("%[^\n]%*c", buf);

%[^\n] 获取您的字符串， %*c 忽略换行符。

但是，这就是你在谷歌上搜索“如何不读取 c 中的字符串”所得到的结果

非阻塞输入完全是另一回事。你可以用谷歌搜索“cbreak 模式”。但是，这是一个 unix-y 终端-y 的东西，如果你在 Windows 上，那可能没有意义。X/Gtk/Qt 将有其他方式来做这种事情。

# apache - .htaccess 重写不带 www 并重定向到子目录

> ID：782143
> 
> 赞同：4
> 
> 时间：2009-04-23T15:01:38.777
> 
> 标签：apache, .htaccess, mod-rewrite, redirect, rewrite

我想重定向

*   `www.example.com/*`至`example.com/*`

**同时**重定向_

*   `example.com/*`至`example.com/forum/*`

但我也有`/wiki/`and `/blog/`，`/style/`所以我**不想**重定向

*   `example.com/style/*`至`example.com/forum/style/*`

这是我目前所拥有的，但工作不正常：

```
Options +FollowSymLinks
RewriteEngine On

RewriteBase /

RewriteCond %{HTTP_HOST} !^example\.com$ [NC]
RewriteRule ^(.*)$ http://example.com/$1 [R=301,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/forum/
RewriteRule ^(.*)$ forum/$1 [R=301,L] 
```

澄清：我的问题可以用更简单的方式提出。

我想将*空的 REQUEST_URI*或*/*或*不存在的文件重定向到根目录*中的**/forum/**。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T15:10:24.107

尝试这个：

```
RewriteEngine On

RewriteCond %{HTTP_HOST} ^example\.com
RewriteRule ^(.*)$ http://example.com/$1 [R=301,QSA,L]

RewriteCond %{REQUEST_URI} !^/(wiki|blog|style|forum)
RewriteRule ^(.*)$ http://www.example.com/forum/$1 [R=301,QSA,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T15:19:37.753

我会使用这些规则：

```
# redirect www.example.com to example.com
RewriteCond %{HTTP_HOST} ^www\.example\.com$
RewriteRule ^ http://example.com%{REQUEST_URI} [L,R=301]

# prefix everything but /forum/, /wiki/, /blog/, /style/ with /forum/ and rediret to it
RewriteRule !^(forum|wiki|blog|style)/ /forum%{REQUEST_URI} [L,R=301] 
```

第二条规则可以另外替换为这条规则，以检查每个请求的第一个路径段的存在。

```
# check if first segment of requested URI path is either missing
RewriteCond $0 ^$ [OR]
# or cannot be mapped to an existing directory
RewriteCond %{DOCUMENT_ROOT}$0/ !-d
RewriteRule ^[^/]* /forum%{REQUEST_URI} [L,R=301] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-12T19:14:01.330

我没有所有问题的答案，但对于您的**www/no www**问题，您可以试试这个：

```
# Enforce www
# If you have subdomains, you can add them to 
# the list using the "|" (OR) regex operator
RewriteCond %{HTTP_HOST} !^(www|subdomain) [NC]
RewriteRule ^(.*)$ /exemple/$1 [L,R=301]

# Enforce NO www
RewriteCond %{HTTP_HOST} ^www [NC]
RewriteRule ^(.*)$ http://exemple.com/$1 [L,R=301] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T15:05:54.897

我会说这应该有效。

```
RewriteEngine on
RewriteRule ^forum/(.*)$ forum/$1 [L]
RewriteRule ^wiki/(.*)$ wiki/$1 [L]
RewriteRule ^blog/(.*)$ blog/$1 [L]
RewriteRule ^style/(.*)$ style/$1 [L]

RewriteRule ^(.*)$ forum/$1 [L]

RewriteCond  %{HTTP_HOST}  ^www.example\.com$
RewriteRule ^(.*)$ http://example.com/$1 
```

# version-control - 您如何看待 TFS 中某个版本的更改？

> ID：782145
> 
> 赞同：4
> 
> 时间：2009-04-23T15:02:09.727
> 
> 标签：version-control, tfs

我正在尝试从 VSS 迁移到 TFS，并且我需要能够显示在两个版本之间签入了哪些文件。在 VSS 中，我们只需标记发布的代码并查看标签之间的历史记录，并生成报告以显示签入和评论。有没有办法使用 TFS 获得类似的结果？或者显示两个变更集或标签之间的差异？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T15:50:23.920

命令行工具`tf.exe`为您提供了比 GUI 更多的选项（并且可以在对话中提供结果或作为标准输出 --- 有利于进一步处理）。

例如

```
tf hist . -r /version:C10~C1000 
```

将在变更集 10 和 1000 之间递归列出影响此文件夹和内容的所有变更集。

请参阅[MSDN](http://msdn.microsoft.com/library/yxtbh4yh.aspx)上的文档。

如果您需要最大的灵活性，您可以使用 TFS 客户端程序集创建您自己的命令。不幸的是，[文档](http://msdn.microsoft.com/library/bb130146.aspx)有些稀疏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T15:15:15.467

右键单击 TFS 上所需的文件夹（例如根文件夹），您会发现以下两个选项：

1，应用标签 - 这允许您将标签应用到该文件夹​​的特定版本。2，比较 - 这允许您在版本之间比较该文件夹，其中一种选择是按标签比较。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-02T06:03:02.290

右键单击 TFS 源代码控制中的任何节点并选择“查看历史记录”这将显示按日期降序排列的所有变更集。

双击它们，您可以看到有关更改集的详细信息：注释、关联的工作项和已更改的文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T17:35:37.010

正如 Jeff 所说，右键单击项目、任何文件夹或文件，然后选择“查看历史记录”以查看所有更改。如果您知道标签的应用时间，则可以轻松向下滚动此列表，直到您找到特定的日期/时间。

对于两个标签或更改之间的确切列表，请从 Visual Studio 命令提示符（在 Visual Studio 2005 文件夹的开始菜单中）使用“tf.exe 历史记录”（如 Richard 所说）。有关这方面的更多信息，只需执行“tf.exe help history”。

对于日常更改，如果您使用 TFS 构建，您可以在构建信息页面底部看到自上次构建以来的更改（在团队资源管理器中双击构建名称，然后双击特定构建。滚动到底部此页面并打开“关联的变更集”。我已将 CI 构建设置为不关联变更集，这意味着我们的每日测试构建列出了自上次每日构建以来的所有变更集 - 对我们的测试人员进行更改的一个很好的总结进入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-30T21:16:06.847

我正在使用命令行 tf hist 并通过在标签或分支变更集中找到最高变更集来比较变更集，但是手动过程和使用命令行在这里并没有很好地进行。我使用[Carl Daniel 的代码](http://support.larucorp.com/blogs/carld/archive/2006/07/27/77.aspx)编写了一个小 Web 应用程序，它将更改绑定到数据网格。

如果您正在寻找一些特殊的标准接口并没有给您，那么编写您自己的链接到 TFS 的应用程序是相当简单的。我肯定会推荐它。

# mysql - InnoDB“表已满”错误

> ID：782150
> 
> 赞同：11
> 
> 时间：2009-04-23T15:03:57.523
> 
> 标签：mysql, innodb

我在 RedHat Enterprise Linux 4 服务器上有一个 MySQL InnoDB 表，在尝试导入以前使用备份的数据库后，`mysqldump`出现“表已满”错误。

该表当前有 463,062 行，`ibdata1`磁盘上的文件当前为 3.37Gb。一个快速的 " `SHOW VARIABLES;`" 显示`innodb_data_file_path`设置为`ibdata1:10M:autoextend`，并且文件系统是 ext3，所以我希望它有足够的空间来增长。

有什么想法可以让我确切地确定问题所在吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-03-26T11:26:12.497

检查存储 InnoDB 数据文件的磁盘是否未满

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T16:22:53.797

如果我是你，我会尝试实际设置 innodb_data_file_path 命令的最后一部分，即 innodb_data_file_path ibdata1:10M:autoextend:max:3999M

不指定大数字有时会使其默认为不可预测的数字。

不要太明显，但请确保在更改配置后重新启动！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-09-23T21:24:44.203

我们在 AWS 上的 CentOS 上修复了完全相同的问题。与大多数帖子所表明的相反，这可以通过在 my.cnf 文件中 [mysqld] 部分的正下方添加来解决：

```
innodb_data_file_path=ibdata1:10G:autoextend 
```

# java - 休眠查询

> ID：782159
> 
> 赞同：0
> 
> 时间：2009-04-23T15:07:16.250
> 
> 标签：java, hibernate

使用命名查询（位于您的休眠映射 xml 文件中）是将查询与业务逻辑分开的好方法。但是，如果您使用 Hibernate Annotations 进行映射，还有哪些选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T15:15:58.820

也许您已经知道，但是有一个 @NamedQuery 注释。但是，我什至无法说服自己，这比在适当的 DAO 中硬编码查询字符串有任何好处（前提是您使用的是 DAO 而不是直接访问会话 - 那么可能会有 @NamedQuery 注释的情况） .

# javascript - jQuery 表单输入

> ID：782166
> 
> 赞同：0
> 
> 时间：2009-04-23T15:09:04.953
> 
> 标签：javascript, jquery

我正在尝试使用单选按钮作为点击功能：

```
$("input[type=radio]").click(function(){ 
```

而且我不只是想要单选按钮，我想要带有“婴儿”类的单选按钮，或者如果更容易的话，我什至可以按名字来做，搜索谷歌，我找不到任何东西:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T15:11:43.043

这个怎么样 ：

```
$("input[type=radio][class=baby]").click(function(){ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T15:15:57.167

你可以有多个选择器

```
$("input[type=radio]", ".baby").click(function(){} 
```

[这里](http://www.pamaya.com/jquery-selectors-and-attribute-selectors-reference-and-examples/)有很好的例子

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T15:27:34.583

使用第一个选择器全局选择您的输入，然后使用第二个选择器进行过滤。

```
$("input[type=radio]").filter(".baby") 
```

# unicode - 在 Windows 上显示 U+FFFF 上方的 Unicode 字符

> ID：782167
> 
> 赞同：2
> 
> 时间：2009-04-23T15:09:50.020
> 
> 标签：unicode, windows-xp, utf-16, astral-plane

我正在使用 EVC++ 4 开发的应用程序在 Windows CE 5 上运行并且应该支持 unicode（AFAIK wchar_t 在 Windows 上使用 UTF-16，所以我正在使用它），所以我希望能够用“更具异国情调”来测试它人物。尤其是在 UTF-16 中使用 4 字节而不仅仅是 2 字节的字符。因此，我试图在文本编辑器中显示这些字符（atm 在我的带有 Windows XP 的台式 PC 上，而不是在嵌入式设备上）。

但我还没有做到这一点。作为一个例子，我选择[了这个角色](http://www.fileformat.info/info/unicode/char/10800/index.htm)。就像[这里](http://www.fileformat.info/info/unicode/char/10800/fontsupport.htm)提到的“MPH 2B Damase”应该支持这个角色。所以我下载了字体并将其放入 Windows\Fonts。我使用十六进制编辑器（只是为了确定）创建了一个文本文件，其中包含以下内容：

```
FFFE D802 DC00
```

当我用记事本打开它（应该支持 unicode，对吗？）并使用下载的字体时，它不会按预期显示 1 个字符，但这是 2：

```
˘Ü
```

我究竟做错了什么？:)

谢谢！

赫尼尔斯

**编辑：** 按照建议翻转 BOM 不起作用。在这种情况下，记事本（以及我尝试过的所有其他编辑器）显示两个正方形。有趣的是，如果我在这里复制两个方块（使用 firefox），我会看到正确的字符：

```
我也用 Komodo Edit 进行了尝试，结果相同。使用 UTF-8 也无助于记事本。

            回答 #1

赞同：1

时间：2009-04-23T15:27:19.937

您的文本编辑器可能不喜欢 UTF-16。它可能假定为 ANSI 或 UTF-8。

尝试输入等效的 UTF-8：

```
0xF0 0x90 0xA0 0x80 
```

这不会帮助您进行测试，但会确保您的字体没有问题。支持 UTF-16 的文本编辑器是[Komodo Edit](http://www.activestate.com/komodo_edit/)。

            回答 #2

赞同：1

时间：2009-04-23T15:37:50.970

如果你把字节顺序标记反过来会发生什么？

*FEFF* D802 DC00

（目前字节序列被解释为两个字符 U+02D8 U+00DC，因此希望翻转 BOM 将导致字节按预期顺序读取）

            回答 #3

赞同：1

时间：2010-08-12T10:02:42.733

可能您忘记阅读[`_wfopen()`](http://msdn.microsoft.com/en-us/library/yeby3zcb(VS.80).aspx)文档了。他们在那里指定编码参数。顺便说一句，我假设您已经在使用 Unicode (wchars)。

我建议您在有或没有 BOM 的文件中使用 UTF-8，但强制您的 fopen 使用 UTF-8 标志。它看起来`_wfopen("newfile.txt", "r, ccs=UTF-8");`适用于带或不带 BOM 的 UTF-8 以及 UTF-16。不要错误地使用`ccs=Unicode`.UTF-8 文件而没有 BOM 是很常见的事情。

在尝试工作之前，您真的应该阅读一点关于 Unicode 的知识。这是一项非常好的投资——如果您了解 Unicode 的工作原理，它将为您节省时间。

这是一个开始[http://blog.i18n.ro/newbie-guide-to-unicode/](http://blog.i18n.ro/newbie-guide-to-unicode/)并且不要忘记阅读文章末尾的链接。

如果您真的需要一个简单的文本编辑器，可以让您使用 Unicode 编码，请使用[Notepad++](http://notepad-plus-plus.org/)并忘记记事本。

        c - 通过scanf抑制输入中的空格

ID：782177

赞同：0

时间：2009-04-23T15:11:20.143

标签：c, stdio

为了抑制换行，我们使用 %[^\n]。您能否建议在输入中跳过空白的格式应该是什么，即如果我们必须输入“hallo stackflow”。我知道 fgets 和 gets 但我不想使用它们，它们正在制造问题。

            回答 #1

赞同：1

时间：2009-04-23T15:36:29.697

我认为您的意思是“包括空格”。采用：

```
#define str(x) #x
#define xstr(x) str(x)
/* ... */
char buf[ SIZE + 1 ] = "";
int rc = scanf("%" xstr(SIZE) "[^\n]%*[^\n]", buf);
/*you may need the return value later on, if reading
  in multiple strings with whitespaces in a loop */
if (!feof(stdin)) 
     getchar(); /* consume newline */ 
```

            回答 #2

赞同：0

时间：2009-04-23T15:28:48.217

[在scanf](http://en.wikipedia.org/wiki/Scanf)格式中放一个空格；抑制空格。

        java - 如何在 Java 中将字符串转换为 InputStream？

ID：782178

赞同：951

时间：2009-04-23T15:11:23.667

标签：java, string, type-conversion, inputstream

给定一个字符串：

```
String exampleString = "example"; 
```

如何将其转换为`InputStream`?

            回答 #1

赞同：1524

时间：2009-04-23T15:12:04.023

像这样：

```
InputStream stream = new ByteArrayInputStream(exampleString.getBytes(StandardCharsets.UTF_8)); 
```

请注意，这假设您需要一个 InputStream ，它是一个字节流，表示编码为*UTF-8*的原始字符串。

对于低于 7 的 Java 版本，替换`StandardCharsets.UTF_8`为`"UTF-8"`.

            回答 #2

赞同：285

时间：2009-04-23T16:04:16.197

我发现使用[Apache Commons IO](http://commons.apache.org/io/)让我的生活更轻松。

```
String source = "This is the source of my input stream";
InputStream in = org.apache.commons.io.IOUtils.toInputStream(source, "UTF-8"); 
```

您可能会发现该库还提供了许多其他常用任务的快捷方式，您可以在项目中使用这些快捷方式。

            回答 #3

赞同：41

时间：2009-04-23T15:24:42.780

您可以使用[StringReader并使用](http://docs.oracle.com/javase/8/docs/api/java/io/StringReader.html)[其他 stackoverflow 帖子](https://stackoverflow.com/questions/62241/how-to-convert-a-reader-to-inputstream-and-a-writer-to-outputstream)中的解决方案将阅读器转换为输入流。

            回答 #4

赞同：6

时间：2021-01-16T02:31:41.327

在 Java 中有两种方法可以将 String 转换为 InputStream，

1.  使用 ByteArrayInputStream

例子 ：-

```
String str = "String contents";
InputStream is = new ByteArrayInputStream(str.getBytes(StandardCharsets.UTF_8)); 
```

2.  使用 Apache Commons IO

例子：-

```
String str = "String contents"
InputStream is = IOUtils.toInputStream(str, StandardCharsets.UTF_8); 
```

            回答 #5

赞同：0

时间：2020-07-01T01:06:24.307

你可以试试[仙人掌](https://github.com/yegor256/cactoos/)。

```
final InputStream input = new InputStreamOf("example"); 
```

[出于某种原因](https://www.yegor256.com/2017/11/14/static-factory-methods.html)，该对象是使用`new`而不是静态方法创建的。

        actionscript-3 - 构造函数参数问题 ActionScript 3

ID：782180

赞同：2

时间：2009-04-23T15:11:38.830

标签：actionscript-3, constructor, arguments

我在 Actionscript 中定义了一个自定义类，我想在 Flash 应用程序的主文档中创建它的一个实例。但是，在使用一个参数调用构造函数后，Flash 给了我这个错误：

```
Error #1063: Argument count mismatch on coa.application::MenuItem(). Expected 1, got 0. 
```

这是我的课：

```
public class MenuItem extends MovieClip{
    var button:SimpleButton;

    public function MenuItem(buttonLoc:uint) {

        button = new InvBtn();
        this.addChild(button);
        button.x=-81;
        button.y=buttonLoc*33;
        button.addEventListener(MouseEvent.CLICK, mybringToFront);
    }
} 
```

这是我尝试调用它的构造函数：

```
var menu1:MovieClip = new MenuItem(3); 
```

有什么想法，怎么了？

            回答 #1

赞同：3

时间：2009-04-23T15:21:11.150

抱歉，我还不能发表评论，或者我会把它放在评论中。

你确定：

var menu1:MovieClip = new MenuItem(3);

是您构建新 MenuItem 的唯一地方吗？您没有任何机会将 MenuItem 类附加到舞台上的某些实例吗？

我将您的代码更改为这个（只是为了让我可以运行它）并且它工作正常：

```
package{
    import flash.display.MovieClip;
    import flash.display.SimpleButton;
    import flash.events.MouseEvent;
    public class MenuItem extends MovieClip{

            var button:SimpleButton;

            public function MenuItem(buttonLoc:uint) {

                    button = new SimpleButton();
                    this.addChild(button);
                    button.x=-81;
                    button.y=buttonLoc*33;
                    button.addEventListener(MouseEvent.CLICK, mybringToFront);
            }

            public function mybringToFront(event:MouseEvent):void{
                trace('blah');
            }
    }
} 
```

            回答 #2

赞同：1

时间：2009-04-23T17:00:34.267

就像 quoo 说的那样，很可能你有一个类在舞台上附加到的对象的实例。要对此进行测试，请执行以下操作：

```
 public class MenuItem extends MovieClip{
        var button:SimpleButton;

        // I changed it to int, cuz uint is extremely slow for any math
        // other than bitwise operators, int is fast as long as no fractions
        public function MenuItem(buttonLoc:int = -1) {
                if (buttonLoc == -1)
                    trace("On stage instance found! Location: "+x+", "+y);

                button = new InvBtn();
                this.addChild(button);
                button.x=-81;
                button.y=buttonLoc*33;
                button.addEventListener(MouseEvent.CLICK, mybringToFront);
        }
} 
```

        .net - 使用 Microsoft ODBC for Oracle 连接到 Oracle 10g 数据库

ID：782181

赞同：4

时间：2009-04-23T15:11:40.517

标签：.net, oracle, oracle10g, odbc, ora-12514

我正在尝试使用内置的 Microsoft ODBC for Oracle 驱动程序连接到 Oracle 10g 数据库。我想使用 dnsless 连接，所以我从[www.connectionstrings.com](http://www.connectionstrings.com/oracle#17)获取连接字符串。

理想情况下，我不必设置 DNS 条目或 Oracle TNS 条目，我可能弄错了，但我认为上面的内容会为我做到这一点。我得到以下信息：

```
ERROR [NA000] [Microsoft][ODBC driver for Oracle][Oracle]ORA-12514:
TNS:listener does not currently know of service requested in connect
descriptor

ERROR [IM006] [Microsoft][ODBC Driver Manager]
Driver's SQLSetConnectAttr failed

ERROR [01000] [Microsoft][ODBC Driver Manager] 
The driver doesn't support the version of ODBC behavior that the
application requested (see SQLSetEnvAttr)." 
```

据我在网上知道，其他人已经使用 Microsoft ODBC for Oracle 驱动程序连接到 10g，但也许我遗漏了一些东西。顺便说一句，我正在从 vb.net 应用程序连接。

            回答 #1

赞同：9

时间：2009-04-23T15:29:38.557

使用 10g，您可以使用[EZCONNECT](http://www.orafaq.com/wiki/EZCONNECT)功能。要连接到服务器 myServer 上名为 ORCL 的 Oracle 实例，连接字符串应如下所示：

```
Driver={Microsoft ODBC for Oracle};Server=myServer:1521/ORCL;Uid=myUsername;Pwd=myPassword; 
```

            回答 #2

赞同：2

时间：2009-04-23T20:38:15.740

我不确定回答您自己的问题是多么洁净，但我发现了一个连接字符串，这更像是我正在寻找的：

```
"Driver={Microsoft ODBC for Oracle}; " & _
                                 "CONNECTSTRING=(DESCRIPTION=" & _
                                 "(ADDRESS=(PROTOCOL=TCP)" & _
                                 "(HOST=myserver)(PORT=1521))" & _
                                 "(CONNECT_DATA=(SERVICE_NAME=servicename))); " & _
                                 "uid=username;pwd=password; 
```

            回答 #3

赞同：0

时间：2009-04-23T15:16:56.217

您需要在 tnsnames.ora 文件中为要连接的服务添加一个条目。或者，您可以转到该文件的 gui 界面：

```
Start->Programs->Oracle->Configuration and Migration Tools->Net Configuration Assistant 
```

并在那里建立你的 oracle 连接。然后，ODBC 将能够解析服务名称。

        visual-studio-2008 - 是否可以通过脚本自动生成我的 Linq2Sql DBML？

ID：782186

赞同：4

时间：2009-04-23T15:13:12.150

标签：visual-studio-2008, linq-to-sql, .net-3.5, sqlmetal

我使用 Linq2Sql，并且厌倦了每次数据库更改时都重新创建 dbml。考虑到我想要所有表和所有过程，是否可以编写模型的创建脚本？理想情况下，它将是构建过程或自定义工具的一部分。

一个简单的“从模式刷新”按钮也可以，但据我所知，没有这样的事情。目前，我必须更新我的模型的唯一方法是删除已更改的表和过程，然后从服务器资源管理器中重新拖动它们。

也许我错过了什么？

            回答 #1

赞同：4

时间：2009-04-23T15:16:53.347

我想你可以使用[SQLMetal](http://msdn.microsoft.com/en-us/library/bb386987.aspx)命令工具

由 OP 编辑​​：我最终编写了一个批处理文件来签出代码，用它生成类，然后提交代码。然后，我创建了一个数据库架构更改级别触发器，以便在架构更改时运行此批处理文件。因此，现在，当架构更改时，Linq 类被创建、签入，然后 CCNet 创建 DLL 并分发它。甜的......

            回答 #2

赞同：0

时间：2009-04-23T15:52:25.257

如果钱不是问题，最好的办法是获取Visual Studio 2008团队系统的数据建模版，创建一个数据库项目并用它来维护数据库、数据模型和实体模型。保持数据库和实体模型同步并不是零工作，但是使用模式比较工具，它离它不远（它肯定会为你完成所有苦差事）。

恕我直言，数据建模和设计往返证明购买 Visual Studio 2008 团队版的成本高于专业版。

            回答 #3

赞同：0

时间：2014-04-25T21:25:18.380

**SQLMetal**

[http://msdn.microsoft.com/en-us/library/bb386987(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/bb386987%28v=vs.110%29.aspx)

SqlMetal 命令行工具为 .NET Framework 的 LINQ to SQL 组件生成代码和映射。SqlMetal 可以执行多种不同的操作，包括：

从数据库中，生成源代码和映射属性或映射文件。

从数据库生成中间数据库标记语言 (.dbml) 文件以进行自定义。

从 .dbml 文件生成代码和映射属性或映射文件。

此工具随 Visual Studio 自动安装。

**SQLMetalPlus**

可以在 Visual Studio 中使用刷新按钮自动生成 .dbml 的项目。

[http://www.codeproject.com/Articles/37198/SqlMetalPlus-A-VS-Add-in-to-Manage-Custom-Changes](http://www.codeproject.com/Articles/37198/SqlMetalPlus-A-VS-Add-in-to-Manage-Custom-Changes)

**SQLMetalPlus 在 Github 上分叉**

包括预建的安装程序。

[https://github.com/thedemz/dotnet-sqlmetal-plus](https://github.com/thedemz/dotnet-sqlmetal-plus)

        latex - 乳胶目录链接到错误的部分

ID：782187

赞同：23

时间：2009-04-23T15:13:17.720

标签：latex, pdflatex, texmaker

我有一个部分，后面是一个目录，如下所示：

```
\section{Section1}
ABC.

\addcontentsline{toc}{section}{Table of Contents}
\tableofcontents
\newpage
\addcontentsline{toc}{section}{List of Figures}
\listoffigures
\newpage

\section{Section2}
DEF.
\section{Section3}
GHI. 
```

我的问题是目录中的“目录”和“图形列表”条目（在生成的 pdf 中）链接到文件中的错误位置。它们都链接到第 1 页的第一部分。表中的条目是正确的（TOC 表示第 2 页，LOF 表示第 3 页），但链接到错误的位置。

            回答 #1

赞同：29

时间：2009-04-24T16:23:59.073

您需要使用以下`\phantomsection`命令：

```
\section{Section1}
ABC.
\phantomsection
\addcontentsline{toc}{section}{Table of Contents}
\tableofcontents
\newpage
\phantomsection
\addcontentsline{toc}{section}{List of Figures}
\listoffigures
\newpage

\section{Section2}
DEF.
\section{Section3}
GHI. 
```

请参阅[hyperref 手册](http://www.tug.org/applications/hyperref/manual.html)。

            回答 #2

赞同：2

时间：2009-08-04T20:12:16.313

如果您正在为参考书目、表格列表或图形列表执行此操作，

```
\usepackage[nottoc]{tocbibind} 
```

应该修复它，没有错误的页面问题。否则，我没有遇到比使用 \addcontentsline 的 \phantomsection 更好的解决方案。

            回答 #3

赞同：0

时间：2009-04-23T15:56:13.237

这种行为是由于`\tableofcontents`在写入内容之前插入了分页符。因此，您的 PDF 书签将指向之前的页面。根据您的文档类，您可以手动插入许多`\newpage`命令以防止`\tableofcontents`添加另一个命令。一两个应该就够了。

我知道，这是一个 hacky 解决方案，并且可能存在解决问题的包，但这就是我解决问题的方法。

        iphone - 当Apple谈论“图形状态”时，它们是指我创建的图形还是我使用的设置？

ID：782188

赞同：0

时间：2009-04-23T15:13:44.457

标签：iphone, core-graphics

他们说，有一个堆栈可以保存图形状态。好吧，我不确定他们所说的这个词是什么意思。CGContextSaveGState 是保存我当前绘制的绘图，还是保存我当前拥有的绘图设置，如颜色、线宽、字体大小等？

            回答 #1

赞同：4

时间：2009-04-23T15:18:02.390

[`CGContextSaveGState`文档](http://developer.apple.com/documentation/graphicsimaging/reference/CGContext/Reference/reference.html#//apple_ref/c/func/CGContextSaveGState)明确说明了状态中保存的内容。

每个图形上下文都维护着一堆图形状态。请注意，并非当前绘图环境的所有方面都是图形状态的元素。例如，当前路径不被视为图形状态的一部分，因此在调用 CGContextSaveGState 函数时不会保存。保存的图形状态参数有：

*   CTM（当前变换矩阵）

*   剪辑区域

*   图像插值质量

*   行宽

*   线连接

*   斜接限制

*   线帽

*   划线

*   平整度

*   应该抗锯齿

*   渲染意图

*   填充色彩空间

*   描边颜色空间

*   填色

*   描边颜色

*   阿尔法值

*   字体

*   字体大小

*   字符间距

*   文字绘制模式

*   阴影参数

*   模式阶段

*   字体平滑参数

*   混合模式

所以不，您所做的绘图不会被保存（尽管它也没有被清除）。而是保存了许多图形状态参数。然后，您可以通过调用恢复到您保存的状态[`CGContextRestoreGState`](http://developer.apple.com/documentation/graphicsimaging/reference/CGContext/Reference/reference.html#//apple_ref/c/func/CGContextRestoreGState)。

        javascript - javascript - 在结果集中访问数据类型为 varchar(max) 的字段

ID：782189

赞同：1

时间：2009-04-23T15:13:45.457

标签：javascript, sql-server-2005, resultset, varchar

在一个 javascript 应用程序中，我们在 SQL Server 2005 上调用一个存储过程，它返回一个具有 3 列类型的结果集：bigint、varchar(20) 和 varchar(MAX)。

调用存储过程并读取结果时，没有抛出异常。枚举结果集时：

```
var dbConn = DatabaseConnectionFactory.createDatabaseConnection("1","2","3","4");    
var myResultSet = dbConn.executeCachedQuery("EXEC MySproc");
dbConn.close();

var myString = myResultSet.getString("MyVarcharMaxField"); 
```

在检查 myString 的值时，该值不是我所期望的：

```
javax.sql.rowset.serial.SerialClob@15b4206 
```

知道如何获得该领域的真正价值吗？

可能调用 getString() 以外的其他方法？

            回答 #1

赞同：2

时间：2009-04-25T09:55:54.583

**Varchar(MAX)**是一种**CLOB**（字符大对象）数据类型。这里有一些代码可以用来读取它的内容。

```
var clobField = myResultSet.getClob("MyVarcharMaxField");
var strOut = new java.lang.StringBuffer();
var aux = new java.lang.String();

// RTF data conversion

var kit = new Packages.javax.swing.text.rtf.RTFEditorKit();
var doc = new Packages.javax.swing.text.DefaultStyledDocument();
kit.read(clobField.getAsciiStream(), doc, 0);

var text = doc.getText(0, doc.getLength());
var myString = text.toString(); 
```

        asp.net - 最高效/优雅的地址验证

ID：782190

赞同：1

时间：2009-04-23T15:14:12.117

标签：asp.net, vb.net, validation, google-maps

我制作了这个小型位置类，以便我可以更好地处理将在向 Google Maps API 的请求中发送的地址信息。我要做的一件事是进行一些验证，以确保该地址有足够的信息来返回结果。

对于应用程序，准确度级别应该与单个城市一样松散（这意味着只要提供邮政编码或城市/州，它就应该工作，因为它会在 Google 地图中自动找到该区域的地理中心）。

所以像：

*   地址 1、地址 2、城市、州、邮编
*   地址 1，城市，州，邮编
*   地址 1，城市，邮编
*   地址 1，邮编
*   市，州

应该都可以工作，而像

*   地址 1、地址 2、状态
*   状态
*   城市
*   地址1
*   地址2
*   地址 1、地址 2

不起作用，因为它要么会返回潜在的大量结果，要么会将地理中心置于我想要的精度范围之外。

**注意**我确信我可以列出许多其他有效和无效的组合，但我希望我提供了足够的示例来正确概述此处的“精度范围”。

```
Public Class Location
    Private _Address1 As String
    Private _Address2 As String
    Private _City As String
    Private _State As String
    Private _ZIP As String

    Public Function isValid() As Boolean   
        'Insert validation code here'
    End Function

End Class 
```

我知道您可以使用一大堆`If`语句来检查是否存在，是否存在其他内容，以及是否不存在其他内容，等等，但我觉得这将是一大块逻辑代码。

有没有更有效/优雅的方式来确保我在请求中发送它之前有一个有效的位置？

            回答 #1

赞同：2

时间：2009-04-23T15:20:40.637

就必需项目而言，您的规则实际上可以归结为：

有效地址必须包含邮政编码或城市和州。

据我所知，满足该规则的一切都应该没问题。您的验证代码可以很简单：

```
Public Function isValid() As Boolean   
    If (String.IsNullOrEmpty(city) or String.IsNullOrEmpty(state)) And _
        String.IsNullOrEmpty(zip) Then

        Return False
    Else
        Return True
    End If
End Function 
```

显然，您可能还想检查字段中的值是否符合预期（正确的 ZIP 长度、有效状态等）

顺便说一句，您可能需要考虑从 IsValid 检查返回的不仅仅是布尔值。如果结果是有效的，一个简单的 true 就足够了，但通常返回值是 false 你想知道*为什么*它是无效的。我通常会做类似的事情：

```
Class ValidationResult
    Public Property IsValid as Boolean
    Public Property Errors as IEnumerable<String>
End Class 
```

            回答 #2

赞同：1

时间：2009-04-23T15:26:12.340

上述标准难道不会归结为：

```
Public Function isValid() As Boolean   
    Return _
        Not String.IsNullOrEmpty(_ZIP) _
        Or Not (String.IsNullOrEmpty(_City) Or String.IsNullOrEmpty(_State))
End Function 
```

        language-agnostic - 你如何应对编码员昏迷？

ID：782193

赞同：66

时间：2009-04-23T15:15:08.057

标签：language-agnostic

作为一名程序员，我有时会发现自己处于被处理一项非常乏味和无聊的任务的位置。这并不奇怪，如果编程的所有方面都非常具有挑战性和乐趣，那就太奇怪了，但这并不能改变我希望没有这些类型的任务也能生活的事实。

在大多数情况下，我只是通过尽可能快地完成任务来完成任务，但其他时候并不那么容易。我发现自己除了完成无聊的任务之外什么都做，如果必须的话，我还要承担多项其他任务，这样我就有了不完成的理由。这当然会影响我的职业生涯，因为我不断地从一个挑战跳到另一个挑战，在我身后留下一堆未完成的废话。

你如何应对编码员昏迷？在完成无聊的事情时，有什么技巧可以提高工作效率吗？

            回答 #1

赞同：28

时间：2009-04-23T15:31:31.407

我非常喜欢 Steve Pavlina 的[时间盒](http://www.stevepavlina.com/blog/2004/10/timeboxing/)方法来摆脱繁琐的任务。它适用于您是否有无聊的代码猴子工作要破解，还是家里壁橱里有一堆垃圾需要整理。

tl; 链接博士：时间盒意味着分配一个时间片，然后工作，切断会让你落后的东西。这是为了摆脱拖延的动机，不要让繁琐的任务花费超过其价值的时间。除了繁琐的任务之外，时间盒还可以用来解决一些复杂到你不知道从哪里开始的问题。

            回答 #2

赞同：23

时间：2009-04-23T15:19:20.237

当我*知道*我正在推迟做某事（通过做其他任务或只是一般地懈怠）时，我会做的一件事是在一张纸上写下我那天要做什么的时间表。这听起来很愚蠢，但试试吧。只需写下您将要做什么以及在什么时间范围内。在你的清单上划掉一个项目的感觉很棒，但是把整个清单都扔掉的感觉更好。

            回答 #3

赞同：16

时间：2009-04-23T15:19:23.997

如果任务因为重复而乏味，我会编写一个程序来为我完成任务。;-)

            回答 #4

赞同：10

时间：2009-04-23T15:21:33.477

将其传递给其中一名实习生

            回答 #5

赞同：5

时间：2009-04-23T15:24:16.667

我通常会尝试以新的方式解决问题。例如，使用您刚刚学到的东西。显然预计会有错误和更长的开发时间，但至少它仍然很有趣。

或者你可以从世界的另一端雇佣一些廉价的程序员来为你完成工作:)

            回答 #6

赞同：4

时间：2009-04-23T15:19:34.527

放大器......很多很多的放大器......一个好的糖嗡嗡声是我有时需要的所有动力......

            回答 #7

赞同：4

时间：2009-12-16T12:23:47.227

没有人提到番茄工作法。Timebox 25 分钟，您希望完全不受干扰，关闭电子邮件、电话、IM 客户端等。

当只做一件事时，您实际上可以完成多少工作，这真是令人惊讶:)

此页面上有关[番茄工作法的更多信息](http://www.pomodorotechnique.com/)

            回答 #8

赞同：3

时间：2009-04-23T15:28:44.970

我通常会做一个日常祈祷（礼拜），然后我对自己说：“在完成那个之前，你不要回家，不管是什么任务，或者你需要在办公室呆多久。”

            回答 #9

赞同：3

时间：2009-04-23T15:20:22.370

没有一种简单的方法。最糟糕的事情是开始多任务处理以避免处理无聊的事情。到目前为止，最好的方法就是尽快并尽快完成它。如果任务非常庞大，比如需要几周甚至几个月的工作，这就会成为一个问题，因为很难激励自己日复一日地处理乏味的废话。

再说一遍，这都是工作的一部分。你也可以在 Kwik-e-mart 工作或在某处扫地。不幸的是，繁琐的任务也需要完成，而且没有快速简便的方法可以摆脱它。

            回答 #10

赞同：3

时间：2009-04-23T15:44:31.267

一个）。尝试做一些新的事情作为无聊任务的一部分。那可能是用一种新语言编写它，或者使用不同的框架技术。例如，最近我尝试将一个 Restful-MVC 框架从头开始编写到 .NET 2.0 中。

乙）。将我的时间 50/50 分配给一个有趣的项目，总是把有趣的事情推迟到下午（最好将刺激的工作与那个昏昏欲睡的午后脑力衰竭周期相吻合）

C）。如果你真的必须熬过它，那就用工作之外的东西犒劳自己，这样你就不会太沮丧了。垃圾食品、睡眠、Xbox 时间等等。希望你的伴侣能包容:)

            回答 #11

赞同：2

时间：2009-04-23T15:29:59.633

将任务分解成原子片段（尽可能），然后按照 ryeguy 对任务列表的建议。我喜欢使用“完成工作”方法 (GTD)，并将该任务的各个部分合并到我的其余工作中。拆开它有助于最大限度地减少无聊，并使用结构化的任务方法确保我仍然可以完成所有工作。

在垃圾任务结束时，奖励自己并将其用作未来同类任务的驱动力。

            回答 #12

赞同：2

时间：2009-04-23T15:35:55.233

当我变成这样时，我想起了[一个伟人](http://en.wikipedia.org/wiki/Hillel_the_Elder)不得不说的话：**如果不是现在，什么时候**？我就是这么做的。我发现等待有动力去做事情会让我一事无成。我还发现做事，即使我不想做，也会让我有动力继续前进并继续从事我的项目。

            回答 #13

赞同：2

时间：2009-04-28T13:12:32.433

1.  将任务分解成不那么烦人的块。
2.  尽可能多地占用你的大脑：如果这项任务只需要你 20% 的智力，你可能可以在后台收听 CNN 广播（例如用你学过的其他语言）。如果它需要你全神贯注，听听你能听的任何音乐，不要分心。
3.  避免简单的碳水化合物（尤其是糖）。这是个人的，但我发现它们会导致我崩溃并需要小睡。有时这很好。
4.  与你的丈夫/妻子/朋友/等打架。预先。这会让你很难集中注意力，然后无聊的任务就是天赐之物。
5.  很多时候，重复性任务的编码比执行好。我最终在 Excel/OpenOfficeSpreadsheetThinger 中编写了大量“代码”（Excel 完美地编写了 Ruby 等 :) 并在 Netbeans 中使用全局查找和替换。前几次可能需要更长的时间，但这些是您需要学习使用的工具。

            回答 #14

赞同：1

时间：2009-05-05T01:30:21.157

我将荧光棒中的绿色物质倒入我的激浪中。

            回答 #15

赞同：1

时间：2009-05-05T01:31:15.350

我没有得到编码员的昏迷。我得到了管理不善的瘫痪，我什么都不做，因为我害怕任何动作都是错误的。

            回答 #16

赞同：1

时间：2009-04-23T15:51:12.903

如果它适用并且可能，我会尝试探索一种技术或方法来窥探我的兴趣。然而，这并不总是可能的。

我也发现，将一些巨大的、无聊的或令人生畏的任务分解成更小、更容易接受的任务效果最好。

            回答 #17

赞同：0

时间：2009-12-23T20:07:38.220

这可能不是人们在这里寻找的答案，但我有时会编写程序来自动化这些东西！

        sql-server - 网站表单身份验证 -> Sql Server Windows 身份验证

ID：782197

赞同：1

时间：2009-04-23T15:15:47.760

标签：sql-server, web-applications, forms-authentication, windows-authentication

长话短说：作为我正在编写的在线数据库访问系统的一部分，我想使用 SQL 2008 中新的 BLOB 访问功能——这意味着我在登录 SQL Server 时必须使用 Windows 身份验证；然而，由于它的本质，所有这一切的网站前端都使用表单身份验证以及存储在该 SQL 服务器上的成员数据。

如何让 Web 应用程序模拟用户帐户，以便它可以连接到 SQL 服务器，即我不想使用登录网站的用户帐户。（并不是说您可以这样做，因为会员详细信息存储在 SQL 服务器上）

网络服务器和 SQL 服务器位于同一网络上的不同机器上，设置了一个用户帐户仅供网络应用程序使用。

            回答 #1

赞同：2

时间：2009-04-23T15:24:10.927

连接字符串应类似于：

< add name="MyConnectionString" connectionString="Data Source=THESQLSERVER;Initial Catalog=TheDatabase;Persist Security Info=True; **Integrated Security=True** ;Application Name=CRM.Sales" providerName=""/>

您在哪里使用集成安全性。然后，您的应用程序池应该使用有权访问您的 sql 服务器的身份。

您将授予该身份的权利。

        ruby - 在让我的班级一起工作时遇到了一些麻烦

ID：782207

赞同：0

时间：2009-04-23T15:17:43.483

标签：ruby, attributes, class

我正在处理一个简单的 ruby​​ 任务，但我遇到了内部服务器错误。我假设这是我如何将我的课程联系在一起的。

编辑：我更新了它，现在我只是没有插入数据库。问题的关键是我称之为“result = @dbh.query(query)”

这是我的第一页：

```
#!/usr/local/bin/ruby

require 'cgi'
require 'mysql'
load 'pizzaClass.cgi'
cgi = CGI.new
puts "Content-type: text/html\n\n"

db = Database_obj.new
pizza = Pizza.new(db)

submit = cgi['submit']
size = cgi['size']
topping1 = cgi['topping1']
topping2 = cgi['topping2']
name = cgi['name']

if submit == 'Order'
    pizza.new_pizza(size,topping1,topping2,name)
end

puts <<HTML
<form name="pizza" id="pizza" method="post" action="db.cgi">
<select name="size" id="size">
<option value="small">Small</option>
<option value="medium">Medium</option>
<option value="large">Large</option>
</select>
<br /><br />
<label for="topping1">Topping 1: <input type="text" name="topping1" id="topping1" /></label>
<br /><br />
<label for="topping2">Topping 2: <input type="text" name="topping2" id="topping2" /></label>
<br /><br />
<label for="name">Name: <input type="text" name="name" id="name" /></label>
<br /><br />
<input type="submit" name="submit" id="submit" value="Order" />

</form>
HTML 
```

这是我的 PizzaClass.cgi

```
 class Database_obj
attr_accessor :dbh
    def initialize()
        @dbh = Mysql.real_connect("localhost", "ljackson42001", "password", "ljackson42001")
    end

    def query_db(query)
        result = @dbh.query(query)
    end

    def get_results()
        result.each do |row|
            puts row
        end
    end
end

class Pizza
    def initialize(db)
    @dbh=db 
    end

    def new_pizza(size,topping1,topping2,name)
        query = "INSERT INTO pizza VALUES(0,#{size},#{topping1},#{topping2},#{name})"
        @dbh.query_db(query)
        puts "two"
    end
end 
```

任何帮助将不胜感激，

列维

            回答 #1

赞同：1

时间：2009-04-23T15:47:59.667

您只存储`result`在 中的局部变量中`query_db`，因此无法在 中访问它`get_results`。您可以通过切换到使用实例变量来轻松解决此问题。`@`实例变量以符号开头。

```
def query_db(query)
    @result = @dbh.query(query)
end

def get_results()
    @result.each do |row|
            puts row
    end
end 
```

            回答 #2

赞同：0

时间：2009-04-23T15:58:28.643

好的，所以关于它现在查询数据库，这是我的解决方案。未正确引用变量。

```
def new_pizza(size,topping1,topping2,name)
        query = "INSERT INTO pizza VALUES(0,\"#{size}\",\"#{topping1}\",\"#{topping2}\",\"#{name}\")"
        @dbh.query_db(query)
end 
```

        random - 来自互联网物理资源的随机数

ID：782210

赞同：2

时间：2009-04-23T15:18:21.063

标签：random

一些提供物理来源随机数的网站的地址是什么？我正在寻找免费服务和收费服务。

            回答 #1

赞同：4

时间：2009-04-23T15:19:11.453

我一直在使用[http://www.random.org/](http://random.org/)，我喜欢它。从大气噪声中生成随机数，并且还能够生成：

*   硬币翻转
*   掷骰子
*   洗牌

除其他外，看看它。

            回答 #2

赞同：2

时间：2009-04-23T15:20:20.170

[热点](http://www.fourmilab.ch/hotbits/)：

*   真正的随机数，由放射性衰变产生。
*   HotBits 是通过与计算机连接的 Geiger-Müller 管检测到的连续成对的放射性衰变来产生的。
*   一旦将随机字节传送给您，它们就会立即被丢弃——相同的数据将永远不会发送给任何其他用户，并且不会在此站点或任何其他站点保存数据记录。

[安全服务器 HotBits 请求](https://www.fourmilab.ch/hotbits/secure_generate.html)

            回答 #3

赞同：1

时间：2009-04-23T15:20:45.753

听起来像[量子随机位发生器](http://random.irb.hr/)可能有用吗？它依赖于半导体中的光子发射以及通过光电效应对其进行检测。

它们通过各种不同的平台/框架提供命令行和库/API 访问。

            回答 #4

赞同：0

时间：2009-04-23T15:20:03.433

许多 Linux 系统都`/dev/random`内置了一个设备。它提供来自物理源的随机数。

随机数生成器将来自设备驱动程序和其他来源的环境噪声收集到熵池中

见[http://en.wikipedia.org/wiki/Urandom](http://en.wikipedia.org/wiki/Urandom)

            回答 #5

赞同：0

时间：2009-04-23T15:21:46.563

[www.Random.org](http://www.Random.org)

显然他们使用大气噪声来生成数字，尽管我不确定他们是否已经发布了他们的算法。

        java - ColdFusion 查询到 java.sql.ResultSet

ID：782212

赞同：4

时间：2009-04-23T15:18:39.973

标签：java, coldfusion, resultset

我查看了["undocumentation"](http://www.zrinity.com/developers/mx/undocumentation/query.cfm)，我可以看到如何`coldfusion.sql.QueryTable`从 a创建 a `ResultSet`，但反之则不行。那么，如何`java.sql.ResultSet`从 ColdFusion ( `coldfusion.sql.QueryTable`) 查询对象中提取？

            回答 #1

赞同：8

时间：2009-04-24T15:13:13.767

Coldfusion.sql.QueryTable 实现了 javax.sql.RowSet，它扩展了 java.sql.ResultSet

因此，正如您所发现的，您不需要做任何事情。ColdFusion 查询已经是一个 Java ResultSet。

            回答 #2

赞同：2

时间：2009-04-24T14:53:43.643

结果我所要做的就是传入我的coldfusion.sql.QueryTable 对象......不知道它为什么会起作用，除非ColdFusion 正在做某种魔术。

        .net - 使用可为空类型设置下拉值

ID：782220

赞同：0

时间：2009-04-23T15:20:08.750

标签：.net, vb.net, generics

我已经为我们的基本页面编写了一个小实用函数，它在大多数情况下都可以正常工作，但是如果以表单调用它，`SetDropDownValue(dropdown, Nothing, True)`我必须指定类型 T。

由于编译器只需要在不使用类型时指定类型，我想知道是否有更好的方法来编写代码。

方法如下：

```
Protected Sub SetDropDownValue(Of T As Structure)(ByVal target As DropDownList, ByVal value As Nullable(Of T), ByVal bindFirst As Boolean)

    If target Is Nothing Then
        Throw New ArgumentNullException("target")
    End If

    If bindFirst Then
        target.DataBind()
    End If

    If value.HasValue Then
        target.SelectedValue = value.Value.ToString()
    Else
        target.SelectedIndex = 0
    End If

End Sub 
```

编写此方法的更好方法是什么？

            回答 #1

赞同：1

时间：2009-04-23T15:27:46.643

*如果值为 Nothing 那么类型是什么*并不重要，对吧？所以我会写另一种方法：

```
Protected Sub ClearDropDownValue(ByVal target As DropDownList, ByVal bindFirst As Boolean)
    SetDropDownValue(target, CType(Nothing, Nullable(Of Integer)), bindFirst)
End Sub 
```

抱歉，如果我的 VB 语法不太正确 - 但基本上只是将其设为一个辅助方法，该方法使用任意可空类型的`SetDropDownValue`a进行调用。`Nothing`

            回答 #2

赞同：0

时间：2009-04-23T15:28:05.037

不幸的是，当您通过 Nothing 时，您将不得不指定类型。VB 值 Nothing 在编译器中没有类型，因此不能用于推断类型。如果您依赖类型推断来避免专门添加类型参数，则不能将 Nothing 传递给允许编译器推断类型的参数。

        visual-studio - Visual Studio（或 resharper）变量和方法着色

ID：782223

赞同：8

时间：2009-04-23T15:20:25.520

标签：visual-studio, visual-studio-2008, ide, visual-studio-2005, resharper

好的，我不确定它的实际名称是什么，但我想知道在 Visual Studio 中是否可以进行以下操作。

当我将光标设置在或突出显示变量、方法名称或字符串...等时，我希望 IDE 突出显示它的所有用途。因此，如果我突出显示变量 x，那么它会突出显示变量 x 的所有其他用途。

这是在 eclipe 和 Notepad++ 中完成的，我已经非常喜欢这个功能，但是当我转向 VS 时，我似乎无法获得该功能。  

我知道我可以使用右键单击并查找定义，也可以使用 resharper 查找所有用途，但这并不容易和直观。我目前正在使用 VS2008，但希望在 2008 年和 2005 年都使用它。

此外，如果这是我看不到的 resharper 的一个功能，那也很好。

谢谢

            回答 #1

赞同：8

时间：2009-04-23T15:25:21.673

使用 Reshaper，您可以在光标位于变量内时按 Shift+Alt+F11 以突出显示该变量在该文件中的所有用法。（然后 ESC 删除突出显示）

            回答 #2

赞同：5

时间：2009-04-23T15:24:28.430

这不是 Visual Studio 2008 或以前版本的功能。不过，这将是 Visual Studio 2010 的一个功能。  

*   [http://blogs.msdn.com/somasegar/archive/2008/12/19/code-focused-development-in-vs-2010.aspx](http://blogs.msdn.com/somasegar/archive/2008/12/19/code-focused-development-in-vs-2010.aspx)

            回答 #3

赞同：4

时间：2009-04-23T15:56:42.923

使用 ReSharper，如果您使用的是 IDEA 键绑定，请使用 Ctrl+Shift+F7。如果您使用的是 VS 键绑定，请使用 Shift+Alt+F11（如 Martin Harris 所说）。

您可以在此处找到键绑定的完整地图：[ReSharper Feature Map](http://www.jetbrains.com/resharper/documentation/feature_map.html)

            回答 #4

赞同：1

时间：2009-04-23T15:45:24.010

我使用的 VS 插件[WholeTomato 的 Visual Assist X 就是](http://www.wholetomato.com/)这样做的。如果突出显示的东西是一个变量，它甚至会以不同的颜色显示分配和读取。

            回答 #5

赞同：0

时间：2009-04-23T15:30:42.783

DevExpress Refactor 或 Code Rush（我都有，所以我不确定哪个）会做到这一点。

将光标放在变量上并点击选项卡；范围内变量的所有用途都将突出显示。

            回答 #6

赞同：0

时间：2015-05-05T09:16:32.110

在 Visual Studio 中，选择变量（您也可以选择方法等），然后在顶部菜单中转到`Resharper -> Find -> Highlight Usages in File`或按下`Shift + Alt + F11`键盘。

然后，如果您愿意，您可以使用 向下浏览`Ctrl + Alt + PgDn`和向上浏览`Ctrl + Alt + PgUp`。

        algorithm - 如何测试一棵树是否在线性时间内具有完美匹配？

ID：782229

赞同：3

时间：2009-04-23T15:21:13.680

标签：algorithm, tree

给出一个线性时间算法来测试一棵树是否有完美匹配，即一组边恰好接触树的每个顶点一次。  

这是来自S. Dasgupta 的*算法*，我似乎无法确定这个问题。我知道我需要以某种方式使用贪婪的方法，但我就是想不通。帮助？  

伪代码很好；一旦有了这个想法，我就可以用任何语言轻松实现。

该算法在任何事情上都必须是线性的。O( V + E ) 很好。

            回答 #1

赞同：7

时间：2009-04-23T21:27:14.423

我想我有解决办法。由于我们知道该图是一**棵树**，因此我们知道叶节点的存在，即具有一条边且没有子节点的节点。为了使该节点包含在完美匹配中，该边必须存在于最终解决方案中。  

因此，我们可以找到连接到叶节点的所有边，添加到解决方案中，并从图中删除触摸的边。如果在这个过程结束时，我们没有留下任何剩余的节点，则不存在完美匹配。

            回答 #2

赞同：1

时间：2010-11-24T15:36:32.317

在“图”的情况下，问题的第一步应该是找到连接的组件。

由于最终答案中的每条边都连接两个顶点，因此它们最多属于一个连通分量。

然后，可以为每个连接的组件找到完美匹配。

            回答 #3

赞同：0

时间：2009-04-23T15:23:39.757

线性在*什么*？与边数成线性关系，将边保持为有序关联列表，即，每条边 ( *[vi]* *, v* j *)[都]*按某个总顺序排列。然后，您可以比较 O( *n* ) 中的两个列表。 ** * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2019-08-20T14:43:37.117

工作算法如下：

```
For each leaf in the tree: 
  add edge from leaf to its parent to the solution
  delete edge from leaf to its parent
  delete all edges from the parent to any other vertices
  delete leaf and parent from the tree

If the tree is empty then the answer is yes. Otherwise, there's no perfect matching. 
```

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2009-04-23T21:55:09.707

我认为这是在图中找到哈密顿路径的简化问题： 
 [http ://en.wikipedia.org/wiki/Hamiltonian_path](http://en.wikipedia.org/wiki/Hamiltonian_path) 

[http://en.wikipedia.org/wiki/Hamiltonian_path_problem](http://en.wikipedia.org/wiki/Hamiltonian_path_problem)

我认为互联网上有很多解决这个问题的方法，但通常发现汉密尔顿循环是一个 NP 问题。

# objective-c - 任何类似于正则表达式的东西

> ID：782237
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T15:23:34.377
> 
>         
> 
> 标签：objective-c

有没有类似于objective-c的正则表达式的东西？

我需要一种简单的方法来获取由以下字符集分隔的元素：

```
"\n"
", "
"; " 
```

目前我有以下代码：

```
NSMutableArray *translations = [ [NSMutableArray alloc] init];
NSArray *temp_array1 = [ [translationsView text] componentsSeparatedByString:@"\n"];

for (int i = 0; i < [temp_array1 count]; i++)
{
    NSArray *temp_array2 = [ [temp_array1 objectAtIndex: i] componentsSeparatedByString:@", "];
    for (int j = 0; j < [temp_array2 count]; j++)
    {j]);
        [translations addObject: [temp_array2 objectAtIndex: j] ];
    }
} 
```

但我也希望实现对“;”分隔符的支持。如果我要在它变得复杂之前以同样的方式做它。

有没有更简单的方法来实现这个目标？

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T15:24:49.317

我想你会想看看[RegexKit Framework](http://regexkit.sourceforge.net/)。

> RegexKit 是一个用于正则表达式的 Objective-C 框架：
> 
>   
>   
> 
> *   支持 Mac OS X Cocoa 和 GNUstep。需要 Mac OS X 10.4 或更高版本。
> 
> *   Mac OS X 通用二进制，包括 Mac OS X 10.5 上的 64 位支持。
> 
> *   不需要子分类。通过一组丰富的 Objective-C 类别添加，无缝地将正则表达式支持添加到所有 NSArray、NSData、NSDictionary、NSSet 和 NSString Foundation 对象。
> 
> *   启用 Unicode。对 NSString 对象的完全 Unicode 支持。
> 
> *   广泛、高质量的文档。
> 
> *   带有 BSD 许可证的完整源代码。
> 
> *   将 BSD 许可的 PCRE Perl 兼容正则表达式库用于正则表达式引擎。
> 
>   
>   
> 
> 针对高性能进行了调整，包括以下功能：
> 
>   
>   
> 
> *   缓存正则表达式的编译形式以提高速度。
> 
> *   多线程安全，包括多读取器、单写入器多线程访问已编译的正则表达式缓存。
> 
> *   尽量减少堆存储（即 malloc() 和 free()）的使用，而是从堆栈中动态分配大多数临时缓冲区需求。
> 
> *   直接在 Mac OS X 上使用 Core Foundation 以提高速度。
> 
>   
>   
> 
> 包括对 Mac OS X 10.5 Leopard 的支持：
> 
>   
>   
> 
> *   64位支持。为 ppc、ppc64、i386 和 x86_64 预构建。
> 
> *   垃圾收集已启用。完全支持 Leopards 垃圾收集功能。
> 
> *   集成 Xcode 3.0 文档。通过研究助理获取实时 API 信息。
> 
> *   Instruments.app 的乐器集合。
> 
> *   RegexKit 特定的 DTrace 探测点。

# logging - Log4net/Logging - 你发现什么有用？

> ID：782244
> 
>         
> 
> 赞同：27
> 
>         
> 
> 时间：2009-04-23T15:24:37.960
> 
>         
> 
> 标签：logging, log4net

我刚刚开始使用 Log4Net，并希望了解您发现哪些内容对您的日志记录体验有用。

您发现哪些类型的东西对记录有用；最终只是噪音；您何时使用不同的日志记录级别（DEBUG、INFO 等）；你有每个日志条目的标准格式吗？有什么你总是记录的吗？

有什么陷阱吗？一般关于日志记录的好文章？

更新：您在哪里登录？什么 Appender，为什么？

谢谢！

* * *

## 回答 #1

> 赞同：21
> 
>             
> 
> 时间：2009-04-23T17:10:22.713

我的回应基于 Robert Kozak 的出色回应，尽管我并没有完全以同样的方式使用我的日志记录

我使用五种类型的日志语句：

*   **调试**

*   **信息**

*   **警告**

*   **错误**

*   **致命的**

**DEBUG**语句是在您仍在编写应用程序以及需要完全了解执行流程的内容/位置时非常有用的语句。您可以使用 DEBUG 语句来测量锁前的队列，或者检查登录用户的用户名，甚至是某个一直令人困扰的 SQL 调用的参数。DEBUG 用于通常不需要知道的语句。

**只要有信息在出现问题时非常有用，但并不表示出现任何问题时，都应使用**INFO 。**如果你使用太多的 INFO 语句，你的日志会变得臃肿而无用，所以要小心。使用 INFO 获取您在错误时需要的任何关键信息，并且它离引发错误的地方很近。**

 **如果您检测到可恢复但仍然出乎意料（至少有点预期，因为您发现了它），请使用**WARN级别。**它表明您的应用程序可能处于无法运行的状态，但您相信您可以在当前执行路径上恢复/继续。

**ERROR**警告适用于您捕获意外异常时。如果您正在恢复/重试当前方法，我建议使用 WARN。如果您要取消/退出，请使用 ERROR。即使您的程序可以继续，ERROR 也意味着您正在尝试做某事并被拒绝，因此正在继续做其他事情。

**FATAL**用于当您在远低于投掷位置的高度捕获某物时使用，并且您基本上不知道发生了什么。这意味着您甚至没有尝试继续执行，您只需记录所有可能的信息，然后尝试优雅地退出。FATAL 错误很少使用，因为通常如果您发现错误，您就有足够的信息来尝试并继续执行。但是在如果您尝试并继续可能会发生损坏的情况下，请记录一个致命错误，然后逃跑。

* * *

至于您登录的位置。我通常喜欢登录到我的应用服务器上的“共享”文件夹（注意许可，以免它们不公开），这样日志就很容易访问，它们始终是我调试的第一步。如果可能，请进行设置，以便通过电子邮件发送任何警告、错误或致命错误，以便您收到“高级”警告。

干杯

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T15:29:06.797

*   所有异常都记录在`ERROR`调用堆栈中可能的最高级别（通常在事件处理程序等中）

*   导致问题的用户输入被记录在`WARN`级别（因为它可能表明我们需要改进我们的 UI 以更好地引导用户）

*   “重要”活动在`INFO`级别记录（即任何涉及向客户的信用卡计费、对第三方 API 的查询等），包括所涉及的数据（通常是 XML 序列化，删除任何敏感信息）

*   可能会在`DEBUG`级别记录非常详细的活动

我们很少使用`FATAL`级别日志记录。

`RollingLogFileAppender`我们通常使用at`INFO`级别和`SmtpAppender`at级别进行部署`ERROR`。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T15:38:13.077

Log4Net 与[Apache 链锯](http://logging.apache.org/log4net/release/howto/chainsaw.html)。Chainsaw 是一个仪表板，用于实时查看您的日志消息。它可以处理多个应用程序、执行动态过滤和其他一些方便的功能。

如果有疑问，请记录它（最好在更高级别，如 DEBUG 或 INFO 或创建您自己的级别）。您可以在配置文件中配置输出的内容。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-04-24T00:15:26.810

还有另一个用于 ASP.NET 的日志框架，称为[ELMAH](http://code.google.com/p/elmah/)。虽然它不是一个真正的日志框架，但更多的是一个异常框架。

很酷的功能包括：

*   0 代码/重新编译来实现它

*   有一个 web ui 来查看错误

*   错误的 RSS 提要

*   可以将其配置为将错误转储到 SQL

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T15:33:33.540

我使用四种类型的日志语句：

*   调试

*   信息

*   警告

*   错误

我将 DEBUG 用于我想在调试会话期间检查的语句。通常这些不会持续到发布版本。这是我检查变量值或登录和注销方法的地方。

我将 INFO 用于连接字符串、配置和我一直希望在日志中看到的一般信息。

WARNING 很少用于我不确定的事情或潜在的错误情况，甚至可能检查我知道会在堆栈中处理的异常。

我通常只在 Catch 块中使用 ERROR 来报告异常，并在没有其他方法处理异常时调用的 ExceptionHandler 中使用。  

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T21:01:11.257

我发现通过在开发开始时将项目设置为使用[Log4PostSharp](http://code.google.com/p/postsharp-user-plugins/wiki/Log4PostSharp)可以获得有价值的数据。基本上，结合[PostSharp](http://www.postsharp.org/)引擎，您可以在方法上放置一个属性，它会记录所有带有参数和返回值的调用。我在 Assembly.cs 文件中将其设置为调试级别，以便它默认记录所有不是属性获取器或设置器的方法调用。

如果不受控制，它会产生大量数据（我确保我不会在调试级别记录任何其他内容，以便在性能存在问题时轻松打开和关闭并将其完全从发布版本中删除）但是使用一个好的日志查看器——我使用[BareTail——](http://www.baremetalsoft.com/baretail/)你可以非常快速地查明复杂的错误。它特别擅长确定所有不同线程在出现问题时所处的方法。

我使用滚动文件附加程序，以便最新数据始终可用，而文件不会达到荒谬的大小。  

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-07-07T14:56:59.930

我的公司已经使用了另一个 log4net 日志查看器（Apache Chainsaw 除外），它被称为“log4net Dashboard”，由一家名为 FaktNet 的挪威公司（我认为）开发，它的网站是[http:// www.l4ndash.com](http://www.l4ndash.com)。

它提供了一个非常直观的基于 Web 的仪表板，并提供了一个很好的日志概览，可以与许多不同的附加程序（例如滚动文件或 SQL 服务器附加程序）一起使用，但它不像 Apache Chainsaw 那样免费。他们确实有一个开发者的许可证，它是免费的并且只允许在本地使用，这对于一个想要监控他的网站的自由职业者来说已经足够了（一个 l4n-dashboard 可以连接到多个日志源）。

FaktNet 有各种许可证，具体取决于应该有多少用户能够访问仪表板，而且他们的企业许可证并不昂贵（我认为是 600 美元）。鉴于它能够访问多个日志，它可以成为开发和监控许多大中型网站的开发团队的主要资产。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2010-01-15T14:55:55.703

Another really usefull apender is the `DBAppender` which may log info in a Database, which is obviously incredibly useful so as to query a log.

More info on this in [this article](http://weblogs.asp.net/drnetjes/archive/2005/02/16/374780.aspx).

# macos - 如果我使用时间机器，为什么要拥有版本控制系统？

> ID：782248
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T15:25:19.317
> 
>         
> 
> 标签：macos, version-control

我实际上知道最好有版本控制，但我想知道 Time Machine 是否没有为懒惰的程序员做好这方面的工作？

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-04-23T15:29:01.587

因为 TimeMachine 不会跟踪文件更改的日志。

例如，对于 Subversion 中的给定文件，我可以轻松确定它何时更改，以及同时更改了哪些内容。

它不会告诉您是谁更改了它，但我假设您在此实例中讨论的是单用户案例。

最后，您不能将签入和更改与构建/部署联系起来。

在 Mac OS 上安装 Subversion（或类似的）很简单，除非您签入/签出，否则不会消耗资源。强烈推荐。当然，请确保您的存储库已使用 TimeMachine 进行备份！

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-04-23T15:27:02.557

它们实际上非常相似，但 Time Machine 不会跟踪*文件*的哪个版本与系统的特定构建相匹配。拥有元数据非常有用。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-04-23T15:35:23.880

Time Machine 不会保留所有备份（它只保留一天的每小时备份，并且只保留一个月的每日备份），因此如果您需要返回并确切了解引入的更改，您将不会拥有文件的每个版本一个问题。它没有内置差异支持，但您可能可以`diff -r`对相关目录执行操作。它也不记录任何提交消息，这对于找出为什么有人以特定方式更改代码非常有用。最后，它并不能帮助您在多人或一个人在多台计算机上进行协调；版本控制的最大好处之一是它可以帮助您分发代码并合并来自多人的更改。

如果您想快速轻松地进行版本控制，我会推荐其中一种分布式版本控制系统。与必须设置和管理服务器的集中式系统不同，开始使用分布式系统通常像`git init; git add .; git commit`. 我通常更喜欢[Git](http://git-scm.com/)，但[Mercurial](http://www.selenic.com/mercurial/wiki/)也是一个不错的选择，有些人发现它更容易上手。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T15:29:06.313

Time Machine 将为您提供代码备份。就是这样。

源代码管理也将提供此功能，但也提供更多功能。最大的就是分支合并，对项目的帮助很大。

Time Machine 也不会存储诸如签到评论之类的元数据，或者谁做了什么更改。

最后，Time Machine 无法真正分发。如果您希望其他人也开始处理您的代码，那么 Time Machine 将无济于事。但是（好的）源代码控制将使协作变得非常容易。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T18:20:16.383

版本控制存储库中最重要和最有价值的东西*不是*内容，甚至不是历史记录（即 #2），而是*提交消息*。而且您在备份程序中没有这些。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T15:34:51.790

在 PC 上，[主动备份](http://www.ajcsoft.com/AJCActBk.php)的作用几乎相同，并且还允许进行修订比较，尽管仅限于逐个文件。当您想要列出版本 X 和版本 Y 之间的所有差异，并打算基于两者的组合构建版本 Z 时，就会出现问题。在您同时维护同一个项目的多个版本之前，这些类型的备份系统是可以的。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T15:42:27.450

分支和标签？

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T15:55:42.177

由于其他人指出的原因，请使用源代码控制。它很容易设置，可以解决很多问题。它会告诉你谁在什么时候改变了什么，为什么改变（如果你正确使用提交消息），并给你详细信息。当您意识到过去几天出现问题时，这是非常宝贵的。

完成后，使用 Time Machine 保留存储库的备份。版本控制系统不是备份系统。仅在一个文件系统上没有什么是安全的。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:40:29.020

不要忘记分支，它是 SCM 可以为您提供的最强大的工具之一。我不知道时间机器是否具有某种“替代现实”功能

# silverlight - 你能在silverlight中只覆盖控制模板的一部分吗

> ID：782251
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-04-23T15:25:35.243
> 
>         
> 
> 标签：silverlight

是否可以更改或修改控件模板的特定部分而无需在 xaml 中重新创建控件的整个控件模板？

例如，我试图去掉一个文本框的边框，这样我就可以将一个带有圆角的基本搜索框放在一起（下面的示例 xaml）。将borderthickness 设置为0 可以正常工作，直到您将鼠标悬停在文本框上并且他们添加到控件的伪边框会闪烁。如果我查看文本框的控件模板，我什至可以看到视觉状态已命名，但想不出如何禁用它。

在不覆盖 TextBox 的控件模板的情况下，我将如何阻止 Visual State Manager 在 TextBox 上触发鼠标悬停效果？

```
<Border Background="White" CornerRadius="10" VerticalAlignment="Center" HorizontalAlignment="Center" BorderThickness="3" BorderBrush="#88000000">
    <Grid VerticalAlignment="Center" HorizontalAlignment="Center" Width="200" Margin="5,0,0,0">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="16" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Path Height="13" Width="14" Stretch="Fill" Stroke="#FF000000" StrokeThickness="2" Data="M9.5,5 C9.5,7.4852815 7.4852815,9.5 5,9.5 C2.5147185,9.5 0.5,7.4852815 0.5,5 C0.5,2.5147185 2.5147185,0.5 5,0.5 C7.4852815,0.5 9.5,2.5147185 9.5,5 z M8.5,8.4999971 L13.5,12.499997" />
            <TextBox GotFocus="TextBox_GotFocus" Background="Transparent" Grid.Column="1" BorderThickness="0" Text="I am searchtext" Margin="5,0,5,0" HorizontalAlignment="Stretch" />
    </Grid>
</Border> 
```

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-24T11:23:23.790

我找到了一种方法，通过继承控件并覆盖 OnApplyTemplate。这并不理想，但我认为这比复制整个控件模板要好。这是一个创建无边框文本框的示例，基本上通过始终清除情节提要来禁用鼠标悬停视觉状态：

```
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media.Animation;

namespace SilverlightTestApplication
{
    public class BorderlessTextBox  : TextBox
    {
        public BorderlessTextBox()
        {
            BorderThickness = new System.Windows.Thickness(0);
        }

        public override void OnApplyTemplate()
        {
            base.OnApplyTemplate();

            //Get the mouse over animation in the control template
            var MouseOverVisualState = GetTemplateChild("MouseOver") as VisualState;

            if (MouseOverVisualState == null)
                return;

            //get rid of the storyboard it uses, so the mouse over does nothing
            MouseOverVisualState.Storyboard = null;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T15:37:55.917

自从我使用 XAML 以来已经有一段时间了，但不，我不相信您可以只修改模板的一部分。

但是，如果您有 IDE，您可以创建当前应用模板的副本，然后只修改您想要的部分，其余部分保持原样。[请参阅此链接](http://msdn.microsoft.com/en-us/library/cc295273.aspx)的如何编辑部分。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:36:45.377

使用 XAML 阅读器检索每个控件的默认模板，然后复制/粘贴并修改您想要的内容......不是很干净，但我认为这是唯一的方法（我正在搜索如何检索这个默认模板）

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T19:35:33.567

在 WPF 中，不确定 silverlight 这里有一段代码来检索 Aero 的模板，您可以尝试复制/粘贴并更改您想要的内容：

```
 public Window1()
        {
            InitializeComponent();
            using(FileStream fs = new FileStream("C:/TextBoxTemplate.xaml", FileMode.Create))
            {
                var res = LoadThemeDictionary(typeof(TextBox), "Aero", "NormalColor");
                var buttonRes = res[typeof(TextBox)];
                XamlWriter.Save(buttonRes, fs);
            }
        }

        public static ResourceDictionary LoadThemeDictionary(Type t,
        string themeName, string colorScheme)
        {
            Assembly controlAssembly = t.Assembly;
            AssemblyName themeAssemblyName = controlAssembly.GetName();

            object[] attrs = controlAssembly.GetCustomAttributes(
                    typeof(ThemeInfoAttribute), false);
            if(attrs.Length > 0)
            {
                ThemeInfoAttribute ti = (ThemeInfoAttribute)attrs[0];

                if(ti.ThemeDictionaryLocation ==
                                                         ResourceDictionaryLocation.None)
                {
                    // There are no theme-specific resources.
                    return null;
                }

                if(ti.ThemeDictionaryLocation ==
                                ResourceDictionaryLocation.ExternalAssembly)
                {
                    themeAssemblyName.Name += "." + themeName;
                }
            }

            string relativePackUriForResources = "/" +
                    themeAssemblyName.FullName +
                    ";component/themes/" +
                    themeName + "." +
                    colorScheme + ".xaml";

            Uri resourceLocater = new System.Uri(
                    relativePackUriForResources, System.UriKind.Relative);

            return Application.LoadComponent(resourceLocater)
                                 as ResourceDictionary;
        } 
```

我从未使用过 Silverlight，但我认为要使此模板适应 Silverlight 需要做很多事情。

来源：[WPF 中的默认模板](http://www.interact-sw.co.uk/iangblog/2007/02/14/wpfdefaulttemplate)

# asp.net - 使用 inheritInChildApplications 避免子 Web 应用程序中的 web.config 继承

> ID：782252
> 
>         
> 
> 赞同：165
> 
>         
> 
> 时间：2009-04-23T15:25:59.720
> 
>         
> 
> 标签：asp.net, configuration, iis-7, web-config

我正在尝试添加

```
<location inheritInChildApplications="false"> 
```

到我的父 Web 应用程序的 web.config，但它似乎没有工作。

我父母`web.config`有：

```
<configuration>
    <configSections>
    </configSections>

    // 10 or so custom config sections like log4net, hibernate,

    <connectionStrings>
    </connectionStrings>

    <appSettings>
    </appSettings>

    <system.diagnostics>
    </system.diagnostics>

    <system.web>
         <webParts>
         </webParts>
         <membership>
         </membership>

         <compilation>
         </compilation>
    </system.web>

    <location ..>
    <system.web>
        </system.web>
    </location>

    <system.webServer>
    </system.webServer> 
```

我的子 Web 应用程序设置为 IIS 中的应用程序，并且继承自`web.config`导致问题的父应用程序。

我应该把

```
<location inheritInChildApplications="false"> 
```

所以它忽略了所有各种 web.config 设置？

* * *

## 回答 #1

> 赞同：212
> 
>             
> 
> 时间：2011-05-11T18:10:04.453

正如前面提到的答案的评论者所说，您不能简单地添加该行...

```
<location path="." inheritInChildApplications="false"> 
```

...就在下面`<configuration>`。相反，您需要包装要禁用继承的各个 web.config 部分。例如：

```
<!-- disable inheritance for the connectionStrings section -->
<location path="." inheritInChildApplications="false">
   <connectionStrings>
   </connectionStrings>
</location>

<!-- leave inheritance enabled for appSettings -->
<appSettings>
</appSettings>

<!-- disable inheritance for the system.web section -->
<location path="." inheritInChildApplications="false">
   <system.web>
        <webParts>
        </webParts>
        <membership>
        </membership>

        <compilation>
        </compilation>
      </system.web>
 </location> 
```

虽然`<clear />`可能适用于某些配置部分，但有些部分需要`<remove name="...">`指令，还有一些似乎也不支持。在这些情况下，设置`inheritInChildApplications="false"`.

* * *

## 回答 #2

> 赞同：68
> 
>             
> 
> 时间：2009-04-23T15:30:01.567

它需要直接在根节点下`<configuration>`，您需要设置这样的路径：

```
<?xml version="1.0"?>
<configuration>
    <location path="." inheritInChildApplications="false"> 
        <!-- Stuff that shouldn't be inherited goes in here -->
    </location>
</configuration> 
```

处理配置继承的更好方法是`<clear/>`在您不想继承的子配置中使用 a 。因此，如果您不想继承父配置的连接字符串，您可以执行以下操作：

```
<?xml version="1.0"?>
<configuration>
    <connectionStrings>
        <clear/>
        <!-- Child config's connection strings -->
    </connectionStrings>
</configuration> 
```

* * *

## 回答 #3

> 赞同：24
> 
>             
> 
> 时间：2014-06-27T12:35:32.393

我把所有东西都放进去：

```
<location path="." inheritInChildApplications="false">
....
</location> 
```

除了`<configSections/>`：`<connectionStrings/>`和`<runtime/>`。

在某些情况下，我们不想从 继承某些部分`<configSections />`，但我们不能将`<section/>`标签放入`<location/>`，因此我们必须创建一个`<secionGroup />`并将不需要的部分放入该组中。以后可以将部分组插入到位置标记中。

所以我们必须改变这一点：

```
<configSections>
  <section name="unwantedSection" />
</configSections> 
```

进入：

```
<configSections>
  <sectionGroup name="myNotInheritedSections">
    <section name="unwantedSection" />
  </sectionGroup>
</configSections>

<location path="." inheritInChildApplications="false">
    <myNotInheritedSections>
        <unwantedSection />
    </myNotInheritedSections>
</location> 
```

* * *

## 回答 #4

> 赞同：9
> 
>             
> 
> 时间：2013-04-10T20:26:26.620

在最近向我们的一个开发环境发布代码后，我们遇到了与此相关的错误。我们有一个应用程序是另一个应用程序的子应用程序。直到昨天，这种关系多年来一直运作良好。

问题：

由于输入了重复的键，我们收到了黄色堆栈跟踪错误。这是因为子应用程序和父应用程序的 web.config 都有这个键。但是这种情况已经存在很多年了，一直没有改变。为什么现在突然成为一个问题？

解决方案：

这从来不是问题的原因是因为键和值总是相同的。昨天我们更新了 SQL 连接字符串以在连接字符串中包含应用程序名称。这使字符串变得独一无二，并且突然开始失败。

在没有对确切原因进行任何研究的情况下，我不得不假设当子应用程序继承父 web.config 值时，它会忽略相同的键/值对。

我们能够通过像这样包装连接字符串来解决它

```
 <location path="." inheritInChildApplications="false">
        <connectionStrings>
            <!-- Updated connection strings go here -->
        </connectionStrings>
    </location> 
```

**编辑：**我忘了提到我在 PARENTS web.config 中添加了这个。我不必修改孩子的 web.config。

感谢大家对此的帮助，拯救了我们的屁股。

* * *

## 回答 #5

> 赞同：6
> 
>             
> 
> 时间：2014-06-17T09:40:54.093

如果（据我了解）您试图完全阻止子应用程序的 Web 配置中的继承，我建议您避免在 web.config 中使用该标记。而是创建一个新的应用程序池并编辑 applicationHost.config 文件（位于 %WINDIR%\System32\inetsrv\Config 和 %WINDIR%\SysWOW64\inetsrv\config）。您只需找到您的应用程序池的条目并添加属性`enableConfigurationOverride="false"`，如下例所示：

```
<add name="MyAppPool" autoStart="true" managedRuntimeVersion="v4.0" managedPipelineMode="Integrated" enableConfigurationOverride="false">
    <processModel identityType="NetworkService" />
</add> 
```

这将避免 MyAppPool 服务的应用程序中的配置继承。

马泰奥

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2012-01-02T04:05:01.307

`location`这是标签  上的微软页面：http: [//msdn.microsoft.com/en-us/library/b6x6shw7%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/b6x6shw7%28v=vs.100%29.aspx)

它可能对某些人有帮助。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2013-01-08T20:44:18.757

我们在我们的一个应用程序上收到有关重复配置指令的错误。经过调查，似乎是因为[这个问题](http://www.asp.net/whitepapers/aspnet4/breaking-changes#0.1__Toc256770149)。

简而言之，我们的根网站是 ASP.NET 3.5（添加了特定库的 2.0），我们有一个子应用程序是 ASP.NET 4.0。

web.config 继承导致 ASP.NET 4.0 子应用程序继承父 ASP.NET 3.5 应用程序的 web.config 文件。

但是，ASP.NET 4.0 应用程序的全局（或“根”）web.config 位于 C:\Windows\Microsoft.NET\Framework\v4.0.30319\Config\web.config 和 C:\Windows\Microsoft。 NET\Framework64\v4.0.30319\Config\web.config （取决于你的位数），已经包含这些配置部分。

然后，ASP.NET 4.0 应用程序尝试将根 ASP.NET 4.0 web.config 和父 web.config（用于 ASP.NET 3.5 应用程序的那个）合并在一起，并在节点中遇到重复项。

我能找到的唯一解决方案是从父 web.config 中删除配置部分，然后

1.  确定您的根应用程序中不需要它们，或者如果需要

2.  将父应用升级到 ASP.NET 4.0（因此它可以访问根 web.config 的 configSections）

# c# - 使用 Castle ActiveRecord 从表中查找前 10 个结果

> ID：782254
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T15:26:14.150
> 
>         
> 
> 标签：c#, nhibernate, activerecord, castle-activerecord

我试图让我的应用程序用户获得前 10 名的分数。我通常使用类似的东西

```
User.SlicedFindAll(0, 10, 
NHibernate.Expression.Expression.Eq("IsActive", true), 
NHibernate.Expression.Order.Desc("Score") 
```

这通常用于分页目的。但是，我不想在我的请求中添加任何约束（WHERE 子句）。因此，我尝试了一些类似的东西

```
User.SlicedFindAll(0, 10, 
null, 
NHibernate.Expression.Order.Desc("Score") 
```

但这会引发 NullReferenceException。任何指针？（我猜 SlicedFindAll 不是一个好的选择）

谷歌对此没有帮助。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T16:20:59.493

您可以使用此重载：

```
public static T[] SlicedFindAll(int firstResult, int maxResults, NHibernate.Expression.Order[] orders, params NHibernate.Expression.ICriterion[] criteria) 
```

在您的情况下，它将是：

```
User.SlicedFindAll(0, 10, new[] {Order.Desc("Score")}) 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2016-05-24T19:16:58.870

我更喜欢 LINQ：

```
ActiveRecordLinq.AsQueryable<User>().Take(10) 
```

它应该完美地评估为

```
select top 10 * from User 
```

# python - PyQt 和上下文菜单

> ID：782255
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2009-04-23T15:26:41.653
> 
>         
> 
> 标签：python, qt, pyqt, menu

我需要在右键单击我的窗口时创建一个上下文菜单。但我真的不知道如何实现这一目标。

是否有任何小部件，或者我必须从头开始创建它？  

编程语言：Python

图形库：Qt (PyQt)

* * *

## 回答 #1

> 赞同：42
> 
>             
> 
> 时间：2009-04-23T16:14:44.097

我不能说python，但在C++中它相当容易。

首先在创建小部件后设置策略：

```
w->setContextMenuPolicy(Qt::CustomContextMenu); 
```

然后将上下文菜单事件连接到一个插槽：

```
connect(w, SIGNAL(customContextMenuRequested(const QPoint &)), this, SLOT(ctxMenu(const QPoint &))); 
```

最后，实现插槽：

```
void A::ctxMenu(const QPoint &pos) {
    QMenu *menu = new QMenu;
    menu->addAction(tr("Test Item"), this, SLOT(test_slot()));
    menu->exec(w->mapToGlobal(pos));
} 
```

这就是你在 c++ 中的做法，在 python API 中应该不会有太大的不同。

**编辑：**在谷歌上环顾四周后，这是我在 python 中的示例的设置部分：

```
self.w = QWhatever();
self.w.setContextMenuPolicy(Qt.CustomContextMenu)
self.connect(self.w,SIGNAL('customContextMenuRequested(QPoint)'), self.ctxMenu) 
```

* * *

## 回答 #2

> 赞同：15
> 
>             
> 
> 时间：2009-06-06T04:07:47.460

另一个示例显示如何在工具栏和上下文菜单中使用操作。

```
class Foo( QtGui.QWidget ):

    def __init__(self):
        QtGui.QWidget.__init__(self, None)
        mainLayout = QtGui.QVBoxLayout()
        self.setLayout(mainLayout)

        # Toolbar
        toolbar = QtGui.QToolBar()
        mainLayout.addWidget(toolbar)

        # Action are added/created using the toolbar.addAction
        # which creates a QAction, and returns a pointer..
        # .. instead of myAct = new QAction().. toolbar.AddAction(myAct)
        # see also menu.addAction and others
        self.actionAdd = toolbar.addAction("New", self.on_action_add)
        self.actionEdit = toolbar.addAction("Edit", self.on_action_edit)
        self.actionDelete = toolbar.addAction("Delete", self.on_action_delete)
        self.actionDelete.setDisabled(True)

        # Tree
        self.tree = QtGui.QTreeView()
        mainLayout.addWidget(self.tree)
        self.tree.setContextMenuPolicy( Qt.CustomContextMenu )
        self.connect(self.tree, QtCore.SIGNAL('customContextMenuRequested(const QPoint&)'), self.on_context_menu)

        # Popup Menu is not visible, but we add actions from above
        self.popMenu = QtGui.QMenu( self )
        self.popMenu.addAction( self.actionEdit )
        self.popMenu.addAction( self.actionDelete )
        self.popMenu.addSeparator()
        self.popMenu.addAction( self.actionAdd )

    def on_context_menu(self, point):

         self.popMenu.exec_( self.tree.mapToGlobal(point) ) 
```

# hibernate - Hibernate - @ManyToMany 与映射实体中的附加字段

> ID：782256
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T15:26:55.537
> 
>         
> 
> 标签：hibernate, many-to-many

我的简化实体方案如下：

PERSON 与具有特定角色（打哈欠）的公司相关联。

我的第一个想法是在 PERSON 和 COMPANY 之间配置多对多关系。但是，显然，我不能以这种方式在 ROLE 表中包含 ROLE 的类型（作为两个外键的另一个字段）。

我承认这样做的正确方法是使用两个 OneToMany 关系并将 ROLE 作为一个实体单独包含（[已在 stackoverflow 上回答](https://stackoverflow.com/questions/166426/)）。

但这就是我卡住的地方：我使用 html 表单将一个人添加到公司并选择适当的角色，我如何将其保存到数据库或更好：我如何告诉 Hibernate 保存它。一个人有一个名单，公司也有。一个角色有一个人和一个公司。他们如何在中间相遇？所以基本上我要问的是：

**准确的 Hibernate 映射配置如何让我可以一步保存具有公司角色的人员？**

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:58:12.367

查看级联和表继承。例如，下面的代码将代表三个表。一个公司表、一个带有 CATG 的角色表和一个用户表。角色表将使用单表继承，其中 CATG 将由 hibernate 管理，hibernate 将根据 CATG 列值和映射创建正确的类。并且级联将与用户同时插入角色。  

```
@Table( name = "USER" )
Public User
{

    @ManyToOne( fetch = FetchType.LAZY )
    @JoinColumn(  cascade = CascadeType.ALL, name="ROLE_NAME" )
    private CompanyRole   role;

}

@Inheritance( strategy = InheritanceType.SINGLE_TABLE )
@DiscriminatorColumn( name="CATG", discriminatorType=DiscriminatorType.STRING )
@Table( name = "Role" )
public Role
{

}

@DiscriminatorValue( "CMPY_ROLE" )
public CompanyRole extends Role
{

    private Company company
}

@Table( name = "COMPANY" )
Public Company 
{
} 
```

# java - 如何在 Java 中使用 SwingWorker？

> ID：782265
> 
>         
> 
> 赞同：51
> 
>         
> 
> 时间：2009-04-23T15:28:32.693
> 
>         
> 
> 标签：java, swingworker

> 与我之前的问题相关：[从 Java 中的另一个类调用重绘？](https://stackoverflow.com/questions/772713/call-repaint-from-another-class-in-java)

我是 Java 新手，我看过一些关于 SwingWorker 的教程。但是，我不确定如何使用我在上一个问题中提供的示例代码来实现它。

谁能解释一下如何在我的代码片段中使用 SwingWorker 和/或向我指出一个体面的教程？我看过，但我不确定我是否理解。

* * *

## 回答 #1

> 赞同：115
> 
>             
> 
> 时间：2009-04-23T15:37:27.213

通常，SwingWorker 用于在 Swing 中执行长时间运行的任务。

在事件调度线程 (EDT) 上运行长时间运行的任务可能会导致 GUI 锁定，因此已完成的一件事是使用[`SwingUtilities.invokeLater`](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingUtilities.html#invokeLater%28java.lang.Runnable%29)并[`invokeAndWait`](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingUtilities.html#invokeAndWait%28java.lang.Runnable%29)保持 GUI 响应，从而在运行所需任务之前优先考虑其他 AWT 事件（以 a 的形式`Runnable`）。

但是，问题`SwingUtilities`在于它不允许将数据从执行的方法返回`Runnable`到原始方法。这就是[`SwingWorker`](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html)旨在解决的问题。

Java 教程有一个关于[SwingWorker](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)的部分。

这是一个示例，其中 a`SwingWorker`用于在单独的线程上执行耗时的任务，并在一秒钟后显示一个带有答案的消息框。

`SwingWorker`首先，将进行一个类扩展：

```
class AnswerWorker extends SwingWorker<Integer, Integer>
{
    protected Integer doInBackground() throws Exception
    {
        // Do a time-consuming task.
        Thread.sleep(1000);
        return 42;
    }

    protected void done()
    {
        try
        {
            JOptionPane.showMessageDialog(f, get());
        }
        catch (Exception e)
        {
            e.printStackTrace();
        }
    }
} 
```

`doInBackground`和方法的返回类型`get`指定为第一种类型，`SwingWorker`第二种是用于返回的类型`publish`和`process`方法，本例中没有使用。

然后，为了调用`SwingWorker`，调用该`execute`方法。在这个例子中，我们将一个`ActionListener`连接到一个`JButton`来执行`AnswerWorker`：

```
JButton b = new JButton("Answer!");
b.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent e)
    {
        new AnswerWorker().execute();
    }
}); 
```

上面的按钮可以加到一个`JFrame`中，一秒后点击可以得到一个消息框。以下可用于初始化 Swing 应用程序的 GUI：

```
private void makeGUI()
{
    final JFrame f = new JFrame();
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    f.getContentPane().setLayout(new FlowLayout());

    // include: "class AnswerWorker" code here.
    // include: "JButton" b code here.

    f.getContentPane().add(b);
    f.getContentPane().add(new JButton("Nothing"));
    f.pack();
    f.setVisible(true);
} 
```

应用程序运行后，将有两个按钮。一个标有“答案！” 和另一个“无”。当点击“答案！” 按钮，一开始什么都不会发生，但是单击“无”按钮将起作用并证明 GUI 是响应式的。

并且，一秒钟后，结果`AnswerWorker`将出现在消息框中。

* * *

## 回答 #2

> 赞同：12
> 
>             
> 
> 时间：2013-07-12T13:42:12.757

同意：

> 在事件调度线程 (EDT) 上运行长时间运行的任务可能会导致 GUI 锁定。

不同意：

> 所以其中一件事是使用 SwingUtilities.invokeLater 和 invokeAndWait 来保持 GUI 响应。

invokeLater 仍然在 EDT 上运行代码，并且可以冻结您的 UI！试试这个：

```
SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    Thread.sleep(100000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        }); 
```

至少我，一旦单击使用上述代码触发 actionPerformed 的按钮，就无法移动鼠标。我错过了什么吗？

# java - 在视图中休眠打开会话

> ID：782272
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T15:29:24.220
> 
>         
> 
> 标签：java, hibernate, lazy-loading

我正在使用以下方法来解决 hibernate 中的唯一延迟初始化问题。请告诉我它是否会起作用。由于某些原因，我必须在我的持久层强制执行我的事务。

```
public class CourseDAO {

       Session session = null;
    public CourseDAO()
{

  this.session =    this.session = HibernateUtil.getSessionFactory().getCurrentSession(); 

}

    public Course findByID(int cid){

        Course crc = null;
        Transaction tx = null;
        try {
            tx = session.beginTransaction();
            Query q = session.createQuery("from Course  as course where course.cid = "+cid+" ");
            crc = (Course) q.uniqueResult();
          //note that i am not commiting my transcation here.Because If i do that i will not be able to
          //do lazy fetch

        } 
        catch (HibernateException e)
        {
            e.printStackTrace();
             tx.rollback();
            throw new DataAccessLayerException(e);
        }

        finally
        {

        }
        return crc;
}

} 
```

在过滤器中我使用以下代码

```
 session =  HibernateUtil.getSessionFactory().getCurrentSession();
     if(session.isOpen())
          HibernateUtil.getSessionFactory().getCurrentSession().getTransaction().commit(); 
```

这种方法对吗？？会不会有什么问题

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-07-28T15:32:07.503

你能解释一下为什么你需要在你的存储库中有你的交易吗？问题是它们会变得如此细粒度，所以你不会从会话缓存中获得任何好处

然后你在那里打开交易，但在你的过滤器中关闭它。如果您访问服务中的多个存储库会发生什么？也许我不明白您的意思，但我认为您需要重新考虑迫使您在存储库中管理交易的原因

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-11-10T14:06:44.507

你什么时候创建你的 CourseDAO？如果它是一个单例 bean 或其他比页面视图寿命更长的东西，它需要保留一个 SessionFactory 并在需要时生成一个新的 Session，而不是保留一个 Session。

# c# - 将 C# MethodInvoker.Invoke() 用于 GUI 应用程序...这样好吗？

> ID：782274
> 
>         
> 
> 赞同：27
> 
>         
> 
> 时间：2009-04-23T15:29:50.727
> 
>         
> 
> 标签：c#, multithreading, c#-2.0, invoke

使用 C# 2.0 和 MethodInvoker 委托，我有一个 GUI 应用程序从 GUI 线程或工作线程接收一些事件。

我使用以下模式来处理表单中的事件：

```
private void SomeEventHandler(object sender, EventArgs e)
{
    MethodInvoker method = delegate
        {
            uiSomeTextBox.Text = "some text";
        };

    if (InvokeRequired)
        BeginInvoke(method);
    else
        method.Invoke();
} 
```

通过使用这种模式，我不会复制实际的 UI 代码，但我不确定这种方法是否良好。

特别是，线

```
method.Invoke() 
```

它是使用另一个线程来调用还是在某种程度上转换为对 GUI 线程上的方法的直接调用？

* * *

## 回答 #1

> 赞同：22
> 
>             
> 
> 时间：2009-04-23T15:33:27.627

该`method.Invoke()`调用在当前执行线程上执行委托。使用`BeginInvoke(method)`确保在 GUI 线程上调用委托。

当可以从 GUI 线程和其他线程调用相同的方法时，这是避免代码重复的正确方法。

* * *

## 回答 #2

> 赞同：15
> 
>             
> 
> 时间：2011-11-05T15:06:42.340

我个人喜欢这种方法：

```
private void ExecuteSecure(Action a)
{
    if (InvokeRequired)
        BeginInvoke(a);
    else
        a();
} 
```

然后你可以像这样编写单行代码：

```
ExecuteSecure(() => this.Enabled = true); 
```

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-04-28T18:01:03.753

请记住，如果您在后台线程上并且 Control.IsHandleCreated 为 false，则 Control.InvokeRequired 返回 false。我将使用 Debug.Assert 检查非托管句柄的创建来保护代码。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T15:37:19.413

对于 WinForms，调用`Control.Invoke(Delegate)`会向 UI 的消息泵发送消息。然后线程处理消息并调用委托。一旦它被处理，`Invoke`停止阻塞并且调用线程继续运行你的代码。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T15:32:28.317

它在同一个线程上进行调用。您可以通过单步执行代码来检查。这种方法没有错。

# vb.net - 使用 VB.NET 调用 Windows API

> ID：782275
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T15:29:53.517
> 
>         
> 
> 标签：vb.net, winapi, pinvoke

如何使用 VB.NNET 锁定屏幕（最重要）、更改声音、锁定键盘等？

我知道使用 C++ .Net 很容易做到这一点

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T15:35:20.680

您正在尝试做的是 P/Invoke。您必须查找要实现和使用的特定 API 调用。

这是有关 P/Invoke 的一些信息。

*   [http://www.pinvoke.net/](http://www.pinvoke.net/)

*   [http://www.codeproject.com/KB/dotnet/PInvoke.aspx](http://www.codeproject.com/KB/dotnet/PInvoke.aspx)

仅供参考，如果您正在计划任何恶意（听起来您可能是），请不要。

# c# - 在使用属性的类的成员函数之前执行一些特定的代码？

> ID：782278
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T15:30:26.027
> 
>         
> 
> 标签：c#, asp.net-mvc

我有一堂课：

```
public class MyClass
{
  public int code { set; get; }
  public bool foo()
  {
    // do some stuff
    // ...
    code = 100;
    return true;
  }

  public bool bar()
  {
    // do some stuff
    // ...
    code = 200;
    return true;
  }

  // more methods ...
  // ...
} 
```

我想在每个成员函数调用开始时将代码的值重置为零。当然，我可以在每个函数的开头手动将值设置为零，但我想知道是否可以为此目的使用属性：

```
[ResetTheCode]
public bool bar()
{
  // do some stuff
  // ...
  code = 200;
  return true;
} 
```

类似于 ASP.NET MVC 中的操作过滤器。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T15:33:20.983

同意肯特。另外，看看[PostSharp](http://www.postsharp.org/)，它也是一个非常成熟的 .NET AOP 框架。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T15:31:29.817

AOP 框架将允许您执行此操作。[以温莎城堡](http://www.castleproject.org/container/index.html)为例。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T15:33:29.313

您绝对可以使用 AOP 框架（例如[PostSharp](http://www.postsharp.org/)）做这样的事情，但您不认为这会让不熟悉您的流程的人感到非常困惑吗？  

这是其中之一，即使您可以做到，也不一定意味着您应该这样做。在方法上方键入属性名称所花费的时间和精力不可能少于编写重置代码所需的时间和精力（它也应该在它自己的方法中，这样你就不会到处复制/粘贴幻数）。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T15:41:34.970

属性本身并没有做任何事情，除了像标记或代码的元数据一样工作。您必须编写一些反射代码来获取属性并对其进行处理。

[PostSharp](http://www.postsharp.org/)、[Castle Windsor](http://www.castleproject.org/container/index.html)等 AOP 框架根据其框架的规则执行评估属性的工作。

# c# - 如何将未绑定的复选框列添加到 WinForms DataGrid（.NET 1.0、1.1）？

> ID：782286
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T15:32:35.990
> 
>         
> 
> 标签：c#, vb.net, winforms, datagrid

如何将未绑定的复选框列添加到数据绑定的 DataGrid（WinForms .NET 1.0、1.1）？

我无法将假列添加到数据源，因为它是来自其他地方的数据视图。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2010-01-19T07:54:31.240

绑定数据源后为什么不添加复选框列？

```
 // do this after changing dataGridView1.DataSource
 DataGridViewCheckBoxColumn checkBoxColumn = new DataGridViewCheckBoxColumn();
 checkBoxColumn.HeaderText = "Selected";
 dataGridView1.Columns.Add(checkBoxColumn); 
```

# java - 来自 jython 的 Java 类

> ID：782292
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T15:33:38.313
> 
>         
> 
> 标签：java, jython

我需要从该脚本访问运行 jython 脚本的 java 类吗？有什么帮助吗？

更新：像这样的东西：

```
//JAVA CLASS
class Test{
     public String text;
     public Test
     {
        PythonInterpreter pi = new PythonInterpreter(null);
        pi.execfile("test.py");

     }

} 
```

所以 int test.py 我需要做一些事情来改变 Test 类中文本的值

```
#test.py
doSomething()
Text.test = "new value" 
```

希望更清楚

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-23T16:08:46.153

要将 java 类实例传递给[嵌入式 jython](http://www.jython.org/Project/userguide.html#embedding-jython)，您需要执行以下操作：

```
PythonInterpreter interp = new PythonInterpreter();
    interp.set("a", this);
    interp.exec("a.test = 'new value'"); 
```

如果要从外部脚本调用函数（将实例作为参数）：

```
 PythonInterpreter interp = new PythonInterpreter();
    interp.set("a", this);
    interp.exec("import externalscript");
    interp.exec("externalscript.function(a)"); 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:08:13.457

您必须在 Jython 代码的顶部导入您的测试类。我相信这将类似于

```
from com.examplepackage import Test 
```

您还将文本值设置为静态，或将 Java 对象传递给 Jython 方法。

[在这里](http://www.jython.org/docs/usejava.html)查看文章。

# maven-2 - 通过 Hudson 发布 Maven

> ID：782301
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-04-23T15:35:51.380
> 
>         
> 
> 标签：maven-2, jenkins, continuous-integration, hudson, release-management

我正在设置 Hudson 以使用批处理任务插件向我们的内部存储库执行 Maven 发布。我正在通过以下方式进行：

```
mvn --batch-mode release:prepare
mvn --batch-mode release:perform 
```

我对人们使用的其他方法以及这些方法的优缺点感兴趣。此外，人们遇到的任何问题。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-04-25T21:08:05.607

出于几个原因，我倾向于总是手动发布。首先，如果您必须回滚，则可以回到原始发布位置并执行此操作会更容易。其次，因为您需要在流程中解决所有快照依赖项。

我们的开发过程让我们将依赖项留在当前版本的当前版本之外，直到修复需要升级。这意味着如果我要发布 Nexus、Maven 等，那么我会看到快照，这意味着我必须先发布这些快照。这个过程实际上不可能自动化，因为它会根据自上次发布以来发生的变化而变化。

也就是说，我们有一台专门用于构建的特殊机器（在 Sonatype 中它只是一个 vm）设置。这样做是为了保证不会发生可能会意外影响构建的环境更改（例如 jdk 更改）。它还使任何人都可以更轻松地了解发布过程，因为它随时准备就绪。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2010-01-29T20:16:51.697

最近，我注意到了一个 m2release 插件。看起来不错。尽管如此，我希望我的发布过程完全“无 pom-tweaking”。我的意思是我们必须提供 4 个输入参数来处理完整的版本：

1.  发布版本（例如 1.0.0）

2.  新的开发版本（例如 1.0.1-SNAPSHOT）

3.  SCM 中的发布标签（例如 release-1.0.0 或 1.0.0）

4.  SCM 中的标签基路径

前 2 个具有可接受的默认值。与错误修复版本数字碰撞的版本对我来说非常好。

数字 4 可以在 pom.xml 中指定。它不会改变。

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-release-plugin</artifactId>
    <configuration>
        <tagBase>https://example.com/svn/myProject/releases</tagBase>
    </configuration>
</plugin> 
```

这是第三个阻止我按下按钮完全自动化发布的原因。默认的发布标签标签不会为我们做这件事，所以我们必须指定它：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-release-plugin</artifactId>
    <configuration>
        <tag>release-${pom.version}</tag>
        <tagBase>https://example.com/svn/myProject/releases</tagBase>
    </configuration>
</plugin> 
```

现在，虽然这可能正是我所需要的，但我最终得到了一个带有 -SNAPSHOT 的 svn 标签。:( 所以我必须在 Hudson 作业配置中传递 tag 参数。此外，我必须为我们制作的每个版本更改它......这不是我所需要的。

* * *

所以，最后，在 hudson 中拥有一个 maven2 类型的项目 + m2release hudson 插件 + 正确配置的 maven 发布插件是我迄今为止看到的所有发布过程的母亲。虽然并不完美，但它为我节省了很多繁琐的工作。

JS。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T15:55:51.693

我总是手动触发发布，有明显的利弊:-)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-07-08T03:05:58.453

我们一直在尝试使用 Hudson Maven 发布插件，虽然我有点挑战让它正确地为发布提供信用，而不是像将密码硬编码到我们的构建文件中这样的邪恶事情。

# cocoa - 如果选中了该行中的复选框，您如何使表格视图中的一行略显透明？

> ID：782303
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T15:36:09.773
> 
>         
> 
> 标签：cocoa, checkbox

我正在寻找一个应用程序，表格视图的每一行都有一个带有复选框的列。我要做的是...如果选中该行上的复选框，则使复选框所在的行稍微透明（这应该在表格的每一行上实现，因为每一行都有一个复选框）。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:40:59.417

在您的表视图委托中，实现此方法：

```
tableView:(NSTableView *)aTableView willDisplayCell:(id)aCell forTableColumn:(NSTableColumn *)aTableColumn row:(NSInteger)rowIndex 
```

从那里您可以获得给定行的复选框按钮单元格，并根据其状态更改单元格的绘图样式。请记住，尽管单元格被重复使用，因此您必须为选中和未选中状态设置单元格样式。

我不太清楚您的目标是哪种绘画风格。首先尝试使用基本的 NSTextFieldCell，如果您无法完成您想要做的事情，请创建一个 NSCell 子类并自己处理绘图代码。

* * *

## 回答 #2

> 赞同：-2
> 
>             
> 
> 时间：2009-04-23T15:42:11.240

你真的是指“不透明”吗？（“有点不透明”很像“有点怀孕”。）

如果您的意思是更改颜色，请将 javascript 添加到复选框以更改包含复选框的 div 的背景。这是一个[例子](http://www.codingforums.com/archive/index.php/t-144799.html)。

# php - Oracle PL/SQL 调用上的 PHP 数组绑定

> ID：782305
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T15:36:33.033
> 
>         
> 
> 标签：php, binding, plsql

我有一个 PL/SQL 过程，它将类型编号表（10）作为输入参数。

我正在尝试从 php 中调用它。绑定没有出现任何错误，一切都很好。但是我装订的内容不是我所期望的！

例如，我绑定一个数组：array(19465,19467) 在 pl/sql 端我得到这种值：-2.50000000000000000000000000000000E+107

似乎精度/长度/类型发生了问题？我的束缚，但我迷失了。

这是我的绑定： oci_bind_array_by_name($stmt, ':name', $array, -1, SQLT_NUM);

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-29T14:53:38.907

尝试使用“SQLT_INT”代替“SQLT_NUM”。即使 INTEGER 是 NUMBER(38) 的同义词，SQLT_NUM 也不起作用。

（来自 php 错误报告：[2006 年 10 月 27 日上午 8:37 UTC] tony2001@php.net 将 SQLT_NUM 更改为 SQLT_INT 并且工作正常。这两种绑定类型之间的 OCI8 没有区别（它们由非常相同的方式），因此OCI库本身必须存在一些差异。）

# asp.net - 我应该在哪里存储 ASP.NET 应用程序中的配置信息？

> ID：782307
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T15:37:14.310
> 
>         
> 
> 标签：asp.net, vb.net, settings

我有一个 ASP.NET 应用程序。它驻留在另一个 ASP.NET 应用程序中。我将我的 DLL 放在其他应用程序 bin 文件夹中，并有一个包含我的 aspx 文件的子目录。我无法编辑主应用程序的 Web.config。

那么我在哪里可以存储配置设置？例如，这是一个将部署到各种客户端的应用程序。我想将用于显示的客户端名称存储在标题等中。以及徽标文件的位置。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T15:41:16.970

您可以将 web.config 文件放在 ASPX 文件所在的文件夹中，.NET 将负责嵌套它们并聚合其内容。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T15:43:33.640

您可以使用[`Settings.Settings`](http://msdn.microsoft.com/en-us/library/aa730869%28VS.80%29.aspx)它来存储它。[这个例子](http://dotnetperls.com/Content/Settings-Visual-Studio.aspx)可能会有所帮助。您可以拥有多个设置文件并访问其中的任何一个，就像访问任何其他类一样。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T15:52:07.363

您也可以只创建一个 Settings.config XML 文件并将其放在您想要的任何位置（.config 扩展名将阻止通过 HTTP 请求对其进行查看），然后用 Settings 类包装它并从您的应用程序中与该 Settings 类对话.

# .net - 如何处理 ComboBox 选择的索引更改？

> ID：782313
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-23T15:38:52.780
> 
>         
> 
> 标签：.net, winforms, combobox

我有一个包含制造商列表的组合框。当用户选择制造商时，下面的网格会填充所选制造商的数据。可以修改该数据。完成所有更改后，用户必须按下保存按钮。

但是用户可能忘记按保存并从组合框中选择另一个制造商，网格将填充另一个数据，因此以前的更改将丢失。

因此，在选择其他制造商之前，我需要询问用户是否要保存更改。

我怎样才能做到这一点？或者，也许您提供了另一种解决我的任务的方法（从另一个角度看）？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-04-26T19:17:01.870

下面是我们如何继承 ComboBox 以引入新的 SelectedIndexChangingEvent 并有可能取消更改：

```
 public class ComboBoxEx : ComboBox
{
    public event CancelEventHandler SelectedIndexChanging;

    [Browsable(false)]
    public int LastAcceptedSelectedIndex { get; private set; }

    public ComboBoxEx()
    {
        LastAcceptedSelectedIndex = -1;
    }

    protected void OnSelectedIndexChanging(CancelEventArgs e)
    {
        var selectedIndexChanging = SelectedIndexChanging;
        if (selectedIndexChanging != null)
            selectedIndexChanging(this, e);
    }

    protected override void OnSelectedIndexChanged(EventArgs e)
    {
        if (LastAcceptedSelectedIndex != SelectedIndex)
        {
            var cancelEventArgs = new CancelEventArgs();
            OnSelectedIndexChanging(cancelEventArgs);

            if (!cancelEventArgs.Cancel)
            {
                LastAcceptedSelectedIndex = SelectedIndex;
                base.OnSelectedIndexChanged(e);
            }
            else
                SelectedIndex = LastAcceptedSelectedIndex;
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2012-10-23T09:31:44.580

创建 2 个类级别变量

```
private bool selectionCancelled=false;
private int lastSelectedIndex=-1; 
```

然后在 SelectedIndex 事件中，您可以编写如下代码  

```
 if (!selectionCancelled)
        {
            if (MessageBox.Show("Are you sure you want to change the selection ?", this.Text, MessageBoxButtons.YesNo) == System.Windows.Forms.DialogResult.No)
            {
                selectionCancelled = true;
                comboBox.SelectedIndex = lastSelectedIndex;
                return;
            }

            lastSelectedIndex = comboBox.SelectedIndex;
            // Normal code of the event handler

        }
        else
        {

            selectionCancelled = false;
        } 
```

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T15:42:22.380

您应该处理 ComboBox.SelectedIndexChanged 事件。就像是：

```
this.ComboBox1.SelectedIndexChanged += new system.EventHandler(ComboBox1_SelectedIndexChanged); 
```

然后`ComboBox1_SelectedIndexChanged()`将在它发生变化时被调用，您可以在该函数中更新您的制造商信息。在填充新信息之前保存旧信息。或者在保存之前提示用户是否真的要更改它。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2011-11-27T16:12:58.013

Night Coder 的解决方案优雅而简洁。我已经将它打包在一个dll中。

（我称之为 CustomControls。）为此，创建一个新的类库并将前几个语句添加到 Night Coder 的解决方案中（为方便起见，复制到这里）。

编译代码后，您可以将其添加为参考。我实际上将 dll 加载到了我的 Visual Studio 工具窗格中。这样我就可以在设计时将控件拖到我的表单上。方便的是，新事件显示在属性列表中。

```
use System.ComponentModel;

use System.Windows.Forms; //this will need to be added as a reference

//your namespace will name your dll call it what you will

namespace CustomControls 
```

Night Coder 的解决方案如下：

```
public class ComboBoxEx : ComboBox
{
        public event CancelEventHandler SelectedIndexChanging;

    [Browsable(false)]
    public int LastAcceptedSelectedIndex { get; private set; }

    public ComboBoxEx()
    {
            LastAcceptedSelectedIndex = -1;
    }

    protected void OnSelectedIndexChanging(CancelEventArgs e)
    {
            var selectedIndexChanging = SelectedIndexChanging;
            if (selectedIndexChanging != null)
                    selectedIndexChanging(this, e);
    }

    protected override void OnSelectedIndexChanged(EventArgs e)
    {
            if (LastAcceptedSelectedIndex != SelectedIndex)
            {
                    var cancelEventArgs = new CancelEventArgs();
                    OnSelectedIndexChanging(cancelEventArgs);

                    if (!cancelEventArgs.Cancel)
                    {
                            LastAcceptedSelectedIndex = SelectedIndex;
                            base.OnSelectedIndexChanged(e);
                    }
                    else
                            SelectedIndex = LastAcceptedSelectedIndex;
            }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2014-01-16T02:00:58.483

一种跟踪未保存更改的简单方法。

加载任何原始值后，禁用“保存”按钮。

当用户试图离开时，检查是否启用了“保存”按钮。

根据需要启用或禁用“保存”按钮。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2014-10-23T16:52:17.880

我知道这是一个较老的问题，但我想我会添加我使用的方法。我不确定它是否更好。常规中应该有可以取消的`IndexChanging`事件或某事。`ComboBox`

解决方案是结合@AftabAhmedKalhoro 和@jeffamaphone 的帖子，但改用该`Tag`属性。

我不想对 进行子类化`ComboBox`，或者在表单中浮动任何额外的私有变量。但有些人可能不喜欢这个`Tag`属性，因为如果你不习惯使用它，它就会被隐藏起来（有点像 VB6 遗留下来的）。

```
Private Sub MainForm_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    ComboBox1.Items.Add("Item1")
    ComboBox1.Items.Add("Item2")
    ComboBox1.Items.Add("Item3")
    ComboBox1.Items.Add("Item4")
    ' Load Value from database or whatever and set the value or index.
    ComboBox1.SelectedIndex = 0
    ComboBox1.Tag = ComboBox1.SelectedIndex

    ' I add the handler at the end because I don't want it to fire during loading the form.
    AddHandler ComboBox1.SelectedIndexChanged, New EventHandler(AddressOf ComboBox1_SelectedIndexChanged)
End Sub

Private Sub ComboBox1_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)
    If (ComboBox1.Tag <> ComboBox1.SelectedIndex) Then
        If MessageBox.Show("Warning! You are changing the index." & vbCrLf & _
                           "Do you wish to continue?", _
                           "Changing Index", _
                           MessageBoxButtons.YesNo, _
                           MessageBoxIcon.Warning) = Windows.Forms.DialogResult.Yes Then
            ComboBox1.Tag = ComboBox1.SelectedIndex
            ' Do Something.
        Else
            ComboBox1.SelectedIndex = ComboBox1.Tag
        End If
    End If
End Sub 
```

请注意，重置`SelectedIndex`将导致事件在此行中再次触发：

```
ComboBox1.SelectedIndex = ComboBox1.Tag 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T15:44:50.267

如果您想知道如何在选择更改时收到通知，您可以订阅该[`ComboBox.SelectedIndexChanged`](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectedindexchanged(loband).aspx)事件。

如果您想为用户提供保存选项，仅当某些内容发生更改并且她忘记了所以保存她的更改时，您需要跟踪这些其他字段何时更改。这可以通过维护一个布尔值来实现，只要用户编辑任何字段，该布尔值就设置为 true。当提到的事件发生时，在决定是否提供保存选项之前检查这个值。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T15:47:32.757

这里最好的做法是将输入的数据`ComboBox`（同样与其他字段）与已经存储的数据（在任何东西中 - `DataSet`，列表对象等）进行比较，并检查是否有任何差异。这样，如果用户从 ComboBox 中选择了另一个项目，但随后将其更改回原来的项目，则程序会识别出数据仍未*被*修改。[`SelectionChangeCommited`](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectionchangecommitted.aspx)（例如，处理事件并将布尔值设置为`true`，将不允许检测到这一点，而且实施起来会稍微困难一些。）在这种情况下，最简单和最优雅的方法似乎也能提供最好的功能。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-06-02T14:58:49.913

伟大的工作夜间编码器。您的代码完美运行。

谢谢！

对于在此处使用 VB.NET 编写的开发人员，您有翻译：

```
Imports System.ComponentModel

Public Class ComboBoxEx
  Inherits ComboBox

  Private pLastAcceptedSelectedIndex As Integer

  Public Event SelectedIndexChanging As CancelEventHandler

  Public Property LastAcceptedSelectedIndex() As Integer
    Get
      Return pLastAcceptedSelectedIndex
    End Get
    Set(ByVal value As Integer)
      pLastAcceptedSelectedIndex = value
    End Set
  End Property

  Public Sub New()
    LastAcceptedSelectedIndex = -1
  End Sub

  Protected Sub OnSelectedIndexChanging(ByVal e As CancelEventArgs)
    RaiseEvent SelectedIndexChanging(Me, e)
  End Sub

  Protected Overrides Sub OnSelectedIndexChanged(ByVal e As System.EventArgs)
    If LastAcceptedSelectedIndex <> SelectedIndex Then
      Dim cancelEventArgs As CancelEventArgs

      cancelEventArgs = New CancelEventArgs()
      OnSelectedIndexChanging(cancelEventArgs)

      If Not cancelEventArgs.Cancel Then
        LastAcceptedSelectedIndex = SelectedIndex
        MyBase.OnSelectedIndexChanged(e)
      Else
        SelectedIndex = LastAcceptedSelectedIndex
      End If
    End If
  End Sub
End Class 
```

* * *

## 回答 #10

> 赞同：-2
> 
>             
> 
> 时间：2009-04-23T15:43:22.987

ComboBox 提供了一个名为 SelectedIndexChanged 的​​事件。每当 Property SelectedIndex 发生更改时都会引发此事件，因此您必须处理该事件，每当用户想要更改组合的索引时，如果用户尚未保存更改，请让他这样做。

# java - 在 Windows 上 - 我可以在哪里使用 mqji.properties？

> ID：782314
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T15:39:29.767
> 
>         
> 
> 标签：java, message-queue, ibm-mq

我的应用程序是一个独立的 Java 应用程序，客户可以下载、安装和运行。它使用 MQ 与已经工作多年的主机进行通信。我自己和客户都没有在他们的 Windows 机器上安装任何 MQ；我们包含并使用 com.ibm.mq.jar 来完成这项工作。

显然，MQ 在类路径中需要一个 mqji.properties 文件来防止这种情况：

```
Unable to load message catalog - mqji
com.ibm.mq.MQException: Message catalog not found 
```

所以我的问题是：我在哪里得到一个？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2011-01-30T18:23:25.110

这里的正确答案是客户需要下载实际的 WMQ 客户端并将其与您的应用程序一起安装，并且您的应用程序应该在没有 WMQ 客户端 jar 的情况下分发。出于多种原因，这是正确的：

*   您无权重新分发供应商的代码。当 WMQ 客户端或服务器代码捆绑在 OEM 许可证中时，它是完整的安装，而不仅仅是几个 jar 文件。

*   安装完整客户端的原因之一是为了获得支持。完整的客户端安装是免费的，包括许多诊断工具。不需要完整安装的唯一原因是方便，如果您为应用程序收费，任何便利都远远超过潜在的责任。

*   维护。如果客户安装了 WMQ 客户端，那么他们可以应用 IBM 的定期维护，并且知道它是一个完整且完整的分发版。除非您的公司准备好保证他们选择重新分发的组件是有效安装，否则您最好使用官方安装。鉴于问题的性质是询问这个社区什么是有效的非供应商安装，我看不出贵公司如何支持这种 IBM 代码配置。

*   合规性。如果您的任何客户受 PCI、SOX、HIPAA 或政府法规的约束，则在此配置下无法获得认证。例如，要符合 PCI 标准，部署的应用程序必须在很久以前就应用了 Fix Pack 7.0.1.3。如果没有完整安装，就不可能应用修订包或向审核员证明它是基于 jar 安装的。

*   安全。如果您不使用 SSL 或退出，那么您的客户可能会冒充另一个或 WMQ 管理帐户。为了使用 SSL，您必须安装 GSKit 中的 IBM JCCE 提供程序，它是完整客户端安装的一部分，包含 jar 文件中可用的本机编译 C 代码。根据应用程序的描述，我猜您的任何客户都可以远程、匿名地管理您的 QMgr 并执行任意操作系统代码。不好。

因此，正确的答案是让您和您的客户去下载并安装完整的 WMQ 客户端 ( [SupportPac MQC7](http://ibm.co/SupptPacMQC7) ) 并配置应用程序以在其上运行。任何更少的事情都会使您的客户和您的公司面临风险。

如果您对我提到的安全漏洞有任何疑问，请参阅 IMPACT *Hardening WebSphere MQ*演示文稿和[此处发布的](http://t-rob.net/links)*WebSphere MQ 动手安全实验室* 。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-10-27T08:53:31.243

这是我的 mqji.properties 文件的副本。

复制并粘贴到文本编辑器中。

另存为 mqji.properties

将此文件所在的目录放入您的 CLASSPATH。

```
# mqjiEn_US.properties
# Messages produced by the Websphere MQ Java interface classes
# (shared by bindings and by client)
# Messages beginning with MQJI are explanations for exceptions
# Messages beginning with MQJE are errors
#
# From class MQDistributionList
#
1=MQJI001: Queue manager object was null.
2=MQJI002: Not connected to a queue manager.
3=MQJI003: No object records supplied.
4=MQJI004: No response records supplied.
5=MQJI005: Not enough response records supplied.
6=MQJI006: An object or response record was null.
7=MQJI007: openResponse parameter was null.
8=MQJI008: Null message passed to put.
9=MQJI009: Null put message options passed to put.
10=MQJI010: Number of message trackers and response records do not match.
11=MQJI011: The distribution list has been closed.
#
# From class MQEnvironment
#
12=Websphere MQ Client for Java v5.3
#
# From class MQGetMessageOptions
#
13=MQJI013: Unsupported version number - {0}
14=MQJI014: Insufficient data received from queue manager.
15=MQJI015: Erroneous eyecatcher : {0}
#
# From class MQManagedObject
#
16=MQJI016: Object has been closed.
17=MQJI017: No selectors specified.
#
# From class MQMD
#
18=MQJI015: Erroneous eyecatcher : {0}
19=MQJI018: Array copy error in MQMD
#
# From class MQMessage
#
20=MQJI019: Malformed UTF string in MQMessage::readLine
21=MQJI020: Unsupported codeset : {0}
22=MQJI021: String index error occurred during codeset conversion
23=MQJI015: Erroneous eyecatcher : {0}
#
# From class MQOD
#
24=MQJI022: Unmatched number of object and response records
#
# From class MQPutMessageOptions
#
25=MQJI023: Null MQMessageTracker object supplied
#
# From class MQMessageTracker
#
26=MQJI024: Array copy error in MQMessageTracker
#
# From class MQQueue
#
27=MQJI025: Null MQMessage passed to get
28=MQJI026: Null MQGetMessageOptions passed to get
29=MQJI027: The queue has been closed
30=MQJI028: Null MQMessage passed to put
31=MQJI029: Null MQPutMessageOptions passed to put
#
# From class MQQueueManager
#
32=MQJI030: The queue manager does not support distribution lists.
#
# From class MQS390FloatSupport
#
33=MQJI031: Number outside of range for double precision S/390 Float
#
# From class MQS390PackedDecimalSupport
#
34=MQJI032: Invalid sign nibble in packed decimal
35=MQJI033: Packed Decimal digit outside of range 0-9
36=MQJI034: Outside of range for short packed decimal (+/-999)
37=MQJI035: Outside of range for integer packed decimal (+/-9999999)
38=MQJI036: Outside of range for long packed decimal (0+/-999999999999999)
#
# From class MQException
#
39=MQJE001: Completion Code {0}, Reason {1}
40=MQJE001: An MQException occurred: Completion Code {0}, Reason {1}\n{2}
#
# Messages produced by client only classes...
#
41=MQJI037: Error occurred during Websphere MQ API call - reason code {0}
42=MQJI038: Unexpected internal error during string index processing
43=MQJE002: Socket output stream was null
44=MQJE003: IO error transmitting message buffer
45=MQJE004: Socket input stream was null
46=MQJE005: TSH eyecatcher not found.  Eyecatcher was {0}
47=MQJE006: Internal error during array copy
48=MQJE007: IO error reading message data
49=MQJE008: IOException whilst sending status message
50=MQJE009: Failed to build API header
51=MQJE010: Unknown host: {0}
52=MQJE011: Socket connection attempt refused
53=MQJE012: Security error - cannot connect to host {0}
54=MQJE013: Error accessing socket streams
55=MQJE014: Control Point rejected connection
56=MQJE015: Error connecting to Control Point
57=MQJE016: MQ queue manager closed channel immediately during connect\n\Closure reason = {0}
58=MQJE017: MQ queue manager sent status error {0} during connect
59=MQJE018: Protocol error - unexpected segment type received
60=MQJE019: Error creating initial data segment
61=MQJE020: CCSID not supported by queue manager
62=MQJE021: Encoding not supported by queue manager
63=MQJE022: FAP level not supported by queue manager
64=MQJE023: Negotiation failed on maximum messages per batch
65=MQJE024: Sequence wrap value not supported by queue manager
66=MQJE025: Channel closed after two initial changes.  Closure reason {0}
67=MQJE026: Queue manager sent status error {0} during connect
68=MQJE027: Queue manager security exit rejected connection with error code {0}
69=MQJE028: Channel closed during security exchanges
70=MQJE029: Unexpected message type sent by queue manager
71=MQJE030: IOException during security flows
72=MQJE031: Security exit closed the channel
73=MQJE032: Queue manager security exit rejected connection with reason code {0}
74=MQJE033: A required security flow was not sent by the queue manager
75=MQJE034: Unexpected message type sent by queue manager
76=MQJE035: Negotiated maximum transmission size is too small
77=MQJE036: Queue manager rejected connection attempt
78=MQJE037: Remote queue manager closed the connection
79=MQJE038: Unexpected segment type {0} received
80=MQJE039: IOException whilst building connection data stream
81=MQJE040: Channel closed by exit
82=MQJE041: Unsupported version number - (0)
83=MQJE042: Erroneous eyecatcher: {0}
84=MQJE043: Insuffucient data received from queue manager
85=MQJE044: Array copy error in MQMD
86=MQJE045: Malformed UTF string
87=MQJE046: Unsupported codeset : {0}
88=MQJE047: String index error occurred during codeset conversion
89=MQJE048: Invalid sign nibble in packed decimal
90=MQJE049: Packed Decimal digit outside of range 0-9
91=MQJE050: Outside of range for short packed decimal (+/-999)
92=MQJE051: Outside of range for integer packed decimal (+/-9999999)
93=MQJE052: Outside of range for long packed decimal (0+/-999999999999999)
94=Websphere MQ Bindings for Java v5.3
95=MQJE053: The Websphere MQ Bindings for Java library could not be loaded
96=MQJE054: The queue manager does not support distribution lists
97=MQJE055: The queue manager does not support version 2 Websphere MQ API structures
98=MQJE056: Initial negotiation failure
99=MQJE057: Channel closed during security exchanges
100=MQJE058: Invalid number of object or response records
101=MQJE059: String index error
102=MQJE060: Could not find class {0}
103=MQJE061: Could not find field {0}
104=MQJE062: Could not find method {0}
#
# Messages used by MQManagedConnectionJ11, ManagedConnectionFactories
# and MQManagedConnectionMetaData
#
105=MQJI039: Invalid ConnectionRequestInfo object
106=MQJI040: MQManagedConnection already destroyed
107=MQJI041: Method {0} is not supported by Websphere MQ Classes for Java
108=MQJI042: MQManagedConnection is not reusable
#
# Messages from MQManagedConnectionMetaData
#
109=IBM Websphere MQ
110=Command Level {0}
#
# Messages from MQXAi
#
111=Security manager prevented access to native methods library for MQ XA support.
112=Failed to load native methods library for MQ XA support.
#
# Messages from MQXAResource
#
113=xa_open failed
114=XA operation failed, see errorCode
115=XAResource closed

#
# Messages produced by com.ibm.mq.MQMsg2
#
116=MQJE063: Unsupported character set {0}
117=MQJE064: Unsupported version of MQMD structure {0}
118=MQJE065: Inconsistent internal state detected

# message when server doesn't support client XA
119=client connection not XA enabled

#
# Messages produced via SSL options on a client connection
#
120=MQJE066: {0} provided as an unsupported object type
121=MQJE067: Peer name {0} did not match requested name {1}
122=MQJE068: Server certificate has been revoked
123=MQJE069: Unable to contact CertStore
124=MQJE070: SSL Protocol error: Channel not configured for SSL? 
```

# wpf - WPF 数据绑定手动更新

> ID：782315
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-23T15:40:01.060
> 
>         
> 
> 标签：wpf, data-binding

我有一个来自非 WPF 程序集的 List<Foo>，我正在尝试将其数据绑定到 WPF <ListBox>。最初，列表项显示正确，但是当我向 List<Foo> 添加新项时，列表框不会添加列表项。如何告诉列表框重新绑定/更新/刷新数据并显示新项目？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-04-24T15:00:59.430

虽然使用 ObservableCollection 是最好的方法，但要回答实际问题，手动更新的方法是调用 BindingExpression.UpdateTarget

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T15:45:49.033

您应该改用 ObservableCollection，然后您将自动获得更新。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-08-06T17:36:47.897

感谢您发布此答案。即使您使用 ObservableCollection，您也可能需要使用 BindingExpression.UpdateTarget。如果集合不在 UI 线程中，就会出现这种情况。我一直在编写一些多线程 WPF 应用程序，当我将模型代码移动到另一个线程时，我发现自己不得不剥离数据绑定，因为我不能指望更新系统真正工作。虽然我发现数据绑定是一个很棒的概念，但我认为数据绑定系统的不透明性一直是我采用它的真正障碍。（对不起，咆哮！）再次感谢亚当。

# c++ - C++ HTML 生成类

> ID：782316
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-23T15:40:29.810
> 
>         
> 
> 标签：c++, html

[jbar 的](https://stackoverflow.com/questions/779573/what-works-for-web-dev-in-c/779585#779585)question 提示的一个问题。

在 Python、Ruby 和 Perl 等脚本语言中，有一些库可以简化生成动态 HTML。（例如，Ruby 中的[cgi](http://ruby-doc.org/stdlib/libdoc/cgi/rdoc/classes/CGI.html)模块。）

有没有类似的 C++ 包？我不知道有一个，至少一些断断续续的谷歌搜索没有发现一个。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T15:52:35.507

[http://www.webtoolkit.eu/wt#/](http://www.webtoolkit.eu/wt#/)

我对此一无所知，但他们的网页很干净，而且介绍听起来正是您正在寻找的......

> Wt（读作“witty”）是一个用于开发和部署 Web 应用程序的 C++ 库和应用程序服务器。它不是一个强制编程方式的“框架”，而是一个库。

...

> 相比之下，使用 Wt 开发的 Web 应用程序仅使用一种编译语言 (C++) 编写，库从中生成必要的 HTML/XHTML、Javascript、CGI、SVG/VML/Canvas 和 AJAX 代码。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T15:42:10.320

[Cgicc 进行](http://www.gnu.org/software/cgicc/)HTML 生成。我玩过一次，感觉还不错。

# c++ - 实施行进立方体算法？

> ID：782329
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-04-23T15:42:32.537
> 
>         
> 
> 标签：c++, opengl, rendering, 3d

来自我的最后一个问题：[Marching Cube Question](https://stackoverflow.com/questions/776664/marching-cube-question)

但是，我仍然不清楚，如：

1.  如何创建虚构的立方体/体素来检查顶点是否低于等值面？

2.  我怎么知道哪个顶点在等值面下方？

3.  每个立方体/体素如何确定使用哪个立方体索引/曲面？

4.  如何使用 triTable 中的数据绘制表面？

假设我有一个苹果的点云数据。

我该如何进行？

熟悉Marching Cube的人可以帮助我吗？

我只知道 C++ 和 opengl。（c 有点失控）

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:36:35.210

首先，等值面可以用两种方式表示。一种方法是将等值和每点标量作为来自外部源的数据集。这就是 MRI 扫描的工作原理。第二种方法是创建一个隐式函数 F()，它将一个点/顶点作为其参数并返回一个新的标量。考虑这个函数：

```
float computeScalar(const Vector3<float>& v)
{
    return std::sqrt(v.x*v.x + v.y*v.y + v.z*v.z);
} 
```

这将计算标量场中每个点从该点到原点的距离。如果等值是半径，那么您只是想出了一种表示球体的方法。这是因为 |v| <= R 对于球体内的所有点或位于其内部的所有点都是正确的。只需弄清楚哪些顶点在球体内，哪些在球体外。您想使用小于或大于运算符，因为卷将空间一分为二。当您知道立方体中的哪些点被分类为内部和外部时，您也知道等值面与哪些边相交。你可以得到从没有三角形到五个三角形的所有东西。网格顶点的位置可以通过在相交的边上插值来找到实际的交点来计算。

* * *

如果你想用标量字段表示一个苹果，你要么需要获取源数据集以插入你的应用程序，要么使用一个非常复杂的隐式函数。我建议先让简单的几何图元（如球体和圆环）开始工作，然后再从那里扩展。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:04:51.603

1）这取决于你的实施。您需要有一个数据结构，您可以在其中查找体素或立方体的每个角（顶点）的值。这可以是 3d 图像（即：OpenGL 中的 3D 纹理），也可以是自定义的数组数据结构，或您希望的任何其他格式。

2）您需要检查立方体的顶点。对此有不同的优化，但一般来说，从第一个角开始，只需检查立方体所有 8 个角的值。

3) 大多数（快速）算法会创建一个位掩码，用作查找表到静态选项数组中。对此只有这么多可能的选择。

4) 一旦你从 triTable 制作了三角形，你就可以使用 OpenGL 来渲染它们。

> 假设我有一个苹果的点云数据。我该如何进行？

这不适用于行进立方体。行进立方体需要体素数据，因此您需要使用一些算法将数据点云放入立方体积中。高斯溅射是这里的一个选项。

通常，如果您从点云工作，并且想要查看表面，则应该查看表面重建算法而不是行进立方体。

如果您想了解更多信息，我强烈建议您阅读一些有关可视化技术的书籍。一个不错的工具来自 Kitware 人员 - [The Visualization Toolkit](http://kitware.stores.yahoo.net/vistooltex.html)。

您可能想看看[VTK](http://www.vtk.org/)。它具有[Marching Cubes](http://www.vtk.org/doc/nightly/html/classvtkMarchingCubes.html)的 C++ 实现，并且是完全开源的。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2012-08-27T20:44:26.683

根据要求，这里是一些实现 Marching Cubes 算法的示例代码（使用 JavaScript/Three.js 作为图形）：

[http://stemkoski.github.com/Three.js/Marching-Cubes.html](http://stemkoski.github.com/Three.js/Marching-Cubes.html)

有关该理论的更多详细信息，您应该查看文章

[http://paulbourke.net/geometry/polygonise/](http://paulbourke.net/geometry/polygonise/)

# sql - 如何找出谁以及何时更改了存储过程中的权限/授权

> ID：782332
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T15:42:58.323
> 
>         
> 
> 标签：sql, sql-server-2005

SQL Server 2005 中有一个存储过程，其中用户声称执行权限已被删除，因为他们无法再执行该存储过程。

我试图在跟踪文件中找到它，但我找不到这个存储过程的条目

我的问题是有没有其他方法可以找出谁以及何时更改了此存储过程的权限/授予？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2013-12-14T21:27:51.373

```
select P.permission_name,  
P.state_desc,
U.name GranteeName, 
U2.name GrantorName, 
T.*
from sys.database_permissions P 
JOIN sys.objects  T  ON P.major_id = T.object_id 
JOIN sysusers U  ON U.uid = P.grantee_principal_id
JOIN sysusers U2 ON U2.uid = P.grantor_principal_id
ORDER by T.modify_date  desc

Unfortunately, the 'who' is typically 'dbo'... 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:30:55.540

恢复备份？

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:11:27.887

抱歉不行。您必须审核（例如通过 DDL 触发器）实际的 REVOKE 或 DENY 语句。

但是，如果 proc 被删除并重新创建，则审核没有权限更改。您可以查询`sys.objects`获取`create_date`并`modify_date`了解是否发生了这种情况。

还有其他选项，例如删除登录，因此即使权限没有更改，用户也不再有资格执行代码。或者如果使用 Windows 身份验证，则 NT 组已更改。明确的 REVOKE/DENY 或 DROP/CREATE 可能不是显而易见的答案。

编辑，根据评论：

您的问题是“..用户声称执行权限已被删除...”。除了显式存储过程权限更改外，环境可能已更改。也就是说，如果：

*   用户被从组中删除

*   在数据库中没有用户映射的情况下，登录被删除并重新创建

*   组策略已更改，因此 NT 组无法再访问 SQL Server（他们需要“允许从网络登录”-ish）

存储过程权限是否已更改，或者用户访问存储过程的方式是否已更改？

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2018-10-19T07:37:01.683

```
Select      memb.Name As UserName,
            prin.Name As RoleName,
            perm.permission_name As PermissionType,
            schm.name As SchemaName,
            objt.Name As ObjectName,
            perm.state_desc As PermissionState,
            memb.Create_Date ,
            memb.Modify_Date
from        sys.database_principals memb
Left Join   sys.database_role_members rolm 
            on rolm.Member_principal_id = memb.Principal_id  
Left Join   sys.database_principals prin 
            on rolm.Role_principal_id = prin.Principal_id
Left Join   sys.database_permissions perm 
            on memb.Principal_id = perm.grantee_principal_id  
Left Join   sys.all_objects objt 
            on perm.Major_Id = objt.Object_Id
Left Join   sys.Schemas schm 
            on objt.schema_id = schm.schema_id
Order By    memb.Name, 
            prin.Name, perm.permission_name, 
            objt.Name, perm.state_desc; 
```

# c - 使用 nftw 发出警告

> ID：782338
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-04-23T15:44:31.487
> 
>         
> 
> 标签：c, linux, unix, posix

我正在尝试使用[nftw](http://www.opengroup.org/onlinepubs/009695399/functions/nftw.html)处理目录下的一些文件

```
#include <ftw.h>
#include <stdio.h>

 int wrapper(const char * fpath, const struct stat *sb, int typeflag, struct FTW *ftwbuf) {
  printf("File %d\n", ftwbuf->base);
  return(0);
} 

int main(int argc, char ** argv) {
    const char *name;
    int flags = 0;
    name = argv[1];
    nftw(name, wrapper, 20, flags);
    return 0;

} 
```

当我编译 (gcc kconfig_parser.c -o parser) 时，我收到了这个警告和这个错误..

```
kconfig_parser.c:5: warning: ‘struct FTW’ declared inside parameter list 
kconfig_parser.c:5: warning: its scope is only this definition or declaration, which is probably not what you want
kconfig_parser.c: In function ‘wrapper’:
kconfig_parser.c:6: error: dereferencing pointer to incomplete type 
```

我检查了结构的定义和回调的原型，还有一些例子，应该没问题......我做错了什么？（我已经删除了几乎所有代码来清除它）......

谢谢

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-04-23T16:00:07.127

出于某种原因，Linux 仍然为此 API 使用 SUSv1，其中 nftw() 仍被视为扩展。

在 Linux[手册页](http://linux.die.net/man/3/nftw)中，包含必须是：

```
#define _XOPEN_SOURCE 500
#include <ftw.h> 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T15:56:21.193

唔。你的代码对我有用。检查您的包含路径，也许？虽然这是一个系统头文件，所以应该很难错过它。还是您不小心编译了没有该`#include <ftw.h>`行的版本？

```
$ gcc -o ftw ftw.c
$ ./ftw my-directory
File 10
File 11
File 16
File 16
File 16
File 16
File 16
... etc ... 
```

**编辑**：上面的测试是在 Mac OS X 上完成的。在（现已删除）评论中，OP 提到他在 Debian 上，正如 Juliano 指出的那样，[手册页](http://manpages.debian.net/cgi-bin/man.cgi?query=nftw&apropos=0&sektion=0&manpath=Debian+Sid&format=html&locale=en)提到这是必要的。`#define _XOPEN_SOURCE 500`

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2020-01-24T03:00:04.673

在 CentOs 版本上，头文件没有使用“#define _XOPEN_SOURCE 500”，我必须在下面这样做，

```
#define __USE_XOPEN_EXTENDED 1
#include <ftw.h> 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2020-02-07T21:56:32.910

在 Ubuntu 18.04 上，这似乎现在可以工作（类似于 JohnMeg 提到的 CentOS）。

`#define __USE_XOPEN_EXTENDED 1
 #include  <ftw.h>`

# linq - 如何在 LINQ 中将 OR 运算符动态添加到 WHERE 子句

> ID：782339
> 
>         
> 
> 赞同：36
> 
>         
> 
> 时间：2009-04-23T15:44:37.273
> 
>         
> 
> 标签：linq, linq-to-sql, dynamic

我有一个可变大小的字符串数组，我试图以编程方式循环遍历数组并匹配表中的所有行，其中“标签”列至少包含数组中的一个字符串。这是一些伪代码：

```
 IQueryable<Songs> allSongMatches = musicDb.Songs; // all rows in the table 
```

我可以轻松地在一组固定的字符串上查询此表过滤，如下所示：

```
 allSongMatches=allSongMatches.Where(SongsVar => SongsVar.Tags.Contains("foo1") || SongsVar.Tags.Contains("foo2") || SongsVar.Tags.Contains("foo3")); 
```

但是，这不起作用（我收到以下错误：“无法将带有语句体的 lambda 表达式转换为表达式树”）

```
 allSongMatches = allSongMatches.Where(SongsVar =>
     {
       bool retVal = false;
       foreach(string str in strArray)
       {
         retVal = retVal || SongsVar.Tags.Contains(str);
       }
       return retVal;
     }); 
```

谁能告诉我正确的策略来实现这一点？我对 LINQ 的世界还是陌生的 :-)

* * *

## 回答 #1

> 赞同：38
> 
>             
> 
> 时间：2009-04-23T15:47:14.787

您可以使用[`PredicateBuilder`](http://www.albahari.com/nutshell/predicatebuilder.aspx)该类：

```
var searchPredicate = PredicateBuilder.False<Songs>();

foreach(string str in strArray)
{
   var closureVariable = str; // See the link below for the reason
   searchPredicate = 
     searchPredicate.Or(SongsVar => SongsVar.Tags.Contains(closureVariable));
}

var allSongMatches = db.Songs.Where(searchPredicate); 
```

[LinqToSql 奇怪的行为](https://stackoverflow.com/questions/658818/linqtosql-strange-behaviour/658840#658840)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-22T18:54:33.920

还有另一种更简单的方法可以完成此操作。ScottGu 的博客详细介绍了我过去发现非常有用的动态 linq 库。本质上，它从您传入的字符串生成查询。这是您编写的代码示例：

```
Dim Northwind As New NorthwindDataContext

Dim query = Northwind.Products _
                     .Where("CategoryID=2 AND UnitPrice>3") _
                     .OrderBy("SupplierId")

Gridview1.DataSource = query
Gridview1.DataBind() 
```

更多信息可以在 scottgu 的博客上[找到。](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2013-12-12T12:11:17.800

我最近创建了一个扩展方法来创建字符串搜索，它也允许`OR`搜索。[在这里](http://jnye.co/Posts/8/generic-iqueryable-or-search-for-multiple-search-terms-using-expression-trees)写博客

我还将它创建为可以安装的 nuget 包：

[http://www.nuget.org/packages/NinjaNye.SearchExtensions/](http://www.nuget.org/packages/NinjaNye.SearchExtensions/)

**安装后，您将能够执行以下操作**

```
var result = db.Songs.Search(s => s.Tags, strArray); 
```

如果要创建自己的版本以允许上述操作，则需要执行以下操作：

```
public static class QueryableExtensions  
{  
    public static IQueryable<T> Search<T>(this IQueryable<T> source, Expression<Func<T, string>> stringProperty, params string[] searchTerms)  
    {  
        if (!searchTerms.Any())  
        {  
            return source;  
        }  

        Expression orExpression = null;  
        foreach (var searchTerm in searchTerms)  
        {  
            //Create expression to represent x.[property].Contains(searchTerm)  
            var searchTermExpression = Expression.Constant(searchTerm);  
            var containsExpression = BuildContainsExpression(stringProperty, searchTermExpression);  

            orExpression = BuildOrExpression(orExpression, containsExpression);  
        }  

        var completeExpression = Expression.Lambda<Func<T, bool>>(orExpression, stringProperty.Parameters);  
        return source.Where(completeExpression);  
    }  

    private static Expression BuildOrExpression(Expression existingExpression, Expression expressionToAdd)  
    {  
        if (existingExpression == null)  
        {  
            return expressionToAdd;  
        }  

        //Build 'OR' expression for each property  
        return Expression.OrElse(existingExpression, expressionToAdd);  
    }  
} 
```

或者，看看 github 项目，[`NinjaNye.SearchExtensions`](https://github.com/ninjanye/SearchExtensions)因为它有其他选项，并且已经进行了一些重构以允许其他组合

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:01:11.197

要么建立`Expression<T>`自己，要么看看不同的路线。

假设 possibleTags 是标签的集合，您可以使用闭包和连接来查找匹配项。这应该会在 possibleTags 中找到任何带有至少一个标签的歌曲：

```
allSongMatches = allSongMatches.Where(s => (select t from s.Tags
                                            join tt from possibleTags
                                                on t == tt
                                            select t).Count() > 0) 
```

# delphi - 在 Delphi 选项页面中设置浏览路径的问题

> ID：782341
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-04-23T15:45:10.393
> 
>         
> 
> 标签：delphi, delphi-2009

我在 Delphi 2009 中设置浏览路径时遇到问题：

当我安装一个新组件时，我将 DCU 路径添加到 Delphi 的库路径，并将源路径添加到 Delphi 的浏览路径。应用程序编译正常，但按住 Ctrl 并单击该组件的任何单元名称不会打开源文件！

似乎使其工作的唯一方法是将源路径添加到库路径，但这意味着我每次构建项目时都必须编译属于第三方组件的所有单元！

Delphi的标准单元，甚至JCL\JVCL安装程序安装的JCL和JVCL单元都不存在这个问题，并将它们的源路径添加到浏览路径中。

这是一个错误，还是我做错了什么？

问候

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2010-03-06T20:27:14.490

我为这个问题苦苦挣扎了很长时间。将包设置中的 REFERENCEINFO 从“无”更改为“仅定义”就可以了。希望这对您也有帮助。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-02T15:01:32.823

.dpr 中是否列出了这些单位？路径错误的单元可能会导致非常时髦的行为。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2011-02-17T10:02:27.240

将“符号参考信息”设置为“参考信息”确实可以解决浏览路径的问题。

但至少对于 Delphi XE，必须在“Build Configuration -> Base”中进行更改才能使其正常工作。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-24T18:20:34.300

我会确保在打开调试的情况下编译 dcu。如果这是第三方组件并且随它一起提供了源，则通常是这种情况，但并非总是如此。

# c# - 删除和重新插入 ListView 列 (.NET)

> ID：782345
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T15:45:58.753
> 
>         
> 
> 标签：c#, .net, winforms

我希望能够以最后删除先重新插入的方式删除和重新插入列，但是如果删除了超过 1 个列，则 ListViewItem.SubItems[] 值会变得混乱。

例如，

ABCD A0 B0 C0 D0

如果我删除 B，则 B0 会按预期消失。当我重新插入 B 时，B0 重新出现在 A0 和 C0 之间的正确位置。

但是，如果我删除 B，然后是 C，然后重新插入 C；那么B0出现在C列，C0出现在D列，D0就不见了。

关于如何获得我想要的行为的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:39:56.107

诀窍是尽可能使用伪造品。隐藏列，不要删除它们。您可以通过将其宽度设置为 0 来隐藏一列。

否则，将您的数据移动到使用某种实际的网格。

# php - MySQLiQuery_Exception' 带有消息'非法混合排序规则 (latin1_swedish_ci,IMPLICIT) 和 (utf8_general_ci,COERCIBLE) - 使用 PHP5

> ID：782346
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T15:46:05.990
> 
>         
> 
> 标签：php, mysql, utf-8, collation

我有这个错误：

```
Fatal error: Uncaught exception 'MySQLiQuery_Exception' with message 'Illegal mix of collations (latin1_swedish_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation '=': select id from 'addresses' where 'shiptozip'='13000' and 'shiptostreet'='Františka Křížka' 
```

如您所见，我正在尝试从表地址中获取 ID。

```
mysql> show variables like 'character%';

+--------------------------+----------------------------+
| Variable_name            | Value                      |
+--------------------------+----------------------------+
| character_set_client     | utf8                       |
| character_set_connection | utf8                       |
| character_set_database   | utf8                       |
| character_set_filesystem | binary                     |
| character_set_results    | utf8                       |
| character_set_server     | utf8                       |
| character_set_system     | utf8                       |
| character_sets_dir       | /usr/share/mysql/charsets/ |
+--------------------------+----------------------------+

mysql> show variables like 'collation%';
+----------------------+-----------------+
| Variable_name        | Value           |
+----------------------+-----------------+
| collation_connection | utf8_general_ci |
| collation_database   | utf8_general_ci |
| collation_server     | utf8_general_ci |
+----------------------+-----------------+ 
```

表“地址”也有`utf8_general_ci`和`utf8`。我想这与查询 Františka Křížka 有关，因为它与其他查询有关。server_collat​​ion 曾经是，`latin_swedish_ci`但我想我现在已经设法改变了这一切（从上表中可以看出）。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:08:29.243

您能否将“shiptoaddress”和“shiptozip”列的排序规则附加到您的问题：

```
SHOW FULL COLUMNS FROM addresses; 
```

根据您提供的证据，可能发生的是“shiptoaddress”列仍然具有 latin1 编码。当您为表设置编码/排序规则时，您正在设置默认值。可以为各个列覆盖此默认值。

如果查询适用`where address = 'Frank'`但不适用，`where address = 'Františka'`那是因为“Františka”不能转换为 latin1。

# asp.net-mvc - 如何更改 ASP.NET MVC URL 中的控制器文本？

> ID：782347
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-23T15:46:07.520
> 
>         
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我最近被要求修改一个小的 asp.net mvc 应用程序，以便 url 中的控制器名称包含破折号。例如，我创建了一个名为 ContactUs 的控制器，其视图名为 Index 和 Sent，其 url 将是[http://example.com/ContactUs](http://example.com/ContactUs)和[http://example.com/ContactUs/Sent](http://example.com/ContactUs/Sent)。要求我进行更改的人希望网址为[http://example/contact-us](http://example/contact-us)和[http://example.com/contact-us/sent](http://example.com/contact-us/sent)。

我不相信我可以更改控制器的名称，因为“-”将是类名中的非法字符。

我正在寻找一个可以应用于控制器类的属性，它可以让我指定控制器将在 url 中使用的字符串，但我还没有找到。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-04-23T15:52:56.770

只需将路由本身中使用的 URL 更改为指向现有控制器。在您的 Global.asax 中：

```
routes.MapRoute(
  "Contact Us",
  "contact-us/{action}/",
  new { controller = "ContactUs", action = "Default" }
); 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T15:52:09.253

我不相信您可以更改控制器的显示名称。在测试版中，控制器是使用带有“控制器”后缀的路由数据“控制器”创建的。这可能在 RC/RTM 中发生了变化，但我不确定。

如果您创建“contact-us/{action}”的自定义路由并指定默认值：`new { controller = "ContactUs" }`您应该得到您想要的结果。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T15:55:30.647

您需要配置路由。在您的`Global.asax`中，执行以下操作：

```
public static void RegisterRoutes(RouteCollection routes)
{
  ...
  routes.MapRoute(
    "route-name", "contact-us/{action}", // specify a propriate route name...
    new { controller = "ContactUs", action = "Index" }
  );
  ... 
```

正如 Richard Szalay 所指出的，`sent`不需要指定操作。如果 url 错过了该`.../sent`部分，它将默认为该`Index`操作。

请注意，当您将路由添加到`RouteCollection`. 将选择第一个匹配的路由，其余的将被忽略。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T15:56:09.010

一位 ASP.NET MVC 开发人员涵盖了 Iconic 所谈论的内容。这是我今天在[haacked](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx)上看到的东西。值得检查一下 MVC 架构中的自定义路由。

*编辑*：啊，我明白了，您可以使用自定义路线，但在这种情况下，这可能不是最好的解决方案。除非有办法`{controller}`在映射之前处理它？如果这是可能的，那么您可以替换所有“-”字符。

# parsing - 解析来自用户输入的命令

> ID：782348
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T15:46:12.603
> 
>         
> 
> 标签：parsing, user-input

这个问题旨在讨论人们在处理用户输入时的个人意见。  

我正在处理的项目的这一部分以类似于 IRC 聊天的方式处理用户输入。例如，有设置命令之类的，用于聊天、执行操作等。

现在，我有几个选项可供选择来解析此输入。我可以使用正则表达式，我可以直接解析它（即一个包含所有支持的命令的大型 switch 语句，只需检查用户输入中的前 x 个字符），或者甚至可以发疯并添加类似于 Flex 的解析器/野牛实现。我正在考虑的另一种选择是在 XML 文件中定义所有命令，以将它们与代码实现分开。

那么，社区的想法是什么？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:00:37.033

我会选择一个很好的混合包。

显然，您必须清理输入。确保那里没有讨厌的东西，这取决于输入将在哪里防止 SQL 注入、XSS、CSRF 等......

但是，当您的输入是干净的时，您可以使用一个正则表达式来捕获预期作为命令的那些并获取所有必要的子匹配（命令参数等），然后使用某种调度程序开关语句或类似语句。

这里真的没有包罗万象的最佳实践，除了总是总是和四倍——总是确保用户输入被清理。除此之外，选择最适合您的情况的方法。

显然，有些人说如果您遇到问题并且正在考虑使用 reg exps 来解决所述问题，那么您遇到了两个问题，但请谨慎使用，它们是有史以来最好的事情。请记住，正则表达式怪物可以非常快地阅读到非常差的可读性。

# sql-server - SQL Server 批量插入带有不一致引号的 CSV 文件

> ID：782353
> 
>         
> 
> 赞同：32
> 
>         
> 
> 时间：2009-04-23T15:47:40.527
> 
>         
> 
> 标签：sql-server, csv, bulkinsert

是否可以批量插入（SQL Server）一个 CSV 文件，其中的字段仅偶尔被引号包围？具体来说，引号仅围绕那些包含“，”的字段。

换句话说，我的数据看起来像这样（第一行包含标题）：

```
id, company, rep, employees
729216,INGRAM MICRO INC.,"Stuart, Becky",523
729235,"GREAT PLAINS ENERGY, INC.","Nelson, Beena",114
721177,GEORGE WESTON BAKERIES INC,"Hogan, Meg",253 
```

因为引号不一致，我不能使用 '","' 作为分隔符，我不知道如何创建一个格式文件来解决这个问题。

我尝试使用'，'作为分隔符并将其加载到一个临时表中，其中每一列都是一个varchar，然后使用一些kludgy处理来去除引号，但这也不起作用，因为包含'，'的字段被分成多列。

不幸的是，我无法事先操作 CSV 文件。

这是没有希望的吗？

非常感谢您的任何建议。

顺便说一句，我看到这篇文章[SQL bulk import from csv](https://stackoverflow.com/questions/96448/sql-bulk-import-from-csv)，但在这种情况下，每个字段都始终用引号括起来。因此，在这种情况下，他可以使用 ',' 作为分隔符，然后去掉引号。

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2009-04-23T17:26:33.143

无法从 MSDN 对此文件进行批量插入：

要用作批量导入的数据文件，CSV 文件必须符合以下限制：

*   数据字段从不包含字段终止符。

*   数据字段中的任何值或所有值都用引号 ("") 括起来。

( [http://msdn.microsoft.com/en-us/library/ms188609.aspx](http://msdn.microsoft.com/en-us/library/ms188609.aspx) )

一些简单的文本处理应该是使文件准备好导入所需的全部内容。或者，您的用户可能需要根据这些指南格式化文件或使用逗号以外的其他内容作为分隔符（例如 |）

* * *

## 回答 #2

> 赞同：18
> 
>             
> 
> 时间：2010-01-23T20:53:03.040

您将需要预处理文件，期间。

如果你真的需要这样做，这里是代码。我写这篇文章是因为我绝对别无选择。它是实用程序代码，我并不为此感到自豪，但它确实有效。该方法不是让 SQL 理解引用的字段，而是操纵文件以使用完全不同的分隔符。

编辑：这是 github repo 中的代码。它已经过改进，现在带有单元测试！[https://github.com/chrisclark/Redelim-it](https://github.com/chrisclark/Redelim-it)

此函数接受一个输入文件，并将用新的分隔符替换所有字段分隔逗号（引用文本字段中的不是逗号，只是实际的分隔符）。然后，您可以告诉 sql server 使用新的字段分隔符而不是逗号。在此处的函数版本中，占位符是 < *TMP* >（我相信这不会出现在原始 csv 中 - 如果出现，请做好爆炸的准备）。

因此，在运行此函数后，您可以通过执行以下操作在 sql 中导入：

```
BULK INSERT MyTable
FROM 'C:\FileCreatedFromThisFunction.csv'
WITH
(
FIELDTERMINATOR = '<*TMP*>',
ROWTERMINATOR = '\n'
) 
```

事不宜迟，我提前为对您造成的可怕而可怕的功能表示歉意（编辑-我已经发布了一个可以执行此操作的工作程序，而不仅仅是[我博客上](http://blog.untrod.com/2010/01/parsing-quoted-fields-in-csv-file-in.html)的功能）：

```
Private Function CsvToOtherDelimiter(ByVal InputFile As String, ByVal OutputFile As String) As Integer

        Dim PH1 As String = "<*TMP*>"

        Dim objReader As StreamReader = Nothing
        Dim count As Integer = 0 'This will also serve as a primary key'
        Dim sb As New System.Text.StringBuilder

        Try
            objReader = New StreamReader(File.OpenRead(InputFile), System.Text.Encoding.Default)
        Catch ex As Exception
            UpdateStatus(ex.Message)
        End Try

        If objReader Is Nothing Then
            UpdateStatus("Invalid file: " & InputFile)
            count = -1
            Exit Function
        End If

        'grab the first line
    Dim line = reader.ReadLine()
    'and advance to the next line b/c the first line is column headings
    If hasHeaders Then
        line = Trim(reader.ReadLine)
    End If

    While Not String.IsNullOrEmpty(line) 'loop through each line

        count += 1

        'Replace commas with our custom-made delimiter
        line = line.Replace(",", ph1)

        'Find a quoted part of the line, which could legitimately contain commas.
        'In that case we will need to identify the quoted section and swap commas back in for our custom placeholder.
        Dim starti = line.IndexOf(ph1 & """", 0)
        If line.IndexOf("""",0) = 0 then starti=0

        While starti > -1 'loop through quoted fields

            Dim FieldTerminatorFound As Boolean = False

            'Find end quote token (originally  a ",)
            Dim endi As Integer = line.IndexOf("""" & ph1, starti)

            If endi < 0 Then
                FieldTerminatorFound = True
                If endi < 0 Then endi = line.Length - 1
            End If

            While Not FieldTerminatorFound

                'Find any more quotes that are part of that sequence, if any
                Dim backChar As String = """" 'thats one quote
                Dim quoteCount = 0
                While backChar = """"
                    quoteCount += 1
                    backChar = line.Chars(endi - quoteCount)
                End While

                If quoteCount Mod 2 = 1 Then 'odd number of quotes. real field terminator
                    FieldTerminatorFound = True
                Else 'keep looking
                    endi = line.IndexOf("""" & ph1, endi + 1)
                End If
            End While

            'Grab the quoted field from the line, now that we have the start and ending indices
            Dim source = line.Substring(starti + ph1.Length, endi - starti - ph1.Length + 1)

            'And swap the commas back in
            line = line.Replace(source, source.Replace(ph1, ","))

            'Find the next quoted field
            '                If endi >= line.Length - 1 Then endi = line.Length 'During the swap, the length of line shrinks so an endi value at the end of the line will fail
            starti = line.IndexOf(ph1 & """", starti + ph1.Length)

        End While

            line = objReader.ReadLine

        End While

        objReader.Close()

        SaveTextToFile(sb.ToString, OutputFile)

        Return count

    End Function 
```

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2012-03-02T16:00:32.603

我发现 Chris 的答案非常有帮助，但我想使用 T-SQL（而不是使用 CLR）在 SQL Server 中运行它，所以我将他的代码转换为 T-SQL 代码。但后来我更进一步，将所有内容包装在执行以下操作的存储过程中：

1.  使用批量插入最初导入 CSV 文件

2.  使用 Chris 的代码清理行

3.  以表格形式返回结果

为了我的需要，我通过删除值周围的引号并将两个双引号转换为一个双引号来进一步清理行（我认为这是正确的方法）。

```
CREATE PROCEDURE SSP_CSVToTable

-- Add the parameters for the stored procedure here
@InputFile nvarchar(4000)
, @FirstLine int

AS

BEGIN

-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;

--convert the CSV file to a table
--clean up the lines so that commas are handles correctly

DECLARE @sql nvarchar(4000)
DECLARE @PH1 nvarchar(50)
DECLARE @LINECOUNT int -- This will also serve as a primary key
DECLARE @CURLINE int
DECLARE @Line nvarchar(4000)
DECLARE @starti int
DECLARE @endi int
DECLARE @FieldTerminatorFound bit
DECLARE @backChar nvarchar(4000)
DECLARE @quoteCount int
DECLARE @source nvarchar(4000)
DECLARE @COLCOUNT int
DECLARE @CURCOL int
DECLARE @ColVal nvarchar(4000)

-- new delimiter
SET @PH1 = '†'

-- create single column table to hold each line of file
CREATE TABLE [#CSVLine]([line] nvarchar(4000))

-- bulk insert into temp table
-- cannot use variable path with bulk insert
-- so we must run using dynamic sql
SET @Sql = 'BULK INSERT #CSVLine
FROM ''' + @InputFile + '''
WITH
(
FIRSTROW=' + CAST(@FirstLine as varchar) + ',
FIELDTERMINATOR = ''\n'',
ROWTERMINATOR = ''\n''
)'

-- run dynamic statement to populate temp table
EXEC(@sql)

-- get number of lines in table
SET @LINECOUNT = @@ROWCOUNT

-- add identity column to table so that we can loop through it
ALTER TABLE [#CSVLine] ADD [RowId] [int] IDENTITY(1,1) NOT NULL

IF @LINECOUNT > 0
BEGIN
    -- cycle through each line, cleaning each line
    SET @CURLINE = 1
    WHILE @CURLINE <= @LINECOUNT
    BEGIN
        -- get current line
        SELECT @line = line
          FROM #CSVLine
         WHERE [RowId] = @CURLINE

        -- Replace commas with our custom-made delimiter
        SET @Line = REPLACE(@Line, ',', @PH1)

        -- Find a quoted part of the line, which could legitimately contain commas.
        -- In that case we will need to identify the quoted section and swap commas back in for our custom placeholder.
        SET @starti = CHARINDEX(@PH1 + '"' ,@Line, 0)
        If CHARINDEX('"', @Line, 0) = 0 SET @starti = 0

        -- loop through quoted fields
        WHILE @starti > 0 
        BEGIN
            SET @FieldTerminatorFound = 0

            -- Find end quote token (originally  a ",)
            SET @endi = CHARINDEX('"' + @PH1, @Line, @starti)  -- sLine.IndexOf("""" & PH1, starti)

            IF @endi < 1
            BEGIN
                SET @FieldTerminatorFound = 1
                If @endi < 1 SET @endi = LEN(@Line) - 1
            END

            WHILE @FieldTerminatorFound = 0
            BEGIN
                -- Find any more quotes that are part of that sequence, if any
                SET @backChar = '"' -- thats one quote
                SET @quoteCount = 0

                WHILE @backChar = '"'
                BEGIN
                    SET @quoteCount = @quoteCount + 1
                    SET @backChar = SUBSTRING(@Line, @endi-@quoteCount, 1) -- sLine.Chars(endi - quoteCount)
                END

                IF (@quoteCount % 2) = 1
                BEGIN
                    -- odd number of quotes. real field terminator
                    SET @FieldTerminatorFound = 1
                END
                ELSE 
                BEGIN
                    -- keep looking
                    SET @endi = CHARINDEX('"' + @PH1, @Line, @endi + 1) -- sLine.IndexOf("""" & PH1, endi + 1)
                END

            END

            -- Grab the quoted field from the line, now that we have the start and ending indices
            SET @source = SUBSTRING(@Line, @starti + LEN(@PH1), @endi - @starti - LEN(@PH1) + 1) 
            -- sLine.Substring(starti + PH1.Length, endi - starti - PH1.Length + 1)

            -- And swap the commas back in
            SET @Line = REPLACE(@Line, @source, REPLACE(@source, @PH1, ','))
            --sLine.Replace(source, source.Replace(PH1, ","))

            -- Find the next quoted field
            -- If endi >= line.Length - 1 Then endi = line.Length 'During the swap, the length of line shrinks so an endi value at the end of the line will fail
            SET @starti = CHARINDEX(@PH1 + '"', @Line, @starti + LEN(@PH1))
            --sLine.IndexOf(PH1 & """", starti + PH1.Length)

        END

        -- get table based on current line
        IF OBJECT_ID('tempdb..#Line') IS NOT NULL
            DROP TABLE #Line

        -- converts a delimited list into a table
        SELECT *
        INTO #Line
        FROM dbo.iter_charlist_to_table(@Line,@PH1)

        -- get number of columns in line
        SET @COLCOUNT = @@ROWCOUNT

        -- dynamically create CSV temp table to hold CSV columns and lines
        -- only need to create once
        IF OBJECT_ID('tempdb..#CSV') IS NULL
        BEGIN
            -- create initial structure of CSV table
            CREATE TABLE [#CSV]([Col1] nvarchar(100))

            -- dynamically add a column for each column found in the first line
            SET @CURCOL = 1
            WHILE @CURCOL <= @COLCOUNT
            BEGIN
                -- first column already exists, don't need to add
                IF @CURCOL > 1 
                BEGIN
                    -- add field
                    SET @sql = 'ALTER TABLE [#CSV] ADD [Col' + Cast(@CURCOL as varchar) + '] nvarchar(100)'

                    --print @sql

                    -- this adds the fields to the temp table
                    EXEC(@sql)
                END

                -- go to next column
                SET @CURCOL = @CURCOL + 1
            END
        END

        -- build dynamic sql to insert current line into CSV table
        SET @sql = 'INSERT INTO [#CSV] VALUES('

        -- loop through line table, dynamically adding each column value
        SET @CURCOL = 1
        WHILE @CURCOL <= @COLCOUNT
        BEGIN
            -- get current column
            Select @ColVal = str 
              From #Line 
             Where listpos = @CURCOL

            IF LEN(@ColVal) > 0
            BEGIN
                -- remove quotes from beginning if exist
                IF LEFT(@ColVal,1) = '"'
                    SET @ColVal = RIGHT(@ColVal, LEN(@ColVal) - 1)

                -- remove quotes from end if exist
                IF RIGHT(@ColVal,1) = '"'
                    SET @ColVal = LEFT(@ColVal, LEN(@ColVal) - 1)
            END

            -- write column value
            -- make value sql safe by replacing single quotes with two single quotes
            -- also, replace two double quotes with a single double quote
            SET @sql = @sql + '''' + REPLACE(REPLACE(@ColVal, '''',''''''), '""', '"') + ''''

            -- add comma separater except for the last record
            IF @CURCOL <> @COLCOUNT
                SET @sql = @sql + ','

            -- go to next column
            SET @CURCOL = @CURCOL + 1
        END

        -- close sql statement
        SET @sql = @sql + ')'

        --print @sql

        -- run sql to add line to table
        EXEC(@sql)

        -- move to next line
        SET @CURLINE = @CURLINE + 1

    END

END

-- return CSV table
SELECT * FROM [#CSV]

END

GO 
```

存储过程利用这个帮助函数将字符串解析为表（感谢 Erland Sommarskog！）：

```
CREATE FUNCTION [dbo].[iter_charlist_to_table]
                (@list      ntext,
                 @delimiter nchar(1) = N',')
     RETURNS @tbl TABLE (listpos int IDENTITY(1, 1) NOT NULL,
                         str     varchar(4000),
                         nstr    nvarchar(2000)) AS

BEGIN
  DECLARE @pos      int,
          @textpos  int,
          @chunklen smallint,
          @tmpstr   nvarchar(4000),
          @leftover nvarchar(4000),
          @tmpval   nvarchar(4000)

  SET @textpos = 1
  SET @leftover = ''
  WHILE @textpos <= datalength(@list) / 2
  BEGIN
     SET @chunklen = 4000 - datalength(@leftover) / 2
     SET @tmpstr = @leftover + substring(@list, @textpos, @chunklen)
     SET @textpos = @textpos + @chunklen

     SET @pos = charindex(@delimiter, @tmpstr)

     WHILE @pos > 0
     BEGIN
        SET @tmpval = ltrim(rtrim(left(@tmpstr, @pos - 1)))
        INSERT @tbl (str, nstr) VALUES(@tmpval, @tmpval)
        SET @tmpstr = substring(@tmpstr, @pos + 1, len(@tmpstr))
        SET @pos = charindex(@delimiter, @tmpstr)
     END

     SET @leftover = @tmpstr
  END

  INSERT @tbl(str, nstr) VALUES (ltrim(rtrim(@leftover)), ltrim(rtrim(@leftover)))

RETURN

END 
```

这是我从 T-SQL 中调用它的方式。在这种情况下，我将结果插入到临时表中，因此我首先创建临时表：

```
 -- create temp table for file import
CREATE TABLE #temp
(
    CustomerCode nvarchar(100) NULL,
    Name nvarchar(100) NULL,
    [Address] nvarchar(100) NULL,
    City nvarchar(100) NULL,
    [State] nvarchar(100) NULL,
    Zip nvarchar(100) NULL,
    OrderNumber nvarchar(100) NULL,
    TimeWindow nvarchar(100) NULL,
    OrderType nvarchar(100) NULL,
    Duration nvarchar(100) NULL,
    [Weight] nvarchar(100) NULL,
    Volume nvarchar(100) NULL
)

-- convert the CSV file into a table
INSERT #temp
EXEC [dbo].[SSP_CSVToTable]
     @InputFile = @FileLocation
    ,@FirstLine = @FirstImportRow 
```

我没有对性能进行太多测试，但它可以很好地满足我的需要——导入少于 1000 行的 CSV 文件。但是，它可能会阻塞非常大的文件。

希望其他人也发现它有用。

干杯!

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2011-01-21T20:40:47.677

我还创建了一个函数来将 CSV 转换为批量插入的可用格式。我使用 Chris Clark 的已回答帖子作为创建以下 C# 函数的起点。  

我最终使用正则表达式来查找字段。然后我逐行重新创建文件，将其写入一个新文件，从而避免将整个文件加载到内存中。

```
private void CsvToOtherDelimiter(string CSVFile, System.Data.Linq.Mapping.MetaTable tbl)
{
    char PH1 = '|';
    StringBuilder ln;

    //Confirm file exists. Else, throw exception
    if (File.Exists(CSVFile))
    {
        using (TextReader tr = new StreamReader(CSVFile))
        {
            //Use a temp file to store our conversion
            using (TextWriter tw = new StreamWriter(CSVFile + ".tmp"))
            {
                string line = tr.ReadLine();
                //If we have already converted, no need to reconvert.
                //NOTE: We make the assumption here that the input header file 
                //      doesn't have a PH1 value unless it's already been converted.
                if (line.IndexOf(PH1) >= 0)
                {
                    tw.Close();
                    tr.Close();
                    File.Delete(CSVFile + ".tmp");
                    return;
                }
                //Loop through input file
                while (!string.IsNullOrEmpty(line))
                {
                    ln = new StringBuilder();

                    //1\. Use Regex expression to find comma separated values 
                    //using quotes as optional text qualifiers 
                    //(what MS EXCEL does when you import a csv file)
                    //2\. Remove text qualifier quotes from data
                    //3\. Replace any values of PH1 found in column data 
                    //with an equivalent character
                    //Regex:  \A[^,]*(?=,)|(?:[^",]*"[^"]*"[^",]*)+|[^",]*"[^"]*\Z|(?<=,)[^,]*(?=,)|(?<=,)[^,]*\Z|\A[^,]*\Z
                    List<string> fieldList = Regex.Matches(line, @"\A[^,]*(?=,)|(?:[^"",]*""[^""]*""[^"",]*)+|[^"",]*""[^""]*\Z|(?<=,)[^,]*(?=,)|(?<=,)[^,]*\Z|\A[^,]*\Z")
                            .Cast<Match>()
                            .Select(m => RemoveCSVQuotes(m.Value).Replace(PH1, '¦'))
                            .ToList<string>();

                    //Add the list of fields to ln, separated by PH1
                    fieldList.ToList().ForEach(m => ln.Append(m + PH1));

                    //Write to file. Don't include trailing PH1 value.
                    tw.WriteLine(ln.ToString().Substring(0, ln.ToString().LastIndexOf(PH1)));

                    line = tr.ReadLine();
                }

                tw.Close();
            }
            tr.Close();

            //Optional:  replace input file with output file
            File.Delete(CSVFile);
            File.Move(CSVFile + ".tmp", CSVFile);
        }
    }
    else
    {
        throw new ArgumentException(string.Format("Source file {0} not found", CSVFile));
    }
}
//The output file no longer needs quotes as a text qualifier, so remove them
private string RemoveCSVQuotes(string value)
{
    //if is empty string, then remove double quotes
    if (value == @"""""") value = "";
    //remove any double quotes, then any quotes on ends
    value = value.Replace(@"""""", @"""");
    if (value.Length >= 2)
        if (value.Substring(0, 1) == @"""")
            value = value.Substring(1, value.Length - 2);
    return value;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2013-11-22T11:25:32.857

通常，此问题是由用户将 Excel 文件导出为 CSV 引起的。

有两种方法可以解决这个问题：

1.  [根据 Microsoft 的建议](http://support.microsoft.com/kb/291296/en-us)，使用宏从 Excel 导出

2.  或者非常简单的方法：

    *   在 Excel 中打开 CSV。

    *   另存为 Excel 文件。（.xls 或 .xlsx）。

    *   [将该文件作为Excel 文件](https://i.stack.imgur.com/DIgnl.png)导入 SQL Server 。

    *   自己笑一笑，因为您不必像上面的解决方案那样编写任何代码...... muhahahaha

![导入为 Excel 文件](https://i.stack.imgur.com/DIgnl.png)

如果您真的想编写脚本，这里有一些[SQL （在将 CSV 保存为 Excel 之后）：](http://www.mssqltips.com/sqlservertip/1207/different-options-for-importing-data-into-sql-server/)

```
select * 
into SQLServerTable FROM OPENROWSET('Microsoft.Jet.OLEDB.4.0', 
    'Excel 8.0;Database=D:\testing.xls;HDR=YES', 
    'SELECT * FROM [Sheet1$]') 
```

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-09-28T14:37:25.373

这可能比您愿意使用的更复杂或更复杂，但是......

如果您可以在 VB 或 C# 中实现将行解析为字段的逻辑，则可以使用 CLR 表值函数 (TVF) 来执行此操作。

当您希望某些 C# 或 VB 代码将数据分成列和/或调整值时，CLR TVF 可能是一种从外部源读取数据的良好执行方式。

您必须愿意将 CLR 程序集添加到您的数据库（并且允许外部或不安全操作以便它可以打开文件）。这可能会有点复杂或涉及，但对于您获得的灵活性可能是值得的。

我有一些大文件需要尽可能快地定期加载到表中，但是需要对某些列执行某些代码转换，并且需要特殊处理来加载值，否则这些值会在普通批量插入时导致数据类型错误。

简而言之，CLR TVF 允许您对文件的每一行运行 C# 或 VB 代码，并具有类似批量插入的性能（尽管您可能需要担心日志记录）。SQL Server 文档中的示例允许您创建一个 TVF 以从您可以用作起点的事件日志中读取。

请注意，CLR TVF 中的代码只能在处理第一行之前的 init 阶段访问数据库（例如，每行不查找 - 您在此之上使用普通 TVF 来执行此类操作）。根据您的问题，您似乎不需要这个。

另请注意，每个 CLR TVF 都必须明确指定其输出列，因此您不能编写可用于您可能拥有的每个不同 csv 文件的通用列。

您可以编写一个 CLR TVF 从文件中读取整行，返回一列结果集，然后使用普通 TVF 从该文件中读取每种类型的文件。这要求代码解析每一行以用 T-SQL 编写，但避免了编写许多 CLR TVF。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2012-10-19T23:33:15.513

另一种方法——假设您没有大量字段或期望数据本身出现引号，则使用 REPLACE 函数。

```
UPDATE dbo.tablename 
        SET dbo.tablename.target_field = REPLACE(t.importedValue, '"', '')
FROM #tempTable t
WHERE dbo.tablename.target_id = t.importedID; 
```

我已经用过了。我不能对性能提出任何要求。这只是解决问题的一种快速而肮脏的方法。

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2018-12-11T15:32:08.803

需要预处理。

PowerShell 函数 Import-CSV 支持这种类型的文件。然后，Export-CSV 会将每个值封装在引号中。

单个文件：

```
Import-Csv import.csv | Export-Csv -NoTypeInformation export.csv 
```

合并多个路径为 C:\year\input_date.csv 的文件：

```
$inputPath = 'C:\????\input_????????.csv'
$outputPath = 'C:\merged.csv'
Get-ChildItem $inputPath |
  Select -ExpandProperty FullName |
  Import-CSV |
  Export-CSV -NoTypeInformation -Path $outputPath 
```

PowerShell 通常可以使用 PowerShell 代理帐户与 SQL Server 代理一起运行。

如果分隔符处理不当，请明确指定另一个分隔符。

```
 Export-CSV -NoTypeInformation -Delimiter ';' -Path $outputPath 
```

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T15:50:53.467

您不仅应该能够指定字段分隔符（应该是 [,]），还应该能够指定文本限定符，在这种情况下应该是 ["]。使用 [] 将其括起来，这样就不会与 " 混淆。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2010-05-19T06:20:59.450

克里斯，非常感谢！你救了我的饼干！！当 XL 做得这么好时，我无法相信散装装载机不会处理这种情况..这些家伙不是在大厅里看到彼此吗？无论如何...我需要一个 ConsoleApplication 版本，所以这就是我一起破解的。它又脏又脏，但它就像一个冠军！我对分隔符进行了硬编码并注释掉了标题，因为我的应用程序不需要它们。

我希望我也可以在这里为你贴上一杯好喝的啤酒。

天哪，我不知道为什么 End Module 和 Public Class 在代码块之外……srry！

```
 Module Module1

    Sub Main()

        Dim arrArgs() As String = Command.Split(",")
        Dim i As Integer
        Dim obj As New ReDelimIt()

        Console.Write(vbNewLine & vbNewLine)

        If arrArgs(0) <> Nothing Then
            For i = LBound(arrArgs) To UBound(arrArgs)
                Console.Write("Parameter " & i & " is " & arrArgs(i) & vbNewLine)
            Next

            obj.ProcessFile(arrArgs(0), arrArgs(1))

        Else
            Console.Write("Usage Test1 <inputfile>,<outputfile>")
        End If

        Console.Write(vbNewLine & vbNewLine)
    End Sub

 End Module

 Public Class ReDelimIt

    Public Function ProcessFile(ByVal InputFile As String, ByVal OutputFile As String) As Integer

        Dim ph1 As String = "|"

        Dim objReader As System.IO.StreamReader = Nothing
        Dim count As Integer = 0 'This will also serve as a primary key
        Dim sb As New System.Text.StringBuilder

        Try
            objReader = New System.IO.StreamReader(System.IO.File.OpenRead(InputFile), System.Text.Encoding.Default)
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try

        If objReader Is Nothing Then
            MsgBox("Invalid file: " & InputFile)
            count = -1
            Exit Function
        End If

        'grab the first line
        Dim line = objReader.ReadLine()
        'and advance to the next line b/c the first line is column headings
        'Removed Check Headers can put in if needed.
        'If chkHeaders.Checked Then
        'line = objReader.ReadLine
        'End If

        While Not String.IsNullOrEmpty(line) 'loop through each line

            count += 1

            'Replace commas with our custom-made delimiter
            line = line.Replace(",", ph1)

            'Find a quoted part of the line, which could legitimately contain commas.
            'In that case we will need to identify the quoted section and swap commas back in for our custom placeholder.
            Dim starti = line.IndexOf(ph1 & """", 0)

            While starti > -1 'loop through quoted fields

                'Find end quote token (originally  a ",)
                Dim endi = line.IndexOf("""" & ph1, starti)

                'The end quote token could be a false positive because there could occur a ", sequence.
                'It would be double-quoted ("",) so check for that here
                Dim check1 = line.IndexOf("""""" & ph1, starti)

                'A """, sequence can occur if a quoted field ends in a quote.
                'In this case, the above check matches, but we actually SHOULD process this as an end quote token
                Dim check2 = line.IndexOf("""""""" & ph1, starti)

                'If we are in the check1 ("",) situation, keep searching for an end quote token
                'The +1 and +2 accounts for the extra length of the checked sequences
                While (endi = check1 + 1 AndAlso endi <> check2 + 2) 'loop through "false" tokens in the quoted fields
                    endi = line.IndexOf("""" & ph1, endi + 1)
                    check1 = line.IndexOf("""""" & ph1, check1 + 1)
                    check2 = line.IndexOf("""""""" & ph1, check2 + 1)
                End While

                'We have searched for an end token (",) but can't find one, so that means the line ends in a "
                If endi < 0 Then endi = line.Length - 1

                'Grab the quoted field from the line, now that we have the start and ending indices
                Dim source = line.Substring(starti + ph1.Length, endi - starti - ph1.Length + 1)

                'And swap the commas back in
                line = line.Replace(source, source.Replace(ph1, ","))

                'Find the next quoted field
                If endi >= line.Length - 1 Then endi = line.Length 'During the swap, the length of line shrinks so an endi value at the end of the line will fail
                starti = line.IndexOf(ph1 & """", starti + ph1.Length)

            End While

            'Add our primary key to the line
            ' Removed for now
            'If chkAddKey.Checked Then
            'line = String.Concat(count.ToString, ph1, line)
            ' End If

            sb.AppendLine(line)

            line = objReader.ReadLine

        End While

        objReader.Close()

        SaveTextToFile(sb.ToString, OutputFile)

        Return count

    End Function

    Public Function SaveTextToFile(ByVal strData As String, ByVal FullPath As String) As Boolean
        Dim bAns As Boolean = False
        Dim objReader As System.IO.StreamWriter
        Try
            objReader = New System.IO.StreamWriter(FullPath, False, System.Text.Encoding.Default)
            objReader.Write(strData)
            objReader.Close()
            bAns = True
        Catch Ex As Exception
            Throw Ex
        End Try
        Return bAns
    End Function

End Class 
```

* * *

## 回答 #11

> 赞同：1
> 
>             
> 
> 时间：2010-11-12T08:13:18.910

我在我们的领域中使用“，”时发现了一些问题，例如 Mike，“456 2nd St, Apt 5”。

这个问题的解决方法是@http [://crazzycoding.blogspot.com/2010/11/import-csv-file-into-sql-server-using.html](http://crazzycoding.blogspot.com/2010/11/import-csv-file-into-sql-server-using.html)

谢谢， - 阿什

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2014-05-31T05:25:23.680

这段代码对我有用：

```
 public bool CSVFileRead(string fullPathWithFileName, string fileNameModified, string tableName)
    {
        SqlConnection con = new SqlConnection(ConfigurationSettings.AppSettings["dbConnectionString"]);
        string filepath = fullPathWithFileName;
        StreamReader sr = new StreamReader(filepath);
        string line = sr.ReadLine();
        string[] value = line.Split(',');
        DataTable dt = new DataTable();
        DataRow row;
        foreach (string dc in value)
        {
            dt.Columns.Add(new DataColumn(dc));
        }
        while (!sr.EndOfStream)
        {
            //string[] stud = sr.ReadLine().Split(',');
            //for (int i = 0; i < stud.Length; i++)
            //{
            //    stud[i] = stud[i].Replace("\"", "");
            //}
            //value = stud;
            value = sr.ReadLine().Split(',');
            if (value.Length == dt.Columns.Count)
            {
                row = dt.NewRow();
                row.ItemArray = value;
                dt.Rows.Add(row);
            }
        }
        SqlBulkCopy bc = new SqlBulkCopy(con.ConnectionString, SqlBulkCopyOptions.TableLock);
        bc.DestinationTableName = tableName;
        bc.BatchSize = dt.Rows.Count;
        con.Open();
        bc.WriteToServer(dt);
        bc.Close();
        con.Close();

        return true;
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2019-07-24T06:43:55.357

您不需要在 SQL 之外对文件进行预处理。

对我有用的是改变

ROWTERMINATOR = '\n'

至

ROWTERMINATOR = '0x0a'。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2019-08-15T19:14:29.440

SQL 2017 中添加了一个新选项来指定`WITH ( FORMAT='CSV')`命令`BULK INSERT`。

[来自Microsoft GitHub 页面](https://github.com/microsoft/sql-server-samples/blob/master/samples/features/sql-bulk-load/load-from-azure-blob-storage/LoadFromAzureBlobStorage.sql)的示例：

```
BULK INSERT Product
FROM 'product.csv'
WITH (  DATA_SOURCE = 'MyAzureBlobStorage',
        FORMAT='CSV', CODEPAGE = 65001, --UTF-8 encoding
        FIRSTROW=2,
        ROWTERMINATOR = '0x0a',
        TABLOCK); 
```

该选项的详细文档可在此处获得：
 [https ://docs.microsoft.com/en-us/sql/t-sql/statements/bulk-insert-transact-sql?view=sql-server-2017#input-file -格式选项](https://docs.microsoft.com/en-us/sql/t-sql/statements/bulk-insert-transact-sql?view=sql-server-2017#input-file-format-options)

我已经成功地将此选项与包含可选引号的 CSV 数据一起使用，就像 OP 给出的示例一样。

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2016-12-13T21:20:36.420

我将以下内容放在一起来解决我的问题。我需要预处理非常大的文件并整理出不一致的引用。只需将其粘贴到一个空白的 C# 应用程序中，将 const 设置为您的要求，然后就可以了。这适用于超过 10 GB 的非常大的 CSV。

```
namespace CsvFixer
{
    using System.IO;
    using System.Text;

    public class Program
    {
        private const string delimiter = ",";
        private const string quote = "\"";
        private const string inputFile = "C:\\temp\\input.csv";
        private const string fixedFile = "C:\\temp\\fixed.csv";

        /// <summary>
        /// This application fixes inconsistently quoted csv (or delimited) files with support for very large file sizes.
        /// For example :  1223,5235234,8674,"Houston","London, UK",3425,Other text,stuff 
        /// Must become :  "1223","5235234","8674","Houston","London, UK","3425","Other text","stuff" 
        /// </summary>
        /// <param name="args"></param>
        static void Main(string[] args)
        {
            // Use streaming to allow for large files. 
            using (StreamWriter outfile = new StreamWriter(fixedFile))
            {
                using (FileStream fs = File.Open(inputFile, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
                using (BufferedStream bs = new BufferedStream(fs))
                using (StreamReader sr = new StreamReader(bs))
                {
                    string currentLine;

                    // Read each input line in and write each fixed line out
                    while ((currentLine = sr.ReadLine()) != null)
                    {
                        outfile.WriteLine(FixLine(currentLine, delimiter, quote));
                    }
                }
            }
        }

        /// <summary>
        /// Fully quote a partially quoted line 
        /// </summary>
        /// <param name="line">The partially quoted line</param>
        /// <returns>The fully quoted line</returns>
        private static string FixLine(string line, string delimiter, string quote)
        {
            StringBuilder fixedLine = new StringBuilder();

            // Split all on the delimiter, acceptinmg that some quoted fields 
            // that contain the delimiter wwill be split in to many pieces.
            string[] fieldParts = line.Split(delimiter.ToCharArray());

            // Loop through the fields (or parts of fields)
            for (int i = 0; i < fieldParts.Length; i++)
            {
                string currentFieldPart = fieldParts[i];

                // If the current field part starts and ends with a quote it is a field, so write it to the result
                if (currentFieldPart.StartsWith(quote) && currentFieldPart.EndsWith(quote))
                {
                    fixedLine.Append(string.Format("{0}{1}", currentFieldPart, delimiter));
                }
                // else if it starts with a quote but doesnt end with one, it is part of a lionger field.
                else if (currentFieldPart.StartsWith(quote))
                {
                    // Add the start of the field
                    fixedLine.Append(string.Format("{0}{1}", currentFieldPart, delimiter));

                    // Append any additional field parts (we will only hit the end of the field when 
                    // the last field part finishes with a quote. 
                    while (!fieldParts[++i].EndsWith(quote))
                    {
                        fixedLine.Append(string.Format("{0}{1}", fieldParts[i], delimiter));
                    }

                    // Append the last field part - i.e. the part containing the closing quote
                    fixedLine.Append(string.Format("{0}{1}", fieldParts[i], delimiter));
                }
                else
                {
                    // The field has no quotes, add the feildpart with quote as bookmarks 
                    fixedLine.Append(string.Format("{0}{1}{0}{2}", quote, currentFieldPart, delimiter));
                }
            }

            // Return the fixed string 
            return fixedLine.ToString();
        }
    }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2018-04-06T15:54:40.717

从实践中说...在 SQL Server 2017 中，您可以提供双引号的“文本限定符”，它不会“取代”您的分隔符。我批量插入几个文件，看起来就像 OP 的示例一样。我的文件是“.csv”，它们的文本限定符不一致，只有在值包含逗号时才能找到。我不知道这个特性/功能开始工作的 SQL Server 版本，但我知道它在 SQL Server 2017 Standard 中工作。相当容易。

* * *

## 回答 #17

> 赞同：-1
> 
>             
> 
> 时间：2013-10-28T21:33:14.597

创建一个 VB.NET 程序以使用 4.5 Framework TextFieldParser 转换为新的分隔符 这将自动处理文本限定字段

修改上面的代码以使用内置的 TextFieldParser

模块模块1

```
Sub Main()

    Dim arrArgs() As String = Command.Split(",")
    Dim i As Integer
    Dim obj As New ReDelimIt()
    Dim InputFile As String = ""
    Dim OutPutFile As String = ""
    Dim NewDelimiter As String = ""

    Console.Write(vbNewLine & vbNewLine)

    If Not IsNothing(arrArgs(0)) Then
        For i = LBound(arrArgs) To UBound(arrArgs)
            Console.Write("Parameter " & i & " is " & arrArgs(i) & vbNewLine)
        Next
        InputFile = arrArgs(0)
        If Not IsNothing(arrArgs(1)) Then
            If Not String.IsNullOrEmpty(arrArgs(1)) Then
                OutPutFile = arrArgs(1)
            Else
                OutPutFile = InputFile.Replace("csv", "pipe")
            End If
        Else
            OutPutFile = InputFile.Replace("csv", "pipe")
        End If
        If Not IsNothing(arrArgs(2)) Then
            If Not String.IsNullOrEmpty(arrArgs(2)) Then
                NewDelimiter = arrArgs(2)
            Else
                NewDelimiter = "|"
            End If
        Else
            NewDelimiter = "|"
        End If
        obj.ConvertCSVFile(InputFile,OutPutFile,NewDelimiter)

    Else
        Console.Write("Usage ChangeFileDelimiter <inputfile>,<outputfile>,<NewDelimiter>")
    End If
    obj = Nothing
    Console.Write(vbNewLine & vbNewLine)
    'Console.ReadLine()

End Sub 
```

端模块

公共类重新定界

```
Public Function ConvertCSVFile(ByVal InputFile As String, ByVal OutputFile As String, Optional ByVal NewDelimiter As String = "|") As Integer
    Using MyReader As New Microsoft.VisualBasic.FileIO.TextFieldParser(InputFile)
        MyReader.TextFieldType = FileIO.FieldType.Delimited
        MyReader.SetDelimiters(",")
        Dim sb As New System.Text.StringBuilder
        Dim strLine As String = ""
        Dim currentRow As String()
        While Not MyReader.EndOfData
            Try
                currentRow = MyReader.ReadFields()
                Dim currentField As String
                strLine = ""
                For Each currentField In currentRow
                    'MsgBox(currentField)
                    If strLine = "" Then
                        strLine = strLine & currentField
                    Else
                        strLine = strLine & NewDelimiter & currentField
                    End If
                Next
                sb.AppendLine(strLine)
            Catch ex As Microsoft.VisualBasic.FileIO.MalformedLineException
                'MsgBox("Line " & ex.Message & "is not valid and will be skipped.")
                Console.WriteLine("Line " & ex.Message & "is not valid and will be skipped.")
            End Try
        End While
        SaveTextToFile(sb.ToString, OutputFile)
    End Using

    Return Err.Number

End Function

Public Function SaveTextToFile(ByVal strData As String, ByVal FullPath As String) As Boolean
    Dim bAns As Boolean = False
    Dim objReader As System.IO.StreamWriter
    Try
        If FileIO.FileSystem.FileExists(FullPath) Then
            Kill(FullPath)
        End If
        objReader = New System.IO.StreamWriter(FullPath, False, System.Text.Encoding.Default)
        objReader.Write(strData)
        objReader.Close()
        bAns = True
    Catch Ex As Exception
        Throw Ex
    End Try
    Return bAns
End Function 
```

结束类

# asp.net - Asp.net Webform 显示警报和重定向

> ID：782354
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-04-23T15:47:56.283
> 
>         
> 
> 标签：asp.net, javascript, redirect, alert

我目前被卡住了。我有一个带有注册或保存记录的按钮的网络表单。我想要的是让它显示一个 javascript 警报，然后重定向到一个页面。这是我正在使用的代码

```
protected void Save(..)
{   
    // Do save stuff
    DisplayAlert("The changes were saved Successfully");
    Response.Redirect("Default.aspx");
} 
```

此代码只是重定向而不给出提示已成功保存。

这是我的 DisplayAlert 代码

```
 protected virtual void DisplayAlert(string message)
    {
        ClientScript.RegisterStartupScript(
                        this.GetType(),
                        Guid.NewGuid().ToString(),
                        string.Format("alert('{0}');", message.Replace("'", @"\'").Replace("\n", "\\n").Replace("\r", "\\r")),
                        true
                    );
    } 
```

谁能帮我找到解决方案？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-04-23T15:51:44.603

您不能执行 Response.Redirect，因为您的 javascript 警报将永远不会显示。最好让您的 javascript 代码`windows.location.href='default.aspx'`在显示警报后实际执行重定向。像这样的东西：

```
protected virtual void DisplayAlert(string message)
{
    ClientScript.RegisterStartupScript(
      this.GetType(),
      Guid.NewGuid().ToString(),
      string.Format("alert('{0}');window.location.href = 'default.aspx'", 
        message.Replace("'", @"\'").Replace("\n", "\\n").Replace("\r", "\\r")),
        true);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-04-24T08:34:26.627

DisplayAlert 方法将客户端脚本添加到当前正在执行的页面请求中。当您调用 Response.Redirect 时，ASP.NET 会向浏览器发出 HTTP 301 重定向，因此会启动一个新的页面请求，其中注册的客户端脚本不再存在。

由于您的代码在服务器端执行，因此无法在客户端显示警报并执行重定向。

此外，显示 JavaScript 警告框可能会混淆用户的心理工作流程，内联消息会更可取。也许您可以将消息添加到 Session 并在 Default.aspx 页面请求中显示它。

```
protected void Save(..)
{   
    // Do save stuff
    Session["StatusMessage"] = "The changes were saved Successfully";
    Response.Redirect("Default.aspx");
} 
```

然后在 Default.aspx.cs 代码后面（或一个通用的基页类，因此这可以发生在任何页面，甚至母版页上）：

```
protected void Page_Load(object sender, EventArgs e)
{
    if(!string.IsNullOrEmpty((string)Session["StatusMessage"]))
    {
        string message = (string)Session["StatusMessage"];
        // Clear the session variable
        Session["StatusMessage"] = null;
        // Enable some control to display the message (control is likely on the master page)
        Label messageLabel = (Label)FindControl("MessageLabel");
        messageLabel.Visible = true;
        messageLabel.Text = message;
    }
} 
```

该代码未经测试，但应为您指明正确的方向

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2012-02-08T10:07:01.210

这很完美：

```
string url = "home.aspx";
ClientScript.RegisterStartupScript(this.GetType(), "callfunction", "alert('Saved Sucessfully.');window.location.href = '" + url + "';",true); 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-11-19T22:15:09.267

```
protected void Save(..)
{       
    // Do save stuff    
    ShowMessageBox();  
} 

private void ShowMessageBox()
{        
    string sJavaScript = "<script language=javascript>\n";        
    sJavaScript += "var agree;\n";        
    sJavaScript += "agree = confirm('Do you want to continue?.');\n";        
    sJavaScript += "if(agree)\n";        
    sJavaScript += "window.location = \"http://google.com\";\n";        
    sJavaScript += "</script>";      
    Response.Write(sJavaScript);
} 
```

# c# - sqldatasource.select 在显式选择调用中不考虑FilterExpression？

> ID：782356
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T15:49:39.180
> 
>         
> 
> 标签：c#, asp.net, sql-server

呸！无法理解这里发生了什么。

在 SqlDataSource1 上使用时正确应用过滤器，以正确填充相应的网格视图。

话虽这么说，过滤不适用于我用来获取 DataView 的手动选择，用于数据库插入部分。

我究竟做错了什么？有什么我不知道的事情吗？

```
SqlDataSource1.FilterExpression = (string)ViewState["filtre"];

    cmdApply.Text = (string)ViewState["filtre"];

    DataView thingie =     (DataView)SqlDataSource1.Select(DataSourceSelectArguments.Empty);

    thingie.RowFilter = (string)ViewState["filtre"];

    DataView verifdv =     (DataView)SqlDataSource2.Select(DataSourceSelectArguments.Empty);

    verifdv.Sort = "filterClient";

    SqlConnection dbconn = new SqlConnection(SqlDataSource1.ConnectionString);        

    foreach ( DataRow dr in thingie.Table.Rows ) {

        if ( verifdv.Find(dr["orgID"]) == -1 ) {

        SqlCommand addFilter = new SqlCommand("INSERT INTO dbo.usermetafilter     (filterUser, filterClient) VALUES (@user, @client)", dbconn);

                addFilter.Parameters.Add("@user", SqlDbType.NVarChar).Value = "dummyvalue";

                addFilter.Parameters.Add("@client", SqlDbType.Int).Value = dr["orgID"];

                addFilter.Connection.Open();

                addFilter.ExecuteNonQuery();

                addFilter.Connection.Close();

            }

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T15:56:29.647

没关系。正确的代码应该是：

```
foreach ( DataRow dr in thingie.Table.Select((string)ViewState["filtre"]; 
```

) ) {

数据源的 Select 方法不使用 DS 的 FilterExpression 属性中的过滤器。它得到了整个事情。另一方面，DataView.Table.Select(String FilterExpression) 返回其所有行的数组，已过滤。太酷了，我解决了我自己的问题。

# python - Emacs 函数向我所在的 python 函数发送消息

> ID：782357
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-04-23T15:50:22.610
> 
>         
> 
> 标签：python, emacs, elisp

我正在编辑一些具有相当长函数的 Python 代码，并认为无需向上滚动即可快速获取函数名称会很有用。我把这段代码放在一起来做。一般来说，emacs 中是否有一些内置的东西，或者特别是标准的 python 模式，我可以使用它来代替？

```
(defun python-show-function-name()
  "Message the name of the function the point is in"
  (interactive)
  (save-excursion
    (beginning-of-defun)
    (message (format "%s" (thing-at-point 'line))))) 
```

* * *

## 回答 #1

> 赞同：21
> 
>             
> 
> 时间：2009-04-23T16:01:39.197

[您可能会使用which-function-mode](http://www.gnu.org/software/emacs/manual/html_node/emacs/Which-Function.html)找到不错的结果：

> 哪个函数模式是次要模式，它在模式行中显示当前函数名称，并在您在缓冲区中移动时更新它。
> 
>   
>   
> 
> 要启用或禁用哪个功能模式，请使用命令 Mx which-function-mode。这个命令是全局的；它适用于所有缓冲区，包括现有缓冲区和尚未创建的缓冲区。但是，它只在某些主要模式下生效，这些模式在 which-func-modes 的值中列出。如果值为 t，那么 Which Function 模式适用于所有知道如何支持它的主要模式——换句话说，所有支持 Imenu 的主要模式。

虽然我看到它在我在这里拥有的一个 Python 文件中有点困惑......

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:09:00.960

你试过了`py-beginning-of-def-or-class`吗？

```
(defun python-show-function-name()
  "Message the name of the function the point is in"
  (interactive)
  (save-excursion
    (py-beginning-of-def-or-class)
    (message (format "%s" (thing-at-point 'line))))) 
```

我发现它给了我比你更好的结果`beginning-of-defun`，但如果这不是你遇到的问题，那么也许我只是在[我的另一个答案](https://stackoverflow.com/questions/782357/emacs-function-to-message-the-python-function-im-in/782413#782413)中看到了另一个不稳定原因的症状。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:00:53.850

Cc Cu (py-goto-block-up) 可能是你想要的。

# .net - 我可以在让用户等待之前更新 WPF 状态栏文本吗？

> ID：782359
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-23T15:50:26.947
> 
>         
> 
> 标签：.net, wpf, multithreading, backgroundworker, statusbar

我有一个带有状态栏的 WPF 应用程序。

```
<StatusBar Grid.Row="1"
           Height="23"
           Name="StatusBar1"
           VerticalAlignment="Bottom">
    <TextBlock Name="TextBlockStatus" />
</StatusBar> 
```

当我做少量工作时，我想在那里显示文本并切换到沙漏等待光标。

此代码将更新光标，但状态栏**文本不会更新**...

```
Cursor = Cursors.Wait
TextBlockStatus.Text = "Loading..."
System.Threading.Thread.Sleep(New TimeSpan(0, 0, 3))
TextBlockStatus.Text = String.Empty
Cursor = Cursors.Arrow 
```

* * *

## 更新

受[亚历山德拉](https://stackoverflow.com/users/77255/alexandra)[回答](https://stackoverflow.com/questions/782359/can-i-update-wpf-statusbar-text-before-making-the-user-wait/782429#782429)的启发...

**如果我这样做，它会起作用**，但我对这个解决方案一点也不满意。有没有更简单的方法？

```
Delegate Sub Load1()
Sub Load2()
    System.Threading.Thread.Sleep(New TimeSpan(0, 0, 3))
End Sub
Dim Load3 As Load1 = AddressOf Load2

Sub Load()
    Cursor = Cursors.Wait
    TextBlockStatus.Text = "Loading..."
    Dispatcher.Invoke(DispatcherPriority.Background, Load3)
    TextBlockStatus.Text = String.Empty
    Cursor = Cursors.Arrow
End Sub 
```

我宁愿它看起来像这样......

```
Sub Load()
    Cursor = Cursors.Wait
    TextBlockStatus.Text = "Loading..."

    'somehow put all the Dispatcher, Invoke, Delegate,
     AddressOf, and method definition stuff here'

    TextBlockStatus.Text = String.Empty
    Cursor = Cursors.Arrow
End Sub 
```

或者甚至更好...

```
Sub Load()
    Cursor = Cursors.Wait
    ForceStatus("Loading...")
    System.Threading.Thread.Sleep(New TimeSpan(0, 0, 3))
    ForceStatus(String.Empty)
    Cursor = Cursors.Arrow
End Sub

Sub ForceStatus(ByVal Text As String)
    TextBlockStatus.Text = Text
    'perform magic'
End Sub 
```

* * *

## 更新

我还尝试将 TextBlock 绑定到公共属性并按照[IanGilham 的](https://stackoverflow.com/users/94159/iangilham)[建议实施](https://stackoverflow.com/questions/782359/can-i-update-wpf-statusbar-text-before-making-the-user-wait/782946#782946)[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/ms743695.aspx)。这**不起作用**。 

 **XAML：

```
<TextBlock Text="{Binding Path=StatusText}"/> 
```

视觉基础：

```
Imports System.ComponentModel
Partial Public Class Window1
    Implements INotifyPropertyChanged

    Private _StatusText As String = String.Empty
    Public Event PropertyChanged As PropertyChangedEventHandler Implements INotifyPropertyChanged.PropertyChanged

    Property StatusText() As String
        Get
            Return _StatusText
        End Get
        Set(ByVal value As String)
            _StatusText = value
            OnPropertyChanged("StatusText")
        End Set
    End Property

    Shadows Sub OnPropertyChanged(ByVal name As String)
        RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(name))
    End Sub
    ...

    Sub Load()
        ...
        Cursor = Cursors.Wait
        StatusText = "Loading..."
        System.Threading.Thread.Sleep(New TimeSpan(0, 0, 3))
        StatusText = String.Empty
        Cursor = Cursors.Arrow
        ...
    End Sub
... 
```

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-04-23T17:53:58.243

您应该使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/8xs8549b.aspx)。这项工作将在一个单独的线程中进行，这意味着您的 UI 线程将是免费的，您的应用程序仍将是响应式的。

它不会是一个非常紧凑的代码解决方案，但它对您的用户来说是最强大和最友好的。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:05:18.673

您可以轻松调用

```
TextBlockStatus.UpdateLayout(); 
```

在您更改应该刷新控件并更改屏幕上的文本的 Text 属性之后。

我也用

```
this.Dispatcher.BeginInvoke(DispatcherPriority.Background, new Action(delegate {
    /* your code here */
})); 
```

（尝试）确保我的任务在刷新完成后运行。

我不得不承认，它在大约 90% - 95% 的时间里都可以工作（有时文本只有在任务完成后才会更改，或者会稍有延迟），但我找不到更好的东西。

编辑问题的编辑：

我不是 VB 方面的专家，但如果它不支持匿名内联方法，那么您的第二种方法应该可行。`UpdateLayout()`在调用调度程序之前尝试调用

```
Cursor = Cursors.Wait
TextBlockStatus.Text = "Loading..."
TextBlockStatus.UpdateLayout(); //include the update before calling dispatcher
Dispatcher.Invoke(DispatcherPriority.Background, Load3)
TextBlockStatus.Text = String.Empty
Cursor = Cursors.Arrow 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-24T13:10:21.113

用户[Ray](https://stackoverflow.com/users/233/ray)在另一个问题中提交了[解决此问题的答案](https://stackoverflow.com/questions/783649/is-there-no-simple-way-to-set-wpf-statusbar-text/783695#783695)。[他的回答](https://stackoverflow.com/questions/616629/display-wait-screen-in-wpf/616676#616676)基于[Shaun Bowe](https://stackoverflow.com/users/1514/shaun-bowe)在第三个问题中的回答。

这是我的实现...

```
Sub UpdateStatus(ByVal Message As String)
    If Message = String.Empty Then
        Cursor = Cursors.Arrow
    Else
        Cursor = Cursors.Wait
    End If
    TextBlockStatus.Text = Message
    AllowUIToUpdate()
End Sub

Public Sub AllowUIToUpdate()
    Dim frame As New DispatcherFrame()
    Dispatcher.CurrentDispatcher.BeginInvoke(DispatcherPriority.Render, New DispatcherOperationCallback(AddressOf JunkMethod), frame)
    Dispatcher.PushFrame(frame)
End Sub

Private Function JunkMethod(ByVal arg As Object) As Object
    DirectCast(arg, DispatcherFrame).Continue = False
    Return Nothing
End Function 
```

[根据IanGilham](https://stackoverflow.com/users/94159/iangilham)的[建议](https://stackoverflow.com/questions/782359/can-i-update-wpf-statusbar-text-before-making-the-user-wait/782946#782946)，将它与 XAML 绑定和 INotifyPropertyChanged 结合起来可能会更好。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2010-06-08T15:26:35.667

这是我的代码（状态是带有 x:Name="Status" 的 WPF 文本块）

（它是 c# 但我认为它应该可以移植到 VB...）

```
 private void Button_Click(object sender, RoutedEventArgs e) {
        var bw = new BackgroundWorker();
        bw.DoWork += DoSomething;
        bw.RunWorkerAsync();
    }

    private void DoSomething(object sender, DoWorkEventArgs args) {
        UpdateStatus("Doing Something...");

        ...

        UpdateStatus("Done...");
    }

    private void UpdateStatus(string text) {
        Status.Dispatcher.BeginInvoke(DispatcherPriority.Background, new Action(() => SetStatus(text)));
    }

    private void SetStatus(string text) {
        Status.Text = text;
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2012-02-21T11:38:52.423

这很好用。但请注意 :DispatcherPriority.Render"

```
private static Action EmptyDelegate = delegate() { };
public void RefreshUI(UIElement uiElement)
{
    uiElement.Dispatcher.Invoke(DispatcherPriority.Render, EmptyDelegate);
}
public string StatusBarString
{
    set 
    { 
        statusBar.Content = _satusBarString;
        RefreshUI(statusBar);
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2010-08-26T19:35:26.647

你试过这样吗？

```
TextBlockStatus.Dispatcher.Invoke(DispatcherPriority.Loaded, new Action(() => { TextBlockStatus.Text = message; })); 
```

我遇到了同样的问题，出于某种原因，使用 DispatcherPriority.Loaded 对我有用。此外，不需要 UpdateLayout。

我希望它也对你有用，干杯，

安德烈

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:28:02.763

我将创建一个**公共**属性来保存文本字段并实现[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/ms743695.aspx)。您可以轻松地将 TextBlock[绑定](http://msdn.microsoft.com/en-us/library/ms750612.aspx)到 xaml 文件中的属性。

```
<TextBlock Text="{Binding Path=StatusText}"/> 
```

然后，您只需更改属性，UI 将始终是最新的。

在我目前的工作项目中，代表 Window 的类只包含方法处理程序，它们调用 ViewModel/Presenter 类的公共接口。ViewModel 包含 UI 需要绑定的任何内容，并通过将作业添加到 ThreadPool 来启动任何和所有功能。

当然，我目前所有的项目都涉及批处理，所以让 ThreadPool 处理并发问题对我来说是有意义的。

**更新：**您能否再次尝试使用属性方法，但要确保该属性是公开的。根据[此页面](http://msdn.microsoft.com/en-us/magazine/cc163299.aspx)，您只能绑定到公共属性。

```
Imports System.ComponentModel
Partial Public Class Window1
    Implements INotifyPropertyChanged

    Private _StatusText As String = String.Empty
    Public Event PropertyChanged As PropertyChangedEventHandler Implements INotifyPropertyChanged.PropertyChanged

    // I think the property has to be public for binding to work
    Public Property StatusText() As String
        Get
            Return _StatusText
        End Get
        Set(ByVal value As String)
            _StatusText = value
            OnPropertyChanged("StatusText")
        End Set
    End Property

    Shadows Sub OnPropertyChanged(ByVal name As String)
        RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(name))
    End Sub
    ...

    Sub Load()
        ...
        Cursor = Cursors.Wait
        StatusText = "Loading..."
        System.Threading.Thread.Sleep(New TimeSpan(0, 0, 3))
        StatusText = String.Empty
        Cursor = Cursors.Arrow
        ...
    End Sub 
```

...

# flash - BitmapData.draw 函数使用的缩放函数？

> ID：782363
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T15:51:24.700
> 
>         
> 
> 标签：flash, actionscript-3, scaling

[BitmapData.draw](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/BitmapData.html#draw())函数使用哪些缩放函数来进行平滑和非平滑绘制？

（像[clevrlib](http://www.clevr.com/blog/2008/resize-actionscript-bicubic-bilinear-interpolation)这样的库允许双线性和双三次采样，这表明 Flash 本身也不是这样做的。）

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2010-10-12T20:58:31.127

根据 Todd Yard 的 Foundation ActionScript 3.0 Image Effects（第 155 页）

“...smooth 参数决定了缩放后的图像是否在缩放时进行平滑处理。基本上，默认值 false 将对像素执行最近邻算法，这会导致可见像素化。一个值为真将导致应用双线性算法，该算法根据多个周围像素的平均值计算新的像素值。”

# input - 十六进制小键盘

> ID：782372
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-04-23T15:53:41.493
> 
>         
> 
> 标签：input, keyboard, hex

我目前正在进行的项目需要在代码中输入大量十六进制数字。

我曾经看到一张旧键盘的照片，上面有一个十六进制小键盘（上面也有 AF 字母）取代了普通的小键盘。有谁知道我在哪里可以买到其中之一？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2013-10-09T09:39:55.223

IPv6 Buddy -keypad 应该适用于十六进制输入。

[http://www.ipv6buddy.com/](http://www.ipv6buddy.com/)

![在此处输入图像描述](https://i.stack.imgur.com/6Bnhd.png)

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-04-23T17:42:06.477

如果你能拿到其中一架[退役的航天飞机](http://www.reddit.com/r/technology/comments/7slqt/space_shuttle_cockpit_pic/)，他们就有了！

![替代文字](https://imgur.com/17CW.jpg)

![替代文字](https://imgur.com/17Qr.jpg)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:35:28.100

我有一个带有十六进制数字键盘的旧[Heathkit](http://www.old-computers.com/museum/computer.asp?c=785&st=1)学习玩具，因为对其进行编程的唯一方法是手动将代码（它带有 6800 手册和一些记事本）汇编到在线监视器中。这真的很有趣！

[![显示十六进制键盘的 Heathkit 图片](https://i.stack.imgur.com/TGWG9.jpg)](http://www.old-computers.com/museum/computer.asp?c=785&st=1)

但是，我的缺少“ D”按钮。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T20:05:55.227

可编程键盘的好主意。我想我会选择其中之一：[DX1 输入系统](http://www.google.com/search?hl=en&q=dx1+input+system)。适用于我可能想做的任何重新配置​​。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:23:23.073

你说的是这个吗？ 
[时髦的 http://www.cpmuseum.com/Exhibits/Apple%20Lane/7603/7603-0005/images/000%20Front%20View.jpg](http://www.cpmuseum.com/Exhibits/Apple%20Lane/7603/7603-0005/images/000%20Front%20View.jpg) 
虽然这有很多“gee whiz”的吸引力，但我不得不说：

你有两只手。使用它们。AF 都可以用左手在标准键盘上进行，而右手在数字键盘上。与其将肌肉记忆时间投入到一些神秘的 Hex-pad 中，您将学习用左手触摸打字，这在您当前的项目之外有应用。

更好的是，想出一种更聪明的方法将十六进制代码放入您的代码中。编写一个脚本，将它们从您的数据源中提取并作为符号变量进入您的代码......或其他任何东西。

**编辑**

好的，我会给你怀疑的好处。让我们假设您正在处理一个硬件项目并且需要为您的用户提供一个专门的界面。也许[可编程键盘](http://www.genovation.com/progkeypads.htm)适合该法案？

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T20:13:55.223

现在不确定具体细节，但我很确定您可以轻松编写键盘重新映射器。您可以将 QWASDF 键重新映射到 ABCDEF 以便更快地键入它们。这样你就可以用两只手打字。或者，如果您可以控制他们正在输入的程序，您可以即时翻译代码中的键。您可能还想试用[Microsoft 键盘布局创建器](http://www.microsoft.com/downloads/details.aspx?FamilyID=8be579aa-780d-4253-9e0a-e17e51db2223&DisplayLang=en)

# language-agnostic - 所有文本编码中的数字是否按顺序表示？

> ID：782373
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T15:53:51.993
> 
>         
> 
> 标签：language-agnostic, unicode, text, encoding, ascii

这个问题与语言无关，但受到这些 c/c++ 问题的启发。

[如何将单个char转换为int](https://stackoverflow.com/questions/439573/how-to-convert-a-single-char-into-an-int/439589#439589)

[C中的char到int转换](https://stackoverflow.com/questions/781668/char-to-int-conversion-in-c)

假设数字字符（0123456789）在所有文本编码中连续出现是否安全？

即可以安全地假设

```
'9'-'8' = 1
'9'-'7' = 2
...
'9'-'0' = 9 
```

在所有编码中？

我期待这个问题的明确答案:)

谢谢，

**更新：**好的，让我将*所有编码*限制为像 ASCII 和/或 EBCDIC 以及之后的任何东西。Sandscrit 我不那么担心。. .

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-04-23T16:07:41.930

我不知道*所有*的编码，但至少在 ASCII 和 <shudder> EBCDIC 中，数字 0-9 都是连续出现的，并且以递增的数字顺序出现。这意味着所有基于 ASCII 和 EBCDIC 的编码也应该按顺序排列其数字。所以对于你会遇到的几乎任何事情，除非莫尔斯电码或[更糟](http://en.wikipedia.org/wiki/Baudot_code)，我会说是的。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T16:18:39.237

你会发现很难证明是否定的。没有人可能知道曾经发明的每一种文本编码。

今天常用的所有编码（除了 EBCDIC，它仍然常用吗？）都是 ASCII 的超集。我会说你更有可能赢得彩票，而不是找到一个不存在严格排序的“0”到“9”的实际环境。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T16:19:54.117

对于 C++ 和 C 程序文本，C++ 标准和 C 标准都要求这样做。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:17:38.927

根据 K&R ANSI C，它是。  

摘抄：

> *...“这个特定的程序依赖于数字的字符表示的属性。例如，测试*
> 
>   
>   
> 
> `if (c >= '0' && c <= '9') ...`
> 
>   
>   
> 
> *判断字符是否`c`为数字。如果是，则该数字的数值为*
> 
>   
>   
> 
> `c - '0'`
> 
>   
>   
> 
> *这仅在`'0', '1', ..., '9'`具有连续增加的值时才有效。**幸运的是，这适用于所有字符集。**……”*

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:25:11.403

我所知道的所有文本编码通常按顺序对数字的每个表示进行排序。但是，当您在其他编码中包含所有其他数字表示时，您的问题会变得更加广泛，例如日语：１２３４５６７８９０。注意数字的字符有何不同？好吧，它们实际上是不同的代码点。所以，我真的认为你的问题的答案可能很难，因为那里有很多编码，而且它们中有多种数字表示。

一个更好的问题是问自己，为什么我首先需要指望数字在顺序代码点中？

# c++ - 解析动态函数表单字符串

> ID：782376
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T15:54:24.613
> 
>         
> 
> 标签：c++, parsing

我正在尝试从字符串解析动态函数，例如：

```
char* func = "app.exe /path:\"@FileExists('filepath', @FileDelete('filepath'), @MsgBox('file not found','error',1))\"; 
```

我要解析

```
@FileExists('filepath', @FileDelete('filepath'), @MsgBox('file not found','error',1)) 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T16:08:19.277

C++ 没有动态函数的概念。如果您正在寻找某种可以接受字符串并将其作为 C++ 代码执行的函数，那么您就不走运了。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T16:59:38.233

正如 Josh 已经说过的，使用一些动态脚本语言可能是最好的主意。你应该看看[Lua](http://lua.org)，它易于嵌入、体积小并且在 MIT 许可下可用。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T16:41:25.780

我假设您正在寻找执行字符串中的代码。在 C++ 中，一旦程序被编译，就没有函数或变量名称的记录。这只是地址。  

可以设置您自己的字符串到函数的映射。然后，您必须建立一个函数/名称和参数树并手动调用这些函数。本质上，您必须为 C++ 的某些子集编写一个解释器，并使用一组预定义的可用函数。这绝对不是初学者的任务，但如果你真的想要，那么看看[Recursive-Descent parsing](http://en.wikipedia.org/wiki/Recursive_descent_parser)。这是迄今为止开始编写解释器的最简单方法。如果您的需求超出此范围，请查看一些更强大的解析器，例如[ANTLR](http://www.antlr.org/)或[flex/bison](http://dinosaur.compilertools.net/)

可以在 C++ 中嵌入更多的动态脚本语言。事实上，大多数脚本语言都有某种 C 接口，你可以用 C 做的任何事情，都可以用 C++ 做。看看类似[Boost.Python](http://www.boost.org/doc/libs/1_38_0/libs/python/doc/index.html)的东西，或者[这个](http://www.codeproject.com/KB/COM/scriptdemo.aspx)VBScript 的例子。

# javascript - 让一个返回另一个函数的逆函数的函数值得付出努力吗？

> ID：782377
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-23T15:54:29.120
> 
>         
> 
> 标签：javascript, readability, syntactic-sugar

我最近在我们的内部 javascript 库中添加了一个 HasValue 函数：

```
function HasValue(item) {
    return (item !== undefined && item !== null);
} 
```

A 在与同事的交谈中，我们提出了添加另一个基本上只是相反的函数的想法：也许 HasNoValue 或 IsNothing 如果我们最终这样做，我们将拥有：

```
function HasNoValue(item) {
    return (item === undefined || item === null);
}
function HasValue(item) {
    return !HasNoValue(item);
} 
```

但是，我们不确定两者兼有或 HasValue 是否更具可读性。哪个更易读/更受欢迎？

A：

```
if (HasValue(x) && !HasValue(y)) 
```

乙：

```
if (HasValue(x) && HasNoValue(y)) 
```

* * *

## 回答 #1

> 赞同：20
> 
>             
> 
> 时间：2009-04-23T15:56:33.593

我非常喜欢A而不是B。“！” 是大家都应该理解的编程成语。

* * *

## 回答 #2

> 赞同：12
> 
>             
> 
> 时间：2009-04-23T16:03:48.663

如果`!HasValue(y)`和`HasNoValue(y)`保证在 的整个输入范围内是逻辑等价的`y`，那么我会非常喜欢`!HasValue(y)`.

我什至会犹豫是否要*命名*一个函数`HasNoValue(y)`，因为不可避免地有人会写`!HasNoValue(y)`.

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2009-04-23T15:57:44.543

*到目前为止*，我投票“A” 。

与易于理解且可读性强的“！”相比，为每个布尔返回函数执行此操作所带来的额外维护负担是不值得的，事实上，我相信“B”实际上可读性*较差*，因为它很容易错过名字中间的“No”。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:08:19.713

我知道我会很孤单，如果我在一个合作项目中面临这个选择，我肯定会选择 A，因为很明显这是*正确*的做法，但我不得不说我很欣赏选项 B 的冗长。文字比符号更容易阅读和理解，即使它像我们心爱的感叹号一样平凡。

尤其是现在 IDE 的智能感知比以前好得多，我通常倾向于选择比以前更详细的命名方式。十分之九，可读性胜过小的性能差异，放下手。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T15:57:26.353

只是为了减少代码行并且因为您的函数返回布尔值，我会说使用方法 A。如果您必须担心可读性，您可以随时尝试：

```
if ( HasValue(x) && !(HasValue(y)) ) 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T15:57:26.900

我会说选项 A 更清楚，您确切知道它的含义。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T15:59:09.110

我会坚持选项A，但那只是我。

# asp.net - 在缓存控件中注册 Javascript

> ID：782379
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T15:55:01.383
> 
>         
> 
> 标签：asp.net, javascript, swfobject

我有一个缓存的用户控件，作为该控件的一部分，用于加载[swfobject](http://code.google.com/p/swfobject/)的 javascript被写入页面。我尝试使用 ClientScript.RegisterStartupScript 将 javascript 写入页面，但是，当从缓存中呈现时，不再包含 javascript。这意味着未加载 swfobject。

目前我正在将脚本编写到控件的 div.InnerHTML 的一部分中，这很有效，但是有更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:09:43.110

不，据我所知没有更好的方法。

您可以使用 Literal 或 PlaceHolder 而不是 div 来放入代码，这样您就没有多余的 div，但除此之外它无法真正改进。如果要缓存控件，它所做的一切都必须包含在它呈现给页面的内容中。当控件从缓存中呈现时，后面的代码不会被执行，因此它不会在控件本身之外产生任何副作用。

# vim - 汇编 vim 语法高亮

> ID：782384
> 
>         
> 
> 赞同：33
> 
>         
> 
> 时间：2009-04-23T15:56:08.557
> 
>         
> 
> 标签：vim, assembly, x86, vim-syntax-highlighting

默认的程序集语法文件效果不佳，在网上搜索有关 gas 程序集的信息，我没有发现任何有关 vim 的 gas (AT&T) 语法文件的信息。有没有人发现这个？我无法编写自己的语法文件。

[http://img168.imageshack.us/img168/46/nasm.png](http://img168.imageshack.us/img168/46/nasm.png) ft=nasm

[http://img160.imageshack.us/img160/5857/asm.png](http://img160.imageshack.us/img160/5857/asm.png) ft=asm（默认）

[http://img164.imageshack.us/img164/8476/tasm.png](http://img164.imageshack.us/img164/8476/tasm.png) ft=tasm

* * *

## 回答 #1

> 赞同：55
> 
>             
> 
> 时间：2009-04-23T16:04:01.517

[这可能](http://www.thouters.be/Vim8051Syn)会让你开始。这更像你正在寻找的东西吗？

刚刚进行了快速搜索 - 看起来内置了几种不同类型的汇编语法突出显示。您使用的是哪一种？

从 :help 语法复制粘贴

```
Currently these syntax
files are included:
    asm     GNU assembly (the default)
    asm68k      Motorola 680x0 assembly
    asmh8300    Hitachi H-8300 version of GNU assembly
    ia64        Intel Itanium 64
 fasm Flat assemlby http://flatassembler.net
    masm        Microsoft assembly (probably works for any 80x86)
    nasm        Netwide assembly
    tasm        Turbo Assembly (with opcodes 80x86 up to Pentium, and
            MMX)
    pic     PIC assembly (currently for PIC16F84)

The most flexible is to add a line in your assembly file containing:
    :asmsyntax=nasm
Replace "nasm" with the name of the real assembly syntax.  This line must be
one of the first five lines in the file. 
```

这个额外的[语法脚本](http://www.vim.org/scripts/script.php?script_id=966)来自 vim.org

看起来您的屏幕截图正在使用默认的 asm 文件类型。尝试

```
:set ft=nasm 
```

您应该根据这些屏幕截图获得一些颜色变化。

[![ft=nasm](https://imgur.com/2BJy.jpg)](https://imgur.com/2BJy.jpg)

[![](https://i.stack.imgur.com/eetUv.jpg)](https://i.stack.imgur.com/eetUv.jpg)

从上面的屏幕截图中，我对 fasm vim 语法进行了一些快速修改，并将其称为 gasm。它可以[在](http://pastebin.com/f65d3943e)pastebin 上找到。

将其复制并粘贴到您的个人 .vim/syntax 或 vimfiles/syntax 目录中，并将其命名为 gasm.vim 然后在您的程序集文件中：set ft=gasm

这个 vim 脚本依赖于形式为 % comment 的注释，其中包含空格。您可以在脚本的第 116 行看到这一点（或根据需要更改它）。

请注意：不要复制行号。

* * *

## 回答 #2

> 赞同：29
> 
>             
> 
> 时间：2009-11-21T14:03:03.223

我开始从头开始编写完整的 GNU 语法。  

语法文件可从 vim.org 获得：[GNU as syntax for X86](http://www.vim.org/scripts/script.php?script_id=2863)

以及直接在 GitHub 上：[GNU as syntax for X86](https://github.com/Shirk/vim-gas)  

除了基本指令外，它还将识别以下扩展的 Intel / AMD 指令：

*   X86通用指令集（8086-686）

*   Katmai 流式 SIMD 指令（SSE——又名 KNI、XMM、MMX2）

*   在 Deschutes 中引入，但对于 SSE 支持是必需的

*   XSAVE 组（AVX 和扩展状态）

*   通用内存操作

*   Katmai 中引入了新的 MMX 指令

*   AMD 增强型 3DNow！（速龙）说明

*   Willamette SSE2 可缓存性说明

*   Willamette MMX 指令（SSE2 SIMD 整数指令）

*   Willamette 流式 SIMD 指令 (SSE2)

*   普雷斯科特新指令 (SSE3)

*   VMX 指令

*   扩展页表 VMX 指令

*   光辉新指令 (SSSE3)

*   AMD SSE4A

*   巴塞罗那的新指令

*   Penryn 新指令 (SSE4.1)

*   Nehalem 新指令 (SSE4.2)

*   AMD SSE5 指令

*   英特尔 SMX

*   Geode (Cyrix) 3D现在！补充

*   英特尔 AES 指令

*   英特尔 AVX AES 指令

*   英特尔 AVX 指令

*   英特尔无进位乘法指令 (CLMUL)

*   英特尔 AVX 无进位乘法指令 (CLMUL)

*   英特尔融合乘加指令 (FMA)

*   威盛（Centaur）安全说明

*   AMD XOP、FMA4 和 CVT16 指令 (SSE5)

*   提示 nop 指令的系统名称

这是它的样子：

![替代文字](https://raw.githubusercontent.com/Shirk/vim-gas/master/sample.png)

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2021-05-06T15:15:08.227

每当您打开文件时，将这一行放入您的遗嘱中`.vimrc`都会为您设置 intel 语法：`.asm`

```
autocmd BufNew,BufRead *.asm set ft=nasm 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2020-12-13T17:26:04.363

`Vim/Nvim`如果无法检测到特定的文件类型，可以通过文件本身中的实际宏告诉它是什么，而不必`:set ft=nasm`每次打开文件时都运行命令。

为此，请弄清楚文件类型的注释语法是什么，然后在文件末尾添加这样的一行：（例如 for `NASM`）

```
; vim:ft=nasm 
```

此图像显示了语法高亮显示以及添加行后文件的外观。

[![在此处输入图像描述](https://i.stack.imgur.com/qy4kW.png)](https://i.stack.imgur.com/qy4kW.png)

# .net - 不用打印机打印？

> ID：782387
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T15:56:18.633
> 
>         
> 
> 标签：.net, testing, pdf, printing

这就是我面临的情况。我开发了一个 Web 应用程序，允许用户选择现有的 PDF 文件以在选定的打印机上批量打印。  

但是，在 UAT 环境中，由于存在网络安全风险，我们无法连接打印机。我可以安排安装第三方软件，但是由于安排配置更改的管理负担，最好可以通过数据库或简单的配置文件来配置该工具。

鉴于此限制，我如何在没有硬件的情况下复制打印，既用于开发人员的系统测试，***也***用于客户的用户验收测试？

我知道这听起来最初出现在这个[问题](https://stackoverflow.com/questions/582413/can-you-print-to-a-printer-driver-without-having-the-hardware-and-see-the-output)上，但解决方案需要对最终用户可行，而不仅仅是对开发人员。  

我曾想过创建一个打印机驱动程序，它将获取 PDF 文件并将其保存到指定的目录中，并将时间戳作为名称的一部分。我将开发一个单独的应用程序/网页，仅在 UAT 环境中可供用户使用，以监视此目录的内容并允许用户检查目录的内容，即选择特定的文件名并将文件流式传输到浏览器。这将允许最终用户检查他们选择打印的文件是否正在传递到指定的打印机。

如果您能想到更好的解决方案，请告诉我。提前致谢。

问候，MagicAndi。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T16:02:16.530

在 SourceForge 上尝试[ImagePrinter](http://sourceforge.net/projects/imageprinter/)，听起来正是您所需要的。好吧，它会节省您编写自己的打印机驱动程序来复制文件的时间。

我认为您提出的解决方案是一个很好的解决方案

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:04:17.943

您可以设置 Microsoft EPS 打印机

我使用本教程在我的笔记本电脑上设置它[http://kb.iu.edu/data/ahii.html](http://kb.iu.edu/data/ahii.html)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:19:44.770

你有安装驱动吗？为什么不将打印机连接到文件端口？这会将文件路由到磁盘。但是，文件名只能有一个，连续打印会覆盖前一个。因此，您需要添加文件夹观察程序以在打印后立即重命名文件。

您所说的解决方案必须对最终用户可行是什么意思？为什么您认为您的用户不能使用文件端口？打印到文件显然是另一种解决方案。

I don't see why you need to write a driver. The [RedMon](http://pages.cs.wisc.edu/~ghost/redmon/) port monitor can probably be tailored to generate those timestamped files in a directory of your choice.

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:28:28.243

If it is Windows there are several utilities like [PDFCreator](http://sourceforge.net/projects/pdfcreator/)
which create virtual printers that allow you to print to PDF.

I believe linux has such utilities too, but I can't name them.

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:34:51.723

Download [http://www.dopdf.com/](http://www.dopdf.com/)
Its free and it installs a virtual printer that creates PDFs. 

Greetings

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:39:42.133

Would the MS [XPS Document Writer](http://msdn.microsoft.com/en-us/library/dd183313(VS.85).aspx) help? This is configured as a printer on the desktop, I don't see why you couldn't set it up on the server too.

# oracle - SYSDATE - pl/sql 函数出现 1 个错误

> ID：782389
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T15:56:26.870
> 
>         
> 
> 标签：oracle, plsql, ora-06512

我有一个问题：

当我在 ti 下面发出这个函数时，会出现以下错误：

```
select 'EXECUTE DBMS_LOGMNR.ADD_LOGFILE(LOGFILENAME =>'''||name||'''||,OPTIONS=>DBMS_LOGMNR.NEW);'
 from v\$archived_log 
where name is not null;

select 'EXECUTE DBMS_LOGMNR.ADD_LOGFILE(LOGFILENAME =>'''||name||'''||,OPTIONS=>DBMS_LOGMNR.ADDFILE);' 
 from v\$archived_log 
where name is not null;

EXECUTE DBMS_LOGMNR.START_LOGMNR( STARTTIME => SYSDATE - 1, ENDTIME => SYSDATE,
OPTIONS => DBMS_LOGMNR.DICT_FROM_ONLINE_CATALOG + DBMS_LOGMNR.CONTINUOUS_MINE +
DBMS_LOGMNR.COMMITTED_DATA_ONLY + DBMS_LOGMNR.PRINT_PRETTY_SQL);

Error:

*
ERROR at line 1:
ORA-01291: missing logfile
ORA-06512: at "SYS.DBMS_LOGMNR", line 58
ORA-06512: at line 1 
```

但是我已经添加了几天前的所有存档日志，我的系统日期在今天。

请帮助解决这个问题。

谢谢。

回复

阿约

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-08-20T17:19:22.877

您需要从前两个查询中获取值并实际执行它们，并且无论如何您似乎都存在语法错误。

```
BEGIN
  FOR CUR_NEW IN ( 
    select 'CALL DBMS_LOGMNR.ADD_LOGFILE(' ||
           'LOGFILENAME =>'''||name||''','||
           'OPTIONS=>DBMS_LOGMNR.NEW);' as COMM
    from v$archived_log 
    where name is not null
  ) LOOP
    EXECUTE IMMEDIATE CUR_NEW.COMM;
  END LOOP;

  FOR CUR_ADD IN ( 
    select 'CALL DBMS_LOGMNR.ADD_LOGFILE(' ||
           'LOGFILENAME =>'''||name||''','||
           'OPTIONS=>DBMS_LOGMNR.ADDFILE);' as COMM
    from v$archived_log 
    where name is not null
  ) LOOP
    EXECUTE IMMEDIATE CUR_ADD.COMM;
  END LOOP;

  EXECUTE IMMEDIATE 'CALL DBMS_LOGMNR.START_LOGMNR( ' ||
    'STARTTIME => SYSDATE - 1, ' ||
    'ENDTIME => SYSDATE, ' ||
    'OPTIONS => ' ||
      '  DBMS_LOGMNR.DICT_FROM_ONLINE_CATALOG '||
      '+ DBMS_LOGMNR.CONTINUOUS_MINE '||
      '+ DBMS_LOGMNR.COMMITTED_DATA_ONLY '||
      '+ DBMS_LOGMNR.PRINT_PRETTY_SQL)';
END; 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T23:30:32.443

好像您运行了选择但没有执行句子。

# visual-studio - 如何将外部文件与程序集关联

> ID：782395
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-04-23T15:57:11.160
> 
>         
> 
> 标签：visual-studio

假设您有一个类库项目，其中包含任意数量的补充文件，这些文件也需要包含在已编译的程序集中（例如，简单的文本文件，甚至是由程序集包装为互操作层的旧版非托管 DLL）。虽然将补充文件嵌入程序集本身是[相对简单](https://stackoverflow.com/questions/433171/embed-text-file-into-net-assembly)的，但我们也遇到了不可能或不希望这样做的情况。我们需要将它们作为“sidecar”文件（即程序集旁边的文件，可能在相对于程序集的子目录中）

将这些文件添加到项目中并为“复制到输出目录”指定适当的值似乎足以满足解决方案中完全独立的项目。但是，如果另一个解决方案中的单独项目添加了对程序集的引用，它不会自动拾取其边车文件。项目中是否有办法以某种方式标记生成的程序集，以便引用该程序集的任何内容也知道它需要包含关联的边车文件？你怎么做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-27T18:33:42.513

您可以使用 al.exe，但似乎还有一个 C# 编译器选项。您想使用 /linkresource C# 编译器选项创建多文件程序集。说明在[这里](http://msdn.microsoft.com/en-us/library/xawyf94k.aspx)，但命令与此类似：

```
csc /linkresource:N.dll /t:library A.cs 
```

其中 N.dll 是一个*本机 DLL*，无论托管程序集走到哪里（包括到 GAC 中），它都会走到哪里。我提供的链接上有一个非常清晰的描述。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:03:20.707

您是否尝试过为您的解决方案创建设置？可以选择包含针对应用程序安装目录的边车文件。

另一种选择是在程序集资源中包含边车文件，并在第一次运行时将它们解包到磁盘。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-30T21:07:26.643

如果您创建一个包含库及其依赖项的[合并模块怎么办？](http://msdn.microsoft.com/en-us/library/aw2dz878(VS.80).aspx)然后，您的安装程序将需要引用此模块，但您将确保所有必要的文件都存在。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:11:47.407

不幸的是，Visual Studio 中似乎没有很多内置支持，尽管我可以肯定地看到用例。

如果您使用 Subversion 进行源代码控制，那么您可以链接外部参考作为外部定义。这将引入源代码，并且您将对必要程序集的引用作为项目引用而不是 DLL 引用，然后复制到输出目录规则将发挥作用。

如果这不可能，另一种解决方案是在解决方案项目的构建前/构建后事件中包含命令，以从构建的远程程序集中复制最新的边车文件。当然，这需要注意的是，当您在项目中包含 DLL 时，它不会自动设置。您必须采取手动步骤进行设置。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-27T21:39:58.197

我前段时间处理过这个问题。它是一个常见的问题。

您可以创建一些构建后操作：

[http://www.codingday.com/execute-batch-commands-before-or-after-compilation-using-pre-build-or-post-build-events/](http://www.codingday.com/execute-batch-commands-before-or-after-compilation-using-pre-build-or-post-build-events/)

希望这可以帮助... ：）

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-04-30T05:22:11.453

在我看来，您使用了错误的参考类型。有两种类型的引用——Reference 和 ProjectReference。引用是对特定程序集的显式引用。ProjectReference 是对另一个项目（比如 .csproj）的引用。

您正在寻找的是 ProjectReference。VS 和默认的 MSBuild 目标设置为执行 CopyLocal。如果您将“sidecar”文件的 CopyToOutputPath 设置为 true，则该项目的任何 ProjectReferences 现在也将拉入相同的文件。

我不确定您是否可以在 IDE 中跨解决方案使用 ProjectReferences。我处理了很多与 sln 文件不相关的 MSBuild，这就是我处理它的方式。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-04-30T15:38:40.007

我们在项目中所做的是我们创建了单独的构建文件来完成所有这些工作。

在您的构建文件中，您可以使用标签来构建您的主要解决方案，然后添加标签以在构建后复制您需要的文件。

NAnt 也是您的选择，但现在我很高兴使用 Rake 作为我的构建/调试自动化。

由于这不能集成到 Visual Studio 中，我正在做的是创建一个任务（在 MSBuild、NAnt 或 Rake 中），最后执行 vsjitdebugger.exe 以在调试时将其附加到我的 Visual Studio。

这些只是我现在的风格，你也许可以创造你自己的风格。

# php - PHP 重复区域和复选框

> ID：782399
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T15:57:36.260
> 
>         
> 
> 标签：php, forms, checkbox, dreamweaver

--为清楚起见进行了编辑。

数据库：

**tblModule**，包含可以启用或禁用的模块列表。
**tblData**，包含信任列表和它们启用的模块。这链接到**tblData.M01** **= tblModule.mod_key**上的tblModule

 **PHP 页面从索引页面访问，并将变量**lstModTrust**传递给该页面，以限制从 tblData 返回的记录为单一信任。**tblData.trust_key**

运行一个查询**qryModuleList**，它返回所有模块的列表。这用于生成所有可用模块的表。每行显示模块名称**tblModules.mod_name**、**模块代码 tblModules.mod_code**和一个复选框。

**qryModData**将返回为单个信任启用的模块列表，并且需要在表中勾选相应的复选框。

然后，此页面将用于启用和禁用信任的模块。如果一个模块未勾选，则该条目将从**tblData**中删除，如果勾选，则将插入一个条目，如果没有更改，则 DB 中没有更改。

目前我无法根据**qryModData正确勾选复选框**

有什么想法吗？

--已编辑以包含代码--

```
<table width="50%" border="0" cellspacing="0" cellpadding="0">
    <tr>
        <td>Module</td>
        <td>Module Code</td>
        <td>&nbsp;</td>
    </tr>
    <?php do { ?>
    <tr>
        <td><?php echo $row_qryModuleList['mod_name']; ?></td>
        <td><?php echo $row_qryModuleList['mod_code']; ?></td>
        <td><input <?php if (!(strcmp($row_qryModData['M01'],$row_qryModuleList['mod_code']))) {echo "checked=\"checked\"";} ?>name="chkMod" type="checkbox" id="chkMod" value="<?php echo $row_qryModData['M01']; ?>" /></td>

    </tr>
    <?php } while ($row_qryModuleList = mysql_fetch_assoc($qryModuleList)); ?>
</table> 
```

然后有两个 SQL 查询，一个生成用于构建表的列表，第二个是我试图用来将框设置为勾选的。

```
qryModuleList
SELECT *
FROM tblmodules
ORDER BY mod_name ASC

qryModData
SELECT *
FROM tbldata
WHERE trust_key = varTrust 
```

varTrust 是从 URL 变量中提取的。

很抱歉首先没有包含代码。

--编辑新代码。

```
<?php while ($row_qryModuleList = mysql_fetch_assoc($qryModuleList)) { ?> 
    <tr>
        <td><?php echo $row_qryModuleList['mod_name']; ?></td>
        <td><?php echo $row_qryModuleList['mod_code']; ?></td>
        <td><input <?php if (strcmp($row_qryModData['M01'],$row_qryModuleList['mod_key']) != 0) {echo "checked=\"checked\"";} ?>name="chkMod" type="checkbox" id="chkMod" value="<?php echo $row_qryModData['M01']; ?>" /></td>

    </tr>
<?php } ; ?> 
```

--为新代码编辑。

```
<tr class="tblHead">
    <td>Module</td>
    <td>Module Code</td>
    <td>Enabled\Disabled</td>
</tr>

<?php
$mod_data = array();
while ($row_qryModData = mysql_fetch_assoc($qryModData))
    array_push($mod_data, $row_qryModData['M01']);
$currentRow = 0;
while ($row_qryModuleList = mysql_fetch_assoc($qryModuleList)) {
?>
    <tr bgcolor="<?php echo($currentRow++ % 2)?"#CCFFFF":"#FFCCFF";?>">
        <td><?php echo $row_qryModuleList['mod_name']; ?></td>
        <td><?php echo $row_qryModuleList['mod_code']; ?></td>
        <td><input <?php if (false !== (array_search($mod_data, $row_qryModuleList['mod_key']))) echo "checked=\"checked\""; ?> name="chkMod" type="checkbox" id="chkMod" value="<?php echo $row_qryModData['M01']; ?>" /></td>
    </tr>
<?php } ; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:15:19.863

我想我现在明白这一点了。您需要做的是将所有允许的模块放入一个数组中并使用[array_search()](http://www.php.net/array_search)函数来查找它。

例子：

```
$mod_data = array();

while ($row_qryModData = mysql_fetch_assoc($qryModData)) array_push($mod_data, $row_qryModData['M01']); 
```

这会将所有可用模块放入一个阵列中。

接下来，当您循环浏览“ModuleList”查询时，使用 array_search() 方法尝试在其中找到“ModKey”变量。如果您这样做，请选中该框。如果没有，什么也不做。

例子：

```
<td><input <? if (false !== (array_search($mod_data, $row_qryModuleList['mod_code'])) echo "checked=\"checked\" "; ?>name="chkMod" type="checkbox" id="chkMod" value="<?php echo $row_qryModData['M01']; ?>" /></td> 
```

（我使用“！==”的原因是因为该函数可以返回 false 或可能等于 false 而可能不等于的内容。阅读我上面链接的页面以获取更多信息）

# wpf - 当其他窗口处于焦点时隐藏弹出控件

> ID：782401
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-04-23T15:57:50.313
> 
>         
> 
> 标签：wpf, popup, custom-controls

我有一个自定义 UserControl，它试图为文本框重新创建自动完成功能。当用户键入时，文本用于过滤提供的项目集合，然后弹出窗口显示一个列表框，其中包含与用户键入的内容相匹配的项目。

不幸的是，如果用户决定从应用程序切换到另一个窗口（浏览器、MSWord 等等！），弹出窗口仍然位于所有其他窗口的顶部！

此外，如果我在弹出窗口打开的情况下移动窗口（托管自定义控件），弹出窗口将保持原位（并且不跟随窗口）！这有点有趣，但显然是不可接受的行为。我环顾四周，但只发现一篇关于此的帖子两年没有得到答复:(

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-04-28T13:06:53.973

实际上，我没有意识到我`StaysOpen`将 Popup 的属性设置为`true`.

```
<Popup StaysOpen="False" /> 
```

实际上对我有用。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T18:39:47.663

在类似的情况下，我遇到了同样的问题。我所做的是订阅了控件的所有可能的“失去焦点”事件，并且还获得了托管控件的窗口并订阅了它的 GotMouseCapture 和 LocationChanged 事件。所有这些事件的事件处理程序都将弹出窗口的 IsOpen 属性设置为 false。

您可以通过以下方式获取托管窗口：

```
parentWindow = Window.GetWindow(this); 
```

所有其他代码只是大量订阅事件来做同样的事情。

PS我并不是说这是一个漂亮或最佳的解决方案，但它对我来说很好:)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:45:04.817

根据[弹出文档](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.popup.aspx)：

> 当 Popup 显示在屏幕上时，如果重新定位其父级，它不会重新定位自身。

所以它看起来不是自动完成文本框的一个很好的候选者。我认为该课程更多地用于在您将鼠标悬停在项目上时显示信息。

# asp.net - 需要有关选择数据访问方法的建议

> ID：782406
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-04-23T15:59:34.617
> 
>         
> 
> 标签：asp.net, linq-to-sql, entity-framework, dynamic-data, data-access-layer

我正处于计划将大型经典 ASP 数据库应用程序转换为 ASP.Net 的早期阶段，并且在选择使用哪种数据访问方法时遇到了麻烦。我玩过 Linq To SQL、动态数据、强类型数据集、企业库（数据访问应用程序块）和一点点实体框架，但没有一个让我觉得“那个”。选择太多了-我的头在游泳，帮我选择！  

也许这将有助于提供一些关于我正在转换的应用程序的背景以及优先级......

*   后端是 Microsoft SQL Server（2005 或更高版本），我们致力于此，因此我无需担心是否支持不同的数据库平台。

*   数据库非常成熟，包含了大量的业务逻辑。它高度规范化并广泛使用存储过程、触发器和视图。我不想同时重新发明两个轮子，所以我想对数据库做尽可能少的改动。因此，我需要选择一种足够灵活的数据访问方法，让我能够解决数据库中的任何问题。

*   该应用程序具有许多数据输入表单和广泛的搜索和报告功能（报告是我稍后将解决的另一个问题）。

*   应用程序需要足够灵活，以处理对数据库结构的微小更改。应用程序（和数据库）可以安装在对数据库进行少量自定义修改的不同站点。理想情况下，应用程序可以识别数据库扩展并做出适当的反应。换句话说，如果我需要在应用程序中存储一个 O/R 映射，我需要在新站点上安装应用程序和数据库时能够将其换出（或轻松刷新）。

*   快速应用程序开发至关重要。由于数据库已经完成，并且用户界面将与现有应用程序紧密匹配，我希望找到一些可以很快完成的东西。如果可以节省开发时间，我愿意牺牲不使用绝对最新和最伟大的技术。换句话说，如果使用 Entity Framework 之类的东西有一个陡峭的学习曲线，我可以使用强类型数据集和自定义 DAL 之类的东西，如果它可以加快进程的话。  

*   我是 ASP.Net 的新手，但对经典 ASP、T-SQL 和旧的 ADO（例如断开连接的记录集）非常熟悉。如果任何一种数据访问方法更适合来自我背景的人，我可能会倾向于那个方向。

感谢您提供的任何建议！

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-23T16:27:38.153

查看本系列中的所有三篇文章：

[高性能数据访问层架构第 1 部分](http://rlacovara.blogspot.com/2009/02/high-performance-data-access-layer.html) 

很好的建议。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:37:44.977

您可能希望考虑将数据库层与 asp 层分离，这样您不仅可以在做出决定时提供更大的灵活性，而且当您必须对客户的数据库进行更改时，您可以在不更改任何内容的情况下换入新的 dll别的。

通过使用依赖注入，您可以使用 xml 告诉框架将哪个具体类用于接口。

这样做的好处是您可以使用一种数据库方法，如果您后来决定更改为另一种，那么您可以只更改 dll 并继续，而不对其他层进行任何更改。

既然您更熟悉它，为什么不直接通过自己的连接直接进入数据库呢？然后，您可以移动其余代码，并在此过程中决定使用无数种技术中的哪一种。  

对于我正在开发的一个新应用程序，我从 LINQ to SQL 开始，主要是因为开发会更快，但是，稍后，如果我决定这不能满足我的需求，我将把它换掉。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:09:04.187

nHibernate 可能是一个不错的选择。您可以将映射存储在外部配置文件中，这将解决您的需求。另一种选择可能是使用基于 nHibernate 的[ActiveRecord 。](http://www.castleproject.org/activerecord/index.html)

nHibernate 有一个简洁的功能，您可能会发现它很有帮助。它被称为动态属性，它基本上是通过从映射文件中提取列名来填充的名称值对集合。因此，当您在客户端站点添加列时，您会更新映射文件，并且您将能够通过对象上的集合访问数据。

# html - 在 Silverlight 上显示 HTML div

> ID：782415
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2009-04-23T16:01:56.000
> 
>         
> 
> 标签：html, css, silverlight

是否可以让 HTML 出现在嵌入式 Silverlight 之上？  

* * *

## 回答 #1

> 赞同：25
> 
>             
> 
> 时间：2009-04-23T16:07:31.603

可以，但您需要在 Silverlight 对象标记上将无窗口参数设置为 true，以便它可以在其他 HTML 对象后面呈现。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T16:21:14.953

Anthony 是对的——我在我的博客上展示[了一个代码片段。](http://blogs.msdn.com/synergist/archive/2008/09/16/added-high-dpi-support-to-my-silverlight-photobucket-demonstration-application.aspx)您需要在对象元素中实现，然后使用 CSS Z-index。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-25T14:30:37.777

有关在 Silverlight 控件之上或之下分层 HTML 元素的更多信息：http: [//weblogs.asp.net/jgalloway/archive/2008/02/15/using-windowless-silverlight-controls-to-blend-html-和-silverlight-elements.aspx](http://weblogs.asp.net/jgalloway/archive/2008/02/15/using-windowless-silverlight-controls-to-blend-html-and-silverlight-elements.aspx)

请注意，[使用无窗口和/或透明控件会影响性能，](http://msdn.microsoft.com/en-us/library/cc189071(VS.95).aspx#windowless_true_is_expensive)因为它需要更频繁的重绘，因此不建议将其用于动画或视频播放。

# floating-point - python反三角函数（尤其是arcsin）

> ID：782418
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T16:03:39.083
> 
>         
> 
> 标签：floating-point, trigonometry

我目前正在尝试运行涉及三角函数的东西，但我遇到了一个涉及 math.asin 函数的问题（它也适用于 acos 和 atan，但在这些情况下，它对我想要做的事情的影响较小）。这个问题最好用我在其他地方找到的帮助线程中的两篇文章来总结；

> 对不起，我刚刚又试了一次，发现
> 
>   
>   
> 
> a = sin(2) 
> 
>   b = asin(a) 
> 
>   b 不 = 2
> 
>   
>   
> 
> 但
> 
>   
>   
> 
> a = cos(2) 
> 
>   b = acos(a) 
> 
>   b DOES= 2
> 
>   
>   
> 
> 因为 y = sin(x) 是一个重复函数，所以对于每个 y 值都有多个 x 值。即 sin(2) = sin(1.14) = 0.909
> 
>   
>   
> 
> 因此，当您执行 x = asin(y) 时，您只会得到介于 -PI/2 <= x <= PI/2 之间的值

我从数学上理解为什么会这样，但我想知道是否有人可以帮助我找到一个范围内的所有解决方案，而不仅仅是它自动提供的解决方案。谢谢=]

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-23T16:15:26.700

让我们考虑范围 [0, 2π)。

对于`acos`，每个值 x 在 2π - x 处也有另一个可能的值。（想象余弦图，你会看到它。）

对于`asin`，每个正值 x 在 π - x 处都有另一个可能的值；每个负值在 3π - x 处都有一个可能的值。

随意绘制更多图表以推广到更大的范围。:-)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:15:42.393

acrsin(a) 的所有解决方案将是：

b、pi - b、2pi + b、2pi + (pi - b) 等。  

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:18:20.577

正如其他人已经详细解释的那样，由于三角函数的（重复）性质，您选择了*一个*导致 asin() 结果不确定的值。

[尽管如此，我只是想指出，由于更一般的浮点精度问题](http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems)，期望能够在使用浮点的逆运算中得到*完全相同的结果可能会失败*

使用浮点你**不能**保证

```
a == asin(sin(a)) 
```

或者

```
a == (a / b) * b 
```

对于这个问题。小心点。

# asp.net - ASP.NET GridView - 防止在列中换行

> ID：782428
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T16:05:16.973
> 
>         
> 
> 标签：asp.net, gridview, column-width

在 ASP.NET GridView 上，我有一个从数据库打印字符串的字段。此数据的范围可以从 10 到 100 个字符。当它比正常长时，该字段会自动换行数据，使该行比其他行占用更多的垂直空间。我想截断任何不适合该行的数据，然后在它旁边有一个“...”表示还有更多。我不需要让他们调整大小，我只是不想要任何不同高度的行。我希望这可以在客户端动态完成，用于 SEO 目的。

请参阅[此处的 ActiveWIdgets 网格](http://www.activewidgets.com/grid/)，并调整公司名称的大小，使其不适合。您会注意到它没有包装内容，而是完全按照我的意愿行事。

如何将此技术应用于 ASP.NET GridView？我假设涉及一些Javascript。如果这是真的，我宁愿*不*使用像 jQuery 这样的库（不要问为什么——我不允许为这个项目使用外部依赖项）。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:10:33.903

**目录**

1.  问题说明

2.  一种解决方案的插图

**问题说明**

将以下 HTML 复制到您的浏览器（至少 Firefox 和 Internet Explorer 7，但您也应该尝试 Opera）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <style type="text/css">
        div, td
        {
            width: 100px;
            border: solid 1px black;
            white-space: nowrap;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <div>
        content content content content content content
    </div>
    <table cellpadding="0" cellspacing="0">
        <tbody>
            <tr>
                <td>
                    content content content content content content
                </td>
            </tr>
        </tbody>
    </table>
</body>
</html> 
```

请注意，该`td`元素不会隐藏溢出的内容。现在只有`div`元素知道如何做到这一点。Internet Explorer 的`td`元素甚至不知道如何停止包装内容。

严格来说，根据[标准](http://msdn.microsoft.com/en-us/library/ms531182(VS.85).aspx)，`td`元素不支持`white-space`规则。和`div`元素`th`可以。

**一种解决方案的说明**

这是该问题的*一种*解决方案（在 Opera、Firefox 和 Internet Explorer 7 中测试）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <style type="text/css">
        td
        {
            border: solid 1px black;
        }
        div
        {
            width: 100px;
            white-space: nowrap;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <table cellpadding="0" cellspacing="0">
        <tbody>
            <tr>
                <td>
                    <div>
                        content content content content content content
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:14:56.420

如果您知道您的用户正在使用 Internet Explorer，则可以使用以下 IE 唯一 CSS：

```
td.nooverflow
{
  text-overflow:ellipsis;
} 
```

然后为您要修复宽度的列设置 ItemStyle `<ItemStyle CssClass='nooverfolow'/>`（您需要使用 CSS 才能使其适合您的应用程序）

不幸的是，由于这只是 IE，对于其他浏览器，有一些黑客可用于模拟相同的事情：

*   [这是 Firefox 的一个。](http://www.jide.fr/emulate-text-overflowellipsis-in-firefox-with-css) 

*   [这是 Firefox 的另一个](http://www.hedgerwow.com/360/dhtml/text_overflow/demo3.php)

*   [这是一个使用jQuery的](http://devongovett.wordpress.com/2009/04/06/text-overflow-ellipsis-for-firefox-via-jquery/)

# ios - 在 iOS 中加载/保存设置

> ID：782451
> 
>         
> 
> 赞同：28
> 
>         
> 
> 时间：2009-04-23T16:10:54.963
> 
>         
> 
> 标签：ios, settings, nsuserdefaults

我在 AppDelegate 中定义了以下两个过程。保存设置和加载设置。我在 AppDidFinishLaunching 方法中调用我的 loadSettings 过程，并在单击保存按钮后在我的设置视图中调用 saveSettings 过程。

这两种方法似乎都在正确的时间、正确的次数（一次）被调用，并且使用了正确的数据。我的设置对象获得了正确的数据，但数据似乎并没有真正保存。当我运行加载代码时，我得到的变量是空的（不是零）。

我尝试将相同的加载代码放在不同的视图中，它工作正常，但由于某种原因，我没有在我的 appDelegate 中得到结果。

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {    
    [window addSubview:navigationController.view];
    [window makeKeyAndVisible];
    [self loadSettings];
    [self setDefaults];
}

-(void)loadSettings{
    NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
    settings.masterLocation = [prefs objectForKey:@"masterLocation"];
    settings.masterPort = [prefs objectForKey:@"masterPort"];
    settings.userName = [prefs objectForKey:@"userName"];
    settings.passWord = [prefs objectForKey:@"passWord"];
    settings.autoLogin=[prefs objectForKey:@"autoLogin"];

    if (settings.autoLogin == nil)
        settings.autoLogin=@"N";
}

-(void)saveSettings:(SharedData *)d{
    settings=d;

    NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
    [prefs setObject:settings.masterLocation forKey:@"masterLocation"];
    [prefs setObject:settings.masterPort forKey:@"masterPort"];
    [prefs setObject:settings.userName forKey:@"userName"];
    [prefs setObject:settings.passWord forKey:@"passWord"];
    [prefs setObject:settings.autoLogin forKey:@"autoLogin"];   
} 
```

* * *

## 回答 #1

> 赞同：29
> 
>             
> 
> 时间：2009-04-23T16:17:48.363

多哈。

在 saveSettings 中，我错过了我的 [prefs synchronize]；

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2013-03-30T08:59:09.707

使其成为样本：

```
//Writing
[[NSUserDefaults standardUserDefaults] setInteger:1 forKey:@"anInt"];
[[NSUserDefaults standardUserDefaults] setDouble:1.2 forKey:@"aDouble"];
[[NSUserDefaults standardUserDefaults] setString:@"aString" forKey:@"aString"];
[[NSUserDefaults standardUserDefaults] synchronize];

//Reading:

int i = [[NSUserDefaults standardUserDefaults] integerForKey:@"anInt"] 
```

# c# - 背包问题的可能组合和？

> ID：782453
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-23T16:11:47.583
> 
>         
> 
> 标签：c#, java, complexity-theory, scale, knapsack-problem

好的快速概述

我研究过背包问题

[http://en.wikipedia.org/wiki/Knapsack_problem](http://en.wikipedia.org/wiki/Knapsack_problem)

我知道这是我的项目所需要的，但我项目的复杂部分是我需要在一个主袋内有多个袋子。

装着所有“袋子”的大背包只能携带 x 个“袋子”（例如 9 个）。每个包都有不同的价值；

*   重量

*   成本

*   尺寸

*   容量

依此类推，所有这些值都是整数。让我们假设从 0-100。

内袋也将被分配一个类型，外袋中只能有一种类型，尽管程序输入将被赋予多个相同类型。

我需要指定主包可以容纳的最大重量，而小包的所有其他属性都需要按加权值分组。

* * *

例子

外袋：

*   可容纳 9 个较小的袋子

*   重量不超过 98 [两边各取 5 个]

*   每种必须持有一种，每次只能持有一种。

内袋：

*   成本，100% 加权

*   大小，权重为 67%

*   容量，权重为 44%

* * *

程序将输入多个袋子，然后必须计算出较小袋子的组合才能进入较大的袋子，根据输入会有多个解决方案，程序会为我输出最佳解决方案。

我想知道你们认为我解决这个问题的最佳方法是什么。

我将使用 Java 或 C# 对其进行编程。我很想用 PHP 对其进行编程，但我担心该算法对于 Web 服务器来说效率很低。

谢谢你提供的所有帮助

-扎克

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T18:19:00.820

好吧，背包是 NP 难的，所以我很确定这也是 NP 难的（如果不是这样，你可以只用一个外袋来解决背包问题。）所以对于一个完全最优的解决方案，您可能只能搜索所有组合。所以你想要的程序的大纲就像

```
 for each possible combination
 do
   if current combination is better than best previous
      save current combination as best so far
   fi
 od 
```

并且运行时间将是指数级的。不过，这听起来像是您可以通过[动态编程](http://en.wikipedia.org/wiki/Knapsack_problem#Unbounded_knapsack_problem)获得近似解决方案。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T20:27:17.157

考虑使用[Prolog](http://en.wikipedia.org/wiki/Prolog)进行逻辑编程。它有多种实现，包括单声道（.NET）上的[P# 。](http://en.wikipedia.org/wiki/Comparison_of_Prolog_implementations)有一点学习曲线，但是一旦你习惯了它，它就几乎可以解决这种问题了。

希望这可以帮助。干杯!

链接到[P#](http://www.dcs.ed.ac.uk/home/stg/Psharp/)

# windows - Windows Messages Minimize Child 上的最小化应用程序

> ID：782454
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T16:12:11.327
> 
>         
> 
> 标签：windows, delphi

我有一个 delphi 应用程序，其中主表单是登录表单 - 它包含程序所需的各种数据库和用户对象。用户登录后，我隐藏此表单并打开另一个表单。  

我的问题是，当子窗体最小化时，如何使应用程序最小化？我想出了如何在使用 Windows 消息恢复主程序时恢复子项，但我不知道如何使应用程序最小化，因此当他们单击任务栏时，他们只需单击一次 - 而不是一次最小化和然后再次恢复。  

任何帮助表示赞赏 - 我试图使用 NCACTIVATE - 但在某些情况下，这会导致打印对话框和其他窗口的无限循环......

谢谢，克里斯蒂

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T16:43:59.970

我发现最好的方法是对架构稍作改动。您不希望您的登录表单成为您的应用程序的主要表单。您可以通过两种不同的方式解决此问题，但由于您在登录表单上维护数据库控件，所以我认为这是理想的方式。  

1.  选择一个不同的表单作为您的主表单并将其设置为首先创建。

2.  **在您的 DPR 中，使用loginForm := TLoginForm.Create(nil)**手动创建您的登录表单，而不是使用**Application.CreateForm**。  

3.  **在Application.Run**之前显示登录表单。当你完成它时，只需隐藏它而不是释放它。

理想情况下，您应该将所有数据库组件移动到 DataModule 中，以便在登录完成后释放 LoginForm。  

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:44:14.977

为什么不把主窗体变成现有的子窗体，把数据库逻辑放在一个数据模块中，手动创建和处理登录窗体呢？这是我通常使用的模式：

> 创建一个数据模块，它将在列表中首先自动创建（在主窗体之前）。OnCreate 中的 Tee 数据模块将初始化数据库并显示一个登录表单，该表单不在自动创建列表中，并且完全在数据模块中创建和处理。如果我需要启动屏幕，那么数据模块也以相同的方式提供该功能。
> 
>   
>   
> 
> 主窗体 OnCreate 检查以确保用户成功登录，如果没有，则调用 application.terminate;

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:43:58.713

当最小化非主窗体时，我使用 TMinModal 最小化我的应用程序。

[http://vvv.truls.org/pascal/Units.Delphi/UI/MinModal.pas](http://vvv.truls.org/pascal/Units.Delphi/UI/MinModal.pas)

# sql - SQL 查询的 SELECT 子句中 Oracle PL/SQL 语句的延迟评估

> ID：782465
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T16:15:23.330
> 
>         
> 
> 标签：sql, performance, oracle

我在游标中使用的 Oracle 选择语句存在性能问题。在语句中，`SELECT`子句中的一个术语的评估成本很高（它是一个 PL/SQL 过程调用，它对数据库的访问量很大）。然而，`WHERE`从句和`ORDER BY`从句是直截了当的。

我希望 Oracle 将首先执行该`WHERE`子句以识别与查询匹配的记录集，然后执行该`ORDER BY`子句对它们进行排序，最后评估该`SELECT`子句中的每个术语。由于我在游标中使用此语句，然后从中提取结果，因此我`SELECT`希望仅在从游标请求每个结果时才根据需要执行对术语的昂贵评估。

但是，我发现这不是 Oracle 使用的顺序。相反，它似乎`SELECT`在执行排序之前评估与 WHERE 子句匹配的每条记录的子句中的术语。因此，在从游标返回任何结果之前，会为结果集中的每个结果结果调用调用成本高的过程。

我希望能够尽快从光标中获得第一个结果。谁能告诉我如何说服 Oracle 在执行排序之前不要评估 SELECT 语句中的过程调用？

这在示例代码中可能更容易描述：

给定一个包含 、 和 列的表，我`example`有如下语句：`a``b``c``d`

```
select a, b, expensive_procedure(c)
  from example
 where <the_where_clause>
 order by d; 
```

在执行此操作时，`expensive_procedure()`会为与子句匹配的每条记录调用`WHERE`，即使我将语句作为游标打开并且只从中提取一个结果。

我尝试将声明重组为：

```
select a, b, expensive_procedure(c)
  from example, (select example2.rowid, ROWNUM
                   from example example2
                  where <the_where_clause>
                  order by d)
  where example.rowid = example2.rowid; 
```

`ROWNUM`内部语句中的存在`SELECT`迫使 Oracle 首先评估它。这种重组具有预期的性能优势。不幸的是，它并不总是尊重所需的顺序。

为了清楚起见，我知道我不会改进返回整个结果集所需的时间。我希望缩短从语句返回前几个结果所需的时间。我希望在迭代游标的结果时所花费的时间是渐进的，而不是在返回第一个结果之前所有的时间都过去。

任何 Oracle 专家都可以告诉我如何说服 Oracle 在必要之前停止执行 PL/SQL？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-24T10:27:09.243

为什么要在内联视图中将EXAMPLE 连接到自身？为什么不只是：

```
select /*+ no_merge(v) */ a, b, expensive_procedure(c)
from 
( select a, b, c
  from example
  where <the_where_clause>
  order by d
) v; 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:56:05.743

这是否符合您的意图？

```
WITH 
cheap AS
(
    SELECT A, B, C
    FROM EXAMPLE
    WHERE <the_where_clause>
)
SELECT A, B, expensive_procedure(C)
FROM cheap
ORDER BY D 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-24T12:19:38.507

如果你的`WHERE`条件是平等的，即

```
WHERE   col1 = :value1
        AND col2 = :value2 
```

您可以在以下位置创建复合索引`(col1, col2, d)`：

```
CREATE INDEX ix_example_col1_col2_d ON example(col1, col2, d) 
```

并提示您的查询使用它：

```
SELECT  /*+ INDEX (e ix_example_col1_col2_d) */
        a, b, expensive_procedure(c)
FROM    example e
WHERE   col1 = :value1
        AND col2 = :value2
ORDER BY
        d 
```

在下面的示例中，`t_even`是一个`1,000,000`带有索引的行表`value`。

`100`从此查询中获取列：

```
SELECT  SYS_GUID()
FROM    t_even
ORDER BY
        value 
```

是即时（`0,03`秒），而这个：

```
SELECT  SYS_GUID()
FROM    t_even
ORDER BY
        value + 1 
```

大约需要`170`几秒钟来获取第一`100`行。

`SYS_GUID()`相当昂贵`Oracle`

正如其他人所建议的，您也可以使用它：

```
SELECT  a, b, expensive_proc(c)
FROM    (
        SELECT  /*+ NO_MERGE */
                *
        FROM    mytable
        ORDER BY
                d
        ) 
```

，但使用索引会提高您的查询响应时间（返回第一行的时间）。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:31:09.500

你可能想试试这个

```
select a, b, expensive_procedure(c)
  from example, (select /*+ NO_MERGE */
                    example2.rowid, 
                    ROWNUM
                    from example example2
                    where <the_where_clause>
                    order by d)
  where example.rowid = example2.rowid; 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:35:10.910

可能某种形式的这种工作？

```
FOR R IN (SELECT a,b,c FROM example WHERE ...) LOOP
  e := expensive_procedure(R.c);
  ...
END LOOP; 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-04-24T13:20:06.783

我们尝试过的解决方案的关键问题之一是如何调整生成 SQL 的应用程序以正确构建查询。构建的 SQL 在检索的列数、where 子句中条件的数量和类型以及 order by 中表达式的数量和类型方面会有所不同。

返回用于连接到外部的 ROWID 的内联视图是我们可以使用的几乎完全通用的解决方案，除非搜索返回了大部分数据。在这种情况下，优化器会 [正确地] 确定 HASH 连接比 NESTED LOOP 便宜。

另一个问题是涉及的一些对象是不能有 ROWID 的 VIEW。

有关信息：“D”不是错字。不选择 order by 的表达式作为返回值的一部分。不是什么不寻常的事情：

```
select index_name, column_name
from user_ind_columns
where table_name = 'TABLE_OF_INTEREST'
order by index_name, column_position; 
```

在这里，您不需要知道 column_position，但按它排序很关键。

我们有理由（我们不会让读者感到厌烦）避免在解决方案中需要提示，但看起来这是不可能的。

感谢迄今为止的建议 - 我们已经尝试了其中的大部分......

# java - Spring中的线程

> ID：782470
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-04-23T16:17:28.537
> 
>         
> 
> 标签：java, multithreading, spring, tomcat, thread-local

我有一个使用 spring、hibernate 和 struts 的 Web 应用程序（它在 Tomcat 上运行）

调用顺序是这样的......

Struts 动作调用 spring 服务 bean，后者又调用 Spring DAO bean。DAO 实现是一个 Hibernate 实现。

**问题是**
我所有的 spring bean 会在同一个线程中运行吗？我可以在 ThreadLocal 中存储一些东西并在另一个 bean 中获取它吗？

我很确定这在无状态会话 Bean 中不起作用。EJB 容器可以（或将）为会话 bean 的每次调用生成一个新线程

**弹簧容器会做同样的事情吗？即在同一个线程中运行所有bean？**

当我尝试 JUnit 测试时——我通过测试用例中的 Thread.currentThread().getId() 和两个 bean 获得了相同的 id——这让我相信只有一个线程在运行

还是行为不可预测？或者在Tomcat服务器上运行时会改变吗？

**澄清**
我不希望在两个线程之间交换数据。我想将数据放入 ThreadLocal 并能够从调用堆栈中的所有 bean 中检索它。这只有在所有 bean 都在同一个线程中时才有效

* * *

## 回答 #1

> 赞同：16
> 
>             
> 
> 时间：2009-04-23T16:29:20.053

Spring 不会产生线程。Tomcat 可以。Spring 只是为您创建和连接对象。

来自浏览器的每个请求都在一个请求中处理。处理请求的是 Tomcat。Tomcat 创建线程来处理请求。

假设您刚刚在 Spring 中创建了一个名为“X”的单例 bean。然后所有请求都使用同一个 X 实例。

Spring bean 并不存在于线程中。它们只是分配在堆上。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:33:11.417

> 我所有的春豆会在同一个线程中运行吗？我可以在 ThreadLocal 中存储一些东西并在另一个 bean 中获取它吗？AFAIK 对于您提到的组件（服务 bean、DAO bean - 我猜它们是普通的 spring bean），Spring 不会产生新线程。我不了解您的用例（即在两个线程之间交换数据）。

对于大多数 webapps，每个新请求都会产生一个新线程，如果您想在两个请求之间共享数据，您通常： - 使用 get/post 参数来传递数据 - 使用会话来共享数据

要回答您的问题，我很确定 spring 容器不会为大多数组件生成线程。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:27:34.780

是的，你可以这样做。相同的线程将用于执行您的操作，因此 ThreadLocal 将起作用。通常，相同的线程也用于无状态会话 bean，假设它在同一个应用服务器实例中运行。不过，我不会依赖于此，因为它可能取决于供应商。

我们使用这种技术来访问代码中任何地方的调用者身份。我们也使用会话 bean 和 jms，但在容器之间显式传递信息并在每个入口点设置 ThreadLocal。这样，bean（会话或 mdb）是否是本地的都没有关系。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-24T18:48:23.250

除了所有其他答案，我将添加以下内容：

通常切换线程的唯一原因是对并行性的某些要求。由于这通常不会在复杂性方面免费提供，因此通常会在发生这种情况时清楚地通知您。

在看似单线程的请求处理中切换线程实际上非常复杂。这通常只会发生在容器中的一个地方，这通常由接收来自外部客户端的请求的 tcp/ip 套接字读取器处理。这些读取器线程通常确定哪个线程（池）应该处理请求并将请求转发到该线程。之后，请求将保留在该线程中。

所以通常唯一会/可能发生的事情是为并行或异步处理（如 JMS）创建额外的线程。

# c# - 如何声明事件处理程序以传递 FxCop 规则，特别是关于包括 sender 和 e？

> ID：782475
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T16:18:33.167
> 
>         
> 
> 标签：c#, asp.net, fxcop

FxCop 抱怨我有一个事件处理程序声明。尽管多次阅读警告，但我看不出代码有什么问题。

我的用户控件中的代码

```
//This next line Fx Cops doesn't like.
public event ImageClickEventHandler NewEntity; //A thingy defined in the BCL

private void ImgBtnAdd_Click(object sender, ImageClickEventArgs e)
{
     NewEntity(sender, e);
} 
```

Page 中使用控件的代码

```
protected override void OnInit(EventArgs e)
{
EntitySearch1.NewEntity += EntitySearch1_NewEntity;
//etc.
} 
```

但 FxCop 说：

按照惯例，.NET 事件有两个参数来指定事件发送者和事件数据。事件处理程序签名应遵循以下形式：void MyEventHandler(object sender, EventArgs e)。'sender' 参数始终是 System.Object 类型，即使可以使用更具体的类型。“e”参数始终是 System.EventArgs 类型。不提供事件数据的事件应使用 System.EventHandler 委托类型。事件处理程序返回 void，以便它们可以将每个事件发送到多个目标方法。目标返回的任何值在第一次调用后都会丢失。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:32:17.283

对我来说看起来很假 - 'e' 参数当然*并不*总是如此`EventArgs`；它只是传统*上派生自`EventArgs`*.

`ImageClickEventArgs`派生自`EventArgs`，所以这对我来说很好。我怀疑它的 FxCop 比它应该的更严格一些。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2011-07-12T13:45:20.357

[根据这篇 msdn 文章](http://msdn.microsoft.com/en-us/library/ms182178%28v=VS.100%29.aspx)，FxCop 希望您指定*EventHandler<ImageClickEventArgs>*

# sql - PLS-00306：调用中的参数数量或类型错误

> ID：782476
> 
>         
> 
> 赞同：-1
> 
>         
> 
> 时间：2009-04-23T16:18:35.193
> 
>         
> 
> 标签：sql, stored-procedures, plsql

谁能帮我解决这个错误。当我尝试第一个程序时它可以工作，但当我输入两个数字时它不能工作。有任何想法吗？

```
create or replace package LE2_P1
is
procedure GENERATE_MULTIPLICATION_TABLE(p_axis_both in number);
procedure GENERATE_MUTLIPLICATION_TABLE(p_axis_x in number, p_axis_y in number);
end LE2_P1;
/

create or replace package body LE2_P1
as
procedure GENERATE_MULTIPLICATION_TABLE(p_axis_both in number)
is
bb number := 1;
eb number := p_axis_both;
begin
for xyz in 1 .. eb loop
for xyx in 1 .. eb loop
dbms_output.put(CHR(9) || to_char(xyz * (bb + xyx - 1)));
end loop;
dbms_output.put_line(CHR(13) || CHR(10));
end loop;
end GENERATE_MULTIPLICATION_TABLE;
procedure GENERATE_MUTLIPLICATION_TABLE(p_axis_x in number, p_axis_y in number)
is
bb number := p_axis_x;
eb number:= p_axis_y;
begin
for xyz in 1 .. eb loop
for xyx in 1 .. eb loop
dbms_output.put(CHR(9) || to_char(xyz * (bb + xyx - 1)));
end loop;
dbms_output.put_line(CHR(13) || CHR(10));
end loop;
end GENERATE_MUTLIPLICATION_TABLE;

end LE2_P1;
/

declare
x number := 5;
y number := 3;
begin
LE2_P1.GENERATE_MULTIPLICATION_TABLE(x,y);
end;
/
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:21:33.673

带有两个参数名称的过程拼写错误：MU **TL** IPLICATION

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2010-12-11T10:23:19.817

OracleParameter[] pr=新的 OracleParameter[20]; pr[1]=new OracleParameter("IN_BILL_COMPCD_C",OracleType.VarChar); pr[1].Value=IN_BILL_COMPCD_C; pr[1]=new OracleParameter("IN_BILL_BRCD_C",OracleType.VarChar); pr[1].Value=IN_BILL_BRCD_C;

两个参数传入单个值。这就是为什么会出现这个错误。

# asp.net-membership - 处理与多个会员提供商的身份验证

> ID：782480
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T16:19:51.120
> 
>         
> 
> 标签：asp.net-membership

我有一个 Web 应用程序使用自定义成员资格提供程序来访问管理和库存页面，每个页面都在一个单独的文件夹中，用于来自不同数据库表的不同用户（因此是自定义成员资格提供程序）。

根目录和其他文件夹中还有其他页面供访客访问。

我在根目录中有一个管理员和库存部分的登录表单，它调用适当的成员资格提供程序进行身份验证，并在成功登录后重定向到相应的页面。

由于我可以在 Web 配置中有 1 个身份验证表单条目，我如何设置应用程序以发送到正确的登录表单？（如 httpApplication.Authorize 事件）

我的第一个想法是有一个 HttpModule 来检查路径，如果库存或管理文件夹在路径中并且用户未经过身份验证，则将用户重定向到登录页面。

这是最好的方法吗？还有其他方法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-07-29T21:15:53.960

您可以在每个受保护的文件夹中有一个 web.config 文件，每个文件夹都引用自己的登录页面和成员资格提供程序。这比尝试决定在单个表单上使用哪个提供者要简单得多。

# php - 这个 sql 查询有什么问题？

> ID：782488
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T16:22:42.110
> 
>         
> 
> 标签：php, sql, mysql

好的，我在 PHP 中有两个变量

```
$username;
$password; 
```

它们被初始化为从 $_POST 变量中检索到的数据:)

我有这个 SQL 查询

```
$sql = "SELECT * FROM users WHERE username = '" . $username . "' AND password = '" . $password . "')"; 
```

但这不起作用并且什么也没给我:(

你能指导我正确的方向吗？请？

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-04-23T16:25:02.357

该查询无缘无故地在末尾有一个右括号，它将不起作用。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-04-23T16:24:34.603

它出什么问题了？

不幸的是，一切。特别是它容易受到 SQL 注入攻击。

如果那是逐字剪切和粘贴，那么它实际上不起作用的原因是结尾的右括号。大概你打电话时没有检查错误？

使用基本的 MySQL API 它应该是：

```
$sth = $db->prepare("SELECT COUNT(*) FROM users WHERE username = ? AND password = ?");
$sth->execute($username, $password);
list($count) = $sth->fetchrow();
$authorized = ($count > 0); 
```

或类似的（未经测试的代码、E&OE 等...）

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T16:24:29.393

哎呀！sql注入为一！

编辑：[你最喜欢的“程序员”卡通片是什么？](https://stackoverflow.com/questions/84556/whats-your-favorite-programmer-cartoon/84629#84629)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:25:28.110

为什么在您的查询末尾有一个杂散的 ) ？它不应该在那里。

哦，第三次是关于 SQL 注入。坏的。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:25:29.530

您的查询字符串末尾似乎有多余的右括号。

[编辑] - 对于那些尖叫的 SQL 注入攻击：在查询中使用它们之前，我们不知道用户对他们的变量做了什么。怀疑的好处怎么样？;-)

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:26:02.383

首先，永远，*永远*不要这样做。请阅读有关[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)的信息，并且在您理解它所说的内容之前不要编写任何 SQL。对不起，但这真的很重要。

也就是说，您的查询包含一个右括号。这看起来像一个语法错误。执行它时是否出错？

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:26:43.520

查询的右侧有一个额外的括号。

此外，如果你没有正确清理你的代码，你将很容易受到 SQL 注入的攻击。您确实应该使用参数化查询，但至少使用[`mysql_real_escape_string()`](http://us.php.net/mysql_real_escape_string)on`$username`和来代替`$password`。

此外，作为一个幽灵调试，您的密码很可能是数据库中的 MD5 散列，因为您永远不应该将它们存储为纯文本。

尝试：

```
$username = mysql_real_escape_string($_POST["username"]);
$password = md5($_POST["password"]);

$sql = "SELECT * FROM users WHERE username = '$username' AND password = '$password'"; 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:28:00.303

除了指出的所有其他问题。用户表中的密码是加密存储的。除非您通过 MySQL 密码加密器运行密码，否则您将永远不会看到来自此查询的任何数据，因为密码将不匹配。

# xml - 从 SharePoint Web Services 查询列表数据

> ID：782496
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T16:24:12.187
> 
>         
> 
> 标签：xml, web-services, sharepoint, caml

有没有人使用 http:///_vti_bin/lists.asmx 服务中的 GetListItems() 方法成功地编写代码从 SharePoint 2007 列表（特别是 InfoPath 表单库）中提取数据（并且活着告诉它）？它返回了我一生中见过的一些**最糟糕的 XML（它甚至不是兼容的 XML）。**有没有一些简单的方法来解析 C# 中的数据，还是我需要手动解析它？

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T21:57:14.820

当然，这不是最漂亮的做事方式，但它只是获得正确示例的问题。

我使用以下代码从获取列表查询中获取“东西”。

```
public static XmlNodeList XpathQuery(XmlNode xmlToQuery, string xPathQuery)
{
    XmlDocument doc = new XmlDocument();
    doc.LoadXml(xmlToQuery.OuterXml);
    XmlNamespaceManager mg = new XmlNamespaceManager(doc.NameTable);
    mg.AddNamespace("sp", "http://schemas.microsoft.com/sharepoint/soap/");
    mg.AddNamespace("z", "#RowsetSchema");                                   
    mg.AddNamespace("rs", "urn:schemas-microsoft-com:rowset");
    mg.AddNamespace("y", "http://schemas.microsoft.com/sharepoint/soap/ois");
    mg.AddNamespace("w", "http://schemas.microsoft.com/WebPart/v2");
    mg.AddNamespace("d", "http://schemas.microsoft.com/sharepoint/soap/directory");
    return doc.SelectNodes(xPathQuery, mg);
} 
```

调用它使用

```
 XmlNode items = lists.GetListItems(listName, string.Empty, listQuery, listViewFields, string.Empty, listQueryOptions, g.ToString());
    foreach (XmlNode listItem in SPCollection.XpathQuery(items, "//sp:listitems/rs:data/z:row"))
    {
        XmlAttribute id = listItem.Attributes["ows_Id"];
        if (id != null)
        {
            pageId = id.Value;                    
        }

    } 
```

该示例并没有做很多事情，但希望它能让您了解如何获取数据。是的，我非常不喜欢 XPathQueries 的整个命名空间问题，但你会怎么做。

我只是对重写 SharePoint Web 服务不感兴趣，尤其是在我们的环境中进行测试和发布本身就需要花费数周的时间。但有时，别无选择。例如，如果您想访问 SPWeb 的自定义属性包或使用特定的站点模板和内容数据库（或任何其他未在 Web 服务中实现的数百万事物）创建 SiteCollection。但是，对于简单的列表访问，Web 服务似乎还不错。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:38:46.577

InfoPath 无法处理来自 Lists Web 服务中的 GetListItems 的 XML。使用 InfoPath 2007，您有两种选择：

1.  使用不允许过滤列表内容的 InfoPath 2007 SharePoint 数据连接。您必须将所有内容抓取回客户端（或服务器，如果它是 InfoPath Forms Services），然后在 InfoPath 规则中对其进行过滤。

2.  编写一个驻留在 SharePoint 中的 Web 服务，它以 InfoPath 2007 可以消化的格式返回数据。我之前已经这样做了，您可以将列表名称和 CAML 查询以及一组字段传递给它，它将返回名称/值对的行。不幸的是，我目前不允许共享此代码。

# wpf - 为什么我的 TypeConverter 没有被调用？

> ID：782498
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T16:24:18.940
> 
>         
> 
> 标签：wpf, typeconverter

我已将 TypeConverterAttribute 属性应用于我的 WPF FrameworkElement 子类的属性。该属性的类型为 BitmapSource。

但是从未创建或调用 TypeConverter。这是因为 ImageSource 上指定的 TypeConverter 优先吗？

我正在尝试调试数据绑定问题。错误消息从未提及我的 TypeConverter 类，表明将属性添加到属性没有效果：

```
System.Windows.Data Error: 6 : 'TargetDefaultValueConverter' converter failed to convert value '../SmallItemIcons/Gallery.png' (type 'String'); fallback value will be used, if available. BindingExpression:Path=SmallImage.ImageUri; DataItem='ItemSettings' (HashCode=32104365); target element is 'Bitmap' (Name=''); target property is 'Source' (type 'BitmapSource') IOException:'System.IO.IOException: Cannot locate resource 'smallitemicons/gallery.png'.
   at MS.Internal.AppModel.ResourcePart.GetStreamCore(FileMode mode, FileAccess access)
   at System.IO.Packaging.PackagePart.GetStream(FileMode mode, FileAccess access)
   at System.IO.Packaging.PackWebResponse.CachedResponse.GetResponseStream()
   at System.IO.Packaging.PackWebResponse.GetResponseStream()
   at System.IO.Packaging.PackWebResponse.get_ContentType()
   at System.Windows.Media.Imaging.BitmapDecoder.SetupDecoderFromUriOrStream(Uri uri, Stream stream, BitmapCacheOption cacheOption, Guid& clsId, Boolean& isOriginalWritable, Stream& uriStream, UnmanagedMemoryStream& unmanagedMemoryStream, SafeFileHandle& safeFilehandle)
   at System.Windows.Media.Imaging.BitmapDecoder.CreateFromUriOrStream(Uri baseUri, Uri uri, Stream stream, BitmapCreateOptions createOptions, BitmapCacheOption cacheOption, RequestCachePolicy uriCachePolicy, Boolean insertInDecoderCache)
   at System.Windows.Media.Imaging.BitmapFrame.CreateFromUriOrStream(Uri baseUri, Uri uri, Stream stream, BitmapCreateOptions createOptions, BitmapCacheOption cacheOption, RequestCachePolicy uriCachePolicy)
   at System.Windows.Media.ImageSourceConverter.ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, Object value)
   at MS.Internal.Data.DefaultValueConverter.ConvertHelper(Object o, Type destinationType, DependencyObject targetElement, CultureInfo culture, Boolean isForward)
   at MS.Internal.Data.TargetDefaultValueConverter.Convert(Object o, Type type, Object parameter, CultureInfo culture)
   at System.Windows.Data.BindingExpression.ConvertHelper(IValueConverter converter, Object value, Type targetType, Object parameter, CultureInfo culture)' 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T18:45:18.290

我之前遇到过这个问题并忽略了它，因为我拥有拥有正在转换的班级的奢侈。但是，我刚刚尝试过，可以确认[根据 MSDN](http://msdn.microsoft.com/en-us/library/aa970913.aspx#Applying_the_TypeConverterAttribute)它*应该可以*工作。也就是说，它肯定似乎*不起作用*。

我在[WPF Disciples 论坛](http://groups.google.com/group/wpf-disciples/browse_thread/thread/9f7bb40b7413fcd)上提出了这个问题，我还提供了一种解决方法。

* * *

## 回答 #2

> 赞同：-2
> 
>             
> 
> 时间：2009-04-23T16:28:39.913

您必须在 xaml 中创建转换对象才能在绑定中使用它。看看[这篇文章](http://learnwpf.com/Posts/Post.aspx?postId=05229e33-fcd4-44d5-9982-a002f2250a64)

```
<local:MyConverter key="myconverterorsomething"/>

<TextBlock Text="{Binding Path=TimeOfSale, 
  Converter={StaticResource myconverterorsomething}, 
  ConverterParameter=' \{0:dd-MMM-yyyy hh:mm\}'}" /> 
```

# physics - 获取 PhysX 轮的位置

> ID：782500
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T16:24:32.823
> 
>         
> 
> 标签：physics, nvidia, shape, physx

我正在使用 NxWheelShape 来模拟我车上的车轮。当我渲染车轮模型时，我使用 shape->getGlobalPose() 来获取一个 4x4 矩阵并在那里渲染车轮。然而，这给了我形状的位置，而不是投射光线撞击其他几何体的位置，所以即使汽车表现正常，车轮也是静止的（甚至不旋转）。获取车轮位置的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:53:03.210

找到了。应该使用 shape->getContact(MyContactDesc); MyContactDesc.contactPosition 是沿 Y- 射线击中物体的距离。

# vim - Vim 中的大小写保留替换

> ID：782511
> 
>         
> 
> 赞同：171
> 
>         
> 
> 时间：2009-04-23T16:26:22.820
> 
>         
> 
> 标签：vim, replace

[这](https://stackoverflow.com/questions/367052/case-preserving-find-replace-in-visual-studio)可以在 Vim 中完成吗？

> 我的意思是：搜索“BadJob”并替换为“GoodJob”将执行以下替换
> 
> ```
> 'badjob' -> 'goodjob'  
> 'BadJob' -> 'GoodJob'  
> 'badJob' -> 'goodJob'  
> 'BADJOB' -> 'GOODJOB' 
> ```

* * *

## 回答 #1

> 赞同：141
> 
>             
> 
> 时间：2014-04-17T22:59:21.273

使用[abolish.vim](https://github.com/tpope/vim-abolish)：

```
:%S/badjob/goodjob/g 
```

* * *

## 回答 #2

> 赞同：28
> 
>             
> 
> 时间：2009-04-23T16:44:52.840

我不知道这是否是您正在寻找的那种解决方案......但我用过这个：
 [keepcase.vim](http://www.vim.org/scripts/script.php?script_id=6)

vim 中没有其他支持...

* * *

## 回答 #3

> 赞同：12
> 
>             
> 
> 时间：2009-04-23T16:54:13.330

你当然可以

`:s/\cbad/\= strpart(submatch(0), 0 ,1) == toupper(strpart(submatch(0), 0, 1)) ? "GOOD" : "good"/`

附言。我猜keepcase.vim封装了一些类似的逻辑:)

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2015-06-06T15:26:54.763

你可以粘贴并修改它：（

[当然，如果你不时这样做，你会想要一个插件而不是这个怪物。但对于一些赶时间并且只需要一次的人来说，这是一个快速破解为了您的粘贴乐趣:)]

`:%s/\cbad\zejob/\= ( submatch(0)[0] is# toupper(submatch(0)[0]) ? 'G' : 'g' ) . ( submatch(0)[1] is# toupper(submatch(0)[1]) ? 'OOD' : 'ood' )` 

除了搜索模式之外，您还必须编辑替换代码中的四个`'`字符串： 编辑**粗体**部分：`'`

 **> :%s/\c **bad** \ze **job** /\= 
> 
>   ( submatch(0)[0] is# toupper(submatch(0)[0]) ? ' **G** ' : ' **g** ' ) 。
> 
>   ( submatch(0)[1] is# toupper(submatch(0)[1]) ? ' **OOD** ' : ' **ood** ' )

*不要使用这个“橙色”版本进行粘贴，因为它的换行符也会破坏命令。*

[`/\ze`](http://vimdoc.sourceforge.net/htmldoc/pattern.html#/%5Cze)是 vim 正则表达式语法糖，用于标记积极的前瞻：`\ze`检查后的模式，但不替换。

*`is#`*?? 让我解释一下……（如果有兴趣。）

`#`（也在 in `==#`and [others](http://vimdoc.sourceforge.net/htmldoc/eval.html#expr-is)中）强制区分大小写。否则，使用`:set ignorecase`（我使用它，因为这是有用的[`:set smartcase`](http://vimdoc.sourceforge.net/htmldoc/options.html#'smartcase')），vim 会考虑`'a' == 'A'`!! 

![](https://i.stack.imgur.com/99eI5.jpg) ![](https://i.stack.imgur.com/UE9qp.jpg) ![](https://i.stack.imgur.com/Zeij0.jpg)

尽管它很疯狂，但我们真的应该解释它：因为它依赖于用户设置，**`==`所以应该使用 NEVAR！**  （除非这实际上是你想要的。）我什至会遵循`==#`比较整数时使用的建议：http: [//learnvimscriptthehardway.stevelosh.com/chapters/22.html#code-defensively](http://learnvimscriptthehardway.stevelosh.com/chapters/22.html#code-defensively)

[`is#`](http://vimdoc.sourceforge.net/htmldoc/eval.html#E694)而不是`==#`另一种防御性编码方式：它提高了类型安全性：http:   [//google.github.io/styleguide/vimscriptguide.xml](http://google.github.io/styleguide/vimscriptguide.xml?showone=Type_checking#Type_checking)
 ?showone=Type_checking#Type_checking
它应该在与字符串文字比较时使用。

`'single-quoted'`而不是`"double quoted"` [字符串](http://vimdoc.sourceforge.net/htmldoc/eval.html#expr-string)是另一个好习惯： http: [//google.github.io/styleguide/vimscriptguide.xml ?showone=Strings#Strings](http://google.github.io/styleguide/vimscriptguide.xml?showone=Strings#Strings)

[HT @fc。- 这个答案建立在他们的答案之上[，](https://stackoverflow.com/questions/782511/case-preserving-substitute-in-vim/782617#782617)修正了一些缺点。]

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2018-03-01T14:40:09.910

如果您只匹配具有几个可能的大写字母的精确（不区分大小写）字符串，则另一种可能性是：

```
:s/abc/\={'abc':'xyz','Abc':'Xyz'}[submatch(0)]/i 
```

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2013-05-06T06:57:29.080

*keepcase*插件的一个替代方案是[SmartCase——在保持原始大小写的同时替换单词](http://www.vim.org/scripts/script.php?script_id=1359)。（不要让自己因糟糕的收视率而气馁。）

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2021-01-27T12:20:47.760

关于什么

```
:%s/\Cbadjob/goodjob/
:%s/\CBadJob/GoodJob/
:%s/\CbadJob/goodJob/  
:%s/\CBADJOB/GOODJOB/ 
```

请参阅：[https ://stackoverflow.com/a/2287449/5599687](https://stackoverflow.com/a/2287449/5599687)

# ruby-on-rails - Rails：根据相关数据库记录组生成表

> ID：782513
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T16:26:59.620
> 
>         
> 
> 标签：ruby-on-rails, ruby, group-by, grouping

我的数据库中有一组记录，我想根据记录日期将其打印到单独的表中。

所以我已经有了以下内容（在 Haml 中，仅供参考）：

```
%table
  %tr
    %th Name
    %th Type
    %th Total Hits
  - for record in @records
    %tr{ :class => cycle('odd','even') }
      %td= record.name
      %td= record.target_type
      %td= record.outbound + record.detail + record.custom + record.dynamic 
```

目前，它在同一张表中显示我的所有记录。`record.recorded_on`包含我的记录日期。我想为包含当天所有记录的每一天生成单独的表格，如上面的表格。

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T16:49:26.430

假设`recorded_on`是日期，而不是 DateTime：

```
@records = Record.all.group_by(&:recorded_on) 
```

如果是日期时间：

```
@records = Record.all.group_by { |record| record.recorded_on.to_date } 
```

现在`@records`包含一些嵌套数组。将您的表 haml 粘贴在一个名为`_record_table.html.haml`. 请务必更改`@records`为局部变量`records`，以便可以为每个部分渲染换出它。

现在您的 haml 模板如下所示：

```
- @records.each do |records_for_one_day|
  = render :partial => 'render_table', :locals => { :records => records_for_one_day } 
```

# c# - 根据定义加载游戏对象

> ID：782516
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T16:27:40.900
> 
>         
> 
> 标签：c#

我想从定义文件 (XML) 加载游戏对象，然后在游戏中使用准备好的属性（如武器、纹理、最大速度、视线范围等）创建它们。我想到了 IClonable 接口，但看起来很奇怪。我还需要区分单位（士兵、车辆可能是飞机）和建筑物。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:41:43.470

听起来您想要一个可以调用特定工厂的通用工厂。通用工厂获取定义文件并确定对象的通用类型“武器、单位、建筑”。然后它将 DOM 树传递给该类型的特定工厂。武器工厂知道如何在系统中制造所有不同的武器。并且它将 DOM 树传递给武器的构造函数，因此构造函数可以使用所有细节。

您如何编写这些工厂取决于您的 XML 的外观以及您真正希望它的“自动化”程度。您需要提供更多细节才能获得更具体的答案。

编辑：现在我明白了。您希望将 XML 文件用作将来创建对象的模板。你想要一个通用的“车辆”对象。您为“helicopter”加载了 XML 文件，它创建了一个新的“vehicle”“类”，而没有实际创建一个类，对吧？

因此，您创建了一个所有车辆都来自的车辆“类”。然后，您创建一个所有模板都源自的车辆模板“类”。XML 用于实例化模板类。模板类用于实例化实际对象。

```
class vehicle_template {
     vechicle_template(xmlstreamthing x);
     // properties found in vehicles, set from xml
};
class vehicle {
     vechicle(vehicle_template v);
     // properties vehicles have, taken from template
};
vehicle vehicle_factory(string s) {
    static map<string,vehicle_template> already_loaded;
    vehicle_template vt = already_loaded.find(s);
    if (vt == null) {
        xmlstreamthing xml = get_xml_from_object_name(s); // you need to figure this part out
        if (xml == null) {
            throw no_such_vehicle(s);
        }
        vt = new vehicle_template(xml);
        already_loaded.add(s,v);
    }
    return new vehicle(vt);
} 
```

显然这不是可运行的代码，但它应该让你开始。

我不知道您将如何让这些对象表现出不同的行为，但这应该可以解决您的加载问题。也许您需要一种鸭子类型的语言，您可以在其中在运行时向对象添加方法。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:42:43.140

[不要实施`IClonable`](http://blogs.msdn.com/brada/archive/2004/05/03/125427.aspx). 它不区分浅拷贝和深拷贝。

我认为您想要的是[Factory Pattern](http://www.dofactory.com/Patterns/PatternFactory.aspx)。

# jquery - IE 没有触发 jQuery Ajax 成功

> ID：782532
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2009-04-23T16:32:59.530
> 
>         
> 
> 标签：jquery, ajax, internet-explorer

我正在编写一个脚本来使用 jQuery 异步加载一些图像。

这是加载图像的函数的代码片段 -

```
try{
    for(img in imgsArray){
        $.ajax({    
            async: false,
            type: "get",
            url:imgsArray[img],
            success:function(imgFile){
                alert("success");
                //do something useful
            },
            error:function(XMLHttpRequest,status,error){
                //do nothing
            }
        });//ajax
    } 
}
catch(e){
    //oops
} 
```

我已经在 Firefox、Webkit（Safari、Chrome）中对此进行了测试，并且可以正常工作。

这些图像位于服务器上的一个文件夹中，我使用的是 jQuery 1.3。

有任何想法吗？

* * *

## 回答 #1

> 赞同：17
> 
>             
> 
> 时间：2011-07-01T09:45:09.623

解决此问题的一个简单方法是提供 jQuery 设置`dataType : 'text'`或`dataType : 'xml'`或`dataType : 'json'`或任何其他可用的响应类型。

我有同样的问题，但在 .ajax 调用中指定 dataType 设置后它工作正常。

IE 真的不是一个智能浏览器，它不假定默认值字符串。

试试看……祝你好运。

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2011-09-28T14:43:05.463

尝试将缓存选项设置为 false。

```
 $.ajax({        
            async: false,
            cache: false, 
            type: "get",
            url:imgsArray[img],
            success:function(imgFile){
                    alert("success");
                    //do something useful
                    },
                    error:function(XMLHttpRequest,status,error){
                    //do nothing
            }
    });//ajax 
```

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2009-07-13T19:19:49.887

我遇到了类似的问题——如果 IE 无法将响应解析为 xml，即使请求成功，它也会触发失败，因此，例如，如果您请求图像，它将返回 xhr.status错误块中的 200。

我将我的“成功”功能固定在 FF 的成功块中，以及包装在“if (xhr.status == 200)”条件下的错误块中。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2013-07-31T10:17:21.997

使用以下标签支持跨浏览器

$.support.cors = 真；

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-24T02:24:16.800

在过去的几天里，我在使用 JSONP Web 服务时遇到了类似的 IE 和 AJAX 问题。即使是代码中最小的错误也可能导致 IE 中的所有内容中断。

最好的办法可能是使用 Visual Web Developer Express 或 Visual Studio 在 IE 中调试页面。这是一个如何做到这一点的教程：

[如何使用 Visual Web Developer Express 调试 JavaScript](http://www.berniecode.com/blog/2007/03/08/how-to-debug-javascript-with-visual-web-developer-express/)

按照说明进行操作，并可能在 AJAX 请求的开头放置断点。

也试试这些：  

*   从错误字段中删除“XMLHttpRequest”，我以前从未使用过它，我的代码工作得很好；

*   确保您使用的是最新版本的 jquery (1.3.2)？

希望你能尽快让它工作！

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-04-28T07:26:31.953

最后我不得不为 IE 浏览器创建一个单独的函数。

目标是在某个位置测试图像，因此代码看起来像 -

```
 //get the images from the array
for(img in imgsArray){  

    if($.browser.msie){     
    /* DOM manipulation method */
    //IE has problems with ajax so try this instead
    //create a new image object with unique ID
    var testImg = $("<img/>");
    var imgID = "imgID"+img;

    //hide it..
    testImg .css({ "visibility":"hidden" });
    testImg .attr("src",imgsArray[img]);
    testImg .attr("id",imgID);

    //.. and insert it into the DOM or else test will always fail
    //because it does not exist as far as browser is concerned
    $("body").append(testImg );

    //test for image
    if(document.getElementById(imgID).width > 60){
        //do something useful
    }
} 
```

这不是我问题的真正答案，但它是一种功能性的解决方法。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2013-09-12T07:54:03.463

在 .ajax 配置中设置 'cache: false' 对我有用 :)

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:54:43.110

我建议使用[Charles Proxy](http://www.charlesproxy.com/)查看发生了什么 - 即请求是否发出？有什么反应？

另外，我认为可能会抛出一些异常，那么为什么不在 Catch 部分添加一些警报，看看会发生什么？

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2013-09-21T19:00:09.480

如果你成功是：

```
Success: function (data) {
                    if (data != null) {
                        alert(data);
                       ;
                    }
                }, 
```

为此改变：

```
 success: function (data, textStatus, XMLHttpRequest) {
                alert(data.d);
            } 
```

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2014-07-09T19:09:21.560

您可以尝试的另一件事，与 John Saunders 的解决方案非常相似，是尝试将“jsonp”作为内容类型，而不是 json - 对于 json 数据类型的预期响应。我不得不在 IE 上尝试这个以消除我的错误，这是在除 IE 之外的所有其他浏览器中工作的正常代码。

这是我的有效代码：

```
$.ajax({
    url: request_url,
    data: { var1: 'stuff' },
    dataType: "jsonp",
    type: "get",
    async: true,
    cache: false,
    success: function(collections) {
         // handle result
    }
}); 
```

干杯。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2016-10-21T20:14:48.750

我带着类似的问题来到了这个问题。上面的答案解决了我的许多问题。但是，我还需要做一个技巧。不要使用

```
$.ajax({...,
success: myfunc,...}); 
```

采用

```
$.ajax({...,
success: myfunc(),...}); 
```

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2020-05-17T10:50:06.750

可能编码有问题。试试这个

```
$.ajax({
        type: 'GET',
        url: encodeURI(url ),
        dataType: 'text',
        success: function (data) {
                            result = JSON.parse(JSON.parse(data))
                                                }
       }); 
```

* * *

## 回答 #13

> 赞同：-1
> 
>             
> 
> 时间：2012-07-02T16:39:35.263

如果您使用输入，请检查您是否有一个选择为“已选择”，如果您没有，即不要将此参数传递给 ajax 函数。

# .net - 在 VSTO Excel 项目中创建弹出日历

> ID：782537
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T16:35:02.457
> 
>         
> 
> 标签：.net, vb.net, winforms, excel, vsto

我正在尝试在 VSTO Excel 工作簿中使用 System.Windows.Forms.MonthCalendar 控件。当我单击功能区中的按钮时，我希望 MonthCalendar 弹出，但到目前为止我根本无法显示控件。

```
Private Sub DeliveryDateFromCalendarButton_Click(ByVal sender As System.Object, ByVal e As Microsoft.Office.Tools.Ribbon.RibbonControlEventArgs) Handles DeliveryDateFromCalendarButton.Click
    Dim selectedFiscalYear As String = Me.FiscalYearDropDown.SelectedItem.Label
    Dim cal As System.Windows.Forms.MonthCalendar = New System.Windows.Forms.MonthCalendar()

    cal.Location = New System.Drawing.Point(Cursor.Position.X, Cursor.Position.Y)
    cal.Show()
End Sub 
```

日历应该会在他们点击的地方弹出，但是很遗憾，它失败了。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-07-28T23:24:41.730

我很确定您需要一个表单来托管 winforms 控件。如果您的目标是“仅”显示日历控件，那么父窗口会是什么？

如果您想要一个足够简单的日历控件的“外观”，只需调整表单的 UI 属性，使其没有可见边框、模式等，如果您在 WPF 中重写，那么您的表单甚至没有必须看起来像一个形式（即正方形等）

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-27T20:04:37.130

我最终创建了一个新的 System.Windows.Form 并将我的日历添加到它的 Controls 集合中。

不理想，所以我仍在寻找解决方案，但它至少让我有一个弹出日历。

# database - 规范一个人的名字是否太过分了？

> ID：782540
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2009-04-23T16:35:44.640
> 
>         
> 
> 标签：database, normalization

您通常对数据库进行规范化以避免数据冗余。在充满名称的表中很容易看出存在大量冗余。如果你的目标是创建一个地球上每个人的名字目录（祝你好运），我可以看到标准化名字是多么有益。但在普通业务数据库的背景下，这是否矫枉过正？

（当然我知道你可以把任何事情做到极致……比如说，如果你归一化为音节……甚至是相邻的字符对。我看不出走那么远有什么好处）

更新：

一个可能的理由是随机名称生成器。这就是我能想到的。

* * *

## 回答 #1

> 赞同：54
> 
>             
> 
> 时间：2009-04-23T16:39:18.063

是的，这是矫枉过正。

人们不会一下子`Bill`就改名。`Joe`

* * *

## 回答 #2

> 赞同：35
> 
>             
> 
> 时间：2009-04-23T16:40:46.827

数据库规范化通常是指规范化字段，而不是其内容。换句话说，您将规范化数据库中只有一个名字字段。这通常是值得的。然而，数据内容不应该被规范化，因为它对那个人来说是个人的——你不是从一个列表中挑选的，你也没有在一个地方改变一个列表来影响每个人——这将是一个错误，而不是一个特性。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-04-23T16:42:50.487

你如何规范一个名字？并非所有名称都具有相同的结构。并非所有国家或文化都使用相同的名称规则。名字不一定只是名字。人们有可变数量的名字。有些国家没有简单的名字/姓氏对。如果我的名字恰好是您的姓氏，在您的数据库中是否应该被视为相同？如果不是，那么您就会遇到一个问题，即姓氏在不同的国家可能意味着不同的东西。在我知道的大多数国家，这是一个姓氏。您的姓氏至少与您父母中的一个姓氏相同。在冰岛，它是你父亲的名字，后面跟着“儿子”或“女儿”。因此，相同的姓氏将意味着完全不同的东西，具体取决于您是否在冰岛和美国遇到它。

在某些文化中，妇女结婚时随丈夫姓是很常见的。在其他文化中，这完全是可选的，甚至可能以相反的方式工作。

你怎么能正常化呢？它会给你带来什么信息？如果你在你的数据库中发现某人的名字最后一个词是“Smith”，这告诉你什么？这可能不是他们的姓氏。它可能只是姓氏的*一部分。*这在某些语言中可能是一种荣誉，但根据他们的文化，这应该被视为名称的一部分。

只有当数据遵循通用结构时，您才能对其进行规范化。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2015-02-09T20:44:51.477

如果您需要基于小名称执行查询，我可以看到需要对名称进行规范化。例如，搜索“Betty”可能需要返回“Betty”、“Beth”和“Elizabeth”的结果

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:38:21.543

是的，绝对是矫枉过正。朋友之间的几十个字节是多少？

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:42:40.177

也许如果你在人口普查办公室工作，这可能是有道理的。否则，请参阅其他答案:)

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:38:10.157

我会说是的，在 95% 以上的情况下它走得太远了。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:38:33.010

一般是的。正常化到那个水平会很远。根据查询（例如通常按姓氏搜索的电话簿），这可能是值得的。我希望这种情况很少见。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:38:50.777

是的。我想不出一个好处超过问题和查询复杂性的例子。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:42:04.857

不，但您可能希望将客户规范化为规范记录（因此您的数据库中不会有 5 个不同的“Bloggs & Co.”条目。这是一个经常困扰 MIS 项目的数据清理问题。

* * *

## 回答 #11

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:45:03.133

您通常不会在数据库中进行第四种形式规范化。因此，第七形式规范化有点过分了。这甚至可能是一个遥不可及的想法的*唯一*地方是在某种大型数据仓库中。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:39:42.850

我通常没有看到需要对名称进行规范化，主要是因为这会增加连接的性能，而连接总是会被调用，并且没有任何好处。

如果您有这么多相似的名称，并且存在存储问题，那么这可能是值得的，但需要考虑性能损失。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:39:59.637

我会说这绝对是矫枉过正。在大多数应用程序中，您会经常显示人们的姓名，与之相关的每个查询都会看起来更加复杂和难以阅读。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:40:31.540

是的。人们普遍认为，仅仅应用所有规范化规则可能会导致您走得太远，最终得到一个过度规范化的数据库。例如，可以将每个字符的每个实例标准化为对字符枚举表的引用。很容易看出这很荒谬。

规范化需要在适合您的问题域的级别执行。过度规范化与规范化不足一样是一个问题（当然，出于不同的原因）。

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:43:51.670

在某些情况下，能够链接已婚/未婚姓名会很有用。

最近有一个案例，我不得不重命名数千封电子邮件作为交换，因为有人离婚并且不希望任何电子邮件将她列为married_name@company.com

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:53:39.057

除非名称构成复合主键并且您拥有依赖于其中一个名称的数据（例如，姓 Plummer 的任何人对数据库一无所知），否则无需规范化到该级别。在这种情况下，如果不进行规范化，您将违反[第二范式](http://infocenter.sybase.com/help/topic/com.sybase.dc20020_1251/html/databases/databases218.htm)。

* * *

## 回答 #17

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:11:17.470

我同意一般的反应，你不会那样做。

不过，我想到了一件事，压缩。如果你有 10 亿人，你发现 60% 的名字是从 5 个非常常见的名字中提取的，你可以使用一些棘手的位操作来显着减小大小。它还需要非常定制的数据库软件。

但这不是为了标准化，只是为了压缩。

* * *

## 回答 #18

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:20:31.630

如果您需要避免不破坏它带来的删除异常，您应该将其正常化。也就是说，如果您需要回答这个问题，我的数据库中是否曾经有一个名为“Joejimbobjake”的人，您需要避免异常。软删除可能比拥有一个全面的名字表（例如）要好得多，但你明白我的意思。

* * *

## 回答 #19

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T19:54:13.257

除了其他人提出的所有观点之外，请考虑如果您正在实施数据输入操作（例如），并且要插入新联系人，您将必须搜索您的名字和姓氏表以找到正确的Id，然后使用这些值。但是，当姓名不在 FN 和/或 LN 表上时，情况会变得更加复杂，那么您必须插入新的名字/姓氏并使用新的 ID。

如果你认为你有一个完整的名字列表，再想一想。我使用了超过 20 万个唯一名字的列表，我猜它代表了 99.9% 的美国人口。但那 0.1% = 很多人。不要忘记外国名字和拼写错误......

# javascript - 在表单提交按钮上呈现圆角的方法

> ID：782553
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T16:39:27.687
> 
>         
> 
> 标签：javascript, html, css, user-interface, rounded-corners

我正在寻找的是一种干净的方法，可以使用“提交”类来圆所有输入的角落。我已经尝试了许多 javascript 技术，但没有一个对表单元素效果很好。纯 CSS 会很棒，但是请注意，按钮需要展开，并且会有任意文本。其他方法需要在输入周围使用非常难看的 HTML，这是我不想要的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-07-30T10:16:12.897

尝试[使用 CurvyCorners](http://www.curvycorners.net/)（30,100 字节，缩小）作为此解决方案，因为 IE 浏览器不会使其四舍五入。我还没有尝试添加图像。

```
<style type="text/css">
.input-rounded-button {
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
    border: 1px solid gray;
    padding:0 3px 0 3px;
    display:inline-block;
    text-decoration:none;
    background:#595651;

    color:#FFFFFF;
    cursor:pointer;
    font:11px sans-serif;
}

.input-rounded-button:hover { 
    text-decoration:none; 
    color:#ADD8E6; 
    cursor:pointer;
    border:1px solid #FF2B06;
}
</style>

<input class="input-rounded-button" type="button" value="SEARCH" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:42:07.337

我用这个方法有一段时间了——

[http://www.oscaralexander.com/tutorials/how-to-make-sexy-buttons-with-css.html](http://www.oscaralexander.com/tutorials/how-to-make-sexy-buttons-with-css.html)

它工作得很好

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-07-30T11:13:47.600

也许这是您正在寻找的一种解决方法。虽然它不支持垂直缩放。（为什么你有多行提交按钮？）

[http://www.hedgerwow.com/360/dhtml/ui-css-input-replacement/demo.php](http://www.hedgerwow.com/360/dhtml/ui-css-input-replacement/demo.php)

它专门用于提交按钮并支持相当合理的浏览器范围。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2012-04-20T21:05:15.693

如果您能够使用 CSS3，我知道的最简单的方法就是这样做：

```
.button
{
  background-color:#f57070;
  border-radius: 10px;    //-rounding the edges, only available in CSS3-//
  font-family:arial;
  font-size:30px;
  text-decoration:none;
} 
```

使用html代码：

```
<a href=# class='button'>...</a> 
```

制作一个漂亮的带有圆边的红色按钮。

# javascript - Javascript Unix 纪元时间奇怪

> ID：782558
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T16:40:03.897
> 
>         
> 
> 标签：javascript, unix, datetime, time, epoch

我有一部分脚本可以计算事件的剩余天数：

```
var currTime = Math.round(new Date().getTime() / 1000.0);
var dispDate = event.find('UnixEpoch').text();
var diffDate = (dispDate - currTime) / 86400;
var dateRound = Math.round(diffDate) - 30; 
```

第一行获取当前的 Unix 纪元时间并减少毫秒数。第二行从 XML 提要中获取未来的事件日期。如果我将这两个时间都输入到在线大纪元计算器中，我会得到正确的 currTime 和 dispDate 日期。但是当我将它们划分为天数（第三行）时，最终的结果是超过 30 天，这要求我使用最后一行来获得正确的天数。

现在，这已经够奇怪了。但是还有其他事情我无法弄清楚。以前是31天，现在错了，所以我把剧本改成了30天，没错。

谁能指出我做错了什么？我一生都无法弄清楚为什么会发生这种情况，我宁愿不必继续调整它。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:46:13.880

从表面上看，代码看起来不错。

尝试在进行减法之前倾倒`currTime`和的值，`dispDate`看看它们是否一致。

您报告的错误表明某处代码的月份部分存在一个错误。这个月是30天，上个月是31天。错误的可能位置在`event.find('UnixEpoch')`调用中。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:58:11.087

事件日期是否正在由其他 Javascript 处理？如果使用该`new Date(year, month, day, etc...)`格式，月份是从零开始的，这很容易忘记。

# sql - SQL 查询的逗号分隔输出

> ID：782562
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T16:41:01.320
> 
>         
> 
> 标签：sql, csv

如何将 sql server 查询的结果转换为“逗号分隔”格式？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T16:47:23.130

您应该能够进入`Tools->Options->Query Results`SQL Server Management Studio 并在那里设置首选项以输出到文本文件。

然后展开它并在“结果到文本”中设置输出格式。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:43:42.030

在 MySQL 论坛上查看[这个答案。](http://forums.mysql.com/read.php?79,11324,13062#msg-13062)

这是片段。

```
SELECT a,b INTO OUTFILE '/tmp/result.text'
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
LINES TERMINATED BY '\n'
FROM test_table; 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:44:55.163

如果您使用的是 sql server managment studio，请右键单击输出，您可以“将结果另存为”CSV

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2009-07-10T02:32:03.060

声明 @str VARCHAR(8000) 设置 @str = ''

SELECT @str = @str + 列 + ',' FROM 表 SELECT @str

# vb.net - 如何使用 VB.NET 和 LINQ 附加“where”子句？

> ID：782566
> 
>         
> 
> 赞同：32
> 
>         
> 
> 时间：2009-04-23T16:41:32.847
> 
>         
> 
> 标签：vb.net, linq, where-clause

我对 VB.NET 很陌生，在这里遇到了一些我认为应该很简单的问题。

保持简单，假设我有一个我想要搜索的带有“名称”的文档表（实际上还有其他几个表、连接等..）。我需要能够使用`where`基于传入字符串值的子句来构建查询。

示例 - 用户可以传入“ABC”、“ABC DEF”、“ABC DEF GHI”。

最终查询将是（我知道语法不正确）：

```
Select * from Documents Where Name Like %ABC% AND Name Like %DEF% AND Name like %GHI% 
```

所以，我想我可以做这样的事情。

```
Dim query = From document In _context.Documents

<< loop based on number of strings passed in >>
query = query.Where( ... what goes here?? ) 
```

出于某种原因，脑死亡或其他原因，我无法弄清楚如何在 VB.NET 中进行这项工作，或者我是否做得正确。

* * *

## 回答 #1

> 赞同：56
> 
>             
> 
> 时间：2009-04-23T17:04:34.210

我相信这就是您在 VB 中的做法（我是 C# 开发人员）：

```
query = query.Where(Function(s) s = "ABC") 
```

有关一些示例，请参阅*[LINQ - 示例查询](http://msdn.microsoft.com/en-us/vbasic/bb688088.aspx)*。

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2009-04-23T22:38:58.463

我认为这里棘手的部分是未知数量的查询参数。您可以在此处使用底层 LINQ IQueryable(Of T) 来提供帮助。

我认为以下内容会起作用（它没有编译，这里只是记事本代码）：

```
Public Function GetDocuments(criteria as String)
    Dim splitCriteria = SplitTheCriteria(criteria)

    dim query = from document in _context.Documents

    For Each item in splitCriteria
        Dim localItem = item
        query = AddCriteriaToQuery(query, localItem)
    Next

    dim matchingDocuments = query.ToList()
End Function

Private Function AddCriteriaToQuery(query as IQueryable(Of Document), criteria as string) as IQueryable(Of Document)
     return query.Where(Function(doc) doc.Name = criteria)
End Function 
```

由于 LINQ 将延迟执行查询，您可以在循环中将 where 子句附加到您的查询上，然后在最后调用 .ToList() 来执行查询。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-05-13T17:02:51.163

在 LINQ to SQL 中，您可以使用查询对象的 .Where 方法将 WHERE 子句添加到查询中，正如您在问题中所述。要使用 LIKE 运算符，请尝试在调用 Where 方法的 Lambda 表达式中使用您正在查询的对象的 .Contains 方法。

这是控制台应用程序中的一个简化示例。希望它将引导您朝着正确的方向前进。

```
Public Class Doc

    Private _docName As String
    Public Property DocName() As String
        Get
            Return _docName
        End Get
        Set(ByVal value As String)
            _docName = value
        End Set
    End Property

    Public Sub New(ByVal newDocName As String)
        _docName = newDocName
    End Sub
End Class

Sub Main()
    Dim Documents As New List(Of Doc)
    Documents.Add(New Doc("ABC"))
    Documents.Add(New Doc("DEF"))
    Documents.Add(New Doc("GHI"))
    Documents.Add(New Doc("ABC DEF"))
    Documents.Add(New Doc("DEF GHI"))
    Documents.Add(New Doc("GHI LMN"))

    Dim qry = From docs In Documents

    qry = qry.Where(Function(d) d.DocName.Contains("GHI"))

    Dim qryResults As List(Of Doc) = qry.ToList()

    For Each d As Doc In qryResults
        Console.WriteLine(d.DocName)
    Next

End Sub 
```

请注意 .Where 方法的 Lambda 表达式中的 .Contains("GHI") 调用。我引用了表达式的参数“d”，它公开了 DocName 属性，进一步公开了 .Contains 方法。这应该会产生您期望的 LIKE 查询。

此方法是附加的，即对 .Where 方法的调用可以包含在一个循环中，以便将其他 LIKE 运算符添加到查询的 WHERE 子句中。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:43:23.357

```
Dim query = From document In _context.Documents where document.name = 'xpto' select document 
```

或者

```
Dim query = From document In _context.Documents where document.name.contains('xpto') select document 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:05:55.220

如果您在循环中执行此操作，则可以执行以下操作：

```
.Where(Function(i as mytype) i.myfiltervar = WhatIWantToSelect) 
```

# php - PHP & Mysql 用复选框形式更新多对多关系

> ID：782575
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-04-23T16:43:08.787
> 
>         
> 
> 标签：php, sql, checkbox, many-to-many

我有一个多对多的表结构和更新复选框表单。

目标是使用 users_project 表将 users 表与 projects 表相关联。这样，每个项目可以有很多用户，每个用户可以有很多项目。

每个用户编辑页面上的表单看起来像这样

```
<form action="#" method="post">
    <div>   
        <input type="checkbox" name="project_id[]" id="1" value="1">
        <label for="1">project 1</label>
        <br>

        <input type="checkbox" name="project_id[]" id="2" value="2">
        <label for="2">project 2</label>
        <br>
        <input type="hidden" name="editing">
        <input type="submit" id="submit" value="submit">
    </div>
</form> 
```

## 以下是三个表的示例。

用户表    

```
+----+-----------+
| id ¦ username  ¦
+----+-----------+
| 1  ¦ user 1    ¦
| 2  ¦ user 2    ¦
+----+-----------+ 
```

项目表

```
+----+-----------+  
¦ id ¦ title     ¦
+----+-----------+  
| 1  ¦ project 1 ¦
| 2  ¦ project 2 ¦
+----+-----------+ 
```

user_projects 表

*此表根据它们的 id 关联上述两个表*

```
+----+-------------+---------+
| id ¦ project_id  ¦ user_id |
+----+-------------+---------+
| 1  ¦           1 ¦       2 |
| 2  ¦           2 ¦       1 |
+----+-------------+---------+ 
```

我制作了一个复选框表单来添加和编辑这些值。在每个用户页面上，它会显示项目表中的所有项目。然后查询 user_projects 表并找到匹配列表以将检查添加到复选框。

但是如何将这些值编辑到数据库中？我如何知道用户是否取消选中了先前选中的框或选中了一个空框并更新到数据库而不循环查询用户表上的 project_id 和 user_id 的匹配项？

这是我希望最终结果实现的粗略概念。

```
if ($_POST['editing']) { 
    $totalprojects = $_POST['editing']; 
    $query = " 
        SELECT *  
        FROM user_projects  
        WHERE user_id = user_id 
        AND project_id = project_id 
    "; 
    $result = $mysqli->query($query); 
    $count = $mysqli->affected_rows; 
    for($i=0; $i < $totalprojects; $i++) {  
        if ($count == 1) { 
            if ($box == checked){  
                //do nothing 
            } 
            else { 
                //delete from database 
            } 
        } 
        if ($count == 0) { 
            if ($box == checked){  
                //add to database 
            } 
            else { 
                //do nothing 
            } 
        } 
    } 
} 
```

**这似乎根本不是一个好主意，**因为我必须为项目表中的每个项目至少查询一次数据库。对于我认为是常见问题的问题，必须有更好的解决方案。我知道我只是想错了。

注意：我考虑过只是序列化一个数组并将其粘贴在用户列中，但这是不可接受的，因为我无法将项目与仅用户关联到项目并破坏目的。

我希望在没有任何 javascript 技巧的情况下实现这一点。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:57:31.450

由于您的项目数量小到足以显示在一张表格中，我完全赞成`user_projects`在提交时重写表格的相关部分：

```
BEGIN TRANSACTION;
DELETE FROM user_projects WHERE user_id = $uid;
INSERT INTO user_projects (project_id, user_id)
    VALUES ($proj1, $uid), ($proj2, $uid), ...;
COMMIT TRANSACTION; 
```

请注意使用扩展`INSERT`语法在一条语句中编写关联。

`user_projects.id`如果您不需要它，您也可以删除它，从而节省表中三分之一的空间。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2013-03-08T21:13:01.240

这就是我解决这个问题的方法：

1.  首先，我使用`active`列来检查一个项目是否被删除（0）或没有（1），因为它比使用 DELETE sql 语句更安全

2.  接下来，您需要将 user_id 和 project_id 列定义为 UNIQUE

    ```
    ALTER TABLE `user_projects` ADD UNIQUE INDEX(user_id, user_project_id) 
    ```

3.  **编码**

    ```
    $uid = $_POST['uid'];
    $pids = $_POST['project_id'];

    // "deleting" all entries
    $chb = $db->prepare("UPDATE `user_projects` SET `active`=0 WHERE `user_id`=?");
    $chb->execute(array($uid));

    //updating checked checkboxes
    foreach ($pids as $pid) {
    $chb = $db->prepare("INSERT INTO `user_projects` VALUES (?, ?, 1) ON DUPLICATE KEY UPDATE `active`=1");
    $chb->execute(array($uid, $pid)); 
    ```

    }

-PDO 用于所有示例

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:50:29.923

好吧，假设每个用户都有资格在每个项目上工作，在您的表单处理页面上，您想要执行以下操作：

```
$query = 'SELECT p.id AS project_id, u_p.id AS user_project_id '.
            'FROM projects AS p '.
                'LEFT JOIN user_projects AS u_p ON (u_p.project_id = p.id AND u_p.user_id = ?)'; 
```

通过左加入，这将为您提供系统中所有项目的列表，并且只有当您正在编辑的用户已经在该项目中时，第二列才会有一个值。对于您提供的示例数据，这是您将获得的结果，查询`user_id`1：

```
+------------+-----------------+
| project_id | user_project_id |
+------------+-----------------+
|          1 |                 |
|          2 |               2 |
+------------+-----------------+ 
```

然后循环这个查询的结果，对于每个结果，检查是否`$_POST`为相应的`project_id`. 如果发送了一个值（选中了复选框）并且该行为`user_project_id`空，则插入一行`user_projects`以添加此链接。如果未发送值（未选中复选框）并且设置了该行，请`user_project_id`删除该行作为键。否则什么都不做，他们并没有改变以前的样子。`user_projects``user_project_id`

希望这很清楚，如果您想让我更详细地了解，请告诉我。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:54:37.153

您可以对操作进行分组并将脚本减少到 3 个查询。

使用来自 Chad Birch anwser 的 LEFT JOIN 检索当前选定的选项。

循环前：

```
$delete_ids = array();
$add_ids = array(); 
```

循环内部：

```
// delete from database
$delete_ids[] = $project_id; 
```

和

```
// add to database
$add_values[] = '('.$user_id.', '.$project_id.')'; 
```

在 for 循环之后：

```
if (count($delete_ids) > 0) {
  mysql_query('DELETE FROM user_projects WHERE user_id = '.$user_id.' AND project_id IN ('.implode(', ', $delete_ids).')'); 
}

if (count($add_ids) > 0) {
  mysql_query('INSERT INTO user_projects (user_id, project_id) VALUES '.implode($add_values)); 
} 
```

# c++ - 在窗口中绘制位数组（rgb）

> ID：782584
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-23T16:44:46.693
> 
>         
> 
> 标签：c++, windows, winapi, graphics

我有一组原始 rgb 数据。我想知道如何在 Windows 操作系统的屏幕上绘制这些像素？

现在我使用 API 函数 DrawDIBits，但我必须打开我的图像数据。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T16:51:08.550

我总是使用 SetDiBitsToDevice，但 drawDIBits 也可以（尚未检查）。

至于 windows blit 函数的颠倒性质：

有一种解决方法。如果将 BITMAPINFOHEADER 或 BITMAPINFO 结构传递给函数，只需否定 bitmap-height 成员中的值。这将告诉 GDI 像高度为正一样执行 blit，但将数据解释为以自上而下的顺序存储。

您也可以通过这种“hack”获得不错的速度提升。

如果您想打乱像素的字节顺序（例如将 ARGB 转换为 BGRA 左右），您可以使用 BITMAPV4HEADER 结构并告诉 GDI 您的像素数据是如何组织的。这是一个很少使用但从 WIN98 开始就可以使用的功能。我会说这些天使用它很节省..

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:50:26.477

如果您的意思是在不将（R，G，B）反转为（B，G，R）的情况下绘制它，我不知道一种自动的方法来做到这一点。

如果您的意思是在不将每条线填充为 4 像素的倍数的情况下绘制它，则可以通过一次绘制每条线来实现。不过会很慢。

# sql-server - 为什么空格是 SqlServer 中的有效列名？

> ID：782591
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-04-23T16:46:38.607
> 
>         
> 
> 标签：sql-server

你自己看：

```
create table #temp ([ ] varchar(1))
insert into #temp values ('1')
select [ ] from #temp 
```

世界上允许这样做的理由是什么？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-04-23T16:53:30.633

我认为基本原理更像是：

> 是否值得阻止此功能？

我不知道 SQL 是如何在内部编码的，但我怀疑它需要更多的努力来防止这种情况然后允许它。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-04-23T16:49:51.470

在调试复杂查询时，我一直使用它作为占位符/分隔符。我可能有这样的事情：

```
SELECT a.*, ' ' as [ ], b.*
FROM a
LEFT JOIN b on ... 
```

这样我就可以在两个表之间得到一个空白部分，这样我就可以很容易地看到一个停止而另一个开始的结果。  

稍后当我得到我需要的结果和性能时，我将更改 select 子句以仅使用我关心的列。

也就是说，我想我没有理由不能使用其他东西作为列名。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T16:55:58.583

[] 之间可以使用任何有效字符来定义列名和表名。鉴于 [A Column] 之类的内容是有效的（带有空格），没有理由阻止单个空格作为列名。

但是，尾随空格会被删除。

```
[ ] 和 [ ]（1 和 2 个空格）
```

都将被视为

```
[ ]（1 个空格）。

```

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T16:57:09.953

空格是可接受的字符，因为有些人喜欢在列名中包含空格。如果它可以是列名的一部分，那么为什么不是列名本身呢？

他们为什么这样做对我来说仍然是一个谜，因为它使编程变得更加困难（不断地将所有内容包含在“”或[]中）。我实际上已经看到了一个带有问号的列名，这绝对是我会避免在任何标识符中使用的东西，但它仍然是可能的。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T16:54:31.833

我想空格就像任何其他角色一样。您甚至可以创建一个名为 [ ] 的表。（我试过了，它奏效了。）我认为对此没有任何限制。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:05:09.543

我有点欣赏这样一种假设，即我有足够的责任不会用潜在的危险功能伤害自己。我自己还没有找到在对象名称中使用空格的充分理由，但在某些情况下它似乎很受欢迎。这是一个用剪刀跑步的极端例子。

# java - 将证书导入 Jetty

> ID：782592
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-23T16:47:01.040
> 
>         
> 
> 标签：java, ssl, certificate, jetty, keytool

这里的总体目标是使用客户端证书配置码头，以便能够调用安全的 SOAP Web 服务。

有谁知道如何配置 Jetty 以接受客户端证书 (*.cer) ？

**更新**：我没有找到一种简单的方法来解决我的问题/问题，但这里唯一的答案在技术上是正确的！

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T18:00:06.700

Jetty 也可以使用[JK](http://tomcat.apache.org/connectors-doc/)，因此您可以轻松地在 Apache 中设置您的证书，以通过它处理任何 https 请求......更多信息[在这里](https://wiki.eclipse.org/Jetty/Tutorial/Apache)。

如果你真的想为 SSL 设置 Jetty，那么[这里是 info](http://www.eclipse.org/jetty/documentation/current/configuring-ssl.html)。

# sql-server - 查询中的大量sql参数

> ID：782603
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T16:50:05.167
> 
>         
> 
> 标签：sql-server

我有两个断开连接的 sql 服务器，它们必须在它们之间运行相关查询。运行查询的最佳方法是什么，例如：

```
select * from table where id in (1..100000) 
```

其中 1..100000 是我从另一个数据库获取的 ID，并且不连续。

in 子句不支持那么多参数，并且创建一个临时表来执行子查询需要永远。还有其他选择吗？使用 Sql Server 2005 作为数据库，C# 作为我的语言。

链接服务器不是一种选择。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T16:56:19.830

如果可能，请将它们设置为链接服务器。然后就可以直接查询其他服务器了。

设置好链接后，您还应该考虑 INNER JOIN 或 EXISTS 可能会表现得更好。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:55:53.793

语法可能略有不同，因为我的服务器到服务器 MSSQL 生锈了，但是......

```
Select * from table where id in (select id from [Server_Two\Some_Instance].[SomeDatabase].[user].table2) 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:58:49.950

要在不跨服务器查询的情况下解决允许的 IN 参数数量，您可以将它们存储到具有 id 子集的多个查询中，并使用 UNION 连接它们。有点笨拙，但它应该工作。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:59:47.560

您可以使用一个函数来分解输入字符串并返回一个表格。这里有很多关于如何在 in 子句中使用动态参数的问题，应该有一个例子。

如果您可以链接您的服务器，您可以在两台服务器之间加入。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:11:46.923

听起来您已经探索过的另一个选项是创建一个临时表，其 id 将用作**连接**到主表的条件。  

```
select * from atable a
inner join #temptable t on a.id = t.id 
```

由于它们是 ID，因此我假设它们已编入索引。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:34:52.360

你是如何产生的？如果是文本，您可以以不同的方式生成它。或者这会导致同样的错误吗？

```
 SELECT.....
 WHERE id in (1..10000)
    OR id in (10001..20000)
 -- etc. 
```

# function - 实现“函数调用函数”

> ID：782605
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T16:50:16.727
> 
>         
> 
> 标签：function, functional-programming, python

我想编写一些代码来调用由给定参数指定的函数。例如：

```
def caller(func):
    return func() 
```

但是，我还想做的是为“调用者”函数指定可选参数，以便“调用者”使用指定的参数（如果有）调用“函数”。

```
def caller(func, args):
# calls func with the arguments specified in args 
```

有没有一种简单的pythonic方式来做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-04-23T16:51:20.203

您可以通过使用[任意参数列表](http://docs.python.org/tutorial/controlflow.html#arbitrary-argument-lists)和解[包参数列表](http://docs.python.org/tutorial/controlflow.html#unpacking-argument-lists)来做到这一点。

```
>>> def caller(func, *args, **kwargs):
...     return func(*args, **kwargs)
...
>>> def hello(a, b, c):
...     print a, b, c
...
>>> caller(hello, 1, b=5, c=7)
1 5 7 
```

不过，不知道*为什么*你觉得有必要这样做。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-04-23T16:56:01.533

这已经作为[apply](http://docs.python.org/library/functions.html#apply)函数存在，尽管由于新的 *args 和 **kwargs 语法，它被认为已过时。

```
>>> def foo(a,b,c): print a,b,c
>>> apply(foo, (1,2,3))
1 2 3
>>> apply(foo, (1,2), {'c':3})   # also accepts keyword args 
```

但是， * 和 ** 语法通常是更好的解决方案。以上等价于：

```
>>> foo(*(1,2), **{'c':3}) 
```

# c# - 为什么 .NET 在某些类中使用 int 而不是 uint？

> ID：782629
> 
>         
> 
> 赞同：64
> 
>         
> 
> 时间：2009-04-23T16:56:16.867
> 
>         
> 
> 标签：c#, .net

我总是遇到`int`用于诸如`.Count`等之类的代码，甚至在框架类中，而不是`uint`.

这是什么原因？

* * *

## 回答 #1

> 赞同：74
> 
>             
> 
> 时间：2009-04-23T16:58:53.070

`UInt32`不[符合 CLS](http://msdn.microsoft.com/en-us/library/12a7a7h3.aspx)，因此它可能不适用于所有针对公共语言规范的语言。`Int32`是符合 CLS 的，因此保证存在于所有语言中。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-04-23T16:58:10.437

int 在 c 中被明确定义为处理器的默认整数类型，因此被认为是一般数值运算中最快的。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T17:14:53.780

如果该数字本质上确实是无符号的，那么我将其声明为无符号整数。但是，如果我只是碰巧使用了正数范围内的数字（暂时），那么我将其称为 int。

主要原因是：

*   它避免了必须进行大量类型转换，因为大多数方法/函数都被编写为采用 int 而不是 unsigned int。  

*   它消除了可能的截断警告。

*   你总是希望你可以为你最初认为总是正的数字分配一个负值。

只是浮现在脑海中的一些快速想法。

我曾经尝试非常小心并选择正确的未签名/签名，我终于意识到它并没有真正带来积极的好处。它只会创造额外的工作。那么，为什么要通过混合和匹配来使事情变得困难。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2015-05-08T19:35:56.013

无符号类型只有在有符号和无符号值的和或乘积是一个大到足以容纳任一操作数的有符号类型，并且两个无符号值之间的差是一个大到足以容纳任何结果的有符号值时，才会表现得像整数。因此，大量使用 的代码`UInt32`将经常需要将值计算为`Int64`. 当操作数过大时，对有符号整数类型的操作可能无法像整数一样操作，但当操作数很小时，它们的行为会很合理。即使操作数很小，对无符号类型的未提升参数的操作也会带来问题。`UInt32 x;`例如，如果结果类型为 ，则不等式将`x-1 < x`失败，`x==0`如果结果类型为`UInt32`，则不等式`x<=0 || x-1>=0`将失败`x`如果结果类型为`Int32`. 只有对类型进行运算，`Int64`才能同时支持这两种不等式。

虽然有时以不同于整数算术的方式定义无符号类型的行为很有用，但表示计数之类的值通常应该使用行为类似于整数的类型——无符号类型通常不会这样做，除非它们' re 小于基本整数类型。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T20:54:46.013

UInt32 不符合 CLS。[http://msdn.microsoft.com/en-us/library/system.uint32.aspx](http://msdn.microsoft.com/en-us/library/system.uint32.aspx)

我认为多年来人们得出的结论是，使用无符号类型并没有真正提供那么多好处。更好的问题是通过将 Count 设置为 UInt32 可以获得什么？

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:05:44.770

使用的另一个原因`int`：

假设你有一个`for`像这样的循环：

```
for (i = someList.Count - 1; i >= 0; i--) {
  // Stuff
} 
```

显然，如果`someList.Count`是 0 和`unsigned`，你就会遇到问题。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T16:59:35.830

有些东西使用 int 以便它们可以返回 -1 ，就好像它是“null”或类似的东西。就像 ComboBox 如果没有选择任何项目，它的 SelectedIndex 将返回 -1。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T16:59:07.593

一些旧库甚至`InStr`使用负数来表示特殊情况。我相信要么是它的懒惰，要么是有负面的特殊价值。

# css - IE6元素在悬停时改变大小

> ID：782631
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T16:56:22.157
> 
>         
> 
> 标签：css, internet-explorer-6

1.  在 IE6 中查看以下页面：[http ://www.kickitback.com/Shop.aspx](http://www.kickitback.com/Shop.aspx)

2.  将鼠标悬停在表格中的行上  

3.  注意行如何改变宽度，有时边框会消失

我尝试将 zoom:1 放在各种元素上并设置宽度和高度，但到目前为止还没有成功。有任何想法吗？

编辑：我正在使用 javascript 将类应用于悬停时的行。我的问题是由于一些奇怪的悬停错误，而不是缺少对 :hover 的支持。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:14:47.133

据我记得你不能只用ie6中的css来做到这一点。您应该使用一些 JavaScript 代码。
[怎么做你可以看这里](http://snipplr.com/view/1912/internet-explorer-ie6-css-hover/)。

# javascript - 从对象调用函数：object.function()

> ID：782633
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T16:56:51.763
> 
>         
> 
> 标签：javascript, jquery, function, object, methods

如何从 javascript 中的对象调用函数，例如在 jquery 中调用 myDiv.html() 来获取该 div 的 html。

所以我想要的是这个工作：

```
function bar(){
 return this.html();
}

alert($('#foo').bar()); 
```

这是一个简化的例子，所以请不要说：只做 $('#foo').html() :)

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-04-23T17:03:55.163

```
jQuery.fn.extend({
    bar: function() {
        return this.html();
    }
});

alert($('#foo').bar()); 
```

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-04-23T17:04:08.127

*您的意思是如何在上下文中*调用带有对象的函数？

这有效-

```
function bar() {
    return this.html();
}

bar.apply($('#foo')); 
```

或者，如果您想将方法永久附加到对象，

```
obj = {x: 1};
obj.prototype.bar = function() {return this.x;};
obj.bar(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
>             
> 
> 时间：2009-04-23T17:06:36.373

要将`getHtml`函数添加到`div`具有 id 的元素，`foo`您可以这样做：

```
`$("#foo")[0].getHtml = function () {
  return this.innerHTML;
};
alert($("#foo")[0].getHtml());` 
```

`如果这不是您想要的，而是扩展 jQuery，您应该看看 Alex Barrett 的帖子。`

 `# regex - 正则表达式匹配两个数字，但没有别的

> ID：782638
> 
>         
> 
> 赞同：-1
> 
>         
> 
> 时间：2009-04-23T16:57:45.350
> 
>         
> 
> 标签：regex, grep

获取文件的以下内容：

```
“52245”
“528”
“06156903”
“52246”
“530”
“00584709”

```

什么模式可以同时匹配 52245 和 52246 但不匹配？

* * *

## 回答 #1

> 赞同：17
> 
>             
> 
> 时间：2009-04-23T16:59:14.753

只能匹配这两个数字而没有别的东西：

```
^\"5224[56]\"$ 
```

现在，如果您正在寻找更通用的东西（例如，任何 5 位数字），您将需要类似

```
^\"\d{5}\"$ 
```

我假设引号 ( `"`) 是文件的一部分。如果不是，则省略`\"`表达式中的部分。

您想要的特定 grep 表达式是这样的：

```
grep -E "^\"[[:digit:]]{5}\"$" filename 
```

或从评论中获取建议：

```
grep -P "^\"\d{5}\"$" filename 
```

我已经测试了两者，它们在我的机器上工作！

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2009-04-23T16:59:09.357

```
^(52245|52246)$ 
```

你可以使用这个。

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2009-04-23T17:01:21.207

```
^"5224[56]"$

^"5224(5|6)"$

^"52{2}4[56]"$

^"(52245|52246)"$

... 
```

You should base the regex you use on the semantic you want to express. If you are looking for two arbitrary numbers use `^"(52245|52246)"$`. If the numbers have any meaning - a type code or something like that - I would stick with `^"5224(5|6)"$`.

# c# - 如何使用 Linq 连接不同数据库中的表？

> ID：782643
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-23T16:59:06.923
> 
>         
> 
> 标签：c#, linq, linq-to-sql, views, or-designer

我是一个 Linq 新手，我找不到任何文档来帮助我解决似乎是一个非常微不足道的问题 - 所以你的帮助将不胜感激！

我`Table1`在数据库中有一个表，它在同一台服务器上`DB1`有一个“伪”外键`Table2ID`到`Table2`数据库中的表。`DB2`“伪”，因为显然我不能有一个跨越两个数据库的*实际FK。*

现在我在玩 O/R 设计器，我喜欢将数据库对象带入设计器时生成所有关系的方式……非常酷！我希望我的`Table1`对象与 有关系`Table2`，就像它与 中的所有“真实”外键相关对象有关系一样`DB1`。但我不能带入`Table2`我的数据库图，因为它在错误的数据库中。

为了综合这一点，我尝试在 中创建一个视图`Table2`，`DB1`这很简单`select * from DB2..Table2`。啊哈，现在我可以将一个`Table2`对象放入我的图表中。`Table1`我什至可以在和之间建立父/子关系`Table2`。但是当我查看生成的代码时，`Table1`仍然与 没有任何关系`Table2`，这让我感到最困惑。

我在某处错过了一步吗？有没有更好/推荐的方法来做到这一点？

谢谢！

* * *

## 之后...

按照一个人的建议，我尝试通过复制同一数据库中相关对象的所有结构来填充部分类，`Table1`其中包含访问所需的所有方法。`Table2`

这实际上适用于读取，但是当我尝试更新或插入记录时，我得到了一个异常：

`An attempt has been made to Attach or Add an entity that is not new, perhaps having been loaded from another DataContext.  This is not supported.`

所以看起来 Linq 的设计者实际上已经考虑过这种情况，并决定**不允许**连接不同数据库中的对象。真是可惜了……:(

* * *

## ……甚至后来……

感谢@williammandra.com，我发现您需要手动在视图上创建主键。但是还有另一个问题：由于某种原因，当您从视图中加载一个值`Table2`并将其设置在新记录上`Table1`，然后提交更改时，它会尝试将**新**记录插入`Table2`，这显然会导致 PK 违规。知道为什么会发生这种情况，以及如何解决它吗？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T19:30:35.890

视图没有主键（没有它，O/R 设计者无法创建关系）。您使用视图的解决方案让您走到了一半……您缺少的步骤是在 O/R 设计器中为 Table2 视图中的键字段将“主键”属性设置为 true。您仍然必须手动创建关联，但是一旦您保存 dbml，该关系就会显示在生成的代码中。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:09:03.607

您可以创建两个 dbml，每个数据库一个。然后加入查询中的表：

```
var tb1 = DataContext1.Table1
var tb2 = DataContext2.Table2

var result = (from t1 in tb1
              join t2 in tb2 on tb1.column equals tb2.column
              where ...
              select ...
             ) 
```

您还可以将 tb2 = 设置为您的视图而不是另一个数据上下文...

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:12:51.757

假设您可以从另一个数据库访问一个数据库，您可以通过手动编辑 .dbml 文件来做到这一点。

```
<Table Name="Table1.dbo.Table" Member="MemberObject"> 
<Table Name="Table2.dbo.Table" Member="MemberObject"> 
```

您实际上可以通过查看表的属性并更改源来做到这一点。

# php - 检查一个类是否是另一个类的子类

> ID：782653
> 
>         
> 
> 赞同：22
> 
>         
> 
> 时间：2009-04-23T17:01:06.997
> 
>         
> 
> 标签：php, class, oop, inheritance

我想在不创建实例的情况下检查一个类是否是另一个类的子类。我有一个接收类名作为参数的类，作为验证过程的一部分，我想检查它是否属于特定的类族（以防止安全问题等）。有什么好的方法吗？

* * *

## 回答 #1

> 赞同：38
> 
>             
> 
> 时间：2009-04-23T17:36:03.807

[`is_subclass_of()`](http://php.net/is_subclass_of)将正确检查一个类是否*扩展*`true`了另一个类，但如果两个参数相同（`is_subclass_of('Foo', 'Foo')`将是）则不会返回`false`。

一个简单的相等检查将添加您需要的功能。

```
function is_class_a($a, $b)
{
    return $a == $b || is_subclass_of($a, $b);
} 
```

* * *

## 回答 #2

> 赞同：14
> 
>             
> 
> 时间：2009-04-23T17:07:14.470

是的，有[反射](http://us.php.net/oop5.reflection)

```
<?php

class a{}

class b extends a{}

$r = new ReflectionClass( 'b' );

echo "class b "
    , (( $r->isSubclassOf( new ReflectionClass( 'a' ) ) ) ? "is" : "is not")
    , " a subclass of a"; 
```

* * *

## 回答 #3

> 赞同：14
> 
>             
> 
> 时间：2009-04-23T17:20:24.000

退房[`is_subclass_of()`](http://php.net/is_subclass_of)。从 PHP5 开始，它接受两个参数作为字符串。

您也可以使用, 如果类*或其*任何后代匹配[`instanceof`](http://php.net/instanceof)，它将返回 true 。

 ** * *

## 回答 #4

> 赞同：13
> 
>             
> 
> 时间：2015-08-04T13:55:08.277

您可以使用PHP 5.3.9 中添加[`is_a()`](http://php.net/manual/en/function.is-a.php)的第三个参数`$allow_string`。它允许将字符串作为第一个参数，该参数被视为类名：

### 例子：

```
interface I {}
class A {}
class B {}
class C extends A implements I {}

var_dump(
    is_a('C', 'C', true),
    is_a('C', 'I', true),
    is_a('C', 'A', true),
    is_a('C', 'B', true)
); 
```

### 输出：

```
bool(true)
bool(true)
bool(true)
bool(false) 
```

演示：http: [//3v4l.org/pGBkf](http://3v4l.org/pGBkf)

# sql - 我应该使用 PostgreSql、MySql、Oracle 或 SqlServer 来存储文档/二进制文件吗？

> ID：782655
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:02:35.307
> 
>         
> 
> 标签：sql, database, binary

我应该使用 PostgreSql、MySql、Oracle 或 SqlServer 来存储文档/二进制文件吗？使用其中一种是否有任何性能优势？有什么优点/缺点吗？

存储的文件主要是excel文件、图像文件、pdf和图像。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-23T17:03:57.707

有人会说您不应该将二进制文件存储在数据库中，而应该只存储路径，并将文件保存在标准文件系统中。当然，您采用哪条路径很大程度上取决于您对文件的处理方式，如果不了解您的要求，就很难说。

# apache - Apache 重写某些 url 以分隔代码库的一部分

> ID：782656
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:03:28.783
> 
>         
> 
> 标签：apache, mod-rewrite, apache2, rewrite

为了这个例子，基本上我有 2 个独立的代码库，v1 和 v2。我想将 v1 站点的某个区域重定向到 v2，以便我们可以定期将旧代码移植到新代码。

现在，我以前做过这种确切的代码移植，我只是不记得确切的细节以及我们是否做了一些 apache voodoo 来让它工作。这一次我可以让它命中 v2 代码，但随后的请求使用 v1 vhost，因此 v2 请求的图像正在转换为 v1 的路径并且不存在。

所以我希望 domain1.com/foo/bar 被重定向到 v2 代码库，在 v1 vhost（在 /home/domain1 下）我有：

```
RewriteRule ^/foo/?([0-9a-zA-Z]*)/?(([0-9a-zA-Z/]*))$ /home/domain2/index.php?controller=foo&action=$1&params=$2 [NC,L] 
```

这成功捕获了请求并将其传递给 v2 代码库，但随后 v2 代码库继续使用 v1 虚拟主机。显然我希望它能够访问 v2 代码库并开始使用该虚拟主机，但不使用外部重定向 [R]

重写日志的输出如下：

```
192.168.1.64 - - [23/Apr/2009:17:04:11 +0100] [domain1.com/sid#813071d0][rid#81783540/initial] (2) init rewrite engine with requested uri /foo
192.168.1.64 - - [23/Apr/2009:17:04:11 +0100] [domain1.com/sid#813071d0][rid#81783540/initial] (3) applying pattern '^/foo/?([0-9a-zA-Z]*)/?(([0-9a-zA-Z/]*))$' to uri '/foo'
192.168.1.64 - - [23/Apr/2009:17:04:11 +0100] [domain1.com/sid#813071d0][rid#81783540/initial] (2) rewrite '/foo' -> '/home/domain2/index.php?controller=foo&action=&params='
192.168.1.64 - - [23/Apr/2009:17:04:11 +0100] [domain1.com/sid#813071d0][rid#81783540/initial] (3) split uri=/home/domain2/index.php?controller=foo&action=&params= -> uri=/home/domain2/index.php, args=controller=foo&action=&params=
192.168.1.64 - - [23/Apr/2009:17:04:11 +0100] [domain1.com/sid#813071d0][rid#81783540/initial] (2) local path result: /home/domain2/index.php
192.168.1.64 - - [23/Apr/2009:17:04:11 +0100] [domain1.com/sid#813071d0][rid#81783540/initial] (1) go-ahead with /home/domain2/index.php [OK]
192.168.1.64 - - [23/Apr/2009:17:04:11 +0100] [domain1.com/sid#813071d0][rid#8175e4b0/initial] (2) init rewrite engine with requested uri /images/layouts/standard/header/header_logo.gif
192.168.1.64 - - [23/Apr/2009:17:04:11 +0100] [domain1.com/sid#813071d0][rid#8175e4b0/initial] (3) applying pattern '^/foo/?([0-9a-zA-Z]*)/?(([0-9a-zA-Z/]*))$' to uri '/images/layouts/standard/header/header_logo.gif'
...
... 
```

任何人都可以帮助完成最后一步！？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:06:02.367

如果要对另一台服务器进行代理调用，请将 P 添加到标志中。

# user-interface - Image Map-like Blackberry Control - CLDC应用

> ID：782661
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T17:04:14.977
> 
>         
> 
> 标签：user-interface, blackberry, cldc

有谁知道我可以在我的 CLDC 应用程序中使用的类似图像映射的 Blackberry 控件？如果没有，有没有办法在 MainScreen 或 BitmapField 派生控件上单击 x,y 坐标？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-24T03:05:24.390

我假设您正在考虑为 Storm 提供此控件 - 唯一可以在屏幕上单击任意点有意义的设备。

在这种情况下，最简单的方法可能是将 BitmapField 子类化为可聚焦并响应点击 - 如下所示：

```
public class ClickableBitmapField extends BitmapField {
// Make the control focusable    
public boolean isFocusable() {
       return true; 
}

protected boolean touchEvent(TouchEvent message) {
    if (message.getEventCode == TouchEvent.CLICK) {
        int x = message.getX();
        int y = message.getY();
        // do something with x and y here
    }
}
} 
```

当然，为轨迹球设备实现图像映射类型功能要复杂得多——您必须维护一个光标或其他东西，以便用户知道他们在哪里点击。

# c# - 如何在c#中从字符串中提取字符串

> ID：782666
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T17:04:58.127
> 
>         
> 
> 标签：c#, string

我有以下字符串：

> FirstName=John&LastName=Doe&City=London&ConfirmationId=WXASL320330

我想从中提取confirmationId。我已经对其进行了拆分并传入了 & 字符，但这会返回 ConfirmationId=WXASL320330 而我只是 WXASL320330。这样做的最佳方法是什么？

该字符串实际上是 PayPal 返回的名为 RawProcessorResult 的属性的一部分。

* * *

## 回答 #1

> 赞同：21
> 
>             
> 
> 时间：2009-04-23T17:19:58.090

最简单的方法是使用内置[`HttpUtility.ParseQueryString()`](http://msdn.microsoft.com/en-us/library/system.web.httputility.parsequerystring.aspx)方法：

```
string queryString = "FirstName=John&LastName=Doe&City=London&ConfirmationId=WXASL320330";

string confirmationID = 
  System.Web.HttpUtility.ParseQueryString(queryString)["ConfirmationId"]; 
  // returns "WXASL320330" 
```

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-04-23T17:08:10.520

'=' 上的另一个分裂

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2009-04-23T17:08:21.003

使用正则表达式：

> 新正则表达式(@"ConfmationId=(\w+)")

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T17:08:46.557

您可以使用正则表达式到达那里。

或者，您可以将当前结果拆分为 =，并采用第二个参数。

```
string temp = "ConfirmationId=WXASL320330";
string[] portions = temp.Split("=");
string answer = portions[1]; 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:09:52.873

我会使用正则表达式。例如：ConfirmationId=(\w{11})

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:11:57.547

我建议使用正则表达式。

```
String input =
   "FirstName=John&LastName=Doe&City=London&ConfirmationId=WXASL320330";

String confimationId =
   new Regex(@"ConfirmationId=(?<Id>[A-Z0-9]+)(&|$)").
   Match(input).
   Group("Id").
   Value; 
```

如果确认 ID 具有更多结构 - 例如总是 5 个字母和 6 个数字 - 您应该将此信息包含在表达式中。

```
@"ConfirmationId=(?<Id>[A-Z]{5}[0-9]{6})(&|$)" 
```

如果确切的结构未知或可能发生变化，只需将所有内容都放在下一个＆符号。

```
@"ConfirmationId=(?<Id>[^&]+)" 
```

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:09:52.437

```
input.Split('&').Select(x => x.Split('=')).Single(x => x[0].Equals("ConfirmationId"))[1] 
```

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:10:44.790

这取决于。如果这是您在 asp.net 应用程序中的 url 的一部分，那么您只需要`Request["Confirmationid"]`. 如果它来自其他东西，那么使用正则表达式：

> 确认ID={[^&]*}

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:11:02.073

你有三种主要的方式来做到这一点。

```
var source = "FirstName=John&LastName=Doe&City=London&ConfirmationId=WXASL320330";
var parts = source.Split(new string[] { "&" }, StringSplitOptions.None); 
```

再次分裂

```
var ids = parts[3].Split(new string[] { "=" }, StringSplitOptions.None);
var confirmationId = ids[1]; 
```

带有 IndexOf 的子字符串

```
var confirmationId = parts[3].Substring(parts[3].IndexOf("=")); 
```

正则表达式

```
var pattern = new Regex("[^=]+=(?<value>.*)");
var match = pattern.Match(parts[3]);
var confirmationId = match.Groups["value"].Value; 
```

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:14:53.890

```
string confirmationId = Regex.Match(input, @"(?<=ConfirmationId=)[^&]*").Value; 
```

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:08:58.147

您可以对该结果进行拆分并获取确认号。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:10:23.900

您可以执行以下操作：

```
myString.Split('&')[3].Split('=')[1]; 
```

但更好的方法可能是使用 RegEx：

```
new RegEx("ConfirmationId=?*") 
```

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:16:48.940

这是 URL 中的查询字符串吗？您正在使用网络项目吗？如果是这样，则有用于检索值的内置方法。让我知道这是否是您正在做的事情，我会发布代码。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:42:15.680

我认为最好的方法是使用字符串索引。如果由于某种原因特定字符串不存在，请确保您考虑到：

```
string val = "FirstName=John&LastName=Doe&City=London&ConfirmationId=WXASL320330";
string result = string.Empty;
if (val.LastIndexOf("ConfirmationId=")!= -1)
{
    string val2 = val.Substring(val.LastIndexOf("ConfirmationId=") + 15);
    result = (val2.IndexOf('&') != -1) ? val2.Substring(0, val2.IndexOf('&')) : val2;
} 
```

# java - 我应该为此动画使用 SwingWorker、线程还是递归更新？

> ID：782674
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T17:06:32.553
> 
>         
> 
> 标签：java, multithreading, swing, animation, swingworker

正如我在之前的问题中所说，我对 Java 还是很陌生。我正在用 Java 开发一个基于图块的游戏。运动在网格上。我正处于实施角色移动的阶段。

我的计划是使用我在[这个问题](https://stackoverflow.com/questions/772713/call-repaint-from-another-class-in-java)中粘贴的代码。但是，这不起作用，我被告知应该使用 SwingWorker。

作为一个问题解决者，我这一天一直在思考这个问题，我有了一个想法。我可以通过做一些不同的事情来达到同样的效果。

我提到我有一个每 20 毫秒关闭一次的计时器，称为重绘。

我的想法是，我可以在计时器事件的重绘之前调用一个方法，这将使所有人更接近他们的目的地（下一个正方形/瓷砖）。那种东西行得通吗？在游戏后期，可能有 100 人左右。20 毫秒是否足以循环遍历所有人并将他们移动到离目的地更近的一个单元？20ms的时间太短了吗？我只是没有意义吗？

欢迎您的意见/答案/想法:)

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:50:36.673

我几乎同意比尔所说的一切，尤其是关于 Swing 神秘的部分（尽管并不比其他图形环境更是如此）。

举几个参考，30 fps（这是大多数隔行屏幕产生的速度）是每 33 毫秒 1 帧。60 fps 大约是人类可以感知的最高速度（1 帧/16 毫秒），大多数 LCD 显示器以 60 或 75 Hz 刷新，这绝对是您实际可以产生的最快速度。20 毫秒/帧是 50 fps 的帧速率，这也与欧洲地区的电频率相吻合，人眼即可察觉。

我建议反对的主要事情是在一个紧凑的 while 循环中做所有事情。这将导致您的游戏速度高度依赖于您所玩的系统。在较快的系统上，即使在较旧的系统上可以正常播放（或者在破旧的机器上会遇到相反的问题），您的帧喷射速度也可能超过玩家的反应速度。使用计时器将使您的速度更加一致，但是您必须进行一些防御性检查，以防错过帧截止日期。这意味着您的计时器需要知道计算何时完成，因此如果另一个帧滴答作响并且尚未完成，那么它将跳过下一帧。更好的是，您记录计算之间实际经过的时间，并相应地调整角色的实际移动。  

另一个警告：虽然必须在 AWT 线程上进行绘图并对其进行计算（以保持程序响应），但也需要在 AWT 线程上更新状态。如果您让执行计算的线程更新游戏状态，那么 AWT 线程将在重绘过程​​中看到这一点，从而导致称为撕裂的效果。因此，您可能需要制作一份状态副本以发布到 AWT 线程。这就是 SwingWorker 的用途，您可能会将其与 Timer 结合使用。

令人惊讶的是，与我在您的其他问题上发布的内容相比，我所说的大部分内容实际上都是新的。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:55:31.500

好的，首先回答20毫秒的问题。你可以在 20 毫秒内完成相当多的游戏逻辑。但我想说更新显示太频繁了。您还应该记住，操作系统通常以 10 到 20 毫秒的时间片来分配 CPU——换句话说，任何时候另一个进程都可以轻松地将您的进程延迟大约该时间。例如，看一下我关于[Thread.sleep() 行为的](http://www.javamex.com/tutorials/threads/sleep.shtml)文章——从图中注意到，由于系统处于中等繁忙状态，操作系统无法满足我们要求的睡眠时间。如果您需要 100ms 的帧之间的平均睡眠，那么 20ms 左右的抖动在这里并不会太糟糕。但是当你要求 20 毫秒时，20 毫秒的抖动可能会更明显......

所以我可能会以每秒 10 帧（暂停 100 毫秒）开始，然后看看效果如何。

就代码而言，如果您的游戏逻辑每次滴答花费或多或少相同的时间，那么我会在每个滴答时从 logic-repaint-sleep 开始。请记住，您需要同步您正在绘制的内容，因此在您的游戏逻辑线程中，您最好避免长时间持有锁。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:21:03.640

这个挥杆领域可能是 Java 中最“黑魔法”的领域。这可能很棘手，并且有很多方法。

最重要的规则是永远不要修改屏幕，除非你在 AWT 线程中，但不要使用 AWT 线程来修改屏幕。

由于每个摆动“回调”（如按钮侦听器）都进入 AWT 线程，因此您通常不必考虑这一点，但对于活动渲染情况，您必须密切关注。

通常在像这样的大型系统中，您一次进行整个计算（移动所有数据），然后重绘所有需要一步绘制的内容。

因此，在大多数情况下，您在一个连续线程中完全在您的绘图系统之外进行计算，然后您将在顶级组件中调用一个重绘函数。重绘应该将绘制事件传递给 AWT 线程上的所有组件，所以这应该不是问题。

然后每个组件都应该查看它的状态（已经更新）并使用该信息来绘制自己。

这是应该如何完成的，基本的，但它可能很慢，并且有很多技巧可以加快速度。你可能想找一本涉及挥杆编程和游戏的书。

# javascript - 在 IE6 中调试 JavaScript

> ID：782689
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-04-23T17:09:38.380
> 
>         
> 
> 标签：javascript, debugging, internet-explorer-6

我正在寻找一种能够让我**在**IE6 中调试 JavaScript 的工具。我的意思是我希望调试器在浏览器中运行，*一个 là* Firebug。

到目前为止，我已经尝试过：

*   [调试栏](http://www.debugbar.com/)；

*   [伴侣JS](http://www.my-debugbar.com/wiki/CompanionJS/HomePage)；

*   [萤火虫精简版。](https://getfirebug.com/firebuglite)

但是，我不知道如何设置断点、单步执行代码、添加手表等。我也尝试过使用 MS Visual Web Debugger 2008 Express Edition，但它不能在浏览器中运行并且缺少功能。

如果上述任何工具确实提供了我正在寻找的 JS 调试功能，那么任何有关如何有效使用它们的提示都将受到欢迎。或者，随时推荐其他工具。

**更新：**除了建议替代工具之外，如果有人可以确认上述工具都不支持在 IE6 中设置断点和单步执行 JS 代码，那将非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:15:06.120

[Jonathan Boutelle 有一个很好的备忘单](http://jonathanboutelle.com/2006/01/16/how-to-debug-javascript-in-internet-explorer/)，让 Microsoft Script Editor 能够工作以调试 JScript，因此如果您安装了 Office，您可以尝试一下。

# java - Java3D模拟作业

> ID：782706
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T17:12:13.180
> 
>         
> 
> 标签：java, visualization, java-3d

我被分配了使用 java3D（粒子等）模拟宇宙开始的任务，并且必须由 5 个不同的部分组成……每个部分的最小长度为 15 秒。像粒子汤阶段这样的阶段 - 基本上是 5 个可区分的可视化。它不必很复杂，只是球体以设定的编程行为四处移动。

除了构建一个依赖插值器的简单游乐场骑行外，我对 java3D 并没有真正做太多事情。

我如何能够保持时间线并在不同阶段之间切换？

我想知道如何最好地构建这个模拟。使用 PositionInterpolator 是否适合移动粒子和检测碰撞？还是有更好的方法来实现我正在寻找的东西？

到目前为止，我已经开始为一些粒子建模——简单的不同大小和颜色的球体，并将它们随机放置在简单的宇宙中，并使用 PositionInterpolator 对它们应用随机方向，并使用 Transform3D 设置旋转。

任何指导和帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:17:05.070

> *我如何能够保持时间线并在不同阶段之间切换？*

将主应用程序编写为状态机。将每个阶段视为一个状态。完成一个阶段后加载下一个状态。

这就是[状态模式](http://en.wikipedia.org/wiki/State_pattern)。这种方法的一个优点是您可以将每个阶段编写为它自己的小程序，从而允许您针对所需的特定可视化对其进行优化。

至于 3D 问题，您似乎走在了正确的轨道上。如果不为您做功课，很难回答。通过将应用程序分成多个状态，您可以解决每个部分的问题，而不会影响其他部分。唯一需要传递的是 3D 绘图表面的句柄。

# java - 如何让 Netbeans 相信我拥有 JMS？

> ID：782711
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:12:55.003
> 
>         
> 
> 标签：java, netbeans, jms

我继承了一个广泛使用 JMS 的项目。它使用 Java 6 SE 编译、运行并通过其所有单元测试。我创建了一个 netbeans (v 6.5) 自由形式项目来配合它。我正确添加了所有库和所有内容（检查了几次）。现在，问题来了：它会产生大量的 Netbeans 错误消息，比如“包 javax.jms 不存在”等等。

由于项目是在 JDK 1.6 SE 下编译的，我假设 javax.jms 和朋友存在于 JDK 中。但是，Netbeans 显然没有找到它。关于这里可能出现问题的唯一线索是，在“项目属性”下，我只能选择 1.3、1.4 和 1.5 - 1.6 源级别不是一个选项。如何让 Netbeans 看到 javax.jms？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T17:22:48.520

`javax.jms`不是 JDK 的标准部分。当您在命令行编译时，您的类路径中可能有一些 NetBeans 不知道的额外 JAR；jms-1.1.jar 显然就是其中之一。

因此，您需要做的就是将它作为库添加到 NetBeans 中。我相信，由于这是一个自由形式的项目，您必须修改您的 Ant 脚本才能做到这一点。现在自己去试试吧……

**编辑：** [这是](http://www.netbeans.org/kb/articles/freeform-import.html#Chapter2.2)设置代码完成类路径的参考。我没有任何自由形式的项目可供测试。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:23:12.730

JMS 不是 Java SE 的一部分，它是 Java EE 的一部分。您必须找到随 JMS 实现一起提供的 javaee.jar 或某些 JMS 特定的 jar。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2016-12-25T14:06:20.813

打开项目属性 -> 库 -> 添加库 -> 添加 Java EE 7 API 库[![在此处输入图像描述](https://i.stack.imgur.com/hi4G5.png)](https://i.stack.imgur.com/hi4G5.png)

# windows-vista - 如何在 Vista 上运行本地 DNS 缓存名称服务器？

> ID：782716
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:14:35.887
> 
>         
> 
> 标签：windows-vista, dns

我习惯于在我拥有的所有类 unix 系统（即 Linux 和 Mac OSX）上运行我自己的 DJB dnscache。现在我得到了一个 Vista，我想知道我可以在它上面运行什么来达到同样的效果？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:23:13.370

Windows 已经有一个缓存 dns 请求的服务（DNS 客户端）。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:17:39.623

内置 DNS 服务器被视为 Windows 世界中的服务器功能。在 Vista 上，您需要获得第三方 DNS 服务器。之后，只需在 TCP/IP 设置中将 DNS 服务器条目设置为 127.0.0.1 即可。

快速谷歌搜索发现[SimpleDNS](http://www.simpledns.com/)，但我从未使用过它，也无法证明它的效果如何。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-24T07:44:02.210

事实上最流行的[BIND](https://www.isc.org/downloadables/11)软件在 Windows 上运行，许多其他 DNS 服务器也是如此。  

[这里](http://www.nlnetlabs.nl/~wouter/)还有 Unbound for Windows 的实验版本。Unbound 的 Unix 版本自去年以来就已经可用，并且已经在许多 ISP 中投入生产使用。

Unbound 的作者正在寻找这些实验版本的 beta 测试人员。如果您尝试 Unbound 并发现任何问题，请在[http://www.nlnetlabs.nl/bugs/上报告它们](http://www.nlnetlabs.nl/bugs/)

# visual-studio-2008 - Building an MSBuild 2.0 project from 3.5

> ID：782725
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-23T17:16:55.320
> 
>         
> 
> 标签：visual-studio-2008, visual-studio-2005, msbuild

I have a VS 2005/MSBuild 2.0 project (let's call it "Project A") that I *must* keep in VS 2005 (it uses a third-party VS 2005 Designer.)  Project A is referenced by one of the projects in my new VS 2008 solution (we'll call them "Project C" and "Solution B" respectively.)  Ideally, I'd like to chain the building of Project A into the building of Solution B, and I believe that the "ToolsVersion" attribute is the key.  So, to recap, this is what I need to do:

1.  Start a build on Solution B either through the command-line or Visual C# 2008 Express.  It is critical that it work through **both**!

2.  Have Project C trigger the building of Project A.

3.  Have the output of Project A (a class library) copied to Project C.

4.  Build Project C and the remaining projects in Solution B.

Here's a diagram:

    MSBuild 3.5 or VS2008->

    [Solution B (3.5)]->

    [Project C (3.5)]->

    [Project A (2.0)]->

    Copy output of A to C->

    Continue building Solution B

Any ideas on how I should set this up?  Clips from working project files would be hugely appreciated!  Thanks in advance!

**SOLUTION**

Here's what needed added to Project C, to make this work:

```
<ItemGroup>
   <ProjectToBuild Include="..\ProjectA\ProjectA.csproj" />
</ItemGroup>
<Target Name="BeforeBuild">
   <MSBuild
     Projects="@(ProjectToBuild)"
     Targets="Rebuild" ToolsVersion="2.0">
              <Output
              TaskParameter="TargetOutputs"
              ItemName="AssembliesBuiltByChildProjects" />
   </MSBuild>
   <Copy SourceFiles="@(AssembliesBuiltByChildProjects)"
            DestinationFolder="$(MSBuildProjectDirectory)"
    />
</Target> 
```

Note there is a [known issue](http://social.msdn.microsoft.com/forums/en-US/msbuild/thread/4ca448c3-d571-4a4b-b96e-755309cd1a97/) with getting the TargetOutputs of a solution with the MSBuild task.  This was supposed to be fixed in MSBuild 3.5, but I'm guessing that the ToolsVersion attribute is causing it to resurface.  That's why I'm referencing ProjectA.csproj directly, instead of its solution file.

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-27T21:01:29.257

1.  Ensure that the project C is a dependency of project B. (In this case there isn't a project B but if there was then make sure.)

2.  Edit project C's proj file in a text editor.  Add the followingat the bottom of the file but before the closing project tag, where a.sln is the solution for project A.

    <ItemGroup>

       <ProjectsToBuild Include="a.sln"/>

    </ItemGroup>

    <Target Name="BeforeBuild">

       <MSBuild

             Projects="@(ProjectsToBuild)"

             Targets="Build" ToolsVersion="2.0">

                      <Output

                                      TaskParameter="TargetOutputs"

                                      ItemName="AssembliesBuiltByChildProjects" />

        </MSBuild>

             <Copy SourceFiles="@(TargetOutputs)"

                               DestinationFolder="@(SolutionDir)\References"

          />

      </Target>

3.  Create a references folder under you solution and ensure that it is marked as a reference folder for project C.

4.  Build Project B.

I haven't tested it but the concept should work.

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-26T16:28:17.610

You have not told the specific reason why you need to use Visual studio 2005 on that one project. (I know there are valid reasons to do so, but they might imply different solutions.) 

What I once did successfully was to set binary, include and library paths in VS2008 to use the Compiler and includes of vs2005 (it was a win32 c++ project). 

You can remove /nologo from the compiler options to actually see the compiler version used.

HOWTO:

*   Copy and rename the 2005 project before converting it to 2008\. (to have a clean 2005 version of it available)

*   Add the new converted project to the 2008 Solution, set dependencies.

*   Add a properties-page-thingy (don't know what it is called in English, it's a .vsprops file) to the 2008 Version of the project **with the binary, assembly and include directories set to that of your 2005 installation**, thus forcing vs2008 to use the 2005 toolset for that project.
    You might need the professional version of vs2008 to create such a file, but all versions should be able to read it)

Basically, you will use only the editor component of 2008, and the compiler of 2005, for that project.

There might be better solutions to this, but since you have no answers so far, I propose this workaround.

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-27T21:30:16.037

How about this:
Edit project C's proj file to include an Exec MSbuild task that calls VS2005 devenv with /build switch to build project A and then copy the output files from project A build to a location where project C could find. You need to do in a build step in project C's proj file before project C is compiled, BeforeBuild maybe, so that project C can find the output of project A.  

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-28T17:44:01.517

Just SLN format is different in VS2008, the CSPROJ/VBPROJ files "can" remain same...
So basically you will need two SLN files adding your CSPROJs/VBPROJs in both SLNs.

Read [http://weblogs.asp.net/palermo4/archive/2007/07/30/managing-projects-in-visual-studio-2005-amp-2008.aspx](http://weblogs.asp.net/palermo4/archive/2007/07/30/managing-projects-in-visual-studio-2005-amp-2008.aspx) for more info.

# html - IE中闪烁的图像

> ID：782727
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T17:17:02.120
> 
>         
> 
> 标签：html, css, internet-explorer-6, flicker

我遇到了 IE6 的问题：**每次我将鼠标悬停在图像上时，图像都会重新加载并闪烁。**

这是因为 IE 有一个选项“一直**检查存储页面的新版本**”，基本上是“一直重新加载所有内容”。

我在谷歌上找到了一些修复：

添加

```
<meta http-equiv="Page-Enter" content="revealtrans(duration=0.0)" />
<meta http-equiv="Page-Exit" content="revealtrans(duration=0.0)" /> 
```

通过[网站管理员世界](http://www.webmasterworld.com/css/3662705.htm)

但到目前为止，这对我来说不起作用。

还有其他修复，例如[http://fivesevensix.com/studies/ie6flicker/](http://fivesevensix.com/studies/ie6flicker/)但它并不真正适用于我。图像闪烁是一个精灵，但它会在某些 JS 事件上发生变化（所以我不能真正使用“复制图像”黑客），它也相当小，所以黑客“元素的像素区域”不起作用。

最后还有一些涉及服务器端缓存的黑客攻击，但我觉得这有点矫枉过正，应该有一种更简单的方法来做到这一点。此外，我总是最终在部署在不同类型服务器上的网站上工作，并且每次都必须在服务器上修复它只会很痛苦。

你知道这个问题的解决方案吗？标签解决方案听起来如此完美和简单，为什么它对我不起作用？我希望能够避免重写大量 CSS/JS 来解决这个问题，但我会接受任何客户端修复。

谢谢 ！

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-04-23T17:19:58.260

我将此片段放在 global.js 文件中，并将其包含在我的所有页面中：

```
try {
    document.execCommand("BackgroundImageCache", false, true);
catch(e) {} 
```

更多信息[可在此处获得](http://www.hedgerwow.com/360/bugs/dom-fix-ie6-background-image-flicker.html)。

# c# - 需要一个模式来为每个实例方法模式调用验证方法

> ID：782729
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-23T17:17:07.970
> 
>         
> 
> 标签：c#, .net, design-patterns

我有以下代码：

```
class Foo
{
    public Foo()
    {
        Size = true;
    }

    private bool _size;

    protected bool Size
    {
        get { _size; }
        set { _size = value; }
    }
}

class CrazyFoo : Foo
{
    public void First()
    {
        if (!Size)
            return;
    }

    public void Second()
    {
        if (!Size)
            return;
    }
    public void Finished()
    {
        if (!Size)
            return;
    }
} 
```

实现这种模式的最佳方法是什么，因为它让我发疯地打字

```
 if(!Size) return; 
```

也许我可以用属性或 AOP 做到这一点？

最好和最简单的方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:56:11.840

如果在太多方法的开头有相同的保护语句，可以创建一个名为 executeWithGuard 的方法：

```
private void executeWithGuard(Action method)
{
    if (HeadSize) method();
} 
```

然后你可以这样做：

```
public void ScreenFirstShot()
{
    executeWithGuard(() =>
    {
        // code here
    });
}

public void ScreenSecondShot()
{
    ExecuteWithGuard(() =>
    {
        // code here
    });
}
public void CrazyUp()
{
    ExecuteWithGuard(() =>
    {
        // code here
    });
} 
```

执行此操作的代码不会少……事实上，可能还有更多代码，但如果您的保护条件发生变化，它确实允许您不必进行查找/替换。不过，我只建议将其作为最后的手段。您真正的问题很可能是您在调用树下进行了太远的验证。如果你能在更高的水平上做到这一点，你可能会从所有这些验证中解脱出来。

**还**

看看[空对象模式](http://en.wikipedia.org/wiki/Null_Object_pattern)。在某些特殊情况下可以使用此模式来防止或简化状态检查。

**也（第 2 版）**

It's hard to know what your intent is since the question focuses on a specific solution, but if you're executing these methods sequentially, you can look at using the [strategy pattern](http://en.wikipedia.org/wiki/Strategy_pattern), and putting the check in your base strategy class.

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:22:45.947

也许只使用一种方法和一个带有值的枚举`First`，`Second`等等`Finished`？很难说，因为除了那一次检查之外，你不会说什么是常见的。AOP 可能是一个解决方案，但也可能不是，因为方面通常在其概念性质上更普遍。

顺便说一句，将来可能为您的样品选择不同的命名，这可能会冒犯某些人。（编辑以匹配新命名）

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:26:17.763

但是，从“模式”的角度来看，这对我来说似乎并不麻烦。输入以下内容对我来说似乎是完全合理的：

```
if(!Size) 
    return; 
```

您正在明确处理您想要的情况。就您而言，根据我所知（根据您的原始+编辑），此检查非常特定于您正在使用的内容。我个人会选择一个更明显的名字，因为它看起来有点奇怪（即使在你的原版中），而且并不完全清楚正在发生的事情。  

即使使用 AOP，您也会在此处为每个方法添加一些其他信息，以确保您的方面得到处理。

# web-services - 如何检测 ASP.NET 请求使用的 Web 服务协议？

> ID：782733
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:18:12.447
> 
>         
> 
> 标签：web-services, security, asmx, soap-extension

我有一个 ASP.NET (1.1) Web 服务，它使用 SoapExtension.ProcessMessage(SoapMessage) 覆盖对客户端进行身份验证，如下所述：

[http://www.codeguru.com/columns/experts/article.php/c5479](http://www.codeguru.com/columns/experts/article.php/c5479)

但是，如果 web.config 没有设置为 HttpSoap 是唯一允许的协议，那么 ProcessMessage 将永远不会被其他协议上的请求调用，因此会绕过安全性。

无论如何以编程方式确保正在使用 SOAP（而不是依赖 web.config 是正确的）？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2010-01-15T03:37:13.690

如果它对任何人有用，我最终检查了：

```
Request.ServerVariables["HTTP_SOAPAction"] != null 
```

这并不理想，但似乎可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:21:26.340

查看`Request.ServerVariables`，特别是`SERVER_PROTOCOL`变量。

[http://www.aspcode.net/List-of-RequestServerVariables.aspx](http://www.aspcode.net/List-of-RequestServerVariables.aspx)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-27T10:22:44.923

您可以尝试在启动时读取和解析 web.config，以查看它是否设置为您希望的方式。

# sql-server - 是否可以异步连接到 SQL Server？

> ID：782743
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T17:20:52.533
> 
>         
> 
> 标签：sql-server, asynchronous

我知道如何使用 Begin/EndExecuteNonQuery 在 SQL 服务器上异步执行命令，但是 SqlConnection 类上有 Begin/EndOpen 方法吗？我希望这是异步的，因为有时它很慢而且我不想一直阻塞线程。这有意义吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T17:24:21.167

没有 BeginConnect 方法，但您可以启动一个新线程并在后台执行它，如果这对您有用。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:29:57.880

你可以，但它非常有帮助是不寻常的。数据库的稀缺资源通常与连接无关，而是与查询相关联。您是否怀疑您的应用程序在打开连接时被阻塞？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:26:54.780

或者，为了保持相同的模式，使用您希望作为异步方法的方法签名创建一个委托，并在委托上执行`BeginInvoke`/ `EndInvoke`。

当然，这不会使该方法真正异步，因为幕后仍有一个线程等待同步方法返回，但允许您使用正常模式，它使用线程池中的线程进行调用。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:29:30.843

我将线程化整个命令执行，而不仅仅是打开连接。线程完成后，请注意如何处理结果。  

# php - jqGrid、rowedit、php 将名称而不是值发布到数据库

> ID：782749
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:22:49.923
> 
>         
> 
> 标签：php, javascript, jquery, jqgrid

我需要动态编辑和更改服务器数据。

[http://pssnet.com/~devone/ajqtable/editgrid2.html](http://pssnet.com/~devone/ajqtable/editgrid2.html)

现在，当字段被编辑时，php 将名称而不是值发布到数据库。我的假设是，在提交时，将使用更改的数据调用 editurl。我在文档中读到我可能必须添加一个 onSubmit 函数（如下所示）。

```
<?php
  include("dbc.php");
  $var1 = $_POST['service_id'];
  $var2 = $_POST['name'];

  // $var1 = "abc";
  // $var2 = "xyz";

 mysql_query("INSERT INTO
 testwrite (service_id, name) 
 VALUES('$var1', '$var2') ")
 or die(mysql_error());
?>

onclickSubmit : function(eparams) 
{
 var retarr = {};
 // we can use all the grid methods here
 //to obtain some data
 var sr = jQuery("#grid_id").getGridParam('selrow');
 rowdata = jQuery("#grid_id").getRowData(sr);
 if(rowdata.somevalue=='aa') {
    retarr = {myname:"myvalue"};
}
return retarr; 
```

谢谢你的帮助。

问候，纳特

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-24T06:31:11.713

我喜欢 jquery 插件 editInPlace
 [http://davehauenstein.com/code/jquery-edit-in-place/example/](http://davehauenstein.com/code/jquery-edit-in-place/example/) 
[http://code.google.com/p/jquery-in-place-editor/](http://code.google.com/p/jquery-in-place-editor/)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:59:27.510

我知道了.....

我有它作为editdata {name：'name'等}

editdata 是一个发送附加数据的函数.....

所以......谢谢......如果你们中的任何人看到它......

问候，纳特

# jquery - 您可以使用 Sharepoint (MOSS 2007) 和 jQuery 安全地操作 DOM 吗？

> ID：782757
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-23T17:23:57.033
> 
>         
> 
> 标签：jquery, sharepoint, dom-manipulation

我们有一个 MOSS 2007 安装，我们依靠 jQuery 来处理 webpart 中选项卡的自动旋转、滑动菜单和工具面板的动画。我们的 IE 6 用户间歇性地收到“操作中止”错误。  

虽然我们确认这是在 DOM 完全加载到客户端之前对其进行操作的结果，但我们正在寻找解决方法。有没有人在 Sharepoint 中遇到过这个问题，您采取了哪些步骤来允许安全执行 jQuery？我们是否应该担心 Sharepoint Core UI.js 是导致此问题的原因？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:58:14.130

如果我相信下周二发布的即将发布的 SP2 中解决了这个问题，我不会感到惊讶。

可以希望...

作为推论，您可以查看 Jan Tielen 的博客。他在 MOSS 和 jQuery 方面是合法的。

[http://weblogs.asp.net/jan/default.aspx](http://weblogs.asp.net/jan/default.aspx)

# winforms - Winform 应用程序中的 Silverlight 对象显示

> ID：782761
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:26:20.913
> 
>         
> 
> 标签：winforms, silverlight

这可能吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:29:34.573

Silverlight 是一个客户端浏览器插件。在 WinForm 应用程序中拥有它的唯一方法是让 WinForm 托管浏览器控件。

# multithreading - 在线程之间共享消息队列（在 Windows 中）

> ID：782769
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:27:54.093
> 
>         
> 
> 标签：multithreading, winapi

有没有办法在多个线程之间共享一个消息队列，或者以其他方式读取不同线程的消息队列，而不使用钩子？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:47:50.627

GetMessage 和 PeekMessage 仅读取当前线程的消息，您不能使用它们读取发送到另一个线程拥有的输入队列的消息。

[尝试使用AttachThreadInput](http://msdn.microsoft.com/en-us/library/ms681956(VS.85).aspx)加入线程输入队列，这可能有效。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:29:50.623

消息队列中的消息可以根据它们所针对的窗口进行区分，但我不认为消息可以根据 inteded 线程进行区分——MSG 结构中不存在这些字段——所以我认为您不能在多个线程上共享队列。

这为您提供了一个非挂钩监控解决方案。

我很确定您可以查看另一个线程队列，但问题是您基本上是在轮询；所以你会错过消息。

你对你想阅读的线程有什么影响吗？如果是这样，您可以让他们向您转播他们的消息。

除此之外，我看不到这样做的方法。

# c - Beginners' guide for setting up Emacs with gcc/gdb?

> ID：782770
> 
>         
> 
> 赞同：20
> 
>         
> 
> 时间：2009-04-23T17:29:20.330
> 
>         
> 
> 标签：c, emacs, development-environment

I looked around the GNU emacs material and didn't find anything helpful.

Does anyone know of a good tutorial for setting up emacs, to basically turn it into an IDE? I'm looking for interfacing with gcc/gdb/make, etc...

* * *

## 回答 #1

> 赞同：17
> 
>             
> 
> 时间：2009-04-23T18:20:57.303

Like other answers mentioned, `M-x compile`, `M-x gdb` will get you going. While debugging, I'd also suggest `gdb-many-windows-mode`, which makes Emacs look a bit closer to IDE when debugging.

Besides that and to get closer to "IDE-like features", you can look at:

*   CEDET  [http://cedet.sourceforge.net/](http://cedet.sourceforge.net/) for code completion and project support. Excellent tutorial at [http://xtalk.msk.su/~ott/en/writings/emacs-devenv/EmacsCedet.html](http://xtalk.msk.su/~ott/en/writings/emacs-devenv/EmacsCedet.html) .

*   If you don't mind using non-free software, Xrefactory ([http://www.xref.sk/xrefactory/main.html](http://www.xref.sk/xrefactory/main.html)) is probably the best (well, the only) refactoring tool. The C version is free, the C++ is not.

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-04-23T18:07:04.263

Yuval, you're probably being misled by looking for something about IDEs.  All that stuff is automagically built into EMACS except for the CScope-like searching stuff.

*   `M-x compile` runs *make* by default, although I reset it to run Ant in java mode.

*   `M-x gdb` runs gdb

*   `C-x `` (Ctrl-X backquote) goes to the next compile error

and so on.

Go dig about in the [EMACS Wiki](http://www.emacswiki.org/).  Lots of good stuff.  The [Programming Category](http://www.emacswiki.org/emacs-en?CategoryProgramming) is where you should look.

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:32:20.557

[Good Article](http://www.linuxjournal.com/article/5765)

Look at CScope too... you just have to add two lines to your .emacs to be able to navigate through definitions and references

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T19:51:20.643

Even though not directly related to C/C++ i find that using a good color scheme is important. Try:

```
M-x color-theme-select 
```

and you can browse around a lot of different setups if you do not want to create your own.

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T19:32:31.873

If you're working with version control system, you can find useful information in another [my article](http://xtalk.msk.su/~ott/en/writings/emacs-vcs/index.html) about work with version control systems from emacs

# c# - 数据集更新查询如何工作？

> ID：782771
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:29:27.833
> 
>         
> 
> 标签：c#, asp.net, sql, sql-update

我有一个指向我的 SQL 数据库中的视图的数据集，以及一个使用该数据集填充自身的网格视图。我当然希望行可编辑，所以我在 gridview 中添加了编辑和删除功能 - 标准方法（不是自定义按钮）

现在使用更新查询......由于某种原因，它没有自动生成更新语句（可能导致数据集指向视图而不是我猜的表）所以我必须自己创建它。没问题 - 我选择数据集，选择属性，然后选择 UpdateQuery。

这是我的查询：

```
UPDATE dbo.tblHardware SET TypeID = @TypeID, Name = @Name, Description = @Description, Cost = @Cost, Weight = @Weight, Image = @Image WHERE (HardwareID = @HardwareID) 
```

参数源设置为“Form”，我列出了每个参数的名称。

这是aspx页面中的相关代码：

```
 <asp:SqlDataSource ID="dsHardware" runat="server"
        ConnectionString="<%$ ConnectionStrings:RequestFormsConnectionString %>"
        OldValuesParameterFormatString="original_{0}" 
        SelectCommand="SELECT * FROM [vHardware]" 
        UpdateCommand="UPDATE dbo.tblHardware SET TypeID = @TypeID, Name = @Name, Description = @Description, Cost = @Cost, Weight = @Weight, Image = @Image WHERE (HardwareID = @HardwareID)" 
        InsertCommand="INSERT INTO [vHardware] ([HardwareID], [TypeID], [Description], [Name], [Cost], [Weight], [Image], [TypeDesc], [TypeName], [TypeTypeID]) VALUES (@HardwareID, @TypeID, @Description, @Name, @Cost, @Weight, @Image, @TypeDesc, @TypeName, @TypeTypeID)" 
        DeleteCommand="DELETE From tblHardware WHERE HardwareID = @HardwareID">
        <UpdateParameters>
            <asp:FormParameter FormField="TypeID" Name="TypeID" />
            <asp:FormParameter FormField="Name" Name="Name" />
            <asp:FormParameter FormField="Description" Name="Description" />
            <asp:FormParameter FormField="Cost" Name="Cost" />
            <asp:FormParameter FormField="Weight" Name="Weight" />
            <asp:FormParameter FormField="Image" Name="Image" />
            <asp:FormParameter FormField="HardwareID" Name="HardwareID" />
        </UpdateParameters>
        <asp:GridView ID="GridView1" runat="server" AllowSorting="True" AutoGenerateColumns="False"
        AutoGenerateDeleteButton="True" AutoGenerateEditButton="True" DataKeyNames="HardwareID,TypeTypeID"
        DataSourceID="dsHardware">
        <Columns>
            <asp:BoundField DataField="HardwareID" HeaderText="HardwareID" InsertVisible="False"
                ReadOnly="True" SortExpression="HardwareID" />
            <asp:BoundField DataField="TypeID" HeaderText="TypeID" SortExpression="TypeID" />
            <asp:BoundField DataField="Description" HeaderText="Description" SortExpression="Description" />
            <asp:BoundField DataField="Name" HeaderText="Name" SortExpression="Name" />
            <asp:BoundField DataField="Cost" HeaderText="Cost" SortExpression="Cost" />
            <asp:BoundField DataField="Weight" HeaderText="Weight" SortExpression="Weight" />
            <asp:BoundField DataField="Image" HeaderText="Image" SortExpression="Image" />
            <asp:BoundField DataField="TypeDesc" HeaderText="TypeDesc" SortExpression="TypeDesc" />
            <asp:BoundField DataField="TypeName" HeaderText="TypeName" SortExpression="TypeName" />
            <asp:BoundField DataField="TypeTypeID" HeaderText="TypeTypeID" InsertVisible="False"
                ReadOnly="True" SortExpression="TypeTypeID" />
        </Columns>
    </asp:GridView> 
```

那么这一切应该如何运作呢？抱歉，我是 ASP.NET 的新手——以前的经典 ASP 开发人员。

**编辑：**  对不起，我应该更清楚。尝试更新时，我收到错误“ `@Hardware needs to be defined`”。不知道为什么，因为它对我来说看起来很明确。此外，我的 .cs 文件中没有代码 - 我假设我需要一些东西，但不确定到底是什么。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:38:56.463

这里只是一个疯狂的猜测，可能是我做错了，但它确实有效 - 尝试将 HardwareID 参数绑定到 gridview？

```
<asp:ControlParameter> should help you out.

<asp:ControlParameter ControlID="GridView1" Name="HardwareID" 

                        PropertyName="SelectedValue" Type="Int32" /> 
```

有点儿。

可能会抱怨别的东西。

[编辑] 哦，那应该在你的“UpdateParameters”和“DeleteParameters”里面。

[再次编辑] 如果您打算检查数据，则只需要 .cs 中的代码。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:50:06.127

上面的代码没有关闭asp:SQLDataSource？

还是只是在复制粘贴中剪掉了？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T20:49:40.863

好的，我猜一些错误的条目（我不知道他们做了什么）以某种方式进入了我的代码。即，这一行：

```
OldValuesParameterFormatString="original_{0}" 
```

...重新制作 gridview 以使用标准方法。奇迹般有效！

如果有人正在阅读此内容，我该如何验证数据？

# multithreading - 线程建模

> ID：782776
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:30:06.537
> 
>         
> 
> 标签：multithreading, modeling

在我的大学时代，我在我的一门课程中遇到了一个 Java 应用程序。您基本上用一种简单的语言对您的线程（它们执行的任何操作等）进行了建模。它将绘制图表并识别您的线程问题。有谁知道这个应用程序叫什么？我在 Google 上尝试了过去 30 分钟，但找不到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:34:29.443

我猜你的意思是“线程状态图”。也许是这样的？

[http://support.objecteering.com/objecteering6.1/help/us/objecteering_uml_modeler/diagrams/state_diagrams.htm](http://support.objecteering.com/objecteering6.1/help/us/objecteering_uml_modeler/diagrams/state_diagrams.htm)

# xml - 用于导入 NUnit 结果的数据库？

> ID：782780
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-04-23T17:32:23.910
> 
>         
> 
> 标签：xml, database, nunit, nunit-console

我有大量的 NUnit 测试；我需要将给定运行的结果导入数据库，然后表征结果集并将其呈现给用户（测试失败时发送电子邮件，检查结果时使用 Web 演示文稿）。我还需要随时间跟踪多次运行（用于报告随时间变化的故障率等）。

XML 将是 nunit-console 生成的 XML。我想以最少的麻烦将 XML 导入某个数据库，然后可以使用该数据库来持久化和呈现结果。我们将有许多自定义类别，我们也需要能够对其进行排序。

有谁知道可以处理导入可以根据我们的个人需求定制的此类数据的数据库模式？这种类型的问题似乎应该很常见，因此应该存在一个通用的解决方案，但我似乎找不到一个。如果有人以前实施过这样的解决方案，也将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T17:36:52.683

在我看来，您实际上是在使用[CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)或[TeamCity](http://www.jetbrains.com/teamcity/)等构建服务器。

让构建服务器运行测试，它会告诉人们失败的原因和原因。

我推荐 TeamCity，因为它更容易设置几个数量级。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-12-07T17:15:44.540

我在这里寻求解决同样的问题。我们目前倾向于编写一个 XSLT 来将 XML 结果转换为插入语句。然后通过命令行 SQL 解释器运行插入语句的结果文件。理想情况下，我宁愿有一个 NUnit 插件/扩展来为我处理所有这些。不幸的是，我一直找不到。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-12-07T17:31:44.247

要构建 IainMH 的答案，您可能想看看将 Trac 与[BITTEN 结合](http://bitten.edgewall.org/)使用，它是一个开源构建系统，可以运行 n 单元测试并报告结果。我目前将它用于那个确切的功能。  

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-12-08T10:18:28.837

使用 MS SQL 时，您可以将所有 XML 导入 [xml] 数据类型的公共列。在此基础上，可以执行 xpath、搜索和转换。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-12-10T16:56:39.603

如果您手头拮据，CruiseControl 或 TeamCity 的另一种选择是[Atlassians Bamboo 。](http://www.atlassian.com/software/bamboo/)我是他们软件的忠实粉丝，因为它易于使用，而且他们有一个交易，你可以花 10 美元买到竹子。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2010-05-21T20:07:18.017

我们希望避免这种情况，但我们已经从 NUnit 结果 XML 模式生成了一个数据库模式；然而，它有点不足，因为 NUnit 做了一些（不准确和奇怪的）处理来确定一些关键的统计信息（例如，“忽略”与“不运行”）。

我们仍然希望找到一个不是完整的 CIT 构建系统的模式/流程，它可以让我们自定义一个用于导入结果的数据库，但目前我们正在使用一个手动数据库，我们需要这样做大量定制以获得所需的报告。

* * *

## 回答 #7

> 赞同：-3
> 
>             
> 
> 时间：2010-05-19T20:14:42.993

为什么需要将结果保存在数据库中？谁将使用它们？失败的数量不能很大。如果是（反复）你的开发过程是错误的。修复过程。消除浪费（精益原则之一），不要收集它。

采取更小的步骤（更短的迭代，持续构建），消除依赖关系。

这并不常见，因为有这类问题的项目不会交付而是被取消（最终）。

[编辑] Michael，在较长时间内跟踪 nunit 故障提供零值。你需要一个简短的反馈循环。现在解决问题。如果你等到你积累了很多问题，你就会被噪音淹没。

好的问题跟踪是在正确的（最高可能的抽象）级别完成的。绝对不是单元测试。

# mysql - Infinity、ActiveRecord 和 MySQL：存储和比较

> ID：782781
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T17:32:48.387
> 
>         
> 
> 标签：mysql, ruby, activerecord, infinity

我有指定事件成本的用户输入字符串（例如：“非会员 4 美元”）。我正在尝试解析成本的上限（和下限）（在示例中`upper == lower == 4.00`）。

假设无法解析给定的字符串（可能是空白）。在这种情况下，我希望能够在数据库中存储事件的最大成本为无穷大（最小为 0）。如何使用 Mysql 和 ActiveRecord 做到这一点？

我试过的：

```
> e = Event.find(1234)
> e.cost_max = 1.0/0.0
> e.save
ActiveRecord::StatementInvalid: Mysql::Error: Unknown column 'Infinity' in 'field list': UPDATE `events` SET `cost_max` = Infinity WHERE `id` = 1234 
```

相反，我也尝试将 cost_max 标记为 NULL。这原则上有效。但是，我正在使用 Ultrasphinx 过滤器来检索成本范围与搜索范围具有非空交集的事件。由于 Ultrasphinx 过滤器只接受哈希条件（我错了吗？），我的选择仅限于此：

```
search_params[:filter].merge!(:cost_max => 0.0..99) 
```

意思是，不允许“OR cost_max is NULL”。

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T17:40:44.500

如果字段类型是 a `double`，您似乎可以存储无穷大值。  

```
VALUE('1e500'); 
```

然后只需将其用作比较的上限即可。

有关更多信息，请参阅mysql 邮件列表中的[此线程](http://lists.mysql.com/java/5988)。

# php - SSL 登录，之后是常规 http……从数据库传输的数据有多脆弱？

> ID：782785
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:34:41.300
> 
>         
> 
> 标签：php, mysql, database, security

我使用搜索引擎浏览了这个问题的网站，但我认为它不存在。如果是这样，请提前道歉，并随时指出我。

这是我的场景：

我正在建立一个 web 应用程序，如果有人熟悉的话，Moodle 会在 Windows 上使用 Apache、MySQL 和 php。Moodle 支持启用 SSL 进行登录，但在建立登录后恢复为常规 http。这是在与外界没有连接的内部网络上运行的，因此无法通过该网络访问 Internet。所有使用该网络的用户都有登录名，但是有一些具有某些受限特权的通用访客类型登录名。目前 MySQL 数据库未加密。

我的问题是这样的：

如果我的用户进行 SSL 登录，然后系统在其会话的剩余部分恢复为 http，那么在浏览器界面和数据库之间来回传输的数据有多脆弱？

我可能更愿意对所有数据进行加密，但我不确定这样做对性能的影响会有多糟糕，因此任何有关此的建议也将不胜感激。虽然我将扩展 Moodle 中的功能，但我不一定希望必须更改它来加密所有内容（如果已经这样做的话）。

我是 IT 安全领域的新手，我的 DBA 技能很生疏，所以如果您给我答案，请慢慢输入，以便我理解！;)

提前致谢！卡维尔

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:41:25.400

一些东西。

1.  DB服务器中的数据没有被加密这一事实是用户和Web服务器之间通信的一个因素。Web 服务器和数据库服务器之间的通信显然是一个问题。

2.  用户和 Web 服务器之间的风险点在于，如果有人能够插入通信链的中间，则可能会嗅探数据包。但是，您在内部网络上的事实减轻了这种风险。

因此，除非您非常关心组织中的其他人，否则您很可能没事。但是，如果它确实是敏感数据，您可以通过 SSL 进行所有通信以确保安全传输。如果您对此感到担忧，那么我还将查看数据库的安全性以及从数据库到网络服务器的通信。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T20:53:12.337

我关心的是如何传播经过身份验证的会话。

通常，会话通过设置 cookie 或将会话 ID 附加到网站提供的任何 URL 来工作。建立登录后，通常不再需要凭据，因为会话随后会链接到用户并被视为已通过身份验证，并且会话本身的存在就是身份验证成功的证明。

但是，正如之前的海报所提到的，本地网络流量可以用于嗅探。如果有人嗅到了会话 id，他们可以使用会话 id 重新创建 cookie 或 url，并以该会话用户的身份简单地访问该站点，如果该选项可用，甚至可以更改用户的密码。

我想说，您在这里的决定取决于您的会话的安全性。如果您有一些缓解因素使会话难以复制，即使会话 ID 被泄露（例如，与 IP 地址比较等），或者您的用户帐户相对安全，不受会话的影响（例如，需要当前密码才能更改帐户设置），然后可能不需要登录后的 SSL。但是，如果您有疑问并且可以承受性能损失，那么在整个站点中使用 SSL 将保证您的会话不会受到损害（只要您可以保证 SSL，无论如何）。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:36:58.703

由于无法通过 Internet 访问此网络，唯一可能发生的事情是其他人（已经在内部网络上）窥探另一个用户的 HTTP 流量。如果有人实际这样做，而您没有使用 SSL，他们可以读取您的网站从该用户发送/接收的所有数据。但这真的是一个问题吗？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:38:01.680

由于您在内部网络上为整个站点启用 SSL，因此性能应该不会那么差，尽管它可能是不必要的。

至少，您应该加密数据库中的数据。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:38:24.427

通过不安全的线路传输时，所有敏感数据都应加密。如果您只是通过 SSL 传输登录详细信息，您的所有数据仍然容易受到窃听。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:39:49.353

由于数据没有加密，任何具有足够网络访问权限（即物理访问权限）的人都可以读取从服务器到浏览器来回传递的数据。只要每个对网络有物理访问权限的人也有权读取数据，你可能就没事了。如果任何信息是敏感的，并且应该被限制为可以被物理访问网络的一部分人查看，那么您需要对其进行加密。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:40:55.247

您网络上的任何人都可以使用 WireShark 之类的网络数据包嗅探器查看其他人的流量。您的 Web 服务器和 MySQL 之间的连接也是明文形式的。MySQL 可能实际上不会以明文形式发送密码；例如，它可能是一个哈希。

如果您真的想变得偏执，您可能不需要通过 HTTPS 运行您的应用程序。还有其他较低级别的可能性，例如 IPSec。由于这是一个内部网络，您可能可以在所有工作站上实现它。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:48:26.570

没有太多可以添加到上述正确响应中。但是，您可以为您的应用程序使用[威胁建模工具](http://msdn.microsoft.com/en-us/security/dd206731.aspx)。这将通知您通过不使用传输级加密 (TLS/SSL) 暴露数据的威胁*类型。*了解威胁后，您可以决定适当的风险缓解计划。

# c# - 表错误中不存在列

> ID：782789
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:35:42.200
> 
>         
> 
> 标签：c#, ado.net, datatable

我对数据集表执行一组操作：

```
MyDataSet sharedDS = new MyDataSet();
MyDataSet referenceDS = new MyDataSet(); 
sharedDS.Table1.Reset(); 
sharedDS.Merge(referenceDS); 
```

如果我尝试以这种方式访问​​列，则会收到 System.ArgumentException: Column_X 在 Table1 中不存在：

```
MyDataSet.Table1.FindByKey().Column_X 
```

但是，这样一切都很好：

```
MyDataSet.Table1.FindByKey()["Column_X"] 
```

谁能解释这里的问题是什么？

参考（原意为另一个问题）：[Reset primary key](https://stackoverflow.com/questions/764004/reset-primary-key)

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:45:53.597

我认为这条线：

```
sharedDS.Table1.Reset(); 
```

给你添麻烦了。

我认为 .reset 正在清除架构。使用 .Clear() 代替！

# c# - 如何安全地使用混淆器？

> ID：782796
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-23T17:36:51.170
> 
>         
> 
> 标签：c#, .net, obfuscation, dotfuscator

当我尝试在我的应用程序上使用 dotfuscate 时，我在运行它时收到一个应用程序错误。

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-04-23T17:41:49.893

Dotfuscator（和所有混淆器）通常可以安全地在应用程序上运行，但它们偶尔会导致问题。如果没有问题的具体细节，就很难诊断。

但是，混淆器的一个常见问题是当您将它们与反射混合时。由于您更改的是类型名称，而不是字符串，因此每当您尝试使用特定字符串名称反射对象并使用反射名称空间构造对象时，您都可能会遇到问题。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-04-23T17:41:04.980

我遇到的大多数混淆问题都围绕着无法更改名称的类型，因为需要对它们进行反映（您的代码或运行时）。  

例如，如果您有一个用作 Web 服务代理的类，则不能安全地混淆类名：

```
public class MyWebServiceProxy : SoapHttpClientProtocol
{

} 
```

还有一些混淆器不能处理泛型方法和类。

诀窍是您需要找到这些类型并防止混淆器重命名它们。这是通过混淆属性完成的：

```
[global::System.Reflection.Obfuscation(Exclude=true, Feature="renaming")] 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T19:33:53.150

混淆器可能存在的另一件事是使用 BinaryFormatter 进行序列化，因为它会更改字段名称。出于这个原因，我有一些用户使用[protobuf-net](http://code.google.com/p/protobuf-net/)对他们的混淆代码进行序列化。

# java - 在 Java 源代码中处理大文本片段

> ID：782810
> 
>         
> 
> 赞同：21
> 
>         
> 
> 时间：2009-04-23T17:40:44.670
> 
>         
> 
> 标签：java, text, heredoc

有没有什么好的方法可以在 Java 源代码中处理文本块（字符串）？许多其他语言都有可用的[heredoc](http://en.wikipedia.org/wiki/Heredoc)语法，但Java没有。这使得使用诸如输出大量静态标记的标记库和需要断言与 XML 块进行比较的单元测试之类的东西非常不方便。

其他人如何解决这个问题？甚至可能吗？还是我只能忍受？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:47:18.587

如果文本是静态的，或者可以参数化，可能的解决方案是将其存储在外部文件中，然后将其导入。但是，这会创建文件 I/O，这可能是不必要的或会影响性能。使用此解决方案需要缓存文件内容以减少文件读取次数。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2011-11-07T16:27:51.727

Java 中 HereDoc 的关闭选项是 java.text.MessageFormat。你不能嵌入逻辑。它是一个简单的值转义实用程序。没有使用任何变量。您必须使用基于零的索引。只需遵循 javadoc。

[http://download.oracle.com/javase/1,5.0/docs/api/java/text/MessageFormat.html](http://download.oracle.com/javase/1,5.0/docs/api/java/text/MessageFormat.html)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:52:39.383

虽然您可以使用某些格式化程序将任何文本文件或长文字转换并嵌入为 Java 字符串（例如，使用换行符、必要的转义符等），但我真的想不出您需要这些功能的常见情况.

软件的趋势通常是将代码与其操作的数据分开。大文本部分，即使只是为了显示或比较，也是数据，因此通常存储在外部。读取文件（甚至将结果缓存在内存中）的成本相当低。国际化更容易。改变更容易。版本控制更容易。可以轻松使用其他工具（例如拼写检查器）。

我同意，在单元测试的情况下，您想将事物与模拟进行比较，您需要进行大规模的文本比较。但是，当您处理如此大的文件时，您通常会有可以处理几个不同的大输入以产生多个大输出的测试，那么为什么不让您的测试加载适当的文件而不是内联呢？

XML 也是如此。事实上，对于 XML，我认为在许多情况下，您会希望读取 XML 并构建一个 DOM 树，然后您将比较它而不是进行可能受空格影响的文本比较。在你的单元测试中手动创建一个 XML 树是很丑的。

# excel - 使用 VBA (Excel) 将整数除以时间

> ID：782820
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:43:32.743
> 
>         
> 
> 标签：excel, vba

我试图将整数的总和除以 [h]:mm:ss 的总和以获得 [s]。在我看来，我是通过这种疯狂的扭曲来做到这一点的。

```
temp = Split(Format(Range("D" & rInx).Value, "hh:mm:ss"), ":", -1, vbTextCompare)
answerDelay = CInt(temp(0)) * 3600 + CInt(temp(1)) * 60 + CInt(temp(2)) 
```

因为这对我来说似乎很奇怪，所以我想我会把它放在那里让你们的大脑看看并告诉我一个更好的方法。

简而言之，这是工作表上公式的结尾

```
range(B1)=838
range(C1)=26:38:44
range(D1)=range(C1)/range(B1) 
```

答案是 109 秒。

它确实有效，因为我在这里拥有它，我只是对我的解决方案不满意。

你有更好的解决方案吗？

提前感谢！克雷格

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T17:58:22.803

Excel 将时间保留为一天的分数，即 24 小时 = 1.0。要转换为秒，只需乘以 24*60*60。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:51:33.007

您可以使用 TimeSpan 将时间转换为秒，然后再进行划分。

我还没有测试过它，但在 C# 中是这样的：

```
var seconds = new TimeSpan(26, 38, 44).Seconds; 
```

这是你的意思吗？

# java - 在 JDBC 中处理 DATETIME 值 0000-00-00 00:00:00

> ID：782823
> 
>         
> 
> 赞同：87
> 
>         
> 
> 时间：2009-04-23T17:45:16.127
> 
>         
> 
> 标签：java, sql, date, jdbc

如果我尝试这样做，我会得到一个例外（见下文）

```
resultset.getString("add_date"); 
```

对于包含 DATETIME 值 0000-00-00 00:00:00 （DATETIME 的准空值）的 MySQL 数据库的 JDBC 连接，即使我只是试图将值作为字符串而不是作为目的。

我通过这样做解决了这个问题

```
SELECT CAST(add_date AS CHAR) as add_date 
```

哪个有效，但看起来很傻......有没有更好的方法来做到这一点？

我的意思是我只想要原始的 DATETIME 字符串，所以我可以自己解析**它**。

**注意：**这里是 0000 的来源：（来自[http://dev.mysql.com/doc/refman/5.0/en/datetime.html](http://dev.mysql.com/doc/refman/5.0/en/datetime.html)）

> 非法的 DATETIME、DATE 或 TIMESTAMP 值将转换为适当类型的“零”值（'0000-00-00 00:00:00' 或 '0000-00-00'）。

具体的例外是这个：

```
SQLException: Cannot convert value '0000-00-00 00:00:00' from column 5 to TIMESTAMP.
SQLState: S1009
VendorError: 0
java.sql.SQLException: Cannot convert value '0000-00-00 00:00:00' from column 5 to TIMESTAMP.
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1055)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:956)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:926)
    at com.mysql.jdbc.ResultSetImpl.getTimestampFromString(ResultSetImpl.java:6343)
    at com.mysql.jdbc.ResultSetImpl.getStringInternal(ResultSetImpl.java:5670)
    at com.mysql.jdbc.ResultSetImpl.getString(ResultSetImpl.java:5491)
    at com.mysql.jdbc.ResultSetImpl.getString(ResultSetImpl.java:5531) 
```

* * *

## 回答 #1

> 赞同：126
> 
>             
> 
> 时间：2010-04-13T13:04:39.663

替代答案，您可以直接在数据源配置中使用此 JDBC URL：

```
jdbc:mysql://yourserver:3306/yourdatabase?zeroDateTimeBehavior=convertToNull 
```

编辑：

### 资料来源：[MySQL 手册](http://dev.mysql.com/doc/connector-j/5.1/en/connector-j-installing-upgrading-3-0-to-3-1.html)

> 具有全零组件的日期时间 (0000-00-00 ...) — 这些值无法在 Java 中可靠地表示。当从 ResultSet 读取时，Connector/J 3.0.x 总是将它们转换为 NULL。
> 
>   
>   
> 
> 当遇到这些值时，Connector/J 3.1 默认会引发异常，因为根据 JDBC 和 SQL 标准，这是最正确的行为。可以使用 zeroDateTimeBehavior 配置属性修改此行为。允许的值为：
> 
>   
>   
> 
> *   **异常**（默认值），它会引发 SQLException，SQLState 为 S1009。
> 
> *   **convertToNull**，它返回 NULL 而不是日期。
> 
> *   **round**，将日期四舍五入到最接近的值，即 0001-01-01。

更新：Alexander 报告了一个影响该功能的 mysql-connector-5.1.15 的错误。请参阅[官方网站上的变更日志](http://dev.mysql.com/doc/relnotes/connector-j/5.1/en/news-5-1.html)。

* * *

## 回答 #2

> 赞同：86
> 
>             
> 
> 时间：2009-07-24T21:04:26.983

我偶然发现了这个试图解决同样问题的方法。我正在使用的安装使用 JBOSS 和 Hibernate，所以我必须以不同的方式进行。对于基本情况，您应该能够根据此[配置属性页面](http://dev.mysql.com/doc/connector-j/5.1/en/connector-j-reference-configuration-properties.html)`zeroDateTimeBehavior=convertToNull`添加到您的连接 URI 。

我在全国范围内发现了其他建议，即将该参数放入您的休眠配置中：

在*hibernate.cfg.xml*中：

```
<property name="hibernate.connection.zeroDateTimeBehavior">convertToNull</property> 
```

在*hibernate.properties*中：

```
hibernate.connection.zeroDateTimeBehavior=convertToNull 
```

但是我不得不将它放在我的*mysql-ds.xml*文件中以供 JBOSS 使用：

```
<connection-property name="zeroDateTimeBehavior">convertToNull</connection-property> 
```

希望这可以帮助某人。:)

* * *

## 回答 #3

> 赞同：11
> 
>             
> 
> 时间：2009-04-23T20:21:40.150

> 我的意思是我只想要原始的 DATETIME 字符串，所以我可以自己解析它。

这让我认为您的“解决方法”不是解决方法，但实际上是将数据库中的值获取到代码中的唯一方法：

```
SELECT CAST(add_date AS CHAR) as add_date 
```

顺便说一下，MySQL 文档中还有一些注释：

MySQL[对无效数据的约束](http://dev.mysql.com/doc/refman/5.0/en/constraint-invalid-data.html)：

> 在 MySQL 5.0.2 之前，MySQL 允许非法或不正确的数据值，并强制它们为数据输入的合法值。在 MySQL 5.0.2 及更高版本中，这仍然是默认行为，但您可以更改服务器 SQL 模式以选择更传统的错误值处理方式，以便服务器拒绝它们并中止它们发生的语句。
> 
> [..]
> 
> 如果您尝试将 NULL 存储到不采用 NULL 值的列中，则单行 INSERT 语句会发生错误。对于多行 INSERT 语句或 INSERT INTO ... SELECT 语句，MySQL 服务器存储列数据类型的隐式默认值。

MySQL 5.x[日期和时间类型](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-types.html)：

> MySQL 还允许您将“0000-00-00”存储为“虚拟日期”（如果您不使用 NO_ZERO_DATE SQL 模式）。在某些情况下，这比使用 NULL 值更方便（并且使用更少的数据和索引空间）。
> 
> [..]
> 
> 默认情况下，当 MySQL 遇到日期或时间类型的值超出范围或该类型非法时（如本节开头所述），它会将值转换为该类型的“零”值。

* * *

## 回答 #4

> 赞同：6
> 
>             
> 
> 时间：2009-08-12T11:52:52.267

```
DATE_FORMAT(column name, '%Y-%m-%d %T') as dtime 
```

使用它来避免错误。它以字符串格式返回日期，然后您可以将其作为字符串获取。

```
resultset.getString("dtime"); 
```

这实际上不起作用。即使您调用 getString。在内部，mysql 仍然首先尝试将其转换为日期。

> 在 com.mysql.jdbc.ResultSetImpl.getDateFromString(ResultSetImpl.java:2270)
> 
> ~[mysql-connector-java-5.1.15.jar:na] 在 com.mysql.jdbc.ResultSetImpl.getStringInternal(ResultSetImpl.java:5743)
> 
> ~[mysql-connector-java-5.1.15.jar:na] 在 com.mysql.jdbc.ResultSetImpl.getString(ResultSetImpl.java:5576)
> 
> ~[mysql-connector-java-5.1.15.jar:na]

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2011-12-06T15:53:53.773

如果在添加行之后：

```
<property
name="hibernate.connection.zeroDateTimeBehavior">convertToNull</property>

hibernate.connection.zeroDateTimeBehavior=convertToNull

<connection-property
name="zeroDateTimeBehavior">convertToNull</connection-property> 
```

仍然是一个错误：

```
Illegal DATETIME, DATE, or TIMESTAMP values are converted to the “zero” value of the appropriate type ('0000-00-00 00:00:00' or '0000-00-00'). 
```

查找行：

```
1) resultSet.getTime("time"); // time = 00:00:00
2) resultSet.getTimestamp("timestamp"); // timestamp = 00000000000000
3) resultSet.getDate("date"); // date = 0000-00-00 00:00:00 
```

分别替换为以下几行：

```
1) Time.valueOf(resultSet.getString("time"));
2) Timestamp.valueOf(resultSet.getString("timestamp"));
3) Date.valueOf(resultSet.getString("date")); 
```

* * *

## 回答 #6

> 赞同：5
> 
>             
> 
> 时间：2013-01-15T23:37:52.980

我解决了这个问题并实施了上面讨论的“convertToNull”解决方案。它在我本地的 MySql 实例中工作。但是当我将我的 Play/Scala 应用程序部署到 Heroku 时，它就不再工作了。Heroku 还将几个 args 连接到他们提供给用户的 DB URL，以及这个解决方案，因为 Heroku 使用连接“？” 之前自己设置的args，是行不通的。但是我发现了一个不同的解决方案，它似乎同样有效。

SET sql_mode = 'NO_ZERO_DATE';

我把它放在我的表描述中，它解决了 '0000-00-00 00:00:00' 不能表示为 java.sql.Timestamp 的问题

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T18:21:16.897

我建议你使用 null 来表示一个空值。

你得到什么异常？

顺便提一句：

没有称为 0 或 0000 的年份。（尽管有些日期允许今年）

并且没有一年中的 0 个月或一个月中的 0 天。（这可能是您的问题的原因）

* * *

## 回答 #8

> 赞同：3
> 
>             
> 
> 时间：2013-05-19T18:17:39.960

我解决了考虑到 '00-00-....' 不是有效日期的问题，然后，我更改了我的 SQL 列定义，添加了“NULL”表达式以允许空值：

```
SELECT "-- Tabla item_pedido";
CREATE TABLE item_pedido (
    id INTEGER AUTO_INCREMENT PRIMARY KEY,
    id_pedido INTEGER,
    id_item_carta INTEGER,
    observacion VARCHAR(64),
    fecha_estimada TIMESTAMP,
    fecha_entrega TIMESTAMP NULL, // HERE IS!!.. NULL = DELIVERY DATE NOT SET YET
    CONSTRAINT fk_item_pedido_id_pedido FOREIGN KEY (id_pedido)
        REFERENCES pedido(id),... 
```

然后，我必须能够插入 NULL 值，这意味着“我还没有注册那个时间戳”......

```
SELECT "++ INSERT item_pedido";
INSERT INTO item_pedido VALUES
(01, 01, 01, 'Ninguna', ADDDATE(@HOY, INTERVAL 5 MINUTE), NULL),
(02, 01, 02, 'Ninguna', ADDDATE(@HOY, INTERVAL 3 MINUTE), NULL),... 
```

该表看起来：

```
mysql> select * from item_pedido;
+----+-----------+---------------+-------------+---------------------+---------------------+
| id | id_pedido | id_item_carta | observacion | fecha_estimada      | fecha_entrega       |
+----+-----------+---------------+-------------+---------------------+---------------------+
|  1 |         1 |             1 | Ninguna     | 2013-05-19 15:09:48 | NULL                |
|  2 |         1 |             2 | Ninguna     | 2013-05-19 15:07:48 | NULL                |
|  3 |         1 |             3 | Ninguna     | 2013-05-19 15:24:48 | NULL                |
|  4 |         1 |             6 | Ninguna     | 2013-05-19 15:06:48 | NULL                |
|  5 |         2 |             4 | Suave       | 2013-05-19 15:07:48 | 2013-05-19 15:09:48 |
|  6 |         2 |             5 | Seco        | 2013-05-19 15:07:48 | 2013-05-19 15:12:48 |
|  7 |         3 |             5 | Con Mayo    | 2013-05-19 14:54:48 | NULL                |
|  8 |         3 |             6 | Bilz        | 2013-05-19 14:57:48 | NULL                |
+----+-----------+---------------+-------------+---------------------+---------------------+
8 rows in set (0.00 sec) 
```

最后：JPA 在行动：

```
@Stateless
@LocalBean
public class PedidosServices {
    @PersistenceContext(unitName="vagonpubPU")
    private EntityManager em;

    private Logger log = Logger.getLogger(PedidosServices.class.getName());

    @SuppressWarnings("unchecked")
    public List<ItemPedido> obtenerPedidosRetrasados() {
        log.info("Obteniendo listado de pedidos retrasados");
        Query qry = em.createQuery("SELECT ip FROM ItemPedido ip, Pedido p WHERE" +
                " ip.fechaEntrega=NULL" +
                " AND ip.idPedido=p.id" +
                " AND ip.fechaEstimada < :arg3" +
                " AND (p.idTipoEstado=:arg0 OR p.idTipoEstado=:arg1 OR p.idTipoEstado=:arg2)");
        qry.setParameter("arg0", Tipo.ESTADO_BOUCHER_ESPERA_PAGO);
        qry.setParameter("arg1", Tipo.ESTADO_BOUCHER_EN_SERVICIO);
        qry.setParameter("arg2", Tipo.ESTADO_BOUCHER_RECIBIDO);
        qry.setParameter("arg3", new Date());

        return qry.getResultList();
    } 
```

最后它的所有工作。我希望对你有所帮助。

* * *

## 回答 #9

> 赞同：2
> 
>             
> 
> 时间：2016-01-29T02:13:48.103

添加到其他答案：如果你想要`0000-00-00`字符串，你可以使用`noDatetimeStringSync=true`（需要牺牲时区转换）。

MySQL 官方错误：[https](https://bugs.mysql.com/bug.php?id=47108) ://bugs.mysql.com/bug.php?id=47108 。

此外，对于历史，JDBC 曾经返回`NULL`日期`0000-00-00`，但现在默认返回异常。
[来源](https://helpx.adobe.com/coldfusion/kb/mysql-error-java-sql-sqlexception.html)

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2016-08-23T08:12:05.310

你可以附加jdbc url

```
?zeroDateTimeBehavior=convertToNull&autoReconnect=true&characterEncoding=UTF-8&characterSetResults=UTF-8 
```

借助这个，sql 将 '0000-00-00 00:00:00' 转换为空值。

例如：

```
jdbc:mysql:<host-name>/<db-name>?zeroDateTimeBehavior=convertToNull&autoReconnect=true&characterEncoding=UTF-8&characterSetResults=UTF-8 
```

# mysql - 推荐的 MySQL 热备份系统？

> ID：782826
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-23T17:46:03.237
> 
>         
> 
> 标签：mysql, database, backup

我正在寻找 mysql 数据库的热备份系统？我想向您请教经验和专业知识。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-23T21:04:03.247

因此，您想寻找 MySQL 问题的良好解决方案的地方是[Mysql Performance Blog/Percona](http://www.mysqlperformanceblog.com/)。具体来说，您要做的是使用他们的[XtraBackup](https://launchpad.net/percona-xtrabackup)，它修复了 InnoDBs 热备份出现的许多问题。[将他们的修补服务器](http://www.percona.com/percona-lab.html)与他们的 InnoDB 替代[XtraDB](http://www.percona.com/docs/wiki/percona-xtradb:start)一起使用会很好。

他们为 MySQL 集成了许多第三方补丁，包括他们自己的和 Google 的，并通过修复、增强和更好的日志记录来增强 InnoDB 存储引擎。此外，Percona 还赞助了一个很棒的 MySQL 工具箱[Maatkit](http://www.maatkit.org/)，它提供了一些组件来帮助您进行备份和完整性检查。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T20:49:52.720

我知道 InnoDB 热备份，但仅适用于 InnoDB

[http://www.innodb.com/products/hot-backup/](http://www.innodb.com/products/hot-backup/)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:54:58.397

我使用[MySQL GUI 管理员工具](http://dev.mysql.com/downloads/gui-tools/5.0.html)。它有一个备份工具，您可以使用它通过 Windows 安排每日备份。您可以创建不同的备份项目、安排备份并控制备份的运行方式和它创建的输出文件的类型。

我一直觉得它很可靠，并且与它捆绑在一起的其他工具对于基本的数据库管理也很有用。

# java - JNI 与 Runtime.exec()

> ID：782827
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-23T17:46:05.080
> 
>         
> 
> 标签：java, java-native-interface

我有两个选择——我可以使用 JNI 或使用 Runtime.exec 来执行 C++ 库。

C++ 程序是 CPU 密集型和长时间运行的，即某些调用可能需要几个小时才能返回。

各自的优缺点是什么？我应该采用哪种方法？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-23T17:48:26.260

如果您需要与 C++ 库交互，请选择 JNI。

如果它是您只想调用的独立程序（也许还想获取输出），那就`Runtime.exec()`简单多了。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T18:46:29.973

您是否将[JNA](https://github.com/twall/jna)视为第三种选择？  

从 JNA 网站：

> JNA 使 Java 程序可以轻松访问本机共享库（Windows 上的 DLL），而无需编写 Java 代码以外的任何内容——不需要 JNI 或本机代码。此功能可与 Windows 的 Platform/Invoke 和 Python 的 ctypes 相媲美。访问在运行时是动态的，无需代码生成。

有关介绍，请参阅他们的[入门](https://github.com/twall/jna/blob/master/www/GettingStarted.md)指南。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T22:04:52.413

使用 JNI 可能会限制您从 32 位迁移到 64 位的能力。您可能还会发现您还必须调整应用程序内存设置。

除非你知道 C++ 的东西写得有多好 - 它可能会使你的应用程序更加不稳定。您很幸运，因为 C++ 位需要几个小时 - 所以只需在外部调用它。

# data-mining - 车辆搜索的最佳数据挖掘方法是什么？

> ID：782829
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:46:53.127
> 
>         
> 
> 标签：data-mining, site-mining

我正在尝试构建一个搜索引擎，该引擎可以浏览在线车辆分类，例如 Oodle、eBay 汽车和 craigslist。我还有一个包含标准车辆名称和规格的大型数据库。我想做的是对于我通过分类网站找到的每条记录，能够准确地确定它是什么车型、款式（来自我的数据库）。例如，我的数据库中福特卡车的标准名称是：2003 Ford F150。

然而，在分类网站上，人们可能将其称为：“2003 Ford F 150”或“2003 Ford f-150”或“03 Ford truck 150”。是否有有效的数据挖掘/文本分类算法能够将这些文本标准化为上述标准名称？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T17:52:09.930

您可以使用[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)将找到的字符串与您的数据库记录进行匹配。

另一个（可能更好）的想法是对字符串进行标记，并对车辆名称使用[术语向量模型](http://en.wikipedia.org/wiki/Vector_space_model)。通过这种方式，您可以使用余弦相似度来查找相关匹配项。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2013-12-05T16:28:44.233

如果您要开发一个旨在同时扩展使用和大小的整个搜索引擎，您将需要一些强大的东西来支持您的查询。

如果您要使用编辑距离，[床树](http://www.cse.iitb.ac.in/~comad/2010/pdf/SIGMOD%20Highlight%20Session/sigmod10-bed-slides.pdf)为您的索引结构提供了一个很好的选择。根据数据集的大小，另一种好方法是使用[Levenshtein automata](http://blog.notdot.net/2010/07/Damn-Cool-Algorithms-Levenshtein-Automata)。Levenshtein 自动机也非常擅长提供自动完成功能，因为您正在开发搜索引擎，因此您可能需要这些功能。

编辑距离的另一种方法是使用结合 Jaccard 索引的 n-gram。对于这种方法，您可以使用[Minhash + LSH](http://www.stanford.edu/class/cs246/slides/03-lsh.pdf)。此外，您可以将 Jaccard 用作尊重三角不等式的距离度量（1 - Jaccard 索引），因此可以在[VP-tree](http://stevehanov.ca/blog/index.php?id=130)等度量树中使用。

其中一种方法肯定会对您有所帮助。

# sql - 访问数据库，通过最大问题选择组

> ID：782835
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T17:50:24.070
> 
>         
> 
> 标签：sql, database, ms-access

在**Access DB** ...我需要为下表中最常使用 desc 的每个 itemcode 提取 itemcode / desc 组合。

**最常见的可能意味着只有一个版本（参见梨的附加记录）**

在**itemcode 777**的情况下，我必须稍后决定使用哪个描述版本。如果有多个记录，每个记录都包含一个版本的描述，那肯定会产生额外的问题。

最初的问题可能还应该包括返回像 777 这样的项目代码的第一行，其中项目代码的所有现有记录都包含一个唯一的描述（以便计数始终为 1）。第一行可能并不总是正确的版本 - 但无论如何我都无法自动化该阶段。

```
---------------------
itemcode  | desc
---------------------
123       | apple
123       | apple
123       | apple
123       | apple 2
123       | apple-2
001       | orange
001       | orange
001       | ORANGE 1
001       | orange-1
666       | pear
777       | bananananana
777       | banana 
```

所以 - 我希望得到以下结果：

```
---------------------
itemcode  | desc
---------------------
123       | apple
001       | orange
666       | pear
777       | bananananana 
```

我想我已经接近了，但以下仅获取数据库中出现频率最高且仅返回一行的描述。  

```
SELECT itemcode, desc, count(desc)
from table
group by itemcode, desc
having count(desc) = 
(
 select max(ct) from 
 (
  select itemcode, desc, count(desc) as ct
  from table
  group by itemcode, desc
  )
); 
```

返回：

```
---------------------
itemcode  | desc
---------------------
123       | apple 
```

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T18:27:19.410

这将通过相关的子查询起作用：

```
SELECT 
  t.itemcode, t.desc, Count(t.desc) AS CountOfdesc
FROM 
  [table] AS t
GROUP BY 
  t.itemcode, t.desc
HAVING 
  Count(t.desc) IN (
    SELECT TOP 1 
      Count(i.desc)
    FROM 
      [table] AS i
    WHERE 
      i.itemcode = t.itemcode
    GROUP BY 
      i.itemcode, i.desc
    ORDER BY 
      Count(i.desc) DESC
  )
  AND t.desc = (
    SELECT TOP 1 
      i.desc
    FROM 
      [table] AS i
    WHERE 
      i.itemcode = t.itemcode
    GROUP BY 
      i.itemcode, i.desc
    ORDER BY 
      i.desc
  )
; 
```

返回（使用 Access 2003 测试）：

```
itemcode desc CountOfdesc
001橙2
123 苹果 3
666梨1
777 香蕉 1

```

顺便说一句，您真的不应该将表称为“表”和“desc”列。这些是保留的 SQL 关键字，请避免使用它们以使您的生活更轻松。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T17:55:59.580

您的查询返回 MAX。找到一种方法来创建满足您要求的规则。

那个“出现频率最高的”是什么意思？出现>2？出现>3？出现>4?...

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:07:37.180

固定和测试。它可以按预期工作 - 或按设计更好，因为如果 ItemCode 的最高计数出现多次，它会返回所有行。

```
SELECT ItemCode, ItemDescription, COUNT(ItemDescription) AS ItemCount
FROM Items I1
GROUP BY ItemCode, ItemDescription
HAVING COUNT(ItemDescription) = 
   (SELECT MAX(ItemCount)
      FROM (
         SELECT COUNT(ItemDescription) AS ItemCount
         FROM Items I2
         WHERE I2.ItemCode = I1.ItemCode
         GROUP BY ItemDescription
      ) I3
   ) 
```

**更新**

只是稍微简化了查询。

**更新**

无法验证它是否适用于 Access 2003。尝试过，但 Access 一直要求`I1.ItemCode`.

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2009-04-23T18:00:29.473

~~等等，你为什么不能按数量点菜，然后随心所欲地拿上顶？我误解了你的问题吗？例如 ...~~

 ~~```
SELECT TOP N itemcode, desc, count(desc) AS [Count] FROM table
GROUP BY itemcode, desc
ORDER BY [Count] 
```~~ 

 ~~~~好吧，这个怎么样...~~~~

 ~~~~```
;WITH dt AS
(
  SELECT 
  ROW_NUMBER() OVER 
  ( PARTITION BY itemcode ORDER BY COUNT([desc])DESC ) AS 'RowNumber',
  COUNT([desc]) AS [Count],
   itemcode,
   [desc] 
   FROM [table]
   GROUP BY itemcode, [desc]
)
SELECT * FROM dt WHERE dt.RowNumber = 1 
```~~ 

~~这会阻止h8吗？:)~~ 

啊访问！我放弃！

# php - PHP/MySQL：创建基于大型网站数据库的正确方法

> ID：782841
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T17:51:44.673
> 
>         
> 
> 标签：php, mysql, database-design, data-structures, mysqli

我正在创建一个电影网站，IMDB.com 之类的.. 我对 PHP 和编程真的很陌生，但我当然有一些书和 StackOverflow :)

我已经做了很多工作，但是现在我每页有 600 多行代码（仅限 PHO）和 20 多个数据库表，仅用于存储和获取电影数据（多对多关系）

大部分代码是 MySQLi 查询（准备好的语句）来插入/获取数据和循环。没什么花哨的，只是基本的 PHP/MySQL。

我有一些疑问：

*   建议对每个 SQL 查询使用 MySQLi 准备好的语句，还是最好只使用旧的 MySQL 进行内部 PHP/数据库查询，只留下准备好的语句供用户输入？

*   要获取所有电影数据并显示它，我需要从超过 16 个不同的表中获取数据。我对每个表使用一个 MySQL 查询（有时更多）和很多循环。这是网站需要工作的正确方式？我的意思是..这是正常的？？？

*   如何简化代码以简化阅读？我可以将所有这些查询分离到外部文件吗？我可以创建函数来处理每个表查询吗？

希望您能帮帮我，也许您对正确构建这样的网站有更多建议。

谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T19:38:17.820

正如上面的回答中提到的，我还会指出您使用一个隐含 MVC 设计模式的框架。除此之外，大多数框架都内置了 ORM，但如果没有，您可以查看 Symphony 或 EZPDO 是另一个很好的 ORM，可以在 (M)VC 中与您的模型相关联。

CodeIgniter 是一个非常快速和轻量级的 MVC 框架，它可以让您快速引导，但您可能还想研究 ZF（ZendFramework）。ZF 具有出色的框架功能集，并且总体上非常灵活。

除此之外，请务必将您的读取和写入分开，或者在 Model 或您对所选 ORM 的调用中。这将允许您将数据从属到多个 MySQL Box 以获得更大的性能，但允许您使用一个数据库引擎开始。

添加使用 Memcached 的功能，以便您可以缓存数据/对象而不是访问数据库。

使用缓存时，请考虑如何使缓存过期以进行数据库更新。换句话说，如果您从数据库中选择数据以显示在视图中并且该数据没有更改，则您不需要每次都访问数据库，而是从内存中提取它。一旦数据确实发生了变化，您就希望使该缓存无效，使其不会过时，然后重新缓存新数据。

内存缓存：[http](http://www.danga.com/memcached/) ://www.danga.com/memcached/ '

-facebook也有一个版本

CodeIgniter - [http://codeigniter.com/](http://codeigniter.com/)

EZPDO - [http://www.ezpdo.net/blog/?p=2](http://www.ezpdo.net/blog/?p=2)

ZendFramework - [http://framework.zend.com/](http://framework.zend.com/)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:03:05.210

考虑为您的网站查看或使用 Web 框架。

symfony CakePHP CodeIgniter

是一些比较主流的。如果有的话，向他们学习。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:06:46.073

1.  准备好的语句适合您自己的内部查询。您将对所有查询采用结构化的方法。

2.  好吧，这取决于您展示的内容。但我想说的是，您通常可以使用联接从更多表中获取所需的数据。获取正确数据的查询会少很多，而且听起来您的所有数据都以某种方式与您正在放映的一部电影相关联。

3.  正如 Peter D 评论的那样，我建议使用 Web 框架来学习如何将数据库处理与视图分离。您现在正在使用面向对象的方法吗？看看这些框架中的一些实现的 MVC 模式，它会让你继续前进。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:37:57.763

就像之前提到的 Peter D 一样，将这个添加到要使用的框架列表中。Zend Framework [http://framework.zend.com](http://framework.zend.com)
开源免费。

> 1.  推荐使用 MySQLi ...

肯定是 MySQLi，但它本身就是一个大问题，如果你开始编码，你需要掌握 T-SQL 的基础知识才能理解其中的区别。

> 2.  要获取所有电影数据...

这取决于很多事情。数据库大小。想要的结果，即需要显示的信息、查询的响应时间与在用户视图中显示的时间。你知道JOIN，UNION吗？

> 3.  如何将代码简化为...

是的所有这些问题。www.w3schools.com/php/ 如果它可以帮助并学习 MVC 模式。这些天对很多编程语言很有用。也许一个框架会在这里帮助你

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T20:07:53.100

对于这个问题：

> “要获取所有电影数据并显示它，我需要从超过 16 个不同的表中获取数据。我对每个表使用一个 MySQL 查询（有时更多）和大量循环。这是网站需要工作的正确方式吗？ ？我的意思是..这很正常？？？”

**不。**如果我理解正确，您应该使用某种类型的 JOIN，具体取决于您从数据库中检索的数据。获取大量数据的结果，然后在 PHP 中只挑选出你想要的部分，这比让数据库只排序/检索你想要显示的记录/信息要慢得多。

我强烈推荐一本有点过时但非常容易掌握的书，它涵盖了 PHP 和 MySQL/数据库的一般内容：[http](http://www.dmcinsights.com/phpmysql2/) ://www.dmcinsights.com/phpmysql2/ - 它涵盖了许多“实践”技术以及代码，所以学习会很棒。

显然有一个带有更新信息的第三版，但我没有看过它。

# php - 推荐替换已弃用的 call_user_method？

> ID：782846
> 
>         
> 
> 赞同：23
> 
>         
> 
> 时间：2009-04-23T17:53:35.327
> 
>         
> 
> 标签：php, deprecated

由于 PHP[`call_user_method()`](http://php.net/call_user_method)和[`call_user_method_array()`](http://php.net/manual/function.call-user-method-array.php)标记为已弃用，我想知道推荐什么替代方案？

一种方法是使用[`call_user_func()`](http://php.net/manual/function.call-user-func.php)，因为通过给一个带有对象和方法名称的数组作为第一个参数，它的作用与不推荐使用的函数相同。由于这个函数没有被标记为弃用，我认为原因不是它们的非 OOP 风格的用法吗？

我能想到的另一种方法是使用[Reflection API](http://php.net/manual/language.oop5.reflection.php)，这可能是最舒适且面向未来的替代方案。尽管如此，它的代码更多，我可以想象它比使用上面提到的函数要慢。

我感兴趣的是：

*   是否有一种全新的技术可以通过名称调用对象的方法？

*   哪个是最快/最好/官方的替代品？

*   弃用的原因是什么？

* * *

## 回答 #1

> 赞同：29
> 
>             
> 
> 时间：2009-04-23T17:58:55.453

正如您所说[`call_user_func`](http://www.php.net/call_user_func)，可以轻松复制此功能的行为。有什么问题？

该[`call_user_method`](http://us.php.net/call_user_method)页面甚至将其列为替代方案：

```
<?php
call_user_func(array($obj, $method_name), $parameter /* , ... */);
call_user_func(array(&$obj, $method_name), $parameter /* , ... */); // PHP 4
?> 
```

至于*为什么*不推荐使用此功能，[此帖子对此进行了解释：](http://www.mail-archive.com/php-dev@lists.php.net/msg11576.html)

> 这是因为`call_user_method()`和`call_user_method_array()`函数可以通过以下方式轻松复制：
> 
>   
>   
> 
> 老办法：
> 
>   `call_user_method($func, $obj, "method", "args", "go", "here");`
> 
>   
>   
> 
> 新方法：
> 
>   `call_user_func(array(&$obj, "method"), "method", "args", "go", "here");`

就个人而言，我可能会接受乍得发布的可变变量建议。

* * *

## 回答 #2

> 赞同：18
> 
>             
> 
> 时间：2009-04-23T17:59:10.507

您可以使用[变量 variables](http://php.net/manual/en/language.variables.variable.php)来做到这一点，这对我来说看起来最干净。代替：

```
call_user_func(array($obj, $method_name), $parameter); 
```

你做：

```
$obj->{$method_name}($parameter); 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2012-12-30T15:22:37.943

做这样的事情：

我在我的 __construct() 方法中使用了类似的东西。

```
$params = array('a','b','c'); // PUT YOUR PARAMS IN $params DYNAMICALLY

call_user_func_array(array($this, $this->_request), array($params)); 
```

第一个参数：Obect 实例，第二个参数：调用方法，第三个参数：参数

在您也可以测试方法或类之前，使用：

```
method_exists()
class_exists() 
```

干杯

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2013-05-20T12:18:01.610

如果您收到以下错误：警告：call_user_func() 期望参数 1 是有效回调，第二个数组成员不是第 X 行 C:\www\file.php 中的有效方法，代码如下：

```
call_user_func(array($this, $method)); 
```

使用（字符串）声明 $method 名称

```
call_user_func(array($this, (string)$method)); 
```

# vb.net - 使用 VB.Net 的 NerdDinner 验证问题

> ID：782848
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T17:53:39.477
> 
>         
> 
> 标签：vb.net, model-view-controller

新手问题。我正在 VB.Net 中编写一个 ASP.Net MVC 应用程序，并且一直使用 NerdDinner 作为示例（在 C# 中）。我被困在验证过程中，特别是在 Models\Dinner.cs 中找到的代码。我曾尝试使用[http://www.developerfusion.com/tools/convert/csharp-to-vb/](http://www.developerfusion.com/tools/convert/csharp-to-vb/)将其转换为 VB.Net，  但它在 GetRuleViolations 方法中发现的 Yield 语句阻塞（参见下面的代码）。所以我的问题是你将如何在 VB.Net 中做同样的事情？

命名空间 NerdDinner.Models {

```
[Bind(Include="Title,Description,EventDate,Address,Country,ContactPhone,Latitude,Longitude")]
public partial class Dinner {

    public bool IsHostedBy(string userName) {
        return HostedBy.Equals(userName, StringComparison.InvariantCultureIgnoreCase);
    }

    public bool IsUserRegistered(string userName) {
        return RSVPs.Any(r => r.AttendeeName.Equals(userName, StringComparison.InvariantCultureIgnoreCase));
    }

    public bool IsValid {
        get { return (GetRuleViolations().Count() == 0); }
    }

    public IEnumerable<RuleViolation> GetRuleViolations() {

        if (String.IsNullOrEmpty(Title))
            yield return new RuleViolation("Title is required", "Title");

        if (String.IsNullOrEmpty(Description))
            yield return new RuleViolation("Description is required", "Description");

        if (String.IsNullOrEmpty(HostedBy))
            yield return new RuleViolation("HostedBy is required", "HostedBy");

        if (String.IsNullOrEmpty(Address))
            yield return new RuleViolation("Address is required", "Address");

        if (String.IsNullOrEmpty(Country))
            yield return new RuleViolation("Country is required", "Address");

        if (String.IsNullOrEmpty(ContactPhone))
            yield return new RuleViolation("Phone# is required", "ContactPhone");

        if (!PhoneValidator.IsValidNumber(ContactPhone, Country))
            yield return new RuleViolation("Phone# does not match country", "ContactPhone");

        yield break;
    }

    partial void OnValidate(ChangeAction action) {
        if (!IsValid)
            throw new ApplicationException("Rule violations prevent saving");
    }
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T18:05:33.720

在 VB 中获得“完全等价物”需要您使用状态值和 switch 语句对 IEnumerator(of RuleViolation) 进行自定义实现。然而，对于这么简单的事情，那将是矫枉过正。

您可以通过创建一个列表并像这样填充它来获得“几乎等效”的版本：

```
public function GetRuleViolations() as IEnumerable(of RuleViolation)
    dim ret = new List(of RuleViolation)();

    'replace the ... with the appopriate logic from above.
    if ... then
        ret.Add(...)
    end if

    return ret
end function 
```

这比 C# 版本的效率略低，因为它创建一个列表并一次返回所有项目，而 C# 版本在执行“foreach”语句时即时返回每个项目。在这种情况下，列表很小，所以没什么大不了的。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:04:35.703

不幸的是，在 VB.Net 中没有等效的 yield 语句。

# c# - 从 .net Windows 窗体应用程序上传数据

> ID：782849
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T17:53:56.603
> 
>         
> 
> 标签：c#, .net, windows, web-services

对不起，如果这听起来很无知。是否可以使用 asp.net Web 服务或其他方法从 Windows 窗体应用程序安全上传数据？如果是这样，一般的做法是什么？

我以前从未使用过网络服务。

我有一个安装了 .net 3.5 的 IIS 6 服务器。我需要构建这个 Windows 窗体程序，它将数据保存在本地 sql 紧凑型数据库中。当程序可以访问互联网时，用户需要能够将本地数据移动到 Web 服务器上的数据库中。

我可以采取哪些方法来做到这一点？我在考虑 Web 服务方面是否走在正确的轨道上？我还阅读了一些有关 Sync Framework 的信息，但我不确定这是否非常适合。

感谢您的建议。

### 编辑

我忘了问：WCF 会是一种可能有用的技术吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T17:56:36.770

是的。只需通过 SSL 保护 Web 服务。

WCF 也可以是一项有用的技术。您可能还需要考虑 SQL Server 合并复制。

# vb.net - 如何在 linq 中对实体进行内部连接？

> ID：782855
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T17:56:17.580
> 
>         
> 
> 标签：vb.net, linq

给定两个表，customer 和 orders，如何对实体进行 linq 查询以查找在某个日期之前开始的未结发票的任何客户？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:04:09.917

VB.net

```
Dim query = _
    From customer In customers _
    From order In orders _
    Where customer.CustomerID = order.Customer.CustomerID _
    And order.OrderDate <=  dtOrderDate _
    And order.IsOpen = True _
    Select New With _
    { _
        CustomerID = customer.CustomerID, _
        OrderID = order.SalesOrderID, _
        Total = order.TotalDue _
    } 
```

我修改了[查询表达式语法示例中的代码](http://msdn.microsoft.com/en-us/library/bb738447.aspx)

我从[Linq 到 entites 网站](http://msdn.microsoft.com/en-us/library/bb386964.aspx)

# design-patterns - 糟糕的设计？可能导致包中错误的类

> ID：782877
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T18:01:00.720
> 
>         
> 
> 标签：design-patterns, oop

假设我创建了一些由几个类组成的客户端代码。用户能够创建导致抛出异常的类/对象。这是糟糕的设计吗？您的理想代码是否应该使某人不可能导致异常？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T18:03:05.833

不，设计模式不会忽略例外。您的库中可能存在需要强/弱异常保证的部分/功能。但这完全取决于图书馆。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:06:59.660

当给定用户提供的对象时，有无数的 API 示例会引发异常。这绝不是好的设计中的坏设计，并且表明 API 正在验证其输入。

我想到的第一个例子是.NET 的`System.IO.File.Delete(string)`函数，如果找不到要删除的文件，它会抛出异常。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:05:43.813

不，我使用的每个 API 都完全能够引发异常。这样看；您将一些“坏”数据传递给框架类。你宁愿发生什么；抛出异常使问题立即显而易见，或者调用静默失败并且您花费数小时试图找出您的代码为什么不起作用？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:10:31.167

您的类可以抛出异常，但您应该检查它的所有输入并尽可能抛出受控异常。我的意思是，如果您知道某些参数无效，请抛出 InvalidArgumentException 或类似的东西。抓住你应该发现的错误，处理它们或抛出它们。

# html - 可以从 html 表单发出 XML-RPC 请求吗？

> ID：782879
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T18:02:47.427
> 
>         
> 
> 标签：html, forms, xml-rpc

我正在使用一项新服务的非常简单的 API，我只是好奇是否可以直接从 html 表单发送 xml-rpc 请求。api请求示例是这样的：

```
<?xml version="1.0"?>
<methodCall>
<methodName>send</methodName>
    <params>
        <param><value><string>YOUR_API_KEY</string></value></param>
        <param><value><string>msg@mycompany.com</string></value></param>
        <param><value><string>5551231234</string></value></param>
        <param><value><string>Test Message from PENNY SMS</string></value></param>
    </params>
</methodCall> 
```

我当前的表单迭代是这样的：

```
 <form method="POST" enctype="text/xml" action="http://api.pennysms.com/xmlrpc">

            <input type="hidden" name="api_key" value="MYAPIKEY"/>

            <label for="from">From</label>
            <input type="input" name="from" value=""/>

            <label for="phone">Phone</label>
            <input type="input" name="phone" value=""/>

            <label for="text">Text message</label>
            <input type="input" name="text" value="">

            <input type="submit" value="Send"/>

    </form> 
```

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T18:11:39.807

并非不涉及 Javascript 或服务器代码。“enc-type”属性指定表单数据发送到服务器的格式，不幸的是“xml-rpc”不在接受的格式列表中:)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T18:12:55.543

不，这在纯 HTML 中是不可能的。提交表单数据的唯一[标准编码](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4)`application/x-www-form-urlencoded`是和`multipart/form-data`。

您可以使用 XMLHTTPRequest 从 JavaScript 执行此操作，但仅限于与 HTML 来自同一域的 API。在谷歌快速搜索后，我找到[了这个 AJAX XML-RPC 客户端](http://www.zentus.com/js/xmlrpc.js.html)，虽然我从未使用过它，所以我不能保证它。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2010-07-20T15:28:45.660

这可能取决于服务器是否实际执行 enctype

例如，使用此处显示的技术[http://pentestmonkey.net/blog/csrf-xml-post-request](http://pentestmonkey.net/blog/csrf-xml-post-request)您可以跨站点发布 XML POST 数据。

# c# - 如何替换2个文件？

> ID：782888
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T18:06:11.207
> 
>         
> 
> 标签：c#, .net, winforms

我有这个代码片段

```
 private List<string> FolderOne(string Folder)
    {

        string filena;
        DirectoryInfo dir = new DirectoryInfo(Folder);
        FileInfo[] files = dir.GetFiles("*.mp3", SearchOption.AllDirectories);

        List<string> str = new List<string>();

        foreach (FileInfo file in files)
        {
            str.Add(file.FullName);
                      filena = file.FullName;
                            filena.Replace("*.mp3", "*.jpg");
                            if (filena.Length > 0)
                            {
                                pictureBox1.Image = new System.Drawing.Bitmap(filena.ToString()); //I receive a error "Parameter is not valid."
                            }
        }
        return str;

    } 
```

我的目的是在同一文件夹中读取图片框的文件。全名“.mp3”但以“.jpg”结尾，事实上我在一个文件夹中有 2 个文件第一个是歌曲“firstsong.mp3”和第二张图片“firstsong.jpg”它们之间的区别是最终扩展名，所以我尝试读取相同的文件名但扩展名为“.*jpg”的图片框，我收到错误“参数无效”。在行代码“pictureBox1.Image = new System.Drawing.Bitmap(filena.ToString());”中。我怎么能解决这个问题？感谢您的关注

很好的问候

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T18:30:11.243

您的代码还有其他一些问题。首先，您要存储所有 mp3 文件名，但只显示最后加载的图像。

至于替换扩展，使用`Path`'s 方法来做到这一点：

```
string musicFile = "mysong.mp3";
string imageFile = Path.ChangeExtension(musicFile, "jpg"); 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T18:08:57.830

切换到：

```
filena = filena.Replace(".mp3", ".jpg");
if (filena.Length > 0)
{
    pictureBox1.Image = new System.Drawing.Bitmap(filena); 
} 
```

主要问题在于`filena.Replace("*.mp3", "*.jpg");`

该行有两个问题。

首先，您搜索的是“*.mp3”，而不仅仅是“.mp3”。单个文件名没有 * 字符，并且 string.Replace 不使用正则表达式，只是字符串匹配。

其次，.NET 中的字符串是不可变的。它们一旦创建就无法更改。这意味着您不能就地替换字符串的值 - 您总是返回一个新字符串。所以 string.Replace(...) 将返回一个新字符串。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:31:45.313

我将通过添加您应该通过执行以下操作来检查 jpg 是否存在来添加到先前的建议中：   

```
if (File.Exists(jpgFilePath)) {
     pictureBox1.Image = new System.Drawing.Bitmap(jpgFilePath);
} 
```

# asp.net - 在不重新编译 ASP.NET 应用程序的情况下编辑资源文件

> ID：782899
> 
>         
> 
> 赞同：27
> 
>         
> 
> 时间：2009-04-23T18:09:28.937
> 
>         
> 
> 标签：asp.net, resources, resx

我想让资源文件在部署后可编辑。我读[了这篇](https://stackoverflow.com/questions/703054/on-a-deployed-asp-net-web-site-project-can-i-update-a-resx-file-without-recompi)文章，这表明这是可能的，但我似乎无法弄清楚我需要更改哪些设置才能启用它。

我已将 App_GlobalResources 文件夹添加到我的 ASP.NET 3.5“Web 应用程序”中，并在此文件夹中添加了一个资源文件。我假设需要更改此文件的构建操作，但无论我将构建操作更改为什么，我都无法实现上述功能。

App_GlobalResources 文件夹和资源文件被复制到 bin 目录中。部署后，不会显示对 .resx 文件的任何编辑。

有任何想法吗？

* * *

## 回答 #1

> 赞同：28
> 
>             
> 
> 时间：2009-10-07T20:26:34.580

你可以做到这一点，而我刚刚做到了。

选择项目中的资源文件。将构建操作更改为内容。确保“复制到输出目录”设置已关闭。当您部署您的项目时，App_GlobalResources 目录和您的 .resx 文件将被复制到您网站的根目录。您可以修改 .resx 文件，您的实时站点将识别这些更改。

* * *

## 回答 #2

> 赞同：13
> 
>             
> 
> 时间：2009-04-23T18:28:21.967

Web 应用程序项目不同于网站项目。我怀疑您能否通过 Web 应用程序项目实现您想要的。你可以看看这个帖子：

[ASP.NET 网站还是 ASP.NET Web 应用程序？](https://stackoverflow.com/questions/398037/asp-net-web-site-or-web-application)

资源通常是静态的。它们是您的程序使用并且可以依赖存在的图像、字符串和文件等项目（因此可以在字符串/RESX 文件的情况下进行强类型化）。使用资源的原因仅仅是将它们与您的 DLL 捆绑在一起，以便分发和引用资源变得更加容易。

在运行时可编辑表明您可能想要使用项目或用户设置，或者可能是数据库？如果您需要使用 RESX 文件，您可能需要编写代码来读/写它们。

# web-services - jXchange - 如何开始？

> ID：782900
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-23T18:09:33.540
> 
>         
> 
> 标签：web-services

[jXchange显然是由](http://www.jackhenrybanking.com/Default.aspx?P=465d93c4-539e-4570-809d-9e1607b6b2ed)[Jack Henry](http://www.jackhenrybanking.com/)公司开发的某种 Web 服务。它用于（我假设）与您的核心 AS400 系统通信。

我确实发现对于如何开始使用它的文档*没有任何用处。*

**有没有人有这方面的经验，可以指导我一个好的起点？**

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-24T15:11:53.350

如果您正在为我们获得 jXCHANGE 许可的客户之一工作，您可以通过电子邮件向 VendorQA@jackhenry.com 发送帮助请求。如果您由 JHA 客户赞助，我们确实有可用的供应商文档。

# c# - 关于重构为抽象类的基本问题

> ID：782906
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-04-23T18:11:49.760
> 
>         
> 
> 标签：c#, inheritance, abstract-class

这可能是一个初学者的问题，但是否有一种标准方法可以将 Wheel 属性的副本重构到抽象类中，但仍保持对 Part 类型的显式转换。假设我们必须防止将 FastCarWheel 放在 SlowCar 上，并且有很多属性就像这个一样。

```
abstract class Car {}

class FastCar : Car
{
    public FastCarWheel Wheel { get; set; }
} 

class SlowCar : Car
{
    public SlowCarWheel Wheel { get; set; }
} 

abstract class WheelPart {}

class FastCarWheel: WheelPart {}

class SlowCarWheel: WheelPart {} 
```

在这种情况下，只允许这种类型的复制是否很常见？我正在考虑使用泛型，但似乎我正在解决这个问题，并且对于每个以这种方式运行的附加属性来说，情况会变得更糟。

```
abstract class Car <P>
    where P : Part
{
    protected abstract P Wheel { get; set; }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:18:07.123

我认为使用`Fast`or`Slow` [策略](http://en.wikipedia.org/wiki/Policy-based_design)可以帮助为给定的汽车类型放置正确的车轮（其中`Car`和`Wheel`都依赖于策略，并且`Car`对象具有例如车轮的私有聚合）。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:18:53.487

此解决方案不是多态的，但如果您需要基类级别的可见性，它可能是您唯一的选择：

```
abstract class Car
{
    private CarWheel wheel;
    public CarWheel Wheel
    {
        get { return wheel; }
        protected set { wheel = value; }
    }
}

class FastCar : Car
{
    public new FastCarWheel Wheel
    {
        get { return base.Wheel as FastCarWheel; }
        set { base.Wheel = value; }
    }
}

class SlowCar : Car
{
    public new SlowCarWheel Wheel
    {
        get { return base.Wheel as SlowCarWheel ; }
        set { base.Wheel = value; }
    }
} 
```

您可能想评估您的基类是否做得太多。可以通过将您的课程分成许多较小的课程来解决您的问题。另一方面，有时这是不可避免的。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:19:31.363

我会创建一个 ICar 然后以这种方式定义你的 Cars，而不是一个抽象类

```
interface ICar
{
   IWheel Wheel {get; set;}
}

class FastCar: ICar
{
   FastWheel fastWheel;
   IWheel Wheel
   {
      get { return fastWheel; }
      set
      {
          if (value is FastWheel) fastWheel = (FastWheel)value;
      }    
   }         
}

class SlowCar: ICar
{
   SlowWheel slowWheel;
   IWheel Wheel
   {
      get { return slowWheel; }
      set
      {
          if (value is SlowWheel ) slowWheel = (SlowWheel )value;
      }    
   } 
}

class FastWheel: IWheel {}
class SlowWheel: IWheel {} 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:32:51.503

由于您的目标似乎是允许客户端代码将属性作为 WheelPart 取回，但仅将其设置为特定的子类，您有几个选项。虽然我担心他们都不是很干净。

首先，如果设置了错误的类型，您可能会引发运行时错误：

```
 public abstract class Car
    {
        public abstract WheelPart Wheel { get; set; }
    }

    public class FastCar : Car
    {
        private FastWheel _wheel;
        public override WheelPart Wheel
        {
            get { return _wheel; }
            set
            {
                if (!(value is FastWheel))
                {
                    throw new ArgumentException("Supplied wheel must be Fast");
                }
                _wheel = (FastWheel)value;
            }
        }
    } 
```

但我不会这样做，因为客户端代码非常不清楚任何其他类型的轮子会抛出异常，并且他们不会得到编译器反馈。

否则，您可以将属性的 Getter 和 Setter 分开，以便非常清楚所需的类型：

```
 public abstract class Car
    {
        public abstract WheelPart Wheel { get; }
    }

    public class FastCar : Car
    {
        private FastWheel _wheel;
        public override WheelPart Wheel
        {
            get { return _wheel; }
        }

        public void SetWheel(FastWheel wheel)
        {
            _wheel = wheel;
        }
    } 
```

如果您绝对必须将 getter 公开为基础 WheelPart 类，这对客户来说更清楚，恕我直言，这是一个更好的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:14:50.330

定义一个轮子接口（IWheel）：

```
public interface IWheel
{
} 
```

实现 FastCarWheel 和 SlowCarWheel 的接口，例如

```
public class FastCarWheel : IWheel
{
} 
```

现在你的抽象类变成了：

```
abstract class Car 
{
 public IWheel Wheel { get; set; }
} 
```

然后 Car 的子类可以自由使用他们选择的任何 Wheel 实现：

```
FastCar fastCar = new FastCar();
fastCar.Wheel = new FastCarWheel(); 
```

# wix - 使用 wix 创建安装程序以在特定网站中安装时出现问题（不在默认网站中）

> ID：782910
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T18:14:56.570
> 
>         
> 
> 标签：wix, .net-3.5, wix3

我正在使用 wix 创建一个 .msi 以安装在“测试网站”中。但它总是安装在“默认网站”中。.wxs 看起来像：

```
<iis:WebSite Id='WebSiteId' Description="Test Web Site" Directory="Test_dir" >
  <iis:WebAddress Id="TcpAddress" Port="80" />      
</iis:WebSite>

<iis:WebVirtualDir Id="VirtualDir" Alias="TestService" Directory="Test_dir" WebSite="WebSiteId" >
   <iis:WebApplication Id="TestWebApp" Name="TestService" />                
</iis:WebVirtualDir> 
```

有谁知道如何安装到“测试网站”（不在“默认网站”中）？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-27T22:10:53.690

我找到了我提到的问题的解决方案。

```
<iis:WebSite Id='WebSiteId' Description="Test Web Site" Directory="Test_dir" SiteId="*" > 
  <iis:WebAddress Id="TcpAddress" Port="80" />
</iis:WebSite> 
```

当属性`SiteId`设置为 时，使用元素的属性`*`完成网站查找。`Description``<iis:WebSite>`

# string - 在字符串中搜索字符串的简单方法

> ID：782911
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-23T18:15:08.690
> 
>         
> 
> 标签：string, search, c#-2.0

我试图找到最简单的方法来搜索一个`string`可能的数组`string`。我知道对字符执行此操作的简单方法是使用`myString.IndexOfAny(charArray)`. 但是，如果我想搜索我`string`的`string`s 而不仅仅是字符怎么办？是否有任何 .net 技巧或方法可以使这更容易？

基本上，我想做这样的事情：

```
string myName = "rahkim";
string[] names = new string[] {"joe","bob","chris"};

if(myName.IndexOfAny(names) >= 0)
{
      //success code//
} 
```

我知道有一些方法可以用循环等来做到这一点。但我希望框架中有一些固有的东西。

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-04-23T18:58:59.100

您应该定义是否要查找相等的字符串或搜索匹配的子字符串。这两种方式在 LINQ 之前和使用 LINQ 时都很容易。

```
string myName = "rahkim";
string[] names = new string[] { "joe", "bob", "chris" }; 
```

相等的字符串，LINQ

```
bool contains = names.Contains(myName); 
```

相等的字符串，预LINQ

```
bool contains = new List<string>(name).Contains(myName); 
```

子字符串，LINQ

```
bool contains = names.Any(name => name.Contains(myName)); 
```

子字符串，预 LINQ

```
bool contains = false;
foreach(string name in names)
  if (name.Contains(myName))
    contains = true; 
```

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2011-08-11T21:17:00.493

如果其他人在尝试搜索像 String.IndexOfAny(String[]) 这样的 .Net 方法时发现了这个问题，这就是我的解决方案：

**C＃**

```
public int IndexOfAny(string test, string[] values)
{
int first = -1;
foreach (string item in values) {
    int i = test.IndexOf(item);
    if (i >= 0) {
        if (first > 0) {
            if (i < first) {
                first = i;
            }
        } else {
            first = i;
        }
    }
}
return first;
} 
```

**VB**

```
Public Function IndexOfAny(test As String, values As String()) As Integer
        Dim first As Integer = -1
        For Each item As String In values
            Dim i As Integer = test.IndexOf(item)
            If i >= 0 Then
                If first > 0 Then
                    If i < first Then
                        first = i
                    End If
                Else
                    first = i
                End If
            End If
        Next
        Return first
    End Function 
```

你可以做一个 LastIndexOfAny(String[]) 只需切换

```
i < first 
```

到

```
i > first 
```

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-04-23T19:16:57.560

您可以（也）使用该类的`static` `IndexOf`方法`Array`：

```
bool hasName = Array.IndexOf(names, myName) > -1; 
```

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-08-10T02:47:17.270

**int IndexOfAny(String[] rgs)**确实不错，但名义上是 O(n^2) 操作。如果在您的应用程序中，字符串*rgs*的集合很大并且始终相同，那么最有效的方法是将它们加载到[trie](http://en.wikipedia.org/wiki/Trie)数据结构中一次，然后重复使用 trie 在运行时给出的未知字符串中搜索它们.

这是相关代码，改编自我在网上找到的 C# trie 源代码，归属于“Kerry D. Wong”。在我的版本中，trie 中的每个字符串都有一个通用类型*TValue*的“有效负载” 。要使用此 trie 来简单地搜索子字符串，可以始终将有效负载设置为*true*，如*simple_trie*所示。

我在这里更改的另一件事是，此树会自动适应允许存储任意 Unicode 字符串。每个节点上的数组（表征 trie）调整其基数和长度以适应需要存储在该节点的 Unicode 字符范围。例如，这允许区分大小写的匹配。

*C# 3.0 初始化语法对于这个 trie 很方便，但启用它需要IEnumerable*的虚拟实现才能编译。CLR 似乎没有调用 GetEnumerator()，我建议您也不要尝试使用其结果进行枚举。

```
using System;
using System.Collections.Generic;
using System.Linq;  // only used in Main()

class Program
{
    // trie with payload of type <String>
    static Trie<String> value_trie = new Trie<String>
    {
        { "rabbit", "cute" },
        { "giraffe", "tall" },
        { "ape", "smart" },
        { "hippo", "large" },
    };

    // degenerate case of a trie without payload
    static Trie<bool> simple_trie = new Trie<bool>
    {
        { "rabbit", true },
        { "giraffe", true },
        { "ape", true },
        { "hippo", true },
    };

    static void Main(String[] args)
    {
        String s = "Once upon a time, a rabbit met an ape in the woods.";

        // Retrieve payloads for words in the string.
        //
        // output:
        //      cute
        //      smart
        foreach (String word in value_trie.AllSubstringValues(s))
            Console.WriteLine(word);

        // Simply test a string for any of the words in the trie.
        // Note that the Any() operator ensures that the input is no longer
        // traversed once a single result is found.
        //
        // output:
        //      True
        Console.WriteLine(simple_trie.AllSubstringValues(s).Any(e=>e));

        s = "Four score and seven years ago.";
        // output:
        //      False
        Console.WriteLine(simple_trie.AllSubstringValues(s).Any(e => e));
    }
}

class TrieNode<TValue>
{
    private TrieNode<TValue>[] nodes = null;
    private TValue m_value = default(TValue);
    private Char m_base;

    public Char Base { get { return m_base; } }
    public bool IsEnd { get { return !m_value.Equals(default(TValue)); } }

    public TValue Value
    {
        get { return m_value; }
        set { m_value = value; }
    }

    public IEnumerable<TrieNode<TValue>> Nodes { get { return nodes; } }

    public TrieNode<TValue> this[char c]
    {
        get
        {
            if (nodes != null && m_base <= c && c < m_base + nodes.Length)
                return nodes[c - m_base];
            return null;
        }
    }

    public TrieNode<TValue> AddChild(char c)
    {
        if (nodes == null)
        {
            m_base = c;
            nodes = new TrieNode<TValue>[1];
        }
        else if (c >= m_base + nodes.Length)
        {
            Array.Resize(ref nodes, c - m_base + 1);
        }
        else if (c < m_base)
        {
            Char c_new = (Char)(m_base - c);
            TrieNode<TValue>[] tmp = new TrieNode<TValue>[nodes.Length + c_new];
            nodes.CopyTo(tmp, c_new);
            m_base = c;
            nodes = tmp;
        }

        TrieNode<TValue> node = nodes[c - m_base];
        if (node == null)
        {
            node = new TrieNode<TValue>();
            nodes[c - m_base] = node;
        }
        return node;
    }
};

class Trie<TValue> : System.Collections.IEnumerable
{
    private TrieNode<TValue> _root = new TrieNode<TValue>();

    // This dummy enables C# 3.0 initialization syntax
    public System.Collections.IEnumerator GetEnumerator()
    {
        return null;
    }

    public void Add(String s, TValue v)
    {
        TrieNode<TValue> node = _root;
        foreach (Char c in s)
            node = node.AddChild(c);

        node.Value = v;
    }

    public bool Contains(String s)
    {
        TrieNode<TValue> node = _root;
        foreach (Char c in s)
        {
            node = node[c];
            if (node == null)
                return false;
        }
        return node.IsEnd;
    }

    public TValue Find(String s_in)
    {
        TrieNode<TValue> node = _root;
        foreach (Char c in s_in)
        {
            node = node[c];
            if (node == null)
                return default(TValue);
        }
        return node.Value;
    }

    public IEnumerable<TValue> FindAll(String s_in)
    {
        TrieNode<TValue> node = _root;
        foreach (Char c in s_in)
        {
            node = node[c];
            if (node == null)
                break;
            if (node.Value != null)
                yield return node.Value;
        }
    }

    public IEnumerable<TValue> AllSubstringValues(String s)
    {
        int i_cur = 0;
        while (i_cur < s.Length)
        {
            TrieNode<TValue> node = _root;
            int i = i_cur;
            while (i < s.Length)
            {
                node = node[s[i]];
                if (node == null)
                    break;
                if (node.Value != null)
                    yield return node.Value;
                i++;
            }
            i_cur++;
        }
    }
}; 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T18:18:56.090

这是正确的语法：

```
if(names.Contains(myName))
{
      //success code//
} 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:20:20.847

```
if (names.Contains(myName)) 
{
//success code//
} 
```

# multithreading - 原语同步原语——安全吗？

> ID：782912
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-23T18:15:46.083
> 
>         
> 
> 标签：multithreading, synchronization, thread-safety, locking

在受限设备上，我经常发现自己在 2 个线程之间用 2 个布尔值“伪造”锁。每个线程只能由一个线程读取，并且只能由另一个线程写入。这就是我的意思：

```
bool quitted = false, paused = false;
bool should_quit = false, should_pause = false;

void downloader_thread() {
    quitted = false;
    while(!should_quit) {
        fill_buffer(bfr);
        if(should_pause) {
            is_paused = true;
            while(should_pause) sleep(50);
            is_paused = false;
        }
    }
    quitted = true;
}

void ui_thread() {
    // new Thread(downloader_thread).start();
    // ...
    should_pause = true;
    while(!is_paused) sleep(50);
        // resize buffer or something else non-thread-safe
    should_pause = false;
} 
```

当然，在 PC 上我不会这样做，但在受限设备上，读取`bool`值似乎比获取锁要快得多。当然，`sleep(50)`当需要更改缓冲区时，我会以较慢的恢复速度（参见“”）进行权衡。

问题——它是完全线程安全的吗？或者在伪造这样的锁时我需要注意哪些隐藏的陷阱？还是我根本不应该这样做？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-04-23T23:03:53.380

使用布尔值在线程之间进行通信可以按您的意愿工作，但确实有两个隐藏的陷阱，正如[Vitaliy Liptchinsky 的这篇博](http://dotnetframeworkplanet.blogspot.com/2008/11/volatile-field-and-memory-barrier-look.html)文中所解释的那样：

**缓存一致性**

CPU 并不总是从 RAM 中获取内存值。芯片上的快速内存缓存是 CPU 设计人员用来解决[冯诺依曼瓶颈](http://en.wikipedia.org/wiki/Von_Neumann_bottleneck#Von_Neumann_bottleneck)的技巧之一。在某些多 CPU 或多核架构（如 Intel 的[Itanium](http://www.developers.net/intelisnshowcase/view/650)）上，这些 CPU 缓存不共享或自动保持同步。换句话说，如果您的线程在不同的 CPU 上运行，它们**可能会看到相同内存地址的不同值。**

为避免这种情况，您需要将变量声明为**volatile** ( [C++](http://msdn.microsoft.com/en-us/library/12a04hfd.aspx)、[C#](http://msdn.microsoft.com/en-us/library/x13ttww7(VS.71).aspx)、[java](http://java.sun.com/docs/books/jls/second_edition/html/memory.doc.html#28330) )，或执行[显式 volatile read/writes](http://msdn.microsoft.com/en-us/library/system.threading.thread.volatileread.aspx)，或使用锁定机制。

**编译器优化**

如果涉及多个线程，编译器或 JITter 可能会执行不安全的优化。有关示例，请参阅链接的博客文章。同样，您必须使用 volatile 关键字或其他机制来通知您的编译器。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-04-23T18:20:19.940

除非您详细了解设备的内存架构以及编译器生成的代码，否则此代码并不安全。

仅仅因为它看起来会起作用，并不意味着它会起作用。“受约束”的设备，如不受约束的类型，正变得越来越强大。例如，我不会打赌要在手机中找到双核 CPU。这意味着我不会打赌上面的代码会起作用。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:22:23.760

关于 sleep 调用，您总是可以只执行 sleep(0) 或等效的调用来暂停您的线程，让下一个线程转一圈。

关于其余部分，如果您知道设备的实现细节，这是线程安全的。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T22:28:18.037

回答问题。

这是完全线程安全的吗？我会回答不，这不是线程安全的，我根本不会这样做。在不知道我们的设备和编译器的细节的情况下，如果这是 C++，编译器可以自由地重新排序和优化它认为合适的东西。例如，您写道：    

```
is_paused = true;            
while(should_pause) sleep(50);            
is_paused = false; 
```

但编译器可能会选择将其重新排序为如下所示：

```
sleep(50);
is_paused = false; 
```

正如其他人所说，即使是单个核心设备，这也可能无法正常工作。

您可以尝试做得更好，在 UI 线程上*做更少*的事情，而不是在处理 UI 消息的过程中让步，而不是锁定。如果你认为你在 UI 线程上花费了太多时间，那么想办法干净地退出并注册一个异步回调。

如果您在 UI 线程上调用 sleep（或尝试获取锁或执行任何可能阻塞的操作），您就会打开挂起和故障 UI 的大门。50 毫秒的睡眠足以让用户注意到。而且，如果您尝试获取锁或执行任何其他阻塞操作（如 I/O），您需要处理等待不确定的时间来获取 I/O 的现实，该 I/O 往往会从故障转换为挂起。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-24T07:47:26.460

这段代码几乎在所有情况下都是不安全的。在多核处理器上，内核之间不会有缓存一致性，因为 bool 读取和写入不是原子操作。这意味着如果上次写入的缓存尚未刷新，则不能保证每个内核在缓存中甚至在内存中具有相同的值。

但是，即使在资源受限的单核设备上，这也不安全，因为您无法控制调度程序。这是一个示例，为简单起见，我将假设这些是设备上仅有的两个线程。

当 ui_thread 运行时，以下代码行可以在同一个时间片中运行。

```
// new Thread(downloader_thread).start();
// ...
should_pause = true; 
```

downloader_thread 接下来运行，在它的时间片中执行以下行：

```
quitted = false;
while(!should_quit)
{
    fill_buffer(bfr); 
```

调度程序在 fill_buffer 返回之前预占 downloader_thread，然后激活运行的 ui_thread。

```
while(!is_paused) sleep(50);
// resize buffer or something else non-thread-safe
should_pause = false; 
```

调整缓冲区大小的操作是在 downloader_thread 正在填充缓冲区的过程中完成的。这意味着缓冲区已损坏，您可能很快就会崩溃。它不会每次都发生，但是您在将 is_paused 设置为 true 之前填充缓冲区的事实使得它更有可能发生，但是即使您在 downloader_thread 上切换了这两个操作的顺序，您仍然会有竞争条件，但您可能会死锁而不是破坏缓冲区。

顺便说一句，这是一种自旋锁，它只是不起作用。自旋锁不太适合可能跨越许多时间片的等待时间导致处理器旋转。您的实现确实 sleep 这有点好，但是调度程序仍然必须运行您的线程，并且线程上下文切换并不便宜。如果您正在等待关键部分或信号量，则调度程序不会再次激活您的线程，直到资源变得可用。

您可能可以在特定平台/架构上以某种形式摆脱这种情况，但是很容易犯一个很难追查的错误。

# database - Google 的 Bigtable 与关系数据库

> ID：782913
> 
>         
> 
> 赞同：31
> 
>         
> 
> 时间：2009-04-23T18:16:33.820
> 
>         
> 
> 标签：database, relational, bigtable

> 重复
> 
>   
>   
> 
> *   [为什么我应该使用基于文档的数据库而不是关系数据库？](https://stackoverflow.com/questions/441441/why-should-i-use-document-based-database-instead-of-relational-database)
> 
> *   [基于文档的数据库与关系数据库的优缺点](https://stackoverflow.com/questions/337344/pros-cons-of-document-based-database-vs-relational-database)

我对 Google 的 Bigtable 了解不多，但我想知道 Google 的 Bigtable 和 MySQL 等关系数据库之间的区别是什么。两者的局限性是什么？

* * *

## 回答 #1

> 赞同：33
> 
>             
> 
> 时间：2009-04-23T18:40:47.833

Bigtable 是 Google 为处理公司经常处理的大量信息而发明的。Bigtable 数据集可以增长到巨大的规模（数 PB），存储分布在大量服务器上。使用 Bigtable 的系统包括谷歌的网络索引和谷歌地球等项目。

根据有关该主题的[Google 白皮书：](http://research.google.com/archive/bigtable.html)

> Bigtable 是一个稀疏的、分布式的、持久的多维排序图。该映射由行键、列键和时间戳索引；映射中的每个值都是一个未解释的字节数组。

Bigtable 与 MySQL 的内部机制是如此不同，以至于难以进行比较，而且预期的目标也没有太多重叠。但是你可以把 Bigtable 想象成一个单表数据库。例如，想象一下，如果你试图用 MySQL 数据库来实现谷歌的整个网络搜索系统，你会遇到什么困难——Bigtable 就是围绕解决这些问题而构建的。

可以使用基于 SQL 子集的 GQL（“gee-kwal”）语言从 AppEngine 等服务中查询 Bigtable 数据集。GQL 中明显缺少任何类型的`JOIN`命令。由于 Bigtable 数据库的分布式特性，在两个表之间执行连接将非常低效。相反，程序员必须在他的应用程序中实现这样的逻辑，或者将他的应用程序设计为不需要它。

* * *

## 回答 #2

> 赞同：15
> 
>             
> 
> 时间：2009-04-23T18:38:49.820

Google 的 BigTable 和其他类似项目（例如：[CouchDB](http://couchdb.apache.org/)、[HBase](http://hadoop.apache.org/hbase/)）是面向数据的数据库系统，因此数据大多是非[规范化](http://en.wikipedia.org/wiki/Denormalization)的（即复制和分组）。

主要优点是： - 由于非规范化，连接操作成本较低 - 由于数据独立性，数据的复制/分发成本较低（即，如果您想跨两个节点分发数据，您可能不会遇到问题在一个节点中有一个实体，在另一个节点中有其他相关实体，因为相似的数据被分组）

这种系统适用于需要达到最佳规模的应用程序（即，您向系统添加更多节点并按比例提高性能）。在像 MySQL 或 Oracle 这样的 RDBMS 中，当您开始添加更多节点时，如果您连接两个不在同一节点中的表，则连接成本会更高。当您处理大量数据时，这变得很重要。

由于存储模型（表、连接、fks）的丰富性，RDBMS 很不错。分布式数据库很好，因为它易于扩展。

# mysql - MYSQL OR 与 IN 性能

> ID：782915
> 
>         
> 
> 赞同：202
> 
>         
> 
> 时间：2009-04-23T18:16:52.883
> 
>         
> 
> 标签：mysql, sql, performance, optimization

我想知道以下之间的性能是否有任何区别

```
SELECT ... FROM ... WHERE someFIELD IN(1,2,3,4)

SELECT ... FROM ... WHERE someFIELD between 0 AND 5

SELECT ... FROM ... WHERE someFIELD = 1 OR someFIELD = 2 OR someFIELD = 3 ... 
```

还是 MySQL 会以与编译器优化代码相同的方式优化 SQL？

编辑：出于评论中所述的原因，将 's 更改为`AND`'s 。`OR`

* * *

## 回答 #1

> 赞同：272
> 
>             
> 
> 时间：2010-03-20T01:05:13.290

我需要确定地知道这一点，所以我对这两种方法进行了基准测试。我始终发现`IN`它比使用`OR`.

不要相信那些给出“意见”的人，科学就是测试和证据。

我运行了 1000 倍等效查询的循环（为了保持一致性，我使用了`sql_no_cache`）：

`IN`: 2.34969592094s

`OR`: 5.83781504631s

*更新：（*

*我没有原始测试的源代码，就像 6 年前一样，尽管它返回的结果与此测试的范围相同）*

在请求一些示例代码来测试这一点时，这里是最简单的用例。使用 Eloquent 来简化语法，原始 SQL 等效项执行相同的操作。

```
$t = microtime(true); 
for($i=0; $i<10000; $i++):
$q = DB::table('users')->where('id',1)
    ->orWhere('id',2)
    ->orWhere('id',3)
    ->orWhere('id',4)
    ->orWhere('id',5)
    ->orWhere('id',6)
    ->orWhere('id',7)
    ->orWhere('id',8)
    ->orWhere('id',9)
    ->orWhere('id',10)
    ->orWhere('id',11)
    ->orWhere('id',12)
    ->orWhere('id',13)
    ->orWhere('id',14)
    ->orWhere('id',15)
    ->orWhere('id',16)
    ->orWhere('id',17)
    ->orWhere('id',18)
    ->orWhere('id',19)
    ->orWhere('id',20)->get();
endfor;
$t2 = microtime(true); 
echo $t."\n".$t2."\n".($t2-$t)."\n"; 
```

> 1482080514.3635 
> 
>   1482080517.3713 
> 
>   **3.0078368186951**

```
$t = microtime(true); 
for($i=0; $i<10000; $i++): 
$q = DB::table('users')->whereIn('id',[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])->get(); 
endfor; 
$t2 = microtime(true); 
echo $t."\n".$t2."\n".($t2-$t)."\n"; 
```

> 1482080534.0185 
> 
>   1482080536.178 
> 
>   **2.1595389842987**

* * *

## 回答 #2

> 赞同：72
> 
>             
> 
> 时间：2011-10-19T08:44:08.100

我还为未来的 Google 员工做了一个测试。返回结果的总数是 10000 中的 7264

```
SELECT * FROM item WHERE id = 1 OR id = 2 ... id = 10000 
```

这个查询花了`0.1239`几秒钟

```
SELECT * FROM item WHERE id IN (1,2,3,...10000) 
```

这个查询花了`0.0433`几秒钟

`IN`是 3 倍于`OR`

* * *

## 回答 #3

> 赞同：51
> 
>             
> 
> 时间：2018-08-14T03:16:56.927

接受的答案没有解释原因。

以下引自高性能 MySQL，第 3 版。

> 在许多数据库服务器中，IN() 只是多个 OR 子句的同义词，因为两者在逻辑上是等价的。在 MySQL 中并非如此，它对 IN() 列表中的值进行排序并使用快速二进制搜索来查看值是否在列表中。这是列表大小的 O(Log n)，而等效的一系列 OR 子句是列表大小的 O(n)（即，对于大型列表来说要慢得多）

* * *

## 回答 #4

> 赞同：16
> 
>             
> 
> 时间：2009-04-23T18:39:46.040

我认为 BETWEEN 会更快，因为它应该转换为：

```
Field >= 0 AND Field <= 5 
```

据我了解，IN 无论如何都会转换为一堆 OR 语句。IN 的价值在于易用性。（不必多次键入每个列名，并且还可以更轻松地与现有逻辑一起使用 - 您不必担心 AND/OR 优先级，因为 IN 是一个语句。使用一堆 OR 语句，您有以确保您用括号将它们括起来，以确保它们被评估为一种条件。）

您问题的唯一真正答案是**PROFILE YOUR QUERIES**。然后你就会知道什么在你的特定情况下最有效。

* * *

## 回答 #5

> 赞同：14
> 
>             
> 
> 时间：2009-04-23T19:13:21.170

这取决于你在做什么；范围有多宽，数据类型是什么（我知道您的示例使用数字数据类型，但您的问题也适用于许多不同的数据类型）。

这是您希望以两种方式编写查询的实例；让它工作，然后使用 EXPLAIN 找出执行差异。  

我确信对此有一个具体的答案，但实际上，这就是我要找出我给定问题的答案的方式。

这可能会有所帮助： http: [//forge.mysql.com/wiki/Top10SQLPerformanceTips](http://forge.mysql.com/wiki/Top10SQLPerformanceTips)

问候，

弗兰克

* * *

## 回答 #6

> 赞同：7
> 
>             
> 
> 时间：2011-03-14T14:54:02.530

我认为对 sunseeker 观察的一种解释是 MySQL 实际上对 IN 语句中的值进行排序，如果它们都是静态值并使用二进制搜索，这比普通的 OR 替代方案更有效。我不记得我在哪里读到的，但 sunseeker 的结果似乎是一个证明。

* * *

## 回答 #7

> 赞同：6
> 
>             
> 
> 时间：2018-05-30T21:33:46.703

就在你以为安全的时候...

你的价值是`eq_range_index_dive_limit`多少？特别是，您的`IN`条款中的项目更多还是更少？

这将不包括基准测试，但会稍微了解一下内部工作原理。让我们使用一个工具来看看发生了什么——Optimizer Trace。

查询：  `SELECT * FROM canada WHERE id ...`

**使用`OR`3 个值**，部分跟踪如下所示：

```
 "condition_processing": {
          "condition": "WHERE",
          "original_condition": "((`canada`.`id` = 296172) or (`canada`.`id` = 295093) or (`canada`.`id` = 293626))",
          "steps": [
            {
              "transformation": "equality_propagation",
              "resulting_condition": "(multiple equal(296172, `canada`.`id`) or multiple equal(295093, `canada`.`id`) or multiple equal(293626, `canada`.`id`))"
            }, 
```

...

```
 "analyzing_range_alternatives": {
                "range_scan_alternatives": [
                  {
                    "index": "id",
                    "ranges": [
                      "293626 <= id <= 293626",
                      "295093 <= id <= 295093",
                      "296172 <= id <= 296172"
                    ],
                    "index_dives_for_eq_ranges": true,
                    "chosen": true 
```

...

```
 "refine_plan": [
          {
            "table": "`canada`",
            "pushed_index_condition": "((`canada`.`id` = 296172) or (`canada`.`id` = 295093) or (`canada`.`id` = 293626))",
            "table_condition_attached": null,
            "access_type": "range"
          }
        ] 
```

注意 ICP 是如何给出的`ORs`。这*意味着*没有`OR`变成，InnoDB 将通过 ICP`IN`执行一堆测试。`=`（我觉得不值得考虑 MyISAM。）

（这是 Percona 的 5.6.22-71.0-log；`id`是二级索引。）

**现在对于具有一些值的 IN()**

`eq_range_index_dive_limit`= 10; 有8个值。

```
 "condition_processing": {
          "condition": "WHERE",
          "original_condition": "(`canada`.`id` in (296172,295093,293626,295573,297148,296127,295588,295810))",
          "steps": [
            {
              "transformation": "equality_propagation",
              "resulting_condition": "(`canada`.`id` in (296172,295093,293626,295573,297148,296127,295588,295810))"
            }, 
```

...

```
 "analyzing_range_alternatives": {
                "range_scan_alternatives": [
                  {
                    "index": "id",
                    "ranges": [
                      "293626 <= id <= 293626",
                      "295093 <= id <= 295093",
                      "295573 <= id <= 295573",
                      "295588 <= id <= 295588",
                      "295810 <= id <= 295810",
                      "296127 <= id <= 296127",
                      "296172 <= id <= 296172",
                      "297148 <= id <= 297148"
                    ],
                    "index_dives_for_eq_ranges": true,
                    "chosen": true 
```

...

```
 "refine_plan": [
          {
            "table": "`canada`",
            "pushed_index_condition": "(`canada`.`id` in (296172,295093,293626,295573,297148,296127,295588,295810))",
            "table_condition_attached": null,
            "access_type": "range"
          }
        ] 
```

请注意，`IN`似乎没有变成`OR`.

附注：请注意，**常量值是 sorted**。这在两个方面是有益的：

*   通过少跳动，可能会有更好的缓存，更少的 I/O 来获取所有值。

*   如果两个相似的查询来自不同的连接，并且它们在事务中，则由于列表重叠，更有可能获得延迟而不是死锁。

**最后， IN() 有很多值**

```
 {
        "condition_processing": {
          "condition": "WHERE",
          "original_condition": "(`canada`.`id` in (293831,292259,292881,293440,292558,295792,292293,292593,294337,295430,295034,297060,293811,295587,294651,295559,293213,295742,292605,296018,294529,296711,293919,294732,294689,295540,293000,296916,294433,297112,293815,292522,296816,293320,293232,295369,291894,293700,291839,293049,292738,294895,294473,294023,294173,293019,291976,294923,294797,296958,294075,293450,296952,297185,295351,295736,296312,294330,292717,294638,294713,297176,295896,295137,296573,292236,294966,296642,296073,295903,293057,294628,292639,293803,294470,295353,297196,291752,296118,296964,296185,295338,295956,296064,295039,297201,297136,295206,295986,292172,294803,294480,294706,296975,296604,294493,293181,292526,293354,292374,292344,293744,294165,295082,296203,291918,295211,294289,294877,293120,295387))",
          "steps": [
            {
              "transformation": "equality_propagation",
              "resulting_condition": "(`canada`.`id` in (293831,292259,292881,293440,292558,295792,292293,292593,294337,295430,295034,297060,293811,295587,294651,295559,293213,295742,292605,296018,294529,296711,293919,294732,294689,295540,293000,296916,294433,297112,293815,292522,296816,293320,293232,295369,291894,293700,291839,293049,292738,294895,294473,294023,294173,293019,291976,294923,294797,296958,294075,293450,296952,297185,295351,295736,296312,294330,292717,294638,294713,297176,295896,295137,296573,292236,294966,296642,296073,295903,293057,294628,292639,293803,294470,295353,297196,291752,296118,296964,296185,295338,295956,296064,295039,297201,297136,295206,295986,292172,294803,294480,294706,296975,296604,294493,293181,292526,293354,292374,292344,293744,294165,295082,296203,291918,295211,294289,294877,293120,295387))"
            }, 
```

...

```
 "analyzing_range_alternatives": {
                "range_scan_alternatives": [
                  {
                    "index": "id",
                    "ranges": [
                      "291752 <= id <= 291752",
                      "291839 <= id <= 291839",
                      ...
                      "297196 <= id <= 297196",
                      "297201 <= id <= 297201"
                    ],
                    "index_dives_for_eq_ranges": false,
                    "rows": 111,
                    "chosen": true 
```

...

```
 "refine_plan": [
          {
            "table": "`canada`",
            "pushed_index_condition": "(`canada`.`id` in (293831,292259,292881,293440,292558,295792,292293,292593,294337,295430,295034,297060,293811,295587,294651,295559,293213,295742,292605,296018,294529,296711,293919,294732,294689,295540,293000,296916,294433,297112,293815,292522,296816,293320,293232,295369,291894,293700,291839,293049,292738,294895,294473,294023,294173,293019,291976,294923,294797,296958,294075,293450,296952,297185,295351,295736,296312,294330,292717,294638,294713,297176,295896,295137,296573,292236,294966,296642,296073,295903,293057,294628,292639,293803,294470,295353,297196,291752,296118,296964,296185,295338,295956,296064,295039,297201,297136,295206,295986,292172,294803,294480,294706,296975,296604,294493,293181,292526,293354,292374,292344,293744,294165,295082,296203,291918,295211,294289,294877,293120,295387))",
            "table_condition_attached": null,
            "access_type": "range"
          }
        ] 
```

旁注：由于跟踪的庞大，我需要这个：

```
@@global.optimizer_trace_max_mem_size = 32222; 
```

* * *

## 回答 #8

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T18:33:08.960

或将是最慢的。IN 或 BETWEEN 是否更快取决于您的数据，但我希望 BETWEEN 通常更快，因为它可以简单地从索引中获取一个范围（假设 someField 已编入索引）。

* * *

## 回答 #9

> 赞同：3
> 
>             
> 
> 时间：2017-10-22T07:09:42.327

以下是使用 MySQL 5.6 @SQLFiddle 的 6 个查询的详细信息

总之，6 个查询覆盖了独立索引的列，每个数据类型使用了 2 个查询。无论使用 IN() 或 OR，所有查询都会导致使用索引。

```
 |   ORs      |   IN()
integer | uses index | uses index
date    | uses index | uses index
varchar | uses index | uses index 
```

我真的只是想揭穿 OR 意味着不能使用索引的声明。这不是真的。索引可用于使用 OR 的查询，如以下示例中显示的 6 个查询。

在我看来，许多人似乎忽略了这样一个事实，即 IN() 是一组 OR 的语法快捷方式。在小范围内，使用 IN() -v- OR 之间的性能差异非常（无限）微不足道。

虽然在更大的范围内 IN() 肯定更方便，但它在逻辑上仍然等同于一组 OR 条件。每个查询的情况都会发生变化，因此在表上测试您的查询始终是最好的。

6个解释计划的总结，所有“使用索引条件”（向右滚动）

```
 Query               select_type    table    type    possible_keys      key      key_len   ref   rows   filtered           Extra          
                      ------------- --------- ------- --------------- ----------- --------- ----- ------ ---------- ----------------------- 
  Integers using OR   SIMPLE        mytable   range   aNum_idx        aNum_idx    4               10     100.00     Using index condition  
  Integers using IN   SIMPLE        mytable   range   aNum_idx        aNum_idx    4               10     100.00     Using index condition  
  Dates using OR      SIMPLE        mytable   range   aDate_idx       aDate_idx   6               7      100.00     Using index condition  
  Dates using IN      SIMPLE        mytable   range   aDate_idx       aDate_idx   6               7      100.00     Using index condition  
  Varchar using OR    SIMPLE        mytable   range   aName_idx       aName_idx   768             10     100.00     Using index condition  
  Varchar using IN    SIMPLE        mytable   range   aName_idx       aName_idx   768             10     100.00     Using index condition 
```

[SQL小提琴](http://sqlfiddle.com/#!9/c824e2/1)

**MySQL 5.6 架构设置**：

```
CREATE TABLE `myTable` (
  `id` mediumint(8) unsigned NOT NULL auto_increment,
  `aName` varchar(255) default NULL,
  `aDate` datetime,
  `aNum`  mediumint(8),
  PRIMARY KEY (`id`)
) AUTO_INCREMENT=1;

ALTER TABLE `myTable` ADD INDEX `aName_idx` (`aName`);
ALTER TABLE `myTable` ADD INDEX `aDate_idx` (`aDate`);
ALTER TABLE `myTable` ADD INDEX `aNum_idx` (`aNum`);

INSERT INTO `myTable` (`aName`,`aDate`)
 VALUES 
 ("Daniel","2017-09-19 01:22:31")
,("Quentin","2017-06-03 01:06:45")
,("Chester","2017-06-14 17:49:36")
,("Lev","2017-08-30 06:27:59")
,("Garrett","2018-10-04 02:40:37")
,("Lane","2017-01-22 17:11:21")
,("Chaim","2017-09-20 11:13:46")
,("Kieran","2018-03-10 18:37:26")
,("Cedric","2017-05-20 16:25:10")
,("Conan","2018-07-10 06:29:39")
,("Rudyard","2017-07-14 00:04:00")
,("Chadwick","2018-08-18 08:54:08")
,("Darius","2018-10-02 06:55:56")
,("Joseph","2017-06-19 13:20:33")
,("Wayne","2017-04-02 23:20:25")
,("Hall","2017-10-13 00:17:24")
,("Craig","2016-12-04 08:15:22")
,("Keane","2018-03-12 04:21:46")
,("Russell","2017-07-14 17:21:58")
,("Seth","2018-07-25 05:51:30")
,("Cole","2018-06-09 15:32:53")
,("Donovan","2017-08-12 05:21:35")
,("Damon","2017-06-27 03:44:19")
,("Brian","2017-02-01 23:35:20")
,("Harper","2017-08-25 04:29:27")
,("Chandler","2017-09-30 23:54:06")
,("Edward","2018-07-30 12:18:07")
,("Curran","2018-05-23 09:31:53")
,("Uriel","2017-05-08 03:31:43")
,("Honorato","2018-04-07 14:57:53")
,("Griffin","2017-01-07 23:35:31")
,("Hasad","2017-05-15 05:32:41")
,("Burke","2017-07-04 01:11:19")
,("Hyatt","2017-03-14 17:12:28")
,("Brenden","2017-10-17 05:16:14")
,("Ryan","2018-10-10 08:07:55")
,("Giacomo","2018-10-06 14:21:21")
,("James","2018-02-06 02:45:59")
,("Colt","2017-10-10 08:11:26")
,("Kermit","2017-09-18 16:57:16")
,("Drake","2018-05-20 22:08:36")
,("Berk","2017-04-16 17:39:32")
,("Alan","2018-09-01 05:33:05")
,("Deacon","2017-04-20 07:03:05")
,("Omar","2018-03-02 15:04:32")
,("Thaddeus","2017-09-19 04:07:54")
,("Troy","2016-12-13 04:24:08")
,("Rogan","2017-11-02 00:03:25")
,("Grant","2017-08-21 01:45:16")
,("Walker","2016-11-26 15:54:52")
,("Clarke","2017-07-20 02:26:56")
,("Clayton","2018-08-16 05:09:29")
,("Denton","2018-08-11 05:26:05")
,("Nicholas","2018-07-19 09:29:55")
,("Hashim","2018-08-10 20:38:06")
,("Todd","2016-10-25 01:01:36")
,("Xenos","2017-05-11 22:50:35")
,("Bert","2017-06-17 18:08:21")
,("Oleg","2018-01-03 13:10:32")
,("Hall","2018-06-04 01:53:45")
,("Evan","2017-01-16 01:04:25")
,("Mohammad","2016-11-18 05:42:52")
,("Armand","2016-12-18 06:57:57")
,("Kaseem","2018-06-12 23:09:57")
,("Colin","2017-06-29 05:25:52")
,("Arthur","2016-12-29 04:38:13")
,("Xander","2016-11-14 19:35:32")
,("Dante","2016-12-01 09:01:04")
,("Zahir","2018-02-17 14:44:53")
,("Raymond","2017-03-09 05:33:06")
,("Giacomo","2017-04-17 06:12:52")
,("Fulton","2017-06-04 00:41:57")
,("Chase","2018-01-14 03:03:57")
,("William","2017-05-08 09:44:59")
,("Fuller","2017-03-31 20:35:20")
,("Jarrod","2017-02-15 02:45:29")
,("Nissim","2018-03-11 14:19:25")
,("Chester","2017-11-05 00:14:27")
,("Perry","2017-12-24 11:58:04")
,("Theodore","2017-06-26 12:34:12")
,("Mason","2017-10-02 03:53:49")
,("Brenden","2018-10-08 10:09:47")
,("Jerome","2017-11-05 20:34:25")
,("Keaton","2018-08-18 00:55:56")
,("Tiger","2017-05-21 16:59:07")
,("Benjamin","2018-04-10 14:46:36")
,("John","2018-09-05 18:53:03")
,("Jakeem","2018-10-11 00:17:38")
,("Kenyon","2017-12-18 22:19:29")
,("Ferris","2017-03-29 06:59:13")
,("Hoyt","2017-01-03 03:48:56")
,("Fitzgerald","2017-07-27 11:27:52")
,("Forrest","2017-10-05 23:14:21")
,("Jordan","2017-01-11 03:48:09")
,("Lev","2017-05-25 08:03:39")
,("Chase","2017-06-18 19:09:23")
,("Ryder","2016-12-13 12:50:50")
,("Malik","2017-11-19 15:15:55")
,("Zeph","2018-04-04 11:22:12")
,("Amala","2017-01-29 07:52:17")
; 
```

.

```
update MyTable
set aNum = id
; 
```

**查询 1**：

```
select 'aNum by OR' q, mytable.*
from mytable
where aNum = 12
OR aNum = 22
OR aNum = 27
OR aNum = 32
OR aNum = 42
OR aNum = 52
OR aNum = 62
OR aNum = 65
OR aNum = 72
OR aNum = 82 
```

**[结果](http://sqlfiddle.com/#!9/c824e2/1/0)**：

```
|          q | id |    aName |                aDate | aNum |
|------------|----|----------|----------------------|------|
| aNum by OR | 12 | Chadwick | 2018-08-18T08:54:08Z |   12 |
| aNum by OR | 22 |  Donovan | 2017-08-12T05:21:35Z |   22 |
| aNum by OR | 27 |   Edward | 2018-07-30T12:18:07Z |   27 |
| aNum by OR | 32 |    Hasad | 2017-05-15T05:32:41Z |   32 |
| aNum by OR | 42 |     Berk | 2017-04-16T17:39:32Z |   42 |
| aNum by OR | 52 |  Clayton | 2018-08-16T05:09:29Z |   52 |
| aNum by OR | 62 | Mohammad | 2016-11-18T05:42:52Z |   62 |
| aNum by OR | 65 |    Colin | 2017-06-29T05:25:52Z |   65 |
| aNum by OR | 72 |   Fulton | 2017-06-04T00:41:57Z |   72 |
| aNum by OR | 82 |  Brenden | 2018-10-08T10:09:47Z |   82 | 
```

**查询 2**：

```
select 'aNum by IN' q, mytable.*
from mytable
where aNum IN (
            12
          , 22
          , 27
          , 32
          , 42
          , 52
          , 62
          , 65
          , 72
          , 82
          ) 
```

**[结果](http://sqlfiddle.com/#!9/c824e2/1/1)**：

```
|          q | id |    aName |                aDate | aNum |
|------------|----|----------|----------------------|------|
| aNum by IN | 12 | Chadwick | 2018-08-18T08:54:08Z |   12 |
| aNum by IN | 22 |  Donovan | 2017-08-12T05:21:35Z |   22 |
| aNum by IN | 27 |   Edward | 2018-07-30T12:18:07Z |   27 |
| aNum by IN | 32 |    Hasad | 2017-05-15T05:32:41Z |   32 |
| aNum by IN | 42 |     Berk | 2017-04-16T17:39:32Z |   42 |
| aNum by IN | 52 |  Clayton | 2018-08-16T05:09:29Z |   52 |
| aNum by IN | 62 | Mohammad | 2016-11-18T05:42:52Z |   62 |
| aNum by IN | 65 |    Colin | 2017-06-29T05:25:52Z |   65 |
| aNum by IN | 72 |   Fulton | 2017-06-04T00:41:57Z |   72 |
| aNum by IN | 82 |  Brenden | 2018-10-08T10:09:47Z |   82 | 
```

**查询 3**：

```
select 'adate by OR' q, mytable.*
from mytable
where aDate= str_to_date("2017-02-15 02:45:29",'%Y-%m-%d %h:%i:%s')
OR aDate = str_to_date("2018-03-10 18:37:26",'%Y-%m-%d %h:%i:%s')
OR aDate = str_to_date("2017-05-20 16:25:10",'%Y-%m-%d %h:%i:%s')
OR aDate = str_to_date("2018-07-10 06:29:39",'%Y-%m-%d %h:%i:%s')
OR aDate = str_to_date("2017-07-14 00:04:00",'%Y-%m-%d %h:%i:%s')
OR aDate = str_to_date("2018-08-18 08:54:08",'%Y-%m-%d %h:%i:%s')
OR aDate = str_to_date("2018-10-02 06:55:56",'%Y-%m-%d %h:%i:%s')
OR aDate = str_to_date("2017-04-20 07:03:05",'%Y-%m-%d %h:%i:%s')
OR aDate = str_to_date("2018-03-02 15:04:32",'%Y-%m-%d %h:%i:%s')
OR aDate = str_to_date("2017-09-19 04:07:54",'%Y-%m-%d %h:%i:%s')
OR aDate = str_to_date("2016-12-13 04:24:08",'%Y-%m-%d %h:%i:%s') 
```

**[结果](http://sqlfiddle.com/#!9/c824e2/1/2)**：

```
|           q | id |    aName |                aDate | aNum |
|-------------|----|----------|----------------------|------|
| adate by OR | 47 |     Troy | 2016-12-13T04:24:08Z |   47 |
| adate by OR | 76 |   Jarrod | 2017-02-15T02:45:29Z |   76 |
| adate by OR | 44 |   Deacon | 2017-04-20T07:03:05Z |   44 |
| adate by OR | 46 | Thaddeus | 2017-09-19T04:07:54Z |   46 |
| adate by OR | 10 |    Conan | 2018-07-10T06:29:39Z |   10 |
| adate by OR | 12 | Chadwick | 2018-08-18T08:54:08Z |   12 |
| adate by OR | 13 |   Darius | 2018-10-02T06:55:56Z |   13 | 
```

**问题 4**：

```
select 'adate by IN' q, mytable.*
from mytable
where aDate IN (
          str_to_date("2017-02-15 02:45:29",'%Y-%m-%d %h:%i:%s')
        , str_to_date("2018-03-10 18:37:26",'%Y-%m-%d %h:%i:%s')
        , str_to_date("2017-05-20 16:25:10",'%Y-%m-%d %h:%i:%s')
        , str_to_date("2018-07-10 06:29:39",'%Y-%m-%d %h:%i:%s')
        , str_to_date("2017-07-14 00:04:00",'%Y-%m-%d %h:%i:%s')
        , str_to_date("2018-08-18 08:54:08",'%Y-%m-%d %h:%i:%s')
        , str_to_date("2018-10-02 06:55:56",'%Y-%m-%d %h:%i:%s')
        , str_to_date("2017-04-20 07:03:05",'%Y-%m-%d %h:%i:%s')
        , str_to_date("2018-03-02 15:04:32",'%Y-%m-%d %h:%i:%s')
        , str_to_date("2017-09-19 04:07:54",'%Y-%m-%d %h:%i:%s')
        , str_to_date("2016-12-13 04:24:08",'%Y-%m-%d %h:%i:%s')
        ) 
```

**[结果](http://sqlfiddle.com/#!9/c824e2/1/3)**：

```
|           q | id |    aName |                aDate | aNum |
|-------------|----|----------|----------------------|------|
| adate by IN | 47 |     Troy | 2016-12-13T04:24:08Z |   47 |
| adate by IN | 76 |   Jarrod | 2017-02-15T02:45:29Z |   76 |
| adate by IN | 44 |   Deacon | 2017-04-20T07:03:05Z |   44 |
| adate by IN | 46 | Thaddeus | 2017-09-19T04:07:54Z |   46 |
| adate by IN | 10 |    Conan | 2018-07-10T06:29:39Z |   10 |
| adate by IN | 12 | Chadwick | 2018-08-18T08:54:08Z |   12 |
| adate by IN | 13 |   Darius | 2018-10-02T06:55:56Z |   13 | 
```

**问题 5**：

```
select 'name by  OR' q, mytable.*
from mytable
where aname = 'Alan'
OR aname = 'Brian'
OR aname = 'Chandler'
OR aname = 'Darius'
OR aname = 'Evan'
OR aname = 'Ferris'
OR aname = 'Giacomo'
OR aname = 'Hall'
OR aname = 'James'
OR aname = 'Jarrod' 
```

**[结果](http://sqlfiddle.com/#!9/c824e2/1/4)**：

```
|           q | id |    aName |                aDate | aNum |
|-------------|----|----------|----------------------|------|
| name by  OR | 43 |     Alan | 2018-09-01T05:33:05Z |   43 |
| name by  OR | 24 |    Brian | 2017-02-01T23:35:20Z |   24 |
| name by  OR | 26 | Chandler | 2017-09-30T23:54:06Z |   26 |
| name by  OR | 13 |   Darius | 2018-10-02T06:55:56Z |   13 |
| name by  OR | 61 |     Evan | 2017-01-16T01:04:25Z |   61 |
| name by  OR | 90 |   Ferris | 2017-03-29T06:59:13Z |   90 |
| name by  OR | 37 |  Giacomo | 2018-10-06T14:21:21Z |   37 |
| name by  OR | 71 |  Giacomo | 2017-04-17T06:12:52Z |   71 |
| name by  OR | 16 |     Hall | 2017-10-13T00:17:24Z |   16 |
| name by  OR | 60 |     Hall | 2018-06-04T01:53:45Z |   60 |
| name by  OR | 38 |    James | 2018-02-06T02:45:59Z |   38 |
| name by  OR | 76 |   Jarrod | 2017-02-15T02:45:29Z |   76 | 
```

**问题 6**：

```
select 'name by IN' q, mytable.*
from mytable
where aname IN (
      'Alan'
     ,'Brian'
     ,'Chandler'
     , 'Darius'
     , 'Evan'
     , 'Ferris'
     , 'Giacomo'
     , 'Hall'
     , 'James'
     , 'Jarrod'
     ) 
```

**[结果](http://sqlfiddle.com/#!9/c824e2/1/5)**：

```
|          q | id |    aName |                aDate | aNum |
|------------|----|----------|----------------------|------|
| name by IN | 43 |     Alan | 2018-09-01T05:33:05Z |   43 |
| name by IN | 24 |    Brian | 2017-02-01T23:35:20Z |   24 |
| name by IN | 26 | Chandler | 2017-09-30T23:54:06Z |   26 |
| name by IN | 13 |   Darius | 2018-10-02T06:55:56Z |   13 |
| name by IN | 61 |     Evan | 2017-01-16T01:04:25Z |   61 |
| name by IN | 90 |   Ferris | 2017-03-29T06:59:13Z |   90 |
| name by IN | 37 |  Giacomo | 2018-10-06T14:21:21Z |   37 |
| name by IN | 71 |  Giacomo | 2017-04-17T06:12:52Z |   71 |
| name by IN | 16 |     Hall | 2017-10-13T00:17:24Z |   16 |
| name by IN | 60 |     Hall | 2018-06-04T01:53:45Z |   60 |
| name by IN | 38 |    James | 2018-02-06T02:45:59Z |   38 |
| name by IN | 76 |   Jarrod | 2017-02-15T02:45:29Z |   76 | 
```

* * *

## 回答 #10

> 赞同：3
> 
>             
> 
> 时间：2018-05-22T11:38:31.760

**2018** : **IN (...)**更快。但是**>= && <=**甚至比**IN**还要快。

这是我的[基准](https://dba.stackexchange.com/a/207474/44959)。

* * *

## 回答 #11

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T18:39:07.417

我敢打赌它们是相同的，您可以通过执行以下操作来运行测试：

循环“in (1,2,3,4)”500 次，看看需要多长时间。循环“=1 or =2 or=3...”版本 500 次，看看它运行了多长时间。

你也可以尝试连接方式，如果 someField 是一个索引并且你的表很大，它可能会更快......

```
SELECT ... 
    FROM ... 
        INNER JOIN (SELECT 1 as newField UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4) dt ON someFIELD =newField 
```

我在我的 SQL Server 上尝试了上面的 join 方法，它与 in (1,2,3,4) 几乎相同，它们都导致聚集索引查找。我不确定 MySQL 将如何处理它们。

* * *

## 回答 #12

> 赞同：1
> 
>             
> 
> 时间：2020-06-14T13:57:18.273

正如其他人所解释的，在查询性能方面，IN 比 OR 更好。

在以下情况下，带有 OR 条件的查询可能需要更长的执行时间。

1.  如果 MySQL 优化器选择任何其他索引来提高效率（在误报情况下），则执行。

2.  如果记录数更多（正如 Jacob 明确指出的那样）

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:33:57.367

据我了解编译器优化这些类型的查询的方式，使用 IN 子句比多个 OR 子句更有效。如果您有可以使用 BETWEEN 子句的值，那仍然更有效。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T19:04:58.867

我知道，只要你在 Field 上有一个索引，BETWEEN 就会用它快速找到一端，然后遍历到另一端。这是最有效的。

我见过的每个 EXPLAIN 都显示“IN (...)”和“... OR ...”是可以互换的并且同样（无效）效率。这是您所期望的，因为优化器无法知道它们是否包含一个区间。它也等效于单个值的 UNION ALL SELECT。

# ruby-on-rails - Active Record 有默认的英文翻译文件吗？

> ID：782921
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-04-23T18:19:25.933
> 
>         
> 
> 标签：ruby-on-rails, activerecord, localization, translation

我正在将一个应用程序从一个 rails 应用程序升级到 2.3.2，我发现我无法显示 ActiveRecord 的默认验证错误消息，因为我没有它的翻译文件。

这是报告的错误：

```
translation missing: en-US, activerecord, errors, template, header
translation missing: en-US, activerecord, errors, template, body
Email translation missing: en-US, activerecord, errors, models, user, attributes, email, taken 
```

有谁知道我在哪里可以找到包含验证可能使用的所有字符串的默认英语翻译文件？

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-04-30T00:06:40.060

发生这种情况是因为我的语言设置是“en-US”而不是“en”。在 activerecord/lib/locale 下有翻译文件。我将这些翻译复制到一个新文件 en_US.yml 中。

```
"en-US": 
  activerecord:
    errors: 
        template: 
            body: There were problems with the following fields
            header: 
                one: 1 error prohibited this {{model}} from being saved
                other: "{{count}} errors prohibited this {{model}} from being saved"  
        messages:
            inclusion: "is not included in the list"
            exclusion: "is reserved"
            invalid: "is invalid"
            confirmation: "doesn't match confirmation"
            accepted: "must be accepted"
            empty: "can't be empty"
            blank: "can't be blank"
            too_long: "is too long (maximum is {{count}} characters)"
            too_short: "is too short (minimum is {{count}} characters)"
            wrong_length: "is the wrong length (should be {{count}} characters)"
            taken: "has already been taken"
            not_a_number: "is not a number"
            greater_than: "must be greater than {{count}}"
            greater_than_or_equal_to: "must be greater than or equal to {{count}}"
            equal_to: "must be equal to {{count}}"
            less_than: "must be less than {{count}}"
            less_than_or_equal_to: "must be less than or equal to {{count}}"
            odd: "must be odd"
            even: "must be even" 
```

然后我只是在这些之后添加了我的自定义字符串。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2013-08-19T13:58:13.153

当 I18n 在 :en_US 中找不到翻译时，您可以通过告诉 I18n 回退到 :en 来避免复制和粘贴标准翻译。下面的示例初始化程序显示了我们如何从“en-GB”和“it-IT”回退到标准“en”，并使用复数形式来衡量

```
# config/initializer/i18n.rb 

I18n.backend = I18n::Backend::Chain.new(I18n.backend)
I18n::Backend::Chain.send(:include, I18n::Backend::Fallbacks)
I18n.fallbacks[:'en-GB'] << :en
I18n.fallbacks[:'it-IT'] << :en

require "i18n/backend/pluralization" 
I18n::Backend::Chain.send(:include, I18n::Backend::Pluralization) 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-06-09T11:55:25.930

仅供参考，如果您将这些包含在旧式哈希格式中，请使用它；

```
:activerecord => {
  :errors => {
      :template => {
          :body => 'There were problems with the following fields',
          :header => { 
              :one => '1 error prohibited this {{model}} from being saved',
              :other => "{{count}} errors prohibited this {{model}} from being saved"
          }
      },
      :messages => {
          :inclusion => "is not included in the list",
          :exclusion => "is reserved",
          :invalid => "is invalid",
          :confirmation => "doesn't match confirmation",
          :accepted => "must be accepted",
          :empty => "can't be empty",
          :blank => "can't be blank",
          :too_long => "is too long (maximum is {{count}} characters)",
          :too_short => "is too short (minimum is {{count}} characters)",
          :wrong_length => "is the wrong length (should be {{count}} characters)",
          :taken => "has already been taken",
          :not_a_number => "is not a number",
          :greater_than => "must be greater than {{count}}",
          :greater_than_or_equal_to => "must be greater than or equal to {{count}}",
          :equal_to => "must be equal to {{count}}",
          :less_than => "must be less than {{count}}",
          :less_than_or_equal_to => "must be less than or equal to {{count}}",
          :odd => "must be odd",
          :even => "must be even"
      }
  } 
```

}

# oracle - Oracle 中的族谱查询

> ID：782928
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-23T18:21:08.350
> 
>         
> 
> 标签：oracle, hierarchical-data, genealogy

我正在尝试从我的 Oracle 数据库中获取动物的家谱树。

这是表格：

```
Animal
------------------------
Animal_ID
Parent_Male_ID
Parent_Female_ID
....
....
------------------------ 
```

如果我指定一种动物，我可以使用以下方法获取它的所有后代（在雄性方面）：

```
SELECT *
FROM animal
START WITH animal_id = 123
CONNECT BY PRIOR animal_id = parent_male_id 
```

我试图找到一种方法来扩展它，如果我指定一种动物，它将获取父母双方，然后获取他们所有的后代。

有什么想法吗？（这是 Oracle 9.2）

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T18:23:37.937

```
SELECT  *
FROM    animal
START WITH
        animal_id IN
        (
        SELECT  parent_male_id
        FROM    animal
        WHERE   animal_id = 123
        UNION ALL 
        SELECT  parent_female_id
        FROM    animal
        WHERE   animal_id = 123
        )
CONNECT BY
        PRIOR animal_id IN (parent_male_id, parent_female_id) 
```

然而，这个查询会很慢。

最好使用这个：

```
SELECT  DISTINCT(animal_id) AS animal_id
FROM    (
        SELECT  0 AS gender, animal_id, father AS parent
        FROM    animal
        UNION ALL
        SELECT  1, animal_id, mother
        FROM    animal
        )
START WITH
        animal_id IN
        (
        SELECT  father
        FROM    animal
        WHERE   animal_id = 9500
        UNION ALL 
        SELECT  mother
        FROM    animal
        WHERE   animal_id = 9500
        )
CONNECT BY
        parent = PRIOR animal_id
ORDER BY
        animal_id 
```

，它将使用`HASH JOIN`并且速度更快。

有关性能详细信息，请参阅我的博客中的此条目：

*   [**父母双方的家谱查询**](http://explainextended.com/2009/05/24/genealogy-query-on-both-parents/)

# .net - 你能推荐我一本关于授权架构和相关范式的书吗？

> ID：782930
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T18:22:10.640
> 
>         
> 
> 标签：.net, security, permissions, authorization, roles

我来自 ASP.NET 背景，发现整个基于角色的授权方案至少可以说是有限的。我读过微软的新身份模型和基于声明架构的日内瓦框架，但它似乎过于复杂。

一般来说，我想更多地了解可能的授权架构，以找出最适合我的需求。

例如，如果您想创建应用程序范围的角色，例如“管理员”，那么应用程序范围的角色似乎就足够了。但是，如果我有 ie。具有项目实体的项目管理应用程序，其中每个项目都有自己的一组角色（例如项目 A 上的“编辑”和项目 B 上的“摄影师”）和相关权限。

有没有这方面的书可以推荐？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-07-22T15:26:26.077

由于您来自 ASP.NET 背景，可能最专注于 ASP.NET 框架内安全/授权主题的书是：

[使用 C# 和 VB 的专业 ASP.NET 3.5 安全性、成员资格和角色管理](https://rads.stackoverflow.com/amzn/click/com/0470379308)

（或者是针对 ASP.NET 2.0 等的先前版本）

还有老的：

[编程 .NET 安全性](https://rads.stackoverflow.com/amzn/click/com/0596004427)

但是，这些书将简单地详细介绍现有的身份验证和授权机制，因为它们存在于 ASP.NET 成员模型中，并且正如您所说，它们在很大程度上基于用户/角色设置。

如果您希望专注于 Microsoft/.NET 世界，那么值得研究可被 WCF（Windows Communication Foundation）等技术采用的*联合安全*模型的一件事。这种机制允许一种相对轻量级的安全管理方法，并且可以更轻松地完成您在示例中所追求的那种事情（项目A：编辑器/项目B：摄影师）。  

这方面的一些链接是：

[Federation（来自 MSDN）](http://msdn.microsoft.com/en-us/library/ms730908.aspx)

[Federation and Issued Tokens](http://msdn.microsoft.com/en-us/library/ms731161.aspx) 

[patterns & practice: WCF Security Guidance](http://wcfsecurity.codeplex.com/Wiki/View.aspx?title=What%20is%20federated%20security%3F) 
[Learning WCF Book - Federated Security Section](http://books.google.com/books?id=-AUyj6S7etwC&pg=PA480&lpg=PA480&dq=wcf+federated+security&source=bl&ots=4vbuU6vIFL&sig=UthWFAI8kF8vSDxbjFJ2FC50_ps&hl=en&ei=wShnSv6TIZyhjAeMso2UAQ&sa=X&oi=book_result&ct=result&resnum=10)

如果您正在寻求一种与平台无关的更通用或通用的安全性和身份验证/授权机制方法，那么一些好的资源/书籍将是：

[设计安全架构解决方案](https://rads.stackoverflow.com/amzn/click/com/0471206024)

（本书详细介绍了不同的安全概念和架构，不仅用于验证/授权用户，还用于[代码访问安全](http://msdn.microsoft.com/en-us/library/930b76w0%28VS.71%29.aspx)等概念）

还有：

[企业安全架构：业务驱动的方法](https://rads.stackoverflow.com/amzn/click/com/157820318X)

（顾名思义，它更侧重于“业务”，并且主要关注[SABSA（Sherwood 应用业务安全架构）](http://en.wikipedia.org/wiki/SABSA)方法）

# c# - c# lambda 表达式 - 将委托结果添加到通用列表

> ID：782933
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T18:23:34.020
> 
>         
> 
> 标签：c#, .net, .net-3.5, lambda

**问：**我刚刚使用 c# lambda 表达式编写了我的第一个代码。它有效，但我不确定这是否是最好的方法。关于更好地执行 lambda 表达式的任何建议？就像我在下面做的那样，在表达式中有很多行代码似乎很奇怪。

**背景：**我有一份通用的代表名单。每个委托函数都返回一个枚举值，指示函数中发生了什么。在评估委托后，如果它不是特定的枚举值，我需要将枚举添加到列表中。

**免责声明：**这里的代码非常通用，真正的代码实际上在委托中做一些事情来确定返回值！

* * *

```
class Class1
{
    public enum WhatHappened
    {
        ThingA,
        ThingB,
        Nothing
    }

    private delegate WhatHappened del();

    public static List<WhatHappened> DoStuff()
    {
        List<del> CheckValues = new List<del>();

        List<WhatHappened> returnValue = new List<WhatHappened> { };

        CheckValues.Add(delegate { return method1(); });
        CheckValues.Add(delegate { return method2(); });

        CheckValues.ForEach(x =>
        {
            WhatHappened wh = x();
            if (wh != WhatHappened.Nothing)
                returnValue.Add(wh);
        });

        return returnValue;

    }

    private static WhatHappened method1()
    {
        return WhatHappened.Nothing;
    }

    private static WhatHappened method2()
    {
        return WhatHappened.ThingA;
    }

} 
```

**注意：**  我最初有 lambda，比如添加所有项目（见下文），然后删除我不想要的那些（WhatHappened.Nothing）。

```
CheckValues.ForEach(x => returnValue.Add(x())); 
```

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-04-23T18:35:44.693

好的，有几点建议：

*   不要打电话给你的代表`del`。在这种情况下，我会使用`Func<WhatHappened>`- 但如果您*确实*想声明自己的委托类型，请给它一个更具描述性的名称，并遵守 .NET 命名约定。

*   而不是使用匿名方法添加到`CheckValues`，您可以使用：

    ```
    CheckValues.Add(method1);
    CheckValues.Add(method2); 
    ```

    编译器会将方法组转换为委托。

*   我建议不要使用 Pascal 大小写作为局部变量名的开头。

*   您的集合初始化程序`returnValues`并没有真正为您做任何事情 - 只需`List<T>`照常调用构造函数，或者使用我下面的代码，它不需要以局部变量开头。

*   如果您的列表中*真的*只有两个代表，我会单独打电话给他们。这要简单得多。

*   否则，您确实可以按照 Jared 的建议使用 LINQ，但我会稍有不同：

    ```
    return CheckValues.Select(x => x())
                      .Where(wh => wh != WhatHappened.Nothing)
                      .ToList(); 
    ```

编辑：正如建议的那样，这是完整的示例。不过，它和丹尼斯的不太一样……我做了一些改变：）

```
public static List<WhatHappened> DoStuff()
{
    var functions = new List<Func<WhatHappened>> { Method1, Method2 };

    return functions.Select(function => function())
                    .Where(result => result != WhatHappened.Nothing)
                    .ToList();
} 
```

（我假设`method1`并且`method2`已被重命名以适应命名约定。当然在现实生活中我相信他们会有更多有用的名字......）

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T18:33:09.130

您可以通过链接 Select (map) 和 Where (filter) 而不是多个 FOR 循环和 IF 语句来一直使用 lambda

```
// get results from the list of functions
var results = CheckValues.Select(x => x());

// filter out only the relevant ones.
var returnValues = results.Where(x => x != WhatHappened.Nothing); 
```

基本上，在使用 lambda 时，您应该更多地以**[声明](http://en.wikipedia.org/wiki/Declarative_programming)**方式而不是**[命令方式思考。](http://en.wikipedia.org/wiki/Imperative_programming)**它将帮助您编写更优雅的代码。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T18:38:32.283

我会简单地使用 Linq，但这只是我：

```
public static List<WhatHappened> DoStuff()
{
    List<del> CheckValues = new List<del>();

    List<WhatHappened> returnValue = new List<WhatHappened>();

    CheckValues.Add(method1);
    CheckValues.Add(method2);

    return CheckValues
               .Select(dlg => dlg())
               .Where( res => res != WhatHappened.Nothing)
               .ToList();
} 
```

请注意，如果需要，您也可以使用 Func 而不是声明 Delegate 类型，但在这种情况下就不那么简洁了。另外，我会返回一个`IEnumerable<WhatHappened>`而不是一个列表，但这都是关于上下文的。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T18:33:19.613

编写以下内容而不是使用委托关键字会更惯用一些。但它不会改变底层功能。  

```
CheckValues.Add( () => method1() ); 
```

此外，我发现将 ForEach 重写为以下内容更具可读性

```
CheckValues = CheckValues.
  Select(x => x()).
  Where(wh => wh != WhatHappened.Nothing ). 
  ToList(); 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:33:04.140

在我看来，基于示例，它看起来不错。您可以通过替换进行更多重构：

```
CheckValues.Add(delegate { return method1(); });
CheckValues.Add(delegate { return method2(); }); 
```

和：

```
CheckValues.Add(() => WhatHappened.Nothing);
CheckValues.Add(() => WhatHappened.ThingA); 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:38:47.230

这是一个无 LINQ 的解决方案：

```
return CheckValues
    .ConvertAll<WhatHappened>(x => x())
    .FindAll(y => y != WhatHappened.Nothing); 
```

**警告**

这不是最高效的解决方案，因为它会迭代两次。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T19:04:01.070

我无法理解代码的目的..但是这里有。

使用委托链接 
**更新：**并从 Jon n Jared 的帖子中获得了一些可枚举的优点

```
private delegate WhatHappened WhatHappenedDelegate();

public static List<WhatHappened> DoStuff()
{
    WhatHappenedDelegate delegateChain = null;
    delegateChain += method1;
    delegateChain += method2;

    return delegateChain.GetInvocationList() 
            .Select(x => (WhatHappened) x.DynamicInvoke())
            .Where( wh => (wh != WhatHappened.Nothing))
            .ToList<WhatHappened>();
} 
```

# asp.net - 有没有人使用 ASP.net (webforms) 来动态生成 javascript 和/或 css 文件？

> ID：782937
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-23T18:24:49.073
> 
>         
> 
> 标签：asp.net, javascript, css, templating

我更喜欢使用外部 css 和 javascript 文件。然而，在许多情况下，javascript 或 css 文件的内容需要是动态的。我通常只是将 javascript 或 css 传输到我的 aspx 页面中的内联或 inpage 代码并在那里处理动态内容。

有没有人有更好的方法？有没有办法使用 asp.net 的常规模板语言生成整个 js 或 css 文件？

我目前正在使用网络表单，但我也有兴趣在 MVC 中解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T18:27:03.013

我以前使用过[HTTPHandler](http://msdn.microsoft.com/en-us/library/system.web.ihttphandler.aspx)发回动态 javascript。但不是继承自 System.Web.UI.Page 的东西。

使用 HTTPHandler 和[ASHX](http://www.aspcode.net/Creating-an-ASHX-handler-in-ASPNET.aspx)或[AXD](http://weblogs.asp.net/jeff/archive/2005/07/18/419842.aspx)是动态发回资源的“ASP.Net”方式。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T18:27:35.633

我已经为动态 CSS 使用了处理程序。根据您的需要，您可以对 js 文件执行相同的操作。

我有一个 css 文件，其中包含需要动态的部分的占位符，例如##bacgroundcolor##，并且处理程序只是根据需要替换。

我还使用了一种方法，我使用 css 类来标记需要特殊行为的 html 元素。然后静态 js，寻找这个元素并挂钩适当的处理程序。使用 jquery 肯定会更容易做到这一点（我当时用常规 js 做到了:()。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:28:42.417

我之前在一个 aspx 页面中做过这个，但在我看来，WebForm 样式本身并不适合严格呈现 javascript 或 CSS。每次我这样做时，页面最终看起来有点像经典的 ASP。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:29:12.527

希望您使用的实际 JavaScript 将保持静态，您只需将参数传递给 JavaScript 方法。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:33:46.697

我采用了页面标记中包含类似内容的 JavaScript 代码，`<%= control.ClientID %>`并将其替换为静态 JavaScript。我将代码重构为一个类，然后将这些可变部分重构为类成员。该页面创建了一个类的实例，并设置了诸如 ClientID 之类的内容。然后这些函数可以是静态的。

# wix - WIX 已安装的属性

> ID：782938
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-23T18:25:29.180
> 
>         
> 
> 标签：wix, wix3

我正在做一个安装程序，使用 wix v3。我有两个安装程序。我用第一个安装了我的应用程序，然后我想用第二个安装程序更新它。

我认为我错过了一些东西，因为我无法安装产品然后运行更新（使用其他安装程序），如果我执行相同的版本，我可以看到维护窗口，它识别出产品已安装。问题出在其他版本。

我认为这些可能是因为 Installed 属性的价值。我应该怎么做才能正确设置这些属性？我正在为所有用户安装产品...

有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T22:11:36.080

请参阅[如何实施 Wix 安装程序升级](https://stackoverflow.com/questions/114165/how-to-implement-wix-installer-upgrade)，其中提供了许多详细示例。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-24T01:09:26.417

我已经做到了。它适用于相同的产品 ID，但是当我更改产品 ID 时，它会识别升级代码（（我确定这一点，因为我设置了一个属性），但 Installed 属性设置为 false。我将使用一个属性注意不同的版本，与最后一个答案有关。谢谢！

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:30:23.210

您是否将 WIX 项目设置为能够检测到它是升级？看看基础[WIX 教程的](http://www.tramontana.co.hu/wix/)[升级部分](http://www.tramontana.co.hu/wix/lesson4.php)

# html - 宽度未知的 CSS 浮动不会用 doctype 包裹空格

> ID：782945
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T18:27:42.123
> 
>         
> 
> 标签：html, css, firefox, css-float, doctype

两个 div，向左浮动，宽度未知。其中一个的内容超出了页面的大小，因此它移动到第一个下方（IE 除外）：

[http://corexii.com/floatproblem/float.html](http://corexii.com/floatproblem/float.html)

添加显示：内联表；并且大的包装了它的内容（在浏览器中始终如一）：

[http://corexii.com/floatproblem/table.html](http://corexii.com/floatproblem/table.html)

但是引入一个文档类型（不仅仅是严格的，任何文档类型），它在 Firefox 中不再存在：

[http://corexii.com/floatproblem/doctype.html](http://corexii.com/floatproblem/doctype.html)

如何在使用 doctype 的同时可靠地跨浏览器获取正确的 div 来包装其内容？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T18:53:56.350

> 如何在使用 doctype 的同时可靠地跨浏览器获取正确的 div 来包装其内容？

如果不定义宽度，**则无法**. 在这种情况下，我建议使用百分比宽度，但这取决于你。

**div 的默认宽度是其容器**（在本例中为页面）的 100%。除非您将页面的大小设置为小于其固有宽度，否则第一个 div 最终将是它的实际大小。在没有完整且有效的文档类型的情况下期望跨浏览器的一致性只是徒劳的练习。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T19:57:39.553

CSS 不能完全做到基于表格的布局所能做到的一切。一方面，动态宽度布局要复杂得多。在 98% 的情况下，无表格布局仍然更可取，但如果您真的需要这种动态宽度布局，您可能必须使用表格。

不一致的宽度，如果不仔细比例，从美学的角度来看不是很好，所以你可能正在解决错误的问题。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T19:41:43.943

您可以从包含一个`BODY`元素开始。

Traingamer 向您解释了 Firefox 的行为以及需要做什么才能获得您想要的结果。您可能会听他的，而不是直接说 CSS 无法创建布局。

不要因为不遵守正确的 Web 规范而引入的*问题归咎于 CSS。*

# ruby-on-rails - 从 Flex 应用程序向 Ruby on Rails 后端发送发布请求时出现问题

> ID：782954
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T18:31:14.267
> 
>         
> 
> 标签：ruby-on-rails, apache-flex, httpservice

我无法让我的 flex 应用程序向我的 Rails 应用程序发送 POST 请求。它似乎总是发送 GET。  

这是我的服务声明：

```
<mx:HTTPService id="add_email_service" showBusyCursor="true" result="parseJoinResult();" fault="onJoinFault(event)" useProxy="false" /> 
```

在我的应用程序初始化函数中，我将方法设置为 POST：

```
add_email_service.url = join_url;
add_email_service.method = "POST"; 
```

但是，当我发送请求时，我的 Rails 应用程序仍将请求视为发布请求。我知道这一点，因为如果我要求在我的 routes.rb 文件中发布请求：

```
# RESTful API for joining a mailing list
  map.connect 'mailing_lists/join/:id', 
      :controller => 'mailing_lists', 
      :action => 'join', 
      :conditions => { :method => :post} 
```

请求错误，我可以在我的开发日志中看到：

“处理 ApplicationController#index (for 127.0.0.1 at 2009-04-23 14:25:35) [GET], ActionController::MethodNotAllowed (只允许发布请求。):”

有谁知道为什么会这样？  

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-11T21:17:42.073

如果没有发送变量，旧版本的 Flash Player（在某些浏览器中）会自动将您的请求从 POST 切换到 GET。

尝试在您的请求中添加一个参数，看看是否可以解决它。

将 Flash Player 与 Restful Rails 集成？

也为其他一些问题做好准备：

1.  Flash Player 只能接受 200 的 HTTP 状态代码，其他一切都会引发异常并阻止您获取消息正文。

2.  您不能发送 PUTS 或 DELETE HTTP 方法

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-13T06:42:02.220

我相信它实际上只有200个。

# c++ - 从 Xerces (c++) 获取 XML 数据

> ID：782955
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T18:31:26.890
> 
>         
> 
> 标签：c++, xml, xerces

我是 XML 的后来者 - 必须解析 XML 文件。我们公司已经在使用 xerces，所以我设法拼凑了一个示例应用程序 (SAX)，它在文件中显示所有数据。但是，在解析完成后，我希望能够调用解析器或其他具有文件内部表示的实体并遍历字段/数据。

基本上我希望能够给它一些键或其他字符串并取回字符串或键/值对的集合。我没有看到。在我看来，这是一件好事。我错过了什么吗？  

DOM 是在解析我想要的，还是这也不够？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-23T18:37:01.400

Xerces 同时提供 SAX 和 DOM 处理。SAX 解析不构建模型，因此一旦解析完成，就没有什么可以检查或迭代了。DOM 处理会生成一个树结构模型，它可以为您提供所需的内容。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-10-06T08:01:45.503

查看此页面中的初学者示例 
[YoLinux Tutorial on Parsing XML](http://www.yolinux.com/TUTORIALS/XML-Xerces-C.html)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2011-07-27T02:49:36.287

如果使用 XercesDOMParser，在文档解析后仍然无法请求特定的键值对。我最近遇到了同样的问题，在遍历 DOM 树时，我将所有键值对存储在 STL 映射中。然后，您可以稍后在程序中从映射中请求键值对。

# flash - 在 AS2 中重新加载当前帧？

> ID：782956
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T18:31:35.623
> 
>         
> 
> 标签：flash, actionscript, actionscript-2

实现以下目标的最明智的方法是什么`this.gotoAndStop(this._currentframe)`？

我想要的是 Flash 重新加载当前帧，就好像我正在使用 gotoAndStop 一样（如果将当前帧作为目标帧，它什么也不做）。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:36:54.783

我想我不明白您为什么要这样做，但是如果您转到当前帧之前（或之后）的帧然后返回怎么办？

```
var current:int = _currentFrame;
gotoAndStop(current - 1);
gotoAndStop(current); 
```

我已经有一段时间没有完成 AS2 了，所以我完全不确定上面的代码会产生什么（如果有的话）。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-06T10:02:37.797

您可以在有问题的帧上使用影片剪辑类方法来做到这一点

上一帧（）

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2016-01-23T06:42:02.760

我使用这个命令，这对我有用

```
on (release) {
    prevFrame();
}

on (release) {
    nextFrame();
} 
```

# css - IE打印问题

> ID：782958
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T18:31:51.973
> 
>         
> 
> 标签：css, internet-explorer, printing

我在从我们的网站打印页面时遇到了一些问题。我们有一个特定的页面用于打印包括图像在内的一些详细信息。在这个特定于打印的页面上，我们去掉了导航、品牌等，只留下用户的数据，这样他们就可以得到干净的打印。

大部分数据采用图像的形式，可能有也可能没有相关的标题。

当我们从 Firefox 打印时，它可以正确打印。但是，从 IE 7 打印的标题通常放在一起，远高于相关图像。它也以这种方式出现在“打印预览”中。

页面结构是这样的：

```
<head>
stuff
</head>
<body>
<div class="ContentDisplay">
        <div id="contentcontainer" class="threecolumn general">
            <div id="maincontent" class="content">
                <div id="ctl00_mainContent_contentHolder">
                <br></br><div>
<h2><span id="ctl00_mainContent_ctl02_lblGuestBook">Guest Book</span></h2>

<div class="tribute_holder">
    <div class="tribute_info" style="padding-bottom: 1px;">

    <p></p>

    <p></p>

    </div>

    <div class="pagination audiopaging">

    </div>
    <br />
    <div id="ctl00_mainContent_ctl02_gbPanel" class="tributes">

             <div>
              <h3>
               Text</p>
             </div>

</div>
 </div>

</div><br></br><div>
<h2><span id="ctl00_mainContent_ctl05_lblImages">Images</span></h2>

<div id="ctl00_mainContent_ctl05_plainImages">

    <span id="ctl00_mainContent_ctl05_plainImagesLabel"></span>
<div style="clear:both;"><div style="margin-left:auto;margin-right:auto;" class="torncontainer"><div class="tornborder">
        <div>
            <div>
                <div>
                    <div>
                        <img src="image path" alt="caption 1" style="border-width:0px;" />
                    </div>
                </div>
            </div>
        </div>
        </div>
</div>
<div style="text-align:center;margin-bottom:2em;clear:both;">caption 1</div>
</div>
<div style="clear:both;">
<div style="margin-left:auto;margin-right:auto;" class="torncontainer"><div class="tornborder">
        <div>
            <div>
                <div>
                    <div>
                        <img src="image source" alt="caption 2" style="border-width:0px;" />
                    </div>
                </div>
            </div>
        </div>
    </div></div><div style="text-align:center;margin-bottom:2em;clear:both;">caption 2</div></div> 
```

等等

综上所述，实际图像包含在一个 'tornborder' 类 div 中，其中包含 4 个嵌套 div，然后是图像（该类用于在图像周围渲染图形边框），然后是包含标题的 div。这两个 div 都包含在另一个明确的 div 中。

如果不包含“Guest Book” div（例如未选择打印该功能时），图像会正确打印。

我尝试了很多不同的东西，包括删除所有浮动和清除所有内容，但我似乎无法让这个打印正常工作。

有任何想法吗？

编辑：为了清楚起见，这是代码的相关部分，已经完成了很多仓促的文本剥离。实际页面中的所有标签都正确关闭和嵌套。该页面是有效的 HTML。

编辑第二个：

这是相关的 CSS 信息，这是整个“打印”样式表：

```
/* Torn Border */
.tornborder div
{
    background: url(/images/universal/tl.jpg) top left no-repeat;
    float: left;
    margin: 0 0 20px 0;
}
.tornborder div div
{
    background: url(/images/universal/tr.jpg) top right no-repeat;
    margin: 0;
    padding: 15px 0 0 0;
}
.tornborder div div div
{
    background: url(/images/universal/rb.jpg) top right repeat-y;
    margin: 0;
    padding: 0;
}
.tornborder div div div div
{
    background: url(/images/universal/bl.jpg) bottom left no-repeat;
}
.tornborder div div div div img
{
    background: url(/images/universal/br.jpg) bottom right no-repeat;
    margin: -15px 0 0 0;
    padding: 15px;
    /*width: 130px;*/
}

#ie7andup .tornborder div div div div img, #ie6andbelow .tornborder div div div div img
{
    margin: -15px 0 -5px 0;
    display:inline-block;
} 
```

整个页面周围的 div（就在正文内部）允许通过 '#ie7andup' div 对 IE7 进行特定定位，并通过条件注释放置在那里。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-24T17:28:16.580

好的，鉴于我知道这仅在图像跟随文本时发生（例如来自故事或留言簿），我正在重新排列复选框的顺序 - 图像现在始终是第一个。

该错误将消失，但无法解决。

不是最佳解决方案，但我已经为此花费了 16 多个小时。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T22:51:21.897

过去，我在清除 ie 中的浮动时遇到过类似的问题。尝试在 CSS 中为您的图像和标题提供明确的宽度。宽度：自动；甚至可以。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T22:53:46.413

也可能会尝试清除浮动 - 已经修复了有时似乎是随机问题

# c# - Silverlight 水印自动完成框

> ID：782959
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T18:31:55.577
> 
>         
> 
> 标签：c#, silverlight, autocomplete, watermark

有人可以指导我参考一个可以帮助我的示例或解释：

1.  扩展 SilverLight 自动完成框以允许添加水印。

2.  扩展水印文本框以允许自动完成功能。

我觉得选项 1 是最简单的，但我很开放。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-23T18:47:27.177

马上，我会说选项 1 很好：

1) 创建一个附加属性来保存您可以在 AutoCompleteBox 上使用的 WatermarkText。

2）为AutoCompleteBox创建一个控件模板（只需使用混合复制现有的），但将TextBox更改为Watermark TextBox，并使用TemplateBinding将WatermarkTextBox的属性设置为附加属性的值。控件模板应以样式应用（例如 WatermarkedAutoCompleteBoxStyle）。

你应该很高兴。任何时候您想要一个带水印的自动完成框，只需设置附加的属性值并应用您定义的样式。

如果您需要对其中一个步骤进行更深入的解释，请举手，我会尽量抽出时间来创建示例。

或者，您可以从 AutoCompleteBox 派生，添加 DependencyProperty 而不是附加属性，并将样式打包到 Themes/generic.xaml 文件中，但我通常会在它工作后执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2014-06-12T12:31:10.153

根据史蒂夫的回答：

```
Public Class WatermarkExtender
    Inherits DependencyObject

    Public Shared ReadOnly WatermarkProperty As DependencyProperty =
        DependencyProperty.RegisterAttached(
            "Watermark",
            GetType(Object),
            GetType(WatermarkExtender),
            New UIPropertyMetadata(Nothing))

    Public Shared ReadOnly WatermarkTemplateProperty As DependencyProperty =
        DependencyProperty.RegisterAttached(
            "WatermarkTemplate",
            GetType(DataTemplate),
            GetType(WatermarkExtender),
            New UIPropertyMetadata(Nothing))

    Public Shared Sub SetWatermark(ByVal element As UIElement, ByVal value As Object)
        element.SetValue(WatermarkProperty, value)
    End Sub

    Public Shared Function GetWatermark(ByVal element As UIElement) As Object
        Return element.GetValue(WatermarkProperty)
    End Function

    Public Shared Sub SetWatermarkTemplate(ByVal element As UIElement, ByVal value As Object)
        element.SetValue(WatermarkTemplateProperty, value)
    End Sub

    Public Shared Function GetWatermarkTemplate(ByVal element As UIElement) As Object
        Return element.GetValue(WatermarkTemplateProperty)
    End Function
End Class 
```

样式：

```
<!--  input:AutoCompleteBox  -->
    <Style TargetType="input:AutoCompleteBox">
        ...
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="input:AutoCompleteBox">
                    <Grid Opacity="{TemplateBinding Opacity}">
                        <extk:WatermarkTextBox 
                            Padding="{TemplateBinding Padding}"
                            Background="{TemplateBinding Background}" 
                            IsTabStop="True" 
                            x:Name="Text" 
                            Style="{TemplateBinding TextBoxStyle}" 
                            BorderThickness="{TemplateBinding BorderThickness}" 
                            BorderBrush="{TemplateBinding BorderBrush}" 
                            Foreground="{TemplateBinding Foreground}" 
                            Margin="0" 
                            Watermark="{Binding Path=(local:WatermarkExtender.Watermark), Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                            WatermarkTemplate="{Binding Path=(local:WatermarkExtender.WatermarkTemplate), Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" />

                        ...
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

用法：

```
<Window.Resources>
<Style x:Key="acWatermarkStyle" TargetType="{x:Type wtk:AutoCompleteBox}" BasedOn="{StaticResource {x:Type wtk:AutoCompleteBox}}">
            <Setter Property="local:WatermarkExtender.WatermarkTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <TextBlock Foreground="Gray" Margin="3,0,0,0" Text="{Binding}" />
                    </DataTemplate>
                </Setter.Value>
            </Setter>
        </Style>
</Window.Resources>

<wtk:AutoCompleteBox 
Height="25" 
Margin="2" 
Style="{StaticResource acWatermarkStyle}"
HorizontalAlignment="Stretch"
ValueMemberPath="SomeProp"
FilterMode="Custom" 
local:WatermarkExtender.Watermark="type something" /> 
```

# java - 在表单上重新填充数据库驱动的文本框

> ID：782960
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T18:32:04.873
> 
>         
> 
> 标签：java

我有一个数据库驱动的文本框，当用户点击后退按钮时需要重新填充（我在表单上创建的后退按钮）

目前，我可以使用 http 会话重新填充表单上的非数据库驱动字段。我似乎无法将相同的逻辑应用于数据库驱动的字段。

我的jsp上的代码如下：

```
 <td><select name = "actionType" tabindex = "1" value="<%if(session.getAttribute("actionType")== null) out.print(""); else out.print(session.getAttribute("actionType"));%>">
        <option>--</option>

        <% for(int i=0; i<actTypeDDL.size()-1; i++){    
            String actType = actTypeDDL.get(i).toString();
            i++;
            String actTypeVal = actTypeDDL.get(i).toString();%>

            <option value=<%=actTypeVal%>>
            <%=actType%>
            </option>
            <%
            } %>
        </select></td> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:38:25.017

该问题与该值来自数据库这一事实没有任何关系，问题在于在选择标签上指定一个值不会预先选择该选项。您需要为选项本身添加一个“选定”标志。

以下应该有效：

```
<td><select name = "actionType" tabindex = "1" >
    <option>--</option>

    <% for(int i=0; i<actTypeDDL.size()-1; i++){    
            String actType = actTypeDDL.get(i).toString();
            i++;
            String actTypeVal = actTypeDDL.get(i).toString();%>

            <option value=<%=actTypeVal%>
            <% if (session.getAttribute("actionType") == actTypeVal) {
                System.out.println("selected = 'true'");
            } %>
            >
            <%=actType%>
            </option>
            <%
            } %>
    </select></td> 
```

# ruby - 为什么 BigDecimal 返回一个奇怪的值？

> ID：782961
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2009-04-23T18:32:14.140
> 
>         
> 
> 标签：ruby, floating-point, bigdecimal

我正在编写处理货币、费用等的代码。我将使用 BigDecimal 类进行数学和存储，但我们遇到了一些奇怪的问题。

这个说法：

```
1876.8 == BigDecimal('1876.8') 
```

返回假。

如果我通过格式化字符串运行这些值，`"%.13f"`我会得到：

```
"%.20f" % 1876.8 => 1876.8000000000000
"%.20f" % BigDecimal('1876.8') => 1876.8000000000002 
```

请注意 BigDecimal 中最后一位小数的额外`2`内容。

我认为 BigDecimal 应该可以解决将实数直接存储在计算机的本机浮点中的不准确性。这是`2`从哪里来的？

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-04-23T21:05:33.617

它不会让您对小数位数进行太多控制，但 BigDecimal 的传统格式机制似乎是：

```
a.to_s('F') 
```

如果您需要更多控制权，请考虑使用 Money gem，假设您的域问题主要与货币有关。

```
gem install money 
```

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-04-23T18:57:41.007

你是对的，BigDecimal 应该正确存储它，我最好的猜测是：

*   BigDecimal 正确存储值

*   当传递给字符串格式化函数时，BigDecimal 被转换为较低精度的浮点值，从而创建 ...02。

*   直接与浮点数比较时，浮点数的小数位数远远超出您看到的 20 位（经典浮点数无法比较行为）。

无论哪种方式，将浮点数与 BigDecimal 进行比较都不太可能获得准确的结果。

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2012-12-25T19:29:25.293

### 不要比较 FPU 十进制字符串分数是否相等

问题是浮点或双精度值与包含小数的十进制常量的相等比较很少成功。

很少有十进制字符串分数在二进制 FP 表示中具有精确值，因此相等比较通常注定要失败。^*

要回答您的确切问题，这`2`是来自将十进制字符串分数转换为`Float`格式的略有不同的转换。因为分数不能精确表示，所以两个计算可能会在中间计算中考虑不同的精度，并最终以不同的方式将结果四舍五入为 52 位 IEEE 754 双精度尾数。这几乎不重要，因为无论如何*都*没有确切的表示，但一个可能比另一个更错误。

特别是，您`1876.8`不能用 FP 对象精确表示，实际上，在 0.01 和 0.99 之间，只有 0.25、0.50 和 0.75 具有精确的二进制表示。所有其他的，包括 1876.8，永远重复并四舍五入到 52 位。这大约是 BigDecimal 存在的一半原因。（另一半原因是 FP 数据的固定精度：有时您需要更多。）

因此，将实际机器值与十进制字符串常量进行比较时得到的结果取决于二进制小数中的每一位……低至 1/2 ^(52) ……甚至需要四舍五入。

如果产生数字的过程、输入转换代码或其他任何涉及的过程有任何不完美的地方（呵呵，*有点，*抱歉），它们看起来不会完全相等。

甚至可以提出比较*应该*总是失败的论点，因为没有 IEEE 格式的 FPU 甚至可以准确地表示该数字。他们真的是不平等的，即使他们看起来很像。在左侧，您的十进制字符串已转换为二进制字符串，并且大多数数字并未完全转换。在右边，它仍然是一个十进制字符串。

所以不要将浮点数与 BigDecimal 混合，只需将一个 BigDecimal 与另一个 BigDecimal 进行比较。（即使两个操作数*都是*浮点数，测试相等性也需要非常小心或模糊测试。此外，不要相信每个格式化的数字：输出格式会将余数带离分数的右侧，所以你通常不会开始看到零，你只会看到垃圾值。）

* * *

^(^*问题：机器编号是 x/2 ^n，但十进制常数是 x/(2 ^n * 5 ^m )。您作为符号、指数和尾数的值是无限重复的`0 10000001001 1101010100110011001100110011001100110011001100110011...`具有讽刺意味的是，FP 算术非常精确，当值没有分数时，等式比较工作得很好。)  

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T19:01:35.303

正如大卫所说，BigDecimal 正确存储它

```
 p (BigDecimal('1876.8') * 100000000000000).to_i 
```

返回 187680000000000000

所以，是的，字符串格式正在破坏它

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T20:32:14.353

如果您不需要小数美分，请考虑将货币存储和操作为整数，然后在显示时除以 100。我发现这比处理浮点存储和操作不可避免的精度问题更容易。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T19:21:02.527

在 Mac OS X 上，我正在运行`ruby 1.8.7 (2008-08-11 patchlevel 72) [i686-darwin9]`

```
irb(main):004:0> 1876.8 == BigDecimal('1876.8') => true 
```

但是，作为 Ruby，我认为您应该考虑发送给对象的消息。这会给您带来什么回报：

```
BigDecimal('1876.8') == 1876.8 
```

两者不等价，如果您尝试使用 BigDecimal 确定精确十进制相等的能力，它应该是询问相等消息的接收者。

出于同样的原因，我认为通过向格式字符串发送格式消息来格式化 BigDecimal 也不是正确的方法。

# asp.net - 在 ASP.Net 中调试 OutputCache

> ID：782963
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T18:32:57.477
> 
>         
> 
> 标签：asp.net, debugging, outputcache

我不知道为什么我不能让简单的输出缓存工作，也不知道如何调试这样的情况。

仅通过查看示例和我以前从事的项目，我使用了以下代码：

```
<%@ OutputCache Duration="100" VaryByParam="id" %> 
```

但由于那不起作用，我尝试了 VaryByParam="*" 和 VaryByParam="none"

这些都不起作用。

是否有快速检查以确保其他东西不会干扰 OutputCache？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-29T21:25:44.890

如果您只是想查看 OutputCache 是否正常工作，您可以随时向页面添加一个标签，该标签仅绑定到当前日期时间。第一次加载它时，它会为您提供标签绑定时间的时间戳。

下一次标签应该更新是在缓存过期并且再次点击页面之后。

```
<%@ OutputCache duration="120" varybyparam="None" varybycustom="Browser" %>

<asp:Label ID="Testlabel" runat="server" Text=""><%= DateTime.Now %></asp:Label> 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:37:45.750

您仅将其缓存 100 秒，您是否尝试过更长的值？在 Visual Studio 中启动调试器可能需要 100 秒（或更长时间！）。你也试过没有 VaryByParam 吗？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2011-11-01T21:09:46.000

这类似于 womps 的答案，但有一些更正。

如果您只是想查看 OutputCache 是否正常工作，您始终可以包含当前日期时间。第一次加载它时，它会为您提供标签绑定时间的时间戳。换句话说，缓存已准备好。如果您重新加载页面，则日期应该与缓存的输出相同。一旦缓存过期，日期时间将再次更新并重复循环。

```
<%@ OutputCache duration="120" varybyparam="None" %>
<%= DateTime.Now %> 
```

# vb.net - 创建自定义控件...无法创建“文本”属性？

> ID：782967
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-23T18:33:12.203
> 
>         
> 
> 标签：vb.net, visual-studio-2008, custom-controls

# 解决方案

我做了一些谷歌搜索并[找到了这个论坛帖子](http://www.vbdotnetforums.com/component-development/26453-custom-control-public-overrides-property-text.html)，这就是我需要做的：

```
Imports System.ComponentModel

<EditorBrowsable(EditorBrowsableState.Always), Browsable(True), Bindable(True), _
DesignerSerializationVisibility(DesignerSerializationVisibility.Visible)> _
Overrides Property Text() As String
    Get
        Return ControlText.Text
    End Get
    Set(ByVal value As String)
        ControlText.Text = value
    End Set
End Property 
```

* * *

我应该说我对创建自定义控件真的很陌生，所以我不知道整个过程的所有细节。

我正在创建一个自定义控件，其功能类似于复选框，但使用两个图像作为选中/未选中。我正在尝试添加一个 Text 属性，但它给了我这个警告：

```
Property Text() As String
    Get
        Return ControlText.Text
    End Get
    Set(ByVal value As String)
        ControlText.Text = value
    End Set
End Property 
```

> “属性‘文本’在基类‘UserControl’中隐藏了一个可重写的方法。要重写基方法，该方法必须声明为‘Overrides’。”

好的，所以这没问题。我将声明更改为`Overrides Property Text() As String`，但是当我去测试它时，“文本”未在属性下列出。我需要采取其他步骤来获得结果吗？

## 更多细节

我的控件由 2 个（或 3 个，取决于您如何看待它）组成：

1.  PictureBox - 显示选中/未选中的图像

2.  标签 - 控件上显示的文本

3.  PictureCheckBox - 这是实际控件的名称

PictureBox 停靠在 PictureCheckBox 的左侧，Label 停靠在右侧：

[![替代文字](https://i.stack.imgur.com/Y9r4f.jpg)](https://i.stack.imgur.com/Y9r4f.jpg)

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T18:35:15.287

**编辑**关于 Text 是非虚拟的。它实际上是虚拟的/可覆盖的。  

但我很好奇，你为什么要这样做。在您的具体示例中，您只是调用了基本属性，因此它似乎没有做任何事情。  

您希望在哪里显示此值以及如何设置它？

 ~~Text 是 Control 上的非虚拟/可覆盖方法。您无法覆盖该属性。如果要重新定义属性，可以使用 Shadows 关键字。~~

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:35:39.983

你应该确保它是公共财产

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:39:21.627

> **公共可重写**属性 Text() As String
> 
> ```
> Get
>     Return ControlText.Text
> End Get
> Set(ByVal value As String)
>     ControlText.Text = value
> End Set End Property 
> ```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:56:23.567

这可能是一个愚蠢的问题，但仍然需要询问其中一些问题以确保：

自从您进行更改后，您是否*编译过？*使用 Visual Studio 中的热键，按下`[Ctrl]+[Shift]+[b]`以编译整个解决方案。

# c# - Bulls & Cows C# 实现（Mastermind 变体）

> ID：782973
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T18:34:28.020
> 
>         
> 
> 标签：c#, artificial-intelligence

Bulls & Cows 是一款由两个玩家组成的游戏，其中每个玩家都有一个包含 4 个不重复数字的秘密数字，每个人都尝试猜测另一个数字。

例如，假设我的密码是 1576。

如果我的对手说数字 1234，我会回答：1F，因为数字 1 在我的密码中并且在相同的位置。如果我的对手说数字 7890，我会回答：1P，因为数字 7 在我的密码中并且在不同的位置。等等。
[这里](http://en.wikipedia.org/wiki/Bulls_and_Cows)解释一下。

嗯，作为一个爱好，我想实现一个电脑播放器，试图猜我的号码，但我不知道从哪里开始，

*   有任何想法吗？

*   这个游戏有什么已经做的吗？

*   有没有 C# 实现？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T18:37:39.743

这是游戏[Mastermind](http://en.wikipedia.org/wiki/Mastermind_(board_game)#Algorithms)的变体。在猜测解决方案的算法上已经做了很多工作。除了维基百科链接上显示的内容之外，一些使用“mastermind”作为关键字的谷歌搜索可能会出现很多。（我假设你到目前为止还没有找到太多，因为你不知道那个名字）。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T18:38:48.853

[这听起来像是游戏“Mastermind”的变体——这里](http://richardbowles.tripod.com/durham/ai/mastermind/mastermind.html)和[这里](http://ece.uprm.edu/~s016965/ICOM%205015%20-%20Artificial%20Intelligence/Mastermind%20Report.doc)(.doc) 以及[Wikipedia 页面](http://en.wikipedia.org/wiki/Mastermind_(board_game)#Algorithms)上都有一些资源。

玩得开心！

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:37:30.353

听起来像是 MasterMind 的变种。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:39:19.163

您正在玩棋盘游戏“Mastermind”的变体。请参阅维基百科文章的算法部分：

[`http://en.wikipedia.org/wiki/Mastermind_(board_game)`](http://en.wikipedia.org/wiki/Mastermind_(board_game))

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T23:12:36.290

这是一款 linux 风格的游戏，我很确定您可以获取它的源代码并将其移植到 C#

[http://sourceforge.net/project/showfiles.php?group_id=182681&package_id=211908](http://sourceforge.net/project/showfiles.php?group_id=182681&package_id=211908)

玩得开心..

# javascript - BugHunt - Javascript 解析错误？

> ID：782977
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-23T18:36:06.237
> 
>         
> 
> 标签：javascript, parsing, integer

网络人民！

也许你们中的某个人会发现以下函数中的错误：它是一个用于文本框客户端 onblur 事件的 javascript 函数，用于验证输入的文本是否代表格式正确且有效的日期。

我尝试了几次，它工作，但它似乎！应该尝试所有日期！

它适用于所有有效组合，但它似乎无法解析总是解析为 0 的“08”和“09”。我在 IE 和 Firefox 中都试过了，结果是一样的，而 FF 的 javascript 控制台没有查找代码中的任何语法错误。

有人想尝试并智取我吗？我在代码中留下了警报，以在关键点检查我的变量的值，在我看来一切都很好，直到解析，如果我有 08 或 09，在日或月部分......

使用的函数如下。

```
function DateVal(controle, culture, bToday)
{
    //var strDate = controle.value;
    var separateur = '';
    var dayPart = '';
    var monthPart = '';
    var yearPart = '';
    var tblParts;
    var isBisexuel = false;
    var valid = true;

    //alert('DateVal : Controle: ' + controle + 'Controle.value.length: ' + controle.value.length +  ' value: ' + controle.value  + ' culture: ' + culture);
    if (controle.value.length == 10)

    {
        if (culture == 'en-US') 
        {// Il s'agit d'un format de date avec séparateur "/", MM/dd/yyyy
            separateur = '/';
            dayPart = 1;
            monthPart = 0;
            yearPart = 2;
        }
        else if (culture == 'en-GB')
        {// Il s'agit d'un format de date avec séparateur "/", dd/MM/yyyy
            separateur = '/';
            dayPart = 0;
            monthPart = 1;
            yearPart = 2;
        }
        else if (culture == 'fr-CA')
        {// Il s'agit d'un format de date avec séparateur "-", yyyy-MM-dd
            separateur = '-';
            dayPart = 2;
            monthPart = 1;
            yearPart = 0;
        }
        else
        {
            valid = false;
            alert('Le contrôle est mal initialisé (pas de culture ou culture invalide); il n\'y a rien qui va marcher...');
            //window.event.returnValue =false;
        }
    }
    else
    {
        alert('longueur pas valide');

        valid = false;
    }
    if (valid == true)
    {
        alert('valeur: ' + controle.value + ' separateur: ' + separateur);
        tblParts = controle.value.split(separateur);
        alert('yavant parse: dayPart: ' + tblParts[dayPart] + 'monthPart: ' + tblParts[monthPart] +  ' yearPart: ' + tblParts[yearPart]);
        if (tblParts.length == 3)
        {
            dayPart = parseInt(tblParts[dayPart]);
            monthPart = parseInt(tblParts[monthPart]);
            yearPart = parseInt(tblParts[yearPart]);

            alert('après parse: pos0: ' + dayPart + 'pos1: ' + monthPart +  ' pos2: ' + yearPart);

            if (isNaN(dayPart) || isNaN(monthPart) || isNaN(yearPart))
            {
                //alert(dayPart + ' ' + monthPart + ' ' + yearPart);
                valid = false;
            }
            else
            {
                isBisexuel = ((yearPart % 400 == 0) || (yearPart % 4 == 0 && yearPart % 100 != 0));
                alert(isBisexuel);
                if (isBisexuel)
                {
                    tblDays = [0, 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
                }
                else
                {
                    tblDays = [0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
                }

                if (monthPart <= 12 && monthPart > 0)
                {
                    if (dayPart > tblDays[monthPart] || dayPart < 1)
                    {
                        alert('le jour fitte pas');
                        valid = false;
                    }
                }
                else
                {
                    alert('mois égal à 0 ou moins, ou supérieur à 12');
                    valid = false;
                }
            }
        }
        else
        {
            alert('le split donne pas 3 morceaux?');
            valid = false;
        }
    }
    //window.event.returnValue = valid;
    if(valid)
    {
        return;
    }
    else
    {
        if (bToday == true)
        {
            var dt = new Date();
            dayPart = dt.getDate();
            if (dayPart.toString().length == 1)
                dayPart = '0'+dayPart;
            monthPart = dt.getMonth();
            if (monthPart.toString().length == 1)
                monthPart = '0'+monthPart;
            yearPart = dt.getFullYear();
            //alert(dayPart + ' ' + monthPart + ' ' + yearPart + ' ' + culture);
            switch (culture)
            {
                case 'fr-CA':
                    controle.value = yearPart + separateur + monthPart + separateur + dayPart;
                    break;
                case 'en-US':
                    controle.value = monthPart + separateur + dayPart + separateur + yearPart;
                    break;
                case 'en-GB':
                    controle.value = dayPart + separateur + monthPart + separateur + yearPart;
                    break;
            }
            //alert(controle.value);
        }
        else
        {
            controle.value = '';
        }
    }
} 
```

感谢大家的努力！帕斯卡

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-23T18:39:56.150

您需要将[基数参数](http://www.w3schools.com/jsref/jsref_parseInt.asp)提供为 10，否则以 0 开头的值将被解析为八进制。例如：

```
dayPart = parseInt(tblParts[dayPart], 10); 
```

# wpf - 将复选框列表绑定到选中值列表的最简单方法是什么

> ID：782980
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-04-23T18:36:43.647
> 
>         
> 
> 标签：wpf, binding

我有一个`AvailableItems`要显示为复选框列表的列表，以便用户可以选择要生成的项目，然后将其存储在另一个名为`ItemsToGenerate`的列表中（我的列表实际上只是字符串列表）。

用相应的复选框显示所有可用项目很容易：

```
<ItemsControl ItemsSource="{Binding Path=AvailableItems}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <CheckBox Content="{Binding}" />
        </DataTemplate>
    </ItemsControl.ItemTemplate>    
</ItemsControl> 
```

`ItemsToGenerate`但是现在我需要将每个 Checkbox.IsChecked 属性绑定到该项目在列表中的事实。我想过做一个`ListContainmentToBoolConverter`这样的：

```
IsChecked="{Binding Path=ItemsToGenerate, 
            Converter={StaticResource ListContainmentToBoolConverter}}" 
```

但这不起作用，因为我缺少 a`ConverterParameter`来传递每个项目的值，但我不能这样做，因为`ConverterParameter`不支持绑定。

有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-04-24T17:03:35.810

我找到了解决我的问题的方法。

我已将 my 更改`ItemsControl`为，并使用[此处](http://blog.functionalfun.net/2009/02/how-to-databind-to-selecteditems.html)`ListBox`描述的技术在 SelectedItems 与我的`ItemsToGenerate`集合之间添加了绑定。它基本上允许我将任何自定义集合同步到使用简单的附加属性。`ListBox.SelectedItems`

```
<ListBox ItemsSource="{Binding AvailableItems}"
         Behaviors:MultiSelectorBehaviours.SynchronizedSelectedItems=
             "{Binding ItemsToGenerate}"
         SelectionMode="Multiple"
         Background="{x:Null}">  
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <WrapPanel />                    
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <CheckBox Content="{Binding}"
                      Margin="3"
                      IsChecked="{Binding RelativeSource=
                           {RelativeSource Mode=FindAncestor,
                            AncestorType={x:Type ListBoxItem}},
                           Path=IsSelected}" />
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ListBox> 
```

通过添加一个数据模板将每个更改`ListBoxItem`为一个复选框并将每个绑定`Checkbox.IsChecked`到`ListBoxItem.IsSelected`.

我的应用程序的很多地方都有这种模式，这对我来说是理想的解决方案，因为现在我只需要指定一个附加属性，其余的都由数据绑定处理，我不需要任何额外的代码。

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2009-04-23T18:57:20.990

老实说，我会创建一个对象列表，其中包含字符串和一个布尔值，指示它是否被检查。

使用一点 Linq，您可以生成对象列表并将其绑定到 itemSource，而不是绑定字符串列表。

最后会更简单，特别是如果允许用户选中/取消选中复选框，您实际上需要更新某些内容。

== 更新 ==

作为对评论的回答，我对此的看法是因为我不确定我是否理解实际的问题：假设我们有完整的列表（AvailableItems）和选定项目的列表（ItemsToGenerate）：

```
public class ItemEntry
{
  public string Name { get; set; }
  public bool IsSelected {get; set; }
} 
```

...

```
_Items = from item in AvailableItems
            select new ItemEntry() { 
                    Name = item, 
                    IsSelected = ItemsToGenerate.contains(item)
                  }).ToList(); 
```

然后，您可以通过将 _Items 公开为名为 Items 的属性来绑定您的列表：

```
<ItemsControl ItemsSource="{Binding Path=Items}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <CheckBox Content="{Binding Name}" IsChecked="{Binding IsSelected}" />
        </DataTemplate>
    </ItemsControl.ItemTemplate>    
</ItemsControl> 
```

如果需要，您可以稍后从 IsSelected 为 true 的 _Items 中选择以获取所选项目。

此外，如果 ItemsToGenerate 可以变大，您应该创建一个值的 HashSet 并在查询中使用它，如果需要，它应该会更快。

# php - 在 Drupal 中自定义 WebForm 模块

> ID：782987
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-23T18:37:35.143
> 
>         
> 
> 标签：php, content-management-system, drupal-6, module, richtext

我也是 Drupal 6.10 CMS 和 PHP 的新手。我正在使用 drupal 创建我的网站，我发现了一个名为[Webform](http://drupal.org/project/webform)的模块  ，我喜欢它，创建具有不同类型字段和文件上传的表单非常容易。我不知道的一件事是如何在所有字段之前添加富文本。类似于表格介绍之类的东西。该模块具有“描述”字段，它将文本显示为纯文本，但其中没有富文本。

我可以用什么来实现这一点。是否可以在那里对 html 进行硬编码，或者是否有任何其他模块可以允许这样做？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-04-24T16:05:49.663

“描述”字段的值通过[_webform_filter_descriptions()](http://cvs.drupal.org/viewvc.py/drupal/contributions/modules/webform/webform.module?annotate=1.124.2.95#l2170)传递。这个函数有一个`$strict`参数，默认为`TRUE`，它决定描述是否通过[filter_xss()](http://api.drupal.org/api/function/filter_xss/6)过滤。`filter_xss()`允许一些html：

> 'a'、'em'、'strong'、'cite'、'code'、'ul'、'ol'、'li'、'dl'、'dt'、'dd'

因此您可以将“富文本”html 限制为这些元素，或者修改 _webform_filter_descriptions()，设置`$strict`为`FALSE`. 如果您是后者，请注意安全隐患（有权创建网络表单描述的用户可能会输入恶意 html - 这就是 filter_xss() 所保护的内容）。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-08-11T20:47:35.330

我认为您需要做的就是将“输入格式”设置为“完整 html”，然后您可以使用任何您想要设置文本样式的 HTML/CSS 标签。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-11-17T00:14:47.707

您可以通过在创建新字段时从下拉选项中创建**表单组件**“**标记”来实现此目的。**

从这部分开始，您可以根据需要在此框中放置**html 和 php 。**

您还可以选择输入格式以更好地控制您希望如何使用此元素。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2010-03-19T00:47:56.613

正如OP所说，“确认”框与所见即所得编辑器工具栏一起显示，但“描述”框没有。

处理此问题的最简单方法是在“描述”框中手动编写所需的 HTML。虽然它没有说你可以做到这一点，但你可以，而且它有效。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2011-09-23T16:53:39.210

这是我写的关于让自定义代码与 Webform 一起运行的简短方法。它详细介绍了编写自定义模块、复制 Webform 模板以匹配 nodeID 以及添加自定义 javascript/jquery 以进行表单处理。

[http://docs.quantact.com/drupal-webform-custom-php-code](http://docs.quantact.com/drupal-webform-custom-php-code)

# vb.net - 使用 .net 2.0 连接到 FTP 服务器

> ID：782992
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-23T18:38:30.880
> 
>         
> 
> 标签：vb.net, open-source, .net-2.0, ftp

我希望连接到现有的 FTP 服务器，上传文件，等待服务器生成报告，然后将该报告下载回 VB.NET 2.0 WinForms 项目中的本地计算机。

是否有现有的 FTP 库对我有帮助？我的任务似乎很简单，以至于我宁愿不进入主动与被动、套接字等的世界。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T18:41:52.107

查看 System.Net。[FtpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest(loband).aspx) / [FtpWebResonse](http://msdn.microsoft.com/en-us/library/system.net.ftpwebresponse(loband).aspx)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T18:41:16.427

您需要使用[FtpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T18:42:26.177

System.Net.FtpWebRequest 和 System.Net.WebClient 都可以做到这一点。

WebClient 更简单，但支持的功能更少。我还没有遇到很多 FtpWebRequest 无法处理的情况。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-04-23T18:42:27.690

你试过 FtpWebRequest 类吗

*   [http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.aspx](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.aspx)~~*`********* 
```