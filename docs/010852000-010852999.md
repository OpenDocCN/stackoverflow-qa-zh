# StackOverflow 问答 10852000-10852999

# json - 如何将自定义类加载器添加到 ObjectMapper？

> ID：10852004
> 
> 赞同：2
> 
> 时间：2012-06-01T14:19:54.780
> 
> 标签：json, classloader, jackson

有没有办法指示 Jackson 2 ObjectMapper 使用自定义 Classloader 反序列化 JSON 字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-07-29T10:33:45.233

这是解决方案：

```
ClassLoader myClassLoader = ...        

ObjectMapper om = new ObjectMapper();
TypeFactory tf = TypeFactory.defaultInstance()
                            .withClassLoader(myClassLoader);
om.setTypeFactory(tf); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:44:47.747

查看 Jackson Wiki for [Modules](http://wiki.fasterxml.com/JacksonFeatureModules)，杰克逊模块可用于创建自定义序列化/反序列化。虽然 wiki 谈论他们可以做什么

> 添加自定义序列化器和反序列化器
> 
> 添加混合注释
> 
> 覆盖或添加 AnnotationIntrospector
> 
> 访问 SerializationConfig 和 DeserializationConfig 设置。

它的细节很简单，只是举一个非常基本的例子。[Module JavaDoc](http://fasterxml.github.com/jackson-databind/javadoc/2.0.0/com/fasterxml/jackson/databind/Module.html)也很注重细节。幸运的是，该 wiki 还在GitHub 上提供[了现有 Jackson 模块的列表，](http://wiki.fasterxml.com/JacksonModuleProjects)如果您需要从头开始创建自己的模块，作为示例会更有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-17T21:07:58.807

为了保留现有的`TypeMapper`，您可能想要做这样的事情（这是 Scala，但在 Java 中也可以使用相同的模式），您可以在其中调整当前的类型工厂。

```
 def updateClassLoader(cl: ClassLoader): Unit = {
    objectMapper.setTypeFactory(objectMapper.getTypeFactory.withClassLoader(cl))
  } 
```

这将从可能的先前配置调用中保留缓存的类型数据，如下所示：

```
mapper.registerModule(new Jdk8Module)
      .registerModule(new JavaTimeModule)
      .registerModule(new DefaultScalaModule) 
```

# r - R 分布式集群包

> ID：10852012
> 
> 赞同：1
> 
> 时间：2012-06-01T14:20:20.247
> 
> 标签：r

是否有任何现有的 R 集群包（kmeans，分层）利用 RHadoop 或 RHIPE 在分布式 hadoop 集群上运行？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T23:49:06.900

[RHadoop 项目包的RevolutionAnalytics / RHadoop](https://github.com/RevolutionAnalytics/RHadoop/wiki)实现通过 rhdfs、rhbase 和 rmr 连接 Hadoop 和 R。

我知道，与仅使用 R（使用 rmr 包，如幻灯片 14-15 所示）相比，以“标准”方式实现 K-means 聚类算法（使用 Python、Pig 和 Java，如幻灯片 8-10 所示）：它需要更少的代码，并且可以用一种语言实现

在同一文档中，有一个[K-means 在 Python、Java 和 R 中的比较实现，](https://github.com/RevolutionAnalytics/RHadoop/wiki/Comparison-of-high-level-languages-for-mapreduce%3a-k-means)显示了使用 R 是多么容易。

如果你在你的 Hadoop 集群上运行这个包，你肯定可以在 Hadoop 上编写 K-means 集群。

如果 R 不是您的选择，那么 K-means 集群（使用 MapReduce 构建）可在 Hadoop 和 Mahout 上使用，因此您肯定可以在 Hadoop 集群上进行。

# css - 不会删除 IE hack 的在线 CSS 压缩

> ID：10852013
> 
> 赞同：2
> 
> 时间：2012-06-01T14:20:23.313
> 
> 标签：css, compression

是否有在线 CSS 压缩器不会删除任何 CSS 浏览器黑客。

例如：使用：[cleancss.com](http://www.cleancss.com/)，我设置的选项没有区别，它总是会删除`*display`for IE display inline-block hack。

```
a {
    border-radius:5px
    display: inline-block;
    *display: inline;
    zoom: 1;
    text-shadow: 0 2px 3px rgba(0,0,0,0.4);
    -moz-border-radius:5px;-webkit-border-radius:5px;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T05:07:44.713

[CSS Compressor](http://www.csscompressor.com/)和[Clean CSS](http://www.cleancss.com/)通常对我有用，尽管我更喜欢为所有早期版本的 Internet Explorer 使用不同的样式表。通常最好让以前的浏览器单独支持 css。或者将 hacks 保存在一个单独的文件中并将其附加到压缩的 css 中。

但是，在您的情况下，压缩机确实会移除`*`

我不知道任何保留黑客攻击的在线压缩器，但是，我可以提供解决方法。

一个解决方案是在选择器而不是属性上使用黑客。这里有几个例子：

```
* html #uno  { color: red } /*IE6 and below*/
*+html #dos { color: red }  /*IE7*/ 
```

在此处查看其他可用的黑客攻击：http: [//paulirish.com/2009/browser-specific-css-hacks/](http://paulirish.com/2009/browser-specific-css-hacks/)

如果这对您不起作用，则另一种解决方法可能会有点烦人，但是在压缩之前，请在 hack 之前添加一些独特的值，例如

```
#uno {#HACK#display:inline;} 
```

然后使用文本编辑器压缩后全部替换`#HACK#`为`*`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T09:48:04.270

这个使用你的测试代码对我有用 - [http://www.cssdrive.com/index.php/main/csscompressor](http://www.cssdrive.com/index.php/main/csscompressor)

就像 - [http://iceyboard.no-ip.org/projects/css_compressor](http://iceyboard.no-ip.org/projects/css_compressor)，[http://www.refresh-sf.com/yui/](http://www.refresh-sf.com/yui/)和[http://tools.arantius.com/css-compressor](http://tools.arantius.com/css-compressor)

在您将问题实际发布到此处之前，可能值得在谷歌上搜索您的问题。我搜索了“css 压缩器”，打开了前 6 个结果，发现这四个结果都压缩了你的代码，而没有删除任何 hack。

stackoverflow 不应该被用来问一些你懒得自己搜索的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T15:03:39.790

这~~四个~~五个在线缩小器中的任何一个都以您满意的方式完成工作

*   [http://www.creativyst.com/Prod/3/](http://www.creativyst.com/Prod/3/)
*   [http://www.cssdrive.com/compressor/compress.php](http://www.cssdrive.com/compressor/compress.php)
*   [http://iceyboard.no-ip.org/projects/css_compressor](http://iceyboard.no-ip.org/projects/css_compressor)
*   [http://tools.arantius.com/css-compressor](http://tools.arantius.com/css-compressor)
*   [http://www.cssdrive.com/index.php/main/csscompressor/](http://www.cssdrive.com/index.php/main/csscompressor/)（[感谢@JFK](https://stackoverflow.com/users/1055987/jfk)）

还有一个智能工具（由俄罗斯 Yandex 开发和使用）具有**在线**和**后端**版本

*   [http://css.github.com/csso/csso.html](http://css.github.com/csso/csso.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-29T13:50:35.587

试试基于 CSSTidy 的[Devilo.us 。](http://devilo.us)您可以准确选择压缩的程度和方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-09T15:40:24.083

[http://css.github.com/csso/csso.html——](http://css.github.com/csso/csso.html)这个对我有用。它不仅可以修剪未使用的符号，还可以删除重复的规则，如果在帮助中缩小尺寸，还可以使用组选择器。

它是以下工具的在线版本：[https ://github.com/css/csso](https://github.com/css/csso)

# c# - 日期时间格式 yyyymm

> ID：10852017
> 
> 赞同：2
> 
> 时间：2012-06-01T14:20:34.050
> 
> 标签：c#, linq

我找到了你能想到的每一种 DateTime 格式，除了我需要的一种：yyyymm。我该如何得到这个？

我正在使用以下代码：

```
List <string> routines = new List<string>();
routines.Add("1 - Routine");
routines.Add("6 - Planned Outage");

int year = 2011;
int quarter = 1;

DateTime timeframe = new DateTime(year, (quarter * 3), 01).AddMonths(1); 

var results =

    (from wo in WORKORDERs

        join wot in WORKORDERTYPEs on wo.Wot_oi equals wot.Wotyoi

        join pri in PRIORITies on wo.Prio_oi equals pri.Priooi

        join s in SITEs on wo.BEparn_oi equals s.Siteoi

    where wo.Audt_created_dttm.Value.Year >= year - 3 && wo.Audt_created_dttm.Value.Year >= 2006
        && wo.Audt_created_dttm < timeframe && (s.Id =="NM" || s.Id == "TH") && 
        !wot.Id.Contains("stand") &&  !(wo.Ci_cnc_date != null && pri.Prioid != "1 - Routine" &&
        pri.Prioid != "6 - Planned Outage") && (SqlMethods.Like(pri.Prioid, "1%") || 
        SqlMethods.Like(pri.Prioid, "2%") || SqlMethods.Like(pri.Prioid, "3%"))     

    select new {PM = wo.Wosource, Site = s.Id, Priority = pri.Prioid, Worktype = wot.Id,
        WoNumber = wo.Id, Description = wo.Aenm, CreateDate = wo.Audt_created_dttm,
        CloseDate = wo.Clsdt_date,
        MonthNum = String.Format("{0:yyyy mm}",  wo.Clsdt_date), 
        Planning = routines.Contains(pri.Prioid) ? "Planned" : "Unplanned"}); 
```

我尝试使用：

```
MonthNum = String.Format("{0:yyyy mm}",  wo.Clsdt_date) 
```

这给了我正确的年份，但月份都是 00。我猜这是因为 wo.Clsdt_date 的格式与我的字符串格式不同（它是 mm/dd/yyyy）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-01T14:21:22.697

你需要`MM`，不是`mm`。`mm`是分钟。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T14:23:24.520

“mm”代表分钟，“MM”代表月份，但月份有 2 位数字。因此，在 2012 年 6 月，您将获得 201206，但是如果您只需要一位数的月份，您可以使用一个“M”而不是“yyyyM”，您将获得 20126

```
DateTime.Now.ToString("yyyyMM") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T14:21:32.960

在日期格式中，`mm`表示分钟，而不是月份。改为使用`MM`。

# javascript - 动态设置事件监听器应该调用的函数

> ID：10852019
> 
> 赞同：1
> 
> 时间：2012-06-01T14:20:40.520
> 
> 标签：javascript, eval

我有一组简单的选项，它们基本上决定了哪些按钮应该在任何时候通过 Web 应用程序可见。

所以对于家庭来说，数组看起来像：第 1 步

```
if (view === "home") {
  visibleCommands = [];
  visibleCommands[0] = "contact";
  visibleCommands[1] = "about";
}
setVisibility(visibleCommands); 
```

然后我遍历数组：步骤 2

```
setVisibility(visibleCommands) {
  var i;
  for (i in visibleCommands) {
    document.getElementById(visibleCommands[i].style.display = "inline";
  }
  addEvents(visibleCommands);
} 
```

最后，对于可见命令，我想添加单独的事件侦听器：步骤 3

```
addEvents(visibleCommands) {
  var i;
  for (i in visibleCommands) {
    document.getElementById(visibleCommands[i]).addEventListener("click", visibleCommands[i], false);  
  }
} 
```

但是，如果我将此行更改为：

```
document.getElementById(visibleCommands[i]).addEventListener("click", contact, false); 
```

然后它正确地连接到元素并调用 contact() 函数。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:23:48.043

你的代码：

```
document.getElementById(visibleCommands[i]).addEventListener("click", visibleCommands[i], false); 
```

`visibleCommands[i]`是**id**：

```
document.getElementById(visibleCommands[i]) 
```

`visibleCommands[i]`是**点击回调**：

```
.addEventListener("click", visibleCommands[i], false); 
```

怎么可能？

`"contact"`并且`contact`是两个不同的东西。第一个是带`contact`值的字符串，第二个是对函数的引用

* * *

另一件事：

```
document.getElementById(visibleCommands[i].style.display = "inline"; 
```

函数调用`)`中缺少：`getElementById`

```
document.getElementById(visibleCommands[i]).style.display = "inline"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:25:44.283

你在哪里绑定处理程序？

```
document.getElementById(visibleCommands[i]).addEventListener("click", visibleCommands[i], false); 
```

上一行中的第二个参数是一个不正确的字符串。它应该是处理函数。

试试下面的东西，

```
document.getElementById(visibleCommands[i]).addEventListener("click", function () {
   alert('Clicked');
}, false); 
```

您可以阅读有关[addEventListener](https://developer.mozilla.org/en/DOM/element.addEventListener)

还要使用`.push`正确的方法将元素添加到数组中。见下文，

```
visibleCommands.push("contact");
visibleCommands.push("about"); 
```

# visual-studio-2010 - Resharper/Nunit 的 Visual Studio 调试问题

> ID：10852020
> 
> 赞同：9
> 
> 时间：2012-06-01T14:20:41.573
> 
> 标签：visual-studio-2010, debugging, nunit, resharper

我在 Visual Studio 中遇到了一个非常令人沮丧的问题。我正在使用 Resharper，并在 Nunit 中编写测试。

如果我设置了一个断点，它确实会被命中，但是 Step In/Over 和 Continue 不起作用，并且测试永远不会完成。即使我设置了两个破发点，继续也不会打到第二个。如果我在没有断点的情况下调试测试，它会很好地完成。

此外，经常间歇性地，当我尝试通过设置断点来调试测试时，我无法评估变量的内容，而是看到以下消息：

`Function evaluation disabled because a previous function evaluation timed out. You must continue execution to reenable function evaluation.`

我正在使用 Visual Studio 2010。

如果您对要查看的内容有任何想法，请告诉我...我已经搜索了网络，但没有任何运气。

如果需要，很乐意提供更多信息。

**编辑 - 方法示例**

*测试：*

```
[Test]
public void OneRowAddedToSourceData() {
    //Factory just returns System.Data.DataTable with correct columns.
    var sourceData = new DataTableContainerFactory().GetTargetTableContainer(DataTypeNames.EventSharedEnd);

    //GetRow just returns a populated row.
    var row = GetRow(sourceData, 123456, 123,60, 31);

    sourceData.DataTable.Rows.Add(row);
    Assert.AreEqual(1, sourceData.DataTable.Rows.Count);
} 
```

当我在 Assert 语句上设置断点并尝试评估数据表时，我遇到了这个问题。

**更新 2！** 因此，我已将这个问题缩小到 Resharper 调试。我将测试类更改为 MSTest 而不是 NUnit，但在使用 Resharper 进行调试时仍然遇到上述问题。但是，当我使用内置的 VS MSTest 测试运行器运行测试时，所有问题都消失了！

现在我更喜欢使用 NUnit 和 Resharper，所以如果有人能指出一个允许 Resharper 正确调试的设置，我会非常高兴！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-04T15:14:17.437

我有一个可能的解决方案，尽管有一个警告。做了一些搜索并浏览了[这个博客项目](http://blogs.msdn.com/b/greggm/archive/2005/11/18/494648.aspx)。它建议`Enable property evaluation and other implicit function calls`从`Tools->Options->Debugging->General`. 我把它关掉了，我现在可以进入以前导致这个问题的项目。

需要注意的是，您习惯于自动评估的所有属性现在都不会显示。相反，它声明`Implicit function evaluation is turned off by user.`所有你需要做的就是点击属性上的刷新按钮，你可以看到值，但我还没有决定这是否是我愿意做出的权衡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-14T13:37:27.960

我找到了解决这个问题的方法！

选中选项**DEBUG->OPTIONS AND SETTINGS->GENERAL->ENABLE PROPERTY EVALUATION AND OTHER IMPLICIT FUNCTION CALLS**并取消选中**Call string-conversion function on objects in variable windows**

这对我有用！

# c# - LINQ - 将组转换为数组

> ID：10852023
> 
> 赞同：1
> 
> 时间：2012-06-01T14:20:51.193
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, linq

我在视图中显示数据库中最流行的标签时遇到问题。我不确定这个问题的标题，所以如果有人有更好的标题，请重命名。

## 设想

我需要在我的索引页面上显示最近的帖子、最近的画廊和最受欢迎的标签。我决定为此使用元组，它工作得很好，直到我尝试显示最流行的标签。

## 错误

> 传入字典的模型项的类型为“System.Tuple `3[photoBlog.Models.Gallery[],photoBlog.Models.Post[],System.Linq.IGrouping`2[System.Int32,photoBlog.Models.PostTag][]]”，但此字典需要类型为“System.Tuple`3[photoBlog.Models”的模型项.Gallery[],photoBlog.Models.Post[],photoBlog.Models.PostTag[]]'。

如您所见，它给了我错误的对象类型。我希望它是一个数组，但它给了我一些`System.Linq.Grouping`东西。

## 代码

如您所见，我将其转换为控制器中的数组。

```
public ActionResult Index()
{
    photoBlogModelDataContext _db = new photoBlogModelDataContext();
    var posts = _db.Posts.OrderByDescending(x => x.DateTime).Take(4).ToArray();
    var galleries = _db.Galleries.OrderByDescending(x => x.ID).Take(4).ToArray();
    var posttags = _db.PostTags.GroupBy(x => x.TagID).OrderBy(x => x.Count()).Take(4).ToArray();
    return View(Tuple.Create(galleries, posts, posttags));
} 
```

我的观点是直截了当的，请注意，在我尝试添加最流行的标签之前，这确实有效。

```
@model Tuple<photoBlog.Models.Gallery[], photoBlog.Models.Post[], photoBlog.Models.PostTag[]>
@foreach (var tag in Model.Item3)
{ 
    @tag.Tag.Name
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T14:28:07.547

你可能想要

```
var posttags = _db.PostTags
    .GroupBy(x => x.TagID)
    .OrderBy(x => x.Count())
    // Take each group and pass the first tag of the group
    .Select(g => g.First())
    .Take(4)
    .ToArray(); 
```

目前，您正在传递例如最流行标签的所有 8 个实例、第二流行标签的所有 5 个实例等，每个实例都在他们自己的组中。我想您只想传递每个标签的“示例”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T14:28:48.620

我并不是要完全回避选角问题，但是稍微简化一下如何：

```
public class PopularStatsViewModel{
  public Gallery[] Galleries { get; set; }
  public Post[] Posts { get; set; }
  public PostTags[] Tags { get; set; }
} 
```

新建一个 PopularStats 实例并将属性设置为您的数据库调用的结果。那么在你看来：

```
@model photoblog.Models.PopularStatsViewModel 
```

当然，这可以帮助您解决强制转换问题，但更重要的是，它使测试变得更容易，让您在重构/扩展该 stats 对象时更加自由，并且很清楚您在视图上使用的内容是什么时候您正在访问 VM 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T14:28:06.093

尝试更改`photoBlog.Models.PostTag[]`为`IGrouping<TagIDType, photoBlog.Models.PostTag>[]`

# vb.net - 具有度数方向的 LinearGradientBrush

> ID：10852025
> 
> 赞同：1
> 
> 时间：2012-06-01T14:20:53.753
> 
> 标签：vb.net, winforms, graphics

我想使用 LinearGradientBrush 绘制带有渐变的表单背景；但我在使用学位时遇到了麻烦。

基本上，我想在对角线上使用线性渐变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:26:28.293

有一个参数：

```
Protected Overrides Sub OnPaint(ByVal e As PaintEventArgs)
  Using br As New LinearGradientBrush(Me.ClientRectangle, _
                                      Color.LightBlue, Color.DarkBlue, _
                                      LinearGradientMode.ForwardDiagonal)
    e.Graphics.FillRectangle(br, Me.ClientRectangle)
  End Using

  MyBase.OnPaint(e)
End Sub 
```

可用的枚举`LinearGradientMode`有：

```
BackwardDiagonal
ForwardDiagonal
Horizontal
Vertical 
```

# php - 从子类php和父关键字访问父变量？

> ID：10852028
> 
> 赞同：8
> 
> 时间：2012-06-01T14:21:13.437
> 
> 标签：php, oop, class, object, parent-child

我有一个父类和一个子类，父类有一个设置 a 的构造函数，`var`我想`var`在子类中使用它，我让它工作但对关键字感到困惑`parent`？

例子

```
 class Sub extends Parent {
     public function foo() {
         echo $this -> myVar;
     }
 }

 class Parent {
     var $myVar;
     public function __construct() {
          $this -> myVar = 'a';
     }
 } 
```

这行得通，我得到了 的值`myVar`，但是我应该使用关键字`parent`吗？当我这样做时，我得到一个错误，例如，

```
 class Sub extends Parent {
     public function foo() {
         echo parent -> myVar;
     }
 }

 class Parent {
     var $myVar;
     public function __construct() {
          $this -> myVar = 'a';
     }
 } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-01T14:28:09.680

首先，Parent 是一个保留字。其次，`var`除非您使用的是旧版本的 PHP，否则不要使用。您可以使用受保护的。您不需要使用 parent 关键字来访问变量，因为子类应该继承它。您可以通过以下方式访问它`$this->myVar`

编辑*澄清*

只需要`parent::`在访问基类的方法或基类的`static`变量时使用。如果您尝试访问基类的非静态变量，您将收到错误消息`Access to undeclared static property" fatal error:`

这是一个让您入门的示例。

```
<?php
class Animal{
     protected $myVar;
     public function __construct() {
          $this->myVar = 'a';
     }
 }

class Cat extends Animal {
     public function foo() {
         echo $this->myVar;
     }
 }

$cat = new Cat(); 
$cat->foo(); 

?> 
```

[这](http://codepad.org/OgdUkRpC)是此代码的一个工作示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T14:28:58.340

关键字`parent`应仅用于访问父类的方法或**静态**变量，因此您的第一个代码是正确的，因为`$myVar`它不是静态的。

# iphone - 调试 AFNetworking

> ID：10852029
> 
> 赞同：1
> 
> 时间：2012-06-01T14:21:15.747
> 
> 标签：iphone, objective-c, xcode, http, afnetworking

以下代码块用于将图像文件提交到数据库。它已停止工作：即使它打印`SUCCESS`，服务器上也没有可见的图像。关于如何调试的任何建议？

**编辑**

我在调试器中打印了 imageData 并得到了一个内存地址数组，所以我几乎可以肯定我有一个图像。

```
- (void)postActivityImage:(Spot*)localSpot
{
    NSLog(@"%s",__func__);
    NSString *url = [NSString stringWithFormat:@"v1/activity/%@/image", localSpot.uniqueID];
    UIImage *image = [UIImage imageWithContentsOfFile:localSpot.imageLocalURL];
    NSData *imageData = UIImageJPEGRepresentation(image, 0.5f);
    NSURLRequest *request = [httpClient_ multipartFormRequestWithMethod:@"POST"
                                                                   path:url 
                                                             parameters:nil 
                                              constructingBodyWithBlock:^(id<AFMultipartFormData> formData) {
                                                  [formData appendPartWithFileData:imageData 
                                                                              name:@"test" 
                                                                          fileName:@"test" 
                                                                          mimeType:@"image/jpeg"];
                                              }];

    AFJSONRequestOperation *ro;
    ro = [AFJSONRequestOperation JSONRequestOperationWithRequest:request
                                                         success:^(NSURLRequest *request, NSURLResponse *response, id JSON) {
                                                             NSLog(@"success: %@", JSON);
                                                             NSLog(@"SUCCESS - IMAGE POSTED.");
                                                             [self updateSpotSubmitInProgressStatusWithActivityFinished:ImagePost andSuccess:YES];
                                                             [[NSNotificationCenter defaultCenter] postNotificationName:SUBMIT_STATUS object:self userInfo:nil];
                                                             self.spot.imageSubmitted = YES;
                                                         } failure:^(NSURLRequest *request, NSURLResponse *response, NSError *error, id JSON) {
                                                             [self updateSpotSubmitInProgressStatusWithActivityFinished:ImagePost andSuccess:NO];
                                                             NSDictionary *dic = [[NSDictionary alloc] initWithObjectsAndKeys:error, @"Error", nil];
                                                             [[NSNotificationCenter defaultCenter] postNotificationName:SUBMIT_STATUS object:self userInfo:dic];
                                                             NSLog(@"%s   ERROR: %@", __func__, error);
                                                             NSLog(@"%s   RESPONSE: %@",__func__, response);
                                                             NSLog(@"%s   FAIL   json response: %@",__func__, JSON);
                                                         }];

    [httpClient_ enqueueHTTPRequestOperation:ro];
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T14:53:39.397

调试 HTTP 连接时我的首选工具是[Charles](http://www.charlesproxy.com/)。您可以在台式计算机上设置 Charles，将其配置为 iPhone 上的代理，然后查看 iPhone 产生的 HTTP 流量。然后，您可以查看是否正在发出请求，如果是，请深入检查每个请求。

Here are some good instructions for setting up Charles to view iPhone HTTP traffic: [http://blog.mediarain.com/2009/08/iphone-http-connection-debugging/](http://blog.mediarain.com/2009/08/iphone-http-connection-debugging/)

# javascript - 给出淡入淡出效果后显示选项卡的内容

> ID：10852030
> 
> 赞同：0
> 
> 时间：2012-06-01T14:21:16.220
> 
> 标签：javascript, css, prototypejs, scriptaculous

在我的页面中有许多选项卡，我想通过淡化效果来显示选项卡的内容。为了做到这一点，我需要在淡入淡出函数之后具有类名 sectionContent 的选项卡 div 为 style="display:block"。但是，当我从萤火虫中查看它们时，它显示为例如：

```
<div id="lesson-grammar" class="sectionContent" style=""> 
```

因此该选项卡未显示。我怎样才能做到这一点？多谢。

```
new Ajax.Request(ajaxUrl,
  {
     method:'post',
     onSuccess: function(data){         
         var tmp=data.responseText;
         $$('.exercise-main .content').invoke('insert',tmp);
         $$('.exercise-main .sectionContent').invoke('setStyle','display:none');

         $('lesson-'+tab).fade({
             from:0,
             to:1,
             afterFinish: function(){
              //do the job                                     
             }
         });

     }
 });

<div class="exercise-main">
  <div class="content">
    <div id="lesson-discussion" class="sectionContent">  
     ...
    </div>
    <div id="lesson-grammar" class="sectionContent">  
     ...
    </div>
    <div id="lesson-dialogue" class="sectionContent">  
     ...
    </div>
   </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:33:12.523

我相信您的样式声明的语法不正确。试试这个：

```
$$('.exercise-main .sectionContent').invoke('setStyle',{display: "none"}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:50:49.020

让我先从您的代码和解释中了解您的问题。

您想要实现的是在 ajax 响应到达后隐藏所有选项卡，将响应插入新选项卡，然后以淡入淡出的效果显示它？

如果这是您的愿望，那么您可能遇到了选择器问题。您正在使用 $$ 选择器，但一个地方除外：

```
$('lesson-'+tab).fade({... 
```

我认为这是问题所在。您的 firefox/chrome 控制台是否显示任何问题？如果你尝试运行这个怎么办：

```
$('lesson-'+tab) 
```

会发生什么？您是否看到登录到控制台的正确 HTML 元素？

试试这些，然后让我知道结果，我会尽力提供帮助。

# javascript - Mootools 未定义

> ID：10852034
> 
> 赞同：0
> 
> 时间：2012-06-01T14:21:25.350
> 
> 标签：javascript, forms, mootools, firebug

MooTools.More={version:"1.2.4.2",build:"bd5a93c0913cce25917c48cbdacde568e15e02ef"};(function(){var a={language:"en-US",languages:{"en-US":{}},级联：[“en-US”]}；

-->mootools 在 firebug 中没有定义。

我正在联系我们的表单检查器。

```
<script language="javascript" type="text/javascript" src="js/mootools/mootols-1.js">     </script>  
<script language="javascript" type="text/javascript" src="js/mootools/mootools-1.2.4-core-yc.js"></script> 

<script language="javascript" type="text/javascript" src="js/formcheck/lang/en.js"> </script>
<script language="javascript" type="text/javascript" src="js/formcheck/formcheck.js"> </script>

<link rel="stylesheet" href="js/formcheck/theme/blue/formcheck.css" type="text/css" media="screen" />

<script type="text/javascript">
window.addEvent('domready', function(){
    new FormCheck('myform');
}); 
```

```
</head> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:29:17.113

尝试修正第一行中“mootols”的拼写。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-04T04:14:57.597

如果这是您的 mootools 核心：

```
js/mootools/mootools-1.2.4-core-yc.js 
```

那么这是什么？

```
js/mootools/mootools-1.js 
```

会不会是 mootools 更多？您需要先加载核心。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T23:41:21.870

MooTools-More 代码依赖于首先加载的 MooTools-Core 代码。

确保在 MooTools-More 之前加载 MooTools-Core。

# java - 如何将 TomEE 与 Hibernate 一起使用

> ID：10852035
> 
> 赞同：9
> 
> 时间：2012-06-01T14:21:30.433
> 
> 标签：java, hibernate, jpa, openejb, apache-tomee

我创建了具有持久性上下文（作为提供者休眠）的非常简单的应用程序，以从数据库中读取一些值。我将 Eclipse 与 Maven 一起使用。

首先，我得到

```
Caused by: org.apache.openejb.OpenEJBException: java.lang.ClassCastException: org.hibernate.ejb.HibernatePersistence cannot be cast to javax.persistence.spi.PersistenceProvider: 
```

并根据这个主题 [http://openejb.979440.n4.nabble.com/problem-with-hibernate-persistence-provider-td980429.html](http://openejb.979440.n4.nabble.com/problem-with-hibernate-persistence-provider-td980429.html) 我排除了hibernate-jpa-2.0-api。现在，我的依赖项看起来

```
<dependency>
 <groupId>postgresql</groupId>
 <artifactId>postgresql</artifactId>
 <version>9.1-901.jdbc4</version>
</dependency>

<dependency>
 <groupId>org.hibernate</groupId>
 <artifactId>hibernate-entitymanager</artifactId>
 <version>4.1.3.Final</version>
  <exclusions>
    <exclusion>
      <groupId>org.hibernate.javax.persistence</groupId>
      <artifactId>hibernate-jpa-2.0-api</artifactId>
    </exclusion>
  </exclusions>
</dependency> 
```

现在，我不知道为什么...

```
Caused by: java.lang.ClassNotFoundException: org.hibernate.transaction.TransactionManagerLookup 
```

但是 TransactionManagerLookup 在 hibernate-core 中。拜托，谁能告诉我，应该如何查看 pom.xml 在 TomEE 中使用休眠？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-02T18:48:27.010

## 1.将所需的Hibernate .jars复制到`<tomee-home>/lib`

根据文档（[http://tomee.apache.org/tomee-and-hibernate.html](http://tomee.apache.org/tomee-and-hibernate.html)），以下内容就足够了，实际上它们对我有用：

```
<tomee-home>/lib/antlr-2.7.7.jar
<tomee-home>/lib/dom4j-1.6.1.jar
<tomee-home>/lib/hibernate-commons-annotations-4.0.2.Final.jar
<tomee-home>/lib/hibernate-core-4.2.21.Final.jar
<tomee-home>/lib/hibernate-entitymanager-4.2.21.Final.jar
<tomee-home>/lib/hibernate-validator-4.3.2.Final.jar
<tomee-home>/lib/javassist-3.18.1-GA.jar
<tomee-home>/lib/jboss-logging-3.1.0.GA.jar 
```

所有这些`.jars`都包含在 Hibernate ORM 4.2.x 下载 ( [http://hibernate.org/orm/](http://hibernate.org/orm/) ) 中，除了 Hibernate Validator，它是一个单独的下载 ( [http://hibernate.org/validator/](http://hibernate.org/validator/) )。

## 2\. 编辑你的 pom.xml

使用`javaee-api`具有范围的 maven 工件`provided`现在可以在您的项目中使用 JPA 规范。但是，如果你之前一直在使用一些 Hibernate 特定的特性、类或注解，你仍然可以在你的中引用 Hibernate`pom.xml`来匹配这些依赖项：

```
<!-- JPA spec (required) -->
<dependencies>
    <dependency>
    <groupId>org.apache.openejb</groupId>
    <artifactId>javaee-api</artifactId>
    <version>6.0-4</version>
    <scope>provided</scope>
</dependency>
<!-- Hibernate specific features (only if needed) -->
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-entitymanager</artifactId>
    <version>4.2.21.Final</version>
    <scope>provided</scope>
</dependency> 
```

## 3\. 定义你的数据库连接

编辑`<tomee-home>/conf/tomee.xml`：

```
<Resource id="myJtaDatabase" type="DataSource">
    JdbcDriver  com.mysql.jdbc.Driver
    JdbcUrl jdbc:mysql://localhost:3306/my_dbname?autoReconnect=true
    UserName foo
    Password bar
    validationQuery = SELECT 1
    JtaManaged true
</Resource> 
```

您也可以将上述`<Resource>...</Resource>`定义放入`WEB-INF/resources.xml`并随您的应用程序一起发布：

```
<?xml version="1.0" encoding="UTF-8"?>
<resources>
    <!-- Put <Resource> elements here -->
<resources> 
```

## 4\. JTA 数据源

既然您告诉了 TomEE 如何建立连接，请在以下位置定义一个 JTA 数据源`/src/main/java/META-INF/persistence.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0"
    xmlns="http://java.sun.com/xml/ns/persistence"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 
    http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">

    <persistence-unit name="my_persistence_unit">
        <provider>org.hibernate.ejb.HibernatePersistence</provider>
        <jta-data-source>java:openejb/Resource/myJtaDatabase</jta-data-source>
        <properties>
            <property name="hibernate.dialect" value="org.hibernate.dialect.MySQL5InnoDBDialect" />
            <!-- As many hibernate properties as you need, some examples: -->
            <property name="hibernate.show_sql" value="false" />
            <property name="hibernate.format_sql" value="true" />
            <!-- Drop and then re-create the database schema (don't do this in production) -->
            <property name="hibernate.hbm2ddl.auto" value="update" />
        </properties>
    </persistence-unit>
</persistence> 
```

## 5.开始使用JPA

`EntityManager`像这样在 CDI bean 或 EJB 中获取一个：

```
@PersistenceContext(unitName = "my_persistence_unit")
private EntityManager em; 
```

## 最后的笔记

### 休眠版本 4.3+

我正在使用 Hibernate 4.2.21（JPA 2.0，Java EE 6）和 TomEE 1.7.2。任何 TomEE 1.7.x、1.6.x 和 1.5.x 都可以使用。但是，您不能使用 Hibernate 4.3+ (JPA 2.1 / Java EE 7)，因为 TomEE 1.7.x 及以下版本仅支持 Java EE 6。如果您真的想将 Java EE 7 功能与 TomEE 一起使用，这篇博文可能会有所帮助：[http ://rmannibucau.wordpress.com/2013/07/19/little-tip-to-help-you-to-test-javaee-7-in-tomee-with-tomee-maven-plugin/](http://rmannibucau.wordpress.com/2013/07/19/little-tip-to-help-you-to-test-javaee-7-in-tomee-with-tomee-maven-plugin/)

### 汤姆EE 1.5.x

TomEE 1.5.x 已经包含一个`javassist-<version>.jar`，因此您不必复制一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T23:11:12.813

试试这个：

添加：

*   `<tomee-home>/lib/antlr-2.7.7.jar`
*   `<tomee-home>/lib/dom4j-1.6.1.jar`
*   `<tomee-home>/lib/ehcache-core-2.5.1.jar`
*   `<tomee-home>/lib/ehcache-terracotta-2.5.1.jar`
*   `<tomee-home>/lib/hibernate-commons-annotations-4.0.1.Final.jar`
*   `<tomee-home>/lib/hibernate-core-4.1.4.Final.jar`
*   `<tomee-home>/lib/hibernate-ehcache-4.1.4.Final.jar`
*   `<tomee-home>/lib/hibernate-entitymanager-4.1.4.Final.jar`
*   `<tomee-home>/lib/hibernate-validator-4.3.0.Final.jar`
*   `<tomee-home>/lib/jboss-logging-3.1.0.GA.jar`
*   `<tomee-home>/lib/terracotta-toolkit-1.4-runtime-4.1.0.jar`

ehcache jar 可能是可选的，但没有它们就没有尝试过。

删除（可选）：

*   `<tomee-home>/lib/asm-3.2.jar`
*   `<tomee-home>/lib/bval-core-0.4.jar`
*   `<tomee-home>/lib/bval-jsr303-0.4.jar`
*   `<tomee-home>/lib/commons-lang-2.6.jar`
*   `<tomee-home>/lib/openjpa-2.2.0.jar`
*   `<tomee-home>/lib/serp-1.13.1.jar`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-14T01:22:00.030

是的，只需将 hibernate-jpa-2.1-api-1.0.0.Final.jar 放入 TomEE lib 文件夹即可。

# pdf - GhostScript 裁剪的 PDF 在 iOS/Android 上显示不正确

> ID：10852043
> 
> 赞同：1
> 
> 时间：2012-06-01T14:22:01.767
> 
> 标签：pdf, crop, ghostscript

我正在使用以下命令裁剪 PDF：

```
gswin32c -dQUIET -dBATCH -dNOPAUSE -dNOPROMPT -sDEVICE=pdfwrite -dFirstPage=1
-dLastPage=1 -o output.pdf -dDEVICEWIDTHPOINTS=237 -dDEVICEHEIGHTPOINTS=151
-dFIXEDMEDIA -c "<</PageOffset [-64 -396]>> setpagedevice" -f input.pdf 
```

我的意图是裁剪 input.pdf 距上边界 3.4 英寸，距左边界 0.9 英寸（0.9 x 72 = 64），距下边界 5.5 英寸（5.5 x 72 = 396），距右边界 4.3 英寸，一切似乎工作正常，并且在桌面（Adobe、Chrome 浏览器等）上查看时，output.pdf 显示适当裁剪。但是，当在 iOS 或 Android 设备上查看相同的 PDF 时，似乎页面移位已沿着提到的尺寸发生，并且来自未裁剪区域的区域仍然可见。页面大小似乎无法正常工作。

阅读一些在线论坛，我也尝试了以下命令，但似乎没有任何裁剪效果，即使在桌面查看器上也是如此：

```
gswin32c -dQUIET -dBATCH -dNOPAUSE -dNOPROMPT -sDEVICE=pdfwrite -dFirstPa
ge=1 -dLastPage=1 -o outupt.pdf -c "[/CropBox [64 396 237 151] /PAGES pdfmark"
-f input.pdf

gswin32c -sDEVICE=pdfwrite -dFirstPage=1 -dLastPage=1 -o output.pdf -dDEVI
CEWIDTHPOINTS=237 -dDEVICEHEIGHTPOINTS=151 -dFIXEDMEDIA -c "237 151 translate 6
4 396 237 151 rectclip" -f input.pdf 
```

除非这是一个错误，否则非常感谢您提供的任何帮助！

非常感谢，考希克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:41:23.517

这是作为 Ghostscript 错误报告打开的，在那里进行了调查和回答，您可以在以下位置找到详细信息：

[http://bugs.ghostscript.com/show_bug.cgi?id=693081](http://bugs.ghostscript.com/show_bug.cgi?id=693081)

# ruby-on-rails - 未定义的方法`close_connection_after_writing'

> ID：10852047
> 
> 赞同：2
> 
> 时间：2012-06-01T14:22:07.890
> 
> 标签：ruby-on-rails, comet, faye

我在 Rails 3 上使用 Faye 进行多人游戏项目。错误

> `block in close': undefined method`close_connection_after_writing' 为 nil:NilClass (NoMethodError)

```
from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@chats/gems/faye-websocket-0.4.5/lib/faye/websocket/api.rb:89:in `call'
    from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@chats/gems/faye-websocket-0.4.5/lib/faye/websocket/api.rb:89:in `close'
    from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@chats/gems/faye-websocket-0.4.5/lib/faye/websocket.rb:198:in `fail'
    from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@global/gems/thin-1.3.1/lib/thin/connection.rb:155:in `unbind'
    from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@global/gems/eventmachine-0.12.10/lib/eventmachine.rb:1417:in `event_callback'
    from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@global/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run_machine'
    from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@global/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'
    from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@global/gems/thin-1.3.1/lib/thin/backends/base.rb:61:in `start'
    from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@global/gems/thin-1.3.1/lib/thin/server.rb:159:in `start'
    from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@global/gems/rack-1.4.1/lib/rack/handler/thin.rb:13:in `run'
    from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@global/gems/rack-1.4.1/lib/rack/server.rb:265:in `start'
    from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@global/gems/rack-1.4.1/lib/rack/server.rb:137:in `start'
    from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@global/gems/rack-1.4.1/bin/rackup:4:in `<top (required)>'
    from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@chats/bin/rackup:19:in `load'
    from /Users/ostap/.rvm/gems/ruby-1.9.3-p125@chats/bin/rackup:19:in `<main>' 
```

在我的 faye 服务器使用命令启动后

> rackup faye.ru -s Thin -E 生产

我该怎么办这样的错误？是什么原因造成的？我该如何处理？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T08:48:03.253

我在这个页面上找到（它是俄语）[http://habrahabr.ru/sandbox/45416/](http://habrahabr.ru/sandbox/45416/)

将此添加到您的 faye.ru 文件中

Faye::WebSocket.load_adapter('thin')

这使我的解决方案

我希望它有助于感谢您的建议

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:20:08.637

升级faye后我也遇到了这个问题。

要以@tingel2k 的答案为基础，您需要插入以下内容：

```
Faye::WebSocket.load_adapter('thin') 
```

在应用程序启动之前进入`faye.ru`，例如：

```
run Faye::RackAdapter.new(...) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T20:22:38.730

不要`rackup`用来启动 faye
而是使用`thin start -R faye.ru -e production`
这是我的 faye.ru 文件

```
# encoding: utf-8
require 'faye'
require File.expand_path('../config/initializers/faye_token.rb', __FILE__)

Faye::WebSocket.load_adapter('thin')

class ServerAuth
  def incoming(message, callback)
    if message['channel'] !~ %r{^/meta/}
      if message['ext']['auth_token'] != FAYE_TOKEN
        message['error'] = 'Token de autenticacao invalido'
      end
    end
    callback.call(message)
  end
end

bayeux = Faye::RackAdapter.new(:mount => '/faye', :timeout => 25, :extensions => [ServerAuth.new])
run bayeux 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T14:57:27.560

这是 EventMachine 错误。这个方法接收器是一个连接对象，所以我认为这个错误意味着连接以不正确的方式终止或没有创建。

# android - 从相机应用程序返回时重新创建活动

> ID：10852048
> 
> 赞同：3
> 
> 时间：2012-06-01T14:22:09.653
> 
> 标签：android, android-lifecycle, android-camera-intent, activity-lifecycle

此问题仅在两款较旧的三星 Galaxy 机型上出现，但重现性非常好。

我有一个简单的应用程序，它显示通过设备的相机应用程序拍摄的照片。它有一个按钮来启动该应用程序，并在 AsyncTask 中处理结果以将其下采样到 ImageView 中。

从相机应用程序返回时，活动的流程出现问题：由于某种原因，活动被创建，处理导致 AsyncTask 中的 AsyncTask`onActivityResult()`被销毁，只是立即重新创建。一旦 AsyncTask 完成，它就会持有对不正确/旧活动的引用。

将一些调试语句放入各种生命周期回调中会发现这种奇怪的行为：

```
06-02 16:01:53.509: I/myapp(4437): onCreate com.myapp.PhotoActivity_@488cbef8
06-02 16:01:53.509: I/myapp(4437): onResume com.myapp.PhotoActivity_@488cbef8
06-02 16:01:58.298: I/myapp(4437): onPause com.myapp.PhotoActivity_@488cbef8
06-02 16:01:59.470: I/myapp(4437): onStop com.myapp.PhotoActivity_@488cbef8
[a photo is taken in the camera app]
06-02 16:02:10.196: I/myapp(4437): onCreate com.myapp.PhotoActivity_@4874f8b8
06-02 16:02:10.251: I/myapp(4437): onActivityResult com.myapp.PhotoActivity_@4874f8b8
06-02 16:02:10.259: I/myapp(4437): onResume com.myapp.PhotoActivity_@4874f8b8
06-02 16:02:10.712: I/myapp(4437): onPause com.myapp.PhotoActivity_@4874f8b8
06-02 16:02:10.720: I/myapp(4437): onStop com.myapp.PhotoActivity_@4874f8b8
06-02 16:02:10.923: I/myapp(4437): onCreate com.myapp.PhotoActivity_@48817118
06-02 16:02:10.931: I/myapp(4437): onResume com.myapp.PhotoActivity_@48817118
06-02 16:02:12.564: I/myapp(4437): onBitmapLoaded com.myapp.PhotoActivity_@4874f8b8 
```

调用的活动实例`onActivityResult()`（注意上面的哈希码）不再匹配正在显示的最终实例。当我的位图加载`onBitmapLoaded()`完成时，它因此也包含不正确的实例。

为什么会发生这种情况，我怎样才能防止（不必要地）重新创建活动？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T14:40:04.590

显然[应用程序的配置发生了变化](http://developer.android.com/reference/android/app/Activity.html#ConfigurationChanges)！在 onDestroy 中添加日志并在 onCreate 中改进日志以显示 Bundle *savedInstanceState*的值。如果 savedInstanceState 不为空，则配置更改强制重新创建 Activity。[在onSaveInstanceState(Bundle)](http://developer.android.com/reference/android/app/Activity.html#onSaveInstanceState%28android.os.Bundle%29)中添加日志可能会有所帮助。

您可以通过在清单中设置 Activity 属性[android:configChanges](http://developer.android.com/guide/topics/manifest/activity-element.html#config)来处理自己的配置更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T19:59:38.667

关于这个问题的小文章，希望对您有所帮助： [The problem with an external camera in Android using MediaStore.ACTION_IMAGE_CAPTURE](http://android-gex.blogspot.com/2013/03/the-problem-with-external-camera-in.html)

# ocean - 是否可以以编程方式设置 Petrel 的 Window3D 的背景颜色？

> ID：10852049
> 
> 赞同：2
> 
> 时间：2012-06-01T14:22:15.843
> 
> 标签：ocean, petrel

是否可以以编程方式设置 Petrel 的 Window3D 的背景颜色？

我看到您可以使用 ISettingsInfo 来获取/设置颜色，但我想知道如何使窗口的背景更新。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:24:10.353

从 2012.1 开始，您可以通过查询适当的 IColorInfoFactory 并获取相关窗口的 ColorInfo 实例来获取（或设置）Window3D 的背景颜色。但是，这只适用于将窗口切换到其非黑色状态时。

Petrel 3D 窗口的“更改背景颜色”功能在黑色和窗口设置选项卡中指定的颜色之间切换。不幸的是，ColorInfo API 仅从“设置”选项卡中公开该颜色，因此截至 2012 年，无法知道窗口当前是切换到黑色背景还是切换到指定颜色。

# android - 如何使用 Android 应用程序将图像从 SQLite 数据库显示到 gridview

> ID：10852054
> 
> 赞同：0
> 
> 时间：2012-06-01T14:22:37.613
> 
> 标签：android, sqlite

我的数据库中有图像，我已将它们转换为 BLOB，但我无法在 gridview 或 listview 上显示它们以及其他信息，例如：价格、数量、描述、图像

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:33:58.430

在您的光标适配器中是这样的：

```
ImageView myImage = (ImageView) findViewById(R.id.myImage);
byte[] bb = cursor.getBlob(cursor.getColumnIndex(MyBaseColumn.MyTable.ImageField));
myImage.setImageBitmap(BitmapFactory.decodeByteArray(bb, 0, bb.length)); 
```

# c# - 当生产者也是消费者时，如何在生产者/消费者模式中使用阻塞集合 - 我该如何结束？

> ID：10852055
> 
> 赞同：7
> 
> 时间：2012-06-01T14:22:40.353
> 
> 标签：c#, concurrency, consumer, producer, blockingcollection

我有一个递归问题，消费者在树的每一层都做了一些工作，然后需要沿着树递归并在下一层执行相同的工作。

我想使用 ConcurrentBag/BlockingCollection 等来并行运行它。在这种情况下，队列的消费者，也是队列的生产者！

我的问题是这样的：使用 BlockingCollection，我可以编写非常简单的 foreach 逻辑来使项目出队，并将新项目排队 - 当队列为空时，阻塞集合将正确阻塞，并等待另一个产生新工作消费者。

但是我怎么知道是否所有的消费者都在阻止？！

我知道 CompleteAdding()，但这似乎没有用，因为你真正完成的唯一时间是所有生产者都完成生产并且队列为空 - 因为它们都会阻塞，所以没有人“ free" 来设置 CompleteAdding()。有没有办法检测到这一点？（也许一个事件可以在阻塞时触发，并在解除阻塞时再次触发？）

我可以手动处理这个问题，不使用 foreach，而是手动使用 while(!complete) 循环，并使用 TryTake，但是我需要手动休眠，这似乎效率低下（拥有阻塞集合的全部原因与只是首先是并发集合！）每次通过循环，如果 TryTake 为 false，我可以设置一个 Idle 标志，然后让 Master 检查队列是否为空，并且所有线程都处于空闲状态，设置一个完整标志，但是，这似乎很笨拙。

直觉告诉我有一些方法可以使用阻塞收集来做到这一点，但我无法做到。

无论如何，当消费者是生产者并且能够检测到何时释放所有块时，任何人都有一个很好的模式会很棒

# macos - FSGetVolumeInfo 是 NSWorkspace 已弃用的 mountLocalVolumePaths 方法的推荐替代方法吗？

> ID：10852056
> 
> 赞同：5
> 
> 时间：2012-06-01T14:22:40.300
> 
> 标签：macos, cocoa, core-services

我需要在 Mac OS X 上获取已挂载的本地卷的列表。以前，Cocoa 类`NSWorkspace`有一种[`mountedLocalVolumePaths`方法](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSWorkspace_Class/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/instm/NSWorkspace/mountedLocalVolumePaths)可以获取此类卷的挂载点数组。自 Lion 以来，现在已弃用，文档中没有提示我们应该改用什么。

我发现提供此信息的唯一其他 Apple 特定 API 是 CoreServices.framework 中的[`FSGetVolumeInfo`函数](http://developer.apple.com/library/mac/documentation/Carbon/reference/File_Manager/Reference/reference.html#//apple_ref/c/func/FSGetVolumeInfo)。如果您`kFSInvalidVolumeRefNum`为*volume*参数传递并且为*volumeIndex*传递 1..N，这将枚举已安装的卷。*它通过volumeName*输出参数返回卷名（作为 a `HFSUniStr255`），通过*rootDirectory*输出参数作为 a返回挂载点，然后可以使用.**`FSRef``CFURLCreateFromFSRef()`**

 **这似乎有点令人费解且不必要的低级。

还有 BSD 级别的函数，`getfsstat()`它们`getmntinfo()`都发出一个`statfs`结构数组。API 似乎比核心服务版本更理智。

我应该使用任何更高级别的替代品吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T15:39:59.600

有一个更简单的替代方法，在一个比旧方法更合乎逻辑的地方：[NSFileManager 的`mountedVolumeURLsIncludingResourceValuesForKeys:options:`方法](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSFileManager_Class/Reference/Reference.html#//apple_ref/occ/instm/NSFileManager/mountedVolumeURLsIncludingResourceValuesForKeys%3aoptions%3a)。**

# javascript - 通过字符串索引访问字典对象

> ID：10852064
> 
> 赞同：0
> 
> 时间：2012-06-01T14:23:15.953
> 
> 标签：javascript, jquery, jquery-plugins, javascript-objects

我正在尝试填充字典（JavaScript 对象）并使用字符串索引从中检索值。`undefined`出于某种原因，当我尝试检索值时它总是返回。

我的代码是这样的：

```
var _gauges = {};

//fill the gauges
_gauges[gaugeName] = gaugeObject; 
```

然后我尝试按如下方式访问它：

```
 setValue: function (gaugeName, newValue) {
        var thisGauge = _gauges[gaugeName]; //always undefined
        console.log(_gauges); //output shows all the elements that were added to _gauges
        if (thisGauge) {
            thisGauge.setCell(0, 1, newValue);
        }
    } 
```

我在这里做错什么了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:53:10.610

好的，这是由于拼写错误...传递给`setValue`方法的参数与用于将项目添加到字典对象的参数不匹配。

# math - 两个三角形之间的相似变换

> ID：10852065
> 
> 赞同：5
> 
> 时间：2012-06-01T14:23:22.210
> 
> 标签：math, geometry, transformation, affinetransform

我有两个 2D 三角形（即它们都位于平面内），并且想找到将其中一个最接近地映射到另一个上的相似变换（旋转 + 缩放 + 平移）。

这两个三角形实际上并不相似，所以我只想让变换尽可能地对齐它们。

我知道我可以在两个三角形之间创建一个仿射变换，它将一个精确地映射到另一个，但我不想要仿射变换中存在的剪切效应。我希望我的变换仅由平移、旋转和缩放组成。

知道怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:45:21.873

定义相似性不是一件容易的事，但这里有一些你可以尝试的想法。假设您想将三角形​​ A（几乎）转换为三角形 B

*   比例：按面积（B）/面积（A）缩放三角形 A
*   变换：通过使两个三角形[质心](http://en.wikipedia.org/wiki/Centroid)匹配的向量变换三角形A。
*   旋转：使用优化方法在`[0, 360)`旋转范围内选择一个符合您个人相似性标准的值。

旋转部分可能是最困难的。一个简单而有效的想法是从三点开始进行[爬山并取得最佳成绩。](http://en.wikipedia.org/wiki/Hill_climbing)这三个点是将 A 的一个点放在 B 的每个点上所需的旋转量。

相似性标准本身也并不容易。想到的一件事是转换后重叠表面的数量。计算这并不容易，或者至少很麻烦。

# javascript - bindIntoStack 错误

> ID：10852067
> 
> 赞同：-1
> 
> 时间：2012-06-01T14:23:33.297
> 
> 标签：javascript, jquery, asp.net

我收到一个 javascript 错误，无法理解发生了什么。有没有人得到这样的错误？

```
$("input[type=text],input[type=password],input[type=checkbox],input[type=radio],select,textarea").bindIntoStack is not a function
Source: http://localhost:54838/GP.Portal.Ugur/default.aspx?ReturnUrl=%2fGP.Portal.Ugur%2fapp%2fDefault.aspx
Error: 380 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:24:27.423

那是因为**不是**`bindIntoStack`函数...

 **确保包含它的库。**

# php - 从 PHP 调用的 perl 脚本生成零字节大小的文件

> ID：10852071
> 
> 赞同：1
> 
> 时间：2012-06-01T14:23:49.980
> 
> 标签：php, perl

我正在调用外部 Perl 脚本将 DXF 文件转换为 SVG，但是当从 PHP 调用脚本时，输出 SVG 文件始终为 0 字节。从终端执行相同的命令时，输出 SVG 文件正常。

我正在通过 PHP system() 执行命令，还尝试了 exec() 和 popen() 但我总是得到相同的结果。

dxf2svg.pl perl 脚本源代码：[http ://pastebin.com/fE2BcUqE](http://pastebin.com/fE2BcUqE)

我正在执行的命令：

```
perl /path/dxf2svg.pl "/path_to_dxf/file.dxf" ">/output_path/file.dxf" 
```

Outup 路径对 PHP 用户是可写的，所以这不是问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:46:48.223

在[聊天](https://chat.stackoverflow.com/rooms/12037/discussion-between-tlp-and-primoz-rome)中调试后发现该行

```
open (WRITECSS, ">output.css")or die("error in Writing CSSFile"); 
```

是罪魁祸首。由于从命令行运行脚本创建了一个具有错误写入权限的文件，因此脚本在此语句中死亡。由于没有将错误返回给 PHP，因此错误是静默的。

解决方案是`chmod`输出 CSS 文件。

通过从 perl 重定向`STDERR`到文件并将错误报告变量添加`$!`到`die`语句来完成调试：

```
open STDERR, ">>", "somefile" or die $!;
open (WRITECSS, ">output.css")or die("error in Writing CSSFile: $!"); 
```

# c# - C# .net 2.0 中从帖子到字典或哈希表的字符串 []

> ID：10852082
> 
> 赞同：0
> 
> 时间：2012-06-01T14:24:14.137
> 
> 标签：c#, .net

我有一个帖子，其中包含一组项目，其中没有键的 int 而是键的字符串。例如：（来自帖子）

```
-----------------------------3805226668837
Content-Disposition: form-data; name="pool[Abelson_2834.jpg]"

general_pool
-----------------------------3805226668837
Content-Disposition: form-data; name="pool_place[Abelson_2834.jpg]"

1
-----------------------------3805226668837
Content-Disposition: form-data; name="mediatype[Abelson_2834.jpg]"

3
-----------------------------3805226668837
Content-Disposition: form-data; name="pool[Abelson_2852.jpg]"

general_pool
-----------------------------3805226668837
Content-Disposition: form-data; name="pool_place[Abelson_2852.jpg]"

1
-----------------------------3805226668837
Content-Disposition: form-data; name="mediatype[Abelson_2852.jpg]"

3
-----------------------------3805226668837
Content-Disposition: form-data; name="pool[Abelson_3160-1.jpg]"

general_pool
-----------------------------3805226668837
Content-Disposition: form-data; name="pool_place[Abelson_3160-1.jpg]"

1
-----------------------------3805226668837
Content-Disposition: form-data; name="mediatype[Abelson_3160-1.jpg]"

3
-----------------------------3805226668837
Content-Disposition: form-data; name="files[]"; filename="Abelson_2834.jpg"
Content-Type: image/jpeg 
```

所以“pool”是一个数组，其键设置为名称，其值设置为字符串。

从基本上看起来像这样的形式

```
<tbody data-target="#modal-gallery" data-toggle="modal-gallery" class="files">
  <tr class="template-upload fade in">
    <td class="preview"><span class="fade in">
      <canvas width="80" height="54"></canvas>
      </span></td>
    <td class="name"><span>Abelson_2834.jpg</span></td>
    <td class="size"><span>4.17 MB</span></td>
    <td><div aria-valuenow="0" aria-valuemax="100" aria-valuemin="0" role="progressbar" class="progress progress-success progress-striped active">
        <div style="width:0%;" class="bar"></div>
      </div>
      <div="forminputs"> <span style="display:inline-block;float:left;">Choose a pool:
      <select style="display:inline-block;" name="pool[Abelson_2834.jpg]">
        <option selected="selected" value="general_pool">General</option>
        <option value="place">Places</option>
        <option value="geo">Geometrics</option>
        <option value="ads">Advertisment</option>
      </select>
      <span class="pool_place"> <br>
      Choose a pool:
      <select style="display:inline-block;" name="pool_place[Abelson_2834.jpg]">
        <option selected="selected" value="1">place 1</option>
        <option value="2">Places</option>
        <option value="3">Geometrics</option>
        <option value="4">Advertisment</option>
      </select>
      </span> </span> <span style="display:inline-block;float:left;">Choose Media type:
      <select style="display:inline-block;" name="mediatype[Abelson_2834.jpg]">
        <option value="1">marker_icon</option>
        <option value="2">user_image</option>
        <option selected="selected" value="3">general_image</option>
        <option value="4">general_video</option>
        <option value="5">google_static_map</option>
      </select>
      </span> </div="forminputs"></td>
    <td class="start"><button class="btn btn-primary"> <i class="icon-upload icon-white"></i> <span>Start</span> </button></td>
    <td class="cancel"><button class="btn btn-warning"> <i class="icon-ban-circle icon-white"></i> <span>Cancel</span> </button></td>
  </tr>
  <tr class="template-upload fade in">
    <td class="preview"><span class="fade in">
      <canvas width="80" height="54"></canvas>
      </span></td>
    <td class="name"><span>Abelson_2852.jpg</span></td>
    <td class="size"><span>3.17 MB</span></td>
    <td><div aria-valuenow="0" aria-valuemax="100" aria-valuemin="0" role="progressbar" class="progress progress-success progress-striped active">
        <div style="width:0%;" class="bar"></div>
      </div>
      <div="forminputs"> <span style="display:inline-block;float:left;">Choose a pool:
      <select style="display:inline-block;" name="pool[Abelson_2852.jpg]">
        <option selected="selected" value="general_pool">General</option>
        <option value="place">Places</option>
        <option value="geo">Geometrics</option>
        <option value="ads">Advertisment</option>
      </select>
      <span class="pool_place"> <br>
      Choose a pool:
      <select style="display:inline-block;" name="pool_place[Abelson_2852.jpg]">
        <option selected="selected" value="1">place 1</option>
        <option value="2">Places</option>
        <option value="3">Geometrics</option>
        <option value="4">Advertisment</option>
      </select>
      </span> </span> <span style="display:inline-block;float:left;">Choose Media type:
      <select style="display:inline-block;" name="mediatype[Abelson_2852.jpg]">
        <option value="1">marker_icon</option>
        <option value="2">user_image</option>
        <option selected="selected" value="3">general_image</option>
        <option value="4">general_video</option>
        <option value="5">google_static_map</option>
      </select>
      </span> </div="forminputs"></td>
    <td class="start"><button class="btn btn-primary"> <i class="icon-upload icon-white"></i> <span>Start</span> </button></td>
    <td class="cancel"><button class="btn btn-warning"> <i class="icon-ban-circle icon-white"></i> <span>Cancel</span> </button></td>
  </tr>
  <tr class="template-upload fade in">
    <td class="preview"><span class="fade in">
      <canvas width="80" height="54"></canvas>
      </span></td>
    <td class="name"><span>Abelson_3160-1.jpg</span></td>
    <td class="size"><span>3.00 MB</span></td>
    <td><div aria-valuenow="0" aria-valuemax="100" aria-valuemin="0" role="progressbar" class="progress progress-success progress-striped active">
        <div style="width:0%;" class="bar"></div>
      </div>
      <div="forminputs"> <span style="display:inline-block;float:left;">Choose a pool:
      <select style="display:inline-block;" name="pool[Abelson_3160-1.jpg]">
        <option selected="selected" value="general_pool">General</option>
        <option value="place">Places</option>
        <option value="geo">Geometrics</option>
        <option value="ads">Advertisment</option>
      </select>
      <span class="pool_place"> <br>
      Choose a pool:
      <select style="display:inline-block;" name="pool_place[Abelson_3160-1.jpg]">
        <option selected="selected" value="1">place 1</option>
        <option value="2">Places</option>
        <option value="3">Geometrics</option>
        <option value="4">Advertisment</option>
      </select>
      </span> </span> <span style="display:inline-block;float:left;">Choose Media type:
      <select style="display:inline-block;" name="mediatype[Abelson_3160-1.jpg]">
        <option value="1">marker_icon</option>
        <option value="2">user_image</option>
        <option selected="selected" value="3">general_image</option>
        <option value="4">general_video</option>
        <option value="5">google_static_map</option>
      </select>
      </span> </div="forminputs"></td>
    <td class="start"><button class="btn btn-primary"> <i class="icon-upload icon-white"></i> <span>Start</span> </button></td>
    <td class="cancel"><button class="btn btn-warning"> <i class="icon-ban-circle icon-white"></i> <span>Cancel</span> </button></td>
  </tr>
</tbody> 
```

我尝试了几种方法来提取信息，但缺点是我必须能够知道关键是什么，这样我才能测试它，这样我就知道我得到了价值。我对发布数据没有选择权，就这样被卡住了。我不能使用 .ToDictionary 之类的东西，因为我也被困在 .net 2.0 中。

这是通过 KeyValuePair 获取正确信息的尝试，你是的，这是错误的，但至少我希望它能够给出需要发生的事情的想法。

```
media.file_name = "Abelson_2834.jpg"; // test value to pin to
int type = 3;
// NOTE I KNOW KeyValuePair IS NOT RIGHT.. looking for right way thou
foreach (KeyValuePair<string, string> obj in Request.Params["mediatype"])
{
    if( obj.Key == media.file_name ){
        type =  int.Parse(obj.Value); 
        // value of type should be 3 since there is a 
        // Request.Params["mediatype"]["Abelson_2834.jpg"] but since you can't call keys
        // by name it thnk it should be an int
        // like Request.Params["mediatype"][0]
    }
}

media.type = ActiveRecordBase<media_types>.Find(type);
ActiveRecordMediator<media_repo>.Save(media); 
```

有人对如何使这项工作有想法吗？我认为将 String[] 转换为 Dictionary 或 Hashtable 将是诀窍，但是.. 到目前为止它还没有工作。

感谢您的帮助。干杯，杰里米巴斯

**旁注** 如果这是 php，我只需要去

```
$value = $_POST["mediatype"]["Abelson_2834.jpg"]; 
```

如果可以解决一些问题，我将拥有所需的价值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:46:14.640

输入会误导您。您实际上正在获取属性 [对象] = 值。如果您使用 Key = some_function(object,property), Value=value 创建 KVP，您将朝着正确的方向前进。例如，作为上述代码的一次性：

```
 if (!String.IsNullOrEmpty(Request.Params["mediatype"])){
        foreach (KeyValuePair<string, string> obj in Request.Params["mediatype"])
        {
           dict_props[obj.Key+"_mediatype"]=value;
           // add each object to a list
        }
 }
 // for each object in the list
 //    for each property
 ...process dictionary.... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T17:28:46.353

解决方案是这样的

```
media.file_name = "Abelson_2834.jpg";
int type = 3;
int tmp = int.Parse(Request.Params["mediatype[" + media.file_name+ "]"]);
if(tmp>0){
    type = tmp;
} 
```

简而言之，您需要直接针对第一级表单键，因为 C# .net 2.0 至少不明白来自帖子的数组可以具有除 int 之外的键。当它看到这一点时，它所做的就是将其视为一个字符串，因此，您将其称为一个字符串。

谢谢你们的帮助。干杯-杰里米

# html - 用 html 电子邮件中的上标去除空格

> ID：10852086
> 
> 赞同：1
> 
> 时间：2012-06-01T14:24:32.293
> 
> 标签：html, css, outlook, html-email

上标在行高之间留下了很大的空间。

代码是

```
<span style="position:relative; bottom:0.2em; font-size: 0.8em">&reg;</span> 
```

我没有使用`<sup></sup>`标签，因为它在行高上也留下了很大的差距。

有解决办法吗。我知道`position:relative`在前景中表现不佳。什么是其他选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:36:26.987

我在[jsFiddle](http://jsfiddle.net/teneff/RsqPF/)中做了一些实验，我认为您将能够使用：

```
<sup style="line-height: 0">&reg;</sup> 
```

在Firefox中，它不会增加行之间的间隙

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T13:46:30.070

我通过增加`line-height`包含段落的`<p>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T15:11:36.840

Outlook 在应用上标时填充行高。一种解决方法（需要注意！）是执行以下操作：应用

```
<style="mso-line-height-rule:exactly;"> 
```

到`<td>`IF 单元格中的行高没有偏差，也**没有**使用图像。**!!!（这很重要，因为如果应用，Outlook 2010 将切断图像）**然后，应用

```
<span (or sup) style="font-size: (2px or more smaller than actual font size); line-height:0; vertical-align:3px;" 
```

在包装上标的 span 标签中。

参见：   [http ://emaildude.blogspot.com/2011/06/superscript-and-line-heights.html](http://emaildude.blogspot.com/2011/06/superscript-and-line-heights.html)

# jquery - Internet Explorer 不支持用于选择复选框值的 j 查询

> ID：10852088
> 
> 赞同：0
> 
> 时间：2012-06-01T14:24:57.967
> 
> 标签：jquery, ajax

使用 aj 查询获取选定的复选框值，该查询在 chrome 、 Firefox 下运行良好，但在 IE 中失败。由于某些原因，我为每个复选框提供了相同的 ID，但使用了不同的名称。例如

```
 <input id="LIV" name="<?php echo $value['desc']; ?>" type="checkbox" checked value="<?php echo $value['id']; ?>" /> <?php echo $value['desc']; ?>

       <a class="i-btn-2" onclick="addparameters('LIV');">Add</a> 
```

单击添加按钮时，我调用一个函数添加参数，如下所示

```
 function addparameters(id)
              {

                 var tempstr='#'+id+':checked';

                  $(tempstr).each(function(i)
                  {
                        val[i] = $('#'+id).val();
                        val1[i]=($(this).attr('name'));
                        str12=str12+val[i];
                    });
                 } 
```

在 IE 中，如果我选择了多个复选框，它只会给我第一个复选框值。但在 chrome 中，它会给我所有选定的复选框值我的代码有什么问题。请帮我在IE上运行它

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T14:27:22.490

确保为所有复选框提供**不同**的 id。

如果他们都有相同的id，他们将**无法**正确选择......

现在你**所有**的复选框都有`id="LIV"`, 使用类似公共类的东西来选择它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T14:29:39.743

您选择的是 ID 而不是类。只有一个元素可以具有相同的 ID，但多个元素可以共享类。因此，将 id 更改为一个类，它将开始工作。例如

```
var tempstr='.'+yourClass+':checked'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T14:31:00.930

正如尼尔所说 - 每个复选框必须有不同的 ID - 即使您的 HTML 中的每个元素都必须有不同的 ID - ID 应该是 - 一个 IDENTIFICATOR 并且 IDETIFICATOR 唯一地描述了一个具体项目。

代替 ID 您可以使用类或相同的输入名称：

```
function addparameters(name) {
    var selector = $('input[name="'+name+'"]:checked');
    $(selector).each(function(i){
        val[i] = $(this).val();
        val1[i] = name;
        str12 = str12+val[i];
    });
} 
```

或者

```
function addparameters(class) {
    var selector = $('input.'+class+':checked');
    $(selector).each(function(i){
        val[i] = $(this).val();
        val1[i] = $(this).attr('name');
        str12 = str12+val[i];
    });
} 
```

# linux - 在 -lpcap 中找不到 pcap_open_live

> ID：10852092
> 
> 赞同：8
> 
> 时间：2012-06-01T14:25:09.353
> 
> 标签：linux, ubuntu, libpcap

我正在尝试在 Ubuntu 12.04 32bit 上构建[reaver 。](http://code.google.com/p/reaver-wps/downloads/detail?name=reaver-1.4.tar.gz&can=2&q=)我已经构建并安装了[libpcap](http://www.tcpdump.org/#latest-release)。

运行`./configure`，我收到以下错误：

> 检查 -lpcap 中的 pcap_open_live ... 否
> 
> 错误：未找到 pcap 库！

非常感谢任何解决此问题的帮助。

**编辑：**这是检查配置脚本：

```
{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for pcap_open_live in -lpcap" >&5

$as_echo_n "checking for pcap_open_live in -lpcap... " >&6; }

if test "${ac_cv_lib_pcap_pcap_open_live+set}" = set; then :

  $as_echo_n "(cached) " >&6

else

  ac_check_lib_save_LIBS=$LIBS 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-01T15:10:52.093

您需要更多库，请查看此[错误报告](http://code.google.com/p/reaver-wps/issues/detail?id=97)：

看起来你需要（听起来很奇怪）：

```
sudo apt-get install libpcap-dev sqlite3 libsqlite3-dev 
```

# r - 使用 facet_grid 选项用 ggplot2 绘制数据框的列

> ID：10852096
> 
> 赞同：1
> 
> 时间：2012-06-01T14:25:35.407
> 
> 标签：r, ggplot2, simulation, facet

我从模拟中得到了一些结果，我想像下面这张图那样做一个刻面，我不知道是否可以用 ggplot2 和 facet_grid 选项来做这个。

我的模拟结果具有这种“简化”形式，逐行模拟：

```
dat <- read.table(textConnection("P1 P2 P3 P4 R 
1 2e-5 1.0 0.6 3 1
2 4e-6 1.5 0.7 1.5 2
3 6e-7 1.2 0.6 2.5 3 
4 8e-8 1.45  0.65 3.2 4
")) 
```

在这里你可以看到我想用 ggplot2 和 facet_grid 生成的简化图形

![图形图像 ggplot2](../Images/1f9b23247c16ce1b9ddd900fd1f0125f.png)

我有一个按参数的方面/图形，不同的比例对应于我的每个参数的最小/最大值...您还可以在此图中看到颜色对应关系，以在参数空间中定位每个模拟。

非常感谢您的帮助

SR。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:52:19.423

这是一个开始：

```
library(plyr)
library(ggplot2)
dat.melt <- melt(data, id.vars='R')

ggplot(dat.melt, aes(x=0, y=value)) +
    geom_boxplot() +
    geom_point(aes(colour=factor(R))) +
    facet_wrap(~variable, ncol=1, scales='free') +
    coord_flip() 
```

还有很多其他的调整，但要点就在那里。通常一个好的第一步是把`melt`数据弄长，然后开始摆弄。作为旁注，避免使用`data`变量名是一个好主意，因为它是一个内置函数。

# rspec - 在 RSpec 中，是否有等效于“unstub”但用于“should_receive”的方法？

> ID：10852104
> 
> 赞同：47
> 
> 时间：2012-06-01T14:25:49.777
> 
> 标签：rspec, mocking, stub

在使用 RSpec 时，有什么方法可以删除任何存根和模拟吗？

例子：

```
RestClient.should_receive(:delete).with("http://www.example.com")
...
... 

# this will remove the mocking of "should_receive" and 
# restore the proper "delete" method on "RestClient".
RestClient.mocking_reset 
```

（`mocking_reset`是我对所需功能的虚构名称）。

我知道有一种方法“unstub”可以重置“stubs”而不是“should_receive”。

那么，除了“should_receive”之外，是否有任何等效于“unstub”的方法？

帕纳约蒂斯

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2015-01-27T09:04:54.583

您可以通过以下方式覆盖一些以前的模拟：

```
expect(RestClient).to receive(:delete).and_call_original 
```

或者，如果不是任何期望，只是一个简单的存根：

```
allow(RestClient).to receive(:delete).and_call_original 
```

记住也存在`expect_any_instance_of`和`allow_any_instance_of`。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-06-02T17:02:50.770

目前（rspec-mocks 2.10.1）没有等效于`unstub`但 for的方法`should_receive`。您可以使用 重置所有存根和模拟`rspec_reset`，还可以编写肮脏的技巧来消除特定的期望（我不推荐）。

以下是删除对象上所有存根和期望的示例：

```
describe "resetting stubs and expectations with rspec_reset" do
  before do
    @person = mock('person')
    @person.should_receive(:poke)
  end

  it "should not fail when we reset all stubs and expectations" do
    @person.rspec_reset
  end
end 
```

请注意，此方法在 rspec 源代码中注释为`@private`，这意味着您应该避免使用它而不是绝对必要的，并且它可能会在 rspec 的未来版本中中断而不会发出警告。然而，它在 rspec 本身的规范中被广泛使用，因此它似乎不太可能很快被弃用。

在深入研究 rspec-mocks 代码之后，您当然可以做一些非常讨厌的事情并自己撕掉一个特定的期望：

```
# Works in rspec 2.10.1
describe "removing an expectation with an ugly hack" do
  before do
    @person = mock('person')
    @person.should_receive(:poke)
  end

  it "should not fail after we hack rspec by violating every law of good programming, ever" do
    @person.instance_variable_get(:@mock_proxy).instance_variable_get(:@method_double)[:poke].clear
  end
end 
```

这真的很糟糕，因为它违反了 rspec 测试包的封装，你不应该这样做。相反，如果您确实有一个令人信服的理由来消除特定的期望，那么正确的做法是在 rspec-mocks 的上游添加一个公共方法，该方法添加一个并行方法，`unstub`但用于消除特定的期望。它可能位于此处（请注意此文件中的`stub`and的定义`unstub`）：

[https://github.com/rspec/rspec-mocks/blob/master/lib/rspec/mocks/methods.rb](https://github.com/rspec/rspec-mocks/blob/master/lib/rspec/mocks/methods.rb)

在使用上述任何建议来消除期望之前，您可能需要考虑您的规范是否真的需要这样做，或者是否应该重构它们。Using`should_receive`是关于您的代码的断言，通常您应该尝试创建`it`只断言一件事的示例（即块）。我会很好奇为什么你需要类似的东西，`rspec_reset`除非你试图在全局设置中做太多事情（例如`before :each`或之前 :all 块），或者你的例子试图做太多事情（即使用多个断言在一个例子中）。

一个例外当然可能是在 rspec-mocks 的测试套件中，`rspec_reset`它用于在测试应用存根和模拟的功能的示例之间重置状态。除非您这样做，否则您的测试可能会得到改进，以不依赖于对象上存根和模拟的全局重置。

我希望这会有所帮助，如果您认为有一个合法的案例可以添加一个等效的方法，`unstub`但对于消息期望（即，在使用之后`should_receive`），我希望这会有所帮助。如果我确信这是一件可以做的事情，我会考虑添加此方法并建议将其添加到上游。也许它会被称为`unset_expectation`？也请随意使用上述代码和内部结构中的指南，自行组合 rspec-mocks 的拉取请求，我们将看看它是否被接受以创建等效于`unstub`.

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-02-18T16:34:29.133

对于**RSpec >= 2.14**，接受的答案将不再有效。

我向您推荐 Bernhard Köhler 在此线程上的回答（转载如下以防止链接腐烂）：[未定义的方法 `rspec_reset' with rspec version 2.14](https://stackoverflow.com/questions/18230761/undefined-method-rspec-reset-with-rspec-version-2-14)

> RSpec 2.14 中不存在重置方法。相反，它是在 rspec-mocks 项目的 spec_helper.rb 文件中定义的辅助方法。

您可以使用以下方法取消`expect`/`allow`调用：

```
RSpec::Mocks.proxy_for(object).reset 
```

对于**RSpec 3.9.0**，至少，我发现上面已经被替换为：

```
RSpec::Mocks.space.proxy_for(object).reset 
```

# windows-phone-7 - Windows Phone 7 客户端服务器实现

> ID：10852106
> 
> 赞同：0
> 
> 时间：2012-06-01T14:25:56.130
> 
> 标签：windows-phone-7, sockets, client-server, asyncsocket, socketasynceventargs

我正在尝试为 windows phone 7 创建一个应用程序，它充当客户端并将请求发送到用 Java 编写的服务器。客户端应该发送请求，并等待来自服务器的答复。我的问题是我似乎无法与服务器正常通信。当我尝试在一个简单的 .NET C# 程序中对其进行测试并使用诸如 socket.send() 和 socket.receive() 之类的阻塞调用时，它可以工作，但 Windows Phone 应用程序没有阻塞调用。这就是服务器 (Java) 在检测到连接后所做的事情：

```
BufferedReader reader = new BufferedReader(new InputStreamReader(clientSocket.getInputStream(), "UTF-8"));
String message = reader.readLine();
PrintWriter writer = new PrintWriter(new OutputStreamWriter(clientSocket.getOutputStream(), "UTF-8"));
writer.println("hiBack");
writer.close(); 
```

这就是客户端（C#）的实现方式：

```
public void sendRequest()
{
   socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
   var connectionOperation = new SocketAsyncEventArgs { RemoteEndPoint = new DnsEndPoint(server, serverPort) };
   connectionOperation.Completed += new EventHandler<SocketAsyncEventArgs>(onConnectCompleted);
   socket.ConnectAsync(connectionOperation);
 }

 private void onConnectCompleted(object sender, SocketAsyncEventArgs e)
 {
    if (e.SocketError != SocketError.Success)
    {
       System.Console.WriteLine("Error! " + e.SocketError);
       return;
     }
     var sendListener = new SocketAsyncEventArgs();
     string msg = "hi";
     var buffer = new System.Text.UTF8Encoding().GetBytes(msg + Environment.NewLine);
     sendListener.SetBuffer(buffer, 0, buffer.Length);
     sendListener = new SocketAsyncEventArgs { RemoteEndPoint = new DnsEndPoint(server, serverPort) };
     sendListener.Completed += new EventHandler<SocketAsyncEventArgs>(onSendCompleted);
     socket.SendToAsync(sendListener);
 }

 private void onSendCompleted(object sender, SocketAsyncEventArgs e)
 {
      socket.ReceiveAsync(e);
 } 
```

我的线路有问题：socket.SendToAsync(sendListener); 在 C# 端结束程序而不做任何事情（返回代码 0 退出）。Java服务器在检测到连接时立即启动它的工作，所以它也可能导致问题？我可以做些什么来使沟通工作？

# javascript - 使用 htaccess 提供不同的 CSS 和 JavaScript 文件

> ID：10852109
> 
> 赞同：1
> 
> 时间：2012-06-01T14:26:14.877
> 
> 标签：javascript, css, .htaccess

`RewriteRule`在 .htaccess 中使用为不支持 CSS3 的浏览器提供不同的 CSS 和 Javascript会是一个坏主意吗？如果是，为什么？

例如，我想为不完全支持 CSS3 的浏览器提供特殊的 CSS 和 Javascript。

我知道您可以`<!--[if xx]>`在 HTML 中使用，但我认为在服务器级别执行此操作会更干净。

请指导我。

我打算如何做的例子：

```
RewriteEngine On
RewriteCond %{HTTP_USER_AGENT} "MSIE 9" [or]
RewriteCond %{HTTP_USER_AGENT} "MSIE 8" [or]
RewriteCond %{HTTP_USER_AGENT} "MSIE 7" [or]
RewriteCond %{HTTP_USER_AGENT} "MSIE 6"
RewriteRule the-file-for-all-other-browsers.css /css/style-for-ie-browsers-below-10.css [NC,L] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:33:05.343

你打算怎么做这个`.htaccess`？嗅探用户代理字符串可能会导致误报，[通常不建议这样做](http://css-tricks.com/browser-detection-is-bad/)。[您应该使用Modernizr](http://modernizr.com/)之类的东西，然后您可以为不支持您正在寻找的某些功能的各种浏览器准备优雅的降级/插件。

另外值得一提的是，使用`<!--[if IE]-->`标签的开销最小，因为其他浏览器会忽略它们而不加载内容，它们也不会在使用类似用户代理字符串（指向 Opera）的浏览器上触发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T14:33:26.270

I'd say it's a bad idea. That .htaccess rewrite will get processed on EVERY request. That means for images, every file, everything. That is a lot of overhead and can lead to slowing down the site.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T14:29:28.927

考虑使用[CSS3PIE](http://css3pie.com/)，它为 IE 9,8 和 7 提供了 polyfills 以赋予它们 CSS3 特性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T14:32:59.477

我认为这很糟糕，因为您无法确定 htacess 中的功能支持。

您不应该使用浏览器嗅探来提供优雅的降级，而应该在向它们展示高级功能之前确定浏览器是否支持所需的功能（渐进式增强）

# haskell - 自定义函数的类型检查

> ID：10852117
> 
> 赞同：3
> 
> 时间：2012-06-01T14:26:54.923
> 
> 标签：haskell

我得到了这个功能：

```
foo [] = []
foo (x:xs) = foo us ++ foo ys
where us = filter (<=x) xs
      ys = filter (>=x) xs 
```

此函数的类型是 Ord a => [a] -> [b] 。

我不明白为什么输出类型是 [b] 而不是 [a]。我认为它应该是 [a] 因为输出列表的元素将是输入列表的元素的一部分。

我正在使用 Hugs，但我认为它不会改变任何东西。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-01T14:37:34.810

但是，类型`Ord a => [a] -> [b]`在内部是一致的！

问题是您实际上从未将输入列表中的任何元素添加到输出列表中。您需要一个基本案例；类似的东西`foo [x] = [x]`。就目前而言，您实际上从未说过将输入列表中的任何元素添加到输出列表中。此函数的结果将始终为，无论输入如何`[]`，它都可以具有类型。`[b]`

但是，如果您尝试在此处实现类似 Quicksort 的功能，那么您的实现中有两个逻辑问题：

1.  `x`，枢轴，不会被添加到输出列表中。
2.  `x`列表中任何不等于`x`自身的值都将被添加两次，一次来自`us`，一次来自`ys`。

# rally - 使用 ((Parent = null) 或 (Parent.Name = 'xxxx')) 集会自定义网格

> ID：10852118
> 
> 赞同：1
> 
> 时间：2012-06-01T14:27:04.953
> 
> 标签：rally

您可以使用以下查询在 Rally 中创建自定义用户故事网格吗？

(((Parent = null) AND (Owner.Name = "dummy.name@email.com")) OR ((Parent.Name 包含 "Example") AND (Owner.Name = "dummy.name@email.com" )))

每次我尝试这样做时，它只返回查询第二部分的结果。似乎它不能结合 Parent = null 和 Parent.Name 包含“示例”。

感谢您的任何反馈！我知道我们可以创建两个网格，但是将它们合并为一个会很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T14:44:16.903

这对我来说似乎是一个错误。根据您的问题标题：（（Parent = null）或（Parent.Name ='xxxx'）），忽略查询的所有者部分并仅获取父部分，似乎我也总是看到匹配的结果后一种情况。如果我切换顺序，我会得到没有父母的故事。我建议向 Rally 支持提交一个案例 - rallysupport@rallydev.com - 他们可以将这个提交给 Rally 开发人员。

# esb - 在生产环境中运行 Mule Standalone 与 Tomcat

> ID：10852119
> 
> 赞同：1
> 
> 时间：2012-06-01T14:27:11.373
> 
> 标签：esb, mule, production

将 Mule ESB 部署到生产环境中有多种方法。根据文档，似乎推荐将 Mule 作为独立服务运行。

是否有任何理由不在生产中独立运行 Mule？我确信它是稳定的，但就性能、可靠性和资源利用率而言，它与 Tomcat 相比如何？

出于任何原因，我是否仍应考虑在 Tomcat 中运行它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T16:19:38.090

使用 Tomcat 或任何其他 Web 容器，您可以将该容器的 Web 层用于 HTTP 入站端点（通过 Servlet 传输），而不是使用 Mule 的 HTTP 或 Jetty 传输。

在类加载、热重新部署的处理和日志记录方面发现了其他差异。

现在人们不单独使用Mule的主要原因是公司政策，即“你应该部署在**_**上”。当生产团队获得了维护特定 Java 应用程序/Web 服务器的经验时，他们希望您在该上下文中部署您的 Mule 项目，以便他们可以以众所周知且一致的方式管理/监控它。

但是，如果您对在 Mule 中获得的入站 HTTP 层感到满意，并且您可以在生产环境中部署它，那么就去做吧。它已准备好生产。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T16:45:05.263

Mule 实际上建议独立部署。在诸如tomcat之类的容器中，它必须共享线程池、堆等……这显然会阻止它发挥最佳性能。

您想要在像 tomcat 这样的容器中的主要原因是为了获得自动部署。即你可以只更新你的Mule 应用程序.war 并且容器将用新的应用程序重新启动mule。这有助于测试。

此外，一些传输特定于在容器内运行，例如 servlet 传输。OTOH 在设计解决方案时，让 Mule 在您的容器和您的 servlet 之间传输，您[做错了。](http://funny-pictures.funmunch.com/funny-picture-485.html)

# c++ - 重载序列的 ostream << 运算符

> ID：10852125
> 
> 赞同：0
> 
> 时间：2012-06-01T14:27:20.627
> 
> 标签：c++, operator-overloading, ostream

我想定义运算符 << 以对一系列元素进行操作，就像 STL 算法一样，将容器的第一个和最后一个元素作为参数。与仅采用一个参数相反，容器本身，例如

```
std::ostream& operator<< ( std::ostream &out, std::list inList ); 
```

所以我只需要编写一个函数，不管我是否使用列表、向量、数组等，我都必须使用两个参数调用该函数，inList.begin() 和 inList.end()

问题是 operator<< 只接受一个参数。克服这个问题的最佳方法是什么？

编辑：谢谢你的回答。我可能应该更清楚地表明我希望能够打印一系列元素，可能包括容器的子序列（再次，如 STL 算法）。例如，如果一个向量 v 有 5 个元素，我希望可以将它们全部打印出来，给出一个从 v.begin() 到 v.end() 的序列，输出如下：

```
[element1 element2 element3 element4 element5] 
```

但我希望我也可以只打印前三个，在 [v.begin(), v.begin()+3) 范围内

```
[element1 element2 element3] 
```

您建议的答案在这种情况下有效吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:40:06.307

您无法避免传递一个参数，但是您希望某些东西可以与任何类型的容器一起使用。所以理想情况下你会想要一个像

```
template <typename T>
std::ostream& someFunction(std::ostream& out, T first, T last) {
  // do your stuff
} 
```

和一个`ostream& operator<<`看起来*像*

```
template <T>
std::ostream& << (std::ostream& out, const T& sequence) {
  return someFunction(out, sequence.begin(), sequence.end());
} 
```

但是，此运算符会与预定义的运算符发生冲突，因此您不能就这样实现它。幸运的是，您可以玩一些模板魔术来解决这个问题，并看到一个非常好的解决方案，查看[这个 SO question](https://stackoverflow.com/questions/4850473/pretty-print-c-stl-containers)和相应的[github 项目](http://louisdx.github.com/cxx-prettyprint/)

请注意，由于（可能）目标是`ostream& operator<<`为容器提供泛型，并且您可以通过函数模板来实现这一点，因此函数采用迭代器并不是必需的。它也可以对容器进行 (const) 引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T14:31:38.510

只传递一个参数，并在方法内部取`begin`和`end`。所有 std 容器都有`begin`和`end`。不，您不能将参数的数量更改为`operator <<`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-26T04:33:47.740

这是一个老问题，但我最近不得不解决同样的问题，所以我想我会在这里发布我的解决方案。Range 和 makeRange 复制了 std::pair 和 std::make_pair 的功能，但我添加前者只是为了避免冲突（其他类型的对可能以不同方式打印）。

```
#include <iostream>

using namespace std;

template <typename Iterator>
struct Range
{
  Range();
  Range(Iterator begin_, Iterator end_) : begin(begin_), end(end_) {}

  Iterator begin, end;
};

template <typename Iterator>
Range<Iterator>
makeRange(Iterator begin, Iterator end)
{
  return Range<Iterator>(begin, end);
}

template <typename InputIterator>
ostream &
operator<<(ostream & out, Range<InputIterator> const & range)
{
  for (InputIterator iter = range.begin; iter != range.end; ++iter)
  {
    if (iter != range.begin) out << ", ";  // adjust formatting to taste
    out << *iter;
  }

  return out;
}

int
main(int argc, char * argv[])
{
  int a[] = { 1, 2, 3, 4, 5 };
  cout << makeRange(a, a + 2) << endl;  // prints 1, 2
} 
```

# node.js - 在 mongoose 和 expressjs 上查找/搜索

> ID：10852129
> 
> 赞同：0
> 
> 时间：2012-06-01T14:27:30.860
> 
> 标签：node.js, search, mongoose, express

我尝试使用 mongoose 和 expressjs 查找和文章。我有搜索表单，输入设置为变量“titless”。

这是我的 app.js 文件：

```
app.get('/', function(req, res){
    postdb.findAll( function(error,docs){
        res.render('index.jade', {
            locals: {
                title: 'test',
                articles:docs
            }
        });
    })

});

app.post('/.:titles?', function(req, res) {
    postdb.findByTitle(req.params.titless, function(error, article) {
        res.render('blog_show.jade',
        { locals: {
            title: article.title,
            article:article
        }
        });
    });

}); 
```

继承人 findbytitle 方法：

```
PostDB.prototype.findByTitle = function(titless, callback) {
    this.getCollection(function(error, article_collection) {
      if( error ) callback(error)
      else {
        article_collection.findOne({title: titless}, function(error,
result) {
          if( error ) callback(error)
          else callback(null, result)
        });
      }
    });

}; 
```

当我单击搜索按钮时，它会将我转发到 localhost/? 标题=关键字页面，但我仍然看到没有搜索文章的索引页面：/。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:44:30.340

```
res.render('blog_show.jade', { 
  locals: {
    title: article.title,
    article:article
  }
}); 
```

我不是 100% 确定，但你必须定义本地人吗？不应该是以下吗？

```
res.render('blog_show.jade', { 
  title: article.title,
  article:article
}); 
```

# python - 带有“.py”扩展名的 google.com 网页？

> ID：10852130
> 
> 赞同：1
> 
> 时间：2012-06-01T14:27:37.200
> 
> 标签：python, webserver

举个例子，`support.google.com/mail/bin/answer.py?hl=en&answer=13287`. 那是什么`answer.py`？这是如何运作的？我 99.99% 确信浏览器不具备解释 python 代码（还）的能力，如 javascript / PHP。那么这是什么？它是一些 Python 网络框架吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:29:52.340

`answer.py`是的，这只是访问服务器上调用的资源。这种命名约定完全取决于服务器——它可以运行 python 脚本（很可能是发生了什么），或者它甚至可以使用完全不同的语言。在任何情况下，浏览器关心的只是从该资源返回的信息——HTML、CSS、XML 等......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T14:31:01.210

很可能您请求的文件以`.py`输出通常的 HTML et 结尾。人。该文件在服务器端执行，**而不是**在您的浏览器中。

但同样，这是一个 URL，它可以指向*任何*资源。可以是任何东西。就像很多网站使用漂亮的 URL 来指向某些东西一样，除非在这种情况下它并不漂亮。（在幕后有路由器，有时会重写规则等来做到这一点。）

# java - 如何从springmvc中的控制器名称+动作名称获取映射的URL？

> ID：10852131
> 
> 赞同：4
> 
> 时间：2012-06-01T14:27:40.760
> 
> 标签：java, spring, spring-mvc

是否存在从 Spring MVC3 中的 (controller-name, action-name) 获取映射 URL 的现有解决方案，例如 asp.net mvc 或 rails 中的 UrlHelper？我觉得非常好用！

谢谢....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T08:41:58.987

可能，你想要这样的东西：

在您的`@Controller`课程中，您可以将 type 的额外参数添加到您的“操作”方法中 `HttpServletRequest`。

例子：

```
@Controller
public class HelloWorldController {

    @RequestMapping("/helloWorld")
    public void helloWorld(HttpServletRequest request) {
        //do call #getRequestURI(), or #getRequestURL(), or #getPathInfo()
    }
} 
```

使用默认配置，Spring 将“自动”注入请求，然后您可以通过调用其中一种`HttpServletRequest#getPathInfo(), HttpServletRequest#getRequestUrl()`方法提取路径信息（请参阅此处的说明：http: [//docs.oracle.com/javaee/6/api/javax/servlet/http /HttpServletRequest.html#method_summary](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#method_summary) )

# powershell - 带有空格和大括号的Powershell命令行参数？

> ID：10852132
> 
> 赞同：3
> 
> 时间：2012-06-01T14:27:43.070
> 
> 标签：powershell

我正在尝试我的第一个 powershell 脚本，并在运行以下代码时遇到错误的参数错误。如何将参数传递给 powersehll 中的命令？

```
& "bcdedit" /store c:\boot\bcd /set {bootmgr} device partition=C: 
```

**编辑：** 这个的工作代码是：

```
& "bcdedit" /store c:\boot\bcd /set "{bootmgr}" device partition=C: 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T23:01:29.137

大括号把所有东西都扔掉了。加上引号解决`{bootmgr}`了这个问题。

```
& "bcdedit" /store c:\boot\bcd /set "{bootmgr}" device partition=C: 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T18:09:38.720

您遇到的问题是 PowerShell 解析器的工作方式与`cmd.exe`解析器不同。解决此问题的一种方法是将您的命令传递给`cmd.exe`并让它进行解析。

为此，请将命令传递给`cmd.exe`将`/c`选项用作单引号字符串。

```
cmd.exe /c 'bcdedit /store c:\boot\bcd /set {bootmgr} device partition=C:' 
```

当您使用的命令需要字符串引用的参数时，此方法特别有用。

# java - 通过 GUI 控制工厂有效地将数据和表示连接在一起？

> ID：10852133
> 
> 赞同：1
> 
> 时间：2012-06-01T14:27:50.167
> 
> 标签：java, user-interface, javafx-2, factory-pattern, data-representation

假设我有一个类`StaticVehicleInformation`，它保存关于车辆的“静态”信息，例如它的类型、序列号或颜色。

现在我有一个跟踪应用程序来跟踪驾驶车辆并在地图上显示它们。在这种情况下，它`StaticVehicleInformation`被包裹在一个 中`DynamicVehicleEntry<? extends StaticVehicleInformation>`，它基本上添加了“动态”信息，例如 currentPosition、speed 或 currentDriver。同时它有一个方法`<T extends StaticVehicleInformation> <T> getStaticVehicleInformation()`来返回包装的静态信息。

在我的地图或基本上在任何显示不同移动汽车的视图中，因此主要处理`List<DynamicVehicleEntry <? extends StaticVehicleInformation>`，我需要区分我正在处理的实际类型的车辆以显示不同的图标等等。因此，通过拥有具体的`DynamicVehicleEntry`类（`DynamicCarEntry extends DynamicVehicleEntry <StaticCarInformation>`, `DynamicMotorcycleEntry extends DynamicVehicleEntry <StaticMotorcycleInformation>`,...），我得到了不同类型的实时跟踪车辆，具有不同的静态和 - 如果需要 - 特定的“动态”属性（在 的子类中`DynamicVehicleEntry`）。

由于我的目标是将数据与 UI 分离，我构建了一个工厂，根据`DynamicVehicleEntry`它们应显示的类型返回不同的 UI 元素：

```
// .... Factory....
public static Node createNewControlFromType(DynamicVehicleEntry <? extends StaticVehicleInformation> entry) {
    // from specific to general
    if (entry instanceof DynamicCarEntry) {
        return new CarControl(entry);
    } else if (entry instanceof DynamicMotorcycleEntry) {
        return new MotorcycleControl(entry);
    } else {
        // no concrete UI-Method found, so return a generic Control showing a dummy-icon
        // and only the most generic information common to every DynamicVehicleEntry and the wrapped StaticVehicleInformation
        return new GenericControl(entry);
    }
} 
```

`instanceOf`闻起来，我认为泛型的类型擦除也可能会伤到我的脖子。假设我不能修改`Static...Information`and`Static...Information`类，我应该如何解决这个问题？

提前致谢。

**更新：**

我已经对其进行了广泛的搜索，但没有找到任何更好的解决方案，特别是如果无法修改现有的类，因为它是访问者模式所需要的。正如[这里](http://butunclebob.com/ArticleS.UncleBob.VisitorVersusInstanceOf)的评论中所指出的，人们可以做一些反射魔法来做同样的事情，但据我所知，instanceof 无论如何都是“光”反射。

# opencv - OpenCV 中的 3D 渲染

> ID：10852144
> 
> 赞同：4
> 
> 时间：2012-06-01T14:28:26.113
> 
> 标签：opencv

我正在做一个关于场景 3D 渲染的项目。我正在使用 OpenCV。我正在做的步骤是这样的：

1.  拍摄两个场景的图像。
2.  使用 SURF 特征匹配计算对象对应关系。
3.  计算相机基本矩阵。
4.  计算视差图像。

现在我有两个问题

1.  计算基本矩阵后，如何计算 Q 矩阵？（我无法校准相机）

2.  如何使用 opencv 或任何其他库进行 3D 渲染？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T18:00:46.890

对于 3D 部分，您可以使用 OpenGL 或 PCL 渲染场景。你有两个解决方案：

*   对于每个像素，您使用从相机图像中提取的正确颜色创建一个点。这将为您提供可以使用 PCL 处理的点云（例如，用于 3D 特征提取）。
*   您应用三角测量算法，但为了应用此算法，您必须拥有相机的外部矩阵。

您可以在此处找到有关这些技术的更多信息：

*   [点云技术](http://blog.martinperis.com/2012/01/3d-reconstruction-with-opencv-and-point.html)
*   [三角测量算法](http://www.morethantechnical.com/2012/01/04/simple-triangulation-with-opencv-from-harley-zisserman-w-code/)

如果你想使用 OpenGL，你必须打开一个有效的 OpenGL 上下文。我向您推荐[SFML](http://www.sfml-dev.org/index.php)库或 Qt。这些库非常易于使用并且有很好的文档。两者都有关于使用 OpenGL 进行 3D 渲染的教程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-05T09:59:00.960

您可以通过 openCV 方法从立体校正中获得 Q 矩阵：

```
cv::stereoRectify 
```

我认为您希望 Q 矩阵重建 3D。但是，您可以通过以下方式从内在参数重建：

```
X = (u-cu)*base/d
Y = (v-cv)*base/d
Z = f*base/d 
```

其中 (u,v) 是图像坐标系中的二维点，(cu,cv) 是相机的主点，f 是焦距，base 是基线，d 是视差，(X,Y, Z) 是相机坐标系中的一个 3D 点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-17T04:06:24.107

对于可视化，可以使用[PCL](http://pointclouds.org/)或[VTK](http://www.vtk.org/)（PCL 的可视化是基于 vtk，但对我来说实现起来更简单）。

如果你只是想看看输出，你可以使用一些软件，比如[Meshlab](http://meshlab.sourceforge.net/)

干杯

# facebook-php-sdk - 控制台 PHP 应用程序发布到时间线

> ID：10852145
> 
> 赞同：0
> 
> 时间：2012-06-01T14:28:26.517
> 
> 标签：facebook-php-sdk, facebook-wall, facebook-timeline

# 客观的

我们正在开发一个 PHP 控制台应用程序，它将使用 PEAR System_Daemon 类作为守护程序运行。理想情况下，该脚本是一个定时循环，无限期执行直到终止。

这个循环的作用是按时间间隔查询我们的 FB 游戏玩家的数据库，然后使用某些标准在他们的 Facebook 墙/时间线上发布帖子。

我们的应用程序将托管在我们的 Facebook 页面上，该页面还将包含一些我们用来在这些帖子中展示的相册、照片和视频。

# 在墙上/时间表上张贴

我的问题是，我们是否能够使用 Facebook PHP SDK 从我们的控制台应用程序中作为服务运行，从我们的控制台应用程序共享这些相册，作为用户时间轴上的帖子，而无需来自任何方式的 FB 用户，当然前提是我们已经获得了适当的扩展权限。

# 外观分享与上传

共享相册或视频的外观在用户时间轴上是否会像他们自己发布的一样显示，或者帖子是否会简单地显示为旁边带有文本的缩略图。

我注意到现在的 Facebook 用多个缩略图以整齐的拼贴形式发布照片，这就是我们想要达到的效果。另外，如果没有记错的话，我相信添加到您的墙贴中的视频也会内嵌显示，作为一个不错的大视频，而不是缩略图。

![上传照片显示为拼贴画](../Images/41a12502251fdf5c2d419bd477db8800.png)

我们是否愿意将这些图像上传到 Facebook 用户帐户，如果是这样，是否可以使用 PHP SDK 在用户 FB 帐户上创建新相册，并授予所需的扩展权限？或者我们可以通过简单的分享来实现相同的外观和感觉吗？

# 在外部托管媒体

我们是否可以将照片添加到用户个人资料中，也许是在外部托管，这将允许 PHP 脚本将它们发布到他们帐户上的相册中而无需上传？

我们正在尝试避免上传，因为这将对服务器端应用程序产生性能影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:28:42.467

如果您请求正确的权限，您可以使用 Graph API 很容易地将照片上传到用户的帐户。要发布多张照片，您必须进行多次 API 调用。如果您张贴到墙上，照片将被添加到“Wall Photos”相册中。

Graph API 允许您代表用户创建相册，并允许您将照片直接上传到相册。这将在墙上创建照片故事，就像您在问题中发布的图像一样。

但是，您可以做的是在外部托管文件。Facebook 将始终从其服务器加载图像，因此您必须将它们上传到 Facebook。如果要在外部托管照片，则必须将图像作为链接发布到用户的墙/时间轴，但这些不会出现在用户的照片或相册下。

希望这能回答你所有的问题。上传照片和创建相册的文档可以在 Facebook 开发者网站上找到。

# c# - Windows 服务设计

> ID：10852149
> 
> 赞同：2
> 
> 时间：2012-06-01T14:28:35.180
> 
> 标签：c#, .net, design-patterns, windows-services

想象一下下面的情况。Windows 服务会不时检查数据库表中的数据。当出现一些新数据时，它开始处理每个新行。

处理由几个逻辑阶段组成，假设为：

*   从网络服务中获取一些额外的数据；
*   通过来自阶段 1 的数据通过 Web 服务找到一个存在对象或创建一个新对象；
*   通知感兴趣的人已完成的操作（包含在第 2 阶段找到/创建的对象的详细信息）；
*   做别的事。

就目前而言，如果发生任何异常，该服务会更新 DB 行并设置一个标志，指示发生了错误。一段时间后，服务将尝试再次处理该行......这就是问题所在。

处理将从一开始，从阶段 1 开始。在这种情况下，如果在阶段 4 发生异常并且它会一次又一次地发生，则将一次又一次地通知来自阶段 3 的感兴趣的人......

在发生异常的情况下完全停止行处理是不可能的，在我的情况下也是不可取的。理想情况下，如果有一种方法可以从上次失败的阶段开始处理，那就太好了。

现在我需要你的建议如何处理所有这些。事实上，一切都更加复杂，因为有几种处理模式，不同的阶段数等等。

提前致谢。

**更新**

是的，我在数据行中有 State 参数 :) 它只是暂时没有使用。异常处理对我来说并不是什么新鲜事。

问题是：处理状态切换的最佳方式是什么？换句话说，要在阶段编号和处理方法之间建立清晰的逻辑联系？执行流程可能非常不同，并且包括用于不同行的不同数量的阶段和方法。

我希望，有比为每个新情况编写无尽的 switch/case 块更令人愉快的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:34:57.987

有几种模式可以帮助您解决描述中的每个问题。

1.  Windows 服务检查队列。在您的服务中设置一个计时器，每 1 分钟或 5 分钟或其他时间运行一次，检查队列，如果有任何新条目，则开始处理。（请参见此处的示例：[在 Windows 服务中使用的最佳计时器](https://stackoverflow.com/questions/246697/windows-service-and-timer)）
2.  遵循一系列步骤通常称为*工作流*。在工作流中，您有一个当前状态，您可以在每个阶段更新该状态。因此，每一行都将从阶段 = 1 开始。在第一步之后，阶段 = 2 等等。在例外情况下，它将在它离开的阶段，然后将在该阶段重新开始该过程，或者您的任何逻辑是。此状态将与每一行一起存储，调度代码将检查状态并将服务发送到当前阶段的正确起始代码。`If`即，考虑基于状态的一组语句。
3.  处理异常非常简单。每个工作单元都应该包装在一个 try...catch 块中。出错时，记录异常，并根据您的业务规则标记该行。

就实现而言，使用编程最佳实践来保持您的代码干净、模块化、整洁和有条理。在您开发解决方案时，请提出*具体*问题以获得更多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:39:16.167

向您的数据库表中添加一个字段，用于跟踪每行的状态。例如，您可以将此新字段称为 ProcessingState。

当行通过每个逻辑状态时，您可以更新此 ProcessingState 字段以识别行处于哪个状态。

服务中的每个逻辑步骤都应该只处理处于适当状态的行。

这是一个示例，假设您有五个逻辑步骤要完成。你可以有以下状态；

1.  等待状态 1。
2.  状态 1 完成
3.  等待状态 2
4.  状态 2 完成

ETC..

祝你好运。

# sql - SQL NOT IN 和 SQL EXCEPT、UNION 和 OR、AND 和 INTERSECT 之间的区别？

> ID：10852158
> 
> 赞同：-1
> 
> 时间：2012-06-01T14:29:05.000
> 
> 标签：sql

在我的 rdbms 上，这些表达式给出完全相同的输出：

`select avd from avdelning where avd not in(select avd from försäljning) order by avd`

`select avd from avdelning except (select avd from försäljning) order by avd`

似乎你可以用 SQL 写的东西你可以用 SQL`EXCEPT`写`NOT IN`，同样地 for `UNION`and`OR`和`AND`and `INTERSECT`。你能告诉我这些关键字之间的区别吗？例如，与其他构造`select * from person where person not in (select * from person where name='foo')`相同`select * from person except where name='foo'`且相似。它们真的是等价的吗？

```
SELECT PersonId FROM person EXCEPT (SELECT PersonId FROM Addresses WHERE streetname='Elm Street')

=

SELECT PersonId FROM person WHERE PersonId NOT IN(SELECT PersonID FROM Addresses WHERE StreetName = 'Elm Street') 
```

?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:49:00.593

这可能会有所帮助：

[http://www.vbdotnetheaven.com/uploadfile/sscheral/sql-union-sql-intersect-sql-except-sql-exists-and-sql-case-for-beginners/](http://www.vbdotnetheaven.com/uploadfile/sscheral/sql-union-sql-intersect-sql-except-sql-exists-and-sql-case-for-beginners/)

实际上，我认为“差异”之一是 INTERSECT 和 EXCEPT 并非在所有平台上都实现（这是我认为 Sung 所建议的）。

# c - 复杂查询mongodb c

> ID：10852160
> 
> 赞同：-1
> 
> 时间：2012-06-01T14:29:08.433
> 
> 标签：c, mongodb, querying, mongodb-c

我已经像这样创建了我的 mongodb 查询 >

```
 86     bson query[1];
 87     bson_init(query);
 88     bson_append_start_object(query, "service.virtual_mach    ine");
 89         bson_append_oid(query,"_id",result);
 90     bson_append_finish_object(query);
 91     bson_finish(query); 
```

我用这个运行它>

```
 93     bson fields[1];
 94     bson_init(fields);
 95     bson_append_oid(fields, "_id", result);
 96     bson_finish(fields);
 97 
 98     mongo_cursor* cursor = NULL;
 99     cursor = mongo_find(conn, "db.services", query, field    s, 9999,0,0); 
```

如果我打印“mongo_cursor_next(cursor)”方法，我得到一个“-1”（错误），我想知道，我的查询中的错误是什么。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:57:22.053

这个？[https://github.com/mongodb/mongo-c-driver#error-handling](https://github.com/mongodb/mongo-c-driver#error-handling)

> 大多数函数在成功时返回 MONGO_OK 或 BSON_OK，在失败时返回 MONGO_ERROR 或 BSON_ERROR。然后将特定的错误代码和错误字符串存储在 mongo 和 bson 对象的 err 和 errstr 字段中。检查错误并适当处理它们是客户的责任。

# php - 函数内函数的变量范围？

> ID：10852163
> 
> 赞同：7
> 
> 时间：2012-06-01T14:29:27.247
> 
> 标签：php, closures, anonymous-function

在 Python 中，您可以拥有以下内容：

```
def foo(param1, param2):
    def bar():
        print param1 + param2
    bar() 
```

不过，我在 PHP 中的这种行为遇到了一些困难。我希望这可以通过以下方式工作：

```
function foo($param1, $param2)
{
    function bar()
    {
        echo $param1 + $param2;
    }
    bar();
} 
```

但这失败了。所以我读了一些关于闭包的文章（这不是叫做闭包吗？我知道它是用 Python 编写的）。在关于匿名函数的[php 文档](http://php.net/manual/en/functions.anonymous.php)中（他们说这些函数被实现为闭包），他们告诉您以下列方式使用 use() 表达式：

```
function foo($param1, $param2)
{
    function bar() use($param1, $param2)
    {
        echo $param1 + $param2;
    }
    bar();
} 
```

但这仍然失败。所以我把它改成了 PHP 匿名函数，就像这样：

```
function foo($param1, $param2)
{
    $bar = function() use($param1, $param2)
    {
        echo $param1 + $param2;
    };
    $bar();
} 
```

这确实有效，但它看起来真的很难看。我错过了什么吗？我可以以任何方式改善这一点吗？还是我只需要使用“丑陋”的方式？

（我不是在寻找关于闭包是否有用的讨论）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T14:43:51.330

`function bar() use($param1, $param2)`我在您链接到的手册页上找不到语法，只有有效的“丑陋”版本（真正*匿名*）。我想你必须使用它。

在您的第二个示例中，`bar`不是闭包。要在 PHP 中创建闭包，您必须使用丑陋`use`的或[`Closure`类](http://www.php.net/manual/en/class.closure.php)。每个函数都会创建自己的局部作用域，但闭包不是自动的。

[正如您在阅读手册](http://php.net/manual/en/functions.anonymous.php)时可能注意到的那样，PHP 似乎对术语“闭包”有一个奇怪的定义。他们将其定义为“匿名函数”的同义词：

> 匿名函数，也称为*闭包*(...)

令人困惑，对吧？稍后，他们解释说`use`如果要继承父范围，则需要关键字：

> 闭包也可以从父作用域继承变量。任何此类变量都必须在函数头中声明。

关于闭包的[PHP Wiki rfc 页面](https://wiki.php.net/rfc/closures#common_misconceptions)为我们提供了一些关于为什么以这种方式实现闭包的提示：

> PHP 的范围概念与其他语言定义的范围概念完全不同。将它与变量变量（$$var）结合起来，很明显，自动检测外部范围内引用了哪些变量是闭包是不可能的。此外，由于默认情况下全局变量在函数内部都不可见，因此自动使父作用域可用将与 PHP 遵循的当前语言概念相违背。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T14:43:19.347

在 PHP 中，您无法访问中间范围。您只有本地范围和全局范围。这是 PHP 的不正当范围规则的产物，它与任何理智语言的范围规则完全相反。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T18:14:52.103

在 PHP 中，命名函数声明 ( `function bar ()`) 在全局范围内声明一个函数。因此，在您的第一个示例中，当您运行`foo`函数时，它将`bar`在全局范围内定义一个函数，然后*每个人都*可以访问该`bar`函数，就像您在`foo`. PHP 中的函数和变量是分开的。命名函数只有一个作用域：全局；虽然您有局部变量，但没有局部范围函数之类的东西。

换句话说，把它放在里面`foo`是一种错觉；命名函数声明总是全局声明它；把它放在里面`foo`只会延迟声明运行的时间（因此延迟定义的时间）到`foo`.

你需要一个闭包。其他答案向您展示了如何做到这一点。

# javascript - 为什么我的 onclick 事件没有在 Firefox 中注册？

> ID：10852165
> 
> 赞同：5
> 
> 时间：2012-06-01T14:29:35.250
> 
> 标签：javascript, firefox, onclick, html-lists

我有一个带有`onclick`事件的列表项。它可以在 Chrome 和 Internet Explorer 中运行，但不能在 Firefox 中运行。有什么建议么？

```
<li onclick="alert('test');">test test<br></li> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T14:51:38.783

这在 Firefox 中对我来说很好。

检查这个：

1.  您的浏览器中启用了 JavaScript。

2.  尝试`return false;`在标签中添加语句。

或者像这样的函数：

```
function test() {
    //your code here
    return false;
} 
```

1.  或者使用这个：

`<a href="#" onclick="alert('hi');">Link</a>`

或这个

`<a href="javascript:void(0)" onclick="alert('hi');">Link</a>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T06:14:02.050

我试图最小化我的 html 代码以发送完整的代码来模拟 Boris Zbarsky 要求的错误。然后我发现了我的错误。

我正在使用已被弃用的选框标签。现在我将使用 jQuery 来代替它。

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-02T19:55:35.247

Firefox 在提供无效 HTML 时可以忽略属性，请使用 [https://validator.w3.org/](https://validator.w3.org/) 清理 HTML。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-19T22:55:00.933

在[Firefox 中，事件对象](https://developer.mozilla.org/en-US/docs/Web/Events)不是全局的。您必须在脚本标签中访问它，而不是在 html 中。

[`onclick`](https://developer.mozilla.org/en-US/docs/Web/Events/click)喜欢这样的作品

```
<li id="alert">test<br></li>

<script>
  document.getElementById("alert").addEventListener("click", function( event ) {
    alert('test');
  }, false);
</script> 
```

# php - Symfony2：如何完全禁用分析器？

> ID：10852174
> 
> 赞同：3
> 
> 时间：2012-06-01T14:29:58.767
> 
> 标签：php, symfony, profiler

即使我从所有 config*.yml 文件中删除`web_profiler`......我得到

```
RuntimeException: You need to enable either the SQLite3 or PDO_SQLite extension for the profiler to run properly. 
```

我只是不想在我的系统上安装 sqlite，我找不到如何完全关闭分析器......

有小费吗？

**UPD**：在 FrameworkExtension.php 中评论

```
if (isset($config['profiler'])) {
    $this->registerProfilerConfiguration($config['profiler'], $container, $loader);
} 
```

但这不是好的解决方案

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T14:16:14.840

或者你可以在你的 config_dev.yml 中改变：

```
web_profiler:
    toolbar: false 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T15:05:39.373

看看你的 app/AppKernel.php。

删除线

```
$bundles[] = new Symfony\Bundle\WebProfilerBundle\WebProfilerBundle(); 
```

应该做的伎俩！现在捆绑包永远不会被加载，因此现在需要 SQLite2 数据库。

# javascript - document.getElementById 适用于一个表单元素，但不适用于另一个

> ID：10852179
> 
> 赞同：-1
> 
> 时间：2012-06-01T14:30:08.207
> 
> 标签：javascript, asp.net

我有一个包含 10 位代码的网页，该代码分为两个文本框，第一个文本框有 4 个字符，第二个文本框有 6 个字符。

我一直在尝试实现一些 javascript，以便当用户在第一个文本框中输入第四个字符时，光标会跳转到第二个文本框。

页面布局如下：

```
<asp:TextBox ID="txtCode1" onkeyup="Next()" runat="server" Width="45"    MaxLength="4"/>
<asp:TextBox ID="txtCode2" runat="server" Width="70" MaxLength="6"/> 
```

我正在使用以下 Javascript：

```
function Next() 
{
    var control1 = document.getElementById('<%= txtCode1.ClientID %>');
    var control2;

    if (control1.value.length == 3) 
    {
         control2 = document.getElementById['<%= txtCode2.ClientID %>'];
         control2.Focus();
    }
} 
```

我的问题是该函数无法识别第二个文本框。如果我单步执行 Javascript 没有问题能够定位`txtCode1`并获取长度，但是当长度达到 4 个字符并且它必须填充`control2`调用`getElementById()`时，它将 control2 设置为未定义，然后 control2.Focus() 调用会引发错误。

我不明白获取 control1 和 control2 的代码是如何相同的，但这不起作用，我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T14:32:11.583

`getElementById`是一个函数，而不是一个数组。

`()`不使用`[]`。

此外，在 JavaScript 中，DOM 元素有一个`focus`方法，而不是一个`Focus`方法。

更正的代码：

```
control2 = document.getElementById('<%= txtCode2.ClientID %>');
control2.focus(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T14:32:04.017

在第二次调用中，您使用方括号而不是括号。在第一次通话中，您正确使用了它。

此外，正如 dontGoPlastic 在下面的评论中指出的那样，您应该使用`.focus()`(小写) 而不是`.Focus()`.

所以，你的第二个`if`块内的代码应该变成这样：

```
control2 = document.getElementById('<%= txtCode2.ClientID %>');
control2.focus(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T14:32:28.500

`control2 = document.getElementById['<%= txtCode2.ClientID %>'];`

应该

```
control2 = document.getElementById('<%= txtCode2.ClientID %>');
                                  ^ paren                    ^ paren 
```

# java - java中的夏皮罗·威尔克斯

> ID：10852182
> 
> 赞同：4
> 
> 时间：2012-06-01T14:30:29.550
> 
> 标签：java, algorithm, math, statistics, algebra

我想创建一个使用 Shapiro-Wilk 检验的函数，但我不确定我应该如何使用正态分布来计算乘以分子中的阶数统计量的常数。

[http://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test](http://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test)

有没有人可以在这方面给予指导？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T08:38:17.663

有一个实现 Shapiro-Wilks 的库，称为 SuanShu - 您只需要包含参数即可。

如果您是学生，您可以获得免费的学术许可证。看：

[http://www.numericalmethod.com/en1/products.php](http://www.numericalmethod.com/en1/products.php)

# asp.net-mvc-4 - 使用 WebAPI / MVC 4 从 REST 服务调用 REST 服务

> ID：10852183
> 
> 赞同：3
> 
> 时间：2012-06-01T14:30:31.227
> 
> 标签：asp.net-mvc-4, asp.net-web-api

我有一个调用另一个 REST 服务的 REST 服务。两者都使用 MVC 4 WebAPI 并调用它们工作正常，直到我把它放在负载下。简化的代码类似于：

```
public HttpResponseMessage Get()
{
    var url = WebHelpers.CreateUrl(Request, "EmployeesGet");
    var client = new HttpClient();
    var response = client.GetAsync(url).Result;
    var retResp = new HttpResponseMessage();
    retResp.Content = response.Content;
    return retResp;
} 
```

构造`WebHelper.CreateUrl`端点 url。当我加载负载时，模拟了 100 个用户，我收到了大约 16,000 个请求，并且我得到了一个套接字异常：

> SocketException 由于系统缺少足够的缓冲区空间或队列已满，无法对套接字执行操作

这会降低我电脑的网络堆栈，直到我重置 IIS。我想也许我需要更积极地清理，所以我处理掉了`HttpClient`没有效果。然后我想我需要处理我从端点得到的响应，因为一旦我得到内容我就不再需要它了。奇怪的是，然后我得到一个异常，说无法引用已处置的对象。这来自 MVC 框架。例外如下：

> [ObjectDisposedException：无法访问已处置的对象。对象名称：'System.Net.Http.StreamContent'。] System.Web.Http.WebHost.HttpControllerHandler.EndProcessRequest(IAsyncResult 结果) +49019 System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +469 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +375

如果我返回一个流或仅返回内容，则一切正常，但是我无法更改响应的状态代码或将任何其他元数据添加到响应中。

那么，从 Get 方法返回响应的最佳方式是什么，该方法已从另一个调用 REST 服务接收到内容。我不想反序列化/序列化，我真的希望能够在响应中添加一些数据。

**更新：**在进行负载测试时查看资源监视器时，我看到连接堆积。看来，我不能肯定地说，但似乎从内部对端点的调用`Get()`并没有释放连接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T03:19:45.870

我建议尝试将预先创建的 HttpClient 实例注入控制器并在请求之间重新使用它。处理 HttpClient 时，它会关闭并尝试关闭底层连接。根据我对 HttpClient 源代码的回忆，每次创建新的 HttpClient 实例时都会打开一个新连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:30:09.347

几件事

1.  您正在调用`.Result`这将阻塞一个线程。这可能是您的性能问题的一部分。因为您正在执行异步操作，所以您应该通过返回`Task<HttpResponseMessage>`并安排一个延续将您的内部服务调用的结果转换为外部调用的主体来使您的操作方法异步。
2.  我不确定是否`HttpContent`将内部调用的简单复制到外部调用的结果中。您可能想尝试读取内部流并将其复制到新的外部流中。

# java - 如何让 Eclipse 和 Maven 下载我需要的 JAR？

> ID：10852191
> 
> 赞同：4
> 
> 时间：2012-06-01T14:30:59.573
> 
> 标签：java, eclipse, dependencies, maven-3

我是 Maven 和 Eclipse 的新手。我们一直在使用 Netbeans 并在我们的项目中手动安装 jars。

我认为 Maven 的目的是根据您的依赖项下载所需的 jar？

在一个新项目中，我在`dependencies`pom.xml 文件的节点下添加了以下内容：

```
 <!-- Java dependencies -->
    <dependency>
        <groupId>javax.annotation</groupId>
        <artifactId>com.springsource.javax.annotation</artifactId>
    </dependency>

    <!-- Spring dependencies -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>org.springframework.orm</artifactId>
    </dependency>

    <!-- Spring Security dependencies -->
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>org.springframework.security.config</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>org.springframework.security.core</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>org.springframework.security.taglibs</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>org.springframework.security.web</artifactId>
    </dependency>

    <!-- Other dependencies -->
    <dependency>
        <groupId>com.mysql.jdbc</groupId>
        <artifactId>com.springsource.com.mysql.jdbc</artifactId>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>org.apache.commons</groupId>
        <artifactId>com.springsource.org.apache.commons.dbcp</artifactId>
        <scope>runtime</scope>
    </dependency> 
```

但我得到的只是：

**项目构建错误：javax.annotation:com.springsource.javax.annotation:jar 的“dependencies.dependency.version”缺失。**

……

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T14:34:14.973

依赖块几乎总是需要一个版本号。[如果您在http://search.maven.org/](http://search.maven.org/)上搜索您的依赖项，您应该能够导航到具有完整依赖项块的有关依赖项的页面。

例如，Spring Security 的页面是：

[http://search.maven.org/#artifactdetails|org.springframework.security|spring-security-aspects|3.1.0.RELEASE|jar](http://search.maven.org/#artifactdetails|org.springframework.security|spring-security-aspects|3.1.0.RELEASE|jar)

它的依赖块如下所示：

```
<dependency>
    <groupId>org.springframework.security</groupId>
    <artifactId>spring-security-aspects</artifactId>
    <version>3.1.0.RELEASE</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T14:35:57.157

您需要像这样指定依赖项的版本：

```
<dependency> 
     <groupId>javax.annotation</groupId>       
     <artifactId>com.springsource.javax.annotation</artifactId>  
     <version>1.0.0</version>     
</dependency> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-01T14:36:54.187

正如错误所说，pom 中的依赖项条目缺少依赖项的版本属性。

注意这个例子中 pom 的排列方式。 [http://www.mkyong.com/spring-security/spring-security-hello-world-example/](http://www.mkyong.com/spring-security/spring-security-hello-world-example/)

```
 <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-web</artifactId>
        <version>${spring.version}</version>
    </dependency> 
```

可以硬编码，也可以作为属性添加。希望这可以帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T14:37:27.087

正如错误消息指出的那样，您缺少`<version>`所有元素的子`<dependency>`元素。

[如果您在http://mvnrepository.com](http://mvnrepository.com)上浏览依赖项，应该很容易找到`<dependency>`可以粘贴到 POM 文件中的示例元素，如下所示：

```
<dependency>
    <groupId>springframework</groupId>
    <artifactId>spring-orm</artifactId>
    <version>1.2.6</version>
</dependency> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-01T14:40:06.260

除了 groupId 和 artifactId 之外，您还需要提供更多详细信息才能将依赖项添加到 pom.xml 文件。

请查看此参考以了解如何将依赖项添加到 pom.xml 文件 - [http://maven.apache.org/pom.html#Dependencies](http://maven.apache.org/pom.html#Dependencies)

# ios - 帧内的移动图像 ios

> ID：10852206
> 
> 赞同：0
> 
> 时间：2012-06-01T14:31:52.380
> 
> 标签：ios, uiimageview, uiimage

好的，首先我很抱歉，如果之前有人问过这个问题。我找不到存在我的问题的问题（但我确定他们在这里）。

我希望用户能够拍照/选择图片，然后将其应用到框架中，但能够在选择最终产品之前在框架内移动和缩放它。

我想知道像 PicFrame 这样的应用程序是如何做到这一点的。有人知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:34:46.473

为图片使用一个图像视图，并在框架顶部添加另一个图像视图。然后使用手势识别器来改变图片视图的位置和比例以响应用户交互。

# javascript - 在 Coffeescript 中将 while 循环转换为 for 循环

> ID：10852209
> 
> 赞同：1
> 
> 时间：2012-06-01T14:32:08.480
> 
> 标签：javascript, coffeescript

这似乎是一个简单的转换，但我似乎找不到它的语法。

```
i = start
while(if step > 0 then i < end else i > end)
  array.push i
  i += step 
```

start、end 和 step 是有符号整数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:52:33.610

假设您希望数字 from`start`到`end`作为`array`变量中的项目，这可能会满足您的需求：

```
array = (i for i in [start...end]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T14:39:00.660

您应该阅读[有关循环的 CofeeScript 页面](http://coffeescript.org/#loops)。但是在 CoffeeScript 中做到这一点的方法是在一个范围内迭代[列表推导：](http://en.wikipedia.org/wiki/List_comprehension)

```
(array.push i for i in [start...end] by step) 
```

但请注意，列表推导返回一个值。例如，给定以下代码：

```
start = 10
end = 5
step = -2
array = []
(array.push i for i in [start...end] by step) 
```

正如预期的那样，该变量`array`以 value 结束`[10,8,6]`，但是由于`push`返回它刚刚推入的数组的新长度，最后一条语句的*返回值*- 如果它是函数中的最后一件事，则将返回该值，或者如果您打印在 REPL 等处输入上述内容 - 是`[1, 2, 3]`。

**编辑**因此，如下所述，首先使用列表理解构造数组会更好：

```
array = (i for i in [start...end] by step) 
```

在构建范围时，请注意，它`...`会根据正确的端点产生一个独占的范围，而`..`产生一个包含的范围。所以`[1..5]`在列表中包括 5，而`[1...5]`在 4 处停止。

此外，如果你真的发现自己需要 C 风格`for`循环的灵活性，你总是可以在 CoffeeScript 中嵌入一些文字 JavaScript，方法是用反引号 (`...`) 包装它：

```
`for (i=start; (step > 0 && i < end) || (step < 0 && i > end); i+=step) {
     array.push(i);
 }` 
```

# java - Liferay：找不到合适的驱动程序

> ID：10852216
> 
> 赞同：2
> 
> 时间：2012-06-01T14:32:28.720
> 
> 标签：java, oracle, jdbc, liferay

对于我当前的任务，我必须在 liferay 门户中部署我们的应用程序。部署本身是成功的，但是当应用程序启动时，会抛出“没有合适的驱动程序”异常。

环境：

*   Oracle 10g 速成版
*   休眠 4 决赛
*   Liferay 6 与 Tomcat 7
*   OJDBC 6
*   c3p0 0.9
*   使用 Maven 构建

我们应用程序的旧 .war 文件运行时没有任何异常。但是，环境中存在一些小的差异。

旧环境：

*   Oracle 10g 速成版
*   休眠 3 决赛
*   Liferay 6 与 Tomcat 7
*   OJDBC 14
*   Hibernate 在连接池中构建
*   不使用 maven 构建

我已经尝试过的事情：

*   将 ojdbc.jar 从 webapp lib 文件夹移动到 liferay tomcat lib/ext 文件夹
*   在 context.xml 中强制执行 Class Loader 的“webapp classes/libs/resources first”行为：
*   删除c3p0再次使用ojdbc14（我认为它可能是由ojdbc6引起的）
*   在旧版本中将 ojdbc14 与 ojdbc6 交换（有效）

新的persistence.xml：

```
<persistence-unit name="ipointdefault">
<provider>org.hibernate.ejb.HibernatePersistence</provider>
<mapping-file>META-INF/hbm.xml</mapping-file>
<class>Entity declaration...</class>
<properties>
    <property name="javax.persistence.jdbc.driver" value="oracle.jdbc.driver.OracleDriver" />
    <property name="javax.persistence.jdbc.url" value="jdbc:oracle:thin:@HOST:PORT:DB" />
    <property name="javax.persistence.jdbc.user" value="user" />
    <property name="javax.persistence.jdbc.password" value="pw" />
    <property name="hibernate.hbm2ddl.auto" value="update" />

    <property name="hibernate.dialect" value="org.hibernate.dialect.Oracle10gDialect" />
    <property name="hibernate.archive.autodetection" value="class" />
    <property name="hibernate.current_session_context_class" value="thread" />
    <property name="hibernate.connection.pool_size" value="10" />
    <property name="hibernate.cache.provider_class" value="org.hibernate.cache.NoCacheProvider" />
    <property name="hibernate.bytecode.use_reflection_optimizer" value="true" />
    <property name="hibernate.c3p0.acquire_increment" value="3" />
    <property name="hibernate.c3p0.min_size" value="3" />
    <property name="hibernate.c3p0.max_size" value="5" />
    <property name="hibernate.c3p0.timeout" value="10800" />
    <property name="hibernate.c3p0.idleConnectionTestPeriod" value="1800" />
    <property name="hibernate.c3p0.max_statements" value="0" />
</properties> 
```

旧的persistence.xml：

```
<persistence-unit name="ipointdefault">
<provider>org.hibernate.ejb.HibernatePersistence</provider>
<class>Entity declaration...</class>
<properties>
    <property name="javax.persistence.jdbc.driver" value="oracle.jdbc.driver.OracleDriver" />
    <property name="javax.persistence.jdbc.url" value="jdbc:oracle:thin:@HOST:PORT:DB" />
    <property name="javax.persistence.jdbc.user" value="user" />
    <property name="javax.persistence.jdbc.password" value="pw" />
    <property name="hibernate.default-access" value="property" />
    <property name="hibernate.hbm2ddl.auto" value="update" />
    <property name="hibernate.dialect" value="org.hibernate.dialect.Oracle10gDialect" />
    <property name="hibernate.archive.autodetection" value="class" />
    <property name="hibernate.current_session_context_class" value="thread" />
    <property name="hibernate.connection.pool_size" value="10" />
    <property name="hibernate.cache.provider_class" value="org.hibernate.cache.NoCacheProvider" />
    <property name="hibernate.bytecode.use_reflection_optimizer" value="true" />
</properties> 
```

您是否知道如何解决问题或找到根本原因？

提前致谢。

编辑：

堆栈跟踪：

```
java.sql.SQLException: No suitable driver
    at java.sql.DriverManager.getDriver(DriverManager.java:264)
    at com.mchange.v2.c3p0.DriverManagerDataSource.driver(DriverManagerDataSource.java:224)
    at com.mchange.v2.c3p0.DriverManagerDataSource.getConnection(DriverManagerDataSource.java:135)
    at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:182)
    at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:171)
    at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool$1PooledConnectionResourcePoolManager.acquireResource(C3P0PooledConnectionPool.java:137)
    at com.mchange.v2.resourcepool.BasicResourcePool.doAcquire(BasicResourcePool.java:1014)
    at com.mchange.v2.resourcepool.BasicResourcePool.access$800(BasicResourcePool.java:32)
    at com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask.run(BasicResourcePool.java:1810)
    at com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:547) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T14:38:00.270

经过三天的调试，我终于找到了解决方案：

在某些情况下，persistence.xml 中的给定驱动程序类被 hibernate/c3p0 忽略，因此 - 就像异常状态一样 - 找不到合适的驱动程序。为了防止这种情况，我在 c3p0-config.xml 中添加了以下行：

`<property name="driverClass">oracle.jdbc.driver.OracleDriver</property>`

我希望它也可以帮助其他人:-)

# css - CSS Float：为什么在要浮动的元素之前将浮动应用于元素？

> ID：10852220
> 
> 赞同：2
> 
> 时间：2012-06-01T14:32:41.620
> 
> 标签：css, css-float

关于 CSS “float” 属性的某些东西一直让我感到困惑。为什么将“float”属性应用于要浮动的元素之前的元素？

为了帮助可视化我的问题，我创建了以下 jsFiddle [http://jsfiddle.net/Ubutb/12/](http://jsfiddle.net/Ubutb/12/)

在示例中，浮动属性应用于导航`<div>`而不是内容`<div>`。我会认为浮动需要应用于“内容”`<div>`元素，因为这些是您想要“浮动”出页面正常流程的项目。我显然错过了一些东西。有人可以解释得比我理解的更好吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:35:40.397

使用`float: {position}`CSS 时，您是在告诉该元素“在其父元素的 {position} 侧浮动”。内容的行为正常，好像导航`div`甚至不存在一样，因为它是您指示的导航，以避开其他元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T14:45:31.590

`"float:left;"`表示该 div 正在向 parent`<div>`的“左墙”推。。当`"float:left;"`在同一个容器中添加下一个 div 时，它会被推到左边，并撞到第一个 div 的“右墙”。 ..就像一个谜题。

容器的宽度决定了第二个`"float:left;"`div 是否有足够的空间放置在第一个旁边，或者它是否在下面。

如果每个 div 的宽度为 33%，并且没有边距，那么您通常可以让 3 个 div 漂浮在容器中，并且它们最终会在一条漂亮的线上。但是如果宽度是 34%，一个会在下面。

这是浮动 div 最简单的解释。当然，当它正确浮动时，反之亦然。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T14:42:38.893

听起来您正在寻找一个很好的解释，解释为什么花车以它们的方式工作？这里有一些很好的写法：

*   [所有关于](http://css-tricks.com/all-about-floats/)CSS-Tricks 的浮点数
*   来自 Smashing Coding 的[CSS 浮点理论](http://coding.smashingmagazine.com/2007/05/01/css-float-theory-things-you-should-know/)
*   [如何用通用语言解释 CSS Float？](https://stackoverflow.com/questions/2996303/how-to-explain-css-float-in-general-language)来自 StackOverflow

**我自己的解释：**浮动元素确实是浮动的。它旁边的元素正在做所谓的“包装”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T14:36:27.913

这是你想要的吗？[jsfiddle](http://jsfiddle.net/Ubutb/13/)

浮动位置是相对于“容器”又名“父”的（在这种情况下，没有容器的地方，后者是整个身体）

# c# - 从 try...catch 返回 null 的方法

> ID：10852228
> 
> 赞同：3
> 
> 时间：2012-06-01T14:33:07.877
> 
> 标签：c#, null, return, try-catch

```
public SPListItemCollection GetACollection()
{
    try
    {
        //Method to get an item collection from somewhere
        if(itemCol != null)
            return itemCol;
        else
            return null;
    }
    catch(Exception ex)
    {
        LogException(ex);
        return null;
    }
} 
```

此方法必须返回 null（不是空列表）——无论是否捕获到异常。上述工作 - 但有没有更好的方法呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T14:35:57.463

```
if(itemCol != null)
    return itemCol;
else
    return null; 
```

简化为

```
return itemCol; 
```

因为 if `itemCol == null`then 返回`itemCol`已经返回`null`。没有理由对这种行为进行特殊处理。

如果你想用 替换空集合`null`，你需要使用类似的东西：

```
if((itemCol != null) && itemCol.Any())
    return itemCol;
else
    return null; 
```

* * *

一点设计建议：

*   不鼓励吞咽异常。您应该只捕获一些您知道如何处理的特定异常
*   空集合通常比`null`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T14:36:32.563

我必须首先说这是一件可怕的事情，吞下异常是可怕的！不要这样做！它会困扰你并使调试变得非常非常困难，更糟糕的是由于异常而返回 null - null 通常最终会抛出 NullReferenceException ，这将比被吞噬的异常更难调试（即使它已记录），但既然你问：

```
public SPListItemCollection GetACollection()
{
    SPListItemCollection itemCol = null;
    try
    {
        //Method to get an item collection from somewhere
    }
    catch(Exception ex)
    {
        LogException(ex);
    }
    return itemCol;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-01T14:40:02.563

从不喜欢具有多出口点的方法，
在您的**catch中将****itemCol**设置为 null，在**try/catch**返回 itemCol 之外

```
try
{
     // whatever
     if(itemCol.Count == 0) itemCol = null;
}
catch(Exception x)
{
     LogException(x);
     itemCol = null;
}
return itemCol; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-01T15:19:50.430

您提到您当前的实施有效。我假设用于获取项目集合的方法返回包含 1 个或多个项目的集合或 null 或引发异常。如果这是真的，这将是一种选择。

```
public SPListItemCollection GetACollection()
{
   SPListItemCollection itemCol = null;
   try
   {
      itemCol = //Method to get an item collection from somewhere
   }
   catch(Exception e)
   {
      LogException(e);
   }
   return itemCol;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-01T14:38:28.570

要检查集合是否为空，该`Any()`方法很有用，主要是如果您没有列表，但有一般的 IEnumerables。如果您只想摆脱 的重复`return null;`，您可以轻松地这样做：

```
public SPListItemCollection GetACollection()
{
    try
    {
        //Method to get an item collection from somewhere
        if(itemCol.Any())
            return itemCol;
    }
    catch(Exception ex)
    {
        LogException(ex);
    }

    return null;
} 
```

您还可以附加一个

```
 finally
    {
        // Stuff that always needs to be done.
    } 
```

直接在你的右括号之后`catch`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-01T14:35:39.443

已经很好了，imo，我也会删除最后一个`else`，如下所示：

```
public SPListItemCollection GetACollection()
{
    try
    {
        //Method to get an item collection from somewhere
        if(itemCol != null)
            return itemCol;

        //Some if/else code here presumably... 

        //NO ELSE HERE...
        return null;
    }
    catch(Exception ex)
    {
        LogException(ex);
        return null;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-01T14:37:18.093

您不需要`if-else`阻止，因为如果 object 为 null，您已经返回 null：

```
public SPListItemCollection GetACollection()
{
    try
    {
        //Method to get an item collection from somewhere
        return itemCol;
    }
    catch(Exception ex)
    {
        LogException(ex);
        return null;
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-01T14:39:19.397

这个怎么样？如果您的规格说明：

> 必须返回 null（不是空列表）

如果集合不为空，而是为空，您当前的实现将返回一个空集合。除非你依靠方法来处理它。

这照顾...

```
public SPListItemCollection GetACollection()
{
    try
    {
        //Method to get an item collection from somewhere
        if(itemCol != null && itemCol.Count == 0)
            return itemCol;

        return itemCol;
    }
    catch(Exception ex)
    {
        LogException(ex);
    }

    return null;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-01T14:40:19.147

我会这样做：

```
public SPListItemCollection GetACollection()
{
    try
    {
        //Method to get an item collection from somewhere
        return itemCol != null && itemCol.Count == 0 ? null : itemCol;
    }
    catch(Exception ex)
    {
        LogException(ex);
        return null;
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-06-01T14:43:38.097

你的代码看起来不错。如果它更符合您的口味，您可以将 null 返回放在最后：

```
public SPListItemCollection GetACollection()
{
    try
    {
        //Method to get an item collection from somewhere
        if(itemCol != null)
            return itemCol;
    }
    catch(Exception ex)
    {
        LogException(ex);
    }
    return null;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-12-10T14:07:32.767

我同意以下观点：

> *来自 IDesign 编码标准 v2.4 ( [http://idesign.net/Downloads/GetDownload/1985](http://idesign.net/Downloads/GetDownload/1985) )：*
> 
> > 18.  仅捕获您对其进行显式处理的异常。

让方法的调用者实现 try/catch 并处理异常。我会说在异常时返回 null 通常是一种不好的做法，因为您正在向调用者隐藏信息并阻止框架收集正确的调用堆栈。为什么首先抛出异常？同样，捕获您知道的显式异常类型，然后处理它。不要捕获其他/所有异常。

# python - cloudsql 和 appengine 数据存储：游标与偏移和限制

> ID：10852235
> 
> 赞同：1
> 
> 时间：2012-06-01T14:33:34.607
> 
> 标签：python, google-app-engine, google-cloud-sql

我想了解谷歌 cloudsql 是否使用数据存储作为数据存储。

所以我加载了一个超过 10 万条记录的谷歌 cloudsql 表

然后我尝试使用`LIMIT 100000,10`vs进行查询。`LIMIT 0,10`

请参阅[http://cloudsql.website-showcase.appspot.com/?pagesize=10&offset=100000](http://cloudsql.website-showcase.appspot.com/?pagesize=10&offset=100000) 与[http://cloudsql.website-showcase.appspot.com/?pagesize=10&offset=0](http://cloudsql.website-showcase.appspot.com/?pagesize=10&offset=0)

表现似乎是一样的。这是否意味着 cloudsql 有一种有效的方法来使用数据存储来限制和偏移量或者 cloudsql 不使用数据存储或者 100K 记录太小而无法判断性能？

另一个问题是 cloudsql 是否使用数据存储 bigtable 来实现限制和偏移。它是否有效地执行它？还是扫描所有记录并仅返回限制部分？（这就是文档所说的限制和偏移使用在数据存储查询案例中的作用。不建议这样做。）

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:44:44.413

[不， CloudSQL](https://developers.google.com/cloud-sql/docs/introduction)的全部意义在于它不使用数据存储：

> 简而言之，Google Cloud SQL 是一个位于云中的 MySQL 实例。

# sql - 合并同一个表，在同一行中给出 3 个单独的结果和列

> ID：10852236
> 
> 赞同：0
> 
> 时间：2012-06-01T14:33:37.247
> 
> 标签：sql, sql-server, database, union

我在下面有 3 个选择语句，每个语句创建完全相同的计算列，然后我计算该计算列中的所有是和所有否。目前它显示该区域 3 次，旁边有 3 个结果。我希望它显示该区域一次，其中包含 3 个带有总计的新列，所以目前

**我有：**

```
region1 computedCol1

region1 computedCol2

region1 computedCol3

region2 computedCol1

region2 computedCol2

region2 computedCol3 
```

**我想：**

```
Region1,  computedCol1, computedCol2, computedCol3

Region2,  computedCol1, computedCol2, computedCol3

Region3,  computedCol1, computedCol2, computedCol3 
```

**如果我使用“union all”，我会得到：**

```
region1 computedCol1

region2 computedCol1

region3 computedCol1 
```

```
SELECT a.region, COUNT(*) AS [computedCol1]    
(
SELECT  DISTINCT table1.serial1, table1.serial2, region,
    CASE WHEN table2.serial1 IS NULL THEN 'No' ELSE 'Yes' END AS [computedCol1],
    CASE WHEN table3.serial2 IS NULL THEN 'No' ELSE 'Yes' END AS [computedCol2],
    CASE WHEN table3.serial2 IS NULL AND table2.serial1 IS NULL THEN 'No' ELSE 'Yes' END AS [computedCol3]

FROM    table1
        LEFT JOIN table2
            ON table2.serial1 = table1.serial1
        LEFT JOIN dbo.EPG
            table3.serial2 = table1.serial2
)a
    WHERE region in (
        '37000','38000','39000','41000','42000','43000','44000','46000','45000','51000','52000','53000','54000',
        '55000','56000','57000','58000','59000','61000','62000','63000','64000','65000','66000','67000','68000',
        '69000','30000','33000','36000','34000','35000','31000','32000','N/A'   )
and [CCA Match Org] in  ('no')
    GROUP BY a.region

union

SELECT b.region, COUNT(*) AS [computedCol2], region   
(
SELECT  DISTINCT table1.serial1, table1.serial2,
    CASE WHEN table2.serial1 IS NULL THEN 'No' ELSE 'Yes' END AS [computedCol1],
    CASE WHEN table3.serial2 IS NULL THEN 'No' ELSE 'Yes' END AS [computedCol2],
    CASE WHEN table3.serial2 IS NULL AND table2.serial1 IS NULL THEN 'No' ELSE 'Yes' END AS [computedCol3]

FROM    table1
        LEFT JOIN table2
            ON table2.serial1 = table1.serial1
        LEFT JOIN dbo.EPG
            table3.serial2 = table1.serial2
)b
    WHERE region in     (
        '37000','38000','39000','41000','42000','43000','44000','46000','45000','51000','52000','53000','54000'
        '55000','56000','57000','58000','59000','61000','62000','63000','64000','65000','66000','67000','68000',
        '69000','30000','33000','36000','34000','35000','31000','32000','N/A'   )
and [CCA Match Org] in ('yes')
    group by b.region

union

SELECT c.region, COUNT(*) AS [computedCol3], region   
(
SELECT  DISTINCT table1.serial1, table1.serial2,
    CASE WHEN table2.serial1 IS NULL THEN 'No' ELSE 'Yes' END AS [computedCol1],
    CASE WHEN table3.serial2 IS NULL THEN 'No' ELSE 'Yes' END AS [computedCol2],
    CASE WHEN table3.serial2 IS NULL AND table2.serial1 IS NULL THEN 'No' ELSE 'Yes' END AS [computedCol3]

FROM    table1
        LEFT JOIN table2
            ON table2.serial1 = table1.serial1
        LEFT JOIN dbo.EPG
            table3.serial2 = table1.serial2
)c
    WHERE region in     (
        '37000','38000','39000','41000','42000','43000','44000','46000','45000','51000','52000','53000','54000'
        '55000','56000','57000','58000','59000','61000','62000','63000','64000','65000','66000','67000','68000',
        '69000','30000','33000','36000','34000','35000','31000','32000','N/A'   )
and [CCA Match Org] in ('yes', 'no')
    group by c.region 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:38:24.787

这就是 UNION 在所有数据库中的工作方式。它不会创建新列，而是包含所有行。

将行转换为列是使用[PIVOT](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)运算符完成的。本质上，PIVOT 按非透视列（在本例中为区域）对行进行分组，并将聚合应用于每个生成的列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T17:40:53.343

您可以像其他答案建议的那样使用 pivot ，也可以将 SUM 与 CASE 结合使用来获得相同的结果。如果你有很多computedcols，这会变得很痛苦。

我在我的例子中使用了 Oracle，但这个概念应该转化为 SQLServer。

例子：

```
SELECT 'A' region, 1 col_num, 10 computed_value FROM DUAL
UNION
SELECT 'A' region, 2 col_num, 11 computed_value FROM DUAL
UNION
SELECT 'A' region, 3 col_num, 12 computed_value FROM DUAL
UNION
SELECT 'B' region, 1 col_num, 20 computed_value FROM DUAL
UNION
SELECT 'B' region, 2 col_num, 21 computed_value FROM DUAL
UNION
SELECT 'B' region, 3 col_num, 22 computed_value FROM DUAL 
```

这将返回：

```
REGION  COL_NUM COMPUTED_VALUE
A           1   10
A           2   11
A           3   12
B           1   20
B           2   21
B           3   22 
```

如果您按如下方式嵌套该查询：

```
SELECT     region,
           SUM (CASE col_num WHEN 1 THEN computed_value ELSE NULL END) compulated_1,
           SUM (CASE col_num WHEN 2 THEN computed_value ELSE NULL END) compulated_2,
           SUM (CASE col_num WHEN 3 THEN computed_value ELSE NULL END) compulated_3
    FROM   (SELECT 'A' region, 1 col_num, 10 computed_value FROM DUAL
            UNION
            SELECT 'A' region, 2 col_num, 11 computed_value FROM DUAL
            UNION
            SELECT 'A' region, 3 col_num, 12 computed_value FROM DUAL
            UNION
            SELECT 'B' region, 1 col_num, 20 computed_value FROM DUAL
            UNION
            SELECT 'B' region, 2 col_num, 21 computed_value FROM DUAL
            UNION
            SELECT 'B' region, 3 col_num, 22 computed_value FROM DUAL)
GROUP BY   region 
```

给你：

```
REGION  COMPULATED_1    COMPULATED_2    COMPULATED_3
A           10          11           12
B           20          21           22 
```

# android - 在 Android 中监控数据包

> ID：10852237
> 
> 赞同：1
> 
> 时间：2012-06-01T14:33:39.157
> 
> 标签：android, android-networking

让我解释一下我正在尝试做些什么来增加视角。我想编写一个应用程序，其功能之一是监控网络流量。即我希望能够读取不同应用程序生成的流量。我想确定应用程序是否生成 HTTP 或 HTTPS 流量。IE。应用程序是否安全。现在，我有一些代码可以在手机上运行 shell 命令。我想知道完成这项任务的最佳方法是什么。

我的一个想法是使用 tcpdump 并将其转储到一个文件中，然后使用一些 bash 对其进行分析。但我不确定 tcpdump 是否本机出现在 android 手机上。

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T11:03:07.330

可能还值得一看 AT&T 的 ARO 工具。它分析网络活动并且是开源的，因此您可能也可以在其中使用一些代码。 [https://developer.att.com/developer/forward.jsp?passedItemId=9700312](https://developer.att.com/developer/forward.jsp?passedItemId=9700312)

# java - Websphere 中的 URL 重写规则

> ID：10852238
> 
> 赞同：0
> 
> 时间：2012-06-01T14:33:42.737
> 
> 标签：java, webserver, websphere

参考上一个问题

[强制浏览器重新加载缓存的 CSS/JS 文件的优雅方法是什么？](https://stackoverflow.com/questions/118884/what-is-an-elegant-way-to-force-browsers-to-reload-cached-css-js-files)

我已根据上次修改的时间戳更改了文件名。即从“scripts/main.js”到“scripts/main.1221534296.js”

我正在使用 WebSphere Application Server 6.1。当收到加载此类资源的请求时，有没有办法在其中定义 URL 重写规则以从生成的文件名中获取真实文件名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:45:05.173

我们在前端 Web 服务器（在我们的例子中是 IBM HTTP Server）中执行所有重写规则。请参阅这些文章以了解如何执行此操作：

*   [http://publib.boulder.ibm.com/httpserv/ihsdiag/plugin_alter_uri.html](http://publib.boulder.ibm.com/httpserv/ihsdiag/plugin_alter_uri.html)
*   [http://publib.boulder.ibm.com/httpserv/ihsdiag/rewrite.html](http://publib.boulder.ibm.com/httpserv/ihsdiag/rewrite.html)

特别注意`[PT]`标志。

我不知道在 WebSphere 本身内创建重写规则的任何方法。您可能需要像[https://github.com/paultukey/urlrewritefilter/这样的网络过滤器](https://github.com/paultuckey/urlrewritefilter/)

# c# - 依赖属性不获取或设置值

> ID：10852243
> 
> 赞同：1
> 
> 时间：2012-06-01T14:34:13.437
> 
> 标签：c#, wpf, user-controls, dependency-properties

我在 WPF 中创建了一个用户控件，并在后面的代码中创建了一些依赖项属性。

我向我的用户控件添加了几个 WPF 控件，其中一个是进度条，所以我尝试做的是公开 Value progressBar 属性，如下所示：

```
 public static readonly DependencyProperty valueProperty = DependencyProperty.Register(
        "Value",
        typeof(Double),
        typeof(MyUserControl),
        new FrameworkPropertyMetadata(
            ValuePropertyCallback));

    private static void ValuePropertyCallback(DependencyObject controlInstance, DependencyPropertyChangedEventArgs args)
    {
        MyUserControl myUserControlInstance = (ProgressControl)controlInstance;
        myUserControlInstance.progressBar.Value = (Double)args.NewValue;
    }

    public Double Value
    {
        get { return (Double)GetValue(valueProperty); }
        set { SetValue(valueProperty, value); }
    } 
```

在 XAML 中我写了这个：

```
<MyUserControl Name="myControl" Value="{Binding ProgressBarValue}" > 
```

但它似乎不起作用，既没有设置也没有获得价值。

我有几个小时的时间来回顾这个，但我无法意识到我做错了什么。

希望你能帮助我，提前谢谢你。

（**注意：** DataContext 是之前定义的，它是正确的，因为这是唯一不起作用的绑定）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:36:50.410

valueProperty <----> "值" 不匹配... (v/V) :=)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T14:45:27.327

您是否尝试过 Mode=TwoWay：

```
<MyUserControl Name="myControl" Value="{Binding ProgressBarValue, Mode=TwoWay}" > 
```

我也`PropertyMetadata`用过`FrameworkPropertyMetadata`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T14:47:48.633

尝试将依赖属性的名称更改为 PascalCased：

```
ValueProperty 
```

您可能还想查看[BindsTwoWayByDefault](http://msdn.microsoft.com/en-us/library/system.windows.frameworkpropertymetadataoptions.aspx)以确保对 DP 的更改写入源对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T17:38:13.813

原来我的问题是我没有实现 INotifyPropertyChanged 接口，所以我所做的更改没有显示出来。但由于我是使用 MVVM 的 WPF 新手，所以我不知道。

但是您只需要创建一个 ObservableObject，然后您的 viewModel 类就必须从它继承。

[这](http://justinmchase.com/2010/08/26/observableobject-for-wpf-mvvm/)是一个创建 ObservableObject 类以及如何从它继承的示例。

# less - LESS css 不在本地 Apache VirtualHost 上编译

> ID：10852245
> 
> 赞同：0
> 
> 时间：2012-06-01T14:34:16.307
> 
> 标签：less

我正在从两个本地 URL 提供一个站点..

**localhost/mysite（使用别名）**

**local.mysite.com（使用虚拟主机）**

它们指向同一个目录。但是，第一个可以很好地编译我的 .less 文件，而第二个则不能。有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:39:26.557

看起来 Less 对开发和生产环境有不同的优化规则。它将开发环境定义为从“localhost”、“127.0.0.1”或“0.0.0.0”提供的任何内容，而其他所有内容都被视为生产环境。由于我的虚拟主机使用不同的域，Less 将其视为 prod 环境，并且不会不断地重新解析 .less 文件。

# php - Facebook API 目前有问题吗？

> ID：10852246
> 
> 赞同：0
> 
> 时间：2012-06-01T14:34:18.213
> 
> 标签：php, facebook, facebook-javascript-sdk, fbconnect

有人注意到他们的登录按钮有问题吗？我的代码正在工作，突然他们今天开始表现得很奇怪，我没有修改任何代码。这是我的代码，可帮助您与我一起调试我可能有什么问题？

我在标题上有这个：

```
<div id="fb-root"></div>
<script>
window.fbAsyncInit = function() {
    FB.init({
    appId: '<?php echo $sofa['fbappid']; ?>',
            status: false,
            cookie: true,
            xfbml: true,
            oauth: true
    });
};
(function() {
var e = document.createElement('script'); e.async = true;
e.src = document.location.protocol +
'//connect.facebook.net/en_US/all.js';
document.getElementById('fb-root').appendChild(e);
}());

function Facebook_login () {
    $("p.form-result").empty();
    FB.getLoginStatus(function(response) {
        if (response.status === 'connected') {
            $.ajax({
                url: '<?php bloginfo('template_directory'); ?>/ajax/fbconnect.php',
                type: 'POST',
                dataType: 'json',
                success: function(data){
                    $('.loading').remove();
                    $('input:submit').attr("disabled", false);
                    if (data.status) {
                        $("p.form-result").html('<span class="success">' + data.message + '</span>');
                        window.setTimeout(function(){location.reload()},3000);
                    }
                }
            });
        }
    });
};
</script> 
```

我有这个我的按钮在哪里（facebook 连接）

```
<div class="form-fbconnect"><div class="fb-login-button" onlogin="Facebook_login()" scope="email"><?php _e('Connect with Facebook','sofa'); ?></div></div> 
```

有些东西看起来不对劲。该按钮以有趣的方式加载，即使它确实登录用户，它也不像以前那样工作。到底是怎么回事？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T14:35:36.300

[您可以在https://developers.facebook.com/live_status](https://developers.facebook.com/live_status)查看 Facebook 平台的当前状态。

# sql - 优化 SQL 查询并动态使用当前日期

> ID：10852249
> 
> 赞同：2
> 
> 时间：2012-06-01T14:34:46.037
> 
> 标签：sql, oracle, oracle11g, oracle-sqldeveloper

我正在尝试优化一个简单的 SQL 查询，想知道是否有人有任何建议。我正在使用 Oracle SQL Developer（我不喜欢）在 Oracle 11g 数据库上进行开发。我正在使用的查询是：

```
SELECT count(*) 
FROM my_table 
WHERE my_date
BETWEEN TO_DATE('2012-5-09T05.00.00','YYYY-MM-DD"T"HH24:MI:SS') 
AND TO_DATE('2012-5-10T04.59.59','YYYY-MM-DD"T"HH24:MI:SS') 
AND my_code='33' 
GROUP BY my_code; 
```

此外，我希望能够通过将日期的一部分更改为当前日期来动态使用此查询，但我希望能够指定小时。所以我想比较类似的东西：

```
getdate() + 'T05.00.00' 
```

我不知道如何做到这一点，getdate() 函数似乎在 SQL Developer 中不起作用/我不知道如何正确使用它。

所以我正在寻找的是优化建议和关于如何动态更改我想要限制我的结果的日期的日月年部分的指针。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T14:44:49.477

要获取当前日期，您可以使用 SYSDATE。要添加 x 小时数，您可以添加 x/24。所以是这样的：

示例：获取当前日期 + 5 小时

```
 SELECT SYSDATE + 5/24 FROM dual 
```

所以在你的例子中：

```
SELECT count(*) 
FROM my_table 
WHERE my_date
BETWEEN sysdate
AND sysdate + 5/24 -- if you want 5 hours ahead, for example
AND my_code='33' 
GROUP BY my_code; 
```

如果您希望能够更改小时数，您可以将此代码制作成一个函数，并将小时数和代码作为变量传递。

像这样的东西：

```
CREATE FUNCTION myfunc
(
   p_num_hours INT
 , p_my_code VARCHAR
) RETURN INT
AS
  l_ret INT;
BEGIN
   SELECT count(*) 
   INTO l_ret
   FROM my_table 
   WHERE my_date
   BETWEEN sysdate
   AND sysdate + p_num_hours/24
   AND my_code=p_my_code 

   RETURN l_ret;
END; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T18:43:17.557

作为通过诸如“5 / 24”之类的表达式添加小数天的替代方法，您可能希望使用 INTERVAL 常量。例如：

```
SELECT count(*)
  FROM my_table
  WHERE my_date BETWEEN (TRUNC(SYSDATE) + INTERVAL '5' HOUR)
                    AND (TRUNC(SYSDATE) + INTERVAL '1' DAY +
                          INTERVAL '5' HOUR - INTERVAL '1' SECOND) AND
        my_code='33'
  GROUP BY my_code 
```

我喜欢使用 INTERVAL 常量，因为很清楚这些常量代表什么。对于小数天常数，我有时会感到困惑（'当然，我有时会感到困惑，无论如何...... :-)

分享和享受。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T14:45:40.553

如果我理解正确，类似

```
 select count(*) 
    from my_table 
   where trunc(my_date) = trunc(sysdate)
     and my_code = '33' 
group by my_code; 
```

或者

```
 select count(*) 
    from my_table 
   where my_date
 between sysdate and sysdate + 5/24
     and my_code = '33' 
group by my_code; 
```

HTH。

亚历山德罗

# objective-c - 如何构建单个 .a（Cocoa Touch 静态库）

> ID：10852251
> 
> 赞同：2
> 
> 时间：2012-06-01T14:34:57.000
> 
> 标签：objective-c, ios, cocoa-touch, xcode4

我有一个 Objective-C Cocoa Touch 静态库，它（取决于架构/目标 - 即 MyProject > iOS Device 或 MyProject > iPhone 5.1 Simulator）构建特定的 libMyProject.a 存档，我可以重复使用/与其他项目共享。通常它工作正常，但是，我必须为 iPhone 5.1 模拟器构建并在另一个项目中使用这个 libMyProject.a，但前提是*这个*另一个项目要在模拟器中运行。如果尝试使用此 .a 但为 iOS 设备构建另一个项目，我会收到构建错误，声称该库不是为此项目设置构建/链接的。

所以问题是，我如何构建“统一”的 Cocoat Touch 静态库的 libMyProject.a，无论我如何构建其他项目，我都可以在其他项目中重复使用它？

我希望这一切都有意义，或者如果没有，我会很乐意澄清。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:45:02.137

你应该看看[GitHub 上的 iOS 通用框架](https://github.com/kstenerud/iOS-Universal-Framework)。

# linux - 正在运行的系统中 pthread_mutex 的数量

> ID：10852253
> 
> 赞同：0
> 
> 时间：2012-06-01T14:35:01.393
> 
> 标签：linux, kernel

我有一个奇怪的问题。我必须计算运行系统中 pthread_mutex 的数量，例如，debian、ubuntu、微控制器中的系统等。我必须在没有 LD_PRELOAD、中断、函数重载等的情况下进行。我必须在随机时间计算它。有人知道我该怎么做吗？你能看到我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:42:42.740

计算线程数：

`ps -eLf`将为您提供当前在系统上运行的所有线程和进程的列表。

但是，您要求提供已在系统上执行的所有线程的列表，大概是因为过去的某个任意时间点 - 您确定这就是您的意思吗？您可以将 ps 作为 cron 作业运行并每 X 分钟轮询一次系统，但是您会错过在作业之间诞生和死亡的线程。您还需要处理大量数据。

要计算互斥锁，这是不可能的

# python - 在谷歌地图上将 lat/lng 投影到像素 x,y

> ID：10852255
> 
> 赞同：1
> 
> 时间：2012-06-01T14:35:08.017
> 
> 标签：python, google-maps, gis, proj

在 python 中，我想将 lat/lng（在 epsg 4326 中）转换为谷歌地图像素中的 x、y（假设最接近的缩放级别）。

`pyproj`让我使用如下代码在投影空间之间进行转换：

```
>>> p1 = pyproj.Proj(init='epsg:4326')
>>> p2 = pyproj.Proj(init='epsg:3857')
>>> pyproj.transform(p1, p2, 10, 10)
>>> pyproj.transform(p1, p2, 10, 10)
(1113194.9079327343, 1118889.9748579597) 
```

我不确定的是用于获取 x、y 像素的正确投影。

此页面上有转换的 PHP 实现：http: [//www.appelsiini.net/2008/11/introduction-to-marker-clustering-with-google-maps](http://www.appelsiini.net/2008/11/introduction-to-marker-clustering-with-google-maps)

```
define('OFFSET', 268435456);
define('RADIUS', 85445659.4471); /* $offset / pi() */

function lonToX($lon) {
    return round(OFFSET + RADIUS * $lon * pi() / 180);        
}

function latToY($lat) {
    return round(OFFSET - RADIUS * 
            log((1 + sin($lat * pi() / 180)) / 
            (1 - sin($lat * pi() / 180))) / 2);
} 
```

与其在 python 中手动编码转换，我更愿意使用 pyproj，因为它会更灵活，并且更容易反转转换。

这些是实现在样本点 (10, 10) 上给出的值：

```
>>> lon_to_x(10)
283348536.88889694

>>> lat_to_y(10)
253446080.30134577 
```

# eclipse - 在 Eclipse 的工作区中快速查找字段或方法

> ID：10852256
> 
> 赞同：44
> 
> 时间：2012-06-01T14:35:08.650
> 
> 标签：eclipse, keyboard-shortcuts

`Ctrl(cmd)`我发现使用 Eclipse 上的+快捷方式在类中查找成员字段或方法非常有用`o`（并再次使用它从超类中获取成员字段或方法）。

但是，我想知道是否有类似的方法可以在项目和/或工作区中快速搜索您知道名称但不知道其位置的字段或方法（类似于查找类型`Ctrl(cmd)`+ `Shift`+`T`或资源`Ctrl(cmd)`++ `Shift`) `R`。

如果不可用，我可以在哪里申请？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-12-16T10:32:31.733

`ctrl+o`( `cmd+o`) 打开快速大纲，您可以在其中搜索当前类中的方法。再次按下`ctrl+o`将搜索范围扩展到完整的类层次结构。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-06-01T14:39:31.393

我所知道的最接近的是 Java Search，它允许您指定搜索方法、字段、类等。如果您在 Java 或 Java Browsing 透视图中，`Ctrl`+`H`将打开 Search 对话框，其中 Java Search 作为选择的类型。

如果您想请求功能或增强功能，请将其输入[Eclipse 的 Bugzilla](https://bugs.eclipse.org/bugs/)。请记住，功能请求的积压是**巨大**的，因此让您注意到的最有效方法是主动提交补丁。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-07T08:23:10.930

有了 ，`ctrl+h`您将有更多的搜索选项。

在 java 搜索选项下，您可能会找到搜索`type`, `method`, `package`, `constuctor`, `field`.

您还可以找到“限制到”选项来缩小搜索结果并获得精确的搜索结果！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T14:39:51.900

我知道的最快方法是使用`ctrl+h`来调出 Java 搜索对话框。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-15T13:42:01.337

如果您使用的是 mac`cmd + shift + l`将打开一个搜索框，您可以在其中搜索整个项目中的任何变量或方法。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-10-11T07:47:24.387

`ctrl+h` 将弹出 java 搜索选项。输入您的字符串并查看。它也有不同的模式，比如`.java`, `.jsp`，然后选择范围然后搜索。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2019-07-08T20:42:55.047

在 Eclipse 中没有办法做到这一点。当您搜索 JAR 中的方法时，Eclipse 不会找到它，除非您已经打开了该文件夹。

你必须玩弄它并使用间接的方法来找到方法。

# javascript - jsonresult 错误结果

> ID：10852257
> 
> 赞同：0
> 
> 时间：2012-06-01T14:35:11.847
> 
> 标签：javascript, asp.net-mvc-3

我在我的控制器中使用以下操作，我正在尝试在 jq.grid 中显示房间数；

```
 public JsonResult Incercare() 
    {
        DBContext.Current.Open();
        var data = new
    {
        Title="Total",
        Rezervari = Reservation.SelectByReservationDate(5).FirstOrDefault().NumarRezervari   
    };
        var result = new JsonResult(){Data = data,JsonRequestBehavior =JsonRequestBehavior.AllowGet};
        return result;
     } 
```

这是我的看法：

```
 @model LicentaTest.Models.Reservation

    @{
    ViewBag.Title = "Incercare";
    }

    <script type="text/javascript">
    $(function () {
    var requestUrl = '@Url.Action("Incercare","Grafice")';

    $("#cartResults").jqGrid({

        url: requestUrl,
        datatype:'json',
        mtype: 'GET',
        emptyrecords: "No results",
        colNames: ['Title','Rezervari'],
        colModel: [
                        { name: "Title", width: 350, editable: false, searchoptions: {}, index: "Title" },
                        { name: "Rezervari", width: 100, editable: false, searchoptions: {}, index: "Rezervari"}
                        ],
        pager: $('#cartPager'),
        rowList: [],        // disable page size dropdown
        pgbuttons: false,     // disable page control like next, back button
        viewrecords: false,    // disable current view record text like 'View 1-10 of 100' 
        sortname: 'id',
        sortorder: 'asc',
        loadonce: false,
        sortable: true,
        scrollrows: true,
        height: 300,
        pgtext: null,
        hoverrows: false,
        footerrow: true,
        userDataOnFooter: true,
        emptyDataText: "Your Cart is Empty"

         });
        });
       </script>
       <div class="styler">
       <fieldset class="ui-widget">
       <legend class="ui-state-legend-default ui-corner-top ui-corner-bottom">Review Your Cart  </legend>
       <div id="update-message-disp" class="ui-state-highlight ui-corner-all" style="margin-top: 20px; padding: 0 .7em;width: 500px">
        <p><span class="ui-icon ui-icon-info" style="float: left; margin-right: .3em;">     </span><strong>Cart modified</strong><br />
        </p>
        </div>
        <br />
        <table id="cartResults">
        </table>
        <div id="cartPager">
        </div>
         </fieldset>
        </div> 
```

但不是得到这样的东西： ![在此处输入图像描述](../Images/1b05b4badb466c9d40318cec45ffb6e1.png)

我明白了：

![在此处输入图像描述](../Images/d907635a7dba6148fcdcd80a361643fa.png)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:40:47.577

这是因为在您的控制器中，您返回一个将**json**`JsonResult`对象呈现给视图的事实。 相反，您应该返回or并确保将对象作为参数传递给它。 **`ViewResult``PartialViewResult`**

# symfony - symfony2 渲染表单的一部分

> ID：10852270
> 
> 赞同：1
> 
> 时间：2012-06-01T14:36:01.643
> 
> 标签：symfony

首先，感谢所有关注这个问题的人。我有一个像 userFormType 这样的 FormType。

```
class UserFormType extends AbstractType{
    public function buildForm(FormBuilder $builder, array $options)
    {
         $builder->add('address','collection', ....)
                 ->add('group','entity',....)
                 ->add('companies','collection',....);
         ...
    }

} 
```

所以你看我在用户表单中有两个集合。我创建表格并设置公司。当我只想修改公司和地址的信息，而不是与集团联系时。所以我必须呈现一个用户表单，而不是一些公司表单或地址表单。所以我写了一个这样的控制器：

```
 $user= $this->get('security.context')->getToken()->getUser();
    $form =$this->createForm(new UserForm(),$user);
    $request = $this->get('request');
    if ('POST' == $request->getMethod()) {
         $form->bindRequest($request);
        if ($form->isValid()) {
            $em = $this->getDoctrine()->getEntityManager();
            $em->persist($user);
            $em->flush();
            ....
        }

     } 
```

当然，我不想修改组，所以在树枝模板中，我不渲染组。表单正确呈现，但每次我尝试提交时，它都会告诉我：

```
 Argument 1 passed to ... User->setGroup() must be an instance of Group ... null given 
```

所以我问，我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:08:06.707

The error specifically is because your method definition in User is probably:

```
public function setGroup(Group $group); 
```

but in order to set it null it would need to be:

```
public function setGroup(Group $group = null); 
```

That will fix the error but it still might not be what you want functionality wise. My question is, why have the group field on the form if you are not using it? You may need another form type or pass an option to the form to not include the group field during edits.

# jsp - 为什么 iframe 让服务器而不是客户端发出请求

> ID：10852285
> 
> 赞同：0
> 
> 时间：2012-06-01T14:36:54.450
> 
> 标签：jsp, jakarta-ee, tomcat, iframe, internet-explorer-8

我有一个像这样的结构 jsp/iframe/jsp/img src=servlet

在访问日志中，它显示服务器的 ip 地址使 servlet 请求不是客户端？Servlet 地址是集群地址的上下文变量，客户端在与特定服务器的粘性会话上，但 iframe 不在，如果会话数据到达另一台服务器，则不存在会话数据。

Tomcat 6 和 IE8

谢谢

```
Server #1 log
192.**.***.*** - agt**** [01/Jun/2012:09:23:55 -0500] "POST /membership
/GenerateSignatureServlet HTTP/1.1" 200 34

192.**.***.*** - agt**** [01/Jun/2012:09:23:55 -0500] "GET /membership
/printpage.jsp?type=newmem&trh=false HTTP/1.1" 200 997

192.**.***.*** - agt**** [01/Jun/2012:09:23:55 -0500] "GET /membership/js/newmember.js
HTTP/1.1" 304 -
192.**.***.*** - agt**** [01/Jun/2012:09:23:55 -0500] "GET /membership/js/prototype- 
1.6.0.2.js HTTP/1.1" 304 -
192.**.***.*** - agt**** [01/Jun/2012:09:23:55 -0500] "GET /membership/theme
/FBMembership.css HTTP/1.1" 304 -
192.**.***.*** - agt**** [01/Jun/2012:09:23:55 -0500] "GET /membership/dhtmlmodal
/windowfiles/dhtmlwindow.css HTTP/1.1" 304 -
192.**.***.*** - agt**** [01/Jun/2012:09:23:55 -0500] "GET /membership/theme 
/signature.css HTTP/1.1" 304 -
192.**.***.*** - agt**** [01/Jun/2012:09:23:55 -0500] "GET /membership
/signaturepageprint.jsp?trh=false HTTP/1.1" 200 51441

Server #2 log
172.**.***.*** - agt**** [01/Jun/2012:09:23:56 -0500] "GET /membership  

/GenerateSignatureServlet;jsessionid=91FFBB3EAA73F3833BA507B7B9B6B317?
action=generateSigImg     HTTP/1.1" 200 39466

Back to server #1
192.***.***.*** - agt**** [01/Jun/2012:09:23:58 -0500] "POST /membership/MoveToFileNet?action=mainprocess&type=mainprocess HTTP/1.1" 200 9 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T13:55:55.413

如果您有一个使用 HTML 并从该标记生成 PDF 的基于服务器的组件，那么从服务器请求 PDF 可能会导致服务器转机并向其自身（或其他成员）发出环回请求。集群）以获取 HTML。

如果您不喜欢看到显示集群“调用自身”的日志消息，我可以想到一些选项：

1.  当 PDF 生成器调用以获取 HTML 时，提供与代理相关的 HTTP 标头，以便处理 HTML 请求的服务器记录请求，它看起来像是来自其他地方（如客户端）。请注意，运维人员可能不喜欢这个选项，因为请求*确实*来自集群内部，而现在来自外部。

2.  修改您的日志（或连接器）设置，以便以不同的方式记录这些环回请求。如果使用单独的连接器，则可以获得 localhost 通信速度，并且如果使用 HTTPS，则可以完全避免 HTTPS 性能损失。或者，您可以在其他地方记录这些环回请求，这样它们就不会“污染”您的日志。

3.  通过在不发出 HTTP 请求的情况下创建 HTML 标记，重新设计生成 PDF 的工作流程。如果您使用的是 JSP，这可能是一个很高的要求，因为您必须让 JSP 编译器/运行程序在 HTTP 请求的上下文之外工作，而这不是它的设计方式。

无论如何，以这种方式记录这些请求有什么问题？

# c++ - 我可以使用这种技术防止破坏抗锯齿规则吗？

> ID：10852295
> 
> 赞同：2
> 
> 时间：2012-06-01T14:37:35.130
> 
> 标签：c++

如果我没记错的话，写入`FastKey::key`然后读取将是未定义的行为`FastKey::keyValue`：

```
struct Key {
    std::array<uint8_t, 6> MACAddress;
    uint16_t EtherType;
};

union FastKey {
    Key key;
    uint64_t keyValue;
}; 
```

但是，有人告诉我，如果我将 char 数组添加到联合中，那么 UB 将被清除：

```
union FastKey {
    Key key;
    uint64_t keyValue;
    char fixUB[sizeof(Key)];
}; 
```

这是真的？

### 编辑

像往常一样，我的理解是错误的。使用我收集的新信息，我认为我可以将密钥作为这样的`uint64_t`值：

```
struct Key {
    std::array<uint8_t, 6> MACAddress;
    uint16_t EtherType;
};

union FastKey {
    Key key;
    unsigned char data[sizeof(Key)];
};

inline uint64_t GetKeyValue(FastKey fastKey)
{
    uint64_t key = 0;
    key |= size_t(fastKey.data[0]) << 56;
    key |= size_t(fastKey.data[1]) << 48;
    key |= size_t(fastKey.data[2]) << 40;
    key |= size_t(fastKey.data[3]) << 32;
    key |= size_t(fastKey.data[4]) << 24;
    key |= size_t(fastKey.data[5]) << 16;
    key |= size_t(fastKey.data[6]) << 8;
    key |= size_t(fastKey.data[7]) << 0;
    return key;
} 
```

我怀疑这将与原始版本一样快。随时纠正我。

### 更新

@Steve Jessop 我实施了一个[快速基准测试](http://ideone.com/DlXDo)来测试 memcpy 与我的解决方案的性能。我不是基准测试专家，因此代码中可能存在愚蠢的错误导致错误的结果。但是，如果代码正确，那么 memcpy 似乎要慢得多。

**注意：基准测试似乎是错误的，因为计算快键时间的时间始终为零。**我看看能不能修好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T14:44:42.847

不，`uint64_t`如果您有`Key`对象，则阅读 a 仍然存在 UB。UB 不是读取 a `char`，因为`char`在别名规则中有一个例外。添加数组不会将异常传播到其他类型。

编辑中的版本看起来不错（尽管我会使用`unsigned char`），但现在它比仅使用`reinterpret_cast`from `Key*`to`unsigned char*`或 a更复杂`memcpy`。

# delphi - 调用一个 dwscript 过程，其中一个类作为来自 delphi 的参数

> ID：10852297
> 
> 赞同：4
> 
> 时间：2012-06-01T14:37:46.823
> 
> 标签：delphi, dwscript

如何从 delphi 调用以类为参数的 DWScript 过程？

前任：

DWScript 方面：

```
procedure Proc1(AParam: TObject);
begin
  // do something useful
end; 
```

德尔福方面：

```
var
  Obj: TObject;

Exec.Invoke('Proc1', [obj]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T06:16:53.580

您需要将 Delphi 端对象包装到脚本端对象中，并在需要时创建一个。

对于暴露，您可以使用 TdwsUnit 并手动暴露（这可以保护 Delphi 端的类免受脚本错误操作），或者使用 RTTI 暴露（但在这种情况下，脚本端的错误将能够直接影响Delphi，因此可能会使主机崩溃，因此，如果您知道您的课程已经安全，或者您不关心沙盒，请仅使用 RTTI）。

如果您只需要简单的暴露，更简单的方法是使用 RTTI 环境（参见 URTTIExposeTests 中的 TRTTIExposeTests.EnvironmentTest），但请记住上述关于 RTTI 和安全/沙盒的说明。

更复杂的方法是使用类似的代码创建脚本端对象

`scriptObj := Info.Vars['TScriptSideClassName'].Method['Create'].Call([param1, param2]);`

然后手动调整它的 ExternalObject 属性。

您可能还需要担心只创建一次脚本端对象（如果您希望脚本端对象比较像往常一样工作）以及清理（即，如果 Delphi 端对象在脚本被释放时会发生什么情况仍在运行，或者当释放脚本端对象时谁应该负责释放 Delphi 端对象），以及其他微妙之处（当/如果 Delphi 获得某种形式的自动内存管理时，这将变得更简单）。

# ruby-on-rails - 控制器上的 RoR 过滤器作为此 SQL

> ID：10852298
> 
> 赞同：0
> 
> 时间：2012-06-01T14:37:47.693
> 
> 标签：ruby-on-rails, action-filter

如何在 Ruby on Rails 中的控制器上编写过滤器，相当于此 SQL 代码

```
select * from persons where persons.category = 'developers' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T14:49:05.570

用这个：

```
before_filter :nerds_only

private

def nerds_only
  @people = Person.where(:category => 'developers')
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T06:16:18.170

您可能需要考虑创建一个命名范围来获取书呆子：

```
class Person < ActiveRecord::Base
  scope :developers, where(category: 'developers')
end 
```

在您的控制器中：

```
before_filter :developers_only

private

def developers_only
  @people = Person.developers
end 
```

# c# - 如何从 C# 中的用户客户端获取 IP 地址？

> ID：10852305
> 
> 赞同：0
> 
> 时间：2012-06-01T14:38:18.193
> 
> 标签：c#, logging, client, ip

我正在使用我在[Get public IP using DynDNS and WebRequest C#中找到的这段代码](https://stackoverflow.com/questions/10597655/get-public-ip-using-dyndns-and-webrequest-c-sharp)

获取 IP 地址。但我只是从服务器获取 IP 地址，而我需要的是来自连接到我的 Web 应用程序的用户的 IP 地址。

```
String direction = "";
WebRequest request = WebRequest.Create("http://checkip.dyndns.org/");
using (WebResponse response = request.GetResponse())
using (StreamReader stream = new StreamReader(response.GetResponseStream()))
{
    direction = stream.ReadToEnd();
}

//Search for the ip in the html
int first = direction.IndexOf("Address: ") + 9;
int last = direction.LastIndexOf("</body>");
direction = direction.Substring(first, last - first); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:42:05.260

如果您正在运行 Web 应用程序，并且想要您的“客户端”IP，[则需要使用 UserHostAddress](http://msdn.microsoft.com/en-us/library/system.web.httprequest.userhostaddress.aspx)。

```
var userAddress = HttpContext.Current.Request.UserHostAddress; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T05:58:15.690

首先获取上下文：

```
HttpListenerContext ctx = m_HttpListener.GetContext(); 
```

接受请求后，客户端信息可在`ctx`. 用于`ctx`获取客户端 IP 地址：

```
string IP = ctx.Request.RemoteEndPoint.Address.ToString(); 
```

# java - GateIn：登录 servlet 的过滤器

> ID：10852309
> 
> 赞同：0
> 
> 时间：2012-06-01T14:38:32.790
> 
> 标签：java, servlets, servlet-filters, gatein

我需要在 login.jsp 调用的登录 servlet 之前和之后实现一些逻辑。

所以我为 url /login 编写了一个过滤器来做到这一点。我需要获取一些操作的用户配置文件，所以我创建了这个 LoginFilter 类：

```
public class LoginFilter implements Filter {
    private static Logger logger = Logger.getLogger(LoginFilter.class);

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        String username = httpRequest.getParameter("username");
        String password = httpRequest.getParameter("password");

        chain.doFilter(request, response);

        PortalRequestContext context = PortalRequestContext.getCurrentInstance();

        if (context == null)
            logger.info("PortalRequestContext is NULL");
        else {
            String userId = context.getRemoteUser();

            if (userId == null || userId.equals(""))
                logger.info("Login failed, IP:" + httpRequest.getRemoteAddr());
            else
                logger.info("Login executed, username:" + userId);
        }
    } 
```

问题是“上下文”（PortalRequestContext）始终为空。我做错了什么？这是正确的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-20T08:47:26.080

您可以开发一个 Valve 并将其添加到“门户”webapp (Tomcat/conf/Catalina/localhost/portal.xml) 的上下文文件中。这就是在 GateIN 中为 SSO 扩展所做的，例如：参见[ServletAccessValve](https://github.com/gatein/gatein-sso/blob/master/agent/src/main/java/org/gatein/sso/agent/tomcat/ServletAccessValve.java)

```
ServletAccess.setRequestAndResponse(request, response); 
```

然后，使用以下命令在[SSOLoginModule](https://github.com/gatein/gatein-sso/blob/master/agent/src/main/java/org/gatein/sso/agent/login/SSOLoginModule.java)中访问请求：

```
// Tomcat way (Assumed that ServletAccessValve has been configured in context.xml)
  else
  {
     request = ServletAccess.getRequest();
  } 
```

对于 JBoss，它更简单，你只需要使用

```
javax.security.jacc.PolicyContext.getContext(HttpServletRequest.class.getName()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T08:17:48.027

如果您使用的是 GateIn，您可以尝试使用

```
org.exoplatform.portal.webui.util.Util.getPortalRequestContext().getRequest() 
```

ce

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-31T13:38:26.333

您可以添加一个 GateIN 过滤器，如[这里](http://docs.jboss.org/exojcr/1.14.9-GA/developer/en-US/html/chapter-eXoJCRWithGateIn.html#JCRWithGateIn.HowToExtendMyGateInInstance.FAQ)详述。

您可以在此过滤器中静态使用 ConversationState 来获取当前用户名：

`ConversationState.getCurrent().getIdentity().getUserId();`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-28T02:19:39.903

在登录时，`PortalRequestContext`尚未创建，但您可以通过调用获取远程用户`HttpServletRequest#getRemoteUser()`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-05T08:52:01.380

只需使用对话状态对象：

```
// Gets the current user id
ConversationState conversationState = ConversationState.getCurrent();

org.exoplatform.services.security.Identity identity = conversationState.getIdentity();
String userId = identity.getUserId(); 
```

# ruby-on-rails - Rails：如何检查 find_or_initialize 是否正在更新/创建/跳过？

> ID：10852313
> 
> 赞同：2
> 
> 时间：2012-06-01T14:39:00.270
> 
> 标签：ruby-on-rails

我有从 CSV 更新数据库中数据的方法。

```
csv_text = File.read("#{Rails.root}/db/seed/books.csv")
csv = CSV.parse(csv_text, :headers => :first_row)
csv.each { |row|
row = row.to_hash.with_indifferent_access.to_hash.symbolize_keys
row.delete_if { |key, value| value.nil? }
book = Book.find_or_initialize_by_name(row[:name])
book.update_attributes!(row) 
```

我如何检查是否将创建或更新记录或什么也没有发生？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T14:44:28.240

要检查是否`book`已更改，请执行以下操作[`changed?`](https://api.rubyonrails.org/classes/ActiveModel/Dirty.html#method-i-changed-3F)：

```
book.changed? 
```

要检查是否`book`有新记录[`new_record?`](https://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-new_record-3F)：

```
book.new_record? 
```

# c# - 分布式深度优先搜索

> ID：10852317
> 
> 赞同：2
> 
> 时间：2012-06-01T14:39:11.477
> 
> 标签：c#, parallel-processing, task-parallel-library, depth-first-search

我曾尝试在 c# 中实现深度优先搜索，但我不确定如何以分布式计算方式执行此操作。如果你们能在这方面帮助我，我将非常感激:) 你可以在下面找到我的 DFS 代码

```
public class DFS
{ 
static List<string> traversedList = new List<string>();
static List<string> parentList = new List<string>();

public static void Main(string[] args)
{

    int N = 100;
    int M = N * 4;
    int P = N * 16;

    Stack newstack = new Stack();

    List<string> global_list=new List<string>();

    StreamReader file = new StreamReader("my input file");

    string text = file.ReadToEnd();

    string[] lines = text.Split('\n');

    string[][] array1 = new string[lines.Length][];

    for (int i = 0; i < lines.Length; i++)
    {
        lines[i] = lines[i].Trim();
        string[] words = lines[i].Split(' ');

        array1[i] = new string[words.Length];

        for (int j = 0; j < words.Length; j++)
        {
            array1[i][j] = words[j];
        }
    }

    StreamWriter sr = new StreamWriter(args[0]);

    for (int i = 0; i < array1.Length; i++)
    {
        for (int j = 0; j < array1[i].Length; j++)
        {
            if (j != 0 )
            {
                sr.Write(array1[i][0] + ":" + array1[i][j]);
                Console.WriteLine(array1[i][0] + ":" + array1[i][j]);
                sr.Write(sr.NewLine);
            }
        }

    }

    int start_no = Convert.ToInt32(args[args.Length-1]);

    traversedList.Add(start_no.ToString());
    parentList.Add("root");
    dfs(array1, start_no);

    for (int z = 0; z < traversedList.Count; z++)
    {
            Console.WriteLine(traversedList.ElementAt(z) + " "+parentList.ElementAt(z)+" "+(z+1));
     }
    Console.ReadLine();
}

private static void dfs(string[][] array, int point)
{
    for (int z = 1; z < array[point].Length; z++)
        {
            if ((!traversedList.Contains(array[point][z])))
            {
                traversedList.Add(array[point][z]);
                parentList.Add(point.ToString());
                dfs(array, int.Parse(array[point][z]));
            }
        }
        return;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T02:28:20.200

你应该从计算机国际象棋（现在演变成世界冠军计算机游戏玩家）的世界中阅读文献。他们已经进行分布式深度优先搜索大约 30 年了，并且有很多想法。正确处理很棘手，因为您必须在不知道特定分支可能包含多少工作的情况下平均分配工作。

看看[Monty Newborn](http://en.wikipedia.org/wiki/Monty_Newborn)或麦吉尔大学，这在大约 10 年前似乎是这方面的温床。

And of course, GIYF: "distributed depth first search" produced a reference to this paper: [Distributed Algorithms for Depth-First Search](http://dimacs.rutgers.edu/~havas/TR0283.pdf). I'd guess it contains lots of ideas from the computer chess world.

The problems for *shared memory" DFS a bit less difficult; you don't have to send messages to your distributed helpers, you can simply pass a pointer :-} It helps to have a language which provides you with parallelism and manages explosive parallelism growth that can occur if your program forks on every branch. I offer an [example 4x4 N-puzzle solver](https://stackoverflow.com/a/1866161/120163) built in a parallel programming language I designed. (This example was one of my earliest SO posts!).

# ruby - 将文件包含到 ruby testScript

> ID：10852318
> 
> 赞同：0
> 
> 时间：2012-06-01T14:39:12.137
> 
> 标签：ruby, selenium, webdriver

我有多个 ruby​​ 测试用例`selenium-webdriver`，所有文件都共享相同的用户名和密码来登录我的帐户。有没有办法创建一个全局文件并将该文件包含在这些测试用例中，而不是一遍又一遍地输入它们，比如 `#include`？

以下是需要在其他测试用例之间共享的代码部分：

```
def setup

  @driver = Selenium::WebDriver.for :firefox
  @base_url = "http://localhost:3000/"
  @driver.manage.timeouts.implicit_wait = 30
  @verification_errors = []

  @facebook_ID = "xxxxxxxxxx@xxx.xxx"
  @facebook_password = "xxxxxxx"
  @facebook_receiver_friend = "John Smith"

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:48:06.257

有多种方法可以做到这一点。你可以使用

```
require 'setup' 
```

`setup.rb`具有所有设置变量/功能的通用文件在哪里。

您也可以使用 YAML 文件。更多信息[在这里](http://yaml.org/YAML_for_ruby.html)。可以定义所有配置属性的位置。

也把它放在文件的顶部`$:.unshift '.'`。这样您的测试文件就可以“发现”您的 setup.rb 文件，该文件可从主目录路由。

* * *

注意 - 即使您将文件保存`setup.rb`为仅需要的`setup`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:05:21.800

我得到了答案：

```
eval File.open('setup.dat').read 
```

这将在我需要的任何地方插入我所拥有`setup.dat`的文本。

# if-statement - javacc if 语句

> ID：10852324
> 
> 赞同：0
> 
> 时间：2012-06-01T14:39:24.710
> 
> 标签：if-statement, javacc

我在 javacc 中写了 if 语句，如果条件为假，不知道如何忽略主体首先我声明了两个对象类 Token 和布尔变量，接下来我检查什么返回方法条件（），接下来我想跳过块的其余部分当条件为假时。怎么做？

```
void ifElse() :
            {
              Token start;
              Token next;
              boolean cond = false;
            }
            {
              {
                start = token;
              }
              < IF > < LB> cond = condition() < RB> < LP>
              {
                if (cond == false)
                {
                  String tok = (String) token.image;
                  while (tok.equals("}"))
                  {
                    token = token.next;
                  }

                }
              }
              (
                ifElse()
              | declaration()
              )*

              < RP> 
              (< ELSE > < LP> < RP >)?
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T10:56:45.280

我已经重新配置了您的代码，它几乎可以正常工作。避开身体但不停止。

```
 `void ifElse() :
        {
          boolean cond = false;
        }
        {
          < IF > < LB> cond = condition() < RB> < LP>
          {
            if (cond == false)
            {

              while (!token.image.equals("}"))
              {
                token = getNextToken();
              }

            }
          }
          (
            ifElse()
          | declaration()
          )*

          < RP> 
          (< ELSE > < LP> < RP >)?
        }` 
```

# sql-server - 在 Windows Server 2008 R2 上安装 SQL Server 2012 时，需要哪些 Windows Server 角色（如果有）？

> ID：10852326
> 
> 赞同：1
> 
> 时间：2012-06-01T14:39:29.053
> 
> 标签：sql-server, sql-server-2012

为我提供安装 SQL 2012 的服务器已经/启用了应用程序服务器和 Web 服务器 (IIS) 角色。

上面提到的操作系统是带有最新 SP/Patch 的 Windows Server 2008 R2。

为了最佳实践/安全/最低表面积，我想知道是否应该启用这些角色。

在尽可能合理地搜索互联网并在未安装角色的服务器上成功运行系统配置检查器工具之后 - 我已经相信除了 .NET 3.5 安装要求（尽我所能涵盖在 Windows 功能中）告诉）没有其他要求，唯一的例外是在某些情况下 SSRS 安装的 IIS 角色。

我只是找不到任何明确的建议来建议保持角色不变或删除它们。

这是我在试图弄清楚这一点时广泛浏览的一个资源 - [http://msdn.microsoft.com/en-us/library/bb500469.aspx](http://msdn.microsoft.com/en-us/library/bb500469.aspx)

感谢您的想法、经验和/或参考。

仅供参考 - 我在 Twitter 上的 #sqlhelp 标签上提出了带有链接的问题，并得到了 Denny Cherry 的回复，即答案是“无”。（谢谢丹尼！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T14:56:20.817

我在 Twitter 上的 #sqlhelp 标签上提出了这个问题，并得到了[MrDenny](https://stackoverflow.com/users/4197/mrdenny)的回复，即答案是“无”。（谢谢丹尼先生！）

# gstreamer - Gstreamer 原始视频 AVI 无法在媒体播放器中播放

> ID：10852328
> 
> 赞同：0
> 
> 时间：2012-06-01T14:39:40.097
> 
> 标签：gstreamer, avi

我在 Windows XP 上使用 GStreamer 将原始 (YUV) 视频流写入 AVI 文件序列。我正在使用的管道的简化版本如下所示：

gst-launch -e -v videotestsrc 模式=smpte100 num-buffers=10 水平速度=1 ！视频/x-raw-yuv，格式=（fourcc）UYVY，宽度=（int）640，高度=（int）480，帧率=30/1！ffmpeg色彩空间！！multifilesink next-file=key-frame location="frame_%d.avi" index=1

我遇到的第一个问题是第一个写入的文件具有文件名“frame_d.avi”，即“%d”被解释为“d”，因此索引没有被替换到字符串中。我猜这是Unicode问题？目前我可以通过修改文件接收器的源代码来解决这个问题，但如果可能的话，我宁愿不这样做。

我遇到的第二个问题是，当我尝试在 Windows Media Player 中查看 AVI 文件时，我收到以下消息：

“Windows Media Player 无法播放该文件。播放器可能不支持文件类型或可能不支持用于压缩文件的编解码器。”</p>

当我尝试在管道中使用 filesink 元素（而不是 multifilesink）时，我可以在媒体播放器中查看视频。

使用 Hex 编辑器查看文件内容，我可以看到在使用 multifilesink 时，已写出 AVI 标头，然后是 YUV 数据：

5249464610030000415649204c495354f80200006864726c6176696838000000 3582000080969800000000000000000000000000000000000100000000000000 80020000e0010000000000000000000000000000000000004c49535494020000 7374726c73747268380000007669647359555932000000000000000000000000 010000001e000000000000000000000000000000000000000000000000000000 0000000073747266280000002800000080020000e00100000100100059555932 00b00400000000000000000000000000000000004a554e4b1802000004000000 0000000030306462000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000亿0000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 00000000000000000000000000000000000000004c495354100000006f646d6c 646d6c6804000000000000004c495354040000006d6f76693030646200600900 eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80 eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80 eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80 eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80 eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80 eb80eb80eb80eb80eb80eb80eb80eb80eb80eb80eb48d289d210d292d210d292 d210d292d210d292d210d292d210d292d210d292d210d292d210d292d210d292 d210d292d210d292d210d292d210d292d210d292d210d292d210d292d210d292 d210d292d210d292d210d292d210d292d210d292d210d292d210d292d210d292 d210d292d210d292d210d292d210d292d210d292d210d292d210d292d210d292 d210d292d210d292d210d292d210d292d210d292d210d292d210d292d210d292 d210d292d210d292d210d292aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10 aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10 aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10 aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10 aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10 aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10aaa6aa10 aaa6aa1091369122913691229136912291369122913691229136912291369122 9136912291369122913691229136912291369122913691229136912291369122 9136912291369122913691229136912291369122913691229136912291369122 9136912291369122913691229136912291369122913691229136912291369122 9136912291369122913691229136912291369122913691229136912291369122 91369122913691229136912291369122913691229136912291806a806aca6ade 6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade 6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade 6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade 6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade 6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade6aca6ade 6aca6ade6aca6ade6aca6ade6aca6ade6a9251e7515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f029f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296ef0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f029f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296ef0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f029f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f029f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0515a51f0 515a51f0515a51f029f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296ee29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296ee29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e 29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e29f0296e

当我使用文件接收器（并且播放正确）时生成的标题如下所示：

5249464608c45d00415649204c495354f80200006864726c6176696838000000 35820000b840190100000000100000000a000000000000000100000000000000 80020000e0010000000000000000000000000000000000004c49535494020000 7374726c73747268380000007669647359555932000000000000000000000000 010000001e000000000000000a00000000600900000000000000000000000000 0000000073747266280000002800000080020000e00100000100100059555932 00b00400000000000000000000000000000000004a554e4b1802000004000000 0000000030306462000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000亿0000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 00000000000000000000000000000000000000004c495354100000006f646d6c 646d6c68040000000a0000004c49535454c05d006d6f76693030646200600900000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 00000000000000000000000000000000000000004c495354100000006f646d6c 646d6c68040000000a0000004c49535454c05d006d6f76693030646200600900000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 00000000000000000000000000000000000000004c495354100000006f646d6c 646d6c68040000000a0000004c49535454c05d006d6f76693030646200600900000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 00000000000000000000000000000000000000004c495354100000006f646d6c 646d6c68040000000a0000004c49535454c05d006d6f76693030646200600900000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000000000000000 00000000000000000000000000000000000000004c495354100000006f646d6c 646d6c68040000000a0000004c49535454c05d006d6f766930306462006009000004c495354100000006f646d6c 646d6c68040000000a0000004c49535454c05d006d6f766930306462006009000004c495354100000006f646d6c 646d6c68040000000a0000004c49535454c05d006d6f76693030646200600900

数据本身看起来不错；除了 avimux 强制将 UYUV 转换为 YUY2 之外，这意味着我需要修改 avimux 以支持这一点。

为什么 multifilesink 写出的 header 与 filesink 写出的 header 不同，为什么这些差异会阻止视频播放？

提前感谢您的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T17:29:27.347

在 dos 命令提示符上，您需要编写

```
location="frame_%%d.avi" 
```

逃避 % 字符。关于您的实际问题，multifilesink 不适用于混合内容。您可以将其用于无标题内容。avimux 不会在后续部分写入新标头。放置 avimux 可能会更容易！文件接收器组合到一个垃圾箱，在某些情况下，向垃圾箱发送一个 eos，将垃圾箱设置为就绪，更改文件名并将其重新设置为播放。

# oracle - 交换这两列而不使用 Oracle sql 中的更新？

> ID：10852329
> 
> 赞同：0
> 
> 时间：2012-06-01T14:39:43.883
> 
> 标签：oracle

```
Ename     sex
ABC       male
Def       female 
```

男女互换。

输出应该是

```
Male ABC
Female DEF 
```

提前致谢！准备面试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:28:17.863

我假设你有一个定义如下的表：

```
CREATE TABLE EMP
 (ENAME  VARCHAR2(20),
  SEX    VARCHAR2(6)); 
```

并且您有以下行：

```
ENAME          SEX
ABC            male
Def            female 
```

我将进一步假设您问题中的输出是执行的结果

```
SELECT * FROM EMP 
```

现在，回答您的问题 - 先获得 SEX，然后是 ENAME，请尝试以下操作：

```
SELECT SEX, ENAME FROM EMP 
```

如果您尝试连接 SEX 和 ENAME 的值，以便返回单列，请尝试

```
SELECT SEX || ' ' || ENAME AS SEX_AND_NAME FROM EMP 
```

分享和享受。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-16T07:23:22.643

答案如下：假设表名是`EMP`

```
UPDATE TABLE EMP
SET ENAME = SEX,
    SEX = ENAME; 
```

这将交换列的值`ename`而`sex`不是列的位置。

# qt - LGPL 下的 Qt：如何分发对 Qt 源代码的更改？

> ID：10852330
> 
> 赞同：4
> 
> 时间：2012-06-01T14:39:44.217
> 
> 标签：qt

我们在 LGPL 下使用 Qt 开发了一个商业 Qt 应用程序。我们动态链接。我们还对 Qt 中的几个文件进行了一些更改，以更好地满足我们的需求。我意识到根据 LGPL，我必须公开这些更改。

我的问题是这是怎么做到的？

1.  我是否在我的域上设置了一个网页，其中包含可供下载的修改后的源代码？
2.  安装后是否将修改后的源代码分发到客户端目标机器上的文件夹中？
3.  其他方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T14:55:14.450

您只需根据要求提供它们。

它可以是您的网络服务器上的一个文件，可以只是通过电子邮件将它们发送给任何询问的人，您甚至可以将它们提供在软盘上并收费。

理想情况下，如果它是对其他人有用的错误修复或功能，您也可以将更改回馈给 Qt，然后它可能会合并到未来的版本中，然后您就可以使用标准构建。

附言。GPL 的信中说您必须提供创建修改后的构建所需的一切 - 所以完整的 Qt 源代码和构建文件。但是对于像 Qt 这样的大型复杂项目，如果您只修改了几个文件，那么提供这些文件的下载（甚至是针对特定 Qt 版本的差异）会很有用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T18:58:29.733

根据许可证，您需要将您的更改提供给社区，而不仅仅是您的客户。

[最简单的方法是在http://qt.gitorious.org/qt](http://qt.gitorious.org/qt)上分叉主 Qt 存储库并在那里提交您的更改。

# c# - 如何比较和存储比较元素形成一维和二维数组c#？

> ID：10852331
> 
> 赞同：3
> 
> 时间：2012-06-01T14:39:45.910
> 
> 标签：c#, winforms

我在比较数组时感到困惑，我的代码是：

结果是一维数组，而 symboltable1 是二维数组...这些数组至少包含 100、100 个值

```
for (int row = 0; row < symboltable1.GetLength(0); row++)
{
    for (int column = 0; column < symboltable1.GetLength(1); column++)
    {
        for (int we = 0; we < result.Length; we++)
          if (result[we].Contains(symboltable1[row, column]))
            listBox1.Items.Add("vliad");
          else
            listBox2.Items.Add("invalid");          
    }
} 
```

我现在想要的是如何将有效术语存储在另一个名为 symboltable2 的二维数组中？通过有效术语，我的意思是上述两个数组中的术语？？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T14:57:46.620

您可以使用下面的通用函数将 2D 数组展平为`IEnumerable`，将元素放入哈希集中，并根据该哈希表检查条款。

```
private static IEnumerable<T> Flatten<T>(T[,] data) {
    var r = data.GetLength(0);
    var c = data.GetLength(1);
    return Enumerable.Range(0, r*c).Select(i => data[i/c, i%c]);
}

var symTableItems = new HashSet<string>(Flatten(symboltable1));
var allValid = result.Where(s => symTableItems.Contains(s)).ToList(); 
```

# java - c++ like protected in java

> ID：10852332
> 
> 赞同：11
> 
> 时间：2012-06-01T14:39:45.943
> 
> 标签：java, c++, protected, access-specifier

> **可能重复：**
> [如何使数据成员只能被类和子类访问](https://stackoverflow.com/questions/5405907/how-to-make-data-member-accessible-to-class-and-subclass-only)

在java中，
可以从类、它的子类和同一个包中存在的所有类中访问受保护的成员，
但我希望一个成员只能从类及其子类中访问（就像c++中的受保护成员一样）。

例如::

```
class A
{
    protected void fun()
    {
        System.out.println("Hello");
    }
}
class B
{
    public static void main(String args[])
    {
        A a = new A();
        a.fun();        
    }
} 
```

在这里，即使 B 不是 A 的子类，B 也可以访问 A 的 fun()。

如何使所有不是 A 的子类的类都无法访问 A？

编辑:: 我想在 java 中实现这一点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-01T14:42:55.120

在 Java 中，没有办法做到这一点。

也就是说，您（理想情况下）控制包中的所有代码，因此您只需要确保您自己不使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T14:49:16.217

在java中没有办法做到这一点。受保护意味着对同一包中的继承者和类可见。但是你可以密封你的包（[http://docs.oracle.com/javase/tutorial/deployment/jar/sealman.html](http://docs.oracle.com/javase/tutorial/deployment/jar/sealman.html)），这样没有人可以在你的包中创建新的类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-01T14:48:54.790

在 Java 中，protected 的意思是“继承者和同一个包中的其他人可以访问”。

在 C++ 中，受保护的意思是“可由继承者访问”。

由于 Java 中的包可访问性，它们并不真正等效。

在 Java 中模仿 C++ 保护的唯一方法是在它们自己的包中声明类，但我不建议这样做。

# java - java中栈的实现

> ID：10852333
> 
> 赞同：0
> 
> 时间：2012-06-01T14:39:47.087
> 
> 标签：java

我必须在java中实现一些堆栈的功能，并选择一个练习来解决，例如，在堆栈末尾插入一个新元素而不破坏顺序。我怎样才能做到这一点？

```
// stack.java
// demonstrates stacks
// to run this program: C>java StackApp
////////////////////////////////////////////////////////////////
class Stack
{
  private int maxSize; // size of stack array
  private long[] stackArray;
  private int top; // top of stack
//--------------------------------------------------------------
  public Stack(int s) // constructor
 {
    maxSize = s; // set array size
    stackArray = new long[maxSize]; // create array
    top = -1; // no items yet
  }
//--------------------------------------------------------------
   public void makeEmpty( ) {
    top = -1;
    }

   public void push(long j) // put item on top of stack 
   {
     stackArray[++top] = j; // increment top, insert item
    }
//--------------------------------------------------------------
   public long pop() // take item from top of stack
 { return stackArray[top--]; // access item, decrement top
  }
//--------------------------------------------------------------

   public long peek() // peek at top of stack
  { return stackArray[top];
   }
//--------------------------------------------------------------
   public boolean isEmpty() // true if stack is empty
   {return (top == -1);
    }
//--------------------------------------------------------------
   public boolean isFull() // true if stack is full
    {return (top == maxSize-1);
     }
  }
//--------------------------------------------------------------
 // end class StackX 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T14:49:52.720

JVM 库中有预构建`Stack`的类；但是，如果您将此作为创建自己的堆栈的课程，则可以使用单链表轻松完成此操作。

您将需要两个类，一个`Stack`将呈现`void push(Object)`,`Object pop()`和任何方法的`Node`类，以及一个代表链表中节点的类。

`Stack`在列表的头部维护一个成员变量，`Stack`在列表的尾部维护一个成员变量。将an`Object`推入堆栈将需要一个 new`Node`来保存对象，因此`Node`需要一个“数据”成员来引用 push `Object`，并需要一个“下一个”引用来引用“下一个” `Node`。

推送问题的其余部分只是通过创建一个新的 向节点链添加元素`Node`，让它引用推送的对象，将它的下一个节点成员指向当前尾部，并更新`Stack`的当前尾部引用。`Stack`弹出将返回s tail引用的 Object `Node`，并将更新 tail 以指向 "next" `Node`。

有特殊情况需要考虑，但并不难。基本上你在推空时需要小心`Stack`，当弹出时会产生空`Stack`。

完成所有这些之后，您可以根据需要轻松添加`peek()`方法等。

# javascript - Jquery查找响应是否包含元素

> ID：10852335
> 
> 赞同：0
> 
> 时间：2012-06-01T14:39:53.060
> 
> 标签：javascript, jquery

如何查找响应是否包含元素形式

```
 $.ajax({
        url     : $(this).attr('action'),
        type    : 'POST',
        success : function(response){
            if($(response).find('form').length)
            {
                alert("hii");
            }
        }
    }); 
```

表单可能是响应的最顶层元素或中间某处

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:41:12.703

```
$.ajax({
        url     : $(this).attr('action'),
        type    : 'POST',
        dataType: 'html', // you should set it 
                          //  if you response send html only
        success : function(response){
            if($(response).filter('form').length)
            {
                alert("hii");
            }
        }
    }); 
```

**根据更新：**

```
 ....
        dataType: 'html',
        success : function(response){
            var container = $('<div/>').append(response);
            if($(container).find('form').length)
            {
                alert("hii");
            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:46:23.793

```
$.ajax({
    url     : $(this).attr('action'),
    type    : 'POST',
    success : function(response){
        var hasForm = $("<div></div>").append(response).find("form").length > 0;
        if(hasForm)
        {
            alert("hi");
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T14:53:09.537

dataType : 'html' 强制 jQuery 将响应视为简单的 html。我正在使用“has”功能，它将匹配的元素集减少到仅包含其中某处的表单的元素。

```
 $.ajax({
        url     : $(this).attr('action'),
        type    : 'POST',
        dataType : 'HTML',
        success : function(response){
           $(response).has('form').doMoreWorkHere();
        }
    }); 
```

或者，你可以写得更短

```
$.post($(this).attr('action'), {}
       function(response){
         $(response).has('form').doMoreWorkHere();
       }, 'html'); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-01T14:46:10.063

“回应”从何而来？它是什么格式？

我以 json 格式发送返回的变量：

```
success: function(msg){
    var obj = jQuery.parseJSON( msg ); 
    alert( obj.VARNAMEHERE );
} 
```

或者您可以只检查整个响应而不是特定变量。这将使您了解如何遍历结果以找到您要查找的内容。

# java - 如何识别虚假或不正确的电子邮件地址？

> ID：10852336
> 
> 赞同：-1
> 
> 时间：2012-06-01T14:39:58.127
> 
> 标签：java

> **可能重复：**
> [用 Java 验证电子邮件](https://stackoverflow.com/questions/153716/verify-email-in-java)

如何识别虚假或不正确的电子邮件地址

例如：收件人的正确电子邮件地址是 john.canada@maseke.com。但是当他在申请中提交表格时，他输入了一个错误的电子邮件地址，例如 john.canad@maseke.com 。在这种情况下，系统应向管理员发送一封电子邮件，说明“由于 john.canad@maseke.com 的电子邮件地址不正确，因此未发送电子邮件”。

网络应用程序 (Java)

我们如何在 Java 中实现上述要求。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T14:41:56.213

最好的方法是发送一封包含验证链接或代码的电子邮件。

# mysql - 真/假与 MySQL 中的 0/1

> ID：10852337
> 
> 赞同：65
> 
> 时间：2012-06-01T14:40:00.043
> 
> 标签：mysql, boolean

MySQL 数据库中哪个*更快？*布尔值，还是使用零和一来表示布尔值？我的前端只有一个是/否单选按钮。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-06-01T14:50:52.917

启用“使用布尔值”选项的某些“前端”会将所有 TINYINT(1) 列视为布尔值，反之亦然。

这允许您在应用程序中使用 TRUE 和 FALSE 而不是 1 和 0。

这根本不会影响数据库，因为它是在应用程序中实现的。

MySQL中没有真正的`BOOLEAN`类型。BOOLEAN 只是 TINYINT(1) 的同义词，TRUE 和 FALSE 是 1 和 0 的同义词。

如果在编译器中完成转换，则应用程序的性能不会有任何差异。否则，差异仍然不会很明显。

您应该使用可以让您更有效地编码的任何方法，尽管不使用该功能可能会减少对特定“前端”供应商的依赖。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-06-01T14:42:05.973

在MySQL中[`TRUE`和`FALSE`](https://dev.mysql.com/doc/refman/8.0/en/boolean-literals.html)是*.*`TINYINT(1)`

因此，它基本上是一样的，但 MySQL 正在转换为 0/1 - 所以只需使用 a`TINYINT`如果这对你来说更容易

**PS***性能*
可能 是如此微不足道（如果有的话），如果您需要在 StackOverflow 上询问，那么它不会影响您的数据库:)

 ** * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-01T15:00:12.973

`Bit``tinyint`如果不符合您的喜好，也是一种选择。几个链接：

*   [用于存储布尔值的 MySQL 数据类型](https://stackoverflow.com/questions/289727/which-mysql-datatype-to-use-for-storing-boolean-values)
*   [MySQL 中的 BIT 和 TINYINT 有什么区别？](https://stackoverflow.com/questions/290223/what-is-the-difference-between-bit-and-tinyint-in-mysql)

[毫不奇怪，手册](http://dev.mysql.com/doc/refman/5.0/en/numeric-types.html)中提供了有关数字类型的更多信息。

另一个链接：[http ://blog.mclaughlinsoftware.com/2010/02/26/mysql-boolean-data-type/](http://blog.mclaughlinsoftware.com/2010/02/26/mysql-boolean-data-type/)

以及上面文章评论部分的引述：

> *   TINYINT(1) 不是 bit(1) 的同义词。
> *   TINYINT(1) 可以存储 -9 到 9。
> *   TINYINT(1) 无符号：0-9
> *   BIT(1)：0、1。（位，字面意思）。

* * *

编辑：此编辑（和答案）仅与原始问题远程相关...

Justin Rovang 和作者 maclochlainn 的附加引用（链接文章的评论部分）。

> 对不起，似乎我已经成为 substr-ism 的受害者： TINYINT(1): -128-+127 TINYINT(1) UNSIGNED: 0-255 (Justin Rovang 2011 年 8 月 25 日下午 4:32)
> 
> 确实如此，但这篇文章是关于 PHPMyAdmin 列为布尔值的，它只使用了 256 种可能性中的 0 或 1。（maclochlainn 2011 年 8 月 25 日晚上 11:35）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-01T15:00:30.143

如果您喜欢性能，那么值得使用 ENUM 类型。由于更好的索引性能，它在大表上可能会更快。

使用方式（来源：[http](http://dev.mysql.com/doc/refman/5.5/en/enum.html) ://dev.mysql.com/doc/refman/5.5/en/enum.html ）：

```
CREATE TABLE shirts (
    name VARCHAR(40),
    size ENUM('x-small', 'small', 'medium', 'large', 'x-large')
); 
```

但是，我总是说这样解释查询：

```
EXPLAIN SELECT * FROM shirts WHERE size='medium'; 
```

会告诉你很多关于你的查询的信息，并帮助你建立一个更好的表结构。为此，让 phpmyadmin 提出一个 table 表结构是有用的——但这更多是长时间优化的可能性，当 table 已经充满了大量数据时。*

# python - 在 Python 中创建空列表字典的最有效方法？

> ID：10852345
> 
> 赞同：0
> 
> 时间：2012-06-01T14:40:31.517
> 
> 标签：python

我正在初始化一个空列表字典。有没有比以下方法更有效的初始化字典的方法？

```
dictLists = {}
dictLists['xcg'] = []
dictLists['bsd'] = []
dictLists['ghf'] = []
dictLists['cda'] = []
... 
```

有没有一种方法我不必每次都写 dictLists，或者这是不可避免的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T14:42:19.593

您可以使用[collections.defaultdict](http://docs.python.org/library/collections.html#collections.defaultdict)它允许您设置一个工厂方法，该方法返回缺失键的特定值。

```
a = collections.defaultdict(list) 
```

编辑：

这是我的钥匙

```
b = ['a', 'b','c','d','e'] 
```

现在这是我使用“预定义键”

```
for key in b:
    a[key].append(33) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-01T14:43:51.570

如果事先知道密钥，您可以这样做

```
dictLists = dict((key, []) for key in ["xcg", "bsd", ...]) 
```

或者，在 Python >=2.7 中：

```
dictLists = {key: [] for key in ["xcg", "bsd", ...]} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-01T14:42:07.733

如果添加静态键，为什么不直接将它们放在 dict 构造函数中？

```
dictLists = dict(xcg=[], bsd=[], ghf=[]) 
```

或者，如果您的密钥并不总是有效的 python 标识符：

```
dictLists = {'xcg': [], 'bsd': [], 'ghf': []} 
```

另一方面，如果您的密钥不是静态的或易于存储在序列中，那么如果有很多密钥，则循环遍历这些密钥可能会更有效。下面的示例仍然键入`keys`变量，使其不比上述方法更有效，但如果`keys`以某种方式生成，这可能更有效：

```
keys = ['xcg', 'bsd', 'ghf', …]
dictLists = {key: [] for key in keys} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-01T14:42:51.213

您还可以使用 for 循环来添加键：

```
for i in ("xcg", "bsd", "ghf", "cda"):
    dictList[i] = [] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-01T14:44:11.767

在支持字典理解的 Python 版本（Python 2.7+）中：

```
dictLists = {listKey: list() for listKey in listKeys} 
```

# android - 检查本地文件是否存在（Flex 4 Mobile）

> ID：10852352
> 
> 赞同：0
> 
> 时间：2012-06-01T14:40:48.520
> 
> 标签：android, actionscript-3, apache-flex, file-io, flex4.5

我目前正在使用此代码：

```
 private function getFile(file:String):void
        {
            var openFile:URLRequest = new URLRequest("file:///sdcard/GNs/"+file);
            try {navigateToURL(openFile);}
            catch(e:Error)
            {
                var download:URLRequest = new URLRequest("http://"+file);
                new DLAlert().open(this, true);
            }
        } 
```

找到一个文件，如果它不存在，则弹出一个可选下载的弹出窗口。问题是，尝试`navigateToURL(...)`命令时返回的错误是由网络/文件浏览器处理的，而不是由应用程序处理的。有没有办法在不打开它的情况下寻找它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T14:46:35.693

用这个：

```
var myfile:File = new File("/sdcard/GNs/"+file);
if (myfile.exists)
{
   // your code here
}
else
{
   // your code here
} 
```

# android - Oracle：将 oracle 数据库导出到 .sql 文件并在 android 中导入相同的 .sql 文件作为 SQLite db

> ID：10852359
> 
> 赞同：1
> 
> 时间：2012-06-01T14:41:10.643
> 
> 标签：android, oracle, sqlite

我正在开发一个 android 应用程序，我需要将 oracle 数据库导出到 .sql 文件（而不是 .dmp 文件）。然后我将该 .sql 文件复制到 android assert 文件夹。现在我将该 .sql 文件导入到 sqlite db。但是，我想知道如何将 oracle db 导出到 .sql 文件。

这里我有两个问题：

1.  是否可以将 oracle 数据库导出到 .sql 文件。
2.  是否可以将相同的 .sql 文件从断言导入到 android SD 卡作为 SQLite db。

有人可以帮我解决这些问题。是否有任何可用的教程或示例对我有很大帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:33:04.070

您可以使用 DBMS_METADATA.GET_DDL() 包从可以运行的数据库中获取您的架构以重新创建 db 对象。请注意，并非所有内容都可以转换为 sqllite，具体取决于架构的复杂程度。 [dbms_metadata 参考](http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_metada.htm) 只需将内容从 sqlplus 假脱机到文件

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-01T16:31:20.863

看这里。Oracle 有这两个工具，称为 exp 和 imp，用于导出数据库和导入数据库。它将有助于传输数据库。

编辑：更多信息

[如何在 Oracle 中获取模式并将其放在另一台计算机上？](https://stackoverflow.com/questions/10825756/how-can-i-take-the-schema-in-oracle-and-put-it-on-another-computer/10825817#10825817)

# jsp - 如何在自定义标签中包含包含 jsp 和 jstl 标签的 jsp 文件

> ID：10852362
> 
> 赞同：1
> 
> 时间：2012-06-01T14:41:33.960
> 
> 标签：jsp, custom-tags

是否可以在自定义标签类中包含包含 jstl 标签的 .jsp 文件（在我的特定情况下，使用标签文件不是一个选项）？例如，我需要创建自定义标签来绘制包含页面范围变量内容的表格。table.jsp 是：

```
<table>  
  <thead>  
    <tr>  
       <c:if test="${isAdmin }">  
          <th><fmt:message bundle="${prop}" key="orders.table.selected" /></th>  
       </c:if>  
    </tr> 
   more code here  
<table> 
```

我尝试使用`pageContext.include()`方法包含此 jsp，但我在 html 页面上获得了所有 jstl 标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:01:20.337

是的，你可以包括。`pageContext.include()`会反过来打电话`RequestDispatcher.include()`

# php - 将样式化的谷歌地图的 JSON 数组添加到 php？

> ID：10852364
> 
> 赞同：0
> 
> 时间：2012-06-01T14:41:49.890
> 
> 标签：php, json, google-maps

问这个问题我感觉很糟糕。如果我试图做的事情是不可能的，请告知。

我是一名图形/网页设计专业的学生，​​到目前为止只擅长 html。我正在使用谷歌地图组件，并希望使用 API 向导设置地图样式。如下：http: [//pastebin.com/YsKbyS58](http://pastebin.com/YsKbyS58)

问题是示例使用静态 html，并且组件基于 php：http: [//pastebin.com/XrEMmTVJ](http://pastebin.com/XrEMmTVJ)

我可以将 JSON 数组注入 PHP 文件吗？语法会是什么样的？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:49:25.910

用于设置地图样式的 Google 地图语法类似于（使用您的 php 脚本）：

```
// Map creation
        var map = new google.maps.Map(document.getElementById('contentmap_<?php echo $owner; ?>_<?php echo $id; ?>'),
        {
                zoom: <?php echo $this->Params->get("zoom", 0); ?>,
                center: center,
                mapTypeId: google.maps.MapTypeId.<?php echo $this->Params->get("map_type", "ROADMAP"); ?>,
                styles : [
                    {
                     elementType: "geometry",
                     stylers: [
                          { visibility: "on" },
                          { hue: "#ff8800" }
                     ]
                    },{
                     elementType: "labels",
                     stylers: [
                           { hue: "#ffc300" }
                     ]
                    }
                ]
             }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:49:25.053

我的理解是您想将这些样式应用于您的地图？由于您发布的内容实际上只是一个静态对象，因此您可以将其直接插入到地图选项中：

```
var map = new google.maps.Map(document.getElementById('contentmap_<?php echo $owner; ?>_<?php echo $id; ?>'),
    {
        zoom: <?php echo $this->Params->get("zoom", 0); ?>,
        center: center,
        mapTypeId: google.maps.MapTypeId.<?php echo $this->Params->get("map_type", "ROADMAP"); ?>,
            styles:  [ 
                       { 
                         elementType: "geometry",
                         stylers: [
                           { visibility: "on" },
                           { hue: "#ff8800" }
                         ] 
                       },{ 
                         elementType: "labels",
                         stylers: [
                           { hue: "#ffc300" }
                         ] 
                       } 
                     ]
    }); 
```

如果您打算使样式动态化，PHP 标记也可以替换对象内的值`styles`。

# magento - 在magento中找不到定义的块

> ID：10852368
> 
> 赞同：1
> 
> 时间：2012-06-01T14:41:57.690
> 
> 标签：magento

我正在按照本教程[http://codemagento.com/2011/03/creating-custom-magento-reports/](http://codemagento.com/2011/03/creating-custom-magento-reports/)创建简单的报告模块。我有所有的代码和 XML，但我收到了这个错误

```
2012-05-31T21:48:43+00:00 ERR (3): Recoverable Error: Argument 1 passed to Mage_Adminhtml_Controller_Action::_addContent() must be an instance of Mage_Core_Block_Abstract, boolean given, called in /var/www/magento/app/code/local/Super/Awesome/controllers/Adminhtml/Report/ExampleController.php on line 22 and defined  in /var/www/magento/app/code/core/Mage/Adminhtml/Controller/Action.php on line 112 
```

结构看起来像这样

```
Super
  |_ Awesome
      |_Block
      |   |_Adminhtml
      |       |_Report
      |          |_Simple
      |          |   |_Grid.php
      |          |_Simple.php
      |_controllers
      |    |_Adminhtml
      |       |_Report
      |          |_ExampleController.php
      |_etc
      |   |_adminhtml.xml
      |   |_config.xml
      |_Helper
      |   |_Data.php
      |_Model
            |_Mysql4
            |    |_Report
            |    |   |_Simple
            |    |      |_Collection.php
            |    |_Simple.php
            |_Simple.php 
```

我假设它没有找到块代码，但为什么？

编辑

```
<?xml version="1.0"?>
<config>
  <modules>
    <Super_Awesome>
      <version>0.1.0</version>
    </Super_Awesome>
  </modules>
  <admin>
    <!--
        Here we are telling the Magento router to look for the controllers in the Super_Awesome_controllers_Adminhtml before we look in the
        Mage_Adminhtml module for all urls that begin with /admin/controller_name
     -->
    <routers>
      <adminhtml>
        <args>
          <modules>
            <awesome before="Mage_Adminhtml">Super_Awesome_Adminhtml</awesome>
          </modules>
        </args>
      </adminhtml>
    </routers>
  </admin>
  <models>
    <awesome>
      <class>Super_Awesome_Model</class>
      <resourceModel>awesome_mysql4</resourceModel>
    </awesome>
    <awesome_mysql4>
      <class>Super_Awesome_Model_Mysql4</class>
      <entities>
        <simple>
          <table>super_awesome_example_simple</table>
        </simple>
      </entities>
    </awesome_mysql4>
  </models>
  <global>
    <resources>
      <awesome_setup>
        <setup>
          <module>Super_Awesome</module>
          <class>Super_Awesome_Model_Mysql4_Setup</class>
        </setup>
        <connection>
          <use>core_setup</use>
        </connection>
      </awesome_setup>
      <awesome_write>
        <connection>
          <use>core_write</use>
        </connection>
      </awesome_write>
      <awesome_read>
        <connection>
          <use>core_read</use>
        </connection>
      </awesome_read>
    </resources>
    <helpers>
      <awesome>
        <class>Super_Awesome_Helper</class>
      </awesome>
    </helpers>
  </global>
</config> 
```

文件：app/code/local/Super/Awesome/Block/Adminhtml/Report/Simple.php

```
class Super_Awesome_Block_Adminhtml_Report_Simple extends Mage_Adminhtml_Block_Widget_Grid_Container
{
    public function __construct()
    {
        $this->_blockGroup = 'awesome';
        $this->_controller = 'adminhtml_report_simple';
        $this->_headerText = Mage::helper('awesome')->__('Simple Report');
        parent::__construct();
        $this->_removeButton('add');
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T22:35:10.610

当您（或 Magento）使用以下代码时

```
$this->getLayout()->createBlock('awesome/adminhtml_report_simple') 
```

你说

> 请从组中创建一个`adminhtml_report_simple`块`awesome`

Magento 需要知道用于来自 awesome 组的块的类的基本名称。如果你不告诉 Magento 类的基本名称用于来自 awesome 组的块，它就不能实例化一个块。这就是对方法的调用返回`false`而不是返回块对象的原因，这就是为什么您会收到该异常。

您需要通过在配置中添加一个部分来“打开”模块的块。根据上面的示例，您已经为辅助类做了类似的事情。

```
<config>
    <global>
        <helpers>
            <awesome>
                <class>Super_Awesome_Helper</class>
            </awesome>
        </helpers>
    </global>
</config> 
```

这就是为什么你的模块可以使用辅助类。你只需要对**块**类 做同样的事情

```
<config>
    <global>
        <blocks>
            <awesome>
                <class>Super_Awesome_Helper</class>
            </awesome>
        </blocks>
    </global>
</config> 
```

那和缓存清除应该会让你正确。如果它不起作用，请跟踪`createBlock`以确定它在`blocks/awesome`节点配置中的位置。这通常足以让我注意到我已经开始两个小时的错字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T21:29:44.237

刚刚收到此错误，但解决方案不同。

一切都被宣布正确，因为索引页面被以相同的方式调用，使用

```
$this->getLayout()->createBlock('') 
```

我可以很好地查看它。

但是我有错误的页面，块返回false。正如艾伦建议的那样，我去看看`Mage_Core_Model_Layout::createBlock()`。我正在查看功能并做到了这一点

```
public function createBlock($type, $name='', array $attributes = array())
{
    echo $name; // ADDED ECHO HERE
    try {
        $block = $this->_getBlockInstance($type, $attributes);
    } catch (Exception $e) {
        echo $e; // ADDED ECHO HERE
        Mage::logException($e);
        return false;
    } 
```

尝试中出现错误，因此它返回 false，因此显示错误，`must be an instance of Mage_Core_Block_Abstract, boolean given`. 实际错误的回声显示我的块中有错误，调用了未声明的变量。它位于新/编辑表单上，因此如果它是新项目，则变量不存在。我经历并修复了错误，直到页面加载没有错误。

希望这可以帮助有类似问题的人，试图在声明中找到实际上不存在的错字，我知道我这样做了一段时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T22:25:54.970

您`config.xml`缺少一些关键信息，即`<blocks>`告诉 Magento 在哪里寻找您的块的部分。我不确定为什么这被隐藏在教程的“复杂”部分，但是哦，好吧。这应该可以解决问题：

```
<config>
  ...
  <global>
    ...
    <blocks>
        <awesome>
            <class>Super_Awesome_Block</class>
        </awesome>
    </blocks>
    ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-15T11:18:07.787

好的，我在这里发布我的经验以帮助其他人。

RYAN 的回答真的很有帮助，并指导我找到我的模块的错误并修复它。

自定义一个网格模块时，我遇到了一个类似的错误：

```
Recoverable Error: Argument 1 passed to Mage_Adminhtml_Controller_Action::
_addContent() must be an instance of Mage_Core_Block_Abstract, boolean given, 
called in /var/www/html/magento2/app/c..... 
```

这是系统错误消息，看起来法师无法加载和创建块！

但实际上，错误是由于在块中使用了一些辅助函数而引起的。因为这个助手还没有被定义。

因此，更好地使用 Mage::log 非常重要且很有帮助：

```
Mage::log((string) $collection->getSelect(), NULL, 'export-all.log');
Mage::log( var_export($collection->getData(), TRUE), NULL, 'export-coll.log'); 
```

并在必要时通过更改 index.php 使 Mage 显示错误，如下所示

```
#if (isset($_SERVER['MAGE_IS_DEVELOPER_MODE'])) {
    Mage::setIsDeveloperMode(true);
#}

ini_set('display_errors', 1); 
```

# java - Java Web 应用程序中的 MongoDB 配置

> ID：10852373
> 
> 赞同：2
> 
> 时间：2012-06-01T14:42:12.313
> 
> 标签：java, mongodb, mongo-java

我正在寻找一些关于为使用 java 运行的 Web 应用程序设置 mongoDB 的正确方法的建议。从 mongoDB 教程中，我了解到我应该只有一个 Mongo 类的实例。

> Mongo 类被设计成线程安全的并且在线程之间共享。通常，您只为给定的数据库集群创建 1 个实例并在您的应用程序中使用它。

所以我有一个单例提供者（我正在使用 guice 进行注入）

```
@Singleton
public class MongoProvider implements Provider<Mongo> {
    private Mongo mongo;

    public Mongo get() {
        if (mongo == null)
            mongo = new Mongo("localhost", 27017);
        return mongo;
    }
} 
```

每当我必须在我的 web 应用程序中使用 mongo 时，我都会注入提供程序并获得相同的 mongo 实例。

```
public class MyService {
    private Provider<Mongo> mongoProvider;

    @Inject
    private MyService(Provider<Mongo> mongoProvider) {
        this.mongoProvider = mongoProvider;
    }

    public void execute() {
        DB db = mongoProvider.get().getDB("mydatabase");
        DBCollection coll = db.getCollection("mycollection");

        // Do stuff in collection
        ...
    }
} 
```

我觉得奇怪的是，每次我访问我的数据库时，我都会从 mongo 得到这样的日志：

> [initandlisten] 接受来自 192.168.1.33:54297 #15 的连接
> 
> [initandlisten] 接受来自 192.168.1.33:54299 #16 的连接

到目前为止，我还没有遇到任何问题，但我想知道这是否是一种好习惯，以及当接受的连接数太高时我是否不会遇到任何问题。

*   我的整个应用程序是否也应该只有一个 DB 对象实例？
*   我是否必须以不同的方式配置 MongoDB 以在一段时间后自动关闭连接？还是我必须手动关闭连接？我已经阅读了有关在 Mongo 上使用 close() 方法的内容，但我不确定何时或是否调用它。

谢谢你的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:02:17.833

这是一个很好的做法。每个 Mongo 实例都管理一个连接池，因此您将在 mongod 日志中看到多个连接，池中的每个连接对应一个连接。默认池大小为 10，但可以使用 MongoOptions 中的 connectionsPerHost 字段进行配置。

Mongo 实例还维护数据库实例的缓存，因此您不必担心自己将这些实例维护为单例。

您不必将 Mongo 配置为自动关闭连接。您可以在适当的时候调用 Mongo#close 来关闭连接池中的所有套接字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T09:27:17.640

建立了类似这样的 om MondoDB 站点：

“Java MongoDB 驱动程序是线程安全的。例如，如果您在 Web 服务环境中使用，您应该创建一个 MongoClient 实例，并且可以在每个请求中使用它。MongoClient 对象维护一个内部连接池，以连接到数据库（默认池大小为 10）。**对于对数据库的每个请求（查找、插入等），Java 线程将从池中获取连接，执行操作并释放连接。**这意味着使用的连接（套接字）可能每次都不一样。”

来自 MongoSite 的常见问题解答，我认为完全可以回答您的问题。

[http://docs.mongodb.org/manual/faq/developers/#why-does-mongodb-log-so-many-connection-accepted-events](http://docs.mongodb.org/manual/faq/developers/#why-does-mongodb-log-so-many-connection-accepted-events)

# asp.net - 在 ASP.NET 中实现被动 STS

> ID：10852374
> 
> 赞同：0
> 
> 时间：2012-06-01T14:42:12.947
> 
> 标签：asp.net, visual-studio-2010, security, single-sign-on, sts-securitytokenservice

我已经安装了 WIF Runtime 和 WIF SDK v4.0 并在 Visual Studio 2010 中创建了一个“ASP.NET 安全令牌服务网站”（请参阅​​此[链接](http://msdn.microsoft.com/en-us/library/ee748478.aspx)）。

当我运行该站点时，输入任何用户名/密码组合，然后按“提交”，我得到以下异常：

> 操作 < EMPTY > (Request.QueryString['wa']) 是意外的。预期的操作是：“wsignin1.0”或“wsignout1.0”。

所以有几点：

*   我意识到我没有依赖方（又名客户端应用程序），但是这对测试站点有必要吗？
*   我可能缺少一些步骤（例如创建客户端应用程序）。我错过了哪些步骤？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T17:05:33.190

我有一个关于编写自定义 STS 的六部分教程，从这里开始（前三个对你来说已经足够了）：

[http://netpl.blogspot.com/2011/08/adfs-20-quest-for-customizing-adfs-sign.html](http://netpl.blogspot.com/2011/08/adfs-20-quest-for-customizing-adfs-sign.html)

[http://netpl.blogspot.com/2011/08/quest-for-customizing-adfs-sign-in-web.html](http://netpl.blogspot.com/2011/08/quest-for-customizing-adfs-sign-in-web.html)

[http://netpl.blogspot.com/2011/08/quest-for-customizing-adfs-sign-ing-web.html](http://netpl.blogspot.com/2011/08/quest-for-customizing-adfs-sign-ing-web.html)

简而言之 - 是的。您需要一个 RP 以正确的方式重定向到您的 STS `wa`（例如`wsignin1.0`）。这可以通过RP 侧的`WSFederationAuthenticationModule`或控制来完成。`wif:FederatedPassiveSignIn`

编写你自己的 RP 真的很容易，如果没有来自 RP 的有效请求，我想不出测试你的 STS。

# objective-c - Objective C 将集合序列化为 JSON/XML

> ID：10852376
> 
> 赞同：0
> 
> 时间：2012-06-01T14:42:26.453
> 
> 标签：objective-c, json, xml-serialization

我有一个看起来像这样的课程：

```
@interface AISlideItem: NSObject <NSCoding>
{
    NSString*  PlaceHolderName;
    NSInteger PlaceHolderID;
}
@property (nonatomic, strong) NSString* PlaceHolderName;
@property (nonatomic) NSInteger PlaceHolderID;

@end

@interface AITitleSlideItem : AISlideItem
{
    NSString* Title;
}
@property (nonatomic, strong) NSString* Title;
@end

@interface AIParagraphSlideItem : AISlideItem
{
    NSMutableArray* Paragraphs;
}
@property (nonatomic, strong) NSMutableArray* Paragraphs;
@end

@interface AITextSlideItem : AISlideItem
{
    NSString* Text;
}
@property (nonatomic, strong) NSString* Text;
@end

@interface AIPictureSlideItem : AISlideItem
{
    NSMutableData* Picture;
}
@property (nonatomic, strong) NSMutableData* Picture;
@end

@interface AISlideContent : NSObject
{
    NSString*       LayoutName;
    NSMutableArray* Items;
}
@property (nonatomic,strong) NSString* LayoutName;
@property (nonatomic,strong) NSMutableArray* Items;
@end

@interface ContentParaghraph : NSObject
{
    NSInteger Level;
    NSString* Text;
}
@property (nonatomic) NSInteger Level;
@property (nonatomic, strong) NSString* Text;
@end 
```

我从这些类创建一个复杂的集合，如下所示：

```
 NSMutableArray* l = [[NSMutableArray alloc]init ];

        AITitleSlideItem* tis1 = [[AITitleSlideItem alloc]init];
        [tis1 setPlaceHolderName:@"I don't think we're using this..."];
        [tis1 setPlaceHolderID:1];
        [tis1 setTitle:@"This is a title"];

        AITextSlideItem* tes1 = [[AITextSlideItem alloc]init];
        [tes1 setPlaceHolderName:@"I don't think we're using this..."];
        [tes1 setPlaceHolderID:2];
        [tes1 setText:@"This is the description"];

        AISlideContent* slide1 = [[AISlideContent alloc]init];
        [slide1 setLayoutName:@"Title content"];
        [[slide1 Items]addObject:tis1];
        [[slide1 Items]addObject:tes1];

        [l addObject:slide1];
        [l addObject:slide1]; 
```

我想将 NSMutableArray l 序列化为任何可移植格式，如 json 或 xml。你能发布一些这样做的代码吗？

真挚地

佐利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:11:36.123

经过进一步调查，我发现没有什么更适合我的需要了。我决定进一步了解 JSON 并创建一个手动创建 JSON 结构的函数。即使花了2-3个小时，也值得所有的努力。

# c# - Windows 窗体启动另一个窗体

> ID：10852379
> 
> 赞同：4
> 
> 时间：2012-06-01T14:42:33.963
> 
> 标签：c#, winforms, visual-studio

我对 Visual Studio (Express) 和 C# 很陌生。我制作了一个窗口表单，它接受一些用户输入，然后在消息框中显示该输入（它会自动带有一个“确定”按钮，单击时会关闭消息框）。

相反，我希望第一个表单收集的用户输入显示在一个新表单中，该表单显示一条消息（标签），显示输入，并提供两个按钮的选择：一个接受，一个返回并更改输入。

我不知道如何做到这一点，任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T14:51:56.520

听起来您需要确认消息或类似的东西。MessageBox 类提供此功能。

```
 DialogResult btn = MessageBox.Show("your message", 
                                      "your title", 
                                      MessageBoxButtons.OKCancel, 
                                      MessageBoxIcons.Question);
   if(btn == DialogResult.Cancel)
        // User canceled, return to the string editor 
   else
        // User confirmed, do you work 
```

如果您愿意，还有一个 MessageBoxButtons.YesNo 的枚举，对应的 DialogResult.Yes 和 DialogResult.No

[请参阅此处以获取有关 MessageBoxButtons 的参考](http://msdn.microsoft.com/en-us/library/system.windows.forms.messageboxbuttons.aspx)
[请参阅此处以获取有关 MessageBoxIcons 的参考](http://msdn.microsoft.com/en-us/library/system.windows.forms.messageboxicon.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T14:46:23.570

您需要以某种方式将信息从第一种形式传递到第二种形式。这可以通过在子窗体上设置属性来完成，或者通过单个属性（字符串、整数等）或通过完整的数据结构（对象）。输入表单收集信息，创建子子表单，在其上设置属性，然后显示表单。许多其他方法可以做到这一点，但先从简单开始，然后逐步发展到复杂。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T14:50:09.610

如果您需要[将一些数据传递](http://www.codeproject.com/Articles/14122/Passing-Data-Between-Forms)给您的第二个表单，请在该表单上创建一个/多个属性，或通过构造函数参数提供数据。还要为第二个表单上的两个按钮分配[DialogResult 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.button.dialogresult.aspx)。设置`DialogResult.OK`为接受输入的按钮。验证第二种形式返回的值，当您[将其显示为对话框](http://msdn.microsoft.com/ru-ru/library/system.windows.window.showdialog.aspx)并执行适当的操作时：

```
using(SecondForm secondForm = new SecondForm()
{
   secondForm.Data = yourData;
   if (secondForm.ShowDialog() != DialogResult.OK)
   {
       // go back and change input
       return
   }

   // accept input
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T14:54:55.083

所以你`Form2`需要有一些价值，由任何创造它的东西提供，让它存在。没有这些信息，永远不应该有 Form2 的实例。这告诉您它应该在该表单的构造函数中（而不是该表单上的属性）。

这意味着`Form1`您将拥有以下内容：

```
string someData; //populate based off of user input
Form2 childForm = new Form2(someData);
//then hide current form and show child form 
```

在 Form2 中，您可能已经有一个构造函数，您只需将其修改为：

```
public Form2(string someData) //TODO give better parameter name
{
  someLabel.Text = someData;
} 
```

接下来我们需要处理返回父表单的子表单。我觉得处理这个问题的更好方法是使用事件。表单有一个`FormClosing`您可以附加到的事件；这将允许您的父表单在子表单关闭时运行一些代码。

字符串一些数据；//根据用户输入填充 Form2 childForm = new Form2(someData);

```
childForm.FormClosing += (sendingForm, args) =>
{
  this.Show();
  bool result = childForm.DidUserAccept;
} 
```

在这里，我在子表单上使用了一个属性`DidUserAccept`，用于判断用户是接受还是拒绝了该值。我们需要在 Form2 中定义它：

```
public bool DidUserAccept {get; private set;} 
```

在接受/取消的按钮单击处理程序中，您可以相应地设置结果，然后关闭表单（关闭将触发关闭事件并在`Form1`.

# phonegap-plugins - phonegap 黑莓网络工程插件

> ID：10852383
> 
> 赞同：1
> 
> 时间：2012-06-01T14:42:42.743
> 
> 标签：phonegap-plugins, cordova, blackberry-webworks

我正在尝试使用电话间隙创建一个 BlackBerry Webworks 插件。我正在尝试按照此链接中给出的说明进行操作：

[http://wiki.phonegap.com/w/page/35799737/How%20To%20Create%20a%20PhoneGap%20Plugin%20for%20BlackBerry%20WebWorks](http://wiki.phonegap.com/w/page/35799737/How%20To%20Create%20a%20PhoneGap%20Plugin%20for%20BlackBerry%20WebWorks)

但是，链接中提到的目录结构和我的差别很大，根目录下也没有 build.xml 来运行

ant create-plugin 命令，

自从 Phonegap 被转换为 Cordova 项目后，要遵循的过程有什么变化吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T08:41:21.353

目前添加插件的方式不同：

*   将 customplugin.js 添加到项目的 www 文件夹中，并在您的 html 文件中的 cordova.js 之后包含对它的引用。

*   将插件源添加到项目 ext 文件夹中的 cordova.jar 中。使用您喜欢的存档管理器打开 cordova.jar 或使用 jar 将 CustomPlugin.java 文件复制到 org/apache/cordova/plugins 目录中。

*   在您的项目 plugins.xml 文件中添加以下行：

参考：

[https://github.com/phonegap/phonegap-plugins/tree/master/BlackBerry/ChildBrowser](https://github.com/phonegap/phonegap-plugins/tree/master/BlackBerry/ChildBrowser)

# php - 将图像大小调整为正方形不适用于 PNG

> ID：10852384
> 
> 赞同：0
> 
> 时间：2012-06-01T14:42:43.777
> 
> 标签：php, png, gd

嗨，我已经编写了这个适用于 jpg 的函数，但不适用于 png。

这是我的代码：

```
function vignette_carre($src, $dest, $largeur, $src_x, $src_y){ 

   $ext = explode(".", $src);
    $ext = strtolower(end($ext));

       if ($ext == 'jpg' or $ext == 'jpeg') {$im_src=imagecreatefromjpeg($src);} 
    elseif ($ext == 'gif') { $im_src=imagecreatefromgif($src);} 
    elseif ($ext == 'png') {$im_src=imagecreatefrompng($src);}

    if ($im_src=="") return; 
    if($src_x >= $src_y){ 
        $dim=$src_y; $verticale="1"; 
    }
    elseif($src_x <= $src_y){
        $dim=$src_x; $horizontale="1"; 
    }
    else{ 
        $dim=$src_x; 
    }
    if($verticale == "1"){
        $point_x_ref=($src_x/2)-($dim/2); 
        $point_y_ref="0";
    }
    if($horizontale == "1"){
        $point_x_ref="0";
        $point_y_ref=($src_y/2)-($dim/2);
    }
    $im_dest=imagecreatetruecolor($largeur, $largeur);  
    $im_dest= imagecolorallocate($im_dest, 255, 255, 255);  
    imagecopyresampled($im_dest, $im_src, 0, 0, $point_x_ref, $point_y_ref, $largeur, $largeur, $dim, $dim); 
    imagedestroy($im_src); 
           if ($ext == 'jpg' or $ext == 'jpeg') {
    imagejpeg($im_dest, $dest); 
        imagedestroy($im_dest); 
       } 
       elseif ($ext == 'gif') {
    imagegif($im_dest, $dest);
        imagedestroy($im_dest); 
          }
        elseif ($ext == 'png') {

                imagepng($im_dest, $dest);
        imagedestroy($im_dest); 
          } 
} 
```

我在错误控制台中收到这些错误：

`[2] imagecolorallocate(): supplied argument is not a valid Image resource [2] imagecolortransparent(): supplied argument is not a valid Image resource`

有什么想法可以解决这个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:47:51.400

查看您的代码，这两个错误与提供的图像是`.png`.

似乎您没有`$largeur`在使用`.png`文件的版本中正确地向函数提供参数（特别是参数）。这可能是问题的原因，因为无效的大小将意味着`$im_dest`没有创建资源。

# api - 如何从 RPG 程序创建新的文件成员？

> ID：10852388
> 
> 赞同：3
> 
> 时间：2012-06-01T14:42:50.167
> 
> 标签：api, ibm-midrange, rpgle

我需要为我的 RPG 程序中的现有物理文件创建一个新成员。我知道两种方法，我必须说，我都不喜欢：

1.  用来`QCMDEXC`打电话给`ADDPFM`
2.  编写一个 CL 程序，`ADDPFM`从 RPG 调用和调用它

第一个涉及将一个必须解析的命令组合在一起，该命令`QCMDEXC`听起来并不高效（我知道，这里的扩展部分不是调用，而是成员的创建）——但真正困扰我的是什么它，是我不觉得它直截了当，但相反很难理解，也不是很美。

第二个使用编译程序，因此不涉及连接和解析。此外，它在您的 RPG 代码中看起来并不那么可怕，因为它只是一个正常的过程调用。但是我必须创建一个额外的外部程序，需要将其转移到我的 RPG 程序将在其上使用的所有系统。它也有点与我的审美冲突，创建一个额外的源代码和二进制文件只是为了做一个 api 调用。

有没有办法直接调用api，没有`QCMDEXC`？或者也许是另一种为 PF 创建新成员的 RPGish 方式？谷歌对我一点帮助都没有。。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T16:32:58.100

无法从 RPG 中直接创建物理文件成员。

您列出的选项很好。另一个是 system() API。如果这是一个新的应用程序，尽量避免多个成员；他们不是 SQL 的朋友。传统的多成员应用程序在调用 RPG 之前使用包装器 CL 来处理 ADDPFM 和 OVRDBF：

```
PGM &month
DCL &month *char 3
DCL &mbr *char 10
chgvar &mbr ('SALES' *cat &month)
addpfm sales &mbr
monmsg...
ovrdbf sales mbr(&mbr)
call RPG_PGM
endpgm 
```

显然，对于更新版本的 RPG，我们可以在 F 规范中进行覆盖。但是仍然没有办法直接从 RPG 中操作文件成员。我倾向于为 system() 或 QCMDEXC 编写过程包装器并将其放入服务程序中，这样我就可以在我的 RPG 程序中进行操作系统级别的工作。如果您愿意，可以编写一个特定的 ADDPFM 过程并调用该“API”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T17:57:55.727

举一些`QCMDEXC`解决方案的例子。如果您只需要在 RPG 程序中使用某种方式来创建成员，并且您不想添加任何额外的 (CL-) 程序，那么这是一个可以完成工作的简单解决方案：

您可以创建这样的过程`crt_mbr`：

```
 Pcrt_mbr          B
 D                 PI
 D lib                           10A   value
 D file                          10A   value
 D mbr                           10A   value
 Dqcmdexc          PR                  extpgm('QCMDEXC')
 D str                          200a   options(*varsize) const
 D len                           15P 5 const
 Dcmd              S            200A
 Dlen              S             15P 5
  /free
   cmd = 'ADDPFM FILE('+%trimr(lib)+'/'+%trimr(file)+') ' +
         'MBR(' + %trimr(mbr) +')';
   len = %len(%trimr(cmd));
   qcmdexc(cmd: len);
  /end-free
 Pcrt_mbr          E 
```

在 v7 中它看起来像这样：

```
dcl-proc crt_mbr;
  dcl-pi *n;
    lib    char(10) value;
    file   char(10) value;
    mbr    char(10) value;
  end-pi;

  dcl-pr qcmdexc  extpgm('QCMDEXC');
    str    char(200) options(*varsize) const;
    len    packed(15:5) const;
  end-pr;

  dcl-s cmd    char(200) inz('');
  dcl-s len    packed(15:5) inz(0);

  cmd = 'ADDPFM FILE(' + %trimr(lib) + '/' + %trimr(file) + ')' +
        ' MBR(' + %trimr(mbr) + ')';
  qcmdexc(cmd: %len(%trimr(cmd)));
end-proc; 
```

您可能需要在程序开始时添加原型（取决于您的版本）：

```
 Dcrt_mbr          PR
 D lib                           10A   value
 D file                          10A   value
 D mbr                           10A   value 
```

在您的程序中知道您可以调用：

```
/free
 ...
 crt_mbr('MY_LIB': 'MY_FILE': 'NEW_MEMBER');
 ...
/end-free 
```

请注意，这根本没有错误处理。因此，如果文件已经包含该名称的成员，您的程序将转储。根据需要添加监控或不同的错误处理。

# iphone - Xcode 项目宏名称问题

> ID：10852390
> 
> 赞同：0
> 
> 时间：2012-06-01T14:42:53.170
> 
> 标签：iphone, objective-c, xcode, build, linker

当我构建它时，我的项目直接在设备上运行。但是，当我尝试将其存档以将其与 TestFlight 一起使用时，我收到以下错误：

```
Lexical or Preprocessor Issue
Macro names must be identifiers 
```

为什么会发生这种情况我定义的唯一宏是 AppDelegate 中的这个：

```
#define TESTING 1
    #ifdef TESTING
    [TestFlight setDeviceIdentifier:[[UIDevice currentDevice] uniqueIdentifier]];
    #endif 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:27:32.900

尝试这个：

```
#define TESTING 1
#if TESTING
    NSLog(@"\n\n\n\n\n\ttesting !!!!!\n\n\n\n\n");
#endif 
```

您可能还想查看这篇文章：[错误：宏名称必须是使用 #ifdef 0 的标识符](https://stackoverflow.com/questions/426736/error-macro-names-must-be-identifiers-using-ifdef-0)

# jquery - jQuery Validate - 一步一步 - 隐藏字段集

> ID：10852396
> 
> 赞同：0
> 
> 时间：2012-06-01T14:43:14.633
> 
> 标签：jquery, forms, validation

[以下页面](http://jsfiddle.net/mynameisdonald/KB6wD/)有点麻烦

我已经为表单做了一个两步流程，其中第一步是字段集中的个人详细信息，并且有一个下一步按钮可将您带到第二个字段集并隐藏第一个。然后有一个运行 jQuery Validation 的提交按钮。

唯一的问题是它似乎只验证第二个字段集，即使我已经指定了所有需要的字段。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:05:44.937

[jQuery Validate 1.9.0](http://bassistance.de/2011/10/07/release-validation-plugin-1-9-0/)版默认将隐藏字段 (:hidden) 添加到忽略列表中；您可以执行以下操作将其重新打开：

```
$.validator.setDefaults({
    ignore: []
}); 
```

我希望这有帮助！

# jquery - iOS .click() --> .fadeOut() 不允许以后的 mouseenter --> .fadeIn()

> ID：10852397
> 
> 赞同：0
> 
> 时间：2012-06-01T14:43:15.213
> 
> 标签：jquery, touch, fadein, fadeout, mouseenter

我在选项卡上有一个非常简单的 mouseenter 来淡入子 div 的事情，但我希望触摸设备能够点击关闭链接来淡出孩子。这工作顺利。

当 iOS 用户再次点击选项卡以淡入其子项时，它会淡入然后立即淡出。尝试第三次，它甚至没有淡入。

如何让标签的每次点击都像第一次一样淡入？

jQuery

```
 $('#form').on({
    mouseenter: function () {
        clearTimeout( $(this).data('timeoutId') );
        $(this).children('div').fadeIn(300);
        $('#oops').fadeIn(80);
    },
    mouseleave: function() {
        var self = this;
        var timeoutId = setTimeout( function() {
            $(self).children('div').fadeOut(700);
                $('#oops').fadeOut(300);
        }, 700);
        $(self).data('timeoutId', timeoutId);
    }

});
$('#closer').click(function(){
    $('.hiding').fadeOut(700);
    $('#oops').fadeOut(400);                                    
}); 
```

​</p>

这是小提琴：http: [//jsfiddle.net/natejones/mnWb6/](http://jsfiddle.net/natejones/mnWb6/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:52:53.313

如果您希望它的行为与悬停完全一样

```
$('#form').live('touchstart', function() {
   $(this).trigger('mouseenter');
});
$('#form').live('touchend', function() {
   $(this).trigger('mouseleave');
}); 
```

我认为这是正确的代码，但如果不是，那就是这个想法。如果你想让它做不同的事情，那么你可以在 touchstart/touchend 中定义它。我认为这仅适用于 iOS，但我可能是错的。touchstart 是手指触摸屏幕的时候，touchend 是手指离开屏幕的时候。还有touchmove，当您的手指在屏幕上并移动时。

# sql-server - 数据库服务器版本与我安装的 SQL Server 版本不同

> ID：10852398
> 
> 赞同：0
> 
> 时间：2012-06-01T14:43:17.443
> 
> 标签：sql-server, sql-server-2008

我正在打开 SQL Server 2008 R2 Management Studio。

当我连接到我的数据库服务器时，它说版本是 9.0.2047。但是当我连接到我的分析服务器和报表服务器时，它们都是 10.50.1600.1 版本。

如何更改我的数据库服务器以使其运行版本 10.50.1600.1？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:48:09.673

在 SSMS 对象资源管理器中，从“连接下拉菜单 > 数据库引擎...”项中，您可以从所有可用的数据库服务器中进行选择。

似乎您同时安装了不同版本的 SQL Server。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:46:11.217

卸载 SQL Server 2005，然后安装 SQL Server 2008 R2。

[这是一个不错的网站，其中包含适合您的版本](http://sqlserverbuilds.blogspot.com/)。

# iphone - UIView 透明渐变

> ID：10852405
> 
> 赞同：40
> 
> 时间：2012-06-01T14:43:28.450
> 
> 标签：iphone, ios, core-graphics, cagradientlayer

给定iOS上的任意UIView，有没有办法使用Core Graphics（想到CAGradientLayer）对其应用“前景透明”渐变？

我不能使用标准的 CAGradientLayer，因为背景比 UIColor 更复杂。我也不能覆盖 PNG，因为当我的子视图沿其父垂直滚动视图滚动时，背景会发生变化（见图）。

我有一个不优雅的后备：让我的 uiview 剪辑它的子视图，并在滚动父滚动视图时移动背景的预渲染渐变 png。

![透明uiview渐变问题](../Images/bf52c1e90504379cfdf3cce9da8049dd.png)

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2012-06-01T18:17:58.830

这是一个令人尴尬的简单修复：应用 CAGradientLayer 作为我的子视图的蒙版。

```
CAGradientLayer *gradientLayer = [CAGradientLayer layer];
gradientLayer.frame = _fileTypeScrollView.bounds;
gradientLayer.colors = [NSArray arrayWithObjects:(id)[UIColor whiteColor].CGColor, (id)[UIColor clearColor].CGColor, nil];
gradientLayer.startPoint = CGPointMake(0.8f, 1.0f);
gradientLayer.endPoint = CGPointMake(1.0f, 1.0f);
_fileTypeScrollView.layer.mask = gradientLayer; 
```

感谢[Cocoanetics](http://www.cocoanetics.com/)为我指明了正确的方向！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-06-09T19:19:28.883

这就是我要做的。

**第 1 步**定义自定义渐变视图（Swift 4）：

```
import UIKit

class GradientView: UIView {
    override open class var layerClass: AnyClass {
        return CAGradientLayer.classForCoder()
    }

    required init?(coder aDecoder: NSCoder) {
        super.init(coder: aDecoder)
        let gradientLayer = self.layer as! CAGradientLayer
        gradientLayer.colors = [
            UIColor.white.cgColor,
            UIColor.init(white: 1, alpha: 0).cgColor
        ]
        backgroundColor = UIColor.clear
    }
} 
```

**第 2 步**- 在情节提要中拖放 a`UIView`并将其自定义类设置为`GradientView`

[![在此处输入图像描述](../Images/0f65d3a1bb409ce96c616e73a54f859c.png)](https://i.stack.imgur.com/0jxuj.png)

例如，上面的渐变视图如下所示：

![](../Images/d2bb2c439c695658d956c2f974940879.png)

* * *

[https://github.com/yzhong52/GradientViewDemo](https://github.com/yzhong52/GradientViewDemo)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-20T07:16:07.593

![渐变示例](../Images/8f21f55cf1c3c4c16bac62fb34ad0ad3.png)

我刚遇到同样的问题，最后写了自己的课。这似乎是严重的矫枉过正，但这是我能找到的唯一方法来做透明的渐变。你可以在这里看到我的[文章和代码示例](http://codingangry.com/index.php/site/article/ios_gradent_with_transparency)

它基本上归结为创建两个图像的自定义 UIView。一种是纯色，另一种是用作图像蒙版的渐变色。从那里我将生成的图像应用到 uiview.layer.content。

我希望它有帮助，乔

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-11-14T19:27:53.237

我使用了上面接受的（OP's）答案并遇到了[评论](https://stackoverflow.com/questions/10852405/uiview-transparent-gradient#comment19399396_10855407)中提到的相同问题- 当视图滚动时，从屏幕开始的所有内容现在都是透明的，被面具覆盖。

解决方案是将渐变层添加为**superview**的掩码，而不是**scroll view**的掩码。就我而言，我使用的是一个文本视图，它包含在一个名为`contentView`.

我添加了第三种颜色并使用 and代替`locations`，因此文本视图*下方*的项目仍然可见。`startPoint``endPoint`

 *```
let gradientLayer = CAGradientLayer()
gradientLayer.frame = self.contentView!.bounds
gradientLayer.colors = [UIColor.white.cgColor, UIColor.clear.cgColor, UIColor.white.cgColor]

// choose position for gradient, aligned to bottom of text view
let bottomOffset = (self.textView!.frame.size.height + self.textView!.frame.origin.y + 5)/self.contentView!.bounds.size.height
let topOffset = bottomOffset - 0.1
let bottomCoordinate = NSNumber(value: Double(bottomOffset))
let topCoordinate = NSNumber(value: Double(topOffset))
gradientLayer.locations = [topCoordinate, bottomCoordinate, bottomCoordinate]

self.contentView!.layer.mask = gradientLayer 
```

以前，在屏幕外开始的文本是永久不可见的。通过我的修改，滚动按预期工作，并且“关闭”按钮没有被遮罩覆盖。

[![截屏](../Images/dabb6db80648f594ae9b280fa128dd09.png)](https://i.stack.imgur.com/lbyw4.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T16:00:54.940

我不想这么说，但我认为你进入了 CUSTOM UIView 领域。我认为我会尝试在覆盖 drawRect 例程的自定义 UIView 中实现这一点。

有了这个，您可以拥有该视图，放置在您的实际滚动视图之上，并让您的渐变视图（如果您愿意）“传递”所有触摸事件（即放弃第一响应者）。*

# forms - 如何限制登录用户在表单中显示的信息？

> ID：10852407
> 
> 赞同：0
> 
> 时间：2012-06-01T14:43:38.623
> 
> 标签：forms, symfony

我有树主要实体、用户、工作组和项目。他们之间有一个名为 Collaboration 的中间实体。实际上我可以提供一个表格来添加一个包含用户信息和工作组信息的项目。我会按表单中的连接用户过滤工作组。

用户和工作组之间也存在关系，以了解谁是工作组的所有者。（用户在工作组上有一对多，工作组在用户上有多对一）

```
# MyNiceBundle/Form/Type/CollaborationType.php
class CollaborationType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder->add('project', new ProjectType());
        $builder->add('participant', 'entity', array(
            'class' => 'MyNiceBundle:User',
            'property' => 'email',
            'multiple' => false,
            'expanded' => true
        ));
        $builder->add('workgroup', 'entity', array(
            'class' => 'MyNiceBundle:Workgroup',
            'property' => 'name',
            'multiple' => false,
            'expanded' => true
        ));
    }
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:54:36.213

您可以使用事件来执行此操作。见这里：[http ://symfony.com/doc/master/cookbook/form/dynamic_form_generation.html](http://symfony.com/doc/master/cookbook/form/dynamic_form_generation.html)

可能在 FormEvents::POST_SET_DATA 事件上你会做这样的事情......

```
public function postSetData(DataEvent $event)
{
    $collaboration = $event->getData();
    $form = $event->getForm();
    $user = $collaboration->getParticipant();

    $form->add(
        $this->factory->createNamed('workgroup', 'entity', null, array(
                'class'         => 'MyNiceBundle:Workgroup',
                'required'      => false,
                'query_builder' => function(EntityRepository $er) use ($user) {
                    return $er->getWorkgroupsForUser($user);
                }
            )
        )
    );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T13:05:55.397

This question was answered here " [passing data from controller to Type symfony2](https://stackoverflow.com/questions/7807388/passing-data-from-controller-to-type-symfony2) "

```
# MyNiceBundle/Controller/ProjectController.php
// I passed as parameter argument the current logged user to my FormType
$form = $this->createForm(new CollaborationType($this->get('security.context')->getToken()->getUser()), new Collaboration);

# MyNiceBundle/Form/Type/CollaborationType.php
class CollaborationType extends AbstractType
{
    protected $user;

    public function __construct (User $user)
    {
        // Get the logged user
        $this->user = $user;
    }

    public function buildForm(FormBuilder $builder, array $options)
    {
        $user = $this->user;

        $builder->add('project', new ProjectType());
        $builder->add('participant', 'entity', array(
            'class' => 'MyNiceBundle:User',
            'property' => 'email',
            'multiple' => false,
            'expanded' => true
        ));
        // Here I sort workgroup by owner
        $builder->add('workgroup', 'entity', array(
            'class' => 'MyNiceBundle:Workgroup',
            'property' => 'name',
            'multiple' => false,
            'expanded' => true,
            'query_builder' => function(EntityRepository $er) use ($user) {
                return $er->createQueryBuilder('w')
                    ->where("w.owner = :user")
                    ->setParameter('user', $user);
            },
        ));
    } 
```

# php - Preg 匹配 2 个字符串之间的任何内容

> ID：10852409
> 
> 赞同：2
> 
> 时间：2012-06-01T14:43:51.033
> 
> 标签：php, regex, xpath

我必须从该站点获取号码的位置

lookupexpert.com/search_phone?phone_number=7322691678

我想要一个匹配里面任何东西的正则表达式

```
<p class="location">OCEAN GATE, NJ</p> 
```

我怎么做？

这就是我到目前为止所做的

```
<?php

$subject = file_get_contents("http://lookupexpert.com/search_phone?phone_number=7322691678");

$pattern = '#\<p class="location"\>(.+?)\<\/p\>#s';
preg_match($pattern, $subject, $matches, PREG_OFFSET_CAPTURE, 3);
print_r($matches);

?> 
```

还有...我尝试使用 Xpath，但效果不佳，因为它没有得到正确验证

```
/html/body/div/div[2]/div/ul/li[2]/p[4] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T14:52:46.560

尝试这个：

```
$subject = file_get_contents( 'http://www.lookupexpert.com/search_phone?phone_number=7322691678');
preg_match_all( '#<p class="location">(.*?)</p>#', $subject, $matches);
var_dump( $matches[1][1]); 
```

这输出：

```
string(14) "OCEAN GATE, NJ" 
```

[演示](http://codepad.viper-7.com/WGLLQV)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T14:56:15.020

**使用这个 XPath**

```
//p[@class='location']/text() 
```

**或这个正则表达式**

```
(?<=<p class="location">)([^<>]+)(?=</p>) 
```

**代码**

```
preg_match_all('%(?<=<p class="location">)([^<>]+)(?=</p>)%', $subject, $result, PREG_PATTERN_ORDER);
$result = $result[1]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T14:50:17.673

试试这个。。

```
$string = '<p class="location">OCEAN GATE, NJ</p>';
$pattern = '/<p class="location">(.*)<\/p>/';

$preg = preg_match_all($pattern, $string, $match);
print_r($match); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T15:00:03.343

最好不要依赖不可靠的正则表达式来解析 HTML，而是使用 DOM 解析器。使用这样的代码：

```
$doc = new DOMDocument();
libxml_use_internal_errors(true);
// assuming search_phone.html contains your saved HTML source
#$doc->loadHTMLFile('search_phone.html'); // loads your html
$xpath = new DOMXPath($doc);
$value = $xpath->evaluate("string(//li[starts-with(@class, 'recordItem')]/
                           p[@class='location']/text())"); 
echo "Location Name: [$value]\n"; // prints your location 
```

### 输出：

```
Location Name: [OCEAN GATE, NJ] 
```

# mysql - 删除时插入错误

> ID：10852416
> 
> 赞同：0
> 
> 时间：2012-06-01T14:44:11.443
> 
> 标签：mysql, sql, sql-server

所以我试图从表中删除一条记录，它得到了最奇怪的错误。

查询是

```
DELETE FROM table where column1='x' and column2='y' 
```

*请注意，出于安全原因，我为表和列输入了模拟名称。*

我收到错误的任何方式：

```
Msg 213, Level 16, State 1, Procedure CustomVLANPicsMaintenance, Line 11
Insert Error: Column name or number of supplied values does not match table definition. 
```

这很奇怪，因为这是删除而不是插入。这台服务器上有很多存储过程，但是这个特定的“CustomVLANPicsMaintenance”在任何地方都不存在！！！！！！它甚至与我试图从中删除行的表无关。更奇怪的是，直到最近，删除方法一直在起作用。我找不到该表中的任何链接或任何表明它应该在删除时运行程序的链接（尽管我不太确定在哪里可以找到它）。

以前有没有人得到过这样的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:48:32.853

我首先尝试检查表上是否存在任何 DELETE 触发器。在 Management Studio 中，触发器列表位于 Databases/%DB name%/Tables/dbo.%Table name%/Triggers 下。

# c++ - 检查 time_t 是否在其他 time_t 之间并有一定的误差

> ID：10852418
> 
> 赞同：3
> 
> 时间：2012-06-01T14:44:25.053
> 
> 标签：c++, time-t

我有两个 time_t 变量：timeA 和 timeB。

我想要做的是检查 timeA 是否与 timeB 相同。但是，我知道在某些情况下它们不会完全相同，并且它们两者之间可能存在 1 或 2 秒的差异，所以我真正想要检查的是：

```
 if (timeB - 2sec) <= timeA <= (timeB + 2sec) 
```

有可能这样做吗？

我想一种选择是不使用 time_t，而是将 timeB 保留为 tm 结构，并且在比较之前，减去两秒并创建 time_t timeBminus，然后添加四秒并创建 time_t timeBplus。问题是我将比较几百万个 timeA - timeB 对，并希望它尽可能简单和快速。

我该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T14:46:51.027

就像是 -

```
if (std::fabs(std::difftime(timeA, timeB)) < 2.0) 
```

（无法从这里检查确切的类型等，但我认为这个想法是正确的）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T14:58:21.180

尽管`time_t`通常代表秒，但实际上它不是标准行为。的细节`time_t`留待实现（根据[this](http://en.cppreference.com/w/c/chrono/time_t)）

与其`time_t`直接使用s，不如使用[`struct timespec`](https://en.cppreference.com/w/c/chrono/timespec)和使用`tv_sec`member。要检查它们是否彼此相距 2s：

```
static inline bool close_enough(struct timespec &ts1, struct timespec &ts2)
{
    const int64_t sec_in_nsec = 1000000000ll;
    int64_t ts1_nsec = ts1.tv_sec * sec_in_nsec + ts1.tv_nsec;
    int64_t ts2_nsec = ts2.tv_sec * sec_in_nsec + ts2.tv_nsec;

    return ts1_nsec >= ts2_nsec - 2 * sec_in_nsec && ts1_nsec <= ts2_nsec + 2 * sec_in_nsec;
} 
```

或在`if`. 函数调用将被优化掉，所以不用担心。按照其他答案中的建议使用`abs`很好，即使它将整数转换为浮点并执行浮点运算。

### 更新

使用`time_t`，您可以使用[`difftime`](http://en.cppreference.com/w/cpp/chrono/c/difftime)获得两次之间的差异。再次：

```
static inline bool close_enough(time_t &t1, time_t &t2)
{
    double d = difftime(t1, t2);
    return d >= -2 && d <= 2;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T14:46:55.850

```
if(abs(timeA - timeB) <= 2) {
  // yay!
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T15:02:49.467

如果你的编译器支持 c++11，你应该使用 chrono 而不是 ctime：

```
#include <iostream>
#include <chrono>
#include <tuple>

int main() {
    std::chrono::system_clock::time_point a,b;

    std::tie(a,b) = std::minmax(a,b);
    if ((b-a) < std::chrono::seconds(2)) {

    }
} 
```

这样你就知道时间之间的差异实际上小于 2*秒*，而不是简单的 2 个时钟滴答，其中滴答不一定是秒。

不幸的是，时钟持续时间没有 std::abs ，或者您只需编写`if (std::abs(b-a) < std::chrono::seconds(2))`，尽管编写自己的代码很容易：

```
template<typename Rep,typename Period>
std::chrono::duration<Rep,Period> abs(std::chrono::duration<Rep,Period> d)
{
  return std::chrono::duration<Rep,Period>(std::abs(d.count()));
} 
```

# php - php，如何删除包含所有内容（递归）的目录，但不理会存在文件的那些分支？

> ID：10852419
> 
> 赞同：0
> 
> 时间：2012-06-01T14:44:28.297
> 
> 标签：php, recursion, directory

如何删除包含所有文件和目录（递归）的目录，但是当有一个特殊的文件名时，该树及其子级将继续存在？

```
protected function _removeDir ($dir, &$found)
{
// is this directory exist?
if (!is_dir ($dir))
{
    return false;
}

// is there .ignore?
if (is_file ($dir.'/.ignore'))
{
    $found = true;
    return false;
}

// now iterate
foreach (new DirectoryIterator($dir) as $fileinfo)
{
    $absPath = $dir.'/'.$fileinfo->getFilename();
    if (is_file($absPath))
    {
        unlink ($absPath);
    }
    if (is_dir($absPath))
    {
        $this->_removeDir ($absPath, $found);
    }
}
if (!$found)
{
    rmdir ($dir);
}
return true; 
```

}

但它在不存在的目录上绊倒

# asp.net - 如何在 301 永久重定向中转换 404 错误代码

> ID：10852428
> 
> 赞同：0
> 
> 时间：2012-06-01T14:44:59.017
> 
> 标签：asp.net, iis, http-status-code-404, http-status-code-301

我想将我的 404 状态代码转换为 301。我在 SEO 中有顶级索引站点，如果机器人找不到我的页面，我不想失去我的位置。对于某些 URL，我得到 404 状态，并且通过重定向到具有 404 状态代码的另一个页面对 SEO 来说不是一件好事。所以我想将状态代码转换为 301，这样它就不会影响我的索引。我想在它给出 404 时设置 301 状态码。我的网站在 asp.net 1.1 中，我之前尝试过很多解决方案。一些解决方案给我 301 而不是 404 状态码，但它们在第二步中给出。意味着首先他们给 302 然后他们给 301。但我不想那样做。我想直接从 404 到 301。asp.net 1.1 和 IIS 可以吗？

请帮助我。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:52:13.463

您可以使用应用程序的 web.config 配置错误重定向。这是一个例子：

```
<customErrors mode="On" defaultRedirect="~/somecatchallpage.aspx?type=error">
    <error statusCode="404" redirect="somecatchallpage.aspx?type=404"/>
    <error statusCode="301" redirect="somecatchallpage.aspx?type=301"/>
</customErrors> 
```

这是一些额外的阅读（对于 asp.net 1.1 版）：[customErrors 元素](http://msdn.microsoft.com/en-us/library/h0hfz6fc%28v=vs.71%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T09:50:41.237

你用 global.asax 试过了吗？

```
void Application_Error(object sender, EventArgs e) 
{
    Exception exception = Server.GetLastError();

    if (exception is HttpException)
    {
        Response.Redirect(..);
    }
} 
```

# android - 如何可靠地确定多行字符串的宽度？

> ID：10852431
> 
> 赞同：14
> 
> 时间：2012-06-01T14:45:05.320
> 
> 标签：android

我正在尝试计算多行文本段落的宽度。据我所知，在 Android 中唯一可以做到这一点的类是 StaticLayout（或 DynamicLayout）类。当使用这个类时，我没有得到我的文本片段的正确长度，而是测量的尺寸有时更小，有时更大，具体取决于文本大小。

所以我基本上是在寻找一种可靠地测量多行文本字符串宽度的方法。

下图显示了测量的宽度如何与各种文本大小的实际文本长度不同。![发散的文本和度量](../Images/092bfad1213087b70dd8837fbd37c1c8.png)

屏幕截图是在自定义视图中运行以下代码创建的：

```
@Override
protected void onDraw( Canvas canvas ) {
  for( int i = 0; i < 15; i++ ) {
    int startSize = 10;
    int curSize = i + startSize;
    paint.setTextSize( curSize );
    String text = i + startSize + " - " + TEXT_SNIPPET;
    layout = new StaticLayout( text,
                               paint,
                               Integer.MAX_VALUE,
                               Alignment.ALIGN_NORMAL,
                               1.0f,
                               0.0f,
                               true );

    float top = STEP_DISTANCE * i;
    float measuredWidth = layout.getLineMax( 0 );
    canvas.drawRect( 0, top, measuredWidth, top + curSize, bgPaint );
    canvas.drawText( text, 0, STEP_DISTANCE * i + curSize, paint );
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T21:51:04.413

您可以尝试使用获取文本边界。

```
private int calculateWidthFromFontSize(String testString, int currentSize)
{
    Rect bounds = new Rect();
    Paint paint = new Paint();
    paint.setTextSize(currentSize);
    paint.getTextBounds(testString, 0, testString.length(), bounds);

    return (int) Math.ceil( bounds.width());
}

private int calculateHeightFromFontSize(String testString, int currentSize)
{
    Rect bounds = new Rect();
    Paint paint = new Paint();
    paint.setTextSize(currentSize);
    paint.getTextBounds(testString, 0, testString.length(), bounds);

    return (int) Math.ceil( bounds.height());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-08T11:56:50.483

这是一种可以获得任何文本长度的多行宽度的方法。`usableButtonWidth`可以是给定的文本空间。我使用`usableButtonWidth`= 按钮的宽度 - 填充。但是可以使用任何默认值。

使用 StaticLayout，您可以获得`usableButtonWidth`. 然后我只是尝试通过在循环中将其减小 1px 来减小可用宽度。如果高度增加，那么我们就会知道之前使用的宽度是允许的最大宽度。

将此值作为多行文本的宽度返回。

```
private int getTextWidth(){
    if(this.getText().length() != 0){
        Paint textPaint = new Paint();
        Rect bounds = new Rect();
        textPaint.setTextSize(this.getTextSize());
        if(mTypeface != null){
            textPaint.setTypeface(mTypeface);
        }
        String buttonText = this.getText().toString();
        textPaint.getTextBounds(buttonText, 0, buttonText.length(), bounds);

        if(bounds.width() > usableButtonWidth){
            TextPaint longTextPaint = new TextPaint();
            longTextPaint.setTextSize(this.getTextSize());
            if(mTypeface != null){
                longTextPaint.setTypeface(mTypeface);
            }
            StaticLayout staticLayout = new StaticLayout(this.getText(), longTextPaint, usableButtonWidth,
                    Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            int textLineCount = (int)Math.ceil(staticLayout.getHeight() / bounds.height());
            int multiLineTextWidth = usableButtonWidth;
            while ((int)Math.ceil(staticLayout.getHeight() / bounds.height()) == textLineCount && multiLineTextWidth > 1){
                multiLineTextWidth--;
                staticLayout = new StaticLayout(this.getText(), longTextPaint, multiLineTextWidth,
                        Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            }
            return multiLineTextWidth+1;
        } else {
            return bounds.width();
        }
    } else {
        return 0;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-01T02:55:22.507

我有一个类似的问题，测量的文本宽度有一点偏差，一旦你为油漆设置了字体，这就会消失。所以在你使用`paint`对象之前`StaticLayout`只需要设置Typeface：

```
textPaint.setTypeface(Typeface.create("sans-serif", Typeface.NORMAL)) 
```

或任何你想要的字体。

# ios - 为什么通过javascript设置列宽和间隙后UIWebView不重排文本？

> ID：10852435
> 
> 赞同：3
> 
> 时间：2012-06-01T14:45:25.197
> 
> 标签：ios, css, uiwebview, uiwebviewdelegate

我正在将一个 html 文件加载到 UIWebView 中，并通过 webViewDidFinishLoad 中的 javascript 设置“-webkit-column-width”和“-webkit-column-gap”样式属性，但文本不会重排到列中。

```
- (void)viewDidLoad
{
    [super viewDidLoad];    
    NSURL *urlForView = [self.book.chapterURLs objectAtIndex:0];
    self.webView.delegate = self;
    self.webView.scrollView.bounces = NO;
    self.webView.scrollView.pagingEnabled = YES;
    [self.webView loadRequest:[NSURLRequest requestWithURL:urlForView]];
}

- (void) webViewDidFinishLoad:(UIWebView *)webView
{   
    NSString *jsString = @"document.getElementsByTagName('body')[0]. setAttribute('style','-webkit-column-width: 733px; -webkit-column-gap: 20px;');)";
    [self.webView stringByEvaluatingJavaScriptFromString:jsString]; 
```

}

我已经通过警报确认样式属性设置正确，所以我不明白为什么它们没有效果。通过 Safari 中的控制台执行相同的 javascript 字符串具有预期的效果。知道为什么这在 UIWebView 中不起作用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:54:37.460

我仍然不明白为什么上面的代码不起作用，但我能够通过 javascript 获取文件的外部样式表，然后通过 javascript 编辑该 CSS 文件来找到解决方法。

```
NSString *varMySheet = @"var mySheet = document.styleSheets[0];";

NSString *addCSSRule =  @"function addCSSRule(selector, newRule) {"
"ruleIndex = mySheet.cssRules.length;"
"mySheet.insertRule(selector + '{' + newRule + ';}', ruleIndex);"   // For Firefox, Chrome, etc.
"}";

NSString *insertRule1 = [NSString stringWithFormat:@"addCSSRule('html', 'padding: 0px; height: %fpx; -webkit-column-gap: 0px; -webkit-column-width: %fpx;')", webView.frame.size.height, webView.frame.size.width];
NSString *insertRule2 = [NSString stringWithFormat:@"addCSSRule('p', 'text-align: justify;')"];
//NSString *setTextSizeRule = [NSString stringWithFormat:@"addCSSRule('body', '-webkit-text-size-adjust: %d%%;')", currentTextSize];

[webView stringByEvaluatingJavaScriptFromString:varMySheet];

[webView stringByEvaluatingJavaScriptFromString:addCSSRule];

[webView stringByEvaluatingJavaScriptFromString:insertRule1];

[webView stringByEvaluatingJavaScriptFromString:insertRule2]; 
```

向我发现此代码的[AePubReader 项目致敬。](https://github.com/fedefrappi/AePubReader)

# c# - 为什么 Request.ServerVariables["HTTP_HOST"] 与 Request.Url.Host 不同？

> ID：10852440
> 
> 赞同：7
> 
> 时间：2012-06-01T14:45:36.303
> 
> 标签：c#, asp.net

相同的服务器，相同的站点 - 两种不同的结果。

# 情况1

请求 URL：domain.com（解析为 domain.com/default.aspx）Firebug
中的请求标头：domain.com
`Request.ServerVariables["HTTP_HOST"]`= domain.com
`Request.Url.Host`= domain.com（好的，这很好，也是预期的）

# 案例2

请求 URL：domain.com/default.aspx
Firebug 中的请求标头：domain.com
`Request.ServerVariables["HTTP_HOST"]`= domain.com
`Request.Url.Host`= **app5**（服务器名称）

查看两个请求，我看不到任何会导致这种情况的东西。为什么会这样？
服务器正在运行 Windows 2003 和 IIS6。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-22T12:02:08.800

您应该检查 IIS 元数据库是否设置为使用主机名或其他名称

命令->`cscript adsutil.vbs get W3SVC/SITE-ID/USEHOSTNAME`

结果 -> 应该是

`The parameter "USEHOSTNAME" is not set at this node.`

或者 `USEHOSTNAME : (BOOLEAN) False`

命令->`cscript adsutil.vbs get W3SVC/SITE-ID/SETHOSTNAME`

结果 -> 应该是

`The parameter "SETHOSTNAME" is not set at this node.`

或者`SETHOSTNAME : (STRING) ""`

用站点的数字 id 更改 SITE-ID。

如果您看到任何其他结果，这意味着有人修改了网站的上述两个属性。

# ios - cordova / phonegap 应用程序，加载时屏幕跳跃约 15px

> ID：10852441
> 
> 赞同：1
> 
> 时间：2012-06-01T14:45:37.460
> 
> 标签：ios, xcode, cordova

我制作了一个phonegap / cordova 1.7应用程序，它一切正常，但是当我加载一个页面时，它加载它大约15px太低然后跳起来..这只需要一秒钟的时间，但跳跃是显而易见的。我认为它与隐藏状态栏有关，我使用`Status bar is initially hidden : YES`plist 中的 隐藏它，我相信它只会在加载时隐藏它而不是永久隐藏它。

有一个更好的方法吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:52:15.647

iOS 正确，这仅在 iPad 上吗？你有启动图像集吗？如果是这样，您需要注意 Apple 关于启动图像正确尺寸的指南，并使其比应有的尺寸高 20 像素。您应该看到 20 像素的跳跃，而不是 15 像素。对于 Retina 显示器，您需要使启动图像比 Apple 的准则高 40 像素。

让我挖掘一个确认这种行为的链接。我自己刚刚经历过。

编辑：这里的链接[Phonegap iPad App Splash / Launch Screen Shifts on deviceReady](https://stackoverflow.com/questions/7476129/phonegap-ipad-app-splash-launch-screen-shifts-on-deviceready)

在我的 iOS Cordova 应用程序中，使启动图像比指南（非 Retina）高 20px 和比指南（Retina）高 40px 解决了这个问题。唯一剩下的是 Xcode 中的警告，即图像大小不正确。但是它仍然有效，Apple 不会因此而拒绝。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T08:05:51.933

```
[[UIApplication sharedApplication] setStatusBarHidden:YES]; 
```

上面的代码片段（用*didFinishLaunchingWithOptions*方法编写）最初在启动屏幕运行时隐藏了 iPad 状态栏。

现在将以下代码放在*webViewDidFinishLoad*方法中，以在加载应用程序后显示状态栏

```
if([[UIApplication sharedApplication] respondsToSelector:@selector(setStatusBarHidden: withAnimation:)])
        [[UIApplication sharedApplication] setStatusBarHidden:NO withAnimation:UIStatusBarAnimationFade];
    else 
        [[UIApplication sharedApplication] setStatusBarHidden:NO]; 
```

*注意：*相应调整body css（我放置了top:20px来调整body位置）

谢谢，Prodeveloper。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T14:56:38.693

我刚刚将我的应用程序初始屏幕图像放大了 20 像素，现在它工作正常。

# android - Android - VideoView - onTouch 的行为不符合预期

> ID：10852442
> 
> 赞同：3
> 
> 时间：2012-06-01T14:45:38.980
> 
> 标签：android, android-layout, android-intent, android-emulator, android-widget

我正在学习教程并尝试通过 Android 的 VideoView 构建自定义视频播放器。
现在，当我触摸 VideoView 时，我想显示或隐藏媒体控制器。如果控制器已经显示，则隐藏它们，如果它们被隐藏，则显示它们。

这些媒体控制器由位于 VideoView 上的 2 个 LinearLayout 表示。以红色突出显示的区域代表背景中的 VideoView 边框。

我的问题是，当我触摸与 VideoView 重叠的媒体控制器区域时，媒体控制器被隐藏了。这不是想要的效果，因为我不是直接接触 VideoView，而是 LinearLayout。

**那么，为什么当我单击 LinearLayouts 时 Videoview 会捕捉到触摸事件？**

![在此处输入图像描述](../Images/7ad58e70db5313cff320abc9a9d0c5e3.png)

这是我的`onTouch`实现：

```
@Override
    public boolean onTouch(View v, MotionEvent event) {

        if (!isMediaControlerShown) {
            topPanel.setVisibility(View.VISIBLE);
            bottomPanel.setVisibility(View.VISIBLE);
            isMediaControlerShown = true;
        } else {
            topPanel.setVisibility(View.GONE);
            bottomPanel.setVisibility(View.GONE);
            isMediaControlerShown = false;
        }
        return false;
    } 
```

以及 XML 布局的架构：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

<VideoView
        android:id="@+id/videoView"
        android:layout_width="wrap_content"
        android:layout_centerInParent="true"
        android:layout_height="wrap_content" />

<!-- The top panel of the Video Player -->

    <LinearLayout
        android:visibility="gone"
        android:id="@+id/top_panel"
        style="@style/VideoTopPanel"
        android:orientation="vertical" >

        <!-- ////// -->
    </LinearLayout>

<!-- The bottom panel of the Video Player -->

    <LinearLayout
        android:visibility="gone"
        android:id="@+id/bottom_panel"
        xmlns:android="http://schemas.android.com/apk/res/android"
        style="@style/VideoBottomPanel"
        android:orientation="vertical"
        android:layout_alignParentBottom="true"
        android:paddingBottom="@dimen/video_bottom_panel_padding_bottom"
        android:paddingTop="@dimen/video_bottom_panel_padding_top" >

       <!-- ////// -->
    </LinearLayout>
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T13:00:35.697

通过为持有控件的视图设置一个点击监听器解决了这个问题，但在 onClick() 上什么也不做。这样，视图收到了点击事件并且没有消失。

# c# - Clr dll .net 控件

> ID：10852445
> 
> 赞同：0
> 
> 时间：2012-06-01T14:45:44.043
> 
> 标签：c#, c++, winforms, dll, clr

我需要在 C# winforms 宿主项目的运行时从 DLL 动态加载一些 .NET 控件。

例如：

1.dll约束control1

2.dll约束control2

3.dll约束control3

主机应用程序可以加载任何此 dll-s，从 dll 获取控件并将其置于自身形式。

我试过：

```
__declspec(dllexport) TestCLRPlugin::Properties ^ GetControl()
{
    return gcnew TestCLRPlugin::Properties();
} 
```

但是，clrcall 方法不能从 dll 中导出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:47:42.077

您需要使用[Assembly.LoadFrom](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.loadfrom.aspx)方法，然后可以使用反射从程序集中获取所需的方法/类/等。如果您按照 MSDN 链接进行操作，将会有很好的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:48:50.290

我不太确定你在找什么，但你可能想阅读反射，这很容易：

[http://msdn.microsoft.com/en-us/library/ms173183(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ms173183(v=vs.80).aspx)

抱歉，如果您已经熟悉或没有帮助。

# javascript - IE 8/9 中 FormData 的后备

> ID：10852446
> 
> 赞同：32
> 
> 时间：2012-06-01T14:45:43.987
> 
> 标签：javascript, ajax, xmlhttprequest, fileapi

IE 8/9 中不存在[FormData ，但我需要这些浏览器中的该功能。](https://developer.mozilla.org/en/DOM/XMLHttpRequest/FormData/Using_FormData_Objects)有一个很好的后备方案吗？

我会尝试通过 json 数据发送，但我需要将文件传递给服务器。我将此文件附加到`formData`现代浏览器中，然后提交一个`XHR`请求。因为`FormData`在 IE 8/9 中不存在这显然失败了。

```
// I cant seem to get this to work with a file.
$.ajax({
    url: '/genericHandlers/UploadDocsFile.ashx',
    type: "POST",
    data: model.toJSON(),
    contentType: 'application/json'
    }).done(function  (data) { 
       log('stuff happened!');
    }); 
```

也许另一种方法是在 js 中创建一个假表单对象，然后将数据附加到该对象？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-05T06:57:21.467

我只知道一种可能的解决方案，但这并不是 IE 真正的 1-1 后备方案。没有可能用于发送文件的通信 API，因为您无法在旧浏览器中绑定输入字段，例如在使用 FormData 的现代浏览器中。但是您可以使用 iframe 发送整个表单。对于这种情况，您可以使用支持 XHR DataForm 和 iframe 的[jquery.form](https://github.com/malsup/form)插件（当浏览器不支持 FormData API 时，数据使用 iframe 发送）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-05T15:25:25.107

您可以使用 XMLHttpRequests 手动发送文件，这里有很多[信息](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest#Submitting_forms_and_uploading_files)。

您可以测试浏览器是否可以`FormData`首先使用该对象：

```
if(typeof FormData !== 'undefined')
   ... 
```

MDN 有一个[this 函数](https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Forms/Sending_forms_through_JavaScript#Building_an_XMLHttpRequest_manually)，你可以修改它作为后备：

```
var XHR = new XMLHttpRequest();
var urlEncodedData = "";
var urlEncodedDataPairs = [];
var name;

// We turn the data object into an array of URL encoded key value pairs.
for(name in data) {
  urlEncodedDataPairs.push(encodeURIComponent(name) + '=' + encodeURIComponent(data[name]));
}

// We combine the pairs into a single string and replace all encoded spaces to 
// the plus character to match the behaviour of the web browser form submit.
urlEncodedData = urlEncodedDataPairs.join('&').replace(/%20/g, '+'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-04T16:20:24.393

此答案并未严格解决您提出的问题，因此我了解 Mods 是否会删除它。

但是，您的问题与我正在研究的一个问题密切相关，即**如何通过 FormData() 提供拖放上传，并为旧浏览器提供优雅降级**？

有一个很棒的库叫做[dropzone.js](https://www.dropzonejs.com/#donate "dropzone.js")，它为我的问题提供了一个完美的解决方案。也许最好的部分是该库提供了开箱即用的优雅降级以支持旧浏览器上的文件上传，[详见此处](http://yaizabailen.com/upload-files-from-a-web-browser-support-for-old-and-modern-browsers-dropzone-js-and-the-jquery-iframe-transport-js-plugin/#prettyPhoto "使用 dropzone.js")。

转述来源：

> 幸运的是，如果不支持浏览器，dropzone.js 库会显示一个可自定义的后备类，其中包含一个输入字段和一个提交按钮。

我希望这些信息可以帮助像我一样正在寻找一种简单易用且优雅的文件上传解决方案的人。

# php - 检测网站是否已经打开并重用窗口

> ID：10852459
> 
> 赞同：1
> 
> 时间：2012-06-01T14:46:31.187
> 
> 标签：php, javascript, url, window

我试图找出是否有办法在电子邮件中打开 url 链接并在某个页面（或站点）已经打开时重用一个窗口。我所拥有的是一个“忘记密码”页面，用户输入他们的电子邮件地址并被问到一个安全问题，然后发送一封带有 url 链接的纯文本电子邮件（因此没有 html 链接属性）并向用户报告它有做得很好。当用户点击链接时，它会打开一个闪亮的新浏览器窗口并忽略旧的报告页面，让它感到悲伤和不受欢迎。我想知道是否有办法重用此窗口或更具体地说是忘记密码报告页面。也许我可以用 javascript 命名页面或检测 url 是否已经以某种方式打开。或者，如果我确实决定使用 html 电子邮件，是否有可能，所以大多数人都会从中受益。

请帮助我的报告页面再次被爱和想要。谢谢

我正在使用 PHP，我可以使用 javascript 或 jquery 浏览器端，或者任何其他可能适合这个的东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:55:25.887

这完全由浏览器决定；某些浏览器可能会猜到您要执行的操作并将现有选项卡替换为新页面，但总的来说这没有意义。

这是你可以做的（虽然它不是真正的技术）：

1.  输入并提交电子邮件后，表单页面会更改并要求他们提供发送给他们的安全代码。

2.  在电子邮件中，您以清晰的方式打印安全代码，以便用户双击并复制到他们的剪贴板；然后他们会再次切换到他们的浏览器（您的页面仍然打开）并粘贴该值。当然，您仍然可以提供链接以方便用户使用。

顺便说一句，为了让用户轻松选择代码以复制到他们的剪贴板中，我发现使用`base32`编码是最好的；即使使用 iOS 设备，也可以轻松选择这些代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:58:30.580

您可以让电子邮件打开的页面发送[`postMessage`](https://developer.mozilla.org/en/DOM/window.postMessage)请求，并让其他页面的答案仍然打开。如果发生这种情况，新标签可能会立即关闭。

但是，选项卡/窗口之间的切换发生在操作系统或浏览器级别，而不是页面级别，并且无法使用 JavaScript 切换到打开的选项卡。你可以编写一个浏览器扩展来完成它，但这对于如此琐碎的事情可能是不合适的，而且没有人会费心安装它。

# jquery - 单击时，如何让 2 个具有相同类的 div 同时淡入它们的子元素？

> ID：10852466
> 
> 赞同：0
> 
> 时间：2012-06-01T14:46:56.430
> 
> 标签：jquery, class, click, fadein

我现在正在挠头。

我有一个带有 2 个按钮的图像，可能会变成 3、4、5 等等。每个按钮都有一个点击功能，会在图片旁边的信息框中淡出。信息框会因每个按钮而异，例如按钮 1 可能是关于羊的，按钮 2 可能是关于狗的。然后，我将具有单击每个按钮以在fadeToggle 上一一显示信息框的功能。

我遇到的问题是每个容器都有相同的类，所以我得到了该容器的第二个子元素并将其淡入，但它只在第一个点击的元素中淡入等等。

请参阅下面的标记并进行解释。

**jQuery**

```
 var children = $(".anatomy").children().eq(1);

$(document).ready(function(){     
    fadeDetail();
});

function fadeDetail() {

    $(".anatomy div.control").click(function() {
        children.each(function(){
        $(this).fadeToggle('slow');
        })
    });

} 
```

Html - 这里的 .control 按钮打开了设置为 display: none 的 .detail 框；一个页面上可能有多个这样的框，每个框在 .detail div 中都有不同的内容。

```
<article class="anatomy">
    <!-- custom field data will allow these to be positioned via cms-->
       <div class="control" style="left:; right:; top:300px; bottom:;">
            <img src="img/more-button.png" alt="more-button" width="37" height="36" />
        </div>
        <!-- hide this div as it will not be needed. Only needed when asked to open-->
        <div class="detail">
        <img src="img/articles/detail-image.png" alt="detail-image" width="340" height="217" />
        <h1>Lorem ipsum</h1>
        <p>Hello</p>
        </div>
</article> 
```

我想我快到了，但我的知识还没有到我害怕的程度。

任何提示都会很棒，

谢谢

标记

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:51:24.817

如果我理解正确，您只需要`div.detail`点击`div.control`. 你可以尝试重写你的函数，如下所示，

```
$(".anatomy div.control").click(function() {
    $(this).next().fadeToggle('slow');        
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:50:43.840

```
$('.control').on('click', function() {
  $(this).next().fadeToggle();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T14:52:00.217

为什么不为单击项目时要隐藏的每个元素添加一个类，然后调用

```
 $('.classToFade').fadeToggle('slow') 
```

# .net - IIS7 url重写，其中域仅是常量

> ID：10852469
> 
> 赞同：0
> 
> 时间：2012-06-01T14:47:06.187
> 
> 标签：.net, regex, iis, iis-7

我想要以下链接的 URL 模式 -

[http://www.test.com/xyz/31052012/xyz_number.jpg](http://www.test.com/xyz/31052012/xyz_number.jpg)

将重定向到

[http://www.test.com/xyz_number.jpg?vin=xyz&date=31052012](http://www.test.com/xyz_number.jpg?vin=xyz&date=31052012)

注意：xyz_number 和日期值是动态的，每个请求都会改变。这里只有常量是域名。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:14:49.477

我对 IIS7 重写一无所知，但根据您的示例源 URL 和输出 URL，您可以使用以下正则表达式查找：

```
^([^/]+)/([^/]+)/(.+)$ 
```

并替换为：

```
{R:3}?vin={R:1}&date={R:2} 
```

查找字符串本质上只是扫描原始 URL，直到找到已知边界。括号用于捕获组，替换字符串中的 {R:x} 值是捕获位置。

该模式要求每个源 URL 元素都按指定的顺序排列。

编辑：根据编辑的问题更新

这个新的正则表达式假定输入字符串以 xyz_number... 开头，而不是完整的域名。这似乎是其他 IIS7 重写问题的答案。

# python - 尝试在 OpenERP 6.0.3 中将 .sxw 文件转换为 .rml 时出错

> ID：10852470
> 
> 赞同：0
> 
> 时间：2012-06-01T14:47:06.990
> 
> 标签：python, openerp

```
[2012-06-01 15:33:10,638][molisamples] ERROR:web-services:Uncaught exception
Traceback (most recent call last):
  File "osv\osv.pyo", line 122, in wrapper
  File "osv\osv.pyo", line 176, in execute
  File "osv\osv.pyo", line 167, in execute_cr
  File "C:\Program Files (x86)\OpenERP 6.0\Server\addons\base_report_designer\base_report_designer.py", line 42, in sxwtorml
  File "C:\Program Files (x86)\OpenERP 6.0\Server\addons\base_report_designer\openerp_sxw2rml\openerp_sxw2rml.py", line 309, in sxw2rml
  File "C:\Program Files (x86)\OpenERP 6.0\Server\addons\base_report_designer\openerp_sxw2rml\openerp_sxw2rml.py", line 294, in unpackNormalize
  File "C:\Program Files (x86)\OpenERP 6.0\Server\addons\base_report_designer\openerp_sxw2rml\openerp_sxw2rml.py", line 269, in oo_read
  File "zipfile.pyo", line 346, in **init**
  File "zipfile.pyo", line 366, in _GetContents
  File "zipfile.pyo", line 378, in _RealGetContents
BadZipfile: File is not a zip file 
```

当我尝试将刚设计的报告转换为 .rml（使用 Open Office Writer）时，出现上述错误。请问可能是什么问题。我在这里很困惑

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-11T08:34:28.393

您可以使用 base_report_designer 模块将 .sxw 转换为 .rml。

尝试以下步骤：

打开终端 -> 像这样进入 openerp_sxw2rml 文件夹：

**cd 插件/base_report_designer/openerp_sxw2rml**

然后运行这个命令：python openerp_sxw2rml.py sxw 的绝对路径 > rml 的绝对路径

像这样：

**python openerp_sxw2rml.py /home/arya/my_module/report/my_report.sxw > /home/arya/my_module/report/my_report.rml**

这会将 sxw 文件转换为 rml，您可以在 rml 的给定路径找到您的文件。

谢谢你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T10:35:51.133

我想到了。我在报告的 python 解析器文件中有一些错误。这就是造成问题的原因。现在已经修好了。谢谢大家的帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T22:14:10.240

确保在 Openoffice Writer 中保存时，选择旧格式，即带有 SXW 扩展名的格式。

不要只输入 .sxw，通过在文件格式选择框中选择正确的条目，确保程序自行将其放在那里（我忘记了完整的标题，无法检查 atm）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T21:32:24.870

该错误表明该文件不是 zip 文件，因此可能需要 sxw 文件的压缩格式。您是否有机会以 OpenOffice 的未压缩格式保存文件？

# algorithm - 如何有效地将嵌套集转换为对象层次结构

> ID：10852472
> 
> 赞同：0
> 
> 时间：2012-06-01T14:47:09.883
> 
> 标签：algorithm, nested-sets

假设我有一个代表嵌套集层次结构的节点列表（示例在伪 c# 中）。

```
class Node
{
    public decimal left;
    public decimal right;
    public decimal id;
    public void AddChild(Node child) {...}
    ...
}

List<Node> nodes = GetFlatNodesWithoutChildrenSetFromDatabase(); 
```

字段`left`和被填充`right`，`id`因为这些值存储在某个数据库中。

将这个平面列表转换为层次结构的有效方法是什么，这意味着为每个父节点填充适当的子节点？

一种方法是找到每个节点的所有祖先，对它们进行排序以找到父节点并将子节点添加到该节点。

```
foreach (var n in nodes)
{
    var parent = nodes.Where(i => i.left < n.left && i.right > n.right).OrderBy(i => i.right - n.right).FirstOrDefault();
    if (parent != null)
        parent.AddChild(n);
} 
```

但这是相当低效的。

有没有更好（这意味着更快）的方法？

**编辑**

可能的解决方案（[如 Chris 建议的那样](https://stackoverflow.com/a/10852876/142637)）：

```
var stack = new Stack<Node>(nodes.Take(1));
foreach (var n in nodes.Skip(1))
{
    while (stack.Peek().right < n.left)
        stack.Pop();

    stack.Peek().addChild(n);
    stack.Push(n);
} 
```

节点必须按 排序`left`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:11:38.837

我可能会考虑探索的方法是按左排序，然后你可以迭代一次。

当您到达左侧并将其粘贴在堆栈上时，您“打开”了一个节点。

当您到达要处理的新节点时，您可以通过确定其右侧是否小于新节点左侧来检查堆栈顶部的节点是否应该关闭。如果是，您将它从堆栈中移除（关闭它）并且您已经处理了它的所有子级。然后，您检查堆栈的新顶部，直到找到仍然打开的堆栈。然后将当前节点作为子节点添加到堆栈顶部的节点，然后打开该节点（因此它位于堆栈顶部）。

您链接的维基百科页面上的图表（[http://en.wikipedia.org/wiki/Nested_set_model](http://en.wikipedia.org/wiki/Nested_set_model)）是我对此的启发。

![嵌套集图](../Images/437fd052b4db7e0203d81bd47ee5a978.png)

我的算法基本上在中间行进，每当你进入其中一个集合时，我称之为打开，离开一个集合就是关闭。很明显，您最近打开但未关闭的集合将位于堆栈的顶部，因此您放置孩子的位置。

我认为由于排序的原因，它的复杂性应该是 O(nlogn)。其余的只是 O(n)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-27T21:20:40.830

我知道这个问题已经很老了（我没有找到关于该主题的任何其他问题/信息）而且我不知道“伪 C#”，但以防万一你们中的一些人对嵌套集合列表的递归算法感到困惑=>树算法，这是我来到的（在scala中）：

```
def retrieveUserFolderTree(user: User): Future[List[Folder]] = {
  // Get a list of user's folders orderred by left asc
  val dbFoldersPromise = folderDAO.findUserFolders(user)

  dbFoldersPromise.map {
    case rootFolder :: tail => generateChildren(0, rootFolder.right, tail)
    case Nil => Nil
  }
}

private def generateChildren(currentLeft: Int, currentRight: Int, dbFolders: Seq[DBFolder]): List[Folder] = {
  dbFolders match {
    case dbFolder :: tail if dbFolder.left > currentRight => Nil
    case dbFolder :: tail if dbFolder.left > currentLeft => Folder(dbFolder.id, dbFolder.name, generateChildren(dbFolder.left, dbFolder.right, tail)) :: generateChildren(dbFolder.right, currentRight, tail)
    case dbFolder :: tail => generateChildren(currentLeft, currentRight, tail)
    case Nil => Nil
  }
} 
```

希望这会对某人有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-03T15:41:52.337

也许我在某个地方错过了一步，但是当我使用上面的逻辑处理这个问题时，我最终在堆栈上发现了几个重复的元素。它们按预期在树中，但另外它们也在根节点上方的堆栈顶部。我不得不在最后添加一个小循环来清理堆栈。

```
 var stack = new Stack<DvrNode>(nodes.Take(1));
        foreach (var n in nodes.Skip(1))
        {
            while (stack.Peek().Right < n.Left)
                stack.Pop();

            ((List<DvrNode>)stack.Peek().Children).Add(n);
            stack.Push(n);
        }

        while (stack.Peek().Left != 1)
            stack.Pop(); 
```

# android - 如何将数据更新到数据库中[编辑用户信息]

> ID：10852474
> 
> 赞同：0
> 
> 时间：2012-06-01T14:47:14.257
> 
> 标签：android, sqlite

我想在android中创建一个应用程序，它允许用户编辑个人信息并再次保存它，它必须覆盖旧信息....我试过但我没有赢:(..我是android新手在这里帮助我的代码....

数据库.../////

//--更新记录-- public boolean updateRecords(long rowId, String NAME ,String SURNAME, String DateOfBirth, String HomeAddress,String EmailNO, String PhoneNumber, String City,String TypePayment, String ShippingType,String CardNumber,String Username, String密码）

{ 内容值参数 = 新的内容值（）；

```
args.put(COLUMN_NAME,NAME);
args.put(COLUMN_SURNAME,SURNAME);
args.put(COLUMN_DATE_OF_BIRTH,DateOfBirth);
args.put(COLUMN_ADDRESS,HomeAddress);
args.put(COLUMN_EMAIL,EmailNO);
args.put(COLUMN_PHONE_NUMBER,PhoneNumber);
args.put(COLUMN_CITY,City);
args.put(COLUMN_PTYE_PAYMENT,TypePayment);
args.put(COLUMN_SHIPPING_TYPE,ShippingType);
args.put(COLUMN_CARD_NUMBER,CardNumber);
args.put(COLUMN_username,Username); 
args.put(COLUMN_Password,Passwords);

return db.update(USERS_TABLE, args,COLUMN_ID + "= "+ rowId,null)>0;

} 
```

而且我不知道如何在活动课程中更新它..帮助我:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:54:40.147

**您调用错误的更新方法**

这`db.update(USERS_TABLE, args,COLUMN_ID + "= "+ rowId,null)`很危险，用它替换它，可能会出现问题。如果它不起作用，问题将在其他地方。

```
db.update(USERS_TABLE, args, COLUMN_ID + "=?", new String[] {String.valueOf(rowID)}) > 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:52:42.743

您应该知道联系人 ID 以便更新。

[http://www.higherpass.com/Android/Tutorials/Working-With-Android-Contacts/](http://www.higherpass.com/Android/Tutorials/Working-With-Android-Contacts/)也很有帮助。

谢谢

# angularjs - Awesomium 中的 DOM 异常 18

> ID：10852475
> 
> 赞同：1
> 
> 时间：2012-06-01T14:47:17.800
> 
> 标签：angularjs, awesomium

我有一个从本地文件系统加载并使用[awesomium](http://awesomium.com/)呈现的网页，该页面使用[AngularJS](http://angularjs.org/#/list)呈现页面的一部分。但是，我的 AngularJS 控制器的一部分产生了 Dom 异常 18：

> angular-1.0.0rc10.js @ 第 5349 行错误：SECURITY_ERR：DOM 异常 18

看来这个异常是由我的 AngularJS 控制器末尾的这段代码引起的：

```
$http({method: 'GET', url: 'http://placeholdermetaserver.appspot.com/list?format=json&game=Heist'})
.success(function(data)
{
    //Do stuff with data
}); 
```

奇怪的是，如果我使用直接的 XMLHttpRequest 而不是 AngularJS $http 对象，一切都很好：

```
var request = new XMLHttpRequest();
request.onload = function() {
    //Do stuff with data
};
request.open("GET", "http://placeholdermetaserver.appspot.com/list?format=json&game=Heist", true); 
```

当我简单地在 chrome 中加载此页面时（关闭本地文件系统，与 awesomium 相同），*不会*生成此异常。

什么可能导致这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T23:22:58.110

该`$http`服务包括一些跨站点请求伪造 (XSRF) 对策。我对 Awesomium 不是特别熟悉，所以我不确定它实现了哪些安全功能，但我会查阅文档（Awesomium 和 AngularJS）以获取更多信息。

[http://docs.angularjs.org/api/angular.module.ng.$http](http://docs.angularjs.org/api/angular.module.ng.$http)

从您的服务器的角度来看，如果您曾经发送如下 GET 请求，这很容易受到[教科书 XSRF img 标签攻击：](http://en.wikipedia.org/wiki/Cross-site_request_forgery#Example_and_characteristics)

> “ [http://myapp.com/doSomething/somegame/12345](http://myapp.com/doSomething/somegame/12345) ”

从您的客户的角度来看，假设您提出如下请求：

> " [http://myapp.com/doSomething/somegame/](http://myapp.com/doSomething/somegame/) " + someId

聪明的黑客可能会哄骗 someId 成为：

> ```
> "@123.45.56.689/myEvilFakeJson.json" 
> ```

在这种情况下，请求不会发送到您的服务器，而是发送到其他服务器。如果您对请求的位置进行硬编码或小心处理输入，则可能不会有太大的风险。

# email - 邮件SPF配置？

> ID：10852476
> 
> 赞同：0
> 
> 时间：2012-06-01T14:47:19.917
> 
> 标签：email, spf

**情况：** 我每个域都有一个电子邮件帐户。我使用诸如 [some-alias]@[one-of-my-domains-name] 之类的电子邮件。（服务器：mail.[mydomain]:[secure port] 我的注册商 (OVH) 与我的网络主机 (Arvixe) 不同。我的托管计划是互惠的 .NET 托管。当我想用我的一个别名回复时，我使用 Mozilla Thunderbird 'Identities'。（登录 = 具体的域邮件帐户，FROM：'别名电子邮件'。）（是的，这对于避免收到垃圾邮件和不需要的邮件列表非常有效。）

**问题**：对于使用某些垃圾邮件保护服务的某些收件人，我经常收到错误消息：

> 远程服务器回复：550 Blocked by SPF ()

**寻求解决方案的提示/问题和想法**

*   一个朋友说我必须配置我的域的TXT spf记录。
*   使用不同的网站管理员工具网站来获取 DIG 信息，我从来没有得到关于“TXT”记录的信息。所以我不确定：我应该在我的域名注册商一侧还是在托管一侧编辑此记录？
*   当前在我的注册商方面，记录显示： `v=spf1 a:mail.[mydomain] include:mx.ovh.com ~all` 在我的托管方方面，记录显示： `v=spf1 a:mail.[mydomain] ~all`

**大问题：** 我该如何解决这个问题？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T19:49:27.880

找到的解决方案： - 我实际上必须在主机端设置 SPF 或 TXT（我将两者设置为相同的值）记录。- 我使用了 check-auth@verifier.port25.com ，这是一个邮件服务来检查您的电子邮件是否通过了一些反垃圾邮件过滤器。- check-auth@verifier.port25.com 的回复让我明白源 IP/HELO 主机名不是 mail.[mydomain] 而是 [myhostingserversubdomain].arvixe.com 这里我的 SPF 和 TXP spf 记录如下：

v=spf1 mx ptr:[子域].arvixe.com -all

（我认为 'mx' 在我的情况下真的没有必要。）

编辑：略有改进：

v=spf1 ip4:[[子域].arvixe.com IP] ptr:[子域].arvixe.com -all

mx 已删除，因为在我的情况下，mx 服务器与它无关。“ptr”需要DNS查找，所以我添加了直接IP。我留下了“ptr”以防 IP 发生变化（因为它由我的主机管理）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:20:10.227

您的 SPF 记录表明发送电子邮件的 IP 有权为您的域发送电子邮件。在你的情况下，我假设你实际上是通过 Arvixe 服务器发送的。这些记录应在注册商 (ovh) 的域的 TXT 记录中设置。

因此，在这种情况下，您需要在您的注册商 (ovh) 处编辑 SPF 的 TXT 记录以读取：

`v=spf1 mx a:mail.[yourdomain] include:spf.arvixe.com -all`

注意：'all' 上的修饰符各不相同 - +,-,~,? - 并指定收件人是否应将测试视为结论性并拒绝邮件。这里有一个很棒的（非常彻底的）关于 SPF 的方法：[http ://www.zytrax.com/books/dns/ch9/spf.html](http://www.zytrax.com/books/dns/ch9/spf.html)

有点不寻常的是，收件人拒绝了应该是不确定的 SPF 记录（例如，默认 = 接受）。电子邮件的核心问题之一是总是存在收件人服务器表现出奇怪行为的边缘情况——我希望这对这种情况有所帮助。

# asp.net - 如何为 ASP.NET 或 Silverlight 应用程序模拟完整的 IE 缓存

> ID：10852477
> 
> 赞同：0
> 
> 时间：2012-06-01T14:47:37.910
> 
> 标签：asp.net, silverlight, internet-explorer, cookies, browser-cache

在调试 Silverlight 或 ASP.NET 应用程序时，模拟浏览器完整缓存的最佳方法是什么？如果浏览器缓存或完整的 cookie 缓存在我看到的这种行为中起作用，我想确定一些间歇性行为。

我在这里先向您的帮助表示感谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:31:14.980

你不能模拟 IE 缓存，同时调试你的应用程序和断点后面的代码（如果我理解的话）。

您可以做的是使用`Debug.Write(string)`代码中的函数来读取正在发生的事情，并且您可以使用 sysinternals 中的 DebugView 读取事件的输出：

[http://technet.microsoft.com/en-us/sysinternals/bb896647](http://technet.microsoft.com/en-us/sysinternals/bb896647)

# jquery - 如何使用 jQuery 访问多维 JSON 的值并将它们绘制在 Google 地图上

> ID：10852484
> 
> 赞同：1
> 
> 时间：2012-06-01T14:47:55.710
> 
> 标签：jquery, json, google-maps, google-maps-api-3, multidimensional-array

我有一个多维**JSON**，我想用它的数据在我的**Google Map**上绘制标记。

我使用[这个插件让 Jquery](http://code.google.com/p/jquery-ui-map/)与我的**Google Map**一起工作。

***使用我当前的代码，我的地图上看不到任何标记。这可能是什么原因造成的？***

`init`发生事件时 - 脚本应遍历**JSON**数据，将其绘制在地图上，并使用适当的 HTML 标记为每个属性的每个值创建/附加到`info-boxes`每个**标记**。

我的 JSON 看起来像这样：

```
[{product:{productName:"ProductA", productPrice:"19.99", productQuantity:"12", Lat:"53.573858", Lng:"45.985456"}},{product:{... repeat ...}}, {...}] 
```

我的 jQuery`$.each()`看起来像这样：

```
$('#map').gmap(mapOptions).bind('init', function () {
    $.post('myscript.php', function (json) {
        var theMarkers = json;
        $.each(theMarkers.product, function (i, object) {
            $.each(object, function (property, value) {
                $('#map').gmap('addMarker', {
                    'position': new google.maps.LatLng(object.Lat.value, object.Lng.value),
                    'bounds': true,
                    'icon': 'myicon.png'
                }).click(function () {
                    $('#map').gmap('openInfoWindow', {
                        'content': '<h1>' + object.productName.value + '</h1>' + '<h2 style="color: grey">' + object.productPrice.value + '</h2><p style="color: green">' + object.productQuantity.value + '</p>'
                    }, this);
                });
            });
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:13:02.130

***解决方案：***

```
$('#map').gmap(mapOptions).bind('init', function(){
                    $.post('myscript.php', function(json){
                        var theMarkers = json;
                        $.each(theMarkers, function(i, element) {
                            $.each(element, function(object, dataMembers){
                                    $('#map').gmap('addMarker', { 'position': new google.maps.LatLng(parseFloat(dataMembers.Lat), parseFloat(dataMembers.Lng)), 'bounds':true, 'icon':'myicon.png' } ).click(function(){                                
                                        $('#map').gmap('openInfoWindow', { 'content': '<h1>'+dataMembers.productName+'</h1>'+'<h2 style="color: grey">'+dataMembers.productPrice+'</h2><p style="color: green">'+dataMembers.productQuantity+'</p>' }, this);
                                    }); 
                            });
                        });
                    }); 

                }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:11:39.317

这些产品比您当前的代码假设的更深一层。所以随着

```
var theMarkers = json;
$.each(theMarkers, function (i, object) {
... 
```

您将获得包含您的产品的对象，但 theMarkers 本身没有任何名为 的属性`product`。

您可以使用以下代码对此进行测试：

```
$.each(theMarkers, function (i, o) {
  console.log(i, o);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:46:49.300

你应该这样做：

```
'position': new google.maps.LatLng(parseFloat(object.Lat.value), parseFloat(object.Lng.value)), 
```

正如`google.maps.LatLng`预期的那样 2`numbers`并且您正在通过`strings`.

[请参阅此处获取 LatLng 的文档](https://developers.google.com/maps/documentation/javascript/reference#LatLng)

# c# - 快速轴对齐长方体数据类型

> ID：10852491
> 
> 赞同：0
> 
> 时间：2012-06-01T14:48:11.197
> 
> 标签：c#, performance, data-structures, 3d, struct

我正在寻找一种表示轴对齐长方体的数据结构

类似于 System.Drawing.Rectangle，但在 3d 中，例如

```
struct AACuboid
{
    int posX, posY, posZ;
    int width, length, height;
} 
```

使用标准操作如 c1.Contains(c2)、c1.Intersects(c2)、c1.Rotate(axis,0/90/180)... 以及基本操作如相等、iComparable、hashCode...

这样的数据类型很容易写，我担心的问题是写得快，因为我每秒会做很多立方体的交集和比较。

与其重新发明轮子，也可能忘记一些基本的优化步骤，有没有可以免费使用的类？如果这还包括某种 R-Tree 或类似结构来加速交叉点，那就更好了，尽管此时这是可选的。

否则，我不应该忘记的基本优化步骤是什么？（即结构或类？x、y、z 内部表示为单个类成员或单个数组或结构？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T20:23:34.180

到目前为止，我所寻求的最佳匹配似乎是 Microsoft.Xna.Framework.BoundingBox，对它的研究已被证明既具有启发性又令人困惑。

它是一个结构：

```
 public struct BoundingBox : IEquatable<BoundingBox> 
 {
       public Vector3 Min; public Vector3 Max;
       ...
 } 
```

Vector3 是另一个结构：

```
 public struct Vector3 : IEquatable<Vector3> 
  {
       public float X,Y,Z;
       ...
  } 
```

所以我认为包含浮点数的结构是这种数据的一个很好的设计选择，即使它们变得相当大（24 字节，是官方推荐的结构最大值的两倍）

现在让我感到困惑的主要事情是这些结构是可变的，并且实现的方法大量利用了这种可变性。我会认为这些类型是不可变的，或者至少没有公共的非只读变量。但我猜微软知道他们在做什么。

现在我不确定我是否应该只为这些类型包含整个 xna 框架，或者只是在它们之后建模我自己的类型。

但是，我愿意接受其他建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:56:59.007

如果速度是您最关心的问题，您是否有可能处理一点坡度（或随着您的长方体远离真正的立方体而增加坡度）？如果是这样，您可以测试球形相交，这既简单又快速

# vba - 如何检查字符串是否有段落字符？

> ID：10852492
> 
> 赞同：0
> 
> 时间：2012-06-01T14:48:12.477
> 
> 标签：vba

我需要检查 word 文档中的字符串是否包含段落字符。我只想提取没有段落字符的文本。段落字符是否有常量？我尝试检查 vbnewLine 和 vbCrLF，但这些都不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:55:11.993

查看[关于换行符的维基百科文章](http://en.wikipedia.org/wiki/Newline)。总共有 3 个字符表示换行（在某些情况下），有时它们会组合使用。我认为 Word 使用哪些和不使用哪些并不重要。你希望他们都消失。

所以，我会说遍历所有字符并删除所有 LF、CR 和 RS 实例，或者用空格替换它们（同时避免双空格）

# xml - 需要读取 XML 并将其显示并保存在本地存储中。

> ID：10852493
> 
> 赞同：1
> 
> 时间：2012-06-01T14:48:13.470
> 
> 标签：xml, html, rss, local-storage, feed

我需要读取 XML 数据并在 HTML 中显示它，同时将其保存在 localStorage 中。

当用户离线时，我需要使用 localStorage 显示内容。

（*注意：*没有 PHP）
（*注意：* 当用户有互联网阅读并显示新项目时）

有没有人有好的教程或任何有用的网站？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T07:03:38.287

我找到了这篇文章/教程。它展示了如何解析和保存 xml 文件。以及如何离线查询。

它是通过使用 javascript 完成的。

文章由 Mantascode 在 mantascode.com 上发表，描述了如何将 xml 文件解析到本地存储。使用launch.html 使用java 脚本解析xml 文件。

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body>

This page will parse and save books.xml into the users browser<br />
specifically into html5 localStorage<br />
The xml file being pushed is called books.xml<br />
<br />
<a href="books.xml">books.xml</a>
<br />
<a href="OFFLINE.html">OFFLINE.html</a>

<script type="text/javascript">  

if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET","books.xml",false);
xmlhttp.send();
xmlDoc=xmlhttp.responseXML; 

var xmlRowString = "";

for (var i = 0; i < xmlDoc.documentElement.childNodes.length; i++)
{
if ( xmlDoc.documentElement.childNodes[i].nodeName == 'book' )
{
for ( var k = 0 ; k < xmlDoc.documentElement.childNodes[i].childNodes.length; k++ )
{
if ( xmlDoc.documentElement.childNodes[i].childNodes[k].nodeName == 'author' )
{
xmlRowString += "<book><author>"+xmlDoc.documentElement.childNodes[i].childNodes[k].textContent+"</author>";
}
if ( xmlDoc.documentElement.childNodes[i].childNodes[k].nodeName == 'title' )
{
xmlRowString += "<title>"+xmlDoc.documentElement.childNodes[i].childNodes[k].textContent+"</title>";
}
if ( xmlDoc.documentElement.childNodes[i].childNodes[k].nodeName == 'description' )
{
xmlRowString += "<description>"+xmlDoc.documentElement.childNodes[i].childNodes[k].textContent+"</description></book>";
}
}
}
if ( xmlRowString === "" )
{
}
else
{
//Here for each book we populate a local stoage row
if (typeof(localStorage) == 'undefined' ) 
{
alert('Your browser does not support HTML5 localStorage. Try upgrading.');
} 
else 
{
try                          
{ 
localStorage.setItem(i, xmlRowString);
} 
catch (e) 
{
alert("save failed!");
if (e == QUOTA_EXCEEDED_ERR) 
{
alert('Quota exceeded!'); //data wasn't successfully saved due to quota exceed so throw an error
}
}
}
xmlRowString = "";  
}
}

</script>

</body>
</html> 
```

还有一个Offline.html来查询本地存储的xml

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Search local storage</title>
</head>

<body>

This page will allow the user to search the content saved in your local storage.<br />
Search By Author name, results will be returned by book title.<br />

<form action="OFFLINE.html" method="get">
  Search By Author : <input type="text" name="txtA" /><br />
  <input type="submit" value="Submit" />
</form> 
<br />
<br />

<div id="results_ID"></div>

<script type="text/javascript">

var localStorageRow = localStorage.getItem(localStorage.key(i)) ;

var author_query = getUrlVars()["txtA"];

if (typeof(author_query) == "undefined" || author_query === "" )
{
}
else
{
for ( var i = 0 ; i < localStorage.length;  i++)
{
var localStorageRow = localStorage.getItem(localStorage.key(i)) ;

if (window.DOMParser)
{
parser=new DOMParser();
xmlDoc=parser.parseFromString(localStorageRow,"text/xml");
}
else // Internet Explorer
{
xmlDoc=new ActiveXObject("Microsoft.XMLDOM");
xmlDoc.async=false;
xmlDoc.loadXML(localStorageRow);
} 

for ( var k = 0 ; k < xmlDoc.firstChild.childNodes.length ; k++ )
{
if ( xmlDoc.firstChild.childNodes[k].nodeName === "author" )
{

var auth_row = xmlDoc.firstChild.childNodes[k].textContent;         
var authMatch = auth_row.match(new RegExp(author_query, "i"));
if ( authMatch )
{
//CANNOT USE XPATH(a lot of browsers dont support this) 
//YOU HAVE TO LOOP THOUGH ELEMENTS (again) TO GET TITLE
/*
var nodesSnapshot = document.evaluate('//title', xmlDoc, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null );  
for ( var q=0 ; q < nodesSnapshot.snapshotLength; q++ )  
{  
document.getElementById("results_ID").innerHTML += nodesSnapshot.snapshotItem(q).textContent+"<br />";
}  
*/

for ( var p = 0 ; p < xmlDoc.firstChild.childNodes.length ; p ++ )
{
if ( xmlDoc.firstChild.childNodes[p].nodeName == 'title' )
{
document.getElementById("results_ID").innerHTML += xmlDoc.firstChild.childNodes[p].textContent+"<br />";
}
}

}
}
}
}
}

//GET URL VARS function
function getUrlVars() {
var vars = {};
var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
vars[key] = value;
});
return vars;
}

</script>

</body>
</html> 
```

book.xml 的标记

```
<?xml version="1.0"?>
<catalog>
   <book id="bk101">
      <author>Gambardella, Matthew</author>
      <title>XML Developer's Guide</title>
      <genre>Computer</genre>
      <price>44.95</price>
      <publish_date>2000-10-01</publish_date>
      <description>An in-depth look at creating applications 
      with XML.</description>
   </book>
</catalog> 
```

[在这里你会找到这篇文章](http://mantascode.com/?p=594)

文章标题：Javascript：如何解析xml，写入html5本地存储，然后从本地存储读取，并允许用户搜索内容。

# php - 按日期列出 MySQL 表中的差异

> ID：10852495
> 
> 赞同：0
> 
> 时间：2012-06-01T14:48:23.347
> 
> 标签：php, mysql

```
Day1
IP Address  Model Number    MAC Address Host Name   Date    Phone Load Version
10.1.1.14   CP-8945 70CA9B010000    SEP70CA9B01001  2012-06-01 SCCP 9-2-2-0
10.1.1.15   CP-8945 70CA9B010001    SEP70CA9B01002  2012-06-01 SCCP 9-2-2-0
10.1.1.16   CP-8945 70CA9B010002    SEP70CA9B01003  2012-06-01 SCCP 9-2-2-0
10.1.1.17   CP-8945 70CA9B010003    SEP70CA9B01004  2012-06-01 SCCP 9-2-2-0

Day2
IP Address  Model Number    MAC Address Host Name   Date    Phone Load Version
10.1.1.14   CP-8945 70CA9B010000    SEP70CA9B01001  2012-06-02 SCCP 9-2-2-0
10.1.1.15   CP-8945 70CA9B010001    SEP70CA9B01002  2012-06-02 SCCP 9-2-2-0
10.1.1.16   CP-8945 70CA9B010002    SEP70CA9B01003  2012-06-02 SCCP 9-2-2-0
10.1.1.17   CP-8945 70CA9B010003    SEP70CA9B01004  2012-06-02 SCCP 9-2-2-1

Result
10.1.1.17   CP-8945 70CA9B010003    SEP70CA9B01004  2012-06-02 SCCP 9-2-2-1 
```

我不确定这是否可能。我有一个 MySQL 表，其中包含除日期之外的多个匹配行。我将如何比较 2 个日期并在任何列中列出差异？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:03:34.667

听起来你想要的是设置差异。

在代码中解决此问题的一种简单方法是简单地计算相关数据的集合差异。您可以通过简单地连接指示更改的字段来为每一行创建一个“指纹”（也许用颜色将它们连接起来，以便以后将它们分开）

伪代码：

```
SET1 = SELECT CONCAT(ip, ":", model_number, ":", mac_address, ":", host_name, ":", load_version) FROM day1

SET2 = SELECT CONCAT(ip, ":", model_number, ":", mac_address, ":", host_name, ":", load_version) FROM day1

RESULT = SET2 - SET1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:08:39.107

我之前在 SQL Trigger 中尝试过同样的场景，这就是我所做的。

```
SELECT 
    d2.ip_add,
    d2.mdl_num,
    d2.mac_add,
    d2.host_name,
    d2.date,
    d2.phone,
    d2.load_ver
From 
    day2 d2
LEFT JOIN
    day1 d1
ON
d1.ip_add = d2.ip_add
WHERE
    d2.ip_add <> d1.ip_add
OR 
    d2.mdl_num <> d1.mdl_num
OR
    d2.mac_add <> d1.mac_add
OR
    d2.host_name <> d1.host_name
OR
    d2.phone <> d1.phone
OR
    d2.load_ver <> d1.load_ver; 
```

这将返回两个相同表之间的差异。

我编辑我的查询，以便它只会在 1 个表上查看。试试这个，

```
SELECT 
    d2.ip_add,
    d2.mdl_num,
    d2.mac_add,
    d2.host_name,
    d2.date,
    d2.phone,
    d2.load_ver
FROM 
        (SELECT 
            ip_add,
            mdl_num,
            mac_add,
            host_name,
            DATE,
            phone,
            load_ver,
            day
         FROM
            tblRecords
         WHERE
            day = 2
         ) AS d2
LEFT JOIN
        (SELECT 
            ip_add,
            mdl_num,
            mac_add,
            host_name,
            DATE,
            phone,
            load_ver,
            day
         FROM
            tblRecords
         WHERE
             day = 1
        ) AS d1
ON
    d1.ip_add = d2.ip_add
WHERE
    d2.ip_add <> d1.ip_add
OR 
    d2.mdl_num <> d1.mdl_num
OR
    d2.mac_add <> d1.mac_add
OR
    d2.host_name <> d1.host_name
OR
    d2.phone <> d1.phone
OR
    d2.load_ver <> d1.load_ver; 
```

# sql - Access 2010：查询表达式中的语法错误（缺少运算符）

> ID：10852499
> 
> 赞同：12
> 
> 时间：2012-06-01T14:48:43.320
> 
> 标签：sql, ms-access-2010

我想在我的 sql 查询中有三个表，但我收到一条错误消息。

我有这个 sql 代码：

```
 SELECT warehouse.expiry_date, pharmacy.expiry_date, drugs.active_substance, 
 drugs.strength, drugs.strength_type, drugs.dosage_form, drugs.minimum_quantity, 
 SUM(warehouse.in_quant)+SUM(pharmacy.in_quant)-SUM(warehouse.out_quant)-
 SUM(pharmacy.out_quant) AS Total_available_stock

 FROM drugs as a 
  INNER JOIN warehouse as b
    ON a.ID = b.drug_id 
  INNER JOIN pharmacy as c 
    ON b.drug_id = c.drug_id
 GROUP BY warehouse.expiry_date, pharmacy.expiry_date, drugs.active_substance, 
 drugs.strength, drugs.strength_type, drugs.dosage_form, drugs.minimum_quantity; 
```

我得到了错误：

```
 Syntax error (missing operator) in query expression in 'a.ID = b.drug_id 
 INNER JOIN pharmacy as c
     on b.drug_id = c.drug_i'. 
```

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-06-01T14:53:09.467

在 Access 中，如果您有多个联接，则需要括号：

```
FROM (drugs as a 
  INNER JOIN warehouse as b
    ON a.ID = b.drug_id) 
  INNER JOIN pharmacy as c 
    ON b.drug_id = c.drug_id 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-07-20T17:06:19.263

只是想补充一点，当您有超过 2 个内部联接时，它会变得更加混乱。然后您需要在每个内连接的开头和结尾添加一个额外的括号（最后一个除外）

例子：

```
 FROM ((drugs as a 
  INNER JOIN warehouse as b
    ON a.ID = b.drug_id) 
  INNER JOIN pharmacy as c1 
    ON b.drug_id1 = c1.drug_id)
  INNER JOIN pharmacy as c2 
    ON b.drug_id2 = c2.drug_id 
```

# ajax - 列表视图（“刷新”）不起作用

> ID：10852500
> 
> 赞同：2
> 
> 时间：2012-06-01T14:48:44.737
> 
> 标签：ajax, jquery, jquery-mobile

在我的应用程序`listView('refresh')`中不起作用。这是我的代码

我动态创建 listView

```
 var str = "<ul data-role='listview' data-inset='true' id='mylist'>";

        for(var i = 0; i<data.length; i++ ){
            str += "<li>"+data[i].note.text+"</li>";
        }
       str += "</ul>"

        $('#content').append(str);

function addnote(){
    var note_text = $('#note_text').val();
    var note_lat  = $('#lat').val();
    var note_lng  = $('#lng').val();

    $.ajax({

        type: "POST",
        beforeSend: function (jqXHR) {
            jqXHR.setRequestHeader(KEY1, _key1);
            jqXHR.setRequestHeader(KEY2, _key2);
        },

        url:SERVER_URL+"api/addNotes/",

        data: {type: 'text',note_text: note_text, note_lat: note_lat , note_lng: note_lng},

        success: function(data, textStatus, jqXHR) {
            if (data.status == "ok"){

                $.mobile.changePage("file:///android_asset/www/index.html?"+_key1+"|"+_key2+"|");

             }
            else{
                alert("Something wrong");
            }

        },
        error: function(jqXHR, textStatus, errorThrown) {
            alert("Error=" + errorThrown);
        },

        complete: function() {
            $('#mylist').listview('refresh');

        }
    });
} 
```

我在那里阅读了许多报告和论坛，说我必须在 ajax 的完整功能中调用 listview('refresh') 。但是在我的代码中它不起作用，谁能告诉我这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:05:34.947

刷新适用于将元素添加到现有的增强列表视图。如果您要动态创建整个列表视图，则需要在父 div 上触发“创建”。

所以如果你有`<div id="container><ul></ul></div>`，你需要打电话`$("#container").trigger("create")`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T19:53:32.463

试试这个为你完成功能

```
complete: function() {
    $('#mylist').listview();
} 
```

正如其他人提到的，刷新方法适用于将列表项添加到 JQM 已经创建的列表视图中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T13:35:38.177

You probably want to see your data after adding some values. If you want to do this listview.refresh doesn't help you after adding some values you have to call you data again, i.e you have to call getNote() again.

I think it helps.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-02T09:32:11.393

First of all , You must understand how does the refresh work, it will just refresh the listview's css when you add a new LI so that the new LI will have a right css,

```
function createItem(tx,results){
var len = results.rows.length;
console.log("lisitem len "+len);
for(var i = 0;i<len;i++){
    var content = results.rows.item(i).content;
    var id = results.rows.item(i).id;
    var string = '<li><a href="#all_content" data-rel="popup" onclick="getContent('+id+');" class="ui-link-inherit">'+content+' ['+results.rows.item(i).date+']</a></li>';
    $("#all_list").append(string);
};
freshList("all_list"); 
```

}

> freshList("all_list"); it will refresh the listview ,if you don't do it, all of the LI will display like below.

```
<li><a href="#all_content" data-rel="popup" onclick="getContent(2);" class="ui-link-inherit">           测试成功         [2013-10-02]</a></li> 
```

the LI doesn't have a css description

that's why your ajax operation doesn't work

# php - PHP - 使用 zlib 创建标准 zip 文件

> ID：10852505
> 
> 赞同：2
> 
> 时间：2012-06-01T14:48:54.503
> 
> 标签：php, zip, zlib

我刚刚发现我的托管服务器不支持 PHP 的 ZIP 类。

但是，它已安装并支持 Zlib。

是否有任何库/函数/hack/类/可以让我在这样的服务器上处理 ZIP 文件？

基本上我想创建 zip 文件。我担心我的用户会害怕 GZ 扩展，我想为他们提供 ZIP 扩展（它们将在 win 系统上正常打开）？

（请不要告诉我更换主机 - 我已经知道我必须这样做，但这需要时间，而且事情很紧急..）

**更新我**。感谢@Mark Ba​​ker - 我能够使用 pclzip 类和这个简单的代码提取文件

```
<?php

 include('pclzip.lib.php');
  $archive = new PclZip('wp.zip');
  $location = $_SERVER['DOCUMENT_ROOT'];
  if ($archive->extract(PCLZIP_OPT_PATH, $location ,
                        PCLZIP_OPT_REMOVE_PATH, 'install/release') == 0) {
    die("Error : ".$archive->errorInfo(true));
  }
?> 
```

（我只是想在这里发布代码，评论太长了，我不想发布另一个答案）

仍然没有测试创建，但如果它的工作原理相同 - 那我真的很想亲吻那个类的开发人员！:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:06:00.380

Zlib 不会帮助您创建 zip 文件。

作为您缺少的 ZipArchive 的替代方案，您可以查看[PCLZip](http://www.phpconcept.net/pclzip/)库。这是纯 PHP，因此不需要额外的扩展，并且允许您在没有 ZipArchive 的情况下创建 zip 文件。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-01T15:29:26.043

我相信在 Windows 上，扩展只告诉它使用什么应用程序来打开它。

所以你可以把它保存为winzip会打开的东西，然后重命名它......

# java - 将 null 设置为 PreparedStatement

> ID：10852512
> 
> 赞同：4
> 
> 时间：2012-06-01T14:49:14.477
> 
> 标签：java, jdbc, null, prepared-statement

典型情况：我们有一些类型为空的列，`Integer`它可能是两者`null`或某个`int`值。所以我们使用以下内容：

```
private static void setIntOrNull(PreparedStatement stmt, int col, Integer i)
    throws SQLException
    {
        if (i == null)
            stmt.setNull(col, java.sql.Types.INTEGER);
        else
            stmt.setInt(col, i);
    } 
```

但对我来说，这种情况是一种不好的做法 - 在内部 void 方法中更改外部对象（参考[罗伯特马丁的“清洁代码”](http://www.tud.ttu.ee/material/kallik/JOOP/Clean_Code_-_A_Handbook_of_Agile_Software_Craftsmanship.pdf)第 17 章：气味和启发式，函数，F2）。我尽量避免这种情况，但这一次我找不到更好的解决方案。也许有人可以帮我一个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T14:55:16.057

我不认为这特别糟糕，真的。让我们来看看：

*   它是`void`，所以它*一定*有副作用，否则没用
*   它是静态的，因此它不会对“它被调用的对象”产生任何影响；一个都没有！

因此，副作用*要么*是全局的（例如，文件系统等外部的，静态变量等内部的，或临时的，例如休眠的），*要么*会影响参数引用的对象之一。

`int`不是对象，对象是不可变的`Integer`，所以它*唯一*可以影响的是`PreparedStatement`. 由于准备好的语句的目的之一是收集参数数据，因此该方法这样做似乎是完全合理的。方法名称使这一点更加清晰 - 如果不在准备好的语句上，它还会在哪里“设置”一个 int 或 null？

基本上：别担心:)

您*可能*希望通过将其移至公共“帮助器”类来使这一点更加清晰，例如`PreparedStatementHelper`- 这使得您可能很明显确实希望这些方法处于启用状态`PreparedStatement`，但它们并非如此，因此您必须拥有一个静态方法而不是*作用于*一个`PreparedStatement`.

一种替代方法是创建自己的*包装*类，该类将维护一个`PreparedStatement`自身，并具有一个实例`setIntOrNull`方法......但从长远来看，我相信这会更加复杂，几乎没有什么好处。

# javascript - 带有来自不同域的图像的javascript html5 drawImage

> ID：10852514
> 
> 赞同：3
> 
> 时间：2012-06-01T14:49:18.307
> 
> 标签：javascript, html, image-processing, canvas, xss

所以我有以下代码：

```
var element = document.getElementById("myCanvas");
var width = element.width;                                   
var height = element.height;  
var context = element.getContext("2d");                      

/* test 1 */
var img1 = new Image(width, height);
img1.src = "http://www.mydomain.com/image.jpg";

document.body.appendChild(img1);          // <-- A: this works 
context.drawImage(img1,0,0,width,height); // <-- B: this works

/* test 2 */
var img2 = new Image(width, height);
img2.src = "http://www.notmydomain.com/image.jpg";

document.body.appendChild(img2);          // <-- C: this works 
context.drawImage(img2,0,0,width,height); // <-- D: this does not work 
```

好的，看看我的代码，`test 1`我创建了一个带有图片的图像对象，该图片托管在与我的页面相同的域中。从`A:`我可以看到它加载得很好（`A:`并且`C:`只是作为测试被抛出以确保 img 对象加载正确）。而且`B:`效果也很好，它将图像绘制到我的画布上。

在`test 2`中，我加载了一个托管在与我的页面域不同的域上的图像。 `C:`工作正常，我知道您可以加载托管在其他域上的图像。但是，`D:`不起作用。我收到以下错误：

`Error: uncaught exception: [Exception... "Security error" code: "1000" nsresult: "0x805303e8 (NS_ERROR_DOM_SECURITY_ERR)" location: ....`

据我了解，这意味着这被视为跨站点脚本。

所以这里有问题：

1) 为什么这被认为是跨站点脚本？我的意思是，我知道*为什么*……但为什么`D:`不允许，什么时候`C:`？IMO 他们在原则/精神上是一样的吗？

2) 除了传统的跨站点脚本变通办法之外，有没有办法解决这个问题？我想我将不得不使用 AJAX 将 URL 传递给服务器端脚本并发出请求，然后将图像保存在服务器上并返回 URL 以使其位于同一域中，或者否则（我认为）我可以返回原始 base64 编码数据并使用 canvas 方法从原始数据构建它。我可以忍受做这些事情，但是......我有点希望也许我错过了一些关于 html5/canvas 的东西（我是新手！）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:29:23.560

拿住。这里正在发生其他事情。

您绝对可以从不同的域中绘制图像。

这是 jsfiddle 上从 placekitten.com 绘制图像的代码：

[http://jsfiddle.net/ZZW5V/](http://jsfiddle.net/ZZW5V/)

您应该尝试用 notyourdomain 图像的 url 替换该小提琴代码中的 url。它应该仍然有效。

通常，您应该始终能够从能够成功获取图像的任何地方将图像绘制到画布上。

在那之后，您不允许做的是`imageData`将画布获取或保存到带有`toDataUrl`. 不允许这样做有重要的[安全原因。](https://simonsarris.com/understanding-the-html5-canvas-image-security-rules/)

我的猜测是你正在做一些违反安全规则的事情，而不仅仅是试图绘制图像。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T14:51:31.100

这是一种防止信息被“窃取”的安全措施。这与您不能使用 AJAX 从另一个域获取页面的原因相同。

例如，假设一个银行网站使用图像来显示信用信息。您的代码可以将该图像加载到页面中，然后将其发送到您的服务器，从而窃取客户端的安全信息。这是一个极端的例子，但却是一个有效的例子。

您可以将图像附加到页面，因为您无法从中获取任何信息。您无法将图像加载到您的 javascript 中，因为这样您就可以使用原始图像数据来操作和传输。

# asp.net - 在 ASP.NET 中正确实现后台进程 Thread

> ID：10852515
> 
> 赞同：19
> 
> 时间：2012-06-01T14:49:18.560
> 
> 标签：asp.net, asp.net-mvc, multithreading

我需要执行一个无限的 while 循环并希望在`global.asax`. 我的问题是我应该怎么做？我应该开始一个新线程还是应该使用 Async 和 Task 或其他任何东西？在while循环内我需要做 `await TaskEx.Delay(5000);`

我该如何做到这一点，这样它就不会阻塞任何其他进程并且不会造成内存泄漏？

*我使用 VS10、AsyncCTP3、MVC4*

**编辑：**

```
 public void SignalRConnectionRecovery()
        {
            while (true)
            {
                Clients.SetConnectionTimeStamp(DateTime.UtcNow.ToString());
                await TaskEx.Delay(5000);
            }
        } 
```

只要应用程序可用，我需要做的就是在全局范围内将其作为单例实例运行。

**编辑：已解决**

这是 Global.asax 中的最终解决方案

```
protected void Application_Start()
{
    Thread signalRConnectionRecovery = new Thread(SignalRConnectionRecovery);
    signalRConnectionRecovery.IsBackground = true;
    signalRConnectionRecovery.Start();

    Application["SignalRConnectionRecovery"] = signalRConnectionRecovery;
}

protected void Application_End()
{
    try
    {
        Thread signalRConnectionRecovery = (Thread)Application["SignalRConnectionRecovery"];
        if (signalRConnectionRecovery != null && signalRConnectionRecovery.IsAlive)
        {
            signalRConnectionRecovery.Abort();
        }
    }
    catch
    {
            ///
    }
} 
```

我发现这篇关于如何使用异步工作者的好文章：http: [//www.dotnetfunda.com/articles/article613-background-processes-in-asp-net-web-applications.aspx](http://www.dotnetfunda.com/articles/article613-background-processes-in-asp-net-web-applications.aspx)

这： [http ://code.msdn.microsoft.com/CSASPNETBackgroundWorker-dda8d7b6](http://code.msdn.microsoft.com/CSASPNETBackgroundWorker-dda8d7b6)

但我认为对于我的需要，这将是完美的： [http ://forums.asp.net/t/1433665.aspx/1](http://forums.asp.net/t/1433665.aspx/1)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-01T14:51:18.907

ASP.NET 不是为处理这种要求而设计的。如果你需要一些东西来持续运行，你最好创建一个 Windows 服务。

*更新*

ASP.NET 不是为长时间运行的任务而设计的。它旨在快速响应 HTTP 请求。请参阅[Cyborgx37 的答案](https://stackoverflow.com/a/10852803/26226)或[我可以使用线程在 IIS 上执行长时间运行的作业吗？](https://stackoverflow.com/a/539000/26226)有几个原因。

*更新*

现在您终于提到您正在使用 SignalR，我看到您正在尝试在 ASP.NET 中托管 SignalR，对吗？我认为您以错误的方式进行此操作，请参阅[项目 wiki](https://github.com/SignalR/SignalR/wiki/Getting-Started)上引用的示例[NuGet 包](http://nuget.org/List/Packages/SignalR.Hosting.AspNet)。此示例使用来管理任务。[`IAsyncHttpHandler`](https://github.com/SignalR/SignalR/blob/master/SignalR.Hosting.AspNet/AspNetHandler.cs)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-01T14:53:58.960

您可以在 global.asax 中启动一个线程，但它只会运行到您的 asp.net 进程被回收。这将至少每天发生一次，或者在没有人使用您的网站时发生。如果进程被回收，线程重新启动的唯一方法是在您的站点受到点击时。所以线程没有继续运行。

要获得一个持续的过程，最好启动一个 Windows 服务。

如果您执行“进行中”解决方案，这实际上取决于您在做什么。线程本身不会给您带来任何内存问题或死锁。您应该添加一个机制以在应用程序停止时停止您的线程。否则重启需要很长时间，因为它会等待你的线程停止。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-07-31T11:14:20.020

这是一篇旧文章，但是当我为此搜索时，我想报告在 .NET 4.5.2 中有一种使用 QueueBackgroundWorkItem 的本地方法。

看看这篇文章：[https ://blogs.msdn.microsoft.com/webdev/2014/06/04/queuebackgroundworkitem-to-reliably-schedule-and-run-background-processes-in-asp-net/](https://blogs.msdn.microsoft.com/webdev/2014/06/04/queuebackgroundworkitem-to-reliably-schedule-and-run-background-processes-in-asp-net/)

马里亚诺

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-01T15:06:41.897

这取决于您在 while 循环中尝试完成的任务，但一般来说，在这种情况下，[Windows 服务](http://msdn.microsoft.com/en-us/library/d56de412%28v=vs.100%29.aspx)是最佳答案。安装 Windows 服务需要您在 Web 服务器上具有管理员权限。

对于无限循环，您最终会遇到很多关于 Windows 消息泵的问题。即使应用程序没有“做”任何事情，这也是使 Windows 应用程序保持活力的东西。没有它，程序就会结束。

无限循环的问题是应用程序被卡在“做”某事，这会阻止其他应用程序（或线程）“做”他们的事情。有一些解决方法，例如 Windows 窗体中的 DoEvents，但在响应性和资源管理方面它们都有一些严重的缺陷。（在小型 LOB 应用程序上可以接受，但在 Web 服务器上可能不行。）即使 while 循环在单独的线程上，它也会耗尽所有可用的处理能力。

异步编程实际上是为长时间运行的进程设计的，例如等待数据库返回结果或等待打印机联机。在这些情况下，需要很长时间的是外部进程，而不是 while 循环。

如果无法使用窗口服务，那么我认为您最好的选择是设置一个带有自己的消息泵的单独线程，但这有点复杂。我从来没有在网络服务器上做过，但你也许可以启动一个应用程序。这将为您提供消息泵并允许您响应 Windows 事件等。唯一的问题是这将启动 Windows 应用程序（[WPF](http://msdn.microsoft.com/en-us/library/system.windows.application.aspx)或[WinForms](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.aspx)），这在 Web 服务器上可能不理想。

你想达到什么目的？你还有其他方法可以解决吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-01T15:39:23.010

我发现这篇关于如何使用异步工作者的好文章，将尝试一下。[http://www.dotnetfunda.com/articles/article613-background-processes-in-asp-net-web-applications.aspx](http://www.dotnetfunda.com/articles/article613-background-processes-in-asp-net-web-applications.aspx)

这： [http ://code.msdn.microsoft.com/CSASPNETBackgroundWorker-dda8d7b6](http://code.msdn.microsoft.com/CSASPNETBackgroundWorker-dda8d7b6)

但我认为对于我的需要，这将是完美的： [http ://forums.asp.net/t/1433665.aspx/1](http://forums.asp.net/t/1433665.aspx/1)

# python - python django中的filter()方法

> ID：10852516
> 
> 赞同：-1
> 
> 时间：2012-06-01T14:49:20.047
> 
> 标签：python, django, django-views

```
out_links = Link.objects.filter(iweb=iweb_id).order_by('-pub_date')  
for link in out_links:
    comments = LinkComment.objects.filter(link=link.id) 
```

Filter 方法创建对象列表，所以 out_links 是一个列表，对吧？

接下来，在 for 循环之后，我再次过滤以通过链接 ID 查找 LinkComments 类中的对象。

但是问题出现了，我应该将链接称为对象还是列表？只要是 django 的意见，我就不知道了？`link.id`还是`link['id']`？我的 python 说`[ ]`，但 django 不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T14:53:57.167

out_links 是一个查询集，在 for 循环中，您可以通过以下方式访问所有 LinkComments：

```
for link in out_links:
    comments = link.linkcomment_set.all() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T14:58:59.213

过滤器创建一个查询集，如文档中所述：[https ://docs.djangoproject.com/en/dev/ref/models/querysets/#methods-that-return-new-querysets](https://docs.djangoproject.com/en/dev/ref/models/querysets/#methods-that-return-new-querysets)

如果您为 QuerySet 下标，例如`comments[n]`，您将获得第 n 个成员（就像使用列表一样）。您有一个 order_by，即按照该子句指定的顺序。您不能使用下标符号按 id 查询。

当您遍历 QuerySet 时，您将获得查询集的成员，它们是 python 模型对象，您可以像在代码中的其他任何地方一样对待它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T14:53:56.460

> Filter 方法创建对象列表，所以 out_links 是一个列表，对吧？

错误的。它创建[QuerySet 对象](https://docs.djangoproject.com/en/dev/ref/models/querysets/)，它也恰好是一个可迭代对象。

# jsf - p:password 不会重新显示预填充的模型值

> ID：10852520
> 
> 赞同：10
> 
> 时间：2012-06-01T14:49:36.997
> 
> 标签：jsf, jsf-2, primefaces, passwords

我有这样的托管bean：

```
@ManagedBean 
@SessionScoped
public class utilisateur implements Serializable {

    private String login ="yous" ;
    private String password ="yous";
    ...
    ...

} 
```

和我的 login.xhtml

```
<h:outputText value="login: " />  
<p:inputText value="#{utilisateur.login}"  />  

<h:outputText value="password: " />  
<p:password  value="#{utilisateur.password}"  /> 
```

因此，使用此配置，密码必须默认显示为`****`(yous) in，`p:password`但显示为空。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-01T15:22:35.380

这是出于安全原因的默认行为。如果您需要在模型提交或预设密码时显示密码，则需要显式设置该`redisplay`属性。`true`

```
<p:password value="#{utilisateur.password}" redisplay="true" /> 
```

[另请`<p:password>`](http://www.primefaces.org/docs/vdl/6.0/core/primefaces-p/password.html)参阅[VDL 文档](http://www.primefaces.org/docs/vdl/6.0/core/primefaces-p/password.html)，它是最后一个属性。

> `redisplay`布尔标志，指示是否应以形式呈现先前输入的密码。**默认为假。**

# java - 选择排序，对于 Java

> ID：10852522
> 
> 赞同：2
> 
> 时间：2012-06-01T14:49:46.833
> 
> 标签：java, pseudocode

我无法理解这个伪代码，并将其实现到我的程序中。任何人都可以更好地解释它或向我展示代码的外观吗？谢谢。

```
A - an array containing the list of numbers
numItems - the number of numbers in the list

for i = 0 to numItems - 1
    for  j = i+1 to numItems               
        if A[i] > A[j]
            // Swap the entries
            Temp = A[i]
            A[i] = A[j]
            A[j] = Temp          
        End If    
    Next j
Next i 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T15:02:00.890

好吧，让我们把伪代码翻译成伪英文。

```
A - an array containing the list of numbers
numItems - the number of numbers in the list

for i = 0 to numItems - 1
    for  j = i+1 to numItems               
        if A[i] > A[j]
            // Swap the entries
            Temp = A[i]
            A[i] = A[j]
            A[j] = Temp          
        End If    
    Next j
Next i 
```

可能会读

```
Count through each item, from the beginning to the end, calling it X
  While considering item X, count through each item after it, from just
  after X to the end, calling it Y
    If X is bigger than Y, swap the two, temporarily storing X in Temp
      so it doesn't get lost when we copy Y into X.  Copy Y into X, and then
      Copy the temporarily stored old value of X (remember it is in Temp)
      back into Y.  Now the values of X and Y are swapped (so X is now smaller
      than Y) 
```

现在你的工作是用代码编写它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T14:54:09.773

算法的名称告诉你很多关于它的信息。它首先*选择*列表中最小的元素并将其放在第一个位置。然后它选择第二个并将其放入第二个，等等。

你如何找到最小的元素？好吧，您查看列表，如果您正在查看的元素小于列表开头的元素，请将其交换。

你如何找到第二小的？您知道最小的元素已经在第一个位置。所以这意味着第二小的必须是第二个元素和列表末尾之间的最小元素。因此，您再次进行适当的交换。

起泡、冲洗并重复。

如果您想知道如何交换元素。想想你将如何手工完成。你拿起元素 1 并将其放在一个安全的地方，将元素 2 放在元素 1 的旧位置，然后将元素 1 放在元素 2 的旧位置。使用的临时变量将代表您放置元素 1 的安全位置。

[Wikipedia](http://en.wikipedia.org/wiki/Selection_sort)上有一篇不错的文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:01:22.017

如果您只想将整数数组按特定顺序排序，并且您的教授不介意您使用实用程序类，那么[Go Here](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Arrays.html)。

但是，如果您需要自己编写排序算法，那么[Go Here](http://www.algolist.net/Algorithms/Sorting/Selection_sort)有解释和示例。

# postgresql - 将“创建模式”数据库授予用户？

> ID：10852529
> 
> 赞同：46
> 
> 时间：2012-06-01T14:50:14.937
> 
> 标签：postgresql, postgresql-9.1, role

我正在使用 PostgreSQL 9.1，并且必须将“创建模式”数据库授予用户。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2012-06-01T14:54:01.067

这比我想象的要简单。

```
GRANT CREATE ON DATABASE db TO user; 
```

# ios - 选择 tableview 元素时缓慢推送

> ID：10852532
> 
> 赞同：0
> 
> 时间：2012-06-01T14:50:23.890
> 
> 标签：ios, xml, parsing, performance

在我的应用程序中，我使用 tableviews，通过 XML 解析填充，我从 ftp 获取我的 XML，XML 包含下一个视图和图像 url 和文本的其他 xml url，问题是当 tableview 的元素被选择时推到另一个视图，但是加载了很长时间。我将我的应用程序运行到模拟器中，我从未在设备上测试过它。

有人知道可能是什么问题吗？

是连接问题吗？

它可以在设备上正常工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:11:33.973

我建议在设备上测试您的代码，而不是对性能做出假设。我假设您要去服务器并要求将这些图像显示在推送的视图中。在这种情况下，您应该使用图像占位符加载视图并在辅助线程中分离下载图像（慢速加载的好习惯，以免阻塞 UI）并在图像数据可用时更新图像占位符。

如果您需要更具体的帮助，我很乐意更新此答案。

如果您在推送视图中加载 tableview，则挂起将发生在该推送视图之前的视图上（这是非常糟糕的 UX）。因此，将需要一段时间的代码逻辑移到“推送视图”的子类中，您可以在处理数据时实现类似微调器（我使用 MBProgressHud）之类的东西。这样，您将在延迟开始之前加载视图。

现在改善用户体验的流程如下：
1\. 在`- (void)viewDidLoad`推送视图中，您可以隐藏（或不隐藏）tableview。

```
 [self.myTable setHidden:YES]; 
```

2\. 在`-(void)viewDidAppear:(BOOL)animated`推送的视图中抛出一个微调器，让用户知道你正在工作（这里的工作是去服务器从 url 中查找图像）并完成工作。

```
 //your code here will vary 
```

3\. 当您知道所有数据都已下载后，只需加载表格，隐藏微调器并显示表格。您可以在方法结束时执行此操作`-(void)viewDidAppear:(BOOL)animated`。

```
 [MBProgressHUD hideHUDForView:self.view animated:YES];
    [myTable reloadData]; 
```

我建议将所有昂贵的工作发送到辅助线程，因为用户不愿意决定不等待并且在导航栏中有一个被阻止的返回按钮。但是为了回答您推送的原始问题，您应该立即加载视图，然后等待获取数据。

# algorithm - 获得具有一定最小距离/差异的最大整数子集

> ID：10852535
> 
> 赞同：3
> 
> 时间：2012-06-01T14:50:45.220
> 
> 标签：algorithm

我有一组整数或示例：{1,3,4,5,10} 现在我想要最大（最大 = 大多数元素）子集，其中每个元素与其他元素的距离/差异最小。

例如，使用 Set {1,3,4,5,10} 和最小距离 2，结果可能是：

{1,3,5,10}

或距离 3：

{1,5,10}

是否存在（良好/有效）算法来解决该问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:04:04.657

这绝对不是一个 NP 完全问题。

[实际上它是经典的Interval Scheduling](http://www.cs.princeton.edu/~wayne/kleinberg-tardos/04greedy-2x2.pdf)问题的一个特例，而在普通的Interval Scheduling问题中，长度是不固定的

在您的问题中，您可以查看每个数字是间隔的开始时间，并且每个间隔都有您的“最小距离”作为间隔长度。

每个区间都有一个结束时间，即开始时间+区间长度

所以解决方案是

1 按完成时间对所有区间进行排序。

2 按排序顺序逐一遍历它们，将区间添加到与结果集中所有现有区间兼容的结果集中。

该解决方案是最优的，并且具有 O(nlogn) 时间复杂度。

您可以在上面的链接中找到有关其他贪心算法的证明和信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:12:19.287

这些方面的东西：

1）对输入进行排序。

2）遍历输入并用如果选择它们将从集合中排除的元素数量标记每个元素。

3) 从可用元素中按顺序选择得分最低的元素。

4) 删除排除的元素。

5) 重复 3) 和 4)

所以，在你的例子中：

```
1  3  4  5  10     - difference 3 
```

第 1 步已经完成，进入第 2 步，我们得到：

```
1  3  4  5  10
1  3  2  2  0 
```

说明 - 如果我们选择`1`，我们排除 1 个数字 -3；如果我们选择`3`，我们会排除 3 个数字 -1,4 和 5，依此类推...

下一步：

*   选择 10，不删除任何内容。-`1 3 4 5 (10)`
*   选择 1，删除 3。 -`(1) 4 5 (10)`
*   选择 4（或 5），删除 5（或 4） -`1 4 10`

我不保证这行得通，但这是一个开始......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:19:12.770

是的，下面的贪心算法给出了最优解。按排序顺序扫描整数，如果前一个整数足够远，则取每个整数。正确性来自一个归纳证明，即对于每个解 S 和每个整数 u，贪心解至少选择与 S 一样多的整数 ≤ u。

# android - ListView - 仅在第一项上更改分隔线颜色

> ID：10852539
> 
> 赞同：1
> 
> 时间：2012-06-01T14:50:53.533
> 
> 标签：android

所以实际上我在一个屏幕上有一个 MapActivity 和 ListActivity ，当用户单击地图上的一个 Pin 时，单击的位置将位于列表的顶部，并且具有不同的背景和分隔线颜色。

所以我开始发送点击的Pin的纬度并在getView（）上检索它，如果点击的纬度与第一个条目上显示的纬度相同，它会做一些事情。

我已经设法使 ListView 的第一个条目具有一定的背景，但是当我向下滚动列表时，其他一些条目的背景也发生了变化。

这是我的方法：

```
double selectedLat = WWHApplication.getSelectedLatitude();
            DecimalFormat df = new DecimalFormat("#.#####");

            String dLat = df.format(lat);
            String sLat = df.format(selectedLat);
            if (position == 0) {
                if (dLat.equals(sLat)) {
                    feedViewHolder.layout
                            .setBackgroundResource(R.drawable.list_segment_selected);

                }
            } 
```

如何仅在第一项上更改分隔线的颜色和 ListView 的背景？如果有人可以在这种情况下帮助我，我真的很感激，我也愿意接受任何其他解决方案。谢谢你。

**更新**：这是`getView()`方法

```
@Override
        public View getView(final int position, View convertView,
                ViewGroup parent) {
            layoutInflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            FeedViewHolder feedViewHolder = null;
            final VideoLocationDB vidLocation = videoLocationsDB[position];
            String url = vidLocation.documentary_thumbnail_url;
            String name = vidLocation.name;
            String title = vidLocation.name;
            String desc = vidLocation.text;
            double lat = vidLocation.latitude;
            double lng = vidLocation.longitude;
            String distance = calculateDistance(lat, lng);

            // System.out.println("ON LOC DISTANCE: "+distance);
            if (convertView == null) {

                // convertView = LocationsListActivity.this.getLayoutInflater()
                // .inflate(R.layout.listitems, null, true);
                convertView = layoutInflater.inflate(R.layout.listitems,
                        parent, false);
                feedViewHolder = new FeedViewHolder();
                feedViewHolder.layout = (LinearLayout) convertView
                        .findViewById(R.id.list_bg);
                feedViewHolder.titleView = (TextView) convertView
                        .findViewById(R.id.txt_title);
                feedViewHolder.descView = (TextView) convertView
                        .findViewById(R.id.txt_list_desc);
                feedViewHolder.more = (TextView) convertView
                        .findViewById(R.id.txt_more);
                feedViewHolder.distanceView = (TextView) convertView
                        .findViewById(R.id.txt_distance);
                feedViewHolder.v = (ImageView) convertView
                        .findViewById(R.id.image);

                Typeface fontRegular = Typeface.createFromAsset(getAssets(),
                        "miso.otf");
                feedViewHolder.titleView.setTypeface(fontRegular);
                Typeface fontLight = Typeface.createFromAsset(getAssets(),
                        "miso-light.otf");
                feedViewHolder.descView.setTypeface(fontLight);
                feedViewHolder.more.setTypeface(fontLight);
                feedViewHolder.distanceView.setTypeface(fontRegular);

                convertView.setTag(feedViewHolder);

            } else {
                feedViewHolder = (FeedViewHolder) convertView.getTag();
            }

            feedViewHolder.v.setTag(url);
            loader.DisplayImage(url, LocationsListActivity.this,
                    feedViewHolder.v, name);

            double selectedLat = WWHApplication.getSelectedLatitude();
            DecimalFormat df = new DecimalFormat("#.#####");

            String dLat = df.format(lat);
            String sLat = df.format(selectedLat);
            if (position == 0) {
                if (dLat.equals(sLat)) {
                    feedViewHolder.layout
                            .setBackgroundResource(R.drawable.list_segment_selected);
                }
            }

            feedViewHolder.titleView.setText(title.toUpperCase());
            feedViewHolder.descView.setText(desc);
            feedViewHolder.more.setText(getString(R.string.de_list_more));
            feedViewHolder.distanceView.setText(distance);

            return convertView;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:59:28.677

我不认为股票 ListView 真的支持这种行为。

您可以通过将 ListView 上的分隔线设置为 0 并自己将分隔线添加为“普通”行来伪造它。由于您可以使一行看起来像您想要的任何东西，因此大概您可以扩展一个看起来像您想要的任何类型的分隔符的视图，并将其添加到每个项目之间的列表中。应该可以在适配器的 getView() 方法中实现该逻辑。

**编辑：**

我认为如果你添加一个 else 块到你的 if 会改变颜色，它应该可以解决：

```
if (position == 0) {
    if (dLat.equals(sLat)) {
        feedViewHolder.layout.setBackgroundResource(R.drawable.list_segment_selected);
    }
}else{
    feedViewHolder.layout.setBackgroundResource(android.R.drawable.list_selector_background);

} 
```

并将“list_normal”替换为您的默认背景可绘制对象。如果你没有设置一个，你可能需要的是`android.R.drawable.list_selector_background`你可能需要查看 sdk res 可绘制文件夹才能找到正确的名称，我的确切标题可能是错误的。我查了一下，我认为这是你需要的。但我没有在设备上测试它。

# c#-4.0 - 如何在 ASP.Net MVC3 中压缩多个文件

> ID：10852541
> 
> 赞同：1
> 
> 时间：2012-06-01T14:50:57.457
> 
> 标签：c#-4.0

我需要使用 ASP.Net MVC3 中的按钮压缩多个文件

您的回答将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:55:02.250

使用[dotnetzip 库](http://dotnetzip.codeplex.com/)（开源）

简单代码：

```
using (ZipFile zip = new ZipFile())
{
  zip.AddFile("ReadMe.txt");
  zip.AddFile("Resume.doc");
  zip.AddFile("Portrait.png");
  zip.Save("Package.zip");
} 
```

# java - Java 泛型，链表

> ID：10852542
> 
> 赞同：2
> 
> 时间：2012-06-01T14:50:58.900
> 
> 标签：java, generics, serialization, singly-linked-list

我完成了泛型的学习，但并不容易。不过，我确实明白了。这是我的理解。我希望您纠正我的错误并回答几个问题:)。

```
public class LinkedList<T> {
//class definition
} 
```

*   这意味着 LinkedList<> 是一个接受类对象和接口的类。

```
public class LinkedList<T extends Object> {
//class definition
} 
```

*   这意味着 LinkedList<> 是一个类，**它只**接受那些扩展 Object 类的类的对象。基本上，所有课程。如果是原始类型，T 将被 Object 替换

```
public class LinkedList<T extends Object & java.lang.Serializable> {
//class definition
} 
```

*   这意味着 LinkedList<> 是一个类，它接受**所有**实现 Serializable 接口的类的对象。如果用户定义类的对象必须包含在列表中，则用户定义类**必须**实现 Serializable。

```
public class LinkedList<T> implements Iterable<T> {
//class definition
} 
```

*   这意味着 LinkedList<> 类可以与基于集合的 for 循环一起使用。它必须重载 iterator() 方法，并且应该有一个实现`Itarator<T>`和重载 hasNext()、next() 和 remove() 的内部类
*问题*
1\. 如果可能的话，请用简单的语言和例子来解释这个的含义：
public class`BinaryTree<T extends Comparable<? super T>>` 用什么代替？2\. 我想使用 writeObject() 方法将上面提到的 LinkedList<> 类写入文件。所以我将其声明为

```
public class LinkedList<T extends Object> implements Serializable {
     //methods and data members      
private class Node implements Serializable { //inner class
                  T object;
                  Node next;
           }
    } 
```

内部类是否也必须实现 Serializable ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:03:09.790

关于您的前四点：

1.  应该包含`T`（包括扩展的类`T`）的实例的列表。
2.  实际上与第一个相同，因为所有类都扩展了`Object`.
3.  一个列表，只能包含`Serializable`（相同`class LinkedList<T extends Serializable> { ... }`）的对象
4.  的可迭代列表`T`，所以是的，它可以用于增强循环。

值得注意的是，当我们说“只能包含指定类型的对象的列表”时，我们应该说“应该”而不是“可以”。除非您传递`Class<?>`对象，否则 Java（运行时）不会检查传入的值是否实际符合，只有编译器会，并且仅基于可见的静态类型，这可能已经手动更改（这会发出警告）。

关于问题：

1.  它表示`BinaryTree`包含`Comparable`与属于同一类的任何对象`T`或其任何超类型的对象（`Object`是所有类的一个超类型，本质上是所有`T`扩展的类和它实现的所有接口）的对象。
2.  如果您想使用 序列化对象`writeObject`，则该对象的所有非瞬态（即您不能基于其他数据重建）实例字段也需要`Serializable`，否则[`writeObject`将忽略它们](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/ObjectOutputStream.html)。您的代码提取不足以判断是否`Node`需要`Serializable`，但它可能需要给出`List`示例的一般概念。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:39:21.700

添加一些说明：

`T`代表任何引用类型；它可以是类、接口或数组，也可以是参数化类型。类和接口等之间没有区别。

`T extends Object`相同，`T`因为每个引用类型都是的子类型`Object`（是的，接口也是的子类型`Object`）。`extends Object`有点多余。

`T extends Object & Serializable`需要`T`是`Object`和的子类型`Serializable`。因为正如我们之前所说，一切都是 的子类型`Object`，所以现在你可以认为它与`T extends Serializable`(它略有不同，因为在第一种情况下擦除`T`将是`Object`，在第二种情况下`Serializable`；但你不需要在这一点上担心这个）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:04:28.340

来自 Oracle 指南：

> 注意 - 强烈建议不要对内部类（即不是静态成员类的嵌套类）（包括本地和匿名类）进行序列化，原因有几个。因为在非静态上下文中声明的内部类包含对封闭类实例的隐式非瞬态引用，所以序列化这样的内部类实例也会导致其关联的外部类实例的序列化。由 javac（或其他 JavaTM 编译器）生成的用于实现内部类的合成字段是依赖于实现的，并且可能因编译器而异；此类字段的差异可能会破坏兼容性并导致默认 serialVersionUID 值冲突。分配给本地和匿名内部类的名称也取决于实现，并且可能因编译器而异。由于内部类不能声明编译时常量字段以外的静态成员，因此它们不能使用 serialPersistentFields 机制来指定可序列化字段。最后，因为与外部实例关联的内部类没有零参数构造函数（此类内部类的构造函数隐式接受封闭实例作为前置参数），它们无法实现 Externalizable。然而，上面列出的所有问题都不适用于静态成员类。他们无法实现 Externalizable。然而，上面列出的所有问题都不适用于静态成员类。他们无法实现 Externalizable。然而，上面列出的所有问题都不适用于静态成员类。

[可序列化接口](http://docs.oracle.com/javase/7/docs/platform/serialization/spec/serial-arch.html#4539)，[为类定义可序列化字段](http://docs.oracle.com/javase/7/docs/platform/serialization/spec/serial-arch.html#6250)

# php - 在 Apache/PHP 中关闭传入连接

> ID：10852548
> 
> 赞同：5
> 
> 时间：2012-06-01T14:51:47.963
> 
> 标签：php, apache, connection

我有一个脚本，它通过 PUT 请求接收大文件上传。这些文件在上传时会即时完成一些处理。有时我们可以检测到文件在前几个字节中无效，因此我们会`die()`显示错误消息。唯一的问题是客户端仍然发送剩余的数据，这是一个巨大的浪费。有没有办法关闭传入的连接？

代码：

```
$fp = fopen('php://input', 'rb');

// Do some data checking here
if( <invalid> ) {
    fclose($fp);
    die('Error');
} 
```

`stream_socket_shutdown`看起来它可以完成这项工作，但它没有效果。

有没有办法做到这一点？即使我必须为此编写扩展名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:58:05.493

您可能想试一试，看看这是否正确终止了连接：

```
$fp = fopen('php://input', 'rb');

// Do some data checking here
if( <invalid> ) {
    fclose($fp);
    header("Content-Length: 0");
    header("Connection: close");
    flush();
    die('Error');
} 
```

# template-engine - 为什么 Playframework 2 使用自定义 Scala 模板引擎而不是 scalas 以 xml 模式构建？

> ID：10852550
> 
> 赞同：2
> 
> 时间：2012-06-01T14:51:52.080
> 
> 标签：template-engine, playframework-2.0, design-decisions

Play 2.0 使用自定义的基于 scala 的模板引擎，允许在 html 代码中使用 scala 的子集。

为什么做出这个设计决定而不是使用 scalas 内置 xml 模式？

播放模板引擎有一些缺点，例如

*   仅支持 scala 的一个子集，例如似乎无法在函数内部定义函数
*   eclipse中没有编辑器支持

另一方面，我知道 play scala 模板引擎支持非格式良好的 html，这在 scalas xml 模式下是不可能的，但我想应该总是可以以格式良好的方式编写模板。我只是 play 和 scala 的初学者，只是想了解上下文。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T10:30:29.830

一个原因可能是 scala 中 xml 中属性的笨拙处理。有两个问题：

1.  像“selected”这样的属性必须存在或不存在
2.  动态添加属性列表，如输入帮助模板的 htmlArgs

一个简单的 scala 示例显示了困难：

```
def addAttributes(element: Elem, attributes: Map[Symbol, _ <: Any]): Elem = {
    var el = element
    for ((key, value) <- attributes) el = el % Attribute(None, key.name, Text(value.toString), Null)
    el
  }

  def multiselect[T](field: play.api.data.Field,
    options: Seq[T],
    optionValue: T => String,
    optionText: T => String,
    args: (Symbol, Any)*)(implicit handler: FieldConstructor, lang: play.api.i18n.Lang) = {
    val values = { field.indexes.map { v => field("[" + v + "]").value } }
    input(field, args: _*) {
      (id, name, value, htmlArgs) =>
        Html(
          addAttributes(
            <select id={ id } name={ name } multiple="multiple">
              {
                options.map { v =>
                  val z: Option[String] = if (values contains v) Some("selected") else None
                  <option value={ optionValue(v) } selected={ z map Text }>{ optionText(v) }</option>
                }
              }
            </select>,
            htmlArgs).toString)
    }
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:14:52.623

我认为它有几个答案：

1.  它是一个模板。模板不应该包含复杂的逻辑。所有逻辑操作都必须在控制器/模型中完成。

2.  模板可以具有您想要的任何格式：电子邮件、CSV、SQL 等。将模板限制为有效的 XML 确实限制了框架的可能性。

3.  一切都是可编译的。甚至路由、资产、模板继承等。为了让这些机制与框架的其余部分一起工作，可能必须做出一些选择。但是没有人能比框架的创建者更好地回答你。

# hibernate - Hibernate 插入包括未提及的列

> ID：10852559
> 
> 赞同：0
> 
> 时间：2012-06-01T14:52:26.730
> 
> 标签：hibernate

我有一个简单的类映射到一个表。没什么特别的，但我有四个表列在类中没有引用。这是一种典型的模式，它适用于应用程序的其他任何地方。此外，它一直在工作，直到表格发生微小变化。现在，类中未引用的四个表列之一被 Hibernate 包含，导致违反空约束（该列具有默认值；以后，它将由触发器提供。）

这是表定义（对于 DDL 感到抱歉，SQL Developer 不会从网格中“复制”）。除 modifiedby 和 modifieddate 外，所有列都具有“非空”约束。

```
CREATE TABLE "XYZOWNER"."COMMENTM2" (
"COMMENTID" NUMBER(18,0), 
"CREATEDBY" VARCHAR2(255 CHAR) DEFAULT '{none provided}', 
"CREATEDDATE" DATE DEFAULT sysdate, 
"MODIFIEDBY" VARCHAR2(255 CHAR), 
"MODIFIEDDATE" DATE, 
"CREATEDONDATE" DATE, 
"CREATEDONTIME" DATE, 
"CREATEDBYADMIN" NUMBER(1,0) DEFAULT 0, 
"USERNAME" VARCHAR2(100 CHAR), 
"MKTPARTICIPANTID" NUMBER(18,0), 
"REFAPP" VARCHAR2(20 CHAR), 
"REFID" NUMBER(18,0), 
"TEXT" VARCHAR2(2000 CHAR)
) ; 
```

这是课程。

```
package org.midwestiso.marketapps.mect2.entities;
import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.TimeZone;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.JoinColumn;
import javax.persistence.ManyToOne;
import javax.persistence.SequenceGenerator;
import javax.persistence.Table;
import javax.persistence.Transient;

/**
 * This class implements the Comment entity.
 * <p>
 * Note: the database table is named CommentM2, as "comment" is a reserved word.
 */
@Entity
@Table(name = "mect2owner.commentm2")
public class Comment {
/** DB ID */
private Long commentId;
/** Created on date (midnight GMT) */
private Date createdOnDate;
/** Created on time (1970-01-01 GMT) */
private Date createdOnTime;
/** Created by admin? */
private Boolean createdByAdmin;
/** User name */
private String userName;
/** Market Participant */
private MarketParticipant mktParticipant;
/** Reference application */
private String refApp;
/** Reference application ID */
private Long refId;
/** Text */
private String text;

/**
 * Return the commentId
 * 
 * @return the commentId
 */
@Id
@SequenceGenerator(name = "sequence", sequenceName = "mect2owner.seq_commentm2")
@GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "sequence")
public Long getCommentId() {
    return commentId;
}

/**
 * Return the createdOnDate <br />
 * Time set to midnight GMT
 * 
 * @return the createdOnDate
 */
public Date getCreatedOnDate() {
    return createdOnDate;
}

/**
 * Return the createdOnTime <br />
 * Date set to 1970-01-01
 * 
 * @return the createdOnTime
 */
public Date getCreatedOnTime() {
    return createdOnTime;
}

/**
 * Return the createdOn date/time as a String
 * 
 * @return the createdOn date/time as a String
 */
@Transient
public String getCreatedOn() {
    final String createdOn;
    final Calendar calendar;

    // Set the calendar to market time (EST)
    calendar = new GregorianCalendar(TimeZone.getTimeZone("GMT-5"));
    // Set the calendar to the created on date + time
    calendar.setTimeInMillis(createdOnDate.getTime() + createdOnTime.getTime());

    createdOn =
            "" + calendar.get(Calendar.YEAR) + "-" + calendar.get(Calendar.MONTH) + "-"
                    + calendar.get(Calendar.DAY_OF_MONTH) + " " + calendar.get(Calendar.HOUR_OF_DAY) + ":"
                    + calendar.get(Calendar.MINUTE);

    return createdOn;
}

/**
 * Return the createdByAdmin
 * 
 * @return the createdByAdmin
 */
public Boolean getCreatedByAdmin() {
    return createdByAdmin;
}

/**
 * Return the userName
 * 
 * @return the userName
 */
@Column(name = "createdBy")
public String getUserName() {
    return userName;
}

/**
 * Return the mktParticipant
 * 
 * @return the mktParticipant
 */
@ManyToOne
@JoinColumn(name = "mktParticipantId")
public MarketParticipant getMktParticipant() {
    return mktParticipant;
}

/**
 * Return the refApp
 * 
 * @return the refApp
 */
public String getRefApp() {
    return refApp;
}

/**
 * Return the refId
 * 
 * @return the refId
 */
public Long getRefId() {
    return refId;
}

/**
 * Return the text
 * 
 * @return the text
 */
public String getText() {
    return text;
}

/**
 * Set the commentId (limited scope)
 * 
 * @param commentIdParm
 *           the commentId to set
 */
void setCommentId(final Long commentIdParm) {
    commentId = commentIdParm;
}

/**
 * Set the createdOnDate (limited scope)
 * 
 * @param createdOnDateParm
 *           the createdOnDate to set
 */
void setCreatedOnDate(final Date createdOnDateParm) {
    createdOnDate = createdOnDateParm;
}

/**
 * Set the createdOnTime (limited scope)
 * 
 * @param createdOnTimeParm
 *           the createdOnTime to set
 */
void setCreatedOnTime(final Date createdOnTimeParm) {
    createdOnTime = createdOnTimeParm;
}

/**
 * Set the created on date and time to the current date
 */
public void setCreatedOn() {
    final Date now = new Date();
    final Calendar calendar;

    // Set up a Calendar with GMT timezone and the current date
    calendar = new GregorianCalendar(TimeZone.getTimeZone("GMT"));
    calendar.setTime(now);

    // Adjust the Calendar to midnight
    calendar.set(Calendar.HOUR_OF_DAY, 0);
    calendar.set(Calendar.MINUTE, 0);
    calendar.set(Calendar.SECOND, 0);
    calendar.set(Calendar.MILLISECOND, 0);

    createdOnDate = calendar.getTime();
    createdOnTime = new Date(now.getTime() - createdOnDate.getTime());
}

/**
 * Set the createdByAdmin
 * 
 * @param createdByAdminParm
 *           the createdByAdmin to set
 */
public void setCreatedByAdmin(final Boolean createdByAdminParm) {
    createdByAdmin = createdByAdminParm;
}

/**
 * Set the userName
 * 
 * @param userNameParm
 *           the userName to set
 */
public void setUserName(final String userNameParm) {
    userName = userNameParm;
}

/**
 * Set the mktParticipant
 * 
 * @param mktParticipantParm
 *           the mktParticipant to set
 */
public void setMktParticipant(final MarketParticipant mktParticipantParm) {
    mktParticipant = mktParticipantParm;
}

/**
 * Set the refApp
 * 
 * @param refAppParm
 *           the refApp to set
 */
public void setRefApp(final String refAppParm) {
    refApp = refAppParm;
}

/**
 * Set the refId
 * 
 * @param refIdParm
 *           the refId to set
 */
public void setRefId(final Long refIdParm) {
    refId = refIdParm;
}

/**
 * Set the text
 * 
 * @param textParm
 *           the text to set
 */
public void setText(final String textParm) {
    text = textParm;
}
} 
```

这是 Hibernate 生成的 SQL（createdBy 是有问题的列）：

```
insert into xyzowner.commentm2 
(createdByAdmin, createdOnDate, createdOnTime, mktParticipantId, refApp, refId, text, 
createdBy, commentId) 
values (?, ?, ?, ?, ?, ?, ?, ?, ?) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:39:15.967

现在我不是 Hibernate 方面的专家，但我相信你这次遇到问题的原因是因为你用`@Column`.

您可以尝试添加`@Generated(GenerationTime.insert)`，或将其更改`@Column`为包含`insertable = false, updatable = false`（假设您也不希望它包含在更新中）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:47:37.407

当你用 注释一个类时，**除了**那些用 注释的成员之外，`@Entity`每个成员都会映射到表中。请参考[Hibernate 文档](http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html_single/#entity-mapping-property)。**`@Transient`**

 **这意味着您必须在插入语句中使用 注释您不想拥有**的**`@Transient`列。

有一些原因我更喜欢映射文件而不是注释；-)**

# javascript - jquery在满足两个条件时执行函数

> ID：10852561
> 
> 赞同：2
> 
> 时间：2012-06-01T14:52:33.320
> 
> 标签：javascript, jquery, jquery-callback

`mvFinishItUp()`当满足两个条件时，我需要执行特定的功能。更具体地说，一个条件是回调成功，`$.ajax`另一个是正常的代码流，直到它到达函数。有点像这样：

```
$.ajax({
    url: mv_finalUrl,
    success: function (data) {
        mvFinishItUp(data);
    },
    dataType: 'html'
});

/* here a lot more code, with animations and some delays */

mvFinishItUp(data) {
    /* My function code */
    /* But this code must only run after it has been called via the call back
       and after all the other code has been ran as well */
} 
```

因此，如果 ajax 回调更快，或者相反，函数必须等待所有代码。关于如何实施的任何想法？

我愿意改变脚本代码的整个概念，因为我相信 ajax 和函数本身之间的松散代码也应该转到函数......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T15:02:59.907

这是[jQuery Deferred 对象](http://api.jquery.com/category/deferred-object/)的完美用例。

`success:`从 AJAX 调用中移除参数，稍后注册处理程序：

```
var jqxhr = $.ajax(...); 

// do some other synchronous stuff
...

// and *then* register the callback
jqxhr.done(mvFinishItUp); 
```

延迟对象（通过设计）可以很好地应对在 AJAX事件已经完成*后注册的事件。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:54:21.777

这里我添加了第二个参数来检查回调检查

```
 function mvFinishItUp(data, byCallback) {

    var iscallback = byCallback || false; // if you don't send byCallback
                                          // default will false
    if(iscallback) {
       // execute if called by callback
    }
 }

 success: function (data) {
        mvFinishItUp(data, true); // call with second parameter true
 }, 
```

要`mvFinishItUp()`在 ajax 完成以及 ajax 和`mvFinishItUp`完成之间的所有代码之后执行，您可以执行以下操作：

```
var allFunctionExecuted = false; // global to detect all code execution

$.ajax({
    url: mv_finalUrl,
    success: function (data) {
        mvFinishItUp(data, true);
    },
    dataType: 'html'
});

function func1() {

}

function func2() {

}

// some other code

function func3() {
    allFunctionExecuted = true;
} 
```

现在，

```
 function mvFinishItUp(data, byCallback) {

    var iscallback = byCallback || false; // if you don't send byCallback
                                          // default will false

    if(iscallback && allFunctionExecuted) {

       // execute if ajax done
       // and others code done
    }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T14:59:19.940

也许这样的事情可以解决问题：

```
var _data = undefined;

$.ajax({
    url: mv_finalUrl,
    success: function (data) {
        _data = data;
        myFinishItUp(data); // call the function from here if it's faster
    },
    dataType: 'html'
});

/* here a lot more code, with animations and some delays */

function myFinishItUp(data) {
    this.data = data; // store the data from the AJAX call or the code, whichever reaches first 
                      // if the code reaches this before the AJAX call completes, data will be undefined
    if(typeof this.wasCalled == "undefined") {
        /* My function code */
        /* But this code must only run after it has been called via the call back
           and after all the other code has been ran as well */
        this.wasCalled = true;
    }
}(_data); // function that calls itself when the code gets to this point with a self-contained boolean variable to keep track of whether it has already been called 
```

当代码流到达该点时，我使用了一个自调用函数执行，但如果它是从 AJAX 调用中调用的，它将不会执行。它跟踪它是否已经被一个自包含的布尔值调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T15:07:51.957

尝试如下，（这只是伪代码）

```
var isAJAXDone = false, isFunctionCodeDone = false;
$.ajax({
  //..
  success: function () {
     isAJAXDone = true;
     mvFinishItUp(data, isAJAXDone, isFunctionCodeDone);
  } 
});

//..Your function code
//..Add this below the last line before the function ends
isFunctionCodeDone = true;
mvFinishItUp(data, isAJAXDone, isFunctionCodeDone);

//..
mvFinishItUp(data, isAJAXDone, isFunctionCodeDone ) {
   if (isAJAXDone && isFunctionCodeDone) {
      //Do your magic
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T15:18:35.210

这是非常“丑陋”的代码，但您可以将其修改为不使用全局变量，所以这只是说明性的：

```
var ajaxExecuted = false,
    codeExecuted = false;

$.ajax({
    url: mv_finalUrl,
    success: function (data) {
        ajaxExecuted = true;
        mvFinishItUp(data);
    },
    dataType: 'html'
});

/* here a lot more code, with animations and some delays */
codeExecuted = true;

mvFinishItUp(data) {
    /* My function code */
    if(ajaxExecuted && codeExecuted) {
      /* But this code must only run after it has been called via the call back
         and after all the other code has been ran as well */
    }
} 
```

我刚刚添加了两个标志：ajaxExecuted 和 codeExecuted，并在函数内部添加了一个 if 语句来检查这些标志的值，并且仅在它们中的两个设置为 true 时才执行。所以没有谁先调用它，它只有在两个标志设置为 true 时才会执行。

一种更简洁的方法是在对象中实现函数，并使用属性而不是全局变量。

# jquery - 制作这个垂直菜单的最简单方法是什么？

> ID：10852563
> 
> 赞同：0
> 
> 时间：2012-06-01T14:52:37.353
> 
> 标签：jquery, navigation

我需要制作一个看起来完全像这样的动态菜单。我认为 JQuery 最容易使用（手风琴？）。如果有人可以将我链接到特定的实现，我将不胜感激。 ![在此处输入图像描述](../Images/c5ae4c145b0ea9142bd2908f8c05999a.png) ![在此处输入图像描述](../Images/dc7bd63960603ec27b75981fd5c561f0.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:54:17.640

这是你要找的吗？[http://jqueryui.com/demos/accordion/](http://jqueryui.com/demos/accordion/)

jQuery UI Accordion 小部件易于实现。基本上，您只需设置一个`<ul>`元素并`accordion()`在其上调用方法。剩下的只是造型。

如果您遇到问题，请发布另一个更具体的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:58:58.573

[jQuery UI Accordion](http://jqueryui.com/demos/accordion/)非常棒，另一种可能更合适的可能是[jsTree](http://www.jstree.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:01:32.223

您还可以检查这些链接。像这样创建手风琴菜单并使用 php 计算子菜单的数量。 [http://viralpatel.net/blogs/2009/09/create-accordion-menu-jquery.html](http://viralpatel.net/blogs/2009/09/create-accordion-menu-jquery.html)

[http://www.dynamicdrive.com/dynamicindex17/ddaccordionmenu-glossy.htm](http://www.dynamicdrive.com/dynamicindex17/ddaccordionmenu-glossy.htm)

您需要迭代一个循环来计算`<li>`该特定标签内的`<ul>`标签。

# jquery - JScrollPane：增加内部文本字体大小后调整滚动位置

> ID：10852566
> 
> 赞同：1
> 
> 时间：2012-06-01T14:52:49.290
> 
> 标签：jquery, jscrollpane, jquery-jscrollpane

我正在增加内部文本的字体大小。增加字体大小后如何保持滚动位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T15:22:35.357

你也可以使用 'maintainPosition - boolean (default true)

滚动窗格是否应在重新初始化时尝试保持其位置。如果为 true，则重新初始化时滚动窗格的视口将保持不变，如果为 false，则在重新初始化滚动窗格时，视口将跳回顶部。

来源：http: [//jscrollpane.kelvinluck.com/settings.html](http://jscrollpane.kelvinluck.com/settings.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T14:59:17.763

你如何增加内部文本？通过浏览器的字体大小选项，还是通过交互？

[http://jscrollpane.kelvinluck.com/scroll_to.html](http://jscrollpane.kelvinluck.com/scroll_to.html)

您可以使用 scroll_to 在更改字体大小时更改位置...

# openlayers - OpenLayer + OpenStreetMap + 自定义 ShapeFile

> ID：10852567
> 
> 赞同：4
> 
> 时间：2012-06-01T14:52:49.863
> 
> 标签：openlayers, openstreetmap, shapefile

我从映射开始。我想查看一张法国地图，上面有一个可以个性化的图层。

我已经有了 shapefile 格式的自定义图层。我完全不知道我是否必须创建一个 OpenStreetMap 服务器，或者我是否可以直接使用 Web 应用程序。

你能给我一个使用我的额外图层 shapefile 格式映射显示的起点吗？

我想这个任务很复杂，但你必须从某个地方开始......

非常感谢您

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T18:02:24.867

这取决于你想做什么。它是一个大的形状文件吗？

您可以在创建 openlayers 地图时做一些事情：

*   使用公共的openstreetmap 服务器作为背景图块（默认的OSM 层实现），并将您的要素层（点、多边形，以及其中的任何内容）添加为OSM 中的矢量要素层。要从 shapefile 中获取矢量特征，您可以：
    *   以体面的基于 GIS 的格式将它们预加载到您的数据库中。这允许您在执行边界框查询时提供您的功能，如果您有超过 1000/10000 个功能，则需要此功能。
    *   将 shapefile 转换为 openlayers 可读的格式（在浏览器中使用[https://github.com/wavded/js-shapefile-to-geojson](https://github.com/wavded/js-shapefile-to-geojson)或使用 ogr2ogr 等工具进行预转换）
*   或者，如果您不需要与这些功能进行交互，您可以将您的数据与 OSM 数据结合起来，并创建您的自定义图块。这对于浏览器来说更轻量级，但它相当复杂（读取数据库中的所有 OSM 数据，使用 mapnik 生成图块）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T17:45:07.177

如果您希望在 shapefile 图层上添加 OpenStreetMap (OSM)，只需添加以下代码行，

```
var osm = new OpenLayers.Layer.OSM();
map.addLayer(osm); 
```

虽然我不明白，为什么需要创建一个 OpenStreetMap 服务器呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T13:17:04.667

You don't need to create an OpenStreetMap server by your own.

If you want to display your custom layer on a map then use `google` or `openstreetmap` as a base layer and display your layer (comes from shape file) on the map.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-09T09:00:57.560

您可以使用[gipong/shp2geojson](https://github.com/gipong/shp2geojson.js)：首先，将 shp 文件转换为 geojson 数据，然后将数据添加到地图中

```
 var map = new ol.Map({
    layers: [
        new ol.layer.Tile({
            source: new ol.source.OSM()
        })
    ],
    target: 'map',
    view: new ol.View({
        center: [0, 0],
        zoom: 5
    })
});

loadshp({
    url: 'demo/10tnvillage.zip',
    encoding: 'big5',
    EPSG: 3826
}, function(data) {
    var feature = new ol.format.GeoJSON().readFeatures(data, {
        featureProjection: 'EPSG:3857'
    });
    var layer = new ol.layer.Vector({
        source: new ol.source.Vector({
            features: feature
        })
    });
    map.addLayer(layer);

    var extent = layer.getSource().getExtent();
    map.getView().fit(extent, map.getSize());
}); 
```

# c# - 如何在父级别处理子操作异常

> ID：10852573
> 
> 赞同：1
> 
> 时间：2012-06-01T14:53:11.610
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我目前正在我们的应用程序中添加异常管理。

在应用程序中，我有一个布局，基本上显示了一个新闻部分，`@Html.Action("news")`到目前为止，当发生异常时，我可以在新闻部分显示一条错误消息，说“它崩溃了”，但这并不是最好的吸引力......

如果子操作遇到异常，是否可以在父级别检测并重定向到错误页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T20:14:05.760

这就是我所做的。从关于 SO 的类似问题中得到这个（不确定是哪一个）。

```
public ActionResult TabInfo(int id, string tab)
    {
        try
        {
            var viewModel = _viewModelManager.GetViewModel(tab, id);

            ViewBag.Jobid = id;
            ViewBag.Tab = tab;

            return PartialView(string.Format("~/Views/{0}/Index.cshtml", tab), viewModel);
        }
        catch (Exception e)
        {
            return View("ErrorChildAction");
        }

    } 
```

ErrorChildAction 视图

```
@model System.Web.Mvc.HandleErrorInfo

@{
    Layout = null;
}

<!DOCTYPE html>
<html>
 <head>
  <title></title>
 </head>
 <body>
 <!-- Redirect to an error page in the application root -->
 <script type="text/javascript">
     window.location.href = '@Url.Content("~/400.htm")';
 </script>
</body> 
```

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T01:22:33.163

这篇文章可以满足您的需求。在应用程序级别，它捕获异常，您可以选择如何处理它们

[ASP.NET MVC 自定义错误处理 Application_Error Global.asax？](https://stackoverflow.com/questions/1171035/asp-net-mvc-custom-error-handling-application-error-global-asax)

# php - PHP PDO MySQL 插入错误，但在 MySQL 上用作直接查询

> ID：10852574
> 
> 赞同：0
> 
> 时间：2012-06-01T14:53:18.243
> 
> 标签：php, mysql, pdo

我使用 PHP PDO 让我的 Android 应用程序与 MySQL 数据库通信。

这是我的 PHP 文件：

```
<?php
$pdo = new PDO("mysql:host=x;dbname=x", "x", "x");
$pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

$sql = "INSERT INTO k_user_groep(group, user, rol) VALUES (?, ?, ?)";
$q = $pdo->prepare($sql);
$q->execute(array($_GET['groupid'], $_GET['user'], $_GET['rol']));
?> 
```

该表设计如下：groupid 引用其他表中的唯一索引，user 引用其他表中的主键，rol 不引用任何内容。

直接在 MySQL 中，以下查询有效：

```
INSERT INTO `k_user_groep`(`group`, `user`, `rol`) VALUES ('1', 'test', 'v'); 
```

这是我对 PHP 文件的调用：

```
x.php?groupid=1&user=test&rol=v 
```

它返回以下内容：

```
Fatal error: Uncaught exception 'PDOException' with message 'SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'group, user, rol) VALUES ('1', 'test', 'v')' at line 1' in x.php:7 Stack trace: #0 x.php(7): PDOStatement->execute(Array) #1 {main} thrown in x.php on line 7 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T14:55:29.903

`group` [是 mySQL 中的保留字。](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)

它在您的第二个示例中有效，因为您将列名包装在反引号中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:55:49.887

很明显，这与您在 PDO 代码和 MySQL 客户端中尝试的查询不同 - 您在客户端中引用了所有标识符，而在 PDO 代码中没有引用。

# ruby-on-rails - Rails 3：在 after_save 上取消插入

> ID：10852576
> 
> 赞同：1
> 
> 时间：2012-06-01T14:53:22.710
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, rollback, after-save

我有一个模型，当插入记录时，需要调用 Web 服务。

如果 web 服务失败（超时或其他失败），它们在数据库中的保存也应该被恢复。

我使用 after_save 回调并尝试在发生此类错误时引发 ActiveRecord::Rollback。

尽管它在 object.save 上返回 false，但它不会回滚事务。这样做的正确方法是什么？

我怎样才能确保不会创建记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:01:27.357

您是否将其包装在 Active Record 事务块中？

```
User.transaction do
  User.create(:username => 'Kotori')
  User.transaction(:requires_new => true) do
    User.create(:username => 'Nemu')
    raise ActiveRecord::Rollback
  end
end 
```

另见：

[http://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:02:18.573

尝试使用`before_save`并从中返回 false。

# java - 用于加载对象的 Java 接口

> ID：10852578
> 
> 赞同：1
> 
> 时间：2012-06-01T14:53:28.680
> 
> 标签：java, interface

我需要从文件中加载对象。我不知道如何设计支持这个操作的类的接口。

```
public interface TestComponent {
    TestComponent loadFromXML(Element _xmlElement); 
} 
```

我不能将方法 loadFromXML 设为静态，也不能声明（不定义！）构造函数 - 但是创建一个仅用于调用 loadFromXML 的类非常难看。在一个实用程序类中分离这些机制也很丑陋，该实用程序类在 switch-case 中调用指定的构造函数。

在这种情况下，您如何设计界面？我应该使用抽象类吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:30:05.877

我同意您问题中的版本看起来有点不自然。

以下是一些替代方案：

1.  您可以向接口添加一个`void load(...)`，该`TestComponent`接口将使用 XML 中的状态加载“this”对象。（这类似于 上的`load`and`loadXML`方法`java.util.Properties`。）
2.  您可以在每个解析 XML 的实现类中定义一个构造函数`TestComponent`以获取对象的初始状态。
3.  您可以创建一个静态辅助方法。
4.  您可以创建一个`TestComponentFactory`接口，该接口具有`TestComponent load(...)`返回加载对象的方法。

不同的方法各有利弊。例如，工厂对象方法 (4.) 将解析/加载逻辑与`TestComponent`类分离，但需要额外的类和接口。另一方面，如果您有多个主界面的实现，其他三种方法往往会很麻烦。主要问题是您不能使用 Java 中的构造函数进行多态性。

最后，如果我正在设计这个，我会让该`load(...)`方法以流或阅读器作为参数，并自己进行 XML 解析（通过调用相关的库代码）。这样，您可以在一个地方（每个`TestComponent`实现类）处理所有这些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:04:14.747

Schifty 一种方法是更改​​ to 的返回`loadFromXML`值`void`。此方法不会返回 的新实例，而是`TestComponent`使用 XML 文档中的数据更新当前对象的内部内容。

**提示：**接口方法的访问修饰符是可选的。这是因为接口方法必须始终定义为`public`.

```
public interface TestComponent {
    Element saveAsXML() throws ParserConfigurationException;
    TestComponent loadFromXML(Element _xmlElement);  
} 
```

# asp-classic - 经典 ASP：使用 If 语句时为空选择

> ID：10852579
> 
> 赞同：0
> 
> 时间：2012-06-01T14:53:28.943
> 
> 标签：asp-classic

我有一段简单的代码从数据库表中填充一个选择对象。我想检查一个值以将一个条目设置为选中，但是当我检查一个 db 值时，我得到一个空的选择框。此代码生成空框：

```
response.write "<td><select name='FromDept'>"
Do While not rs.eof
   If rs("DeptID")  = 61 Then 
      response.write "<option value=" & rs("DeptID") & " selected>" & rs("DeptName")     & "</option>" 
   Else    
      response.write "<option value=" & rs("DeptID") & ">" & rs("DeptName") & "</option>"
   End If 
   rs.MoveNext     
Loop
rs.close
response.write "</select></td>" 
```

但是，此代码会生成一个带有值的选择框：

```
response.write "<td><select name='FromDept'>"
LpCnt = 0 
Do While not rs.eof

    If LpCnt = 9 Then 
       response.write "<option value=" & rs("DeptID") & " selected>" & rs("DeptName") & "</option>" 
    Else    
       response.write "<option value=" & rs("DeptID") & ">" & rs("DeptName") & "</option>"
    End If 
    rs.MoveNext     
    LpCnt = LpCnt + 1 
Loop
rs.close
response.write "</select></td>" 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:58:45.230

将值分配给临时变量：

```
response.write "<td><select name='FromDept'>"
Do While not rs.eof
   dept = rs("DeptID")
   If dept  = 61 Then 
      response.write "<option value=" & dept & " selected>" & rs("DeptName")     & "</option>" 
   ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T07:16:04.340

空下拉意味着您在该语句中遇到错误，并且很可能由于`On Error Resume Next`您在某处有行而被忽略。

首先，摆脱那条`On Error Resume Next`线。

其次，此类代码中的错误意味着类型转换问题。试试这个代码：

```
Dim curDeptID
Do While not rs.eof
   curDeptID = 0
   If Not IsNull(rs("DeptID")) Then
       curDeptID = CLng(CStr(rs("DeptID")))
   End If
   If curDeptID=61 Then 
      response.write "<option value=" & rs("DeptID") & " selected>" & rs("DeptName")     & "</option>" 
   Else    
      response.write "<option value=" & rs("DeptID") & ">" & rs("DeptName") & "</option>"
   End If 
   rs.MoveNext     
Loop 
```

# java - 如何转换列表 到 ArrayList

> ID：10852581
> 
> 赞同：3
> 
> 时间：2012-06-01T14:53:36.310
> 
> 标签：java, arrays, api, types, casting

[此 API 调用](http://zookeeper.apache.org/doc/r3.3.5/api/org/apache/zookeeper/ZooKeeper.html#getChildren%28java.lang.String,%20boolean%29)返回一个可能很大的未排序的 List<String>。我需要对其进行排序、搜索并访问随机元素。目前 List 是由 ArrayList 实现的（我检查了源代码），但在未来的某个未知点，API 开发人员可能会选择切换到 LinkedList 实现（不更改接口）。

对我的程序来说，排序、搜索、访问一个可能很大的 LinkedList 会非常慢且不可接受。因此我需要将 List 转换为 ArrayList 以确保我的程序的实际效率。但是，由于 List 很可能已经是 ArrayList，因此不必要地创建 List 的新 ArrayList 副本将是低效的。

鉴于这些限制，我想出了以下方法将 List 转换为 ArrayList：

```
private static <T> ArrayList<T> asArrayList(List<T> list) {
  if (list instanceof ArrayList) {
    return (ArrayList<T>) (list);
  } else {
    return new ArrayList<T>(list);
  }
} 
```

我的问题是：这是使用未知实现的列表的最有效方法吗？有没有更好的方法将 List 转换为 ArrayList？有比将 List 转换为 ArrayList 更好的选择吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T15:02:21.370

你真的不能比你所拥有的更简单了——在我看来，它可能是最有效的。

也就是说，这听起来很像过早的优化——只有当你使用的 API 的作者对`LinkedList`. 如果您现在担心它，您可能会花费大量时间和精力来规划甚至可能无法实现的未来场景 - 这是最好的时间花在寻找其他需要解决的问题上。大概您将更改 API 版本的唯一时间是在您自己的应用程序的版本之间 - 如果有的话，请在那时处理问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:00:18.183

正如您自己看到的那样，代码很简单而且很高效，因为它只在必要时创建一个副本。

所以答案是没有明显更好的选择，除了完全不同类型的解决方案，例如，也可以对您的列表进行排序。

（请记住，很少需要这种级别的优化，所以这不是一个非常常见的问题。）

更新：作为一般规则，只是事后诸葛亮，编写良好的 API 不会返回不适合它们可能包含的数据量的数据类型。这并不是说你应该盲目相信他们，但这并不是一个完全不合理的假设。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:17:43.090

> 对我的程序来说，排序、搜索、访问一个可能很大的 LinkedList 会非常慢且不可接受。

实际上，情况并没有那么糟糕。IIRC，Collections.sort 方法将列表复制到临时数组，对数组进行排序，`clear()`原始列表并将数组复制回它。对于足够大的列表，`O(NlogN)`排序阶段将主导`O(N)`复制阶段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T15:17:42.640

支持有效随机访问的 Java 集合实现了 RandomAccess 标记接口。对于这样的列表，您可以`Collections.sort`直接在列表上运行。对于没有随机访问的列表，您可能应该使用其中一种方法将列表转储到数组中，对该数组进行`toArray`排序，然后将其包装到 random-access`List`中。

```
T[] array = (T[])list.toArray(); // just suppress the warning if the compiler worries about unsafe cast
Arrays.sort(array);
List<T> sortedList = Arrays.asList(array); 
```

我认为`Arrays.asList`实际上创建了一个`ArrayList`，所以如果你愿意，你可以尝试转换它的结果。

`Collections.sort`对所有`List`实现都是有效的，只要它们提供有效的`ListIterator`. 该方法将列表转储到一个数组中，对其进行排序，然后使用`ListIterator`O(n) 将值复制回列表中。

# liquid - Shopify 液体截断

> ID：10852583
> 
> 赞同：4
> 
> 时间：2012-06-01T14:53:42.713
> 
> 标签：liquid, shopify

我正在为我的商店开发一个新的 Shopify 模板。我正在尝试将标题中的字符数和描述中的字符数相加。从 200 中减去这个总数，然后在我的截断中使用结果。

（这是因为我想在每个框中获得相同数量的字符）

我认为下面的代码可以工作.... 捕获位有效（nb：如果我的总字符数 = 204，结果为 4）但似乎截断不能处理变量？

```
 {% capture truncateBy %}
 {{ product.title.size | plus: product.description.size  | minus: 200 }}
 {% endcapture %}

 <p>{{ product.description | strip_html | replace: '&nbsp;', ' ' | truncate: truncateBy }}</p> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T06:02:58.250

你的代码似乎对我有用。它以什么方式不起作用？它是否显示错误、整个描述或“...”？

您可以尝试的另一种方法是使用实​​际变量分配而不是捕获：

`{% assign truncateBy = product.title.size | plus: product.description.size | minus: 200 %}`

编辑：截断将截断到给定的字符数，所以如果你只想要 200 个字符，那么你可以使用该常量目录作为截断的参数：

`<p>{{ product.description | strip_html | replace: '&nbsp;', ' ' | truncate: 200 }}</p>`

[有关详细信息，请参阅截断过滤器](http://wiki.shopify.com/Truncate)的文档。

# genetic-algorithm - 寻找流水车间调度健身

> ID：10852584
> 
> 赞同：0
> 
> 时间：2012-06-01T14:53:49.840
> 
> 标签：genetic-algorithm, evolutionary-algorithm

我正在处理流程作业调度问题。是否有一个数学方程来计算适应度而不是甘特图？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T03:34:40.153

似乎最常见的健身措施是制造跨度。具体来说，您将最小化时间表的总长度（更小的制造跨度->更好的适应度）。

# c - 无效指针错误

> ID：10852595
> 
> 赞同：0
> 
> 时间：2012-06-01T14:54:36.520
> 
> 标签：c, pointers, memory-management, free

我在 R 函数中嵌入了一些 C 代码，它以相同的方式保持 sigsegging，但在不同的点（通过程序进展 - 似乎总是来自同一个函数）。

事情是这样的——我得到的错误是；

```
*** glibc detected *** /packages/R/2.15.0/lib64/R/bin/exec/R: munmap_chunk(): 
invalid pointer: 0x0000000014059b20 *** 
```

现在这是一个非常标准的错误（如果我记得的话，它`munmap_chunk()`是其中的一部分`free()`）——奇怪的是，错误来自一个函数，该函数正在从一个结构中释放一组数组（程序分配并释放数百万个这些结构）其正常运行的过程）。

函数如下所示；

```
multifit_work_t *free_multifit(multifit_work_t *work)
{

  if (work == NULL || work->u==NULL || work->w==NULL || work->v==NULL || work->b==NULL || work->rv1==NULL) {
    fprintf(stderr,"ERROR: Internal array in multifit_work_t object was already NULL\n");
    exit(1);
  }

  // each of the work->* arrays are just an array of doubles of length 1 or more.

  // LOGGING FUNCTIONALITY: Here, prints out the address and values of each 
  // of the arrays

  // free each array first
  free(work->u);
  free(work->w);
  free(work->v);
  free(work->b);
  free(work->rv1);
  free(work);

  // LOGGING FUNCTIONALITY: Here prints an, "Exiting free_multifit()" message

  return NULL;
} 
```

所以我在释放它之前检查每个指针。我添加了日志功能以输出每个数组的地址和初始值。为有问题的指针生成上述错误的崩溃日志文件，我得到了很多命中（可以理解，我们在释放后重新使用相同的内存位置）；

```
$: grep 14059b20 logfile.txt
....
194624) work->b: ADDRESS: [0x14059b20] VALUE: [-5.620804e-02]
194629) work->b: ADDRESS: [0x14059b20] VALUE: [2.759472e+00]
194634) work->b: ADDRESS: [0x14059b20] VALUE: [5.498979e-02]
194684) work->b: ADDRESS: [0x14059b20] VALUE: [9.323869e+07]
194689) work->b: ADDRESS: [0x14059b20] VALUE: [3.016410e+07]
194694) work->b: ADDRESS: [0x14059b20] VALUE: [1.688376e-08]
194699) work->b: ADDRESS: [0x14059b20] VALUE: [1.660441e+00]
..... 
```

操作 194699 是我在段错误之前获得的最后一组值；

```
Calling free_multifit...
194696) work->u: ADDRESS: [0x1305f7d0] VALUE: [1.350474e+01]
194697) work->w: ADDRESS: [0x92ec810] VALUE: [1.350474e+01]
194698) work->v: ADDRESS: [0x122cc210] VALUE: [5.798884e-09]
194699) work->b: ADDRESS: [0x14059b20] VALUE: [1.660441e+00]
194700) work->rv1: ADDRESS: [0xea37a50] VALUE: [0.000000e+00]
< If it didn't crash in the function we'd see an "Exiting function message" here - so it sigsegs on the freeing of one the the arrays or the work object itself.
[EOF] 
```

因此，尽管检查指针是好的，并且实际上从它的位置（1.66）中提取了一个值，但当我尝试释放它时似乎一切都出错了。

任何想法为什么/如何发生这种情况？这是硬件问题吗？我在集群上运行它，如果这有什么不同的话。

**更新 1**

multifit_work_t 通过以下方式创建；

```
typedef struct {
  int m,n;
  double *w,*u,*v,*b,*rv1;
} multifit_work_t;

multifit_work_t *alloc_multifit(int m, int n)
{
  multifit_work_t *work=(multifit_work_t *)malloc(sizeof(multifit_work_t));
  if (work==NULL) {
    fprintf(stderr,"failed to allocate multifit_work\n");
    exit(1);
  }

  work->m=m;
  work->n=n;
  work->u=(double *)malloc(n*m*sizeof(double)); /* temporary storage - n x m matrix */
  work->w=(double *)malloc(n*sizeof(double)); /* n vector */
  work->v=(double *)malloc(n*n*sizeof(double)); /* n x n matrix */
  work->b=(double *)malloc(m*sizeof(double)); /* m vector */
  work->rv1=(double *)malloc(n*sizeof(double)); /* temporary storage - n vector */
  if (work->u==NULL || work->w==NULL || work->v==NULL || work->b==NULL || work->rv1==NULL) {
    fprintf(stderr,"failed to allocate multifit_work\n");
    exit(1);
  }

  return work;
} 
```

**更新 2**

当我在本地系统上运行它时，会发生同样的事情，但错误是这样的；

```
 *** caught segfault ***
address 0x11e000000, cause 'memory not mapped' 
```

总是在一个明显均匀的内存地址。

**更新 3**

以下是 valgrind 报告

```
valgrind --leak-check=full --show-reachable=yes ./execute 
==23072== Memcheck, a memory error detector
==23072== Copyright (C) 2002-2010, and GNU GPL'd, by Julian Seward et al.
==23072== Using Valgrind-3.6.0.SVN-Debian and LibVEX; rerun with -h for copyright info
==23072== Command: ./execute
==23072== 
==23072== 
==23072== HEAP SUMMARY:
==23072==     in use at exit: 0 bytes in 0 blocks
==23072==   total heap usage: 445 allocs, 445 frees, 27,900 bytes allocated
==23072== 
==23072== All heap blocks were freed -- no leaks are possible
==23072== 
==23072== For counts of detected and suppressed errors, rerun with: -v
==23072== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 23 from 8) 
```

这要死我了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T14:59:41.703

你应该养成`NULL`在释放它们之后设置它们的习惯：

```
free(work->u);
free(work->w);
free(work->v);
free(work->b);
free(work->rv1);
work->u = work->w = work->v = work->b = work->rv1 = NULL;
free(work); 
```

还要`NULL`在调用的函数中设置工作`free_multifit`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T19:16:48.083

当您写入数组时，请确保您没有越界。这些指针存储在堆中，因此我们可能会看到由于对数组的某些越界访问而导致的指针损坏。

> 总是在一个明显均匀的内存地址。

内存通常是字节对齐的，具体取决于操作系统和系统，并且您正在使用 8 字节值（64 位双精度浮点数）。所以你可能会看到很多以 0x....0、0x....8、0x....10、0x....18、0x....20 等结尾的地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T19:02:29.093

Somewhere, deep, deep, in the code, an input array was only filling a local array a small portion of its (m)allocated size. The code was then calling the uninitialized regions of the array, the values of which looked a lot like the expected input (which is why it took my so long to identify).

In summary - overstepping arrays is bad, but watch out for *understepping* (when initializing) too!

# c# - System.Diagnostics.Process.Start() 奇怪的行为

> ID：10852598
> 
> 赞同：7
> 
> 时间：2012-06-01T14:54:43.007
> 
> 标签：c#, process.start

我有一个使用 Process.Start(string Filename) 打开文件的应用程序。此方法重载将导致系统根据文件扩展名调用适当的应用程序。就我而言，它通常是 WORD、PPT、PDF、JPG 等……某种类型的可查看文档。最终，我需要启动该进程，然后在应用程序中我需要对 MainWindowHandle 值做一些事情。

我发现至少三种不同的情况导致 Process.Start(string filename) 返回不同的方式......

对于下面的第一种和第二种情况，假设我正在打开两个 .pdf 文件（但如果我同时打开两个 .ppt 或两个 .doc 文件，也会发生同样的事情）...

案例 1：如果 AcroRd32 没有运行，我会执行类似的操作。

```
Process p = Process.Start("yada.pdf");
p.WaitForInputIdle();
p.Refresh(); 
```

事情按预期工作。p.MainWindowHandle 值已正确填充。这个案子没有问题。

案例 2：现在假设在调用 Process.Start() 时 AcroRd32 已经在之前打开的 pdf 文件上运行。现在事情变得很奇怪。参考下面的代码（为清楚起见删除了一些错误检查逻辑），在调用 Process.Start() 之后 p.MainWindowHandle 的值为零（即使创建了窗口），并且 p.MainWindowTitle 为空。然后我睡了 1 秒钟，句柄仍然为零，但现在填充了主窗口标题（即使我没有在睡眠后调用 p.Referesh()。每个跟踪语句中都有“<<<<”注释在运行时打印。

```
Process p = Process.Start("SomeFileName.pdf");
p.WaitForInputIdle();
p.Refresh();
if (p.MainWindowHandle == 0)
    DebugTrace("MainWindowHandle is zero, why??");   //<<<<
if (p.MainWindowTitle.Length == 0)
    DebugTrace("MainWindowTitle is null");           //<<<<
Thread.Sleep(1000);
if (p.MainWindowHandle == 0)
    DebugTrace("MainWindowHandle is still zero.");   //<<<<
if (p.MainWindowTitle.Length == 0)
    DebugTrace("MainWindowTitle is null");
else
    DebugTrace("MainWindowTitle: " + p.MainWindowTitle);  //<<<< 
```

我确信这与 AcroRd32 已经在运行这一事实有关，但我无法控制它，我确实需要获取 p.MainWindowHandle 的值。任何想法如何处理这个？

案例3：然后到第三种情况：在某些情况下， Process.Start() 即使成功打开文件也会返回 null 。我发现 .jpg 文件就是这种情况，但我确信这仅取决于已分配给 .jpg 扩展名的应用程序。如果应用程序是“Windows 照片查看器”，则 Process.Start("file.jpg") 返回 null，但如果我将其更改为“Paint”，则它不会返回 null。那是怎么回事？那我怎么才能拿到手柄呢？

好的，一切都完成了，抱歉细节，但希望我正在解释我正在努力解决的情况！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:04:33.623

我怀疑 Windows 使用 acroRd32 启动一个新进程，然后将给定的文件路径传递给正在运行的实例，然后关闭。

这通常是为了避免程序的多个实例而完成的......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-04T12:54:57.987

您不能依赖 Process.Start 返回的 MainWindowHandle。正如您所提到的，当文件被已经运行的应用程序打开时，它不会返回它。从 Windows Vista 开始，MS 添加了 ReStart Manager，这是一个新的 api，可以在给定文件上提供锁定进程。[https://msdn.microsoft.com/en-us/magazine/cc163450.aspx](https://msdn.microsoft.com/en-us/magazine/cc163450.aspx)

我对这个问题的看法是尝试 Process.Start 的 MainWindowHandle 和锁定句柄 ReStart 管理器返回。有一个来自 MSDN 杂志的示例代码。[https://github.com/andrewchaa/PopOpen/blob/master/Pop.Cs/InUseDetection.cs](https://github.com/andrewchaa/PopOpen/blob/master/Pop.Cs/InUseDetection.cs)

# java - 如何使用 @ImplementedBy 注释的接口的 Guice 获取实例

> ID：10852599
> 
> 赞同：0
> 
> 时间：2012-06-01T14:54:45.347
> 
> 标签：java, guice

我正在使用一个内部有一个类的库

```
@ImplementedBy(MyClassImpl.class)
public interface MyClassInterface {
....
} 
```

Guice 时，如何获取 MyClassImpl 的实例？

我是否必须创建绑定：

```
bind(MyClassInterface.class).to(MyClassImpl.class); 
```

为了使用它？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:00:36.133

不，您不必创建绑定，尽管您可以。如果你这样做，它将覆盖`@ImplementedBy`注释。

您可以通过普通注入获得它的实例，例如

```
@Inject
public Client(MyClassInterface foo) {
  ...
} 
```

或（如果是顶级课程）：

```
injector.getInstance(MyClassInterface.class); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:01:31.190

您要么注入接口：

```
@Inject
MyClassInterface myClass; 
```

或者您可以使用注入器来获取实例：

```
MyClassInterface myClass = injector.getInstance(MyClassInterface.class); 
```

两者都将被注入 MyClassImpl 类型。

# asp.net - ModelState.IsValid 为真，但 POST 数据中缺少 [Required] 属性

> ID：10852607
> 
> 赞同：4
> 
> 时间：2012-06-01T14:55:05.300
> 
> 标签：asp.net, asp.net-mvc-3

我的视图模型有一个 [Required] 不可为空的 int 属性，由 DropDownListFor 选择。如果要从中选择的列表为空，则 ModelState.IsValid 为真。

我的模型有一个必需的 int 属性：

```
public class MyModel
{
    [Required]
    public int PickedValue  { get; set;}

    IEnumerable<SelectListItem> Items { get; set; }
} 
```

在我的 Create 视图中，我渲染了一个`<select>`元素：

```
@Html.DropDownListFor(model => model.PickedValue, model.Items) 
```

在我的控制器中，如果`model.Items`列表为空（没有可供选择的元素），`ModelState.IsValid`则为真：

```
[HttpPost]
public ActionResult Create( MyModel model )
{
    if( ModelState.IsValid )
    {
        // true, and ModelState.Keys doesn't contain PickedValue because it was never POSTed.
    }
    //...
 } 
```

现在，如果：

1.  `PickedValue`是`Nullable`( `int?`)，或
2.  如果我的`<select>`- `@Html.DropDownListFor(model => model.PickedValue, model.Items, ""`) 中有一个空项目，或者
3.  如果启用了客户端验证（因为从未触发该操作）。

如果POST 数据中缺少某些属性但是否有强制方法`ModelState.IsValid`？这不应该是默认行为吗？`false``MyModel``[Required]`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:21:33.633

在您的情况下，我认为将 PickedValue 设为可为空的 int 可能会更好。如果您的 DropDownList 有可能没有项目，则 null 应该是 PickedValue 的可能值。

**回复评论**

> 这是有道理的，但没有回答我原来的问题......如果 MyModel 的某些属性是 [Required] 但 POST 数据中缺少，有没有办法强制 ModelState.IsValid 为假？这不应该是默认行为吗？

当涉及到 int、double、bool 和其他不能有 null 值的原语时，当 DefaultModelBinder 在 HTTP 请求中没有收到它们的数据时，它仍然必须构造一个模型实例。因此，模型被构建并且属性被初始化为其默认值。如果是 int，这意味着它将被初始化为零。由于在 HTTP 请求中没有收到任何内容，这意味着 int 永远不会被设置，因此它将始终为零。您是否尝试过为您的 int 提供 [Range] 验证器而不是 [Required] 验证器？这应该验证它不为零：

```
[Range(1, int.MaxValue)]
public int PickedValue  { get; set; } 
```

> 我想避免更改模型，因为它已经是我的代码中的一种常见模式......另外，使模型中的属性可以为空以强制它不为空似乎违反直觉。

仅仅因为它是代码中的常见模式并不意味着它是正确的。我必须重申我原来的答案：*如果您的下拉列表可能没有任何项目，那么您的模型**应该**允许`null`其选择的值。*

这就是为什么最好使用单独的实体和视图模型层的原因之一。在您的域实体中，可能需要关系。但是，当用户第一次看到表单以选择该关系时，您必须给他们一个默认或空的选定下拉项。在这种情况下，实体中的外键可能是 int，但视图模型中的表示应该是`Nullable<int>`. 仅出于这个原因，我认为仅仅为了确保它不为空而使某些东西可以为空是不违反直觉的。您在 viewmodel 中使其可以为空，这样您就可以给用户一个带有空白值的表单，并要求他们填写它。

# c# - IRCBot C# 连接问题

> ID：10852609
> 
> 赞同：3
> 
> 时间：2012-06-01T14:55:07.803
> 
> 标签：c#, irc

我的 IRC Bot 有问题我正在尝试用 c# 编写，只是为了帮助我了解 IRC 协议，我计划在未来编写一个客户端/服务器，但你可以猜到我是离这个很远：P

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net.Sockets;
using System.IO;

namespace LolBot
{
struct IRCConfig
{
    public string server;
    public int port;
    public string nick;
    public string name;

}

class IRCBot
{
    TcpClient IRCConnection = null;
    IRCConfig config;
    NetworkStream ns = null;
    StreamReader sr = null;
    StreamWriter sw = null;

    public IRCBot(IRCConfig config)
    {
        this.config = config;
        try
        {
            IRCConnection = new TcpClient(config.server, config.port);
        }
        catch
        {
            Console.WriteLine("Connection Error");
        }

        try
        {
            ns = IRCConnection.GetStream();
            sr = new StreamReader(ns);
            sw = new StreamWriter(ns);
            sendData("USER", config.nick + config.name);
            sendData("NICK", config.nick);
        }
        catch
        {
            Console.WriteLine("Communication error");
        }
        finally
        {
            if (sr != null)
                sr.Close();
            if (sw != null)
                sw.Close();
            if (ns != null)
                ns.Close();
            if (IRCConnection != null)
                IRCConnection.Close();
        }

    }

    public void sendData(string cmd, string param)
    {
        if (param == null)
        {
            sw.WriteLine(cmd);
            sw.Flush();
            Console.WriteLine(cmd);
        }
        else
        {
            sw.WriteLine(cmd + " " + param);
            sw.Flush();
            Console.WriteLine(cmd + " " + param);
        }
    }

    public void IRCWork()
    {
        string[] ex;
        string data;
        bool shouldRun = true;
        while (shouldRun)
        {
            data = sr.ReadLine();
            Console.WriteLine(data);
            char[] charSeparator = new char[] { ' ' };
            ex = data.Split(charSeparator, 5);

            if (ex[0] == "PING")
            {
                sendData("PONG", ex[1]);
            }

            if (ex.Length > 4) //is the command received long enough to be a bot command?
            {
                string command = ex[3]; //grab the command sent

                switch (command)
                {
                    case ":!join":
                        sendData("JOIN", ex[4]); //if the command is !join send the "JOIN" command to the server with the parameters set by the user
                        break;
                    case ":!say":
                        sendData("PRIVMSG", ex[2] + " " + ex[4]); //if the command is !say, send a message to the chan (ex[2]) followed by the actual message (ex[4]).
                        break;
                    case ":!quit":
                        sendData("QUIT", ex[4]); //if the command is quit, send the QUIT command to the server with a quit message
                        shouldRun = false; //turn shouldRun to false - the server will stop sending us data so trying to read it will not work and result in an error. This stops the loop from running and we will close off the connections properly
                        break;
                }
            }
        }
    }
}

class Program
{
    static void Main(string[] args)
    {
        IRCConfig conf = new IRCConfig();
        conf.name = "LolBot";
        conf.nick = "LolBot";
        conf.port = 6667;
        conf.server = "irc.strictfp.com";
        new IRCBot(conf);
        Console.WriteLine("Bot quit/crashed");
        Console.ReadLine();
    }
} 
```

}

每当我执行 Bot 时，它都会出现：

```
USER AspiBot google.com google.com :AspiBot
NICK AspiBot
Bot quit/crashed 
```

我真的不明白为什么它在连接到服务器之前就退出了，我也在研究如何设置它来加入频道，我知道我需要使用 JOIN 但我不确定如何实现它.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T14:59:15.437

您可能不应该在构造函数中做太多事情，但是您在这里遇到的问题是您`IRCWork()`在更新机器人后没有调用。

```
var bot = new IRCBot(conf);
bot.IRCWork(); 
```

**编辑**您还在构造函数的 finally 块中关闭所有连接，因此 IRCWork() 无论如何都不会工作。尝试实施`IDisposable`，并将您的关闭逻辑放入`Dispose()`：

```
using (var bot = new IRCBot(conf))
{
    bot.IRCWork();
} 
```

**发布代码的快速重构**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net.Sockets;
using System.IO;

namespace LolBot
{
    internal struct IRCConfig
    {
        public string server;
        public int port;
        public string nick;
        public string name;

    }

    internal class IRCBot : IDisposable
    {
        private TcpClient IRCConnection = null;
        private IRCConfig config;
        private NetworkStream ns = null;
        private StreamReader sr = null;
        private StreamWriter sw = null;

        public IRCBot(IRCConfig config)
        {
            this.config = config;
        }

        public void Connect()
        {
            try
            {
                IRCConnection = new TcpClient(config.server, config.port);
            }
            catch
            {
                Console.WriteLine("Connection Error");
                throw;
            }

            try
            {
                ns = IRCConnection.GetStream();
                sr = new StreamReader(ns);
                sw = new StreamWriter(ns);
                sendData("USER", config.nick + config.name);
                sendData("NICK", config.nick);
            }
            catch
            {
                Console.WriteLine("Communication error");
                throw;
            }
        }

        public void sendData(string cmd, string param)
        {
            if (param == null)
            {
                sw.WriteLine(cmd);
                sw.Flush();
                Console.WriteLine(cmd);
            }
            else
            {
                sw.WriteLine(cmd + " " + param);
                sw.Flush();
                Console.WriteLine(cmd + " " + param);
            }
        }

        public void IRCWork()
        {
            string[] ex;
            string data;
            bool shouldRun = true;
            while (shouldRun)
            {
                data = sr.ReadLine();
                Console.WriteLine(data);
                char[] charSeparator = new char[] {' '};
                ex = data.Split(charSeparator, 5);

                if (ex[0] == "PING")
                {
                    sendData("PONG", ex[1]);
                }

                if (ex.Length > 4) //is the command received long enough to be a bot command?
                {
                    string command = ex[3]; //grab the command sent

                    switch (command)
                    {
                        case ":!join":
                            sendData("JOIN", ex[4]);
                                //if the command is !join send the "JOIN" command to the server with the parameters set by the user
                            break;
                        case ":!say":
                            sendData("PRIVMSG", ex[2] + " " + ex[4]);
                                //if the command is !say, send a message to the chan (ex[2]) followed by the actual message (ex[4]).
                            break;
                        case ":!quit":
                            sendData("QUIT", ex[4]);
                                //if the command is quit, send the QUIT command to the server with a quit message
                            shouldRun = false;
                                //turn shouldRun to false - the server will stop sending us data so trying to read it will not work and result in an error. This stops the loop from running and we will close off the connections properly
                            break;
                    }
                }
            }
        }

        public void Dispose()
        {
            if (sr != null)
                sr.Close();
            if (sw != null)
                sw.Close();
            if (ns != null)
                ns.Close();
            if (IRCConnection != null)
                IRCConnection.Close();
        }
    }

    internal class Program
    {
        private static void Main(string[] args)
        {
            IRCConfig conf = new IRCConfig();
            conf.name = "LolBot";
            conf.nick = "LolBot";
            conf.port = 6667;
            conf.server = "irc.strictfp.com";
            using (var bot = new IRCBot(conf))
            {
                bot.Connect();
                bot.IRCWork();
            }
            Console.WriteLine("Bot quit/crashed");
            Console.ReadLine();
        }
    }
} 
```

# javascript - Ember.js – 将#each 循环中的按钮操作绑定到它自己的模型

> ID：10852611
> 
> 赞同：5
> 
> 时间：2012-06-01T14:55:13.793
> 
> 标签：javascript, ember.js

我似乎无法获得在`#each`模板循环中生成的按钮，以将其单击操作绑定到其关联模型。这是问题的快速演示......

`Ember.js`应用程序设置：

```
window.Contacts = Ember.Application.create();

Contacts.Person = Ember.Object.extend({
    first: '',
    last: '',
    save: function() {
        // send updated information to server.
    }
});

Contacts.contactsList = Ember.ArrayController.create({
    content:[],
    init: function() {
        this.pushObject( Contacts.Person.create({
            first:'Tom',
            last:'Riddle'
        }));
    }
}); 
```

模板：

```
<script type="text/x-handlebars">
    {{#each Contacts.contactsList}}
    <li>
        {{view Ember.TextField valueBinding="first" viewName="firstname"}}
        {{view Ember.TextField valueBinding="last" viewName="lastname"}}
        <button {{action "save" on="click"}}>Save</button>
    </li>
    {{/each}}
</script> 
```

问题：

所以，这个简单的演示场景中的想法是，每条记录的“保存”按钮将触发一个动作来保存自己模型的状态。但是，单击“保存”按钮会出现错误：

```
Uncaught TypeError: Cannot call method 'call' of undefined 
```

我的假设是，将“保存”指定为按钮的操作会将其绑定到`save`其模型上的方法。然而，情况似乎并非如此。其他一些对象似乎正在处理单击操作，其中未定义“保存”处理程序。我在这里错过了什么吗？如何让每个订单项的按钮在其自己的模型上调用处理程序？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T16:34:47.340

您可以通过设置 -surprise -`target`属性来定义动作的目标，请参见[http://jsfiddle.net/pangratz666/FukKX/](http://jsfiddle.net/pangratz666/FukKX/)：

```
<script type="text/x-handlebars" >
    {{#each Contacts.contactsList}}
    <li>
        {{view Ember.TextField valueBinding="first" viewName="firstname"}}
        {{view Ember.TextField valueBinding="last" viewName="lastname"}}
        {{#with this as model}}
            <button {{action "save" target="model"}}>Save</button>
        {{/with}}
    </li>
    {{/each}}
</script>​ 
```

需要围绕动作的`{{#with}}`助手，因为动作助手不接受`this`作为`target`.

* * *

但请注意您的设计：应在视图或控制器上调用操作。然后目标负责执行进一步的操作，例如保存，...

因此，我将按如下方式实现您的示例，请参见[http://jsfiddle.net/pangratz666/U2TKJ/](http://jsfiddle.net/pangratz666/U2TKJ/)：

**车把**：

```
<script type="text/x-handlebars" >
    {{#each Contacts.contactsList}}
    <li>
        {{view Ember.TextField valueBinding="first" viewName="firstname"}}
        {{view Ember.TextField valueBinding="last" viewName="lastname"}}
        <button {{action "save" target="Contacts.contactsController" }}>Save</button>
    </li>
    {{/each}}
</script>​ 
```

**JavaScript**：

```
Contacts.contactsController = Ember.Object.create({
    save: function(event) {
        console.log('do something with: ', event.context);
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-26T15:13:57.800

有两种可能的方式

```
{{#each answer in effort_reasons itemController="module_answer"}}
{{/each}} 
```

所以每个项目都有自己的控制器，其中模型是每个项目（在这种情况下是答案），这对于像输入视图这样的东西特别有用，其中 valueBinding 会导致将每个输入视图绑定到相同的值。请注意，这是唯一一次 Ember 中的控制器不是单例，并且具有不同的 ID，如果您想将值保存在原始控制器中，您可以通过以下方式获得参考

```
this.get('controller.parentController') 
```

在你的 itemController 里面。

或者您在每个循环中使用提到的操作方法

```
{{action "actionname" parameter paramter2...}} 
```

# sql - 将 SQL Server 中的字符串拆分为最大长度，并将每个字符串作为一行返回

> ID：10852612
> 
> 赞同：6
> 
> 时间：2012-06-01T14:55:14.013
> 
> 标签：sql, sql-server, tsql

有没有办法将字符串（从特定列）拆分为 n 个字符而不会破坏单词，每个结果都在自己的行中？

例子：

```
2012-04-24 Change request #3 for the contract per terms and conditions and per John Smith in the PSO department  Customer states terms should be Net 60 not Net 30\.  Please review signed contract for this information. 
```

结果：

```
2012-04-24 Change request #3 for the contract per terms and conditions and per John Smith in the
PSO department  Customer states terms should be Net 60 not Net 30.
Please review signed contract for this information. 
```

我知道我可以`charindex`用来查找最后一个空格，但我不确定如何获取剩余的空格并将它们作为行返回。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T15:20:54.180

尝试这样的事情。可能是您可以创建以下实现的 SQL 函数。

```
DECLARE @Str VARCHAR(1000)
SET @Str = '2012-04-24 Change request #3 for the contract per terms and conditions and per John Smith in the PSO department  Customer states terms should be Net 60 not Net 30\.  Please review signed contract for this information.'

DECLARE @End INT
DECLARE @Split INT

SET @Split = 100

declare @SomeTable table
(
  Content varchar(3000)
)

WHILE (LEN(@Str) > 0)
BEGIN
    IF (LEN(@Str) > @Split)
    BEGIN
        SET @End = LEN(LEFT(@Str, @Split)) - CHARINDEX(' ', REVERSE(LEFT(@Str, @Split)))
        INSERT INTO @SomeTable VALUES (RTRIM(LTRIM(LEFT(LEFT(@Str, @Split), @End))))
        SET @Str = SUBSTRING(@Str, @End + 1, LEN(@Str))
    END
    ELSE
    BEGIN
        INSERT INTO @SomeTable VALUES (RTRIM(LTRIM(@Str)))
        SET @Str = ''
    END
END

SELECT *
FROM @SomeTable 
```

输出将是这样的：

```
2012-04-24 Change request #3 for the contract per terms and conditions and per John Smith in the
PSO department  Customer states terms should be Net 60 not Net 30\.  Please review signed contract
for this information. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T20:27:04.323

只是为了看看它是否可以完成，我想出了一个不循环的解决方案。它是基于[别人的函数](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=153458)来根据分隔符拆分字符串。

**注意：** 这要求您提前知道最大令牌长度。该函数将在遇到比指定行长更长的标记时停止返回行。可能还潜伏着其他错误，因此请谨慎使用此代码。

```
CREATE FUNCTION SplitLines
(
    @pString    VARCHAR(7999),
    @pLineLen   INT,
    @pDelim     CHAR(1)
)
RETURNS TABLE
   WITH SCHEMABINDING
AS  
RETURN
WITH
      E1(N) AS ( --=== Create Ten 1's
                 SELECT 1 UNION ALL SELECT 1 UNION ALL
                 SELECT 1 UNION ALL SELECT 1 UNION ALL
                 SELECT 1 UNION ALL SELECT 1 UNION ALL
                 SELECT 1 UNION ALL SELECT 1 UNION ALL
                 SELECT 1 UNION ALL SELECT 1 --10
               ),
      E2(N) AS (SELECT 1 FROM E1 a, E1 b),   --100
      E4(N) AS (SELECT 1 FROM E2 a, E2 b),   --10,000
cteTally(N) AS (SELECT ROW_NUMBER() OVER (ORDER BY (SELECT N)) FROM E4),
lines AS (
  SELECT TOP 1
         1 as LineNumber,
         ltrim(rtrim(SUBSTRING(@pString, 1, N))) as Line,
         N + 1 as start
  FROM cteTally
  WHERE N <= DATALENGTH(@pString) + 1
    AND N <= @pLineLen + 1
    AND SUBSTRING(@pString + @pDelim, N, 1) = @pDelim
  ORDER BY N DESC
UNION ALL
  SELECT LineNumber, Line, start
  FROM (
    SELECT LineNumber + 1 as LineNumber,
           ltrim(rtrim(SUBSTRING(@pString, start, N))) as Line,
           start + N + 1 as start,
           ROW_NUMBER() OVER (ORDER BY N DESC) as r
    FROM cteTally, lines
    WHERE N <= DATALENGTH(@pString) + 1 - start
      AND N <= @pLineLen
      AND SUBSTRING(@pString + @pDelim, start + N, 1) = @pDelim
  ) A
  WHERE r = 1
)
SELECT LineNumber, Line
FROM lines 
```

它实际上非常快，你可以做一些很酷的事情，比如加入它。这是一个简单的示例，它从表中的每一行中获取第一行：

```
declare @table table (
  id int,
  paragraph varchar(7999)
)
insert into @table values (1, '2012-04-24 Change request #3 for the contract per terms and conditions and per John Smith in the PSO department  Customer states terms should be Net 60 not Net 30\.  Please review signed contract for this information.')
insert into @table values (2, 'Is there a way to split a string (from a specific column) to n-number chars without breaking words, with each result in its own row?')

select t.id, l.LineNumber, l.Line, len(Line)
from @table t
cross apply SplitLines(t.paragraph, 42, ' ') l
where l.LineNumber = 1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-20T09:08:08.610

我读了一些文章，每篇文章都有错误或性能不佳，或者无法在我们想要的小块或大块中工作。您甚至可以在本文下面的任何答案中阅读我的评论。最后我找到了一个很好的答案，并决定在这个问题中分享它。我没有在各种情况下检查性能，但我认为对于大小块长度来说是可以接受的并且工作正常。这是代码：

```
CREATE function SplitString
(   
    @str varchar(max),
    @length int
)
RETURNS @Results TABLE( Result varchar(50),Sequence INT ) 
AS
BEGIN

DECLARE @Sequence INT 
SET @Sequence = 1

    DECLARE @s varchar(50)
    WHILE len(@str) > 0
    BEGIN
        SET @s = left(@str, @length)
        INSERT @Results VALUES (@s,@Sequence)

        IF(len(@str)<@length)
        BREAK

        SET @str = right(@str, len(@str) - @length)
        SET @Sequence = @Sequence + 1
    END
    RETURN 
END 
```

来源是@Rhyno 对这个问题的回答：[TSQL UDF To Split String Every 8 Characters](https://stackoverflow.com/questions/6079103/tsql-udf-to-split-string-every-8-characters)

希望这有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T18:51:20.947

我知道这有点晚了，但递归 cte 可以实现这一点。

您还可以使用包含一系列数字的种子表作为起始索引的乘数输入子字符串。

# java - 如何从 Lucene 中提取 fieldNorm？

> ID：10852613
> 
> 赞同：2
> 
> 时间：2012-06-01T14:55:14.117
> 
> 标签：java, lucene

我正在使用 Lucene 3.6，我想在文档的某个字段中获取每个术语的分数，以供将来在搜索时使用。为了存储索引，我创建了这样的文档：

```
Document doc = new Document();
doc.add(new Field("description", entry.getDescription(), Field.Store.NO, Field.Index.ANALYZED, Field.TermVector.WITH_POSITIONS_OFFSETS));
writer.addDocument(doc);
writer.close(true); 
```

例如，文档有一个“足球”术语：

```
...
1.623904 = (MATCH) fieldWeight(description:football in 1775), product of:
1.0 = tf(termFreq(description:football )=1)
8.660821 = idf(docFreq=5, maxDocs=12741)
0.1875 = fieldNorm(field=description, doc=1775)
... 
```

我正在使用此代码来获取`tf`和`idf`：

```
TermFreqVector freqV = indexReader.getTermFreqVector(docId, "description");
for (int j = 0; j < freqV.getTerms().length; j++) {
    String term = freqV.getTerms()[j];
    int freq = freqV.getTermFrequencies()[j];
    float idf = similarity.idfExplain(new Term("descpription", term), searcher).getIdf();
} 
```

但我不明白如何`fieldNorm`在搜索时获得。有人可以帮忙解答这个问题吗？

谢谢。

# emacs - 如何在 emacs telnet 模式下发出 telnet 命令？

> ID：10852616
> 
> 赞同：2
> 
> 时间：2012-06-01T14:55:18.787
> 
> 标签：emacs, telnet

我需要发出 telnet close 命令，通常，^] (Ctrl-]) 应该可以工作。（找不到任何 emacs 特定的 telnet 文档）

`telnet>`在 emacs 中使用 Mx telnet 连接时如何获得提示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T16:07:30.147

通过查看图书馆评论`M-x` `find-library` `RET` `telnet` `RET`显示以下内容：

```
;; Normally, input is sent to the remote telnet/rsh line-by-line, as you
;; type RET or LFD.  C-c C-c sends a C-c to the remote immediately;
;; C-c C-z sends C-z immediately.  C-c C-q followed by any character
;; sends that character immediately. 
```

所以你可以发送转义字符：

`C-c``C-q``C-]`

# c# - 替换 Windows 窗体中默认的未处理错误对话框

> ID：10852620
> 
> 赞同：1
> 
> 时间：2012-06-01T14:55:35.037
> 
> 标签：c#, winforms, error-handling

目前，当我的 Windows 窗体程序中的一个窗体中出现未处理的错误时，会弹出一个对话框，其中包含许多与最终用户无关且令人困惑的细节。

每当我的一个表单中出现未处理的错误时，我想用更用户友好的对话框替换该对话框（并使用选项卡式界面隐藏但提供可用的技术细节）。

有没有办法用自定义对话框替换这个默认对话框？

我的应用程序是 MDI 应用程序，因此如果表单中出现错误，我只想关闭该表单，以友好的方式显示错误并允许它们与应用程序中的其他窗口一起工作（除非它是严重错误）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:32:51.940

我想到了几种方法。最简单的一种是通过监听 Application.ThreadException 事件来捕获所有未处理的异常

```
 [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);           
        Application.ThreadException += new System.Threading.ThreadExceptionEventHandler(Application_ThreadException);
        Application.Run(new Form1());
    }

    static void Application_ThreadException(object sender, System.Threading.ThreadExceptionEventArgs e)
    {
        MessageBox.Show(e.Exception.Message);
    } 
```

然而，这只会停止崩溃而不是关闭 mdi 表单。如果您停止发送线程，它将完全停止 mdi 表单（在 mdi 之外更容易，然后表单可以在可以启动沙盒的单独线程中运行）。

我通常做的是运行所有代码沙盒。通常封装在一个动作对象中，但我可以是一个简单的过程，例如

```
 public static bool Run(Action a)
    {
        try
        {
            a();
            return true;
        }
        catch(Exception ex)
        {
            //custom error handling here
            return false;
        }
    } 
```

示例调用：

```
 private void button1_Click(object sender, EventArgs e)
    {
        Run( ()=>throw new Exception());
    } 
```

以标准方法运行具有能够将事物控制为等待光标或日志记录的额外好处。如果它不是一个 mdi 环境，会有一些替代方案，但希望这个是可行的。

# css - CSS：最后一个子元素的高度应该基于previos兄弟而不是溢出父

> ID：10852621
> 
> 赞同：7
> 
> 时间：2012-06-01T14:55:39.487
> 
> 标签：css, overflow

相关 JS Fiddle [http://jsfiddle.net/arosen/FMQtR/](http://jsfiddle.net/arosen/FMQtR/)

# 问题

我的 HTML 看起来像这样：

```
<div id='parent'>
  <div id='one'>
    A variable amount of text here.
  </div>

  <div id='two'>
    A less important variable amount of text here.
  </div>
</div> 
```

#parent div 是固定高度，不能更改。在其中，我至少有两个子 div。第一个（或许多）将在其中确定其高度的未知数量的文本。根据第一个的内容，我希望最后一个占据父级中留下的高度但不溢出。

我当前的示例 CSS 是：

```
#parent {
    border: 1px solid #000;
    height: 150px;
    width: 150px;
}
  #one, #two {
    border: 1px dashed #333;
    height: auto;
    margin: 5px;
    padding: 5px;
    overflow: hidden;
  } 
```

# 我目前的 JS 解决方案

```
function() {
  var $two = $('#two');
  var $parent = $('#two').parent()
  $parent.css('overflow', 'hidden');
  var heightDifference = $parent[0].scrollHeight - $parent.height();
  $two.css('height', $two.height() - heightDifference);
} 
```

我想知道是否有针对此问题的 CSS 布局或 HTML 解决方案，或者我是否必须使用在按下最后一个按钮时运行的小提琴中的 JS 解决方案。

**编辑**更新了我的 JS 小提琴，因为文本**不会**在页面上更改一次，但取决于从服务器加载的信息，在呈现页面之前不会知道它将有多少文本。

**编辑 2**只需要支持现代（和 IE 9）浏览器。

**编辑 3**最终的 div**必须**有一个高度，因为它被其他 jQuery 插件使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:23:21.400

不，你不能。CSS 不是一种编程语言。相反，每个`selector{ property:value; }`元组都为一组特定的元素定义了一个规则。在 CSS 中无法访问当前高度、当前宽度或其他属性等实际样式。

有人可能会想“百分比值呢”？嗯，这些是基于包含块的，它通常是父元素（在这种情况下`#parent`）。

因此，您要么必须为所有人指定一个固定高度`div`（根据您提供给我们的信息，这是不可能的），要么使用基于 JavaScript 的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:52:24.823

如果您对边框/边距/填充/行高没有过多设置，则可以完成此操作。只要确保 (parent div - (all margins/padding)) 完全可以被您的行高整除，您就不会看到部分行或溢出。但是，使用您的边框样式，您无法仅通过 CSS 来实现这一点。

您仍然可以通过向父 div 添加另一个元素来破解它，例如带有虚线顶部边框和厚白色底部边框的段落标签，用上述解决方案定位以隐藏溢出的边框......但这很hacky，我不喜欢，并且有可能在浏览器之间轻松破解。

TL;DR - 只需使用您的 JS。

# git - 搬到 gitolite 缺少一些分支

> ID：10852622
> 
> 赞同：1
> 
> 时间：2012-06-01T14:55:42.983
> 
> 标签：git, gitolite

我创建了一个新的空 gitolite 存储库，我想将原始 git 存储库的快照（在我的工作站上）推送到其中。我按照说明进行操作，`git push --all`然后`git push --tags`。这似乎工作得很好，但我发现一些分支引用没有被推送。在我的工作站上运行`git show-ref`会显示许多类似的 refs `refs/remotes/origin/branchXyz`，但`git show-ref`直接在 gitolite repo 上执行根本不会显示此分支名称（我希望看到它显示为`refs/heads/branchXyz`。如何推送剩余的分支？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:06:59.993

如果您的本地存储库本身是一个克隆（' `origin`'，另一个非 gitolite 存储库），它没有*本地*所有分支，仅引用远程 (' `origin`') 分支。

您应该[首先拉出所有分支或全部跟踪它们](https://stackoverflow.com/a/10312552/6309)：

```
$ git remote update  
$ git pull --all

# or:

remote=origin ; for brname in `git branch -r | grep $remote | grep -v master | grep -v HEAD | awk '{gsub(/[^\/]+\//,"",$1); print $1}'`; do git branch --set-upstream $brname  $remote/$brname ; done 
```

（最后一条命令[在这里详述](https://stackoverflow.com/a/6300386/6309)）

[（这两个选项在“将所有远程 git 分支跟踪为本地分支](https://stackoverflow.com/questions/379081/track-all-remote-git-branches-as-local-branches)”和“[可以“<code>git pull --all”更新我的所有本地分支吗？](https://stackoverflow.com/questions/4318161/can-git-pull-all-update-all-my-local-branches) ”或“[我如何使用 Git 克隆所有远程分支](https://stackoverflow.com/questions/67699/how-do-i-clone-all-remote-branches-with-git)”中也详细说明了这两个选项[?](https://stackoverflow.com/questions/67699/how-do-i-clone-all-remote-branches-with-git) ")

然后`push --all`到你的新（gitolite）[上游](https://stackoverflow.com/questions/2739376/definition-of-downstream-and-upstream/2749166#2749166)仓库。

# java - Facebook Graph API 请求返回 IOException“主机名 未验证”

> ID：10852624
> 
> 赞同：1
> 
> 时间：2012-06-01T14:55:45.417
> 
> 标签：java, android, facebook, facebook-graph-api, ioexception

所以我试图简单地从 facebook 获取用户的个人资料照片，但我从 facebook.request(path) 和 IOException “主机名 fbcdn-profile-a.akamaihd.net 未验证”得到空响应。

任何人都知道可能导致此异常的原因是什么？这是我调用 facebook.request 的方法：

```
public Bitmap getUserPic(String path){

    URL picURL = null;

    try {
        responsePic = facebook.request(path);
        picURL = new URL(responsePic);
        HttpURLConnection conn = (HttpURLConnection)picURL.openConnection();
        conn.setDoInput(true);
        conn.connect();
        InputStream is = conn.getInputStream();
        userPic = BitmapFactory.decodeStream(is);

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (FacebookError e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    return userPic;

} 
```

字符串“路径”是“我/图片”

编辑：

还尝试将 picURL 设置为“https://fbcdn-profile-a.akamaihd.net/hprofile-ak-snc4/260885_608260639_822979518_q.jpg”，这是请求应返回的 url。还是没有照片:(

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:13:09.570

这听起来像是用于从 Facebook CDN 获取图像的 HTTPS 连接的问题。如果您请求图像的常规 HTTP 版本会发生什么？

例如[http://fbcdn-profile-a.akamaihd.net/hprofile-ak-snc4/260885_608260639_822979518_q.jpg](http://fbcdn-profile-a.akamaihd.net/hprofile-ak-snc4/260885_608260639_822979518_q.jpg)

# java - Java：数据库检查和初始化

> ID：10852626
> 
> 赞同：0
> 
> 时间：2012-06-01T14:55:49.777
> 
> 标签：java, sql, sqlite, db-schema

我正在编写一个通过 JDBC 使用 SQLite 进行持久性的 Java 应用程序。

应用程序启动时我需要做的是：

1.  如果数据库不存在，请使用正确的架构创建它
2.  如果数据库存在，请检查数据库是否具有正确的架构

为了创建数据库，我想将在外部文件中创建结构（例如 CREATE TABLE ...）所需的 SQL 命令外部化，在运行时加载并执行它。我想过使用`BufferedReader`with`.readLine()`然后将每个 SQL 命令提供给`Statement.executeUpdate()`. 有没有更聪明的方法来做到这一点？

关于数据库模式的启动检查，虽然我认为这应该被认为是“好的设计”，但我不知道在实践中它是否可能是矫枉过正或无用。我想出的一种解决方案，但具有“依赖于供应商”的缺点是：

1.  使用所有结构名称的已知前缀创建数据库（例如`nwe_`）
2.  查询`sqlite_master`表`WHERE name LIKE 'nwe_%'`
3.  将`SQL`列的内容与我用于创建数据库的 SQL 命令文件进行比较

同样，有没有更聪明的方法来做到这一点？（也许不是“依赖于供应商”，但当时这对我来说不是什么大问题）

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-22T18:21:17.203

我不是专业程序员，这是我的第一个 java 应用程序，但我也决定进行数据库验证。幸运的是，sqlite 数据库有一个系统表，其中包含数据库中每个表的 sql 语句。所以有一种快速而肮脏的方法来检查数据库结构：

```
public class Model {
    private Map<String, String> tableSql;

    Model(){
        // declare right database's tables syntax 
        tableSql = new HashMap<String, String>();
        tableSql.put("settings",    "CREATE TABLE [settings] ( [id]     INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, [item] ... )");
        tableSql.put("scheta",      "CREATE TABLE [scheta] ( [id] INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, [sname] ...)");
        tableSql.put("nomera",      "CREATE TABLE [nomera] ( [id] INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, [nvalue] ...)");
        tableSql.put("corr",        "CREATE TABLE [corr] (  [id] INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, [cname] ...)");
        tableSql.put("category",    "CREATE TABLE [category] ( [id] INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, [cname] ...)");
        tableSql.put("price",       "CREATE TABLE [price] ( [id] INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, [cdate] ...)");
    }

    public void Connect( String path){
        File DBfile = new File (path);
        boolean DBexists = DBfile.exists();
        Statement stmt = null;
        ResultSet rs;

        try {
            Class.forName("org.sqlite.JDBC");
            c = DriverManager.getConnection("jdbc:sqlite:" + path);
            c.setAutoCommit(true);

            stmt = c.createStatement();
            if( DBexists ){
                // check database structure
                for (String tableName : tableSql.keySet()) {
                    rs = stmt.executeQuery( "SELECT sql FROM sqlite_master WHERE type = 'table' AND name = '" + tableName + "'");
                    if(rs.isBeforeFirst()){
                        rs.next();
                        // table and field names may be inside square brackets or inside quotes...
                        String table_schema_there = rs.getString(1).replaceAll("\\s+"," ").replaceAll("[\\[\\]'`]", "\"");
                        String table_schema_here = tableSql.get(tableName).replaceAll("\\s+"," ").replaceAll("[\\[\\]'`]", "\"");;
                        if( ! table_schema_there.equals(table_schema_here) ){
                            notifyListeners( new ModelResponse( false, "Structure error. Wrong structure of table "  + tableName));
                            System.exit(0);
                        }
                    }
                    else{
                        notifyListeners( new ModelResponse( false, "Structure error. The table is missing: "  + tableName ));
                        System.exit(0);
                    }
                }
            }
            else{
                // empty DB file created during connection so we need to create schema
                for (String tableName : tableSql.keySet()) {
                    stmt.executeUpdate(tableSql.get(tableName));
                }
            }
        } 
        catch ( Exception e ) {
            notifyListeners( new ModelResponse( false, e.getMessage()));
            System.exit(0);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:17:28.947

您可以通过查看元数据表来编写自己的数据库验证。这并非不可能，但需要维护大量代码。您还可以编写大量 DDL 语句来构建数据库结构，这同样不是不可能，但需要维护大量代码。

如果您遵循这样的路径，我建议使用更高级别的逻辑

```
if (!checkDatabase()) {
  try {
    if (wantsToInstall()) {
      installDatabase();
    }
  } catch (Exception e) {
    exit();
  }
} 
```

或特定的安装程序（以减少安装现有项目的机会）。可以进行提供删除数据项的扩展，但是对于在安装/升级过程中遇到意外的预先存在的对象时如何处理存在不同的意见。

现在有一些库可以为您执行此操作；但是当他们添加此功能时，这样的库可能不仅仅需要简单的*数据库*结构维护。看看 JDO 和其他一些，我知道 DataNucleus 的环境很乐意创建经过调整的数据库结构，以便在 20 多个不同的数据库中正常工作（请记住，它们在做事方式上都有细微的差异）。

# c# - 格式化包含数字/日期的字符串变量以在 C# 中打印

> ID：10852629
> 
> 赞同：1
> 
> 时间：2012-06-01T14:55:58.663
> 
> 标签：c#, string, methods, formatting, .net

也许这是一个 n00b 问题，但我已经查看了 .net/C# MSDN Library 和这个站点，但还没有得到一个明确的答案......说我有 For Ex：（这不*完全*是问题，因为我'不是创建字符串，而是从数据库中读取它们。但用于说明我正在使用的内容......）

```
string dob = "01/02/1990";
dob.ToString("MM/dd/YY"); //however, I can't do this. compiler gives me an error... 
```

可能是因为它已经是一个字符串？那么，当它已经是一个字符串时，我如何才能使用说明符将字符串转换为我想要的格式？我知道我可以将它转换为其他东西（Ex 的 DateTime）并使用 ToString() 转换回字符串……但这似乎适得其反……至少对我来说

我还有其他几种“类型”的字符串变量，我试图将它们显示为特定格式，同时将它们保存到字典中以打印到 pdf 的字段中。例如：

```
d["amount"] = prod.sales.StringAmount; //(here StringSmount holds say 50000 (gotten from a DB), which I want to display as "50,000") 
```

但是，我也不能做 prod.sales.StringAmount.ToString("N", CultureInfo.CurrentUICulture); 因为它已经是一个字符串！是否有捷径可寻

还是需要我弄乱字符串缓冲区或 StringBuilder 类？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:05:51.037

你可以这样做：

```
DateTime dob = DateTime.Parse("01/02/1990"); 
```

接着

```
dob.ToString("MM/dd/YY"); 
```

将工作。

请注意，`DateTime.Parse()`对于可能接受的日期时间格式有各种选项，并且如果字符串不是有效日期，还有一个`TryParse()`版本返回`false`- 而不是抛出异常。也有`DateTime.ParseExact()`和`DateTime.TryParseExact()`变化。

对日期时间以外的其他数据类型使用相同的方法：首先将输入字符串转换为正确的数据类型（整数、浮点数等） - 使用各种`Parse()`or`TryParse()`方法，然后格式化此转换的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:04:43.283

使用上面提供的格式，您需要转换回 DateTime 以使用 .ToString("MM/dd/YY") 格式。ToString 用于将对象/值转换为字符串表示形式的原因，并且 DateTime 对象足以接受格式。

如果您想格式化已经是字符串的内容，那么您应该使用 String.Format。访问此链接：http: [//msdn.microsoft.com/en-us/library/dwhawy9k.aspx](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)。此链接显示标准数字格式化程序。

您可能还想创建自己的字符串格式。查看 IFormatProvider 和 ICustomFormatter：http: [//msdn.microsoft.com/en-us/library/system.icustomformatter.aspx](http://msdn.microsoft.com/en-us/library/system.icustomformatter.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:00:54.597

ToString 返回一个值而不修改原始值。

代替

```
dob.ToString("MM/dd/YY"); 
```

利用

```
dob = dob.ToString("MM/dd/YY"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T15:01:39.010

首先将字符串解析为一个`DateTime`实例（通过`Parse()`or`TryParse()`方法）。`DateTime`然后，您可以在实例上调用`ToString`(..)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T15:00:16.280

我建议首先将其解析为数字/日期时间，然后使用字符串格式化变量。例如，为什么这可能是必要的，请考虑您的“01/02/1990”字符串在 1 月 2 日到 2 月 1 日之间是不明确的，除非您使用`DateTime.ParseExact`.

我会推荐这个而不是'滚动你自己的'（例如使用StringBuilder），这样你就可以使用.NET 的内置文化敏感字符串格式化功能。

# ruby-on-rails - 如何将 Heroku PG 转储导入本地机器

> ID：10852631
> 
> 赞同：28
> 
> 时间：2012-06-01T14:56:12.810
> 
> 标签：ruby-on-rails, postgresql

我正在尝试将我的生产 Heroku 数据库导入我的开发机器。

我的本地数据库是 PostgreSQL。

首先，我将转储从 Heroku 导出到我的机器

```
curl -o latest.dump `heroku pgbackups:url` 
```

然后，我尝试删除本地数据库，`rake db:drop`然后使用`rake db:create`.

我遇到的问题是实际尝试将转储导入数据库时

```
psql -d app_development -U myusername -f mydumpfile.sql 
```

我开始看到这样的错误

```
psql:latest.dump:24: ERROR:  syntax error at or near "PGDMP"
LINE 1: PGDMP
        ^
psql:latest.dump:28: ERROR:  syntax error at or near ""
LINE 1:     INCREMENT BY 1
        ^
psql:latest.dump:36: ERROR:  syntax error at or near ""
LINE 1:     id integer NOT NULL,
        ^
psql:latest.dump:40: ERROR:  syntax error at or near ""
LINE 1:     INCREMENT BY 1
        ^
psql:latest.dump:45: ERROR:  syntax error at or near ""
LINE 1:     id integer NOT NULL,
        ^
psql:latest.dump:49: ERROR:  syntax error at or near ""
LINE 1:     INCREMENT BY 1

... 

psql:latest.dump:1601: invalid command \S4???(?̭?A?|c?e0<00K?A?}FϚ?????A(??~?t?I?????G(?    K???l??k"?H?ȁ?ͲS?,N*?[(@??a5J??j}
psql:latest.dump:1602: invalid command \??k???|??w???h?
psql:latest.dump:1603: invalid command \=??????o?h?
psql:latest.dump:1609: invalid command \????^.?????????E???/-???+??>#?ؚE?.2)Ȯ&????    g????"7},_??]?:?f?Tr|o???)?p????h?KO?08[Rqu???|3?cW?ڮ?ahbm??H?H8??$???2?a?-أ
psql:latest.dump:1613: invalid command \D!qVS???L??*??׬R??I!???
psql:latest.dump:1614: invalid command \??-?}Q
psql:latest.dump:12565: ERROR:  invalid byte sequence for encoding "UTF8": 0xb0 
```

知道发生了什么以及如何解决它吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-07-09T08:37:28.063

您会看到错误，因为当您实际给他一个[压缩转储](https://devcenter.heroku.com/articles/pgbackups#importing_from_a_backup)（这就是 heroku 使用的）时，psql 会尝试解释 SQL 查询。

虽然您无法读取转储，`pg_restore -O latest.dump`但为您提供了可以通过管道传输到 psql 的有效 SQL，但简单的解决方案如下：

```
pg_restore -O -d app_development latest.dump 
```

备注：

*   使用`-O`是因为您可能不使用远程 heroku postgres 数据库的随机用户名。
*   Heroku[不建议使用水龙头](https://devcenter.heroku.com/articles/taps)，但我不知道它的风险有多大。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2014-03-19T02:58:00.543

# 
在您的终端（[Heroku 开发中心](https://devcenter.heroku.com/articles/heroku-postgres-import-export)）中执行以下 4 个简单步骤：

1.  创建数据库的备份副本：

    ```
    $ heroku pg:backups capture DATABASE_NAME 
    ```

2.  使用 curl 从 Heroku 下载副本（到您的本地计算机）：

    ```
    $ curl -o latest.dump `heroku pg:backups public-url` 
    ```

3.  加载它*：

    ```
    $ pg_restore --verbose --clean --no-acl --no-owner -h localhost -U YOUR_USERNAME -d DATABASE_NAME latest.dump 
    ```

    *   `config/database.yml`获取 YOUR_USERNAME 并从您的文件中选择所需的数据库。
    *   DATABASE_NAME 可以是您的开发/测试/生产数据库（例如 mydb_development）

**而已！**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-01T15:33:10.003

使用[Taps](http://rubydoc.info/gems/taps/0.3.24/frames) gem。它允许您运行一个简单`heroku db:pull`的来填充本地数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-10T07:01:05.677

Heroku 导出数据库的**.dump**扩展文件，以通过具有自己的规范和条件导入到任何关系数据库中。将其导入本地 postgres 数据库时，首先将文件**latest.dump**下载到本地计算机中，然后运行

```
pg_restore -h localhost -p 5432 -U postgres_username -d db_name -v latest.dump 
```

并重新启动 rails 服务器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-05T10:44:06.563

2021 年末更新迄今为止投票最高的答案（效果很好）：

$ rails db:drop db:create db:migrate

$ heroku pg:backups 捕获 DATABASE_URL

$ curl -o 最新的.dump`heroku pg:backups public-url`

$ pg_restore --verbose --clean --no-acl --no-owner -h localhost -U YOUR_USERNAME -d DATABASE_NAME latest.dump

*   在本地机器上获取 YOUR_USERNAME

*   DATABASE_NAME 可以是 config/database.yml 文件中的开发/测试/生产数据库（例如 rails_react_bootstrap_development）。

*   DATABASE_URL 不是您需要设置的变量或示例代码。这是一个有效的heroku选项

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-01T05:32:17.400

我想避免在我的本地机器上设置 Postgres（如果您只是在寻找快速说明，那么吹走并重新创建数据库会很痛苦）。我整理了一些使用运行 Docker 的本地 Postgres 数据库执行此操作的确切说明。我在这里添加了一个链接，因为谷歌一直把我带到这个问题（这是一个可能的解决方案，虽然可能不是你想要的）： [https ://gist.github.com/locofocos/badd43131f14b3e40c760741d5a26471](https://gist.github.com/locofocos/badd43131f14b3e40c760741d5a26471)

# asp.net - Asp.net mvc3：如何将用户名信息放入 Layour=t 文件中

> ID：10852633
> 
> 赞同：0
> 
> 时间：2012-06-01T14:56:17.907
> 
> 标签：asp.net, .net, asp.net-mvc-3

我正在寻找在布局文件的标题中显示当前用户名。实现这一目标的最佳方法是什么？我目前没有将任何模型传递到布局文件中。另外，如果没有人登录，我不想明显显示用户名

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:10:40.620

它`_LogOnPartial.cshtml`在默认模板的视图上！

```
@if(Request.IsAuthenticated) {
    <text>Welcome <b>@Context.User.Identity.Name</b>!
    [ @Html.ActionLink("Log Off", "LogOff", "Account") ]</text>
}
else {
    @:[ @Html.ActionLink("Log On", "LogOn", "Account") ]
} 
```

# c# - 在 C# DllImport 中使用 32 位或 64 位 dll

> ID：10852634
> 
> 赞同：71
> 
> 时间：2012-06-01T14:56:22.000
> 
> 标签：c#, .net, pinvoke, 32bit-64bit, dllimport

这是情况，我在我的 dot.net 应用程序中使用基于 C 的 dll。有 2 个 dll，一个是 32 位的，称为 MyDll32.dll，另一个是 64 位的版本，称为 MyDll64.dll。

有一个静态变量保存 DLL 文件名：字符串 DLL_FILE_NAME。

它的使用方式如下：

```
[DllImport(DLL_FILE_NAME, CallingConvention=CallingConvention.Cdecl, EntryPoint=Func1")]
private static extern int is_Func1(int var1, int var2); 
```

到目前为止很简单。

可以想象，软件是在“Any CPU”开启的情况下编译的。

我也有以下代码来确定系统应该使用 64 位文件还是 32 位文件。

```
#if WIN64
        public const string DLL_FILE_NAME = "MyDll64.dll";
#else
        public const string DLL_FILE_NAME = "MyDll32.dll";        
#endif 
```

现在您应该看到问题了。DLL_FILE_NAME 是在编译时定义的，而不是在执行时定义的，因此不会根据执行上下文加载正确的 dll。

处理这个问题的正确方法是什么？我不想要两个执行文件（一个用于 32 位，另一个用于 64 位）？如何在 DllImport 语句中使用DLL_FILE_NAME*之前设置它？*

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-06-01T15:08:28.610

我发现最简单的方法是导入具有不同名称的两种方法，然后调用正确的方法。在调用之前不会加载 DLL，所以没关系：

```
[DllImport("MyDll32.dll", EntryPoint = "Func1", CallingConvention = CallingConvention.Cdecl)]
private static extern int Func1_32(int var1, int var2);

[DllImport("MyDll64.dll", EntryPoint = "Func1", CallingConvention = CallingConvention.Cdecl)]
private static extern int Func1_64(int var1, int var2);

public static int Func1(int var1, int var2) {
    return IntPtr.Size == 8 /* 64bit */ ? Func1_64(var1, var2) : Func1_32(var1, var2);
} 
```

当然，如果你有很多导入，手动维护会变得相当麻烦。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2015-06-04T14:07:31.040

这是另一种选择，它要求两个 DLL 具有**相同的名称**并放置在不同的文件夹中。例如：

*   `win32/MyDll.dll`
*   `win64/MyDll.dll`

`LoadLibrary`诀窍是在 CLR 执行之前手动加载 DLL 。然后它会看到 a`MyDll.dll`已经加载并使用它。

这可以在父类的静态构造函数中轻松完成。

```
static class MyDll
{
    static MyDll()
    {            
        var myPath = new Uri(typeof(MyDll).Assembly.CodeBase).LocalPath;
        var myFolder = Path.GetDirectoryName(myPath);

        var is64 = IntPtr.Size == 8;
        var subfolder = is64 ? "\\win64\\" : "\\win32\\";

        LoadLibrary(myFolder + subfolder + "MyDll.dll");
    }

    [DllImport("kernel32.dll")]
    private static extern IntPtr LoadLibrary(string dllToLoad);

    [DllImport("MyDll.dll")]
    public static extern int MyFunction(int var1, int var2);
} 
```

**编辑 2017/02/01**：`Assembly.CodeBase`即使启用了[影子复制](https://msdn.microsoft.com/en-us/library/ms404279.aspx)，也可以使用它。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-06-29T12:24:33.870

在这种情况下，我应该这样做（制作 2 个文件夹，x64 和 x86 + 将相应的 dll 同名放在两个文件夹中）：

```
using System;
using System.Runtime.InteropServices;
using System.Reflection;
using System.IO;

class Program {
    static void Main(string[] args) {
        var path = Path.GetDirectoryName(Assembly.GetEntryAssembly().Location);
        path = Path.Combine(path, IntPtr.Size == 8 ? "x64" : "x86");
        bool ok = SetDllDirectory(path);
        if (!ok) throw new System.ComponentModel.Win32Exception();
    }
    [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern bool SetDllDirectory(string path);
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-06-01T15:02:04.260

> 有一个静态变量保存 DLL 文件名

它不是静态变量。这是一个常数，在编译时。您不能在运行时更改编译时间常数。

> 处理这个问题的正确方法是什么？

老实说，我建议只针对 x86 而忘记 64 位版本，让您的应用程序在 WOW64 上运行，除非您的应用程序迫切需要以 x64 运行。

如果需要 x64，您可以：

*   将 DLL 更改为具有相同名称，例如`MyDll.dll`，并在安装/部署时，将正确的名称放在适当的位置。（如果操作系统是 x64，部署 DLL 的 64 位版本，否则部署 x86 版本）。

*   总共有两个单独的构建，一个用于 x86，一个用于 x64。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-01T15:03:56.420

您所描述的内容被称为“并行程序集”（同一程序集的两个版本，一个是 32 位，另一个是 64 位）...我认为您会发现这些很有帮助：

*   [使用 Side-by-Side 程序集加载 x64 或 x32 版本的 DLL](https://stackoverflow.com/questions/108971/using-side-by-side-assemblies-to-load-the-x64-or-x32-version-of-a-dll/156024#156024)
*   [http://blogs.msdn.com/b/gauravseth/archive/2006/03/07/545104.aspx](http://blogs.msdn.com/b/gauravseth/archive/2006/03/07/545104.aspx)
*   [http://www.thescarms.com/dotnet/Assembly.aspx](http://www.thescarms.com/dotnet/Assembly.aspx)

[在这里](http://scottbilas.com/blog/automatically-choose-32-or-64-bit-mixed-mode-dlls/)，您可以找到适合您的方案的演练（.NET DLL 包装 C++/CLI DLL 引用本机 DLL）。

推荐：

只需将其构建为 x86 并完成它......或者有 2 个构建（一个 x86 和一个 x64）......因为上述技术相当复杂......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-07-01T14:20:55.730

另一种方法可能是

```
public static class Sample
{
    public Sample()
    {

        string StartupDirEndingWithSlash = System.IO.Path.GetDirectoryName(System.Diagnostics.Process.GetCurrentProcess().MainModule.FileName) + "\\";
        string ResolvedDomainTimeFileName = StartupDirEndingWithSlash + "ABCLib_Resolved.dll";
        if (!File.Exists(ResolvedDomainTimeFileName))
        {
            if (Environment.Is64BitProcess)
            {
                if (File.Exists(StartupDirEndingWithSlash + "ABCLib_64.dll"))
                    File.Copy(StartupDirEndingWithSlash + "ABCLib_64.dll", ResolvedDomainTimeFileName);
            }
            else
            {
                if (File.Exists(StartupDirEndingWithSlash + "ABCLib_32.dll"))
                    File.Copy(StartupDirEndingWithSlash + "ABCLib_32.dll", ResolvedDomainTimeFileName);
            }
        }
    }

    [DllImport("ABCLib__Resolved.dll")]
    private static extern bool SomeFunctionName(ref int FT);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-03T10:12:32.610

我使用了 vcsjones 所指的一种方法：

> “将 DLL 更改为具有相同名称，例如 MyDll.dll，并在安装/部署时，将正确的名称放在适当的位置。”

这种方法需要维护两个构建平台，但请参阅此链接了解更多详细信息：[https ://stackoverflow.com/a/6446638/38368](https://stackoverflow.com/a/6446638/38368)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-03-04T21:08:17.860

我用于[V8.Net](https://github.com/rjamesnw/v8dotnet)的技巧是这样的：

1.  使用所有定义创建一个新的 C#“代理接口”项目，以在不同的体系结构之间切换。在我的情况下，该项目被命名为`V8.Net-ProxyInterface`；例子：

```
 public unsafe static class V8NetProxy
    {
    #if x86
            [DllImport("V8_Net_Proxy_x86")]
    #elif x64
            [DllImport("V8_Net_Proxy_x64")]
    #else
            [DllImport("V8_Net_Proxy")] // (dummy - NOT USED!)
    #endif
            public static extern NativeV8EngineProxy* CreateV8EngineProxy(bool enableDebugging, void* debugMessageDispatcher, int debugPort); 
```

这是您将参考的项目。不要参考接下来的两个：

2.  再创建两个项目以生成库的 x64 和 x86 版本。这很简单：只需复制粘贴即可将`.csproj`文件复制到同一文件夹中并重命名它们。在我的情况下，项目文件被重命名为`V8.Net-ProxyInterface-x64`and `V8.Net-ProxyInterface-x86`，然后我将项目添加到我的解决方案中。在 Visual Studio 中打开每个项目的项目设置，并确保`Assembly Name`名称中包含 x64 或 x86。此时您有 3 个项目：第一个“占位符”项目和 2 个特定于架构的项目。对于 2 个新项目：

    a) 打开 x64 接口项目设置，进入选项卡，在顶部`Build`选择`All Platforms`for ，然后输入.`Platform``x64``Conditional compilation symbols`

    b) 打开 x86 接口项目设置，进入选项卡，在顶部`Build`选择`All Platforms`for ，然后输入.`Platform``x86``Conditional compilation symbols`

3.  打开`Build->Configuration Manager...`并确保它`x64`被选为 x64 项目的平台，并被`x86`选为 x86 项目的 BOTH `Debug`AND`Release`配置。

4.  确保 2 个新的接口项目（用于 x64 和 x86）输出到宿主项目的相同位置（参见项目设置`Build->Output path`）。

5.  最后的魔法：在我的引擎的静态构造函数中，我快速附加到程序集解析器：

```
static V8Engine()
{
    AppDomain.CurrentDomain.AssemblyResolve += Resolver;
} 
```

在该`Resolver`方法中，我只是根据当前进程指示的当前平台加载文件（注意：此代码是精简版，未经测试）：

```
var currentExecPath = Assembly.GetExecutingAssembly().Location;
var platform = Environment.Is64BitProcess ? "x64" : "x86";
var filename = "V8.Net.Proxy.Interface." + platform + ".dll"
return Assembly.LoadFrom(Path.Combine(currentExecPath , fileName)); 
```

最后，在解决方案资源管理器中转到您的宿主项目，展开`References`，选择您在步骤 1 中创建的第一个虚拟项目，右键单击它以打开属性，然后设置`Copy Local`为`false`. 这允许您为每个 P/Invoke 函数使用一个名称进行开发，同时使用解析器来确定实际加载哪个名称。

请注意，程序集加载器仅在需要时运行。它仅在第一次访问引擎类时由 CLR 系统自动触发（在我的情况下）。这如何转化为您取决于您​​的宿主项目的设计方式。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2020-06-18T05:57:43.437

我认为这有助于动态加载 DLL：

```
 #if X64    
    [DllImport("MyDll64.dll", CallingConvention=CallingConvention.Cdecl, EntryPoint=Func1")]
    #else
    [DllImport("MyDll32.dll", CallingConvention=CallingConvention.Cdecl, EntryPoint=Func1")]
    #endif
    private static extern int is_Func1(int var1, int var2); 
```

# c++ - 如何在 linux 中分析 pthread 互斥锁？

> ID：10852637
> 
> 赞同：21
> 
> 时间：2012-06-01T14:56:30.800
> 
> 标签：c++, c, performance, pthreads, mutex

我想知道如何分析 pthread 互斥锁以查看我的代码中是否存在任何锁定争用点。（谁喜欢有争议的代码，对吧？:) 我知道如何对代码进行更一般的分析，正如我[在这里](https://stackoverflow.com/a/10800412/1158895)提到的。但是我想知道是否有任何工具或选项可以用来分析互斥锁，这些工具或选项可以提供有关互斥锁争用的指标/统计信息，以查看我是否有任何问题区域。

以下是一些背景和背景：

最近我在一个使用 Cavium Octeon CPU 的嵌入式 C++ 项目上工作。Octeon SDK 使用自旋锁实现互斥锁样式同步。通过查看 Octeon 文档，我发现了一种分析自旋锁的方法，以便能够查看每个自旋锁在等待锁可用时必须旋转多少次。要使用它，我必须进行条件编译，然后每次自旋锁旋转时都会增加一个计数器，然后我可以查询微调器等待值。因此，我所做的是封装自旋锁，并添加了为系统中使用的所有自旋锁转储自旋锁微调器等待值的能力。实际价值并没有多大意义，但与其他价值相比，有一些价值非常高，我专注于减少对它们的争用。

我知道这对于自旋锁来说可能很容易，因为它只是每次自旋的一个计数器，但是阅读相关的 pthread 手册页和头文件我没有发现任何类似的东西，是否有可用于 pthread 互斥锁的东西？

我真的很想避免做一些不合时宜的事情，比如在每次锁定之前和之后花时间。

PS：互斥量的复数形式是什么？互斥体，互斥体，互斥体，互斥体？？？互斥体对我来说听起来从来都不是正确的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-01T15:29:22.897

`valgrind`工具[drd](http://valgrind.org/docs/manual/drd-manual.html)允许您指定在报告错误之前应等待锁定的时间限制 。

这个[网站](http://0pointer.de/blog/projects/mutrace.html)提到`drd`并且还提到了他们自己的工具`mutrace`，它看起来像你所追求的那种工具。它告诉你：

*   互斥锁被锁定多少次
*   拥有互斥锁的线程改变了多少次
*   互斥锁被争用了多少次（在发出锁定请求时已被锁定）
*   互斥锁锁定持续时间的各种统计信息

例如

```
mutrace: 10 most contended mutexes:

 Mutex #   Locked  Changed    Cont. tot.Time[ms] avg.Time[ms] max.Time[ms]       Type
      35   368268      407      275      120,822        0,000        0,894     normal
       5   234645      100       21       86,855        0,000        0,494     normal
      26   177324       47        4       98,610        0,001        0,150     normal
      19    55758       53        2       23,931        0,000        0,092     normal
      53      106       73        1        0,769        0,007        0,160     normal
      25    15156       70        1        6,633        0,000        0,019     normal
       4      973       10        1        4,376        0,004        0,174     normal
      75       68       62        0        0,038        0,001        0,004     normal
       9     1663       52        0        1,068        0,001        0,412     normal
       3   136553       41        0       61,408        0,000        0,281     normal
     ...      ...      ...      ...          ...          ...          ...        ...

mutrace: Total runtime 9678,142 ms. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T15:21:12.947

你没有提到你的操作系统。如果是 linux，我在这种分析中使用了很多[LTT 。](http://lttng.org/)它在两种模式下很有用：

1.  性能分析——例如，对您的系统进行 N 秒的标准使用分析，然后分析数据

2.  异常分析——例如，在“飞行记录器”模式下全天候运行它（记录最后 N 秒的活动），并在某些异常情况下触发飞行记录器的停止。第二天早上过来分析数据。

多年来，我一直在使用并看到“互斥体”作为互斥体的复数形式，没有任何抱怨。;>

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-14T07:15:21.603

我在探索相同的用例时发现了[“mutrace” 。](http://0pointer.de/blog/projects/mutrace.html)我还没有使用它。听起来不错，因为它不会像在 valgrind 中那样影响运行时。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-05T10:53:37.370

您可能还想尝试一下 Intel VTune。它也会报告每个带有调用堆栈的同步原语的等待时间和等待计数。查看此文档以查看这是否是您要查找的内容[http://software.intel.com/sites/products/documentation/hpc/amplifierxe/en-us/2011Update/lin/start/analyzing_locks_linux.pdf](http://software.intel.com/sites/products/documentation/hpc/amplifierxe/en-us/2011Update/lin/start/analyzing_locks_linux.pdf)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-04T06:33:41.387

它已经 6 年多了，但作为参考，我想添加另一个链接用于 CPU 外时间跟踪，它应该显示您的互斥体争用。 [http://www.brendangregg.com/offcpuanalysis.html](http://www.brendangregg.com/offcpuanalysis.html)

# puppet - 木偶如何运行目录中的所有清单

> ID：10852639
> 
> 赞同：2
> 
> 时间：2012-06-01T14:56:39.440
> 
> 标签：puppet

所以我有一个要运行的 puppet manifest 目录。

是否可以执行以下操作：包括 /etc/puppet/users/server522/*.pp 并让 puppet 运行它们？

我试过包括 users::server522::* 和其他几个变体

我总是收到关于 puppet 找不到它的错误。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T20:28:32.260

所以我对此的最终解决方案是编写一个脚本，该脚本将获取目录列表，并为每个 .pp 文件添加一个包含到 server522.pp 文件中。puppet 不会包含整个目录，这很烦人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T03:18:15.690

你想在这里做什么，你确定你这样做是正确的吗？也就是说，如果您有多个清单对应于多个服务器，则需要为每个服务器定义节点。如果 OTOH 您尝试将多个清单应用于单个节点，则不清楚您为什么要这样做，而不仅仅是使用您定义的类。更多信息在这里会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:13:46.403

我没有看到每个用户都有自己的清单的意义。我宁愿创建一个脚本来自动构建一个清单文件，该文件基于来自某个源的数据，例如来自 git 存储库的 HEAD，其中包含具有当前用户列表的 CSV 文件。

如果您真的想为每个用户使用单独的清单文件，您可以考虑为每个用户使用单独的模块：

```
manifests
  default.pp <-- here comes default manifest
  module_for_user_foo/
    manifests/
      init.pp <-- here comes your 'foo' user
  module_for_user_bar/
    manifests/
      init.pp <-- here comes your 'bar' user 
```

现在您可以复制包含清单的模块。

# database - 用于业务路由工作流的最佳数据库

> ID：10852640
> 
> 赞同：1
> 
> 时间：2012-06-01T14:56:45.573
> 
> 标签：database, forms, ms-access

我正在寻找为 CAPA（纠正措施/预防措施表格）创建一个数据库。基本上，一个人创建初始报告。这将转发给 CAPA 经理，后者填写表格上的另一个字段。然后它交给调查员，调查员填写一些信息。然后它返回到 CAPA 经理等等。

我的直觉是创建一个带有 SQL Server 后端的 Access 前端。我需要在流程的每一步都发送一封电子邮件。如果它在任何阶段过时 X 天，我还需要发送提醒电子邮件。

我知道我真的可以使用大多数数据库来实现这一点，但我的主要问题是，是否有任何数据库或第三方产品可以使设置路由工作流的过程更容易？我还有其他项目，其中路由类似于上述项目或审批工作流程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:43:03.110

根据您的描述，绝对有可能使用建议的技术来实施这个项目。

如果您的公司已经采用了 SharePoint 2010，那么它也是实施协作工作流的不错选择。

同样根据我的经验，如果与服务器的连接像 Intranet 一样稳定，则 MS Access 效果最好。

# android - 带有样式文本的 Android 布局性能

> ID：10852643
> 
> 赞同：0
> 
> 时间：2012-06-01T14:57:04.207
> 
> 标签：android, performance, android-layout

当谈到 Android 中的布局性能时，我在决定走哪条路线时遇到问题。我有一个相当大的布局，需要使用来自 API 的文本进行填充。现在的问题是字幕必须是**粗体**。为了简化它看起来像这样。

**标题 1：** Lorem ipsum...
**标题 2：** Lorem ipsum...
**标题 3：** Lorem ipsum ...
等等。

正如我所看到的，我有两个选择。要么我去2个视图来完成这个，比如

```
 <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Caption 1"
                android:textStyle="bold" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Lorem ipsum..." />

         </LinearLayout> 
```

或者我选择一个 TextView 并使用

```
Html.fromHtml("<b>Caption 1</b> Lorem ipsum") 
```

我想知道有人对这两种方法的性能有任何数字。考虑到我必须展示的大视图，很高兴知道。感觉选项 2 更好，但我没有任何证据，我也没有时间测试它们。

干杯!

编辑：我忘了提到我对 API 也有一些控制权，所以我可以在 API 中嵌入 HTML 并以以下形式发回字符串

```
"<b>Caption</b> Lorem ipsum...". 
```

从最初的两个答案来看，第一种方法是不可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:06:02.757

如果您真的在寻找更快的性能，我建议您使用`SpannableStringBuilder`而不是`Html.fromHtml`.

Html.fromHtml 实际上`SpannableStringBuilder`在它的实现中使用，但是鉴于 fromHtml 也需要时间来实际解析您的 html 字符串（并添加到您需要在 html 标签中包装文本的时间）它的执行速度会比`SpannableStringBuilder`

并且这些变体中的任何一个都将比从 xml 填充和维护视图更快

PS我什至有一篇小文章`SpannableStringBuilder`让你开始：http: [//illusionsandroid.blogspot.com/2011/05/modifying-coloring-scaling-part-of-text.html](http://illusionsandroid.blogspot.com/2011/05/modifying-coloring-scaling-part-of-text.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:15:22.987

我 <3 正则表达式，所以我喜欢这样的方法：

```
String myCaption = "Caption 1: Lorem Ipsum...";
TextView tv = (TextView)findViewById(R.id.mytextview);

//Set a Regex pattern to find instances of "Caption X:" 
//where X is any integer.
Pattern pattern = Pattern.compile("Caption [0-9]+:");

//Get a matcher for the caption string and find the first instance
Matcher matcher = pattern.matcher(myCaption);
matcher.find();

//These are the start and ending indexes of the discovered pattern
int startIndex = matcher.start();
int endIndex = matcher.end();

//Sets a BOLD span on the
Spannable textSpan = new Spannable(myCaption);
textSpan.setSpan(new StyleSpan(Typeface.BOLD), 
    startIndex, endIndex, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);

//Set this Spannable as the TextView text
tv.setText(textSpan); 
```

我没有对此进行测试，但即使这不起作用，因为它是逐字记录的，这个想法应该会让你继续前进。基本上，使用正则表达式查找字符串的“Caption X:”部分，获取开始和结束索引，并在该特定文本部分设置粗体跨度。

# c# - 通过数据绑定更改列表框项的背景颜色属性

> ID：10852644
> 
> 赞同：0
> 
> 时间：2012-06-01T14:57:19.083
> 
> 标签：c#, silverlight, windows-phone-7, xaml

我正在尝试制作 ListBox 根据一些变化的数据更新其内容。XAML 如下

```
StackPanel Orientation="Vertical">
<ListBox  x:Name="listWatch"  >
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Grid ShowGridLines="True">
                <Grid Grid.Column="0" Background="{Binding Path=Color">
                    <TextBlock  Text="{ Binding Path=LTP}"  Padding="2 2 2 2"/>
                </Grid>
            </Grid>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox>
<Button x:Name="btn"  Click="btn_Click" Content="Button" /> 
```

我用于表单数据结构的类如下

```
 public class WatchRow : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;
    string _color;
    decimal _lTP;

    public WatchRow(decimal LTP,string color)
    {         
        this.LTP = LTP;          
        this.Color = color;
    }
    public string Color 
    {
        get { return _color; }
        set{
            _color = value;
            OnPropertyChanged(_color);
        }
    }       
    public decimal LTP
    {
        get { return _lTP; }
        set
        {
            _lTP = value;
            OnPropertyChanged(_lTP.ToString());
        }
    }  
    protected void OnPropertyChanged(string info)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(info));
        }
    }
}

 public class Watch:ObservableCollection<WatchRow>
    {
        public Watch():base()
        {
        }       
    } 
```

文件后面的代码就像

```
 Watch watch = new Watch();
private void PhoneApplicationPage_Loaded_1(object sender, RoutedEventArgs e)
{
    watch.Add(new WatchRow(132, "black"));
    watch.Add(new WatchRow(123, "red"));
    listWatch.ItemsSource = watch;  
watch[0].Color = "green";
}

private void btn_Click(object sender, RoutedEventArgs e)
{

    watch[0].Color = "green";
} 
```

我的问题是我无法通过在 btn_Click 中设置颜色属性（**watch[0].Color = "green";**）来更改列表框项的颜色，如代码所示。但是相同的代码在PhoneApplicationPage_Loaded_1 中有效。我不知道我错了什么。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:20:59.420

我相信问题是您使用 PropertyChanged 的​​方式略有改变。当您调用 OnPropertyChanged 时，传递您正在更改的属性的名称，而不是值。例如：

```
public string Color 
    {
        get { return _color; }
        set{
            _color = value;
            OnPropertyChanged(_color);
        }
    } 
```

应该：

```
public string Color 
    {
        get { return _color; }
        set{
            _color = value;
            OnPropertyChanged("Color");
        }
    } 
```

另外，我不确定这是否一定是一个问题，但这就是我一直创建 OnPropertyChanged 函数的方式：

代替：

```
protected void OnPropertyChanged(string info)
{
    PropertyChangedEventHandler handler = PropertyChanged;
    if (handler != null)
    {
        handler(this, new PropertyChangedEventArgs(info));
    }
} 
```

尝试：

```
private void OnPropertyChanged(String info)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(info));
            }
        } 
```

此外，正如 Magnus Johansson 所提到的，定义画笔并绑定颜色，而不是字符串。所以 Color 属性将是（有关此内容的更多详细信息，请参阅他的解释）：

```
private Color _color;
public Color Color 
        {
            get { return _color; }
            set{
                _color = value;
                OnPropertyChanged("Color");
            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:44:01.123

使用 Mvvm 你可以解决你的问题：我已经测试了这段代码并且它可以工作。您需要将代码拆分为三个单独的文件，如下所示：

**视图模型**

```
public class WatchViewModel
{
    public ObservableCollection<WatchRow> WatchRows { get; set; }

    public void GetWatchRows()
    {
        WatchRows= new ObservableCollection<WatchRow>();
    }

    public void AddWatchRow(int value, string color)
    {
        var item=new WatchRow(value, color);
        WatchRows.Add(item);
    }
} 
```

**该模型**

```
public class WatchRow : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;
    string _color;
    decimal _lTP;

    public WatchRow(decimal LTP, string color)
    {
        this.LTP = LTP;
        this.Color = color;
    }
    public string Color
    {
        get { return _color; }
        set
        {
            _color = value;
            OnPropertyChanged(_color);
        }
    }
    public decimal LTP
    {
        get { return _lTP; }
        set
        {
            _lTP = value;
            OnPropertyChanged(_lTP.ToString());
        }
    }
    protected void OnPropertyChanged(string info)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(info));
        }
    }
} 
```

**和视图（您的 xaml 页面背后的代码）**

```
public partial class MainPage : PhoneApplicationPage
{
    private WatchViewModel watch;

    public MainPage()
    {
        InitializeComponent();

         watch = new WatchViewModel();
        watch.GetWatchRows();

        watch.AddWatchRow(132, "green");
        watch.AddWatchRow(123, "red");
        base.DataContext = watch;
        listWatch.ItemsSource = watch.WatchRows;

    }

    private void btn_Click(object sender, RoutedEventArgs e)
    {
        watch.AddWatchRow(132, "pink");
        watch.AddWatchRow(113, "yellow");

    }
} 
```

# asp.net - 有没有办法为 Razor 文本框传递一个值？

> ID：10852645
> 
> 赞同：0
> 
> 时间：2012-06-01T14:57:19.513
> 
> 标签：asp.net, razor, asp.net-mvc

这似乎是一个简单的问题，但我找不到一个很好的 Razor 资源来解释如何做到这一点。

我有一个带有值的简单文本框。让我们说

```
<input id="firstname" name="firstname" type="text" value="RE" /> 
```

如何在 Razor 中使用默认值创建像这样的文本框？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:01:48.820

你可以看看这个 SO 帖子：[have razor text box default value dismiss](https://stackoverflow.com/questions/8433234/have-razor-text-box-default-value-disappear)。在那里，海报提供了他/她如何为文本框提供值的一瞥。

另一个链接：[Razor 语法中的文本框默认值](https://stackoverflow.com/questions/6668018/text-box-default-value-in-razor-syntax)。

为您不查找此内容而感到羞耻：D

# emacs - Pastie.el 中的 500 内部服务器错误

> ID：10852647
> 
> 赞同：1
> 
> 时间：2012-06-01T14:57:20.993
> 
> 标签：emacs, elisp, pastie

我正在使用位于[http://www.emacswiki.org/emacs/download/pastie.el](http://www.emacswiki.org/emacs/download/pastie.el)的 paste.el 文件。这应该可以帮助我们直接从 emacs 将代码发布到 paste.org。如果我粘贴的文件包含“<”符号，那么我在 emacs 中收到 500 内部服务器错误消息，因为我无法发布 ruby​​ 文件、php 文件等。有什么方法可以在 elisp 文件中解决这个问题？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:50:54.027

位于 emacswiki.org 的 paste.el 中的 xml 转义存在问题。[我在https://bitbucket.org/sid0/.emacs/raw/837539ad28ca/elisp-files/pastie.el](https://bitbucket.org/sid0/.emacs/raw/837539ad28ca/elisp-files/pastie.el)找到了一个工作版本。

# php - 插入 Mysql 数据库

> ID：10852650
> 
> 赞同：0
> 
> 时间：2012-06-01T14:57:31.297
> 
> 标签：php, mysql

我的一些编码有一个小问题。出于某种原因，我的条目没有放入我的数据库中。任何建议将不胜感激！这是我的代码...

```
<?php 
    $dbhost="localhost"; 
    $dbname="DBNAME"; 
    $dbuser="USER"; 
    $dbpasswd="PASSWORD"; // connect to the db 

    $dbcxn = mysqli_connect($dbhost, $dbuser, $dbpasswd); 
    if (!$dbcxn) { 
        die('Could not connect: ' . mysql_error()); 
    } 

    $db_selected = mysqli_select_db($dbcxn, $dbname); 
    if (!$db_selected) { 
        die ('Can\'t use dbreviews : ' . mysql_error()); 
    } 

    $query = "INSERT INTO entries ( submitterFirstName, submitterLastName, submitterPhone, submitterEmail, referredFirstName, referredLastName, referredPhone, referredEmail, referredReason)
      VALUES ('$submitterFirstName', '$submitterLastName', '$submitterPhone', '$submitterEmail', '$referredFirstName', '$referredLastName', '$referredPhone', '$referredEmail', '$referredProject')";

    $result=mysqli_query($dbcxn, $query); 
```

?>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:40:23.883

首先应该是代码格式化，它将帮助您阅读代码，从而更容易地发现您的错误。

```
$query = "

INSERT INTO 
    entries 
    (
    submitterFirstName, 
    submitterLastName, 
    submitterPhone,        
    submitterEmail, 
    referredFirstName, 
    " . 
       "referredLastName, 
    referredPhone, 
    referredEmail, 
    referredReason
    )
        " .
    " VALUES 
    (
    '$submitterFirstName', 
    '$submitterLastName', 
    '$submitterPhone', 
    '    $submitterEmail', 
    '$referredFirstName'," .
    "'$referredLastName', 
    '$referredPhone', 
    '$referredEmail',    
    '$referredProject'
    );
" 
```

以上是将您的查询字符串拆分为几行，有一些错误应该立即显而易见吗？格式化后，我会`echo $query`查看 $query 的输出。

还可以尝试查看是否可以在不使用 php 的情况下进行插入（使用 mysql workbench、php admin 等），然后将其与您设置为 $query 的字符串值进行比较。

```
// less errors, please note that inside "" you can include php $vars without needing to escape.  

$query = "

INSERT INTO 
    entries 
    (
    submitterFirstName, 
    submitterLastName, 
    submitterPhone,        
    submitterEmail, 
    referredFirstName, 
    referredLastName, 
    referredPhone, 
    referredEmail, 
    referredReason
    )
 VALUES 
    (
    '$submitterFirstName', 
    '$submitterLastName', 
    '$submitterPhone', 
    '$submitterEmail', 
    '$referredFirstName',
    '$referredLastName', 
    '$referredPhone', 
    '$referredEmail',    
    '$referredProject'
    );
"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:15:14.270

您要检查的第一件事是将查询回显给自己并仔细阅读。

其次，检查表结构。确保列名都拼写正确并且所有字段都存在于您的表中（我之前不小心忘记添加一列）。

第三，根据您的配置，您可能会或可能不会收到错误消息。但是，您可以手动检查。

```
if (!$result) {
  echo mysqli_error($dbcxn);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:19:26.750

将您的查询变量更改为：

```
$query = "INSERT INTO entries " .
 "( submitterFirstName, submitterLastName, submitterPhone, submitterEmail, referredFirstName, " .
 " referredLastName, referredPhone, referredEmail, referredReason )" .
 " VALUES ('" .
    $submitterFirstName . "', '" .
    $submitterLastName  . "', '" .
    $submitterPhone     . "', '" .
    $submitterEmail     . "', '" .
    $referredFirstName  . "', '" .
    $referredLastName   . "', '" .
    $referredPhone      . "', '" .
    $referredEmail      . "', '" .
    $referredProject    . "')"; 
```

它应该可以工作。

建议使用[***mysqli prepare***](http://php.net/manual/en/mysqli.prepare.php)

# javascript - dataType jsonp 和 JSON 的区别

> ID：10852652
> 
> 赞同：19
> 
> 时间：2012-06-01T14:57:32.943
> 
> 标签：javascript, jquery, ajax, jquery-ui

我下载 Jquery UI 自动加载，寻找 remote-jsonp.html。这是 ajax 函数，但我打开控制台.. 我在控制台中看不到任何请求...

dataType;"jsonp" 和 dataType;"JSON" 有什么区别

```
$( "#city" ).autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "http://ws.geonames.org/searchJSON",
                dataType: "jsonp",
                data: {
                    featureClass: "P",
                    style: "full",
                    maxRows: 12,
                    name_startsWith: request.term
                },
                success: function( data ) {
                    response( $.map( data.geonames, function( item ) {
                        return {
                            label: item.name + (item.adminName1 ? ", " + item.adminName1 : "") + ", " + item.countryName,
                            value: item.name
                        }
                    }));
                }
            });
        }, 
```

**参考** [http://jqueryui.com/demos/autocomplete/remote-jsonp.html](http://jqueryui.com/demos/autocomplete/remote-jsonp.html)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-01T14:58:53.660

`dataType: jsonp`对于跨域请求，这意味着对不同域的请求和`dataType: json`对同域同源请求的请求。

> 使用 JSONP 加载 JSON 块。添加一个额外的“？callback =？” 到 URL 的末尾以指定回调。通过将查询字符串参数“_=[TIMESTAMP]”附加到 URL 来禁用缓存，除非缓存选项设置为 true。

阅读**[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)**

阅读有关**[jQuery AJAX的更多信息](http://api.jquery.com/jQuery.ajax/)**

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-01T15:00:02.670

使用 JSONP，如果您正在寻找的是 ajax 请求，您不应该看到它。但是，您应该会看到对该资源的请求，因为 JSONP 用于跨域调用以从不同域中提取数据。

它返回包装在函数名称中的 JSON 数据。jQuery 在后台处理函数名称并将数据传递到您的成功处理程序。数据是通过动态创建一个脚本元素来加载的，该元素的 src 属性指向被调用的服务，然后附加到浏览器的 DOM。然后浏览器向资源发出请求，Web 服务以回调函数和数据进行响应。

# python - 计算器异常处理，为什么这个例子有效，而我的却没有？

> ID：10852653
> 
> 赞同：1
> 
> 时间：2012-06-01T14:57:35.480
> 
> 标签：python, exception-handling, calculator

为了进行一些 Python 练习，我决定编写一个计算器教程。这是非常基本的，所以我决定在用户​​输入垃圾时给它异常处理。虽然程序的正确使用仍然有效，但废话仍然会导致它崩溃，输入这里是我的代码：

```
loop = 1

choice = 0

while loop == 1:
    #print out the options you have
    print "Welcome to calculator.py"

    print "your options are:"

    print " "
    print "1) Addition"
    print "2) Subtraction"

    print "3) Multiplication"

    print "4) Division"
    print "5) Quit calculator.py"
    print " "

    choice = input("choose your option: ")
    try:
        if choice == 1:
            add1 = input("add this: ")
            add2= input("to this: ")
            print add1, "+", add2, "=", add1+ add2
        elif choice == 2:
            sub1 = input("Subtract this ")
            sub2 = input("from this")
            print sub1, "-", sub2, "=", sub1 - sub2
        elif choice == 3:
            mul1 = input("Multiply this: ")
            mul2 = input("with this: ")
            print mul1, "x", mul2, "=", mul1 * mul2
        elif choice == 4:
            div1 = input("Divide this: ")
            div2 = input("by this: ")
            if div2 == 0:
                print "Error! Cannot divide by zero!  You'll destroy the universe! ;)"
            else:

                print div1, "/", div2, "=", div1 * div2
        elif choice == 5:
            loop = 0
        else:
            print "%d is not valid input. Please enter 1, 2 ,3 ,4 or 5." % choice

    except ValueError:
        print "%r is not valid input.  Please enter 1, 2, 3, 4 or 5." % choice
    print "Thank you for using calculator.py!" 
```

现在，虽然我在这里找到了一个有用的答案：[计算器程序中的错误处理变量，错误处理数字很好](https://stackoverflow.com/questions/5228641/error-handling-variables-in-a-calculator-program-error-handling-numbers-are-fin)

我想知道为什么我的代码不起作用。python是否想要函数中的异常处理？这就是我从中得到的氛围。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:03:45.490

在 Python 2（这是您正在使用的）`input`中，无论用户输入什么，都将计算为 Python 代码。因此`input`会引发许多不同的异常，但很少出现`ValueError`.

更好的是接受您的输入并`raw_input`返回一个字符串，然后转换为预期的类型。如果输入无效，它将引发`ValueError`：

```
>>> x = int(raw_input("enter something: "))
enter something: sdjf
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: invalid literal for int() with base 10: 'sdjf' 
```

注意：在 Python 3`input`中假定 Python 2 的语义`raw_input`并`raw_input`消失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:14:59.103

你在抓`ValueError`，这是错误的抓。

看看是如何`input()`工作的：

```
>>> print input.__doc__
input([prompt]) -> value

Equivalent to eval(raw_input(prompt)). 
```

因此，它所做的是评估您在该点输入的内容，就像它评估您在交互式 Python 会话中输入的任何内容一样。例如，`NameError`如果我尝试`garbagestring`在提示符处输入，我会得到 a，出于同样的原因，`NameError`如果我尝试`garbagestring`在交互式提示符处输入，我会得到 a：

```
>>> garbagestring
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'garbagestring' is not defined 
```

正确的做法是使用`raw_input()`代替`input()`，然后将返回的字符串转换为整数：

```
>>> raw_input('Prompt: ')
Prompt: garbagestring
'garbagestring'
>>> int(raw_input('Prompt: '))
Prompt: garbagestring
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: invalid literal for int() with base 10: 'garbagestring'
>>> int(raw_input('Prompt: '))
Prompt: 45
45 
```

这将在您使用它时捕获错误。

请注意，一般情况下，您应该避免做任何看起来像`eval()`. 通常，您可以在没有它的情况下实现您需要的任何东西，`eval()`如果使用您不信任的字符串，则可能存在安全风险。例如，如果我`import os`在脚本顶部添加（一个非常常见的导入），我可以这样做：

```
Multiply this: os.listdir('/')
with this: 0
['bin', 'cygdrive', 'dev', 'etc', 'home', 'lib', 'tmp', 'usr', 'var', 'proc'] x 0 = []
Thank you for using calculator.py! 
```

我可以轻松读取文件、删除重要文件夹等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:19:36.327

`input``eval()`对用户的输入做一个，基本上`input`做一个`eval(raw_input(prompt))`

因此，如果您输入`loop`，它不会失败，它实际上会设置`choice`为`1`。

如果您输入`a`，它将评估并引发`NameError`异常。

如果你输入`1 + 1`它会减去。

我希望你能明白。

# linux - bash sh - 找不到命令

> ID：10852660
> 
> 赞同：14
> 
> 时间：2012-06-01T14:58:39.270
> 
> 标签：linux, bash

```
#!/bin/bash
cd ~/workspace/trunk;
svn up; 
```

当我运行`./build.sh`表单命令行时，它说：

```
: command not found 
```

什么也没有发生。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-09-15T11:21:05.193

我解决了添加执行权限：

`sudo chmod +x file.sh`

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-06-01T15:25:42.203

我的猜测是文件中有不可打印的控制字符，或者它有`\r\n`（CRLF）行尾（dos/windows 模式）。

尝试使用以下命令进行检查：

```
$ hexdump -C build.sh 
00000000  23 21 2f 62 69 6e 2f 62  61 73 68 0a 63 64 20 7e  |#!/bin/bash.cd ~|
00000010  2f 77 6f 72 6b 73 70 61  63 65 2f 74 72 75 6e 6b  |/workspace/trunk|
00000020  3b 0a 73 76 6e 20 75 70  3b 0a                    |;.svn up;.|
0000002a

$ file build.sh 
build.sh: Bourne-Again shell script, ASCII text executable

$ unix2dos build.sh 
unix2dos: converting file build.sh to DOS format ...

$ hexdump -C build.sh 
00000000  23 21 2f 62 69 6e 2f 62  61 73 68 0d 0a 63 64 20  |#!/bin/bash..cd |
00000010  7e 2f 77 6f 72 6b 73 70  61 63 65 2f 74 72 75 6e  |~/workspace/trun|
00000020  6b 3b 0d 0a 73 76 6e 20  75 70 3b 0d 0a           |k;..svn up;..|
0000002d

$ file build.sh 
build.sh: Bourne-Again shell script, ASCII text executable, with CRLF line terminators 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2018-07-27T11:21:52.553

我已经通过这个命令解决了我的错误。

```
sudo chmod +x build.sh 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-06-01T15:00:40.600

`;`从脚本行的末尾删除。

这不会发生在我的 bash 中，所以我不确定到底出了什么问题，但我的猜测是：

`;`是命令的分隔符。由于您的最后一个命令以 结尾`;`，因此您的 bash 可能需要在之后执行另一个命令。但是，由于脚本完成，它会读取一个无法执行的空命令。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-06-05T19:11:46.623

以上都不对我有用，除了

```
sudo ./build.sh 
```

# php - 如何计算 pyrocms 中的在线用户数？

> ID：10852661
> 
> 赞同：1
> 
> 时间：2012-06-01T14:58:43.047
> 
> 标签：php, codeigniter, pyrocms

pyrocms 中有一张桌子`default_ci_sessions`。我认为这必须使用这张表来完成。该表的字段是：

```
1   session_id  varchar(40)
2   ip_address  varchar(16)
3   user_agent  varchar(120)
4   last_activity   int(10)
5   user_data   text 
```

样本行：

```
1   70bb123786d01c0be696e98cb1f6622e
2   0.0.0.0
3   Mozilla/5.0 (Windows NT 6.1) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.168 Safari/535.19
4   1336371726
5   a:7:{s:9:"user_data";s:0:"";s:8:"username";s:5:"admin";s:5:"email";s:22:"abc@gmail.com";s:2:"id";s:1:"1";s:7:"user_id";s:1:"1";s:8:"group_id";s:1:"1";s:5:"group";s:5:"admin";} 
```

我正在我的本地主机上开发，并且只有一个（以上）用户注册。在看到表格的内容之前，我在想的是，该表格应该有一条记录，因为您知道 :)。但是那里已经有 120 条记录，包括来宾用户 session_ids 和我的用户（管理员）的 10 行。我认为唯一的方法是弄清楚我可以用这个`last_activity`领域做什么。

还有一个离题的问题：为什么那里有这么多会议？他们不是活跃的会话吗？那么我可以为每个用户名将它们全部分组并选择最大的`last_activity`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:11:35.607

你可以考虑一个用户登录（因为你没有关于注销的信息），最后一次活动不超过 24 分钟（24 分钟是浏览器默认保持会话的时间）。

因此，在您的查询中，您将从`default_ci_sessions` `where last_activity >= NOW() - INTERVAL '24' MINUTES`...中计算这些记录

# javascript - ' ' 和 " " 以及没有引号在 Javascript 中是什么意思？

> ID：10852663
> 
> 赞同：7
> 
> 时间：2012-06-01T14:58:49.470
> 
> 标签：javascript, quotes, evaluation, double-quotes

我意识到我一直在它们之间切换，不知道为什么，并且发现很难搜索。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-01T15:01:04.423

`' '`和`" "`是同一个东西；它们用于定义字符串文字。

不带引号的东西可以是标识符、关键字、非字符串文字、属性名称或数字（可能遗漏了一个）。

例子：

```
"hello world"        literal (string)
'hello world'        literal (string) with same contents
document             identifier (object)
{ a: 1 }             property name
if                   keyword (start conditional statement)
3.4                  literal (number)
/abc/                literal (regex object) 
```

用单引号括起来的字符串文字不需要转义双引号，反之亦然，例如：

```
'<a href="">click me</a>'    HTML containing double quotes
"It's going to rain"         String containing single quote 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-01T15:05:51.020

`' '`并`" "`用于引用字符串文字并表示字符串，而没有引号的文字是变量（变量名称，常量），称为标识符，例如

```
variable = 'Hello'; (Here `variable` is identifier and 'Hello' is string literal)

var = "Ho There" 
```

`' (single quote)`你可能会问，和之间有什么区别`" (Double quote)`

不同之处在于，`"`如果其中的字符串具有特殊字符，则它们需要转义。例子：

Variable = "hi " there"; ---> 在这里你需要转义`"`里面的字符串，比如

```
Variable = "hi \" there"; 
```

但是如果使用，`'`则不需要转义（除非`'`字符串中有额外的）。你可以喜欢

```
var = 'Hello " World"'; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-01T15:02:38.340

`"`并且`'`可以互换（但需要一起使用）。

`myObject["property"]`并且`myObject.property`可以互换。 `$var foo = "property"; myObject[foo]`以及（根据下面的评论）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T12:30:51.223

一个快速的 jsfiddle 以及单引号和双引号转义控制代码等。

在最近的日子里，我遇到了来自 HTML 的错误，其中没有使用双引号，如果你查看[JSON](http://json.org/)的规范，你会注意到它是在引用字符串文字时要求的双引号。因此，出于历史原因，我认为双引号是惯例。

然而！在编写服务器端 JS 的这些日子里，我必须承认我倾向于回到我的 C 根和双引号，我想要转义字符和单引号字符串，它们实际上是文字字符并且永远不可能包含转义字符（即使这是本质上是非生产性行为）。除了现在我的大部分 JS 都是coffeescript，没有人为了优雅而写过 javascript，尽管 CS 是一个不同的鱼壶。

# hibernate - 如何从休眠中的复合元素获取元数据？

> ID：10852665
> 
> 赞同：0
> 
> 时间：2012-06-01T14:58:57.337
> 
> 标签：hibernate, metadata

我的休眠映射中有一个复合元素，需要显示在休眠的类元数据字典中。我能够做到这一点的唯一方法是在单独的`<class>`条目中定义类，并使用`<composite-element type="myClass">`.

这样做的问题是复合元素在对象中没有键，只有表。所以，当我在一个单独的类中定义它时，我必须给它一个 id，并最终用非空元素组成一些假键。

有没有办法让复合元素显示在 classmetadata 字典中？或者任何方式来定义没有 id 的东西？（我知道后者的答案是“不”，但这是我唯一的另一个想法……）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T20:13:42.867

我最终不得不重新设计。

# ruby - 是否有适用于 ruby 1.9.2 的 soap4r / wsdl2ruby 版本？

> ID：10852675
> 
> 赞同：4
> 
> 时间：2012-06-01T14:59:24.137
> 
> 标签：ruby, soap4r, wsdl2ruby

正如[Ruby soap4r wsdl2ruby.rb 错误](https://stackoverflow.com/questions/5754965/ruby-soap4r-wsdl2ruby-rb-errors)中所建议的那样，我从 git://github.com/felipec/soap4r.git 加载了 soap4r gem，并在 xmlparser.rb 的第 66 行进行了更改

```
c.downcase == name 
```

到

```
c.to_s.downcase == name 
```

但是当我运行时：

```
wsdl2ruby.rb --wsdl http://docs.arrayent.com/zamapi.xml --type client --force 
```

在一堆警告之后，它最终爆发了：

```
F, [2012-06-01T07:54:26.319928 #285] FATAL -- app: Detected an exception. Stopping ... undefined method `collect' for #<String:0x00000100c4a418> (NoMethodError)
/Users/r/Developer/Topaz/usr/lib/ruby/gems/1.9.1/gems/soap4r-1.5.8/lib/xsd/codegen/gensupport.rb:239:in `trim_eol' 
```

由于 'String#collect' 在以前的 Ruby 版本中有效，我的直觉是这个 wsdl2ruby 还没有针对 Ruby 1.9.2 进行更新。

有更新的吗？还是补丁？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T20:47:54.707

您可以尝试安装此 gem [https://rubygems.org/gems/mumboe-soap4r](https://rubygems.org/gems/mumboe-soap4r)。它解决了我的问题。

# asp-classic - 经典asp中的动态表单

> ID：10852676
> 
> 赞同：0
> 
> 时间：2012-06-01T14:59:25.120
> 
> 标签：asp-classic

我使用 vbscript 创建了一个动态表单。它显示正常，但是当我单击提交按钮时，它不会将页面发回...有人可以帮助我吗？我写的代码是：

```
<form method="post" action="home.asp">
    <%if session("id")="" then
        response.write("<div id=logindiv>Login ID: <input type=text ID=loginID name=loginID /><br/><br/>Password: <input type=password ID=password name = password/><br/><br/><a href=register.asp/>Sign Up</a>&nbsp;&nbsp;&nbsp;<input type=submit id=loginbtn name=loginbtn value=Login /></div>")
    else
        response.write("already logged in")
    end if%>
</form> 
```

生成的html是这样的：

```
<form method="post" action="home.asp">
    <div id=logindiv>Login ID: <input type=text ID=loginID name=loginID /><br/><br/>Password: <input type=password ID=password name = password/><br/><br/><a href=register.asp/>Sign Up</a>&nbsp;&nbsp;&nbsp;<input type=submit id=loginbtn name=loginbtn value=Login /></div>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:30:24.223

看起来你的锚标签中有一个额外的 / ：

```
<a href=register.asp/> 
```

也许不相关，但如果它正在关闭元素，那么“注册”之后可能会搞砸 .

# android - Android：本机内存不足

> ID：10852682
> 
> 赞同：2
> 
> 时间：2012-06-01T14:59:42.037
> 
> 标签：android, android-ndk

我同时购买了两台三星 Galaxy S2，一台装有 Android 2.3.4，一台装有 4.0.3。

我的 java 类初始化了几个本地库（FFMPEG）并启动了一个 AsyncTask 来转换两个文件。

在4.0.3的设备上，我可以启动两次AsyncTask进行两次不同的转换，任务成功结束。

在 2.3.4 的设备上，第一个任务启动正常，当我启动第二个任务时，应用程序重新启动（本机崩溃）

我认为不同之处可能在于系统如何加载本机库？可能在 ICS Google 上修复了什么？我可以检查什么？

**更新**

启用 CheckingJNI，我在 LogCat 中收到此错误：

06-04 18:43:40.343：A/libc(28648)：@@@ 中止：internal_realloc 中的堆地址无效

# symfony - 我可以在 Bundle 配置中定义新的连接/实体管理器吗？

> ID：10852687
> 
> 赞同：0
> 
> 时间：2012-06-01T15:00:02.937
> 
> 标签：symfony, doctrine-orm

我正在尝试定义一个 Bundle 来帮助在 sqlite fts 表中索引一些数据（来自实体），以便进行一些全文搜索。

我知道我可以使用`app`配置文件定义备用连接和实体管理器（如说明书中所示），但我想知道是否可以在捆绑配置中这样做 - 例如，通过定义`doctrine`注入服务的服务，以便它可以实例化一个新的连接。

Sqlite 不是强制性的，它可以是任何数据库类型（由学说支持）。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:43:56.270

我建议查看[FOSUserBundle](https://github.com/FriendsOfSymfony/FOSUserBundle)，了解它们如何处理多个持久层（ORM、Couch、MongoDB）。你基本上会做同样的事情。这只是根据 app/config/config.yml 中指定的驱动程序加载不同配置的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T20:20:05.400

据我所知，这是不可能的。此外，数据库连接应集中在 app/config.yml 中进行管理。

我建议在那里定义连接并为您的捆绑包添加一个配置选项，您可以在其中指定用于索引内容的至极连接。

```
# app/config.yml
doctrine:
    dbal:
        default_connection:   default
        connections:
            default:
                dbname:               database
                host:                 localhost
                user:                 user
                password:             secret
                driver:               pdo_mysql
            my_data_index:
                dbname:               database
                driver:               pdo_sqlite

# configuration option of you bundle
acme_indexer:
    connection: my_data_index 
```

然后在您的捆绑包中，您可以读取此配置选项并获取连接/实体管理器并将其注入您的索引服务。

**编辑：**

您肯定可以在捆绑包中以编程方式创建自定义连接

```
$params =   array(
    'driver'    =>'pdo_sqlite',
    ....
);

$factory = $container->get('doctrine.dbal.connection_factory')
$connection = $factory->createConnection($params); 
```

但正如我之前所说，这是不好的做法，因为你会回避 symfony 定义数据库连接的标准方式。

# c - 错误 1053 Windows 服务

> ID：10852689
> 
> 赞同：-1
> 
> 时间：2012-06-01T15:00:10.037
> 
> 标签：c, windows, visual-studio-2010, visual-studio

我创建了一个 Windows 服务，但是当我启动该服务时出现 1053 错误。我已经在我的机器上安装了 .net framework 4。任何人都可以帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:53:03.907

您很可能在 OnStart() 中做了很多事情。尝试这样的事情。

'Protected Overrides Sub OnStart(ByVal args() As String) ' 在此处添加代码以启动您的服务。这种方法应该让事情动起来，这样你的服务就可以完成它的工作。

```
 Try
        Dim worker = New Thread(AddressOf DoWork)
        worker.Name = "MyWork"
        worker.IsBackground = False
        worker.Start()
    Catch ex As Exception
        'write to a log somewhere, however you usually handle your errors

    End Try

End Sub' 
```

尝试类似的方法，但我们确实需要更多信息来帮助您

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T19:37:06.840

您绝对需要进一步调试。正如其他人已经指出的那样，“错误 1053”太笼统了，没有多大帮助。

1）阅读此链接。它告诉您如何在 Visual Studio 中调试服务。您需要创建一个虚拟的“OnStart()”方法（以便您可以调试“真实的”OnStart）：

[http://msdn.microsoft.com/en-us/library/7a50syb3%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/7a50syb3%28v=vs.80%29.aspx)

2) 这是一篇关于 Windows 事件日志记录的好文章：

[http://www.codeproject.com/Articles/39218/How-To-Create-a-Windows-Event-Log-and-Write-your-C](http://www.codeproject.com/Articles/39218/How-To-Create-a-Windows-Event-Log-and-Write-your-C)

对于初学者（如果您还没有自己的事件日志），我会考虑将“printf”附加到文本文件中

3) 将问题隔离到代码的特定部分后，请随时在此处发布。

'希望有帮助！

# opencl - OpenCL 设备唯一性

> ID：10852696
> 
> 赞同：11
> 
> 时间：2012-06-01T15:00:31.037
> 
> 标签：opencl

有没有办法让 OpenCL 为我提供所有具有 OpenCL 实现的唯一物理设备的列表？我知道如何遍历平台/设备列表，但例如，在我的情况下，我有一个 Intel 提供的平台，它为我的 CPU 提供了一个高效的设备实现，以及一个为我的 GPU 提供快速实现的 APP 平台，但是对我的 CPU 来说是一个糟糕的实现。

有没有办法确定这两个 CPU 设备实际上是同一个物理设备，这样我就可以选择最有效的一个并使用它，而不是同时使用它们并让它们在计算时间上相互竞争单个物理设备？

我已经看过，`CL_DEVICE_VENDOR_ID`但`CL_DEVICE_NAME`它们并没有解决我的问题，`CL_DEVICE_NAME`对于相同型号的两个单独的物理设备（双 GPU）来说，这将是相同的，并`CL_DEVICE_VENDOR_ID`根据平台为我的 CPU 提供不同的 ID。

一个理想的解决方案是某种唯一的物理设备 ID，但我很乐意手动更改 OpenCL 配置以自己重新排列设备（如果可能的话）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-03-15T20:06:53.230

就我现在可以调查的问题而言，没有可靠的解决方案。如果您的所有工作都在单个进程中完成，您可以使用返回的条目顺序`clGetDeviceIDs`或`cl_device`值本身（本质上它们是指针），但如果您尝试在进程之间共享这些标识符，情况会变得更糟。

看到[那个人的博客文章](https://anteru.net/2014/08/01/2483/)，说：

> 问题是，如果你有两个相同的 GPU，你就无法区分它们。如果您调用`clGetDeviceIDs`，它们返回的顺序实际上是未指定的，因此如果第一个进程选择第一个设备，而第二个进程选择第二个设备，它们都可能最终超额订阅同一个 GPU 并使另一个空闲。

但是，他指出 nVidia 和 AMD 提供了他们的自定义扩展，`cl_amd_device_topology`并且`cl_nv_device_attribute_query`. 您可以检查您的设备是否支持这些扩展，然后按照以下方式使用它们（原作者的代码）：

```
// This cl_ext is provided as part of the AMD APP SDK
#include <CL/cl_ext.h>

cl_device_topology_amd topology;
status = clGetDeviceInfo (devices[i], CL_DEVICE_TOPOLOGY_AMD,
    sizeof(cl_device_topology_amd), &topology, NULL);

if(status != CL_SUCCESS) {
    // Handle error
}

if (topology.raw.type == CL_DEVICE_TOPOLOGY_TYPE_PCIE_AMD) {
    std::cout << "INFO: Topology: " << "PCI[ B#" << (int)topology.pcie.bus
        << ", D#" << (int)topology.pcie.device << ", F#"
        << (int)topology.pcie.function << " ]" << std::endl;
} 
```

或（我的代码，改编自上面的链接帖子）：

```
#define CL_DEVICE_PCI_BUS_ID_NV  0x4008
#define CL_DEVICE_PCI_SLOT_ID_NV 0x4009

cl_int bus_id;
cl_int slot_id;

status = clGetDeviceInfo (devices[i], CL_DEVICE_PCI_BUS_ID_NV,
    sizeof(cl_int), &bus_id, NULL);
if (status != CL_SUCCESS) {
    // Handle error.
}

status = clGetDeviceInfo (devices[i], CL_DEVICE_PCI_BUS_ID_NV,
    sizeof(cl_int), &slot_id, NULL);
if (status != CL_SUCCESS) {
    // Handle error.
}

std::cout << "Topology = [" << bus_id <<
                         ":"<< slot_id << "]" << std::endl; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-07T13:16:27.653

*   如果您有两个属于一个平台的完全相同类型的设备，您可以通过 clGetDeviceIDs 返回的关联 cl_device_ids 来区分它们。

*   如果您有可以被两个不同平台使用的设备，您可以通过比较 CL_DEVICE_NAME 中的设备名称来消除第二个平台的条目。

*   如果要查找设备的预期平台，请分别比较来自 clGetPlatformInfo() 和 clGetDeviceInfo 的 CL_PLATFORM_VENDOR 和 CL_DEVICE_VENDOR 字符串。

您可以将所有平台及其所有关联设备读入单独的特定于平台的列表中，然后通过比较单独列表中的设备名称来消除双精度。这应该确保您不会为不同的平台获得相同的设备。

最后，您可以通过命令行参数或配置文件，例如，为您的应用程序提供参数，以将特定类型的设备（CPU、GPU、加速器）与特定平台相关联，如果存在针对设备类型的不同平台的选择。希望这能回答你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T02:27:22.703

无论如何，让我们假设您正在尝试提取所有设备的唯一 ID，实际上您可以简单地使用 clGetDeviceIDs 进行查询：

```
cl_int clGetDeviceIDs(cl_platform_id platform,
                      cl_device_type device_type,
                      cl_uint num_entries,
                      cl_device_id *devices,
                      cl_uint *num_devices) 
```

然后您的设备列表将被插入到 *devices 数组中，然后您可以执行 clGetDeviceInfo() 来找出您想要使用的设备。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-30T18:30:17.517

结合上面的答案，我的解决方案是：

```
long bus = 0; // leave it 0 for Intel
// update bus for NVIDIA/AMD ...
// ...
long uid = (bus << 5) | device_type; 
```

[正如Steinin 所](https://stackoverflow.com/a/19836965/1093791)建议的，变量是`bus`根据 NVIDIA/AMD 设备特定信息查询计算的，如[firegurafiku 所述](https://stackoverflow.com/a/36021096/1093791)，变量`device_type`是`clGetDeviceInfo(clDevice, CL_DEVICE_TYPE, sizeof(cl_device_type), &device_type, nullptr)`API 调用的结果。

这种方法解决了集成 GPU 的 Intel CPU 具有相同唯一 ID 的问题。现在两个设备都有唯一的标识符，这要归功于不同`CL_DEVICE_TYPE`的 '。

[令人惊讶的是，在Oclgrind](https://github.com/jrprice/Oclgrind)模拟设备上运行代码的情况下，`Oclgrind simulator`设备也获得了唯一标识符`15`，与我系统上的任何其他设备不同。

提出的方法可能失败的唯一情况 - 单个主板上的多个相同型号的 CPU。

# c++ - C++ 库中更优雅的错误处理 - jsoncpp

> ID：10852698
> 
> 赞同：6
> 
> 时间：2012-06-01T15:00:34.817
> 
> 标签：c++, error-handling, assert, fault-tolerance, jsoncpp

我不确定这是否是 jsoncpp 的特定事物，或者是如何使 C++ 库表现更好的一般范例。基本上我得到了这个跟踪：

```
imagegeneratormanager.tsk: src/lib_json/json_value.cpp:1176: const Json::Value&     Json::Value::operator[](const char*) const: Assertion `type_ == nullValue || type_ == objectValue' failed. 
```

当输入不好时会发生这种情况。当输入（通过 memcached 来自我的另一个应用程序）发生错误时，我想处理此错误。你知道，优雅地。可能类似于“错误：项目 15006 的输入错误”进入日志。不会使我的整个 JSON 字符串处理任务崩溃。

这只是一个写得不好的库还是可以更巧妙地配置它？

编辑：这是一些调用代码：

```
Json::Value root;
Json::Reader reader;
succeeded = reader.parse(jsonString, root);

if(!succeeded) {
  throw std::runtime_error(std::string("Failed to parse JSON for key ")  + emailInfoKey.str());
}

std::string userEmail = root.get("userId", "").asString();
std::string bodyFilePath = root.get("bodyFilePath", "").asString();
std::string msgId = root.get("msgId", "").asString(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T15:17:10.720

根据图书馆参考：

> Value & Json::Value::operator[] ( const StaticString & key )
> 
> 按名称访问对象值，如果不存在则创建一个空成员。

似乎您正在尝试调用`operator[]`非对象，例如整数或字符串*（`get`内部使用`operator[]`）*。您正在破坏函数前提条件，并且它在您的代码而非库中是错误的。您可以`Json::Value`在使用 访问它之前检查它是否是一个对象`isObject()`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T15:24:44.130

正如我从 JsonCpp Sourceforge 存储库中看到的那样，现在断言是不可捕获的（但是似乎在他们的积压中进行抛出断言）。

然后，您必须在调用 [] 运算符之前测试输入是否有效。

最新版本源代码的链接（我不知道你的版本）。见第 1141 行：http: [//jsoncpp.svn.sourceforge.net/viewvc/jsoncpp/trunk/jsoncpp/src/lib_json/json_value.cpp ?revision=249&view=markup](http://jsoncpp.svn.sourceforge.net/viewvc/jsoncpp/trunk/jsoncpp/src/lib_json/json_value.cpp?revision=249&view=markup)

# java - 何时调用 loadUserByUsername？（弹簧安全）

> ID：10852703
> 
> 赞同：21
> 
> 时间：2012-06-01T15:00:43.497
> 
> 标签：java, spring, spring-security

我正在学习`Spring Security`，我有几个简单的问题尊重`UserDetailsService`：

1-何时`loadUserByUsername`实际调用或调用？认证后？每次登录只有一次？

2-登录后，Spring会将实际登录的用户放入httpSession吗？

3- 推荐的填充集合的方法`<GrantedAuthority>`是`UserDetails`什么？

1.  Eagle 获取它们，因此当调用 loadUserByUsername 时，返回的用户已经拥有它的“ROLES”
2.  `UsernamePasswordAuthenticationFilter`成功登录后实现另一个自定义过滤器，如填充？
3.  以上都不是……</li>

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-01T19:21:34.747

1.  它通常由`AuthenticationProvider`实例调用以对用户进行身份验证。例如，当提交用户名和密码时，`UserdetailsService`会调用 a 来查找该用户的密码以查看其是否正确。它通常还会提供有关用户的一些其他信息，例如权限和您可能希望为登录用户访问的任何自定义字段（例如电子邮件）。这是主要的使用模式。您可以对代码进行 grep 以查看它的确切调用位置。

如[手册中所述](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#tech-userdetailsservice)：

> 关于 UserDetailsS​​ervice 经常有一些混淆。它纯粹是用户数据的 DAO，除了将数据提供给框架内的其他组件外，不执行任何其他功能。特别是，它不对用户进行身份验证，这是由 AuthenticationManager 完成的。在许多情况下，如果您需要自定义身份验证过程，直接实现 AuthenticationProvider 会更有意义。

2.  是的。一旦用户通过身份验证，一个`SecurityContext`实例就会[存储在会话中。](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#tech-intro-sec-context-persistence)

3.  如果您需要实现自定义`UserDetailsService`，那么它将取决于您的要求以及它们的存储方式。通常，您会在加载其他用户信息的同时加载它们。这不是您在过滤器中可能会做的事情。正如上面手册中的引用所解释的，如果您实际上正在实施不同的身份验证机制，那么您应该`AuthenticationProvider`直接实施。在您的应用程序中有一个不是强制性的`UserDetailsService`。您可以将其视为某些内置功能使用的策略。

# c# - C# 子类同时保持名称。深巫术？

> ID：10852704
> 
> 赞同：4
> 
> 时间：2012-06-01T15:00:45.500
> 
> 标签：c#, .net, c#-3.0

我有一个正在使用的 dll，它包含一个类 foo.Launch。我想创建另一个子类 Launch 的 dll。问题是类名必须相同。这被用作另一个软件的插件，而 foo.Launch 类是启动插件的敌人。

我试过了：

```
namespace foo
{
    public class Launch : global::foo.Launch
    {
    }
} 
```

和

```
using otherfoo = foo;
namespace foo
{
    public class Launch : otherfoo.Launch
    {
    }
} 
```

我还尝试在引用属性中指定一个别名，并在我的代码中使用该别名而不是全局，这也不起作用。

这些方法都不起作用。有没有办法可以指定要在 using 语句中查看的 dll 的名称？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T15:32:18.570

您需要为原始程序集设置别名，并使用 an`extern alias`在新程序集中引用原始程序集。这是使用别名的示例。

```
extern alias LauncherOriginal;

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace foo
{
    public class Launcher : LauncherOriginal.foo.Launcher
    {
        ...
    }
} 
```

这是一个[演练](http://blogs.msdn.com/b/ansonh/archive/2006/09/27/774692.aspx)，解释了如何实现它。

另外，您提到您之前尝试使用别名并遇到问题，但您没有说明它们是什么，所以如果这不起作用，请说明出了什么问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:34:19.383

正如克里斯所说，您可以在原始程序集中使用别名。

如果你不能那样做，那么你可以通过使用第三个程序集来作弊

Assembly1.dll（您的原始文件）

```
namespace foo { 
     public class Launch {}
} 
```

Assembly2.dll（虚拟）

```
namespace othernamespace { 
     public abstract class Dummy: foo.Launch {}
} 
```

Assembly3.dll（你的插件）

```
namespace foo{ 
     public class Launch: othernamespace.Dummy{}
} 
```

我什至不以此为荣！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:11:28.983

如果类名是在另一个命名空间中定义的，它可以是相同的，但令人难以置信的是为什么有人要对自己这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T17:35:39.100

也许您需要使用外部别名。

例如：

```
//in file foolaunch.cs

using System;

namespace Foo
{
    public class Launch
    {
        protected void Method1()
        {
            Console.WriteLine("Hello from Foo.Launch.Method1");
        }
    }
}

// csc /target:library /out:FooLaunch.dll foolaunch.cs

//now subclassing foo.Launch

//in file subfoolaunch.cs

namespace Foo
{
    extern alias F1;
    public class Launch : F1.Foo.Launch
    {
        public void Method3()
        {
            Method1();
        }
    }
}

// csc /target:library /r:F1=foolaunch.dll /out:SubFooLaunch.dll subfoolaunch.cs

// using
// in file program.cs

namespace ConsoleApplication
{
    extern alias F2;
    class Program
    {
        static void Main(string[] args)
        {
            var launch = new F2.Foo.Launch();
            launch.Method3();
        }
    }
}

// csc /r:FooLaunch.dll /r:F2=SubFooLaunch.dll program.cs 
```

# wordpress - 如何在WordPress中制作框架？

> ID：10852705
> 
> 赞同：3
> 
> 时间：2012-05-21T12:10:37.653
> 
> 标签：wordpress, iframe

我需要更新我的网站，而我的网站管理员已经离开了。我对 WordPress 完全不熟悉，而且我认为自己在技术上很熟练，但我找不到如何在引用另一个 URL 的页面上制作框架。我的网站上还有其他几个页面具有类似的框架，但这些页面的代码似乎完全是空的。有什么诀窍？

要求：页面`my_page`需要嵌入一个指向`http://mysite.com`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T12:44:45.663

在页面或帖子编辑器中，您需要切换到`html tab`并插入这样的代码，在页面中需要出现的位置：-

```
<iframe src="http://google.com" name="test" height="120" width="600">You need a Frames Capable browser to view this content.</iframe> 
```

将 的值替换为`src`您要加载和调整的页面`height`以及`width`您的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:06:26.957

如果类似页面的内容（WordPress Admin）为空白，则您的网络人员可能使用了自定义模板。查看右侧，查看是否选择了自定义页面模板。

# android - getDrawable 返回 null

> ID：10852711
> 
> 赞同：3
> 
> 时间：2012-06-01T15:01:06.477
> 
> 标签：android, resources, nullpointerexception, getresource

由于我发布了与有关该问题的代码不同的代码，因此我解决了关于此问题的最后一个问题，因此我将使用正确的代码再试一次...

所以这是交易，我一直在使用适用于 Android 的 GoogleMaps API 运行一些测试，当我尝试使用我的一张图像在我的地图上设置 CustomItemizedOverlay 时，我注意到当我使用 getDrawable 访问我的图像时它返回 null 即使 Eclipse 本身显示我的图像在我选择我希望访问的可绘制对象时使用 ctrl+backspace 时我的图像在那里：/

因为这个，我已经把头从墙上打了好几个小时了。关于这里有什么问题的任何线索？

提前致谢 ：）

[PS：当我使用 ctrl + backspace http://img.photobucket.com/albums/v328/thiagoshaman/errordrawable.png](http://img.photobucket.com/albums/v328/thiagoshaman/errordrawable.png)时，打印显示 eclipse 在资源中显示我的图像

代码：

```
import java.util.List;

import android.content.res.Resources;
import android.graphics.drawable.Drawable;
import android.os.Bundle;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;
import com.google.android.maps.Overlay;
import com.google.android.maps.OverlayItem;

public class MapHandlerActivity extends MapActivity {

private MapView mapView;
private static final int latitudeE6 = 37985339;
private static final int longitudeE6 = 23716735;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    //setContentView(R.layout.main);
    setContentView(R.layout.maphandler);

    mapView = (MapView) findViewById(R.id.map_view);      
    mapView.setBuiltInZoomControls(true);

    List<Overlay> mapOverlays = mapView.getOverlays();
    Resources res = this.getResources();
    Drawable drawable = res.getDrawable(R.drawable.android_tiny_image);
    CustomItemizedOverlay itemizedOverlay = new CustomItemizedOverlay(drawable, this);
    GeoPoint point = new GeoPoint(latitudeE6, longitudeE6);
    OverlayItem overlayItem = new OverlayItem(point, "Olá", "Estou em Athena, Grécia!");

    itemizedOverlay.addOverlay(overlayItem);
    mapOverlays.add(itemizedOverlay);

    MapController mapController = mapView.getController();

    mapController.animateTo(point);
    mapController.setZoom(6);
}
@Override
protected boolean isRouteDisplayed() {
    return true;
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T16:07:53.217

尝试将图像放在所有可绘制质量文件夹中（drawable-hdpi/drawable-ldpi 等）

可能是您使用的模拟器或设备具有不同的密度，并试图从另一个文件夹中提取图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:12:46.850

试着放

```
import your.project.package.R; 
```

在您的导入中，并确保您的 R 在

```
R.drawable.android_tiny_image 
```

指向那个

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T14:10:10.123

我也遇到了这个问题，似乎在文档中是对问题的解释，如果我理解正确的话[Resources.getDrawable()](http://developer.android.com/reference/android/content/res/Resources.html#getDrawable%28int%29)

# linux - 如何让 Apache 在 OSX / XAMPP 环境中遵循符号链接？

> ID：10852717
> 
> 赞同：5
> 
> 时间：2012-06-01T15:01:21.883
> 
> 标签：linux, apache, permissions, xampp, symlink

我一直试图让 Apache 遵循符号链接。我收到“禁止访问！” 信息。

我知道这可能是权限问题。

到目前为止，我已经尝试过：

*   将源目录设置为 chmod 777
*   将 xampp/apache 用户 'nobody' 添加到组 'admin' 和 'staff'
*   符号链接和 apache 别名指令（都给我禁止的消息）

来源：

> 1228833 drwxr-xr-x 27 eric 员工 918 Jun 1 09:55 。
> 332009 drwxr-xr-x+ 40 名 eric 员工 1360 5 月 22 日 10:41 ..
> 1228879 -rw-r--r--@ 1 名 eric 员工 24580 6 月 1 日 09:55 .DS_Store
> 30604402 lrwxr-xr-x 1 名 eric 员工 6 月 93 日1 09:07 YellowFinTunaPages -> /Users/ericmiller/Dropbox/_iSirona/iSirona 产品开发/原型/YellowFinTunaPages/

目的地：

> 30602721 drwxr-xr-x 4 eric 员工 136 Jun 1 09:10 。
> 1286885 drwxr-xr-x@ 11 eric 员工 374 Jun 1 09:04 ..
> 30606068 -rw-r--r--@ 1 eric 员工 6148 Jun 1 09:10 .DS_Store
> 30602745 drwxrwxrwx 10 eric 员工 340 Jun 1 09: 05 YellowFinTunaPages

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T15:03:55.953

原来文件夹的访问权限取决于它上面的文件夹。我没有意识到这一点。我不得不 chmod 755 整个前面的目录树。我希望有一个更好的解决方案——我实际上并不想允许广泛访问整棵树，只允许访问子文件夹。

[Apache 不会遵循符号链接（403 Forbidden）](https://stackoverflow.com/questions/7381371/apache-wont-follow-symlinks-403-forbidden)

# c# - 编译器会针对布尔赋值进行优化吗？

> ID：10852722
> 
> 赞同：4
> 
> 时间：2012-06-01T15:01:44.167
> 
> 标签：c#, compiler-optimization

这就是我想要做的：

```
if(ABoolean || (BBoolean && CBoolean))
{
    SomeButton.Enabled = true;
    AnotherButton.Enabled = true;
}
else 
{
    SomeButton.Enabled = false;
    AnotherButton.Enabled = false;
} 
```

我可以将其切换为：

```
SomeButton.Enabled = (ABoolean || (BBoolean && CBoolean));
AnotherButton.Enabled = (ABoolean || (BBoolean && CBoolean)); 
```

对于更简洁的代码。我的问题是，编译器是否优化了分配，以便它会看到布尔表达式是相同的，并为第二个按钮分配它的值，还是每次都计算该值。

注意：我知道这是一个微不足道的例子，加速/减速将是微不足道的，但它会让我更好地理解编译器优化。

编辑：这就是我认为可能会优化第二个选项的原因：

```
class Program
{
    static bool ABoolean = true, BBoolean = true, CBoolean = false;
    static bool AEnable, BEnable;

    static void Main(string[] args)
    {
        Stopwatch sw = new Stopwatch();
        sw.Start();
        for (int i = 0; i < 1000000000; i++)
        {
            Operation1();
        }
        sw.Stop();
        Console.WriteLine(sw.ElapsedMilliseconds);

        Stopwatch sw1 = new Stopwatch();
        sw1.Start();
        for (int i = 0; i < 1000000000; i++)
        {
            Operation2();
        }
        sw1.Stop();
        Console.WriteLine(sw1.ElapsedMilliseconds);
        Console.Read();
    }

    static void Operation1()
    {
        if (ABoolean || (BBoolean && CBoolean))
        {
            AEnable = true;
            BEnable = true;
        }
        else
        {
            AEnable = false;
            BEnable = false;
        }
    }

    static void Operation2()
    {
        AEnable = (ABoolean || (BBoolean && CBoolean));
        BEnable = (ABoolean || (BBoolean && CBoolean));
    }
} 
```

这导致 10 亿次操作的差异约为 8-9 秒（第二个选项运行得更快）。当我添加更多“启用”布尔值时，第二个操作变得更慢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T15:04:58.483

不，我不希望*编译器*对此进行优化。*JIT*可能会优化它（因为它有更多信息），但我不希望 C# 编译器这样做。

编译器如何知道是否会产生一些可能改变,或`SomeButton.Enabled`的值的副作用？`ABoolean``BBoolean``CBoolean`

编辑：验证这个......让我们给 C# 编译器*绝对最大*的机会：

```
class Test
{
    static void Main()
    {
        Foo(true, false, true);
    }

    static void Foo(bool x, bool y, bool z)
    {
        A = x || (y && z);
        B = x || (y && z);
    }

    static bool A { get; set; }
    static bool B { get; set; }
} 
```

编译：

```
csc /o+ /debug- Test.cs 
```

`Foo`通过 ILDASM的代码：

```
.method private hidebysig static void  Foo(bool x,
                                           bool y,
                                           bool z) cil managed
{
  // Code size       37 (0x25)
  .maxstack  8
  IL_0000:  ldarg.0
  IL_0001:  brtrue.s   IL_000c
  IL_0003:  ldarg.1
  IL_0004:  brfalse.s  IL_0009
  IL_0006:  ldarg.2
  IL_0007:  br.s       IL_000d
  IL_0009:  ldc.i4.0
  IL_000a:  br.s       IL_000d
  IL_000c:  ldc.i4.1
  IL_000d:  call       void Test::set_A(bool)
  IL_0012:  ldarg.0
  IL_0013:  brtrue.s   IL_001e
  IL_0015:  ldarg.1
  IL_0016:  brfalse.s  IL_001b
  IL_0018:  ldarg.2
  IL_0019:  br.s       IL_001f
  IL_001b:  ldc.i4.0
  IL_001c:  br.s       IL_001f
  IL_001e:  ldc.i4.1
  IL_001f:  call       void Test::set_B(bool)
  IL_0024:  ret
} // end of method Test::Foo 
```

如您所见，表达式确实在两种情况下都被评估。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T15:04:31.217

> 我的问题是，编译器是否优化了分配，以便它会看到布尔表达式是相同的，并为第二个按钮分配它的值，还是每次都计算该值。

它将每次计算该值。

如果这是一个多线程应用程序怎么办。其他一些线程可能会改变它。

如果它们不是常量变量，则可以更改它们。

要优化你可以做

```
SomeButton.Enabled = AnotherButton.Enabled = (ABoolean || (BBoolean && CBoolean)); 
```

在这种情况下，它将计算一次，并将值首先分配给`AnotherButton`first 和`SomeButton`later。在作业中记住它的从右到左。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-01T15:11:26.993

不，根据我的经验，编译器不会对其进行优化，但是，您可以这样做：

```
SomeButton.Enabled = AnotherButton.Enabled = (ABoolean || (BBoolean && CBoolean)); 
```

# javascript - 选择 jqgrid 行时，“未捕获的 TypeError：无法调用未定义的方法 'indexOf'”

> ID：10852725
> 
> 赞同：1
> 
> 时间：2012-06-01T15:01:52.177
> 
> 标签：javascript, jquery, xml, jqgrid, indexof

我已经使用 jqgrid 一段时间了。选择一行时出现错误：

```
> Uncaught TypeError: Cannot call method 'indexOf' of undefined
> jquery.jqGrid.src.js:2465 $.jgrid.extend.setSelection
> jquery.jqGrid.src.js:2465 jQuery.extend.each jquery-1.7.1.js:658
> jQuery.fn.jQuery.each jquery-1.7.1.js:271 $.jgrid.extend.setSelection
> jquery.jqGrid.src.js:2460 $.fn.jqGrid jquery.jqGrid.src.js:587
> $.fn.jqGrid.each.$.before.click.bind.ts.p.datatype
> jquery.jqGrid.src.js:2235 jQuery.event.dispatch jquery-1.7.1.js:3256
> jQuery.event.add.elemData.handle.eventHandle 
```

我的网格定义在这里：

```
var sql4 = 'select id_num, est_number, customer, product, rev, w, l, fw, fl, expr1009, status, comments from schema.table where customer = "' + customer + '" and est_number = "' + est_num + '"';
$("#the_table").jqGrid({
    url:'thescript.php?sql=' + sql4,
    height: 300,
    shrinkToFit: true,
    width: 650,
    datatype: 'xml',
    mtype: 'POST',
    colNames:["ID","Estimate","Customer","Product","Rev","W","L","FW","FL","Expr1009","Status","Comments"],
    colModel:[
        {name:"id_num",index:"id_num",width:"10"},
        {name:"est_number",index:"est_number",width:"10"},
        {name:"customer",index:"customer",width:"10"},
        {name:"product",index:"product",width:"10"},
        {name:"rev",index:"rev",width:"10"},
        {name:"w",index:"w",width:"10"},
        {name:"l",index:"l",width:"10"},
        {name:"fw",index:"fw",width:"10"},
        {name:"fl",index:"fl",width:"10"},
        {name:"expr1009",index:"expr1009",width:"10"},
        {name:"status",index:"status",width:"10"},
        {name:"comments",index:"comments",width:"10"}
    ],
    rowNum:10000,
    sortname: 'id_num',
    sortorder: 'asc',
    viewrecords: true,
    gridview: true,
    caption: '',
    ondblClickRow: function(id){
        //do some stuff here
    }
})
.jqGrid('filterToolbar')
.trigger('reloadGrid'); 
```

}

我无法弄清楚问题是什么，因为网格似乎工作正常。

我注意到在下面的 jqgrid 函数中，id = 1 for ever 行（此信息包含在变量***pt***中。

```
setSelection : function(selection,onsr) {
    return this.each(function(){
        var $t = this, stat,pt, ner, ia, tpsr;
        if(selection === undefined) { return; }
        onsr = onsr === false ? false : true;
        pt=$t.rows.namedItem(selection+""); 
```

下一行是发生错误的地方。变量***pt***有 4 个节点，它们都有 id: 1。

```
if(!pt || pt.className.indexOf( 'ui-state-disabled' ) > -1 ) { return; } 
```

** 安斯维尔 **

我在. `key:true`_ 网格的每一行都有相同的 ID，因此会导致问题。我认为当您没有唯一 ID 时，最常发生错误。在你的网格中。`id_num``ColModel`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:08:47.433

我认为您应该以任何方式使用[encodeURIComponent ：](http://www.w3schools.com/jsref/jsref_encodeuricomponent.asp)

```
url: 'thescript.php?sql=' + encodeURIComponent(sql4) 
```

代替

```
url: 'thescript.php?sql=' + sql4 
```

可能您不应该将`sql`参数作为 URL 的一部分发送，而应该在 POST 数据中发送。在这种情况下你应该使用

```
url: 'thescript.php',
postData: {
    sql: function () {
        return 'select id_num, est_number, customer, product, rev, w, l, fw, fl,' +
            ' expr1009, status, comments from schema.table where customer = "' +
            customer + '" and est_number = "' + est_num + '"';
    }
} 
```

**更新**：错误将[出现](https://github.com/tonytomov/jqGrid/blob/v4.1.1/js/grid.base.js#L2464-2465)在`setSelection`. `pt.className`也是如此`undefined`。这很奇怪，但您可以验证您`id`在网格中没有重复。

# delphi - 如何最好地将我的 Delphi 数据库表呈现给 FastReport 以获取列表和聚合

> ID：10852726
> 
> 赞同：0
> 
> 时间：2012-06-01T15:01:53.470
> 
> 标签：delphi, aggregate-functions, fastreport

到目前为止，我已经花了几天的时间为在我的应用程序中使用 FastReport 奠定基础。该应用程序以 DBF 文件的形式存储设备测试结果数据，该文件包括几个固定字段（DeviceID、Passed 等）以及可变数量的结果字段，每个字段对应于可用的测量数据类型。这些字段少至一个，多至 100 个。每个字段都有一个字母代码名称，例如 OV 和 RV。总记录数可以从零到几十万。

一个特定的报告模板已经在其设计中包含了它将显示的字段名称。报告中缺少的字段将为空。

我的问题涉及设计报告的最佳方式和提供给报告的数据，以便报告构建尽可能简单 - 我将允许我的用户生成他们自己的报告 - 我需要两种报告输出- 结果和汇总列表。让我头疼的是聚合。我不仅需要 MIN、MAX、COUNT 等（如 FastReport 内部提供的那样），还需要标准偏差。此外，我想使用 FastReport 的“向下钻取”功能，您可以在其中单击组标题并显示或隐藏数据表。理想情况下，我的聚合应该在页眉中，而不是在页脚中，以便它们始终出现。

我发现 TQuery 中的 SQL 给了我很大的灵活性，因为它提供了“StDev”聚合（FastREport 没有），但据我所知，我的每个字段都需要一个固定的 TQuery。到目前为止，我能想出的最好的解决方案是在主表上使用过滤器“通过”（以便用户可以查看通过、失败或全部），然后用相同的方法构建单独的“统计”表字段名称列，但将 MIN、MAX、COUNT、MEAN、STDEV 作为单独的记录。然后，我将使用 TfrxDBDataSet 将此表公开给 FastReport。我看到我也可以使用 FastReport 自己的 ADODatabase 和 ADOQuery 来直接访问我的 DBF 文件。这很好用，但如果可能的话，我不想在报告中向我的用户公开这个访问层。

当聚合函数必须是基本的数据库要求时，这似乎很混乱。我错过了一种更简单的方法吗？我已经完成了 FastReport（专业）提供的（优秀）演示，并且我正在使用 XE2。如果我需要自己计算 StDev，我也知道 MATH 单元中的有用函数。

我将不胜感激任何指导，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T19:47:04.077

对于您可以在代码中计算的任何内容、数组值列表、聚合或函数计算结果，我更喜欢使用`TfrxUserDataSet`并实现`TfrxReport.OnGetvalue`事件。

尽管最初可能会令人困惑，但用户数据集只是声明了一个数据集名称，以及通过该数据集名称可用的字段列表，并使用触发的事件让您“导航”（第一条，下一条记录）并声明您何时'已达到计算数据的末尾。这允许您构建一个“生成器”，或者只是一个用于计算的普通虚拟数据提供者逻辑集。

这是我的 OnGetValue 事件的样子：

```
procedure TfrmReport.frxReportGetValue(const VarName: string; var Value: Variant);
begin
   Value := GetReportValue(VarName);
end;

// INPUT:  VarName = '(<GlobalArea."hdReportTitle">)'
// OUTPUT: tableName = 'GlobalArea', fieldName = 'hdReportTitle'
function ParseVar(const VarName:String; var tableName,fieldName:String; var ParenFlag:Boolean):Boolean;
var
 paVarName:String;
 angleBracketFlag:Boolean;
 dotPos:Integer;
 fieldQuoteFlag:Boolean;
 procedure RemoveOuter(var str:String; initialChar,finalChar:Char; var flag);
 var
  n:Integer;
 begin
    n := Length(str);
   if n>2 then begin
      ParenFlag := (str[1]=initialChar) and (str[n]=finalChar);
      if ParenFlag then begin
         str := Copy(str,2,n-2);

      end;
   end;
 end;
begin
   result := false;
   fieldQuoteFlag := false;
   paVarName := SysUtils.Trim(VarName);
   ParenFlag := false;
   tableName := '';
   fieldName := '';
   RemoveOuter(paVarName, '(',')',parenFlag);
   RemoveOuter(paVarName,'<','>',angleBracketFlag);
   dotPos := Pos('.',paVarName);
   if dotPos >0 then begin
    tableName := Copy(paVarName,1,dotPos-1);
    fieldName := Copy(paVarName,dotPos+1,Length(paVarName));
    RemoveOuter(fieldName, '"','"',fieldQuoteFlag);
    result := true;
   end else begin
      tableName := '';
      fieldName := paVarName;
   end;
end;

function TfrmProfitAnalysisReport.GetReportValue(const VarName:String):Variant;
var
 tableName:String;
 fieldName:String;
 parenFlag:Boolean;
begin
 ParseVar(VarName,tableName,fieldName,parenFlag);
 result := NULL;
   { Global Area - Header Values }
 if sameText(tableName,'GlobalArea') then begin
   if fieldName='hdReportTitle' then
      result := GetTitle; { A function that calculates a title for the report }
   else if fieldName='hdReportSubtitle' then
      result := 'Report for Customer XYZ'
   else if fieldName='....' then begin
      ...
   end;

   if Variants.VarIsNull( result) then
      result :=  '?'+fieldName+'?';

end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:25:03.743

好吧，很多问题都有很多可能的答案：

1）关于数据集，我真的建议将它们放在您的应用程序（DataModule 或 Form）中，而不是在报表中使用它们。它会给你更多的灵活性；

2) 每个聚合可以有一个查询，但是如果您的数据表以大量记录增长，这将影响性能。一些替代方案：

*   2.1) 计算 FastReport 脚本中的值，但这也会将逻辑暴露给报表；
*   2.2）遍历Delphi代码上的记录，并将结果作为变量传递给您的报告。例子：

    ```
    frxReport.Variables['MIN'] := YourMinVariableOrMethod;
    frxReport.Variables['MAX'] := YourMaxVariableOrMethod; 
    ```

*   2.3) 使用与您的查询关联的 ClientDataSet 并在 ClientDataSet 上实现 TAggregateFields。

我个人更喜欢 2.2 方法，所有逻辑都在 Delphi 代码中，简单而强大。

# javascript - 动态下拉列表值javascript

> ID：10852729
> 
> 赞同：1
> 
> 时间：2012-06-01T15:02:08.637
> 
> 标签：javascript, html

我想用动态值填充我的下拉列表，但列表仍然为空，换句话说，没有显示任何选项有人能帮帮我吗！！！这是我的代码[http://jsfiddle.net/n6ahz/24/](http://jsfiddle.net/n6ahz/24/)

```
var newdiv = document.createElement('div');
var text="TEXT";
var n=0;
newdiv.innerHTML += "<br> Question " + (n) + " : " + text + " ? <br><br>";
var m = 0;

var options = '';
for (var j = 1; j < 5; j++) {
 var val = "marwa" + j;
if (val) {
    m++;
    options += " <option value="+j+"> " + val + "</option>";
     }
 }
 newdiv.innerHTML += "<select name='single' id='single'>";
 newdiv.innerHTML += " "+options + " </select> ";

document.getElementById('results').appendChild(newdiv);​ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T15:04:59.273

代替

```
newdiv.innerHTML += "<select name='single' id='single'>";
newdiv.innerHTML += " "+options + " </select> "; 
```

尝试

```
newdiv.innerHTML += "<select name='single' id='single'> "+options + " </select> "; 
```

我认为一次添加一点 HTML 是行不通的，因为浏览器会尝试立即呈现它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T15:07:43.577

With `innerHTML`, the actual DOM gets updated everytime you make a change. So you can't reliably make piecemeal changes like you're doing. Create a variable like `var html` and save all your HTML updates into it, then set `element.innerHTML = html`.

```
var newdiv = document.createElement('div');
var html = "";
var text="TEXT";
var n=0;
html += "<br> Question " + (n) + " : " + text + " ? <br><br>";
var m = 0;

var options = '';
for (var j = 1; j < 5; j++) {
 var val = "marwa" + j;
 if (val) {
    m++;
    options += " <option value="+j+"> " + val + "</option>";
 }
}
html += "<select name='single' id='single'>";
html += " "+options + " </select> ";
newdiv.innerHTML = html;

document.getElementById('results').appendChild(newdiv);​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:18:10.547

```
var newdiv = document.createElement('div');
var text="TEXT";
var n=1;
newdiv.innerHTML += "<br> Question " + (n) + " : " + text + " ? <br><br>";
var m = 1;

var options = '';
for (var j = 0; j <= 5; j++) {
     var val = "marwa" + j;
if (val) {
        m++;
        options += " <option value="+j+"> " + val + "</option>";
         }
    }
newdiv.innerHTML += "<select name='single' id='single'  "+options + " </select> ";

document.getElementById('results').appendChild(newdiv);​ 
```

# bash - 我想要我的 bash 脚本以 html 格式输出？

> ID：10852731
> 
> 赞同：0
> 
> 时间：2012-06-01T15:02:15.213
> 
> 标签：bash

我正在使用 bash 脚本解析 csv 文件，我的输出将采用包含行数和列数的表格形式，因此当我将输出重定向到文本文件对齐不匹配并且看起来很乱时。

任何人都可以指导我如何将我的输出重定向到 html 格式或用任何其他替代方式建议我。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:49:26.883

如果您真的不需要 HTML 格式的输出，但在使用制表符进行列对齐时遇到问题，您可以使用`printf`.

顺便说一句，如果您的问题包含一些示例输入、您用来解析和输出它的脚本以及一些示例输出，那将会有所帮助。

这是一个简单的演示`printf`：

```
$ cat file
example text,123,word,23.12
more text,1004,long sequence of words,1.1
text,1,a,1000.42

$ cat script
#!/bin/bash
headformat='%-*s%-*s%*s%*s\n'
format='%-*s%-*s%*d%*.*f\n'
modwidth=16; descwidth=24; qtywidth=6; pricewidth=10
printf "$headformat" "$modwidth" Model "$descwidth" Desc. "$qtywidth" Qty "$pricewidth" Price
while IFS=, read model quantity description price
do
    printf "$format" "$modwidth" "$model" "$descwidth" "$description" "$qtywidth" "$quantity" "$pricewidth" 2 "$price"
done < file

$ ./script
Model           Desc.                      Qty     Price
example text    word                       123     23.12
more text       long sequence of words    1004      1.10
text            a                            1   1000.42 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T12:26:21.020

一个简单的解决方案将使用 column(1)：

```
column -t -s, <( echo "head1,head2,head3,head4"; cat csv.dat ) 
```

结果是这样的：

```
head1  head2     head3   head4
aaaa   33333     bbb     123
aaa    333333    bbbx    123
aa     3333333   bbbxx   123
a      33333333  bbbxxx  123 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:08:32.830

将它写在 TSV 中，然后让 XSLT 样式表将其从 TSV 转换为 XHTML。您可以`$'\t'`在 bash 中使用来生成制表符。

# r - 如何使用 R 中的 plyr 包创建与给定列的级别对应的新数据框列？

> ID：10852733
> 
> 赞同：0
> 
> 时间：2012-06-01T15:02:17.677
> 
> 标签：r, plyr, reshape

我正在寻找一种“优雅”的方法来基本上按一个列变量的级别拆分数据框，然后创建一个新的输出数据框，重新整形以现在删除因子变量并为因子变量的级别添加新列。我可以使用诸如 split() 方法之类的函数来做到这一点，但这对我来说似乎是一种混乱的方式。我一直在尝试使用 plyr 包中的 melt() 和 cast() 函数来做到这一点，但没有成功获得我需要的确切输出。

这是我的数据的样子：

```
> jumbo.df = read.csv(...)
> head(jumbo.df)
         PricingDate  Name     Rate 
    186  2012-03-05   Type A   2.875  
    187  2012-03-05   Type B   3.250  
    188  2012-03-05   Type C   3.750  
    189  2012-03-05   Type D   3.750  
    190  2012-03-05   Type E   4.500  
    191  2012-03-06   Type A   2.875 
```

我想做的是按变量*name*拆分，删除*Name*和*Rate*，然后输出*Type A*、*Type B*、*Type C*、*Type D*和*Type E*的列，并带有相应的 Rate 系列，其中 Date 为 ID：

```
> head(output.df)
         PricingDate  Type A   Type B    Type C    Type D    Type E 
         2012-03-05    2.875    3.250     3.750     3.750     4.500  
         2012-03-06    2.875    ... 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T15:27:26.137

不确定我是否正确，但您是否只是想将数据重塑为宽格式？如果是这样，您必须使用(!) 包的`melt`和`cast`功能。基本相同。由于您的数据已经是熔融格式，即长格式，单行器可以满足您的要求：`reshape``reshape2`

```
df <- read.table(textConnection("PricingDate  Name     Rate 
                                 2012-03-05   TypeA   2.875  
                                 2012-03-05   TypeB   3.250  
                                 2012-03-05   TypeC   3.750  
                                 2012-03-05   TypeD   3.750  
                                 2012-03-05   TypeE   4.500  
                                 2012-03-06   TypeA   2.875"), header=TRUE, row.names=NULL)
library(reshape2)
dcast(df, PricingDate ~ Name)
Using Rate as value column: use value.var to override.
  PricingDate TypeA TypeB TypeC TypeD TypeE
1  2012-03-05 2.875  3.25  3.75  3.75   4.5
2  2012-03-06 2.875    NA    NA    NA    NA 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:34:27.943

```
library(plyr)
library(reshape2)

    data <- structure(list(PricingDate = c("2012-03-05", "2012-03-05", "2012-03-05", 
    "2012-03-05", "2012-03-05", "2012-03-06", "2012-03-06", "2012-03-06", 
    "2012-03-06", "2012-03-06"), Name = c("Type A", "Type B", "Type C", 
    "Type D", "Type E", "Type A", "Type B", "Type C", "Type D", "Type E"
    ), Rate = c(2.875, 3.25, 3.75, 3.75, 4.5, 4.875, 5.25, 6.75, 
    7.75, 8.5)), .Names = c("PricingDate", "Name", "Rate"), class = "data.frame", row.names = c("186", 
    "187", "188", "189", "190", "191", "192", "193", "194", "195"
    ))

    > data
        PricingDate   Name  Rate
    186  2012-03-05 Type A 2.875
    187  2012-03-05 Type B 3.250
    188  2012-03-05 Type C 3.750
    189  2012-03-05 Type D 3.750
    190  2012-03-05 Type E 4.500
    191  2012-03-06 Type A 4.875
    192  2012-03-06 Type B 5.250
    193  2012-03-06 Type C 6.750
    194  2012-03-06 Type D 7.750
    195  2012-03-06 Type E 8.500

    ddply(data, .(PricingDate), function(x) reshape(x, idvar="PricingDate", timevar="Name", direction="wide"))

    PricingDate Rate.Type A Rate.Type B Rate.Type C Rate.Type D
    1  2012-03-05       2.875        3.25        3.75        3.75
    2  2012-03-06       4.875        5.25        6.75        7.75
      Rate.Type E
    1         4.5
    2         8.5 
```

# selenium - 硒测试结果为空

> ID：10852736
> 
> 赞同：0
> 
> 时间：2012-06-01T15:02:33.713
> 
> 标签：selenium, jenkins, continuous-integration, automated-tests

> **可能重复：**
> [selenium RC 不运行整个测试套件](https://stackoverflow.com/questions/5671511/selenium-rc-doesnt-run-the-whole-test-suite)

我已经将 Jenkins 和 selenium 配置为在构建应用程序后运行测试，一切正常，直到 selenium 测试应该运行的那一刻，实际上 selenium 测试套件正确启动，然后在第一次测试后停止并且不继续。

我正在使用 VNC 来观察正在发生的事情。

selenium 产生的日志是空的。

我通过以下方式测试这些测试

```
java -jar /var/lib/selenium/selenium-server-jar -browserSessionReuse  -htmlSuite *firefox https://test-a.4pm.si /var/lib/jenkins/jobs/4pm_test/workspace/4pm_ee-test/selenium_tests/suite.html /var/lib/jenkins/jobs/4pm_test/workspace/selenium-result.html 
```

selenium-result.html 是空的，它只执行第一个测试就可以了并停在那里

我需要设置任何硒服务器设置吗？

# python - libmysqlclient_r.18.dylib 来自 /usr/local/mysql/lib/ MacOS

> ID：10852739
> 
> 赞同：1
> 
> 时间：2012-06-01T15:02:43.390
> 
> 标签：python, django, macos, mysql-python

我做到了`brew remove mysql`。之后，我再次从 dmg 重新安装 mysql。但现在我无法运行我的 django 项目。它向我展示了：

```
ImproperlyConfigured: Error loading MySQLdb module: dlopen(/Users/polinom/workspace/agents/eggs/MySQL_python-1.2.3-py2.7-macosx-10.7-intel.egg/_mysql.so, 2): Library not loaded: /usr/local/lib/libmysqlclient.18.dylib
  Referenced from: /Users/polinom/workspace/agents/eggs/MySQL_python-1.2.3-py2.7-macosx-10.7-intel.egg/_mysql.so
  Reason: image not found 
```

这无济于事：`sudo ln -s /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/local/lib/libmysqlclient.18.dylib`

这无济于事：`export DLYD_LIBRARY_PATH=/usr/local/mysql/lib`

我发现没有文件`/usr/local/lib/libmysqlclient.18.dylib`。即使在这里也没有`/usr/local/mysql/lib/`。位于该文件夹中的唯一库是：

```
libmysqlclient.15.dylib    libmysqlclient_r.15.dylib  libndbclient.2.dylib       libndbclient.la
libmysqlclient.dylib       libmysqlclient_r.dylib     libndbclient.dylib 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:58:11.060

如果您这次是从 DMG 安装的，请尝试在 /usr/local/ 中查找类似的文件

```
mysql-5.5.24-osx10.6-x86_64 
```

如果你有那个版本或更新的版本，`libmysqlclient.18.dylib`就会在那里，你只需要确保你到 /usr/local/mysql 的符号链接正确地链接到那个版本。您可能还必须将它添加到您的路径中，DMG 安装程序在为我设置这些东西方面做得很糟糕。

如果您的版本早于上述版本，则可能需要获取 DMG 的较新副本并重新安装。希望这可以帮助！

# android - Android ViewPager 上一个/下一个按钮

> ID：10852744
> 
> 赞同：51
> 
> 时间：2012-06-01T15:03:03.120
> 
> 标签：android, button, navigation, android-viewpager

好的，所以我正在开发一个使用 ViewPager 来显示页面的 Android 应用程序。

在每个页面中，我都有一组按钮用于在页面之间导航（除了页面之间的滑动）。这些按钮用于“第一页”、“上一页”、“下一页”和“最后一页”。

我不知道该怎么做是设计一种机制来启用按钮单击时的页面更改。

有人有想法么？

ETA：为了更好地解释设置，按钮在每个页面的布局中声明，并与 PagerAdapter 中的其余布局一起膨胀。我的问题是我无法从 PagerAdapter 中引用 ViewPager。或者至少，我想不出一种方法来做到这一点。

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2012-11-08T09:17:31.167

按钮：

```
Button yourButton = (Button)findViewById(R.id.button1);
    yourButton.setOnClickListener(new OnClickListener() {

     @Override
           public void onClick(View view) {
               mViewPager.setCurrentItem(getItem(+1), true); //getItem(-1) for previous
           }
        }); 
```

功能：

```
private int getItem(int i) {
       return mViewPager.getCurrentItem() + i;
} 
```

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-06-01T15:22:05.457

```
yourButton.setOnClickListener(new OnClickListener() {
   @Override
   public void onClick(View view) {
      yourViewPager.setCurrentItem(page, smoothScroll);
   }
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-08-02T06:37:41.947

1）制作布局

```
 <RelativeLayout
                android:layout_width="match_parent"
                android:layout_height="200dp"
                android:background="@color/white"
                android:weightSum="1">

                <android.support.v4.view.ViewPager
                    android:id="@+id/images_pager"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    >
                </android.support.v4.view.ViewPager>

                <ImageView
                    android:id="@+id/img_next"
                    android:layout_width="35dp"
                    android:layout_height="35dp"
                    android:src="@drawable/forward_white"
                    android:background="@color/colorPrimary"
                    android:layout_centerVertical="true"
                    android:layout_alignParentRight="true"
                    android:layout_marginRight="5dp"
                    android:paddingTop="5dp"
                    android:paddingBottom="5dp"
                    />

                <ImageView
                    android:id="@+id/img_previous"
                    android:layout_width="35dp"
                    android:layout_height="35dp"
                    android:src="@drawable/back_white"
                    android:background="@color/colorPrimary"
                    android:layout_centerVertical="true"
                    android:layout_marginLeft="5dp"
                    android:layout_alignParentLeft="true"
                    android:paddingTop="5dp"
                    android:paddingBottom="5dp"/>

            </RelativeLayout> 
```

2）设置自定义适配器

```
 CustomViewPagerAdapter  custompageradpter;
        ViewPager   mViewPager;
        mViewPager = (ViewPager)shareImagesDialouge.findViewById(R.id.images_pager); 
         custompageradpter = new CustomViewPagerAdapter(this);
         mViewPager.setAdapter(custompageradpter);

    public class CustomViewPagerAdapter  extends PagerAdapter {

        Context mContext;
        LayoutInflater mLayoutInflater;

        int[] mResources = {
                R.drawable.emoji_1,
                R.drawable.emoji_2,
                R.drawable.emoji_3,
                R.drawable.emoji_4,
                R.drawable.emoji_5,
                R.drawable.emoji_6
        };

        public CustomViewPagerAdapter(Context context) {
            mContext = context;
            mLayoutInflater = (LayoutInflater) mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        }

        @Override
        public int getCount() {
            return mResources.length;
        }

        @Override
        public boolean isViewFromObject(View view, Object object) {
            return view == ((LinearLayout) object);
        }

        @Override
        public Object instantiateItem(ViewGroup container, int position) {
            View itemView = mLayoutInflater.inflate(R.layout.pager_item, container, false);

            ImageView imageView = (ImageView) itemView.findViewById(R.id.imageView);
            imageView.setImageResource(mResources[position]);

            container.addView(itemView);

            return itemView;
        }

        @Override
        public void destroyItem(ViewGroup container, int position, Object object) {
            container.removeView((LinearLayout) object);
        }

    } 
```

3) 对于下一个和上一个按钮

```
 case R.id.img_previous:
                    mViewPager.setCurrentItem(getItemofviewpager(-1), true);
                    break;

                case R.id.img_next:
                    mViewPager.setCurrentItem(getItemofviewpager(+1), true);
                    break; 
```

4）制作这个功能

```
 private int getItemofviewpager(int i) {
        return mViewPager.getCurrentItem() + i;
    } 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-02-23T10:46:06.007

对[sweggersen](https://stackoverflow.com/a/13285950/3682535)和[Alex Orlov 的](https://stackoverflow.com/a/10853057/3682535)回答进行防故障升级，

```
// For scrolling to next item
nextPageButton.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View view) {
        viewPager.setCurrentItem(getNextPossibleItemIndex(1), true);
    }
});

// For scrolling to previous item
previousPageButton.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View view) {
        viewPager.setCurrentItem(getNextPossibleItemIndex(-1), true);
    }
}); 
```

在 Activity/Fragment 中添加 getNextPossibleItemIndex() 方法，

```
private int getNextPossibleItemIndex (int change) {

    int currentIndex = viewPager.getCurrentItem();
    int total = viewPager.getAdapter().getCount();

    if (currIndex + change < 0) {
        return 0;
    }

    return Math.abs((currentIndex + change) % total) ;
} 
```

这样，您将能够更改 currentItem 而不必担心[Heinrich 的评论所建议的](https://stackoverflow.com/questions/10852744/android-viewpager-prev-next-button#comment58527209_13285950)IndexOutOfBoundsException 。请注意，使用此方法，项目将显示为圆形列表。

```
1 -> 2 -> 3 -> 1 -> 2 -> 3 -> 1 
```

但回过头来，它会停在第一个项目

```
1 <- 1 <- 2 <- 3 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-03-19T13:30:08.520

像这样做：

```
backButton=(Button)findViewById(R.id.back_button);
nextButton=(Button)findViewById(R.id.next_button);
backButton.setVisibility(View.INVISIBLE);//you can use GONE or even disable it. It depends on your layout 

    nextButton.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View view) {
            viewPager.setCurrentItem(viewPager.getCurrentItem()+1, true);
        }
    });

    backButton.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View view) {
            viewPager.setCurrentItem(viewPager.getCurrentItem()-1, true);
        }
    });
} 
```

为了防止 IndexOutOfBoundsException 你应该像这样隐藏和显示两个按钮：

```
 viewPager.addOnPageChangeListener(new ViewPager.OnPageChangeListener() {
        @Override
        public void onPageScrolled(int i, float v, int i1) {

        }
        @Override
        public void onPageSelected(int position) {
            if(position==0) {
                backButton.setVisibility(View.INVISIBLE);
            }else  {
                backButton.setVisibility(View.VISIBLE);
            }
            if(position < viewPager.getAdapter().getCount()-1 ) {
                nextButton.setVisibility(View.VISIBLE);
            }else  {
                nextButton.setVisibility(View.INVISIBLE);
            }
        }
        @Override
        public void onPageScrollStateChanged(int i) {

        }
    }); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-07-05T06:45:50.063

我用这段代码完成了这个项目。

```
vPager = (ViewPager) findViewById(R.id.viewpager);
    View tempView1 = inflater.inflate(R.layout.ani_dialog1, null);
    firstView = (ImageView) tempView1.findViewById(R.id.ani_dialog_next);
    views.add(tempView1);
    firstView.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            vPager.setCurrentItem(1, true);

        }
    }); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-04-01T05:19:26.153

**更新代码**

```
Button preButton = (Button)findViewById(R.id.pre_button);
        Button nextButton = (Button)findViewById(R.id.next_button);

        preButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {

                mViewPager.setCurrentItem(mViewPager.getCurrentItem()-1, true); 

            }
        });

        nextButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {

                mViewPager.setCurrentItem(mViewPager.getCurrentItem()+1, true); 

            }
        }); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-17T12:39:53.930

首先创建一个接口

```
public interface OnPageChangedListener {
void OnPageChanged(int position);      } 
```

Next 使用 OnPageChangedListener 接口实现您的活动并执行以下操作

```
private void setupViewPager(ViewPager viewPager){
    viewPagerAdapter = new ViewPagerAdapter(getSupportFragmentManager());
    viewPagerAdapter.addFragment(new Fragment1(this));
    viewPagerAdapter.addFragment(new Fragment2(this));
    viewPagerAdapter.addFragment(new Fragment3(this));
    viewPagerAdapter.addFragment(new Fragment4(this));
    viewPagerAdapter.addFragment(new Fragment5(this));
    viewPagerAdapter.addFragment(new Fragment6(this));
    viewPager.setAdapter(viewPagerAdapter);
}
@Override
public void OnPageChanged(int position) {
    viewPager.setCurrentItem(position);
} 
```

在您的片段中使用创建一个构造函数

```
private OnPageChangedListener listener;

public Fragment1(OnPageChangedListener listener1) {
    this.listener = listener1;
} 
```

ViewPagerAdapter

```
public class ViewPagerAdapter extends FragmentPagerAdapter {
private final List<Fragment> mFragmentList = new ArrayList<>();

public ViewPagerAdapter(FragmentManager manager) {
    super(manager);
}

@Override
public Fragment getItem(int position) {
    switch (position) {
    }
    return mFragmentList.get(position);
}

@Override
public int getCount() {
    return mFragmentList.size();
}

public void addFragment(Fragment fragment) {
    mFragmentList.add(fragment);
}} 
```

希望这可以帮助你

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2016-10-12T20:21:46.033

```
public void onClick(View v) {
     int currentItem = mViewPager.getCurrentItem();
     mViewPager.setCurrentItem(currentItem+1); //(currentItem-1)
} 
```

只有这个代码在按钮点击： `@Override`

`getcurrentitem`是 中的实际项目`viewpager`，下一个项目是`currentItem + 1`

# android - Android ndk freetype2

> ID：10852748
> 
> 赞同：4
> 
> 时间：2012-06-01T15:03:27.650
> 
> 标签：android, c, android-ndk, freetype

我正在尝试在 Android NDK 中添加对 freetype2 的支持。

我已经成功构建了库，但我应该如何将它包含在 Android.mk 文件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T15:08:52.407

在一开始的时候：

```
include $(CLEAR_VARS)
LOCAL_MODULE    := libFreeType
LOCAL_SRC_FILES := jni/$(TARGET_ARCH_ABI)/libFreeType.a
include $(PREBUILT_STATIC_LIBRARY) 
```

稍后的：

```
LOCAL_STATIC_LIBRARIES += FreeType 
```

# java - 带有图片和文字的自定义按钮？

> ID：10852749
> 
> 赞同：0
> 
> 时间：2012-06-01T15:03:30.840
> 
> 标签：java, android, eclipse

我想在按钮中添加图片和文本，如下所示。 ![我的自定义按钮](../Images/e471282b55154ca23f337cfb7a152e6c.png)

如果我把它作为背景，那么它会根据不同手机的屏幕尺寸而恶化。所以我想自定义绘制自定义布局，其中信息按钮的图像将保持在相同的像素中，而信息字母将被单独绘制。这样我就可以在没有任何图像失真的情况下获得准确的外观。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:08:52.743

您可以指定背景图像，“！” 图标和文本分别像这样：

```
<Button
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:background="@drawable/background"
android:drawableLeft="@drawable/icon"
android:text="info" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:13:32.830

使用 9 补丁作为背景，使用普通按钮，使用可绘制左侧作为左侧图像。这是处理您的案件的最佳方式。

检查[这个](http://developer.android.com/guide/topics/graphics/2d-graphics.html#nine-patch)9-patch。这将使您可以根据需要创建带有圆角的背景，而不会倾斜它们。

所以最后你会有一个普通的按钮，背景是你从 9-patch 和你设置图标的 drawableLeft。

如果您想要更好的用户体验，请查看[此](http://www.gersic.com/blog.php?id=56)内容以定义按钮状态。您仍然需要执行所有这些操作，然后为按钮背景定义状态并将其用作背景。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:15:26.657

你可以使用这三个drawable作为你的背景名称一个文件backround.xml在你的res/drawable文件夹中这个文件将处理你在不同状态下的按钮背景按下，聚焦和正常：

这些是您可以使用的三个 9-patch 可绘制对象：

![在此处输入图像描述](../Images/f30225932ee6829bec30d5485e5c6664.png)

![在此处输入图像描述](../Images/bce23dae4160f0464fc3c7b6e43729f8.png)

![在此处输入图像描述](../Images/780870702eb8a603b15bb0cc4490d935.png)

backround.xml 是：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item 
        android:state_pressed="true" 
        android:state_enabled="true"
        android:drawable="@drawable/btn_orange" />
    <item 
        android:state_focused="true" 
        android:state_enabled="true"
        android:drawable="@drawable/btn_orange" />

    <item 
        android:state_enabled="true"
        android:drawable="@drawable/btn_black" />
    <item 
        android:state_enabled="false"
        android:drawable="@drawable/btn_red" />
</selector> 
```

您的 xml 按钮将如下所示：

```
 <Button
      android:id="@+id/my_btn"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:drawableLeft="@drawable/myIcon"
      android:drawablePadding="5dp"
      android:paddingLeft="10dp"
      android:text="info"
      android:background="@drawable/background" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T15:08:50.643

您需要在 Button 小部件中安排 3 件事`background image, info icon and text`：对于这些使用这些：

```
android:background="backgroundImage"
android:drawableLeft="info icon"
android:text="text" 
```

# cloud - 使用 Ant（迁移工具）部署但无法运行的应用程序

> ID：10852751
> 
> 赞同：0
> 
> 时间：2012-06-01T15:03:32.857
> 
> 标签：cloud, salesforce, apex-code

我正在开发一个应用程序，在该应用程序中，我从一个对象中检索记录，然后想要将（的某些字段）记录插入到不同的对象中。下面是我的代码，我无法弄清楚为什么我的对象没有被填充并且看不到新记录。

//调度器相关类1

```
public with sharing class ScheduleBatchLauncher{
public static String scheduleBatch(Datetime batchTime){
    CreateAndModifyScheduler batchSched = new CreateAndModifyScheduler();
    String cron = '20 25 * * * ?';
    String schedId = System.schedule('Create and Modify Batch 1', cron, batchSched);       
    return schedId;
}
} 
```

//调度器相关类2

```
global class CreateAndModifyScheduler implements Schedulable{
global void execute(SchedulableContext sc) {
  CreateAndModify scBatch = new CreateAndModify(); 
  database.executebatch(scBatch);
}
} 
```

// 批量 Apex 相关类 1

```
global class CreateAndModify implements
Database.Batchable<sObject>, Database.Stateful{

global CreateAndModifyProcessor processor;
global CreateAndModify(){
        this.processor = new CreateAndModifyProcessor();
    }

global Database.queryLocator start
    (Database.BatchableContext BC){
        return Database.getQueryLocator([Select Agreement_ID__c, Begining__c,
                                        Contact_Email__c, Contact_Name__c,
                                        Country_Code__c, Currency__c,
                                        Customer_Address__c, Customer_ID__c,
                                        Customer_Name__c,Customer_Postal_Code__c,
                                        Ending__c,Price__c FROM Unprocessed_Agreement__c]);
        }

global void execute(
    Database.BatchableContext BC, 
    List<sObject> listObj){

        list <Account__c> inAcc = new list<Account__c>();

        for (sObject lo : listObj){
            Unprocessed_Agreement__c temp = (Unprocessed_Agreement__c)lo;

            inAcc.add(processor.processAccountRecord(temp));    
            }
        insert(inAcc);
        update(inAcc)
      }

global void finish(
    Database.BatchableContext BC){
    }
} 
```

// 批量 Apex 相关类 2

```
global class CreateAndModifyProcessor {
global Account__c processAccountRecord( Unprocessed_Agreement__c temp){
    Account__c tempAcc = new Account__c();
    tempAcc.Customer_Name__c = temp.Customer_Name__c;
    tempAcc.Customer_Address__c = temp.Customer_Address__c;
    tempAcc.Postal_Code__c = temp.Customer_Postal_Code__c;
    return tempAcc;
}   
} 
```

请如果有人可以看看它。另外，如果有人想看我的 build.xml 或 package.xml 请告诉..谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T19:28:01.050

您正在运行计划的批处理作业，因此系统会监控每次执行。检查设置 - 管理设置 - 监控 - 顶点作业是否有错误。另一个调试选项是使用匿名执行（在 eclipse 或 ui 中）手动执行您的作业并检查日志。

# c# - 无法在文本输入中设置值

> ID：10852762
> 
> 赞同：0
> 
> 时间：2012-06-01T15:04:09.243
> 
> 标签：c#, watin

我的页面中有一个框架。我正在尝试使用以下内容更改输入字段：

```
Frame.TextField(Find.ById("blah")).Value ="test"; 
```

这设置了值，但是当我提交表单时，什么也没有发生，因为在输入信息时对输入进行了一些验证。

如果我有以下

```
Frame.TextField(Find.ById("blah")).TypeText("test"); 
```

输入框内没有文字会突出显示。我得到一个超时。可能出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T05:59:27.010

约翰 - 继续使用您的代码

```
Frame.TextField(Find.ById("blah")).Value ="test"; 
```

但也许然后单击其他字段，以便浏览器验证该值。另一方面 - 你得到什么错误？你能给我们一个代码片段吗

# android - 是否可以使用 xml 文件创建图像

> ID：10852771
> 
> 赞同：0
> 
> 时间：2012-06-01T15:04:50.023
> 
> 标签：android, bitmap, touch, imageview

我正在尝试通过 xml 文件创建图像。我想问是否可以这样做

以下是我想创建为图像以便在图像视图中显示的 XML 文件的代码。

**主要活动**

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);

        setContentView(R.layout.main);
spinner2 = (Spinner) findViewById(R.id.spinner1);
imageshow =(ImageView) findViewById(R.id.imageshow);
items = fillMaps();

        SimpleAdapter adapter=new SimpleAdapter(this,items,R.layout.spinner,
                new String[]{"name"},
                new int[]{R.id.title});

        spinner2.setAdapter(adapter);

        spinner2.setOnItemSelectedListener(new MyOnItemSelectedListener());

        spinner2.setVisibility(View.VISIBLE);} 
```

布局/main.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/bible_help_title" />

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/layout_1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal" 
         android:layout_below="@id/bible_help_title">

    <Spinner
        android:id="@+id/spinner1"
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content" 
        android:prompt="@string/bible_help_title"
        android:drawSelectorOnTop="true"
        />
</RelativeLayout>

    <ImageView 
        android:id="@+id/imageshow"
        android:layout_width="fill_parent" 
        android:layout_height="fill_parent" 
        android:layout_below="@id/layout_1"/>  

</RelativeLayout> 
```

**用户从 Spinner 中选择资源后，调用 showimagetask**

```
public class MyOnItemSelectedListener implements OnItemSelectedListener {
            public void onItemSelected(AdapterView<?> arg0, View arg1, int `arg2,long arg3) {`

                new showimagetask(arg2).execute(arg2);

                //if (!snoop.isRecycled()) { snoop.recycle();}

            }

            public void onNothingSelected(AdapterView<?> arg0) {

            }
} 
```

**显示图像任务**

```
 public class showimagetask extends AsyncTask<Integer, Void, Bitmap> 
        {
    ProgressDialog dialog;
    int checkid;

    String Map_name;
    String Drawing_1;
    int resID;

     public showimagetask(int id) {
            checkid = id;

            HashMap map = (HashMap)items.get(id);
            Map_name= map.get("name").toString();
            Drawing_1= map.get("Drawing").toString();
            resID = getResources().getIdentifier(Drawing_1, "raw", "tool.mobile");  

        }

    @Override
    protected void onPreExecute() {
        super.onPreExecute();

        dialog =new ProgressDialog(BibleHelpActivity.this);
        dialog.setTitle(Map_name);
        dialog.setMessage("Loading");
        dialog.show();

        imageshow.setImageBitmap(null);
        snoop=null;
        System.gc();

    }

    @Override
    protected Bitmap doInBackground(Integer... params) {
        // TODO Auto-generated method stub
        snoop= BitmapFactory.decodeStream(getResources().openRawResource(resID));
        //Bitmap snoop = BitmapFactory.decodeResource(getResources(), resID);

        return snoop;
    }
    protected void onPostExecute(Bitmap result) {
        /*
        TouchImageView imageshow = imageButtonReference.get();
         */

        imageshow.setImageBitmap(snoop);
        imageshow.setTag(resID);
        dialog.dismiss();

     }

}

private List<HashMap<String, String>> fillMaps()

{
    List<HashMap<String, String>> items = new ArrayList<HashMap<String,String>>();

    HashMap<String,String> i = new HashMap<String,String>();
        i.put("name","EricPhoto");
        i.put("Drawing", "img_101");
        items.add(i);
                    i = new HashMap<String,String>();
                    i.put("name","PeterPhoto");
            i.put("Drawing", "img_102");
            items.add(i);
        i = new HashMap<String,String>();
        i.put("name","Schedule");
        i.put("Drawing", "table_1");
        items.add(i);
return items;
    } 
```

原始文件夹中的文件

```
img_101.jpg
img_102.jpg
table_1.xml 
```

原始文件夹中 table_1.xml 的代码

```
 <?xml version="1.0" encoding="utf-8"?>
        <TableLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content" 
             android:background="@drawable/white"
             android:orientation="vertical" 
            >
        <TableRow
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="2" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="10" />
            <TextView 
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Eric Graduation" /> 
        </TableRow>

        <TableRow
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="2" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="17" />
            <TextView 
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="peter birthday" /> 
        </TableRow>
    </TableLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:10:32.767

我不知道你这样做的理由是什么。

如果您的目标是在 ImageView 中显示一些 View 结构作为图像，那么有一种更简单的方法来实现它。

使用 LayoutInflator 像往常一样为您的 TableLayout 充气。一旦你有一个对它的引用，你就可以调用[getDrawingCache()](http://developer.android.com/reference/android/view/View.html#getDrawingCache%28%29)来获取一个可以传递给 ImageView 的位图对象。

```
Bitmap mImg = tbl.getDrawingCache();
mImgView.setImageBitmap(mImg); 
```

# android - 带有 SOAP 网络服务的复杂对象：ClassCastException

> ID：10852776
> 
> 赞同：0
> 
> 时间：2012-06-01T15:05:27.190
> 
> 标签：android, web-services, soap, classcastexception

我正在使用基于[本](http://roderickbarnes.com/blog/droid-chronicles-web-services-handling-complex-parameters)教程的 KSOAP2 库获取复杂对象的 ArrayList：

而且我能够接收对象的arrayList。问题是当信封只有一个对象时......当我这样做时：

```
//...Call webservice
Vector<SoapObject> vectorOfSoapObject = (Vector<SoapObject>)envelope.getResponse();
//pass Vector to ArrayList 
```

`ClassCastException`当我在信封上只有一个对象时，它会在这条线上返回给我一个。当我有更多时，它工作正常（我进行了调试以看到这种情况发生）......

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:16:05.960

可能是当有多个记录时，服务返回`Vector<SoapObject>`，当只有记录时，它只返回`SoapObject`。
您正在尝试转换`SoapObject`为`Vector<SoapObject>`，所以`ClassCastException`.
这是服务实施的问题。但是，要在最后解决此问题，您应该首先获取`envelope.getResponse()`as `Object`，并在强制转换之前检查是否`Object`为实例`Vector<SoapObject>`或`SoapObject`。

```
Vector<SoapObject> vectorOfSoapObject = null;
Object response = envelope.getResponse();

if( response instanceof Vector){
   Vector<SoapObject> vectorOfSoapObject = (Vector<SoapObject>) response;       
}else if(response instanceof  SoapObject){
    //cast single object
   SoapObject soapObject = (SoapObject) response;
   //initialize vector
   vectorOfSoapObject = new Vector<SoapObject>();
   //add single object to vector. 
   vectorOfSoapObject.add(soapObject);
} 
```

这样你就不必更改你可能已经编写的其他代码，假设你总是会得到列表

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T11:38:33.467

我能够解决这个问题。使用@Pranalee 的建议，我做了这个：

```
//call webservice
Object o1 = envelope.getResponse();
if(o1 == null){//no devices updated
    Log.d("GetUpdatesThread","o1==null");
} else if(o1.getClass().toString().equals(new SoapObject("", "").getClass().toString())){//one device updated
    Log.d("GetUpdatesThread","class -- soapObject");
    SoapObject result = (SoapObject) envelope.getResponse();
    Device d = convertToDevice(result);
    devicesUpdated.add(d);
} else if (o1.getClass().toString().equals(new Vector().getClass().toString())){//more than one device updated
    Log.d("GetUpdatesThread","class -- vector");
    Vector<SoapObject> vectorOfSoapObject2 = (Vector<SoapObject>)envelope.getResponse();
    for (SoapObject soapObject : vectorOfSoapObject2) {
         Device d = convertToDevice(soapObject);
         devicesUpdated.add(d);
    }  
} 
```

# objective-c - 如何使用几个 UIAlertView 有一个方法

> ID：10852777
> 
> 赞同：2
> 
> 时间：2012-06-01T15:05:30.053
> 
> 标签：objective-c, uialertview

我尝试制作几个 UIAlertView 并调用它们 - alert、alert1、alert2。我使用这种方法来确定按下了哪个按钮：

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex{
if (buttonIndex == 0 && alertView == alert){
//some code in here...
}
else if (buttonIndex == 0 && alertView == alert1){
//some code in here...
}
else if (buttonIndex == 0 && alertView == alert2){
//some code in here...
}
} 
```

问题是 Xcode 抛出“使用未声明的标识符 'alert'”、“使用未声明的标识符 'alert1'”、“使用未声明的标识符 'alert2'”。

我究竟做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:09:01.137

您可以为此使用`tag`属性`UIAlertView`。

像这样使用 -

克里廷`UIAlertView`-

```
alertView.tag = 1; 
```

在`clickedButtonAtIndex`方法 -

```
if (alertView.tag == 1) {
// Do task here 
} 
```

# r - "cross-product" of data frames

> ID：10852780
> 
> 赞同：1
> 
> 时间：2012-06-01T15:05:40.753
> 
> 标签：r

I was wondering if there was a way to take a "cross-product" of data frames with non-numeric entries. I have a single-column data frame df.RICS with strings as entries (length 235), and another df.dates with dates as entries (length 3004). I want a data frame with each date matched up to each string in df.RICS:

```
 dates
1   2004-04-23
2   2004-04-24
3   2004-04-25
4   2004-04-26
5   2004-04-27
6   2004-04-28
7   2004-04-29
8   2004-04-30
9   2004-05-01
10  2004-05-02

    RICS
1   AA.N
2   AAP
3   AAP.N
4   AAPL.O
5   ABGL.L 
```

Can I use expand.grid(df.RICS, df.dates) without converting to numeric values?

Right now all I have is:

```
> expand.grid(datesAsVec, RICSAsVec, stringsAsFactors = TRUE)
        Var1 Var2
1 2004-04-23 AA.N
Warning message:
In format.data.frame(x, digits = digits, na.encode = FALSE) :
  corrupt data frame: columns will be truncated or padded with NAs 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:17:19.480

you're looking for `expand.grid`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:52:47.137

1.  If your operation works with character data, you could convert the data.frames to character matrices, `outer` works on these.

    ```
    > df <- data.frame (a = LETTERS [1:3], b = 4:6, c = Sys.Date ())
    > df
      a b          c
    1 A 4 2012-06-01
    2 B 5 2012-06-01
    3 C 6 2012-06-01
    > sapply (df, as.character)
         a   b   c           
    [1,] "A" "4" "2012-06-01"
    [2,] "B" "5" "2012-06-01"
    [3,] "C" "6" "2012-06-01"
    > class (sapply (df, as.character))
    [1] "matrix" 
    ```

2.  If the function is vectorized, nstead of using `outer` you could also repeat the two matices appropriately and directly use the function.

3.  If the function doesn't work on character, it's going to be more complicated... But you could have a look at `POSIXct`.

# ios - 在 OpenGL ES 中渲染两个对象

> ID：10852781
> 
> 赞同：0
> 
> 时间：2012-06-01T15:05:40.770
> 
> 标签：ios, opengl-es, opengl-es-2.0

我试图添加两个对象，它们是从一个部分创建的，但由于我需要为每个部分着色，所以我将它们分开。我试图渲染一个可以工作的部分，但后来我尝试渲染两个都没有渲染。

```
 glGenVertexArraysOES(1, &_boxVAO);
        glBindVertexArrayOES(_boxVAO);

        int sizeOfFaces = myMesh_m.faces.size() * sizeof(ObjMeshFace);
        glGenBuffers(1, &_boxBuffer);
        glBindBuffer(GL_ARRAY_BUFFER, _boxBuffer);
        glBufferData(GL_ARRAY_BUFFER, sizeOfFaces, &(myMesh_m.faces[0]), GL_STATIC_DRAW);

        glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, sizeof(ObjMeshVertex), 0);
        glVertexAttribPointer(2, 3, GL_FLOAT, GL_FALSE, sizeof(ObjMeshVertex), (void*)(sizeof(Vector3f) + sizeof(Vector2f)));

        glEnableVertexAttribArray(0);
        glEnableVertexAttribArray(2);

        sizeOfFaces = myMesh_p.faces.size() * sizeof(ObjMeshFace);
        glGenBuffers(1, &_boxBuffer_sec);
        glBindBuffer(GL_ARRAY_BUFFER, _boxBuffer_sec);
        glBufferData(GL_ARRAY_BUFFER, sizeOfFaces, &(myMesh_p.faces[0]), GL_STATIC_DRAW);

        glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, sizeof(ObjMeshVertex), 0);
        glVertexAttribPointer(2, 3, GL_FLOAT, GL_FALSE, sizeof(ObjMeshVertex), (void*)(sizeof(Vector3f) + sizeof(Vector2f)));

        glEnableVertexAttribArray(0);
        glEnableVertexAttribArray(2);

        glBindVertexArrayOES(0); 
```

画：

```
 glBindVertexArrayOES( _boxVAO);
            glUniform2fv(uniforms[UNIFORM_NORMAL_MATRIX], 1, color);
            glUniformMatrix4fv(uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX], 1, GL_FALSE, _modelViewProjectionMatrix.m);
            glDrawArrays(GL_TRIANGLES, 0, pointerSize_m*3); 
```

着色器.vsh

```
attribute vec4 position;
attribute vec3 normal;

varying lowp vec4 colorVarying;

uniform mat4 modelViewProjectionMatrix;
uniform mat3 normalMatrix;

void main()
{
    vec3 eyeNormal = normalize(normalMatrix * normal);
    vec3 lightPosition = vec3(1.0, 1.0, 1.0);
    vec4 diffuseColor = vec4(1, 0.4, 1.0, 1.0);

    float nDotVP = max(0.0, dot(eyeNormal, normalize(lightPosition)));

    colorVarying = diffuseColor * nDotVP;

    gl_Position = modelViewProjectionMatrix * position;
} 
```

着色器.fsh

```
//varying lowp vec4 colorVarying;
uniform lowp vec4 color;

void main()
{
//    gl_FragColor = colorVarying;
    gl_FragColor = color;

} 
```

为什么会失败？此外，我如何为每个对象着色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T06:23:38.737

这是在 draw 方法上进行的。颜色声明应该在绘图方法之外，除非您有一个更改的变量。（就像我在绘图循环中有这个，因为我会有“x”而不是 200）

```
GLfloat color[4];
color[0] = 200/255.0;
color[1] = 0.0/255.0;
color[2] = 0.0/255.0;
color[3] = 255.0/255.0;

GLfloat colorOther[4];
color[0] = 50/255.0;
color[1] = 0.0/255.0;
color[2] = 0.0/255.0;
color[3] = 255.0/255.0;

glUseProgram(_programBorder);
glBindVertexArrayOES(_vaoBorder);
glUniform2fv(uniforms[UNIFORM_COLOR_BORDER], 1, color);
glUniformMatrix4fv(uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX_BORDER], 1, GL_FALSE, _modelViewProjectionMatrix.m);
glDrawElements(GL_TRIANGLES, 24, GL_UNSIGNED_SHORT, 0);

//Modify the model projection matrix to change the position of the object

glUniform2fv(uniforms[UNIFORM_COLOR_BORDER], 1, colorOther);
glUniformMatrix4fv(uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX_BORDER], 1, GL_FALSE, _modelViewProjectionMatrix.m);
glDrawElements(GL_TRIANGLES, 24, GL_UNSIGNED_SHORT, 0); 
```

片段着色器必须有这样的制服：

```
uniform lowp vec4 color;

void main()
{
    gl_FragColor = color;
} 
```

并且不要忘记在您的程序创建方法上正确链接此制服。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-01T18:32:08.993

我知道这有点晚了，但我只是在看答案，它对我不起作用——我有一个黑色方块，但是我改变了

```
glUniform2fv(uniforms[UNIFORM_COLOR_BORDER], 1, color); 
```

至

```
glUniform4fv(uniforms[UNIFORM_COLOR_BORDER], 1, color); 
```

它现在有效。这应该是 4，因为一种颜色有 4 个值，还是我的代码在其他地方搞砸了？:P

# c - Mac OS/X 上的 C 程序如何知道用户双击打开了关联文件？

> ID：10852782
> 
> 赞同：2
> 
> 时间：2012-06-01T15:05:43.090
> 
> 标签：c, macos, file-association

通常在 Obj C 中，NSApplicationDelegate 会处理这个问题。但是我将如何在 C 中做到这一点？我猜我在问什么，在 OS/X 出现之前 Mac 程序是如何做到这一点的？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:19:58.837

在 Mac OS 9 中，应用程序在启动时（或稍后）通过注册并`'odoc'`在启动时接收 Apple 事件来打开文档。这在 C 中很重要，我强烈建议您不要尝试它。特别要注意，除非您的应用程序具有 Carbon 事件循环，否则这不太可能正常工作。

在此之前，还有一种机制，即应用程序在启动时打开的文件在堆栈顶部的内存块中指定。这种机制在 OS X 上不再存在，所以在今天已经无关紧要了。

# c# - 将嵌套属性数据绑定到列表框

> ID：10852789
> 
> 赞同：0
> 
> 时间：2012-06-01T15:05:55.387
> 
> 标签：c#, wpf, xaml, data-binding, mvvm

我无法从绑定到 ListBox 的自定义对象中的可观察集合中获得任何显示。当我的视图模型中有一个字符串集合时，这可以正常工作，但是当我尝试通过自定义对象访问该属性时没有显示名称。我在输出窗口中没有收到任何错误。

这是我的代码：

**自定义对象**

```
public class TestObject
{
    public ObservableCollection<string> List { get; set; }

    public static TestObject GetList()
    {
        string[] list = new string[] { "Bob", "Bill" };

        return new TestObject
        {
            List = new ObservableCollection<string>(list)
        };
    }
} 
```

**Xaml**

```
<Window x:Class="TestWPF.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
<Grid>
    <ListBox Height="100" HorizontalAlignment="Left" Margin="120,61,0,0" Name="listBox1" VerticalAlignment="Top" Width="120" ItemsSource="{Binding Path=TObj.List}" />
</Grid> 
```

**Xaml.cs**

```
 public partial class MainWindow : Window
{
    private ModelMainWindow model;

    public MainWindow()
    {
        InitializeComponent();
        model = new ModelMainWindow();
        this.DataContext = model;
        this.Loaded += new RoutedEventHandler(MainWindow_Loaded);
    }

    public void MainWindow_Loaded(object sender, RoutedEventArgs e)
    {
        this.model.Refresh();
    }
} 
```

**视图模型**

```
 public class ModelMainWindow : INotifyPropertyChanged
{
    private TestObject tObj;

    public event PropertyChangedEventHandler PropertyChanged;

    public TestObject TObj
    {
        get
        {
            return this.tObj;
        }

        set
        {
            this.tObj = value;
            this.Notify("Names");
        }
    }

    public void Notify(string name)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(name));
        }
    }

    public void Refresh()
    {
        this.TObj = TestObject.GetList();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:10:20.800

无法绑定到私有属性。此外，更改通知针对错误的属性，更改`"Names"`为`"TObj"`. （另外我建议将`List`属性设置为仅获取（由`readonly`字段支持），或实施`INoptifyPropertyChanged`以使更改不会丢失）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:10:13.160

你 `List`是私人的。将其设为公共属性，否则 WPF 看不到它。

# java - Netty 使用 TCP 给我一个错误的端口

> ID：10852791
> 
> 赞同：0
> 
> 时间：2012-06-01T15:05:58.540
> 
> 标签：java, tcp, netty

我正在使用带有 Java 的 Netty 来尝试配置 TCP 客户端。到目前为止一切正常，除了我在端口 1050 上连接，但是当我在处理程序的 messageReceived() 方法上调用 messageEvent.getRemoteAddress() 时，我得到了端口 1500。我将端口更改为 1049 但我m 仍然收到 1500。这是 Netty 的问题还是服务器的问题？

我这里的硬件设置是：这个netty客户端运行在Java服务器上，几个门禁设备遍布这里。这些设备充当 tcp 服务器，netty 充当客户端，处理服务器发送的所有内容并回复它们。

tcp 服务器初始化是这样的：

```
private ChannelFactory fabrica;
private ServerBootstrap bootstrap;

public void iniciarServidorTCP() {
    fabrica = new NioServerSocketChannelFactory(
            Executors.newCachedThreadPool(),
            Executors.newCachedThreadPool());
    bootstrap = new ServerBootstrap(fabrica);
    bootstrap.setPipelineFactory(new ChannelPipelineFactory() {

        @Override
        public ChannelPipeline getPipeline() throws Exception {
            ChannelPipeline pipeline = Channels.pipeline();
            pipeline.addLast("decoderDeMensagem", new MensagemDecoderTCP());
            pipeline.addLast("handlerGerente", new GerenteTCP());
            pipeline.addLast("encoder de mensagem", new MensagemEncoderTCP());
            return pipeline;
        }
    });
    bootstrap.setOption("child.tcpNoDelay", true);
    bootstrap.setOption("child.reuseAddress", true);
    bootstrap.bind(new InetSocketAddress(1050));
} 
```

知道为什么我得到 1500 而不是 1050 吗？会不会是设备的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:23:27.340

每个 TCP 连接都有一个源端口和一个目标端口。当您连接到服务器时，服务器将目标端口视为其众所周知的地址。客户端选择源端口。在任一端，获取“远程地址”都会获取对方的地址。因此，当您在服务器上调用 get remote address 时，您将获得*客户端*的地址，而不是服务器的地址。

想象一下，您有一台具有一个 IP 地址和一个众所周知的端口的服务器。现在，假设您有一台具有一个 IP 地址的客户端计算机。如果它与服务器建立四个连接，那么任一端如何区分这些连接？答案是*客户端*端口不同。

# php - 来自 php 邮件功能的电子邮件通讯不再发送

> ID：10852795
> 
> 赞同：0
> 
> 时间：2012-06-01T15:06:06.717
> 
> 标签：php, email

我有一个在 php 中设置的页面，用于向在我的网站上注册的电子邮件发送新闻通讯。前几天我将代码发送到 30 封电子邮件时，代码运行良好。每个人都收到了电子邮件通讯。两个新人注册了，现在当我尝试发送一个时，它通过了，就好像它在代码中没有任何错误一样发送，但没有人收到时事通讯。

是否与阻止其工作的无效电子邮件地址有关？好像其中一个新的无效并且将其关闭？我没有做任何事情来将代码从它工作时的代码更改为之前的 30 封电子邮件。我的托管公司每天允许超过 250 封电子邮件，所以这根本不是问题。

```
$mailto = "members@example.com" ;
$headers = "From: chris@example.com \r\n";
$headers .= "Reply-To: chris@example.com \r\n";
$headers .= "BCC: $emails \r\n";
$headers .= "MIME-Version: 1.0\r\n";
$headers .= "Content-Type: text/html; charset=ISO-8859-1\r\n";
$from='members@example.com';
$subject="TEST";
$body='<html><body>';
$body.= "<table><tr><td>$content etc...</td></td> </body></html>";
if (mail($mailto,$subject,$body,$headers)) { 
code... ; } 
else { 
code... ; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:32:52.120

我会做的是使用一些 SMTP 服务器，比如 google 和 PHPMailer，或者类似的东西。这对你来说可能也是最好的解决方案，因为在 PHP 中使用 mail 函数可能有点危险。许多邮件服务器认为这些电子邮件是垃圾邮件，因为它们不是由已知服务发送的。首先，尝试找出未收到的电子邮件是否已进入垃圾邮件文件夹。如果没有，并且您的时间不允许 PHPMailer 实现，请尝试从 PHP 代码段手动发送电子邮件，看看会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:39:06.740

基于此行：

```
$headers .= "BCC: $emails \r\n"; 
```

您将所有收件人放在一个标题行中。

这可能会因至少 3 个原因而失败：

1.  一旦这一行超过 998 个字符，该邮件就违反[了 rfc2822](https://www.rfc-editor.org/rfc/rfc2822)，因此邮件服务器可能会拒绝它。

2.  大多数 SMTP 服务器对单个邮件中的收件人数量都有限制，因此在某些时候会达到此限制（不过 30 个收件人似乎并不多）。

3.  电子邮件地址中的任何严重语法错误都可能使整行无效。

此外，了解此处使用的 SMTP 服务器可能会有所帮助。如果您有权访问邮件服务器日志，显然您也应该检查一下。

作为一种解决方法，您可能希望遍历订阅者列表并向该字段中的每个订阅者发送一条不同的消息，`To`并且根本不使用`Bcc`。无论如何，这也更好地通过垃圾邮件过滤器。

# android - 如何将多个 ViewPagers 放入一个 ScrollView？

> ID：10852797
> 
> 赞同：3
> 
> 时间：2012-06-01T15:06:09.767
> 
> 标签：android, scrollview, swipe, android-viewpager

我正在尝试实现一个布局，其中包含一个 ViewPagers 列表。每个 ViewPager 都可以独立滑动。请参阅下面图片的链接。

[布局图片](http://www.imagecrate.de/1338563108_layout.jpg.html)

我尝试使用 ScrollView 和带有 ViewPager 的 LinearLayout，但我只显示了一个 ViewPager。甚至可以在一个屏幕上获得多个 ViewPager 吗？

到目前为止我的代码： *main.xml*

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical" >

        <android.support.v4.view.ViewPager
            android:id="@+id/viewpager2"
            android:layout_width="wrap_content"
            android:layout_height="100dp" />

        <android.support.v4.view.ViewPager
            android:id="@+id/viewpager3"
            android:layout_width="wrap_content"
            android:layout_height="100dp" />
    </LinearLayout>

</ScrollView> 
```

*主要活动*

```
public class MainActivity extends Activity{
    @Override
    protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        ViewPagerAdapter adapter2 = new ViewPagerAdapter( this );
        ViewPager pager = (ViewPager)findViewById( R.id.viewpager2 );
        pager.setAdapter( adapter2 );

        ViewPagerAdapter adapter3 = new ViewPagerAdapter( this );
        ViewPager pager3 =
            (ViewPager)findViewById( R.id.viewpager3 );
        pager3.setAdapter( adapter3 );   
    }

} 
```

有任何想法吗？谢谢！编辑：这段代码确实有效！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-15T10:52:26.353

使用多个 ViewPager 确实有些可疑。我正在膨胀几个视图，每个视图都持有一个 ViewPager，并且只有第一个 ViewPager 填充了来自其适配器的数据。但是，如果我给每个 ViewPager 一个唯一的 id，它们都会被填充。

我有一个容器，其唯一的孩子是 ViewPager：

```
ViewPager pager = (ViewPager) pagerContainer.getChildAt(0);
         pager.setId(i); 
```

其中`i`是循环的正索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-12T11:38:35.633

该问题与 ViewPager 的默认高度有关，因为默认情况下它采用 "fill_parent" ，我们无法使用 "wrap_content" 重置它。我发现将高度固定为某个硬代码值的解决方案将返回所有显示在屏幕上的视图寻呼机项目。

我知道这是一些可疑的解决方案，但它对我来说很好，我希望它对你有用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-01T15:45:14.417

在您的 LinearLayout 上，在您的 XML 中。设置`android:weightSum="2"`。对于每个浏览器，设置`android:layout_weight="1"`. 此外，将 LinearLayout 的每个子项的高度设置为 0dp。这应该够了吧

# ruby - Sinatra: NoMethodError at [...] undefined method `body=' for #

> ID：10852799
> 
> 赞同：1
> 
> 时间：2012-06-01T15:06:18.963
> 
> 标签：ruby, sinatra

尝试在 Sinatra 中返回响应时出现 NoMethodError。这是错误：

## /contact/book-me.php 处的 NoMethodError

### #<String:0x00000001911418> 的未定义方法 `body='

```
/home/kerrick/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.3.2/lib/sinatra/base.rb in body
        response.body = value
/home/kerrick/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.3.2/lib/sinatra/base.rb in invoke
        body res
/home/kerrick/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.3.2/lib/sinatra/base.rb in call!
      invoke { dispatch! }
/home/kerrick/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.3.2/lib/sinatra/base.rb in call
      dup.call!(env)
/home/kerrick/.rvm/gems/ruby-1.9.3-p194/gems/rack-protection-1.2.0/lib/rack/protection/xss_header.rb in call
        status, headers, body = @app.call(env)
[...] 
```

这是相关代码：

```
# Snipped, but basically populate the @error hash if the form wasn't filled out right
if @error.length == 0
  #Snipped, but basically handle the success case
else
  @response = ''
  @error.each do |x, y|
    @response << "<li>#{y}</li> \n"
  end
  return [400, @response]
end 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:06:19.117

在Sinatra`@response`中用作您的返回值是导致您的问题的原因。[Ruby on Rails OldWiki 记录了](http://oldwiki.rubyonrails.org/rails/pages/ReservedWords)同样的问题，因此它不仅仅是 Sinatra 特有的。你应该改变你的代码看起来像这样，它会工作：

```
else
  @send_errors = ''
  @error.each do |x, y|
    @send_errors << "<li>#{y}</li> \n"
  end
  return [400, @send_errors]
end 
```

# c# - 当当前任务阻塞时，如何在 .NET 中安排另一个任务？

> ID：10852801
> 
> 赞同：2
> 
> 时间：2012-06-01T15:06:29.107
> 
> 标签：c#, .net-4.0, concurrency, task-parallel-library

对于我的 .NET 4.0 项目，我使用的是`TaskScheduler`具有有限并发度的自定义（类似于 MSDN 上的[LimitedConcurrencyLevelTask​​Scheduler](http://msdn.microsoft.com/en-us/library/ee789351.aspx)示例）。它执行的一堆任务会阻塞，同时等待其他一些操作返回结果，然后继续它们的工作。因为很遗憾这个调度器的线程在这段时间内没有任何事情可做，所以我想在一个阻塞时调度另一个任务。

我认为也许 TPL 可以看到任务何时被阻止，然后安排其他事情，但我`Monitor.Wait()`对 a 的实验或等待`ManualResetEvent`表明情况并非如此。由于我已经在使用自己的任务调度程序，我认为可能有办法明确告诉它安排另一个任务，但我还没有找到任何方法`Task`，`TaskScheduler`等等。

请注意，延续在这里不起作用，因为我正在执行一项任务。另外，我真的很想避免将任务分成两个，一个等待前任务和一个等待后任务，因为可能有几个点需要等待，并且将它们全部拆分会导致我的原始算法出现一定程度的碎片化这将使其难以维护。我`await`想像 Async CTP 这样的东西会有所帮助，但我必须坚持使用 .NET 4。

我是否缺少一些东西来告诉任务调度程序将下一个任务出列，然后在该任务完成后返回到当前任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T17:28:05.917

如果你有自己的`TaskScheduler`，TPL 不会安排任何事情，那是`TaskScheduler`.

如果您想以某种方式告诉您的自定义`TaskScheduler`安排另一个`Task`，您必须自己将其添加到您`TaskScheduler`的。而且你不能执行新`Task`的然后“回到”旧的，因为没有办法暂停正在执行的`Task`.

但最简单的解决方案可能是使用 default `TaskScheduler`，因为它在决定调度`Task`多少 s 时会考虑到被阻塞的 s 。`Task`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:40:51.833

没有内置这样的东西。为避免此类问题，请使用非阻塞任务。

您还可以通过使您自己的自定义 TaskScheduler 并行运行比 CPU 更多的线程来稍微超额订阅 CPU。这将导致轻微的低效率，但如果任务阻塞，您有其他“回填”任务已经在运行并接管 CPU。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:24:19.913

Task.ContinueWith 确实为您提供了在初始任务完成或故障后安排任务的选项。但这仅在初始任务运行完成时才有帮助。

# wpf - WPF 中的样式不会自动应用

> ID：10852805
> 
> 赞同：0
> 
> 时间：2012-06-01T15:06:55.123
> 
> 标签：wpf, styles

我有一个简单的样式，我试图将其应用于我的应用程序中的所有按钮：

```
 <LinearGradientBrush x:Key="ButtonBackgroundBrush">
    <GradientStop Color="Yellow" Offset="0" />
    <GradientStop Color="Red" Offset="1" />
  </LinearGradientBrush>
  <SolidColorBrush Color="Purple" x:Key="ButtonForegroundBrush" />
  <SolidColorBrush Color="LimeGreen" x:Key="ButtonBorderBrush" />
  <Style TargetType="{x:Type Button}">
    <Setter Property="Background" Value="{StaticResource ButtonBackgroundBrush}" />
    <Setter Property="Foreground" Value="{StaticResource ButtonForegroundBrush}" />
    <Setter Property="BorderBrush" Value="{StaticResource ButtonBorderBrush}" />
  </Style> 
```

我的 app.xaml 文件中有这个，所以它适用于我的应用程序中的所有内容。如果我在页面上放置一个按钮，则样式不适用。如果我向样式添加“x:key”，然后将该样式名称添加到按钮，则应用该样式。因此，我知道样式写得正确并且在按钮的范围内。如果我从样式中删除 x:key，是否有人对为什么样式不会自动应用于按钮有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T23:52:49.843

一定是VS2010的故障。我添加了一个新页面，将样式放在 app.xaml 文件中，并将它们应用于新页面上的控件。打开旧页面，就像微软的魔法一样，样式开始应用。真是奇怪。

# python - 使用 Python 读取 RTF 文件时出现欧元符号问题

> ID：10852810
> 
> 赞同：2
> 
> 时间：2012-06-01T15:07:26.610
> 
> 标签：python, unicode, rtf

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:13:18.293

RTF 标准使用 UTF-16，但形状适合 RTF 命令序列格式。记录在[http://en.wikipedia.org/wiki/Rich_Text_Format#Character_encoding](http://en.wikipedia.org/wiki/Rich_Text_Format#Character_encoding)。不幸的是，pyRTF 不会为您进行任何编码；处理这个问题已经在项目的 TODO 上，但显然他们在放弃图书馆之前从来没有这样做过。

这是基于我最近在一个项目中使用的代码。我现在[`rtfunicode`在 PyPI 上](http://pypi.python.org/pypi/rtfunicode)发布了它，支持 Python 2 和 3；python 2版本：

```
import codecs
import re

_charescape = re.compile(u'([\x00-\x1f\\\\{}\x80-\uffff])')
def _replace(match):
    codepoint = ord(match.group(1))
    # Convert codepoint into a signed integer, insert into escape sequence
    return '\\u%s?' % (codepoint if codepoint < 32768 else codepoint - 65536)    

def rtfunicode_encode(text, errors):
    # Encode to RTF \uDDDDD? signed 16 integers and replacement char
    return _charescape.sub(_replace, escaped).encode('ascii')

class Codec(codecs.Codec):
    def encode(self, input, errors='strict'):
        return rtfunicode_encode(input, errors), len(input)

class IncrementalEncoder(codecs.IncrementalEncoder):
    def encode(self, input, final=False):
        return rtfunicode_encode(input, self.errors)

class StreamWriter(Codec, codecs.StreamWriter):
    pass

def rtfunicode(name):
    if name == 'rtfunicode':
        return codecs.CodecInfo(
            name='rtfunicode',
            encode=Codec().encode,
            decode=Codec().decode,
            incrementalencoder=IncrementalEncoder,
            streamwriter=StreamWriter,
        )

codecs.register(rtfunicode) 
```

然后，您可以编码为“rtfunicode”，而不是编码为“iso-8859-15”：

```
>>> u'\u20AC'.encode('rtfunicode') # EURO currency symbol
'\\u8364?' 
```

以这种方式对您插入 RTF 文档的任何文本进行编码。

注意它只支持 UCS-2 unicode ( `\uxxxx`, 2 bytes)，不支持 UCS-4 ( `\Uxxxxxxxx`, 4 bytes)；`rtfunicode`1.1 通过简单地将 UTF-16 代理对编码为两个有`\uDDDDD?`符号整数来支持这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:12:46.820

好消息是你没有做错任何事。坏消息是 RTF 无论如何都被解读为 ISO 8859-1。

```
>>> print u'€'.encode('iso-8859-15').decode('iso-8859-1')
¤ 
```

如果您希望正确读取它，则需要使用[Unicode 转义。](http://en.wikipedia.org/wiki/Rich_Text_Format#Character_encoding)

```
>>> print hex(ord(u'€'))
0x20ac 
```

# java - SOAP services with Axis2 + Java but embedding Jython and binary exe

> ID：10852812
> 
> 赞同：1
> 
> 时间：2012-06-01T15:07:35.060
> 
> 标签：java, python, axis2, jython

i have 2 important pieces of code : - first one is in Python, - the other is a binary dos exe (i can not rewrite this one at all, i have wrapped it in a Java class, and it is working)

i'm using Java as a glue-ing, and incorporate my Python code by using Jython, i also have functional code for all these parts. Everything working fine in Eclipse as a standalone.

actually i would like to avoid any rewriting (not possible for the binary) or embedding Python part it is own Soap Service etc.

and i am defintively stick to Java due to other future included libraries!

now i am in the process of using a Soap Service via Axis2 over Tomcat server, i have an error ***"Exception occurred while trying to invoke service method"***

i think that i may have some missing in how to indicate the **path** to the ***"import"***-ed python modules as readed by the ***"ImportError: No module named mypymodule"*** (this module exists, and it correctly work when used from Java class in Eclipse)

i have added

```
 PythonInterpreter interpreter = new PythonInterpreter(null, new PySystemState());

    PySystemState sys = Py.getSystemState();
    sys.path.append(new PyString("C:/jython2.5.2/Lib"));
    sys.path.append(new PyString("d:/path/to/mypymodule")); // of course this is actually a realpath in my code 
```

but it do not do the trick,

and i am also wodering if there is not a kind of securiy issue with Tomcat/Axis2 or rigth management forbidding access for some others directories?

it should also be notice that this "mypymodule" is not the one that is wrapped in the Java Factory Jython pattern but another external pure python module that is imported by this first one actually wrapped in Java.

please do you have any advices ?

Best regards,

(and i am expected some other future disagreements on the binary calling)

the full stack trace after changing to True the sendStacktraceDetailsWithFaults

```
<parameter name="sendStacktraceDetailsWithFaults">true</parameter> 
```

is below

```
 <soapenv:Fault>
     <soapenv:Code>
        <soapenv:Value>soapenv:Receiver</soapenv:Value>
     </soapenv:Code>
     <soapenv:Reason>
        <soapenv:Text xml:lang="en-US">Exception occurred while trying to invoke service method oWPL</soapenv:Text>
     </soapenv:Reason>
     <soapenv:Detail>
        <Exception>org.apache.axis2.AxisFault: Exception occurred while trying to invoke service method oneWordPerLine1
    at org.apache.axis2.rpc.receivers.RPCMessageReceiver.invokeBusinessLogic(RPCMessageReceiver.java:208)
    at org.apache.axis2.receivers.AbstractInOutMessageReceiver.invokeBusinessLogic(AbstractInOutMessageReceiver.java:40)
    at org.apache.axis2.receivers.AbstractMessageReceiver.receive(AbstractMessageReceiver.java:110)
    at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:181)
    at org.apache.axis2.transport.http.HTTPTransportUtils.processHTTPPostRequest(HTTPTransportUtils.java:172)
    at org.apache.axis2.transport.http.AxisServlet.doPost(AxisServlet.java:146)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.axis2.rpc.receivers.RPCUtil.invokeServiceClass(RPCUtil.java:212)
    at org.apache.axis2.rpc.receivers.RPCMessageReceiver.invokeBusinessLogic(RPCMessageReceiver.java:117)
    ... 23 more
Caused by: Traceback (most recent call last):
  File "&lt;string>", line 1, in &lt;module>
ImportError: No module named mypymodule

    at org.python.core.Py.ImportError(Py.java:290)
    at org.python.core.imp.import_first(imp.java:750)
    at org.python.core.imp.import_name(imp.java:834)
    at org.python.core.imp.importName(imp.java:884)
    at org.python.core.ImportFunction.__call__(__builtin__.java:1220)
    at org.python.core.PyObject.__call__(PyObject.java:357)
    at org.python.core.__builtin__.__import__(__builtin__.java:1173)
    at org.python.core.imp.importFromAs(imp.java:978)
    at org.python.core.imp.importFrom(imp.java:954)
    at org.python.pycode._pyx0.f$0(&lt;string>:1)
    at org.python.pycode._pyx0.call_function(&lt;string>)
    at org.python.core.PyTableCode.call(PyTableCode.java:165)
    at org.python.core.PyCode.call(PyCode.java:18)
    at org.python.core.Py.runCode(Py.java:1261)
    at org.python.core.Py.exec(Py.java:1305)
    at org.python.util.PythonInterpreter.exec(PythonInterpreter.java:206)
    at pyinterface.MyUtils.oWPL(MyUtils.java:127)
    at pyinterface.MyUtils.oWPL(MyUtils.java:152)
    ... 29 more</Exception>
     </soapenv:Detail>
      </soapenv:Fault> 
```

# javascript - How to test the expectation on the eventSpy

> ID：10852815
> 
> 赞同：1
> 
> 时间：2012-06-01T15:07:48.693
> 
> 标签：javascript, backbone.js, jasmine, sinon

I am trying to test a backbone.model when saving.
Here's my piece of code.
As you can see from the comment there is a problem with `toHaveBeenCalledOnce` method.

P.S.:
I am using jasmine 1.2.0 and Sinon.JS 1.3.4

```
 describe('when saving', function ()
    {
        beforeEach(function () {
            this.server = sinon.fakeServer.create();
            this.responseBody = '{"id":3,"title":"Hello","tags":["garden","weekend"]}';
            this.server.respondWith(
                'POST',
                Routing.generate(this.apiName),
                [
                    200, {'Content-Type': 'application/json'}, this.responseBody
                ]
            );
            this.eventSpy = sinon.spy();
        });

        afterEach(function() {
            this.server.restore();
        });

        it('should not save when title is empty', function() {
            this.model.bind('error', this.eventSpy);
            this.model.save({'title': ''});

            expect(this.eventSpy).toHaveBeenCalledOnce(); // TypeError: Object [object Object] has no method 'toHaveBeenCalledOnce'
            expect(this.eventSpy).toHaveBeenCalledWith(this.model, 'cannot have an empty title');
        });
    }); 
```

* * *

console.log(expect(this.eventSpy));

![asddas](../Images/e25609de942c2165ff6ad3cc65aa130b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:09:28.120

茉莉没有任何作用`toHaveBeenCalledOnce`。您需要自己检查计数。

```
expect(this.eventSpy).toHaveBeenCalled();
expect(this.eventSpy.callCount).toBe(1); 
```

所以我想在你的情况下，你会想要这个：

```
expect(this.eventSpy.callCount).toBe(1);
expect(this.eventSpy).toHaveBeenCalledWith(this.model, 'cannot have an empty title'); 
```

### 更新

你现在得到的错误，“期望一个间谍，但得到了功能”正是因为这个。您正在使用 Sinon 库 Spy，并将其传递给期望 Jasmine Spy 的 Jasmine 函数。

你应该这样做：

```
this.eventSpy = jasmine.createSpy(); 
```

或者

```
expect(this.eventSpy.calledOnce).toBe(true);
expect(this.eventSpt.calledWith(this.model, 'cannot have an empty title')).toBe(true); 
```

你和茉莉一起使用诗乃的理由是什么？我推荐第一个解决方案，因为那时 Jasmine 将在测试失败时显示更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T02:41:49.360

有一个名为[jasmine-sinon](https://github.com/froots/jasmine-sinon)的库，它为 jasmine添加了特定于 sinon 的匹配器。

它允许您执行以下操作

```
expect(mySpy).toHaveBeenCalledOnce();
expect(mySpy).toHaveBeenCalledBefore(myOtherSpy);
expect(mySpy).toHaveBeenCalledWith('arg1', 'arg2', 'arg3'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-02-15T11:24:28.407

尝试使用[toHaveBeenCalledTimes](https://jestjs.io/docs/en/expect#tohavebeencalledtimesnumber)方法：

```
expect(this.eventSpy).toHaveBeenCalledTimes(1); 
```

# php - 翻译网站的最佳方式？

> ID：10852817
> 
> 赞同：-2
> 
> 时间：2012-06-01T15:07:55.130
> 
> 标签：php, translation

在我的网站中，HTML 和 JS 代码中有几个英文字符串（不在数据库中），我需要将这些字符串翻译成其他语言（西班牙语、意大利语等）。

最好的方法是什么？

我可以在有语言的地方保存一个 cookie，但我可以把这些翻译后的字符串放在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:14:19.723

如果您不使用框架，例如 symfony2（有一个名为[translation](http://symfony.com/doc/current/book/translation.html)的组件）或 Zend（我确信会有一些相关的独立“组件”），实现这一目标的一种方法是保留一个 php带有 key=> 值对（或者更好的是数组）的文件，并将该文件包含到您的页面中。这样，您可以每次查找，然后加载“正确”标签和类似的...

另外，symfony2 翻译组件可以作为一个独立的部分使用，所以看看它是否能满足你的需求。

# android - DownloadManager 发送 STATUS_SUCCESSFUL 表示下载失败

> ID：10852821
> 
> 赞同：8
> 
> 时间：2012-06-01T15:08:12.410
> 
> 标签：android, download-manager

好的，我正在下载文件（图像）。下载完成后，我想发送一条带有图像本地 URI 的消息。但是 20% 的时间我得到这个：

```
6-01 18:46:39.900: INFO/DownloadManager(412): Initiating request for download 605
06-01 18:46:39.910: WARN/DownloadManager(412): Aborting request for download 605: Trying to resume a download that can't be resumed
06-01 18:46:39.910: INFO/ololo(2826): Okay, I'll broadcast.
06-01 18:46:39.990: WARN/ImageView(2826): Unable to open content: content://downloads/my_downloads/605
    java.io.FileNotFoundException: No filename found.
    at android.database.DatabaseUtils.readExceptionWithFileNotFoundExceptionFromParcel(DatabaseUtils.java:145)...
06-01 18:46:39.990: INFO/System.out(2826): resolveUri failed on bad bitmap uri: content://downloads/my_downloads/605
06-01 18:46:39.990: INFO/ololo(2826): content://downloads/my_downloads/605 was set for android.widget.ImageView@408a2cf0 
```

这是代码

```
Long downloadId = downloadIds.get(this);

if(downloadId == intent.getLongExtra(DownloadManager.EXTRA_DOWNLOAD_ID, -1)) {
    DownloadManager.Query query = new DownloadManager.Query();
    query.setFilterById(downloadId);
    Cursor cursor = downloadManager.query(query);

    if(cursor.moveToFirst()) {

        switch (cursor.getInt(cursor.getColumnIndex(DownloadManager.COLUMN_STATUS))) {
            case DownloadManager.STATUS_SUCCESSFUL : {
                Log.i("ololo", "Okay, I'll broadcast.");
                // Broadcasting
                break;
            }
            case DownloadManager.STATUS_FAILED : {
                Log.i("ololo", "Bad, I won't broadcast.");
                int reason = cursor.getInt(cursor.getColumnIndex(DownloadManager.COLUMN_REASON));
                if(reason == DownloadManager.ERROR_CANNOT_RESUME || reason == DownloadManager.ERROR_UNKNOWN) {
                    // Rerun download
                }
                break;
            }
            default:
                break;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T01:53:22.397

DownloadManager 有问题，无法正常工作。这个错误是不久前向谷歌提交的：

[https://code.google.com/p/android/issues/detail?id=18462](https://code.google.com/p/android/issues/detail?id=18462)

对于单个文件下载，您可以通过指定一个专门为此目的下载的唯一目录来解决此问题，并且只需在 DownloadManager.STATUS_SUCCESSFUL 获取您在该目录中获得的任何内容。
对于多文件下载，我目前想不出解决方法，除非您能够在源头重命名文件。

# objective-c - 如何通过应用内购买仅让付费会员进入我的 iOS 应用的某些部分？

> ID：10852823
> 
> 赞同：0
> 
> 时间：2012-06-01T15:08:18.430
> 
> 标签：objective-c, ios, ios5, in-app-purchase

我正在开发一个应用程序，其中我有一个部分仅供付费用户使用，他们使用 iOS 中的应用内购买系统购买该部分。我知道我需要自己跟踪购买历史，这就是问题的开始。我有一个数据库，并且能够通过 Web 服务接口将用户存储在我的数据库中。如何创建一个**仅**在用户进行购买时才对 URL 进行 ping 操作的系统。

例如，我有 URL：

[http://example.com/registerUserPremium/userid=123456](http://example.com/registerUserPremium/userid=123456)

我怎样才能让这个只有在购买时才被调用？最优雅的方式似乎是 Apple 在购买时使用特殊的用户 ID ping URL，但我找不到这样做的方法。这显然不是让用户在应用程序中调用该 URL 的解决方案，因为它可能被破解/盗版。提供这种防盗版机制的好方法是什么。我的服务是基于网络的，所以如果我能完成这部分，其余的依赖于我的服务器端机制（用户只需将存储在其钥匙串中的特殊密钥发送到服务器）所以我会能够完成项目。简而言之，我需要一种仅在购买时调用 URL 的方法。有哪些可能的解决方案？

谢谢，

能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:25:23.850

我看到两个解决方案：

1.  “服务器产品模型”（[文档](https://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/APIOverview/OverviewoftheStoreKitAPI.html#//apple_ref/doc/uid/TP40008267-CH100-SW1)）：每次用户购买时，应用商店都会联系您的服务器。在这种情况下，您将立即获得所有信息。

2.  应用程序从应用商店获取收据的“内置产品模型”（[相同的文档）。](https://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/APIOverview/OverviewoftheStoreKitAPI.html#//apple_ref/doc/uid/TP40008267-CH100-SW1)在后一种情况下，您可以联系您的服务器特殊 URL，提供收据信息，服务器可以验证收据没有被篡改，并要求应用商店进行验证（这是一个简单的帖子，请参阅[此处](https://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/VerifyingStoreReceipts/VerifyingStoreReceipts.html#//apple_ref/doc/uid/TP40008267-CH104-SW1)）。

# java - 如何使用 iText 阅读具有多列的 pdf？

> ID：10852825
> 
> 赞同：3
> 
> 时间：2012-06-01T15:08:25.060
> 
> 标签：java, itext

我正在尝试阅读一个页面中有 2 列的 pdf 文件。我想分别输出这 2 列。我怎样才能做到这一点 ？请给我一个例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-04T03:21:38.000

您可以使用`RegionTextRenderFilter`. 如果您为每个列定义一个过滤器，您可以分别提取它们。

这是一个如何将[文本提取限制在一个区域](http://itextpdf.com/examples/iia.php?id=279)的示例。

# ruby-on-rails - 返回包装在 lambda 中的方法引用

> ID：10852826
> 
> 赞同：0
> 
> 时间：2012-06-01T15:08:26.577
> 
> 标签：ruby-on-rails, ruby, string, reference, lambda

请帮助我理解为什么以下工作。

```
class Dog
  def bark
    "woof"
  end
end

bark_string = Dog.new.bark
puts bark_string                   # "woof" - a string at this point
ref_to_bark = -> { bark_string }   # the string a moment ago is now the method again
ref_to_bark.call                   # "woof" 
```

**为什么在 proc/lambda 中包装对方法的引用会返回对原始方法的引用？**这让我很困惑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T15:15:56.163

它没有。`ref_to_bark`只是返回`bark_string`，`bark`不调用该方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T15:24:30.760

Ruby 中的 Lambda（以及块和过程）是[*闭包*](http://en.wikipedia.org/wiki/Closure_%28computer_science%29)；这意味着在与定义的 lambda 相同的范围内可用的局部变量可以在 lambda*内部*访问。例如：

```
foo = 42
l = lambda{ p foo }
l.call()
#=> 42 
```

以上不应该比这段代码有效的事实更令人惊讶：

```
x = 17
[1,2,3].map do |n|
  n+x # Whoa, you can use _x_ here?!
end
#=> [18,19,20] 
```

当你做这样的事情时，它会稍微令人惊讶：

```
def make_adder( x )
  ->(y){ x+y }
end
add10 = make_adder(10)
z = add10.call(32)     #=> 42 
```

同样，局部变量*x*（传递给方法的参数）被 lambda “封闭”，它的值被保留以供每当调用 lambda 时参考。

因此，在您的示例**中，lambda 只是“捕获”`bark_string`变量**并稍后返回其值。您的方法永远不会被第二次调用。

* * *

请注意，闭包捕获变量本身，而不仅仅是变量引用的对象：

```
x = "hello"
y = x         # reference the same _object_
l = ->{ x }   # close over the _variable_ itself
x = "world"   # change the variable to point to a new object

p y,          #=> "hello"     (same object as the original)
  l[]         #=> "world"     (new object) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:19:32.810

使用 -> 定义的 lambda 称为 lambda 字面量。有时称为 stabby lambda。以下也将返回相同的结果。

```
ref_to_bark = lambda { bark_string } 
```

或者

```
ref_to_bark = lambda { "woof" } 
```

# iphone - 使用 Cocos2D scheduleUpdate 延迟加载

> ID：10852837
> 
> 赞同：0
> 
> 时间：2012-06-01T15:08:56.240
> 
> 标签：iphone, objective-c, ipad, cocos2d-iphone

我有一个算法需要几秒钟来加载一些东西，我想在实际加载开始之前先将标签上的字符串设置为“正在加载”。这都是在同一层内，这不是场景之间的切换。

我以为我可以简单地这样做：

```
-(void)startLoading{

[self unscheduleAllSelectors];//just in case the update is already scheduled

[self.loadingLabel setString:@"Loading...."];

[self scheduleUpdate];

 } 
```

然后，我有这个：

```
-(void)update:(ccTime)delta{
[self unscheduleUpdate];
[self beginLoading];//another method that loads all the stuff

 } 
```

我的理解是我的方法`beginLoading`不应该运行到下一帧。因此我的标签应该得到正确更新。然而，这并没有发生。当我的所有资产都被加载并且我的标签在加载开始之前永远不会更新时，会有轻微的冻结。

我错过了一步吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:35:31.847

不，你不会错过任何东西。我停止了战斗，现在使用这种“延迟”任务弹射器。它应该确保你会在从第一个到第二个刻度的过渡中获得平局：

```
-(void) startLoading{
    _loadTicker=0; // an NSUInteger iVar declared in the .h
    [self schedule:@selector(tickOffLoading:)];
}

-(void) tickOffLoading:(ccTime) dt{

    _loadTicker++;
    if(_loadTicker==1) {
        [self.loadingLabel setString:@"Loading...."];
    } else {
        [self unschedule:@selector(tickOffLoading:)];
        [self beginLoading];
    }
} 
```

# java - 在 Java 中动态生成 2 个列表的非重复排列对

> ID：10852839
> 
> 赞同：4
> 
> 时间：2012-06-01T15:09:01.803
> 
> 标签：java, permutation

我一直在看很多关于 Java 排列的不同帖子，但没有一个符合我的要求，所以我决定发布。

所以我有 2 `List<Integer>`，我需要生成**没有重复的所有****排列对**，其中对的一个元素在第一个列表中，第二个在第二个列表中。

 **例如，如果我有：

```
List<Integer> l1 = Arrays.asList(new Integer[] {1, 2, 3});
List<Integer> l1 = Arrays.asList(new Integer[] {2, 3, 4}); 
```

然后我想要输出：

```
(1, 2), (1, 3), (1, 4), (2, 2), (2, 3), (2, 4), (3, 3), (3, 4) 
```

请注意， (3, 2) 不在这里，因为我已经有 (2, 3)

我找不到任何图书馆可以做一些远程接近的事情，我发现它`guava`有类似的东西，`Permutations`但它似乎最近已经停产了。

另外，我不想将列表存储在内存中，因为它可能非常大，我只需要一次迭代一对，所以我试图找到动态生成它们**的**方法。我正在考虑实现一个，`Iterable<Pair>`但我似乎无法编写任何看起来有效的东西。

如果你知道图书馆已经在做这种事情，那也会很有帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:27:13.640

怎么样

```
class Pair {
    private int x, y;

    Pair(int x, int y) {
        this.x = x;
        this.y = y;
    }

    @Override public int hashCode() {
        int result = 1;
        result = 31 * result + x;
        result = 31 * result + y;
        return result;
    }

    @Override public boolean equals(Object obj) {
        if (this == obj)              return true;
        if (!(obj instanceof Pair))   return false;
        Pair tmp = (Pair) obj;
        return (tmp.x == x && tmp.y == y) || (tmp.x == y && tmp.y == x);
    }

    public String toString() {
        return "(" + x + "," + y + ")";
    }
}

class Testt {
    public static void main(String[] args) {
        List<Integer> l1 = Arrays.asList( 1, 2, 3 );
        List<Integer> l2 = Arrays.asList( 2, 3, 4 );

        Set<Pair> set = new HashSet<Pair>();
        for (int i : l1)
            for (int j : l2)
                set.add(new Pair(i, j));

        System.out.println(set);
    }
} 
```

输出

```
[(1,2), (1,3), (1,4), (2,2), (2,3), (2,4), (3,3), (3,4)] 
```**

# objective-c - 如何在 parse.com 中使用 pfquery 过滤 ios 中的布尔字段？

> ID：10852841
> 
> 赞同：29
> 
> 时间：2012-06-01T15:09:23.600
> 
> 标签：objective-c, ios, boolean, parse-platform

在 ios/objective c 应用程序中针对 Parse.com 数据源进行查询如何构造我的 PFQuery 以过滤布尔列？

我有这样的东西；

```
PFQuery *query = [PFQuery queryWithClassName:@"MyClass"];
[query whereKey:@"MyBoolCol" equalTo:TRUE]; 
```

请问我该如何构建这个？

谢谢。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-06-02T13:14:39.603

```
[query whereKey:@"MyBoolCol" equalTo:[NSNumber numberWithBool:YES]]; 
```

# iphone - 屏幕解锁后如何重新启动动画

> ID：10852846
> 
> 赞同：1
> 
> 时间：2012-06-01T15:09:45.357
> 
> 标签：iphone, objective-c, ios, ipad

在我的应用程序再次进入前台后，我使用它来重新启动我的动画。再次单击主页按钮和活动应用程序时，它工作正常。但是屏幕解锁时它不起作用。

执行了restartAnimation，但我不知道它在屏幕解锁时不起作用

```
[[NSNotificationCenter defaultCenter] addObserver:self 
                                         selector:@selector(restartAnimation)    
                                               name:UIApplicationWillEnterForegroundNotification 
                                           object:nil]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-17T17:35:07.747

对于解锁后的处理，您必须向 UIApplicationDidBecomeActiveNotification 添加观察者

# ios - iOS：有泄漏吗？

> ID：10852847
> 
> 赞同：0
> 
> 时间：2012-06-01T15:09:45.853
> 
> 标签：ios, nsthread

。H：

```
#import <UIKit/UIKit.h>
#import "Todo.h"
@interface TodoCostApplyViewController : UIViewController

{
    NSThread* headViewThread;
    NSThread* tableViewThread;
}
@property (nonatomic, retain) NSThread* headViewThread;
@property (nonatomic, retain) NSThread* tableViewThread;
@end 
```

米：

```
@interface TodoCostApplyViewController ()
@end
- (void)viewDidLoad
{
    [super viewDidLoad];
    headViewThread = [[NSThread alloc] initWithTarget:self
                                             selector:@selector(drawHeadView)
                                               object:nil];
    [headViewThread start];
    tableViewThread = [[NSThread alloc] initWithTarget:self
                                         selector:@selector(drawTableView)
                                           object:nil];
    [tableViewThread start];   
}

- (void)dealloc
{
    [tableViewThread release];
    [headViewThread release];
} 
```

是否存在有关 tableViewThread 和 headViewThread 的内存泄漏？如果有泄漏，我应该如何处理这个问题？先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:19:06.267

是的，有潜在的泄漏。`viewDidLoad`可能会被多次调用，在这种情况下您会看到内存泄漏。您保留的所有内容`viewDidLoad`都应`nil`最迟在`viewDidUnload`（以及）中发布（并设置为`dealloc`）。

如果您在其中使用了合成的 setter `viewDidLoad`（几乎总是应该这样做），那么问题就会得到缓解，因为每次`viewDidLoad`执行时，旧的线程对象都会在您分配新的线程对象时被释放。

# java - 使用 Java 服务器连接两部 Android 手机

> ID：10852848
> 
> 赞同：3
> 
> 时间：2012-06-01T15:09:46.590
> 
> 标签：java, android, sockets

将互联网上的 2 部 android 手机与 Java 服务器连接的最佳方式是什么？

我正在制作一个游戏形式的android。此刻我让单人游戏工作。但现在我有两个使用 Java 服务器玩在线游戏。

与 2 部手机交流的最佳方式是什么？

最困难的操作是将客户端 1 的信息发送到服务器，服务器将此信息重定向到客户端 2。

任何人都可以帮助我吗？

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T16:58:50.423

您可以使用 SOAP 或 REST，使用 Jax-RS (rest) 或 Java-WS (SOAP)。

[http://www.oracle.com/technetwork/java/index-jsp-137004.html](http://www.oracle.com/technetwork/java/index-jsp-137004.html) http://docs.oracle.com/javaee/6/tutorial/doc/giepu.html

这是一种方法，假设您的游戏有一些基于回合的界面，并且您想做的是创建游戏/加入游戏或创建具有用户风格界面的游戏。

1.  当游戏开始时，使用上述技术之一（soap/rest）连接到服务器，让服务器知道你在那里。
2.  然后让一位客户说创建一个新游戏。这将告诉服务器创建游戏。

3.  另一个客户端将告诉服务器列出游戏。然后在客户端上，选择要加入的游戏。然后告诉服务器游戏选择，让它知道添加你。

4.  启动游戏的手机应该轮询服务器以查看是否有其他用户加入了游戏。最终会有一些人加入。（还有其他方法可以解决这个问题，但轮询很容易做到）

5.  让游戏中的所有玩家投票以了解游戏是否开始，然后在他们都加入后开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:12:36.983

肯定没有最好的方法来做到这一点。有一些技巧。

但我要做的是创建一个从两个客户端到服务器的长的、未关闭的 http 请求，然后当发生某些事情时，客户端会从服务器获得响应。这被称为[Comet](https://en.wikipedia.org/wiki/Comet_%28programming%29)，但我从未自己实现过。肯定有一个 Android 实现（或只是一个 Java 实现）。

# java - 如何将 Windows 安全对话框添加到 Java Web 应用程序

> ID：10852853
> 
> 赞同：1
> 
> 时间：2012-06-01T15:10:10.893
> 
> 标签：java, security, web-applications

有时我会看到以下类型的对话框询问用户名/密码。我想知道我们是否可以将它添加到 java web 应用程序

![窗口安全对话](../Images/e5377ba4cbd8ce65d64266ca87897029.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:52:05.120

您看到的对话框似乎来自与 Windows 安全性集成的 Web 应用程序。以下是您可以在 java 领域中执行此操作的几种方法。

1.  [标准 Apache 推荐方式](http://tomcat.apache.org/tomcat-7.0-doc/windows-auth-howto.html)。
2.  [使用开源 Spnego Lib](http://spnego.sourceforge.net/)

这可能会与 **Basic-Authentication （**[在此处](http://oreilly.com/java/archive/tomcat-tips.html)检查*配置基本身份验证* ）混淆，它也提供了一个*类似*的对话框，但与上面的不同。

# java - 在 Java 中写入文本文件时插入新行

> ID：10852856
> 
> 赞同：4
> 
> 时间：2012-06-01T15:10:20.410
> 
> 标签：java

我对学习 FileWriter 有一点误解……最终目标是编写一个程序，该程序将“生成”一个 .bat 文件，该文件将由启动 .jar 的批处理代码执行。问题是，我不知道如何确保每个 FileWriter.write(); 将在新行上打印...有什么想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-01T15:15:04.737

要创建新行，只需在字符串末尾附加一个换行符：

```
FileWriter writer = ...
writer.write("The line\n"); 
```

此外，`PrintWriter`该类提供了自动为您附加换行符的方法（**编辑：**它还将自动为您的操作系统使用正确的换行符字符串）：

```
PrintWriter writer = ...
writer.println("The line"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T15:13:44.987

在表示一行的每个写入操作之后使用 BufferedWriter 并使用 writer.newLine()。

或者，使用 PrintWriter 和 writer.println()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-19T14:39:13.227

如果您正在使用，`BufferedWriter`那么您可以使用内置方法：

```
BufferedWriter writer = Files.newBufferedWriter(output, charset);
writer.newLine(); 
```

# c++ - C++中的方法调用/数字参数不匹配

> ID：10852863
> 
> 赞同：0
> 
> 时间：2012-06-01T15:11:04.497
> 
> 标签：c++

在阅读其他程序员的 C++ 代码时，当该方法采用 3 个参数时，我感到很困惑，但对该方法的调用只传递了一个。

例如

```
.
.
CarList myCarList;
read_next(myCarList);
.
.
size_t CarListReader::read_next(CarList &cl, bool theBool, size_t skip) 
```

在 java 中，我知道基于方法签名的方法重载，但我不清楚在这种情况下在 C++ 中发生了什么。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T15:14:24.157

那是C++代码。如果您找到函数的原型（可能在头文件中），您应该会看到如下内容：

```
size_t CarListReader::read_next(CarList &cl, bool theBool = true, size_t skip = 4); 
```

这些是[默认参数](http://msdn.microsoft.com/en-us/library/91563f79%28v=vs.71%29.aspx)，如果函数调用中未提供它们，将使用它们。

您的困惑可能来自这样一个事实，即默认值是在函数原型中指定的（可能隐藏在某个头文件中），而不是在函数定义中。如果没有原型*，它们只会出现在函数定义中。

*) 在这种情况下，函数定义是原型别名声明。

# python - 类型错误： 不是 cv2.calcOpticalFlowPyrLK() 中的 numpy 数组

> ID：10852866
> 
> 赞同：2
> 
> 时间：2012-06-01T15:11:09.477
> 
> 标签：python, opencv, tracking, opticalflow

我正在尝试使用 python 绑定在 OpenCV 2.3.1 中制作 LK 跟踪器。当我做

```
calcOpticalFlowPyrLK(img1, img2,
                   template_pt, target_pt, status, err, 
                   (win_size_lk, win_size_lk), 0, TERM_CRITERIA_EPS, 
                   (TERM_CRITERIA_EPS | TERM_CRITERIA_COUNT, 10, 0.03), eig) 
```

我越来越

**TypeError：不是一个numpy数组**

在哪里

```
img1, img2 - iplimage
template_pt, target_pt - A List consisting of tuples with two integers eg. [(120,140),(300,400),..]
win_size_lk = 10
eig = 0.001
status = ""
err = None 
```

此处提供有关 cv2.calcOpticalFlowPyrLK() 的更多信息

[http://opencv.itseez.com/modules/video/doc/motion_analysis_and_object_tracking.html?highlight=opticalflow#cv.CalcOpticalFlowPyrLK](http://opencv.itseez.com/modules/video/doc/motion_analysis_and_object_tracking.html?highlight=opticalflow#cv.CalcOpticalFlowPyrLK)

当我设置

```
eig = np.array([(0.0,1.0),(1.0,0.0)]) 
```

它给了我以下错误

**TypeError：只有长度为 1 的数组可以转换为 Python 标量**

这里可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T08:48:46.033

我已经弄清楚了问题所在。

```
img1, img2 should be numpy array
template_pt, target_pt should be numpy array 
```

所以，

```
target_pt, status, track_error = calcOpticalFlowPyrLK(img1, 
                  img2, 
                  template_pt, 
                  target_pt, 
                  winSize=(win_size_lk, win_size_lk), 
                  flags = OPTFLOW_USE_INITIAL_FLOW,
                  criteria = (TERM_CRITERIA_EPS | TERM_CRITERIA_COUNT, 10, 0.03)) 
```

效果很好。

# c# - 从 C# 应用程序将命令行参数传递给 IronPython？

> ID：10852869
> 
> 赞同：4
> 
> 时间：2012-06-01T15:11:33.563
> 
> 标签：c#, ironpython

如何将命令行参数从我的 C# 应用程序传递到 IronPython 2.x？Google 只返回有关如何使用 Iron Python 1.x 的结果。

```
static void Main(string[] args)
{
    ScriptRuntime scriptRuntime = IronPython.Hosting.Python.CreateRuntime();
    // Pass in script file to execute but how to pass in other arguments in args?
    ScriptScope scope = scriptRuntime.ExecuteFile(args[0]);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T20:21:14.813

您可以通过以下 C# 代码设置 sys.argv：

```
static void Main(string[] args)
{
    var scriptRuntime = Python.CreateRuntime();
    var argv = new List();
    args.ToList().ForEach(a => argv.Add(a));
    scriptRuntime.GetSysModule().SetVariable("argv", argv);
    scriptRuntime.ExecuteFile(args[0]);
} 
```

具有以下python脚本

```
import sys
for arg in sys.argv:
    print arg 
```

并像调用exe一样

```
Test.exe SomeScript.py foo bar 
```

给你输出

```
SomeScript.py
foo
bar 
```

**另一种选择**是将准备好的选项传递给[本答案](https://stackoverflow.com/a/1602006/468244)`Python.CreateRuntime`中的说明

# php - 如何将复选框表单元素发布到 PHP 脚本？

> ID：10852870
> 
> 赞同：0
> 
> 时间：2012-06-01T15:11:34.203
> 
> 标签：php, jquery, jquery-datatables

我正在尝试在 datatables.net 表中提交带有复选框元素的表单。

这个例子说明了我想要做什么：[http ://www.datatables.net/examples/api/form.html](http://www.datatables.net/examples/api/form.html)

但不是警报消息，我希望发布值（对 PHP 脚本使用表单操作）

我添加了这一行...

```
<form id="form" action="test.php" method="post"> 
```

并删除了警报...

```
alert( "The following data would have been submitted to the server: \n\n"+sData ); 
```

但是我的 PHP 脚本只看到使用 datatables.net 的寻呼机按钮发布在当前“页面”上的复选框值。在脚本中保留警告行，我确实看到了所有正确的复选框值。

如何删除警报并将序列化数据发布到我的 test.php 脚本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:54:24.310

我想我今天很早就解决了这个问题，在寻找其他问题时我发现你的问题，这是我的解决方案

// 这将选择所有复选框或取消选择

// 您必须为此示例创建一个 ID 为“ib_seleccionar_todos”的隐藏输入，用于“全选”工作，另一个名为“is_seleccionados”的输入用于发送到其他 php 页面

// 注意：这里的对象数据表名为“tbl_buscar_exalumnos_Table”，将其更改为您使用的那个

```
$('#lnk_opt_seleccionar_todos').click( function(event){
    if ( $("#ib_seleccionar_todos").val() == 0 ){
        $(':input:checkbox.chk_seleccionado', tbl_buscar_exalumnos_Table.fnGetNodes()).attr("checked", "checked");
        $("#ib_seleccionar_todos").val(1);
    } else {
        $(':input:checkbox.chk_seleccionado', tbl_buscar_exalumnos_Table.fnGetNodes()).removeAttr("checked");
        $("#ib_seleccionar_todos").val(0);
    }
    event.preventDefault();
});

$("#btn_agregar_mailing").click( function(){            
     $("#frm_mailing").submit(); 
});

$('#frm_mailing').submit( function() {
    var sData = $('input', tbl_buscar_exalumnos_Table.fnGetNodes()).serialize();
    $('#is_seleccionados').val(sData);
}); 
```

那，将创建一个序列化数组。像这样的东西

```
 [is_seleccionados] => chk_seleccionado%5B%5D=9755396&chk_seleccionado%5B%5D=9907119&chk_seleccionado%5B%5D=12955872&chk_seleccionado%5B%5D=13023863 
```

我像这样在接收页面中爆炸的那个

```
$is_seleccionados  = $_POST["is_seleccionados"];
$ia_arma_selecciondos = explode("&", $is_seleccionados );

    foreach( $ia_arma_selecciondos  as $key => $value ){
        $ia_rut_selecc = explode("=", $value );
        $ia_seleccionado[] = $ia_rut_selecc[1];
    }

    $ia_seleccionado = array_values( array_unique($ia_seleccionado) );
    // $ia_seleccionado = array_values($ia_seleccionado);
    foreach( $ia_seleccionado  as $key => $ii_rut_value ){
       //DO SOMETHING with $key or $ii_rut_value
    } 
```

希望工作。里卡多·穆尼奥斯智利万岁！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:25:34.203

jQuery：

```
$('#submit_to_test').click(function(){
  $.ajax({
  type: "POST",
  url: "test.php",
  data: $('#form').serialize(),
  success: function(data){
    alert(data);
  }
  });
}); 
```

在 html 中添加一个带有 id 的按钮，例如：

```
<button id="submit_to_test">Submit</button> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:25:47.377

确保您已删除**return false；**在**alert("以下数据将被提交到服务器：\n\n"+sData );**

或者

您还可以删除整个表单提交功能，如下所示，因为它不再需要了

```
 $('#form').submit( function() {
    var sData = $('input', oTable.fnGetNodes()).serialize();
    alert( "The following data would have been submitted to the server: \n\n"+sData );
    return false;
} ); 
```

# python - 正则表达式递归太频繁

> ID：10852873
> 
> 赞同：3
> 
> 时间：2012-06-01T15:11:34.750
> 
> 标签：python, regex, jython

我正在尝试编写一个正则表达式来匹配可选引用的值（有效的引号是`"'`和`）。规则是两个引号的出现是一个转义的引号。

这是我想出的正则表达式：

```
(?P<quote>["'`])?(?P<value>(?(quote)((?!(?P=quote).)|((?=(?P=quote)).){2})*|[^\s;]*))(?(quote)(?P=quote)|) 
```

现在可读（注释表明我认为它做了什么）：

```
(?P<quote>["'`])?                   #named group Quote (any quoting character?)

    (?P<value>                      #name this group "value", what I am interested in
        (?(quote)               #if quoted 
            ((?!(?P=quote).)|((?=(?P=quote)).){2})* #see below
                                    #match either anything that is not the quote
                                    #or match 2 quotes
        |
            [^\s;]*         #match anything that is not whitespace or ; (my seperators if there are no quotes)
        )
    )

(?(quote)(?P=quote)|)               #if we had a leeding quote we need to consume a closing quote 
```

它对不带引号的字符串执行良好，带引号的字符串会使其崩溃：

```
 match = re.match(regexValue, line)
  File "****/jython2.5.1/Lib/re.py", line 137, in match
    return _compile(pattern, flags).match(string)
RuntimeError: maximum recursion depth exceeded 
```

我做错了什么？

**编辑**：示例输入 => 输出（用于捕获组“值”（所需）

```
text    => text
'text'  => text
te xt   => te
'te''xt'=> te''xt   #quote=' => strreplace("''","'") => desired result: te'xt
'te xt' => te xt 
```

**编辑2**：在查看它时我注意到一个错误，见下文，但是我相信上面仍然是一个有效的 re +> 它可能是一个 Jython 错误，但它仍然没有做我想要它做的事情：（非常微妙差异，点移出前瞻组

```
new:(?P<quote>["'`])?(?P<value>(?(quote)((?!(?P=quote)).|((?=(?P=quote)).){2})*|[^\s;]*))(?(quote)(?P=quote)|)
old:(?P<quote>["'`])?(?P<value>(?(quote)((?!(?P=quote).)|((?=(?P=quote)).){2})*|[^\s;]*))(?(quote)(?P=quote)|) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:35:15.187

正如评论中所建议的，我建议明确并写下所有可能性：

```
r = r"""
    ([^"'`]+)
    |
    " ((?:""|[^"])*) "
    |
    ' ((?:''|[^'])*) '
    |
    ` ((?:``|[^`])*) `
""" 
```

提取匹配项时，您可以使用仅填充一组四个的事实，并简单地删除所有空组：

```
r = re.compile(r, re.X)
for m in r.findall(''' "fo""o" and 'bar''baz' and `quu````x` '''):
    print ''.join(m) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:51:33.487

经过一番折腾，我找到了解决方案：

```
good:(?P<quote>["'`])?(?P<value>(?(quote)((?!(?P=quote)).|((?=(?P=quote)).){2})*|[^;\s]*))(?(quote)(?P=quote)|)
bad :(?P<quote>["'`])?(?P<value>(?(quote)((?!(?P=quote)).|((?=(?P=quote)).){2})*|[^\s;]*))(?(quote)(?P=quote)|) 
```

不，我不明白区别

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:42:19.107

如果我正确理解你的问题，给出一个包含 3 种不同类型引号的字符串

> “你好，先生”，“猴子”说`nonchalantly`。

您想要提取引用的值。在这种情况下，它们将是：

> 你好先生
> 
> 猴
> 
> 漫不经心

以下表达式提取这些：

```
>>> expr = "\"(.*?)\"|'(.*?)'|`(.*?)`" 
```

观察：

```
>>> s = """
"Hello, sir", said the 'monkey', `nonchalantly`. 
"""
>>> import re
>>> m = re.finditer(expr, s)
>>> for match in m:
...     print match.group()
...
('Hello, sir', None, None)
(None, 'monkey', None)
(None, None, 'nonchalantly') 
```

顺便说一句，您自己的正则表达式似乎适用于我的 python 版本（Mac OSX 10.7.4 上的 cPython 2.7.2），但会产生错误的结果。

# facebook - 使用页面选项卡的框架上的滚动条

> ID：10852874
> 
> 赞同：0
> 
> 时间：2012-06-01T15:11:34.777
> 
> 标签：facebook, facebook-apps, facebook-page, scrollbars

我正在开发 Facebook Page Tab 应用程序。有人可以告诉我如何摆脱内部滚动条吗？

我的应用程序看起来像这样：http: [//imageshack.us/f/39/52017175.jpg/](http://imageshack.us/f/39/52017175.jpg/)但它应该看起来像这样：http: [//imageshack.us/f/805/84116468.jpg/](http://imageshack.us/f/805/84116468.jpg/)。（请注意，第二页滚动条在右侧，而不是在框架中）。

我尝试更改设置，但不起作用...

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:35:05.170

整理了一下：

显然，FB又做了一些改变。添加这个对我有用：

```
<script type="text/javascript" charset="utf-8">
    window.fbAsyncInit = function()
    {
        FB.init({ appId: '',
        status: true,
        cookie: true,
        xfbml: true,
        oauth: true});

        FB.Canvas.setAutoResize();
        FB.Canvas.setAutoGrow();
    }
        </script> 
```

当然，不要忘记加载 .js 文件。接下来，确保您的 css 文件阻止任何滚动条（溢出：隐藏）。

# sql-server - 匿名用户执行的远程powershell脚本

> ID：10852878
> 
> 赞同：6
> 
> 时间：2012-06-01T15:11:44.577
> 
> 标签：sql-server, powershell

我们正在使用 pstrami 运行部署脚本。部署的一部分是执行数据库迁移。迁移使用具有集成安全性的连接字符串。

当脚本在远程计算机上执行时，迁移失败并出现 sql 错误，提示用户“NT AUTHORITY\ANONYMOUS LOGON”登录失败

执行脚本的人是域管理员。我们运行的其他部署与启动该过程的用户一起执行远程脚本。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-08T20:10:36.167

问题是凭据没有跳到 SQL Server 以实现集成安全性。您需要执行以下操作：

在服务器上（正在建立 SQL Server 连接的服务器，以管理员身份运行：

```
Enable-WSManCredSSP -Role server 
```

在客户端计算机上，以管理员身份运行：

```
Enable-WSManCredSSP -Role client -DelegateComputer YOUR_SERVER_NAME 
```

要将其对所有服务器开放，您可以运行：

```
Enable-WSManCredSSP -Role client -DelegateComputer * 
```

最后，您的调用命令确保您运行 -authentication credssp。一个例子：

```
invoke-command -computername $remoteServer -authentication credssp -scriptblock { write-host "hello!" } -credential $credentials 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T20:39:42.757

This is the scenario:
You run the pstrami(deployment) script from desktopA. The script pushes your installation files to serverA. Then on serverA the scripts are run remotely as the person inititating the script from desktopA. One of the steps is to run a sql database upate with fluentmigrator using a connection string paramter using "integrated security" and the database is on serverB.

Connection string example:

```
$migration_db_connection = Data Source=serverB;Initial Catalog=PropertyDb;Integrated Security=SSPI; 
.\migrate.exe /conn "$migration_db_connection" /db SqlServer /a $migration_assembly /profile DEBUG 
```

Pstrami uses the powershell command invoke-command which uses the account you are running the script under as the default user. So, what happens is that when you run the script from desktopA as "jonDoe" it then authenticates on serverA. So your pstrami scripts run under "jonDoe" on serverA. When you execute the fluentmigrator script on serverA as "jonDoe", fluentmigrator returns an error Login failed for user 'NT AUTHORITY\ANONYMOUS LOGON'. In IIS, you run into an interesting situation when you need to access another resource off of the IIS server and certain fairly common situations occur. When using Integrated Security, anonymous access is disabled, and impersonation is turned on, a **Windows security measure kicks in** and doesn't allow your site to access resources on any network servers. ([http://weblogs.asp.net/owscott/archive/2008/08/22/iis-windows-authentication-and-the-double-hop-issue.aspx](http://weblogs.asp.net/owscott/archive/2008/08/22/iis-windows-authentication-and-the-double-hop-issue.aspx))

This is how I got around the Windows Authentication and the Double Hop problem I ran into. Run your migration scripts directly on your sql database server and include it as a server target in your pstrami environments.

Example:

```
Environment "dev" -servers @(
    Server "serverA" @("InstallWeb") 
    Server "serverB" @("RunMigrations")
    ) 
```

More on Double Hop

*   [http://www.spdoctor.net/Pages/message.aspx?name=login-failed-for-user-bdc](http://www.spdoctor.net/Pages/message.aspx?name=login-failed-for-user-bdc)
*   [http://www.sqlservercentral.com/blogs/sqlsandwiches/2011/06/20/double-hop-of-doom/](http://www.sqlservercentral.com/blogs/sqlsandwiches/2011/06/20/double-hop-of-doom/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T11:44:40.937

我无法评论您的问题并将其发布为答案。我稍后会更新。

这可能是由于 SQL Server 没有您的 Windows 登录帐户的登录帐户。如果这是问题，请将登录用户添加到远程计算机中的 SQL Server。

如果这已经解决，那么您可以选择在 SQL Server 以及您正在使用的特定数据库上将权限作为 DB_Owner 授予“NT AUTHORITY\ANONYMOUS LOGON”。

# php - Abaraham 的 twitteroauth 500 服务器错误

> ID：10852879
> 
> 赞同：2
> 
> 时间：2012-06-01T15:11:47.133
> 
> 标签：php, twitter-oauth

我已经把文件放在我的服务器上。我已经用 Twitter 建立了一个应用程序。我已将使用者密钥和使用者机密连同回调的正确 URL 一起放入 config.php。但是，当我转到 twitteroauth 安装的根目录时，我收到 500 Interal Server Error。在设置它时我缺少一些步骤吗？

# 更新

好的。深入挖掘一下，OAuth.php 文件的这一部分似乎是导致错误的原因。

```
class OAuthException extends Exception {
  // pass
} 
```

它位于文件的最顶部。如果我评论说一切似乎都很好。任何想法为什么会导致 500 内部服务器错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T16:09:36.700

经过一堆测试，这似乎是修复。如果您的服务器上安装了 PHP 的 OAuth 模块，您需要在 twitteroauth 子文件夹中的 OAuth.php 文件中注释掉 OAuthException 类，否则将与模块发生冲突，因为该模块已经具有相同的异常处理程序名称，您将收到此 500 内部服务器错误。

# jquery - jQuery 宽度在 IE 中不起作用

> ID：10852880
> 
> 赞同：2
> 
> 时间：2012-06-01T15:11:48.437
> 
> 标签：jquery, width

我的 HTML 中有这个（不是动态添加的或类似的）：

```
<div id="TEST" style="width:600px; height:300px;"></div> 
```

当我这样做时：`alert(jQuery("#TEST").width());`

...它在 IE 中警告 1280！它在 Chrome 中警告 600 - 这可能是什么问题？

这些是唯一应用的样式：

![在此处输入图像描述](../Images/c274c58cf5745683114363d4a89c81d1.png)

**编辑** 我什至试过这个，仍然是 1280 ......

```
jQuery("#TEST").width(600);
alert(jQuery("#TEST").width()); 
```

**再次编辑**

好的，我查看了 jQuery 实现的内部，这是因为它从这个 if 语句返回 true：

```
if ("scrollTo" in elem && elem.document) ? // does it walk and quack like a window? 
```

为什么我的 div “像窗户一样走路和嘎嘎作响”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T15:14:53.233

需要查看渲染的组件以查看样式的来源，但您应该阅读有关`outerWidth`.

[http://api.jquery.com/outerWidth/](http://api.jquery.com/outerWidth/)

**编辑**：看到更新的屏幕截图后，您应该制作元素块级别或内联块级别。设置内联元素的宽度不会提供所需的结果，因为它会根据元素的位置而变化。

更多关于内联元素与块元素的信息：http: [//www.w3.org/TR/html401/struct/global.html#h-7.5.3](http://www.w3.org/TR/html401/struct/global.html#h-7.5.3)

PS。我知道 a`div`是一个块元素，你的代码中有什么东西强迫它变成内联吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:17:03.497

也许得到`CSS`宽度？

```
alert($("#TEST").css("width")); 
```

# sql - 具有高 CPU 使用率的数据库服务器

> ID：10852882
> 
> 赞同：0
> 
> 时间：2012-06-01T15:11:55.310
> 
> 标签：sql, database, performance, sql-server-2008, cpu

我有一个非常强大的服务器，包含 32GB RAM DDR3、8 核（双四核）、4 TB 硬盘，并且我正在运行 SQL Server R2 Web 版。

我们在这个数据库中有大量活动，并且使用分析器，我看到我们有近 600,000 个事务/查询。

CPU 使用率很疯狂，从 30% 上升到 90%，上下波动，我不知道如何跟踪是什么原因。我见过一些繁重的查询，但解决了它，现在我看不到任何应该让它以这种方式加载的东西，每个表都被索引，我让另一位同事在数据库上工作，他说他也不知道它来自哪里。

我们有 1GBIT 上行链路，因此也不是网络问题。

我想可能是因为网络版仅限于处理这么多交易？我不升级的主要原因是该项目的预算低。

有什么建议么？想法？某物？..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T19:09:34.900

使用性能监视器检查您的应用程序以查看我们的应用程序使用 CPU 使用情况，不良应用程序会影响 CPU 状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:15:12.890

您可以尝试将数据库文件跨越多个磁盘上的多个文件

# javascript - 对从 Dictionary JavaScript 对象检索到的对象调用方法

> ID：10852884
> 
> 赞同：0
> 
> 时间：2012-06-01T15:12:12.690
> 
> 标签：javascript, jquery, jquery-plugins, casting, javascript-objects

我正在尝试使用字符串索引填充字典（JavaScript 对象）并从中检索值（自定义对象/类）。然后，一旦我从字典中获取值，我需要调用这个对象的方法。不幸的是，这不起作用，因为一旦从字典中检索到它，它就只是一个简单的对象（`typeof`返回“对象”）。

所以我想做的事情是转换为最初被推入字典的对象类型，在我的例子中是：`google.visualization.Gauge`. （[参考](https://developers.google.com/chart/interactive/docs/gallery/gauge#Data_Format)）

我尝试使用[Object.create](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/create)但这对我不起作用。下面是我的代码：

```
var _gauges = {};

var methods = {
    init: function (options) {

        var containers = this;

        if (containers != null && containers != undefined && containers.length > 0) {
            containers.each(function (index, elem) {

                var id = $(elem).attr('id');
                var name = $(elem).data('name');
                var value = $(elem).data('value');

                var data = google.visualization.arrayToDataTable([
            ['Label', 'Value'],
            [name, value]
                ]);

                var options = {
                    width: 400, height: 120,
                    redFrom: 90, redTo: 100,
                    yellowFrom: 75, yellowTo: 90,
                    minorTicks: 5
                };
                var cont = document.getElementById(id);
                var chart = new google.visualization.Gauge(cont);
                _gauges[name] = chart;
                chart.draw(data, options);
            });
        }

    },
    setValue: function (gaugeName, newValue) {
        var thisGauge = _gauges[gaugeName];
        if (thisGauge) {
            thisGauge.setCell(0, 1, newValue);
            //var tmp = Object.create(google.visualization.Gauge, thisGauge);
            //tmp.setCell(0, 1, newValue);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:48:35.900

嗯，有两件事：

1.  如果其中一个“仪表”对象真的被正确放入数组中，那么当您将其取出时，它会毫发无伤地出现，您可以直接使用它；不需要“铸造”。
2.  根据您链接的文档，没有“setCell”方法:-)

# asp.net-mvc-3 - css 不能与标签一起使用

> ID：10852889
> 
> 赞同：0
> 
> 时间：2012-06-01T15:12:31.243
> 
> 标签：asp.net-mvc-3, css

我不是一个 CSS 人。我正在开发一个 MVC3 应用程序，其中有两个部分页面与主页上的两个选项卡链接。如果选中，我想更改选项卡背景。有什么建议么？请在下面检查我的 CSS。

```
ul#tabs-nav a:hover,
ul#tabs-nav a:focus {
  border-color: #ddd;
  border-bottom-color: #fff;
  background: #fff;
  text-decoration: none;
  color: #555;
  }

ul#tabs-nav a:selected 
 {
    background:red;
    text-decoration:underline;
 } 
```

**HTML**

```
<div>
    <ul id="tabs-nav">
        <li><a href="../Home/Dogs">Dogs</a></li>
        <li><a href="../Home/Cats">Cats</a></li>
    </ul>
    <div class="tabbed-contents">
        @RenderBody()
    </div>
</div> 
```

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:54:08.387

像这样的东西[http://jsfiddle.net/KNCH6/](http://jsfiddle.net/KNCH6/) 这充其量只是一个例子，我不知道 MVC3 所以我不确定你想要的确切交互，但也许 jquery 将是你添加类到选项卡的朋友点击时。我的小提琴只有在锚点聚焦时才有效。因此，如果您单击其他焦点将关闭的位置，效果将关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:24:28.253

您可以使用 jQuery 在链接中添加一个类以突出显示它：http: [//jsfiddle.net/w9UNb/](http://jsfiddle.net/w9UNb/)

```
 $(document).ready(function(){
    $('#tabs-nav a').click(function() {
      $('ul#tabs-nav a').removeClass('selectedLink');
      $(this).addClass('selectedLink');
    });
  }); 
```

并将其添加到 css

```
 ul#tabs-nav a.selectedLink
 {
    background:red;
    text-decoration:underline;
 } 
```

# version-control - Visual Studio 2012 RC 阻止解决方案中的项目“自动绑定”到 TFS 预览

> ID：10852890
> 
> 赞同：3
> 
> 时间：2012-06-01T15:12:35.487
> 
> 标签：version-control, tfs, visual-studio-2012

在 VS2012 RC 的 TFS 预览中，我有一个工作区“c:\project”的服务器版本绑定到“$/project”。

我在“c:\project\default\src\solution.sln”中有一个绑定到“$/project/default/src/solution.sln”的解决方案文件。

我在绑定解决方案中有一些我不想包含在源代码管理中的项目。

对于我不想进行源代码控制的项目，我已经从“文件 > 源代码管理 > 高级 > 更改源代码控制”中删除了绑定。

保存并签入对解决方案文件的更改，但每次我打开解决方案时，它都会自动绑定源代码管理中缺少的项目。实际上，我在“文件 > 源代码管理 > 高级 > 更改源代码管理”中所做的更改似乎没有持续存在！

我试过解除绑定然后撤销项目，反之亦然，效果相同，绑定信息保存在哪里？

我还尝试删除所有 .vspscc 并确认每个 .csproj 在 Scc 元素上没有任何内容：

```
 <SccProjectName>
</SccProjectName>
<SccLocalPath>
</SccLocalPath>
<SccAuxPath>
</SccAuxPath>
<SccProvider>
</SccProvider> 
```

有没有办法防止这种自动绑定发生？我很确定我已经用以前版本的 VS 和 TFS 做到了这一点！

谢谢，P。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T18:33:05.643

看起来固定在 7 月的更新。

# php - 使用 Javascript 将图像（操纵）上传到 facebook

> ID：10852891
> 
> 赞同：-1
> 
> 时间：2012-06-01T15:12:36.220
> 
> 标签：php, javascript, facebook, gdlib

我使用以下 PHP 代码使用 GD 库处理图像并将修改后的图像上传到 facebook。我的问题是我可以使用 Javascript 实现相同的效果。如果可以，我应该使用什么技术。谢谢。

```
$iOut = imagecreatefromjpeg("new.jpg");
$name = "hello all";
imagettftext( $iOut, 20, 0,214,119, $blue, $font, $name ); 
imagejpeg($iOut,"neww.jpg"); 
$filename="neww.jpg";
$attachment['image'] ='@'.realpath($filename);
$photo = $facebook->api('/'.$aid.'/photos', 'POST', $attachment); 
```

注意：以上代码将文本“hello all”添加到新图像“neww.jpg”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:21:11.867

我最近一直在研究客户端 javascript 图片操作，但有一些瓶颈。使用它的最大问题是它在浏览器中的支持不是很好。如果您需要它在 Internet Explorer 中工作，那么 PHP 方式就是您的方式。

例如，如果您对如何调整大小感兴趣，请在此处查看我的帖子：http: [//boxed.hu/articles/html5-client-side-image-resize/](http://boxed.hu/articles/html5-client-side-image-resize/) 还有一个相关的工作示例进入帖子。

我希望这会有所帮助，如果您还有任何问题，请告诉我。

# android - ACRA 和 proguard，行号不正确

> ID：10852892
> 
> 赞同：1
> 
> 时间：2012-06-01T15:12:36.840
> 
> 标签：android, proguard, acra

我在 ACRA 中使用 proguard。

问题是我得到的行号不正确。我从 ACRA 获得崩溃报告，然后使用 Proguard GUI 回溯工具对其进行解码。我得到了行号，我查看了代码，并且声明完全不是崩溃所显示的。我知道 proguard 会缩小并优化代码，那么有什么办法可以让我绕过这一切并获得正确的行号吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T13:53:36.810

ReTrace 的映射文件应该与您发布的已处理代码和您现在正在查看的源代码相对应。否则行号可以关闭。

# java - Java 中的 repaint() 方法

> ID：10852897
> 
> 赞同：5
> 
> 时间：2012-06-01T15:12:53.357
> 
> 标签：java, awt, repaint

我正在玩一些 Java 图形类，我只是想知道——什么时候需要调用该方法`repaint()`？我尝试将其注释掉，但它似乎并没有影响我的输出 GUI。不过，我已经看到它在我读过的 Java GUI 代码中使用了很多。有人介意解释什么时候使用它，什么时候不使用它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:16:10.610

在大多数 Swing 应用程序中从来没有真正需要它，因为它们会自动处理它（用于常见操作，例如更改按钮上的文本值和向列表框添加数据）。

通常，只有在您进行了某种更改时，swing 才会自动拾取 - 例如，您没有使用布局管理器并且正在手动调整组件的大小（因为通常布局管理器会在必要时重新绘制其组件） .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:20:37.203

刷新视图（组件），因此每当您对`repaint()`组件进行任何更改时，都必须调用它。例如，如果您旋转图形组件，则必须调用 以`repaint()`查看包含组件的更改

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-16T09:43:34.273

我唯一能想到的东西：

```
 new Thread() {
    @Override
    public void run() {
    while (ClassName.this.isVisible()) {
        ClassName.this.updateStatusLabel();
        ClassName.this.validate();
        ClassName.this.repaint(50L);
        try {
        Thread.sleep(1000);
        } catch (final InterruptedException e) {
        Log.log(e);
        }
    }
    }
}.start(); 
```

假设您在 JDialog 的构造函数中有上述代码。*updateStatusLabel*所做的是检查一个布尔变量，无论是公共的还是可通过方法设置的，并将基础中的 JLabel 的图标设置为此类布尔变量。如果您不验证并重新绘制 GUI，则在引发另一个事件（很可能是用户触发的事件）之前，不会显示修改。而且，如果用户正在等待标签显示某个图标，比方说，它表明设备是否可以通过 Internet 访问，他/她将永远不会进行交互（或者，至少，您正在延迟交互非常）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T15:18:40.610

当您启动您的应用程序时，您“绘制”了您的 GUI。

`repaint()`当你想重新绘制你的 GUI 时，你需要调用，因为你已经改变了里面的东西。

如果要删除按钮，则需要将其删除（或使其不可见），然后需要调用`validate()`或`repaint()`重新计算（重新绘制）GUI。

# php - domdocument 字符集问题

> ID：10852898
> 
> 赞同：0
> 
> 时间：2012-06-01T15:12:53.750
> 
> 标签：php, domdocument

这是来自女巫的视频，我想获得**og:title**

[http://www.youtube.com/watch?feature=player_embedded&v=A683kmvRH_8](http://www.youtube.com/watch?feature=player_embedded&v=A683kmvRH_8)

php代码

```
function file_get_contents_curl($url){
            $ch = curl_init();
            curl_setopt($ch, CURLOPT_HEADER, 0);
            curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
            curl_setopt($ch, CURLOPT_URL, $url);
            curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
            $data = curl_exec($ch);
            curl_close($ch);
            return $data;
        }

        $html = file_get_contents_curl($pageurl);

        $doc = new DOMDocument();
        @$doc->loadHTML($html);
        $nodes = $doc->getElementsByTagName('title');

        $titleBackUp = $nodes->item(0)->nodeValue;

        $metas = $doc->getElementsByTagName('meta');

        for ($i = 0; $i < $metas->length; $i++){
            $meta = $metas->item($i);
            if($meta->getAttribute('name') == 'title')
                $title = $meta->getAttribute('content');
        } 
```

标题是**Мастило - В ръцете ти е най-добре [HQ]**我得到

**Ð¡°ÑÑÐ¸Ð»Ð¾ - ÑÑÑÐµÑÐµ ÑÐ¸ Ðµ Ð½Ð°Ð¹-Ð´Ð¾Ð±ÑÐµ [总部]**

我也尝试

```
 curl_setopt( $ch, CURLOPT_ENCODING, "UTF-8" ); 
```

但它不起作用。

我尝试使用**html_entity_decode**但不工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:20:15.203

如果文档本身不包含`<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />`标签，就会发生这种情况。

您可以尝试以下任一方法：

1.  让我们`DomDocument`直接从服务器加载 HTML（即使用`->loadHTMLFile()`）

2.  在运行之前使用上述元标记为文档添加前缀`->loadHTML()`。

例如，您可以这样做：

```
libxml_use_internal_errors(true);
$doc->loadHTML('<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />' . $html);
libxml_clear_errors(); 
```

让 libxml 知道它应该读取 utf-8 数据是一种技巧……不可能通过`->loadHTML()`.

# c# - WebformsMVP 实现一个 Ninject IPresenterFactory

> ID：10852899
> 
> 赞同：1
> 
> 时间：2012-06-01T15:13:06.940
> 
> 标签：c#, asp.net, c#-4.0, ninject, webformsmvp

我正在构建一个概念验证 webformsmvp 站点。我想在创建演示者时使用 Ninject (v3.0) 来解决我的服务（和任何其他）依赖项。这是我的 Presenter 构造函数的示例：

```
public ParticipantPresenter(IParticipantDisplayView view, IParticipantService participantService) : base(view) 
```

因此，我想让 Ninject 使用自定义 IPresenterFactory 解析 IParticipantService 实现。

作为参考，这里是IPresenterFactory接口上需要实现的方法的签名：

```
IPresenter Create(Type presenterType, Type viewType, IView viewInstance); 
```

我有个问题; 如果我实现并注册我的 IPresenterFactory 实现，我是否负责解析 Presenter 构造函数中的 View 参数？webformsmvp 框架是否没有为我处理这个问题，或者现在我选择提供自定义工厂实现，我现在是否承担解决视图的责任？

PS 我注意到[webformsmvp contrib 项目](http://webformsmvpcontrib.codeplex.com/)中有一个实现，但这是针对 Ninject v2 的。我一直在考虑为 Ninject3 重写代码。但这并不能帮助我回答这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T15:47:43.857

经过一番尝试，事实证明，如果您实现自己的**IPresenterFactory**，您不负责解析视图。看签名（同上）：

```
IPresenter Create(Type presenterType, Type viewType, IView viewInstance); 
```

**viewInstance**包含由 webformsmvp 框架解析的视图实例。我猜你有机会在你的工厂实现中对这个实例做一些事情。

在我的工厂中我需要做的就是解析**presenterType**，我通过委托给Ninject内核来做到这一点。

# tfs - TF30040: 未正确配置数据库

> ID：10852900
> 
> 赞同：3
> 
> 时间：2012-06-01T15:13:08.570
> 
> 标签：tfs

我继承了一个 TFS 2010 服务器，我试图使用管理控制台来执行一些任务（添加一个新的项目集合、添加一个控制台用户等），它给了我这个错误：

> TF30040: 未正确配置数据库。请联系您的 Team Foundation Server 管理员。

我已尝试查看 eventvwr 日志，但没有提及此错误。我认为 TFS 在安装时会自动设置 SQL Server 2008。关于如何解决这个问题的任何想法？

![TFS 管理控制台](../Images/79aebf908250a3ab53ddc12ec29d1be2.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T15:48:56.867

我想到了。通过以单用户模式启动 SQL Server，将自己添加为系统管理员。一旦您拥有该角色，控制台将为您正确加载。

为了在单用户模式下启动 SQL Server，您可以在命令行中添加参数“-m”。您还可以使用 SQL Server 配置管理器工具，该工具为文件访问和其他权限提供适当的控制。要使用 Configuration Manager 工具来恢复您的系统，请使用以下步骤：

**1.**从“SQL Server 2005|配置”菜单中打开配置管理器工具

**2.**停止需要恢复的SQL Server Instance

**3.**导航到“高级”选项卡，并在“属性”文本框中添加“;–m”到“启动参数”选项列表的末尾

**4.**单击“确定”按钮并重新启动SQL Server Instance

**注意：**确保“;”之间没有空格 和“-m”，注册表参数解析器对此类拼写错误很敏感。您应该会在 SQL Server ERRORLOG 文件中看到一个条目，上面写着“SQL Server 以单用户模式启动”。</p>

**5.** SQL Server 实例以单用户模式启动后，Windows 管理员帐户能够使用 sqlcmd 实用程序使用 Windows 身份验证连接到 SQL Server。您可以使用诸如“sp_addsrvrolemember”之类的 Transact-SQL 命令将现有登录名（或新创建的登录名）添加到 sysadmin 服务器角色。以下示例将“CONTOSO”域中的帐户“Buck”添加到 SQL Server“sysadmin”角色：

> EXEC sp_addsrvrolemember 'CONTOSO\Buck', 'sysadmin';
> 去

**6.**恢复系统管理员访问权限后，使用配置管理器从启动参数中删除“;-m”并重新启动 SQL Server 实例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-28T23:12:34.053

对我来说，解决方案（TFS 2018 Update 2）是将命令行作为应用层中定义的服务帐户运行。然后，我需要 DBA 在项目集合重新附加期间临时授予 svc 帐户 sysadmin 服务器角色。附加完成后，我在应用层重新应用了服务帐户，一切正常。

# c# - 在 C# 构造函数头中使用冒号

> ID：10852905
> 
> 赞同：27
> 
> 时间：2012-06-01T15:13:23.147
> 
> 标签：c#, constructor

下面是`struct`具有两个成员变量 Real 和 Imaginary 的命名 Complex 的构造函数：

```
public Complex(double real, double imaginary) : this()
{
 Real = real;
 Imaginary = imaginary;
} 
```

函数头冒号后面的部分有什么用？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-06-01T15:16:17.023

您始终可以从另一个构造函数中调用一个构造函数。比如说：

```
public class mySampleClass
{
    public mySampleClass(): this(10)
    {
        // This is the no parameter constructor method.
        // First Constructor
    }

    public mySampleClass(int Age) 
    {
        // This is the constructor with one parameter.
        // Second Constructor
    }
} 
```

`this`指的是同一个类，所以当我们说 时`this(10)`，我们实际上是指执行该`public mySampleClass(int Age)`方法。上述调用方法的方式称为初始化器。这样我们在方法中最多可以有一个初始化器。

**在您的情况下，它将调用没有任何参数的默认构造函数**

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-06-01T15:15:08.443

它被称为构造函数链接——它实际上是在调用另一个构造函数（在这种情况下不带参数），然后返回并在这个构造函数中做任何额外的工作（在这种情况下设置`Real`and的值`Imaginary`）。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-06-01T15:15:25.233

这是一个[构造函数初始化器](http://msdn.microsoft.com/en-us/library/aa645603%28v=vs.71%29.aspx)，它在构造函数主体之前立即调用另一个实例构造函数。构造函数初始化器有两种形式：`this`和`base`.

`base`构造函数初始化器导致调用来自直接基类的实例构造函数。

`this`构造函数初始化器导致调用类本身的实例构造函数。当构造函数初始化器没有参数时，调用无参数构造函数。

```
class Complex
{
   public Complex() // this constructor will be invoked
   {    
   }

   public Complex(double real, double imaginary) : this()
   {
      Real = real;
      Imaginary = imaginary;
   }
} 
```

顺便说一句，通常构造函数链接是从具有较少参数计数的构造函数到具有更多参数的构造函数完成的（通过提供默认值）：

```
class Complex
{
   public Complex() : this(0, 0)
   {    
   }

   public Complex(double real, double imaginary)
   {
      Real = real;
      Imaginary = imaginary;
   }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-01T15:15:44.073

指示编译器在`: this()`执行此构造函数中的代码之前调用类的默认构造函数。如果默认构造函数为空，则没有实际作用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-07-03T18:36:48.733

它被称为构造函数链接。在构造函数中使用它来调用另一个构造函数。您也可以为类继承执行此操作，例如：

```
public class MyException : Exception
{
    public MyException(string message) : base(message){}
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-01T15:16:19.760

它的构造函数链接调用同一类的默认或无参数构造函数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-01T15:20:07.097

在定义使用 C# 简写表示法的结构时，对默认构造函数的调用很有用（并且是必需的）。例如：

```
public struct Foo
{
    public int X{get;set;}

    public Foo(int x)
    {
        X = x;
    }
} 
```

编译器将在此处引发错误，因为在分配所有结构字段之前，不能在构造函数中使用“this”对象来分配 X。在幕后，会自动创建一个字段作为属性 X 的后备存储，并调用该结构的默认构造函数来初始化该字段（在本例中为默认值 0）。

有关详细信息，请参阅此问题：[无法分配结构中的自动实现属性](https://stackoverflow.com/questions/7670780/automatically-implemented-property-in-struct-can-not-be-assigned)

# php - 用 PHP 解释 SQL

> ID：10852906
> 
> 赞同：5
> 
> 时间：2012-06-01T15:13:26.237
> 
> 标签：php, sql

因此，我需要使用 PHP 从 sql 查询的 where 语句中提取字段名称和值，更改它们，然后将它们重新组合在一起。

所以，假设我得到了这个字符串：`field='value' AND field2<7`我需要将 field 和 field2 识别为字段名称，然后通过函数`field()`输入并将它们放回查询中。'value' 和 7 相同，但通过`value()`函数提供它们。它还有助于了解每个值与哪个字段相关联。

有没有什么方法不需要几千行代码来做到这一点？

我需要它来处理许多不同的可能输入，包括：`table.field BETWEEN 7 AND 10`或`field<7 AND (field2=3 OR field3=4)`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T15:17:10.757

我使用了开源且相当不错的[php-sql-parser项目。](http://code.google.com/p/php-sql-parser/)

# delphi - 它是否违反了接口属性访问器公开的封装？

> ID：10852909
> 
> 赞同：4
> 
> 时间：2012-06-01T15:13:37.767
> 
> 标签：delphi, oop, properties, interface

当我们在 Delphi 中设计一个类时，通常我们有私有字段（成员）、私有 setter 和 getter 方法以及一个公共属性。从课堂之外，只能通过公共财产访问该数据；该类的用户甚至不知道存在 getter 方法。

所以 getter 和 setter 方法封装了实例成员，而属性封装了 getter 和 setter 方法。

但是，在定义接口时，我们会公开这些方法：

```
ICounter = interface
  // I wouldn't want to specify these 2 methods in the interface, but I'm forced to
  function GetCount: Integer;
  procedure SetCount(Value: Integer);

  property Count: Integer read GetCount write SetCount;
end; 
```

实现具体类：

```
TCounter = class(TInterfacedObject, ICounter)
private
  function GetCount: Integer;
  procedure SetCount(Value: Integer);
public
  property Count: Integer read GetCount write SetCount;
end 
```

使用它：

```
var
  Counter: ICounter;
begin
  Counter := TCounter.Create;
  Counter.Count := 0; // Ok, that's my public property

  // The access should me made by the property, not by these methods
  Counter.SetCount(Counter.GetCount + 1);
end; 
```

如果属性封装了getter/setter私有方法，这不是违规吗？getter 和 setter 是具体类的内部结构，不应暴露。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T15:24:11.720

方法是与接口交互的*主要*方式。接口上的属性是 Delphi 特有的扩展；它们只是为底层方法提供语法糖。没有其他语言 由于接口中的方法根据定义是公共的，因此它们不被属性封装。您不会通过显示属性由方法支持来揭示任何实现细节，因为在接口中，属性*始终*由方法支持，并且方法*始终*是公共的。如果一开始就没有封装，就不能违反封装。

您的示例具体类具有误导性。首先，在那里定义的属性与接口中定义的属性绝对没有联系。您可以将其定义为只读，使其直接访问数据成员，使其私有，或以任何其他方式与接口版本不同，包括完全删除它，它不会影响接口的用户，进一步借用相信接口中重要的是方法而不是属性的概念。编译器将接口属性的任何使用直接转换为相应接口方法之一的使用，这些方法已经是公共的。从来没有就此事咨询过实施对象。

其次，类上的可见性说明符是不相关的。无需将方法设为私有，因为它们已经在接口上公开。但是，将它们设为私有并不是一个坏主意，因为它鼓励通过接口正确使用类。

您可能会抱怨接口的访问器方法应该能够是私有的，但这与要求接口方法通常能够是私有的一样，这是没有意义的。一个不能被调用的方法显然不是接口的一部分。回想一下，任何支持 COM 的语言都可以使用接口，即使是没有属性概念的语言，例如 C 和 C++。这些语言也需要能够调用访问器方法。如果方法在某种程度上是私有的，那么接口将无法在这些语言中工作。

* * *

当 Delphi 类的属性引用一个字段时，该细节实际上是该类的面向公众的接口的一部分。任何使用该属性的代码都*知道*该属性只是该字段的别名（即使代码的*作者*不知道这一点）。如果您更改属性定义，则需要重新编译使用该类的任何代码，以便编译器可以生成用于访问该属性的新代码。

当属性需要由方法支持时，您无法再真正更改属性定义。只有实现可以更改，因此接口的使用者不需要重新编译，因为您选择按需计算属性而不是从存储的字段中读取。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T15:33:27.703

> 但是，接口强制使用 Getter/Setter 方法：

因为接口没有实例，所以不能存储数据。

> 除此之外，Getter 和 Setter 方法通常是私有的。在界面上定义它们使界面用户可以访问它们。它造成了一些混乱：

接口不指定成员的可见性。由实现该接口的类来定义哪些属性和方法是可见的以及它们对谁是可见的（受保护的、公共的或已发布的）。

如果您将仅通过您自己的类/模块使用您的接口，那么更改实现类中的可见性没有问题，尽管这不是一个好习惯。

> 现在，我将如何设置计数：Counter.Count := 0 或 Counter.SetCount(0)？这不是破坏封装吗？

您可以通过两种方式设置 count 属性。如果设置它：

```
Counter.Count := 0 
```

访问方法将以相同的方式调用。并且没有封装被破坏。

**编辑：**

让我举一个例子来说明没有什么会破坏，但可能会有不同的行为：

鉴于您的 ICounter 接口的此实现：

```
 TMyCounter = class(TInterfacedObject, ICounter)
  private
    FCount: Integer;
    function GetCount: Integer;
    procedure SetCount(Value: Integer);
  public
    property Count: Integer read GetCount write SetCount;
  end;

implementation

function TMyCounter.GetCount: Integer;
begin
  Result := FCount;
end;

procedure TMyCounter.SetCount(Value: Integer);
begin
  FCount := Value;
end; 
```

您的财产的一些可能用途是：

```
var
  c: TMyCounter;
  ic: ICounter;
begin
  c := TMyCounter.Create;
  try
    //c.SetCount(1); //won't compile, since the setter is private
    ICounter(c).SetCount(1); //it is ok, because the interface method is public
    c.Count := C.Count + 1; //it is ok, cause the SetCount acessor will be invoked
    if Supports(c, ICounter, ic) then
      ShowMessage(IntToStr(ic.GetCount));
  finally
    c := nil;
  end; 
```

因此，我们可以得出结论：

*   类具有“访问说明符”，在访问类类型时将始终遵守这一点；
*   接口没有“访问说明符”，所有方法在访问接口类型时都会被认为是公共的；

# sql - 更新 SQL Server Management Studio 编辑器窗口

> ID：10852914
> 
> 赞同：3
> 
> 时间：2012-06-01T15:13:54.053
> 
> 标签：sql, sql-server-2008, ssms

我只是想知道是否有人可以帮助解决我对 SQL Server Management Studio 的烦恼。使用查询编辑器时，它不会在创建新表时自动更新。

例如，假设我创建了一个表，然后尝试从该表中选择自动完成将找不到该表，并且编辑器窗口将显示该表不存在（即编辑器将尝试通过说该表不存在来“帮助”我不存在）。我想知道是否有可以在更改或时间间隔内刷新编辑器的设置或调整。

任何建议将不胜感激！

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T21:13:26.997

根据上面的评论 - CTRL+SHIFT+R 或编辑 -> IntelliSense -> 刷新本地缓存工作

# jquery-masonry - jQuery砌体流体排水沟修复

> ID：10852915
> 
> 赞同：0
> 
> 时间：2012-06-01T15:13:58.660
> 
> 标签：jquery-masonry

在我的一生中，我无法弄清楚如何在使用流体/百分比布局时**移除宽排水沟并将其设置为 0 。**

我已经尝试将`gutterWidth: 0`边距和填充设置为`0%`，但它仍然不起作用。

这是 Masonry 网站的代码。

```
$('#container').masonry({
    itemSelector: '.box',
    gutterWidth:0,
// set columnWidth a fraction of the container width
    columnWidth: function (containerWidth) {
        return containerWidth / 5;
    }
}); 
```

CSS

```
.box {
    width:33%;
    margin:0%;
    padding:0%
}
.box img {
    width:100%;
    height:auto
} 
```

我需要调整什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-10-06T20:53:09.110

我在使用基于百分比布局的 Masonry 时遇到了类似的问题。对我来说，它最终成为浏览器滚动条的问题。宽度是在没有滚动条的情况下计算的。Masonry 运行后，由于出现了滚动条，测量结果略有偏差。我能够通过添加以下 CSS 来解决这个问题：

```
body { overflow-y:scroll; } 
```

即使不需要滚动条，这也会强制滚动条，从而使计算准确并修复排水沟。

希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T11:03:59.607

仔细看看砌体代码在做什么：

当您设置列宽时，该函数将返回一个数学结果，该结果采用容器宽度并将其除以 5。但是在您的 css 中，您的框宽度是父项的第三个。所以砌体试图将第 3 个宽度的盒子放入第 5 个宽度的列中。

这很可能是您的问题，但是砖石和流体布局可能很棘手，因此可能并非全部...

# scripting - Ksh 和 Vi 脚本

> ID：10852916
> 
> 赞同：-1
> 
> 时间：2012-06-01T15:13:59.707
> 
> 标签：scripting, edit, vi, ksh

而且我习惯于 vi 而不是 vim。对于我的工作，我目前正在尝试使用 ksh 和 vi 制作脚本。我想要做的是能够打开和搜索关键术语的文件并提取信息。例如，我想运行一个 ksh 脚本，在文件中搜索关键字“主题”，然后提取信息“第一行”。我想使用 vi 的原因是因为我想将我提取的值写入一个文件，并用逗号分隔一行。

```
Subject: line one
Content: line two 
```

感谢您的任何帮助和参考。

编辑：是的，使用 sed、awk 和 grep 是一种更有效的方法。但是我在将结果分配给 ksh 中的变量时遇到问题，目前我有：

```
testing=grep Primary /u/mtjandr/temp.txt | sed -e 's/[:a-zA-Z]* //g' 
grep Primary /u/mtjandr/temp.txt | sed -e 's/[:a-zA-Z]* //g' 
```

它本身会输出正确的结果，但是当我尝试将其分配给变量时，我得到了错误

> copy_group.sh[18]：主要：未找到。

**更新**：我找到了我的解决方案：

```
testing=`grep Primary /u/mtjandr/temp.txt | sed -e 's/[:a-zA-Z]* //g'` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:33:28.573

鉴于您的文件可能看起来很正常，您可能需要查看[`awk`](http://en.wikipedia.org/wiki/AWK),[`grep`](http://en.wikipedia.org/wiki/Grep)并且[`sed`](http://en.wikipedia.org/wiki/Sed)正如 Shawn 所提到的。`Grep`为您提供您感兴趣的行，`awk`提取字段并`sed`编辑整个内容。

因此，在您的示例中，您可能希望找到包含以下内容的行`Subject`：

```
grep Subject file 
```

并提取`line one`：

```
awk '{printf "%s %s,", $2, $3}' 
```

最后删除`,`文件末尾插入的额外内容

```
sed 's/,$//' 
```

这三个命令需要通过管道连接在一起：

```
grep Subject file | awk '{printf "%s %s,", $2, $3}' | sed -e 's/,$//' 
```

当然，该`awk`部分需要根据您的确切文件结构进行定制。

最后，要将整个内容写入另一个文件（而不是输出），您可以将上述命令的输出重定向到一个文件：

```
grep Subject file | awk '{printf "%s %s,", $2, $3}' | sed -e 's/,$//' > other_file 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:55:45.617

正如我在上面的评论中所说，还有许多其他更简单的方法可以使用专为此目的而设计的工具来实现这一目标，例如`sed`、`awk`、`grep`。

如果您确实决定放弃尝试`vi`，那么这里有一个使用单个`awk`命令的版本：

```
awk '/^Subject: /{printf "%s%s",x,substr($0,10);x=","}' in.txt > out.txt 
```

例子：

```
[me@home]$ cat in.txt
Subject: line one
Content: line two
Subject: line three
yadda yadda

[me@home]$ awk '/^Subject: /{printf "%s%s",x,substr($0,10);x=","}' in.txt > out.txt
[me@home]$ cat out.txt
line one,line three 
```

这个`x=','`位是为了让我们可以在除第一个输出之外的所有输出前加上逗号。为了更易读，我们可以简单地将输出记录分隔符 (ORS) 从`\n`更改为逗号。这个howerer 将导致一个尾随逗号，我们需要用另一个命令删除它。

在此示例中，我们将输出通过管道传输`sed`到以删除尾随分隔符：

```
awk -v ORS=',' '/^Subject: /{print substr($0,10)}' in.txt | sed -e 's/,$//' > out.txt 
```

命令分解：

```
awk -v ORS=',' '/^Subject: /{print substr($0,10)}' in.txt | sed -e 's/,$//' > out.txt
    _________   __________   ___________________   ______   _______________ _________
       |             |               |                |             |           |
 separate output     |          OUtput the line       |      Remove trailing    |
 records with        |           from char 10         |           comma         |
 comma (not \n)      |             onwards            |                         |  
                     |                                |                  Redirect output
             Match lines that                    input file                to out.txt
           start with "Subject :" 
```

# tomcat - Tomcat 和请求映射

> ID：10852919
> 
> 赞同：0
> 
> 时间：2012-06-01T15:14:18.623
> 
> 标签：tomcat, servlets, spring-mvc

我被一个简单的网络应用程序困住了。

在其他更复杂的示例无法运行后，尝试测试我在这里找到的示例应用程序： [http ://www.mkyong.com/spring3/spring-3-mvc-hello-world-example/](http://www.mkyong.com/spring3/spring-3-mvc-hello-world-example/)

我正在尝试在 Tomcat 下运行它，因此我只更改了

```
<servlet-mapping>
        <servlet-name>mvc-dispatcher</servlet-name>
        <url-pattern>/</url-pattern>
</servlet-mapping> 
```

至

```
<servlet-mapping>
        <servlet-name>mvc-dispatcher</servlet-name>
        <url-pattern>/samplejsp/*</url-pattern>
</servlet-mapping> 
```

部署到 Tomcat 后，我​​尝试在 Web 浏览器上获取欢迎页面，但我看到的只是：“http://localhost:8080/samplejsp/”的“HTTP 状态 404”、“http://localhost:8080” /samplejsp/welcome”、“http://localhost:8080/welcome/”。

尝试使用 Eclipse 调试 servlet 没有帮助，eclipse 连接到 tomcat，但没有任何反应，并且断点在请求提到的 url 时保持不变。

Tomcat 将应用程序显示为已部署并正在运行。

我想我对请求映射一无所知，但我没有更多的想法。感谢您的帮助，很抱歉引用外部页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T17:06:36.310

`<url-pattern>`in servlet 映射不应包含应用程序上下文根。

更改`<url-pattern>/samplejsp/*</url-pattern>`为`<url-pattern>/*</url-pattern>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:18:56.833

这`<url-pattern>`是相对于 web 应用程序，而不是 Tomcat 服务器。

如果您指定类似的东西`<url-pattern>/samplejsp/*</url-pattern>`并且您的应用程序安装在`/samplejsp`servlet 将驻留在：`http://localhost:8080/samplejsp/samplejsp/`

有关详细信息，请参阅[web.xml 部署描述符元素](http://docs.oracle.com/cd/E13222_01/wls/docs81/webapp/web_xml.html#1015060)的 Oracle 文档。

# jquery - 使用 Jquery append 在 javascript onclick 事件中引用中断代码

> ID：10852922
> 
> 赞同：2
> 
> 时间：2012-06-01T15:14:30.980
> 
> 标签：jquery, append

我试图在 on click javascript 函数中传递两个参数。我需要将参数括在引号中。当我将它括在单引号中时，它会破坏从图像开始的引号，而当我使用双引号时，它会破坏 javascript 前面的引号。我如何附上它不会破坏我的代码？

```
$("#Div").append('<img id ="myImage" src ="/images/myimage.png"  onclick="javascript:myfunction('addnew',$("#field").val())"/> Error.') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:17:30.150

您必须使用反斜杠转义引号，如下所示：

```
$("#Div").append('<img id ="myImage" src ="/images/myimage.png"  onclick="javascript:myfunction(\'addnew\',$("#field").val())"/> Error.') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:17:16.950

试试这个，你需要逃避撇号`\`：

```
$("#Div").append('<img id ="myImage" src ="/images/myimage.png" onclick="javascript:myfunction(\'addnew\',$("#field").val())"/> Error.') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:26:23.240

你可以这样做：

```
$("#Div").append( $( "<img>", {

    id: "myImage",

    src: "/images/myimage.png",

    click: function() {
        myfunction( 'addnew', $("#field").val() );
    }

}), " Error." ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T15:18:02.473

转义周围的单引号`\'addnew\'`：

```
$("#Div").append('<img id ="myImage" src ="/images/myimage.png"  onclick="javascript:myfunction(\'addnew\',$("#field").val())"/> Error.') 
```

# java - “该类型的方法不明确”，但类型并不模糊（错误来自从 eclipse 3.7.2 升级到 eclipse 4.2）

> ID：10852923
> 
> 赞同：15
> 
> 时间：2012-06-01T15:14:37.607
> 
> 标签：java, eclipse, compiler-construction

我已经定义：

```
public static int[] getArray( final int... params ) {
    return params;
}
public static <T> T[] getArray( final T... params ) {
    return params;
} 
```

我用这个

```
getArray( 1, 2 ) 
```

现在我在 eclipse 4.2 中得到编译错误：

> 方法对于类型不明确

但正如你所看到的，这并不模棱两可。我能做些什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-13T00:44:35.540

这被报告为 eclipse[错误 383780](https://bugs.eclipse.org/bugs/show_bug.cgi?id=383780)中的错误。
这是修复的文档： [https ://bugs.eclipse.org/bugs/attachment.cgi?id=218320](https://bugs.eclipse.org/bugs/attachment.cgi?id=218320)

基本上，要修复编译器错误，请获取最新的 eclipse 版本（截至目前为[4.2.1](http://download.eclipse.org/eclipse/downloads/drops4/R-4.2.1-201209141800/)`-vmargs` ），在in之后添加以下行`eclipse.ini`：（然后您可能需要重新启动 eclipse 并重建您的项目）

```
-DtolerateIllegalAmbiguousVarargsInvocation=true 
```

话虽如此，Samuel 是正确的：方法调用是模棱两可的。上面的代码示例之前可以工作，因为 JDK 1.6 之前存在[错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=383780)；并且 eclipse 中的自定义编译器成功地模仿了这个错误。在开发 Juno 时，他们通过将模棱两可的调用报告为错误来修复了[这个错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=346038)（因为 JDK 错误已在 1.7 中修复），这让很多人（包括我）感到恼火。上面的修复要求您明确告诉 eclipse “容忍非法的歧义可变参数调用”。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-01T17:23:48.690

实际上这是模棱两可的，因为java 中的[Autoboxing](http://docs.oracle.com/javase/1.5.0/docs/guide/language/autoboxing.html)允许您调用一个期望 an 的方法，`int`反之亦然`Integer`，因此`getArray( 1, 2 )`实际上可以是对您的任何方法的有效调用。

据我了解您在做什么，您希望有一个实用方法来创建一个数组。也许您可以做的最简单的事情是将处理的方法重命名`int`为`getIntArray()`. 或者如果你想要一个数组，就使用`new int[] {1, 2}`它非常易读。`int`

[您可以在http://docs.oracle.com/javase/specs/jls/se5.0/jls3.pdf](http://docs.oracle.com/javase/specs/jls/se5.0/jls3.pdf)的语言规范中找到此信息（在您的情况下，确定调用的方法将转到第 3 步15.12.2 编译时步骤 2：确定方法签名中描述的过程，因为您使用了 arity 变量，并且在步骤 3 中，两个方法调用都是有效的）

# php - 更改为比较运算符

> ID：10852929
> 
> 赞同：0
> 
> 时间：2012-06-01T15:14:55.643
> 
> 标签：php

有人告诉我，即使使用支持它的库，前面的代码也没有使用参数。而且我使用的是赋值运算符而不是比较。真正的分支也是多余的。

以前的代码：

```
if ($profilepic = $row['profilepic']){
    $profilepic = $row['profilepic'];
}else{
    $profilepic = "DamjuNoImage";
} 
```

当前代码：

```
$profilepic = $row['profilepic'];
$noimage = "DamjuNoImage";

if ($profilepic != $row['profilepic']){
        echo $noimage;
    } 
```

即使我已经测试过代码，我也想仔细检查一下是否修复了代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:22:27.830

具有以下内容：

```
$profilepic = $row['profilepic'];
if ($profilepic != $row['profilepic']){
    echo $noimage;
} 
```

你的 if 语句永远不会做任何事情。第一行`$profilepic`等于`$row['profilepic']`（无论是空字符串、null 还是你有什么），并且条件检查它们是否不相等 - 因为你刚刚使它们相等，所以永远不会出现这种情况。

如果要提供默认图像，请执行以下操作：

```
if ( empty( $row["profilepic"] ) ) {
    $profilepic = $row["profilepic"];
} else {
    $profilepic = "DamJuNoImage";
} 
```

或者写得更简洁：

```
// Assign value of column if not empty, otherwise "DamJuNoImage"
$profilepic = empty( $row["profilepic"] ) 
    ? "DamJuNoImage" 
    : $row["profilepic"]; 
```

如果配置文件图片列为空，我们将默认值分配给`$profilepic`。从那里我们可以呼应我们的形象。

```
echo "<img src='{$profilepic}' />"; 
```

演示：[http ://codepad.org/KXuQyVma](http://codepad.org/KXuQyVma)

# ruby-on-rails - 在 Rails 上生产时出现 Ruby 转换 gem 错误

> ID：10852936
> 
> 赞同：0
> 
> 时间：2012-06-01T15:15:16.843
> 
> 标签：ruby-on-rails, ruby, configuration, units-of-measurement

我已经尝试在我的应用程序中使用红宝石单位[https://github.com/olbrich/ruby-units](https://github.com/olbrich/ruby-units)和炼金术士[https://github.com/halogenandtoast/alchemist](https://github.com/halogenandtoast/alchemist) gems 进行转换。即使在生产模式下，一切都可以在本地完美运行。

然而，在我的 Linode 上，即使炼金术士 gem 在生产 rails 控制台中完美运行，转换也会引发异常。

在我的 rails 应用程序中使用这些 ruby​​ gems 是否需要额外的步骤或配置？我需要调用`require 'alchemist'`初始化程序吗？纯 ruby​​ gem 是如何融入 Rails 的，它们是如何配置的？

这是我的 Gemfile 中的一行：

```
gem 'alchemist' 
```

这是生产控制台输出（有效）：

```
deployer@li60-239:~/apps/saute/current$ bundle exec rails c production
Loading production environment (Rails 3.2.2)
irb(main):001:0> Alchemist
=> Alchemist
irb(main):002:0> 1.tablespoon
=> 1.0
irb(main):003:0> 1.tablespoon.class
=> Alchemist::NumericConversion 
```

但是在我的应用程序中，我的日志中出现异常：

```
Exception in base quantity method: undefined method `tablespoon' for #<BigDecimal:beb7548,'0.1E1',4(8)>
Quantity: 1.0 
```

更新：

我创建了`config/initializers/alchemist.rb`：

```
require 'alchemist' 
```

这在本地开发中没有造成任何问题。一切仍然有效。但是后来我在生产中遇到了以下错误：

/home/deployer/apps/saute/shared/bundle/ruby/1.9.1/gems/activesupport- 3.2.1/lib/active_support/dependencies.rb:251:in `require': 没有要加载的文件——alchemist （加载错误）

我该如何配置这个！

# sql - Visual Web Developer 2010 SQL 返回单行

> ID：10852943
> 
> 赞同：0
> 
> 时间：2012-06-01T15:15:36.780
> 
> 标签：sql, visual-studio-2010, row

我正在尝试为我的数据创建一个简单的表格和图表，但我无法限制它显示的行。

你怎么能这样，我已经搜索过了，一无所获。

我的图表现在有 420 条数据，哈哈，看起来很荒谬，我需要限制行数。

我已经对我的另一个表进行了分页以每页显示 5 行，但这只会掩盖它。

为了获取数据，我采用了拖过 SQLdatasource 工具的方式并以这种方式构建了我的查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:18:31.957

您需要做的就是限制查询返回的结果。根据您的后端：

```
SELECT * FROM  MyTable LIMIT x; 
```

或者

```
SELECT TOP x FROM MyTable... 
```

其中 x 是您希望从查询中返回的结果数。

如果这些都不适合您（例如，SQL Server 可能不适合），请查看[这篇](https://stackoverflow.com/a/971994/183624)关于类似问题的帖子。

# lotus-notes - 创建损坏的 Lotus 数据库

> ID：10852950
> 
> 赞同：0
> 
> 时间：2012-06-01T15:15:57.420
> 
> 标签：lotus-notes, lotus-domino, lotus

我们的应用程序连接到 Lotus Domino 服务器并在其数据库上运行。一旦我们在我们的一个客户端服务器中看到一个损坏的数据库，它无法用 Lotus Notes 客户端打开。不幸的是，客户的工作人员在我们要求副本之前将其删除，但我们也想测试使用这种损坏的数据库的应用程序的错误处理。

我们还尝试使用十六进制编辑器修改一个好的数据库中的一些随机字节，使其在没有成功的情况下损坏。我们正在寻找一种方法来创建损坏的数据库或可免费下载的数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T16:36:06.383

IBM 没有记录 NSF 文件的详细内部结构，因此实际上没有很好的指南来模拟损坏的数据库。

但是，如果您将所有字节都修改为零，那肯定会给您一个非常损坏的数据库。测试应用程序的行为不会特别有用，而且这很可能与您在客户端服务器上看到的损坏类型不同。

NSF 被破坏的方式有很多种。有些是由服务器自动修复的。有些会阻止打开数据库。有些允许您打开数据库，但阻止读取或更新发生。有些可能会导致 API 调用返回的数据丢失或损坏。有些会导致 Notes API 核心 DLL 崩溃。我真的认为不可能针对所有可能的损坏类型测试您的代码行为。无论如何，不​​在合理数量的测试用例中。（即，我猜测大约 1,000 次将最小大小的 NSF 中的单个非零字节随机归零的情况很有可能造成大多数可能的不同类型的损坏。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T10:59:13.937

Lotus Notes/Domino 数据库的内部结构最好描述为容器模型，要获取内部数据，您需要访问受其 ACL（访问控制列表）保护的数据库容器。一旦你的内部几乎所有东西都是“文档”，它是由其 UNID 标识的唯一记录。其中一些“文档”是设计元素，如表单、代理、视图（甚至它的 ACL）等，而另一些则是实际的数据记录。损坏涉及其中一个或多个破坏，具体取决于它是什么以及破坏的程度取决于您在尝试打开数据库或通过 Web、Notes 客户端或第三方软件访问它时会遇到什么。

鉴于上述情况，我看不出尝试创建一个“损坏的”数据库进行测试有多大好处，因为要使这有效，您需要知道您正在破坏什么位。IBM 对此进行保护，并将始终保护这些专有信息，因为他们不希望任何人构建替代的 Notes 客户端。

我要补充的最后一件事是，在将近 15 年的 Notes 开发工作中，我很少遇到损坏，因此没有太多的商业案例来编写代码来分析很少发生的损坏，在代码中进行良好的错误处理在绝大多数情况下将绰绰有余。

# solr - 参数和会话 ID 的 Nutch URL 正则表达式规范化

> ID：10852951
> 
> 赞同：0
> 
> 时间：2012-06-01T15:15:59.557
> 
> 标签：solr, web-crawler, nutch

使用 Nutch 在抓取具有以下参数的 URL 时是否存在任何风险（例如循环）

```
http://something.com?page=index 
```

url-regexfilter 会忽略此类 URL。如果我删除此过滤器，我是否可能会忽略可能导致问题的某些内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T17:23:54.880

[Nutch 删除了查询字符串](https://stackoverflow.com/questions/7045716/nutch-1-2-why-wont-nutch-crawl-url-with-query-strings)，因此解析具有它们的 URL 没有问题。查询字符串最有可能被删除的原因是因为某些网站在查询字符串中添加了跟踪信息，并且它可能会通过重复排队相同的链接来潜在地迫使“愚蠢”的爬虫进入“无限循环”，这些链接的唯一区别是跟踪信息请求参数。

## 更新：

事实证明，Nutch 允许您通过注释掉 crawl_urlfilter.txt 和 regex-urlfilter.txt 中的相应行来启用对[查询字符串的爬取，以启用对包含“？”的 URL 的爬取。](http://osdir.com/ml/nutch-user.lucene.apache.org/2010-01/msg00060.html)在他们中。

但是，正如我在下面的评论中提到的：查询字符串可能包含跟踪信息，这可能会导致爬虫的 URL-seen 测试出现问题。第一个问题是它会使 URL-seen 数据库太大，因为会有很多重复，唯一的区别是查询字符串中的跟踪信息。第二个问题是运行 URL-seen 测试会变得很慢，因为数据库太大了！

因此，在更改是否应允许查询字符串的选项时请记住这一点。

# python - Python - 将 GPS 位置批量转换为经纬度小数

> ID：10852955
> 
> 赞同：10
> 
> 时间：2012-06-01T15:16:15.370
> 
> 标签：python, gps, coordinates, coordinate-transformation

嗨，我有一个带有一些位置数据的遗留数据库。这些字段只是带有这样的字符串的文本字段`0°25'30"S, 91°7'W`。`Decimal Latitude`有什么方法可以将它们转换为和的两个浮点数`Decimal Longitude`吗？

编辑：

所以一个例子是： `0°25'30"S, 91°7'W`-> `0.425`，`91.116667`其中原始的单个字段位置产生两个浮点数。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-01T16:46:22.180

这种方法可以处理秒和分钟的缺失，我认为正确处理指南针方向：

```
# -*- coding: latin-1 -*-

def conversion(old):
    direction = {'N':1, 'S':-1, 'E': 1, 'W':-1}
    new = old.replace(u'°',' ').replace('\'',' ').replace('"',' ')
    new = new.split()
    new_dir = new.pop()
    new.extend([0,0,0])
    return (int(new[0])+int(new[1])/60.0+int(new[2])/3600.0) * direction[new_dir]

lat, lon = u'''0°25'30"S, 91°7'W'''.split(', ')
print conversion(lat), conversion(lon)
#Output:
0.425 91.1166666667 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T16:01:19.477

这会将您的输入字符串转换为您的预期输出。它可以处理不存在的分钟和秒。

目前，它不考虑北/南、东/西。如果您告诉我您希望如何处理，我会更新答案。

```
# -*- coding: latin-1 -*-
import re

PATTERN = re.compile(r"""(?P<lat_deg>\d+)°      # Latitude Degrees
                         (?:(?P<lat_min>\d+)')? # Latitude Minutes (Optional)
                         (?:(?P<lat_sec>\d+)")? # Latitude Seconds (Optional)
                         (?P<north_south>[NS])  # North or South
                         ,[ ]
                         (?P<lon_deg>\d+)°      # Longitude Degrees
                         (?:(?P<lon_min>\d+)')? # Longitude Minutes (Optional)
                         (?:(?P<lon_sec>\d+)")? # Longitude Seconds (Optional)
                         (?P<east_west>[EW])    # East or West
                      """, re.VERBOSE)

LAT_FIELDS = ("lat_deg", "lat_min", "lat_sec")
LON_FIELDS = ("lon_deg", "lon_min", "lon_sec")

def parse_dms_string(s, out_type=float):
    """
    Convert a string of the following form to a tuple of out_type latitude, longitude.

    Example input:
    0°25'30"S, 91°7'W
    """
    values = PATTERN.match(s).groupdict()

    return tuple(sum(out_type(values[field] or 0) / out_type(60 ** idx) for idx, field in enumerate(field_names)) for field_names in (LAT_FIELDS, LON_FIELDS))

INPUT = """0°25'30"S, 91°7'W"""

print parse_dms_string(INPUT) # Prints: (0.42500000000000004, 91.11666666666666) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-02T02:20:13.487

一个简单的方法（鉴于我今天因为这个问题自学了正则表达式）。处理缺失的字段和指南针方向。

```
# -*- coding: latin-1 -*-
import re
s = """0°25'30"S, 91°7'W"""

def compLat_Long(degs, mins, secs, comp_dir):
    return (degs + (mins / 60) + (secs / 3600)) * comp_dir

def extract_DegMinSec(data):   
    m = re.search(r'(\d+°)*(\d+\')*(\d+")*', data.strip())
    deg, mins, secs = [0.0 if m.group(i) is None else float(m.group(i)[:-1]) for i in range(1, 4)]
    comp_dir = 1 if data[-1] in ('W', 'S') else -1
    return deg, mins, secs, comp_dir 

s1, s2 = s.split(',')
dms1 = extract_DegMinSec(s1)
dms2 = extract_DegMinSec(s2)
print('{:7.4f}  {:7.4f}'.format(compLat_Long(*dms1), compLat_Long(*dms2))) 
```

产量

```
 0.4250  91.1167 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-18T21:24:34.457

试试这个，它一次处理一个坐标（纬度或经度）。它能够返回坐标的有效结果，指南针方向位于坐标的开头或结尾，“，”作为小数点分隔符，如果无法解码输入，则返回原始字符串。

```
def dec(coord):
    c = coord.upper()
    s = 1
    if c.find('S')>0 or c.find('W')>0:
        s = -1
    c = c.replace('N','').replace('E','').replace('S','').replace('W','').replace(',','.').replace(u'°',' ').replace('\'',' ').replace('"',' ')
    a = c.split()
    a.extend([0,0,0])
    try:
        return s*(float(a[0])+float(a[1])/60.0+float(a[2])/3600.0) 
    except:
        return coord 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-23T06:13:24.217

如果您的数据在 DataFrame 中，您可以使用[`clean_lat_long()`](https://docs.dataprep.ai/user_guide/clean/clean_lat_long.html)库[DataPrep中的函数。](https://dataprep.ai/)安装 DataPrep 与`pip install dataprep`.

```
from dataprep.clean import clean_lat_long
df = pd.DataFrame({"coord": ["""0°25'30"S, 91°7'W""", """27°29'04.2"N   89°19'44.6"E"""]})

df2 = clean_lat_long(df, "coord", split=True)
# print(df2)
                        coord  latitude  longitude
0           0°25'30"S, 91°7'W   -0.4250   -91.1167
1  27°29'04.2"N\t89°19'44.6"E   27.4845    89.3291 
```

# java - 如何使用图形对象 g 绘制透明形状？

> ID：10852959
> 
> 赞同：3
> 
> 时间：2012-06-01T15:16:33.753
> 
> 标签：java, image, graphics, awt, java-2d

`BufferedImage`我想用透明背景创建一个“环” 。我可以用这样的透明背景绘制圆圈：

```
BufferedImage bi = new BufferedImage(d, d, BufferedImage.TYPE_INT_ARGB);
Graphics2D g = (Graphics2D) bi.getGraphics();
g.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
g.setColor(c);
g.fillOval(0, 0, d, d); 
```

但是现在我想在它的中间画一个较小的透明圆圈来制作一个圆环（所以当我在另一个图像上绘制这个图像时，不会绘制圆环周围和内部的像素）。我想使用一个`Graphics`对象来做到这一点，所以我可以使用抗锯齿。

这可能吗？如果不是，解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T16:59:54.737

创建一个圆形，然后从中减去另一个圆形，将其设置为剪辑，您最终可能会得到所需的线条。要隐藏剪辑的粗糙边缘，请绘制一个 2 像素宽的形状描边。

![一环](../Images/eee71b55ffbaa0c966091258dc03ea96.png)

```
import java.awt.*;
import java.awt.geom.*;
import java.awt.image.BufferedImage;
import java.net.URL;
import javax.imageio.ImageIO;
import javax.swing.*;

public class OneRing {

    OneRing(BufferedImage imageBG, BufferedImage imageFG) {
        // presumes the images are identical in size BNI
        int w = imageBG.getWidth();
        int h = imageBG.getHeight();
        Ellipse2D.Double ellipse1 = new Ellipse2D.Double(
                w/16,h/16,7*w/8,7*h/8); 
        Ellipse2D.Double ellipse2 = new Ellipse2D.Double(
                w/4,h/4,w/2,h/2);
        Area circle = new Area(ellipse1);
        circle.subtract(new Area(ellipse2));

        Graphics2D g = imageBG.createGraphics();
        g.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        g.setRenderingHint(RenderingHints.KEY_DITHERING, RenderingHints.VALUE_DITHER_ENABLE);
        g.setRenderingHint(RenderingHints.KEY_FRACTIONALMETRICS, RenderingHints.VALUE_FRACTIONALMETRICS_ON);
        g.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BICUBIC);
        g.setClip(circle);
        g.drawImage(imageFG, 0, 0, null);
        g.setClip(null);
        Stroke s = new BasicStroke(2);
        g.setStroke(s);
        g.setColor(Color.BLACK);
        g.draw(circle);
        g.dispose();

        JLabel l = new JLabel(new ImageIcon(imageBG));
        JOptionPane.showMessageDialog(null, l);
    }

    public static void main(String[] args) throws Exception {
        URL urlFG = new URL("http://i.stack.imgur.com/OVOg3.jpg");
        URL urlBG = new URL("http://i.stack.imgur.com/lxthA.jpg");
        final BufferedImage biFG = ImageIO.read(urlFG);
        final BufferedImage biBG = ImageIO.read(urlBG);
        SwingUtilities.invokeLater(new Runnable(){
            @Override
            public void run() {
                new OneRing(biBG, biFG);
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:48:30.037

你不能画透明的形状。在包括 Java 2D 在内的大多数图形 API 中，当您在某物上绘制时，图形上下文会将现有像素与新像素“混合”。您应该找到一种可以实现您所寻找的混合模式。java 中的混合是通过[Composite](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/Composite.html)完成的。

您应该使用/实现一个复合执行以下操作：

```
result color = destination color
result alpha = destination alpha - source alpha 
```

然后，您使用 alpha = 1 绘制的每个像素都将混合为 alpha = 0，而 alpha = 1 的像素将保持不变。

# mapreduce - './manage.py runserver' 在 celery map/reduce 任务运行时重启；有时会引发 inner_run 错误

> ID：10852961
> 
> 赞同：1
> 
> 时间：2012-06-01T15:16:36.913
> 
> 标签：mapreduce, celery, fabric, django-celery, hadoop-streaming

我在我的 django 项目中有一个视图，它启动了一个 celery 任务。celery 任务本身通过 subprocess/fabric 触发了一些 map/reduce 作业，hadoop 作业的结果存储在磁盘上——实际上没有任何东西存储在数据库中。在 hadoop 作业完成后，celery 任务会发送一个 django 信号表明它已完成，如下所示：

```
# tasks.py
from models import MyModel
import signals

from fabric.operations import local

from celery.task import Task

class Hadoopification(Task):
    def run(self, my_model_id, other_args):
        my_model = MyModel.objects.get(pk=my_model_id)
        self.hadoopify_function(my_model, other_args)
        signals.complete_signal.send(
            sender=self,
            my_model_id=my_model_id,
            complete=True,
        )

    def hadoopify_function(self, my_model, other_args):
        local("""hadoop jar /usr/lib/hadoop/hadoop-streaming.jar -D mapred.reduce.tasks=0 -file hadoopify.py -mapper "parse_mapper.py 0 0" -input /user/me/input.csv -output /user/me/output.csv""") 
```

真正让我困惑的是，运行 celery 任务时 django runserver 正在*重新加载*，就好像我在 django 项目中的某个地方更改了一些代码（我没有，我可以向你保证！）。有时，这甚至会导致 runserver 命令出现错误，在 runserver 命令重新加载之前我看到如下输出并且再次正常（注意：此错误消息与[此处描述的问题](https://stackoverflow.com/questions/7435242/weird-behavior-causes-my-runserver-to-not-respond)非常相似）。

```
Unhandled exception in thread started by <function inner_run at 0xa18cd14>
Error in sys.excepthook:
Traceback (most recent call last):
  File "/usr/lib/python2.6/dist-packages/apport_python_hook.py", line 48, in apport_excepthook
    if not enabled():
TypeError: 'NoneType' object is not callable

Original exception was:
Traceback (most recent call last):
  File "/home/rdm/Biz/Projects/Daegis/Server_Development/tar/env/lib/python2.6/site-packages/django/core/management/commands/runserver.py", line 60, in inner_run
    run(addr, int(port), handler)
  File "/home/rdm/Biz/Projects/Daegis/Server_Development/tar/env/lib/python2.6/site-packages/django/core/servers/basehttp.py", line 721, in run
    httpd.serve_forever()
  File "/usr/lib/python2.6/SocketServer.py", line 224, in serve_forever
    r, w, e = select.select([self], [], [], poll_interval)
AttributeError: 'NoneType' object has no attribute 'select' 
```

我已经将问题缩小到当调用 hadoop 时，替换`local("""hadoop ...""")`为`local("ls")`不会导致重新加载 django 运行服务器出现任何问题。hadoop 代码中没有错误——当它不被 celery 调用时，它自己运行得很好。

知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:31:52.137

因此，在研究了 fabric 源代码之后，我了解到 django 正在重新加载，因为我的 celery 任务在 fabric.operations.local 命令中运行，失败了（这在 hadoop 输出 puke-fest 中很难检测到）。当一个 fabric.operations.local 命令失败时，[fabric 发出一个 sys.exit](https://github.com/fabric/fabric/blob/master/fabric/utils.py#L26)导致 celery 死掉，django 尝试重新加载。可以通过在 hadoop 任务中捕获[SystemExit来检测此错误，如下所示：](http://docs.python.org/library/exceptions.html#exceptions.SystemExit)

```
class Hadoopification(Task):
    def run(self, my_model_id, other_args):
        my_model = MyModel.objects.get(pk=my_model_id)
        self.hadoopify_function(my_model, other_args)
        signals.complete_signal.send(
            sender=self,
            my_model_id=my_model_id,
            complete=True,
        )

    def hadoopify_function(self, my_model, other_args):
        try:
            local("""hadoop jar /usr/lib/hadoop/hadoop-streaming.jar -D mapred.reduce.tasks=0 -file hadoopify.py -mapper "parse_mapper.py 0 0" -input /user/me/input.csv -output /user/me/output.csv""")
        except SystemExit, e:
            # print some useful debugging information about exception e here!
            raise 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T16:55:25.940

[在这里](https://github.com/fabric/fabric/issues/534)、[这里](https://github.com/fabric/fabric/issues/277)和[这里](https://github.com/fabric/fabric/issues/102)的织物 github 页面上有一些关于此的讨论。引发错误的另一个选项是使用设置上下文管理器：

```
from fabric.api import settings

class Hadoopification(Task):
    ...
    def hadoopify_function(self, my_model, other_args):
        with settings(warn_only=True):
            result = local(...)
        if result.failed:
            # access result.return_code, result.stdout, result.stderr
            raise UsefulException(...) 
```

这样做的好处是允许访问返回代码和结果中的所有其他属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T02:21:20.407

我的猜测是芹菜和织物中的[Task](http://docs.fabfile.org/en/1.4.2/api/core/tasks.html?highlight=task#fabric.tasks.Task)名称存在一些冲突。我建议使用类似的东西：

```
import celery
class Hadoopification(celery.task.Task):
    ... 
```

并尽量避免任何进一步的碰撞，如果这种预感是好的。

但实际上，fabric 的 local 非常简单，本质上只是一个 subprocess.Popen，您可以尝试调用 raw 来分离除 python stdlib 之外的任何内容。

# c# - 对 RegEx 的帮助不大

> ID：10852962
> 
> 赞同：2
> 
> 时间：2012-06-01T15:16:38.357
> 
> 标签：c#, regex, parsing

我必须解析一个非常复杂的字符串来“评估”字符串中包含的函数。我只有一个“提取”功能，它有这个特定的sintax：

```
LOC_POS(number;number); 
```

该字符串包含在这样的 HTML 页面中：

```
something here LOC_POS(45;9);Some string or html content <br> here LOC_POS(45.21312;9.1232123);LOC_POS(45,32;9,12); some other string... 
```

（数字是坐标，这个正则表达式可以识别函数：

```
LOC_POS\([ 0-9.,]+;[ 0-9.,]+\); 
```

如何提取c#中的所有块？我想要的结果是一个包含（每个项目一行）的数组

```
something here 
LOC_POS(45;9);
Some string or html content <br> here 
LOC_POS(45.21312;9.1232123);
LOC_POS(45,32;9,12); 
some other string... 
```

我知道如何用普通的字符串解析来做到这一点..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:48:53.477

这是我想出的。

```
 string str = @"something here LOC_POS(45;9);Some string or html content <br> here LOC_POS(45.21312;9.1232123);LOC_POS(45,32;9,12);  some other string...";
        Regex test = new Regex(@"(LOC_POS\([\d\.,]+;[\d\.,]+\);)");
        string[] segments = test.Split(str);
        StringBuilder sb = new StringBuilder();
        foreach (string s in segments)
            if(!String.IsNullOrEmpty(s))
                sb.AppendLine(s);
        textBox1.Text = sb.ToString(); 
```

输出结果

```
something here 
LOC_POS(45;9);
Some string or html content <br> here 
LOC_POS(45.21312;9.1232123);
LOC_POS(45,32;9,12);
 some other string... 
```

正则表达式找到 LOC_POS 的每个实例，拆分导致它将字符串分解为其段，然后您使用 stringbuilder 重建字符串以在正确的位置获取所有 newLines。如果您确实需要它们，您还可以使用它来捕获 LOC 块的各个实例。整个事件的捕获组是确保 LOC 块实际被定位，而不是被忽略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:52:36.447

这个怎么样：

```
string str = @"something here LOC_POS(45;9);Some string or html content <br> here LOC_POS(45.21312;9.1232123);LOC_POS(45,32;9,12);  some other string...";
string rgx = @"\s*(LOC_POS\([ 0-9.,]+;[ 0-9.,]+\);)\s*";

str = Regex.Replace(str, rgx, @"##$1##");
//Console.WriteLine("str= " + str);

string[] lines = str.Split(new string[] {"##"}, StringSplitOptions.RemoveEmptyEntries);

foreach(string s in lines) {
    Console.WriteLine(s);
}
Console.ReadKey(); 
```

首先，我在元素周围放置了一个任意拆分序列（我使用了`##`，但您可以将其更改为任何内容）`LOC_POS`（使用带有空格捕获的正则表达式）。然后我在所述拆分序列上拆分字符串，确保处理空条目。砰，完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:20:53.707

`((.*?)(LOC_POS\([\d\.,]+;[\d\.,]+\);))`

这将捕获几个组。第一个子组将是 LOC_POS 之前的字符串。[正则表达式在这里。](http://regexr.com?314rl)

第 1 组：全串

第 2 组：LOC_POS 之前的字符串

第 3 组：LOC_POS 调用

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-01T15:20:50.343

```
var content = "....";
var regex = new Regex(@"LOC_POS\([ 0-9.,]+;[ 0-9.,]+\);");
var matches = regex.Match(content); 
```

# replace - 在 Excel 2010 中的第一个单词之后和最后一个单词之前插入逗号

> ID：10852963
> 
> 赞同：1
> 
> 时间：2012-06-01T15:16:38.543
> 
> 标签：replace, find, excel-2010, comma, street-address

我确实有一个我无法解决的问题，尽管我已经搜索了很多。

我有以下地址：1021 CHATEAU WOODS PKWY DR, CORROE, TX 77385

我希望它看起来像这样：1021，CHATEAU WOODS PKWY DR，CONROE，TX，77385

我在网上找到了一些使用 Excel 中的查找和替换功能的公式，所有解决方案都假定我应该选择“旧文本”单元格 A1。但是在 Excel 2010 中返回错误。

有什么办法可以在第一个“单词”之后添加逗号，因为它的长度是可变的，并且在最后一个之前，这是一个邮政编码？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T05:44:51.730

根据您上面的评论，我将在这里发布我所理解的*真正问题的答案，主要是因为仅使用 Excel 函数解析地址的任务太繁琐了。*（相信我，我在[SmartyStreets](http://smartystreets.com)的地址验证行业工作，并且看到[太多使用简单函数和正则表达式的失败尝试](http://smartystreets.com/how-to/regex-street-address)。）

你可以继续尝试像这样添加逗号，但你最终会发现它不可靠，因为地址有多种不同的格式，有效的和无效的。

我们已经发布[了一个简单的算法，用于将地址分解为其组件](https://smartystreets.com/archive/parse-and-verify-freeform-street-addresses)。这是一条与你要去的地方不同的路线，但你得到的结果是一样的——实际上是更准确的——结果。您现有地址的问题是它们尚未[标准化](http://smartystreets.com/what-is/address-standardization)，因此对所有地址执行统一操作会产生不一致的结果。（例如，在您上面提供的地址中，“Pkwy”部分应扩展为“Parkway”，因为它不是街道后缀；它实际上是名称的一部分。此外，有些街道名称是数字，这可能会造成混淆与门牌号结合使用时。）

你说你缺少一些地址的信息。USPS 授权有[CASS 认证的](http://smartystreets.com/what-is/cass-processing)服务来“填写”缺失的数据，并对其进行标准化。您甚至可以通过此类服务处理您的清单来获得邮寄折扣。有许多供应商，我鼓励您找到您喜欢的负担得起的、简单的供应商。

其中一项服务是[LiveAddress](http://smartystreets.com/products)，它将非常轻松地处理 Excel 列表并标准化您的地址。[使用API](http://smartystreets.com/what-is/api)可能更容易将地址解析为组件（如果您有一些编程知识 - 但您可以直接在 Excel 中使用 VBA 进行挂钩）。

**编辑：我应该告诉你一个小秘密......**上周早些时候，我们部署了一项更改，允许您只向我们的 API 提交一行（街道 1 号线），它仍然会做它的事情。这意味着您不必自己编写我提到的算法；相反，只需使用 VBA 执行基本请求（只需几行代码）。

如果您对管理地址有其他疑问，请发表评论，我会看看我能做些什么来进一步帮助您。

# php - 在PHP中根据长度对多维数组进行排序

> ID：10852964
> 
> 赞同：1
> 
> 时间：2012-06-01T15:16:38.730
> 
> 标签：php, sorting

我有一个函数可以找到数组的所有可能组合：

```
function combination($array) 
{    
    $results = array(array());

    foreach ($array as $element)
        foreach ($results as $combination)
            array_push($results, array_merge(array($element), $combination));

    return $results;
} 
```

这将返回一个多维数组并且它可以工作。

如果我尝试打印数组，我使用这个：

```
foreach (combination($set)  as $combination)
{
    print join("\t", $combination) . "  - ";
} 
```

为了：`$set = array('s','f','g');`

输出是：`- s - f - f s - g - g s - g f - g f s -`

现在我想不通的是如何根据长度对组合进行排序，从而使输出变为： `- g f s - g s - g f - f s - g - s - f -`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:21:03.643

为此，您需要使用“usort”：

```
function sortByLength($a, $b) {
    return count($b) - count($a);
}

$result = combination($set);

usort($result, 'sortByLength'); 
```

如果您只使用一次，您也可以只使用 'sortByLength' 作为匿名函数，而不是定义它：

```
$result = combination($set);

usort($result, function($a, $b) {
    return count($b) - count($a);
} ); 
```

# windows-ce - 为非 x86 目标自定义引导加载程序启动画面

> ID：10852967
> 
> 赞同：3
> 
> 时间：2012-06-01T15:16:57.163
> 
> 标签：windows-ce, splash-screen, platform-builder

我正在 Windows CE 6.0R3 中构建面向 ARM9 架构的操作系统（特别是针对 iMX28 系列），我想更改启动屏幕以在设备首次启动时显示自定义图像。

我怎样才能做到这一点？我阅读了一些相当[模糊和稀疏的文档](http://geekswithblogs.net/BruceEitman/archive/2009/07/12/platform-builder-creating-a-cepc-splash-screen.aspx)，建议您需要以 .bmx 格式创建它并启用视频，但我没有看到如何实际*更改*设备启动时显示的启动画面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T21:10:04.767

这取决于。一般来说，引导加载程序控制显示控制器的初始化并将数据发送到控制器以获取在加载操作系统之前出现的初始图像，并且它的显示驱动程序接管。在使用 Platform Builder 附带的开箱即用 BIOS 引导加载程序的典型**x86目标设备中，它将加载 splash.bmx（压缩的 BMP）并显示它。**

在我知道的所有基于 ARM 的情况下，BIOS 引导加载程序**不是**用于加载映像的，而是一个 BSP 或特定于供应商的加载程序。我见过各种各样的东西，从定制的 OEM 引导加载程序到 redboot 的衍生产品。在这些情况下，您必须知道如何设置引导加载程序以显示启动图像以及如何配置它（如果可以的话 - 有些是硬编码的）。

由于我们不知道您使用的是什么引导加载程序，因此我什至不会冒险猜测您的工作原理。您最好的选择是查看您的平台文档并查看它是否被描述，或者与 OEM 联系。如果您碰巧是 OEM，则必须查看您正在使用的任何引导加载程序的源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T22:06:05.073

在查看了 ctacke 推荐的内容后，我发现对于`iMX28-eVK-PDK1_9`我的操作系统项目中使用的 BSP，我需要修改`display.c`.

具体来说，它是在`iMX28-EVK-PDK1_9\SRC\BOOTLOADER\COMMON\display.c`. 该函数`ShowBmp`用于从内存中的固定位置加载位图。我不得不调整代码以`ShowBmp`将所需的位图而不是默认的飞思卡尔图像写入屏幕。

默认情况下，`ShowBmp`从内存位置读取位图图像并将其逐个像素地写入设备屏幕。我们真正改变的唯一一件事是我们从我们的内存位置读取。

# html - css下拉菜单不工作但以前工作过

> ID：10852981
> 
> 赞同：2
> 
> 时间：2012-06-01T15:17:42.123
> 
> 标签：html, css, drop-down-menu, menu

我希望你能帮助我。我有一个用于所有浏览器的下拉菜单，但由于某种原因，从今天开始它停止显示下拉子菜单。

你能看看，让我知道发生了什么事吗？我已经花了大约 3 个小时试图弄清楚这一点。我已将代码压缩到最低限度。

提前致谢...

```
 <!DOCTYPE html>
    <html lang="en">
    <head>
        <title>title here</title>
        <style type="text/css">
            ul
            {
                list-style: none;
            }

            body
            {
                font-size: 12px; /* Base Font Size */
                line-height: 1.5; /* 21px */
                color: #525252;
                font-family: "Helvetica" ,Arial,sans-serif;
            }

            a
            {
                color: #409ff8;
                text-decoration: none;
                -o-transition-property: color;
                -webkit-transition-property: color;
                -moz-transition-property: color;
                transition-property: color;
                -o-transition-duration: 0.3s;
                -webkit-transition-duration: 0.3s;
                -moz-transition-duration: 0.3s;
                transition-duration: 0.3s;
            }

            a:hover
            {
                color: #2d6ca8;
                text-decoration: underline;
            }

            #wrapper
            {
                width: 940px;
                margin: 0 auto;
            }

            #header
            {
                height: 90px;
                position: relative;
            }

            .navigation ul
            {
                position: absolute;
                bottom: 0;
                right: 0;
                border-radius: 5px 5px 0 0;
                -moz-border-radius: 5px 5px 0 0;
                -webkit-border-radius: 5px 5px 0 0;
                box-shadow: 0 -1px 0 rgba(0, 0, 0, 0.1);
                -moz-box-shadow: 0 -1px 0 rgba(0, 0, 0, 0.1);
                -webkit-box-shadow: 0 -1px 0 rgba(0, 0, 0, 0.1);
            }

            .navigation ul li
            {
                float: left;
                display: inline;
                position: relative;
                text-align: center;
            }

            .navigation ul li img
            {
                position: absolute;
                bottom: 0;
            }

            .navigation ul li a
            {
                color: #fff;
                padding: 0 13px;
                display: block;
                line-height: 35px;
                background: #234A7A;
                background: -moz-linear-gradient(bottom,  #234A7A,  #26528D);
                background: -webkit-gradient(linear, left bottom, left top, from(#234A7A), to(#26528D));
                border-top: 1px solid #4871b0;
                border-left: 1px solid #3f6299;
                border-right: 1px solid #1b3a5f;
                border-bottom: 1px solid #000;
                text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.25);
                font-size: 1.083em;
            }

            .navigation ul li:first-of-type a
            {
                border-radius: 5px 0 0 0;
                -moz-border-radius: 5px 0 0 0;
                -webkit-border-radius: 5px 0 0 0;
            }

            .navigation ul li:last-of-type a
            {
                border-radius: 0 5px 0 0;
                -moz-border-radius: 0 5px 0 0;
                -webkit-border-radius: 0 5px 0 0;
            }

            .navigation ul li a:hover, .navigation ul li:hover a
            {
                background: #26528D;
                background: -moz-linear-gradient(bottom,  #26528D,  #436A9A);
                background: -webkit-gradient(linear, left bottom, left top, from(#26528D), to(#436A9A));
                text-decoration: none;
            }

            .navigation .sub
            {
                display: none;
                position: absolute;
                top: 36px;
                left: 0;
                bottom: auto;
                right: auto;
                width: 180px;
                text-align: left;
                z-index: 100;
                box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.25);
                -moz-box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.25);
                -webkit-box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.25);
                border-radius: 0 0 5px 5px;
                -moz-border-radius: 0 0 5px 5px;
                -webkit-border-radius: 0 0 5px 5px;
            }

            .navigation .last .sub
            {
                right: 0;
                left: auto;
            }

            .navigation .sub li
            {
                float: none;
            }

            .navigation li .sub li a
            {
                border: none;
                background: #26528D;
                border-top: 1px solid #3f6299;
                border-bottom: 1px solid #1b3a5f;
                text-align: left;
            }

            .navigation li .sub li:first-of-type a
            {
                border: none;
                border-bottom: 1px solid #1b3a5f;
                border-radius: 0;
                -moz-border-radius: 0;
                -webkit-border-radius: 0;
            }

            .navigation li .sub li:last-of-type a
            {
                border-radius: 0 0 5px 5px;
                -moz-border-radius: 0 0 5px 5px;
                -webkit-border-radius: 0 0 5px 5px;
                border: none;
                border-top: 1px solid #3f6299;
            }

            .navigation li .sub li a:hover, .navigation li .sub li:hover a
            {
                background: #26528D;
                background: -moz-linear-gradient(bottom,  #234A7A,  #537A9A);
                background: -webkit-gradient(linear, left bottom, left top, from(#234A7A), to(#56729D));
            }
        </style>
    </head>
    <body>
        <div id="wrapper">
            <div id="header">
                <div class="navigation">
                    <ul>
                        <li><a href="m1.html">M1</a>
                            <ul class="sub">
                                <li><a href="m1_1.html">M1_1</a></li>
                                <li><a href="m1_2.html">M1_2</a></li>
                                <li><a href="m1_3.html">M1_3</a></li>
                            </ul>
                        </li>
                        <li><a href="m2.html">M2</a>
                            <ul class="sub">
                                <li><a href="m2_1.html">M2_1</a></li>
                                <li><a href="m2_2.html">M2_2</a></li>
                                <li><a href="m2_3.html">M2_3</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:40:52.477

工作示例：http: [//jsfiddle.net/Xjj5W/5/](http://jsfiddle.net/Xjj5W/5/)

只需替换`.navigation .sub {`并`.navigation:hover .sub {`更改`display:none`为`display:block`.. 将 a 添加`display:none`到 .sub

```
.sub {
     display: none;
     }

.navigation:hover .sub {
     display: block;
     position: absolute;
     top: 36px;
     left: 0;
     bottom: auto;
     right: auto;
     width: 180px;
     text-align: left;
     z-index: 100;
     box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.25);
     -moz-box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.25);
     -webkit-box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.25);
     border-radius: 0 0 5px 5px;
     -moz-border-radius: 0 0 5px 5px;
     -webkit-border-radius: 0 0 5px 5px;
     } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:20:15.930

你需要改变

```
.navigation:hover 
```

将其更改为

```
li:hover 
```

[工作示例](http://jsfiddle.net/slfede/Q9qkT/6/)

如果您使用 .navigation:hover ，它将使用该 div 中所有元素的样式。如果您使用 li:hover ，它将为您悬停的 li 标签设置样式。

# drools - 在 drools-camel-server 重新加载远程 drools guvnor 资源

> ID：10852984
> 
> 赞同：4
> 
> 时间：2012-06-01T15:17:45.290
> 
> 标签：drools, reloading

我正在使用 drools-camel-server 5.4 final 来执行从 jboss AS7 上的 guvnor 获取的规则，如下所示：

```
 <drools:resource type="PKG" source="http://localhost:8080/drools-guvnor/org.drools.guvnor.Guvnor/package/mypackage/Test"
                            basic-authentication="enabled" username="test" password="test" />
    </drools:resources>
    <drools:ksession id="ksession1" type="stateless" 
            kbase="kbase" node="node1" /> 
```

如何重新加载或重建知识库，以便规则中的任何更改立即反映在执行服务器上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T09:17:55.977

是的，您可以通过添加知识代理和资源更改扫描仪...这是我的工作示例

```
<drools:resource-change-scanner id="s1" interval="10" enabled="true"/>
<drools:kagent kbase="kbase1" id="kagent" new-instance="false"/> 

<drools:grid-node id="node1"/>

<drools:ksession id="ksession1" type="stateless" kbase="kbase1" node="node1"/>

<drools:kbase id="kbase1" node="node1">
   <drools:resources>
      <drools:resource  type="DRL" source="classpath:test.drl"/>
   </drools:resources>
</drools:kbase> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T20:12:52.690

我遇到过同样的问题。在任何地方都找不到任何解决方案。我经历了反复试验，最终得到了似乎对我有用的东西。它检测我在 Guvnor 中的远程资源何时更新。

```
<drools:resource-change-scanner id="s1" interval="10" enabled="true" />
<drools:resource id="cs" type="CHANGE_SET" source="http://localhost:8080/drools-guvnor/rest/packages/com.test/assets/CHANGE_SET/source" basic-authentication="enabled" username="admin" password="admin" />

<drools:kagent kbase="kbase1" id="kagent" new-instance="false">
    <drools:resources>
        <drools:resource ref="cs" />
    </drools:resources>
</drools:kagent>

<drools:grid-node id="node1"/> 
<drools:ksession id="ksession1" type="stateless" kbase="kbase1" node="node1"/>

<drools:kbase id="kbase1" node="node1">
    <drools:resources>
        <drools:resource ref="cs" />
    </drools:resources>
</drools:kbase> 
```

# java - JBoss AS 7：通过代码配置将 Servlet 映射到上下文根（“/”）

> ID：10852985
> 
> 赞同：5
> 
> 时间：2012-06-01T15:17:46.187
> 
> 标签：java, jakarta-ee, servlets, jboss7.x

使用 JBoss AS 7，我正在尝试使用 Java 代码而不是 web.xml 配置我的 Servlet 3.0 容器。我的问题是，当我注册一个映射到上下文根（“/”）的 Servlet 时，默认的 servlet 优先处理请求。我试过 ServletContextListener 和 ServletContainerInitializer 都没有运气。

**尝试 1：ServletContextListener**

```
@WebListener
public class AppInitializer implements ServletContextListener {

    @Override
    public void contextInitialized(ServletContextEvent event) {
        ServletContext context = event.getServletContext();

        ServletRegistration.Dynamic homeServlet = context.addServlet("homeServlet", new HomeServlet());
        homeServlet.addMapping("/");
        homeServlet.setLoadOnStartup(1);
    }

    @Override
    public void contextDestroyed(ServletContextEvent event) {
        // Do nothing.
    }
} 
```

**尝试 2：ServletContainerInitializer**

```
public class AppInitializer2 implements ServletContainerInitializer {

    @Override
    public void onStartup(Set<Class<?>> classes, ServletContext context) throws ServletException {
        ServletRegistration.Dynamic homeServlet = context.addServlet("homeServlet", new HomeServlet());
        homeServlet.addMapping("/");
        homeServlet.setLoadOnStartup(1);
    }
} 
```

**附加信息**

*   如果我将映射从 更改`/`为`/example`，我的 Servlet 会正确处理对新路径的请求。
*   如果我`/`通过 web.xml 而不是 Java 代码注册我的 Servlet，我的 Servlet 会正确处理对上下文根的请求。

So… what can I do to register a Servlet to the context root via Java code without it being overridden by the DefaultServlet?

Thanks!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-01T20:31:35.183

I had the same problem using JBoss AS 7.1.1 and Spring MVC 3.2.3.RELEASE. Based on this from the [WebApplicationInitializer javadocs](http://static.springsource.org/spring-framework/docs/3.2.3.RELEASE/javadoc-api/org/springframework/web/WebApplicationInitializer.html):

> ## Mapping to '/' under Tomcat
> 
> Apache Tomcat maps its internal DefaultServlet to "/", and on Tomcat versions <= 7.0.14, this servlet mapping cannot be overridden programmatically. 7.0.15 fixes this issue. Overriding the "/" servlet mapping has also been tested successfully under GlassFish 3.1.

I don't think there's any way to map your servlet to the context root without a web.xml unless the servlet container is either upgraded or replaced. Looks like JBoss AS 7.1.1.Final uses JBoss Web 7.0.13, which I assume aligns with Tomcat 7.0.13, and programmatically overriding the DefaultServlet context root mapping is apparently impossible until version 7.0.15 plus.

In the meantime, either define your servlet mapping in web.xml or don't map to the context root. Bummers.

# javascript - Ember.js 在哪里调用 this._super()

> ID：10852988
> 
> 赞同：17
> 
> 时间：2012-06-01T15:18:11.560
> 
> 标签：javascript, ember.js, overriding

我一直在浏览 Ember 文档，发现`_super`在覆盖时调用方法的位置不一致`init`。

这是最常见的，也是我迄今为止一直在使用的

```
var Foo = Em.Object.extend({
    init: function(){
        this._super();
        // ... my stuff ...
    }
}); 
```

昨晚我正在阅读[这篇](http://emberjs.com/guides/view_layer/)文章并看到一个这样做的例子

```
var Bar = Em.Object.extend({
    init: function(){
        // ... my stuff ...
        return this._super();
    }
}); 
```

它实际上是`Ember.ContainerView`代码片段中的一个。

谁能解释一下？我的代码强迫症正在发作，直到我知道我才能继续前进。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-01T15:30:15.840

在链接的文档中

```
 init: function() {
    var childViews = this.get('childViews');
    var descriptionView = App.DescriptionView.create();
    childViews.pushObject(descriptionView);
    this.addButton();
    return this._super();
  }, 
```

`_super()`在创建 descriptionView 并将其推送到`childViews`数组后调用。

那是因为超类`init`实现将采用 childViews 数组并对其进行处理。如果您`_super`在将其添加到数组之前调用`descriptionView`，它不会被任何`init`处理......

我在推断，但这就是它在 Sproutcore 中的工作方式，Ember 就是从它派生的，所以我认为它可能是一样的。

# java - 如何进行沟通？

> ID：10852989
> 
> 赞同：1
> 
> 时间：2012-06-01T15:18:22.567
> 
> 标签：java, jakarta-ee

有一个叫做 XXXBean 的东西有一些生成事件的逻辑。还有一些类称为 ServletContextListener

```
<listener>
    <listener-class>XXXServletContextListener</listener-class>
</listener> 
```

来自 Bean 的事件如何发送到监听器？

**更新。**

我有一个在侦听器中运行的 Jetty WebSocket 服务器。

```
public class JettyServletContextListener implements ServletContextListener {

    private Server server = null;

    public void contextInitialized(ServletContextEvent event) {
            this.server = new Server();
            server.start();
    }

    public void contextDestroyed(ServletContextEvent event) {
        if (server != null) {
            server.stop();
        }
    }
} 
```

这个 Jetty 服务器应该通过 WebSocket 连接通知远程客户端有关 Bean 中的事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:22:52.840

你不能。 `ServletContextListener`s 只被告知有关上下文的事件，即它何时被创建和销毁。它们通常用于进行某种初始化。

检查[http://docs.oracle.com/javaee/5/api/javax/servlet/ServletContextListener.html上的文档](http://docs.oracle.com/javaee/5/api/javax/servlet/ServletContextListener.html)

# java - Java：使枚举绑定到不同的字符串值

> ID：10852991
> 
> 赞同：0
> 
> 时间：2012-06-01T15:18:23.987
> 
> 标签：java, enums

所以我有这样的东西

```
public enum DataType {

    RECORD_TYPE("0"),
    ...

    private String code;

    private DataType(String code){
         this.code = code;
    }

    public String getCode() {
         return code;
    }
} 
```

所以当我这样做的时候

```
System.out.println(DataType.RECORD_TYPE); 
```

它打印出字符串`RECORD_TYPE`，但我想打印出来`0`，我不想这样做

```
System.out.println(DataType.RECORD_TYPE.getCode()); 
```

因为我觉得用户很可能会忘记输入`getCode()`。我知道 Enum 没有`toString`方法，有没有办法让我在 java 将 Enum 转换为 String 时更改默认行为？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:19:55.077

> 我知道 Enum 没有 toString 方法

它实际上确实有[一个 toString 方法](http://docs.oracle.com/javase/7/docs/api/java/lang/Enum.html#toString%28%29)，就像任何`Object`s 一样，您可以覆盖它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T15:20:04.757

当然。覆盖`toString()`函数。

```
public String toString() {
  return code;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-01T15:20:21.390

将此 toString() 方法添加到您的枚举中

```
public String toString() {
    return getCode();
} 
```

# excel - 获取一列中前 30% 值的平均值

> ID：10852999
> 
> 赞同：2
> 
> 时间：2012-06-01T15:19:02.583
> 
> 标签：excel, excel-formula

我有一列列出了一堆数字。如何选择一列中前 30% 值的平均值：

```
'Values'
10
9
8
7
6
5
4
3
2
1 
```

所以，前 30% 是 '10, 9, 8'，平均值是 (10+9+8)/3 = 9

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T18:14:09.330

如果您使用的是 excel 2007 或更新版本，`=AVERAGEIF(A2:A10,">"&PERCENTILE(A2:A10,0.7))`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-01T18:42:54.273

在任何版本的 excel 中，您都可以按照 Sean 的建议使用 SUMIF/COUNTIF，即

`=SUMIF(A1:A10,">"&PERCENTILE(A1:A10,0.7))/COUNTIF(A1:A10,">"&PERCENTILE(A1:A10,0.7))`

或更短的“数组公式”

`=AVERAGE(IF(A1:A10>PERCENTILE(A1:A10,0.7),A1:A10))`

用 CTRL+SHIFT+ENTER 确认

这些都应该给出相同的结果

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:39:48.820

不使用 VBA：

将数据放入 A 列。

创建此中间列 B：

```
 B1=IF(RANK(A1,$A$1:$A$10)<=30*COUNT($A$1:$A$10)/(100), A1,0)
    B2=IF(RANK(A2, ... 
```

然后平均此列：

```
 =AVERAGEIF(B1:B10,">0") 
```

对于您给定的示例，您得到 9。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-01T21:09:34.280

您也可以在不使用公式的情况下通过包含列标题并选择：

*数据 > 过滤器 > 数字过滤器 > 前 10...（前 30%）*

Highlight the column to see sum, average, count, max. (Right-click the status bar and select "average" if not displayed.)

If you want the result of the filtered average in a cell you can use `=SUBTOTAL(1,A2:A11)`