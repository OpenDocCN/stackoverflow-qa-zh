# StackOverflow 问答 10644000-10644999

# javascript - 动态创建文件输入元素

> ID：10644001
> 
> 赞同：9
> 
> 时间：2012-05-17T21:49:05.500
> 
> 标签：javascript, html, file-io

我想自定义文件输入按钮，所以我使用这段代码来创建一个文件输入元素

```
function inputBtn(){
    var input=document.createElement('input');
    input.type="file";
    setTimeout(function(){
        $(input).click();
    },200);
}

<button id="ifile" onclick="inputBtn()">create</button> 
```

但是，当我单击创建时，它什么也没显示。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-17T21:54:29.387

您正在创建新的 DOM 元素，但并未将其附加到 DOM。你需要类似的东西：

```
document.getElementById('target_div').appendChild(input); 
```

你可以在这里看到它在一个做得不好的 JSFiddle 中是如何工作的：http: [//jsfiddle.net/JQHPV/2/](http://jsfiddle.net/JQHPV/2/)

# android - 我可以使用 ActionBarSherlock 隐藏标签栏的渐变边缘吗？

> ID：10644006
> 
> 赞同：1
> 
> 时间：2012-05-17T21:49:47.940
> 
> 标签：android, android-actionbar, tabbar, actionbarsherlock

我想隐藏标签栏的褪色边缘，但我正在使用 ActionBarSherlock。

```
<item name="android:fadingEdge">none</item>
<item name="android:fadingEdgeLength">0dp</item>
<item name="android:requiresFadingEdge">none</item> 
```

这就是我为 actionBarTabBarStyle 设置的样式，在 4.0 之前没有任何事情发生。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T08:59:51.217

您是否尝试过添加不带`android:`前缀的样式条目的副本？

```
<item name="android:fadingEdge">none</item>
<item name="fadingEdge">none</item>
<item name="android:fadingEdgeLength">0dp</item>
<item name="fadingEdgeLength">0dp</item>
<item name="android:requiresFadingEdge">none</item>
<item name="requiresFadingEdge">none</item> 
```

[这在 ABS迁移文档](http://actionbarsherlock.com/migration.html)的“主题”部分中进行了描述。

# java - Java双缓冲——访问backimage

> ID：10644011
> 
> 赞同：0
> 
> 时间：2012-05-17T21:50:43.800
> 
> 标签：java, graphics, awt, bufferedimage, doublebuffered

我正在尝试创建一个 java 游戏，它将`BufferedImage`与`BufferStrategy`. 为此，我希望能够访问实际的背景图像（并对其执行效果），而不仅仅是从`strategy.getDrawGraphics()`. 在网上搜索*并*通过`awt`源代码后，我无法找到该图像的实际位置或如何访问它。有人知道吗？我应该只使用自己的缓冲图像并绘制到该图像，然后将其粘贴到背景图像`Graphics`吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:37:12.573

实际存储在直接知道的子类中指定，`Component.BltBufferStrategy`并且`Component.FlipBufferStrategy`; 它被有意隐藏为实现细节。`JPanel`默认情况下是双缓冲的。只需更新您的`BufferedImage`并渲染它，如此[处](https://stackoverflow.com/a/3256941/230513)、[此处](https://stackoverflow.com/a/5864503/230513)或[此处](https://stackoverflow.com/a/10208380/230513)所示。

# ios - 在 iOS 上，在屏幕上绘制任何东西的整体机制是什么？

> ID：10644014
> 
> 赞同：2
> 
> 时间：2012-05-17T21:50:49.357
> 
> 标签：ios, cocoa-touch, user-interface

一开始我想知道为什么如果我们子类化`UIView`，并且我们实现了一个`drawRect`要调用的方法，但同时，如果我们在这个视图中添加按钮或标签，并调整它们的位置坐标，它们也会被重新绘制...... ..所以这个视图似乎有两种绘制机制，一种用于自身，另一种用于此视图中的对象。

但事实证明，似乎每 1/60 秒，整棵树就被遍历一遍。从顶视图对象开始，iOS 会访问所有的子对象，然后调用`drawRect`，`self`子对象也以同样的方式被访问，孙子对象被访问，并且`drawRect`为每个第一级子对象调用，如下所示：

```
-(void) processViewObject:(UIView *) obj {
    // pseudo code:
    foreach children "c" already sorted by zOrder from most negative to -1
        processViewObject(c)    // recursion

    if ([self needsUpdateOrNot] == YES)
        [self drawRect]

    foreach children "c" already sorted by zOrder from 1 to the greatest number
        processViewObject(c)   // recursion
} 
```

并且每 1/60 秒拨打一次电话，对于

```
processViewObject(topViewObject);    //  start from the topmost view object 
```

这样任何视图都可以在`drawRect`和视图的子视图中绘制自己，如果它们的任何位置坐标被修改，或者如果它们的内容发生变化，那么脏位`needsUpdateOrNot`已经设置得更早，因此`drawRect`将调用它们来重新绘制自己。

或者实际上，如果设置了视图的脏位，那么可能该位将在递归中传递给子项，如下所示：

```
 foreach children "c" already sorted by zOrder from 1 to the greatest number
        processViewObject(c, [self needsUpdateOrNot]) 
```

这样如果设置了父级的脏位，那么子级也需要重新绘制，以便正确绘制该视图内的整个图片。

此外，每个漂亮的按钮或标签都只是一个`UIView`对象，`drawRect`已经实现了一个可以绘制漂亮图像的对象——按钮、复选框、标签或任何其他小部件。

这就是一切如何在屏幕上绘制的整体机制？我听说过“从不调用`drawRect`自己，而是让它被调用”，但从来没有完全理解为什么，但如果以上是整体机制，那么看起来就是这个原因。

我想知道这是否与Microsoft Windows或任何GUI操作系统上实际上几乎相同的机制相同，并且在某些游戏框架上，我认为无论是否设置了脏位，都会绘制所有内容，因为据说，事情在游戏中一直在移动，无论如何，框架只是每 1/60 秒绘制一次。

上面的`zOrder`处理顺序是在某个框架的代码中，所以先绘制所有负zOrder子项，然后`self`绘制，再绘制所有正zOrder子项。（这就是 zOrder 是如何以 Painter Model 的方式在屏幕上绘制事物的方式实现的——后者绘制的将掩盖之前绘制的。）如果相对于子项的 zOrder 也是如此——zOrder 的`self`数量如果它是相对于它自己的兄弟姐妹，而不是相对于它的孩子。`0``self`

以上准确吗？如果给出答案，如果可能的话，是否可以引用部分源代码或参考，以便我们知道它是如何工作的标准或官方方式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T17:44:57.797

我认为您将合成与绘图混淆了。这两个是不同的概念，它们在不同的点上发挥作用。

在 iOS 上，每个 UIView 都由一个 CALayer 支持，它实际上是一个围绕矩形 OpenGL ES 纹理的轻量级包装器。当一个 UIView 需要完全重绘时（第一次出现，或者在不同情况下强制重绘时），`-drawRect:`会触发并使用 Core Graphics 将矢量图形渲染为位图。然后该位图通过 CALayer 上传到 GPU 并存储在那里。

当需要移动视图或对其应用简单的变换（旋转、缩放等）时，不会重绘它，只需移动支持层并合成可见场景中的层。同样，每个视图和子视图都有自己的支持层，因此它们在视图（层）层次结构中按 Z 顺序组合。在 GPU 上进行合成是一项非常快的操作，比初始绘制视图要快得多。这就是在 iOS 中实现平滑滚动或动画的原因，因为这些底层矩形图像只是在 GPU 上移动并合成。这也是为什么在视图和图层中具有透明度会减慢滚动等操作的速度，因为合成非透明图层比不透明图层慢得多。

当您移动位于它们上方的子视图或其他视图时，不会重绘视图的重叠部分，因为合成会处理可见和不可见的内容。实际重绘发生的唯一时间`-drawRect:`是当您使用`-setNeedsDisplay`强制重新渲染或设置`needsDisplayOnBoundsChange`CALayer 时，它会根据大小或形状的变化重新绘制自身。

我相信 jturton 链接到的部分文档在涉及 iOS 或 Mac 上的图层支持视图时是不正确的。它似乎是在 Mac 缺少 Core Animation 时编写的，并且是呈现非层支持的 NSView 的方式，因此它可能是从较旧的参考中复制和粘贴的。支持图层的视图不是这种情况，当部分被遮挡时，它们不会重绘自己。您可以通过`-drawRect:`在支持层的 UIView 中记录何时调用来自己测试这一点，并且您会发现当视图只是在彼此之上移动时不会触发它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T05:54:32.137

视图是从底部（z 方向）向上绘制的。不透明视图等有各种优化。所有标记为脏的视图都在运行循环结束时重新绘制 - 没有你怀疑的每 1/60 秒的机制。

参考：[https ://developer.apple.com/library/ios/documentation/general/conceptual/Devpedia-CocoaApp/DrawingModel.html](https://developer.apple.com/library/ios/documentation/general/conceptual/Devpedia-CocoaApp/DrawingModel.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T06:19:07.413

来自jrturton 引用的[文档](https://developer.apple.com/library/ios/#documentation/general/conceptual/Devpedia-CocoaApp/DrawingModel.html)

> iOS 和 Mac OS X 中的绘图遵循两种技术路径之一，并基于视图按需更新其外观的模型

我认为这将解决定期更新观点的问题。视图只会按需更新，这是可以理解的，因为 iphone 仍然是一个嵌入式设备。处理器/内存越少越好。它也必须考虑电池寿命。

> 视图更新的一些情况（再次来自文档）
> 
> *   用户移动或移除部分遮挡另一个视图的视图。
> *   用户将视图从包含的滚动视图中滚动出来，然后再将其滚动回来。
> *   代码通过将其 hidden 属性设置为 NO 使先前隐藏的视图再次可见。
> *   代码显式地使视图无效 要使视图无效并因此将其标记为重绘，您可以在视图上调用诸如 setNeedsDisplay 或
>     setNeedsDisplayInRect: 之类的方法。
> 
> 在主事件循环的一个周期结束时，窗口会沿着其视图层次结构向下移动，并通过调用它们的 drawRect: 方法请求**这些**视图自己绘制。

因此，在主事件循环中，窗口（顺便说一句，它是父级）遍历整个树层次结构，但只更新需要更新的子级。其他视图保持原样..

# html - float=left 的 div 的行为，当它们在 div 容器中时需要接收相同的行为

> ID：10644016
> 
> 赞同：0
> 
> 时间：2012-05-17T21:51:13.777
> 
> 标签：html, css, css-float

**记住：** 想象一下这些元素在屏幕上的行为：当屏幕上有超过 100 个元素时`<div>`使用样式。`float: left; height: 100px; width: 100px`当您将窗口大小调整为低宽度时：**div 将被向下推**

**示例** [http://1lj.net/ex2.html](http://1lj.net/ex2.html)

**我需要什么：** 我需要子 div 像链接的示例一样，问题是它们位于固定宽度的容器中。例如。`<div class=container style="width:800px">`

**如何获得这种行为？**

对不起我的英语，用非母语写真的很难。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:03:00.343

```
<div style="float:left;width:500px"></div><div style="float:left;width:500px"></div> 
```

会变成 ...

```
 <div style="float:left;width:500px"></div>
 <div style="float:left;width:500px"></div>  ( like text wraps) 
```

...当窗口大小不足以容纳它们时

为防止这种情况，请添加一个具有宽度的容器...

```
 <div style="width:1000px">
  <div style="float:left;width:500px"></div><div style="float:left;width:500px"></div>
 </div> 
```

*   仅使用内联样式以方便演示

更新为注释：对于非固定宽度，相同，但使用百分比

```
 <div style="width:100%">
  <div style="float:left;width:50%"></div><div style="float:left;width:50%"></div>
 </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:23:23.873

你需要两个容器。一个容器用于最大宽度，另一个用于容纳盒子。

CSS：

```
.container
{
    height:auto;
    max-width: 800px;
    margin: 0 auto;
    background-color: #666666;
}

.containercontent {
    position: relative;
    width: auto;
    margin: 0 auto;
} 
```

HTML：

```
<div class="container"> <!-- Add this container -->
<div class="containercontent">

<h2>Lalalalal.</h2>

<div class="box" id=box1></div>
<div class="box" id=box2></div>
<div class="box" id=box3></div>
<div class=box id=box4></div>
<div class=box id=box5></div>
<div class=box id=box6></div>
<div class=box id=box7></div>
<div class=box id=box8></div>
<div class=box id=box9></div>
<div class=box id=box10></div>
<div class=box id=box11></div>
<div class=box id=box12></div>
<div class=box id=box13></div>
<div class=box id=box14></div>
<div class=box id=box15></div>
<div class=box id=box16></div>
<div class=box id=box17></div>
<div class=box id=box18></div>
<div class=box id=box19></div>
<div class=box id=box20></div>

</div>
<div class="clean"></div>
</div> 
```

# c# - 如何隐藏 XML 配置文件

> ID：10644018
> 
> 赞同：3
> 
> 时间：2012-05-17T21:51:27.617
> 
> 标签：c#, wpf, xml

我刚刚完成了我的应用程序并完成了构建它。一切正常。

然后我注意到文件夹中有一个 XML 配置文件，所以我单击它。

就是这样，我的整个连接字符串以及我的远程 sql 服务器 IP 地址、登录用户名和登录密码，所有人都可以看到。

我尝试删除 XML 配置文件并运行程序，它只是在文件夹内创建了一个 App_Data 文件夹，并带有一个默认数据库。

有什么方法可以隐藏 XML 配置文件或使其不可读，因为它包含我所有的连接信息。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T21:55:58.077

查看这篇关于保护连接字符串的 MS 文章：

[https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/protecting-connection-information](https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/protecting-connection-information)

或者，将连接字符串硬编码到您的应用程序中（注意：恶意用户可以相当容易地对 .net 应用程序进行逆向工程），或者尽可能使用集成安全性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T21:54:33.813

您可以对其进行加密：[http ://chiragrdarji.wordpress.com/2008/08/11/how-to-encrypt-connection-string-in-webconfig/](http://chiragrdarji.wordpress.com/2008/08/11/how-to-encrypt-connection-string-in-webconfig/)

或尽可能使用集成安全性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T21:56:15.943

任何隐藏连接字符串的尝试只会使您和任何攻击者都更难以访问。这并不罕见，但不是很安全，而且确保定期密码轮换也存在问题。

如果可以，请切换到集成安全性。（包括`Integrated Security=SSPI`在连接字符串中，但没有用户名或密码。）连接将使用您自己的用户帐户（或运行您的代码的帐户）创建，假设

*   您正在使用 MS SQL Server
*   SQL Server 位于同一系统或同一 AD 域中，因此能够识别该帐户。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-17T22:22:23.023

无论您做什么，专用的调试器都几乎可以看到您的连接字符串。

请记住，如果您可以`Connection.ConnectionString`在调试会话中查看，那么使用 WinDBG 或 Visual Studio 的用户也可以。因此，即使您加密文件，用户也可以让您解密然后检查明文值。

这就是为什么许多需要来自服务器的信息的客户端应用程序（尤其是移动应用程序）通常不直接连接到数据库的原因。相反，它们通常连接到服务。然后，您根据您的服务授权和验证用户。

# search - RavenDB：如何在单个查询中查询许多不同的文档？

> ID：10644029
> 
> 赞同：2
> 
> 时间：2012-05-17T21:52:55.320
> 
> 标签：search, ravendb

我是 RavenDB 的新手，我不确定如何解决这个问题。

我有一个包含大约 200 种不同文档类型的文档存储。每种类型都可以包含数千个文档。
在我的业务逻辑中，所有不同的文档类型都被视为相同 - 它们都可以映射到通用对象，例如 DataTable。

我想在一次自由文本搜索中查询所有类型的所有文档的所有属性。最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T07:33:45.377

您可以使用多地图来做到这一点。看看这个帖子：

[http://ayende.com/blog/156225/relational-searching-sucks-donrsquo-t-try-to-replicate-it](http://ayende.com/blog/156225/relational-searching-sucks-donrsquo-t-try-to-replicate-it)

# json - WCF 不返回 JSON 数据或大量数据出错

> ID：10644032
> 
> 赞同：2
> 
> 时间：2012-05-17T21:52:59.373
> 
> 标签：json, wcf

我有一个 WCF Web 服务，它将数据构建到类中，然后由 WCF 自动序列化为 JSON（`[WebGet(ResponseFormat = WebMessageFormat.Json,...)]`并返回到客户端。在我有大量数据之前一切正常。我的 Web 配置设置最大值为 2147438647 .奇怪的是,类在被WCF服务传回之前被填充并且不为空.但是客户端永远不会收到数据也不会收到错误消息并且IIS/WCF不会抛出任何类型的异常.它是如果数据凭空消失。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T21:59:56.967

“客户端从不接收数据”是什么意思？连接掉线了？它收到一个0字节的响应？

WCF 中有许多配额，但它们主要用于传入数据。有一个用于传出数据，您可能会遇到它，它是`maxItemsInObjectGraph`，可以为大型对象图触发。您应该在服务器中启用跟踪，并且跟踪应该有一个异常事件，可以阐明问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T07:29:12.387

检查你的 web.config ..确保你有这个

```
<system.webServer>
    <security>
      <requestFiltering>
        <requestLimits maxAllowedContentLength="4294967295"/> 
      </requestFiltering>
    </security>
  </system.webServer> 
```

maxAllowedContentLength 限制/设置上传大小..

# dll - 用于 DLL 的 ASP Classic 包装器

> ID：10644034
> 
> 赞同：0
> 
> 时间：2012-05-17T21:53:04.310
> 
> 标签：dll, com, asp-classic

我希望使用我的 ASP Classic 代码中的特定 API。API 以 .h 和 lib 文件的 DLL 形式出现。我已经设法使用我自己的 Windows C++ 应用程序中的 api。我现在希望对 ASP 做同样的事情。这个 API 还有一个 .NET Wrapper，我还没有检查过。

此外，我们将在未来某个阶段迁移到 ASP .NET 或 Python Django。

你会建议我如何包装这个 API？

谢谢，

巴里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T22:03:52.637

最好的方法是将需要用作 COM 对象的 DLL API 包装起来。

最初的 ASP 模型利用 COM 与本机代码交互。

# python - 使用 apache 部署 Web 应用程序后 Popen 的意外行为

> ID：10644037
> 
> 赞同：0
> 
> 时间：2012-05-17T21:53:21.950
> 
> 标签：python, django, apache, subprocess, mod-wsgi

我有一些代码使用子进程来查看 git 目录中的日志。在本地 django 开发环境中执行时，我的代码似乎工作正常。但是，一旦部署（使用 Apache / mode_wsgi），stdout read() 的输出就会返回空。我的开发和生产机器现在是一样的，我也尝试确保每个文件都是可读的。

有谁知道为什么 Popen 在这里部署后不返回任何输出？谢谢。

```
def getGitLogs(projectName, searchTerm=None, since):
    os.chdir(os.path.join(settings.SCM_GIT, projectName))
    cmd = "git log --since {0} -p".format(since)
    p = subprocess.Popen(cmd, shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, close_fds=True)
    output = p.stdout.read()
    ### here output comes back as expected in dev environment, but empty in once deployed
    return filterCommits(parseCommits(output), searchTerm) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T06:10:34.907

1.  将您的链接`chdir`作为命令的一部分（即，`cd /foo/bar/zoo`）
2.  将完整路径传递给`git`

所以你的命令会结束`cd /foo/bar/zoo && /usr/bin/git log --since`

# compiler-errors - 黑莓网络工程编译错误

> ID：10644042
> 
> 赞同：1
> 
> 时间：2012-05-17T21:53:54.087
> 
> 标签：compiler-errors, blackberry-webworks

当我为黑莓编译我的应用程序时，我一直遇到错误。我尝试使用 Ripple 和 SDK 编译器，但我一直遇到同样的问题。![在此处输入图像描述](../Images/2f86f2e7732a3fb99c59de4291647071.png)

如您所见，我收到一个错误，但没有相关的错误消息，只是 ERROR。.bar 文件仍会创建，但应用程序不会在模拟器中初始化。关于我做错了什么的任何想法？

谢谢！

# c# - 停止多线程 Windows 服务

> ID：10644043
> 
> 赞同：6
> 
> 时间：2012-05-17T21:54:02.290
> 
> 标签：c#, multithreading, windows-services, threadpool

我在 .Net 3.5 中有一个多线程 Windows 服务，当创建多个线程时，我无法正确停止该服务。

该服务过去只创建一个线程来完成所有工作，而我只是将其更改为多线程。它工作得很好，但是当服务停止时，如果有多个线程正在执行，它会挂起服务，直到所有线程都完成。

当服务启动时，我创建了一个后台线程来处理主进程：

```
 protected override void OnStart(string[] args)
    {
        try
        {
            //Global variable that is checked by threads to learn if service was stopped
            DeliveryConstant.StopService = false;
            bool SetMaxThreadsResult = ThreadPool.SetMaxThreads(10, 10);

            ThreadStart st = new ThreadStart(StartThreadPool);
            workerThread = new Thread(st);
            workerThread.IsBackground = true;
            serviceStarted = true;
            workerThread.Start();
        }
        catch (Exception ex)
        {
            //Log something;
        } 
```

这是 StartThreadPool 方法：

```
 //Tried with and without this attribute with no success...
    [System.Runtime.CompilerServices.MethodImpl(System.Runtime.CompilerServices.MethodImplOptions.Synchronized)]
    public void StartThreadPool()
    {
        while (serviceStarted)
        {
            ProcessInfo input = new ProcessInfo();

            try
            {
                int? NumPendingRequests = GetItems(50, (Guid?)input.ProcessID);

                if (NumPendingRequests > 0)
                {
                    input.ProcessType = 1;
                    input.ProcessID = Guid.NewGuid();
                    ThreadPool.QueueUserWorkItem(new WaitCallback(new DispatchManager().ProcessRequestList), input);
                 }
            }
            catch (Exception ex)
            {
                //Some Logging here
            }
        }

        DeliveryConstant.StopService = true;
    } 
```

我在一个单独的类中创建了一个静态变量来通知线程该服务已停止。当这个变量的值为真时，所有线程都应该停止主循环（每个循环一个）：

```
 public static bool StopService; 
```

最后，OnStop 方法：

```
protected override void OnStop()
    {
        DeliveryConstant.StopService = true;

        //flag to tell the worker process to stop
        serviceStarted = false;

        workerThread.Join(TimeSpan.FromSeconds(30));
    } 
```

在 ProcessRequestList 方法中，在每个 foreach 结束时，我都会检查 StopService 变量的值。如果是真的，我会打破循环。

问题是：线程是按 50 个项目的块创建的。当我在数据库中有 50 个或更少的项目时，只创建一个线程，并且一切正常。当我有超过 50 个项目时，会创建多个线程，当我尝试停止服务时，它不会停止，直到所有后台线程完成。

从日志中，我可以看到 OnStop 方法仅在所有线程完成后执行。

任何线索可以改变什么来解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-17T22:50:00.640

此[博客答案](http://www.c-sharpcorner.com/Forums/Thread/46043/thread-pool-with-windows-service.aspx)指出，在所有 ThreadPool 任务完成之前不会调用 OnStop，这对我来说是新闻，但可以解释您的问题。

I've fielded many multi-threaded Windows Services but I prefer to create my own background threads rather than use the ThreadPool since these are long-running threads. I instantiate worker classes and launch their DoWork() method on the thread. I also prefer to use callbacks to the launching class to check for a stop signal and pass status rather than just test against a global variable.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-17T22:11:48.990

您缺少访问 的内存屏障`StopService`，如果您有多个 CPU，这可能是个问题。更好地锁定所有对共享变量的访问的任何引用对象。例如：

```
object @lock;

...

lock (@lock)
{
    StopService = true;
} 
```

**编辑**：正如另一个答案所揭示的那样，**这个问题不是锁定问题**，但我将这个答案留在这里作为检查多线程同步方案的事情。

使共享变量 volatile 在许多情况下也可以工作，但证明正确更复杂，因为它不会发出完整的栅栏。

# linux - 作业完成时执行命令

> ID：10644051
> 
> 赞同：0
> 
> 时间：2012-05-17T21:54:46.937
> 
> 标签：linux, bash, nohup

我想要一个 bash 脚本在某个作业完成时执行一个命令（报告状态信息）。我正在运行（使用脚本）许多程序并使用 nohup 将它们发送到后台。当他们完成时，我想执行一个收集信息并报告它的脚本。请注意，我知道我可以有一个带有 sleep 的 for 循环，它会主动检查 pid 是否仍在作业列表中。但我想知道是否有办法告诉系统运行这个脚本，例如通过向 nohup 添加选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T21:59:34.867

您可以`nohup`使用一个脚本来运行您想要运行的命令，然后再运行完成后的作业。

例如，创建`runtask.sh`：

```
runjob
collect_and_report 
```

接着：

```
% nohup runtask.sh 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T01:27:03.707

这可能对您有用：

```
{script; report} &
disown -h 
```

或者，使其有条件：

```
{script && report} &
disown -h 
```

你甚至可以这样做：

```
{script && report || fail} &
disown -h 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:29:16.677

在函数中启动您的工作，并在后台启动该函数。

```
task1plus () {
  task1 
  whenFinished1  
}

task2plus () {
  task2
  whenFinished2
}

task3plus () {
  task3
  whenFinished3
}

task1plus &
task2plus &
task3plus & 
```

# sql - 如何列出 netezza 数据库中的所有序列？

> ID：10644061
> 
> 赞同：0
> 
> 时间：2012-05-17T21:56:02.560
> 
> 标签：sql, database, netezza

是否可以运行查询来显示在 netezza 数据库中创建的所有现有序列？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T06:55:18.067

快速谷歌搜索出现了系统管理员指南的副本：

[http://www.scribd.com/chiruthac/d/63476250-Netezza-System-Admin-Guide#outer_page_459](http://www.scribd.com/chiruthac/d/63476250-Netezza-System-Admin-Guide#outer_page_459)

据此，该声明应为：

```
select *
from  _v_sequence 
```

# java - 日期时间转换

> ID：10644065
> 
> 赞同：0
> 
> 时间：2012-05-17T21:56:19.357
> 
> 标签：java, sms, datetime-format

任何人都可以帮助我在 Java 中转换 DATETIME 函数。我以这种格式“Fri May 18 09:22:39 FJT 2012”从 SMS 标头中检索日期时间格式。我想将其转换为这种格式“2012-05-18 09:51:42.39”。谁能帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T22:45:48.150

正如@Guillaume 建议的那样，使用[SimpleDateFormat](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html)。这是一个例子：

```
public String convert() throws ParseException  { 
    SimpleDateFormat format = new SimpleDateFormat("EEE MMM dd HH:mm:ss zzz yyyy");
    Date output =  format.parse("Fri May 18 09:22:39 FJT 2012");
    Calendar outputCal = Calendar.getInstance(format.getTimeZone());
    outputCal.setTime(output);
    return String.format("%04d-%02d-%02d %02d:%02d:%02d",outputCal.get(Calendar.YEAR),     outputCal.get(Calendar.MONTH)+1,  outputCal.get(Calendar.DAY_OF_MONTH), outputCal.get(Calendar.HOUR_OF_DAY), outputCal.get(Calendar.MINUTE), outputCal.get(Calendar.SECOND));
} 
```

一切都是硬编码的——你必须根据需要添加参数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T22:47:36.057

```
import java.text.SimpleDateFormat; 
```

...

```
String d = "Fri May 18 09:22:39 FJT 2012";
SimpleDateFormat inputFormat  = new SimpleDateFormat("EEE MMM d HH:mm:ss ZZZ yyyy");
SimpleDateFormat outputFormat = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss.SS");
outputFormat.setTimeZone(TimeZone.getTimeZone("GMT"));  // set yr time zone for output
Date date = inputFormat.parse(d);
System.out.println(outputFormat.format(date)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T22:07:33.960

为此目的使用[SimpleDateFormat 。](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)虽然我不确定 Java 中是否知道时区“FJT”。所以你可能需要为此做一些技巧。

# javascript - 全部设置 的在html文档中到文档的宽度和高度？

> ID：10644069
> 
> 赞同：0
> 
> 时间：2012-05-17T21:56:35.167
> 
> 标签：javascript

如果不使用 jquery（即只使用旧的 javascript），如何将 html 文档中的所有画布设置为文档的宽度和高度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:15:25.843

**注意**：Chief 和 Naelio 的回答在技术上都是**不正确**的。

* * *

**Naelio：** 更改画布的**样式**将更改画布的**CLIENT WIDTH**和**CLIENT HEIGHT**而不是**实际**的宽度和高度，因此画布的内容最终将被缩放/拉伸。
这个问题的例子在这里：http: [//jsfiddle.net/AnLCw/1/](http://jsfiddle.net/AnLCw/1/)（注意黑色50x50正方形是如何使用样式方法拉伸的）

* * *

**Chief17**：您不能以百分比指定画布的宽度和高度。此处的问题示例：http: [//jsfiddle.net/Sg7cb/2/](http://jsfiddle.net/Sg7cb/2/) （请注意，当宽度和高度为百分比时，不会显示画布）

* * *

所以这是**实际的解决方案**：

您需要将画布的样式设置为：宽度：100% 和高度：100%

```
canvas.style.width = "100%"
canvas.style.height = "100%" 
```

然后做：

```
canvas.width = canvas.clientWidth
canvas.height = canvas.clientHeight 
```

此处的工作示例：http: [//jsfiddle.net/acYdc/1/](http://jsfiddle.net/acYdc/1/) （注意黑色方块如何正确绘制并且画布填充该区域。）

另一种解决方案就是设置

```
canvas.width = window.innerWidth;
canvas.height = window.innerHeight; 
```

但 canvas.width = canvas.clientWidth 方法更灵活。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T22:06:55.093

我在这里创建了一个 jsFiddle：http: [//jsfiddle.net/ZrfeV/](http://jsfiddle.net/ZrfeV/)

您需要为文档指定一个高度，以便画布知道要扩展到多大，否则它将扩展到文档通过其子元素的内部高度获得的任何高度。

```
var canvases = document.getElementsByTagName('canvas');

for (var i = 0; i < canvases.length; i++) {

    canvases[i].style.width = '100%';
    canvases[i].style.height = '100%';
    canvases[i].width = canvases[i].clientWidth;
    canvases[i].height = canvases[i].clientHeight;

} 
```

# exe4j - exe4j 失败，无法创建临时目录（可能导致 Windows 错误 7）

> ID：10644079
> 
> 赞同：1
> 
> 时间：2012-05-17T21:57:32.960
> 
> 标签：exe4j

我们使用 exe4j 4.4.4 构建一个运行我们的 Java 程序的 exe。我们的一位客户抱怨说，有时他们在运行我们的 exe 时会收到“Windows 错误 7”。这只会间歇性地发生，并且仅在数百台机器上发生。

我们启用了 exe4j 调试，并注意到当我们收到错误时，exe4j 日志文件包含多个条目，如下所示，然后结束。但是，在成功启动 exe 时，日志文件会超出这些条目并最终启动我们的 Java 程序。

当我们收到错误时，这些是 exe4j 日志文件中的最后几条日志消息： *GetTempPath returned 14 (last error 183)
make dir returned -1
tempPath is C:\WINNT\TEMP\
tempFile is C:\WINNT\TEMP\e4j38。 tmp
临时目录：C:\WINNT\TEMP\e4j38.tmp_dir
无法创建目录 (183)
GetTempPath 返回 14 (最后一个错误 183)
make dir 返回 -1
tempPath 为 C:\WINNT\TEMP\
tempFile 为 C:\WINNT\ TEMP\e4j39.tmp
临时目录：C:\WINNT\TEMP\e4j39.tmp_dir
无法创建目录 (183)
GetTempPath 返回 14（最后一个错误 183）
make dir 返回 -1
tempPath 为 C:\WINNT\TEMP\
tempFile 为 C :\WINNT\TEMP\e4j3A.tmp
临时目录：C:\WINNT\TEMP\e4j3A.tmp_dir
无法创建目录 (183)*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T16:32:40.843

exe4j 中有一个错误，导致它在一堆应用程序重新启动后循环浏览其临时文件夹。Exe4j 在 4.4.5 版本中通过在临时文件夹的名称中添加时间戳来减少临时文件夹冲突的机会。

# scala - 退出演员没有错误消息

> ID：10644085
> 
> 赞同：1
> 
> 时间：2012-05-17T21:57:58.623
> 
> 标签：scala, actor

这是我正在开发的聊天中的一个问题。有一个带有 main 方法的 main/gui 对象，一个发送消息的 Actor 发送者和一个接收消息的 empfänger。问题是让 empfänger 使用 main/gui 对象的函数来显示传入的消息。因为不起作用，所以我简化了它，但我仍然没有得到问题。谁能告诉我为什么这在终端什么都不返回？我究竟做错了什么？

```
import scala.actors._
object main_object {
    def infoterm(msg: String) = {
        println(msg)
    }
    def main(args: Array[String]) = {
    println("hallo")
    empfänger ! "foo"

    }
}

object empfänger extends Actor{
    var port = 50042
    var name = "local"
    var continuevar = true
    def foo(in: String) = {
        println("foo-empfänger" + in)
    }
    def act() {
        println("ydfjskj")
        test2.infoterm("tut")
        println("Empfänger gestartet")
        while(continuevar) {
            react {
                case msg:String  => {
                    println("empfänger" + msg)
                    test2.infoterm(msg)
                    foo("empfänger" + msg)
                }
            }
        }
    }
} 
```

谢谢你的帮助，但我还是不明白。我按照你告诉我的那样进行了修改，但它仍然无法正常工作。

只有通过定义 Actor empfänger，整个程序才会停止工作，如下所示：

```
import scala.actors._
object test2 {
    def infoterm(msg: String) = {
        println(msg)
    }
    def main(args: Array[String]) = {
    println("hallo")
    }
}

object empfänger extends Actor{
    def act() {
        // test2.infoterm("tut")
        // println("Empfänger gestartet")
        loop {
            react {
                case msg:String  => {
                    if(msg == "Stop") exit()
                    else {
                    println("empfänger" + msg)
                    // test2.infoterm(msg)
                    }
                }
            }
        }
    }
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T07:09:15.197

在接收到事件时，actor 内部有两种循环方式：

1.  接收时
2.  循环反应

您正在使用两者的混合物（即 while-react）。这根本行不通，原因如下：

### 收到

Receive*阻塞当前执行线程*等待消息处理。它可以在while循环中使用；尽管您应该很少使用它，因为它将一个参与者绑定到一个线程 - 即它不可扩展，因为每个参与者使用 1 个线程。

### 反应

请注意，该`react`方法的签名表明它的返回类型是`Nothing`. 这意味着该方法*无法正常终止*；它必须永远不会返回或抛出异常。事实上后者发生了；它使用异常作为流控制机制，仅当您`react`在内部使用时才有效`loop`（假设您想要持续处理事件）。所以你的`act`方法应该是这样的：

```
def act() {
  loop {
    react {
      case msg: String => 
    }
  }
} 
```

非常值得看一下 actor 源代码，以了解异常流控制是如何工作的，因为它是一件美丽的事情。

### 错误消息：链接参与者

这是我为演员框架而苦苦挣扎的事情。如果演员的反应引发异常，演员退出并且没有记录是很常见的，这是 sys-out 或 sys-err。这可能非常令人沮丧。

我强烈建议将*金丝雀*演员链接到每个系统演员以监听退出，如下所示：

```
def act() {
  import Actor._
  self link actor {
    case Exit(from, msg) => /* your logging here */
  }
  loop { ...
  }  
 }
} 
```

但是，这在您的情况下**不起作用**（再次，非常令人沮丧），因为您的整个`act`方法都会引发异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T12:05:17.170

演员不会自动启动，那将是一件坏事。您必须显式调用“开始”方法，即在您的 main() empänger.start()

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:19:00.760

您在 act 方法中使用了一个 while 循环。Actor 异步工作并在收到消息时被激活。使用`loop {}`代替，`while`它应该可以工作。要停止一个演员，你必须向它发送一条消息`'stop`，并在你的`act`方法中使用`exit`.

# clojure - 如何在 uberjar 进程中添加钩子（使用 lein 构建）

> ID：10644087
> 
> 赞同：4
> 
> 时间：2012-05-17T21:58:00.777
> 
> 标签：clojure, leiningen, uberjar

我想在 uberjar 进程中添加一个钩子。具体示例是将 maxmind geoip dat 文件下载到资源文件夹中，以便每次部署时都会将更新版本捆绑到 jar 中。示例/建议感谢感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-18T22:50:14.073

我建议制作一个调用 uberjar 的自定义 lein 任务，而不是使用钩子。例如，如果您的项目名为 foo：

`file: foo/tasks/leiningen/foobuild.clj`

```
(ns leiningen.foobuild
  (:require leiningen.uberjar))

(defn foobuild [project]
  (download-maxmind-geoip-data)
  (leiningen.uberjar/uberjar project)) 
```

然后你可以运行它：

`lein foobuild`

# c - 我没有看到 SSHv2 子系统的打印结果

> ID：10644090
> 
> 赞同：0
> 
> 时间：2012-05-17T21:58:32.293
> 
> 标签：c, linux, ssh

我正在尝试创建一个 SSH 子系统。所以我通过添加以下行来配置文件：“/etc/ssh/sshd_config”：“子系统测试/home/test”。

这是测试应用程序的内容：

```
int main()
{
        int i=0;
        int j=0;

        printf("Hello world!\n");
        for (j=0;j<10;j++)
        {
            scanf ("%d",&i);
            printf ("Printed :   %d\n",i);
        }
        return 0;
    } 
```

我的问题是，当我从远程 ssh 连接（ ssh -2 -s test user@host ）执行此操作时，我只能输入数据而看不到打印的文本。（只有在申请结束后才会打印文本）

在我输入它而不是在应用程序末尾之后如何解决这个问题以查看打印的文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T12:26:24.070

这是一个缓冲问题吗？尝试调用`fflush()`刷新输出。

```
int main()
{
    int i=0;
    int j=0;

    printf("Hello world!\n");
    fflush(stdout);
    for (j=0;j<10;j++)
    {
        scanf ("%d",&i);
        printf ("Printed :   %d\n",i);
        fflush(stdout);
    }
    return 0;
} 
```

# .net - HttpWebRequest 返回一个陈旧的资源，即使缓存控制的 max-stale 0

> ID：10644094
> 
> 赞同：3
> 
> 时间：2012-05-17T21:59:03.013
> 
> 标签：.net, httpwebrequest

给定 a`HttpWebRequest`对带有 的 URL 执行 GET`Cache-Control max-stale=0`并且服务器返回带有 的资源`max-age=900`，为什么返回的结果`HttpWebResponse`会`IsFromCache=true`带有响应已过时的警告标头？

`Temporary Internet Files`当服务器端有更新版本的可用资源时，响应流包含从客户端获取的有效负载。自填充本地缓存以来已超过 900 秒。

我也观察到这个结果是模棱两可的。执行两次相同的代码有时会返回陈旧的资源，有时会返回更新的资源。返回更新后的资源时，它似乎不会更新`Temporary Internet Files`缓存。

# selenium - 带有 selenium 测试套件的 Web 应用程序

> ID：10644096
> 
> 赞同：0
> 
> 时间：2012-05-17T21:59:25.117
> 
> 标签：selenium, testcase

我正在寻找带有 selenium 测试用例的 Web 应用程序。有人知道这些网络应用程序吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:04:35.567

我不太确定你在问什么，但 Selenium 用于为 Web 应用程序创建测试用例。它不是 Web 应用程序的功能。

如果您正在寻找一种简单的方法来测试 Web 应用程序，您可以尝试 IDE：[http ://seleniumhq.org/projects/ide/](http://seleniumhq.org/projects/ide/)

这个工具是初学者可以使用的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T22:41:03.147

如果您想要一个可以提供 Selenium 测试演示的页面，我不知道。最好的方法是尝试 Selenium IDE（正如 Blaine 建议的 +1），或者，如果您有一些编码经验，您可以尝试[Selenium WebDriver](http://seleniumhq.org/docs/03_webdriver.html)（也称为 Selenium 2），它易于编码并允许更多功能编写测试时的控制。

一个简单的搜索也将为您提供许多 Selenium 教程，因为它是一个相当流行的测试包。

# android - FileNotFoundException：仅在 Play 商店崩溃日志中的 res/drawable-xhdpi-v4/foo.png

> ID：10644100
> 
> 赞同：10
> 
> 时间：2012-05-17T21:59:43.963
> 
> 标签：android

在我们发布 4.0 的应用程序的过去两天里，我们已经看到了大约 40 次此类崩溃。在查看崩溃日志后，我们发现它自我们的应用程序的 3.3 版以来就存在。我们无法在内部复制此内容。

进一步的研究表明，此问题在其他应用程序中很普遍，但我无法找到解决方案或表明 Google 已意识到此问题。

崩溃本身发生在 onCreate() 中的 setContentView(R.layout.foo) 方法调用上

笔记：

*   我们将 API 限制在版本 4 和目标 15。
*   我们至少在 mdpi、hdpi、xhdpi 手机和平板电脑上的 2.2 - 4.0.3 上看到了这一点。
*   用户评论指出应用程序立即崩溃（预期）并且应用程序启动器中的 Evernote 图标变为默认应用程序图标（无法读取任何可绘制对象）。
*   崩溃不仅限于一个特定的drawable，我们在日志中看到了许多不同的drawable，但是它们“似乎”都是图像drawable，而不是颜色、布局、xml文件等......
*   这不仅限于 9 个补丁，它在常规 .png 和 .9.png 上都发生过

我们的可绘制文件夹看起来像所附的图片![可绘制对象](../Images/8c63350bb52392bfa44e234f3b3d204e.png)

*   我们在drawable文件夹中只存储xml

堆栈跟踪：

```
android.content.res.Resources$NotFoundException: File res/drawable/ics_tab_title_unselected.xml from drawable resource ID #0x7f02016f
at android.content.res.Resources.loadDrawable(Resources.java:1697)
at android.content.res.Resources.getDrawable(Resources.java:581)
at android.view.View.setBackgroundResource(View.java:7533)
at com.evernote.ics.ActionBarTabbedTitle.a(ActionBarTabbedTitle.java:103)
at com.evernote.ics.j.a(ActivityActionBar.java:150)
at com.evernote.ics.a.c(ActionBar.java:731)
at com.evernote.ics.a.p(ActionBar.java:440)
at com.evernote.ics.a.g(ActionBar.java:423)
at com.evernote.ics.j.m(ActivityActionBar.java:68)
at com.evernote.ics.phone.SwipeableTabbedActivityAbstract.s(SwipeableTabbedActivityAbstract.java:990)
at com.evernote.ics.phone.SwipeableTabbedActivityAbstract.a(SwipeableTabbedActivityAbstract.java:662)
at com.evernote.ics.phone.SwipeableTabbedActivityAbstract.b(SwipeableTabbedActivityAbstract.java:617)
at com.evernote.ics.phone.PhoneMainActivity.b(PhoneMainActivity.java:113)
at com.evernote.ui.EvernoteFragment.a(EvernoteFragment.java:136)
at com.evernote.ui.EvernoteFragment.a(EvernoteFragment.java:132)
at com.evernote.ui.EvernoteFragment.d(EvernoteFragment.java:128)
at com.evernote.ics.phone.b.onItemClick(HomeFragment.java:1324)
at android.widget.AdapterView.performItemClick(AdapterView.java:284)
at android.widget.ListView.performItemClick(ListView.java:3513)
at android.widget.AbsListView$PerformClick.run(AbsListView.java:1812)
at android.os.Handler.handleCallback(Handler.java:587)
at android.os.Handler.dispatchMessage(Handler.java:92)
at android.os.Looper.loop(Looper.java:123)
at android.app.ActivityThread.main(ActivityThread.java:3683)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:864)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:622)
at dalvik.system.NativeStart.main(Native Method)
Caused by: android.content.res.Resources$NotFoundException: File res/drawable-xhdpi-v4/tab_unselected_focus.9.png from drawable resource ID #0x7f0201e6
at android.content.res.Resources.loadDrawable(Resources.java:1714)
at android.content.res.Resources.getDrawable(Resources.java:581)
at android.graphics.drawable.StateListDrawable.inflate(StateListDrawable.java:162)
at android.graphics.drawable.Drawable.createFromXmlInner(Drawable.java:787)
at android.graphics.drawable.Drawable.createFromXml(Drawable.java:728)
at android.content.res.Resources.loadDrawable(Resources.java:1694)
... 28 more
Caused by: java.io.FileNotFoundException: res/drawable-xhdpi-v4/tab_unselected_focus.9.png
at android.content.res.AssetManager.openNonAssetNative(Native Method)
at android.content.res.AssetManager.openNonAsset(AssetManager.java:406)
at android.content.res.Resources.loadDrawable(Resources.java:1706)
... 33 more 
```

任何建议将不胜感激。

应用：[https ://play.google.com/store/apps/details?id=com.evernote](https://play.google.com/store/apps/details?id=com.evernote)

谢谢，

泰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-01-25T00:16:19.187

通过在“proguard”文件中添加以下内容解决了类似的错误。

```
-keepclassmembers class **.R$* {
    public static <fields>;
} 
```

# xcode - 错误：词法和预处理器问题：找不到“tidy.h”文件

> ID：10644105
> 
> 赞同：1
> 
> 时间：2012-05-17T22:00:05.550
> 
> 标签：xcode

当我尝试将项目构建到存档时遇到预处理器或词法错误。这在模拟器上的发布和调试配置设置上都没有发生。

消息是： `lexical and preprocessor issue: 'tidy.h' file not found`

'tidy.h' 包含在 CTidy.h 中，它是 TouchXML 库的一部分。

我在“iPhoneSimulator5.1.sdk”的子文件夹中找到了“tidy.h”。令我惊讶的是，“iPhoneOS5.1.sdk”中没有该文件

我可以将文件复制到 iPhoneOS5.1.sdk 吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-16T16:30:44.857

尝试注释掉：

```
 #include "tidy.h" 
```

... 在 CTidy.h 中，或者注释掉：

```
 #include "CTidy.h" 
```

也就是检查头文件是否真的需要。

如果您发现不是，请向 TouchXML 开发人员提交补丁，或向他们提交错误，或向他们发送电子邮件。

不必要地包含标题是很常见的。例如，我可以编写一些依赖于“foo.h”的代码，然后删除我的代码，或者以不再需要标头的方式对其进行重构，但同时忘记删除标头包含。

# c# - 如何检测何时使用 aspnet_compiler 编译应用程序？

> ID：10644107
> 
> 赞同：0
> 
> 时间：2012-05-17T22:00:12.213
> 
> 标签：c#, asp.net, .net

我能够测试是否正在构建应用程序的唯一方法`aspnet_compiler`是使用以下内容：

```
HttpRuntime.AppDomainAppId.EndsWith("_precompile") 
```

然而，这感觉就像一个黑客。我*可以*检查元数据库路径，但是可以通过切换到可执行文件轻松更改。是否有更强大的记录方法来确定这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:07:48.840

这是我想出的（尽管它仍然很脏）。如果提供了更好的答案，我将其更改为接受的答案。

```
public static bool IsPerformingPrecompilation()
{
    var simpleApplicationHost = Assembly.GetAssembly(typeof(HostingEnvironment))
                                    .GetType("System.Web.Hosting.SimpleApplicationHost", throwOnError: true, ignoreCase: true);

    return HostingEnvironment.InClientBuildManager && 
           HostingEnvironment.ApplicationID.EndsWith("_precompile", StringComparison.InvariantCultureIgnoreCase) && 
           HostingEnvironment.ApplicationHost.GetType() == simpleApplicationHost;
} 
```

# c# - .Net 中的非托管代码

> ID：10644109
> 
> 赞同：0
> 
> 时间：2012-05-17T22:00:15.833
> 
> 标签：c#, visual-c++, winforms-interop

[我们在 C++ 项目中有一个自定义 Listview Treegrid，该项目基于此处](http://www.codeproject.com/Articles/68/SuperGrid-Yet-Another-listview-control)的 Codeproject TreeGrid 示例。随着时间的推移，代码已经被广泛修改。

我需要将 c++ 项目移植到 C# Winforms。我正在考虑为 Listview 网格创建一个 c++ dll 并在 Winforms 中与它进行互操作。

我是否在要求在 Winforms 中使用非托管 Listview 控件时遇到麻烦？我应该只移植/重写 Winforms 中的列表视图吗？（我也不期待的任务）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:05:33.170

我认为最好用托管代码重写它。

互操作性通常有效，但首选托管代码是有原因的。运行时为您处理了很多事情，而且更容易维护。对于某些任务来说，跨越边界可能会有问题。例如，您还会失去代码访问安全性。[这里](http://msdn.microsoft.com/en-us/library/ms973872.aspx#manunman_topic6)有一些很好的信息。

如果您不这样做，那么您将始终需要一个 .NET 开发人员和一个 c++ 开发人员来维护它。

c++/native 代码本身没有什么问题，但是将两者混合在一起。我只是认为最好不要长期混合，除非你必须这样做。

也就是说，存在时间和预算限制。互操作的存在是有原因的。如果从商业角度证明绝对需要太长时间，我会撤回上述建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T22:23:02.607

如果我是你，我更愿意用 C# 重写 Listview，或者寻找一个免费或付费的用 C# 编写并打算在 Winforms 中使用的 Grid。

不要忘记在完成这项工作后您必须支持代码，这可能包括修复错误和添加功能。最好确切地知道你的代码是如何工作的以及如何调试它。您还可以编写更适合您需求的 Listview。

如果您将使用此 C++ Listview 并在 Winforms 中使用它，这将非常困难。但是，如果您决定使用它，我可以想到两种选择：

1.  在 C++/CLI 中为 Listview 创建一个包装器，它将保存对象并在 C# 中显示数据，这意味着您必须编写大量转换代码才能将数据从 Listview 移动到 C# 对象，但它应该工作。

2.  使用 DllImport 并使用 ListView 作为数据源，我不确定您将如何准确地从中获取所有数据，但它可以防止您编写丑陋的 CLI 代码......

所以总结一下，我建议对 UI 代码使用单一语言，我选择的 UI 语言是 C#，而不是 C++。

祝你好运...

# haskell - Haskell中的二叉搜索树，比较

> ID：10644110
> 
> 赞同：0
> 
> 时间：2012-05-17T22:00:28.753
> 
> 标签：haskell, binary-search-tree

我对 Haskell 中的 BST 有疑问。我想我在将 Node(Uzel) 中的“关键”变量定义为 Ord 时遇到了问题。但我绝对没有更多的想法。

不过，如果我曾经将 Tree 类型的“key”参数定义为 Ord，那么它是有效的，并且代码中的每次使用也会获得此信息。

以下代码不完整，但我正在谈论的事情是：

```
data (Ord key) => Tree key value = List key value |Uzel (Tree key value) key value (Tree key value) | Null deriving (Show)

prazdny :: Ord key => Tree key value
prazdny = Null

najdi :: (Ord key,Ord k) => k -> Tree key value -> Maybe a
najdi k Null = Nothing
najdi k (Uzel levy klic hodnota pravy) = if k < klic
                then najdi k levy
                else najdi k pravy 
```

当试图编译我得到这个：

```
bvs.hs:9:49:
Could not deduce (key ~ k)
from the context (Ord key, Ord k)
  bound by the type signature for
             najdi :: (Ord key, Ord k) => k -> Tree key value -> Maybe a
  at bvs.hs:(8,1)-(11,58)
  `key' is a rigid type variable bound by
        the type signature for
          najdi :: (Ord key, Ord k) => k -> Tree key value -> Maybe a
        at bvs.hs:8:1
  `k' is a rigid type variable bound by
      the type signature for
        najdi :: (Ord key, Ord k) => k -> Tree key value -> Maybe a
      at bvs.hs:8:1
In the second argument of `(<)', namely `klic'
In the expression: k < klic
In the expression: if k < klic then najdi k levy else najdi k pravy 
```

非常感谢您的任何想法！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T02:01:46.777

问题是 k 和 key 必须是相同类型才能比较它们，但是您声明它们可能不同，因此编译器会抱怨。如果您使它们具有相同的类型，它将进行类型检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T23:48:53.053

注释掉这一行，它会编译：

```
--najdi :: (Ord key,Ord k) => k -> Tree key value -> Maybe a 
```

# random - 生成随机长无符号 C

> ID：10644112
> 
> 赞同：0
> 
> 时间：2012-05-17T22:00:35.803
> 
> 标签：random

这是我的代码：

```
#include <stdio.h>
#include <time.h>
#include <unistd.h>
#include <crypt.h>
#include <string.h>
#include <stdlib.h>

int main(void){

int i;
unsigned long seed[2];

/* Generate a (not very) random seed */
seed[0] = time(NULL);
seed[1] = getpid() ^ (seed[0] >> 14 & 0x30000);

printf("Seed 0: %lu ; Seed 1: %lu", seed[0], seed[1]);
return 0;
} 
```

我想生成一些**非常**随机的种子，这些种子将用于哈希函数，但我不知道该怎么做！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T22:07:03.487

选择[Mersenne Twister](http://en.wikipedia.org/wiki/Mersenne_Twister)，它是一种广泛使用的伪随机数生成器，因为它非常快，周期很长，分布非常好。不要尝试编写自己的实现，使用任何[可用的](http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/VERSIONS/eversions.html)实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-17T22:07:41.413

您可以从 /dev/random 读取所需的随机位。

读取时，/dev/random 设备将仅返回熵池中估计的噪声位数内的随机字节。/dev/random 应该适合需要非常高质量随机性的用途，例如一次性填充或密钥生成。当熵池为空时，来自 /dev/random 的读取将被阻塞，直到收集到额外的环境噪声。（http://www.kernel.org/doc/man-pages/online/pages/man4/random.4.html )

```
int randomSrc = open("/dev/random", O_RDONLY);
unsigned long seed[2];
read(randomSrc , seed, 2 * sizeof(long) );
close(randomSrc); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-17T22:07:41.570

因为算法是确定性的，所以你不能得到**非常**随机的，只能是伪随机的——在大多数情况下，如果你太过分了，你所拥有的就足够了，例如

```
Mac address + IP address + free space on HD + current free memory + epoch time in ms... 
```

那么你就有可能削弱算法的性能。

如果您的解决方案是交互式的，那么您可以为用户设置一个简短的键入任务并让他们为您生成随机数据 - 测量击键之间的时间并将其乘以他们按下的键的代码 - 即使他们重新键入相同的字符串，时间会稍微偏离——你可以把它混在一起，在它们开始时取模 10 秒，只计算那些击键。

但如果你真的想要 100% 随机数 - 那么你可以使用[ANU Quantum Vacuum Random number generator](http://qrng.anu.edu.au/) -[文章](http://www.montrealgazette.com/technology/GENERATING+RANDOM+NUMBERS/5779618/story.html)

GitHub 上有[一个项目，](https://github.com/lmacken/quantumrandom)它是打败坏人的非常棒的方法。

# networking - 连接“少连接” boost::asio::ip::udp::socket

> ID：10644115
> 
> 赞同：8
> 
> 时间：2012-05-17T22:01:02.263
> 
> 标签：networking, udp, boost-asio

我最近通过浏览网络来了解 UDP 套接字，所有解释它的页面都提到 UDP 套接字是“少连接”。如果我理解正确，这意味着一个在两个套接字之间没有“连接”，而是在不知道另一端是否正在侦听的情况下将数据报包发送到指定的端点。

然后我开始阅读 boost::asio::ip::udp::socket[文档](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_asio/reference/ip__udp/socket.html)，发现它提到的 API 如下：

*   async_connect：启动异步**连接**。
*   **async_receive：在连接的套接字**上启动异步接收。
*   **async_send：在已连接的套接字**上启动异步发送。

现在这对新手来说有点混乱。我可以找到 3 个可能导致我困惑的原因（按相似度排序:)）

1.  我错过了一些东西
2.  asio 实现在幕后做一些事情来虚拟化连接。
3.  文档有误

文档中还有一个小故障，当您打开[basic_datagram_socket::async_connect](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_asio/reference/basic_datagram_socket/async_connect.html)的页面时，其中的示例正在实例化**TCP**套接字（而不是**UDP**套接字）。

有人请赐教吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-19T22:41:39.480

[Single UNIX 规范对 c​​onnect 对无连接](http://pubs.opengroup.org/onlinepubs/007908799/xns/connect.html)套接字的作用有更好的解释：

> 如果启动套接字不是连接模式，则 connect() 设置套接字的对等地址，但不建立连接。对于 SOCK_DGRAM 套接字，对等地址识别所有数据报在后续 send() 调用中的发送位置，并限制远程发送方以进行后续 recv() 调用。

# facebook - 在 Facebook 上拥有活动的操作类型后，如果您添加对象类型，是否需要重新批准？

> ID：10644123
> 
> 赞同：0
> 
> 时间：2012-05-17T22:01:52.863
> 
> 标签：facebook, facebook-graph-api

我已经批准了“查看”操作。我想向其中添加另一个对象（视频、图片）

Facebook 会再次对此进行重新批准吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T22:10:49.347

它不需要重新批准。

# facebook - 有什么方法可以阻止评论对话框在使用 Facebook 之类的社交插件点赞页面后显示？

> ID：10644128
> 
> 赞同：0
> 
> 时间：2012-05-17T22:02:48.150
> 
> 标签：facebook, facebook-like, facebook-javascript-sdk

我有一个使用 facebook like button 社交插件的网站。它是一个小工具栏的一部分，还有一个推文按钮和其他类似的东西。然而，点击按钮后，Facebook 会自动显示一个菜单，让您可以在帖子中添加评论。这真的让我网站中的 css 无法正常工作，让事情看起来非常糟糕。我真的只是希望人们能够点击推荐按钮，并让它在那里结束。我不希望在采取行动后将任何额外的元素带入 HTML 代码。

有人知道有什么方法可以阻止显示所有额外的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:05:08.863

[从点赞按钮社交插件参考](http://developers.facebook.com/docs/reference/plugins/like/)底部的常见问题解答中：

> **用户何时可以选择添加评论？**
> 
> 如果您使用 XFBML 版本的 Like 按钮，用户将始终可以选择添加评论。如果您使用的是 Iframe 版本的按钮，如果您使用的是宽度至少为 400 像素的“标准”布局，用户将可以选择评论。如果用户确实添加了评论，则发布回 Facebook 的故事会更加突出。

因此，一种选择是使用 iframe 而不是 XFBML 版本，并确保宽度小于 400 像素。

# emacs - Paredit forward slurp "C-)" 不适用于 Windows 7 上的 emacs

> ID：10644131
> 
> 赞同：12
> 
> 时间：2012-05-17T22:03:12.363
> 
> 标签：emacs, paredit

在迁移到`win7` `paredit`'s forward slurp "C-)" 不再有效并且 "C-right arrow" 仍然有效后，将 重新绑定`sexp`到不同的组合（例如 C-0）也有效。
有没有人有同样的问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-03-14T16:24:48.487

Windows 7 使用 Ctrl + Shift 来切换语言，因此 Emacs 永远不会得到击键。您可以使用以下内容更改绑定：

*   控制面板
*   地区和语言
*   键盘和语言
*   更换键盘
*   高级按键设置
*   输入语言之间
*   更改键序列
*   切换键盘布局
*   未分配。

[http://www.eightforums.com/general-support/22552-cant-use-ctrl-shift-0-windows-has.html](http://www.eightforums.com/general-support/22552-cant-use-ctrl-shift-0-windows-has.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T18:43:01.183

如果您有不止一种输入语言，它会在 Windows 7 上发生。Ctrl-Shift-0, Ctrl-Shift-1, ... 用于快速切换输入语言。似乎无法修复，因为 Windows 会拦截某些组合键（例如 Win-E、Win-D 等）并且不会将其传递给应用程序。可能更糟的是，英特尔 GMA 驱动程序不允许您在 Win XP 上使用 Ctrl-Alt-Up/Down。

只需在 Emacs 中使用另一个快捷方式（或者您可以尝试使用 Sharpkeys 等工具重新映射键）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-16T14:15:43.447

Paredit 版本我已将 forward slurp 命令绑定到`<C-right>`和`C-)`. 我可以验证后一个密钥是否被操作系统使用，在我的情况下是 MS Windows 8，因此 Emacs 无法接收该密钥。因此，您可能希望改用`<C-right>`该键，但是由于该键（以及`<C-left>`绑定到另一个 paredit 命令的键）通常用于移动（在 paredit 之外），因此您可能希望使用自己的自定义不同键。我用`C-*`. 以下是我使用的配置，你可以拿你想要的部分。

```
(require 'paredit)

(define-key paredit-mode-map (kbd "C-*") 'paredit-forward-slurp-sexp)

;; Make the key no longer bound to paredit-forward-barf-sexp
(define-key paredit-mode-map (kbd "<C-left>") nil)

;; Make the key no longer bound to paredit-forward-slurp-sexp
(define-key paredit-mode-map (kbd "<C-right>") nil)

(define-key paredit-mode-map (kbd "<C-backspace>") 'paredit-backward-kill-word) 
```

# spring - Spring-Hibernate 事务

> ID：10644133
> 
> 赞同：1
> 
> 时间：2012-05-17T22:03:15.800
> 
> 标签：spring, hibernate, transactions

我正在使用 Spring 1.2.9 和 Hibernate 3.3.1。我遇到了一个奇怪的交易问题。我春天的交易设置是这样的

```
<property name="writeInfo*">PROPAGATION_REQUIRED,readOnly</property>
<property name="getFacilities*">PROPAGATION_REQUIRED,readOnly</property> 
```

writeInfo 方法更像是一个服务层，它可以使用其他 DAO 来查询对象、遍历它们、调用其他非数据辅助方法（但可以传递数据对象）。getFacilities 是一种 DAO 方法，可以由任何需要访问数据库对象的方法调用。

我的代码流程是，使用一堆对象 ID 调用 writeInfo，必须将其数据导出到文本文件。writeInfo 方法通过将这些对象传递给 getFacilities DAO 方法来查询这些对象（将 DAO 代理注入到包含 writeInfo 方法的代理中）。一旦 getFacilities 返回对象集合，writeInfo 方法就会调用同一类中的其他辅助方法，这些辅助方法遍历这些对象及其子对象并写入字符串缓冲区。

问题是，当我在 spring-hibernate 事务管理器上调试事务语句时，我看到正在为 writeInfo 方法创建一个事务，并且再次为 getFacilities 方法创建了一个新事务，即使从 writeInfo 中调用了 getFacilities 方法方法。更大的问题是，当对象从 getFacilities 方法返回并从 writeInfo 传递给其他辅助方法时，对子对象（主对象中的集合）的任何访问都会由于会话关闭而导致 LazyIntialization 异常。

writeInfo 方法启动的事务不应该一直可用到方法结束吗？为什么 getFacilities 方法在返回对象时创建新事务并在事务后关闭会话？这是这个特定版本的 Spring 中的错误还是我做错了什么。

任何帮助是极大的赞赏。

# android - Android上的搜索算法：堆栈还是预分配缓冲区？

> ID：10644134
> 
> 赞同：0
> 
> 时间：2012-05-17T22:03:16.143
> 
> 标签：android, algorithm, recursion, stack

我正在为 Android 游戏开发寻路算法，我可以编写一个递归版本（这很好，但需要一个大堆栈，所以我可能需要为此创建一个具有更大堆栈大小的专用线程）和一个“循环”使用缓冲区（而不是递归）的版本。事先不知道缓冲区的大小也是个大问题，所以目前看来只有基于栈的方案可行。

我知道这可能是一个算法理论或一般计算机科学问题，但也许它是特定于 Android 的，因为堆栈大小毕竟是系统特定的特性。

一般来说，哪个在 Android 上应该更高效（速度）？堆栈一个，还是依赖缓冲区（堆）的那个？请注意，该问题在架构方面接近问题（假设算法复杂性不取决于算法是递归的还是基于循环的）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:05:33.377

我知道您要求提供特定于 Android 的答案，但我认为这与您的问题无关。两个备注

1.  您不一定需要基于堆栈的解决方案来实现递归算法，您可以使用基于堆栈的数据结构来模拟堆上的堆栈。不过，有时你甚至不需要这个。这需要更多的工作，但不要将您的算法建立在人为的架构约束上。
2.  有很多非递归寻路，最短路径算法，即[Bellman-Ford](https://en.wikipedia.org/wiki/Bellman%E2%80%93Ford_algorithm)

我无法评论问题的最佳递归解决方案是否会比 Android 上的最佳迭代解决方案更好。通常，在所有其他条件相同的情况下，迭代解决方案会更快，但是当您使用比斐波那契数更复杂的算法时，递归地实现迭代算法或反之亦然可能会有所作为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T23:15:47.367

我的直觉是你即将犯下早期优化的罪过。您是否有任何计算或测量表明您将用完 RAM？

我建议您使用最简单的算法。但是，您可能希望使用 AsyncTask 以免冻结 UI，即使是一秒钟。

# php - 如何在不同计算机上的用户之间共享网站上的实时更新？

> ID：10644136
> 
> 赞同：5
> 
> 时间：2012-05-17T22:03:28.587
> 
> 标签：php, javascript, ajax, session, ssh

我正在尝试为网站用户（比如学生和老师）找到一种共享安全连接的方法，在该连接中，他们俩都可以查看一个页面上的实时更新。通过研究，我得出结论，可以使用 ajax 和 javascript 执行一些实时更新。

但是我很难理解用户如何共享一个只有两个用户才能查看网站上发生的更新的连接（例如绘图板的 Flash 动画。）我也很困惑你甚至会如何开始建立这样的连接。

我查看了 intp php 会话和 cookie，但我不确定我是否在做正确的研究。关于两个特定用户如何共享安全连接的任何指针，其中实时更新仅由他们两个人查看。我不想要一个简洁的回应。我正在寻找特定的细节，例如特定于 php 的函数和语法。感谢您的帮助，如果您给我好的答案，我会给您打分！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:12:27.850

您不能将一个客户端的安全连接（例如 HTTPS）共享到一个服务器。

如果两个客户端都登录并在浏览器中运行后台 AJAX 任务，是否可以让每个客户端每隔几秒“拉”一次相同的数据以显示给两个用户？

这将需要“绘图板”更新也不断地发送回服务器，以与其他客户端共享更新的数据。我敢肯定会有一个事件可以用来触发数据的发布（例如鼠标向上）。

如果性能是一个问题，您会希望使用更好的服务器技术，例如 Java，它能够在请求之间保持会话状态，而无需持久化到数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T22:15:36.387

Flash 允许用户之间的连接，我认为他们将它们称为套接字。
如果要使用 Ajax 等，则需要支持推送的服务器端技术。
Node 是这方面的标准，您可以免费设置 Heroku 实例。

还有其他的，你需要在开始学习应用程序之前学习工具。

在众多概述中，您可能会感兴趣：
[http ://arstechnica.com/business/2012/05/say-hello-to-the-real-real-time-web/?1](http://arstechnica.com/business/2012/05/say-hello-to-the-real-real-time-web/?1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T22:18:37.493

发生这种情况的几个很好的例子：

*   [谷歌文档](https://docs.google.com/)
*   [以太垫](http://etherpad.org/)
*   [HTML5 游戏：多人游戏](http://html5games.com/category/multiplayer/)

您可以使用的技术（具有不同的浏览器支持）

*   HTML5 WebSockets（[维基百科](https://en.wikipedia.org/wiki/WebSocket)；[MDN](https://developer.mozilla.org/en/WebSockets)；[HTML5 演示](http://html5demos.com/web-socket)）
*   彗星（[维基百科](https://en.wikipedia.org/wiki/Comet_%28programming%29)）

据我所知，只有使用 WebSockets 才能真正将数据从服务器推送到 Web 浏览器客户端（当它从另一个客户端接收到内容时会这样做）。其他机制需要浏览器插件或独立应用程序。

但是，使用 Comet（通过 AJAX），您可以通过定期轮询服务器获取数据来真正接近推送数据。然而，与传统的轮询（例如，客户端每 5 秒请求一次数据）相反，根据 Comet 原则，服务器将持有该周期性请求的人质长达 30 秒。服务器将不会发回数据，直到它有数据或达到超时。这样，在这 30 秒内，服务器接收到的任何数据都可以立即推送回其他客户端。之后，客户端开始一个新的 30 秒会话，依此类推。

尽管 Comet 和 WebSockets 都应该与 Apache 提供的 PHP 后端一起工作。我建议为此研究 NodeJS（作为服务器技术）。

互联网上有很多关于彗星的信息，我建议你google一下，也许从维基百科开始。

Comet 的伟大之处在于它更像是一种原理，而不是一种技术。它使用我们已经拥有的（使用 AJAX 的简单 HTTP 请求），因此浏览器支持非常广泛。

您也可以进行组合，如果支持，您可以使用套接字并回退到 Comet。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T22:09:37.293

您可以查看 ajax 推送技术。我曾经使用过彗星，管理员发布消息，每个登录的人都看到该消息出现在他们的屏幕上。我不知道彗星是否支持PHP。我只将它与 JSP 一起使用。只需在 Google 中搜索“ajax push”即可。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-17T22:13:11.610

我相信你已经调查过了。认为这可以通过 ajax 完成的观点是误导性的，认为网站的两个用户可以通过 javascript 进行通信。

如您所知，javascript 发生在客户端上，而 ajax 本质上是“在不更改或刷新页面的情况下与服务器对话”。

网站的两个用户之间的通信必须通过服务器 - php 和一些选定的数据存储进行。

希望那不是简洁。干杯，罗伯

# sql - 如何并行运行未知数量的存储过程

> ID：10644138
> 
> 赞同：2
> 
> 时间：2012-05-17T22:03:50.840
> 
> 标签：sql, sql-server, stored-procedures, asynchronous

我正在寻找这样的东西。虽然语法错了，但说明了原理

```
foreach(int i in myIntArray)
{

execute mystoredProc i;//this should kick off the proc and go onto next one without waiting for a return value

} 
```

这些存储过程是从 Windows 应用程序调用的。我对在应用程序端创建大量线程持怀疑态度。我宁愿在 SQL 服务器端进行线程处理。我愿意使用 SSIS。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:10:55.093

你不能直接做你要求的事情。

你*可以*做的是启动`n`线程，然后每个线程打开它自己的连接，每个连接运行它自己的 SQL 查询。然后每个线程将等待它的查询返回。您不能只在一个线程中执行此操作。

这也意味着您不能在 T-SQL 中本地执行此操作。

您可以编写一个启动多个线程的 CLR 例程，然后重复上述过程。因此，让您的 T-SQL 调用您的 CLR 代码和 CLR 处理并发问题。

但是这方面的标准做法确实是拥有多个客户端线程。

# ruby-on-rails - 在 authlogic 中创建没有密码的新用户会话

> ID：10644141
> 
> 赞同：1
> 
> 时间：2012-05-17T22:04:03.740
> 
> 标签：ruby-on-rails, ruby-on-rails-3, authlogic, omniauth

我在我的 Rails 3.0.10 应用程序中使用 authlogic 和 omniauth 进行身份验证。但是，当我从omniauth 提供程序收到回调时，我无法创建新的用户会话来登录用户。

在[其他响应](https://stackoverflow.com/questions/6730143/authlogic-create-new-session-without-password)中（甚至在[authlogic docs](https://github.com/binarylogic/authlogic)中），它说 using`UserSession.create(@user, true)`应该能够创建和持久化一个新会话。

但是，这对我不起作用。它仅`@user`在数据库中有密码时才有效（通过直接在数据库中插入密码）。

但是使用第三方身份验证提供程序时没有密码，因此我无法登录用户。

任何想法如何在 authlogic 中登录没有密码的用户？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:29:47.223

`User`你可以在你的模型中做这样的事情：

```
acts_as_authentic do |config|
  external = Proc.new { |r| r.externally_authenticated? }

  config.merge_validates_confirmation_of_password_field_options(:unless => external)
  config.merge_validates_length_of_password_confirmation_field_options(:unless => external)
  config.merge_validates_length_of_password_field_options(:unless => external)
end 
```

`externally_authenticated?`只是用户的一种方法，用于检查提供用户信息的内容，如果它是omniauth 提供者之一，则返回true。

# android - 为Android中ListView中的每个项目设置标签？

> ID：10644142
> 
> 赞同：5
> 
> 时间：2012-05-17T22:04:29.070
> 
> 标签：android, android-listview, textview

我有一个 ListView，我希望每个项目都附有一个 ID 号（与位置号不同）。我希望这可以通过在`setTag()`创建这些视图时为 ListView 中的每个视图项设置一个标签来完成。

现在我正在创建这样的 ListView：

```
 final ListView listview = (ListView) findViewById(R.id.listView1);
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, android.R.id.text1, names);
    listview.setAdapter(adapter); 
```

上面 ArrayAdapter 参数中的`names`变量是一个 ArrayList，这个列表中的每个字符串值也有一个唯一的 ID，我想以某种方式链接到这个字符串。

有什么方法可以访问和修改带有标签的每个视图？一个想法是创建我自己的 ArrayAdapter 扩展类并覆盖 getView() 方法，但我并不真正了解它是如何工作的以及我将如何去做。

或者有没有更好的方法将 ID 与每个字符串链接起来，而不是像我想要做的那样添加标签？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-17T22:08:28.773

创建一个`ViewBinder`并设置标签，因为`ListView`它正在填充您需要的任何内容。您可以检查视图的所有属性以确定哪些标签在哪里，所以这应该是您正在寻找的。

```
myAdapter.setViewBinder(new MyViewBinder());

public class MyViewBinder implements ViewBinder {
    @Override
    public boolean setViewValue(View view, Object data, String text){
        //Since it iterates through all the views of the item, change accordingly 
        if(view instanceof TextView){ 
            ((TextView)view).setTag("whatever you want");
        }
    }
} 
```

昨天我刚刚在另一个问题上使用了完全相同的答案（尽管略有不同）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T22:50:40.513

关于 getView ，它通过使用回收视图的方法来工作。我将尝试以简单的方式解释它。

假设您有大量可以查看的项目。您也不想真正创建大量视图，因为这会占用大量内存。谷歌想到了这一点，并为您提供了仅更新需要在任何特定时间显示的视图的方法。

所以，如果列表视图上有一个空白空间，它将被一个新视图填充。如果用户滚动，隐藏的视图将被回收并在 getView 上返回给您，以使用显示的数据进行更新。

例如，如果您向下滚动，对于最终用户来说，上面的视图会隐藏起来，但实际上它会变成与底部完全相同的视图。

为了了解如何使列表视图具有最佳性能并在实践中了解它如何以及为什么像我所说的那样工作，请观看此视频： [http ://www.youtube.com/watch?v=wDBM6wVEO70](http://www.youtube.com/watch?v=wDBM6wVEO70)

至于标签，我认为您想做其他事情，因为数据本身（通常是某种集合，如 arrayList）已经知道在哪里更新，因为您通过 getView 获得位置。如果您想要更新特定视图，您可以通过使用不断更新的 hashmap 来做到这一点，它的键是集合中的位置，值是关联的视图。每次去 getView 时，您都需要删除属于该视图的条目（如果存在），并将新位置分配给您得到/创建的视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T15:53:44.440

我宁愿选择[这个线程](https://stackoverflow.com/a/7668591/1108032)中讨论的解决方案。将所有相关数据放在同一个位置总是最容易的，在这种情况下，您只需创建一个类来保存每个项目所需的所有信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T19:02:53.053

感谢您的回答。thisMayhem 的答案最终可能会更容易，但为了了解更多信息，我最终根据[本教程](http://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/)制作了自己的适配器。我将名称和 ID 传递给适配器，并将名称设置为 TextView 的文本，将 ID 设置为标签。

# maven - Maven Cobertura + Maven War 插件

> ID：10644145
> 
> 赞同：3
> 
> 时间：2012-05-17T22:04:40.637
> 
> 标签：maven, cobertura, maven-war-plugin

我在使用这些插件时遇到了问题，出现以下异常：

```
[INFO] Error configuring: org.apache.maven.plugins:maven-war-plugin. Reason: ERROR: Cannot override read-only parameter: classesDirectory in goal: war:exploded 
```

我也在[JIRA 上发现了这个问题](http://jira.codehaus.org/browse/MCOBERTURA-86)，没有解决。

无论如何，我很想看到它工作。任何人都知道另一个插件可以做到这一点，或者让它工作的解决方法？

预先感谢。

[编辑]

我在我的父 pom 项目中添加了 Cobertura 插件，如下所示：

```
<reporting>
    <plugins>
        [...]
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>cobertura-maven-plugin</artifactId>
            <version>2.5.1</version>
        </plugin>
    </plugins>
</reporting> 
```

当我运行“mvn site”时，他们遇到了我之前所说的异常。

关于JIRA问题，我不小心贴错了链接，抱歉。它现在更新了。

顺便说一句：我已经尝试了这个问题中描述的解决方法，但没有成功。

# mysql - 使用子查询 MySQL 插入 INTO

> ID：10644149
> 
> 赞同：58
> 
> 时间：2012-05-17T22:04:55.140
> 
> 标签：mysql, insert, subquery

我有这个声明：

```
INSERT INTO qa_costpriceslog (item_code, invoice_code, item_costprice)
    VALUES (1, 2, (SELECT item_costprice FROM qa_items WHERE item_code = 1)); 
```

我正在尝试插入与 item_costprice 相同数据的值副本，但显示错误：

```
Error Code: 1136\. Column count doesn't match value count at row 1 
```

我怎么能解决这个问题？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2012-05-17T22:09:25.093

`SELECT`在语句中使用带有别名的数字文字。`()`组件周围不需要`SELECT`。

```
INSERT INTO qa_costpriceslog (item_code, invoice_code, item_costprice)
  SELECT
    /* Literal number values with column aliases */
    1 AS item_code,
    2 AS invoice_code,
    item_costprice
  FROM qa_items 
  WHERE item_code = 1; 
```

请注意，在 a 的上下文中`INSERT INTO...SELECT`，别名实际上不是必需的，您可以只`SELECT 1, 2, item_costprice`使用 ，但在正常情况下`SELECT`，您需要别名来访问返回的列。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-09-17T16:03:15.930

你可以简单地例如

```
INSERT INTO modulesToSections (fk_moduleId, fk_sectionId, `order`) VALUES
    ((SELECT id FROM modules WHERE title="Top bar"),0,-100); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-11-12T00:31:10.467

我对“全有或全无”的答案感到失望。我需要（再次）`INSERT`一些数据和来自`SELECT`现有`id`表的数据。

```
INSERT INTO table1 (id_table2, name) VALUES ((SELECT id FROM table2 LIMIT 1), 'Example'); 
```

除了逗号作为分隔符之外，查询上的子选择`INSERT`还应使用括号。

对于那些在使用 a 时遇到问题的人，`SELECT`我`INSERT`建议您`SELECT`先独立测试并确保两个查询的正确列数匹配。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-17T22:13:04.750

您的插入语句在左侧包含太多列或在右侧没有足够的列。VALUES 之前的部分列出了 7 列，但 VALUES 之后的第二部分仅返回 3 列：1、2，则子查询仅返回 1 列。

**编辑：**嗯，它在有人修改查询之前就完成了......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-28T13:09:06.587

作为 Michael Berkowski 的好答案的旁注：您还可以像这样动态添加字段（或者如果您正在使用 php 脚本，请准备好它们）：

```
 INSERT INTO table_a(col1, col2, col3)
     SELECT
       col1,
       col2,
       CURRENT_TIMESTAMP()
     FROM table_B 
     WHERE b.col1 = a.col1; 
```

如果需要在*不添加新数据*的情况下进行传输，可以使用 NULL 作为占位符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-13T01:41:14.653

如果要添加多个字符串值，可以将它们放入临时表中，然后将其与所需值交叉连接。

```
-- Create temp table    
CREATE TEMPORARY TABLE NewStrings (
        NewString VARCHAR(50)
    );
-- Populate temp table
INSERT INTO NewStrings (NewString) VALUES ('Hello'), ('World'), ('Hi');

-- Insert desired rows into permanent table
INSERT INTO PermanentTable (OtherID, NewString)
    WITH OtherSelect AS (
        SELECT OtherID AS OtherID FROM OtherTable WHERE OtherName = 'Other Name'
    )
    SELECT os.OtherID, ns.NewString
    FROM OtherSelect os, NewStrings ns; 
```

这样，您只需在一处定义字符串，并且只需在一处进行查询。如果您像我最初那样使用子查询并且像 Elendurwen 和 John 建议的那样，您必须在每一行中键入子查询。但是以这种方式使用临时表和 CTE，您只能编写一次查询。

# java - 最大化时JDialog不进行重新布局

> ID：10644151
> 
> 赞同：0
> 
> 时间：2012-05-17T22:05:15.190
> 
> 标签：java, swing, layout-manager, jdialog, maximize

我似乎有其他人相反的问题。默认情况下，我的 JDialog 同时具有最小化和最大化按钮。当按下最大化按钮时，对话框会最大化——但内容不会。它只是保持相同的大小，以一个巨大的对话框为中心。当您抓住边缘并重新调整对话框大小时，也会发生同样的情况。

我试过添加一个 WindowStateListener - 但它永远不会被调用。我添加了一个 WindowListener - 它只在打开/关闭/激活/停用时调用。

所以，我要么需要能够让对话框内容随对话框重新调整大小，要么删除最大化按钮。（我想摆脱最小化按钮。）

在创建对话框后我确实做了一个 pack()，因为对话框中的控件是从一个数据块动态创建的，所以我没有一个初始大小可以使用。

好的，这里是代码。所有生成的 UI 面板也在 GridBagLayouts 中。

```
public class FastAccessDialog extends JDialog implements BeanActionListener {

private static final long   serialVersionUID = 1L;
private static final Cursor waitCursor       = new Cursor(Cursor.WAIT_CURSOR);

private Cursor              oldCursor;
private JPanel              cmdOutput;
private JScrollPane         cmdOutputScroll;

public FastAccessDialog(Frame owner, ObjectName bean, String methodName) throws InstanceNotFoundException, IntrospectionException,
        ReflectionException, IOException {
    super(owner);
    setResizable(true);
    setModal(false);
    setTitle(BeanUtil.cleanUpCamelCase(methodName));

    boolean enabled = (UIHintUtil.isEnabled(bean) == EnableState.ENABLED);

    // Find the BeanOperationInfo for that method.
    MBeanInfo info = JMXConnectionSingleton.getInstance().getMBeanInfo(bean);
    MBeanOperationInfo[] operations = info.getOperations();
    JComponent comp = null;

    for (MBeanOperationInfo opInfo : operations) {
        if (opInfo.getName().equals(methodName)) {
            comp = OperationsManager.getInstance().createControls(bean, opInfo, this, true, enabled);
            break;
        }
    }

    if (comp == null) {
        throw new IllegalArgumentException("Unknown method name: " + methodName);
    }

    Container cont = getContentPane();
    cont.setLayout(new GridBagLayout());
    GridBagConstraints gbc = new GridBagConstraints();
    gbc.anchor = GridBagConstraints.WEST;
    gbc.gridx = 0;
    gbc.gridy = 0;
    gbc.fill = GridBagConstraints.HORIZONTAL;
    gbc.insets = new Insets(4, 4, 4, 4);
    cont.add(comp, gbc);
    cont.validate();

    SwingUtilities.invokeLater(new Runnable() {
        @Override
        public void run() {
            pack();
        }
    });
    return;
}

... other methods invoked when an operation is performed ...
... none of which are invoked before having the re-size problem ...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T06:45:26.547

1.  `JPanel.(re)validate();`

2.  `JPanel.repaint();`

3.  `JDialog.pack();`

4.  ```
    SwingUtilities.invokeLater(new Runnable() {
        @Override
        public void run() {
            JDialog.setVisible(true);
        }
    }); 
    ```

5.  不要扩展`Top-Level Containers`

6.  不要使用`ContentPane`，没有理由......从`Java5`

7.  在这种情况下没有别的，`JDialog.pack();`并且`JDialog.setVisible(true)`; 是返回 JDialog 实例的 void、方法或构造函数中的最后一行代码

# javascript - Facebook 整合到网页中

> ID：10644153
> 
> 赞同：0
> 
> 时间：2012-05-17T22:05:18.513
> 
> 标签：javascript, facebook, facebook-javascript-sdk

我正在尝试将 Facebook 集成到我的网页中，以便用户可以从我的网站更新他们的状态。现在我有一个用户单击以更新其状态的按钮，该按钮调用 updateFacebookStatus() 函数。当现在单击此按钮时，会弹出一个空白的白色窗口，上面写着“等待 www.facebook.com”。这个窗口是它应该请求许可的地方，但窗口只是超时。任何想法：这是我的函数 updateFacebookStatus() 的代码。

```
 function updateFacebookStatus()
    {

//Ask for permissions
    FB.login(function(response) 
    {

    }, {scope:'publish_stream, offline_access,manage_pages'});

     FB.getLoginStatus(function(response) 
     {

//If user is logged it and given permissions update status
      if (response.status === 'connected') 
      {

        new_status = document.getElementById('FacebookBody').value;

        //update status
        FB.api(
        {
            method: 'status.set',
            status: new_status
        },
        function(response)
        {
            if(response == 0)
            {
                alert("Your Facebook Status Was Not Updated.");
            }
            else
            {
                alert("Your Facebook Status Was Updated");
            }
        }

      );} 
      else 
      {
        window.location.href = "#home";
      }
     });
    } 
```

在我的 html 文件中，我使用以下代码获取 Facebook javascript sdk：

```
 <script src="http://connect.facebook.net/en_US/all.js"></script>
        <script>
              FB.init({
                appId  : 'XXXXXXXXXXXXX',
                status : true, // check login status
                cookie : true, // enable cookies to allow the server to access the session
                xfbml  : true, // parse XFBML
                channelUrl : 'http://www.XXXXX.com/channel.html', // channel.html file
                oauth  : true // enable OAuth 2.0
              });

              // Load the SDK Asynchronously
              (function(d){
                 var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
                 if (d.getElementById(id)) {return;}
                 js = d.createElement('script'); js.id = id; js.async = true;
                 js.src = "//connect.facebook.net/en_US/all.js";
                 ref.parentNode.insertBefore(js, ref);
               }(document));
        </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T22:40:28.843

不确定它是否与您的问题有关，但请注意您两次调用同一个脚本 - 一次通过`<script src="http://connect.facebook.net/en_US/all.js"></script>`标签，另一次通过异步函数调用`// Load the SDK Asynchronously`

# algorithm - 点的均匀分布

> ID：10644154
> 
> 赞同：0
> 
> 时间：2012-05-17T22:05:19.647
> 
> 标签：algorithm, space

我有`m`一些我希望在`n`维空间中均匀分布的点。“一致”是指所有最短距离对具有相似的值。

换句话说，我希望这些点尽可能均匀地填充空间。

请问，有谁知道如何做到这一点？这个问题有名字吗？

编辑：

例如，当我有 4 个点和 2D 平面时，坐标应该是 [0, 1], [1, 0], [0, -1], [-1, 0]。只是一个正方形。对于 3D，它是一个立方体。但是如果点数与 2^n 不同，我不确定该怎么办。

另一种思考方式是将点视为相互排斥的带电粒子。但是运行这样的模拟非常慢......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T22:43:42.773

我相信您可能对[低差异序列](http://en.wikipedia.org/wiki/Low-discrepancy_sequence)感兴趣。这些被用作 nm 评论中描述的均匀分布的确定性模拟。它们通常用于所谓的“准蒙特卡洛”算法，其中不是随机抽样，而是使用某种或多或少均匀分布在域上的点网格。

这样的点序列不一定满足您给出的“所有最短距离对具有相似值”的条件，但我将此更多地解释为描述的尝试，而不是问题的硬性要求。如果它真的很重要，那么这可能无法解决您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-17T22:20:03.483

我认为您可能想研究[Sphere Packing](http://en.wikipedia.org/wiki/Sphere_packing)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T00:10:46.717

这是另一个想法（它并不完美，但我不认为这里有任何东西，您可能需要根据您的特定情况的详细信息进行选择）：使用 [二进制空间分区](https://en.wikipedia.org/wiki/Binary_space_partitioning)（[更多信息在这里](http://www.faqs.org/faqs/graphics/bsptree-faq/)）。

一般的想法是，您将 n 维空间并使用 (n-1) 维曲面将其分成两部分。然后你拆分这两个新闻空间，依此类推。如果您仔细选择曲面（以便它们分成大致相等的体积并避免有趣的形状，对于某些有趣的定义），那么您可以看到这将是您所要求的近似值。

这种方法的主要优点是它通常非常快（它用于视频游戏和空间模拟）。它不会像低差异序列（听起来很酷）那样快（或均匀），但我想它可以在任意凸包内工作。

# c# - Gridview 批量更新

> ID：10644157
> 
> 赞同：0
> 
> 时间：2012-05-17T22:05:42.660
> 
> 标签：c#, asp.net, gridview, web-controls, gridviewrow

从这个链接：

[asp.net 网格视图批量更新所有单元格](https://stackoverflow.com/a/8491026/1270384)

我做了以下事情：

```
 protected void ButtonUpdate_Click(object sender, EventArgs e)
    {
       // foreach (GridViewRow row in GridView1.Rows)

       // {

        int RowIndex = 0;
        GridViewRow row = (GridViewRow)GridView1.Rows[RowIndex];

            Int32 intresortID = Convert.ToInt32(Request.QueryString["TypeID"]);
            Label dtm = row.FindControl("Label1") as Label;
            Label strRoomType = row.FindControl("strRoomTypeLabel") as Label;
            Label strDescription = row.FindControl("Label3") as Label;
            TextBox Qty = row.FindControl("intQtyTextBox") as TextBox;
            TextBox Price = row.FindControl("curPriceTextBox") as TextBox;
            Label intWSCode = row.FindControl("intWSCodeLabel") as Label;

            string connStr = ConfigurationManager.ConnectionStrings["bedbankstandssConnectionString"].ConnectionString;
            SqlConnection Con = new SqlConnection(connStr);
            SqlCommand cmd = new SqlCommand("Update tblAvailable set intqty=@intQty, curprice=@curprice where intresortid=@intresortid and dtm=@dtm and strroomtype=@strroomtype",Con);

            //SqlParameter ddtm= new SqlParameter("@dtm",dtm) ;
            //SqlParameter sstrRoomType = new SqlParameter("@strroomtype", strRoomType);
            //SqlParameter qQty = new SqlParameter("@intQty", Qty);
            //SqlParameter pPrice =new SqlParameter("@curPrice",Price);
            //SqlParameter resortID = new SqlParameter("@intResortID", intresortID);
            cmd.Parameters.AddWithValue("@dtm",dtm.Text.Trim());
            cmd.Parameters.AddWithValue("@strroomtype",strRoomType.Text.Trim());
            cmd.Parameters.AddWithValue("@intQty", Qty.Text.Trim());
            cmd.Parameters.AddWithValue("@curPrice",Price.Text.Trim());
            cmd.Parameters.AddWithValue("@intResortID",intresortID);
            Con.Open();
            cmd.ExecuteNonQuery();
            GridView1.EditIndex = -1;
            DataBind();

       // }
    } 
```

但是只有一行被更新，第一行。

请问有人能告诉我哪里出错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:17:24.810

你已经注释掉了循环，那么你为什么想知道只有一行被更新了？

```
foreach (GridViewRow row in GridView1.Rows)
{
    // ...
} 
```

除此之外，使用[`using-statement`](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)你的`SqlConnection`并`SqlCommand`确保它被处理/关闭。

```
using(SqlConnection Con = new SqlConnection(connStr))
{
    using(SqlCommand cmd = new SqlCommand("Update tblAvailable set intqty=@intQty, curprice=@curprice where intresortid=@intresortid and dtm=@dtm and strroomtype=@strroomtype",Con))
    {
        // ...
    }
} 
```

# redis - 多个 Redis 实例

> ID：10644158
> 
> 赞同：16
> 
> 时间：2012-05-17T22:05:44.317
> 
> 标签：redis

大多数人似乎建议在不同的端口（6379 和 6380）上运行单独的 Redis 实例。为什么比创建第二个数据库更普遍推荐这样做？我还没有完全阅读文档，但是大多数示例在连接时并没有真正提到“选择 Redis 数据库”。来自 Ruby 客户端的示例，nrk/predis 的 README：

```
$redis = new Predis\Client(array(
    'scheme' => 'tcp',
    'host'   => '10.0.0.1',
    'port'   => 6379,
)); 
```

我们目前在办公室使用 Campfire 运行 Hubot，我正在为 GTalk 开发第二个，因为每个 Hubot 实例只能使用一个适配器。所以我正在考虑创建第二个数据库或 Redis 实例，以便隔离两个 hubot 之间的数据。但在我更进一步之前，我想了解为什么要使用单独的实例而不是仅仅创建第二个数据库。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-17T22:10:19.490

两个主要原因：

1.  使用多个数据库通常被认为是不好的，并且有一天会被弃用，并且它们有一些性能损失，尽管非常小。

2.  主要原因是 redis 是单线程的，如果您需要两个不同的数据源，另一个 redis 实例将提高性能，因为它将利用您可能拥有的另一个 CPU，而一个实例将始终只使用一个。

3.  不同的 redis 实例也可以有不同的持久性设置。例如一个实例只能使用内存，另一个可以使用文件作为存储 [Redis Persistence](https://redis.io/topics/persistence)

然后还有其他优点，例如具有单独的身份验证密码、LRU 策略等 - 这只能在实例级别完成。

# javascript - Json call&loop inside json call&loop with each

> ID：10644159
> 
> 赞同：1
> 
> 时间：2012-05-17T22:05:49.730
> 
> 标签：javascript, jquery, json, each

我有两个 json 文件，其中包含该新闻的所有新闻标题和特定主题的内容（不要问我为什么），所以我要做的是加载带有所有标题的 url，然后通过 id 搜索正确的内容。

它看起来像这样：

```
$.ajax({
    url: 'http://website.com/news.json?=list',
    dataType: 'json',
    success: function (data) {

        $.each(data.news, function (newsId, newsHeadline) {
            $('h1').after('<h2 id="question-' + newsId + '">' + newsHeadline + '</h2>');

            $.get('http://website.com/news.json?=list&id=' + newsId, function (data) {

                $('h2').after('<div class="accordion-content">' + data.result.newscontent + '</div>');

            });

        });

    }

}); 
```

到目前为止，它的工作几乎与预期一样，它正在加载标题和加载内容之后。

问题是它正在为每个标题加载所有内容。例如，第一个网址有 2 个标题。

所以应该是：

```
 Headline 1
  Content 1
 Headline 2
  Content 2 
```

但相反，它给了我：

```
 Headline 1
  Content 1
  Content 2
 Headline 2
  Content 1
  Content 2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:11:43.257

您没有限定`<h2>`在处理程序中追加时的引用`$.get()`。因此，内容被附加到**所有** `<h2>`元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T22:14:43.140

这是因为 ajax 调用的异步方式。
在第一个循环中，您使用回调进行 ajax 调用并继续进行第二个循环调用（无需等待 ajax 完成）。
ajax 回调可以在另一个循环中，所以不是得到 1-1,2-2.3-3 你会得到 1-2,2-2,3-2,4-3 ...
如果你需要它保持同样，您应该考虑以线性方式而不是嵌套的异步回调来执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:45:24.507

我认为这可能与两次使用数据变量有关。尝试这个：

```
$.ajax({
    url: 'http://website.com/news.json?=list',
    dataType: 'json',
    success: function (data) {

        $.each(data.news, function (newsId, newsHeadline) {
            $('h1').after('<h2 id="question-' + newsId + '">' + newsHeadline + '</h2>');

            $.get('http://website.com/news.json?=list&id=' + newsId, function (data2) {

                $('h2').after('<div class="accordion-content">' + data2.result.newscontent + '</div>');

            });

        });

    }

}); 
```

**编辑：**

哎呀...看起来Pointy是正确的。*$.get()*函数中的*$('h2')*选择器正在获取页面上的所有 h2 HTML 元素。

# c - 我在 C 中的字节是如何存储的？

> ID：10644162
> 
> 赞同：1
> 
> 时间：2012-05-17T22:06:02.553
> 
> 标签：c, memory, storage

首先，我还是个学生。所以我不是很有经验。

我正在使用一个蓝牙硬件，我正在使用它的协议向它发送命令。该协议要求每个数据包字段首先发送具有 LSB 的数据包。

我收到错误数据包，表明我的 CRC 值错误，所以我做了一些调查。我发现了问题，但在这个过程中我变得困惑。

这是一些 GDB 输出和其他信息，说明了我的困惑。

我正在发送一个应该如下所示的数据包：

```
|Start Flag| Packet Num | Command | Payload |    CRC    | End Flag|
    0xfc        0x1       0x0 0x8   0x0 0x5   0x59 0x42    0xfd 
```

这是一些 GDB 输出：

```
print /x reqId_ep
$1 = {start_flag = 0xfc, data = {packet_num = 0x1, command = {0x0, 0x8}, payload = {
  0x0, 0x5}}, crc = 0x5942, end_flag = 0xfd} 
```

reqId_ep 是我发送的数据包的变量名。那里看起来一切都很好，但是我从它那里收到了 CRC 错误代码，所以一定有问题。

在这里，我从要发送的数据包的地址开始检查 9 个十六进制字节：

```
x/9bx 0x7fffffffdee0
0xfc    0x01    0x00    0x08    0x00    0x05    0x42    0x59    0xfd 
```

问题在这里变得很明显。CRC 不是 LSB 在前的。(0x42 0x59)

为了解决我的问题，我删除了我设置我的 CRC 值等于的 htons()。

这是上面没有 htons() 的相同输出：

```
p/x reqId_ep

$1 = {start_flag = 0xfc, data = {packet_num = 0x1, command = {0x0, 0x8}, payload = {
  0x0, 0x5}}, crc = 0x4259, end_flag = 0xfd} 
```

这里的 CRC 值不是 LSB。

但是之后：

```
x/9bx 0x7fffffffdee0
0xfc    0x01    0x00    0x08    0x00    0x05    0x59    0x42    0xfd 
```

这里的 CRC 值是 LSB 在前。

那么显然 C 的存储首先是 LSB？对于这种情况，有人可以向我投射知识吗？非常感谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-17T22:45:59.227

这与计算中的字节序有关： [http ://en.wikipedia.org/wiki/Endianness#Endianness_and_operating_systems_on_architectures](http://en.wikipedia.org/wiki/Endianness#Endianness_and_operating_systems_on_architectures)

例如，值 4660（以十进制为底）是十六进制的 0x1234。在 Big Endian 系统上，它将存储在内存中，`1234`而在 Little Endian 系统上，它将存储为`3412`

如果您想在将来避免此类问题，创建一个大型数组或 unsigned char 结构并在其中存储单个值可能是最简单的方法。

例如：

```
|Start Flag| Packet Num | Command | Payload |    CRC    | End Flag|
    0xfc        0x1       0x0 0x8   0x0 0x5   0x59 0x42    0xfd

typedef struct packet {
  unsigned char startFlag;
  unsigned char packetNum;
  unsigned char commandMSB;
  unsigned char commandLSB;
  unsigned char payloadMSB;
  unsigned char payloadLSB;
  unsigned char crcMSB;
  unsigned char crcLSB;
  unsigned char endFlag;
} packet_t; 
```

然后，您可以创建一个函数，根据您为使用预处理器宏构建的系统类型进行不同的编译。

例如：

```
/* Uncomment the line below if you are using a little endian system;
/* otherwise, leave it commented
 */
//#define LITTLE_ENDIAN_SYSTEM

// Function protocol
void writeCommand(int cmd);

//Function definition
void writeCommand(int cmd, packet_t* pkt)
{
  if(!pkt)
  {
     printf("Error, invalid pointer!");
     return;
  }

  #if LITTLE_ENDIAN_SYSTEM
    pkt->commandMSB = (cmd && 0xFF00) >> 8;
    pkt->commandLSB = (cmd && 0x00FF);
  # else  //  Big Endian system
    pkt->commandMSB = (cmd && 0x00FF);
    pkt->commandLSB = (cmd && 0xFF00) >> 8;
  #endif

  // Done
}

int main void() 
{
  packet_t myPacket = {0};  //Initialize so it is zeroed out
  writeCommand(0x1234,&myPacket);

  return 0;
} 
```

最后一点：避免将结构作为数据流发送，而是一次发送一个单独的元素！即：不要假设结构在这种情况下是内部存储的，就像一个巨大的无符号字符数组。有些东西是编译器和系统放置的，比如打包和对齐，结构实际上可能大于`9 x sizeof(unsigned char)`.

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T22:09:14.793

这取决于您所针对的处理器的架构。有所谓的“Big Endian”系统，它首先存储一个字的最高有效字节，以及“Little Endian”系统，它首先存储最低有效字节。看起来您正在那里查看 Little Endian 系统。

# emacs - 在命令行中调用 man 命令时如何使用 emacs 查看手册页？

> ID：10644163
> 
> 赞同：4
> 
> 时间：2012-05-17T22:06:09.947
> 
> 标签：emacs, pager, manpage

我想在调用 man 命令时使用 emacs 查看手册页。`/etc/man.conf`我将PAGER 中的 pager 参数修改为`emacs`.

但是，它不起作用。有什么我应该修改的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T00:33:52.597

实际上，emacs 无法将 STDIN 读入缓冲区，这意味着

`cat foobar | emacs`

在任何情况下都不起作用。因此，将 PAGER 变量设置为“emacs”或“emacs -nw”并不能完成这项工作。我看到的唯一方法是将`man`输出写入 tmp 文件，然后将该文件加载到 emacs 中：

`man find > tmp-file; emacs tmp-file`

你可以给这个取别名。例如，假设有一个 tc-shell，并且在您的主路径中有一个名为 'tmp' 的目录，您可以将以下行放入您的`~/.tcshrc`文件中：

`alias man '/usr/bin/man \!* > ~/tmp/tmp-file; emacs ~/tmp/tmp-file; rm ~/tmp/tmp-file'`

所以下次你打电话时`man find`，emacs 会启​​动。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T00:38:41.750

您可以从 emacs 的功能中获益`man`。只需在 bash 中定义一个函数，该函数将运行将调用它的 emacs：

```
function man () {
    emacs -e '(man "'"$1"'")'
} 
```

你可能想打电话`emacs -nw`，甚至`emacsclient`代替。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-24T07:45:47.830

Emacs 有一个“Man 模式”，可以调用它`M-x man RET`然后输入你的命令。

# android - iOS 上可怕的 libPNG 性能

> ID：10644164
> 
> 赞同：4
> 
> 时间：2012-05-17T22:06:24.320
> 
> 标签：android, c++, ios, png, libpng

我目前正在使用开源 libPNG 库来读取和解压缩位图。它在 Android、OS X 和 Win32 上运行良好，但由于某种原因，它在 iOS 设备上的运行速度要慢*30 倍。*所有平台都使用相同的 libPNG 源代码树（未修改）。

我在 Cocos2D 论坛中发现的几件事让我相信这是 iOS 上的 zlib 实现的问题，但我尝试同时使用 stb_image 和 LodePng 来避免 zlib，而这些库实际上比 libPNG 执行得更糟糕！

是否有一些特殊的方法可以为 iOS“正确”构建 libPNG？如果不是，那么 libPNG*在*iOS 上的运行速度要慢得多？为什么 stb_image 也会变慢/变慢？有没有已知的方法来解决或纠正这个问题？

谢谢， AF

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:13:40.213

您可以尝试重建 zlib，这可能会解决您的问题。如果没有，请尝试寻找一些支持 PNG 的流行开源 iOS 应用程序，这些应用程序可能已经解决了这个问题。你甚至可以在他们的论坛上发帖。

# xml - 来自外部 XML 的链接不再起作用，AS3/Flash

> ID：10644166
> 
> 赞同：1
> 
> 时间：2012-05-17T22:06:50.787
> 
> 标签：xml, actionscript-3

希望有人可以帮助我...我在 Flash 中加载了一个外部 XML 文件。它工作得很好，但从这周开始就不行了。XML 文件中的链接是问题所在。我不知道为什么。在 Flash 中，我收到消息： `Error #2044: Unhandled IOErrorEvent:. text=Error #2035: URL Not Found.` 第一次单击按钮时正在加载 XML，并且链接有效，但之后根本没有加载任何文本和链接！

我给出了我使用的代码：

```
var txtFld:TextField = new TextField();
var txtFmt:TextFormat = new TextFormat();

var xml:XML;
var urlLoader:URLLoader = new URLLoader();
var urlRequest:URLRequest = new URLRequest("background.xml");
urlLoader.load(urlRequest);
urlLoader.addEventListener(Event.COMPLETE, onComplete, false,0,true);
function onComplete(evt:Event):void {
evt.target.removeEventListener(Event.COMPLETE, onComplete);
xml = new XML(evt.target.data);
}

txtFmt.font = avenirRoman.fontName; 
txtFmt.size = 12; 
txtFmt.leading = 4;
txtFmt.color = 0x616161; 
txtFld.defaultTextFormat = txtFmt; 
txtFld.embedFonts = true;
txtFld.antiAliasType = AntiAliasType.ADVANCED;
txtFld.thickness = -100;
txtFld.sharpness = 50;
txtFld.multiline = true;
txtFld.wordWrap = true; 
txtFld.width = 500; 
txtFld.autoSize = TextFieldAutoSize.LEFT; 
txtFld.x = 270; 
txtFld.y = 145;

btn10.addEventListener("click", afterClick2);
function afterClick2(e:Event):void {
txtFld.htmlText = xml.INFO[0].toString();
addChild(txtFld);

}

btn11.addEventListener("click", afterClick3);
function afterClick3(e:Event):void {
txtFld.htmlText = xml.INFO[1].toString();
addChild(txtFld);

}

btn12.addEventListener("click", afterClick4);
function afterClick4(e:Event):void {
txtFld.htmlText = xml.INFO[2].toString();
addChild(txtFld);

} 
```

然后我尝试输入额外的（IOErrorEvent）代码：

```
urlLoader.addEventListener(IOErrorEvent.IO_ERROR, catchIOError);
function catchIOError(event:IOErrorEvent){
trace("Error caught: "+event.type);
}
urlLoader.load(new URLRequest("Invalid XML URL"));
trace("Continuing with script...");*** 
```

然后我收到消息：TypeError：错误＃1009：无法访问空对象引用的属性或方法。在 main3_fla::MainTimeline/afterClick2()

并且 XML 文件根本没有加载。如果我取出 XML 中的所有链接，文本加载完美。

谁能告诉我怎么了？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T10:48:27.630

这整个“问题”真的很奇怪，你确定你在写 AS3 代码吗？我一生无法理解以下事情：

1.  你的问题是什么？您可以一次加载您的 xml 文件和所有链接吗？第二次尝试重新加载 xml 文件时会出现问题吗？每当您在 xml 文件中没有链接时，它是否总是有效？
2.  您提到了一个加载您的 xml 文件的按钮，我在您的代码中没有看到提供该功能的按钮
3.  您试图从哪里加载您的 xml 文件，它是来自您计算机的本地文件还是来自某个地方的网络（在网络服务器上）？
4.  你做了一个新的 URLRequest("background.xml") 但你没有提供绝对 URL，这意味着这可能是某种路径更改，所以“background.xml”第二次链接到其他东西（不知道如何，但一切皆有可能)
5.  您的代码看起来很奇怪，我无法判断整个代码是构造函数的一部分还是其他东西。您不止一次地执行“addChild”，如果 txtFld 是某种类成员并且该类有多个实例，这可能会成为一个问题。
6.  我不明白您提供的 IOErrorEvent-example，您故意抛出一个错误，在某处捕获它，然后期望它在无效的 urlRequest 之前在 catch 块之外继续使用脚本？

您描述的错误 #1009 非常简单，当您输入该函数时，您无法访问变量“txtFld”、“xml”或 xml 看起来不像您期望的那样。

这一切都归结为以下几点：

*   除非您为初始化/创建事物以及调用事物的时间提供更多上下文，否则我无法帮助您解决问题，因为现在您正在混合初始化和调用，而没有为任何一个提供正确的上下文

# php - 优化我的搜索引擎

> ID：10644170
> 
> 赞同：4
> 
> 时间：2012-05-17T22:07:10.493
> 
> 标签：php, mysql

我正在尝试优化我的搜索引擎。现在，我在用户输入的搜索词和存储在数据库中的关键字之间运行 strcmp。我试图想出一种方法，以便用户搜索词与关键字的匹配越多，它就会越早出现在搜索结果中。

例如，如果用户搜索“red apple painting”并且我有两个条目，该条目具有以下关键字 1\. “old apple painting green” 2\. “apple painting red new york” 我想要第二个条目在搜索结果中排名第一，因为所有用户搜索词都是在存储在数据库中的关键字中找到的。

关于我如何实现这一目标的任何帮助？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T22:09:53.070

看看[全文搜索](http://dev.mysql.com/doc/refman/5.6/en/fulltext-search.html)。

您可能还需要考虑外部文本搜索引擎，例如[Lucene](http://lucene.apache.org/core/)或[Sphinx](http://sphinxsearch.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T12:47:18.810

您需要创建单词索引。索引将包含单词 id、doc id、命中数、命中位置。然后搜索者将能够提供您想要的结果。市场上有免费的索引工具。但是，如果您想开发自己的，请遵循原始论文 bt google 创始人- [http://infolab.stanford.edu/~backrub/google.html](http://infolab.stanford.edu/~backrub/google.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-23T14:00:56.180

找到具有准确寻找网站访问者能力的适用关键字。为谷歌和客户等引擎创建和优化页面。确保将您的网站提供给每个机器人和人类。从不同的著名网站建立适用的链接。

# regex - 需要帮助使用 Perl 修复此正则表达式代码吗？

> ID：10644171
> 
> 赞同：2
> 
> 时间：2012-05-17T22:07:10.680
> 
> 标签：regex, string, perl

在使用 perl 修复此正则表达式代码时，我需要您的专业帮助吗？

我有这个数据文件...

```
__数据__
SCSI - 测试-A
cccccccccccccccc
啊啊啊啊啊啊啊
bbbbbbbbbbbbbbbbb

__数据__
SCSI - 测试-B
cccccccccccccccc
啊啊啊啊啊啊啊
bbbbbbbbbbbbbbbbb

__数据__
SCSI - 测试-C
cccccccccccccccc
啊啊啊啊啊啊啊
bbbbbbbbbbbbbbbbb
```

我想要以下输出

```
__数据__
SCSI - 测试-A

__数据__
SCSI - 测试-B

__数据__
SCSI - 测试-C
```

相反，我得到的输出缺少`__Data__`两个数据记录。

```
__数据__
SCSI - 测试-A
SCSI - 测试-B
SCSI - 测试-C
```

这里的代码..

```
$/ = "__Data__"; # setting the input separator variable to __Data__

while(<ReadFile>)
{
   $_ =~ s/(SCSI.*test-(A|B|C)?)(.*)/$1/ms;
   print $_;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:27:07.297

你告诉 Perl 那行以 结尾`__DATA__`，所以你得到

```
1: "__Data__"
2: "\nSCSI - test-A\nccc\naaa\nbbb\n\n__Data__"
3: "\nSCSI - test-B\nccc\naaa\nbbb\n\n__Data__"
4: "\nSCSI - test-C\nccc\naaa\nbbb\n" 
```

但你错误地认为你得到了

```
1: "__Data__\nSCSI - test-A\nccc\naaa\nbbb\n\n"
2: "__Data__\nSCSI - test-B\nccc\naaa\nbbb\n\n"
3: "__Data__\nSCSI - test-C\nccc\naaa\nbbb\n" 
```

解决方案：

```
my $after_data = 0;
while (<>) {
   if (/^__Data__$/) {
      print;
      $after_data = 1;
   }
   elsif ($after_data) {
      print;
      print "\n";
      $after_data = 0;
   }
} 
```

您还可以使用段落模式：

```
local $/ = '';
while (<>) {
   print /^(.*\n.*\n)/;
   print "\n";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T15:14:24.727

您似乎想要打印符合*三个*类别之一的行。

1.  `__Data__`标记
2.  SCSI 测试线
3.  空行

Perl 的段落模式在工作时很方便，但它很脆弱。段落*完全*由 sequence终止`"\n\n"`，但是当段落后面有一个空白但非空的行时，不显示空格的编辑器会使调试变得棘手。

正如您在问题中所写，下面的代码会产生您想要的输出。

```
#! /usr/bin/env perl

use strict;
use warnings;
use 5.10.0;  # smart matching

*ARGV = *DATA;  # for demo only

my @interesting_line = (qr/^__Data__/, qr/SCSI - test-/, qr/^\s*$/);

while (<>) {
  print if $_ ~~ @interesting_line;
  print "\n" if eof && !eof();
}

__DATA__
__Data__
SCSI - test-A
ccccccccccccccccc
aaaaaaaaaaaaaaaaa
bbbbbbbbbbbbbbbbb

__Data__
SCSI - test-B
ccccccccccccccccc
aaaaaaaaaaaaaaaaa
bbbbbbbbbbbbbbbbb

__Data__
SCSI - test-C
ccccccccccccccccc
aaaaaaaaaaaaaaaaa
bbbbbbbbbbbbbbbbb 
```

在实际使用中，您将删除标记为仅用于演示的行，然后在命令行上提供一个或多个数据文件。这个看起来很有趣的`if eof && !eof()`测试试图确定何时在记录之间插入额外的分隔符。如果您希望它完全正确，则需要更加深思熟虑。

下面是多个文件的输入示例。

```
$猫输入1
__数据__
SCSI - 测试-A
cccccccccccccccc
啊啊啊啊啊啊啊
bbbbbbbbbbbbbbbbb

__数据__
SCSI - 测试-B
cccccccccccccccc
啊啊啊啊啊啊啊
bbbbbbbbbbbbbbbbb

$猫输入2
__数据__
SCSI - 测试-C
cccccccccccccccc
啊啊啊啊啊啊啊
bbbbbbbbbbbbbbbbb

$ ./extract-tests 输入1 输入2
__数据__
SCSI - 测试-A

__数据__
SCSI - 测试-B

__数据__
SCSI - 测试-C
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T22:13:11.843

尝试添加

```
 $\ = $/; 
```

…也设置你的输出记录分隔符。

但是，您最终会`__Data__`以这种方式得到最终的虚假实例，因为它是在每条记录*之后*打印的（在 each 的末尾`print`）。

或者，您可以自己拆分输入：

```
 while (<ReadFile>)
  {   chomp;
      next unless $_ eq '__Data__'; print;
      my $next = <ReadFile>;
      $next =~ s/(SCSI.*text-(A|B|C)?).*/$1/ms;
      print $next;
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T22:23:20.723

将输入记录分隔符设置为空字符串以启用段落模式。在打印中添加换行符。

```
$/ = ""; # paragraph mode

while (<ReadFile>) {
    $_ =~ s/(SCSI.*test-(A|B|C))(.*)/$1/s;
    print "$_\n\n";
} 
```

# axapta - 成本金额物理计算

> ID：10644177
> 
> 赞同：0
> 
> 时间：2012-05-17T22:07:51.460
> 
> 标签：axapta, inventory

AX 如何计算库存交易（`Inventrans`表）的实际成本金额？

在采购订单中过帐装箱单时，会在 Inventrans 表中创建交易记录，该表有一个字段（CostAmountPhysical）

AX 如何计算该字段的值？

有时此值与采购订单中每个项目计算的净金额不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T11:00:14.670

该`CostAmountPhysical`字段在`InventMovement.updateLedgerPhysical`方法中计算。

没有简单的解释如何以及为什么计算它。去看看代码。

请更新您的交叉引用，这极大地简化了此类问题。

# java - Netbeans 使项目消失？如何恢复？

> ID：10644179
> 
> 赞同：4
> 
> 时间：2012-05-17T22:08:03.200
> 
> 标签：java, netbeans, project, freeze, recover

当netbeans冻结并异常关闭时，我正在做一个项目。当我重新打开该项目时，当我检查 netbeans 工作区时，该文件夹也丢失了。

netbeans 是否为他的项目保留备份？有什么办法可以恢复吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T09:41:21.683

是的，当然，希望冻结没有破坏保存系统。

仅对于文件很容易：

> *   右键单击您的项目/包
>     
>     
> *   选择`Local History`->`Revert Deleted`

现在，如果您放弃了所有可以执行此操作的项目（我已经尝试过它对我有用）

> *   创建一个同名的新项目。
> *   解决文件的技巧（第 2 点）

如果这个技巧不起作用，我担心你没有更多的本地历史并且永远不会取回你的文件......

# firefox - weird bug? firefox - when clicking and mouseout on an icon, selection rectangle appaers

> ID：10644181
> 
> 赞同：0
> 
> 时间：2012-05-17T22:08:15.493
> 
> 标签：firefox, navigation, icons, href

When you click on an icon in the navigation bar and you remove your mouse from the link, a selection rectangle appaers over the whole screen. How can i prevent this. It's not reproducable with a jsfiddle: [http://jsfiddle.net/woutvdd/2B3dY/](http://jsfiddle.net/woutvdd/2B3dY/) . my website: [http://www.woutvdd.be](http://www.woutvdd.be).

I'm using firefox 12 and i also have this issue in ubuntu.

Someone has a clue?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:11:07.727

This is not a bug, it's Firefox behavior.

The short version of the answer is for you to apply this to your css:

```
a:active {
  outline: none;
} 
```

# python - 如何在 Python 中存储变量/首选项以供以后使用

> ID：10644183
> 
> 赞同：8
> 
> 时间：2012-05-17T22:08:23.313
> 
> 标签：python, registry, preferences, persistent

我正在为 Windows 编写一个 Python 程序，并希望保存变量和用户首选项，以便即使在程序终止并重新启动后我也可以调用它们。

在 Windows 机器上是否有理想的方法来执行此操作？`_winreg`Windows 注册表是否适合此任务？还是我需要创建自己的某种数据库？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-17T22:36:10.833

Python2 在 Python3中有[ConfigParser](http://docs.python.org/library/configparser.html)，即 configparser：

```
import ConfigParser, os

config = ConfigParser.ConfigParser()
config.readfp(open('defaults.cfg'))
config.read(['site.cfg', os.path.expanduser('~/.myapp.cfg')]) 
```

即使在 Windows 上，您也应该知道注册表是一个卑鄙的人渣和恶棍的蜂巢，您不应该使用它来存储您的 python 应用程序配置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-17T22:34:41.570

您通常希望将其存储在“主”文件夹中的配置文件夹中。这在 *nix 系统上很容易，在 Windows 上更难，因为您实际上需要获取“应用程序数据”目录。这通常对我有用：

```
import os
if os.name != "posix":
    from win32com.shell import shellcon, shell
    homedir = "{}\\".format(shell.SHGetFolderPath(0, shellcon.CSIDL_APPDATA, 0, 0))
else:
    homedir = "{}/".format(os.path.expanduser("~")) 
```

拥有主目录后，您应该创建一个以您的项目命名的文件夹：

```
if not os.path.isdir("{0}.{1}".format(homedir,projectname)):
    os.mkdir("{0}.{1}".format(homedir,projectname)) 
```

然后，您可以在该文件夹中创建一个配置文件，并以您选择的格式将您的选项写入其中（我个人最喜欢的是 XML）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-17T22:10:49.613

除非我遗漏了什么，否则正则表达式与 Windows 注册表无关。只需将配置文件存储在某处，例如用户的主目录或其他任何地方。至少这是我在 linux 上所做的。将文件存储在某处`~/.config/`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-17T22:32:42.773

如果您只想存储首选项的键值对，请在文本配置文件中进行。如果要存储 python 结构，请使用[`pickle`](http://docs.python.org/library/pickle.html#module-pickle)or [`shelve`](http://docs.python.org/library/shelve.html)。如果您需要轻量、无忧的 rdbms，请使用[`sqlite`](http://docs.python.org/library/sqlite3.html).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-17T22:35:44.127

虽然该`pickle`模块是一个显而易见的选择，但它写入的文件将是非人类可读的。对于配置文件，如果您的配置文件是您的用户可以阅读甚至编辑的简单文本格式，那就太好了。所以，我推荐你使用 JSON 和`json`模块。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-17T22:40:01.120

有几种方式，分为两个主要方向

*   使用模块访问 Windows 注册表`_winreg`。

使用注册表将设置传输到另一台机器或检查或备份它们是非常重要的；你必须使用`regedit`那些。

另一种方式将首选项存储在用户“我的文档”文件夹中的文件中。这使得将设置移动到另一台机器或用户变得更加容易，并且不会将您的程序设置与许多其他应用程序的设置混合在一起。因此，备份和恢复它们之类的事情更容易；您只需复制一个文件。如果您选择文本格式，也更容易检查和调试设置。

*   将您的设置放在列表、元组或字典中，并与`cPickle`模块一起保存。这可能是最简单的方法之一。不利的一面是，虽然腌制数据默认使用 ASCII 格式，但它不是人类可读的。
*   使用该`ConfigParser`模块以与 Windows 文件类似的结构保存和加载配置`.ini`文件。这些文件是人类可读的。
*   使用该`json`模块以 json 格式存储设置。这些文件是人类可读的。
*   将首选项作为 Python 表达式保存到文本文件中，使用`execfile()`. NB 这可以用来执行任意代码，所以有安全方面的考虑。但从好的方面来说，它非常简单易读。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-17T22:19:08.567

为了保存变量，我推荐使用[pickle](http://docs.python.org/library/pickle.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-21T20:04:15.373

要确定**存储首选项**的位置，我建议使用[appdirs](https://pypi.org/project/appdirs/)包为您的操作系统找到适当的“应用程序数据”、“首选项”或“主”目录：

```
from appdirs import user_data_dir
appname = "SuperApp"
appauthor = "Acme"
appdata_dirpath = user_data_dir(appname, appauthor)
# 'C:\\Users\\me\\AppData\\Local\\Acme\\SuperApp' on Windows
# '/Users/me/Library/Application Support/SuperApp' on macOS
# '/home/me/.local/share/SuperApp' on Linux

import os
os.makedirs(appdata_dirpath, exist_ok=True) 
```

然后在该目录中，您可以编写一个文件，文件格式有许多不同的选项：

*   **键值字符串？**考虑一个 INI 文件，您可以使用内置[`configparser.ConfigParser`模块](https://docs.python.org/3/library/configparser.html)读取/写入该文件。

*   **嵌套字典、列表、字符串和整数？**考虑 JSON，您可以使用内置[`json`模块](https://docs.python.org/3/library/json.html)读取/写入它。

*   **有更高级的需求？**比如存储大量偏好项，或者需要存储二进制数据？考虑一个使用内置[`sqlite3`模块](https://docs.python.org/3/library/sqlite3.html)的 sqlite 数据库。

虽然可以使用该`pickle`模块，但我不推荐它，因为配置文件不是人类可读的。

# certificate - javafx 2.1 中的签名者证书

> ID：10644188
> 
> 赞同：14
> 
> 时间：2012-05-17T22:08:51.350
> 
> 标签：certificate, javafx-2, javafx, netbeans-7

我在 Windows 7 和 javafx 上使用 netbeans，当我运行程序时，此消息出现在输出中，

```
Warning: 
The signer certificate will expire within six months.
Enter Passphrase for keystore: Enter key password for nb-jfx: 
Signing JAR:
C:\Users\subhi\Desktop\SpeechRecognition\SpeechRecognition\dist\lib\batch.jar to 
C:\Users\subhi\Desktop\SpeechRecognition\SpeechRecognition\dist\lib\batch.jar as nb-jfx 
```

1.  有 5 条类似的消息，这些消息会减慢我的应用程序启动速度，我想禁用它们，我该怎么做？

2.  我可以在 javafx 2.1 中使用 eclipse 吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-17T23:17:55.347

> 我想禁用它们，我该怎么做？

为您的构建禁用 jar 打包和签名。

1.  右键单击项目，选择属性。
2.  选择构建 | 打包并确保未选中“编译后构建 Jar”。
3.  选择构建 | 部署并确保未选中“请求不受限制的访问”。
4.  按 OK 关闭项目属性对话框。
5.  按 F6 运行您的项目并确保它仍然运行。
6.  修改一个文件，然后用 F6 再次运行它来感受一下速度。. .

对于分发打包，您可能希望重新启用其中一些选项，但如果您的应用在处于开发模式时没有它们也能正常工作并且可以加快开发速度，那么禁用它们以进行开发是个好主意。

> 我可以在 javafx 2.1 中使用 eclipse 吗？

是的，使用[e(fx)clipse 插件](http://efxclipse.org/)。

# asp.net - 现场 ASP.Net Web 应用程序给出 NullReferenceException

> ID：10644198
> 
> 赞同：-3
> 
> 时间：2012-05-17T22:10:38.903
> 
> 标签：asp.net, publishing

我有一个在运行表单 VS 时运行良好的 Web 应用程序，但是一旦它发布，试图导航到该站点就会引发 NullRefernceException。这是堆栈跟踪：

```
[NullReferenceException: Object reference not set to an instance of an object.]
DAL.VendorRepDAL.GetRepsInfo(List`1 fields) in C:\Users\mfoster\Desktop\EventPlanner\DAL\DAL.vb:649
EventPlanner.DealEntry.LoadData() in C:\Users\mfoster\Desktop\EventPlanner\EventPlanner\deals.aspx.vb:31
System.Web.UI.Control.LoadRecursive() +70
System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +3063 
```

我认为这个问题可能与堆栈跟踪中的文件路径出于某种原因引用我的硬盘驱动器这一事实有关。如果是这种情况，我不知道如何解决它。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:02:27.747

Sherlock Holmes 可能会推断出，由于此错误来自名为 DAL 的类，因此：

*   您的实时应用程序没有有效的数据库连接字符串，或者
*   您的实时应用程序正在连接的数据库没有它期望的表和/或行和/或数据。

但是，我们其他人可能需要查看更多代码，例如`GetRepsInfo`似乎正在抛出的方法。

`NullReferenceException`可以在此处找到常见原因和修复方法：[什么是 NullReferenceException，以及如何修复它？](https://stackoverflow.com/q/4660142/1311550)

# java - 如何收听 JTextField 中字符的输入？

> ID：10644200
> 
> 赞同：4
> 
> 时间：2012-05-17T22:10:49.800
> 
> 标签：java, swing, numbers, actionlistener, jtextfield

我希望能够在 Sql 查询中发送此 JTextField 的内容之前验证 JTextField 是否仅包含“数字”并且不包含 (+ , -)（以避免 SqlException）。

我想 ：

*   如果我输入一个字母，则会显示一个 JLabel，并且 JTextField 的颜色会变为红色。

    label_errer.setVisible (true);

*   如果我删除该字母，JLabel 将消失，JTextField 的颜色正常。

    label_errer.setVisible (false);

如果我单击“输入”，则以下代码有效：

```
 textField_app = new JTextField(3);
    textField_app.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {

            JTextField source = (JTextField) e.getSource();
            String textFieldContent = source.getText();

            Color bgColor = Color.RED;

            boolean isNumeric=false;
            try { 

                Integer.parseInt(textFieldContent);
                 isNumeric = true;
                bgColor = Color.WHITE;
                label_errA.setVisible(false);
            } catch (Exception e2) {
                 // ---> isNumeric=false
            }

            source.setBackground(bgColor);

            if(isNumeric==false){
                label_errA.setEnabled(true);
                label_errA.setVisible(true);

            }

        }
    }); 
```

## **这个解决方案有效，但还有另一个吗？**

```
 textField_app = new JTextField(3);
    KeyListener keyListener = new KeyListener() {
          public void keyPressed(KeyEvent keyEvent) {
            printIt("Pressed", keyEvent);
          }

          public void keyReleased(KeyEvent keyEvent) {
            printIt("Released", keyEvent);
          }

          public void keyTyped(KeyEvent keyEvent) {
            printIt("Typed", keyEvent);
          }

          private void printIt(String title, KeyEvent keyEvent) {
            int keyCode = keyEvent.getKeyCode();
            String keyText = KeyEvent.getKeyText(keyCode).toString();

            if(keyCode==(getKeyBinding(keyText))){ 
            textField_app.setBackground(new Color(220, 20, 60));
            label_errA.setEnabled(true);
            label_errA.setVisible(true);
            }
            else  {
                 Color bgColor =Color.WHITE;
                 textField_app.setBackground(bgColor);

                label_errA.setEnabled(false);
                label_errA.setVisible(false);
            }

          }
        };

public int getKeyBinding(String k){
  if(k.equals("A")){
   return KeyEvent.VK_A;
  } else if(k.equals("B")){
   return KeyEvent.VK_B;
  } else if(k.equals("C")){
   return KeyEvent.VK_C;
  } else if(k.equals("D")){
   return KeyEvent.VK_D;
  } else if(k.equals("E")){
   return KeyEvent.VK_E;
  } else if(k.equals("F")){
   return KeyEvent.VK_F;
  } else if(k.equals("G")){
   return KeyEvent.VK_G;
  } else if(k.equals("H")){
   return KeyEvent.VK_H;
  } else if(k.equals("I")){
   return KeyEvent.VK_I;
  } else if(k.equals("J")){
   return KeyEvent.VK_J;
  } else if(k.equals("K")){
   return KeyEvent.VK_K;
  } else if(k.equals("L")){
   return KeyEvent.VK_L;
  } else if(k.equals("M")){
   return KeyEvent.VK_M;
  } else if(k.equals("N")){
   return KeyEvent.VK_N;
  } else if(k.equals("O")){
   return KeyEvent.VK_O;
  } else if(k.equals("P")){
   return KeyEvent.VK_P;
  } else if(k.equals("Q")){
   return KeyEvent.VK_Q;
  } else if(k.equals("R")){
   return KeyEvent.VK_R;
  } else if(k.equals("S")){
   return KeyEvent.VK_S;
  } else if(k.equals("T")){
   return KeyEvent.VK_T;
  } else if(k.equals("U")){
   return KeyEvent.VK_U;
  } else if(k.equals("V")){
   return KeyEvent.VK_V;
  } else if(k.equals("W")){
   return KeyEvent.VK_W;
  } else if(k.equals("X")){
   return KeyEvent.VK_X;
  } else if(k.equals("Y")){
   return KeyEvent.VK_Y;
  } else if(k.equals("Z")){
   return KeyEvent.VK_Z;
  } 
else{
   return 0;
  }
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T22:17:50.087

您正在寻找[JFormattedTextField](http://docs.oracle.com/javase/7/docs/api/javax/swing/JFormattedTextField.html)。[您可以在这里](http://docs.oracle.com/javase/tutorial/uiswing/components/formattedtextfield.html)获得所有信息，让您自己入门。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-17T22:18:00.690

您可能应该做的检测每次按键操作是[使用`DocumentListener`](http://docs.oracle.com/javase/tutorial/uiswing/events/documentlistener.html). 但是由于您的目标是验证，请看一下[使用 a `DocumentFilter`instead](http://docs.oracle.com/javase/tutorial/uiswing/components/generaltext.html#filter)。它有点复杂，但它是一种更清洁的方法，并且不会出现任何并发修改异常。

您可以创建一个`DocumentFilter`, 然后每次按键都需要通过过滤器的检查（一种粗略的放置方式，但相当准确）。如果过滤器认为没问题，它就会通过。正如您所提到的，您还可以添加自己的任何操作，例如将字段变为红色。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T22:13:26.680

我认为您正在寻找`java.awt.event.KeyListener`而不是`ActionListener`. 使用该`KeyTyped()`功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T22:12:31.290

我写了一个库，如果你愿意，我可以给你一个链接，它为你提供只能接受数字而不能接受其他任何内容的文本字段。

是的，你也可以看源码，没问题。

# css - *-transform：旋转在 Firefox 中有效，但在 chrome 中无效

> ID：10644204
> 
> 赞同：1
> 
> 时间：2012-05-17T22:10:59.833
> 
> 标签：css, cross-browser

CSS 如下所示：

```
.rotate
{
    -webkit-transition: all .5s ease-in-out; 
    -moz-transition: all .5s ease-in-out; 
    -o-transition: all .5s ease-in-out; 
    -ms-transition: all .5s ease-in-out;
}
.rotate:hover
{
    -webkit-transform: rotate(90deg) scale(1); 
    -moz-transform: rotate(90deg) scale(1); 
    -o-transform: rotate(90deg) scale(1); 
    -ms-transform: rotate(90deg) scale(1); 
} 
```

将鼠标悬停在 a`<span class="rotate">`将旋转 Firefox 中的元素，但不会旋转 chrome。
演示： http: [//jsfiddle.net/BuHGQ/](http://jsfiddle.net/BuHGQ/)（悬停在箭头上）

可以做些什么让它在 Chrome 中工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-17T22:14:07.837

试试这个：

```
.rotate { display: inline-block; } 
```

[http://jsfiddle.net/y7nfD/1/](http://jsfiddle.net/y7nfD/1/)

# javascript - javascript从对象中的数组中获取数组

> ID：10644205
> 
> 赞同：1
> 
> 时间：2012-05-17T22:11:00.580
> 
> 标签：javascript

我有一个对象`MyObject`，它的一个属性`ItemIDs`是一个整数数组。我想得到一个`PageItemIDs`只包含部分整数的新数组。这是一个寻呼机；我传入页码`PageNumber`并获得页面上项目的 ID。假设页面大小为 20 项。

这是我尝试过的。它不起作用，因为 js 与引用一起工作，所以我最终改变了对象的数组。

```
PageItemIDs = MyObject.ItemsID;
PageItemIDs = PageItemIDs.splice(PageNumber * 20, 20); 
```

而不是在页面中获取 ItemID，我最终得到不在页面中的 ItemID。

我知道我不是那么遥远，但如果你能提供帮助，那就太好了。

谢谢。

编辑：

当我做

```
PageItemIDs = PageItemIDs.slice((PageNumber -1) * 20, 20); 
```

它适用于第 1 页，但对于其他所有页面，它返回一个空数组。

好的，我明白了，没关系。

```
 PageItemIDs = PageItemIDs.slice(PageNumber * 20, PageNumber * 20); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:13:20.193

```
PageItemIDs = cloneObject(MyObject).ItemsID;
PageItemIDs = PageItemIDs.splice(PageNumber * 20, 20); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T22:13:22.467

使用[`slice()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/slice)而不是[`splice()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice).

`slice()`返回数组的一个切片，`splice()`就地更改数组的内容。

# iphone - 从情节提要文件/NIB 文件上的控件生成 ID 值背后的逻辑

> ID：10644214
> 
> 赞同：1
> 
> 时间：2012-05-17T22:12:17.820
> 
> 标签：iphone, ios, xcode, code-generation

我正在为 Xcode 代码创建一个代码生成器，它是界面标记

我注意到来自 UI 控件的“ID”xml 属性有一些乱码，我想知道生成此信息的逻辑是什么。

会不会只是一种苹果的方法来使创建自生成代码变得更加困难？我能否使我生成的应用程序与 my-own-whatever-IDvalue 设置一起使用？

无论如何，我正在以任何价值开发它，到目前为止它运行良好，但不确定它何时变得更复杂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T19:09:48.543

edwin，我的只是一个考试，过去曾尝试调整 .storyboard/.nib 代码，并且必须匹配这些 id，我认为唯一关键的是：

1.  id 可以包含“0-9”“AZ”“az”和破折号（'-'）

2.  它们必须是唯一的，并且不能与同一 xml 中的其他 id 冲突

3.  它们必须在声明和标识符中匹配

4.  故事板场景和控制器的 id 似乎是数字，从文件顶部开始并升序

5.  视图的 ID 似乎由 xxx-xx-xxx 形式的三元组组成

如果你坚持这一点，特别是如果你不希望调整生成的文件，你应该是安全的。即使您确实希望调整文件，Xcode 也应该尊重您生成的那些 id，只要它们是唯一的。我只是不知道如果您随后添加一个视图，该视图创建的 id 与您生成的 id 冲突。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2019-04-09T17:26:42.733

有人对如何创建这些身份有明确的答案吗？“orR-Rm-srM”似乎是一个 base-62 数字，每个数字都是 a-zA-Z0-9。我听说过身份是一个随机生成的值的评论，但我很难相信这一点，因为它在编译期间需要不必要的查找表。

汤姆

# ruby - 增加超时以避免 504 网关超时

> ID：10644217
> 
> 赞同：2
> 
> 时间：2012-05-17T22:12:45.107
> 
> 标签：ruby, apache, passenger

我已经使用乘客接管了托管在 EC2 上的这个 Rails 应用程序。1 分钟后，请求因网关超时 504 错误而停止。哪里可以增加这个。我已经增加了 apache's `/etc/http/http.conf`to be `TimeOut: 100000000`，但这不起作用。

# java - 打印arraylist元素问题

> ID：10644218
> 
> 赞同：0
> 
> 时间：2012-05-17T22:12:51.517
> 
> 标签：java, arraylist

我在使用`ArrayList`. 首先，我是 Java 新手，我正在尝试使用它`ArrayList`来存储对象，现在我想打印出所有属于`ArrayList`. 但不知何故，`List`打印不正确，有重复的项目（我确定只有一项）。这是我的代码：

```
StringBuilder description = new StringBuilder();
    for (Unit u: diary.getUnitCollection()){
        for (AssessmentItem a: u.getAssessmentCollection()){
            for (Task t: a.getTaskCollection()){
                description.append(t.toString());
            }
            description.append(a.toString());
        }
        description.append(u.toString());
    } 
```

这就是结果，如您所见，它们是重复的：

```
Java-Ass1
Java-Ass2
Java-Ass1
Java-Ass2 
```

如果我只打印 UnitCollection，它的显示正确但格式像这样 [item,..]，我想知道 for 循环中有什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:23:04.800

只能存在两种可能性：

1）您的列表包含相同的元素 - 它未设置并且有可能
2）您的一些 toString 方法调用另一个。例如 u.toString() 在其中调用 a.toString() 或 a.toString() 调用 t.toString()

# python - 创建和初始化 python 列表

> ID：10644220
> 
> 赞同：4
> 
> 时间：2012-05-17T22:13:07.603
> 
> 标签：python, list, file-io

我坚持使用python制作列表。

我想制作mxn文件，例如file00.txt、file01.txt、...和file99.txt，但是当我尝试制作时，它显示了一些错误。请让我帮忙。

```
filename = []

for i in range(0, sm):
    filename.append('') 
    for j in range(0, sn):
        filename[i].append('') 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T22:15:56.450

你可以尝试这样的事情：

```
filenames = []

for i in range(0, sm):
    row = [] 
    for j in range(0, sn):
        row.append('') # I assume you want to do something more here
    filenames.append(row) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T22:23:43.413

在 i 设置为 0 后，您将附加一个空字符串作为文件名 [0]。在该行的第二个 for 循环中

```
 filename[i].append('') 
```

这意味着你实际上打电话

```
 ''.append('') 
```

所以你的错误应该是：

```
 AttributeError: 'str' object has no attribute 'append' 
```

提示：提问时贴出错误文本，试着弄清楚错误文本对错误的描述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T22:26:42.100

```
filenames = []
for i in range(100):
    filenames.append((str(i) if len(str(i)) > 1 else str(0) + str(i)) + ".txt") 
```

最后，您的`filenames`列表中将包含 file00.txt、file01.txt、... 和 file99.txt。

```
filenames_mxn = []
for i in range(m):
    filenames_i = []
    for j in range(n):
        filenames_i.append(filenames[i*n + j])
    filenames_mxn.append(filenames_i) 
```

现在您已将文件存储在`m x n`矩阵中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T23:09:01.723

同类项目的多维列表有点没有意义。尝试简单的普通列表，它易于制作且易于使用：

```
>>> filenames = ['file' + i + j + '.txt' for i in '0123456789' for j in '0123456789']
>>> filenames
['file00.txt', 'file01.txt', 'file02.txt', ..skipped.. 'file97.txt', 'file98.txt', 'file99.txt'] 
```

# php - Wordpress - 发布状态 - 发布与草稿

> ID：10644225
> 
> 赞同：0
> 
> 时间：2012-05-17T22:13:25.580
> 
> 标签：php, wordpress, post

我已经在 wordpress 页面上实现了登录/注册的可能性。所有注册用户都注册为“订阅者”。用户可以从我实现用于创建和编辑帖子的表单的页面添加和编辑帖子（“自定义帖子类型”）。当用户输入帖子的所有必填字段（在该页面上）时，他们可以保存并发布或保存并取消发布（因此他们可以继续编辑该帖子并在准备好时发布它）。

所以，我发现自己陷入了这个问题。

*   当用户单击保存并发布按钮时，一切正常，我将 post_status 更改为“发布”，并且它的公开并且一切正常。

*   如果用户单击保存并取消发布，我将 post_status 更改为草稿！（这里我有问题）是否有可能展示这个草稿（仅限创建它的用户）。预览之类的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:46:44.303

除非你想对 WordPress 自定义功能进行长时间的修改......听起来你需要这样的东西......

这是我在某处找到的过滤器，用于从非管理员/作者的编辑帖子页面中删除帖子。当我不得不限制某些用户的功能时，我遇到了它。

```
/*
Show posts only owned by current user
*/
function posts_for_current_author($query) {
    global $pagenow;

    if( 'edit.php' != $pagenow || !$query->is_admin )
        return $query;

    if( !current_user_can( 'manage_options' ) ) {
        global $user_ID;
        $query->set('author', $user_ID );
    }
    return $query;
}
add_filter('pre_get_posts', 'posts_for_current_author'); 
```

我不记得我在哪里找到的，如果我找到源代码，我会回来编辑。

# javascript - 如何在 EmberJS 中显示/隐藏视图

> ID：10644229
> 
> 赞同：6
> 
> 时间：2012-05-17T22:13:47.460
> 
> 标签：javascript, jquery, ember.js

我希望在加载时隐藏视图，然后当用户单击链接时，它将显示视图。有人可以查看我的代码并让我知道我做错了什么吗？

```
App.parentView = Em.View.extend({   
  click: function() {
    App.childView.set('isVisible', true);
  }
});

App.childView = Em.View.extend({
  isVisible: false
}); 
```

这是jsfiddle：http: [//jsfiddle.net/stevenng/uxyrw/5/](http://jsfiddle.net/stevenng/uxyrw/5/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-29T18:56:15.043

我会`isVisibleBinding`为您想要隐藏/显示的视图创建一个简单的视图，请参阅 [http://jsfiddle.net/pangratz666/dTV6q/](http://jsfiddle.net/pangratz666/dTV6q/)：

**车把**：

```
<script type="text/x-handlebars" >
    {{#view App.ParentView}}
        <h1>Parent</h1>
        <div>
            <a href="#" {{action "toggle"}}>hide/show</a>
        </div>     
        {{#view App.ChildView isVisibleBinding="isChildVisible" }}
            {{view Em.TextArea rows="2" cols="20"}}
        {{/view}}        
    {{/view}}
</script>​ 
```

**JavaScript**：

```
App.ParentView = Em.View.extend({   
    isChildVisible: true,

    toggle: function(){
        this.toggleProperty('isChildVisible');
    }
});

App.ChildView = Ember.View.extend(); 
```

* * *

关于命名约定的注意事项：应命名类`UpperCase`和实例`lowerCase`。请参阅有关此[的博客文章](http://www.emberist.com/2012/04/09/naming-conventions.html)。

​</p>

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-11-20T07:49:02.700

由于某些原因，值绑定对我不起作用，所以观察 childView 中的 parentView 属性对我来说是诀窍

车把：

```
<script type="text/x-handlebars" >
    {{#view App.ParentView}}
        <h1>Parent</h1>
        <div>
            <a href="#" {{action "toggle"}}>hide/show</a>
        </div>     
        {{#view App.ChildView }}
            {{view Em.TextArea rows="2" cols="20"}}
        {{/view}}        
    {{/view}}
</script>​ 
```

咖啡脚本：

```
App.ParentView = Em.View.extend
  isChildVisible: true
  toggle: ->
    @toggleProperty 'isChildVisible'
App.ChildView = Em.View.extend
  isVisible: (->
    @get('parentView.isChildVisible')
  ).property '_parentView.isChildVisible' 
```

# java - Java 旋转 ImageBuffer 失败

> ID：10644231
> 
> 赞同：2
> 
> 时间：2012-05-17T22:13:53.903
> 
> 标签：java, swing, bufferedimage, graphics2d

我正在尝试旋转一个名为 pic 的 BufferImage 实例，当我尝试此操作时，它会调整大小、倾斜和裁剪图像，任何建议让它正常工作

```
public void rotate(double rads){
    AffineTransform tx = new AffineTransform();
    tx.rotate(rads,pic.getWidth()/2,pic.getHeight()/2);
    AffineTransformOp op = new AffineTransformOp(tx, AffineTransformOp.TYPE_BILINEAR);
    pic = op.filter(pic, null);
} 
```

当我让它旋转 90˚ 时它工作正常，所以我想知道问题是否出在图像的形状上？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T23:22:01.380

对于与 一起使用`AffineTransform`，您可以使用以下方法对图像进行平方：

```
private BufferedImage getImage(String name) {
    BufferedImage image;
    try {
        image = ImageIO.read(new File(name));
    } catch (IOException ioe) {
        return errorImage;
    }
    int w = image.getWidth();
    int h = image.getHeight();
    int max = Math.max(w, h);
    max = (int) Math.sqrt(2 * max * max);
    BufferedImage square = new BufferedImage(
            max, max, BufferedImage.TYPE_INT_ARGB);
    Graphics2D g2d = square.createGraphics();
    g2d.setRenderingHint(
            RenderingHints.KEY_ANTIALIASING,
            RenderingHints.VALUE_ANTIALIAS_ON);
    g2d.drawImage(image, (max - w) / 2, (max - h) / 2, null);
    g2d.dispose();
    return square;
} 
```

# android - Android：自定义视图上的膨胀异常

> ID：10644234
> 
> 赞同：2
> 
> 时间：2012-05-17T22:14:09.613
> 
> 标签：android, custom-controls, android-linearlayout, nosuchmethoderror, inflate-exception

我有一个扩展 LinearLayout 的自定义视图，具有以下构造函数：

```
public class CustomView extends LinearLayout {

public CustomView(Context context) {
    this(context, null);
}

public CustomView(Context context, AttributeSet attrs) {
    this(context, attrs, R.attr.customViewStyle);
}

public CustomView(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
    /* set custom attributes with TypedArray */
}

    /* other methods */
} 
```

在我的 /res/values/attrs.xml 中：

```
<attr name="customViewStyle" format="reference" />

<declare-styleable name="CustomeView">
    <attr name="value" format="integer" />
    <attr name="android:imeOptions" />
    <attr name="android:imeActionId" />
    <attr name="android:imeActionLabel" />
</declare-styleable> 
```

在我的 /res/values/styles.xml 中：

```
<style name="AppTheme" parent="@android:style/Theme.Black">
    <item name="android:windowBackground">@drawable/bg_dark_fiber</item>
    <item name="customViewStyle">@style/CustomViewStyle</item>
</style>

<style name="CustomViewStyle">
    <item name="android:clickable">true</item>
    <item name="android:focusable">true</item>
    <item name="android:focusableInTouchMode">true</item>
</style> 
```

AppTheme 设置为整个应用程序的主题。期望的结果是我的自定义视图默认是可聚焦和可点击的，而无需在我的布局文件中添加这些属性（而常规的 LinearLayout 不是）。当我运行该应用程序时，它会因以下堆栈跟踪而崩溃：

```
05-17 14:58:53.010: E/ActivityThread(26767): Failed to inflate
05-17 14:58:53.010: E/ActivityThread(26767): android.view.InflateException: Binary XML file line #8: Error inflating class com.example.customviews.CustomView
05-17 14:58:53.010: E/ActivityThread(26767):    at android.view.LayoutInflater.createView(LayoutInflater.java:518)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:570)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.view.LayoutInflater.rInflate(LayoutInflater.java:623)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.view.LayoutInflater.inflate(LayoutInflater.java:408)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
05-17 14:58:53.010: E/ActivityThread(26767):    at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:212)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.app.Activity.setContentView(Activity.java:1657)
05-17 14:58:53.010: E/ActivityThread(26767):    at com.example.pincode.PinCodeActivity.onCreate(PinCodeActivity.java:26)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1722)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1784)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.app.ActivityThread.access$1500(ActivityThread.java:123)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:939)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.os.Handler.dispatchMessage(Handler.java:99)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.os.Looper.loop(Looper.java:130)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.app.ActivityThread.main(ActivityThread.java:3835)
05-17 14:58:53.010: E/ActivityThread(26767):    at java.lang.reflect.Method.invokeNative(Native Method)
05-17 14:58:53.010: E/ActivityThread(26767):    at java.lang.reflect.Method.invoke(Method.java:507)
05-17 14:58:53.010: E/ActivityThread(26767):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:847)
05-17 14:58:53.010: E/ActivityThread(26767):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:605)
05-17 14:58:53.010: E/ActivityThread(26767):    at dalvik.system.NativeStart.main(Native Method)
05-17 14:58:53.010: E/ActivityThread(26767): Caused by: java.lang.reflect.InvocationTargetException
05-17 14:58:53.010: E/ActivityThread(26767):    at java.lang.reflect.Constructor.constructNative(Native Method)
05-17 14:58:53.010: E/ActivityThread(26767):    at java.lang.reflect.Constructor.newInstance(Constructor.java:415)
05-17 14:58:53.010: E/ActivityThread(26767):    at android.view.LayoutInflater.createView(LayoutInflater.java:505)
05-17 14:58:53.010: E/ActivityThread(26767):    ... 21 more
05-17 14:58:53.010: E/ActivityThread(26767): Caused by: java.lang.NoSuchMethodError: android.widget.LinearLayout.<init>
05-17 14:58:53.010: E/ActivityThread(26767):    at com.example.customviews.CustomView.<init>(CustomView.java:98)
05-17 14:58:53.010: E/ActivityThread(26767):    at com.example.customviews.CustomView.<init>(CustomView.java:94)
05-17 14:58:53.010: E/ActivityThread(26767):    ... 24 more 
```

我不明白是什么导致了 InflateException 的调用`super(context, attrs, defStyle)`。我也尝试过`super(context, attrs, 0)`，但这并没有帮助，这真的很奇怪，因为即使是 LinearLayout 也使用它，就像我检查过源代码的大多数其他视图一样。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-22T17:40:32.837

I found this answer on the Android Developers Google Group:

> The three-argument version of LinearLayout constructor is only available with API 11 and higher -- i.e. Android 3.0.
> 
> This dependency has to be satisfied at runtime by the actual Android version running on the device.

I was testing on a handset running Gingerbread (2.3.3). Sure enough, when I ran the program on an emulator with ICS (4.0.3), it worked fine. Still hunting for a workaround so I can use my code on pre-Honeycomb.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T22:52:35.773

您的构造函数正在调用`this`而不是`super`. 如果你改变它，那么它将起作用。

我刚刚用构造函数扩展了线性布局来测试它是否有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-04T10:50:02.453

我在自定义 LinearLayout 时也遇到了这个问题。我所做的是调用`super`而不是`this`在构造函数中，并在单独的方法中设置属性。

```
public class CustomView extends LinearLayout {

public CustomView(Context context) {
    super(context);
}

public CustomView(Context context, AttributeSet attrs) {
    super(context, attrs);
}

public CustomView(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
    setAttributes(attrs);
}

private void setAttributes(AttributeSet attrs) {
    /* set custom attributes with TypedArray */
}
    /* other methods */
} 
```

# webgl - 将夜灯添加到 WebGL / Three.js 地球

> ID：10644236
> 
> 赞同：4
> 
> 时间：2012-05-17T22:14:14.857
> 
> 标签：webgl, three.js

我正在使用 Three.js 作为开发空间模拟器的框架，我正在尝试，但未能让夜灯工作。

模拟器可以在这里访问：

[orbitingeden.com](http://orbitingeden.com)

并且可以在此处找到运行以下代码段的页面：

[orbitingeden.com/orrery/soloearth.html](http://orbitingeden.com/orrery/soloearth.html)

示例页面的代码在这里。我什至不知道从哪里开始。我尝试渲染两个相隔几个单位的球体，一个靠近太阳（白天版本），一个更靠近太阳（夜间版本），但有很多问题，其中最重要的是它们开始以奇怪的十二面体形式相互重叠方法。我从这个[orrery](http://www.esfandiarmaghsoudi.com/Apps/SolarSystem/)中采用了 tDiffuse2 的想法，但无法让它工作。

```
<!doctype html>
<html lang="en">
    <head>
        <title>three.js webgl - earth</title>
        <meta charset="utf-8">
        <script src="three.js/Detector.js"></script>
        <script src="three.js/Three.js"></script>
    </head>
    <body>
        <script>
            if ( ! Detector.webgl ) Detector.addGetWebGLMessage();

            var radius = 6371;
            var tilt = 0.41;
            var rotationSpeed = 0.02;
            var cloudsScale = 1.005;
            var SCREEN_HEIGHT = window.innerHeight;
            var SCREEN_WIDTH  = window.innerWidth;
            var container, camera, scene, renderer;
            var meshPlanet, meshClouds, dirLight, ambientLight;
            var clock = new THREE.Clock();

            init();
            animate();

            function init() {
                container = document.createElement( 'div' );
                document.body.appendChild( container );

                scene = new THREE.Scene();
                scene.fog = new THREE.FogExp2( 0x000000, 0.00000025 );

                camera = new THREE.PerspectiveCamera( 25, SCREEN_WIDTH / SCREEN_HEIGHT, 50, 1e7 );
                camera.position.z = radius * 5;
                scene.add( camera );

                dirLight = new THREE.DirectionalLight( 0xffffff );
                dirLight.position.set( -20, 0, 2 ).normalize();
                scene.add( dirLight );

                ambientLight = new THREE.AmbientLight( 0x000000 );
                scene.add( ambientLight );

                //initialize the earth
                var planetTexture = THREE.ImageUtils.loadTexture( "textures/earth-day.jpg" ),
                nightTexture      = THREE.ImageUtils.loadTexture( "textures/earthNight.gif" ),
                cloudsTexture     = THREE.ImageUtils.loadTexture( "textures/clouds.gif" ),
                normalTexture     = THREE.ImageUtils.loadTexture( "textures/earth-map.jpg" ),
                specularTexture   = THREE.ImageUtils.loadTexture( "textures/earth-specular.jpg" );
                var shader = THREE.ShaderUtils.lib[ "normal" ];
                var uniforms = THREE.UniformsUtils.clone( shader.uniforms );
                uniforms[ "tNormal" ].texture = normalTexture;
                uniforms[ "uNormalScale" ].value = 0.85;
                uniforms[ "tDiffuse" ].texture = planetTexture;
                uniforms[ "tDiffuse2" ].texture = nightTexture;
                uniforms[ "tSpecular" ].texture = specularTexture;
                uniforms[ "enableAO" ].value = false;
                uniforms[ "enableDiffuse" ].value = true;
                uniforms[ "enableSpecular" ].value = true;
                uniforms[ "uDiffuseColor" ].value.setHex( 0xffffff );
                uniforms[ "uSpecularColor" ].value.setHex( 0x333333 );
                uniforms[ "uAmbientColor" ].value.setHex( 0x000000 );
                uniforms[ "uShininess" ].value = 15;
                var parameters = {
                    fragmentShader: shader.fragmentShader,
                    vertexShader: shader.vertexShader,
                    uniforms: uniforms,
                    lights: true,
                    fog: true
                };
                var materialNormalMap = new THREE.ShaderMaterial( parameters );
                geometry = new THREE.SphereGeometry( radius, 100, 50 );
                geometry.computeTangents();
                meshPlanet = new THREE.Mesh( geometry, materialNormalMap );
                meshPlanet.rotation.y = 0;
                meshPlanet.rotation.z = tilt;
                scene.add( meshPlanet );

                // clouds
                var materialClouds = new THREE.MeshLambertMaterial( { color: 0xffffff, map: cloudsTexture, transparent: true } );
                meshClouds = new THREE.Mesh( geometry, materialClouds );
                meshClouds.scale.set( cloudsScale, cloudsScale, cloudsScale );
                meshClouds.rotation.z = tilt;
                scene.add( meshClouds );

                renderer = new THREE.WebGLRenderer( { clearColor: 0x000000, clearAlpha: 1 } );
                renderer.setSize( SCREEN_WIDTH, SCREEN_HEIGHT );
                renderer.sortObjects = false;
                renderer.autoClear = false;
                container.appendChild( renderer.domElement );
            };

            function animate() {
                requestAnimationFrame( animate );
                render();
            };

            function render() {
                // rotate the planet and clouds
                var delta = clock.getDelta();
                meshPlanet.rotation.y += rotationSpeed * delta;
                meshClouds.rotation.y += 1.25 * rotationSpeed * delta;
                //render the scene
                renderer.clear();
                renderer.render( scene, camera );
            };
        </script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-18T04:16:35.310

如果我明白你的问题......

我不知道three.js，但一般来说，我会通过让一个已经通过白天和夜间纹理的着色器然后在着色器中选择一个或另一个来做到这一点。例如

```
uniform sampler2D dayTexture;
uniform sampler2D nightTexture;
varying vec3 v_surfaceToLight;  // assumes this gets passed in from vertex shader
varying vec4 v_normal;          // assumes this gets passed in from vertex shader
varying vec2 v_texCoord;        // assumes this gets passed in from vertex shader

void main () {
   vec3 normal = normalize(v_normal);
   vec3 surfaceToLight = normalize(v_surfaceToLight);
   float angle = dot(normal, surfaceToLight);
   vec4 dayColor = texture2D(dayTexture, v_texCoords);
   vec4 nightColor = texture2D(nightTexture, v_texCoord);
   vec4 color = angle < 0.0 ? dayColor : nightColor;

   ...

   gl_FragColor = color * ...;
} 
```

基本上，您进行照明计算，而不是将其用于照明，而是使用它来选择纹理。光照计算通常使用表面法线与来自表面的光（太阳）方向之间的点积。这为您提供了这些与向量之间夹角的余弦值。余弦从 -1 到 1，所以如果值从 -1 到 0，则它背向太阳，如果它是 0 到 +1，则它面向太阳。

线

```
 vec4 color = angle < 0.0 ? dayColor : nightColor; 
```

选择白天或夜晚。这将是一个严厉的截止日期。你可能会尝试一些更模糊的东西，比如

```
 // convert from -1 <-> +1 to 0 <-> +1
   float lerp0To1 = angle * 0.5 + 0.5; 

   // mix between night and day
   vec4 color = mix(nightColor, dayColor, lerp0to1); 
```

这将使您 100% 白天在直接面对太阳的地方，而 100% 晚上在直接面对太阳的地方，以及两者之间的混合。可能不是你想要的，但你可以对数字大发雷霆。例如

```
 // sharpen the mix
   angle = clamp(angle * 10.0, -1.0, 1.0);

   // convert from -1 <-> +1 to 0 <-> +1
   float lerp0To1 = angle * 0.5 + 0.5; 

   // mix between night and day
   vec4 color = mix(nightColor, dayColor, lerp0to1); 
```

希望这是有道理的。

* * *

所以我花了一点时间编写了一个 Three.js 的例子，部分是为了学习 Three.js。样品在这里。

```
const vs = `
varying vec2 vUv;
varying vec3 vNormal;

void main() {
  vUv = uv;
  vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
  vNormal = normalMatrix * normal;
  gl_Position = projectionMatrix * mvPosition;
}
`;

const fs = `
uniform sampler2D dayTexture;
uniform sampler2D nightTexture;

uniform vec3 sunDirection;

varying vec2 vUv;
varying vec3 vNormal;

void main( void ) {
  vec3 dayColor = texture2D( dayTexture, vUv ).rgb;
  vec3 nightColor = texture2D( nightTexture, vUv ).rgb;

  // compute cosine sun to normal so -1 is away from sun and +1 is toward sun.
  float cosineAngleSunToNormal = dot(normalize(vNormal), sunDirection);

  // sharpen the edge beween the transition
  cosineAngleSunToNormal = clamp( cosineAngleSunToNormal * 10.0, -1.0, 1.0);

  // convert to 0 to 1 for mixing
  float mixAmount = cosineAngleSunToNormal * 0.5 + 0.5;

  // Select day or night texture based on mix.
  vec3 color = mix( nightColor, dayColor, mixAmount );

  gl_FragColor = vec4( color, 1.0 );
}

`;

const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(40, 1, 1, 3000);
camera.position.z = 4;
scene.add( camera );

const directionalLight = new THREE.DirectionalLight( 0xaaff33, 0 );
directionalLight.position.set(-1, 1, 0.5).normalize();
scene.add( directionalLight );

const textureLoader = new THREE.TextureLoader();

const uniforms = {
  sunDirection: {value: new THREE.Vector3(0,1,0) },
  dayTexture: { value: textureLoader.load( "https://i.imgur.com/dfLCd19.jpg" ) },
  nightTexture: { value: textureLoader.load( "https://i.imgur.com/MeKgLts.jpg" ) }
};

const material = new THREE.ShaderMaterial({
  uniforms: uniforms,
  vertexShader: vs,
  fragmentShader: fs,
});

const mesh = new THREE.Mesh( new THREE.SphereGeometry( 0.75, 32, 16 ), material );
scene.add( mesh );

renderer = new THREE.WebGLRenderer();
document.body.appendChild(renderer.domElement);
resize(true);
requestAnimationFrame(render);

function resize(force) {
  const canvas = renderer.domElement;
  const width = canvas.clientWidth;
  const height = canvas.clientHeight;
  if (force || canvas.width !== width || canvas.height !== height) {
    renderer.setSize(width, height, false);
    camera.aspect = width / height;
    camera.updateProjectionMatrix();
  }
}

function render(time) {
  time *= 0.001;  // seconds

  resize();

  uniforms.sunDirection.value.x = Math.sin(time);
  uniforms.sunDirection.value.y = Math.cos(time);

  // Note: Since the earth is at 0,0,0 you can set the normal for the sun
  // with
  //
  // uniforms.sunDirection.value.copy(sunPosition);
  // uniforms.sunDirection.value.normalize();

  mesh.rotation.y = time * .3
  mesh.rotation.x = time * .7;

  renderer.render(scene, camera);

  requestAnimationFrame(render);
}
```

```
body { margin: 0; }
canvas { width: 100vw; height: 100vh; display: block; }
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/87/three.min.js"></script>
```

我使用的着色器是这个

```
uniform sampler2D dayTexture;
uniform sampler2D nightTexture;

uniform vec3 sunDirection;

varying vec2 vUv;
varying vec3 vNormal;

void main( void ) {
    vec3 dayColor = texture2D( dayTexture, vUv ).rgb;
    vec3 nightColor = texture2D( nightTexture, vUv ).rgb;

    // compute cosine sun to normal so -1 is away from sun and +1 is toward sun.
    float cosineAngleSunToNormal = dot(normalize(vNormal), sunDirection);

    // sharpen the edge beween the transition
    cosineAngleSunToNormal = clamp( cosineAngleSunToNormal * 10.0, -1.0, 1.0);

    // convert to 0 to 1 for mixing
    float mixAmount = cosineAngleSunToNormal * 0.5 + 0.5;

    // Select day or night texture based on mixAmount.
    vec3 color = mix( nightColor, dayColor, mixAmount );

    gl_FragColor = vec4( color, 1.0 );

    // comment in the next line to see the mixAmount
    //gl_FragColor = vec4( mixAmount, mixAmount, mixAmount, 1.0 );
} 
```

与上述最大的区别在于，由于太阳通常被认为是定向光，因为它是如此遥远，那么您所需要的只是它的方向。换句话说，它相对于地球指向哪个方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-15T16:39:13.980

感谢您的分享 - 非常有用。虽然我现在确定为什么当相机旋转时阴影不会背向太阳（它相对于相机保持静止）。这是我用来设置 sunDirection 统一的代码：

this.uniforms.sunDirection.value.copy(this.sunPosition); this.uniforms.sunDirection.value.normalize();

不知道为什么...

# jquery - 更好的 jQuery 插件编码

> ID：10644239
> 
> 赞同：0
> 
> 时间：2012-05-17T22:14:40.720
> 
> 标签：jquery, jquery-plugins, plugins, performance

我正在开始一个插件，它将是一个“大”插件，有很多代码......

你们建议我做什么？

方法一

```
 $.Config = { myValue : 'My Value 1' }
    $.Test_1 = function(){ }
    $.Test_1.myFunction = function()
    {
        alert('My Function 1');
    }
    $.Test_1.access = function()
    {
        alert( $.Config.myValue );
    }
    $.Test_1.access(); 
```

方法2（我更喜欢）

```
 $.Test_2 = {
        Config : {
            myValue : 'My Value 2'
        } ,

        myFunction : function()
        {
            alert('My Function 2');
        } ,

        access : function()
        {
            alert( this.Config.myValue );
        }
    }
    $.Test_2.access(); 
```

我更喜欢第二种方法，它更干净，更好理解，但我不知道它是否更有效..

该插件适用于 Zopim 和类似的聊天应用程序，它可以与 Pusher.com 一起使用，并且可以使用各种语言等......我希望它易于设置，这就是我拥有 $.Config 和 Config 的原因那里的变量...

请各位大侠对此有什么看法，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:37:36.800

如果我是你，我会问自己这些问题：

*   我的插件可以实例化吗？如果有人使用我的插件，他会在一页中多次使用它吗？
*   我的插件会使用像 $(element).myplugin() 这样的元素来启动，还是会像 $.myplugin() 那样被调用，或者两者兼而有之？
*   我的插件将如何处理静态 DOM 和它创建的 DOM 上的事件？
*   有人可以将功​​能后期绑定到我的插件事件吗？喜欢：

    `$(element).bind("onmypluginevent",function()...`

您要使用的方法可能会根据上述问题而有所不同。在开始编码之前，找到最适合您目标的方法。

您可能想搜索**jquery 插件样板**以查找人们如何做到这一点的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T22:25:24.343

方法 2 更具可读性、嵌套性、更简洁，并且[根据测试](http://jsperf.com/aaasd)- 速度提高了 92%。
但是您应该阅读有关如何以正确方式进行操作的[jQuery 文档。](http://docs.jquery.com/Plugins/Authoring)

# php - 获取包含变量的 $_POST 变量

> ID：10644242
> 
> 赞同：0
> 
> 时间：2012-05-17T22:14:49.680
> 
> 标签：php, post

```
<?php

$var = "arbitrary";

echo <<<_END

<form method = "post" action = "feed.php">

    <input type = "text" name = "$var" />
    <input type = "submit" />

</form>

_END;

if (isset($_POST['$var']))
{
    echo $_POST['$var'];
}

?> 
```

当我尝试从变量 $var 中检索此 $_POST 数据时，我似乎无法获得它。这可能吗？（从字符串以外的东西获取 $_POST）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-17T22:17:31.530

`$_POST['$var']`应该`$_POST[$var]`也就是不要将你的变量用单引号括起来

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-17T22:17:37.660

试试这个：

```
<?php

$var = "arbitrary";

?>

<form method = "post" action = "feed.php">

    <input type = "text" name = "<?php echo $var ?>" />
    <input type = "submit" />

</form>

<?php

if (isset($_POST[$var]))
{
    echo $_POST[$var];
}

?> 
```

正如其他人提到的那样，问题只是`$var`您的数组语法中的引用。`$_POST['$var']`您的heredoc 语法没有任何问题，因此如果您对HERDOC 语法感觉更舒服，您应该继续使用它。

# silverlight - 在子控件中触发 sizechanged 事件 - silverlight

> ID：10644243
> 
> 赞同：1
> 
> 时间：2012-05-17T22:15:05.180
> 
> 标签：silverlight

我有一个自定义 Silverlight 控件 (control1)，其中有另一个自定义控件 (control2)。此 control2 是动态添加的，而不是在 xaml 中。

当我调整 control1 的大小时，它不会自动调整 control2 的大小。所以，我试图找到一种解决方法，但不确定如何。如果 control2 不是动态添加的，我可以在 control1.size_changed() 事件中手动调整它的大小。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T06:40:43.500

创建 control2 时将布尔变量设置为 true。在调整 control1 的大小时，您可以使用该变量检查 control2 是否存在，如下所示：

```
bool blnControl2Set = true;

//resize event of control1
void resize()
{
  if(blnControl2Set)
  {
     //call event handler of control2 resize
  }
} 
```

我想这就是你想要的。如果还有任何疑问，请告诉我。

# c# - 使用 C# 选择 oracle 日期列

> ID：10644246
> 
> 赞同：3
> 
> 时间：2012-05-17T22:15:16.603
> 
> 标签：c#, sql, oracle, date

我正在尝试使用 C# 从我的 Oracle 数据库 BY DATE 中选择数据。但是我总是得到一个空数据集，尽管相同的查询字符串在 Oracle SQL Developer 中工作得很好

```
String Query = "Select position_date from position";
OracleDataAdapter adapter = new OracleDataAdapter(Query, ocon); 
adapter.Fill(ds, "table"); //where ds is a dataset 
PrintDataSet(ds); 
```

返回

```
3/8/2011 12:00:00 AM.... and more 
```

但是，当我将查询更改为以下时，就没有输出了！

```
String Query = "Select position_date from position 
where to_char(position_date, 'mm-dd-yyyy') = '05-17-2012'" 
```

此查询在 oracle sql developer 中运行良好。我也尝试过 trunc(sysdate) 但似乎没有任何效果！:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T13:11:20.453

```
select * from position where trunc(position_date) = to_date('05-17-2012', 'mm-dd-yyyy') 
```

工作。

谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T08:05:23.900

如果您的日期没有时间部分（如果是这样，那么用检查约束来保证它），那么：

```
Select position_date
from   position 
where  position_date = date '2012-05-17' 
```

否则：

```
Select position_date
from   position 
where  position_date >= date '2012-05-17' and 
       position_date <  date '2012-05-17' + 1 
```

# mysql - 存储公司-分支机构-员工的数据库结构

> ID：10644250
> 
> 赞同：1
> 
> 时间：2012-05-17T22:15:40.070
> 
> 标签：mysql, database-design

我想将此信息存储在数据库中：

```
Company
   |
   |-- Dept 1--,
   |            \->Employee 1
   |             |->Employee 2
   |
   |-- Dept 2--,
   |            \->Employee 3
   |
   |-> Employee 4
   \-> Employee 5 
```

我已经做到了这一点：我需要一个员工表，部门和公司项目是一样的，所以它们应该在同一个表中......

```
employee // id | information...
branch  //  id | information.... 
```

每个员工都应该链接到一个分支机构。每个分支都可以连接到另一个分支......

```
employeeBranch // employee.id | branch.id | enum(current, historical)
branchBranch   // branch.id   | branch.id 
```

这使得可以有多个级别的分支......

但我怀疑这是否是这样做*的方法..*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T22:22:45.643

如果员工只能属于一个分支，并且分支只能是一个分支的子级，那么您可以考虑添加一列来表示此信息，而不是全新的表：

```
employee // id | branchId | information
branch   // id | parentBranchId | information 
```

如果您与员工/分支机构和分支机构/分支机构有多对多的关系，那么我认为您的原始结构很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-17T22:22:59.547

不，它们根本不应该在同一张桌子上。

我看到三个表：Employee、Company 和 Department。

假设您仅对当前就业进行建模，则一名员工只能属于一家公司。（一次一份工作 - 没有兼职。）公司可以有一个或多个员工，所以员工有公司的外键。

一个公司可以有多个部门，但一个部门只能属于一个公司。所以部门将有一个公司的外键。

建模分支只是稍微复杂一些。如果一个部门是另一个部门的下属，我会给部门一个外键。顶级部门将具有其他部门的空外键，因为它是顶级部门。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T22:24:46.947

最好的方法是对你所说的更友好，让每一方都有自己的表格，里面有他的信息。然后制作一个关系表。

```
table `branches`

Branch ID           Branch Name         Branch Location
---------------------------------------------------------------
    2                   sd                  west
    1                   no name             east

table `employee`

employee ID         employee name           employee birth
---------------------------------------------------------------
    1                   name                    2/2/1975

table `employee_branches`

employee ID     Branch ID
--------------------------
    1               2
    1               1 
```

# mysql - MySQL long_query_time 值

> ID：10644253
> 
> 赞同：1
> 
> 时间：2012-05-17T22:16:16.540
> 
> 标签：mysql, debugging, optimization, logging

我正在调试一个 MySQL 5.1.61 数据库，我`long_query_time`在`my.cnf`文件中设置为 10。慢查询被记录到数据库表中。

但是，它记录的查询只需要几分之一秒。

事实上，我的查询记录非常快，`query_time`mysql 中的字段为每个记录的查询显示“00:00:00”。即使我让他们记录到文件，他们也显示查询时间在“Query_time：0.004763”范围内

我知道我的配置文件正在被读取，因为我的所有其他更改都已生效。

从我读过的所有文档中，`long_query_time`应该是几秒钟。我还需要做些什么才能使该设置保持不变吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:34:54.873

这些查询有索引吗？如果不是，那么这可能就是他们被记录的原因。

> 在 MySQL 4.1 之前，如果您在记录慢速查询时还使用 --log-long-format，那么也会记录不使用索引的查询。从 MySQL 4.1 开始，使用 --log-queries-not-using-indexes 选项启用不使用索引进行行查找的查询日志记录。从 MySQL 4.1 开始不推荐使用 --log-long-format，当引入 --log-short-format 时，这会导致记录的信息更少。（长日志格式是 4.1 版以来的默认设置。）[(>>)](http://dev.mysql.com/doc/refman/4.1/en/slow-query-log.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-28T07:23:21.357

我相信你只是在编辑'my.cnf'文件后忘记重新启动你的Mysql？

```
sudo /etc/init.d/mysqld restart 
```

或者

```
sudo service mysql restart 
```

# sql - 执行 SQL Server 查询的问题

> ID：10644257
> 
> 赞同：1
> 
> 时间：2012-05-17T22:17:13.860
> 
> 标签：sql, sql-server-2008

我正在尝试运行以下查询：

```
SELECT  
  A.STEPNAME, 
  A.BRDATE BRDATE_A, 
  B.BRDATE BRDATE_B, 
  MIN(A.STARTTIME) STARTTIME_A, 
  MAX(A.ENDTIME) ENDTIME_A, 
  MIN(B.STARTTIME) STARTTIME_B, 
  MAX(B.ENDTIME) ENDTIME_B, 
  'RUNTIME_A' = convert(VARCHAR,DATEDIFF(MINUTE,A.STARTTIME,A.ENDTIME),108) ,
  'RUNTIME_B' = convert(VARCHAR,DATEDIFF(MINUTE,B.STARTTIME,B.ENDTIME),108) 
FROM 
  CB_OPX_AUDIT_HIST A, 
  CB_OPX_AUDIT_HIST B
WHERE  
  A.BRDATE = ('05/11/2012') 
AND 
  B.BRDATE = ('05/16/2012') 
AND 
  A.BR = '03'
AND 
  A.STEPNAME=B.STEPNAME
AND 
  A.BR=B.BR
GROUP BY 
  A.STEPNAME, 
  A.ENDTIME, 
  A.STARTTIME,
  A.BRDATE,
  B.BRDATE,
  B.ENDTIME, 
  B.STARTTIME
ORDER BY  
  A.STARTTIME 
```

我需要'RUNTIME_A'和'RUNTIME_B'之间的区别..

有人可以告诉我如何在上述查询中得到区别。？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T22:20:58.937

将您的整个查询包装在另一个`SELECT`语句中。在外部 select 语句中，您可以简单地 select `RUNTIME_A - RUNTIME_B`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T22:22:08.000

你到底是什么意思“得到差异”？

你已经在几分钟内得到了差异，它总是少于一天吗？

这对你有什么作用？

```
DATEADD(
  minute,
  DATEDIFF(minute, A.STARTTIME, A.ENDTIME)
  -
  DATEDIFF(minute, B.STARTTIME, B.ENDTIME),
  0
) 
```

或者...

```
CONVERT(
  VARCHAR(8),
  DATEADD(
    minute,
    DATEDIFF(minute, A.STARTTIME, A.ENDTIME)
    -
    DATEDIFF(minute, B.STARTTIME, B.ENDTIME),
    0
  ),
  108
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T22:23:26.620

为简单起见，我建议从使用 VARCHAR 更改为使用 DATETIME 并再次运行简单的 datediff

```
DATEDIFF(MINUTE, 
    convert(DATETIME,DATEDIFF(MINUTE,A.STARTTIME,A.ENDTIME),108), 
    convert(DATETIME,DATEDIFF(MINUTE,B.STARTTIME,B.ENDTIME),108)
) 
```

您可以将原始查询包装为子查询以简化操作。

# android - Android：替换复合布局中的片段

> ID：10644258
> 
> 赞同：0
> 
> 时间：2012-05-17T22:17:24.483
> 
> 标签：android, replace, fragment

我正在尝试替换复合布局中的片段。这是我的根布局 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <fragment
        android:id="@+id/buttons"
        android:name="com.kippygo.android.touch_talker.ButtonsFragment"
        android:layout_width="200dp"
        android:layout_height="match_parent"
        class="com.kippygo.android.touch_talker.ButtonsFragment" >
        <!-- Preview: layout=@layout/buttons_fragment -->
    </fragment>

    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <fragment
        android:id="@+id/buffer"
        android:name="com.kippygo.android.touch_talker.BufferFragment"
        android:layout_width="match_parent"
        android:layout_height="80dp" >

        <!-- Preview: layout=@layout/buffer_fragment -->
    </fragment>

    <FrameLayout
        android:id="@+id/grid_frame"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="?android:attr/detailsElementBackground" >

    </FrameLayout>

</LinearLayout> 

</LinearLayout> 
```

正如你所看到的，我的布局中有三个区域，一个固定的左列包含一个带有按钮的片段，布局的其余部分垂直划分，一个片段在顶部管理 textView，在下部有一个数据网格。

当我按下“按钮”片段中的按钮时，我想使用通用布局将各种 GridView 元素放置在“grid_frame”中。这是我要用于每个 GridView 片段的“grid_fragment”布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:id="@+id/grid_fragment_layout"
    xmlns:android="http://schemas.android.com/apk/res/android" 
    android:orientation="vertical">

<GridView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/grid_view"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:columnWidth="80dp"
    android:clipToPadding="true"
    android:gravity="center"
    android:horizontalSpacing="20dp"
    android:numColumns="auto_fit"
    android:orientation="vertical"
    android:stretchMode="columnWidth"
    android:verticalSpacing="20dp" >
    <!-- Preview: listitem=@android:layout/simple_list_item_2 -->
</GridView>

<TextView
    android:id="@+id/android:empty"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:textSize="22sp"
    android:textStyle="bold"
    android:text="@string/no_list_items"/>

</LinearLayout> 
```

当我启动我的应用程序时，这个复合布局打开得很好。我在我的初始活动中使用以下代码在 FrameLayout id“grid_frame”中设置了我的第一个片段：

```
 // Execute a transaction to put the categoriesFragment in the grid_view
    FragmentTransaction ft = getFragmentManager().beginTransaction();
    ft.replace(R.id.grid_frame, new CategoriesFragment(), "category_fragment");
    ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
    ft.commit(); 
```

这工作得非常好，我看到左侧的按钮，顶部的文本输入框和按钮右侧的填充良好的单元格网格。

当我单击动态片段呈现的 GridView 中的列表项之一时，我想替换“grid_frame”FrameLayout 中的片段。我使用以下代码在“grid_frame”片段的 onItemClick 侦听器方法中使用以下代码执行此操作：

```
 // Execute a transaction to put the categoriesFragment in the grid_view
    FragmentTransaction ft = getFragmentManager().beginTransaction();
    ft.replace(R.id.grid_frame, categoryWordsFragment, "category_words_fragment");
    ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
    ft.commit(); 
```

这看起来与我在活动中用于设置工作正常的初始片段的代码非常相似。

当我这样做时，我的整个屏幕被替换为新的片段布局，这是另一个具有不同数据的 GridView。`replace`即使我在方法调用中将“grid_frame”FrameLayout 指定为容器视图 id，我的根布局似乎也完全被新片段膨胀的布局所取代。

我已经尝试了我能找到的一切来使我的布局保持不变，只需更改 FrameLayout 容器中的片段。

请问我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T18:15:32.207

问题解决了！这是一个非常愚蠢的错误。我已将我的 Activity 类转换为 Fragment 类，在这一类中，我忘记删除类 onCreate 方法中对 setContentView 的调用。所以每次我创建一个新实例时，片段都会设置一个新的布局

# view - 如何将对话框视图控制器作为子视图添加到 UIView 或反之亦然？

> ID：10644260
> 
> 赞同：4
> 
> 时间：2012-05-17T22:17:30.240
> 
> 标签：view, dialog, controller, xamarin.ios, subview

我在网上浏览了一段时间，寻找有关此主题的任何资源，但没有找到任何可以解决我困境的方法。

我有一个对话框视图控制器，它的根只是显示一个字符串列表，类似于 iphone 音乐歌曲可滚动视图的布局方式。我需要的是位于屏幕顶部的子视图和下方的可滚动 DVC。当用户可以滚动浏览根元素时，我需要始终显示顶视图，因为顶视图将保存统计信息。

我尝试添加一个子视图，但它只是与它下面的 dvc 重叠，而且我还没有找到一种方法将 dvc 作为子视图添加到 UIView。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-21T03:01:13.210

实现这一点需要一个承载两个子视图控制器的单个根视图控制器。一个子视图包含窗口顶部的统计信息。底部子视图包含一个保存对话框视图的导航控制器。

```
using System;
using System.Collections.Generic;
using System.Linq;

using MonoTouch.Foundation;
using MonoTouch.UIKit;
using MonoTouch.Dialog;
using System.Drawing;

namespace delete201205203
{
    [Register ("AppDelegate")]
    public partial class AppDelegate : UIApplicationDelegate
    {
        UIWindow window;
        MyUIViewController _mvc;

        public override bool FinishedLaunching (UIApplication app, NSDictionary options)
        {
            window = new UIWindow (UIScreen.MainScreen.Bounds);

            _mvc = new MyUIViewController ();

            window.RootViewController = _mvc;
            window.MakeKeyAndVisible ();

            return true;
        }
    }

    public class MyUIViewController : UIViewController
    {
        MyDialogViewController _dvc;
        UINavigationController _nav;
        StatisticsViewController _statistics;

        public override void ViewDidLoad ()
        {
            base.ViewDidLoad ();

            var root = new RootElement ("Root") {
                new Section ("Section") {
                    new EntryElement ("caption", "placeholder", ""),
                    new RootElement ("Root 2") {
                        new Section ("Section") {
                            new EntryElement ("caption", "placeholder", ""),
                            new StringElement ("Back", () => {
                                _nav.PopViewControllerAnimated (true);  
                            })
                        }
                    }
                }
            };

            _dvc = new MyDialogViewController (root);
            _nav = new UINavigationController (_dvc);
            _nav.SetNavigationBarHidden (true, false);
            _nav.View.Frame = new RectangleF (0, 70f,
                                              this.View.Bounds.Width, 
                                              this.View.Bounds.Height -70f);

            _statistics = new StatisticsViewController ();
            _statistics.View.Frame = new RectangleF (0, 0,
                                              this.View.Bounds.Width, 
                                              70f);

            this.AddChildViewController (_nav);
            this.View.AddSubview (_nav.View);

            this.AddChildViewController (_statistics);
            this.View.AddSubview (_statistics.View);
        }

        public override void ViewWillLayoutSubviews ()
        {
            base.ViewWillLayoutSubviews ();
            _nav.View.Frame = new RectangleF (0, 70f,
                                              this.View.Bounds.Width, 
                                              this.View.Bounds.Height -70f);

            _statistics.View.Frame = new RectangleF (0, 0,
                                              this.View.Bounds.Width, 
                                              70f);
        }

        public override bool ShouldAutorotateToInterfaceOrientation (UIInterfaceOrientation toInterfaceOrientation)
        {
            return true;
        }
    }

    public class StatisticsViewController : UIViewController
    {
        UILabel _label;
        public override void ViewDidLoad ()
        {
            base.ViewDidLoad ();
            this.View.BackgroundColor = UIColor.White;

            _label = new UILabel (new RectangleF (this.View.Bounds.Width * .5f - 50f,
                                                  this.View.Bounds.Height * .5f -10f,
                                                  100f, 20f));
            _label.AutoresizingMask = UIViewAutoresizing.FlexibleMargins;

            _label.Text = "statistics";
            this.View.AddSubview (_label);

        }

        public override bool ShouldAutorotateToInterfaceOrientation (UIInterfaceOrientation toInterfaceOrientation)
        {
            return true;
        }
    }

    // This overrde is needed to ensure the pop view animation  
    // works correctly in landscape mode
    public class MyDialogViewController : DialogViewController
    {
        public MyDialogViewController (RootElement root) : base (root) {}
        public override bool ShouldAutorotateToInterfaceOrientation (UIInterfaceOrientation toInterfaceOrientation)
        {
            return true;
        }   
    }
} 
```

# python - 如何使用 readline 使用户能够“滚动”到以前输入的行？

> ID：10644263
> 
> 赞同：0
> 
> 时间：2012-05-17T22:17:50.063
> 
> 标签：python, python-3.x, curses

我有一个命令行应用程序，其工作方式类似于 shell，它不断地向用户询问命令并根据给定的命令执行特定操作。我想实现“回滚”或“历史”功能，以允许用户使用向上和向下箭头键导航到以前输入的行。我以前浏览过文档，但无法弄清楚。任何指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:06:40.647

哇。我不认为它会在文档中得到回答，但它是。我喜欢 Python 的另一个原因。[http://docs.python.org/py3k/library/readline.html](http://docs.python.org/py3k/library/readline.html)

# java - 仅执行从 svn 到 maven 3 的最新代码更新

> ID：10644266
> 
> 赞同：1
> 
> 时间：2012-05-17T22:17:57.587
> 
> 标签：java, svn, maven-3

我已经从 svn 下载了一些代码到我的系统中。现在通过 maven，我需要检查此代码是否有任何更新，如果有，则更新它。我不需要检查整个代码。那么是否可以只更新任何项目的现有源代码而无需 maven 创建结帐目录？

我关注了这篇文章：[为 Maven 设置条件结帐或从 SVN 更新？](https://stackoverflow.com/questions/5817229/settings-for-maven-for-conditional-checkout-or-update-from-svn).

但是，如果我不先检查，我认为只有更新不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T05:02:23.610

有两种方法可以做到这一点。您可以手动调用`mvn scm:update`，如果有任何更改，它将根据在`<scm>`pom.xml 中为项目指定的设置更新源。请参阅[此使用页面](http://maven.apache.org/scm/plugins/usage.html)和[高级 scm 命令](http://maven.apache.org/scm/plugins/examples/scm-advance-features.html)文档。

另一种方法是将此目标作为标准 Maven 生命周期的一部分来调用。这是在[提到的问题](https://stackoverflow.com/questions/5817229/settings-for-maven-for-conditional-checkout-or-update-from-svn)中尝试的。没有理由单独更新不起作用。您可以使用代码片段`update-project` `<execution>`并根据需要对其进行修改。

后者可能不适合，因为如果您进行离线构建或由于某种原因没有 scm 连接，则不会发生构建。可以说这样做`mvn scm:update clean install`或类似的事情会更好。

# php - isset 的奇怪行为

> ID：10644279
> 
> 赞同：3
> 
> 时间：2012-05-17T22:19:35.353
> 
> 标签：php, php-5.3

php 5.3 中的 isset() 似乎表现异常。我有一个名为 DB details 的类，它用 getter 和 setter 封装了一堆字符串属性。

$dbdetails->getDatabasename() 计算结果为字符串（“mydb”）

**这会引发 500 错误：**

```
if(!isset($dbdetails->getDatabasename())){
//do something
} 
```

**这工作正常**

```
$databasename = $dbdetails->getDatabasename();
if(!isset($databasename)){
//do something
} 
```

我看不到任何日志输出，因为即使错误 ini 参数设置（原文如此）为 On，apache 也发回了 500。我知道这肯定与 isset 调用有关。知道可能出了什么问题，还是我发现了 PHP 错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-17T22:22:07.710

该`isset`函数检查是否设置了变量。检查`$databasename`是有效的，因为它是一个可以设置或不设置的变量。检查函数是无效的，因为它根本不是变量。

您可能希望`is_null( $value )`在检查函数的立即结果时使用。

* * *

[is_null](http://php.net/manual/en/function.is-null.php "PHP 手册")文档中的评论示例：

```
<?php
function test( ) { return null; }
var_dump( is_null( test( ) ) ); // displays "true"
var_dump( isset( test( ) ) ); // parse error, because "test()" is not a variable
?> 
```

*   [PHP: is_null](http://php.net/manual/en/function.is-null.php "PHP 手册")
*   [PHP：伊塞特](http://www.php.net/manual/en/function.isset.php "PHP 手册")

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-17T22:21:58.500

就是这样[`isset()`](http://php.net/isset)工作的。与 相同[`empty()`](http://php.net/empty)。它们只能与变量一起使用，而不能与表达式一起使用。从[文档中](http://php.net/isset#refsect1-function.isset-notes)：

> `isset()`仅适用于变量，因为传递任何其他内容都会导致解析错误。要检查是否设置了常量，请使用该`defined()`函数。

因此，`isset(function_call())`是无效的语法。

# mysql - 加入 加入 mysql

> ID：10644286
> 
> 赞同：-1
> 
> 时间：2012-05-17T22:20:39.873
> 
> 标签：mysql

我收到一个 SQL 错误 (1064) 语法。我正在尝试做的事情是否允许？因为我没有看到语法错误。

```
`SELECT isc_products.prodname, isc_product_variations.* , isc_product_variation_combinations.vcoptionids, 
FROM isc_products 
JOIN isc_product_variations 
ON isc_products.prodvariationid = isc_product_variations.variationid
JOIN isc_product_variation_combinations
ON isc_product_variation_combinations.vcvariationid = isc_product_variations.variationid` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:23:27.597

你的陈述中有`isc_product_variations.variationid`两次。`ON`检查，如果这是你想要的，或者你可能需要第二把钥匙`isc_product_variations`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T22:28:35.277

您在第一行有错误。你有一个不应该出现的逗号：

```
SELECT isc_products.prodname,
       isc_product_variations.* ,
       isc_product_variation_combinations.vcoptionids,
--                                                   ^
FROM ... 
```

我还建议您不要使用`SELECT isc_product_variations.*`，而是明确列出您想要的列。

# objective-c - 在 Xcode 中使用 SBJson 解析阿拉伯文本

> ID：10644293
> 
> 赞同：1
> 
> 时间：2012-05-17T22:21:44.640
> 
> 标签：objective-c, xcode, json, nsstring, arabic

我有一个我正在尝试使用 SBJson 解析的 JSON 文件。

我收到的响应字符串在我执行时正确显示阿拉伯字符

```
NSLog(@"%@",responseString); 
```

但每当我使用 SBJson 解析器

```
NSDictionary *myDictionary = [responseString JSONValue]; 
```

并尝试

```
NSLog(@"%@", myDictionary); 
```

我的阿拉伯字符变成了奇怪的东西：

```
\U0633\U0627\U0642\U064a\U0629 \U0627\U0644\U0645\U0633\U0643 
```

请问谁能帮忙

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T04:22:58.247

不用担心。一切都很好。

```
\u0633 
```

相当于

```
س 
```

在 C++ 中试试这个：

```
std::wstring tStr = L"\u0633"; 
```

tStr 将等于 س

只是 NSLog 没有转换

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T17:42:09.987

用这个 ：

```
NSStringEncoding Arabicencoding = CFStringConvertEncodingToNSStringEncoding(kCFStringEncodingWindowsArabic);
    NSString *yourstring = [[NSString alloc]initWithData:yourdata encoding:Arabicencoding]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T22:54:42.933

"\U0633\U0627\U0642\U064a\U0629\U0627\U0644\U0645\U0633\U0643" 实际上只是 Objective-C 用于非 ascii 字符的编码。尝试在您正在测试的任何内容上添加一个子视图/标签，以显示文本。首先尝试使用“responseString”，然后使用“myDictionary”，它*可以*显示相同的内容。

# c# - 在字典上使用 foreach 循环进行迭代是否需要正常的哈希表访问？

> ID：10644301
> 
> 赞同：0
> 
> 时间：2012-05-17T22:22:33.247
> 
> 标签：c#, .net, performance, dictionary

我正在编写一个主要是性能密集型的应用程序。今天写了一个快速基准测试后，我发现字典访问时间比数组访问时间慢得多（最多 100 次），尽管两者都是 O(1)。我尝试在互联网上找到类似的结果，但无济于事。这看起来对吗？这对我来说很有意义，因为字典涉及散列，而不是数组。

我现在正在权衡字典的优缺点，并考虑是否应该尝试更快的实施。在我的应用程序的至少 3 个实例中，我使用 foreach 循环遍历我的所有字典（有很多）。所以现在要回答我的问题，foreach 循环是否必须经过“慢”（我在这里相对而言）散列过程，或者它是否只是维护一个可以快速迭代的内部列表？如果是这种情况，我更有可能坚持使用字典。

对于一些额外的信息，该应用程序是一个简单的 2D 游戏，而字典将存储在游戏实体中。不过确实有很多。是的，我已经有了一个可行的解决方案。这是优化后，而不是优化前。

这是我写的基准。这可能是非常错误的，因为我不是该领域的专家：

```
 public static int dict(Dictionary<key,int> dict, key k)
        {
            int i;
            //dict.TryGetValue(k,out i);
            i = dict[k];  //both these version yield the same results

            return i;
        }

        public static int arr(int[,] arr, key k)
        {
            int i;
            i = arr[k.x, k.y];

            return i;
        }

        public struct key
        {
            public int x, y;

            public key (int x, int y){
                this.x = x;
                this.y = y;
            }
        }

        public static void Main()
        {
            int dim = 256;
            Dictionary<key,int> dictVar = new Dictionary<key,int>(dim*dim*10);

            int[,] arrVar = new int[dim,dim];

            for (int i = 0; i < dim; ++i)
            {
                for (int j = 0; j < dim; ++j)
                {
                    arrVar[i, j] = i + j * i;
                    dictVar.Add(new key(i, j), i + i * j);
                }  
            }

            const int iterations = 1000000;
            key k = new key(200, 200);
            TestTime(dict, dictVar, k, iterations);
            TestTime(arr, arrVar, k, iterations);
        }

        public static void TestTime<T1, T2, TR>(Func<T1, T2, TR> action, T1 obj1,
                                                T2 obj2, int iterations)
        {
            Stopwatch stopwatch = Stopwatch.StartNew();
            for (int i = 0; i < iterations; ++i)
                action(obj1, obj2);
            Console.WriteLine(action.Method.Name + " took " + stopwatch.Elapsed);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:30:02.513

它维护一个循环遍历的内部列表，但该列表的类型为`Entry<TKey, TValue>[]`，因此每次都必须构造一个 KeyValuePair 。我猜这就是导致放缓的原因。

# rally - 仅限于 App SDK 2.0 的 AttributeComboBoxes 中可见的项目？

> ID：10644313
> 
> 赞同：0
> 
> 时间：2012-05-17T22:23:47.360
> 
> 标签：rally

我在弄清楚为什么我正在测试的 AttributeComboBox 中缺少项目时遇到了一些麻烦。通过调试，我可以清楚地看到字段 config 有一个包含所有项目的数组，但在 UI 中只有 15 个可见。是否需要指定配置以增加显示项目的数量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T16:27:53.667

看起来需要设置 listConfig 中的 maxHeight 。我尝试了 maxHeight 配置，但它不起作用，所以我认为这不是高度问题。作为参考，两个配置的默认值都是 300，因此如果您有类似的体验，请将高度调整为 300 以上。如果将 maxHeight 设置为远高于显示所有项目可能需要的高度，则也没有额外的空白。

这是一个例子：

```
this.example = Ext.widget('rallyattributecombobox', {
    model:'PortfolioItem',
    field:'Something',
    fieldLabel: 'Something',
    labelWidth: 150,
    stateful: false,
    listConfig: {
        maxHeight: 465
    }
}); 
```

# actionscript-3 - 在 AS3 移动应用程序中设置 ApplicationDPI

> ID：10644314
> 
> 赞同：3
> 
> 时间：2012-05-17T22:23:52.413
> 
> 标签：actionscript-3, mobile, dpi

我在 Flash Builder 中仅使用 AS3 开发应用程序（没有 flex 东西）。在 flex 中，可以通过以下代码设置应用程序的 dpi：

```
<s:ViewNavigatorApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
   xmlns:s="library://ns.adobe.com/flex/spark" applicationDPI="320"> 
```

但我只使用 AS3。我已经读到无法在运行时更改应用程序的 DPI（使用 AS3），但是如何在项目设置、编译器设置中进行设置，或者有其他方法吗？

另外，默认应用程序的 DPI 设置是什么？

在这里问它，因为在网上找不到它（仅基于 flex 的解决方案）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T22:59:52.933

手机上的DPI是由硬件设置的，完全取决于手机和屏幕。当您在 Flex 移动设备中设置 applicationDPI 时，您是在告诉 Flex 自动缩放您的资源。

> 自动缩放。开发人员可以通过在应用程序上设置 applicationDPI 属性来选择为其应用程序指定目标 DPI。明确设置后，开发人员应该设置他们的皮肤和布局，就好像他们在给定 DPI 的设备上运行一样。在运行时，如果设备的 DPI 与指定的目标 DPI 不同，Flex 将自动缩放整个应用程序以保留应用程序及其控件的大致物理大小。例如，如果应用程序的目标是 160 DPI，它会在 240 DPI 设备上自动缩放 1.5 倍。如果您选择不使用此功能，则需要确保您的自定义皮肤和视图布局在运行时正确适应不同的像素密度。 [来源](http://www.adobe.com/devnet/flex/articles/mobile-development-flex-flashbuilder.html)

在 AS3 移动项目中，您需要自己处理。

您可以使用当前的 DPI，`Capabilities.screenDPI`但我认为您可能追求的是一个比例来扩展您的资产。一种方法是从原始游戏宽度开始。

```
 private static const WIDTH:Number = 1024; 
```

然后，您可以使用

```
 var ratio:Number = stage.fullScreenWidth / WIDTH; 
```

并将其应用于您的资产

```
myBitmap.scaleX = myBitmap.scaleY = ratio; 
```

现在这不会考虑设备的旋转，因此 fullScreenWidth/Height 可能会翻转。要检查你将需要做这样的事情

```
if (stage.fullScreenWidth > stage.fullScreenHeight){
  //portrait 
} else {
  //landscape
} 
```

希望这会有所帮助

# c# - Silverlight + MVVM + 绑定 = 内存泄漏？

> ID：10644315
> 
> 赞同：9
> 
> 时间：2012-05-17T22:23:59.457
> 
> 标签：c#, silverlight, mvvm, memory-leaks, caliburn.micro

到目前为止，我的测试表明，在 silverlight 中利用 MVVM 模式的所有标准方法、示例和框架都存在一个巨大的问题：大量内存泄漏会阻止 VM 被垃圾收集。

**显然这是一个巨大而荒谬的主张**- 所以我的期望是有人会对我为什么以及哪里出错有一个明显的答案:)

重现的步骤很简单：

*   通过将视图数据上下文设置为 VM 将视图模型绑定到视图（假设视图模型利用 INotifyPropertyChanged 来支持数据绑定）
*   将 UI 元素绑定到视图模型上的属性，例如：

`<TextBox Text="{Binding SomeText}" />`

*   以某种方式利用绑定（例如 - 只需在文本框中输入）。

这将创建一个从根延伸到 BindingExpression 再到您的视图模型的引用链。然后，您可以从 UI 树中删除视图，以及对 VM 的所有引用 - 但是由于 root<>BindingExpression<>VM 引用链，VM 永远不会被垃圾收集。

我创建了两个示例来说明该问题。他们有一个按钮来创建一个新的视图/视图模型（它应该转储所有对旧视图的引用）和一个强制垃圾收集和报告当前内存使用情况的按钮。

示例 1 是一个超级精简的 caliburn 微示例。示例 2 没有使用任何框架，只是以我能想到的最简单的方式来说明问题。

[示例 1](http://dl.dropbox.com/u/72490893/MVVMLeak.zip "示例 1")

[示例 2](http://dl.dropbox.com/u/72490893/MVVMLeak2.zip "示例 2")

对于那些可能希望提供帮助但不想下载示例项目的人，这里是示例 2 的代码。我们从一个名为 FooViewModel 的视图模型开始：

```
 public class FooViewModel : INotifyPropertyChanged
{
    string _fooText;

    public string FooText
    {
        get { return _fooText; }
        set
        {
            _fooText = value;
            NotifyPropertyChanged("FooText");
        }
    }

    private byte[] _data;
    public FooViewModel()
    {
        _data = new byte[10485760]; //use up 10mb of memory
    }

    private void NotifyPropertyChanged(String info)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(info));
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

它只是公开了一个名为 FooText 的字符串属性，我们也将绑定它。INotifyPropertyChanged 是促进绑定所必需的。

然后我们有一个名为 FooView 的视图，它是一个用户控件，其中包含：

```
<UserControl x:Class="MVVMLeak.FooView">
    <StackPanel x:Name="LayoutRoot" Orientation="Horizontal">
        <TextBlock Text="Bound textbox: " />
        <TextBox Text="{Binding FooText}" Width="100"/>
    </StackPanel>
</UserControl> 
```

（为简洁起见省略了命名空间）

这里重要的一点是绑定到 FooText 属性的文本框。当然，我们需要设置数据上下文，我选择在代码隐藏中执行此操作，而不是引入 ViewModelLocator：

```
public partial class FooView : UserControl
{
    public FooView()
    {
        InitializeComponent();
        this.DataContext = new FooViewModel();
    }
} 
```

主页看起来像这样：

```
<StackPanel x:Name="LayoutRoot" Background="White">

    <Button Click="Button_Click" Content="Click for new FooView"/>
    <Button Click="Button2_Click" Content="Click to garbage collect"/>
    <ContentControl x:Name="myContent"></ContentControl>
</StackPanel> 
```

在后面的代码中包含以下内容：

```
 private void Button_Click(object sender, RoutedEventArgs e)
    {
        myContent.Content = new FooView();
    }

    private void Button2_Click(object sender, RoutedEventArgs e)
    {
        MessageBox.Show("Memory in use after collection: " + (GC.GetTotalMemory(true) / 1024 / 1024).ToString() + "MB");
    } 
```

注意：要复制问题，请务必在文本框中输入一些内容，因为我相信绑定表达式只有在需要时才会创建。

值得注意的是，[这篇知识库文章](http://support.microsoft.com/kb/938416/en-us)可能是相关的，但我不相信，因为“方法 2”解决方法似乎没有效果，并且参考链似乎不匹配。

另外，我不确定这是否重要，但我使用[CLR Profiler](http://www.microsoft.com/en-us/download/details.aspx?id=16273)来诊断原因。

**更新：**

如果有人想测试并在评论中报告他们的发现，我将在此处通过保管箱托管 silverlight 应用程序：[托管示例](http://dl.dropbox.com/u/72490893/MVVMLeak/MVVMLeakTestPage.html)。重现：点击顶部按钮，输入内容，点击顶部按钮，输入内容，点击顶部按钮。然后按下按钮。如果它报告了 10MB 的使用量（或者可能是其他一些没有增加的量），那么您没有遇到内存泄漏。

到目前为止，问题似乎都发生在我们所有的开发机器上，这些机器是 ThinkPad w510 (43192RU)，配备 12GB 内存，64 位 Win 7 Enterprise。这包括一些没有安装开发工具的。值得注意的是，他们正在运行 VMWare 工作站。

在我尝试过的其他机器上似乎没有出现这个问题——包括几台家用电脑和办公室里的其他电脑。我们在一定程度上排除了 SL 版本、内存量，可能还有 vmware。还没有确定原因。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-23T20:34:00.287

~~尚未找到解决方案~~，但现在已确定问题。如果由于以下原因调用 Silverlights 的自动化功能，则会发生此行为：

*   平板电脑输入服务（换句话说，所有“类似平板电脑”的电脑）
*   自动化测试工具
*   屏幕阅读器（和其他可访问性软件）

更多信息在这里： http: [//www.wintellect.com/cs/blogs/sloscialo/archive/2011/04/13/silverlight-memory-leaks-and-automationpeers.aspx](http://www.wintellect.com/cs/blogs/sloscialo/archive/2011/04/13/silverlight-memory-leaks-and-automationpeers.aspx)

因此出现了一个新问题：我们如何禁用自动化对等体或以其他方式让它们正确清理？

这篇文章说明了一种方法：[WPF UserControl 内存泄漏](https://stackoverflow.com/questions/3306538/wpf-usercontrol-memory-leak)

然而，这并不是一个真正可行的解决方案，因为我们必须覆盖我们计划使用绑定的每个 silverlight 控件，更不用说复杂控件的控件模板了。

如果有人能找到一个好的解决方案，我会改变我的答案，但目前似乎没有一个......

**编辑：**

这是一个不错的小解决方法，似乎可以完成这项工作。只需在定义 silverlight 对象的 HTML 中添加以下参数：

```
<param name="windowless" value="true" /> 
```

在“无窗口”模式下运行的一个副作用是自动化不起作用:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T12:20:56.800

您的第二个示例中没有内存泄漏。

将新`FooView`实例影响到`ContentControl`using`myContent.Content = new FooView();`后，**不再使用对**整个 View + ViewModel 对象图的引用。

最终，它会在需要时被垃圾收集。

也许您应该澄清是什么让您认为存在内存泄漏（即统计信息、重现步骤...等）

# c# - 字母数字和特殊字符的正则表达式

> ID：10644318
> 
> 赞同：4
> 
> 时间：2012-05-17T22:24:09.473
> 
> 标签：c#, regex, vb.net

我需要定义一个接受字母数字和以下特殊字符的正则表达式：@#$%&*()-_+][';:?.,!

我想出了：

```
string pattern = @"[a-zA-Z0-9@#$%&*+\-_(),+':;?.,![]\s\\/]+$"; 
```

但这似乎不起作用。有人可以让我知道缺少什么吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-17T22:25:29.593

中间`[]`的需要转义*：

```
\[\] 
```

您可能还想用 . 锚定字符串的开头`^`。

* * *

[* 可能只是`]`为了平衡，但我喜欢两者兼而有之。]

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-17T22:27:01.573

定义字符类时，您需要转义其中的右括号`]`，就像“ `^`”、“ `-`”和转义序列`\`本身一样，您已正确完成：

```
string pattern = @"[a-zA-Z0-9@#$%&*+\-_(),+':;?.,![\]\s\\/]+$";
                                    ^              ^   ^ 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-17T22:26:34.600

其中一些字符需要转义（*、+ 等）。最简单的方法是简单地将它们全部转义：

```
string pattern = @"[a-zA-Z0-9\@\#\$\%\&\*\(\)\-\_\+\]\[\'\;\:\?\.\,\!]+$"; 
```

# linux - 如何从我的 DLL/so 中删除依赖于第 3 方的 DLL/so 的符号？

> ID：10644319
> 
> 赞同：1
> 
> 时间：2012-05-17T22:24:15.443
> 
> 标签：linux, gcc, linker

假设我的软件项目 A 作为共享库 (libA.so) 发布。A 使用第 3 方库 B，它在我构建 libA.so 时链接为共享库。（虽然我很乐意使用 libB.a 而不是 libB.so，如果这是解决方案的一部分。） B 由 A 使用，但严格来说，链接到 A 的应用程序不需要看到任何B 的符号，它不是 A 的公共 API 的一部分。

好的，问题来了：一些应用程序出于自身原因链接到 B，以及链接到 A，如果 B 的版本（应用程序使用的版本和 A 在构建时链接的版本）不匹配，则是符号冲突时的随机崩溃。

如何使 B 的所有符号都解决 A 的需求，但不导出为 libA.so 中的可见符号？换句话说，我不希望链接到 A 的应用程序直接解析 B 的符号。这甚至可能吗？

首先，我需要 Linux 上的解决方案，但知道如何在 OSX 和/或 Windows 上解决问题也会有所帮助。

我了解如何限制 A 本身中符号的可见性（不一定是 A 的公共 API 的一部分），但是如何为依赖库 B 执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T05:50:40.773

> ...某些应用程序出于自身原因链接到 B ... 换句话说，我不希望链接到 A 的应用程序直接解决 B 的符号。

想一想：如果你阻止应用程序链接到 B 的符号，应用程序将如何满足“它自己链接到 B 的理由”？

您的问题（如前所述）是自相矛盾的。

现在，用于链接同一可执行文件的不同部分的多个版本的 B 显然是一个问题。

我知道的唯一解决方案是让您“隐藏”您完全使用 B 的事实。这样做的方法是：

1.  链接反对`libB.a`, 和
2.  将 B 的符号隐藏在 中`libA.so`，因此它们不会被导出。[这是使用链接器版本脚本](https://stackoverflow.com/a/452955/50617)最容易实现的。

请注意，如果`libB.a`根据例如 GPL 分发，则将其副本放入`libA.so`可能需要您满足`libB`许可条款。小心行事并咨询您的律师。

# user-interface - 如何在 wx.aui.AuiNotebook 中更改页面的标题？

> ID：10644321
> 
> 赞同：1
> 
> 时间：2012-05-17T22:24:36.840
> 
> 标签：user-interface, wxpython

所以我正在开发一个文本编辑器，以更好地学习 wxPython（并制作一个我非常喜欢的文本编辑器：P）。我一直无法找到关于 wx.aui.AuiNotebook 类的大量信息。我想知道的一件事是如何与其页面交互。例如，我真的很想知道如何更改页面的标题（这样我可以在用户保存时更新页面标题或在有未保存的更改时标记它）。对此问题的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:36:16.950

该方法称为`SetPageText`，因此您可以执行以下操作：

```
 current_page = notebook.GetCurrentPage()
    current_page_index = notebook.GetPageIndex(current_page)
    current_label = notebook.GetPageText(current_page_index)
    if not current_label.endswith(' (*)':
        notebook.SetPageText(current_page_index, current_label + ' (*)') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T05:11:08.500

显然，在 wxPython 2.8 版中不包括 wx.aui.AuiNotebook.GetCurrentPage()。我显然没有意识到 wx.aui.AuiNotebook 中的“页面”等同于添加到其中的面板。因此，以下代码将起作用，

```
 self.panelBox = []
    newPanel = wx.Panel(self, wx.ID_ANY)

    #YADA YADA STUFF!        

    self.nb.AddPage(newPanel, "Untitled Document "+str(self.untitledDocCount))
    currPageIndex = self.nb.GetPageIndex(newPanel)
    currLabel = self.nb.GetPageText(currPageIndex)
    if not currLabel.endswith(' (*)'):
        self.nb.SetPageText(currPageIndex, currLabel+' (*)')
    self.panelBox.append(newPanel) 
```

由程序员来确保页面（面板）是可访问的。为此，我将面板引用存储在“面板框”中，然后在“更改选项卡”事件等条件下相应地在它们之间切换。我不知道这是否是最好的方法，但到目前为止它似乎有效。

# android - 如何使用终端使用适用于 Android 的 aapt 工具更新 resources.arsc 中的 AndroidManifest.XML

> ID：10644323
> 
> 赞同：11
> 
> 时间：2012-05-17T22:24:53.920
> 
> 标签：android, terminal, aapt

我需要更新我在 AndroidManifest.XML 中使用的包 ID，该 ID 已编译为我的 Android 应用程序 (.apk) 的 resources.arsc 文件，而无需反编译 resources.arsc。

android aapt 工具包括更新 (-u) 选项以及重命名 manifest.xml 和项目其余部分中的包 ID (--rename-manifest-package && --rename-intrumentation-target-package) .

能够在不首先反编译的情况下更新或输出 resources.arsc 非常重要。我也准备好了一个带有新 ID 的替换 AndroidManifest.XML。我在下面提供了终端“使用”文档以供参考。我不确定我是否误解了文档，或者只是缺乏理解终端中使用的所需语法（尝试了 DOS 和 UNIX）。

提前致谢！

```
Usage:
aapt l[ist] [-v] [-a] file.{zip,jar,apk}
List contents of Zip-compatible archive.

aapt d[ump] [--values] WHAT file.{apk} [asset [asset ...]]
badging          Print the label and icon for the app declared in APK.
permissions      Print the permissions from the APK.
resources        Print the resource table from the APK.
configurations   Print the configurations in the APK.
xmltree          Print the compiled xmls in the given assets.
xmlstrings       Print the strings of the given compiled xml assets.

aapt p[ackage] [-d][-f][-m][-u][-v][-x][-z][-M AndroidManifest.xml] \
    [-0 extension [-0 extension ...]] [-g tolerance] [-j jarfile] \
    [--min-sdk-version VAL] [--target-sdk-version VAL] \
    [--app-version VAL] [--app-version-name TEXT] [--custom-package VAL] \
    [--rename-manifest-package PACKAGE] \
    [--rename-instrumentation-target-package PACKAGE] \
    [--utf16] [--auto-add-overlay] \
    [-I base-package [-I base-package ...]] \
    [-A asset-source-dir]  [-G class-list-file] [-P public-definitions-file] \
    [-S resource-sources [-S resource-sources ...]]         [-F apk-file] [-J R-file-dir] \
    [raw-files-dir [raw-files-dir] ...]

Package the android resources.  It will read assets and resources that are
supplied with the -M -A -S or raw-files-dir arguments.  The -J -P -F and -R
options control which files are output.

aapt r[emove] [-v] file.{zip,jar,apk} file1 [file2 ...]
Delete specified files from Zip-compatible archive.

aapt a[dd] [-v] file.{zip,jar,apk} file1 [file2 ...]
Add specified files to Zip-compatible archive.

aapt v[ersion]
Print program version.

Modifiers:
-a  print Android-specific data (resources, manifest) when listing
-c  specify which configurations to include.  The default is all
   configurations.  The value of the parameter should be a comma
   separated list of configuration values.  Locales should be specified
   as either a language or language-region pair.  Some examples:
        en
        port,en
        port,land,en_US
   If you put the special locale, zz_ZZ on the list, it will perform
   pseudolocalization on the default locale, modifying all of the
   strings so you can look for strings that missed the
   internationalization process.  For example:
        port,land,zz_ZZ
-d  one or more device assets to include, separated by commas
-f  force overwrite of existing files
-g  specify a pixel tolerance to force images to grayscale, default 0
-j  specify a jar or zip file containing classes to include
-k  junk path of file(s) added
-m  make package directories under location specified by -J
-u  update existing packages (add new, replace older, remove deleted files)
-v  verbose output
-x  create extending (non-application) resource IDs
-z  require localization of resource attributes marked with
   localization="suggested"
-A  additional directory in which to find raw asset files
-G  A file to output proguard options into.
-F  specify the apk file to output
-I  add an existing package to base include set
-J  specify where to output R.java resource constant definitions
-M  specify full path to AndroidManifest.xml to include in zip
-P  specify where to output public resource definitions
-S  directory in which to find resources.  Multiple directories will be scanned
   and the first match found (left to right) will take precedence.
-0  specifies an additional extension for which such files will not
   be stored compressed in the .apk.  An empty string means to not
   compress any files at all.
--min-sdk-version
   inserts android:minSdkVersion in to manifest.  If the version is 7 or
   higher, the default encoding for resources will be in UTF-8.
--target-sdk-version
   inserts android:targetSdkVersion in to manifest.
--values
   when used with "dump resources" also includes resource values.
--version-code
   inserts android:versionCode in to manifest.
--version-name
   inserts android:versionName in to manifest.
--custom-package
   generates R.java into a different package.
--auto-add-overlay
   Automatically add resources that are only in overlays.
--rename-manifest-package
   Rewrite the manifest so that its package name is the package name
   given here.  Relative class names (for example .Foo) will be
   changed to absolute names with the old package so that the code
   does not need to change.
--rename-instrumentation-target-package
   Rewrite the manifest so that all of its instrumentation
   components target the given package.  Useful when used in
   conjunction with --rename-manifest-package to fix tests against
   a package that has been renamed.
--utf16
   changes default encoding for resources to UTF-16\.  Only useful when API
   level is set to 7 or higher where the default encoding is UTF-8. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-29T07:30:31.050

你有没有试过`--rename-manifest-package`。它也不会影响生成的 R 文件但是如果您在运行时加载一些资源 id，您可能需要更新您的代码。

例如。（此代码必须更改）

```
String packageName = context.getPackageName();
Resources res = context.getResources();
int id = res.getIdentifier("my_drawable", "drawable", packageName); 
```

你可以去这个[链接](http://www.piwai.info/renaming-android-manifest-package/ "更改包名")了解更多信息。

# android - 启动新活动时的Android java.lang.NoClassDefFoundError

> ID：10644330
> 
> 赞同：1
> 
> 时间：2012-05-17T22:25:49.947
> 
> 标签：android

当我尝试启动我的新活动时，我收到了 java.lang.NoClassDefFoundError。下面是我的 AndroidManifest.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest
    xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.practice.googlemaps"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="15" />
  <uses-permission android:name="android.permission.INTERNET" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >

            <activity
                android:name=".LoginActivity"
                android:label="Login to your Account">
                <intent-filter>
                    <action android:name="android.intent.action.MAIN" />
                    <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity
            android:name=".RegisterActivity"
            android:label="Register New Account">
        </activity>

        <activity
            android:name=".GoogleMapsActivity"
            android:label="Google Maps">
        </activity>

        <uses-library android:name="com.google.android.maps"/>

    </application>

</manifest> 
```

GoogleMapsActivity.java 的代码

```
package com.practice.googlemaps;

import android.os.Bundle;

import com.google.android.maps.MapActivity;
import com.google.android.maps.MapView;

public class GoogleMapsActivity extends MapActivity {

  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    MapView mapView = (MapView)findViewById(R.id.mapView);
    mapView.setBuiltInZoomControls(true);
  }

    @Override
    protected boolean isRouteDisplayed() {
      // TODO Auto-generated method stub
      return false;
    }
} 
```

以下是我用来启动新活动的线路：

```
Intent i = new Intent(getApplicationContext(), GoogleMapsActivity.class);
startActivity(i); 
```

我检查了我的类 GoogleMapsActivity.java，该文件存在并且拼写/措辞都匹配。

我怀疑该错误可能是由我的 AndroidManifest.xml 引起的，但我找不到问题所在。

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T22:35:45.140

确保 `<uses-library android:name="com.google.android.maps"/>`位置正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T04:13:34.087

您肯定缺少添加一个 jar 文件，以便显示 Noclassdeffound 错误。如果你已经添加了所有的 jar 文件，那么这个错误就会出现，那么我给你一个绝对有效的最佳答案。只需在您的项目中创建 libs 文件夹并将所有 jar 文件添加到 libs 文件夹中，您的问题肯定会解决。

# c# - 从 SD 卡运行 C# 程序，但显示它从临时目录运行

> ID：10644331
> 
> 赞同：0
> 
> 时间：2012-05-17T22:25:50.753
> 
> 标签：c#

我遇到了一个奇怪的问题，希望得到您的帮助。

在我的移动应用程序中，该程序在 SD 卡上编写了一个 Windows C# 程序（和依赖项），以便当 SD 卡安装在 PC 上时，用户可以在他的 PC 上运行它。程序和依赖项像这样在根级别复制。

*   我的程序
*   myprogram.exe.config [仅供参考：config 具有运行时绑定和 Libs 文件夹]

*   库\Interop.iTunesLib.dll

我收到了这样一个用户的错误报告。我无法在我的最后重现这个

```
OS Version: Microsoft Windows NT 6.1.7601 Service Pack 1
Assembly version: 1.0.0.0
CurrentDirectory: C:\Users\yasd\AppData\Local\Temp\WPDNSE\SID-{10001,SECZ9519043CHOHB,4820242432}
Problem: Could not load file or assembly 'Interop.iTunesLib, Version=1.11.0.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. The system cannot find the file specified. 
```

现在我看到的问题是我在报告中得到的程序的当前目录是

```
"C:\Users\yasd\AppData\Local\Temp\WPDNSE\SID-{10001,SECZ9519043CHOHB,4820242432}" 
```

我期待它是这样的

```
F:\ 
```

因为用户是从 SD 卡的根目录运行它，而不是在 windows 的临时文件夹上运行它。

我的评估是，因为这条路径是错误的，它无法加载依赖程序集，

如果从 SD 卡运行，为什么会有东西进入 C# 中的临时目录？？？我问用户他没有从 SD 卡复制任何文件并从 SD 卡运行。

请帮助，任何建议高度赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:11:32.457

我怀疑这与遮蔽有关，这样做是为了防止文件锁导致各种问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T03:45:48.453

我已经解决了。用户没有从 SD 卡运行它，而是使用 MTP 的称为便携式设备部分的东西

# magento - Magento - 链接到外部站点的硬编码顶部导航菜单项

> ID：10644335
> 
> 赞同：0
> 
> 时间：2012-05-17T22:26:46.133
> 
> 标签：magento, nav, hardcoded, external-links

我已经搜索了这个看似简单的问题的答案，但是我还没有找到一个可行的解决方案。

我在 Magento 中的顶部导航菜单是硬编码的，包括 CMS 页面（没有问题，因为 CMS 页面是基于 BaseURL 构建的）但是我的一个链接需要转到外部站点，但到目前为止我编写的所有内容都是添加 baseURL，因此将转到 404 页面。

这是我使用的最新代码的示例 - 我从代码中删除了 Mage::BaseURL。仍然没有运气。我确实通过类别看到了一个疯狂的解决方法，但我不想走那条路，因为我对链接在顶部导航菜单中的位置控制较少（我的类别首先加载，但这个链接需要是导航中的最后一个)

```
class="level0 level-top first"><a class="level-top" href="<?php echo $this->getUrl('http://www.externallink.com/')?>"><span><?php echo $this->__("Restaurant") ?></span></a> 
```

有人有建议吗？我被困住了。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:49:29.523

您不需要使用 PHP 代码来回显链接。只需将其放在 HTML 中即可。当您调用“getUrl()”时，它会预先添加 base_url

# c# - 在前台运行 Windows 服务

> ID：10644344
> 
> 赞同：2
> 
> 时间：2012-05-17T22:27:54.973
> 
> 标签：c#, .net, windows-services, windows-xp

我有一个作为服务安装的 bat 文件。我可以在远程机器上运行该服务。该服务需要启动另一个应用程序。启动的应用程序需要可见（在前台运行）。当前启动的应用程序正在后台运行，因为 Windows 服务正在后台运行。如何使 Windows 服务或 Windows 服务及其启动的应用程序都在前台运行？我打算用 C# 中的 ServiceController 类来管理服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:56:18.983

我想你可能应该读

[http://asprosys.blogspot.com.au/2009/03/allow-service-to-interact-with-desktop.html](http://asprosys.blogspot.com.au/2009/03/allow-service-to-interact-with-desktop.html)

让服务只启动另一个应用程序是一个真正的安全问题，如果您的另一个应用程序被其他应用程序替换，您是否在服务中进行了所有检查以确保您的应用程序是您认为的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T02:31:55.007

正确的方法是在用户会话中启动第二个应用程序，而您的 Windows 服务应用程序始终在会话 0 中运行。

该方法是我在此线程下与@RaheelKhan 讨论的一部分，

[添加应用程序清单以确保在 windows xp、vista 和 7 中提升权限的可靠性如何？](https://stackoverflow.com/questions/10468010/how-reliable-is-adding-an-application-manifest-to-ensure-elevated-privileges-acr)

它需要正确理解 Windows 会话、会话隔离和平台调用。

# java - spoj/ideone 上的 NullPointerException

> ID：10644345
> 
> 赞同：1
> 
> 时间：2012-05-17T22:28:26.233
> 
> 标签：java, string, split, nullpointerexception

我为我的作业创建了一个程序，我尝试在 ideone.com 上进行测试，但出现错误：

```
Exception in thread "main" java.lang.NullPointerException
    at Main.main(Main.java:83) 
```

对于每个测试（在椭圆中工作正常）

第 83 行：

```
 String[] val = tab.split(" "); 
```

第 82 行：// 仅供参考

```
String tab = in.readLine(); 
```

第 78 行：// 仅供参考

```
 BufferedReader in = new BufferedReader(new InputStreamReader(System.in)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:46:32.870

扫描仪在第一次调用`nextInt`. 我建议使用扫描仪或缓冲阅读器——但不能同时使用两者。让他们都从同一个流中读取会导致问题。

移除扫描仪并更改获取第一个数字的方式：

```
String count = in.readLine();
int i = Integer.valueOf(count); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T22:50:06.947

可能是因为您尝试使用两个不同的阅读器阅读单个流。尝试使用 Integer.valueOf(in.readLine()) 而不是创建扫描仪并调用 sc.nextInt() 或仅使用扫描仪。

# c++ - 截断使用 fopen 打开的文件

> ID：10644348
> 
> 赞同：1
> 
> 时间：2012-05-17T22:28:43.223
> 
> 标签：c++, stdio

自从我不得不使用它已经很长时间了......我怎样才能截断`fopen()`在当前文件指针处打开的文件？

如果没有通用解决方案，我在 Windows 上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T22:37:23.377

由于您使用的是 Windows，请使用以下命令：

```
_chsize( fileno(f), size); 
```

或 64 位版本：

```
_chsize_s(_fileno(f), size); 
```

# php - 如何使用 eval() 函数来执行 base64 编码的脚本？

> ID：10644349
> 
> 赞同：0
> 
> 时间：2012-05-17T22:28:48.883
> 
> 标签：php, eval, decode, encode

请看下面的代码：

```
<?php
$str1 = 'My Name Is : ';
$str2 = 'Dvid!';
echo $str1.$str2;
?> 
```

只是一个简单的php代码。
我想编码（例如base64）这个php文件并使用编码的php文件而不是正常的。
所以上面代码的base64编码如下：

```
PD9waHANCiRzdHIxID0gJ015IE5hbWUgSXMgOiAnOw0KJHN0cjIgPSAnRHZpZCEnOw0KZWNobyAkc3RyMS4kc3RyMjsNCj8+DQo= 
```

现在我该如何使用那个编码的 php 文件？
我认为 eval() 函数就是答案！
所以我改变了这样的php文件以供使用：

```
<?php
$str = 'PD9waHANCiRzdHIxID0gJ015IE5hbWUgSXMgOiAnOw0KJHN0cjIgPSAnRHZpZCEnOw0KZWNobyAkc3RyMS4kc3RyMjsNCj8+DQo=';
eval("base64_decode(\$str);");
?> 
```

我的问题是我真的不知道为什么输出是空白的（白屏）？
我该如何解决这个问题？

**编辑 1：**
我在下面的答案之后使用 include 进行测试，但出现错误：

```
<?php
include 'data://text/plain;base64,PD9waHANCiRzdHIxID0gJ015IE5hbWUgSXMgOiAnOw0KJHN0cjIgPSAnRHZpZCEnOw0KZWNobyAkc3RyMS4kc3RyMjsNCj8';
?> 
```

和错误：
![那个错误](../Images/40bedb4fbdba05b51ec228b4e3713f53.png)

**重要说明：**
我正在寻找一种不对服务器配置进行任何更改的方法，因为发布后我们无法访问远程主机...

**编辑 2：**
我删除了

```
<?php
?> 
```

base64 编码的一部分-> 仍然有空白屏幕。

感谢关注

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:33:15.687

这里有两个问题：

1.  您正在评估代码：

    ```
    base64_decode($str); 
    ```

    什么都不做。

2.  里面还有`<?php`and`?>`标签，`eval`处理不了。

因此，一个有趣的解决方案是使用`include`PHP `data://`URI：

```
include 'data://text/plain;base64,PD9waHANCiRzdHIxID0gJ015IE5hbWUgSXMgOiAnOw0KJHN0cjIgPSAnRHZpZCEnOw0KZWNobyAkc3RyMS4kc3RyMjsNCj8+DQo='; 
```

请注意，您需要`allow_url_include`启用此功能才能正常工作。

# java - USB传输安卓

> ID：10644360
> 
> 赞同：0
> 
> 时间：2012-05-17T22:30:14.223
> 
> 标签：java, android, usb

我一直在尝试解决这个问题，但是我所看到的每种方法都行不通，我正在尝试将一些字符串数据发送到 USB 设备，该设备应该发回我想要的数据或发送返回大约 11 个字节的“错误命令”对吗？现在我回来的只有 2 个字节，1 和 192。我试图总共只发送 9 个字节，“$fdump G”和“/n”。无论我做什么，它都是行不通的。

这也是我的代码，我不确定如何将字节更改为字符串或字符，但是一旦我开始取回数据，我就会这样做，因为我知道要返回的内容至少是 11 个字节。

```
for(;;){//this is the main loop for transferring    

                String get = "$fDump G\n";
                l("Sending: " + get);

                byte[] by = get.getBytes();

                //This is where it sends
                l("out " + conn.bulkTransfer(epOUT, by, by.length, 500));

                //This is where it is meant to receive
                byte[] buffer = new byte[4096];
                l("in " + conn.bulkTransfer(epIN, buffer, 4096,500));

                StringBuilder byStr = new StringBuilder();

                //This shows what's coming in
                for(int i = 0; i < buffer.length; i++){
                    if(buffer[i] != 0){
                    byStr.append(buffer[i]);
                    l(byStr);}
                }
                //this shows the complete string
                l(byStr);

                if(mStop){
                    mStopped = true;
                    return;
                }
                l("sent "+counter);
                counter++;
                counter = (byte) (counter % 16);
            } 
```

我真的不知道为什么它不起作用。我在 Android 方面有很多技能，但我无法理解这一点。

enIN 和 enOUT 是端点：

```
epIN = usbIf.getEndpoint(i);

epOUT = usbIf.getEndpoint(i); 
```

conn 也是 USB 设备连接。

```
 UsbDevice dev = sDevice;
            if (dev == null)
                return; 
            UsbManager usbm = (UsbManager) getSystemService(USB_SERVICE);
            UsbDeviceConnection conn = usbm.openDevice(dev);
            l("Interface Count: "+dev.getInterfaceCount());
            l("Using "+String.format("%04X:%04X", sDevice.getVendorId(), sDevice.getProductId()));

            if(!conn.claimInterface(dev.getInterface(0), true)) 
                return; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T18:57:04.153

```
epIN = usbIf.getEndpoint(i);
epOUT = usbIf.getEndpoint(i); 
```

如果此处`i`（端点索引）对于两个调用具有相同的值，那么您最终将得到相同的端点。然而，端点有一个方向，不能用于发送**和**接收数据。由于该`bulkTransfer()`方法使用端点地址来确定您分别以两次读取或两次写入结束的方向。

请注意，接口中的端点索引与端点地址不匹配。接口是端点（具有硬件地址）的逻辑映射。我猜您可能想从 IN 端点 1（地址：0x81）读取并写入 OUT 端点 1（地址：0x01）。因此，您使用相同的值`i`但是 IN 1 和 OUT 1 不是同一个端点。

检查设备描述符以找出您要与之通信的端点。`UsbInterface.getEndpoint(0)`无论其物理地址如何，接口描述符之后的第一个提到的端点都可以访问。检查该端点的方向并适当地使用它。使用查找另一个端点`UsbInterface.getEndpoint(1)`（假设它们是一个接口中的两个第一个端点）。

顺便说一句：你的字节缓冲区太大了。批量传输数据包的最大大小对于全速设备是 64 字节，对于高速设备是 512 字节。

# facebook - facebook 发布图表操作

> ID：10644363
> 
> 赞同：0
> 
> 时间：2012-05-17T22:30:36.107
> 
> 标签：facebook, graph

我正在尝试从我的网站在 facebook 上发布图形操作，但未发布操作，并且 facebook 没有给出错误。它是在我（管理员）使用该网站时发布的，我该怎么办？我的意思是它是权限问题吗？我要求在 authentication 上提供 publish_actions 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:33:52.163

您必须提交操作以供批准。只要您尚未将操作发送到 Facebook，只有管理员才能看到打开的图表帖子。

[https://developers.facebook.com/docs/opengraph/opengraph-approval/](https://developers.facebook.com/docs/opengraph/opengraph-approval/)

# php - 使用元素列表查询

> ID：10644364
> 
> 赞同：0
> 
> 时间：2012-05-17T22:30:36.687
> 
> 标签：php, mysql

在我的 php 代码中，有一个变量包含一个由 ',' 分隔的 ID 列表（此变量最多可以包含 6000 个元素）：

```
$var = "12,54,452,122,543,82,11,756,2343,5676,122,995,21,5331,832,271885,19"; 
```

这是我在 mysql 中的用户表：

```
users: id, username, password 
```

返回具有该 ID 之一的所有用户表行的最佳查询是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-17T22:33:04.783

```
$query = 'SELECT *
            FROM users
           WHERE id IN (' . implode(',', array_map('intval', explode(',', $var))) . ')'; 
```

这是执行此操作的查询。只需以您更喜欢的任何方式执行它

PS：你从哪里得到那个字符串？您有机会需要了解范式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T22:35:18.167

在您的 SQL 语句中使用 IN 例如 SELECT * FROM yourtable WHERE id IN (' . $var . ')

# .net - MVC3 HttpPostedFileBase 第一次上传没有数据但随后做

> ID：10644367
> 
> 赞同：28
> 
> 时间：2012-05-17T22:30:42.520
> 
> 标签：.net, asp.net-mvc, asp.net-mvc-3, httppostedfilebase

问题的背景。

**编辑 3** 我可以验证这似乎在 Chrome 20 中再次起作用。谢谢！

**TLDR 更新**

**编辑 2** 经过进一步的研究，这似乎是 Chrome 19 中的一个错误。请参见此处：

[http://groups.google.com/a/chromium.org/group/chromium-bugs/browse_thread/thread/15bc4992bcd4be1d/b905e8de20ee58fa?lnk=raot](http://groups.google.com/a/chromium.org/group/chromium-bugs/browse_thread/thread/15bc4992bcd4be1d/b905e8de20ee58fa?lnk=raot)

没有什么比最新的错误更重要了！:-)

Firefox 最新版和 IE8/9 可以正常工作。Fiddler 日志显示了相同的行为，主要区别在于第二次 401 授权检查不会发送乱码的表单有效负载并且它按预期工作。

这听起来像是一个测试用例，并且正在修复中！因此，希望对于可能遇到此问题的任何人来说，这会有所帮助！

**结束 TLDR**

我有一个控制器操作，它只接收一个上传的文件，它是一个“事件”的 CSV 文件。在幕后，这个 CSV 被解析出来，变成事件对象，数据在数据库中同步。作为结果输出，系统会提示用户下载一个 Excel 电子表格，其中包含每行发生的所有错误。

这一切都在我的开发机器上本地运行良好。然而，一旦部署到 DEV 环境，我会得到不同的结果。第一次尝试上传文件导致流是，我在这里寻找的词是什么，不可读？它正确地报告了它的长度，但试图提取信息却一无所获。随后的读取确实有数据，并且一切都按预期工作。

我会给你相关的代码图片。首先，简化了生成的 HTML 表单：

```
<form action="/Events/ImportLocal" enctype="multipart/form-data" method="post">

<input id="uploadFile" name="uploadFile" type="file" />
<input type="submit" value="Upload Events" />    

</form> 
```

非常直接：

控制器动作（原谅我的混乱，我已经研究了几个小时了）：

```
[HttpPost]
public ActionResult ImportLocal(HttpPostedFileBase uploadFile)
{
    if (uploadFile == null || uploadFile.ContentLength <= 0)
    {
        BaseLogger.Info("uploadFile is null or content length is zero...");
        //Error content returned to user
    }

    BaseLogger.InfoFormat("Community Import File Information: Content Length: {0}, Content Type: {1}, File Name: {2}",
    uploadFile.ContentLength, uploadFile.ContentType, uploadFile.FileName);

//This logger line is always reporting as correct. Even on the attempts where I can't pull out the stream data, I'm seeing valid values here.
//EXAMPLE output on failed attempts:
//Import File Information: Content Length: 315293, Content Type: application/vnd.ms-excel, File Name: Export_4-30-2012.csv

    BaseLogger.InfoFormat("Upload File Input Stream Length: {0}", uploadFile.InputStream.Length);           
//This is reporting the correct length on failed attempts as well

//I know the below is overly complicated and convoluted but I'm at a loss for why the inputstream in HttpPostedFileBase is not pulling out as expected
//so I've been testing
        var target = new MemoryStream();
        uploadFile.InputStream.CopyTo(target);
        byte[] data = target.ToArray();
        BaseLogger.InfoFormat("File stream resulting length = {0}", data.Length);
//This reports correctly. So far so good.

        StringReader stringOut;
        var stream = new MemoryStream(data) {Position = 0};

        using (var reader = new StreamReader(stream))
        {
            string output = reader.ReadToEnd();
            BaseLogger.InfoFormat("Byte[] converted to string = {0}", output);
//No go...output is reported to be empty at this point so no data ever gets sent on to the service call below
            stringOut = new StringReader(output);
        }

        //Build up a collection of CommunityEvent objects from the CSV file
        ImportActionResult<Event> importActionResults = _eventImportServices.Import(stringOut); 
```

目标是将文本阅读器或字符串阅读器传递给服务方法，因为在幕后这是使用需要这些类型的 CSV 处理实现。

任何想法为什么第一个请求失败但后续工作？我觉得我需要一双全新的眼睛，因为我的想法已经枯竭。

最后一点，IIS 7.5 是通过 IIS Express 本地和目标服务器上的目标。

谢谢

**编辑**赏金：

我在这里复制我的赏金消息和每个请求的 Fiddler 输出

我对这个问题添加了一些评论。该问题似乎与 NTLM 有关。我在 Fiddler 中看到的是带有有效表单数据的请求 1 上的 401 Unauthorized（我的理解是，在仅启用 Windows 身份验证的情况下，前两个 401 Unauthorized 请求是“正常的”；请验证？）。列出的请求 2 再次是具有相同表单数据的 401，除了上传的文件数据现在只是一堆框，完全相同大小的数据，只是不是确切的上传数据。请求 3 是包含乱码数据的 200 OK，这就是我的控制器操作得到的结果。如何让 NTLM 与文件上传配合得很好？

这是每个请求的 Fiddler 输出：

要求 1) ![在此处输入图像描述](../Images/c7c7aee05bba6c1d11a49243966c6ef4.png)

要求 2) ![在此处输入图像描述](../Images/d1ee8840df0c3ef57855967d8c699317.png)

最后请求 3 即已处理的 HTTP 200 OK ![在此处输入图像描述](../Images/5a554fbfd29377b2647238afc62670a6.png)

**编辑 2** 经过进一步的研究，这似乎是 Chrome 19 中的一个错误。请参见此处：

[http://groups.google.com/a/chromium.org/group/chromium-bugs/browse_thread/thread/15bc4992bcd4be1d/b905e8de20ee58fa?lnk=raot](http://groups.google.com/a/chromium.org/group/chromium-bugs/browse_thread/thread/15bc4992bcd4be1d/b905e8de20ee58fa?lnk=raot)

没有什么比最新的错误更重要了！:-)

Firefox 最新版和 IE8/9 可以正常工作。Fiddler 日志显示了相同的行为，主要区别在于第二次 401 授权检查不会发送乱码的表单有效负载并且它按预期工作。

这听起来像是一个测试用例，并且正在修复中！因此，希望对于可能遇到此问题的任何人来说，这会有所帮助！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T04:18:20.090

这只是一个尝试的想法。注意 StreamReader 有很多构造函数：

[http://msdn.microsoft.com/en-us/library/system.io.streamreader.aspx](http://msdn.microsoft.com/en-us/library/system.io.streamreader.aspx)

在某些构造函数中，它会尝试自动检测编码（如果指定），如果无法检测到，则回退到指定的编码。使用的构造函数使用 UTF-8 编码。您可以更改构造函数以自动检测编码，如果没有，则使用 UTF-8。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T09:51:56.350

好问题。身份验证是我想到的第一件事。获得两个未授权和第三个授权是正常的。这正是 NTLM 的工作方式。

如果需要让它在 Chrome 上也能工作并且不能等待修复，我建议启用表单身份验证，该身份验证重定向到同一个域但在不同的端口上，带有 Windows 身份验证的 LOGIN 应用程序所在的端口。此应用程序设置或不设置表单 cookie 并将您发送回您的主应用程序。该过程在这里得到了很好的描述：http: [//msdn.microsoft.com/en-us/library/ms972958.aspx](http://msdn.microsoft.com/en-us/library/ms972958.aspx)

这样，您的 NTLM 完成一次，然后您就有了一个 cookie，因此 NTLM 不会与您的 POST 请求一起使用，并且一切都应该按预期工作。

只是想我会分享这个:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T10:06:13.940

我认为您需要检查上传文件的 IIS 文件夹/虚拟网站的权限，如果它们位于不同的位置，则需要检查它们本身。

# java - Java-ee 编程；与 JPA 混淆 2 个表

> ID：10644369
> 
> 赞同：0
> 
> 时间：2012-05-17T22:30:42.970
> 
> 标签：java, hibernate, jakarta-ee, servlets, jpa

我正在使用 JPA 来保存数据。我是整个 Java-ee 编程的新手，所以如果我做错了，请告诉我。我有 2 个对象。活动和门票。用户将添加新活动并选择该活动的门票数量。然后我将在事件表中创建一个条目。此外，根据该活动的门票数量，我将在门票表中创建如此多的条目。我很困惑在创建事件时创建票证的这种逻辑是否应该存在于 servlet 或会话 bean 中。我有单独的会话 bean 用于事件和票证。我不确定我应该有 2 个会话 bean 还是只有 1 个 bean。对此的任何指示都会非常有帮助。

代码

```
@Entity
public class Event {    
@Id
@GeneratedValue(strategy = GenerationType.AUTO)
private Long eventId;
private String name;
@OneToMany(mappedBy = "event", cascade = CascadeType.ALL)
private Set<Ticket> tickets;

    //getter and setters here
}    

@Entity
public class Ticket {
@Id
@GeneratedValue(strategy = GenerationType.AUTO)
private Long ticketId;
@ManyToOne
@JoinColumn(name = "event_id", nullable=false)
private Event event;

//getters and setters
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:50:14.700

您的主要逻辑应该在您的 EJB 中，而不是在您的控制器/servlet 中。您的 EJB 应该为您的主要用例提供方法。您应该只将表示逻辑放入 servlet、格式化数据以进行显示和处理用户操作。

另请参阅：[会话外观模式](http://java.sun.com/blueprints/corej2eepatterns/Patterns/SessionFacade.html)

至于bean的数量，那是你的选择，你可以从一个开始，如果它变得太乱，你可以重构。

另外，我不确定您是否应该在创建活动时创建门票。一个事件可以有一个字段，说明有多少票可用，您可以在用户购买时创建一张票，或类似的东西。

# javascript - 当 webdriverjs 从不调用延续，只是挂起时该怎么办？

> ID：10644370
> 
> 赞同：5
> 
> 时间：2012-05-17T22:30:47.530
> 
> 标签：javascript, webdriver, selenium-webdriver

我正在运行 webdriverjs 并遇到 webdriver 闲置并且似乎停止运行事件的问题。我正在使用 webdriver 启动一个新浏览器，然后该浏览器中的代码连接到 webdriver 会话并运行测试命令。

这似乎工作正常，但是使用一些命令序列，webdriver 就会停止。例如，在我的测试中：

```
driver.findElement(my_element).then(function(element) {
  console.info("found");
  element.getTagName().then(function(name) {
    console.info("got tag name", name);
  });
}); 
```

浏览器输出第一个“找到”日志行，而不是第二个“得到标签名称”。Webdriver 似乎没有失败 - 日志中没有异常，如果我在`getTagName`promise 上注册 errback，它永远不会被调用。它根本就不会发生。

webdriver 实例是一个 selenium-standalone-server。查看它的日志，我看到了第一个`findElement`请求：

```
12:59:43.382 INFO - Executing: [execute script: return (function lookupElement(id) {
  var store = document["$webdriver$"];
  if(!store) {
    return null
  }
  var element = store[id];
  if(!element || element[id] !== id) {
    return[]
  }
  return[element]
}).apply(null, arguments);, [51d37tw]] at URL: /session/1337200865492/execute)
12:59:43.393 INFO - Done: /session/1337200865492/execute 
```

但是我从来没有看到第二个请求，所以看起来 webriver JS 永远不会最终调用服务器。

我正在逐步浏览 webdriver 代码以查看发生了什么，但是该`promise`框架使用了大量的闭包，并且很难有效地检查状态。有没有人熟悉这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:16:04.360

这是 WebdriverJS 中的一个错误，已由 selenium 团队确认并修复。请参阅[http://code.google.com/p/selenium/issues/detail?id=3930](http://code.google.com/p/selenium/issues/detail?id=3930)

# objective-c - 设备无连接时发出警报

> ID：10644373
> 
> 赞同：0
> 
> 时间：2012-05-17T22:31:11.257
> 
> 标签：objective-c, ios, networking, reachability

如果用户未连接到 Internet，我想显示警报。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:46:22.653

您应该查看 Apple 的[Reachability 示例代码](http://developer.apple.com/library/ios/samplecode/Reachability/index.html)并使用 Reachability 类来测试连接状态。

# c# - 为什么 MVC 视图无法访问项目内部的常量

> ID：10644376
> 
> 赞同：0
> 
> 时间：2012-05-17T22:31:40.260
> 
> 标签：c#, .net, asp.net-mvc-3, constants, access-modifiers

我今天在工作中遇到的事情，我试图制作一个在类中使用常量的视图，以构造查询字符串。当常量是公共的但不是当常量是内部的时，代码工作得很好。

这是模型：

```
public class LookupListModel
{
    internal const string ContactGroupTypeList = "ContactGroupType";

    // The below works fine
    //public const string ContactGroupTypeList = "ContactGroupType";
} 
```

视图（正确的@using 位于顶部）：

```
<li>@Html.ActionLink("Contact group types", "Lookup", new { list = LookupListModel.ContactGroupTypeList })</li> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:33:27.880

该视图被编译到另一个程序集中，这就是为什么`internal const`不起作用。

# android - 使用 SimpleCursorAdapter 如何从数据库中查询特定数据

> ID：10644378
> 
> 赞同：0
> 
> 时间：2012-05-17T22:31:50.463
> 
> 标签：android, sqlite, cursor, simplecursoradapter

我有一个数据库，我想从中查询并仅显示具有一种类似字段的数据。假设所有行中都有一天（星期一到太阳）...我想显示所有具有星期一的行作为一天...我已经使用 SimpleCursorAdapter 来显示我的数据库中的所有行...基本上，我想知道如何在 SimpleCursorAdapter 中查询以显示数据行，只说星期一是一天...

任何帮助表示赞赏... :)

以下代码使我能够显示数据库中的所有数据...

```
 protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.testlayout2);
     listContent = (ListView)findViewById(android.R.id.list);//.id..list);
    mDB = new DataSource(this);
    mDB.open();

    cursor = mDB.queueAll();
    String[] from = new String[]{
            MySQLiteHelper.KEY_START, MySQLiteHelper.KEY_END,
            MySQLiteHelper.KEY_SUBJECT, MySQLiteHelper.KEY_LOC,
            MySQLiteHelper.KEY_TEACHER };
    int[] to = new int[] {R.id.tvStart, R.id.tvEnd,
            R.id.tvSub, R.id.tvLoc, R.id.tvTeacher };

            cursorAdapter = new SimpleCursorAdapter(this, R.layout.row, cursor,
            from, to);

        listContent.setAdapter(cursorAdapter);
        listContent.setOnItemClickListener(listContentOnItemClickListener);
    }

} 
```

我希望查询是这样的..

```
 Cursor cursor = db.query(table, null, "day like " + "'%Monday%'",null, 
                                 null, null, null); 
```

明白了……抱歉给你添麻烦了。请告诉我我哪里出了问题..我在代码中做了这个来查询日期并按时间升序排序..

```
 public Cursor queryDay(String days) {
    Cursor cursor = mDatabase.query(DATABASE_TABLE, mAllColumns, "day like " + 
                     days, null, null, null, Database.KEY_START + " ASC");
    if (cursor.moveToNext()) {
        return cursor;
    }
    return cursor;
} 
```

但是，我收到此错误，

```
 android.database.sqlite.SQLiteException: no such column: Thursday: , 
   while compiling: SELECT _id, day,start_time, end_time, sub, location, 
   teacher FROM subjectTable WHERE day like Thursday ORDER BY start_time ASC 
```

我这样称呼这个..

```
 Cursor cursor = mDB.queryDay("Thursday");
 startManagingCursor(cursor); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:04:04.997

您不查询适配器，而是查询数据库，它提供了一个游标，您将其倒入列表适配器中。

```
mDbHelper.rawQuery("SELECT * FROM your_table WHERE day_column = 'Monday'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T10:22:35.980

这解决了问题的第二部分..

```
 public Cursor queryDay(String days) {
    Cursor cursor = mDatabase.query(DATABASE_TABLE, mAllColumns, "day like " 
     + "'" + days + "'", null,null, null, Database.KEY_START + " ASC");
    if (cursor.moveToNext()) {
        return cursor;
    }
    return cursor;
} 
```

# c# - 我可以在生产环境中使用 webapi 吗？

> ID：10644379
> 
> 赞同：1
> 
> 时间：2012-05-17T22:31:56.063
> 
> 标签：c#, asp.net, asp.net-mvc-3, rest, asp.net-web-api

最近，我正在研究在客户项目中使用 Microsoft 的新[Web Api 框架](http://www.asp.net/web-api)用于 REST http 服务的能力。但是，我相信 API 只是测试版，还没有完全发布。我的应用程序当前在 .net 4.0 上运行并使用 MVC3。我对此有几个问题：

它适用于 MVC3、.Net 4.0 吗？

在生产中使用 WebApi 的许可含义是什么？我的客户过去一直担心在生产中使用 beta 产品，所以我需要能够说服他们使用它没有风险或问题。

我希望使用 Web Api，因为它似乎完全符合我的要求。或者，我将不得不考虑 WCF 数据服务。或者是否有另一种替代方案来产生 REST 服务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:37:48.180

1.  它确实适用于 .NET 4.0。
2.  Web API 是 MVC4 的一部分。虽然我认为它可以在 MVC3 应用程序中工作，但我不认为它得到官方支持。
3.  beta 版本有一个“上线”许可证，这意味着它可以在生产中使用 - 但它是一个 beta 版本，所以它不受官方支持。此外，最终的框架肯定会发生变化，因此在 Beta 中工作的代码可能无法在最终版本中工作。该项目现已开源，因此您可以在[http://aspnetwebstack.codeplex.com](http://aspnetwebstack.codeplex.com)上查看最新信息。
4.  创建 REST 服务还有许多其他选择。普通的 WCF 工作，如果您想主要公开 DB 支持的数据，WCF 数据服务很有趣，并且还有一些非 Microsoft 堆栈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T22:38:09.560

请参阅 %ProgramFiles(x86)%\Microsoft ASP.NET\ASP.NET MVC 4\eula.rtf 中的 EULA

它是这样说的：

> 如果您遵守这些许可条款的其余部分，您还可以向第三方分发或部署第三方以通过 Internet 访问您使用该软件开发的 ASP.NET 程序，前提是...

所以基本上这是肯定的。

# apache-flex - 使用 FMS 和 Flex 从网络摄像头直播视频

> ID：10644380
> 
> 赞同：0
> 
> 时间：2012-05-17T22:31:57.903
> 
> 标签：apache-flex, video, flash-builder, flash-media-server

我正在尝试使用 FMS 从网络摄像头直播我的视频。我已经在这里编写了我正在尝试使用的代码，但是我收到了这个错误。请指导我找到正确的解决方案。我非常感谢我能得到的所有帮助。

错误：错误 #2044：未处理的 AsyncErrorEvent：。text=Error #2095: flash.net.NetConnection 无法调用回调 onBWDone。error=ReferenceError: 错误 #1069: 在 vv 上找不到属性 onBWDone 并且没有默认值。在 vv/button2_clickHandler()[] 在 vv/___vv_Button2_click()[]

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600">
    <fx:Script>
        <![CDATA[
            import mx.controls.Alert;
            import mx.events.FlexEvent;

            var camera:Camera = Camera.getCamera();
            var localCam:Video = new Video(420,313);
            protected function video_d_creationCompleteHandler(event:FlexEvent):void
            {
                // TODO Auto-generated method stub

                if (camera) {
                    //var localCam:Video = new Video(280,150);
                    localCam.attachCamera(camera);
                    localCam.smoothing = true;
                    //localCam.
                    video_d.addChild(localCam);
                } else {
                    Alert.show("You don't seem to have a camera.");
                }
            }

            protected function button2_clickHandler(event:MouseEvent):void
            {
                // TODO Auto-generated method stub
                lsfmspanel.visible = true; 

                var nc:NetConnection = new NetConnection();
                nc.client = this;
                nc.connect("rtmp://localhost/live");
                nc.addEventListener(NetStatusEvent.NET_STATUS, netStatusHandler);

                function netStatusHandler(event:NetStatusEvent):void {
                    switch (event.info.code) {
                        case "NetConnection.Connect.Success":
                            var ns:NetStream = new NetStream(nc,NetStream.CONNECT_TO_FMS);
                            ns.addEventListener(AsyncErrorEvent.ASYNC_ERROR, asyncErrorHandler);
                            ns.addEventListener(AsyncErrorEvent.ASYNC_ERROR, onBWDone);
                            ns.attachCamera(camera);
                            ns.publish("livestream", "live");

                            break;
                        case "NetStream.Play.StreamNotFound":
                            trace("Unable to locate video: ");
                            break;
                    }
                }

                function asyncErrorHandler(event:AsyncErrorEvent):void { Alert.show("E." + event.text); }
                function onBWDone(event:AsyncErrorEvent):void{
                    trace("onBWDone");
                }

            }

        ]]>
    </fx:Script>
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>
    <s:Panel x="5" y="9" width="448" height="365" title="Live Stream">
        <s:VideoDisplay id="video_d" x="10" y="9" width="426" height="313"
                        creationComplete="video_d_creationCompleteHandler(event)"/>
    </s:Panel>
    <s:Panel x="462" y="9" width="448" height="365" title="Live Streaming From FMS" visible="false" id="lsfmspanel">
        <s:VideoDisplay id="livestream" x="10" y="9" width="426" height="313" source="rtmp://localhost/live" autoPlay="true"/>
    </s:Panel>
    <s:Button x="105" y="382" label="Start Streaming" click="button2_clickHandler(event)"/>

</s:Application> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T05:53:11.210

为什么不使用 Flash Media Encoder 将视频流式传输到 FMS。您可以使用 Flash Media Encoder 应用程序或控制台命令。

# php - WordPress 导航中的动态 URL

> ID：10644384
> 
> 赞同：0
> 
> 时间：2012-05-17T22:32:25.213
> 
> 标签：php, wordpress

所以我目前有一些带有以下导航链接的 Wordpress：

链接 1 | 链接 2 | 链接3等

两件事，首先我试图在链接 2 和链接 3 之间添加一个链接。我正在使用此代码，但它将链接添加到无序列表的末尾。有没有办法指定它的位置？

```
 add_filter( 'wp_nav_menu_items', 'your_custom_menu_item', 10, 2 );
function your_custom_menu_item ( $items, $args ) {

        $items .= '<li><a href=#">Test Link</a></li>';
    return $items;
} 
```

其次，我希望这个新链接有一个包含用户 ID 的动态 URL。我已经尝试查找有关`get_currentuserinfo();`wordpress 的信息，但我似乎无法找到将其包含在函数中的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-23T20:26:32.947

我在 functions.php 页面中向 wp_nav_menu 添加了一个过滤器：

```
function wp_username_in_nav( $menu ){
    global $current_user;
    return $menu = str_replace('--username--', $current_user->user_login, $menu );
}
add_filter( 'wp_nav_menu', 'wp_username_in_nav' ); 
```

然后在我的菜单中，我添加了一个带有如下 URL 的链接菜单项：/rootfolder/members/--username--/profile/edit/

这使我能够动态地将用户名添加到菜单项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T22:38:02.180

1.  您可以使用 add_filter 指定过滤器优先级，尝试使用该值`10`，直到您的导航项目位于正确的位置。

2.  您需要`$current_user`在调用该函数之前设置一个全局变量。

### 代码

```
global $current_user;
get_currentuserinfo();

echo 'Username: ' . $current_user->user_login . "\n"; 
```

# grid - 如何创建 Photoshop 脚本以将图层划分为单独图层的网格

> ID：10644385
> 
> 赞同：1
> 
> 时间：2012-05-17T22:32:39.230
> 
> 标签：grid, photoshop, slice, divide

我一直在寻找解决方案，但我认为如果不编写脚本这是不可能的。我想做的是把一个photoshop图层分成一个正方形网格，每个正方形都是一个单独的图层（例如，一个100px x 100px的图像分成100个10px x 10px的正方形，每个正方形都是一个单独的图层）。

我知道我可以将图像切成网格并将每个正方形导出为单独的图像，但我希望每个正方形保持它的位置，所以当所有图层都可见时，它会无缝地形成原始图像（就像一堆正方形拼图）。

任何帮助，将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:36:06.143

1.  我想这就是你要找的东西：[瓷砖切割机脚本](http://www.bram.us/2012/04/23/photoshop-google-maps-tile-cutter-script/)

2.  然后，您可以将所有堆叠的图块导入到新图像中：[Great Tutorial](http://digidelights.blogspot.co.uk/2011/08/load-files-into-stack-quick-ps-tutorial.html)

3.  将所有图块堆叠在图层中，您可以运行：[分层 -> 网格脚本](http://www.personal.psu.edu/zez1/blogs/my_blog/2011/05/scripts-4-photoshop-file-sequence-to-layers-to-sprite-sheet.html)

诀窍是合并 1 和 3

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:52:57.943

有人在 SuperUser 论坛中回复并给我写了一个非常好的脚本。完全符合我的需要，它可以完美地适应不同大小的正方形和不同大小的文档。

[https://superuser.com/questions/425811/is-it-possible-in-photoshop-to-convert-slices-into-photoshop-layers](https://superuser.com/questions/425811/is-it-possible-in-photoshop-to-convert-slices-into-photoshop-layers)

# windows-8 - 从 Win8 Metro 应用程序编译 Win8 应用程序（并可能在沙盒中运行）

> ID：10644397
> 
> 赞同：1
> 
> 时间：2012-05-17T22:34:18.283
> 
> 标签：windows-8

我有一个奇怪的问题。是否有可能**CodeDom**或**Emit**从 Win8 Metro 应用程序中编译 Win8 Metro 应用程序（.NET 或 HTML5/JS）然后运行它（不安装它，只运行它直到用户关闭它/停止它）？我想这是一种 MEF 式的需求。

我还没有找到任何关于这种需求的参考资料。我试图了解**Rosetta**是什么/做什么，但在理解它比 CodeDom 或 Emit 更好/不同以及它是否可能是我正在寻找的东西方面还没有走得太远。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-19T21:45:05.680

不能。Windows 8 Metro 风格应用只能访问 Core Profile（完整 .NET Framework 的子集）中的 .NET Framework 类。System.CodeDom 不是核心配置文件的一部分。如果您安装了 Win8 CP 机器，您可以[在](http://wiki.sharpdevelop.net/ILSpy.ashx)...

```
C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETCore\v4.5\ 
```

查看来自 Build[的 .NET 开发人员对 Windows 8 应用程序开发的看法，](http://channel9.msdn.com/Events/BUILD/BUILD2011/TOOL-930C)以讨论适用于 Metro 风格应用程序的 .NET 配置文件。

# oracle - 在过程之间传递数组

> ID：10644406
> 
> 赞同：0
> 
> 时间：2012-05-17T21:57:50.490
> 
> 标签：oracle, stored-procedures

我已经在这里和网上搜索了解决方案，但它们似乎只是导致我太缺乏经验的其他错误（第一个构建是在 PHP 中，现在我必须将它移动到存储过程）。我有一张我的校园地图，当用户点击一座建筑物时，会弹出一个信息气泡以显示一些信息和一个图片库。图片的地址存储在一个表中，因此我需要将它们返回到一个数组中，以便循环遍历它们。获取列表的调用是：

```
$.ajax({ //get the picture URLs, load into array
        type: "post",
        url: "video_tour.get_pics",
        data: { pBldg_id:  building
        },
        error: function(xhr,thrownError) { alert("error get pics"); },
        success: function(data){
                  $.each(data, function(index,obj) {
                         picArray[index] = obj.ADDRESS;
                  });
        }
});//and ajax for pic load 
```

和被调用的程序：

```
procedure get_pics(pBldg_id int) is
     type array_varchar is table of varchar2(2000) index by binary_integer;

     array_of_pics array_varchar;
     v_counter int := 0;
begin

for i in(select address from ucs.campus_pictures where building_id = pBldg_id and thumbnail = 1) loop
     array_of_pics(v_counter) := i.address;
     v_counter := v_counter + 1;
end loop;               

end get_pics; 
```

我怎样才能将 array_of_pics 带回 ajax 调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T01:50:41.480

我假设您有一些处理请求然后调用过程的中间件（即使它是一个 PHP 页面）。从那里开始，您实际上想要返回一个游标（参见下面的示例）。在您的中间件中，您将遍历来自光标的结果集。

```
 create or replace function get_pics(bldg_id_in ucs.campus_pictures.building_id%TYPE)
return sys_refcursor
as
ref_cursor sys_refcursor;
begin
   open ref_cursor for
     select address from ucs.campus_pictures where building_id = bldg_id_in and thumbnail = 1;
   return ref_cursor;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:27:50.490

所以它并不像看起来那么复杂，我只需要打印出来的数据并添加一个分隔符：

```
 for i in(select address from ucs.campus_pictures where building_id = pBldg_id and thumbnail = 1) loop
htp.prn(i.address || ';');
end loop; 
```

并在 ajax 调用中创建一个数组：

```
 $.ajax({ //get the picture URLs, load into array
                     type: "post",
                     url: "video_tour.get_pics",
                     data: { pBldg_id:  building
                     },
                     error: function(xhr,thrownError) { alert("error get pics"); }, 
                     success: function(data){
                      $.each(data.split(";"), function(index,obj) {
                                    picArray[index] = obj;
                              });

                     }
            }); 
```

感谢大家抽出宝贵时间提供帮助！

# magento - 在外部登录页面上显示具有非默认主题的 Magento 块

> ID：10644407
> 
> 赞同：1
> 
> 时间：2012-05-17T22:35:39.227
> 
> 标签：magento

我正在开发一个可以在 Magento 之外访问的静态 php 登录页面，并且我正在尝试使用非默认主题来拉取 Magento 块。

我可以使用默认主题来显示该块，但我不确定如何指定要使用的备用主题。两个主题都设置在同一个包中。

这是我迄今为止所拥有的：

```
require_once 'app/Mage.php';
umask(0);
$layout = Mage::app()->getLayout();
$layout->getUpdate()->addHandle($handles)->load();
$layout->generateXml()->generateBlocks();
$layout->getBlock('topLinks')->toHtml(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T00:07:07.240

你不会直接通过“主题”来做到这一点。您需要使用包含您要使用的主题的商店代码。例如，如果您的商店代码为“Main Store”，商店视图为“English”，那么您需要`Admin -> System -> Configuration -> Design -> Themes`在更改当前配置范围后设置主题。

之后，您可以在代码`Mage::app()`部分中指定商店代码，如下所示：

```
 $layout = $Mage::app('YOUR_STORE_CODE')->getLayout(); 
```

你的代码对我来说是错误的。您需要将其指定`$handles`或设置为`default`.

这是一篇很好的帖子，可能会有所帮助： http: [//www.magentocommerce.com/boards/viewthread/262102/#t352798](http://www.magentocommerce.com/boards/viewthread/262102/#t352798)

# java - 如何从文件夹中包含的 jsp 转到 servlet

> ID：10644408
> 
> 赞同：2
> 
> 时间：2012-05-17T22:35:39.570
> 
> 标签：java, jsp, servlets, post, web.xml

我有问题，找不到信息。

我从在“web”文件夹中找到的 jsp 页面运行我的 web 应用程序。并尝试像这样去servlet Smth

```
<form action="MyServlet" method="post">
            <input type="submit" name="command" />
</form> 
```

在 web.xml 下

```
<servlet>
        <servlet-name>MyServlet</servlet-name>
        <servlet-class>mypackage.MyServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>MyServlet</servlet-name>
        <url-pattern>/MyServlet</url-pattern>
</servlet-mapping> 
```

我认为这应该可以，但是当我运行我的应用程序时，我看到按钮的下一个 url ![例子](../Images/2f8ae2724a23f12b32068e1c1a4b5b03.png)

但我的目标是获取 url localhost:8080/TomcatApp/MyServlet

我尝试使用 GlassFish 和 Apache Tomcat 7 来实现。我不知道。你能帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T23:03:26.907

表单的操作是相对于当前页面的路径。因此，如果您的 JSP 位于 at `/TomcatApp/folder/some-page.jsp`，只需将操作设置`MyServlet`为 ，`/TomcatApp/folder/MyServlet`因为它会自动使用当前路径作为基础。要获得公正`/TomcatApp/MyServlet`，您需要将表单的操作设置为`../MyServlet`或`${request.contextPath}/MyServlet`。

# c# - List.Add() 仅保存最后添加的项目的问题

> ID：10644412
> 
> 赞同：4
> 
> 时间：2012-05-17T22:35:55.397
> 
> 标签：c#

我注意到的问题是这行代码：

```
tempList.Add(orderables); 
```

在这个完整的代码中：

```
AssociatedComboItems ai = new AssociatedComboItems();
List<Orderables> tempList = new List<Orderables>();
Orderables orderables = new Orderables();

foreach (var t in comboBox1.Items)
{
    ai.ComboBoxItem = t.ToString();

    for (int i = 0; i < fpSpread1.ActiveSheet.RowCount; i++)
    {
        orderables.Display = fpSpread1.ActiveSheet.Cells[i, 1].Text;
        orderables.ShowInDSR = (bool)fpSpread1.ActiveSheet.Cells[i, 0].Value;
        orderables.DisplayOrder = i;
        tempList.Add(orderables);
    }

    ai.AssociatedItems = tempList;
    tempList.Clear();
    if(AssociatedItems == null)
    AssociatedItems = new List<AssociatedComboItems>();
    AssociatedItems.Add(ai);
} 
```

当我将断点放在上面提到的`tempList.Add(orderables);`行`templist`（第二次它会将正确的项目添加到列表中**，但是**如果我将鼠标悬停在`tempList`上面并想查看它的内容，尽管它有两个项目，但它们都是相同的 - 它们现在都是添加到列表中的第二个项目. 它已经覆盖了第一个。

我无法弄清楚这出了什么问题以及为什么会发生。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-17T22:38:37.830

您需要在for 循环`Orderables` **内实例化；**否则，您将在所有迭代中继续重用相同的实例（并且每次都覆盖其属性）。

```
AssociatedComboItems ai = new AssociatedComboItems();
List<Orderables> tempList = new List<Orderables>();

foreach (var t in comboBox1.Items)
{
    ai.ComboBoxItem = t.ToString();

    for (int i = 0; i < fpSpread1.ActiveSheet.RowCount; i++)
    {
        Orderables orderables = new Orderables();  // ← Instantiate here
        orderables.Display = fpSpread1.ActiveSheet.Cells[i, 1].Text;
        orderables.ShowInDSR = (bool)fpSpread1.ActiveSheet.Cells[i, 0].Value;
        orderables.DisplayOrder = i;
        tempList.Add(orderables);
    }

    ai.AssociatedItems = tempList;
    tempList.Clear();
    if(AssociatedItems == null)
    AssociatedItems = new List<AssociatedComboItems>();
    AssociatedItems.Add(ai);
} 
```

与问题无关：您可能会发现[对象初始值](http://msdn.microsoft.com/en-us/library/bb384062.aspx)设定项语法更简洁：

```
Orderables orderables = new Orderables
{
    Display = fpSpread1.ActiveSheet.Cells[i, 1].Text,
    ShowInDSR = (bool)fpSpread1.ActiveSheet.Cells[i, 0].Value,
    DisplayOrder = i,
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-17T22:38:31.123

问题是您只有一个可订购的实例，并且您不断更改同一个实例并将其重新添加到列表中。列表中的每个引用都指向同一个对象。将 orderables 声明移到*内部*for 循环中，它将解决问题。

# php - Codeigniter cookie 未设置？

> ID：10644413
> 
> 赞同：3
> 
> 时间：2012-05-17T22:36:01.637
> 
> 标签：php, codeigniter, cookies

在尝试使用 codeigniter 设置 cookie 很长一段时间没有成功后，我做了这个简单的测试以确保它们正常工作。我阅读了 CI 的关于 cookie 的文档，发现它相当缺乏。有人请告诉我怎么了？

```
 $this->input->set_cookie('test', 'testing a lot');

 echo $this->input->cookie('test'); 
```

是的，我正在加载 cookie 助手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T11:41:44.330

如果您不打算使用简写函数别名，则不需要加载 cookie 帮助程序。

检查 config.php 文件中的 cookie 设置。尤其：

```
$config['cookie_path'] = "/"; 
```

如果这不起作用，只需使用 PHP 的本机函数来设置 cookie，您可能仍然可以使用 CI 的 input() 来检索它们。

```
setcookie("name", $value); 
```

# python - 在 Python 中覆盖特殊函数

> ID：10644417
> 
> 赞同：4
> 
> 时间：2012-05-17T22:36:26.590
> 
> 标签：python, inheritance

有没有办法覆盖python中内置类型的特殊函数？例如，我想创建一个继承自内置 dict 的 SpecialDict 类。我想允许用户为我的特殊字典中的键和值定义自定义验证函数，如下所示：

```
def __init__(self, keyValidator = True, valueValidator = True):
    self.keyValidator = keyValidator
    self.valueValidator = valueValidator 
```

使用它，我可以拦截更新方法中添加的值，如下所示：

```
def update(self,key,value):
    assert (self.keyValidator(key))
    assert (self.valueValidator(key))
    self[key] = value 
```

但是，如果有人决定继续使用 [] 作为访问权限，这将不起作用。或者，如果有人使用字典文字创建对象。

```
mySpecialDict = SpecialDict
mySpecialDict['hello'] = 54 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T00:17:12.990

有人*无法*将您的实例创建`SpecialDict`为字典文字，因为字典文字就是这样；一本普通的字典。

至于用方括号表示的设置项目，如`mySpecialDict['hello'] = 54`，仅对应于`mySpecialDict.__setitem__('hello', 54)`。同样，使用方括号表示法检索项目对应于方法的调用`__getitem__`。不管是什么阶级，这都是真的`mySpecialDict`；无论是普通字典、继承 builtin 的类`dict`，还是一些完全不相关的类。因此，您可以只实现这些方法来更改它们的功能（在需要时使用`super(SpecialDict, self).__setitem__(key, value)`或`dict.__setitem__(self, key, value)`引用正常实现）。

您将遇到的一个问题是，其他 dict 方法的某些（全部？）内置实现将不尊重您覆盖的`__setitem__`或`__getitem__`. 所以你将无法继承它们；您必须覆盖所有这些，或者根据您的基本操作版本完全重新实现它们，或者至少“围绕”超类调用运行您的验证。

一个不那么痛苦的方法实际上可能是*不*子类化内置字典，而是实现一个自定义的“类字典”对象，该对象*包装*一个普通字典，使用`collections.Mapping`或`collections.MutableMapping`基类来获取字典接口。使用这种方法，您只需要自己实现大约 6 个基本方法（您可以通过围绕对包装字典的调用插入验证逻辑来​​实现），并根据它们获得其他方法的合理定义。请参阅[http://docs.python.org/library/collections.html#collections-abstract-base-classes](http://docs.python.org/library/collections.html#collections-abstract-base-classes)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-17T22:46:37.070

你可以重写特殊方法`__getitem__`来实现你自己的`[]`操作符行为。有关更多信息，请参阅[此](http://docs.python.org/reference/datamodel.html#object.__getitem__)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T22:49:55.107

您可以覆盖[`__setitem__(self, key, val)`](http://docs.python.org/library/operator.html#operator.__setitem__) 方法，并使用[`super(SpecialDict, self).__setitem__`](http://docs.python.org/library/functions.html#super)来访问父对象的（即`dict`s）方法：

```
class SpecialDict(dict):
    def __init__(self, keyValidator = lambda x:True, valueValidator = lambda x:True):
        self.keyValidator = keyValidator
        self.valueValidator = valueValidator
    def __setitem__(self, key, val):
        assert (self.keyValidator(key))
        assert (self.valueValidator(val))
        super(SpecialDict, self).__setitem__(key, val) 
```

还请注意使用[lambdas](http://docs.python.org/reference/expressions.html#lambda)作为默认值：简单地使用`True`or`False`将导致错误，因为它们不可调用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-17T22:47:04.157

雷！

我在移动设备中，因此无法给出完整的答案，但请查看`__getitem__`并查看`__setitem__`

# java - 将字母转换为数字

> ID：10644420
> 
> 赞同：1
> 
> 时间：2012-05-17T22:37:16.143
> 
> 标签：java

假设我有一个将字母转换为数字的程序，这样：

输入：abcd

输出：1234

1.  如何有效地将 abcd 转换为 1234
2.  以及如何从令牌中提取每个单独的字符

顺便说一句，这不是家庭作业。（这是为了好玩）

这是我到目前为止所拥有的：

```
public class Test {
public static void main(String[] args) throws IOException  {

    BufferedReader f = new BufferedReader(new FileReader("test.in"));

    PrintWriter out = new PrintWriter(new BufferedWriter(new FileWriter("test.out.txt")));

    StringTokenizer st = new StringTokenizer(f.readLine());

    int i1 = Integer.parseInt(st.nextToken());

            // How can I convert this into integers? (where a = 1, b = 2, and c = 3)

            out.println(????);

        out.close();
        System.exit(0);                              

    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T22:40:36.987

尝试这个：

```
String s = "abcd";
StringBuilder sb = new StringBuilder();
for (char c : s.toCharArray()) {
    sb.append((char)(c - 'a' + 1));
}
// provided your string contains only lower case non-unicode (ASCII) characters. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T22:41:01.680

大写字母，将其转换为 ASCII，减去“A”，然后加 1。如果您正在处理多字符输入，则遍历字符串。当您根据之前的建议进行计算时，将之前的总和乘以 10，然后添加新值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T22:40:54.453

使用键定义为 a、b、c 等的地图，其值为 1、2、3 等。每当您收到令牌时，请从地图中获取并打印。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T22:42:41.563

我想这是您正在寻找的方法：`String`'s [charAt](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#charAt%28int%29)

一个示例代码可以满足您的需求：

```
String a="abcd";
for (int i = 0; i < a.length(); ++i) {
   System.out.print(a.charAt(i)-'a'+1);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-17T22:42:43.297

您可以尝试将 char 转换为 int 并休息 96，您必须处理超出范围的字符或使用正则表达式 ..

此示例将 abcd 转换为 1234

a 是 97 的字符 (alt + 9 7) z 是 122 的字符

A 是 char 65，因此您可以按范围处理或将单词转为小写

```
public static void main(String args[]){
        String abc = "abcd";
        String txt = "";

        for(int i=0; i<abc.length(); i++){
            txt+= ( (int)abc.charAt(i) - 96 );
        }

        System.out.println(txt);
    } 
```

编辑：

```
public static void main(String args[]){
        String abc = "AbCd";
        String txt = "";
        abc = abc.toLowerCase();

        for(int i=0; i<abc.length(); i++){
            int letter = (int)abc.charAt(i);

            if(letter<97 || letter > 122)//in range
            {
                txt += ( (int)abc.charAt(i) - 96 );
            }

        }

        System.out.println(txt);
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-17T22:39:36.080

Derp，我读错了整个问题。我的错。

你可以做的是，我想你有一个转换算法。字母表中的每个字母都可以具有字母表中的值。

然后你需要做的就是匹配你找到的字母，与你的一个字母一个字符串数组，得到它的索引，然后加1。然后你得到了价值。如果这就是你想玩的方式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-08T10:33:20.533

导入 java.util.Scanner；导入java.io.*；

公共类 LetteredNumerationSystem{

```
public static void main(String args[]){

File file = new File ("lettered.in");

    try{

    Scanner input = new Scanner(file);

    int dataCollect = input.nextInt();
    int sum=0;
    String lineInput ="";

      for(int i=0;i<=dataCollect;i++){
      while (input.hasNext()){
      lineInput=input.next();       
      char lineArray[] = lineInput.toCharArray();
         for(int j=0;j<lineArray.length;j++){
            if (lineArray[j] == 'A'){
              sum+=1;
            }
            else if (lineArray[j] == 'B'){
              sum+=10;
            }
            else if (lineArray[j] == 'C'){
               sum+=100;
            }
            else if (lineArray[j] == 'D'){
               sum+=1000;
            }
            else if (lineArray[j] == 'E'){
               sum+=10000;
            }
            else if (lineArray[j] == 'F'){
               sum+=100000;
            }
            else if (lineArray[j] == 'G'){
               sum+=1000000;
            }
            else if (lineArray[j] == 'X'){
               System.out.println(sum);
           sum=0;
            }
         }
        }
      }         
    }

    catch(FileNotFoundException e){
        System.out.println("ERROR");
        }   

} 
```

}

# ubuntu - Vala 找不到 gtk+-3.0 Ubuntu 12.04

> ID：10644425
> 
> 赞同：1
> 
> 时间：2012-05-17T22:37:40.973
> 
> 标签：ubuntu, compiler-errors, vala, gtk3

我刚刚开始学习 Vala（在 Ubuntu 12.04 下），我正在尝试学习[本](https://live.gnome.org/Vala/GTKSample)教程；但是，在第一个编译步骤 ( `valac --pkg gtk+-3.0 gtktut.vala`) 中，我收到此错误：

`error: gtk+-3.0 not found in specified Vala API directories or GObject-Introspection GIR directories`

除了这可能意味着我没有 GTK3 .vapi 文件（我的`/usr/share/vala/vapi`目录中没有）外，我似乎无法在 Internet 上找到任何有关此的信息；但是，如果它甚至是我的问题的原因，我什至不知道应该在哪里下载这个神话文件。据说它应该包含在我安装的 vala 编译器中。

同样，在编译语言方面，我是一个完全的新手，我已经尽力找到答案。

如何将 valac 指向必要的 gtk3 包？

**更新：**

我发现`gtk+-3.0.vapi`确实存在于`/usr/share/vala-0.16/vapi`；但是，它仍然没有被发现。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:07:00.583

我发现了问题。由于某种原因，valac-0.16 似乎无法使用自己的 GTK+3.0 vapi 文件或类似的东西。我更新了我的资源并安装了 valac-0.18，它运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-21T20:04:14.487

轻松运行：

sudo apt-get install gtk+-3.0-dev

# c++ - 从 pcl::PointCloud 创建 pcl::PointCloud::Ptr

> ID：10644429
> 
> 赞同：12
> 
> 时间：2012-05-17T22:38:13.783
> 
> 标签：c++, pointers, point-cloud-library

我想知道这是否可能。我有一个功能：

```
 pcl::PointCloud<pcl::PointXYZRGB> createPointCloud(std::Vector<Nodes> input) 
```

它返回一个点云。我想知道是否可以获取这个点云，并制作一个指向它的副本的指针。pcl 像这样指向云：

```
pcl::PointCloud<pcl::PointXYZRGB>::Ptr cloudPTR(new pcl::PointCloud<pcl::PointXYZRGB>) 
```

我试过这样做：

```
pcl::PointCloud<pcl::PointXYZRGB>::Ptr cloudPTR(createPointCloud(nodeList)) 
```

这会导致一个非常明显的错误，即。createPointCloud 不返回指向云的指针。

我也试过这个：

```
pcl::PointCloud<pcl::PointXYZRGB>::Ptr cloudPTR = &createPointCloud(nodeList) 
```

还有这个：

```
pcl::PointCloud<pcl::PointXYZRGB>::Ptr cloudPTR(&createPointCloud(nodeList)) 
```

这会导致编译错误：“获取临时地址”

是让函数返回指针类型的唯一选择，还是有办法做我要问的？

编辑：

以下两个答案都是正确的，我已经授予 Jonathon 正确的勾号，因为他这次是第一个进入的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-17T22:44:31.053

是的，使用[makeShared()](http://docs.pointclouds.org/trunk/classpcl_1_1_point_cloud.html#ab9db5c9a9d98d6256c510d436693ab5f)方法。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-07-20T15:57:29.907

我知道这是旧的，可​​能对 OP 不再有用，但其他用户可能会偶然发现它。我建议这样做：

```
pcl::PointCloud<pcl::PointXYZRGB>::Ptr cloudPTR(new pcl::PointCloud<pcl::PointXYZRGB>);
*cloudPTR = createPointCloud(nodeList); 
```

Jonathon 的回答很危险的原因是 Pointcloud::Ptr 是 boost::shared_ptr 的 typedef，这意味着指向对象的所有权。然而，在他的回答中，该对象实际上是一个局部变量，这意味着它可能会超出范围而仍有对其的引用，并且 shared_ptr 最终将对其调用 delete ，这是未定义的行为。

另一方面，使用 make_shared() 对云进行深度复制。该程序将正常运行，但如果您不需要额外的副本，那么它远非最佳。

# java - 未读取数组中的文本

> ID：10644430
> 
> 赞同：0
> 
> 时间：2012-05-17T22:38:13.863
> 
> 标签：java

我正在尝试创建一个 IRC Bot，下面是代码，但是，当它运行时，无论我尝试什么，它都不会检测到“001”，我在 JRE6 上运行它并使用 JDK6。我正在使用 Eclipse 开发它并使用调试功能来运行它。我已经尝试过“java.exe”和“javaw.exe”。运行时，debugex 显示 001 明显存在。

这是我的代码：

```
package bot;
import java.io.*;
import java.net.*;
public class Main {
    static PrintWriter out = null;
    @SuppressWarnings("unused")
    public static void main(String[] args) {
        Socket sock = null;
        BufferedReader in = null;
        try {
            sock = new Socket("irc.jermc.co.cc",6667);
            in = new BufferedReader(new InputStreamReader(sock.getInputStream()));
            out = new PrintWriter(sock.getOutputStream(), true);
        } catch (UnknownHostException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        boolean sentconnect = false;
        while(sock.isConnected() == true){
            if(sentconnect == false){
                writeout("NICK GBot");
                writeout("USER GBot GBot GBot :GBot");
                sentconnect = true;
            }
            String data = "";
            try {
                data = in.readLine();
            } catch (IOException e) {
                e.printStackTrace();
            }
            data = data.trim();
            if(data != ""){
                System.out.println("[IN] " + data);
            }
            String[] ex;
            ex = data.split(" ");
            for(String debugex : ex){
                //System.out.println("DEBUGEX: " + debugex);
            }
            if(ex[1] == "001"){
                writeout("JOIN #minecraft");
            }
            try {
                Thread.sleep((long) 0.5);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            if(ex[0] == "PING"){
                writeout("PONG " + ex[1]);
            }
        }
    }

    private static void writeout(String msg) {
        out.println(msg);
        System.out.println("[OUT] " + msg);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:41:34.793

必须使用[`String.equals()`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#equals%28java.lang.Object%29)而不是测试字符串相等性`==`。

它应该是：

```
 if(! data.isEmpty()){                     // rather than: data != ""
            System.out.println("[IN] " + data);
        }
        ...
        if(ex[1].equals("001")){                  // rather than: ex[1] == "001"
            writeout("JOIN #minecraft");
        }
        ...
        if(ex[0].equals("PING")){                 // rather than: ex[0] == "PING"
            writeout("PONG " + ex[1]);
        } 
```

请参阅[如何比较 Java 中的字符串](https://stackoverflow.com/questions/513832/how-do-i-compare-strings-in-java)。

# node.js - Node.JS 的默认文件夹功能

> ID：10644431
> 
> 赞同：2
> 
> 时间：2012-05-17T22:38:17.200
> 
> 标签：node.js

我想用 node.js 和 socket.io 为我的网站添加一些实时功能，但不必处理页面请求/响应的麻烦。我能否获得正常的文件夹功能，它首先提供 index.html，然后自动加载任何 js/css 依赖项？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-17T22:58:33.507

您可以使用 Express 框架。将您的文件、所有样式、javascript 文件、其他 HTML 文件放在公共文件夹下。你只需要给express一个入口点，就可以给客户端index.html。

```
 var fs = require("fs");
    var express = require("express");
    app = express.createServer();

    app.use(express.static(__dirname + '/public'));
    app.get('/', function(req, res) {
        fs.readFile(__dirname + '/public/index.html', 'utf8', function(err, text){
            res.send(text);
        });
    });
    app.listen(3000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T01:50:59.270

如果您只想提供静态文件，使用 express 非常简单。

app.js 文件只需要以下几行代码

```
 var express = require('express');

    var app = express.createServer(
       express.static(__dirname + '/public')
       );

    app.listen(3000); 
```

将所有 html、css、javascript 文件放置在应用程序根目录下的“公共”文件夹中。所以一个典型的 app 文件夹应该是这样的：

```
 app.js
  /public
     index.html
     reset.html
     ...
     ...
     /css
        main.css
        reset.css
        ...
        ...
     /js
        header.js
        util.js
        ...
        ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-20T23:59:30.223

我使用了一种略有不同的方法，结果相同：

```
var express = require('express');
var app = express();

app.use(express.static(__dirname + '/public'));

app.listen(process.env.PORT || 3000); 
```

# javascript - 从浏览器打印时检测背景图像和背景颜色支持

> ID：10644440
> 
> 赞同：7
> 
> 时间：2012-05-17T22:38:57.387
> 
> 标签：javascript, css, browser, printing, graceful-degradation

从浏览器打印页面时，它指的是`print.css`用`media="print"`. 浏览器禁用了一些 CSS 规则，例如`background-image`和`background-color`，一些浏览器有启用它们的选项。

如[this answer](https://stackoverflow.com/questions/10139593/stylesheet-for-printing-background-color-ignored)中所述，无法从页面代码中覆盖此行为。

我对此有两个问题：

*   是否有关于这些打印规则的任何文档或良好参考？例如：
    *   哪些 CSS 规则被禁用？
    *   Javascript 可以在打印之前在页面上做些什么吗？
*   有没有办法用 Javascript 检测处于打印模式的浏览器，然后制作一个优雅的降级系统？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T05:00:04.770

浏览器如何打印页面有点像黑匣子。我一直无法找到任何明确的参考资料。

所有主要浏览器都有打印选项，可以将网页“缩小以适应”纸页（默认启用），以及打印背景图像和颜色（默认禁用）。大多数用户将保留这些默认设置，如果他们甚至知道这些选项存在的话。我没有看到浏览器在打印时“禁用”任何其他 CSS 规则。

Firefox 和 IE 支持[`onbeforeprint`](https://developer.mozilla.org/en/DOM/window.onbeforeprint)and[`onafterprint`](https://developer.mozilla.org/en/DOM/window.onafterprint)事件，因此您可以检测何时使用 JavaScript 进行打印，但显然这不是跨浏览器解决方案。

打印所需的大多数调整都可以由 CSS 处理（在单独的打印样式表中或作为`@media print { ... }`主样式表中的块）：

*   [CSS-Discuss Wiki](http://css-discuss.incutio.com/wiki/Print_Stylesheets)有一个很好的页面，介绍了您可以通过 CSS 控制多少。

*   我建议从[HTML5 Boilerplate](https://github.com/h5bp/html5-boilerplate/blob/288f9922c098105216f194cf3ba50fcb7fe60aee/css/main.css#L552)中查看打印样式作为一个很好的起点。

*   如果您有必须打印的背景图像，您可以`<img>`在页面中包含元素，用 隐藏，然后在打印 CSS 中使用（或）`display: none`使它们可见。`display: block``inline`

如果您需要大量修改页面以进行打印，我建议提供单独的仅打印版本的页面，而不是尝试使用 JavaScript 进行调整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T12:13:15.463

不确定第一点，但是要在打印模式下检测浏览器，您可以对 screen 执行相同的操作。要么使用 Modernizr 并有条件地为支持的功能添加类，然后制定有针对性的 CSS 规则，例如：

```
body.whateverfeature .yourrule { } 
```

或者如果它只是你想测试的 IE，使用类似 h5bp 的东西：

```
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]--> 
```

# magento - Magento 类别缩略图

> ID：10644443
> 
> 赞同：7
> 
> 时间：2012-05-17T22:39:21.197
> 
> 标签：magento, thumbnails, categories

我正在尝试使用 Magento 类别缩略图，但它不起作用。我已经在线学习了许多教程（例如[http://www.douglasradburn.co.uk/getting-category-thumbnail-images-with-magento/](http://www.douglasradburn.co.uk/getting-category-thumbnail-images-with-magento/)），并且都提到了该功能：

```
$_category->getThumbnail() 
```

应该在类别模型中。我正在运行 Magento 1.6，但在任何地方都找不到此功能。我还下载了 1.5 和 1.7，在那里看了看，没有找到。但是，当我运行代码时，它没有给我任何错误，只是没有输出。

这是我的完整代码：

```
 <ul id="nav">
 <?php foreach ($this->getStoreCategories() as $_category): ?>
     <?php echo $_category->getThumbnail(); ?>  
     <?php echo $this->drawItem($_category) ?>
 <?php endforeach ?>
 </ul> 
```

（我正在尝试将缩略图用作它所在的菜单项）

* * *

得到它的工作。秘诀是您需要使用以下代码重新查询 FULL 类别数据：

```
Mage::getModel('catalog/category')->load($_category->getId())->getThumbnail() 
```

我在某种程度上遵循了本教程：

[http://www.ho.nl/blog/using_category_images_in_your_magento_navigation/](http://www.h-o.nl/blog/using_category_images_in_your_magento_navigation/)

在您的菜单中有类别缩略图。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-21T00:29:05.250

对于它的价值，您的解决方案有效，但效率很低。

使用：

```
Mage::getModel('catalog/category')->load($_category->getId())->getThumbnail() 
```

每个类别的加载时间会增加百分之几甚至十分之一秒。

这样做的原因是您在获取模型集合并获取其中的项目时遇到了麻烦，然后您将添加新的数据库调用来获取每个类别的完整数据。您只需确保首先收集完整的类别数据。

您之前所拥有的东西不起作用的原因是因为没有告诉类别集合它需要选择哪些属性。它实际上只是从 catalog_category_entity 表中返回平面数据，而不是与任何属性表连接。

您需要做的可能更多的是以下方面：

```
<ul id="nav">
<?php foreach ($this->getStoreCategories()->addAttributeToSelect("*") as $_category): ?>
    <?php echo $_category->getThumbnail(); ?>  
    <?php echo $this->drawItem($_category) ?>
<?php endforeach ?>
</ul> 
```

事实上，理想情况下，您希望重写该`->getStoreCategories()`函数以添加通配符过滤器。

我建议打开`app/code/core/Mage/Eav/Model/Entity/Collection/Abstract.php`并学习编写了哪些非常酷的集合函数。掌握 EAV 集合对于 Magento 开发人员来说就像是一种成人仪式。一旦你这样做了，你将势不可挡！

希望这可以帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-04T12:41:19.633

无需更改 app/code/local/Mage/Catalog/Model/Category.php

它可以通过这些代码行轻松完成......试试这个......它的作品

```
$child= Mage::getSingleton('catalog/layer')->getCurrentCategory()->getId();

$imageSrc = Mage::getModel('catalog/category')->load($child)->getThumbnail();

$ThumbnailUrl = Mage::getBaseUrl('media').'catalog/category/'.$imageSrc;

echo "<img src='{$ThumbnailUrl}' />"; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-17T15:15:11.217

这对我有用：

```
<img src="http://etienneaigner.com/shop/media/catalog/category/
     <?php echo Mage::getModel('catalog/category')->load($_category->getId())->getThumbnail(); ?>"

     height="338px" width="338px"
     alt="<?php echo $this->htmlEscape($_category->getName()) ?>" /> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-08T23:49:14.227

刚看到这个答案。但是，在以后的 magento 版本 1.7+ 中，无需向代码添加开销，您可以通过 config.xml 向 Category 集合添加更多标准（和自定义）eav 属性。如果你检查 Mage/Catalog/etc/config.xml 你会注意到节点下有节点：

```
 <category>
        <collection>
            <attributes>
                <name/>
                <url_key/>
                <is_active/>
            </attributes>
        </collection>
    </category> 
```

因此，您可以创建自己的模块并添加更多 eav 属性：

```
 <category>
        <collection>
            <attributes>
                <thumbnail/>
                <image/>
            </attributes>
        </collection>
    </category> 
```

它们将被添加到您的类别集合中。

# php - preg_match 在 php > 5.3 中失败

> ID：10644449
> 
> 赞同：6
> 
> 时间：2012-05-17T22:40:27.543
> 
> 标签：php, preg-match

我不擅长正则表达式，所以我什至不知道这个是做什么的，确切地说：

```
echo preg_match('/^(([a-zA-Z0-9\x2d]{1,63}\x2e)*[a-zA-Z0-9\x2d]{1,63}){1,254}$/', 'example12345678.com>'); 
```

我从 Zend Framework 的旧版本 - 1.5 中获取它，该版本已过时，在该框架的最后一个稳定版本中，不再提供此正则表达式。但是，它的行为很奇怪，因为我在官方 php 资源中没有发现任何文档解释或向后不兼容说明。

问题是在 php 5.2.* 上它工作正常：返回 0。在 php 5.3.10、5.4.0（很可能是 5.3\. *、5.4。*我想）它返回 FALSE，意思是“错误”。

我的问题是：为什么？错误是什么？是正则表达式、某种递归还是规则歧义？如果是这样，为什么它适用于 php 5.2？

* * *

有趣的是，如果我将 'example12345678.com>' 更改为 'example1234567.com>' （使其缩短一个或多个字符） - 它开始工作并返回 0。如果我将其更改为 '123123123123123123123123123' 它也可以工作并返回 1 .

**UPD**：还不知道这是否重要，但这里的 pcre 版本是 8.02 (php 5.2) vs 8.12 (php 5.3)

* * *

**UPD2**：我确实理解它的用途......或多或少......现在让任何东西工作都没有问题。正如我所说 - Zend_Validate_* 更新解决了它。我将尝试用其他语言来描述我的担忧：

比如说，我升级了一个重要的软件，使php5.2 > php5.3 切换。我尝试查找有关我可能面临的所有问题的信息（主要是通过阅读以下内容：http: [//php.net/manual/en/migration53.php](http://php.net/manual/en/migration53.php)）。该软件有点旧，但并不古老，例如 Zend Framework 可能是 1.5 版本。我检查/修补/分析并修复每个 bc 中断和不推荐使用的功能。甚至我的单元测试也运行良好。

令我惊讶的是，问题中描述的事情发生了。（准确地说，Zend_Validate_Hostname 会抛出异常）。所以现在我想知道为什么我在升级时错过了这个，更重要的是，我是否应该重新检查应用程序中的所有“preg_match”（以及其他利用 PCRE 的函数），尝试各种可以想象的输入数据以试图找到类似的“错误修复” ”。

如果是“错误修复”。因为它看起来像一个新错误——它曾经在 php5.2 中按预期工作，但现在不再工作了。

希望能找到一些线索来缩小搜索范围。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T23:52:50.593

这是一个丑陋的正则表达式。*问题是，字符串可能*匹配的方式太多，因此引擎在发现它实际上不匹配之前尝试了所有的内存不足。

此外，它似乎正在尝试匹配有效的域名，但事实并非如此。我会用`preg_match`调用这个函数来代替那个调用：

```
function is_valid_domain_name($string) {
    if (strlen($string) > 253) {
        return false;
    }
    $label = '(?!-)[a-zA-Z0-9-]{0,63}(?<!-)';
    return preg_match("/^(?:$label\.){0,126}$label$/", $string);
} 
```

它在您的问题字符串上快速失败：

```
echo is_valid_domain_name('example12345678.com>'),"\n"; 
```

# zend-framework - 无法让谷歌地图 api v3 在 zend 框架中工作

> ID：10644452
> 
> 赞同：0
> 
> 时间：2012-05-17T22:40:42.587
> 
> 标签：zend-framework, google-maps-api-3

我尝试将以下来自 google 的示例代码添加到我的 zf 应用程序中。
*在头部：*

```
<style type="text/css">
  html, body, #map_canvas {
    margin: 0;
    padding: 0;
    height: 100%;
  }
</style>
<script type="text/javascript"
    src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">
  var map;
  function initialize() {
    var myOptions = {
      zoom: 8,
      center: new google.maps.LatLng(-34.397, 150.644),
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById('map_canvas'),
        myOptions);
  }

  google.maps.event.addDomListener(window, 'load', initialize);
</script> 
```

*在我看来：*

```
 <div id="map_canvas"></div> 
```

我正在使用布局脚本，如果我禁用它，地图就会显示，但如果我使用我的布局，它就会消失。谁能告诉我发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T18:00:54.367

好的，我已经想通了。这确实是一个 CSS 问题。我的页面内容周围有一个容器 div。它的最小高度设置为 600 像素。谷歌示例中的 CSS 将 html 和 body 设置为 100% 高度。我将容器高度更改为 100% 并解决了它。

# ruby - 从 Ruby C 扩展中抑制 STDOUT

> ID：10644457
> 
> 赞同：0
> 
> 时间：2012-05-17T22:41:00.777
> 
> 标签：ruby, stdout, stderr

我在项目中[使用gem](https://github.com/RiotGames/knife_cookbook_dependencies) [dep_selector](https://github.com/algorist/dep_selector.git)并且无法弄清楚如何从库的 C 扩展中抑制标准输出。

我想压制的有问题的代码在这里：

[https://github.com/RiotGames/knife_cookbook_dependencies/blob/master/lib/kcd/shelf.rb#L26](https://github.com/RiotGames/knife_cookbook_dependencies/blob/master/lib/kcd/shelf.rb#L26)

我试过这个：

```
real_stdout = $stdout
$stdout = StringIO.new
real_stderr = $stderr
$stderr = StringIO.new
puts "This gets suppressed correctly"
selector.find_solution( ... ) # still prints to the terminal 
```

但是当我运行脚本时我仍然得到 dep_selector 输出。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:49:24.360

你也许可以从 Rails 中刷一些代码，比如[quiet](http://api.rubyonrails.org/classes/Kernel.html#method-i-quietly)方法，它应该会为你处理这个问题。

Kernel#quietly 使用以下内容来使 STDOUT 和 STDERR 静音

```
# Silences any stream for the duration of the block.
#
#   silence_stream(STDOUT) do
#     puts 'This will never be seen'
#   end
#
#   puts 'But this will'
def silence_stream(stream)
  old_stream = stream.dup
  stream.reopen(RbConfig::CONFIG['host_os'] =~ /mswin|mingw/ ? 'NUL:' : '/dev/null')
  stream.sync = true
  yield
ensure
  stream.reopen(old_stream)
end 
```

# python - 如何编写一个python包

> ID：10644460
> 
> 赞同：5
> 
> 时间：2012-05-17T22:41:09.553
> 
> 标签：python

我正在尝试重构我的代码（一堆核心模块和一些生活在一个公共目录中的应用程序）。我想得到这个结构

```
Root
   __init__.py
   Core
       __init__.py
       a.py
       b.py
       c.py
   AppOne
       __init__.py
       AppOne.py
   AppTwo
       __init__.py
       AppTwo.py
   AppThree
       __init__.py
       AppThree.py 
```

在哪里`AppOne.py`，`AppTwo.py`并`AppThree.py`导入模块`a`，`b`并`c`在`Core`包中。

我不明白如何编写`__init__.py`文件和导入语句。我已阅读 [http://docs.python.org/tutorial/modules.html](http://docs.python.org/tutorial/modules.html)和[http://guide.python-distribute.org/creation.html](http://guide.python-distribute.org/creation.html)。我收到诸如“尝试在非包中进行相对导入”或“无效的 Sintaxis”之类的错误

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T22:53:02.027

您需要将 python 模块的目录添加到 sys 路径。

如果你有这样的事情

```
Root
   here_using_my_module.py
   my_module
       __init__.py  --> leave it empty
       a.py
       b.py
       c.py 
```

您需要将模块目录添加到 sys_path

```
//here_using_your_module.py
import os, sys

abspath = lambda *p: os.path.abspath(os.path.join(*p))

PROJECT_ROOT = abspath(os.path.dirname(__file__))

sys.path.insert(0,PROJECT_ROOT)

import a from my_module

a.do_something() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T00:40:33.697

如果您有*确切的*目录结构，则可以使用相对导入从父文件夹导入：

```
from ..Core import a 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T22:54:30.967

在 AppOne.py 中：

```
import os
os.chdir("..")

from Core import a 
```

或者，您可以在 AppOne.py 中编写：

```
import sys
sys.path.insert(-1,"..")

from Core import a 
```

# django - 传递给 safe_join(base, *paths) 的 'base' 参数以 '/' 结尾

> ID：10644461
> 
> 赞同：2
> 
> 时间：2012-05-17T22:41:11.243
> 
> 标签：django

第一次发帖，希望我做对了。

我正在“myapp/admin.py”中创建一个自定义管理表单，并且我使用的是 : 行 `default_storage.exists('/usr/tmp/somefile.txt')`。

但是，`exists()`正在抛出`SuspiciousOperation`异常。我看了看，问题似乎来自`safe_join(base, *paths)`“_os.py”。

事实证明，基本参数被设置为`'/'`，这破坏了以下代码`safe_join()`：

```
if not normcase(final_path).startswith(normcase(base_path)) \
  or final_path[base_path_len:base_path_len+1] not in ('', sep):
    raise ValueError('The joined path (%s) is located outside of the base '
                     'path component (%s)' % (final_path, base_path)) 
```

我在使用`default_storage.exists()`in时没有遇到这个问题`manage.py shell`。另外，我正在使用 Django 1.4 和 Python 2.7。

任何帮助表示赞赏！提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:37:11.960

在我看来，您的 settings.py 中的某些内容设置不正确您
看到该`SuspiciousOperation`异常的可能原因是您的 default_storage.location 设置为`/`root，我认为访问文件系统的根目录绝对是可疑的.

您可能需要检查您是否已`MEDIA_ROOT`在 settings.py 中设置为合理的存储位置：
[https ://docs.djangoproject.com/en/1.4/ref/settings/#media-root](https://docs.djangoproject.com/en/1.4/ref/settings/#media-root)

似乎 default_storage.location 值来自 MEDIA_ROOT？对我来说，它等于那个值。当我尝试在高于该位置的路径上执行 default_storage.exists() 时，它也会引发该异常。

# nunit - 如何设计一个 NUnit 理论？

> ID：10644462
> 
> 赞同：8
> 
> 时间：2012-05-17T22:41:22.610
> 
> 标签：nunit, theory, out-of-memory, datapoint

我创建了一个 NUnit Theory 来帮助我测试一些代码。被测试的实际代码对于这个问题并不像我用来测试它的数据那么重要。即，24 小时制的小时和分钟。

我以这种方式编写我的夹具是为了利用这些特性并符合 NUnit 2.6 Theory 特性中的限制。特别是，我觉得我必须创建诸如 Hour 和 Minute 之类的类，以解决 Datapoints 按确切类型与参数匹配的特性。

```
[TestFixture]
public class TimeWindowParserTheoryFixture
{
    public class Hour
    {
        public int Value;
    }

    public class Minute
    {
        public int Value;
        public string AsString { get { return Value.ToString("00"); } }
    }

    [Datapoints]
    public IEnumerable<Hour> Hours
    {
        get
        {
            return Enumerable
                .Range(0, 25)
                .Select(v => new Hour() { Value = v })
                .Union(Enumerable.Repeat((Hour)null, 1));
        }
    }

    [Datapoints]
    public IEnumerable<Minute> Minutes
    {
        get
        {
            return Enumerable
                .Range(0, 60)
                .Select(v => new Minute() { Value = v })
                .Union(Enumerable.Repeat((Minute)null, 1));
        }
    }

    [Datapoints]
    public IEnumerable<string> Separators
    {
        get { return new[] { " ", "-" }; }
    }

    [Theory]
    public void ValidHours(Hour startHour,
        Minute startMinute,
        Hour endHour,
        Minute endMinute,
        string separator)
    {
        Assume.That(startHour != null);
        Assume.That(endHour != null);

        var parser = new TimeWindowParser();
        var startMinutesString = String.Format("{0}{1}", startMinute == null ? "" : ":", startMinute == null ? "" : startMinute.AsString);
        var endMinutesString = String.Format("{0}{1}", endMinute == null ? "" : ":", endMinute == null ? "" : endMinute.AsString);
        var pattern = String.Format("{0}{1}{2}{3}{4}{5}{6}", startHour, startMinutesString, "", separator, endHour, endMinutesString, "");
        //Console.WriteLine(pattern);
        var result = parser.Parse(pattern);
        Assert.That(result, Is.Not.Null);
        Assert.That(result.Start, Is.EqualTo(startHour));
        Assert.That(result.End, Is.EqualTo(endHour));
    }
} 
```

我发现在 NUnit 的默认组合逻辑期间生成的数据集的大小导致数据集太大，以至于我的内存不足。我设置测试和数据的方式似乎不是问题，但显然是这样，所以我正在寻求有关如何以不同方式思考这个问题的建议。这是我得到的 OutOfMemoryException 堆栈跟踪。

```
System.OutOfMemoryException: Exception of type 'System.OutOfMemoryException' was thrown.
at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)
at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)
at System.Text.StringBuilder.AppendHelper(String value)
at System.Text.StringBuilder.Append(String value)
at NUnit.Core.MethodHelper.GetDisplayName(MethodInfo method, Object[] arglist)
at NUnit.Core.Builders.NUnitTestCaseBuilder.BuildSingleTestMethod(MethodInfo method, Test parentSuite, ParameterSet parms) 
```

此异常本身很奇怪，因为它似乎是通过简单地尝试获取 Test 方法的名称来生成的（请参阅 GetDisplayName）。我不确定这是否是一个错误（已知或其他）。顺便说一句，当我使用参数化测试中使用的实验性较少的 Range 和 Value 属性重新编写此夹具时，我得到了一个非常相似的 OOM 异常。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-11-05T01:53:20.917

你的问题是关于使用理论的机制，但我想先谈谈“理论理论”，然后我会回到实现细节。

理论的理论

如果你有一个理论开始，你应该只使用一个理论。否则，您只是使用数据点来驱动传统的示例驱动测试。“有一个理论”是指有一些一般性的真理陈述，你想通过一些输入来证明它。一般来说，理论（代码）将遍历可能的输入并过滤掉任何不符合您假设的内容。一个好的理论的例子是：对于任何正实数，平方根乘以自身将得到相同的数字。”

查看您的测试，我无法弄清楚您的 Theory 试图证明什么理论。它看起来就像一个标准的参数化测试，除了您使用的是 DataPoints。您需要做的唯一假设是分钟不为空，这很奇怪，因为您首先提供了分钟。

底线：我不认为这是对理论的一个很好的使用。

力学

您正在生成 24*24*60*60*2 数据点。这是一大堆数据。您是否有任何理由相信您的解析算法可能适用于 - 比如说 - 24:13 但在 24:14 时失败？

确实，数据点是组合使用的，如果成对使用可能会更好。但请记住，DataPoints 只是将数据投入理论的众多方法之一。这个想法是理论应该处理你给他们的任何数据。

选择

我会把它写成一个测试，因为我想不出任何关于你的解析器或解析器的理论都适用。我只会提供测试有效数据，可能使用 TestCaseSourceAttribute 指向生成有效字符串的方法或简单地指向一个大字符串数组。我会有另一个处理各种无效数据的测试。

查理

# mustache - 用 html（脚本或 div 元素）而不是内联 javascript 定义的 hogan 模板

> ID：10644464
> 
> 赞同：0
> 
> 时间：2012-05-17T22:41:46.410
> 
> 标签：mustache, icanhaz.js, hogan.js

我想将我们的模板引擎从[ICanHas](http://icanhazjs.com) ( [Mustache](http://mustache.github.com) )换成[Hogan](http://twitter.github.com/hogan.js)。ICanHas 允许您在脚本块中定义模板。霍根可以做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T04:09:24.877

是的。`script`这是标签中的一个简单模板：

```
<script id="hogan-tpl" type="text">
    hello {{planet}}
</script>​ 
```

这是从元素中获取模板所需的最小 JavaScript，`script`使用 Hogan.js 对其进行编译，并在将其分配给正文的 innerHTML 之前使用适当的数据进行渲染：

```
var template = $('#hogan-tpl').html(),
    hello = Hogan.compile(template),
    context = { planet: "world" },
    tpl = hello.render(context);

document.body.innerHTML = tpl;​ 
```

[这是它在 jsFiddle 上的工作](http://jsfiddle.net/maxbeatty/ztZas/)

# c# - twitter json - 奇怪的错误

> ID：10644465
> 
> 赞同：0
> 
> 时间：2012-05-17T22:41:48.450
> 
> 标签：c#, json

我有下面的方法来解析来自 twitter 搜索的数据，奇怪的是这个方法在我的一种形式中工作正常，但在我的主要形式中它返回异常：

> 例外：“System.Collections.Generic.Dictonary”不包含“文本”的定义

这两种形式几乎相同，我不明白为什么我不能让代码工作..有人有什么想法吗？

下面是方法：

```
public static HashSet<string> searchTwitterJson(string searchTerm)
    {
        HashSet<string> resultsFound = new HashSet<string>();

        if (searchTerm != "")
        {
            string v = searchTerm.Replace("\"", "%22");
            string keyword = v.Trim();
            string keywordet = HttpUtility.UrlEncode(keyword);

            try
            {
                HttpWebRequest request = (HttpWebRequest)WebRequest.Create("https://twitter.com/phoenix_search.phoenix?q=" + keywordet + "&headers[X-Twitter-Polling]=true&headers[X-PHX]=true&since_id=203194965877194752&include_entities=1&include_available_features=1&contributor_details=true&mode=relevance&query_source=unknown");
                var response = request.GetResponse();
                var reader = new StreamReader(response.GetResponseStream());
                var responseString = reader.ReadToEnd();

                string limit = response.Headers["X-RateLimit-Remaining"];

                var serializer = new JavaScriptSerializer();
                serializer.RegisterConverters((new[] { new DynamicJsonConverter() }));
                dynamic obj = serializer.Deserialize(responseString, typeof(object)) as dynamic;

                foreach (var objects in obj.statuses) 
                {
                    if ((objects.text != null) && (objects.user.screen_name != null) && (objects.id_str != null))
                    {
                        Match m = Regex.Match(objects.text, @"(http(s)?://)?([\w-]+\.)+[\w-]+(/\S\w[\w- ;,./?%&=]\S*)?");

                        if (!m.Success)
                        {
                            string loggaD = objects.user.screen_name.ToString() + "/" + objects.id_str.ToString();
                            resultsFound.Add(loggaD);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
        }
        else
        {
            MessageBox.Show("No searchterm");
        }

        return resultsFound;
    } 
```

我收到的部分 JSON：

```
{
    "error": null,
    "statuses": [{
        "in_reply_to_status_id_str": null,
        "id_str": "203239104421445632",
        "truncated": false,
        "possibly_sensitive": false,
        "created_at": "Thu May 17 21:42:33 +0000 2012",
        "in_reply_to_user_id_str": null,
        "contributors": null,
        "favorited": false,
        "geo": null,
        "user": {
            "screen_name": "YouthNorrort"
        },
        "in_reply_to_screen_name": null,
        "coordinates": null,
        "retweet_count": 0,
        "source": "\u003Ca href=\"http:\/\/www.facebook.com\/twitter\" rel=\"nofollow\"\u003EFacebook\u003C\/a\u003E",
        "place": null,
        "in_reply_to_status_id": null,
        "id": 203239104421445632,
        "retweeted": false,
        "in_reply_to_user_id": null,
        "text": "Hejsan igen!\nvi \u00e4r ledsna att meddela er, men inf\u00f6r imorgon s\u00e5 finns det inga bilar, allts\u00e5 inte heller plats f\u00f6r... http:\/\/t.co\/pMKoOz7o",
        "result_category": "recent"
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:50:54.760

该错误表示响应在“状态”下的节点中不包含项目。[i]。检查正在返回的 JSON，如果没有，则无法尝试访问它。

```
{
    "statuses":
    [
        {
            "text": ...,
            "user: { "screen_name": ... }
        }
    ]
} 
```

编码：

```
 if ((objects.text != null) && (objects.user.screen_name != null) && (objects.id_str != null)) 
```

**更新**：根据您的 JSON 示例，它工作正常（见下文）。statuses 数组中的所有元素是否都包含“text”成员？

```
 public static void Test()
    {
        string json = @"{
""error"": null,
""statuses"": [{
    ""in_reply_to_status_id_str"": null,
    ""id_str"": ""203239104421445632"",
    ""truncated"": false,
    ""possibly_sensitive"": false,
    ""created_at"": ""Thu May 17 21:42:33 +0000 2012"",
    ""in_reply_to_user_id_str"": null,
    ""contributors"": null,
    ""favorited"": false,
    ""geo"": null,
    ""user"": {
        ""screen_name"": ""YouthNorrort""
    },
    ""in_reply_to_screen_name"": null,
    ""coordinates"": null,
    ""retweet_count"": 0,
    ""source"": ""\u003Ca href=\""http:\/\/www.facebook.com\/twitter\"" rel=\""nofollow\""\u003EFacebook\u003C\/a\u003E"",
    ""place"": null,
    ""in_reply_to_status_id"": null,
    ""id"": 203239104421445632,
    ""retweeted"": false,
    ""in_reply_to_user_id"": null,
    ""text"": ""Hejsan igen!\nvi \u00e4r ledsna att meddela er, men inf\u00f6r imorgon s\u00e5 finns det inga bilar, allts\u00e5 inte heller plats f\u00f6r... http:\/\/t.co\/pMKoOz7o"",
    ""result_category"": ""recent""
}]}";
        JavaScriptSerializer jss = new JavaScriptSerializer();
        jss.RegisterConverters(new[] { new DynamicJsonConverter() });
        dynamic obj = jss.Deserialize(json, typeof(object)) as dynamic;

        foreach (var objects in obj.statuses)
        {
            Console.WriteLine(objects.GetType());
            if (objects.ContainsKey("text"))
            {
                if ((objects.text != null) && (objects.user.screen_name != null) && (objects.id_str != null))
                {
                    Match m = Regex.Match(objects.text, @"(http(s)?://)?([\w-]+\.)+[\w-]+(/\S\w[\w- ;,./?%&=]\S*)?");

                    if (!m.Success)
                    {
                        string loggaD = objects.user.screen_name.ToString() + "/" + objects.id_str.ToString();
                        Console.WriteLine(loggaD);
                    }
                }
            }
        } 
```

TryInvokeMember 的代码：

```
 public override bool TryInvokeMember(InvokeMemberBinder binder, object[] args, out object result)
            {
                if (binder.Name == "ContainsKey")
                {
                    result = _dictionary.ContainsKey(args[0] as string);
                    return true;
                }
                else
                {
                    return base.TryInvokeMember(binder, args, out result);
                }
            } 
```

# html - Webintents“发现”

> ID：10644467
> 
> 赞同：0
> 
> 时间：2012-05-17T22:42:11.800
> 
> 标签：html, webintents

有人可以向我解释什么是“发现” [WebIntents](http://webintents.org/discover)服务吗？

> 发现意图旨在让开发人员查询可能存在于外部服务上的 API 和服务。“发现”协议旨在成为一个轻量级的注册表列表。

更好的是，有人可以给我举个例子吗？

# php - 使用 PHP 从 MySql 中检索最后一个插入 id

> ID：10644468
> 
> 赞同：0
> 
> 时间：2012-05-17T22:42:29.693
> 
> 标签：php, mysql

我在 MySql 数据库中有两个表，一个是`sales_order`，另一个是`sales_order_details`包含`sales_order`表中订单的详细信息。`sales_order`显然，从到是一对多的关系`sales_order_details`。

当客户下订单时，将第一个条目放入`sales_order`表中，并根据表的`auto_increment`id`sales_order`将相应的条目放入`sales_order_details`表中。

我正在使用MySql 函数从表`last_insert_id()`中检索相应的内容，就像这样。`order_id``sales_order`

```
insert into sales_order_details(order_id, prod_id, prod_price)values(last_insert_id(), 5, 1500); 
```

它正在工作。该`last_insert_id()`函数从相应表中检索最后插入的 id，该表对于特定连接是唯一的（据我所知）。

现在，我需要`order_id`最近由`last_insert_id()`函数检索和插入的相同内容，以将其作为发票编号发送到支付系统。

我可以尝试使用 PHP 函数`mysql_insert_id()`，但我不确定它是否按规定工作。检索始终保证检索始终与特定订单关联的特定 id 的最后一个插入 id 的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:45:49.013

有**两种方法**可以解决这个问题：

在 sales_order 中插入条目后：

1.  获取`last_insert_id`并将其存储在 php 变量中，然后将此值注入相关查询中。

2.  将 存储`last_insert_id`在 MySql[用户定义的变量](http://dev.mysql.com/doc/refman/5.0/en/user-variables.html)中，并在查询中使用该变量而不是`last_insert_id`.

### 选项 2 的示例代码

`SET @last_order_id = last_insert_id();`

```
insert into sales_order_details (order_id, prod_id, prod_price)
values (@last_order_id, 5, 1500);`

insert into sales_invoice (order_id, invoice_id)
values (@last_order_id, 1);` 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T22:46:51.080

[http://ca.php.net/manual/en/mysqli.insert-id.php](http://ca.php.net/manual/en/mysqli.insert-id.php)

是您正在寻找的财产。它是完全可靠的。

mysql_insert_id（和所有 mysql_ 函数）已被弃用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T22:50:31.950

*LAST_INSERT_ID()* 和 *mysql_insert_id()* 都像宣传的那样工作，即：它们将检索在当前会话/连接期间插入任何表的最后一个 id。

只要您在检索此 id 之前不插入多个自动递增的表，您就确定它是正确的。

在将多个值插入同一个表时也要小心，您将收到其中第一个值的值，但它们不一定是连续的（不同的会话/连接也可能插入了一些新记录）。

我通常喜欢做这样的事情：

```
START TRANSACTION;
    INSERT INTO sales_order ...;
    SET @last_order = LAST_INSERT_ID();
    INSERT INTO sales_order_details (order_id) VALUES ($last_order);
    SELECT @last_order;
COMMIT; 
```

此查询的结果集应包含一列和一行保存最后一个订单的值。

但话又说回来，我通常这样做是为了更新的事务安全性。

```
START TRANSACTION;
    SELECT * FROM sales_order WHERE order_id = 2 FOR UPDATE;
    UPDATE sales_order_details SET quantity = 9 WHERE order_id = 2 AND prod_id = 3;
    UPDATE sales_order SET price_to_pay = (SELECT SUM(quantity*price) FROM sales_order_details WHERE order_id = 2);
COMMIT; 
```

事务应确保操作是原子的（所有操作都不会被其他进程中断）；

如果您要在没有事务或从应用程序代码中执行相同操作，则数量可能会由另一个线程更新，并在您完成价格更新之前由第三个线程读取。向用户提供虚假的“price_to_pay”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T22:46:03.860

`mysql_insert_id( )`**总是返回前一个**查询`AUTO_INCREMENT`为列生成的 id 。（参见[PHP 手册](http://php.net/manual/en/function.mysql-insert-id.php "mysql_insert_id")）

 **我不知道您要获取哪个 id，但是为了使用 PHP 检索它，您应该始终在查询后直接执行此操作。例如：

```
// Query A

mysql_query( 'INSERT INTO table_a ( id, name ) VALUES ( NULL, "Henry" )' );
$idA = mysql_insert_id( );

// Query B

mysql_query( 'INSERT INTO table_b ( id, name, a_id ) VALUES ( NULL, "Wotton", ' . $idA . ' )' );
$idB = mysql_insert_id( );

// Query C
mysql_query( 'INSERT INTO table_c ( id, name, a_id ) VALUES ( NULL, "Rick", ' . $idA . ' )' ); 
```

将它们存储在 PHP 变量中的好处是，您的系统或框架不会在您不知道的情况下通过执行另一个查询来弄乱您的查询。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-17T22:46:51.200

您可能想稍微重构一下查询。

1.  将记录插入`sales_order`表中
2.  使用 php 函数`mysql_insert_id()`检索记录的 id `sales_order`：`$sales_order_id = mysql_insert_id()`
3.  像这样重写您的插入：`insert into sales_order_details(order_id, prod_id, prod_price)values($sales_order_id, 5, 1500);

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-17T22:46:57.450

只需`mysql_insert_id()`在插入 sales_order 后立即使用。你会没事的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-30T10:31:01.283

```
 1\. Database

    CREATE TABLE MyGuests (
    id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    firstname VARCHAR(30) NOT NULL,
    lastname VARCHAR(30) NOT NULL,
    email VARCHAR(50),
    reg_date TIMESTAMP
    )

-------------------------------------------------------------------
  1\.   Example (MySQLi Object-oriented)

-------------------------------------------------------------------
    <?php
    $servername = "localhost";
    $username = "username";
    $password = "password";
    $dbname = "myDB";

    // Create connection
    $conn = new mysqli($servername, $username, $password, $dbname);
    // Check connection
    if ($conn->connect_error) {
        die("Connection failed: " . $conn->connect_error);
    }

    $sql = "INSERT INTO MyGuests (firstname, lastname, email)
    VALUES ('John', 'Doe', 'john@example.com')";

    if ($conn->query($sql) === TRUE) {
        $last_id = $conn->insert_id;
        echo "New record created successfully. Last inserted ID is: " . $last_id;
    } else {
        echo "Error: " . $sql . "<br>" . $conn->error;
    }

    $conn->close();
    ?>

------------------------------------------------------------------- 
   2\.  Example (MySQLi Procedural)

-------------------------------------------------------------------
    <?php
    $servername = "localhost";
    $username = "username";
    $password = "password";
    $dbname = "myDB";

    // Create connection
    $conn = mysqli_connect($servername, $username, $password, $dbname);
    // Check connection
    if (!$conn) {
        die("Connection failed: " . mysqli_connect_error());
    }

    $sql = "INSERT INTO MyGuests (firstname, lastname, email)
    VALUES ('John', 'Doe', 'john@example.com')";

    if (mysqli_query($conn, $sql)) {
        $last_id = mysqli_insert_id($conn);
        echo "New record created successfully. Last inserted ID is: " . $last_id;
    } else {
        echo "Error: " . $sql . "<br>" . mysqli_error($conn);
    }

    mysqli_close($conn);
    ?>

------------------------------------------------------------------- 
  3\.  Example (PDO)

-------------------------------------------------------------------
    <?php
    $servername = "localhost";
    $username = "username";
    $password = "password";
    $dbname = "myDBPDO";

    try {
        $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
        // set the PDO error mode to exception
        $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        $sql = "INSERT INTO MyGuests (firstname, lastname, email)
        VALUES ('John', 'Doe', 'john@example.com')";
        // use exec() because no results are returned
        $conn->exec($sql);
        $last_id = $conn->lastInsertId();
        echo "New record created successfully. Last inserted ID is: " . $last_id;
        }
    catch(PDOException $e)
        {
        echo $sql . "<br>" . $e->getMessage();
        }

    $conn = null;
    ?> 
```**

# c++ - 无法加载，未定义的符号 C++ 名称修改

> ID：10644471
> 
> 赞同：0
> 
> 时间：2012-05-17T22:42:41.043
> 
> 标签：c++, extern

执行程序时出现以下错误：

> E：无法加载libsim.so：libsim.so：未定义符号：_ZTV15IteratorRegFile

在 sim.cpp 中有 s.th。像

```
//IteratorRegFileIs is a wrapper that calls the constructor for IteratorRegFile
Fwk::Ptr<IteratorRegFile> iteratorRegFile_ = IteratorRegFile::IteratorRegFileIs( "RF" );
void init(){
  SparseArrayInt64 *sparse_array = new SparseArrayInt64(segID);
} 
```

在 SparseArrayInt64.cpp 中：

```
extern Fwk::Ptr<IteratorRegFile> iteratorRegFile_; 
```

迭代器RegFile.h：

```
public:
  static IteratorRegFile::ValidPtr IteratorRegFileIs(Tac::Name _name) {
    IteratorRegFile * m = new IteratorRegFile(_name);
    m->referencesDec(1);
    return m;
  }
protected:
   IteratorRegFile( const IteratorRegFile& );
   explicit IteratorRegFile(Tac::Name _name): Tac::Entity(_name),
     index_(0) {
    handleInit();
   } 
```

知道为什么编译器会修改函数以使 lib 不再找到它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T04:50:51.287

如果您在 Linux 上使用 gcc 执行此操作：

根据 c++filt`_ZTV15IteratorRegFile`是`vtable for IteratorRegFile`. 因此，损坏的名称指的是 vtvable，而不是您的函数。

我做了一些搜索并找到了这个建议`"You must implement virtual methods of your class because that's when the compiler actually generates the vtable for it."`

您可以通过这种方式检查模块中有哪些符号：
`nm your-module-name`

我想这个链接可能会有所帮助：

*   [未定义的符号“vtable for ...”和“typeinfo for ...”？](https://stackoverflow.com/q/1693634/184968)
*   [http://lists.apple.com/archives/darwin-development/2003/Sep/msg00273.html](http://lists.apple.com/archives/darwin-development/2003/Sep/msg00273.html)

# windows-8 - 在 MetroStyle 应用程序中使用 COM 对象

> ID：10644493
> 
> 赞同：5
> 
> 时间：2012-05-17T22:45:26.947
> 
> 标签：windows-8, windows-runtime

是否可以在 MetroStyle 应用程序中使用 COM 对象？我想开发一个简单的应用程序，通过 COM 使用 MediaMonkey 的 API。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T01:12:08.013

一般来说，不可能使用 Metro 风格应用程序中的现有 COM 对象。有一些例外，但几乎所有现有的 COM 对象都会在运行时被阻止。

您最好的选择是查看 MediaMonkey 人员是否可以将他们的 API 重新打包为 winrt 组件，然后将该组件添加到您的包中。

# c# - C# 泛型：如果 T 是返回类型，它也可以是 void 吗？如何将这些接口组合在一起？

> ID：10644495
> 
> 赞同：23
> 
> 时间：2012-05-17T22:45:30.623
> 
> 标签：c#, api, generics, api-design, nul

我有以下接口，它使用回调返回类型 T 的泛型参数...

```
public interface IDoWork<T>
{
    T DoWork();
} 
```

但是我也有以下接口，但它不会调用回调，因为它返回 void。

```
public interface IDoWork
{
    void DoWork();
} 
```

我可以结合这两个接口并使用运行时逻辑来确定差异吗？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-17T22:47:53.177

不幸的是，它们不能合并。

你可以在框架中看到这一点——这就是为什么有一个单独的[`Task`](https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.task)和[`Task<T>`](https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.task-1)类，例如。

`IDoWork<object>`话虽如此，您通常可以通过使用和传递`null`值等来共享此类场景中的实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-17T22:59:38.780

返回类型是方法签名的一部分，因此 T DoWork() 和 void DoWork() 是不同的，并且 void 不是类型，也不是`null`. 这表明从方法返回时评估堆栈中没有任何内容。

# php - PHP 数组更改

> ID：10644496
> 
> 赞同：0
> 
> 时间：2012-05-17T22:45:33.380
> 
> 标签：php, arrays, csv, multidimensional-array

我有按以下方式设置的数据：

```
array(
      0 => array(
                  'data_id' => 0,
                  'elem_value' => 'phone',
                  'elem_prettyname' => 'Phone Number'
                 ),
      1 => array(
                  'data_id' => 0,
                  'elem_value' => 'email',
                  'elem_prettyname' => 'Email Address'
                 ),
      2 => array(
                  'data_id' => 1,
                  'elem_value' => 'phone',
                  'elem_prettyname' => 'Phone Number'
                 ),
      3 => array(
                  'data_id' => 1,
                  'elem_value' => 'email',
                  'elem_prettyname' => 'Email Address'
                 )
     )
) 
```

我正在尝试将其转换为 csv 文件，如下所示：

```
"Data ID","Phone Number","Email Address"
0,"phone","email"
1,"phone","email" 
```

但我无法为我的一生弄清楚。我有大量的随机数组，它们无处可去。

我应该提一下，elem_prettyname 可以有无限数量的元素。IE 不仅仅是电话号码和电子邮件地址。

谁能指出我正确的方向以正确格式化？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:53:58.253

如果你想写 csv 文件，你可以使用[`fputcsv()`](http://www.php.net/manual/en/function.fputcsv.php)

做

```
fputcsv($fp, array_keys(reset($my_array))); 
```

输出带有标签的第一行和

```
foreach($my_array as $item) {
  fputcsv($fp, array_values($item));
} 
```

输出休息。$fp 必须是为写入而打开的文件的文件句柄。你可以得到它`fopen()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:00:58.387

您需要将数据转换为如下所示的数组：`0,"phone","email"`首先。

像这样的东西：

```
$lines = array();
foreach($inTheQuestion as $row) {
    if (empty($lines[$row['data_id']])) {
        $lines[$row['data_id']] = array($row['data_id']);
    }
    $lines[$row['data_id']][] = $row['elem_value'];
}
var_dump($lines); 
```

如果这是您想要的格式（从问题中不清楚） - 然后您只需将数据转储到文件中，`fputcsv`或者简单地使用 fwrite。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T23:04:24.793

我确信有一种更简洁的方法可以做到这一点，但这里有一个 bash。这个对我有用...

```
$array = array(
      0 => array(
                  'data_id' => 0,
                  'elem_value' => 'phone',
                  'elem_prettyname' => 'Phone Number'
                 ),
      1 => array(
                  'data_id' => 0,
                  'elem_value' => 'email',
                  'elem_prettyname' => 'Email Address'
                 ),
      2 => array(
                  'data_id' => 1,
                  'elem_value' => 'phone',
                  'elem_prettyname' => 'Phone Number'
                 ),
      3 => array(
                  'data_id' => 1,
                  'elem_value' => 'email',
                  'elem_prettyname' => 'Email Address'
                 )
     );

$string = '"Data ID","Phone Number","Email Address"' . "\n";
foreach($array as $r){
    $data_id[$r['data_id']][] = $r['elem_value'];   
}
foreach($data_id as $k => $d){
    $string .= $k . ",\"" . implode('","',$d) . "\"\n"; 
}
file_put_contents('my.csv',$string); 
```

我假设总是有电话，电子邮件 - 否则它会变得混乱。

# java - 使用条件取消设置 Ant 中的属性和删除 Ant 中的属性

> ID：10644499
> 
> 赞同：7
> 
> 时间：2012-05-17T22:45:50.557
> 
> 标签：java, ant

你如何在ant中取消设置属性？所以它被完全删除为一个属性？

```
<condition property="proguard.config" value="proguard.cfg">
      <isset property="proguarded"/>
</condition>

 <condition property="proguard.config" value="">
      <not>
      <isset property="proguarded"/>
      </not>
</condition> 
```

这似乎可行。然而，即使存在 proguard.config 这样的属性，proguard 也会运行。那么如何有条件地完全删除 proguard.config 作为属性呢？我知道，如果 proguard 发现 .properties 文件中有一个 proguard.config 属性，它将运行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-18T05:54:04.673

[Ant 手册 Property Task](http://ant.apache.org/manual/Tasks/property.html)指出：

> 属性是不可变的：首先设置属性的人会在接下来的构建中冻结它；它们绝对不是变量。

话虽如此，有几个解决方法：

1.  [本地任务](http://ant.apache.org/manual/Tasks/local.html)- 给定范围内的本地属性“阴影”在更高范围内的同名属性（在 Macrodefs 中特别有用）

2.  [Ant-Contrib 可变任务](http://ant-contrib.sourceforge.net/tasks/tasks/variable_task.html)- Ant-Contrib 提供了灵活性，但它也增加了依赖项，有时可能会诱使您编写可能在 Ant 脚本或自定义 Ant 任务中更好地表达的程序性 Ant 代码

* * *

在上面的示例中，如果`proguarded`在执行 Ant 项目期间该属性没有更改，则无需取消设置该属性。例如，您可以有条件地执行目标，如下所示：

```
<target name="proguarded-target" if="proguarded">
  ...
</target>

<target name="not-proguarded-target" unless="proguarded">
  ...
</target> 
```

# javascript - JavaScript - 未定义函数

> ID：10644504
> 
> 赞同：0
> 
> 时间：2012-05-17T22:46:27.443
> 
> 标签：javascript, jquery, html

我已经坚持了几个小时了。我认为是时候重新审视代码了。我对 JavaScript 很陌生，所以我肯定会忽略一些细节。我应该注意到其他功能正常工作。

我正在动态地在表中创建行，并且一些单元格包含 SELECT 元素。这是脚本（只是我遇到问题的部分）：

```
case 2:
    newcell.innerHTML = "<select id='size" + pid + "' class='ad_size' \
                             onChange='updateSubtotal()'> \
                             <option value='0'>Full</option> \
                             <option value='1'>Half</option> \
                             <option value='2'>Quarter</option> \
                             <option value='3'>Eighth</option> \
                             <option value='4'>Directory</option> \
                         </select>";
    break; 
```

以及我只是尝试记录它是否被正确调用的基本功能：

```
function updateSubtotal() {
    console.log("size changed");
    return true;
} 
```

补充一下我最初尝试使用 jQuery .change 执行此操作可能会有所帮助，但它也无法正常工作：

```
$(".ad_size").change(function(){
    console.log("size changed");
}); 
```

你能看到任何愚蠢的错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T22:51:32.357

由于您正在动态添加元素，请尝试使用`delegate`附加事件处理程序。

```
$('tableSelector').delegate('.ad_size', 'change', function(){
    console.log("size changed");
}); 
```

或者`on`，如果您使用的是 jQuery 1.7+，请使用

```
$('tableSelector').on('change', '.ad_size', function(){
    console.log("size changed");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T22:50:07.227

尝试：

```
 $(document).ready(function(){
       $(".ad_size").live('change',function(){
           console.log("size changed");
       });
    }); 
```

# php - 模板页面的规范链接

> ID：10644508
> 
> 赞同：0
> 
> 时间：2012-05-17T22:46:50.327
> 
> 标签：php, javascript, templates, canonical-link

我可以将哪些 PHP 或 Javascript 代码用于模板上的规范链接？我尝试使用下面的 PHP 代码，但它不起作用：

```
<?php
$qs = $_SERVER['QUERY_STRING'];
$page = $_SERVER['REQUEST_URI'];
if(strlen(trim($qs))==0){
 // No query string is present
 $canlink = "<link rel='canonical'
href='http://www.hea-employment.com' . $page . />";
}else{
 // Query string is present
 $canlink = "<link rel='canonical'
href='http://www.hea-employment.com' . $page . "?" . $qs . />";
}
echo $canlink;
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:59:34.520

改变

`$canlink = "<link rel='canonical' href='http://www.hea-employment.com' . $page . />";`

至

`$canlink = "<link rel='canonical' href='http://www.hea-employment.com{$page}'/>";`

或者

`$canlink = '<link rel="canonical" href="http://www.hea-employment.com' . $page . '"/>';`

不用说到底什么不起作用，这就是我可以发现/假设的问题。

您的代码将产生：`<link rel='canonical' href='http://www.hea-employment.com' . abitrary . />`由于您从不关闭第一个“ . 只是一个`.`字符而不是连接。

你的第二个街区也有同样的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T18:20:01.823

1) Your quotes are messed up a bit.

2) Why create a canonical link to self? Here's what I suggest for you to use:

```
<?php

$qs = $_SERVER['QUERY_STRING'];
$page = $_SERVER['REQUEST_URI'];
$canlink = '';

// If query string is present, add a canonical link to avoid duplicate content
if (strlen(trim($qs))) {
    $canlink = "<link rel='canonical' href='http://www.hea-employment.com$page' />";
}
echo $canlink; 
```

# llvm - 打印 llvm 目标程序集

> ID：10644515
> 
> 赞同：1
> 
> 时间：2012-05-17T22:47:23.103
> 
> 标签：llvm

我正在尝试从 Sparc 目标打印程序集。我已经可以从中生成 IR，但不知何故这对目标不起作用。我不确定要添加什么，因为 llvm-is 工具使用返回模块的 ParseIRFile。

[http://pastebin.com/t3M9edrT](http://pastebin.com/t3M9edrT)

我的问题是，虽然我在字符串中有 IR，但我不确定如何添加一个将其用于目标代码生成的通行证。

我需要一些关于在**generateSparcsCode()**函数中更改什么的指针，以使用我刚刚从**generateCode()**方法生成并存储在**m_llvmIR**变量中的 IR。在相同的上下文中，**模块**也是一个类成员，我想知道如何正确地将它用于目标生成代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T06:45:20.643

一个很好的资源是**llc**工具的源代码（在 中`tools\llc\llc.cpp`）。llc 是 LLVM 本机代码生成器 - 它可以将 LLVM IR 编译为目标机器代码，您可以在命令行上选择一个目标（有关详细信息，请参阅[此参考](http://llvm.org/docs/CommandGuide/llc.html)）。

看看**llc**`main`函数中的代码流程。它读取 IR，然后设置目标，最后发出输出。您可以使用该标志来选择**llc**发出的内容（无论是程序集还是带有机器代码的本机对象）。**`-filetype`**

# perl - 有没有办法在 Perl 中使用 Net::SMTP 附加 PDF 文件

> ID：10644519
> 
> 赞同：2
> 
> 时间：2012-05-17T22:48:03.087
> 
> 标签：perl, smtp, attachment

我正在尝试在多部分内容电子邮件上附加 pdf 文件，是的，我知道我可以使用 mime lite 或十亿个 perl 模块，但到目前为止，我仅限于使用 perl 5.8.8，因为它是开箱即用的我有

```
#!/usr/bin/perl
use Net::SMTP;
use MIME::Base64 qw( encode_base64 );
use MIME::Base64 qw( decode_base64 );
use strict;
use warnings;

my $from = 'az@xx.com';
my $to = 'raxxxfael.xx@xxx.com';
my $to2 = 'xx.xx@xxx.com';
my $boundary = 'frontier';

open my $Initial_File, '<', "summary.pdf";
binmode $Initial_File;
open my $Initial_OutFile, '>', "temp.pdf";
my $buf;
while ( read( $Initial_File, $buf, 60 * 57 ) ) {
    print $Initial_OutFile encode_base64( $buf );
}

close $Initial_OutFile;
close $Initial_File;

open INFILE, '<', "temp.pdf";
open my $final_output, '>',"summary2.pdf";
binmode $final_output;
my $buffer;
while ( $buffer = <INFILE> ) {
    print $final_output decode_base64( $buffer );
}
my @pdf = $final_output;
close $final_output;
close INFILE; 

my $smtp = Net::SMTP->new('xx.xxx.com');
$smtp->mail($from);
$smtp->recipient($to,$to2, { SkipBad => 1 });
$smtp->data();
$smtp->datasend("Subject: Test Email \n");
$smtp->datasend("MIME-Version: 1.0\n");
$smtp->datasend("Content-type: multipart/mixed;\n\tboundary=".$boundary."\n");
$smtp->datasend("\n");
$smtp->datasend("--".$boundary."\n");
$smtp->datasend("Content-type: text/plain\n");
$smtp->datasend("Content-Disposition: quoted-printable\n");
$smtp->datasend("\nTest From You \n");
$smtp->datasend("--".$boundary."\n");
$smtp->datasend("Content-Disposition: attachment; filename=summary2.pdf \n");
$smtp->datasend("Content-Type: application/pdf; name=summary2.pdf ");
$smtp->datasend("\n");
$smtp->datasend("@pdf\n");
$smtp->datasend("--".$boundary."--\n");
$smtp->dataend();
# $smtp->quit;   

exit; 
```

电子邮件正确发送，但是（显然）在尝试打开 pdf 文件时说它的编码不正确，有没有办法将 PDF 文件缓冲到附件中，使其按原样发送出去？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-25T04:30:03.260

这是一个如何使用 Net::SMTP 发送多部分邮件消息的工作示例。

提供了用于发送纯文本、纯文本文件和二进制图像 (jpg) 的代码。

希望这可以帮助！

亚历杭德罗

PS。上面提供的代码 RVS 列出了其他几种内容类型，包括 pdf。任何不是纯文本文件的文件都应被视为二进制文件，并以 base64 编码发送。您不需要对其进行解码，因为接收邮件的电子邮件客户端应该负责这一点。

```
#!/usr/bin/perl

use Net::SMTP;
use strict;
use warnings;

use MIME::Base64 qw( encode_base64 );
#use MIME::Base64 qw( decode_base64 );

my $from = 'from@email.com';
my $to = 'to@email.com';

my $attachBinaryFile= 'test.jpg';
my $attachTextFile = 'test.txt';

my $boundary = 'frontier';

open(DAT, $attachTextFile) || die("Could not open text file!");
my @textFile = <DAT>;
close(DAT);

my $smtp = Net::SMTP->new('your.smtp.com', Timeout => 60) || die("Could not create SMTP object.");
print "Sending mail\n";
$smtp->mail($from);
$smtp->recipient($to, { SkipBad => 1 });
$smtp->data();
$smtp->datasend("To: $to\n");
$smtp->datasend("From: $from\n");
$smtp->datasend("Subject: Multi part test\n");
$smtp->datasend("MIME-Version: 1.0\n");
$smtp->datasend("Content-type: multipart/mixed;\n\tboundary=\"$boundary\"\n");
$smtp->datasend("\n");
$smtp->datasend("--$boundary\n");
$smtp->datasend("Content-type: text/plain\n");
$smtp->datasend("Content-Disposition: quoted-printable\n");
$smtp->datasend("\nToday\'s files are attached:\n");
$smtp->datasend("\nHave a nice day! :)\n");
$smtp->datasend("--$boundary\n");
$smtp->datasend("Content-Type: application/text; name=\"$attachTextFile\"\n");
$smtp->datasend("Content-Disposition: attachment; filename=\"$attachTextFile\"\n");
$smtp->datasend("\n");
$smtp->datasend("@textFile\n");
$smtp->datasend("--$boundary\n");
$smtp->datasend("Content-Type: image/jpeg; name=\"$attachBinaryFile\"\n");
$smtp->datasend("Content-Transfer-Encoding: base64\n");
$smtp->datasend("Content-Disposition: attachment; filename=\"$attachBinaryFile\"\n");
$smtp->datasend("\n");
my $buf;
open(DAT, "../uploads/$attachBinaryFile") || die("Could not open binary file!");
   binmode(DAT);
   local $/=undef;
   while (read(DAT, my $picture, 4096)) {
      $buf = &encode_base64( $picture );
      $smtp->datasend($buf);
   }
close(DAT);
$smtp->datasend("\n");
$smtp->datasend("--$boundary\n");
$smtp->dataend();
$smtp->quit;
print "Mail sent\n";
exit; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:06:05.837

最终将 MIME:Lite 手动添加到我的用户目录

```
use lib '/xx/sas/xx/perl';
use MIME::Lite;
open(SMTP,'/xx/sas/xx/perl/MIME/srv.txt') || die("Could not open the file");
my $mail_host = <SMTP>;
close(SMTP);
open(DATA, $ARGV[3] ) || die("Could not open the file");
my @csv = <DATA>;
close(DATA);

foreach (@csv){
    $textStr.= $_;
}

$msg = MIME::Lite->new (
  From => $ARGV[0],
  To => $ARGV[1],
  Subject => $ARGV[2],
  Type =>'multipart/mixed'
) or die "Error creating multipart container: $!\n";

$msg->attach (
  Type => 'TEXT',
  Data => $textStr
) or die "Error adding the text message part: $!\n";

foreach my $file (split(',', $ARGV[4])) { 
        $content_type='TEXT';
        if ( $file =~ /\.gif$/i ){ $content_type ='image/gif'}
        if ( $file =~ /\.jpg$/i ){ $content_type ='image/jpeg'}
        if ( $file =~ /\.zip$/i ){ $content_type ='application/zip'}
        if ( $file =~ /\.html$/i ){ $content_type ='text/html'}
        if ( $file =~ /\.pdf$/i ){ $content_type ='application/pdf'}
        if ( $file =~ /\.xls$/i ){ $content_type ='application/vnd.ms-excel'}
        if ( $file =~ /\.log$/i ){ $content_type ='application/octet-stream'}
        $msg->attach (
           Type => $content_type,
           Path => $file,
           Filename => $file,
           Disposition => 'attachment'
        ) or die "Error adding $file: $!\n";    
}   

MIME::Lite->send('smtp', $mail_host, Timeout=>60);
$msg->send; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:03:34.963

这……看起来不对：

```
open FILE, "summary.pdf" or die $!;
my @txt = <FILE>;
close FILE;

...
$smtp->datasend("@txt\n"); 
```

我相信您寻求的问题在于这两行代码。您正在使用字符串阅读器读取二进制格式，然后将该二进制插入字符串中。

尝试：

```
...
open FILE, "summary.pdf" or die $!;
binmode(FILE);
my $data = do { local $/; <FILE> };
close FILE;
...
$smtp->datasend($data); 
```

或类似的东西。

# php - 在 PHP 中获取 Json 表单数据

> ID：10644520
> 
> 赞同：0
> 
> 时间：2012-05-17T22:48:18.807
> 
> 标签：php, javascript, json, backbone.js

这似乎是一个不寻常的**json**问题，但我可以向您保证，我找不到问题的答案。

在下面的代码示例中，我想获取（可能**解码**正在传输的 json 数据。我已经尝试过**json_decode($_POST)**。顺便说一下，请求类型是**POST**。无论如何我可以将 json 数据获取到一个数组或一个变量，所以当我想调用**姓名**或**年龄时**，我会很容易地从请求中检索它们？

我正在关注**backbone.js**教程，这是我的模型；

```
<script type="text/javascript">
        var URL=Backbone.Model.extend({
            initialize: function()
            {
                console.log("URL has been initialized");
            },
            defaults:{
                name:'not defined',
                age:'not defined'
            },
            urlRoot:"/Backbone/manage.php",
            url:function(){
                var base = this.urlRoot || (this.collection && this.collection.url) || "/";
                console.log("Base has been produced");
                if(this.isNew()) return base;

                return base+"?id="+encodeURIComponent(this.id);
            }
        });

        var url=new URL({name:"John",age:10});
        url.save();
    </script> 
```

后来我使用谷歌浏览器来观看网络，我可以清楚地看到数据是作为**表单数据**传递的。这是谷歌网络工具中的结果；

```
model:{"name":"John","age":10} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:59:51.400

如果您将 JSON 有效负载作为原始发布数据获取，您可以使用以下命令读取它：

```
json_decode(file_get_contents('php://input')); 
```

`$HTTP_RAW_POST_DATA`如果 php.ini 设置允许填充该变量，您也可以从中读取它。

因为你得到的是：

```
model=%7B%22name%22%3A%22John%22%2C%22age%22%3A10%7D 
```

您不能直接将其解码为 JSON，因为它不是有效的 JSON。

所以试试：

```
parse_str(file_get_contents('php://input'), $post);
$myObject = json_decode($post['model']); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T22:55:01.683

您需要对`model`$_POST 数组的键执行 json_decode 。`model`密钥包含您需要解码的 json 字符串。

```
$modelData = json_decode($_POST['model']); 
```

然后您可以访问数据，例如`$modelData->name`或`$modelData->age`；

编辑：

尝试将此添加到您的主干设置中：

```
Backbone.emulateHTTP = true;
Backbone.emulateJSON = true; 
```

这将使你得到`application/x-www-form-urlencoded`而不是`application/json`. 这应该会正确填充您的 $_POST 数组。

见这里的解释：[http ://documentcloud.github.com/backbone/docs/backbone.html#section-162](http://documentcloud.github.com/backbone/docs/backbone.html#section-162)

# silverlight - 使用 SilverLight 从服务器加载免注册 COM 对象

> ID：10644521
> 
> 赞同：1
> 
> 时间：2012-05-17T22:48:32.420
> 
> 标签：silverlight, com, silverlight-5.0

我有一个可以通过 AssemblyPart 加载器下载托管代码的工作原型，但我看不到加载本机 DLL 或 COM 对象的直接方法。我发现的通过流将本机代码加载到内存中的最接近的信息是[创建自己的 loader](http://www.joachim-bauch.de/tutorials/loading-a-dll-from-memory/)。从那进入访问 COM 对象的原始方法似乎有点过分。

**背景：**该应用程序是在提升的权限下运行的签名业务应用程序。我需要运行提供业务所需集成功能的第 3 方 COM 对象。我想避免与在桌面上安装和维护 COM 组件相关的部署挑战。我们在浏览器模式内外运行。

请注意，我们使用的是 SilverLight 5。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T14:58:33.410

我们选择采用的策略包括以包含 COM 对象的应用程序的形式下载 COM 对象的包装器。该应用程序将被下载然后执行。这避免了安装过程并支持服务器端更新。

# javascript - 长 JavaScript 函数结束时 CSS 元素更新

> ID：10644522
> 
> 赞同：0
> 
> 时间：2012-05-17T22:49:14.727
> 
> 标签：javascript, css, ajax

我正在运行一个 js 函数，它使用 ajax 来查询 ldap 服务器以检索多个用户信息并输入到 mysql db。这是通过每次循环使用不同参数的 ldap 请求来完成的。

因为 ldap 服务器响应缓慢，所以我在进度条中添加，每次查询完成时，都会触发对进度条的更新。问题是进度条只在整个函数完成后更新一次，即使 css 更新发生在循环开始之前。

```
function findUsers() {
//set Number of users
var noOfUsers = 10;
var progress = 1;

//progress bar div appears as soon as function begins
//this element change doesn't happen till the function has finsihed
document.getElementById('progress_bar').style.visibility = 'visible';

//loop through users
for( counter = 0; counter <= noOfUsers; counter++) 
    {
    //update element with progress
    document.getElementById('progress_bar').innerHTML = progress + " of " + noOfUsers;  

    //start AJAX
    xhrPostUserIDToLDAP =new XMLHttpRequest();
    xhrPostUserIDToLDAP.onreadystatechange=function()
        {
        if (xhrPostUserIDToLDAP.readyState==4 && xhrPostUserIDToLDAP.status==200)
            {   
            //updates progress var so on next loop, the element is updated
            progress++;
            }
        }
    xhrPostEmployees.open("POST","ajax/ldap.php",false);
    xhrPostEmployees.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xhrPostEmployees.send("userID="+userID);     
    }
    //loop has finsihed, update element with complete notification
    document.getElementById('progress_bar').innerHTML = "Completed"; } 
```

唯一更新元素的是 Completed，但是一旦函数完成，这会在 20 秒后发生。如何在循环循环时更新元素？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:13:40.677

这里的问题是您正在快速循环并发出 10 个*异步请求*。每次您通过循环时，它都会`progress_bar`使用`progress`. 由于回调尚未触发或从服务器返回，`progress`因此始终等于 1。要解决此问题，您需要输入：

```
document.getElementById('progress_bar').innerHTML = progress + " of " + noOfUsers; 
```

`onreadystatechange`在你做之后的回调里面`progress++`。这可确保在每个异步请求返回服务器后，您更新`progress_bar`.

# java - 将 ViewGroup 捕获到图像文件中

> ID：10644526
> 
> 赞同：0
> 
> 时间：2012-05-17T22:49:31.483
> 
> 标签：java, android, android-layout, screen-capture

我有一个简单的一`ImageView`和二的组合`TextViews`。我想让`TextViews`重叠`ImageView`，然后将组合保存为一个整体（例如 PNG）。

我知道我可以使用 a 将`TextViews`其分层，我已经在这样做了。现在我想知道的是，如何将其导出到图像中？`ImageView``FrameLayout`

我阅读了有关使用 Canvas 的各种帖子。有没有办法将其导出`FrameLayout`为PNG图像，或者我需要创建一个画布，添加`ImageView`and`TextViews`并将画布本身导出为PNG？

先感谢您。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-17T23:09:26.607

**可以轻松完成吗？**， 是的

**如何？**

好吧，前几天我碰巧为此做了一个函数，它真的很简单（确保你有写入外部设备的权限）。您所做的就是指定要“绘制”到 a 的视图（它也将包括所有子视图）`Bitmap`，然后您可以像您说的那样将其保存为文件，或者在您的应用程序中的某个位置使用它。

```
public void captureView(int viewId,String filename){
    //Find the view we are after
    View    view = (View) findViewById(viewId);
    //Create a Bitmap with the same dimensions 
    Bitmap image = Bitmap.createBitmap(view.getWidth(), 
                                       view.getHeight(), 
                                       Bitmap.Config.RGB_565);
    //Draw the view inside the Bitmap
    view.draw(new Canvas(image)); 

    //Store to sdcard
    try {
       String path = Environment.getExternalStorageDirectory().toString();
       File myFile = new File(path,filename);
       FileOutputStream out = new FileOutputStream(myFile);

       image.compress(Bitmap.CompressFormat.PNG, 90, out); //Output
    } catch (Exception e) {
       e.printStackTrace();
    }
} 
```

**注意**避免尝试在`onCreate`方法上执行此代码，因为您可能会在绘制视图之前尝试获取视图的宽度和高度，因此会导致错误，因为位图的尺寸**不能**为 0。

**它是按原样还是按创建时捕获视图？**

一开始我并不确定，但经过一些测试后，你所看到的似乎就是你得到的，所以如果你有一些旋转的东西或与发射时的原始配置不同，它会在捕获中反映出来。这可能是也可能不是您所追求的，但这就是它所提供的。这是一个`LinearLayout`捕获的示例（没有屏幕截图或裁剪，只是直接来自设备）。

![查看捕获](../Images/66e25e45b81b5f6e2a34c03be69d5ba5.png)

# javascript - 为什么 jQuery 的这些嵌套触发器不起作用？

> ID：10644528
> 
> 赞同：1
> 
> 时间：2012-05-17T22:49:46.337
> 
> 标签：javascript, jquery

我正在使用以下代码加载两个 underscore.js 模板。单击第一个链接后，将加载骨架模板。第一个触发器执行 find 绑定，它正确执行 loadBookmarks 函数，但“加载”触发器永远不会触发，并且 loadFriendBookmarks 永远不会执行。为什么是这样？还有其他方法可以实现这一点吗？

```
$('#bookmarks-link').click(function() {
  $('#bookmarks-count').text("0");
  var skeleton = modalTemplate();
  $('#bookmarks').append(skeleton);
  $('#bookmarks').trigger('skeleton');
});

$('#bookmarks').bind('skeleton', function() {
  $('#bookmarks .thumbnails').loadBookmarks( getBookmarksUrl(1) );
  // If I add an alert('hi') here, it works perfectly.
  $('#bookmarks').trigger('loaded');
});

$('#bookmarks').bind('loaded', function() {
  $('#bookmarks .thumbnails a').each(function() {
    $(this).bind('click', function() {
      $('#bookmarks .bookmarks-table tbody').empty();
      $('#bookmarks .bookmarks-table tbody').loadFriendBookmarks(
        getFriendBookmarksUrl($(this).attr('data-item'))
      );
    });
  });
}); 
```

非常有趣，触发器确实可以正常工作：如果我在 loadBookmarks 和触发器之间粘贴警报，一切正常。如果我把它拿出来，那就没有了。知道为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T04:44:40.427

根据您的描述和常识，这听起来像是`loadBookmarks()`从远程源加载数据，例如 ajax 调用。这意味着可以在收到数据*之前*`trigger('loaded')`触发。您可以添加一个回调参数并在那里触发事件： *`loadBookmarks()``loadBookmarks()`*

 *```
$('#bookmarks .thumbnails').loadBookmarks( getBookmarksUrl(1) , function() {
  $('#bookmarks').trigger('loaded');
}); 
```

但这需要您`loadBookmarks`知道在它接收到数据并创建所需的 HTML 后调用此函数 - 如果没有看到您在`loadBookmarks`.

* * *

附加建议：不要以这种方式绑定处理程序，而是使用[事件委托](http://api.jquery.com/on/)：

```
$('#bookmarks').on('click', '.thumbnails a', function(e) {
  e.preventDefault(); // don't want the link to actually be followed, do we
  var url = getFriendBookmarksUrl($(this).attr('data-item'));
  if(url) { // in case it's clicked before the data attribute is set
    var $tbody = $('#bookmarks .bookmarks-table tbody');
    $tbody.empty();
    $tbody.loadFriendBookmarks(url);
  }
}); 
```

这意味着与选择器“#bookmarks .thumbnails a”匹配的*所有*元素都将调用此单击处理程序，即使它们是在您调用*之后*`on`添加到文档中的。这意味着您甚至可以在调用之前委托这些事件`loadBookmarks`，从而完全消除对`loaded`事件的需要。另外，这样你在内存中只有一个处理函数的副本，而不是`bind`为每个`a`节点创建一个单独的函数副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T02:26:51.980

问题出在代码中的其他位置。可能是函数中的一些 js 错误`loadBookmarks*`。

看：

[http://jsfiddle.net/BBESV/](http://jsfiddle.net/BBESV/)

触发器完美地工作*

# validation - 在 Grails 域对象中，是否可以基于另一个字段验证一个字段？

> ID：10644534
> 
> 赞同：1
> 
> 时间：2012-05-17T22:50:12.137
> 
> 标签：validation, grails, groovy, grails-orm

我有一个看起来像这样的 Grails 域对象：

```
class Product {
    Boolean isDiscounted = false
    Integer discountPercent = 0

    static constraints = {
        isDiscounted(nullable: false)
        discountPercent(range:0..99)
} 
```

我想添加一个验证器，`discountPercent`它只会验证是否`isDiscounted`为真，如下所示：

```
validator: { val, thisProduct ->
    if (thisProduct.isDiscounted) {
        // need to run the default validator here
        thisProduct.discountPercent.validate() // not actual working code
    } else {
        thisProduct.discountPercent = null // reset discount percent
} 
```

有谁知道我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T03:04:37.990

这或多或少是您需要的（在 discountPercent 字段上）：

```
validator: { val, thisProduct ->
if (thisProduct.isDiscounted)
    if (val < 0) {
        return 'range.toosmall' //default code for this range constraint error
    }
    if (99 < val) {
        return 'range.toobig' //default code for this range constraint error

} else {
    return 'invalid.dependency'
} 
```

你不能同时拥有一个依赖于其他东西的特殊验证器*和*一个特殊的验证器，因为你不能在一个字段（我知道）上运行单个验证器，只能在单个属性上运行。但是如果你在这个属性上运行验证，你将依赖于你自己并进入无休止的递归。因此我手动添加了范围检查。在您的 i18n 文件中，您可以设置类似 `full.packet.path.FullClassName.invalid.dependency=Product not discounted`.

祝你好运！

# android - 安装 ADT 插件

> ID：10644539
> 
> 赞同：1
> 
> 时间：2012-05-17T22:50:53.357
> 
> 标签：android, eclipse, eclipse-plugin, adt

我在安装插件时遇到问题，我尝试过使用和不使用 https、http 等。我已经下载了该文件并尝试以这种方式安装它。

每次底部的绿色条不动，然后大约 10 分钟后我收到此消息。

```
Unable to read repository at http://download.eclipse.org/webtools/downloads/drops/R3.3.2/R-3.3.2-20120210195245/repository/content.jar.
Read timed out 
```

我使用 Windows 7 和 Eclipse 靛蓝。任何想法，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:04:10.720

可能是存储库关闭了一段时间，或者您的防火墙阻止了您与存储库的连接。

[无论哪种方式：阅读并应用http://developer.android.com/sdk/eclipse-adt.html](http://developer.android.com/sdk/eclipse-adt.html)的“疑难解答 ADT 安装”部分

总之：您始终可以下载插件并手动安装（通过复制到正确的文件夹）。

祝你好运！

编辑：如何手动安装插件？该说明再次出现[在](http://developer.android.com/sdk/eclipse-adt.html)“ADT 安装故障排除”部分。如果您碰巧懒得找到该部分，我为您复制了最相关的部分：

*   从下表下载当前的 ADT 插件 zip 文件（不要解压）。
*   启动 Eclipse，然后选择帮助 > 安装新软件...。
*   单击右上角的添加。
*   在“添加站点”对话框中，单击存档。
*   浏览并选择下载的 zip 文件。
*   在“名称”字段中输入本地更新站点的名称（例如，“Android 插件”）。
*   单击确定。
*   在可用软件对话框中，选中开发人员工具旁边的复选框，然后单击下一步。
*   在下一个窗口中，您将看到要下载的工具列表。点击下一步。
*   阅读并接受许可协议，然后单击完成。 *注意：*如果您收到无法确定软件真实性或有效性的安全警告，请单击“确定”。
*   安装完成后重启Eclipse

# javascript - 如何使用 jquery + ajax 制作多个依赖下拉列表

> ID：10644541
> 
> 赞同：3
> 
> 时间：2012-05-17T22:51:01.987
> 
> 标签：javascript, jquery, ajax

我正在尝试构建一个页面，用户可以在其中互相提供工作表。

我正在尝试使用依赖下拉菜单来做到这一点。不确定这是否是正确的术语，所以我将提供一个示例。

大致设置的分类如下：类型 > 类别 > 主题 > 表格

大致我的想法是：

1.  页面为类型加载 json 并显示类型下拉列表
2.  用户将数学、科学、英语视为类型并选择数学
3.  页面使用 ajax 查询数据库并填充 1、2、3 等的主题。
4.  用户选择等级 4
5.  页面使用 ajax 查询数据库并填充适当的 4 年级主题
6.  ...依此类推，直到链的底部

在 JavaScript 部分：

```
<script type="text/javascript" language="javascript">
    var types;
    var categories;
    var topics;
    var sheets;

    //load the first types
    $(document).ready(function(){
        $.ajax({
            async: false,
            url: "base_url/json_get_all_wstypes",
            type: 'POST',
            dataType: 'json',
            success: function(output_string){
                types = output_string;
            }
        });
    });

    //by default - intialize types
    $(document).ready(function(){
        var t_choices = "<select name=\"type_id\" id=\"type_picker\" >";
        t_choices += "<option value=\"\" selected=\"selected\">Select a Type</option>";

        $.each(types, function(){
            t_choices += "<option value=\"" + this.type_id.toString() + "\">";
            t_choices += this.type_name.toString();
            t_choices += "</option>";
        });

        t_choices += "</select>";

        $('#type_choices').text('');
        $(t_choices).appendTo('#type_choices');
    });

    //reaction to picking a type 
    $(document).ready(function(){
        $('#type_picker').change(function(){
            var url_arg = $('#type_picker').val().toString();
            var full_url = "base_url/json_get_wscategories_by_type/" + url_arg;

            $.ajax({
                async: false,
                url: full_url,
                type: 'POST',
                dataType: 'json',
                success: function(output_string){
                    categories = output_string;
                }
            });

            var choices = "<select name=\"category_id\" id=\"category_picker\" >"; 
            choices += "<option value=\"\" selected=\"selected\">Select a category</option>";

            $.each( categories, function() {
                choices += "<option value=\"" + this.category_id.toString() + "\">";
                choices += this.category_name.toString();
                choices += "</option>";
            });

            choices += "</select>";

            alert(choices.toString());

            $('#category_choices').text('');
            $(choices).appendTo('#category_choices');

        });
    }); 

    //reaction to picking a category (initialize topic)     
    $(document).ready(function(){
        $('#category_picker').change(function(){
            var url_arg = $('#category_picker').val().toString();
            var full_url = "base_url/json_get_wstopics_by_category/" + url_arg;

            $.ajax({
                async: false,
                url: full_url,
                type: 'POST',
                dataType: 'json',
                success: function(output_string){
                    topics = output_string;
                }
            });

            var choices = "<select name=\"topic_id\" id=\"topic_picker\" >"; 
            choices += "<option value=\"\" selected=\"selected\">Topic a category</option>";

            $.each( topics, function() {
                choices += "<option value=\"" + this.topic_id.toString() + "\">";
                choices += this.topic_name.toString();
                choices += "</option>";
            });

            choices += "</select>";

            alert(choices.toString());

            $('#topic_choices').text('');
            $(choices).appendTo('#topic_choices');

        });
    }); 

    //reaction to picking a topic (initialize sheet)
    similar code pattern as method before it...

    //reaction to picking a sheet (intialize page)
    similar code pattern as the method before...
</script> 
```

在网络表单部分：

```
<p>
<label for="type_id">Pick a sheet type:</label>
<div id="type_choices">
</div>
</p>

<p>
<label for="categories_id">Pick a category:</label>
<div id="category_choices">
</div>
</p>

<p>
<label for="topic_id">Pick a topic:</label>
<div id="topic_choices">

</div>
</p>

<p>
<label for="worksheet_id">Pick a worksheet:</label>
<div id="sheet_choices">
Please select a topic first to activate this section
</div>
</p> 
```

这适用于选择类型并加载类别的显示，但是一旦我选择类别，什么都不会发生。另外，如果有人能指出网络世界中所谓的内容，我将不胜感激。动态相关下拉菜单没有那么有用，我不知道还能叫什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T23:23:16.763

您的代码不必要地依赖于 jQuery，并且不能有效地重用代码。此解决方案可能需要对您的服务器端代码进行细微的重写，但无论如何应该更加抽象。尝试更多类似的东西：

```
<html>
<body>
<select id="type" onchange="updateNext(this, 'category')">
    <option value="a">A</option>
    <option value="b">B</option>
    <option value="c">C</option>
</select>
<select id="category" onchange="updateNext(this, 'topic')">
</select>
<select id="topic" onchange="updateNext(this, 'worksheet')">
</select>
<script>
    function updateNext(el, nextName) {
        var url_arg = el.value;
        var full_url = "base_url/json_get_wstopics_by_category/" + url_arg;
        var options, txtStrng;
        //grab ajax data
        $.ajax({
            async: false,
            url: full_url,
            type: 'POST',
            dataType: 'json',
            success: function(output_string){
                options= output_string;
            }
        });
        //create the option list
        $.each( options, function() {
            txtStrng += "<option value=\"" + this.option_id.toString() + "\">";
            txtStrng += this.option_name.toString();
            txtStrng += "</option>";
        });
        //clear the option list
        $('#'+nextName).text('');
        //attach the option list
        $(txtStrng).appendTo('#'+nextName);
    }
</script> 
```

# javascript - 如何通过 Javascript 访问表单提交的内容？

> ID：10644543
> 
> 赞同：1
> 
> 时间：2012-05-17T22:51:06.413
> 
> 标签：javascript

我在网站上运行服务器端缓存，并且需要根据提交的表单触发功能。如何通过 Javascript 访问表单提交的内容？通常我会通过 $_POST 使用 PHP 访问这些。

我无法通过 PHP 获取值，因为表单提交后提供的页面是缓存页面，不会执行任何 PHP。

我正在使用 jQuery。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:54:39.547

`$_POST`是一个服务器端 PHP 变量，与 JavaScript 无关。

现在，该`$_POST`变量通常包含某种由表单提交的值，这些**值**可由 JavaScript 访问。您可以遍历表单并非常轻松地获取填写的值。

### 代码示例

如果您使用的是 jQuery，您可以获得如下值：

```
$("#myform input[name=first_name]").val(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T22:59:36.007

```
$('form').submit(function() {
  alert($(this).serialize());
  return false;
}); 
```

如果您使用 jQuery，则可以执行上述操作，

你也可以这样做：

```
var form = document.getElementById("<yourformid>");
for(var i =0; i < form.elements.length; i++){
   // grab form.elements[i]
} 
```

# asp-classic - 调用时客户端出现问题

> ID：10644547
> 
> 赞同：1
> 
> 时间：2012-05-17T22:51:37.303
> 
> 标签：asp-classic

请使用我之前的问题作为参考。我已经标记了一个答案。

[问题](https://stackoverflow.com/questions/10609639/calling-a-web-service-from-http-to-https/10609685#10609685)

我是一名 .NET 开发人员，为一家使用 Classic ASP 的公司做一些工作。我的服务器端开发经验是带有某种 MVC 模式的 VB.NET 或 C#。考虑以下代码片段，我将它写在公司希望保留的 ASP 页面中，并“包含”在需要此 Web 调用的其他页面中。有点像一段可重用的代码。出于理智的原因，我遗漏了一些。

```
//Create ActiveXObject, subscribe to event, and send request
        var xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");

        xmlHttp.onreadystatechange = function() {
            if (xmlHttp.readyState == 4) {
                xmlDoc.loadXML(xmlHttp.responseText);
                debugger;
                var JSON = $.xml2json(xmlDoc);
                parseResponse(JSON);
            }
        }

        urlToSend = encodeURI(REQUEST);
        urlRest += urlToSend
        xmlHttp.open("GET", urlRest, false);
        xmlHttp.send(null); 
```

在与各种安全问题作斗争之后，当这终于奏效时，我很高兴。我更改了 Internet 选项中的一项设置，以允许脚本访问来自其他域的数据。我提出了我的解决方案，但公司必须在每台机器上更改此设置才能使我的脚本正常工作。不是一个理想的解决方案。我该怎么做才能使它在服务器而不是客户端的浏览器上运行？

我对 <% %> 语法有一点了解，但并不多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:53:31.473

这个 SO 问题应该可以帮助您调用服务服务器端： [Calling REST web services from a classic asp page](https://stackoverflow.com/questions/11219/calling-rest-web-services-from-a-classic-asp-page)

总结一下，使用 MSXML2.ServerXMLHTTP

```
Set HttpReq = Server.CreateObject("MSXML2.ServerXMLHTTP")
HttpReq.open "GET", "Rest_URI", False
HttpReq.send 
```

并查看这些文章：

*   [将 ASP.NET XML Web 服务与“经典”ASP 应用程序集成](http://www.4guysfromrolla.com/webtech/070302-1.shtml)
*   [在经典 ASP 中使用 XML Web 服务](http://www.dotnetjunkies.com/Tutorial/99CA4563-FBD4-411F-A9C6-FF9E8A0E664F.dcik)
*   [从 ASP 使用 WSDL Web 服务](http://www.aspfree.com/c/a/ASP/Consuming-a-WSDL-Webservice-from-ASP/)

您还需要一种[解析 JSON的方法](https://stackoverflow.com/questions/1019223/any-good-libraries-for-parsing-json-in-classic-asp)

# php - 凹凸系统（显示最近的帖子，顶部有回复）

> ID：10644548
> 
> 赞同：1
> 
> 时间：2012-05-17T22:51:47.147
> 
> 标签：php, mysql, sql

现在，我使用以下方法对论坛中的所有主题进行排序：

```
SELECT * FROM board ORDER BY id DESC LIMIT 50 
```

这显示了在顶部创建的最新线程，但是我将如何显示具有最新回复的线程但同时在顶部显示一个新线程？

例子：

> 1.  这是一个新线程
> 2.  这是一个旧线程
> 3.  这是一个旧线程

至：

> 1.  这是一个旧线程，有一个新回复
> 2.  这是一个没有回复的新帖子
> 3.  这是一个旧线程

如果有任何帮助，这是回复代码：

```
$sql="INSERT INTO reply (id, name, subject, maintext, ip, date, img)

VALUES

('$idid','$name','$subject','$maintext','$encoded','$date','$image_name')";

if (!mysql_query($sql,$con))

  {

  die('Error: ' . mysql_error());

  }

mysql_query("UPDATE board SET replycount = replycount + 1 WHERE id = $idid"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:01:26.540

如果我理解您的问题，您想按最近的回复和最新的线程进行排序。如果没有有关您的表的更多信息，我无法为您提供确切的语法，但您的查询可能如下所示：

```
SELECT *
FROM board
ORDER BY GREATEST(replyDateTime, creationDateTime)
LIMIT 50; 
```

这使用该函数按, 或...[`GREATEST`](http://dev.mysql.com/doc/refman/5.6/en/comparison-operators.html#function_greatest)对每一行进行排序，以较新的为准。`replyDateTime``creationDateTime`

编辑：

将您的回复信息放在一个单独的表中，您的查询可以使用左连接，然后为板中的每个帖子选择最近的回复......然后使用`GREATEST`选择帖子的创建日期或最近的回复的帖子。

```
/* You will need to specify all your columns in board instead of using * */
SELECT b.ID, b.CreationTimeStamp, MAX(r.CreationTimestamp)
FROM 
    board b
    LEFT JOIN replies r ON r.BoardID = b.ID
/* Include all your columns in your select from board here in your group by */
GROUP BY b.ID, b.CreationTimeStamp
ORDER BY GREATEST(b.CreationTimestamp, MAX(r.CreationTimestamp))
LIMIT 50; 
```

# desire2learn - 从 LTI 到 Valence 的 Desire2Learn 身份验证

> ID：10644549
> 
> 赞同：0
> 
> 时间：2012-05-17T22:51:52.190
> 
> 标签：desire2learn, lti

给定一个 LTI 请求，如何向 Valence API 进行身份验证？

我唯一看到的是这样的：

[Desire2Learn 中的小部件和 API](https://stackoverflow.com/questions/10524572/widgets-and-apis-in-desire2learn)

这似乎表明，当我们的外部学习工具从 D2L 服务器接收到一个 POST 时，我们可以发出一个 Valence API 身份验证请求，它是一个 GET 形式的请求：

"https://{服务器域}/d2l/auth/api/token?x_a={app id}&x_b={未编码的重定向 url 使用应用密钥签名}&x_target={编码的重定向 url}"

因此 D2L 服务器将立即返回以下形式的响应：

{redirect url}?x_a={token id}&x_b={token key}&x_c={用户身份签名}

无需向用户请求凭据。我的问题是：

如果这是正确的，那么 D2L 服务器如何识别正在请求身份验证的用户，因为请求中没有指定用户信息？

是否有某种会话信息必须附加到身份验证请求 url，或者必须以 cookie 的形式伴随它？

如果上述描述不正确，那么在给定 LTI 请求的情况下，外部学习工具如何使用 Valence API 进行身份验证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T13:33:20.223

自动重定向只发生在从 BLTI 或 Widget 回调的场景中。这是因为浏览器仍然有一个登录用户的会话（由会话 cookie 维护）。

到达系统的独立应用程序可能没有该会话，并将通过凭据提示。

另外两个注意事项： - 您可以通过调用“whoami”检索登录用户的信息 - 用户在首次使用应用程序时会收到提示，询问他们是否希望应用程序代表他们访问数据。

**更新：** 我已经将一个[基本示例](http://code.google.com/p/desire2learn-valence/downloads/detail?name=BLTIValence.zip)放在一起显示 LTI 和 Valence，并写了一篇[快速博客文章来更详细地描述它](http://devs.valence.desire2learn.com/2012/06/05/blti-and-valence-sample/)

# jquery - 如何在表格中查找不包含特定类别图像的单元格数量

> ID：10644551
> 
> 赞同：1
> 
> 时间：2012-05-17T22:52:06.430
> 
> 标签：jquery

我有一张像这样的桌子：

```
<table>
  ...
  <td class="projectapproval">
    <img src="../../Content/Images/stock_lock.gif" alt="locked" class="lockicon invisibleforprint" />
  </td>
  <td class="projectapproval">
  </td>
  <td class="projectapproval">
  </td>
  ...
</table> 
```

我所拥有的是：

```
$('table td.projectapproval img.lockicon').length 
```

这将计算带有锁定图标的表格中的单元格数。

我想要的是计算没有锁定图标的表格中的单元格数量。在这种情况下是两个。

有谁知道这样做的好方法？

我当然可以去：

```
$('table td.projectapproval).length - $('table td.projectapproval img.lockicon').length 
```

但我真的想要一种更清洁的方式。一个存在吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T22:53:58.143

尝试这个

```
$('table td.projectapproval:not(:has(img.lockicon))') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T23:16:36.993

另一种方法是使用过滤器功能：

```
$('table td.projectapproval').filter(function() {
    return !$(this).children('img.lockicon').length;
    // use the find function if you're not looking for immediate children:
    return !$(this).find('img.lockicon').length;
}) 
```

# c - 为什么这个条件会导致段错误？

> ID：10644555
> 
> 赞同：1
> 
> 时间：2012-05-17T22:52:43.127
> 
> 标签：c, pointers, dereference

这是什么原因？我认为如果指针为空，则不会评估其余条件。

```
// doesn't work:
char *ptr = somefunction();

if (ptr && ptr[0] == '1' || ptr[0] == 't')
  // ...

// does work:
char *ptr = somefunction();
if (ptr)
    if (ptr[0] == '1' || ptr[0] == 't')
        // ... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T22:54:38.610

```
ptr && ptr[0] == '1' || ptr[0] == 't' 
```

方法：

*   if `ptr && ptr[0] == '1'`(false, 因为`ptr`是 null 并且`ptr[0] == '1'`不被评估)
*   或`ptr[0] == 't'`（繁荣）

利用：

```
ptr && (ptr[0] == '1' || ptr[0] == 't') 
```

反而。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-17T22:55:26.260

`&&`具有[更高的优先级](https://en.wikipedia.org/wiki/Operators_in_C_and_C++#Operator_precedence)，`||`因此代码等效于：

```
if ((ptr && ptr[0] == '1') || ptr[0] == 't') 
```

如果第一个失败，则评估`(...&&..)`后半部分。`||`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T22:54:50.797

您的评估顺序不正确。这将起作用：

```
if (ptr && (ptr[0] == '1' || ptr[0] == 't')) 
```

基本上，任何时候你的代码中都有这两者`&&`，`||`你需要一个括号来确保它符合你的意思。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-17T23:30:25.240

您有 Null ptr && dereferenced Null ptr 这会导致段错误。

C 让您可以选择让 if (ptr == NULL) 之类的语句做某事；如果在检测到空指针时它总是将条件评估为假，那么这样的语句将不起作用。

# android - 如何在 Honeycomb+ 设备的 Android 通知中显示时间戳？

> ID：10644556
> 
> 赞同：3
> 
> 时间：2012-05-17T22:52:49.067
> 
> 标签：android, android-layout

我想在 Android 通知中显示时间戳，就像[Android 设计指南建议的那样。](http://developer.android.com/design/patterns/notifications.html)（见第一个快照，“12:03PM”是我想要的！）。

我尝试了许多不同的方法，我认为`setWhen`会这样做，但它似乎只会影响通知托盘中的排序。知道如何实现吗？

请参阅下面的代码：

```
 Notification.Builder builder = new Notification.Builder(context);
  builder.setContentIntent(pendingIntent)
    .setSmallIcon(R.drawable.ic_notify)
    .setLargeIcon(largeIcon)
    .setTicker(text)
    .setNumber(unreadCount)
    .setWhen((new Date()).getTime())
    .setAutoCancel(true)
    .setContentTitle(title)
    .setContentText(text)
    .setDefaults(Notification.DEFAULT_VIBRATE);

notificationManager.notify(NOTIFICATION_ID, builder.getNotification()); 
```

我不想为通知使用自定义布局。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T14:37:31.190

我想我自己找到了答案，`when`似乎只在 Android 4.0 上显示。**3**及以后。我妻子的 Nexus S (4.0.3) 显示它，我刚刚升级到 4.0。**4**在我的 Galaxy Nexus 上，它神奇地开始工作！

它还显示在旧版本（例如 2.3）上，但不显示在 4.0 上。**2**！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T23:18:37.693

使用`setContentInfo`并将您的日期作为字符串传递给它。

从[这个](http://developer.android.com/reference/android/app/Notification.Builder.html#setContentInfo%28java.lang.CharSequence%29)链接

> public Notification.Builder setContentInfo (CharSequence info) 自：API 级别 11
> 
> 在通知的右侧设置大文本。

通知右侧的大文本应该是您想要放置时间的地方。

也来自同一个链接：

> public Notification.Builder setWhen (long when) 自：API 级别 11
> 
> 设置事件发生的时间。面板中的通知按此时间排序。

这意味着`setWhen`只对通知进行排序，不设置任何文本。

# c# - 有没有办法限制匿名函数参数的范围？

> ID：10644557
> 
> 赞同：0
> 
> 时间：2012-05-17T22:52:53.547
> 
> 标签：c#, .net, c#-4.0, closures, anonymous-function

我有一个采用匿名函数参数的方法。该函数的参数由局部变量提供。

```
public void DoSomething<T>(Action<T> method) where T : new()
{
    T instance = new T();
    method.Invoke(instance);
} 
```

我想防止创建闭包。完成后，局部变量应该超出范围`DoSomething<T>`。有没有办法在编译时限制它？

这是我要避免的情况：

```
Foo capturedInstance = null;
DoSomething<Foo>(item => capturedInstance = item);
capturedInstance.Call(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T21:09:32.743

如果`T`是一个结构，那么保存类型字段或`T`类型数组的代码将可以`T[]`将该字段或数组元素作为`ref`参数传递给外部方法；该方法将能够在该字段或数组槽上直接有效地操作，而无需制作结构的临时副本，但是一旦该方法返回保存该字段或数组的类型，就可以确信外部代码无法再访问该槽. 当然，Outside 可以复制字段或元素的内容，但它无法更改原始内容，除非或直到持有该结构的类型再次将其暴露给外部代码。

不幸的是，如果`T`是一个可变类，那么暴露一个引用将允许外部代码随意复制并永远传递该引用。出于这个原因，可变类比可变结构更糟糕的数据持有者。如果希望允许外部代码在不暴露直接引用的情况下使用类，则有必要创建一个包装类和接口。不幸的是，如果不使用大量重复的代码，或者使用反射在运行时生成包装器，就无法做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T22:56:55.427

不幸的是*，这是不可能的。您几乎无法控制方法对其参数的作用。如果您不使用泛型类型，则可以解决，但您使用的是，所以不要担心这种情况。（我希望你不必这样做。）

* * *

^(* 实际上，我认为它是“幸运的”。这不是我们在这里讨论的 C++。)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-17T23:14:58.227

我认为你的代码已经做了你想要的。代表 lambda 的委托`item => capturedInstance = item`仅传递给`DoSomething<Foo>`，并且该引用不会分发给其他任何人。因此，当包含方法完成时，委托将超出范围。lambda 表达式捕获的局部变量也是如此。仅当您传递对委托的引用时，您才会获得所需的行为。

# umbraco - Umbraco 5 如何获取所有角色和用户

> ID：10644561
> 
> 赞同：2
> 
> 时间：2012-05-17T22:53:22.013
> 
> 标签：umbraco, umbraco5

我想获取系统中的所有成员角色和系统中的所有成员。

我试过使用

```
System.Web.Security.Roles.GetAllRoles();
System.Web.Security.Roles.GetUsersInRoles(roles[0]); 
```

和其他几个，但他们都抛出未实现的错误。

我正在使用在 IIS Express 和 SQL Express 上本地运行的 V5.1 的干净 VisualStudio Umbraco 模板。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T21:49:13.270

我注意到在从后台填充角色列表时没有询问提供者，并得出结论，不仅没有调用 getallroles，[而且从未实施过。](http://our.umbraco.org/forum/developers/api-questions/31604-Umbraco-51-roleprovider-support)

相反，会在配置单元中查询角色列表。

尽管声称从 5.1 开始再次加入会员服务，但它也有一些特别严重的限制。

如果您致力于 5.1 并且需要自定义角色提供程序，那么您需要提出一个偶尔将角色同步到 Umbraco 的解决方案。

如果您不需要自定义角色提供者，那么您可以查询配置单元以拉取相关内容。特殊网址是：

**安全：//配置文件**

*用于由 Hive Membership Wrapper 存储配置文件数据。配置文件数据是无法存储在 ASP.Net MembershipProvider 中的任何成员/用户的附加数据*

**安全：//用户组**

*用于存储后台用户组/角色的数据。*

**安全：//成员组**

*用于存储成员组/角色的数据。*

**安全：//成员类型**

*用于存储成员类型的架构数据*

**安全：//会员数据**

*由 UmbracoMembershipProvider 用于存储 ASP.Net MembershipProvider 信息*

**安全：//用户**

*用于查询后台用户的 Hive 成员资格提供程序包装器*

**安全：//成员**

*用于查询 Umbraco 成员的 Hive 成员资格提供程序包装器*

最后，请注意会员服务现在已被抽象化。Umbraco 有一个全新的独立界面供会员使用。

您可以使用当前 IRoutableRequestContext 中可用的成员服务，而不是使用“基线”.net 成员提供程序和角色提供程序：

例如，您将使用包装所提供的 MembershipProvider 的 _context.Application.Security.Members.Validate() 而不是使用 Membership.ValidateUser()。

祝你好运，并在社区一起艰难完成此版本时发布您自己的任何发现。

编辑：获取成员角色列表的示例

```
using (var securityUow = context.Application.Hive.OpenReader<ISecurityStore>())
{
   return securityUow.Repositories.GetEntityByRelationType<UserGroup>
   (
          FixedRelationTypes.DefaultRelationType,  
          Umbraco.Framework.Security.Model.FixedHiveIds.MemberGroupVirtualRoot
   ).OrderBy(x => x.Name).ToList();

} 
```

# google-docs - 通过 Google Apps 脚本更改文档的权限

> ID：10644567
> 
> 赞同：2
> 
> 时间：2012-05-17T22:53:59.127
> 
> 标签：google-docs, google-apps-script

我正在寻找基于电子邮件地址和传递给脚本的 DocumentID 重置外部电子表格默认权限的示例脚本。我打算创建一个脚本，该脚本可以从电子邮件消息中解析信息以获取 DocumentID 和电子邮件，执行从默认到*具有链接的任何人*的权限更改，然后使用该链接通过电子邮件发送传递的地址。

似乎烫发是由 DocList API 控制的，我没有找到与该 API 交互的 GAS 样本。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-30T12:03:01.230

在 2013 年 Google I/O 上，推出了 DriveApp。这允许开发人员构建用例，例如通过链接分享给任何人

[https://developers.google.com/apps-script/reference/drive/](https://developers.google.com/apps-script/reference/drive/)

示例代码 -

```
 var quizTemplate = DriveApp.getFileById(QUIZ_TEMPLATE_ID);  
  quizTemplate.setSharing(DriveApp.Access.DOMAIN_WITH_LINK, DriveApp.Permission.VIEW); 
```

或者

```
 var openFile = DriveApp.getFileById(WIDE_OPEN_ID)
  openFile.setSharing(DriveApp.Access.ANYONE_WITH_LINK, DriveApp.Permission.COMMENT); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T01:08:39.583

AFAIK DocsList 服务没有更改共享模式的功能，在私人/任何有链接的人/公共之间，只能添加/删除编辑者和查看者。但是我们仍然可以通过之前手动将特定文件夹的共享设置设置为“任何有链接的人”来实现这一点。然后，我们只需将文件添加到该文件夹​​即可共享。

执行此操作的脚本特别简单。例如

```
function shareWithAnyoneAndEmail(documentID,email) {
  var sharedFolder = DocsList.getFolderById('id-to-your-previously-shared-folder');
  var file = DocsList.getFileById(documentID);
  file.addToFolder(sharedFolder);
  MailApp.sendEmail(email, 'Here is your file', file.getName()+'\n'+file.getUrl());
} 
```

# c++ - C++ lambda 错误：没有合适的默认构造函数可用

> ID：10644575
> 
> 赞同：2
> 
> 时间：2012-05-17T22:54:47.260
> 
> 标签：c++, visual-c++, lambda, c++11

好吧，这是我第一次使用 lambda，我知道我可能会误用这个功能，但我想知道为什么会出现编译错误？

```
GameMap::MoveDirection AIPlayer::getSafeRouteTo(const GameMap::PlayerInfo& s, const Point& e)
{
    struct node : public Point
    {
        GameMap::MoveDirection parent;
        float d;
        node():Point(){};
        node(Point p) : Point(p)
        {
        };
    };
    auto lambdaFunction = [this,&e](node&left,node&right)->bool
    {
        return this->getDistance(left,e) + left.d < this->getDistance(right,e) + right.d;
    };
    priority_queue<node,vector<node>, decltype(lambdaFunction)> Q;
    //do stuff
    return GameMap::MD_None;
} 
```

为了论证，让我说 MoveDirection 是一个枚举，而 Point 确实有一个默认构造函数。正如我通过删除该特定行评论的那样，我没有收到错误，但我真的需要它在那里。以下是 VC2010 生成的错误：

```
d:\program files (x86)\microsoft visual studio 10.0\vc\include\queue(225): error C2512: '`anonymous-namespace'::<lambda0>' : no appropriate default constructor available
1>          d:\program files (x86)\microsoft visual studio 10.0\vc\include\queue(223) : while compiling class template member function 'std::priority_queue<_Ty,_Container,_Pr>::priority_queue(void)'
1>          with
1>          [
1>              _Ty=AIPlayer::getSafeRouteTo::node,
1>              _Container=std::vector<AIPlayer::getSafeRouteTo::node>,
1>              _Pr=`anonymous-namespace'::<lambda0>
1>          ]
1>          c:\users\ali\documents\visual studio 2010\projects\bokhorbokhor\aiplayer.cpp(147) : see reference to class template instantiation 'std::priority_queue<_Ty,_Container,_Pr>' being compiled
1>          with
1>          [
1>              _Ty=AIPlayer::getSafeRouteTo::node,
1>              _Container=std::vector<AIPlayer::getSafeRouteTo::node>,
1>              _Pr=`anonymous-namespace'::<lambda0>
1>          ]
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-17T23:05:47.883

lambda 不是默认可构造的。您必须将其传递给以下构造函数`priority_queue`：

```
explicit priority_queue(const Compare& x = Compare(), Container&& = Container()); 
```

像这样：

```
priority_queue<node,vector<node>, decltype(lambdaFunction)> Q ( lambdaFunction ); 
```

# asp.net - Asp.net 从字符串变量将脚本添加到页眉

> ID：10644579
> 
> 赞同：0
> 
> 时间：2012-05-17T22:55:18.580
> 
> 标签：asp.net

我需要将来自 AD 服务器的 ADS 显示到我的 ASP.NET 页面。我将脚本（作为我的设置的一部分）存储在数据库中。将脚本加载到字符串变量后，如何在运行时将脚本添加到页眉？这是脚本

```
<script type="text/javascript">var proto = "http:"; if (document.location.protocol == "https:") { proto = "https:" }var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src= proto + "//static.adserver.net/ad.js";var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z, s);</script>
<script type="text/javascript">
var ad = ad || {};
ad.run = ad.run || [];
ad.run.push(function() {
<!-- load placement for account: youraccount, site: yoursite, size: 500x120 - 500x120-->
ad_add_placement(1234, 99999, "abc12345", 12);
ad_load();
});</script> 
```

我见过一些例子，你可以在没有标签的情况下加载脚本，例如

```
//HtmlGenericControl HTMLControl = new HtmlGenericControl() { TagName = "script" };    //HTMLControl.Attributes.Add("type", @"text\javascript");
//HTMLControl.InnerText = myScript;
//this.Page.Header.Controls.Add(HTMLControl); 
```

但是，在我的情况下，我更愿意保持我的脚本与从 AD 服务器接收到的脚本相同，而不更改它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:21:36.623

您可以使用[ClientScriptManager.RegisterClientScriptBlock 方法](http://msdn.microsoft.com/en-us/library/bahh2fef.aspx)将脚本块添加到页面顶部。

# java - 用指数解析字符串 (Java)

> ID：10644581
> 
> 赞同：3
> 
> 时间：2012-05-17T22:55:29.767
> 
> 标签：java, string, parsing, int, double

我有一个类似于： 的字符串`7.6E+7`。

我的问题很简单：如何将其转换为相应的数字：`76000000`？

我尝试使用`substring`隔离`E+7`部件，然后解析`7`部件，然后将小数位移动到 7 以上。有没有更简单的方法来做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T23:13:59.053

```
long n = Double.valueOf("7.6E+7").longValue();
System.out.println(d);
// prints 76000000 to the output. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-17T22:59:12.203

我建议使用[`Double.parseDouble()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Double.html#parseDouble%28java.lang.String%29)：

```
double val = Double.parseDouble(str); 
```

`str`输入字符串在哪里。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-17T22:59:27.267

您可以使用 Double.parseDouble() 将其作为数字获取。

```
String e = "7.6E+7";
System.out.println(Double.parseDouble(e)); 
```

给出输出 7.6E7。如果您不希望 E 在输出中使用，您可以使用

```
NumberFormat f = NumberFormat.getInstance();
f.setGroupingUsed(false);
System.out.println(f.format(Double.parseDouble(e))); 
```

这将为您提供输出 76000000 而无需转换为整数。例如，将 0.1 添加到数字将给出输出 76000000.1

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-17T23:00:34.783

如果您确定该数字最终可以转换为整数而不会丢失精度，那么您可以这样做：

```
int d = (int) Double.parseDouble("7.6E+7");
System.out.println(d); 
```

打印`76000000`到输出。

# java - Eclipse项目运行时错误中的Jar

> ID：10644582
> 
> 赞同：0
> 
> 时间：2012-05-17T22:55:30.033
> 
> 标签：java, eclipse, android-emulator, jar, classpath

我在我的 Eclipse 项目中使用[json-simple](http://code.google.com/p/json-simple/)作为外部 Jar。**此外部Jar**的 Classpath已正确设置到 .classpath 文件中：

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
        [...]
        <classpathentry kind="lib" path="json-simple-1.1.1.jar"/>
        [...]
</classpath> 
```

Java 代码**编译没有任何错误**。

当我运行编译后的代码时，出现以下**运行时错误**：

```
Could not find class 'org.json.simple.parser.JSONParser',  referenced from method [...] 
```

我不明白为什么，我想我错过了一些东西，但我无法弄清楚。
感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T15:13:59.610

当您的应用程序在模拟器中运行时，您必须使该库在运行时可用。为此，请按照[文档](http://developer.android.com/guide/developing/projects/index.html#ApplicationProjects)`json-simple-1.1.1.jar`将文件放在`assets/`or`libs/`目录中。它将在文件中与您的应用程序捆绑在一起，并且应该在运行时可用。`.apk`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T22:58:36.940

假设您*在 Eclipse*中运行它，请查看 Run/Debug 配置中的类路径设置。这个类路径似乎与 Eclipse 中的普通项目/编译器类路径设置不同。

# android - Adobe cirrus android应用程序退出/重新启动没有任何错误

> ID：10644583
> 
> 赞同：2
> 
> 时间：2012-05-17T22:55:43.167
> 
> 标签：android, apache-flex, adobe, terminate, adobe-cirrus

问候。

我目前正在开发一个跨平台测试项目，其中涉及用于视频聊天等的 adobe cirrus。该应用程序是在 flex 和 A3 中以 Flash builder 4.6 标准（无分析器选项）编写的，目标平台是 Windows 和 Android。

两者都使用相同的代码，而且奇怪的是，Windows 版本运行良好，没有任何冻结/意外终止，但 android 有时会在使用视频聊天后退出应用程序回到 android 主屏幕。当我重新选择应用程序窗口时，它似乎已经重新启动。

我尝试在设备上以“调试”模式运行应用程序，但是当应用程序崩溃/退出时没有弹出错误，只是“终止，退出值：0”消息。我正在使用资源监视器应用程序来监视内存和 cpu 以检查它是否是内存不足的问题，但是该应用程序似乎使用了稳定的 60-70mb 内存，剩下大约 280-300mb 并且 cpu 处于最高状态80%。

我还尝试将所需的电话“正确”更改为所有内容，即使我真的只需要电话 wifi 状态、internett 和 camp&mic。

测试时，除了资源监视器和测试应用程序之外，我没有运行任何其他应用程序。

那么有什么线索吗？

# css - WebLogic 和 Webapp Combo 崩溃后不显示图片

> ID：10644587
> 
> 赞同：0
> 
> 时间：2012-05-17T22:56:14.070
> 
> 标签：css, weblogic, war, image

当我的计算机崩溃时，我正在计算机上的 WebLogic 9.2 中在 WAR 中运行 Java webapp。当我重新启动计算机时，一切正常，但是图像没有显示在 webapp 中，webapp 也没有拾取 CSS。一切都打包到 WAR 中，我没有使用 webLogic.xml 来映射任何内容。

去年发生了这样的事情（图像和 CSS 的丢失，而不是计算机崩溃），我最终通过进入 weblogic 管理员、停止 webapp、卸载 webapp、重新安装并重新启动来修复它。

这次不行。

任何人都有任何想法这是关于什么以及我如何解决它。

我的组织正在努力升级到 WebLogic 11.2，但还有大约一个月的时间。

非常感谢您提供任何线索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:31:34.363

罪魁祸首原来是我正在开发的一个新的 ServletFilter。ServeltFilter 在让人们通过我的站点中的 JSP 和 Servlet 之前检查身份验证状态。

虽然我在 ServletFilter 中设置了条件以不对登录页面等内容进行任何过滤，但我并没有做任何事情来确保我的 /css、/images、/js 目录中的文件不受影响。

当我为这些目录添加类似的条件时，重新安装 *.war 并重新启动 *.war 问题就解决了。

我想在我的计算机和 WebLogic 崩溃之前我没有看到问题，因为图像和 CSS 以某种方式被缓存......直到崩溃。

# iphone - 如何将 UINavigationController UIToolbar 添加到视图的顶部而不是底部

> ID：10644588
> 
> 赞同：3
> 
> 时间：2012-05-17T22:56:16.823
> 
> 标签：iphone, ios, uitableview, uinavigationcontroller, uitoolbar

我正在尝试`UINavigationController` `UIToolbar`在视图顶部添加一个（在导航控制器下。

我的观点是`UITableViewController`……所以要处理这个问题。目前我只是定位`UIToolbar`出现在视图底部的我希望它显示的位置

```
[self.navigationController.toolbar setFrame:CGRectMake(0, 60, 320, 30)]; 
```

这会将工具栏定位在我希望它出现的正确位置，但是它的位置存在问题，我将对此进行解释。

当您设置`UINavigationController`要显示的工具栏时，它会将自己置于视图的底部并将 UITableView 向上推，因此工具栏不会覆盖 tableview。但是，当我更改工具栏的位置时，tableview 仍然认为工具栏位于屏幕底部，这意味着工具栏不会在屏幕底部与我希望的齐平。

所以我的问题是如何让工具栏直接显示在导航控制器栏的下方，并将 tableview 向下推以适应新位置的工具栏。

我希望这一切都有意义，我想要的任何帮助都比提前和以下是我正在使用的当前代码（所有这些都是基本的，我仍然对幕后发生的事情感到困惑）。

```
- (void) viewDidLoad
{
//..

    [self.navigationController setToolbarHidden:NO animated:YES];
    [self.navigationController.toolbar setFrame:CGRectMake(0, 60, 320, 30)];
    self.navigationController.toolbar.tintColor = [UIColor lightGrayColor];

//..
} 
```

# 更新

这是目前工具栏对我的表格视图所做的

![在此处输入图像描述](../Images/543ab6955785e6d662907178c74f1092.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-17T22:59:37.773

在您的 UITableView 上调用 setFrame 以将其移动到位置。

```
float y = self.navigationController.toolbar.frame.origin.y + self.navigationController.toolbar.frame.size.height;
[myTable setFrame:CGRectMake(0, y, self.view.frame.size.width, self.view.frame.size.height-y)]; 
```

# c# - DBContextlazyloadingenabled 设置为 true 仍然默认加载相关实体

> ID：10644590
> 
> 赞同：6
> 
> 时间：2012-05-17T22:56:46.323
> 
> 标签：c#, entity-framework-4.1

LazyLoadingEnabled 专门设置为 true 以防止相关实体在我正在使用的上下文中加载。

药物类别中有一个药物身份对象列表。

```
public class Drug
{
   public virtual List<DrugIdentity> DrugIdentities { get; set; }
} 
```

如果我想包含要加载的相关实体，则该类的特定配置会设置键和 hasmany 关系。

```
public DrugConfiguration()
    {
        this.HasKey(d => d.DrugID);
        this.HasMany(d => d.DrugIdentities).WithOptional(d => d.Drug).Map(d => d.MapKey("DrugID"));
    } 
```

当使用 linq 查询加载 Drug 上下文时，对象显示它包含相关的 DrugIdentities，而它不应该包含相关的 DrugIdentities。

```
context.Configuration.LazyLoadingEnabled = true;

                    var drugs = from d in context.Drug
                                where d.Active == true
                                select d; 
```

药物[0].DrugIdentities 计数 = 1

我希望drugs[0].DrugIdentities 等于NULL，因为延迟加载设置为true？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T02:42:53.480

要禁用延迟加载，请将 LazyLoadingEnabled 设置为 false 而不是 true。请参阅相关数据的**延迟、急切和显式加载**

[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/reading-related-data-with-the-entity-framework-in-an-asp-net-mvc-应用](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/reading-related-data-with-the-entity-framework-in-an-asp-net-mvc-application)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T17:40:39.253

`ProxyCreationEnabled = false`如果要设置，则必须专门设置`LazyLoadingEnabled = true`。

测试通过了我的预期。第一个查询返回`Drugs`对象和`NULL`for `DrugEntities`。第二个查询返回 ，`DrugEntities`因为我使用`Include`来进行急切加载。

```
var queryDrug = from d in context.Drug
                                where d.Active == true
                                select d;

                var drugresults = from d in context.Drug.Include(e => e.DrugIdentities)
                                  where d.Active == true
                                  select d; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-14T02:59:05.563

这是延迟加载的行为。如果你只是使用药物的属性，那么不会有任何sql来查询DrugIdentities。如果您使用 DrugIdentities 甚至只是在调试窗口中观看它，那么将有 sql 来查询 DrugIdentities 并且每个药物都有一个 DrugIdentities 搜索查询。您可以通过查看 SQL Profiler 捕获的 sql 来证明该行为。如果您希望 DrugIdentities 在查询药物时为空，您可以通过删除 DrugIdentities 之前的虚拟关键字来更改模型。然后，当您查询药物时，DrugIdentities 将保持为空，直到您通过另一个查询将 DrugIdentities 加载到上下文中。

# c++ - 为什么 rand() 在这个 for 循环中使用 srand(time(null)) 返回相同的值？

> ID：10644593
> 
> 赞同：4
> 
> 时间：2012-05-17T22:56:57.960
> 
> 标签：c++

我有以下代码

```
#include<iostream>
#include "time.h"

using namespace std;

void printRandomNumber()
{
    srand(time(NULL));
    cout << rand() % 3;
}

int main()
{
    for(int i=0; i<=5; i++)
    {
        printRandomNumber();
    }
system("pause");
} 
```

输出是重复六次的相同数字，我希望它打印出混合数字。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-17T22:58:35.160

因为您每次都使用相同的值播种——`time`只有秒级精度，而且我很确定您的计算机可以在一秒钟内处理这六个循环迭代。;-]

播种*一次*，在程序开始时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-17T22:58:42.697

因为当然，您通常每次都在为 srand 喂食相同的种子，因为您的循环将花费不到 1 秒的时间。

srand 函数只能在程序的生命周期中调用一次。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-17T22:59:28.343

您应该`srand`在开始时使用一次。每个可能的种子对应于一组特定的伪随机数，当使用该种子时，这些伪随机数总是相同的。由于您要以秒为基础，因此您没有给它时间进行更改。因此，您每次都会获得同一组数字中的第一个数字。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-09-27T23:43:56.977

这是因为您的随机种子本质上是相同的。您在这里有 2 个解决方案：

*   您可以将其放在`srand(time(0))`代码的开头。这将为每个循环生成更好的随机序列。

*   如果你想在`srand(time(0))`main() 之外，你可以在你的函数中`srand(time(0))`替换。`srand(rand())`这将生成一个*随机*随机种子，从而产生更好的情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-19T11:05:19.333

这将适用于您的情况

```
 #include<iostream>
    #include "time.h"

    using namespace std;

    // Reset the random number generator with the system clock.
    void seed()
   {
       srand(time(0));
   }

    void printRandomNumber()
    {        
        cout << rand() % 3;
    }

    int main()
    {
        seed();
        for(int i=0; i<=5; i++)
        {
            printRandomNumber();
        }
    system("pause");
    } 
```

# asp.net - 在asp.net控件之前的html中奇怪的“”引号

> ID：10644594
> 
> 赞同：3
> 
> 时间：2012-05-17T22:57:03.227
> 
> 标签：asp.net, html, custom-controls

我看到了一个非常奇怪的 asp.net 渲染问题。我在 .aspx 的相关部分中确实有这个（只是替换了路径和控件的名称）：

```
<div id="header">
 <% if (SiteSettings.SiteName.Equals("sx") || SiteSettings.SiteName.Equals("sw"))
    { %>
        <sc:sublayout runat="server" renderingid="{B04CFA1A-6B5B-49D3-8000-339DBE9899C1}"
          path="/layouts/AX/HeaderSublayout.ascx" id="AXHeader" placeholder="content"></sc:sublayout>
 <% }
    else
    { %><!-- bla1 --><ax:strangeBehavingControl id="HeaderInclude" runat="server" IncludeType="Header" /><!-- bla2 -->
 <% } %>
</div> 
```

呈现的 html 看起来像：

```
<!-- bla1 -->
""
expected content from strangeBehavingControl
<!-- bla2 --> 
```

奇怪行为控制的 .ascx 非常简单：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="strangeBehavingControl.ascx.cs" Inherits="layouts.strangeBehavingControl" %> 
```

任何地方都没有多余的空格，已经检查了很多次。后面的代码也很简单：

```
public partial class strangeBehavingControl: System.Web.UI.UserControl
    {

    protected override void Render(HtmlTextWriter writer)
        {
            var filePath = GetFilePath();
            if (!string.IsNullOrWhiteSpace(filePath) && File.Exists(Server.MapPath(filePath)))
                Response.WriteFile(filePath);
        }  
    } 
```

所以我在想渲染的包含文件中的奇怪“”，但我手动检查了它们，它们以预期的字符开头。知道如何将这些字符插入那里吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T00:36:47.220

您为控件生成的标记不正确。您的渲染方法应该使用`HtmlTextWriter`给它的实例，而*不是*在`Response`.

它也看起来像一个相当奇怪的设置，因为您将内容写为`UserControl`，这意味着它将在页面中呈现。假设您总是输出有效的 HTML 或纯文本是否正确？

我建议你改变你的`Render`方法如下：

```
protected override void Render(HtmlTextWriter writer)
{
    var filePath = GetFilePath();
    if (!string.IsNullOrWhiteSpace(filePath) && File.Exists(Server.MapPath(filePath)))
        using (var sr = new StreamReader(filePath))
            writer.Write(sr.ReadToEnd());
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T07:58:41.447

有时控制文件有另一个字符集。确认您的文件在开头没有多余的字符，如果有，请删除它们。您可能必须使用允许您执行此操作的智能文本编辑器。

我有同样的额外空间问题，但我的控件没有实现`Render()`方法。

# database - 多个客户端软件系统使用一张表还是多张表？

> ID：10644596
> 
> 赞同：0
> 
> 时间：2012-05-17T22:57:52.340
> 
> 标签：database, relational-database

这个问题可能会自己回答，但它也是最佳实践的问题。

我正在设计一个允许用户（公司）创建帐户的应用程序。这些用户被放置在表“Shop_table”中。现在每个商店都有动态数据，但是每个商店的表格都是相同的，例如`shop_employees`, `shop_info`, `shop_data`。

为每个商店设置一个特定的表会更有效，还是我只是通过商店 ID 链接他们的数据。

例如：

```
shop: Dunkins with id:1 
shop: Starbucks with id:2 
```

邓肯斯会不会有自己的`dunkins_shop_employees`, `dunkins_shop_info`,`dunkins_shop_data`桌子和星巴克有自己的`starbucks_shop_employees`, `starbucks_shop_info`,`starbucks_shop_data`

或者我会有一个表 `shope_employees`，`shop_info`和`shop_data`链接 id 1 或 2，等等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:25:53.077

你应该只有一张桌子（每个`shop_info`等......）

创建类似的表是维护的噩梦。您将需要创建类似的外键、类似的约束、类似的索引等。

如果您关心的是隐私，这应该在您的应用程序中加以控制。您的应用程序应始终根据谁登录/查询添加“WHERE”子句。

如果您绝对需要 - 您可以创建 where 子句作为 shop_id 的视图。您只能在视图上向不同的人授予权利。这只有在您有一个大客户想要一些 SQL 级别的查询能力时才有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T23:07:16.090

绝对是每个*实体*的一个表，其中包含一个用于标识公司的字段。

如果所有公司都有相同的信息，则无需为每个公司创建表，如果您这样做了，您的查询将成为一场噩梦。

您是否真的需要大量 UNION 查询来获取跨公司的聚合数据？一旦添加了另一家公司（因此添加了多个表），您还必须修改数据库中的*所有查询。*

独立定义您的表，为您要存储的实体建模，不要考虑它们属于谁。

# java - 在 Spring Controller 方法中未获取 JSON 值

> ID：10644598
> 
> 赞同：1
> 
> 时间：2012-05-17T22:58:02.697
> 
> 标签：java, android, json, spring, modelattribute

我需要将一些数据从我的 Android 设备发送到我的服务器。我正在通过 JSON 执行此操作。我已经在 Android 上实现了 JSON 帖子，并且我正在尝试在服务器端进行映射以检索该数据。我的问题是我不断收到一个空字符串。

**用于发送 JSON 的 Android 方法**：

```
private void sendJson(final String json, final String URL) {
    Thread t = new Thread(){
    public void run() {
            Looper.prepare(); //For Preparing Message Pool for the child Thread
            HttpClient client = new DefaultHttpClient();
            HttpConnectionParams.setConnectionTimeout(client.getParams(), 10000); //Timeout Limit
            try{
                HttpPost post = new HttpPost(URL);
                StringEntity se = new StringEntity(json);  
                se.setContentType(new BasicHeader(HTTP.CONTENT_TYPE, "application/json"));
                post.setEntity(se);
                client.execute(post);
            }
            catch(Exception e){
                e.printStackTrace();
            }
            Looper.loop(); //Loop in the message queue
        }
    };
    t.start();      
} 
```

**服务器端方法：**

```
@RequestMapping(value = "/getLatestCalls", method = RequestMethod.POST)
public void getData(@ModelAttribute String json){
    //... do something 
} 
```

问题是在这种方法中，我的*json* String 每次都是“”。我也尝试过使用`@RequestParam`，但它不再进入该方法。我也试过了`@ModelAttribute("json")`。

有人可以在这里给我一点启发吗？先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:33:02.837

这是解决方案，它工作正常。

## 服务器端

```
@Controller
    public class DataCollector {

        @RequestMapping(value = "/clientdatacollector", method = RequestMethod.POST)
        public @ResponseBody
        void abc(Writer writer, @RequestParam("gpsdata") String gpsJSON) {

            try {
                // here is your jsonstring ;)
                writer.write(gpsJSON.toString());

            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }

    } 
```

* * *

客户端

```
 public static void httptest() {
            ArrayList<TravellingData> tdArray = new ArrayList<TravellingData>();
            Gson gson = new Gson();
            String jsonString = "";
            for (int i = 0; i < 1; i++) {
                tdArray.add(ObjectCreater.createMockTravellingDataObject());
            }

            jsonString = gson.toJson(tdArray);

            HttpClient client = new DefaultHttpClient();

            HttpPost post = null;
            try {
                post = new HttpPost(
                        "http://localhost:8080/uygulama/clientdatacollector");
            } catch (URISyntaxException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }
            try {
                List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(1);
                nameValuePairs.add(new BasicNameValuePair("gpsdata", jsonString));
                post.setEntity(new UrlEncodedFormEntity(nameValuePairs));

                HttpResponse response = null;
                try {
                    response = client.execute(post);
                } catch (HttpException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                BufferedReader rd = new BufferedReader(new InputStreamReader(
                        response.getEntity().getContent()));
                String line = "";
                while ((line = rd.readLine()) != null) {
                    System.out.println(line);
                }

            } catch (IOException e) {
                e.printStackTrace();
            }

        } 
```

* * *

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T23:22:36.150

尝试使用[@RequestBody](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-ann-requestbody)。它应该工作。

# iphone - 有没有办法在应用程序中通用设置背景颜色或导航栏？

> ID：10644605
> 
> 赞同：1
> 
> 时间：2012-05-17T22:58:57.033
> 
> 标签：iphone, ios, uinavigationbar, background-image, background-color

现在，我必须在每次推送视图之前执行以下操作

```
 _homeNavigationController.navigationBar.barStyle = UIBarStyleBlack;
    _homeNavigationController.navigationBar.tintColor = nil; 
```

我想使用带图案的图像将颜色设置为不同的颜色。

那么有没有简单的方法呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T23:07:07.707

如果您使用的是 iOS 5，则可以使用外观协议。

```
[[UINavigationBar appearance] setBackgroundImage:myImage]; 
```

文档可以在这里找到：

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIAppearance_Protocol/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIAppearance_Protocol/Reference/Reference.html)

[http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UINavigationBar_Class/Reference/UINavigationBar.html#//apple_ref/doc/uid/TP40006887](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UINavigationBar_Class/Reference/UINavigationBar.html#//apple_ref/doc/uid/TP40006887)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:28:07.627

如果您想使用自定义色调（内置常量除外），请使用以下代码：

**在全球某处定义这些。**

```
#define RGBCOLOR(r,g,b)         [UIColor colorWithRed:(r)/255.0f green:(g)/255.0f blue:(b)/255.0f alpha:1]
#define COLOR_NAVBAR_TINT           RGBCOLOR(82, 154, 217)
#define COLOR_TOOLBAR_TINT          RGBCOLOR(82, 154, 217) 
```

**将此添加到您的 AppDelegate.m，然后在您的应用程序初始化期间调用它：**

```
- (void)initializeGlobalTheme {
    [[UINavigationBar appearance] setTintColor:COLOR_NAVBAR_TINT];
    [[UIToolbar appearance] setTintColor:COLOR_TOOLBAR_TINT];
} 
```

# python - .cpt 文件 Grok 框架的系统错误

> ID：10644606
> 
> 赞同：0
> 
> 时间：2012-05-17T22:58:57.750
> 
> 标签：python, html, css, zope, grok

我不知道为什么会这样。我开始掌握 Grok 框架。在遵循教程时，我遇到了这个错误。使用 TAL:attributes 链接到 CSS 样式表时，索引页面会加载系统错误消息。索引文件称为 index.cpt 如果我将其更改为 index.pt 它会正确加载。谁能告诉我为什么会这样？cpt 文件类型是否有限制，还是我的代码？

* * *

### 索引.cpt：

```
<html>
<head>
<link rel="stylesheet" type="text/css" 
    tal:attributes="href static/style.css" />
</head>
<body>
    <p>Hello world!</p>
</body>
</html> 
```

### 样式.css：

```
body {
  background-color: #FF0000;
} 
```

### 应用程序.py：

```
import grok

from sample import resource

class Sample(grok.Application, grok.Container):
    pass

class Index(grok.View):
    pass

class Bye(grok.View):
    pass 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T15:05:37.290

最新版本的 Grok 似乎使用了“Chameleon”语言（.cpt 文件），但本教程仍然基于 Zope 语言（.pt 文件）。它们之间存在一些细微差别，这就是我收到系统错误的原因。

这只是一个语言语法问题。我只是将文件重命名为 .pt 文件而不是 .cpt 并使用 Zope。

# python - 在 ftplib storbinary 中创建缺失的目录

> ID：10644608
> 
> 赞同：15
> 
> 时间：2012-05-17T22:59:14.083
> 
> 标签：python, pycurl, ftplib

我在 python 中使用 pycurl 通过 ftp 传输文件。我可以使用以下方法在远程服务器上自动创建缺少的目录：

```
c.setopt(pycurl.FTP_CREATE_MISSING_DIRS, 1) 
```

由于某些原因，我不得不切换到 ftplib。但我不知道如何在这里做同样的事情。是否有任何选项可以添加到 storbinary 函数中来做到这一点？或者我必须手动创建目录？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-22T05:03:33.620

FTP_CREATE_MISSING_DIRS 是一个 curl 操作（[在此处添加](http://curl.haxx.se/mail/lib-2003-08/0067.html)）。我冒昧地猜测您必须使用 ftplib 手动执行此操作，但我很想被证明是错误的，有人吗？

我会做类似以下的事情：（未经测试，需要捕捉`ftplib.all_errors`）

```
ftp = ... # Create connection

# Change directories - create if it doesn't exist
def chdir(dir): 
    if directory_exists(dir) is False: # (or negate, whatever you prefer for readability)
        ftp.mkd(dir)
    ftp.cwd(dir)

# Check if directory exists (in current location)
def directory_exists(dir):
    filelist = []
    ftp.retrlines('LIST',filelist.append)
    for f in filelist:
        if f.split()[-1] == dir and f.upper().startswith('D'):
            return True
    return False 
```

或者你可以这样做`directory_exists`：（有点难以阅读？）

```
# Check if directory exists (in current location)
def directory_exists(dir):
    filelist = []
    ftp.retrlines('LIST',filelist.append)
    return any(f.split()[-1] == dir and f.upper().startswith('D') for f in filelist) 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-08-20T18:14:33.613

我知道这是一篇旧帖子，但我只需要这个并想出了一个非常简单的功能。我是 Python 新手，所以我会很感激任何反馈。

```
from ftplib import FTP

ftp = FTP('domain.com', 'username', 'password')

def cdTree(currentDir):
    if currentDir != "":
        try:
            ftp.cwd(currentDir)
        except IOError:
            cdTree("/".join(currentDir.split("/")[:-1]))
            ftp.mkd(currentDir)
            ftp.cwd(currentDir) 
```

使用示例：

```
cdTree("/this/is/an/example") 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-22T01:52:09.467

我尝试将此作为评论添加到@Alex L 的答案中，但它太长了。如果要在途中创建目录，则需要在更改目录时递归下降。例如

```
def chdir(ftp, directory):
    ch_dir_rec(ftp,directory.split('/')) 

# Check if directory exists (in current location)
def directory_exists(ftp, directory):
    filelist = []
    ftp.retrlines('LIST',filelist.append)
    for f in filelist:
        if f.split()[-1] == directory and f.upper().startswith('D'):
            return True
    return False

def ch_dir_rec(ftp, descending_path_split):
    if len(descending_path_split) == 0:
        return

    next_level_directory = descending_path_split.pop(0)

    if not directory_exists(ftp,next_level_directory):
        ftp.mkd(next_level_directory)
    ftp.cwd(next_level_directory)
    ch_dir_rec(ftp,descending_path_split) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-03-23T10:43:41.420

另一种方法是简单地遍历每个路径元素，创建下一个并更改到新创建的目录。我的用例相当简单，因为我将项目从一个 FTP 服务器复制到另一个。

```
def create_ftp_path(session: ftplib.FTP, required_dir: str):
    required_dir = required_dir.split('/')[:-1]
    for path_item in required_dir:
        if path_item.strip() == '':
            continue
        path_item = path_item.replace('/', '')
        try:
            session.cwd(path_item)
        except:
            session.mkd(path_item)
            session.cwd(path_item) 
```

注意事项：

*   此函数假定您已将 FTP 会话的目录更改为某个基本路径，并且该`required_dir`路径是来自该基本路径的路径。
*   `required_dir`包括文件名作为最后一个元素。
*   我正在删除任何`/`字符，因为在我的情况下它们会导致`553 permission denied`异常。
*   缺少异常处理，但在我的情况下，上传验证在代码中进一步发生，因此即使失败，它也会被进一步捕获。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-20T10:35:23.883

此代码将在路径中创建所有丢失的文件夹：

```
...

def chdir(ftp_path, ftp_conn):
    dirs = [d for d in ftp_path.split('/') if d != '']
    for p in dirs:
        print(p)
        check_dir(p, ftp_conn)

def check_dir(dir, ftp_conn):
    filelist = []
    ftp_conn.retrlines('LIST', filelist.append)
    found = False

    for f in filelist:
        if f.split()[-1] == dir and f.lower().startswith('d'):
            found = True

    if not found:
        ftp_conn.mkd(dir)
    ftp_conn.cwd(dir)

if __name__ == '__main__':
    ftp_conn = ... # ftp connection
    t = 'FTP/for_Vadim/1/2/3/'

    chdir(t, ftp_conn) 
```

此代码将检查路径中的所有目录并创建缺少的目录

在 "FTP/for_Vadim/" 之前 "FTP/for_Vadim/1/2/3/" 之后

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-10T13:57:11.380

我正在使用以下几行来解决 FTP 文件复制缺少的目录路径

```
import os
ftps = FTP_TLS('ftps_server')
ftps.connect()
ftps.login()

destination_dir_path = 'some/dir/path'          # directory path on FTP
dir_path = ''
for i in destination_dir_path.split('/'):
    dir_path = os.path.join(dir_path,i)
    if i not in ftps.nlst(os.path.dirname(dir_path)):
        ftps.mkd(dir_path)                      # create directory on the FTP
ftps.storbinary(...)                            # store file using the binary mode 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-07T12:41:02.077

我正在使用这样的东西（没有 cwd）：

```
# -*- coding:utf-8 -*-

from ftplib import FTP, error_perm

def createDirs(ftp, dirpath):
    """
    Create dir with subdirs.

    :param ftp:     connected FTP
    :param dirpath: path (like 'test/test1/test2')

    :type ftp:      FTP
    :type dirpath:  str
    :rtype:         None

    """

    dirpath = dirpath.replace('\\', '/')
    tmp = dirpath.split('/')
    dirs = []

    for _ in tmp:
        if len(dirs) == 0:
            dirs.append(_)
            continue

        dirs.append(dirs[-1] + '/' + _)

    for _ in dirs:
        try:
            ftp.mkd(_)
        except error_perm as e:
            e_str = str(e)
            if '550' in e_str and 'File exists' in e_str:
                continue

if __name__ == '__main__':
    # init ftp
    createDirs(ftp=ftp, dirpath='test/1/2/3') 
```

# iphone - 是否有任何工具可以浏览您的应用程序的 iCloud 数据？

> ID：10644609
> 
> 赞同：8
> 
> 时间：2012-05-17T22:59:15.800
> 
> 标签：iphone, ios, icloud

我正在努力将 iCloud 集成到我的应用程序中，有时会遇到冲突和保存错误的问题。数据存储在云上的事实使得调试问题变得非常困难。

据我所知，iCloud 服务器上的数据被镜像到设备上的一个目录中。是否有任何工具（iOS 或 OSX 应用程序）可以让我查看此目录的内容或 iCloud 服务器中的文件？我知道可以用`NSMetadataQuery`class查询目录中的文件。但是，我正在寻找来自 Apple 的内置工具或我可以与我自己的权利一起使用的开源应用程序。

到目前为止，我已经尝试了以下工具，但没有成功：

*   在 Mac OS X Lion 上，系统偏好设置 >> iCloud >> 管理：这仅显示文档的名称和大小。它不允许我下载或查看内容。
*   在 iOS 5 上，设置 >> iCloud >> 存储和备份 >> 管理存储：同上。
*   在 Xcode 4.3.2 上，管理器 >> 设备 >> >> 应用程序 >> 下载：这允许我下载应用程序数据，但它不包含 iCloud 数据。
*   我也尝试使用 iPhone Explorer 应用程序浏览手机，但它不显示存储 iCloud 数据的 /private/var 的内容。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-23T23:51:15.517

...或访问[http://developer.icloud.com](http://developer.icloud.com)以查看 Apple 服务器上实际存储在云中的内容...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T14:00:47.307

我在[这个](https://stackoverflow.com/a/10390043/546918)答案中找到了我的问题的答案。

事实证明，如果我在 iCloud 设置页面中启用“文档和数据”并安装使用 iCloud 的 Mac 应用程序，云上的数据会自动下载到我的 Mac 下的“~/Library/Mobile Documents”文件夹下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T23:22:18.473

目前没有记录的方式来查看原生 iCloud 数据。但是，根据您的数据是什么，您可能在某些情况下可以查看它。例如，iCloud 可用于同步通过 CoreData 访问的数据库。如果您将数据存储在 Sqlite 数据库中，然后通过 CoreData 进行管理和访问，您可以使用 3rd 方桌面应用程序查看 Sqlite 文件。我使用这个工具在 Mac 上查看我的 Sqlite 数据库：[http ://www.sqlabs.net/sqlitemanager.php](http://www.sqlabs.net/sqlitemanager.php)

# java - 将通用树转换为二叉树 - XML Parser

> ID：10644614
> 
> 赞同：1
> 
> 时间：2012-05-17T22:59:37.617
> 
> 标签：java, xml, dom, data-structures, xml-parsing

我试图将一个通用树（无限子节点）关联到一个名为“pays.xml”的 XML 文件，如下所示：

```
<?xml version="1.0"  encoding="iso-8859-1"?>
<country>
     <name>  </name>
     <city>  </city>
     <region>
         <name>  </name>
         <population>  </population>
         <city> Lille </city>
     </region>
     <region>
     </region>
</country> 
```

与此 XML 文件关联的树： ![在此处输入图像描述](../Images/d88bb7c2bcc2944f338a295a849b31f3.png)

现在我想将这棵树转换为二叉树，我为此应用了一个算法：

*   使用通用树的根作为二叉树的根

*   确定根的第一个孩子。这是下一级通用树中最左边的节点

*   插入这个节点。父节点的子引用引用这个节点

*   继续查找每个父节点的第一个子节点，并将其插入到父节点下方，并带有父节点的子节点引用。

所以结果是：

![在此处输入图像描述](../Images/5e435d07cc41e321d77bdb9488de9e3c.png)

所以我的问题是生成与二叉树相关联的 XML 文件，我想要的结果是：

```
 <country>
       <name>
           <city>
                <region> 
                    <name>
                        <population>
                               <city>

                               </city>
                        </population>
                    </name>
                    <region></region>
               </region>
            </city>
       </name>
   </country> 
```

我试图为此编写代码，但不幸的是，我得到了这个结果

```
 <?xml version="1.0" encoding="UTF-8" standalone="no"?><country><name/><city/><region><name/><population/><city/></region><region><name/><city/><city/></region></country> 
```

这是我的代码：

```
 public static Document Generer (Document doc, Node node,Node a )
   {

        NodeList nl = node.getChildNodes();

        for (int i = 0; i < nl.getLength(); i++) {
           Node n = nl.item(i);
           if (n instanceof Element)
           {
               Element b = doc.createElement(n.getNodeName());
               //System.out.print(b);
               a.appendChild(b);
               Generer (doc,n,b);

           }
        }
    return doc;
}

public static void convert (Node node)
{
     try {

            DocumentBuilderFactory docFactory = DocumentBuilderFactory.newInstance();
            DocumentBuilder docBuilder = docFactory.newDocumentBuilder();

            // root elements
            Document doc = docBuilder.newDocument();
            Element a=doc.createElement(node.getNodeName());
            doc.appendChild(a);
            doc=Generer (doc, node ,a);
            TransformerFactory transformerFactory = TransformerFactory.newInstance();
            Transformer transformer = transformerFactory.newTransformer();
            DOMSource source = new DOMSource(doc);
            //StreamResult result = new StreamResult(new File("C:\\file.xml"));

            // Output to console for testing
            StreamResult result = new StreamResult(System.out);

            transformer.transform(source, result);

     }
     catch(Exception e)
     {
         e.printStackTrace();
     }
}

public static Node GetNodeParent (String fichier1)
{
    try{
         DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
         DocumentBuilder parser = factory.newDocumentBuilder();
         Document doc = parser.parse(fichier1);
         Element root = doc.getDocumentElement();
         return root;

    }catch (Exception e)
    {
        e.printStackTrace();
    }
    return null;

}

public static void main(String[] args) {
    // TODO Auto-generated method stub
    Node n1= GetNodeParent("pays.xml");
    //System.out.println(n1);
    convert(n1);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:14:57.503

如果您仔细查看循环，您提供的代码会完全不同：

```
 NodeList nl = node.getChildNodes();

    for (int i = 0; i < nl.getLength(); i++) {
       Node n = nl.item(i);
       if (n instanceof Element)
       {
           Element b = doc.createElement(n.getNodeName());
           //System.out.print(b);
           a.appendChild(b);
           Generer (doc,n,b);

       }
    } 
```

您可能会注意到“node”变量的所有子变量都将添加到“a”元素中。因此，您所做的只是复制整个树，丢弃所有非元素节点（例如，这会导致格式丢失）。

# android - 对话框 contentView 中的 xml DatePicker 不起作用

> ID：10644617
> 
> 赞同：0
> 
> 时间：2012-05-17T22:59:47.937
> 
> 标签：android, dialog, datepicker

我是 Android 新手，我正在构建一个应用程序，其中在对话框的 contentView 中有一个 xml DatePicker。对于显示选定日期的对话框按钮，我有以下代码：

```
 // get Date Button 
    Button dialogGetVButton = (Button) dialog.findViewById(R.id.GetVerseB);  
    dialogGetVButton.setOnClickListener(new OnClickListener() { 
    @Override 
    public void onClick(View v) { 
        int day = pickerC.getDayOfMonth(); 
        int month = pickerC.getMonth(); 
        showEtext.setText(new StringBuilder().append(month + 1) 
                   .append("-").append(day).append("-").append("2012")); 
        dialog.dismiss(); 
    } 
    }); 
    // END get Date Button 
```

看起来`getDayOfMonth(); and getMonth();`不是对 DatePicker 的正确调用，因为单击该按钮会使应用程序崩溃。我要做的就是在 showEtext TextView 中显示选定的 DatePicker 日期。有没有人按照这些思路做一个自定义的 DatePicker？如果是这样，完成此操作的正确代码是什么？我知道上面的代码在 xml DatePicker 独立时有效，而不是在 Dialog 的 contentView 中调用。但是这段代码在对话框中不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T16:46:26.020

好的，我想通了。我以为

```
 int day = pickerC.getDayOfMonth();  
int month = pickerC.getMonth() 
```

是不正确的电话 - 结果他们是正确的。我的问题是没有正确调用对话框中的 DatePicker。最初我在做：`pickerC = (DatePicker) findViewById(R.id.picker_c);`我认为这只是将 DatePicker 拉入主要活动。我发现如果我打电话：`pickerC = (DatePicker) dialog.findViewById(R.id.picker_c);`拍打对话。在 findViewById 前面是修复。这会将 DatePicker 拉到 Dialog 中，以便 Dialog 可以“看到”DatePicker。

# wpf - 如何刷新 WPF ListView GridView 的自动列宽？

> ID：10644620
> 
> 赞同：0
> 
> 时间：2012-05-17T23:00:01.463
> 
> 标签：wpf, gridview

如何强制我的 WPF GridView 列宽度自动调整以适应其内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:01:50.197

将每列的宽度设置为`Double.NaN`。但是，首先将其设置为除此之外的任何内容。

```
foreach (GridViewColumn c in MyGridView.Columns)
{
    c.Width = c.ActualWidth;
    c.Width = Double.NaN;
} 
```

# c++ - 将值插入到多图向量中

> ID：10644626
> 
> 赞同：0
> 
> 时间：2012-05-17T23:00:40.603
> 
> 标签：c++, stl, multimap

我有这个基于结构的多图和这个结构的向量：

```
typedef std::multimap<char, int> tr;
vector <tr> transitions; 
```

我想用如下值填充数组：

```
0 0 a
0 1 a
1 1 b
1 2 c
1 3 c 
```

它表示自动机的转换，我使用 std::multimap 的向量进行转换。这假设每个状态对应一个整数。我怎么能这样做？我尝试：

```
for (j=0; j<numberTransitions;j++){
    cin>> stateOrigin>>stateDestination>>transitionCharacter;
    transitionsStates.insert(pair<char, int>(transitionCharacter, stateDestination));
    transitions.push_back (transitionsStates);
} 
```

但我不确定它是否正确。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:14:29.680

您从不使用 stateOrigin，所以我很确定这是错误的（除非我完全误解了您的意图）。我认为你想要的更像是这样的：

```
typedef std::pair<int, char> trigger;
std::map<trigger, int> transitions;
⋮
transitions.insert(make_pair(make_pair(orig, chr), dest)); 
```

要驱动状态机，您将使用如下内容：

```
auto newState = transitions.find(make_pair(oldState, inputChar));
if (newState != transitions.end()) {
    state = newState;
} 
```

另请注意，您可能希望改用 C++11 `std::unordered_map`，除非您需要有效访问给定状态的所有触发器。

# jquery - 如何制作 SrcollLeft 自动滑动图库

> ID：10644627
> 
> 赞同：1
> 
> 时间：2012-05-17T23:00:48.333
> 
> 标签：jquery

我是 jquery 的新手..我想制作一个 scrollLeft 滑动画廊..我做了以下一点..bt 它只滑动一次..它不会连续滑动...我还想突出显示当前正在滑动的幻灯片。 .我该怎么做..有人可以帮帮我吗？

```
$(function(){
    var $thumbs= $('div.thumbs_wrapper');
    var scrollWidth= $('ul.thumbs li').width();
    var $single_Item=$('ul.thumbs li:first');

    singleWidth= $single_Item.outerWidth(); 
    scrollRight = singleWidth;      

    setInterval(function(){
        sliding();
    }, 1000);

});

function sliding(n){
    var $thumbs= $('div.thumbs_wrapper');
    var scrollWidth= $('ul.thumbs li').width();
    $thumbs.animate({'scrollLeft':'+=' + singleWidth}, 'slow').scrollLeft(scrollWidth-scrollRight);
    $('thumbs li a').each(function(){
        $(this).removeClass('active');
        if($(this).hasClass('imgage'+integer)){
            $(this).addClass('active');
        }
    });
} 
```

这是我的 html 代码

```
<div class=gallery_outer>
    <div class="gallery_inner">
        <ul class="full_img">
            <li><img src="fullSize_image/1.jpg"/></li>
            <li><img src="fullSize_image/2.jpg"/></li>
            <li><img src="fullSize_image/3.jpg"/></li>
            <li><img src="fullSize_image/4.jpg"/></li>
            <li><img src="fullSize_image/5.jpg"/></li>
            <li><img src="fullSize_image/6.jpg"/></li>
        </ul>
    </div>
    <div class="thumbs_wrapper">        
        <ul class="thumbs">
            <li><img src="thumbnails/1.jpg" class="image1"/></li>
            <li><img src="thumbnails/2.jpg" class="image2"/></li>
            <li><img src="thumbnails/3.jpg" class="image3"/></li>
            <li><img src="thumbnails/4.jpg" class="image4"/></li>
            <li><img src="thumbnails/5.jpg" class="image5"/></li>
            <li><img src="thumbnails/6.jpg" class="image6"/></li>
        </ul>
    </div>
</div> 
```

这是我的 CSS 代码

```
.gallery_outer{
    margin:15px;
    width:390px;
    height:430px;
    border:5px solid #aaa;
    border-radius:10px;
    webkit-border-radius:10px;
    box-shadow:2px 2px 5px 3px;
    -moz-box-shadow:2px 2px 5px 3px;
    webkit-box-shadow:2px 2px 5px 3px;

}
.gallery_inner{

}
.full_img{
    margin:0;
    padding:0;
    list-style:none;
    position:relative;
    height:282px;
    width:17296px;
    overflow: hidden;
    /*left:-384px;*/
}
.full_img li{
    display:inline;
    float:left;
    margin-left:0 !important;
    padding:9px 8px;
    position: absolute;
    width:376px;
    height:282px;
}
.full_img li img{
    width:376px;
}
.thumbs_wrapper{
    margin:0;
    padding:0;
    height:108px;
    width:324px;
    overflow:hidden;
    float:left;
}
.thumbs{
    margin:0;
    padding:0;
    list-style:none;
    position:relative;
    /*width:5336px;*/
    width:668px;
    /*left:-108px;*/
}
.thumbs li{
    display:inline;
    float:left;
    margin-left:0 !important;
    padding:9px 8px;
    width:100px;
    height:100px;
}
.thumbs li img{
    width:100px;
    height:100px;
    cursor:pointer;
}
.active{
    border:5px solid red;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T01:39:34.020

[这是我能来的最接近的](http://jsfiddle.net/Daedalus/tYW8a/)，我不知道你对活动位的看法，它没有多大意义，所以我没有包括它。如果你能解释你的想法是什么，我可以尝试修改我的答案以满足你的需要。

# ruby-on-rails - Rails Twitter Bootstrap gem 由于rubyracer依赖而导致捆绑安装失败？

> ID：10644630
> 
> 赞同：2
> 
> 时间：2012-05-17T23:01:11.120
> 
> 标签：ruby-on-rails, ruby, twitter-bootstrap

我正在尝试在 Mac OSX Lion 上安装 Twitter-Bootstrap-Rails gem。我在我的 Gemfile 中添加了 twitter-bootsrap 行，但是当我运行 bundle install 时，由于 therubyracer gem 的问题，它失败了。

```
....rvm/rubies/ruby-1.9.2-p318/lib/ruby/1.9.1/mkmf.rb:368:in `try_do': The complier failed to generate an executable file. (RuntimeError)
You have to install development tools first. 
```

我已经运行了开发人员工具和 XCode 4.3.2。我正在运行 Rails 3.2 和 Ruby 1.9.2p318。

知道为什么编译器可能会因为这个 gem 安装失败或者我该如何修复？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-05-18T05:43:30.450

```
gem install therubyracer 
```

或者

```
gem 'therubyracer' 
```

在 linux 上为我工作。

# vb.net - 找出 DataGridView 当前行的特定列的值

> ID：10644631
> 
> 赞同：0
> 
> 时间：2012-05-17T23:01:14.663
> 
> 标签：vb.net, datagridview, row

我们有一个包含 3 列的 DataGridView：InvoicedOn、PaidOn 和 Amount

在 MouseDown 事件上是需要修复的这行代码：

```
MsgBox(DataGridViewPayments.Item("Amount", DataGridViewPayments.CurrentRow.Index), "") 
```

我们试图找出当前行的 Amount 列中的值。

我们还收到此错误消息：

```
Conversion from string "" to type 'Integer' is not valid. 
```

你能告诉我如何修复 MsgBox 以便它显示值吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:37:25.877

使用列索引而不是列名

```
MsgBox(DataGridViewPayments.Item(2, DataGridViewPayments.CurrentRow.Index)).value, "") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:40:50.913

该语法`DataGridViewPayments.Item("Amount", DataGridViewPayments.CurrentRow.Index)`将在名为“Amount”的列（假设它存在）与当前行索引（假设 CurrentRow 不是 Nothing）的交叉处获取**DataGridViewCell 。**

要获取该单元格的值，您需要引用名为 DataGridViewCell 的属性`Value`

```
DataGridViewPayments.Item("Amount", DataGridViewPayments.CurrentRow.Index).Value 
```

该`Amount`列表明存在一个数值，但请记住，如果当前单元格为空或 null，您可能会遇到异常。在这种情况下，最好这样做：

```
object o = DataGridViewPayments.Item("Amount", DataGridViewPayments.CurrentRow.Index).Value
if o Is Nothing OrElse o.ToString = "" then 
  MsgBox("The cell is empty or null", "Message Title")
else
  MsgBox("The cell value is " + o.ToString, "Message Title")
end if 
```

# jpa - JPA EntityManager 为什么 merge() 不使实例托管？

> ID：10644635
> 
> 赞同：4
> 
> 时间：2012-05-17T23:01:56.133
> 
> 标签：jpa, openjpa, entitymanager

当我在一个对象上调用 merge() 时，该对象不会成为托管对象。而是返回对同一实体的托管实例的引用。这背后的逻辑是什么？有没有办法通过一些设置来改变这种行为（并使对象被管理）？我正在使用 OpenJPA 2.2。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-19T08:21:08.863

关键是 merge() 没有将对象附加到 EntityManager 上下文，它正在返回附加对象。所以，如果我们有：

```
AEntity a2 = entityManager.merge(a1); 
```

a1 仍然不受管理，而 a2 是受管理的。

顺便说一句，这是一种聪明的方法，因为合并不会引起副作用，传递的对象状态不会改变。

# iphone - App Store - 使用 IAP 将付费和免费版本合并为免费版本的最佳方式

> ID：10644640
> 
> 赞同：7
> 
> 时间：2012-05-17T23:02:39.723
> 
> 标签：iphone, ios, ipad, app-store, app-store-connect

我的公司目前在应用商店中有两个应用程序：一个包含两本电子书的完整付费版本，以及一个不包含这两本书的“精简版”。我们刚刚开发了一个新版本的应用程序，将这两本书作为 IAP 实现，目的是将两个应用程序合并为一个。我正处于我想提交应用程序的地步，但我不确定最好的方法。

**目前的计划：**

1.  使用 IAP 书籍将免费应用程序更新到新版本。
2.  重命名免费版本，删除“Lite”。
3.  从应用商店中删除现有的付费版本。

**该计划的潜在问题：**

1.  那些已经为现有完整版付费的人可能会觉得被骗了，因为他们的版本不会收到这个新版本中的任何其他更新。

2.  会有名称冲突，因为我们希望新应用程序采用旧付费应用程序的名称（删除典型的“-Lite”符号）。如果我们立即从商店中删除付费版本，这在 App Store 中不会是什么大问题，但如果用户在下载旧付费版本的同时下载新版本，则会造成混乱的用户体验。

3.  同样，如果我们一上传新的免费版本（与旧的付费版本同名）就删除旧的付费版本，很容易想象一些旧付费版本的困惑用户删除他们现有的付费版本并下载新的免费版本，却发现他们已经失去了他们已经支付的书籍，无法重新下载旧的付费版本。

**我的问题：**

1.  从真正的高层次来看，我们是否以错误的方式处理这个问题？我用谷歌搜索和搜索过，但我找不到太多关于如何将付费和免费版本的应用程序合二为一的指导。

2.  我有什么办法可以确定谁已经购买了付费版本，并在新的免费版本中“赠送”他们图书 IAP？如果我们认为这会更早发生，我们可以记录所有这些付费版本的唯一 ID，但我相信无论如何现在这违反了规则，对吗？

3.  将“-Lite”版本与旧的完整版本同名可能会出现哪些其他类型的问题？

提前感谢您提供的任何和所有帮助或反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-30T03:52:36.867

我们只是用我们的 FileApp Pro 和免费的 FileApp 做到了这一点。我们摆脱了 FileApp Pro，现在新的 FileApp 具有应用内购买功能。但是，我们希望所有购买 FileApp Pro 的用户都能免费获得 FileApp 的所有应用内购买。

这是我们使用的方法：我们使用 iOS 的“钥匙串共享权利”在 FileApp 和 FileApp Pro 之间共享标志，这允许两个应用程序共享相同的钥匙串数据。这允许 FileApp 知道 FileApp Pro 已安装。然后我们想确保 FileApp Pro 权限通过用户的 iTunes 帐户在 FileApp 中仍然可用，因此我们使用免费的应用内购买来做到这一点。首次启动 FileApp 时，FileApp Pro 用户被要求购买免费的应用内购买，因此即使他重新安装 FileApp，他的所有权限仍然可以跨设备使用。

您将在我们的沼泽中找到描述该方法的完整文章： [http ://blog.digidna.net/post/74246563623/how-to-release-a-whole-new-app-and-keep-all-things](http://blog.digidna.net/post/74246563623/how-to-release-a-whole-new-app-and-keep-all-things)

编辑：这是上述帖子的存档链接，现在似乎不可用：[https ://web.archive.org/web/20160309135133/http://blog.digidna.net/post/74246563623/how-发布一个全新的应用程序并保留所有东西](https://web.archive.org/web/20160309135133/http://blog.digidna.net/post/74246563623/how-to-release-a-whole-new-app-and-keep-all-things)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:13:48.603

我认为最好将付费版本转为免费版本，这样至少您的原始付费客户得到了最多的照顾。根据您的用户群，您甚至可以确保原始付费用户不会看到任何广告或其他限制，方法是进行中间发布，让这些用户将某些内容保存为用户默认值。然后，您可以使用 UIAlertView 提供免费版本的更新，询问他们是否想要免费的完整版本并将他们引导到应用商店下载。我假设你有更多的免费用户，但你可能会用这条路让更少的人感到不安。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:36:01.837

我知道两个应用程序做了非常相似的事情。《经济学人》和《今日美国》应用程序，从字面上提醒用户放弃当前应用程序并下载新应用程序。（不知道为什么他们必须这样做）。所以我很确定你不是第一个考虑这样做的人。

如果您可以选择提供帐户+同步功能，那将是合并这两个应用程序的最佳方式。我最喜欢的应用程序之一 Gas Cubby 处理得很好。Gas Cubby 有免费和付费版本。如果您想从免费的 Gas Cubby 升级到付费的，您可以下载一个不同的应用程序，然后同步数据。

如果您担心如何在 Lite 应用程序中为付费客户恢复内容，您可以在 Lite 应用程序中使用 URL 方案，当当前付费应用程序调用该方案时，将免费启用这些书籍。

正如@rooster117 所说，最好将付费版本免费，并要求精简版的人转向付费免费版本。当然，在您将停止使用的应用程序中设置硬停止日期，以便所有使用它的人都将转到您感兴趣的一个应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T23:41:17.487

你的问题：

1.  这无论如何都会发生，你不能让每个人都开心
2.  虽然我会删除该应用程序的免费版本，但在您向所有“精简版”版本发送推送通知之前，将停止对该应用程序的支持并将它们定向到付费版本
3.  如果可能的话，要从 #2 继续，如果您有一个帐户系统设置到您的服务器，则在停止“Lite”版本之前，请发布两个版本的更新，将他们的所有书籍与您自己的服务器（而不是 iCloud）同步。这样，当他们下载新版本时（Lite 停产后），应用程序会自动将书籍同步回设备。

你的问题：

1.  正如您所了解的那样，没有真正的方法可以合并两个应用程序，从我从游戏到实用程序的情况来看，将“精简版”版本作为某个点一起删除，如果用户想要未来的内容更新，那么他们必须下载应用程序仍在应用商店中。
2.  请参阅我对问题 #3 的回答
3.  我相信它会被 App Store 审查过程直接拒绝，主要是因为它们都执行相同的功能，我建议完全删除免费的

# c# - 通过反射调用的 String.MemberwiseClone() 方法不起作用，为什么？

> ID：10644644
> 
> 赞同：4
> 
> 时间：2012-05-17T23:03:29.650
> 
> 标签：c#, reflection, shallow-clone

首先让我说我知道它是一个受保护的方法，我不应该调用它，但它不应该工作，因为**MemberwiseClone**是在**Object**类中定义的并且**String**继承自它吗？

所以这是克隆方法（我删除了空引用处理以专注于重要的事情）：

```
public static T ShallowClone<T>(T obj)
{
    MethodInfo memberwiseClone;
    memberwiseClone = obj.GetType().GetMethod("MemberwiseClone", BindingFlags.Instance | BindingFlags.NonPublic);
    return (T)memberwiseClone.Invoke(obj, null);
} 
```

如果我这样称呼它：

```
string str = ShallowClone("My string"); 
```

结果字符串 (str) 将是：

```
"M\0\0\0\0\0\0\0\0" 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T23:20:11.303

您正在调用它并且它正在工作。问题是它`String.MemberwiseClone`没有做你期望它做的事情。它似乎创建了一个与原始字符串长度相同的字符串，但只复制了第一个字符。

我认为这里要吸取的教训是：当你调用一个你不应该调用的方法时，要非常小心，了解它的作用，不要假设太多。

# java - 为每个线程分配一个特定的范围

> ID：10644647
> 
> 赞同：0
> 
> 时间：2012-05-17T23:03:38.350
> 
> 标签：java, multithreading

我在我的多线程程序中使用 ThreadPoolExecutor，我希望每个线程都应该有特定的 ID 范围，如果`ThreadSize is set as 10`然后`Start = 1 and End = 1000`每个线程都有 100 个 ID 的范围（基本上通过将结束范围除以线程大小），它可以在不踩到其他线程的情况下使用。

```
Thread1 will use 1 to 100 (id's)

Thread2 will use 101 to 200 (id's)

Thread3 will use 201 to 300 (id's)
-----
-----
Thread10 will use 901 to 1000 
```

我基本知道逻辑，逻辑可以是这样的-

```
Each thread gets `N = (End - Start + 1) / ThreadSize` numbers.

Thread number `i` gets range `(Start + i*N) - (Start + i*N + N - 1)`. 
```

因为我是第一次使用 ThreadPoolExecutor，所以我不确定我应该在代码中的什么地方使用这个逻辑，以便每个线程都使用预定义的 ID 而不会踩到其他线程。任何建议将不胜感激。

```
public class CommandExecutor {

    private List<Command> commands;
    ExecutorService executorService;
    private static int noOfThreads = 3;

    // Singleton
    private static CommandExecutor instance;
    public static synchronized CommandExecutor getInstance() {
        if (instance == null) {
            instance = new CommandExecutor();
        }
        return instance;
    }

    private CommandExecutor() {

        try {
            executorService = Executors.newFixedThreadPool(noOfThreads);
        } catch(Exception e) {
            System.out.println(e);
        }
    }

    // Get the next command to execute based on percentages
    private synchronized Command getNextCommandToExecute() {

    }

    // Runs the next command
    public synchronized void runNextCommand() {
        // If there are any free threads in the thread pool
        if (!(((ThreadPoolExecutor) executorService).getActiveCount() < noOfThreads))
            return;
        // Get command to execute
        Command nextCommand = getNextCommandToExecute();
        // Create a runnable wrapping that command
        Task nextCommandExecutorRunnable = new Task(nextCommand);
        executorService.submit(nextCommandExecutorRunnable); // Submit it for execution
    }

    // Implementation of runnable (the real unit level command executor)
    private static final class Task implements Runnable {
        private Command command;
        public Task(Command command) {
            this.command = command;
        }
        public void run() {
            // Run the command
            command.run();
        }
    }

    // A wrapper class that invoked at every certain frequency, asks CommandExecutor to execute next command (if any free threads are available)
    private static final class CoreTask implements Runnable {
        public void run() {
            CommandExecutor commandExecutor = CommandExecutor.getInstance();
            commandExecutor.runNextCommand();
        }
    }

    // Main Method
    public static void main(String args[]) {
        // Scheduling the execution of any command every 10 milli-seconds
        Runnable coreTask = new CoreTask();
        ScheduledFuture<?> scheduledFuture = Executors.newScheduledThreadPool(1).scheduleWithFixedDelay(coreTask, 0, 10, TimeUnit.MILLISECONDS);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:48:21.720

这是否是一个好主意，我会让你决定。但是为了帮助你，我写了一个小程序来做你想做的事……在我的例子中，我只是总结了“ids”。

这是代码：

```
public class Driver {

private static final int N = 5;

public static void main(String args[]) throws InterruptedException, ExecutionException{
    int startId = 1;
    int endId = 1000;
    int range = (1 + endId - startId) / N;
    ExecutorService ex = Executors.newFixedThreadPool(N);
    List<Future<Integer>> futures = new ArrayList<Future<Integer>>(N);

    // submit all the N threads
    for (int i = startId; i < endId; i += range) {
        futures.add(ex.submit(new SumCallable(i, range+i-1)));
    }

    // get all the results
    int result = 0;
    for (int i = 0; i < futures.size(); i++) {
        result += futures.get(i).get();

    }
    System.out.println("Result of summing over everything is : " + result);

}

private static class SumCallable implements Callable<Integer> {

    private int from, to, count;
    private static int countInstance = 1;

    public SumCallable(int from, int to) {
        this.from = from;
        this.to = to;
        this.count = countInstance;
        System.out.println("Thread " + countInstance++ + " will use " + from + " to " + to);
    }

    // example implementation: sums over all integers between from and to, inclusive.
    @Override
    public Integer call() throws Exception {
        int result = 0;
        for (int i = from; i <= to; i++) {
            result += i;
        }
        System.out.println("Thread " + count + " got result : " + result);
        return result;
    }

} 
```

}

它产生以下输出（请注意，在真正的多线程方式中，您有随机顺序的打印语句，因为线程以系统决定的任何顺序执行）：

线程 1 将使用 1 到 200

线程 2 将使用 201 到 400

线程 1 得到结果：20100

线程 3 将使用 401 到 600

线程 2 得到结果：60100

线程 4 将使用 601 到 800

线程 3 得到结果：100100

线程 5 将使用 801 到 1000

线程 4 得到结果：140100

线程 5 得到结果：180100

对所有内容求和的结果是：500500

# php - PHP 需要路径

> ID：10644648
> 
> 赞同：0
> 
> 时间：2012-05-17T23:03:39.800
> 
> 标签：php, include, directory, require

我有一个类似于`/public_html/foo/bar.php`我希望在我的文件中需要的目录布局，我的文件 require 语句当前正在`require('../foo/bar.php')`但我没有得到它（我一直收到一个错误，说它不是目录？并且无法打开流）。
我将 require 放入的文件在其中，`/public_html/foo2/`因此我需要查找一个目录列表，然后找到要包含它的文件，但我不确定我现在做错了什么。有什么猜测吗？

实际代码：

```
require('../objects/user.php/'); 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:12:10.213

你有一个你暗示的`/`背后是一个目录。 这就是为什么它告诉你它不是一个目录，因为它确实不是。`../objects/user.php``user.php`

删除它，你可能会没事的。（所以`../objects/user.php/`变成`../objects/user.php`）

# django - “这里不允许目录索引”是什么意思。意思是 Django 错误？

> ID：10644649
> 
> 赞同：16
> 
> 时间：2012-05-17T23:03:53.373
> 
> 标签：django

我正在尝试调试在我的 Django 应用程序中出现的这个奇怪的 404 错误。

```
Page not found (404)
Request Method: GET
Request URL:    http://78.198.124.245/
Directory indexes are not allowed here.
You're seeing this error because you have DEBUG = True in your Django settings file. Change that to False, and Django will display a standard 404 page. 
```

“这里不允许目录索引”是什么意思。意思是？什么是目录索引？

我用 Google 搜索了一下，发现的结果都与提供静态文件有关。但是，我不认为我会那样做。这个错误是什么意思？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-18T04:53:42.850

检查您的 settings.py 文件中的 STATIC_URL 值。您希望该值是存储静态文件的子文件夹 - 通常`STATIC_URL = '/static/'`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-01T10:37:42.860

答案取决于您使用的 django 版本。对于 1.4+，只需设置 STATIC_URL

对于 1.3.x，它的设置与其说`STATIC_URL`是你设置的不如说`ADMIN_MEDIA_PREFIX`是设置的。

如果您将其设置为，`/admin/`则 django 开发服务器将尝试为文件夹下`/admin/`的所有内容提供静态文件`contrib/admin/media/`

这意味着`http://127.0.0.0:8000/admin/postz/post/473`将尝试`django/contrib/admin/media/postz/post/473` 在 404处查找静态内容

如果您尝试访问`http://127.0.0.0:8000/admin/`，那么这将是管理媒体目录中的 index.html，但内部静态服务器不允许索引，所以这就是它抛出的错误。

接受的答案并不完全正确。设置`STATIC_URL`可能起到了副作用的作用，但真正的问题是这`ADMIN_MEDIA_PREFIX`是错误的。

最好的设置是：

```
ADMIN_MEDIA_PREFIX = '/media/' 
```

或者

```
ADMIN_MEDIA_PREFIX = '/admin/media/' 
```

对于 1.4，只需将 as 设置`STATIC_URL`为`ADMIN_MEDIA_PREFIX`已弃用

[https://docs.djangoproject.com/en/dev/releases/1.4/#django-contrib-admin](https://docs.djangoproject.com/en/dev/releases/1.4/#django-contrib-admin)

# html - 谷歌浏览器

> ID：10644651
> 
> 赞同：0
> 
> 时间：2012-05-17T23:04:20.853
> 
> 标签：html, google-chrome, google-chrome-extension

我正在研究一个搜索页面，[`<datatag>`](http://www.html-5.com/tags/datalist-tag/index.html)标签似乎是一个很好的补充。不幸的是，我无法让它在 Chrome 中运行（它在 Firefox 中运行），而且我的大多数用户都使用 Chrome。

有谁知道 Chrome 自动完成搜索框的方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T04:24:07.590

[Datalst 登陆 Chrome Canary](http://updates.html5rocks.com/2012/04/datalist-landed-in-Chrome-Canary)

所以它可能会在 Chrome 20 中工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:11:37.323

JQuery UI Autocomplete 插件，易于使用，非常有效:)[访问 JQuery UI Autocomplete](http://jqueryui.com/demos/autocomplete/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T23:16:27.033

如果浏览器尚不[支持](http://caniuse.com/#feat=datalist)`<datalist>`该元素（当前的 Chrome 似乎不支持该元素），那么您将需要使用无数基于 JavaScript/jQuery 的自动完成 polyfill 之一，例如[jQuery UI Autocomplete](http://jqueryui.com/demos/autocomplete/)。

# java - 如何根据 Java 中的 2 个对象属性对唯一列表进行排序

> ID：10644653
> 
> 赞同：0
> 
> 时间：2012-05-17T23:04:25.340
> 
> 标签：java, sorting, collections, unique

我有一个我称之为工件的对象列表。我需要按“名称”属性按字母顺序排序，并按工件称为“级别”的属性按数字顺序排序。

级别并不总是在 Artifact 中设置，在这种情况下，整个集合应该按字母顺序排列。如果 Artifact 有一个 Level，则优先级并应按 Level 的顺序排序。

Artifacts 需要基于 Name 属性是唯一的。我可以使用 Set 集合并覆盖 Artifact 的 equals 方法以按字母顺序排序。但是，当我想按 Level 排序时，与 Name 相关的 equals 方法会抛出这种排序的结果。

我应该使用什么集合和对象结构来保持名称的唯一性，但也能够按级别排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:09:59.190

您需要查看[可比较接口](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Comparable.html)和[比较器接口](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Comparator.html)。如果这是可以比较对象的唯一方法，则实施 Comparable，否则实施比较器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T00:38:38.560

我认为这`java.util.TreeSet`是解决您问题的好容器。它是 Set 并且它使用 Compareble 机制。

所以你有两个选择：

1) 将 Comparator 放入 TreeSet 构造函数

2) 让你的 Artifact 实现 Comparable

提示：在 compareTo 方法中，您可以使用 String 中的 compareTo 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T00:21:10.130

下面的代码将对集合进行排序，优先考虑级别，然后是名称。如果一个级别为空，它将被放置在开头，将其视为级别 0。对于 null 名称，Artifact 将被定位为它具有一个空级别。希望有帮助。

```
import java.util.Arrays;
import java.util.SortedSet;
import java.util.TreeSet;

public class Artifact implements Comparable<Artifact> {

private String name;
private Integer level;

public Artifact(String name, Integer level) {
    this.name = name;
    this.level = level;
}

@Override
public int hashCode() {
    final int prime = 31;
    int result = 1;
    result = prime * result + ((level == null) ? 0 : level.hashCode());
    result = prime * result + ((name == null) ? 0 : name.hashCode());
    return result;
}

@Override
public boolean equals(Object obj) {
    if (this == obj)
        return true;
    if (obj == null)
        return false;
    if (getClass() != obj.getClass())
        return false;
    Artifact other = (Artifact) obj;
    if (level == null) {
        if (other.level != null)
            return false;
    } else if (!level.equals(other.level))
        return false;
    if (name == null) {
        if (other.name != null)
            return false;
    } else if (!name.equals(other.name))
        return false;
    return true;
}

@Override
public int compareTo(Artifact o) {
    if (level == null){
        return new Artifact(name, 0).compareTo(o);
    }

    if (name == null){
        return new Artifact("", level).compareTo(o);
    }

    if (level.equals(o.level)) {
        return name.compareTo(o.name);
    } else {
        return level.compareTo(o.level);
    }
}

public String toString() {
    return level + " " + name;
}

public static void main(String[] args) {
    Artifact a1 = new Artifact("a", 1);
    Artifact a2 = new Artifact("a", 2);
    Artifact a3 = new Artifact("a", 3);
    Artifact b1 = new Artifact("b", 1);
    Artifact b2 = new Artifact("b", 2);
    Artifact b2a = new Artifact("b", 2);
    Artifact nullLevel = new Artifact("a",null);
    Artifact nullName = new Artifact(null,2);
    SortedSet<Artifact> set = new TreeSet<Artifact>();
    set.add(a1);
    set.add(a2);
    set.add(a3);
    set.add(b1);
    set.add(b2);
    set.add(b2a);
    set.add(nullLevel);
    set.add(nullName);
    System.out.println(Arrays.toString(set.toArray()));
}

} 
```

# ruby-on-rails - 接收电子邮件 POP3 并保存在数据库中

> ID：10644654
> 
> 赞同：1
> 
> 时间：2012-05-17T23:04:38.053
> 
> 标签：ruby-on-rails, ruby, email

我想在我的 RoR-Projekt 中通过 POP3 不断检索我的电子邮件

我应该在哪里设置什么才能收到邮件。

之后，我有一个名为“messages”的表，其中包含字符串：“电子邮件”、字符串：“主题”和文本：“文本”

我想检查 messages.email 是否与 sender.of.email 相同，如果为 true，则 messages.subject 是否与 sender.of.email.subject 相同，将电子邮件文本保存到 messages.text

否则删除电子邮件

与 ActionMailer 一起工作我需要宝石吗？这一切如何运作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T23:09:19.210

根据您的 Rails 版本，您可能拥有 mikel 出色的[Mail gem](https://github.com/mikel/mail)。如果不是，您无论如何都应该使用它。

使用它从您的 POP3 服务器检索消息、解析电子邮件内容并访问您要使用的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:21:03.220

我用 Mailman gem 做到了。

您可以找到更多信息：

[http://dansowter.com/mailman-guide/](http://dansowter.com/mailman-guide/)

我在邮件的输出/显示方面还有一些其他问题，但我希望我能在一些帮助下解决它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:08:52.283

有一个很棒的项目叫做[dbMail](http://dbmail.org/)，用于在数据库中存储电子邮件。让 dbMail 处理电子邮件，然后使用可以访问数据库的任何语言处理您想要的任何内容。

# asp.net - 动态查询数据 - 最佳方法

> ID：10644659
> 
> 赞同：0
> 
> 时间：2012-05-17T23:05:38.367
> 
> 标签：asp.net, sql-server, data-structures, dynamic-sql

我正在设计一个 ASP.NET Web 窗体应用程序，该应用程序将用于使用自定义值和过滤器动态查询数据库。

例如：

*   拉起 3 个字段：SKU、描述、价格、颜色。

*   Description 的值应该是 ProductName + 逗号 + 空格 + Description。

*   Price 的值应为 Price + 10.00。

*   如果 SKU = 123，颜色的值应该是红色。

我需要将这些“规则”存储在我的 SQL 数据库中，以便以后可以根据这些规则查询我的数据库。

最初，我想将规则存储为 SQL 文本，如“ProductName + ', ' + Description”，然后在我的动态 SQL 中使用它。

但是如果我这样做的话，有几件事是行不通的：

1.  区分列名和静态文本。（我想单引号会解决这个问题）
2.  不同的数据类型（假设连接时）
3.  案例陈述
4.  还有 where 子句。

我需要一些想法来解决这个问题——我的数据库结构以及如何从这些规则中查询。

我正在使用 ASP.NET Web 表单、SQL Server 数据库。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T16:53:50.207

我最终创建了一个包含字段（FieldID、FieldName）和值（Value、ValueType、Datatype、FieldID）的表。因此，如果我需要**Description**等于 ProductName + comma + space + Description，我将在 Fields 表中有一条 FieldName="Description" 的记录和 ProductName、comma+space 和 Description 的值记录。ProductName 和 Description 的 ValueType 为“Field”，“,”（逗号空格）为“Static”。

然后，我使用基于这些属性的参数构造了我的 sql 查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T13:09:23.480

对于这个我想到的想法是定义一个业务规则表并将值放入其中： **BR_PK BR_CODE BR_VALUE** 1 SKU_Fields P.SKU, P.Description, P.Price, P.Color
2 Price_Val P.Price + 10

您可以加入动态查询以获取该数据并加入其他表的数据，但您必须保持别名与您在业务规则表中定义的相同。

我会尝试找到一些更好的方法，但它立即出现在我的脑海中。

# php - int 和 string 之间的 PHP 布尔表达式行为

> ID：10644661
> 
> 赞同：0
> 
> 时间：2012-05-17T23:05:53.500
> 
> 标签：php, double, boolean, expression, equals

我很难理解为什么以下两个布尔表达式会返回不同的结果。

```
(0 == "some_string") returns TRUE
(0 === "some_string") returns FALSE 
```

我知道第二个表达式返回`FALSE`是因为 0 和“some_string”不是同一类型，但我不明白为什么第一个表达式返回 TRUE。PHP 将 0 评估为 FALSE，将非空字符串评估为 TRUE，并且 0 与“some_string”不同。我只是看不到第一个表达式如何评估它的方式。我是否缺少一个基本概念？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:07:46.840

那是因为它强制转换`"some_string"`为`int`以便将其与`0`. 照`"some_string"`原样。`int`_ `0`_ [查看有关类型杂耍](http://php.net/manual/en/language.types.type-juggling.php)的手册页以了解更多信息。`0 == 0``true`

# perl - 根据列匹配组合两个文件 - 文件的一个列多次具有相同的条目

> ID：10644662
> 
> 赞同：1
> 
> 时间：2012-05-17T23:05:58.427
> 
> 标签：perl, r, indexing, matching

我想根据一列匹配两个文件并组合匹配的行。但是其中一个文件 ( `file1.txt`) 不止一次具有相同的条目。举个例子：

文件1.txt

```
chr:123 a
chr:123 b
chr:456 a 
```

文件2.txt

```
chr:123 aa
chr:456 bb 
```

我想根据第一列提取索引。

最终输出应如下所示：

```
chr:123 a aa
chr:123 b aa
chr:456 a bb 
```

我尝试在 R 上相交，但无法弄清楚当`file1.txt`多次具有相同条目时如何组合匹配线。我正在使用两个 for 循环，但文件非常大并且需要很多时间。

在 perl 或 R 中有更快的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:24:32.720

试试这个：

```
one <- data.frame(
id=c("chr:123","chr:123","chr:456"),
value=c("a","b","a")
)

two <- data.frame(
id=c("chr:123","chr:456"),
value=c("aa","bb")
)

merge(one,two,by="id",all.x=TRUE)

#result
       id value.x value.y
1 chr:123       a      aa
2 chr:123       b      aa
3 chr:456       a      bb 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T14:07:18.970

这是另一种选择：

```
use Modern::Perl;

my %file1Hash;

open my $file1, "<file1.txt" or die $!;
do { my ( $key, $value ) = split; push @{ $file1Hash{$key} }, $value }
  for <$file1>;
close $file1;

open my $file2, "<file2.txt" or die $!;
do {
    my ( $key, $value ) = split;
    do { say "$key $_ $value" for @{ $file1Hash{$key} } } if $file1Hash{$key};
  }
  for <$file2>;
close $file2; 
```

输出：

```
chr:123 a aa
chr:123 b aa
chr:456 a bb 
```

# php - 传递要由外部 .js 文件写入的复杂 PHP 变量

> ID：10644670
> 
> 赞同：0
> 
> 时间：2012-05-17T23:07:23.860
> 
> 标签：php, javascript, wordpress, fancybox, nextgen-gallery

**大家好！**

这是我在 stackoverflow 上的第一篇文章。经过数小时的搜索和试验，StackOverflow 提出了许多可能的修复方法：我决定是时候自己提出这个问题了。我正在为我自己的网页设计工作构建一个由 Wordpress 提供支持的投资组合网站。到目前为止，我已经进行了一些广泛的定制，现在我正处于最后阶段。另请注意，我不希望直接支持插件，但我会引用正在使用的插件，它可能会有所帮助。

**前言：**

1.  我正在使用一个名为 NextGen Gallery 的插件，这个插件为我的作品集提供了动力。我所有的客户都有自己的画廊，我在投资组合网站上展示。
2.  我还为 Wordpress 安装了一个名为 Fancybox 的插件。这个插件可以让我所有的客户看起来很好看的灯箱显示。
3.  我有第三个插件，称为 NextGen Gallery 的自定义字段，该插件允许我添加特定于每个图库和图像的自定义字段。您会看到我已经通过通过自定义字段插件添加的链接创建自定义缩略图来利用它。

话虽如此，我的目标是利用自定义字段插件，为每张幻灯片添加 html 富描述文本和 html 富客户端标题文本。幻灯片顶部显示客户名称，幻灯片下方显示带有链接的描述。我已经取得了一些进展，但这是我卡住的地方......

**问题：**

jquery.fancybox.js 不会采用“NextGen Custom Fields”插件生成的我的 PHP 变量，因为它被写入一个名为 gallery-popportfolio.php（NGG 的模板文件）的文件中。我已经对此进行了广泛的测试并得到了相同的结果。添加了一些简单的代码位：

在gallery-popportfolio.php 我把这个：

```
<?php $clientname = nggcf_get_gallery_field($gallery->ID, "clientnamelink"); ?>
<script type="text/javascript"> var clientname = '<?= $clientname ?>'; </script>
<script type="text/javascript" src=".../jquery.fancybox.js"></script> 
```

在 jquery.fancybox.js 我插入这个：（这是一个摘录，我唯一添加的是 .append(clientname)：

`append('<div class="fancybox-bg" id="fancybox-bg-n">').append(clientname)`

现在让我觉得这很有趣的是，如果我在 gallery-popportfolio.php 中将 $clientname 指定为像一行文本一样的静态内容。.js 文件将接受该变量并将其准确放置在我需要的位置。问题是当我将此动态字符串应用到 $clientname 变量时，它根本不呈现任何内容。除此之外，当我使用 PHP 文件中的复杂变量回显 $clientname 时，我得到了正确的结果。

**问题：**

我被难住了，我似乎如此接近但没有正确的结果。

我是否错过了使外部 .js 文件接受更复杂的 php 变量的步骤？

我是否可能只需要将我在其他地方编写的 php 代码移动？

我的下一个最佳步骤是什么？

**笔记：**

我一直在关注这个线程以达到我现在的位置：[StackOverflow Thread](https://stackoverflow.com/questions/2928827/access-php-var-from-external-javascript-file)

我的工作组合网站位于：[EoghanMcInerney.com](http://www.eoghanmcinerney.com/wordpress)

**提前感谢您的帮助！非常感激！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:16:48.057

如果您的意思是复杂变量的“不是字符串”，对于 $clientname，那么您的代码将不起作用。

在这行代码中：

```
<script type="text/javascript"> var clientname = '<?= $clientname ?>'; </script> 
```

`$clientname`应该是没有`'`字符的字符串。我建议您将上面的代码更改为

```
<script type="text/javascript"> var clientname = <?= json_encode($clientname) ?>; </script> 
```

当你追加时，你应该构造一个字符串`clientname`并追加它。

# forms - 在 drupal 7 中，如何提交表单而不重定向到评论页面或消息页面？

> ID：10644671
> 
> 赞同：0
> 
> 时间：2012-05-17T23:07:25.067
> 
> 标签：forms, drupal, redirect

我将消息表单和评论表单制作为块并将块嵌入视图中，每当我提交消息/评论表单时，页面都会重定向到消息/评论页面。

这是代码：

```
 $node = node_load($nid); // $nid contains the node id        
 $comment = new stdClass;
 $comment->nid = arg(2);
 $form = drupal_get_form('comment_node_project_form', $comment);
 print render($form); 
```

我应该如何在不重定向的情况下提交表单？在 $form 变量上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T01:56:34.147

听起来您要么需要 $form_state['redirect'] （尽管在这种情况下，您可能必须取消设置它，因为您的表单已经重定向到新页面），或者您的意思是说您不需要根本不想刷新页面，您需要对表单进行 ajax 化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T04:23:36.207

使用 Ajax 表单提交，否则使用表单更改添加自定义提交回调，您可以在其中将页面重定向到您希望的位置。

另一种非常原始的方法是，只需将`$form['action']`值更改为如下所示：

```
$form['#action'] = '?'. drupal_get_destination(); 
```

这会将您重定向回提交评论的页面。

# python - 在 django admin 的 save_model 方法中操作 m2m 记录

> ID：10644674
> 
> 赞同：0
> 
> 时间：2012-05-17T23:07:48.107
> 
> 标签：python, django, django-admin

我有两个模型，

```
class Course(models.Model):
    #bunch of fields
    students = models.ManyToManyField(Student)

class Student(models.Model):
    #bunch of fields 
```

现在，我没有在课程管理屏幕中使用“常规”m2m 小部件，而是在 CourseAdminForm 中添加了一个文件上传字段，以上传一个带有学生 ID 的文本文件。我在 CourseAdmin.save_model 方法中处理文件，遍历学生列表，例如

```
def save_model(self, request, obj, form, change):
    #some other stuff
    #...
    obj.save()

    #obtain student_ids from uploaded file
    #...        
    for id in student_ids:
        s = Student.objects.get(pk=id)
        course.students.add(s)
    obj.save() #not sure this second one is needed 
```

事实证明，这不起作用：**m2m 关系没有保存**。根据我的阅读，我理解这是因为整个 save_model 方法发生在事务中，并且在提交后，m2m 关系被清除并再次保存，如果它们来自 m2m 小部件。因此，我的问题是我需要手动操纵这些关系，而我只是找不到一种方法（或一个地方）来做到这一点。

因此，问题是：我如何才能实现以编程方式添加这些 m2m 关系的预期结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T00:32:24.123

You can either connect to the m2m_changed signal [https://docs.djangoproject.com/en/dev/ref/signals/#m2m-changed](https://docs.djangoproject.com/en/dev/ref/signals/#m2m-changed), or use Django 1.4's new "save_related" - [https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.save_related](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.save_related) which closed ticket 16115 [https://code.djangoproject.com/ticket/16115](https://code.djangoproject.com/ticket/16115)

See also [https://stackoverflow.com/a/8462541/640759](https://stackoverflow.com/a/8462541/640759)

# msbuild - msbuild 输出删除程序集

> ID：10644677
> 
> 赞同：0
> 
> 时间：2012-05-17T23:08:35.863
> 
> 标签：msbuild, msbuild-task, itemgroup

我有一些看起来像这样的 msbuild 代码：

```
<Target Name="Build">
    <MSBuild
        Projects="@(UnitTestProject)"
        Properties="$(BuildProperties)">
        <Output TaskParameter="TargetOutputs" ItemName="TestAssembly" />
    </MSBuild>
</Target>
<Target Name="Test" DependsOnTargets="Build">
    <ItemGroup>
        <TestAssembly Remove="*.Example.dll" />
    </ItemGroup>
    <xunit Assemblies="@(TestAssembly)" />
</Target> 
```

所以我正在构建我所有的单元测试项目，并使用 TargetOutputs 参数上的输出任务来捕获构建的 dll。问题是其中一个项目正在调用一个任务，该任务输出一些我不想实际运行 xunit 的 dll。

奇怪的是，`Remove="*.Example.dll"`似乎根本没有任何影响，而 xunit 无论如何都在尝试测试程序集。

为什么`Remove`不工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:30:04.217

其实我想我想通了。似乎问题在于相对路径在目标中的 ItemGroups 与目标之外的解析方式。我需要对我的路径更明确一点，然后它才能工作。基本上我这样做是为了让它工作：

```
<Target Name="Build">
    <MSBuild
        Projects="@(UnitTestProject)"
        Properties="$(BuildProperties)">
        <Output TaskParameter="TargetOutputs" ItemName="UnitTestOutput" />
    </MSBuild>
    <ItemGroup>
        <TestAssembly Include="@(UnitTestOutput)" Exclude="$(RootTestPath)\**\*.Example.dll" />
</Target>
<Target Name="Test" DependsOnTargets="Build">
    <xunit Assemblies="@(TestAssembly)" />
</Target> 
```

# html - htaccess 重定向图像

> ID：10644678
> 
> 赞同：0
> 
> 时间：2012-05-17T23:08:40.693
> 
> 标签：htaccess, html, image, .htaccess, redirect

我希望将所有图像的关系链接（例如“/images/filename.ext”）重定向到“http://otherdomain.com/images/filename.ext”之类的东西，以便关系图像地址实际上是寻找其他域上的图像

我努力了：

```
RewriteEngine On
RewriteRule ^images/(.*)$ http://otherdomain.com/images/$1 [NC, P] 
```

和：

```
RedirectPermanent /images http://otherdomain.com/images 
```

但无济于事。自从我写[htaccess](/questions/tagged/htaccess "显示标记为“htaccess”的问题")东西以来已经有很长时间了，而且一开始也不是很好；）所以有点茫然。

我正在为朋友重新编写一些代码，如果他可以复制并粘贴完成的 HTML 而不必担心需要更改的图像链接等，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T07:07:21.390

我在这方面的知识也非常有限，但我在这里查看了一些工作示例，它们可能会对您有所帮助：

```
1 RewriteRule (^/image/.*) http://otherdomain.com$1 [P] 
```

也许这会起作用

```
2 ProxyPass /image http://otherdomain.com/image 
```

# android - 当用户在 SlidingDrawer 之外进行操作时关闭 SlidingDrawer

> ID：10644680
> 
> 赞同：0
> 
> 时间：2012-05-17T23:08:58.817
> 
> 标签：android, android-layout, android-widget

我有一个自定义滑动抽屉，它基本上具有与选项菜单相同的特征。我不会解释为什么我现在不使用选项菜单，因为它超出了这个问题的范围（长话短说 - 它不起作用）。

抽屉位于视图分页器的顶部，因此用户可以在各个片段之间滑动以与应用程序的各个方面进行交互。我希望能够检测到何时与 SlidingDrawer 之外的任何东西交互/参与。如果发生这种情况，我想自动关闭滑动抽屉。

我已经尝试过监听器、事件监听器、手势、手势监听器等，但我似乎无法让这种神奇的药水发挥作用。有人有任何想法/提示/技巧吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:45:22.777

您是否尝试过覆盖

```
public boolean dispatchTouchEvent(MotionEvent ev) 
```

此方法是从 Activity 继承的，因此您应该可以访问它。

你没有发布任何源代码，所以我可以肯定它会起作用。请尝试让我们知道。

# android - 通过 RubyCAS 使用单个访问令牌访问 Rails API

> ID：10644683
> 
> 赞同：2
> 
> 时间：2012-05-17T23:09:16.960
> 
> 标签：android, ruby-on-rails, cas, rubycas, sorcery

我目前正在设计一个 Web 应用程序的架构并对其进行原型设计，该应用程序由三个部分组成，一个由 Rails 应用程序提供的 Restful API（JSON，XML）接口，一个由第二个 Rails 应用程序支持的 Backbone.js 应用程序，以及一个 Android通过 API 访问数据的应用程序。

虽然验证用户的通常过程（重定向到登录页面）适用于 Backbone.js 应用程序，但我想使用来自 Android 应用程序的单个访问令牌来验证用户。我可以看到第一次使用 Android 应用程序时需要用户名和密码，从 CAS 服务器传回包含预先生成的单一访问令牌的附加信息。我无法解决的是如何将单个访问令牌与来自客户端的请求一起传递，并在不重定向到登录页面等的情况下针对 CAS 进行身份验证。

我需要知道的是，这是否可以通过 CAS 实现，或者是否有一种更像“CAS 方式”的方法可以用来实现相同的结果？

我已经对 Devise 和 CAS 插件 devise_cas_authenticable 进行了试验，但这似乎被最新版本的 Devise 破坏了。理想情况下，我想在我自己的单一访问令牌生成实现中使用巫术，所有这些都与 CAS 挂钩。我对 CAS 非常陌生，它可以做什么，所以我试图先找出可能的方法，然后如果需要任何我能够编码的新开发，我将回馈 ruby​​cas-client 和魔法.

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T17:57:13.170

我相信您正在寻找[代理授予令牌](http://www.jasig.org/cas/protocol)（第 3.3 节）。这允许一个应用程序将有效的身份验证代理给另一个应用程序。RubyCAS 客户端通过以下方式支持这一点：

```
class ApplicationController < ActionController::Base
  before_filter :authenticate!

protected

  def authenticate!
    # This triggers RubyCAS client to request a proxy granting ticket
    CASClient::Frameworks::Rails::Filter.client.proxy_callback_url = "myservice.com" 
    CASClient::Frameworks::Rails::Filter.filter(self)

    if session[:cas_pgt]
      # You will want to pass this as a URL param to your remote service
      # whenever you call it. We store it on our base ActiveResource model
      # and automatically append to the url params of all requests.
    end

    # Username is available in session[:cas_user]
  end
end 
```

此解决方案不使用设计。

# java - 设置 log4j 日志级别

> ID：10644687
> 
> 赞同：27
> 
> 时间：2012-05-17T23:09:37.217
> 
> 标签：java, logging, log4j

我目前正在开发一个使用 log4j 的项目。我正在运行一个测试用例（junit）并想将日志级别设置为跟踪，以便我可以查看所有值是否正确。在项目中使用日志记录的类包含如下一行：

```
private static final Log LOG = LogFactory.getLog(MatchTaskTest.class); 
```

并使用这样的方式进行实际调试

```
LOG.trace("value"); 
```

我以前从未使用过 log4j，有人知道我如何仅为测试用例更改日志级别，最好只需在 eclipse 的运行配置对话框中定义一个参数。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-17T23:35:58.580

## 使用另一个配置文件

也许您可以指向另一个配置文件。

```
java -Dlog4j.configuration=config file yourApp 
```

在哪里：

*   `config`，您的配置文件，例如`log4j.properties` 或`log4j.xml`.
*   `file`, 日志文件，例如`myApp.log`
*   `yourApp`，你的应用程序，例如`MyAppGUI`

或者你可以使用一个类

```
java -Dlog4j.configurationClass=config class yourApp 
```

在哪里：

*   `config`，您的配置文件，例如`log4j.properties`或`log4j.xml`.
*   `class`，任何自定义的初始化类，如`LogManager`，都应该实现[`org.apache.log4j.spi.Configurator`](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/spi/class-use/Configurator.html)
*   `yourApp`，你的应用程序，例如`MyAppGUI`

您可以在[Apache log4j 1.2 -](http://logging.apache.org/log4j/1.2/manual.html) *Default Initialization Procedure*部分对 log4j的简短介绍中看到更多信息。

## 以编程方式修改关卡

此外，您还可以使用提供[`Logger`](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/Logger.html)类的方法[`public void setLevel(Level level)`](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/Category.html#setLevel%28org.apache.log4j.Level%29)，例如：

```
Logger.getRootLogger().setLevel(Level.TRACE); 
```

由于您只想用于测试目的，您可以使用它们。但建议不要在客户端代码中使用，因为它们会覆盖硬编码中的默认配置参数。最好的方法是使用外部配置文件。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-05-17T23:38:18.027

在你的junit类中放：

```
Logger.getRootLogger().setLevel(Level.TRACE); 
```

在执行测试方法之前的某个地方。它将根记录器的阈值级别设置为 TRACE。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-07T02:07:16.830

如果你使用 Maven，你可以有两个 log4j 配置文件：

*   一个在 src/main/resources 中，包含您的生产日志配置
*   一个在 src/test/resources 中，包含您的测试时日志配置

Maven 将在测试时自动使用后者，并将前者捆绑到您的工件（JAR、WAR 等）中，以便在生产中使用。您不必乱用命令行开关或任何东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T23:18:15.690

我不认为这是可能的。

配置文件将让您配置日志中实际显示的日志消息，而不是每条消息要记录的级别。这是有道理的——配置不应影响消息的级别。

[javadoc](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/Logger.html)对每个日志级别都有一个方法和一个通用日志方法，它具有优先级，所以我不确定是否设置了默认值。

您可以通过 明确地在命令行上设置配置文件`-Dlog4j.configuration=<FILE_PATH>`，因此您可以为该测试用例设置特定的配置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-22T12:44:19.730

我不知道为什么上面的一些对我不起作用。（我不想写配置文件）。以下对我有用

```
Logger log1 = Deencapsulation.getField(Some.class,"logger");
log1.setLevel(Level.DEBUG); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-17T01:34:29.380

注意 log4j2.properties 文件可能包含该行

```
filter.threshold.level = debug 
```

您可能会浪费一整个下午来试图弄清楚为什么您的 LOG.trace() 语句没有输出任何内容！

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2013-05-15T22:18:07.973

我实际上把它放在@Before 方法中。但我相信它可以（并且应该）放在@BeforeClass 中。

如果你在类体中设置它，你会得到编译器错误。

# java - 无法找出空指针异常

> ID：10644688
> 
> 赞同：0
> 
> 时间：2012-05-17T23:09:49.923
> 
> 标签：java, android

好的，所以我一直试图找到解决这个问题的几个小时，但我找不到。这是我日志猫所说的空指针期望的代码：

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class splash extends Activity{
Button begin;
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    begin=(Button) findViewById(R.id.button);
    begin.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            Intent startmenu=new Intent("com.life.project.menu");
            startActivity(startmenu);
        }
    });
}

} 
```

和继承人的xml文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" android:background="@drawable/icon3">

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="You have 20 minutes to increase your status as much as possible." />

<Button
    android:id="@+id/button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Begin!"
    android:layout_gravity="center"
    android:typeface="monospace" />

 </LinearLayout> 
```

所以当我尝试运行它时，它得到一个空指针异常，我不知道它有什么问题，有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T23:14:08.933

您需要先`setContentView`致电`findViewById`：

```
setContentView(R.layout.the_layout_xml_name);
begin=(Button) findViewById(R.id.button);
// ... 
```

# c# - 如何通过 ajax/.getJSON() 获取服务器变量

> ID：10644692
> 
> 赞同：0
> 
> 时间：2012-05-17T23:10:10.707
> 
> 标签：c#, jquery

Righto，我想要实现的目标如下：

我的 OnLoad 事件构建了一个 JSON 字符串，并将其存储为一个变量（我们称之为 x），然后我可以在客户端以 <%= x %> 的形式访问该变量。一切都好 - 我从客户端的服务器获得了我需要的数据。

不过，我不想做的是让变量在源代码中可见。我想通过 jQuery 访问它，并将其附加到一个元素，就像我可以使用静态文件一样：

```
$.ajax({
    url: "myData.html",
    success: function (data) {
    $("#holder").html(data);      
    }
}); 
```

我想我需要的是能够替换这一行：

```
url: "myData.html", 
```

引用服务器变量 x。那可能吗？我可能会使用 OnLoad/PageLoad 将 x 写入静态文件，然后通过 ajax 获取它，但这似乎是一个不必要的额外步骤。有任何想法吗？

ñ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:22:48.193

如果您有 IIS 设置来处理 .js 文件，或者如果这是您页面上的内联 js，您可以在 javascript 中创建一个变量，例如：

`var serverval = '<%= Request.ServerVariable['LOCAL_ADDR'] %>';`

您还可以创建一个隐藏的表单元素/asp:hidden 并在 postback/onload 中更新该值并像这样引用它：

`<input type='hidden' id='serverval' value='whatever you put ' />` `var serverval = $('#serverval').val();`

[http://forums.asp.net/t/1289684.aspx/1](http://forums.asp.net/t/1289684.aspx/1)

# php - 在 javascript 字符串中用转义符替换字符

> ID：10644694
> 
> 赞同：0
> 
> 时间：2012-05-17T23:10:44.997
> 
> 标签：php, javascript, jquery, escaping

我知道肯定有成千上万个这样的线程，但是互联网和堆栈溢出充斥着来自其他编程语言的结果，并且只是用空格替换字符等等......

所以...我的问题如下...

我有一个表格：`<input type='text' id='my_input'>`

然后我在javascript（使用jquery）中解析我的所有字段以创建我的ajax调用，就像这样

`var my_value = $('#my_input').val();`

然后我做一个替换以获得换行符`my_value = my_value.replace('\n', '<br>');`

之后我用 ajax 像这样发布我的变量：

```
data_to_post = 'my_field1=' + my_value1 + 'my_field2' + my_value2;

$.ajax({  
type: 'POST',  
url: '/write_to_db.php',  
data: data_to_post
}); 
```

现在我网站上的很多人都在谈论编程，并且这些内容开始搞砸我的网站，因为他们的帖子内容被解析为 php 或 html 格式 - 我打算替换所有可能搞砸我网站代码的有问题的字符.

最有问题的表达式是 html 标记和 &=，因为它会干扰我将 post 变量放在一起的方式。

现在，因为这些字符是内容所必需的，所以我不能简单地将它们全部替换为单个字符。

有什么办法可以逃脱它们（最好在一行命令中）？

谢谢！

更新：我的临时解决方案是这样的：

```
this_string = this_string.replace(/</g, '&#60;');
this_string = this_string.replace(/>/g, '&#62;');
this_string = this_string.replace(/\n/g, '<br>');
this_string = escape(this_string); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:23:40.850

我会在表单元素本身上使用 $.serializeJSON() 来收集整个表单的所有值。然后我会通过 AJAX 调用将其发送到服务器端脚本。解析允许代码和纯文本的复杂注释或文本字段之类的任务最好留给服务器端语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:51:50.707

试试javascript函数escape()：[http ://www.w3schools.com/jsref/jsref_escape.asp](http://www.w3schools.com/jsref/jsref_escape.asp)

```
data_to_post = 'my_field1=' + escape(my_value1) + 'my_field2' + escape(my_value2); 
```

***编辑：***

要处理不允许发布的 HTML 字符，您可以使用 php 编写：

```
$outputstring = "hi<br />bye!";
echo htmlspecialchars($outputstring); 
```

有关其工作原理的信息：http: [//php.net/manual/en/function.htmlspecialchars.php](http://php.net/manual/en/function.htmlspecialchars.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:20:29.977

怎么样：

```
my_value = my_value.replace(/\n|\.|\~/g, '<br>'); 
```

把你的字符替换为 | (OR) 分隔符并在末尾添加 /g 标志

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T23:24:44.517

尽管您的意图对我来说并不完全清楚，但您可以保留程序员的内容，并通过将表达式包装在标签中来显示回车/换行。

另一种可能性是使用 CSS 来设置外观样式。看看这篇文章的答案：[如何用 <br/> 替换某些回车换行符，后跟破折号？](https://stackoverflow.com/questions/10519489/how-can-i-replace-certain-carriage-return-line-feed-followed-by-a-dash-with-a-b)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-17T23:30:43.850

听起来您只是想对 HTML 字符进行编码以保留 HTML 字符，因此如果是这种情况，以下将正确编码文本：

```
var textVal = $('#my_input').val();
var encoded = $('<div/>').text(textVal).html(); 
```

这会创建一个内存中的 div 来帮助进行编码。要解码，您只需将 div 调用更改为：

```
 var unencoded = $('<div/>').html(textVal).text() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-17T23:53:11.640

您是否考虑过像下面的示例一样让 PHP 为您处理这个问题..？

```
nl2br(htmlspecialchars($str,ENT_QUOTES,'UTF-8')); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-18T03:24:00.513

```
$.ajax({  
type: 'POST',  
url: '/write_to_db.php',  
data: {
   'my_field1': my_value1,
   'my_field2': my_value2
}
}); 
```

在数据中传递一个对象而不是字符串，jquery 会为你做。

# javascript - 为什么 Ajax 不使用自调用？

> ID：10644700
> 
> 赞同：0
> 
> 时间：2012-05-17T23:11:53.497
> 
> 标签：javascript, ajax, closures, parentheses, self-invoking-function

自调用`closure`函数的奇怪语法意味着您本质上是在调用函数本身，因此将其设为`self-invoking`. 这里有一些代码证明了这一点：

```
<!DOCTYPE html>
<html>
    <head>
        <title>
            A Nameless Function that Executes Itself
        </title>
    </head>

    <body onload = "mainMethod();">

        <div id = "here"></div>

        <script type = "text/javascript">

            function mainMethod()
            {
                var here = document.getElementById("here");
                var hello = "Hello World!";

                here.innerHTML = function()
                {
                    return hello + "<br />";
                }(); // WITH method parentheses -- self-invoking

                here.innerHTML += function()
                {
                    return hello;
                }; // withOUT method parentheses
            }
        </script>
    </body>
</html> 
```

...上面的第二个函数**没有**执行，因为它缺少结束括号，并且`innerHTML`变成了整个函数本身。那么，为什么您的标准 Ajax 语法不以同样的方式使用自调用呢？似乎这些属性以独特的方式处理`XMLHttpRequest`。`onreadystatechange`这是一个例子：

```
function getStock()
{
    var req = new XMLHttpRequest();

    var stock = document.getElementById("stock");

    req.onreadystatechange = function()
    {
        if( (req.readyState == 4) && (req.status == 200) )
        {
            // value of stock
            var stockValue = req.responseText;

            stock.innerHTML = stockValue;
        }
    }
    req.open("GET", "randomStockValue.php?random=", true);
    req.send(null);

    setTimeout("getStock()", 1000);
} 
```

注意**没有**结束括号...我问这个是因为我想进一步了解 Ajax 语法，以及它到底在做什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T23:20:24.167

该`readystatechange`属性包含一个回调函数（或有时称为事件处理函数），将来当某些 ajax 事件发生时，浏览器的 ajax 引擎将多次调用该回调函数。

您不希望它立即执行。您希望将来发生这些特定事件时调用分配给它的函数。您不希望它自动执行。

有关在将来某个时间调用的事件侦听器或回调函数的其他示例，请参阅类似`addEventListener()`or的方法`setTimeout()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T23:19:53.670

它注册一个事件监听器。该函数不会立即执行，它（函数对象）只是分配给`onreadystatechange`属性。稍后将调用它 - 当 ajax 请求更改其状态时。这有点像 a`setTimeout`具有未知超时（并且会被多次调用）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:34:48.140

ajax 调用处理程序没有什么特别之处，您可以为第一个示例编写完全相同的代码，它将执行相同的等待：

```
 function mainMethod()
            {
                var here = document.getElementById("here");
                var hello = "Hello World!";

                here.innerHTML = function()
                {
                    return hello + "<br />";
                }(); // WITH method parentheses -- self-invoking

                here.innerHTML += function()
                {
                    return hello;
                }; // withOUT method parentheses
            }

document.body.onload = mainmethod ; 
```

您给出了 2 个不共享相同上下文的示例，这就是为什么它们的行为确实不同。

现在试试

```
document.body.onclick = mainmethod ; 
```

在您单击网页之前，您的功能不会执行。ajax 调用也是如此。

# python - django：如何记忆模型管理器方法？

> ID：10644702
> 
> 赞同：0
> 
> 时间：2012-05-17T23:11:58.633
> 
> 标签：python, django, memoization, django-managers

我有一个记忆的 Django 模型管理器方法，如下所示：

```
class GroupManager(models.Manager):
    def get_for_user(self, user):
        cache_key = 'groups_%s' % (user.id)
        if not hasattr(self, key):
            groups = get_groups_somehow()
            setattr(self, cache_key, groups)
        return getattr(self, cache_key) 
```

但是记忆值在请求/响应周期之外仍然存在；即在服务器重新启动之前，不会在后续请求中重新计算该值。这一定是因为管理器实例没有被销毁。

那么，我怎样才能正确地记住模型管理器方法呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T00:25:49.190

不会重新计算键值，因为您告诉它一旦键存在就不会重新计算。如果您想在后续调用中重新计算它，请重新排序您的代码

```
class GroupManager(models.Manager):
    def get_for_user(self, user):
        cache_key = 'groups_%s' % (user.id)
        groups = get_groups_somehow()
        setattr(self, cache_key, groups)
        return getattr(self, cache_key) 
```

如果您想在不重新计算的情况下获取缓存的值，只需`getattr`在管理器上使用正确的键即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T19:29:51.060

从[https://stackoverflow.com/a/1526245/287923](https://stackoverflow.com/a/1526245/287923)获得灵感，但为了简化它，我实现了一个请求缓存，如下所示：

```
from threading import currentThread

caches = {}

class RequestCache(object):
    def set(self, key, value):
        cache_id = hash(currentThread())
        if caches.get(cache_id):
            caches[cache_id][key] = value
        else:
            caches[cache_id] = {key: value}

    def get(self, key):
        cache_id = hash(currentThread())
        cache = caches.get(cache_id)
        if cache:
            return cache.get(key)
        return None

class RequestCacheMiddleware(object):
    def process_response(self, request, response):
        cache_id = hash(currentThread())
        if caches.get(cache_id):
            del(caches[cache_id])
        return response 
```

`caches`是缓存字典的字典，通过`get`&`set`方法访问。`process_response`在呈现响应后，中间件会清除方法中当前线程的缓存。

它是这样使用的：

```
from request_cache import RequestCache
cache = RequestCache()
cache.get(key)
cache.set(key, value) 
```

# c# - C# 泛型：约束 T 其中 T ：对象不编译；错误：约束不能是特殊类“对象”

> ID：10644703
> 
> 赞同：21
> 
> 时间：2012-05-17T23:12:01.393
> 
> 标签：c#, .net, generics, object, clr

当我用 : Object 约束 T 时：

```
public interface IDoWork<T> where T : Object
{
    T DoWork();
} 
```

我得到错误：

> 约束不能是特殊类“对象”

这是否意味着编译的以下内容存在隐含差异？

```
public interface IDoWork<T> // where T : Object
{
    T DoWork();
} 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-05-17T23:15:49.093

如果要将泛型类型约束为引用类型，请使用`: class`.

```
public interface IDoWork<T> where T : class
{
    T DoWork();
} 
```

这将禁止泛型类型成为值类型，例如`int`或结构。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-17T23:32:06.677

这两个约束之间没有区别，只是不允许明确说明无用。

C# 4.0 语言规范（10.1.5 类型参数约束）对此有两点说明：

> 类型不能是对象。因为所有类型都派生自对象，所以如果允许，这样的约束将不起作用。
> 
> ...
> 
> 如果 T 没有主约束或类型参数约束，则其有效基类是 object。

在您的评论中，您说您试图使`T`type `Void`。`Void`是一种特殊类型，表示没有返回类型，不能用来代替`T`，需要适当的具体类型。`T`如果您想要两者，则必须创建方法的无效版本和版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-30T08:19:31.020

根据 C# 4.0 语言规范（编码：[10.1.5] 类型参数约束）说明了两件事：

> 1] 类型不能是对象。因为所有类型都派生自对象，所以如果允许，这样的约束将不起作用。
> 
> 2] 如果 T 没有主约束或类型参数约束，则它的有效基类是 object。

当您定义一个泛型类时，您可以对客户端代码在实例化您的类时可用于类型参数的类型类型应用限制。如果客户端代码尝试使用约束不允许的类型来实例化您的类，则结果是编译时错误。这些限制称为约束。使用 where 上下文关键字指定约束。 **如果要将泛型类型限制为引用类型，请使用 :class。**

根据[MSDN](https://msdn.microsoft.com/en-us/library/56b2hk61.aspx)

约束不能是特殊类“标识符”。以下类型不能用作约束：

*   系统对象
*   系统数组
*   系统委托
*   系统枚举
*   系统值类型。

# php - $.ajax 在 IE 中不起作用

> ID：10644708
> 
> 赞同：0
> 
> 时间：2012-05-17T23:12:43.010
> 
> 标签：php, jquery, ajax

有谁知道这里发生了什么？我编写了这段代码来调用 php 文件来生成图像，然后将其显示在屏幕上。不知何故，这在 Mozilla 和 Chrome 中运行良好，但在 IE 中却不行。有人知道我的代码出了什么问题吗？

```
var src = $.ajax({
url: "em_captcha.php",
async: false
}).responseText;

$("#imgCaptcha").html(src); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:16:00.380

如果你尝试：

```
$.ajax({
   url : "em_captcha.php",
   async : false,
   success : function(src){
      $("#imgCaptcha").html(src); 
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T23:15:30.247

导致此问题的缓存，我已通过将以下代码添加到 ajax 中来解决此问题：

缓存：假，

# c# - 如何在 C# 中将 json 转换为平面结构

> ID：10644709
> 
> 赞同：8
> 
> 时间：2012-05-17T23:12:50.317
> 
> 标签：c#, json

我正在尝试用 C# 编写将 JSON 转换为键/值对的函数。它应该支持数组。因此，例如以下 JSON：

```
{ 
    title: title_value,
    components: [
        {
            component_id: id1,
            menu: [
                   {title: menu_title1},
                   {title: menu_title_x},
                   {id: menu_id1}    
            ]
        },
        {
             component_id: id2,
             menu: [
                   {title: menu_title2},
                   {id: menu_id2}    
             ]
        }
    ]
} 
```

应转换为：

*   标题 = 标题值
*   components.0.component_id = id1
*   components.0.menu.0.title = menu_title1
*   components.0.menu.1.title = menu_title_x
*   components.0.menu.2.id = menu_id1
*   components.1.component_id = id2
*   components.1.menu.0.title = menu_title2
*   components.1.menu.1.id = menu_id2

有什么简单的方法可以完成这项任务吗？当我开始考虑数组和嵌套数组时，逻辑变得复杂。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T23:17:29.870

我会调查[http://json.codeplex.com/](http://json.codeplex.com/)

我认为这可以满足您的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T21:51:07.653

解决方案如下。JavaScriptSerializer 从 json 字符串 ('json') 创建对象 ('o')，然后 BuildVariablesList 方法遍历对象并填充包含结果的字典 ('additionalParameters')。

```
 var jss = new JavaScriptSerializer();
    var o = return new DynamicJsonObject(jss.Deserialize<Dictionary<string, object>>(json));

    var additionalParameters = new Dictionary<string, string>();
    BuildVariablesList(o.GetInternalDictionary(), "", additionalParameters);

    private static string AppendToPathString (string path, object part )
    {
        return path.Trim().Length == 0 ? part.ToString() : path + '.' + part;
    }

    public static void BuildVariablesList(object obj, string path, Dictionary<string, string> result)
    {
        if ( obj is ArrayList)
        {
            var arrayObj = obj as ArrayList;
            for (var i = 0; i<arrayObj.Count; i++ )
            {
                BuildVariablesList(arrayObj[i], AppendToPathString(path,i), result);
            }
        }else if ( obj is Dictionary<string, object>)
        {
            var dictObject = obj as Dictionary<string, object>;
            foreach (var entry in dictObject)
            {
                if (entry.Value is String && (path.Trim().Length > 0 || !ReservedFieldNames.Contains( entry.Key.ToLower())))
                {
                    result.Add(AppendToPathString(path,entry.Key), entry.Value as String);
                }
                else if (entry.Value is Dictionary<string, object>)
                {
                    BuildVariablesList(entry.Value as Dictionary<string, object>, AppendToPathString(path, entry.Key), result);
                }
                else if (entry.Value is ArrayList)
                {
                    BuildVariablesList(entry.Value as ArrayList, AppendToPathString(path, entry.Key), result);
                }
            }
        }            
    } 
```

# javascript - 如何window.location.hash-改变位置，然后运行一个函数？

> ID：10644710
> 
> 赞同：0
> 
> 时间：2012-05-17T23:12:55.543
> 
> 标签：javascript, jquery-mobile, hashchange

我有一个功能，说

```
function runSomething()
{
   alert("hello");
} 
```

我有`window.onhashchange = runSomething;`
并且在我的代码中，我打电话`window.location.hash = "#processsection"`

runSomething 运行，但是它在页面执行到#processsection 之前运行......我怎样才能让它只在我在#processsection 之后运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:59:41.387

在您的场景中，我可能会使用 if 条件来检查该 div 或 body（以适用者为准）是否正在播放动画。滚动。这是一个未经测试的粗略想法。

```
function runSomething() {        
    if ($('body').is(':animated') {
        $('body').queue(function() {
            alert("hello");
        });
    } else {
        alert("hello");
    }
} 
```

# visual-studio-2010 - NLog 和 Visual Studio 2010

> ID：10644711
> 
> 赞同：2
> 
> 时间：2012-05-17T23:13:05.887
> 
> 标签：visual-studio-2010, nlog

我试图将 NLog 与 Visual Studio 2010 一起使用，但未成功。但是，它在 Visual Studio 2008 中使用相同的 .config 文件和相同的源代码运行良好，那么我做错了什么？有人知道是否可以将 NLog 与 VS2010 一起使用，或者是否有任何其他工具可以登录 VS2010？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:53:20.470

我将 NLog 与 VS2010 和 Visual Studio 11 Beta 一起使用，没有任何问题。

首次在 VS2010 中打开 vs2008 解决方案时，您是否将项目升级到新/不同版本的 .NET 框架？

如果您的项目是 C#，则在 VS2010 的解决方案资源管理器中右键单击该项目，然后在 Application 选项卡中检查 Target Framework 的值。如果它是**.NET Framework 4**，那么它已与您之前使用的有所不同。

您可能想尝试将其切换回您之前使用的任何内容（最有可能是 2.0 或 3.5）

# php - 使用 ID 从数据库中删除一行

> ID：10644713
> 
> 赞同：0
> 
> 时间：2012-05-17T23:13:37.847
> 
> 标签：php, mysqli

我在使用 MSQLI 从屏幕上删除记录时遇到问题。在这里你可以看到我正在使用的代码。

```
<?php
        include_once("assets/classes/connection.php");
        include_once("assets/classes/article.class.php");
        while($test = $allArticles->fetch_assoc())
            {
                if($test['titel']=="")
                {
                    echo "<div class='zonderfoto'>";
                    echo "<h5>"."geen titel hier, aparte opmaak geslaagd" . "<br /></h1>";
                    echo "<p>" . $test['article'] . "</p>";

                    echo "<input type='submit' name='verwijderee' value='verwijder'>";

                    echo "</div>";
                }
                else
                {
                    echo "<div class='metfoto'>";
                    echo "<h1>".$test['titel'] . "<br /></h1>";
                    echo "<p>" . $test['article'] . "</p>";
                    echo "<form method='post' action=''>";
                    echo "<input type='submit' name='verwijder' value='verwijder'>";
                    echo "</form>";
                    echo "<h1>".$test['id']."</h1>";
                    echo "</div>";

                }
            }
        $vArticle = new Article;
        $vArticle -> Key = $test['id'];
        if (isset($_POST['verwijder']))
        {
            $vArticle -> deleteArticle();
            echo ("shit");
        }
        ?> 
```

我正在使用 while 函数在屏幕上打印所有数据库记录。if 函数只是一个用 css 进行设计的函数，仅此而已。使用删除按钮，我想从屏幕上删除记录。使用 $test['id'] 变量，您会收到数据库中记录的 ID

好的，这是我在课堂上的代码。

```
public function deleteArticle()
{
    include("connection.php");
    $sSql = "DELETE FROM tblArticles WHERE id = '".$this->m_sKey."'";

        if (!$mysqli -> query($sSql))
        {
            throw new Exception("Something went wrong");
        }
} 
```

**编辑**

*键有问题，我用title =“”替换了where语句，所以我删除了数据库中的一个标题，然后当我点击删除时，他删除了一行，但这在运行时不会发生。所以我单击删除，删除了一行，但内容仅在页面刷新时消失。解决方案是使用ajax？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:25:43.567

```
public function deleteArticle()
{
    include("connection.php");
    $sSql = "DELETE FROM tblArticles WHERE id = '".$this->m_sKey."'";
    $mysqli->query($sSql);
    $aff_rows = $mysqli->affected_rows;
    if ($aff_rows){
        print("Affected rows (DELETE): %d\n", $aff_rows);
    }
    else{
        print("Nothong Happend ?");
        if ($err = $mysqli->error){
              print("Error: %s\n", $err);
        }
    }
} 
```

# sql - 在正常情况下，创建作为现有索引开始的部分键的索引是否有任何显着优势

> ID：10644723
> 
> 赞同：2
> 
> 时间：2012-05-17T23:14:38.493
> 
> 标签：sql, sql-server, database

如果我创建的索引是第二个索引开头的部分键，那么当搜索条件与更简单的索引匹配时，服务器能够以多快（如果有的话）检索更简单的索引的结果？

例如，如果我有一个非聚集索引`(TransactionDate, ClientID, State)` 并且我的搜索条件只是`TransactionDate`，那么通过创建and`ClientID`的第二个索引可以实现哪些搜索性能提升？该表具有非常典型的数据分布。大约有 1200 万行，100 个日期，每天约有 160,000 条记录，分布在 500 个客户中。`TransactionDate``ClientID`

不考虑索引维护 ( `inserts`, `updates`, `deletes`) 和磁盘空间使用情况。sql server 如何实现和利用索引的低级细节将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:46:57.113

由于您明确表示您不关心与维护多个索引相关的开销，因此答案是肯定的。如果您只搜索第一个键，那么对于性能和速度而言，只有一个键列的窄索引比具有多个列的窄索引要好。

如果您只搜索第二、第三键之一。然后将它放在它自己的索引中会更好，因为它可以避免索引扫描，因为只有索引中列出的第一列可以用于直接查找。

*仅考虑搜索速度*的最佳做法是将索引分成两个（甚至三个），当定期搜索单个术语时，每列都有自己的索引。如果边缘情况使用多个谓词，引擎仍然可以与多个索引相交。

*注意：如果你经常搜索两个谓词；那么在这些搜索中，两者的复合索引更好，因为它不必相交。*

在实际使用中（即 OLTP 与 OLAP 或磁盘空间考虑因素可能另有规定），最佳方法可能会有所不同 - 但同样，您说您并不关心这一点。

请注意，您在现实世界中对任何性能提升/速度提升的感知可能是绝对无法察觉的；但在某些情况下，任何一点点都有帮助。 [看看这个 Microsoft 的 SQL 索引性能检查表](http://msdn.microsoft.com/en-us/library/ff647681.aspx)。

* * *

**附加更新：**

这是 Brad McGehee 关于这个主题的一篇非常好的文章

[http://www.sql-server-performance.com/2007/composite-indexes/](http://www.sql-server-performance.com/2007/composite-indexes/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T14:07:38.803

> 例如，如果我有一个非聚集索引（TransactionDate、ClientID、State），并且我的搜索条件只有 TransactionDate 和 ClientID，那么通过创建 TransactionDate 和 ClientID 的第二个索引可以获得什么搜索性能提升？

一般没有。

索引`(TransactionDate, ClientID)`会稍微窄一些（因为它不需要 store `State`），但它仍然具有相同数量的叶子（以及指向表行的指针）。因此，虽然它将*更*紧密地集群节点，但优势可能很小。

维护额外索引的开销几乎肯定会超过这个好处。并且通过维护，我不仅仅指修改，我还指缓存，因此即使附加索引在理论上可能更好，您也可能会从单个索引中看到更好的实际搜索性能。

顺便说一句，如果您的表恰好是集群的，这将使二级索引更加昂贵且不太理想。

如果您还不熟悉该主题，我强烈建议您查看[SQL 索引剖析](http://use-the-index-luke.com/sql/anatomy)。无论如何，我建议您在得出自己的结论之前**测量实际数据量。**

# php - 在下载 PHP 之前重命名文件

> ID：10644724
> 
> 赞同：0
> 
> 时间：2012-05-17T23:14:49.687
> 
> 标签：php, html

我目前正在制作一个文件托管网站。在用户下载文件之前重命名文件时遇到问题。上传文件时，原始名称保存在 mysql 数据库中，并将文件重命名为 id。

```
<?php

  require("includes/inc.php");

$id = trim(sanitize($_GET['id'])); //Receives the id of the file from the url

if($id) {
    $fileid = mysql_query("SELECT * FROM files WHERE id = '$id'");

    if (mysql_num_rows($fileid) != 1) {
        header('Location: download.php?error=invalid_file');
        exit();
    } else {
        while($info = mysql_fetch_array($fileid)) {
        $fileid2 = $info['id'];
        $filename = $info['name'];
        $ext = $info['ext'];
        $filesize = $info['size'];
        $downloads = $info['downloads'];
            header('Content-Description: File Transfer');
            header('Content-Type: application/octet-stream');
            header("Location: uploads/".$fileid2.".".$ext);
            header('Content-Disposition: attachment; filename="'.$filename.'"');
            header('Content-Length: ' . $filesize);
        }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T01:47:36.917

我认为您的“while”循环和输出将是这样的：（我还在标题中切换了 $filename 和 $fileid2 ）

```
 while($info = mysql_fetch_array($fileid)) {
            $fileid2 = $info['id'];
            $filename = $info['name'];
            $ext = $info['ext'];
            $filesize = $info['size'];
            $downloads = $info['downloads'];
    }

    header('Content-Description: File Transfer');
    header('Content-Type: application/octet-stream');
    header('Content-Disposition: attachment; filename="'.$fileid2.'.'.$ext.'"');
    header('Content-Length: ' . $filesize);

readfile(uploads/".$filename.".".$ext); 
```

我没有测试这个，所以我希望它有帮助。

# clojure - leiningen 如何在不复制 jar 的情况下为 clojure 指定依赖项

> ID：10644727
> 
> 赞同：1
> 
> 时间：2012-05-17T23:15:16.143
> 
> 标签：clojure, leiningen

每次我执行 lein new 时，我似乎都会在该项目的 lib 文件夹中获得一份 clojure jar 的副本。我认为 jars deps 被复制到 .m2/repository。为什么每个 lein 项目都复制 clojure jar？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T17:50:35.117

这只发生在 Leiningen 1 中。这样做的原因（我认为）是允许工具轻松检查依赖关系。使用 Leiningen 2，这不再是一个问题，因为它使用[pomegranate](https://github.com/cemerick/pomegranate)库（它是 Aether 的包装器）来管理依赖项。它允许更健壮的依赖管理，因此 Leiningen 可以只链接到本地​​ Maven 存储库中的依赖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T01:56:51.357

罐子缓存在您的 .m2 存储库中。但是，要在您的项目中使用它们，它们需要位于项目的类路径中，通常位于您的 project/lib 目录中。在本地 Maven 存储库中缓存只是为您节省了从服务器下载的内容。

# c# - 活动和代表

> ID：10644735
> 
> 赞同：1
> 
> 时间：2012-05-17T23:16:22.380
> 
> 标签：c#, events, delegates

```
Button.Click += new RoutedEventHandler(_click);

private void _click(object sender EventArgs e) 
{
   //... 
} 
```

在上面的代码中，我们使用 Button.Click 事件来实例化 RoutedEventHandler 类型，它是一个委托。但是事件本身就是一个抽象的委托，不是吗？我不明白这与仅将 RoutedEventHandler 实例化为变量，然后将变量添加到实例的调用列表之间的区别。我做这太难了吗？这里涉及的所有代表是如何工作的？

编辑：所以我主要关心的是试图弥合我对代表的了解与我对事件的了解之间的差距。我知道一个事件是一个包裹在另一层抽象中的委托。因此，当您使用 += 运算符将另一个委托分配给其调用列表时，您只是将一个委托分配给另一个委托，对吗？但是在我上面写的代码中，你实际上并没有实例化 RoutedEventHandler 类，所以我很困惑你实际上是如何将它传递到 Button.Click 事件的调用列表中的。我也感到困惑，因为似乎所有内容实际上都指向具有委托和事件的其他内容，并且引用变得复杂。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:25:14.507

您可以将事件视为代表*集合*的包装器（带有一些用于添加/删除成员的语法糖）。事件处理对多个委托的多播调用，您可以添加自定义逻辑以允许（或不允许）添加委托（与您可以将字段包装在属性中并在属性的 getter / setter 上添加一些逻辑的方式相同）。在一个类中拥有一个事件向世界“宣传”他们可以安全地添加处理程序（作为委托实现）来接收所述事件 - 并且允许诸如与 Visual Studio 等 IDE 的设计时集成之类的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:35:54.410

当您在事件的上下文中使用委托时，编译器将为委托生成一个提供支持字段和一个添加/删除公共属性供订阅者附加到事件。您可以将委托用作您描述的事件，但是您将无法将订阅者限制为仅 += 和 -=

```
private EventHandler _backingDelegate;
public event EventHandler Click {
   add {
         _backingDelegate += value;
   } 
   remove {
         _backingDelegate -= value;
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-19T22:59:39.880

可能这个答案会对你有所帮助。他已经详细解释了：-

[活动](https://stackoverflow.com/questions/213638/how-do-c-sharp-events-work-behind-the-scenes)

# actionscript-3 - AS3 删除动态创建的子影片剪辑

> ID：10644746
> 
> 赞同：0
> 
> 时间：2012-05-17T23:18:15.510
> 
> 标签：actionscript-3, actionscript, movieclip, removechild

我对AS3相当陌生。无论如何，我尝试在单击时删除动态创建的子影片剪辑。当点击一个污垢块时，这是一个“世界”的子影片剪辑，我想将其删除。

我尝试了各种使用 removeChild 删除它的方法。我还尝试将函数移动到创建影片剪辑的 for 循环的内部/外部。

```
var blockCount:Number = 0;
var blockArray:Array = [];

var world:MovieClip = new World();
world.x = 50;
world.y = 50;
world.name = "world";
addChild(world);

for(var i:Number=1;i<=100;i++){
    blockCount++;
    var tempGrassBlock:MovieClip = new GrassBlock();
    tempGrassBlock.x = i*16;
    tempGrassBlock.y = 256;
    tempGrassBlock.name = "b"+blockCount;
    world.addChild(tempGrassBlock);

    tempGrassBlock.addEventListener(MouseEvent.CLICK, removeBlock);
    function removeBlock(event:Event){
        world.removeChild(getChildByName(event.target.name));
    }
} 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:23:38.600

试试这个

```
function removeBlock(event:Event){
    world.removeChild(event.currentTarget as DisplayObject);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T00:36:20.923

任何函数定义都不应该在 for 中。我在你的代码中改变了它，并在下面重写了一点：

```
var blockCount:Number = 0;
var blockArray:Array = [];

var world:MovieClip = new World();
world.x = 50;
world.y = 50;
world.name = "world";
addChild(world);

for(var i:Number=1;i<=100;i++){
    blockCount++;
    var tempGrassBlock:MovieClip = new GrassBlock();
    tempGrassBlock.x = i*16;
    tempGrassBlock.y = 256;
    tempGrassBlock.name = "b"+blockCount;
    world.addChild(tempGrassBlock);

    tempGrassBlock.addEventListener(MouseEvent.CLICK, removeBlock);

}

function removeBlock(event:MouseEvent){
    trace("Is click really working? This target name is " + event.currentTarget.name);
    world.removeChild(event.currentTarget));
} 
```

# windows-phone-7 - 数据绑定：在 XDocument 查询中使用来自 XML 的逗号分隔值列表

> ID：10644747
> 
> 赞同：1
> 
> 时间：2012-05-17T23:18:15.510
> 
> 标签：windows-phone-7

对不起，如果这是一个愚蠢的问题，但我是 WP7 开发的新手（以及一般的 C#）。

我有一个如下所示的 XML 文件：

``<sessions>``

 ``<session id="305">`

`<startdatetime>2012-09-12 09:30:00</startdatetime>`

`<enddatetime>2012-09-12 10:30:00</enddatetime>`

`<name>TEST</name>`

`<description>[text]</description>`

`<venueID>19</venueID>`

`<speakerID>1764,2077,2361</speakerID>`

`</session>`

`<session> ... </session>`

`<session> ... </session>`

etc.`

`</sessions>`` 

`稍后在 XML 中有用于场地和扬声器的节点，我可以使用`

 ```var venuedata = from query in loadedData.Descendants("venues").Descendants("venue")``

 ``where query.Attribute("id").Value == session.venueID`

`select new Venue`

`{`

`[stuff]`

`};`

`[etc]``  `但是，在这种情况下，当 XML 包含一个逗号分隔的列表时，我该如何做同样的事情呢？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:25:54.247

使用 string.Split 提取逗号分隔值：http: [//msdn.microsoft.com/en-us/library/system.string.split.aspx](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)

```
select new Venue
{
    Speakers = query.Element("speakerID").Value.Split(',').ToList(),
    [stuff]
}; 
`````

# python - 在python中“四舍五入”负指数

> ID：10644753
> 
> 赞同：3
> 
> 时间：2012-05-17T23:19:18.260
> 
> 标签：python, formatting, floating-point

我希望将一些小数字转换为简单易读的输出。这是我的方法，但我想知道是否有更简单的方法。

```
x = 8.54768039530728989343156856E-58
y = str(x)
print "{0}.e{1}".format(y.split(".")[0], y.split("e")[1])
8.e-58 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-17T23:26:39.897

这让您非常接近，您是否确实需要`8.e-58`或者您只是想将其缩短为可读的内容？

```
>>> x = 8.54768039530728989343156856E-58
>>> print "{0:.1e}".format(x)
8.5e-58 
```

替代：

```
>>> print "{0:.0e}".format(x)
9e-58 
```

请注意，在 Python 2.7 或 3.1+ 上，您可以省略表示位置的第一个零，因此它类似于`"{:.1e}".format(x)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-17T23:27:40.960

像这样？

```
>>> x = 8.54768039530728989343156856E-58
>>> "{:.1e}".format(x)
'8.5e-58' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T23:31:46.693

另一种方法是，如果您想在不进行字符串操作的情况下提取指数。

```
def frexp_10(decimal):
   logdecimal = math.log10(decimal)
   return 10 ** (logdecimal - int(logdecimal)), int(logdecimal)

>>> frexp_10(x)
(0.85476803953073244, -57) 
```

格式如你所愿...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T01:42:09.933

答案有两种：一种是使用数字，一种是简单显示。

对于实际数字：

```
>>> round(3.1415,2)
3.14
>>> round(1.2345678e-10, 12)
1.23e-10 
```

内置的*round()*函数会将数字四舍五入到任意小数位。您可以使用它来截断读数中的无关紧要的数字。

对于显示器，您使用哪个版本的显示器很重要。在 Python 2.x 中，在 3.x 中已弃用，您可以使用“e”格式化程序。

```
>>> print "%6.2e" % 1.2345678e-10
1.23e-10 
```

或在 3.x 中，使用：

```
>>> print("{:12.2e}".format(3.1415))
    3.14e+00
>>> print("{:12.2e}".format(1.23456789e-10))
    1.23e-10 
```

或者，如果您喜欢零：

```
>>> print("{:18.14f}".format(1.23456789e-10))
  0.00000000012346 
```

# c++ - 将枚举值传递给 int 参数是非标准的吗？

> ID：10644754
> 
> 赞同：1
> 
> 时间：2012-05-17T23:19:18.993
> 
> 标签：c++

例子：

```
enum SomeEnum
{
   DD,
   PP,
   NN
};

void someFunc(int a)
{
}

int main()
{
  SomeEnum e = DD;
   someFunc(a) // calls someFunc with value 0
  return 0;
} 
```

这适用于 MSVC，但它是非标准的吗？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-17T23:28:25.120

An`enum`具有基础整数类型（用于存储 的值的类型`enum`），并且该`enum`值可以隐式转换为该整数类型的值。

在您的情况下，基础类型为`int`，值为 0。一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T00:32:50.563

It's absolutely valid because, as GManNickG and tomato said, all enums are of type int (in fact, in C, enums ARE ints and you can assign them values outside the scope of the enum.

```
typedef enum _foo
{
   val1 = 57
} foo;
...
foo f = 99; // compiles in C but not C++ 
```

In fact, most compilers won't complain if the function argument type was bool or float or some other primitive number type because enums act as constant integer values like 0, -1, 200, etc...

What I'd say though, is that, if you have control over someFunc's signature and you want to ensure in C++ that no invalid values are passed in, change it to be

```
void someFunc(SomeEnum a); 
```

for more typesafety

Also, always initialize your first enum value at least. I may be wrong on this but, back in the day, the compiler was allowed to pick an arbitrary starting value for your enum. Most of the time it picked 0 but not always. Even if that's not the case, it makes the code a little more self documenting and obvious.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:38:03.100

枚举器列表中的标识符被声明为具有 int 类型的常量，并且可以出现在任何允许的地方。

6.7.2.2 这里[http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)

# permutation - 找到选择项目的总方法，使得没有两个是连续的

> ID：10644755
> 
> 赞同：3
> 
> 时间：2012-05-17T23:19:46.650
> 
> 标签：permutation, combinatorics

一行中有 n 个项目。我们必须在不能选择两个连续项目的限制下找到可以选择项目的方式的数量。

我试图用递归关系来做，但无法达到任何。请帮我解决问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T18:14:21.327

在网上搜索后，我得到了上述问题的解决方案。

假设有 N 个项目。如果 N 是偶数，我们可以选择几乎 N/2 个项目，使得没有两个是连续的，如果 N 是奇数，我们可以选择几乎 (N+1)/2 个项目。设 K 是可以选择的最大项目数。

我们可以选择 1 到 K 个项目。

*   为了选择一个项目，我们可以选择任何项目。
*   为了选择两个项目，我们将 N-2 个项目保持在一个序列中。下面的圆圈代表序列中的项目。从第一项的左侧到最后一项的右侧，我们总共有 N-1 个空格。空格由“_”下划线表示。如果我们选择任意空格中的两个，并将它们替换为 item，那么我们将有 N 个 item，并且选择的两个 item 不会是连续的，因为没有两个空格是连续的。

    ```
     _ o _ o _ o _ o _ o _ o _ o _ o _ o _ o _ 
    ```

*   为了选择 p 个项目，我们将在序列中保留 Np 个项目，这将产生 N-p+1 个空间。我们可以从这些 N-p+1 个空间中选择任何 p 个空间。

因此，所有可能的方式将变为
^N C [1] + ^(N-1) C [2] + ^(N-2) C [3] + ... + ^(N-K+1) C [K]这是前 N 个斐波那契数的总和 (1,1,2,3, 5，...）。
前 N 个斐波那契数的总和也是 F(n+2) - 1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-20T16:30:04.767

似乎很难理解您解释为什么它是斐波那契数列的方式。我有一种更简单的解释方式，如下所示。假设我们将 n 个项目的组合数表示为 T(n)。如果我们不选择第一项，则组合数与剩余 n-1 项的组合数相同，即 T(n-1)。如果我们选择第一个项目（我们不能选择第二个项目，因为它与第一个位置连续），那么组合的数量与剩余 n-2 个项目的组合数量相同，即 T(n-2)。因此得出以下结论。

```
T(n) = T(n-1) + T(n-2).
T(1) = 2 (1\. selected and 2\. not selected)
T(2) = 3 (1\. both not selected, 2\. only first selected, 3\. only second selected) 
```

这是一个斐波那契数列，可以以 O(n) 时间复杂度计算。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T12:04:55.023

它是一个简单的解决方案。

假设您需要从前 100 个自然数中选择 3 个数字，这样没有两个数字是连续的。

考虑前 98 个自然数，并随机选择 3 个自然数（**a**、**b**、**c**）`98C3`。

我们知道`0 < a`, `b`,`c < 99` 和`|a-b|`, `|b-c|`, `|a-c| >= 1`（因为**a** , **b** , **c**是不同的 ）。

让`A=a+0`; `B=b+1`; `C=c+2`;

**所以我们现在知道A**、**B**和**C**中任意两个之间的差大于 1（即**A**、**B**和**C**不能是连续数字）。

和`0 < A`, `B`, `C<101`. **A**、**B**和**C**满足所需问题的所有条件。

所以解决方案是`98 C 3`。

**泛化**→从**N中选择****p**个项目，使得没有两个是连续的。**`(N-p-1) C p`**

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T08:43:05.677

我认为您可以通过构建一个长度为 n 的数组来做到这一点，数组上的每个位置表示如果该位置是第一个被选择的位置，则可以选择项目的方式数。（从左到右选择。）

伪代码（未经测试）：

```
int[] list = new int[n];
int total = 0;

for(int position = n-1; position >= 0; position--)
{
    list[position] = 1;
    for(int subPos = position + 2; subPos < n; subPos++)
    {
        list[position] += list[subPos];
    }
    total += list[position];
} 
```

解释：

完成运行时的值`list[i]`表示从行中挑选项目的方式数，其中项目 i 是最左边被挑选的项目。

显然，只有一种挑选物品的方法，最右边的物品是最左边的物品。如果 n = 5，则在这种情况下可以像这样表示采摘：`00001`

同样，对于第二个最右边的项目，只有一种方法可以选择最左边的项目：`00010`.

对于第三个最正确的项目，有一种选择方法，您只选择该项目，然后您必须添加选择每个可能第二次选择的项目的方式的数量（这是第二个循环的目的）。因此该项目将具有：`00100`和`00101`。

最右边的第四项：`01000`, `01010`, `01001`.

最右边的第一项（左边的第一项）：`10000`, `10100`, `10101`, `10010`, `10001`.

所以 n=5 的数组最终会得到这些值：`{5,3,2,1,1}`

那么总数将是：5 + 3 + 2 + 1 + 1 = 12

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-23T10:00:29.827

答案) (n+1-r)C r

假设我们有 n 个项目。我们要选择或选择 r 个项目，确保没有连续选择两个对象。我们要**代表**带有“0”的对象。所以现在我们有一个序列 00000000.......0000 {upto n terms} 现在，当我们从第 i 个位置 i={1,......,n} 中选择一个项目时，让我们将其表示为 1。因此，如果我们从位置 2 中选择一项，则新序列变为 01000000....000 {最多 n 个项}。现在，如果我们必须选择 r 个元素，我们正在设计的二进制序列中将有 r 1 个。但有趣的是，在两个连续的 1 之间，可以有任何自然数的 0。因此，如果我们将 n -r（r 1 也将在那里！）个零放在一起，那么总共有 n-r+1 个间隙（每个零的左侧和右侧）。然后我们必须将 r 1 s 放置到位。我们可以从 n-r+1 个位置中选择 r 1 s 的位置。这可以在 (n+1-r)C r 中完成。希望你能理解。**

# php - 如何以重复格式捕获/隔离文本中的特定子字符串？

> ID：10644756
> 
> 赞同：1
> 
> 时间：2012-05-17T23:19:52.690
> 
> 标签：php, regex, preg-match-all, capture-group

我正在学习正则表达式，但我不确定如何从输出中“取出”特定的东西。

示例 - 我想检索特定 CSS 样式的值。

这是一个简化的示例：

```
$source = 'foo { bar: Something }
           foo { bar: Else }
           foo { bar: Yay }'; 
```

我想在 var_dump 之后输出这个：

```
array(3) {
  [0]=>
  string(9) "Something"
  [1]=>
  string(4) "Else"
  [2]=>
  string(3) "Yay"
} 
```

这是我的正则表达式：

```
preg_match_all("/foo\s*{\s*bar:\s*[A-Za-z]*\s*}/",$source,$matches);

foreach($matches as $example) {
   echo '<pre>';
   var_dump($example);
   echo '</pre>';
   } 
```

我得到：

```
array(3) {
  [0]=>
  string(22) "foo { bar: Something }"
  [1]=>
  string(17) "foo { bar: Else }"
  [2]=>
  string(16) "foo { bar: Yay }"
} 
```

如何限制我的输出数据，使其仅显示所需的内容而不是与正则表达式匹配的所有内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:21:51.810

```
preg_match_all("/foo\s*{\s*bar:\s*([A-Za-z]*)\s*}/",$source,$matches);
                                  ^----     ^---- 
```

在这种情况下，括号称为“捕获组”

[http://nz.php.net/manual/en/regexp.reference.subpatterns.php](http://nz.php.net/manual/en/regexp.reference.subpatterns.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-17T23:22:12.627

尝试将您的正则表达式更改为

```
/foo\s*{\s*bar:\s*([A-Za-z]*)\s*}/ 
```

然后再次查看输出。然后，您可能会在输出中看到仅包含您要获取的文本的条目。

通过使用`(`and`)`在正则表达式中创建一个组，preg_match_all 函数也将仅在这些组中输出内容。

## 输出数组

一个例子：

```
$text = 'Here comes a number: 5, here comes a number: 3
          and here comes a number: 4';
preg_match_all( '/[Hh]ere comes a number: ([0-9])/', $text, $matches ); 
```

运行此代码后，`$matches`现在将是：

```
array(
    array( 'Here comes a number: 5', '5' ),
    array( 'Here comes a number: 5', '5' ),
    array( 'Here comes a number: 5', '5' )
) 
```

如您所见，`$matches`将为每个匹配的字符串包含一个数组。第一个条目 ( `$matches[0]`) 将始终包含完整匹配的字符串。其他索引（`$matches[1]`等`$matches[2]`）将仅按顺序包含指定组的值。如果您指定一个可选组（例如`test([0-9])?`），则关联的索引将包含一个`null`值。

## 从输出中排除组

有时您想指定一个组，但不想将其包含在输出数组中。例如：

```
$text = 'Here comes a number: 5, here comes another number: 3
          and here comes a number: 4';
preg_match_all( '/[Hh]ere comes a(nother)? number: ([0-9])/', $text, $matches ); 
```

我添加了一个组，`nother`因为我希望它是可选的。现在 my`$matches[1]`包含`"nother"`or `null`，而 my`$matches[2]`包含实际数字。由于我对用户是选择写*"another"*还是*"a"*不感兴趣，我想从输出中排除这个组。

这可以通过使用 启动组来完成`(?:`。结果代码：

```
$text = 'Here comes a number: 5, here comes a number: 3
           and here comes a number: 4';
preg_match_all( '/[Hh]ere comes a(?:nother)? number: ([0-9])/', $text, $matches ); 
```

该组`(?:nother)`在输出中被忽略，并`$matches[1]`引用我们感兴趣的实际数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T23:21:59.650

在要匹配的区域周围使用括号。

# iphone - charachterAtIndex 最大范围？

> ID：10644768
> 
> 赞同：0
> 
> 时间：2012-05-17T23:21:38.090
> 
> 标签：iphone, objective-c, xcode

我在文本字段中有一些文本，它们以 6 个字符开头，我自己的输入也是 6 个字符长，我使用这段代码让它们成为比较的一部分：

```
unichar aChar1 = [mainTextController.text characterAtIndex:6];
    unichar aChar2 = [mainTextController.text characterAtIndex:7];
    unichar aChar3 = [mainTextController.text characterAtIndex:8];
    unichar aChar4 = [mainTextController.text characterAtIndex:9];
    unichar aChar5 = [mainTextController.text characterAtIndex:10];
    unichar aChar6 = [mainTextController.text characterAtIndex:11]; 
```

现在，当我这样做时，它会暂停我的模拟器，但是当我在 0、1、2、3、4、5 中转动 6、7、8、9、10、11 时，它确实可以工作。怎么会？

（***由于未捕获的异常'NSRangeException'而终止应用程序，原因：'-[__NSCFString characterAtIndex:]：范围或索引超出范围'）有人可以向我解释一下

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:26:34.237

你是说你有一个包含起始值和输入的 12 个字符的字符串连接在一起吗？我强烈怀疑情况并非如此。

使用调试器，在问题的第一行打断并进入`po [mainTextController text]`调试控制台。你会发现字符串没有你期望的那么长。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T23:25:04.237

您正在尝试访问超出 mainTextController.text 中文本字符串范围的字符

您应该在访问该字符之前检查字符串的长度：

```
if([mainTextController.text length] > 12)
{
    unichar aChar6 = [mainTextController.text characterAtIndex:11];
} 
```

# c# - 将重复的列折叠到子列表中

> ID：10644773
> 
> 赞同：2
> 
> 时间：2012-05-17T23:21:58.440
> 
> 标签：c#, database, linq, c#-4.0

将表格数据中的重复列折叠到列表中的最优雅的方法是什么？

示例：我编写了一个 SQL 查询，它返回包含重复数据的行，但单个区分列除外：

```
FIRST   LAST      AGE   CAR
Charles Burns     32    Accord
Charles Burns     32    Buick
Charles Burns     32    Lexus
Anders  Hejlsberg 51    Porsche
Anders  Hejlsberg 51    Ferrari
Anders  Hejlsberg 51    Bugatti
Anders  Hejlsberg 51    Pinto 
```

我使用以下内容阅读了这些内容，然后将它们放入 CarInfo 对象中：

```
while(reader.Read()) {
    first = reader["first"]
    last = reader["last"]
    //...
}
var myData = new CarInfo(first, last, ...); 
```

该对象看起来像：

```
// CarInfo: Need 7 total instances with example data
string first { get; private set; }
string last { get; private set; }
int age { get; private set; }
string car { get; private set; } 
```

我希望它看起来像：

```
// CarInfo: Need only 2 instances with example data; 
string first { get; private set; }
string last { get; private set; }
int age { get; private set; }
List<string> cars { get; private set; } 
```

我当然可以手动执行此操作，例如通过选择形成唯一 ID 的列并检查它们是否已经在我的列表（或字典或其他任何内容）中，但这似乎真的很费力。我只是对 LINQ 足够熟悉，怀疑它可以很好地折叠这些数据，但还不够熟悉，无法想到一个确切的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:36:45.330

您是否尝试过 Enumerable.GroupBy 功能？这是你要找的吗？

```
class A
        {
            public string a;
            public string b;
            public A(string x, string y)
            {
                a = x;
                b = y;
            }
        }
        static void Main(string[] args)
        {
            A[] tab = { new A("1", "1"), new A("2", "0"), new A("3", "1"), new A("4", "0"), new A("5", "1") };
            var g = tab.GroupBy(x => x.b);
            foreach (var x in g)
            {

                foreach (var y in x)
                {
                    Console.WriteLine(y.a + "/" + y.b);
                }
                Console.WriteLine("----");
            }
            Console.ReadKey();

        } 
```

此代码返回：

```
{1,1}
{3,1}
{5,1}
--------
{2,0}
{4,0} 
```

按字段 b 对元素进行分组；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:47:23.510

您可以[加载`DataTable`](http://msdn.microsoft.com/en-us/library/905keexk)并使用[LINQ-To-DataSet](http://msdn.microsoft.com/de-de/library/bb386977.aspx)：

```
List<CarInfo> cars = 
         (from cRow in tblCars.AsEnumerable()
          group cRow by new
          {
              first = cRow.Field<String>("first"),
              last  = cRow.Field<String>("last"),
              age   = cRow.Field<int>("age")
          }into CarGroup
          select new CarInfo() 
          { 
              first = CarGroup.Key.first,
              last  = CarGroup.Key.last,
              age   = CarGroup.Key.age ,
              cars  = CarGroup.Select(cRow => cRow.Field<String>("Car")).ToList()
          }).ToList(); 
```

以上按匿名类型分组，其中三个字段作为键。然后使用这些字段和每组所有汽车`CarInfo`的属性初始化实例。`List<String>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:35:02.030

我昨天刚遇到这个问题，但我使用的是[Dapper](http://code.google.com/p/dapper-dot-net/)，SO 使用的漂亮的对象映射器。它使用“拆分”方法，您必须指定要将父列与子列分开的列或列列表：

```
List<CarInfo> parent = new List<CarInfo>();
CarInfo current = null;
var q = _conn.Query<CarInfo, string, CarInfo>(sql
    , (p, c0) =>
    {
        if (current == null || current.Id != p.Id)
        {
            current = p;
        }
        current.Cars.Add(c0);
        parents.Add(current);
        return current;
    }
    , splitOn: "CAR"
); 
```

# html - 使用 CSS 定位嵌套元素

> ID：10644778
> 
> 赞同：23
> 
> 时间：2012-05-17T23:22:14.860
> 
> 标签：html, css, css-selectors

假设我有一些深度嵌套的标记，我想用 CSS 作为目标。它可以是任何东西，但例如：

```
<div>
    <div id='someid'>
        <span class='someclass'>
            <a class='link' href='alink'>Go somewhere</a>
        </span>
    </div>
<div> 
```

`<a>`像这样直接针对标签编写 CSS 规则是否可以接受？

```
a.link { font-size: large; } 
```

或者这是否被认为是非标准的，在某些浏览器中可能会失败？我是否需要像这样定位链中的每个元素？

```
div div span.someclass a.link { font-size: large; } 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-17T23:30:55.757

两者都完全可以使用，答案取决于您的具体解决方案。例如，如果您在其他区域共享由该类定义的公共属性，您希望尽可能保持其通用性。例如，如果您有一个导航并且该区域中的链接共享一些常见元素，这些元素可以由`a.link`

然后在您的嵌套 html 中，您可能会执行类似的操作

`.someclass a.link {font-size:8px}`使该文本更小。

这是一篇讨论特异性如何工作的文章：http: [//coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T00:04:09.393

两者都是完全有效的，你使用哪一个取决于你想做什么。

如果您正在创建一个希望能够在整个站点中使用的通用类，而不管元素和元素*在哪里*，您应该*只*使用`.class`. 一个很好的例子就是`.icon`你可能想在链接、列表项、标题等上使用的东西。你希望能够在*任何地方*使用它们。

如果您正在创建一个特定于/仅适用于某个特定类型元素的类，那么最好也使用选择器中的元素。这方面的一个例子是你想在一行上显示的项目符号列表，因为这个类要求 HTML 是`<ul>`你应该在 CSS 中指定它；`ul.inline`. 这样，您也可以将“内联”类名用于其他元素，而不会影响两者的样式。

如果您仅使用该类来选择元素，但它不应该具有任何通用样式，那么您应该是特定的。例如，您可能希望元素中的第一段`#blog-post`更大，那么您应该指定两者`#blog-post` *和*类；（请注意，由于 等高级选择器，`#blog-post p.first`这些类型的类不再需要）。`:first-of-type``h2 + p`

说“`.link`最好，`a.link`次之，长选择器不好”是错误的。这一切都取决于情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-17T23:24:09.877

你的 CSS 越有针对性，它变得越不灵活。这是你自己的权衡。如果你要给链接一个特定的类，我很确定无论它们出现在这棵树内部还是外部，它们在视觉上都是相同的，所以你可以坚持你的第一个例子。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-17T23:45:17.427

实际上建议使用它`a.link`而不是长而丑陋的第二个选项，这可能会导致特异性和性能问题。

如果你使用 just 会更好`.link`。那是最好的选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-17T23:30:04.943

a.link 是最好的方法。如果您希望某个 a.link 与其他链接不同，则需要为其添加一些权重。

```
a.link { ... } /* Global */
span.someclass a.link { ... } /* Finds all a.link within span.someclass */ 
```

后代选择器（第 2 行）不是向元素添加样式的最有效方式，因此请谨慎使用它们。就个人而言，当我需要为某个 ID/类中的全局类赋予特殊样式时，我会使用它们。

# android - 查找 android facebook 应用程序的哈希键

> ID：10644781
> 
> 赞同：1
> 
> 时间：2012-05-17T23:22:33.033
> 
> 标签：android, facebook, keytool

我有一个使用 eclipse 导出生成的证书。

如何从 facebook 哈希键的证书中找到哈希键？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T02:11:52.197

如果我了解您需要使用发布证书生成密钥哈希，请尝试以下操作：

keytool -exportcert -keystore (你的发行证书目录) | openssl sha1 -二进制 | openssl base64

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T23:27:34.147

[将您的应用签名添加到 Facebook 应用设置](https://developers.facebook.com/docs/mobile/android/build/#sig)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T16:11:58.407

如果您在 Facebook 上未设置哈希键就运行您的应用程序，日志中的错误消息将显示所需的哈希键。

# regex - 如何使用 stringr 和 regexp 从字符串末尾删除空格和数字？

> ID：10644784
> 
> 赞同：2
> 
> 时间：2012-05-17T23:22:45.110
> 
> 标签：regex, r

我需要编写一个`R`我无法弄清楚的基本正则表达式。我要做的是从数据中删除数字和空格，以便“Flagstaff 24”变成“Flagstaff”。

```
library(stringr)

data <- c("Flagstaff 24",  "Los Angeles 23", "Cleveland 29", "Cleveland 29",  "Seattle 22") 
```

但是，由于我的数字是一位数或两位数，我不能只修剪结尾。我尝试过的是以下不起作用的表达式：

```
str_split_fixed(data, ".\\d", 1) 
```

我正试图围绕这些表达结构思考！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T23:26:45.333

你可以用`gsub()`这个。（不需要`stringr`包裹。）

```
gsub("\\s*\\d*$", "", data)
[1] "Flagstaff"   "Los Angeles" "Cleveland"   "Cleveland"   "Seattle" 
```

# c# - 列的 C# DataGridView 日期时间格式

> ID：10644788
> 
> 赞同：3
> 
> 时间：2012-05-17T23:23:06.683
> 
> 标签：c#, .net, winforms

我有从数据库中填充数据的datagridview，有些列中我有日期和时间“MMddyyyy”和“hhmmss”格式，我想要做的是当datagridview加载时，我想将此格式更改为其他格式比如说，dd-MM-yy 代表日期和时间 hh-mm-ss。我想知道是否有人可以指导我如何做到这一点。我无法通过 gridview.columns[x].defaultcellstyle.format="dd-MM-yy" 执行此操作，但我没有收到任何错误，但 gridview 上没有任何更改...

谢谢

注意：我也没有选择更改数据库中的列长度..:-( 没有语法问题

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-17T23:28:40.063

Microsoft 建议您拦截 CellFormatting 事件（其中 DATED 是您要重新格式化的列）：

```
private void dataGridView1_CellFormatting(object sender, DataGridViewCellFormattingEventArgs e)
{
    // If the column is the DATED column, check the
    // value.
    if (this.dataGridView1.Columns[e.ColumnIndex].Name == "DATED")
    {
        ShortFormDateFormat(e);
    }
}

private static void ShortFormDateFormat(DataGridViewCellFormattingEventArgs formatting)
{
    if (formatting.Value != null)
    {
        try
        {
            DateTime theDate = DateTime.Parse(formatting.Value.ToString());
            String dateString = theDate.ToString("dd-MM-yy");    
            formatting.Value = dateString;
            formatting.FormattingApplied = true;
        }
        catch (FormatException)
        {
            // Set to false in case there are other handlers interested trying to
            // format this DataGridViewCellFormattingEventArgs instance.
            formatting.FormattingApplied = false;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-27T14:53:59.927

DataGridView 格式中的 sintax 与 DateTime 中的略有不同，但您可以获得相同的结果。在我的示例中，我有一个时间列，默认情况下显示 HH:mm:ss，我只想显示小时和分钟：

```
 yourDataGridView.Columns["Time"].DefaultCellStyle.Format = @"hh\:mm"; 
```

# actionscript-3 - Flex UI 组件消失

> ID：10644795
> 
> 赞同：0
> 
> 时间：2012-05-17T23:24:09.283
> 
> 标签：actionscript-3, apache-flex, button

我已经实现了一种更改显示大小的方法。

当我单击最大化时，我会重新定位视图堆栈中的一些按钮。问题是当我恢复视图时按钮消失了。

有人能帮我吗？

```
{       
    nativeWindow.addEventListener(NativeWindowBoundsEvent.RESIZING, onAppResize);

    nativeWindow.addEventListener(NativeWindowBoundsEvent.RESIZE, onAppResize);

    nativeWindow.addEventListener(NativeWindowDisplayStateEvent.DISPLAY_STATE_CHANGING,onAppMaximized);

    var screenBounds:Rectangle = Screen.mainScreen.bounds;
    nativeWindow.x = 10;
    nativeWindow.y = 10;    
}

private function onAppMaximized(e:NativeWindowDisplayStateEvent):void
{

    if(String(e.afterDisplayState) == "maximized" && DisplayMaximized == false)
    {
        e.preventDefault();

        nativeWindow.x = 10;
        nativeWindow.y = 10;

        AppImageWidth = 1280;
        AppImageHeight = 900;

        nativeWindow.width = 1280;
        nativeWindow.height = 900;

        viewstack.createComponentsFromDescriptors(true);

        viewstackBuchungen.width = 1206;
        viewstackBuchungen.height = 600;

        Button.x = 1135;
        Button.y = 608;

        Button2.x = 1135;
        Button2.y = 608;

        DisplayMaximized = true;
    }
    else if(String(e.afterDisplayState) == "maximized" && DisplayMaximized == true)
    {
        e.preventDefault();

        AppImageWidth = 1024;
        AppImageHeight = 600;

        nativeWindow.width = 1024;
        nativeWindow.height = 600;

        viewstackBuchungen.width = 950;
        viewstackBuchungen.height = 313;

        Button.x = 879;
        Button.y = 321;

        Button2.x = 879;
        Button2.y = 321;

        DisplayMaximized = false;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T12:43:34.953

感谢您的回答。我尝试使用 .move(x,y) 移动它们。没有改变...

这些按钮位于相同的位置，因为它们位于不同的导航器内容中。

```
<
```

s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark" xmlns:mx="library:// ns.adobe.com/flex/mx" creationComplete="init();" 宽度=“1024”高度=“600”>

```
 private function init():void
        {
            nativeWindow.addEventListener(NativeWindowBoundsEvent.RESIZING, onAppResize);
            nativeWindow.addEventListener(NativeWindowBoundsEvent.RESIZE, onAppResize);

            nativeWindow.addEventListener(NativeWindowDisplayStateEvent.DISPLAY_STATE_CHANGING,onAppMaximized);
            nativeWindow.x = 10;
            nativeWindow.y = 10;
        }
        private function onAppResize(e:NativeWindowBoundsEvent):void
        {
            e.preventDefault();
        }
        private function onAppMaximized(e:NativeWindowDisplayStateEvent):void
        {
            if(String(e.afterDisplayState) == "maximized" && DisplayMaximized == false)
            {
                e.preventDefault();

                nativeWindow.x = 10;
                nativeWindow.y = 10;

                nativeWindow.width = 1280;
                nativeWindow.height = 900;

                viewstack1.createComponentsFromDescriptors(true);

                viewstack1.width = 1206;
                viewstack1.height = 600;

                button1.move(1135,608);

                button2.move(1135,608);

                DD1.move(1082,608);

                DisplayMaximized = true;
            }
            else if(String(e.afterDisplayState) == "maximized" && DisplayMaximized == true)
            {
                e.preventDefault();

                nativeWindow.width = 1024;
                nativeWindow.height = 600;

                viewstack1.width = 950;
                viewstack1.height = 313;

                button1.move(879,321);

                button2.move(879,321);

                DD1.move(826,321);

                DisplayMaximized = false;
            }
        }
    ]]>
</fx:Script>
<fx:Declarations>
    <!-- Platzieren Sie nichtvisuelle Elemente (z. B. Dienste, Wertobjekte) hier -->
</fx:Declarations>

<s:Group x="16" y="113" width="1254" height="463">
    <mx:ViewStack id="viewstack1" x="0" y="24" width="950" height="313" selectedIndex="0" creationPolicy="all">
        <s:NavigatorContent width="100%" height="100%" label="Nav1" id="nav1" creationPolicy="all">
            <mx:AdvancedDataGrid id="grid1" x="0" y="0" width="100%" height="100%"
                                 designViewDataType="flat"
                                 editable="true" horizontalScrollPolicy="off"
                                 sortableColumns="false" resizableColumns="false" draggableColumns="false">
                <mx:columns>
                    <mx:AdvancedDataGridColumn dataField="test1" headerText="test1" width="35"/>
                </mx:columns>
            </mx:AdvancedDataGrid>
            <s:Button x="879" y="321" label="Button1" id="button1"/>
        </s:NavigatorContent>
        <s:NavigatorContent width="100%" height="100%" label="Nav2" id="nav2" creationPolicy="all">
            <mx:AdvancedDataGrid id="grid2" x="0" y="0" width="100%" height="100%"
                                 designViewDataType="flat"
                                 editable="true" horizontalScrollPolicy="off"
                                 sortableColumns="false" resizableColumns="false" draggableColumns="false">
                <mx:columns>
                    <mx:AdvancedDataGridColumn dataField="test2" headerText="test2" width="35"/>
                </mx:columns>
            </mx:AdvancedDataGrid>
            <s:Button x="879" y="321" label="Button2" id="button2" />
        </s:NavigatorContent>
        <s:NavigatorContent width="100%" height="100%" label="Nav3"  id="nav3" creationPolicy="all">
            <mx:AdvancedDataGrid id="grid3" x="0" y="0" width="100%" height="100%"
                         designViewDataType="flat"
                         editable="true" horizontalScrollPolicy="off"
                         sortableColumns="false" resizableColumns="false" draggableColumns="false">
                <mx:columns>
                    <mx:AdvancedDataGridColumn dataField="test3" headerText="test3" width="35"/>
                </mx:columns>
            </mx:AdvancedDataGrid>
            <s:DropDownList x="826" id="DD1" y="321" width="125" prompt="DD1" alpha="1"/>
        </s:NavigatorContent>
    </mx:ViewStack>
    <s:TabBar x="0" y="0" dataProvider="{viewstack1}" />
</s:Group> 
```

# datatable - 谷歌可视化——你能在同一张地图上编码美国省级数据和一些城市地块吗？

> ID：10644798
> 
> 赞同：0
> 
> 时间：2012-05-17T23:24:29.983
> 
> 标签：datatable, city, google-visualization

我正在构建一个谷歌可视化数据表。在这里你可以看到它：

[http://jsfiddle.net/MmyKU/4/](http://jsfiddle.net/MmyKU/4/)

我已经建立了我的美国颜色编码，但我需要在颜色编码之上添加大约 8 个美国城市的图。我在网上找不到任何文档或其他示例来说明是否/如何做到这一点。我试了几次都没有结果。

我只是想：

1）验证是否可能？

2) 找到一个工作示例或帮助将第二个表添加到单个 drawVisualization 实例！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T08:04:42.403

[https://developers.google.com/chart/interactive/docs/gallery/geochart#Configuration_Options](https://developers.google.com/chart/interactive/docs/gallery/geochart#Configuration_Options)

添加到您的选项

```
displayMode: 'markers', 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T10:44:40.497

区域和标记不会同时工作。所以如果你想为状态的背景着色，使用标记模式，你可以用 CSS 来完成。

我正在为我在这里开发的 Wordpress 插件记录一些示例：http: [//cmoreira.net/interactive-world-maps-demo/advanced-customization/](http://cmoreira.net/interactive-world-maps-demo/advanced-customization/)

检查最后一个例子。这并不容易，因为您必须找到要着色的子路径编号，然后才能做到。例子：

```
#visualization path:nth-child(5) {
fill:#cccccc;
} 
```

这是一个带有上述 CSS 的代码的分叉示例：http: [//jsfiddle.net/cmoreira/Jqkjg/](http://jsfiddle.net/cmoreira/Jqkjg/)

希望能帮助到你！

# javascript - Javascript变量有时未定义

> ID：10644802
> 
> 赞同：1
> 
> 时间：2012-05-17T23:25:02.247
> 
> 标签：javascript, html

我知道这个问题已经被问过好几次了，但在之前的任何问题中，我似乎都找不到适合我的解决方案。我有一个在我的 HTML 页面加载完成时设置的变量，但有时当我的代码尝试访问该变量时，它说它是未定义的。我不知道为什么，因为我相信我正在等待一切正常加载。这个异常似乎是随机发生的，因为大多数时候所有代码都运行良好。这是我的代码的简化版本：

```
var globalVar;

function initStuff(filePath) {
    // I wait till the HTML page is fully loaded before doing anything
    $(document).ready(function(){
        var video = document.getElementById("videoElementID");

        // My parseFile() function seems to run smoothly
        var arrayOfStuff = parseFile(filePath); 

        if (arrayOfStuff == null) {
            console.error("Unable to properly parse the file.");
        } else {
            setGlobalVariable(arrayOfStuff);
            video.addEventListener("play", updateVideoFrame, false);
        }
    });
}

function setGlobalVariable(arrayOfStuff) {
    window.globalVar = arrayOfStuff;
}

function updateVideoFrame() {
    // A bunch of other code happens first

    // This is the line that fails occasionally, saying 
    // "window.globalVar[0].aProperty.anArray[0] is undefined"
    var test = window.globalVar[0].aProperty.anArray[0].aProperty;
} 
```

我能想到的唯一可能导致此问题的是某种同步问题。不过，我不明白为什么会这样。请帮忙！

## 编辑：

如果异步问题来自我的`parseFile(xmlFile)`方法，这就是我在那里做的事情。我认为这不可能导致问题，因为我强制该方法同步发生，但万一我错了，这里是：

```
function parseKML(xmlFile) {
    var arrayOfStuff = new Array();

    // Turn the AJAX asynchronicity off for the following GET command
    $.ajaxSetup( { async : false } );
    // Open the XML file
    $.get(xmlFile, {}, function(xml) {
        var doc = $("Document", xml);   
        // Code for parsing the XML file is here
        // arrayOfStuff() gets populated here
    });

    // Once I'm done processing the XML file, I turn asynchronicity back on, since that is AJAX's default state
    $.ajaxSetup( { async : true } );

    return arrayOfStuff;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:39:20.740

您应该在代码中做的第一件事是弄清楚以下部分的哪一部分：

```
window.globalVar[0].aProperty.anArray[0] 
```

未定义。

由于您有多个链式属性引用和数组引用，因此链中可能有许多不同的位置。我建议要么在您的参考之前设置一个断点，它会检​​查其中的内容，或者使用几个`console.log()`语句来输出结构的每个嵌套部分，以便找出您的问题所在。

```
console.log("globalVar = " + globalVar);
console.log("globalVar[0] = " + globalVar[0]);
console.log("globalVar[0].aProperty = " + globalVar[0].aProperty);
console.log("globalVar[0].aProperty.anArray = " + globalVar[0].aProperty.anArray);
console.log("globalVar[0].aProperty.anArray[0] = " + globalVar[0].aProperty.anArray[0]); 
```

如果问题是`globalVar`尚未设置，那么您有时间问题或初始化问题。

如果问题是未设置其他属性之一，那么您没有使用您认为的初始化 globalVar。

您可能还希望编写代码更具防御性，以便在您的某些数据设置不正确时优雅地失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:36:51.913

您需要使用防御性编程。 [http://www.javascriptref.com/pdf/ch23_ed2.pdf](http://www.javascriptref.com/pdf/ch23_ed2.pdf)

例子：

```
var video = document.getElementById("videoElementID") || 0; 
```

-

```
if( video && video.addEventListener ){
    video.addEventListener("play", updateVideoFrame, false);
} 
```

这是您的代码的另一个版本。

```
window.globalVar = globalVar || [];
function setGlobalVariable(arrayOfStuff) {
    window.globalVar = arrayOfStuff;
}
function updateVideoFrame() {
    // A bunch of other code happens first

    // This is the line that fails occasionally, saying
    // "window.globalVar[0].aProperty.anArray[0] is undefined"
    if( window.globalVar ){
        var g = window.globalVar || [];
        var d = (g[0] || {})["aProperty"];
        // etc...
    }else{
        console.error( "test error." );
    }

}
function initStuff(filePath) {
    // I wait till the HTML page is fully loaded before doing anything
    $(document).ready(function () {
        var video = $("#videoElementID");

        // My parseFile() function seems to run smoothly
        var arrayOfStuff = parseFile(filePath) || [];

        if (arrayOfStuff == null || video == null ) {
            console.error("Unable to properly parse the file.");
        } else {
            setGlobalVariable(arrayOfStuff);
            video.bind("play", updateVideoFrame);
        }
    });
} 
```

# javascript - 将动态更新推送到 HighCharts

> ID：10644806
> 
> 赞同：2
> 
> 时间：2012-05-17T23:25:23.730
> 
> 标签：javascript, highcharts, highstock

所以我有一个使用 HighCharts 的常规折线图——股票图表。

我想做的只是在后端更新时将更新推送到图表。

我目前可以很容易地推送数据，但我不知道如何让它更新为新记录。

有这个演示：

[http://jsfiddle.net/gh/get/jquery/edge/highslide-software/highcharts.com/tree/master/samples/stock/demo/dynamic-update/](http://jsfiddle.net/gh/get/jquery/edge/highslide-software/highcharts.com/tree/master/samples/stock/demo/dynamic-update/)

但它更新每个间隔 - 我只希望它在数据被推送时更新（即没有指定间隔，只是按日期/时间）

有什么想法可以修改上面的例子来完成这个吗？

# javascript - 仍然有简单的javascript问题

> ID：10644808
> 
> 赞同：0
> 
> 时间：2012-05-17T23:25:44.307
> 
> 标签：javascript, html

```
if (document.getElementById) {

function alterImg() {
    document.body.getElementById('sendimg').src="url('images/tridown.png')";
}

} 
```

然后是html：

```
<div id="sendbutton">
<img id="sendimg" src="images/tri.png" onclick="alterImg()" />
</div> 
```

我也尝试使用 this 关键字引用，但无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:35:15.580

您的代码存在三个问题：

*   您使用的文档*.body* .getElementById。" `getElementById`" 是 的方法，而`document`不是 body 元素。
*   您正在将 css 与 html 混合。在 html 中，您将 url 分配给`src`图像的属性。在 css 中，您用于`url(...)`引用图像，例如用于背景。
*   您在 if 语句中使用函数声明。请注意，这确实在当前范围内声明了函数（我假设是全局的），无论 if 块是否被执行。如果只想在`document.getElementById`可用时定义函数，则需要使用

```
if (document.getElementById) {
    var alterImg = function () {
        document.getElementById('sendimg').src="images/tridown.png";
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:27:09.847

文档。**正文**.getElementById

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:34:09.403

这里有几个问题：

1.  src 属性不需要包裹在 url() 周围
2.  使用**document.getElementById**而不是**document.body.getElementById**

    函数 alterImg() { document.getElementById('sendimg').src = "images/tridown.png"; }

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T23:34:55.587

从 .src="url('images/tridown.png')" 中删除 url('') 语句

以下对我有用：

```
<div id="sendbutton">
<img id="sendimg" src="http://placehold.it/64x64" onclick="alterImg()" />
</div>

<script type="text/javascript">
    if (document.getElementById) {

function alterImg() {
    document.body.getElementById('sendimg').src="http://placehold.it/128x128";
}

}

</script>
​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-17T23:35:31.307

该`getElementById`方法仅在`document`对象上定义，而不是在`document.body`. 此外，该`src`属性不是 CSS 属性，因此不能`url(...)`用作值。你应该简单地写：

```
document.getElementById('sendimg').src = images/tridown.png"; 
```

有关 的更完整描述`HTMLImageElement`，请查看[Mozilla 开发者网络](http://developer.mozilla.org/en/DOM/HTMLImageElement)。

# jquery - 如何使用可排序的 jQuery UI 消除闪烁？

> ID：10644816
> 
> 赞同：3
> 
> 时间：2012-05-17T23:26:48.917
> 
> 标签：jquery, jquery-ui, knockout.js, jquery-ui-sortable, knockout-sortable

我有一个可排序的扑克牌列表。为了只显示卡片的顶部，我为每张卡片设置了一个负的底部边距。一旦我这样做了，jQuery sortable 就会变得非常不稳定并且难以使用。我怎样才能消除这个过滤器？ ~~在闪烁之上，如何获得正确的垂直对齐以进行拖动？似乎我必须在列表的上方或下方移动，才能将占位符移动到列表的两侧。~~

我已将我的代码放在[http://jsfiddle.net/otac0n/wDTwX/](http://jsfiddle.net/otac0n/wDTwX/)以便您可以感受一下，但这里是它的要点：

```
// HTML
<div class="deck" data-bind="sortable: { data: Cards, options: { placeholder: 'card', cursorAt: { left: 5, top: 5 }, tolerance: 'pointer' } }">
    <div class="card" data-bind="text: Name, style: { background: Color }"></div>
</div>

// CSS
.deck
{
    margin: 10px;
    padding: 0 0 130px 0;
}

.card
{
    width: 100px;
    height: 150px;
    border: 1px solid black;
    border-radius: 8px;
    background: White;
    color: White;
    margin: 0 0 -130px 0;
    padding: 5px;
}

// JS
var vm = {
    Cards: ko.observableArray([
        { Name: "Red", Color: "#f00" },
        { Name: "Green", Color: "#0f0" },
        { Name: "Blue", Color: "#00f" },
    ])
};

ko.applyBindings(vm); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T17:58:55.003

我也为闪烁的可排序而苦苦挣扎。请注意，它仅在 2 个条件下闪烁：

1.  有一个`connectWith`选项正在使用
2.  父容器（在我的例子中是`<ul>`标签）有一个高度或其他任何东西，比如`<div style="clear:both">`强制它有一个高度。

另一方面，如果连接的 UL 没有高度，我们实际上不能在其中放置任何东西。但每当 UL 获得高度时，它就会闪烁。所以我只设置了 10px 的高度，它就起作用了。如果这不起作用，请尝试在 UL 的父级上使用 overflow: visible 或 overflow: hidden 。希望能帮助到你。

更新：

如果有超过一行的项目，它将不起作用。我可以通过这样做来修复它：

结束：函数（事件，用户界面）{$（'#my_sortable_list'）.css（'溢出'，'可见'）; }

进而

停止：function() { $('.selector_for_all_sortable_lists').css('overflow', 'hidden'); }

在两个连接列表上

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T00:35:30.187

在我的实际情况中，答案是使用`overflow: visible`而不是负边距来获得重叠效果。

这神奇地使一切正常！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T23:45:33.220

首先，你有一个逃跑的争论。

```
sortable: { data: Cards, 
    options: { placeholder: 'card', cursorAt: { left: 5, top: 5 }, }
    ,tolerance: 'pointer'} 
```

容差应该在选项数组内，因此不会被拾取:) 即。

```
sortable: { 
    data: Cards, 
    options: { 
        placeholder: 'card', 
        cursorAt: { left: 5, top: 5 },
        tolerance: 'pointer'
    }
} 
```

关于闪烁，在我看来，我喜欢它，因为事件正在通过元素（重叠）冒泡。尝试想出一种方法来确保它们只有在它们打算被排序时才会被排序:)

编辑：这个问题看起来很相似：[处理重叠的 jQuery 可排序列表](https://stackoverflow.com/questions/4092817/dealing-with-overlapping-jquery-sortable-lists)

# php - 即使没有人打开网站，我如何保持 php 脚本处于活动状态？

> ID：10644822
> 
> 赞同：0
> 
> 时间：2012-05-17T23:28:02.493
> 
> 标签：php

我有一个项目，我需要这样做

1.  桌面应用程序每 5 秒向 Web 服务器发送一个带有数字的 txt 文件
2.  Web 服务器打开该文件并将号码保存在数据库中

问题是我需要它 24/7 全天候工作，即使用户没有登录。

桌面应用程序已经可以工作了，我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:30:47.740

您应该使用 cron 来执行此操作。这是一篇解释如何在 linux 中设置它们的文章：http: [//kevin.vanzonneveld.net/techblog/article/schedule_tasks_on_linux_using_crontab/](http://kevin.vanzonneveld.net/techblog/article/schedule_tasks_on_linux_using_crontab/)

如果您在 Windows 上运行它： [什么是 Windows 版本的 cron？](https://stackoverflow.com/questions/132971/what-is-the-windows-version-of-cron)

Mac类似于linux： [http ://benr75.com/pages/using_crontab_mac_os_x_unix_linux](http://benr75.com/pages/using_crontab_mac_os_x_unix_linux)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T00:30:53.070

What you're trying to do is not actually a web *server* function, per se, (there isn't a request to serve) you just want to run a PHP script on a pre-determined schedule. To do that, you should run a scheduled job (cron on non-windows, Scheduled Task on Windows).

We use Windows, so here's how you set up a scheduled task for a php script to run when you need it to:

1.  On the web server, from Control Panel, create a new Schedule Task
2.  Set the **Run** value to wherever PHP is installed and the script you want to run:

    "C:\Program Files\Php5\php.exe" C:\webserver\scripts\myphpfile.php

3.  Set the **Start in** to wherever your php file is:

    C:\webserver\scripts\

4.  Set up the rest of the Schedule Task options to your needs.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:30:17.083

使用 Unix Chron 来规划适合您需求的 php 作业

# css - CSS 中的 + 运算符有什么作用

> ID：10644827
> 
> 赞同：0
> 
> 时间：2012-05-17T23:28:59.753
> 
> 标签：css

关于[这里](http://jsfiddle.net/chrisallenaaker/9BzsU/10/)的代码：

小提琴中的单选按钮没有像单选按钮那样起作用。

我不熟悉 CSS 中的 + ，我想知道这是否与它有关。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T23:33:49.327

```
input[type="radio"]:checked+label{ ..... } 
 //a label that immediately follows an input of type radio that is checked 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-17T23:37:24.363

CSS 中的 + 号表示与第一个选择器相邻的选择器。

在您的示例中，+ 号正在修改标签，而不是实际的单选按钮，而只是标签。

现在它不起作用，因为您没有为单选按钮指定组名（或名称），请尝试以下 html。

```
<form>
  <input type="radio" id="radio1" name="rdo">
  <label for="radio1"></label>
  <input type="radio" id="radio2" name="rdo">
  <label for="radio2"></label>
</form>
​ 
```

现在单选按钮绑定到相同的名称并且将正常工作。

干杯，尼科

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-17T23:33:46.550

这会选择相邻的元素，请参阅[你必须记住的 30 个 CSS 选择器](http://net.tutsplus.com/tutorials/html-css-techniques/the-30-css-selectors-you-must-memorize/)。

自由贸易协定：

> 这被称为相邻选择器。它将仅选择紧接在前一个元素之前的元素。在这种情况下，只有每个 ul 之后的第一段会有红色文本。

IE7+ 支持

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-17T23:34:07.453

它匹配紧接在另一个指定元素之前的元素。

`label`在您的示例中，这意味着它`input`匹配`type="radio"`.

此处有关选择器的更多信息：http: [//www.w3.org/TR/CSS2/selector.html](http://www.w3.org/TR/CSS2/selector.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-17T23:33:20.407

如果您指的是单选按钮不是互斥的（您可以选择多个），那是因为 html 没有将单选按钮定义为同一组的一部分。使用 name 属性来实现这一点。

```
<form>
  <input type="radio" name="radioGroup" id="radio1">
  <label for="radio1"></label>
  <input type="radio" name="radioGroup" id="radio2">
  <label for="radio2"></label>
</form>
​ 
```

我相信您关于 CSS 中 + 的问题是不相关的，但它在其他答案中被正确识别为下一个兄弟。

# django - Django - 单一模型实例

> ID：10644829
> 
> 赞同：0
> 
> 时间：2012-05-17T23:29:55.273
> 
> 标签：django, django-models, django-admin

我想将布局模型添加到我的网站（常规设置文件），并且我希望它可以在管理界面中进行配置。

```
class Layout(...Model):
    primary_header
    logo_image
    ... 
```

此结构不应保存在表格中。

我想知道是否有一个内置功能可以帮助我做到这一点。

谢谢

* * *

我的用例是网站的可配置布局。WordPress 风格。我想将该数据存储在一个具体的类中，而不必自己实现文件 /xml 序列化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:43:56.433

抽象模型呢？它不保存在数据库中并且是子类化的，但是您可以创建它的实例并使用它的属性。我假设您希望传递某种满足模型实例要求的临时数据结构。

```
class Layout(models.Model):

    class Meta:
        abstract = True 
```

如果您出于某种原因需要实际的具体模型，并且可以为它们创建表，那么从技术上讲，您还可以重新实现 save() 方法并使其无操作。

我真的不明白你将在哪里以及如何使用它，但这确实是一个无法保存的模型。

就个人而言，我实际上在使用 mongodb 和 nonrel django fork 的项目中使用了不打算保存的模型。我创建的模型纯粹是为了作为嵌套子文档嵌入到其他模型中，我从不希望它们被提交到单独的集合中。

**更新**
这里是另一个建议，它可能会让你的目标变得更容易。为什么不直接使用普通的 django 模型，像往常一样将其保存到数据库中，然后创建一个简单的导入/导出函数将其保存到 XML 或从 XML 读取到实例中。这样您就可以获得 100% 的正常管理功能，您仍然可以查询数据库中的值，并且 XML 部分只是一个简单的附加组件。您还可以使用它来升级首选项并将某个选项标记为活动。

# php - 为什么我的内容不显示？

> ID：10644835
> 
> 赞同：1
> 
> 时间：2012-05-17T23:30:38.173
> 
> 标签：php

它是如何工作的：点击专辑会带你到“album.php?id=#”

```
//initialize some vars
$albumID = '';

//check what photo we are looking for
if(isset($_GET['id'])){
    $albumID = mysql_real_escape_string($_GET['id']); 
```

询问：

```
$sql = mysql_query(
SELECT *
FROM albums
JOIN songs
ON albums.performer=songs.performer
WHERE albums.albumID='albumID'
); 
```

我想要完成的是让它显示专辑和曲目列表。有人知道我应该如何解决这个问题吗？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T23:32:24.460

```
$sql = mysql_query('
SELECT *
FROM albums
JOIN songs
ON albums.performer=songs.performer
WHERE albums.albumID="'.$albumID.'"'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-17T23:47:04.887

您还应该知道，仅`isset()`在传递的变量上使用是模棱两可的，您应该进行特异性检查并始终知道将传递什么类型的值；

如果您只想允许整数、数字或两者的混合：

`if(isset($_GET['id']))`只需检查其设置，这也可能是一个空白值。

`if(!empty($_GET['id']))`这会检查它的集合并且还有一个值

`if(!empty($_GET['id']) && is_numeric($_GET['id']))`以上都是数字。

这个故事的寓意是你永远不应该相信用户输入是正确的类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-17T23:50:24.747

首先将您的查询放在一个字符串中：

```
$query = "SELECT * FROM albums JOIN songs ON albums.performer=songs.performer"; 
```

然后，如果存在专辑，则添加到该查询：

```
if ( !empty( $albumID ) ) {
  $query = $query . " WHERE albums.albumID = $albumID";
} 
```

此时，我们可以继续运行查询：

```
$result = mysql_query( $query ) or die( mysql_error() ); 
```

我们使用 运行查询，`mysql_query`并将其结果传递给`$result`变量。如果出现任何问题，例如查询中的错误，我们的程序将`die`，并且最新的`mysql_error()`将打印到屏幕上。

使用我们的`$result`变量，我们现在可以循环并打印结果：

```
while ( $row = mysql_fetch_object( $result ) ) {
  echo $row->columnA
} 
```

请注意，这`columnA`是一个占位符，您实际上应该在其中写入已存储在数据库中的列名。

# visual-studio-2010 - 如何在 Visual Studio 2010 中停止自动格式化注释？

> ID：10644840
> 
> 赞同：0
> 
> 时间：2012-05-17T23:30:56.877
> 
> 标签：visual-studio-2010, comments

我喜欢缩进我的评论。Visual Studio 2010 删除了我制作的缩进格式。我怎样才能防止这种情况发生？

这是我正在谈论的一个例子。在我编码之前，我评论一下。当事情变得错综复杂时，它可以帮助我记住我想去的地方。因此，如果我要编写实验室外套，我会为该部分编写注释，如下所示：

```
//Make lab coat
    //Add pockets
        //Add pen to top pocket
    //Add buttons
    //Add Name Tag
        //Put Name On Name Tag 
```

然后我会返回并填写注释部分的代码。这只是格式化的一个例子，让我们不要进入实验室外套实现的语义。

但是，在 Visual Studio 2010 中，如果我开始添加一些代码，自动格式化程序将删除所有注释的缩进。我尝试查看编辑器选项，但无法确定这种情况下是否存在该设置。

## 如何防止 Visual Studio 2010 删除这些缩进？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:33:34.207

您是否考虑过在双斜杠后添加缩进？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T00:02:33.337

我有这个解决方法，但我希望有一个更合法的方法来完成这个。

```
//Build lab coat
{
    //Add Pockets
    {
        //Add pen to top pocket

    }
    //Add Buttons
    {

    }
    //Add Name Tag
    {
        //Add name to name tag
    } 
} 
```

# css - 想要稍微重叠的并排 Divs

> ID：10644845
> 
> 赞同：1
> 
> 时间：2012-05-17T23:31:52.587
> 
> 标签：css, html

我环顾四周并没有设法找出如何做到这一点，即使它*应该*相对容易。我有一个页面我想横向滚动，分成两半，两者都适合窗口大小。这部分很简单，但是我想做的是让右侧 div（在页面加载时隐藏）稍微突出左侧 div 40px 左右 - 这样你就可以看到边缘它。

这是它的基础 - [jsFiddle](http://jsfiddle.net/NUWqE/)

我希望这个问题是有道理的。`position:absolute;`到目前为止，我已经尝试了一堆组合，但没有任何乐趣。任何帮助都是极好的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:50:01.663

如果我对您的理解正确，您希望右手 div 可以“窥视”左手 div 的边缘，这样即使它在视口之外，用户也可以发现它。

最简单的方法是在元素上设置一个位置：相对，然后设置一个左值-40px。这将使元素“窥视”。见这里：http: [//jsfiddle.net/NUWqE/1/](http://jsfiddle.net/NUWqE/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T10:21:02.040

我可能完全误解了您要查找的内容，但是以下内容是否可以解决您的问题，而不必将 div 与`left`. 这样就不会混合像素和 %，并且您不必解决`#right`.

```
#wrapper {
    width: 200%;
    position:relative;
}

#left {
    width: 45%;
    float: left;
    background-color: red;
}

#right {
    width: 55%;
    background-color: aqua;
    position: absolute;
    right: 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-19T14:43:00.440

因此，如果您正在寻找固定宽度的“窥视”，以下答案如何适合：

[http://jsfiddle.net/NUWqE/1/](http://jsfiddle.net/NUWqE/1/)

```
#wrapper {
    width: 200%;
    position:relative;
}

#left {
    float: left;
    width: 50%;
    background-color: red;
    margin-right: -40px;
}

#right {
    float: right;
    width: 50%;
    background-color: aqua;
    position: relative;
    padding-left: 40px;
} 
```

You'll obviously have to adjust the padding of elements inside `#right` but you would probably be doing that any way depending upon how you'd like to style the content. Hopefully this is what you're looking for.

# ruby - 我可以让连接超时但仍然得到响应吗？

> ID：10644849
> 
> 赞同：1
> 
> 时间：2012-05-17T23:32:06.463
> 
> 标签：ruby, timeout

我有一个通过 http 获得响应的函数。它运行一些测试。最近开始发生测试永远不会完成的情况。所以我介绍了一个超时。然后我发现如果我停止数据库服务器，测试脚本会以一个 db 错误结束，这实际上很好地导致了测试没有按预期完成的原因。所以得到错误可以帮助我节省时间。因为我不必再次手动重现整个测试。

Q1：*有什么办法可以让连接超时，然后在数据库服务器重启后得到响应？*请注意，我无法再次发送 http 请求，因为它会再次启动相同的文本。

Q2：我认为一个解决方案是在“等待”http响应时引入计时器。但我不知道该怎么做。任何的想法？

我的功能就像

```
def execute_db2_script(url)
  db2_database = 'RATIONAL'
  http_read_timeout=$http_read_timeout
  uri = URI.parse(url)
  start = Time.new

  connection = Net::HTTP.new(uri.host, 443)
  connection.use_ssl = true
  begin 
    response = connection.start() do |http|
      http.open_timeout =  50
      http.read_timeout = http_read_timeout
      http.request_get(uri.request_uri)
    end
  rescue Timeout::Error
    time_out_message ="security time out - after #{$http_read_timeout} sec"
  return time_out_message       
  end       
  return response.body.gsub("\n","<BR>")
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:46:37.900

您可以使用`retry`关键字

```
def execute_db2_script(url)
  ...
  begin 
    ...
  rescue Timeout::Error
    time_out_message ="security time out - after #{$http_read_timeout} sec"
    if "the server is going to restart then"
      retry # this will restart begin-rescue-end block again
    else
      return time_out_message       
    end
  end       

  response.body.gsub("\n","<BR>")
end 
```

# ios - IOS：放大两个注释点的mapkit

> ID：10644854
> 
> 赞同：6
> 
> 时间：2012-05-17T23:32:39.940
> 
> 标签：ios, xcode, mapkit

我想知道当我在我的地图视图中设置蓝点（我的位置）和另一个大头针时是否有一种动态缩放的方法......当我加载地图视图时，我想在同一帧中显示这两个点.. 。是否可以？谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-18T02:19:06.360

是的，有可能。添加第二个注释后。此示例代码适用于任意数量的注释：

```
MKMapRect zoomRect = MKMapRectNull;
NSArray *annotations = [mapView annotations];
for (MKAnnotation *annotation in annotations) {

    MKMapPoint annotationPoint = MKMapPointForCoordinate(annotation.coordinate);
    MKMapRect pointRect = MKMapRectMake(annotationPoint.x, annotationPoint.y, 0, 0);
    if (MKMapRectIsNull(zoomRect)) {
        zoomRect = pointRect;
    } else {
        zoomRect = MKMapRectUnion(zoomRect, pointRect);
    }

}

[mapView setVisibleMapRect:zoomRect animated:YES]; 
```

# javascript - 使 JavaScript 变量仅对同一 .js 文件上的函数有效

> ID：10644864
> 
> 赞同：5
> 
> 时间：2012-05-17T23:33:52.310
> 
> 标签：javascript, variables, global-variables, local-variables

我对 Javascript 有点陌生，我被困在这一项上。有人可以告诉我如何使 javascript 变量只能在它所在的 .js 文件上使用。

例子：

假设我有两个 .js 文件，PG1 和 PG2。PG1 包含 var channel = Channel01;

PG2 包含一个同名的变量，但输入的变量不同（等号后面的部分）（var channel = Channel02）

我不希望 PG1 上的 function1 使用 PG2 上的变量或 PG2 上的 function2 使用 PG1 上的变量。

我还从单独的 HTML 页面调用这些函数。

问题：我的所有函数最终都只使用一个变量，无论它们在哪个页面上。（例如，function1 和 function2 都使用 var channel = channel01）

问题：如何将 page1 上的函数限制为仅使用该 .js 页面上的变量

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-17T23:36:45.147

将整个内容包装在立即调用函数表达式中，这将有效地为文件提供自己的*范围*。

```
(function() {
   // Your file's contents live here.
})(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-17T23:38:08.870

模块模式：

```
var myModule = (function(exports){

    var x = "foo";

    exports.myFunction = function(){
        alert(x);
    };

})(typeof exports!="undefined" && exports instanceof Object ? exports : window ); 
```

`myFunction`将`window`在浏览器的范围内可用。

**编辑**

我引用作者的话：“我也从一个单独的 HTML 页面调用这些函数。”

所以作者需要全局访问他定义的函数。

虽然不需要 var myModule ，也不需要 export ，它只是为了与 AMD 兼容：

```
(function(exports){

    var x = "foo";

    exports.myFunction = function(){
        alert(x);
    };

})(window); 
```

现在 x for myFunction 只存在于闭包中，但 myFunction 仍然可以在全局范围内访问 x。全局范围内的任何 x 定义或任何范围都不会影响`x = "foo"`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-17T23:46:45.600

如果您实际上不需要将任何变量公开到全局范围，则可以将整个 JavaScript 代码包装在立即调用的函数表达式或 IIFE 中。在这里，您定义了一个匿名函数表达式并立即调用它。结果是，不是用变量污染全局范围，而是在该函数的本地范围内保持它们的整洁。

```
(function() {
    var channel = Channel01;

    // Put the rest of your PG1 code here, for example:

    function init() {
        channel.open();
    }

    init();
})(); 
```

然后，您可以以类似的方式将您的 PG2 代码包装在 IIFE 中。结果将是这两个脚本除了已定义的全局变量（例如`Channel01`和）之外不共享任何变量`Channel02`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-07T16:47:27.043

虽然不是您问题的直接答案，但这是相关且重要的，因为错过它可能会污染其他模块。如果您不使用 var 关键字，则该变量位于全局范围内，即

```
(function () {
   x = 'foo'; //x is on the global scope and can be seen everywhere
})()

(function () {
   var y = 'bar'; //y is local to this function
})() 
```

我希望我没有重复上面任何人所说的，但我看不到它提到

# ruby-on-rails - _header.html.erb 帐户下拉功能不起作用

> ID：10644866
> 
> 赞同：0
> 
> 时间：2012-05-17T23:33:55.973
> 
> 标签：ruby-on-rails

我正在关注来自[http://ruby.railstutorial.org](http://ruby.railstutorial.org)的 ruby​​ on rails 教程。下面是_header.html.erb的代码，和教程一样。但是帐户的下拉功能不起作用。

```
<header class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <%= link_to "sample app", root_path, id: "logo" %>
      <nav>
        <ul class="nav pull-right">
          <li><%= link_to "Home", root_path %></li>
          <li><%= link_to "Help", help_path %></li>
          <% if signed_in? %>
            <li><%= link_to "Users", users_path %></li>
            <li id="fat-menu" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Account <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li><%= link_to "Profile", current_user %></li>
                <li><%= link_to "Settings", edit_user_path(current_user) %></li>
                <li class="divider"></li>
                <li>
                  <%= link_to "Sign out", signout_path, method: "delete" %>
                </li>
              </ul>
            </li>
          <% else %>
            <li><%= link_to "Sign in", signin_path %></li>
          <% end %>
        </ul>
      </nav>
    </div>
  </div>
</header> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:46:15.643

如果没有看到更多的应用程序，很难确定确切的问题，但是根据您提供的内容，我可以提出以下建议：

*   请参阅[http://twitter.github.com/bootstrap/javascript.html#dropdowns](http://twitter.github.com/bootstrap/javascript.html#dropdowns)并确保您使用的是正确的标记嵌套（看起来像）
*   确保您已在 application.js 文件（您的清单文件）中包含 javascript 文件。这里的引导文档：http: [//twitter.github.com/bootstrap/components.html#navbar](http://twitter.github.com/bootstrap/components.html#navbar)说您需要包含下拉 JS 文件才能使下拉正常工作。

请让我知道这是否有帮助。

# php - file_exists() 在 apache 根目录中工作，但不在子目录中

> ID：10644870
> 
> 赞同：0
> 
> 时间：2012-05-17T23:34:46.393
> 
> 标签：php, elgg

我已经安装了ispconfig3。我添加了一个网站，但是当我尝试在 /var/www/clients/client1/web5/web/ 中安装 elgg 时，它失败了，因为`file_exists()`在查找目录 /var/www/clients/client1/web5/data/ 时返回 false。当我从根目录中的 php 文件中检查时，它会找到该目录。我已经更改了父文件夹的所有权限，但仍然失败。Ispconfig3 使用符号链接将我的域链接到该目录，这可能是导致问题的原因......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:37:15.300

如文档中所写

> 警告。对于由于安全模式限制而无法访问的文件，此函数返回 FALSE。但是，如果这些文件位于 safe_mode_include_dir 中，仍然可以包含这些文件。

# ruby - 安装新的宝石

> ID：10644875
> 
> 赞同：0
> 
> 时间：2012-05-17T23:35:10.667
> 
> 标签：ruby, windows

嗨，我正在寻找在 Windows 的 Ruby 中安装 win32-service gem，我尝试使用“gem install”命令，但它似乎不知道在哪里可以找到我的 gem ;(

我下载了带有大量文件夹但没有安装说明的 gem 本身。

无论如何我可以手动安装gem或将IRB指向正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T03:10:17.903

运行此命令以手动安装 gem 文件。

> gem install [你的 gem 文件]

# php - yii 中的多个连接

> ID：10644885
> 
> 赞同：1
> 
> 时间：2012-05-17T23:36:18.297
> 
> 标签：php, mysql, yii

我从 yii 开始。

我有以下数据库结构：

```
Table:             Rows:

user               [id,login,password,name,email]
userToProject      [user_id,project_id,role]
project            [id,name,status] 
```

我想检索在**status=3**作为**role=manager**的项目中工作的所有用户。顺便说一句，这是我的代码，我需要进行第二次加入才能达到项目状态。

```
$criteria=new CDbCriteria;
$criteria->join='INNER JOIN {{userToProject}} a ON t.id=a.user_id and a.role='.Role::MANAGER;
$criteria->distinct=true;
return User::model()->findAll($criteria); 
```

我可以用一个标准来实现它还是应该实现一个 SQL 命令并运行它？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T05:15:44.803

好吧，您像这样在 userToProject 模型中建立关系...

```
'user'=>array(self::BELONGS_TO, 'User', 'user_id')

 //  after belongs_to User is a model class name..

'project'=>array(self::BELONGS_TO, 'Project', 'project_id'),

 //  after belongs_to Project is a model class name.. 
```

然后使用像..这样的活动记录

```
$allrecord =  UserToProject::model()->with('user','project')->findAll(
                               'status = :status AND role = :role',
                                array(':status' => 3 , 'role' => 'manager'));

//in with bracket user , project is your relation name.. 
```

现在在 $allrecord 你有数组形式的所有记录......

# java - 使用 JDBC 在 PostgreSQL 中插入点（几何）值

> ID：10644886
> 
> 赞同：9
> 
> 时间：2012-05-17T23:36:30.337
> 
> 标签：java, postgresql, jdbc, postgis, postgresql-9.1

请给我代码示例以插入包含 SQL 语句的记录：

```
insert into TABLE 
(id, value1, value2, point, value3) 
values
(1,'A', 'M', POINT (13.45646, 56.61782),5); 
```

在 JDBC/Postgresql 代码中。

如果有人有解决方案`PreparedStatement`或任何其他有用的解决方案，我们将非常欢迎！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T10:31:08.817

[在最简单的级别上，您可以使用几何构造函数](http://postgis.refractions.net/docs/reference.html#Geometry_Constructors)构建准备好的语句来传递参数。

```
insert into "TABLE"(id, value1, value2, point, value3)
values(1, $1, $2, ST_SetSRID(ST_MakePoint($3, $4), 4326)), $5); 
```

where`$3`和`$4`是经度和纬度。

* * *

另请参阅[JDBC 接口的 PostGIS 文档，](https://postgis.net/docs/ch06.html#idm2966)这可能对其他几何类型（LineString、Polygon、MultiPoint、MultiLineString、MultiPolygon）有用。

# visual-studio - 如何让 bjam 在其他目录中找到我的 .h 文件

> ID：10644892
> 
> 赞同：3
> 
> 时间：2012-05-17T23:37:04.563
> 
> 标签：visual-studio, bjam

我在 Visual Studio 2008 中维护此解决方案，但我使用 bjam 构建我的可交付成果。该解决方案包括 3 个项目。jamfiles 设置为构建解决方案的 2 个版本（例如 A 和 B），然后为每个版本构建 32 位和 64 位可执行文件。

我的问题是 bjam 没有为解决方案中的一个项目找到 .h 文件，从而产生以下错误。这些 .h 文件在物理上位于“包含”文件夹中上下 2 个目录。

如果我将 .h 文件复制到项目的 jamfile 所在的位置，错误就会消失，并且解决方案会完美构建。但是，我们必须将 .h 文件保存在“include”文件夹中。

我的问题是，如何指示 bjam 在“include”文件夹中查找 .h 文件？下面是有问题的项目的 jamfile，以及我的 site-config.jam 文件

任何提示将不胜感激。谢谢。

```
 -----------------------------------
    ERROR:
    compile-c-c++ Utilities\TemperatureLog\bin\msvc-9.0\small_x86\threading-multi\user-interface-gui\TemperatureLog.obj
    TemperatureLog.cpp
    c:\winirdir\build\winir\utilities\temperaturelog\TemperatureLogDlg.h(50) : error C2653: 'SBF' : is not a class or namespace name
    c:\winirdir\build\winir\utilities\temperaturelog\TemperatureLogDlg.h(50) : error C2143: syntax error : missing ';' before '*'
    c:\winirdir\build\winir\utilities\temperaturelog\TemperatureLogDlg.h(50) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
    c:\winirdir\build\winir\utilities\temperaturelog\TemperatureLogDlg.h(50) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
    ------------------------------------------ 
```

果酱文件：

```
project temperaturelog :
    : requirements <define>_AFXDLL
        <user-interface>gui
    :
    ;

sources = [ glob *.cpp ] TemperatureLog.rc ;

exe TemperatureLog$(suffix) : $(sources)
        /sbfsdk//SbfSdk$(suffix)
    : 
    : small_x86
    ;

exe TemperatureLog$(suffix)_x64 : $(sources)
        /sbfsdk//SbfSdk$(suffix)_x64
    : 
    : small_x64
    ;

exe TemperatureLog$(suffix)_sap : $(sources)
        /sbfsdk//SbfSdk$(suffix)_sap
    :
    : smallSapera_x86
    ;

exe TemperatureLog$(suffix)_sap_x64 : $(sources)
        /sbfsdk//SbfSdk$(suffix)_sap_x64
    :
    : smallSapera_x64
    ;

install dist_x86 : TemperatureLog$(suffix) : 
    <variant>small_x86 : <location>$(installRoot_x86) ;

install dist_x64 : TemperatureLog$(suffix)_x64 :
    <variant>small_x64 : <location>$(installRoot_x64) ;

install dist_sap_x86 : TemperatureLog$(suffix)_sap :
    <variant>smallSapera_x86 : <location>$(installRoot_x86) ;

install dist_sap_x64 : TemperatureLog$(suffix)_sap_x64 :
    <variant>smallSapera_x64 : <location>$(installRoot_x64) ;

--------------------------------

site-config.jam

project site-config ;

path-constant BoostRoot : C:/Boost/boost_1_44_0 ;

lib shlwapi : : <name>shlwapi ;
lib advapi32 : : <name>advapi32 ;
lib gdi32 : : <name>gdi32 ;
lib user32  : : <name>user32 ;
lib ole32 : : <name>ole32 ;
lib vfw32 : : <name>vfw32 ;
lib delayimp : : <name>delayimp ;
lib gdiplus : : <name>gdiplus ;
lib strmiids : : <name>strmiids ;
lib winmm : : <name>winmm ;
lib msvcrt : : <name>msvcrt ;
lib atls : : <name>atls ;
lib ksproxy : : <name>ksproxy ;
lib kernel32 : : <name>kernel32 ;
lib oleaut32 : : <name>oleaut32 ;
lib uuid : : <name>uuid ;
lib htmlhelp : : <name>htmlhelp ;
lib version : : <name>version ;
lib msi : : <name>msi ;

path-constant PleoraRoot : "C:/Program Files (x86)/Pleora Technologies Inc/iPORT Software" ;
lib cyutilslib_x86 : : <name>CyUtilsLib <search>$(PleoraRoot)/Libraries
    :
    : <include>$(PleoraRoot)/Includes
    ;
lib cyutilslib_x64 : : <name>CyUtilsLib64 <search>$(PleoraRoot)/Libraries
    :
    : <include>$(PleoraRoot)/Includes
    ;

path-constant PdvRoot : "C:/EDT/pdv" ;
lib pdvlib_x86 : : <name>pdvlib <search>$(PdvRoot)/lib/x86
    :
    : <include>$(PdvRoot)
    ;
lib pdvlib_x64 : : <name>pdvlib <search>$(PdvRoot)/lib/amd64
    :
    : <include>$(PdvRoot)
    ;

path-constant VceRoot : "C:/Program Files/Imperx/FrameLink Express/SDK" ;
lib vceclb_x86 : : <name>vceclb <search>$(VceRoot)/lib/win32
    :
    : <include>$(VceRoot)/inc
    ;
lib vceclb_x64 : : <name>vceclb <search>$(VceRoot)/lib/x64
    :
    : <include>$(VceRoot)/inc
    ;

path-constant DirectXRoot : "C:/Program Files (x86)/Microsoft DirectX SDK (June 2010)" ;
lib d3dx9_x86 : : <name>d3dx9 <search>$(DirectXRoot)/Lib/x86
    :
    : <include>$(DirectXRoot)/Include
    ;
lib d3dx9_x64 : : <name>d3dx9 <search>$(DirectXRoot)/Lib/x64
    :
    : <include>$(DirectXRoot)/Include
    ;
lib d3d9_x86 : : <name>d3d9 <search>$(DirectXRoot)/Lib/x86
    :
    : <include>$(DirectXRoot)/Include
    ;
lib d3d9_x64 : : <name>d3d9 <search>$(DirectXRoot)/Lib/x64
    :
    : <include>$(DirectXRoot)/Include
    ;

path-constant IfcRoot : "C:/IFC510" ;
lib ifc21 : : <name>ifc21 <search>$(IfcRoot)/lib
    :
    : <include>$(IfcRoot)/include
    ;

path-constant PythonRoot : "C:/Required_Binaries/Python-2.7.1" ;
lib python_x86 : : <name>python27 <search>$(PythonRoot)/PCBuild
    :
    : <include>$(PythonRoot)/Include <include>$(PythonRoot)/PC
    ;
lib python_x64 : : <name>python27 <search>$(PythonRoot)/PCBuild/amd64
    :
    : <include>$(PythonRoot)/Include <include>$(PythonRoot)/PC
    ;

# path-constants work up to here, but not after this, so we use the full path.  Why??
path-constant DirectShowRoot : "C:/Program Files/Microsoft SDKs/Windows/v7.0/Samples/multimedia/directshow/baseclasses" ;
lib Strmbase_x86 : : <name>strmbase <search>"C:/Program Files/Microsoft SDKs/Windows/v7.0/Samples/multimedia/directshow/baseclasses/Release_MBCS"
    :           
    : <include>$(DirectShowRoot)
    ;
lib Strmbase_x64 : : <name>strmbase <search>"C:/Program Files/Microsoft SDKs/Windows/v7.0/Samples/multimedia/directshow/baseclasses/x64/Release_MBCS"
    :           
    : <include>$(DirectShowRoot)
    ;

path-constant SaperaRoot : "C:/DALSA/Sapera" ;
lib SapClassBasic_x86 : : <name>SapClassBasic <search>"C:/Dalsa/Sapera/Lib/Win32"
    :           
    : <include>$(SaperaRoot)/Classes/Basic <include>$(SaperaRoot)/Include
    ;
lib SapClassBasic_x64 : : <name>SapClassBasic <search>"C:/Dalsa/Sapera/Lib/Win64"
    :           
    : <include>$(SaperaRoot)/Classes/Basic <include>$(SaperaRoot)/Include
    ;

path-constant SbfSdkInc  : "C:\WinIRDir\build\WinIR\SbfSdk\include" ;

path-constant ActRoot : "C:/Program Files (x86)/Active Silicon/Phoenix/Win/SDK6.47" ;
lib ActiveSilicon_x86 : : <name>phxlw32 <search>$(ActRoot)/Lib/win32
     :
     : <include>$(ActRoot)/Include
     ;
lib ActiveSilicon_x64 : : <name>phxlx64 <search>$(ActRoot)/Lib/win64
     :
     : <include>$(ActRoot)/Include
     ; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T23:06:24.090

用你的第一个 exe 规则尝试这样的事情：

```
exe TemperatureLog$（后缀）
    ：$（来源）
      /sbfsdk//SbfSdk$（后缀）
    : <include>../../include
    : 小_x86
    ;

```

更多细节可以在[这里找到](http://www.boost.org/doc/libs/1_51_0/doc/html/bbv2/tutorial.html#bbv2.tutorial.properties.requirements)

`exe`如果可行，那么您可以将其移动到规则中，而不是为每个规则复制它`project`：

```
项目温度日志
    ： 要求
      <定义>_AFXDLL
      <用户界面>gui
      <包括>../../包括
    ;

```

然后它应该适用于作为该项目的一部分调用的所有规则。

# spring - 用户从一个 Web 应用程序导航到另一个 Web 应用程序时 CAS 身份验证失败

> ID：10644894
> 
> 赞同：0
> 
> 时间：2012-05-17T23:37:12.537
> 
> 标签：spring, spring-security, cas

我们有两个 Web 应用程序。两者都启用了 CAS 身份验证。我们可以从 Web 应用程序（应用程序 A）导航到另一个（应用程序 B）。当用户从应用程序 A 导航到 B 时，有时 sessionManagementFilter 会重定向到会话过期页面。我们正在为应用程序 B 获取会话无效页面。这是 applicationContext-security.xml 文件中的弹簧配置设置。

任何想法是什么导致了这个问题。迅速的反应是可观的。

```
<http entry-point-ref="casProcessingFilterEntryPoint" >
        <custom-filter position="CAS_FILTER" ref="casProcessingFilter" />
    <custom-filter ref="sessionManagementFilter"   before="SESSION_MANAGEMENT_FILTER" />

    <logout logout-url="/j_spring_security_logout.xhtml" logout-success-url="calltoolSecurity{CAS_URL}/logout" invalidate-session="true" />
</http>

<beans:bean id="sessionManagementFilter" class="org.springframework.security.web.session.SessionManagementFilter">
    <beans:constructor-arg name="securityContextRepository" ref="httpSessionSecurityContextRepository" />
    <!-- this permits redirection to session timeout page from javascript/ajax or http -->
    <beans:property name="invalidSessionStrategy" ref="actInvalidSessionStrategy" />
</beans:bean>

<beans:bean id="actInvalidSessionStrategy" class="com.avivausa.api.web.JsfRedirectStrategy">
         <beans:constructor-arg name="invalidSessionUrl" value="/pages/system/errorSessionExpired.xhtml" />
</beans:bean> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T08:27:03.573

请确保两个应用程序使用相同的 CAS 服务器登录。

# javascript - 我可以让 jQuery UI datepicker 元素在单击日期时不重置吗？

> ID：10644897
> 
> 赞同：0
> 
> 时间：2012-05-17T23:37:22.450
> 
> 标签：javascript, jquery-ui, jquery-ui-datepicker

默认情况下，jQuery UI 日期选择器会在选择日期时重置日历 HTML。我希望能够更改/添加日历的元素（添加图像、背景等）并在单击日期后让它们保持不变。

例如，此脚本以 24 日蓝色背景作为内联日期选择器开始。当您单击另一个日期（例如 15 日）时，HTML 将重置并且蓝色背景消失。单击日期后，我希望它保持蓝色。

```
<script>

$(function(){
    $('#cal').datepicker({
        onSelect: function(dateText, inst) {
            console.log(dateText);
            // dont do anything else
        }
    });
    $('.ui-state-default:contains(24)').css('background-color','blue');
});

</script>   

<div id='cal'></div> 
```

演示：http: [//jsfiddle.net/DtvZM/](http://jsfiddle.net/DtvZM/)

看看当你点击一天时，第 24 天如何从蓝色变为白色。我希望它保持蓝色。

注意：这只是一个演示问题的示例，而不是我的实际代码。

在修改 jQuery UI 小部件代码之前，我想看看是否有一个简单的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T05:47:36.973

我已经解决，如果不修改 UI 日期选择器代码，这是不可能的，这就是我最终要做的 -

在 _selectDate 方法中，我更改了行：

```
if (inst.inline)
    this._updateDatepicker(inst); 
```

到

```
if (inst.inline) {
    inst.stay = true;
    this._updateDatepicker(inst);
    inst.stay = false;
} 
```

然后在 _updateDatepicker 方法中，我改变了

```
inst.dpDiv.empty().append(this._generateHTML(inst)); 
```

到

```
if (!inst.stay) {
    inst.dpDiv.empty().append(this._generateHTML(inst));
} 
```

现在UI选择了日期时，UI将不会重置日历HTML。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-17T23:51:11.210

回调`$('.ui-state-default:contains(24)').css('background-color','blue');` *里面*不能动吗？`onSelect`我相信你仍然需要这样做以确保新选择的 24 也变成蓝色。

另外，我想我会添加类并将实际样式保留在 CSS 中。

```
$(function(){
    $('#cal').datepicker({
        onSelect: function(dateText, inst) {
            console.log(dateText);
            $('.ui-state-default:contains(24)').css('background-color','blue');
            // dont do anything else
        }
    });
}); 
```

编辑：我认为您还需要重置每个上的所有 .ui-state-default 元素，`onSelect`以便如果用户首先选择“24”并且它变成蓝色，然后选择“17”，我相信它仍然是蓝色的， 所以：

```
$(function(){
    $('#cal').datepicker({
        onSelect: function(dateText, inst) {
            console.log(dateText);
            $('.ui-state-default').css('background-color','transparent');
            $('.ui-state-default:contains(24)').css('background-color','blue');
            // dont do anything else
        }
    });
}); 
```

# hyperlink - Facebook 上的黑名单链接已删除

> ID：10644905
> 
> 赞同：-1
> 
> 时间：2012-05-17T23:38:22.367
> 
> 标签：hyperlink, facebook-javascript-sdk, malware

我的网站上有恶意软件，因此 FB 将其列入黑名单并将指向我网站的链接重定向到谷歌。但是现在我的网站很干净（在谷歌网站管理员工具和 Sucuri 上检查过，但我的链接仍然不起作用。我如何获得白名单，或者至少不列入黑名单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T10:00:28.267

Try waiting for some days. Once Google is confirm of no malicious activity on your website, they will clear it.

# r - 使用 If 和 While 循环检查数据文件中的列时出错

> ID：10644906
> 
> 赞同：1
> 
> 时间：2012-05-17T23:38:40.510
> 
> 标签：r

我正在使用 While 循环和 If 语句在图表上生成文本。

我正在尝试使用 If 语句作为错误检查。如果 Lon 和 Lat 列中没有数据，则跳过此并移至下一行。

在我显示的数据表中，Lat 和 Lon 列中没有值，这就是它们显示为 NA 的原因，如下所示：

```
 myData3[1:7,]
  ISO3V10              Country No.of.Documents Lat Lon
1     AGO               Angola               0  NA  NA
2     ALB              Albania               0  NA  NA
3     ARE United Arab Emirates               0  NA  NA
4     ARG            Argentina               7  NA  NA
5     ARM              Armenia               0  NA  NA
6     AUS            Australia              96 151 -34
7     AUT              Austria              28  NA  NA 
```

到目前为止我写的代码如下：

```
 myData3 <- read.delim(file="C:\\Documents\\RScriptAnalysis\\noofpublications3.txt", header = TRUE, sep = "\t")
 data = 0
 n = 0
 while(data < 100){
 if (myData3["Lat", 0] & myData3["Lon", 0])
   {
   data = data +1
   n = n +1
   }
else {
  text(myData3[n,"Lat"],myData3[n,"Lon"],myData3[n,"No.of.Documents"],adj=0.5)
  n = n +1
  data = data +1
  }
} 
```

更改代码时收到以下错误消息：

```
 Error in matrix(unlist(value, recursive = FALSE, use.names = FALSE), nrow = nr,  : 
 'data' must be of a vector type

  Error in 0 = while (data < 1000) { : 
  invalid (do_set) left-hand side to assignment 
```

我需要一些帮助来弄清楚如何进行错误检查并调整我的代码以便能够做到这一点！！！

任何进一步的问题，请不要犹豫，问。

干杯，杰斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T23:57:20.960

就是这一行：

```
if (myData3["Lat", 0] & myData3["Lon", 0]) 
```

您想查看`n`第 th 行和 Lat/Lon 列`myData3`是否为 NA。

要访问行列`n`，`Lat`您可以：

```
myData3[n,'Lat'] 
```

或（对于数据框）：

```
myData3$Lat[n] 
```

要测试某事是否为 NA（数据丢失），请使用`is.na`（请参阅 参考资料`?is.na`）。

所以：

```
if ( is.na(myData$Lat[n]) && is.na(myData$Lon[n]) ) 
```

应该管用。（请注意，`&&`这是“和”运算符/逻辑快捷方式。`&`版本比较（例如）向量*element-wise*，即`c(TRUE, TRUE, FALSE) & c(FALSE, TRUE, FALSE)`——`c(FALSE, TRUE, FALSE)`在标量上使用它没有意义）。

* * *

以上将解决您的问题，但进一步说明您的代码：R 是一种*矢量化*语言，这意味着很多时候您可以假装您的值是标量并使用相同的代码，而不是循环。

例如，向量`x + 5`在哪里`x`将添加`5`到 的*每个元素*，`x`这意味着您不必`x[i] + 5`为`i`从 1 到的每个元素编写循环`length(x)`。

在上面，您可以生成一个行号向量，`myData3`其中 Lat 和 Lon 不是 na，如下所示：

```
idx = !is.na(myData3$Lat) & !is.na(myData3$Lon) 
```

在这里，`idx`将是一个 TRUE 和 FALSE 的向量，它与 in 中的行数一样长`myData3`（注意我`&`在这里使用而不是`&&`获取元素和）。 `idx`将是`TRUE`Lat 和 Lon 都不*是*NA 的地方，`FALSE`否则。

`text`然后进行绘图，您可以像这样一次将有效行输入全部：

```
text(myData3$Lat[idx],myData3$Lon[idx],myData3$No.of.Documents[idx],adj=0.5) 
```

这是因为大多数 R 函数都是向量化的，因此您可以输入整个向量，它将具有循环遍历每个元素的效果。

请注意，`myData3$Lat[idx]`挑选出`myData3$Lat`其中`idx`为 TRUE 的那些行，即 Lat 和 Lon 都存在的那些行。

如果这是您第一次使用矢量化语言（如 R 和 Matlab），请不要担心，您最终会掌握它的窍门。好有趣！

# java - Java 如何让低效代码比高效代码运行得更快？

> ID：10644908
> 
> 赞同：9
> 
> 时间：2012-05-17T23:39:08.827
> 
> 标签：java, performance, optimization, jvm, jit

在下面的代码片段中，`Foo1`是一个在每次`bar()`调用该方法时递增一个计数器的类。`Foo2`做同样的事情，但多了一层间接性。

我希望`Foo1`比 快`Foo2`，但在实践中，`Foo2`始终比 快 40% `Foo1`。JVM 是如何优化代码以使其`Foo2`运行速度快于`Foo1`?

### 一些细节

*   测试是用`java -server CompositionTest`.
*   运行测试`java -client CompositionTest`会产生预期的结果，`Foo2`比`Foo1`.
*   切换循环的顺序并没有什么不同。
*   结果在 sun 和 openjdk 的 JVM 上都使用 java6 进行了验证。

### 编码

```
public class CompositionTest {

    private static interface DoesBar {
        public void bar();
        public int count();
        public void count(int c);
    }

    private static final class Foo1 implements DoesBar {
        private int count = 0;
        public final void bar() { ++count; }
        public int count() { return count; }
        public void count(int c) { count = c; }
    }

    private static final class Foo2 implements DoesBar {
        private DoesBar bar;
        public Foo2(DoesBar bar) { this.bar = bar; }
        public final void bar() { bar.bar(); }
        public int count() { return bar.count(); }
        public void count(int c) { bar.count(c); }
    }

    public static void main(String[] args) {
        long time = 0;
        DoesBar bar = null;
        int reps = 100000000;

        for (int loop = 0; loop < 10; loop++) {
            bar = new Foo1();
            bar.count(0);

            int i = reps;
            time = System.nanoTime();
            while (i-- > 0) bar.bar();
            time = System.nanoTime() - time;

            if (reps != bar.count())
                throw new Error("reps != bar.count()");
        }
        System.out.println("Foo1 time: " + time);

        for (int loop = 0; loop < 10; loop++) {
            bar = new Foo2(new Foo1());
            bar.count(0);

            int i = reps;
            time = System.nanoTime();
            while (i-- > 0) bar.bar();
            time = System.nanoTime() - time;

            if (reps != bar.count())
                throw new Error("reps != bar.count()");
        }
        System.out.println("Foo2 time: " + time);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T16:22:33.303

您的微基准标记毫无意义。在我的计算机上，每个循环的代码运行时间约为 8 毫秒……要获得任何有意义的数字，基准测试可能应该至少运行一秒钟。

当两者都运行大约一秒钟时（提示，您需要的不仅仅是`Integer.MAX_VALUE`重复），我发现两者的运行时间是相同的。

对此的可能解释是，JIT 编译器已经注意到您的间接寻址毫无意义并对其进行了优化（或至少内联方法调用），以便在两个循环中执行的代码是相同的。

它可以这样做是因为它知道`bar`in`Foo2`实际上是 final，它还知道`Foo2`构造函数的参数总是 a `Foo1`（至少在我们的小测试中）。这样它就知道`Foo2.bar`调用时的确切代码路径。它还知道这个循环将运行很多次（实际上它知道循环将执行多少次）——因此内联代码似乎是个好主意。

我不知道这是否正是它所做的，但这些都是 JIT 可以让我对代码进行的合乎逻辑的观察。也许在未来，一些 JIT 编译器甚至可能优化整个 while 循环并简单地将 count 设置为 reps，但这似乎不太可能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T15:21:56.990

试图预测现代语言的性能并不是很有效率。

JVM 不断被修改以提高常见、可读结构的性能，相比之下，这会使不常见、笨拙的代码变慢。

尽可能清楚地编写代码——然后，如果你真的确定了一个点，你的代码实际上被认为太慢而无法通过书面规范，你可能需要手动调整一些区域——但这可能涉及到很大的、简单的想法，如对象缓存、调整 JVM 选项和消除真正愚蠢/错误的代码（错误的数据结构可能非常大，我曾经将 ArrayList 更改为 LinkedList 并将操作从 10 分钟减少到 5 秒，多线程 ping 操作发现 B 类网络的运行时间从 8 小时以上缩短到了几分钟）。

# c++ - std::runtime_error 是否复制构造函数中传递的字符串？

> ID：10644910
> 
> 赞同：15
> 
> 时间：2012-05-17T23:39:30.803
> 
> 标签：c++, exception

我想知道这一行是否创建了一个悬空指针：

```
string arg="derp";
throw std::runtime_error("Unknown argument "+arg); 
```

`std::runtime_error`复制`string`，还是存储参考？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-17T23:52:09.877

`std::exception`（`std::runtime_error`继承自）必须制作消息的副本，即使标准中没有明确指出（我可以找到）。在一般情况下，班级没有理由`exception`期望消息的来源会比它更长寿。`what()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:46:51.173

它需要一个字符串引用。并将其作为引用传递给 catch 块，但是如果您将字符串文字传递给构造函数，它将创建一个临时字符串对象。另外，不要对字符串执行 + arg ，这是语法错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:43:31.620

指针在哪里？`const std::string&`您正在复制字符串文字并在构造运行时错误时将其隐式转换为。

# ruby-on-rails - 为 MySQL 运行 Rails ActiveRecord 测试 -- test/config.yml 中的用户名被忽略

> ID：10644912
> 
> 赞同：1
> 
> 时间：2012-05-17T23:39:43.913
> 
> 标签：ruby-on-rails, unit-testing, activerecord

我已经在我工作的 Rails 应用程序中对 ActiveRecord 进行了猴子修补，并且我正试图准备提供一个拉取请求。我目前陷入困境，试图让 MySql 测试运行。

我正在使用提供的 test/config.yml 文件并创建了一个没有密码的“rails”用户。然后当我尝试运行`rake mysql:build_databases`时，我得到...

```
ERROR 1044 (42000) at line 1: Access denied for user ''@'localhost' to database 'activerecord_unittest'
ERROR 1044 (42000) at line 1: Access denied for user ''@'localhost' to database 'activerecord_unittest2' 
```

知道如何解决这个问题吗？

== 编辑

我添加了一个`puts`以`Rakefile`查看它试图执行的内容，并得到...

```
mysql --user=rails -e "create DATABASE activerecord_unittest DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_unicode_ci " 
```

...看起来不错。手动执行，我得到同样的错误。显然， --user 选项被忽略了。我跑了`mysql --help`，看起来`--user`是通过的正确选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:22:00.087

我现在已经设法让它工作了。

该错误消息非常具有误导性。实际上，正在发送正确的用户名，但用户不存在，因为我没有正确创建它，导致错误。

将用户名指定为“rails”会导致连接为`'rails'@'localhost'`，因此必须创建的用户名是`'rails'@'localhost'`，而不是`'rails'`。我想我很久以前就知道这一点，但现在我已经使用 PostgreSQL 工作了很长时间，所以忘记了。

# android - Android xml：拉伸一个元素并包裹另一个元素，水平相邻

> ID：10644913
> 
> 赞同：2
> 
> 时间：2012-05-17T23:40:14.640
> 
> 标签：android, xml

假设我有一个 EditText 和一个 Button 水平相邻。左边是 EditText，右边是 Button。

问题是，我希望按钮包装它的内容，而 EditText 从屏幕左侧一直延伸到按钮。所以按钮尽可能小（取决于按钮文本）并且 EditText 尽可能宽（取决于按钮大小）

我不知道我是否错过了一个简单的技巧......但我该如何完成呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T00:22:11.377

您必须使用 RelativeLayout，使 Button 右对齐并将 EditText 设置为按钮的左侧。之后， EditText 的 fill_parent 和 Button 的 wrap_content 将发挥作用。

看一下下面的代码可以澄清一切。

```
<RelativeLayout
    android:id="@+id/RL1"
    ...
    android:orientation="horizontal" >

        <EditText
            android:layout_width="fill_parent"
            ...
            android:layout_toLeftOf="@+id/buttonRight" >
        </EditText>

        <Button
            android:id="@+id/buttonRight"
            android:layout_width="wrap_content"
            ...
            android:singleLine="true" 
            android:layout_alignParentRight="true">
        </Button>

</RelativeLayout> 
```

# android - Android ExpandableListView 和 SQLite 数据库

> ID：10644914
> 
> 赞同：7
> 
> 时间：2012-05-17T23:40:33.020
> 
> 标签：android, sqlite, expandablelistview

我的数据库中有两张表——房间和设备。每个房间可以有很多设备。我想制作一个可扩展的列表视图，其中房间名称为组，设备名称和状态为子项（打开或关闭）。

任何人都可以给我一个简单的想法，因为我是Android的新手，而且所有教程都很难制作

这是我的数据库：

```
public void onCreate(SQLiteDatabase db) {
        db.execSQL("create table if not exists rooms (
                                    id_room integer primary key autoincrement, "
                + "name_room text not null" 
                + ");");    
        db.execSQL("create table if not exists devices (
                                    id_device integer primary key autoincrement, "
                + "name_device text not null," 
                + "state_device text not null,"
                + "id_room references rooms"
                + ");");
    } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T04:12:11.547

以下是一个非常简单、简洁的可扩展列表实现。

您需要在 db 助手类中使用两种方法来收集您需要的游标。

```
public Cursor fetchGroup() {
    String query = "SELECT * FROM rooms"
    return mDb.rawQuery(query, null);
}

public Cursor fetchChildren(String room) {
    String query = "SELECT * FROM devices WHERE id_room = '" + room + "'";
    return mDb.rawQuery(query, null);
} 
```

然后你需要设置你的适配器（在你的活动中）：

```
public class MyExpandableListAdapter extends SimpleCursorTreeAdapter {
    public MyExpandableListAdapter(Cursor cursor, Context context,int groupLayout, 
        int childLayout, String[] groupFrom, int[] groupTo, String[] childrenFrom, 
        int[] childrenTo) {
            super(context, cursor, groupLayout, groupFrom, groupTo,
                  childLayout, childrenFrom, childrenTo);
        }
    }

    @Override
    protected Cursor getChildrenCursor(Cursor groupCursor) {
        Cursor childCursor = mDbHelper.fetchChildren(groupCursor.getString(groupCursor.getColumnIndex("id_room"));            
        getActivity().startManagingCursor(childCursor);
        childCursor.moveToFirst();
        return childCursor;
    }
} 
```

最后调用适配器并将其设置到您的列表中（在您的活动中）：

```
private void fillData() {
    mGroupsCursor = mDbHelper.fetchGroup();
    getActivity().startManagingCursor(mGroupsCursor);
    mGroupsCursor.moveToFirst();

    ExpandableListView elv = (ExpandableListView) getActivity().findViewById(android.R.id.list);

    mAdapter = new MyExpandableListAdapter(mGroupsCursor, getActivity(),
        R.layout.rowlayout_expgroup,                     // Your row layout for a group
        R.layout.rowlayout_itemlist_exp,                 // Your row layout for a child
        new String[] { "id_room" },                      // Field(s) to use from group cursor
        new int[] { android.R.id.room },                 // Widget ids to put group data into
        new String[] { "name_device", "state_device" },  // Field(s) to use from child cursors
        new int[] { R.id.device, R.id.state });          // Widget ids to put child data into

        lv.setAdapter(mAdapter);                         // set the list adapter.
    }
} 
```

希望这可以帮助！

**编辑**

它应该像这样聚集在一起：

```
public class List_Exp extends Activity {
    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        mDbHelper = new YourDB(getActivity());
        mDbHelper.open();
        fillData();
    }

    private void fillData() { 
        // set list adapter here
    }

    public class MyExpandableListAdapter extends SimpleCursorTreeAdapter {
        // Your adapter
    }
} 
```

**编辑 2**

要捕获点击，请在您的活动中设置侦听器：

```
lv.setOnChildClickListener(new ExpandableListView.OnChildClickListener() {
    @Override
    public boolean onChildClick(ExpandableListView parent, View v,
        int groupPosition, int childPosition, long id) {
        // Your child click code here
        return true;
    }
});

lv.setOnGroupClickListener(new ExpandableListView.OnGroupClickListener() {
    @Override
    public boolean onGroupClick(ExpandableListView parent, View v,
        int groupPosition, int groupPosition, long id) {
        // Your group click code here
        return true;
    }
}); 
```

# .net - Windows 窗体应用程序中的相对路径

> ID：10644915
> 
> 赞同：1
> 
> 时间：2012-05-17T23:40:39.417
> 
> 标签：.net, relative-path

我在 Visual Studio 中制作一个 Windows 窗体应用程序。我在相对路径方面遇到了一些困难。例如，使用 OleDbConnection 连接到具有“\Databases\bla.mdb”相对路径的数据库在从 Visual Studio 进行调试时效果很好。但是，如果可执行路径是somepath\Debug\app.exe，那么数据库实际上是在somepath\Databases\bla.mdb"

定义正在使用的“基本路径”的设置在哪里？我检查了 Application::CommonAppDataPath、ExecutablePath、StartupPath、UserAppDataPath 和 LocalUserAppDataPath，没有返回“somepath”。

最后的想法是 Databases 文件夹将与可执行文件位于同一文件夹中，但如果我使用 ExecutablePath 或类似的东西对其进行硬编码，则在调试时它不起作用......如果我保持原样，在我的计算机它工作正常（使用与.exe 相同的文件夹中的Databases 文件夹进行调试和部署）但我在另一台笔记本电脑上尝试过它，它会在.exe 中的某处搜索Databases 文件夹`My Documents`。

我将不胜感激任何建议、答案或方向。到目前为止，我的谷歌搜索没有帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:44:08.200

[AppDomain.CurrentDomain.BaseDirectory](http://msdn.microsoft.com/en-us/library/system.appdomain.basedirectory.aspx)将以字符串形式获取可执行文件的根目录。我通常将它与 System.IO.Path.Combine 一起使用，如

```
string DbLocation = System.IO.Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "Databases\bla.mdb"; 
```

您需要 System.Reflection 的 using 语句才能使其工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:47:25.847

> 最后的想法是数据库文件夹将与可执行文件位于同一文件夹中

意味着您的调试目录布局与部署目录布局不同？

这不是一个好计划。与其尝试在调试与部署中为相对路径“重新定位”应用程序的根目录，不如尝试匹配两种方案的目录布局。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T02:18:10.533

在您的应用程序中，为了安全起见，您应该更喜欢绝对路径。

就像您发现的那样，如果使用相对路径，那么简单更改应用程序的启动文件夹可能会完全改变您的目标路径。启动文件夹可能是也可能不是包含您的可执行文件的文件夹，它几乎不受您的控制（因为最终用户可以在命令提示符下在他们喜欢的任何文件夹下自由执行您的可执行文件）。

因此，您可以使用 David 推荐的方法从相对路径形成绝对路径。您还可以使用诸如[http://filedirectorypath.codeplex.com/之类的库](http://filedirectorypath.codeplex.com/)

# c - 英特尔性能监视器——任何监控每个进程的方法？

> ID：10644919
> 
> 赞同：2
> 
> 时间：2012-05-17T23:41:22.163
> 
> 标签：c, performance, winapi, performancecounter, intel-pmu

我将如何使用[英特尔性能计数器](http://software.intel.com/en-us/articles/intel-performance-counter-monitor/)监视器监视特定进程的执行（即，其分支，来自分支跟踪存储），同时过滤掉其他进程的信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:26:24.750

您应该知道 BTS（分支跟踪存储）和性能监控事件/计数器（在 CPU 内部，它的 PMU 块）是非常不同的东西。

分支跟踪存储是 CPU 的功能，它在内存的特殊区域中记录每个采用的分支（eip 对 - 分支指令的第一个和分支目标的第二个；每对还添加一个标志字）。其结果非常类似于单步执行代码块（基本块）的记录顺序。这就像在编译器的帮助下进行代码覆盖一样，每个分支都由编译器检测。

BTS 只是 MSR_DEBUGCTLA MSR 中的一点点（它是 intel x86 寄存器）；我几乎可以肯定这个寄存器是线程特定的（就像在 Linux 中一样），所以你不需要挂钩调度程序。有[一些](http://www.openrce.org/blog/view/535/Branch_Tracing_with_Intel_MSR_Registers)在 Windows 中使用此 MSR 的示例；但使用了不同的位。另外，不要忘记正确设置 DS_AREA。因此，如果您真的想要 BTS，请复制一份[Intel Arch 手册](http://www.intel.com/content/www/us/en/processors/architectures-software-developer-manuals.html)（第 3b 卷，“调试和性能监控”部分，“19.7.8 分支跟踪存储 (BTS)”部分）并手动对 BTS 进行编程。最难的部分是处理 DS 区域溢出（您需要自定义中断处理程序）。

如果您想知道的不是执行代码的痕迹，而是程序的统计信息（执行了多少指令；分支预测的好坏；这里有多少间接分支......），您应该使用性能监控事件，也就是“基于精确事件采样”（PEBS）。英特尔 Vtune 做到了这一点；应该还有其他一些工具，甚至是[您链接的 Intel PBS](http://software.intel.com/en-us/articles/intel-performance-counter-monitor/)。唯一的问题（这对于免费工具来说有点困难）是找到你想要的事件的名称。基于指令执行的事件总是绑定到某个线程。

基于事件的采样是什么意思：您可以为某些事件设置一些限制，例如 1000，例如。BR_INST_EXEC.COND（“执行的条件近分支指令数”）或 BR_INST_EXEC.DIRECT（“所有无条件近分支指令，不包括调用和间接分支。”），一次最多 2-4 个事件。然后 CPU 将统计与该事件相对应的每一种情况。当出现第 1000 个情况时，将生成事件（中断）用于指示 EIP。通过抽样，您可以轻松获得代码行为的详细统计信息。如果您将限制设置为非常低的值，并且如果您不为 eip 汇总事件，您将获得跟踪；）

使用 PEBS，您可以知道 CPU 的代码有多糟糕，错误预测的分支位于何处，哪些指令等待来自缓存的数据等。有 100 多个事件（第 3b 卷的附录 A）。

PS有一些BTS/win的代码：http: [//blog.csdn.net/quincy_hu/article/details/4053163](http://blog.csdn.net/quincy_hu/article/details/4053163)

PPS 有 PMU 编程的简短概述，包括 PEBS 和 BTS。software.intel.com/file/30320 它适用于 Nehalem，但即使对于 Sandy 也可能是真实的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T00:32:22.103

We were forced to build our own instrumenting profiler that reads the MSRs directly to get this information. The Performance Counter Monitor's source code demonstrates how to build a kernel driver that reads them.

Previously we used VTune, but it crashes when run on our app. (When we tried OProfile on the Linux version, it actually crashed the entire kernel and forced us to power-cycle the machine, which was pretty funny.)

# c# - 多个 ClassLib 很好地引用了相同的较低级别 ClassLib

> ID：10644922
> 
> 赞同：0
> 
> 时间：2012-05-17T23:41:52.323
> 
> 标签：c#, class-library

我对引用相同代码逻辑的类库感到困惑，需要一些关于如何解决它的建议。

我将尝试解释我目前拥有的内容：

*   我有一个 C# ASP.NET 应用程序。它有一个 web.config 文件。
*   该应用程序包括许多类库，每个类库都为应用程序提供各种不同的功能，例如电子邮件处理、代码数据库访问、导入/导出功能。
*   尽管每个类库都提供了不同的特性，但它们都倾向于访问相同的数据库，使用相同的类集来访问自定义的 ConfigurationSection 等。

从逻辑上讲，这些 ClassLibraries 都与相同的较低级别服务（例如数据访问层和自定义 WebConfig 访问）接口是有道理的，但我似乎无法让它们正确地协同工作。

Q1）如果我将我的实体框架封装到一个单一的数据访问层（DAL）类库中，我怎样才能让主 Web 应用程序和各种类库都引用同一个 DAL 并共享资源而不会出现任何问题，例如

```
MyWebAppication
|
+--ClassLib A
|  |
|  +--DAL ClassLib
|
+--ClassLib B
|  |
|  +--DAL ClassLib
|
+--ClassLib C
|  |
|  +--DAL ClassLib
|
+--DAL ClassLib 
```

Q2) 我尝试创建一个包含一组类的单个 cs 文件，这些类提供对我希望各种类库 (AC) 使用的自定义 web.config 部分的访问。如果我在每个文件中“删除”cs文件，那么我显然会遇到冲突，因为cs文件的各种副本都具有相同的名称空间/类/方法名称。将这些类放入他们自己的类库中让我回到了 Q1 提出的问题。

我应该如何解决这个问题？

感谢阅读，克里斯

# php - 在 PHP for 循环中组合字符串和数字

> ID：10644924
> 
> 赞同：3
> 
> 时间：2012-05-17T23:42:03.397
> 
> 标签：php, loops, for-loop

PHP新手在这里

谁能告诉我以下语法有什么问题。我最多有 4 个文件 - $created_pa​​ge1、$created_pa​​ge2 每个都有相应的页面标题等，并希望循环处理这些文件。然而，每次我尝试连接字符串和循环编号时，PHP 都会抛出一个不稳定的问题 - 特别是 $created_pa​​ge.$num_pages 不会导致将 $created_pa​​ge1 或 $created_pa​​ge2 发送到函数，而是将字符串和数字转换为整数。我确信非常基本，但我会非常感谢任何我可以轻松理解的帮助或更好的解决方案。提前致谢！

```
$addit_pages == 4;

for ($num_pages=1;$num_pages<=$addit_pages ;$num_pages++) { 

replaceFileContent   ($dir,$created_page.$num_pages,"*page_title*",$page_title.$num_pages); 
//replaceFileContent  ($dir,$created_page2,"*page_title*",$page_title2); 
//replaceFileContent  ($dir,$created_page1,"*page_title*",$page_title3); 
//replaceFileContent  ($dir,$created_page3,"*page_title*",$page_title4);    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T23:52:14.103

您获取变量名称的代码应该是：

```
${'created_page'.$num_pages} 
```

这是因为您必须在尝试访问变量之前评估大括号内的字符串。

您之前的代码试图访问变量 $created_pa​​ge 和 $num_pages，并简单地将它们的值连接成一个字符串。

当然，page_title 变量也是如此

```
${'page_title'.$num_pages} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T23:47:08.620

你可以试试这个：

```
$addit_pages == 4; 
```

对于 ($num_pages=1;$num_pages<=$addit_pages;$num_pages++) {

replaceFileContent ($dir,$created_pa​​ge.strval($num_pages),"*page_title*",$page_title.strval($num_pages)); //replaceFileContent ($dir,$created_pa​​ge2,"*page_title*",$page_title2); //replaceFileContent ($dir,$created_pa​​ge1,"*page_title*",$page_title3); //replaceFileContent ($dir,$created_pa​​ge3,"*page_title*",$page_title4);
}

PHP strval 函数将任何整数转换为字符串

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:51:56.070

我想你要问的是你想要变量，但 php 可能会抛出一个不存在`$created_page1; $created_page2, $created_page3`的通知。`$created_page`

您需要使用可变变量（这就是它们的名称吗？）

```
$addit_pages == 4;

for ($num_pages=1;$num_pages<=$addit_pages ;$num_pages++) { 
    $createdVar = 'created_page'.$num_pages;
    $titleVar = 'page_title'.$num_pages;
    replaceFileContent   ($dir,$$createdVar,"*page_title*",$$titleVar); 
} 
```

当您使用`$$`它时，首先评估变量`$createdVar`将其转换为`created_page1`然后评估`created_page1`，就好像您输入了`$created_page1`

# python - 在 Python 中随机交错 2 个数组

> ID：10644925
> 
> 赞同：15
> 
> 时间：2012-05-17T23:42:14.827
> 
> 标签：python, arrays, random

假设我有两个数组：

```
a = [1, 2, 3, 4]
b = [5, 6, 7, 8, 9] 
```

我想将这两个数组交错到一个变量“c”（注意“a”和“b”不一定具有相同的长度），但我不希望它们以一种确定的方式交错。简而言之，仅仅压缩这两个数组是不够的。我不想要：

```
c = [1, 5, 2, 6, 3, 7, 4, 8, 9] 
```

相反，我想要一些随机的东西，比如：

```
c = [5, 6, 1, 7, 2, 3, 8, 4, 9] 
```

另请注意，“a”和“b”的顺序保留在结果数组“c”中。

我目前的解决方案需要一个 for 循环和一些随机数生成。我不喜欢它，我希望有人可以为我指出更好的解决方案。

```
# resulting array
c = []

# this tells us the ratio of elements to place in c. if there are more elements 
# in 'a' this ratio will be larger and as we iterate over elements, we will place
# more elements from 'a' into 'c'.
ratio = float(len(a)) / float(len(a) + len(b))

while a and b:
    which_list = random.random()
    if which_list < ratio:
        c.append(a.pop(0))
    else:
        c.append(b.pop(0))

# tack on any extra elements to the end
if a:
    c += a
elif b:
    c += b 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-17T23:57:36.123

**编辑：**我认为最近的一个是最好的：

```
a = [1, 2, 3, 4]
b = [5, 6, 7, 8, 9]
c = [x.pop(0) for x in random.sample([a]*len(a) + [b]*len(b), len(a)+len(b))] 
```

或者更有效：

```
c = map(next, random.sample([iter(a)]*len(a) + [iter(b)]*len(b), len(a)+len(b))) 
```

请注意，上面的第一种方法会修改原始列表（正如您的代码所做的那样），而第二种方法则不会。在 Python 3.x 上，您需要这样做，`list(map(...))`因为`map`返回一个迭代器。

**下面的原始答案：**

这是一个节省几行的选项：

```
a = [1, 2, 3, 4]
b = [5, 6, 7, 8, 9]

c = []
tmp = [a]*len(a) + [b]*len(b)
while a and b:
    c.append(random.choice(tmp).pop(0))

c += a + b 
```

这是另一种选择，但只有在您知道所有元素都不是假的（没有`0`、`''`、`None`、`False`或空序列）时才有效：

```
a = [1, 2, 3, 4]
b = [5, 6, 7, 8, 9]

ratio = float(len(a)) / float(len(a) + len(b))
c = [(not a and b.pop(0)) or (not b and a.pop(0)) or
     (random.random() < ratio and b.pop(0)) or a.pop(0)
     for _ in range(len(a) + len(b))] 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-18T00:27:30.887

**编辑以消除多余的混乱：**这是一个适用于任意数量的输入列表的解决方案，不会破坏输入列表，也不会复制它们：

```
import random

def interleave(*args):
    iters = [i for i, b in ((iter(a), a) for a in args) for _ in xrange(len(b))]
    random.shuffle(iters)
    return map(next, iters) 
```

Stackoverflow 用户 EOL 提供了我的解决方案的增强版：

```
def interleave(*args):
    iters = sum(([iter(arg)]*len(arg) for arg in args), [])
    random.shuffle(iters)
    return map(next, iters) 
```

运行这个

```
a = [1,2,3,4]
b = [5,6,7,8,9]
print interleave(a, b) 
```

产生以下作为许多可能结果之一：

```
[5, 6, 7, 1, 8, 2, 3, 9, 4] 
```

**编辑：**应 EOL 的要求，我更新了计时码。不幸的是，由于接受的解决方案修改了它的输入，我需要在每次迭代时制作一个新的副本。我已经为 FJ 和我自己的解决方案做了这个，以使结果具有可比性。以下是 F.Js 解决方案的时机：

```
$ python -m timeit -v -s "from srgerg import accepted" -s "a = list(xrange(40000))" -s "b = list(xrange(60000))" "accepted(list(a), list(b))"
10 loops -> 10.5 secs
raw times: 10.3 10.1 9.94
10 loops, best of 3: 994 msec per loop 
```

这是我的函数版本的时间

```
$ python -m timeit -v -s "from srgerg import original" -s "a = list(xrange(40000))" -s "b = list(xrange(60000))" "original(list(a), list(b))"
10 loops -> 0.616 secs
raw times: 0.647 0.614 0.641
10 loops, best of 3: 61.4 msec per loop 
```

以下是 EOL 增强版的时间安排：

```
$ python -m timeit -v -s "from srgerg import eol_enhanced" -s "a = list(xrange(40000))" -s "b = list(xrange(60000))" "eol_enhanced(list(a), list(b))"
10 loops -> 0.572 secs
raw times: 0.576 0.572 0.588
10 loops, best of 3: 57.2 msec per loop 
```

如果我从 EOL 增强版本的循环中删除列表复制，我会得到：

```
$ python -m timeit -v -s "from srgerg import eol_enhanced" -s "a = list(xrange(40000))" -s "b = list(xrange(60000))" "eol_enhanced(a, b)"
10 loops -> 0.573 secs
raw times: 0.572 0.575 0.565
10 loops, best of 3: 56.5 msec per loop 
```

**另一个编辑：** FJ 有一个更新的解决方案，并要求我添加时间：

```
$ python -m timeit -v -s "from srgerg import fj_updated" -s "a = list(xrange(40000))" -s "b = list(xrange(60000))" "fj_updated(list(a), list(b))"
10 loops -> 0.647 secs
raw times: 0.652 0.653 0.649
10 loops, best of 3: 64.9 msec per loop 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-18T08:28:45.930

**PS**：**请考虑阅读[@srgerg 的回答](https://stackoverflow.com/a/10645233/42973)**：在我看来，这是最好的解决方案（尽管 FJ 相对接近）。与下面的方案相比，它更通用，甚至更简单一点，并且只占用大约两倍的内存。

这是既**简单**又**高效**的东西：

```
[(a if random.randrange(0, len(a)+len(b)) < len(a) else b).pop(0) for _ in range(len(a)+len(b))] 
```

该解决方案避免了明确测试是否为空的特定`a`情况`b`。

该解决方案使用了几个关键点：

*   使用`randrange()`允许人们简单地处理整数（无需计算比率）。
*   它会自动适应空列表（即`< len(a)`测试），而无需任何额外的测试，例如`a or b`，`[… a and b]+a+b`...</li>

这个解决方案可以很好地处理不同大小的列表：较短列表的元素在结果中分布得非常均匀。这种方法还具有“不变性”的特点：可能结果列表的概率分布仅取决于和列表的*当前*内容。`a``b`

`.pop()`通过使用更快的而不是`.pop(0)`（因为列表是快速的`pop()`而不是快速的） ，它可以变得更加高效`pop(0)`：

```
a.reverse(); b.reverse()
[(a if random.randrange(0, len(a)+len(b)) < len(a) else b).pop() for _ in range(len(a)+len(b))] 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-05-18T00:41:05.117

根据 TryPyPy 的建议编辑：

```
from random import choice

l = [a, b]
c = [choice(l).pop(0) for i in range(len(a) + len(b)) if (a and b)] + a + b 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-05-18T07:46:51.377

这是一个适用于任意数量的迭代的解决方案：

```
import random

def interleave(*args):
  iters = map(iter, args)
  while iters:
    it = random.choice(iters)
    try:
      yield next(it)
    except StopIteration:
      iters.remove(it)

print list(interleave(xrange(1, 5), xrange(5, 10), xrange(10, 15))) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-18T00:03:38.750

连接，然后打乱一个标志数组，然后用它来选择一个数组来获取每个项目怎么样？

```
import random

a = [1, 2, 3, 4]
b = [5, 6, 7, 8, 9]

c = list('a' * len(a) + 'b' * len(b)) # Flags for taking items from each array
random.shuffle(c) # Randomize from where we take items

aa, bb = a[:], b[:] # Copy the arrays for popping 
d = [aa.pop(0) if source == 'a' else bb.pop(0) for source in c]
# Take items in order, randomly from each array 
```

FogleBird 的一种更有效的方法：

```
c = [a[:]] * len(a) + [b[:]] * len(b)
random.shuffle(c) # Randomize from where we take items

d = [x.pop(0) for x in c] # Take items in order, randomly from each array 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-18T00:11:52.680

该解决方案为您提供了一个生成器，并通过随机交换列表 (a) 和 (b) 尚未发出的部分来工作。

```
import random

a = [1,2,3,4]
b = [5,6,7,8,9]

def interleave(a,b):
   while a or b:
      (a,b)=(a,b) if len(a) and (random.random()<0.5 or not len(b)) else (b,a)
      yield a.pop(0)

print list(interleave(a,b)) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-18T00:18:37.953

这是使用未记录的 Python（特别`__length_hint__`是列表迭代器对象的方法，它告诉您在迭代器中剩余多少项）将其塞入列表推导式的东西。我想，更多的是为了好玩，而不是实际的实用性。

```
itera, iterb = iter(a), iter(b)
morea, moreb = itera.__length_hint__, iterb.__length_hint__
c = [next(itera) if not moreb() or morea() and random.random() < ratio
     else next(iterb) for c in xrange(len(a) + len(b))] 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-05-26T17:45:17.993

我会这样解决这个问题：

```
import random

LResult = []

LLists = [[1, 2, 3, 4], [5, 6, 7, 8, 9]]

while LLists[0] or LLists[1]:
    LResult.append(LLists[random.choice([int(len(LLists[0])==0), int(len(LLists[1])!=0)])].pop(0)) 
```

LLists 是一个多维列表，它存储两个列表（您的示例中的 a 和 b）。该语句等效于： LLists = [a[:], b[:]] 但是为了简单明了，我在列表中明确编码。

LResult 是您示例中的 c 并最终存储结果数组。

while 循环将循环直到 LLists sub 0 和 LLists sub 1 都完全为空。在循环中，LResult 被附加一个来自 LLists sub 0 或 LLists sub 1 的值。关于选择哪个子列表的值的决定由 random.choice() 语句确定，该语句接受两个（在这种情况下）参数，然后随机返回其中之一。

提供给 random.choice() 的选项由 LLists 中每个子列表的长度决定。如果 LLists sub 0 的长度大于零，则语句 int(len(LLists[0])==0) 将选项号 1 作为零返回。对于 random.choice() 的第二个选项，如果 LLists sub 1 的长度大于零，则语句 int(len(LLists[1])!=0) 将返回 1。在这两种情况下，如果一个子列表的长度为零，则相应的语句将返回相反的数字。也就是说，如果 LLists[0] 的长度为零，并且 LLists[1] 的长度大于零，则生成的语句将是 random.choice(1, 1)。在这种情况下 random.choice() 将返回 1 和 1 之间的选择（当然是 1）。

一旦决定从哪个子列表中提取值，第一项就是将子列表弹出（.pop(0)）到 LResult 中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-05-18T00:06:24.060

你可以这样做：

```
(L, l) = (a, b) if len(a) > len(b) else( b, a)
positions = random.sample(range(len(L)), len(l))
for i in range(len(positions)):
    L.insert(positions[i], l[i]) 
```

但以我的拙见，你所拥有的一切都很好..它有效，很简单

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-05-18T00:35:50.887

这个想法怎么样：

```
import random as rn

a = [1, 2, 3, 4]
b = [5, 6, 7, 8, 9]
n = 100 #Here i am picking an arbitrary number, it should probably be a function of 
        # lengths of a and b

a_ind = sorted(rn.sample(range(n),len(a))) #sorting the indexes insures that order of 
b_ind = sorted(rn.sample(range(n),len(b))) # a and b is preserved

big_list = zip(a,a_ind) + zip(b,b_ind)

big_list.sort(key  = lambda k: k[1])

result = list(zip(*big_list)[0]) 
```

结果：

```
>>> result
[1, 5, 2, 6, 3, 7, 8, 9, 4] 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-05-21T15:17:42.887

描述中的“交错”一词可能令人困惑。如果您只是添加输入列表，然后将结果打乱，您会得到相同的结果。仅当要保留交织的结果时才需要交织。

一些代码：

```
>>> import random
>>> 
>>> a, b = [1,2,3,4], [5,6,7,8]
>>> c = sum([a,b], [])
>>> random.shuffle(c)
>>> c
[6, 5, 8, 2, 7, 4, 1, 3] 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-10-23T13:43:37.503

可能非常低效，但另一种方法有效：

```
import random

def interleave(*args):
    indices=[(i,j) for i in range(len(args)) for j in range(len(args[i]))]
    random.shuffle(indices)
    indices.sort(key=lambda x:x[1])
    return [args[i][j] for i,j in indices] 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-11-30T18:52:43.687

我已经调整了[@NPE 的解决方案](https://stackoverflow.com/a/10648710/431087)，因此它以恒定而不是线性时间*删除空迭代器。它接受任意数量的输入列表，并返回一个随机交错它们的迭代器，保留输入列表给定的顺序。

```
def interleave(*args):
  iters = [iter(x) for x in args]
  while iters:
    i = random.randrange(len(iters))
    try:
      yield next(iters[i])
    except StopIteration:
      # swap empty iterator to end and remove
      iters[i],iters[-1] = iters[-1],iters[i]
      iters.pop()

print list(interleave(xrange(1, 5), xrange(5, 10), xrange(10, 15))) 
```

*总运行时间而`O(N)`不是项目总数和列表数。`O(N+M^2)``N``M`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-08-22T19:43:28.340

如果列表 1 和列表 2 之间的比率保持不变，您可以创建如下函数：

```
def selectFromTwoList(ratioFromList1):
    final_list = []
    for i in range(len(list1)):
        rand = random.randint(1, 100)
        if rand <= ratioFromList1*100:
            final_list.append(list1.pop(0))
        else:
            final_list.append(list2.pop(0))
        return final_list 
```

# xml - XML DOM replaceChild

> ID：10644926
> 
> 赞同：0
> 
> 时间：2012-05-17T23:42:17.160
> 
> 标签：xml, dom

我在这里有一个将信息写入 XML 文件的网站，这是我的代码：

```
<?php
$doc = new DOMDocument();
$doc->load("xml/latestContent.xml");
$rootElement = $doc->documentElement;

// Create latestpic element as a child of the root element
$latestPicElement = $rootElement->appendChild($doc->createElement("latestpic"));
$latestPicElement->appendChild($doc->createElement("item", "Latest Pic"));
$latestPicElement->appendChild($doc->createElement("content", $latestPic));

// Create latestvideo element as a child of the root element
$latestVidElement = $rootElement->appendChild($doc->createElement("latestvideo"));
$latestVidElement->appendChild($doc->createElement("item", "Latest Video"));
$latestVidElement->appendChild($doc->createElement("content", $videoData));

// Create latestfact element as a child of the root element
$latestFactElement = $rootElement->appendChild($doc->createElement("latestfact"));
$latestFactElement->appendChild($doc->createElement("item", "Latest Fact"));
$latestFactElement->appendChild($doc->createElement("content", $factData));

// Save back to XML file
$doc->save("xml/latestContent.xml");
?> 
```

这里的问题是每次我加载网页时它都会重新加载这个函数，它只是将相同的数据添加回 XML 文件，如果可以的话，我希望它替换原始数据？我该怎么做呢？我研究了 replaceChild 方法，但无法完全正确地获得语法。谁能给我看看？

或者有没有一种方法可以让我每次都加载一个空白的xml？所以它只是将内容添加到一个新的 XML 文件中？

提前非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T00:21:40.417

如果要使用，则需要一个指向要替换的节点的指针[`replaceChild()`](http://www.php.net/manual/en/domnode.replacechild.php)。另一方面，如果想法是替换所有数据，为什么要读取现有文件？

```
//$doc->load("xml/latestContent.xml"); not needed
$rootElement = $dom->appendChild($doc->createElement("Root")); 
```

这个新文档将覆盖之前的文档。[您可以在此处](http://php.net/manual/en/domdocument.createelement.php)获取更多信息。

# iphone - Apple Mach-O 链接器错误（“重复符号”）

> ID：10644927
> 
> 赞同：1
> 
> 时间：2012-05-17T23:42:23.407
> 
> 标签：iphone, objective-c

我正在尝试编译我的游戏，但不应该出现的错误是。

这些是我班级的文件：

圈子.h：

```
#import <UIKit/UIKit.h>

@interface Circle : NSObject
{

}
@property (readwrite, assign) CGPoint Center;
@property (readwrite, assign) float Radius;

+ (Circle *) CircleMakeFromCenter:(CGPoint)center radius:(float)radius;

@end 
```

圆.m：

```
#import "Circle.h"

@implementation Circle
@synthesize Center;
@synthesize Radius;

+ (Circle *) CircleMakeFromCenter:(CGPoint)center radius:(float)radius{
    Circle *c = [[Circle alloc] init];
    c.Center = center;
    c.Radius = radius;

    return c;
}

@end 
```

它会显示一个错误，说半径是一个重复的符号。

为什么会出现这个错误？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-18T00:18:53.960

在 Objective-C 中出现这种错误的最常见原因是你不小心把它放在了你的一个文件中：

```
#import "Circle.m" 
```

当你应该把这个：

```
#import "Circle.h" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T17:04:11.737

就我而言，实际上有两个不同的实现文件；我正在玩本地化，我不小心为不同的位置创建了两个不同的 .m 文件。删除并重新创建 .m 文件为我修复了错误。

# java - 使用反射调用私有本机方法

> ID：10644928
> 
> 赞同：3
> 
> 时间：2012-05-17T23:42:27.390
> 
> 标签：java, android, java-native-interface, native

我的应用程序中有这段代码（我正在调用一个`private` **`native`**方法）

```
 Method m;
 try {
     m = Time.class.getDeclaredMethod("format1", String.class);
     m.setAccessible(true);
     return (String) m.invoke((Time) this, format);

 } catch (NoSuchMethodException e) {
     e.printStackTrace();
 } catch (IllegalArgumentException e) {
     e.printStackTrace();
 } catch (IllegalAccessException e) {
     e.printStackTrace();
 } catch (InvocationTargetException e) {
     e.printStackTrace();
 } 
```

这`Time`是`android.text.format.time`类，我在扩展的类中运行此代码`Time`。

问题是，我的应用程序内部没有任何错误，然后我的应用程序突然自行关闭。（不强制关闭）

在 logcat 中，我有这些：

```
A/libc(9193): Fatal signal 11 (SIGSEGV) at 0x00000000 (code=1)
I/DEBUG(15804): *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
I/DEBUG(15804): Build fingerprint: 'google/soju/crespo:4.0.4/IMM76D/299849:user/release-keys'
I/DEBUG(15804): pid: 9193, tid: 9193  >>> com.myapp <<<
I/DEBUG(15804): signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 00000000
I/DEBUG(15804):  r0 00000000  r1 bed564a0  r2 bed565a1  r3 00000000
I/DEBUG(15804):  r4 4008a55c  r5 00000000  r6 bed565cc  r7 016b58b9
I/DEBUG(15804):  r8 bed565a1  r9 4020b9a4  10 bed5647c  fp bed5663c
I/DEBUG(15804):  ip ffffff1c  sp bed5639c  lr 4006c58d  pc 4006c14c  cpsr 20000030
... 
```

关于如何解决它的任何想法？

# sql - 计算给定日期和 current_timestamp 之间的天数

> ID：10644929
> 
> 赞同：1
> 
> 时间：2012-05-17T23:42:29.703
> 
> 标签：sql, sql-server-2008, date

我正在尝试获取帐户到期前的剩余天数，以便我可以向我的用户发送一封电子邮件通知他们。我有正确的“Where”语句，但我不确定如何选择差异作为整数。到目前为止，我有：

```
SELECT (DATE_EXPIRE-CURRENT_TIMESTAMP),EMAIL 
FROM [myTable] 
WHERE (DATE_EXPIRE - CURRENT_TIMESTAMP <= 10) AND (DATE_EXPIRE - CURRENT_TIMESTAMP >= 1) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T23:46:57.383

```
SELECT DATEDIFF(DAY, CURRENT_TIMESTAMP, DATE_EXPIRE),EMAIL 
FROM dbo.[myTable] 
WHERE DATEDIFF(DAY, CURRENT_TIMESTAMP, DATE_EXPIRE) BETWEEN 1 AND 10; 
```

我真正提倡使用 BETWEEN 的少数情况之一。虽然我仍然更喜欢设置明确的界限：

```
DECLARE @tomorrow DATE = DATEADD(DAY, 1, CURRENT_TIMESTAMP);

SELECT DATEDIFF(DAY, CURRENT_TIMESTAMP, DATE_EXPIRE),EMAIL 
FROM dbo.[myTable] 
WHERE DATE_EXPIRE >= @tomorrow
AND DATE_EXPIRE < DATEADD(DAY, 10, @tomorrow); 
```

您不应该使用速记数学（例如`datetime - integer`），因为虽然它适用于 DATETIME / SMALLDATETIME，但如果您将数据类型更改为 DATE、DATETIME2 等，它会中断。

对于我对日期范围查询的许多漫无边际：

*   [要改掉的坏习惯：错误处理日期/范围查询](https://sqlblog.org/2009/10/16/bad-habits-to-kick-mis-handling-date-range-queries)

# javascript - 为什么这个 javascript 没有按预期运行？

> ID：10644931
> 
> 赞同：1
> 
> 时间：2012-05-17T23:42:37.963
> 
> 标签：javascript, dom, loops, timeout

```
 function animateGraph() {
    var graph;
    for(i=0; i<10; i++)
    {
        var start = new Date();
        while((new Date()) - start <= 500) {/*wait*/}
        document.getElementById("timeMark").innerHTML = phoneX[i].epoch;

    }
} 
```

循环有效。等待有效。但是 document.getElement 直到数组中的最后一项才显示出来……为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T23:48:21.213

使用 setTimeout 将允许代码运行并且不会锁定页面。这将允许它运行代码并且不会影响页面上的其他元素。

```
var cnt = 0;
(function animateGraph() {
    document.getElementById("timeMark").innerHTML = phoneX[cnt].epoch;
    cnt++;
    if (cnt<10){
        window.setTimeout(animateGraph,500);
    }
})(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:46:59.693

等待日期时间的 while 循环不是等待的好方法 - 它只会阻止执行。它使浏览器（包括 UI 及其更新）保持冻结状态，直到脚本完成。之后，根据 DOM 重新绘制窗口。

改用[`window.setTimeout()`](https://developer.mozilla.org/en/DOM/window.setTimeout)：

```
function animateGraph(phoneX) {
    var el = document.getElementById("timeMark")
    var i = 0;
    (function nextStep() {
        if (i < phoneX.length )
            el.innerHTML = phoneX[i].epoch;
        i++;
        if (i < phoneX.length )
            window.setTimeout(nextStep, 500);
    })();
} 
```

请注意，这是异步运行的，即函数`animateGraph`将在所有`phoneX`es 显示之前返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T23:45:17.353

使用 setTimeout 而不是 while 循环。

[https://developer.mozilla.org/en/DOM/window.setTimeout](https://developer.mozilla.org/en/DOM/window.setTimeout)

也尝试这样的事情。 [Javascript setTimeout 函数](https://stackoverflow.com/questions/7191769/javascript-settimeout-function)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T23:58:27.570

以下代码片段使用辅助函数来创建计时器。这个辅助函数接受一个循环计数器参数`i`，并在定时器处理程序结束时调用自己以进行下一次迭代。

```
function animateGraph() {
    var graph;
    setTimeMarkDelayed(0);

    function setTimeMarkDelayed(i) {
        setTimeout(function() {
            document.getElementById("timeMark").innerHTML = phoneX[i].epoch;

            if (i < 10) {
                setTimeMarkDelayed(++i);
            }
        }, 3000);
    }
} 
```

您实际上需要某种辅助函数，否则您最终将`i`在每次迭代中覆盖 for 循环中的值，并且当您的计时器用完时，所有处理程序都`i`将`9`作用于`phoneX`. 通过`i`作为参数传递给辅助函数，该值存储在该函数的本地范围内，不会被覆盖。

或者你可以`setInterval`像 Radu 建议的那样使用，这两种方法都可以。

# ruby - 将 DRb 和 TCPSocket 用于分布式 Ruby 程序的主要区别是什么？

> ID：10644932
> 
> 赞同：1
> 
> 时间：2012-05-17T23:42:50.187
> 
> 标签：ruby, tcpsocket, drb

如果我想创建一个多进程的客户端-服务器类型的系统，其中一个 Ruby 程序是客户端，另一个 Ruby 程序是服务器，那么在决定是否使用 DRb 和 TCPSocket 实现这一点时，重要的因素是什么？两者似乎都允许两个进程之间的双向通信。

是否存在一种方法比另一种方法更好的领域？例如，如果您需要多个客户端能够同时访问服务器进程。

# express - 在 ExpressJS/PassportJS/Jade 应用程序中将变量传递给 JavaScript

> ID：10644934
> 
> 赞同：0
> 
> 时间：2012-05-17T23:43:10.873
> 
> 标签：express, pug, passport.js

这本质上是这里问题的延续：[Nodejs Passport display username](https://stackoverflow.com/questions/9216185/nodejs-passport-display-username)。

```
app.get('/hello', function(req, res) {
    res.render('index.jade', { name: req.user.username });
}); 
```

所以用户通过 PassportJS 登录，然后转到正文`index.jade`中包含`#{name}`的 ，它将被替换为 的值`req.user.username`。

问题：是否可以使用`req.user.username`in`index.jade`的 JavaScript 的值？我尝试将其值分配给变量，但它不起作用。

我一直在使用隐藏输入`#{name}`作为值的技巧：

```
input(type='hidden', id='variableName', value='#{name}') 
```

然后 JavaScript 可以使用以下方法访问该值：

```
$("#variableName").val() 
```

这行得通。但它是否有任何潜在的缺点，如安全问题？这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T09:59:44.793

You have a few options. One of them is what you did and put the value inside you html. You can also solve it by doing:

```
script
   window.name = #{name}; 
```

This will create an inline script that sets the variable. The other option you have is using ajax. That means you probably need to make an extra route to reply to that request.

# forms - 是否有可能以班级形式（Symfony）知道动作？

> ID：10644939
> 
> 赞同：1
> 
> 时间：2012-05-17T23:43:45.047
> 
> 标签：forms, symfony1, action

是否可以知道用户在表单类级别（Form.class.php）执行的操作（新建、更新）？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T23:49:22.153

您可以检查底层对象是**新**的还是**存在**于数据库中：

`$this->getObject()->isNew()`

# php - 从数据库列中选择的选项没有结果（php-mysql）

> ID：10644950
> 
> 赞同：1
> 
> 时间：2012-05-17T23:45:07.173
> 
> 标签：php, mysql

在下面的 PHP 代码中，我想选择一个表的所有列值，并使它们成为选择表单的选项。结果是我根本没有任何选择。有人可以帮忙吗？谢谢

```
<?php
// ....

$userid=$_SESSION['userid'];
echo "<select>";
$sql = "SELECT * FROM users where userid='".$userid."'";

$result = mysql_query($sql);

while($row = mysql_fetch_array($result))
{
 echo "<option>" .$row['company']. "</option>";
}
echo "</select>";

mysqli_close();
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T01:06:34.357

这可能只是一个错字，但你混合了 mysql 和 mysqli 函数，你已经声明了 mysql_query 和 mysql_fetch_array，而你已经用 mysqli_close 关闭了它，这可能是一个问题，这取决于你在这段代码上面写的内容，或者如果这不仅仅是一个错字。

其他要尝试的事情是在您的 mysql 客户端/phpmyadmin 中尝试查询，看看它是否出现任何结果或错误。

# jquery - 多个 zclip 函数 - 只有最后一个有效

> ID：10644951
> 
> 赞同：0
> 
> 时间：2012-05-17T23:45:07.680
> 
> 标签：jquery, zeroclipboard, zclip

当用户单击按钮时，我正在使用“zclip”jquery 函数执行跨浏览器复制到剪贴板。

但是，一旦我将 zclip 功能分配给另一个按钮，第一个按钮就会停止工作。

代码是：

```
function setupClipboard(o, i) {

    o.find('.copytext').zclip({
        path: 'js/zclip/ZeroClipboard.swf',
        copy: function() {
            return $('#customtext' + i).val();
        }
    });

} 
```

您可以在这里看到问题：http: [//toolii.com/apps/the-character-counter/](http://toolii.com/apps/the-character-counter/) （在浏览器中查看 console.log 以查看它尝试复制的内容。）

你们中有人知道如何解决这个问题吗？

提前致谢！

亲切的问候，托拜厄斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T10:25:53.953

原来，每次我添加一个字段时，我只需要删除所有现有的 zclip 实例并再次插入它们。

# javascript - 在 iframe 中提交表单

> ID：10644959
> 
> 赞同：0
> 
> 时间：2012-05-17T23:45:36.213
> 
> 标签：javascript, jquery, forms, iframe

我的页面中有一个 iframe，我在其中加载具有淡入淡出效果的网站内容。
为了在 iframe 中处理表单提交，我创建了这个函数：

```
$("#coll").contents().find("form input[type=submit").bind("click",function(event)
{
      event.preventDefault();
      element=$(this).parent("form");

      if (element.attr("action") === "") {
            $("#coll").fadeOut("slow",function()
            {
                element.submit();
            });
      }
      else {
            var page = element.attr("action");
            $("#coll").fadeOut("slow", function()
            {
                $('#coll').attr("src",page);
            });
       }
       return false;
}); 
```

问题是，如果表单具有加载新页面的操作，但不会发送表单的值。哪里有问题？

具有空操作的表单可以正常运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T00:40:27.430

如果表单*没有*操作，您只调用提交。如果它确实有一个操作，您只需将 src 设置为操作页面 - 这不会提交表单，它只是更改 url。您需要调用`element.submit()`该`else`子句。

# facebook - 是否有在 ASP.NET MVC 上使用 Fb C# SDK v6 的最佳实践/示例解决方案？

> ID：10644961
> 
> 赞同：5
> 
> 时间：2012-05-17T23:45:43.593
> 
> 标签：facebook, authentication, oauth, facebook-c#-sdk

我目前正在使用 Fb C# SDK v5，像冠军一样工作。事实证明，迁移到 v6 比我预期的更具挑战性。

所以，我决定从头开始重写认证代码。这是对用户进行身份验证所需的最低要求吗？

1.  使用Fb js sdk设置appId，订阅auth事件
2.  订阅 Fb.UI auth 事件，将访问令牌传递给服务器
3.  服务器获得访问令牌后，查询图表

在 v5 中，我在 OnActionExecuting 覆盖中执行此操作，检查活动会话（如果它不活动，我将通过 Fb 重新验证）。我似乎无法让它在 v6 上像那样工作。

是否有在 ASP.NET MVC 上使用 Fb C# SDK v6 的最佳实践或示例解决方案？我想确保我做对了。我找到了一些资源，但它们看起来不像是专门针对 ASP.NET MVC 的：

1.  [编写您的第一个 Facebook 应用程序 (v6)](http://blog.prabir.me/post/Facebook-CSharp-SDK-Writing-your-First-Facebook-Application-v6.aspx)
2.  [Facebook C# SDK for ASP.NET 入门](http://csharpsdk.org/docs/web/getting-started)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T18:37:06.763

我一直在寻找相同的东西，现在我在 github 上找到了 MVC 和 Facebook v6.0 api 的示例： [https ://github.com/facebook-csharp-sdk/facebook-aspnet-sample](https://github.com/facebook-csharp-sdk/facebook-aspnet-sample)

# cocoa - Cocoa：隐藏停靠菜单中的项目

> ID：10644964
> 
> 赞同：1
> 
> 时间：2012-05-17T23:46:07.523
> 
> 标签：cocoa, dock, nsmenu

有没有办法隐藏应用程序停靠上下文菜单的“显示所有窗口”和“隐藏”项目？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-17T23:52:58.177

那没有。这些菜单项在 Dock 内部；应用程序无法控制它们。

# ruby-on-rails - 在 Cucumber 中使用 Rails 测试夹具助手

> ID：10644965
> 
> 赞同：1
> 
> 时间：2012-05-17T23:46:13.203
> 
> 标签：ruby-on-rails, cucumber

我希望能够在 Cucumber 中使用 Rails 的测试夹具助手，但 Cucumber wiki 上提供的信息似乎......充其量已经过时了：[https](https://github.com/cucumber/cucumber/wiki/Fixtures) ://github.com/cucumber/cucumber/wiki/Fixtures （标题：夹具辅助方法）

谷歌一直没有帮助。

有没有好的方法来做到这一点？

**更新**：尝试使用 ActiveRecord::TestFixtures 无济于事，这似乎是完成这项工作的课程，但无法将其正确混入世界

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T03:05:42.540

关于夹具的信息如此之少的原因之一是大多数 Rails 开发人员现在都使用[Factory Girl](https://github.com/thoughtbot/factory_girl)来生成测试数据。

Factory Girl 让您可以更好地控制生成的数据（以及创建数据的时间），但它也允许您更好地控制不可避免地需要的相关模型类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T16:59:38.460

经过一个小时的脑筋急转弯，我能够让它发挥作用。代替

```
fix = Fixtures.cached_fixtures(ActiveRecord::Base.connection, table_name)[fixture_symbol.to_s] 
```

和

```
fix = Fixtures.cached_fixtures(ActiveRecord::Base.connection, table_name).first.fixtures[fixture_symbol.to_s] 
```

我已经在[https://github.com/cucumber/cucumber/wiki/Fixtures更新了 wiki](https://github.com/cucumber/cucumber/wiki/Fixtures)

# php - 有趣的项目：PHP foreach 循环和 Scraping

> ID：10644966
> 
> 赞同：0
> 
> 时间：2012-05-17T23:46:14.593
> 
> 标签：php, loops, foreach, screen-scraping

我正在创建一个会员卡，显示从他们的个人资料网址中抓取的成员列表并作为图像输出。

描述我想要完成的事情的最佳方式是向您展示：

[这就是我想要做的。](http://lifeofstrange.com/scrape/output.jpg "最终输出")

使用[简单 HTML DOM 解析器从那里提取玩家别名、级别和排名。](http://simplehtmldom.sourceforge.net/ "简单的 HTML DOM 解析器")

到目前为止，这是我使用以下代码成功实现的目标：

[我的刮擦尝试](http://lifeofstrange.com/scrape/image.php "我的刮擦尝试")

```
<?php 
include_once('simple_html_dom.php');

function extract_numbers($string) {
    preg_match_all('/([\d]+)/', $string, $match);
    return $match[0];
}

function scraping_uberstrike($url) {
    // create HTML DOM
    $html = file_get_html($url);

 // Find rank, level and xp
    $string =  $html->find("h2 p", 0)->innertext;
    $numbers_array = extract_numbers($string);

// get name
$ret['Alias'] = $html->find('span[id="uberstrikeUserName"]', 0)->innertext;

// get level
$ret['Level'] = $numbers_array['1'];

// get rank
$ret['Rank'] = $numbers_array['0'];

// clean up memory
$html->clear();
unset($html);

return $ret;
} 
```

// 要抓取的 URL

```
$links = array (
   'http://uberstrike.cmune.com/CommonChannel/Profile?cmid=4758758&channelType=WebPortal&appCallbackUrl=http%3a%2f%2fuberstrike.cmune.com%2fProfile',
   'http://uberstrike.cmune.com/CommonChannel/Profile?cmid=5909289&channelType=WebPortal&appCallbackUrl=http%3a%2f%2fuberstrike.cmune.com%2fProfile'
 );

$image = imagecreatefrompng("eQ.png");
$color = ImageColorAllocate($image, 203,203,203);
$shadow = ImageColorAllocate($image, 25,25,25);
$font = "ColabBol.otf";

$a=2;
$b=1;

// Outputs the scrape

foreach ($links as $link) {
    $ret = scraping_uberstrike($link);
        foreach($ret as $k=>$v) {

          $a = $a + 40;
          $b = $b + 40;
            imagettftext($image, 14, 0, 106,  $a, $shadow, $font, $v);
            imagettftext($image, 14, 0, 105, $b, $color, $font, $v);
        }
} 

header("content-type: image/png");
imagepng($image);
imagedestroy($image);
?> 
```

请注意如何使用 foreach 循环定位玩家详细信息，我很难获得与我正在尝试做的 jpg 相同的输出。

必须有一些错误或不同的方法用于 foreach 循环才能正确显示详细信息。

如果这有助于您理解我的代码，我已将所有必要的文件放在一个 zip 存档中。

[http://lifeofstrange.com/scrape/scrape.zip](http://lifeofstrange.com/scrape/scrape.zip)

我希望我已经说清楚了。

并期待您的解决方案。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T00:22:21.883

抱歉，我不知道您的代码给出的输出与“some_path/output.jpg”不同。您要求陌生人解压缩文件并访问异地 URL 等。尝试使用整数来演示您的问题，或者将问题限制在一个特定的图形元素上。

解决问题的好地方是在数据收集和数据输出部分之间。如果那不是您的麻烦区域，请不要让有用的路人阅读一堆 file_get() 和正则表达式。分离输入和输出也将有助于您的程序结构。

编程的第一条规则，首先处理你的数据结构，然后去寻找漂亮的东西。在您的情况下，这意味着让您编写程序，以便您可以以某种格式读取和打印“别名”、“级别”和“排名”作为简单的标量，然后使用某种样本数据集处理图形。稍后将这两个工作部分结合起来比一堆意大利面条要容易得多。

这两行对我来说看起来很奇怪：

```
 imagettftext($image, 14, 0, 106,  $a, $shadow, $font, $v);
        imagettftext($image, 14, 0, 105, $b, $color, $font, $v); 
```

它们在 x 和 y 中相隔一个像素。这是你想要的吗？尺寸和角度也应该是浮点数（我不知道 PHP 以及它是否会投射这些）至少使用“... 14.0, 0.0,...”

这就是我能提供的所有帮助，正如我所说，我不知道 PHP。

# c++ - 在模板函数中自动将 const char[] 转换为 const char *

> ID：10644979
> 
> 赞同：6
> 
> 时间：2012-05-17T23:47:34.530
> 
> 标签：c++, templates

我遇到了模板问题，如果您尝试为模板化函数提供字符串参数，编译器会将“Hello World”解释为 const char [12]。我希望它是 const char *。

我可以通过将每个字符串静态转换为 'const char*' 来“解决”这个问题，但是由于我试图将其用作日志系统的一部分，所以让它变得简单是一个很大的目标。

由于很难解释我的意思，我想出了一个简单的复制器。您将看到 main 函数的最后一行没有编译。

任何帮助将不胜感激

```
#include <string>

// Trivial base class so we can use polymorphism
class StoreItemsBase
{
public:
    StoreItemsBase() {}
};

// Example of a trivial Templated class to hold some 3 items.
// Intent to have similar classes to hold 4,5..n items
template <typename T1, typename T2, typename T3>
class Store3Items : public StoreItemsBase
{
public:
    Store3Items(const T1& t1, const T2& t2, const T3& t3)
    :
    StoreItemsBase(),
    mT1(t1),
    mT2(t2),
    mT3(t3)
    {}

private:
    T1 mT1;
    T2 mT2;
    T3 mT3;
};

// Function to create a pointer to our object with added id
// There would be similar CreateHolderFunctions for 4,5..n items
template <typename T1, typename T2, typename T3>
StoreItemsBase* CreateHolder(const T1& t1, const T2& t2, const T3& t3)
{
    return new Store3Items<T1, T2, T3>(t1, t2, t3);
}

int main()
{
    int testInt=3;
    double testDouble=23.4;
    const std::string testStr("Hello World");

    StoreItemsBase* Ok1 = CreateHolder(testInt, testDouble, testStr);
    StoreItemsBase* Ok2 = CreateHolder(testDouble, testStr, testInt);
    StoreItemsBase* Ok3 = CreateHolder(testStr, static_cast<const char*>("Hello there"), testInt);
    // If you try a standard string, it compiler complains
    // Although I could surround all my strings with the static cast, what I am looking for is a way
    // to for the CreateHolder function to do the work for me
    StoreItemsBase* NotOk4 = CreateHolder(testStr, "Hello World", testInt);

    // Free our objects not shown in the example
} 
```

编译器错误是：

```
example.cpp：在构造函数 'Store3Items::Store3Items(const T1&, const T2&, const T3&) [with T1 = std::basic_string, T2 = char [12], T3 = int]' 中：
example.cpp:50:50: 从 'StoreItemsBase* CreateHolder(const T1&, const T2&, const T3&) [with T1 = std::basic_string, T2 = char [12], T3 = int]'
example.cpp:65:74: 从这里实例化
example.cpp:21:11: error: array used as initializer

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-17T23:58:44.157

您可以使用元函数来转换作为参数传递给模板的类型。任何字符数组都将转换为`char*`：

```
template< typename T > struct transform
{
    typedef T type;
};

template< std::size_t N > struct transform< char[N] >
{
    typedef char* type;
};
template< std::size_t N > struct transform< const char[N] >
{
    typedef const char* type;
}; 
```

然后，不是`Tn`直接使用，而是使用`typename transform< Tn >::type`.

*更新：*如果你在**C++11**中工作，那么`std::decay`你已经做了你想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:07:27.800

尝试将模板参数更改为 const T1 t1、const T2 t2、const T3 t3。它的性能会降低，但可以编译

根据模板参数决定函数参数通常很困难。你可以试试这个类构造函数签名。我使用类“arg_type”（非标准）的模板特化来确保所有不是 const 指针的参数类型都由 const ref 传递，并且所有 const 指针都作为 const 指针传递。

另外，不要忘记基类上的虚拟析构函数，否则可能会发生不好的事情:)

```
#include <string>

// Trivial base class so we can use polymorphism
class StoreItemsBase
{
public:
    StoreItemsBase() {}
    virtual ~StoreItemsBase() {}
};

template <typename TYPE> class arg_type
{
public:
    typedef const TYPE& type;
};
template <typename TYPE> class arg_type<const TYPE*>
{
public:
    typedef const TYPE* type;
};

// Example of a trivial Templated class to hold some 3 items.
// Intent to have similar classes to hold 4,5..n items
template <typename T1, typename T2, typename T3>
class Store3Items : public StoreItemsBase
{
    typedef typename arg_type<T1>::type arg1;
    typedef typename arg_type<T2>::type arg2;
    typedef typename arg_type<T3>::type arg3;
public:
    Store3Items(arg1 t1, arg2 t2, arg3 t3)
    :
    StoreItemsBase(),
    mT1(t1),
    mT2(t2),
    mT3(t3)
    {}

private:
    T1 mT1;
    T2 mT2;
    T3 mT3;
};

// Function to create a pointer to our object with added id
// There would be similar CreateHolderFunctions for 4,5..n items
template <typename T1, typename T2, typename T3>
StoreItemsBase* CreateHolder(const T1 t1, const T2 t2, const T3 t3)
{
    return new Store3Items<T1, T2, T3>(t1, t2, t3);
}

int main()
{
    int testInt=3;
    double testDouble=23.4;
    const std::string testStr("Hello World");

    StoreItemsBase* Ok1 = CreateHolder(testInt, testDouble, testStr);
    StoreItemsBase* Ok2 = CreateHolder(testDouble, testStr, testInt);
    StoreItemsBase* Ok3 = CreateHolder(testStr, static_cast<const char*>("Hello there"), testInt);
    // If you try a standard string, it compiler complains
    // Although I could surround all my strings with the static cast, what I am looking for is a way
    // to for the CreateHolder function to do the work for me
    StoreItemsBase* NotOk4 = CreateHolder(testStr, "Hello World", testInt);

    // Free our objects not shown in the example
} 
```

请记住，您的类将在内部存储原始 const char*（不存储 std::string），因此请确保传入的字符串的范围比您存储的指针寿命更长。像你的例子中的常量字符串很好，因为它们永远存在。

# windows - 代理应用程序而不使用连接（）或更改硬编码 IP

> ID：10644986
> 
> 赞同：1
> 
> 时间：2012-05-17T23:48:33.627
> 
> 标签：windows, proxy, winsock, connect

我一直想知道是否有**任何**方法可以在注入我的 dll 或更改它自身连接的硬编码 IP 地址后，在不挂钩 connect() 函数的情况下代理应用程序。

我需要它连接到更改的 IP 地址，并且由于它不使用主机名而是 IP 地址，因此我不能使用主机文件来这样做。

我需要它不仅仅是嗅探，所以使用 WinPcap 之类的东西不是一种选择。

如果**有人**能指出一些有用的东西，我将非常感激。编程语言对我来说并不重要，但请注意——我主要是在 Delphi 中编码。

在此先感谢，并欢呼！:)

编辑：我不是在寻找任何第三方应用程序，只是一种我可以在我自己的应用程序中实现的方法。

# php - PHP 未完全解析 POST 请求中的嵌套数组

> ID：10644987
> 
> 赞同：0
> 
> 时间：2012-05-17T23:48:34.237
> 
> 标签：php, post

我一直在研究这个问题超过 12 个小时，但没有成功。

我们有一个为政府客户构建的大型定制 CMS。该软件是在 PHP 5.3.3 上开发的。最初的部署是在 PHP 5.2.2 上完成的，这导致了一些问题，但他们最终将服务器升级到了 PHP 5.3.8。我们几乎无法准确控制将哪些版本部署到他们的服务器上。

我们遇到了一个显示停止器的问题。我们有一个 AJAX 请求，它通过 POST 提交一个大型表单，其中嵌套数组的深度最多为 5 级。这几个月来一直运行良好，但突然使用新的 PHP 安装，我们只获得了 $_POST 变量中数据的部分解码。我已经通过检查 php://input 确认 PHP 收到了所有数据（我还检查了数据是通过 Firebug 从浏览器发送的）。

这是我们收到的解码输出（通过 var_dump，为简洁起见，我将其缩短了，这应该给你一个好主意）

```
Array
(
    [db_required_fields] => Array
        (
            [awr_title] => Array
                (
                    [en] => phil test eng
                )

        )

    [subtitle_intro] => Array
        (
            [awr_subtitle] => Array
                (
                    [en] =>
                )

        )
[products] => Array
    (
        [cp_recall] => Array
            (
                [1] => Array
                    (
                        [product_common_name] => Array
                            (
                                [en] =>
                            )

                    )

            )

        )
) 
```

缺少什么：每个 [en] 都应该有一个 peer [fr] 数组索引条目。例如，应该有一个 [fr] phil test fr 条目。缺少第二个数组级别的其他几个索引条目。请求数据本身并不是特别大，大概6-7Kb。

我所做的： - 我禁用了 suhosin，因为它经常被提及为类似问题的原因。- 仔细研究 phpinfo(); 来自工作和现在工作的服务器，试图找出相关的差异。- 调查可能影响事物的每个模块和选项（例如，mbstring）。

我现在正在考虑为 php://input 数据编写自己的解析器，但这似乎充满了（可能隐藏的）危险。

有什么建议或提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:02:17.820

我建议在发送之前序列化发布数据。我会将它作为单个 JSON 字符串发送到一个“字段”中。像这样的东西：

```
$.ajax({
    type: 'POST',
    url: 'YOUR URL',
    data: {
        json: JSON.stringify(form_data) // Where form_data is the JSON object.
    },
    success: function(response)
    {
        // Do stuff.
    }
}); 
```

然后在服务器端，json_decode如下：

```
<?php

$_POST = json_decode($_POST['json'], true);

?> 
```

**编辑：**

你想要 json_decode 而不是反序列化。哎呀。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T15:47:22.500

您可能受到新的 PHP 配置变量[max_input_nesting_level](http://www.php.net/manual/en/info.configuration.php#ini.max-input-nesting-level)或[max_input_vars](http://www.php.net/manual/en/info.configuration.php#ini.max-input-vars)（尤其是后者）的影响。尝试将其设置为更高的值，这样 PHP 就不会开始忽略某些输入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-14T13:05:19.727

请注意，当您想要更改*max_input_vars*和*max_input_nesting_level*等设置并且运行**Suhosin**时，您还需要更改 Suhosin 的这些参数。*max_input_vars*的示例：

您需要将其添加到 .htaccess 文件中：

```
php_value suhosin.post.max_vars 4000
php_value suhosin.request.max_vars 4000 
```

您还需要将以下内容添加到您的 php.ini 文件中，以允许更改 .htaccess 中的 suhosin 参数：

```
suhosin.perdir = "pr" 
```

“p”允许更改“post”设置，“r”用于请求设置。

# objective-c - UISplitViewController 的替代品，不需要它是 rootViewController

> ID：10644992
> 
> 赞同：0
> 
> 时间：2012-05-17T23:50:26.303
> 
> 标签：objective-c, uiviewcontroller, uinavigationcontroller, uisplitviewcontroller, uisplitview

我想知道，我需要一些简单的功能，比如 UISplitViewController，我有一个主从导航。我不能使用 UISplitViewController，因为它需要关联为根视图控制器。我需要在视图中以模态方式调用它。

有没有类似的替代控制器来实现这个？

多谢你们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T17:30:18.340

看看[MGSplitViewController](http://www.google.com/url?sa=t&rct=j&q=mgsplitviewcontroller&source=web&cd=1&ved=0CFsQFjAA&url=http://mattgemmell.com/2010/07/31/mgsplitviewcontroller-for-ipad/&ei=8Ya2T5y4LMLtsgbS-sW3CA&usg=AFQjCNFmmXmDmaL7O_J8b3DMegPK57RfcA&sig2=92KdsQojF-kZASRher_nzg)。非常好，提供类似的 API。

# sql - 在 BigQuery SQL 中支持 UNION 函数

> ID：10644993
> 
> 赞同：27
> 
> 时间：2012-05-17T23:50:49.880
> 
> 标签：sql, google-bigquery, union

BigQuery 似乎还不支持 UNION： [https ://developers.google.com/bigquery/docs/query-reference](https://developers.google.com/bigquery/docs/query-reference)

（我的意思不是为了源将表联合在一起。它有。）

是不是快到了？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-05-18T01:26:53.100

如果您想要 UNION 以便可以组合查询结果，您可以在 BigQuery 中使用子选择：

```
SELECT foo, bar 
FROM
  (SELECT integer(id) AS foo, string(title) AS bar 
   FROM publicdata:samples.wikipedia limit 10),
  (SELECT integer(year) AS foo, string(state) AS bar 
   FROM publicdata:samples.natality limit 10); 
```

这几乎完全等同于 SQL

```
SELECT id AS foo, title AS bar 
FROM publicdata:samples.wikipedia limit 10
UNION ALL
SELECT year AS foo, state AS bar 
FROM publicdata:samples.natality limit 10; 
```

（请注意，如果想要 SQL UNION 而不是 UNION ALL，这将不起作用）

或者，您可以运行两个查询并附加结果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-12-11T15:12:01.570

BigQuery 最近增加了对[标准 SQL](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#union)的支持，**包括`UNION`操作**。

* * *

通过 Web UI 提交查询时，只需确保取消选中 SQL 版本标题下的“使用旧版 SQL”： [![在此处输入图像描述](../Images/9cb035999009a37a3d37d6e68ce1b5a5.png)](https://i.stack.imgur.com/EUofl.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-24T23:30:06.903

你总是可以这样做：

```
SELECT * FROM (query 1), (query 2); 
```

它与以下内容相同：

```
SELECT * from query1 UNION select * from query 2; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-12-06T00:24:00.650

请注意，如果您使用的是标准 SQL，则逗号运算符现在意味着`JOIN`-如果[您想要 union ，则*必须*使用`UNION`](https://cloud.google.com/bigquery/docs/reference/standard-sql/migrating-from-legacy-sql#comma_operator_with_tables)语法：

> 在旧版 SQL 中，逗号运算符在应用于表时具有 UNION ALL 的非标准含义。在标准 SQL 中，逗号运算符具有 JOIN 的标准含义。

例如：

```
#standardSQL
SELECT
    column_name,
    count(*)
from
    (SELECT * FROM me.table1 UNION ALL SELECT * FROM me.table2)
group by 1 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-09-13T20:26:45.733

这对我使用大查询的 StandardSQL 进行 UNION INTERSECT 非常有帮助。

```
#standardSQL
WITH
  a AS (
  SELECT
    *
  FROM
    table_a),
  b AS (
  SELECT
    *
  FROM
    table_b)
SELECT
  *
FROM
  a INTERSECT DISTINCT
SELECT
  *
FROM
  b 
```

我从以下位置窃取/修改了这个示例： [https ://gist.github.com/yancya/bf38d1b60edf972140492e3efd0955d0](https://gist.github.com/yancya/bf38d1b60edf972140492e3efd0955d0)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-08T21:09:57.943

确实支持工会。您发布的链接的摘录：

**注意：**与许多其他基于 SQL 的系统不同，BigQuery 使用逗号语法来表示表联合，而不是联合。这意味着您可以对具有兼容模式的多个表运行查询，如下所示：

// 发现几天内的可疑活动

```
SELECT FORMAT_UTC_USEC(event.timestamp_in_usec) AS time, request_url
  FROM [applogs.events_20120501], [applogs.events_20120502], [applogs.events_20120503]
  WHERE event.username = 'root' AND NOT event.source_ip.is_internal; 
```

# java - 在 Android 上，SQLiteDatabase.Insert() 或 SQLiteDatabase.execSQL() 哪个更快？

> ID：10644996
> 
> 赞同：2
> 
> 时间：2012-05-17T23:51:06.840
> 
> 标签：java, android, sql, sqlite

您好，我想知道在 Android 上哪种方法更快。

我有一个处理数千行的循环，我认为该`SQLiteDatabase.insert()`方法会影响性能。

在插入方法中，我放置了一个参数，`contentvalues`我认为在后台该方法必须有一个过程来检查每个`contentvalue`并构建查询。

相反，在该`execSQL`方法中，我将整个查询作为参数，我认为该方法不必执行太多操作即可执行它。

我不知道我是否正确，我认为这`execSQL`比插入大量数据要好，但我不确定......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T13:46:03.290

好吧，我试过了，它们之间有一点区别...... execSQL 更快，但很难注意到它。

然而，我真正的问题是我没有使用交易。由于 sqlite 没有服务器来控制对数据的访问，因此每次插入时，sqlite 都必须关闭并重新打开物理文件。因此，如果您在循环中有一千个插入并且没有事务，它将执行一千个事务。在我的测试中，一千次插入持续了 11 秒而不使用事务，而使用事务只持续了 1 秒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:59:56.570

很可能你不会看到任何区别。大部分时间都花在将数据实际写入数据库中，查询生成是相当简单的一步。如果您想自己查看差异，我建议您使用两种方式对插入进行计时。

# xml - xml到r数据提取

> ID：10644998
> 
> 赞同：3
> 
> 时间：2012-05-17T23:51:36.030
> 
> 标签：xml, r, xml-parsing

我需要从 xml 文件中提取数据并绘制以下图表：深度与时间戳。标题应该是 IFC 代码。我尝试使用 xmlToList 和 xmlTodataframe，但我没有这样做。我需要帮助。我的 xml 文件看起来像

```
 <document>
    <site>
       <IFC_code>HONEYCR01</IFC_code>
       <Latitude>41.960161</Latitude>
       <Longitude>-90.470759</Longitude>
       <River>Honey Creek</River>
       <Road>Hwy 136, 1st Street</Road>
       <Town>Charlotte</Town>
       <from_sensor_to_river_bottom>9.35</from_sensor_to_river_bottom>
       <Unit>foot</Unit>
    </site>
    <data>
       <value>
          <timestamp>2012-05-17 15:30:03-05</timestamp>
          <depth>8.53</depth>
       </value>
       <value>
          <timestamp>2012-05-17 14:30:06-05</timestamp>
          <depth>8.50</depth>
       </value>
       <value>
          <timestamp>2012-05-17 14:15:02-05</timestamp>
          <depth>8.51</depth>
       </value>
       <value>
          <timestamp>2012-05-17 14:00:12-05</timestamp>
          <depth>8.50</depth>
       </value>
       <value>
          <timestamp>2012-05-17 13:45:08-05</timestamp>
          <depth>8.51</depth>
       </value>
      </data>
    </document> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T00:18:52.580

它似乎工作：

```
library(XML)
doc <- xmlParse("a.xml")
xmlToDataFrame(
  getNodeSet(doc, "//value"),
  colClasses=c("character","numeric")
) 
```