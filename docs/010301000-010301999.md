# StackOverflow 问答 10301000-10301999

# python - Python 连接组件

> ID：10301000
> 
> 赞同：14
> 
> 时间：2012-04-24T15:23:37.413
> 
> 标签：python, graph-algorithm, connected-components

我正在`get_connected_components`为一个类编写一个函数`Graph`：

```
def get_connected_components(self):
    path=[]
    for i in self.graph.keys():
        q=self.graph[i]
        while q:
            print(q)
            v=q.pop(0)
            if not v in path:
                path=path+[v]
    return path 
```

我的图表是：

```
{0: [(0, 1), (0, 2), (0, 3)], 1: [], 2: [(2, 1)], 3: [(3, 4), (3, 5)], \
4: [(4, 3), (4, 5)], 5: [(5, 3), (5, 4), (5, 7)], 6: [(6, 8)], 7: [], \
8: [(8, 9)], 9: []} 
```

其中键是节点，值是边。我的函数给了我这个连接的组件：

```
[(0, 1), (0, 2), (0, 3), (2, 1), (3, 4), (3, 5), (4, 3), (4, 5), (5, 3), \
(5, 4), (5, 7), (6, 8), (8, 9)] 
```

但是我会有两个不同的连接组件，例如：

```
[[(0, 1), (0, 2), (0, 3), (2, 1), (3, 4), (3, 5), (4, 3), (4, 5), \
(5, 3), (5, 4), (5, 7)],[(6, 8), (8, 9)]] 
```

我不明白我在哪里犯了错误。谁能帮我？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-12T09:52:22.823

我喜欢这个算法：

```
def connected_components(neighbors):
    seen = set()
    def component(node):
        nodes = set([node])
        while nodes:
            node = nodes.pop()
            seen.add(node)
            nodes |= neighbors[node] - seen
            yield node
    for node in neighbors:
        if node not in seen:
            yield component(node) 
```

它不仅简短优雅，而且速度很快。像这样使用它（Python 2.7）：

```
old_graph = {
    0: [(0, 1), (0, 2), (0, 3)],
    1: [],
    2: [(2, 1)],
    3: [(3, 4), (3, 5)],
    4: [(4, 3), (4, 5)],
    5: [(5, 3), (5, 4), (5, 7)],
    6: [(6, 8)],
    7: [],
    8: [(8, 9)],
    9: []}

edges = {v for k, vs in old_graph.items() for v in vs}
graph = defaultdict(set)

for v1, v2 in edges:
    graph[v1].add(v2)
    graph[v2].add(v1)

components = []
for component in connected_components(graph):
    c = set(component)
    components.append([edge for edges in old_graph.values()
                            for edge in edges
                            if c.intersection(edge)])

print(components) 
```

结果是：

```
[[(0, 1), (0, 2), (0, 3), (2, 1), (3, 4), (3, 5), (4, 3), (4, 5), (5, 3), (5, 4), (5, 7)],
 [(6, 8), (8, 9)]] 
```

谢谢，aparpara 发现了这个错误。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-01T11:32:38.810

让我们简化图形表示：

```
myGraph = {0: [1,2,3], 1: [], 2: [1], 3: [4,5],4: [3,5], 5: [3,4,7], 6: [8], 7: [],8: [9], 9: []} 
```

这里我们有一个函数返回一个字典，它的键是根，值是连接的组件：

```
def getRoots(aNeigh):
    def findRoot(aNode,aRoot):
        while aNode != aRoot[aNode][0]:
            aNode = aRoot[aNode][0]
        return (aNode,aRoot[aNode][1])
    myRoot = {} 
    for myNode in aNeigh.keys():
        myRoot[myNode] = (myNode,0)  
    for myI in aNeigh: 
        for myJ in aNeigh[myI]: 
            (myRoot_myI,myDepthMyI) = findRoot(myI,myRoot) 
            (myRoot_myJ,myDepthMyJ) = findRoot(myJ,myRoot) 
            if myRoot_myI != myRoot_myJ: 
                myMin = myRoot_myI
                myMax = myRoot_myJ 
                if  myDepthMyI > myDepthMyJ: 
                    myMin = myRoot_myJ
                    myMax = myRoot_myI
                myRoot[myMax] = (myMax,max(myRoot[myMin][1]+1,myRoot[myMax][1]))
                myRoot[myMin] = (myRoot[myMax][0],-1) 
    myToRet = {}
    for myI in aNeigh: 
        if myRoot[myI][0] == myI:
            myToRet[myI] = []
    for myI in aNeigh: 
        myToRet[findRoot(myI,myRoot)[0]].append(myI) 
    return myToRet 
```

让我们尝试一下：

```
print getRoots(myGraph) 
```

{8: [6, 8, 9], 1: [0, 1, 2, 3, 4, 5, 7]}

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-06-01T08:31:45.297

前面的答案很棒。无论如何，我花了一点时间才明白发生了什么。因此，我以更易于阅读的方式重构了代码。我把代码留在这里，以防有人发现它也更容易（它在 python 3.6 中运行）

```
def get_all_connected_groups(graph):
    already_seen = set()
    result = []
    for node in graph:
        if node not in already_seen:
            connected_group, already_seen = get_connected_group(node, already_seen)
            result.append(connected_group)
    return result

def get_connected_group(node, already_seen):
        result = []
        nodes = set([node])
        while nodes:
            node = nodes.pop()
            already_seen.add(node)
            nodes = nodes or graph[node] - already_seen
            result.append(node)
        return result, already_seen

graph = {
     0: {0, 1, 2, 3},
     1: set(),
     2: {1, 2},
     3: {3, 4, 5},
     4: {3, 4, 5},
     5: {3, 4, 5, 7},
     6: {6, 8},
     7: set(),
     8: {8, 9},
     9: set()}

components = get_all_connected_groups(graph)
print(components) 
```

结果：

```
Out[0]: [[0, 1, 2, 3, 4, 5, 7], [6, 8, 9]] 
```

另外，我简化了输入和输出。我认为打印组中的所有节点会更清楚一些

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-21T12:45:45.950

如果您使用[邻接列表](https://en.wikipedia.org/wiki/Adjacency_list)表示图形，则可以使用此生成器函数（实现[BFS](https://en.wikipedia.org/wiki/Breadth-first_search)）来获取所有连接的组件：

```
from collections import deque

def connected_components(graph):
    seen = set()

    for root in range(len(graph)):
        if root not in seen:
            seen.add(root)
            component = []
            queue = deque([root])

            while queue:
                node = queue.popleft()
                component.append(node)
                for neighbor in graph[node]:
                    if neighbor not in seen:
                        seen.add(neighbor)
                        queue.append(neighbor)
            yield component 
```

演示：

```
graph = [
    [1, 2, 3],  # neighbors of node "0"
    [0, 2],     # neighbors of node "1"
    [0, 1],     # ...
    [0, 4, 5],
    [3, 5],
    [3, 4, 7],
    [8],
    [5],
    [9, 6],
    [8]
]

print(list(connected_components(graph)))  # [[0, 1, 2, 3, 4, 5, 7], [6, 8, 9]] 
```

# math - 从给定点垂直于线段

> ID：10301001
> 
> 赞同：28
> 
> 时间：2012-04-24T15:23:38.070
> 
> 标签：math, 3d, geometry

我想计算给定线上与给定点垂直的点。

我有一条线段 AB 并且在线段之外有一个点 C。我想计算 AB 上的点 D，使得 CD 垂直于 AB。

![找到点 D](../Images/ca45764151f704c69a3bf1c88c69d20d.png)

我必须找到 D 点。

[它与此](https://stackoverflow.com/questions/1811549/perpendicular-on-a-line-from-a-given-point)非常相似，但我也想考虑 Z 坐标，因为它在 3D 空间中没有正确显示。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-03-03T15:56:40.560

证明：点D在垂直于AB的直线CD上，当然D属于AB。写下两个向量 CD.AB = 0 的点积，并将 D 属于 AB 的事实表示为 D=A+t(BA)。

我们最终得到 3 个方程：

```
 Dx=Ax+t(Bx-Ax)
 Dy=Ay+t(By-Ay)
(Dx-Cx)(Bx-Ax)+(Dy-Cy)(By-Ay)=0 
```

将前两个方程代入第三个方程得到：

```
(Ax+t(Bx-Ax)-Cx)(Bx-Ax)+(Ay+t(By-Ay)-Cy)(By-Ay)=0 
```

分布求解 t 给出：

```
(Ax-Cx)(Bx-Ax)+t(Bx-Ax)(Bx-Ax)+(Ay-Cy)(By-Ay)+t(By-Ay)(By-Ay)=0 
```

这使：

```
t= -[(Ax-Cx)(Bx-Ax)+(Ay-Cy)(By-Ay)]/[(Bx-Ax)^2+(By-Ay)^2] 
```

摆脱负面迹象：

```
t=[(Cx-Ax)(Bx-Ax)+(Cy-Ay)(By-Ay)]/[(Bx-Ax)^2+(By-Ay)^2] 
```

一旦你有了 t，你就可以从前两个方程中计算出 D 的坐标。

```
 Dx=Ax+t(Bx-Ax)
 Dy=Ay+t(By-Ay) 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-09-19T17:01:44.480

```
function getSpPoint(A,B,C){
    var x1=A.x, y1=A.y, x2=B.x, y2=B.y, x3=C.x, y3=C.y;
    var px = x2-x1, py = y2-y1, dAB = px*px + py*py;
    var u = ((x3 - x1) * px + (y3 - y1) * py) / dAB;
    var x = x1 + u * px, y = y1 + u * py;
    return {x:x, y:y}; //this is D
} 
```

![问题](../Images/ca45764151f704c69a3bf1c88c69d20d.png)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-24T16:01:05.470

使用矢量点积有一个简单的封闭形式解决方案（不需要循环或近似）。

将您的点想象为向量，其中点 A 位于原点 (0,0)，并且所有其他点都从中引用（您可以通过从每个点中减去点 A 轻松地将您的点转换到该参考系）。

在这个参考系中，点 D 只是点 C 在向量 B 上的[向量投影](http://en.wikipedia.org/wiki/Vector_projection)，表示为：

```
// Per wikipedia this is more efficient than the standard (A . Bhat) * Bhat
Vector projection = Vector.DotProduct(A, B) / Vector.DotProduct(B, B) * B 
```

结果向量可以通过向其添加点 A 转换回原始坐标系。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-24T18:01:42.267

AB线上的一个点可以通过以下方式参数化：

M(x)=A+x*(BA)，对于 x 实数。

您希望 D=M(x) 使得 DC 和 AB 是正交的：

点（BA，CM（x））=0。

即：dot(BA,CAx*(BA))=0，或dot(BA,CA)=x*dot(BA,BA)，给出：

x=dot(BA,CA)/dot(BA,BA)，除非 A=B，否则定义。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-24T15:57:30.530

您正在尝试做的事情称为[矢量投影](http://en.wikipedia.org/wiki/Vector_projection)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-03-19T07:38:21.760

对于在 C# 中可能需要此功能的任何人，我将为您节省一些时间：

```
double Ax = ;
double Ay = ;
double Az = ;

double Bx = ;
double By = ;
double Bz = ;

double Cx = ;
double Cy = ;
double Cz = ; 

double t = ((Cx - Ax) * (Bx - Ax) + (Cy - Ay) * (By - Ay)) / (Math.Pow(Bx - Ax, 2) + Math.Pow(By - Ay, 2));

double Dx = Ax + t*(Bx - Ax);
double Dy = Ay + t*(By - Ay); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-12-30T03:33:13.980

这是另一个不使用 for 循环的 python 实现。它适用于任意数量的点和任意数量的线段。给定**p_array**作为一组点，并将**x_array**，**y_array**作为连续线段或折线。

这使用方程 Y = mX + n 并考虑到垂直线段的 m 因子为 -1/m。

```
 import numpy as np

      def ortoSegmentPoint(self, p_array, x_array, y_array):
            """

            :param p_array: np.array([[ 718898.941  9677612.901 ], [ 718888.8227 9677718.305 ], [ 719033.0528 9677770.692 ]])
            :param y_array: np.array([9677656.39934991 9677720.27550726 9677754.79])
            :param x_array: np.array([718895.88881594 718938.61392781 718961.46])
            :return: [POINT, LINE] indexes where point is orthogonal to line segment
            """
            # PENDIENTE "m" de la recta, y = mx + n
            m_array = np.divide(y_array[1:] - y_array[:-1], x_array[1:] - x_array[:-1])
            # PENDIENTE INVERTIDA, 1/m
            inv_m_array = np.divide(1, m_array)
            # VALOR "n", y = mx + n
            n_array = y_array[:-1] - x_array[:-1] * m_array
            # VALOR "n_orto" PARA LA RECTA PERPENDICULAR
            n_orto_array = np.array(p_array[:, 1]).reshape(len(p_array), 1) + inv_m_array * np.array(p_array[:, 0]).reshape(len(p_array), 1)
            # PUNTOS DONDE SE INTERSECTAN DE FORMA PERPENDICULAR
            x_intersec_array = np.divide(n_orto_array - n_array, m_array + inv_m_array)
            y_intersec_array = m_array * x_intersec_array + n_array
            # LISTAR COORDENADAS EN PARES
            x_coord = np.array([x_array[:-1], x_array[1:]]).T
            y_coord = np.array([y_array[:-1], y_array[1:]]).T
            # FILAS: NUMERO DE PUNTOS, COLUMNAS: NUMERO DE TRAMOS
            maskX = np.where(np.logical_and(x_intersec_array < np.max(x_coord, axis=1), x_intersec_array > np.min(x_coord, axis=1)), True, False)
            maskY = np.where(np.logical_and(y_intersec_array < np.max(y_coord, axis=1), y_intersec_array > np.min(y_coord, axis=1)), True, False)
            mask = maskY * maskX
            return np.argwhere(mask == True) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-09T11:50:17.283

在这里，我已将回答的代码从“cuixiping”转换为 matlab 代码。

```
function Pr=getSpPoint(Line,Point)
% getSpPoint(): find Perpendicular on a line segment from a given point
x1=Line(1,1);
y1=Line(1,2);
x2=Line(2,1);
y2=Line(2,1);
x3=Point(1,1);
y3=Point(1,2);

px = x2-x1;
py = y2-y1;
dAB = px*px + py*py;

u = ((x3 - x1) * px + (y3 - y1) * py) / dAB;
x = x1 + u * px;
y = y1 + u * py;

Pr=[x,y];

end 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-12-21T05:12:18.843

我没有看到这个答案，但 Ron Warholic 对矢量投影提出了一个很好的建议。ACD 只是一个直角三角形。

1.  创建向量 AC 即 (Cx - Ax, Cy - Ay)
2.  创建向量 AB 即 (Bx - Ax, By - Ay)
3.  AC 和 AB 的点积等于向量之间夹角的余弦值。即 cos(theta) = ACx*ABx + ACy*ABy。
4.  向量的长度是 sqrt(x*x + y*y)
5.  AD 的长度 = cos(theta)*length(AC)
6.  归一化 AB 即 (ABx/length(AB), ABy/length(AB))
7.  D = A + NAB*长度（AD）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-02-03T00:47:58.460

这是一个基于 Corey Ogburn[对此线程](https://stackoverflow.com/questions/15232356/projection-of-a-point-on-line-defined-by-2-points#)的回答的 python 实现。
它将点投影到由点定义并产生点**`q`**的线段上。如果超出线段 ，它将返回 null ：**`p1`****`p2`****`r`**
**`r`**

```
def is_point_on_line(p1, p2, q):

    if (p1[0] == p2[0]) and (p1[1] == p2[1]):
        p1[0] -= 0.00001

    U = ((q[0] - p1[0]) * (p2[0] - p1[0])) + ((q[1] - p1[1]) * (p2[1] - p1[1]))
    Udenom = math.pow(p2[0] - p1[0], 2) + math.pow(p2[1] - p1[1], 2)
    U /= Udenom

    r = [0, 0]
    r[0] = p1[0] + (U * (p2[0] - p1[0]))
    r[1] = p1[1] + (U * (p2[1] - p1[1]))

    minx = min(p1[0], p2[0])
    maxx = max(p1[0], p2[0])
    miny = min(p1[1], p2[1])
    maxy = max(p1[1], p2[1])

    is_valid = (minx <= r[0] <= maxx) and (miny <= r[1] <= maxy)

    if is_valid:
        return r
    else:
        return None 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-04-24T15:31:58.813

由于您没有说明您使用的是哪种语言，所以我会给您一个通用的答案：

只需有一个循环穿过 AB 段中的所有点，从它们“画一个段”到 C，得到从 C 到 D 和从 A 到 D 的距离，然后应用 Pithagoras 定理。如果 AD^2 + CD^2 = AC^2，那么你找到了你的观点。

此外，您可以通过从最短边（考虑 AD 和 BD 边）开始循环来优化代码，因为您会更早地找到该点。

# embedded - 在 PIC32 上实现 SPI 从 ISR？

> ID：10301002
> 
> 赞同：1
> 
> 时间：2012-04-24T15:23:40.883
> 
> 标签：embedded, microcontroller, interrupt, pic, spi

我有两个[PIC32MX](http://ww1.microchip.com/downloads/en/DeviceDoc/61156G.pdf)微控制器，它们通过 1.53MHz [SPI 总线](http://ww1.microchip.com/downloads/en/DeviceDoc/61106G.pdf)与片选连接。我无法让我的从端中断服务程序正确传输数据。作为一个测试用例，我让主机每 10 毫秒发送两个字节（0x01、0x00）。当主机发送第二个字节（虚拟 0x00）时，从机应该接收 0x01 命令 id 并以 0x02 响应。

理想情况下，每次传输都应该是这样的。
主从
0x01 0x00
0x00 0x02

不过，我真的不确定从哪里开始从属中断。我正在使用一个名为 airsysTx 的 fifo 缓冲区来保存下次主机发出请求时需要移出的数据。从机接收到来自主机的 0x01 就好了，并在收到时将 0x02 写入 fifo 缓冲区。我不确定如何对中断进行编码，以便确保正确传输。我下面的代码是一个好的开始，但它是错误的。建议？

```
/*******************************************************************************
 * Interrupt service routine for SPI3 interrupts from Air MCU.
 * The user's code at this vector should perform any application specific
 * operations and MUST clear the SPI3 interrupt flags before exiting.
 ******************************************************************************/
void    __ISR(_SPI_3_VECTOR, ipl7) _SPI3Interrupt()
{
    BYTE MasterCMD;

    SET_D1();//Set debug LED

    // RX INTERRUPT
    if(IFS0bits.SPI3RXIF) // receive data available in SPI3BUF Rx buffer
    {
        MasterCMD = SPI3BUF;
        if(AirCMD == 0x01)
        {
            airsysTxFlush();
            airsysTxWrite(0x02);
        }
    }

    //Transmit data if needed.
    if(SPI3STATbits.SPITBE)
    {
        if(!airsysTxIsEmpty())
        {
            SPI3BUF = airsysTxRead();
        }
        else
        {
            //Else write 0 to the tx buffer to clear the spi shift reg
            SPI3BUF = 0x00;
        }
    }

    IFS0bits.SPI3RXIF = 0;
    IFS0bits.SPI3TXIF = 0;
    IFS0bits.SPI3EIF = 0;
    SPI3STATbits.SPIROV = 0;// clear the Overflow
    CLEAR_D1();//CLEAR Debug LED

} // end ISR 
```

这段代码实际传输的是这样的：

理想情况下，每次传输都应该是这样的。
主从
0x01 0x02
0x00 0x01

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T17:01:26.057

通常，您无法编写从属 SPI 驱动程序以您描述的方式进行交互，因为您无法作为从属设备精确控制时序。是什么生成了您的 ISR，它是来自主机的第一个字节的 Rx 还是芯片选择的断言？

作为从机，您需要在主机开始事务之前设置好要传输的数据字节。您通常没有时间对第一个字节做出反应。有几种方法可以做到这一点：

1）您可以使用协议，其中主机执行 1 或 2 字节的只写事务，告诉从机它想要读取什么。然后master等待几毫秒，让slave准备响应。然后master做一个只读事务来获取slave的响应。

2) 如果使用 DMA 或 FIFO，从机在主机开始事务之前将第一个填充字节预加载到 fifo。然后，当您获得 ISR 时，您将剩余的响应数据放入 fifo（没有刷新）。在形成响应时，您需要有足够的填充字节来适应从 ISR 延迟。例如，您可以定义您的协议，其中 master 知道响应的前 N ​​个字节是填充字节，然后是响应数据。填充要求取决于您的主时钟速度和从 CPU 速度/中断延迟。

# c# - Treeview 动态填充

> ID：10301003
> 
> 赞同：0
> 
> 时间：2012-04-24T15:23:43.303
> 
> 标签：c#, asp.net, treeview, logic

我需要填充一个`treeview`in`asp.net`并且我需要一个递归函数来在树视图上插入所有节点和子节点。

我有两种方法：

```
GetRootPage() 
```

`GetPagesByParent(Page parent)`-> 返回`IEnumerable<Page>`带有子页面的 a。

任何人都可以帮助我使用递归逻辑来构建树吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T17:20:36.953

我真诚地希望这不是一个家庭作业问题。话虽这么说，这样的事情应该让你开始：

> **免责声明：** 我没有对此进行测试或验证，仅作为粗略示例

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
    {
        var pages = GetPagesByParent(Page);
        if (pages.Count() > 0)
        {
            var roots = pages.Where(p => p.Parent == null);
            foreach (var root in roots)
            {
                //add the root nodes to the tree
                var rootNode = new TreeNode(root.Title);
                tree.Nodes.Add(rootNode);

                //kick off the recursive population
                PopulateChildNodes(pages, root, rootNode);
            }
        }
    }
}

protected void PopulateChildNodes(IEnumerable<Page> pages, Page parent, TreeNode parentNode)
{
    var childPages = pages.Where(p => p.Parent == parent);
    foreach (var page in pages)
    {
        var pageNode = new TreeNode(page.Title);
        parentNode.Nodes.Add(pageNode);

        //populate the children of the pageNode
        PopulateChildNodes(pages, page, pageNode);
    }
} 
```

# c++ - 是否有在 Visual Studio 2010 中自动包含课程的快捷方式？

> ID：10301006
> 
> 赞同：3
> 
> 时间：2012-04-24T15:23:49.450
> 
> 标签：c++, visual-studio-2010

最后，我在 Eclipse 中使用了很多 Java，并且习惯了自动添加导入的++快捷方式`ctrl`。现在我回到了使用 Visual Studio 2010 进行 C++ 编码，我有点恼火没有这样的快捷方式（或者我可能错过了它）。`alt``o`

这必须是可能的，因为 Intellisense 检测到我想要使用的类并在我声明一个新变量时向我展示所有可能性，它必须知道需要的标头在哪里。

该功能似乎存在于 Visual Studio 插件中：[Visual Assist](http://www.wholetomato.com/products/features/autoUsing.asp) X。

编辑：关于[这篇文章](http://social.msdn.microsoft.com/Forums/en/vcprerelease/thread/4830c9e3-c39d-4404-a991-9e5e990cca4f)，VS2010 中似乎缺少该功能。这正是我正在寻找的功能：`#include <set>`在我编写的代码中的某处`std::set<int> myset;`或任何自定义类中自动添加时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T15:33:33.397

When your caret is on the class name itself you can press `ctrl` + `.` (that's a period) This will bring up a list of potential import matches. Select the one you want and press enter.

This only works if the assembly containing the class is referenced in the project itself.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:26:25.007

上下文菜单键 -> 解决 -> 选择正确的类。

# facebook - 发布操作和聚合管理

> ID：10301008
> 
> 赞同：1
> 
> 时间：2012-04-24T15:23:57.230
> 
> 标签：facebook, web, facebook-opengraph

几天前，我们推出了 Facebook 时间线集成。除了用户的反馈，我们还有几个问题。

*   某人必须在 Facebook 上发布多少操作才能看到它们组合在一个专用的 Scoop.it 框而不是最近的活动框？

*   每次发布新帖子时，是否有设置在时间轴顶部显示该框（因为现在它卡在时间轴中间首次出现的同一位置）？

*   有什么方法可以管理 Facebook 上的聚合显示吗？（不仅仅是要使用的模板，还有时间轴内的位置）

非常感谢你们。

# vba - 突出显示（不删除）重复的句子或短语

> ID：10301009
> 
> 赞同：10
> 
> 时间：2012-04-24T15:24:11.757
> 
> 标签：vba, ms-word

我的印象是，这在单词中是不可能的，但我想如果你在一篇很长的论文中寻找任何 3-4 个以相同顺序出现的单词，我可以找到相同短语的重复项。

我从过去的论文中复制并粘贴了很多文档，并希望找到一种简单的方法来在这个 40 多页的文档中找到任何重复的信息，有很多不同的格式，但我愿意暂时摆脱格式的顺序寻找重复的信息。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-24T04:07:01.630

要突出显示所有重复的句子，您还可以使用`ActiveDocument.Sentences(i)`. 这是一个例子

**逻辑**

**1）**从数组中获取word文档中的所有句子

**2)**对数组进行排序

**3)**提取重复项

**4)**突出显示重复项

**代码**

```
Option Explicit

Sub Sample()
    Dim MyArray() As String
    Dim n As Long, i As Long
    Dim Col As New Collection
    Dim itm

    n = 0
    '~~> Get all the sentences from the word document in an array
    For i = 1 To ActiveDocument.Sentences.Count
        n = n + 1
        ReDim Preserve MyArray(n)
        MyArray(n) = Trim(ActiveDocument.Sentences(i).Text)
    Next

    '~~> Sort the array
    SortArray MyArray, 0, UBound(MyArray)

    '~~> Extract Duplicates
    For i = 1 To UBound(MyArray)
        If i = UBound(MyArray) Then Exit For
        If InStr(1, MyArray(i + 1), MyArray(i), vbTextCompare) Then
            On Error Resume Next
            Col.Add MyArray(i), """" & MyArray(i) & """"
            On Error GoTo 0
        End If
    Next i

    '~~> Highlight duplicates
    For Each itm In Col
        Selection.Find.ClearFormatting
        Selection.HomeKey wdStory, wdMove
        Selection.Find.Execute itm
        Do Until Selection.Find.Found = False
            Selection.Range.HighlightColorIndex = wdPink
            Selection.Find.Execute
        Loop
    Next
End Sub

'~~> Sort the array
Public Sub SortArray(vArray As Variant, i As Long, j As Long)
  Dim tmp As Variant, tmpSwap As Variant
  Dim ii As Long, jj As Long

  ii = i: jj = j: tmp = vArray((i + j) \ 2)

  While (ii <= jj)
     While (vArray(ii) < tmp And ii < j)
        ii = ii + 1
     Wend
     While (tmp < vArray(jj) And jj > i)
        jj = jj - 1
     Wend
     If (ii <= jj) Then
        tmpSwap = vArray(ii)
        vArray(ii) = vArray(jj): vArray(jj) = tmpSwap
        ii = ii + 1: jj = jj - 1
     End If
  Wend
  If (i < jj) Then SortArray vArray, i, jj
  If (ii < j) Then SortArray vArray, ii, j
End Sub 
```

**快照**

**前**

![在此处输入图像描述](../Images/2a4249fd2e318e51f1c19487e752b7d8.png)

**后**

![在此处输入图像描述](../Images/de32adada6357369c254fca48763fc63.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-20T15:05:21.713

我没有使用我自己的 DAWG 建议，我仍然有兴趣看看其他人是否有办法做到这一点，但我能够想出这个：

```
Option Explicit

Sub test()
Dim ABC As Scripting.Dictionary
Dim v As Range
Dim n As Integer
    n = 5
    Set ABC = FindRepeatingWordChains(n, ActiveDocument)
    ' This is a dictionary of word ranges (not the same as an Excel range) that contains the listing of each word chain/phrase of length n (5 from the above example).
    ' Loop through this collection to make your selections/highlights/whatever you want to do.
    If Not ABC Is Nothing Then
        For Each v In ABC
            v.Font.Color = wdColorRed
        Next v
    End If
End Sub

' This is where the real code begins.
Function FindRepeatingWordChains(ChainLenth As Integer, DocToCheck As Document) As Scripting.Dictionary
Dim DictWords As New Scripting.Dictionary, DictMatches As New Scripting.Dictionary
Dim sChain As String
Dim CurWord As Range
Dim MatchCount As Integer
Dim i As Integer

    MatchCount = 0

    For Each CurWord In DocToCheck.Words
        ' Make sure there are enough remaining words in our document to handle a chain of the length specified.
        If Not CurWord.Next(wdWord, ChainLenth - 1) Is Nothing Then
            ' Check for non-printing characters in the first/last word of the chain.
            ' This code will read a vbCr, etc. as a word, which is probably not desired.
            ' However, this check does not exclude these 'words' inside the chain, but it can be modified.
            If CurWord <> vbCr And CurWord <> vbNewLine And CurWord <> vbCrLf And CurWord <> vbLf And CurWord <> vbTab And _
                CurWord.Next(wdWord, ChainLenth - 1) <> vbCr And CurWord.Next(wdWord, ChainLenth - 1) <> vbNewLine And _
                CurWord.Next(wdWord, ChainLenth - 1) <> vbCrLf And CurWord.Next(wdWord, ChainLenth - 1) <> vbLf And _
                CurWord.Next(wdWord, ChainLenth - 1) <> vbTab Then
                sChain = CurWord
                For i = 1 To ChainLenth - 1
                    ' Add each word from the current word through the next ChainLength # of words to a temporary string.
                    sChain = sChain & " " & CurWord.Next(wdWord, i)
                Next i

                ' If we already have our temporary string stored in the dictionary, then we have a match, assign the word range to the returned dictionary.
                ' If not, then add it to the dictionary and increment our index.
                If DictWords.Exists(sChain) Then
                    MatchCount = MatchCount + 1
                    DictMatches.Add DocToCheck.Range(CurWord.Start, CurWord.Next(wdWord, ChainLenth - 1).End), MatchCount
                Else
                    DictWords.Add sChain, sChain
                End If
            End If
        End If
    Next CurWord

    ' If we found any matching results, then return that list, otherwise return nothing (to be caught by the calling function).
    If DictMatches.Count > 0 Then
        Set FindRepeatingWordChains = DictMatches
    Else
        Set FindRepeatingWordChains = Nothing
    End If

End Function 
```

`TheStory.txt`我已经在来自[这个来源](http://www.anc.org/OANC/index.html#download)的 258 页文档 () 上对此进行了测试，并且它只运行了几分钟。

用法见`test()`子。

您需要参考 Microsoft Scripting Runtime 才能使用这些`Scripting.Dictionary`对象。如果这是不可取的，可以进行小的修改来`Collections`代替，但我更喜欢它，`Dictionary`因为它有有用的`.Exists()`方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-25T17:12:11.767

我选择了一个相当蹩脚的理论，但它似乎有效（至少如果我的问题是正确的，因为有时我的理解力很慢）。我将整个文本加载到一个字符串中，将单个单词加载到一个数组中，遍历数组并连接字符串，每次包含三个连续的单词。
由于结果已包含在 3 个词组中，因此将自动识别 4 个或更多词组。

```
Option Explicit

Sub Find_Duplicates()

On Error GoTo errHandler

Dim pSingleLine                     As Paragraph
Dim sLine                           As String
Dim sFull_Text                      As String
Dim vArray_Full_Text                As Variant

Dim sSearch_3                       As String
Dim lSize_Array                     As Long
Dim lCnt                            As Long
Dim lCnt_Occurence                  As Long

'Create a string from the entire text
For Each pSingleLine In ActiveDocument.Paragraphs
    sLine = pSingleLine.Range.Text
    sFull_Text = sFull_Text & sLine
Next pSingleLine

'Load the text into an array
vArray_Full_Text = sFull_Text
vArray_Full_Text = Split(sFull_Text, " ")
lSize_Array = UBound(vArray_Full_Text)

For lCnt = 1 To lSize_Array - 1
    lCnt_Occurence = 0
    sSearch_3 = Trim(fRemove_Punctuation(vArray_Full_Text(lCnt - 1) & _
                    " " & vArray_Full_Text(lCnt) & _
                    " " & vArray_Full_Text(lCnt + 1)))

    With Selection.Find
        .Text = sSearch_3
        .Forward = True
        .Replacement.Text = ""
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False

        Do While .Execute

            lCnt_Occurence = lCnt_Occurence + 1
            If lCnt_Occurence > 1 Then
                Selection.Range.Font.Color = vbRed
            End If
            Selection.MoveRight
        Loop
    End With

    Application.StatusBar = lCnt & "/" & lSize_Array
Next lCnt

errHandler:
Stop

End Sub

Public Function fRemove_Punctuation(sString As String) As String

Dim vArray(0 To 8)      As String
Dim lCnt                As Long

vArray(0) = "."
vArray(1) = ","
vArray(2) = ","
vArray(3) = "?"
vArray(4) = "!"
vArray(5) = ";"
vArray(6) = ":"
vArray(7) = "("
vArray(8) = ")"

For lCnt = 0 To UBound(vArray)
    If Left(sString, 1) = vArray(lCnt) Then
        sString = Right(sString, Len(sString) - 1)
    ElseIf Right(sString, 1) = vArray(lCnt) Then
        sString = Left(sString, Len(sString) - 1)
    End If
Next lCnt

fRemove_Punctuation = sString

End Function 
```

该代码假定没有项目符号的连续文本。

# android - 真正的全屏与 Android 4 平板电脑

> ID：10301020
> 
> 赞同：2
> 
> 时间：2012-04-24T15:24:42.950
> 
> 标签：android, fullscreen, android-4.0-ice-cream-sandwich

我正在寻找一种解决方案，使带有 ICS 的平板电脑在没有导航栏的情况下全屏显示。

我找到了一个应用程序“GestureControl”，使之成为可能。但是这个应用程序中还有一些我不需要的东西。所以我认为这是可能的。

我用“FLAG_FULLSCREEN”或“SYSTEM_UI_FLAG_HIDE_NAVIGATION”尝试了一些东西，但它不起作用。也许我没有正确使用它。

有人可以解决我的问题吗？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:27:23.287

您无法在 Android 平板电脑上隐藏系统栏，除非是在 root 设备上。

> 我找到了一个应用程序“GestureControl”，使之成为可能。但是这个应用程序中还有一些我不需要的东西。所以我认为这是可能的。

GestureControl 仅适用于有根设备。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-24T15:28:21.003

U 不能在 Android 中隐藏系统栏，除非在 root 设备上。您提到的应用程序仅适用于有根设备。

对此感到抱歉。

# sql - 在插入和删除的表上调整 SELECT 语句的 XML 输出

> ID：10301022
> 
> 赞同：1
> 
> 时间：2012-04-24T15:24:46.547
> 
> 标签：sql, sql-server, xml, tsql, sql-server-2008-r2

我在触发器中捕获`inserted`和`deleted`表的内容并将它们作为 xml 保存到更改日志中。

对于直接插入和删除它。只需在对应表上进行选择并使用`FOR XML`将其转换为 xml。

更新变得有点棘手，因为您要合并两个表中的数据，*这些**表*基本上代表`UPDATE`. 现在我正在使用 a`UNION`将数据从`inserted`和`deleted`合并到一个结果集中。

```
SELECT [Column1], [Column2]
FROM
    (SELECT [Column1], [Column2]
     FROM inserted
     UNION
     SELECT [Column], [Column2]
     FROM deleted) as Rows
FOR XML RAW, ELEMENTS 
```

输出类似于：

```
<!-- Comments added for clarity. They don't appear in the actual output -->
<row> <!-- After -->
    <Column1>Bar</Column1>
    <Column2>Ipsum</Column2>
</row>
<row> <!-- Before -->
    <Column1>Foo</Column1>
    <Column2>Lorem</Column2>
</row> 
```

我希望输出是：

```
<row>
    <Column1>
        <Before>Foo</Before>
        <After>Bar</After>
    </Column1>
    <Column2>
        <Before>Lorem</Before>
        <After>Ipsum</After>
    </Column2>
</row> 
```

或者可能

```
<row>
    <Column1 Before="Foo" After="Bar" />
    <Column2 Before="Lorem" After="Ipsum" />
</row> 
```

但我不确定如何做到这一点。有任何想法吗？

注意：我们的一些客户仍在使用 SQL Server 2005，因此使用新的更改跟踪确实不是一个选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:06:10.183

你可以试试这个。我已经用常规表（不在触发器中）进行了测试。并假设 PK 被称为`ID`。

```
select d.Column1 as 'Column1/Before',
       i.Column1 as 'Column1/After',
       d.Column2 as 'Column2/Before',
       i.Column2 as 'Column2/After'
from inserted as i
  inner join deleted as d
    on i.ID = d.ID
for xml path('row') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T16:57:21.643

我已经为审计跟踪解决方案做到了这一点，并遇到了同样的问题。我的决议如下：

正如您所提到的，插入和删除很容易。插入新记录时，我们不存储任何 XML，因为插入中包含的字段值是活动表中的当前值。当一条记录被删除时，您将记录的状态存储为它在 XML 字段中被删除时的状态。

更新带来了一些问题，因为我不想为每条记录存储两次数据（即之前和之后）。然后我想到我只需要存储“Before”数据（即删除的表），因为“After”存储在原始表本身，或者针对同一记录的以下审计跟踪记录。在重建路径时确实让生活变得更加困难，但从存储的角度来看肯定是有意义的。

换句话说，假设在 01:00:00 添加了一条记录。记录在 02:00:00 和 02:30:00 更新，并在 03:00:00 删除。您的审计跟踪将类似于：

```
AuditKey Timestamp  RecordType    RecordKey   AuditType    XML
1        01:00:00   MyTable       213         I            NULL
2        02:00:00   MyTable       213         U            XML1
3        02:30:00   MyTable       213         U            XML2
4        03:00:00   MyTable       213         D            XML3 
```

使用自连接，可以得到两条连续的记录，显示MyTable中记录的前后状态。我们的样本记录的审计跟踪如下：

```
From AuditKey 1 and 2: Record was inserted at 01:00, with the field values XML1
From AuditKey 2 and 3: Record was updated at 02:00, and changed from XML1 to XML2
From AuditKey 3 and 4: Record was updated at 02:30, and changed from XML2 to XML3
From AuditKey 4 and NULL: Record was deleted at 03:00 
```

如果最后一条记录不是删除，而是另一个更新，那么审计跟踪的最后一行将显示为：

```
From AuditKey 4 and NULL: Record was updated at 03:00, and changed from XML3 to the field values in the live table. 
```

这种方法对我们来说效果很好，以至于我们能够将记录重建到历史上的任何一点。将这种方法更进一步，针对每条记录存储的 XML 仅记录值已更改的那些字段。这确实意味着如果不遍历其间的所有日志，我们就无法立即确定历史上两点之间发生了什么变化。但是，由于这些日志很少被查看，因此优先考虑的是使它们高效而不是快速。这取决于您的特定环境的要求。

我使用的查询示例如下所示：

```
WITH cte AS (SELECT ROW_NUMBER() OVER (ORDER BY [Timestamp]) AS RowNum,
    AuditKey, [Timestamp], AuditType, XML FROM AuditTrail 
    WHERE RecordType = 'MyTable' AND RecordKey = 213)
SELECT t1.Timestamp, t1.AuditType, t1.XML AS FromXML, 
    CASE WHEN t2.XML IS NULL THEN (SELECT * FROM MyTable WHERE RecordKey = 213 FOR XML AUTO) ELSE t2.XML END AS ToXML
FROM cte t1 LEFT JOIN cte t2 ON t2.AuditKey = t1.AuditKey + 1
WHERE t2.AuditType <> 'D' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T16:07:02.857

```
SELECT      CAST('
<row>
  <Column1 Before="' + i.Column1 + '" After="' + d.Column1 + '" />
  <Column2 Before="' + i.Column2 + '" After="' + d.Column2 + '" />
</row>' AS xml)
FROM        inserted i
INNER JOIN  deleted d ON i.ID = d.ID 
```

# visual-studio-2010 - 使用 CodedUI 在组合框或表格中选择特定值

> ID：10301024
> 
> 赞同：2
> 
> 时间：2012-04-24T15:25:03.660
> 
> 标签：visual-studio-2010, coded-ui-tests

我有一个带有组合框和元素表的网络应用程序。我需要使用 codedUI 编写一个方法，该方法选择组合框或表中的元素，将元素的“名称”作为参数传递是否可能？

如果需要更多信息，请询问我

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T18:39:44.563

您可以记录您要测试的操作，然后在`UIMap.Designer.cs`文件中自定义自动生成的代码以选择您需要的控件。对于您在记录测试时使用的每个控件，`CodedUi Test Builder`都会在此文件中创建一个新类。如果您的控件相似（例如 control1、control2...），则将参数名称分配给`Search Properties`该控件：

```
public class UIItemWindow : WinWindow
{

    public UIItemWindow()
    {
        #region Search Criteria
        //Here assign the paramter to the search properties of the control
        this.SearchProperties[WinWindow.PropertyNames.Name] = parameterName;
        #endregion
    }

    #region Properties
    public UIItemWindow1 UIItemWindow1
    {
        get
        {
            if ((this.mUIItemWindow1 == null))
            {
                this.mUIItemWindow1 = new UIItemWindow1(this);
            }
            return this.mUIItemWindow1;
        }
    }
    #endregion

    #region Fields
    private UIItemWindow1 mUIItemWindow1;
    #endregion
} 
```

要查看如何将参数传递给 CodedUI 测试，请查看以下链接：

*   [如何：创建数据驱动的编码 UI 测试](http://msdn.microsoft.com/en-us/library/ee624082.aspx)
*   [如何从 Microsoft 测试管理器中的 TestCase 读取参数值](https://stackoverflow.com/questions/8163098/how-to-read-parameter-values-from-a-testcase-in-microsoft-test-manager/9031012#9031012)

# wso2 - WSO2 本地交通

> ID：10301032
> 
> 赞同：1
> 
> 时间：2012-04-24T15:25:22.117
> 
> 标签：wso2, local, wso2esb, transport

我有兴趣进一步了解本地传输如何帮助 WSO2 ESB 中的性能。我查看了[http://heshans.blogspot.co.uk/2011/06/local-transport-implementation-for-wso2.html](http://heshans.blogspot.co.uk/2011/06/local-transport-implementation-for-wso2.html)这表明代理服务可以通过本地传输与***本地***前缀进行通信。但是，如果 Web 应用程序也安装在同一个 ESB 上，是否可以使用本地传输与实际的 Web 服务端点进行通信？我问的原因是我正在调查 JBoss SOA 与 WSO2 相比的差异，并想了解使用 JBoss 是否比 WSO2 有任何性能优势，因为 JBoss 似乎支持 InVM 传输。

任何帮助将非常感激。

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T13:28:03.370

本地传输的目的是与运行在同一 JVM 上的服务进行有效通信。例如 ESB 代理与另一个代理服务通信。您可以使用 WSO2 Application Server 来部署 Web 应用程序，但如果您从另一个 ESB 实例调用它，则不能使用本地传输（因为有两个 jvm）。

您可以做的是，您可以在 WSO2 ESB 上安装 WSO2 Application Server 功能，然后部署 webapp。在这种情况下，您可以在 webapp 和 esb 代理服务等之间使用本地传输。

# javascript - 访问内联函数中的 javascript 变量

> ID：10301034
> 
> 赞同：1
> 
> 时间：2012-04-24T15:25:28.193
> 
> 标签：javascript, html

我希望`storedata`在动态更改对象事件 onclick 事件处理程序时访问一个名为的变量

```
function update_data(storedata)
{
    obj.onclick=function() {remover(this,storedata); };
} 
```

无法访问内部函数中的 storedata。

当我尝试使用 alert(obj.onclick) 时，结果是 remover(this,storedata)。似乎变量没有被它的值取代！！

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T15:28:24.367

它被“替换”了。问题只是您尝试检查它的方式。

当你提醒一个函数时，你会得到一个函数的字符串化版本……它包括变量名，而不是每个变量的序列化。

如果您要实际调用该函数，则该变量将与您提供的值一起可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:30:06.847

您需要将其附加为具有事件处理程序的对象的属性。当您 storedata 是一个字符串并且您使用的是 HTML5 时，您可以例如以这种方式完成它：

```
function update_data(storedata){
   obj.dataStoredata = storedata;
   obj.onclick = function(){
      remover(this);
    };
} 
```

在您的`remover`函数内部，您可以简单地访问`this.dataStoredata`包含您的数据的函数。

# extjs - ExtJS：日期时间字段和带有时间字段的表单未正确发送

> ID：10301040
> 
> 赞同：1
> 
> 时间：2012-04-24T15:25:46.143
> 
> 标签：extjs, extjs4

我有一个包含各种字段的表单：文本字段、日期字段等。一切正常，除了时间域。

这是我声明数据模型的方式：

```
Ext.define('Intranet.Horaire', {
    extend: 'Ext.data.Model',
    fields: [
        {   
            name: 'id',
            type: 'int',
            useNull: true
        },  
        ...blabla...
        {   
            name: 'heure_debut',
            type: 'date',
            dateFormat: 'Y-m-d H:i:s'
        },  
        {   
            name: 'heure_fin',
            type: 'date',
            dateFormat: 'Y-m-d H:i:s'
        }   
    ]
}); 
```

以下是我在我看来声明这些东西的方式：

```
{
...
}, {
    fieldLabel: 'Heure début&nbsp;',
    name: 'heure_debut',
    xtype: 'timefield',
    format: 'H:i',
    allowBlank: false
}, {
    fieldLabel: 'Heure fin&nbsp;',
    name: 'heure_fin',
    xtype: 'timefield',
    format: 'H:i',
    allowBlank: false
} 
```

这是 Ext 在读取值时得到的结果：

```
{
   "data":[
      {
         ...blabla...
         "heure_debut":"0000-00-00 09:15:00",
         "heure_fin":"0000-00-00 12:15:00",
         "id":"5"
      },
      {
         ...blabla...
         "heure_debut":"0000-00-00 09:15:00",
         "heure_fin":"0000-00-00 12:15:00",
         "id":"7"
      }
   ],
   "message":"",
   "success":true
} 
```

和**阅读作品**。**但是在写作方面，无论您选择什么时间**，这里总是发送的值：

```
{
   "data":{
      "heure_debut":"2008-01-01",
      "heure_fin":"2008-01-01",
      "id":7,
      "jours":[

      ]
   }
} 
```

[编辑] 我添加了 submitFormat 属性，但没有任何变化：它仍然是发送的常量“2008-01-01”（=格式“Ymd”）：

```
 ...
            {
                fieldLabel: 'Heure début&nbsp;',
                name: 'heure_debut',
                xtype: 'timefield',
                format: 'H:i',
                submitFormat: 'Y-m-d H:i:s',
                allowBlank: false
            }, {
                fieldLabel: 'Heure fin&nbsp;',
                name: 'heure_fin',
                xtype: 'timefield',
                format: 'H:i',
                submitFormat: 'Y-m-d H:i:s',
                allowBlank: false
            },
            ... 
```

这让我发疯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T09:32:30.440

我找到了，是我通过这段代码覆盖了 JSON 日期编码：

```
Ext.JSON.encodeDate = function(d) {
     return Ext.Date.format(d, '"Y-m-d"');
}; 
```

# php - PHP ColdFusion9 AES 加密 - 不同的结果

> ID：10301041
> 
> 赞同：2
> 
> 时间：2012-04-24T15:25:47.613
> 
> 标签：php, encryption, coldfusion, aes

PHP 和 ColdFusion9 中的 AES 加密产生了不同的结果。有人可以帮我吗？

下面的 PHP 代码

```
$key = "12345678123456781234567812345678";
$iv = "1234567812345678";
$data = "This is a plain string.";

echo base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, $data, MCRYPT_MODE_CBC, $iv)); 
```

给我 G+tdEOfQTtVCQGxW3N5uzkqN207OyfIPxS6zf2xrKKY=

而下面的 ColdFusion 代码

```
<cfset thePlainData  = "This is a plain string." />
<cfset theKey    = "12345678123456781234567812345678" />
<cfset theAlgorithm  = "AES/CBC/PKCS5Padding" />
<cfset theEncoding  = "base64" />
<cfset theIV    = "1234567812345678" />

<cfset encryptedString = encrypt(thePlainData, theKey, theAlgorithm, theEncoding, theIV) /> 
```

给我 KLt55n5/T3ee6xVq9VGFbyCacJznkHEqC/RDRhL+4nw=

知道我哪里错了吗？提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T05:35:02.520

不幸的是，ColdFusion 和 PHP 实现之间在使用的纯文本填充样式方面存在轻微的不兼容。AES 要求明文块大小可被 128 整除。为此，[PHP 将使用 NULL 字符填充明文输入](http://www.chilkatsoft.com/p/php_aes.asp)以获得正确的块大小。[ColdFusion 可以使用Java 支持](http://docs.oracle.com/javase/1.5.0/docs/guide/security/jce/JCERefGuide.html#AppA)的各种填充技术。不幸的是，ColdFusion 和 Java 都支持 NULL 填充模式，这使得互操作性更加困难。ColdFusion 的字符串处理不支持 NULL 字符，因此您需要[在 PHP 中实现 PKCS5Padding 模式，](http://us3.php.net/manual/en/ref.mcrypt.php#69782)以使它们能够正确地互操作。

此外，正如评论中提到的，ColdFusion 将期望密钥是 base64 编码的，因此您需要密钥设置如下所示：

```
<cfset theKey = toBase64("12345678123456781234567812345678") /> 
```

此外，默认情况下 Java（以及扩展的 ColdFusion）仅支持最大 128 位的密钥大小。在这里，您使用的是 256 位密钥，这[需要 Java Unlimited Strength 扩展](http://www.javamex.com/tutorials/cryptography/unrestricted_policy_files.shtml)（对于那些试图测试代码并获得非法密钥大小错误的人）。

生成的 PHP 代码如下所示：

```
// Function from http://us3.php.net/manual/en/ref.mcrypt.php#69782
function pkcs5_pad ($text, $blocksize)
{
    $pad = $blocksize - (strlen($text) % $blocksize);
    return $text . str_repeat(chr($pad), $pad);
}

$key = "12345678123456781234567812345678";
$iv = "1234567812345678";
// Pad data with PKCS #5 to prevent PHP from using NULL padding.
$data = pkcs5_pad("This is a plain string.", 16);

echo base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, $data, MCRYPT_MODE_CBC, $iv)); 
```

生成的 ColdFusion 代码如下所示：

```
<cfset thePlainData = "This is a plain string." />
<cfset theKey = toBase64("12345678123456781234567812345678") />
<cfset theAlgorithm = "AES/CBC/PKCS5Padding" />
<cfset theEncoding = "base64" />
<cfset theIV = "1234567812345678" />

<cfset encryptedString = encrypt(thePlainData, theKey, theAlgorithm, theEncoding, theIV) />

<cfoutput>#encryptedString#</cfoutput> 
```

两者都输出相同的 base64 编码字符串：

```
G+tdEOfQTtVCQGxW3N5uzlu0mGabRKNxuIdAXArQE80= 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-08T18:28:12.530

我知道这是一个旧线程，但最近出现了类似的问题。

虽然本机不支持，但事实证明有一种方法可以在 CF 中生成空填充。[Artjom B. 的这个答案](https://stackoverflow.com/a/28917879/104223)同意在 PHP 中调整填充可能更简单，但指出您可以使用 0x00 将纯文本填充到[算法块大小的倍数](https://helpx.adobe.com/coldfusion/kb/strong-encryption-coldfusion-mx-7.html) *并*使用“NoPadding”方案来实现相同的结果。

在 CF 中生成空字符有点棘手，但可以[使用 URLDecode("%00")](http://www.coldfusiondeveloper.com.au/null-character/)来完成。由于 encrypt() 始终将输入视为 UTF-8 编码，因此您还可以使用 charsetEncode() 从单个元素字节数组（即`charsetEncode( javacast("byte[]", [0] ), "utf-8")`.

没有经过高度测试，但这样的事情应该在 CF10 中产生相同的结果：

**代码：**

```
thePlainData = nullPad("This is a plain string.", 16);
// NB: JCE unlimited policy files required for 256 bit keys
theKey = toBase64("12345678123456781234567812345678");
theIV  = "1234567812345678";

encryptedString = encrypt(thePlainData, theKey, "AES/CBC/NoPadding", "base64", theIV); 
```

**结果：**

```
G+tdEOfQTtVCQGxW3N5uzkqN207OyfIPxS6zf2xrKKY= 
```

**功能：**

```
/*
   Pads a string, with null bytes, to a multiple of the given block size

   @param plainText - string to pad
   @param blockSize - pad string so it is a multiple of this size
   @param encoding - charset encoding of text
*/
string function nullPad( string plainText, numeric blockSize, string encoding="UTF-8")
{
    local.newText = arguments.plainText;
    local.bytes = charsetDecode(arguments.plainText, arguments.encoding);
    local.remain = arrayLen( local.bytes ) % arguments.blockSize;

    if (local.remain neq 0) 
    {
        local.padSize = arguments.blockSize - local.remain;
        local.newText &= repeatString( urlDecode("%00"), local.padSize );
    }

    return local.newText;
} 
```

# asp.net - Lambda，如何使用包含？

> ID：10301042
> 
> 赞同：0
> 
> 时间：2012-04-24T15:25:48.910
> 
> 标签：asp.net, json, lambda

我想使用 Lambda 检索数据，

如果写查询，

```
SELECT * FROM weborderln WHERE PK in ('60fa6105-42c9-aa4b-82a2-1d84f803a540','adsfasfwer-we123-1231b-82a2-12312312sd5125'); 
```

来自 Jason Data 的 PK 值。

```
string itemsInfo = "[{\"itemNo\":\"SKR315FLWW\",\"qty\":1,\"weborderlnPk\":\"60fa6105-42c9-aa4b-82a2-1d84f803a540\"},{\"itemNo\":\"OKHIY211\",\"qty\":1,\"weborderlnPk\":\"adsfasfwer-we123-1231b-82a2-12312312sd5125\"}]"; 

JavaScriptSerializer js = new JavaScriptSerializer();
IList<PartialInvoiceParamsModel> items = js.Deserialize<IList<PartialInvoiceParamsModel>>(itemsInfo);

//Response.Write(items[0].itemNo); // SKR315FLWW

EFWebOrderLnRepository webOrderLnRepository = new EFWebOrderLnRepository();
var webOrderLns = webOrderLnRepository.WebOrderLns.Where(e => e.PK.Contains(?????)).ToList(); //// 
```

有人知道我需要在 Contains() 中添加什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:38:08.643

起初看起来有点落后，但您需要在您正在检查的项目列表中执行包含。

因此，您需要创建一个 PK 列表来执行包含。
例如：

```
var webOrderLns = webOrderLnRepository.WebOrderLns.Where(e => items.Select(x => x.weborderlnPk).Contains(e.PK)).ToList(); 
```

`items.Select(x => x.weborderlnPk)`应该创建 PK 列表供您使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T15:51:26.727

假设您有 ID 列表：

```
List<string> listIDs = new List<string> { "60fa6105-42c9-aa4b-82a2-1d84f803a540", 
                                          "60fa6105-42c9-aa4b-82a2-1d84f803a541", 
                                          "60fa6105-42c9-aa4b-82a2-1d84f803a542" 
                                         };
var webOrderLns = from foo in webOrderLnRepository.WebOrderLns 
                  where listIDs.Contains(foo.PK) 
                  select foo; 
```

这将为您提供 ID 与列表 ID 匹配的记录

# ssl - 关于 erlang 套接字中的 {packet, PacketType}

> ID：10301045
> 
> 赞同：2
> 
> 时间：2012-04-24T15:25:54.323
> 
> 标签：ssl, erlang

我目前正在处理 SSL 套接字。我将其设置为：

```
{ok, LSocket} = ssl:listen(443, [{packet, http},
                         {reuseaddr, true},
                         {active, false},
                         {certfile, "mycert.pem"},
                         {keyfile, "mykey.pem"}]). 
```

但是当我通过调用将套接字传递给另一个应该处理连接的进程时：

```
ssl:getopts(LSocket, [packet]). 
```

我有：

```
{ok,[{packet,0}]} 
```

代替：

```
{ok,[{packet,http}] 
```

0 不是表示“原始数据包”吗？为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T02:11:33.540

你自己编译过 Erlang 吗？可能你把加密模块搞砸了。尝试使用 Erlang Solutions 的预编译 15B02：[https ://www.erlang-solutions.com/downloads/download-erlang-otp](https://www.erlang-solutions.com/downloads/download-erlang-otp)

您演示的代码在那里可以很好地传递给另一个进程：

```
Erlang R15B02 (erts-5.9.2) [source] [64-bit] [smp:4:4] [async-threads:0] [hipe] [kernel-poll:false]

Eshell V5.9.2  (abort with ^G)
1> {ok, LSocket} = ssl:listen(9443, [{packet, http}, {reuseaddr, true}, {active, false}, {certfile, "priv/ssl/ssl.crt"}, {keyfile, "priv/ssl/ssl.key"}]).
{ok,{sslsocket,new_ssl,
               {#Port<0.719>,
                {config,{ssl_options,[],verify_none,
                                     {#Fun<ssl.1.38762831>,[]},
                                     false,false,undefined,1,<<"priv/ssl/ssl.crt">>,undefined,
                                     <<"priv/ssl/ssl.key">>,undefined,[],undefined,<<>>,
                                     undefined,undefined,
                                     [<<0,...>>,<<...>>|...],
                                     #Fun<ssl.0.38762831>,true,...},
                        [{packet,http},{reuseaddr,true},{active,false}],
                        {socket_options,list,http,0,0,false},
                        [{reuseaddr,true},
                         {packet_size,0},
                         {packet,0},
                         {header,0},
                         {active,false},
                         {mode,binary}],
                        {gen_tcp,tcp,tcp_closed,tcp_error}}}}}
2> 
2> ssl:getopts(LSocket, [packet]).
{ok,[{packet,http}]}
3> spawn(fun() -> ssl:getopts(LSocket, [packet]) end).
<0.42.0>
4> spawn(fun() -> error_logger:info_msg(ssl:getopts(LSocket, [packet])) end).
<0.44.0>
5> 
=INFO REPORT==== 1-Nov-2012::06:07:15 ===
ERROR: {ok,[{packet,http}]} - [] 
```

# editor - 脱掉流口水 guvnor

> ID：10301052
> 
> 赞同：2
> 
> 时间：2012-04-24T15:26:12.600
> 
> 标签：editor, designer, drools

我需要将 drools guvnor 集成到我的应用程序中，但我认为这对我的需求来说有点矫枉过正，我不需要外部应用程序......我只需要编辑器。

有没有办法只使用这些而不使用整个东西？我知道我可以使用嵌入式模式，但我仍然必须安装并运行完整的工作 guvnor 实例

我所要求的只是一个依赖或没有整个事情的东西......有这样的事情吗？还是我必须手动将其剥离？

# javascript - PhoneGap 和 Nexus S？

> ID：10301053
> 
> 赞同：4
> 
> 时间：2012-04-24T15:26:22.143
> 
> 标签：javascript, cordova, nexus-s

我正在测试 getPicture API 以从图库中获取图片。

我写了这个：

```
 navigator.camera.getPicture(
        this.onSuccess, 
        this.onFail, 
        {
            destinationType: Camera.DestinationType.DATA_URL,
            sourceType: Camera.PictureSourceType.PHOTOLIBRARY,
            allowEdit: false,
            mediaType: Camera.MediaType.PICTURE,
        } 
```

然后，我得到：

**无法打开“/mnt/sdcard/Android/data/com.myapp/cache/Pic.jpg”**

我认为PhoneGap默认尝试将缓存放在sd卡中。我的“Google Nexus”没有。

有人有同样的问题吗？

**[编辑]**

我在我的清单中获得了这个许可，但它并没有改变任何东西：

```
 <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:10:20.953

您的 AndroidManifest.xml 中是否具有以下权限？

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

# java - 这是对象的安全发布吗？

> ID：10301061
> 
> 赞同：7
> 
> 时间：2012-04-24T15:26:40.240
> 
> 标签：java, multithreading

我有一个班级项目

```
class Item {
  public int count;
  public Item(int count) {
    this.count = count;
  }
} 
```

然后，我会将 Item 的引用放在其他类的字段中

```
class Holder {
  public Item item;
  public Holder() {
    item = new Item(50);
  }
} 
```

这个*新的 Item*对象可以安全地发布吗？如果不是，为什么？根据 Java Concurrency in Practice ，新 Item 是在*没有完全构造*的情况下发布的，但在我看来，新 Item 是完全构造的：它的`this`引用不会转义，并且对它的引用和它的状态是同时发布的，所以消费者线程不会看到陈旧的值。或者是可见性问题。我不完全知道原因。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-24T15:33:21.530

> 这个新的 Item 对象可以安全地发布吗？如果不是，为什么？

问题围绕指令的优化和重新排序。*当您有两个线程在没有*同步的情况下使用构造对象时，编译器可能会为了效率而决定重新排序指令并为对象分配内存空间并将其引用存储在`item`字段中*，然后*再完成构造函数和字段初始化。或者它可以重新排序内存同步，以便其他线程以这种方式*感知*它。

如果将该`item`字段标记为，`final`则保证构造函数作为构造函数的一部分完成该字段的初始化。否则，您必须在使用锁之前对其进行同步。这是[Java 语言定义](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4)的一部分。

这是另外几个参考：

*   [双重检查锁定已损坏](http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html)
*   [同步和 Java 内存模型](http://gee.cs.oswego.edu/dl/cpj/jmm.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-24T15:33:33.993

是的，存在可见性问题，但`Holder.item`不是`final`。所以不能保证在构造`Holder`完成后另一个线程会看到它的初始化值。

正如@Gray 指出的那样，JVM 可以在没有内存屏障的情况下自由地重新排序指令（可以通过锁（同步）、a`final`或`volatile`限定符创建）。根据上下文，您必须在此处使用其中一种以确保安全发布。

# regex - 如何使用 grep 打印出唯一匹配的计数？

> ID：10301063
> 
> 赞同：25
> 
> 时间：2012-04-24T15:26:43.967
> 
> 标签：regex, sorting, count, grep

假设我有数百万个数据包要查看，我想查看一个数据包被发送到某个端口号的次数。

以下是一些数据包：

```
10:27:46.227407 IP 85.130.236.26.54156 > 139.91.133.120.60679: tcp 0
10:27:46.337038 IP 211.142.173.14.80 > 139.91.138.125.56163: tcp 0
10:27:46.511241 IP 211.49.224.217.3389 > 139.91.131.47.6973: tcp 0 
```

我想在这里查看第二个端口号：

60679、53163、6973等

所以我可以使用：

```
grep -c '\.80:' output.txt 
```

计算使用端口 80 的所有时间。但是有没有办法让它显示所有使用的端口以及在这个文件中找到它的次数。像这样的东西也最好排序，所以我可以看到最常用的端口：

```
.80: - 54513
.110: - 12334
.445: - 412 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-04-24T15:33:10.653

见[`uniq -c`](http://unixhelp.ed.ac.uk/CGI/man-cgi?uniq)。你会想要取出你想要的位，对结果进行排序，通过 uniq 管道，对输出进行排序。可能是这样的：

```
egrep '\.[0-9]+:' output.txt | sort | uniq -c | sort -nr 
```

澄清：我在这里使用了 grep ，因为不清楚你的 output.txt 格式是什么样的，但你会想要实际删除端口号位，可能是通过`cut`or `awk`。

编辑：要获取端口，您可以在句号上剪切一次，然后在冒号上再次剪切：

```
cut -d. -f10 < output.txt | cut -d: -f1 
```

（或完成相同事情的十几种其他方法中的任何一种。）这将为您提供未排序的端口列表。然后：

```
cut -d. -f10 < output.txt | cut -d: -f1 | sort | uniq -c | sort -nr 
```

# android - 使用客户端 ssl 身份验证时如何/在哪里存储密钥库密码？

> ID：10301066
> 
> 赞同：2
> 
> 时间：2012-04-24T15:26:50.293
> 
> 标签：android, iphone, security, mobile, ssl

我正在创建一个移动应用程序（Android 和 iPhone）并计划要求客户端 SSL 身份验证。为此，我的应用程序包含了它的客户端证书文件。在 Android 端，这是一个包含私钥的密钥库。密钥库和密钥都有密码。

我的问题：我应该如何/在哪里将密码存储到密钥库和密钥？

在与服务器建立 SSL 连接时，应用程序代码需要这些才能打开密钥存储，因此应用程序需要能够访问它们。

是否应该将它们作为混淆字符串存储在应用程序源代码中？还是有一些我没有看到的更普遍接受（阅读：更好）的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T17:08:04.350

用于保护密钥库的加密基于密码，因此您需要 (1) 将该密码存储在客户端的某个位置，或者 (2) 在用户启动客户端应用程序时询问用户密码。您需要做什么取决于您的用例。如果 (2) 是可以接受的，那么您已经保护了您的凭证免受逆向工程，因为它将被加密并且密码不会存储在任何地方（但用户每次都需要输入）。如果您这样做（1），那么有人将能够对您的客户端进行逆向工程，获取密码，获取密钥库，解密私钥和证书，并创建另一个能够连接到服务器的客户端 - 这是真的无论您将此密码存储在何处（在已编译的应用程序代码中，作为 APK/包中的资源，在 SharedPreference 中，在数据库等中；它仍然存在，并且会以某种形式存在，在某些时候它是可以理解的。

您无法采取任何措施来防止这种情况发生；你可以使你的代码更难逆向工程（通过混淆等），但你不能让它变得不可能。您需要确定使用这些方法试图减轻的风险是什么，以及需要做多少工作来减轻风险。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:31:34.637

根据[http://developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

您“应该”在 Android 中使用 SharedPreferences 或简单的 SQLite 数据库。

我更喜欢 SQLite 方法，因为 iOS 也支持这种方法，因此您可以重用一些代码。

# excel - 将数据从工作表复制到单行，删除然后将行粘贴到另一张工作表上的最后一行

> ID：10301069
> 
> 赞同：1
> 
> 时间：2012-04-24T15:27:01.107
> 
> 标签：excel, vba

我一直在桌子上敲我的头，试图破坏我的大脑以获得答案，但在我看来，我的大脑只是不想工作。我已经走到了这一步，但似乎没有更进一步......

```
Sub CopyValues()
    Dim i As Integer

    'Internal NCMR
    Dim wsInt As Worksheet
    Dim wsNDA As Worksheet

    'Copy Ranges
    Dim c As Variant

    'Paste Ranges
    Dim p As Range

    'Setting Sheet
    Set wsInt = Sheets("Internal NCMR")
    Set wsNDA = Sheets("NCMR Data")
    Set p = Range("B54:U54")

    With wsInt
        c = Array(.Range("B11"), .Range("B14"), .Range("B17"), .Range("B20"), .Range("B23"), .Range("Q11") _
                , .Range("Q14"), .Range("Q17"), .Range("Q20"), .Range("R25"), .Range("V23"), .Range("V25") _
                , .Range("V27"), .Range("B32"), .Range("B36"), .Range("B40"), .Range("B44"), .Range("D49") _
                , .Range("L49"), .Range("V49"))
    End With

    For i = LBound(c) To UBound(c)
        p(i + 1).Value = c(i).Value
    Next

    With wsNDA
        Worksheets("Internal NCMR").Rows("54").Copy
        Sheets("NCMR Data").Range("B" & Rows.Count).End(xlUp).Offset(1).PasteSpecial Paste:=xlPasteValues
    End With
End Sub 
```

如主题中所述，此脚本的要点是三个方面。

1.  从工作表中获取字段，将它们粘贴到一行中。
2.  将行删除，并将其粘贴到同一工作簿中的另一张工作表中。
3.  从单元格 Z1 的第二张表复制到刚插入的行的开头。

第三部分我还没有完成，如果有人可以帮助我，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:32:35.207

这是你正在尝试的吗？

```
Option Explicit

Sub CopyValues()
    Dim i As Integer

    'Internal NCMR
    Dim wsInt As Worksheet
    Dim wsNDA As Worksheet

    'Copy Ranges
    Dim c As Variant

    'Paste Ranges
    Dim p As Range

    'Setting Sheet
    Set wsInt = Sheets("Internal NCMR")
    Set wsNDA = Sheets("NCMR Data")
    Set p = wsInt.Range("B54:U54")

    With wsInt
        c = Array(.Range("B11"), .Range("B14"), .Range("B17"), .Range("B20"), .Range("B23"), .Range("Q11") _
                , .Range("Q14"), .Range("Q17"), .Range("Q20"), .Range("R25"), .Range("V23"), .Range("V25") _
                , .Range("V27"), .Range("B32"), .Range("B36"), .Range("B40"), .Range("B44"), .Range("D49") _
                , .Range("L49"), .Range("V49"))
    End With

    For i = LBound(c) To UBound(c)
        p(i + 1).Value = c(i).Value
    Next

    With wsNDA
        Dim Lastrow As Long

        Lastrow = .Range("B" & Rows.Count).End(xlUp).Row + 1

        wsInt.Rows("54").Copy

        With .Rows(Lastrow)
            .PasteSpecial Paste:=xlPasteFormats
            .PasteSpecial Paste:=xlPasteValues
            .Interior.Pattern = xlNone
        End With

        With .Range("A" & Lastrow)
            If Lastrow = 3 Then
                .Value = 1
            Else
                .Value = Val(wsNDA.Range("A" & Lastrow - 1).Value) + 1
            End If

            .NumberFormat = "0#######"
        End With
    End With
End Sub 
```

# javascript - jquery - 从本地文件系统加载 XML 文件而不会出现跨域错误

> ID：10301070
> 
> 赞同：1
> 
> 时间：2012-04-24T15:27:04.523
> 
> 标签：javascript, jquery, xml, ajax, cross-domain

我正在尝试设置一个网站以在本地文件系统上运行并调用 XML 文件，但我遇到了访问控制来源错误：

Access-Control-Allow-Origin 不允许 Origin null。

我尝试将数据类型切换为 jsonp 并将跨域设置为 true：

```
$j.ajax({
            crossdomain: true,
            url: 'xml/vehicles.xml',
            dataType: "jsonp",      
            success: function( vehicleXML ) {
                supertree.parseVehicles($j(vehicleXML).find("vehicles"), null);
                supertree.vehiclesLoaded = true;
                if(supertree.scenesLoaded) supertree.ready();
            }
        }); 
```

但它不起作用。关于如何做到这一点的任何想法？最好没有代理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T15:39:06.427

[同源策略](https://developer.mozilla.org/en/Same_origin_policy_for_JavaScript)阻止您访问数据。您请求数据的服务器需要启用[CORS](http://www.w3.org/TR/cors/)，或者您需要在服务器上使用代理从其他服务器获取数据。

其他选项是将 XML 数据更改为[JSONP](http://en.wikipedia.org/wiki/JSONP)格式。这不像告诉 jQuery 发出 JSONP 请求那么容易。数据格式完全不同，服务器必须返回该格式，JavaScript 对此无能为力。

# python - python的idle中是否有水平滚动条？

> ID：10301071
> 
> 赞同：2
> 
> 时间：2012-04-24T15:27:05.183
> 
> 标签：python, python-idle

我正在使用 IDLE 在 Windows 7 上学习 Python 2.7。

垂直滚动条工作正常，但我找不到
激活水平滚动条的方法。

Python 的 IDLE 中是否有水平滚动条？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T18:30:26.497

IDLE 的水平滚动条

来自[http://code.activestate.com/lists/python-list/26878/](http://code.activestate.com/lists/python-list/26878/) （**不是我的代码**，在这个网站上找到）它的日期是 2000 年 3 月 8 日星期三

适用于 Python 2.6，但我无法在 2.7 中工作。我收到一条错误消息，说文件在某个地方打开。对我来说，他说的文件位于：C:\Python27\ArcGIS10.1\Lib\idlelib 如果你没有python自带的ArcMap程序并为你安装，那就不一样了。

> 我终于开始在 IDLE 编辑器窗口中添加水平滚动条，以便在您获得那些长长的代码行时提供帮助。它们的更改相当小（4 行新代码）并且是在 EditorWindow.py 模块中进行的。要在 IDLE 中进行更改，请打开 EditorWindow.py 并搜索 EditorWindow 类`__init__`方法中的“vbar”。`###` 添加已附加到它们的那些行，瞧，您就拥有了。不幸的是，滚动条出现在 IDLE 0.5 中的行和列信息下方（*叹气*）。
> 
> ```
>  self.vbar = vbar = Scrollbar(top, name='vbar')
>     self.hbar = hbar = Scrollbar(top, orient=HORIZONTAL, name='hbar') ###
>     ...
>     vbar['command'] = text.yview
>     vbar.pack(side=RIGHT, fill=Y)
>     hbar['command'] = text.xview        ###
>     hbar.pack(side=BOTTOM, fill=X)      ###
> 
>     text['yscrollcommand'] = vbar.set
>     text['xscrollcommand'] = hbar.set   ### 
> ```
> 
> 希望这会有所帮助。
> 
> 乔纳森·波利
> 
> jwpolley 在 collins.rockwell.com

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T15:35:19.580

不，IDLE 没有水平滚动条有两个原因：

1.  它的文本编辑器几乎没有什么功能。
2.  您不应该编写长行代码。请参阅Python 代码的 PEP 8 样式指南的[最大行长部分](http://www.python.org/dev/peps/pep-0008/#maximum-line-length)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-17T05:58:14.227

我使用的是 IDLE 2.7.3，Windows 7，我可以通过按住鼠标中心按钮/滚轮水平滚动，然后像这样在光标周围“拖动”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-11T03:37:02.543

我可能还不是 Python 专家/大师，但这个问题比任何事情都更重要的是用户体验/可用性问题。有些人可能会说“是的，PEP 8 风格指南……等等等等”，但如果我的 IDLE 窗口有一定的大小（比如说小宽度），我作为用户没有理由不能滚动。这只是糟糕的设计导致的糟糕的用户体验。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-24T15:33:26.737

不，文本会根据插入点或选择的位置水平滚动。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-25T03:22:32.257

见[http://bugs.python.org/issue1207613](http://bugs.python.org/issue1207613)

IdleX项目提供了一个扩展，[用于](http://idlex.sourceforge.net)在 IDLE 中显示水平滚动条。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-24T15:37:27.007

不，因为 Python PEP[强调](http://www.python.org/dev/peps/pep-0008/#maximum-line-length)，所以行长最多*应该*是 79 个符号。大多数人当然违反了这一点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-18T20:58:55.513

**用于 Python 3.6 的 IDLE 水平滚动条。**

感谢 Amber 和他/她的回答，我找到了让它适用于 Python 3.6 的方法。

您必须在同一个类中进行一些更改`EditorWindow`，但现在它位于不同的模块中：%python%\Lib\idlelib\ (win) 中的“editor.py”。

首先，您必须以相同的方法进行更改`__init__`。`handle_xview`然后为同一个类创建一个新方法。

这是代码，您必须添加以 结尾的行`###`：

```
 self.vbar = vbar = Scrollbar(text_frame, name='vbar')
    self.hbar = hbar = Scrollbar(text_frame, orient=HORIZONTAL, name='hbar') ###
    ...
    vbar['command'] = self.handle_yview
    vbar.pack(side=RIGHT, fill=Y)
    text['yscrollcommand'] = vbar.set

    hbar['command'] = self.handle_xview ###
    hbar.pack(side=BOTTOM, fill=X)      ###
    text['xscrollcommand'] = hbar.set   ### 
```

和方法：

```
...
def handle_yview(self, event, *args):
...
...
def handle_xview(self, event, *args):      ###
    "Handle Horizontal scrollbar."         ###
    self.text.xview(event, *args)          ###
    return 'break'                         ###
... 
```

# indexing - Couchbase 或 Riak 作为搜索引擎的数据存储

> ID：10301086
> 
> 赞同：2
> 
> 时间：2012-04-24T15:27:54.383
> 
> 标签：indexing, couchdb, search-engine, riak, couchbase

我想实现文本搜索引擎。特别是要索引的文档将是具有权重的术语列表。
查询是一个简单的术语列表。
搜索的输出应该是按相关性匹配（针对术语及其权重）排序的列表 **我需要存储的数据很大！它不适合单个节点。所以最终的存储必须易于分发。**

您会推荐哪种数据库存储？经过一些分析，我想在 Couchbase 和 Riak 之间进行选择。

[编辑] **您如何看待简单的关系数据库？**他们已经有了一些不错的分发机制（例如：内置 Postgres 9）[/edit]

Riak 具有内置搜索功能，但据我所知，我不想使用它，因为我需要索引才能获得响应（而不是为每个查询计算它）。

另一方面，Couchbase 2“*为 JSON 文档添加了二级索引。索引是通过视图创建的，然后可以查询。索引是均匀分布的。* ”
这听起来对 Couchbase 来说是一个很大的好处

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-14T23:38:11.430

回答“我可以/应该使用数据库来存储我的索引文档吗？”的一般基本问题。

是的。

这是一个相当普遍的模式。一些组织（为了保护无辜者而隐瞒名称）使用 Solr 作为索引和相关引擎，仅从搜索中返回主键，然后转身从数据库存储中检索实际文档。

然而，这种方法存在挑战；主要是为了使两个系统（solr 和 db）保持同步。Couchbase 使用其跨数据中心复制技术来保持 ElasticSearch 实例同步；Riak 2 刚刚发布并有效地为数据库的每个分片自动创建一个 Solr 索引。根据您的用例，两者都可以正常工作。此外，您显然可以使用队列等进行自己的同步。

两个数据库的更多详细信息，请访问

[http://docs.couchbase.com/couchbase-elastic-search/](http://docs.couchbase.com/couchbase-elastic-search/) [http://docs.basho.com/riak/latest/dev/advanced/search/](http://docs.basho.com/riak/latest/dev/advanced/search/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T15:32:20.573

我使用了 ElasticSearch 和 CouchDB，效果很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T16:38:22.437

我建议将[Riak Search](http://wiki.basho.com/Riak-Search.html)用于全文搜索，它非常强大，并且借鉴了[Lucene](http://lucene.apache.org/core/)的大部分优点，同时仍然具有透明的容错性、可复制性和可扩展性。如果您的数据不适合单个节点，它可能是最平衡的开源解决方案。

# php - mysql/php 在特定日期自动更新数据库

> ID：10301095
> 
> 赞同：-1
> 
> 时间：2012-04-24T15:28:25.047
> 
> 标签：php, mysql

嗨，我不完全确定这是否可能，但感谢您提供的任何信息，

我正在创建一个将面临挑战的网站，一旦挑战完成，我希望该网站自动将信息插入到我的新闻提要中。

就像是：

> **挑战完成**
> 
> 获胜者是罗伯特，得到 200 分。

例如，如果挑战在 2012 年 6 月 21 日 13:01 结束，那么一旦该日期和时间到来，它将自动插入信息。我希望它不依赖于用户交互来实现。

我尝试过搜索，但我不知道这实际上叫什么，或者是否可以完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:34:43.803

如果您不能按照上面评论中的建议使用 cron，您可能需要查看[MySQL 的事件调度程序](http://dev.mysql.com/doc/refman/5.1/en/events.html)- 自 MySQL 5.1.6 起可用。例如：

```
CREATE EVENT myevent
    ON SCHEDULE AT '2012-06-21 13:01:00'
    DO
      // your INSERT query here 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T15:36:26.580

如果您的服务器支持，您可以每天使用 CRON 计时器。它会在特定时间（例如每天凌晨 2:00）运行一个 php 脚本，检查今天（或昨天）是否完成了任何挑战并为这些挑战运行必要的操作。您可以使用的 CRON 命令：

如果你可以直接调用 php 文件（因为有时它是一个重写的 url，你不能告诉它 php 可执行文件）：

**/usr/bin/php /path/to/your/phpfile.php**

还有我上面提到的第二种可能性：

**/usr/bin/wget -q -O [http://www.yourdomain.com/scripts/phpfile](http://www.yourdomain.com/scripts/phpfile)**

**/usr/bin/curl [http://www.yourdomain.com/scripts/phpfile](http://www.yourdomain.com/scripts/phpfile)**

# grails - Grails @Mock 注解

> ID：10301100
> 
> 赞同：3
> 
> 时间：2012-04-24T15:28:33.417
> 
> 标签：grails, mocking, grails-orm

我在 Grails 文档（第 9 章：测试）中阅读了有关此注释的信息。但是看不懂是什么...

问题是我需要模拟 GORM 的动态方法，有一种方法可以自动模拟它们，而不必编写我需要的所有方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T21:04:36.330

这在 grails 2.x 中是正确的：

当您添加注解 @Mock(A) 时，grails 会将动态方法添加到 A 中，用于您的单元测试。你不必自己嘲笑他们。

您将能够在您的测试中或在您的测试调用的对象中执行以下操作：

```
def s=new A().save()
A.get(1) 
```

ETC

Grails 使用 GORM 的内存实现来模拟这些方法，而不是 jdbc。

您也可以使用标准查询。

# hibernate - 休眠插入外键

> ID：10301102
> 
> 赞同：1
> 
> 时间：2012-04-24T15:28:51.560
> 
> 标签：hibernate, insert, hql

我正在使用休眠插入一些行，但我不知道我是否做得很好......

我的实体有一个外键，我知道它的 id，我不明白我是需要引用的对象还是只需要 id。我有一种方法可以做到这一点，因为仅仅为了插入而获取引用的对象是没有用的。

我想做这个：

```
en=new MyEntity();
en.setForeignVal("1"); 
```

似乎我必须这样做：

```
en=new MyEntity();
refObj=getSession().get(RefObject.class, "1"); //unuseful
en.setForeignVal(refObj); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T15:39:30.637

Hibernate 为这个用例提供了一种特殊的方法 - `load()`. 它返回具有给定 id 的代理而不访问数据库：

```
en.setForeignVal(getSession().load(RefObject.class, "1")); 
```

# circuit - 4 位二进制数乘以 3 (mod 16)

> ID：10301104
> 
> 赞同：1
> 
> 时间：2012-04-24T15:29:01.640
> 
> 标签：circuit, digital-logic, truthtable, karnaugh-map

我在过去的一篇论文中有一个问题，要求设计为最小的乘积之和，并且只使用 NAND 门，这是一个采用 4 位二进制输入并将该数字乘以 3 的电路（mod 16）

这是我得出的真值表

```
Inputs    Outputs
w x y z | a b c d
0 0 0 0 | 0 0 0 0 
0 0 0 1 | 0 0 1 1
0 0 1 0 | 0 1 1 0
0 0 1 1 | 1 1 0 0 
0 1 0 0 | 1 0 0 0
0 1 0 1 | 1 1 1 0
0 1 1 0 | 0 1 0 0 
0 1 1 1 | 1 0 1 0
1 0 0 0 | 0 0 0 0 
1 0 0 1 | 0 1 1 0 
1 0 1 0 | 1 1 0 0 
1 0 1 1 | 0 0 1 0 
1 1 0 0 | 1 0 0 0 
1 1 0 1 | 1 1 1 0 
1 1 1 0 | 0 1 0 0 
1 1 1 1 | 1 0 1 0 
```

从这里我创建了 4 个卡诺图：

```
wx|yz|00 01 11 10
_____|___________
00   |0  0  1  0
01   |1  1  1  0
11   |1  1  1  0
10   |0  0  0  1
(a)
wx|yz|00 01 11 10
_____|___________
00   |0  0  1  1
01   |0  1  0  1
11   |0  1  0  1
10   |0  1  0  1
(b)
wx|yz|00 01 11 10
_____|___________
00   |0  1  0  1
01   |0  1  1  0
11   |0  1  1  0
10   |0  1  1  0
(c)
wx|yz|00 01 11 10
_____|___________
00   |0  1  0  0
01   |0  0  0  0
11   |0  0  0  0
10   |0  0  0  0
(d) 
```

以下是我的问题：这些卡诺地图中是否存在任何无关条件。我怎么知道有没有？

此外，这会给我四个布尔表达式，产生 4 个独立的电路。我是否需要以某种方式将它们连接在一起作为一个大电路？

最后，我是否可以将某种机械程序应用于最终的布尔表达式，以便将其转换为与非门？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:18:17.220

单程：

你有 w,x,y,z。使用四个与非门，将输入连接在一起作为反相器，从而生成!w、!x、!y 和!z。

使用 4 输入 NAND 门来实现 a、b、c 和 d 的卡诺图 - 图中只要有 1，就使用门通过将其输入连接到 w、x、y、z 来生成 1！ w、!x、!y 和 !z 按照地图的指示。

图中的门数与 1 一样多，因此您需要反转它们的输出并将它们全部与非运算以获得 !a、!b、!c 和 !d，（是的，您可能需要再次反转） .

# c++ - gettimeofday 返回一个负值

> ID：10301106
> 
> 赞同：3
> 
> 时间：2012-04-24T15:29:06.097
> 
> 标签：c++, gettimeofday

我正在编写一个线程库，并且在调度线程时我需要知道它们已经准备好多长时间。每个 Thread 实例都有一个`timeval _timeInReady`字段，当我将实例推送到就绪队列时，我调用此函数：

```
void Thread::startTiming() {
    gettimeofday(&_timeInReady, NULL);
} 
```

当我想检查`_timeInReady`我调用的当前值时：

```
double Thread::getTimeInReady() const {
    return TIME(_timeInReady.tv_sec,_timeInReady.tv_usec);
} 
```

时间在哪里`#define TIME(a,b) ((a*1000000) + b)`所以我得到了以微秒为单位的总时间。

我的问题是，由于某种原因，当我在一段时间后检查该字段时，我得到了疯狂的负值（例如 -10293843）。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T15:36:59.747

您应该将结果作为 64 位无符号整数返回，因为您需要整数微秒结果，而不是小数秒（这意味着返回`double`）：

```
unsigned long long Thread::getTimeInReady() const
{
    return (unsigned long long)_timeInReady.tv_sec * 1000000ULL +
        (unsigned long long)_timeInReady.tv_usec;
} 
```

您的系统可能`uint64_t`比 更简洁`unsigned long long`，或者您可以`typedef`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:06:50.643

在我的计算机上，所有`tv_sec`、`tv_usec`和`1000000`都是有符号的 32 位数量。当被要求保存大于 2^31 左右的数字时，带符号的 32 位值会溢出。

结果，这个表达式：

```
((x.tv_sec*1000000) + x.tv_usec) 
```

将在几秒钟内溢出`2^31 / 10^6`，或大约 2,147 秒。只要你的程序只处理少于 35 分钟的时间间隔，你应该没问题。

如果您想表示值 >= 35 分钟，请尝试将您`#define`的值替换为：

```
#define TIME(a,b) ((a*1000000ull) + b) 
```

通过标准促销，此更改将使您的所有数学运算都以`unsigned long long`值执行。

您可以（但不必）将您的更改`double`为`uint64_t`. 这取决于你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-02T09:08:30.480

试试这个以获得 32 位系统的时间：-

```
struct timeval time;
gettimeofday(&time, NULL);
unsigned long long secTime = ((unsigned long long)time.tv_sec) * 1000 + ((unsigned long long)(time.tv_usec))/1000; 
```

# c++ - mkl 随机数生成器和 FLT_MAX

> ID：10301111
> 
> 赞同：0
> 
> 时间：2012-04-24T15:29:16.660
> 
> 标签：c++, random, floating-point, infinity, intel-mkl

我正在使用 mkl Intel 的准随机数生成器。我创建了自己的 wrappnig 方法以允许定义 rng 的最大和最小界限。但是，当边界值 aer FLT_MIN FLT_MAX 时似乎不起作用。所以我想知道 FLT_MAX 实际上是什么。一个大浮动？一个不可超过的虚构值？不能在 FLT_MIN 和 FLT_MAX 之间进行采样吗？如何处理？

谢谢并恭祝安康。

# c++ - 等效于 C++ 中的 Regex.Replace

> ID：10301121
> 
> 赞同：0
> 
> 时间：2012-04-24T15:30:00.660
> 
> 标签：c++, gcc, boost

c# 中有 Regex，我可以使用它来删除一些任意字符或字符范围，例如`Regex.Replace(str, "[^a-zA-Z0-9_.]+", "", RegexOptions.Compiled)`. 但是什么是 C++ 中的等价物。我知道 Boost 里面有一个正则表达式库。但是对于这个操作，它是否可行以及它的性能如何？从 C++ 中的字符串中删除字符的最佳和快速方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:38:40.620

我使用过 Boost，发现它既快速又易于使用。一个例子：

```
#include <boost/regex.hpp>

bool detect_mypattern( const string& text )
{
    // A specific regex pattern
    static const boost::regex ep("[\\w\\s]{8}\\s{1}\\w{2}\\s{1}Test");
    return( boost::regex_match(text, ep) );
} 
```

当然，如果您不需要正则表达式的强大功能，那么有很多字符串函数可以更快地从字符串中拼接字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:58:20.400

你可能想要[boost::regex_replace](http://www.boost.org/doc/libs/1_49_0/libs/regex/doc/html/boost_regex/ref/regex_replace.html)：

```
#include <boost/regex.hpp>
#include <string>

const std::string input; 
boost::regex matcher("[^a-zA-Z0-9_.]+");
const std::string formatter("");

std::string output = boost::regex_replace(input, matcher, formatter); 
```

# asp.net-mvc - 在 EF CF 中添加/更新导航属性

> ID：10301127
> 
> 赞同：4
> 
> 时间：2012-04-24T15:30:24.723
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework, c#-4.0, entity-framework-4.1

我知道这在 SO 上已被多次询问，但我找不到关于如何在 EF CF 中添加或更新导航属性的明确答案。

实体（简化）：

```
 public class Basket : EntityBase
    {
        public virtual List<Fruit> TaggedFruits { get; set; }
    } 

    public class Fruit : EntityBase
        {

        } 
```

行动结果：

```
 [HttpPost]
        public ActionResult SaveTags(Basket basket, int[] selectedFruits)
        {
        basket.TaggedFruits = new List<Fruits>();

        foreach (int guid in selectedFruits)
            basket.TaggedFruits.Add(repository.Fruits.FirstOrDefault(p => p.Id == guid));

        using (var context = new EFDbContext())
        {
            context.Baskets.Attach(basket);
            context.SaveChanges();
        }

        return RedirectToAction("GetBasket", new {guid = basket.Guid});
    } 
```

我已经尝试了上述 SaveTags 方法的多次迭代，但从未让它工作。这个抛出：

**一个实体对象不能被多个 IEntityChangeTracker 实例引用。**

在研究了这里和其他站点之后，错误显然表明在方法中混合我的存储库模式和 DBContext 会导致冲突。

如果我将标记移动到存储库，使用以下方法：

```
 [HttpPost]
            public ActionResult SaveTags(Basket basket, int[] selectedFruits)
            {
                   List<Fruit> taggedFruits = new List<Fruit>();
           foreach (int guid in selectedFruits)
               taggedFruits.Add(new Fruit {Id = guid});

           libraryRepository.TagBasket(basket, taggedFruits);

            return RedirectToAction("GetBasket", new {guid = basket.Guid});
        }

/*in repository*/
    public void TagBasket(Basket basket, List<Fruit> fruits )
            {
                basket.Taggedfruits = new List<Fruit>();
                foreach (var fruit in fruits)
                {
                    basket.Taggedfruits.Add(Fruit);
                }

            context.Baskets.Attach(basket);
       context.SaveChanges();
        } 
```

然后不会向数据库提交任何更改。什么都没有发生，根本没有。有人可以指出我正确的方向吗？我已经为此奋斗了很久，谢谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T16:03:10.060

好吧，您只是附加实体（= 将状态设置为`Unchanged`），然后调用`SaveChanges`. 在这种情况下，您告诉 EF 没有任何改变-> 没有任何反应。

要更改 和 之间的关系`Basket`，`TaggedFruits`您必须从数据库中加载篮子的原始水果集合，然后根据您的 Id 集合中的 Id 从篮子的已加载水果集合中删除或添加标记的水果：

```
public void TagBasket(Basket basket, List<Fruit> fruits)
{
    var basketInDB = context.Baskets.Include(b => b.Taggedfruits)
        .Single(b => b.Id == basket.Id);

    foreach (var fruitInDB in basketInDB.Taggedfruits.ToList())
        if (!fruits.Any(f => f.Id == fruitInDB.Id))
            basketInDB.Taggedfruits.Remove(fruitInDB);

    foreach (var fruit in fruits)
        if (!basketInDB.Taggedfruits.Any(f => f.Id == fruit.Id))
        {
            var newFruit = new Fruit { Id = fruit.Id };
            context.Fruits.Attach(newFruit);
            basketInDB.TaggedFruits.Add(newFruit);
        }

    // Next line is only necessary if other properties in basket
    // could have been changed in your view
    context.Entry(basketInDB).CurrentValues.SetValues(basket);

    context.SaveChanges();
} 
```

您也可以只将`int[] selectedFruits`集合传入此方法，因为只需要 id。

# java - java-如何告诉 LDAP DirContext.search(...).hasMore() 返回 false 而不是抛出 PartialResultException

> ID：10301128
> 
> 赞同：5
> 
> 时间：2012-04-24T15:30:28.803
> 
> 标签：java, ldap

我将 LDAP DirContext.search(...) 设置为忽略引用，但是当我调用 NamingEnumeration.hasMore() 时仍然会遇到引用异常。

```
Exception in thread "main" javax.naming.PartialResultException: Unprocessed Continuation Reference(s); remaining name 'DC=company,DC=com'
    at com.sun.jndi.ldap.LdapCtx.processReturnCode(LdapCtx.java:2846)
    at com.sun.jndi.ldap.LdapCtx.processReturnCode(LdapCtx.java:2820)
    at com.sun.jndi.ldap.LdapNamingEnumeration.getNextBatch(LdapNamingEnumeration.java:129)
    at com.sun.jndi.ldap.LdapNamingEnumeration.hasMoreImpl(LdapNamingEnumeration.java:198)
    at com.sun.jndi.ldap.LdapNamingEnumeration.hasMore(LdapNamingEnumeration.java:171) 
```

我可以告诉 DirContext.search 忽略引用，以便 NamingEnumeration.hasMore() 返回 false 而不是抛出异常吗？

这是剪断：

```
import javax.naming.*;
import javax.naming.directory.*;

Properties p = new Properties();
p.setProperty(Context.INITIAL_CONTEXT_FACTORY, ldapInitContextFactory);
p.setProperty(Context.PROVIDER_URL, ldapURL);
p.setProperty(Context.SECURITY_CREDENTIALS, ldapPassword);
p.setProperty(Context.SECURITY_PRINCIPAL, ldapUser);
p.setProperty(Context.SECURITY_AUTHENTICATION, "simple");
p.setProperty(Context.REFERRAL, "ignore");
DirContext ctx = new InitialDirContext(p);

SearchControls searchControls = new SearchControls();
searchControls.setSearchScope(SearchControls.SUBTREE_SCOPE);
searchControls.setDerefLinkFlag(false);

NamingEnumeration e = ctx.search(ldapBaseDN, ldapQuery, null, searchControls);

for (; e.hasMore();) {
    SearchResult sr = (SearchResult) e.next();
    System.out.println("\nSearch Result: " + sr.getName());
} 
```

注意：如果我启用推荐，我会在调用 NamingEnumeration.hasMore() 时收到 LdapReferralException 异常。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T22:17:03.180

```
javax/naming/NamingEnumeration.java
public interface NamingEnumeration<T> extends Enumeration<T> {
    public boolean hasMore() throws NamingException;
    public T next() throws NamingException;
    ...
}

java/util/Enumeration.java
public interface Enumeration<E> {
    boolean hasMoreElements();
    E nextElement();
} 
```

调用 e.hasMoreElements() 而不是 e.hasMore() 可以解决问题。也就是说，当有引用时，它返回 false（而不是抛出异常）。

但是，这不是一个最佳解决方案，因为我们可能会遗漏其他真正的 NamingException 异常（例如 CommunicationException）。

我仍然想找到告诉 DirContext.search 忽略引用的正确方法，以便 NamingEnumeration.hasMore() 返回 false 而不是抛出异常。任何想法？

[我在http://download.java.net/openjdk/jdk6/](http://download.java.net/openjdk/jdk6/) -> openjdk-6-src-b24-14_nov_2011.tar.gz下载了 JDK 源代码，但是此源代码与 JDK 二进制文件不完全对应，请参阅[如何找到 JDK1.6 二进制文件的确切来源（包括 com.sun.jndi.*）](https://stackoverflow.com/questions/10304296/how-to-find-the-exact-sources-of-a-jdk1-6-binary-including-com-sun-jndi#comment13262793_10304296)

从下面的这个JDK源代码来看，当有引用时，似乎不可能得到“假”而不是异常。

```
./jdk/src/share/classes/com/sun/jndi/ldap/LdapCtx.java
protected void processReturnCode(LdapResult res, Name resolvedName, Object resolvedObj, Name remainName, Hashtable envprops, String fullDN) throws NamingException {
    NamingException e;

    switch (res.status) {
    case LdapClient.LDAP_SUCCESS:

        // handle Search continuation references
        if (res.referrals != null) {
            msg = "Unprocessed Continuation Reference(s)";

            if (handleReferrals == LdapClient.LDAP_REF_IGNORE) {
                e = new PartialResultException(msg);
                break;
            }
        [...]
    }
    [...]
    throw e;
} 
```

但我仍然不确定。

我认为我们可以告诉 DirContext.search 忽略引用是有道理的，这样 NamingEnumeration.hasMore() 返回 false 而不是抛出异常。

任何想法？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-07-11T01:01:16.373

据我所知，有*一种*方法可以忽略引用，这在处理 Active Directory LDAP 操作时特别有用。您必须创建并注入一个新的`LdapTemplate`（使用已配置的 构建），而不是从头开始`ContextSource`创建自己的。`InitialDirContext`我不知道这是否与您的设置兼容。我希望这有帮助。

来自 Spring LDAP Core`LdapTemplate` [文档](https://docs.spring.io/spring-ldap/docs/current/apidocs/org/springframework/ldap/core/LdapTemplate.html)：

> AD 服务器显然无法自动处理引荐，这会导致`PartialResultException`在搜索中遇到引荐时抛出 a。为避免这种情况，请将`ignorePartialResultException`属性设置为`true`。

# ruby-on-rails - Rails 3.2 Asset Pipeline 添加 ?body=1 但提供空资源

> ID：10301129
> 
> 赞同：0
> 
> 时间：2012-04-24T15:30:29.580
> 
> 标签：ruby-on-rails, heroku, twitter-bootstrap, asset-pipeline

我在 Heroku 上有一个应用程序，它可以在我的开发环境中正常工作。但是，在 Heroku 上，我的 javascripts 文件之一是空的。它是 bootstrap_for_rails gem 提供的引导文件

```
/assets/twitter/bootstrap-a43574b1a9d30434438a56d88ff10a70.js?body=1
 ==> Returns empty file???

/assets/twitter/bootstrap-a43574b1a9d30434438a56d88ff10a70.js
 ==> Returns the js file correctly 
```

我正在使用带有资产管道的 Rails 3.2，并在 Heroku 上使用 Cedar Stack。

这是我的 production.rb 资产设置

**生产.rb**

```
config.serve_static_assets = true

config.assets.debug = true

config.assets.compress = false

config.assets.compile = true

config.assets.digest = true

# Specifies the header that your server uses for sending files
# config.action_dispatch.x_sendfile_header = "X-Sendfile" # for apache
config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx 
```

非常简单的 application.js 文件：

**应用程序.js**

```
 //= require twitter/bootstrap 
```

**宝石文件**

```
 group :assets do
   gem 'sass-rails',   '~> 3.2.3'
   gem 'coffee-rails', '~> 3.2.1'
   gem 'uglifier', '>= 1.0.3'
   gem 'twitter-bootstrap-rails', :git => 'https://github.com/seyhunak/twitter-bootstrap-rails.git'
 end 
```

我无法弄清楚可能有问题的部分。赫罗库？导轨？链轮？配置？

我已经尝试更改我的大部分 production.rb 设置，包括注释掉 action_dispatch.x_sendfile_header。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:20:03.903

我相信这是设计使然。在查看实际的引导文件时（我在这里查看：[https](https://github.com/seyhunak/twitter-bootstrap-rails/blob/master/vendor/assets/javascripts/twitter/bootstrap.js) ://github.com/seyhunak/twitter-bootstrap-rails/blob/master/vendor/assets/javascripts/twitter/bootstrap.js ），没有里面有实际的js。它只是通过“//= require”行向 sprockets 发出信号，它应该拉入哪些 .js 文件并一起编译。在开发模式下，这些 sprocket 的注释隐藏在前端，因为它们实际上只是 sprockets/rails 的实现细节。

因此，总而言之，当您尝试查看一个只包含多个“//= require”的 (app/lib/vendor)/assets/javascript 文件时，该文件在前端将显示为空，因为 rails/ sprockets 在前端隐藏了你的实现细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:17:49.290

为什么要直接访问单个文件？在生产中，管道的想法是将 application.js 清单文件中引用的所有单个文件合并到单个 application.js 文件中。

您的代码应该只通过 引用 application.css 文件`javascript_include_tag`。在开发中，如果您将页面的源代码作为单独的 js 文件查看，这将显示包含的所有文件，而在生产中您应该看到的是单个 js 文件，例如

/assets/application-46187b46e120ec79eabd082567660eb1.js

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-24T15:32:37.750

I've had some issues with the assets group on Heroku. Trying moving it outside of it and see if that works.

# c++ - C++ 模板中的链接错误

> ID：10301136
> 
> 赞同：3
> 
> 时间：2012-04-24T15:30:56.603
> 
> 标签：c++, templates, linker

我需要生成一个需要链接到 dll 的简单记录器（没有第三方库）。因此我用他的一些类方法生成了一个类是模板，代码编译正常但我得到链接器错误。我正在使用 MS VS 2008 和 gcc-4 进行编译。代码是：

Log.h 类：

```
class MiniLogger
{
private:
   std::ofstream mOutPutFile;
protected:
   void write (std::string const& text);
public:
   ~MiniLogger();
   MiniLogger( std::string const& lName) throw(FileError);
   static MiniLogger* getInstance(std::string const & fName);
   static void destoryInstance(MiniLogger*);

  template<class T>
  MiniLogger& operator<<(T & data);
  MiniLogger& operator<<(std::ostream& (*func)(std::ostream&) );

};

MiniLogger& MiniLogger::operator<< (std::ostream& (*func)(std::ostream&))
{

   //mOutPutFile << out;
   return *this;
}
template<class T>
MiniLogger& MiniLogger::operator<< (T  & data)
{
 //Just try with out calling other method
// write(data);
   return *this;
} 
```

主要我实例化了对象并使用它：

```
#include "log.h"

int main()
{

    MiniLogger &a=*(MiniLogger::getInstance("text.txt"));

    a << "text" << std::endl;

return 0;
} 
```

我明白了

```
@ubu11-10-64b-01:~/cplus/template$ g++ main.cpp log.cpp
/tmp/cccMdSBI.o: In function `MiniLogger::operator<<(std::basic_ostream<char, std::char_traits<char> >& (*)(std::basic_ostream<char, std::char_traits<char> >&))':
log.cpp:(.text+0x0): multiple definition of `MiniLogger::operator<<(std::basic_ostream<char, std::char_traits<char> >& (*)(std::basic_ostream<char, std::char_traits<char> >&))'
/tmp/ccj3dfhR.o:main.cpp:(.text+0x0): first defined here 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T15:38:26.550

您已经在头文件中定义了一个函数。由于该头文件包含在多个翻译单元（即 main.cpp 和 log.cpp）中，因此您已经多次定义了该函数。（参见[单一定义规则](http://en.wikipedia.org/wiki/One_Definition_Rule)。）

要么声明函数`inline`并在头文件中定义它，要么在头文件中声明`extern`并在一个源文件中定义。

有问题的功能是：`MiniLogger& MiniLogger::operator<< (std::ostream& (*func)(std::ostream&))`.

解决方案#1：

```
// Log.h
inline
MiniLogger& MiniLogger::operator<< (std::ostream& (*func)(std::ostream&))
{
 //mOutPutFile << out;
 return *this;
} 
```

解决方案#2：

```
// Log.h
extern
MiniLogger& MiniLogger::operator<< (std::ostream& (*func)(std::ostream&));

// Log.cpp
MiniLogger& MiniLogger::operator<< (std::ostream& (*func)(std::ostream&))
{
 //mOutPutFile << out;
 return *this;

} 
```

* * *

**旁注**：意识到头文件中的下一个实体，`template<class T> MiniLogger& MiniLogger::operator<< (T & data)`不是一个函数——它是一个函数模板——并且不同的建议适用于它。根据经验，您*应该*在头文件中定义函数模板，但*不应*在头文件中定义函数。（这个经验法则也有例外。）

# extjs4 - Extjs4 在跨域 ajax (jsonp) ajax 请求中设置 Auth

> ID：10301138
> 
> 赞同：1
> 
> 时间：2012-04-24T15:31:03.447
> 
> 标签：extjs4, cross-domain, basic-authentication

我正在使用 Extjs4，但我的商店有问题。如何在代理配置中设置“基本身份验证”？此时，当我加载我的应用程序时，我获得了登录胜利......我不想要那个......这里的代码：

```
Ext.define('DigitalPaper.store.DirTree', {
extend: 'Ext.data.TreeStore',
model: 'DigitalPaper.model.DirTree',

proxy: {
    type: 'jsonp',
    url: alf_share_address+'proxy/alfresco/slingshot/doclib/treenode/node/alfresco/company/home/xxx',
    callbackKey: 'alf_callback',
    extraParams : {
        perms: false,
        children : false,
        max : 500,
        alf_ticket: alf_ticket
    },
    headers : { Authorization : "Basic "+Base64.encode('username:password')}
},

root: {
    text: 'Cartelle',
    id: 'src',
    expanded: true
}

}); 
```

# qt - 如何实现平滑的 QGraphicsView::centerOn(QGraphicsItem)？

> ID：10301139
> 
> 赞同：3
> 
> 时间：2012-04-24T15:31:08.787
> 
> 标签：qt, qgraphicsview, qgraphicsitem, qt4.8

我有一个`QGraphicsItem`名为 的后代`lnk`，我使用此代码将图形视图 rect 移动到场景中的位置：

```
ui->graphicsView->centerOn(lnk); 
```

现在，我希望视图**平滑**滚动到项目的位置（例如谷歌地图）。

用谷歌和stackoverflow查找，我找到了一些解决方案，但都是基于旧的API，对我来说不是很清楚。

比如这个：[Make QGraphicsView do smooth centerOn](https://stackoverflow.com/questions/4104494/make-qgraphicsview-do-smooth-centeron)是基于老API，源代码不完整。这个也已经过时了：[http ://www.qtcentre.org/threads/30970-QGraphicsView-centerOn()-with-smooth-scrolling](http://www.qtcentre.org/threads/30970-QGraphicsView-centerOn()-with-smooth-scrolling)

请帮助我了解如何使用新 API 获得此功能（我想我必须使用 QPropertyAnimation 工具）？

# sql-server-2008 - SQL SERVER 2008 创建表时出错

> ID：10301141
> 
> 赞同：1
> 
> 时间：2012-04-24T15:31:11.920
> 
> 标签：sql-server-2008

我正在尝试在创建表时运行脚本。我收到此错误消息：

> CONDITIONAL 失败，因为以下 SET 选项的设置不正确：“ANSI_PADDING”。验证 SET 选项对于索引视图和/或计算列上的索引和/或过滤索引和/或查询通知和/或 XML 数据类型方法和/或空间索引操作是否正确。

创建表脚本如下。任何想法和建议！

```
/****** Object:  Table [dbo].[Account]    Script Date: 04/24/2012 10:06:22 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Account](
    [accountID] [int] IDENTITY(1,1) NOT NULL,
    [crmAccountID] [uniqueidentifier] NOT NULL,
    [crmOwningUserID] [uniqueidentifier] NOT NULL,
    [crmBusinessUnitID] [uniqueidentifier] NOT NULL,
    [name] [nvarchar](160) NULL,
    [accountNumber] [nvarchar](160) NULL,
    [stateCode] [int] NOT NULL,
    [topClientOfFirm] [nvarchar](100) NULL,
    [topClientOfCMG] [nvarchar](100) NULL,
    [balanceOfTrade] [nvarchar](100) NULL,
    [websiteURL] [nvarchar](200) NULL,
    [clientLevel] [nvarchar](30) NULL,
    [industryCode] [nvarchar](50) NULL,
    [city] [nvarchar](100) NULL,
    [state] [nvarchar](100) NULL,
    [country] [nvarchar](100) NULL,
    [deleted] [bit] NOT NULL,
    [numProperties] [int] NULL,
    [numEquityNeeds] [int] NULL,
    [numDebtNeeds] [int] NULL,
    [numCompanyLocations] [int] NULL,
    [numDebtPositions] [int] NULL,
    [primaryContactID] [int] NULL,
    [parentAccountID] [int] NULL,
    [tickerSymbol] [nvarchar](10) NULL,
    [negativeExperiences] [smallint] NULL,
    [totalSubAccounts] [smallint] NULL,
    [topParentAccountID] [int] NULL,
    [knownAs] [nvarchar](100) NULL,
    [lenderType] [nvarchar](100) NULL,
    [investorLender] [tinyint] NULL,
    [primaryGeography] [bit] NULL,
    [secondaryGeography] [bit] NULL,
    [teriaryGeography] [bit] NULL,
 CONSTRAINT [PK_Account] PRIMARY KEY CLUSTERED 
(
    [accountID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO 
```

# jquery - Jquery从asp下拉列表中获取键/值-键

> ID：10301145
> 
> 赞同：0
> 
> 时间：2012-04-24T15:31:21.870
> 
> 标签：jquery, asp.net

我的代码中有以下内容：

```
 <asp:DropDownList id="City" runat="server"> 
```

我尝试使用以下内容从键值中获取键，但它显示为未定义，尽管我从下拉列表中选择

```
 var city = $("#city option:selected").val();

    alert(city); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:34:38.297

您应该简单地`.val()`在元素本身上使用该方法`select`，而不是搜索`option:selected`子项（就像您当前所做的那样）。`ID`CSS 中的 s 也是区分大小写的。

```
var city = $("#City").val();
alert(city); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:34:05.540

ID 和选择器之间的大小写不匹配。

```
var city=$("#City option:selected").val(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T15:38:41.697

我不完全确定您所说的键和值是什么意思，但我假设您的意思是所选选项的文本和值。尝试这样的事情：

```
var selectedOption = $("#<%= City.ClientID %> option:selected");
if (selectedOption){
    alert($(selectedOption).text() + "/" + $(selectedOption).val());
} 
```

# php - 从另一个域获取 HTML

> ID：10301147
> 
> 赞同：0
> 
> 时间：2012-04-24T15:31:23.447
> 
> 标签：php, html, curl

我想每隔 30 秒获取一个特定链接并在我的程序中解析它的代码。有没有办法做到这一点？

我需要获取在它的代码中发现的某些东西，这些东西总是以固定的时间间隔改变。

我已经尝试使用 an`iframe`并获得它的 innerHTML 但这不起作用，而且 php`file_get_contents()`也不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T15:33:52.000

你能试试用这个吗？ [http://davidwalsh.name/download-urls-content-php-curl](http://davidwalsh.name/download-urls-content-php-curl)

编码

```
 /* gets the data from a URL */
function get_data($url)
{
  $ch = curl_init();
  $timeout = 5;
  curl_setopt($ch,CURLOPT_URL,$url);
  curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
  curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,$timeout);
  $data = curl_exec($ch);
  curl_close($ch);
  return $data;
} 
```

然后调用

```
$returned_content = get_data('http://davidwalsh.name'); 
```

（归功于大卫沃尔什）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:34:21.430

> 我试过使用 iframe 并获得它的 innerHTML 但这不起作用

那将遇到[相同的原产地政策](http://en.wikipedia.org/wiki/Same_origin_policy)

> php 的 file_get_contents() 也不起作用

如果数据在 HTML 本身中，它应该这样做（除非该功能已在您的 PHP 安装中被禁用）。

您尝试抓取的网站可能已采取措施阻止滥用爬虫。

（并且每 30 秒访问第三方网站并抓取他们的 HTML 听起来相当辱骂）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T15:34:26.290

`file_get_content`不起作用，因为它已在您的服务器上被禁用（可能出于安全原因）。您可以启用它，也可以使用 cURL。

# mysql - mysql合并两个查询

> ID：10301150
> 
> 赞同：0
> 
> 时间：2012-04-24T15:31:41.900
> 
> 标签：mysql, wordpress, taxonomy

我正在尝试合并这两个查询，但我对 mysql 不太感兴趣。我怀疑我需要使用一个`INNER JOIN`或子查询？

我正在尝试将自定义分类法与插件合并。该插件要求我使用 SQL 访问我的 Wordpress 数据库。这是来自插件的查询：

```
SELECT p.*
FROM {$wpdb->prefix}most_popular mp
INNER JOIN {$wpdb->prefix}posts p ON mp.post_id = p.ID
WHERE
    p.post_type = '%s' AND
    p.post_status = 'publish'
{$order}
LIMIT %d 
```

这是一个按我的分类过滤掉内容的查询

```
SELECT SQL_CALC_FOUND_ROWS  wp_posts.* 
FROM wp_posts  
INNER JOIN wp_term_relationships 
ON (wp_posts.ID = wp_term_relationships.object_id) 
WHERE 1=1  
    AND ( wp_term_relationships.term_taxonomy_id IN (38) ) 
    AND wp_posts.post_type = 'post' 
    AND (wp_posts.post_status = 'publish') 
GROUP BY wp_posts.ID 
ORDER BY wp_posts.post_date 
DESC LIMIT 0, 10 
```

我应该如何将所有这些合并到一个查询中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:01:29.850

```
SELECT p.*, wpt.*
FROM (SELECT * FROM {$wpdb->prefix}terms AS wpt1 WHERE wpt1.name='$loc' LIMIT 1) AS wpt
    , {$wpdb->prefix}most_popular AS mp
INNER JOIN {$wpdb->prefix}term_relationships wptr ON (mp.post_id = wptr.object_id) 
INNER JOIN {$wpdb->prefix}posts p ON mp.post_id = p.ID
WHERE 1=1
    AND ( wptr.term_taxonomy_id = wpt.term_id )
    AND p.post_type = '%s'
    AND p.post_status = 'publish'
{$order}
LIMIT %d 
```

它可能很难看，但它确实有效。

# android - android列表复选框

> ID：10301154
> 
> 赞同：0
> 
> 时间：2012-04-24T15:31:52.540
> 
> 标签：android, list, checkbox, android-cursoradapter

这个 Android 视图回收的东西非常疯狂，我花了一整天的时间试图找到一种解决方法。

这是我的代码，它不起作用

```
public class CustomCursorAdapter extends SimpleCursorAdapter {

    private Context currentContext;
    private Cursor mCursor;
    private boolean[] rows;

    public CustomCursorAdapter(Context context, int layout, Cursor c,
            String[] from, int[] to) {
        super(context, layout, c, from, to);
        // TODO Auto-generated constructor stub
        currentContext = context;
        mCursor = c;
        populateRows();
    }

    private void populateRows() {
        rows = new boolean[mCursor.getCount()];
        int i = 0;
        while (mCursor.moveToNext()) {
            rows[i] = false;
            i++;            
        }

    }

    @Override
    public View getView(int position, View v, ViewGroup parent) {
        // convertView.setBackgroundColor(R.drawable.darkred);
        if (v != null) {
            //getting checkbox
            CheckBox cb = (CheckBox) v.findViewById(R.id.name);

            if(rows[position]){
                rows[position] = false;
            }else{
                rows[position] = true;
            }
            cb.setChecked(rows[position]);

        }

        return super.getView(position, v, parent);
    }

} 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:45:38.070

这里有很多错误：

*   不要更改 getView 中的状态。我指的是翻转行[位置]。可能会多次调用 getView 来绘制相同的列表行。作为旁注，您可以使用 a = !a; 翻转
*   将检查状态设置为 if on v != null。如果你回收一个视图，你仍然需要初始化它的 UI，因为它可能被设置为不同数据行的状态。
*   如果视图不为空，并且您重用它，则返回它
*   如果视图为空，则需要创建新实例，例如通过膨胀布局

# java - Android Emulator 未将活动启动到前台

> ID：10301158
> 
> 赞同：1
> 
> 时间：2012-04-24T15:32:03.413
> 
> 标签：java, android, eclipse, emulation, robotium

我正在使用 Robotium 在 Eclipse 中运行自动化测试（将其作为 Android jUnit 测试运行），当我第一次启动模拟器时，应用程序不会在前台运行并且测试失败。如果我让模拟器保持打开状态，请按“主菜单”按钮然后运行测试它工作正常。该测试在一个记事本的测试项目中运行一些事件。

在首次打开模拟器时将应用程序推到前台的任何解决方案？

这是来自测试项目的清单

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="com.jayway.test"
      android:versionCode="1"
      android:versionName="1.0">
    <application android:icon="@drawable/icon" android:label="@string/app_name">
    <uses-permission android:name="android.permission.DISABLE_KEYGUARD" />
    <uses-library android:name="android.test.runner" /> 
```

这是来自实际项目的清单

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.android.notepad" >

    <application android:icon="@drawable/app_notes"
        android:label="@string/app_name" >
        <provider android:name="NotePadProvider"
            android:authorities="com.example.notepad.provider.NotePad" />

        <activity android:name="NotesList"
            android:label="@string/title_notes_list">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
            <intent-filter>
                <action android:name="android.intent.action.VIEW" />
                <action android:name="android.intent.action.EDIT" />
                <action android:name="android.intent.action.PICK" />
                <category android:name="android.intent.category.DEFAULT" />
                <data android:mimeType="vnd.android.cursor.dir/vnd.google.note" />
            </intent-filter>
            <intent-filter>
                <action android:name="android.intent.action.GET_CONTENT" />
                <category android:name="android.intent.category.DEFAULT" />
                <data android:mimeType="vnd.android.cursor.item/vnd.google.note" />
            </intent-filter>
        </activity>

        <activity android:name="NoteEditor"
            android:theme="@android:style/Theme.Light"
            android:configChanges="keyboardHidden|orientation">
            <!-- This filter says that we can view or edit the data of
                 a single note -->
            <intent-filter android:label="@string/resolve_edit">
                <action android:name="android.intent.action.VIEW" />
                <action android:name="android.intent.action.EDIT" />
                <action android:name="com.android.notes.action.EDIT_NOTE" />
                <category android:name="android.intent.category.DEFAULT" />
                <data android:mimeType="vnd.android.cursor.item/vnd.google.note" />
            </intent-filter>
        </activity>

        <activity android:name="NotesLiveFolder" android:label="@string/live_folder_name"
            android:icon="@drawable/live_folder_notes">
            <intent-filter>
                <action android:name="android.intent.action.CREATE_LIVE_FOLDER" />
                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>

    </application>

    <uses-sdk android:minSdkVersion="10"/>
</manifest>
    </application>
    <uses-sdk android:minSdkVersion="10" />
    <instrumentation android:targetPackage="com.example.android.notepad"   android:name="android.test.InstrumentationTestRunner" />
</manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:57:47.623

我使用这个命令解决了这个问题。

adb shell 输入keyevent 82

这会唤醒模拟器/设备。

# mod-rewrite - URL重写重定向问题

> ID：10301161
> 
> 赞同：0
> 
> 时间：2012-04-24T15:32:21.480
> 
> 标签：mod-rewrite, isapi

我将所有 URL 重写为小写，它工作正常。

```
RewriteCond %{REQUEST_URI} [A-Z]
RewriteRule (.*) $1 [CL,R=301] 
```

但是很少有地方会用到 ID 并且 ID 会转换成这个：

原始 URI 模式（添加空格以突出显示替换）：

7f4320a7-9b13-4439-837f-ba0dbbed29ad **%2C** b3a990ae-b693-4496-b7cc-59f0b1cfc14a

本地主机：

7f4320a7-9b13-4439-837f-ba0dbbed29ad **，** b3a990ae-b693-4496-b7cc-59f0b1cfc14a

开发服务器：

7f4320a7-9b13-4439-837f-ba0dbbed29ad **%252c** b3a990ae-b693-4496-b7cc-59f0b1cfc14a

我不太明白为什么它会有所不同，显然 0x2C 是逗号的十六进制，但我不知道它是如何以及为什么转换的。

我`!(pattern Repeats in every ID using URL)`用作临时解决方案，但我很好奇它有什么问题，我可以使用忽略 HEX 值的条件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T19:24:08.007

出来我需要添加 [NE] (noencode) 到`RewriteRule (.*) $1 [CL,NE,R=301]`.

%25 是一个'%'，所以字符被编码了两次。

# javascript - 关闭对话框时如何执行两个事件？

> ID：10301167
> 
> 赞同：1
> 
> 时间：2012-04-24T15:32:40.917
> 
> 标签：javascript, jquery

单击 jQuery 对话框关闭按钮时，我想执行两个操作。我有两个div。当我关闭对话框时，我希望 div 向上滑动，div 2 向下滑动。

到目前为止，我已经设法让 div 1 向上滑动。那么在哪里可以放置 div 2 的代码以便在 div1 向上滑动后向下滑动？

这是代码

```
$('#unlock').click(function(){

    $('#dialog_content').dialog({

        modal: true , resizable: false,

        close: function(event, ui) { $('#div1').slideUp();}

    });

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T15:35:13.133

只需链接幻灯片调用

```
close: function(event, ui) {
  $('#div1').slideUp(function() {
    $('#div2').slideDown();
  });
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:35:55.877

试试这个：

```
$('#unlock').click(function(){

$('#dialog_content').dialog({

    modal: true , resizable: false,

    close: function(event, ui) {
$('#div1').slideUp( function(){$('#div2').slideDown();});

}

});

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T16:02:21.970

```
 (function(){

      $("#unlock").on( "click", function() {
        $("#divone").slideUp();

      $("#divone").promise().done(function() {
         $( "#divtwo" ).slideDown();
      });

  });

})(); 
```

你也可以使用 .promise(); 确保绑定到集合的特定类型的所有操作（无论是否排队）都已完成。可能有点矫枉过正，但只是另一种选择

# android - Theme preview fails in Eclipse

> ID：10301171
> 
> 赞同：28
> 
> 时间：2012-04-24T15:32:56.377
> 
> 标签：android, android-theme

I have made a simple username/password dialog to which I want to apply a theme (it basically defines `windowBackground`) and would also like to preview in `Eclipse`.

I see that my theme is displayed along other themes in the Theme combo box, but selecting it produces the following error:

```
Missing styles. Is the correct theme chosen for this layout?
Use the Theme combo box above the layout to choose a different layout, or fix the theme style references.

Failed to find style 'textViewStyle' in current theme
android.content.res.Resources$NotFoundException
Couldn't find theme resource attr/textAppearanceLarge for the current theme
Exception details are logged in Window > Show View > Error Log
The following classes could not be found:
- TextView (Change to android.widget.TextView, Fix Build Path, Edit XML) 
```

Theme definition:

```
<style name="my_theme">
    <item name="android:windowBackground">@drawable/form_header</item>
    <!-- <item name="android:padding">0dp</item>-->
    <item name="android:windowNoTitle">true</item>
</style> 
```

Debugging works fine. However WYSIWYG would be more appreciable.

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-04-24T15:37:26.503

**首先**在编辑器中关闭布局文件并重新启动 Eclipse。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-04-23T03:44:47.160

我也遇到了这个问题。我通过改变主题解决了它。执行此操作的步骤

1.  在“图形布局”中打开活动
2.  单击下拉列表 AppTheme（在活动“图形布局”的顶部栏上）
3.  选择项目主题->AppBaseTheme

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-30T05:01:10.713

您应该在图形布局中选择另一个主题（例如：默认主题）。我认为您的自定义主题不支持某些属性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-03-06T09:07:55.043

**确保您在不同值下存在的所有其他 styles.xml 包含您的自定义主题部分。**

我有类似的问题。就我而言，我在 res 下的 values-large 文件夹中添加了一个自定义主题。它在运行时工作，但在 Eclipse 中给出错误。所以我尝试在所有其他 styles.xml 文件中添加自定义部分（在我的情况下，styles.xml 文件中总共添加了 3 个标签）。`values-normal-hdpi`即,和...下`values-normal-mdpi`的styles.xml 文件`valuse-v11``values-v14`

和繁荣！它解决了我浪费了一整天的问题。

# java - Building and deploying on a remote windows server using Bamboo

> ID：10301172
> 
> 赞同：3
> 
> 时间：2012-04-24T15:32:57.927
> 
> 标签：java, maven, jboss, bamboo

I'm hoping people might be kind enough to point me in the right direction with a Bamboo query I have, please.

The company I'm at has an existing Bamboo CI server that's running quite successfully (despite being an old version - 2.6) and I need to set up a new build. The two people who've done almost all of the previous Bamboo work have now left, and so I don't really have anyone internally to turn to for advice.

I was hoping I could describe the manual process, and then have someone suggest the best way to automate this.

Manual process (all on the Windows deployment server):

1.  Run "svn update --force" on six separate working directories, which in turn use two separate Subversion repositories
2.  Run "mvn clean install" on all six directories, with one of them needing an extra -Duser.timezone parameter passed in, and which sometimes needs running two or three times before it builds successfully
3.  Run a "DeployLocal.bat" batch file
4.  Start two JBOSS instances, by executing their "bin\run.bat" startup files

The batch file itself can be broken down into several steps:

1.  Do a Maven build of some of the projects (yes, redundant after the above)
2.  Copy some build subdirectories to the deployment server location
3.  Set up self-signed SSL certificates and keystores for the deployment servers
4.  Copy lots more files into the right place in the deployment server directories

I'm not sure how this best works with our Bamboo server. I started creating a new plan, but when it asked which repository to use (we're using two servers and six repositories) I started to get mightily confused!

If I understand correctly - which I may not - I believe that the normal thing to do would be to do all the building on the Bamboo server and then move files to the right place on the servers, before calling some remote startup command. Is this what I need to do here?

Even if someone can point me to a good guide to Bamboo, I'd be very appreciative. If someone can explain the concepts briefly enough for me to understand what specifically I need to learn to achieve, then that'd be even better!!

Advice much appreciated :)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-18T00:38:19.920

好吧，我没有很多在 Windows 上运行 Bamboo 的经验，但我会试一试 :) 首先请允许我将您引导至 Bamboo 管理员指南 2.6 版：

[https://confluence.atlassian.com/display/BAMBOO026/Bamboo+Administrator%27s+Guide](https://confluence.atlassian.com/display/BAMBOO026/Bamboo+Administrator%27s+Guide)

查看有关[计划](https://confluence.atlassian.com/display/BAMBOO026/Configuring+Projects+and+Plans)和[代理](https://confluence.atlassian.com/display/BAMBOO026/About+Agents+and+Capabilities)的部分。

使用您拥有的 Bamboo 版本，计划基本上由脚本组成。它可以是 Ant 脚本或 Maven 脚本或批处理或 bash 脚本。但你只能得到一个。Bamboo 的更高版本允许您运行多个脚本——您真的应该考虑升级。

但是，如果你绝对不能升级，你需要编写一个单一的、整体的脚本来运行每个 maven 任务，然后运行 ​​DeployLocal.bat 文件，然后启动两个 JBoss 实例。（Bamboo 会为您处理源代码签出位。）然后您必须在 Bamboo 中配置您的计划以[运行脚本](https://confluence.atlassian.com/display/BAMBOO026/Script+Builder)。

所以，让我们谈谈策略！

* * *

**+ 我是否在 Bamboo 服务器上构建我的代码，并将其复制到远程 Windows 服务器？还是我在远程 Windows 服务器上构建它？**

首先，您应该[确定您的 Bamboo 许可证是否](https://confluence.atlassian.com/display/BAMBOO026/Viewing+Bamboo%27s+System+Information)支持[远程代理](https://confluence.atlassian.com/display/BAMBOO026/About+Agents+and+Capabilities)。登录到 Bamboo 并单击管理。然后向下滚动到左侧边缘的系统菜单。单击“许可证详细信息”。“支持的远程代理数量”下的值是否大于 0？

**如果是这样：** 耶！您可以在 Windows 部署服务器上[安装远程代理，并使用](https://confluence.atlassian.com/display/BAMBOO026/Creating+a+Remote+Agent)[功能](https://confluence.atlassian.com/display/BAMBOO026/Configuring+Capabilities)配置您的计划以在该远程代理上运行。这意味着当您在 Bamboo 中运行计划时，所有源代码检查/构建/脚本都将在 Windows 部署服务器上运行。您刚刚为自己节省了大量工作！

**如果不是：** 您必须在 Bamboo 服务器上构建代码，然后将其传输到部署服务器。您需要弄清楚如何执行以下操作：

1.  如何将文件从 Bamboo 服务器传输到 Windows 服务器。您可能会考虑的一件事是在一台服务器上设置 NFS 文件共享并将其安装在另一台服务器上。或者在任何一台机器上设置一个 FTP 服务器。

2.  如何从 Bamboo 服务器在 Windows 服务器上执行命令，以便运行 DeployLocal.bat 文件并启动 JBoss。在 Unix 环境中，使用 ssh 很容易做到这一点。在 Windows 中——嗯——也许你应该咨询一些 Windows 窥视者？我之前已经能够成功地使用[MobaSSH](http://mobassh.mobatek.net/)服务器在 Windows 机器上远程运行批处理文件，但 MobaSSH 真的只有当你的 Bamboo 机器是 Unix 时才有意义。

3.  如何在构建后打包代码，以便将其从 Bamboo 服务器复制到 Windows 服务器。这可以像压缩 maven 构建的输出并在 Windows 服务器上解压缩一样简单。

4.  如何将它们整合在一起：编写一个脚本来构建、打包、传输和解包您的代码，然后**远程**运行 DeployLocal.bat 和 jboss 脚本。

* * *

**+ 如何让我的 Bamboo 计划从多个存储库中签出代码？**

不幸的是，Bamboo 3.3 是第一个允许作业从多个存储库中检出源代码的版本。您在这里有三个选项，从最好到最差排序：

1.  [升级到更新版本的 Bamboo](https://confluence.atlassian.com/display/BAMBOO/Bamboo+4.1+Upgrade+Guide)。可能是一个痛苦的过程，因为你落后太多，但可能值得付出努力。最终有人将不得不升级它——现在比以后更好。

2.  [用svn:externals](http://svnbook.red-bean.com/en/1.5/svn.advanced.externals.html)作弊。在您的 subversion 存储库中创建一个新目录，并在其上设置 svn:externals 属性，并引用您需要 Bamboo 签出的六个存储库中的每一个。配置 Bamboo 以检出您的新目录——瞧，这些 svn 存储库中的每一个都将被自动检出。

3.  想出一些其他的技巧来解决这个限制，例如编写一个脚本，为每个存储库运行一次 svn 客户端。

* * *

**+ 这可能需要一段时间才能开始工作。**

是的。您绝对应该检查您的同事已经设置的所有计划的配置和脚本——他们可能已经为您完成了所有或大部分工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-13T04:39:17.073

如果您（或其他开发人员）的计划不支持远程代理，解决方法是使用**tomcat 管理器**（当然要加强它）：

*   所以在你的竹服务器上做你的 svn 或 git checkout，无论是在 linux 还是 windows
*   mvn clean install 在同一台服务器上
*   使用竹作业通过 scp 复制工件
*   使用 tomcat 管理器部署战争
*   对于本地windows服务器上的其他批处理文件，可以通过powershell脚本或任务调度器触发

# ios - UITableView reloadSection causes cellForRowAtIndexPath to be called for ALL rows

> ID：10301177
> 
> 赞同：0
> 
> 时间：2012-04-24T15:33:11.527
> 
> 标签：ios, uitableview

I have an app with a `UITableViewController`, initially with a single section with a single row (that says "Loading..." in it). It fetches some data from the internet, at which point it makes the following call:

```
[tableView reloadSections:[NSIndexPath indexSetWithIndex:0] withRowAnimation:UITableViewRowAnimationFade]; 
```

This is necessary because after fetching the data, there's now a lot of rows, rather than just the 1 there was initially (so asking the table view for the list of visible cells isn't a possibility, since it just returns the 1 old one)

The trouble is that it's then calling the `cellForRowAtIndexPath` delegate method for *every single row*, not just the visible ones. I've verified that by putting some logging into the method. If I switch the line to a simple `[tableView reloadData]` then it only calls `cellForRowAtIndexPath` for the first few rows, until the point where you scroll and others come into view. This happens on my iOS4 iPod Touch and also in the iOS5 simulator.

I have about 300 rows and it's making it very slow to load and usually crashes on my iPod Touch.

The reason I'm not just using `reloadData` is that I want the addition of the new rows to be animated, whereas `reloadData` just makes them suddenly appear.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:37:46.020

你可以这样做：

```
[tableView reloadRowsAtIndexPaths:[tableView indexPathsForVisibleRows] 
                 withRowAnimation:UITableViewRowAnimationNone]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:37:32.107

这就是我用来向表中添加行的方法：

```
NSMutableArray *indexPathsToInsert = [[NSMutableArray alloc] init];

    for (NSInteger i = previousTableDataCount; i < [tableData count]; i++) {
        [indexPathsToInsert addObject:[NSIndexPath indexPathForRow:i inSection:0]];
    }

    // Apply the updates.
    [tableView beginUpdates];

    [tableView insertRowsAtIndexPaths:indexPathsToInsert withRowAnimation:UITableViewRowAnimationNone];
    [tableView endUpdates]; 
```

它不会重新加载所有数据，它只是在现有 tableView 的底部插入新行。tableData 数组是表的数据源数组，previousTableDataCount 是 tableData 数组在插入来自 Internet 的新数据之前所具有的项目的索引...

# php - PHP Array removing the duplicate key value and displaying only one

> ID：10301184
> 
> 赞同：3
> 
> 时间：2012-04-24T15:33:41.080
> 
> 标签：php, multidimensional-array

```
Array
(
    [0] => Array
        (
            [user_id] => 78
            [post_id] => 3
            [post_user_added_id] => 2
        )

    [1] => Array
        (
            [user_id] => 76
            [post_id] => 8
            [post_user_added_id] => 16
        )

    [2] => Array
        (
            [user_id] => 78
            [post_id] => 9
            [post_user_added_id] => 12
        )

    [3] => Array
        (
            [user_id] => 76
            [post_id] => 9
            [post_user_added_id] => 15
        )

     [4] => Array
         (
             [user_id] => 77
             [post_id] => 9
             [post_user_added_id] => 15
         )

) 
```

The idea here is that when there is a duplicate user_id, it will just display only one? This is the expected result:

```
 Array
 (
      [2] => Array
          (
             [user_id] => 78
             [post_id] => 9
             [post_user_added_id] => 12
           )

        [3] => Array
            (
                [user_id] => 76
                [post_id] => 9
                [post_user_added_id] => 15
            )

         [4] => Array
             (
                 [user_id] => 77
                 [post_id] => 9
                 [post_user_added_id] => 15
             )

    ) 
```

The reason why [2] key instead of [0] key or [1] key instead of [3] is displayed because I want to get the bottom key of the duplicate key. It's kinda hard to explain but I hope you understood the scenario or the output that I expected.

Your help would be greatly appreciated! Thanks! :)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T15:38:44.663

尝试这个 ：

```
foreach($arr as $k => $v) 
{
    foreach($arr as $key => $value) 
    {
        if($k != $key && $v['user_id'] == $value['user_id'])
        {
             unset($arr[$k]);
        }
    }
}
print_r($arr); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T15:38:47.393

尝试

```
$array = Array (
        "0" => Array (
                "user_id" => 78,
                "post_id" => 3,
                "post_user_added_id" => 2 
        ),

        "1" => Array (
                "user_id" => 76,
                "post_id" => 8,
                "post_user_added_id" => 16 
        ),

        "2" => Array (
                "user_id" => 78,
                "post_id" => 9,
                "post_user_added_id" => 12 
        ),

        "3" => Array (
                "user_id" => 76,
                "post_id" => 9,
                "post_user_added_id" => 15 
        ),

        "4" => Array (
                "user_id" => 77,
                "post_id" => 9,
                "post_user_added_id" => 15 
        ) 
);
$keys = array ();

// Get Position
foreach ( $array as $key => $value ) {
    $keys [$value ['user_id']] = $key;
}

// Remove Duplicate
foreach ( $array as $key => $value ) {
    if (! in_array ( $key, $keys )) {
        unset ( $array [$key] );
    }
}
var_dump ( $array ); 
```

输出

```
array
  2 => 
    array
      'user_id' => int 78
      'post_id' => int 9
      'post_user_added_id' => int 12
  3 => 
    array
      'user_id' => int 76
      'post_id' => int 9
      'post_user_added_id' => int 15
  4 => 
    array
      'user_id' => int 77
      'post_id' => int 9
      'post_user_added_id' => int 15 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T15:41:24.813

您可以使用 foreach 循环覆盖 user_id。我认为这样的事情应该有效

```
$new = array();
foreach ($array as $value)
{
    $new[$value['user_id']] = $value;
}
print_r($new); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-05T23:49:50.910

以下为我工作，用于清洁以下内容：

```
$arr = array(

    array("ID"=>"234"),
    array("ID"=>"235"),
    array("ID"=>"236"),
    array("ID"=>"236"),
    array("ID"=>"234"),
    ); 
```

代码：

```
for ($i=0; $i <count($arr) ; $i++) {

    $distinct_id = $arr[$i]["ID"]; // this is the ID for which we want to eliminate the duplicates
    $position = $i; // position of that array (so we ignore it)
    $unset_arr = array(); // these duplicate entries will be removed

    // Collect list of duplicates to remove
    for ($y=0; $y <count($arr) ; $y++) {

        // Skip the position of the array that we're checking (we want to remove duplicate not the original)
        if($y == $position)
            continue;

        // If found remove and reset keys
        if($arr[$y]["ID"] == $distinct_id) {
            $unset_arr[] = $y;
        }

    }

    // Remove IDs collected in the loop above
    foreach ($unset_arr as $k) {
        unset($arr[$k]);
    }

    // Reset keys
    $arr = array_values($arr);

} 
```

（如果要删除较新的重复项而不是较旧的重复项，请反转数组）

# javascript - Detect redirect in iFrame

> ID：10301193
> 
> 赞同：10
> 
> 时间：2012-04-24T15:34:08.333
> 
> 标签：javascript, jquery

I may be asking the wrong question here so I will provide a small amount of detail about what I am trying to accomplish.

I use a third party web app to track support tickets. They provide the code for a form that my users fill out and it submits to their domain. I want to use this form on two different domains, but unfortunately the third party uses a single, hard coded redirect value. This causes one of my sites to switch domains after submission.

I was thinking I could embed their form in an iFrame, detect the redirection on successful form submission and instead redirect to one of my own pages.

Pseudocode:

```
iframe.detectRedirection
if (redirect == 'xyz.html') {  
     //do my own redirection in main window.
} 
```

So back to my original question - how can I detect the redirection in the iframe?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-24T15:56:08.193

你可以试试

```
$("iframe").load(function(){
    //The iframe has loaded or reloaded. 
}); 
```

检测帧加载和刷新

如果重定向发生在第二次加载

```
//var to count times iframe has loaded
var timesRefreshed = 0;

//detect iframe loading/refreshing
$("iframe").load(function(){

    //if second refresh, change frame src - ie dont count first load
    if(timesRefreshed == 1){
        $(this).attr("src","my site url here");
    }

    //add to times resreshed counter
    timesRefreshed++; 

}); 
```

如果有更多阶段，只需将 x 更改为阶段数量

```
if(timesRefreshed == x) 
```

这不是充分的证据。即如果另一个站点添加一个阶段等可能会中断，但如果您对另一个站点没有任何控制权，它是我能想到的最好的。

# php - validating file upload server side - allow only images with php

> ID：10301200
> 
> 赞同：2
> 
> 时间：2012-04-24T15:34:27.740
> 
> 标签：php, security, validation, image-uploading

new guy here asking a question that what should be met with simple solutions.

I have tried a bunch of code. It seems I can get the file stream for getimagesize and get other things to work without crashing.

I'm dusting off an old project that needs to limit the files uploaded so that they are only image files and nothing evil.

This code always give me an error message no matter what

```
$imageinfo = getimagesize($_FILES['bf_file'][$key]['tmp_name']);  
if($imageinfo['mime'] != 'image/gif' && $imageinfo['mime'] != 'image/jpeg') {  
alert ("Sorry, we only accept GIF and JPEG images");  
exit;  
} 
```

Here is the black list effort

```
$blacklist = array(".php", ".phtml", ".php3", ".php4", ".js", ".shtml", ".pl" ,".py"   
,".txt", ".doc");

foreach ($blacklist as $file)
{
if(preg_match("/$file\$/i", $_FILES['bf_file'][$key]['tmp_name']))
{
alert "ERROR: Uploading executable files Not Allowed\n";
exit();
}
} 
```

Here is another getimagesize

```
$size = getimagesize($_FILES[bf_file][$key][tmp_name]);
$fp = fopen($_FILES[bf_file][$key][tmp_name], "rb");
if ($size && $fp) {
header("Content-type: {$size['mime']}");
fpassthru($fp);
continue;
} else
// error
alert("Inappropriate file type"); 
```

On each of these I get the error message no matter if a file is uploaded or not.

I just need to place these controls somewhere in my file so that if the uploaded file passes the checks then everything just passes through as the uploader and everything else works like it should but without the benefit of these limiters and checks.

Also, the user should not be required to upload file. There are 3 fields, subject, body and file upload. Only subject and body are required to have data and that works right now.

Any help will be greatly appreciated.

Thanks,

James

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:08:31.577

在第一个片段中。好吧，`getimagesize()`实际上返回 MIME 类型（与 Baba 所说的相反），但您不应该依赖它。完全有可能制作一开始看起来像的文件~~PNG~~GIF（有什么理由阻止 PNG？），但在标题之后有`<?php dangerous_code(); ?>`. 另外，我不知道你在尝试什么`[$key]`。我不知道它的作用和数组是什么样`$_FILES[$form_name][$file_field]`的（例如`$_FILES['file_input']['tmp_size']`。没有第三个字段。除非您正在上传多个文件，否则请查看 Baba 所说的内容（这是非常 hacky 的功能）。接下来，PHP 没有`alert()`- 你可能是说`echo`。

在第二个片段中，我看到你做错了。点是正则表达式中的元字符，但在这种情况下它并不重要。黑名单方法无论如何都是有缺陷的，因为您不知道您的服务器是否不支持`.php5`扩展。即使没有，也有人可以通过制作文件来滥用 Apache 中的[内容协商](http://httpd.apache.org/docs/current/content-negotiation.html)`hack.php.fr`（Apache 认为那`.fr`是语言）。您的方法是有缺陷的 -`.png`无论原始扩展名是什么，只要给 PNG 文件扩展名等等。

在第三个示例中，您激活了错误的变量-但也使用了裸词（您不应该，虽然我知道您应该使用大写常量（因此与 PHP 所说的相反，如果您有常识，裸词并不是那么危险） ，它们非常慢，比普通字符串慢得多，并且如果你有很多错误`E_NOTICE`（提示：你应该））。接下来，`continue`不是用于`if`条件 - 它是用于循环条件（它也适用于`switch`(as `break`)，但我想这只是为了保持一致性）。

至于不必上传文件，这很容易。只做有条件的结束`isset($_FILES['file_input_name'])`。

**tl;dr** - 正确学习 PHP

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T15:47:25.700

您的脚本到处都是示例

```
$imageinfo = getimagesize($_FILES['bf_file'][$key]['tmp_name']); 
```

获取临时名称应该是`$_FILES['bf_file']['tmp_name'][$key]`并且文件大小已经通过返回`$_FILES['bf_file']['size'][$key]`

您为什么不看一下类似问题的详细信息示例

[文件上传时多张图片上传数量错误](https://stackoverflow.com/questions/10170277/multi-image-upload-wrong-quantity-on-file-upload/10170975#10170975)

[借助数组上传图像并获取错误](https://stackoverflow.com/questions/10093366/uploading-images-with-the-help-of-arrays-and-fetch-errors/10095087#10095087)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T16:42:22.837

到目前为止，最安全的方法是阻止您的网络服务器在用户可以完全上传到的文件夹中执行动态内容。然后，他们上传什么都没关系。

上传目录中包含的 .htaccess 文件`php_flag engine off`将阻止 php.ini 文件。无论如何，其他可执行的东西应该默认被禁用，但你一定要检查。

# mongodb - 在 MongoDb 中是在插入/更新原子操作期间创建集合吗？

> ID：10301212
> 
> 赞同：2
> 
> 时间：2012-04-24T15:34:59.810
> 
> 标签：mongodb

是否可以在从 2 个不同客户端向 MongoDB 的第一次插入集合时创建竞争条件？

如果集合尚不存在并且两个不同的应用程序尝试写入，则可能会出现某种竞争条件，两者都尝试创建集合，或者是在写入过程中创建集合的原子操作无法'不允许这样的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T15:38:56.007

[昨晚](http://www.phxmug.org/events/55439142/)参加了一个MongoDB 聚会，并且能够直接向[10gen](http://www.10gen.com/)工程师提出这个问题。他的回答表明创建集合/写入集合是一项操作，不会导致第二次写入失败的竞争条件。

# javascript - 选择菜单以链接到 jquery 选项卡

> ID：10301213
> 
> 赞同：0
> 
> 时间：2012-04-24T15:35:03.653
> 
> 标签：javascript, jquery

我正在使用[jQuery Show/Hide 插件](http://papermashup.com/jquery-show-hide-plugin/)在 3 个选项卡（map-americas、map-europe 和 map-aspac）中显示内容。

I have a select menu that lists countries, but when one of those are selected, I would like the appropriate 'tab' to become visible.

我的代码如下；

```
<div id="map-global">
    <div id="selection">
        <select name="jumpMenu" id="jumpMenu">
            <option value="#map-americas">Americas - Cuauhtémoc</option>
            <option value="#map-americas">Americas - New York</option>
            <option value="#map-americas">Americas - Santa Clara</option>
            <option value="#map-europe">Europe - Accrington</option>
            <option value="#map-europe">Europe - Barcelona</option>
            <option value="#map-europe">Europe - Bergamo</option>
            <option value="#map-aspac">Asia Pacific - Lane Cove</option>
            <option value="#map-aspac">Asia Pacific - Mumbai</option>
            <option value="#map-aspac">Asia Pacific - Singapore</option>
        </select>
    </div>
</div>
<div id="map-americas">
    Some content
</div>
<div id="map-europe">
    Some content
</div>
<div id="map-aspac">
    Some content
</div>
<ul class="nav">
    <li><a class="loc-global" href="#map-global"></a></li>
    <li><a class="loc-america" href="#map-americas"></a></li>
    <li><a class="loc-europe" href="#map-europe"></a></li>
    <li><a class="loc-apac" href="#map-aspac"></a></li>
</ul> 
```

如您所见，“选择”div 包含选择菜单，根据您选择的项目，应该显示适当的“map-X”div。

注意：我已经编辑了上面的代码，以表明当用户第一次来到页面时，选择是在“地图全局”div 中。

因此，当用户选择一个选项时，“map-global”应该隐藏，“map-americas”、“map-europe”或“map-aspac”div 应该显示。“导航”无序列表中的相应链接也应该应用“当前”类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:39:14.413

这应该可以解决问题:)

HTML：

```
<div class="map" id="map-americas">
Some content
</div>

<div class="map" id="map-europe">
Some content
</div>

<div class="map" id="map-aspac">
Some content
</div> 
```

JS：

```
$(function() {
    $("#jumpMenu").change(function() {
        $("div.map").hide();
        $($(this).val()).show();
    });
    $("div.map").hide();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:58:25.010

如果您不想更改 HTML，您可以这样做：

```
$(function() {
    var $maps = $('#map-americas').add('#map-europe').add('#map-aspac');
    $maps.hide();    
    $maps.add('#map-global');
    $navItems = $('ul.nav a');

    $("#jumpMenu").change(function() {
        $maps.hide();
        var mapName = $(this).val();
        $(mapName).show();
        $navItems.removeClass('current');
        $navItems.filter('[href=' + mapName + ']').addClass('current');
    });
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T16:18:55.427

这就是我要做的：

```
// Cache variable that searches for all divs with an id that 
// begins with "map-" and immediately hide them.
var $mapTabs = $("div[id^='map-']").hide();

// Attach change event handler 
$("#jumpMenu").on("change", function() {

    // Hide all map tabs
    $mapTabs.hide();

    // Filter map tabs down to the selected option and show it
    $mapTabs.filter("#" + this.value).show();

}).change();​ // immediately invoke so the default option's tab is shown 
```

***[请参阅工作 jsFiddle 演示](http://jsfiddle.net/DotNetScott/LTZNk/)***

# objective-c - 将 XML NSString 解析为 NSDate 输出（空）

> ID：10301223
> 
> 赞同：0
> 
> 时间：2012-04-24T15:35:34.573
> 
> 标签：objective-c, nsstring, nsdate, nsdateformatter

我想我的问题更像是：dateString1 和 dateString2 有什么区别？

```
NSString *dateString = [NSString stringWithFormat:@"2012-07-09 04:10:00 +0000"];
NSString *dateString2 = [NSString stringWithFormat:[[list objectAtIndex:0] nsDate]];
NSArray *chunks = [dateString2 componentsSeparatedByString:@">"];
NSString *correct = [chunks objectAtIndex:0];

NSLog(@"StingOne:%@", dateString);
NSLog(@"InvalidTwo:%@", dateString2);
NSLog(@"StingTwo:%@", correct);

NSDate *datefromString = [[NSDate alloc] init];
NSDate *datefromString2 = [[NSDate alloc] init];

NSDateFormatter *formater = [[NSDateFormatter alloc] init];
[formater setDateFormat:@"yyyy-MM-dd hh:mm:ss z"];
NSDateFormatter *formater2 = [[NSDateFormatter alloc] init];
[formater2 setDateFormat:@"yyyy-MM-dd hh:mm:ss z"];

datefromString = [formater dateFromString:dateString];
datefromString2 = [formater2 dateFromString:correct];

NSLog(@"1st DATE:%@", datefromString);
NSLog(@"2nd DATE:%@", datefromString2); 
```

正如您在这段代码中看到的，我将两个字符串转换为 NSDate。这是我在日志控制台中得到的：

```
2012-04-24 17:22:09.586 NSString2NSDate[20233:f803] StingOne:2012-07-09 04:10:00 +0000
2012-04-24 17:22:09.589 NSString2NSDate[20233:f803] InvalidTwo:2012-07-19 23:00:00 +0000>
2012-04-24 17:22:09.590 NSString2NSDate[20233:f803] StingTwo:2012-07-19 23:00:00 +0000
2012-04-24 17:22:09.594 NSString2NSDate[20233:f803] 1st DATE:2012-07-09 04:10:00 +0000
2012-04-24 17:22:09.595 NSString2NSDate[20233:f803] 2nd DATE:(null) 
```

我不知道这里有什么问题，因为两个字符串都将正确的 NSLog 作为字符串输出。我注意到从 xml 解析的 dateString2 最后有“>”，这肯定是在过程中的某个地方添加的，所以我删除了它，但 NSDate 仍然是（null）。

这是字符串编码问题吗？我该如何纠正？

XML 文件编码为 utf-8。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:42:40.717

`hh`表示范围内的小时数`1-12`并`HH`表示范围内的小时数`0-23`。所以你应该使用`HH`而不是`hh`能够解析`23:00:00`.

```
NSDateFormatter *formater = [[NSDateFormatter alloc] init];
[formater setDateFormat:@"yyyy-MM-dd HH:mm:ss z"];

NSDate *datefromString = [formater dateFromString:dateString];
NSDate *datefromString2 = [formater dateFromString:correct]; 
```

* * *

另请注意，我只使用了一个`NSDateFormatter`. 使用两个不是错误，但第二个不是必需的。

# performance - 仅存储日期的最有效方法？

> ID：10301224
> 
> 赞同：0
> 
> 时间：2012-04-24T15:35:40.167
> 
> 标签：performance, sql-server-2008, datetime, smalldatetime

> DateTime 精确到百分之三秒。SmallDateTime 精确到一分钟。

如果您只需要精确到一天怎么办？这里的最佳做法是什么？我意识到 DateTime 是 8 个字节，而 SmallDateTime 只有 4 个；但我只是想知道是否有比创建 SmallDateTime 列并在其中保存 SmallDateTime.Date 更好或更合适的方法来仅存储日期值？

每一点都有帮助！:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T15:42:38.010

这取决于您运行的 SQL Server 版本。

*   2008+：日期
*   2008-: 小日期时间

虽然，如果您查看[smalldatetime 的文档](http://msdn.microsoft.com/en-us/library/aa258277.aspx)，它们使用两字节整数作为日期，使用两字节整数作为时间，因此您可能会复制它们的行为并只存储一个两字节整数（smallint），然后使用 DateAdd如果在这种情况下大小*真的那么重要，则添加自 1900/1/1 以来的天数。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T15:42:20.820

使用 3 字节日期。查看[`Date`数据类型](http://msdn.microsoft.com/en-us/library/bb630352.aspx)

# azure - 是否可以创建 WCF 服务端点来处理来自 Azure 服务总线的死信？

> ID：10301231
> 
> 赞同：2
> 
> 时间：2012-04-24T15:36:00.090
> 
> 标签：azure, servicebus

浏览 Azure 服务总线文档和 Web 上的帖子，我只能找到使用 MessageReceiver 类从 $DeadLetterQueue 读取死信的死信处理示例。

虽然上述场景工作正常，但我很好奇是否支持以下场景：

我可以指向一个单独的 WCF 服务端点来基本上侦听直接死信队列（例如 sb://mynamespace.servicebus.windows.net/MyTopic/subscriptions/MySubscription/$DeadLetterQueue）上的消息吗？

期望随着新死信的添加，触发此侦听 WCF 服务端点来处理消息。到目前为止，我进行的实验表明这不受支持。

任何人都知道 Azure 服务总线是否可以处理此配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T06:54:39.380

我认为这应该可行并将尝试一下，只是想知道您是否看过以下[指导](http://msdn.microsoft.com/en-us/library/microsoft.servicebus.messaging.netmessagingbinding.aspx)：使用 WCF 发布/订阅服务模型时，添加服务端点时，您必须将主题 URI 指定为地址，并且订阅 URI 作为监听 URI。您应该能够用 sb://mynamespace.servicebus.windows.net/MyTopic/subscriptions/MySubscription/$DeadLetterQueue 替换监听 URI

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T07:29:25.400

抱歉，目前我找不到任何关于此的文档。[您可以在http://www.mygreatwindowsazureidea.com/forums/40626-windows-azure-appfabric-feature-voting](http://www.mygreatwindowsazureidea.com/forums/40626-windows-azure-appfabric-feature-voting)上提交功能请求。作为一种解决方法，您可以使用 MessageReceiver 来读取消息，然后如果您愿意，可以将消息发送到 WCF 服务。

# php - 如何将 PostgreSql 与 PHP 结合？

> ID：10301232
> 
> 赞同：1
> 
> 时间：2012-04-24T15:36:04.367
> 
> 标签：php, postgresql, pdo

我曾经使用“已经准备好的网络环境”（apache + php + 一些 rdbms），例如lampp。现在我有了机器，内存有限，无法安装像 lammp 这样的东西（它太大了），但我需要一些网络环境。我已经安装了 apache（来自发行版），PHP 与 OS（DEBIAN）一起安装。我安装了我最喜欢的 rdbms，它是 PostgreSQL，但有一个问题：PHP 不想与 postgresql 一起工作。当我显示 phpinfo() 时，我可以看到在 PDO 表中启用了 notihng。

现在，问题是：我真的需要重新编译我的 PHP 吗？PHP 文档（http://www.php.net/manual/en/pgsql.installation.php）还说：“...如果共享对象模块可用，PostgreSQL 模块可以使用 php.ini 中的扩展指令加载或dl() 函数”。

我试过：extension=pgsql.so 但没用

有人能帮忙吗？我已经尝试这样做了几个小时:(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T15:39:20.450

在 debian 上，您需要安装 package `php5-pgsql`。试试看嘛

```
sudo apt-get install php5-pgsql 
```

（您可能最终不得不安装一些依赖项。）

# asp.net - 在asp.net中将日期时间转换为字符串

> ID：10301233
> 
> 赞同：1
> 
> 时间：2012-04-24T15:36:11.293
> 
> 标签：asp.net, datetime

我正在调用 datalist 中添加的列之一，例如：

```
<asp:Label ID="lblDate" runat="server" Text='<%# Eval("DateAdded") %>'></asp:Label> 
```

显示它显示 24/04/2012 12:07:52 我想显示：2012 年 4 月，

任何人都可以就如何获得此显示提供任何帮助谢谢更新：

我试过这个没有成功：

```
<asp:Label ID="lblDate" runat="server" Text='<%# Eval("DateAdded").ToString("yyyyMM") %>'></asp:Label> 
```

更新 2 [工作]：

```
'<%# Eval("DateAdded" ,"{0:MMMM yyyy}") %>'> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T15:41:00.947

你几乎拥有它。像这样的东西应该工作：

```
Text='<%# Eval("DateAdded", "{0:MMMM yyyy}") %>' 
```

您的示例的问题是`Eval`函数返回 type `object`，因此它不知道如何应用格式。函数重载（上面）接受一种格式，并且可以在`Eval`幕后解决所有这些问题，但您也可以通过将值转换或转换为来解决这个问题`DateTime`：

```
Text='<%# ((DateTime)Eval("DateAdded")).ToString("MMMM yyyy") %>' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-27T03:42:23.143

你可以使用这个：

```
DateTime.Now.ToString("MMMM d, yyyy h:mm tt"); 
```

# php - 在 php 中使用过多的 include()

> ID：10301240
> 
> 赞同：7
> 
> 时间：2012-04-24T15:36:27.937
> 
> 标签：php, include

我有在我的 php 脚本中大量使用 include() 的习惯。我想知道这是一个好方法。我只是经常使用 include，因为它使代码看起来更适合面向未来的编程。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T15:37:12.480

而不是使用 include 你可能想看看[autoloading](http://php.net/manual/en/function.spl-autoload.php)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-24T15:38:23.993

利用php自动加载功能

例子：

```
function __autoload($class_name) {
    include $class_name . '.php';
} 
```

每当您实例化一个新类时。PHP 使用一个参数即类名自动调用 __autoload 函数。考虑下面的例子

```
$user = new User(): 
```

当您在此处实例化用户对象时，会调用自动加载函数，它会尝试包含同一目录中的文件。（参考上面的自动加载功能）。现在您可以实现自己的逻辑来自动加载类。无论它驻留在哪个目录中。有关更多信息，请查看此链接[http://in.php.net/autoload](http://in.php.net/autoload)。

**更新：** @RepWhoringPeeHaa，你说得对，伙计。使用 spl_autoload 比使用简单的自动加载功能有更多好处。我看到的主要好处是可以使用或注册多个功能。

例如

```
function autoload_component($class_name) 
{
    $file = 'component/' . $class_name . '.php';
    if (file_exists($file)) {
        include_once($file);
    }
}

function autoload_sample($class_name)
{
    $file = 'sample/' . $class_name . '.php';
    if (file_exists($file)) {
        include_once($file);
    }
}
spl_autoload_register('autoload_component');
spl_autoload_register('autoload_sample'); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-24T15:38:46.723

如果您正在开发面向对象并且每个类都有一个文件，请考虑实现一个自动加载函数，该函数会`include`在一个类已使用但尚未加载时自动调用：

```
$callback = function($className) {
    // Generate the class file name using the directory of this initial file
    $fileName = dirname(__FILE__) . '/' . $className . '.php';
    if (file_exists($fileName)) {
        require_once($fileName);
        return;
    }
};

spl_autoload_register($callback); 
```

# c# - Excel：Ctrl + 向下箭头操作

> ID：10301242
> 
> 赞同：0
> 
> 时间：2012-04-24T15:36:40.917
> 
> 标签：c#, export-to-excel

任何人都请告诉我单击`CTRL`+时执行的操作程序`↓</kbd> hotkey?`

我知道该程序向下导航到下一个非空单元格。但是当我从 Excel.Interop 创建 Excel 文档时，`CTRL`+`↓</kbd> doesn't work like it have to. It navigates to the last cell in the column...`

任何帮助是极大的赞赏。

更新：我很抱歉不太清楚。我不在乎`CTRL`+`↓</kbd> behaviour actually. I'm concerning about what causes data acting like one big cell?`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T19:04:23.970

杰弗里，

不知道你说的“像一个大细胞一样”是什么意思。如果要获取工作表的整个使用区域，请使用对象`UsedRange`上的`Worksheet`属性。它将返回一个使用范围的二维数组`Worksheet`。`Worksheet`当 a包含表中的所有数据时，我已经使用它。比迭代工作表要容易得多。

干杯!

# javascript - Javascript onclick 事件写入新的 div

> ID：10301243
> 
> 赞同：0
> 
> 时间：2012-04-24T15:36:44.597
> 
> 标签：javascript, onclick, document.write

似乎无法弄清楚为什么这不起作用。我在 href 上有一个 onclick 事件，它应该触发一个编写新 div 的 javascript 函数。任何帮助，将不胜感激。

我很确定我的问题出在链接上，而不是功能上。

```
<html>
<head>
    <title>Blah</title>
    <style type="text/css">
    .box {
        position: fixed;
        z-index: 5;
        width:100%;
        height:100%; 
        background-color: rgba(0,0,0,.8);
        padding:25px 10px 25px 10px;
    }
    .content {
        z-index: 1;
        padding: 25px 15px 10px 15px;
    }
    </style>
</head>

<body>
    <script type="text/javascript">     
        function test() {
            document.write("<div class='box'>Box Test</div>");  
        }
    </script>
    <h1>Test Page</h1>

    <div class="content">
        <a onclick="javascript:test" href="#">Test Test Test</a>
    </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:03:50.887

一种方法，我已经远离了内联 JavaScript，以便 a: JavaScript/行为不那么具有侵入性，并且 b: 所以不需要查看每个元素来影响/改变发生的事情：

```
var d = document,
    as = d.getElementsByTagName('a');

function test(elem,evt){
    evt.preventDefault();
    var div = d.createElement('div'),
        tN = d.createTextNode(elem.firstChild.nodeValue),
        b = d.getElementsByTagName('body')[0];
    div.appendChild(tN);
    b.insertBefore(div,elem.parentNode);
}

for (var i=0,len=as.length;i<len;i++){
    as[i].onclick = function(e){
        test(this,e);
    };
}​ 
```

使用以下 HTML：

```
<h1>Test Page</h1>

<div class="content">
    <a href="#">Test Test Test</a>
</div>​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/58VrE/1/)。

为了尝试解释[Mathletics 的评论](https://stackoverflow.com/questions/10301243/javascript-onclick-event-to-write-new-div/10301670#comment-13256777)，问题在于您正在使用`document.write()`，这肯定会写入文档。不幸*的是，它覆盖*了文档本身；所以页面内容被完全替换。

参考：

*   [`document.createElement()`](https://developer.mozilla.org/en/DOM/document.createElement).
*   [`document.createTextNode()`](https://developer.mozilla.org/en/DOM/document.createTextNode).
*   [`document.write()`](https://developer.mozilla.org/en/document.write).
*   [`element.appendChild()`](https://developer.mozilla.org/en/DOM/element.appendChild).
*   [`element.getElementsByTagName()`](https://developer.mozilla.org/en/DOM/element.getElementsByTagName).
*   [`element.firstChild`](https://developer.mozilla.org/en/DOM/element.firstChild).
*   [`event.preventDefault()`](https://developer.mozilla.org/en/DOM/event.preventDefault).
*   [`node.insertBefore()`](https://developer.mozilla.org/en/DOM/Node.insertBefore)
*   [`node.nextSibling`](https://developer.mozilla.org/en/Document_Object_Model_(DOM)/Node.nextSibling).
*   [`node.nodeValue`](https://developer.mozilla.org/En/DOM/Node.nodeValue).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:40:04.553

```
<html>
<head>
    <title>Blah</title>
    <style type="text/css">
    .box {
        position: fixed;
        z-index: 5;
        width:100%;
        height:100%; 
        background-color: rgba(0,0,0,.8);
        padding:25px 10px 25px 10px;
    }
    .content {
        z-index: 1;
        padding: 25px 15px 10px 15px;
    }
    </style>
</head>

<body>
    <script type="text/javascript">     
        function test() {
            document.write("<div class='box'>Box Test</div>");  
        }
    </script>
    <h1>Test Page</h1>

    <div class="content">
        <a onclick="test()" href="javascript:;">Test Test Test</a>
    </div>

</body>
</html> 
```

看

```
<a onclick="javascript:test" href="#">Test Test Test</a> 
```

更新为

```
<a onclick="test()" href="javascript:;">Test Test Test</a> 
```

缺少括号

注意：我更喜欢使用“javascript:;” 而不是“#”，以防止页面滚动到顶部

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-24T15:39:14.930

```
<a onclick="javascript:test**();**" href="#">Test Test Test</a> 
```

希望有帮助，马丁

# java - Java 7 中的 multi-catch 是如何实现的？

> ID：10301244
> 
> 赞同：11
> 
> 时间：2012-04-24T15:36:45.943
> 
> 标签：java, jvm, try-catch, java-7

Java 7 编译器如何处理多捕获块？一个简单的实现是生成字节码，就好像存在多个 catch 块一样。但是，我从多个来源收集到情况并非如此 -*处理多种异常类型的 catch 块在编译期间不会产生重复的字节码。*

那么它是怎样工作的 ？是否有新的字节码指令告诉 JVM 多捕获块？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-24T16:03:02.777

基于[Java Virtual Machine Specification](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-3.html#jvms-3.12)，异常编译如下（总结）：

*   try 代码运行正常
*   每个 catch 块都被编译为一个单独的方法
*   有一个异常表将执行流重定向到正确的catch块

当使用 multi catch 子句时，catch 块是相同的（仅出现一次），但异常表将包含一个具有相同 from、to 和 target 值的条目。

例如，这段代码：

```
public static void main(String args[]) throws InterruptedException {
    try {
        System.out.println("why not?");
    } catch (IllegalArgumentException e) {
        System.out.println("here");
    } catch (IllegalStateException | ArithmeticException e) {
        System.out.println("there");
    }
} 
```

生成以下异常表（在我的机器上）：

```
 from    to  target type
       0     8    11   Class java/lang/IllegalArgumentException
       0     8    23   Class java/lang/IllegalStateException
       0     8    23   Class java/lang/ArithmeticException 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:02:18.417

异常表的工作方式类似于一种对所有异常类（异常表中的条目）进行迭代的开关，并检查抛出的异常是否实现了它，从而决定在字节码中跳转的位置。

[http://www.artima.com/underthehood/exceptions.html](http://www.artima.com/underthehood/exceptions.html)

据此，您只需要在异常表中创建一个新条目，我不明白为什么两个条目不能只指向相同的 pc 偏移量。

（免责声明：我不是字节码方面的专家，多年没有接触过，所以可能会遗漏一些东西）

# ios - 从 iOS5 发现 WCF Rest Service

> ID：10301245
> 
> 赞同：1
> 
> 时间：2012-04-24T15:36:51.873
> 
> 标签：ios, wcf, wcf-rest, service-discovery

我正在构建一个应该与 WCF 休息服务通信的 iOS 应用程序。他们都将在同一个本地网络上。虽然测试已经硬编码了服务的 IP，但是当它被部署时这将不起作用。

我怎样才能获得服务地址，或以任何方式连接到它？

我正在阅读有关 WCF 发现的信息，但我不知道如何在 iOS 中实现它。

如果有任何帮助，我正在使用 WCF REST 服务模板 40(CS)

任何帮助，将不胜感激。

**编辑：**使用 bonjour 怎么样？有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T17:20:21.837

WCF Discovery 是[WS-Discovery](http://en.wikipedia.org/wiki/WS-Discovery)规范的实现，它是一个开放标准。因此，它有一些实现，例如，Java 中的一种称为[java-ws-discovery](http://code.google.com/p/java-ws-discovery/)，Python 中的一种称为[python-ws-discovery](http://code.google.com/p/python-ws-discovery/)，c 语言中的一种称为[WS Discovery proxy](http://wsdiscoveryproxy.codeplex.com/)。

我还没有在 Objective-C 中找到实现，但鉴于这三个都是开源的，你可以移植一个，或者至少移植你需要的部分（取决于你是否能够理解其中一种语言）。

# windows-phone-7 - 通过 SmoothStreamingMediaElement 播放流时“可用的内容持续时间不足”

> ID：10301246
> 
> 赞同：1
> 
> 时间：2012-04-24T15:36:52.913
> 
> 标签：windows-phone-7, smooth-streaming

我正在使用 SmoothStreamingMediaElement 开发一个具有 IIS 平滑流的应用程序。由于项目的性质，我无法透露流的来源，但是我可以提供有关我遇到的问题的完整技术信息。

出于测试目的，我将 SmoothStreaming 部分分离到一个单独的应用程序中。一切似乎都运行良好，因为 Microsoft 提供的测试流按应有的方式工作（http://video3.smoothhd.com.edgesuite.net/ondemand/Big%20Buck%20Bunny%20Adaptive.ism/Manifest）

我考虑了 Windows Phone 上 SmoothStreaming 的限制： - 在 ManifestReady 事件中，过滤可用曲目以仅显示一种可用分辨率 - 测试时设备未通过 Zune 连接。

出现的错误信息非常清楚：

> “3108 内容持续时间不足，无法开始播放。可用 = 3840 毫秒，需要 = 7250 毫秒”

我无法找到对此错误的任何引用。我确实找到了更多关于 7250 毫秒所需持续时间的来源的信息。[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/microsoft.web.media.smoothstreaming.smoothstreamingmediaelement.liveplaybackoffset%28v=vs.90%29.aspx)表明它与 LivePlaybackOffset 有关，默认为 7 秒，并且无法在 WP7 SmoothStreamingMediaElement 中更改。相同的代码在浏览器-silverlight 应用程序中运行良好。

我无法直接访问提供流的服务器。有没有办法在客户端解决这个问题？还是需要服务器端配置？如果有帮助，我可以分享部分源代码，请让我知道哪些部分是相关的。非常感谢您的帮助！

这是清单文件：

```
<SmoothStreamingMedia MajorVersion="2" MinorVersion="2" TimeScale="10000000" Duration="0" LookAheadFragmentCount="2" IsLive="TRUE" DVRWindowLength="300000000">
<StreamIndex Type="audio" QualityLevels="1" TimeScale="10000000" Name="audio" Chunks="7" Url="http://xxxx/xxx.isml/QualityLevels({bitrate})/Fragments(audio={start time})">
<QualityLevel Index="0" Bitrate="128000" CodecPrivateData="1190" SamplingRate="48000" Channels="2" BitsPerSample="16" PacketSize="4" AudioTag="255" FourCC="AACL"/>
<c t="3485836800000" d="38400000" r="7"/>
</StreamIndex>
<StreamIndex Type="video" QualityLevels="6" TimeScale="10000000" Name="video" Chunks="7" Url="http://xxxx/xxx.isml/QualityLevels({bitrate})/Fragments(video={start time})" MaxWidth="1024" MaxHeight="576" DisplayWidth="1024" DisplayHeight="576">
<QualityLevel Index="0" Bitrate="350000" CodecPrivateData="000000016742E01596540D0FF3CFFF80980097A440000003004000000CA10000000168CE060CC8" MaxWidth="405" MaxHeight="228" FourCC="AVC1" NALUnitLengthField="4"/>
<QualityLevel Index="1" Bitrate="700000" CodecPrivateData="000000016742E01E965404814F2FFF8140013FA440000003004000000CA10000000168CE060CC8" MaxWidth="568" MaxHeight="320" FourCC="AVC1" NALUnitLengthField="4"/>
<QualityLevel Index="2" Bitrate="1000000" CodecPrivateData="000000016742E01E965405217F7FFE0B800B769100000300010000030032840000000168CE060CC8" MaxWidth="654" MaxHeight="368" FourCC="AVC1" NALUnitLengthField="4"/>
<QualityLevel Index="3" Bitrate="1300000" CodecPrivateData="00000001674D4028965605819FDE029100000300010000030032840000000168EA818332" MaxWidth="704" MaxHeight="396" FourCC="AVC1" NALUnitLengthField="4"/>
<QualityLevel Index="4" Bitrate="1600000" CodecPrivateData="00000001674D402A965605A1AFCFFF80CA00CAA440000003004000000CA10000000168EA818332" MaxWidth="718" MaxHeight="404" FourCC="AVC1" NALUnitLengthField="4"/>
<QualityLevel Index="5" Bitrate="2000000" CodecPrivateData="00000001674D4032965300800936029100000300010000030032840000000168E96060CC80" MaxWidth="1024" MaxHeight="576" FourCC="AVC1" NALUnitLengthField="4"/>
<c t="3485836800000" d="38400000" r="7"/>
</StreamIndex>
</SmoothStreamingMedia> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-08T13:38:04.390

我知道这个问题有点老了，但我今天遇到了一个非常相似的问题，所以我想我应该回答它......问题出在 r="7" 这个参数没有记录在 MS 文档中，只能在Smooth Streaming 2.2 及更高版本（不是 2.0）。r="7" 表示清单中的块应该重复 7 次，这意味着您总共有 7 * 3.84 秒。

这里有一篇博文对此进行了解释：http: [//blogs.iis.net/samzhang/archive/2011/03/10/how-to-troubleshoot-live-smooth-streaming-issues-part-5-client-清单.aspx](http://blogs.iis.net/samzhang/archive/2011/03/10/how-to-troubleshoot-live-smooth-streaming-issues-part-5-client-manifest.aspx)

# ipad - Monotouch 的 UIPopoverController 和 UIImagePickerController 问题

> ID：10301248
> 
> 赞同：1
> 
> 时间：2012-04-24T15:36:55.863
> 
> 标签：ipad, xamarin.ios, uiimagepickercontroller, uipopovercontroller

我用来开发应用程序 MonoTouch Iphone，但使用 UIPopoverController 时遇到问题。我无法打开页面来选择照片。我使用 camera.cs TweetStation 类。

这是代码：

```
public static void SelectPicture (UIViewController parent, Action<NSDictionary> callback)
    {

        if(OzytisUtils.isIpad()){

            picker = new UIImagePickerController();
            UIPopoverController popover = new UIPopoverController(picker);
            picker.Delegate = new CameraDelegate();
            picker.SourceType = UIImagePickerControllerSourceType.PhotoLibrary;
            popover.SetPopoverContentSize(new SizeF(parent.View.Frame.Width,parent.View.Frame.Height),true);
            if(popover.PopoverVisible){
                popover.Dismiss(true);
                picker.Dispose();
                popover.Dispose();
            }else{
                popover.PresentFromRect(parent.View.Frame,parent.View,UIPopoverArrowDirection.Right,true);

            }

        }else{
            Init ();
            picker.SourceType = UIImagePickerControllerSourceType.PhotoLibrary;
            _callback = callback;           
            parent.PresentModalViewController (picker, true);
        } 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:35:10.667

我有几个建议。首先使 UIPopoverController 成为成员变量，这样它就不会被收集。

其次，我在选择器上调用了 ContentSizeForViewInPopover。

```
picker.ContentSizeForViewInPopover = new SizeF(this.View.Frame.Width,this.View.Frame.Height); 
```

最后，我在屏幕左上角使用了一个 0x0 矩形来调用 PresentFromRect。

```
_popover.PresentFromRect(new RectangleF (0,0,0,0),this.View,UIPopoverArrowDirection.Up,true); 
```

# android - 我的应用程序在 GPS 开启的情况下无法使用

> ID：10301251
> 
> 赞同：0
> 
> 时间：2012-04-24T15:37:01.577
> 
> 标签：android, map, gps

当我启动应用程序（在设备上）时，会显示一个可扩展列表，当我点击一个孩子时，会在地图上显示 2 个点以及它们之间的道路。打开 WiFi 时应用程序工作正常，但如果我打开 GPS 设备，则显示地图但不显示点。

AndroidManifest.xml 中的代码是：

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="aexp.elistcbox"
      android:versionCode="1"
      android:versionName="1.0">

    <uses-sdk android:minSdkVersion="7" />

    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />  
    <uses-permission android:name="android.permission.INTERNET" />

    - <!--  Network related
  --> 
  <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
- <!--  Location related 
  --> 
  <uses-permission android:name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS" /> 
  <uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION" /> 
- <!--  Wifi related  
  --> 
  <uses-permission android:name="android.permission.CHANGE_WIFI_STATE" /> 
  <uses-permission android:name="android.permission.ACCESS_WIFI_STATE" /> 
  <uses-permission android:name="android.Manifest.permission.ACCESS_LOCATION" /> 
  <uses-permission android:name="android.Manifest.permission.ACCESS_GPS" /> 
  <uses-permission android:name="android.permission.ACCESS_ASSISTED_GPS" /> 
  <uses-permission android:name="android.permission.ACCESS_CELL_ID" /> 
  <uses-permission android:name="android.permission.READ_CONTACTS" /> 

    <application android:label="@string/app_name">

        <uses-library android:name="com.google.android.maps" />

        <activity android:name=".ElistCBox"
                  android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
         <activity android:name=".GPSLocatorActivity">
         </activity>
         <activity android:name="aexp.elistcbox.GlobalState"></activity>
    </application>
</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:40:55.267

您是在模拟器上还是在设备上检查它。如果在模拟器上，那么您需要通过转到您的 AVD 来打开 GPS 支持，选择您的 AVD -> 编辑 -> 硬件 -> 新建 -> GPS 支持现在检查....希望它有帮助！

# iphone - IIS 流式传输/将 JSON 推送到 iOS

> ID：10301252
> 
> 赞同：0
> 
> 时间：2012-04-24T15:37:02.273
> 
> 标签：iphone, ios, ipad, push-notification, push

**快速版本：**

我想将来自 IIS WCF RESTfull web 服务的及时数据更新（以 JSON 格式）发送到 iOS 自定义应用程序。由于带宽成本和我需要达到的更新率，我不想进行轮询。我的客户通过互联网与他们的服务器通信。

我对自己的选择感到困惑，而且我阅读的大部分信息都已过时，针对网络浏览器或媒体流。

我应该使用当前的最佳实践/标准实践吗？

**额外细节：**

*   我有大约 25-100 个 iOS (v5.1) 客户端 (iPad)。
*   我希望我的客户在事件发生后大约 5 秒内看到更新。
*   我的客户 24x7 全天候运行，并通过 3G 网络进行通信。
*   应用程序只需要在运行时接收数据（不需要在应用程序最小化时显示通知）。
*   使用 3rd 方服务，或者必须在我这边设置一个特殊的服务器是不行的。
*   无论我做什么都需要与我现有的 IIS WCF web 服务很好地集成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:25:36.993

不需要额外的研究，因为您提出了一个完全受限的问题：

*   只有两种选择：推或拉，拉被排除在外。
*   只有一种推送方式： [APNS](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html)。
*   如果没有第三方的帮助，只有一个选择：建立一个 APNs 提供者。

# foursquare - 我在哪里可以在 Foursquare API 中发布错误？

> ID：10301254
> 
> 赞同：1
> 
> 时间：2012-04-24T15:37:09.527
> 
> 标签：foursquare

我在 4SQ API 中发现了一个奇怪的行为：[搜索场所时地理坐标无效](https://stackoverflow.com/q/10297569/1353618)

我可以在哪里发布这个错误让 4SQ 团队知道它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T14:56:15.247

堆栈溢出是报告问题的最佳场所。Foursquare 将其视为我们的“开发者论坛”。

# python-3.x - 尝试使用 UUID 作为主键。获取有关 SQLalchemy commit() 的陈旧数据

> ID：10301256
> 
> 赞同：3
> 
> 时间：2012-04-24T15:37:16.473
> 
> 标签：python-3.x, sqlalchemy, primary-key, uuid, staledataexception

在此处启动 SQLalchemy 用户。我计划使用 UUID 作为我的表的主键。

在教程中，我看到了一些在 ORM 类中使用原生 Python UUID 类型的代码。尤里卡！我可以为我的系统数据库使用 Postgresql 的本机 UUID 类型，这个 TypeDecorator 将在我的移动客户端上为 SQLite 字符串化 UUID。

[http://docs.sqlalchemy.org/en/latest/core/types.html#backend-agnostic-guid-type](http://docs.sqlalchemy.org/en/latest/core/types.html#backend-agnostic-guid-type)

悲伤。将其与具有字符串化 UUID 作为主键的**现有**SQLite 数据库一起使用时，当我尝试提交任何更改时，我会收到过时的数据错误。

此类在提交时因数据过时而崩溃。

```
class CommodityTypes(Base):
    __tablename__ = 'CommodityTypes'
    uuidKey = Column(GUID, primary_key=True)
    myName = Column(String, unique = True)
    sortKey = Column(Integer, unique = True) 
```

，但是这个类有效：

```
class NewTypes(Base):
    __tablename__ = 'CommodityTypes'
    uuidKey = Column(String, primary_key=True)
    myName = Column(String, unique = True)
    sortKey = Column(Integer, unique = True) 
```

来自 CommodityTypes 类的查询对象显示 uuidKey 的 python UUID 类型。该脚本正确查询对象。我可以更改设置，但我不能提交。装饰的 uuidKey 似乎不起作用。

我可以继续使用字符串作为 uuidKey 列，但令我沮丧的是来自[http://docs.sqlalchemy.org/en/latest/core/types.html#backend-agnostic-guid-type的代码](http://docs.sqlalchemy.org/en/latest/core/types.html#backend-agnostic-guid-type) **几乎**可以工作。

这是有问题的示例代码。不使用 GUID 类型装饰器的字符串解决方法已被注释掉。

```
#system modules
import uuid

#other modules
import sqlalchemy
from sqlalchemy import create_engine
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import relationship, backref, sessionmaker
from sqlalchemy.types import TypeDecorator, CHAR
from sqlalchemy.dialects.postgresql import UUID
from sqlalchemy.orm.exc import MultipleResultsFound, NoResultFound

engine = create_engine('sqlite:////home/XXXX/XobfuscatedXXXX/XXXXXXXX.sqlite')

Base = declarative_base()

Session = sessionmaker(bind=engine)

class GUID(TypeDecorator):
    """Platform-independent GUID type.

    Uses Postgresql's UUID type, otherwise uses
    CHAR(32), storing as stringified hex values.

    """
    impl = CHAR

    def load_dialect_impl(self, dialect):
        if dialect.name == 'postgresql':
            return dialect.type_descriptor(UUID())
        else:
            return dialect.type_descriptor(CHAR(32))

    def process_bind_param(self, value, dialect):
        if value is None:
            return value
        elif dialect.name == 'postgresql':
            return str(value)
        else:
            if not isinstance(value, uuid.UUID):
                return "%.32x" % uuid.UUID(value)
            else:
                # hexstring
                return "%.32x" % value

    def process_result_value(self, value, dialect):
        if value is None:
            return value
        else:
            return uuid.UUID(value)

from sqlalchemy import Column, Boolean, DateTime, Date, Float, ForeignKey, Integer, Numeric, String

class CommodityTypes(Base):
    __tablename__ = 'CommodityTypes'
    uuidKey = Column(GUID, primary_key=True)
    myName = Column(String, unique = True)
    sortKey = Column(Integer, unique = True)

#class NewTypes(Base):
#    __tablename__ = 'CommodityTypes'
#    uuidKey = Column(String, primary_key=True)
#    myName = Column(String, unique = True)
#    sortKey = Column(Integer, unique = True)

if __name__=="__main__":
    session = Session()
#    newList = session.query(NewTypes).order_by(NewTypes.sortKey)
#    for instance in newList:
#        print(instance.myName)
#
#    nt = newList[1]
#    print(nt.myName)
#    print(nt.sortKey)
#    nt.sortKey = 11
#    print(nt.sortKey)
#    session.commit()
#    print(nt.sortKey)

    ctList = session.query(CommodityTypes).order_by(CommodityTypes.sortKey)
    for instance in ctList:
        print(instance.myName)
    ct = ctList[1]
    print(ct.myName)
    print(ct.sortKey)
    ct.sortKey = 22
    print(ct.sortKey)
    session.commit()
    print(ct.sortKey) 
```

哦，忘了说软件版本：

Python 3.1.3（r313:86834，2010 年 12 月 1 日，06:15:12）

[GCC 4.1.2 20080704 (Red Hat 4.1.2-48)] 在 linux2 上

# c - scanf 函数是如何工作的？

> ID：10301259
> 
> 赞同：0
> 
> 时间：2012-04-24T15:37:32.247
> 
> 标签：c

我已经编写了以下代码，但是出现了问题

```
char p[20];
int n;
errno = 0;
n = scanf("%[^\n]",p);
if (1 == n)
{
    printf("%s\n",p);
    scanf("%[^\n]",p);  /*no waiting for input*/
    printf("%s\n",p);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T15:52:58.413

```
n = scanf("%[^\n]",p); 
```

这表示扫描除`\n`ie `ENTER`key 之外的每个字符。所以它允许你输入一个字符串，你会按下`ENTER`。此`ENTER`字符仍在`stdin`缓冲区中，这将终止您的下一条`scanf`语句

```
scanf("%[^\n]",p);/*no executed*/ 
```

因此*在您看来*，它可以执行！`scanf`，首先从缓冲区读取，如果它没有找到足够的数据，然后等待您的输入。

将`ENTER`您首先输入的内容提供给某些功能，例如`getchar()`. 即`getchar()`在你的第二个之前添加一个`scanf`，现在你的第二个`scanf`将接受来自的输入`stdin`

就像是

```
if (1 == n)
{
    printf("%s %d\n",p,n);
    getchar();
    scanf("%[^\n]",p);/*no executed*/
    printf("%s\n",p);
} 
```

# php - 尝试上传照片时如何检查照片是否被选中

> ID：10301262
> 
> 赞同：0
> 
> 时间：2012-04-24T15:37:39.637
> 
> 标签：php, codeigniter

我制作了一个表格来上传文字和照片（*可选上传照片）。

这是我的代码：

```
<input type="text" name="firstname" />
<input type="file" name="userfile" id="file"/> 
```

**问题是：我如何检查用户上传/浏览/选择照片/文件？**

我在控制器上的代码是这样的：

```
$data['name'] = $this->input->post('firstname',TRUE);
$data['photo'] = $this->input->post('userfile',TRUE);
if(!isset($data['photo'])){
echo "you not select a photo/file" ;
}else{
echo "you select a photo/file";
} 
```

但是，我发现了错误……如果我没有选择照片，输出是“你选择照片/文件”；

如果我选择一张照片，输出是“你选择一张照片/文件”；

我认为错误是

1.  $data['photo'] = $this->input->post('userfile',TRUE);
2.  if(!isset($data['photo']))

请给我一个解决方案..谢谢,,,

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:42:02.833

尝试使用

```
if(isset($_FILES['userfile'])); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:48:04.250

尝试使用：

```
if ( $_FILES['userfile']['error'] === 0 ) { } 
```

如果用户添加了一个文件并且从表单的角度来看一切正常，那将是真的。也不要忘记`enctype="multipart/form-data"`在您的表单标签中使用

# android - 控制应用程序设置访问

> ID：10301264
> 
> 赞同：0
> 
> 时间：2012-04-24T15:37:46.703
> 
> 标签：android, settings

我想定期访问设置。我正在创建一个应用程序，用户应该无法卸载它或在没有密码的情况下恢复出厂默认设置。

使用 android 2.3 这不是问题，但自从 HoneyComb... 设置 UI 发生了变化，我现在不知道该怎么做。

在我使用服务之前。

对不起我的英语，它不是我的母语。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:04:56.350

最后我限制了所有的设置访问，和Application Settings、WifiSettings没有区别...方式是使用Service在前台检查activity的包名。

# java - Android 查询游标

> ID：10301265
> 
> 赞同：-1
> 
> 时间：2012-04-24T15:37:48.700
> 
> 标签：java, android, sqlite, cursor

我的光标有问题。我创建了一个警报管理器，它选择一个值以在循环中与另一个值进行比较。

我的问题是：如果光标在循环之外，则仅选择我的`first`值（如果仅存在一个值，则显然仅选择此值）....如果光标在循环中，则仅选择`last`值（如果仅存在一个显然只选择这个值）。

如何解决这个问题？

我的查询：

```
public Cursor getRegistry2()
    {
        return (getReadableDatabase().query(
            TabRegistry.TABLE_NAME, 
            TabRegistry.COLUMNS, 
            TabRegistry._ID, 
            null,
            null, 
            null, 
            null)); 
```

我的光标在服务中：

```
 Cursor c5 = databaseHelper.getRegistry2();
                     c5.moveToFirst();
                        while(c5.isAfterLast() == false){   
                            tipe = c5.getString(c5.getColumnIndex(TabRegistry.TYPE)); 

                            status = c5.getString(c5.getColumnIndex(TabRegistry.STATUS)); 
                            number = c5.getString(c5.getColumnIndex(TabRegistry.NUMBER)); 
                        c5.moveToNext();
                        }
                       c5.close(); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T15:55:04.107

正如我在评论中提到的，如果你真的想找到一个特定的项目，你需要真正寻找它。

假设您要比较状态，您可以这样做：

```
while(c5.isAfterLast() == false){   
    tipe = c5.getString(c5.getColumnIndex(TabRegistry.TYPE)); 
    status = c5.getString(c5.getColumnIndex(TabRegistry.STATUS)); 
    number = c5.getString(c5.getColumnIndex(TabRegistry.NUMBER)); 
    if (status.equals(comparisonString)){
        break;
    }
    c5.moveToNext();
} 
```

这将打破您的循环，为您正在寻找的项目设置您的值。

就个人而言，这是很多计算开销，我只需进行查询以直接查找比较值，然后检查返回的游标是否为空。简单得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:49:48.553

**您应该知道**您正在覆盖的值`tipe`，以防您的光标的值超过一个。`status``number`

```
Cursor c5 = databaseHelper.getRegistry2();
if(c5.moveToFirst()){
 do{   
    tipe = c5.getString(c5.getColumnIndex(TabRegistry.TYPE)); 

    status = c5.getString(c5.getColumnIndex(TabRegistry.STATUS)); 
    number = c5.getString(c5.getColumnIndex(TabRegistry.NUMBER));
 }while(c5.moveToNext());
}
c5.close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T15:44:08.440

我不明白你的问题，但对我来说很奇怪的是：`while(c5.isAfterLast() == false){`

您是否尝试过替换`while (c5.moveToNext()) {`和删除`c5.moveToFirst();`？

# php - pt_BR 在 WAMP 上的 PHP setlocale 失败

> ID：10301267
> 
> 赞同：3
> 
> 时间：2012-04-24T15:38:01.963
> 
> 标签：php, timezone

好的，这里有什么问题？

```
header('Content-type: text/html; charset=utf-8');

setlocale(LC_ALL, NULL);
setlocale(LC_ALL, 'pt_BR');

echo "<p>São Paulo, " . date("d \d\e F \d\e Y", time()) . "</p>";

echo "<p>Preferred locale on this system is '" . setlocale(LC_ALL, NULL) . "'</p>"; 
```

回声：

```
São Paulo, 24 de April de 2012
Preferred locale on this system is 'Portuguese_Brazil.1252' 
```

也尝试过类似的东西：

```
setlocale(LC_ALL, 'Portuguese_Brazil.1252', 'bra', 'brazil', 'pt_BR', 'pt_BR.iso-8859-1', 'pt_BR.utf-8', 'portuguese', 'portuguese-brazil', 'ptb'); 
```

但是没有什么能让'aPril'变成'aBril'。

谢谢。

PS：文档是 IDE 格式的 UTF.8（无 BOM）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T07:46:42.790

我在共享主机上遇到了同样的问题，只是做了我自己的语言环境功能。

**更新：**

好吧，如果您已经安装了语言，只需使用 strftime() 而不是 date()

来自 PHP 文档：

> 要格式化其他语言的日期，您应该使用 setlocale() 和 strftime() 函数而不是 date()。

试试这个：

```
header('Content-type: text/html; charset=utf-8');

setlocale(LC_ALL, NULL);
//setlocale(LC_ALL, 'Portuguese_Brazil.1252'); ERROR in nowadays
setlocale(LC_ALL, 'pt_BR.utf-8'); // UTF-8 is the correct!

echo "<p>São Paulo, " . strftime("%d de %B de %Y", time()) . "</p>";

echo "<p>Preferred locale on this system is '" . setlocale(LC_ALL, NULL) . "'</p>"; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-08-12T13:36:41.497

`strftime("%d de %B de %Y", time()).` 工作！！

# javascript - 页面加载时触发 Javascript 事件

> ID：10301270
> 
> 赞同：0
> 
> 时间：2012-04-24T15:38:17.067
> 
> 标签：javascript, events, load, prototypejs, hidden-field

我试图根据选中的单选按钮来显示页面何时加载的隐藏行，这些功能适用于点击事件，但似乎无法让它适用于我的“dom：loaded”事件需要一个编辑页面，但不知道为什么，任何帮助都会很棒    

```
 $("content").observe('dom:loaded', function(event){
        if ($("organisation_contact_is_user_yes").checked){
            $$('.1').invoke('show');
            $$('.2').invoke('hide');
        }
        if ($("organisation_contact_is_user_no").checked){
            $$('.1').invoke('hide');
            $$('.2').invoke('show');
        }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T10:57:20.063

该函数需要参考dom加载的框架。检查 no 是 unchecked 不会有任何区别。将每个括号更改为 { 符号，对我有用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T12:52:48.157

你监听文档上的 'dom:loaded' 事件：

```
document.observe('dom:loaded', function(event) {
    // anything you want to execute once the dom's ready
}); 
```

# objective-c - 为什么继承需要是“子类”NSObject？

> ID：10301272
> 
> 赞同：3
> 
> 时间：2012-04-24T15:38:20.857
> 
> 标签：objective-c, inheritance, subclass, nsobject

为什么继承必须从 NSObject 开始，然后在另一个类中使用继承？

想知道为什么我有一个来自 UIViewController 的子类“FatherClass”。所以我想创建一个继承FatherClass（ChildClass：FatherClass）。

我不能这样做，我得到一个错误日志。我在这里和 Google 搜索的所有示例都以 NSObject 作为父亲开头。

所以我的问题必须是这样吗？还是我在某个地方错了。

这是错误日志

```
#0  0x33d6c6f8 in CFStringGetCharacters ()
CoreFoundation`CFStringGetCharacters:
0x33d6c6f8:  push.w {r8, r10} 
```

谢谢

**在这里编辑代码**

父类.h

```
@class ChildClass;
@interface FatherClass : UIViewController <UITabBarControllerDelegate, UINavigationBarDelegate, UIPopoverControllerDelegate, MKMapViewDelegate, MKAnnotation>
{
     //Some variables
}
@property (nonatomic, strong) ChildClass   *sidebar_table_controller;

-(void) show_modal: (id) sender; // Thats the Method i want to call
@end 
```

父类.m

```
#import "FatherClass.h"
#import "ChildClass.h"
@interface FatherClass ()

@end

@implementation FatherClass

@synthesize sidebar_table_controller;

// All inits here... DidiLoad, DidUnload, etc..

-(void) show_modal: (id) sender // Thats the Method!!!
{

      // All initiate ChildClass an then.. present modal

      [self presentModalViewController:self.sidebar_table_controller animated:YES];

      NSLog(@"Clicked ?...%@", sender);
}
@end 
```

现在的孩子

子类.h

```
@interface ChildClass : FatherClass <UINavigationControllerDelegate, UITableViewDataSource, UITableViewDelegate>
@end 
```

子类.m

```
#import "ChildClass.h"

@interface ChildClass ()

@end

@implementation ChildClass
 // All inits here... DidiLoad, DidUnload, etc..

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
     // Here i want to call Father Method
     [FatherClass show_modal:indexPath];
}

@end 
```

当我将 ChildClass : UIViewController 更改为 ChildClass : FatherClass 我的应用程序崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:44:56.220

您可以创建每种类型的对象：具有 NSObject 父亲的对象或没有任何父亲的新对象。那么问题来了：为什么要用NSObject作为父亲呢？因为它实现了创建健壮类所需的所有方法，例如 init、dealloc 等等。

因此，您可以创建自己的层次结构，但您必须重新发明轮子，重写每个方法来管理对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-18T09:31:48.390

您始终可以使用 Self 调用父类属性和函数。所以你的代码是

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
     // Here i want to call Father Method
     [Self show_modal:indexPath]; } 
```

而且您在展示之前从未分配过财产

```
@property (nonatomic, strong) ChildClass   *sidebar_table_controller; 
```

因此，像上面一样评估属性并调用函数。

# javascript - 如何使div居中？

> ID：10301282
> 
> 赞同：5
> 
> 时间：2012-04-24T15:38:45.907
> 
> 标签：javascript, html, css

我在 HTML（垂直和水平）中居中 div 时遇到问题。我的代码看起来像这样：

```
<div id="container">SOME HTML</div>

#container{
    width: 366px;
    height: 274px;
    margin: 50%;
    top: -137px;
    left: -188px;
    position:absolute;
} 
```

只有 chrome 将这个 div 居中到屏幕的中间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T15:41:04.617

这将`<div>`水平居中：

```
#container{
    width: 366px;
    height: 274px;
    margin: 0 auto;
} 
```

垂直居中不是很简单，您可能必须为此使用 javascript，或者您尝试[这个 css 解决方案](http://www.jakpsatweb.cz/css/css-vertical-center-solution.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T15:42:34.587

```
#container{
    width: 366px;
    height: 274px;
    top: 50%;
    left: 50%;
    margin: -137px 0 0 -188px;
    position:absolute;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T15:41:22.417

你可以使用：

```
#container {
    // Your other values, but remove position: absolute;
    margin: 0 auto;
} 
```

或者，您可以执行以下操作：

```
#wrapper, #container {
    border: 1px solid red;
    height: 500px;
    width: 600px;
}

#wrapper {
    bottom: 50%;
    right: 50%;
    position: absolute;
}

#container {
    background: yellow;
    left: 50%;
    padding: 10px;
    position: relative;
    top: 50%;
} 
```

你是 HTML 代码：

```
<div id="wrapper">
    <div id="container">
        <h1>Centered Div</h1>
        <p>
            This div has been centered within your browser window.</p>
    </div>
</div> 
```

这将`<div>`在浏览器窗口的中间居中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T15:42:52.383

这可以解决问题（垂直和水平）：

```
#container{
    position: absolute;
    width: 366px;
    height: 274px;
    left: 50%;
    top: 50%;
    margin-left: -183px; /* half width */
    margin-top: -137px; /* half height */
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-19T12:40:11.153

试试这个：

```
<div class="cont">
  <div class="box"></div>
</div> 
```

CSS：

```
.cont{
  background-color: tomato;
  width: 600px;
  height: 400px;
  position: relative;
}
.box {
  width:100px;
  height:100px;
  background-color: teal;
  color:#fff;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%)
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-04-24T15:42:10.590

只使用 CSS 应该没问题：

这是[**演示**](http://jsfiddle.net/65urC/)

```
#container{
    width: 366px;
    height: 274px;
    margin: 50%;
    top: 50%;
    left: 50%;
    position:absolute;
    top:0;
    bottom:0;
    left:0;
    right:0;
}​ 
```

# find - 带有修剪选项的cygwin bash发现未按预期运行

> ID：10301284
> 
> 赞同：0
> 
> 时间：2012-04-24T15:38:47.157
> 
> 标签：find, cygwin, subdirectory

下面的两个命令在 cygwin 下的 bash 中产生完全相同的文件列表：

```
find ../../../../.. -name "*.o" -and -path "*/common/*"
find ../../../../.. -name "*.o" -and -path "*/common/*" -prune 
```

此列表包括以下文件：

```
../../../../../platform/abc/common/ppng.o
../../../../../platform/abc/common/variant/pxx.o 
```

该列表不*包括*路径名中没有“common”的任何文件。

我想要做的是在所有目录中找到（并最终消除）目标文件，*但*任何具有“通用”目录组件的文件除外。我已经尝试了大约 25 种其他组合，但没有运气。

任何指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:48:04.547

afaik，-path 不采用正则表达式。我认为您要做的是找到所有目标文件（`.*.o`）并排除所有公共目录（`.*/common/.*`）：

```
find . -regex '.*.o' -and -not -regex '.*/common/.*' 
```

如果需要，您可以使其全部不区分大小写`-iregex`。

# c++ - 我的 fstream 是坏还是不好（）？

> ID：10301288
> 
> 赞同：3
> 
> 时间：2012-04-24T15:39:00.197
> 
> 标签：c++, iostream, fstream

所以我有一个带有接收文件名的函数的 .cpp 文件，并且应该返回一个带有文件内容的字符串（实际上修改了内容，我修改了代码以使其更易于理解，但这对我的问题）。问题是`f.good()`正在返回`false`并且读取文件的循环不起作用。代码 ：

```
#include "StdAfx.h"
#include "Form21.h"
#include <string>
#include <fstream>
#include <iostream>

    string ReadAndWrite(char* a){
    char filename[8];
    strcpy_s(filename,a);
    string output;
    char c;
    ifstream f(filename,ios::in);
    output+= "Example text"; // <-- this writes and returns just fine!
    c = f.get();

    while (f.good())
      { 

    output+= c;
    c= f.get();         
          }

    return output;
} 
```

有谁知道为什么会这样？它是否与这是一个单独的 .cpp 文件有关（当我删除它时它甚至不会抛出错误`#include <fstream>`）。也许有一种不同的方法来制作循环？我很高兴听到有关如何解决此问题的任何建议，*或者*关于如何实现我的目标的不同方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T15:57:08.853

首先，实际上没有理由复制您收到的文件名——您可以按原样使用它。其次，几乎任何形式的循环`while (stream.good())`，`while (!stream.bad())`，`while (stream)`，等等，*几乎*肯定是有问题的。您通常想要做的是检查读取某些数据是否有效。

或者，您可以完全跳过使用循环。有几种方法可以做到这一点。一个适用于较短文件的文件如下所示：

```
string readfile(std::string const &filename) { 
    std::ifstream f(filename.c_str());   
    std::string retval;

    retval << f.rdbuf();
    return retval;
} 
```

这可以很好地处理数十千字节（左右）的数据，但在处理较大的文件时会开始减慢速度。在这种情况下，您通常希望使用`ifstream::read`以下一般路线来获取数据：

```
std::string readfile(std::string const &filename) {
    std::ifstream f(filename.c_str());

    f.seekg(0, std::ios_base::end);
    size_t size = f.tellg();

    std::string retval(size, ' ');
    f.seekg(0);
    f.read(&retval[0], size);
    return retval;
} 
```

编辑：如果您需要处理单个字符（而不仅仅是阅读它们），您有几个选择。一种是将其分成多个阶段，在一个阶段中读取所有数据，并在单独的阶段中进行处理。另一种可能性（如果您只需要在处理过程中查看单个字符）是使用类似`std::transform`读取数据、进行处理并将输出放入字符串的方法：

```
struct character_processor { 
    char operator()(char input) { 
        // do some sort of processing on each character:
        return ~input;
    }
};

std::transform(std::istream_iterator<char>(f),
               std::istream_iterator<char>(),
               std::back_inserter(result),
               character_processor()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:45:24.143

我会检查 strlen(a) 是否不大于 7...您可能会溢出`filename`并获得一个不存在的文件名。

不涉及问题，我会重新编写函数：

```
string ReadAndWrite(string a) {  // string here, if you are into C++ already
    string filename;  // also here
    filename = a;  // simpler
    string output;
    char c;
    ifstream f(filename.c_str());  // no need for ios::in (but needs a char *, not a string
    output+= "Example text"; // <-- this writes and returns just fine!
    f >> c;  // instead c = f.get();

    while (f) // no need for f.good())
      { 

        output+= c;
        f >> c; // again, instead c= f.get();         
      }

    return output;
} 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-04-24T15:46:14.657

我可以建议使用 fopen 吗？[http://www.cplusplus.com/reference/clibrary/cstdio/fopen/](http://www.cplusplus.com/reference/clibrary/cstdio/fopen/)它接受一个文件名并返回一个文件指针。有了它，您可以使用 fgets 逐行读取文件[http://www.cplusplus.com/reference/clibrary/cstdio/fgets/](http://www.cplusplus.com/reference/clibrary/cstdio/fgets/)

# spring - 过滤器 null 中的 LocaleResolver 显示它已自动装配！Spring MVC 3.1.1/Spring 安全 3.1.0

> ID：10301291
> 
> 赞同：3
> 
> 时间：2012-04-24T15:39:08.950
> 
> 标签：spring, spring-mvc, localization, filter, spring-security

我正在使用 Spring Security 3.1.0 和 Spring MVC 3.1.1。我希望能够根据 URL 更改语言环境，即：

```
http://localhost:8080/abc?lang=fr 
```

现在，这在“正常”情况下有效，即从一个页面到另一个页面但是，在我的应用程序中，如果我从一个非安全页面转到一个安全页面，它首先命中的是我的登录页面，由 Spring Security BEFORE 提供它击中了我想要的页面。

这是正常的 Spring Security 行为（拦截安全资源），因此这种行为没有问题。

问题在于，当我到达安全页面时，语言环境并没有改变！它保留为默认语言环境。即 ..e lang=fr 没有被解析出来。

我已经在应用程序上下文文件中定义了 dispatcher-servlet.xml 和外部的语言环境相关 bean，以执行以下操作：

```
<mvc:interceptors>
    <bean class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor" p:paramName="lang" />
</mvc:interceptors>

<bean id="localeResolver" class="org.springframework.web.servlet.i18n.SessionLocaleResolver" p:defaultLocale="en" /> 
```

我还尝试拆分上述 2 个 bean，在 app-context 配置中只有*localResolver 。*

我已经对此进行了大量研究，基本上，我知道我需要手动更改语言环境。

甚至 Spring Security 3.1.0 的 Spring Docs 都说您需要自己的“过滤器”，或者您可以使用 RequestContextFilter。但是，RequestContextFilter 不会解析查询字符串中的语言环境参数。

```
Spring Security relies on Spring's localization support in order to actually lookup   
the appropriate message. In order for this to work, you have to make sure that the 
locale from the incoming request is stored in Spring's 
org.springframework.context.i18n.LocaleContextHolder. Spring MVC's DispatcherServlet 
does this for your application automatically, but since Spring Security's filters are 
invoked before this, the LocaleContextHolder needs to be set up to contain the correct 
Locale before the filters are called.  You can either do this in a filter yourself 
(which must come before the Spring Security filters in web.xml) or you can use 
Spring's RequestContextFilter. 
```

我想在请求到达控制器之前拦截它，所以我编写了自己的过滤器。

基于其他人所做的，我的解决方案是自动装配 LocaleResolver。当 tomcat 启动时，它在我的日志中显示“localeResolver”已被自动连接（否则应用程序将在那里失败）但是在运行时，localeResolver 为 NULL。

同样，有帖子说要在应用程序上下文中定义 LocaleResolver ......我已经这样做了，但是当请求发生时我仍然最终得到一个空的 LocaleResolver 。

有任何想法吗？？非常感激。

ps 我定义的过滤器在 Spring Security 过滤器之前。我可以调试它，它首先命中它，然后由于 LocaleResolver 上的 NPE 而死掉。

欣赏这个，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T15:44:10.157

您是否在 web.xml 中定义了过滤器？如果是这样，那么过滤器类不是由 Spring 实例化的，而是由 servlet 容器实例化的。Spring 无法自动装配它不知道的内容。

这里的一般解决方案是将`<filter-class>`web.xml 中的声明为[`org.springframework.web.filter.DelegatingFilterProxy`](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/filter/DelegatingFilterProxy.html)并将 指向`targetBeanName`上下文中的 bean，例如：

```
<filter>
    <filter-name>My Locale Filter</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    <init-param>
        <param-name>targetBeanName</param-name>
        <param-value>myLocaleFilter</param-value>
    </init-param>
</filter> 
```

在您的 Spring 上下文中，`<bean id="myLocaleFilter">`应该指向您的 Filter 类。

您可能还会发现自定义过滤器类扩展[`GenericFilterBean`](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/filter/GenericFilterBean.html)而不是`Filter`直接实现接口很方便。

# z3 - 重写公式

> ID：10301292
> 
> 赞同：2
> 
> 时间：2012-04-24T15:39:13.457
> 
> 标签：z3

在[本文](http://research.microsoft.com/en-us/people/nbjorner/iwil08.pdf)（第 3.2 节）中，它说 z3 在执行任何其他步骤之前应用了公式的重写/简化。

假设我有一个公式`QF_UF`，它由多个`assert`语句组成。是否有任何重写规则会以某种方式“打破”不同断言语句之间的障碍？或者，反过来问：我可以确定重写规则只在本地应用，“在”一个断言语句中？

例如，考虑以下公式：

```
(set-logic QF_UF)
(set-option :auto-config false)
(set-option :PROOF_MODE  2)

(declare-fun a () Bool)
(assert a)
(assert (not a))

(check-sat)
(get-proof) 
```

我可以确定证明将包含一个解决步骤来证明`False`，或者是否有可能`False`通过重写/简化步骤来结束？

我问的原因是对于我的应用程序，每个`assert`语句都有一个特殊的语义。对多个`assert`语句进行重写/简化将使最终的不可满足性证明对我来说无法使用（或至少：非常难以使用）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:12:27.973

Z3 3.2 应用了几个预处理步骤。使用`(set-option :auto-config false)`将禁用其中的大多数。您还应该包括以下两个选项：

> （设置选项：传播布尔假）
> 
> （设置选项：传播值假）

# iphone - 即使应用程序在后台，多任务应用程序是否可以在设备解锁屏幕时收到通知？

> ID：10301301
> 
> 赞同：0
> 
> 时间：2012-04-24T15:39:38.080
> 
> 标签：iphone, ios, background, multitasking

每次设备解锁时，我的应用程序都需要执行计算。这是一个用户有意启动然后进入后台的应用程序，类似于粘贴板管理器。

当应用程序在后台时设备解锁时如何接收通知？这可能吗？计算不重。它只是从/向 NSUserDefaults 读取和写入一个值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T15:46:34.083

使用当前的 SDK 和公共 API 无法判断用户何时解锁屏幕，即使您的应用程序在后台...

# java - 通过流发送文件

> ID：10301325
> 
> 赞同：1
> 
> 时间：2012-04-24T15:41:52.693
> 
> 标签：java, stream, network-programming

这是我现在所拥有的。

接收者：

```
public static void read(Socket socket, ObjectInputStream in) {
    try {
        String separator = in.readUTF();
        while (in.readByte() == -3) {
            String path = in.readUTF().replaceAll(separator, System.getProperty("file.separator"));
            File file = new File(new File(path).getParent());
            if (!file.exists()) {
                file.mkdirs();
            }
            FileOutputStream fos = new FileOutputStream(path);
            int b = 0;
            while ((b = in.readByte()) != -4) {
                fos.write(b);
            }
            fos.close();
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

发件人：

```
public static void send(String[] path) {
    Socket socket;
    try {
        socket = new Socket(ip, port);
        socket.setKeepAlive(true);
    } catch (UnknownHostException e) {
        return;
    } catch (IOException e) {
        return;
    }
    try {
        ObjectOutputStream out = new ObjectOutputStream(socket.getOutputStream());
        out.writeUTF(Devbox.getSeparator());
        for (String s : path) {
            send(s, out);
            out.writeByte(-2);
        }
        out.close();
        socket.close();
    } catch (Exception e) {
        e.printStackTrace();
    }
}

private static void send(String path, ObjectOutputStream out) {
    File file = new File(path);
    if (file.isDirectory()) {
        File[] files = file.listFiles();
        for (File f : files) {
            send(path + f.getName(), out);
        }
    } else {
        try {
            out.writeByte(-3);
            out.writeUTF(path);
            FileInputStream fis = new FileInputStream(file);
            int b = 0;
            while ((b = fis.read()) != -1) {
                out.writeByte(b);
            }
            fis.close();
            out.writeByte(-4);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

这是我在发件人中遇到的错误。

```
java.net.SocketException: Software caused connection abort: socket write error
    at java.net.SocketOutputStream.socketWrite0(Native Method)
    at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:109)
    at java.net.SocketOutputStream.write(SocketOutputStream.java:153)
    at java.io.ObjectOutputStream$BlockDataOutputStream.writeBlockHeader(ObjectOutputStream.java:1874)
    at java.io.ObjectOutputStream$BlockDataOutputStream.drain(ObjectOutputStream.java:1855)
    at java.io.ObjectOutputStream$BlockDataOutputStream.writeByte(ObjectOutputStream.java:1895)
    at java.io.ObjectOutputStream.writeByte(ObjectOutputStream.java:760) 
```

它指向

```
 out.writeByte(b); 
```

它成功发送了大约 25 个文件，然后抛出此错误。每次它扔到的文件都不一样，但在5个文件左右的相同范围内。接收者在一个特定文件之后停止，该文件通常在发送者停止的文件之前一对。它停止是因为 in.readByte() == -3 是假的。当它发生时，我得到了 -85 和 16 之类的数字。我在另一台计算机上尝试了它，因为它说的是软件，它是完全相同的。有谁知道为什么会这样？我花了一天的时间试图弄清楚，但一无所获。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:51:07.493

使用 BufferedInputStream 在 send 方法中读取 FileInputStream。

```
BufferedInputStream bis = new BufferedInputStream(new FileInputStream(file));
while ((b = bis.read()) != -1) {
    out.writeByte(b);
} 
```

还可以尝试互补的 BufferedOutputStream

```
BufferedInputStream bos = new FileOutputStream(path);
int b = 0;
while ((b = in.readByte()) != -4) {
    bos.write(b);
} 
```

此外，您需要在文件完成传输时清除您的连接。

```
out.flush; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:55:26.053

请阅读此[答案](https://stackoverflow.com/questions/2126607/official-reasons-for-software-caused-connection-abort-socket-write-error)，我认为除此之外不能说其他任何内容，而且我在您的代码中也看不到任何会关闭连接的内容。

来自 OTN 讨论

> WinSock 描述：当本地网络系统中止连接时，可能会发生错误。如果 WinSock 在数据重新传输失败后中止已建立的连接（接收方永远不会确认在数据流套接字上发送的数据），则会发生这种情况。
> 
> TCP/IP 场景：如果本地系统没有收到发送数据的 (ACK) 确认，则连接将超时。如果 (FIN)ish TCP 数据包没有被确认，它也会超时（即使 FIN 被确认，如果没有返回 FIN，它最终也会超时）。
> 
> 它似乎在 WindowsXP 中发生得更多，而且似乎也可能与 Windows 防火墙设置有关。在任何情况下，重点是中止源自本地机器内部。

# github-for-mac - 无法通过 GitHub for Mac 应用推送到 GitHub

> ID：10301328
> 
> 赞同：2
> 
> 时间：2012-04-24T15:41:59.873
> 
> 标签：github-for-mac

我创建了一个激活 GitHub 的新 Xcode 项目。现在我准备分享它并将其推送到我的 GitHub 帐户。使用 GitHub for Mac，我看到标题栏（右上角）包含一个“推送到 GitHub”按钮，我单击了该按钮，填写了显示的工作表并单击了“推送”。我所看到的只是一个“推送到 GitHub”的进度指示器，它一直在工作。

我在控制台中看到以下内容：

> 2012 年 4 月 21 日 9:27:59.716 PM GitHub：__43-[GHSSHKeyManager ensurePublicKeysAreSetup]_block_invoke_0 [第 49 行] SSH 成功，因此密钥必须没问题。2012 年 4 月 21 日晚上 9:28:39.353 GitHub：__39-[GHPushRepositorySheetController push]_block_invoke_0248 [第 173 行] 错误域 = GHGitHubClientErrorDomain 代码 = 667“验证失败”用户信息 = 0x104ba4d60 {NSUnderlyingError = 0x104811610“（200-中的预期状态代码） 299), 得到 422", GHGitHubClientErrorHTTPStatusCodeKey=422, GHGitHubClientErrorRequestURLKey=https://api.github.com/user/repos, NSLocalizedDescription=验证失败}

我已经通过终端进行了验证：

> AirMonkey:.ssh tito$ ssh -T git@github.com

我得到：

> 嗨，tciuro！您已成功通过身份验证，但 GitHub 不提供 shell 访问权限。

看起来我的身份验证正确，但我无法推送一个全新的项目。有任何想法吗？

谢谢！

——铁托

# c# - 使用 .net 提取 .tbz 文件

> ID：10301331
> 
> 赞同：0
> 
> 时间：2012-04-24T15:42:07.957
> 
> 标签：c#, .net, vb.net, extract

我正在尝试使用 .net 提取 .tbz 文件

有人有什么建议吗？

如果这有任何区别，该文件将非常大（3GB）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:47:17.317

首先，您需要了解、如何实现或使用[BZIP2 解压缩](http://en.wikipedia.org/wiki/Bzip2)的支持库。然后您需要以不同的方式执行相同的操作，并取消归档生成的[TAR 文件](http://en.wikipedia.org/wiki/Tar_%28file_format%29)的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:11:33.960

您可以使用 SharpZipLib：

[http://www.icsharpcode.net/opensource/sharpziplib/](http://www.icsharpcode.net/opensource/sharpziplib/)

但是，它是在 GPL 下获得许可的，除了我不熟悉的例外，因此您必须仔细阅读以查看它是否适合您的需求。

# asp.net - 链接到 asp.net 中的不同页面

> ID：10301333
> 
> 赞同：0
> 
> 时间：2012-04-24T15:42:09.890
> 
> 标签：asp.net, .net, vb.net

我有以下代码应该从请求页面转到特定的公司页面。在网站文件夹中，公司页面位于名为 Companies 的文件夹下，请求页面位于 Requests 文件夹下。

```
 Dim strUrl As String = "/Companies/Details.aspx?Company_ID=" & .Company_id
 litlCompany.Text = "<a href=" & strUrl & ">" & .Company.Name & "</a>" 
```

网址应构建为，

[http://localhost/Companies/Details.aspx?Company_ID=222](http://localhost/Companies/Details.aspx?Company_ID=222)

但它来了，

[http://localhost/Requests/Companies/Details.aspx?Company_ID=222](http://localhost/Requests/Companies/Details.aspx?Company_ID=222)

有谁知道为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T15:44:36.597

我假设你目前在`http://localhost/Requests/something.aspx`？如果是这样，那是因为您忘记了波浪号根说明符：

```
~/Companies/Details.aspx 
```

哪个应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T15:48:59.897

你也可以试试

```
Page.ResolveClientUrl("~/Companies/Details.aspx?Company_ID=" + Company_id) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T15:51:23.530

根据您的控件名称，您似乎正在使用`Literal`.

尝试将其更改为 a `HyperLink`，然后您不需要将 HTML ( `<a href=...`) 放在 text 属性中，您将能够使用`hypCompany.NavigateUrl = strUrl`并且 ASP.Net 将为您生成它。无论如何，这是最简洁的方法。

还要添加波浪号以转到根目录:-)

例如

```
Dim strUrl As String = "~/Companies/Details.aspx?Company_ID=" & .Company_id
hypCompany.NavigateUrl = strUrl 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T15:50:13.920

我假设这个链接是在 request.aspx 页面中构建的。

我认为 a href 正在呈现给当前的 httpcontext。您是否尝试过将字符串创建为：

Dim strUrl As String = "~/Companies/Details.aspx?Company_ID=" & .Company_id

我认为如果公司文件夹位于根目录中，这将起作用。tilda 应该确保它从根部向下看。

# python - 无法理解 Python 代码的结果

> ID：10301335
> 
> 赞同：2
> 
> 时间：2012-04-24T15:42:12.770
> 
> 标签：python

我正在学习 Python 中的字典，并创建了一个简单的程序：

```
# Create an empty dictionary called d1
d1 = {}

# Print dictionary and length
def dixnary():
    print "Dictionary contents : "
    print d1
    print "Length = ", len(d1)

# Add items to dictionary
d1["to"] = "two"
d1["for"] = "four"

print "Dictionary contents :"
print d1
print "Length =" , len(d1)

# Print dictionary and length
print dixnary() 
```

现在，当我使用`print`命令和使用`dixnary`函数时，结果会有所不同。

使用`print`命令我得到结果：

> 字典内容：
> <'to':'two','for:'four'>
> Length = 2

当我使用函数时`dixnary`，我得到了结果：

> 字典内容：
> <'to':'two','for:'four'>
> 长度 = 2
> 无

注意`None`最后一行的 。`None`当我使用该功能时，它会被添加`dixnary`。为什么是这样？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-24T15:44:15.503

您正在尝试打印函数的返回值，但该函数没有返回值，因此它返回默认值 None。

它打印出其他数据的原因是您在函数内部有打印命令。只需运行函数 ( `dixnary()`)，而不是打印它 ( `print dixnary()`)。

或者，让程序返回字符串，这样你就可以用它做有用的事情。

```
def dixnary():
    return "Dictionary contents :\n%s\nLength = %d" % (d1, len(d1))

print dixnary() 
```

# android - 在 Android 上创建的时钟未更新

> ID：10301345
> 
> 赞同：0
> 
> 时间：2012-04-24T15:42:46.410
> 
> 标签：android, user-interface, time, clock

我正在尝试创建一个全屏时钟。我设法将文本设置为小时、分钟和秒。好吧，但是当我启动应用程序时，它会显示时间但 UI 没有更新...我不知道该怎么做，我阅读了本教程但我不明白...任何人都可以向我解释如何始终如一更新用户界面？

```
 public class Clock1Activity extends Activity {
/** Called when the activity is first created. */
private Timer timer;
@Override
public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.main);

final TextView txtHour = (TextView)findViewById(R.id.TxtHour);
final TextView txtMinutes = (TextView)findViewById(R.id.TxtMinute);
final TextView txtSeconds = (TextView)findViewById(R.id.TxtSeconds);
final TextView txtMilliseconds = (TextView)findViewById(R.id.TxtMilliseconds);

 final Integer hora = new Integer(Calendar.HOUR_OF_DAY);
 final Integer minutos = new Integer(Calendar.MINUTE);
 final Integer segundos = new Integer(Calendar.SECOND);
 final Long milisegundos = new Long (System.currentTimeMillis());
    timer = new Timer("DigitalClock");
    Calendar calendar = Calendar.getInstance();
    // Get the Current Time
    final Runnable updateTask = new Runnable() {
        public void run() {
/** txtHour.setText(hora.toString());
 txtMinutes.setText(minutos.toString());
 txtSeconds.setText(segundos.toString()); */
 txtMilliseconds.setText(milisegundos.toString());
 Toast toast1 = Toast.makeText(getApplicationContext(), milisegundos.toString(), Toast.LENGTH_SHORT);
toast1.show();
        }
    };

    timer.scheduleAtFixedRate(new TimerTask() {
        @Override
        public void run() {
            runOnUiThread(updateTask);
        }
    }, 1, 1000); 
```

}

}

请告诉我如何完成它以更新 UI，请...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:45:05.563

您没有提到您正在编写哪个教程，因此以防万一，您可能想要使用[AsyncTask](https://developer.android.com/reference/android/os/AsyncTask.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:47:28.653

请参阅[此](http://about-android.blogspot.in/2010/04/create-apps-to-show-digital-time-in_19.html)示例以创建应用程序以在 Android 中显示数字时间。在您的情况下使用

`runOnUiThread`在 UI.as 上更新时间

```
CurrentActivity.this.runOnUiThread(new Runnable() {
    public void run() {
        //UPDATE TIME HERE
    }
}); 
```

你的代码看起来像：

```
public class Clock1Activity extends Activity {
/** Called when the activity is first created. */
private Timer timer;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    final TextView txtHour = (TextView)findViewById(R.id.TxtHour);
    final TextView txtMinutes = (TextView)findViewById(R.id.TxtMinute);
    final TextView txtSeconds = (TextView)findViewById(R.id.TxtSeconds);
    final TextView txtMilliseconds = (TextView)findViewById(R.id.TxtMilliseconds);

        timer = new Timer("DigitalClock");
        Calendar calendar = Calendar.getInstance();
        // Get the Current Time
        final Runnable updateTask = new Runnable() {
            public void run() {
     final Integer hora = new Integer(Calendar.HOUR_OF_DAY);
     final Integer minutos = new Integer(Calendar.MINUTE);
     final Integer segundos = new Integer(Calendar.SECOND);
     final Integer milisegundos = new Integer(Calendar.MILLISECOND);
     txtHour.setText(hora.toString());
     txtMinutes.setText(minutos.toString());
     txtSeconds.setText(segundos.toString());
     txtMilliseconds.setText(milisegundos.toString());
            }
        };

        timer.scheduleAtFixedRate(new TimerTask() {
            @Override
            public void run() {
                runOnUiThread(updateTask);
            }
        }, 1, 1000);
 }

} 
```

# asp.net - 如何使用表适配器更改数据集上的外键约束

> ID：10301349
> 
> 赞同：1
> 
> 时间：2012-04-24T15:43:14.463
> 
> 标签：asp.net, strongly-typed-dataset

我有一个`Dataset`有 3 个`TablesAdapters`链接在一起的（关系和外键都来自数据库设计）。我现在正在尝试将其`TableAdapter`与外键绑定，我得到以下信息：

> “未能启用约束。一行或多行包含违反非空、唯一或外键约束的值。”

所以经过一番挖掘，我发现它不喜欢我有相同的外键`TableAdapter`（即使数据库约束对此没问题）。

如何让我的`DataSet`（或`TableAdpapter`）只查看表的主键作为约束？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:51:58.910

好的，所以在我发布这篇文章 5 秒后，我找到了答案（它不总是这样吗？）

问题是我添加了一个从多个表中查询的表适配器，而不仅仅是一个表。这个 tableAdapter 看起来只是“决定”了哪些列用于唯一的 Contraints。

为了解决这个问题，我必须进入数据集设计器并搜索“UniqueConstraint”，直到找到使用约束的两个外键列而不是一个主键的那个。

# excel - python<-> excel：ScreenUpdating 使工作表闪烁

> ID：10301350
> 
> 赞同：1
> 
> 时间：2012-04-24T15:43:15.623
> 
> 标签：excel, vba

在我的 python 代码中，我在将数据写入工作表之前将 ScreenUpdating 设置为 False，然后将其设置回 True。一旦 ScreenUpdating 设置为 True，工作表就会闪烁。

代码片段：

```
self.xlsApp.ScreenUpdating = False                                        
#Write some data here to excel sheet      
self.xlsApp.ScreenUpdating = True 
```

我希望摆脱这种闪烁，但仍然使用 ScreenUpdating 。

有任何想法吗？？

问候，奥马尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-25T08:47:57.953

**如果您将`ScreenUpdating=true`. 我想，你无能为力。**

**但是，您可以有条件地设置`ScreenUpdating`为。`false``true`**通常，人们执行的代码只是偶尔（或很少）*真正*改变数据。因此，如果您在代码中执行的工作表更新只是偶尔确实进行了更新，您可以初始化一个标志`false`，然后设置`ScreenUpdating`为`false`，并且`true` *仅当代码确实进行更新时才将标志设置为。*作为更新后的最后一步，仅在设置标志时才设置`ScreenUpdating`回。`true`

**这样，您只会在真正发生数据更改的情况下看到闪烁。**在大多数情况下，这可能已经足以消除闪烁效果。

为了完全避免剩余的闪烁，您可以尝试使用 Windows API 函数锁定 Excel 窗口的内部，按照概述执行代码，然后解锁。这仍然会产生闪烁效果，但不可见，因为重绘过程没有显示。解锁后，重绘仍然发生，**但没有清除背景颜色的矩形区域**。

# java - 在 Mac 上启动时，Swing GUI 不显示或显示错误

> ID：10301351
> 
> 赞同：6
> 
> 时间：2012-04-24T15:43:17.450
> 
> 标签：java, macos, swing, look-and-feel, nimbus

我有一个 Java Swing 项目，它在 Windows 和 Ubuntu 上都能正常工作。我没有任何 Mac，因此无法对其进行测试；我使用 Nimbus 主题作为这个项目的标准。

现在，最近我的朋友在 Eclipse 和导出的 jar 中测试了同一个项目，它给出的错误不涉及我所做的任何特定 Java 类。

它确实显示了 GUI，但有时它会卡住，或者有时菜单丢失。

这是启动 GUI 时显示的精简版错误：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at com.apple.laf.AquaMenuPainter.paintMenuBarBackground(AquaMenuPainter.java:123)
    at com.apple.laf.AquaMenuUI.paintBackground(AquaMenuUI.java:57)
    at com.apple.laf.AquaMenuPainter.paintMenuItem(AquaMenuPainter.java:160)
    at com.apple.laf.AquaMenuUI.paintMenuItem(AquaMenuUI.java:35)
    at javax.swing.plaf.basic.BasicMenuItemUI.paint(BasicMenuItemUI.java:452)
    at javax.swing.plaf.basic.BasicMenuItemUI.update(BasicMenuItemUI.java:448)
    at javax.swing.JComponent.paintComponent(JComponent.java:752)
    at javax.swing.JComponent.paint(JComponent.java:1029)
    at javax.swing.JComponent.paintChildren(JComponent.java:862)
    at javax.swing.JComponent.paint(JComponent.java:1038)
    at javax.swing.JComponent.paintChildren(JComponent.java:862)
    at javax.swing.JComponent.paint(JComponent.java:1038)
    at javax.swing.JLayeredPane.paint(JLayeredPane.java:567)
    at javax.swing.JComponent.paintChildren(JComponent.java:862)
    at javax.swing.JComponent.paint(JComponent.java:1038)
    at java.awt.GraphicsCallback$PaintCallback.run(GraphicsCallback.java:34)
    at sun.awt.SunGraphicsCallback.runOneComponent(SunGraphicsCallback.java:60)
    at sun.awt.SunGraphicsCallback.runComponents(SunGraphicsCallback.java:97) 
```

你能告诉我可能是什么问题，或者我应该在 Mac 上使用任何特定的外观主题吗？Mac 不支持 Nimbus，如果支持，我应该使用什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T15:50:07.837

我不会触摸 OS X 中的主题，它自动很棒：D

只需确保您在使用 Mac 时不要更改主题。

```
String osName = System.getProperty("os.name").toLowerCase();
if (!osName.contains("mac")) // if not on mac
{
   // set nimbus
}
// otherwise, do nothing. It goes automatically to Aqua. 
```

# c# - 串口超时异常线程切换

> ID：10301354
> 
> 赞同：0
> 
> 时间：2012-04-24T15:43:46.470
> 
> 标签：c#, .net, multithreading, serial-port

我正在编写一个多线程应用程序，其中一个线程锁定串行端口并连续发送命令并在循环中使用 SerialPort.Write(command) 和 SerialPort.ReadLine() 获取响应，直到它获得一个特定命令的“OK”响应。

线程是否有可能在 ReadLine() 调用期间切换并导致 TimeOutException。

我将超时设置为 2000 毫秒。

程序运行几分钟（大约 5 - 10）后，我有随机的 TmeOutExceptions

```
23332   10:14:23 AM AutoLoader.WinS IRP_MJ_WRITE    Serial0 SUCCESS Length 9: STG|4.5.. 
23336   10:14:23 AM AutoLoader.WinS IRP_MJ_READ Serial0 SUCCESS Length 1: O 
23339   10:15:54 AM AutoLoader.WinS IRP_MJ_WRITE    Serial0 SUCCESS Length 7: GTSNS..   
23342   10:15:54 AM AutoLoader.WinS IRP_MJ_READ Serial0 SUCCESS Length 3: K..   
23347   10:15:54 AM AutoLoader.WinS IRP_MJ_WRITE    Serial0 SUCCESS Length 7: GLSTS..   
23351   10:15:54 AM AutoLoader.WinS IRP_MJ_READ Serial0 SUCCESS Length 1: O 
23355   10:15:54 AM AutoLoader.WinS IRP_MJ_READ Serial0 SUCCESS Length 3: K.. 
```

上午 10 点 14 分 23 秒后，我得到了一个被我抑制的 TimeOutException。

```
 while (response != "OK")
                    {
                        Thread.Sleep(1000);

                        _alComm.SendString("SSD|" + CurrentData.MeasuredDepthReturns + Environment.NewLine);
                        response = _alComm.ReceiveString(2000);

                        _alComm.SendString("STG|" + CurrentData.AvgGas + Environment.NewLine);
                        response = _alComm.ReceiveString(2000);

                        _alComm.SendString("GTSNS\r\n");
                        response = _alComm.ReceiveString(2000);
                        SetSamplingTimePercent(response);
                    } 
```

和

```
public void SendString(string sDataToSend)
{
    if (sDataToSend == "")
        return;

    try
    {
        AlPort.Write(sDataToSend);
    }
    catch (Exception ex)
    {
        //MessageBox.Show(ex.ToString(), "Error");
    }
}

public string ReceiveString(int timeOut)
{
    string inString = null;
    try
    {
        // set read timeout
        AlPort.ReadTimeout = timeOut;
        inString = AlPort.ReadLine();
    }
    catch (TimeoutException ex)
    {
        return string.Empty;
    }

    return inString;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:52:41.453

A `ReadLine`（或与此相关的任何 I/O）将导致上下文切换，直到它被服务。现在，我看到的方式有两种可能性：

1.  要么线程一直被操作系统挂起，直到超时结束并且抛出异常，要么
2.  您一直处于挂起状态，直到 I/O 得到服务，此时操作系统很可能会立即唤醒您的线程并抢占其他线程以允许您的代码运行。请记住，任何现代操作系统都为 I/O 绑定线程提供了慷慨的优先级提升。

# oracle - 使用 refcursor 的无效 SQL 语句错误

> ID：10301356
> 
> 赞同：0
> 
> 时间：2012-04-24T15:44:08.390
> 
> 标签：oracle, plsql, oracle11g, oracle9i, plsqldeveloper

我正在尝试获取基本语句的结果。SQL 语句可以正常工作。但是，为了打印结果，我想使用 refcursor。我收到以下错误：

ORA-00900：无效的 SQL 语句 ORA-01008：并非所有变量都绑定 ORA-00900：无效的 SQL 语句

```
VARIABLE reader refcursor;
DECLARE
  line varchar2(32767);
BEGIN
  line := 'SELECT role_id,';
  FOR n IN (SELECT name
              FROM (SELECT competence.skill_role.role_id,
                           competence.skill_label.name,
                           competence.skill_role.target_value
                      FROM competence.skill_role,
                           competence.skill_label
                     WHERE competence.skill_label.skill_id =
                           competence.skill_role.skill_id
                       AND competence.skill_label.language_id = 1)
                       matrix_result ) LOOP
    line := line || '(decode(name,''' || n.name ||
            ''',target_value)) "' || n.name || '",';
  END LOOP;
  line := RTRIM(line, ',') ||
    ' FROM (SELECT competence.skill_role.role_id,
                   competence.skill_label.name,
                   competence.skill_role.target_value
              FROM competence.skill_role, competence.skill_label
             WHERE competence.skill_label.skill_id =
                   competence.skill_role.skill_id
               AND competence.skill_label.language_id = 1) matrix_result';
--dbms_output.put_line(line);
--execute immediate line;
 OPEN :reader FOR line;
END;
/
PRINT :reader; 
```

表数据

```
CREATE TABLE competence.skill_role
  (skill_id  NUMBER,
   role_id NUMBER,
   target_value NUMBER)
/
INSERT ALL 
INTO competence.skill_role VALUES (3432030, 1421866, 2)
INTO competence.skill_role VALUES (3434962, 1421866, 2)
INTO competence.skill_role VALUES (3488025, 3488804, 4)

SELECT * FROM competence.skill_role

SKILL_ID ROLE_ID     target_value
---------- -------   -----------
3432030 1421866       2
3434962 1421866       2
3488025 3488804       4

CREATE TABLE competence.skill_label
  (skill_id  NUMBER,
   name vchar2 (30))
/
INSERT ALL 
INTO competence.skill_label VALUES (3432030, 'Alueen projektipätevyys')
INTO competence.skill_label VALUES (3434962, 'Moottorin koekäyttö')
INTO competence.skill_label VALUES (3488025, 'Etähallintajärjestelmät')

SELECT * FROM arc_competence.skill_label

SKILL_ID NAME
---------- -------
3432030, Alueen projektipätevyys
3434962, Moottorin koekäyttö
3488025, Etähallintajärjestelmät 
```

我想从第一个查询中得到以下结果。从您的回答（如果我理解正确的话）看来，我需要手动运行结果查询才能得到答案。我想在不运行结果查询的情况下获得结果 :-) 我目前无法访问客户端计算机，但我现在要去那里。

```
ROLE_ID     Alueen projektipätevyys  Moottorin koekäyttö    Etähallintajärjestelmät          
1421866          2                      2
3488804                                                            4 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:54:27.053

如果我更正您的代码以便编译

*   您的`INSERT ALL`陈述缺少一个`SELECT`
*   中的`name`列`skill_label`被定义为 a`vchar2(30)`而不是 a`varchar2(30)`
*   您的匿名块引用了`language_id`您的 DDL 不包含的列

代码运行没有错误。如果唯一的问题是您想将前两行合并为一行，则只需将 a 添加`MAX`到所有列中，而不是`ROLE_ID`将 a 添加`GROUP BY role_id`到查询中。

```
SQL> ed
Wrote file afiedt.buf

  1  CREATE TABLE skill_role
  2    (skill_id  NUMBER,
  3     role_id NUMBER,
  4*    target_value NUMBER)
SQL> /

Table created.

SQL> ed
Wrote file afiedt.buf

  1  INSERT ALL
  2  INTO skill_role VALUES (3432030, 1421866, 2)
  3  INTO skill_role VALUES (3434962, 1421866, 2)
  4  INTO skill_role VALUES (3488025, 3488804, 4)
  5* select * from dual
SQL> /

3 rows created.

SQL> ed
Wrote file afiedt.buf

  1  CREATE TABLE skill_label
  2    (skill_id  NUMBER,
  3*    name varchar2 (30))
SQL> /

Table created.

SQL> ed
Wrote file afiedt.buf

  1  INSERT ALL
  2  INTO skill_label VALUES (3432030, 'Alueen projektipΣtevyys')
  3  INTO skill_label VALUES (3434962, 'Moottorin koekΣytt÷')
  4  INTO skill_label VALUES (3488025, 'EtΣhallintajΣrjestelmΣt')
  5* select * from dual
SQL> /

3 rows created.

SQL> commit;

Commit complete.

SQL> variable reader refcursor;

SQL> ed
Wrote file afiedt.buf

  1  DECLARE
  2    line varchar2(32767);
  3  BEGIN
  4    line := 'SELECT role_id,';
  5    FOR n IN (SELECT name
  6                FROM (SELECT skill_role.role_id,
  7                             skill_label.name,
  8                             skill_role.target_value
  9                        FROM skill_role,
 10                             skill_label
 11                       WHERE skill_label.skill_id =
 12                             skill_role.skill_id
 13                         )
 14                         matrix_result ) LOOP
 15      line := line || 'max(decode(name,''' || n.name ||
 16              ''',target_value)) "' || n.name || '",';
 17    END LOOP;
 18    line := RTRIM(line, ',') ||
 19      ' FROM (SELECT skill_role.role_id,
 20                     skill_label.name,
 21                     skill_role.target_value
 22                FROM skill_role, skill_label
 23               WHERE skill_label.skill_id =
 24                     skill_role.skill_id
 25                 ) matrix_result ' ||
 26       ' GROUP BY role_id' ;
 27    dbms_output.put_line(line);
 28    --execute immediate line;
 29    OPEN :reader FOR line;
 30* END;
 31  /

PL/SQL procedure successfully completed.

SQL> print reader

   ROLE_ID Alueen projektipΣtevyys Moottorin koekΣytt÷ EtΣhallintajΣrjestelmΣt
---------- ----------------------- ------------------- -----------------------
   1421866                       2                   2
   3488804                                                                   4 
```

# jsf - JPA 实体作为 JSF Bean？

> ID：10301363
> 
> 赞同：10
> 
> 时间：2012-04-24T15:44:23.180
> 
> 标签：jsf, entity, backing-beans

将实体用作 JSF 支持 Bean 是否有意义？

```
@Entity
@ManagedBean
@ViewScoped
public class User {

    private String firstname;
    private String lastname;

    @EJB
    private UserService service;

    public void submit() {
        service.create(this);
    }

    // ...
} 
```

还是将它们分开保存并在最后将数据从支持 bean 传输到实体更好？

```
@ManagedBean
@ViewScoped
public class UserBean {

    private String firstname;
    private String lastname;

    @EJB
    private UserService service;

    public void submit() {
        User user = new User();
        user.setFirstname(firstname);
        user.setLastname(lastname);
        service.create(user);
    }

    // ...
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-24T15:50:37.817

你*可以*这样做。这在技术上是可行的。但它（设计）在功能上没有任何意义。您基本上将模型与控制器紧密耦合。通常，JPA 实体（模型）是 JSF 托管 bean（控制器）的属性。这使代码保持[干燥](https://en.wikipedia.org/wiki/Don%27t_repeat_yourself)。您不想在所有地方复制相同的属性，更不用说对诸如 bean 验证约束之类的属性进行注释了。

例如

```
@ManagedBean
@ViewScoped
public class Register {

    private User user;

    @EJB
    private UserService service;

    @PostConstruct
    public void init() { 
        user = new User();
    }

    public void submit() {
        service.create(user);
    }

    public User getUser() {
        return user;
    }

} 
```

使用此 Facelets 页面（查看）：

```
<h:form>
    <h:inputText value="#{register.user.email}" />
    <h:inputSecret value="#{register.user.password}" />
    <h:inputText value="#{register.user.firstname}" />
    <h:inputText value="#{register.user.lastname}" />
    ...
    <h:commandButton value="Register" action="#{register.submit}" />
</h:form> 
```

### 也可以看看：

*   [JSF MVC 框架中的 MVC 是哪些组件？](https://stackoverflow.com/questions/5104094/what-components-are-mvc-in-jsf-mvc-framework)
*   [JSF 控制器、服务和 DAO](https://stackoverflow.com/questions/30639785/jsf-controller-service-and-dao/)
*   [JSF中对MVC的矛盾解释](https://stackoverflow.com/questions/32757126/contradictory-explanations-of-mvc-in-jsf/)
*   [JSF 2 重用 JPA 实体中定义的验证？](https://stackoverflow.com/questions/5374009/jsf-2-reusing-the-validation-defined-in-the-jpa-entities/)
*   [为什么实体 bean 不应该由 JSF 框架管理？](https://stackoverflow.com/questions/25431338/why-shouldnt-entity-bean-be-managed-by-jsf-framework/)

# java - Android BaseAdapter 处理空的 ArrayList

> ID：10301367
> 
> 赞同：2
> 
> 时间：2012-04-24T15:44:36.967
> 
> 标签：java, android, listview, baseadapter

我正在尝试使用基本适配器使用 ArrayList> 填充 ListView。ArrayList 由数据库填充，并且数据库可能没有条目，因此是一个空的 ArrayList，例如在第一次启动应用程序时。当 ArrayList 为空时，我收到一个非脚本“java.lang.RuntimeException：无法启动活动 ComponentInfo ... java.lang.NullPointerException”。

我的 onCreate 方法如下所示：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.samples_list_layout);
    mContext = getApplicationContext();
    lv = getListView();
    list = myDatabase.getInstance(mContext).getAllSamples();
    sa = new SamplesAdapter(this, list);
    lv.setAdapter(sa);
    registerForContextMenu(lv);
} 
```

设置 lv.setAdapter(null) 将使应用程序显示我设置的空列表视图。但是，当我把它留给 BaseAdapter 时，我得到了错误。我遵循了 2 个 Android List8.java 和 List14.java 示例，无论哪种方式都给出了相同的结果。我的 BaseAdapter 类如下所示：

```
public class SamplesAdapter extends BaseAdapter {

private static final String SAMPLE_NAME_COL = "name";

private static final String SAMPLE_HOST_COL = "host";

private static final String SAMPLE_ICON_COL = "icon";

private static final String SAMPLE_MODIFIED_STAMP_COL = "moddate";

private Context mContext;
private ArrayList<HashMap<String, String>> samples = new ArrayList<HashMap<String, String>>();

public SamplesAdapter(Context c, ArrayList<HashMap<String, String>> list){
    mContext = c;
    samples = list;
}

public int getCount() {
    return samples.size();
}

public Object getItem(int position) {
    return position;
}

public long getItemId(int position) {
    return position;
}

public View getView(int position, View convertView, ViewGroup parent) {

    LayoutInflater inflater = (LayoutInflater) mContext .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View v = inflater.inflate(R.layout.samples_row_layout, parent, false);
    TextView name = (TextView) v.findViewById(R.id.samples_name);
    name.setText(samples.get(position).get(SAMPLE_NAME_COL));
    TextView host = (TextView) v.findViewById(R.id.samples_host);
    host.setText(samples.get(position).get(SAMPLE_HOST_COL));
    TextView moddate = (TextView) v.findViewById(R.id.samples_mod_stamp);
    moddate.setText(samples.get(position).get(SAMPLE_MODIFIED_STAMP_COL));
    return v;
}

} 
```

我还应该注意，当有要显示的内容时，ListView 会正确显示项目。只有当 ArrayList 为空时才会失败。另外，我使用的是 Android 2.2（不是最好的，我知道）。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T15:47:45.170

让`getCount`返回 0，以避免 NPE：

```
public int getCount() {
    return (samples == null) ? 0 : samples.size();
} 
```

# php - 这是否可以使用 php 按计划更新数据库？

> ID：10301368
> 
> 赞同：0
> 
> 时间：2012-04-24T15:44:43.423
> 
> 标签：php, database

例如，我有一个这样的表：

`Activities: id start_time status`

我想插入一个活动，开始于`2013-01-01`，`status`是`0`，如果服务器成为`2013-01-01`，`status`将成为`1`。

当程序提交到数据库时，我可以编写一个简单的调度`java`程序来执行一个`schedule`动作。`php`另外，我可以有一个长轮询`php`程序来检查。此外，我可以使用数据库触发器来执行此操作。我还可以检查是否有任何记录需要执行用户调用的时间.....

但是有没有

```
1\. to use php ONLY, no database trigger is prefered.
2\. the schedule can content can be editable easier. 
3\. no need the client to driven the change status execution, if no body is calling the requested .php, status can also changed in database, it changed based on time, not by event 
```

例如第 2 点，我可能有一个存储执行状态后的表，例如，它可以将状态更改为`3`，而不是`1`。表是这样的：

`Activity_executes: id activities_id change_status_code`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:47:49.410

您可以在 PHP 中编写一个脚本来检查事件，并根据需要进行更新。然后，您可以按照您设置的计划使用 cron 作业调用它。如果您选择或需要，您仍然可以手动运行相同的脚本。

# c - 循环展开优化，这是如何工作的

> ID：10301372
> 
> 赞同：2
> 
> 时间：2012-04-24T15:45:01.807
> 
> 标签：c, assembly

考虑这个 C 代码：

```
int sum=0;
for(int i=0;i<5;i++)
    sum+=i; 
```

这可以以这种方式在（伪）汇编中翻译（没有循环展开）：

```
% pseudo-code assembly
ADDI $R10, #0   % sum
ADDI $R11, #0   % i
LOOP:
ADD $R10, $R11
ADDI $R11, #1
BNE $R11, #5 LOOP 
```

所以我的第一个问题是如何在这两种方式之间使用循环展开来翻译这段代码：

1)

```
ADDI $R10, #0
ADDI $R10, #0
ADDI $R10, #1
ADDI $R10, #2
ADDI $R10, #3
ADDI $R10, #4 
```

2)

```
 ADD $R10, #10 
```

编译器是否能够优化代码并直接知道它必须加 10 而不执行所有求和？

另外，是否有可能用分支指令阻塞流水线？我必须这样写吗：

```
% pseudo-code assembly
ADDI $R10, #0   % sum
ADDI $R11, #0   % i
LOOP:
ADD $R10, $R11
ADDI $R11, #1
NOP   % is this necessary to avoid the pipeline blocking?
NOP
NOP
NOP
BNE $R11, #5 LOOP 
```

为了避免 fetch-decode-exe-mem-write back 循环被分支中断？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-24T16:06:03.703

这更多是为了演示编译器*的能力*，而不是每个编译器都会做什么。来源：

```
#include <stdio.h>

int main(void)
{
    int i, sum = 0;

    for(i=0; i<5; i++) {
        sum+=i;
    }

    printf("%d\n", sum);
    return 0;
} 
```

注意`printf`我添加的。如果不使用该变量，编译器将优化整个循环。

**使用 -O0 编译（无优化）**

`gcc -Wall -O0 -S -c lala.c`：

```
.L3:
    movl    -8(%rbp), %eax
    addl    %eax, -4(%rbp)
    addl    $1, -8(%rbp)
.L2:
    cmpl    $4, -8(%rbp)
    jle .L3 
```

循环以“愚蠢”的方式发生，`-8(%rbp)`成为变量`i`。

**使用 -O1 编译（优化级别 1）**

`gcc -Wall -O1 -S -c lala.c`：

```
movl    $10, %edx 
```

该循环已完全删除并替换为等效值。

* * *

在展开时，编译器查看会发生多少次迭代，并尝试通过执行较少的迭代来展开。例如，循环体可能被复制两次，这将导致分支数量减半。C中的这种情况：

```
int i = 0, sum = 0;

sum += i;
i++;

for(; i<5;i++) {
    sum+=i;
    i++;
    sum+=i;
} 
```

请注意，必须从循环中提取一次迭代。这是因为 5 是一个奇数，所以不能简单地通过复制内容来减半。在这种情况下，循环只会输入两次。生成的汇编代码`-O0`：

```
 movl    -8(%rbp), %eax
    addl    %eax, -4(%rbp)
    addl    $1, -8(%rbp)
    jmp .L2
.L3:
    movl    -8(%rbp), %eax
    addl    %eax, -4(%rbp)
    addl    $1, -8(%rbp)
    movl    -8(%rbp), %eax
    addl    %eax, -4(%rbp)
    addl    $1, -8(%rbp)
.L2:
    cmpl    $4, -8(%rbp) 
```

在 C 中完全展开：

```
for(i=0; i<5;i++) {
    sum+=i;
    i++;
    sum+=i;
    i++;
    sum+=i;
    i++;
    sum+=i;
    i++;
    sum+=i;
} 
```

这次循环实际上只进入了一次。产生的程序集`-O0`：

```
.L3:
    movl    -8(%rbp), %eax
    addl    %eax, -4(%rbp)
    addl    $1, -8(%rbp)
    movl    -8(%rbp), %eax
    addl    %eax, -4(%rbp)
    addl    $1, -8(%rbp)
    movl    -8(%rbp), %eax
    addl    %eax, -4(%rbp)
    addl    $1, -8(%rbp)
    movl    -8(%rbp), %eax
    addl    %eax, -4(%rbp)
    addl    $1, -8(%rbp)
    movl    -8(%rbp), %eax
    addl    %eax, -4(%rbp)
    addl    $1, -8(%rbp)
.L2:
    cmpl    $4, -8(%rbp)
    jle .L3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T16:06:32.550

在基本层面上，循环展开的概念只是简单地根据需要多次复制循环体。编译器也可以进行其他优化（例如从计算中插入固定值），但不会被视为展开循环，但可能会将其全部替换。但这最终将取决于使用的编译器和标志。

C 代码（仅展开）看起来更像这样：

```
int sum = 0;
int i = 0;
for ( ; i < (5 & ~(4-1)); i += 4) /* unrolling 4 iterations */
{
    sum+=(i+0);
    sum+=(i+1);
    sum+=(i+2);
    sum+=(i+3);
}
for ( ; i < 5; i++)
{
    sum+=i;
} 
```

尽管编译器有很多机会在这里进行更多优化，但这只是一步。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T16:10:54.193

> 所以我的第一个问题是如何在这两种方式之间使用循环展开来翻译这段代码

这种优化通常在 AST 级别而不是输出代码（例如汇编）级别上实现。当迭代次数固定且在编译时已知时，可以进行循环展开。例如，我有这个 AST：

```
Program
|
+--For
   |
   +--Var
   |  |
   |  +--Variable i
   |
   +--Start
   |  |
   |  +--Constant 1
   |
   +--End
   |  |
   |  +--Constant 3
   |
   +--Statements
      |
      + Print i 
```

编译器会知道 For 的 Start 和 End 是常量，因此可以轻松复制语句，将所有出现的 Var 替换为其每次调用的值。对于上面的 AST，它会被翻译成：

```
Program
|
+--Print 1
|
+--Print 2
|
+--Print 3 
```

> 编译器是否能够优化代码并直接知道它必须加 10 而不执行所有求和？

是的，如果它被实现为具有这样的功能。这实际上是对上述情况的改进。在您的示例情况下，在展开之后，编译器可以看到所有 l 值保持不变，而 r 值是常量。因此，它可以执行窥孔优化并结合恒定折叠以产生单次加法。如果窥视孔优化也考虑声明，那么它甚至可以进一步优化为单个移动指令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T15:55:57.367

对此没有一般的答案，不同的编译器，不同的版本，不同的编译器标志会有所不同。Use the appropriate option of your compiler to look at the assembler outcome. 使用 gcc 和亲戚，这是`-S`选项。

# ruby-on-rails-3 - Rails 将两个对象组合成一个结果哈希

> ID：10301375
> 
> 赞同：2
> 
> 时间：2012-04-24T15:45:21.447
> 
> 标签：ruby-on-rails-3, activerecord

我在 Rails 中有以下模型：*用户*和 *Friendship_Requests*friendship_requests 在“from_user”和“to_user”字段中包含用户 ID。我想从请求模型（也包含一个消息字段）中获取链接到特定用户的请求列表。我还希望结果返回保存在用户模型中的请求用户数据。

在 SQL 中，我将使用以下内容：

```
SELECT users.*, friendships_requests.*
FROM friendships_requests
JOIN users ON friendships_requests.from_user = users.id 
```

任何想法表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:51:26.950

要查找发送到的友谊请求`@user`：

```
@friendship_requests = FriendshipRequests.find_by_to_user(@user.id) 
```

然后可以检索到与发送用户相关的信息：

```
@friendship_requests.each do |request|
  user = User.find_by_id request.from_user
  # Do something
end 
```

或者，如果你想收集所有这些

```
@users = @friendship_requests.map {|r| User.find_by_id r.from_user} 
```

# c++ - 不清楚如何在从抽象基类派生的类中实现运算符重载

> ID：10301377
> 
> 赞同：0
> 
> 时间：2012-04-24T15:45:27.293
> 
> 标签：c++, operator-overloading, abstract-class

我们的教授对此非常不清楚，所以我希望我对此不要太含糊。基本上我们需要编写一个抽象基类，其他（非抽象）类从该类继承，抽象基类的头文件如下所示：

```
//AbstractBase.h 
class AbstractBase
{
    public:
        AbstractBase();
        virtual int operator+ (int)=0;
} 
```

我不知道在实现 .cpp 文件中放什么，因为它是一个抽象类（所以你不能从那个类创建任何对象，我在这里可能非常非常错误）所以我只是没有做一个。

然后是带有头文件和实现的派生类，如下所示：

```
//Headerfile for DerivedClass
#include "AbstractBase.h"
class DerivedClass: public AbstractBase
{
    public:
        DerivedClass(double &);
        DerivedClass * operator+ (DerivedClass*);
        double getVar();
        void setVar(double)
    private:
        double Var;
}

//Implementation of DerivedClass
#include "DerivedClass.h"
class DerivedClass::DerivedClass(double &Input) :Var(Input)
{}

double DerivedClass::getVar()
{
    return Var;
}

void DerivedClass::setVar(double Input)
{
    Var=Input;
}

DerivedClass * DerivedClass::operator+ (DerivedClass * object)
{
    double Sum;
    Sum=Var+object->getVar()
    DerivedClass result(Sum);
    return result;
} 
```

所以我的问题归结为：

*   重载部分（最后几行）应该执行以下操作：当我添加 DerivedClass 类的两个对象时，它应该只是将私有变量（双 Var）添加在一起。我已经进行了一些搜索，但无法立即找到我可以使用的东西（可能是因为我对这件事的了解有限）。

一个小问题：

*   我该如何处理 AbstractBase 类？我的任务描述指出它应该只包含 4 个虚拟函数，它们都重载了一个运算符。但它是一个抽象基类，我还不知道如何重载它们（就像说“添加两个东西，我不知道怎么做，但我知道你可以把它们加起来......”，这就是所有的抽象班级说）

编辑：关于我认为它应该如何发生的一些澄清。

抽象基类包含一个虚函数operator+。在派生类中，我定义了一个新的 operator+，它知道如何处理派生类对象的添加。如果我使用 DerivedClass* 类型的指针，它将忽略虚函数并使用 DerivedClass 中定义的 operator+ 函数（虚函数的基本原理？）。问题似乎派生类仍然被视为抽象类，所以我不能使用组件 10 提供的代码，因为它实例化了 DerivedClass 的对象（这是不可能的，因为它显然是抽象的）

编辑2：

我们的教授决定省略运算符重载，因为它涉及的代码太复杂：D 无论如何感谢您的帮助，我确实学会了如何正确实现它（有点）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:00:33.400

你的要求有点混乱。假设您的基类是正确的，您将需要一个构造函数，因为您已经声明了一个：

```
AbstractBase::AbstractBase() {} 
```

你不需要在这里实现 operator+ 。我不确定你对派生的`operator+`看法，但它可能应该如下所示：

```
DerivedClass DerivedClass::operator+ (const DerivedClass& rhs)
{
    return DerivedClass(Var + rhs.Var);
} 
```

不过，这不会覆盖您的基础`operator+ (int)`。

这样做的目的是演示虚函数还是运算符重载？不管怎样，我认为你需要你的教授明确他们在寻找什么。

# java - 不能直接在 JFrame 上绘画

> ID：10301380
> 
> 赞同：0
> 
> 时间：2012-04-24T15:45:40.380
> 
> 标签：java, swing, paint

我有一个任务是用 Java 创建一个绘图程序。我设法创造了一些东西，但并不完全是我想要的。

我的问题是我无法根据 IDE 提供的选项在我的 IDE（NetBeans 7.0.1）中创建 JFrame，并正确调用绘制类。

更具体地说，我想从一个面板（例如 Panel1）中按下一个按钮并在同一帧中的 Panel2 中绘画。

那是班级的召唤：

```
private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {                                         

    PaintFlower102 f = new PaintFlower102();
} 
```

部分课程：

```
 super("Drag to Paint");
    getContentPane().add(new Label ("Click and Drag"),BorderLayout.SOUTH);
    // add(new JButton("Brush 20"),BorderLayout.NORTH);
    addMouseMotionListener( new MouseMotionAdapter() {

        @Override
        public void mouseDragged(MouseEvent event) {
            xval=event.getX();
            yval=event.getY();
            repaint();
        }
    });

    setSize(500, 500);
    setVisible(true);
    setDefaultCloseOperation(PaintFlower102.DISPOSE_ON_CLOSE);
}

public void paint(Graphics g) {      
    g.fillOval(xval, yval, 10, 10);   
} 
```

问题是，如果我不把它`extend JFrame`放在课堂上，这是行不通的。如果我这样做，它会创建一个我可以在其中绘制的新框架。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T15:51:33.917

建议：

*   除非在绝对需要的极少数情况下（这不是其中之一），否则不要直接在 JFrame 中绘制。
*   而是在 JPanel 或 JComponent 或 JComponent 的其他衍生物中进行绘制。
*   在类的方法中绘制`paintComponent(Graphics g)`，而不是在`paint(Graphics g)`.
*   阅读有关这方面的 Java 教程，因为它在那里得到了很好的解释。查看[Trail：2D 图形](http://docs.oracle.com/javase/tutorial/2d/index.html)和[执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/index.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T23:24:12.980

我可能是错的，但我认为你需要包含 super.paintComponent(g)，并像 Hovercraft Full Of Eels 所说的那样覆盖 paintComponent 方法。

```
public void paintComponent(Graphics g) {
    super.paintComponent(g);       

    // Draw Oval
   g.fillOval(xval, yval, 10, 10);
} 
```

# lucene - Lucene 在搜索汉堡时带上芝士汉堡

> ID：10301383
> 
> 赞同：4
> 
> 时间：2012-04-24T15:46:00.083
> 
> 标签：lucene

如果 lucene 文档包含单词**cheeseburger**并且用户搜索**burger**以找到该文档，我希望这样。我看到我可能需要一个自定义分析器来将这个复合词分解为**cheese**和**burger**。但是，破口大骂也可能带来不相干的结果。

例如：如果在索引生产时我们同时索引**产品**和**离子**，那么当用户搜索包含**生产的****离子**文档时会出现，这是不相关的。

 **所以一个简单的断词器不会削减它。我需要一种方法来知道**芝士汉堡**与**汉堡**和**奶酪**有关，但**生产**与**ion**无关。

是否有更智能的过程来实现这一目标？

这是否有一个名字，就像词干是将单词简化为词根形式一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T03:48:39.643

Depending on how accurate you want your synonymy to be, you might need to look into approaches such as [Latent Semantic Analysis](http://en.wikipedia.org/wiki/Latent_semantic_indexing) (LSA) and its variants such as LDA etc. A simpler approach would be to use an Ontology such as [Wordnet](http://wordnet.princeton.edu/) to augment your searches. A wordnet Lucene index is available. However if your scenario includes domain-specific vocab then you might need to generate a "mapping" Ontology.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:12:05.533

您应该查看[DictionaryCompoundWordTokenFilter](http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/api/all/org/apache/lucene/analysis/compound/DictionaryCompoundWordTokenFilter.html)，它使用蛮力算法根据字典拆分复合名词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T06:24:24.283

通过查看单词获得关联不会扩展到其他单词。例如，您无法仅通过查看单词就知道“whopper”与汉堡相关联，而“巨无霸”与奶酪相关联。为了使搜索了解关联，您可能需要一个关联数据库，例如“A 是 B”或“A 包含 B”。（正如 Mikos 所提到的，我认为 WordNet 提供了这样一个数据库。）然后，当您在查询中看到 B 时，您翻译该查询，以便它也搜索 A。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T12:19:41.660

我认为根本的问题是——你要索引的集合有多大？如果您要为所有同义词和相关词都已知的集合建立索引，则索引可以直接包含同义词和相关词，例如“cheeseburger”包括相关词“cheese”和“burger”。（一种在 LOINC 标准医学术语 Lucene 索引中成功使用的方法。）

如果您试图解决整个人类语言（英语、中文等）的一般问题，那么您必须进行上述某种语义分析。

与您正在索引的领域的主题专家交谈可能会很有用，以了解他们如何搜索术语 - 他们使用哪些同义词/相关词，他们是否定义了同义词/相关词列表，他们是否需要/使用词干等。这应该让您了解您需要采用哪种方法（直接同义词/相关词包含或语义分析）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T15:56:49.860

在大多数情况下，您可以简单地使用带有前导通配符 *burger 的通配符查询。您只需在查询解析器上启用对前导通配符的支持：

```
parser = new QueryParser(LuceneVersion.getVersion(), searchedAttributes, analyzer);
parser.setAllowLeadingWildcard(true); 
```

注意：前导通配符可能会减慢您的搜索速度。

如果您需要更具体的解决方案，我建议您使用词干。如果真的是找到合适的分析仪的问题。有几种语言的词干实现，例如 SnowballAnalyzer (http://lucene.apache.org/core/3_6_0/api/all/org/apache/lucene/analysis/snowball/SnowballAnalyzer.html)。

此致，

克里斯**

# c# - GetKeyboardState 在远程桌面全屏模式下不起作用

> ID：10301387
> 
> 赞同：4
> 
> 时间：2012-04-24T15:46:07.887
> 
> 标签：c#, .net, winapi

我正在使用 win api [GetKeyboardState](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646299%28v=vs.85%29.aspx)来跟踪系统中的所有键盘按下。

这很好用，但是它在远程桌面上有有趣的行为。

如果远程桌面处于 Windows 模式，则可以正常工作，但是如果远程桌面全屏，则无法正常工作。

有没有人有任何经验或没有如何在全屏远程桌面中获得按键？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T17:00:52.003

使用挂钩，您将在任何其他程序之前收到键状态，您甚至可以取消击键。使用 user32.DLL 中的“SetWindowsHookExW”润湿一个挂钩，使用“UnhookWindowsHookEx”删除一个。有很多示例代码，试试这个[http://www.codeproject.com/Articles/19004/A-Simple-C-Global-Low-Level-Keyboard-Hook](http://www.codeproject.com/Articles/19004/A-Simple-C-Global-Low-Level-Keyboard-Hook)

# asp.net-mvc-3 - 如何从 MVC 3 的输出缓存中排除 Master 中的服务器绑定数据？

> ID：10301390
> 
> 赞同：0
> 
> 时间：2012-04-24T15:46:16.690
> 
> 标签：asp.net-mvc-3, caching, outputcache

我正在使用 MVC 3，目前这是我的代码，不需要缓存，它在多个视图之间共享

```
 <div id="logindisplay">
    <h2> Welcome <strong><%= Context.User.Identity.Name %></strong></h2>
 </div> 
```

我所有的页面顶部都有这个，其中包括有这个的主视图

```
%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<dynamic>" %> 
```

最后，我所有的控制器在 Index() 动作中都有这个

```
 [OutputCache(Duration=60*60*24)]
        public ActionResult Index()
        {               
            return View();
        } 
```

我的一些部分观点也有

我的问题是在这里实现部分缓存/甜甜圈缓存的最佳方式是什么？我想使用其他开源库作为最后的手段，因为如果有更简单的 MVC 3 解决方案，我不知道，希望您的帮助！！！

**更新，因为我现在无法回答我自己的问题**

所以我在 OutputCache 上使用了这个属性。显然它应该可以工作，因为我的问题源于它被缓存在服务器端，而我不想缓存的那行代码是在服务器端评估的！

```
[OutputCache(Location = OutputCacheLocation.Client,Duration = 60 * 60 * 24)] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:52:16.530

ASP.NET MVC 2 和 3 不支持甜甜圈缓存。[它可以](http://haacked.com/archive/2008/11/05/donut-caching-in-asp.net-mvc.aspx)在 ASP.NET MVC 1 中返回，但在 ASP.NET MVC 2 中已删除对它的支持。这是一篇[非常好的文章](http://www.devtrends.co.uk/blog/donut-output-caching-in-asp.net-mvc-3)，说明了实现它的一种可能方法。

# wix - Wix 3.6 Burn：非托管自定义 UI

> ID：10301391
> 
> 赞同：1
> 
> 时间：2012-04-24T15:46:16.737
> 
> 标签：wix, windows-installer, burn

我想将多个 MSI 打包到一个安装包中，因此我使用的是来自 Wix3.6 的 Burn。

我想要一个简单的用户界面，允许选择应该安装哪些包。

我了解标准 BA (wixstdba.dll) 不提供此功能，我需要编写自己的 BA。

我一直在将 'wix36-sources' 包中的项目 'wixstdba' 作为 C++ BA 的示例。首先，我尝试简单地重建项目并将生成的 DLL 添加到我的 Bundle 中，如下所示：

```
<Bundle 
    Name="$(var.ProductName)"
     Version="$(var.ProductVersion)"
    Manufacturer="$(var.VendorName)"
    UpgradeCode="$(var.UpgradeCode)" >
    <BootstrapperApplication SourceFile="wixstdba.dll" />
    <Chain>
    ... 
```

我成功构建了 Bundle：

```
light -ext WixBalExtension.dll -ext WixUIExtension -ext WixUtilExtension installer-v$(VERSION).wixobj -o installer-v$(VERSION).exe

candle -o installer-v$(VERSION).wixobj bundle.wxs -d"Platform=x64" 
```

但是，当我运行生成的 .exe 时，什么也没有发生。没有 UI 出现，没有安装软件，也没有错误消息。

知道我可能做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T20:29:19.737

当您运行 .exe 时，它​​应该在系统的 %TEMP% 文件夹中创建一个日志文件。这应该告诉您是否遇到任何错误。文件名将是产品名称（空格替换为下划线）。找到它的最简单方法是打开 Windows 资源管理器窗口，键入“%TEMP%”作为文件夹名称，然后按修改日期 desc 排序。最上面的文件可能是正确的。

引导程序很可能正在运行，但是当它尝试加载您的代码时，它无法加载某些依赖项，或者有一些错误。希望日志能够为您提供足够的提示来找到问题。

如果您最终需要添加额外的库/文件供您的 BA 使用，请将它们添加到捆绑负载文件中，如下所示：

```
  <BootstrapperApplicationRef SourceFile="wixstdba.dll" >
    <Payload SourceFile="$(var.ReferencedProject.TargetDir)\file.needed.at.runtime" />
  </BootstrapperApplicationRef>

```

这将在运行时将文件放在与解压 BA 相同的文件夹中。

# php - 标头（'位置：'）不重定向

> ID：10301392
> 
> 赞同：1
> 
> 时间：2012-04-24T15:46:18.353
> 
> 标签：php, hosting, hostmonster

我有一个登录页面，它检查`username`和`password`并且如果用户提供的凭据匹配，它会设置会话并重定向用户，它可以在我的`godadd`托管帐户上运行，但现在我已经转移了我的托管，但它突然停止工作，以下是编码

```
if (count($result) > 0)
            {               
                $row= mysql_fetch_array($result);
                $userID = $row['userID'];               
                $firstName = $row['FirstName'];         

                $isActive = $row['IsActive'];

                if ($isActive == '1')
                {

                    $_SESSION['user'] = $firstName;     
                    //var_dump($firstName); //it gives me the right username                
                    //echo" - here";  //this also gets echoed
                    header("Location: http://google.com/"); //it just dies silently
                    exit;
                } 
```

请帮我找出我哪里出错了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T15:48:58.497

你在调用 header() 之前输出任何东西吗？

如果是这样，请将 ob_start() 放在脚本的开头，或者确保在调用 header() 之前没有回显任何内容

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T15:50:36.073

您需要确保在标头标记之前不输出任何内容。由于它之前工作过，我认为在调用 header 之前你是 echo'n 的东西不是一个错误，并且由于你没有看到输出，我认为它正在输出空白。在一些地方，一些空白和/或不可见字符可以潜入文件：

将光标放在开始 PHP 标记 ( `<? or <?php`) 之前并按几次退格键，然后按 delete 删除`<`，然后重新键入`<`. 这将确保在您的标题之前没有不可见的字符被输出到浏览器。

然后浏览该文件包含的所有文件，并执行相同的操作，并删除`?>`文件末尾的所有文件。如果这些文件包含任何其他文件，请在它们上重复此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T15:48:39.630

如果你想使用`header()`，你必须`echo`在它之前没有任何东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-18T11:37:09.260

添加[`ob_start();`](http://php.net/manual/en/function.ob-start.php)到脚本的开头并添加[`ob_end_flush();`](http://php.net/manual/en/function.ob-end-flush.php)到脚本的末尾以避免此问题。

ob_start(); 将打开输出缓冲和 ob_end_flush(); 将发送最顶层输出缓冲区的内容并关闭此输出缓冲区。

# bison - Flex-Bison：如何创建关键字？

> ID：10301397
> 
> 赞同：2
> 
> 时间：2012-04-24T15:46:38.727
> 
> 标签：bison, flex-lexer

我正在用 Flex/Bison 编写一个小程序来标记/解析我创建的查询语言。我想知道是否有任何方法可以在 Flex/Bison 中创建任何关键字。

我的意思是：flex 将输入分解成一个标记列表，但是有没有办法创建一个关键字列表，这样每次 flex 看到它们都会返回单词“keyword”。

或以下是执行此操作的唯一方法：

```
"dog"|"cat"     return KEYWORD; 
```

flex/bison 是否可以使用任何数据结构，以便每次看到该数据结构的成员时，它都会将其识别为关键字？

谢谢，莎拉

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:17:41.520

我认为更好的方法是用野牛处理这个问题，如下所示：

在弹性：

```
"dog" { return T_DOG; }
"cat" { return T_CAT; }
... 
```

在野牛中，您设置了接受任何这些令牌的规则：

```
keyworks: T_DOG | T_CAT | ... ;

other_rule: keyworks T_ACTION; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:22:02.500

试图在字里行间阅读以找出您实际要问的内容，似乎您想要的是能够在运行时更改关键字。如果您的关键字都遵循一个共同的模式，并且遵循该模式的其他（非关键字）都是相同的标记，您可以使用哈希表或其他查找表。我将`std::map`在这里使用 C++，但您可以使用任何其他允许查找的数据结构：

```
%{
extern std::map<std::string, int> keyword_table;
%}
%%

[A-Za-z_$][A-Za-z_$0-9]*    { auto k = keyword_table.find(std::string(yytext));
                              if (k != keyword_table.end())
                                  return k->second;
                              return T_IDENTIFIER; } 
```

现在，您可以将任何带有相关标记的标识符粘贴到 中`keyword_table`，词法分析器将识别该关键字并返回相应的标记。任何未被识别为关键字（不在表中）的标识符都将返回一个`T_IDENTIFIER`标记。

# facebook - 为什么在 Facebook 图表事件上发布图像不再起作用？

> ID：10301399
> 
> 赞同：1
> 
> 时间：2012-04-24T15:46:50.507
> 
> 标签：facebook, facebook-graph-api

我在为页面创建 facebook 图形事件时上传图像时遇到问题。这段代码在生产中并且运行正常，直到 3 月 27 日下午 2 点停止运行。

我安装了最新的 facebook api。我做的测试样品也不再起作用了。

我查看了开发人员路线图，但没有找到任何东西。

我得到的错误是：

```
Fatal error: Uncaught OAuthException: (#324) Missing or invalid image file thrown in C:\devel\www\create_fb_events\php-sdk\src\base_facebook.php on line 1106 
```

我的代码是：

```
$facebook = new Facebook(array(
  'access_token' => $accessToken,
  'appId'  => $appId,
  'secret' => $secret,
  'fileUpload' => true
));
$e = $facebook->api('/'.$appId.'/events', "post", array('file.png' => '@' . realpath('C:\devel\www\create_fb_events\Elephant-icon.png').";type=image/png", 'name'=>'test9', 'description'=>'', 'start_time'=>time(), 'end_time'=>time()+5000, 'location'=>'some_place', 'privacy_type'=>'SECRET')); 
```

有人有线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:03:55.820

我没有遇到此错误，但我使用的是相同或类似的技术。不过，您似乎并不孤单：

*   [脸书错误报告](https://developers.facebook.com/bugs/377495428938172)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:38:20.597

我刚刚在类似的错误报告中发布了以下内容：[https ://developers.facebook.com/bugs/443491802360253](https://developers.facebook.com/bugs/443491802360253)

该错误并非“不正确”，只是没有那么具体，而且用户体验很差。我认为图像无效有多种方式；但是，到目前为止，我们实际遇到的唯一一个是最小图像宽度要求为 180 像素。

如果您对图像有疑问，也许将图像直接上传到 facebook 将帮助您获得有关图像被拒绝原因的更多信息。我认为 facebook 本身（而不是 apis）提供了更好的错误消息。

# ruby-on-rails - ActiveRecord 查询中的日期时间算法 (PostgreSQL)

> ID：10301400
> 
> 赞同：4
> 
> 时间：2012-04-24T15:46:50.943
> 
> 标签：ruby-on-rails, postgresql, ruby-on-rails-3, activerecord, rails-activerecord

我在/表中有两`datetime`列：和. 我想查找其出生日期在创建日期前不到 13 年的用户。`User``users``created_at``birthdate`

等效的 Rails`if`语句将是`((created_at - birthdate) < 13.years)`

如何将其转换为 ActiveRecord 查询（可以在 PostgreSQL 上运行的查询）？这甚至可能吗，还是我必须手动遍历所有记录？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-24T18:04:10.727

最简单的方法是使用[间隔](http://www.postgresql.org/docs/current/static/functions-datetime.html#OPERATORS-DATETIME-TABLE)，那么它几乎是 Rails 版本的直接音译：

```
User.where(%q{created_at - birthdate < interval '13 years'}) 
```

两个时间戳（或时间戳和日期）之间的差异是一个间隔，因此您只需要比较右侧的适当值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:00:30.707

你只需要在你的 where 子句中用 PostgreSQL 语法来表述它。

对于 MySQL，这看起来与使用[datediff](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_datediff)函数类似：

```
User.where("DATEDIFF(created_at, birthdate) > (13 * 365)") 
```

13*356 代表 3 年的天数，因为 datediff 返回天数差异。

然后，我会将其封装在类似作用域的函数中，如下所示：

```
class User < ActiveRecord::Model
  def self.age_difference(years)
    where("DATEDIFF(created_at, birthdate) > (? * 365)", years)
  end
end 
```

所以你可以这样称呼它：

```
User.age_difference(13).each do |user|
  puts user.inspect
end 
```

我想它在 Postgres 中是相似的。

# mysql - 拒绝mysql中的某些查询

> ID：10301402
> 
> 赞同：2
> 
> 时间：2012-04-24T15:46:54.223
> 
> 标签：mysql, sql, my.cnf

我在代码中找不到触发查询的位置，想知道是否有 mysql 配置会在触发时拒绝该查询？例如，在我的情况下`UPDATE table SET col1 = NULL, col2 = NULL, col3 = NULL`......请帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T15:52:37.727

如上所述，您可以使用[触发器](http://dev.mysql.com/doc/refman/5.6/en/triggers.html)；只需在满足所需条件时调用一个不存在的过程来引发错误。

```
DELIMITER ;;

CREATE TRIGGER reject_null_table_update BEFORE UPDATE ON table FOR EACH ROW
IF
      NEW.col1 IS NULL
  AND NEW.col2 IS NULL
  AND NEW.col3 IS NULL
  -- etc
THEN
  CALL raise_error();
END IF;;

DELIMITER ; 
```

# iphone - 如何将 iPhone 应用程序从 Xcode 部署到 iPhone？

> ID：10301403
> 
> 赞同：1
> 
> 时间：2012-04-24T15:46:59.450
> 
> 标签：iphone, sdk

如何在没有 99 美元的 Apple 证书的情况下将 iPhone 应用程序从 Xcode 部署到真实的 iPhone 设备？

更新：我不知道如何部署。是的，我已经越狱了 Iphone。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:07:19.513

您唯一的选择是越狱您的手机，即使在那里我也不确定您是否可以直接从 Xcode 部署。

问题是“普通”iPhone 需要签名的二进制文件，而签署应用程序的唯一官方方法是使用 Apple “祝福”的证书。

# java - GWT DisclosurePanel()

> ID：10301404
> 
> 赞同：1
> 
> 时间：2012-04-24T15:47:05.660
> 
> 标签：java, gwt

嗨，我正在尝试使用 DisclosurePanel()。

我有2 `DisclosurePanel`（）。当我打开第一个`DisclosurePanel`（）时，第二个`DisclosurePanel`（）从原始位置移动并从第一个`DisclosurePanel`（）大小的末尾开始。

我想做的是

第一个 DisclosurePanel() 应该与第二个 DisclosurePanel() 重叠。

原来的

```
> Music //1st DisclosurePanel()
> Image  //2nd  DisclosurePanel() 
```

**打开后**

```
v Music

> Image 
```

**我想要的是**

```
v Music // display panel
> Image 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T13:15:44.347

Thats not how DisclosurePanel works out of the box -- but it should be possible to fake it:

```
.panel td:last-child {
  position: absolute;
  width: 600px;
  background-color: #fff;
  left: 400px;
  margin-top: -30px;
} 
```

Set that css class on the panel (and modify the width, left and margin-top properties).

# jquery - 使用 jQuery 更新所需验证器客户端的错误消息

> ID：10301405
> 
> 赞同：0
> 
> 时间：2012-04-24T15:47:08.430
> 
> 标签：jquery, asp.net, validation

是否可以使用 jQuery 在所需的验证器客户端更新 ErrorMessage。

我尝试了以下方法，但它不起作用。

```
$("#<%=rbl1.ClientID %>").change(function () {
       switch ($('#<%= rbl1.ClientID %> input:radio:checked').val()) {
             case 'Yes':
                    $('#<%=Label1.ClientID %>').text('Label text');
                    $('<%=vReq1.ClientID%>').Attr('ErrorMessage','Text 1'); 
                   break;
             case 'No':
                     $('#<%=Label1.ClientID %>').text('Other Label text');
                    $('#<%=vReq1.ClientID %>').Attr('ErrorMessage', 'Text 2'); 
                   break;
             default:
                    $('#<%=Label1.ClientID %>').text('Other Text');
            }; 
```

});

上面的代码可以很好地更新标签文本，但不会更新验证器错误消息值

提前致谢

电击

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T13:22:41.687

啊....明白了：

```
$('#<%=vReq1.ClientID %>').attr('errormessage', 'Text 2'); 
```

# javascript - 在 JSP 中找不到 JavaScript 函数

> ID：10301412
> 
> 赞同：3
> 
> 时间：2012-04-24T15:47:39.303
> 
> 标签：javascript

我有一些 JSP 页面，其中包括一些 JavaScript（jquery、jquery mobile 和我编写的一些 javascript 函数）。

加载页面并尝试运行我的函数时，我在 Firebug 中遇到错误，即未找到该函数。我查看了页面源代码，功能就在那里。

所有其他 jquery 移动功能都可以工作。

使我的脚本工作的唯一方法是强制刷新（ctrl+f5）。

为什么会这样？我该如何解决？

**编辑**

似乎简单的刷新也可以。

**这是页面的源代码：**

[http://pastebin.com/6sJnfPDQ](http://pastebin.com/6sJnfPDQ)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:49:15.197

确保您的所有 js 文件都已正确加载。

还要确保以正确的顺序加载您的 js 文件。

确保在必要时将 JS 包装在某种类型的文档就绪函数中

另外，我建议您将`type`属性添加到脚本标签中：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript" src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:56:49.817

我已重新标记您的问题以删除“Java”和“JSP”，因为这无关紧要（服务器与浏览器）。

在浏览器中呈现您的 JSP 后，请查看页面源代码并查看您的标签发生了什么。

# android - Whatsapp 的意图过滤器-> 共享图像

> ID：10301413
> 
> 赞同：2
> 
> 时间：2012-04-24T15:47:40.210
> 
> 标签：android, android-intent, intentfilter, whatsapp

如果您尝试与 Whatsapp 共享图像，它会给您一个列表供您选择：例如相机、图库等。现在我想将我的应用程序放在此列表中。我看到了一些应用程序，例如“为whatsapp 绘画”，这是可能的。我尝试了“android.media.action.IMAGE_CAPTURE”，但这只是替换了系统相机。我想在列表中有一个新点。提前感谢乔纳斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-22T17:13:49.087

这对我有用：

```
 <intent-filter>
            <action android:name="android.intent.action.PICK" /> 
            <category android:name="android.intent.category.DEFAULT"  /> 
            <data android:mimeType="image/*" />
        </intent-filter> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T15:56:22.330

您可以创建自己的 Intent-Action 或在使用不同的 itentfilter 配置时出现在其他列表中，有关详细信息，请参阅[http://developer.android.com/guide/topics/intents/intents-filters.html 。](http://developer.android.com/guide/topics/intents/intents-filters.html)

# javascript - 使用 d3.js 动画圆弧到水平线

> ID：10301421
> 
> 赞同：4
> 
> 时间：2012-04-24T15:48:02.953
> 
> 标签：javascript, d3.js

我正在尝试将弧线动画化为水平线，但不确定这是否可行以及最好的方法是什么。我正在使用路径生成器绘制弧线：

```
var arc = d3.svg.arc()
  .outerRadius(function(d){ return d.outerRadius; })
  .innerRadius(function(d){ return d.outerRadius*0.6; })
  .startAngle(function(d){ return d.startAngle; })
  .endAngle(function(d){ return d.endAngle; }); 
```

然后我正在读取 json 数据并使用饼图布局附加弧：

```
var donut = d3.layout.pie();
var paths = arcs.selectAll("path").data(donut(json));
  paths.enter().append("path")
  .on("click", anim)
  .attr("d", arc).transition().duration(1000)
  .attrTween("d", tweenPie); 
```

单击路径时，我希望能够对弧进行动画处理以打开并变平为水平线。我怎样才能做到这一点？任何意见是极大的赞赏。谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T17:04:42.787

一条圆弧开成一条线就像一条圆弧的内半径和外半径一起增长，并且结束角度与起始角度分开以保持相同的弧长。

首先，您知道弧的长度（开始和结束之间的半径乘以弧度）

然后增加半径并减小起点和终点之间的距离，使弧长保持不变。记得移动圆弧的原点以补偿不断增长的半径。

当半径接近一个非常大的值时，开始和结束之间的弧度会缩小，直到几乎没有差异或没有差异，此时您将有一条线。

# android - Android 计时器 - 1 小时不正确

> ID：10301429
> 
> 赞同：1
> 
> 时间：2012-04-24T15:48:38.973
> 
> 标签：android, timer

我希望有人能帮帮忙。我试图设置一个从游戏开始计时的计时器并显示这个时间。问题是以下代码部分给了我错误的时间。它的格式错误，一小时后就出来了。

```
private long startTime;
private SimpleDateFormat timeFormat = new SimpleDateFormat("HH:mm:ss.SS");

//Constructor:
startTime = System.currentTimeMillis();

public String getTime() {
long gameTime = System.currentTimeMillis() - startTime;
final Date date = new Date(gameTime);
return timeFormat.format(date);
} 
```

它始终为我提供 01:00:03:203 的输出。秒数是正确的，但 1 小时不应该在那里，并且格式是 3 位小数，而不是我认为我指定的两位。

非常感谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:57:21.297

您的日期是纪元 + 游戏时间。我认为您正在经历夏令时，因为您所在位置的当前 DST 与时代的 DST 不匹配。

使用日历而不是日期。从今天开始，明确消除小时、分钟等部分：

```
Calendar cal = Calendar.getInstance();
cal.set(Calendar.HOUR_OF_DAY, 0);
cal.set(Calendar.MINUTE, 0);
cal.set(Calendar.SECOND, 0);
cal.set(Calendar.MILLISECOND, 3600000 + 60000 + 1000 + 1);

SimpleDateFormat timeFormat = new SimpleDateFormat("HH:mm:ss.SS");

System.out.println(timeFormat.format(cal.getTime())); 
```

上面的输出是：01:01:01.01

[http://ideone.com/DyQcl](http://ideone.com/DyQcl)

用我上面的数字代替`gameTime`你就完成了。

当然，一旦您的毫秒刻度超过日期边界，这可能不起作用。

# c++ - C++11 中的异步/期货数量

> ID：10301432
> 
> 赞同：12
> 
> 时间：2012-04-24T15:48:41.233
> 
> 标签：c++, c++11, future

我正在尝试一个程序：

```
#include <iostream>
#include <thread>
#include <future>

int foo() {
  return 0;
}

int main(int argc, char* argv[]) {
  for (auto i = 0L; i < 10000; ++i) {
    auto f = std::async(foo);
    f.get();
  }
  return 0;
} 
```

编译器 VS11 x64。

建造：

```
cl /EHsc /Zi async.cpp && async 
```

对我来说，这个程序崩溃了。我怀疑，同时运行的期货数量是有限的。如果我将迭代次数减少到几个订单，它就会起作用。

所以，两个问题：

1.  在 C++11 中实际运行期货是否有限制？

2.  为什么这段代码会崩溃？如果我在“async()”之后立即明确地执行“get()”，它必须在下一次迭代之前完成未来，这意味着一次只运行一个未来。

**更新**

我已将代码简化为：

```
#include <future>

int main(int argc, char* argv[]) {
  for (auto i = 0L; i < 1000000; ++i) {
    auto f = std::async([](){ return 0; });
    f.get();
  }
  return 0;
} 
```

它仍然对我崩溃。它不会抛出，我已经检查过了。但现在我有一个可见的堆栈跟踪：

```
async.exe!_Mtx_unlock(_Mtx_internal_imp_t * * mtx) Line 229  C++
async.exe!std::_Mtx_unlockX(_Mtx_internal_imp_t * * _Mtx) Line 84  C++
async.exe!std::_Mutex_base::unlock() Line 47  C++
async.exe!std::unique_lock<std::mutex>::~unique_lock<std::mutex>() Line 284  C++
async.exe!std::_Associated_state<int>::_Set_value(int && _Val, bool _At_thread_exit) Line 358  C++
async.exe!std::_Packaged_state<int __cdecl(void)>::_Call_immediate() Line 569  C++
async.exe!std::_Async_state<int>::`std::U_Nil::ain::ain'::`3'::<lambda_A200A86DFF9A63A1>::operator()() Line 700  C++
async.exe!??$_ApplyX@X@?$_Callable_obj@V<lambda_A200A86DFF9A63A1>@?2???$?0V?$_Bind@$0A@XV<lambda_23AC5A2FBB53FD4D>@?5?main@U_Nil@std@@U23@U23@U23@U23@U23@U23@@std@@@?$_Async_state@H@std@@QEAA@$$QEAV?$_Bind@$0A@XV<lambda_23AC5A2FBB53FD4D>@?5?main@U_Nil@std@@U23@U23@U23@U23@U23@U23@@3@@Z@$0A@@std@@QEAAXXZ() Line 420  C++
async.exe!?_Do_call@?$_Func_impl@U?$_Callable_obj@V<lambda_A200A86DFF9A63A1>@?2???$?0V?$_Bind@$0A@XV<lambda_23AC5A2FBB53FD4D>@?5?main@U_Nil@std@@U23@U23@U23@U23@U23@U23@@std@@@?$_Async_state@H@std@@QEAA@$$QEAV?$_Bind@$0A@XV<lambda_23AC5A2FBB53FD4D>@?5?main@U_Nil@std@@U23@U23@U23@U23@U23@U23@@3@@Z@$0A@@std@@V?$allocator@V?$_Func_class@XU_Nil@std@@U12@U12@U12@U12@U12@U12@@std@@@2@XU_Nil@2@U42@U42@U42@U42@U42@U42@@std@@UEAAXXZ() Line 217  C++
async.exe!std::_Func_class<void,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil>::operator()() Line 486  C++
async.exe!`Concurrency::details::_MakeVoidToUnitFunc'::`3'::<lambda_25D33530A43E1C90>::operator()() Line 1056  C++
async.exe!std::_Callable_obj<`Concurrency::details::_MakeVoidToUnitFunc'::`3'::<lambda_25D33530A43E1C90>,0>::_ApplyX<Concurrency::details::_Unit_type>() Line 420  C++
async.exe!std::_Func_impl<std::_Callable_obj<`Concurrency::details::_MakeVoidToUnitFunc'::`3'::<lambda_25D33530A43E1C90>,0>,std::allocator<std::_Func_class<Concurrency::details::_Unit_type,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil> >,Concurrency::details::_Unit_type,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil>::_Do_call() Line 217  C++
async.exe!std::_Func_class<Concurrency::details::_Unit_type,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil>::operator()() Line 486  C++
async.exe!`Concurrency::details::_Task_impl<Concurrency::details::_Unit_type>::_ScheduleTask'::`3'::<lambda_7D9BCD859405C05B>::operator()() Line 325  C++
async.exe!Concurrency::details::_PPLTaskHandle<`Concurrency::details::_Task_impl<Concurrency::details::_Unit_type>::_ScheduleTask'::`3'::<lambda_7D9BCD859405C05B> >::operator()() Line 72  C++
async.exe!Concurrency::details::_UnrealizedChore::_InvokeBridge<Concurrency::details::_PPLTaskHandle<`Concurrency::details::_Task_impl<Concurrency::details::_Unit_type>::_ScheduleTask'::`3'::<lambda_7D9BCD859405C05B> > >(Concurrency::details::_PPLTaskHandle<`Concurrency::details::_Task_impl<Concurrency::details::_Unit_type>::_ScheduleTask'::`3'::<lambda_7D9BCD859405C05B> > * _PChore) Line 4190  C++
async.exe!Concurrency::details::_UnrealizedChore::_UnstructuredChoreWrapper(Concurrency::details::_UnrealizedChore * pChore) Line 275  C++
async.exe!Concurrency::details::_PPLTaskChore::_DeletingChoreWrapper(Concurrency::details::_UnrealizedChore * pChore) Line 78  C++
async.exe!Concurrency::details::InternalContextBase::ExecuteChoreInline(Concurrency::details::WorkItem * pWork) Line 1600  C++
async.exe!Concurrency::details::InternalContextBase::Dispatch(Concurrency::DispatchState * pDispatchState) Line 1704  C++
async.exe!Concurrency::details::FreeThreadProxy::Dispatch() Line 191  C++
async.exe!Concurrency::details::ThreadProxy::ThreadProxyMain(void * lpParameter) Line 173  C++
kernel32.dll!0000000076df652d()  Unknown
ntdll.dll!0000000076f2c521()  Unknown 
```

和线程：

```
Unflagged       1864    0   Worker Thread   ntdll.dll thread    ntdll.dll!0000000076f518ca  Normal
Unflagged       10964   0   Main Thread Main Thread async.exe!do_signal Normal
Unflagged       7436    0   Worker Thread   ntdll.dll thread    ntdll.dll!0000000076f52c1a  Normal
Unflagged       10232   0   Worker Thread   async.exe!Concurrency::details::ThreadProxy::ThreadProxyMain    async.exe!Concurrency::details::ThreadProxy::SuspendExecution   Normal
Unflagged   >   10624   0   Worker Thread   async.exe!Concurrency::details::ThreadProxy::ThreadProxyMain    async.exe!_Mtx_unlock   Normal
Unflagged       4756    0   Worker Thread   async.exe!Concurrency::details::ThreadProxy::ThreadProxyMain    async.exe!Concurrency::details::ThreadProxy::SuspendExecution   Normal
Unflagged       11100   0   Worker Thread   async.exe!Concurrency::details::ThreadProxy::ThreadProxyMain    async.exe!Concurrency::details::InternalContextBase::WaitForWork    Normal
Unflagged       6440    0   Worker Thread   async.exe!Concurrency::details::ThreadProxy::ThreadProxyMain    async.exe!std::vector<std::pair<void (__cdecl*)(void * __ptr64),void * __ptr64>,std::allocator<std::pair<void (__cdecl*)(void * __ptr64),void * __ptr64> > >::_Tidy Normal 
```

我正在使用 VS 11.0.40825.2 PREREL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T18:16:33.820

1.  显然存在实现限制，就像数组的大小有限制一样。如果启动策略是 lauch::async 并且系统无法启动新线程，则 std::async 可以发出错误信号“resource_unavailable_try_again”。但是您没有收到此错误。

2.  该程序不应该崩溃，也不适合我（VS11 x64，发布版本，相同的源代码和命令行）。

    我相信即使没有`.get()`该程序，一次也不会有多个异步操作。您将未来分配给一个局部变量，未来在每次循环迭代时都会被销毁，从而强制异步操作​​在下一次循环迭代中开始另一个操作之前完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T07:38:35.967

1.  不，标准没有说关于线程支持库的限制（包括线程、未来等）。

2.  这取决于线程支持库和底层 API 的实现质量。正如您所说`f.get()`，等待任务编译（此行为需要 C++ 标准）。当库实现可能无法重用底层 API 的线程句柄等资源时，可能会导致系统资源不足和程序崩溃。这是图书馆实施的质量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T15:28:22.967

尝试使用 try-catch 将代码包含在 main() 中，并检查它是否引发 std::exception。这可能会给出提示。除此之外，VS 中的 C++11 仍处于测试阶段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-17T06:43:21.740

如果您将 g++ 与 std=c++11 选项一起使用，请确保您拥有最新版本并与 pthread 链接。

例如，在 CodingGround 上，您获得的默认编译（使用编译按钮）是：

```
g++ -std=c++11 -o main *.cpp 
```

它失败了**"what(): Unknown error -1"**。但是您可以手动将**-lpthread**添加到编译命令中：

```
g++ -std=c++11 -o main -lpthread *.cpp 
```

它会工作得很好。

# php - PHP - 根据星期几计算重复日期？

> ID：10301433
> 
> 赞同：0
> 
> 时间：2012-04-24T15:48:44.827
> 
> 标签：php, date, date-arithmetic

我试图弄清楚如何根据现有日期以特定时间间隔在特定日期重复某些任务。

例如，我有这个：

```
Date                              Task 
2011-01-12                   MJK-0083 
```

我想要：

1.  根据提供的日期（在本例中为星期三）确定星期几
2.  确定是每月的哪个星期三（在本例中为第二个星期三）
3.  计算 6 月的第 2 个星期三的日期作为该任务发生的下一个日期

我一直在看一些例子，虽然我可以做一些事情，但我似乎无法弄清楚如何做所有事情。例如，我将其用于第 1 步：

```
date('l', strtotime('2011-01-12')) 
```

但是当涉及到第 2 步和第 3 步时，我迷路了……有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T15:59:12.530

要找出该月的哪个星期三，您可以使用该月中的某天来执行此操作

```
(int)(day_of_month / 7) + (day_of_month % 7 == 0 ? 0 : 1) 
```

因此，对于 2012-01-12，您将获得：

```
(int)(12 / 7) + (12 % 7 == 0 ? 0 : 1) = 1 + 1 = 2 -> second Wednesday 
```

# linux - /etc/rc3.d 下的 perl + perl 脚本位置，结果不同

> ID：10301439
> 
> 赞同：0
> 
> 时间：2012-04-24T15:49:11.047
> 
> 标签：linux, perl, bash, ksh, sh

我需要关于以下方面的建议：

**选项1**

我从我的Linux机器的/var/tmp目录运行脚本/usr/local/bbp/api/bbpinstaller.pl，没有问题

**选项 2**

我在 /var/tmp 下创建新脚本 - script.pl

然后我创建从 /var/tmp/script.pl 到 /etc/rc3.d/S99script.pl 的链接（通过 ln -s ）

所以 S99script.pl 链接到 /var/tmp/script.pl

和 script.pl 执行 /usr/local/bbp/api/bbpinstaller.pl

```
 more /etc/rc3.d/script.pl 

 #!/bin/bash 

 /usr/local/bbp/api/bbpinstaller.pl

 .
 .
 . 
```

**我的问题**：

当脚本 bbpinstaller.pl 在从 /etc/rc3.d/S99script.pl 重新启动后运行时，我收到以下错误（ /usr/local/bbp/api/bbpinstaller.pl 从 S99script.pl 运行）

```
 Can't locate Term/ReadKey.pm in @INC (@INC      contains: /etc/bbp/shared /usr/perl5/5.8.4/lib/sun4-solaris-     64int /usr/perl5/5.8.4/lib /usr/perl5/site_perl/5.8.4/sun4-
    solaris-    64int /usr/perl5/site_perl/5.8.4 /usr/perl5/site_perl /usr/perl5/vendor_perl/5.8.4/sun4-    solaris-64int /usr/perl5/vendor_perl/5.8.4 /usr/perl5/vendor_perl
    . ) at /usr/local/bbp/api/bbpinstaller.pl line 25.
     BEGIN failed--compilation aborted at /usr/local/bbp/api/bbpinstaller.pl line 25. 
```

在 /usr/local/bbp/api/bbpinstaller.pl 脚本中，我有以下 perl 模块：

```
 #################################
 #       Modules imported
 #################################
 use Config;
 use Getopt::Long;
 use File::Find;
 use English;
 use Sys::Hostname;
 $File::Find::dont_use_nlink=1;
 use lib "/etc/bbp/shared";
 use Term::ReadKey qw(GetTerminalSize);
 use Cwd 'abs_path';
 require "bbp_globals.pl";
 require "bbp_functions.pl"; 
```

文件 ReadKey.pm 的路径

```
 /usr/local/lib/perl5/site_perl/5.8.7/sun4-solaris-thread-multi/Term/ReadKey.pm 
```

请帮我理解。这里有什么问题？？？（我没有 Perl 的分配经验）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T15:54:43.687

`/usr/local/`由本地安装使用（即它不是由操作系统供应商提供的）。然后你的 shell 设置为运行 ( `$PATH`) /usr/local/bin/perl (5.8.7) 而不是 /usr/local/bin/perl (5.8.4)。

但是，init 脚本不会使用您的 shell 设置运行 - 它们使用系统设置，而这些设置不会包含`/usr/local/bin`在其中 - 因此它们将使用操作系统提供的 perl -`/usr/bin/perl`它没有安装此库 ( `Term::ReadKey`)。

（.pl 扩展名通常用于 perl 程序 - 我将 .sh 用于 bash/shell 脚本）

当您直接运行脚本时（即，不首先在命令行上指定解释器），内核使用 hash-bang 行（第一行）来确定要执行哪个程序来解释脚本。

例如，您的 shell 脚本 /etc/rc3.d/script.pl 有一个“”的散列线`#!/bin/bash`，告诉它用`/bin/bash`.

`/usr/local/bbp/api/bbpinstaller.pl`开头会有一个 hash-bang 行，可能是这样的：`#!/usr/bin/env perl`

这告诉内核/外壳查看`PATH`变量以找到解释器；`perl`如果您在命令行上键入它，它会以同样的方式找到它。

为了解决您的问题，或者：

1.  将 Term/ReadKey 安装到系统 perl 中。
2.  按照 MichaelN 的建议在 shell 脚本中设置 PATH。
3.  正如 MichaelN 所建议的那样，调用显式 perl 而不是让内核决定。
4.  `/usr/local/bbp/api/bbpinstaller.pl`重新编码以不需要 Term/ ReadKey

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T18:41:42.620

默认情况下，操作系统 perl 是 /usr/bin/perl，它的所有模块都在 /usr/perl5/site_perl/5.8.4 /usr/perl5/site_perl 中。由于通过 rc3 运行脚本使用 root 的标准路径和标准库，它不会在 /usr/local/bin 中找到您的自定义 perl，因此不会在 /usr/local/lib 中找到您的站点库。所以你需要修改你的调用脚本“/etc/rc3.d/script.pl”，它是一个bash脚本（应该可能是调用script.sh，但那是语义）在路径中包含/usr/local/bin，即: 导出 PATH=/usr/local/bin:${PATH}。这会将 /usr/local/bin 预先附加到 PATH 的前面，然后将调用 /usr/local/bin 中的 perl 而不是 /usr/bin/perl。因此将 script.pl 更改为：

```
#!/bin/bash
导出 PATH=/usr/local/bin:${PATH}
/usr/local/bbp/api/bbpinstaller.pl

```

或者用你的 perl 调用你的脚本。

```
#!/bin/bash

/usr/local/bin/perl /usr/local/bbp/api/bbpinstaller.pl

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T18:08:44.370

为了提供您要求的修复，我完全关闭了 Douglas 在分析您的问题时所做的工作。

我会：

1.  在 RC shell 脚本中，设置您的 PATH 以运行正确版本的 perl，然后调用您的 Perl 脚本。
2.  更改 Perl 脚本中的“shebang”行以使用正确版本的 Perl。

希望其中之一有帮助！

# node.js - nodejs 通过 inode 打开 nfs 文件（或重新打开文件的最快方式）

> ID：10301442
> 
> 赞同：2
> 
> 时间：2012-04-24T15:49:33.670
> 
> 标签：node.js, nfs

我目前正在编写一个缓存系统，它将在磁盘和内存中保存序列化（json）数据，以减少数据库上的 I/O 负载。

系统将通过在内存中保存最后 X 个访问的文件并从磁盘读取其他文件来工作。

我已经读到有一些系统可以通过 inode 打开文件来减少 nfs（我将来可能会使用）系统上的 I/O 负载。

我的问题是：

1.  有没有办法通过nodejs中的inode打开nfs文件系统上的文件？如果没有，我需要做哪些功课才能做到这一点？
    ~~2、用inode打开本地文件系统上的文件是绝对不可能的吗？~~
    ~~3\. 如果实际上不可能，是否有更快的方法来重新打开文件，因为让操作系统一遍又一遍地统计文件似乎不必要地重复？~~

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T23:49:17.773

1.  不，没有用户可访问的方式通过 inode 打开文件，因为这样做在某些情况下会允许用户绕过文件系统 ACL。

2.  是的。同样的原因。

3.  大多数有能力的 NFS 客户端，包括 Linux 内核，都会在本地缓存统计结果。

# oracle - PL SQL Oracle 中的零迭代计数

> ID：10301443
> 
> 赞同：-1
> 
> 时间：2012-04-24T15:49:44.497
> 
> 标签：oracle, plsql, oraclereports

我正在编写一个查询，该查询应该基于 IF 语句执行不同的选择语句。之前没有在 Oracle 中做过任何 IF，我不确定出了什么问题，但我得到了错误，零迭代计数，它指向第一行代码。我包含了代码，它很多，但你真的只需要注意 IF。

```
IF :p_sales_type = 'all_cancel' THEN

  SELECT 
   TO_DATE(SUBSTR(Transaction_Date,1,10), 'MM/DD/YYYY'),Item_Number, 
    REGEXP_REPLACE(SUBSTR(Item_Or_Adj_Description,1,50),'([^[:print:]])',' ') AS Item_Or_Adj_Desctription, 
    Customer_Type, Document_ID, Dealer_ID, Sales_Type, Item_Quantity, Total_Fee, State_Fee, Transaction_Fee, AO_Fee, WDFW_Fee 
  FROM 
  ( 
    -- Sales Transactions 
   SELECT /*+ index(IT ITEM_X4) */ 
      TO_CHAR(IT.it_status_set_date - 2/24, 'MM/DD/YYYY HH24:MI:SS') AS Transaction_Date,  -- Pacific Time
      TO_NUMBER(IT.ic_rcn) AS Item_Number, IT.it_descr AS Item_Or_Adj_Description, 
      DT.di_name AS Customer_Type, IT.it_docid AS Document_ID, IT.ag_id AS Dealer_ID, 
      CASE WHEN UPPER(IST.is_name) = 'ACTIVE' THEN 'SALE' ELSE IST.is_name END AS Sales_Type, 
      NVL(IT.it_quantity * CASE WHEN IT.is_id = 'AC' THEN 1 WHEN IT.is_id = 'DU' THEN 1 ELSE -1 END, 0) AS Item_Quantity,  -- Dups = 1
      NVL(IT.it_state_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END, 0.00) + 
    NVL(IT.it_other_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END, 0.00) AS Total_Fee, 
      NVL(IT.it_state_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END, 0.00) AS State_Fee, 
      NVL(IT.it_other_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END, 0.00) AS Transaction_Fee, 
      CASE WHEN IT.it_other_fee IS NULL OR IT.it_other_fee = 0.00 THEN 0.00 
        ELSE ROUND(IT.it_state_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END * (:p_ao_trx_fee / 100), 2) 
      END AS AO_Fee, 
      CASE WHEN IT.it_other_fee IS NULL OR IT.it_other_fee = 0.00 THEN 0.00 
        ELSE (IT.it_other_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END) - 
          ROUND((IT.it_state_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END * (:p_ao_trx_fee / 100)), 2) 
      END AS WDFW_Fee 
   FROM ITEM IT 
   JOIN DISCOUNT_TYPE DT ON DT.di_id = IT.di_id 
   JOIN ITEM_STATUS_TYPE IST ON IST.is_id = IT.is_id 
   WHERE IT.it_status_ind = 'A' -- Include active ITEM rows only. 
   AND (IT.is_id IN ('AC','DC','SC') OR (IT.is_id = 'DU' AND NVL(IT.it_state_fee, 0) != 0)) -- Exclude voids, exchanges, and false duplicates.
   AND IT.ic_rcn != '999' -- Exclude Dealer Fees. 
   AND IT.it_status_set_date BETWEEN :P_beg_dt  -- Pacific Time
                 AND :P_end_dt
    AND (:p_discount_type IS NULL OR DT.di_id = :p_discount_type)
  -- AND IST.is_name = :SalesType
   UNION ALL

   -- Item Adjustments
   SELECT 
      TO_CHAR(AJ.aj_adjustment_date - 2/24, 'MM/DD/YYYY HH24:MI:SS') AS Transaction_Date,  -- Pacific Time
      TO_NUMBER(IT.ic_rcn) AS Item_Number, AJ.aj_comment AS Item_Or_Adj_Description, 
      DT.di_name AS Customer_Type, IT.it_docid AS Document_ID, AJ.ag_id AS Dealer_ID, 
      AJ.ajt_adjustment_type_name AS Sales_Type, 
      0 AS Item_Quantity, 
      NVL(AJ.aj_state_adj_amt, 0.00) + NVL(AJ.aj_other_adj_amt, 0.00) AS Total_Fee, 
      NVL(AJ.aj_state_adj_amt, 0.00) AS State_Fee, 
      NVL(AJ.aj_other_adj_amt, 0.00) AS Transaction_Fee, 
      CASE WHEN AJ.aj_other_adj_amt IS NULL OR AJ.aj_other_adj_amt = 0.00 THEN 0.00 
    ELSE ROUND(NVL(AJ.aj_state_adj_amt, 0.00) * (:p_ao_trx_fee / 100), 2) END AS AO_Fee, 
      CASE WHEN AJ.aj_other_adj_amt IS NULL OR AJ.aj_other_adj_amt = 0.00 THEN 0.00 
    ELSE AJ.aj_other_adj_amt - ROUND(NVL(AJ.aj_state_adj_amt, 0.00) * (:p_ao_trx_fee / 100), 2) END AS WDFW_Fee 
   FROM ADJUSTMENT AJ 
   JOIN ITEM IT ON IT.it_id = AJ.it_id 
   JOIN DISCOUNT_TYPE DT ON DT.di_id = IT.di_id 
   WHERE AJ.aj_status_ind = 'A' -- Include active adjustments only. 
   AND AJ.it_id IS NOT NULL -- Include Item Adjustments only; rows with a foreign key to the ITEM table are Item Adjustments. 
   AND AJ.ajt_id != '0' -- Unreturned Doc Charge is not an Item Adjustment, it's a Lump Sum Adjustment to the Dealers account. 
   AND IT.ic_rcn != '999' -- Exclude Dealer Fees. 
   AND AJ.aj_adjustment_date BETWEEN :P_beg_dt  -- Pacific Time
                 AND :P_end_dt
    AND (:p_discount_type IS NULL OR DT.di_id = :p_discount_type)
   --AND AJ.Ajt_Adjustment_Type_Name = :SalesType
  ) ReportDetails 

  WHERE-- Sales_Type = :SalesType
                 (:p_ic_rcn is null OR :p_ic_rcn = Item_Number)
                 AND (:p_dealer_id IS NULL OR Dealer_ID = :p_dealer_id)
                 AND Sales_Type in ('DEALER CANCEL', 'STATE CANCEL')

  ORDER BY TO_DATE(SUBSTR(Transaction_Date,1,10), 'MM/DD/YYYY'), Item_Number,  -- Transaction Date, RCN (numerical order), order RCN was purchased. 
       TO_CHAR(TO_DATE(Transaction_Date, 'MM/DD/YYYY HH24:MI:SS'), 'SSSSS');

  ELSE IF :p_sales_type = 'item_adjustment' THEN

   -- Item Adjustments
   SELECT 
      TO_CHAR(AJ.aj_adjustment_date - 2/24, 'MM/DD/YYYY HH24:MI:SS') AS Transaction_Date,  -- Pacific Time
      TO_NUMBER(IT.ic_rcn) AS Item_Number, AJ.aj_comment AS Item_Or_Adj_Description, 
      DT.di_name AS Customer_Type, IT.it_docid AS Document_ID, AJ.ag_id AS Dealer_ID, 
      AJ.ajt_adjustment_type_name AS Sales_Type, 
      0 AS Item_Quantity, 
      NVL(AJ.aj_state_adj_amt, 0.00) + NVL(AJ.aj_other_adj_amt, 0.00) AS Total_Fee, 
      NVL(AJ.aj_state_adj_amt, 0.00) AS State_Fee, 
      NVL(AJ.aj_other_adj_amt, 0.00) AS Transaction_Fee, 
      CASE WHEN AJ.aj_other_adj_amt IS NULL OR AJ.aj_other_adj_amt = 0.00 THEN 0.00 
    ELSE ROUND(NVL(AJ.aj_state_adj_amt, 0.00) * (:p_ao_trx_fee / 100), 2) END AS AO_Fee, 
      CASE WHEN AJ.aj_other_adj_amt IS NULL OR AJ.aj_other_adj_amt = 0.00 THEN 0.00 
    ELSE AJ.aj_other_adj_amt - ROUND(NVL(AJ.aj_state_adj_amt, 0.00) * (:p_ao_trx_fee / 100), 2) END AS WDFW_Fee 
   FROM ADJUSTMENT AJ 
   JOIN ITEM IT ON IT.it_id = AJ.it_id 
   JOIN DISCOUNT_TYPE DT ON DT.di_id = IT.di_id 
   WHERE AJ.aj_status_ind = 'A' -- Include active adjustments only. 
   AND AJ.it_id IS NOT NULL -- Include Item Adjustments only; rows with a foreign key to the ITEM table are Item Adjustments. 
   AND AJ.ajt_id != '0' -- Unreturned Doc Charge is not an Item Adjustment, it's a Lump Sum Adjustment to the Dealers account. 
   AND IT.ic_rcn != '999' -- Exclude Dealer Fees. 
   AND AJ.aj_adjustment_date BETWEEN :P_beg_dt  -- Pacific Time
                 AND :P_end_dt
    AND (:p_discount_type IS NULL OR DT.di_id = :p_discount_type)
    WHERE-- Sales_Type = :SalesType
                 (:p_ic_rcn is null OR :p_ic_rcn = Item_Number)
                 AND (:p_dealer_id IS NULL OR Dealer_ID = :p_dealer_id)
                 AND Sales_Type = 'ADJUSTMENT'

    ORDER BY TO_DATE(SUBSTR(Transaction_Date,1,10), 'MM/DD/YYYY'), Item_Number,  -- Transaction Date, RCN (numerical order), order RCN was purchased. 
       TO_CHAR(TO_DATE(Transaction_Date, 'MM/DD/YYYY HH24:MI:SS'), 'SSSSS');

  ELSE IF :p_sales_type IS NULL 

  SELECT 
   TO_DATE(SUBSTR(Transaction_Date,1,10), 'MM/DD/YYYY'),Item_Number, 
    REGEXP_REPLACE(SUBSTR(Item_Or_Adj_Description,1,50),'([^[:print:]])',' ') AS Item_Or_Adj_Desctription, 
    Customer_Type, Document_ID, Dealer_ID, Sales_Type, Item_Quantity, Total_Fee, State_Fee, Transaction_Fee, AO_Fee, WDFW_Fee 
  FROM 
  ( 
    -- Sales Transactions 
   SELECT /*+ index(IT ITEM_X4) */ 
      TO_CHAR(IT.it_status_set_date - 2/24, 'MM/DD/YYYY HH24:MI:SS') AS Transaction_Date,  -- Pacific Time
      TO_NUMBER(IT.ic_rcn) AS Item_Number, IT.it_descr AS Item_Or_Adj_Description, 
      DT.di_name AS Customer_Type, IT.it_docid AS Document_ID, IT.ag_id AS Dealer_ID, 
      CASE WHEN UPPER(IST.is_name) = 'ACTIVE' THEN 'SALE' ELSE IST.is_name END AS Sales_Type, 
      NVL(IT.it_quantity * CASE WHEN IT.is_id = 'AC' THEN 1 WHEN IT.is_id = 'DU' THEN 1 ELSE -1 END, 0) AS Item_Quantity,  -- Dups = 1
      NVL(IT.it_state_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END, 0.00) + 
    NVL(IT.it_other_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END, 0.00) AS Total_Fee, 
      NVL(IT.it_state_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END, 0.00) AS State_Fee, 
      NVL(IT.it_other_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END, 0.00) AS Transaction_Fee, 
      CASE WHEN IT.it_other_fee IS NULL OR IT.it_other_fee = 0.00 THEN 0.00 
        ELSE ROUND(IT.it_state_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END * (:p_ao_trx_fee / 100), 2) 
      END AS AO_Fee, 
      CASE WHEN IT.it_other_fee IS NULL OR IT.it_other_fee = 0.00 THEN 0.00 
        ELSE (IT.it_other_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END) - 
          ROUND((IT.it_state_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END * (:p_ao_trx_fee / 100)), 2) 
      END AS WDFW_Fee 
   FROM ITEM IT 
   JOIN DISCOUNT_TYPE DT ON DT.di_id = IT.di_id 
   JOIN ITEM_STATUS_TYPE IST ON IST.is_id = IT.is_id 
   WHERE IT.it_status_ind = 'A' -- Include active ITEM rows only. 
   AND (IT.is_id IN ('AC','DC','SC') OR (IT.is_id = 'DU' AND NVL(IT.it_state_fee, 0) != 0)) -- Exclude voids, exchanges, and false duplicates.
   AND IT.ic_rcn != '999' -- Exclude Dealer Fees. 
   AND IT.it_status_set_date BETWEEN :P_beg_dt  -- Pacific Time
                 AND :P_end_dt
    AND (:p_discount_type IS NULL OR DT.di_id = :p_discount_type)
  -- AND IST.is_name = :SalesType
   UNION ALL

   -- Item Adjustments
   SELECT 
      TO_CHAR(AJ.aj_adjustment_date - 2/24, 'MM/DD/YYYY HH24:MI:SS') AS Transaction_Date,  -- Pacific Time
      TO_NUMBER(IT.ic_rcn) AS Item_Number, AJ.aj_comment AS Item_Or_Adj_Description, 
      DT.di_name AS Customer_Type, IT.it_docid AS Document_ID, AJ.ag_id AS Dealer_ID, 
      AJ.ajt_adjustment_type_name AS Sales_Type, 
      0 AS Item_Quantity, 
      NVL(AJ.aj_state_adj_amt, 0.00) + NVL(AJ.aj_other_adj_amt, 0.00) AS Total_Fee, 
      NVL(AJ.aj_state_adj_amt, 0.00) AS State_Fee, 
      NVL(AJ.aj_other_adj_amt, 0.00) AS Transaction_Fee, 
      CASE WHEN AJ.aj_other_adj_amt IS NULL OR AJ.aj_other_adj_amt = 0.00 THEN 0.00 
    ELSE ROUND(NVL(AJ.aj_state_adj_amt, 0.00) * (:p_ao_trx_fee / 100), 2) END AS AO_Fee, 
      CASE WHEN AJ.aj_other_adj_amt IS NULL OR AJ.aj_other_adj_amt = 0.00 THEN 0.00 
    ELSE AJ.aj_other_adj_amt - ROUND(NVL(AJ.aj_state_adj_amt, 0.00) * (:p_ao_trx_fee / 100), 2) END AS WDFW_Fee 
   FROM ADJUSTMENT AJ 
   JOIN ITEM IT ON IT.it_id = AJ.it_id 
   JOIN DISCOUNT_TYPE DT ON DT.di_id = IT.di_id 
   WHERE AJ.aj_status_ind = 'A' -- Include active adjustments only. 
   AND AJ.it_id IS NOT NULL -- Include Item Adjustments only; rows with a foreign key to the ITEM table are Item Adjustments. 
   AND AJ.ajt_id != '0' -- Unreturned Doc Charge is not an Item Adjustment, it's a Lump Sum Adjustment to the Dealers account. 
   AND IT.ic_rcn != '999' -- Exclude Dealer Fees. 
   AND AJ.aj_adjustment_date BETWEEN :P_beg_dt  -- Pacific Time
                 AND :P_end_dt
    AND (:p_discount_type IS NULL OR DT.di_id = :p_discount_type)
   --AND AJ.Ajt_Adjustment_Type_Name = :SalesType
  ) ReportDetails 

  WHERE         (:p_ic_rcn is null OR :p_ic_rcn = Item_Number)
                 AND (:p_dealer_id IS NULL OR Dealer_ID = :p_dealer_id)

  ORDER BY TO_DATE(SUBSTR(Transaction_Date,1,10), 'MM/DD/YYYY'), Item_Number,  -- Transaction Date, RCN (numerical order), order RCN was purchased. 
       TO_CHAR(TO_DATE(Transaction_Date, 'MM/DD/YYYY HH24:MI:SS'), 'SSSSS');

ELSE

  SELECT 
   TO_DATE(SUBSTR(Transaction_Date,1,10), 'MM/DD/YYYY'),Item_Number, 
    REGEXP_REPLACE(SUBSTR(Item_Or_Adj_Description,1,50),'([^[:print:]])',' ') AS Item_Or_Adj_Desctription, 
    Customer_Type, Document_ID, Dealer_ID, Sales_Type, Item_Quantity, Total_Fee, State_Fee, Transaction_Fee, AO_Fee, WDFW_Fee 
  FROM 
  ( 
    -- Sales Transactions 
   SELECT /*+ index(IT ITEM_X4) */ 
      TO_CHAR(IT.it_status_set_date - 2/24, 'MM/DD/YYYY HH24:MI:SS') AS Transaction_Date,  -- Pacific Time
      TO_NUMBER(IT.ic_rcn) AS Item_Number, IT.it_descr AS Item_Or_Adj_Description, 
      DT.di_name AS Customer_Type, IT.it_docid AS Document_ID, IT.ag_id AS Dealer_ID, 
      CASE WHEN UPPER(IST.is_name) = 'ACTIVE' THEN 'SALE' ELSE IST.is_name END AS Sales_Type, 
      NVL(IT.it_quantity * CASE WHEN IT.is_id = 'AC' THEN 1 WHEN IT.is_id = 'DU' THEN 1 ELSE -1 END, 0) AS Item_Quantity,  -- Dups = 1
      NVL(IT.it_state_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END, 0.00) + 
    NVL(IT.it_other_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END, 0.00) AS Total_Fee, 
      NVL(IT.it_state_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END, 0.00) AS State_Fee, 
      NVL(IT.it_other_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END, 0.00) AS Transaction_Fee, 
      CASE WHEN IT.it_other_fee IS NULL OR IT.it_other_fee = 0.00 THEN 0.00 
        ELSE ROUND(IT.it_state_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END * (:p_ao_trx_fee / 100), 2) 
      END AS AO_Fee, 
      CASE WHEN IT.it_other_fee IS NULL OR IT.it_other_fee = 0.00 THEN 0.00 
        ELSE (IT.it_other_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END) - 
          ROUND((IT.it_state_fee * CASE WHEN IT.is_id IN ('DC','SC') THEN -1.00 ELSE 1.00 END * (:p_ao_trx_fee / 100)), 2) 
      END AS WDFW_Fee 
   FROM ITEM IT 
   JOIN DISCOUNT_TYPE DT ON DT.di_id = IT.di_id 
   JOIN ITEM_STATUS_TYPE IST ON IST.is_id = IT.is_id 
   WHERE IT.it_status_ind = 'A' -- Include active ITEM rows only. 
   AND (IT.is_id IN ('AC','DC','SC') OR (IT.is_id = 'DU' AND NVL(IT.it_state_fee, 0) != 0)) -- Exclude voids, exchanges, and false duplicates.
   AND IT.ic_rcn != '999' -- Exclude Dealer Fees. 
   AND IT.it_status_set_date BETWEEN :P_beg_dt  -- Pacific Time
                 AND :P_end_dt
    AND (:p_discount_type IS NULL OR DT.di_id = :p_discount_type)
  -- AND IST.is_name = :SalesType
   UNION ALL

   -- Item Adjustments
   SELECT 
      TO_CHAR(AJ.aj_adjustment_date - 2/24, 'MM/DD/YYYY HH24:MI:SS') AS Transaction_Date,  -- Pacific Time
      TO_NUMBER(IT.ic_rcn) AS Item_Number, AJ.aj_comment AS Item_Or_Adj_Description, 
      DT.di_name AS Customer_Type, IT.it_docid AS Document_ID, AJ.ag_id AS Dealer_ID, 
      AJ.ajt_adjustment_type_name AS Sales_Type, 
      0 AS Item_Quantity, 
      NVL(AJ.aj_state_adj_amt, 0.00) + NVL(AJ.aj_other_adj_amt, 0.00) AS Total_Fee, 
      NVL(AJ.aj_state_adj_amt, 0.00) AS State_Fee, 
      NVL(AJ.aj_other_adj_amt, 0.00) AS Transaction_Fee, 
      CASE WHEN AJ.aj_other_adj_amt IS NULL OR AJ.aj_other_adj_amt = 0.00 THEN 0.00 
    ELSE ROUND(NVL(AJ.aj_state_adj_amt, 0.00) * (:p_ao_trx_fee / 100), 2) END AS AO_Fee, 
      CASE WHEN AJ.aj_other_adj_amt IS NULL OR AJ.aj_other_adj_amt = 0.00 THEN 0.00 
    ELSE AJ.aj_other_adj_amt - ROUND(NVL(AJ.aj_state_adj_amt, 0.00) * (:p_ao_trx_fee / 100), 2) END AS WDFW_Fee 
   FROM ADJUSTMENT AJ 
   JOIN ITEM IT ON IT.it_id = AJ.it_id 
   JOIN DISCOUNT_TYPE DT ON DT.di_id = IT.di_id 
   WHERE AJ.aj_status_ind = 'A' -- Include active adjustments only. 
   AND AJ.it_id IS NOT NULL -- Include Item Adjustments only; rows with a foreign key to the ITEM table are Item Adjustments. 
   AND AJ.ajt_id != '0' -- Unreturned Doc Charge is not an Item Adjustment, it's a Lump Sum Adjustment to the Dealers account. 
   AND IT.ic_rcn != '999' -- Exclude Dealer Fees. 
   AND AJ.aj_adjustment_date BETWEEN :P_beg_dt  -- Pacific Time
                 AND :P_end_dt
    AND (:p_discount_type IS NULL OR DT.di_id = :p_discount_type)
   --AND AJ.Ajt_Adjustment_Type_Name = :SalesType
  ) ReportDetails 

  WHERE        Sales_Type = :p_sales_type
                AND (:p_ic_rcn is null OR :p_ic_rcn = Item_Number)
                 AND (:p_dealer_id IS NULL OR Dealer_ID = :p_dealer_id)

  ORDER BY TO_DATE(SUBSTR(Transaction_Date,1,10), 'MM/DD/YYYY'), Item_Number,  -- Transaction Date, RCN (numerical order), order RCN was purchased. 
       TO_CHAR(TO_DATE(Transaction_Date, 'MM/DD/YYYY HH24:MI:SS'), 'SSSSS');

  END IF; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:01:36.913

我不确定您所说的“零迭代计数”是什么意思，但您需要一个`INTO`子句来选择并使用您的结果，`ELSIF`而不是`ELSE IF`：

```
IF :p_sales_type = 'all_cancel' 
THEN
   SELECT col_list
     INTO variable_list
     FROM tables
    WHERE <where_clause>;
ELSIF :p_sales_type = 'item_adjustment' 
THEN 
   SELECT col_list
     INTO variable_list
     FROM tables
    WHERE <where_clause>;
ELSIF :p_sales_type IS NULL  
THEN
   SELECT col_list
     INTO variable_list
     FROM tables
    WHERE <where_clause>;
ELSE
   SELECT col_list
     INTO variable_list
     FROM tables
    WHERE <where_clause>;
END IF; 
```

您的`p_sales_type`变量/参数前面有一个虚假的冒号。最后，可能值得`p_sales_type`用`UPPER`as in包装`UPPER(p_sales_type) = 'ALL_CANCEL'`以确保您没有任何无意的不匹配（当然，除非您确定值的大小写）。

希望能帮助到你...

# c++ - 如何检索添加到由其超类对象组成的集合中的派生对象？

> ID：10301444
> 
> 赞同：1
> 
> 时间：2012-04-24T15:49:45.057
> 
> 标签：c++, inheritance, map, type-conversion

我现在正在处理这种情况，其中我有一个由多个字段组成的消息对象，所以我有一个地图，我在其中加载了 Field 类的对象：

```
std::map<int,Field*> myMsg; 
```

但是在我的协议中，字段可以将序列作为一种类型，因此我创建了一个从 Field 类继承的 FieldSequence 类，然后将其添加到我的消息中，我这样做了：

```
FieldSequence* seqFld=new FieldSequence(sequence);
myMsg[seqFld->id]=seqFld; 
```

但后来我需要以原始序列格式检索我的字段，我确定它的 id 属性我将其设置为 0 值。所以我这样做了：

```
std::map<int,Field*>::iterator it;
for ( it=myMsg.begin() ; it != myMsg.end(); it++ )
{

    cout << "field id => " << (*it).first <<  endl;
    int idprm=((*it).second)->id;
    if(idprm==0)
    {
        FieldSequence* temp=(*it).second;
    }
} 
```

但是由于这种转换，我有错误，所以我可以做些什么来检索我的原始格式，或者一旦我将它添加到我的地图中，因为它是超类格式，它会永远消失吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T15:55:42.597

您可以使用`dynamic_cast`并检查结果：

```
FieldSequence* temp = dynamic_cast<FieldSequence*>(it->second);
if (temp) { 
  // do stuff
} 
```

但通常这表明您应该重新考虑设计。如果您有许多派生类型并且需要全部检查它们，则它不能很好地扩展。当所有派生类型都实现相同的接口并且没有其他方法时，指向基类的指针容器最强大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T17:48:49.060

这是很常见的问题。实际问题不是从 Field* 指针中“获取派生类”。真正的问题是您的 Field 类的接口不能正确地表示它所有派生类的行为。一种选择是：

```
class Field {
public:
     virtual std::string ContentsAsString() const=0;
}; 
```

另一个是这样的：

```
class Field {
public:
    virtual char *Buffer() const=0;
    virtual int BufferSize() const=0;
}; 
```

# git - 使用 git 以非交互方式编辑旧提交

> ID：10301446
> 
> 赞同：3
> 
> 时间：2012-04-24T15:49:48.227
> 
> 标签：git, scripting, rebase

我知道如何手动编辑旧提交：

```
$ git log --pretty=format:'%h %s'
    60e5ed9 Second commit
    0fbc8ed First commit
$ git rebase --interactive 0fbc8ed # Going back to 'First commit'
    # * $EDITOR gets fired up *
    # change 'pick 0fbc8ed' to 'edit 0fbc8ed'
$ echo 'Hello Kitteh!' > some_file
$ git add some_file
$ git commit --amend -m 'some message'
$ git rebase --continue # Go back 
```

这里的问题：

`git rebase --interactive`启动一个编辑器，这对于脚本目的来说有点糟糕。有没有办法克服这个问题，即直接传递`edit 0fbc8ed`给`git rebase`命令？

我正在尝试这样做是愚蠢的，还是可能有更清晰，替代的方法来做到这一点？

有一个类似的问题，但就我而言，我想更改`pick`为`edit`：

[如何自动接受 git rebase --interactive 呈现给我的内容？](https://stackoverflow.com/questions/3548693/how-can-i-automatically-accept-what-git-rebase-interactive-presents-to-me)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:01:14.633

这是“git filter-branch”和选项“--commit-filter”的工作。看看手册页这里存在一个示例部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T16:07:05.137

你可以在没有交互式变基的情况下做同样的事情：

```
git branch some_temporary_name # to save your initial place
git reset --hard commit_you_want_to_change
...edit...
git commit --amend -m 'some message'
git rebase your_initial_branch_name some_temporary_name
git checkout your_initial_branch_name
git merge some_temporary_name # This will be a ff since you rebased
git branch -d some_temporary_name # remove unneeded branch 
```

# php - 如何转换数组中的字符串尊重空格

> ID：10301447
> 
> 赞同：0
> 
> 时间：2012-04-24T15:49:48.310
> 
> 标签：php

我有一个这样的字符串：

```
$contenuto = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut lobortis condimentum commodo. Duis dui dui, rutrum et lacinia sit amet, lacinia in nulla."; 
```

我需要将它分解为一个限制为 20 个字符的子字符串数组，如下所示：

```
Array
(
    [0] => "Lorem ipsum dolor ";
    [1] => "sit amet, ";
    [2] => "consectetur ";
    [3] => "adipiscing elit. Ut ";
    [4] => "lobortis condimentum";
    [5] => "commodo. Duis dui ";
    [6] => "dui, rutrum et ";
    [7] => "lacinia sit amet, ";
    [8] => "lacinia in nulla.";
) 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T15:52:27.443

```
$string_parsed = wordwrap($contenuto,20,"|",false);
$array = explode("|",$string_parsed); 
```

`wordwrap`函数允许我们以给定的字符数将长文本换成行（在本例中为 20），您可以自己指定 break char（我给出了“|”用于拆分），最后一个值“false”是含义如果达到字符限制，它不应该破坏单词。

# java - 导入 Dropbox 并让它运行时遇到问题？

> ID：10301452
> 
> 赞同：0
> 
> 时间：2012-04-24T15:50:03.297
> 
> 标签：java, android

我从 Dropbox 网站下载了 Dropbox sdk zip，然后将程序导入 eclispe。然后我配置了构建路径并添加了要运行的 2.2 jar 文件，直到我加载应用程序之前没有错误，当我在 1.5 模拟器上运行它时，它给了我一个未捕获的处理程序：线程主因未捕获的异常错误而退出，然后当我在 2.2 模拟器上运行它时，它给了我一个 at android.app.Instrumentation.newActivity(Instrumentation.java:1021) 错误，它甚至不让 ap 运行，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:35:45.257

当库在运行时未正确加载时，似乎会出现该问题。我对此了解不多，但这个问题之前被问过并回答过。这可能会有所帮助：[ADT 和 SDK 工具更新到 v17 后的 Gson NoClassDefFoundError](https://stackoverflow.com/questions/9820675/gson-noclassdeffounderror-after-adt-and-sdk-tools-update-to-v17)

你也可以试试这个：[http ://android.foxykeep.com/dev/how-to-fix-the-classdefnotfounderror-with-adt-17](http://android.foxykeep.com/dev/how-to-fix-the-classdefnotfounderror-with-adt-17)

# assembly - 在旧版 PC BIOS MBR 引导加载程序的程序集中使用“org xxxx”有什么用？

> ID：10301467
> 
> 赞同：4
> 
> 时间：2012-04-24T15:51:06.920
> 
> 标签：assembly, nasm, x86-16, bootloader, boot

最近我在学习如何编写引导扇区，这是我正在学习的完整代码：

```
org 07c00h
    mov ax, cs
    mov ds, ax
    mov es, ax
    call DispStr
    jmp $

DispStr:
    mov ax, BootMessage
    mov bp, ax
    mov cx, 16
    mov ax, 01301h
    mov bx, 000ch
    mov dl, 0
    int 10h
    ret

BootMessage: db "Hello, OS!"
times 510-($-$$) db 0

dw 0xaa55 
```

如果您知道如何引导系统，则代码非常简单。结果是`Hello OS!`屏幕上显示的一行，我唯一不知道的是第一行：`org 07c00h`。

书上告诉我这行代码让编译器定位到7c00h这个地方的地址，但是解释的很模糊，真不知道这里有什么用。这条线到底在`org 07c00h`做什么？

我试图删除该行，并使用 nasm 创建一个`bin`文件，然后使用 bochs 启动 bin 文件。与上一个没有什么不同：“hello OS！” 也显示在屏幕上。

我可以说第一行在这里什么都不做吗？有什么用`org xxxx`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-17T22:15:24.927

汇编程序将源代码的每一行转换为处理器指令，并按顺序将这些指令一个接一个地生成到输出二进制文件中。这样做，它维护一个内部计数器，该计数器从 0 开始计数任何此类指令的当前地址。

如果您正在组装一个普通程序，这些指令将最终出现在某个目标文件的代码部分中，其中只有地址的空白槽，之后必须由链接器用正确的地址填充，所以这不是问题。

但是，当您组装一个没有任何节、重定位和其他格式的平面二进制文件时，只有原始机器指令，那么汇编器就没有关于您的标签指示在哪里以及代码和数据的地址是什么的信息。因此，例如，当您有一条指令时`mov si, someLabel`，汇编器只能计算该标签在二进制文件开头从 0 开始的偏移量。（即默认是`ORG 0`如果你不指定一个。）

如果它不是真的，并且您希望您的机器指令+内存中的数据从其他地址开始，例如`7C00`，那么您需要告诉汇编程序您的程序的起始地址是在源代码的开头`7C00`写入。`org 0x7C00`该指令告诉汇编器它应该启动其内部地址计数器 from`7C00`而不是 from `0`。结果是此类程序中使用的所有地址都将移动`7C00`. 汇编器只是简单地`7C00`将为每个标签计算的每个地址相加。效果就好像标签位于内存中的地址处，例如`7C48`( `7C00 + 48`) 而不仅仅是`0048`(`0000 + 48`)，无论它从二进制图像文件的开头偏移仅 48 个字节（在偏移处加载`7C00`后将给出正确的地址）。

这些“地址”，如果直接使用`jmp si`or `mov al, [si]`，是[逻辑寻址](https://stackoverflow.com/questions/4119504/what-are-the-segment-and-offset-in-real-mode-memory-addressing)`offset`的一部分，在实模式中，段部分左移 4 以获得偏移添加到的基数。（所以并[寻址相同的线性地址](https://stackoverflow.com/questions/16419624/calculate-logical-address-from-physical-address-x86)，。）该部分来自您放入相关段寄存器的任何内容，或者如果您没有将其设置为固定值，则 BIOS 留在那里的任何内容。`seg:off` `07C0:000``0000:7C00` `7C00``segment`

如果您的`cs`,`ds`和/或`es`段寄存器设置为匹配线性地址空间中加载 MBR 的位置（总是`7C00`），因此文件的第一个字节位于`es:0`例如，使用具有正确设置的段基的偏移量实际上将访问您的数据。 如果已设置`jmp si`，将跳转到该标签，您的代码所在的位置也是如此。即，如果引用您的 MBR 的第一个字节。 如果设置正确，将从它加载 2 个字节。`cs``cs:si``cs:org``mov ax, [si]``ds`

在您的情况下，`int 10h`/`ah=13h`使用`es:bp`，并且绝对寻址没有其他用途，只有相对跳转/调用，其编码不依赖于`org`. 出于某种原因，您`es`从`cs`引导加载程序的开头进行设置，而不是将其设置为固定值以匹配`org`您正在使用的值。这是一个错误；您的引导加载程序无法在使用 CS:IP = 跳转到 MBR 的 BIOS 上运行`07C0:0000`，只有那些使用`0000:7C00`匹配您的`org`. `mov ax,cs`用`xor ax,ax`;替换来解决这个问题 DS / ES是否与CS不同并不重要，这`ES: BootMessage-$$ + org`就是您的数据实际所在的位置。

* * *

### 线性地址与逻辑地址

至于你的另一个问题：`7C00`是引导加载程序的线性物理地址。您可以用不同的方式将此物理地址表示为逻辑地址（段：偏移），因为段重叠（下一个段`10`在前一个段之后开始 16 个字节（十六进制））。例如，您可以使用逻辑地址`0000:7C00`，这是最简单的配置：您使用`0`从 RAM 开头开始的段，并`7C00`从`0`. 或者，您可以使用逻辑地址`07C0:0000`，即`7C0`第 th 段。还记得段开始时彼此相隔 16 个字节吗？因此，您只需将其乘以`7C0`（`10`十进制`16`）即可得到`7C00` - 看？这是在您的十六进制地址中向右移动一个位置的问题！:-) 现在你只需添加你的偏移量，也就是`0`这次，所以它仍然是`7C00`物理的。在内存中开始`0`的段中的字节。`07C0``7C00`

当然，您也可以使用更复杂的地址，例如 ，`0234:58C0`这意味着该段开始于`2340`并且当您向其添加`58C0`偏移量时，您将`7C00`再次获得 :-) 但这样做可能会令人困惑。这完全取决于您需要什么配置。如果您想将`7C00`物理地址视为段的开始，只需使用段`07C0`，您的第一条指令将位于 offset `0`，因此您不需要放置`org`指令，或者您可以放置`org 0`​​ then。但是，如果您需要读取/写入`7C00`地址下方的一些数据（例如，查看 BIOS 数据或摆弄中断向量），则使用段`0`和偏移量`7C00`这意味着您的第一条指令（二进制文件中的第 0 个字节）将位于`7C00`内存中的物理地址；那么您必须`org 0x7C00`根据上述原因添加指令。

* * *

BIOS 将使用 CS:IP = 07C0:0000 或 0000:7C00 跳转到您的代码。并且在 DS/ES/SS:SP 中有未知值。您应该编写引导加载程序以使其工作，使用`xor ax,ax`/`mov ds,ax`将 DS 基数设置为零，如果您正在使用`org 0x7c00`.

请参阅 Michael Petch 的[引导加载程序开发的一般技巧，](https://stackoverflow.com/questions/32701854/boot-loader-doesnt-jump-to-kernel-code)了解有关编写健壮的引导加载程序的更多信息，以避免对 BIOS 留下的状态做出假设，除了所有 BIOS 必须正确地与主流软件一起工作的那些。（例如，在线性地址 0x00007c00 和 DL 中的驱动器号处加载您的 512 字节 MBR）。

几乎（？）所有 BIOS 都以 CS=0 或 CS=07C0 启动 MBR，而不是其他一些 seg:off 到达相同线性地址的方式。但是你绝对不应该假设其中一个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T17:26:37.523

在这里，您可以一步获得汇编器和链接器。org 告诉汇编器，它告诉链接器（在这些情况下通常是同一个程序）将后面的代码放在物理内存空间的哪个位置。当您使用 C 编译器或其他一些高级语言编译器时，您通常有单独的编译和链接步骤（尽管编译器经常在幕后为您调用链接器）。源代码被编译为与位置无关的目标文件，其中一些指令在链接步骤中等待未实现。链接器从描述内存空间的用户那里获取对象和链接描述文件或信息，然后从那里编码该内存空间的指令。

User786653 设置得很好，它告诉汇编程序它自己无法弄清楚这些指令将存在的内存空间/地址，以防需要在指令中进行位置相关编码。如果它是包含地址信息的二进制文件，例如 elf、srec、ihex 等，它也会在输出二进制文件中使用该信息。

# django - django (1.4) 密码中允许使用哪些字符？

> ID：10301469
> 
> 赞同：0
> 
> 时间：2012-04-24T15:51:08.200
> 
> 标签：django, passwords

我最近才开始使用 Django 1.4。我记得当我使用 1.3 时，有一个允许作为密码字符的字符列表。它包括通常的字母数字以及一些特殊字符，例如 $、%、_ 和 @。

有谁知道我可以在文档中的哪里找到允许的密码字符列表？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:16:25.080

您可能是指[username 允许的字符的限制](https://github.com/django/django/blob/master/django/contrib/auth/forms.py#L67)。输入密码没有限制。您可以使用一个字符，只要您可以在密码输入中输入。有一组用于制作随机密码[的字符，但这不是限制。](https://github.com/django/django/blob/master/django/contrib/auth/models.py#L172)

# php - 无法从我的帖子中获取 Facebook 评论到网站

> ID：10301471
> 
> 赞同：0
> 
> 时间：2012-04-24T15:51:19.100
> 
> 标签：php, facebook, facebook-graph-api, facebook-fql

我正在尝试在我的 PHP 网站上显示来自我的 Facebook 页面帖子的评论。我喜欢同步评论，所以用户在我页面的 Facebook 帖子上输入评论时，它会自动显示在我的网站上。我知道如何创建评论框，但它不会从页面中提取评论。

对于我的评论框：

```
<div class='fb-comments' data-href='https://www.facebook.com/media/set/?set=a.182291248558753.39531.182290545225490&type=1&l=d607ba4dcc' data-num-posts='3' data-width='470'></div> 
```

我试图显示留在我的帖子上的评论，但它并没有拉动它。我已经查看了图形 API，但无法弄清楚哪个在获取评论以及如何获取评论的所谓“主键”。

我看过以下fql：

1.  流：但我不知道“post_id”应该是什么。[https://developers.facebook.com/docs/reference/fql/stream/](https://developers.facebook.com/docs/reference/fql/stream/)

2.  评论：但我不知道专辑页面中的帖子的“post_id”、“object_id”或“xid”是什么。我什至尝试替换他们拥有的示例帖子中的 URL，但似乎 FB FQL 无法解析那种 URL。[https://developers.facebook.com/docs/reference/fql/comment/](https://developers.facebook.com/docs/reference/fql/comment/)

即使我们得到评论列表，我也不确定 fb:comments 插件如何使用流来填充我的页面，不知道是否可能！

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:06:04.110

您可以为此使用 Facebook PHP SDK，您可以从[github](https://github.com/facebook/php-sdk)获得。然后，您可以使用它从帖子中检索评论并将它们存储在数据库中，不时更新以保持最新状态。这将意味着对 Facebook 的请求减少。当用户使用您的表单在您的网站上发帖时，您可以使用 SDK 将帖子发送到 Facebook。

这种方法的问题是您需要创建一个应用程序，并且用户必须授权该应用程序才能使其能够以他们的身份发布。所以也许这不是一个好主意，但我现在已经输入了所有这些，所以我不会删除它。

# python - 如何在 PyQt4 中用动画画一条线

> ID：10301472
> 
> 赞同：10
> 
> 时间：2012-04-24T15:51:21.693
> 
> 标签：python, drawing, pyqt, pyqt4, qpainter

我有一个点列表。例如，`points = [[160, 75], [115, 567]]`。

如何在 PyQt4 中画一条线，所以它会是这样的：![线](../Images/01ee5cdb66e7964c77e22fb3fe7bc72e.png)

提前致谢。

**编辑：**为了记录，我正在尝试实现贝塞尔曲线，所以它看起来像这样： ![四次贝塞尔曲线](../Images/edc421115d718f0e9e321fed169c2782.png)

这是我目前拥有的代码：

```
from PyQt4.QtGui import QWidget, QPolygonF, QPainter, QPen, QBrush, QColor, \
    QApplication, QIcon, QVBoxLayout, QSlider, QHBoxLayout, QPushButton, QLCDNumber
from PyQt4.QtCore import QObject, SIGNAL, SLOT, QPointF, Qt, QRectF, QPointF
import time, sys

#================================================================
# For the next block I used this post
# http://stackoverflow.com/a/3220819/736306, 
# but I wish to replace it with self.liniar_bez(),
# biliniar_bez(), self.cubic_bez() and self.fourG_bez()
# because I want to control 't' with self.slider

def avg(a, b):
  xa, ya = a
  xb, yb = b
  return (xa + xb) * 0.5, (ya + yb) * 0.5

def bez4split(p0, p1, p2, p3, p4):
    p01 = avg(p0, p1)
    p12 = avg(p1, p2)
    p23 = avg(p2, p3)
    p34 = avg(p3, p4)
    p012 = avg(p01, p12)
    p123 = avg(p12, p23)
    p234 = avg(p23, p34)
    p0123 = avg(p012, p123)
    p1234 = avg(p123, p234)
    p01234 = avg(p0123, p1234)
    return [(p0, p01, p012, p0123, p01234),
        (p01234, p1234, p234, p34, p4)]

def bez4(p0, p1, p2, p3, p4, levels=5):
    if levels <= 0:
        return [p0, p4]
    else:
        (a0, a1, a2, a3, a4), (b0, b1, b2, b3, b4) = bez4split(p0, p1, p2, p3, p4)
        return (bez4(a0, a1, a2, a3, a4, levels - 1) +
                bez4(b0, b1, b2, b3, b4, levels - 1)[1:])
#================================================================

points = [[160, 75], [115, 567], [292, 58], [685, 194], [734, 517]]
coords = bez4(*points)

class Bezier(QWidget):
    def __init__(self, parent=None):
        QWidget.__init__(self, parent)

        self.lcd = QLCDNumber(self)
        self.slider = QSlider(Qt.Horizontal, self)
        self.slider.setRange(0, 100)
        self.closeButton = QPushButton('Close')

        bottomLayout = QHBoxLayout()
        bottomLayout.addWidget(self.lcd)
        bottomLayout.addWidget(self.slider)
        bottomLayout.addWidget(self.closeButton)

        mainLayout = QVBoxLayout()
        mainLayout.addStretch(1)
        mainLayout.addLayout(bottomLayout)

        self.setLayout(mainLayout)

        self.time = 0
        self.time_step = 0.025
        self.timer_id = self.startTimer(1)

        self.tracking = None

        QObject.connect(self.closeButton, SIGNAL('clicked(bool)'), app.exit)
        QObject.connect(self.slider, SIGNAL('valueChanged(int)'), self.lcd, SLOT('display(float)'))
        #self.slider.valueChanged.connect(self.lcd.display)

        self.setWindowTitle('Bonus Example')

    def poly(self, pts):
        return QPolygonF(map(lambda p: QPointF(*p), pts))

    def bezAnimation(self):
        painter = QPainter(self)
        painter.setRenderHints(QPainter.Antialiasing)

        pts = points[:]
        crds = coords[:]

        painter.setPen(QPen(QColor(Qt.lightGray), 3, Qt.DashDotDotLine))
        painter.drawPolyline(self.poly(pts))

        painter.setBrush(QBrush(QColor(255, 025, 0)))
        painter.setPen(QPen(QColor(Qt.lightGray), 1))
        for x, y in pts:
            painter.drawEllipse(QRectF(x - 4, y - 4, 8, 8))

    def paintEvent(self, event):
        self.bezAnimation()

    # As you know, 0.00 > 't' > 1.00
    # and QSlider does not provide support for float numbers,
    # so we simply divide t by 100
    def liniar_bez(self, p, t):
        t = t / 100.0
        new_p[0] = (1 - t) * p[0][0] + t * p[1][0]
        new_p[1] = (1 - t) * p[0][1] + t * p[1][1]

    def biliniar_bez(self, p, t):
        t = t / 100.0
        new_p[0][0] = ((1 - t) ** 2) * p[0][0] + 2 * (1 - t) * t * p[1][0] + (t ** 2) * p[2][0]
        new_p[0][1] = ((1 - t) ** 2) * p[0][1] + 2 * (1 - t) * t * p[1][1] + (t ** 2) * p[2][1]

    def cubic_bez(self, p, t):
        t = t / 100.0
        new_p[0][0] = ((1 - t) ** 3) * p[0][0] + 3 * ((1 - t) ** 2) * t * p[1][0] + (t ** 2) * p[2][0] + (t ** 3) * p[3][0]
        new_p[0][1] = ((1 - t) ** 3) * p[0][1] + 3 * ((1 - t) ** 2) * t * p[1][1] + (t ** 2) * p[2][1] + (t ** 3) * p[3][1]

    def fourG_bez(self, p, t):
        t = t / 100.0
        new_p[0][0] = ((1 - t) ** 4) * p[0][0] + 4 * ((1 - t) ** 3) * t * p[1][0] + 4 * (1 - t) * (t ** 2) * p[2][0] + 4 * (1 - t) * (t ** 3) * p[3][0] + (t ** 4) * p[4][0]
        new_p[0][1] = ((1 - t) ** 4) * p[0][1] + 4 * ((1 - t) ** 3) * t * p[1][1] + 4 * (1 - t) * (t ** 2) * p[2][1] + 4 * (1 - t) * (t ** 3) * p[3][1] + (t ** 4) * p[4][1]

    def timerEvent(self, event):
        if self.timer_id == event.timerId():
            #self.bezAnimation()
            self.time += self.time_step
            self.update()

    def closeEvent(self, event):
        self.deleteLater()

    #================================================================
    # And this one too
    # http://stackoverflow.com/a/3220819/736306
    def mousePressEvent(self, event):
        i = min(range(len(points)),
            key=lambda i: (event.x() - points[i][0]) ** 2 +
                      (event.y() - points[i][1]) ** 2)

        self.tracking = lambda p: points.__setitem__(i, p)

    def mouseMoveEvent(self, event):
       if self.tracking:
            self.tracking((event.x(), event.y()))
            self.update()

    def mouseReleaseEvent(self, event):
        self.tracking = None
    #================================================================

if __name__ == '__main__':
    app = QApplication(sys.argv)
    form = Bezier()
    form.setGeometry(10, 30, 871, 727)
    form.show()
    sys.exit(app.exec_()) 
```

所以，我关于如何解决这个问题的想法： 1\. 使用 self.biliniar_bez(),..., self.fourG_bez() 构建所有曲线 2\. 它们共享相同的点，因此它们实际上会在这些点上匹配。3\. 移动点（我认为，它们的位置必须与**t**匹配，所以如果**t=0.25**那么每个点都必须在此时通过它们的四分之一线）

问题在于移动点的方式。我有每条线的第一点和第二点的坐标。需要中间的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T00:17:14.827

1.  如果您使用的是普通小部件，那么您将查看[QPainter.drawPath()](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qpainter.html#drawPath)
2.  如果您使用的是 QGraphics，那么您将查看[QGraphicsPathItem](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qgraphicspathitem.html)

这两种方法中的任何一种都会有类似的方法，在你的绘制过程中，你必须随着时间的推移逐步建立线。查看您自己之前的问题，了解如何随时间绘制线条的具体示例：[在 PySide/PyQt 中使用 drawPolyline 制作动画波浪](https://stackoverflow.com/questions/9465047/make-an-animated-wave-with-drawpolyline-in-pyside-pyqt)

例如，如果您使用的是 QGraphics，那么您的场景中将有一个 QGraphicsPathItem 实例。然后你可以通过循环和更新 QPainterPath 通过增量设置完整路径来动画它：[http ://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qpainterpath.html#cubicTo](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qpainterpath.html#cubicTo)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T07:47:06.790

在您的绘画事件中参考以下代码以在 Qt 中绘制一条线。

```
def paintEvent(self, event):
    painter = Qt.QPainter()
    painter.begin(self)
    painter.pen().setWidth(int width)
painter.setPen(Qt.QColor(100,100,100))
    painter.drawLine(x1,y1,x2,y2)
    painter.end()
    Qt.QFrame.paintEvent(self, event) 
```

# dynamic - 修改动态添加的内容

> ID：10301479
> 
> 赞同：0
> 
> 时间：2012-04-24T15:51:30.773
> 
> 标签：dynamic, jquery

我已经使用了搜索..并尝试了很多东西..但我只是没有让它工作。这是我所做的：

在更改选择时，我请求一些 JSON 格式的数据。之后，我调用一个函数：

```
 if (result.events) {
    $('#filter_result').trigger('put_result', result);
  } 
```

在 put_results() 中，我构建了 HTML：

```
 $('#filter_result').bind('put_result', function (e, data) {
    html = '<h1 class="header_dates">Termine</h1>';
    // and some more
    $(this).html(html).stop(true, true).stop(true, true).slideDown();
  } 
```

我现在要做的是修改#filter_result HTML 的一部分。我想看看一个已经建成的，并获得价值。

插入的 HTML 标记如下所示：

```
 <table>
      <thead>
        <tr>
          <th>Großraum</th>
          <th>Thema</th>
          <th>Termin</th>
          <th>Anmeldung</th>
        </tr>
      </thead>
      <tbody>
        <tr class="last">
          <td class="key_0">Berlin</td>
          <td class="key_1">273</td>
          <td class="key_2">27.04.2012</td>
          <td class="key_4"><a href="link/273.html" class="btn_jetzt_anmelden partnerallowed">Jetzt anmelden</a></td>
        </tr>
      </tbody>
    </table> 
```

为此，我编写了一个在“触发器”行之后被调用的函数。我想到了类似的东西：

```
function unsetlink(){
    if(Date.parse($('.key_2').live().HTML()).equals(Date.today().add(2).days())) {
        alert('false');
    }
    else {
        alert('true');
    }
} 
```

我使用 date.js 进行日期比较。功能逻辑正常工作，这不是问题。只是我认为我在错误的地方使用 live 或类似的东西。我只是找不到答案。欢迎任何可以提供帮助的东西。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T20:55:42.487

鉴于您的更新，并假设您调用它时内容存在，该函数应该是：

```
function unsetlink() {
    if (Date.parse($('.key_2').text()).equals(Date.today().add(2).days())) {
        alert('false');
    } else {
        alert('true');
    }
} 
```

这是对该功能的共同测试：http: [//jsfiddle.net/MarkSchultheiss/86mDa/](http://jsfiddle.net/MarkSchultheiss/86mDa/)

EDIT2：这是处理多个注入内容组的示例：http: [//jsfiddle.net/MarkSchultheiss/86mDa/3/](http://jsfiddle.net/MarkSchultheiss/86mDa/3/)

这是该示例中的代码：

```
function unsetlink(daysadvance) {
    $('.key_2').each(function() {
        if (Date.parse($(this).text()).equals(Date.today().add(daysadvance).days())) {
            $(this).addClass('showFalse');
            $('#me').text($(this).text());//this is just to show what we are processing currnetly
            alert('false');
        } else {
            $(this).addClass('showTrue');
            alert('true');
        }
    })
}
$('#me').after('<table><thead><tr><th>Großraum</th><th>Thema</th><th>Termin</th><th>Anmeldung</th></tr></thead><tbody><tr class="last"><td class="key_0">Berlin</td><td class="key_1">273</td><td class="key_2">27.04.2012</td><td class="key_4"><a href="273.html" class="btn_jetzt_anmelden partnerallowed">register</a></td></tr><tr class="last"><td class="key_0">Berlin</td><td class="key_1">273</td><td class="key_2">28.04.2012</td><td class="key_4"><a href="273.html" class="btn_jetzt_anmelden partnerallowed">register</a></td></tr></tbody></table>');
var daysadvance = 3;
unsetlink(daysadvance); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:03:39.407

我认为您想访问一些将添加到自定义事件中的 DOM 的元素`put_result`。

如果是这种情况，那么我建议您为`put_result`事件编写一个回调函数，该函数将在您附加到 DOM 后调用。见下文，

```
$('#filter_result').bind('put_result', function (e, data, callback) {
    html = '<h1 class="header_dates">Termine</h1>';
    // and some more
    $(this).html(html).stop(true, true).slideDown(); //removed one .stop(true, true)

    callback(); //invoke the callback at the end or when needed accordingly
}); 
```

在触发器中，

```
//unsetlink is your callback function - Change it to an inner function
//if you want to do more and then call unsetlink at the end.
$('#filter_result').trigger('put_result', [result, unsetlink]); 
```

并将您的`unsetlink`功能更改为

```
function unsetlink(){
    if(Date.parse($('.key_2').text()).equals(Date.today().add(2).days())) {
        alert('false');
    } else {
        alert('true');
    }
} 
```

# vba - 在 Excel/VBA 中从选择中排除列

> ID：10301481
> 
> 赞同：2
> 
> 时间：2012-04-24T15:51:44.450
> 
> 标签：vba, excel, spreadsheet

我想选择电子表格中的所有列，除了我通过列名指定的列（列的第一行中的值。列名将作为参数传递给 Sub。例如：

```
Sub selectAllExcept(columns)
With ActiveSheet
    LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column
End With
Range(Columns(1), Columns(LastCol)).EntireColumn.Select
End Sub 
```

但是，我希望能够以某种方式指定我想要所有列（从第一个到最后一个），不包括由 columns 参数指定的列，我将其设想为逗号分隔的字符串：

```
columns = "ColumnName1, ColumnName3" 
```

如果 columns 参数包含一个实际上不是列名的字符串，则代码没有中断也会很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T16:03:45.327

```
Sub SelectAllExcept(ByVal except_those As String)
  Dim cn() As String
  cn = Split(except_those, ",")

  Dim i As Long, j As Long
  For i = LBound(cn) To UBound(cn)
    cn(i) = Trim$(cn(i))
  Next

  Dim r As Range

  For i = 1 To ActiveSheet.UsedRange.Columns.Count
    If Not is_in_array(cn, ActiveSheet.Cells(1, i).Value) Then
      If r Is Nothing Then
        Set r = ActiveSheet.Columns(i)
      Else
        Set r = Application.Union(r, ActiveSheet.Columns(i))
      End If
    End If
  Next

  If Not r Is Nothing Then
    r.Select
  End If
End Sub

Private Function is_in_array(arr() As String, val As String) As Boolean
  Dim i As Long

  For i = LBound(arr) To UBound(arr)
    If StrComp(arr(i), val, vbTextCompare) = 0 Then
      is_in_array = True
      Exit Function
    End If
  Next
End Function 
```

# macos - 在视图中拖放？

> ID：10301482
> 
> 赞同：0
> 
> 时间：2012-04-24T15:51:47.357
> 
> 标签：macos, cocoa

我一直在试验 Cocoa 中的拖放支持 - `draggingEntered:withInfo:`, `draggedImage:beganAt:`等。看起来 OS X 仅在您将某物从一个视图拖入另一个视图时触发“拖动”事件。

我有一个非常大的视图，我在里面画东西，我正在寻找一种在其中拖动对象的方法；对象永远不会离开视图，因此似乎没有生成上述消息，并且没有开始拖动。有没有办法“在视图中拖放”，还是我必须自己实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T04:21:56.733

我很确定你不能通过拖放来做到这一点。如果您要拖动的东西是对象（例如 NSBezier 路径），您可以对它们进行命中测试，然后使用 mouseDown: 和 mouseDragged: 来实现更改对象的原点，但这完全取决于您。

# menu - JavaFx 2.0 菜单

> ID：10301485
> 
> 赞同：1
> 
> 时间：2012-04-24T15:51:49.587
> 
> 标签：menu, javafx, javafx-2

我想为我的程序提供一个菜单。而且我喜欢标准的菜单外观，但我想在菜单栏的最右侧放置一个“注销按钮”.. 是否可以将它放在那里而不必填满整个菜单栏有条目？

真挚地

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:31:20.670

是的你可以。使用 [HBox#setHgrow();](http://docs.oracle.com/javafx/2.0/api/javafx/scene/layout/HBox.html#setHgrow%28javafx.scene.Node,%20javafx.scene.layout.Priority%29) . 这个 javadoc 页面还有一个如何在“**可选布局约束**”部分中使用它的示例。以下取自 javadoc。

例如，如果一个 hbox 需要为 TextField 分配所有额外空间：

```
 HBox hbox = new HBox();
     TextField field = new TextField();
     HBox.setHgrow(field, Priority.ALWAYS);
     hbox.getChildren().addAll(new Label("Search:"), field, new Button("Go")); 
```

简而言之，`Priority.ALWAYS`在`HBox`. 更高级的示例在这里：[使用内置布局窗格：示例 1-4](http://docs.oracle.com/javafx/2.0/layout/builtin_layouts.htm#CHDJFBAE)

# php - MySQL UPDATE 语句未更新关联表

> ID：10301487
> 
> 赞同：0
> 
> 时间：2012-04-24T15:51:54.393
> 
> 标签：php, mysql, sql-update

我有以下代码：

```
$query = "UPDATE jobs SET `ipt` = '$ipt', `prejobform` = '$prejobform', `fileddate` = '$fileddate' WHERE `job_id` = '$jobid'";

  $result = mysql_query($query);

     if (!$result) {
        //ERROR LOGGER HERE
        echo mysql_error();
     }
     else {
        header('Location: view_job.php?jobid='.$jobid);
     } 
```

此代码正在重定向，就像它的行为正确一样，但是当我检查数据库时，这些字段尚未更新。我确定问题很简单，我错过了，但我找不到问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:57:31.297

1.  对于`UPDATE`查询，`mysql_query`如果查询成功（被正确解析和执行），则返回 true，而不仅仅是它确实更新了任何行。

2.  如果基础表是`InnoDB`并且您之前已经启动了事务，则查询不会隐式提交事务，并且会在您退出脚本或断开连接时回滚。

# objective-c - 从数组控制器获取属性数据

> ID：10301488
> 
> 赞同：0
> 
> 时间：2012-04-24T15:51:55.167
> 
> 标签：objective-c, xcode, core-data, nsarraycontroller

按照 Apple Core Data 的[指南](https://developer.apple.com/cocoa/coredatatutorial/index.html)，我将我的应用程序部署到两个表视图。第一个创建假期组，第二个包括先前创建的组的所有庆祝活动。该技术是绑定之一。表格视图连接到两个阵列控制器。第一个数组控制器管理节日组的实体，第二个管理个别节日的实体，并具有两个属性：名称和日期。现在我需要获取 Array 中包含的日期以在应用程序中使用。最简单的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:25:34.233

如果我自己不遵循本教程，我实际上无法评论您的实现，但我可以进行一般评论。

也许您想遍历 selectedObjects？

```
 // When bound to a row, 1 object = 1 row
    for (Entity *entity in arrayController_.selectedObjects) {
        // Use your entity here ie:
        NSLog(@"The entity's date is %@", entity.date);
    } 
```

或者，您可以将值绑定到 TableCellView 的 objectValue

```
1\. Select the TableCellView
2\. Add a label
3\. Bind the value of the new label to the TableCellView
4\. Set the Model Key Path to 'objectValue.date' 
```

希望这可以帮助

# html - 为什么 chrome 不接受底部：0；作为绝对定位页脚的值？

> ID：10301490
> 
> 赞同：2
> 
> 时间：2012-04-24T15:52:06.273
> 
> 标签：html, css

实际上不确定这只是一个 chrome 问题，但我已经将整个页面设置为在相对位置的容器中使用绝对定位的元素。通常，我不会这样做，但我们需要旋转图像，所以我们不能使用 css 背景属性。

无论如何，由于某种原因，当我将页脚绝对定位为底部位置时：0; 右：0；它没有出现。

HTML：

```
<div id="wrapper">
  <div id="content">
  </div>
  <div id="footer">
    <ul>
    </ul>
  </div>
</div> 
```

CSS：

```
#wrapper {
  position: relative;
  margin: 0 auto;
  width: 940px;
}

#content {
  position: absolute;
  top: 0;
  left: 0;
  height: 350px;
}

#footer {
  position: absolute;
  bottom: 0;
  right: 0;
  z-index: 10;
} 
```

编辑：我们无法设置包装器的高度，因为这将是一个 wordpress 网站，用户可以输入大量文本。但是，我们可以设置页脚的高度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:15:02.557

如果您无法设置高度，则只需从包装器中删除页脚，使其没有父级。绝对定位高度由其父级确定。你父母的“包装”没有高度；因此，它不会浮到底部。

幸好身体会沉到底部。

[这是jsFiddles](http://jsfiddle.net/cy5ue/11/)中的代码

```
 #wrapper {
      position: relative;
      margin: 0 auto;
      width: 940px;

    }

    #content {
          background:#ccc; 
      position: absolute;
      top: 0;
      left: 0;
      height: 350px;

    }

    #footer {
      position: absolute;
      bottom: 0;
      right: 0;
      z-index: 10;
        background:papayawhip;
    }​

    <div id="wrapper">
  <div id="content">
      sdfasdf
  </div>

</div>
 <div id="footer">
    <ul>
        <li>aslfaskdjf</li>
    </ul>
  </div>
​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T15:54:41.063

的高度`#wrapper`确实显示出来了-但它的`0px`高度....[看到这里](http://jsfiddle.net/HJ5Vu/1/)你会注意到右边是一个红色边框`#footer``0px``#footer`

如果你给`#wrapper`一个高度并应用一个高度，`#footer` [你可以看到它，](http://jsfiddle.net/HJ5Vu/)或者使页脚与其内容的高度相同，[删除它的高度属性](http://jsfiddle.net/HJ5Vu/2/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T16:00:58.977

实际上它上面的代码是正确的，但是你的#wrapper 有相对位置，而你的#footer 在#wrapper 中。#footer 的位置根据 wrapper 对齐。如果给 wrapper 指定高度，您可以看到它；见下文；

HTML：

```
<div id="wrapper">
  <div id="content">
  </div>
  <div id="footer">
    <ul>
your_content
    </ul>
  </div>
</div> 
```

CSS：

```
#wrapper {
  position: relative;
  margin: 0 auto;
  height: 200px;
  width: 940px;
}

#content {
  position: absolute;
  top: 0;
  left: 0;
  height: 350px;
}

#footer {
  position: absolute;
  bottom: 0;
  right: 0;
  z-index: 10;
} 
```

您可以在此处查看示例[http://jsfiddle.net/8DZ5R/](http://jsfiddle.net/8DZ5R/)

解决此问题的另一种方法，只需将“#footer”位置“绝对”更改为“静态”。您不需要更改包装高度：您可以在此处查看[http://jsfiddle.net/8DZ5R/1/](http://jsfiddle.net/8DZ5R/1/)

# jquery - jquery传递唯一ID没有形式

> ID：10301501
> 
> 赞同：0
> 
> 时间：2012-04-24T15:52:41.477
> 
> 标签：jquery

```
 $.each(thedata.data, function() {    
 $('#theReturnFormTable').append(         
 '<tr id="newReturn"><td align="center"><a href="##" id="link">'+ this.newrequestor
 +'<input type="hidden" id="theID" value="'+ this.theid +'"></a></td><td
 align="center">'+ this.newthedate +'</td><td>'+ this.theid +'</td><td
 align="center">'+ this.newapproved +'</td>
 <td align="center">'+ this.newsecurityaction +'</td></tr>'
 );
 }); 
```

结果：

```
requestor=dave theID = 75
requestor=frank theID = 76
requestor=bill theID = 77
requestor=george theID = 78
requestor=sam theID = 79 and so on. 
```

我在每一行都有链接，无论我点击哪一行，它都会获取 theID = 75，而不是传递该行的 theID 值。我有大脑冻结。任何想法如何为每一行传递 theID 的值？

这是我将ID传递给的地方

```
$("#link").live("click", function(){   
//show layer Div
$("#theHover").show();
alert($("#theID").val());
var instance = new readers_cls();
var theID = $("#theID").val();

newdata = instance.getRequestSecurity(theID);
newrooms = instance.getRequestSecurityRooms(theID);
newcust = instance.getRequestSecurityCust(theID); 
```

我知道它只是进入页面并获取 html 中的第一个 theID。我需要想办法解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:09:27.297

您正在从您发布的第一个每个循环中创建多个 ID 为“theID”的元素，这不好。为什么不立即创建具有适当 ID 的元素，然后：

```
$.each(thedata.data, function() {    
   $('#theReturnFormTable').append(         
     '<tr id="newReturn"><td align="center"><a href="##" id="link">'+ this.newrequestor
     +'<input type="hidden" id="id_'+this.theid'" value="'+ this.theid +'"></a></td>
     ...
   );
}); 
```

这样，所有隐藏的输入元素都将具有一个唯一的 id，您稍后会选择它......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:10:06.800

我认为这是因为您为所有元素提供了非唯一 ID（因为您在该代码中分配了静态 ID）。使用类和“this”关键字。

# sql - 用于检索特定用户的 IM 消息的 OCS sql 查询

> ID：10301504
> 
> 赞同：1
> 
> 时间：2012-04-24T15:53:07.027
> 
> 标签：sql, message, instant, ocs

我想为各种不同的用户从 OCS 数据库 (LcsLogs) 输出所有 IM 消息。我想要他们发送或接收的所有消息。我目前有以下内容：

```
SELECT * from dbo.Messages where
Messages.FromId = '111' or Messages.ToId = '111' or
Messages.FromId = '222' or Messages.ToId = '222' or
Messages.FromId = '333' or Messages.ToId = '333' 
```

我还想确保我正在搜索*所有*正确的表等，并且是 LcsLogs 数据库的新手，我仍然不确定我的基本查询是否足够全面。我在网上看到以下查询：

```
 SELECT * from dbo.Messages, dbo.Users where
 dbo.Users.UserId = Messages.FromId 
```

但是我使用这个查询得到了很多重复的消息，并且不确定我们为什么要查询“dbo.Users”。对此的任何帮助将不胜感激。

亲切的问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:03:36.123

您可以使用此查询来获取所需的信息：

```
SELECT * from dbo.Messages where
  Messages.FromId in ('111', '222', '333')
  or
  Messages.ToId in ('111', '222', '333') 
```

或者要删除其他查询中的重复项，请使用 distinct ，如下所示：

```
SELECT distinct  * from dbo.Messages, dbo.Users where
 dbo.Users.UserId = Messages.FromId 
```

# c# - 每个客户端的 WCF CPU 使用率增加 25%

> ID：10301505
> 
> 赞同：5
> 
> 时间：2012-04-24T15:53:11.547
> 
> 标签：c#, .net, wcf

正如标题所说，我得到了一个定义了此服务行为的 WCF 服务器：

```
[ServiceBehavior(InstanceContextMode = InstanceContextMode.Single, ConcurrencyMode = ConcurrencyMode.Multiple)] 
```

我使用命名管道绑定，我的客户以这种方式连接：

```
 NetNamedPipeBinding binding = new NetNamedPipeBinding();
const int maxValue = 0x40000000; // 1GB
binding.MaxBufferSize = maxValue; 
binding.MaxReceivedMessageSize = maxValue;

binding.ReaderQuotas.MaxArrayLength = maxValue;
binding.ReaderQuotas.MaxBytesPerRead = maxValue;
binding.ReaderQuotas.MaxStringContentLength = maxValue;

// receive timeout acts like a general timeout
binding.ReceiveTimeout = TimeSpan.MaxValue;
binding.SendTimeout = TimeSpan.MaxValue;

ChannelFactory<IDatabaseSession> pipeFactory = new ChannelFactory<IDatabaseSession>(binding, new EndpointAddress("net.pipe://localhost/DatabaseService"));

IDatabaseSession dbSession = pipeFactory.CreateChannel() 
```

我启动的每个客户端都执行上面的代码，每个客户端的 CPU 使用率都会增加 25%（实际上不是针对 5\. 客户端，但此时可执行的服务几乎覆盖了整个 CPU 容量的 100%）。

我正在寻找的是一种资源（网站/列表或只是您的强大知识）告诉我 CreateChannel 实际做了什么（关于资源分配问题）。

提示：即使没有实际进行通信，CPU 使用率也会增加，只是创建了 Channel。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T19:40:57.137

暂停调试器并查看所有线程停止的位置。这可能是您的代码的热门部分。查看调用堆栈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T12:20:23.947

WCF 本身不太可能使用那么多资源，尤其是因为您说即使没有通信也会发生这种情况。我的猜测是这是服务的问题，而不是客户的问题。如果您有服务构造函数，请查看它。还可以尝试不同的`InstanceContextMode`和值`ConcurrencyMode`。

# javascript - 在下拉框中选择项目时更改文本框值

> ID：10301507
> 
> 赞同：11
> 
> 时间：2012-04-24T15:53:26.060
> 
> 标签：javascript, html, select

我正在尝试使用从下拉框中选择的项目更改文本框的值。但它不起作用。

我试过这个 HTML：

```
<select name="ncontacts" id="contacts" onchange="ChooseContact(this);"> 
</select> 
```

这个JS：

```
function ChooseContact(data)
{
   alert(data);
   document.getElementById("friendName").value = data;
} 
```

但是文本框 val 没有更新。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-24T15:56:37.647

这是因为`this`（ 的参数`ChooseContact`）指的是`select`元素本身，而不是它的值。您需要将元素的设置为`value`元素的：`friendName``value``select`

```
document.getElementById("friendName").value = data.value; //data is the element 
```

这是一个[工作示例](http://jsfiddle.net/KEY9y/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-27T06:25:00.853

我建议你很简单的方法

```
$('#quantity').change(function(){
  var qty = $('#quantity').val();
  $("#totalprice").val(qty);
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div class="pricesection">
        <input type="hidden" id="productPrice" value="340"/>
    Quantity: 
    <select id="quantity">
        <option value="1" selected>1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
    </select>
Total: $
<input type="text" id="totalprice" value="1"/>

</div>
```

# magento - 排除特价商品的购物车价格规则

> ID：10301508
> 
> 赞同：9
> 
> 时间：2012-04-24T15:53:34.480
> 
> 标签：magento, magento-1.6

我正在尝试创建一个不会降低已在销售产品价格的折扣券。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-24T16:48:18.120

管理 > 目录 > 管理属性：

*   编辑 special_price 属性，将“用于促销规则条件”设置为“是”

将 special_price = 0 条件添加到您的优惠券逻辑（当然要对此进行测试）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-03-16T21:01:21.940

对于仍然像我一样试图弄清楚这一点的任何人，这就是答案：

首先按照 Benmarks 的建议更改特价属性。

转到您的定价规则，在操作菜单下找到“仅将规则应用于符合以下条件的购物篮商品（所有商品留空）”部分

将条件设置为

如果**所有** 这些条件都是**FALSE**：

特价 **等于或大于** 0.01

这样，折扣仅适用于非特价产品。我发现当篮子里有特价产品和全价产品时，所有其他方式都会出错。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-05T16:29:19.220

这可能是一篇较旧的帖子，但我刚刚在 Magento 1.9.3.2 中经历了相同的过程，以下是我如何将促销代码应用于除特价/特价商品之外的所有商品：

* * *

**管理属性**：

将“用于促销规则条件”的更改 special_price 属性设置为“是”

**购物车规则中“操作”选项卡下的“规则”**：

如果**所有** 这些条件都是**FALSE**：

属性“特价”**未分配**
特价 **等于或大于0.01**

* * *

希望这可以帮助！

# php - 如何存储个人资料视图以显示查看过他们个人资料的每个用户？

> ID：10301510
> 
> 赞同：1
> 
> 时间：2012-04-24T15:53:45.873
> 
> 标签：php, mysql

如果我们想向每个用户显示哪些异性用户查看了他们的个人资料，那么在 MySQL 中跟踪所有这些视图的最佳方式是什么？

每个用户都有一个唯一`userid`的主`Users`表，该表还存储他们的`sex`.

**我们希望按从最近视图到最旧视图的顺序**向每个用户显示查看过他们的用户。

如果他们碰巧查看了自己的个人资料，我们显然不想向用户展示他们自己。

我们希望只向男人展示看过她们的女孩，而只向女孩展示看过她们的男人。

1.  我们将如何设置**表**来`ProfileViews`做到这一点？
2.  我们会使用什么**索引**？
3.  我们需要向每个查看过它们的用户显示什么**查询？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:56:41.303

这是我将为您制作的一个简单示例，希望对您有所帮助。

**SQL：**

```
CREATE TABLE user
(
    user_id BIGINT NOT NULL AUTO_INCREMENT,
    sex VARCHAR(10) NOT NULL,
    CONSTRAINT PK_USER PRIMARY KEY (user_id)
) ENGINE=INNODB;

CREATE TABLE profileview
(
    profileview_id BIGINT NOT NULL AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    visitor_user_id BIGINT NOT NULL,
    date_time DATETIME NOT NULL,
    CONSTRAINT PK_PROFILEVIEW PRIMARY KEY (profileview_id)
) ENGINE=INNODB;

ALTER TABLE profileview
ADD FOREIGN KEY FK_PROFILEVIEW_USER(user_id) 
REFERENCES user (user_id);

ALTER TABLE profileview
ADD FOREIGN KEY FK_PROFILEVIEW_VISITOR(visitor_user_id) 
REFERENCES user (user_id); 
```

**PHP：**

这是用户个人资料页面的一个简单示例 - **www.domain.com/profile.php?id=xxx**。此时需要在用户登录站点时在 session 中定义两个变量： $_SESSION['user_id'] (int) / $_SESSION['user_logged'] (boolean)

```
<?php
if ($_GET && isset($_GET['id']){

    if(isset($_SESSION['user_id']){
       $profile_user_id = $_GET['id'];

       // the user that visits the profile has a session with his/her id on it.
       session_start();
       $visitor_user_id = $_SESSION['user_id'];
    } else {
       // if visitor specified an id but there is no session, redirect to login.
       header("location: login.php");
    }
} else {
    // if no id passed redirect to index
    header("location: index.php");
}
?>
<html>
<head>
<title>Your title</title>
</head>
<script src="scripts/jquery.js" type="text/javascript"></script>
<script type="text/javascript">
//here you will store the visit with jquery.
$(document).ready(function(){
  // store the values from php.
  var profile_user_id = <?php echo $profile_user_id ?>;
  var visitor_user_id = <?php echo $visitor_user_id ?>;

  // here, the user information goes to the visit.php file.
  $.post('visit.php' { profile_user_id:profile_user_id, visitor_user_id:visitor_user_id } );
});
</script>
<body>
Here print user information from a SQL select or something of the id passed in the GET.
</body>
</html> 
```

现在，**visit.php**文件来存储数据：

```
<?php
if ($_POST && isset($_POST['profile_user_id']) && isset($_POST['visitor_user_id'])) {

    session_start();

    // this will end the execution of the script if there is no session from user logged
    if ($_SESSION['user_logged'] != true) {
      exit();
    }

    // everything is ok, do the process:
    // functions.php contains your SQL connection, I suppose you know how to do it.
    include('../cgi-bin/functions.php');
    $link = dbconn();

    $profile_user_id = mysql_real_escape_string($_POST['profile_user_id']);
    $visitor_user_id = mysql_real_escape_string($_POST['visitor_user_id']); 

    // this will store the data in profileview including date and time if id's are not equal.
    if($profile_user_id != $visitor_user_id){
       $sql = "INSERT INTO profileview (user_id, visitor_user_id, date_time) VALUES ($profile_user_id, $visitor_user_id, NOW())";
       mysql_query($sql, $link);
    }
}
?> 
```

**额外：**如果你不知道**functions.php**做什么，这里是：

```
<?php

function dbconn() { 
if(!include_once('db.php')) { 
  die('Error include file.'); 
}

if (!$link = mysql_connect($db['hostname'],$db['username'],$db['password'])) { 
  die('Error connecting.'); 
}

if (!mysql_select_db($db['database'])) { 
  die('Error selecting.'); 
}

return $link; 
}
?> 
```

上面的文件也需要这个文件：在这里设置你的连接参数到你的数据库。

**数据库.php**

```
<?php
  $db = array( 
   'hostname' => 'localhost', 
   'username' => 'root', 
   'password' => 'mysql', 
   'database' => 'mydb' 
  );
?> 
```

*   我建议你把它放在`cgi-bin`你的主机文件夹中以获得更好的实践，正如你在`visit.php`文件代码中看到的那样。

现在，创建另一个名为`visitors.php?id=xxx`的文件，并`select * from`根据`user_id`. 此时，您将能够：

*   获取`user_id`信息，如果是男性（例如）......

    *   按性别选择访问者，并制定规则以仅列出女性访问者。
    *   根据 profileview 表中存储的时间列出访问者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:44:54.563

```
UsersTable
UserID      Sex
1           Boy
2           Girl
3           Girl

UsersViewsTable
UserID      View    Unixtimestamp
1           2       342143243432
1           3       142143243432
2           3       242143243432
3           1       442143243432 
```

当您访问用户个人资料时，您将使用以下内容：

```
IF CurrentUserSex != UserProfileSex
    INSERT INTO UsersViewsTable (UserID, View, Unixtimestamp) VALUES (CurrentUser, CurrentProfileUserID, time) 
```

现在，您想在页面上获取此内容以查看最后一次看到的异性吗？

```
SELECT * FROM UsersViewsTable LEFT JOIN UsersTable USING (UserID) WHERE Sex != CurrentUserSex GROUP BY View ORDER BY Unixtimestamp DESC 
```

**编辑 ：**

```
IF CurrentUserSex != UserProfileSex {
    $Res = SELECT CurrentProfileUserID FROM UsersViewsTable WHERE UserID = CurrentUserID AND View = UserProfileID LIMIT 1

    if($Res['Count'] == 1){
        // Exist
        UPDATE UsersViewsTable SET Unixtimestamp = time WHERE UserID = CurrentUserID AND View = UserProfileID LIMIT 1
    } else {
        // Doesnt exist
        INSERT INTO UsersViewsTable (UserID, View, Unixtimestamp) VALUES (CurrentUser, CurrentProfileUserID, time)
    }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T16:09:32.183

个人资料：

```
profile
userwhoviewed
timestamp 
```

索引配置文件列。

因此，当您的用户查看页面时，检查它是否是个人资料所有者，获取个人资料所有者的性别，检查查看者的性别，如果不同，请使用查看者和时间戳更新表格。

查询结果时，只需选择与目标配置文件匹配的所有行，按时间戳降序排序，然后迭代以将链接构建回这些配置文件。

我通常在这些字段中使用 INT 数据类型（使行更小并加快查找速度），然后有一个用户表将这些 UID 生成为 auto_increment 主键。这也将保存您的性别和偏好字段，以及任何其他辅助用户数据，并且如果需要，可以更轻松地更改登录名。

但是你忽略了你的同性恋用户。最好将它们全部记录下来，让用户根据自己的喜好进行过滤。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T16:40:31.973

只需检查每个用户个人资料页面与访问者 ID 和个人资料 ID 的比较。如果两个不同，则在访问表中存储日期和时间以及您所需的信息。插入之前只需检查表行，如果 prof id，vistor id 已经存在，然后更新时间，否则只需插入数据。

谢谢。

# javascript - 获取 Ajax 函数以返回 true 或 false

> ID：10301511
> 
> 赞同：0
> 
> 时间：2012-04-24T15:53:46.447
> 
> 标签：javascript, ajax

我试图让 Ajax 函数返回 true 或 false（它是一种从另一个函数调用的验证函数）。所以另一个函数需要从这个函数中获取一个真值或假值，这样它才能知道下一步该做什么。

我确定我以前做过这个，但我现在不能让它工作。我尝试了同步和异步调用，在 onreadystatechange 函数内部及其下方有返回，但什么也没有。

这是阿贾克斯：

```
function saveBooking(){
    var service_ids=document.getElementById("allservice_ids").value;
    var provider_ids=document.getElementById("allprovider_ids").value;
    var chosen_time=document.getElementById("chosen_time").value;
    var chosen_date=document.getElementById("chosen_date").value;
    var message=document.getElementById("message").value;

    var parameters="service_ids="+service_ids+"&provider_ids="+provider_ids+"&time="+chosen_time+"&date="+chosen_date+"&you=<?php echo $_SESSION['user_mail']; ?>&message="+message

     if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
     }
     else
     {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
     }

     xmlhttp.open("POST","include/save_booking.php",true);
     xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
     xmlhttp.onreadystatechange = function() {//Call a function when the state changes.
        if(xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            var yesorno=xmlhttp.responseText;
            if(yesorno=="ok"){
                return true;
            }
            else{
                document.getElementById("booking_error").innerHTML = xmlhttp.responseText;
                return false;               
            }
         }
     }
     xmlhttp.send(parameters);

   } 
```

现在 save_booking.php 只包含该行`<?php echo "ok"; ?>`，我将其简化为用于测试目的。

有人能告诉我如何让它工作吗？在另一个功能中，如果我这样做：

```
if(saveBooking()){
        alert(saveBooking());
     } 
```

它只是提醒“未定义”这个词。

请注意，我对 jQuery 不太熟悉，所以“使用 jQuery”对我来说不是一个有用的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:00:24.123

您当前的`return`语句仅确定`onreadystatchange`方法返回的内容，未处理（如果我错了，请纠正我 - 至少我不知道如何访问它的返回值）。你想要的是影响 的回报`saveBooking`，所以你可以做这样的事情：

```
 var responseOk = false;
 xmlhttp.onreadystatechange = function() {//Call a function when the state changes.
    if(xmlhttp.readyState == 4 && xmlhttp.status == 200) {
        responseOk = (xmlhttp.responseText=="ok");
        if(!responseOk) {
            document.getElementById("booking_error").innerHTML = xmlhttp.responseText;
        }
     }
 }
 ...
 return responseOk; 
```

顺便说一句，除非有什么特殊的原因要避免使用 jQuery（例如，我个人喜欢先学会自己做事），否则我强烈建议你看看它。这对您来说不会很复杂，并且会使事情变得容易得多。

除此之外，我必须支持 MilkyWayJoe 的评论 - 生成异步 HTTP 请求然后需要等待其返回值没有多大意义。目前，我上面的示例`false`在大多数情况下可能会返回，因为在脚本到达 return 语句时请求还没有完成。不要混淆发出请求的函数和请求的回调是有道理的。

# java - 在java中索引文本文件

> ID：10301517
> 
> 赞同：0
> 
> 时间：2012-04-24T15:54:11.237
> 
> 标签：java, text, indexing

我有一组文本文件，提供经过解析、分析并允许构建模型的信息。有时，该模型的用户想知道文本文件的哪一部分用于生成给定的模型项。

为此，我正在考虑跟踪行（或字节）ID 的范围，以便能够在需要时读取适当的文本部分。

我的问题是：我想知道它们是否存在任何能够通过使用开始和停止行（或字节）ID而不是从头开始读取文件并计算行（字节）来读取文件的Java阅读器？

最好的祝福

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T15:58:16.340

[如果您确切知道应该跳过的字节数，则可以使用RandomAccessFile](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/RandomAccessFile.html)的 seek 方法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T16:02:30.440

从特定字节读取 - [SeekableByteChannel](http://docs.oracle.com/javase/7/docs/api/java/nio/channels/SeekableByteChannel.html)。当然，没有任何读者能够从行 id 开始 - 因为行分隔符的位置是未知的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T15:59:59.780

您可以使用`InputStream.mark()`和`InputStream.skip()`导航到文件的具体位置。

但是你确定你真的必须自己实现吗？看看[Lucine](http://lucene.apache.org/core/) - 可能会对您有所帮助的索引服务。

# jsf - 在 ap:dataTable 中使用验证器时出现问题

> ID：10301519
> 
> 赞同：0
> 
> 时间：2012-04-24T15:54:21.937
> 
> 标签：jsf, primefaces, datatable, validation

当我在 dataTable 的字段中使用 f:validator 时，它不起作用，如果我在我的验证器类中插入断点，它永远不会执行。

我的数据表：

```
<p:dataTable value="#{contrato.plantillaPrograma}" var="pl" scrollHeight="300" rendered="#{contrato.abrirPrograma}" autoUpdate="true">
    <p:column headerText="#{txtMsg['crearContrato.fecha']}" style="width:125px"
    sortBy="#{pl.fecha}">
        <h:inputText value="#{pl.fecha}">
            <f:converter converterId="dateConverter" />
        </h:inputText>
    </p:column>
    <p:column headerText="#{txtMsg['crearContrato.programa']}" style="width:125px"
    sortBy="#{pl.programa}">
        <h:inputText value="#{pl.programa}" />
    </p:column>
    <p:column headerText="#{txtMsg['crearContrato.fechaFactura']}" style="width:125px"
    sortBy="#{pl.fechaFactura}">
        <p:inputText value="#{pl.fechaFactura}" validator="sheetEnFirme">
            <f:converter converterId="dateConverter"/>
        </p:inputText>
    </p:column>
</p:dataTable> 
```

我的课：包es.axpo.jsf.validator；

```
import javax.faces.application.FacesMessage;
import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import javax.faces.validator.FacesValidator;
import javax.faces.validator.Validator;
import javax.faces.validator.ValidatorException;

@FacesValidator(value="sheetEnFirme")
public class SheetEnFirmeValidator implements Validator{
    public void validate(FacesContext fc, UIComponent comp, Object obj)
            throws ValidatorException {
        throw new ValidatorException(new FacesMessage("Error"));
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T15:58:29.740

确保`#{contrato}`bean 至少为`@ViewScoped`. 确保您没有`plantillaPrograma`在其 getter 方法中进行准备，而是在 bean 的（post）构造函数中进行准备。确保`dateConverter`没有抛出`ConverterException`您应该`<h:message(s)>`在服务器日志中或服务器日志中看到的面孔消息。

顺便说一句，你为什么不只使用内置`<f:convertDateTime>`日期？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T11:19:23.997

解决了。

我的问题出在命令按钮上，我有属性 process="@this"，删除后，验证工作正常

# node.js - Slickgrid 基本示例 - 在 node/express 中，仅加载第一行数据但不可见

> ID：10301525
> 
> 赞同：4
> 
> 时间：2012-04-24T15:54:40.253
> 
> 标签：node.js, express, pug, slickgrid

我正在尝试运行 SlickGrid 的 example1-simple.html 的几乎没有修改过的版本。我在 Mac OS X Lion 上，看到与 Chrome/Safari/Firefox 相同的行为。一旦我有了所有的 CSS/JS 依赖项，我就可以直接加载示例 HTML 页面（以及我稍微修改过的版本），而不会遇到任何麻烦。但是，当我尝试使用 node/express/jade（使用`res.render()`）提供基本相同的页面时，会加载标题（列名）行，并查看呈现的 HTML，我可以看到我的数据的第一行加载但我没有在浏览器中看不到它（我正在尝试加载 10 行数据）。所有相关的 CSS/JS 文件似乎都正确加载，我在浏览器控制台或我的节点控制台中都没有看到任何错误。我已经复制了`grid-canvas` `div`下面的全部内容。

```
<div class="grid-canvas" style="height: 250px; width: 240px; ">
    <div class="ui-widget-content slick-row  even" row="0" style="top:0px">
        <div class="slick-cell l0 r0">Battery test #1.csv</div>
        <div class="slick-cell l1 r1">1024</div>
        <div class="slick-cell l2 r2">1335237255112</div>
    </div>
</div> 
```

我很确定 JavaScript 没问题，因为它与示例 HTML 页面几乎完全匹配，并且当我在`example1-simple.html`文档中替换它并直接访问它时运行良好。此外，在使用 express 呈现页面时，我可以在`new Slick.Grid()`调用时在浏览器中设置断点，并查看正在发送的 10 项行数据数组，但最终并未呈现。

我有基本的老式调试技能（曾几何时，我在 VB 中做过很多 Windows 编程），但我非常愿意接受有关我可以用来解决此类问题的相关调试工具和技术的建议。

这是我的 layout.jade：

```
!!!
html
  head
    title= title
    link(rel="stylesheet", href="/stylesheets/slick.grid.css", type="text/css")
    link(rel="stylesheet", href="/stylesheets/css/smoothness/jquery-ui-1.8.19.custom.css", type="text/css")

  body!= body 
```

以及带有我的测试代码的翡翠页面：

```
#content
  #fileGrid

script(src="/javascripts/lib/jquery-1.7.2.js")
script(src="/javascripts/lib/jquery.event.drag-2.0.min.js")
script(src="/javascripts/lib/slick.core.js")
script(src="/javascripts/lib/slick.grid.js")

script
    var grid;
    var columns = [
      {id: "fileName", name: "File Name", field: "fileName"},
      {id: "fileSize", name: "File Size", field: "fileSize"},
      {id: "lastUpdate", name: "Last Updated", field: "lastUpdate"} // use mtime
      ];

    var options = {
      enableCellNavigation: true,
      enableColumnReorder: false
      };

    $(function() {

      var timeStamp = new Date();
      var numRows = 10;
      var data = [];

      for (var i = 1 ; i <= numRows ; i++) {
        data[i-1] = {
          fileName: "Battery test #" + i + ".csv",
          fileSize: i * 1024,
          lastUpdate: Date.now().toString()
        }
    };

      grid = new Slick.Grid("#fileGrid", data, columns, options);
    }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T14:48:28.910

我想到了。问题是我没有`#fileGrid div`在我的jade/html或css中的任何其他地方指定我的大小，而SlickGrids似乎假设大小为零，因此没有渲染任何行。我将翡翠声明更改为`#fileGrid(style="width:500px; height:600px)`并修复了它。回想起来，这确实是我的玉页面和 html 示例之间唯一不同的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:15:27.107

这看起来很可疑：

```
 for (var i = 0 ; i <= numRows ; i++)
    data[i-1] = {
      fileName: "Battery test #" + i + ".csv",
      fileSize: i * 1024,
      lastUpdate: Date.now().toString(),
    }; 
```

为什么`data[i-1]`和`i <= numRows`？您正在尝试分配到`data[-1]`up until `data[numRows]`，您应该分配到`data[0]`until `data[numRows - 1]`。

在旁注中，我会将那个`for`循环包裹在大括号中，即使它不是绝对必要的。此外，尾随逗号（在最后一行）将在 Internet Explorer 中中断：

```
 for (var i = 0 ; i < numRows ; i++) {
    data[i] = {
      fileName: "Battery test #" + i + ".csv",
      fileSize: i * 1024,
      lastUpdate: Date.now().toString()
    };
  } 
```

您的`columns`作业中也有一个尾随逗号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T15:22:13.073

@BRValentine，你是对的。Slickgrid 网格容器元素必须指定一个高度（宽度是可选的 - 默认情况下使用 100% 可用）。如果您不提供容器元素的高度，Slickgrid 不会呈现行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T19:55:40.710

指定目标网格 div 尺寸解决了我的问题。这在说明中没有……我把它留在这里，以便其他人可以找到它。

```
<div id="classGrid" style="width:500px; height:600px;"></div> 
```

# javascript - 如何使用 jqGrid、多选和 Spring 序列化删除数据？

> ID：10301529
> 
> 赞同：0
> 
> 时间：2012-04-24T15:54:52.703
> 
> 标签：javascript, spring, jqgrid, postdata

目前，我有一个覆盖的 delGridRow 调用，看起来像这样（归功于 Krams 和他的 Spring 教程）：

```
var row = $('#grid').jqGrid('getGridParam','selrow');

$('#grid').jqGrid( 'delGridRow', row, 
        {   url:'deleteRequirement.html', 
            recreateForm: true,
            beforeShowForm: function(form) {
                //Change title
                $(".delmsg").replaceWith('<span style="white-space: pre;">' +
                        'Delete selected record?' + '</span>');
                //hide arrows
                $('#pData').hide();  
                $('#nData').hide();
            },
            reloadAfterSubmit:true,
            closeAfterDelete: true,
            serializeDelData: function (postdata) {
                var rowdata = $('#grid').getRowData(postdata.id);
                // append postdata with any information 
                return {id: postdata.id, oper: postdata.oper, reqID: rowdata.reqID};
            },
            afterSubmit : function(response, postdata) 
            { 
                var result = eval('(' + response.responseText + ')');
                var errors = "";
                    if (result.success == false) {
                    for (var i = 0; i < result.message.length; i++) {
                        errors +=  result.message[i] + "<br/>";
                    }
                }  else {
                    $('#msgbox').text('Entry has been deleted successfully');
                    $('#msgbox').dialog( 
                    {   title: 'Success',
                        modal: true,
                        buttons: {"Ok": function()  {
                            $(this).dialog("close");
                        } 
                    }
                });
            }
        // only used for adding new records
        var newId = null;
        return [result.success, errors, newId];
    }
});
else {
    $('#msgbox').text('You must select a record first!');
    $('#msgbox').dialog( 
            {   title: 'Error',
                modal: true,
                buttons: {"Ok": function()  {
                    $(this).dialog("close");} 
                }
            });
} 
```

为了添加对多选删除的支持，我将“selrow”第一行更改为：

```
var rowList = jQuery("#grid").getGridParam('selarrrow'); 
```

在此之后，事情开始迅速变得粗略。规范说默认的 delGridRow 可以接受要删除的输入记录数组。我进行了以下更改以尝试使用新的“rowList”变量：

```
$('#grid').jqGrid( 'delGridRow', rowList, ... 
```

我仍然在我的 Spring 控制器中点击我的 deleteRequirement.html URL，但似乎只有最后一条记录可以做到。我猜问题出在 serializeDelData 部分的 postdata 准备中，但我还没有找到正确的方法来使用记录列表而不是单个记录来准备这个 postdata。

任何建议/见解将不胜感激。

谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T19:33:54.510

我自己不使用 Spring，但是您的代码接缝的某些部分对我来说很奇怪。

首先，您可以使用`delGridRow`(`row`在您的代码中) 的第一个参数的两种形式。它可以是逗号分隔的 id 列表或 id 数组。如果您使用 id 数组，则 jqGrid 将其转换为逗号分隔的格式`rowids = rowids.join();`。因此`postdata.id`inside of的格式`serializeDelData` 也可以是逗号分隔的 id 列表。

因此，如果您需要支持删除多行，您应该

1.  修改代码`serializeDelData`以发送`reqID`属性以及`reqID`. 对应的代码可以是

```
serializeDelData: function (postdata) {
    var ids = postdata.id.split(','), i, l = ids.length, reqIDList = [];
    for (i = 0; i < l; i++) {
        reqIDList.push($(this).jqGrid("getCell", ids[i], "reqID"));
    }
    return {id: postdata.id, oper: postdata.oper, reqID: reqIDList.join()};
} 
```

1.  修改您的服务器代码以支持逗号分隔`id`的`reqID`形式。

里面`afterSubmit`回调你你的线

```
// only used for adding new records
var newId = null;
return [result.success, errors, newId]; 
```

您可以将这些行修改为以下内容

```
return [result.success, errors]; 
```

因为只会`afterSubmit`使用回调返回的数组的前两个元素。

# r - 更新到 2.15 后在服务器上安装软件包时出现问题

> ID：10301536
> 
> 赞同：4
> 
> 时间：2012-04-24T15:55:20.473
> 
> 标签：r

我在安装软件包时经常遇到问题，通常如下所示：

```
> install.packages("Biobase")
Installing package(s) into ‘/usr/local/lib/R/site-library’
(as ‘lib’ is unspecified)
Warning in install.packages("Biobase") :
  'lib = "/usr/local/lib/R/site-library"' is not writable
Would you like to create a personal library
~/R/x86_64-pc-linux-gnu-library/2.15
to install packages into?  (y/n) y
--- Please select a CRAN mirror for use in this session ---
Loading Tcl/Tk interface ... done
Warning message:
package ‘Biobase’ is not available (for R version 2.15.0) 
```

我`Sys.info()`的如下：

```
> Sys.info()
                                     sysname 
                                     "Linux" 
                                     release 
                          "2.6.32-40-server" 
                                     version 
"#87-Ubuntu SMP Tue Mar 6 02:10:02 UTC 2012" 
                                    nodename 
                                    "******" 
                                     machine 
                                    "x86_64" 
                                       login 
                                        "**" 
                                        user 
                                        "**" 
                              effective_user 
                                        "**" 
```

错误是`package ‘Biobase’ is not available (for R version 2.15.0)`因为我必须将它安装在个人库中（显然在我工作的服务器上，通常的库不可写）？我该如何解决这个问题，因为每当我尝试安装软件包时，我似乎都会遇到相同的“不适用于 2.15”错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T16:00:10.233

该`Biobase`软件包可在 Bioconductor 上获得，而不是通过 CRAN。这是您安装它的方式：

```
source("http://bioconductor.org/biocLite.R")
biocLite("Biobase") 
```

有关更多信息，请参见[Bioconductor](http://www.Bioconductor.org)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-04T16:58:23.047

我正在为可能偶然发现这篇旧帖子的其他任何人添加以下解决方案。

问题的根本原因是 R 安装库的目录的所有权/权限。引用相关帖子：

> “该目录由 root:staff 拥有，模式为 2775，或‘用户和组读写，其他只读’。” （德克·埃德尔布特尔）

有关更多详细信息以及如何更正此问题，请参阅此[线程](https://stackoverflow.com/questions/5560139/install-r-package-xml-in-debian-ubuntu)。

# pthreads - pthread_create - 在 c 中编译时出错

> ID：10301538
> 
> 赞同：0
> 
> 时间：2012-04-24T15:55:33.560
> 
> 标签：pthreads

当我尝试编译它时，我得到一个错误：

> 警告：传递参数 1`pthread_create`使指针从整数而不进行强制转换。

请如果有人可以帮助我..

```
 int Traveler(int id, int numBags)
    {
           int i;
           int err;
         err = pthread_create(id, NULL, Traveler, NULL);
         if(err!=0)
         {
                      return -1;
         }
         else
         {

         }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T16:05:40.147

错误很明显。第一个参数应该是一个指针而不是一个整数。

人线程：

```
 int pthread_create(pthread_t *restrict thread,
          const pthread_attr_t *restrict attr,
          void *(*start_routine)(void*), void *restrict arg);

   The  pthread_create()  function  shall  create  a  new   thread,   with
   attributes  specified  by  attr, within a process. If attr is NULL, the
   default attributes shall be used. If the attributes specified  by  attr
   are modified later, the thread's attributes shall not be affected. Upon
   successful completion, pthread_create() shall store the ID of the  cre-
   ated thread in the location referenced by thread. 
```

`id`在您的 pthread_create 调用之前添加一个＆符号之前，请重新阅读最后一句话。EDIT2：您还必须定义`id`为 pthread_t。

编辑：

实际上，同一行还有另外两个问题： start_routine 需要是一个接受一个参数而不是两个参数的函数，但最糟糕的是这将是一个[fork 炸弹](http://en.wikipedia.org/wiki/Fork_bomb)，因为您传递的函数与您调用的函数相同！

# android - 如何从文件 java 中将背景图像显示为全屏？

> ID：10301540
> 
> 赞同：0
> 
> 时间：2012-04-24T15:55:42.157
> 
> 标签：android, android-layout, android-widget

我想全屏查看背景图像。我该怎么做？我想从 Java 代码中设置我的 * *TableLayout*全屏。

```
tableLayout = new TableLayout(this);
tableLayout.setGravity(Gravity.CENTER); 
tableLayout.setBackgroundResource(R.drawable.lavagna); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T16:52:57.540

```
tableLayout = new TableLayout(this);
TableLayout.LayoutParams params = new TableLayout.LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.FILL_PARENT);
tableLayout.setGravity(Gravity.CENTER); 
tableLayout.setBackgroundResource(R.drawable.lavagna);
tableLayout.setLayoutParams(params); 
```

尝试上面的代码来设置tablelayout全屏

# macos - 在 Mac OSX 中获取进程基地址

> ID：10301542
> 
> 赞同：9
> 
> 时间：2012-04-24T15:55:42.840
> 
> 标签：macos

我正在尝试使用`task_for_pid`/读取进程的内存`vm_read`。

```
uint32_t sz;
pointer_t buf;
task_t task;
pid_t pid = 9484;
kern_return_t error = task_for_pid(current_task(), pid, &task);
vm_read(task, 0x10e448000, 2048, &buf, &sz); 
```

在这种情况下，我读取了前 2048 个字节。

当我知道进程的基地址（在这种情况下，我可以使用 gdb“信息共享”找到它`0x10e448000`）时，这很有效，但是我如何在运行时找出基地址（而不用 gdb 查看它）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T19:30:53.260

回答我自己的问题。我能够使用`mach_vm_region_recurse`如下方式获取基址。偏移量落在`vmoffset`. 如果还有另一种更“正确”的方式 - 不要犹豫发表评论！

```
#include <stdio.h>
#include <mach/mach_init.h>
#include <sys/sysctl.h>
#include <mach/mach_vm.h>

 ...

    mach_port_name_t task;
    vm_map_offset_t vmoffset;
    vm_map_size_t vmsize;
    uint32_t nesting_depth = 0;
    struct vm_region_submap_info_64 vbr;
    mach_msg_type_number_t vbrcount = 16;
    kern_return_t kr;

    if ((kr = mach_vm_region_recurse(task, &vmoffset, &vmsize,
                 &nesting_depth,
                 (vm_region_recurse_info_t)&vbr,
                 &vbrcount)) != KERN_SUCCESS) 
    {
        printf("FAIL");
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-25T04:04:07.370

由于您正在调用 current_task()，我假设您在运行时针对您自己的进程。所以你说的基地址应该是动态基地址，即静态基地址+ASLR引起的图片滑动，对吧？基于这个假设，你可以使用“Section and Segment Accessors”来获取你的进程的静态基地址，然后使用dyld函数来获取图片幻灯片。这是一个片段：

```
#import <Foundation/Foundation.h>
#include </usr/include/mach-o/getsect.h>
#include <stdio.h>
#include </usr/include/mach-o/dyld.h>
#include <string.h>

uint64_t StaticBaseAddress(void)
{
    const struct segment_command_64* command = getsegbyname("__TEXT");
    uint64_t addr = command->vmaddr;
    return addr;
}

intptr_t ImageSlide(void)
{
    char path[1024];
    uint32_t size = sizeof(path);
    if (_NSGetExecutablePath(path, &size) != 0) return -1;
    for (uint32_t i = 0; i < _dyld_image_count(); i++)
    {
        if (strcmp(_dyld_get_image_name(i), path) == 0)
            return _dyld_get_image_vmaddr_slide(i);
    }
    return 0;
}

uint64_t DynamicBaseAddress(void)
{
    return StaticBaseAddress() + ImageSlide();
}

int main (int argc, const char *argv[])
{
    printf("dynamic base address (%0llx) = static base address (%0llx) + image slide (%0lx)\n", DynamicBaseAddress(), StaticBaseAddress(), ImageSlide());
    while (1) {}; // you can attach to this process via gdb/lldb to view the base address now :)
    return 0;
} 
```

希望能帮助到你！

# regex - 如何使用 ack （或等效项）返回字符串的一部分？

> ID：10301543
> 
> 赞同：0
> 
> 时间：2012-04-24T15:55:52.327
> 
> 标签：regex, ack, backreference

我在文件中有一行，如下所示：

```
$db['foo']['database'] = 'bar'; 
```

我想使用 ack 或 grep 或其他东西`bar`从该字符串中返回。到目前为止，我有：

```
ack '^\$db\['\''foo'\''\]\['\''database'\''\] = '\''([\w_]+)'\' $file 
```

但不知道如何让它只吐出第一个反向引用，而不是整行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T17:49:06.033

也许`perl`可以帮助：

内容`script.pl`：

```
use warnings;
use strict;

while ( <> ) {
        printf qq[%s\n], $1 if m/\A\$db\['foo'\]\['database'\]\s*=\s*'([^']+)'.*\Z/;
} 
```

内容`infile`：

```
$db['foo']['database'] = 'bar'; 
```

像这样运行它：

```
perl script.pl infile 
```

具有以下输出：

```
bar 
```

# sql - 如何用多个值更新多行？

> ID：10301547
> 
> 赞同：1
> 
> 时间：2012-04-24T15:55:57.480
> 
> 标签：sql, performance, sql-update, inner-join, bulk

好吧，我有一张这样的桌子

```
id       | idtable2|value   | code   |name       |
1        |     3   |983     |  10    |Total      |
2        |     4   |89      |  10    |type 4     |
3        |     5   |299     |  10    |type 5     |
4        |     6   |0       |  10    |type 6     |
5        |     7   |72      |  10    |type 7     |
6        |     8   |523     |  10    |type 8     |
7        |     4   |        |  11    |percentaje4|
8        |     5   |        |  11    |percentaje5|
9        |     6   |        |  11    |percentaje6|
10       |     7   |        |  11    |percentaje7|
11       |     8   |        |  11    |percentaje8| 
```

我有我的价值观，我需要有他们的百分比。这些百分比基于您可以看到的值。例如，要获取 id 为 7 的行，我可以这样做

```
declare @total int
set @total=(select value from table where name='total')
update table set value=(select value from table where code=1' and name='type 4')/@total 
```

我需要对所有百分比的行执行此操作，但这是一个动态表。在另一个表中，我有一个 id，`table1.name it's equals to table2.name`每个代码 (10,11) 的名称 () 和 table1 将有一个名称（来自 table2）

我怎样才能得到这个值？我尝试了一个查询。

```
update ce set valor=valor/@total from #table1 ce inner join table2 m
on ce.t2id=m.id 
where codigo=10 
```

但我得到它用代码 10 更新值，而不是用代码 11 更新值。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:25:53.140

删除 where 子句就完成了：

```
update ce set valor=valor/@total from #table1 ce inner join table2 m
on ce.t2id=m.id 
```

您不必指定任何内容:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:27:23.597

通过使用 IN，您可以在 where 子句中有多个值：

```
update ce set valor=valor/@total from #table1 ce inner join table2 m
on ce.t2id=m.id 
where codigo in (10, 11) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T17:09:16.900

如果您在 idTable2 上将#table1 加入到自身中，并使用 codigo = 10 过滤另一个，使用 codigo = 11 过滤另一个，则可以使用 codigo = 10 的 valor 来计算 codigo = 11 的百分比。

```
update ce11 
   set valor=ce10.valor/@total 
from #table1 ce11 
  inner join #table1 ce10 
     on ce11.idTable2 = ce10.idTable2
    and ce11.codigo = 11
    and ce10.codigo = 10 
```

# ios - 快速入门 RESTful/数据驱动的 iOS 应用

> ID：10301549
> 
> 赞同：0
> 
> 时间：2012-04-24T15:56:01.657
> 
> 标签：ios, rest, restkit

是否有资源可以让我看到一些示例、快速入门或任何可以让我快速引导使用 REST 数据驱动的 iOS 应用程序的资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T09:06:14.557

除了 ASIHTTPRequest，您还可以查看[RestKit](https://github.com/RestKit/RestKit) ( [restkit.org](http://restkit.org/) )。作者在这里和邮件列表中都很活跃。社区也很有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:23:18.887

我建议研究 ASIHTTPRequest。这可能是让 iOS 应用程序启动并运行网络协议的最快方法。

[http://allseeing-i.com/ASIHTTPRequest/](http://allseeing-i.com/ASIHTTPRequest/)

# xml - XML 如果和何时？

> ID：10301554
> 
> 赞同：0
> 
> 时间：2012-04-24T15:56:16.217
> 
> 标签：xml, xslt, if-statement, conditional

我需要创建一个利用 IF 和 WHEN 的 XML/XSLT 文档。我熟悉 PHP 中的这些语句（尽管是 if/else），但不熟悉 XML/XSLT。

例如我有一个产品，该产品可能有 2 个名称：1）层压名片 2）名片

如果是选项 1，那么我需要获取该订单的自定义选项的值并将其回显，如下所示：

```
<xsl:choose>
<xsl:when test="custom_options/option[name='Lamination Options (Your printing looks great     unlaminated, if you wish you can add gloss or matt lamination below)']/value='Matt Lamination (Both sides)'">
<Extrinsic name="Laminating?">Matt Lam DS SRA3</Extrinsic>
</xsl:when>
<xsl:when test="custom_options/option[name='Lamination Options (Your printing looks great unlaminated, if you wish you can add gloss or matt lamination below)']/value='Gloss Lamination  (Both sides)'">
<Extrinsic name="Laminating?">Gloss Lam DS SRA3</Extrinsic>
</xsl:when>
<xsl:otherwise>
</xsl:otherwise>
</xsl:choose> 
```

所以我需要检查产品的名称，如果它包含单词 lamination 然后运行另一个 if 语句，如果没有运行不同的 if 语句，所以如果它是 PHP，它看起来像这样：

```
<?php $product = "Laminated Business Cards";
if(strpos($product,'Laminated')){
    if(value of custom option == 'Matt Laminated'){
        echo "Matt Lam";
    } elseif(value of custom option == 'Gloss Laminated'){
        echo "Gloss Lam";
    } else echo "No Lamination";
} elseif(value of custom option == 'Matt Laminated +2days'){
        echo "Matt Lam";
    } elseif(value of custom option == 'Gloss Laminated +2days'){
        echo "Gloss Lam";
    } else 
echo "No Lamination"; 
```

?>

所以我需要在 XSLT/XML 中重现它。我知道这有点混乱，但我正在一个设计糟糕的系统的约束下工作，除了走这条路外，别无选择。

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T17:20:31.040

我不太确定你的问题是什么。你有一些 XSLT 代码和一些 PHP 代码，它们看起来很不一样；我不确定为什么。我们看不到您的源文档也无济于事。您的 XSLT 代码表明您已经掌握了 xsl:choose; 的基础知识。它当然可以嵌套在另一个 xsl:choose 的 xsl:when 中包含一个 xsl:choose。那么你的问题到底出在哪里？

我要补充的一件事是，有经验的 XSLT 用户经常避免编写复杂的 xsl:choose 指令，而是将逻辑分解为模板规则。所以你可能会看到一系列这样的模板规则：

```
<xsl:template match="options[@name='Laminated' and @value='Matt Laminated']">
  <xsl:text>Matt Lam</xsl:text>
</xsl:template> 
```

# asp.net-mvc - 是否有用于生成管理员视图页面的 log4net 附加程序？

> ID：10301560
> 
> 赞同：2
> 
> 时间：2012-04-24T15:56:32.063
> 
> 标签：asp.net-mvc, log4net

所以我付出了很多努力来在我的网络应用程序中设置可靠的有意义的日志记录。通过查看我的 log.log 文件，可以获得关于哪里出了问题和什么地方正确的各种信息。

如果我现在可以把它变成我网站上的一个页面，它将向管理员显示所有格式良好的内容，那就太好了。我意识到我必须自己实现身份验证和授权，但肯定有人已经构建了一个开源附加程序或至少一个可以生成实际页面的简单日志查看器？

有人知道吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:11:36.193

您可以使用 XML appender，然后应用 XSLT 转换将日志文件转换为人类可读的 HTML。这是一篇[博文](http://blogs.lessthandot.com/index.php/DesktopDev/MSTech/making-an-xmllayout-for-log4net)。

# nginx - 我的 nginx 配置正确吗？

> ID：10301562
> 
> 赞同：1
> 
> 时间：2012-04-24T15:56:40.403
> 
> 标签：nginx

嗨，我试图在 nginx 中运行我的 Ruby on rails 应用程序 `passenger start -e production`

但它缺少`cache: [HEAD /] miss`

我猜这是我实际上没有公开的文件抱歉这个问题这可能很容易回答，当我路由到 www.tock.com 时，它会在互联网上呈现一个实时页面:(

```
 server {
         listen 80;
         server_name www.tock.com;
         passenger_enabled on;
         root /home/led/Aptana\ Studio\ 3\ Workspace/djors/public;

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T19:56:52.710

无论您将网络服务器指向何处，在这种情况下为 nginx，您都需要您的 DNS 来匹配该位置。如果这是您的生产服务器，那么您需要 DNS 记录将 www.tock.com 指向您的服务器。

如果这是您的开发或本地计算机，您可能不想为您的服务器命名会覆盖公共 DNS 记录的名称。例如，我在本地 nginx 配置中命名所有应用程序，如下所示：

server_name my_app_name.local

给它命名后，您需要将“my_app_name.local”添加到您的主机文件（您的本地 DNS 记录）中。您的主机文件现在应该具有如下条目。

127.0.0.1 本地主机

127.0.0.1 my_app_name.local

重新启动 nginx，您现在可以在浏览器中转到 my_app_name.local。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-08T12:03:46.000

您可以一起摆脱乘客和 nginx conf，因为看起来您是在本地执行此操作，并且如果您想要命名链接（而不是仅仅运行`bundle exec rails server`；使用[Pow](http://pow.cx)来促进这一点。就个人而言，我是一个 Rails 服务器人，但是ymmv。

# java - OOP 设计 - 创建策略/模式

> ID：10301566
> 
> 赞同：0
> 
> 时间：2012-04-24T15:56:57.750
> 
> 标签：java, oop, design-patterns

对于 OOP 实践，我正在从事一个爱好项目，这是一个测验程序，它从 txt 文件中读取表格并询问有关表格中条目的问题。我们的想法是让这有助于学习我们部门的课程所提供的材料。

到目前为止，我编写了 I/O 位，将一个非常普通的 GUI 和类放在一起来表示数据表中不同类型的实体。我不确定如何继续程序的核心，我的意思是问题生成和验证。

我的第一个想法是创建一个类`AbstractQuestion`，它几乎定义了问题是什么以及它具有哪些字段（字符串表示、答案和难度级别）。然后我想我可以为不同类型的问题编写类，例如一个类用于简单的值查询（例如给出实体名称并询问特定属性），另一个类用于更复杂的问题（例如查询交互实体等）。

但是，我不确定这是否是最好的方法。无法真正表达原因，但我有一种感觉，这不是解决问题的最佳方式。在工厂课程上工作有意义吗？基本上我需要：

*   提供基于从数据表中随机选择的一个或多个实体生成问题的方法
*   需要在运行时根据用户的输入（所需的难度级别）创建不同类型的问题
*   问题需要被验证并且用户需要被主`Quiz`类通知（所以问题需要是可访问的）。

我可以从简单开始，只实现一种类型的问题，让它工作并及时添加新功能，但我认为这是提高我对 OOP 理解的好习惯，而且我担心它是否有效，我开始给出它为了让人们对其进行测试，我最终会从事其他工作。我希望能够更好地概念化我的项目，我认为这可能是改进它的好机会。

PS：如果不是很明显，我不是受教育背景的程序员:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:06:06.410

您可以使用[抽象工厂](http://en.wikipedia.org/wiki/Abstract_factory_pattern)来创建知道如何根据特定参数创建问题的工厂。
至于通知，您可以使用[Observer Pattern](http://en.wikipedia.org/wiki/Observer_pattern)。研究它们并以您喜欢的语言查看示例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T16:09:25.850

考虑两件事：

1.  哪些对象**使用**Question 对象？他们需要问题做什么？那就是我们谈论问题的接口。
2.  问题如何做这些事情？问题的行为。

最初，只考虑接口。我不清楚我们需要这个问题做什么。在我看来，一个答案是自由格式文本的问题和一个提供“从 A 到 D 中选择一个”的问题和一个询问“从 A 到 D 中选择一个或多个”的问题在 UI 中可能会非常不同. 那么你是在“问题：请展示自己，得到你的答案并告诉我用户的分数”还是“问题：你的文字是什么？问题：你采取什么样的答案？问题：你的四个选项是什么？ ? 问题：用户输入'a'他们得了什么？

一旦清楚了问题的职责，就可以考虑适当数量的不同 Question 接口和类，从而决定是否需要创建模式，例如 Factory。当您有许多不同的类都实现**相同**的接口时，工厂工作得很好。

工厂：去问我一个问题。问题：去问用户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T16:22:47.343

我有一个在生产环境中运行的简单测验应用程序 =) 有不同类型的问题，具有不同的行为（应该以不同的方式提出、回答和提示）。问题有不同的复杂性等。

在我的情况下，最合适的解决方案是创建带有一些抽象方法（它也可以是接口）和不同实现的问题超类。还有 QuestionGenerator （作为工厂工作），工厂，基于一些输入返回不同的实现。

想想你的问题的界面（公共部分）并使用工厂模式。可能有更复杂的场景，您可以在其中找到使用 AbstractFactory 或 Builder 模式的一些优势。

在我的简单情况下，提取接口就足够了

# android - Linearlayout >> empty eventlistener 方法必须获得焦点？

> ID：10301567
> 
> 赞同：0
> 
> 时间：2012-04-24T15:56:59.647
> 
> 标签：android

我创建了一个带有 state_focused 和默认项的可绘制对象 (background_row.xml)。现在我想在选择时使用这个drawable为线性布局着色。

```
Linearlayout row = new LinearLayout(this);
row.setFocusableInTouchMode(true);
row.setBackgroundResource(R.drawable.background_row); 
```

这行不通。我尝试了很多，最后我发现它有效，当我像这样实现一个空的 setOnClickListener 时：

```
row.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {

    }
}); 
```

抱歉.. 但这对我来说毫无意义.. 为什么我必须实现一个空的 OnClickListener 以及为什么它在我这样做时可以工作？

# systemc - 编写D触发器的主程序

> ID：10301578
> 
> 赞同：0
> 
> 时间：2012-04-24T15:57:55.357
> 
> 标签：systemc

我是 systemC 编程的新手，我正在编写一个 D 触发器，但我找不到编写主程序和输入信号的方法（在我的情况下是 din、clock 和 dout）：

这是我的代码：

```
#include "systemc.h" 

 SC_MODULE(d_ff) { // on déclare le module à l'aide de la macro SC_MODULE.

  sc_in<bool> din;   // signal d'entrée
  sc_in<bool> clock;// définition de l'horlogue
  sc_out<bool> dout;// signal de sortie

   void doit() {  // La fonction qui assure le traitement de la bascule D
     dout = din; // Affectation de la valeur du port d'entrée dans le port de sortie

     cout << dout;
     }; 

    SC_CTOR(d_ff) { //le constructeur du module d_ff
    SC_METHOD(doit); //On enregistre la fonction doit comme un processus
    sensitive_pos << clock;  } 

   int sc_main (int argc , char *argv[]) {
     d_ff obj();
       din<=true;
     clock<=false;
     obj.doit();
     return 0;
         }}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T13:03:59.433

这个页面有帮助吗？

[http://www.asic-world.com/systemc/first1.html](http://www.asic-world.com/systemc/first1.html)

它的标题是“我在 System C 中的第一个程序”，所以看起来是关于你在哪里。

其他一些对新手有用的链接：

[http://panoramis.free.fr/search.systemc.org/?doc=systemc/helloworld](http://panoramis.free.fr/search.systemc.org/?doc=systemc/helloworld)

[http://www.ht-lab.com/howto/vh2sc_tut/vh2sc_tut1.html](http://www.ht-lab.com/howto/vh2sc_tut/vh2sc_tut1.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T15:14:20.190

您必须安装 VCD 查看器才能以波形的形式查看模拟结果。我想这就是你想要的我使用这个[http://www.iss-us.com/wavevcd/index.htm](http://www.iss-us.com/wavevcd/index.htm)，但还有其他的。

接下来，您必须对代码进行一些更改。更改将生成 vcd 文件：

我做了这个：

```
// File dff.h
#include <iostream>
#include <systemc.h>

SC_MODULE (dff) {
    sc_in <bool> clk;
    sc_in <bool> din;
    sc_out <bool> dout;

    void dff_method();

    SC_CTOR (dff) {
        SC_METHOD (dff_method);
            sensitive_pos << clk;
    }
};

// File dff.cpp
#include "dff.h"

void dff:: dff_method (){
    dout=din;
}

// File: main.cpp
#include <systemc.h>
#include "dff.h"

int sc_main(int argc, char* argv[])
{
    sc_signal<bool> din, dout;
    sc_clock clk("clk",10,SC_NS,0.5);

    dff dff1("dff");

    dff1.din(din);
    dff1.dout(dout);
    dff1.clk(clk);

    // WAVE
    sc_trace_file *fp;                    // VCD file
    fp=sc_create_vcd_trace_file("wave");
    fp->set_time_unit(100, SC_PS);        // resolution (trace) ps
    sc_trace(fp,clk,"clk");               // signals
    sc_trace(fp,din,"din");
    sc_trace(fp,dout,"dout");

    //Inicialization
    din=0;

    //START
    sc_start(31, SC_NS);               
    din=1;
    cout << "Din=1" << endl;
    cout << "Tempo: " << sc_time_stamp() << endl;

    sc_start(31, SC_NS);
    din=0;
    cout << "Din=0" << endl;
    cout << "Tempo: " << sc_time_stamp() << endl;

    sc_start(31, SC_NS);

    sc_close_vcd_trace_file(fp);        // fecho(fp)

    char myLine[100];
    cin.getline(myLine, 100);

    return 0;
} 
```

我希望它会有所帮助

# android - 在使用 ORMLite 和 Android 时，是否有一种简单的方法可以添加最后修改的时间戳？

> ID：10301579
> 
> 赞同：5
> 
> 时间：2012-04-24T15:57:58.503
> 
> 标签：android, sqlite, ormlite

我想添加一个字段，指示我的对象的上次修改或上次访问时间。有没有一种简单的自动刷新方法可以做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T16:04:02.390

我不确定如何使用 SQLite 来支持最后修改的时间戳。然而，[ORMLite](http://ormlite.com/)的特性之一是版本字段。您可以标记一个`Date`字段，`version = true`并且每次更新它都会将其更新`Date`为最新值。有关更多信息，请参阅文档：

> [http://ormlite.com/docs/version-field](http://ormlite.com/docs/version-field)

因此，您将在您的课程中添加以下内容：

```
@DatabaseField(version = true)
Date modificationDate; 
```

我已经验证这对于创建和修改日期都适用。此外，这意味着当您进行任何升级时，它会自动在更新语句的末尾添加如下内容：

```
UPDATE yourclass SET ... >>> WHERE modificationDate = existing-date; <<< 
```

有关更多信息，请参阅文档。哦，如果您想将其存储为 long，则可以执行以下操作：

```
@DatabaseField(version = true, dataType = DataType.DATE_LONG)
Date modificationDate; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T16:44:46.087

您可以创建一个触发器，每次在 sqlite 中发生插入和更新时更新您的 modificatoinDate。

例子：

```
db.execSQL("create trigger updateModDate " +
    "after insert on MY_TABLE for each row begin " +
    "update MY_TABLE set modificationDate = date('now') where id = NEW.id " +
    "end;");

db.execSQL("create trigger updateModDate " +
    "after update on MY_TABLE for each row begin " +
    "update MY_TABLE set modificationDate = date('now') where id = NEW.id " +
    "end;"); 
```

我相信触发器在 Android 使用的 sqlite 数据库中可用。我尚未验证这些更新是否有效，但这可能是一个透明的解决方案。

我不确定上次访问时间。我不想看到每次执行选择时都必须进行更新的性能。

# sql - sql截断/填充字符串

> ID：10301581
> 
> 赞同：2
> 
> 时间：2012-04-24T15:58:15.493
> 
> 标签：sql, string

我需要这样的东西

```
SELECT CLIENT_AHCCCS_ID + CLIENT_FIRST_NAME + CLIENT_LAST_NAME + replace(convert(datetime, DATE_OF_BIRTH, 1), '/', '')
FROM  tblCLIENT
WHERE CLIENT_AHCCCS_ID IS NOT NULL AND CLIENT_AHCCCS_ID LIKE 'A%' 
```

但必须确保

```
CLIENT_AHCCCS_ID        ( 9 character )
Member Last Name      ( 25 character )
First Name          ( 25 character ) 
```

我必须使用空格来填充字符串。我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T16:01:31.620

假设 SQL Server，SQL 数据类型 char 用字符串填充，所以你总是可以转换为：

```
SELECT
    CONVERT(char(9), CLIENT_AHCCCS_ID) +
    CONVERT(char(25), CLIENT_FIRST_NAME) +
    CONVERT(char(25), CLIENT_LAST_NAME) +
    replace... 
```

# mobile - 在 phonegap 'wrapped' 应用程序中使用缓存清单

> ID：10301585
> 
> 赞同：0
> 
> 时间：2012-04-24T15:58:38.737
> 
> 标签：mobile, jquery-mobile, cordova

我有一个 web 应用程序 (jqmobile) 将被包裹在 Phonegap 中，以便它可以在应用程序商店中使用。
我遇到的困难是放置 html 文件的最佳位置在哪里？我是否将它们包装到应用程序中，或者我仍然可以将这些页面托管在远程服务器上？如果我决定更新我的一个 html 页面中的图像/元素，我是否必须强制用户在商店中“更新”他们的应用程序？如果可能的话，我不想这样做。

此外，这个应用程序需要支持“离线”模式，但我听说 phonegap IOS 应用程序不支持缓存清单？那里有知识的人可以给我一些指导吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T21:14:43.063

您可以加载“外部页面”，但我认为苹果不会允许将其放入应用商店。

另一种方法是使用 Ajax/XHR 提取图像并将它们本地存储在您的 web 应用程序中。确实需要一些工作才能使其正常工作，因为您需要使用二进制 blob。通过这种方式，您可以更新现有的本地资源并保持您的应用程序快速运行。

其他其他方式是再次使用 XHR/AJAX 将表情图像拉到本地 Web 应用程序中。我认为你会同意这个和苹果。它会更慢，你需要处理它，否则用户会在你的应用程序中看到空的地方或加载图像。

Phonegp 将您的所有资源包装在应用程序中。

# python - 如何在不合并它们的情况下将多个元组（列表等）添加到单个字典键中？

> ID：10301589
> 
> 赞同：4
> 
> 时间：2012-04-24T15:58:51.530
> 
> 标签：python, list, dictionary, tuples

我一直在试图弄清楚如何将包含多个值的多个元组添加到字典中的单个键中。但到目前为止还没有成功。我可以将值添加到元组或列表中，但我不知道如何添加元组，以便键现在有 2 个包含值的元组，而不是一个包含所有值的元组。

例如说字典=`{'Key1':(1.000,2.003,3.0029)}`

我想添加`(2.3232,13.5232,1325.123)`，以便我最终得到：

字典= `{'Key1':((1.000,2.003,3.0029),(2.3232,13.5232,1325.123))}`（忘记了一组括号！）

如果有人知道如何做到这一点，我将不胜感激，因为它现在真的开始让我烦恼了。

谢谢！

编辑：谢谢大家！具有讽刺意味的是，我尝试了这一点，除非当时我试图将值设为多个列表而不是多个元组；当解决方案是将元组包含在列表中时。啊讽刺。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-24T16:03:35.883

使用[defaultdict](http://docs.python.org/library/collections.html#collections.defaultdict)并始终使用 append ，这将是无缝的。

```
from collections import defaultdict

x = defaultdict(list)
x['Key1'].append((1.000,2.003,3.0029)) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-24T16:01:41.803

只需将您的键映射到列表，并将元组附加到列表中。

```
d = {'Key1': [(1.000,2.003,3.0029)]} 
```

然后后来..

```
d['Key1'].append((2.3232,13.5232,1325.123)) 
```

现在你有：

```
{'Key1': [(1.0, 2.003, 3.0029), (2.3232, 13.5232, 1325.123)]} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-24T16:03:34.377

字典值不能单独包含两个元组。每个字典键映射到一个值，因此您可以让两个单独的元组与该键关联的唯一方法是将它们本身包含在一个元组或列表中：`{'Key1':[(1.000,2.003,3.0029),(2.3232,13.5232,1325.123)]}`- 请注意额外的一对方括号。

这样做的一种方法是获取与您的键关联的当前值，并将其附加到列表中，然后再将新列表设置回该键。但是，如果您有可能需要任何键，那么您应该在一开始就对所有键都这样做，否则您将遇到各种困难来确定您所处的级别。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T16:02:41.957

代替：

```
{'Key1':(1.000,2.003,3.0029)} 
```

你想要的是：

```
{'Key1':[(1.000,2.003,3.0029)]} 
```

当你添加另一个元组时，你会得到：

```
{'Key1':[(1.000,2.003,3.0029), (2.3232,13.5232,1325.123)]} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-24T16:05:26.277

我认为你的问题表述得有些糟糕。你想要：

1.  如果键不在字典中，则将元组关联到键
2.  如果键在字典中并指向一个元组，则将元组替换为两个元组的列表
3.  将元组附加到与键关联的元组列表中

这可以通过以下代码实现：

```
def insertTuple(d, k, tup):
    if k not in d:
        d[k] = tup
    elif type(d[k]) == tuple:
        d[k] = [ d[k], tup ]
    else:
        d[k].append(tup) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-22T05:17:16.373

我们知道元组是不可变的。而不是使用元组的元组。使用元组列表这将起作用。

首先创建一个元组列表，然后将其附加到字典键。\

```
dictionary = {}
listoftuples = []//create a tuples of list
dictionary[key].append(listoftuples)//appending it to a dictionary key 
```

# android - Android 上一个库项目的独立测试项目

> ID：10301592
> 
> 赞同：16
> 
> 时间：2012-04-24T15:59:05.170
> 
> 标签：android, unit-testing, testing, junit

我的问题是：**如何为 Android 库创建 Android*独立*测试项目？**

我有我的 Android*库*（在项目设置中标记为“库”）和一个包含我的 JUnit 测试类的 Android 项目。测试*项目*正确引用了 Android 库（在“Android”下的项目设置中）。

我的*库*源代码位于包中`com.mayastudios`。我所有的测试用例也位于同一个包中（但在不同的项目中）。所以基本上我有这样的事情：

```
+- MyLibraryProject
   +- src
      +- com/mayastudios/MyClass.java
   +- AndroidManifest.xml
   +- ...
+- MyTestProject (references MyLibraryProject)
   +- test
      +- com/mayastudios/MyClassTests.java
   +- AndroidManifest.xml
   +- ... 
```

*这是测试*项目的 Android 清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.spatialite.test"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="10" />

    <instrumentation
        android:name="android.test.InstrumentationTestRunner"
        android:targetPackage="com.mayastudios" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>

    <application android:label="Spatialite-NewApi-UnitTests">
        <uses-library android:name="android.test.runner" />
    </application>

</manifest> 
```

但是，当我运行*测试*项目（从带有 ADT 的 Eclipse，使用“Run As -> Android JUnit Test”）时，我收到以下错误：

```
Unable to find instrumentation target package: com.mayastudios 
```

这是完整的控制台日志：

```
[2012-04-24 17:24:20 - spatialite-test] Android Launch!
[2012-04-24 17:24:20 - spatialite-test] adb is running normally.
[2012-04-24 17:24:20 - spatialite-test] Performing android.test.InstrumentationTestRunner JUnit launch
[2012-04-24 17:24:20 - spatialite-test] Automatic Target Mode: using device '3732FBC2711300EC'
[2012-04-24 17:24:20 - spatialite-test] Uploading spatialite-test.apk onto device '3732FBC2711300EC'
[2012-04-24 17:24:20 - spatialite-test] Installing spatialite-test.apk...
[2012-04-24 17:24:22 - spatialite-test] Success!
[2012-04-24 17:24:22 - spatialite-test] Launching instrumentation android.test.InstrumentationTestRunner on device 3732FBC2711300EC
[2012-04-24 17:24:22 - spatialite-test] Collecting test information
[2012-04-24 17:24:23 - spatialite-test] Test run failed: Unable to find instrumentation target package: com.mayastudios 
```

我试图`<instrumentation>`从无效的清单中删除标签。

到目前为止，我完成这项工作的唯一方法是创建一个默认 Android 项目（带有一个 Activity），从我的测试项目中引用它，并使用这个默认 Android 项目的包名称，如下`targetPackage`所示`<instrumentation>`。但这不是我想要的。我想要一个独立的测试项目。

有什么建议么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-25T06:02:08.160

啊，答案很简单。*错误在第3行测试*项目的Android清单中：这里提到了错误的包。所以更正后的清单如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.mayastudios"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="10" />

    <instrumentation
        android:name="android.test.InstrumentationTestRunner"
        android:targetPackage="com.mayastudios" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>

    <application android:label="Spatialite-NewApi-UnitTests">
        <uses-library android:name="android.test.runner" />
    </application>

</manifest> 
```

对于所有说你需要三个项目（库、被测项目、测试项目）的人：他们错了。一个库项目和一个测试项目就足够了。测试项目甚至不需要包含 Activity。

# java - 如何使用 Java 将 pdf 发送到远程服务器？

> ID：10301593
> 
> 赞同：0
> 
> 时间：2012-04-24T15:59:06.060
> 
> 标签：java

我想使用 Java 将 pdf 发送到客户端 web 服务 url。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:06:05.863

几个简单的步骤。我将在括号之间添加一些术语以进行谷歌搜索。

1.  打开 pdf 文件的 FileInputStream。（java文件输入流）
2.  告诉服务器您将发送一个文件。
3.  使用 byte[] 缓冲区并从输入流中填充它并将其写入服务器。（java读取输入流缓冲区）。您必须告诉服务器即将到来的缓冲区的大小。

这是一些示例代码。

```
InputStream in = new FileInputStream(file);
OuputStream os = socket.getOutputStream();
DataOutputStream dos = new DataOutputStream(os);
int n;
byte[] b = new byte[1024 * 16];
while ((n = in.read(b)) != -1)
{
    dos.writeByte(1); // tell the server a buffer is coming
    dos.writeInt(n); // tell it the how big the buffer is
    dos.write(b, 0, n); // write the buffer
}
dos.writeByte(0); // tell the server no more buffers are coming.
dos.flush(); 
```

现在，由您来编写它的服务器部分。

# c# - 如何使用泛型开发适用于双精度和小数的代码

> ID：10301594
> 
> 赞同：9
> 
> 时间：2012-04-24T15:59:09.843
> 
> 标签：c#, c#-4.0

以下代码非常重复：

```
 public static double Interpolate(double x1, double y1, double x2, double y2, double x)
    {
        return y1 + (x - x1) * (y2 - y1) / (x2 - x1);
    }
    public static decimal Interpolate(decimal x1, decimal y1, decimal x2, decimal y2, decimal x)
    {
        return y1 + (x - x1) * (y2 - y1) / (x2 - x1);
    } 
```

但是，我使用泛型的尝试无法编译：

```
 public static T Interpolate<T>(T x1, T y1, T x2, T y2, T x)
    {
        return y1 + (x - x1) * (y2 - y1) / (x2 - x1);
    } 
```

错误信息如下：

错误 2 运算符“-”不能应用于“T”和“T”类型的操作数 C:\Git...\LinearInterpolator.cs

我应该如何重用我的代码？

**编辑：**快速运行对于这个模块很重要。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T16:02:16.147

您当前的代码很好 - 可能是您在不将双打转换为小数的情况下可以实现的最好的。

一个通用的解决方案是*可能的*，但会涉及大量的基础设施 - 以至于它会使事情变得过于复杂。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T16:07:56.890

每当我需要这样做时，我都会求助于`dynamic`. 这可以正常工作，但可能比您当前拥有的重载要慢一些。

```
 public static T Interpolate<T>(T x1, T y1, T x2, T y2, T x)
 {         
     return y1 + ((dynamic)x - x1) * ((dynamic)y2 - y1) / ((dynamic)x2 - x1);
 } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-24T16:03:14.483

如果没有在`T`.

您可能会这样做：[在 C# 中使用泛型创建数学库，](https://stackoverflow.com/questions/63694/creating-a-math-library-using-generics-in-c-sharp)但就个人而言，除非您真的有很多不同的公式，否则我认为没有多大意义。

还有可能动态编译表达式树`T`，重写 C# 编译器生成的“模型”树之间的类型`double`（`decimal`保持算术优先级等）......如果你*真的*对此感兴趣，我可以发布代码对于这样的解决方案（我需要一个小时左右！）。运行时性能会变慢。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-24T17:44:14.833

您可以使用`IConvertible`. 但是根据您的需要，性能差异可能很大。与使用的方法相比`Single`，差异可能达到近 50%。使用 Generic 进行 100000 次迭代，单次需要 109 毫秒和 156 毫秒。

请参阅此代码（.Net 2）：

```
using System;
using System.Text;
using NUnit.Framework;

namespace ProofOfConcept.GenericInterpolation
{
    /// <summary>
    /// Proof of concept for a generic Interpolate.
    /// </summary>
    [TestFixture]
    public class GenericInterpolationTest
    {
        /// <summary>
        /// Interpolate test.
        /// </summary>
        [Test]
        public void InterpolateTest()
        {
            Int16 interpolInt16 = Interpolate<Int16>(2, 4, 5, 6, 7);
            Int32 interpolInt32 = Interpolate<Int32>(2, 4, 5, 6, 7);

            Double interpolDouble = Interpolate<Double>(2, 4, 5, 6, 7);
            Decimal interpolDecimal = Interpolate<Decimal>(2, 4, 5, 6, 7);

            Assert.AreEqual((Int16)interpolInt32, (Int16)interpolInt16);
            Assert.AreEqual((Double)interpolDouble, (Double)interpolDecimal);

            //performance test
            int qtd = 100000;
            DateTime beginDt = DateTime.Now;
            TimeSpan totalTimeTS = TimeSpan.Zero;
            for (int i = 0; i < qtd; i++)
            {
                interpolDouble = Interpolate(2, 4, 5, 6, 7);
            }
            totalTimeTS = DateTime.Now.Subtract(beginDt);
            Console.WriteLine(
                "Non Generic Single, Total time (ms): " + 
                totalTimeTS.TotalMilliseconds);

            beginDt = DateTime.Now;
            for (int i = 0; i < qtd; i++)
            {
                interpolDouble = Interpolate<Double>(2, 4, 5, 6, 7);
            }
            totalTimeTS = DateTime.Now.Subtract(beginDt);
            Console.WriteLine(
                "Generic, Total time (ms): " + 
                totalTimeTS.TotalMilliseconds);
        }

        /// <summary>
        /// Interpolates the specified x1.
        /// </summary>
        /// <typeparam name="T"></typeparam>
        /// <param name="x1">The x1.</param>
        /// <param name="y1">The y1.</param>
        /// <param name="x2">The x2.</param>
        /// <param name="y2">The y2.</param>
        /// <param name="x">The x.</param>
        /// <returns></returns>
        public static T Interpolate<T>(T x1, T y1, T x2, T y2, T x) where T : IConvertible
        {
            IConvertible x1C = x1 as IConvertible;
            IConvertible y1C = y1 as IConvertible;
            IConvertible x2C = x2 as IConvertible;
            IConvertible y2C = y2 as IConvertible;
            IConvertible xC = x as IConvertible;
            Decimal retDec = y1C.ToDecimal(null) + 
               (xC.ToDecimal(null) - x1C.ToDecimal(null)) * 
               (y2C.ToDecimal(null) - y1C.ToDecimal(null)) / 
               (x2C.ToDecimal(null) - x1C.ToDecimal(null));

            return (T)((IConvertible)retDec).ToType(typeof(T), null);
        }

        /// <summary>
        /// Interpolates the specified x1.
        /// </summary>
        /// <param name="x1">The x1.</param>
        /// <param name="y1">The y1.</param>
        /// <param name="x2">The x2.</param>
        /// <param name="y2">The y2.</param>
        /// <param name="x">The x.</param>
        /// <returns></returns>
        public static Single Interpolate(Single x1, Single y1, Single x2, Single y2, Single x)
        {
            Single retSing = y1 + (x - x1) * (y2 - y1) / (x2 - x1);

            return retSing;
        }
    }
} 
```

# c# - 实体框架 - 反射

> ID：10301595
> 
> 赞同：0
> 
> 时间：2012-04-24T15:59:11.047
> 
> 标签：c#, asp.net, entity-framework-4

我需要根据页面控件的名称选择实体对象。

有两种情况我需要基于字符串访问实体（我根据放置在页面上的用户控件的名称动态选择这些：

示例 1) - 在这里我想以某种方式将 db.PersonalDetails 更改为字符串替换，其中 db.PersonalDetails 是一个变量。

```
EntityObject obj = null;
obj = (from q in db.PersonalDetails where q.AppFormId==FormApplicationId select q).SingleOrDefault(); 
```

示例 2）在这里我想动态设置返回类型，在这种情况下它是 PersonalDetail 但我希望能够动态设置它。我可以使用反射来获取类型，但我不能说“as obj.GetType()”，因为它出错了。

```
EntityObject obj = null;
obj = returnUpdatedObj(obj) as PersonalDetail; 
```

任何帮助将非常感激。我迫切希望找到解决方案，因此如果需要更多信息来解释该问题，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T13:26:19.130

对于 1) 你可以像我在[这篇](http://wimpool.nl/blog/DotNet/extending-entity-framework-4-with-uniquevalidator)博文中所做的那样做。制作一个表达式树并使用该表达式树

```
context.Set<T>.Where(expression); 
```

对于 2) 看起来你需要通用函数：

```
 private static T DoSomething<T>(T obj)
    {
        return obj;
    } 
```

# ajax - 如何访问通过ajax加载的div的id

> ID：10301597
> 
> 赞同：0
> 
> 时间：2012-04-24T15:59:21.620
> 
> 标签：ajax, jquery

我有 id = new 的按钮，它加载新页面

```
$("#new").click(function(){
$('#message_area').load('new.php');
}); 
```

new.php 中有一个将消息发送到数据库的按钮。但我有一个问题，如果我通过ajax导航到其他一些链接并再次使用上面的代码加载new.php然后在new.php中发送按钮不起作用，它只在页面加载第一次时有效，我必须刷新页面然后它的工作原理。我认为这是因为 new.php 中的发送按钮是在第一次创建 DOM 之后添加的。请帮助提前谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:01:53.040

您需要发布标记的更多详细信息以获得更准确的答案，但总体思路是使用事件委托。将事件处理程序绑定到未从 DOM 中删除的按钮的祖先。例如：

```
$("#message_area").on("click", "#yourButton", function() {
    //Do stuff
}); 
```

这是有效的，因为 DOM 事件通过所有元素的祖先在树中冒泡。在这里，您只是在树的较高位置捕获事件并检查它是否源自您感兴趣的事物 ( `#yourButton`)。

有关更多信息，请参见 jQuery [`.on`](http://api.jquery.com/on/)。请注意，如果您使用的 jQuery 版本低于 1.7，则需要[`delegate`](http://api.jquery.com/delegate/)改用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:01:44.243

```
//jquery >= v1.7
$("body").on('click', '#new', function(){
    $('#message_area').load('new.php');
});

//jquery < v1.7
$("#new").live('click',function(){
    $('#message_area').load('new.php');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T16:01:58.783

```
$("#new").live("click", function(){
$('#message_area').load('new.php');
}); 
```

刚刚意识到这已被弃用-应该使用 on 代替……我的错。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T16:04:29.197

要像这样管理动态创建的元素，您需要使用[.on()](http://api.jquery.com/on/)（jQuery 1.7 及更高版本）或[.delegate()](http://api.jquery.com/delegate/)（jQuery 1.4.3 及更高版本）来分配事件。似乎每个人都击败了我的代码，但我会发布这个以获得函数的链接。

# c - 两点之间的测地线距离

> ID：10301600
> 
> 赞同：0
> 
> 时间：2012-04-24T15:59:29.543
> 
> 标签：c

C中是否有一个库可以计算两点之间的测地线距离？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T19:14:26.623

通常不需要计算精确到厘米的测地线距离，因为您必须将本地地理建模到相同的比例。

有两种情况我可以想到可能需要这种准确性：

*   您实际上对直线距离感兴趣并且知道准确的坐标，包括海拔高度
*   您正在使用玩具模型并且对一般属性感兴趣，而不是实际适用性

在第一种情况下，我会从地理坐标转换`(φ,λ,h)`为地心圆柱坐标`(r,z,λ)`

```
r = (a²/k + h)·cosφ
z = (b²/k + h)·sinφ
λ = λ 
```

在哪里

```
k = √(a²·cos²φ + b²·sin²φ) 
```

在第二种情况下，我会使用[Vincenty's formulas](http://www.movable-type.co.uk/scripts/latlong-vincenty.html)。

[您可以在我的 bitbucket account](https://bitbucket.org/cggaertner/geo/src)下找到（希望是正确的）这两种算法的 C 实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:21:19.847

是的，我已将 GeographicLib 中的测地线例程移植到 C。请参阅 [http://geographiclib.sourceforge.net/html/C/index.html](http://geographiclib.sourceforge.net/html/C/index.html)

# php - MYSQL 插入语法错误

> ID：10301606
> 
> 赞同：-1
> 
> 时间：2012-04-24T16:00:02.747
> 
> 标签：php, mysql, syntax

我有两个代码可以将数据放入数据库，但它会产生错误，请查看下面的代码。

```
$email = "example@hotmail.com"; //email

$pass = "helloworld";  //password

$fname = "Example";  //first name

$lname = "Man"; //last name

$birth = "2012-2-1"; //birthday

$gender = "male"; //gender

$site_prefix = "my_"; //table prefix 
```

此代码不起作用并输出错误

```
$sql = "
INSERT INTO `{$site_prefix}login` (`email`,`pass`) 
VALUES ('$email','$pass');
INSERT INTO `{$site_prefix}users` (`fname`,`lname`,`birthday`,`gender`)
VALUES ('$fname','$lname','$birth','$gender')";

mysql_query($sql,$con) or die(mysql_error()); 
```

**错误** 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册以获取正确的语法，以便在第 2 行的 'INSERT INTO my_users ( `fname`, `lname`, `birthday`, `gender`) VALUES ('Example','Ma' 附近使用

此代码正常工作

```
$sql = "INSERT INTO `{$site_prefix}login` (`email`,`pass`) VALUES ('$email','$pass');";

$sql1 = "INSERT INTO `{$site_prefix}users` (`fname`,`lname`,`birthday`,`gender`) VALUES ('$fname','$lname','$birth','$gender')";

mysql_query($sql,$con) or die(mysql_error());
mysql_query($sql1,$con) or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:03:46.257

`mysql_query`不能在一个查询中处理多个语句。

从[文档](http://php.net/manual/en/function.mysql-query.php)：

> `mysql_query()`向服务器上与指定链接标识符关联的当前活动数据库发送唯一查询（不支持多个查询**）**

如果您需要此功能，请使用`mysqli`(with )。[`mysqli_multi_query`](http://www.php.net/manual/en/mysqli.multi-query.php)

# jquery - jQuery tableSorter 不排序前两行

> ID：10301618
> 
> 赞同：0
> 
> 时间：2012-04-24T16:00:58.513
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-3, html-helper

我正在使用带有 MVC 3 的 tablesorter 和 html 助手来填充 a for 每个循环中的列，该循环通过对象中的项目。这工作正常，我的 html 表正在以我想要的方式填充。但我在对员工姓名进行排序时遇到问题，这是表中的第二列，如下所示：

```
 <td class="reviewedEmployee">
                    @Html.TextBox("Employees", item.FirstName + "  " + item.LastName, new { style = "width:auto !important; text-align:center;" })
                </td> 
```

当我单击格式正确以使用表格排序器的“员工”标题时，不会发生排序。但是，当我单击另一列时，例如“审阅者列表”（这是选择列表中的 @Html.ListBox），它会按该列排序。我可以单击返回到“员工”标题，它会进行更改，但它们不是按字母顺序排列的（名字 + 姓氏）。排序也不适用于第一列“年份”，它只显示 2011 年或 2012 年。

这是我的 JS：

```
 $(document).ready(function () {
        $('table.tablesorter').tablesorter({ textExtraction: 'complex' })
          .tablesorterPager({ container: $("#pager"), size: $(".pagesize option:selected").val() });
}); 
```

我尝试删除“Employee”列数据中的空格，并从 tablesorter 中删除了“textExtaction”属性。还有其他想法吗？

**更新：**我在表中的数据是输入标签，所以我需要找出如何按值排序，可能通过添加 tablesorter.AddParser() 方法来返回输入标签内的单元格 .val() 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:26:11.187

**我没有使用 razor 视图呈现的输入**标签，而是使用 HTML 助手从数据库中获取名字和姓氏，这些名字和姓氏在表格中以原始文本的形式出现。由于某种原因，tablesorter 无法对任何有输入的行进行排序。

**修复：**添加一个隐藏字段，其值设置为可见字段的值。

**我的修复：**获取原始文本后，我实现了自己的自定义解析器设置，以按姓氏对列进行排序。

```
 $.tablesorter.addParser({
    id: "lastName",
    is: function (s) {
        return false;
    },
    format: function (s) {
        ret = s.split(' ');
        return ret[ret.length-1]
    },
    type: "text"
}); 
```

此外，我在原始 HTML 中添加了 span 标签以提供样式和其他属性，例如在 jQuery 中选择的类以在提交新数据时更新表。见下文：

```
 //if data is changed, trigger an update on the text boxes to make sure filtering is up to date. 'allocation' is any dynamic field in a row such as textbox
    $(".allocation").change(function () {
        $("#manageReviewsTable").trigger("update");
        $("#manageReviewsTable").trigger("appendCache");
    }); 
```

有任何问题，下方评论！

# c# - 在 winforms 中扩展 TreeNode 功能

> ID：10301623
> 
> 赞同：1
> 
> 时间：2012-04-24T16:01:03.340
> 
> 标签：c#, winforms

我的 winform 上有一个 TreeView，它使用 TreeNode 的子类和一些我想针对每个节点存储的附加变量。用户可以使用上下文菜单从我的树中删除节点。

我想做的是扩展 TreeNode 的 Remove 方法，以便在删除节点之前在那里进行一些额外的处理。有没有办法做到这一点？

澄清...

有没有办法扩展 TreeNode 的现有 Remove 方法，以便可以在实际执行删除之前执行代码？

干杯，

编辑：我实际上假设我必须这样做的方式是使用一个调用 this.Remove() 的新方法来扩展类？

编辑2：这就是我最终做的。是不是最好的办法...

```
public partial class CustomTreeNode : TreeNode
{
    // My custom TreeNode vars
    public int UID;
    public int ParentUID;

    public CustomTreeNode(string nodeName) : base(nodeName)
    {
        // Set the tree node here
    }

    public void RemoveIt()
    {
        // Custom stuff
        System.Console.WriteLine("Deleted");

        base.Remove();
    } 

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:07:17.603

在你的子类中试试这个

```
public new void Remove() 
{ 
    //do your custom stuff

    base.Remove();  // calls the TreeNode Remove method
} 
```

编辑：添加了新的删除覆盖

请注意，每当您将子类对象引用为 TreeNode 时，您的自定义 Remove 方法将不会被调用 [new 和 override 之间的区别](https://stackoverflow.com/questions/1399127/c-new-versus-override)

您还可以将函数命名为其他名称，如下所示：

```
public void SuperRemove() 
{ 
    //do your custom stuff

    base.Remove();  // calls the TreeNode Remove method
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:47:21.787

您正在从上下文菜单中删除节点。为什么不向 MenuItem_Click 事件处理程序添加一些额外的处理？在调用节点的 Remove 之前，您可以在那里做任何事情。

# c# - 这种访问修饰符的方法的目的是什么？

> ID：10301632
> 
> 赞同：7
> 
> 时间：2012-04-24T16:01:44.327
> 
> 标签：c#, access-modifiers

考虑以下代码：

```
 private string _text = null;
    private string[] _values = null;

    public string Text { get { return _text; } }
    public string[] Values { get { return _values; } } 
```

这能完成什么只有公众成员不能完成的事情？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-24T16:03:18.830

通过使用属性而不是公共字段，您可以隐藏实现。

如果在某些时候您需要更改 Text 和 Values 属性返回的内容，您可以在不更改类 API 的情况下更改行为。

此外，此习惯用法将外部对公开数据的访问限制为只读。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-24T16:03:28.533

这是使值只读，尽管我更倾向于这样写：

```
public string Text { get; private set;}
public string[] Values { get; private set; } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-24T16:03:11.767

此代码将允许外部实体读取您的值，而您的代码在内部可以修改支持字段。

您可以使用自动属性来简写：

```
public string Text { get; private set; }
public string[] Values { get; private set; } 
```

使用公共字段，您将无法同时防止外部修改和支持内部修改。

即使您想将字段公开为外部可写，我仍然建议将事物封装在属性中 - 您永远不知道是否需要在不破坏外部合同的情况下在内部支持某些内容（set/get 中的自定义代码为您提供空间做这个）。

更不用说大多数数据绑定框架看不到字段，只有属性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-24T16:03:23.297

和只能在定义它们的类中设置，但它们的值可以通过属性访问`_text`。`_values`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-24T16:18:22.283

在您的示例中，它将属性设置为只读，但也有其他用途。

```
public string Text { get { return _text; } } 
```

如果您想在内部进行一些操作`return_text`，然后针对 proeperty 返回它，`Text`您可以使用类似的方法。

```
public string Text { get { return _text.ToUpper(); } } 
```

这是字段[封装](http://msdn.microsoft.com/en-us/library/ms173109.aspx)

> 封装有时被称为面向对象编程的第一支柱或原则。根据封装原则，类或结构可以指定其每个成员对类或结构之外的代码的可访问性。可以隐藏不打算从类或程序集外部使用的方法和变量，以限制编码错误或恶意攻击的可能性。

考虑以下示例：

```
// private field
    private DateTime date;

    // Public property exposes date field safely.
    public DateTime Date 
    {
        get 
        {
            return date;
        }
        set 
        {
            // Set some reasonable boundaries for likely birth dates.
            if (value.Year > 1900 && value.Year <= DateTime.Today.Year)
            {
                date = value;
            }
            else
                throw new ArgumentOutOfRangeException();
        }

    } 
```

在此示例中，有一个私有字段`date`通过 property 公开`Date`。现在，如果您想设置日期的边界，那么您可以看到属性的设置部分。

# javascript - 如何在 chrome 中获取书签图标？

> ID：10301636
> 
> 赞同：6
> 
> 时间：2012-04-24T16:01:54.460
> 
> 标签：javascript, google-chrome, google-chrome-extension

当我使用：

```
<img src="chrome://favicon/http://www.google.com.hk"/> 
```

在我的扩展中。它出了点问题。它警告

“不允许加载本地资源：chrome://favicon/http://www.google.com.hk”

我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T03:17:24.997

仔细检查以确保您已添加`"chrome://favicon/"` [权限](http://code.google.com/chrome/extensions/manifest.html#permissions)。

这是一个`"manifest_version" : 2`扩展吗？我不熟悉它们，但它们可能要求您指定允许这样做的[内容安全策略。](http://code.google.com/chrome/extensions/contentSecurityPolicy.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-15T02:09:13.310

I met the same problem. I tried and see that chrome://favicon/ only work with extension own pages such as popup or tabs your extension created. It doesn't work if you load it in the normal tabs from injected content script.

There are several ways if you want to load favicon from injected content script

1.  The first ones is to use request to some sevices to get favicon of a web. For an example: [http://www.google.com/s2/favicons?domain=https://stackoverflow.com/](http://www.google.com/s2/favicons?domain=https://stackoverflow.com/) This way works fine except the content script is injected in pages which are loading via https. The reason is due to [Mixed Content blocking](https://wiki.millersville.edu/display/d2ldocs/Understanding+mixed+content)

2.  The second ones is to load favicon in background from chrome://favicon/ then transfer to content script.

Example: This function is used to run in background script

```
function fetchFavicon(url) {
    return new Promise(function(resolve, reject) {
        var img = new Image();
        img.onload = function () {
            var canvas = document.createElement("canvas");
            canvas.width =this.width;
            canvas.height =this.height;

            var ctx = canvas.getContext("2d");
            ctx.drawImage(this, 0, 0);

            var dataURL = canvas.toDataURL("image/png");
            resolve(dataURL);
        };
        img.src = 'chrome://favicon/' + url;
    });
} 
```

I'm using this way for my extension, and it's working fine. Please take a look at [Super Focus Tabs](https://chrome.google.com/webstore/detail/super-focus-tabs/blecebkjfbkpannnmajllilknpccheak) extension.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-03-11T12:44:51.117

有同样的问题，在[谷歌开发者网站](https://developer.chrome.com/extensions/permission_warnings#nowarning)上搜索后发现你需要`chrome://favicon/`在`manifest.json`.

然后只需转到`chrome://extensions`并按重新加载即可读取清单更改。

> 注意：斜线很重要！

# postgresql - 杀死“CLUSTER ON index”对数据库有危险吗？

> ID：10301648
> 
> 赞同：0
> 
> 时间：2012-04-24T16:02:46.380
> 
> 标签：postgresql, kill, clustered-index

所有问题都在标题中，

如果我们在一个 1 亿行的表上杀死一个集群查询，对数据库会不会很危险？

查询现在运行了 2 个小时，我需要明天早上访问该表（希望还剩 12 小时）。

我认为它会快得多，我的数据库在 raid ssd 和 Bi-Xeon 处理器上运行。

感谢您的明智建议。

席德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:12:50.947

不，您可以毫无风险地终止集群操作。在操作完成之前，原始表和索引文件没有任何变化。从[手册](http://www.postgresql.org/docs/current/static/sql-cluster.html)：

> 使用索引扫描时，会创建一个表的临时副本，其中包含按索引顺序排列的表数据。还会创建表上每个索引的临时副本。因此，您需要磁盘上的可用空间至少等于表大小和索引大小的总和。
> 
> 当使用顺序扫描和排序时，还会创建一个临时排序文件，因此峰值临时空间需求是表大小的两倍，加上索引大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:38:35.647

正如@Frank 指出的那样，这样做完全没问题。

假设您想在将来运行此查询并假设您拥有服务窗口的奢侈并且可以承受一些停机时间，我会调整一些设置以稍微提高性能。

在您的配置中：

1.  关闭 fsync，以获得更高的文件系统吞吐量

Fsync 代表文件系统同步。开启 fsync 后，数据库等待文件系统在每次页面刷新时提交。

1.  最大化您的maintenance_work_mem

可以只占用所有可用内存，因为它不会在生产时间分配。我不知道你的表和你正在处理的索引有多大，当它们可以完全加载到主内存中时，它们会运行得更快。

# sql - SELECT 查询以哪个顺序返回结果？

> ID：10301649
> 
> 赞同：1
> 
> 时间：2012-04-24T16:02:57.293
> 
> 标签：sql, database

有人可以向我解释 SELECT 如何返回结果吗？当我一遍又一遍地运行相同的查询（可能在更新某些字段之后）返回结果时，它是否保留了顺序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:22:18.073

没有特定的顺序（除非您指定`ORDER BY`子句）。

当他们写在手册中时，他们是认真的。

根据特定的实现`RDBMS`，`SELECT`查询可以更改其统计重新计算计划，作为表空间重新分配的结果，作为查询并行化更改的结果以及一百万个其他原因。

即使您对表什么都不做，并且一个接一个地运行两个完全相同的查询，这些记录也可能以完全不同的顺序返回。

# xcode - 通过同一类的方法使用类方法的Xcode错误

> ID：10301654
> 
> 赞同：0
> 
> 时间：2012-04-24T16:03:13.063
> 
> 标签：xcode, pointers, casting, xcode4.2, class-method

我有一个具有类方法“getSimulatedPricesFrom”的类。它将在执行期间从同一类调用方法“projectFromPrice”。但是在 sTPlus1 行中，我遇到了 2 个错误：

```
1) Class method "projectFromPrice" not found

2) Pointer cannot be cast to type "double" 
```

有谁知道为什么？我已经在 .h 文件中声明了该方法 下面是 AmericanOption.m 文件中编码的一部分：

```
#import "AmericanOption.h"

@implementation AmericanOption

+(NSMutableArray*)getSimulatedPricesFrom:(double)s0 withRate:(double)r0 withVol:(double)v0 withDays:(int)D withPaths:(int)N
{
    double daysPerYr = 365.0;
    double sT;
    double sTPlus1;
    sT = s0;
...
    sTPlus1 = (double)[AmericanOption projectFromPrice:sT, r0/daysPerYr, v0/daysPerYr, 1/daysPerYr];
...
    return arrPricePaths;
}

+(double)projectFromPrice:(double)s0 withRate:(double)r0 withVol:(double)v0 withDt:(double)dt
{
    ...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:07:20.730

看起来您应该按如下方式调用 projectFromPrice 方法：

```
sTPlus1 = [AmericanOption projectFromPrice:sT 
                                  withRate:r0/daysPerYr 
                                   withVol:v0/daysPerYr 
                                    withDt:1/daysPerYr]; 
```

在您的示例代码中，您只是提供了一个逗号分隔的参数列表。您应该使用该方法的命名参数。

这两个错误中的第一个是因为方法`projectFromPrice:`与方法不同`projectFromPrice:withRate:withVol:withDt:`。

`projectFromPrice:withRate:withVol:withDt:`是实际存在的方法，并且可能在您的接口（.h 文件）中定义。`projectFromPrice:`是您尝试调用但不存在的方法。

第二个错误是编译器假设未定义`projectFromPrice:`方法返回的`id`（指针）不能转换为双精度的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:09:59.103

这就是您调用第二种方法的方式，这似乎是问题所在。试试这个，而不是：

```
+(NSMutableArray*)getSimulatedPricesFrom:(double)s0 withRate:(double)r0 withVol:(double)v0 withDays:(int)D withPaths:(int)N
{
    double daysPerYr = 365.0;
    double sT;
    double sTPlus1;
    sT = s0;
...
    sTPlus1 = (double)[AmericanOption projectFromPrice:sT withRate:r0/daysPerYr withVol:v0/daysPerYr withDt:1/daysPerYr];
...
    return arrPricePaths;
}

+(double)projectFromPrice:(double)s0 withRate:(double)r0 withVol:(double)v0 withDt:(double)dt
{
    ...
} 
```

# sqlyog - SQLyog (webyog) 更改 root 的表访问权限

> ID：10301655
> 
> 赞同：0
> 
> 时间：2012-04-24T16:03:13.950
> 
> 标签：sqlyog

我们有超过 1 个使用 SQLyog (webyog) 的用户，我们都使用 root 登录，最近我注意到一些机密数据已经从我工作的 1 个表中泄露。我已被指示对此进行调查。我可以使用来自 root 的新用户帐户保护此表吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:24:11.080

**立即更改root密码。**

鉴于您的情况，您的雇主应对几起事件负责。

如果该服务器上存储了任何类型的机密信息，则只有经过适当培训和分类的人员才能访问所述信息。

您应该为每个员工（或每个员工类型 [例如：'root'、'accounting'、'library'、'developer']）创建一个新用户并相应地授予权限。

唯一具有全局访问权限的用户应该是 root，并且可能是您可能创建的任何开发人员帐户。

其他人应该只能访问他们需要的表，并且只能访问基本的 CRUD（创建、更新、删除）功能。您的会计师可能知道基本的 SELECTing 语句，但他不应该 DROPping 表。

# objective-c - 什么是 Objective-C “类延续”？

> ID：10301661
> 
> 赞同：8
> 
> 时间：2012-04-24T16:03:23.660
> 
> 标签：objective-c, class, variables, syntax, automatic-ref-counting

我不太清楚我所看到*的所谓*的 Objective-C **“类延续”**。这是/是这些吗……</p>

1.  `@implementation`在( ) 文件中声明的 Ivar(s) `.m`？
2.  类类别的另一个名称？（不太可能，*ASFAIK*类别不能有 Ivar，句号）
3.  类扩展的另一个名称？
4.  还有什么？

*那就是说...*

1.  这种东西的范围、生命周期和用例是什么？
2.  这是 ARC 特有的“功能”吗？
3.  它们的使用是否有特定的运行时或其他要求？
4.  这也是创建 的合适地方`@property`吗？为什么这比`@interface`文件/声明更适合设置 ivars 或属性？
5.  为什么人们通过使用这样的特定术语使讨论复杂化——这似乎不存在于任何官方文档（我能找到）中？

有问题[在Objective-C中，在头文件中定义某些东西（比如属性）与在.m文件中定义有什么区别？](https://stackoverflow.com/questions/9042480/in-objective-c-what-is-the-difference-between-defining-something-say-a-property) 讨论涉及到这个问题，但有点只是进一步混淆了这个问题 - 或者至少没有提供该术语的规范参考/定义......因此这个问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T16:12:28.330

*延续类*是Apple 所说的[*类扩展*](http://developer.apple.com/library/ios/documentation/cocoa/conceptual/objectivec/Chapters/ocCategories.html#//apple_ref/doc/uid/TP30001163-CH20-SW2)。我见过 clang 称它们为“延续类”，而 gcc 使用“类延续”。

在 clang 或 gcc 中编译：

```
@interface Foo : NSObject
@property int a;
@end

@interface Foo()
@property float a;
@end 
```

...你会得到有趣的名字的错误。

要回答您的其余问题：

> 1.  这种东西的范围、生命周期和用例是什么？

扩展用于声明类的私有接口。您还可以使用它来重新声明（优化）公共属性声明。

> 2.  这是 ARC 特有的“功能”吗？

不。

> 3.  它们的使用是否有特定的运行时或其他要求？

类扩展是一个编译时概念，不需要特殊的运行时。当然，它们确实需要一个支持它们的编译器（clang 和 gcc 在当前版本中都支持）。

> 4.  这也是创建@property 的合适位置吗？为什么这比 @interface 文件/声明更适合设置 ivars 或属性？

是的。因为您可能想要拥有私有财产。

> 5.  为什么人们通过使用这样的特定术语使讨论复杂化——这似乎不存在于任何官方文档（我能找到）中？

嗯，你知道...如果全世界都说英语，我也更喜欢，但目前我很高兴我必须在学校学习英语。

# web-services - 在线/云端特殊功能计算？

> ID：10301669
> 
> 赞同：0
> 
> 时间：2012-04-24T16:03:47.607
> 
> 标签：web-services, function, cloud, computer-science, distributed-computing

有人知道任何提供特殊功能计算的网络服务吗？例如，假设我的（不复杂的）客户需要在 x 值列表中计算零阶修正贝塞尔函数。我可以为他们编写一些 C 或 Python 代码来做到这一点，但他们可能会觉得这有点吓人。他们宁愿将其输入网页。所以我可以给他们写一个简单的webapp。但是后来我想知道，这样的事情不是已经存在了吗？

有人知道吗？如果没有，应该有人创建它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T17:39:23.397

[Wolfram Alpha](http://www.wolframalpha.com/)是您正在寻找的网站，它可以计算几乎所有您想要的东西。它是由创建 Mathematica 的人创建的。

# java - 将 EditText.getText() 发送到服务器。仅适用于单个单词。如何？

> ID：10301671
> 
> 赞同：0
> 
> 时间：2012-04-24T16:03:51.407
> 
> 标签：java, android, http, android-edittext

我为消息传递应用程序设置了一个非常简单的设置。我只是从 EditText 框中获取文本并将其作为参数传递给将其添加到我的数据库的 php 页面。它非常适用于一个单词条目。我在 EditText 框中输入空格的那一刻它不起作用。我对 Android 还是很陌生。我真的不明白这怎么可能发生。有谁知道这怎么会发生？

这是我的 onClick 方法：

```
 public void sendMessage(View v) {
Log.d("tag", "XXXXXXXXXXXXXXXXXXXXXX");
        final SharedPreferences prefs = PreferenceManager
                .getDefaultSharedPreferences(getBaseContext());

        username = prefs.getString("username", "null");

where = prefs.getString("chat", "null");
        message = (EditText) findViewById(R.id.inptbox);

        function = new Functions();
        Editable messagetext;
messagetext = message.getText();

                response = function.sendMessage(username, where, messagetext.toString());
String theresponse = "";
theresponse = response;
                if (theresponse.compareTo("0") == 0) {
                    Toast.makeText(getApplicationContext(), "Success!",
                            Toast.LENGTH_SHORT).show();
                    //message.setText(null);

                } else if (response.compareTo("9") == 0) {

                    // userent.setText("nine");

                }

    } 
```

我的函数.sendMessage：

```
 public String sendMessage(String username, String where, String string){

        BufferedReader in = null;
        String data = null;
        try{

            HttpClient client = new DefaultHttpClient();
            URI website = new URI("http://abc.com/user_send.php?username="+username+"&where="+where+"&message="+string);

            HttpPost post_request = new HttpPost();
            post_request.setURI(website);

            HttpGet request = new HttpGet();

            request.setURI(website);
            //executing actual request

                        //add your implementation here
            HttpResponse response = client.execute(request);

            in = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));
            StringBuffer sb = new StringBuffer("");
            String l = "";
            String nl = System.getProperty("line.separator");
            while ((l = in.readLine()) != null) {
                sb.append(l+nl);

            }
            in.close();
            data = sb.toString();

return data;
        }catch (Exception e){
            return "ERROR";

        }

        } 
```

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:40:05.117

您必须对您的消息进行编码以使其“URL 安全”。空格（和其他特殊字符）不能出现在 URL 中；`%20`这就是为什么如果您在地址栏中键入空格，您的浏览器会将空格替换为。在 function.sendMessage() 中尝试以下操作：

```
URI website = new URI("http://abc.com/user_send.php?username="+username+"&where="+where+"&message="+URLEncoder.encode(string, "UTF-8")); 
```

注意最后使用[URLEncoder](http://developer.android.com/reference/java/net/URLEncoder.html)。

# java - 在Android中保存文件，文件名中有空格

> ID：10301674
> 
> 赞同：6
> 
> 时间：2012-04-24T16:04:13.437
> 
> 标签：java, android, filenotfoundexception

我需要我的 android 应用程序将 xml 文件保存到外部缓存中，文件名包含空格。

```
DOMSource source = new DOMSource(doc);
StreamResult result = new StreamResult(new File(activity
                    .getExternalCacheDir().getAbsolutePath()
                    + "/Local storage.xml"));

transformer.transform(source, result); 
```

当我手动浏览到我的文件目录时，我找到了这个文件：“Local%20storage.xml”。

所以当我尝试阅读它之后

```
File localStorageXmlFile = new File(activity.getExternalCacheDir()
                .getAbsolutePath()
                + "/Local storage.xml"); 
```

但我有一个 FileNotFoundException，因为在我的设备上找不到文件“Local storage.xml”。

有什么想法可以解决这个问题吗？塞布

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T08:34:46.230

很难确定这个问题的根源，但它来自 StreamResult，它将文件名中的空格替换为 %20。[这里](https://bugs.eclipse.org/bugs/show_bug.cgi?id=194359)有一个关于这个问题的错误报告。

这是解决方案：

```
TransformerFactory transformerFactory = TransformerFactory.newInstance();
Transformer transformer = transformerFactory.newTransformer();
DOMSource source = new DOMSource(doc);

FileOutputStream fos = null;
try {
    fos = new FileOutputStream(new File(activity
                .getExternalCacheDir().getAbsolutePath()
                + "/" + "Local storage" + ".xml"));
    Result fileResult = new StreamResult(fos);
    transformer.transform(source, fileResult);
} catch (FileNotFoundException e) {
    e.printStackTrace();
} finally {
    if (fos != null) {
        fos.close();
    }
} 
```

再次感谢你们两位尝试解决我的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-12T15:46:46.310

这对我有用，只是额外的一行代码

```
String fileName = "name with spaces" + ".xml";                  
fileName.replace(" ", "\\ "); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T16:10:01.387

尝试使用基本的 URL 编码：

```
File localStorageXmlFile = new File(activity.getExternalCacheDir()
                .getAbsolutePath()
                + "/Local%20storage.xml"); 
```

这个mgiht帮助你：[URL编码表](http://www.blooberry.com/indexdot/html/topics/urlencoding.htm)

此外，在处理文件时，请确保您为操作系统使用了正确的文件分隔符（在您的情况下，硬编码 / 应该可以工作，因为 Android 是基于 linux 的，但只是为了确保。这可能是另一种选择：

```
File localStorageXmlFile = new File(activity.getExternalCacheDir()
                .getAbsolutePath() + File.separator 
                + "Local storage.xml"); 
```

最后的选择是尝试腾出空间。尝试将“”替换为“\”。

# java - 扩展类的调用函数

> ID：10301676
> 
> 赞同：2
> 
> 时间：2012-04-24T16:04:21.013
> 
> 标签：java, class, function, call

我想调用一个扩展类的函数。如何才能做到这一点？

```
class Main{
    Function();
}

class Other extends Main{
    public void Function() { /* The function code */ }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:13:12.277

```
public class BaseCls {
    void function() {
        System.out.println("Base");
    }
}

public class ExtCls extends BaseCls {
void function() {
    super.function();
    System.out.println("ExtCls");
}

public static void main(String args[]) {
    new ExtCls().function();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:29:22.950

Class `Main` has no special privileges with regard to what is in Class `Other` that is not in Class `Main`. Also, a `Main` object is not necessarily an `Other` object. So you need to define the behavior when the an object of Class `Main` call `Function()`. You can either

*   Declare `Function()` to be abstract, meaning you cannot create an object of Class `Main` and class `Other` is forced to define `Function()` or be abstract itself, or
*   Declare a default implementation in Class `Main` that works for objects that are `Main`s and not `Other`s.

Either way is acceptable depending on the situation. You have to give more details if you want help choosing which one is better in your situation.

Example:

```
class Main {
    public abstract void Function();    

    private void SomeFunction() {
        Function();
    }
}

class Other extends Main {
    public void Function() { /* code here */ }

} 
```

or

```
class Main {
    public void function() { /* default code here, can be empty */ };    

    public void someFunction() {
        function();
    }
}

class Other extends Main {
    public void function() { /* code here */ }

}

class Example {
    public void example() {
        Main main = new Main();
        Other other = new Other();

        main.function(); // call the function defined in class Main
        other.function(); // call the function defined in class Other

        main.someFunction(); // call Main.someFunction, which calls Main.function
        other.someFunction(); // call Main.someFunction, which calls Other.function
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T16:05:17.350

可以定义`Main`为抽象类，也可以定义`function()`为抽象方法，在`Other`子类中实现。但是，在某些时候，您必须创建 的实例`Other`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T16:08:15.020

```
class Main {
    public void Function() { F2(); }

    public abstract void F2();
}

class Other extends Main {
    public void F2() { /* code here */ }
} 
```

# ssas - SSAS 和 OLAP 多维数据集：两次相同的度量

> ID：10301677
> 
> 赞同：0
> 
> 时间：2012-04-24T16:04:28.037
> 
> 标签：ssas, mdx, olap, business-intelligence, measure

我在 OLAP Cube + MDX 方面不是很有经验，而且我很难尝试在一个多维数据集中使用两次相同的度量。

假设我们有 3 个维度：`D_DATE`，`D_USER`和`D_TYPE_OF_SALE_TARGET`3 个事实表：`F_SALE`，`F_MEETING`，`F_SALE_TARGET`

*   `F_SALE`与`D_USER`（谁进行销售）和`D_DATE`（何时）相关联
*   `F_SALE_TARGET`链接到`D_USER`, `D_DATE`, `D_TYPE_OF_SALE_TARGET`（意思是：用户必须达到给定月份的各种目标/指标）。

我可以浏览我的立方体：

*   行数 = 日期 * 用户
*   Cols = 销售数量，销售总额 + 1 个目标的值（在`WHERE`子句中，我过滤`[Dim TYPE SALE TARGET].[Code].&[code.numberOfSales]`）

如何为其他目标添加其他列？由于所有目标都在同一个表中，我看不到如何从`[Measures].[Value - F_SALE_TARGET]`链接到不同代码中添加第二个度量，即。`[Dim TYPE SALE TARGET].[Code].&[code.amountOfSale]`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:58:03.603

您的问题对我来说并不清楚，但似乎实现这一目标的一种方法是创建计算成员。基本上，在 BIDS 中选择您的多维数据集，转到“计算”选项卡并创建“计算成员”。您可以在那里插入您的 MDX 查询。对于每种目标类型，您可以创建不同的计算，例如：([Measures].[Value - F_SALE_TARGET], [Dim TYPE SALE TARGET].[Code].&[code.amountOfSale])

# quickdialog - QMultilineElement 不调用 QEntryDidEndEditingElement：委托

> ID：10301679
> 
> 赞同：0
> 
> 时间：2012-04-24T16:04:33.103
> 
> 标签：quickdialog

我正在尝试使用 QuickDialog (github.com/escoz/QuickDialog) 制作一个 tablew 视图，显示一些调试信息，比如常量的值等。大多数值都是长 URL，所以我不能使用 QLabelElement。QMultilineElement 似乎对此很完美，但我需要知道用户何时修改推送的文本视图的文本，但我不知道该怎么做。

QMultilineElement 有一个委托属性，但我无法调用它。查看代码在我看来，该委托仅适用于 QLabelElement，是真的吗？我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T15:05:06.757

我相信我最终实现了这个，不是吗？你确定吗？

# shared-libraries - 使用 mpicc 创建共享对象 - 似乎找不到 pthread 例程

> ID：10301681
> 
> 赞同：1
> 
> 时间：2012-04-24T16:04:35.293
> 
> 标签：shared-libraries, openmpi

我正在学习在 Linux 中创建共享库，随后开发并行科学计算程序。我从[这里](http://codingfreak.blogspot.com/2009/12/creating-and-using-shared-libraries-in.html)获取了共享库的玩具示例。[我修改了这个问题](https://stackoverflow.com/questions/10128366/shared-object-library-and-mpi)的 Makefile以适应玩具示例。我的 Makefile 现在是

```
CC        = mpicc

INCDIR    = -I ./

CFLAGS    = -Wall -rdynamic -g -fPIC $(INCDIR)

LIBADD    = -L ./ -lcalc_mean

all: dyn_main.out

dyn_main.out: libcalc_mean.so
    $(CC) -o $@ main.c $(LIBADD)

libcalc_mean.so:    calc_mean.o
    $(CC) -shared --export-dynamic -o $@ $<

calc_mean.o: calc_mean.c
    $(CC) $(CFLAGS) -c $<

clean :
    -rm *.o
    -rm *.out
    -rm *.so

.PHONY:
    clean 
```

当我`CC = gcc`在 Makefile 中使用时，一切正常。即使使用 mpirun，我也可以运行二进制文件。

当我`CC = mpicc`在 Makefile 中时，我收到以下错误。

```
mpicc -Wall -rdynamic -g -fPIC -I ./ -c calc_mean.c
mpicc -shared --export-dynamic -o libcalc_mean.so calc_mean.o
mpicc -o dyn_main.out main.c -L ./ -lcalc_mean
/home/elan/localinstalls/lib/libmpi.so: undefined reference to `pthread_key_create'
/home/elan/localinstalls/lib/libmpi.so: undefined reference to `pthread_getspecific'
/home/elan/localinstalls/lib/libmpi.so: undefined reference to `pthread_create'
/home/elan/localinstalls/lib/libmpi.so: undefined reference to `pthread_atfork'
/home/elan/localinstalls/lib/libmpi.so: undefined reference to `pthread_setspecific'
/home/elan/localinstalls/lib/libmpi.so: undefined reference to `pthread_join'
collect2: ld returned 1 exit status
make: *** [dyn_main.out] Error 1 
```

我将 libpthread.so、.a 的路径添加到 LD_LIBRARY_PATH，但无济于事。我有一个自编译的 openmpi-1.5.4。如果这是一个 openmpi 依赖项，那么我配置它时不应该已经解决了吗？

这个错误熟悉吗？我正在使用带有 gcc 4.5.2 的 Ubuntu 11.04。我已经成功构建并运行了一些 mpi 并行程序。但它们是配置了自动工具的大型软件包。config.log 之一显示相同的错误。但即使那个运行良好。

对使用 mpi 创建静态/共享库的参考/示例也将不胜感激（尽管 Openmpi 不鼓励完全静态库。）

非常感谢你，

艾伦。

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T14:43:41.643

您应该可以只添加 -lpthread。

Open MPI 可能没有添加它，因为它发现添加 -lpthread 不是必需的（可能是由于其他一些隐式拉入 pthread 库的依赖项）。但是使用您正在使用的链接器标志，您很可能已经更改了隐式依赖项，因此 pthread 库不再被自动拉入。

如果将 -lpthread 添加到命令行可以解决问题，请参阅此常见问题解答条目以了解如何更新包装编译器（例如，添加您自己的标志）：[http ://www.open-mpi.org/faq/?category= mpi-apps#override-wrappers-after-v1.0](http://www.open-mpi.org/faq/?category=mpi-apps#override-wrappers-after-v1.0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T12:55:45.103

`-showme`您可以使用选项或其特定变体之一查看 Open MPI 编译器包装器为底层编译器和链接器提供哪些选项：

*   `-showme:compile`只显示编译器标志
*   `-showme:link`只显示链接器标志

例如：

```
$ mpicc -showme
icc -I/opt/MPI/openmpi-1.5.3/linux/intel/include -I/opt/MPI/openmpi-1.5.3/linux/intel/include/openmpi -fexceptions -pthread -I/opt/MPI/openmpi-1.5.3/linux/intel/lib -Wl,-rpath,/opt/MPI/openmpi-1.5.3/linux/intel/lib -I/opt/MPI/openmpi-1.5.3/linux/intel/lib -L/opt/MPI/openmpi-1.5.3/linux/intel/lib -lmpi -ldl -Wl,--export-dynamic -lnsl -lutil 
```

# android - LoaderCallbacks.onLoadFinished() 从来没有用 FragmentPager 调用过？

> ID：10301682
> 
> 赞同：1
> 
> 时间：2012-04-24T16:04:35.863
> 
> 标签：android

我正在使用 FragmentPagerAdapter 来实现选项卡式界面。我的第 0 个片段在创建时创建了一个加载器，并尝试在 onActivityCreated() 中重新连接到加载器。这是课程：

```
public class My0thFragment extends Fragment {
    private boolean ranOnce = false;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setRetainInstance(true); 
    }

    @Override
    public void onActivityCreated() {
        if (!ranOnce) {
            // if the first time we're being created, do an initial load of data.
            getLoaderManager().initLoader(500, null, mMyCallback).forceLoad();
            ranOnce = true;
        } else {
            // reconnect?
            getLoaderManager().initLoader(500, null, mMyCallback);

            // sanity check.
            printAllLoaders(getLoaderManager());
        }
    }

    private LoaderManager.LoaderCallbacks<Foo> mMyCallback = new LoaderManager.LoaderCallbacks<Foo>() {
        @Override
        public Loader<Foo> onCreateLoader(int arg0, Bundle arg1) {
            return new FooLoader(getActivity(), arg1);
        }

        @Override
        public void onLoadFinished(Loader<Foo> arg0, Foo arg1) {
            Log.e(tag, "onLoadFinished()!");
        }

        @Override
        public void onLoaderReset(Loader<Foo> arg0) {
            Log.e(tag, "onLoaderReset()!");
        }
    };
} 
```

这是场景：

1.  App启动，在FragmentPagerAdapter中创建了第0个fragment。
2.  调用 onActivityCreated() 方法，该方法在第一次运行时创建并启动加载程序。
3.  在加载程序完成之前，我快速切换到另一个选项卡。
4.  我可以通过日志看到加载程序完成，但我的回调永远不会得到 onLoadFinished() 回调。我认为这是因为片段处于某种分离状态，具体取决于 FragmentPagerAdapter 的工作方式。
5.  返回到第 0 个选项卡，我看到 onActivityCreated() 被调用，并且再次调用了 initLoader() 方法。回调仍然没有触发。
6.  此时我可以打印加载器管理器中的所有加载器，并看到我的加载器仍然坐在加载器管理器中。

所以我被困在这里，我一定做错了什么，因为加载器的东西必须是为我们开发人员考虑到片段生命周期而设计的。谁能指出我在这里做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-13T08:02:42.980

可能你有同一个片段的两个实例，尝试在销毁片段上销毁加载器：

```
protected void onDestroy() {
   if (getSupportLoaderManager().getLoader(0) != null) {
            getLoaderManager().getLoader(0).abandon();
            getSupportLoaderManager().destroyLoader(0);
    }
    super.onDestroy();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T17:43:01.210

不知道你是否解决了你的问题，但你应该在 Fragment.onStart() 上调用 forceLoad() 而不是 Fragment.onActivityCreated()。

myCallback.onLoadFinished() 永远不会被调用，因为在您的片段启动之前，您的“myCallback”实际上并未附加到加载器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T09:13:11.320

请参阅 API Demos 或 Support4Demos 中的示例代码文件[FragmentTabsPager.java](http://developer.android.com/resources/samples/Support4Demos/src/com/example/android/supportv4/app/FragmentTabsPager.html)。它提供了一个 ViewPager 和一个 TabHost 来控制同一组 Fragment。我破解了它以准确涵盖您描述的情况。（你是直接联系我的吗？）需要注意的主要是示例应用程序没有分离 ViewPager 中的 Fragments。

这是我破解它的部分：

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    mTabHost = (TabHost)findViewById(android.R.id.tabhost);
    mTabHost.setup();

    mViewPager = (ViewPager)findViewById(R.id.pager);

    mTabsAdapter = new TabsAdapter(this, mTabHost, mViewPager);

    mTabsAdapter.addTab(mTabHost.newTabSpec("fraga").setIndicator("Fragment A"),
            FragmentA.class, null);
    mTabsAdapter.addTab(mTabHost.newTabSpec("fragb").setIndicator("Fragment B"),
            FragmentB.class, null);

    if (savedInstanceState != null) {
        mTabHost.setCurrentTabByTag(savedInstanceState.getString("tab"));
    }

} 
```

片段 A 是包含加载程序的片段。

# regex - 如何在matlab中检查扩展的ascii字符

> ID：10301683
> 
> 赞同：0
> 
> 时间：2012-04-24T16:04:50.710
> 
> 标签：regex, matlab

有谁知道如何在 matlab 中检测非 ASCII 字符。

我想通过正则表达式检测非 ASCII 字符的存在

```
if (regexpi('hello world%^&%','![A-Z]*'))display('You have non ascii characters') 
```

但它似乎不起作用

更新：-

```
 if (regexpi('hello word','^[A-Za-z0-9]*'))
   display('You have chosen to overwrite!');
   end 
```

显示您已选择覆盖！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:53:16.113

这些字符`%^&` *是*ASCII 字符，它们只是不是*字母*。如果您想测试是否有任何非字母，您可以这样做：

```
if (regexpi('hello world%^&%','[^ A-Z]'))
  display('You have non-letter characters');
end 
```

请注意，我在搜索表达式中包含了一个空格，以便字符串中允许有空格。要允许*任何*空白字符，`'[^\sA-Z]'`请用作搜索表达式。

如果您想检查是否存在[扩展的 ASCII](http://en.wikipedia.org/wiki/Extended_ASCII)字符，您甚至不需要正则表达式。您可以检查字符串中字符的任何数字编码是否大于或等于 128，如下所示：

```
if any('hello world ÁÂÃÄÅ' >= 128)
  display('You have extended ASCII characters');
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T17:26:33.470

检查不可打印的 ascii（包括扩展 ascii）代码

```
[^\s\x{20}-\x{7e}] 
```

仅检查扩展的 ascii 代码

```
[\x{80}-\x{ff}] 
```

# php - jQuery 模态确认

> ID：10301684
> 
> 赞同：1
> 
> 时间：2012-04-24T16:04:53.197
> 
> 标签：php, jquery, html

首先，如果对于那些有更多经验的人来说这是一个非常简单的问题，我深表歉意，但我对此有点陌生，所以我希望有人可以帮助我。

我正在尝试在单击按钮时实现一个 jQuery 模态确认框。这显示在下面的脚本中：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Gallery</title> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
  <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.10/themes/smoothness/jquery-ui.css">
  <link href="Libraries/fancybox/jquery.fancybox-1.3.1.css" rel="stylesheet" type="text/css"/> 
  <link href="Styles/style.css" rel="stylesheet" type="text/css" />
  <!--[if IE]>   
  <link href="Styles/ie.css" rel="stylesheet" type="text/css" /> 
  <![endif]-->
  <script src="Libraries/jquery/jquery-1.4.3.min.js" type="text/javascript"></script> 
  <script src="Libraries/fancybox/jquery.fancybox-1.3.1.pack.js" type="text/javascript"></script> 
  <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.6/jquery-ui.min.js" type="text/javascript"></script>     
  <script type="text/javascript">

  $(function() { $('a.fancybox').fancybox(); }); 

  </script> 

  <script type="text/javascript">
var deleteTheSelectedUrl = '';
$(document).ready(function() {
    // create the jQuery modal window and set autoOpen to false
    $("#jQueryDeleteConfirmationModalWindow").dialog({
        title: "Delete Confirmation",
        autoOpen: false,    // set this to false so we can manually open it
        dialogClass: "jQueryDeleteConfirmationModalWindow",
        closeOnEscape: false,
        draggable: false,
        width: 460,
        height: 260,
        modal: true,
        buttons: {
                "Yes, I'm sure": function() {
                    $( this ).dialog( "close" );
                    if('' != jQuery.trim(deleteTheSelectedUrl)) {
                        window.location = deleteTheSelectedUrl;
                    }
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
        resizable: false,
        open: function() {
            // scrollbar fix for IE
            $('body').css('overflow','hidden');
        },
        close: function() {
            // reset overflow
            $('body').css('overflow','auto');
        }
    }); // end of dialog

    // bind the loading screen to each delete link, assuming you have some kind of way to select them via jQuery
    jQuery('a.deleteConfirmation').click(function() {
        deleteTheSelectedUrl = $(this).attr('href');
        var name = $(this).parent().parent().children('td.name').html(); // a.delete -> td -> tr -> td.name
        name = jQuery.trim(name);
        $("#jQueryDeleteConfirmationModalWindow").html('Are you sure you wish to delete ' + name + '?');
        $("#jQueryDeleteConfirmationModalWindow").dialog('open');
        return false;
    });

});
</script>
  <style type="text/css">
<!--
.style1 {
    font-size: 14px;
    margin-right: 110px;
}
.style4 {font-size: 12px}
-->
  </style>
</head>
<body style="font-family: Calibri; color:  #505050; font-size: 9px; border-bottom-width: thin; margin-top: 5px; margin-left: -476px; margin-right: 1px; margin-bottom: -10px;">
<div align="right" class="style1"> <a href = "javascript:document.gallery.submit()"/> Add Images <a/> &larr; View Uploaded Images </div>
  <form id="gallery" name="gallery" class="page" action="index.php" method="post">  
  <div id="container"> 
    <div id="center"> 
      <div class="aB"> 
        <div class="aB-B"> 
          <?php if ('Uploaded files' != $current['title']) :?>
          <?php endif;?>
          <div class="demo"> 
          <input name="username" type="hidden" id="username" value="IRHM73" />
          <input name="locationid" type="hidden" id="locationid" value="1" />
          <div class="inner"> 
              <div class="container"> 
                <div class="gallery"> 
                  <ul class="gallery-image-list"> 
                  <input type="button" name="deleteimage" value="Delete Selected Image" onclick="jQueryDeleteConfirmationModalWindow"/>
                  <?php for ($i = 0; $i < $descriptions->documentElement->childNodes->length; $i++) : 
                          $xmlFile = $descriptions->documentElement->childNodes->item($i); 
                          $name = htmlentities($xmlFile->getAttribute('originalname'), ENT_COMPAT, 'UTF-8'); 
                          $description = htmlentities($xmlFile->getAttribute('description'), ENT_COMPAT, 'UTF-8'); 
                          //$folder = htmlentities($xmlFile->getAttribute('folder'), ENT_COMPAT, 'UTF-8'); 
                          $source = $galleryPath . rawurlencode($xmlFile->getAttribute('source')); 
                          $thumbnail = $galleryPath . rawurlencode($xmlFile->getAttribute('thumbnail')); 
                  ?>
                    <li class="item"> 
                      <a class="fancybox" target="_blank" rel="original" href="<?php echo $source; ?>"><img class="preview" 
                        alt="<?php echo $name; ?>"  src="<?php echo $thumbnail; ?>" /></a><input type="radio" name="delete" /></li>
                        <p><span class="style4"><b>Image Name:</b> <?php echo htmlentities($xmlFile->getAttribute('originalname'));?> <br />
                          <b>Image Description:</b> <?php echo htmlentities($xmlFile->getAttribute('description'));?> </span><br />  
                          <?php endfor; ?>
                          </li>
                        </p>
                  </ul>
                </div> 
        </div> 
      </div> 
    </div> 
    </div> 
      </div> 
    </div> 
  </div> 
  </form> 
</body> 
</html> 
```

我遇到的问题是，当我单击“删除所选图像”按钮时，我收到此错误：`'jQueryDeleteConfirmationModalWindow' is undefined at line 92`这是

```
<form id="gallery" name="gallery" class="page" action="index.php" method="post"> 
```

我已经重建了几次页面，但我仍然得到同样的错误，但我不知道为什么。

我只是想知道是否有人可以看看这个，让我知道我哪里出错了？

谢谢并恭祝安康

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T16:08:56.267

我没有看到带有 ID 的 div `jQueryDeleteConfirmationModalWindow`。也许我错过了它？jQuery 对话框在现有 div 上执行。

[http://jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

```
<div id="jQueryDeleteConfirmationModalWindow">ARE YOU SURE???</div> 
```

您的`onlclick`事件处理程序应调用函数名称

```
<input type="button" onclick="showDialog()" ... /> 
```

那么你的 JS 将以这种方式访问​​它

```
function showDialog(){
    $("#jQueryDeleteConfirmationModalWindow").dialog({...});
} 
```

# python - 与使用 python 的大文件 B 相比，从大文件 A 中找到唯一行的最快方法是什么？

> ID：10301687
> 
> 赞同：0
> 
> 时间：2012-04-24T16:04:58.103
> 
> 标签：python, compare

我得到了包含 300、000+ 行的 txt 文件 A 和 600、000+ 行的 txt 文件 B。现在我要做的是逐行筛选文件A，如果该行没有出现在文件B中，那么它将被附加到文件C中。

好吧，问题是如果我像上面所说的那样编程，完成所有工作实际上需要很长时间。那么有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-24T16:09:17.733

这应该很快：

```
with open("a.txt") as a:
    with open("b.txt") as b:
        with open("c.txt", "w") as c:
            c.write("".join(set(a) - set(b))) 
```

请注意，这将忽略 A 或 B 中的任何订单。如果您绝对需要保留来自 A 的订单，您可以使用以下命令：

```
with open("a.txt") as a:
    with open("b.txt") as b:
        with open("c.txt", "w") as c:
            b_lines = set(b)
            c.write("".join(line for line in a if not line in b_lines)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:10:03.683

你能记住B吗？如果是这样，请读取文件 B 并使用它包含的所有行创建一个索引。然后逐行阅读 A 并检查每一行是否出现在您的索引中。

```
with open("B") as f:
    B = set(f.readlines())

with open("A") as f:
    for line in f.readlines():
        if line not in B:
           print(line) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T16:08:43.680

对python一无所知，但是：如何将文件A排序为特定顺序？然后你可以逐行浏览文件 B 并进行二进制搜索 - 更有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T16:09:47.047

将文件 B 中的所有行读入 a `set`：

```
blines = set(file_b)
for line in file_a:
    if not line in blines:
       append_to_file_c 
```

600k+ 并不是真的那么多数据...

# iphone - 设备解锁时是否可以生成或接收本地通知？

> ID：10301695
> 
> 赞同：-1
> 
> 时间：2012-04-24T16:05:42.903
> 
> 标签：iphone, ios, background, multitasking, uilocalnotification

我的应用程序在后台运行，必须知道设备何时解锁，以便恢复一些重要操作。即使在应用程序进入后台或设备再次锁定和解锁后，用户仍然可以依赖它。

有人建议使用 UILocalNotification 来通知应用程序，但我不知道怎么做？我也不想通过对话来提示用户一些问题。应用程序只需在解锁时执行快速操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:13:35.843

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIApplicationDelegate_Protocol/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIApplicationDelegate_Protocol/Reference/Reference.html)
[UIApplicationWillResignActiveNotification](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIApplication_Class/Reference/Reference.html#//apple_ref/c/data/UIApplicationWillResignActiveNotification)

更准确地说，`applicationWillResignActive`当应用程序移动到后台时被调用，不仅仅是由于屏幕锁定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:10:36.850

设备解锁/锁定时将使用以下方法 -

1.  当设备锁定时 - applicationWillResignActive：

2.  当划分解锁 - applicationDidBecomeActive：

在这些方法中，我们可以根据需要使用 UILocalNotification 执行某些任务。

# php - 在没有用户帐户的情况下发布到 Facebook 页面

> ID：10301696
> 
> 赞同：1
> 
> 时间：2012-04-24T16:06:01.730
> 
> 标签：php, facebook

我必须遵循代码：

```
<?php
class Facebook
{       
    /**
     * @var The page id to edit
     */
    private $page_id = '134470319994206';   

    /**
     * @var the page access token given to the application above
     */
    private $page_access_token = 'xxx'; 

    /**
     * @var The back-end service for page's wall
     */
    private $post_url = '';

    /**
     * Constructor, sets the url's
     */
    public function Facebook()
    {
        $this->post_url = 'https://graph.facebook.com/'.$this->page_id.'/feed';
    }

    /**
     * Manages the POST message to post an update on a page wall
     * 
     * @param array $data
     * @return string the back-end response
     * @private
     */
    public function message($data)
    {   
        // need token
        $data['access_token'] = $this->page_access_token;

        // init
        $ch = curl_init();

        curl_setopt($ch, CURLOPT_URL, $this->post_url);
        curl_setopt($ch, CURLOPT_POST, 1);
        curl_setopt($ch, CURLOPT_POSTFIELDS, $data);

        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

        // execute and close
        $return = curl_exec($ch);
        curl_close($ch);

        // end
        return $return;        
    }
}

$facebook = new Facebook();

var_dump($facebook->message(array( 'message'     => 'A sample message' ) ) ); 
```

现在，当我执行代码时，返回布尔值 false。有人可以解释我如何在没有帐户的情况下执行此操作，因为我只想要一个页面，并且能够使用 PHP 发布到它吗？

谢谢！

# java - 从 ArrayList 中删除对象后如何返回对象？

> ID：10301703
> 
> 赞同：2
> 
> 时间：2012-04-24T16:06:19.140
> 
> 标签：java

我正在考虑这样做，但我不确定分配的参考温度在删除后是否仍然有效。

```
public Box removeBox(int index)
{
Box temp=getBoxes().get(index);//ArrayList.get
getBoxes().remove(index);
return temp;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-24T16:07:58.300

这很好，虽然`return getBoxes().remove(index)`会在一行中做同样的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:07:07.377

是的，这是一种有效的方法。Java 使用值，而不是引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T16:09:06.010

是的，引用仍然有效，因为已经存在对它的引用（`temp`您刚刚定义的变量）。JVM 的垃圾收集器将在运行时处理所有取消引用的对象。有关更多信息，请参阅此链接：[**Java 中垃圾收集的工作原理**](http://javarevisited.blogspot.com.es/2011/04/garbage-collection-in-java.html)，特别*是当对象变得符合垃圾收集条件时*。

[`ArrayList#remove`](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html#remove%28int%29)返回删除的元素，如果有的话，所以你也可以这样做`return getBoxes().remove(index)`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T16:09:14.437

`List.remove()`不会使删除的对象无效。

从任何 Collection 中删除任何元素不会使其无效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T16:28:01.423

你会很棒，参考将是有效的

举个例子

A--------对象

B---------对象

A 和 B 都是 Object 的引用。

现在，假设参考 B 无效

A--------对象

B--|-|-|-|--|-|-对象（无效）

参考 A 仍然保持不变。

谢谢阿比

# java - 使用 Amazon s3 Java SDK 的异常

> ID：10301710
> 
> 赞同：4
> 
> 时间：2012-04-24T16:06:50.153
> 
> 标签：java, amazon-s3, amazon-web-services

我正在尝试使用 Java SDK 将文件上传到 s3。该代码在我的运行 jdk1.6.0_26 的 Windows 7 机器上运行良好，但是当在服务器上运行时，Ubuntu Server 10.04 with Java(TM) SE Runtime Environment (build 1.7.0-b147)，我收到以下错误，这似乎是来自[https://github.com/amazonwebservices/aws-sdk-for-java/blob/master/src/main/java/com/amazonaws/auth/AbstractAWSSigner.java](https://github.com/amazonwebservices/aws-sdk-for-java/blob/master/src/main/java/com/amazonaws/auth/AbstractAWSSigner.java)：

```
com.amazonaws.AmazonClientException: Unable to calculate a request signature: null Stack trace : com.amazonaws.auth.AbstractAWSSigner.signAndBase64Encode(AbstractAWSSigner.java:71)
com.amazonaws.auth.AbstractAWSSigner.signAndBase64Encode(AbstractAWSSigner.java:55)
com.amazonaws.services.s3.internal.S3Signer.sign(S3Signer.java:101)
com.amazonaws.http.AmazonHttpClient.executeHelper(AmazonHttpClient.java:234)
com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:169)
com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:2597)
com.amazonaws.services.s3.AmazonS3Client.putObject(AmazonS3Client.java:1025) 
```

对 s3 的调用：

```
AWSCredentials c = new BasicAWSCredentials(accessKey, secretKey);
AmazonS3Client client = new AmazonS3Client(c);
String key = station + "/" + file.getName();        
client.putObject(new PutObjectRequest(bucket, key, file)); 
```

我是 Java 新手，不知道如何进一步排除故障。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:28:13.640

我的直觉是您在服务器上使用的 JDK/JRE 没有正确的 crypo/JCE。要么安装高加密包，要么安装包含正确密码的新 JDK/JRE。

Java Cryptography Extension 可以在底部下载： [http ://www.oracle.com/technetwork/java/javase/downloads/index.html](http://www.oracle.com/technetwork/java/javase/downloads/index.html)

# c# - 在字符串中搜索引用的短语和其他关键字的匹配项

> ID：10301714
> 
> 赞同：0
> 
> 时间：2012-04-24T16:07:02.327
> 
> 标签：c#, .net, search

作为我正在尝试完成的一个示例，这里有一些代码，它构建了一个带有名为的字符串属性的书籍列表`Sentence`。

```
public class Book {
    public string Sentence { get; set; }
}

Book book1 = new Book() { Sentence = "The quick brown fox jumps over the lazy dog" };
Book book2 = new Book() { Sentence = "The quick brown frog jumps over the lazy sloth" };

List<Book> books = new List<Book>();

books.Add(book1);
books.Add(book2); 
```

我想根据一些用户输入搜索书籍列表（搜索要求不应该比这个例子更复杂）。

如果用户提供了 的搜索短语`quick fox "lazy dog"`，那么我会返回一个 List，其中 book1 作为集合的成员。如果用户提供的搜索词组`quick fox sloth`不应该返回，因为这三个词不会全部出现在任何属性中。

**概括**

1.  `quick fox "lazy dog"`- 1 个结果（引号中的单词一起出现，其余单词单独出现）

2.  `quick fox sloth`- 没结果

3.  `"lazy sloth"`- 1 个结果（两个词一起出现在字符串中）

4.  `lazy sloth`- 1 个结果（两个单词都出现在字符串中）

我目前拥有的代码：

```
//Turn the search word into an array of words (includes support for quotes phrases).  E.g: quick fox "lazy dog" becomes a list of these values: `quick`, `fox`, `lazy dog`.
var searchWords = Regex.Matches(searchWord, @"(?<match>\w+)|\""(?<match>[\w\s]*)""")
                       .Cast<Match>()
                       .Select(m => m.Groups["match"].Value)
                       .ToList();

var query = from b in books
            where (!string.IsNullOrEmpty(b.Sentence) && searchWords.Any(b.Sentence.Contains))
            select b; 
```

这不适用于案例 2。我现在拥有的代码只是在寻找 1 个匹配项，如果它得到 1 个匹配项，那么它认为找到的项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:23:13.147

我想你可能想要`All()`LINQ 方法，试试这个：

```
var query = from b in books
            where (!string.IsNullOrEmpty(b.Sentence) && searchWords.All(word => b.Sentence.Contains(word)))
            select b; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:34:34.013

我不会重新发明轮子，而是使用[Lucene.Net](http://incubator.apache.org/lucene.net/)。您甚至不需要磁盘上的索引。所有索引+搜索都可以在内存中完成（使用 Lucene 的 RamDirectory）

# matlab - 计算 Mx2 和 Nx2 矩阵中的重叠

> ID：10301718
> 
> 赞同：2
> 
> 时间：2012-04-24T16:07:09.500
> 
> 标签：matlab

我有两个矩阵 A 和 B，都包含事件开始和停止时间的列表：

```
A(i,1) = onset time of event i
A(i,2) = offset time of event i
B(j,1) = onset of event j
... 
```

我的目标是获得两个不合理的列表，`aIdx`并且包含重叠的事件集。`bIdx``A(aIdx,:)``B(bIdx,:)`

我整天都在挠头，试图弄清楚这一点。有没有一种快速、简单、matlaby 的方法来做到这一点？

我可以使用 for 循环来做到这一点，但这对于 matlab 来说似乎有点 hacky：

```
aIdx = [];
bIdx = []
for i=1:size(A,1)
    for j=i:size(B,1)
        if overlap(A(i,:), B(j,:)) % overlap is defined elsewhere
            aIdx(end+1) = i;
            bIdx(end+1) = j;
        end
    end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T19:40:48.053

这是一个零循环解决方案：

```
overlap = @(x, y)y(:, 1) < x(:, 2) & y(:, 2) > x(:, 1)
[tmp1, tmp2] = meshgrid(1:size(A, 1), 1:size(B, 1));
M = reshape(overlap(A(tmp1, :), B(tmp2, :)), size(B, 1), [])';
[aIdx, bIdx] = find(M); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T18:05:12.537

你可以用一个循环来做到这一点：

```
aIdx = false(size(A,1),1);
bIdx = false(size(B,1),1);
for k = 1:size(B,1)
    ai = ( A(:,1) >= B(k,1) & A(:,1) <= B(k,2) ) | ...
           ( A(:,2) >= B(k,1) & A(:,2) <= B(k,2) );
    if any(ai), bIdx(k) = true; end
    aIdx = aIdx | ai;
end 
```

有一种方法可以创建矢量化算法。（我之前写过一个类似的函数，但现在找不到。）一个简单的工作流程是（1）结合两个矩阵，（2）创建一个索引来指示每个事件的来源，（3）创建一个矩阵来指示开始和停止位置，(4) 向量化和排序，(5) 查找与 diff、cumsum 或组合的重叠。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T19:02:02.723

```
overlap_matrix = zeros(size(A,1),size(B,1))

for jj = 1:size(B,1)
    overlap_matrix(:,jj) = (A(:,1) <= B(jj,1)).*(B(jj,1) <= A(:,2));       
end

[r,c] = find(overlap_matrix)
% Now A(r(i),:) overlaps with B(c(i),:)

% Modify the above conditional if you want to also check
% whether events in A start in-between the events in B
% as I am only checking the first half of the conditional
% for simplicity. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T20:19:05.227

完全矢量化的代码，没有 repmat 或 reshape（希望也更快）。我假设如果将完整的 A(req_indices,:) 和 B(req_indices,:) 对输入给它，函数“overlap”可以给出一个 1 和 0 的向量。如果重叠可以返回向量输出，则可以如下执行向量化。

设A矩阵中的行为Ra，B矩阵中的行为Rb，

```
AA=1:Ra;
AAA=AA(ones(Rb,1),:);
AAAA=AAA(:); % all indices of A arranged in desired format, i.e. [11...1,22..2,33...3, ...., RaRa...Ra]'

BB=(1:Rb)';
BBB=BB(:,ones(Ra,1)); 
BBBB=BBB(:);% all indices of B arranged in desired format, i.e. [123...Rb, 123...Rb,....,123...Rb]'

% Use overlap function
Result_vector = overlap(A(AAAA,:), B(BBBB,:));
Result_vector_without_zeros = find(Result_vector);
aIdx = AAAA(Results_vector_without_zeros);
bIdx = BBBB(Results_vector_without_zeros); 
```

缺点：较大矩阵的内存消耗过多

# mysql - 关于与多个表的关联（数据库）

> ID：10301723
> 
> 赞同：3
> 
> 时间：2012-04-24T16:07:30.660
> 
> 标签：mysql, database, database-design, relational-database, database-schema

我想将项目关联到数据库中的城市、州或国家。但是，我希望“项目”表中只有一个字段来链接到与其关联的城市、州或国家（而不是三个条目“city_id”、“state_id”和'country_id'）。看图片：

我知道在两者之间放置表格有一个技巧，但我搜索并仍然没有找到那种模式。

非常感谢！

Ĵ

![数据库建模](../Images/9041068eadc6feb86ef38b2e01fdc54f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:22:55.060

正如您所说，您可以使用中间表：

```
CREATE TABLE regions (
region_id  INT NOT NULL AUTO_INCREMENT,
country_id INT NOT NULL,
state_id   INT,
city_id    INT,
PRIMARY KEY (region_id),
UNIQUE  KEY (country_id, state_id, city_id)
CONSTRAINT FOREIGN KEY (country_id)           REFERENCES countries (id),
CONSTRAINT FOREIGN KEY (country_id, state_id) REFERENCES states (country_id, id),
CONSTRAINT FOREIGN KEY (  state_id,  city_id) REFERENCES cities (  state_id, id)
) 
```

您需要`regions`使用每个可能的（国家、州、城市）组合来更新此表，包括州或城市所在的位置`NULL`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:26:13.220

您是否考虑过添加第五张表：`place`. 每个`country`,`state`是`city`一个`place`. 每个`item`都与一个`place`.

这仍然没有标准化。您必须确保`place`三个表中的值集是不相交的。`item`在加入适当的表时，您还有更多工作要做。（本质上，您将一组困难换成另一组。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-05T16:11:59.557

Here's another idea, tell me what you think.

Since the fields in "item" will be optional, and that the relations between countries, states & cities is already defined, maybe I could try that way:

The primary keys of the countries, states & cities will be a unique ID through all those three tables (ex.: no state ID will have the same primary key as any city or country entry).

Then I could put this unique ID in the "items" table as well as the "type" which would give the table where to look for it ('cities', 'states', 'countries').

Since there could be some changes (ex.: 'regions', 'continents', etc.), then maybe it would be better to simply "add" a new table and type instead of regenerating the associative table.

Does it make sense?

Thanks!

# c# - 通过非默认 AppDomain 中的 C# 函数调用编组 C++ 指针接口

> ID：10301727
> 
> 赞同：3
> 
> 时间：2012-04-24T16:07:48.233
> 
> 标签：c#, c++-cli, marshalling, appdomain

我在 C++ 和 C# 代码之间有一个可用的 CLI 接口。该代码有一个 C++ 抽象接口，例如：

```
-------------C++ Interface---------------
namespace cppns
{
   class cppInterface
   {
      public:
         virtual bool Start(const char *pcDir) = 0;
   };
}

------Implementation of abstract C++ interface in same dll---------
namespace cppns
{
   class cppimp : public cppInterface
   private:
       gcroot<MyInternalCSharpClass^> mInternalClassAccess;
   public:
       cppimp::cppimp()
       {
           mInternalClassAccess = gcnew MyInternalCSharpClass();
       }

       virtual bool cppimp::Start(const char *pcDir)
       {
           System::AppDomain ^appDom = AppDomain::CurrentDomain::get();
           System::String ^strDomainName = appDom->FriendlyName;

           mInternalClassAccess->Initalize(pcDir);
       }
}

---------Method to create an instance of the class in a factory--------------
cppns::cppInterface *GetImplObject()
{
    return new cppns::cppimp();
}

----------Factory class .h to allow C++ to get an instance of the cppimp class------
------The C++ code knows about the abstract interface by including the header file--
------FactoryExport is __declspec(dllexport) when compiled in dll and---------------
----- __declspec(dllimport) when used as a header file in exe that uses header------
class FactoryExport ClassFactory
{
    public:
       static cppns::cppInterface *CreateImpl();
};

----------Factory class .cpp to allow C++ to get an instance of the cppimp class------
cppns::cppInterface *ClassFactory::CreateImpl()
{
    return GetImplObject();
} 
```

此代码正确地允许我调用 CreateImpl 以获取包含 Start 方法的接口的实现。我的问题是我试图强制整个 CLR/.NET 加载并执行到不是默认 AppDomain 的 AppDomain。我可以使用以下代码创建辅助 AppDomain：

```
 CComPtr<ICorRuntimeHost> pRuntimeHost;
   //Retrieve a pointer to the ICorRuntimeHost interface
   HRESULT hr = CorBindToRuntimeEx(
                L"v2.0.50727", //Retrieve last version before 4.0.
                // NULL, //Retrieve latest version by default
                L"wks",
                STARTUP_LOADER_OPTIMIZATION_SINGLE_DOMAIN | STARTUP_CONCURRENT_GC, 
                CLSID_CorRuntimeHost,
                IID_ICorRuntimeHost,
                (void**)&pRuntimeHost.p
                );

hr = pRuntimeHost->Start();

DWORD dwAppDomainId = 22;
WCHAR domainName[80 + 1];
    swprintf(domainName, 80, L"%s-%ld",L"NoDefaultDomain", dwAppDomainId);

CComPtr<IUnknown> pUnknownAppDomain;
hr = pRuntimeHost->CreateDomainEx(domainName, NULL, NULL, &pUnknownAppDomain);

CComPtr<_AppDomain> pAppDomain;
hr = pUnknownAppDomain->QueryInterface(__uuidof(_AppDomain), (VOID**)&pAppDomain.p);

BSTR bstrFriendlyName;
hr = pAppDomain->get_FriendlyName(&bstrFriendlyName);
if (SUCCEEDED(hr))
{
    _bstr_t bstrFriendlyNameWrap(bstrFriendlyName, false);
}

_bstr_t bstrAssemblyName("InteropCode");
CComPtr<_Assembly> pAssembly;
hr = pAppDomain->Load_2(bstrAssemblyName, &pAssembly);

BSTR bstrFullName;
hr = pAssembly->get_FullName(&bstrFullName);
if (SUCCEEDED(hr))
{
    _bstr_t bstrFullNameWrap(bstrFullName, false);
    std::cout << "Assembly name is: " << bstrFullNameWrap << "\n";
} 
```

每次让工厂向我返回此辅助应用程序域中的 cppns::cppInterface 接口的尝试都失败了。我什至尝试创建一个辅助工厂，它是一个 C# 类，它返回指向已实现接口的指针，以便对 Assembly 的 Invoke 调用有望导致其余代码在我将 Assembly 加载到的 AppDomain 中执行，但是Invoke 返回一个 IDispatch 指针，我似乎无法将其映射回接口上的任何类型的 C++ 指针。

```
namespace cppns
{
    public ref class NetFactory
    {
    public:
        NetFactory()
        {
        }

        cppInterface *CreateInterop()
        {
            return GetImplObject();;
        }
    };
} 
```

是否有另一种方法可以让所有内容在辅助 AppDomain 中运行，或者 IDispatch 指针是否可用于调用 Start 方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T13:59:14.890

我已经设法让大部分 .NET 东西在另一个域中运行。似乎没有办法让 CLI 层在默认 AppDomain 之外的任何地方运行。

为了完成这项工作，我需要让位于两个 appdomains 中的类派生自 MarshalByRefObject。在上面的示例中，这意味着我必须更改 MyInternalCSharpClass 以便它派生自 MarshalByRefObject。还必须使从 MyInternalCSharpClass 发送和返回的对象也派生自 MarshalByRefObject。最后，我传递和返回的这些相同对象必须具有 [Serializable] 属性，并且还将它们的所有私有变量标记为公共。请注意，如果通过 AppDomain 传输的类已经在使用 Serializable 属性，您可以在每个正式私有变量上使用 [XmlIgnore] 以避免更改正在进行的序列化。

现在一切都可以在 AppDomain 之间移动，我通过执行以下操作创建了第二个 AppDomain：

```
bool CreateInstanceInAppDomain(const char *pcAppDomainName)
{
    bool bRtn = false;

    gcroot<String^> csStrAppDomainName (gcnew String(pcAppDomainName));
    mAppDomain = AppDomain::CreateDomain(csStrAppDomainName);
    delete csStrAppDomainName;
    Object^ MyInternalObject = mAppDomain->CreateInstanceAndUnwrap("AssemblyName", "ClassNameSpace.MyInternalCSharpClass");
    mInternalClassAccess = dynamic_cast<MyInternalCSharpClass^>(MyInternalObject);
    if (mInternalClassAccess)
    {
        bRtn = true;
    }

    return bRtn;
} 
```

# java - 在 java 结构中模仿 C++ 并写入 byte[]

> ID：10301728
> 
> 赞同：1
> 
> 时间：2012-04-24T16:07:48.437
> 
> 标签：java, c++, structure, marshalling

我正在将一些 C++ 代码移植到 java，在我的特定实例中，我正在将数据写入要写入文件的 byte[]。第一部分，如 C++ 中所定义，是一个由一个 uint 和 3 个 ushort 组成的结构。第二部分是数据的主要部分，我将在将其发送到输出流之前将其附加到 byte[] 的末尾。

我的问题是：将标头值写入字节 [] 的最简单方法是什么？我知道我可以在其中放入 1 个值，然后偏移特定的字节数，并根据需要重复，但这是最好的方法吗？

另外，我如何管理字节对齐？C++ 代码似乎使用默认值（4 字节？）进行对齐。

谢谢，杰森

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:09:25.383

您可能会发现它更易于使用[`ByteBuffer`](http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html)，这可能是 Java 中按字节组织输出的最佳方式。

`ByteBuffer`不过，并不直接关心对齐，而且我不知道 C++ 是如何对齐其输出的——但在紧要关头，您可以手动推进它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:27:00.300

使用包装 ByteArrayOutputStream 的 DataOutputStream

```
ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream()
DataOutputStream stream = new DataOutputStream(byteArrayOutputStream);

try {
    stream.writeInt(i);
    stream.writeShort(s0);
    stream.writeShort(s1);
    stream.writeShort(s2);
    stream.flush();
} catch (IOException e) {
    // this can't happen, but you still require a try catch block
}

byte[] array = byteArrayOutputStream.toByteArray(); 
```

如果您的代码可能正在使用无符号整数解析类似的字节数组，那么您会有点头疼。也就是说，您必须检查负数并适当地处理它们。例如。

```
int unsignedIntAsSignedInt = inStream.readInt();
long realData;
if (unsignedIntAsSignedInt < 0) {
    realData = ((long) unsignedIntAsSignedInt) - (((long)Integer.MIN_VALUE) * 2);
} else {
    realData = unsignedIntAsSignedInt;
} 
```

# javascript - @Html.EditorForModel(model) 是如何工作的？(ASP.NET)

> ID：10301731
> 
> 赞同：0
> 
> 时间：2012-04-24T16:07:59.933
> 
> 标签：javascript, html, asp.net-mvc-3

**1º** 如果“model.count()”为 5，@Html.EditorForModel(Model.ElementAt(i)) 的真正工作原理。为什么我会得到“5*5”元素的维度？

```
@model List<model>
@for (int i = 0; i < Model.Count();i++ )
{                
    @Html.EditorForModel(Model.ElementAt(i))                
} 
```

实际上给了我5个元素的唯一尝试是：

```
@model List<model>

@Html.EditorForModel(Model) 
```

**2ª** 在模型模板中，我使用 Javascript 来更改 model.Numbers 的值，使用“GetElementById("NumbersX")”：

```
 @Html.TextBoxFor(m => m.Numbers, new { id = "NumbersX" }) 
```

有谁知道更好的实现方式或已经实现的功能来执行此任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-16T13:08:18.113

`EditorForModel`输出整个模型的编辑器。

你的模型有五个元素，所以一个“整个编辑器”就是五个元素。
你调用它五次，所以你得到 5x5 个元素。

你可能打算打电话`EditorFor`，不是`EditorForModel`。

```
@Html.EditorFor(m => m.ElementAt(i)) 
```

但这[也不会像您期望的那样工作](https://stackoverflow.com/q/25333332/11683)。然而，因为你有一个 List 作为你的模型，你可以让它正常工作：

```
@Html.EditorFor(m => m[i]) 
```

* * *

[您调用](http://msdn.microsoft.com/en-us/library/ff406445.aspx)的重载接受`Object additionalViewData`作为其参数。你传递了一个 lambda，就好像你在调用`EditorFor`，而那个 lambda 根本什么都不做。

# jquery - jquery中的hashchange？

> ID：10301733
> 
> 赞同：1
> 
> 时间：2012-04-24T16:08:06.907
> 
> 标签：jquery

我使用以下示例进行哈希更改：

```
$(window).trigger('hashchange');

$('.navBtn').bind('hashchange',function(){ 
    var hval = location.hash.slice(1); // remove the leading #
    alert(hval);
}); 
```

但似乎什么也没发生，我没有得到任何警报。任何想法为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T16:13:31.100

您只需要

```
//the js
$(window).bind('hashchange',function(){ 
    var hval = location.hash.slice(1); // remove the leading #
    alert(hval);
}); 

<!--the html-->
<a href="#imTheHash">Click me</a> 
```

在窗口上触发哈希更改事件。更改哈希不需要js。这是由浏览器处理的。即单击链接将更改哈希，然后将触发窗口事件“hashchange”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:10:02.893

您在绑定处理程序之前触发事件。颠倒顺序再试一次？

另外，我不确定，但是您正在触发窗口元素上的事件，但将其绑定在一组子元素上。我不知道这将如何运作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T16:16:50.430

你必须：

1.  颠倒顺序：先绑定然后触发
2.  使用相同的选择器

    ```
    $(window).bind('hashchange',function(){ 
      var hval = location.hash.slice(1); // remove the leading #
      alert(hval);
    }); 
    $(window).trigger('hashchange'); 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T16:09:54.270

Hashchange 发生在`window`对象上。你想表达什么`$('.navBtn').bind('hashchange', ...)`意思？

# c# - 我可以在客户端机器上以什么类型的文件存储 json 数据？

> ID：10301734
> 
> 赞同：0
> 
> 时间：2012-04-24T16:08:10.847
> 
> 标签：c#, windows, json, file, file-format

我正在创建一个保存 json 转储的本地数据库。我可以将它存储在 txt 或 xml 文件中，但我想使用正确的文件格式来存储 json。

存储 json 的标准文件格式是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:11:23.720

我不知道标准扩展，因为我是 linux 用户，但是当我给他们扩展时，我只使用 *.json ...

# asp.net-mvc - 包含“con”时，ASP.NET MVC 中出现奇怪的 404 错误

> ID：10301736
> 
> 赞同：12
> 
> 时间：2012-04-24T16:08:26.783
> 
> 标签：asp.net-mvc

我正在处理我维护的 MVC 应用程序上的一些爬网错误，并发现一个看起来应该有效的 URL 的 404 错误。

URL 的格式为：`/gifts/{categoryName}/{productName}/{productId}/`

出于某种原因，当 productName 设置为值“con”时，我只会收到 404 错误。任何其他值（不同或相同长度的字符串），它似乎工作正常。

有没有人见过这样的东西？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-24T16:10:00.697

`con`是保留字，因此不能放在 MVC 路由中

您需要将以下内容添加到您的 web.config：

```
<configuration>
  <system.web>
    <httpRuntime relaxedUrlToFileSystemMapping="true"/>

    <!-- ... your other settings ... -->
  </system.web>
</configuration> 
```

有关更多信息，请参阅这篇文章：

[将 Con（COM1、LPT1、NUL 等）放回您的 URL](http://haacked.com/archive/2010/04/29/allowing-reserved-filenames-in-URLs.aspx)

# web-services - 在 Restful Web 服务中传递参数

> ID：10301738
> 
> 赞同：0
> 
> 时间：2012-04-24T16:08:34.557
> 
> 标签：web-services, rest, get

亲爱的 Stackoverflow 用户，我已经玩了很长一段时间的 RESTful Web 服务了。我对如何使用 GET 方法传递参数有一点疑问。由于get只能用于检索任何资源，如何传递参数。我为此编写了一个小代码，但代码似乎有问题。

```
@GET
    @Produces("text/plain")
    @Path("/instrumentname/")
    public String getname(String name1) {
try {

String [] env=null;
            String[]callAndArgs= {"python","connection.py",ins_name};//passing the parameters

            Process p = Runtime.getRuntime().exec(callAndArgs,env,
                    new java.io.File("C:\\Users\\Balkishore\\Documents\\NetBeansProjects\\Testinstrument_Rest\\build\\web"));//excuting the python file

            BufferedReader stdInput = new BufferedReader(new 

                 InputStreamReader(p.getInputStream()));//getting the input

            BufferedReader stdError = new BufferedReader(new 

                 InputStreamReader(p.getErrorStream()));//getting the error

           interface_name = stdInput.readLine();//reading the output

                System.out.println(interface_name);

    }

        catch (IOException e) {//catching the exception

            System.out.println("exception occured");

            e.printStackTrace();

            System.exit(-1);

        }
        return this.interface_name;
    } 
```

任何帮助将不胜感激。提前致谢。干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:19:32.350

您只需在 URL 末尾以以下格式连接参数：www.xyz.com/?param1=val1¶m2=val2¶m3=val3

其中 param1, param2 是参数名称，val1,val2 是相应参数的值...您可以在浏览器的 URL 栏中键入它们，而不是编写 HTML 页面或脚本进行测试...

此外，您说 GET 通常用于从 Web 服务器获取资源是正确的，但有时您必须传递必须获取其资源的信息......

# mysql - mysqldbexport 将文件放在 Windows 的什么位置？

> ID：10301744
> 
> 赞同：1
> 
> 时间：2012-04-24T16:08:54.890
> 
> 标签：mysql

大约一个小时前，我运行了以下命令：

```
mysqldbexport.exe --server=root:mypword@localhost --export=DATA --bulk-insert mydbname 
```

从那时起，我在上网时一直觉得自己像个白痴，还有硬盘……试图找出结果在哪里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T18:06:17.390

好吧，我从来没有找到文档......但是，确实遇到了这样的声明：

> “如果导出中包含表定义，它们将照常写入标准输出。”

所以，我修改了上面的命令以打印到一个文件......这很有效。

```
mysqldbexport.exe --server=root:mypword@localhost --export=DATA --bulk-insert mydbname >>c:\temp\mysqlexport.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-30T06:12:40.143

使用 Mysql 工作台版本导出数据库：6.2.3：

```
mysqldbexport --server=username:password@localhost --export=DATA --bulk-insert testSchema --output-file=D:/tmp/dump.sql 
```

# ios - 如何在 uiscrollview 中添加六个控制器？

> ID：10301746
> 
> 赞同：0
> 
> 时间：2012-04-24T16:08:59.777
> 
> 标签：ios, uiviewcontroller, uiscrollview, uitabbarcontroller, uipagecontrol

我的问题有点大，所以为此道歉。现在我的问题是我必须设置一个标签栏控制器，其中第一个标签将包含一个带有 UIPageControl 的 UIScrollView，直到现在我已经制作了带有滚动视图和 uipagecontrol 的标签栏控制器，但是我无法在 uiscrollview 中为每个页面控件添加 uiviewcontroller。

任何源代码的建议和链接对我都有很大的帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T06:13:11.953

我非常简单地完成了这个解决方案。我在我的主控制器中使用了一个 UIScrollview，我的滚动将在其中工作。

1.  在 viewDidLoad 中，我首先将 UIscrollview 和加载，下一个和上一个控制器作为滚动视图的一个项目。当我滚动时，然后在滚动视图的页面上加载受尊重的视图控制器。

2.  我还在 viewDidLoad 中取了一个 uipagecontroll。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:23:33.877

如果您必须为每个页面拥有一个单独的视图控制器，那么正确的方法是使用视图控制器包含，您可以让滚动视图充当从属视图控制器的容器。我建议阅读[`UIViewController`文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)，尤其是标题为“实现容器视图控制器”的部分。

# perl - 在特定时间运行 perl 脚本

> ID：10301749
> 
> 赞同：0
> 
> 时间：2012-04-24T16:09:02.070
> 
> 标签：perl

是否可以编写一个在特定时间运行另一个 Perl 脚本的 Perl 脚本？事实上，我想使用另一个 Perl 脚本在特定时间永远运行我的脚本，即在 XX:XX 点（例如 12:00），脚本**自动**运行并在 x 分钟后（例如 15 分钟或 60 分钟）运行它再次运行，这个过程永远持续下去。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T16:12:52.790

虽然绝对可以编写一个在特定时间生成其他脚本的 Perl 脚本，但如果您在 Windows 上，则可能由现有系统（如[cron](http://en.wikipedia.org/wiki/Cron)或[at或 Windows 任务调度程序）更好地满足您的需求。](http://en.wikipedia.org/wiki/At_(Unix))

# wcf - Wcf 3.5 - 具有不同绑定和 SOAP 的不同端点

> ID：10301752
> 
> 赞同：2
> 
> 时间：2012-04-24T16:09:12.480
> 
> 标签：wcf, soap

我有一个问题......我探索了整个互联网，但我不知道我做错了什么。

问题：WCF Web 服务、.Net Framework 3.5、2 种不同类型的客户端（手持设备和普通计算机）

我要做的是创建 2 个不同的端点，一个带有 basicBinding（用于 SOAP 请求），另一个带有 wsBinding（用于普通计算机）

所以我通过 web.config 并创建了 2 个不同的绑定，与 2 个不同的端点相关：

```
<bindings>
  <basicHttpBinding>
    <binding name="BasicBinding" openTimeout="00:10:00" receiveTimeout="23:59:00"
      sendTimeout="23:59:00" messageEncoding="Text" />
  </basicHttpBinding>
  <wsHttpBinding>
    <binding name="DefaultBinding" openTimeout="00:10:00" receiveTimeout="23:59:59"
      sendTimeout="23:59:59">
      <reliableSession inactivityTimeout="01:00:00" />
      <security mode="None">
        <transport clientCredentialType="None" />
        <message clientCredentialType="None" />
      </security>
    </binding>
  </wsHttpBinding>
</bindings>
<services>
  <service behaviorConfiguration="qtswsdl.QTS_ServiceBehavior"
    name="qtswsdl.QTS_Service">
    <endpoint address="http://host.com/service.svc/ForHh"
      binding="basicHttpBinding" bindingConfiguration="BasicBinding"
      name="handHeldEndPoint" contract="qtswsdl.QTSPort" />
    <endpoint address="http://host.com/service.svc/ForCp"
      binding="wsHttpBinding" bindingConfiguration="DefaultBinding"
      name="coProcessorEndPoint" contract="qtswsdl.QTSPort" />
  </service>
</services>
<behaviors>
  <serviceBehaviors>
    <behavior name="qtswsdl.QTS_ServiceBehavior">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="true" />
      <dataContractSerializer maxItemsInObjectGraph="2147483647" />
      <serviceThrottling maxConcurrentCalls="2147483647"maxConcurrentSessions="2147483647"
        maxConcurrentInstances="2147483647" />
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

因此，当我尝试将 SOAP 消息发送到“http://host.com/service.svc/ForHh”时，我收到“HTTP 400 - 错误请求”（/ForCp 也不起作用）

我尝试使用自定义客户端，使用 WcfTestClient.exe，但我无法确定正在发生的事情

任何提示或建议？

谢谢你的时间

编辑：

启用 Svc 跟踪后，我遇到了一些异常：

```
<Message>The message with Action 'http://Host.com/Service.svc/ForHh' cannot be processed at the receiver, due to a ContractFilter mismatch at the EndpointDispatcher. This may be because of either a contract mismatch (mismatched Actions between sender and receiver) or a binding/security mismatch between the sender and the receiver.  Check that sender and receiver have the same contract and the same binding (including security requirements, e.g. Message, Transport, None).</Message> 
```

有趣的是，我正在以编程方式发送 SOAP 请求。我的理解是，如果我以编程方式发送 SOAP 请求，我不需要定义任何合同，因为默认情况下它是使用 SOAP 1.1 发送的。

发送请求的代码如下：

```
private string SendRequestAndGetAnswerFromWebService(string methodName, string requestXml){

     StringBuilder soapRequest = new StringBuilder("<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"");
                soapRequest.Append(" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" ");
                soapRequest.Append("xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>");
                soapRequest.Append(requestXml);//Body
                soapRequest.Append("</soap:Body></soap:Envelope>");

                   WebRequest webRequest = WebRequest.Create(@"http://Host.com/Service.svc/" + methodName);
                   HttpWebRequest httpRequest = (HttpWebRequest)webRequest;
                   httpRequest.Method = "POST";
                   httpRequest.ContentType = "text/xml; charset=ascii";
                   httpRequest.Headers.Add("SOAPAction: " + @"http://Host.com/Service.svc/Service.svc/" + methodName);
                   httpRequest.ProtocolVersion = HttpVersion.Version11;
                   httpRequest.Credentials = CredentialCache.DefaultCredentials;
                   httpRequest.Timeout = 7000;
                   httpRequest.ContentLength = System.Text.Encoding.ASCII.GetByteCount(soapRequest.ToString());
                   Stream requestStream = httpRequest.GetRequestStream();

                   //Create Stream and send Request 
                   StreamWriter streamWriter = new StreamWriter(requestStream, Encoding.ASCII);
                   streamWriter.Write(soapRequest.ToString());
                   //Send the request             
                   streamWriter.Close();

                   //Get the Response
                   HttpWebResponse wr = (HttpWebResponse)httpRequest.GetResponse();
                   StreamReader srd = new StreamReader(wr.GetResponseStream());
                   string resulXmlFromWebService = srd.ReadToEnd();
                   return resulXmlFromWebService;
} 
```

也许我对以编程方式发送的合同和肥皂消息的假设是错误的......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T15:35:30.090

通常，这是非常糟糕的做法——您不应该以这种方式手动将 SOAP 请求创作到 WCF 服务。如果您要利用开箱即用的 WCF 请求/回复范例而不是手动设置标头，那就更好了。

我建议创建一个替代示例，您可以在其中实现开箱即用的相同功能（可能在客户端使用 DataContracts、OperationContracts 和 ServiceContracts，可能利用 WebHttpBehavior 和 WebHttpBinding）。检查在该场景中发送和接收的确切消息，并逐个字符仔细检查这些消息与您在此处发送的消息有何不同。

此外，仅从您提供的细节中很难判断您可能做错了什么。

这是我的建议：

*   在服务端启用跟踪，生成跟踪日志，并使用 SvcTraceViewer 进行分析。为此，请按照[此 MSDN 文章中关于使用服务跟踪查看器](http://msdn.microsoft.com/en-us/library/ms732023.aspx)的说明进行操作。注意第一次和第二次有什么不同。

*   打开调试异常。这是通过上交 includeExceptionDetailInFaults 来完成的，[您可以按照此处的说明进行操作](http://blogs.technet.com/b/david_bennett/archive/2006/11/12/how-to-turn-on-debug-exceptions-with-wcf.aspx)。注意第一次和第二次有什么不同。

*   使用[Fiddler](http://www.fiddler2.com/fiddler2/)监控客户端和服务端的有线流量。

一般来说，一旦你这样做了，你应该得到更多关于服务端发生了什么问题的更多信息，并且可以很快诊断出问题。试试看，请回来报告！:)

# c# - 如何将同一项目中的类编译到不同的DLL

> ID：10301754
> 
> 赞同：2
> 
> 时间：2012-04-24T16:09:14.490
> 
> 标签：c#, dynamic, dll, compilation

大家好，我有一些类的类库项目。

我想知道如何将每个类编译为不同的 DLL。

我不想为每个 dll 创建单独的项目，

我使用这个 dll 作为插件，但这些是非常简单的插件，我不想为每个插件创建项目。

我将把所有这些dll放在同一个目录中并动态加载它们，

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-28T19:41:03.837

为每个类创建一个单独的 .cs 文件。

然后像在 Nygma7 的答案中建议的那样创建 DLL，方法是打开 Visual Studio 命令提示符，`CD`到 .cs 文件的位置并在提示符处创建 DLL： `csc /target:library /out:test1.dll test1.cs`等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:12:22.473

为每个班级创建一个单独的项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T16:20:49.450

我认为这不是一个好方法，但无论如何。您可以从项目中排除类，然后进行编译。

您还可以将编译器指令用作：

```
#define Class1
#if Class1
class 1
{
}
#endif

#undef Class2
#if Class2
class 2
{
}
#endif 
```

然后在输出 DLL 中编译 Class1 或 Class2。但是，这不会像您想要的那样自动化。想不出别的办法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T17:43:40.450

两个解决方案： 1 您可以在您的解决方案中分离创建一个新项目的类，您将创建一个类库，它将生成一个 dll。比您必须转到引用并将新引用添加到项目中。

您应该考虑这是否是一个好的解决方案，如果您要在其他项目中使用该类，这是一个很好的解决方案。

2 代码示例...

```
using System;
namespace SimpleMaths
{
  public class Operations
  {
    public static int add(int a, int b)
    {
        return a + b;
    }

    public static int substract(int a, int b)
    {
        return a - b;
    }

    public static int multiply(int a, int b)
    {
        return a * b;
    }
  }
} 
```

现在打开开始>>VisualStudio2005/2008>>Visual Studio 工具>>Visual Studio 命令提示符。

现在在命令提示符中找到保存刚刚创建的 .cs 文件的目录。使用 CD 命令。

csc /target:library /out:File.dll test.cs

这将生成您想要的 dll 文件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T16:28:26.317

你需要退后一步，想想你在问什么。您有几个类都是单个项目的一部分，但您希望将该项目构建成几个不同的部分。你为什么想这么做？关于您的代码的两件事之一是正确的：

1.  你的类是相互依赖的；即`Class1`取决于`Class2`. 在这种情况下，您**不想**将它们构建到单独的 dll 中，因为这些 dll 不会自行运行。
2.  您的课程彼此独立；ie`Class1`与 没有关系`Class2`。在这种情况下，为什么他们在同一个项目中？这些类属于它们自己的项目，因此可以单独构建它们。

阅读您的更新后，我怀疑您是第 2 种情况。只要它们不相互依赖，你就应该将你的类分成它们自己的项目。你说过“我不想把它们分开”，但你没有说*为什么*。你有理由不想让他们分开吗？您仍然可以将它们全部包含在同一个解决方案中，并且您仍然可以使用单个命令构建它们。

# java - 如何在 java web 应用程序中使用 Ajax 将 textfield 的值与 href 值一起带到下一页？

> ID：10301761
> 
> 赞同：0
> 
> 时间：2012-04-24T16:09:36.227
> 
> 标签：java, javascript, jquery, ajax

我在 Java Web 应用程序中使用 Ajax，我想将 textfield 的值与指向下一页的 href 链接一起获取。

```
<%@page contentType="text/html" pageEncoding="UTF-8"%>
           <% String root = getServletContext().getContextPath();
           %>
              <table  border="0" id="box-table-b">
                  <thead><tr>
                  <th height="31" colspan="2" nowrap>Enter User Id of Patient </th>
                      </tr></thead>
                <tr>`enter code here`
                  <td width="76" nowrap>UserId</td>
                  <td width="85"  nowrap>
                      <input type="text" name="confuserid" id="confuserid"/>
                 </td>
                </tr>
                <tr>
                <td height="66" colspan="2" align="center" valign="middle" nowrap>            
                <a href="#" onclick="returndisplayData('<%=root%>/confapp.do?method=confapp','entry');"><input type="button" value="Submit"></a>
                  </td>
                </tr>
              </table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T18:04:29.137

您可以将控件和链接放在表单中并通过 GET 提交表单，但这会使您远离 ajax。

另一种选择是使用 jQuery 简单地获取 confuserid 的值并将其附加到您传递给 returndisplayData 函数的 URL。

就像是

```
function getMyURL() {
    return '<%=root%>/confapp.do?method=confapp&confuserid='+$("#confuserid").val();
} 
```

那么你的链接看起来像

```
<a href="#" onclick="returndisplayData(getMyURL(),'entry');"><input type="button" value="Submit"></a> 
```

显然，您需要在页面中包含 jQuery。

# c++ - 如何从 C++ std::basic_ostream 派生并使 << 运算符虚拟化？

> ID：10301764
> 
> 赞同：5
> 
> 时间：2012-04-24T16:09:53.583
> 
> 标签：c++, stream, iostream, std

我正在编写一个具有各种消息输出的类。我想让这个类通用且独立于平台，所以我正在考虑将**basic_ostream**引用传递给它，它可以将所有消息转储到流中。通过这样做，如果该类在控制台程序中使用，我可以将**std::cout**传递给它并显示在控制台窗口中。

或者我可以将派生的 ostream 传递给它并将消息重定向到某些 UI 组件，例如 ListBox？唯一的问题是数据插入器`operator <<`不是虚拟功能。如果我将派生类引用传递给它，则只会调用**basic_ostream << 运算符。**

有什么解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T21:35:44.520

*Nan Zhang自己的答案，最初作为问题的一部分发布：*

跟进：好的，这是实现所需功能的派生 std::streambuf ：

```
class listboxstreambuf : public std::streambuf { 
public:
    explicit listboxstreambuf(CHScrollListBox &box, std::size_t buff_sz = 256) :
            Scrollbox_(box), buffer_(buff_sz+1) {
        char *base = &buffer_.front();
        //set putbase pointer and endput pointer
        setp(base, base + buff_sz); 
    }

protected:
    bool Output2ListBox() {
        std::ptrdiff_t n = pptr() - pbase();
        std::string temp;
        temp.assign(pbase(), n);
        pbump(-n);
        int i = Scrollbox_.AddString(temp.c_str());
        Scrollbox_.SetTopIndex(i);
        return true;
    }

private:
    int sync() {
        return Output2ListBox()? 0:-1;
    }

    //copying not allowed.
    listboxstreambuf(const listboxstreambuf &);
    listboxstreambuf &operator=(const listboxstreambuf &);

    CHScrollListBox &Scrollbox_;
    std::vector<char> buffer_;
}; 
```

要使用此类，只需创建一个 std::ostream 并使用此缓冲区进行初始化

```
std::ostream os(new listboxstreambuf(some_list_box_object)); 
```

# java - 节点列表到数组列表 转换

> ID：10301774
> 
> 赞同：-1
> 
> 时间：2012-04-24T16:10:03.863
> 
> 标签：java, xml

我已经提取了节点列表，例如， `this.NodeList xml = doc.getElementsByTagName(tagName)`

现在我想将 xml 转换为 ArrayList 类型，有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-05-04T07:32:24.817

**关于 Java**

从 Java 8 开始，您可以使用 IntStream 和 map，其中 nodeList 是以下实例`NodeList`：

```
List<String> nodeNames = IntStream.range(0, nodeList.getLength())
        .mapToObj(nodeList::item)
        .map(n -> n.getNodeName())
        .collect(Collectors.toList()); 
```

这会将节点的名称收集到一个列表中。

对于更通用的目的，您可以收集`Node`元素然后对其进行处理：

```
List<Node> nodes = IntStream.range(0, nodeList.getLength())
        .mapToObj(nodeList::item)
        .collect(Collectors.toList()); 
```

请注意，从 Java 10 开始，您也可以只`var`代替`List<Node>`：

```
var nodes = IntStream.range(0, nodeList.getLength())
        .mapToObj(nodeList::item)
        .collect(Collectors.toList()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:12:39.260

```
var nodeArrayList = new ArrayList(xmlNodeList.OfType<XmlNode>().ToList()); 
```

# html - 表中的第一个子选择器

> ID：10301776
> 
> 赞同：0
> 
> 时间：2012-04-24T16:10:09.157
> 
> 标签：html, css, css-selectors

我创建了一个页面，它是三个独立网站的登录门户。在此页面上，我显示了上述网站的三个登录门户。我正在尝试使用 css 和尽可能少的类来设置所有样式（我需要微调我的 css 技能）。

我创建的是一个三行两列的表，称为 loginPortals：

```
<table class="loginPortals">
    <tbody>
        <tr>
            <td>Picture 1</td>
            <td>Login form 1</td>
        </tr>
        <tr>
            <td>Picture 2</td>
            <td>Login form 2</td>
        </tr>
        <tr>
            <td>Picture 3</td>
            <td>Login form 2</td>
        </tr>
    </tbody>
</table> 
```

我才刚刚开始表格的样式，所以它非常不完整，但是我已经在努力了。这是简化的，因为我不确切知道它的外观。不过，基本上，我希望在每一行之间出现某种边框。以下内容并没有达到我想要的效果：

```
.loginPortals{
    width:100%;
}
    .loginPortals tbody:first-child td{
        border-top:1px solid #000;
    }
    .loginPortals tbody tr td{
        border-bottom:1px solid #000;
        padding:1em 0;
    } 
```

第一个孩子选择器没有像我想象的那样工作。它将顶部边框应用于所有行中的所有单元格。这导致行中间的线条粗细加倍。

如何解决此问题，以便顶部边框仅应用于顶行而不创建额外的类或应用任何内联样式。

谢谢！
乔

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T16:16:21.507

您的表格边框需要设置为折叠：

```
.loginPortals{
    width:100%;
    border-collapse: collapse;
} 
```

然后，您可以省略`:first-child`规则并为所有行应用顶部和底部边框：

```
.loginPortals tbody tr td{
    border-top:1px solid #000;
    border-bottom:1px solid #000;
    padding:1em 0;
} 
```

此外，仅供参考，此选择器：

```
.loginPortals tbody:first-child td 
```

方法：

> 选择 a 中作为其父级的第一个子级的任何`td`元素。
> `tbody`

并不是：

> 选择 a 的第一个子元素中的任何`td`元素。
> `tbody`

因此，由于`tbody`是 的第一个也是唯一的孩子，因此将选择其所有父母中的`.loginPortals`所有`td`元素。`tr`请参阅[此答案](https://stackoverflow.com/a/4195253/106224)以获得直观的解释。你可能想要这个选择器：

```
.loginPortals tbody tr:first-child td 
```

但这不是必需的，因为您所要做的就是折叠表格边框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:18:10.927

如果我理解正确，您有 3 个表格，并且只需要两行 -`I want a border of some sort appearing between each row`如果是这种情况，这就是我从中得到的，试试这个。

```
.loginPortals tr:first-child td{
    border-top:none;
}
.loginPortals tbody tr td{
    border-top:1px solid #000;
    padding:1em 0;
}​ 
```

[http://jsfiddle.net/u4v3Z/](http://jsfiddle.net/u4v3Z/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T16:14:34.053

我相信这会奏效...

```
td {border-top:1px solid #000;} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T16:19:54.707

首先，如果你想提高你的 CSS 技能，你应该立即停止使用表格进行布局。

其次，`:first-child`伪类影响作为其父母的第一个孩子的元素。因此，由于您只有一个`tbody`元素，并且它是`table`写作的第一个子元素，`tbody`或者`tbody:first-child`会产生相同的结果。

编辑：我想你可能会在这里`tr:first-child td`（你只希望第一个表格行中的表格单元格有一个顶部边框）。

要解决您的问题，您可以只使用`border-bottom`所有`td`s，除非您还需要顶部边框，在这种情况下，您可以将该边框设置为实际边框，`table` *或者*您可以提供所有`td`sa`border-top` *和* `border-bottom`. 正如您所描述的，这当然会呈现双边框，但您可以使用`border-collapse: collapse`.

简而言之：`table {border-collapse: collapse}`. 但不要使用表格进行布局。

# ruby-on-rails-3 - 如何避免从 solr 检索整个存储字段

> ID：10301785
> 
> 赞同：2
> 
> 时间：2012-04-24T16:10:56.110
> 
> 标签：ruby-on-rails-3, solr, sunspot

我正在将 sunspot 和 solr 用于 rails 应用程序来搜索电子书内容，对于突出显示功能，我必须将 ebook_content 设置为存储的文件，每次我查询 solr 的结果时，它都会发回关于这本书的整个文档内容，其中使查询非常慢。

如果没有存储字段，我怎么才能得到结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T21:40:21.057

[`fl`Solr](http://wiki.apache.org/solr/CommonQueryParameters#fl)的参数允许您指定要在结果中返回的字段。如果您有 fields `id, title, ebook_content`，那么您可以使用`fl=id,title`省略该`ebook_content`字段。我认为 Solr 不支持获取*除*一个（例如`-ebook_content`）之外的所有字段。

**更新**

如果您不想在正常结果中返回该字段，但仍希望在该字段上[突出显示](http://wiki.apache.org/solr/HighlightingParameters)，请按照我上面所述排除该字段，然后打开荧光笔：

```
hl=true 
```

设置应突出显示的字段：

```
hl.fl=ebook_content 
```

并设置突出显示片段的大小（以字符为单位）：

```
hl.fragsize=50 
```

您完成的查询如下所示：

```
?q=search term&fl=id,title&hl=true&hl.fl=ebook_content&hl.fragsize=50 
```

# objective-c - 更改超类的属性值

> ID：10301787
> 
> 赞同：-2
> 
> 时间：2012-04-24T16:10:58.480
> 
> 标签：objective-c, ios, subclass, subview

我上课了

```
@interface PlayScene : UIView 
```

里面有一些属性（这里有一些）

```
@property (readwrite, assign) int Figure1;
@property (readwrite, assign) int Figure2;
@property (readwrite, assign) int Figure3; 
```

我得到了一个在 PlayScene 中调用的 subView

```
@interface gameOverMenu : PlayScene <UITextFieldDelegate> 
```

我需要以某种方式在我的子类中获得这些属性。实际上，我需要将它们设置为 0，以便“再次播放”按钮正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:42:39.450

对于那些有同样问题的人，原来的问题是：

```
@interface gameOverMenu : UIView <UITextFieldDelegate> 
```

他通过将其更改为：

```
@interface GameOverMenu : PlayScene <UITextFieldDelegate> 
```

# linux - 使用 Mono（开源 .NET）开发 Web 应用程序有什么例子吗？

> ID：10301788
> 
> 赞同：7
> 
> 时间：2012-04-24T16:11:20.167
> 
> 标签：linux, web-applications, f#, mono, spring.net

我是一名 Java、Scala、Python 网络应用程序 Linux 人。我想在 Web 开发中使用 Mono（尤其是 F#）。

我只是在寻找一个用 Mono 编写的示例 Web 应用程序，也许是在 Github 中（任何 CLI 语言都可以）。我尝试过谷歌搜索，但找不到一个好的起点（或者如果可能的话）。

根据我收集到的信息，我可以结合起来：

*   快速 CGI (nginx, lighttpd)
*   单核细胞增多症
*   Spring framework .NET（我什至不知道它是否可以在 Mono 上工作）

如果我错过了一个明显的资源（网站），请提前道歉。

（有用的网站：[http](http://www.tryfsharp.org/Resources/GetMono.aspx) ://www.tryfsharp.org/Resources/GetMono.aspx ）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T14:48:12.003

获取 Mac/Linux 设置的 F# 开发环境：

*   [http://www.tryfsharp.org/Resources/GetMono.aspx](http://www.tryfsharp.org/Resources/GetMono.aspx)

特别是对于 Ubuntu 12.04：

*   [http://datachomp.com/archives/running-asp-net-mvc4-on-ubuntu-12-04/](http://datachomp.com/archives/running-asp-net-mvc4-on-ubuntu-12-04/)

要让 Fsharp 与 MonoDevelop 2.6 或更高版本一起使用，您必须使用以下分支之一：

*   [https://github.com/fsharp/fsharpbinding](https://github.com/fsharp/fsharpbinding)

Nancy 看起来像是一个很好的 URL 路由选项，这是我真正需要的：

*   [https://github.com/NancyFx/Nancy](https://github.com/NancyFx/Nancy)

对于 Nancy 的 F# Mono 东西，包括 Djano 模板：

*   [https://github.com/NancyFx/Nancy/wiki/Building-Nancy-on-Mono](https://github.com/NancyFx/Nancy/wiki/Building-Nancy-on-Mono)

您可以使用命令行 NuGet 安装工具（基本上类似于 Javascripts npm 或 Java 的 maven）：

*   [http://nuget.codeplex.com/releases/view/58939](http://nuget.codeplex.com/releases/view/58939)

一旦我安装了 Fsharp Powerpack，理论上我应该有 LINQ 用于持久性。

如果 Nancy 不成功，似乎有一个称为 OWIN 的标准（它似乎类似于 Python 的 WSGI）。

其他符合 OWIN 的项目：[http ://owin.org/#projects](http://owin.org/#projects)

**更新**

看起来[**ServiceStack**](http://www.servicestack.net/)也有一些好东西，并且似乎正在获得一些牵引力。就 Mono 而言，您主要想查看[daemon doc](https://github.com/ServiceStack/ServiceStack/wiki/Run-ServiceStack-as-a-daemon-on-Linux)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T16:49:35.777

查看 XSP（大约在此页面的中间）

[单声道和 ASP.NET](http://mono-project.com/ASP.NET)

除了 Daniel 提到的 WebSharper 之外，还有[Bistro](http://bistroframework.org/index.php?title=FSharp)。

希望有帮助。

# java - 找不到类“twitter4j.http.AccessToken”

> ID：10301789
> 
> 赞同：2
> 
> 时间：2012-04-24T16:11:21.447
> 
> 标签：java, android, twitter4j

我使用 twitter4j 库用 twitter 制作一些东西。但是我对 AccesToken 类有疑问。我检查了我的库，只有一个 AccesToken 类，它在 twitter4j.http 中没有其他 AccesToken 类。我的代码在大约 10 小时前工作，但现在它不起作用。我快要疯了：/

这是我的日志跟踪：

```
04-24 15:53:32.767: E/dalvikvm(305): Could not find class 'twitter4j.http.AccessToken', referenced from method com.twitterresim.TwitterOnay.isAuthenticated
04-24 15:53:32.767: W/dalvikvm(305): VFY: unable to resolve new-instance 67 (Ltwitter4j/http/AccessToken;) in Lcom/twitterresim/TwitterOnay;
04-24 15:53:32.767: D/dalvikvm(305): VFY: replacing opcode 0x22 at 0x0010
04-24 15:53:32.767: D/dalvikvm(305): Making a copy of Lcom/twitterresim/TwitterOnay;.isAuthenticated code (124 bytes)
04-24 15:53:32.767: E/dalvikvm(305): Could not find class 'twitter4j.http.AccessToken', referenced from method com.twitterresim.TwitterOnay.sendTweet
04-24 15:53:32.767: W/dalvikvm(305): VFY: unable to resolve new-instance 67 (Ltwitter4j/http/AccessToken;) in Lcom/twitterresim/TwitterOnay;
04-24 15:53:32.767: D/dalvikvm(305): VFY: replacing opcode 0x22 at 0x0010
04-24 15:53:32.767: D/dalvikvm(305): Making a copy of Lcom/twitterresim/TwitterOnay;.sendTweet code (104 bytes)
04-24 15:53:32.767: D/AndroidRuntime(305): Shutting down VM
04-24 15:53:32.767: W/dalvikvm(305): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
04-24 15:53:32.776: E/AndroidRuntime(305): Uncaught handler: thread main exiting due to uncaught exception
04-24 15:53:32.786: E/AndroidRuntime(305): java.lang.NoClassDefFoundError: twitter4j.http.AccessToken
04-24 15:53:32.786: E/AndroidRuntime(305):  at com.twitterresim.TwitterOnay.isAuthenticated(TwitterOnay.java:18)
04-24 15:53:32.786: E/AndroidRuntime(305):  at com.twitterresim.TwitterPost.TwitterUpdate(TwitterPost.java:38)
04-24 15:53:32.786: E/AndroidRuntime(305):  at com.twitterresim.TwitterResimActivity$1.onClick(TwitterResimActivity.java:23)
04-24 15:53:32.786: E/AndroidRuntime(305):  at android.view.View.performClick(View.java:2364)
04-24 15:53:32.786: E/AndroidRuntime(305):  at android.view.View.onTouchEvent(View.java:4179)
04-24 15:53:32.786: E/AndroidRuntime(305):  at android.widget.TextView.onTouchEvent(TextView.java:6541)
04-24 15:53:32.786: E/AndroidRuntime(305):  at android.view.View.dispatchTouchEvent(View.java:3709)
04-24 15:53:32.786: E/AndroidRuntime(305):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
04-24 15:53:32.786: E/AndroidRuntime(305):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
04-24 15:53:32.786: E/AndroidRuntime(305):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
04-24 15:53:32.786: E/AndroidRuntime(305):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
04-24 15:53:32.786: E/AndroidRuntime(305):  at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1659)
04-24 15:53:32.786: E/AndroidRuntime(305):  at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1107)
04-24 15:53:32.786: E/AndroidRuntime(305):  at android.app.Activity.dispatchTouchEvent(Activity.java:2061)
04-24 15:53:32.786: E/AndroidRuntime(305):  at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1643)
04-24 15:53:32.786: E/AndroidRuntime(305):  at android.view.ViewRoot.handleMessage(ViewRoot.java:1691)
04-24 15:53:32.786: E/AndroidRuntime(305):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-24 15:53:32.786: E/AndroidRuntime(305):  at android.os.Looper.loop(Looper.java:123)
04-24 15:53:32.786: E/AndroidRuntime(305):  at android.app.ActivityThread.main(ActivityThread.java:4363)
04-24 15:53:32.786: E/AndroidRuntime(305):  at java.lang.reflect.Method.invokeNative(Native Method)
04-24 15:53:32.786: E/AndroidRuntime(305):  at java.lang.reflect.Method.invoke(Method.java:521)
04-24 15:53:32.786: E/AndroidRuntime(305):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
04-24 15:53:32.786: E/AndroidRuntime(305):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
04-24 15:53:32.786: E/AndroidRuntime(305):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T08:34:45.023

尝试将“lib”文件夹名称重命名为“libs”。这为我解决了这个问题，请在此处查看： [https ://github.com/ddewaele/AndroidTwitterSample/issues/2](https://github.com/ddewaele/AndroidTwitterSample/issues/2)

# android - 定位确定/取消按钮，以便它们模仿对话框中的布局

> ID：10301791
> 
> 赞同：9
> 
> 时间：2012-04-24T16:11:25.617
> 
> 标签：android, layout

正如你们中的一些人可能已经注意到的那样，Android 改变了 OK/Cancel 按钮在 ICS 之后的对话框中显示的顺序（请参阅[此问题](http://code.google.com/p/android/issues/detail?id=24138)）。这种改变可能是有道理的，我不反对它。我的问题是，你们如何处理同时支持新主题（由于操作栏）和“原始”主题的应用程序？我们如何协调布局中的顺序与对话框中的顺序？

我尝试查看对话框代码，但它没有做任何特别的事情，顺序是在布局文件中确定的（Holo 的样式不同）。是否有人创建了考虑到这一点的片段或小部件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-18T03:02:38.430

`layout-v14`您可以使用 ICS 中的按钮放置替代布局。事实上，当您在项目上运行 lint 时，它会建议您这样做。引用：

> 布局对 API >= 14 使用错误的按钮顺序：创建具有相反顺序的 layout-v14/layout.xml 文件：确定按钮应位于右侧（为“确定 | 取消”，应为“取消 | 确定”）

您可以使用 DialogFragment 创建具有自定义布局的对话框。

# php - 结果视图中的分页

> ID：10301792
> 
> 赞同：0
> 
> 时间：2012-04-24T16:11:29.657
> 
> 标签：php, mysql, pagination, pear

我目前正在使用 PHP PEAR 进行简单的分页。有没有人推荐如何在现有结果视图中对记录集进行分页的方法或示例？典型的模型是这样的：

```
Search -> Results -> View Record 
```

只能在“结果”页面中进行分页......我要问的是在“查看记录”中进行分页的能力。因此，您可以在查看记录时轻松分页到结果集中的下一个（或上一个）记录。显然，我可以将记录集状态和分页变量从结果页面传递到视图页面，但我想知道是否有更优雅的方法来做到这一点。有什么想法或建议吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T17:04:48.563

我认为 PEAR Pagination 代码在这里对您没有帮助。

假设您的查看记录页面有一个查询字符串参数 RecordID，您可以在查看记录页面上创建`Prev`和链接。`Next`为了获取上一条和下一条记录，您可以使用如下 SQL 语句：

**上一条**——`SELECT RecordID FROM records WHERE RecordID < '" . $CurrRecordID . "' ORDER BY RecordID DESC LIMIT 1`

**下一个**-`SELECT RecordID FROM records WHERE RecordID > '" . $CurrRecordID . "' ORDER BY RecordID ASC LIMIT 1`

如果您的结果页面排序不同，请进行相应更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T14:48:28.407

我想出了一种使用 PEAR 分页的方法。为了测试这一点，我复制了搜索结果页面，扩展了记录集，并从查看记录页面中提取了所有详细信息。基本上我让我的重复结果页面显示查看记录详细信息而不是搜索结果字段。接下来，我将分页结果限制为每页 1 条记录。要将其链接回原始搜索结果页面，我将 pageID 号传递给了重复页面。我必须通过计算结果集所在的页面来抵消它。这样，pageID 将准确地反映结果的数量。如果我每页返回 20 条记录并且我在结果集的第 2 页...我知道结果中的第一条记录需要 21 的 pageID。

# ruby-on-rails - rake db:migrate db:reset 和 db:schema:load 之间的区别

> ID：10301794
> 
> 赞同：686
> 
> 时间：2012-04-24T16:11:32.397
> 
> 标签：ruby-on-rails, ruby, database, rake

`rake db:migrate`和之间的区别`rake db:reset`对我来说很清楚。我不明白的是`rake db:schema:load`与前两者有何不同。

只是为了确保我在同一页面上：

*   `rake db:migrate`- 运行尚未运行的迁移。
*   `rake db:reset`- 清除数据库（可能是`rake db:drop`++ `rake db:create`）`rake db:migrate`并在新数据库上运行迁移。

* * *

## 回答 #1

> 赞同：1439
> 
> 时间：2012-04-24T16:48:46.120

*   **db:migrate**运行（单个）尚未运行的迁移。

*   **db:create**创建数据库

*   **db:drop**删除数据库

*   **db:schema:load**在 schema.rb 之后的现有数据库中创建表和列。这将删除现有数据。

*   **db:setup**执行 db:create, db:schema:load, db:seed

*   **db:reset**执行 db:drop, db:setup

*   **db:migrate:reset**执行 db:drop, db:create, db:migrate

通常，您将在通过新的迁移文件对架构进行更改后使用 db:migrate（这仅在数据库中已有数据时才有意义）。db:schema:load 用于设置应用程序的新实例。

我希望这会有所帮助。

* * *

rails 3.2.12 的更新：

我刚刚检查了源和依赖关系现在是这样的：

*   **db:create**为当前环境创建数据库

*   **db:create:all**为所有环境创建数据库

*   **db:drop**删除当前环境的数据库

*   **db:drop:all**删除所有环境的数据库

*   **db:migrate**为尚未运行的当前环境运行迁移

*   **db:migrate:up**运行一个特定的迁移

*   **db:migrate:down**回滚一个特定的迁移

*   **db:migrate:status**显示当前迁移状态

*   **db:rollback 回滚**上次迁移

*   **db:forward**将当前模式版本推进到下一个

*   **db:seed**（仅）运行 db/seed.rb 文件

*   **db:schema:load**将模式加载到当前环境的数据库中

*   **db:schema:dump**转储当前环境的模式（并且似乎也创建了数据库）

*   **db:setup**运行 db:create db:schema:load db:seed

*   **db:reset**运行 db:drop db:setup

*   **db:migrate:redo**根据指定的迁移运行 (db:migrate:down db:migrate:up) 或 (db:rollback db:migrate)

*   **db:migrate:reset**运行 db:drop db:create db:migrate

有关更多信息，请查看[https://github.com/rails/rails/blob/v3.2.12/activerecord/lib/active_record/railties/databases.rake](https://github.com/rails/rails/blob/v3.2.12/activerecord/lib/active_record/railties/databases.rake)（适用于 Rails 3.2.x）和[https://github .com/rails/rails/blob/v4.0.5/activerecord/lib/active_record/railties/databases.rake](https://github.com/rails/rails/blob/v4.0.5/activerecord/lib/active_record/railties/databases.rake)（适用于 Rails 4.0.x）

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2016-04-07T07:12:54.807

## TLDR

采用

*   `rake db:migrate`如果您想更改架构
*   `rake db:reset`如果您想删除数据库，请从 重新加载架构`schema.rb`，然后重新设置数据库的种子
*   `rake db:schema:load`如果您想将数据库重置为提供的模式`schema.rb`（这将删除所有数据）

## 解释

`rake db:schema:load`将按照文件中提供的方式设置架构`schema.rb`。这对于全新安装应用程序很有用，因为它不需要花费太多时间`db:migrate`

> 重要说明，`db:schema:load`将**删除**服务器上的数据。

`rake db:migrate`对现有架构进行更改。就像创建模式的版本一样。`db:migrate`将查找`db/migrate/`任何 ruby​​ 文件并从最旧的开始执行尚未运行的迁移。Rails 通过查看迁移文件名开头的时间戳来知道哪个文件最旧。`db:migrate`带来的好处是数据也可以放入数据库中。这实际上不是一个好习惯。它更好地用于`rake db:seed`添加数据。

`rake db:migrate`提供任务[up](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/railties/databases.rake#L93)，[down](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/railties/databases.rake#L100)等，启用命令`rake db:rollback`，使其成为最有用的命令。

`rake db:reset`执行一个`db:drop`并且`db:setup`
它删除数据库，再次创建它，加载模式，并使用种子数据进行初始化

### [来自databases.rake](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/railties/databases.rake)的相关部分命令

* * *

```
namespace :schema do
  desc 'Creates a db/schema.rb file that is portable against any DB supported by Active Record'
  task :dump => [:environment, :load_config] do
    require 'active_record/schema_dumper'
    filename = ENV['SCHEMA'] || File.join(ActiveRecord::Tasks::DatabaseTasks.db_dir, 'schema.rb')
    File.open(filename, "w:utf-8") do |file|
      ActiveRecord::SchemaDumper.dump(ActiveRecord::Base.connection, file)
    end
    db_namespace['schema:dump'].reenable
  end

  desc 'Loads a schema.rb file into the database'
  task :load => [:environment, :load_config, :check_protected_environments] do
    ActiveRecord::Tasks::DatabaseTasks.load_schema_current(:ruby, ENV['SCHEMA'])
  end 
```

* * *

```
 # desc 'Drops and recreates the database from db/schema.rb for the current environment and loads the seeds.'
  task :reset => [ 'db:drop', 'db:setup' ] 
```

* * *

```
namespace :migrate do
  # desc  'Rollbacks the database one migration and re migrate up (options: STEP=x, VERSION=x).'
  task :redo => [:environment, :load_config] do
    if ENV['VERSION']
      db_namespace['migrate:down'].invoke
      db_namespace['migrate:up'].invoke
    else
      db_namespace['rollback'].invoke
      db_namespace['migrate'].invoke
    end
  end 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2020-05-04T08:05:06.200

# 导轨 5

`db:create`- 为当前**RAILS_ENV**环境创建数据库。如果未指定**RAILS_ENV ，则默认为开发和测试数据库。**

`db:create:all`- 为所有环境创建数据库。

`db:drop`- 删除当前**RAILS_ENV**环境的数据库。如果未指定**RAILS_ENV ，则默认为开发和测试数据库。**

`db:drop:all`- 删除所有环境的数据库。

`db:migrate`- 为尚未运行的当前环境运行迁移。默认情况下，它将仅在开发环境中运行迁移。

`db:migrate:redo`-根据指定的迁移运行**db:migrate:down**和**db:migrate:up**或**db:migrate:rollback**和**db:migrate:up 。**

`db:migrate:up`- 为给定的迁移版本运行 up。

`db:migrate:down`- 为给定的迁移 VERSION 运行 down。

`db:migrate:status`- 显示当前迁移状态。

`db:migrate:rollback`- 回滚上次迁移。

`db:version`- 打印当前架构版本。

`db:forward`- 将架构推送到下一个版本。

`db:seed`- 运行**db/seeds.rb**文件。

`db:schema:load`从**schema.rb**文件重新创建数据库。**删除现有数据。**

`db:schema:dump`将当前环境的模式转储到**db/schema.rb**。

`db:structure:load`- 从**structure.sql**文件重新创建数据库。

`db:structure:dump`- 将当前环境的模式转储到**db/structure.sql**。（您可以使用 指定另一个文件`SCHEMA=db/my_structure.sql`）

`db:setup`运行**db:create**、**db:schema:load**和**db:seed**。

`db:reset`运行**db:drop**和**db:setup**。 `db:migrate:reset`- 运行**db:drop**、**db:create**和**db:migrate**。

`db:test:prepare`- 检查挂起的迁移并加载测试模式。（如果你在没有任何参数的情况下运行 rake，它会默认这样做。）

`db:test:clone`- 从当前环境的数据库模式重新创建测试数据库。

`db:test:clone_structure`- 类似于**db:test:clone**，但它将确保您的测试数据库与当前环境的数据库具有相同的结构，包括字符集和排序规则。

`db:environment:set`**- 在ar_internal_metadata**表中设置当前的**RAILS_ENV**环境。（用作受保护环境检查的一部分。）

 **`db:check_protected_environments`- 检查是否可以在当前**RAILS_ENV**环境中执行破坏性操作。在运行诸如**db:drop**或**db:schema:load**之类的破坏性操作时在内部使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-24T16:25:21.947

据我了解，它将删除您的数据库并根据您的`db/schema.rb`文件重新创建它。这就是为什么您需要确保您的`schema.rb`文件始终是最新的并处于版本控制之下的原因。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-12-09T04:17:14.163

### 列出所有任务

您可以通过从 Rails 应用程序目录运行以下命令来找到 Rails 提供的所有数据库任务。

```
➜  blog (main) ✗ bin/rails help | grep db:

db:create
db:drop
... 
```

### 概括

**db:create**：创建数据库，除非它已经存在。

**db:drop**：如果数据库存在则删除它。

**db:environment:set**：通过在内部表中设置当前环境来修复`EnvironmentMismatchError`or `NoEnvironmentInSchemaError`，如果在架构中找不到环境数据则引发。

**db:fixtures:load**：它加载夹具，即您要测试的样本数据。它们存储在`test/fixtures/`目录下的 YAML 文件中。

**db:migrate**：为当前环境运行所有尚未运行的迁移。

**db:migrate:down**`up` ：通过运行方法恢复上次迁移方法执行的转换`down`。

**db:migrate:redo**：回滚数据库一次迁移并重新向上迁移。

**db:migrate:status**：显示迁移的状态。

**db:migrate:up**：运行`up`给定迁移的方法。

**db:prepare**：`setup`如果数据库不存在则运行。否则，它将运行迁移。

**db:reset**：使用当前环境的迁移重置数据库。它通过运行`db:drop`, `db:create`,`db:migrate`任务来做到这一点。

**db:rollback**：将模式回滚到以前的版本，撤消刚刚运行的迁移。如果要撤消以前的`n`迁移，请传递`STEP=n`给此任务。

**db:schema:cache:clear**：清除任务生成的 db/schema_cache.yml 文件`db:schema:cache:dump`。

**db:schema:cache:dump**：创建一个 db/schema_cache.yml 文件。

**db:schema:dump**：创建一个数据库模式文件（`db/schema.rb`或者`db/structure.sql`，取决于`config.active_record.schema_format`）。

**db:schema:load**：将数据库模式文件（`db/schema.rb`或`db/structure.sql`，取决于`config.active_record.schema_format`）加载到数据库中。

**db:seed**`db/seeds.rb` ：从文件加载种子数据。

**db:seed:replant**：为当前环境截断每个数据库的表并加载种子

**db:setup**：创建所有数据库`db:create`，加载所有模式`db:schema:load`，并使用种子数据进行初始化`db:seed`。但是，如果它存在，它不会首先删除数据库。用于`db:reset`也首先删除所有数据库。

**db:structure:dump**：已弃用。它用于转储`structure.sql`文件。 **db:structure:load**：已弃用。它用于加载`structure.sql`文件。

> 有关这些任务为何被弃用的一些历史，请查看此[wtf](https://discuss.rubyonrails.org/t/db-schema-vs-db-structure/75406)。不，[认真](https://weblog.rubyonrails.org/2020/5/7/A-May-of-WTFs/)的。

**db:system:change**`rails new` ：在不指定数据库的情况下运行生成器会将您的应用设置为`sqlite`. 以后改数据库很麻烦。此任务通过委派给`rails db:change SYSTEM=postgresql|mysql|whatever`生成器来帮助您轻松更改数据库。

**db:version**：打印当前模式版本号。

资料来源：[Rails 中的所有数据库任务](https://akshaykhot.com/rails-database-tasks/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-07T18:20:18.730

您可以简单地查看 Active Record Rake 任务，因为我认为它们在此文件中存在。 [https://github.com/rails/rails/blob/fe1f4b2ad56f010a4e9b93d547d63a15953d9dc2/activerecord/lib/active_record/tasks/database_tasks.rb](https://github.com/rails/rails/blob/fe1f4b2ad56f010a4e9b93d547d63a15953d9dc2/activerecord/lib/active_record/tasks/database_tasks.rb)

他们做什么是你的问题吗？

这取决于它们来自哪里，这只是一个例子，表明它们因任务而异。在这里，我们有一个充满任务的不同文件。

[https://github.com/rails/rails/blob/fe1f4b2ad56f010a4e9b93d547d63a15953d9dc2/activerecord/Rakefile](https://github.com/rails/rails/blob/fe1f4b2ad56f010a4e9b93d547d63a15953d9dc2/activerecord/Rakefile)

其中有这些任务。

```
namespace :db do
  task create: ["db:mysql:build", "db:postgresql:build"]
  task drop: ["db:mysql:drop", "db:postgresql:drop"]
end 
```

这可能无法回答您的问题，但可以让您深入了解继续查看源代码，尤其是 rake 文件和任务。由于他们在帮助您使用 Rails 方面做得很好，他们并不总是能很好地记录代码。如果我们知道它应该做什么，我们都可以在那里提供帮助。**

# gwt - GWT 是否可以显式检测浏览器后退/前进按钮（不仅仅是从历史中推断）

> ID：10301798
> 
> 赞同：0
> 
> 时间：2012-04-24T16:12:05.207
> 
> 标签：gwt, browser-history

假设一个 GWT 应用程序转到 #a 然后 #b 然后 #a 然后用户按下并且我在历史记录中检测到 #b。

现在我得到一个历史事件“#a”。有什么方法可以判断用户是向前还是向后？

我可能会关心，因为#a 的页面可能是一个表单，我可能记得在内存中第二个#a 在表单中有一些未保存的数据类型，而第一个#a 没有！

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T19:30:41.387

不，这在技术上是不可能的。

（您可以使用 HTML5 History API –<code>pushState 和`onpopstate`– 但 GWT 没有内置支持）

# javascript - KnockoutJS 和计算属性不起作用

> ID：10301800
> 
> 赞同：0
> 
> 时间：2012-04-24T16:12:06.427
> 
> 标签：javascript, knockout.js

我刚刚开始淘汰这个模型和视图模型：

```
$(function() {

  // Class to represent a note
  function Note(title, content) {
    var self = this;

    self.title = ko.computed(function() {
  var title = title;
  if(title.length > 0) return title;

  if(self.content && self.content.length > 0) return self.content.substring(0,19) + "...";   
    });   

    self.content = ko.observable(content);

  }

  // Overall viewmodel for this screen, along with initial state
  function TaccuinoViewModel() {
    var self = this;

    // Editable data
    self.notes = ko.observableArray([
    ]);

    // Operations
    self.addNote = function() {
        self.notes.push(new Note());
    }
    self.removeNote = function(note) { self.notes.remove(note) }
  }

  ko.applyBindings(new TaccuinoViewModel());

}); 
```

问题出在计算属性上：我想要做的是：

1-)如果标题的长度 > 0，则使用它 2-)如果未定义，则使用内容中的前 20 个字符 + "..."

但这不起作用...

关于这样做的任何建议，还有其他方式吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T16:16:26.687

`self.content`是一个 observable，所以你需要调用它来获取当前值：

```
self.content = ko.observable(content);
self.title = ko.computed(function() {
    if(title.length > 0) return title;

    var currentContent = self.content(); // <-- get the current value
    if(currentContent) return currentContent.substring(0,19) + "...";   
}); 
```

请注意，我已将 observable “内容”的创建移到顶部，因为在创建计算后的 observable 时，它​​的初始值会计算一次 - 所以我们可能需要存在 observable 的“内容”。

# php - ExtJS 4 使用 Ext.form.field.File 代替 Ext.Form.Panel 如何提交

> ID：10301801
> 
> 赞同：0
> 
> 时间：2012-04-24T16:12:09.917
> 
> 标签：php, extjs

我正在成功使用 Ext.Form.Panel，但这次我想使用 Ext.form.field.File。我能够提交和上传将 field.file 信息放入 form.Panlen 的数据，我认为这不是唯一的选择。现在我有：

```
Ext.create('Ext.form.field.File', {
                            id: 'ala-bala',
                            name: 'doc',
                            width: 300,
                            buttonOnly: true,
                            hideLabel: true,
                            listeners: {
                                'change': function(fb, v){
                                    var el = Ext.getCmp('ala-bala-nica');
                                    el.update('<b>Selected:</b> '+v); 
```

这是我停靠的工具栏的一部分，我还有一个按钮：

```
xtype:'button',
                    icon: g_settings.iconUrl + 'add-icon.png',
                    text: 'Add File',
//                  handler: this._addDocument
                    handler: function() { 
                        var form = Ext.getCmp('ala-bala').getRawValue();
//                      if(form.isValid()){
                            form.submit({
                                }
                            } 
```

显然我不能用`form.submit`这个，但我希望有办法保留我的 form.field.File 并且仍然能够提交和上传我的文件。就是想不通。

谢谢

勒隆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:52:08.263

当我处理类似的问题时，我基本上是在创建一个虚拟表单并调用`submit()`这个表单。像这样的东西：

```
var form = Ext.create('Ext.form.Panel', {
  items: [ my_file_field ]
});

form.getForm().submit({
  method: 'POST',
  url: 'myservice.url',
  ...
}); 
```

# vb.net - 直接使用函数和作为 lambda 表达式

> ID：10301811
> 
> 赞同：3
> 
> 时间：2012-04-24T16:12:40.687
> 
> 标签：vb.net, linq, linq-to-sql, lambda

有没有更好的方法来实现这一点？我应该关注 Compile 方法的性能吗？

```
 Public Overrides Function GetValidSerialNumbers() As System.Collections.Generic.IEnumerable(Of SerialNumber)
        Return Queryable.Where(allSerials, SerialNumberValidFunc)
     End Function

     Public Overrides Function IsSerialNumberValid(serialNumber As SerialNumber) As Boolean
        Return (SerialNumberValidFunc.Compile().Invoke(serialNumber))
     End Function

     Private ReadOnly Property SerialNumberValidFunc As Expressions.Expression(Of Func(Of SerialNumber, Boolean))
        Get
           If ProductionReceiptLine.MOOutput Is Nothing Then
              Return Function(sn As SerialNumber) sn.ItemInventory Is Nothing AndAlso _
                    (sn.Status = SerialNumberStatusValues.Planned AndAlso sn.MO Is ProductionReceiptLine.ProductionReceipt.MO _
                     OrElse sn.Status = SerialNumberStatusValues.Assigned)
           Else
              Return Function(sn As SerialNumber) sn.ItemInventory Is Nothing AndAlso _
                    (sn.Status = SerialNumberStatusValues.Planned AndAlso sn.MO Is Nothing OrElse sn.Status = SerialNumberStatusValues.Assigned)
           End If
        End Get
     End Property 
```

我想要 lambda 表达式的原因是因为我希望该函数能够一直通过 LINQ-to-SQL 转换为 SQL。我想要直接版本的原因是因为我有其他代码要在提交更改之前验证各个序列号。而且我担心这`GetValidSerialNumbers.Contains(serialNumber)`会执行比必要更复杂的查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T19:44:45.060

Compile 方法非常慢，因为它需要从您的表达式中发出 IL。调用已编译的函数将导致另一个编译：JIT 编译。

我建议您将 Compile 的结果缓存在静态字段中。

您采用的一般方法很好。它是干燥的。

# eclipse - 你能配置 eclipse 来帮助一些导入而不是其他的吗

> ID：10301812
> 
> 赞同：2
> 
> 时间：2012-04-24T16:12:46.483
> 
> 标签：eclipse, content-assist, import

Eclipse 有时会自动将导入插入到我的 java 代码中，但它经常会出错。有没有办法配置它所做的猜测。例如，我想告诉它始终导入 java.util.List 而不是 java.awt.list。还有很多其他的错误，包括 Pattern、Matcher、Logger、Node 和 Element。所有这些我都有一个我一直使用的首选类，但还有许多其他具有相同名称的类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:25:44.263

您可以通过 Window | 将某些导入配置为从内容辅助对话框中隐藏。偏好 | 爪哇 | 外观 | 类型过滤器。

例如，添加一个过滤器，例如`java.awt.*`将隐藏`awt`包中的所有类型。

但是，这可能仅在您根本不使用这些类时才有用，因为它不会为它们显示任何内容辅助信息。我还没有遇到比其他包或类名更喜欢某些包或类名的方法。

窗下 | 偏好 | 爪哇 | 编辑 | 内容协助 | 收藏夹有一些添加类型和成员的选项，但我认为这些仅适用于静态成员。

# android - Web 视图在本机浏览器不冻结的地方冻结

> ID：10301816
> 
> 赞同：3
> 
> 时间：2012-04-24T16:12:59.797
> 
> 标签：android, android-webview, android-browser

所以我有一个自定义的 webView 似乎可以很好地接受我的应用程序所需的一个 url。我已经在平板电脑的本机浏览器中测试了相同的 url，它加载正常，但在我的自定义 web 视图中，它永远挂在加载中。其他 url 在我的 webview 上运行良好，只是这个。我的 webSetting 设置为允许插件，所以我认为这不是问题。我注意到屏幕开始变暗，就像页面加载一样，然后立即再次变暗。

我的网络视图：

```
public class Browser extends Activity {

    private WebView wv;

    private ProgressDialog progressBar;

    private static final String TAG = "Browser";

    private SharedPreferences prefs;
    private String prefName = Constants.prefName;

    private static final String TABLET_TYPE_KEY = Constants.TABLET_TYPE_KEY;
    private String tabletType;  

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);     

        prefs = getSharedPreferences(prefName, MODE_PRIVATE);

        tabletType = prefs.getString(TABLET_TYPE_KEY, "");

        boolean customerTablet = false;
        boolean associateTablet = false;
        boolean doctorTablet = false;
        boolean doctorDoctorTablet = false;

        if(tabletType.equals("Associate")) {
            associateTablet = true;
        }

        //--- FULLSCREEN ---
        requestWindowFeature(Window.FEATURE_NO_TITLE); 
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, 
                       WindowManager.LayoutParams.FLAG_FULLSCREEN);         
        //--- FULLSCREEN ---

        //this.getWindow().requestFeature(Window.FEATURE_PROGRESS);

        String url = "";
        String navtype = "";
        Bundle extras = getIntent().getExtras();
        if(extras != null) {
            url = extras.getString("url");
            navtype = extras.getString("navtype");
        }

        if(navtype.equals("nonav")) {
            setContentView(R.layout.browsernonav);
        }
        else {
            setContentView(R.layout.browser);
        }

        //WebView wv = (WebView) findViewById(R.id.webview1);
        wv = (WebView) findViewById(R.id.webview1);
        wv.setWebViewClient(new Callback());
        WebSettings webSettings = wv.getSettings();
        webSettings.setBuiltInZoomControls(true);
        webSettings.setJavaScriptEnabled(true);

        webSettings.setAppCacheEnabled(true);

        webSettings.setPluginsEnabled(true);
        webSettings.setPluginState(WebSettings.PluginState.ON);

        // Zoom only on 7 inch tablet
        if(associateTablet) webSettings.setDefaultZoom(WebSettings.ZoomDensity.FAR);        

        wv.addJavascriptInterface(new JavaScriptInterface(this), "Android");

        progressBar = ProgressDialog.show(Browser.this, "", "Loading...");

        final Browser MyActivity = this;

        if(!navtype.equals("nonav")) {
            final ImageView btn_back = (ImageView) findViewById(R.id.btn_back);
            btn_back.setOnClickListener(new View.OnClickListener() {
                public void onClick(View v) {
                    // Perform action on clicks
                    wv.goBack();
                }
            });      

            final ImageView btn_forward = (ImageView) findViewById(R.id.btn_forward);
            btn_forward.setOnClickListener(new View.OnClickListener() {
                public void onClick(View v) {
                    // Perform action on clicks
                    wv.goForward();
                }
            });
        }

        wv.loadUrl(url);

        //wv.setScrollBarStyle(WebView.SCROLLBARS_OUTSIDE_OVERLAY);                         

    }

    /*
    @Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {

        if (keyCode == KeyEvent.KEYCODE_BACK) {
            // close image gallery
            wv.goBack();
            return false; // this avoids passing to super
        }

        return super.onKeyDown(keyCode, event);
    }   
    */      

    private class Callback extends WebViewClient {
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            return(true);
        }
        @Override
        public void onPageFinished(WebView view, String url) {
            Log.i(TAG, "Finished loading URL: " +url);
            if (progressBar.isShowing()) {
                progressBar.dismiss();
            }
        }

        @Override
        public void onPageStarted (WebView view, String url, Bitmap favicon) {
            progressBar = ProgressDialog.show(Browser.this, "", "Loading...");
        }

    }

    public class JavaScriptInterface {
        Context mContext;

        /** Instantiate the interface and set the context */
        JavaScriptInterface(Context c) {
            mContext = c;
        }

        /** Show a toast from the web page */
        public void spawnPrintJob() {
            Uri uri = Uri.parse("file:///sdcard/medical_form.html");
            //Uri uri = Uri.parse("http://www.cnn.com");

            Intent i = new Intent(Intent.ACTION_VIEW);
            i.setPackage("com.dynamixsoftware.printershare");                   
            i.setDataAndType(uri, "text/html");
            //i.setDataAndType(uri, "image/jpeg");
            startActivity(i);                   

        }

        public void deleteForm() {
            //Toast.makeText(mContext, "Temp", Toast.LENGTH_SHORT).show();
            File sdCard = Environment.getExternalStorageDirectory();

            File[] toBeDeleted = sdCard.listFiles(new FileFilter() {  
                public boolean accept(File theFile) {  
                    if (theFile.isFile()) {  
                        return theFile.getName().endsWith(".html");  
                    }  
                        return false;  
                }  
            });  

            //System.out.println(Arrays.toString(toBeDeleted));  
            for(File deletableFile:toBeDeleted){  
                deletableFile.delete();  
            }                       
        }

    }

} 
```

网址再次在普通浏览器中加载正常......

# android - 应用内结算：确认退款通知

> ID：10301822
> 
> 赞同：0
> 
> 时间：2012-04-24T16:13:30.727
> 
> 标签：android, in-app-billing

上周，我做了一系列的应用内购买测试，一切都很顺利。但是，我在结帐时取消了我的命令，因此，谷歌播放不断向我发送取消通知。

显然 googleplay 不理解我的确认并连续循环通知我。

在 onPurchaseStateChanged 中，在 JSON 解析之后：

```
ArrayList<String> confirmations = new ArrayList<String>();

for (Trans p : transactions)
{
    [...]
    if (p.purchaseState.ordinal() == PurchaseState.CANCELLED.ordinal())
         confirmations.add(p.notificationId);
}
if (!confirmations.isEmpty())
{
    final String[] notifyIds = confirmations.toArray(new String[confirmations.size()]);
    confirmNotifications(context, notifyIds);
} 
```

.

```
public static void confirmNotifications(Context context, String[] notifyIds) 
{
    final Intent intent = createIntent(context, Action.CONFIRM_NOTIFICATIONS);
    intent.putExtra(EXTRA_NOTIFY_IDS, notifyIds);
    context.startService(intent);
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T01:43:01.127

你想从这里开始什么服务？你自己？最终，您需要绑定到 Market/Play 商店的计费服务并`sendBillingRequest()`使用正确填充的`Bundle`. 你的代码会这样做吗？

# ruby-on-rails - 用于导轨的 Lighttpd 或薄型

> ID：10301826
> 
> 赞同：1
> 
> 时间：2012-04-24T16:13:41.927
> 
> 标签：ruby-on-rails, webserver, lighttpd, thin

我目前正在 Heroku 上运行一个简单的 Rails 应用程序。但是，它似乎真的很慢。可能是因为我的 Rails 应用程序配置为在 Webbrick 上运行吗？

我环顾四周，听说了“瘦”和“lighttpd”。

这些网络服务器有什么区别？当涉及到 rails 时，lighttpd 是一个选项吗？- 运行我的 Rails 应用程序会更好，因为它是基于 ruby​​ 的？很抱歉问题的数量，对网络服务器不是很技术性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T15:18:47.853

您的问题有点泛滥，所以我会回答主题，但目前无法提供技术帮助。

lighttpd 是一个 HTTP 服务器。它真的什么也没做。其他编程框架使用 FastCGI 来处理请求。[LighttpdOnRails](http://redmine.lighttpd.net/projects/lighttpd/wiki/LighttpdOnRails)是关于设置 Rails 以在 lighttpd 上运行的一个很好的演练。如果您只使用 Rails，您可能需要其中一种替代方法，但 lighttpd 提供了其他方法所没有的极大灵活性。（自插：我维护[crosslight](http://code.google.com/p/crosslight/)，一个使 lighttpd 安装和配置变得容易的工具）。

Webbrick 是用于 Rails 应用程序的专用服务器组件。您的应用程序将其作为库包含，并自行启动。对于独立的应用程序来说，这是一个很好的解决方案。

Thin 是一个专用的 servlet 容器。它是一个独立软件，可将您的代码作为库运行。它允许您的代码更加模块化，因为它负责配置所有内容。

如果您认真地认为 Webbrick 是您的性能瓶颈，那么您接下来可能会想尝试 Thin。如果它仍然运行缓慢，并且您想尝试一下 ligghtpd，那就去尝试一下，但那时它可能是您的应用程序。

我很抱歉没有对性能问题给出更具体的答案，但希望这能解决处理这些工具的更大问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:10:37.670

如果您将 Rails 应用程序部署到 Heroku，请确保添加

```
gem "thin" 
```

进入你的`Gemfile`.

这很容易忘记，但它有很大的不同。

# json - RJSONIO 加载数组失败

> ID：10301829
> 
> 赞同：1
> 
> 时间：2012-04-24T16:14:05.910
> 
> 标签：json, r

嗨，我正在使用 RJSONIO 加载一个 json 文件 test.json，它的结构非常简单，例如：

```
{
   "exps" :   [
    {   
        "model" : "lm",
        "featTran" : false,
        "factor" : true
    },
    {
        "model" : "J48",
        "featTran" : true,
        "factor" : true
    },
    {
        "model" : "NULL"
    }   
    ]
} 
```

加载命令只是：

```
 config<-fromJSON(file("./test.json", "r")) 
```

在数组中添加第三个对象（“NULL”模型）时，RJSONIO 只返回一个空白列表（）。但是，仅使用前两个对象时，加载没有问题。

# c++ - 浮点数据在 istream 输入到整数时意外成功

> ID：10301832
> 
> 赞同：4
> 
> 时间：2012-04-24T16:14:13.487
> 
> 标签：c++, templates, int, double

我正在编写一个模板函数，它将检查用户是否分配了答案应该包含的正确数据类型。例如：

```
int main(){

    int E;
    cout<<"Enter an integer: "<<endl;
    E = clear_and_read<int>(cin);
    cout<<E<<endl;

} 
```

其中函数`clear_and_read`定义为：

```
template <class T> T clear_and_read(istream& inputstream){
    cin.sync();//removes anything still in cin stream
    cin.clear();
    T input;
    inputstream>>input;       
    while(inputstream.fail()){
        cout<<endl<<"Please ensure you are inputting correct data type. Suggested data type: "<< typeid(input).name() <<"."<<endl;
        cin.sync();
        cin.clear();
        inputstream>>input;  
    }
    return input;
} 
```

现在，如果我尝试输入 a`string`而不是a ，这将起作用`integer`，但是当我输入 a 时`double`，它只会分配它的第一个值。例如 5.678 变为 5。

`double`如果 a被读入a ，我可以在模板函数中做些什么来标记`int`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:20:40.600

我会尝试与您略有不同的方法。具体来说，我不会尝试修改输入流的错误状态：

```
// Untested
template <class T> T clear_and_read(istream& inputstream) {
  std::string inputString;
  while(1) {
    try {

      // Grab one maximally-sized whitespace-delimited chunk of input
      inputstream >> inputString;

      // Note: lexical_cast throws if there are any extraneous characters.
      return boost::lexical_cast<T>(inputString);

    } catch (boost::bad_cast&) {
      std::cout << "\nPlease ensure you are inputting correct data type. Suggested data type: "<< typeid(input).name() <<".\n";
    }
  }
} 
```

* * *

**注意**：如果您的编译环境中没有可用的 boost，那么您`lexical_cast`自己实现起来相当简单。如果您遇到困难，请寻求帮助。

* * *

参考：

*   [http://www.boost.org/doc/libs/1_49_0/doc/html/boost_lexical_cast.html](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_lexical_cast.html)

* * *

**编辑**这是一个经过全面测试的版本，不依赖于 Boost。

```
#include <exception>
#include <sstream>
#include <string>
#include <iostream>
#include <typeinfo>

template <class T> T clear_and_read(std::istream& inputstream) {
  std::string inputString;
  while(inputstream) {
      // Grab one maximally-sized whitespace-delimited chunk of input
      inputstream >> inputString;
      std::istringstream itemstream(inputString);

      // Convert it:
      T t;
      itemstream >> t;

      // See if conversion worked and consumed everything
      if(itemstream && (itemstream.get() == EOF)) {
        // SUCCESS
        return t;
      }

      // oops
      std::cout << "\nPlease ensure you are inputting correct data type. Suggested data type: "<< typeid(T).name() <<".\n";
  }
  std::cout << "What to do with EOF?\n";
  return T();
}

int main () {
  clear_and_read<int>(std::cin);
  clear_and_read<double>(std::cin);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:18:57.997

您必须检查 inputstream 的整个输入是否已被消耗。operator>> 在遇到第一个非数字时停止转换为整数。同样，“3.14qwe”将转换为 3.14 双精度。

# c# - 将文件从 csv 上传到 SQL

> ID：10301838
> 
> 赞同：1
> 
> 时间：2012-04-24T16:15:02.770
> 
> 标签：c#, asp.net, file-upload

我之前有一个 FileUpload 控件，可以将每个文件单独上传到数据库中。但现在我希望能够批量上传。

我的要求是 csv 文件包含文件名和文件路径，我需要使用 FileUpload 上传 csv 并最终运行读取 csv 并将每个文件插入表申请人附件的代码。ApplyAttachment 具有列文件名 (NVARCHAR)、文件路径 (NVARCHAR)、附件 (VARBINARY)。在这个附件列中，我需要保存 csv 中提到的文件的二进制格式。我的 CSV 看起来像这样 FileName FilePath dl-54a.pdf c:\users\abc\desktop\dl-54a.pdf xyz.doc c:\users\abc\desktop\xyz.doc

我希望我能做这样的事情。但我知道我们不能将文件名等分配给 Fileupload 对象。任何的意见都将会有帮助。

```
 <asp:FileUpload ID="csvFile" runat="server" Width="400" /></td>
    <asp:Button ID="btnUpload" Text="Upload" runat="server" OnClick="btnUpload_Click" /></td>
    protected void btnUpload_Click(object sender, EventArgs e)
    {
        if (csvFile.HasFile)
        {
            List<string[]> filesToUpload = parseCSV(csvFile.PostedFile.FileName);
            SaveFiles(filesToUpload);
        }
    }

    public List<string[]> parseCSV(string path)
    {
        List<string[]> parsedData = new List<string[]>();
        try
        {
            using (StreamReader readFile = new StreamReader(path))
            {
                string line;
                string[] row;

                while ((line = readFile.ReadLine()) != null)
                {
                    if (!readFile.ReadLine().Contains("ApplicantId"))
                    {
                        row = line.Split(',');                            
                        parsedData.Add(row);
                    }
                }
            }
        }
        catch (Exception e)
        {
            ;
        }

        return parsedData;
    }

    private void SaveFiles(List<string[]> files)
    {
        foreach (string[] attachment in files)
        {
            using (DataClasses1DataContext db = new DataClasses1DataContext())
            {
                FileUpload fu = new FileUpload();
                fu.FileName = attachment[1].ToString();
                if (fu.HasFile)
                {
                    ApplicantAttachment aa1 = new ApplicantAttachment();
                    aa1.Filename = attachment[0].ToString();
                    aa1.FileType = fu.PostedFile.ContentType;
                    aa1.Attachment = fu.FileBytes;
                    db.ApplicantAttachments.InsertOnSubmit(aa1);
                    db.SubmitChanges();
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:25:48.157

这是有效的。无法使用文件上传。

```
 private void SaveFiles(List<string[]> files)
     {
        foreach (string[] attachment in files)
        {
            using (DataClasses1DataContext db = new DataClasses1DataContext())
            {
                string path = attachment[1].ToString();
                byte[] fileBytes = File.ReadAllBytes(path);

                ApplicantAttachment aa1 = new ApplicantAttachment();
                aa1.Filename = attachment[0].ToString();
                aa1.FileType = MIMEType.GetType(attachment[1].ToString());
                aa1.Attachment = fileBytes;
                db.ApplicantAttachments.InsertOnSubmit(aa1);
                db.SubmitChanges();

            }
        }
     } 
```

# php - 在 Aptana 中上传 php 脚本

> ID：10301839
> 
> 赞同：0
> 
> 时间：2012-04-24T16:15:05.783
> 
> 标签：php, aptana

我最近开始使用 Aptana Studio，我想知道如何在 Aptana Studio 3 中本地上传 php 文件。我使用过提供上传按钮的 dreamweaver cs5。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:17:57.983

抱歉，但最好的办法是使用外部 FTP 程序，Eclipse/Aptana 中的 FTP 实在令人沮丧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:36:44.587

这确实有点棘手，但正如@ianbarker 所说的那样。按着这些次序 ：

第 1 步：创建新的 Web 项目 -> 命名 -> 选择位置 -> 完成；

第 2 步：在 aptana 的左侧视图中，您应该有 2 个选项卡；选择应用程序资源管理器，然后从下拉列表中选择您的项目；

第三步：比下拉列表高一点，你应该有一组四个按钮。点击第二个（应该命名为发布）；而不是单击“运行 Web 部署向导...”

第 4 步：从刚刚打开的窗口中，选择 fpt/sftp/ftps -> 点击下一步

第 5 步：将打开一个新窗口。您将必须填写如下字段：

站点名称：您要命名连接的方式

服务器：`ftp.yourdomain.com`或简单地说`domain.com`，或您尝试连接的服务器的 IP 地址。

用户名/密码：您的主机持有人提供的用户名。勾选“保存”；

远程路径：点击浏览；选择您的站点所在的 ftp 上的文件夹；

连接模式：被动；

编码：随心所欲

时区：点击“检测”

检查 Automaticaly...blah blah blah 然后检查“...双向”

结束;

第 6 步：如果您再次单击“发布”按钮，您将看到更多选项。我通常使用“传输文件”。点击它。在您的编辑器窗口中会出现两个小窗口。你左边的一个包含存储在本地机器上的文件，你右边的一个是服务器。中间有三个按钮： “上传” - 将所有文件从本地机器上传到服务器；注意，它会覆盖现有文件。“下载” - 与“上传”完全相反。同步 - 比较本地服务器上的文件，并为更新本地和服务器计算机上的文件提供最佳选项。如果您希望同步正常工作，则必须在时区字段中单击“检测”，因为 aptana 还通过文件的“更新日期”标题进行比较

# android - 使用警报管理器启动服务，但仅在主应用程序未运行时

> ID：10301841
> 
> 赞同：1
> 
> 时间：2012-04-24T16:15:21.617
> 
> 标签：android, android-service, alarmmanager, intentservice

好的，这里的问题是我有一个通过蓝牙连接到手机的摄像机。与设备的所有通信都是通过 android 服务进行的。该服务会定期使用 GPS 坐标更新相机。不幸的是，该服务不是由我的公司编写的，我们只能控制它的启动和发送命令（但是，如果连接到设备，它会自行执行 GPS）。一旦我们的应用程序启动了服务，我们就会尝试连接到任何包含我公司 OUI 的配对设备。一旦设备断开连接（可能是关闭或电池耗尽），它不会自动重新连接，直到用户重新启动我们的应用程序。因此，在这种情况下，GPS 坐标不会被发送到相机。

这是一个问题，因为用户（对这些服务一无所知，什么都不知道）会认为如果他重新打开设备，它应该被连接。

所以我想我可以将 AlarmManager 与广播接收器或服务一起使用（可能是意图服务，因为连接需要几秒钟才能完成）。也许每隔几分钟我可以检查一次与相机的连接。如果它的存在只是退出，并且如果没有尝试连接（如果有配对的设备）。

但是问题是如果我的应用程序已经在运行怎么办？如果是，则用户控制连接到设备（提示他们）。我是否需要使用共享首选项或类似的东西来判断我的应用程序是否正在运行/关闭？有什么方法可以从服务中判断应用程序是否正在运行？我可以看到这变得棘手。如果有人知道如何处理这个问题，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:19:43.253

我会建议以下方法：

1.  设置警报以在 X 分钟内启动服务
2.  立即为应用程序设置计时器 X-1 分钟
3.  当应用的定时器到时：取消当前并为服务设置新的闹钟，为应用设置新的定时器。

这样，如果应用程序仍在运行，服务将不会启动，并且一旦应用程序关闭，警报也不会停止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T23:22:38.967

Binyamin Sharet 的回答很好，但不幸的是它并没有解决我的问题，因为当应用程序不再可见或正在使用时，它可能仍在运行，并且应用程序需要很长时间才能真正关闭。另一件需要注意的是，当您的服务/侦听器或任何其他组件启动时，它将实例化您的 Application 类，这会使事情变得棘手。

也许我的问题措辞不佳。但是，我想要的是防止我的应用程序在它主动打开（或正在使用）时尝试重新建立连接。

事实证明，只需将状态（忙/不忙）写入共享首选项并在我从警报管理器运行的代码中检查它就更容易完成。这是一个我不想要的额外状态，但实际上并不太难。

我使用 commonsware 唤醒意图每分钟醒来并执行以下操作：

1.  检查应用程序是否正在控制它（来自共享首选项），如果是，则退出
2.  检查蓝牙是否开启，如果没有退出
3.  绑定到与设备对话的服务并检查是否已经连接，如果是则退出
4.  如果没有连接设备（但有设备配对），则尝试连接

虽然我可能能够优化它，但它似乎可以工作并且非常有效。我知道这对电池来说不是很好，但我仍然没有在使用我的电池的应用程序列表中看到我的应用程序（尽管 android 似乎使用更多）。

我能想到的唯一真正的改进是：

1.  如果我已经连接，请停止每分钟唤醒服务，直到它断开连接。
2.  当蓝牙被禁用时停止唤醒服务。重新启用后，开始尝试再次每分钟重新连接。我相信有一种方法可以通过使用意图过滤器启用蓝牙时得到通知。

为简单起见，我还没有实现这些。

# sql-server-2005 - 事件表行到列使用 CTE？

> ID：10301844
> 
> 赞同：2
> 
> 时间：2012-04-24T16:15:28.360
> 
> 标签：sql-server-2005

我已经狩猎了两天寻找我需要的东西无济于事。我相信这也很简单，但这不是我的包。

我的表存储了一个 EmployeeID 和时间戳。我需要选择每隔一行，以便奇数行和偶数行映射到新列，如下所示：

输入表 TimePunches：

```
员工ID时间
1 08:00:00
1 12:00:00
1 12:30:00
1 17:00:00

```

输出表：

```
员工 TimeIn TimeOut
1 08:00:00 12:00:00
1 12:30:00 17:00:00

```

在弄清楚如何将行转换为恰好两列之后，我将从每个输出行计算时间。我意识到如果它不返回偶数行，这会输出垃圾，但我想先做到这一点；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T18:30:48.743

另一个解决方案涉及`ROW_NUMBER()`并且，为了改变，`PIVOT`：

```
WITH prepared AS (
  SELECT
    EmployeeID,
    Time,
    TimeRow  = (ROW_NUMBER() OVER (PARTITION BY EmployeeID ORDER BY Time) - 1) / 2
    TimeKind =
      CASE (ROW_NUMBER() OVER (PARTITION BY EmployeeID ORDER BY Time) - 1) % 2
        WHEN 0 THEN 'TimeIn'
        WHEN 1 THEN 'TimeOut'
      END
  FROM TimePunches
)
SELECT
  EmployeeID,
  TimeIn,
  TimeOut
FROM prepared
PIVOT (
  MAX(Time) FOR TimeKind IN (TimeIn, TimeOut)
) p
ORDER BY
  EmployeeID,
  TimeRow 
```

您可以[在 SQL Fiddle 上](http://sqlfiddle.com/#!3/f9bf7/2)使用此查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:31:36.083

One solution might be, in pseudo-code:

```
declare @timeIn datetime, @timeOut datetime
declare @emp int

get one row at a time {

if (row is even)
  @timeIn = Time from row
}
else {
  @timeOut = Time from row
  @emp = Employee from row
  insert into #tempTable @emp, @timeIn, @timeOut
}

select #tempTable 
```

To get a row at a time you can use ROW_NUMBER or cursors.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T16:43:00.953

作为记录，需要更改此表结构，但可以做您想做的事情。这个查询让我感到各种肮脏，我永远不会考虑在我的代码中使用它，但它会起作用，所以请考虑一下你自己。

```
with rank1 as (
SELECT EmployeeID, Time, RANK() OVER (PARTITION BY EmployeeID ORDER BY Time) as rank
FROM TimePunches),
rank2 as (
SELECT EmployeeID, Time, RANK() OVER (PARTITION BY EmployeeID ORDER BY Time) as rank
FROM TimePunches)

SELECT rank1.EmployeeID, rank1.Time as timeIn, rank2.Time as timeOut
FROM rank1
JOIN rank2 on rank1.EmployeeID = rank2.EmployeeID AND rank1.rank % 2 = 1 AND rank1.rank - (rank1.rank % 2) = rank2.rank 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T16:22:45.440

```
with prepared_data as (
  select
    EmployeeID,
    Time,
    row_number() over(partition by EmployeeID order by Time) as num
  from TimePunches
)
select
  p1.EmployeeID,
  p1.Time as TimeIn,
  p2.Time as TimeOut
from
  prepared_data p1
  left join prepared_data p2 on p1.EmployeeID = p2.EmployeeID and p1.num + 1 = p2.num
where
  p1.num % 2 = 1
order by
  p1.EmployeeID,
  p1.num 
```

# eclipse - 在代码库中同步 Eclipse .classpath

> ID：10301845
> 
> 赞同：3
> 
> 时间：2012-04-24T16:15:34.803
> 
> 标签：eclipse, version-control, classpath

我的团队使用 Eclipse 处理多个 Java 项目，并使用代码存储库共享代码。

当开发人员添加、删除或更新`jar`文件时，其他所有人的构建都会中断，直到他们在 Eclipse 中更新他们的构建路径。此过程涉及繁琐的电子邮件同步。

出于多种原因，我们决定不将该`.classpath`文件提交到 repo。相反，我们提出了以下想法：每个项目都会有一个已提交的文件，比如`jars.list`，其中包含一个`jar`文件列表（和模式）。脚本会将此文件转换`.classpath`为 Eclipse 的本地文件。每当开发人员更改其 jar 时，他或她有责任更改`jars.list`并提交它。

这是一个合理的解决方案吗？有没有针对这个问题的现有解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T20:15:51.600

Eclipse`.project`和`.classpath`文件旨在/设计为检查到版本控制存储库（cvs、svn、git 等）中。请参阅Eclipse wiki 中的[此页面](https://wiki.eclipse.org/FAQ_How_do_I_set_up_a_Java_project_to_share_in_a_repository%3F)。

有多种方法可以保持`.classpath`文件“干净”（即，没有绝对路径），我在上面的评论部分中提到过。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T16:56:17.637

构建被破坏是因为每个开发人员机器的 JAR 的绝对路径不同？如果是这样，您可以添加一个用户变量来避免该问题，这样每个开发人员只需配置一个变量（如`LIB_DIR`）：

```
<classpathentry kind="var" path="LIB_DIR/path/to/file.jar"/> 
```

还有其他解决方案。您可以在 eclipse 中配置一些用户库来对 JAR 进行分组，然后导出一个`.userlibraries`可以在您的存储库中共享的文件。这样， 中就没有绝对路径`.classpath`，但它们会出现在您的`.userlibraries`.

您还可以使用 Maven 之类的工具来管理项目的依赖关系。

无论如何，我认为您可以`.classpath`毫无问题地分享...

# iphone - 过度释放视图时 EGOTableViewPullRefresh 崩溃

> ID：10301846
> 
> 赞同：1
> 
> 时间：2012-04-24T16:15:38.137
> 
> 标签：iphone, ios, xcode, pull-to-refresh

我嵌入了我的项目**EGOTableViewPullRefresh**，一切正常并且更新正常，但是当我将视图拉下太多以进行更新时，应用程序崩溃并出现错误：

> 2012-04-24 19:02:56.670 测试 [3927: f803] *** 由于未捕获的异常“NSRangeException”而终止应用程序，原因：“*** - [__NSArrayM objectAtIndex:]：空数组的索引 2 超出范围” ***第一次抛出调用堆：

一段代码

```
self.tabBarController = [[[UITabBarController alloc] init] autorelease];
NSMutableArray * viewControllers = [[NSMutableArray alloc] init];

//plist file full path
NSString *urlStr = [[NSString alloc] 
                    initWithFormat:@"http://www.test.com/data.xml?seedVar=%f", 
                    (float)random()/RAND_MAX];
NSURL *url = [NSURL URLWithString:urlStr];
NSDictionary *dict = [[NSDictionary alloc] initWithContentsOfURL:url];

  //Get the folder array
NSArray * subscriptionFolders = [dict objectForKey:@"Folders"]; 
```

**更新**

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier] autorelease];
        [cell.textLabel setNumberOfLines:2];
        [cell.detailTextLabel setNumberOfLines:3];
        [cell setAccessoryType:UITableViewCellAccessoryDisclosureIndicator];
    }

    RSSItem * rssItem = (RSSItem *)[_rssParser.rssItems objectAtIndex:indexPath.row];
    [cell.textLabel setText:rssItem.title];
    [cell.detailTextLabel setText:rssItem.summary];

    return cell;
} 
```

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T11:38:04.317

我找到了解决方案。当我在**reloadTableViewDataSource中调用****rssParser**时，它崩溃了。当我尝试在**dataSourceDidFinishLoadingNewData**中调用**rssParser**时，一切正常而不会崩溃。

 ******```
- (void)reloadTableViewDataSource{
[super performSelector:@selector(dataSourceDidFinishLoadingNewData) withObject:nil afterDelay:2.0];
}

- (void)dataSourceDidFinishLoadingNewData{
    [_rssParser start];
    [refreshHeaderView setCurrentDate]; 
    [super dataSourceDidFinishLoadingNewData];   
} 
```******

# mysql - 什么是 sql_field_str2wordcount？

> ID：10301849
> 
> 赞同：0
> 
> 时间：2012-04-24T16:16:04.937
> 
> 标签：mysql, ruby-on-rails-3, thinking-sphinx

什么是 sql_field_str2wordcount？

我知道它会计算 sphinx 搜索中文档中的单词数。

我正在运行一个 ruby​​ on rails 应用程序，并考虑 sphinx 连接到 sphinx 搜索启用 mysql 数据库。

**我应该在哪个文件中设置这个值？
sql_field_str2wordcount。**

请用例子向我解释。

全世界没有可用的适当文档。

谢谢。

# android - 如何显示自定义强制关闭对话框？

> ID：10301850
> 
> 赞同：0
> 
> 时间：2012-04-24T16:16:06.253
> 
> 标签：android

前几天在 Galaxy Tab 10.1 上进行的一些测试中，Facebook 应用程序强制关闭。然而，“强制关闭”对话框看起来不同；有两个按钮，“强制关闭”和“报告”。如果我点击“报告”，我可以选择输入额外的文本、预览并发送报告。对于任何应用程序从用户那里收集诊断信息来说，这似乎都是一个有价值的工具；但我怎样才能在我的应用程序中实现它？我很想看到一个教程或完整的工作示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:18:57.073

一定要检查一下[ACRA](http://code.google.com/p/acra/)的设置不需要很长时间，并且可以报告未捕获的异常和错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:56:48.310

这听起来像是默认的错误报告对话框。在调试时你永远不会看到它。它只会向从 Google Play 下载您的应用的最终用户显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T16:17:01.900

到目前为止，我已经看到了一些链接，例如[How to give event on force close dialog's ok button](https://stackoverflow.com/questions/6826704/how-to-give-event-on-force-close-dialogs-ok-button)和[Ideal way to set global uncaught exception Handler in Android](https://stackoverflow.com/questions/2764394/ideal-way-to-set-global-uncaught-exception-handler-in-android)提到了 UncaughtExceptionHandler，还有一张海报甚至提到了 Acra，但我还没有看到一个有效的例子.

# php - jQuery.post 在一台 PC 上返回 -1 但在另一台 PC 上成功

> ID：10301854
> 
> 赞同：0
> 
> 时间：2012-04-24T16:16:16.187
> 
> 标签：php, ajax, jquery

我正在使用 jQuery.post 进行一些 jquery ajax 编码。在我的电脑（我用来通过 ftp 编辑代码的电脑）上，代码运行良好（我已经将代码放在外部主机/网站上）。但是当我使用我的笔记本电脑甚至我朋友的 PC 进行检查时，我总是得到 -1 的回报。

这是我用于 .post 的代码

```
jQuery.post("<?php echo admin_url('admin-ajax.php'); ?>", data, function(response) {
                alert('Got this from the server: ' + response);
            });

// admin_url is wordpress function to return ajax located file 
```

它甚至发生在我的办公室。在 PC 上，我正在编辑代码。我得到正确的返回值。但不是当我使用另一台电脑时。

所以我想问

1.  有什么办法可以调试这个-1

2.  这种可能有什么问题。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-24T16:18:47.603

当你得到（-1）时你登录了吗？

# php - 在 codeigniter 中，将 URI 段传递给您的函数是否安全？

> ID：10301855
> 
> 赞同：1
> 
> 时间：2012-04-24T16:16:19.620
> 
> 标签：php, codeigniter, model, controller, uri

这是 URI:`example.com/index.php/products/shoes/sandals/123`这是相应的控制器：

```
<?php
class Products extends CI_Controller {

    public function shoes($sandals, $id)
    {
        $this->some_DB_using_Model->getListUsing($sandals,$id)
    }
}
?> 
```

直接发送到模型是否安全`$sandals`，或者我应该在发送之前应用过滤器。

编辑：

```
function getListUsing($p1,$p2){
     $this->db->start_cache();
     $this->db->select('a');
     $this->db->select('b');
     $this->db->select('c');
     $this->db->where('p1',$p1);
     $this->db->where('p2',$p2);
     //then return the result
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:21:16.310

这取决于模型在做什么。如果您在数据库查询中使用它，那么，是的，您需要转义它。

如果您使用 CodeIgniter 的活动查询，它会为您转义内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:25:41.813

URI 变量有一些限制，例如 config.php 文件中 uri 段中允许的字符，并且在核心中，有一个名为 _filter_uri($str) 的函数来清理 uri 中的恶意字符，如果您不允许使用引号或双引号在您的 uri 中使用引号，并使用 CI 数据库驱动程序进行 SQL 变量清理，它不会对您的系统造成任何问题。

例如;

```
$this->db->query("update table set a=? where b=?",array($a_value,$b_value)); 
```

比：

```
$this->db->query("update table set a='".$a_value."' where b='".$b_value."'"); 
```

你可能知道。

这里的主要问题是；

1.  您是否想向用户显示一些变量，
2.  SEO相关问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T17:20:40.243

叫我老式的，但我仍然喜欢把我的 SQL 语句写出来。话虽如此，我使用[查询绑定](http://codeigniter.com/user_guide/database/queries.html)以便自动为我转义值。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-04-24T16:27:58.010

我建议您使用 sparks 它会为您转义所有数据，因为您记得永远不要相信用户输入/您也可以使用该功能来转义每个段。IE

www.example.com/controllername/$item1/$item2

```
public function controllername ($item1,$item2)
{
  //sanitazi the data
   htmlentities($item1)
   htmlentities($item2)

//after this performed the call to your model by passing the new var or array 

} 
```

# java - 单个 hadoop Mapper 对象是否用于多次调用 map()？

> ID：10301858
> 
> 赞同：4
> 
> 时间：2012-04-24T16:16:26.357
> 
> 标签：java, hadoop, mapreduce, hbase, hdfs

所以，我有一个更新 HBase 表的 Mapper。在 map() 函数中，我：

1) 实例化一个 HBaseConfiguration

2）实例化一个HTable

3) 多次调用 hTable.put() 来添加行

4) 调用 hTable.flushCommits() 刷新我的更改

5) 调用 HConnectionManager.deleteConnection() 来终止与 HBase 的连接

但是，这似乎效率低下。我想在我的 Mapper 类的构造函数中实例化 HBaseConfiguration 和 HTable。然后我可以让我的映射器类实现 Closeable，在 close() 方法中调用 hTable.flushCommits() 和 HConnectionManager.deleteConnection()。这样，在每次调用 map() 时，我都会缓冲我的 put() 调用，并在调用 close() 时一次刷新所有更改。

但是，只有当 Mapper 对象被重复用于对 map() 的多次调用时，这才是值得的。否则，我不妨不理会我的代码。

所以主要问题是：Mapper 对象是否用于多次调用 map()？

额外的问题是：重写的代码会更有效率吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T16:55:26.437

您正在寻找的是`setup`和`cleanup`。`setup`之前运行一次`map`被调用了很多次，并且`cleanup`在所有`maps`被调用之后被调用一次。你覆盖这些就像你覆盖一样`map`。

`HBaseConfiguration`为您的和使用私有成员对象`HTable`。在`setup`. 做你`hTable.put()`的`map`。做`hTable.flushCommits()`和`HConnectionManager.deleteConnection()`在你的`cleanup`. 您可能需要注意的唯一一件事是刷新提交，而不是仅在最后刷新提交，以防您缓冲的数据超出内存可以处理的数量。在这种情况下，您可能希望通过跟踪您看到的记录数来刷新地图中的每 1000 条记录或其他内容。

这肯定会更有效率！打开和关闭该连接将产生大量开销。

查看[Mapper 的文档](http://hadoop.apache.org/common/docs/r0.20.1/api/org/apache/hadoop/mapreduce/Mapper.html#setup%28org.apache.hadoop.mapreduce.Mapper.Context%29)

# windows - 我可以将 Mongo DB 与 Windows 客户端应用程序一起使用吗？

> ID：10301860
> 
> 赞同：0
> 
> 时间：2012-04-24T16:16:35.457
> 
> 标签：windows, mongodb, client-side, database

我想在 Windows 客户端应用程序中使用一个瘦数据库（没有多少数据说 2-3 个 500 行的表）。我可以使用 Mongo DB 吗？

有什么经验吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:23:30.770

是的，您可以使用 MongoDB 来使用它。它专为存储“大数据”而设计，但也适用于较小的数据集。

# javascript - 将时间转换为 ISO 8601 格式

> ID：10301862
> 
> 赞同：0
> 
> 时间：2012-04-24T16:16:44.813
> 
> 标签：javascript, iso8601

我正在阅读 RSS 提要，该提要以以下格式输出日期/时间：

> ### 日，DD Mon YYYY HH:MM:SS OFFSET

例如，

> ### 2012 年 4 月 24 日星期二 08:15:00 -0700

使用 JavaScript，我需要将其转换为 ISO8601 字符串（`Date.toISOString()`最好通过）。

任何援助将不胜感激。

我之前没有真正在 JS 中使用过时间，所以我没有太多的想法。是否可以将偏移量切换到时区，并将其转换为 JS Date 对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:43:09.330

你可以用日期对象做到这一点（至少它在 chrome 中对我有用）

```
var test = new Date("Tue, 24 Apr 2012 08:15:00 -0700");
test.toISOString() // "2012-04-24T15:15:00.000Z" 
```

我希望这是正确的输出...不确定

# c - 尝试将数据从一个结构复制到另一个结构时出现分段错误

> ID：10301865
> 
> 赞同：1
> 
> 时间：2012-04-24T16:16:57.453
> 
> 标签：c, pointers, struct, segmentation-fault

我有一个“名称”（字符串）字段的有序结构列表（CASE）。我想创建一个带有参数“name”（字符串）和“count”（整数）的新结构（ARTCOUNT）。

结构：

```
typedef struct
 {
   char* name;
   char* art;
   int rating;
 }CASE;

typedef struct
 {
   char* name;
   int count;
 }ARTCOUNT; 
```

我将遍历 CASE 数组，如果 CASE 中的“名称”与 ARTCOUNT 中的名称匹配，我会将计数加 1，否则我将使用新名称创建一个新的 ARTCOUNT 数组并继续遍历数组。

如果名称匹配，当我尝试添加计数时，我遇到的问题是一个奇怪的分段错误。

```
/*all is the array of CASE and pLast points to the last CASE in all*/
void countArt(CASE* all, CASE* pLast)
{
  CASE* walker = all;
  ARTCOUNT* artAll;
  ARTCOUNT* artWalker = artAll;
  ARTCOUNT* artLast;

  if((artAll = (ARTCOUNT*)malloc(sizeof(ARTCOUNT)*(pLast-all+1))) == NULL)
  {
    printf("Fatal memory error!\n"); 
    exit(1);
   }

  artWalker->name = (char*)malloc(sizeof(char)*(100));
  strcpy(artWalker->name, walker->name);
  artWalker->count = 1;

  for(walker = all+1; walker <= pLast; walker++)
  {
    if (strcmp(walker->name, artWalker->name) == 0)
    {
      artWalker->count += 1;
    }
    else
    {
      artWalker++;
      artWalker->name = (char*)malloc(sizeof(char)*(100));
      strcpy(artWalker->name, walker->name);
      artWalker->count = 1;  //if I comment this out, no segmentation fault
    }

  }
  artLast = artWalker;

  return;
} 
```

正如上面的代码中提到的，我设法缩小了可能是错误的范围`artWalker->count-1;`。如果我注释掉这一行，错误就会消失。但是，如果我尝试在循环中打印say artWalker->name，我仍然会收到分段错误。我已经多次检查了我的内存分配，但我认为不是这样。

有小费吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:18:17.247

```
ARTCOUNT* artAll;
ARTCOUNT* artWalker = artAll;

if((artAll = (ARTCOUNT*)malloc(sizeof(ARTCOUNT)*(pLast-all+1))) == NULL)
{ /* ... */ } 
```

您正在为声明`artAll`后分配内存`artWalker`。这意味着`artWalker`使用无效值初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:19:59.867

你已经声明

```
ARTCOUNT* artWalker = artAll; 
```

然后改变了artAll

```
if((artAll = (ARTCOUNT*)malloc(sizeof(ARTCOUNT)*(pLast-all+1))) == NULL) 
```

此时 artWalker 指向一个随机内存位置，因此出现分段错误也就不足为奇了

尝试分配

```
artWalkr = artAll; 
```

在malloc之后。

# android - 如何使用路径剪辑位图

> ID：10301867
> 
> 赞同：5
> 
> 时间：2012-04-24T16:17:03.537
> 
> 标签：android, bitmap, imageview, overlay, clipping

我试图达到以下效果：

![在此处输入图像描述](../Images/d68fe2615f183bb19af99ad1da6b715a.png)

如您所见，红色内衬的缩略图在右侧被部分剪裁并带有边框。此边框分隔在两个边框上剪裁的绿色内衬缩略图。我真的可以使用一些示例代码来说明如何实现这一点。

正如您所看到的，绿色拇指略微覆盖红色拇指，但不会在 / 边框通过的顶部重叠。基本上，图像彼此相邻滑动。

您在它后面看到的黑框是一个简单的 png，如果可以通过某种位图剪辑来实现效果，我不必使用它。但是我不知道该怎么做。

我要的是：

*   如何剪辑缩略图以达到上述效果？
*   关于如何像这样剪辑按钮的任何想法？
*   关于如何以不同的方式做的任何建议？

我真的为此感到头疼，我迷路了。请帮我堆栈溢出:)

# c# - 需要有关泛型、接口和基类的帮助

> ID：10301870
> 
> 赞同：1
> 
> 时间：2012-04-24T16:17:14.053
> 
> 标签：c#, generics, interface, ado.net

假设我有这两个对象：

```
public class Object1
{
  string prop1;
  string prop2;
}

public class Object2
{
  string prop1;
  int prop2;
  int prop3;
} 
```

以及以下类和方法：

```
public class Object1Service
{
  public Object1 GetObject(Object1 o) { return o; }
  public void SaveProperty2(Object1 o, string s) { o.prop2 = s; }
}

public class Object2Service
{
  public Object2 GetObject(Object2 o) { return o; }
  public void SaveProperty2(Object2 o, int i) { o.prop2 = i; }
} 
```

我如何把它变成一个通用的？
我最好需要一些东西，以便服务实现一个接口，并在可能的情况下调用一些通用基类。
如果这两个对象共享一个共同的父类会有所帮助吗？如果是这样，它们将如何构建？

* * *

附录：

回报才是我真正的问题。

```
public T GetObjectByKey<T>(string key)
{
    using (DBEntities db = new DBEntities())
    {
        try
        {
            T returnedEntity = default(T);

            switch (EntityDictionary[typeof (T)])
            // I have a dictionary setup like this dictionary<type, string>
            {
                case "Object1" :
                    returnedEntity = ( from r in db.ObjectONESets
                                        where r.prop1 == key
                                        select new T
                                        {
                                            prop1 = r.prop1,
                                            prop2 = r.prop2
                                        }).FirstOrDefault();
                    break ;
                case "Object2" :
                    returnedEntity = ( from r in db.ObjectTWOSets
                                        where r.prop1 == key
                                        select new T
                                        {
                                            prop1 = r.prop1,
                                            prop2 = r.prop2,
                                            prop3 = r.prop3
                                        }).FirstOrDefault();
                    break ;
            }
            return returnedEntity;
        }
        catch (NullReferenceException )
        {
            return default(T);
        }
    }
} 
```

如果不将我的所有对象属性都放在基础对象中，它就无法知道 prop1-3 是 T 的属性。
如果我确实将所有属性（通用或不通用）都放在基础对象中，并且如果我需要 Object1，它然后附有一个我不需要的prop3。
我不确定在这一点上我是否有很大的意义，或者我所问的是否可以使用泛型。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T16:25:38.107

我相信你**不会在这里获得泛型的好处**。原因是因为**`prop2`这些类中的每一个都是不同的类型**。如果它们相同，那么您可以将公共属性放入基类并执行类似这样的操作

```
public class BaseObject
{
    string prop1;
    string prop2
}

public class Object1 : BaseObject
{

}

public class Object2 : BaseObject
{
    int prop3;
}

public class ObjectService<T> where T is BaseObject
{
    public T GetObject(T o) { return o; }
    public void SaveProperty2(T o, string i) { o.prop2 = i; }
} 
```

您至少可以使用您当前的示例使 GetObject 成为泛型......但是整个方法似乎真的毫无意义：

```
public class ObjectService
{
  public T GetObject<T>(T o) { return o; }
  public void SaveObject2Property2(Object2 o, int i) { o.prop2 = i; }
  public void SaveObject1Property2(Object1 o, string s) { o.prop2 = s; }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T16:33:17.383

这是一个应该做你所追求的解决方案：

```
public interface IPropertyProvider<T>
{
    T Prop2 { get; set; }
}

public class ObjectService<T, TProp> where T : IPropertyProvider<TProp>
{
    public void SaveProperty(T o, TProp i)
    {
        o.Prop2 = i;
    }
}

public class Object1 : IPropertyProvider<string>
{
    public string Prop1 { get; set; }
    public string Prop2 { get; set; }
}

public class Object2 : IPropertyProvider<int>
{
    public string Prop1 { get; set; }
    public int Prop2 { get; set; }
    public int Prop3 { get; set; }
}

public class Object1Service : ObjectService<Object1, string>
{
}

public class Object2Service : ObjectService<Object2, int>
{
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T16:22:36.120

贾斯汀是正确的，如果不修改 OP 的对象，就无法使这个“整齐”通用。

这是一个混乱的解决方案：

```
interface IObject<T>
{
    T prop2 {get;set;}
}

class ObjectService<T, Z> where T : IObject<Z>
{
    public T GetObject(T o)
    {
        return o;
    }

    public void SetValue(T o, Z val)
    {
        o.prop2 = val;
    }
} 
```

# macros - 内联合流用户宏

> ID：10301877
> 
> 赞同：6
> 
> 时间：2012-04-24T16:18:00.070
> 
> 标签：macros, confluence

如何使用产生内联输出的主体创建汇合宏？以下宏：

```
## @noparams
<font color="red">$body</font> 
```

应用于此文本

```
Before macro [macro starts here]macro body[macro ends here] after macro. 
```

将创建此 HTML 代码：

```
<p>Before macro </p>
<font color="red">macro body</font>
<p>after macro.</p> 
```

如何去除`<p></p>`标签？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T07:23:54.847

这是 Confluence 的一个问题。为避免这种情况，您必须使用 html 输出。如果正文或您的宏包含 wiki 标记，那么您将不得不手动渲染它。我的解决方法如下：

```
## Use this macro to avoid new lines:
#macro(doNothing)#end
##
## (Do stuff with body in wiki format, if appropriate)
##
## Convert to html and remove paragraph tags:
#set($renderedhtml = "")
#if ($body && ($body.length()>0))
  #set($globalHelper = $action.getHelper())
  #set($renderedhtml = $globalHelper.renderConfluenceMacro("$body").replaceAll("</?[pP]>",""))
#end
##
## (Do stuff with body in html format, if appropriate)
##
## Output text:
$renderedhtml#doNothing() 
```

编辑：如果您的宏中有要保留的 p 标签，您将需要修改正则表达式。上面代码中的正则表达式将删除所有 p 标签。

# compiler-construction - 计算机如何区分两条数据？

> ID：10301883
> 
> 赞同：2
> 
> 时间：2012-04-24T16:18:23.910
> 
> 标签：compiler-construction, binary, low-level

我想知道计算机以 1 和 0/低压和高压的形式存储所有信息，yada yada ......但是当我们编译程序时，它 - 或者只是存储在 comp 上的任何数据 - 是二进制形式...那么计算机如何区分 2 条数据，因为它只包含 0 和 1 的流...为了使我的问题更清楚，让我们从 C 中获取一个可笑的简单代码：

```
void main() {
    int A = 0;
    int* pA = &A;
    char c = 'c';
    char* pC = &c;
    return;
} 
```

它什么也不做——只生成 4 个 int 类型的变量、指向 Int 的指针、char 和指向 Char 的指针……现在这些变量将以 0 和 1 的形式存储在某处……那么，计算机如何知道这样那样的变量从哪个位开始以及在哪里结束？首先，您可能会说计算机有它的地址，好吧，当然。但是最后呢？......那么像对象/结构这样的复杂数据类型呢？

最后但并非最不重要的一点是，函数/程序呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T16:45:25.407

您现在正在阅读的段落只不过是一串字母和标点符号。你怎么知道一个词在哪里开始和结束？你怎么知道这些词的意思？这个文本流如何传达有用的信息？

你可以对数学说同样的话。当您看到写在页面上的数学表达式时，它们只是一系列数字和符号，但它们是一种以紧凑形式传达深刻思想的强大方式。然后是音乐。那一连串的点、旗子和线条是如何代表像音乐这样短暂的东西的？

答案当然是有规则。这些字母不仅仅是随机组合的——它们有一个特定的顺序。当你遵循你我都知道的规则时，你就能辨别单词，理解它们各自的含义，并将它们组合成思想。

二进制数据也是如此。将数据与随机位区分开来的是存在规则，如果遵循这些规则，则可以以有意义的方式解释位。现在，您已经提出了很多涉及各种规则的问题。试图解释它们会占用比这个答案更合理的空间（并且比我愿意投入的时间更多）。但是如果你拿起一本关于计算机体系结构的书，你会发现关于规则、它们如何工作、它们是如何组织以及它们是如何实现的完整讨论。这真是有趣的东西！

如果您还没有准备好深入研究实际的计算机体系结构，一本可以让您深入了解的优秀书籍是道格拉斯·霍夫施塔特 (Douglas Hofstadter)*的《Godel, Escher, Bach: An Eternal Golden Braid*》。这是一本厚厚的书，充满了思想。但它也写得很好而且很有趣，你不一定要从头到尾阅读它来学习很多有趣的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T16:29:31.860

您可以通过尽可能接近金属来回答所有这些问题（以及**更多**关于计算机的问题）：也就是说，学习装配。我建议阅读包含这些主题[的装配艺术（在线免费提供）一书。](http://portal.aauj.edu/portal_resources/downloads/programming/assembly_language32bit_edition.pdf)另外，请阅读我对[大会学习资源](https://stackoverflow.com/questions/10247746/assembly-learning-resources/10248262#10248262)的回答。现在，让我简要回答您的问题：

*   你是对的，计算机只能看到无穷无尽的比特流。操作系统完成创建文件系统的工作。甚至 ram 也可以被认为是一个非常简单的文件系统（页面或段是文件）。现在什么这意味着操作系统在某个地方有一个表，它可以跟踪每个程序在哪里存储了什么、什么是数据、什么是代码等。

*   基础级别的变量无非是字节。现在，当你写一个语句时，比如

    a = b + 1

编译器实际上为变量分配了一个任意地址，并将该地址硬编码（即写入实际常量，例如 0xA3F0）到引用它的每个语句。

*   数据结构的存储方式有很多种。但是，当谈到 c 结构时，事情就更简单了：它们只是一个接一个地存储这个结构包含的变量，如果我们忽略诸如填充之类的东西的话。这就是为什么 a结构的长度总是已知的。

*   函数实际上是内存中存储代码的地方。要“调用”一个函数，参数被加载到[堆栈](https://en.wikipedia.org/wiki/Stack_%28data_structure%29)或任何其他全局内存空间中，然后跳转，即转到函数的地址。当函数完成后，它会跳转到调用它的地址（地址也存储在堆栈中。）

*   重要的是要了解编译器以上述方式完成了翻译代码的所有艰苦工作。高级语言所具有的所有功能都只是抽象，以使您的工作更轻松。最终，它是只是位和字节，0 和 1，5 伏和零伏。

更重要的是，现代架构不允许操作系统自己做所有这些事情。大部分的内务处理也在硬件级别发生，例如内存管理，标记什么内存地址用于什么目的等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T16:28:00.567

它没有。相同的位序列可以解释为数字、字符串、代码、结构等等。计算机无法知道一堆比特的意图是什么。

试试这个：

```
int main() {
    int A = 0;
    char* pC = (char*)&S;
} 
```

你会发现它有效。它需要整数内存并说我想把它当作一个字符数组。计算机会很高兴地接受这一点。它很少有用，但可以做到。

不同类型的唯一不同之处在于它们的处理方式。浮点数的处理方式不同于整数的处理方式与字符串的处理方式不同。如果您查看程序的低级版本，您会发现每个操作都包含特定于某种类型的数据。区别不在于位，而在于程序如何对位进行操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-25T08:32:41.623

电脑不知道，电脑也不在乎。它所做的只是按照说明进行操作。一条这样的指令可能会说：“从该地址获取 32 位，从该地址获取另外 32 位；使用称为‘二进制补码加法’的方法组合这两个 32 位字符串；并将结果存储在第一个 32 位中提到的地址”。每条指令都指定：

*   从中读取数据和写入数据的地址

*   要读取或写入的位数

*   对读取的位执行的操作

计算机并不关心操作是做什么的。只是计算机设计师足够优秀，可以使操作对我们人类有用。

像你给出的这样一个程序在一个非常真实的意义上是*高水平的*。需要翻译才能产生计算机可以理解的形式。这样的翻译器知道什么`int`是，什么`int *`是，并且知道它们在内存中占用了多少位以及哪些计算机操作可以有效地应用于它们。

因此，您几乎回答了自己的问题：

> 首先，您可能会说计算机有它的地址，好吧，当然。但是结局呢？

如果您知道开始和长度，则知道结束。

更复杂的数据结构通常由单独的、更简单的部分组成。因此，在翻译此类代码时，您获取这些部分，为它们分配偏移量，确保没有部分与另一个部分重叠，然后使用偏移量来计算用于访问这些部分的地址。

过程和功能太复杂，这里就不一一解释了。

但最后是关于您的示例程序的简短说明。正如你所说，它没有任何作用。一个聪明的翻译器会简单地向计算机写一条“什么都不做”的指令。不太聪明的翻译器将为您声明的每个变量分配地址，并编写两条指令：“为这么多位保留空间；然后什么都不做”（位的数量是存储每个变量所需的空间长度）。计算机在任何时候都不需要知道有关程序中变量的任何信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-24T16:26:45.683

编译后的程序将包含机器指令，这些指令以反映高级类型的模式访问数据。大多数汇编语言都有不同的指令来加载和操作不同大小（加载字节、字、长整数等）或类型（有符号和无符号整数、浮点数和长整数等）的数据。因为编译器在编译期间有可用的类型信息，所以它可以发出汇编指令，将内存中的数据（全都是零和一）视为具有适当的结构，方法是发出命令以一致的方式对数据进行操作与类型系统。

对于结构和函数，有许多可能的编码取决于您使用的语言。去年夏天我教了一门编译器课程，我们花了两堂关于函数和对象布局的课。第一讲和[第二讲](http://www.keithschwarz.com/cs143/WWW/sum2011/lectures/120_Runtime_Environments_2.pdf)的[幻灯片](http://www.keithschwarz.com/cs143/WWW/sum2011/lectures/110_Runtime_Environments.pdf)可在前面的链接中找到。

希望这可以帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-24T22:01:34.257

用高级语言编写语言规则，编译器将该信息嵌入到创建的程序中。cpu/处理器可能不太关心它只是位，它们除了在执行指令的很短的时间内没有任何意义。对于加法指令，位是加法或结果的操作数，对于加载或存储，它们可能是地址或地址的偏移量等，但在返回为无意义的位之后立即。

正如另一篇文章所述，您正在阅读的这些单词只是字母表中的字母组合，一次没有任何意义，对网络浏览器或显示像素的视频卡没有意义，但对于高级用户来说，它们确实有意义。与程序相同，缩小一点，将程序视为一个整体，您会看到指令和位的组合形成了实现变量类型的程序序列以及您编写和编译的高级程序序列。

它没有魔法

# c# - 如何在太平洋标准时间创建一个设置为午夜的 DateTimeOffset

> ID：10301885
> 
> 赞同：2
> 
> 时间：2012-04-24T16:18:42.987
> 
> 标签：c#, asp.net-mvc-3, scheduled-tasks, quartz.net, quartz.net-2.0

我正在使用 Quartz.NET（[http://quartznet.sourceforge.net/](http://quartznet.sourceforge.net/)），我试图将开始日期设置为午夜。但是我在创建这个日期时遇到了问题。此应用程序将位于不同时区的不同服务器上。但我希望这个时间总是设置为太平洋标准时间的午夜。

这是我不工作的代码：

```
 TimeZoneInfo info = TimeZoneInfo.FindSystemTimeZoneById("Pacific Standard Time");       
    DateBuilder dateBuilder = DateBuilder.NewDateInTimeZone(info).AtHourMinuteAndSecond(0,0,0);           
    DateTimeOffset runTime = dateBuilder.Build();          

    IJobDetail job = JobBuilder.Create<TimeJob>()
        .WithIdentity("job1", "group1")
        .Build();

    ITrigger trigger = TriggerBuilder.Create()
        .WithIdentity("trigger1", "group1")
        .StartAt(runTime)
        .WithSimpleSchedule(x => x.WithIntervalInHours(24).RepeatForever())
        .Build(); 
```

我需要有 DateTimeOffset 格式的日期，即太平洋标准时间午夜。我正在使用 MVC 3。非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T16:56:12.023

无论服务器如何，这都应该为您提供太平洋标准时间的午夜日期。

```
DateTime dateInDestinationTimeZone = System.TimeZoneInfo.ConvertTimeBySystemTimeZoneId(DateTime.UtcNow, System.TimeZoneInfo.Utc.Id, "Pacific Standard Time").Date; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-20T15:57:29.940

很抱歉从死里复活，但我发现@Vishnu 提供的解决方案对我不起作用。

我正在使用 EST 机器，创建对象的结果是我当地时间的午夜。此外，提到的解决方案没有创建一个`DateTimeOffset`对象，而是`DateTime`一个。

我终于找到了一个对我有用的解决方案，我想我会在这里分享它，因为其他人可能会觉得它有用。

```
var userTimeZone =
        TimeZoneInfo.FindSystemTimeZoneById("Pacific Standard Time");
var startTime = new DateTimeOffset(DateTime.Today.Ticks,
        userTimeZone.GetUtcOffset(DateTime.Today) ); 
```

这里的诀窍是使用`Ticks`，这使得计算非常“无缝”。

# mysql - MySql 使用相关子查询更新日期

> ID：10301888
> 
> 赞同：0
> 
> 时间：2012-04-24T16:18:50.930
> 
> 标签：mysql, sql, correlated-subquery

我一直在尝试使用相关子查询将表中所有行的日期更新 11 天。我遇到的一个问题是 MySql 不会让我更新我在子查询中选择的表。我可以通过将子查询的结果保存为临时表来解决这个问题。当我在子查询中为 where 子句定义了值时，这将起作用。但是，当我尝试引用外部查询（即：vm.psname = v.psname）时，我在 'where 子句'中得到“未知列 'v.psname' 这是我的查询：

```
UPDATE cloud.vms v SET expirationdate=(
    SELECT date FROM (
        SELECT DATE_ADD(
            (SELECT expirationdate
             FROM cloud.vms vm
             WHERE vm.psname=v.psname),
             INTERVAL 11 DAY) 
        AS date)
    AS tmptbl) 
```

我还研究了使用内部联接（[上一篇文章中的示例](https://stackoverflow.com/questions/839938/mysql-sql-update-with-correlated-subquery-from-the-updated-table-itself)）。但是，我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:26:43.347

我没试过，但你为什么不直接做 DATE_ADD，像这样

```
 UPDATE cloud.vms set expirationdate = DATE_ADD(expirationdate, INTERVAL 11 DAY) ; 
```

# javascript - jqGrid 在 IE7 中加载子网格时出现问题

> ID：10301893
> 
> 赞同：2
> 
> 时间：2012-04-24T16:19:03.207
> 
> 标签：javascript, jquery, jqgrid

我一直试图让“[网格作为子网格”功​​能](http://trirand.com/blog/jqgrid/jqgrid.html#t14)正常工作，但运气不佳。我认为我在代码中做错了什么，因为它在独立测试中运行良好。然而，我终于注意到我的应用程序和我的测试页面之间的*唯一*区别是我的应用程序在 IE7 上运行，而我在 Firefox 中运行我的测试页面。果然，当我在 IE7 中加载测试页面时，我遇到了同样的问题。

将在 IE7 上重现该问题的代码如下：

```
$(function () {
    function loadTasks(subgrid_id, row_id)
    {
        var id = subgrid_id + '_t';
        $('#' + subgrid_id).html('<table id="' + id + '"></table>');
        jQuery("#" + id).jqGrid({
            datatype: 'local',
            colNames: ['No','Item','Qty','Unit'],
            colModel: [
                {name:'num',index:'num',width:80,key:true},
                {name:'item',index:'item',width:130},
                {name:'qty',index:'qty',width:70,align:'right'},
                {name:'unit',index:'unit',width:70,align:'right'}
            ],
            height: '100%'
        });
    }

    var x = $("#grid").jqGrid({
        jsonReader: { root: "rows", repeatitems: false },
        datatype: "json",
        height: 'auto',
        autowidth: true,
        forceFit: true,
        colNames:['ID','Name'],
        colModel:[
            {name:'id', key:true, index:'id', width:60, sorttype:"int", jsonmap:"id"},
            {name:'name', index:'foobar', width:90,  jsonmap: "name"}
        ],

        subGrid: true,
        subGridRowExpanded: loadTasks,
        caption: "Results"
    });

    var jsonData = [
        {id: 1, name: 'Apple'},
        {id: 2, name: 'Banana'},
        {id: 3, name: 'Pear'},
        {id: 4, name: 'Orange'}
    ];

    x[0].addJSONData( { rows: jsonData } );
}); 
```

它似乎在每一行上创建了一些虚假元素，这些元素在行内无法正确呈现。这是它在 IE7 上如何呈现的屏幕截图：

![IE7 屏幕截图](../Images/1ceb8d64cba422b50b86e09ae440123b.png)

奇怪的是那些“未定义”行实际上是有效网格行的一部分，如果我将鼠标悬停在“Apple”上，那么第一个*未定义*行也会突出显示。

我选择 jqGrid 而不是其他网格的主要原因是它支持嵌套多个网格（我们的应用程序确实需要），但是我们的公司标准仍然是 IE7，所以我们需要支持这个浏览器。我能做些什么来让这个功能在 IE7 下正常工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:34:24.337

[我在这里](http://www.trirand.com/blog/?page_id=393/bugs/small-typing-bug-in-the-usage-of-addsubgridcell-in-addjsondata/#p26374)报告了这个错误。问题是在[where](https://github.com/tonytomov/jqGrid/blob/v4.3.2/js/grid.base.js#L1360) was `+=`used 而不是`=`. 结果`undefined`被添加到具有子网格的每一行。

这是不典型的，但是 Tony 在我的 bug 报告之后修改了 jqGrid 的代码，并**以相同的版本号 4.3.2 将****其发布[在下载页面](http://www.trirand.com/blog/?page_id=6)**上。所以有两个*不同*版本的jqGrid（有错误和没有错误）具有相同的版本号。

所以要解决这个问题，你应该刷新你使用的 jqGrid 4.3.2。

**更新**：我下载了“new jqGrid 4.3.2”的源代码，我很惊讶，因为它不仅包含当前的错误修复，还包含上次在 jqGrid 中完成的许多其他更改。顺便说一句，我提出了许多变化。例如，现在可以在搜索对话框中使用自定义控件（请参阅我最近的答案[）](https://stackoverflow.com/a/10284605/315935)`searchOnEnter`，可以`closeOnEscape`在 SearchingDialog 中使用新的`afterChange`回调。英语和德语的语言环境是[固定](https://github.com/tonytomov/jqGrid/pull/304)的。例如，现在它将使用逗号，如`thousandsSeparator`. `grid.locale-en.js`这很奇怪，但新版本的`grid.locale-en.js`and`grid.locale-de.js`只放在`src\i18n`子目录中。子目录`js\i18n`包含**旧**文件的版本 (???)。我可以继续...

**无论如何我建议大家刷新之前从[下载页面](http://www.trirand.com/blog/?page_id=6)下载的jqGrid 4.3.2的源码。**

# web-services - 通过 Apache Camel 调用 CXF webservice

> ID：10301895
> 
> 赞同：2
> 
> 时间：2012-04-24T16:19:13.890
> 
> 标签：web-services, cxf, apache-camel

我正在尝试将 Apache CXF 与 Apache Camel 集成。骆驼的配置：

```
<cxf:cxfEndpoint id="authTest"
        address="/cxfAuth"
        serviceClass="com.test.AuthService" >
        <cxf:properties>
            <entry key="dataFormat" value="POJO" />
            <entry key="setDefaultBus" value="true" />
        </cxf:properties>
    </cxf:cxfEndpoint>

     <camel:camelContext trace="true">
        <camel:route>
            <camel:from uri="cxf:bean:authTest" />
            <camel:to uri="bean:routeExitResponseProcessor"/>
        </camel:route>
    </camel:camelContext> 
```

现在要调用 Web 服务上的特定操作，我正在使用这个：

```
<camel:route>
            <camel:from uri="direct:startAuthTest"/>
            <camel:setHeader headerName="getEmployee"> 
                <camel:constant>gid</camel:constant> 
            </camel:setHeader> 
            <camel:to uri="cxf:bean:authTest" />
            <camel:log message=">>> data is : ${body}"/>
            <camel:to uri="bean:routeExitResponseProcessor"/>
        </camel:route> 
```

但是在包含上述配置后，我进入`WARN ServletController:149 - Can't find the the request for http://localhost:8080/CXFService/services/cxfAuth's Observer`了服务器控制台，并且在浏览器上找不到我的 web 服务。

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T17:43:49.157

您可以调用以下命令来获取被调用的 CXF 操作名称...有关更多详细信息，请参见[http://camel.apache.org/cxf.html](http://camel.apache.org/cxf.html)

```
String operation = (String)in.getHeader(CxfConstants.OPERATION_NAME); 
```

另外，请参阅此单元测试以了解示例用法...

[http://svn.apache.org/repos/asf/camel/trunk/components/camel-cxf/src/test/java/org/apache/camel/component/cxf/CxfConsumerTest.java](http://svn.apache.org/repos/asf/camel/trunk/components/camel-cxf/src/test/java/org/apache/camel/component/cxf/CxfConsumerTest.java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-05T13:56:48.500

在 CXF 端点

```
 <cxf:cxfEndpoint id="yourServiceCall"
    address="http://localhost:8181/yourservice/services/yourserviceport"
    wsdlURL="wsdl/yourwsdl.wsdl" xmlns:ns="http://service.your.com"
    endpointName="ns:YourServicePort" serviceName="ns:yourService"
    serviceClass="com.service.YourServicePortType"> 
```

在骆驼端点

```
 camelContext id="camelId" xmlns="http://camel.apache.org/schema/spring">
   <camel:dataFormats>
        <camel:jaxb contextPath="com.your.service" id="jaxb" />
    </camel:dataFormats>

    <route id="route1">
        <from uri="cxf:bean:yourServiceCall?dataFormat=PAYLOAD" />
        <camel:unmarshal ref="jaxb" />
        <log message="log: Called from cxf endpoint" />
        <!-- Your Logic -->
        <camel:process ref="ExitResponseProcessor"/>
        <camel:marshal ref="jaxb" />
    </camel:route> 
```

基于 Himanshu Yadav 评论：更新

```
 <camel:choice>
 <camel:when>
 <camel:simple>${body} is com.your.service.YourRequest</camel:simple>
 <!-- Your Logic or call any bean method with <camel:bean ref="YourBean " method="YourMethod" /      /> -->
 </camel:when>
 <camel:when> </camel:when>
 <camel:otherwise> </camel:otherwise>
 </camel:choice 
```

# python - 在 timeit 中使用分号

> ID：10301896
> 
> 赞同：10
> 
> 时间：2012-04-24T16:19:17.093
> 
> 标签：python, exception, timeit

`timeit.timeit`当我在作为字符串传递的语句参数中有异常时，我似乎无法开始工作：

```
# after the first and third semicolon, I put 4 spaces 
timeit.timeit('try:;    a=1;except:;    pass') 
```

这导致：

```
Traceback (most recent call last):
  File "a.py", line 48, in <module>
    timeit.timeit('try:;    a=1;except:;    pass')
  File "C:\CPython33\lib\timeit.py", line 230, in timeit
    return Timer(stmt, setup, timer).timeit(number)
  File "C:\CPython33\lib\timeit.py", line 136, in __init__
    code = compile(src, dummy_src_name, "exec")
  File "<timeit-src>", line 6
    try:;    a=1;except:;    pass
        ^
SyntaxError: invalid syntax 
```

我正在使用 Python 3.3 运行它，但即使使用旧的 Python (3.2) 也会发生同样的错误。

更新：

我正在关注[此文档](http://docs.python.org/py3k/library/timeit.html?highlight=timeit#timeit.Timer)（强调我的）：

> 类 timeit.Timer(stmt='pass', setup='pass', timer=)
> 
> 小代码片段的计时执行速度类。
> 
> 构造函数采用要计时的语句、用于设置的附加语句和计时器函数。两个语句都默认为“通过”；计时器功能是平台相关的（参见模块文档字符串）。**stmt 和 setup 也可能包含多个语句，用 ; 分隔。**或换行符，只要它们不包含多行字符串文字。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-24T16:22:48.373

您需要使用换行符而不是分号提供正确缩进的代码。尝试将其更改为以下内容：

```
timeit.timeit('try:\n    a=1\nexcept:\n    pass') 
```

虽然这可能更具可读性：

```
stmt = '''\
try:
    a=1
except:
    pass'''
timeit.timeit(stmt) 
```

分号可以很好地分隔具有相同缩进级别的语句，但是您在分号和下一个语句之间放置的任何空格或制表符都将被忽略，因此您不能将它们与缩进一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-23T22:23:19.297

这是一个旧线程，但可能值得更新。另一个使用 textwrap 通过允许代码缩进的基本级别来提高可读性的选项：

```
import timeit
import textwrap
print(timeit.timeit(textwrap.dedent("""
  try:
    a=1
  except:
    pass
  """), number=10)) 
```

# android - Android FLAG_ACTIVITY_NEW_TASK 被忽略

> ID：10301902
> 
> 赞同：3
> 
> 时间：2012-04-24T16:19:36.610
> 
> 标签：android, android-activity, task

是否存在忽略 FLAG_ACTIVITY_NEW_TASK 的情况？从服务中，我启动一个带有设置该标志的意图的活动，当主要活动在后台时，我希望在新任务中看到新活动，因此我希望在后台再次看到应用程序关闭新活动。它没有发生，并且显示了主要活动。

只是为了测试，我尝试将主要活动设置为 singleInstance，在这种情况下它可以工作。我不想将主要活动设置为 singleInstance。

你知道这什么时候会发生吗？

我应该补充一点，我在所有设备上都看到了这种行为，所以看起来这是它应该工作的方式，而不是特定于设备的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T09:32:37.850

我修复了它，为第二个活动设置了不同的亲和力。问题是关于 FLAG_ACTIVITY_NEW_TASK 标志的文档指出：

> 如果设置，此活动将成为此历史堆栈上新任务的开始

但这具有误导性，因为听起来框架总是会创建一个新任务，而当活动从服务启动时，情况并非如此。

这是有关活动的 taskaffinity 属性的文档：

> android:taskAffinity Activity 具有亲和力的任务。具有相同亲和力的活动在概念上属于同一个任务（从用户的角度来看，属于同一个“应用程序”）。任务的亲和性由其根活动的亲和性决定。亲和性决定了两件事——Activity 被重新设置为父级的任务（请参阅allowTaskReparenting 属性）和使用 FLAG_ACTIVITY_NEW_TASK 标志启动时将容纳 Activity 的任务。

因此，如果您从 Activity 调用 startActivity，则会启动一个新任务，但如果您从服务启动它，则框架会将 Activity 附加到具有相同亲和力的任务（如果存在与不存在的顶级活动）单个实例

# java - 为什么我会得到“无法从静态上下文引用的非静态变量”？

> ID：10301907
> 
> 赞同：15
> 
> 时间：2012-04-24T16:20:04.377
> 
> 标签：java, compiler-errors, subclass, non-static

我有一个非常简单的类，我想将它用作另一个类的子类。但是当我把它的代码放在父类中时，我得到：

> 非静态变量 this 不能从静态上下文中引用

另一方面，当我将 sublass`GenTest`的类代码放在“父”类代码之外时 -`JavaApp1`我没有收到此错误。

```
public class JavaApp1 {

    class GenTest {  
        @Deprecated
        void oldFunction() {
            System.out.println("don't use that");
        }
        void newFunction() {
            System.out.println("That's ok.");
        }
    }

    public static void main(String[] args) {
        GenTest x = new GenTest();
        x.oldFunction();
        x.newFunction();
    }
} 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-24T16:22:58.523

您的嵌套类（顺便说一句，它*不是*子类）未标记为静态，因此它是一个*内部*类，需要编码类（JavaApp1）的实例才能构造它。

选项：

*   使嵌套类静态
*   使其不是内部类（即根本不在内部`JavaApp1`）
*   创建一个实例`JavaApp1`作为“封闭实例”：

    ```
    GenTest x = new JavaApp1().new GenTest(); 
    ```

就我个人而言，我会采用第二种方法——Java 中的嵌套类有一些奇怪的地方，所以我会使用顶级类，除非你有充分的理由让它嵌套。（最后一个选项特别混乱，IMO。）

有关内部类的更多信息，请参阅[JLS 的第 8.1.3 节。](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.1.3)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T16:22:18.807

它应该是`static class GenTest`，因为您从静态方法创建它的实例。

此外，一般来说，内部类应该是静态的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T16:22:58.153

该类`GenTest`是一个非静态类，因此必须在`JavaApp1`. 如果你做`static class GenTest`了你已经完成的工作，否则你需要创建一个实例`JavaApp1`并`GenTest`在非静态方法中创建。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T16:24:11.183

Thar 是因为 GenTest 是在 JavaApp1 的上下文中定义的。因此，除非您有 JavaApp1 的实例，否则您可以参考它。将其更改为 a`static class`以使其正常工作。

`static class GenTest...`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-24T16:25:18.780

请用

```
static class GenTest()...... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-24T16:29:19.533

The way you are invoking isn't the correct way to do that. Since the inner class `GenTest` is a member of the `JavaApp1` the correct way to invoke it would be

`GenTest x = new JavaApp1().new GenTest();`

Using it your class would compile correctly.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-28T21:39:00.840

```
class Test {

    static class GenTest { // nested class with static

        static void oldFunction() { // static method
            System.out.println("don't use that");
        }
        void newFunction() { // non-static method
            System.out.println("That's ok.");
        }
    }

    public static void main (String[] args) {
        GenTest.oldFunction(); // call static method

        GenTest two = new GenTest(); // call non-static method
        two.newFunction();
    }

} 
```

Java 在线 [java](https://ideone.com/RxlJIj)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-23T02:21:12.957

该类是嵌套的，这意味着您的嵌套类不是静态的，这意味着您必须通过主类的对象为嵌套类创建一个对象。这意味着你的 psvm 应该是这样的。

```
public static void main(String[] args) {
    JavaApp1 a=new JavaApp1(); //create an object for the main class
    JavaApp1.GenTest x=a.new GenTest();

    x.oldFunction();
    x.newFunction();
} 
```

# swing - 在 tableMode 中编辑重复行，也编辑原始行

> ID：10301908
> 
> 赞同：0
> 
> 时间：2012-04-24T16:20:05.203
> 
> 标签：swing, reference, vector, jtable, tablemodel

我创建了一个添加行函数，它将选定的行或最后一行添加到 tableModel 的末尾。当我去编辑新行时，原始行也会被编辑。我以为我创建了一个新的不同行还是创建了对原始行的引用？

```
int currentRow = jTable1.getSelectedRow();      

Vector data = tableModel.getDataVector(); 

    System.out.println("Vector size: " + data.size());        
if(data.size()>0){   
    if(currentRow > -1){
        Vector temp = (Vector) data.elementAt(currentRow);
        tableModel.addRow(temp);            
   }else{            
        Vector temp = new Vector(data);
        Vector helper = (Vector) temp.elementAt(temp.size()-1);

        tableModel.addRow(helper);
   }
 }else{
     outputMsg("Failed to add row.");
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:27:15.213

您没有创建对原始行的引用，但两行`Vector`对它们的数据使用相同的实例，并且向量中包含相同的数据对象。因此，您的原始行和新行都由完全相同的数据支持，因此在一行中进行的修改将反映在另一行中。

一个可能的解决方案是复制该表行表示的数据，并根据该数据的副本创建一个新行。如何创建该副本将取决于数据，尽管一个非常天真的实现可能是使用 clone 方法（而不是 的克隆`Vector`，而是 中包含的数据`Vector`）

# shell - 在 UNIX 中将字符串转换为变量

> ID：10301912
> 
> 赞同：1
> 
> 时间：2012-04-24T16:20:15.967
> 
> 标签：shell, unix

我有以下代码

```
let a=1
let b=a

echo $b 
```

当我回显b时，我希望它引用它的值（即'a'），并显示a的值（即'1'）

这可以实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:27:35.700

首先，我认为你并不想这样做。但不是说服你，而是这样做：

```
$ let a=1
$ b=a
$ echo $b
a
$ eval "echo \$$b"
1 
```

请注意，您不能将“let”用于第二个分配，因为您想稍后将右侧作为字符串访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:25:42.157

我想你想要`let b=$a`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T16:41:18.483

如果您的 shell 是 bash，那么您编写的内容实际上设置`b`为“1”（而不是“a”），因为`$`在算术表达式中是可选的（您使用 强制执行`let`）。

如果不使用`let`，这是您正在寻找的语法（假设 bash）`a=1; b=a; echo $b ${!b}`：`a 1`

# c# - 如何使用 FormCollection 收集多个复选框值？

> ID：10301913
> 
> 赞同：0
> 
> 时间：2012-04-24T16:20:19.447
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, c#-4.0

根据 Darin 对我的问题[Ho 的回答，是否根据用户从下拉列表中的选择显示多个复选框选择？](https://stackoverflow.com/q/9727796/602183) 我根据下拉选择显示多个复选框。

现在，一旦用户在我的页面上发布表单（带有多个输入），我就会使用 FormCollection 收集所有数据。我遇到的问题是如何从 formcollection 中提取那些选定的复选框值？复选框的数量将根据下拉列表中的不同选择而改变，因此我认为请求每个复选框值将不起作用。

谁能帮我解决这个问题。

**流程如下图所示：**

模型中的属性

```
public class Subcategory
{
    public string Name { get; set; }
    public int ID { get; set; }
    public bool Flag { get; set; }
} 
```

在存在其他表单输入的实际视图中显示 PartialView：

```
 <div id="checkboxlist">
      @if (Model.SubCategories != null)
      {
           @Html.Partial("SubCategories", Model.SubCategories)
      }
 </div> 
```

PartialView SubCategories.cshtml

```
@model IEnumerable<MyProject.Entities.Subcategory>
@{
// we change the HTML field prefix so that input elements
// such as checkboxes have correct names in order to be able
// to POST the values back 
ViewData.TemplateInfo.HtmlFieldPrefix = "checkboxlist";
}
<span>subcategory</span>
<div id="subcategories" style="margin-left: 130px;margin-top: -20px;" data-role="fieldcontain">
   <fieldset data-role="controlgroup">
      @Html.EditorForModel()
   </fieldset>
</div> 
```

EditorTemplates Subcategory.cshtml

```
@model MyProject.Entities.Subcategory
<div class="editor-label">
   @Html.CheckBoxFor(c => c.Flag, new { type = "checkbox" })
   <label for="@Model.ID">@Model.Name</label>
   @Html.HiddenFor(c => c.Flag)
   @Html.HiddenFor(c => c.ID)
   @Html.HiddenFor(c => c.Name)
</div> 
```

jquery 根据下拉选择显示复选框：

```
 $('#Category').change(function () {
    var subcategoriesUrl = $(this).data('subcategoriesurl');
    var categoryId = $(this).val();
    $('#checkboxlist').load(subcategoriesUrl, { category: categoryId });
 }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:42:14.417

不要使用`FormCollection`. 那是弱类型。使用视图模型。像这样：

```
[HttpPost]
public ActionResult Foo(MyViewModel model)
{
    // model.BusinessSubCategories should contain a list of Subcategory
    // where for each element you could use the Flag property to see if
    // it was selected or not
    ...
} 
```

另请注意，您在部分中使用的字段前缀之间存在不一致：

```
ViewData.TemplateInfo.HtmlFieldPrefix = "checkboxlist"; 
```

和视图模型集合属性：`Model.BusinessSubCategories`. 因此，如果您希望默认模型绑定器能够在您回发时填充此属性，请确保您修复前缀以使用正确的属性名称。

# php - 如何在字符串的开头、结尾或（作为一个单词）替换公司名称？

> ID：10301914
> 
> 赞同：0
> 
> 时间：2012-04-24T16:20:28.993
> 
> 标签：php, regex

考虑以下数组：

```
$companies = array(
  'apple' => 'AAPL',
  'baxter' => 'BAX'
); 
```

以及以下字符串：

```
apple at the beginning of string with bapple
here a string with apple in the middle
baxter baxter on first and second place mybaxters
and finally, baxter 
```

我正在使用以下循环将公司名称替换​​为各自的股票代码：

```
foreach ($companies as $name => $ticker) {
  $tweet = str_replace(" $name", "<b>{COMPANY|$ticker}</b>", $tweet);
} 
```

这导致

```
apple at the beginning of string with bapple
here a string with {COMPANY|AAPL} in the middle
baxter {COMPANY|BAX} on first and second place mybaxters
and finally, {COMPANY|BAX} 
```

但是，我还想在字符串的开头加上公司名称：

```
{COMPANY|AAPL} at the beginning of string with bapple
here a string with {COMPANY|AAPL} in the middle
{COMPANY|BAX} {COMPANY|BAX} on first and second place mybaxters
and finally, {COMPANY|BAX} 
```

但如果我删除 中的空格`" $name"`，类似的单词`bapple`也会被替换：

```
{COMPANY|AAPL} at the beginning of string with b{COMPANY|AAPL} 
```

换句话说：我想替换公司名称的所有实例 - 当被空格包围时“一个苹果是可爱的水果” - 当在字符串的开头时，在“苹果是美妙的”之后有一个空格 - 或者当在字符串的结尾时带前导空格“所以这是我的苹果”

这可能需要一个正则表达式，但我需要一些帮助来编写它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:31:49.987

The key things here are:

*   Make sure you quote your company names before they go in to the regex, because you'll run in to problems if your company names contain characters that mean something in regex syntax
*   Use word boundaries (`\b`) to identify strings that are "on their own"
*   Wrap your company name in parenthesis in the regex, then you can access the parenthesis'd bit as `$1` in the replacement if you need to

Consider the following example:

```
$companies = array(
  'apple'   => 'AAPL',
  'baxter'  => 'BAX'
);

$input = "apple at the beginning of string with bapple
here a string with apple in the middle
baxter baxter on first and second place mybaxters
and finally, baxter";

foreach($companies as $name => $code)
{
  $input = preg_replace(sprintf('/\b(%s)\b/i',preg_quote($name)),'{COMPANY:'.$code.'}',$input);
}

var_dump($input); 
```

Which will give you:

```
{COMPANY:AAPL} at the beginning of string with bapple
here a string with {COMPANY:AAPL} in the middle
{COMPANY:BAX} {COMPANY:BAX} on first and second place mybaxters
and finally, {COMPANY:BAX} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T16:27:15.880

我认为您需要的是带有单词边界的正则表达式`\b`

[http://www.regular-expressions.info/wordboundaries.html](http://www.regular-expressions.info/wordboundaries.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T16:27:39.047

我不是 php 开发人员，但您应该使用 regex: `"\b"+$name+"\b"`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T16:42:12.523

花了我一些时间，但后来你得到了一些东西

```
$companies = array(
    'apple' => 'AAPL',
    'baxter' => 'BAX'
);

$str = 'apple at the beginning of string with bapple
here a string with apple in the middle
baxter baxter on first and second place mybaxters
and finally, baxter';

foreach($companies as $search => $company)
{
    $regex = '!(?<=\b|^)('.$search.')(?=\b|$)!ui';

    $str = preg_replace($regex, $company, $str);
}

echo $str; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-24T16:26:58.613

尝试这个：

```
foreach ($companies as $name => $ticker) {
  $tweet = preg_replace('/\b'.preg_quote($name).'\b/', "<b>{COMPANY|$ticker}</b>", $tweet);
} 
```

正则表达式使用所谓的单词边界：[http](http://www.regular-expressions.info/wordboundaries.html)

://www.regular-expressions.info/wordboundaries.html 现在的输出是：

> **{COMPANY|AAPL}**在字符串的开头，bapple 这里是一个中间有**{COMPANY|AAPL}的字符串****{COMPANY|BAX}** **{COMPANY|BAX}**在第一和第二名 mybaxters，最后是 **{COMPANY|BAX}**

如果您还想支持类似的东西`apples`，请使用以下代码：

```
foreach ($companies as $name => $ticker) {
  $tweet = preg_replace('/\b'.preg_quote($name).'s{0,1}\b/', "<b>{COMPANY|$ticker}</b>", $tweet); 
```

}

# wordpress - Wordpress + MAMP：始终重定向到实时站点

> ID：10301915
> 
> 赞同：4
> 
> 时间：2012-04-24T16:20:29.723
> 
> 标签：wordpress, mamp

当我在我的本地 MAMP 服务器上安装我的 Wordpress 站点的备份时，我可以使用它并测试新功能等，并且我访问任何链接或做任何事情（包括登录）它总是将我带到实际的实时网站。

例如，如果该站点的本地地址是“localhost/xyz”并且我输入它，它会将我带到它，但之后的任何内容都会将我带到实际的实时站点。

所以在“localhost/xyz”上，如果我点击登录或任何页面等，我最终会在[http://www.xyz.com](http://www.xyz.com)

这是非常有问题的，因为我无法在本地测试任何页面或在任何页面上工作。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T23:43:11.367

如果您通过 phpmyadmin 进入您的数据库（在 MAMP 上），并检查选项表，请确保 和 的行设置为`siteurl`而不是实时站点 url。`home``http://localhost/`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-18T20:40:00.477

我的问题是这个[http://codex.wordpress.org/Changing_The_Site_URL](http://codex.wordpress.org/Changing_The_Site_URL)的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-11T06:19:18.810

查看我在将 WordPress 网站转移到 MAMP 时制作的这两个视频。我想他们会帮助你。

第 1 部分： [https ://www.youtube.com/watch?v=xn-8OvwFdBY](https://www.youtube.com/watch?v=xn-8OvwFdBY)

第 2 部分： [https ://www.youtube.com/watch?v=fIIJBdpRzjM](https://www.youtube.com/watch?v=fIIJBdpRzjM)

希望他们有所帮助。:)

# objective-c - 如何获取 sendSynchronousRequest 的进度信息？

> ID：10301925
> 
> 赞同：0
> 
> 时间：2012-04-24T16:20:43.787
> 
> 标签：objective-c, synchronization, nsurlconnection

我在第二个线程中调用了sendSynchronousRequest，我的第二个线程将被阻塞，那么如何在我的第一个线程中获取进度信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:40:55.553

您必须在第二个线程上使用[异步下载器。](https://stackoverflow.com/a/10301777/490187)然后异步使用委托回调！

例如：

```
 @protocol DownloadUIProtocol<NSObject>
    - (void)updateUI:(id)sender;
    @end

    @interface ViewController () {
      NSMutableData *receivedData_;
      NSDate *lastUpdateUITime_;
      __weak id<DownloadUIProtocol> delegate_;
    }
    @end

    ...

    - (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data { 
      [receivedData_ appendData:data];

      NSDate *now = [NSDate date];
      if (fabs([lastUpdateUITime_ timeIntervalSinceDate:now]) > 60) {
        dispatch_async(dispatch_get_main_queue(), ^{
          if ([delegate_ respondsToSelector:@selector(updateUI:)]) 
            [delegate_ updateUI:self];
        });
        lastUpdateUITime_ = now;
      }  
    } 
```

# java - GWT Facebook 集成

> ID：10301927
> 
> 赞同：1
> 
> 时间：2012-04-24T16:20:49.913
> 
> 标签：java, facebook, gwt

我正在尝试在我的 GWT 应用程序中编写服务器端 Facebook 通知服务。我的想法是，我将把它作为一个 timertask 或 cron 作业来运行。

使用下面的代码，我得到一个登录 URL，我希望能够以编程方式登录，因为这旨在实现自动化（无头方式）。我打算尝试使用 HTMLunit 提交，但我认为 FB API 应该满足这一点。

请指教。

```
public class NotificationServiceImpl extends RemoteServiceServlet implements NotificationService {

    /**serialVersionUID*/
    private static final long serialVersionUID = 6893572879522128833L;
    private static final String FACEBOOK_USER_CLIENT = "facebook.user.client";
    long facebookUserID;    

    public String sendMessage(Notification notification) throws IOException {
        String api_key = notification.getApi_key();
        String secret = notification.getSecret_key();
        try {
          //  MDC.put(ipAddress, req.getRemoteAddr());            
            HttpServletRequest request = getThreadLocalRequest();
            HttpServletResponse response = getThreadLocalResponse();  
           HttpSession session =   getThreadLocalRequest().getSession(true);
         //  session.setAttribute("api_key", api_key);

            IFacebookRestClient<Document> userClient = getUserClient(session); 
            if(userClient == null) {
              System.out.println("User session doesn't have a Facebook API client setup yet. Creating one and storing it in the user's session.");
                userClient = new FacebookXmlRestClient(api_key, secret);
                session.setAttribute(FACEBOOK_USER_CLIENT, userClient);
            }

            System.out.println("Creating a FacebookWebappHelper, which copies fb_ request param data into the userClient");
            FacebookWebappHelper<Document> facebook = new FacebookWebappHelper<Document>(request, response, api_key, secret, userClient);
            String nextPage = request.getRequestURI();
            nextPage = nextPage.substring(nextPage.indexOf("/", 1) + 1); //cut out the first /, the context path and the 2nd /
            System.out.println(nextPage); 
            boolean redirectOccurred = facebook.requireLogin(nextPage);
            if(redirectOccurred) {
                    return null;
            }
            redirectOccurred = facebook.requireFrame(nextPage);
            if(redirectOccurred) {
                    return null;
            }

            try {
                facebookUserID = userClient.users_getLoggedInUser();

                if (userClient.users_hasAppPermission(Permission.STATUS_UPDATE)) {
                    userClient.users_setStatus("Im testing Facebook With Java! This status is written using my Java code! Can you see it? Cool :D", false);
                }
            } catch(FacebookException ex) {
                response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR, "Error while fetching user's facebook ID");
                System.out.println("Error while getting cached (supplied by request params) value " +
                                 "of the user's facebook ID or while fetching it from the Facebook service " +
                                 "if the cached value was not present for some reason. Cached value = {}" + userClient.getCacheUserId());
                return null;
            }

         //   MDC.put(facebookUserId, String.valueOf(facebookUserID));

           // chain.doFilter(request, response);
    } finally {
          //  MDC.remove(ipAddress);
         //   MDC.remove(facebookUserId);
    }

        return String.valueOf(facebookUserID);
    }

    public static FacebookXmlRestClient getUserClient(HttpSession session) {
        return (FacebookXmlRestClient)session.getAttribute(FACEBOOK_USER_CLIENT);
    }

} 
```

* * *

```
Error message: 
[ERROR] com.google.gwt.user.client.rpc.InvocationException: <script type="text/javascript">
[ERROR] top.location.href = "http://www.facebook.com/login.php?v=1.0&api_key=MY_KEY&next=notification";
[ERROR] </script> 
```

# linux - 从命令行调用 matlab 后 Bash 环境中断

> ID：10301929
> 
> 赞同：0
> 
> 时间：2012-04-24T16:21:07.133
> 
> 标签：linux, bash, matlab

我有一个奇怪的问题：从 shell 调用 matlab 命令时，如下：

```
matlab -nodesktop -nojvm -nosplash -r "SomeFunction(SomeParameter);quit;" 
```

它工作正常，但是在退出 matlab 时会破坏 bash 环境中的某些内容 - 我可以输入命令，但看不到我正在输入的内容，但可以看到命令执行的结果。它似乎被重定向到某个地方，但我不知道如何取回它以及它被重定向的原因。点击返回会重复打印提示，我会得到如下信息：

```
anton@richter:~/data$ anton@richter:~/data$ anton@richter:~/data$ anton@richter:~/data$ 
```

对此的任何提示/帮助都会很有用。

详细信息：我正在使用 Ubuntu 服务器。安东

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:24:05.043

`echo`已关闭。

做`reset`是最快的解决方案，因为它可能不仅仅是回声。但是要重置回声，您可以执行`stty echo`.

# javascript - 闭包 javascript 调用

> ID：10301932
> 
> 赞同：0
> 
> 时间：2012-04-24T16:21:21.057
> 
> 标签：javascript, closures

可以像下面的代码那样调用创建闭包的返回函数吗？

因此，当获得对 html 的访问权限时，我不必执行 Bay.HTML()(); ?

```
Bay.prototype.HTML = function () {
    var html;
    return function () {
        if (!html) {
            var td = docCreate('td');
            td.setAttribute('id', 'bay' + this.number);
            td.setAttribute('class', 'bay');
            html = td;
        }
        return html;
    }(); <----------HERE
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:42:12.763

这取决于您希望某事“正常”的上下文。它有效吗？如果是这样，有时这就是所需要的。阅读您的代码的其他人是否清楚它的作用、是否可维护、是否安全？

所以，代码。它有效吗？不。

每次调用此原型函数时，方法变量 'html' 都会初始化为 null，因此您的内部函数中的条件将始终评估为 true，并通过设置 dom 元素的步骤。

这里有必要使用闭包吗？不。

您正在创建一个不会在调用上下文之外持续存在的闭包，因此是无用的。每次调用 Bar.HTML() 时，您都将创建和销毁一个额外的上下文，只是为了执行一些代码，因为您没有存储或返回对闭包本身的引用以供以后执行。您可以只考虑关闭，并获得更好的性能结果：

```
Bay.prototype.HTML = function() {
    var html; 
    if(!html) {
        var td = docCreate('td');
        td.setAttribute('id', 'bay' + this.number);
        td.setAttribute('class', 'bay');
        html = td;
    }
    return html;
} 
```

当然，由于在此处声明了该 html var，因此不需要 if 语句，但我认为这只是一些示例代码。

[这是关于javascript 中的闭包](https://developer.mozilla.org/en/JavaScript/Guide/Closures)、何时以及如何使用它们的一些重要信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:48:51.333

我猜你想要

```
Bay.prototype.HTML = (function () {
    var html;
    return function () {
        if (!html) {
            var td = docCreate('td');
            td.setAttribute('id', 'bay' + this.number);
            td.setAttribute('class', 'bay');
            html = td;
        }
        return html;
    };
})(); <----------HERE 
```

这将从闭包返回的函数分配给`Bay.prototype.HTML`，而不是每次`Bay.prototype.HTML`调用时立即执行无用的函数 - 不是真正创建闭包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T16:37:58.967

没关系，但它没有任何不同

```
Bay.prototype.HTML = function () {
    var html;

    if (!html) {
        var td = docCreate('td');
        td.setAttribute('id', 'bay' + this.number);
        td.setAttribute('class', 'bay');
        html = td;
    }
    return html;
}; 
```

这意味着你的 html 没有被缓存。

如果要缓存，`html`则需要：

```
Bay.prototype.HTML = function () {

    if (!this.html) {
        var td = docCreate('td');
        td.setAttribute('id', 'bay' + this.number);
        td.setAttribute('class', 'bay');
        this.html = td;
    }
    return this.html;
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T16:46:20.643

@Esailija 是对的。您的实现没有像您想要的那样缓存结果。

他的解决方案将缓存它，但它将是公共财产。如果您想要一个不公开缓存的缓存版本，那么您正在评估错误的功能。你想要的是：

```
Bay.prototype.HTML = (function() {
    var html;
    return function() {
        if(!html) {
            var td = docCreate('td');
            td.setAttribute('id', 'bay' + this.number);
            td.setAttribute('class', 'bay');
            html = td;
        }
        return html;
    };
})(); 
```

# mysql - mySQL - 如何找到字段中内容的最大大小

> ID：10301938
> 
> 赞同：0
> 
> 时间：2012-04-24T16:21:35.500
> 
> 标签：mysql, max

我需要移动一些数据。

我有一个带有“答案”字段的表，该字段具有 blob 类型

如何找到所有记录的最大字段大小？

从答案中选择 max(answer.size) ；

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:24:05.767

尝试

```
SELECT MAX(LENGTH(FIELD)) FROM TABLE 
```

# solr - 如何将 solr 字符串字段截断为 10 个字符？

> ID：10301941
> 
> 赞同：4
> 
> 时间：2012-04-24T16:21:41.080
> 
> 标签：solr, indexing

我创建了以下用于索引的字符串字段。

```
<fieldType name="short_text_for_sort" class="solr.StrField" omitNorms="true" sortMissingLast="true" omitTermFreqAndPositions="true" positionIncrementGap="100">
  <analyzer type="index">
    <!-- TODO: truncate to 10 characters-->
    <filter class="solr.LowerCaseFilterFactory"/>
    <filter class="solr.ASCIIFoldingFilterFactory"/>
  </analyzer>
</fieldType> 
```

如何将此字段限制为 10 个字符？我需要编写自己的过滤器吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T20:38:18.797

一种选择： PatternTokenizerFactory 并将输入正则表达式转换为您需要的任何形式。

第二个选项：使用 copyfield 命令，将 maxChars 参数设置为 10。

第三种选择：在您的数据进入 solr 之前处理这个问题。

第二个选项可能是最简单的，并且可以让您保持原始字段值不变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T22:05:15.430

使用字长过滤器

`<filter class="solr.LengthFilterFactory" min="1" max="10" />`

[http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.LengthFilterFactory](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.LengthFilterFactory)

*编辑我可能弄错了。我不确定这会截断令牌（看起来它可能只是过滤令牌）

# mysql - 重建 Sphinx 索引失败

> ID：10301942
> 
> 赞同：1
> 
> 时间：2012-04-24T16:21:50.847
> 
> 标签：mysql, ruby-on-rails, full-text-search, sphinx

我们在为我们的一个 MySQL 数据库重建 Sphinx 索引时遇到问题。轮换和重建索引反复失败，系统继续使用旧索引。数据库大小在过去几个月中翻了一番，现在包含超过 1000 万行的表。在重建 Sphinx 索引期间，使用

```
indexer --config our_config.conf --rotate --all 
```

（由此处使用的 UltraSphinx 插件生成），我们在 Sphinx 守护进程日志文件 searchd.log 中得到以下错误

```
WARNING: rotating index 'main': preread failed: failed to open 
~/etc/sphinx//sphinx_index_main.new.spi: No such file or directory; 
using old index
WARNING: rotating index 'main': preread failure reported 
```

随着数据库变大，错误消息出现的频率越来越高。完整索引现在需要大约 1 1/2 小时，并且索引文件加起来大于 1 GB。我们将 Sphinx 版本从 0.9.8.1 更新到 2.0.4 以解决这个问题，但它仍然存在。服务器有大约 4 GB 内存，配置文件以

```
indexer {
  mem_limit = 1024M
}

searchd {
  read_timeout = 5
  max_children = 300
  log = ~/etc/sphinx/log/searchd.log
  port = 3313
  max_matches = 100000
  query_log = ~/etc/sphinx/log/query.log
  seamless_rotate = 1
  pid_file = ~/etc/sphinx/log/searchd.pid
  address = 127.0.0.1
}
.. 
```

有谁知道如何解决这个问题？我猜似乎存在某种与 2 GB 限制有关的索引大小限制，这是有符号 32 位整数的最大值和某些文件系统上文件大小的最大值。我们在 Ubuntu/Debian 系统上使用的 ext3 文件系统最多允许 16 GB 的文件，但某些库实际上可能会将文件大小限制为 2 GB（参见[此处](http://sphinxsearch.com/forum/view.html?id=3013)和[此处](http://sphinxsearch.com/forum/view.html?id=4891)）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T18:58:00.637

检查索引器本身的输出 - 它显示索引期间的进度，并可能提供有关问题的线索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T18:28:12.930

请检查您的数据位置。看起来 Sphinx 想要在`~/etc/sphinx//sphinx_index_main.new.spi`. 我在这里看到两件事，一个是〜，不确定这是否有效。另一件事是 double `/`。

IIRC 这是您的 Sphinx 配置文件的索引部分。

# weblogic - 如何在 Weblogic 中使用 java.util.logging？

> ID：10301944
> 
> 赞同：5
> 
> 时间：2012-04-24T16:21:55.857
> 
> 标签：weblogic, java.util.logging

我有一个从 Glassfish 迁移到 Weblogic 的应用程序，它使用 java.util.logging 作为日志框架。

我发现使日志工作的唯一方法是编辑 JVM 的 logging.properties 文件并重新启动服务器。这种解决方案很笨拙，而且会出现问题，因为日志写入的文件与 weblogic 的标准文件不同，因此在集群环境中，我们必须查看太多文件来获取日志。此外，由于某种原因，这在某些 Windows 系统上不起作用。

有没有办法继续使用标准 java 日志将消息写入 weblogic 的标准日志文件？我尝试了[此页面](http://disaak.blogspot.com/2009/11/migrating-to-weblogic-use.html)上的说明，但它也不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T07:14:31.007

WebLogic Server 附带一个 JDK 日志记录处理程序，它将拾取从 JDK 日志记录框架发出的日志消息并将它们定向到 WebLogic Server 日志记录系统。

在 logging.properties 中为新的 ServerLoggingHandler 实例设置默认日志记录级别，并将 ServerLoggingHandler 添加到处理程序中。

```
handlers = weblogic.logging.ServerLoggingHandler
weblogic.logging.ServerLoggingHandler.level = ALL 
```

[http://docs.oracle.com/cd/E14571_01/web.1111/e13739/logging_services.htm#CHDBBEIJ](http://docs.oracle.com/cd/E14571_01/web.1111/e13739/logging_services.htm#CHDBBEIJ)

为了指导 JDK 日志框架使用 logging.properties 文件，使用标准系统属性 java.util.logging.config.file。对于 WebLogic Server，这可以通过将 JAVA_OPTIONS 系统属性设置为相应的值来轻松完成。

$ export JAVA_OPTIONS="-Djava.util.logging.config.file=/Users/xxx/Projects/Domains/wls1035/logging.properties"

更多提示：http: [//buttso.blogspot.de/2011/06/using-slf4j-with-weblogic-server.html](http://buttso.blogspot.de/2011/06/using-slf4j-with-weblogic-server.html)

# javascript - 将位于单独 div 内的平行表列对齐

> ID：10301946
> 
> 赞同：0
> 
> 时间：2012-04-24T16:22:05.607
> 
> 标签：javascript, jquery, html, css

我有两个 div，一个在另一个之上，并且它们里面都有一个表，列数相同。我希望两列的宽度大小相同并对齐。如果 div 中的列扩展，我希望另一个 div 中的列平行扩展为相同。

注意：列没有宽度。 [链接到下面的 HTML 代码：](http://jsfiddle.net/nathan406/gwUFb/)

* * *

HTML：

```
<div id="A">
   <table>
       <tbody>
           <tr>
               <th></th>
               <th>Blah! Blah</th>
               <th>adsdsdadasdasdasdasd</th>
           </tr>
       </tbody>
   </table>
</div>
<br/>
<div id="B">
   <table>
       <tr>
          <th>left head</th>
          <td class="col1"></td>
          <td class="col2">Hello World!</td>
       </tr>
       <tr>
          <th>left head</th>
          <td class="col1">Hello World!</td>
          <td class="col2">dsfsdfgdsgdsgdsfgdsgdsgfdfgdf</td>
       </tr>       
   </table>
</div> 
```

* * *

查询：

```
$(document).ready(function() {
    $('#updatetopdiv').click(function(){        
            //Properly align parallel div's top to bottom 
            var tbl1 = $("#A table tr td");
            var tbl2 = $("#B table tr td");
            tbl1.each(function(i) {
                if (tbl2.eq(i).width() < $(this).width()) {
                    tbl2.eq(i).width($(this).width());
                } else {
                    $(this).width(tbl2.eq(i).width());
                }
            });
     });
});​ 
```

​</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:29:48.940

```
​$(document).ready(function(){
   var tbl1 = $("#A table tr td");
   var tbl2 = $("#B table tr td");
    tbl1.each(function(i){
        if (tbl2.eq(i).width() < $(this).width()){            
           tbl2.eq(i).width($(this).width());
        } else {
           $(this).width(tbl2.eq(i).width()); 
        }    
    });
});​ 
```

This works, though it doesn't run until load.

Also placed here: [http://jsfiddle.net/gwUFb/3/](http://jsfiddle.net/gwUFb/3/)

EDIT:

I know you said you already got it working, but here's my original code, edited for your use case:

```
$(document).ready(function(){
   var tbl1 = $("#A table tr th");
   var tbl2 = $("#B table tr td,#B table tr th");
    tbl1.each(function(i){
        if (tbl2.eq(i).width() < $(this).width()){            
           tbl2.eq(i).width($(this).width());
        } else {
           $(this).width(tbl2.eq(i).width()); 
        }    
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:47:33.197

html 将是：

```
<div id="A">
   <table class="fixed-table">
       <tr>
          <td class="column-a">Hello World!</td>
          <td class="column-b"></td>
       </tr>
   </table>
</div>
<br/>
<div id="B">
   <table class="fixed-table">
       <tr>
          <td class="column-a"></td>
          <td class="column-b">Hello World!</td>
       </tr>
   </table>
</div> 
```

CSS将是

```
.fixed-table {
   table-layout: fixed;
}

.column-a {
    width: 50%;
}

.column-b {
   width: 50%;
} 
```

这是一个固定的解决方案，不是动态的，如果出现任何 div 滚动，对齐中断。为此，您必须使用 javascript。

# android - 无法安装 Android 2.3.3 SDK 平台

> ID：10301949
> 
> 赞同：2
> 
> 时间：2012-04-24T16:22:11.037
> 
> 标签：android, android-sdk-2.3

> **可能重复：**
> [3.2 sdk 平台安装问题。“完毕。什么都没有安装”](https://stackoverflow.com/questions/6783981/3-2-sdk-platform-install-problem-done-nothing-was-installed)

我正在尝试通过 SDK 管理器安装适用于 Android 2.3.3 的 SDK 平台，但是当我按下安装按钮时，我收到以下错误消息：

```
Preparing to install archives
Downloading SDK Platform Android 2.3.3, API 10, revision 2
File not found: C:\Program Files (x86)\Android\android-sdk\temp\android-2.3.3_r02-linux.zip (Access is denied)
Done. Nothing was installed. 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:48:18.947

您被拒绝访问。所以我想尝试以管理员身份运行您的 SDK 管理器。

右键单击 SDK 管理器，然后单击以管理员身份运行

# jquery - 单击facebook like按钮时如何打开页面？

> ID：10301961
> 
> 赞同：0
> 
> 时间：2012-04-24T16:22:55.207
> 
> 标签：jquery, facebook, facebook-graph-api

我正在创建一个插件以在我的 wordpress 博客上使用。我想包括一个 facebook like 按钮，当用户单击 like 按钮时，div 会显示一些内容。就像这个插件一样，但不是对话框。

[这是我正在寻找的示例功能。](http://codecanyon.net/item/facebook-traffic-pop/full_screen_preview/142429)

我正在考虑起诉jquery。

```
$('#facebooklikebutton').click(function(){

    $('mydiv').show();

}); 
```

希望你明白这一点。有人请帮忙..这是非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:31:54.977

If you are using the facebook js sdk you can use edge.create and edge.remove events. ie.

```
//listen for page like
FB.Event.subscribe("edge.create",
    function(response){
        alert("you liked the page");
    }
);

//listen for page unlike
FB.Event.subscribe("edge.remove",
    function(response){
        alert("you unliked the page");
    }
); 
```

how to set up sdk here -> [http://developers.facebook.com/docs/reference/javascript/](http://developers.facebook.com/docs/reference/javascript/)

documentation on detecting likes here -> [http://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/](http://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:37:25.977

```
HTML
<div id="showMyId"></div>

CSS
#showMyId{
 width: 50px; // your size here
 height: 5px; // your size here
 background-color: #000; //black color
 display: none;
}

JQUERY
$(function(){

$('#facebook_like_id').on('click', function(e){

$('#showMyId').show('slow/fast');
$('#showMyId').slideDown('slow/fast');

e.preventDefault();

});

}) 
```

# html - 如何将 Html.Dropdownlist 的值传递给控制器

> ID：10301968
> 
> 赞同：1
> 
> 时间：2012-04-24T16:23:26.120
> 
> 标签：html, asp.net-mvc-3, c#-4.0, razor

我正在动态生成一个下拉框。我正在尝试将下拉框中的选定值作为模型的字段之一发送到控制器。

```
@using (Html.BeginForm("AddItem", "Home", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        <label>
            Category:</label>
        @Html.DropDownList("Category", (IEnumerable<SelectListItem>)ViewData["CategoryList"])<br />
        <label>
            Sku:</label>
        @Html.TextBox("newItem.Sku")<br />
        <label>
            Title:</label>
        @Html.TextBox("newItem.Title")<br /> 
```

我可以将所有值作为模型的一部分发送，除了类别的值（下拉框值），因此使控制器中的函数失败..

**回答：**将下拉列表“Category”重命名为 =“newItem.Category”，完成了工作，基本上它应该与模型名称匹配。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:48:56.830

为您的项目创建一个`ViewModel`属性以保存所有类别和 SelectedCategoryId 值

```
public class ItemViewModel
{
  public int ItemId { set;get;}
  public string SKU { set;get;}
  public string SelectedCategoryId { get; set; }
  public IEnumerable<SelectListItem> Categories{ get; set; }
} 
```

在您的家庭控制器中，为 Add 创建 Action 方法，在其中创建 ItemViewModel 的对象，设置类别并返回到强类型的视图。

```
public ActionResult AddItem()
{
  ItemViewModel objNewItem=new ItemViewModel();
  objNewItem.Items = new[]
  {
     new SelectListItem { Value = "1", Text = "Perfume" },
     new SelectListItem { Value = "3", Text = "Shoe" },
     new SelectListItem { Value = "3", Text = "Shirt" }
  };
  return View(objNewItem);  

} 
```

强类型视图

```
@model ItemViewModel
 @using (Html.BeginForm("AddItem", "Home", FormMethod.Post, new { enctype = "multipart/form-data" }))
 {
   Category:
   @Html.DropDownListFor(x => x.SelectedCategoryId ,new SelectList(Model.Categories,"Value",Text"), "Select..")
   <input type="submit" value="Add" />
 } 
```

并在您的 Home Controller 中使用 HTTPPOST AddItem 方法

```
[HttpPost]
public ActionResult AddItem(ItemViewModel objItem)
{
  //Now you can access objItem.SelectedCategoryId and do what you like to do...

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T16:33:29.270

您的 DropDown 绑定到一个名为`Category`. 所以你的视图模型上必须有这样的字段。

```
public class MyViewModel
{
    public string Category { get; set; }
    ...
} 
```

和你的行动：

```
[HttpPost]
public ActionResult AddItem(MyViewModel model)
{
    // model.Category will contain the selected value
    ...
} 
```

另请注意，此属性必须是简单的标量值（字符串、整数、...），而不是复杂的对象。

一旦你有了一个适配的视图模型，你就可以使用强类型的助手版本：

```
@model MyViewModel
@using (Html.BeginForm("AddItem", "Home", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    @Html.LabelFor(x => x.Category)
    @Html.DropDownListFor(x => x.Category, Model.Categories)
    <br />
    @Html.EditorFor(x => x.Sku)
    <br/>
    @Html.EditorFor(x => x.Title)
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:25:22.737

将下拉列表“Category”重命名为 =“newItem.Category”，基本上，如果您希望在控制器中接收模型，在本例中为“newItem”，则向下控件名称应与模型名称及其属性匹配.

# cocoa-touch - 未调用 UINavigationControllerDelegate 方法（github 上的演示代码）

> ID：10301973
> 
> 赞同：5
> 
> 时间：2012-04-24T16:23:45.060
> 
> 标签：cocoa-touch, delegates, uinavigationcontroller

弹出到不支持当前方向的视图控制器时，未调用 UINavigationControllerDelegate 方法。

我有一个 UINavigationController 作为我的应用程序的根视图控制器（我的故事板中的初始视图控制器）。

假设我用这个来推送一个 ViewController A 来定位：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
} 
```

因此我们不支持任何横向模式。最重要的是，让我们用代码推送另一个 ViewController：

```
@interface B : UIViewController <UINavigationControllerDelegate>
@end

@implementation B
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return YES;   // any orientation supported
}

- (void)viewDidLoad {
    [super viewDidLoad];

    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    UINavigationController *nc = (UINavigationController*)appDelegate.window.rootViewController;
    nc.delegate = self;
}

- (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated {
    // not always called...
}

- (void)navigationController:(UINavigationController *)navigationController didShowViewController:(UIViewController *)viewController animated:(BOOL)animated {
    // not always called...
}
@end 
```

现在，如果我的 iPhone 是纵向的，我通过一些触摸事件将视图控制器 B 推到 A 上，然后触摸导航栏中的“后退”按钮，一切都很好，并且调用了委托方法（我在那里做了一些事情）。

但是，如果当我查看视图 B 时，我旋转到横向，然后点击后退按钮，则不会调用这些委托方法！如果有时调用方法但不调用其他方法，那么为 UINavigationController 设置委托有什么意义？我肯定做错了什么。

我尝试将委托放在其他类中，例如 AppDelegate 或我的 MainView，没有任何变化。

有任何想法吗 ？

**演示代码在这里：** [git://github.com/malaba/NavBarTest.git](http://git://github.com/malaba/NavBarTest.git)

从一个基本的主从模板，如上修改。

如何表明我的观点？这是一步一步：

1.  在主视图中添加一些行（+ 右上角）
2.  然后触摸一条线进入详细信息视图
3.  请参阅显示的登录输出
4.  点击返回按钮（标记为“Master”），再次显示日志。

现在尝试在详细信息视图中旋转 iPhone（或模拟器），然后“返回”并看到没有显示**日志？！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T11:58:12.433

嗨，这对我来说也是一个棘手的问题，直到我看到这个想法： [http ://www.hanspinckaers.com/custom-action-on-back-button-uinavigationcontroller](http://www.hanspinckaers.com/custom-action-on-back-button-uinavigationcontroller)

当 NavigationController 和 TopViewController 具有相同的方向时，IOS 使用以下代码创建以下调用序列（单点触控）

*   SomeTopViewController ViewWillDisappear
*   WillShowViewController viewController：新的 TopViewController
*   SomeTopViewController ViewDidDisappear
*   DidShowViewController viewController：新的 TopViewController

当 NavigationController 和 TopViewController 具有**不同**的方向时，则不会像您描述的**那样调用 NavigationController 委托。**因此调用顺序为：

*   SomeTopViewController ViewWillDisappear
*   SomeTopViewController ViewDidDisappear

以下代码通过覆盖 NavigationController 的 PopViewControllerAnimated 来重现 ios 调用序列：

```
public class MyNavigationControllerDelegate : UINavigationControllerDelegate {
  public MyNavigationControllerDelegate( ) : base() {}

  public bool WasCalled {get;set;}  // flag that we use to track whether iOS calls the handlers or we have to 

  public override void WillShowViewController( UINavigationController navigationController, UIViewController viewController, bool animated ) {
    Console.WriteLine( "WillShowViewController viewController: {0}", viewController.GetType() );
    WasCalled = true;  // signal that we have been called
    //.….. do your stuff
  }

  public override void DidShowViewController( UINavigationController navigationController, UIViewController viewController, bool animated ) {
    Console.WriteLine( "DidShowViewController viewController: {0}", viewController.GetType() );
    //.….. do your stuff
  }
}

public partial class MyNavigationController : UINavigationController {
  MyNavigationControllerDelegate navigationControllerDelegate;

  public override void ViewDidLoad() {
    base.ViewDidLoad();
    navigationControllerDelegate = new MyNavigationControllerDelegate( viewSelectionControl );
    Delegate = navigationControllerDelegate;
  }

public override UIViewController PopViewControllerAnimated( bool animated ) {
  Console.WriteLine( "PopViewControllerAnimated TopViewController.GetType: {0}", TopViewController.GetType() );
  navigationControllerDelegate.WasCalled = false;   // reset flag before we start the popsequence

  UIViewController ctrl = base.PopViewControllerAnimated( animated );

  AppDelegate.MainWindow.BeginInvokeOnMainThread( delegate {
    if( !navigationControllerDelegate.WasCalled )  {   // if iOS did not call the delegate handler then we must do it
      Delegate.WillShowViewController( this, TopViewController, animated );
      navigationControllerDelegate.WasCalled = false;  // reset flag to be used in the next DidShowViewController step of the popsequence
      }
  } );

  Thread t = new Thread( () => RunPop(animated) );
  tt.Start();

  return ctrl;
}

void RunPop(bool animated) {
  Thread.Sleep( 500 );
  AppDelegate.MainWindow.BeginInvokeOnMainThread( delegate {
    if( !navigationControllerDelegate.WasCalled ) {  // if iOS did not call the delegate handler then we must do it
      Delegate.DidShowViewController(this,TopViewController,animated);
    }
  } );
} 
```

}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T09:44:06.113

由 Kaspar 回答，这是我在 Obj-C 中的代码。

。H：

```
@interface ProperNavigationController : UINavigationController

@end

@interface ProperNavigationControllerDelegate : NSObject <UINavigationControllerDelegate>
@property (assign, nonatomic) BOOL wasCalled;
@end 
```

米：

```
#import "ProperNavigationController.h"

@interface ProperNavigationController ()
@property (strong, nonatomic) id<UINavigationControllerDelegate> oldDelegate;
@property (strong, nonatomic) ProperNavigationControllerDelegate *myDelegate;
@end

@implementation ProperNavigationController
@synthesize oldDelegate = _oldDelegate;
@synthesize myDelegate = _myDelegate;

- (void)viewDidLoad {
    [super viewDidLoad];

    self.oldDelegate = self.delegate;
    self.myDelegate = [ProperNavigationControllerDelegate new];
    self.delegate = self.myDelegate;
}

- (UIViewController *)popViewControllerAnimated:(BOOL)animated {
    self.myDelegate.wasCalled = FALSE;

    UIViewController *vc = [super popViewControllerAnimated:animated];

    if (!self.myDelegate.wasCalled) {
        // if iOS did not call the delegate handler then we must do it
        [self.myDelegate navigationController:self willShowViewController:self.topViewController animated:animated];
        [self.myDelegate navigationController:self didShowViewController:self.topViewController animated:animated];
    }

    return vc;
}

@end

@implementation ProperNavigationControllerDelegate
@synthesize wasCalled = _wasCalled;     // flag that we use to track whether iOS calls the handlers or we have to 

- (id)init {
    if (self = [super init]) {
       _wasCalled = FALSE; 
    }
    return self;
}

- (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated {
    ProperNavigationController *nc = (ProperNavigationController *)navigationController;
    [nc.oldDelegate navigationController:navigationController willShowViewController:viewController animated:animated];
    self.wasCalled = TRUE;  // signal that we have been called
}

- (void)navigationController:(UINavigationController *)navigationController didShowViewController:(UIViewController *)viewController animated:(BOOL)animated {
    ProperNavigationController *nc = (ProperNavigationController *)navigationController;
    [nc.oldDelegate navigationController:navigationController didShowViewController:viewController animated:animated];
}

@end 
```

这行得通。

你怎么看 ？我们应该填写错误报告吗？

# java - 如何从 Android 调用 PHP 函数？

> ID：10301979
> 
> 赞同：3
> 
> 时间：2012-04-24T16:24:14.360
> 
> 标签：java, android

我想在服务器上调用特定的 php 函数并发送一些参数。到目前为止，我已经实现了可以使用 HttpClient 打开 php 文件并将数据传输到 Json 并在我的应用程序中显示出来。所以，现在我希望能够调用特定的函数并向它发送参数，我该怎么做呢？抱歉，我不认为我需要从 Android 调用该函数。

这里有一些代码：

```
try {
            HttpClient httpClient = new DefaultHttpClient();
            HttpPost httpPost = new HttpPost("http://10.0.2.2/posloviPodaci/index.php");
            HttpResponse response = httpClient.execute(httpPost);
            HttpEntity entity = response.getEntity();

            is = entity.getContent();

        } catch (Exception e) {
            Log.e("log_tag", "Error in http connection" + e.toString());
        }

        // Convert response to string
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(is,   "iso-8859-1"), 8);
            sb = new StringBuilder();
            sb.append(reader.readLine() + "\n");

            String line = "0";
            while((line = reader.readLine()) != null){
                sb.append(line + "\n");
            }
            is.close();
            result = sb.toString();

        } catch (Exception e) {
            Log.e("log_tag", "Error converting result " + e.toString());
        }

        // Parsing data
        JSONArray jArray;
        try {
            jArray = new JSONArray(result);
            JSONObject json_data = null;

            items = new String[jArray.length()];

            for(int i = 0; i < jArray.length(); i++) {
                json_data = jArray.getJSONObject(i);
                items[i] = json_data.getString("naziv");
            }

        } catch (Exception e) {
            // TODO: handle exception
        } 
```

在此先感谢，狼。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:30:06.413

If you are working with an MVC framework, such as CakePHP, you can simply create a route to a function that will output whatever JSON you'd like.

Otherwise, You can utilize something simple at the top of your index.php such as this:

```
<?php
   function foo($bar) { echo $bar; }
   if(isset($_GET['action']) && (strlen($_GET['action']) > 0)) {
      switch($_GET['action']) :
         case 'whatever':
            echo json_encode(array('some data'));
            break;
         case 'rah':
            foo(htmlentities($_GET['bar']));
            break;
      endswitch;
      exit; # stop execution.
   }
?> 
```

This will let you call the url with a parameter of action.

[http://10.0.2.2/posloviPodaci/index.php?action=whatever](http://10.0.2.2/posloviPodaci/index.php?action=whatever)

[http://10.0.2.2/posloviPodaci/index.php?action=rah&bar=test](http://10.0.2.2/posloviPodaci/index.php?action=rah&bar=test)

If you need to pass more sensitive data, I recommend you stick with $_POST and utilize some form of encryption.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-24T16:34:11.653

你可以在 php 端处理它。创建一个 Json 对象，其中包含一个名为 command 的字段，可能还有一个参数列表。

在解码 json 后的 php 端，只需执行以下操作：

```
if($obj.command == "foo"){
  foo($obj.arg[0],$obj.arg[1]);

} 
```

# peoplesoft - PeopleSoft 登录问题

> ID：10301981
> 
> 赞同：2
> 
> 时间：2012-04-24T16:24:20.977
> 
> 标签：peoplesoft

大家好，我们正在建立一个工作门户。当用户登录到门户时，他/她可以按下一个按钮，将他们重定向到 peoplesoft 网页。这可以正常工作，但是当用户仅关闭 peoplesoft 网页中的选项卡并且没有退出时，他/她在再次访问 peoplesoft 页面时遇到问题。例如; 用户登录到门户 --> 单击按钮 -->( (A)cmd=pslogin 登录，如果需要) 重定向到 peoplesoft 页面 --> 关闭选项卡（不退出）--> 进入带有门户的选项卡 - -> 单击按钮--> peoplesoft 页面不加载出现空白屏幕。出现的空白屏幕与之前的 (A) 相同，但什么也没有出现。我认为问题在于，当用户关闭选项卡而不注销本地计算机上的会话/cookie 时，永远不会删除。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T14:19:15.490

您的门户可能使用绕过登录。这使来宾用户能够作为默认用户自动登录。当那个人登录到 PeopleSoft cookie 时，cookie 就会被设置，其中之一是会话超时 cookie。当该人在未注销的情况下重新访问该站点时，他们仍然拥有该 cookie，并且 PeopleSoft 看到他们现在有一个无效的会话并将他们发送到错误或登录屏幕。

您是直接链接到标签页还是其他一些组件 URL？

# iphone - Objective-C 常量变量不起作用，出现“在类型对象上找不到属性”

> ID：10301982
> 
> 赞同：0
> 
> 时间：2012-04-24T16:24:23.180
> 
> 标签：iphone, objective-c, ios5

在Java中，以下代码很好，没有错误。

```
class ConstantA{
  public static String MY_TEST = "My Test";
} 
```

* * *

```
import ConstantA;
Class TestClass{
  public void test(){
    System.out.println(ConstantA.MY_TEST); // it's work fine.
 }
} 
```

根据上述java概念，它不适用于Objective-C，

在 ConstantA.h 文件中

```
extern NSString * const MY_TEST;
@interface ConstantA : NSObject
@end 
```

在 ConstantA.m 文件中

```
NSString * const MY_TEST = @"My Test";
@implementation ConstantA
@end 
```

在 main.m 文件中（此处发生错误）

```
#import "ConstantA.h"
int main(int argc, char *argv[])
{
    @autoreleasepool {
       NSLog(@"%@",ConstantA.MY_TEST); // error: Property 'MY_TEST' not found on object of type 'ConstantA'
    }
} 
```

可以帮我解决这个问题吗？非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:30:53.843

```
#import "ConstantA.h"
int main(int argc, char *argv[])
{
    @autoreleasepool {
        NSLog(@"%@", MY_TEST); // error: Property 'MY_TEST' not found on object of type 'ConstantA'
    }
} 
```

直接使用全局变量，没有类名： **MY_TEST**和 NOT ConstantA.MY_TEST。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:28:25.983

使用`NSLog(@"%@",MY_TEST);`.

`MY_TEST`不受`ConstantA`任何限制；它只是一个全局变量。Objective-C 不像 Java 或 C++ 那样支持类级别的“静态变量”。类只能有实例变量

您可以使用全局变量来模拟类变量，但它仍然只是全局变量；它没有以任何方式命名为类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T16:29:31.190

将您的全局字符串放在 .h 文件属性中（非原子，保留） NSString *gMyString;

在.m文件中合成gMyString；

它应该工作......上周我遇到了同样的问题！

# php - 工资 PHP 脚本

> ID：10301986
> 
> 赞同：0
> 
> 时间：2012-04-24T16:25:03.877
> 
> 标签：php, payment-processing

我正在寻找一个只显示不属于周末的工资日期的脚本。

例如，当月的第 1 日、第 15 日和最后一天可以是工资日期，但如果日期是周末，则将显示下一个工作日。

这是迄今为止所做的...

```
<?php
date_default_timezone_set('UTC');

function firstDayOftheMonth($month){
    return date('j',mktime(1,1,1,$month,1,date('Y')));
}

function lastDayOfTheMonth($month){
    return date('j',mktime(-1,-1,-1,$month+1,1,date('Y')));
}

function daysInMonth($month){
    return cal_days_in_month($calendar, $month, date('Y'));
}

function getDay($day, $month){
    return date('l', mktime(0, 0, 0, $month, $day, date('Y')));
}

// Set year and month variables.
$months = 12;

echo "<strong>Month Name, 1st Expenses Day, 2nd Expenses Day, Salary Day</strong><br />";

// Loop through months
for($month=1; $month <= $months; $month++){
    echo "<strong>" . date('F', mktime(1, 1, 1, $month, 1, date('Y'))) . "</strong><br />";
    // Get No# days for each month of the year.
    $days = daysInMonth($month);
    // Loop through all days of the month.
    for($d=1; $d <= $days; $d++){
        // Get textual days
        $day = getDay($d, $month);
        if($d==firstDayOftheMonth($month) || $d==lastDayOfTheMonth($month) || $d==15){
            echo $d . ", " . $day . ", " . date('Y') . "<br />";
        }
    }

     echo "<hr />";
}

?> 
```

任何帮助深表感谢。

先谢谢了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:27:07.787

您可以使用`date('w')`数字来获取星期几。我想`0`和`6`分别是星期天和星期六。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:35:16.067

```
if(($i=date('w', $date))>=5) {
  $date = strtotime(date("Y-m-d", strtotime($date)) . "+ ".(7-$i).($==6 ? "day" : "days")); 
} 
```

# html - 调整父 div 的大小以适合子 div

> ID：10301987
> 
> 赞同：5
> 
> 时间：2012-04-24T16:25:06.080
> 
> 标签：html, css, position

如果不使用 JavaScript，这可能是一个很长的路要走……

如果我有以下情况（删除了问题的代码）

```
<div id="container">
    <div id="content"></div>
</div> 
```

```
#container {
    position: relative;
}

#content {
    position: absolute;
} 
```

内容框包含动态内容，因此不能使用固定高度。

必须在内容 div 上使用绝对位置，因为它使用 jQuery UI 的东西......

如何让容器框调整其高度以适应内容？

我知道如果不使用某种 JavaScript，这可能是不可能的，因为放置绝对定位的 div 会使其脱离流程等，但只是想知道是否有人知道某种解决方法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:35:40.030

编辑：我第一次误解了这个问题。

如果一切都失败了，这是一个 jQuery 解决方案：

```
$('#container').css('height',$('#content').height()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:58:07.310

好的，我不知道你的内容是什么（jQuery UI 的东西）。但是，假设它只是一个图像：

```
#container {
    position: relative;
}

#content {
    position: absolute;
    top:0; bottom:0; left:0; right:0;
} 
```

这会将您的内容区域设置为父级的至少 100% 的宽度和高度。

# ios - AVAudioFoundation 升级到 iOS 5.0

> ID：10301988
> 
> 赞同：0
> 
> 时间：2012-04-24T16:25:18.163
> 
> 标签：ios, avaudiorecorder

我正在使用 AVAudioFoundation。在 iOS 5.0 模拟器和 iOS 5.1 设备上遇到了一些问题。该应用程序在 iOS 4.1 的设备和模拟器上运行良好。

1.  启动时出现加载错误。他们继续下去，就像这样：

    `Error loading /System/Library/Extensions/AudioIPCDriver.kext/Contents/Resources/AudioIPCPlugIn.bundle/Contents/MacOS/AudioIPCPlugIn: dlopen(/System/Library/Extensions/AudioIPCDriver.kext/Contents/Resources/AudioIPCPlugIn.bundle/Contents/MacOS/AudioIPCPlugIn, 262): Symbol not found: _CFXMLNodeGetInfoPtr Referenced from: /System/Library/Frameworks/Security.framework/Versions/A/Security Expected in: /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.0.sdk/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation in /System/Library/Frameworks/Security.framework/Versions/A/Security`

    我认为这与我在 Snow Leopard 上运行 Xcode 4.2 并且只下载了 iOS 5.0 sdk 而不是购买 Lion 并将 Xcode 升级到 4.3 有关。但是话又说回来，问题也出现在设备上，所以它似乎不是 Xcode 的问题。

    在[这个问题](https://stackoverflow.com/questions/6906930/avaudiorecorder-is-broken-on-ios-5)中，他们说这只是“噪音”。但这仍然是问题吗？

2.  然后在调用时`AVURLAsset loadValuesAsynchronouslyForKeys: completionHandler:`，`AVKeyValueStatus`is`0`而不是 expected `AVKeyValueStatusLoaded`。

这是我使用的代码：

```
NSArray *keys = [NSArray arrayWithObject:[NSArray arrayWithObjects:@"duration", @"tracks", nil]];
AVURLAsset *asset = [[AVURLAsset alloc] initWithURL:tempRecFileURL options:nil];

[asset loadValuesAsynchronouslyForKeys:keys completionHandler: ^{

    NSError *error = nil;
    AVKeyValueStatus tracksStatus = [asset statusOfValueForKey:@"tracks" error:&error];
    switch (tracksStatus) {
        case AVKeyValueStatusLoaded:
            // this is where I normally end up doing stuff but not on iOS 5.0
            break;
        case AVKeyValueStatusFailed:
        case AVKeyValueStatusCancelled:
            // doing other stuff here
            break;
    }
}]; 
```

这是我得到的输出（仅限 iOS 5.0）：

```
[AVAsset loadValuesAsynchronouslyForKeys:completionHandler:] invoked with unrecognized keys (
        (
        duration,
        tracks
    )
). 
```

`error`是`nil`。

我没有得到什么？感觉好像我需要在某个地方做一些参考，但我不知道在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:38:51.303

这里的本质问题是线路

```
NSArray *keys = [NSArray arrayWithObject:[NSArray arrayWithObjects:@"duration", @"tracks", nil]]; 
```

应该是

```
NSArray *keys = [NSArray arrayWithObjects:@"duration", @"tracks", nil]; 
```

# actionscript-3 - AS3 当符号在某个位置时

> ID：10301990
> 
> 赞同：0
> 
> 时间：2012-04-24T16:25:20.207
> 
> 标签：actionscript-3, flash

我正在使用 Flash Professional CS5.5，我需要制作一个应用程序，其中有一个使用加速度计移动的球（符号），我想要这样，当球 A 坐标达到此坐标时，BI 转到第 2 帧（gotoAndPlay( 2))。我必须先找到球坐标，对吧？我怎么做这个？

这是我现在的代码

```
c_ball.addEventListener(MouseEvent.MOUSE_DOWN, fl_ClickToDrag);
function fl_ClickToDrag(event:MouseEvent):void{
c_ball.startDrag();}
stage.addEventListener(MouseEvent.MOUSE_UP, fl_ReleaseToDrop);
function fl_ReleaseToDrop(event:MouseEvent):void{
c_ball.stopDrag();} 
```

如果在检索坐标后会起作用吗？

```
function f_level (e) if (c_ball.x==100 && c_ball.y==100) {
gotoAndStop(2);} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T17:06:39.470

我会添加一个`enter frame`事件监听器，并在那里检查 c_ball 的坐标。

```
stage.addEventListener(Event.ENTER_FRAME, siteLoop);

public function siteLoop(event:Event)
{
  if ((c_ball.x > 99.9) && (c_ball.y > 99.9)){
    gotoAndStop(2);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T18:08:58.630

使用碰撞检测创建一个目标区域并用你的球测试它 - 如果需要 onEnterframe 对象或者当你每件事都花时间时：

```
private function test():void{
    if(  ball.hitTestObject(testarea) ){
        // here goes next frame command ;)
    }
} 
```

# c# - 具有多个上下文的 EF 查询

> ID：10301991
> 
> 赞同：1
> 
> 时间：2012-04-24T16:25:21.400
> 
> 标签：c#, entity-framework-4

我有两个 EF 上下文 _inventoryContext 和 _auctionContext。

_inventoryContext 有一个名为 Items 的属性，而 _auctionContext 有一个名为 Auctions 的属性。Items 是 Item 对象的集合，每个对象都包含一个用于唯一标识它们的 Guid。Auctions 属性是 Auction 对象的集合，每个对象都包含一个 Guid InventoryReference，它引用 Items 的元素之一。

我想要做的是获取不属于拍卖的所有库存物品的清单。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:46:33.717

[这](https://stackoverflow.com/questions/377530/linq-to-entities-entity-framework-cross-edmx-join)可能对你有帮助。

或者，您可以分两步执行此操作：首先从您的拍卖中获取 GuidReferences 集合，然后获取其 Guid 包含在集合中的项目。由于额外的查询以及框架需要分配 Guid 集合，性能会受到影响。但根据 Item 集合的大小，这对您来说可能没什么大不了的。

另一种可能性是在一个数据库/上下文中创建一个视图，从另一个数据库/上下文中提取数据。但是，这将是只读的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-10-14T10:39:07.273

EF Core 中有更好的解决方案

您可以创建一个名为 Auctions 的视图作为您的上下文之一，并在您的代码中映射 DbSet 模型。因此，您可以在另一个上下文中使用其他上下文模型和表。但是您必须确保您的 db 用户可以访问这两个上下文。例如在 _inventoryContext 你可以这样定义。

```
public virtual DbSet<Auction> Auctions { get; set; }

modelBuilder.Entity<Auction>(entity =>
{
       entity.ToView("vwAuctions");
} 
```

它为您提供了类似的东西

```
var result= from x in _inventoryContext.InventoryReference 
        join y in _inventoryContext.Auctions on x.Id equals y.InvRef
        select x; 
```

# javascript - Firebug 不会在启动 JavaScript 中的断点处中断，除非在第一个脚本元素中

> ID：10301994
> 
> 赞同：2
> 
> 时间：2012-04-24T16:25:36.090
> 
> 标签：javascript, firebug, startup, breakpoints

我无法让 Firebug 在 <script> 标记内的 JS 上设置的断点处停止；即页面加载时运行的JS。 *除非*<script> 是页面上的第一个此类标记。

在下面的示例中，有 3 个脚本块。当它被加载到浏览器中时，我可以在任何块中的任何可执行行上设置断点。但是，执行只会在第一个脚本块中的面包点上停止。

行号在第一个块中为绿色，在其他块中为灰色。此外，在显示断点列表的选项卡中，第一个脚本中的断点标有启用/禁用复选框旁边的文件名；其他断点标记为“未定义”

任何帮助，将不胜感激。提前致谢。

```
<html>
   <head>  
      <script type="text/javascript" >  
         var j = 4;  
         j=5;  
      </script>  
      <script type="text/javascript" >  
         j=137;  
      </script>  
   </head>  
   <body>  
      <script type="text/javascript" >  
         document.write( "j=" + j );  
      </script>  
   </body>  
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T10:46:07.023

我有同样的问题，和你一样，我试图弄清楚为什么萤火虫有这个，恕我直言，奇怪的行为。其实我认为这是一个错误。但我也找到了一种解决方法，希望能有所帮助。

您只需将代码包装在匿名函数中，然后您可以再次添加断点。

![匿名函数中的 Firebug 断点](../Images/237d9efd9dee63dcaf8647683626ee22.png)