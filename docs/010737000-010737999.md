# StackOverflow 问答 10737000-10737999

# java - 完整的菜鸟，Android 应用帮助（数组）

> ID：10737000
> 
> 赞同：0
> 
> 时间：2012-05-24T11:54:42.573
> 
> 标签：java, android, arrays

如果我开始惹恼任何人，我真的很抱歉，我已经花了数周时间尝试这样做，我需要完成我的应用程序（测验），我似乎无法理解如何实现这一点（我向所有程序员致敬）。所以我要试着一点一点地整理出来。首先让我概述一下我正在尝试做的事情。

页面/活动 1 = 4 个按钮，用于各种测验类别，我现在只想要一个工作。

第 2 页 = 我想要一个问题和 4 个可能的答案（随机排列），以及一个下一步按钮，然后将滚动到下一个问题。

最后一页我想把所有正确的答案加起来，或者是一个 8/10 的场景，或者如果可能的话，时间和能力允许一张由分数定义的奖杯和颜色的图片。

现在到目前为止，我已经完成了我认为的布局，拖放我可以做到。

上周我花了这个时间试图获得一个问题和答案的数据库，但我做不到，所以我决定做数组。

第一个问题是这就是我的数组的样子，我已经在自己的类中设置了它，这是可行的还是愚蠢的？

```
public class QuestionSets {

String mathsQuestions[]= {
        "What is 10 * 4 =?",
        " How many sides does a cube have?", 
        "What is Pi equal to, to 2 decimal places?", 
        "What is 595 172 correct to the nearest thousand?", 
        "What is 2.5 * 100?", 
        "What is 90 out of 200 as a percentage?", 
        "What is y if y=5x+5 if x is 5?", 
        "What is 66 + 108?", 
        "What is 1 + 0.6?, What is 10 - 8=?"};

String correctAnswers[]= 
    {"40", "6", "3.14", "595 000", "250", "45%", "30", "174", "1.6", "2"};

String option1 [] = 
    {"50", "4", "4.13", "596 000", "25", "40%", "40", "170", "0.7", "4"};

String option2 [] = 
    {"45", "7", "5,14", "600 000", "200", "50%", "25", "178", "7", "80"};

String option3 [] = 
    {"54", "3", "2.13", "500 000", "2000", "90%", "20", "180", "6", "18"};

// ... 
```

正确和错误的答案与问题一致。

我看到有人做数组列出了我放在问题课上的东西，这对吗？我真的不知道，但这就是我在那里所做的。

```
// ...

ArrayList<Integer> mthsQuestions = new ArrayList<Integer>();

ArrayList<Integer> crtAns = new ArrayList<Integer>(); 

ArrayList<Integer> optn1 = new ArrayList<Integer>(); 

ArrayList<Integer> optn2 = new ArrayList<Integer>();

ArrayList<Integer> optn3 = new ArrayList<Integer>(); 

} 
```

还有为什么它们是整数，它们不应该是字符串吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:19:23.723

你是对的，这是错误的。你应该使用`ArrayList<String>`. 您可以在初始化时填写它：

```
ArrayList<String> optn3 = new ArrayList<String>(Arrays.asList(option3)); 
```

但是，从工程的角度来看，最好将问题和答案放在您的程序可以读取的单独文本文件中。这样您就可以更改问题或添加新问题，而无需重新编译程序。

# sql - 我们应该在sql-server中使用float作为主键吗

> ID：10737004
> 
> 赞同：8
> 
> 时间：2012-05-24T11:55:01.807
> 
> 标签：sql, sql-server-2008, primary-key

有人建议我使用浮点数作为表的主键而不是使用 BIGINT 是一个更好的主意。我们可以将浮动主键设为身份吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-24T12:12:21.463

注意事项：

*   您可以制作一个浮点字段主键。
*   你不能创建一个浮点字段 IDENTITY。标识列的数据类型必须为 int、bigint、smallint、tinyint 或小数或小数位数为 0 的数字
*   你绝对不应该使用浮点字段作为 PK。同样，你可以，SQL Server 将允许你，但不推荐它，主要是因为 @Andy 所说的浮点数不准确。

为什么你仍然需要一个浮动作为PK？您是否需要像 3,1234235234534 这样的值来唯一标识您的行？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T12:02:42.363

注意如果你做 float a=1f 和 float b=1f 它们是一样的吗？

但是 if(a==b) 可能不正确，因为浮点数不准确。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-24T12:01:01.010

为什么不对主键使用大数据类型：

保持索引的“宽度”尽可能窄。这减小了索引的大小并减少了读取索引所需的磁盘 I/O 读取次数，从而提高了性能。

如果可能，请尝试在具有整数值而不是字符的列上创建索引。整数值的开销小于字符值。

不要对主键使用 FLOAT 或 REAL 数据类型，因为它们会增加不必要的开销并会损害性能。

窄列上的索引比宽列上的索引更可取。索引越窄，SQL Server 可以在数据页上容纳的条目就越多，这反过来又会减少访问数据所需的 I/O 量。

减小键的大小，从而减少连接过程中的读取 I/O，并提高整体性能。

# bash - 有什么方法可以知道已启动程序的 pid 吗？

> ID：10737011
> 
> 赞同：10
> 
> 时间：2012-05-24T11:55:27.767
> 
> 标签：bash

如果我小时候启动一个 bash 脚本，我可以使用 $$ 将它自己的 pid 传递给父级。

有什么方法可以找到我从后台脚本启动的程序的 pid，例如：

```
ping x.x.x.x & 
```

那个 ping 的 pid 是什么？

（我只希望我正确地表达了自己……我的英语不是最好的）

PS。我正在寻找一个简单而干净的解决方案，我可以想象这样的事情：

```
ping -t10000 -W10 x.x.x.x &
then
ps ax | grep 'ping -t10000 -W10 x.x.x.x'$ 
```

但是太复杂了，甚至我用开关来个性化它也不干净，它可能会捕获系统中的另一个进程

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-24T11:58:08.517

该变量`$!`具有您启动的最后一个后台进程的 PID。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-24T11:58:38.693

使用这个：`$!`在执行你想要的 PID 的命令之后。这意味着，尽管您需要`&`在命令后使用与号 ( ) 来在后台启动它。例如：

```
my_command & CMDPID=$!
echo "$CMDPID" 
```

# android - 使用 AsyncTask 启动活动

> ID：10737016
> 
> 赞同：12
> 
> 时间：2012-05-24T11:55:43.040
> 
> 标签：android, android-asynctask

我正在使用 asyncTask 显示对话框，然后在几分钟后启动一个新活动。

不幸的是，该活动在任务完成之前开始？？？

```
package com.android.grad;

import android.app.Activity;

import android.app.ProgressDialog;

import android.os.AsyncTask;

import android.widget.Toast;

public class LoginTask extends AsyncTask<Void, Void, Boolean> {
private Activity activity;
private ProgressDialog pd;

public LoginTask(Activity activity) {
    this.activity = activity;
}

@Override
protected void onPreExecute() {
    pd = ProgressDialog.show(activity, "Signing in",
            "Please wait while we are signing you in..");
}

@Override
protected Boolean doInBackground(Void... arg0) {
    try {
        Thread.sleep(10000000);
    } catch (InterruptedException e) {
    }
    pd.dismiss();
    return true;
}

@Override
protected void onPostExecute(Boolean result) {
    Toast.makeText(activity, Boolean.toString(result), Toast.LENGTH_LONG).show();
} 
```

}

我从按钮单击侦听器执行任务：S

```
private OnClickListener loginOnClick = new OnClickListener() {

        public void onClick(View v) {
            new LoginTask(LoginActivity.this).execute();
            startActivity(new Intent(LoginActivity.this, BuiltInCamera.class));
        }
    }; 
```

有没有办法从我的子类 ofAsyncTask 开始活动。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-05-24T12:00:21.023

是的，您可以从 AsyncTask 的子类开始活动。见下文：

```
@Override
protected void onPostExecute(Boolean result) {
    Toast.makeText(activity, Boolean.toString(result), Toast.LENGTH_LONG).show();

    activity.startActivity(new Intent(activity, BuiltInCamera.class));
} 
```

进行此更改后，请确保确实从中删除**startActivity**`OnClickListener`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T11:59:07.367

调用`startActivity`内部`onPostExecute`方法`AsyncTask`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-24T12:00:51.873

在显示 toast 消息之后调用它`startActivity(new Intent(LoginActivity.this, BuiltInCamera.class));`。`onPostExecute()`

这样，新的活动将在你`AsyncTask`结束后被调用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-03-27T07:18:07.223

你也可以使用

```
 Intent intent = new Intent(activity, PageViewActivity.class);
    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
    activity.getApplicationContext().startActivity(intent); 
```

# c - 用C剪切一个jpg文件，（不裁剪）

> ID：10737022
> 
> 赞同：0
> 
> 时间：2012-05-24T11:55:54.577
> 
> 标签：c, image-processing, opencv

我想知道如何使用我想使用artoolkit和opencv检索的坐标来剪切jpg文件，请参阅：

[斑点检测](https://stackoverflow.com/questions/10366421/blob-detection-in-c/10436211#10436211)

我想检索白纸的坐标，然后使用这些坐标剪切我之前拍摄的 jpg 文件。找到这个，但这有什么帮助？ [如何将图像切片/切割成碎片](https://stackoverflow.com/questions/4875372/how-to-slice-cut-an-image-into-pieces)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:32:13.647

如果您已经有了坐标，您可能需要先[对图像进行校正](https://stackoverflow.com/questions/7800905/affine-transform-simple-rotation-and-scaling-or-something-else-entirely)：

[http://nuigroup.com/?ACT=28&fid=27&aid=1892_H6eNAaign4Mrnn30Au8d](http://nuigroup.com/?ACT=28&fid=27&aid=1892_H6eNAaign4Mrnn30Au8d)

[这篇文章](https://stackoverflow.com/questions/7838487/executing-cvwarpperspective-for-a-fake-deskewing-on-a-set-of-cvpoint)用来`cv::warpPerspective()`达到这个效果。

上面的参考资料使用了OpenCV 的**C++**接口，但我相信你能够在两者之间进行转换。

其次，*切割*图像的特定区域称为提取感兴趣区域 (ROI)。一般程序是：创建一个`CvRect`来定义您的 ROI，然后调用，`cvSetImageROI()`然后`cvSaveImage()`将其保存在磁盘上。

[这篇文章](https://stackoverflow.com/a/10326191/176769)分享了**C**代码来完成这个任务。

# jboss7.x - 在 Jboss 和 Openshift 中使用 jar 库

> ID：10737023
> 
> 赞同：0
> 
> 时间：2012-05-24T11:56:01.300
> 
> 标签：jboss7.x, openshift

我正在尝试使用 Jboss 和 Eclipse 在 Openshift 上部署一个简单的 REST Web 服务。我有一个包含一些类的 Jar 库，我把它放在路径中：

src/main/webapp/WEB-INF/lib/

的项目。在本地部署应用程序并对其进行测试是可以的，但是当我尝试在 Openshift 上部署时，我在构建时遇到错误：

ClassNotFoundException

阅读日志我注意到 Jboss（在 Openshift 上）没有找到我的 Jar：为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T20:31:07.793

*   检查库是否存在于战争中（你可以解压这个文件）
*   检查war是否部署在远程服务器并解压缩war以查看库：ssh 5fcd6........@yourappname-yourdomain.rhcloud.com
*   检查路径：/var/lib/stickshift/5fcd6......../app-root/runtime/repo/deployments
*   在文件夹部署中查看自述文件（在本地）
*   你应该使用 Maven。样本：

 `````
<build>
        <plugins>
            <plugin>
                <artifactId>maven-war-plugin</artifactId>
                <version>2.2</version>
                <configuration>
                    <failOnMissingWebXml>false</failOnMissingWebXml>
                    <archive>
                        <manifestEntries>
                            <Dependencies>org.slf4j,org.apache.commons.logging,org.joda.time</Dependencies>
                        </manifestEntries>
                    </archive>
                </configuration>
            </plugin>
        </plugins>
    </build>
    <profiles>
        <profile>
            <id>openshift</id>
            <build>
                <finalName>yourapp</finalName>
                <plugins>
                    <plugin>
                        <artifactId>maven-war-plugin</artifactId>
                        <configuration>
                            <outputDirectory>deployments</outputDirectory>
                            <warName>ROOT</warName><!-- ROOT -->
                        </configuration>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles> 
`````

# ruby-on-rails - 如何通过身份验证在 ruby on rails 中提供文件？

> ID：10737024
> 
> 赞同：0
> 
> 时间：2012-05-24T11:56:04.717
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

我的问题是，我将文件上传到我的服务器，atm 上传的文件位于资产目录下，但我不希望所有用户都授予对文件的访问权限，但如果文件位于资产目录下，所有用户可以下载它们等。

但是如果用户想要更改他的文件，那么他应该使用 js 访问它们（认为我使用 js 作为编辑器）。

有人能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:14:16.767

我希望你使用**回形针**宝石。阅读这篇关于受保护文件下载的帖子：http: [//thewebfellas.com/blog/2009/8/29/protecting-your-paperclip-downloads](http://thewebfellas.com/blog/2009/8/29/protecting-your-paperclip-downloads)

# winforms - 我有一个带有图像和文本的按钮 - 如何给文本本身填充？

> ID：10737026
> 
> 赞同：3
> 
> 时间：2012-05-24T11:56:08.843
> 
> 标签：winforms, button, padding

首先，我将显示当前显示的图像；

![描述](../Images/9c9300d1dbfef2241e4a81ef80eb4a87.png)

您会看到 (System.Windows.Forms.)Button 的图像是如何正确放置的，但文本没有正确的左填充。

我怎样才能给按钮的文本从左边大约 30px 填充？我尝试更改按钮的填充本身，但它同时更改了文本和图像的填充。

谢谢，

〜Tgys

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:29:43.383

尝试设置`TextImageRelation`属性：

```
button1.TextImageRelation = TextImageRelation.ImageBeforeText; 
```

# spring - 使用类路径找不到 spring-util xsd

> ID：10737028
> 
> 赞同：2
> 
> 时间：2012-05-24T11:56:14.990
> 
> 标签：spring, xsd

得到错误：

```
nested exception is org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Unable to locate Spring NamespaceHandler for XML schema namespace [http://www.springframework.org/schema/util] 
```

我检查了 spring-beans-2.5.6 jar - 它在指定的类路径中有引用的文件。

对应的xml文件头如下。

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:batch="http://www.springframework.org/schema/batch"
xmlns="http://www.springframework.org/schema/beans" 
xmlns:util="http://www.springframework.org/schema/util"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        classpath:org/springframework/beans/factory/xml/spring-beans-2.5.xsd
        http://www.springframework.org/schema/util
        classpath:org/springframework/beans/factory/xml/spring-util-2.5.xsd
        http://www.springframework.org/schema/batch
        classpath:org/springframework/batch/core/configuration/xml/spring-batch-2.1.xsd"> 
```

堆栈跟踪：

```
at org.springframework.beans.factory.parsing.FailFastProblemReporter.error(FailFastProblemReporter.java:68)
at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:85)
at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:76)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.importBeanDefinitionResource(DefaultBeanDefinitionDocumentReader.java:201)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseDefaultElement(DefaultBeanDefinitionDocumentReader.java:147)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:132)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:92)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:507)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:398)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:342)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:310)
at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:143)
at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:178)
at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:149)
at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:212)
at org.springframework.context.support.AbstractXmlApplicationContext.loadBeanDefinitions(AbstractXmlApplicationContext.java:113)
at org.springframework.context.support.AbstractXmlApplicationContext.loadBeanDefinitions(AbstractXmlApplicationContext.java:80)
at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:123)
at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:422)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:352)
at org.springframework.context.support.FileSystemXmlApplicationContext.<init>(FileSystemXmlApplicationContext.java:140)
at org.springframework.context.support.FileSystemXmlApplicationContext.<init>(FileSystemXmlApplicationContext.java:84) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:27:58.057

您不必在 schemaLocation 属性中指定模式的实际物理位置。试试这样

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:batch="http://www.springframework.org/schema/batch"
xmlns="http://www.springframework.org/schema/beans" 
xmlns:util="http://www.springframework.org/schema/util"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
        http://www.springframework.org/schema/util
        http://www.springframework.org/schema/util/spring-util-2.5.xsd
        http://www.springframework.org/schema/batch
        http://www.springframework.org/schema/batch/spring-batch-2.1.xsd"> 
```

模式名称和位置之间的实际映射由 spring 完成，并在各种 spring.schemas 文件中定义（假设您使用的是正确/有效的 spring jars）。

# java - 使用 JFileChooser 将图像加载到 JFrame

> ID：10737029
> 
> 赞同：3
> 
> 时间：2012-05-24T11:56:19.537
> 
> 标签：java, swing, jpanel, jlabel, imageicon

我正在尝试编写一个代码，将使用 JFileChooser 选择的图像显示到另一个 JFrame 中。我尝试了下面的代码，但只得到了以下错误。

```
Exception in thread "main" java.lang.NullPointerException
at javax.swing.ImageIcon.<init>(ImageIcon.java:228)
at power.<init>(fCGUI.java:53)
at fCGUI.main(fCGUI.java:11) 
```

这是代码：

```
import javax.imageio.ImageIO;
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;

public class fCGUI
{
    public static void main(String []args)
    {
        power p=new power();
        p.setVisible(true);
    }
}

class power extends JFrame
{
    JFileChooser chooser;
    BufferedImage img;
    JButton button,button2;
    JFrame comp;
    String filename;
    File file ; 

    public power()
    {
        setSize(450,450);
        panel.setLayout(new BorderLayout());

        JPanel panel=new JPanel();
        getContentPane().add(panel);
        button =new JButton("press");

        panel.add(button,BorderLayout.NORTH);

        chooser = new JFileChooser();

        ActionListener action=new ActionListener()
        {
            public void actionPerformed(ActionEvent e)
            {
                if (e.getSource()==button)
                {
                    chooser.showOpenDialog(null);
                    file = chooser.getSelectedFile();

                    try
                    {
                        img=ImageIO.read(file);
                    }
                    catch(IOException e1) {}
                }

                if (e.getSource()==button2)
                {
                    comp.setVisible(true);
                }
            }
        };

        ImageIcon icon=new ImageIcon(img);
        JLabel label=new JLabel(icon);

        JPanel secpanel=new JPanel();

        comp=new JFrame();
        comp.setSize(650,500);
        comp.setLayout(new BorderLayout());
        comp.setTitle("View Report");

        JRootPane compPane=comp.getRootPane();
        Container contePane=compPane.getContentPane();
        contePane.add(secpanel);

        secpanel.add(label,BorderLayout.CENTER);

        button2=new JButton("access");
        button2.addActionListener(action);
        button.addActionListener(action);

        panel.add(button2,BorderLayout.SOUTH);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:38:05.830

只有在用户单击按钮并选择要显示的文件后，该值`img`才会具有实际值。直到此时， 的值`img`是`null`，所以当它继续通过您的方法并调用 line`ImageIcon icon=new ImageIcon(img);`时，它​​正在尝试为 创建一个`ImageIcon`对象`null`。

要更正此问题，您应该只`ImageIcon`在用户选择文件时创建。这是一个应该更接近正常工作的更改。（请参阅评论`//ADDED`和`//REMOVED`下面的代码以查看更改...

```
...
class power extends JFrame {
    JFileChooser chooser;
    BufferedImage img;
    JButton button,button2;
    JFrame comp;
    String filename;
    File file ; 
    JLabel label; // ADDED

    public power() {
    ...
            public void actionPerformed(ActionEvent e) {
                if (e.getSource()==button) {
                    chooser.showOpenDialog(null);
                    file = chooser.getSelectedFile();

                    try {
                        img=ImageIO.read(file);
                        ImageIcon icon=new ImageIcon(img); // ADDED
                        label.setIcon(icon); // ADDED

                        Dimension imageSize = new Dimension(icon.getIconWidth(),icon.getIconHeight()); // ADDED
                        label.setPreferredSize(imageSize); // ADDED

                        label.revalidate(); // ADDED
                        label.repaint(); // ADDED
                    }
                    catch(IOException e1) {}
                }

                if (e.getSource()==button2){
                    comp.setVisible(true);
                }
            }
        };

        //ImageIcon icon=new ImageIcon(img); // REMOVED
        //JLabel label=new JLabel(icon); // REMOVED
        label = new JLabel(); // ADDED

        JPanel secpanel=new JPanel();
        ... 
```

为了解释我改变了什么......

1.  当您第一次启动程序时，`label`现在将创建为空。`JLabel`它也被存储为全局变量，因此我们以后可以访问它
2.  单击按钮时`img`，会像以前一样创建 ，然后将其加载到您的`label`using`setIcon();`
3.  调整标签的大小，然后`revalidate()`确保`repaint()`图像在设置后被绘制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:03:54.057

仅在按下该`ImageIO.read`特定时才会执行。`JButton`那是因为它在`ActionListener`. 因此，`img`is null 会导致`NullPointerException`何时`ImageIcon icon=new ImageIcon(img)`执行。

# iphone - 关于使用 OAuth 进行 Twitter 集成

> ID：10737031
> 
> 赞同：0
> 
> 时间：2012-05-24T11:56:20.863
> 
> 标签：iphone, objective-c

我正在尝试使用 OAuth 进行 Twitter 集成。一切都很好，但是当我编译并运行它时，它只给出一个屏幕，显示我自己的按钮和带有灰色屏幕的文本字段，我在 xib 中添加了这些，而不是带有高音扬声器的屏幕。

这是我的代码

```
 - (void)viewWillAppear:(BOOL)animated {

if (!self.engine) {

    _engine = [[SA_OAuthTwitterEngine alloc] initOAuthWithDelegate:self];
    self.engine.consumerKey = kOAuthConsumerKey;
    self.engine.consumerSecret = kOAuthConsumerSecret;

}

if (![self.engine isAuthorized]) {

    UIViewController *controller = [SA_OAuthTwitterController controllerToEnterCredentialsWithTwitterEngine:self.engine 
                                    delegate:self];

      if(controller) {

           [self presentModalViewController:controller animated:YES];

    }

} 
```

}

# ajax - 如何将 AJAX 参数传递给 extbase 操作？

> ID：10737033
> 
> 赞同：5
> 
> 时间：2012-05-24T11:56:23.757
> 
> 标签：ajax, action, typo3, param, extbase

现在我设法从数据库中获取值，我想指定更多我想要传递的内容。

从对下面的事件函数作出反应的选择框中，我想读出一个值（记录的 uid）并将其传递给我的 ajaxAction：

```
    var uid;
    $('#mySelectBox').change(function() {
        arguments = $(this).attr('value');
        var uri = '<f:uri.action arguments="{uid: '+uid+'}" action="ajax" controller="Mycontroller1" pageType="89657201" />';

        jQuery.getJSON(uri, function(result) {
            // do something
        });
    }); 

```

我用参数尝试过，不知道这是否是正确的方法。此外，正如 Marcus Biesioroff 建议的那样，我应该将我的 JS 保存到一个单独的文件中，但是我必须自己编写 uri 而不是 Fluid 方式，对吧？

我的 ajaxAction 看起来像这样：

```
    public function ajaxAction($uid) {
            $dataFromRepo = $this->myRepository->findByUid($uid);

            $resultArray = array(
                "field1" => $dataFromRepo->getField1(),
                "field2" => $dataFromRepo->getField2(),
                "field3" => $dataFromRepo->getField3(),
                "field4" => $dataFromRepo->getField4(),
            );
            return json_encode($resultArray);
        } 

```

我确定uid没有正确传递，其他一切正常。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T14:26:57.953

有一些错误：

*   即使将 vievhelper 置于视图中，您也无法使用 JS 破坏 vievhelper 的语法，您**需要**从`<f:uri.action />`
*   您不能将此 JS 放在视图中，因为它包含大括号，还有[其他问题描述](https://stackoverflow.com/a/10214274/1066240)
*   您需要从外部文件调用 ajax 函数并分别传递给它的动作链接和 uid，然后添加

在视图中：

```
<script type="text/javascript">
    var actionsPathFromViewHelperSetInTheView 
        = '<f:uri.action action="ajax" controller="Mycontroller1" pageType="89657201" />';
</script>
<script type="text/javascript" src="path/to/ext/Public/yourExternal.js"></script>

<!-- of course this field may/should be created with Fluid's viewhelper -->
<select id="mySelectBox" onchange="performAjaxCall(this)">
    <option value="1">Item 1</option>
    <option value="2">Item 2</option>
    <option value="3">Item 3</option>
</select> 
```

在`yourExternal.js`（当然您需要将`tx_yourextkey_yourplugin`前缀更改为您自己的）

```
function performAjaxCall(selectFieldObj) {
    $.ajax({
        url: actionsPathFromViewHelperSetInTheView,
        data:{
            "tx_yourextkey_yourplugin[uid]":selectFieldObj.value
        },
        success:function (data) {
            // do something with your json
            alert('Load was performed.');
        }
    });
} 
```

在您的控制器中：

```
public function ajaxAction() {

    // try to always validate the incoming arguments
    if (!$this->request->hasArgument('uid') || intval($this->request->getArgument('uid')) == 0) {
        header('HTTP/1.1 400 Bad Request');
        return json_encode(array('error'=> 'Bad request'));
    }

    $uid = intval($this->request->getArgument('uid'));

    $dataFromRepo = $this->myRepository->findByUid($uid);
    if ($dataFromRepo == null) {
        header('HTTP/1.1 404 Not found');
        return json_encode(
           array('error'=> 'Not found or you have no access or something else... happens...')
        );
    }
    $resultArray = array(
        "field1" => $dataFromRepo->getField1(),
        // etc...
    );

    return json_encode($resultArray);
} 
```

# javascript - 无法从外部 JS 文件加载 HTML 文件中的键/值对

> ID：10737039
> 
> 赞同：1
> 
> 时间：2012-05-24T11:56:43.290
> 
> 标签：javascript, html

以下是`index.html`文件：

```
<html>

<head>

<script>

function ChangePageLanguage()
{
var e = document.getElementById("langDD");
var lang = e.options[e.selectedIndex].value;

if (lang == "it")
{
    var scrptE = document.createElement("script");
    scrptE.setAttribute("type", "text/javascript");
    scrptE.setAttribute("language", "JavaScript");
    scrptE.setAttribute("src", "language_it.js?" + (Date.now() % 10000));
    var head = document.getElementsByTagName("head")[0];
    head.appendChild(scrptE);

    document.getElementById('p1').innerHTML = obj[key1];
    //document.getElementById('p2').innerHTML = obj[key2];
}
}
</script>
</head>

<body>
<select onchange="ChangePageLanguage()" id="langDD">
    <option value="en">English</option>
    <option value="it">Italian</option>
</select>
<br/>
<span id="p1">
</span>
<br/>
<span id="p2">
</span>

</body>

</html> 
```

我有以下内容`language_it.js`：

```
var obj = {
key1: Il mio nome è Azeem,
key2: Sono uno sviluppatore di Software
}; 
```

当我从下拉菜单中选择意大利语时，它应该`key1`在 id="p1" 的 span 对象中打印值，但它不是...中的键/值对有什么问题`language_it.js`吗？请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:27:45.913

您发布的 Javascript 文件是非法的，因为您没有引用字符串文字。它应该是这样的：

```
var obj = {
  key1: 'Il mio nome è Azeem',
  key2: 'Sono uno sviluppatore di Software'
}; 
```

**更新**

另外，线

```
document.getElementById('p1').innerHTML = obj[key1]; 
```

是错误的，因为`key1`它不是一个变量（就像错误消息所说的那样）。

它应该类似于以下任一变体：

```
document.getElementById('p1').innerHTML = obj.key1;
document.getElementById('p1').innerHTML = obj['key1']; 
```

这两行是等价的。如果这对您来说是新闻，那么我建议您开始阅读适当的 Javascript 教程。[javascript 标记的信息页面](https://stackoverflow.com/tags/javascript/info)是一个很好的起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T12:05:45.680

该脚本将异步加载，因此当您尝试访问它时`obj`它还不可用。尝试使用类似的东西`require.js`或负载处理程序：

```
scrptE.onload = scrptE.onreadystatechange = function() {
    console.log(obj);
}; 
```

是否有任何特定原因要在事件处理程序中异步加载脚本文件？将它包含在加载中并在需要时立即访问似乎更有效。

# database - 如何使用 vbscript 将文件保存到数据库二进制字段

> ID：10737043
> 
> 赞同：0
> 
> 时间：2012-05-24T11:56:55.613
> 
> 标签：database, vbscript, binary

您好，我需要简单的脚本帮助。

如何从文件中读取文件（文件系统上的图像文件）并将其保存到数据库二进制字段（SQL2008 表）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T14:01:25.957

你最好下次发布你的代码。这是一个 INSERT INTO 和 SELECT 语句，我们使用一种特殊形式的 OPENROWSET 函数将图像放入您的表字段

```
'create table first
create table #Images (doclen bigint, doc varbinary(max))

'insert a file
insert into #Images
  select len(bulkcolumn), *
 from
  openrowset(bulk 'C:\images\image1.jpg', SINGLE_BLOB) as r 
```

另请参阅这些答案

```
http://stackoverflow.com/questions/7509384/insert-image-into-sql-server-2008-express-database-without-front-end-application
http://stackoverflow.com/questions/416881/insert-picture-into-sql-server-2005-image-field-using-only-sql
http://stackoverflow.com/questions/2427767/how-to-store-and-retrieve-images-using-sql-server-server-management-studio 
```

# video - 用于马赛克视频输出的命令行视频工具

> ID：10737047
> 
> 赞同：2
> 
> 时间：2012-05-24T11:57:17.220
> 
> 标签：video, command-line, vlc, video-editing, avisynth

我正在寻找一个在linux上运行的命令行视频工具，它是可编写脚本的，它可以提供一个带有马赛克视频的输出视频。问题是，马赛克视频必须在输出内部发生变化。想象一个 4*4 的马赛克视频，但输入视频比 16 多，因此例如每 10 秒我必须将马赛克中的一个图块更改为另一个视频。

我找到了可以生成马赛克输出的命令行 VLC 工具和 avisynth，但正如我所见，它们不支持上述不断变化的视频。

有人知道其他选择吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T01:56:17.180

AviSynth 可以加入视频，因此您可以随时在脚本中更改视频源。

例如，在以下示例中，四个输入的左上角视频将在 6 秒后变为不同的视频：

```
v11 = AviSource("SomeSampleVideo.avi", false). \
  Crop(0, 0, 320, 240).AssumeFPS(25).ConvertToRGB32.Trim(0, 150).FadeOut(25, $FF0000)

v12 = AviSource("AnotherSampleVideo.avi", false). \
  Crop(40, 10, 320, 240).AssumeFPS(25).ConvertToRGB32.FadeIn(25, $FF0000)

v1 = v11 + v12

v2 = ImageReader("SomeSampleBitmap.bmp").Crop(20, 10, 320, 240).ConvertToRGB32
v3 = AviSource("YetAnotherVideo.avi", false).Crop(30, 30, 320, 240).ConvertToRGB32
v4 = v1.Subtract(v2)

return StackVertical(StackHorizontal(v1, v2), StackHorizontal(v3, v4)) 
```

不过，我可能误解了要求..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T13:30:36.023

一种解决方法可能是通过 VLC 生成的 UDP 流运行您的视频，例如：

```
 vlc -vvv $YOUR_INPUT_VIDEO_AS_A_VARIABLE --sout='#transcode{vcodec=h264, vb=768, fps=25.0, width=1920, height=1080, scale=1, acodec=aac, ab=128, samplerate=32000}:standard{access=udp, mux=ts, dst=239.0.0.1}' 
```

然后将此 udp 流包含在您的 VLC 马赛克中，例如：

```
 setup video1 input udp://@239.0.0.1 
```

后来我想您可以编写一个脚本，该脚本使用一个变量作为新视频的路径（$YOUR_INPUT_VIDEO_AS_A_VARIABLE）最终杀死早期的 VLC 实例并使用新视频重新启动它，并将其发送到相同的 udp 地址。在您的情况下，您需要考虑端口，例如将视频 1 发送到 239.0.0.1:1234；视频 2 至 239.0.0.1:1236；视频 3 到 239.0.0.1:1238 - 依此类推。

UDP 不在乎是否没有发送任何内容，所以我猜您将有一小段时间没有播放视频（杀死旧 VLC 实例并流式传输新视频所需的时间）。

同样，这是一种解决方法。所以也许这会有所帮助，否则忘记它。

# c++ - 如何使用 NvAPI_DISP_GetDisplayConfig？

> ID：10737051
> 
> 赞同：1
> 
> 时间：2012-05-24T11:57:27.820
> 
> 标签：c++, nvapi

使用[NVAPI](http://developer.nvidia.com/nvapi)时，我遇到了 NvAPI_DISP_GetDisplayConfig 问题。我在第二次调用 NvAPI_DISP_GetDisplayConfig 时收到 AppCrash。似乎无法弄清楚为什么。

```
NvU32 count = 0;
status = NvAPI_DISP_GetDisplayConfig(&count, NULL);
if (status != NVAPI_OK) 
    PrintError(status);
printf("Configs: %i\n", count);
NV_DISPLAYCONFIG_PATH_INFO *configinfos = new NV_DISPLAYCONFIG_PATH_INFO[count];
configinfos[0].version = NV_DISPLAYCONFIG_PATH_INFO_VER;
status = NvAPI_DISP_GetDisplayConfig(&count, configinfos);
if (status != NVAPI_OK) 
    PrintError(status); 
```

在我的系统上，第一次通话后 count = 2。NvAPI_DISP_GetDisplayConfig 上的注释说：

> NVAPI_INTERFACE NvAPI_DISP_GetDisplayConfig(
> __inout NvU32 * pathInfoCount,
> __out_ecount_full_opt *pathInfoCount NV_DISPLAYCONFIG_PATH_INFO * pathInfo
> )
> 
> 描述：此 API 允许调用者检索当前的全局显示
> 配置。
> 用法：调用者可能必须调用此函数 3 次以获取所有必需的
> 配置详细信息，如下所示：
> 第一遍：调用者应调用 NvAPI_DISP_GetDisplayConfig() 并将 pathInfo 设置
> 为 NULL 以获取 pathInfoCount。 第二遍：根据要获取的 pathInfoCount(from First Pass)
> 的数量为 pathInfo 分配内存//!
> //! 目标信息计数。如果
> 需要 sourceModeInfo 分配内存，或者可以将其初始化为 NULL。
> 第三遍（可选，仅在需要目标信息时才需要）：
> 根据数量为 targetInfo 分配内存
> targetInfoCount（来自第二遍）。支持的操作系统：Windows Vista 及更高版本

谢谢。

编辑：我也尝试将 configinfos[0].sourceModeInfo = NULL 设置为无济于事。我还尝试遍历数组以将所有 .version 和 .sourceModeInfo 设置为无济于事（文档中的一个示例我只看到数组中第一项的设置版本）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T20:12:58.453

这应该适合你：

```
NvAPI_Status status = NVAPI_OK;
NvU32 deviceCount = 0;
NV_DISPLAYCONFIG_PATH_INFO_V2 *  pathInfo = NULL;

status = NvAPI_Initialize();
if (status == NVAPI_OK) {
    status = NvAPI_DISP_GetDisplayConfig(&deviceCount, pathInfo);
    if ((status == NVAPI_OK) && (deviceCount > 0)) {
        pathInfo = new NV_DISPLAYCONFIG_PATH_INFO_V2[deviceCount];
        for (int i = 0; i < deviceCount; i++)
        {
            pathInfo[i].targetInfo = 0;
            pathInfo[i].targetInfoCount = 0;
            pathInfo[i].version = NV_DISPLAYCONFIG_PATH_INFO_VER2;
            pathInfo[i].sourceModeInfo = 0;
            pathInfo[i].reserved = 0;
        }

        status = NvAPI_DISP_GetDisplayConfig(&deviceCount, pathInfo);

        if (status == NVAPI_OK) {
            for (int i = 0; i < deviceCount; i++)
            {
                pathInfo[i].sourceModeInfo = new NV_DISPLAYCONFIG_SOURCE_MODE_INFO_V1;
                pathInfo[i].sourceModeInfo->reserved = 0;
                pathInfo[i].targetInfo = new NV_DISPLAYCONFIG_PATH_TARGET_INFO_V2[pathInfo[i].targetInfoCount];
                for (int j = 0; j < pathInfo[i].targetInfoCount; j++) {
                    pathInfo[i].targetInfo[j].details = 0;
                }
            }
        }

        status = NvAPI_DISP_GetDisplayConfig(&deviceCount, pathInfo);

        for (int i = 0; i < deviceCount; i++)
        {
            if (pathInfo[i].sourceModeInfo) delete pathInfo[i].sourceModeInfo;
            if (pathInfo[i].targetInfo) delete [] pathInfo[i].targetInfo;
        }
        delete[] pathInfo;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T19:03:17.023

马科斯的回答更彻底。我相信您的代码中的具体问题是您没有初始化第二个 pathInfo。所以你需要添加：

```
configinfos[1].version = NV_DISPLAYCONFIG_PATH_INFO_VER; 
```

总是初始化你的记忆也是一种很好的形式。因此，分配后您应该立即执行以下操作：

```
memset(configinfos, 0, sizeof(NV_DISPLAYCONFIG_PATH_INFO) * count); 
```

或者您可以单独设置这些值。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-08-14T07:22:18.083

NvAPI 附带的示例代码中有一个名为 DisplayConfiguration 的示例，它完全利用了 GetDisplayConfig。从 DisplayConfiguration.cpp 复制粘贴函数：

```
NvAPI_Status AllocateAndGetDisplayConfig(NvU32* pathInfoCount, NV_DISPLAYCONFIG_PATH_INFO** pPathInfo)
{
    NvAPI_Status ret;

    // Retrieve the display path information
    NvU32 pathCount                         = 0;
    NV_DISPLAYCONFIG_PATH_INFO *pathInfo    = NULL;

    ret = NvAPI_DISP_GetDisplayConfig(&pathCount, NULL);
    if (ret != NVAPI_OK)    return ret;

    pathInfo = (NV_DISPLAYCONFIG_PATH_INFO*) malloc(pathCount * sizeof(NV_DISPLAYCONFIG_PATH_INFO));
    if (!pathInfo)
    {
        return NVAPI_OUT_OF_MEMORY;
    }

    memset(pathInfo, 0, pathCount * sizeof(NV_DISPLAYCONFIG_PATH_INFO));
    for (NvU32 i = 0; i < pathCount; i++)
    {
        pathInfo[i].version = NV_DISPLAYCONFIG_PATH_INFO_VER;
    }

    // Retrieve the targetInfo counts
    ret = NvAPI_DISP_GetDisplayConfig(&pathCount, pathInfo);
    if (ret != NVAPI_OK)
    {
        return ret;
    }

    for (NvU32 i = 0; i < pathCount; i++)
    {
        // Allocate the source mode info
        pathInfo[i].sourceModeInfo = (NV_DISPLAYCONFIG_SOURCE_MODE_INFO*) malloc(sizeof(NV_DISPLAYCONFIG_SOURCE_MODE_INFO));
        if (pathInfo[i].sourceModeInfo == NULL)
        {
            return NVAPI_OUT_OF_MEMORY;
        }
        memset(pathInfo[i].sourceModeInfo, 0, sizeof(NV_DISPLAYCONFIG_SOURCE_MODE_INFO));

        // Allocate the target array
        pathInfo[i].targetInfo = (NV_DISPLAYCONFIG_PATH_TARGET_INFO*) malloc(pathInfo[i].targetInfoCount * sizeof(NV_DISPLAYCONFIG_PATH_TARGET_INFO));
        if (pathInfo[i].targetInfo == NULL)
        {
            return NVAPI_OUT_OF_MEMORY;
        }
        // Allocate the target details
        memset(pathInfo[i].targetInfo, 0, pathInfo[i].targetInfoCount * sizeof(NV_DISPLAYCONFIG_PATH_TARGET_INFO));
        for (NvU32 j = 0 ; j < pathInfo[i].targetInfoCount ; j++)
        {
            pathInfo[i].targetInfo[j].details = (NV_DISPLAYCONFIG_PATH_ADVANCED_TARGET_INFO*) malloc(sizeof(NV_DISPLAYCONFIG_PATH_ADVANCED_TARGET_INFO));    
            memset(pathInfo[i].targetInfo[j].details, 0, sizeof(NV_DISPLAYCONFIG_PATH_ADVANCED_TARGET_INFO));
            pathInfo[i].targetInfo[j].details->version = NV_DISPLAYCONFIG_PATH_ADVANCED_TARGET_INFO_VER;
        }
    }

    // Retrieve the full path info
    ret = NvAPI_DISP_GetDisplayConfig(&pathCount, pathInfo);
    if (ret != NVAPI_OK)    
    {
        return ret;
    }

    *pathInfoCount = pathCount;
    *pPathInfo = pathInfo;
    return NVAPI_OK;
} 
```

现在这个函数可以很容易地使用：

```
NV_DISPLAYCONFIG_PATH_INFO *pathInfo = NULL;
NvU32 pathCount = 0;
_allocateAndGetDisplayConfig(&pathCount, &pathInfo);
// Do whatever you need with the queried display data here 
```

# mysql - 无法在eclipse中创建jpa表

> ID：10737053
> 
> 赞同：3
> 
> 时间：2012-05-24T11:57:38.407
> 
> 标签：mysql, eclipse, jpa, eclipselink

我在 Eclipse 中有一个工作项目，它创建了一个从实体到 mysql 数据库的 JPA 表（仍在学习）。不幸的是，它在错误的数据库中创建了表，因为我希望有“测试”和“生产”数据库。不知何故，它获得了“生产”数据库的详细信息，即使看起来所选的数据库连接是用于测试的。我稍微篡改了项目并使其与正确的连接对象连接以进行某些（测试）。我可以在 Eclipse 中 ping 数据库（两个数据库）并在数据源资源管理器中查看数据库。但是现在我无法通过右键单击项目并选择“JPA 工具”>“从实体生成表”来为项目创建表。创建开始和结束都没有错误，就像一切正常一样，但我在两个数据库中都看不到表。（在 Eclipse 数据库资源管理器中或从命令行）。persistence.xml 应该没问题，因为它之前已经创建了一个表。

唯一的错误是实体类，因为它对实体注释“无法解析表 xxx”说。正如我所看到的，它来自未创建的表。

这是persistence.xml，以防万一。 [http://pastebin.com/djPZei90](http://pastebin.com/djPZei90)

该项目也是一个 Maven 项目，它使用 SVN。Maven 为 Eclipse/项目成功加载了依赖项，并且 SVN 没有任何复杂性。

由于 Maven，有 2 个 persistence.xml 文件（仅登录凭据和数据库名称更改），用于生产和测试。可能是在第一个位置检查并从错误的文件加载了 db-connection。（只是猜测）

我还尝试在生成表时创建 script.sql。我找到了该文件，但它完全是空的。

无论如何，问题是现在我无法在任何地方创建表格。我对此完全感到困惑。任何提示我应该在哪里解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T08:09:35.190

克里斯说得对，即使我在第一次阅读时没有正确理解答案。我尝试使用其他提供商，但我可能不小心修改了错误的文件（2 'persistence.xml' 文件，因为它是一个 maven 项目），或者可能有其他一些我没有发现的原因。我之前得到了一个提示，我应该使用给定的提供程序（在 persitence.xml 中）。因为我毕竟没有太在意它。由于使用 eclipselink，提供者必须是：

```
 <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider> 
```

再次感谢克里斯，即使我在第一次尝试时失败了，不得不再花几个小时来解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T07:47:32.817

你能解决问题吗？不幸的是，我偶然发现了同样罕见的问题，这完全没有意义。无论出于何种原因，JPA 工具都不会添加映射类，尽管它会将它们写入persistence.xml。

前一周一切都完美无缺，但现在一切都 f* ***。我什至在不同的工作区创建了一个新的独立项目，但它发生了同样的错误。显然这是一个eclipse/plugin bug，否则我无法解释。使用 Eclipse 4.2.0。我不高兴。

编辑：删除 Dali Tools、JPA Configurator、Seam 3 Plugin 创建实体后似乎又可以工作了。不知道为什么，很可能是冲突，但它仍然无法解释为什么它现在而不是 1 个月前发生。从那以后我根本没有改变我的eclipse安装......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T11:52:52.947

花一整天的时间在这上面。

我在 Eclipse (Indigo btw) 中创建了一个全新的 (JPA) 项目。还为此创建了一个新数据库（mysql）。

为此在 Eclipse 中建立了连接。文件 > 新建 > 其他... > 连接配置文件。

制作了一个新的包结构，让 Eclipse 创建“persistence.xml”（src/META-INF/persistence.xml）。

我用 Eclipse 向导创建了一个“JPA 实体”类。（添加了“id”（PK）和“内容”字段）将“pom.xml”从我以前的项目复制到新项目（仅对项目名称进行了微小的更改）。

还从上一个项目中复制了“persistence.xml”文件（src/main/java/META-INF/，不包括“测试”）。更改了持久性文件中的数据库详细信息和登录凭据。

在 Eclipse 中创建项目“Maven 项目”（右键单击项目名称 > 配置）因为它现在是一个 Maven 项目，所以可以删除默认的“persistence.xml”，因为它位于错误的位置。（Mavenizing项目使用pom.xml从不存在的jar中删除了所有错误）

尝试为项目再次创建表（同样的错误，但请稍等......）。

右键单击项目 > Maven > 禁用 Maven 自然

然后再次使它成为maven项目，右键单击项目>配置> ...

尝试再次创建表并创建它们。一切正常！

去搞清楚！

似乎一切都很好，就像我怀疑的那样。maven（插件）+ eclipse似乎存在某种错误。

对上一个项目执行相同的技巧将无济于事。我什至用向导创建了实体类（删除了现有的）。<class> 声明被添加到'persistence.xml'，但它仍然不会做表。（还尝试删除并重新添加 Maven 性质）

我可能在这个过程中遗漏了一些东西/做了不同的事情，或者一起做错了。但是考虑到我得到了另一个项目的工作，而其他的没有，使用相同的技巧，似乎有一个大的讨厌的错误。

# java - 使用空布局将 JPanel 添加到 JApplet

> ID：10737054
> 
> 赞同：4
> 
> 时间：2012-05-24T11:57:45.880
> 
> 标签：java, swing

我想在我拥有的 JApplet 中添加 4 个 JPanel，并为每个 JPanel 赋予不同的颜色。但是没有显示任何颜色 - 我的意思是我看不到输出。完全没有颜色。以下代码在`init()`方法中。

```
 this.setSize(1400, 780);
      this.setVisible(true);
      this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      this.setLocationRelativeTo(null);
  this.setLayout(null) ; 

      setLayout(null) ; 

  Panel1 = new JPanel() ;
  Panel2 = new JPanel () ; 
  Panel3 = new JPanel() ; 
  Panel4 = new JPanel() ; 

  Label1 = new JLabel ("Label1") ; 
  Label2 = new JLabel ("Label2") ; 
  Label3 = new JLabel ("Label3") ; 
  Label4 = new JLabel ("Label4") ; 

  Panel1.add(Label1) ; 
  Panel2.add(Label2) ; 
  Panel3.add(Label3) ; 
  Panel4.add(Label4) ; 

  // Panel 1 "About Me"
  Panel1.setSize(140,390) ; 
  Panel1.setLocation(0,0) ; 
  Panel1.setBackground(Color.red) ; 
  Panel1.setVisible(true) ; 
  this.add(Panel1) ; 

  // Panel 2 "MyHoppies" 
  Panel2.setSize(140,390) ; 
  Panel2.setLocation(0,700) ; 
  Panel2.setBackground(Color.yellow) ;
  this.add(Panel2) ; 

  // Panel 3 "Photo Gallery"
  Panel3.setSize(140,390) ; 
  Panel3.setLocation(390,0) ; 
  Panel3.setBackground(Color.black) ;
  this.add(Panel3) ;

  // Panel 4 "Happey face" 
  Panel4.setSize(140,390) ;
  Panel4.setLocation(390,700) ; 
  Panel4.setBackground(Color.pink) ; 
  this.add(Panel4) ; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T13:02:48.407

*   `this.setVisible(true)`必须是 GUI 构造函数中的最后一行代码

*   正确使用[Using Java Naming Conventions](http://java.about.com/od/javasyntax/a/nameconventions.htm)`Panel1`应该是`panel1`ei

*   不要扩展`JFrame`or `JApplet`，使用与 for 相同的方式将其创建为局部变量`Panel1`

*   不要使用`NullLayout`，使用适当的`LayoutManager`，在这种情况下`GridLayout`可能，否则`JFrames`内容不可调整大小`JFrame`

![在此处输入图像描述](../Images/cbaa5b6a379786e32d4dd0ead28cfb87.png)

代码

```
import java.awt.*;
import javax.swing.*;

public class ColorongPanels {

    private JFrame frame = new JFrame("ColorongPanels");
    private JPanel panel1 = new JPanel();
    private JPanel panel2 = new JPanel();
    private JPanel panel3 = new JPanel();
    private JPanel panel4 = new JPanel();
    private JLabel label1 = new JLabel("Label1");
    private JLabel label2 = new JLabel("Label2");
    private JLabel label3 = new JLabel("Label3");
    private JLabel label4 = new JLabel("Label4");

    public ColorongPanels() {
        frame.setLayout(new GridLayout(2, 2, 5, 5));
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        panel1.setBackground(Color.red);
        panel1.setLayout(new BorderLayout());
        panel1.add(label1, BorderLayout.CENTER);
        panel2.setBackground(Color.yellow);
        panel2.setLayout(new BorderLayout());
        panel2.add(label2, BorderLayout.CENTER);
        panel3.setBackground(Color.black);
        panel3.setLayout(new BorderLayout());
        panel3.add(label3, BorderLayout.CENTER);
        panel4.setBackground(Color.pink);
        panel4.setLayout(new BorderLayout());
        panel4.add(label4, BorderLayout.CENTER);
        frame.add(panel1);
        frame.add(panel2);
        frame.add(panel3);
        frame.add(panel4);
        frame.setLocationRelativeTo(null);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new ColorongPanels();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T12:08:11.747

你应该这样做：
`panelx.setOpaque(true)`它应该工作

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T12:45:03.273

首先：您需要`JPanel.setOpaque(true)`面板才能看到背景颜色。

第二：背景颜色属性在不同平台上效果不同。例如：如果你设置了一个 JButton 的背景，你会在 Win7 中看到按钮颜色，但在 WinXP 中没有（不确定，在其他操作系统下如何）。这至少是我的经验...

# android - 如何以编程方式将文件从 PC 发送到 Android 设备

> ID：10737067
> 
> 赞同：0
> 
> 时间：2012-05-24T11:58:46.630
> 
> 标签：android, file-io

对于我的应用程序，我需要以编程方式将文档从 PC 发送到 Android 设备。我搜索了一些论坛，但找不到任何示例。

任何人都可以帮助我提供示例代码。提前致谢。

问候， 史密斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T14:56:10.690

您可以只使用套接字连接。pc 将是您的服务器，android 应用程序将是您的客户端。通过这种方式，您可以将数据（包括我认为的文档）从您的移动设备发送到您的电脑，反之亦然。

# c# - 得到sql错误：字符串'904LPUH000614'后的未闭合引号

> ID：10737069
> 
> 赞同：-1
> 
> 时间：2012-05-24T11:58:54.413
> 
> 标签：c#

```
public partial class HardwareInformation : BaseForm
{
    string sWhere = "";
    public HardwareInformation()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        SqlConnection objConn1 = new SqlConnection("Data Source=192.168.0.203;Initial Catalog=costing;User ID=sa;Password=Spareage@123");
        if ( searchtextbox.Text.Trim() != "" )
        {
            sWhere = "Where  Srno  '" + searchtextbox.Text;      
        }

        SqlDataAdapter objAdapter = new SqlDataAdapter(@"Select distinct [Srno] ,[Employee Name] ,  [Department] ,  [Thin Client] , [Desktop] , [Lcd] , [Moniter] , [Printer] , [Ups]   from  [dbo].[HardwareDetail] " + sWhere + "", objConn1);
        DataTable objTable = new DataTable();
        objAdapter.Fill(objTable);
        dataGridView1.DataSource = objTable;
        dataGridView1.Columns[0].Width = 25;
        for (int i = 1; i < dataGridView1.Columns.Count; i++)
        {
            dataGridView1.Columns[i].ReadOnly = true;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:02:24.587

利用

```
"Where Srno = '" + searchtextbox.Text + "'"; 
```

您忘记了在 TextBox 文本之后`=`签名`Srno`和关闭单引号。

在创建 SqlDataAdapter 的行中，最后一次使用

```
 "[Ups] from [dbo].[HardwareDetail] " + sWhere, objConn1); 
```

顺便说一句，请注意**SQLInjection。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:04:41.887

文本框文本后缺少一个 = 符号和一个结束引号。因此应该是

```
"Where  Srno = '" + searchtextbox.Text +"'"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T12:20:00.947

您的代码容易受到[SQL 注入攻击](http://en.wikipedia.org/wiki/SQL_injection)。你不应该在**没有**清理的情况下将用户输入直接插入到你的 SQL 中。您确实需要更改为参数化查询：

```
SqlDataAdapter objAdapter = new SqlDataAdapter(@"Select distinct [Srno] ,[Employee Name] ,  [Department] ,  [Thin Client] , [Desktop] , [Lcd] , [Moniter] , [Printer] , [Ups]   from  [dbo].[HardwareDetail] WHERE Srno = @srno", objConn1);

// Change the length and dbtype to match your needs
objAdapter.Parameters.Add("@srno", SqlDbType.NChar, 15, searchtextbox.Text);

DataTable objTable = new DataTable();
objAdapter.Fill(objTable); 
```

这使您免受注入漏洞的影响，并且无需转义引号和其他特殊字符。

# python - 可以标记维基百科页面的 Python 库

> ID：10737071
> 
> 赞同：2
> 
> 时间：2012-05-24T11:59:00.980
> 
> 标签：python, web-scraping, wikipedia

我想用一个或多个 python 库标记出感兴趣的维基百科页面。我对表格和列表最感兴趣。然后我希望能够将这些数据导入 Postgres 或 Neo4j。

例如，以下是我感兴趣的三个数据集：

*   每个国家在 2008 年欧洲歌唱大赛中互相奖励了多少分： [http ://en.wikipedia.org/wiki/Eurovision_Song_Contest_2008#Final](http://en.wikipedia.org/wiki/Eurovision_Song_Contest_2008#Final)
*   货币列表及其流通国家（多对多关系）： [http ://en.wikipedia.org/wiki/List_of_circulating_currencies](http://en.wikipedia.org/wiki/List_of_circulating_currencies)
*   世界各地的太阳能发电厂列表：[http ://en.wikipedia.org/wiki/List_of_solar_thermal_power_stations](http://en.wikipedia.org/wiki/List_of_solar_thermal_power_stations)

其中每一个的来源都是用维基百科的标记品牌编写的，用于将它们呈现出来。原始数据表单中使用了许多特定于维基百科的标签和语法。HTML 可能几乎是更简单的解决方案，因为我可以使用 BeautifulSoup。

有人知道更好的标记方法吗？如果我采用最终的 HTML 并用 BeautifulSoup 解析它，我觉得我会重新发明轮子。此外，如果我能找到一种以 XML 格式输出这些页面的方法，则表数据可能没有被充分标记化，并且需要进一步处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:14:01.940

这更多地涉及语义网络方向，但[DBPedia](https://www.dbpedia.org/)允许使用 SPARQL 查询维基百科数据的部分（社区转换工作）。这使得提取所需数据在理论上很简单，但是处理 RDF 三元组可能很麻烦。

此外，我不知道 DBPedia 是否包含您感兴趣的任何数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T12:05:17.020

由于 Wikipedia 建立在 MediWiki 之上，因此您可以利用一个[api 。](http://en.wikipedia.org/w/api.php)您还可以使用[Special:Export 。](http://www.mediawiki.org/wiki/Manual%3aParameters_to_Special%3aExport)

一旦你有了原始数据，你就可以通过[mwlib](http://mwlib.readthedocs.org/en/latest/index.html)运行它来解析它。

# android - Osmdroid。onItemSingleTapUp 不适用于自定义 Drawable

> ID：10737078
> 
> 赞同：5
> 
> 时间：2012-05-24T11:59:23.600
> 
> 标签：android, customization, osmdroid

我创建了使用画布绘制边界的自定义可绘制标记。一切都很好，除了一件事：当屏幕上的任何标记被录音时，不会调用 onItemSingleTapUp。这是覆盖创建代码：

```
ItemizedIconOverlay<OverlayItem> groupsOverlay = new ItemizedIconOverlay<OverlayItem>(
    new ArrayList<OverlayItem>(),
    new OnItemGestureListener<OverlayItem>() {

        @Override
        public boolean onItemLongPress(int arg0, OverlayItem arg1) {                                
            return false;
        }

        @Override
        public boolean onItemSingleTapUp(int arg0, OverlayItem arg1) {

            if(arg1 == null){
                return false;
            }

            if(m_prevView != null){
                m_mapView.removeView(m_prevView);
                m_prevView = null;
            }

            View popUp = getLayoutInflater().inflate(R.layout.map_popup, m_mapView, false);
            TextView tv = (TextView)popUp.findViewById(R.id.popupTextView);
            tv.setText(arg1.getTitle());

            MapView.LayoutParams mapParams = new MapView.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, 
        ViewGroup.LayoutParams.WRAP_CONTENT,
        arg1.getPoint(),
        MapView.LayoutParams.BOTTOM_CENTER, 0, 0);
            m_mapView.addView(popUp, mapParams);
            m_prevView = popUp;

            return true;
        }
    }, new DefaultResourceProxyImpl(getApplicationContext())); 
```

这是自定义可绘制标记：

```
package com.testapp.data; 
import android.graphics.Canvas; 
import android.graphics.ColorFilter; 
import android.graphics.Paint; 
import android.graphics.Paint.Align; 
import android.graphics.Paint.Style; 
import android.graphics.PixelFormat; 
import android.graphics.Rect; 
import android.graphics.RectF; 
import android.graphics.drawable.Drawable; 
public class GroupMarkerDrawable extends Drawable { 
        private final static int DELTA_BOX = 4; 
        private final Paint m_paint; 
        private String m_text; 
        private double m_pxRadius; 
        public GroupMarkerDrawable(double pxRadius, String text) { 
                m_text = text; 
                m_paint = new Paint(); 
                m_pxRadius = pxRadius; 
                m_paint.setAntiAlias(true); 
        } 
        @Override 
    public void draw(Canvas c) { 
                // Set the correct values in the Paint 
        m_paint.setARGB(190, 0, 0, 0); 
        m_paint.setStrokeWidth(2); 
        m_paint.setStyle(Style.STROKE); 
        m_paint.setTextAlign(Align.CENTER); 
        Rect bounds = new Rect(); 
        m_paint.getTextBounds(m_text, 0, m_text.length(), bounds); 
        int centerX = getBounds().centerX(); 
        int centerY = getBounds().centerY(); 
        int w2 = bounds.width() / 2; 
        int h2 = bounds.height() / 2; 
        Rect rect = new Rect(centerX - w2 - DELTA_BOX, centerY - h2 - 
DELTA_BOX, centerX + w2 + DELTA_BOX, centerY + h2 + DELTA_BOX); 
        // Draw it 
        c.drawCircle(centerX, centerY, (float) m_pxRadius, m_paint); 
        m_paint.setStyle(Style.FILL); 
        m_paint.setARGB(190, 0, 128, 0); 
        c.drawRect(rect, m_paint); 
        m_paint.setStyle(Style.STROKE); 
        m_paint.setARGB(190, 0, 0, 0); 
        c.drawRect(rect, m_paint); 
        c.drawText(m_text, centerX, centerY + h2, m_paint); 
    } 
        @Override 
        public int getOpacity() { 
                return PixelFormat.OPAQUE; 
        } 
        @Override 
        public void setAlpha(int arg0) { 
        } 
        @Override 
        public void setColorFilter(ColorFilter arg0) { 
        } 
} 
```

使用资源中的静态可绘制对象而不是 GroupMarkerDrawable 的相同代码有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T10:58:48.753

我找到了解决这个问题的方法。只需要为 Drawable 返回正确的尺寸。这需要重写 GroupMarkerDrawable 中的两个方法。例如像这样：

```
@Override
public int getIntrinsicHeight() {
    return m_pxRadius * 2;
};

@Override
public int getIntrinsicWidth() {
    return m_pxRadius * 2;
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T09:48:45.497

多边形的附加解决方案。ydanila 的解决方案让我走上了正轨，但我必须重写 ItemizedOverlayWithFocus 类的 hitTest 方法才能获得我的多边形命中。

可绘制：

```
Drawable drawable = new Drawable() {

  private int mIntrinsicHeight = 0;
  private int mIntrinsicWidth = 0;

  @Override
  public void draw(Canvas canvas) {
    // used to determine limit coordinates of the drawable
    int yTop, yBottom, xLeft, xRight;

    if (points != null && points.size() > 1) {
      //we have to make a projection to convert from postions on the map in 
      //gradiant to a position on the view in pixels
      final Projection pj = mapView.getProjection();
      Path path = new Path();
      Point centerMapPixelPoint = new Point();
      Point tmpMapPixelPoint = new Point();

      pj.toMapPixels(points.get(0), centerMapPixelPoint);
      // init limit coordinates
      xLeft = centerMapPixelPoint.x;
      xRight = centerMapPixelPoint.x;
      yTop = centerMapPixelPoint.y;
      yBottom = centerMapPixelPoint.y;
      path.moveTo(centerMapPixelPoint.x, centerMapPixelPoint.y);
      for (int i = 1; i < points.size(); i++) {
        pj.toMapPixels(points.get(i), tmpMapPixelPoint);
        // update limit coordinates if necessary
        if (xLeft > tmpMapPixelPoint.x) {
          xLeft = tmpMapPixelPoint.x;
        }
        if (xRight < tmpMapPixelPoint.x) {
          xRight = tmpMapPixelPoint.x;
        }
        if (yBottom < tmpMapPixelPoint.y) {
          yBottom = tmpMapPixelPoint.y;
        }
        if (yTop > tmpMapPixelPoint.y) {
          yTop = tmpMapPixelPoint.y;
        }
        path.lineTo(tmpMapPixelPoint.x, tmpMapPixelPoint.y);
      }
      // close polygon returning to first point
      path.close();

      canvas.drawPath(path, linePaint);
      canvas.drawPath(path, innerPaint);
      // calculate drawable height and width
      mIntrinsicHeight = yTop -yBottom;
      mIntrinsicWidth = xRight - xLeft;
    }
  }

  @Override
  public int getIntrinsicHeight() {
    return mIntrinsicHeight;
  };

  @Override
  public int getIntrinsicWidth() {
    return mIntrinsicWidth;
  };

}; 
```

覆盖：

```
public class MyItemizedIconOverlay<Item extends OverlayItem> extends ItemizedOverlayWithFocus<Item> {

  @Override
  protected boolean hitTest(Item item, Drawable marker, int hitX, int hitY) {
    boolean hit = false;

    Rect bounds = marker.getBounds();
    if (hitX < bounds.right && hitX > bounds.left && hitY < bounds.top && hitY > bounds.bottom) {
      hit = true;
    } else {
      hit = false;
    }

    return hit;
  }; 
```

# c# - Windows Phone 7 GIF to Png

> ID：10737079
> 
> 赞同：0
> 
> 时间：2012-05-24T11:59:24.543
> 
> 标签：c#, silverlight, windows-phone-7, formatting, gif

我正在构建一个 Rss 阅读器应用程序并遇到 gif 问题。

有谁知道如何构建 ImageConverter 类，以便将 gif 转换为 png？在代码中转换 gif 也对我有用。我的应用程序的工作方式是从提要中获取所有内容，首先将其放入 list() 中，然后填充列表框（以用户选择的方式）。GIF 留下空白图像 :(

所以基本上转换器必须使用链接，而不是直接数据流。

我将添加一些关于我的数据如何更新的代码：

```
ObservableCollection<FeedItem> slika0; //where the feeditems from the selected category go 

    public ObservableCollection<FeedItem> Slika0
    {
        get { return slika0; }
        set
        {
            slika0 = value;
            OnPropertyChanged("Slika0");
        }
    }

    int broj_elemenata = 0;
    bool nema_elemenata = false;
    private void UpdateFeedList(string feedXML)
    {
        StringReader stringReader = new StringReader(feedXML);
        XmlReader xmlReader = XmlReader.Create(stringReader);
        SyndicationFeed feed = SyndicationFeed.Load(xmlReader);

        List<string> kategorije = new List<string>();
        foreach (SyndicationItem sitem in feed.Items)
        {
            foreach (SyndicationCategory sc in feed.Categories)
            {
                if (!kategorije.Contains(sc.Name))
                {
                    kategorije.Add(sc.Name);
                }
            }
        }

        FeedItem FeedItem = new FeedItem();
        Slika0 = new ObservableCollection<FeedItem>();
        //SyndicationCategory tražena_kat = new SyndicationCategory("Trendy");

        foreach (SyndicationItem item in feed.Items)
        {
            foreach (SyndicationCategory sc in item.Categories)
            {
                FeedItem.Content_List.Add(sc.Name);

                foreach (SyndicationElementExtension ext in item.ElementExtensions)
                {
                    XElement ele = ext.GetObject<XElement>();

                    if (ele.Name.LocalName == "encoded" && ele.Name.Namespace.ToString().Contains("content"))
                    {
                        FeedItem.Content_List.Add(item.Title.Text);
                        FeedItem.Content_List.Add(ele.Value);//takes the content of the feed
                    }
                }

                foreach (SyndicationLink link in item.Links)
                {

                    FeedItem.Content_List.Add(link.Uri.AbsoluteUri); //takes the links for  browsing and the image 

                }
            }
        }
        IsolatedStorageSettings.ApplicationSettings["ContentList"] = FeedItem.Content_List;

        Deployment.Current.Dispatcher.BeginInvoke(() =>
        {

            int i;
            int x = 0;

            Slika0.Clear();
            foreach (var item in FeedItem.Content_List)
            {
                i = FeedItem.Content_List.IndexOf(item, x); //x = index of category in the list

                if (item == "Trendy")
                {
                    FeedItem FF = new FeedItem();
                    FF.Post_text = FeedItem.Content_List[i + 1];//title of article
                    FF.Content_link = FeedItem.Content_List[i + 2];//content
                    FF.Post_link = FeedItem.Content_List[i + 3];//the location of link for browsing
                    FF.Post_slika = FeedItem.Content_List[i + 4]; //location of image link

                    if (FF.Post_slika == "") //if there is no link for picture code is executed
                    {
                        FF.Post_slika = "Slike/zimo_veliki_tile.png";
                    }

                    Slika0.Add(FF);
                    this.lsSlika_P.ItemsSource = Slika0; //take

                    x = i + 5;
                    broj_elemenata++;
                }
            }

            if (lsSlika_P.Items.Count <= 3)
            {
                scroll_panorama.VerticalScrollBarVisibility = ScrollBarVisibility.Disabled;
            }

            if (lsSlika_P.Items.Count == 0)
            {
                nema_elemenata = true;
            }
            else nema_elemenata = false;

        });
        pan_progres.Visibility = Visibility.Collapsed;//progress bar
    } 
```

# mysql - 调试子选择/左连接？

> ID：10737080
> 
> 赞同：1
> 
> 时间：2012-05-24T11:59:34.643
> 
> 标签：mysql, left-join, subquery

我正在处理 mySQL 上的这个查询——它似乎是在一个网站上处理的，其中 PEAR 和 MDB2 在运行的服务器上（不知道为什么......我自己不要这样做）。在我的本地测试系统上，它总是生成 MDB2 错误。PHPmyadmin 也不执行此查询。之所以需要子选择，是因为在此查询中不仅有一个，而是四个子选择。

```
SELECT * FROM table1 
WHERE table1.orderID 
    IN 
        (
        SELECT * 
            FROM table1 
        LEFT JOIN table2
            ON (table1.customID = table2.customID) 
        WHERE table1.active=1
        ) 
```

我可以像这样简化它（有效）：

```
SELECT * FROM table1 
WHERE table1.orderID 
    IN (1,2,3) 
```

子选择也有效：

```
SELECT * 
    FROM table1 
LEFT JOIN table2
    ON (table1.customID = table2.customID) 
WHERE table1.active=1 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:00:43.387

内部查询应该只返回一列，例如：

```
SELECT  *
FROM    table1 
WHERE   table1.orderID IN 
        (
        SELECT  orderId

--              ^^ here

        FROM    table1 
        LEFT JOIN
                table2
        ON      table1.customID = table2.customID
        WHERE   table1.active=1
        ) 
```

# javascript - 如何从html表格中的多个单元格中获取复选框？

> ID：10737082
> 
> 赞同：0
> 
> 时间：2012-05-24T11:59:38.860
> 
> 标签：javascript, asp.net, vb.net

我有动态 html 表格，每个单元格都有一个复选框。如果用户从不同行的多个复选框中进行选择，我想获得选中的复选框。

```
function GetAllChecked() {
             var chkedshid = new Array();
             var rows = new Array();
             rows = document.getElementById("Tbl_Id").getElementsByTagName("tr");
             trcount = rows.length;

             for (var i = 0; i < rows.length; i++) {
                 trid = rows[i].id;
                 chkedshid = chkedshid + chkedshid
                 if (inputList = document.getElementById(trid).getElementsByTagName("input")) {
                     for (var n = 0; n < inputList.length; n++) {
                         if (inputList[n].type == "checkbox") {
                             if (inputList[n].checked == true) {
                                 chkedshid[n] = inputList[n].id;

                             }
                         }
                     }
                 }
  }
             document.getElementById('Hidden_CellSelected').value = chkedshid.join();
             document.getElementById("BtnSav2Cart").click();
         } 
```

为什么这个函数只返回循环中最后一行的最后一个选中的复选框？？？？我需要所有行的所有选中复选框！！！！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:04:01.787

假设您使用的是 jQuery。

然后你可以简单地做 -

```
$("#myTableId input:checked") 
```

如果你的复选框有特定的类，那么你也可以这样做 -

```
$("#myTableId .specificCheckboxClass:checked") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:08:31.667

在某些按钮上单击尝试执行此代码

var checkedTransactions = $("input:[name=' **idofcheckboxe** ']:checked").map(function () { return $(this).val(); }).get();

*var 将返回选中的复选框的所有 id*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T11:48:51.627

谢谢大家解决问题：

```
 function GetAllChecked() {
             var chkedshid = new Array();
             var rows = new Array();
             rows = document.getElementById("Tbl_Id").getElementsByTagName("tr");
             trcount = rows.length;

                  var totlchk = new Array();    
             for (var i = 0; i < rows.length; i++) {
                 trid = rows[i].id;

                 if (inputList = document.getElementById(trid).getElementsByTagName("input")) {
                     for (var n = 0; n < inputList.length; n++) {
                         if (inputList[n].type == "checkbox") {
                             if (inputList[n].checked == true) {
                                 chkedshid[n] = inputList[n].id;
                             }
                         }
                     }
                     totlchk = totlchk.concat(chkedshid.join());
                 }

             }

             document.getElementById('myHiddenfield').value = totlchk.join();
             document.getElementById("BtnSav2Cart").click();
         } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-13T20:54:21.987

```
var table = document.getElementById("mytable");
checkbox = table.getElementsByTagName("input"); 

for(var indexCheckbox = 1; indexCheckbox<checkbox.length; indexCheckbox++){
    if(checkbox[indexCheckbox].checked){

        //do something
    }   
} 
```

# c# - 从列中删除 xml 标签

> ID：10737083
> 
> 赞同：1
> 
> 时间：2012-05-24T11:59:40.017
> 
> 标签：c#, sql-server, xml

我有一些 xml 数据以下列格式存储在数据库（sqlserver）中：例如。电子邮件保存如下：

```
<![CDATA[test@test.com]]> 
```

我的要求是在没有 xml 标签的情况下获取上述数据。在sqlserver的查询中是否可能？如果是，请提出您的宝贵建议。我只需要“test@test.com”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:08:47.190

试试这个。

```
declare @S varchar(25) 
set @S = '<![CDATA[test@test.com]]>'

select cast(@S as xml).value('.', 'varchar(25)') 
```

有了一张桌子，它可能看起来像这样。

```
select cast(email as xml).value('.', 'varchar(25)') as email
from YourTable 
```

# model-view-controller - Servlet 模型 2 的误解

> ID：10737091
> 
> 赞同：0
> 
> 时间：2012-05-24T12:00:04.567
> 
> 标签：model-view-controller, design-patterns, jakarta-ee, servlets

再会。在阅读了有关 Model 2 架构的内容后，我对某些观点感到困惑。例如我的控制器 servlet url-pattern 是`'*.perform'`.

1.  如果我的 jsp url 与 servlet url-pattern 不对应，我如何访问数据库并将 bean 放入会话中？
2.  如果我已经完成了动作，为什么还要使用 forward？网址保持不变`'actionName.perform'`
3.  应该如何为servlet设计的应用程序处理每个页面并转发到相应的JSP而不再次处理它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:56:14.337

1.  前端控制器的要点是它拦截所有请求。您永远不应该直接向 JSP 发送请求。总是指向某个`*.perform`URL。您的所有链接和表单都必须指向一个`*.perform`URL。
2.  转发在服务器端将控制权交给另一个资源。一旦控制器 servlet 完成其工作，它会将控制权交给 JSP，JSP 会生成标记。这一切都发生在服务器端，浏览器对此一无所知。URL 保持不变是绝对正常的。
3.  请参阅 1。不过，我不明白您所说的“无需再次处理”是什么意思。

# ipad - 在 ipad 中显示图表、条形图、图形

> ID：10737094
> 
> 赞同：0
> 
> 时间：2012-05-24T12:00:12.327
> 
> 标签：ipad, reporting-services, graph, charts, report

我希望图形、图表、条形图和数据从 SSRS 检索到的报告中显示在我的“ipad”中（我有报告的 URL 链接）。是否可以编写代码并显示？

# actionscript-3 - 从 AS2 迁移到 AS3

> ID：10737096
> 
> 赞同：-1
> 
> 时间：2012-05-24T12:00:22.133
> 
> 标签：actionscript-3, flash, actionscript-2

我想从已经这样做的人那里知道，任何建议和事情我必须特别看看，我看过一些与该主题相关的文章，谷歌搜索等等......

但我想要 stackoverflower x 的建议）

我已经知道 C++ 中的面向对象编程，使用类等，但我不太了解 AS3 包和东西，但我对 AS2 非常熟悉。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T13:22:54.190

1.  放下你所知道的一切，重新开始。AS2 与 AS3 不同。不要试图用 AS3 做 AS2 的事情。
2.  阅读和学习 Adob​​e LiveDocs
3.  了解显示列表的工作原理。
4.  学习 AS3 编码标准，编写干净可读的代码
5.  了解如何使用常用的 actionscript 库、TweenLite、Gaia 框架、RobotLegs、Temple 库、Pure MVC、Away3D、as3corelib 等。
6.  永远不要在 Flash IDE 操作面板中编写代码，有一些非常好的操作脚本编辑器，如 FlashDevelop、FDT、FlashBuilder、IntelliJ。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:50:39.777

我从 AS2 迁移到 AS3 的经历非常顺利，如此顺利，以至于我再也不会回过头来为维护旧的 AS2 代码而烦恼。

首先我会熟悉显示列表，这是一篇好[文章](http://www.adobe.com/devnet/flash/quickstart/display_list_programming_as3.html)。

然后我将了解 AS3 中的新类型，尤其是 Number、int 和 uint 之间的区别，因为您不再需要将所有内容都集中在 Number 中。

对事件系统进行一些阅读，了解如何捕获从其他对象冒出的事件，如何使用捕获并阻止它们进一步传播，以及如何避免对您创建的按钮中的嵌套对象进行不必要的点击。

就像你说你已经知道 OOP，所以我建议尽可能限制时间线代码，将所有内容都写在类中。

XML 是使用 e4x 处理的，这使得 xml 解析变得微不足道，与 AS2 相比，您会发现这很容易使用。

绘图 api 现在包含在可通过许多显示对象访问的图形库中。

了解一个好的框架，强烈推荐[纯MVC AS3](http://trac.puremvc.org/PureMVC_AS3/)

最后是动画 - 当然只能有一个库 - [Greensock TweenMax](http://www.greensock.com/tweenmax/) AS3；)

**编辑 ：**

我四处寻找一些我认为您会感兴趣的资源，这些选择基于我的经验以及我认为的关键研究领域：

[Grant Skinner 对 AS3 的介绍](http://gskinner.com/talks/as3workshop/)- 出色的概述，您可以一次又一次地参考。

[ActionScript 3.0 入门](http://www.senocular.com/flash/tutorials/as3withflashcs3/)- 将 AS3 与 Flash CS3 结合使用的综合方法。

[Senoculars 今日提示](http://www.kirupa.com/forum/showthread.php?223798-ActionScript-3-Tip-of-the-Day)- 因为您已经在 AS2 中编码，所以您应该了解很多这些提示以及它们在 AS3 中的不同之处。

# android - 在 Android 上安装 JAR

> ID：10737097
> 
> 赞同：-1
> 
> 时间：2012-05-24T12:00:33.340
> 
> 标签：android, eclipse

每次我使用**Build Path > Configure Build Path > Add External JAR 添加**资源时， 我的 Android 应用程序都会抛出异常并说`java.lang.NoClassDefFoundError ...`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:02:09.103

步骤#1：撤消“配置构建路径”的东西

第 2 步：确保您使用的是最新的 SDK 工具和 Eclipse 的 ADT 插件

`libs/`步骤#3：在项目的根目录中创建一个目录

步骤#4：将您的 JAR 复制到`libs/`目录中

您的 JAR 将自动添加到您的构建路径，其内容将自动添加到您的 APK。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T20:09:02.577

这为我修复了它：

*   从构建路径中删除所有 Android 库项目和外部 jar。
*   在您的项目中创建一个名为“libs”的文件夹。
*   将所有外部 .jar 文件放在该文件夹中，ADT 现在应该将它们放在“Android 依赖项”下。
*   以正常方式重新导入所有以前的 Android 库项目。

问题是在使用属性 - Java 构建路径 - 添加外部 Jar 时，默认情况下外部 jar 不会放在“libs”文件夹中，而是放在“引用库”而不是“Android 依赖项”下，这会导致 NoClassDefFoundError。

请[查看处理 Android 项目中的依赖项以获取更多详细信息](http://tools.android.com/recent/dealingwithdependenciesinandroidprojects)

# php - 重定向带有参数且不带页面扩展名的页面

> ID：10737103
> 
> 赞同：0
> 
> 时间：2012-05-24T12:00:57.347
> 
> 标签：php, apache, .htaccess, redirect

我需要重定向这样的页面：

```
http://example.com/clients/themes?domain=localhost.com 
```

此链接应重定向到同一目录中的 skin.php。

谁能帮我？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:07:55.867

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{QUERY_STRING} ^domain=localhost\.com$ [NC]
RewriteRule ^clients/themes/?$ clients/skin.php? [L,NC] 
```

这将在内部转发您的请求以`/clients/skin.php`剥离查询字符串。如果您还想要查询字符串，请`?`在`skin.php`.

# asp.net-mvc-3 - ASP.NET MVC 编辑器模板；将参数传递给控制器

> ID：10737106
> 
> 赞同：0
> 
> 时间：2012-05-24T12:01:12.233
> 
> 标签：asp.net-mvc-3

这是我的 ASP.NET MVC 项目中的编辑器模板：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl" %>
<%= Html.Telerik().DropDownList()
        .Name(ViewData.TemplateInfo.GetFullHtmlFieldName(string.Empty))
        .DataBinding(binding => binding.Ajax().Select("GetTypeDataforRow","MyController"))
%> 
```

我在控制器中使用 GetTypeDataforRow 方法来检索组合框的数据。有没有办法将参数传递给 GetTypeDataforRow 方法？如果是这样，它的语法是什么？我的下拉菜单将根据传递给此方法的参数显示不同的数据。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:37:16.707

[您可以在此处](http://www.telerik.com/help/aspnet-mvc/telerik-ui-components-combobox-data-binding-client-side-binding.html)找到有关此主题的一些信息。似乎官方文档没有 DropDownList 分支，但 ComboBox 会做的事情。它说要使用 ajax 绑定将参数传递给控制器​​，您应该执行以下操作：

```
.DataBinding(dataBinding => dataBinding
     //Ajax binding
     .Ajax()
          //The action method which will return JSON and its arguments
          .Select("_AjaxBinding", "Home", new {id = (string)ViewData["id"]})
) 
```

有一个时刻：您无法使用这种方法获得组合框的值，因为 ViewData 是一个服务器端容器。相反，您必须像这样使用 JavaScript：

```
<script type="text/javascript">

function onComboBoxDataBinding(e) {
    e.data = $.extend({}, e.data, { customParam: "customValue"});
}

</script> 
```

无论如何，希望这对您有所帮助。

# c# - 如何缩短 Asp.net Web 应用程序调试时间？

> ID：10737109
> 
> 赞同：4
> 
> 时间：2012-05-24T12:01:16.110
> 
> 标签：c#, asp.net, performance, debugging, deployment

我有一个具有以下属性的大型 ASP.NET Web 应用程序：

*   我正在使用 Visual Studio 2010 Ultimate IDE
*   **.Net 框架 3.5**
*   ASP.NET（网络应用程序）
*   **本项目使用NHibernate** **2.2**版本作为 ORM
*   开发者系统：CPU 双核 2.94GHz x64 和 6GB 内存
*   项目**重建时间 3 ~ 4 分钟**
*   更改后构建项目通常需要 1 分钟

当开发人员尝试在默认模式下浏览页面时，第一页出现需要**2 到 4 分钟**，他/她可以在合理的时间内浏览其他页面

当开发人员要调试一个页面时，需要 **4~7 分钟**才能看到第一页，以此类推。

因此，如果开发人员对代码进行了更改并想在调试模式下对其进行检查，他/她会发疯的，因为检查代码中的微小更改需要花费大量时间。

有什么办法可以减少调试时间吗？

我将一个大项目缩减为**许多小项目**。（小的现在可以在很短的时间内调试，所以大部分都很好）

但是其中 4 个仍然很大的项目存在**相同的问题**，并且没有任何改变。我还将**它们部署在本地 IIS 中**，但没有任何改变。

任何建议将不胜感激

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T15:10:58.610

在大型 Web 项目中，一个有用的事情是明智地使用单元测试（例如 microsoft 或 nunit）来测试业务对象和逻辑、数据库连接等。由于在这种情况下不需要开发 Web 服务器和 Web 表单开销，因此可以更快地调试单元测试。以这种方式工作，主要的慢速调试器将仅用于非常特定的 Web UI 问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T20:20:18.417

因为您使用 NHibernate 作为 ORM，所以我唯一可能认为它需要这么长时间是因为您滥用它，导致 SELECT N+1 问题或类似问题。

另一方面，我不知道你的解决方案结构，但我建议你看看这里： http: [//geekswithblogs.net/MarkPearl/archive/2012/05/24/vs2010-large-solution-bottle-neck .aspx](http://geekswithblogs.net/MarkPearl/archive/2012/05/24/vs2010-large-solution-bottle-neck.aspx)

# css - > 和 ~ CSS 中的表达式

> ID：10737114
> 
> 赞同：3
> 
> 时间：2012-05-24T12:01:33.037
> 
> 标签：css, css-selectors

CSS 中 ~ 和 > 的作用是什么？例如下面的表达式是什么意思？

```
:checked ~ label ~ .content > * 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-24T12:02:41.510

您的选择器意味着：

> 选择任何元素
> 的子元素，该元素的类在`content`
> a`label`
> 之后，而后者又在`:checked`输入元素之后。

`>`是[子组合子](http://www.w3.org/TR/selectors/#child-combinators)。它选择作为某个父元素的子元素的元素。与空间（后代组合器）不同，它只选择立即嵌套的元素。有关其工作原理的说明，请参[见此答案。](https://stackoverflow.com/a/3225905/106224)

`~`是[一般的兄弟组合子](http://www.w3.org/TR/selectors/#general-sibling-combinators)。它选择在同一父级中的其他元素之后的元素（即兄弟姐妹）。与`+`（相邻的兄弟组合器）不同，它不需要一个元素立即跟随同一个父元素中的另一个元素。将下图与涵盖组合器的[其他答案进行比较。](https://stackoverflow.com/a/3382096/106224)`+`

小心，因为`~`组合器不只是选择*任何*兄弟元素。它只选择一个出现**在**其兄弟元素之后的元素，因此`:checked ~ label`不会匹配`label`出现在被检查输入元素之前的 a 。

插图：

```
<section>
    <input type="radio" name="example1" value="1" checked>
    <label>1</label>
    <input type="radio" name="example1" value="2">
    <label>2</label>
    <input type="radio" name="example1" value="3">
    <label>3</label>

    <div class="content">
        <h3>Subheading 1</h3>     <!-- [1] Selected -->
        <p>Some text              <!-- [1] Selected -->
           <em>with emphasis</em> <!-- [2] Not selected -->
        </p>
        <p>Some text</p>          <!-- [1] Selected -->
    </div>
</section>

<section>
    <input type="radio" name="example2" value="1">
    <label>1</label>
    <input type="radio" name="example2" value="2">
    <label>2</label>
    <input type="radio" name="example2" value="3">
    <label>3</label>

    <div class="content">
        <h3>Subheading 1</h3>     <!-- [3] Not selected -->
        <p>Some text              <!-- [3] Not selected -->
           <em>with emphasis</em> <!-- [2] Not selected -->
        </p>
        <p>Some text</p>          <!-- [3] Not selected -->
    </div>
</section> 
```

选择了什么，没有选择什么：

1.  **Selected**
    此`h3`或`p`元素直接位于`.content`父元素内。该`.content`元素至少在一个之后`label`，并且这`label`发生在至少一个输入元素之后`:checked`。

    请注意，可以选中此处的*任何*单选按钮，并且元素将匹配，因为如上所述`~`不需要标签立即跟随它。此外，给定结构，任何一个`~`选择器都可以换成 a `+`：

    ```
    :checked + label ~ .content > *
    :checked ~ label + .content > * 
    ```

    但是这个选择器：

    ```
    :checked + label + .content > * 
    ```

    **仅当检查第三个**广播按钮时，才会匹配，因为它是唯一**立即**遵循A`label`和`.content`元素的按钮。

2.  **未选择**
    此`em`元素嵌套在其中一个元素中，该`p`元素本身包含在 中`.content`。根据[此处](https://stackoverflow.com/a/3225905/106224)的插图，它不会被选中，因为它不是 的子级`.content`。

3.  **未选中**
    与 [1] 中不同的是`label`，本节中的任何元素都不跟在任何`:checked`输入元素之后。因此，这里没有选择任何内容，因为它不满足`:checked ~ label`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-24T12:03:49.347

参照。[http://www.w3.org/TR/selectors/](http://www.w3.org/TR/selectors/)：

> `E ~ F` E 元素前面的 F 元素 E 元素
> `E > F` 的 F 元素子元素

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T12:12:46.260

`:checked`是单选按钮或复选框的伪类[http://reference.sitepoint.com/css/pseudoclass-checked](http://reference.sitepoint.com/css/pseudoclass-checked)

`~`是通用的兄弟选择器

`:checked ~ label`选择选中的复选框或单选按钮之后的标签（两者之间可以有任意数量的元素，但它们处于同一级别，并且标签位于选中的复选框或单选按钮之后）

`:checked ~ label ~ .content`选择具有类内容并位于上述标签之后的元素（同样，它们之间可以有任意数量的元素）

`>`是子选择器[http://www.w3.org/TR/CSS2/selector.html#child-selectors](http://www.w3.org/TR/CSS2/selector.html#child-selectors)

`:checked ~ label ~ .content > *`选择上述元素的任何子元素

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T12:04:34.837

`*`所有元素在元素下
`:checked`输入检查状态
`.`类名
`>`

[http://w3schools.com/cssref/css_selectors.asp](http://w3schools.com/cssref/css_selectors.asp)

此页面将对您有用

# maven - jJenkins - 构建后的空工作区

> ID：10737116
> 
> 赞同：1
> 
> 时间：2012-05-24T12:01:38.440
> 
> 标签：maven, jenkins, workspace, cobertura

我已经使用 Maven 设置了 Jenkins，但是在构建后我无法填充我的工作区目录。我获得了构建成功，但我的工作区目录仍然是空的？构建正确保存到构建文件夹，但由于某种未知原因，没有将文件复制到工作区。

我在 Mac 上运行（创建了 scm.sh shell 来运行 scm）并且担心这可能是问题所在？当我尝试在 Jenkins 中“清除工作区”时，我得到：

```
java.io.IOException: Cannot run program "scm": error=2, No such file or directory 
```

任何想法将不胜感激，谢谢。

# c# - 在 WinRT 中创建选项卡

> ID：10737117
> 
> 赞同：19
> 
> 时间：2012-05-24T12:01:41.140
> 
> 标签：c#, xaml, windows-8

我正在开发适用于 Windows 8 的 C#/XAML Metro 风格应用程序。WinRT 中的 XAML 没有“选项卡”控件。但是，我正在尝试模拟 Windows 8 商店中结果的外观。例如，此图像显示“概述”、“详细信息”和“评论”选项卡：

![在此处输入图像描述](../Images/6e62fcaad65bbb1e6d7d8755d3d10cdb.png)

*我如何创建这些？*

RadioButton 似乎很有意义。我想我可以使用 GroupName 来确保只选择一项。但是，如果我使用 RadioButton，我不知道如何使所选项目看起来是深灰色，而将其他选项设置为浅灰色。有人可以给我看一个 RadioButton 的 XAML，它没有显示小检查的东西吗？选中时为深灰色，未选中时为浅灰色。

太感谢了！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-21T01:27:47.677

这是用于单选按钮的样式，以使它们看起来/像选项卡一样工作：

```
 <!-- Style for radio buttons used as tab control -->
<Style x:Key="TabRadioButtonStyle" TargetType="RadioButton">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="RadioButton">
                <Grid>
                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup x:Name="CheckStates">
                            <VisualState x:Name="Unchecked">
                                <Storyboard>
                                    <ColorAnimation Duration="0" To="Gray" Storyboard.TargetProperty="(TextBlock.Foreground).(SolidColorBrush.Color)" Storyboard.TargetName="TabButtonText" />
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="Indeterminate">
                                <Storyboard>
                                    <ColorAnimation Duration="0" To="White" Storyboard.TargetProperty="(TextBlock.Foreground).(SolidColorBrush.Color)" Storyboard.TargetName="TabButtonText" />
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="Checked">
                                <Storyboard>
                                    <ColorAnimation Duration="0" To="Black" Storyboard.TargetProperty="(TextBlock.Foreground).(SolidColorBrush.Color)" Storyboard.TargetName="TabButtonText" />
                                </Storyboard>
                            </VisualState>

                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>
                    <TextBlock x:Name="TabButtonText" Text="{TemplateBinding Content}" Style="{StaticResource GroupHeaderTextStyle}" HorizontalAlignment="Left"/>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

然后，您可以定义一个网格来保存选项卡堆栈面板和一个框架来保存与每个选项卡关联的内容。使用单选按钮上的 Click 事件将框架导航到每个“选项卡”的相应页面。

```
 <Grid Grid.Row="1"
        Margin="120,0,56,56">
        <!-- Row 1 to hold the "Tabs", Row 2 to hold the content -->
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <StackPanel Grid.Row="0" Orientation="Horizontal">
            <RadioButton x:Name="Tab1" Content="Tab1" Style="{StaticResource TabRadioButtonStyle}" IsChecked="True" Click="Tab1_Clicked" />
            <RadioButton x:Name="Tab2" Content="Tab2" Style="{StaticResource TabRadioButtonStyle}" IsChecked="False" Click="Tab2_Clicked" Margin="30,0,0,0" />
            <RadioButton x:Name="Tab3" Content="Tab3" Style="{StaticResource TabRadioButtonStyle}" IsChecked="False" Click="Tab3_Clicked" Margin="30,0,0,0"/>
        </StackPanel>
        <Frame x:Name="ContentFrame" Margin="0,20,0,0" Grid.Row="1" Background="{StaticResource SandstormBackgroundBrush}" Loaded="ContentFrame_Loaded" />
    </Grid> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-24T20:42:59.937

设置 ListBox 样式优于设置单选按钮组样式。

以下代码使用带有水平堆栈面板的 ListBox 来创建选项卡项标题。ContentControl 将选项卡内容显示为用户控件。

我只用 WPF 对此进行了测试，但希望它可以在 WinRT 上运行。

![在此处输入图像描述](../Images/d2402a34604cc3a223be80d0b4c817fd.png)

```
<Page.Resources>
    <Style TargetType="ListBoxItem">
        <!-- disable default selection highlight -->
        <!-- Style.Resources is not supported in WinRT -->
        <!--<Style.Resources>
            --><!-- SelectedItem with focus --><!--
            <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" 
                            Color="Transparent" />
            --><!-- SelectedItem without focus --><!--
            <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" 
                            Color="Transparent" />
        </Style.Resources>-->
        <!--Setter Property="FocusVisualStyle" is not supported in WinRT -->
        <!--<Setter Property="FocusVisualStyle" Value="{x:Null}" />-->
    </Style>
    <Style x:Key="TitleStyle" TargetType="TextBlock">
        <Setter Property="Foreground" Value="LightGray"/>
        <!--Style.Triggers is not supported in WinRT-->
        <!--<Style.Triggers>
            <DataTrigger Value="True" Binding="{Binding Path=IsSelected, 
                        RelativeSource={RelativeSource Mode=FindAncestor, 
                        AncestorType={x:Type ListBoxItem}}}">
                <Setter Property="Foreground" Value="DarkGray"/>
                <Setter Property="FontWeight" Value="Bold"/>
            </DataTrigger>
        </Style.Triggers>-->
    </Style>
</Page.Resources>
<Grid>
    <Grid.DataContext>
        <ViewModel:TestPage/>
    </Grid.DataContext>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition/>
    </Grid.RowDefinitions>

    <ListBox x:Name="tabListBox" Grid.Row="0" ItemsSource="{Binding Items}" 
                        SelectedItem="{Binding SelectedItem, Mode=TwoWay}" 
                        BorderBrush="{x:Null}" BorderThickness="0">
        <ListBox.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel Orientation="Horizontal" />
            </ItemsPanelTemplate>
        </ListBox.ItemsPanel>
        <ListBox.ItemTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding Title}" Margin="5" 
                        Style="{StaticResource TitleStyle}"/>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox>

    <ContentControl Grid.Row="1" Content="{Binding SelectedItem.Content}"/>
</Grid> 
```

查看模型

```
public class MyTabViewModel : INotifyPropertyChanged
{
    public MyTabViewModel()
    {
        Items =
            new List<MyTabItem>
                {
                    new MyTabItem
                        {
                            Title = "Overview",
                            Content = new UserControl1()
                        },
                    new MyTabItem
                        {
                            Title = "Detail",
                            Content = new UserControl2()
                        },
                    new MyTabItem
                        {
                            Title = "Reviews",
                            Content = new UserControl3()
                        },
                };
    }

    public IEnumerable<MyTabItem> Items { get; private set; }

    private MyTabItem _selectedItem;

    public MyTabItem SelectedItem
    {
        get { return _selectedItem; }
        set
        {
            _selectedItem = value;
            PropertyChanged(this, new PropertyChangedEventArgs("SelectedItem"));
        }
    }

    #region Implementation of INotifyPropertyChanged

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion
}

public class MyTabItem
{
    public string Title { get; set; }
    public UserControl Content { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-24T21:20:50.657

[FlipView 控件](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.flipview%28v=VS.85%29.aspx)可能会满足您的需要 。[样品](http://code.msdn.microsoft.com/windowsapps/XAML-FlipView-control-0ae45312)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-04T09:39:24.230

我也使用`FlipView`了控件，但我创建了一个单独的模板化控件，它继承自`FlipView`.

主要思想是覆盖默认值`FlipView` `ControlTemplate`：我添加了一个`ListBox`代表选项卡标题并删除了“下一个”和“上一个”`FlipView`按钮。

如果您需要有关我的实现的更多详细信息，我可以共享源代码。

# xpath - XQuery 未对 Order by 子句进行验证

> ID：10737121
> 
> 赞同：1
> 
> 时间：2012-05-24T12:01:58.067
> 
> 标签：xpath, xquery

```
for $i in cts:search(fn:collection()/article, $query)
    let $snippet :=  
        search:snippet( $i,.....)  

  order by if ($randomize) then ()   
     else if($sort-by = "ascending") then  
      xs:date($i/date_posted), cts:score($i)  
     else xs:date($i/date_posted) descending, cts:score($i) descending    

return
 element{"article"}
{ .....
  .....
  .....
} 
```

**问题：**
在上面的 x-query 语句中，order by 子句有一个条件，`if($randomize) then ()`否则提供的输出将以降序方式。

我有一个要求，根据用户提供的排序类型，我想以升序或降序的方式提取结果。

但是对于上述编写的代码，我的 x-query 语句将无法验证。

提前致谢，
~Prashant

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:56:04.687

不幸的是，XQuery 中的排序规范是静态的，甚至比 XSLT 中的还要多。如果要在升序或降序之间动态切换，唯一的方法是反转排序键。这对数字来说很容易——只需使用 -(KEY) 而不是 (KEY)。日期也不是太难 - 从未来的某个固定日期中减去日期（实际上是任何日期）。我想不出任何方便的方法来处理字符串，但幸运的是你似乎没有使用字符串。

# google-chrome - 如何托管 chrome 扩展程序？

> ID：10737123
> 
> 赞同：6
> 
> 时间：2012-05-24T12:02:04.490
> 
> 标签：google-chrome, google-chrome-extension

我需要使用 PHP 在我的共享主机上托管我的 chrome 扩展。

我知道我的服务器必须使用适当的 HTTP 标头：[code.google.com/chrome/extensions/hosting.html](http://code.google.com/chrome/extensions/hosting.html)

但是，如何设置我的服务器将这些标头发送到 .crx 文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T19:48:12.603

如果您在共享主机上并且无法更改服务器配置，请使用 PHP：

```
<?php
$file = 'extension.crx';

if (file_exists($file)) {
    header('Content-Description: File Transfer');
    header('Content-Type: application/x-chrome-extension');
    header('Content-Disposition: attachment; filename='.basename($file));
    header('Content-Transfer-Encoding: binary');
    header('Expires: 0');
    header('Cache-Control: must-revalidate');
    header('Pragma: public');
    header('Content-Length: ' . filesize($file));
    ob_clean();
    flush();
    readfile($file);
    exit;
}
?> 
```

[资源](http://php.net/manual/en/function.readfile.php)

这将强制`$file`下载带有自定义标题的文件（由变量指定）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:34:14.630

我不知道您使用的是什么 Web 服务器，但对于 Apache，您可以执行以下操作：

1.  六`/path/to/your/httpd/conf/mime.types`
2.  添加这一行：`application/x-chrome-extension crx`在文件末尾
3.  重新启动您的网络服务器：`killall -HUP httpd`

或者您可以尝试将此行添加到您的`.htaccess`文件中：

```
AddType application/x-chrome-extension crx 
```

它应该工作！

# mootools - MooTools 打破 jQuery 可拖动

> ID：10737127
> 
> 赞同：0
> 
> 时间：2012-05-24T12:02:09.097
> 
> 标签：mootools, jquery-ui-draggable, jquery

在我的项目中，我必须使用两个 JS 库 - jQuery (v1.7.1) 和 MooTools (v1.4.5)。我正在使用 jQuery.noConflict(); 一切正常……除了 jQuery 的拖动元素（jQuery UI 对话框）。有人知道在 jQuery 中修复此功能的方法吗？

我尝试在 jQuery 之前和之后加载 Mootools ......但没有成功。只有删除 Mootolls 才能修复拖动能力。

更新：MooTools 中的事件加载会导致 jQuery 拖动出现问题。这行：

```
(function (i, k) {
var l, f, e = [], c, b, d = k.createElement("div");
var g = function () {
    clearTimeout(b);
    if (l) {
        return;
    }
    Browser.loaded = l = true;
    k.removeListener("DOMContentLoaded", g).removeListener("readystatechange", a);
    k.fireEvent("domready");
    i.fireEvent("domready");
};
var a = function () {
    for (var m = e.length; m--;) {
        if (e[m]()) {
            g();
            return true;
        }
    }
    return false;
};
var j = function () {
    clearTimeout(b);
    if (!a()) {
        b = setTimeout(j, 10);
    }
};
k.addListener("DOMContentLoaded", g);
var h = function () {
    try {
        d.doScroll();
        return true;
    } catch (m) {
    }
    return false;
};
if (d.doScroll && !h()) {
    e.push(h);
    c = true;
}
if (k.readyState) {
    e.push(function () {
        var m = k.readyState;
        return(m == "loaded" || m == "complete");
    });
}
if ("onreadystatechange" in k) {
    k.addListener("readystatechange", a);
} else {
    c = true;
}
if (c) {
    j();
}
Element.Events.domready = {onAdd:function (m) {
    if (l) {
        m.call(this);
    }
}};
Element.Events.event= {base:"load", onAdd:function (m) {
    if (f && this == i) {
        m.call(this);
    }
}, condition:function () {
    if (this == i) {
        g();
        delete Element.Events.load;
    }
    return true;
}};
i.addEvent("load", function () {
    f = true;
}); 
```

})(窗口，文档);

# c# - 如何将 HttpRequest 接收到 MVC 3 控制器操作中？

> ID：10737134
> 
> 赞同：5
> 
> 时间：2012-05-24T12:02:24.743
> 
> 标签：c#, asp.net, asp.net-mvc-3, unit-testing, c#-4.0

## 当前解决方案

所以我有一些非常相似的东西

```
[HttpPost]
    public ActionResult Upload()
    {
        var length = Request.ContentLength;
        var bytes = new byte[length];

        if (Request.Files != null )
        {
            if (Request.Files.Count > 0)
            {
                var successJson1 = new {success = true};
                return Json(successJson1, "text/html");
            }
        }
...
        return Json(successJson2,"text/html");
    } 
```

## 可单元测试的解决方案？

我想要这样的东西：

```
[HttpPost]
public ActionResult Upload(HttpRequestBase request)
{
    var length = request.ContentLength;
    var bytes = new byte[length];

    if (request.Files != null )
    {
        if (request.Files.Count > 0)
        {
            var successJson1 = new {success = true};
            return Json(successJson1);
        }
    }

    return Json(failJson1);
} 
```

然而这失败了，这很烦人，因为我可以从基类中创建一个 Mock 并使用它。

## 笔记

*   我知道这不是解析表单/上传的好方法，并且想说这里正在发生其他事情（即此上传可以是表单或 xmlhttprequest - 操作不知道哪个）。
*   使“请求”单元可测试的其他方法也很棒。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T12:07:07.363

您的控制器上已经有一个[Request](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.request.aspx)属性=>您不需要将它作为操作参数传递。

```
[HttpPost]
public ActionResult Upload()
{
    var length = Request.ContentLength;
    var bytes = new byte[length];

    if (Request.Files != null)
    {
        if (Request.Files.Count > 0)
        {
            var successJson1 = new { success = true };
            return Json(successJson1);
        }
    }

    return Json(failJson1);
} 
```

现在你可以在你的单元测试中模拟`Request`，更具体地说是具有 Request 属性的 HttpContext ：

```
// arrange
var sut = new SomeController();
HttpContextBase httpContextMock = ... mock the HttpContext and more specifically the Request property which is used in the controller action
ControllerContext controllerContext = new ControllerContext(httpContextMock, new RouteData(), sut);
sut.ControllerContext = controllerContext;

// act
var actual = sut.Upload();

// assert
... assert that actual is JsonResult and that it contains the expected Data 
```

# json - 读取json，重复组

> ID：10737135
> 
> 赞同：0
> 
> 时间：2012-05-24T12:02:27.747
> 
> 标签：json, windows-phone-7

我正在尝试制作一个从网站读取 json 文件的 windows phone 应用程序。这个 json 文件有一个重复组，我似乎无法让程序读取所有组。

这是 json 输出的示例：

```
{
    "program":{
        "title":"Carl Schmitz",
        "image_url":"http:\/\/q-music.be\/sites\/2009.q-music.be\/files\/NOA.jpg"
    },
    "noa":[
        {
            "title":"Behind Blue Eyes",
            "artist":"LIMP BIZKIT",
            "itunes_link":"http:\/\/clk.tradedoubler.com\/click?p=24379&a=1256924?url=http:\/\/itunes.apple.com\/be\/album\/behind-blue-eyes\/id14915153?i=14915155&uo=4&partnerId=2003"
        },
        {
            "title":"Alone Again",
            "artist":"ALYSSA REID",
            "itunes_link":"http:\/\/clk.tradedoubler.com\/click?p=24379&a=1256924?url=http:\/\/itunes.apple.com\/be\/album\/alone-again-original-mix\/id496520410?i=496520415&uo=4&partnerId=2003"
        }
    ]
} 
```

有人可以解释我如何阅读这个 json 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:07:09.057

你的类结构应该是这样的。我使用了很棒的[json2csharp](http://json2csharp.com)来生成它：

然后你应该能够直接反序列化到 RootObject 中。您没有提及您使用的是哪个序列化程序，因此此处（尚未）显示实际的反序列化。

```
public class Program
{
    public string title { get; set; }
    public string image_url { get; set; }
}

public class Noa
{
    public string title { get; set; }
    public string artist { get; set; }
    public string itunes_link { get; set; }
}

public class RootObject
{
    public Program program { get; set; }
    public List<Noa> noa { get; set; }
} 
```

# php - 找不到 Jfactory 类

> ID：10737136
> 
> 赞同：0
> 
> 时间：2012-05-24T12:02:31.447
> 
> 标签：php, joomla

我有以下代码可以使用：

```
<?php
function getArticleDbImage($item){ 

            global $db;
            if(!$db){
                $db =&JFactory::getDBO();
            }
            //echo "dt: ".$item->created;
            $artclDatArr =  explode("-",$item->created);
            $plugin =& JPluginHelper::getPlugin('content','setimage');
            $pluginParams = new JParameter($plugin->params);
            $query = 'SELECT a.images FROM #__content AS a WHERE id=' . $item->id;
            $db->setQuery($query);
            $images = $db->loadRow();
            //print_r($images);
            $db_image_path      = $pluginParams->get('db_image_path', 'images/stories/db_images/');
            $add_default_img    = $pluginParams->get('add_default_img', '1');
            $default_img_url    = $pluginParams->get('default_img_url', '');
            if($images[0]){
                $imgNameArr = explode(".", $images[0]);
                $image = rtrim($db_image_path,'/') . "/" . $artclDatArr[0] . "/" . ltrim($artclDatArr[1],'0') . "/" . $imgNameArr[0] . '_e.' . $imgNameArr[1];
            } else {
                $image = $default_img_url;
            }
            //echo "img: ".$fn_image;
            return $image;

        }
           extract($_REQUEST);
        ?> 
```

上面的代码给了我错误：`Jfactory class not found`

# flash - Pixel Bender 与 Stage3D、Stage Video 和 Starling

> ID：10737137
> 
> 赞同：1
> 
> 时间：2012-05-24T12:02:34.770
> 
> 标签：flash, stage3d, pixel-bender, flash-video, starling-framework

[Pixel Bender (2D)](http://www.adobe.com/devnet/pixelbender.html)是否与 Stage3D 结合使用？

即：

[Pixel Bender 能否在Stage Video](http://www.adobe.com/devnet/flashplayer/stagevideo.html)（GPU 加速视频）之上工作？

[Pixel Bender 是否在Starling](http://gamua.com/starling/)视口之上工作？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:04:34.810

我担心答案是否定的。

Stage3D 没有高级着色语言。如果你想为 Stage3D 编写着色器，你将不得不使用极其丑陋的[AGAL](http://help.adobe.com/en_US/as3/dev/WSd6a006f2eb1dc31e-310b95831324724ec56-8000.html)。我什至不是在开玩笑，图形编程的汇编代码。真的。

由于不提供高级语言，Adobe 几乎扼杀了任何希望在合理时间内完成的雄心勃勃的 3D 项目。相信我，编写 AGAL 代码绝不是合理和快速的。有一些 Flash 3D 引擎，例如[Away3D](http://away3d.com/)和[Alternativa](http://alternativaplatform.com/)，它们都很好，但即使是它们也带有自己的预制着色器，如果你想要自己的东西，祝你好运。

也就是说，正如您[在此处](http://labs.adobe.com/technologies/pixelbender3d/)看到的那样，我们在制作某种 Pixel Bender 3D 方面做出了一些努力。但是自 09.2011 以来开发已经停止，最后一个版本是你必须自己编译的，没有 UI 等。所以，再一次，几乎没用。不知道 Adob​​e 在想什么/在想什么；）

我不确定 Starling，但我怀疑您是否可以将 PB2 着色器与 Starling 一起使用，因为这意味着 Starling 有自己的（旧）PB2 代码解析器。但这里不能保证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T18:45:51.597

问题尚不清楚，至于像素弯曲着色器是否可以用作 Stage3D 的着色器，不。至于像素弯曲器是否可以与 Stage3D 一起使用，是的，尽管它的成本很高。

您可以让像素弯曲器生成纹理然后上传到 GPU，您可以将 Stage3D 内容渲染为位图数据，然后由像素弯曲器等处理。

至于 AGAL，它非常易于使用，我看不出问题出在哪里，甚至像自阴影视差镜面反射凹凸贴图这样非常复杂的着色器也不是需要克服的障碍。它不像您要在 AGAL 中编写游戏本身 :)

# c# - 在 snmptrap.exe 运行时捕获 SNMP 陷阱

> ID：10737141
> 
> 赞同：3
> 
> 时间：2012-05-24T12:02:42.280
> 
> 标签：c#, windows-server-2008, snmp

我刚刚实现了一个小型 Windows 服务，它使用[http://www.snmpsharpnet.com/](http://www.snmpsharpnet.com/)上的库捕获 SNMP 陷阱。（它是用 C# 实现的）

然而令我沮丧的是，我刚刚发现我们所有的服务器都在 Windows (2008 R2) 中运行 snmptrap.exe。

所以现在我的问题是：我该如何处理这个问题？

您可以通过某种 API 与 snmptrap.exe 进行交互，还是我必须停止 snmptrap.exe ？（我真的不想这样做，因为我不确定它没有被使用）

任何人都有一个好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T16:37:13.873

最后发现有一个用于 snmptrap 的 API：http: [//msdn.microsoft.com/en-us/library/windows/desktop/aa377986 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa377986(v=vs.85).aspx)

但是我找不到 P/Invoke 它的方法，所以我必须制作一个 C++ 库，并在其周围使用 CLI 包装器。这显然可以解决我的问题，但是公司决定不将资源花在这上面，所以我目前不会进一步调查此事。

我仍然相信这是解决问题的方法，因此我已经回答了我自己的问题。

# objective-c - NSNumberFormatter，从 UI 将小数附加到计算器

> ID：10737145
> 
> 赞同：2
> 
> 时间：2012-05-24T12:03:00.673
> 
> 标签：objective-c, decimal, calculator, nsnumberformatter

好的，所以我现在正在编写一个计算器应用程序。到目前为止，我在小数方面运气不佳（我最近的方法效果不佳）。

```
-(void) DecimalAdded
{
    NSNumberFormatter *formatter = [[NSNumberFormatter  alloc] init]; 
    [formatter  setNumberStyle:NSNumberFormatterDecimalStyle];
    [formatter  setAlwaysShowsDecimalSeparator:YES];
    [formatter setGeneratesDecimalNumbers:YES];
    [formatter setDecimalSeparator:@"."];

    //first convert the float value of CN into NSnumber

    NSNumber  *nextstepNumFromCNF= [NSNumber numberWithFloat:currentNumber];

    //now we have to convert that number into a string

    NSString *CNconverted = [formatter stringFromNumber:nextstepNumFromCNF];

    NSNumber *CNdecmAddedAndReadyForPars = [formatter numberFromString:CNconverted];

    currentNumber = currentNumber*10 + [CNdecmAddedAndReadyForPars floatValue];

    CalculatorScreen = [NSMutableString stringWithFormat: @"%@", CNconverted]; 
```

我可以将字符串附加到计算器屏幕我可以说数字是 1，我看到“1”。在我打字的时候。但是，这通常在浮点转换期间转换为 1（这是正确的）。

实现这一目标的最佳方法是什么？

# jquery - 关闭并重新打开对话框后，jQuery 对话框和 Google 地图的行为不正确

> ID：10737152
> 
> 赞同：1
> 
> 时间：2012-05-24T12:03:33.240
> 
> 标签：jquery, jquery-ui, google-maps, google-maps-api-3

当用户单击某个按钮时，我正在尝试显示带有谷歌地图的对话框。

在第一次加载时，地图正确显示。用户隐藏对话框并再次打开后，地图没有居中，而是移到了左上角。

看到这个小提琴。

[http://jsfiddle.net/KHctC/5/](http://jsfiddle.net/KHctC/5/)

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T12:14:46.453

`setCenter`如果地图已经创建，您只需使用该方法。

请参阅[这个 jsFiddle 分叉](http://jsfiddle.net/F3HP2/)。

# android - Android：当 wrap_content 不只是包装其内容时？

> ID：10737155
> 
> 赞同：0
> 
> 时间：2012-05-24T12:03:39.633
> 
> 标签：android, android-layout

我的项目中有一个以下 xml 布局（顺便说一下，如果您发现其他看起来也错误/不太好，我会很感激您让我知道它！）我的问题是属性“wrap_contents”没有'不能在最后一个 TextView ("EEE", txt4) 工作。有什么我忽略的规定吗？

```
<?xml version="1.0" encoding="utf-8"?>

<merge xmlns:android="http://schemas.android.com/apk/res/android">

    <TableLayout
        android:id="@+id/Table"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1">

        <TableRow
            android:id="@+id/tableRow1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical">

            <TextView
                android:id="@+id/txt1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical"
                android:text="AAA"
                android:textColor="@color/white" />

            <Spinner
                android:id="@+id/spn1"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:entries="@array/array1" />

        </TableRow>

        <TableRow
            android:id="@+id/tableRow2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" >

            <TextView
                android:id="@+id/edt1"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical"
                android:text="BBB"
                android:textColor="@color/white" />

            <Spinner
                android:id="@+id/spn2"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:layout_weight="1"
                android:entries="@array/Tounyuhou" />

            <EditText
                android:id="@+id/edt2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:ems="5"
                android:inputType="numberSigned"/>

            <TextView
                android:id="@+id/txt2"
                android:layout_width="wrap_content"
                android:layout_height="match_parent"
                android:text="CCC" android:textColor="@color/white" 
                android:gravity="center_vertical|center_horizontal" 
                android:textSize="18sp"/>

        </TableRow>

        <TableRow
            android:id="@+id/tableRow3"
            android:layout_width="match_parent"
            android:layout_height="wrap_content">

            <TextView
                android:id="@+id/txt3"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical|center_horizontal"
                android:text="DDD"
                android:textColor="@color/white" />

            <EditText
                android:id="@+id/edt3"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:gravity="right|center_vertical">

            </EditText>

            <TextView
                android:id="@+id/txt4"
                android:layout_width="wrap_content"
                android:layout_height="match_parent"
                android:text="EEE"
                android:textColor="@color/white"
                android:gravity="center_vertical|center_horizontal"
                android:textSize="20sp"/>

        </TableRow>

        </TableLayout>

</merge> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:15:58.303

在这里，您定义相同布局中的所有行，但具有不同数量的视图，例如 row1 包含 2 ， row2 包含 4 然后 row3 包含 3 个视图，

所以它给出了问题，

所以我的建议对第三行采取不同的表格布局。

```
<?xml version="1.0" encoding="utf-8"?>

<merge xmlns:android="http://schemas.android.com/apk/res/android">

 <TableLayout
            android:id="@+id/mainTable"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1">

            <TableRow
                android:id="@+id/mainTable_tableRow1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical">

        <TableLayout
            android:id="@+id/Table"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1">

            <TableRow
                android:id="@+id/tableRow1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical">

                <TextView
                    android:id="@+id/txt1"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center_vertical"
                    android:text="AAA"
                    android:textColor="@color/white" />

                <Spinner
                    android:id="@+id/spn1"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:entries="@array/array1" />

            </TableRow>

            <TableRow
                android:id="@+id/tableRow2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >

                <TextView
                    android:id="@+id/edt1"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center_vertical"
                    android:text="BBB"
                    android:textColor="@color/white" />

                <Spinner
                    android:id="@+id/spn2"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:layout_weight="1"
                    android:entries="@array/Tounyuhou" />

                <EditText
                    android:id="@+id/edt2"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:ems="5"
                    android:inputType="numberSigned"/>

                <TextView
                    android:id="@+id/txt2"
                    android:layout_width="wrap_content"
                    android:layout_height="match_parent"
                    android:text="CCC" android:textColor="@color/white" 
                    android:gravity="center_vertical|center_horizontal" 
                    android:textSize="18sp"/>

            </TableRow>
    </TableLayout>
</TableRow>
<TableRow
                android:id="@+id/mainTable_tableRow2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical">
    <TableLayout
            android:id="@+id/Table2"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1">

            <TableRow
                android:id="@+id/table2_tableRow3"
                android:layout_width="match_parent"
                android:layout_height="wrap_content">

                <TextView
                    android:id="@+id/txt3"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center_vertical|center_horizontal"
                    android:text="DDD"
                    android:textColor="@color/white" />

                <EditText
                    android:id="@+id/edt3"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:gravity="right|center_vertical">

                </EditText>

                <TextView
                    android:id="@+id/txt4"
                    android:layout_width="wrap_content"
                    android:layout_height="match_parent"
                    android:text="EEE"
                    android:textColor="@color/white"
                    android:gravity="center_vertical|center_horizontal"
                    android:textSize="20sp"/>

            </TableRow>

            </TableLayout>
</TableRow>
 </TableLayout>

    </merge> 
```

# ios - self.view.frame 大小不正确 iOS

> ID：10737165
> 
> 赞同：0
> 
> 时间：2012-05-24T12:04:19.127
> 
> 标签：ios, frame

我的视图框架有问题。

我已经制作了当前的视图控制器。第一次一切正常。我检查了我的 self.view 框架，在横向模式下它等于`(0.0, 0.0, 1024.0, 768.0)`

接下来我在视图中进行一些操作。在此操作之后，我想检查我的 self.view，现在它等于`(0.0, 0.0, 768, 1024)`

但我不旋转我的观点。

在当前视图控制器中，我有以下方法：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    // Return YES for supported orientations
    return UIInterfaceOrientationIsLandscape(interfaceOrientation);
} 
```

在 plist 中，我只设置了横向。

我的问题是：为什么框架改变了？再次我不旋转我的观点。

非常感谢！

# google-chrome - Chrome 不渲染通过元素引用的 SVG

> ID：10737166
> 
> 赞同：124
> 
> 时间：2012-05-24T12:04:22.180
> 
> 标签：google-chrome, svg

我遇到了谷歌浏览器没有用`img`元素渲染 svg 的问题。刷新页面和初始页面加载时会发生这种情况。我可以通过“检查元素”来显示图像，然后右键单击 svg 文件并在新选项卡中打开 svg 文件。然后将在原始页面上呈现 svg 图像。

```
<img src="../images/Aged-Brass.svg"> 
```

完全不知道问题是什么。svg 图像在 IE9 和 FF 中渲染得很好，只是在 Chrome 或 Safari 中没有。

我也设置了我的 MIME 类型。(图片/svg+xml)

**编辑：** 这是我构建的一个简单的 html 页面，用于帮助说明我的问题。

```
<!DOCTYPE html>
<html>
<head>
    <title>SVG Test</title>

    <style>
        #BackgroundImage{
            background: url('../images/Aged-Brass.svg') no-repeat scroll left top;
            width: 400px;
            height: 600px;
        }

        #image_element {
            width: 400px;
            height: 600px;
            margin: 0px;
            padding: 0px;
        }
    </style>
</head>
<body>
    <div id="image_element">
        <img src="../images/Aged-Brass.svg">
    </div>
    <div id="BackgroundImage"></div>
</body>
</html> 
```

如您所见，我正在尝试在`img`元素和 css 中使用 svg 文件作为背景图像。在 chrome 或 safari 中的初始页面加载都不起作用。当我检查元素右键单击 svg 或单击链接以在另一个窗口中加载 svg 时，svg 文件将呈现在原始选项卡中。

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2018-09-07T15:58:33.653

一个简单易行的方法；根据 [https://css-tricks.com/forums/topic/svg-css-background-image-not-showing-in-chrome/](https://css-tricks.com/forums/topic/svg-css-background-image-not-showing-in-chrome/) 您必须使用文本编辑器（如记事本）打开 .SVG 文件并更改

```
xlink:href="data:img/png;base64, 
```

至：

```
xlink:href="data:image/png;base64, 
```

它对我有用！

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2017-09-15T11:38:29.520

svg-tag 需要命名空间属性 xmlns：

```
<svg xmlns="http://www.w3.org/2000/svg"></svg> 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2014-11-11T10:52:15.723

我来到这里是因为我遇到了同样的问题，当我检查元素时我可以看到文件，但在网站上我不能（即使使用本地主机）

我的问题的答案是保存 SVG 文件。如果您从 illustrator 中保存它，请确保单击“嵌入”而不是“链接”。因为链接只会引用您的本地文件而不是包含数据（如果我理解正确的话）。 ![在此处输入图像描述](../Images/8649fb00a68efee5f408a4b3be3e5e62.png "嵌入SVG")

我在 adobe 网站上阅读了它，该网站有一些其他有用的导出技巧 [http://www.adobe.com/inspire/2013/09/exporting-svg-illustrator.html](http://www.adobe.com/inspire/2013/09/exporting-svg-illustrator.html)

这对我有用，希望它有用。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2015-06-19T21:08:34.130

我来到这里是因为我遇到了类似的问题，图像没有被渲染。我发现我的测试服务器的内容类型标头不正确。我通过将以下内容添加到我的 .htaccess 文件来修复它：

```
AddType image/svg+xml svg svgz
AddEncoding gzip svgz 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2018-03-15T17:14:48.853

我有一个类似的问题，现有的答案要么不适用，要么有效，但由于其他原因我们无法使用它们。所以我必须弄清楚 Chrome 不喜欢我们的 SVG 的地方。

在我们的例子中，结果是SVG 文件中标签的`id`属性中有一个，Chrome 不喜欢它。当我删除它时，它工作正常。`symbol``:``:`

坏的：

```
<svg
    xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 72 72">
    <defs>
        <symbol id="ThisIDHasAColon:AndChromeDoesNotLikeIt">
        ...
        </symbol>
    </defs>
    <use
        ....
        xlink:href="#ThisIDHasAColon:AndChromeDoesNotLikeIt"
    />
</svg> 
```

好的：

```
<svg
    xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 72 72">
    <defs>
        <symbol id="NoMoreColon">
        ...
        </symbol>
    </defs>
    <use
        ....
        xlink:href="#NoMoreColon"
    />
</svg> 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2017-02-08T23:42:25.013

Use `<object>` instead (of course, replace each URL with your own):

```
.BackgroundImage {
        background: url('https://upload.wikimedia.org/wikipedia/commons/b/bd/Test.svg') no-repeat scroll left top;
        width: 400px;
        height: 600px;
}
```

```
<!DOCTYPE html>
<html>
<head>
    <title>SVG Test</title>
</head>
<body>
    <div id="ObjectTag">
        <object type="image/svg+xml" data="https://upload.wikimedia.org/wikipedia/commons/b/bd/Test.svg" width="400" height="600">
          Your browser does not support SVG.
        </object>
    </div>
    <div class="BackgroundImage"></div>
</body>
</html>
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2021-11-02T09:09:22.973

当我从`figma`. 检查 svg 的源代码，如果您`:`在 id 中有这样的冒号：`id="paint1_linear_23:318"`它会让您在 chrome 中呈现问题。

只需删除 ids 中的所有冒号。

不要忘记像这样引用这个 id 来做同样的事情：`fill="url(#paint1_linear_23:318)"`。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2018-03-14T04:17:37.100

将宽度属性添加到 [svg] 标记（通过编辑 svg 源 XML）对我有用：例如：

```
<!-- This didn't render -->
<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
...  
</svg>

<!-- This did -->
<svg version="1.1" baseProfile="full" width="1000" xmlns="http://www.w3.org/2000/svg">
...  
</svg> 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2020-09-10T11:07:10.097

```
Just replace <img> tag to <object> tag for SVG image.

<object data="assets/twitter-wrap.svg" type="image/svg+xml"></object> 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2021-03-19T11:35:04.437

我有同样的问题。当我检查在标题“Content-Type”、“image/svg+xml”中接受并设置的文件类型时，这个问题得到了解决：

```
response.setHeader("Content-Type", "image/svg+xml"); 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-09-25T22:26:41.107

我能够使用您的示例创建一个测试页面，并且效果很好。我的假设是您的 svg 文件有问题。你也可以把它贴在这里吗？这是我使用的示例。

```
 <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
   <!-- Created with SVG-edit - http://svg-edit.googlecode.com/ -->
   <g>
      <title>Layer 1</title>
      <ellipse ry="30" rx="30" id="svg_1" cy="50" cx="50" stroke-width="5" stroke="#000000" fill="#FF0000"/>
   </g>
 </svg> 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2017-10-28T13:33:12.253

看起来像一个 Chrome 错误，我做了其他事情，因为我几乎因为这个而发疯......如果你更改它在屏幕上显示的 svg 对象的 css，请使用 Chrom 调试器。

所以我所做的是： 1\. 检查屏幕大小 2\. 听我的 SVG 对象的“加载”事件 3\. 加载元素时，我使用 jQuery 4 更改它的 css。它为我做了诀窍

```
if (jQuery(window).width() < 769) {

  jQuery('object#mysvg-logo')[0].addEventListener('load', function() {
       jQuery("object#mysvg-logo").css('width','181px');
  }, true);

}
```

```
width: 180px;
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<object id="mysvg-logo" type="image/svg+xml" data="my svg logo url here">Your browser does not support SVG</object>
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2018-06-25T10:09:07.817

`.svg`图像没有它的初始高度和宽度。因此它是不可见的。你必须设置它。

您可以在行内或在 css 文件中执行以下操作：

**排队：**

```
<img src="../images/Aged-Brass.svg" class="image" alt="logo" style="width: 100px; height: 50px;"> 
```

**Css 文件：**

```
<img src="../images/Aged-Brass.svg" class="image" alt="logo"> 
```

```
.image {
    width: 100px;
    height: 50px;
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-08-27T11:49:37.860

就我而言，当我使用 Photoshop 创建和保存 svg 时，这个问题仍然存在。有什么帮助，是使用 Illustrator 打开文件，然后导出 svg。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-03-09T11:14:53.510

来自服务器的 HTTP 标头中的内容类型对我来说是个问题。我有一个 node.js 服务器，添加：

```
if( pageName.substring(pageName.lastIndexOf('.')) == '.svg' ) {
  res.writeHead(200, { "Content-Type": "image/svg+xml" });
} 
```

pageName 是我请求的局部变量。

我的猜测是这是一个普遍的问题！我正在使用当前版本的 Chrome（2020 年 3 月）。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-11-23T02:26:30.200

对我来说，将宽度/高度设置为 img 是可行的。 `<asp:Image runat="server" ID="Icon" Style="max-width: 50px; max-height: 50px; position: relative;" />`

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-07-20T21:40:09.833

我最初从 Photoshop CC 导出了我的 svg，并且必须手动添加

`version="1.1"`进入`<svg>`标签

让它在 chrome 上显示。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-11-19T06:29:51.070

我尝试了上面的大多数解决方案，但对我没有用。我使用了一个 svg sanitizr [https://svg.enshrined.co.uk/](https://svg.enshrined.co.uk/)，它有效。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-10-19T07:02:26.003

在我的情况下，由于图像标签的 id 包含`_`（下划线），它没有加载 svg，所以我从

```
<image id="image0_1166:0000"> to <image id="image0"> and it worked. And don't forget to remove the same here 
<use xlink:href="#image0"> 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-11-22T21:46:41.817

我确保我添加**了 Image 的 Style**。它对我有用

`style= "width:320; height:240"`

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-04-12T20:23:52.517

请注意，您没有svg 图像的**过渡css 属性**

我现在不知道为什么，但是如果您为 Chrome 上的 svg 图像制作：“transition: all ease 0.3s”，则图像不会出现

例如：

```
* {
   transition: all ease 0.3s
  } 
```

Chrome 不呈现 svg。

**删除任何过渡 css 属性并重试**

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-10-28T20:00:54.603

我对通过 IMG 标签包含的 SVG 图像有同样的问题。对我来说，Chrome 不喜欢直接在文件顶部有一个空行。

我删除了空白行，我的 SVG 立即开始渲染。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-09-12T18:56:56.837

有同样的问题。如果服务器配置正确并且 .htacces 不是答案，可能需要查看您正在嵌入的 svg 源。我的是用文本编辑器创建的，在 html5 代码中的 Chrome 和 Safari 上渲染得很好，一旦嵌入，什么都看不到。在 svg 代码中添加了正确的版本、尺寸等，并且像魅力一样工作。此外，所有样式都内联。

IE

```
<svg version="1.1" baseProfile="full" width="24" height="24" xmlns="http://www.w3.org/2000/svg"> 
  <rect x="0" y="0" rx="2" ry="2" width="24" height="24" style="fill:#fbc800;width:24px;height:24px;"  />  
</svg> 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2020-11-29T18:20:59.830

# 轻量级

我的问题是缺少`svg`lighttpd 配置文件中文件的 mime 处理程序。将这些添加到您的`lighttpd.conf`可以解决您的问题：

```
mimetype.assign             = (
  ".pdf"          =>      "application/pdf",
  ".sig"          =>      "application/pgp-signature",
  ".spl"          =>      "application/futuresplash",
  ".class"        =>      "application/octet-stream",
  ".ps"           =>      "application/postscript",
  ".torrent"      =>      "application/x-bittorrent",
  ".dvi"          =>      "application/x-dvi",
  ".gz"           =>      "application/x-gzip",
  ".pac"          =>      "application/x-ns-proxy-autoconfig",
  ".swf"          =>      "application/x-shockwave-flash",
  ".tar.gz"       =>      "application/x-tgz",
  ".tgz"          =>      "application/x-tgz",
  ".tar"          =>      "application/x-tar",
  ".zip"          =>      "application/zip",
  ".mp3"          =>      "audio/mpeg",
  ".m3u"          =>      "audio/x-mpegurl",
  ".wma"          =>      "audio/x-ms-wma",
  ".wax"          =>      "audio/x-ms-wax",
  ".ogg"          =>      "application/ogg",
  ".wav"          =>      "audio/x-wav",
  ".gif"          =>      "image/gif",
  ".jpg"          =>      "image/jpeg",
  ".jpeg"         =>      "image/jpeg",
  ".png"          =>      "image/png",
  ".svg"          =>      "image/svg+xml",
  ".xbm"          =>      "image/x-xbitmap",
  ".xpm"          =>      "image/x-xpixmap",
  ".xwd"          =>      "image/x-xwindowdump",
  ".css"          =>      "text/css",
  ".html"         =>      "text/html",
  ".htm"          =>      "text/html",
  ".js"           =>      "text/javascript",
  ".asc"          =>      "text/plain",
  ".c"            =>      "text/plain",
  ".cpp"          =>      "text/plain",
  ".log"          =>      "text/plain",
  ".conf"         =>      "text/plain",
  ".text"         =>      "text/plain",
  ".txt"          =>      "text/plain",
  ".spec"         =>      "text/plain",
  ".dtd"          =>      "text/xml",
  ".xml"          =>      "text/xml",
  ".mpeg"         =>      "video/mpeg",
  ".mpg"          =>      "video/mpeg",
  ".mov"          =>      "video/quicktime",
  ".qt"           =>      "video/quicktime",
  ".avi"          =>      "video/x-msvideo",
  ".asf"          =>      "video/x-ms-asf",
  ".asx"          =>      "video/x-ms-asf",
  ".wmv"          =>      "video/x-ms-wmv",
  ".bz2"          =>      "application/x-bzip",
  ".tbz"          =>      "application/x-bzip-compressed-tar",
  ".tar.bz2"      =>      "application/x-bzip-compressed-tar",
  ".odt"          =>      "application/vnd.oasis.opendocument.text", 
  ".ods"          =>      "application/vnd.oasis.opendocument.spreadsheet", 
  ".odp"          =>      "application/vnd.oasis.opendocument.presentation", 
  ".odg"          =>      "application/vnd.oasis.opendocument.graphics", 
  ".odc"          =>      "application/vnd.oasis.opendocument.chart", 
  ".odf"          =>      "application/vnd.oasis.opendocument.formula", 
  ".odi"          =>      "application/vnd.oasis.opendocument.image", 
  ".odm"          =>      "application/vnd.oasis.opendocument.text-master", 
  ".ott"          =>      "application/vnd.oasis.opendocument.text-template",
  ".ots"          =>      "application/vnd.oasis.opendocument.spreadsheet-template",
  ".otp"          =>      "application/vnd.oasis.opendocument.presentation-template",
  ".otg"          =>      "application/vnd.oasis.opendocument.graphics-template",
  ".otc"          =>      "application/vnd.oasis.opendocument.chart-template",
  ".otf"          =>      "application/vnd.oasis.opendocument.formula-template",
  ".oti"          =>      "application/vnd.oasis.opendocument.image-template",
  ".oth"          =>      "application/vnd.oasis.opendocument.text-web",

# make the default mime type application/octet-stream.
  ""              =>      "application/octet-stream",
) 
```

### 参考

[lighthttpd 中 AddType 的替代方案](https://stackoverflow.com/questions/25702092/alternative-of-addtype-in-lighthttpd/65063503#65063503)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-01-22T13:12:32.457

我也遇到了与 chrome 相同的问题，添加后`DOCTYPE`按预期工作

```
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"> 
```

**前**

```
 <?xml version="1.0" encoding="iso-8859-1"?>
<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
     width="792px" height="792px" viewBox="0 0 792 792" style="enable-background:new 0 0 792 792;" xml:space="preserve">
    <g fill="none" stroke="black" stroke-width="15">
  ......
  ......
  .......
  </g>
</svg> 
```

**后**

```
 <?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
     width="792px" height="792px" viewBox="0 0 792 792" style="enable-background:new 0 0 792 792;" xml:space="preserve">
    <g fill="none" stroke="black" stroke-width="15">
  ......
  ......
  .......
  </g>
</svg> 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2019-06-03T06:28:25.190

在出现问题时，请先尝试使用能够读取 svg-images 的程序打开图像。
如果失败，则 svg-image 以某种方式损坏。

我遇到了这种情况，并将 svg-paths 复制到了一个新的 svg-image 中，并调整了 svg-tags 的所有细节。

我从未测试过它不渲染的原因，但假设一些不可见的特殊标志导致了渲染错误。有时在 Mac 上编辑文件我已经在其他情况下遇到了这个问题。

# openerp - 如何将openerp与财务打印机连接

> ID：10737167
> 
> 赞同：0
> 
> 时间：2012-05-24T12:04:22.647
> 
> 标签：openerp, printers, receipt

我已经安装了 OpenERP 6.1 软件，现在我想将它连接到一台财务打印机。我从财务打印机的供应商那里获得了一些文件，它们是 .dll 文件。财务打印机应通过串行端口进行通信。根据供应商，这些文件应包含在正在构建的程序的源代码中。这些文件是 .net 文件。程序有什么方法可以在不使用这些 .dll 文件的情况下与财务打印机进行通信？

任何关于如何集成打印机和程序的想法都将受到高度赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T20:59:02.740

根据您要在该打印机上打印的内容，您可以尝试以下操作：

*   编写一个监视文本文件目录的 .NET 服务。将文件写入目录时，打印其内容并删除该文件。然后当你想打印一些东西时，让 OpenERP 将文件写入那个目录。
*   使用一些互操作工具直接从 Python 到 .NET 进行通信。我没有使用过它，但是[用于 .NET 的 Python](http://pythonnet.sourceforge.net/)听起来很有希望。您还可以尝试一些[COM 互操作](http://www.aspose.com/docs/display/cellsnet/Python+via+COM+Interop)并为那些通过 COM 公开它们的库编写一个包装器。
*   弄清楚打印机的实际接口是什么，然后从 Python 写入串行端口。
*   将打印机配置为常规 Windows 打印机，然后打印 OpenERP 为报告生成的常规 PDF。我不确定您的打印机是否可以这样做。

# c# - Linq（到实体）序列化为 XElement（带有连接和分组依据）

> ID：10737168
> 
> 赞同：-1
> 
> 时间：2012-05-24T12:04:25.160
> 
> 标签：c#, xml, linq

我正在做的是使用 Linq 查询数据库到实体以构建 xml 文档。在我使用带有“for xml”子句的存储过程和使用 xmlreader 之前，但现在我试图坚持只使用一种模型来查询数据库，Linq to Entities。

现在下面的代码是我能提供的最好的代码，但我真的很讨厌我找不到更好的解决方案来一次构建 XML，而不必先查询数据库，然后迭代创建 XElements。我无法直接在选择中创建 XElements，因为该类没有无参数的创建者，而且据我所知，Linq 中没有 ToXElement()。

以前做过类似事情的人对如何做到这一点有更好的想法吗？

```
 var bus = from bs in db.mela_buddies_store
              join mu in db.mela_users on bs.buddyId equals mu.userid
              join mup in db.mela_users_picnames on mu.userid equals mup.userid into pics
              from up in pics.DefaultIfEmpty()
              join bc in db.mela_buddies_store on mu.userid equals bc.buddyId into cntr
              from hm in cntr.DefaultIfEmpty()
              where bs.userId == lu.guid
              group bs by new
              {
                id = bs.ID,
                displayname = mu.displayname,
                gender = mu.gender,
                picname = up.picname
              }
              into final
              select new {
                id = final.Key.id,
                displayname = final.Key.displayname,
                gender = final.Key.gender,
                picname = final.Key.picname,
                hm = final.Count()
              };

    XElement xe = new XElement("buddies",
      new XElement("userid", lu.userid),
      bus.ToList().Select(bs =>
        new XElement("buddy",
          new XElement("id", bs.id),
          new XElement("displayname", bs.displayname),
          new XElement("gender", bs.gender),
          new XElement("picname", bs.picname),
          new XElement("hm", bs.hm)
          ))); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T13:53:51.007

XElement 构造函数可以接受 IEnumerable，所以我只需将查询作为参数放入。北风数据库产品表的示例，它也应该适用于更复杂的查询。

```
var xml = new XElement("products",
    from prod in ctx.Products.ToList()
    select new XElement("product", 
        new XElement("id", prod.ProductID),
        new XElement("name", prod.ProductName) 
        )
    ); 
```

更新：似乎加入和分组也可以。我按供应商对产品进行了分组。

```
var xml = new XElement("suppliers",
    (from prod in ctx.Products
     join supp in ctx.Suppliers on prod.SupplierID equals supp.SupplierID
     group prod by new { id = prod.SupplierID, name = supp.CompanyName }).ToList()
     .Select(xe => new XElement("supplier",
             new XElement("id", xe.Key.id),
             new XElement("name", xe.Key.name),
             new XElement("count", xe.Count())
             )
         )
    ); 
```

# sql-server-2008 - 用于重复事件的 CTE MS SQL 查询

> ID：10737170
> 
> 赞同：1
> 
> 时间：2012-05-24T12:04:39.683
> 
> 标签：sql-server-2008, fullcalendar, webforms, common-table-expression

我一直在寻找几天来解决我的 Fullcalender 上重复事件的问题。我最简单的方法可能是根据存储在表中的数据生成重复日期。

我过去没有使用过 CTE 查询。我需要的是为天生成重复日期示例

每个星期一和星期四，我们都会在办公室举行项目会议。在这种情况下，我将设置开始日期 = 2012-06-04 结束日期 = 2012-06-31

现在我想生成 SQL 查询，它将显示从 2012 年 6 月 4 日到 2012 年 8 月 31 日的所有日期，基于它们是否重复发生

```
EventID     Date          Title
1          2012-06-04     Project Meeting
1          2012-06-07     Project Meeting
1          2012-06-11     Project Meeting
1          2012-06-14     Project Meeting
1          2012-06-18     Project Meeting
1          2012-06-21     Project Meeting
1          2012-06-25     Project Meeting
1          2012-06-18     Project Meeting
2          2012-05-13     Meeting With Client
3          2012-06-25     Event 3 
```

我能够理解我如何能够做到这一点，我将不胜感激这方面的帮助或指出类似的例子。如果我能够正确生成此数据，那么我可以将这些日期与 eventTitle 一起发送到 FullCalender 控件以显示事件日历，如下面的示例所示[http://arshaw.com/fullcalendar/](http://arshaw.com/fullcalendar/)

如果有人愿意帮助他可以从下面的 sql 创建表和示例数据。这是 MS SQL SERVER 2008 r2 兼容的，因为我使用了仅受 MS SQL 2008 支持的数据类型

**带有数据的架构**

```
/****** Object:  Table [dbo].[EventCalender]    Script Date: 05/24/2012 20:18:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[EventCalender](
    [EventID] [int] IDENTITY(1,1) NOT NULL,
    [EventTitle] [nvarchar](900) NULL,
    [EventDetails] [nvarchar](max) NULL,
    [EventStartDate] [date] NOT NULL,
    [EventEndDate] [date] NULL,
    [EventStartTime] [time](0) NULL,
    [EventEndTime] [time](0) NULL,
    [EventRecurring] [bit] NULL,
    [EventEnumDays] [varchar](50) NULL,
    [EventBlockDate] [bit] NULL,
    [EventVisibleOnWebsite] [bit] NULL,
    [EventActive] [bit] NULL,
    [EventType] [nvarchar](200) NULL,
    [LanguageID] [int] NOT NULL,
    [EventCreatedOn] [date] NULL,
    [EventShowTime] [bit] NULL
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
SET IDENTITY_INSERT [dbo].[EventCalender] ON
INSERT [dbo].[EventCalender] ([EventID], [EventTitle], [EventDetails], [EventStartDate], [EventEndDate], [EventStartTime], [EventEndTime], [EventRecurring], [EventEnumDays], [EventBlockDate], [EventVisibleOnWebsite], [EventActive], [EventType], [LanguageID], [EventCreatedOn], [EventShowTime]) VALUES (1, N'Project Meeting', N'Every Monday, Thrusday', CAST(0xC1350B00 AS Date), CAST(0x19360B00 AS Date), CAST(0x00A08C0000000000 AS Time), CAST(0x00B8A10000000000 AS Time), 1, N'2,5,7', 0, 0, 1, N'EVENT', 1, CAST(0xB6350B00 AS Date), NULL)
INSERT [dbo].[EventCalender] ([EventID], [EventTitle], [EventDetails], [EventStartDate], [EventEndDate], [EventStartTime], [EventEndTime], [EventRecurring], [EventEnumDays], [EventBlockDate], [EventVisibleOnWebsite], [EventActive], [EventType], [LanguageID], [EventCreatedOn], [EventShowTime]) VALUES (2, N'Meeting With Client', N'Event Details 2', CAST(0xBA350B00 AS Date), CAST(0xBA350B00 AS Date), NULL, NULL, 0, NULL, 0, 0, 1, N'EVENT', 1, CAST(0xB6350B00 AS Date), NULL)
INSERT [dbo].[EventCalender] ([EventID], [EventTitle], [EventDetails], [EventStartDate], [EventEndDate], [EventStartTime], [EventEndTime], [EventRecurring], [EventEnumDays], [EventBlockDate], [EventVisibleOnWebsite], [EventActive], [EventType], [LanguageID], [EventCreatedOn], [EventShowTime]) VALUES (3, N'Event 3', N'Event Details 3', CAST(0xAB350B00 AS Date), CAST(0xAB350B00 AS Date), NULL, NULL, 0, NULL, 0, 0, 0, N'EVENT', 1, CAST(0xB6350B00 AS Date), 0)
INSERT [dbo].[EventCalender] ([EventID], [EventTitle], [EventDetails], [EventStartDate], [EventEndDate], [EventStartTime], [EventEndTime], [EventRecurring], [EventEnumDays], [EventBlockDate], [EventVisibleOnWebsite], [EventActive], [EventType], [LanguageID], [EventCreatedOn], [EventShowTime]) VALUES (5, N'Weekly Meeting', N'Weekly Event', CAST(0xA3350B00 AS Date), CAST(0x01380B00 AS Date), CAST(0x00D0B60000000000 AS Time), NULL, 1, N'2,', 0, 1, 1, N'ACTIVITY', 2, NULL, 0)
SET IDENTITY_INSERT [dbo].[EventCalender] OFF
/****** Object:  Default [DF_EventCalender_EventEndDate]    Script Date: 05/24/2012 20:18:00 ******/
ALTER TABLE [dbo].[EventCalender] ADD  CONSTRAINT [DF_EventCalender_EventEndDate]  DEFAULT (NULL) FOR [EventEndDate]
GO
/****** Object:  Default [DF_EventCalender_EventStartTime]    Script Date: 05/24/2012 20:18:00 ******/
ALTER TABLE [dbo].[EventCalender] ADD  CONSTRAINT [DF_EventCalender_EventStartTime]  DEFAULT (NULL) FOR [EventStartTime]
GO
/****** Object:  Default [DF_EventCalender_EventEndTime]    Script Date: 05/24/2012 20:18:00 ******/
ALTER TABLE [dbo].[EventCalender] ADD  CONSTRAINT [DF_EventCalender_EventEndTime]  DEFAULT (NULL) FOR [EventEndTime]
GO
/****** Object:  Default [DF_EventCalender_EventRecurring]    Script Date: 05/24/2012 20:18:00 ******/
ALTER TABLE [dbo].[EventCalender] ADD  CONSTRAINT [DF_EventCalender_EventRecurring]  DEFAULT ((0)) FOR [EventRecurring]
GO
/****** Object:  Default [DF_EventCalender_EventEnumDays]    Script Date: 05/24/2012 20:18:00 ******/
ALTER TABLE [dbo].[EventCalender] ADD  CONSTRAINT [DF_EventCalender_EventEnumDays]  DEFAULT (NULL) FOR [EventEnumDays]
GO
/****** Object:  Default [DF_EventCalender_EventBlockDate]    Script Date: 05/24/2012 20:18:00 ******/
ALTER TABLE [dbo].[EventCalender] ADD  CONSTRAINT [DF_EventCalender_EventBlockDate]  DEFAULT ((0)) FOR [EventBlockDate]
GO
/****** Object:  Default [DF_EventCalender_EventVisibleOnWebsite]    Script Date: 05/24/2012 20:18:00 ******/
ALTER TABLE [dbo].[EventCalender] ADD  CONSTRAINT [DF_EventCalender_EventVisibleOnWebsite]  DEFAULT ((0)) FOR [EventVisibleOnWebsite]
GO
/****** Object:  Default [DF_EventCalender_EventActive]    Script Date: 05/24/2012 20:18:00 ******/
ALTER TABLE [dbo].[EventCalender] ADD  CONSTRAINT [DF_EventCalender_EventActive]  DEFAULT ((0)) FOR [EventActive]
GO
/****** Object:  Default [DF_EventCalender_EventShowTime]    Script Date: 05/24/2012 20:18:00 ******/
ALTER TABLE [dbo].[EventCalender] ADD  CONSTRAINT [DF_EventCalender_EventShowTime]  DEFAULT ((0)) FOR [EventShowTime]
GO 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:52:43.370

这可以为您提供如何使用 CTE 创建重复日期的起点：

```
;with Dates as (
    select cast('2012-06-04' as date) as StartDate, cast('2012-08-31' as date) as EndDate
),
RecursiveCTE as (
    select StartDate, EndDate, StartDate as EventDate
    from Dates
    union all
    select StartDate, EndDate, dateadd(dd, 7, EventDate)
    from RecursiveCTE
    where dateadd(dd, 7, EventDate) < Enddate
)
select * from RecursiveCTE 
```

**更新**

使用您的模式和插入，这是一个递归 CTE，它给出了所需的结果：

```
;with Calendar as (
    select EventID, EventTitle, EventStartDate, EventEndDate, EventEnumDays, EventRecurring, EventStartDate as PlannedDate
    from EventCalender
    where EventActive = 1
    union all
    select EventID, EventTitle, EventStartDate, EventEndDate, EventEnumDays, EventRecurring, dateadd(dd, 1, PlannedDate)
    from Calendar
    where EventRecurring = 1
        and dateadd(dd, 1, PlannedDate) <= EventEndDate
)
select EventID, PlannedDate as [Date], EventTitle
from Calendar
where ',' + EventEnumDays + ',' like '%,' + cast(datepart(dw, PlannedDate) as char(1)) + ',%'
    or EventEnumDays is null
order by EventID, PlannedDate
option (maxrecursion 0) 
```

请注意，如果您想包含每月或每年的事件，则必须进行一些修改（可能是案例/切换），因为我在这里依靠“星期几”（dw）来获取每周的内容。

此外，递归 CTE 可能是[最慢的计数方法之一](http://www.sqlservercentral.com/articles/T-SQL/74118/)，这基本上就是我们在这里所做的。如果速度是最重要的，那么[计数表](http://www.sqlservercentral.com/articles/T-SQL/62867/)可能是更好的选择。

# struts - Struts 如何在 bean:message 参数中插入 bean:write

> ID：10737193
> 
> 赞同：2
> 
> 时间：2012-05-24T12:05:57.770
> 
> 标签：struts

我尝试这样做，但它不起作用。

```
<logic:present name="MEMBER" >
<bean:message key="member.registerConfirmation" arg0='<bean:write name="MEMBRE_REGISTER" property="firstname"/>' arg1='<bean:write name="MEMBRE_REGISTER" property="lastname"/>'/>
</logic:present> 
```

和 bean:message 包含：

```
member.registerConfirmation = Congratulations {0} {1}, you are in ! 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T12:49:52.460

用 bean 试试 EL:message

像这样的东西。

```
<bean:message key="member.registerConfirmation" arg0='${MEMBRE_REGISTER.firstname}' arg1='${MEMBRE_REGISTER.lastname}'/> 
```

# sql - 在 CRM 2011 中导入 CRM4.0 组织时出错...为什么会失败？？...

> ID：10737196
> 
> 赞同：0
> 
> 时间：2012-05-24T12:06:09.383
> 
> 标签：sql, sql-server-2008, dynamics-crm, dynamics-crm-2011, dynamics-crm-4

CRM 2011 Server 和 SQL Server 2008 R2（在同一台机器上运行）...安装了带有报告扩展的 CRM 2011。当我尝试通过 CRM 2011 部署管理器导入 CRM 4.0 数据库时，它失败了。我映射所有用户和验证屏幕通过警告且没有错误...为什么它会失败有人可以指出我查看日志的正确方向。

没过多久就失败了...|我在失败前复制了日志中最频繁的行...

非常感谢您的帮助...

> 信息| 升级 MSCRM 数据库中的视图
> 
> 信息| CrmAction 执行时间；升级数据库动作；00:21:23.6584839
> 
> | 错误| 安装程序完成：OrganizationUpgrader - 遇到错误
> 
> |错误| Microsoft.Crm.Tools.Admin.OrganizationUpgrader 期间发生异常：
> 
> 操作 Microsoft.Crm.Tools.Admin.UpgradeDatabaseAction 失败。InnerException：System.Reflection.TargetInvocationException：调用的目标已引发异常。---> Microsoft.Crm.CrmException：SqlException：列名“New_name”无效。列名“New_Details”无效。列名“New_Test”无效。，查看脚本：如果存在（从 sysobjects 中选择 *，其中 name = 'New_action' 和 xtype = 'V'）开始放置视图 [New_action] end go
> 
> ……………………
> 
> System.Data.SqlClient.SqlException：列名无效

谁能帮我解决这个问题

提前致谢

普拉约什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:08:20.437

我找到了解决方案 - 我手动添加了缺失的列

# java - 如何在已关闭的 ScheduledExecutorService 中保持线程等待

> ID：10737198
> 
> 赞同：5
> 
> 时间：2012-05-24T12:06:26.887
> 
> 标签：java, multithreading, executorservice

```
public ScheduledFuture<?> executeTaskWithDelay(String name, 
      final Runnable runnable, Period delay, boolean isDaemon) {
  ScheduledExecutorService executorService = 
        Executors.newSingleThreadScheduledExecutor(new DefaultThreadFactory(
          name, isDaemon));
  ScheduledFuture<?> future =  executorService.schedule(runnable, 
        delay.toStandardDuration().getMillis(), TimeUnit.MILLISECONDS);
  executorService.shutdown(); 
  return future;
} 
```

当我分析应用程序时，我注意到此方法创建的计划线程在执行之前始终处于“正在运行”而不是“等待”状态。如果我删除 executorService.shutdown() 它会做我想要的（即线程保持等待状态，直到它们运行的​​时间）。但是，如果没有 executorService.shutdown()，非守护线程在执行后永远不会被垃圾回收。有没有办法可以确保线程在执行前始终处于等待状态？或者我可以为这种方法使用什么其他替代品来确保：

*   我可以将前缀附加到在执行程序服务中运行的线程的名称（这实际上是 DefaultThreadFactory 实现所做的）
*   非守护线程在执行后获得 GC。
*   创建的线程保持等待状态，直到它们运行的​​时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T13:14:25.857

线程没有等待，因为您没有调用 future.get() 方法。我做了一个单元测试来证明这一点。

测试 #1（不调用 future.get() 方法）：

```
@Test
public void testSchedule() throws InterruptedException, ExecutionException {

    ScheduledExecutorService executorService = Executors.newSingleThreadScheduledExecutor();
    System.out.println(new Date());
    ScheduledFuture<?> future =  executorService.schedule(new Runnable() {

        public void run() {
            System.out.println(Thread.currentThread().getId() + " - " + Thread.currentThread().getName() + " - Executing thread...");                
        }

    }, 5, TimeUnit.SECONDS);

    //System.out.println("future : " + future.get());

    executorService.shutdown();
    System.out.println(new Date());
} 
```

输出是：

```
Thu May 24 10:11:14 BRT 2012
Thu May 24 10:11:14 BRT 2012 
```

测试 #2（调用 future.get() 方法）：

```
@Test
public void testSchedule() throws InterruptedException, ExecutionException {

    ScheduledExecutorService executorService = Executors.newSingleThreadScheduledExecutor();
    System.out.println(new Date());
    ScheduledFuture<?> future =  executorService.schedule(new Runnable() {

        public void run() {
            System.out.println(Thread.currentThread().getId() + " - " + Thread.currentThread().getName() + " - Executing thread...");                
        }

    }, 5, TimeUnit.SECONDS);

    System.out.println("future : " + future.get());

    executorService.shutdown();
    System.out.println(new Date());
} 
```

输出是：

```
Thu May 24 10:12:48 BRT 2012
8 - pool-1-thread-1 - Executing thread...
future : null
Thu May 24 10:12:53 BRT 2012 
```

我希望它对你有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T12:49:52.170

您所看到的是 ScheduledExecutor 委托给普通的 ThreadPoolExecutor 以实现关闭功能。关闭 TPE 时，它的所有线程都会在后备工作队列上旋转，直到它为空。好吧，ScheduledThreadPool 使用了一个可能不为空的 DelayedQueue，但如果你轮询它，你会得到一个空值，因为任务还没有准备好调度。它会不停地旋转，直到它准备好

你唯一能做的就是 shutdownNow 并执行以其他方式返回的任务。

我也被告知这实际上是在 Java 7 中修复的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T19:27:09.993

**想出了一个解决方案：**它是 shutdown() 将所有待处理任务线程的状态从“等待”更改为“运行”。我现在不是立即调用shutdown()，而是使用executorService 来安排调用它自己的shutdown()。这可以确保待处理的任务尽可能长时间地保持在等待状态——从而节省 CPU 资源。

```
public ScheduledFuture<?> executeTaskWithDelay(String name, 
      final Runnable runnable, Period delay, boolean isDaemon) {
  final ScheduledExecutorService executorService =  
        Executors.newSingleThreadScheduledExecutor(new DefaultThreadFactory(
      name, isDaemon));
  ScheduledFuture<?> future =  executorService.schedule(runnable, 
        delay.toStandardDuration().getMillis(), TimeUnit.MILLISECONDS);

  executorService.schedule(new Runnable() {
      @Override
      public void run() {
        executorService.shutdown();
      }}, delay.toStandardDuration().getMillis(), TimeUnit.MILLISECONDS);

  return future;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T12:34:47.580

运行你的代码。这是来自 jvisualvm 中的线程转储（我将线程命名为“bla”）：

```
"bla" prio=5 tid=7fa2bc16a000 nid=0x10bd53000 runnable [10bd52000]
  java.lang.Thread.State: RUNNABLE
  at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:950)
  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907)
  at java.lang.Thread.run(Thread.java:680)

  Locked ownable synchronizers:
    - None 
```

现在，这是来自 grepcode 的`ThreadPoolExecutor.java:950`：

```
944         // It is possible (but unlikely) for a thread to have been
945         // added to workers, but not yet started, during transition to
946         // STOP, which could result in a rare missed interrupt,
947         // because Thread.interrupt is not guaranteed to have any effect
948         // on a non-yet-started Thread (see Thread#interrupt).
949         if (runStateOf(ctl.get()) == STOP && ! t.isInterrupted())
950             t.interrupt(); 
```

这使我得出结论，问题出在您的测试代码中——您关闭执行程序的速度太快，线程发现自己处于奇怪的状态。这不应该是生产代码中的问题。

# ruby-on-rails - 如何拯救 OmniAuth::Strategies::OAuth2::CallbackError？

> ID：10737200
> 
> 赞同：42
> 
> 时间：2012-05-24T12:06:40.057
> 
> 标签：ruby-on-rails, ruby-on-rails-3, callback, oauth-2.0, omniauth

我正在使用[Omniauth](https://github.com/intridea/omniauth)构建 Rails 应用程序以进行登录服务。要对 Google 进行身份验证，我正在使用[OmniAuth Google OAuth2 Strategy](https://github.com/zquestz/omniauth-google-oauth2)。

当用户单击“允许访问”按钮时，一切正常。但是当用户单击“不，谢谢”按钮时，会引发以下错误。

```
OmniAuth::Strategies::OAuth2::CallbackError 
```

我尝试在应用程序控制器中添加以下救援代码。

```
class ApplicationController < ActionController::Base
  rescue_from OmniAuth::Strategies::OAuth2::CallbackError, :with =>
    :omniauth_callback_error_handler

 protected

 def omniauth_callback_error_handler
  redirect_to init_sign_in_users_path
 end
end 
```

但没有运气。任何的想法？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-06-29T05:35:37.760

您可以在omniauth 初始化程序中以更简洁的方式设置on_failure proc：

```
OmniAuth.config.on_failure = UsersController.action(:oauth_failure) 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-05-24T12:43:59.150

发生这种情况是因为身份验证发生在中间件中，因此您的控制器不参与其中。这是[引发异常的地方，被](https://github.com/intridea/omniauth-oauth2/blob/master/lib/omniauth/strategies/oauth2.rb#L66)调用的代码是[这个](https://github.com/intridea/omniauth/blob/master/lib/omniauth/strategy.rb#L446)

我认为您可以通过使用此类代码在 OmniAuth 初始化程序中定义回调来处理此类错误

```
OmniAuth.config do |config|
  config.on_failure do
    # your handling code invoked in the context of a rack app
  end
end 
```

否则三个月前[的提交会引入这种行为](https://github.com/intridea/omniauth/commit/d02f9d58f70f132c856199470f94b93c852d9bb0#L3R2)

```
def redirect_to_failure
  message_key = env['omniauth.error.type']
  new_path = "#{env['SCRIPT_NAME']}#{OmniAuth.config.path_prefix}/failure?message=#{message_key}"
  Rack::Response.new(["302 Moved"], 302, 'Location' => new_path).finish
end 
```

这表明在错误时您的用户会被重定向到`/auth/failure`错误消息，因此您应该能够为该路径定义路由并在您的应用程序中处理它。请记住，这不会[在开发模式下](https://github.com/intridea/omniauth/blob/d02f9d58f70f132c856199470f94b93c852d9bb0/lib/omniauth/failure_endpoint.rb)发生，因此您需要在其他环境中尝试。如果这在生产中没有发生，请尝试将您的 omniauth gem 升级到版本 1.1.0

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-05-24T18:36:07.117

我已经用 Fabio 的第一个建议解决了这个问题。

```
OmniAuth.config.on_failure = Proc.new do |env|
  UsersController.action(:omniauth_failure).call(env)
  #this will invoke the omniauth_failure action in UsersController.
end 
```

在我的用户控制器中

```
class UsersController < ActionController::Base
  def omniauth_failure
    redirect_to init_sign_in_users_path
    #redirect wherever you want.
  end
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-15T07:43:12.547

有一个配置可以使用`/auth/failure`，而不是引发错误。

我使用 OmniAuth 1.2.2，当我检查 FailureEndpoint 时，我发现代码是这样[的](https://github.com/intridea/omniauth/blob/master/lib/omniauth/failure_endpoint.rb#L20)：

```
def call
  raise_out! if OmniAuth.config.failure_raise_out_environments.include?(ENV['RACK_ENV'].to_s)
  redirect_to_failure
end 
```

并在[此处](https://github.com/intridea/omniauth/blob/master/lib/omniauth.rb#L37)`failure_raise_out_environments`定义：

```
def self.defaults
  @defaults ||= {
    # other configurations
    :failure_raise_out_environments => ['development']
  }
end 
```

可以配置环境，因此解决方案很简单。我使用 Rails，所以我把下面的代码放在一个初始化文件中：

```
OmniAuth.configure do |config|
  # Always use /auth/failure in any environment
  config.failure_raise_out_environments = []
end 
```

# http - 如何处理 REST 中的陈旧数据？

> ID：10737203
> 
> 赞同：7
> 
> 时间：2012-05-24T12:06:42.193
> 
> 标签：http, rest, restful-architecture, httpverbs

例如，如果我调用 GET 来获取一个项目，用 DELETE 删除它并再次 GET，那么第二个 GET 应该如何工作？

我的意思是，通过正确遵循 REST 原则，这样做的正确方法是什么，因为 GET 可以被缓存等等？在 REST 中处理陈旧数据的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T16:12:55.320

首先，行为取决于 DELETE 调用作为其响应代码返回的内容。

如果 DELETE 返回`200 - OK`，或者`204 - No Content`客户端应该继续`404 - Not Found`下一次调用 GET。那是因为 202 和 204 意味着资源被立即删除。

但是，如果 DELETE 返回`202 - Accepted`，则客户端有可能在之后的一段时间内成功获取资源。那是因为 202 表示该资源已被标记为删除，但不一定立即清理。

其次，如果涉及缓存，则应构建行为以与不存在缓存时会发生的情况保持一致。成功的 DELETE 应始终导致从数据的真实来源以及任何缓存副本中删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T15:58:58.837

如最初所述，DELETE 之后的 GET 应该产生 HTTP 404 错误，而不管可能存在的缓存。逻辑代码应该足够聪明，可以从持久存储以及内存存储或缓存中删除记录。此外，UI 应该能够使用您认为合适的任何流程或过程来处理 404 的结果。

# c - 在 CDT 之外使用 Eclipse CDT 解析器

> ID：10737205
> 
> 赞同：9
> 
> 时间：2012-05-24T12:06:54.793
> 
> 标签：c, eclipse, parsing, eclipse-cdt

是否可以在 Eclipse 之外使用 Eclipse 的 CDT 解析器来离线分析 C 源代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:28:36.930

如果您不限制使用 Eclipse CDT，我建议您使用 clang/llvm。它是一个相当年轻的编译器和代码分析器，但它具有良好的性能。

[1] [http://clang.llvm.org/](http://clang.llvm.org/) [2] [http://en.wikipedia.org/wiki/Clang](http://en.wikipedia.org/wiki/Clang)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T11:52:57.180

是的，有可能。

我在一个名为[CPAchecker](http://cpachecker.sosy-lab.org)的项目中工作，它正是这样做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T01:26:35.967

您可以将 eclipse CDT 解析器设置为服务。然后您可以将您的 C 代码传递给它并分析代码。我也做过类似的事情，只是我改用 jdt。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T11:16:30.293

根据您的具体情况，您可以查看 Eclim 和/或其实现。它运行一个无头 Eclipse 并使用 vim 编辑器连接到它。显然它还支持其他前端。似乎支持 C/C++-项目：http: [//eclim.org/vim/c/project.html](http://eclim.org/vim/c/project.html)

否则，我会选择@Dodon Victor 并推荐 clang/llvm。

# shell - shell - cat - 将文件内容合并为一个大文件

> ID：10737207
> 
> 赞同：12
> 
> 时间：2012-05-24T12:06:59.257
> 
> 标签：shell, cat

我正在尝试使用 bash 将文件列表（超过 1K）的内容合并到一个大文件中。

我试过以下 cat 命令：

```
cat * >> bigfile.txt 
```

但是这个命令所做的是合并所有内容，包括已经合并的内容。

例如 file1.txt

```
content1 
```

文件2.txt

```
content2 
```

文件 3.txt

```
content3 
```

文件4.txt

```
content4 
```

大文件.txt

```
content1
content2
content3
content2
content3
content4
content2 
```

但我只想

```
content1
content2
content3
content4 
```

在 .txt 文件中

另一种方式是`cat file1.txt file2.txt ...`等等......但我不能为超过 1k 个文件执行此操作！

谢谢您的支持！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-24T12:10:40.670

问题是您放在`bigfile`同一个目录中，因此使其成为`*`. 所以像

```
cat dir/* > bigfile 
```

应该按照您的意愿工作，您的`fileN.txt`文件位于`dir/`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T12:30:39.897

在重新阅读您的问题时，您似乎希望将数据附加到`bigfile.txt`，但不添加重复项。您必须通过所有内容`sort -u`以过滤掉重复项：

```
sort -u * -o bigfile.txt 
```

`-o`排序选项允许您在文件被输出覆盖之前安全地将 的内容包含在`bigfile.txt`输入中以进行排序。

编辑：假设 bigfile.txt 已排序，您可以尝试一个两阶段的过程：

```
sort -u file*.txt | sort -um - bigfile.txt -o bigfile.txt 
```

首先，我们对输入文件进行排序，删除重复项。我们将该输出通过管道传输到另一个`sort -u`进程，这个进程`-m`也使用选项，它告诉`sort`合并两个先前排序的文件。我们将合并的两个文件是`-`（标准输入，来自第一个的流`sort`）和`bigfile.txt`它本身。我们再次使用该选项允许我们在将输出作为输入读取后将`-o`其写回。`bigfile.txt`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-24T12:43:00.340

您可以将输出文件保存在同一目录中，您只需比以下内容更复杂一点`*`：

```
shopt -s extglob
cat !(bigfile.txt) > bigfile.txt 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-24T12:44:43.890

> 另一种方法是 cat file1.txt file2.txt ...等等...但我不能为超过 1k 个文件执行此操作！

这就是 xargs 的用途：

```
find . -maxdepth 1 -type f -name "file*.txt" -print0 | xargs -0 cat > bigfile.txt 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-07T17:52:49.667

这是一个老问题，但我仍然会给出另一种方法`xargs`

1.  列出要连接的文件

    > ls | grep [模式] > 文件列表

2.  使用 或 检查您的文件的顺序是否`vi`正确`cat`。如果你使用后缀 (1, 2, 3, ..., N) 这应该没问题

3.  创建最终文件

    > 猫文件列表 | xargs 猫 >> [最终文件]

4.  删除文件列表

    > rm -f 文件列表

希望这对任何人都有帮助

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-05-24T12:12:37.410

尝试：

```
cat `ls -1 *` >> bigfile.txt 
```

我目前没有方便的 unix 机器来先为您测试它。

# nunit - Assert.AreEqual 不在 IEnumerable 实现上使用我的 .Equals 覆盖

> ID：10737209
> 
> 赞同：19
> 
> 时间：2012-05-24T12:07:03.493
> 
> 标签：nunit, ienumerable, assert

我有一个 PagedModel 类，它实现 IEnumerable 只返回 ModelData，忽略分页数据。我还重写了 Equals 和 GetHashCode，以允许通过它们的 ModelData、PageNumber、TotalPages 和 PageSize 来比较两个 PagedModel 对象。

这就是问题所在

```
Dim p1 As New PagedModel() With {
    .PageNumber = 1,
    .PageSize = 10,
    .TotalPages = 10,
    .ModelData = GetModelData()
}

Dim p2 As New PagedModel() With {
    .PageNumber = 1,
    .PageSize = 10,
    .TotalPages = 10,
    .ModelData = GetModelData()
}

p1.Equals(p2) =====> True
Assert.AreEqual(p1, p2) ======> False! 
```

看起来 NUnit 正在调用它的内部 EnumerableEqual 方法来比较我的 PagedModel，而不是使用我提供的 Equals 方法！有什么方法可以覆盖这种行为，还是我必须编写一个自定义断言。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-29T22:05:28.927

**按照您的要求做**：我建议您不要这样做，但如果您真的不喜欢 NUnit 的行为并且想要自定义断言，您可以提供自己的 EqualityComparer。

```
Assert.That(p1, Is.EqualTo(p2).Using(myCustomEqualityComparer)); 
```

**你应该做什么（简短的回答）**：你需要 GetHashCode 和等于 ModelData 而不是 PagedModel 因为你使用 PagedModel 作为集合和 ModelData 作为元素。

**你应该做什么（长答案）**：你需要在 ModelData 上实现[IEquatable<T> ，而不是在 PagedModel 上覆盖](http://msdn.microsoft.com/en-us/library/ms131187.aspx)[Equals(object)](http://msdn.microsoft.com/en-us/library/system.object.equals.aspx)，其中 T 是 IEnumerable 的类型参数，以及覆盖[GetHashCode()](http://msdn.microsoft.com/en-us/library/system.object.gethashcode.aspx)。[这两种方法是 .Net 中的所有 IEnumerable 方法在使用Default Equality Comparer](http://msdn.microsoft.com/en-us/library/ms224763.aspx)（您不指定自己的[IEqualityComparer](http://msdn.microsoft.com/en-us/library/ms132151.aspx) ）时用来确定相等性（用于 Union、Distinct 等操作）的方法。

> [Default EqualityComparer] 检查类型 T 是否实现了 System.IEquatable 接口，如果是，则返回使用该实现的 EqualityComparer。否则，它返回一个使用 T 提供的 Object.Equals 和 Object.GetHashCode 覆盖的 EqualityComparer。

为了正常运行，GetHashCode 需要为所有为 .Equals(T) 返回 true 的对象返回相同的结果。反过来不一定正确 - GetHashCode 可以返回不相等对象的冲突。[更多信息请参见 Marc Gravel 接受的答案](https://stackoverflow.com/questions/371328/why-is-it-important-to-override-gethashcode-when-equals-method-is-overriden-in-c)。我还发现 GetHashCode 在那个答案中使用素数的实现非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-10T21:42:47.453

如果你看一下[GIT repo中 NUnit 相等比较器的实现，你会看到有一个用于两个枚举的专用](https://github.com/nunit/nunit/blob/2.9.7/src/framework/Constraints/NUnitEqualityComparer.cs#L167-L169)[比较](https://github.com/nunit/nunit/blob/2.9.7/src/framework/Constraints/NUnitEqualityComparer.cs#L201-L206)块，它的优先级高于使用您在类中实现或重载的`IEquatable<T>`接口或方法。`Object.Equals(Object)``PagedModel`

我不知道这是一个错误还是一个特性，但您可能应该首先问自己，如果`IEnumerable<ModelData>`直接由您的`PagedModel`类实现接口实际上是最好的选择，特别是因为您`PagedModel`不仅仅是`ModelData`实例的枚举。

`ModelData`通过类的简单只读`IEnumerable<ModelData>`属性提供枚举可能就足够了（甚至更好）`PagedModel`。NUnit 将停止将您的`PagedModel`对象视为对象的简单枚举，`ModelData`并且您的单元测试将按预期运行。

唯一的其他选择是 csauve 建议的选择；`IComparer`为您实现一个简单的自定义`PagedModel`并将它的实例提供给您将比较两个`PagedModel`实例的所有断言：

```
internal class PagedModelComparer : System.Collections.IComparer
{
    public static readonly IComparer Instance = new PagedModelComparer();

    private PagedModelComparer()
    {
    }

    public int Compare( object x, object y )
    {
        return x is PagedModel && ((PagedModel)x).Equals( y );
    }
}

    ...
    [Test]
    ...
        Assert.That( actual, Is.EqualTo( expected ).Using( PagedModelComparer.Instance ) );
    ... 
```

但这会使您的测试变得比必要的更复杂，并且每当您为`PagedModel`.

# php - 在外部文件中获取 Kohana 会话变量

> ID：10737218
> 
> 赞同：0
> 
> 时间：2012-05-24T12:08:07.867
> 
> 标签：php, kohana, kohana-3

我有一个 kohana 安装，版本 3.x，并且我已经在使用“本机”驱动程序。

我想在 kohana 控制器中设置一个 $_SESSION 变量，并且能够在一个 external.php 文件中使用它，即在 kohana 安装之外。

我怎样才能在不搞砸 kohana 正在使用的会话的情况下做到这一点？

谢谢。问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:19:26.583

我正在查看 3.2 中的代码，您几乎应该能够通过像平常一样调用它来获取数据。

```
Session::instance()->set('foo', 'bar');

// Should return 'bar'
echo $_SESSION['foo']; 
```

Kohana 的本地驱动程序通过将 Session::$_data 设置为对 $_SESSION 的引用来初始化会话。唯一可能使这种情况变得奇怪的是，如果它以某种我没有看到的方式使用 __toString() ，那么它将在哪里序列化数据。AFAIK，它没有，但这不是我第一次犯错。您可能要检查的唯一一件事是 Kohana 中的会话使用的 cookie 名称，并确保您使用它来获取外部代码的正确 session_id()。

我的问题是您为什么以及如何访问该外部 php 文件？如果需要，您可以将其拉入 Kohana 并与 Kohana 代码一起使用。

# javascript - 使用 Ajax 后没有导航

> ID：10737222
> 
> 赞同：0
> 
> 时间：2012-05-24T12:08:38.447
> 
> 标签：javascript, jquery, ajax, url, cakephp

我正在使用它在加载 3 个页面之前显示加载图像。代码正在运行并显示加载图像，然后再从其他任何地方转到这些页面，然后是这 3 个页面。问题是当我去这些页面并在那里形成时，我点击了 3 个页面的链接之一，它什么也没做。只需在 url 的末尾添加一个 # 即可。

```
 $.ajaxSetup({
            cache: false
                    });

                    //Loading Image.
                    var ajax_load = "<img src='http://d2o0t5hpnwv4c1.cloudfront.net/412_ajaxCalls/DEMO/img/load.gif' alt='loading...' style='top:48%; left:48%; position:relative;'/>";

                    //PHP file URL.
                    var loadUrl = "/cakephp/Posts/index";
                    var loadUrl2 = "/cakephp/Posts/fetchHome";
                    var loadUrl3 = "/cakephp/accounts/getFollowers";

                    //$.get()  
                    $("#dash").click(function(){  
                        $(".container-fluid2").html(ajax_load);  
                        $.get(  
                        loadUrl,  
                        {language: "php", version: 5},  
                        function(responseText){  
                            $(".container-fluid2").html(responseText);
                            history.replaceState(null, "Dashboard", "posts");
                        },  
                        "html"  
                    );  
                    });  
                    $("#home").click(function(){  
                        $(".container-fluid2").html(ajax_load);  
                        $.get(  
                        loadUrl2,
                        {language: "php", version: 5},  
                        function(responseText){  
                            $(".container-fluid2").html(responseText);
                            history.replaceState(null, "Timeline", "posts/fetchHome");
                        },  
                        "html"  
                    );  
                    });  
                    $("#followers").click(function(){  
                        $(".container-fluid2").html(ajax_load);  
                        $.get(  
                        loadUrl3,  
                        {language: "php", version: 5},  
                        function(responseText){  
                            $(".container-fluid2").html(responseText);  
                            history.replaceState(null, "View followers", "accounts/getFollowers");
                        },  
                        "html"  
                    );  
                    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T23:59:02.260

我已经测试了您的代码，并且在添加后一切正常。

```
$(document).ready(function(){
     //your code here
} 
```

document.ready 处理程序在运行前等待页面加载。这很重要，因为以前您可能一直在尝试将事件处理程序添加到尚不存在的对象。

希望这可以帮助。

如果不回复我，我会再看看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T06:53:36.980

解决了！这就是一次又一次地重新加载javascript函数的方式：

```
$(document).on("click", "#dash", function(){ 
                            $(".container-fluid2").html(ajax_load);  
                            $.get(  
                            loadUrl,  
                            {language: "php", version: 5},  
                            function(responseText){  
                                $(".container-fluid2").html(responseText);
                                $("#CancelReply").hide();
                                history.replaceState(null, "Dashboard", "/cakephp/posts");
                                $(document).attr('title','Dashboard');
                            },  
                            "html"  
                        ); 
                        }); 
```

# php - 无需 Javascript 将相同的表单提交到多个位置

> ID：10737223
> 
> 赞同：0
> 
> 时间：2012-05-24T12:08:38.877
> 
> 标签：php, html

在查看了关于 SO 和其他地方的各种类似问题后，我有一种可怕的感觉，我想做的事情是不可能的，但是就这样。

我有一个页面是文本输入行的表格。用户在每一行输入信息，然后将数据提交到一个单独的文件中，从而创建一个 PDF。

问题是我需要用户能够随意向表中添加行，因为数据量可能会有所不同。

*[在你去那里之前，我需要指出我不能使用 Javascript 来做任何事情——我知道在 JS 中很容易做到，但页面需要是可访问的。]*

这是一个非常简化的版本，我只是拼凑起来（希望）说明这一点：

```
<?php 
  if (filter_has_var(INPUT_POST, 'add_rows')) {
    $howmanyrows = filter_input(INPUT_POST, 'howmanyrows', FILTER_SANITIZE_NUMBER_INT);
    //get all the data from table and put it in an array, 
    //then add 5 (or however many) new rows to said array.
  }
  else if (filter_has_var(INPUT_POST, 'send_data')) {
    //get table data, add to session and redirect to other page with a header()
  }
 ?>
<html>
  <form action="" method="POST">
    <table>
      <?php //table rows added using an array of data 
        foreach ($data as $d): ?>
          <tr><td><input type="text" value="<?php echo $d; ?>"></td></tr>
      <?php endforeach; ?>

    </table>
    <input type="text" name="howmanyrows" value="5">
    <input type="submit" name="add_rows">

    <input type="submit" name="send_data">

  </form>
...
</html> 
```

如您所见，目前我有一个笨拙的设置，其中只有一个表单包含整个页面，并将页面提交给自己。根据单击的按钮，添加新行或将数据提交到 PDF 创建页面。

这并不理想，原因有很多。我真正想做的是有两个单独的表格，或嵌套表格。但是前者不允许将输入值提交给两者，而后者显然是错误的形式（没有双关语）并且不起作用。

有没有可能让它做我想做的事情？有什么建议可以采取不同的方式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:22:40.147

我认为你有最好的非 JavaScript 解决方案——当然是我会用它运行的方式。

更容易的一件事是您可以使用多个具有相同名称的输入：

```
<input name="tablerow[]" type="text" value="A" />
<input name="tablerow[]" type="text" value="B" />
<input name="tablerow[]" type="text" value="C" /> 
```

这些通过 $_POST['tablerow'] 作为一个数组。数组的长度是字段的数量。然后向其中添加其他字段。

* * *

对于可访问性，您应该在顶部添加一个链接，允许用户直接跳到第一个“新”字段 - 否则他们需要通过整个表单来跳转到新字段。（请参阅我上面关于 JS 是否真的无法避免的评论，他们可以避免这种情况！）

# javascript - PHP Ajax MySQL 表行删除

> ID：10737229
> 
> 赞同：1
> 
> 时间：2012-05-24T12:09:03.570
> 
> 标签：javascript, php, mysql, ajax, sql-delete

我编写了删除 MySQL 表行的代码。但是当我点击删除图标时，什么也没有发生。有人可以告诉我我的代码中还剩下什么吗？

```
<?php
include_once 'include/DatabaseConnector.php';
$query1="SELECT * FROM MyTable;";
$result1=DatabaseConnector::ExecuteQueryArray($query1);
?>

<script type="text/javascript">
function deleteRow(tableName,colName,id){
    $.ajax({
           type: "POST",
           url: "delete.php",
           data: "tableName=tableName&colName=colName&id=id",
           success: function(msg){
             alert( "Row has been updated: " + msg );
           }
    });
}
</script>

<table id="newspaper-b" border="0" cellspacing="2" cellpadding="2" width = "100%">
<thead>
<tr>
    <th scope="col">Opr</th>
    <th scope="col">Flt Num</th>
    <th scope="col">From</th>
    <th scope="col"></th>
</tr>
</thead>
<tbody>
<?php foreach ($result1 as $row):?>
<tr>
<td><?php echo $row['airlineName'];?></td>
<td><?php echo $row['flightNum'];?></td>                        <td><?php echo $row['from'];?></td>
<td>
  <div title='Delete' onclick='deleteRow(<?php echo 'flightschedule','flightNum',$row['flightNum']; ?>)'>
<img src='images/delete.png' alt='Delete' />
</div>              
</td>
</tr>
<?php endforeach;?>
</tbody> 
```

**删除.php**

```
<?php
    /* Database connection */
    include_once 'include/DatabaseConnector.php';
    if(isset($_POST['tableName']) && isset($_POST['colName']) && isset($_POST['id'])){
        $tableName = $_POST['tableName'];
        $colName = $_POST['colName'];
        $id = $_POST['id'];
        $sql = 'DELETE FROM '.$tableName.' WHERE '.$colName.' ="'.$id.'"';
        mysql_query($sql);
    } else { 
        echo '0'; 
    }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:13:51.033

*   你检查你的PHP日志看是否有错误？
*   什么是`Ajax.Request`？如果您使用的是原型库，那么它包含在您的 HTML 代码中的什么位置？
*   最后，你确定你的 PHP 代码被调用了吗？（检查使用例如 Chrome 浏览器中的 Web 开发工具，“请求”选项卡）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T13:11:47.873

此行有错误

```
 <div title='Delete' onclick='deleteRow(<?php echo 'flightschedule','flightNum',$row['flightNum']; ?>)'> 
```

这将打印

```
 <div title='Delete' onclick='deleteRow(flightscheduleflightNumid)'> 
```

您必须将其更改为

```
 <div title='Delete' onclick='deleteRow("flightschedule","flightNum",<?php $row['flightNum']; ?>)'> 
```

去工作。

最好的祝愿

更新：要使上述代码正常工作，还请添加

```
<script src="js/jquery.js" type="text/javascript" ></script> 
```

或从互联网上加载

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.js"></script> 
```

在 html 的标题中包含 Jquery。我已经测试了它现在可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-01T14:17:42.503

您不会将您的数据发送到 delete.php 文件，因为在日期属性中您严重抓住了它们。这是我刚刚测试过他（它）的这段代码，这似乎有效。

***数据："tableName="+tableName+"&colName="+colName+"&id="+id+"",***

```
function deleteRow(tableName,colName,id){
    $.ajax({
           type: "POST",
           url: "delete.php",
           data: "tableName="+tableName+"&colName="+colName+"&id="+id+"",
           success: function(msg){
             alert( "Row has been updated: " + msg );
           }
    });
}
```

# c# - 如何设置 宽度为内容大小的 25%

> ID：10737232
> 
> 赞同：3
> 
> 时间：2012-05-24T12:09:23.720
> 
> 标签：c#, asp.net

你好，有人能告诉我如何给 panel.width 一个 25% 的内容大小吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T12:27:06.987

像这样定义面板：

```
<asp:Panel CssClass="CustomWidth" ID="MyPanel" runat="server"> </asp:Panel> 
```

然后链接到设置以下内容的外部 css 样式表：

```
.CustomWidth{     width: 25%; } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T12:24:54.623

您可以为此使用[jQuery](http://jquery.com/)：

假设`Panel1`是您的面板的 ID，并且，您要根据的相应内容容器是`Container1`，

```
var dWidth = $('#Container1').width();
$('#Panel1').width(dWidth * 0.25); 
```

将`Panel1`'s width 设置为您使用的容器的 25%。

只需决定您要使用哪个容器（可以是一个`div`或任何类似的容器，您没有向我们展示您的代码）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-12T09:14:36.573

如果您不会使用 JavaScript，您可以在 CodeBehind 文件中编写 C# 代码：

`Panel1.Style.Add("width", "25%");`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-24T12:30:26.883

我不太明白你的问题，但它看起来像 JavaScript Jobe，例如：

```
var Element_Id = document.getElementById("Elem_Id"); // Element Id
var curr_Element_Width = parseInt(Element_Id.clientWidth); // parseInt is taking down our "px" string at the width.... look:
var curr_Element_Id_Width = 100px we need INT only!
we only need the number 100 so after parseInt its now 100 and not 100px we can't work with string's and that is the reson we doing that, 
```

然后你可以使用这样的功能......

```
function addWidth() {
    Element_Id.style.width = (curr_Element_Width + 100) + 'px'; // after we change the width we add the "px" string again
} 
```

在这里，我们使用 Px，但您也可以使用 % 希望它对您有所帮助，祝您有美好的一天。

# java - android：将一个文件复制到另一个文件的更快解决方案

> ID：10737234
> 
> 赞同：0
> 
> 时间：2012-05-24T12:09:28.127
> 
> 标签：java, android, filechannel

我正在使用 BufferedInputStream 复制文件。我在循环中复制 byte[]。这对于大文件来说非常慢。

我看到了 FileChannel 结构。我也试过用这个。我想知道 FileChannel 是否比使用 IOSTreams 更好。在我的测试过程中，我看不到性能的重大改进。

或者有没有其他更好的解决方案。

我的要求是修改 src 文件的前 1000 个字节并复制到目标，将 src 文件的其余字节复制到目标文件。

使用文件通道

```
private  void copyFile(File sourceFile, File destFile,byte[] buffer,int srcOffset, int destOffset) {
    try {
        if (!sourceFile.exists()) {
            return;
        }
        if (!destFile.exists()) {
            destFile.createNewFile();
        }
        FileChannel source = null;
        FileChannel destination = null;
        source = new FileInputStream(sourceFile).getChannel();
        source.position(srcOffset);
        destination = new FileOutputStream(destFile).getChannel();
        destination.write(ByteBuffer.wrap(buffer));
        if (destination != null && source != null) {
            destination.transferFrom(source, destOffset, source.size()-srcOffset);
        }
        if (source != null) {
            source.close();
        }
        if (destination != null) {
            destination.close();
        }

    } catch (Exception ex) {
        ex.printStackTrace();
    }
} 
```

使用 I/O 流

```
while ((count = random.read(bufferData)) != -1) {

            fos.write(bufferData, 0, count);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:51:50.453

我相信性能不会显着提高，因为硬盘/SD卡的速度可能是瓶颈。

但是，创建一个执行复制的后台任务可能会有所帮助。

这并不是真的更快，但感觉更快，因为您不必等待复制操作完成。

此解决方案仅适用于您的应用在启动后不需要立即获得结果的情况。

有关详细信息，请参阅[异步任务](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T02:14:36.420

`transferFrom()`必须循环调用。不能保证在一次通话中转移全部金额。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T06:32:00.567

我终于做到了使用覆盖和重命名。使用 Randomfile 覆盖前 x 个字节。然后重命名文件。现在，无论文件大小如何，它都更快，并且所有文件都花费相同的时间。

谢谢。

# twitter - 用于直接消息 (DM) 的 Twitter 流 API

> ID：10737235
> 
> 赞同：4
> 
> 时间：2012-05-24T12:09:30.467
> 
> 标签：twitter, streaming

我正在通过 Twitter GET API 阅读 DM，每次检查它们时，我都会消耗速率限制，即使我没有检索到任何消息。

我已经看到可以通过 Streaming API 读取 DM，我想知道这是否不消耗速率限制，或者在实现它之前至少是一个单独的限制，因为这需要一些时间。此外，新的 DM 是快速获得还是在流式传输时有某种延迟？

所以，简而言之：

1.  Streaming API 不会消耗我的 GET API 速率限制吗？
2.  Streaming API 是否“几乎”立即获得 DM？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T21:03:12.797

流 API 限制和 REST API 限制是完全独立的实体。通过流式 API 使用直接消息不会使用任何 REST API 速率限制。如果用户流连接中使用的访问令牌具有与之关联的适当权限级别，那么 DM 几乎会立即到达用户流中。

# command-line-arguments - 重定向到文件不产生输出

> ID：10737236
> 
> 赞同：0
> 
> 时间：2012-05-24T12:09:39.910
> 
> 标签：command-line-arguments, io-redirection

我有一个程序，它使用 OpenCL 库并在标准输出上产生一些输出。该程序接受一些命令行参数，具体取决于内核在 CPU 或 GPU 上运行。

当我在 GPU 上运行程序时，

```
$./run 1
$./run 1 > outFile 
```

(a) 在没有任何重定向的情况下，在标准输出上可以看到输出。

(b) 通过重定向到文件，输出被重定向到指定的文件。

当我在 CPU 上运行程序时，

```
$./run 0
$./run 0 > outFile 
```

(a) 在没有任何重定向的情况下，在标准输出上可以看到输出。

(b) 重定向到文件后，文件中看不到任何输出。

它是一个带有 bash 的 arch linux 机器。如果需要任何其他信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:21:09.207

试试这个，告诉我它是否有效：

```
$./run 0 >& outFile 
```

# javascript - 通过javascript检索隐藏字段值

> ID：10737239
> 
> 赞同：1
> 
> 时间：2012-05-24T12:09:57.383
> 
> 标签：javascript, asp.net, .net, vb.net

我正在使用以下 javascript 来检索 asp 隐藏字段的值。

```
var pagemode 
function setValue() {
pagemode= document.getElementById('<%#litTest.ClientID%>').value;
}

function Item_load(sender, eventArgs) {
 window.location.href = "Request.aspx?Request_ID=" + eventArgs.get_item().getMember('Request_ID').get_value() + "&ListType=" + pagemode;
} 
```

隐藏字段的值在页面加载中加载在后面的代码中。我需要将值作为查询字符串传递，它是未定义的。

如果有人可以提供帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:17:08.773

所以你没有得到你的隐藏域的参考？试试这个：

```
<script type="text/javascript">
  var litTestID = '<%= litTest.ClientID %>';

  function setValue() {
    var pagemode = $(litTestID).value;
    // ...
  }
</script> 
```

否则使用 javascript 调试器检查执行顺序和变量值。

# javascript - DOJO 中需要图表 - 类似图表的 Google 财经

> ID：10737242
> 
> 赞同：-1
> 
> 时间：2012-05-24T12:10:14.290
> 
> 标签：javascript, graph, dojo

我需要制作一个图表，其功能与图表中的图表一样

[http://www.google.com/finance?q=INDEXDJX:.DJI,INDEXSP:.INX,INDEXNASDAQ:.IXIC](http://www.google.com/finance?q=INDEXDJX:.DJI,INDEXSP:.INX,INDEXNASDAQ:.IXIC)

我需要制作一个具有缩放和平移选项的图表。但不像谷歌地图，我想在运行时加载数据。例如，当我向右平移时，我只想加载数据。我不想事先加载所有数据，然后将其发送到图表。我想一块一块地加载数据，就像谷歌地图的加载方式一样。

我不想使用 flash 或 JQUERY。DOJO可以接受！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:34:26.063

[谷歌可视化 API](https://developers.google.com/chart/interactive/docs/reference)怎么样？

看看操场，API 提供与 Google 财经相同的图表。它被称为带注释的时间线（类`google.visualization.AnnotatedTimeLine`）：[http ://code.google.com/apis/ajax/playground/?type=visualization#annotated_time_line](http://code.google.com/apis/ajax/playground/?type=visualization#annotated_time_line)

# struts2 - Struts2 瓦片问题

> ID：10737243
> 
> 赞同：1
> 
> 时间：2012-05-24T12:10:18.343
> 
> 标签：struts2, tiles

我有一个瓷砖定义，如

```
<definition name="tasks" template="/jsp/layout/layout.jsp">
    <put-attribute name="header" value="/jsp/layout/header.jsp"/>
    <put-attribute name="nav" value="/jsp/layout/navigation.jsp"/>
    <put-attribute name="menu" value="/jsp/task/menu.jsp#ShowUser" />
</definition> 
```

我想在属性的值中添加一个锚点，这个锚点需要根据控制器设置的属性进行设置。例如

```
<put-attribute name="menu" value="/jsp/task/menu.jsp#ShowUser" /> 
```

但是，这似乎不起作用。

知道如何做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T21:46:21.057

解决此问题的一种方法（可能还有另一种方法？）是结合在您的操作结果位置使用 OGNL 和在您的 Tile 定义中使用通配符。

假设我有这个动作：

```
public class DynamicTileAction {

   MyModel model

   public String execute() { 
      return "success"; 
   }

   public MyModel getModel() { 
      return this.model; 
   }

   //other code...

} 
```

这个结果定义：

```
<result name="success" type="tiles">dynamic.tile.${model.someField}</result> 
```

然后在tiles.xml中我可以这样做：

```
<definition name="dynamic.tile.*">
    <put-attribute name="dynamicField" value="{1}" />
</definition> 
```

或者，您可以使用它来动态包含 JSP：

```
<definition name="dynamic.tile.*">
    <put-attribute name="content" value="/WEB-INF/content/dynamic/{1}.jsp" />
</definition> 
```

然后，您`{1}`在上面看到的每个地方都将等于 的值`getModel().getSomeField()`。

# android - Android：我想提供进度动画（水平）来显示在 android 中的下载进度，而不是使用进度条。我怎样才能做到这一点？

> ID：10737244
> 
> 赞同：0
> 
> 时间：2012-05-24T12:10:22.650
> 
> 标签：android, android-animation

我想提供进度动画（水平）来显示 android 中的下载进度。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T04:34:55.873

我认为您正在寻找[**Progress Bar**](http://developer.android.com/reference/android/widget/ProgressBar.html)。

# ios - iphone使用UITableView后如何节省内存

> ID：10737245
> 
> 赞同：1
> 
> 时间：2012-05-24T12:10:24.770
> 
> 标签：ios, uitableview, memory-leaks

我正在使用带有重用标识符的 UITableView，它会占用大量内存在创建更多单元格后，每当我增加表格行中的单元格计数时，它会占用更多内存。有什么技巧可以节省内存。

# c# - ajaxToolkit:AsyncFileUpload - 在 AsyncFileUpload1_UploadComplete() 中创建的动态控件未呈现到页面

> ID：10737252
> 
> 赞同：0
> 
> 时间：2012-05-24T12:10:54.880
> 
> 标签：c#, asp.net, asp.net-ajax, ajaxcontroltoolkit

我正在使用允许用户上传 excel 文件的 ajaxToolkit:AsyncFileUpload。在 AsyncFileUpload1_UploadComplete() 事件中，我正在读取 excel 数据并使用 div 创建 excel 结构并添加到页面中。但是这些动态创建的控件并没有被添加到页面中。我在更新面板中添加了一个按钮并进行了检查。在按钮单击事件上，我创建了相同的上述控件。在这种情况下，控件正在呈现到页面。仅在 ajaxToolkit:AsyncFileUpload 的情况下，控件不会呈现。任何人都可以告诉我解决这个问题的方法是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T12:37:22.460

将 Button 添加到要显示新控件并使用 css 样式使其不可见的 UpdatePanel 中。在`AsyncFileUpload1_UploadComplete`服务器端方法中，将数据保存到 Session 状态。在客户端`OnClientUploadComplete`事件处理程序调用`__doPostBack`函数中使用隐藏按钮的 UniqueID 第一个参数值。然后在该按钮的单击处理程序中制作呈现动态内容所需的所有内容。

# database-deadlocks - SQL 死锁 在存储过程中插入更新语句

> ID：10737256
> 
> 赞同：1
> 
> 时间：2012-05-24T12:11:15.847
> 
> 标签：database-deadlocks

我有一个非常基本的表格，名为 Titles，如下所示，

```
TitleID - auto identity and PK
UserID - reference key to User table
Title - varchar
IsPrimary - bit 
```

只有一个索引是 TitleID 上的 PK Clustered Index

现在我通过 ReadCommitted 事务中的存储过程在该表中插入记录，

此存储过程将记录插入到 IsPrimary = 1 的表中，并将所有其他标题更新为 0

```
INSERT INTO Titles(...)
    VALUES (...)

UPDATE T
SET IsPrimary = 0
FROM    Titles T
WHERE T.UserID = @UserID AND T.JobTitle != @Title 
```

当我在多用户场景中测试这个时，我遇到了死锁问题。如果我从存储过程中删除 UPDATE 命令，那么一切都很好......

我尝试在查找列上创建非聚集索引，并在更新语句中尝试了 WITH (ROWLOCK) 提示，但似乎没有任何效果。

当我运行 sql 语句并查看估计的执行计划时，我可以看到都更新了聚集索引，我认为这是在多用户场景中失败的地方......

我相信这是一个相当简单的场景，很多人应该在高事务系统中实现这种行为，但我找不到任何关于如何处理/解决这个问题的信息，我们将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T13:39:40.063

您的死锁可能在索引资源上。

在执行计划中查找书签/键查找并创建一个覆盖这些字段的非聚集索引 - 这样 UPDATE 数据的“读取”不会与 INSERT 的“写入”发生冲突。

# sharepoint-2010 - 创建站点后重定向共享点页面

> ID：10737257
> 
> 赞同：0
> 
> 时间：2012-05-24T12:11:18.053
> 
> 标签：sharepoint-2010, event-handling

我创建了一个 on WebProvisioned 事件。

最后，我想重定向到自定义页面。但这并不像我想的那么容易。

我做了：

```
string url = "CustomAdminPage.aspx";    
SPUtility.Redirect(url, SPRedirectFlags.RelativeToLayoutsPage, currentContext); 
```

该事件是同步的，所以我可以在构造函数中使用 Httpcontext。

如何从我的 webprovisioned 事件中进行重定向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:15:48.757

也许这会有所帮助：

```
public override void ItemAdding(SPItemEventProperties properties)
{
    if (DateTime.Now.Hour > 9 || DateTime.Now.Hour < 17)
    {
        properties.Status = SPEventReceiverStatus.CancelWithRedirectUrl;
        properties.RedirectUrl = "/_layouts/EventReceiver/CustomError.aspx";
    }
} 
```

我在[这里找到了这个](http://www.c-sharpcorner.com/uploadfile/anavijai/how-to-redirect-to-a-custom-page-for-event-receiver-in-sharepoint-2010/)

此致！

# prolog - 在Prolog上计算二叉树中的节点数？

> ID：10737258
> 
> 赞同：2
> 
> 时间：2012-05-24T12:11:22.113
> 
> 标签：prolog, binary-tree

我有一些代码

```
tree1(tree(1,
            tree(2,
                tree(3,nil,nil),
                tree(4,nil,nil)),
            tree(5,
                tree(6,nil,nil),
                tree(7,nil,nil))
        )
    ).
rbt_count_nodes(e,0):-!.
rbt_count_nodes(t(_,L,R),N):-
    rbt_count_nodes(L,NL),
    rbt_count_nodes(R,NR),
    N=NL+NR+1.

?-tree1(T),rbt_count_nodes(T,N),write(N). 
```

但是目标总是返回No。为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T12:18:35.543

```
rbt_count_nodes(t(_,L,R),N) 
```

应该成为

```
rbt_count_nodes(tree(_,L,R),N) 
```

和

```
N=NL+NR+1 
```

应该成为

```
N is NL + NR + 1 
```

（`(=)/2`用于执行统一，`(is)/2`执行算术）。

和

```
rbt_count_nodes(e,0):-!. 
```

应该成为

```
rbt_count_nodes(nil,0). 
```

在这三个编辑之后应该没问题，虽然我无法测试所以我可能被证明是错误的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T14:49:37.217

除了另一个答案中给出的注释（使用`is/2`而不是`=/2`和术语 t->tree 和 e->empty 名称中的拼写错误）之外，您应该考虑使用累加器来允许 prolog 系统进行尾递归：

```
rbt_count_nodes(T,N):-
  rbt_count_nodes(T, 0, N).

rbt_count_nodes(nil,N, N):-!.
rbt_count_nodes(tree(_,L,R),C,N):-
    succ(C, C1),
    rbt_count_nodes(L,C1,NL),
    rbt_count_nodes(R,NL,N). 
```

过程`rbt_count_nodes/2`只是`rbt_count_nodes/3`以零作为第二个参数（累加器）调用。在每个递归步骤中，该累加器都会递增 1 并进行递归。基本情况只是将累加器与您的输出统一起来，允许系统进行尾递归并节省堆栈空间。

[编辑]

根据评论，要使其真正成为尾递归（即所有递归调用都是尾调用），您可以向 rbt_count_nodes/3 添加一个新子句（并修改另一个子句）：

```
rbt_count_nodes(nil,N, N):-!.
rbt_count_nodes(tree(Node,tree(LNode, LL, LR),R),C,N):-
  rbt_count_nodes(tree(Node, LL, tree(LNode, LR, R)), C, N).
rbt_count_nodes(tree(_,nil,R),C,N):-
  succ(C, C1),
  rbt_count_nodes(R,C1, N). 
```

使用这种方法，第一个子句处理一个空节点，第二个子句处理树的左侧，它只是将分支“移动”到当前节点的右侧，第三个子句只计算节点。

# objective-c - 一般来说，调用和@selector 很慢？

> ID：10737260
> 
> 赞同：1
> 
> 时间：2012-05-24T12:11:29.817
> 
> 标签：objective-c, ios, xcode

创建 iOS 程序时，如果我绕过 SEL（@selectors）并在其他类中调用它们，是否会对性能造成影响？这是否比正常的方法调用慢得多？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:28:47.120

为什么来自其他类的消息传递（ObjC 著名的一件事）会对性能造成影响？当然，与 C 函数相比，存在一些开销（由于在方法中增加了两个部分）。选择器只是简单的数据类型，因此将它们传递给 SEL 类型并不比发送 BOOL 或 int 更昂贵。但是，要从传递的选择器中实际调用 SEL 类型，建议创​​建 NSInvocation 对象，这会稍微增加开销时间。

而且您在 objC 中或多或少是安全的，因为给 nil 的消息（您确实提到了其他类）会产生 nil。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:24:15.873

好吧，除了在第一次运行时，它可能没有太大的影响，因为编译器会在编译时创建对每个对象的引用，并且它的依赖关系以及类，所以在加载时它可能会有点慢（在非常大的程序中也是如此......）但此后不多，只要在中间步骤中创建的对象不是很大，而且它不涉及任何大型动态操作，因为这里我只谈论调用本地函数并从不同的类调用相同的函数。

无论如何，您为什么要使用选择器来引用不同类中的某些函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T12:28:56.977

据我所知，选择器只是方法名称的编码。鉴于在 Objective-C 中方法是通过向对象发送消息来调用的，我不明白为什么显式方法调用 ( `[object method]`) 和隐式调用 ( `[objectDelegate selector]`) 之间应该存在性能差异。

# javascript - 如何使用 javascript 或 Jquery 获取 IE 浏览器的文件大小？

> ID：10737264
> 
> 赞同：3
> 
> 时间：2012-05-24T12:11:44.230
> 
> 标签：javascript, file-upload, fileapi

我在 IE 浏览器上使用过 ActiveXObject，但它不工作。我在 js 中获得了其他浏览器的文件大小，但无法获得 IE 浏览器的文件大小。我为此使用了以下代码：-

```
if ($.browser.msie==true)
 {
     var fileSystemObject = new ActiveXObject("Scripting.FileSystemObject");
     var path = document.uploadDocumentForm.documentUpload.value;
     var file = fileSystemObject.getFile(path);
     var size = file.size;
     alert(size);

/*  var a = document.getElementById(fileId).value;
            $('#myImage').attr('src',a);
            var imgbytes = document.getElementById('myImage').fileSize;       
            alert("here"+imgbytes);
            var imgkbytes = Math.round(parseInt(imgbytes)/1024);        */

}
else
{
               var fileInput = $("#"+fileId)[0]; 
               var imgbytes = fileInput.files[0].size; 
              var imgkbytes = Math.round(parseInt(imgbytes)/(1024));
} 
```

谁能帮我获取 IE 浏览器的文件大小。我已经完成了所有想法，但无法获得 IE 浏览器的文件大小。请为此提供想法或代码...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-14T16:02:14.200

一个可行的建议如下。

```
<script type="text/javascript">
function AlertFilesize(){
    if(window.ActiveXObject){
        var fso = new ActiveXObject("Scripting.FileSystemObject");
        var filepath = document.getElementById('fileInput').value;
        var thefile = fso.getFile(filepath);
        var sizeinbytes = thefile.size;
    }else{
        var sizeinbytes = document.getElementById('fileInput').files[0].size;
    }

    var fSExt = new Array('Bytes', 'KB', 'MB', 'GB');
    fSize = sizeinbytes; i=0;while(fSize>900){fSize/=1024;i++;}

    alert((Math.round(fSize*100)/100)+' '+fSExt[i]);
}
</script>

<input id="fileInput" type="file" onchange="AlertFilesize();" /> 
```

它取自另一个答案[Get file size before uploading](https://stackoverflow.com/questions/7497404/get-file-size-before-uploading)。

# jms - Active MQ 中的错误消息

> ID：10737269
> 
> 赞同：0
> 
> 时间：2012-05-24T12:12:20.163
> 
> 标签：jms, activemq, apache-camel

我正在使用 Camel 路由通过 activemq 队列发送 xml 消息。消息已到达队列，但无法读取。不确定是 apache camel 问题还是 Active MQ 问题。我的骆驼路线是

```
<route>
            <from uri="seda:elixirBatchQueue" />
            <inOnly uri="activemq:queue:TESTQUEUE"/>
        </route> 
```

队列中的错误消息是

```
javax.jms.JMSException: Failed to build body from bytes. Reason: java.io.StreamCorruptedException: invalid type code: 00 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:17:57.730

问题出在 ActiveMQ 上，因为它无法理解消息格式。当我将它转换为字符串时，Queue 能够将消息识别为 DOM4J 文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-07T05:16:19.330

试试这个它对我有用。

```
producer.Send(objectMessage.Body); 
```

我使用的库 -->>`Apache.NMS.ActiveMQ`

# python - 创建分层JSON对象的递归函数？

> ID：10737273
> 
> 赞同：10
> 
> 时间：2012-05-24T12:12:35.380
> 
> 标签：python, json, algorithm, recursion

我只是不够优秀的计算机科学家自己解决这个问题:(

我有一个返回 JSON 响应的 API，如下所示：

```
// call to /api/get/200
{ id : 200, name : 'France', childNode: [ id: 400, id: 500] } 
// call to /api/get/400
{ id : 400, name : 'Paris', childNode: [ id: 882, id: 417] } 
// call to /api/get/500
{ id : 500, name : 'Lyon', childNode: [ id: 998, id: 104] } 
// etc 
```

我想递归解析它并构建一个看起来像这样的分层 JSON 对象：

```
{ id: 200,
  name: 'France', 
  children: [
     { id: 400,
       name: 'Paris',
       children: [...]
     },
     { id: 500,
       name: 'Lyon', 
       children: [...]
     } 
  ],
} 
```

到目前为止，我有这个，它会解析树的每个节点，但不会将其保存到 JSON 对象中。如何扩展它以将其保存到 JSON 对象中？

```
hierarchy = {}
def get_child_nodes(node_id):   
    request = urllib2.Request(ROOT_URL + node_id)
    response = json.loads(urllib2.urlopen(request).read())
    for childnode in response['childNode']:
        temp_obj = {}
        temp_obj['id'] = childnode['id']
        temp_obj['name'] = childnode['name']
        children = get_child_nodes(temp_obj['id'])
     // How to save temp_obj into the hierarchy?
get_child_nodes(ROOT_NODE) 
```

这不是功课，但也许我需要做一些功课才能更好地解决这类问题:(谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T12:48:57.970

```
def get_node(node_id):   
    request = urllib2.Request(ROOT_URL + node_id)
    response = json.loads(urllib2.urlopen(request).read())
    temp_obj = {}
    temp_obj['id'] = response['id']
    temp_obj['name'] = response['name']
    temp_obj['children'] = [get_node(child['id']) for child in response['childNode']]
    return temp_obj

hierarchy = get_node(ROOT_NODE) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T12:58:04.697

你可以使用这个（更紧凑和可读的版本）

```
def get_child_nodes(node_id):   
    request = urllib2.Request(ROOT_URL + node_id)
    response = json.loads(urllib2.urlopen(request).read())
    return {
       "id":response['id'],
       "name":response['name'],
       "children":map(lambda childId: get_child_nodes(childId), response['childNode'])
    }

get_child_nodes(ROOT_NODE) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T12:38:17.793

您不会从每次调用递归函数中返回任何内容。因此，您似乎只想`temp_obj`在循环的每次迭代中将每个字典附加到一个列表中，并在循环结束后返回它。就像是：

```
def get_child_nodes(node_id):   
    request = urllib2.Request(ROOT_URL + node_id)
    response = json.loads(urllib2.urlopen(request).read())
    nodes = []
    for childnode in response['childNode']:
        temp_obj = {}
        temp_obj['id'] = childnode['id']
        temp_obj['name'] = childnode['name']
        temp_obj['children'] = get_child_nodes(temp_obj['id'])
        nodes.append(temp_obj)
    return nodes

my_json_obj = json.dumps(get_child_nodes(ROOT_ID)) 
```

（顺便说一句，请注意混合制表符和空格，因为 Python 不是很宽容。最好只使用空格。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-05T04:05:46.607

今天下午我遇到了同样的问题，最后重新调整了我在网上找到的一些代码。

我已将代码上传到 Github ( [https://github.com/abmohan/objectjson](https://github.com/abmohan/objectjson) ) 以及 PyPi ( [https://pypi.python.org/pypi/objectjson/0.1](https://pypi.python.org/pypi/objectjson/0.1) )，包名为“objectjson”。它也在下面：

***代码***（objectjson.py）

```
import json

class ObjectJSON:

  def __init__(self, json_data):

    self.json_data = ""

    if isinstance(json_data, str):
      json_data = json.loads(json_data)
      self.json_data = json_data

    elif isinstance(json_data, dict):
      self.json_data = json_data

  def __getattr__(self, key):
    if key in self.json_data:
      if isinstance(self.json_data[key], (list, dict)):
        return ObjectJSON(self.json_data[key])
      else:
        return self.json_data[key]
    else:
      raise Exception('There is no json_data[\'{key}\'].'.format(key=key))

  def __repr__(self):
    out = self.__dict__
    return '%r' % (out['json_data']) 
```

***示例使用***

```
from objectjson import ObjectJSON

json_str = '{ "test": {"a":1,"b": {"c":3} } }'

json_obj = ObjectJSON(json_str)

print(json_obj)           # {'test': {'b': {'c': 3}, 'a': 1}}
print(json_obj.test)      # {'b': {'c': 3}, 'a': 1}
print(json_obj.test.a)    # 1
print(json_obj.test.b.c)  # 3 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-24T12:48:16.027

免责声明：我不知道 json 是关于什么的，所以您可能需要弄清楚如何用您的语言正确编写它：p。如果我的示例中的伪代码太伪，请随时询问更多细节。

你需要在某个地方返回一些东西。如果您从未在递归调用中返回某些内容，则无法获取对新对象的引用并将其存储在调用递归的对象中。

```
def getChildNodes (node) returns [array of childNodes]
    data = getData(fromServer(forThisNode))
    new childNodes array
    for child in data :
        new temp_obj
        temp_obj.stores(child.interestingStuff)
        for grandchild in getChildNodes(child) :
            temp_obj.arrayOfchildren.append(grandchild) 
        array.append(temp_obj)
    return array 
```

或者，如果您的语言支持，您可以使用迭代器而不是返回。

# wpf - 在数据模板中使用数据模板时，无法在第 4 级选择 WPF -treeview 项目

> ID：10737276
> 
> 赞同：0
> 
> 时间：2012-05-24T12:12:37.547
> 
> 标签：wpf, c#-4.0

我尝试使用 WPF/C#.Net 4.0 实现具有 4 个级别的树视图。它加载所有 4 个级别但无法选择第 4 级，并且在选择第 3 级时它选择具有第 4 级的组。Continent->Country->District->Artifacts 是一种结构，但还有另一种结构 Continent->Products->Artifacts

资源数据模板->

```
<DataTemplate x:Key="DistrictTemplates">
<StackPanel Orientation="Horizontal">   
<TextBlock Text="{Binding Path=ArtifactName}" />
</StackPanel>
</DataTemplate>

<DataTemplate x:Key="CountryTemplate">
<TreeViewItem ItemsSource="{Binding Path=District}" 
ItemTemplate="  {StaticResource DistrictTemplates}" 
Header="{Binding Path=Code}">           
</TreeViewItem>
</DataTemplate> 
```

树视图代码->

```
<TreeView Name="treeExplorer" MouseDoubleClick="TreeView_MouseDoubleClick" SelectedItemChanged="treeExplorer_SelectedItemChanged">
 <TreeViewItem Name="tviDefinition" IsExpanded="True" Header="Continent">
<TreeViewItem ItemsSource="{Binding Path=Country}" ItemTemplate="{StaticResource CountryTemplate}" Header="Country" />
</TreeViewItem>
</TreeView> 
```

还有一些其他树项。我不能在 TreeView.Resources 中使用内联模板，如果可以使用这个 HierarchicalDataTemplate 我也很困惑，因为我不能调用 Country.Districts.ArtifactName 并有两个层次结构，但我可以调用 Country.Districts( ) 然后 Districts 具有 code 属性并使用代码我可以找到 Artifacts.And 我在 usercontrol.resources 中使用 datatemplates 我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:02:31.420

这是我写的 4 级深度的东西。这是一个显示 HL7 消息结构的 TreeView。对于快速背景，HL7 是一个字段分隔的消息。你有一条信息。每条消息都有一个 Segment。每个 Segment 至少有一个字段。一个字段可以有多个组件。一个组件可以有子组件。此树显示 HL7 消息结构，其中每个级别都是 HL7 消息格式的一部分。

例如，如果消息中有 PID 段，则树将如下所示：

```
PID
...PID.1
...PID.2
......PID.2.1
......PID.2.2
......PID.2.3
......PID.2.4
.........PID.2.4.1
.........PID.2.4.2 
```

ETC...

这是 XAML：

```
 <TreeView x:Name="hl7Structure" ItemsSource="{Binding Path=MessageSegments}" IsEnabled="True">
        <TreeView.Resources>
           <HierarchicalDataTemplate DataType="{x:Type MyNamespace:MessageSegment}" ItemsSource="{Binding Path=Fields}">
              <TextBox x:Name="segmentName" BorderBrush="Transparent" BorderThickness="0" Text="{Binding Path=Name}" FocusVisualStyle="{x:Null}" />
           </HierarchicalDataTemplate>
           <HierarchicalDataTemplate DataType="{x:Type MyNamespace:MessageField}" ItemsSource="{Binding Path=Components}">
              <TextBlock x:Name="fieldName" Text="{Binding Path=Name}" ToolTip="{Binding Path=Info}" />
           </HierarchicalDataTemplate>
           <HierarchicalDataTemplate DataType="{x:Type MyNamespace:MessageComponent}" ItemsSource="{Binding Path=Subcomponents}">
              <TextBlock x:Name="componentName" Text="{Binding Path=Name}" ToolTip="{Binding Path=Info}" />
           </HierarchicalDataTemplate>
           <DataTemplate DataType="{x:Type MyNamespace:MessageSubcomponent}">
              <TextBlock x:Name="subComponentName" Text="{Binding Path=Name}" ToolTip="{Binding Path=Info}" />
           </DataTemplate>
        </TreeView.Resources>
    </TreeView> 
```

现在解释它是如何工作的。我有一个每个 HL7 消息片段都继承的基础对象。TreeView 的 ItemsSource 绑定到该集合。由于有 4 个级别，其中 3 个显示层次结构，一个不显示层次结构，因此有 3 个 HierarchicalDataTemplates 和 1 个 DataTemplate。

这样想……HL7 消息段、字段和组件是树节点，因为它们有子节点。HL7 子组件是一个叶子，因为它没有。每个树节点都获得一个 HierarchicalDataTemplate，但每个叶子只获得一个 DataTemplate。

通过使用 DataType 属性，每个 HierarchicalDataTemplates 都知道要显示的对象类型。这是我告诉控件的地方，它正在显示的子类型。这允许我使用基本类型集合，然后在其适当的节点级别显示所有子类型。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T06:21:26.900

最后我设法解决了这个问题。谢谢乔希和大家。

资源数据模板->

```
<DataTemplate x:Key="DistrictTemplates">
<StackPanel Orientation="Horizontal">   
<TextBlock Text="{Binding Path=ArtifactName}" />
</StackPanel>
</DataTemplate>

<HierarchicalDataTemplate x:Key="CountryTemplate" DataType="Continent.Countries" ItemsSource="{Binding Path=District}" ItemTemplate="{StaticResource DistrictTemplates}">
<TextBlock Text="{Binding Path=Code}"/>    
</HierarchicalDataTemplate> 
```

树视图代码->

```
<TreeView Name="treeExplorer" MouseDoubleClick="TreeView_MouseDoubleClick" SelectedItemChanged="treeExplorer_SelectedItemChanged">
<TreeViewItem Name="tviDefinition" IsExpanded="True" Header="Continent">
<TreeViewItem ItemsSource="{Binding Path=Country}" ItemTemplate="{StaticResource CountryTemplate}" Header="Countries" />
</TreeViewItem>
</TreeView> 
```

# ruby - 没有 Jruby 的 Ruby 和图形数据库

> ID：10737280
> 
> 赞同：4
> 
> 时间：2012-05-24T12:12:47.913
> 
> 标签：ruby, graph-databases

我希望在我的项目中引入一个图形数据库，而不必迁移到 jRuby。如我所见，鉴于此限制，我有两个选择：

1.  使用提供 RESTful 接口的图形数据库。我不知道这会对性能产生什么影响。我正计划收集大量数据。
2.  查找具有不需要 jRuby 的 ruby​​ 接口的图形数据库。到目前为止，在我的搜索中，我没有找到任何东西，但我发现的大多数帖子和博客条目都已经过时了。当然，我希望数据库和接口稍微成熟和可靠。

有谁知道符合上述＃2的任何事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T20:51:57.890

如果您担心性能，我建议您尝试 JRuby 和 neo4j.rb，因为它直接与嵌入式高性能 neo4j-Java-API 交互。最终，我认为这将是性能最高的解决方案。

如果您根本不愿意接受 JRuby，那么可以选择。Neo4j 有一个 REST API，[neography](https://github.com/maxdemarzi/neography)是它的一个瘦包装器。

或者您使用 Neo4j 服务器 - [(J)Ruby 扩展](https://github.com/neo4j/script-extension)。这是一个公开 REST API 的 JRuby Rack 应用程序。它包含 Neo4J 服务器，因此可以作为 JRuby 应用程序安装和使用，并且您的堆栈一直是 Ruby，即使它主要是 MRI Ruby 并且 JRuby 部分与持久性隔离。

# android - XMPP客户端在android中连接gtalk服务器

> ID：10737282
> 
> 赞同：1
> 
> 时间：2012-05-24T12:12:50.973
> 
> 标签：android, xmpp, smack

我想制作一个 XMPP 客户端来连接到 android 中的 gtalk 服务器。

我在java中成功完成了它，它在java中运行良好。

但是当我在android上尝试它时，它会抛出一个异常。

> `java.lang.NoClassDefFoundError: org.jivesoftware.smack.ConnectionConfiguration`

在我尝试使用 smack`ConnectionConfiguration`类配置连接的代码的第一行。我还将 smack.jar 文件包含在 lib 文件夹中，并将其链接到相应的构建路径。

是否有任何特定的 smack api for android 支持 xmpp 连接，并且都像 java 中的 smack？

在相同的代码中，samck api 在那里，但它对我不起作用，因为我尝试了几次不同的 smack api（smackx ， smack ， smackx-debuge ， smackx-jingle），并面临同样的问题。

# windows - 单引号和双引号：如何在 unix 和 windows 中具有相同的行为？

> ID：10737283
> 
> 赞同：1
> 
> 时间：2012-05-24T12:12:53.147
> 
> 标签：windows, batch-file

我有一个批处理脚本，它调用带有一些参数的 exe。

目前我正在将参数传递给我的exe，如下所示：

```
$>my_cmd.exe %* 
```

my_cmd.exe 程序的选项之一采用可以包含空格的参数

```
$>my_cmd.bat --req "in: lava"  (OK my prog receives in: lava)

$>my_cmd.bat --req 'in: lava'  (NOK my program receives 'in: lava') 
```

用户无所谓地使用单引号或双引号。

它适用于双引号，因为它们在批处理脚本级别被吃掉，但是当它们使用 ' （单引号）时，它被留下并传递给我的程序。

my_cmd 是多平台的，在 unix 上，单引号和双引号都是特殊字符。

我想避免根据平台在 my_cmd 程序中做一些特定的事情。

有没有办法在 shell 脚本和批处理脚本中具有相同的行为。例如，如果存在，批处理脚本可以吃单引号吗？

告诉我什么是最适合您的解决方案。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:57:28.827

在 Windows 上，参数处理（以及引用、通配符等的规则）是应用程序的责任。如果您的代码使用除包含完整引号的所有参数的单个字符串之外的任何内容，请了解这是因为您的开发工具对`GetCommandLine`. 因此，对于不同的报价处理，您需要查看您的开发工具，而不是操作系统。最好的选择通常是调用`GetCommandLine`您自己并使用您选择的库来处理它，而不是编译器提供的库。

也就是说，Windows shell 团队提供了其中一个库。见[`CommandLineToArgvW`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776391.aspx)。但这不是核心操作系统的一部分，使用它是完全可选的。

此外，批处理器在进行变量替换时确实会考虑引号。这种行为很难改变或禁用，但听起来不像是你问题的根源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:25:53.470

为什么不把引号改成双引号？

```
set args=%*
my_cmd.exe %args:'="% 
```

# jquery - Raphaël map remove last clone creat

> ID：10737288
> 
> 赞同：0
> 
> 时间：2012-05-24T12:13:05.347
> 
> 标签：jquery, path, raphael

我在删除最后克隆的路径时遇到问题。
我想要，当我单击一个路径时，它的克隆出现，当我单击另一条路径时，最后一个克隆的路径消失或动画缩放到原始路径以将其删除并创建另一个路径。有人可以告诉我怎么做吗？

我的代码：

```
var paper = Raphael("paper", 1000, 1000);

var mg = {};

mg.rg1a = this.paper.path("..." ).initZoom();
mg.rg2a = this.paper.path("..." ).initZoom();
mg.rg3a = this.paper.path("..." ).initZoom();

for (var state in mg) {

mg[state].setAttr({
      fill:           "#c7c6c5",
      stroke:         "#CFCFCF",
      "stroke-width": 1
    });

   (function (st, state) {
st[0].style.cursor = "pointer";

mg[state].click(function(){

                             var temp = mg[state].clone();
           temp.animate({'transform':"s2 2"}, 500);
           temp.setAttr({
      fill:           "#FF6600",
      stroke:         "#FFFB00",
      "stroke-width": 1 });

    });

})(mg[state], state);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T21:47:32.663

我可以为你解决这个问题，但我不确定这是否会有所帮助。

您在小提琴中犯了几个错误，需要先修复这些错误，然后才能解决您的问题。

[1](http://jsfiddle.net/amadanNM/TFgsZ/) Raphael 没有名为 setAttr() 的函数。它*确实*有一个名为 attr() 的函数。

[2] 您正在使用转换来缩放您的克隆。变换出现在 Raphael 2.0 中，但您的小提琴使用的是 raphael 1.5.2。可能您只是设置不正确，但我想我会指出来。

解决您的特定问题非常简单。您只需要保留对您创建的克隆的引用。每次单击某个对象时，请检查引用是否指向对象。如果是，则使用 .remove() 将其删除。这样，您将在创建新克隆之前对旧克隆进行核对。

如果您*真的*被卡住了，请回复，我会给您我创建的小提琴的工作版本。还是先试试吧。

N。

PS。firebug 和 webdeveloper 是您应该使用的两个浏览器扩展，如果您还没有这样做的话。它消除了很多错误的猜测。

* * *

既然你问得很好，[这是](http://jsfiddle.net/amadanNM/TFgsZ/)你修改过的小提琴。我添加了一个名为 cloneHolder 的变量。每当您单击时，您都会检查 cloneHolder 是否引用了任何内容，如果是，则使用 cloneHolder.remove() 将其删除。如果您愿意，您可以更改代码以使您的克隆消失，然后再将其删除。

# java - 上下文对于 Web 容器/Web 应用程序意味着什么？

> ID：10737291
> 
> 赞同：-2
> 
> 时间：2012-05-24T12:13:07.180
> 
> 标签：java, jakarta-ee, web-container

上下文对于 Web 容器/Web 应用程序意味着什么？

`Context cont = new InitialContext()`初始化什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:41:34.663

> 上下文对于 Web 容器/Web 应用程序意味着什么？

*通常*，上下文将指定特定于您的环境的对象映射——您可能有一个生产`context`引用不同的 jdbc 配置而不是测试`context`

> Context cont = new InitialContext() 初始化什么？

这将初始化一个*空*环境

# php - jQuery - 拖放列表重新排序

> ID：10737294
> 
> 赞同：1
> 
> 时间：2012-05-24T12:13:26.943
> 
> 标签：php, jquery, html, jquery-ui, sorting

我有一个 HTML 列表，我想让用户能够通过拖放重新排序，然后将他们的更改提交到数据库。

我对所有数据库的东西都很满意，但我在 Javascript/JQuery 上苦苦挣扎。

我目前的 jQuery UI [Sortable](http://jqueryui.com/demos/sortable/)工作正常（所以其他元素并通过拖放重新排序元素），但我不知道如何获取 SUBMIT 的新订单。

任何人都可以帮忙吗？如果您需要更多信息，请直接说。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T12:22:14.780

例如，通过 AJAX 调用将该数据发送到您的应用程序

```
$('#TabContainer').tabs();
$('#TabContainer .ui-tabs-nav').sortable({
    axis: 'x',
    update: function(event, ui){
        var data = $('#TabContainer .ui-tabs-nav').sortable('serialize');
        $.ajax({
            url: '/events/update-tab-order',
            data: data,
            type: 'POST',
            mode: 'abort'
        });
    }
}); 
```

唯一棘手的部分是您必须在列表项上指定一个 ID，格式为`groupname_identifier`. 例如：

```
<div id="TabContainer">
    <ul>
        <li id="MyTabs_123"><a href="#tab0">Tab 1</a></li>
        <li id="MyTabs_124"><a href="#tab1">Tab 2</a></li>
        ...etc
    </ul>
    ...tab content goes here
</div> 
```

然后，当您的应用程序接收到 POST 数据时，它将是一个如下所示的数组：

```
$_POST['MyTabs']

array(
    0 => '123',
    1 => '124'
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:22:21.843

看看@serialize()，我做了同样的事情，没有显式提交按钮，而是直接使用mootools通过ajax注入订单。

```
<script language="javascript">
            <!--
            window.addEvent('domready', function() {
                var thisSortables = new Sortables($('list'), {
                    constrain: true,
                    clone: true,
                    revert: true,
                    onStart: function() {
                        $('confirm').set('html', '');
                    },
                    onComplete: function() {
                        this.serialize(function(el, index) {
                            var updateOrderRequest = new Request.HTML({
                                url: '../module/tools/admgn/dbsorter.php',
                                method: 'post',
                                data: {'itemID': el.id.replace("item_",""), 'new_pos':(index+1)}
                            }).send();
                        });
                        $('confirm').set('html', 'Reihenfolge erfolgreich gespeichert.');
                    }
                });
            });
            -->
        </script> 
```

也许你明白如何让它发挥作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T12:30:16.723

由于`<UL>`and`<OL>`不是表单元素，你无法通过 post 方法，我希望你能做到这一点

[http://quasipartikel.at/multiselect_next/](http://quasipartikel.at/multiselect_next/)

选择所有选项并将可用部分隐藏为隐藏

# facebook-graph-api - Facebook api返回未定义的关系状态

> ID：10737295
> 
> 赞同：1
> 
> 时间：2012-05-24T12:13:31.530
> 
> 标签：facebook-graph-api, facebook-javascript-sdk

我试图在这里获取我朋友的关系，但我提供了所有正确的权限，它仍然说我，未定义..它没有提取朋友的关系状态，也没有提取生日..这是我的代码：

```
function loadFriendsrel()
{
    //get array of friends
    FB.api('/me/friends?fields=name,first_name,gender,picture,relationship_status,birthday', function(response) {
        console.log(response);
        var divContainer=$('.facebook-friends');
                         var testdiv2 = document.getElementById("test2");

for(var i=0; i<response.data.length; i++){
    if(response.data[i].gender == 'female'){
         testdiv2.innerHTML += response.data[i].first_name + '<br/>' + response.data[i].relationship_status + '<br/>' + ' ' + '<img src="' + response.data[i].picture + '"/>'  + '<br /> <br/>';
    }
}
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:52:55.993

即使您获得了所有权限，您也不会获得`relationship_status`通过隐私设置阻止他们的用户。

> **隐私设置的优先级高于 facebook api。**

所以，在你的循环中，一些朋友可能已经阻止了他们的`relationship_status`，所以它给出`undefined`并打破了你的循环。

把你的循环改成这样，

```
for(var i=0; i<response.data.length; i++){
    if(response.data[i].gender == 'female'){
    var relStatus = 'Relationship status not provided';

    // If relationship_status exists, only then take its value
    if('relationship_status' in response.data[i]){
        relStatus = response.data[i].relationship_status;  
    }
    testdiv2.innerHTML += response.data[i].first_name + '<br/>' + relStatus + '<br/>' + ' ' + '<img src="' + response.data[i].picture + '"/>'  + '<br /> <br/>';
 }   
} 
```

您也可以将类似的逻辑应用于其他字段。

# android - AChartEngine - 通过 x 读取 y 值

> ID：10737297
> 
> 赞同：1
> 
> 时间：2012-05-24T12:13:32.650
> 
> 标签：android, time-series, achartengine, linechart

我目前正在开发我的第一个 android 应用程序，现在使用 achartengine 库。

我的问题：是否有一个函数可以通过将 x 值作为参数传递来从图表中读取 y 值？

我有一个使用带有多个自定义日期的 TimeSeries 的折线图（例如 12 年 7 月 24 日和 12 年 7 月 29 日）。现在我想传递另一个日期（例如 07/25/12）并获取相应的 y 值——即使它没有存储在 TimeSeries 中。

我只是想问一下，是否有像单个函数这样简单的方法来实现这个目的，否则我会自己考虑一个更复杂的解决方案。当然，在我上面的例子中，计算所需的 y 值听起来很容易，但我猜实际上它会更难。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:32:59.157

不，AChartEngine 中没有这样的东西。

# javascript - 我的应用程序仅在调试模式下在 IE 中工作（在其他浏览器中工作）

> ID：10737299
> 
> 赞同：10
> 
> 时间：2012-05-24T12:13:43.820
> 
> 标签：javascript, jquery, internet-explorer

在 Internet Explorer（我尝试了 9 和 8）中，我的应用程序无法在正常模式下运行。但是当我进入调试模式（按`F12`）时，它可以解决一些小问题（现在无关紧要）。

这使我无法调试我的应用程序，因为在调试模式下，它才开始工作。

这是[我开发的应用程序](http://games.ourcity-sy.com)。

有什么解决办法？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-24T12:16:19.200

你`console.log`在你的脚本中使用吗？在 IE 浏览器`console`中，对象仅在调试模式下存在于范围内。将您的代码更改为：

```
if (console) console.log('...') 
```

编辑：我查看了您的应用程序，您正在使用控制台日志。

# ruby - 主线程是否“总是”在像 Sinatra 这样的 ruby Web 服务器中运行？

> ID：10737302
> 
> 赞同：1
> 
> 时间：2012-05-24T12:13:51.020
> 
> 标签：ruby, multithreading, sinatra

当您从 Web 请求处理程序中启动线程时 - 只要服务器正在运行，该线程是否会继续运行？

类似于[Thread.join 会阻塞主线程](https://stackoverflow.com/questions/3481866/thread-join-blocks-the-main-thread)，但您能否不调用 join 并让所有线程按自己的计划完成，很可能是在 Web 请求处理程序向浏览器返回 http 响应之后？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:05:06.553

下面的代码对我来说很好——在 OS X 本地机器上测试我能够得到 1500+ 个真正的线程，运行 Thin 和 ruby​​ 1.9.2。在 Heroku cedar 堆栈上，在创建线程时出现错误之前，我可以运行大约 230 个线程。

在这两种情况下，所有线程似乎都在它们应该完成的时候完成 - 启动它们后 2 分钟。'/' 在 Heroku 上渲染大约 60 毫秒，然后 20 个线程每个运行 2 分钟。

如果你刷新/几次，然后等待几分钟，你可以看到线程正在整理。我测试 2 分钟的原因是 heroku 对响应有 30 秒的限制，如果你花的时间超过这个时间，就会把你打断。但这似乎不会影响后台线程。

```
$threadsLaunched = 0
$$threadsDone = 0

get '/' do
  puts "#{Thread.list.size} threads"
  for i in 1..20 do
      $threadsLaunched = $threadsLaunched + 1
      puts "Creating thread #{i}"
      Thread.new(i) do |j|
          sleep 120
          puts "Thread #{j} done"
          $threadsDone = $threadsDone + 1
      end
   end
  puts "#{Thread.list.size} threads"
  erb :home
 end 
```

(home.erb)

```
 <div id="content">

<h1> Threads launched <%= $threadsLaunched.to_s %> </h1>
<h1> Threads running <%= Thread.list.count.to_s %> </h1>
<h1> Threads done <%= $threadsDone.to_s %> </h1>

 </div> <!--  id="content" --> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-24T12:41:21.270

一旦你的主线程退出，所有其他的也被强制销毁并且进程退出。

```
Thread.new do
  # this thread never exists on its own
  while true do
    puts "."
    sleep 1
  end
end

sleep 5 
```

按照这个例子，一旦主线程结束，打印线程也将结束而没有“完成”它的工作。在退出主线程之前，您必须明确`join`所有后台线程等待它们完成。

另一方面，只要主线程运行，其他线程就可以随心所欲地运行。请求/响应周期没有任意限制。但是请注意，在“原始”红宝石中，线程并不是真正并发的，而是受制于 GIL。如果您想要真正的并发（例如在您的计算机上使用具有不同线程的多核），您应该看看 JRuby 或 Rubinius（2.0 预览版），它们都提供真正的并发线程。

如果您只是想将事情从请求周期中取出以便稍后处理，那么 1.8 中的绿色线程和 1.9 中的 OS-native-but-GILed 线程就可以了。如果你想要更多的可扩展性，你应该看看像[delayed_job](https://github.com/tobi/delayed_job)或[Resque](https://github.com/blog/542-introducing-resque)这样的技术，它们为后台作业引入了持久化的worker。

# c# - 在构建服务器上运行 TextTransform.exe (T4)

> ID：10737306
> 
> 赞同：9
> 
> 时间：2012-05-24T12:14:06.947
> 
> 标签：c#, .net, visual-studio-2010, code-generation, t4

我正在尝试设置一个过程，在该过程中我的 T4 模板将在构建服务器上进行转换（那里没有安装 Visual Studio）。

我已阅读所有在线参考资料，但无法获得显示如何执行此操作的明确来源。

具体来说，这是我遇到的两个问题：

*   TextTransform.exe 引发有关缺少 DLL 的错误：

> C:\TeamCity\buildAgent\work\AppSettings.tt(0,0)：错误 CS0006：编译转换：元数据文件 'Microsoft.VisualStudio.TextTemplating.Interfaces.10.0，版本 = 10.0.0.0，文化 = 中性，PublicKeyToken = b03f5f7f11d50a3a ' 找不到

*使用gacutil*注册 DLL 文件可以解决这个问题，尽管我想避免这一步。

*   在 Visual Studio 外部运行时，使用*Host.ResolvePath(string)*方法不会返回任何值。

此方法有助于确定模板用作其数据源的 .txt 文件的完整路径。没有它，在构建服务器上找不到这个文件。

任何帮助将不胜感激。

编辑：打开一个 MS CONNECT 问题：[https ://connect.microsoft.com/VisualStudio/feedback/details/744137/texttransform-exe-does-not-work-without-vs2010-installed](https://connect.microsoft.com/VisualStudio/feedback/details/744137/texttransform-exe-does-not-work-without-vs2010-installed)

**我检查过的参考资料：**

*   [让 Visual Studio 在每次构建时运行 T4 模板](https://stackoverflow.com/questions/1646580/get-visual-studio-to-run-a-t4-template-on-every-build)
*   [没有 Visual Studio 的 T4？](https://stackoverflow.com/questions/978281/t4-without-visual-studio)
*   [http://msdn.microsoft.com/en-us/library/ee847423.aspx#buildserver](http://msdn.microsoft.com/en-us/library/ee847423.aspx#buildserver)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:08:44.133

我认为问题在于您使用的是主机特定功能，例如 ResolvePath。

我会尝试的一种方法是确保模板不使用 ResolvePath，而是依赖于来自知名位置的相对路径。

这个众所周知的位置可以通过以下方式知道：

```
1\. Convention
2\. Environment variable
3\. Registry
4\. SQL Server
5\. Web Service
6\. And others 
```

如果您不喜欢强制开发人员设置环境变量的想法，我会考虑制作一个“智能”解析路径，该路径使用环境变量（如果可用），否则依赖 Host.ResolvePath。

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T18:15:51.943

抛弃 Microsoft TextTransform.exe 并使用 MonoDevelop 附带的免费软件，它没有外部依赖项。

请参见此处：[没有 Visual Studio 的 T4？](https://stackoverflow.com/questions/978281/t4-without-visual-studio/1395377#1395377)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-18T05:48:59.343

1.  将以下目录从您的开发机器复制到构建服务器。

    来源（您的机器）：

    `%CommonProgramFiles(x86)%\Microsoft Shared\TextTemplating\<version>.0`

    目的地（构建服务器）：

    `%CommonProgramFiles(x86)%\Microsoft Shared\TextTemplating\<version>.0`

    `<version>`最新版本在哪里。

2.  将所有程序集 (.dll) 从您的开发机器复制到构建服务器。

    来源（您的机器）： `%WinDir%\Microsoft.NET\assembly\GAC_MSIL\Microsoft.VisualStudio.TextTemplating.*`

    目的地（构建服务器）：

    `%CommonProgramFiles(x86)%\Microsoft Shared\TextTemplating\<version>.0`

    `*`目录名称的其余部分在哪里。

3.  使用[Gacutil /i](https://msdn.microsoft.com/en-US/library/ex0ss12c(v=vs.110).aspx)将所有复制的程序集安装到构建服务器的 GAC 中。

# spring - 使用速度时出现错误资源未找到异常

> ID：10737309
> 
> 赞同：2
> 
> 时间：2012-05-24T12:14:17.477
> 
> 标签：spring, velocity

无法附加发送邮件的模板..

-servlet.xml

```
<bean id="velocityEngine" 
    class="org.springframework.ui.velocity.VelocityEngineFactoryBean">
        <property name="velocityProperties">
             <value>
              resource.loader=class
              class.resource.loader.class=org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader
             </value>
        </property>
    </bean>
    <bean id="velocityConfig"
        class="org.springframework.web.servlet.view.velocity.VelocityConfigurer">

        <property name="resourceLoaderPath" value="/"/>

</bean>

    <bean id="velocityviewResolver"
          class="org.springframework.web.servlet.view.velocity.VelocityViewResolver"
          p:prefix="/WEB-INF/velocity/"
          p:suffix=".vm" />
</beans> 
```

代码：错误指向我在服务实现中使用的这一行

```
String text = VelocityEngineUtils.mergeTemplateIntoString(velocityEngine, "mailtemplate", model); 
```

我收到一条错误消息，提示找不到任何资源

错误的完整堆栈跟踪是：

```
org.apache.velocity.exception.ResourceNotFoundException: Unable to find resource 'mailtemplate'
    at org.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:483)
    at org.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:354)
    at org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:1400)
    at org.apache.velocity.app.VelocityEngine.mergeTemplate(VelocityEngine.java:370)
    at org.apache.velocity.app.VelocityEngine.mergeTemplate(VelocityEngine.java:345)
    at org.springframework.ui.velocity.VelocityEngineUtils.mergeTemplate(VelocityEngineUtils.java:58)
    at org.springframework.ui.velocity.VelocityEngineUtils.mergeTemplateIntoString(VelocityEngineUtils.java:122)
    at service.impl.EmployeeServiceImpl.sendMail(EmployeeServiceImpl.java:110)
    at controllers.TrainingInvitationController.sendMail(TrainingInvitationController.java:54)
    at controllers.TrainingInvitationController$$FastClassByCGLIB$$176c7e66.invoke()
    at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:149)
    at org.springframework.aop.framework.Cglib2AopProxy$CglibMethodInvocation.invokeJoinpoint(Cglib2AopProxy.java:700)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:149)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:106)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
    at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:635)
    at controllers.TrainingInvitationController$$EnhancerByCGLIB$$b58c7689.sendMail()
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.doInvokeMethod(HandlerMethodInvoker.java:421)
    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:136)
    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:326)
    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:313)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:875)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:807)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:571)
    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:511)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:709)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:445)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:356)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:226)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:627)
    at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:149)
    at org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:123)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:141)
    at org.mortbay.jetty.Server.handle(Server.java:269)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:430)
    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:701)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:617)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:199)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:339)
    at org.mortbay.jetty.nio.HttpChannelEndPoint.run(HttpChannelEndPoint.java:270)
    at org.mortbay.thread.BoundedThreadPool$PoolThread.run(BoundedThreadPool.java:475) 
```

现在如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T16:20:26.383

我得到了答案..我从速度文档本身得到了一个想法..

我只需要在速度 bean 配置中进行修改。有关我所做的更改，请参见下文。

```
<bean id="velocityEngine" class="org.springframework.ui.velocity.VelocityEngineFactoryBean">
<property name="resourceLoaderPath" value="/WEB-INF/velocity/"/>
</bean> 
```

就是这样......现在它对我来说非常完美......

# asp.net - 如何在 Umbraco 4.7 中更改文档类型中通用属性的排序顺序

> ID：10737310
> 
> 赞同：2
> 
> 时间：2012-05-24T12:14:31.300
> 
> 标签：asp.net, .net, umbraco

是否可以以编程方式对 DocumentType 上的属性进行排序？我正在从代码中创建它们，但不确定如何订购它们。

任何建议都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T16:49:10.543

这取决于您想要排序的方式和内容，但这里有一个示例说明如何对它们进行排序：

```
DocumentType dt = DocumentType.GetByAlias("umbTextpage");

//Get the one you want to move to the top.
var property = dt.PropertyTypes.First(p => p.Alias == "bodyText");

//Get the rest. Make sure you have the right TabId.
var otherProperties = dt.PropertyTypes.Where(p => p.Alias != "bodyText" && p.TabId == 8).ToList();

property.SortOrder = 0;
property.Save();

int i = 1;
foreach (var p in otherProperties)
{
    p.SortOrder = i++;
    p.Save();
} 
```

希望这可以为您提供某种起点，如果您还没有想到我们已经... 获取 TabId 的最简单方法是查看数据库中的 cmsTab 表。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-14T14:56:05.327

您是否指基于特定节点的子页面进行排序？我的意思是你的问题有点混乱......

无论如何，如果您想对子页面进行排序；您可以通过以下方式做到这一点。

```
var eventsNode = @Model.NodeById(1058).orderbydesending("createddate"); 
```

谢谢，

开发者jigar

# javascript - 根据单选按钮选择禁用按钮

> ID：10737317
> 
> 赞同：2
> 
> 时间：2012-05-24T12:14:51.563
> 
> 标签：javascript, jquery, jquery-selectors

我有以下 asp.net 代码，用户必须选择带有单选按钮的行，当没有选择单选按钮时，我需要使用 jquery 禁用该按钮，并在选择单选按钮时再次启用它。

```
<asp:GridView ID="GrvOpenForApproval" runat="server" 
        AutoGenerateColumns="False" Width="100%">
        <Columns>
              <asp:BoundField HeaderText="Dealer" DataField="Dealer.DealerNumber" />
            <asp:BoundField HeaderText="RequestNumber" DataField="RequestNumber" />
            <asp:BoundField HeaderText="Chassis"  DataField="Vehicle.Chassis"/>
            <asp:BoundField HeaderText="Commission" DataField="Vehicle.ComissionNumber" />
            <asp:BoundField HeaderText="Created" DataField="RequestDate" DataFormatString="{0:dd/MM/yyyy}" />
            <asp:BoundField HeaderText="Status"  DataField="CurrentStatus" />
            <asp:BoundField HeaderText="Comment" DataField="Comments" />
            <asp:TemplateField HeaderText="Select One">
            <ItemTemplate>
              <input name="RequestBaseId" type="radio" 
                        value='<%# Eval("RequesBaseId") %>' />
            </ItemTemplate>
          </asp:TemplateField>
        </Columns>
        <HeaderStyle CssClass="gridheader" />
    </asp:GridView>
    <br />
    <div class="clear hideSkiplink">
        <asp:Button runat="server" ID="BtnApproveSelected" 
            meta:resourcekey="BtnApproveSelectedResource" 
            onclick="BtnApproveSelectedClick"/>
    </div> 
```

我试过这个，但它不工作

```
Ready: function () {
            $('input[name="RequestBaseId"]').click(function () {
                if (!$(this).val()) {
                    $("#BtnApproveSelected").attr("disabled", "disabled");
                }
                else {
                    $("#BtnApproveSelected").attr("disabled", "");
                }
            });
        } 
```

生成的html

```
<div>

    <table cellspacing="0" rules="all" border="1" id="MainContent_GrvOpenForApproval" style="width:100%;border-collapse:collapse;">

        <tr class="gridheader">

            <th scope="col">Dealer</th><th scope="col">RequestNumber</th><th scope="col">Chassis</th><th scope="col">Commission</th><th scope="col">Created</th><th scope="col">Status</th><th scope="col">Comment</th><th scope="col">Select One</th>

        </tr><tr>

            <td>&nbsp;</td><td>1</td><td>&nbsp;</td><td>&nbsp;</td><td>24/05/2012</td><td>Approval1</td><td>123</td><td>

              <input name="RequestBaseId" type="radio"  

                        value='1' />

            </td>

        </tr><tr>

            <td>DEAL-1</td><td>1</td><td>CH1</td><td>123C</td><td>24/05/2012</td><td>Approval1</td><td>12</td><td>

              <input name="RequestBaseId" type="radio"  

                        value='2' />

            </td>

        </tr><tr>

            <td>&nbsp;</td><td>1</td><td>&nbsp;</td><td>&nbsp;</td><td>24/05/2012</td><td>Approval1</td><td>123</td><td>

              <input name="RequestBaseId" type="radio"  

                        value='3' />

            </td>

        </tr><tr>

            <td>DEAL-1</td><td>1</td><td>CH1</td><td>123C</td><td>24/05/2012</td><td>Approval1</td><td>12</td><td>

              <input name="RequestBaseId" type="radio"  

                        value='4' />

            </td>

        </tr><tr>

            <td>DEAL-1</td><td>1</td><td>CH1</td><td>123C</td><td>24/05/2012</td><td>Approval1</td><td>12</td><td>

              <input name="RequestBaseId" type="radio"  

                        value='5' />

            </td>

        </tr>

    </table>

</div>

    <br />

    <div class="clear hideSkiplink">

        <input type="submit" name="ctl00$MainContent$BtnApproveSelected" value="Approve selected request" id="MainContent_BtnApproveSelected" disabled="disabled" class="aspNetDisabled" ClientID="BtnApproveSelected" />

    </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:19:31.533

试试这个：

```
$('input[name="RequestBaseId"]').change(function() {
    if (!$(this).val()) {
        $("#BtnApproveSelected").prop("disabled", true);
    }
    else {
        $("#BtnApproveSelected").prop("disabled", false);
    }
}); 
```

您还需要在`ClientID`按钮中添加一个：

```
 <asp:Button runat="server" ID="BtnApproveSelected" ClientIDMode="Static"
        meta:resourcekey="BtnApproveSelectedResource" 
        onclick="BtnApproveSelectedClick"/> 
```

您还可以`input[name="RequestBaseId"]`通过使用类来使选择器更好。

# c# - 如何防止将文件下载给未经身份验证的用户

> ID：10737318
> 
> 赞同：3
> 
> 时间：2012-05-24T12:15:18.617
> 
> 标签：c#, authentication, iis, formsauthentication

我有一个网站，用户使用表单身份验证登录该网站，我不希望任何未经身份验证的用户（那些未登录的用户）从中下载文件的文件夹路径。我该如何实施？

谢谢，

萨钦

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:27:27.417

您可以通过配置来做到这一点，请参阅[http://msdn.microsoft.com/en-us/library/8d82143t.aspx](http://msdn.microsoft.com/en-us/library/8d82143t.aspx)

```
<location path="Files">
   <system.web>
     <authorization>
       <deny users="?"/>
     </authorization>
   </system.web>
</location> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:24:20.647

您可以制作功能下载（在服务器端），您将在其中检查当前登录，然后将路径发送到可访问的人的文件。

在这里你可以看到另一种方式[get-files-if-login](https://stackoverflow.com/questions/5310774/how-to-stop-user-not-get-files-if-not-login)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T12:41:17.900

将文件放在授权的文件夹中。这样如果未经授权的用户来到该文件夹​​。他们将被重定向到登录页面以获得授权。

# php - Paypal IPN 脚本/MySql 插入查询问题

> ID：10737319
> 
> 赞同：0
> 
> 时间：2012-05-24T12:15:19.380
> 
> 标签：php, mysql, sql, paypal

我的 IPN 脚本有问题。它可以用于验证付款等，但我试图让它将数据输入数据库。之前的用户电子邮件和密码输入工作正常，但不是第二个..

```
$item_name = $_POST['item_name'];
$item_number = $_POST['item_number'];
$payment_status = $_POST['payment_status'];
$payment_amount = $_POST['mc_gross'];
$payment_currency = $_POST['mc_currency'];
$txn_id = $_POST['txn_id'];
$receiver_email = $_POST['receiver_email'];
$payer_email = $_POST['payer_email'];

$email = $_POST['item_name'];
$password = mt_rand(1000, 9999);
$Random = print_r($_POST);

mysql_query("INSERT INTO users (email, password) VALUES('". mysql_escape_string($email)     ."', '".md5($password)."') ") or die(mysql_error()); 

mysql_query("INSERT INTO LNCH_Sales SET
                                                            item_name = '%s',
                                                            item_number = '%s',
                                                            payment_status = '%s',
                                                            payment_amount = '%s',
                                                            payment_currency = '%s',
                                                                txn_id = '%s',
                                                            receiver_email = '%s',
                                                            payer_email = '%s'",
                                                            mysql_real_escape_string($item['name']),
                                                            mysql_real_escape_string($item['number']),
                                                            mysql_real_escape_string($payment['status']),
                                                            mysql_real_escape_string($payment['amount']),
                                                            mysql_real_escape_string($payment['currency']),       
                                                            mysql_real_escape_string($txn['id']),
                                                            mysql_real_escape_string($receiver['email']),
                                                            mysql_real_escape_string($payer['email'])

                                                                      ); 
```

任何想法这里有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T12:18:10.317

您的语法错误 - 而不是

```
INSERT INTO LNCH_SALES SET 
```

（看起来像是 INSERT 和 UPDATE 的混合体），你需要

```
INSERT INTO LNCH_SALES(<column_list>) VALUES (... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:53:55.687

正如@FrankSchmitt 所说，您可能缺少列列表。

您可以跳过列列表的唯一方法是插入列的数量=表列的数量，即：

```
jcho360> create table test (id int,name varchar(20));
Query OK, 0 rows affected (0.05 sec)

jcho360> insert into test values (1,'Jcho360');
Query OK, 1 row affected (0.00 sec)

jcho360> insert into test values (1);
ERROR 1136 (21S01): Column count doesn't match value count at row 1

jcho360> insert into test(id) values (1);
Query OK, 1 row affected (0.01 sec) 
```

正如您所看到的，只有当我要在“插入”中填充所有列时，您才能跳过列列表。

# sql-server - 添加主键标识列可以解决死锁问题吗？

> ID：10737324
> 
> 赞同：9
> 
> 时间：2012-05-24T12:15:55.650
> 
> 标签：sql-server, concurrency, primary-key, deadlock

我在 SQL Server 中有一个表，该表由在不同会话中同时运行的存储过程同时进行 CRUD 编辑：

`|----------------|---------|`
`| <some columns> | JobGUID |`
`|----------------|---------|`

该程序的工作原理如下：

1.  生成 GUID。
2.  将一些记录插入上述共享表中，并使用步骤 1 中的 GUID 对其进行标记。
3.  对步骤 2 中的所有记录执行一些更新。
4.  选择步骤 3 中的记录作为 SP 输出。

存储过程中的每个 select / insert / update / delete 语句都有一个`WHERE JobGUID = @jobGUID`子句，因此该过程仅适用于它在步骤 2 中插入的记录。但是，有时当相同的存储过程在不同的连接中并行运行时，会发生死锁共享表。这是来自 SQL Server Profiler 的死锁图：

![SQL Server Profiler 死锁图](../Images/309a0640fbfba337501c43ca73b66231.png)

不会发生锁升级。我尝试向`(UPDLOCK, ROWLOCK)`所有 DML 语句添加锁定提示和/或将过程的主体包装在事务中并使用不同的隔离级别，但它没有帮助。共享表上的 RID 锁仍然相同。

之后我发现共享表没有主键/标识列。一旦我添加它，死锁似乎就消失了：

```
alter table <SharedTable> add ID int not null identity(1, 1) primary key clustered 
```

当我删除主键列时，死锁又回来了。当我重新添加它时，我无法再重现死锁。

所以，问题是，主键标识列真的能够解决死锁还是只是巧合？

**更新：**正如[@Catcall](https://stackoverflow.com/users/562459/catcall "猫叫")建议的那样，我尝试在现有列上创建一个自然聚集的主键（不添加标识列），但仍然遇到相同的死锁（当然，这次是键锁而不是 RID 锁）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T13:51:27.287

解决死锁的最佳资源（仍然）在这里：http: [//blogs.msdn.com/b/bartd/archive/2006/09/09/deadlock-troubleshooting_2c00_-part-1.aspx](http://blogs.msdn.com/b/bartd/archive/2006/09/09/deadlock-troubleshooting_2c00_-part-1.aspx)。

Pt #4 说：

> 通过 Database Tuning Advisor 运行涉及死锁的查询。在 Management Studio 查询窗口中执行查询，将 db 上下文更改为正确的数据库，右键单击查询文本并选择“Analyze Query in DTA”。不要跳过这一步；我们看到的超过一半的死锁问题都可以通过添加适当的索引来解决，这样其中一个查询就会运行得更快并且锁占用更少。如果 DTA 推荐索引（它会说“估计改进：%”），创建它们并监视以查看死锁是否持续存在。您可以从“操作”下拉菜单中选择“应用建议”以立即创建索引，或者将 CREATE INDEX 命令保存为脚本以在维护窗口期间创建它们。请务必分别调整每个查询。

我知道这并不能“回答”为什么必然的问题，但它确实表明添加索引可以改变执行方式，使锁占用空间更小或执行时间更快，这可以显着减少死锁的机会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-08T10:27:57.643

最近看到这个帖子，根据上面的信息希望这个帖子对你有帮助，

[http://databaseusergroup.blogspot.com/2013/10/deadlocked-on-sql-server.html](http://databaseusergroup.blogspot.com/2013/10/deadlocked-on-sql-server.html)

# perl - Perl 哈希否定

> ID：10737326
> 
> 赞同：1
> 
> 时间：2012-05-24T12:15:58.460
> 
> 标签：perl

你能帮我更正代码片段吗？

我想列出类型为 eq xyz 但不是命名服务器的服务器。

```
our %SERVERS = (
  "rajesh1" => {type => 'xyz', sha => 'ram'},
  "rajesh2" => {type => 'xyz', sha => 'sita'},
  "rajesh3" => {type => 'xyz', named => ["raa"]},
  "rajesh4" => {type => 'xxx', named => ["rajjaj"]},
);

while ( my $mServer = each(%SERVERS) ) 
{ 
  if ("$SERVERS{$mServer}{type}" eq "xyz" && !"$SERVERS{$mServer}{named}" ) 
  {
    print "Name of the server is $mServer\n";        
  }
} 
```

预期结果：

```
拉杰什1
拉杰什2
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:24:00.950

1.  您在 . 的定义之后缺少一个分号`%SERVERS`。
2.  你开始叫它`$mServer`，然后再说`$gServer`。选一个！
3.  去掉周围的引号`$SERVERS{$mServer}{type}`和`$SERVERS{$mServer}{named}`（一旦你改为`gServer`——`mServer`你就不需要它们了。
4.  您希望看到“rajesh1 rajesh2”，但它们都没有 type `"prod"`。这怎么可能？假设您将它们的类型更改为`"prod"`……</li>
5.  您希望看到“rajesh1 rajesh2”，但您打印`"Name of the server is $mServer\n"`（一旦您更改`gServer`为`mServer`）。将其更改为`"$mServer\n"`, 和 ...</li>
6.  ......它应该工作。

因此：

```
our %SERVERS = (
    "rajesh1" =>  {type => 'prod', sha => 'ram'},
    "rajesh2" =>  {type => 'prod', sha => 'sita'},
    "rajesh3" =>  {type => 'xyz',  named => ["raa"]},
    "rajesh4" =>  {type => 'xxx',  named => ["rajjaj"]},
);

while (my $mServer = each %SERVERS) { 
    if ($SERVERS{$mServer}{type} eq "prod" && !$SERVERS{$mServer}{named}) {
        print "$mServer\n";
    }
} 
```

然后：

```
$ perl test.pl 
rajesh1
rajesh2
$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:27:59.187

完整的示例，捕获两个`each`的返回值，从而减少视觉混乱：

```
use strict;
use warnings;

our %SERVERS = (
    "rajesh1" => {type => 'xyz',  sha => 'ram'},
    "rajesh2" => {type => 'xyz',  sha => 'sita'},
    "rajesh3" => {type => 'xyz',  named => ["raa"]},
    "rajesh4" => {type => 'xxx',  named => ["rajjaj"]},
    "rajesh5" => {type => 'prod', sha => 'ram'},
    "rajesh6" => {type => 'prod', named => ["jajaja"]},
);

while ( my( $mServer, $mData ) = each %SERVERS ) { 
    if ($mData->{type} eq "prod" && !$mData->{named}) {
        print "Name of the server is $mServer\n";
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T12:18:18.713

您正在寻找`defined`.

```
if ($SERVERS{$mServer}->{type} eq "xyz" &&
    ! defined $SERVERS{$mServer}->{named} )
... 
```

您使用的是未定义的变量`$gServer`，显然您打算使用循环变量`$mServer`。您应该`use strict; use warnings;`在所有脚本中；这使得很容易发现这个错误（以及许多其他错误）。

我使用间接运算符`->`来访问哈希引用的内容作为偏好。我还删除了一些无端引用作为文体变化。

# facebook - 像按钮图像未显示在时间轴中

> ID：10737329
> 
> 赞同：0
> 
> 时间：2012-05-24T12:16:18.730
> 
> 标签：facebook, button, facebook-like, facebook-opengraph

我在我的网站上使用了 Facebook 的点赞按钮，但是当我点击“点赞”按钮时，我在时间轴上看不到图片。其他一切正常。

我使用这段代码：

```
<meta property="og:image" content="/images/fblogo.jpg"/> 
```

其他两个标签工作正常。

```
<meta property="og:title" content="..."/>
<meta property="og:site_name" content="..."/> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:19:11.390

您必须将您的图像称为完全限定路径 ( `http://www.yourdomain.com/images/fblogo.jpg`)

确保您`prefix="og: http://ogp.me/ns#"`的`html`标签中有

另外，要测试 - 确保您使用的是[facebook lint 工具](http://developers.facebook.com/tools/debug)，这样您就可以击败 facebook 的缓存。它还会告诉您何时有无效标签和不正确的标签值。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-13T22:11:58.413

遇到同样的错误，并通过添加`property="og:description"`到元描述标签来解决它，这解决了我的问题，但我不知道谷歌是否喜欢它......

# android - 获取当前用户喜欢的帖子状态

> ID：10737331
> 
> 赞同：1
> 
> 时间：2012-05-24T12:16:29.000
> 
> 标签：android, facebook, facebook-graph-api, facebook-fql, facebook-android-sdk

我已经能够使用“me/home”图形 API 调用为登录用户提取 Facebook 新闻源，并在活动中显示结果。

现在我一直在尝试多种方法来查询帖子的like 列并检查当前用户是否喜欢帖子以显示状态。本质上，我正在设置一个可绘制对象以指示用户喜欢一个帖子。

我无法真正发布到目前为止我尝试过的任何代码，因为它们都不起作用。相信我，我已经尝试了无数种方法。

如果有人至少能在正确的方向上刺激我，我将不胜感激。

编辑：这是我查询喜欢列并将结果与​​当前用户的 ID 进行比较的最新尝试：

这段代码是我检查喜欢计数并将它们添加到 ArrayList 的地方。这也是我运行查询以在帖子中获得喜欢的地方。

```
// GET THE POST'S LIKES COUNT

    if (json_data.has("likes")) {
        JSONObject feedLikes = json_data.optJSONObject("likes");
        String countLikes = feedLikes.getString("count");
        postLikesCountArrayList.add(countLikes);

        // TEST STARTS

        // QUERY THE LIKES COLUMN TO CHECK YOUR LIKE STATUS ON A POST

        Bundle params = new Bundle();
        params.putString(Facebook.TOKEN, Utility.mFacebook.getAccessToken());
        Utility.mAsyncRunner.request(finalThreadID + "/likes&limit=200", params, new LikesListener());

        // TEST ENDS
        } else {
            String countLikes = "0";
            postLikesCountArrayList.add(countLikes);
        } 
```

此代码块是检查结果的侦听器（同一活动中的私有类）：

```
private class LikesListener extends BaseRequestListener {
        @Override
        public void onComplete(final String response, final Object state) {

            try {
                JSONObject JOLikes = new JSONObject(response);

                JSONArray JALikes = JOLikes.getJSONArray("data");

                for (int i = 0; i < JALikes.length(); i++) {
                    JSONObject JOTemp = JALikes.getJSONObject(i);

                    if (JOTemp.has("id"))   {
                        String getTempID = JOTemp.getString("id");

                        if (getTempID.equals(initialUserID))    {

                            Runnable run = new Runnable() {

                                @Override
                                public void run() {
                                    // TODO Auto-generated method stub

                                    ImageView postYourLike = (ImageView) findViewById(R.id.postYourLike);
                                    postYourLike.setBackgroundResource(R.drawable.btn_icon_liked);
                                }
                            };
                            TestNewsFeeds.this.runOnUiThread(run);
                        }
                    }

                }
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:34:19.887

您可以使用此 fql。替换 post_id

```
SELECT likes.can_like, likes.user_likes FROM stream WHERE  post_id = "1274834235_3976149403543" 
```

响应看起来像这样，如果 user_likes 是真的，他喜欢它

```
 {
  "data": [
    {
      "likes": {
        "can_like": true, 
        "user_likes": false
      }
    }
  ]
} 
```

# push-notification - APN 设备令牌在一段时间后停止接收任何 apns

> ID：10737339
> 
> 赞同：1
> 
> 时间：2012-05-24T12:17:10.177
> 
> 标签：push-notification, apple-push-notifications

我有定期从我的服务器接收 APN 的应用程序。它在启动时调用 registerForRemoteNotificationTypes ，然后定期（在工作时）重新调用它。它正确接收设备令牌并将其发送到后台服务器以供以后使用。

但是有一个问题：
- 应用程序启动后，它正确接收了从我的服务器通过应用程序启动时由 iphone 生成的设备令牌发送的所有 apns。
- 但是当应用程序在后台停留（没有任何重新启动）大约 8-12 小时时，它会停止接收任何东西
- 通过检查应用程序/服务器日志，我看到应用程序通过 registerForRemoteNotificationTypes 定期正确地重新请求新令牌，正确地接收到完全相同的令牌它从一开始，后台服务器就继续使用它来发送 apns 并将它们通过套接字发送到苹果而没有任何错误
- 但消息根本不再显示在设备上，根本没有调用 didReceiveRemoteNotification
- 手动退出应用程序并重新启动它有帮助 - registerForRemoteNotificationTypes返回*另一个*令牌，效果很好 - 服务器使用它来发送 apns，设备立即接收它们，正如预期的那样。

所以看起来 iphone 只在应用程序启动时向苹果服务器重新请求令牌，然后对其进行硬缓存。但令牌仍然有类似 ttl 句点的东西。

每次应用程序要求它时，有什么方法可以强制 iphone 返回新的、实际的设备令牌？如何强制 iphone 重新检查苹果服务器上的设备令牌以确保它确实正常且健康？

请帮忙！

* * *

UPD：设法缩小问题范围 - 使用沙盒 apn 环境（因为我们正在开发它）有问题的应用程序 - 我将 APN 发送过程更改为扩展协议，现在看到一段时间后 aplle 沙盒服务器开始回复错误 8 - 无效令牌. 同时*设备从 registerForRemoteNotification 接收相同的旧令牌*。所以iOS刷新令牌肯定有问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T08:13:55.613

从沙盒环境切换到生产环境后 - 问题消失了。所以沙盒和生产门之间存在区别：沙盒环境中的设备令牌 ttl 比生产中的要短得多。尽管如此，手机本身的设备令牌对于两种环境都是相同的。所以使用沙盒环境会导致这个问题 - 手机为应用程序返回无效（已经在服务器上无效）设备令牌

# php - 使用 CURL 读取 JSON 数据

> ID：10737345
> 
> 赞同：0
> 
> 时间：2012-05-24T12:17:55.020
> 
> 标签：php, curl

我正在尝试使用 CURL 读取 URL。当我在浏览器中运行此 URL 时，系统会下载一个文件，文件中的内容如下

`{"Success":true,"Message":"Success","Response":0.0000}`

现在我想获取这个文件的内容。到目前为止，我已经使用了这个-

```
$send_curl = curl_init($url);
curl_setopt($send_curl, CURLOPT_URL, $url);
curl_setopt($send_curl, CURLOPT_HEADER, false);
curl_setopt($send_curl, CURLOPT_CONNECTTIMEOUT, 2);
curl_setopt($send_curl, CURLOPT_POST, TRUE);
curl_setopt($send_curl, CURLOPT_RETURNTRANSFER, true);
curl_setopt($send_curl, CURLOPT_HTTPHEADER,array('Accept: application/json', "Content-type: application/json"));
curl_setopt($send_curl, CURLOPT_FAILONERROR, FALSE);
curl_setopt($send_curl, CURLOPT_SSL_VERIFYPEER, FALSE);
curl_setopt($send_curl, CURLOPT_SSL_VERIFYHOST, FALSE);
$json_response = curl_exec($send_curl);
$status = curl_getinfo($send_curl, CURLINFO_HTTP_CODE);
curl_close($send_curl);

$response = json_decode($json_response, true); 
```

但我没有得到适当的回应。知道我哪里出错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:43:02.480

在对本地 json url 进行快速测试后，我发现如果你删除它，你会没事的：

`curl_setopt($send_curl, CURLOPT_POST, TRUE);`

我的意思是，如果您不想实际发布。否则，它总是给我一个“400 Bad Request”错误。

希望这可以帮助！

# android - 一旦收到物品，微调器就会向下移动

> ID：10737346
> 
> 赞同：3
> 
> 时间：2012-05-24T12:17:55.957
> 
> 标签：android, android-layout

我有一个简单的布局，下面是一个相关的片段。它看起来和我想要的完全一样——只要微调器是空的。一旦我向它添加项目（在运行时） - 它会像下降一半的高度一样跳跃。为什么？

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical" >

            <TableLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="top"
                android:layout_marginTop="10dp" >

                <TableRow
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content" >

                    <TextView
                        android:id="@+id/lbl"
                        style="@style/Label.Plain"
                        android:layout_height="@dimen/button_height"
                        android:layout_marginRight="5dp"
                        android:layout_weight="0"
                        android:gravity="left|center_vertical" />

                    <Spinner
                        android:id="@+id/spinner"
                        style="@style/Spinner"
                        android:background="#ff0000"
                        android:layout_width="fill_parent"
                        android:layout_weight="1" />

                </TableRow>
            </TableLayout>
        </LinearLayout>
    </LinearLayout>
</ScrollView> 
```

这是“Spinner”风格：

```
<style name="Spinner" parent="@android:style/Widget.Holo.Spinner">
        <item name="android:layout_width">fill_parent</item>
        <item name="android:layout_height">@dimen/button_height</item>
        <item name="android:textSize">@dimen/spinner_text</item>
        <item name="android:textColor">@color/button</item>
        <item name="android:gravity">center_vertical</item>
        <item name="android:padding">2dp</item>
        <item name="android:maxLines">1</item>
   </style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T10:38:14.493

不明白为什么，但是一旦我将微调器的填充设置为 0dp 而不是样式指定的 2dp，问题就消失了。

# java - 我首先要做什么 - 取消 ScheduledFuture 或关闭 ScheduledExecutorService？

> ID：10737350
> 
> 赞同：16
> 
> 时间：2012-05-24T12:18:22.703
> 
> 标签：java, multithreading

我的代码：

```
ScheduledServiceExecutor service = Executors.newSingleThreadScheduledExecutor();
ScheduledFuture future = service.scheduleWithFixedDelay(
  runnable, 1, 1, TimeUnit.MILLISECONDS
);
// ...
// now it's time to shut it all down
future.cancel(true);
service.shutdown(); 
```

我在这里吗？也许我应该这样做：

```
service.shutdown();
future.cancel(true); 
```

你怎么看？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-24T12:31:59.510

**在这种情况下，您只需要调用`shutdown()`.**

中有两个选项`ScheduledThreadPoolExecutor`，这是这里在幕后创建的。 `getExecuteExistingDelayedTasksAfterShutdownPolicy()`默认为`true`并且`getContinueExecutingPeriodicTasksAfterShutdownPolicy()`默认为`false`. 所以，简单地关闭服务会导致周期性任务被取消，但任何延迟的任务仍然会被执行。由于有问题的任务是一个周期性的任务，它会在关机时被取消。

我个人的看法是，最好`.cancel(true)`在关机前手动调用。虽然在操作上这没有不同的效果，但我认为对于可能不知道执行程序选项的程序员来说，看到周期性任务意味着在关闭时被取消是件好事。这也意味着，如果有人进来并将执行程序更改为在关闭时不会取消的执行程序，此任务仍将被取消。所以说真的，我认为这里的主要好处是代码清晰。

# stylecop - 我在 MS VS Web Developer Express 中安装了 StyleCop，无法编辑设置

> ID：10737359
> 
> 赞同：3
> 
> 时间：2012-05-24T12:18:46.090
> 
> 标签：stylecop, visual-web-developer-2010

我正在寻找设置文件以手动更改设置 - 但找不到它。

我按照以下说明进行安装：[http ://stylecop.codeplex.com/wikipage?title=Setting%20Up%20StyleCop%20MSBuild%20Integration](http://stylecop.codeplex.com/wikipage?title=Setting%20Up%20StyleCop%20MSBuild%20Integration)

（除了一个例外，我将 StyleCop.Targets 文件放在我的项目文件夹中）

StyleCop 运行正常，但我想更改设置 - 我在哪里可以找到设置文件夹？我读到它在 StyleCop.Targets 所在的目录中查找，然后向上移动一个目录，直到它到达搜索文件的驱动器的根目录 - 但我找不到它。

找到它的另一种方法是在某处在线查找示例 StyleCop 设置文件，以便我可以下载它并将其放在我的目录中并指向该设置文件。有人知道这样的文件吗？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:21:34.743

你不会看到 StyleCop 的 UI 集成，因为 VS Express 版本不支持像 StyleCop 这样的插件和包的集成。

如果您使用 Express，您仍然可以运行 StyleCop，但这需要使用 MSBuild 集成或构建前或构建后事件。

[请参阅此链接以配置 StyleCop](http://stylecop.codeplex.com/wikipage?title=Running%20StyleCop%20in%20VS2005%20or%20VS%20Express)

# mysql - MySQL计算排名然后从结果更新表

> ID：10737361
> 
> 赞同：2
> 
> 时间：2012-05-24T12:19:06.377
> 
> 标签：mysql, rank

我的问题是我正在尝试计算所有用户条目，然后对它们进行排名。在对它们进行排名后，我想更新用户表以记录每个用户的排名。

表：

用户表

活动表

我整晚都在搜索，这就是我到目前为止所拥有的。

```
SET @rank := 0;
SELECT * FROM (
SELECT @rank := @rank + 1 AS rank, a.userName
FROM activityTbl a
LEFT JOIN userTbl u ON a.userName = u.userName
GROUP BY a.userName
ORDER BY SUM( TIME_TO_SEC( a.actTime ) )DESC
) as sub 
```

这将返回：

排名|用户

1 金

2约翰

3乔

这很好，但我尝试将 Update 和 Set 添加到此查询中以更新 userTbl，但我无法让它工作。

请帮忙！如果您需要更多信息，请与我们联系。

更新：

对于那些正在寻找我所做的来纠正我的问题的人。

首先，我发布了错误的 MySQL。我用来解决问题的方法是：

```
SET @rownum := 0;
SELECT @rownum := @rownum + 1 AS rank, userName, actTimeTotal 
FROM (SELECT SUM(TIME_TO_SEC(actTime)) AS actTimeTotal , userName 
FROM activityTbl 
GROUP BY userName 
ORDER BY actTimeTotal DESC) as result 
```

其次，我创建了一个名为 rankTbl 的排名表，其中包含 2 列：rank smallInt 和 userName varchar。

三、修改MySql脚本为：

```
SET @rownum := 0;
INSERT INTO rankTbl( rank, userName)
SELECT @rownum := @rownum + 1 AS rank, userName 
FROM (SELECT SUM(TIME_TO_SEC(actTime))AS actTimeTotal , userName 
FROM activityTbl 
GROUP BY userName 
ORDER BY actTimeTotal DESC) as result
ON DUPLICATE KEY UPDATE userName = VALUES(userName); 
```

我将 ON DUPLICATE KEY UPDATE 更改为 userName 而不是排名。当等级改变时，用户名的等级没有更新。使用 userName 更新排名变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:37:26.373

您需要做的是确保您的排名表具有用户的主键，然后发出带有 KEY 错误规定的 SELECT 的 INSERT：

假设您的表已命名`tbl`并包含一个`rank`字段和一个`user`字段，我基本上是说您需要以下查询来为所有行返回**重复键错误：**

```
SET @rank := 0;
INSERT INTO tbl (rank, user)
    SELECT @rank := @rank + 1 AS rank, a.userName
    FROM activityTbl a
    LEFT JOIN userTbl u ON a.userName = u.userName
    GROUP BY a.userName
    ORDER BY SUM(TIME_TO_SEC(a.actTime)) DESC; 
```

一旦你有了它并且你确定它为它试图插入的所有行返回一个**重复的键错误**，你修改它如下：

```
SET @rank := 0;
INSERT INTO tbl (rank, user)
    SELECT @rank := @rank + 1 AS rank, a.userName
    FROM activityTbl a
    LEFT JOIN userTbl u ON a.userName = u.userName
    GROUP BY a.userName
    ORDER BY SUM(TIME_TO_SEC(a.actTime)) DESC
ON DUPLICATE KEY UPDATE rank = VALUES(rank); 
```

# php - 从 Google 电子表格中的多值组合列表创建唯一对列表

> ID：10737363
> 
> 赞同：1
> 
> 时间：2012-05-24T12:19:17.727
> 
> 标签：php, excel, vba, google-sheets, google-apps-script

我在 Google 电子表格中有一堆如下所示的行：

```
a,b,c,d
a,d
c,d
b,d,f
a,b,f,g,h,i
q,b,b 
```

...然后继续。

我需要一种方法来创建这种格式的相关对的唯一列表：

```
a,b
a,c
a,d
b,c
b,d
c,d
b,f
d,f
a,f
a,g
a,h
a,i 
```

...然后继续。

知道我会怎么做吗？我愿意接受使用 Google 电子表格的脚本语言、Excel 2004 的脚本语言或 PHP 之类的其他语言的答案。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T03:28:23.913

不确定这是否满足您的平台要求，但这里有一个可以在 Google 电子表格本身中使用的*电子表格公式（虽然不是在任何 Excel 版本中）：*

```
=ArrayFormula(SORT(TRANSPOSE(SPLIT(CONCATENATE(REPT(UNIQUE(TRANSPOSE(SPLIT(JOIN(",";A:A);",")))&","&TRANSPOSE(UNIQUE(TRANSPOSE(SPLIT(JOIN(",";A:A);","))));(UNIQUE(TRANSPOSE(SPLIT(JOIN(",";A:A);",")))<=TRANSPOSE(UNIQUE(TRANSPOSE(SPLIT(JOIN(",";A:A);",")))))*REGEXMATCH(CONCATENATE(","&SUBSTITUTE(A:A;",";",,")&","&CHAR(9));"(,"&UNIQUE(TRANSPOSE(SPLIT(JOIN(",";A:A);",")))&",[^\t]*,"&TRANSPOSE(UNIQUE(TRANSPOSE(SPLIT(JOIN(",";A:A);","))))&",)|(,"&TRANSPOSE(UNIQUE(TRANSPOSE(SPLIT(JOIN(",";A:A);","))))&",[^\t]*,"&UNIQUE(TRANSPOSE(SPLIT(JOIN(",";A:A);",")))&",)"))&CHAR(9));CHAR(9))))) 
```

它还假设您不想列出“b,a”和“a,b”。

编辑：对于非常大的数据集，这类公式可能效率极低，因此仅在处理几百行或更少行时才考虑使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:33:42.537

这是配对的功能：

```
<?php
function make_pairs($str) {
  $chars = explode(',', $str);
  for ($i = 0; $i <= count($chars); $i++) {
    $f = array_shift($chars);
    foreach ($chars as $char) 
      echo "$f,$char\n";
  }
}

make_pairs('a,b,c,d'); 
```

结果：

```
a,b
a,c
a,d
b,c
b,d
c,d 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T13:10:59.867

由于您已用 标记了上述问题`VBA`，因此这是一个 vba 解决方案。

这将为您提供上述示例应该具有的所有 45 种独特组合。

**我的假设**

**1)**数据在 Sheet1 的 Col A 中

**2)** Col A 没有任何标题

**3)**在 Col B 中生成的输出

**4)**您正在使用 Excel 2007 +

**5）**您正在考虑`b,b`作为有效组合，因为`q,b,b`. 如果不是，则需要添加一个小调整。

```
Option Explicit

Sub Sample()
    Dim ws As Worksheet
    Dim lRow As Long, nRow As Long, n As Long
    Dim i As Long, j As Long, k As Long
    Dim Myar() As String, TempAr() As String

    Set ws = Sheet1
    lRow = ws.Range("A" & Rows.count).End(xlUp).Row

    n = 0: nRow = 1

    With ws
        For i = 1 To lRow
            Myar = Split(.Range("A" & i).Value, ",")
            If UBound(Myar) > 1 Then
                For j = LBound(Myar) To UBound(Myar)
                    For k = LBound(Myar) To UBound(Myar)
                        If j <> k Then
                            ReDim Preserve TempAr(n)
                            TempAr(n) = Myar(j) & "," & Myar(k)
                            n = n + 1
                        End If
                    Next k
                Next j
            Else
                ReDim Preserve TempAr(n)
                TempAr(n) = .Range("A" & i).Value
                n = n + 1
            End If
        Next i

        For i = LBound(TempAr) To UBound(TempAr)
            .Range("B" & nRow).Value = TempAr(i)
            nRow = nRow + 1
        Next i

        '~~> Remove duplicates
        .Range("$B$1:$B$" & UBound(TempAr) + 1).RemoveDuplicates _
        Columns:=1, Header:=xlNo

        '~~> Sort data
        .Range("$B$1:$B$" & UBound(TempAr) + 1).Sort _
        .Range("B1"), xlAscending

        Debug.Print "Total Combinations : " & _
        Application.WorksheetFunction.CountA(Columns(2))
    End With
End Sub 
```

![在此处输入图像描述](../Images/d2387cb29bde1a104d9dfb0366c2b03e.png)

**跟进**

不确定这是否适用于 Excel 2004 但替换该行

```
 .Range("$B$1:$B$" & UBound(TempAr) + 1).RemoveDuplicates _
        Columns:=1, Header:=xlNo 
```

和

```
 For i = 1 To UBound(TempAr)
            If Application.WorksheetFunction.CountIf(.Range("B" & i).Value) > 1 Then
                .Range("B" & i).ClearContents
            End If
        End With 
```

我猜休息保持不变。测试一下，如果你有任何错误，请告诉我？

# javascript - 如何使 HTML 页面中的对话框选择本地文件路径？

> ID：10737365
> 
> 赞同：0
> 
> 时间：2012-05-24T12:19:24.950
> 
> 标签：javascript, html, ajax

我正在编写一个具有用于配置的 Web 界面的服务器应用程序。一些选项 - 本地文件的路径。现在只是

```
<input type = "text" ... > 
```

但我想要一个打开文件选择器的按钮。我知道有

```
<input type="file"...>, 
```

但它不允许 then 获得路径。这在不同的浏览器中以不同的方式实现。有时路径是空的，有时是假的。这是由于您的浏览器中的安全策略，使攻击者没有看到用户文件存储的结构。是否有可能以某种方式实现对话并获得所选文件路径的可能性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:30:53.950

嗯，对于您已经提到的规则，我认为您无法做到。您可以使用的唯一错误是：

*   限制只在IE下获取动态路径的使用
*   从 IE 实现 ActiveX 管理
*   与 windows 的 API "GetOpenFileName" 通信

这真的很脏，但如果你不介意这里有一个解决方案。

rgds

# struts - ActionForm 什么时候实例化？

> ID：10737367
> 
> 赞同：1
> 
> 时间：2012-05-24T12:19:31.830
> 
> 标签：struts

我正在为应用程序使用 Struts 1.x。

我想知道什么时候`ActionForm`实例化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:55:33.753

实际上将`ActionServlet`请求处理作业委托给它的`RequestProcessor`.

当请求到达时，将调用 action servlet 的`doGet`或`doPost`方法。这些方法中的任何一个都将调用 action servlet 的`process`方法，该方法又调用请求处理器的`process`方法。这就是一切发生的地方，大致如下 -

1.  查找`ActionMapping`当前请求。
2.  获取（也可能是创建）`ActionForm`实例。
3.  填充表单。
4.  验证表格。
5.  获取（创建）`Action`实例。
6.  执行动作。
7.  最后是转发或重定向。

如果您想（或需要）详细了解，那么您可以随时查看源代码。以下是 Struts 1.3.10 源代码的链接（如果不是您的版本，您还可以找到其他版本的 struts 的源代码） -

*   [`org.apache.struts.action.ActionServlet`](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.struts/struts-core/1.3.10/org/apache/struts/action/ActionServlet.java#ActionServlet)
*   [`org.apache.struts.action.RequestProcessor`](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.struts/struts-core/1.3.10/org/apache/struts/action/RequestProcessor.java#RequestProcessor)

# arduino - 无线红外系统中的 Arduino 通信

> ID：10737368
> 
> 赞同：2
> 
> 时间：2012-05-24T12:19:32.990
> 
> 标签：arduino, wireless, infrared

我有两个 Arduino，我想将它们放入无线系统中，以将 IR 代码从房子的一个房间的手持遥控器中继到另一个房间的机顶盒。一个 Arduino 有一个 IR 解码器，它从手持遥控器解码密钥，然后将其发送到另一个 Arduino，该 Arduino 用一个 IR 发射器停在盒子前面。该系统部分工作正常。当我从检测器（到我的电脑）获取代码并手动（从我的电脑）发送到发射的 Arduino 时，它会正确控制盒子。但是当我尝试直接在 Arduinos 之间无线发送代码时，它就不太正常了。命令似乎没有正确中继，并且发出的 Arduino 无法控制 bx。

这是解码 Arduino 代码的样子。"myNumber" 持有 4 字节密钥：

```
myNumber.UL = results->value;
Serial.write(&myNumber.B,4); 
```

当解码器检测到 IR 模式时，无论我使用发射器还是按下遥控器上的开/关键，它都会将以下内容发送到串行端口。有问题的密钥是 61A0F00F（电源开/关）：

```
 Hex Field      ASCII 
```

0000 0F F0 A0 61 ...a

当我将实际遥控器指向检测器时，或者当我使用代码 61A0F00F 驱动我的发射器时，解码器会发出相同的响应。所以它无法区分实际遥控器和 Arduino 驱动的发射器之间的区别。问题是系统发射端的 Arduino 无法正确理解此输出。

这是发射代码的样子：

```
 void loop() {
  int x = 0;
  while (x < 4) {
    if (Serial.available()) myNumber.B[x++] = Serial.read();
}    
Serial.print(myNumber.UL, HEX);

if (x==3) irsend.sendNEC(myNumber.UL, 32);  //drive IR emitter with NEC code
delay(10000); 
```

串行输出如下所示：

```
 HEX field                 ASCII Field 
```

0000 36 31 41 30 46 30 30 46 61A0F00F

当我手动输入这个十六进制代码时，即通过CoolTerm，反转（所以0FF0A061）机顶盒响应（通过打开）。当我无线连接 Arduinos 时，它没有。

任何人都可以看到上面的通信有什么问题吗？十六进制字段中的数字看起来不太正确，解码器的十六进制字段看起来像十六进制，但发射器的十六进制字段看起来像 ASCII？那么发射器是否需要一个 ASCII 数字但得到的是十六进制？我会认为 Serial.read 和 Serial。write 会以同样的方式工作。

这非常令人沮丧，因为该系统似乎几乎，几乎可以工作，但不完全！

任何帮助/见解将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:14:03.893

First a disclaimer: I haven't coded my arduino for several years.

At first glance it would appear you are being bitten by a conversion bug. I see a lot of conversions from byte to long etc. The key here would be to break things down to their simplest level and verify each level works.

First off I would verify the number of bytes being sent by checking the return value from Serial.write is indeed 4\. Something as simple as flashing an led if Serial.write returns 4.

On the receiving end I think I would use [ReadBytesUntil](http://arduino.cc/en/Serial/ReadBytesUntil) as this seems to be designed to do what you want and builds in some error checking (time outs and only 4 bytes).

I hope this helps. If not follow the golden rule: when in doubt - post more code!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T08:53:51.217

希望迟到的回复有所帮助。

发射端输出数据正确。在您的情况下，myNumber.UL = 0x61A0F00F。执行代码“Serial.print(myNumber.UL, HEX);”时，打印类实际发出的字符序列为 '6''1''A''0''F''0''0'' F'。所以在你的串口监视器中，ACII 数据是“61A0F00F”，对应的 HEX 数据是“36 31 41 30 46 30 30 46”。您对通过文本和二进制格式传输数据感到困惑。

您的代码的问题在于“if (x==3) irsend.sendNEC(myNumber.UL, 32);”行。接收到四个字节的数据后，x 是 4 而不是 3。将条件 x==3 更改为 x==4 可以解决您的问题。

# php - 点击进入的不同行为

> ID：10737370
> 
> 赞同：2
> 
> 时间：2012-05-24T12:20:00.750
> 
> 标签：php, javascript, ajax

单击提交按钮时，ajax 工作并且调用 php 页面 (no refresh) ，但是当按下回车时它刷新页面并且脚本不起作用，并且只`?txtname=(INPUTED TEXT)`出现在页面 URL 的末尾。

阿贾克斯代码：

```
var time_variable;
var root2 = location.protocol + '//' + location.host + '/testing.php';

function getXMLObject()  //XML OBJECT
{
   var xmlHttp = false;
   try {
     xmlHttp = new ActiveXObject("Msxml2.XMLHTTP")  // For Old Microsoft Browsers
   }
   catch (e) {
     try {
       xmlHttp = new ActiveXObject("Microsoft.XMLHTTP")  // For Microsoft IE 6.0+
     }
     catch (e2) {
       xmlHttp = false   // No Browser accepts the XMLHTTP Object then false
     }
   }var root = location.protocol + '//' + location.host;
   if (!xmlHttp && typeof XMLHttpRequest != 'undefined') {
     xmlHttp = new XMLHttpRequest();        //For Mozilla, Opera Browsers
   }
   return xmlHttp;  // Mandatory Statement returning the ajax object created
}

var xmlhttp = new getXMLObject();   //xmlhttp holds the ajax object

function ajaxFunction() {
  var getdate = new Date();  //Used to prevent caching during ajax call
  if(xmlhttp) {
    var txtname = document.getElementById("txtname");
    xmlhttp.open("POST",root2,true); //calling testing.php using POST method
    xmlhttp.onreadystatechange  = handleServerResponse;
    xmlhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    xmlhttp.send("txtname=" + txtname.value); //Posting txtname to PHP File
  }
}

function handleServerResponse() {
   if (xmlhttp.readyState == 4) {
     if(xmlhttp.status == 200) {
       document.getElementById("message").innerHTML=xmlhttp.responseText; //Update the HTML Form element
     }
     else {
        alert("Error during AJAX call. Please try again");
     }
   }
} 
```

html部分：

```
<body>
<form name="myForm">
<table>
 <tr>
  <td>Enter Name</td>
  <td><input type="text" name="txtname" id="txtname" value="<?php echo $f ?>" /></td>
 </tr>
 <tr>
  <td colspan="2"><input type="button" value="Submit" onclick="ajaxFunction();" /></td>
 </tr>
</table>
</form>
<div id="message" name="message"></div>
</body> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:21:41.810

您需要在`onsumbit`表单中添加属性：

```
<form name="myForm" onsubmit="ajaxFunction(); return false;"> 
```

`return false;`是防止页面刷新（即真实提交而不是ajax）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T12:22:57.147

应用处理程序来提交表单，而不是单击按钮

```
<form name="myForm" onsubmit="ajaxFunction();"> 
```

这样，您的功能在任何情况下都可以工作，通过输入或按钮单击提交表单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T12:23:42.700

代替

```
<form name="myForm"> 
```

和

```
<form name="myForm" onsubmit="ajaxFunction();return false;"> 
```

因为表单将使用 GET 方法在页面本身上使用 ENTER 提交自身，除非您在 ENTER 按键上定义要执行的操作。

# node.js - 如何通过添加附加参数来重定向传入的 URL 请求

> ID：10737372
> 
> 赞同：3
> 
> 时间：2012-05-24T12:20:04.377
> 
> 标签：node.js, redirect

问题：我收到一个对我的服务器应用程序的传入 HTTP 请求。请求是这样的：[http](http://example.com?id=abc) ://example.com?id=abc 。我需要解析这个请求，修补额外的 URL 参数并调用一个托管的 html 文件。所以：

[http://example.com?id=abc](http://example.com?id=abc) => [http://example.com:8080/temp.html?id=abc&name=cdf](http://example.com:8080/temp.html?id=abc&name=cdf)。

所以客户端应该看到 temp.html

这是代码：

```
function onRequest(request,response) {
if(request.method =='GET') {
        sys.debug("in get");
        var pathName = url.parse(request.url).pathname;
        sys.debug("Get PathName" + pathName + ":" + request.url);
        var myidArr = request.url.split("=");
        var myid = myidArr[1];
        //Call the redirect function
        redirectUrl(myid);
}
http.createServer(onRequest).listen(8888);

function redirectUrl(myid) {
var temp='';
    var options = {
      host: 'localhost',
      port: 8080,
      path: '/temp.html?id=' + myid + '&name=cdf',
      method: 'GET'
    };
  var req = http.request(options, function(res) {
    console.log('STATUS: ' + res.statusCode);
    console.log('HEADERS: ' + JSON.stringify(res.headers));
    res.setEncoding('utf8');
    res.on('data', function (chunk) {
      temp = temp.concat(chunk);
    });
    res.on('end', function(){
        return temp;
      });
    });
  req.end();
  return temp;
} 
```

尽管这是解决此问题的一种非常愚蠢的方法，但我确实在 res.end() 回调中看到了响应。如何将此传播到父调用函数 onRequest ？

仅使用 node 是否有更简单的方法？我知道有一些方法可以提供静态 html 文件。但是，我需要将 URL 参数传递给 temp.html - 所以我不确定如何执行此操作。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-24T13:07:20.753

只是想知道更简单的重定向是否可以达到目的：

```
 function onRequest(request,response) {
    if(request.method =='GET') {
       sys.debug("in get");
       var pathName = url.parse(request.url).pathname;
       sys.debug("Get PathName" + pathName + ":" + request.url);
       var myidArr = request.url.split("=");
       var myid = myidArr[1];
       var path = 'http://localhost:8080/temp.html?id=' + myid + '&name=cdf';
       response.writeHead(302, {'Location': path});
       response.end();
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T12:31:53.217

这是进入异步世界时的经典错误。您没有`return`文件的值，而是将回调作为参数传递并使用最终值执行它，如下所示：

```
function proxyUrl(id, cb) {
  http.request(options, function(res) {
    // do stuff
    res.on('data', function (chunk) {
      temp = temp.concat(chunk);
    });
    res.on('end', function(){
      // instead of return you are using a callback function
      cb(temp);
    });
}

function onRequest(req, res) {
  // do stuff
  proxyUrl(id, function(htmlContent) {
    // you can write the htmlContent using req.end here
  });
}

http.createServer(onRequest).listen(8888); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T12:28:42.977

您必须将原件传递`response`给您的`redirectUrl`函数，并让它写入响应。就像是：

```
function redirectUrl(myid, response) {
  var options = {
    host: 'localhost',
    port: 8080,
    path: '/temp.html?id=' + myid + '&name=cdf',
    method: 'GET'
  };
  var req = http.request(options, function(res) {
    console.log('STATUS: ' + res.statusCode);
    console.log('HEADERS: ' + JSON.stringify(res.headers));
    res.setEncoding('utf8');

    // Proxy the headers
    response.writeHead(res.statusCode, res.headers);

    // Proxy the response
    res.on('data', function (chunk) {
      response.write(chunk);
    });
    res.on('end', function(){
        response.end();
      });
    });
  req.end();
} 
```

调用它：

```
redirectUrl(myid, response); 
```

另外，既然您已经在解析 url，为什么不这样做：

```
var parsedUrl = url.parse(request.url, true);
sys.debug("Get PathName" + parsedUrl.pathname + ":" + request.url);
//Call the redirect function
redirectUrl(parsedUrl.query.id, response); 
```

# oracle - Oracle AQ CLOB Jms 模板

> ID：10737373
> 
> 赞同：1
> 
> 时间：2012-05-24T12:20:04.557
> 
> 标签：oracle, clob

使用 java 和 jmstemplate，我正在尝试将消息排入带有包含 CLOB 字段的有效负载的 oracle 队列。

我的问题是你怎么做这样的事情？在谷歌上查看有各种建议表明我必须：

1.  将带有空负载的消息排入队列
2.  使用在步骤 1 中创建的消息 ID 从队列表中检索 usr_data
3.  将 clob 写入队列表。

不幸的是，没有太多可用的示例，我想知道是否有人以前做过这个和/或有一些示例代码？

问候，

约安。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T13:25:25.023

来自[Oracle 9i Application Developers Guide](http://docs.oracle.com/cd/B10501_01/appdev.920/a96587.pdf) - Advanced Queuing 请参阅附录 A - Oracle Advanced Queuing by Example

最后一个示例称为“使用 Java 使包含 LOB 属性的对象类型消息入队和出队”，它可能会帮助您。

该示例本身有几页大小，因此无法在此处发布。

您还可以根据您使用的 Oracle 查看以后的文档，看看它们是否有更新的示例，但我找不到 11g 的类似文档。

# xml - 如何使用 XSLT-1.0 转换 xml 结构

> ID：10737378
> 
> 赞同：3
> 
> 时间：2012-05-24T12:20:15.050
> 
> 标签：xml, xslt, transform, xslt-1.0

我需要改变这个结构

```
<A>
<B>value1</B>
</A>
<A>
<B>value2</B>
</A> 
```

进入

```
<A>
<B>value1<B>
<B>value2<B>
</A> 
```

使用 XSLT-1.0 的最佳解决方案是什么？谢谢！

PS：我试过这段代码：

```
<?xml version="1.0" encoding="UTF-8"?> 
<xsl:stylesheet version="1.1" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:fo="http://www.w3.org/1999/XSL/Format"> 
<xsl:output method="xml" version="1.0" encoding="utf-8" indent="yes"/>   
<xsl:key name="group_a" match="//A" use="B"/> 
<xsl:template match="/Test"> <a-node> <xsl:for-each select="//A"> <b-node> 
<xsl:value-of select="//A/B"/> </b-node> </xsl:for-each> </a-node> 
</xsl:template> 
</xsl:stylesheet> 
```

但它只返回第一个值：

```
<?xml version="1.0" encoding="utf-8"?> <a-node mlns:fo="http://www.w3.org/1999/XSL/Format"> <b-node>value1</b-node> <b-node>value1</b-node> </a-node> 
```

但是我需要：

```
<?xml version="1.0" encoding="utf-8"?> <a-node xmlns:fo="http://www.w3.org/1999/XSL/Format"> <b-node>value1</b-node> <b-node>value2</b-node> </a-node> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:10:53.653

这个样式表...

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                version="1.0">
    <xsl:output omit-xml-declaration="yes" method="xml" version="1.0" />
    <xsl:template match="/">
       <A>
        <xsl:apply-templates select="*/A/B"/>
       </A>
    </xsl:template>

    <xsl:template match="B">
      <B><xsl:value-of select="."/></B>
    </xsl:template>
</xsl:stylesheet> 
```

……会变身……

```
<root>
<A>
<B>value1</B>
</A>
<A>
<B>value2</B>
</A>
</root> 
```

...进入这个...

```
 <A><B>value1</B><B>value2</B></A> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:33:47.497

既然看起来你需要折叠单个节点下的所有孩子，那么你不需要“A”上的foreach，你可以直接移动到“B”孩子

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                version="1.0">
    <xsl:output omit-xml-declaration="yes" method="xml" version="1.0" />
    <xsl:template match="/">
        <A>
            <xsl:for-each select="//A/B">
                <B>
                    <xsl:value-of select="./text()"/>
                </B>
            </xsl:for-each>
        </A>
    </xsl:template>
</xsl:stylesheet> 
```

**编辑**根据@Sean 的评论，请注意 // 永远不应该在现实生活中使用。将 // 替换为您真正的根元素的路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T02:30:24.023

**此转换使用最基本的 XSLT 设计模式之一——覆盖身份转换。因此，更容易编写、理解、维护和扩展**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="A[1]">
  <A>
    <xsl:apply-templates select="node()|following-sibling::A/node()"/>
  </A>
 </xsl:template>
 <xsl:template match="A"/>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时**（通过将提供的 XML 片段包装到单个顶部元素中获得——以使其成为格式良好的 XML 文档）：

```
<t>
    <A>
        <B>value1</B>
    </A>
    <A>
        <B>value2</B>
    </A>
</t> 
```

**产生了想要的正确结果：**

```
<t>
   <A>
      <B>value1</B>
      <B>value2</B>
   </A>
</t> 
```

# blackberry - 从黑莓中的网址显示的图像上的缩放捏合功能？

> ID：10737380
> 
> 赞同：1
> 
> 时间：2012-05-24T12:20:19.557
> 
> 标签：blackberry, pinchzoom

我正在准备一个 Blackberry 应用程序，在该应用程序中我准备了一个 HTTP 连接，并从一个 URL 我在屏幕上显示一个图像。
现在在触摸监听器上，我正在其他屏幕上显示此图像，并希望使用 URL 中的该图像执行缩放捏合功能。

该图像不在我的设备内存中，它直接从 HTTP 连接显示。我想在 5.0+ 设备上运行这个应用程序。请建议我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:43:28.937

***尝试以下步骤：***

1.  从 URL 获取图像。

2.  将图像转换为[EncodedImage](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/system/EncodedImage.html)。

3.  创建一个[ZoomScreen](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/extension/container/ZoomScreen.html)实例并显示它。

***创建和显示 ZoomScreen***

```
private void showImage(EncodedImage image) {
    synchronized (UiApplication.getEventLock()) {
        UiApplication.getUiApplication().pushScreen(new ZoomScreen(image));
    }
} 
```

# ruby - 将 ImageMagick 命令移植到 RMagick

> ID：10737382
> 
> 赞同：2
> 
> 时间：2012-05-24T12:20:42.783
> 
> 标签：ruby, imagemagick, rmagick

我正在使用 ImageMagick 命令进行图像处理，我想将它们移植到 RMagick。此任务的目标是为了隐私目的拍照并对给定区域（一个或多个）进行像素化。

这是我的 bash 脚本 ( )，使用以下命令`script.sh`效果很好：`convert`

```
convert invoice.png -scale 10% -scale 1000% pixelated.png
convert invoice.png -gamma 0 -fill white -draw "rectangle 35, 110, 215, 250" mask.png
convert invoice.png pixelated.png mask.png -composite result.png 
```

现在我想使用 ImageMagick 创建这个脚本的 Ruby 版本。这是我现在拥有的：

```
require 'rmagick'

# pixelate_areas('invoice.png', [ [ x1, y1, width, height ] ])
def pixelate_areas(image_path, areas)
  image     = Magick::Image::read(image_path).first
  pixelated = image.scale(0.1).scale(10)
  mask      = Magick::Image.new(image.columns, image.rows) { self.background_color = '#000' }

  areas.each do |coordinates|
    area = Magick::Image.new(coordinates[2], coordinates[3]) { self.background_color = '#fff' }
    mask.composite!(area, coordinates[0], coordinates[1], Magick::OverCompositeOp)
  end

  # Now, how can I merge my 3 images?
  # I need to extract the part of pixelated that overlap with the white part of the mask (everything else must be transparent).
  # Then I have to superpose the resulting image to the original (it's the easy part).
end 
```

如您所见，我被困在最后一步。为了得到[这个结果](http://i.imgur.com/e0qzA.png)，我需要对[我的原始图片](http://i.imgur.com/IWtBF.png)、[像素化图片](http://i.imgur.com/ZJIgt.png)和[蒙版](http://i.imgur.com/Mup1j.png)进行什么操作？

如何仅通过蒙版的白色部分和像素化图片的重叠来构建图像。就像[这个](http://i.imgur.com/KVC8a.png)一样，但透明而不是黑色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T09:37:26.327

首先，当你有一些已经可以工作的东西时，为什么还要将命令移植到 RMagick？bash 版本简短易懂。如果这只是您要移植的较大脚本的一部分，请不要害怕`system()`.

也就是说，这是一种不同的策略，我相信它可以以更直接的方式完成你想要做的事情。

```
require 'RMagick'

def pixelate_area(image_path, x1, y1, x2, y2)
  image          = Magick::Image::read(image_path).first
  sensitive_area = image.crop(x1, y1, x2 - x1, y2 - y1).scale(0.1).scale(10)

  image.composite!(sensitive_area, x1, y1, Magick::AtopCompositeOp)
  image.write('result.png') { self.depth = image.depth }
end 
```

这似乎与您原来的 bash 命令一样：

```
pixelate_area('invoice.png', 35, 110, 215, 250) 
```

由于看起来您想要处理多个区域以模糊，这是一个采用一系列区域（每个为`[x1, y1, x2, y2]`）的版本：

```
def pixelate_areas(image_path, areas)
  image = Magick::Image::read(image_path).first

  areas.each do |area|
    x1, y1, x2, y2 = area

    sensitive_area = image.crop(x1, y1, x2 - x1, y2 - y1).scale(0.1).scale(10)
    image.composite!(sensitive_area, x1, y1, Magick::AtopCompositeOp)
  end

  image.write('result.png') { self.depth = image.depth }
end 
```

# java - 全文搜索删除索引重试？

> ID：10737386
> 
> 赞同：0
> 
> 时间：2012-05-24T12:20:56.110
> 
> 标签：java, google-app-engine

执行 index().remove(..) 时没有状态码返回？但是有返回 index().add(..) 的状态码。如果 remove(..) 失败，是否不需要重试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T05:47:04.827

`Index.remove()`如果有问题应该抛出异常。具体来说（来自`remove`方法文档）：

```
"Raises:
  RemoveError: If one or more documents failed to remove or
    number removed did not match requested.
  ValueError: If document_ids is not a string or iterable of valid document
    identifiers or number of document ids is larger than
    _MAXIMUM_DOCS_PER_REQUEST." 
```

# c# - WPF：如何在线程中写入主进程拥有的流？

> ID：10737388
> 
> 赞同：0
> 
> 时间：2012-05-24T12:21:14.837
> 
> 标签：c#, wpf, multithreading, stream

我想实现这个功能：当接收到一个http请求时，然后创建一个新的窗体，并等待用户输入响应文本并写入http响应流。问题是，即使我使用 Action<> 委托，我也无法将响应文本写入线程中的流。像这样的一些代码：

```
public partial class MainWindow : Window
{
    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        //startup web server 
        Dispatcher.BeginInvoke(new Action(Start));
    }

    private void Start()
    {
        var server = new HttpServer();
        try
        {
            server.EndPoint = new IPEndPoint(IPAddress.Parse("127.0.0.1"), 80);
            server.Start();
            server.RequestReceived += DataProcess;
        }
        catch (Exception ex)
        {
            return;
        }
    }

    private void DataProcess(object sender, HttpRequestEventArgs e)
    {
        //create a new window in which user can input the response for the http request e.
        var pw = (PrivateWindow)Dispatcher.Invoke(new Func<HttpRequestEventArgs, PrivateWindow>(CreatePrivateWindow), e);
    }

    public PrivateWindow CreatePrivateWindow(string windowKey, HttpRequestEventArgs e)      
    {
        var pw = new PrivateWindow(); 
        pw.httpRequest = e;//pass the stream to thread here.       
        windows.Add(pw);
        return pw;    
    }
}

public partial class PrivateWindow : Window
{
    private void btnSendMessage_Click(object sender, RoutedEventArgs e)
    {
        string messageText = new TextRange(txtWriteMessage.Document.ContentStart, txtWriteMessage.Document.ContentEnd).Text.Trim(); 
        //write the response in thread           
        Dispatcher.BeginInvoke(new Action<HttpRequestEventArgs, string>(WriteToStream), httpRequest, messageText);
    }
    private void WriteToStream(HttpRequestEventArgs e, string str)
    {
        //**here occurs "stream can not be written" error.** 
        using (var writer = new StreamWriter(e.Response.OutputStream))
        {
            writer.Write(str);
        }
    }
} 
```

# ruby-on-rails - 是否可以在 activeadmin 的侧边栏中访问完整的索引范围？

> ID：10737391
> 
> 赞同：2
> 
> 时间：2012-05-24T12:21:24.717
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activeadmin

我`Bill`在我的应用程序中为模型创建了 ActiveAdmin 管理界面，并希望在索引和过滤搜索的侧边栏中显示统计信息（如当前过滤账单的总量）。在侧边栏部分，我可以访问这样的`bills`关系：

```
sidebar do
  bills.sum(:amount)
end 
```

`bills`使用当前过滤器正确限定范围：日期、数字等。

但是“账单”关系仅包含 30 条记录（显示在页面上，30 是默认分页大小），但总共超过 300 条。如何获得当前过滤账单的“未分页”关系（使用当前选择的过滤器）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:34:27.653

自己获取，我可以使用`bills.limit(nil)`，它会覆盖当前的页面选择，并返回完整范围。

# ios - 我什么时候可以开始使用使用 UIAppearance 设置的属性？

> ID：10737394
> 
> 赞同：10
> 
> 时间：2012-05-24T12:21:36.873
> 
> 标签：ios, cocoa-touch, uiappearance

我的视图类（的后代`UIView`）中有一些自定义外观属性。我想根据这些属性自定义视图外观，但我不能在初始化程序中这样做，因为使用设置的值`[[MyClass appearance] setFoo:…]`此时无效：

```
@interface View : UIView
@property(strong) UIColor *someColor UI_APPEARANCE_SELECTOR;
@end

@implementation View
@synthesize someColor;

// Somewhere in other code before the initializer is called:
// [[View appearance] setSomeColor:[UIColor blackColor]];

- (id) initWithFrame: (CGRect) frame
{
    self = [super initWithFrame:frame];
    NSLog(@"%@", someColor); // nil
    return self;
}

@end 
```

它们已经设置在 中`layoutSubviews`，但这不是执行视图自定义的好点，因为某些自定义可能会`layoutSubviews`再次触发，从而导致无限循环。

那么，执行自定义有什么好处呢？或者有没有办法触发应用外观值的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:33:48.463

一种可能的解决方法是直接从代理中获取值：

```
- (id) initWithFrame: (CGRect) frame
{
    self = [super initWithFrame:frame];
    NSLog(@"%@", [[View appearance] someColor); // not nil
    return self;
} 
```

当然，这会扼杀根据视图容器改变外观的选项，并且通常很难看。我发现的第二个选项是在 setter 中执行自定义：

```
- (void) setSomeColor: (UIColor*) newColor
{
    someColor = newColor;
    // do whatever is needed
} 
```

我仍然希望在设置外观属性后调用一些钩子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:46:21.940

为什么不等到

```
- (void)willMoveToSuperview:(UIView *)newSuperview {
    [super willMoveToSuperview:newSuperview];

    if (newSuperview) {
        ... code here ...
    }
} 
```

如果它给你带来麻烦？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-07T19:27:22.103

我相信`UIAppearance`在将视图添加到视图层次结构中时，属性会应用于视图。所以大概你可以在`UIView didMoveToSuperview`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-17T16:33:10.960

警告：我使用的是 Swift 2，所以不确定 Swift / Objective-C 的早期版本。但我发现这`didMoveToSuperview()`行不通。这些属性在 中可用`layoutSubviews()`，但这不是执行此类操作的好地方（因为它可以被多次调用）。在我发现的视图的生命周期中访问这些属性的最佳位置是`didMoveToWindow()`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T13:23:55.710

如果它是一次性的，我会认为 viewDidLoad 会是最好的。否则，viewWillAppear。

编辑：

如果您想在视图中而不是控制器中执行此操作，那么我将为视图创建一个自定义初始化，如下所示：

```
-(id) initWithFrame:(CGRect) frame andAppearanceColor:(UIColor)theColor; 
```

从而在创建时将颜色传递到视图中。

# c# - wpf - 根据条件从 MS 访问数据库中选择数据

> ID：10737396
> 
> 赞同：3
> 
> 时间：2012-05-24T12:21:44.393
> 
> 标签：c#, sql, wpf, ms-access, select

我正在从我的 wpf 应用程序中的访问数据库访问表。但问题是我的包含 ID 的列的开头有空格。例如。我的表包含 Estimation ID 列，其中包含不同的 ID，如 141A、14B、13521B。但是在这些 ID 的开头有一些空格。（141A、14A、14152B）所以当我从我的 wpf 应用程序的查询中传递参数时，它返回空表。我的代码是

```
string query1 = "select * from Estimates where EstimateNo = '141A'";
DataTable dt = new DataTable();
OleDbDataAdapter da = new OleDbDataAdapter();
da.SelectCommand = new OleDbCommand(query1, myDataConnection);
da.Fill(dt); 
```

有什么方法可以让我在 where 子句中指定条件。ie 可以在开始时包含任意数量的空格，但应该以哪个 ie 代码结束？

现在要做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:29:07.283

您正在寻找的功能是`LTRIM`

```
string query1 = "select * from Estimates where LTRIM(EstimateNo) = '141A'";
DataTable dt = new DataTable();
OleDbDataAdapter da = new OleDbDataAdapter();
da.SelectCommand = new OleDbCommand(query1, myDataConnection);
da.Fill(dt); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:34:47.033

如果前端和后端都有空格，则在 sql 查询中使用 LTRIM 函数，然后使用

```
LTRIM(RTRIM(ColumnName)) 
```

# c# - 在 WinForms 应用程序中准确测量、呈现、命中测试和打印文本

> ID：10737399
> 
> 赞同：3
> 
> 时间：2012-05-24T12:21:56.183
> 
> 标签：c#, winforms, gdi+, gdi, textrenderer

我们要：

1.  准确测量文本。
2.  在存在应用于图形上下文的平移和缩放变换的情况下，将文本逐行渲染到屏幕图形上下文。
3.  命中测试：允许使用鼠标或通过显示的插入符号精确选择文本。
4.  如果需要，使用打印机尽可能准确地打印结果。*注意：*这是次要的。屏幕渲染和点击测试是主要的。
5.  在 Windows XP 和更高版本的操作系统上运行。

在同样将图形和图像渲染到相同图形上下文的 WinForms 应用程序中。

我们遇到了四种技术。我们已经尝试使用前两个，并在几个月的过程中遇到了所描述的问题。

## GDI+

据称与分辨率无关的文本。然而，根据[这个问题](https://stackoverflow.com/questions/7268238/drawing-text-in-net/7269191)- 以及其他来源 - 由于质量问题，应避免使用该技术。

[MSDN](http://msdn.microsoft.com/en-us/library/6xe5hazb(VS.80).aspx)声明调用 Graphics.MeasureString `StringFormat.GenericTypographic`并`TextRenderingHint.AntiAlias`产生准确的字符串测量。然而，根据我们和其他人的经验，情况并非如此——我们没有得到准确的字符串测量值。

*   优点：快
*   缺点：字符串测量不准确。

结果：由于字符串测量不准确而无法使用。

## GDI 通过 TextRenderer

这是为了克服 GDI+ 的限制而引入的。然而，这引入了它自己的限制：

*   非常慢
*   不适[用于](http://social.msdn.microsoft.com/Forums/zh/winforms/thread/9a2d277d-340b-4d39-9cd0-f59fa9719aa1)图形变换

结果：由于这些原因无法使用

## GDI 通过 p/invoke

调用`GetTextExtentExPoint`文本测量和//`DrawText`进行渲染。`DrawTextEx``ExtTextOut`

我们还没有尝试过。

## 直写

这看起来很有希望，因为它与包括 GDI/GDI+ 在内的其他技术互操作，所以我们的图形渲染的其余部分可能不会改变。但是，它仅适用于 Windows Vista 和更新的 Windows 版本。这是目前的一个问题，因为 Windows XP 仍然有大量的安装基础。

# 问题

考虑到要求，哪些技术可以工作？

*注意：* 关于这个话题有很多错误信息，所以只有在你有这方面的专业知识的情况下才能回答这个问题。另外，请不要建议 WPF - 这不是我们正在考虑使用的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T00:31:52.780

假设该[`MeasureCharacterRanges`](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.measurecharacterranges.aspx)函数比 更准确`MeasureString`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T04:02:31.497

我有类似的要求，并且在文本渲染和缩放方面遇到了同样的问题。出于多种原因，甚至我对 WPF (.NET 3.5) 的尝试都是一场噩梦。

`graphics.DrawString`尽管被“弃用”，但我最终还是使用了 GDI+ ，并使用了一个有趣的技巧来获得准确的文本测量值。

```
static public RectangleF MeasureInkBox(Graphics graphics, string text, Font font)
{
    var bounds = new RectangleF();
    using (var textPath = new GraphicsPath())
    {
        textPath.AddString(
            text,
            font.FontFamily,
            (int)font.Style,
            font.Size,
            new PointF(0, 0),
            StringFormat.GenericTypographic );
        bounds = textPath.GetBounds();
    }
    return bounds;
} 
```

结果证明速度和质量令人满意。此外，`graphics.DrawString`推荐使用 winforms 打印文本的方法。

由于字距调整，测量单个字符的位置可能会很棘手，但我想这种方法稍微复杂一点的版本就可以完成这项工作。例如，对于“Hello”，它会测量“H”，然后是“He”，然后是 Hel”等等。它不应该显着降低性能，尤其是当你在接收到一个单词的点击时在飞行时执行它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-25T00:16:14.643

如果您必须同时针对屏幕和打印机，那么在决定使用哪个渲染引擎之前，您需要对您的方法做出一些决定。以下是一些可能性：

1.  以丝网单位布局并尽可能接近打印机。
2.  以打印机单元布局并尽可能接近屏幕。
3.  在理论上的高分辨率空间中进行布局，并为打印机和屏幕进行最佳近似。

在所有情况下，可能的最佳近似值都可以通过在每一步非常仔细的近似值来完成，这可以为每个设备提供最高的保真度，但会以匹配的准确性为代价，或者您可以渲染位图并缩放到设备，这给出了较低的保真度，但对另一个空间是最好的近似。

我已经用 GDI 完成了硬核打印预览。这很难，但对于常规布局来说是可行的。但是，如果您要处理任意变换，尤其是 +/-90 度以外的旋转，那几乎是不可能的。

很容易犯一些细微的错误，并相信你得到的测量结果是错误的。

*   当笔划宽度与 dpi 处于同一数量级时，字体提示使字体缩放成为非线性，因此，如果您获得`w`某些文本的宽度，那么将字体大小加倍时的宽度可能不完全是`2*w`.

*   字体替换在许多打印机驱动程序中很常见。即使您选择 TrueType 或 OpenType 字体，您在打印机上获得的字体可能*与*在屏幕上获得的字体不同。

*   非方形像素在某些打印机中很常见。当你在做一些不是轴对齐的事情时，这些甚至会弄乱像样的光栅化器。

*   字距调整可能令人惊讶。不要假设 width('a') + width('b') == width("ab")。

*   舍入错误很容易产生。有时您必须知道底层光栅化器使用的舍入规则。

*   在错误的环境中进行测量太常见了。不要尝试在屏幕上下文中测量并应用转换来获取打印机单位。如果您需要打印机单位，请在打印机上下文中进行测量。

我今天的观点是，如果您只需要打印预览，那么您应该以打印机为单位布局到与页面大小一致的位图，并根据 DPI 的比率将位图缩放到屏幕。这是最容易做的事情，而且效果很好。但目前尚不清楚一个好的硬拷贝和打印预览是否真的是你所追求的。

# android - nodejs可以服务于android和ios吗

> ID：10737400
> 
> 赞同：0
> 
> 时间：2012-05-24T12:21:56.850
> 
> 标签：android, ios, node.js

我想为android构建一个两人游戏。我想知道是否可以将 nodejs 用作 Web 服务器。nodejs 可以用来服务安卓客户端吗？如何使用 nodejs 将数据推送到 android 客户端？可以用来服务iOS客户端吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:28:35.927

我建议您使用[Socket.IO](http://socket.io/)。

然后将[Socket.IO-Client](https://github.com/Gottox/socket.io-java-client) for Java 用于 android。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:28:21.747

1.  是的，请查看[node.js](http://nodejs.org/ "节点.js")页面以获取快速示例。
2.  是的
3.  可能查看[socket.io](http://socket.io/#how-to-use "套接字.io")来处理您的通信。

# powershell - 通过 Powershell 为其他用户设置环境变量

> ID：10737401
> 
> 赞同：3
> 
> 时间：2012-05-24T12:21:58.730
> 
> 标签：powershell, environment-variables

我正在尝试从管理员用户 ABC 的 powershell 设置用户 XYZ 的环境变量。我正在使用 Start-Process 启动用户 XYZ 的 powershell，但我无法捕获输出。所有这些过程都需要在 Java 中完成。

有人可以帮我吗。

感谢阿贾克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:39:31.787

当您更改环境变量时，更改只会影响当前的 PowerShell 会话（就像您在 Windows cmd 中使用 SET 命令一样）。要使更改永久生效，您必须使用[SETX 之](http://ss64.com/nt/setx.html)类的实用程序进行更改。您还必须有权更改这些值。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2017-05-06T00:33:57.757

检查此 TechNet 文章：[https ://technet.microsoft.com/en-us/library/ff730964.aspx](https://technet.microsoft.com/en-us/library/ff730964.aspx)

基本上，您将希望在机器范围内使用 .NET 方法对其进行设置：

`[Environment]::SetEnvironmentVariable("TestVariable","Test Value","Machine")`

您需要重新启动 Powershell 会话才能在创建新环境变量后访问它。

# php - $.get 不返回 html

> ID：10737402
> 
> 赞同：2
> 
> 时间：2012-05-24T12:22:06.527
> 
> 标签：php, javascript, jquery, ajax, facebook

我的简单代码

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Untitled Document</title>
<script src="jquery.js"></script>
<script type="text/javascript">
$(function(){
$.get("http://www.facebook.com",function(data){
alert(data);});

});</script></head>

 <body>
</body>
</html> 
```

它应该提醒 facebook 内容，但它没有这样做

更新

现在我正在使用 php

```
<?php
 $str=file_get_contents("http://www.facebook.com");
    echo strip_tags(htmlspecialchars($str)); 
?> 
```

为什么它不删除标签？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T12:25:35.007

如果您在服务器端使用 php。您可以使用以下方法创建一个返回 html 的服务：

```
$html = file_get_contents('http://www.facebook.com'); 
```

ASP.NET：

```
using(WebClient client = new WebClient()) 
{
    string html = client.DownloadString("http://www.facebook.com'");
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T12:23:48.627

我猜你刚刚因为[Same Origin Policy](http://en.wikipedia.org/wiki/Same_origin_policy)被浏览器阻止了。查看控制台，如果您尝试执行此操作，您将收到警告。

如果没有[跨域资源共享](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)或服务器端代理，您将无法读取跨域页面。

据我所知，这样做的唯一方法是让*您的域上*的服务器脚本读取外部页面（wget，curl，fopen，还有什么）并将其返回到您的页面。您的服务器充当读取远程页面的“桥梁”。

您可能听说过没有跨域限制的[JSONP ，但您通过这种方式检索的不是 HTML/页面，而是脚本。](http://en.wikipedia.org/wiki/JSONP)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-24T12:24:01.903

[由于同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，除非使用 JSONP，否则您不能从外部网站请求内容。但是，因为您请求的是 HTML，所以这不适用。

另一种方法是创建一个服务器端代理来获取 facebook.com 主页的 HTML，然后将该本地 URL 提供给该`$.get()`函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T12:32:11.430

您只能在同一个域中发出 ajax 请求

但是您可以使用 JSONP 进行跨域请求
[http://en.wikipedia.org/wiki/JSONP](http://en.wikipedia.org/wiki/JSONP)

参考这篇关于 ibm developerworks 的文章：http:
[//www.ibm.com/developerworks/library/wa-aj-jsonp1/](http://www.ibm.com/developerworks/library/wa-aj-jsonp1/)

# javascript - 带有原型的 X 域 XML 提要

> ID：10737405
> 
> 赞同：0
> 
> 时间：2012-05-24T12:22:18.300
> 
> 标签：javascript, prototypejs, cross-domain

好的，所以原型不是我的选择，但客户站点使用它，我必须适应。

我有一个来自站点 A 的 XML 提要，我的功能是：

```
new Ajax.Request('somefeedurl.ashx',
{
    method:'get',
    onSuccess: function(transport){
        console.log("Transport: "+transport)
        myParseXml(transport.responseXML);
    },
    onFailure: function(){
        alert('Something went wrong...')
    }
}); 
```

我已经实现了一个 crossdomain.xml 文件以允许访问 somefeedurl.com，但我仍然得到相同的 Origin：Access-Control-Allow-Origin 不允许。

使用 Prototype 有什么办法吗？

作为第二个问题。一旦我解决了这个问题，我是否正确运行函数 myParseXML() 来实际进行处理？即，transport.responseXML 是否会提供来自提要的 XML 数据？

问候，罗伯特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:26:08.317

否。如果提供 XML 提要的其他站点未[明确允许跨域请求，则由于](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)[sop](http://en.wikipedia.org/wiki/Same_origin_policy)的原因，您无法（直接）使用 Ajax 检索它- 任何“解决方法”都将是一个安全漏洞。

无论您使用哪个库来包装 ajax 调用。

另请参阅[XMLHTTPRequest](https://developer.mozilla.org/en/XMLHttpRequest)的文档，使用该文档[将调用 onsuccess 处理程序](http://prototypejs.org/api/ajax/options)。所以回答你的第二个问题：不，`responseXML`已经被解析为一个文档。

# java - JSF 特立尼达图表不显示

> ID：10737409
> 
> 赞同：2
> 
> 时间：2012-05-24T12:22:22.343
> 
> 标签：java, jsf, trinidad

环境：JSF2.0 + MyFace + Trinidad + GlassFish IDE：eclipse

我对 JSF 很陌生，目前我想在我的页面上显示特立尼达图表，但没有做到。我可以显示其他 Trinidad 组件 panelFormLayout ，但在浏览器上显示以下错误。

> 未捕获的 ReferenceError：未定义 ApacheChart

并且无法加载4资源（404）

> > ://.../adf/jsLibs/resources/LocaleElements_zh_TW2_0_0_beta_2.js；://.../adf/jsLibs/resources/DebugLocale2_0_0_beta_2.js; ://.../adf/jsLibs/resources/DebugCoreFmt2_0_0_beta_2.js；://.../adf/jsLibs/resources/DebugApacheChart2_0_0_beta_2.js;

我发现我的问题很像这个

[http://mail-archives.apache.org/mod_mbox/myfaces-users/200707.mbox/%3Cfa024af00707161819h4f93034fj1ec2574f4f38918c@mail.gmail.com%3E](http://mail-archives.apache.org/mod_mbox/myfaces-users/200707.mbox/%3Cfa024af00707161819h4f93034fj1ec2574f4f38918c@mail.gmail.com%3E)

但我仍然不知道如何使它工作。任何建议将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T09:06:13.063

您的`web.xml`.

```
<servlet>
  <servlet-name>resources</servlet-name>
  <servlet-class>org.apache.myfaces.trinidad.webapp.ResourceServlet</servlet-class>
</servlet>

<servlet-mapping>
  <servlet-name>resources</servlet-name>
  <url-pattern>/adf/*</url-pattern>
</servlet-mapping> 
```

# c++ - 杀死一个正在运行的线程

> ID：10737417
> 
> 赞同：7
> 
> 时间：2012-05-24T12:23:11.927
> 
> 标签：c++, windows, multithreading

如果我们强行杀死一个正在运行的线程会发生什么

我有一个线程`RecordThread()`，它调用一些复杂且耗时的函数。在这些函数中，我使用*try-catch*块、分配和释放内存以及使用临界区变量等。

像

```
 void RecordThread()
  {
    AddRecord();
    FindRecord();
    DeleteRecord();
    // ...
    ExitThread(0);
   } 
```

创建此线程后，我会在线程完成执行之前立即将其杀死。在这种情况下，如果线程被强行杀死会发生什么？在我们杀死线程后，内部函数（`AddRecord`，`DeleteRecord`）是否完成了它们的执行？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-24T12:42:51.567

> 创建此线程后，我会在线程完成执行之前立即将其杀死。

我假设您的意思是您正在`TerminateThread()`以下列方式使用：

```
HANDLE thread = CreateThread(...);

// ...
// short pause or other action?
// ...

TerminateThread(thread, 0); // Dangerous source of errors!
CloseHandle(thread); 
```

如果是这种情况，则不，执行的线程`RecordThread()`将在另一个线程调用时准确地停止`TerminateThread()`。根据[`TerminateThread()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686717(v=vs.85).aspx)文档中的注释，这个确切的点有点随机，取决于您无法控制的复杂时序问题。这意味着您无法在线程内处理适当的清理，因此，[您应该很少（如果有的话）杀死线程](https://stackoverflow.com/a/4149210/313063)。

请求线程完成的正确方法是`WaitForSingleObject()`这样使用：

```
HANDLE thread = CreateThread(...);

// ...
// some other action?
// ...

// you can pass a short timeout instead and kill the thread if it hasn't
// completed when the timeout expires.
WaitForSingleObject(thread, INFINITE);
CloseHandle(thread); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T12:27:28.127

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms682659%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682659%28v=vs.85%29.aspx)

> ExitThread 是在 C 代码中退出线程的首选方法。但是，在 C++ 代码中，线程**在调用任何析构函数**或执行任何其他自动清理之前退出。因此，在 C++ 代码中，您应该从您的线程函数返回。

然而，函数调用当然会完成，因为它们是在 ExitThread() 之前调用的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-18T08:54:07.850

杀死线程是最后的手段——正如安德烈所说，它使数据处于未知状态，如果线程在共享对象上工作，你永远不应该这样做。更好的选择是通过以下方式通知线程完成工作：

- 使用仅由主线程更改并由工作人员测试的全局*易失*
（重要）变量 - 使用*信号*类型同步对象（主要是事件）也由主线程设置并由工作人员测试

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-12T17:32:38.283

运行良好的线程示例：

```
definition in *.h ------------------------------------

DWORD WINAPI Th_EspectroIF(LPVOID lpData);

CThread th_espectro(Th_EspectroIF);

use in *.cc -----------------------------------

DWORD WINAPI Th_EspectroIF(LPVOID lpData)
{

//Your code...

th_espectro.Stop(true);//stop this Thread 

} 
```

调用线程：**th_espectro.Start();**

# iphone - 自定义 UITabBar 和 ViewController 之间的空间

> ID：10737420
> 
> 赞同：6
> 
> 时间：2012-05-24T12:23:17.870
> 
> 标签：iphone, objective-c, ios, uitabbarcontroller, uitabbar

我拿了一张普通`UITabBar`的并将它的背景图像更改为具有较低高度的自定义背景图像，因此我更改`height`了`frame`. 起初我得到的是标签栏下方的空白区域。所以我也改变`origin`了`frame`。但是现在空白区域已经向上移动到标签栏上方，结果如下：

![标签栏上方的空间](../Images/013a7a991ccc205b5923a0f98e342d4f.png)

这是在 AppDelegate 中声明标签栏的代码：

```
self.tabContoller = [[UITabBarController alloc] init];
//customizing the tabbar
UIImage * tabBackgroundImage = [UIImage imageNamed:@"tabBarBg.png"];
self.tabContoller.tabBar.backgroundColor = [UIColor colorWithRed:245.f/255.f green:245.f/255.f blue:245.f/255.f alpha:255.f/255.f];
self.tabContoller.tabBar.backgroundImage = tabBackgroundImage;
//setting the tabbar height to the correct height of the image
CGRect tabR = self.tabContoller.tabBar.frame;
CGFloat diff = tabR.size.height - tabBackgroundImage.size.height;
tabR.size.height = tabBackgroundImage.size.height;
tabR.origin.y += diff;
self.tabContoller.tabBar.frame = tabR; 
```

我想问题在于`ViewController`s 将自己绘制在一个恒定空间之上，该空间是常规标签栏的高度。有没有办法改变它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-27T09:56:39.047

将您的 UITabBarController 的子视图更改为全尺寸框架，这对我有用：

```
[[yourTabBarController.view.subviews objectAtIndex:0] setFrame:CGRectMake(0, 0, 320, 480)]; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-30T14:59:09.460

尝试创建您自己的从 UITabBar 扩展的类并使用此函数：

```
- (CGSize)sizeThatFits:(CGSize)size {
    CGSize auxSize = size;
    auxSize.height = 54; // Put here the new height you want and that's it
    return auxSize;
} 
```

这会将 UITabBar 调整为您想要的大小。简单易行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T13:23:07.140

如果像@JoaT 提到的那样更改框架不起作用，请确保视图控制器的视图具有正确的自动调整大小掩码集。

此[SO](https://stackoverflow.com/questions/2037716/laying-out-sizing-of-subviews-in-a-uiviewcontroller)链接可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T13:36:20.607

我尝试通过更改标签栏的高度和原点，对我来说它工作正常。您可以尝试增加视图控制器的高度。

# ruby-on-rails - Ruby on Rails - 如何在控制器上查询模型/条件？

> ID：10737421
> 
> 赞同：1
> 
> 时间：2012-05-24T12:23:18.527
> 
> 标签：ruby-on-rails, ruby-on-rails-3, arel, named-scope

我正在使用 rails 3.2.3 并且对查询有疑问。

我读过使用 arel 而不是命名范围是有利的。

基本上在我的应用程序中，当用户登录时，我希望他看到他创建的产品。所以不要在我的*控制器索引*中：

```
products=Product.find(:all) 
```

我一直在寻找类似的东西

```
products=Product.find(:all, :conditions....) 
```

问题是，我的 User 和 Product 模型有一个 HABTM 关系（它确实必须是），我不知道如何加入这些表，以便只`current_user`显示插入的产品（插入工作正常）

我必须在我的产品模型中添加搜索方法吗？或者这可以通过传入`:conditions`索引控制器来完成？

基本上逻辑是：

->获取所有产品

-> 与 products_users HABTM 表内联，并获取 products_users.user_id = current_user.id 的所有产品。返回结果。

我不知道我是否在这里遗漏了什么......关于如何编码的任何提示？我有点困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:26:53.330

如果您有关联的用户和产品模型 - 此代码`@products = current_user.products`将返回`current_user`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:27:35.130

要找到当前用户的所有产品，这将起到作用

```
 current_user.products 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T12:29:47.220

```
if user_sighed_in?
  @products = current_user.products
else
  @products = Product.scoped
end 
```

ofc 你必须在用户模型中定义关联

```
has_many :products 
```

# asp.net - Fullcalendar 手动添加开始日期和结束日期

> ID：10737425
> 
> 赞同：0
> 
> 时间：2012-05-24T12:23:46.177
> 
> 标签：asp.net, fullcalendar

这个用于 asp 的 fullcalendar 代码工作正常。 [http://code.google.com/p/fullcalendar-asp-net/](http://code.google.com/p/fullcalendar-asp-net/)

如何手动输入或修改开始日期和结束日期？（也使用日期时间选择器）
我尝试更改：

```
$('#addDialog').dialog({

    autoOpen: false,
    width: 470,
    buttons: {
        "Add": function () {

            //alert("sent:" + addStartDate.format("dd-MM-yyyy hh:mm:ss tt") + "==" + addStartDate.toLocaleString());
            var eventToAdd = {
                title: $("#addEventName").val(),
                description: $("#addEventDesc").val(),
                start: addStartDate.format("dd-MM-yyyy hh:mm:ss tt"),
                end: addEndDate.format("dd-MM-yyyy hh:mm:ss tt")

            }; 
```

至

```
$('#addDialog').dialog({

    autoOpen: false,
    width: 470,
    buttons: {
        "Add": function () {

            //alert("sent:" + addStartDate.format("dd-MM-yyyy hh:mm:ss tt") + "==" + addStartDate.toLocaleString());
            var eventToAdd = {
                title: $("#addEventName").val(),
                description: $("#addEventDesc").val(),
                start: $("#addEventStartDate").val(),
                end: $("#addEventEndDate").val(),
            }; 
```

和

```
function selectDate(start, end, allDay) {

$('#addDialog').dialog('open');

//$("#addEventStartDate").text("" + start.toLocaleString());
//$("#addEventEndDate").text("" + end.toLocaleString());

$("#addEventStartDate").val(start.format("dd/MM/yyyy hh:mm:ss tt"));
$("#addEventEndDate").val(end.format("dd/MM/yyyy hh:mm:ss tt"));

//addStartDate = start;
//addEndDate = end;
//globalAllDay = allDay;

//alert(allDay); 
```

}

和

```
<div id="addDialog" style="font: 70% 'Trebuchet MS', sans-serif; margin: 50px;" title="Add Event">
<table cellpadding="0" class="style1">
        <tr>
            <td class="alignRight">
                name:</td>
            <td class="alignLeft">
                <input id="addEventName" type="text" size="50" /><br /></td>
        </tr>
        <tr>
            <td class="alignRight">
                description:</td>
            <td class="alignLeft">
                <textarea id="addEventDesc" cols="30" rows="3" ></textarea></td>
        </tr>
        <tr>
            <td class="alignRight">
                start:</td>
            <td class="alignLeft">
                <input id="addEventStartDate" onchange="start" type="text" size="50" /><br /></td>
        </tr>
        <tr>
            <td class="alignRight">
                end:</td>
            <td class="alignLeft">
                <input id="addEventEndDate" type="text" size="50" /><br /></td>
        </tr>
    </table>

</div> 
```

非常感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T13:12:36.460

您是否尝试将对话框绑定到 FullCalendar 的 dayClick 回调？此外，您可以在对话框中使用任何 datePicker（如[jQuery UI DatePicker](http://jqueryui.com/demos/datepicker/)）。

您可以使用 eventClick 回调来编辑日历上已创建的事件。

希望这可以帮助！

# java - 从Java将消息放入队列

> ID：10737428
> 
> 赞同：0
> 
> 时间：2012-05-24T12:23:54.080
> 
> 标签：java, mq

我正在尝试将消息从我的 Java 代码（在我的本地机器中）放入队列中。我收到错误消息：

> java.lang.UnsatisfiedLinkError：java.library.path 中没有 mqjbnd05。

这是我的代码：

```
qMgr = new MQQueueManager(qManager);
int openOptions = MQC.MQOO_INPUT_AS_Q_DEF | MQC.MQOO_OUTPUT ;

MQQueue queue = qMgr.accessQueue("Q1",openOptions); 
MQMessage msg = new MQMessage();
msg.writeUTF("this is a test message"); 

MQPutMessageOptions pmo = new MQPutMessageOptions();
queue.put(msg, pmo); 

MQMessage retrievedMessage = new MQMessage();
retrievedMessage.messageId = msg.messageId;

MQGetMessageOptions gmo = new MQGetMessageOptions();
queue.get(retrievedMessage, gmo);
String msgText = retrievedMessage.readUTF();
System.out.println("The message is: " + msgText);

queue.close();
qMgr.disconnect(); 
```

我的队列管理器是`QM_FORD`，队列名称是 Q1。侦听器端口为 1414。环境变量设置正确。有人可以指导我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:34:40.560

问题不在您的 Java 代码中。Unsatisfied Link Error 表示未找到本机库（Windows 中的 .dll，Unix 中的 .so）。它要么丢失，要么未在环境变量中引用：PATH (Windows) 或 LD_LIBRARY_PATH 或 LIBPATH 等，具体取决于它所在的操作系统。

[谷歌搜索可能会给你一些想法](https://www.google.com/search?rlz=1C1CHFX_enUS389US389&aq=0&oq=java.lang.Unsatisfied&sugexp=chrome,mod=8&sourceid=chrome&ie=UTF-8&q=java.lang.unsatisfiedlinkerror)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-26T16:40:13.030

这里的问题是缺少 LIBRARY PATH。将您的 LD_LIBRARY_PATH 设置为“MQ_INSTALLATION_DIR”/java/lib（对于 Unix）

# ruby-on-rails - gmaps4rails infowindow 出现与 zurb 基础失真

> ID：10737435
> 
> 赞同：2
> 
> 时间：2012-05-24T12:24:28.120
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, gmaps4rails, zurb-foundation

![在此处输入图像描述](../Images/829400bcf009e04a5453573031c379fd.png)

我附上了下面信息窗口的屏幕截图。它看起来扭曲了，左侧栏也没有正常显示。

这是我的 gmaps4rails.css

```
.map_container {
  padding: 6px;
  border-width: 1px;
  border-style: solid;
  border-color: #ccc #ccc #999 #ccc;
  -webkit-box-shadow: rgba(64, 64, 64, 0.5) 0 2px 5px;
  -moz-box-shadow: rgba(64, 64, 64, 0.5) 0 2px 5px;
  box-shadow: rgba(64, 64, 64, 0.1) 0 2px 5px;
  width: 623px;
}

.gmaps4rails_map {
  width: 623px;
  height: 300px;
} 
```

可能是什么问题 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T10:34:15.890

似乎问题是由于重新调整图像大小而发生的。这是帮助的链接

[https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Google-Maps-with-Twitter-Bootstrap-or-Zurb-Foundation](https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Google-Maps-with-Twitter-Bootstrap-or-Zurb-Foundation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-18T03:23:32.727

有一个类似的问题并将以下内容添加到我的css文件中，它完美地解决了这个问题

img { 最大宽度：无；}

# c# - C# Asp.net Convert.toDateTime(datevalue) 给出不同文化信息的错误需要 datepattern 看起来像 5/1/2012 12:00:00 AM

> ID：10737439
> 
> 赞同：0
> 
> 时间：2012-05-24T12:24:49.103
> 
> 标签：c#, asp.net, .net, datetime, datetime-format

在我的**Asp.net**网站中，我有两个**文本框**（txtstartdate、txtenddate）应用**了 JQquery Datepicker**，弹出窗口以格式（“05/24/2012”）给出**日期**。对cultureInfo（“ **en-US** ”）工作正常，当我更改为（“ **de** ”）即德语时，它给出错误**“System.FormatException：字符串未被识别为有效的DateTime。”** . 在我的文件后面的代码中，我正在编写此代码

```
 string sDate = txtstartdate.Text;  //  05/01/2012 (debugging gives this values)
 string eDate = txtenddate.Text;    //   05/24/2012 (debugging gives this values)

 DateTime startdate = Convert.ToDateTime(sDate); //  5/1/2012 12:00:00 AM
 DateTime enddate = Convert.ToDateTime(eDate);   //  5/24/2012 12:00:00 AM 
```

我的要求是**datetime**变量必须给出格式为 2012 年**5 月 1 日上午 12:00:00**的日期，无论文化信息集是什么，都与日期无关。这样我就可以在**MsSql Server现有表中执行****选择查询**，该表具有列数据类型**Datetime**和数据(5/1/2012 12:00:00 AM) 格式

 ****更改**CultureInfo**（从 Masterpage 下拉列表）后**，英语到德语**出现错误已尝试过此操作但无法正常工作

```
 DateTime startdate = DateTime.ParseExact(sDate, "M/d/yyyy", null); 
 //tried also "MM/dd/yyyy" 
```

**注意：**设置任何 cultileinfo，但日期时间模式始终为 5/1/2012 12:00:00 AM 即`en-US`文化

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:26:46.853

您可以在调用时尝试使用`"MM/dd/yyyy"`格式字符串`ParseExact`，假设您确定输入将始终采用该格式。

或者，尝试`Convert.ToDateTime(yourString, CultureInfo.InvariantCulture)`改用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T13:26:15.813

我认为在这种情况下，您必须将日历的[altFormat](http://docs.jquery.com/UI/Datepicker#option-altFormat)设置为 SQL 服务器使用的格式。然后，您可以使用隐藏字段来存储每个日期选择器的 altDate。当您提交时，正确格式的[altField](http://docs.jquery.com/UI/Datepicker#option-altField)的值将被发送到您的服务器，而不是向用户显示的特定于文化的值。****

# c# - 在 DataTables 列表中查找相交的 DataRows

> ID：10737440
> 
> 赞同：6
> 
> 时间：2012-05-24T12:24:49.343
> 
> 标签：c#, .net, linq

我有一个清单。我想过滤表列表中的所有行，以查找列表中每个数据表中的所有行。

如果可能，比较需要在每一行的“ID”列上。

我试图用 Linq 解决这个问题，但被卡住了。这是我到目前为止所拥有的：

```
List<DataTable> dataTables = new List<DataTable>();

// fill up the list
List<DataRow> dataRows = 
    dataTables.SelectMany(dt => dt.Rows.Cast<DataRow>().AsEnumerable()).
    Aggregate((r1, r2) => r1.Intersect(r2)); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T14:49:04.200

不是一个简单的问题。这是一个解决方案（对我来说似乎太复杂了，但它有效）。

*   使用 Linq to DataSets 从每一行获取 Id 值
*   交叉多个列表以找到所有公共值
*   在具有匹配 id 之一的所有行中查找单个出现的行

要在 DataTable 上使用 Linq，请参阅[这篇文章](https://stackoverflow.com/questions/10855/linq-query-on-a-datatable)作为开始。

您可以像这样从一张表中获取 id

```
var ids = dt.AsEnumerable().Select (d => d.Field<int>("ID")).OfType<int>(); 
```

并从多个表

```
var setsOfIds = dataTables.Select (
    t => t.AsEnumerable().Select (x => x.Field<int>("ID")).OfType<int>()); 
```

要交叉多个列表，请尝试[这篇文章](https://stackoverflow.com/questions/1674742/intersection-of-multiple-lists-with-ienumerable-intersect)。使用其中一种方法，您可以获得所有 id 的交集。

使用 Jon Skeet 的辅助方法

```
public static class MyExtensions
{
    public static List<T> IntersectAll<T>(this IEnumerable<IEnumerable<T>> lists)
    {
        HashSet<T> hashSet = new HashSet<T>(lists.First());
        foreach (var list in lists.Skip(1))
        {
            hashSet.IntersectWith(list);
        }
        return hashSet.ToList();
    }
} 
```

我们可以写

```
var commonIds = setsOfIds.InsersectAll(); 
```

现在展平 DataTables 中的所有行并按公共 id 过滤：

```
var rows = dataTables.SelectMany (t => t.AsEnumerable()).Where(
    r => commonIds.Contains(r.Field<int>("ID"))); 
```

现在按 id 分组并获取每行的第一个实例：

```
var result = rows.GroupBy (r => r.Field<int>("ID")).Select (r => r.First ()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T13:16:21.667

试试这个来找到两个列表之间的交集：

```
r1.Join(r2, r1 => r1.Id, r2 => r2.Id, (r1, r2) => r1); 
```

# vim - VIM 和视口

> ID：10737445
> 
> 赞同：0
> 
> 时间：2012-05-24T12:25:08.463
> 
> 标签：vim, viewport

我有一个简单的问题，我使用带有两个视口的 Vim：

1.  e：（文件系统）
2.  文件编辑

我想在视口二中打开我从视口一中选择的文件，有没有办法在 Vim 中说明这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:45:07.580

为此，您可以使用非常棒的[NERDTree](http://www.vim.org/scripts/script.php?script_id=1658)插件。这是一个[教程](http://www.catonmat.net/blog/vim-plugins-nerdtree-vim/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:53:18.963

1) 执行`vim .`以打开文件浏览器视口
2) 用箭头选择要打开`o`
的文件，然后按 它将在新窗口/视口中打开文件。（窗口大小和你可以在这里看到的另一个窗口命令：http: [//vimdoc.sourceforge.net/htmldoc/windows.html](http://vimdoc.sourceforge.net/htmldoc/windows.html)）

# reporting-services - 如何获取报告列表

> ID：10737447
> 
> 赞同：0
> 
> 时间：2012-05-24T12:25:14.027
> 
> 标签：reporting-services

如何列出我在报表服务器中创建的所有报表？稍后我想使用这个列表在我的`ReportViewer`控件中显示它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:25:14.167

报表服务器使用名为`FindObjectsNonRecursive`.

```
string cnxstr = "Data Source=server;Initial Catalog=ReportServer;Integrated Security=SSPI;"; //connection string
using (SqlConnection connection = new SqlConnection(cnxstr))
{
    connection.Open(); 
    SqlCommand command = new SqlCommand();
    command.Connection = connection; 
    command.CommandType = CommandType.StoredProcedure; 
    command.CommandText = "FindObjectsNonRecursive";
    command.Parameters.Add(new SqlParameter("@Path", "/folder_name"));
    command.Parameters.Add(new SqlParameter("@AuthType", 1));
    SqlDataReader reader = null; 
    try
    {
        reader = command.ExecuteReader(); 
        while (reader.Read())
        {
            string path = reader["Path"].ToString(); 
            //now you can display this path in your list, or do whatever
        }
    }
    finally
    {  
        if (reader != null) 
            reader.Close(); 
    }
} 
```

# java - sendsignal.exe 有什么作用？

> ID：10737449
> 
> 赞同：1
> 
> 时间：2012-05-24T12:25:17.980
> 
> 标签：java, logging, dump

我听说[sendsignal.exe](http://www.latenighthacking.com/projects/2003/sendsignal/)用于将 java 应用程序的日志写入文件。您能否提供更多有关它的作用和作用的信息？请用简单的英语，我不是专家级程序员。

什么是“CTRL+break”？我在键盘上没有看到“中断”按钮。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T13:09:56.623

[Singals](http://en.wikipedia.org/wiki/Unix_signal)是一个 Unix 概念，它们是某种有限的进程间通信。

要创建线程转储，您将信号 SIGQUIT 发送到进程，信号被捕获并且线程转储将被写入。您还可以发送其他信号，例如终止进程。

要在 unix 上发送信号，您可以使用 kill 命令：

```
kill -3 <pid> 
```

java的方式是：

```
jstack <pid> 
```

您的 sendsignal.exe 可能也会这样做。

# bash - 有没有办法找到一个程序的孩子的pid？

> ID：10737451
> 
> 赞同：0
> 
> 时间：2012-05-24T12:25:19.383
> 
> 标签：bash

有没有办法找到一个程序的孩子的pid？

例如，我正在`pppoe`使用系统程序开始连接：

```
pon dsl-provider 
```

程序将在建立连接后退出并产生一个`pppd`需要的连接：

```
ps wx | grep pppd
  882 ?        S      0:01 /usr/sbin/pppd call dsl-provider 
```

问题是（直到现在我一直在这样做）我不想在 ps 列表中使用 grep，我想要一个准确的答案，并且在很多情况下我都需要这个（以上只是一个示例）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:04:37.257

尝试`pstree`使用`-p`选项显示进程的进程树及其附加 pid 的子进程：

```
$ pstree -p `pgrep pppd` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:43:14.957

我会使用`ps --ppid ORIGINAL_PROGRAMS_PID`，尽管如果原始程序退出它可能无法正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T12:38:21.123

你可以试试这个

```
# somehow get the PID of the parent (882 in your case)
PID=`ps wx | grep pppd | awk '{ print $1; }'`

# formatted output (includes the parent)
ps ax --format pid,ppid,command | grep $PID | grep -v grep 
```

# r - 防止单列自动转换为向量

> ID：10737452
> 
> 赞同：22
> 
> 时间：2012-05-24T12:25:20.570
> 
> 标签：r, dataframe

我有一个这样的数据框：
`df = data.frame(a=1:3, b=2:4, c=3:5)`

我正在使用类似的东西从该数据框中选择列：
`df[, c(T, F, T)]`

只要至少有两列要返回，这就可以正常工作；但是，如果我这样做，例如：
`df[, c(T, F, F)]`

...我突然只得到一个向量而不是一个data.frame。

通常这会很好（甚至是需要的），但是由于我需要稍后将结果作为 data.frame ，这完全弄乱了我的脚本。

有没有办法阻止 R 自动转换为单列选择的向量？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-05-24T12:29:23.343

这个很简单。附加`, drop = FALSE`到您的子集。

例如

`df[, c(T, F, F), drop = FALSE]`

也适用于矩阵。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T13:23:49.090

也没有逗号，即 df[c(T,F,F)]，返回一个数据帧，但听起来你有新数据帧可以有一个或多个列的情况。所以使用上面的 drop 选项

# jquery - 如何在dynatree的延迟加载中加载孙子？

> ID：10737454
> 
> 赞同：2
> 
> 时间：2012-05-24T12:25:22.767
> 
> 标签：jquery, json, dynatree, jquery-dynatree

我有一个要求，有时我想加载孩子和孙子，如果可能的话，他们的孩子在延迟加载..这可能吗？

当我为延迟加载准备 json 响应时，我可以像这样准备 json 响应吗？

```
[ { "title": "Node1", "isLazy": true, "key": "BC13B21636CD6D5C", }, { … }, … ] 
```

为了解决我的问题，我可以这样尝试吗？

```
 [ { "title": "Node1", "isLazy": true, "key": "BC13B21636CD6D5C",children:{ "title": "childNode", "isLazy": true, "key": "asdaasas"} }, { … }, … ] 
```

这行得通吗？

实际上，要求是当页面加载时，取决于某个条件，树下的特定节点应该展开并激活，向用户显示。如果用户希望正常，也可以延迟加载其他节点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T17:34:04.413

是的，这应该可行：您可以传递嵌套结构。请注意，如果已`children`定义节点，`"isLazy": true`则不需要该标志（但也不会造成伤害）。

# python - 在 WxPython 面板中嵌入 matplotlib 图

> ID：10737459
> 
> 赞同：28
> 
> 时间：2012-05-24T12:25:41.957
> 
> 标签：python, wxpython, matplotlib

如何在 WxPython 面板中嵌入**matplotlib 图形对象？**

我四处搜索，看到了涉及交互式图形和其他额外内容的复杂示例。任何人都可以帮助一个最小的例子吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-24T16:41:10.130

这是具有 matplotlib 画布的 Panel 的最小示例：

```
from numpy import arange, sin, pi
import matplotlib
matplotlib.use('WXAgg')

from matplotlib.backends.backend_wxagg import FigureCanvasWxAgg as FigureCanvas
from matplotlib.backends.backend_wx import NavigationToolbar2Wx
from matplotlib.figure import Figure

import wx

class CanvasPanel(wx.Panel):
    def __init__(self, parent):
        wx.Panel.__init__(self, parent)
        self.figure = Figure()
        self.axes = self.figure.add_subplot(111)
        self.canvas = FigureCanvas(self, -1, self.figure)
        self.sizer = wx.BoxSizer(wx.VERTICAL)
        self.sizer.Add(self.canvas, 1, wx.LEFT | wx.TOP | wx.GROW)
        self.SetSizer(self.sizer)
        self.Fit()

    def draw(self):
        t = arange(0.0, 3.0, 0.01)
        s = sin(2 * pi * t)
        self.axes.plot(t, s)

if __name__ == "__main__":
    app = wx.PySimpleApp()
    fr = wx.Frame(None, title='test')
    panel = CanvasPanel(fr)
    panel.draw()
    fr.Show()
    app.MainLoop() 
```

![在此处输入图像描述](../Images/bcb8bb96b5381e97c5b32fe2f7b44871.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-04-08T14:30:03.240

定义帧大小：

```
if __name__ == "__main__":
    app = wx.App()
    fr = wx.Frame(None, title='test', size=wx.Size(806, 450))
    panel = CanvasPanel(fr)
    panel.draw()
    fr.Show()
    app.MainLoop() 
```

或定义面板尺寸：

```
class CanvasPanel(wx.Panel):
    def __init__(self, parent):
        wx.Panel.__init__(self, parent,size=wx.Size(806, 450))
... 
```

# iphone - 使用块动画 UINavigationController 过渡

> ID：10737461
> 
> 赞同：1
> 
> 时间：2012-05-24T12:25:54.827
> 
> 标签：iphone, objective-c, ios, xcode, objective-c-blocks

谁能告诉下面这个代码片段的块动画等效？

```
[UIView beginAnimations:@"View Flip" context:nil];
[UIView setAnimationDuration:0.75];
[UIView setAnimationTransition:UIViewAnimationTransitionFlipFromRight 
           forView:self.navigationController.view cache:NO];

NextViewController *next = [[NextViewController alloc] 
           initWithNibName:@"NextViewController" bundle:nil];

[self.navigationController pushViewController:next animated:YES];
[next release];
[UIView commitAnimations]; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-24T13:00:10.533

```
NextViewController *next = [[NextViewController alloc] initWithNibName:@"NextViewController" bundle:nil];

[UIView transitionWithView:self.navigationController.view 
                  duration:0.75 
                   options:UIViewAnimationOptionTransitionFlipFromRight 
                animations:^{
                 [self.navigationController pushViewController:next animated:NO];
                } 
                completion:nil]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:34:12.337

```
UIView: + (void)transitionFromView:(UIView *)fromView toView:(UIView *)toView duration:(NSTimeInterval)duration options:(UIViewAnimationOptions)options completion:(void (^)(BOOL finished))completion 
```

# javascript - 需要帮助简化验证

> ID：10737469
> 
> 赞同：0
> 
> 时间：2012-05-24T12:26:15.577
> 
> 标签：javascript

我需要帮助简化/缩短以下验证代码。帮助将不胜感激。目前有太多的文字，我的老师说它可以做得更容易/更干净......我真的被卡住了。

谢谢你。

```
window.addEventListener('load',init,false);

function init(){
    var submit = document.getElementById("submit");
    var gender = document.getElementById("gender");
    var age = document.getElementById("age");
    var length = document.getElementById("length");
    var weight = document.getElementById("weight");
    var duration = document.getElementById("duration");
    var time = document.getElementById("time");

    submit.addEventListener('click', validation, false);
    gender.addEventListener('checked',validategender,false);
    age.addEventListener('blur', validateage, false);
    length.addEventListener('blur',validatelength,false);
    weight.addEventListener('blur',validateweight,false);
    duration.addEventListener('blur',validateduration,false);
    time.addEventListener('checked',validatetime,false);
}

function validategender(){
    var man = document.getElementById("man");
    var vrouw = document.getElementById("vrouw");
    var genderfout = document.getElementById("genderFout");
    if(man.checked != true && vrouw.checked !=true){
        genderfout.innerHTML = "Please choose a gender";
        return false;
    }else {
        genderfout.innerHTML = "";
    }return true;
}

function validateage() {
    var age = parseInt(document.getElementById("age").value, 10);
    var ageFout = document.getElementById("ageFout");
    if (isNaN(age) || age < 0 || age > 130) {
        ageFout.innerHTML = "Please enter a valid age";
        return false;
    } else {
        ageFout.innerHTML = "";
    }
    return true;
}

function validateweight() {
    var weight = parseInt(document.getElementById("weight").value, 10);
    var weightFout = document.getElementById("weightFout");
    if (isNaN(weight) || weight < 30 || weight > 200) {
        weightFout.innerHTML = "Please enter a valid weight";
        return false;
    } else {
        weightFout.innerHTML = "";
    }
    return true;
}

function validatelength() {
    var length = parseInt(document.getElementById("length").value, 10);
    var lengthFout = document.getElementById("lengthFout");
    if (isNaN(length) || length < 50 || length > 220) {
        lengthFout.innerHTML = "Please enter a valid length";
        return false;
    } else {
        lengthFout.innerHTML = "";
    }
    return true;
}

function validateduration() {
    var duration = parseInt(document.getElementById("duration").value, 10);
    var durationFout = document.getElementById("durationFout");
    if (isNaN(duration) || duration < 0) {
        durationFout.innerHTML = "Please enter a valid time-duration";
        return false;
    } else {
        durationFout.innerHTML = "";
    }
    return true;
}

function validatetime(){
    var minutes = document.getElementById("minutes");
    var hours = document.getElementById("hours");
    var timeFout = document.getElementById("timeFout");
    if(minuten.checked !=true && uur.checked !=true){
        timeFout.innerHTML = "choose a time unit!";
        return false;
    }else {
        timeFout.innerHTML = "";
    }
    return true;
}

function validation(e){
    var genderOk = validategender();
    var ageOk = validateage();
    var weightOk = validateweight();
    var lengthOk = validatelength();
    var durationOk = validateduration();
    var timeOk = validatetime();

    if (!genderOk || !ageOk || !weightOk || !lengthOk ||  !durationOk || !timeOk){
        e.preventDefault();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:28:17.007

使用 JQuery 验证器 [http://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)

您的验证代码将减少到现在的一半或可能更少。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:31:53.840

如果 JQuery 不允许留下另一个选项

[正则表达式](http://www.regular-expressions.info/javascriptexample.html)

你可以验证，但需要一点阅读

# jquery - 尝试使用 jquery hasClass 来打破悬停功能

> ID：10737470
> 
> 赞同：0
> 
> 时间：2012-05-24T12:26:16.323
> 
> 标签：jquery, html, class, jquery-selectors, traversal

如果满足某个条件，我试图打破一个函数（一个元素有一个类，这个类是动态添加和减去的）

代码：

```
this.buildMainToolsBar = function(options,display){

    var all =                       options.all || null,                                                        
        $mainToolsBarRef =          $('#mainToolsBar'),                                                         
        $disabledTools =            $('#mainToolFill, #mainToolStrokeStyle, #mainToolStrokeColour');

    if($disabledTools.hasClass('toolDisabled1')) {

        return;

    }else{

        $('form [id^=mainTool] > .toolInfo, form [id^=mainTool] > .navDown',$mainToolsBarRef).hover(function(){     

            $(this).parents('div[id^=mainTool]:not([id=mainToolsBar]):first').addClass('toolHover');            

        },function(){

            $(this).parents('div[id^=mainTool]:not([id=mainToolsBar]):first').removeClass('toolHover');

        });

    } 
```

类 toolDisabled1 仅在单击特定元素时出现。问题似乎是即使在找到 toolDisabled1 之前条件也已返回 true。

代替：

```
return; 
```

我也试过：

```
$disabledTools.removeClass('toolHover'); 
```

尝试破坏功能。

我也试过

```
('$disabledTools[class=toolDisabled1]').removeClass('toolHover'); 
```

如何动态检测是否添加了 toolDisabled1 类并因此退出该函数？

希望这很清楚，如果您需要更多代码，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T15:17:03.513

也许您可以考虑使用 .on 方法设置悬停事件。然后，您通常会在哪里添加`toolDisabled1`类（在选择所谓的 iso 元素时），您可以关闭悬停事件。然后在必要时（单击画布上的其他任何位置或返回矩形），您可以重新设置悬停事件。

我在这里写了这个技术的一个小例子：http: [//jsfiddle.net/XyDUV/](http://jsfiddle.net/XyDUV/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T13:09:01.763

问题可能在于变量`$disabledTools`选择了多个元素。如果此 jQuery 选择中的任何一个元素具有类，`toolDisabled1`那么您的 if 语句将返回 true。

当您进行检查时，该类是否`toolsDisabled1`应用于这些元素 ( ) 中的任何一个？`$('#mainToolFill, #mainToolStrokeStyle, #mainToolStrokeColour')`

# forms - 使用 JSF 和 jQuery / Javascript 进行动态反馈

> ID：10737471
> 
> 赞同：0
> 
> 时间：2012-05-24T12:26:19.040
> 
> 标签：forms, validation, jsf, dynamic, primefaces

我们正在使用 JSF 和 PrimeFaces 开发一个项目，我们希望在我们的表单上添加动态内联验证。我不确定 PrimeFaces 是否可以处理这个问题（如果我错了，请纠正我）所以我正在寻找一些替代品

**有谁知道我们可以用什么插件来做到这一点？更喜欢包含 JSF 的东西......**

*如果某些术语不正确，我不是开发人员而是 UX 人员，非常抱歉。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:03:37.953

标准 JSF 支持通过 ajax 进行服务器端验证（[此处](http://showcase.omnifaces.org/components/highlight)为现场示例），PrimeFaces 也绝对支持它（[此处](http://www.primefaces.org/showcase/ui/messages.jsf)为现场示例）。您可以添加`<f:ajax event="blur" render="message_id" />`内部输入组件以直接在模糊上执行验证（另请参阅[本教程](http://balusc.blogspot.com/2011/01/jsf-20-tutorial-with-eclipse-and.html#CreateJSFHelloWorldInEclipseTheView)）。

```
<h:inputText id="foo" value="#{bean.foo}" required="true">
    <f:ajax event="blur" render="foo_message" />
</h:inputText>
<h:message id="foo_message" for="foo" /> 
```

# html - HTML CSS 按钮文本对齐不起作用

> ID：10737473
> 
> 赞同：5
> 
> 时间：2012-05-24T12:26:26.747
> 
> 标签：html, css

我有这样的代码：

```
 <button class="prikazi_pretragu">Napredna Pretraga</button>​ 
```

和 CSS：

```
button {
  display:inline;
  font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif; 
  float: right; 
  clear: both; 
  padding: 0 50px 5px 5px; 
  text-align: left; 
  margin: 0 0 10px 0; 
  border: none; 
  background: url('../img/resursi/advsearch_plus.png') no-repeat 0 -28px rgba(0,0,0,.09);
  font-size: 14px; 
  height: 28px;
  text-align: right
}​ 
```

`text-align`不管用。问题是什么？

[http://jsfiddle.net/KjGBW/1/](http://jsfiddle.net/KjGBW/1/)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-24T12:29:58.510

这是工作。它向右对齐（毫无意义，因为您没有明确设置宽度）。只是您在右侧有一个 50px 的填充，这就是为什么它*似乎*与左侧对齐。

```
padding: 0 50px 5px 5px; 
```

值按此顺序用于右上左下。

将其设置为`padding: 0 5px 5px 5px;`

另外，如果你设置一个宽度，比如说 300px，你会看到它清楚地向右对齐。

请参阅[http://jsfiddle.net/thebabydino/KjGBW/5/](http://jsfiddle.net/thebabydino/KjGBW/5/) - 我更改了填充并添加了宽度。现在您可以清楚地看到它与右侧对齐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-19T14:11:33.917

将按钮显示设置为“网格”

```
button{
   display: grid;
} 
```

# jquery - JSRender - 动态更改模板

> ID：10737477
> 
> 赞同：1
> 
> 时间：2012-05-24T12:26:52.767
> 
> 标签：jquery, jsrender

我正在使用 JSRender 来呈现模板。

我在演示中使用第一个示例-

```
<!DOCTYPE html>
<html>
<head>

<script src="http://code.jquery.com/jquery.js" type="text/javascript"></script>
<script src="../../jsrender.js" type="text/javascript"></script>
<link href="../resources/demos.css" rel="stylesheet" type="text/css" />
</head>

<body>
<a href="../demos.html">JsRender Demos</a><br />
<h3>Render template against local data</h3>

<script id="movieTemplate" type="text/x-jsrender">

<!-- This thing i want to change dynamically -->
<div>
{{:#index+1}}:<b>{{:Close}}</b> ({{:Open}})
</div>

</script>

<div id="movieList"></div>

<script type="text/javascript"> 
var movies = [
{ name: "The Red Violin", releaseYear: "1998" },
{ name: "Eyes Wide Shut", releaseYear: "1999" },
{ name: "The Inheritance", releaseYear: "1976" }
];

// Render the template with the movies data and insert  
// the rendered HTML under the "movieList" element
$( "#movieList" ).html(
    $( "#movieTemplate" ).render( movies )
);

</script>
</body>
</html> 
```

我需要的是在运行时更改模板。也就是里面的`<div>`内容`<script id=movieTemplate">`

谁能帮我解决这个问题。

感谢您分享您的智慧。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T16:56:38.737

您可以通过 $.getJSON 下载 eample 的模板，然后执行类似的操作

```
$.getJSON('http://YourServer.com/yourTemplate.txt', function(res) {
$.templates({ tmpl: res });
$("#movieList").html($.render.tmpl(movies ));
}); 
```

高温高压

# c# - new Foo { A = 1, } 错误还是功能？

> ID：10737484
> 
> 赞同：5
> 
> 时间：2012-05-24T12:27:14.033
> 
> 标签：c#, c#-4.0

以下 C# 片段在我的 Visual Studio 2010 下编译和运行：

```
struct Foo {
    public int A;
}

// ..

var foo = new Foo { A = 1, }; 
```

请注意对象初始值设定项中的尾随逗号。

这是合法的 C# 并且它有什么有用的目的，还是我刚刚遇到了一个（良性）编译器错误？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T12:29:19.307

`Yes it is very much legal and useful in C# to have trailing commas and no it is not a (benign) compiler bug.`

Microsoft 为方便起见添加了该功能 - 如果您不必对第一项或最后一项进行特殊处理，则如果以编程方式生成代码，则该功能特别有用。您会在枚举声明、在对象初始化、数组、列表等中分配属性时发现类似的语法。

它允许尾随逗号只是为了更容易更统一地拥有一个进入初始化程序的项目列表，这些项目会随着时间的推移而改变长度。例如，既然你有那个逗号，那么在末尾添加一个新项目只涉及编辑一行，而不是编辑一行来添加逗号和另一行来添加新内容。

此外，如果您注释掉最后一个选项怎么办

```
enum Cars
{
   Honda,
   Hyundai,
   //Ford
} 
```

请参阅[.NET 的 Jon Skeet 答案现在支持数组中的尾随逗号，就像 python 一样](https://stackoverflow.com/a/3758513/1011959)

`Food for thought: If it had no use why would it be there in the first place?`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T12:33:27.687

如果注释掉最后一项导致编译错误会很烦人：

```
var f = new Foo {
    A = 1,
//  B = 4
};

[Flags]
enum Characteristics
{
    None = 0,
    Big = 1,
//  Strong = 2
}

var primes = new int[] {
    2,
    3,
//  5
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T12:39:16.967

是的，它是合法的，没有特定的目的。

# c# - 将字符串转换为枚举而不知道它在 C# 中的类型

> ID：10737487
> 
> 赞同：1
> 
> 时间：2012-05-24T12:27:32.137
> 
> 标签：c#, enums

我面临一个问题。我在我的应用程序中设置了一些枚举。喜欢

```
public enum EnmSection
{
    Section1,
    Section2,
    Section3
}

public enum Section1
{
    TestA,
    TestB
}

public enum Section2
{
    Test1,
    Test2
} 
```

`EnmSection`是主枚举，其中包含在其下方声明的其他枚举（作为字符串）。现在我必须填写`EnmSection`下拉列表中的值。我已经完成了。像这样...

```
drpSectionType.DataSource = Enum.GetNames(typeof(EnmSection));
drpSectionType.DataBind(); 
```

现在我的下拉列表有值：`Section1,Section2,Section3`

问题是：

我还有另一个下拉菜单`drpSubSection`。现在我想填充这个下拉列表中我在`drpSectionType`.

例如，如果我在 drpSectionType 中选择了 Section1，则 drpSubsection 应该包含该值 `TestA,TestB`。像这样：

```
protected void drpSectionType_SelectedIndexChanged(object sender, EventArgs e)
{
    string strType = drpSectionType.SelectedValue;
    drpSubsection.DataSource = Enum.GetNames(typeof());
    drpSubsection.DataBind();
} 
```

这里`typeof()`期待枚举。但我将选定的值作为字符串。我怎样才能实现这个功能。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:33:13.397

如果您引用的程序集包含另一个名为 的枚举，该`Section1`怎么办？

你只需要尝试所有你关心的枚举，一次一个，看看哪个有效。您可能想要使用`Enum.TryParse`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:50:31.383

```
drpSubsection.DataSource = Enum.GetNames(Type.GetType("Your.Namespace." + strType)); 
```

如果枚举在另一个程序集中（即它们不在 mscorlib 或当前程序集中），您需要提供[`AssemblyQualifiedName`](http://msdn.microsoft.com/en-us/library/system.type.assemblyqualifiedname.aspx). 最简单的方法是查看`typeof(Section1).AssemblyQualifiedName`，然后修改您的代码以包含所有必要的部分。完成后，代码将如下所示：

```
drpSubsection.DataSource = Enum.GetNames(Type.GetType("Your.Namespace." + strType + ", MyAssembly, Version=1.3.0.0, Culture=neutral, PublicKeyToken=b17a5c561934e089")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T12:50:49.940

像这样的东西可能会起作用，但你必须做一些异常处理：

```
protected void drpSectionType_SelectedIndexChanged(object sender, EventArgs e) 
{    
  string strType = drpSectionType.SelectedValue;    
  EnmSection section = (EnmSection)Enum.Parse(typeof(EnmSection), strType);
  drpSubsection.DataSource = Enum.GetNames(typeof(section));     
  drpSubsection.DataBind();

 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T13:51:50.583

这可能有点过头了，但如果您将 IEnumItem 的绑定数组绑定到下拉列表并将其设置为显示其显示文本，它将起作用。

```
public interface IEnumBase
{
  IEnumItem[] Items { get; }
}

public interface IEnumItem : IEnumBase
{
  string DisplayText { get; }
}

public class EnumItem : IEnumItem
{
  public string DisplayText { get; set; }
  public IEnumItem[] Items { get; set; }
}

public class EnmSections : IEnumBase
{
  public IEnumItem[] Items { get; private set; }

  public EnmSections()
  {
    Items = new IEnumItem[]
    {
      new EnumItem
      {
        DisplayText = "Section1",
        Items = new IEnumItem[]
        {
          new EnumItem { DisplayText = "TestA" },
          new EnumItem { DisplayText = "TestB" }
        }
      },
      new EnumItem
      {
        DisplayText = "Section2",
        Items = new IEnumItem[]
        {
          new EnumItem { DisplayText = "Test1" },
          new EnumItem { DisplayText = "Test2" }
        }
      }
    };
  }
} 
```

# iphone - 在 iPhone 应用程序中检测 UINavigationBar 子视图类型

> ID：10737489
> 
> 赞同：0
> 
> 时间：2012-05-24T12:27:41.153
> 
> 标签：iphone, objective-c, ios, custom-controls, uinavigationbar

我一直在尝试在 iPhone 应用程序中自定义导航栏。我试图使用导航栏的子类并使用布局子视图方法来实际操作我需要的视图。现在，我正在获取子视图列表，但我不知道如何检测哪个子视图是条形按钮或哪个是标题视图。我在他们的描述中只能看到它是一个 UINavigationItem 和一些附加信息。在这方面需要一些帮助！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:44:10.840

```
for (id view in self.subviews) {
    if ([view isKindOfClass:[UIBarButtonItem class]]) {
        // subview is UIBarButtonItem
    }
    // etc...
} 
```

如果目标是操纵标题的大小，我认为您应该改为设置`titleView`of `UINavigationItem`。这必须在`UIViewController`您推送到您的`UINavigationController`.

```
- (void)viewDidLoad {
    [super viewDidLoad];
    // Play around with the frame of the UILabel to 
    // achieve the effect you are going for
    UILabel *label = [[UILabel alloc] initWithFrame:self.navigationItem.titleView.frame];
    label.text = @"Title text";
    label.font = [UIFont fontWithName:@"Oblik-Bold" size:18];
    label.backgroundColor = [UIColor clearColor];
    [label sizeToFit];
    self.navigationItem.titleView = label;
} 
```

如果您不想在每一个中都这样做，`UIViewController`您可以创建一个实现该功能的基类，并且您的所有`UIViewController`s 都继承自。

# c++ - 转换时间戳（以毫秒为单位）以提升 ptime

> ID：10737493
> 
> 赞同：4
> 
> 时间：2012-05-24T12:27:48.873
> 
> 标签：c++, datetime, boost

我需要将自纪元以来以毫秒为单位的时间转换为 a `boost::posix_time::ptime`。我看到的唯一功能是转换，`from_time_t`但这仅以秒为单位，并且会丢失毫秒。

如何从纪元以来的毫秒数转换为 ptime 类型？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-24T12:33:01.390

`ms`自纪元以来您的毫秒数在哪里：

```
ptime epoch_milliseconds_to_ptime(unsigned long int ms)
{
  static const ptime epoch(date(1970, 1, 1));

  return epoch + milliseconds(ms);
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-24T12:32:18.507

```
from_time_t(millis / 1000) + millisec(millis % 1000) 
```

# knockout.js - 从子级触发根上的方法时的上下文

> ID：10737494
> 
> 赞同：3
> 
> 时间：2012-05-24T12:27:52.920
> 
> 标签：knockout.js

我有这个非常简单的测试视图

```
<button data-bind="click: add">Add</button>
<table data-bind="foreach: items">
    <tr>
        <td data-bind="text: name"></td>
        <td><button data-bind="click: $root.remove">Remove</button></td>
    <tr>
</table> 
```

小提琴：http: [//jsfiddle.net/6PP5m/](http://jsfiddle.net/6PP5m/)

问题在于 remove 方法中 this 的上下文是触发点击事件的子视图模型

我还没有找到我喜欢的解决方案，您可以在构造函数中添加一个 self 变量并使用它而不是“this”，但它更干净的代码和 OO 使用“this”关键字

小提琴：http: [//jsfiddle.net/Qn2CM/](http://jsfiddle.net/Qn2CM/)

您也可以创建一个代理函数委托，但它仍然不是很干净的代码

小提琴：http: [//jsfiddle.net/gYhMr/](http://jsfiddle.net/gYhMr/)

我想告诉 ko 以某种方式将 this 的上下文设置为正确的范围（在这种情况下为 $root ）是否可能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T13:17:43.897

如您所见，单击/事件绑定在当前数据的上下文中运行。

有几个选项可以确保您的函数在正确的上下文中运行：

*   将正确设置`this`为变量`self`并在您的处理程序中使用它（正如您所提到的）
*   `$.proxy`在您的视图模型中使用或类似的东西`.bind`来确保它`this`是正确的（正如您所提到的）
*   将函数内联绑定`data-bind="click: $root.remove.bind($root)"`
*   使用一个（丑陋的）匿名函数，比如`data-bind="click: function() { $root.remove($data); }"`

# ios - 如何使用 dateformatter 方法获取正确的日期？

> ID：10737495
> 
> 赞同：2
> 
> 时间：2012-05-24T12:27:54.737
> 
> 标签：ios, xcode4.2, nsdateformatter

这是我的代码：

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateStyle:NSDateFormatterMediumStyle];
[dateFormatter setTimeStyle:NSDateFormatterNoStyle];

NSDate *date = [NSDate dateWithTimeIntervalSinceReferenceDate:1275822000000+0000]; 
```

// 字符串是json解析字符串

```
NSString *formattedDateString = [dateFormatter stringFromDate:date];
NSLog(@"formattedDateString: %@", formattedDateString); 
```

输出为 Dec 20,5828963

但我要求的输出是 2010 年 6 月 6 日

如何更改我的代码以获得正确的输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:50:19.497

首先：您的时间戳看起来像 Java 时间戳，但它有几个额外的零（其中 4 个正好）。您必须将其转换为 Unix 时间戳，即自 Unix 纪元以来的秒数（与 Java 相反，它是自 Unix 纪元以来的毫秒数）。

`dateWithTimeIntervalSinceReferenceDate:`不接受 Unix 时间戳，但转换很简单：

```
double timestampFromService = 12758220000000000;
NSDate *date = [NSDate dateWithTimeIntervalSince1970:
    (timestampFromService*1.0e-7)]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T12:38:18.370

如果您想从某个幻数收到 2010 年 6 月 6 日，请使用以下命令：

```
NSDate *date = [NSDate dateWithTimeIntervalSinceReferenceDate:297475822]; 
```

出于某种原因，您的数字非常大，正如@wrock 提到的那样，它乘以 1000 万，因此为了获得正确的值，您可以使用 dateWithTimeIntervalSince1970 并将其除以 1000 万

```
NSDate *date = [NSDate dateWithTimeIntervalSince1970:1275822000]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T12:34:10.423

以可读的方式使用日期：

```
NSDate *myDate = [NSDate dateWithString:@"2010-06-06 00:00:00"];

NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateStyle:NSDateFormatterMediumStyle];
[dateFormatter setTimeStyle:NSDateFormatterNoStyle];

NSString *formattedDateString = [dateFormatter stringFromDate:myDate];
NSLog(@"formattedDateString: %@", formattedDateString); 
```

# java - 如何将字符串转换为 DurationFieldType？

> ID：10737501
> 
> 赞同：0
> 
> 时间：2012-05-24T12:28:26.397
> 
> 标签：java, jodatime

您好，有没有办法在 joda 时间内将 String 转换为 DurationFieldType？

例如“年” => DurationFieldType.years();

我正在尝试使用指定数量的单位（如 3 年或 5 个月等）来增加日期。我已经使用字符串值指定了数量（整数）和时间单位类型。

我想确定我没有忽略什么。我想出的最佳解决方案是使用 HashMap

```
Map<String, DurationFieldType> fieldMap = new HashMap<String, DurationFieldType>();
fieldMap.put("year", DurationFieldType.years());
fieldMap.put("month", DurationFieldType.months());
fieldMap.put("day", DurationFieldType.days());
fieldMap.put("week", DurationFieldType.weeks());
fieldMap.put("hour", DurationFieldType.hours());
...
map = Collections.unmodifiableMap(fieldMap);

DateTime from = new DateTime(...);
Period period = new Period().withField(fieldMap.get(someObject.getTimeUnit()), someObject.getDuration());
DateTime to = from.plus(period); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T09:39:20.450

目前没有办法进行这种查找。

如果您愿意，您可以在 GitHub 上分叉该项目并添加一个方法来执行此操作 - DurationFieldType.of(String) - 这与您上面的代码所做的一样多。加上一些测试。然后发送拉取请求；-)

# eclipse - windows中的solaris库

> ID：10737502
> 
> 赞同：1
> 
> 时间：2012-05-24T12:28:28.087
> 
> 标签：eclipse, solaris, eclipse-cdt

我们有一个使用 sun studio creator[Sun C++ 5.10] 编译的 solaris 共享对象 (.so)（无法访问源代码）。

我必须使用 ide 的 eclipse cdt/visual studio 在 windows 中基于该 solaris 库开发 c++ 应用程序。

最好是eclipse cdt。

尝试使用 Mingw 不工作。

可以从 MinGW 链接到 sun 工作室库的 g++。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:40:17.977

我希望你不要期待像链接器标志这样简单的东西......

这里有不兼容的格式（[ELF](http://en.wikipedia.org/wiki/Executable_and_Linkable_Format)与[PE](http://en.wikipedia.org/wiki/Portable_Executable)）、不兼容[的 ABI](http://en.wikipedia.org/wiki/Application_binary_interface)（[Solaris](http://docs.oracle.com/cd/E18752_01/html/817-4415/solabi-18.html)与 Windows）以及可能不兼容的机器代码（[SPARC](http://en.wikipedia.org/wiki/SPARC)与[x86](http://en.wikipedia.org/wiki/X86)与[x64](http://en.wikipedia.org/wiki/X86-64)）。

如果库适合于此，“最简单”的解决方案是创建一个在 Solaris 服务器上运行的帮助服务，将库函数公开为[RPC](http://en.wikipedia.org/wiki/Remote_procedure_call)，并在 Windows 上使用它们。

# coffeescript - Coffeescript JS 版本？

> ID：10737503
> 
> 赞同：0
> 
> 时间：2012-05-24T12:28:30.400
> 
> 标签：coffeescript

如果我要使用 Coffeescript 进行开发，我将需要知道 coffeescript JS 代码支持哪些浏览器——我敢肯定会有一个关于该主题的网页 :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:33:43.537

**更新：**我现在意识到您特别要求支持 Coffeescript 编译器的浏览器。我没有这方面的详细信息，但考虑到 Coffeescript 的广泛使用，我的答案将是其中的大部分。

没有浏览器直接支持 Coffeescript，尽管可能有一些神奇的 javascript 片段可以在浏览器加载页面时即时将 Coffeescript 编译为 Javascript。

然而，通常的工作流程是将 Coffeescript 编译为 Javascript，然后只向浏览器提供生成的 Javascript 文件。“编译”也可能不是正确的词，因为它或多或少地将一组源代码 (Coffescript) 转换为另一组源代码 (Javascript)，然后对其进行解析，有时进行 JIT 编译以在浏览器中执行（蜘蛛猴、V8 等）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:50:04.300

CoffeeScript 的座右铭是“它只是 JavaScript”。这意味着，如果您编写 CoffeeScript 代码来调用仅存在于较新浏览器中的功能，则 JavaScript 输出将取决于该功能。CoffeeScript 自己的语法特性，例如类继承和数组解析，生成的代码与所有主要浏览器兼容，可追溯到 IE6。

# javascript - 访问div隐藏参数

> ID：10737504
> 
> 赞同：0
> 
> 时间：2012-05-24T12:28:32.640
> 
> 标签：javascript, jquery

我正在迭代`div`using ：

我可以`div`在迭代中访问隐藏参数吗？

```
<DIV>
    <div id="myDiv" <input type="hidden" name="Language" value="English"> />
</DIV>

$('#myDiv div.id').each(function() {
    //access a hidden parameter of the current div here
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:35:46.737

您可以使用以下方法之一：

```
$('#myDiv div.id').each(
    function(){
        parameter = $(this).attr('data-hidden-parameter');
        /* or:
        parameter = $(this).data('hidden-parameter');
        */
    }); 
```

第一个`parameter = $(this).attr('data-hidden-parameter')`需要以下结构：

```
<div class="id" data-hidden-parameter="value"><!-- other stuff --></div> 
```

而后者适用于使用`data()`jQuery 的方法获取/设置：

```
$(selector).data('hidden-parameter','value'); // sets
$(selector).data('hidden-parameter'); // gets 
```

如果您的意思是从元素的子元素的隐藏元素中检索文本或其他内容/属性，请`div.id`使用以下标记：

```
<div class="id">
    <input type="hidden" value="somethingOrOther" />
    <span style="display: none;">Some text in a hidden element</span>
</div> 
```

您可以使用以下方法检索该值：

```
$('#myDiv div.id').each(
    function(){
        parameter = $(this).find('input:hidden').val();
        /* or:
        parameter = $(this).find('span').text();
    }); 
```

* * *

**请注意**，您的 jQuery 选择器意味着您正在根据这些元素的类迭代许多元素，而您的类名`id`, 意味着您正在尝试基于`id`元素的 进行搜索。这可能是演示您的方法的伪代码，但请不要使用`id`. 这是完全有效的，但它非常令人困惑。尽管这只是我自己的，个人的，反对和回应。

* * *

**已编辑**，通过使用适当的选择器修改上述建议之一，提供更有针对性的答案：

```
var parameter = $('#myDiv').find('input:hidden[name="Language"]').val(); 
```

参考：

*   [`attr()`](http://api.jquery.com/attr/).
*   [`data()`](http://api.jquery.com/data/).
*   [`find()`](http://api.jquery.com/find/).
*   [`:hidden`选择器](http://api.jquery.com/hidden-selector/)。
*   [`text()`](http://api.jquery.com/text/).
*   [`val()`](http://api.jquery.com/val/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:36:50.383

您的`html`代码无效：如果您的意思是

```
 <div id="myDiv"><input type="hidden" name="Language" value="English"></div> 
```

这将针对您的输入

```
$('#myDiv input[type="hidden"]') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T12:37:53.083

您不能将标签放在另一个标签内（或者，在 HTML 或 HTML 兼容的 XHTML 中，在 div 上使用自闭合标签语法）。您的 HTML 是无效的，并且会受到任何错误恢复解析器的影响。

例如，如果您有：

```
<div id="myDiv">
    <div class="id">
        <input type="hidden" name="Language" value="English">
    </div>
</div> 
```

然后你可以这样做：

```
$('#myDiv div.id').each(function(index, element) {
    var foo = $(element).find('input').val()
 }); 
```

…但你可能最好使用[data-*](http://www.w3.org/TR/html5/global-attributes.html#embedding-custom-non-visible-data-with-the-data-attributes)和 jQuery 的[`data()`方法](http://api.jquery.com/jQuery.data/)

# jquery - 如何按顺序循环ajax帖子

> ID：10737509
> 
> 赞同：0
> 
> 时间：2012-05-24T12:28:42.043
> 
> 标签：jquery, post, loops

我需要调用这个帖子函数 n 次

```
$.post("prova.php", { myparameter:p1 }, 
    function(msg){ 
       alert('ok')
    }
); 
```

所以像这样循环它：

```
for(i=0;i<myArray.length;i++){
   $.post("prova.php", { myparameter:p1 }, 
        function(msg){ 
           updateUI();
        }
    );
} 
```

当第一个仍然处于活动状态时，我如何停止其他 myArray.length -2 $.post？我希望我的问题很清楚..谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:39:06.507

你能试试吗

```
var x = myArray.length;  // n times you want 

function Send (){
  if (x > 0){
     $.post("prova.php", { myparameter:p1 }, 
        function(msg){ 
          x -= 1 ;
          Send();      
        }
     );
  }
} 
```

**更新多** 合一功能

var x = myArray.length; // 你想要的 n 次

```
function Send (x){
  if (x > 0){
     $.post("prova.php", { myparameter:p1 }, 
        function(msg){ 
          x -= 1 ;
          Send(x);      
        }
     );
  }
}

 function beforeSend(){
    var x = myArray.length;  // n times you want 
    Send (x);
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T12:39:08.653

我认为您的意思是您不想最终`$.post`同时调用请求，并且您想等到最后一个完成后再进行下一个。

您可以以丑陋的方式做到这一点，而无需任何外部库执行以下操作：

```
<script src="text/javascript">
var count = 0;

function doRequest()
{
    if (count >= myArray.length)
        return null;

    $.post('prova.php', { myparameter: p1 }, function(msg)
    {
        updateUI();
        count++;
        doRequest();
    });
}

doRequest();
</script> 
```

或者你可以使用我最喜欢的 JavaScript 库之一，[async](https://github.com/caolan/async)。这使您可以编写更理智、更容易理解的代码，并执行以下操作：

```
<script type="text/javascript">
var count = 0;
async.whilst(function() //test function, stop running when this is return false
{
    return count < myArray.length;
},
function(callback)
{
    $.post('prova.php', { myparameter: p1 }, function(msg)
    {
        updateUI();         
        count++;
        callback(null); //callback with null as the error
    });
},
function(error) //this is called when we're done
{
    //do stuff
});
</script> 
```

这两个函数中的任何一个都应该为您一次只处理一个请求，假设这是您想要的。

# silverlight - Ninject 在 silverlight 项目中无法正确解决依赖关系

> ID：10737514
> 
> 赞同：0
> 
> 时间：2012-05-24T12:29:04.697
> 
> 标签：silverlight, dependency-injection, inversion-of-control, ninject

我有一个带有 mvvmlight 和 ninject 3.x 的 silverlight 4 项目。

我已经像这样设置了容器

```
kernel = new StandardKernel(new ViewModelModule(), new ClientSessionModule()); 
```

像这样的模块

```
public class ViewModelModule : NinjectModule
{
    public override void Load()
    {
        ((StandardKernel)Kernel)
            .Bind(scanner => scanner.FromThisAssembly()
                            .Select(x  => x.IsSubclassOf(typeof(ViewModelBase)))
            .BindDefaultInterface());
    }
} 
```

和

```
public class ClientSessionModule : NinjectModule
{
    public override void Load()
    {
        Kernel.Bind<IClientContext>().To<ClientContext>().InSingletonScope();
    }
} 
```

现在的问题是后一个。在应用程序的某一时刻，这种依赖关系被显式解决并更新如下：

```
var context = App.Ioc.Get<IClientContext>();
context.Username = "just a sample name"; 
```

现在，当加载 ViewModel 时，它会像注入一样注入 IClientContext

```
public MainViewModel(IClientContext clientContext) 
```

问题是该实例没有之前设置的名称。但是，如果我在同一个 ViewModel 中再次显式解析，我会得到具有名称集的预期实例。

由于 sigleton 没有像我预期的那样自动注入，我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T13:35:33.797

刚刚在我的解决方案中发现了一个重复的内核。这就解释了为什么我无法像预期的那样解决问题，因为我有 2 个内核正在运行

# php - Opencart 图片上传使文件名安全

> ID：10737518
> 
> 赞同：1
> 
> 时间：2012-05-24T12:29:08.333
> 
> 标签：php, opencart

使用 opencart 图像管理器如何将上传设置为自动删除：图像文件名中的空格和不安全字符？

**文件管理器.php**

```
$filename = basename(html_entity_decode($this->request->files['image']['name'], ENT_QUOTES, 'UTF-8')); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:52:41.060

最好的方法是使用简单的 preg_replace 例如

```
$filename = preg_replace('~[^\w\./\\\\]+~', '', $filename); 
```

这将允许字母、数字、下划线、反斜杠和正斜杠以及 . 仅在文件名中，并删除其他任何内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:41:00.467

htmlspecialchars 对不安全字符（即 < > & ' " 仅此而已。

```
 // for removing unsafe characters
       $text = htmlspecialchars($text); 
```

// 用于删除空格

使用正则表达式：

```
 preg_replace('/( )+/', ' ', $string);

      //If you also want to remove every multi-white characters, you can use \s (\s is  white characters)

      preg_replace('/(\s)+/', ' ', $string); 
```

# sql - 创建执行 SQL 脚本的 bat 文件

> ID：10737519
> 
> 赞同：1
> 
> 时间：2012-05-24T12:29:09.947
> 
> 标签：sql, batch-file, automation

我有一个文件夹，在每个每周冲刺之后都会将许多 MSQL 脚本放入其中。例如，今天将 10 个脚本放入该文件夹中。然后我必须单独打开每个脚本并针对适用的数据库运行它。它需要运行的数据库位于文件的名称中。例如 [2] [CRMdata]UpdateProc.sql

[2] 代表它运行的顺序，因此脚本 [1] 需要在它之前运行。[CRMdata] 是我必须针对它运行的数据库。

这个过程非常烦人，尤其是如果有 50 个脚本要按顺序运行。我想知道是否有更简单的方法可以做到这一点？Perhpa 是一个 .bat 文件，它读取文件名，并根据脚本编号顺序执行脚本，并针对文件名中指定的数据库执行它。

任何帮助深表感谢。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T13:09:49.390

首先，当你需要运行东西时，考虑使用 SQL Server Job Agent。这是安排简单事情的好方法。

对于这样的任务，我建议将 PowerShell 与“sqlcmd”结合使用。该命令实际上是您问题的答案，因为它将从命令行运行脚本。

但是，更进一步。安排每周运行一次的作业（或您希望它运行的任何时间）。让它包含一个步骤，一个 PowerShell 脚本。然后可以循环遍历目录中的所有脚本，从名称中提取文件名，并使用 sqlcmd 运行脚本。在此过程中，还要在表格中记录您正在执行的操作，以便您发现错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T15:01:07.383

我对使用 MSQL 执行 SQL 一无所知。您必须弄清楚如何使用为 MSQL 提供的任何命令行实用程序针对正确的数据库运行每个脚本。

我可以为您提供一个批处理文件，该文件将按正确的顺序对 SQL 文件进行排序，并解析出数据库的名称。

如果序列号为零前缀为恒定宽度，则批量作业会容易得多。我假设重命名文件是可以的，所以这就是这个解决方案的作用。

我还假设您处理的文件永远不会超过 999 个。可以轻松修改代码以处理更多内容。

如果任何文件名包含该字符，则必须进行一些更改，`!`因为延迟扩展会破坏 FOR 变量的扩展。但这是一个不太可能出现的问题。

```
@echo off
setlocal enableDelayedExpansion

:: Change the definition to point to the folder that contains the scripts
set "folder=sqlCodeFolder"

:: The mask will only match the pattern that you indicated in your question
set "mask=[*] [*]*.sql"

:: Rename the .sql files so that the sequence numbers are zero prefixed
:: to width of 3\. This enables the default alpha sort of the directory to be
:: in the proper sequence
for /f "tokens=1* delims=[]" %%A in ('dir /b "%folder%\%mask%"') do (
  set seq=00%%A
  ren "%folder%\[%%A]%%B" "[!seq:~-3!]%%B"
)

::Process the renamed files in order
for %%F in ("%folder%\%mask%") do (
  for /f "tokens=2 delims=[] " %%D in ("%%~nF") do (
    rem %%F contains the full path to the sql file
    rem %%D contains the name of the database, without enclosing []
    rem Replace the echo line below with the proper command to run your script
    echo run %%F against database [%%D]
  )
) 
```

# sql - PLS-00103，在触发器中

> ID：10737520
> 
> 赞同：0
> 
> 时间：2012-05-24T12:29:12.963
> 
> 标签：sql, oracle, triggers

```
create or replace TRIGGER log_worlds BEFORE UPDATE OR INSERT ON worlds
DECLARE
ac VARCHAR2(50);
tab VARCHAR2(50);
world VARCHAR2(50);
BEGIN
IF UPDATING THEN
ac:='Aktualizacja';
END IF;
IF INSERTING THEN
ac:='Nowe';
END IF;
tab:='WORLDS';
world:='world_';
world:=world||cast(NEW_WORLD.NEXTVAL as VARCHAR2(10));
INSERT INTO log(ACTION_DATE,ACTION,TAB_NAME,ADDED_WORLD) VALUES(SYSDATE,ac,tab,world);
INSERT INTO worlds(WORLD_NAME) VALUES(world);
END; 
```

有人可以帮我解决这个问题，错误信息是关于第 14 行的吗？当我的 APEX 应用程序针对表发出 DML 时，该触发器应该向日志表添加新值并更改世界表的主键值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:44:25.443

我认为这是这条线：

```
world:=world||cast(NEW_WORLD.NEXTVAL as VARCHAR2(10)); 
```

如果您将其替换为：

```
world := world||to_char(NEW_WORLD.NEXTVAL); 
```

它应该工作。

顺便说一句：在分配中直接使用`nextval`调用不适用于 11.x 之前的版本（不确定此处 x 的值）。

在 10.x 中，您需要声明一个变量，然后使用：

```
SELECT to_char(new_world.nextval)
   into world_num;
world := world || world_num; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:43:40.723

直接的语法错误是假设`NEW_WORLD`是您创建的序列，您需要执行类似的操作

```
SELECT world ||
         cast( new_world.nextval as varchar2(10) )
  INTO world
  FROM dual; 
```

而不是直接引用您的`CAST`.

我还不清楚你的触发器应该做什么。它至少会产生一个无限循环。每个`INSERT`on`WORLDS`都会导致触发器触发，这将生成一个`INSERT`on `WORLDS`which 将导致触发器触发，等等。当您超过最大递归深度时，Oracle 最终会引发错误。也许您希望这是一个行级触发器，而不是一个更改`:new.world_name`?值的语句级触发器。如果是这种情况，您可能想要类似的东西

```
create or replace TRIGGER log_worlds 
  BEFORE UPDATE OR INSERT ON worlds
  FOR EACH ROW
DECLARE
  ac VARCHAR2(50);
  tab VARCHAR2(50);
  world VARCHAR2(50);
BEGIN
  IF UPDATING THEN
    ac:='Aktualizacja';
  END IF;
  IF INSERTING THEN
    ac:='Nowe';
  END IF;
  tab:='WORLDS';
  world:='world_';
  select world || cast(new_world.nextval as varchar2(10)
    into world
    from dual;
  INSERT INTO log(ACTION_DATE,ACTION,TAB_NAME,ADDED_WORLD) 
    VALUES(SYSDATE,ac,tab,world);
  :new.world_name := world;
END; 
```

这假定它`world_name`实际上不是主键。如果`world_name`是主键，那么在更新行时修改主键值是没有意义的——如果您正在执行`INSERT`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T12:31:35.603

您收到的错误表明您的代码中有一些我无法立即找到的语法错误。但是，我预计会出现另一个错误，因为 Oracle 不允许您在触发器所在的同一个表上的触发器内执行 DML 语句（选择、插入、更新、删除）。您的触发器位于表世界上，因此不允许您将记录插入到触发器内的表世界中。

# jsf - 如何使 div 标签之间的 onclick 工作？

> ID：10737521
> 
> 赞同：2
> 
> 时间：2012-05-24T12:29:16.380
> 
> 标签：jsf, xhtml, onclick, primefaces, facebook-like

我想在*div*标签之间的*onclick*中调用一个 bean 函数，但据我所知，在这种情况下不能简单地调用非脚本函数。实际上，我将一个*类似 facebook 的按钮*设置为：

 **```
<div class="fb-like" data-href="#{someBean.getSomeUrl()}" data-send="false" 
    data-layout="button_count" data-width="100" data-show-faces="false"
            onclick="#{someBean.saveLikeCount()}">
</div> 
```

我需要这种*onclick*操作来更新和保存喜欢计数到我的数据库（Facebook 会自动增加该数字但将其保存到自己，所以当有人单击该喜欢按钮时，我需要获取计数并将其保存到我的数据库中）。有出路吗 ？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:39:51.920

您的`onclick`方法将永远不会被触发，因为 Facebook Like Button 实际上将被加载到`iframe`该元素中，并且事件不会传播到您的文档......这样您就永远不会知道用户喜欢或不喜欢什么。

但是，您可以收听（Facebook JS-SDK 的） `edge.create`/`edge.remove`事件，以便能够知道何时有人喜欢/不喜欢

```
FB.Event.subscribe('edge.create', function(url) {
  // Like was created for `url`
});

FB.Event.subscribe('edge.remove', function(url) {
  // Like was removed for `url`
}); 
```**

# c# - 以编程方式设置 Toolpart 布局

> ID：10737526
> 
> 赞同：2
> 
> 时间：2012-05-24T12:29:25.497
> 
> 标签：c#, sharepoint-2010, web-parts, toolpart

我正在按照本教程创建工具部件：[http ://www.dhirajranka.com/?p=420](http://www.dhirajranka.com/?p=420)

我仍然需要了解的是如何：1）向自定义工具部分添加标题 2）调整各种组件（按钮下拉列表等）

我已经被设计师的观点宠坏了，但现在我不能使用它，我有点迷失了。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:51:54.840

您需要将此行添加到 Web 部件的属性中：

```
[ToolboxItemAttribute(false), WebBrowsable(true), WebDescription("Set the list name to use."), WebDisplayName("List Name"), Personalizable(PersonalizationScope.User)]
public string ListName{ 
    get{return customListName;}
    set{customListName = value;}
} 
```

这行得通，现在我在我的 SharePoint 上运行它。

此致！

# php - 从 php 文件中捕获 postgresql 命令执行错误

> ID：10737529
> 
> 赞同：0
> 
> 时间：2012-05-24T12:29:37.910
> 
> 标签：php, postgresql-9.1

我是 php 的初学者并且遇到了一些问题：

我有一个具有函数**create_dump()的****php 文件**，我在其中使用**pg_dump**命令转储我的**postgresql 数据库。**现在，在从 linux 终端执行 php 文件时，它会在终端上询问**postgresql 密码**。如果用户无意中为数据库提供了错误的密码，我想在我的 php 文件中添加错误处理。

 ******换句话说：
如何从我的 php 文件中捕获**pg_dump**（postgresql 命令）执行错误？
谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:53:27.007

根据您提供的信息，我有一个解决方法来解决您想要做的事情。首先，您需要使用 --file=some_file.sql 标志而不是使用“>”管道输出转储的输出，它执行相同的工作。

现在，即使您将 stderr 发送到 stdout，passthru 调用的 $output 似乎也不会捕获输出，所以这就是可行的方法。您将使用 --file= 标志修改命令并将命令的输出（包含错误）通过管道传输到日志文件，同时确保还将 stderr 发送到 stdout（在命令之后执行 2>&1），以便捕获错误。

这是代码：

```
// notice the file= flag and the piping of error to the file
$command=
    "/usr/bin/pg_dump --a --no-owner --no-acl --attribute-inserts ".
    "--disable-dollar-quoting --no-tablespaces ".
    "--file={$path['schema_path']}schema-{$latest_update}.sql ".
    "--host={$db['hostname']} --user={$db['username']} ".
    "--password --port={$db['port']} {$db['database']} > pg_dump_error.log 2>&1"; 

// no output to capture so no need to store it
passthru($command);

// read the file, if empty all's well
$error = file_get_contents('pg_dump_error.log');
if(trim($error) != '')
    exit("PG_DUMP ERRROR:\n-----\n$error\n"); 
```

希望这或多或少是您想要的。******

# postgresql - 通过查询重写避免执行某些 PL/PGSQL 函数

> ID：10737530
> 
> 赞同：0
> 
> 时间：2012-05-24T12:29:42.000
> 
> 标签：postgresql, query-optimization, plpgsql

我希望`my_function`仅当 PL/PGSQL 函数 ( ) 的参数 ( `my_table.x`) 属于预定义的间隔 (例如 [100,1000]) 时才允许执行它。

让我们看下面的查询示例：

(q) `SELECT * FROM my_table WHERE my_function(mytable.x);`

我希望此查询自动重写自身以检查是否`mytable.x`属于区间 [100,1000] ：

(q') `SELECT * FROM my_table WHERE (my_table.x BETWEEN 100 AND 1000) AND my_function(my_table.x);`

该命令`EXPLAIN ANALYSE`显示第二个查询确实比第一个查询快。

如何更改查询执行计划以自动执行查询重写（q into q'）的过程？我在哪里可以适当地存储有关区间 [100,1000] 的元数据`my_function`？

预先感谢，

托马斯·吉罗

我需要的帮助将帮助一个关于将模糊逻辑集成到 PostgreSQL 中的项目：[https://github.com/postgresqlf/PostgreSQL_f/][PostgreSQLf]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:39:33.037

捕捉它的最快方法是*在函数体顶部*这样的东西：

```
IF $1 BETWEEN 100 AND 1000 THEN
   -- proceed
ELSE
   RETURN NULL; -- Or what ever you want to return in this case
END IF; 
```

这应该*非常*快。

* * *

实际*查询重写*是使用PostgreSQL 中的[**`RULE`系统完成的。**](http://www.postgresql.org/docs/current/interactive/rules.html)但是规则适用于表和视图，而不是函数。您可以将查询包装在视图中 - 但随后您可以显式添加附加条件，这样更便宜。

```
CREATE VIEW v_tbl_only_valid_x AS 
    SELECT *
    FROM   tbl
    WHERE  x BETWEEN 100 AND 1000; 
```

称呼：

```
SELECT * FROM v_tbl_only_valid_x WHERE my_function(x); 
```

通过这种方式，查询计划器可以显式地获取有关列上查询的选择性的信息`x`，这可能会导致不同的查询计划。

`WHERE`但是在查询中添加第二个条件不是更简单`q'`吗？

# c# - 使用 FluentNHibernate 的每类继承表 - 身份生成

> ID：10737531
> 
> 赞同：2
> 
> 时间：2012-05-24T12:29:43.140
> 
> 标签：c#, fluent-nhibernate

我有一组来自不同来源的支付对象，我想在 NHibernate 中使用 TPC 继承。所有这些对象的基础是支付处理器（所以都具有一致的格式），但是在数据库中没有基类的表示。我想我的映射已经解决了，除了我在尝试插入时抛出异常 - “不能使用 <union-subclass> 映射的身份列键生成：<EntityName>”

课程：

```
public class BasePayment
{
    public virtual int Id { get; set; }
    public virtual PaymentSource Source { get; set; }
    public virtual DateTime Date { get; set; }
    public virtual decimal Amount { get; set; }
}

public class SubPayment : BasePayment
{
} 
```

映射：

```
public class BasePaymentMap : ClassMap<BasePayment>
{
    public BasePaymentMap()
    {
        UseUnionSubclassForInheritanceMapping();
        DiscriminateSubClassesOnColumn("Source");
        Id(m => m.Id);
        Map(m => m.Source);
        Map(m => m.Amount);
        Map(m => m.Date);
    }
}

public class SubPaymentMap : SubclassMap<SubPayment>
{
    public SubPaymentMap()
    {
        DiscriminatorValue(PaymentSource.SourceX);
        Abstract();
        Table("SourceXPayments");
    }
} 
```

这就是我所知道的。在 SaveOrUpdate 上，我收到上述错误，到目前为止，谷歌搜索并没有帮助 - 我发现了这个问题：[Cannot use identity column key generation with <union-subclass> ( TABLE_PER_CLASS )](https://stackoverflow.com/questions/916169/cannot-use-identity-column-key-generation-with-union-subclass-table-per-clas)这似乎涵盖了这个问题在 Java/Hibernate 中，但是我在将其转换`@GeneratedValue(strategy = GenerationType.TABLE)`为 Fluent 语法时遇到了问题，因为 Fluent NHibernate 的`GeneratedBy()`方法似乎没有表格，或者很多文档（我已经找到）关于它的作用封面。

做一些更多的阅读似乎这可能是不可能的，所以如果有人可以确认这一点或提供解决这种情况的方法，我们将不胜感激。

如果我没有提供足够的细节，请让我知道还有什么用处。

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T06:24:57.650

```
UseUnionSubclassForInheritanceMapping();
DiscriminateSubClassesOnColumn("Source"); 
```

是冲突的，FNH 将忽略一个。

`UseUnionSubclassForInheritanceMapping`表示每个类都有自己的包含所有列的表，并且该表用于区分类，不需要列

`DiscriminateSubClassesOnColumn`意味着继承层次结构的每个类都存在于同一个表中，并且使用一列来区分这些类。

错误消息意味着当使用`UseUnionSubclassForInheritanceMapping`身份生成时不允许使用，因为 id 仅对一个表是唯一的，但 NHibernate 威胁所有子类作为一个集合，其中 id 必须是唯一的。

eg`session.Get<BaseClass>(5);`将不再可靠地工作，因为可能有多个具有相同 ID 的子类。

`@GeneratedValue(strategy = GenerationType.TABLE)`只是告诉“使用身份以外的其他策略”。GeneratedBy.HiLow(); 将是一个很好的替代身份。

# regex - NetBeans 7（正则表达式）：查找只有一个参数的函数

> ID：10737534
> 
> 赞同：0
> 
> 时间：2012-05-24T12:29:45.437
> 
> 标签：regex, netbeans

```
function test('argument one', 'argument two') {}

function test('argument one') {} 
```

我想找到所有包含只有**一个参数的****函数测试**的文件。

 **有谁能够帮我？请！任何帮助表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:32:37.363

这在这里有效

```
 function test\([^,]*\) 
```

我强烈推荐实际搜索和替换

[http://www.divlocsoft.com/#find%20and%20replace](http://www.divlocsoft.com/#find%20and%20replace)

（或 PowerGrep，如果您需要执行更多操作）**

# c# - 使用来自两个数据库的自动增量 ID 连接来自两个表的数据

> ID：10737538
> 
> 赞同：2
> 
> 时间：2012-05-24T12:29:57.057
> 
> 标签：c#, asp.net, mysql, sql, tsql

我想连接来自两个数据库的表中的数据。一个用预定义的值（itemId、itemName）归档，另一个由用户填写（itemId、itemName、userId）。属性 itemId 和 itemName 相同，从第一个表我们选择所有数据，从第二个我们通过 userId 选择数据并将这两个结果结合起来。

应该区分加入的数据，因为 id 是自动增量的，并且可能相同（加倍）。我们想用这些数据填充下拉列表，例如使用数据源和字典（int 是 itemId，字符串是 itemName），我们只能在 dropDownList 中有 valueFiled 和 valueText，但是这两个表的 id 可能是相同的，我们不要从 wich 表中知道是由 id 选择的项目。

有没有什么优雅的方法来连接这个，也许是我们总是在用户登录时将这两个表加入临时表等的临时表......

谢谢您的回答

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:46:52.877

我想你正在寻找一个工会。使用文字值来标识源。

```
select 'predefined' as source, itemid, itemname
  from predefined_values_table
union all
select 'user', itemid, itemname
  from user_supplied_values_table
  where userid = ?; 
```

如果您只能容纳两列，则可以使用类似的东西。但是您必须撤消字符串连接才能获得 id 号。

```
select 'p:' || itemid, itemname
  from predefined_values_table
union all
select 'u:' || itemid, itemname
  from user_supplied_values_table
  where userid = ?; 
```

# sencha-touch - Sencha Touch 2.0 面板中的数据视图

> ID：10737542
> 
> 赞同：2
> 
> 时间：2012-05-24T12:30:13.783
> 
> 标签：sencha-touch, touch, extjs, sencha-touch-2

我有一个问题我一直在努力解决很长一段时间，所以希望有人可以在这里帮助我。

假设你有这个 DataView 对象：

```
Ext.define('Score.view.GameInfoPanel', {
    extend: 'Ext.DataView',

    config: {       
        store: {
            fields: ['Name', 'Score'],
            data: [
                {Name: 'test', Score: '1'},
                {Name: 'test2', Score: '100'}
            ]
        },
        itemTpl: '{Name} - {Score}',
        fullscreen: false
    }
}); 
```

我想我可以像这样在不同的面板上使用这个 DataView 的一个实例：

```
var gameInfo = Ext.create('Score.view.GameInfoPanel',  {
    xtype: 'gameInfo',
    scrollable: false,
    fullscreen: false,
    height: 100,
    flex: 2,
});

Ext.define('Score.view.PlayerView', {
    extend: 'Ext.Panel',
    xtype: 'playerview',

    requires: [
        'Score.view.GameInfoPanel'
    ],

    config: {
        title: 'Player Info',
        iconCls: 'user',

        layout: 'vbox',
        scrollable: true,

        items: [
            {
                docked: 'top',
                xtype: 'toolbar',
                id: 'toolbarId',
                title: 'Player Info',
            },
            {
                xtype: 'panel',
                html: 'before',
                flex: 1
            },
            gameInfo,
            {
                xtype: 'panel',
                html: 'after',
                flex: 3
            }
        ]
    }
}); 
```

何时在 Safari 中显示此面板我看到 DataView 在页面/面板中，但它是隐藏的。问题可能是为此 DataView 实例设置了 x-item-hidden。在为此挣扎了几个小时后，我不知道为什么会这样以及如何解决这个问题。我能找到的唯一建议是我应该设置 DataView 的高度并使其不可滚动。所有这些似乎都不起作用。因此，任何反馈将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T21:30:27.937

花了一段时间，但我终于解决了。初始代码存在一些问题。

在 GameInfoPanel 的定义中，不应使用配置属性“全屏”。我不确定为什么。但据我了解，使用此视图的视图已经设置了此属性。通过再次设置，即使设置为false，它也会隐藏视图。

此外，应该设置“xtype”属性。在这种情况下，我将其设置为“gameinfo”。这是因为您可以在 PlayerView 中配置此视图。此外，通过设置“id”，您可以在控制器中引用此 GameInfoPanel 实例。所以 PlayerView 最后看起来是这样的：

```
Ext.define('Score.view.PlayerView', {
  extend: 'Ext.Panel',
  xtype: 'playerview',

  requires: [
      'Score.view.PlayerInfoPanel',
      'Score.view.GameInfoPanel'
  ],

  config: {
      title: 'Player Info',
      iconCls: 'user',
      layout: 'vbox',
      scrollable: true,

      items: [
          {
              docked: 'top',
              xtype: 'toolbar',
              id: 'toolbarId',
              title: 'Player Info'
          },
          {
              xtype: 'playerinfo',
              id: 'currentPlayerInfoId',
              flex: 1,
              scrollable: false
          },
          {
              xtype: 'gameinfo',
              id: 'currentGameInfoId',
              flex: 2,
              scrollable: false
          }
       ]
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T15:06:04.627

[http://www.senchafiddle.com/#2Ig9U](http://www.senchafiddle.com/#2Ig9U)

该示例代码工作得很好。

“我想我可以像这样在不同的面板上使用这个 DataView 的一个实例：”

这可能是一个线索。上次我尝试在 extjs 项目中创建和引用 -same- 对象时遇到了类似的情况。您应该做的是使用别名，并通过小部件实例化它。

或多或少：

```
 Ext.define('Score.view.GameInfoPanel', {
        extend: 'Ext.DataView',
        alias:'widget.scoreViewGameInfoPanel', //widgets use lazy loading
        config: {       
            store: {
                fields: ['Name', 'Score'],
                data: [
                    {Name: 'test', Score: '1'},
                    {Name: 'test2', Score: '100'}
                ]
            },
            itemTpl: '{Name} - {Score}',
            fullscreen: false
        }
    });

    Ext.define('Score.view.PlayerView', {
        extend: 'Ext.Panel',
        xtype: 'playerview',

        requires: [
            'Score.view.GameInfoPanel'
        ],

        config: {
            title: 'Player Info',
            iconCls: 'user',

            layout: 'vbox',
            scrollable: true,

            items: [
                {
                    docked: 'top',
                    xtype: 'toolbar',
                    id: 'toolbarId',
                    title: 'Player Info',
                },
                {
                    xtype: 'panel',
                    html: 'before',
                    flex: 1
                },
                Ext.widget('scoreViewGameInfoPanel',{ 

//coz sencha hated the 
//same object in 2 places last i looked

                    scrollable: false,
                    fullscreen: false,
                    height: 100,
                    flex: 2
                }),
                {
                    xtype: 'panel',
                    html: 'after',
                    flex: 3
                }
            ]
        }
    }); 
```

如果您确实需要在 2 个地方使用 -same- 面板进行选择和填充，那么我不太确定。

# javascript - 如何从 (new Date()).zeroTime() 获取 7 天前的日期？

> ID：10737545
> 
> 赞同：0
> 
> 时间：2012-05-24T12:30:30.843
> 
> 标签：javascript, date

我正在使用 (new Date()).zeroTime() 来获取当前日期，我怎样才能得到 7 天前的日期。例如，如果今天是 2012 年 5 月 24 日，我怎么能得到 2012 年 5 月 17 日

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T12:31:58.983

在 C# 中，您可以使用`DateTime.AddDays`和使用`-7`作为您的参数。

[在这里](http://msdn.microsoft.com/en-us/library/system.datetime.adddays.aspx)阅读更多

在 JavaScript 中是：

```
myDate.setDate(myDate.getDate() - 7); 
```

# python - Django：通过通用关系过滤order_

> ID：10737546
> 
> 赞同：0
> 
> 时间：2012-05-24T12:30:31.137
> 
> 标签：python, django, postgresql

我有两节课：

```
class Translation(models.Model):
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    object = generic.GenericForeignKey('content_type', 'object_id')
    field = models.CharField(max_length=64) #field from the translated model
    language = models.CharField(max_length=8, choices=settings.LANGUAGES, verbose_name=_("language"))
    text = models.TextField() #translation

class Category(models.Model):
    translations = generic.GenericRelation(Translation)
    name = models.CharField(max_length=128, verbose_name=_("Name"))
    slug = models.SlugField(blank=True, default="", verbose_name=_("Slug")) 
```

有没有办法通过按当前语言过滤 order_by 的 translation__text 来排序类别？如果我使用

```
Category.objects.all().order_by("translations__text") 
```

我得到按所有翻译排序的类别，而不仅仅是当前语言。我想，我需要以某种方式过滤 order_by 集（仅使用给定语言的翻译）？有没有办法这样做？

数据库 = PostgreSQL

感谢帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:42:29.187

重复是不可避免的。这是 Django 为泛型关系上的 order by 子句生成的 SQL 的结果。见票：[https](https://code.djangoproject.com/ticket/11387) ://code.djangoproject.com/ticket/11387 。

连trunk都没有解决，而且票是3年了，14个月没修改过，所以我不会屏住呼吸。

更新 *** 根据引用的错误报告[https://code.djangoproject.com/ticket/11387](https://code.djangoproject.com/ticket/11387) ，引用的错误已在 2013 年初修复。从我最初的测试来看，在这篇文章中的推荐答案上调用 distinct() 似乎会返回正确的查询集。

```
Category.objects.filter(translations__language='English').order_by('translations__text').distinct() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:44:57.673

你是这个意思吗？

```
Category.objects.filter(translations__language="English").order_by("translations__text") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T12:46:29.210

尝试这个：

```
Category.objects.filter(translations__language='en').order_by("translations__text") 
```

# c# - 流利的休眠抑制加载参考

> ID：10737553
> 
> 赞同：0
> 
> 时间：2012-05-24T12:31:00.563
> 
> 标签：c#, wcf, nhibernate, poco, lazy-loading

我正在使用流利的 nhibernate 加载 POCO 类。我正在使用 ClassMap 衍生物来指定映射。我正在使用这样的配置：

```
.Mappings(m => m.FluentMappings
  .AddFromAssemblyOf<MyClass>()
  .Conventions.Add(FluentNHibernate.Conventions.Helpers.DefaultLazy.Never())
  /** I am using Never() because I have poco classes, not virtual properties **/
) 
```

我希望发出一个查询，该查询将加载具有特定父 id 的所有子实体，而不会填充父实体 - 父实体*很大*。

**查询**

如何使用标准或其他映射或提示发出此查询，但不加载父对象。*我想更好地控制加载的内容*。它不必是 linq 提供程序。

```
var results = _session.Query<Child>().Where(_ => _.Parent.Id == ?).ToList(); 
```

**父母**

```
public ParentMap()
{
  Table("Parent");
  Id(x => x.Id).Column("ParentId");
  HasMany(x => x.Children)
    .Table("Children")
    .KeyColumn("ChildId").Inverse()
} 
```

**孩子**

```
public ChildMap()
{
  Table("Child");
  Id(_ => _.Id).Column("ChildId");
  References(_ => _.Parent).Column("PartyId").LazyLoad(Laziness.NoProxy);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:28:16.657

您可以只查询子实体：

```
var query = _session.QueryOver<Child>()
   .Where(x=>x.Parent.Id==id)
   .List(); 
```

或者进行更好的控制 - 使用投影和 AliasToBean() 转换器。就像是：

```
ChildDTO dto = null;
var query = _session.QueryOver<Child>()
.Where(x=>x.Parent.Id==id)
.SelectList(list=>list
   .Select(x=>x.SomeProperty).WithAlias(()=>dto.SomeProperty)
   .Select(x=>x.SomeOtherProperty).WithAlias(()=>dto.SomeOtherProperty))
.TransformUsing(Transformers.AliasToBean<ChildDTO>())
.List<ChildDTO>(); 
```

或者

```
ChildDTO dto = null;
Child childAlias = null;
var query = _session.QueryOver<Parent>()
.JoinAlias(x=>x.Children, ()=>childAlias, JoinType.InnerJoin)
.Where(x=>x.Id==id)
.SelectList(list=>list
   .Select(x=>childAlias.SomeProperty).WithAlias(()=>dto.SomeProperty)
   .Select(x=>childAlias.SomeOtherProperty).WithAlias(()=>dto.SomeOtherProperty))
.TransformUsing(Transformers.AliasToBean<ChildDTO>())
.List<ChildDTO>(); 
```

# java - 基于命令行的 HTTP POST 从富含 javascript 的网页中检索数据

> ID：10737555
> 
> 赞同：1
> 
> 时间：2012-05-24T12:31:11.160
> 
> 标签：java, javascript, linux, command-line, http-post

我不确定这是否可行，但我想从使用 Javascript 呈现数据的网页中检索一些数据。这将来自 linux shell。

我现在能做的：

1.  http post 使用 curl/lynx/wget 登录并从命令行获取标题

2.  使用标题进入命令行网页中的“安全”位置

但是，页面上呈现的唯一元素是静态 html。我需要的大部分信息都是用 js 动态呈现的（尽管最终也是 html），并且不会显示在命令行浏览器上。我知道问题在于缺少 js 解释器。

因此......我认为可能的一些解决方法是：

1.  从命令行调用完整的浏览器并以某种方式将信息传递回标准输出。这意味着我必须能够发布。

2.  将我从 curl 获得的标头（带有会话信息等）传递到这些完整浏览器之一，然后再次将输出 html 转储回标准输出。如果一切都失败了，它可能是窗口上的打印屏幕功能。

3.  纯Java解决方案也可以。

有人有做过类似的事情并取得成功的经验吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:44:56.807

你可以使用[WebDriver](http://seleniumhq.org/docs/03_webdriver.html)来做，只是你需要安装网络浏览器。还有其他解决方案，例如[Selenium](http://seleniumhq.org/)和[HtmlUnit](http://htmlunit.sourceforge.net/)（没有浏览器，但可能表现不同）。

[你可以在这里](https://github.com/paukiatwee/selenium-boostrap)找到 Selenium 项目的例子。

**网络驱动程序**

> WebDriver 是一个用于编写网站自动化测试的工具。它旨在模仿真实用户的行为，并因此与应用程序的 HTML 进行交互。

**硒**

> Selenium 使浏览器自动化。就是这样。你用这种力量做什么完全取决于你。主要是为了测试目的而自动化 Web 应用程序，但当然不仅限于此。无聊的基于 Web 的管理任务也可以（而且应该！）自动化。

**html单元**

> HtmlUnit 是“Java 程序的无 GUI 浏览器”。它对 HTML 文档进行建模并提供一个 API，允许您调用页面、填写表单、单击链接等……就像您在“普通”浏览器中所做的一样。

我建议使用`WebDriver`，因为它不需要像 .这样的独立服务器`Selenium`，而`HtmlUnit`如果您不想在无头环境中安装浏览器而不担心[Xvfb ，则可能适合。](http://en.wikipedia.org/wiki/Xvfb)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:55:59.247

You might want to see what [Selenium](http://seleniumhq.org) can do for you. It has numerous language drivers (Java included) that can be used to interact with the browser to process content typically for testing and verification purposes. I'm not exactly sure how you can get exactly what you are looking for out of it but wanted to make you aware of its existence and potential.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T12:37:14.977

除非你设置一个 websocket，否则这是不可能的，即使这样，我想这真的取决于。你能详细说明你的目标吗？出于我个人的好奇心:-)

# javascript - Javascript运行时间计算器

> ID：10737556
> 
> 赞同：0
> 
> 时间：2012-05-24T12:31:14.183
> 
> 标签：javascript, datetime

我正在寻找一个纯javascript，它计算友好视图的日期。

例如。05-24-2012 3:10

--> 20 分钟前

我有一个 php 脚本，我正在寻找 javascript 版本。

```
<?php
$time = strtotime($_GET["d"]);
echo humanTiming($time);
function humanTiming($time)
{
 $time=time()-$time;
 $tokens=array(31536000=>'year',2592000=>'month',604800=>'week',86400=>'day',3600=>'hour',60=>'minute',1=>'second');
 foreach($tokens as $unit=>$text){if($time<$unit) continue;$numberOfUnits = floor($time / $unit);return $numberOfUnits.' '.$text.(($numberOfUnits>1)?'s':'');}
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:34:19.763

*   [JavaScript 相对时间助手](https://github.com/jherdman/javascript-relative-time-helpers)
*   [JavaScript 使相对时间与缓存兼容](http://37signals.com/svn/posts/1557-javascript-makes-relative-times-compatible-with-caching)
*   [JavaScript 中的相对时间](http://derekmd.com/2010/01/relative-time-in-javascript/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:36:22.857

您发布的内容的 javascript 实现也可以[在此处获得，](http://psoug.org/snippet/Javascript-Calculate-time-difference-between-two-dates_116.htm) [这](http://www.codingforums.com/showthread.php?t=196685)
也可能对您有用

# sql-server-2008 - 在两个 SQL Server 数据库之间迁移数据的脚本

> ID：10737557
> 
> 赞同：4
> 
> 时间：2012-05-24T12:31:19.123
> 
> 标签：sql-server-2008, data-migration

我有两个 SQL Server 数据库，我需要编写一个脚本来将数据从数据库 A 迁移到数据库 B。两个数据库具有相同的架构。

我必须遍历表格，并且对于每个表格，我必须遵循这些规则：

1.  如果我要迁移的项目在目标表中不存在（例如，比较是在列上进行的`Name`），那么我直接插入它。
2.  如果我要迁移的项目存在于目标表中，那么我只需要更新某些列（例如，只更新`Age`而不`Address`触及其他列）

谁能帮我写那个脚本？任何例子都足够了。非常感谢

**编辑：**

我只需要一张桌子的例子。不用循环，我可以单独处理每个表（因为每个表都有自己的比较列和更新列）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T12:36:04.037

MERGE 语句看起来可以在这里为您提供帮助。一个例子：

```
MERGE StudentTotalMarks AS stm
USING (SELECT StudentID,StudentName FROM StudentDetails) AS sd
ON stm.StudentID = sd.StudentID
WHEN MATCHED AND stm.StudentMarks > 250 THEN DELETE
WHEN MATCHED THEN UPDATE SET stm.StudentMarks = stm.StudentMarks + 25
WHEN NOT MATCHED THEN
INSERT(StudentID,StudentMarks)
VALUES(sd.StudentID,25); 
```

合并语句自 SQL Server 2008 起可用，所以你很幸运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:39:50.437

与其创建脚本，不如将源表以不同的名称复制到目标服务器中（需要进行更新）。

然后只需在名称不存在的地方进行简单的插入即可。

这里仅是第 1 步的 SQL。

```
INSERT INTO [TableA]
SELECT Name,
       XX,
       XXXX
FROM   TableB
WHERE  NOT NAME IN(SELECT NAME
                   FROM   TableA) 
```

# mysql - 如果条件满足则跳出 IF 语句

> ID：10737558
> 
> 赞同：0
> 
> 时间：2012-05-24T12:31:22.337
> 
> 标签：mysql, stored-procedures, if-statement

我将如何在满足时结束 if 语句，然后在存储过程中执行 else if 否则？

我尝试在 if 语句之后结束 if：

```
IF EXISTS (SELECT * FROM `db`.`tbl` WHERE email = "email@domain.com") END IF;
ELSE INSERT INTO `db`.`tbl` (email) VALUES ("email@domain.com"); END IF; 
```

但这没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:39:10.510

为什么不使用忽略插入？

```
INSERT IGNORE INTO  `db`.`tbl` SET `email`= 'email@domain.com'; 
```

您必须在电子邮件上创建唯一索引。

检查[here](http://bogdan.org.ua/2007/10/18/mysql-insert-if-not-exists-syntax.html)以获得一些参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:35:30.820

如果这是在行不存在的情况下插入，你应该使用这个：

```
INSERT INTO `table` (value1, value2) 
SELECT 'stuff for value1', 'stuff for value2' FROM `table` 
WHERE NOT EXISTS (
    SELECT * FROM `table` 
    WHERE value1='stuff for value1' AND value2='stuff for value2'
); 
```

# php - 如何组合两个 SimpleXML 元素数组？

> ID：10737568
> 
> 赞同：0
> 
> 时间：2012-05-24T12:32:05.340
> 
> 标签：php, xml, soap

第一个数组是位置，第二个是汽车及其相关价格。我怎样才能像下面的示例一样组合它们？

```
Array
(
    [0] => SimpleXMLElement Object
        (
            [companyLocationInfo] => Array
                (
                    [0] => SimpleXMLElement Object
                        (
                            [companyName] => AVIS
                            [name] => NYCC07
                            [line1] => 420 EAST 90TH STREET
                        )
                    [2] => SimpleXMLElement Object
                        (
                            [companyName] => AVIS
                            [name] => NYCC06
                            [line1] => 310 EAST 64TH STREET
                        )
                    [3] => SimpleXMLElement Object
                        (
                            [companyName] => AVIS
                            [name] => NYCC01
                            [line1] => 68 EAST 11TH STREET
                        )

                )

            [rates] => Array
                (
                    [0] => SimpleXMLElement Object
                        (
                            [companyName] => AVIS
                            [name] => NYCC07
                            [vehicleRentalPrefType] => CCAR
                            [rateAmount] => 83.99
                            [rateCurrency] => USD
                        )
                    [2] => SimpleXMLElement Object
                        (
                            [companyName] => AVIS
                            [name] => NYCC06
                            [vehicleRentalPrefType] => CCAR
                            [rateAmount] => 110.54
                            [rateCurrency] => USD
                        )
                    [3] => SimpleXMLElement Object
                        (
                            [companyName] => AVIS
                            [name] => NYCC01
                            [vehicleRentalPrefType] => CCAR
                            [rateAmount] => 210.65
                            [rateCurrency] => USD
                        )

                )

        )

) 
```

我想像这样组合它们：

```
AVIS 420 EAST 90TH STREET
CCAR 83.99 USD

AVIS 310 EAST 64TH STREET
CCAR 110.54 USD

AVIS 68 EAST 11TH STREET
CCAR 210.65 USD 
```

用 PHP 我怎么能像这样组合它？

* * *

我刚刚得到了关于我的问题的答案，但我无法让它正常工作，我想组合到数组中，第一个是位置，第二个是汽车，但在第二个中还有另一个数组，我必须将值与第一个数组匹配，

下面是一个例子，

```
Array
(
    [0] => SimpleXMLElement Object
        (
            [companyLocationInfo] => Array
                (
                    [0] => SimpleXMLElement Object
                        (
                            [companyName] => AVIS
                            [name] => NYCC07
                            [line1] => 420 EAST 90TH STREET
                        )
                    [2] => SimpleXMLElement Object
                        (
                            [companyName] => AVIS
                            [name] => NYCC06
                            [line1] => 310 EAST 64TH STREET
                        )
                    [3] => SimpleXMLElement Object
                        (
                            [companyName] => AVIS
                            [name] => NYCC01
                            [line1] => 68 EAST 11TH STREET
                        )

                )

            [rates] => Array
                (
                    [0] => SimpleXMLElement Object
                        (
                            [pickupDropoffLocations] => Array
                                (
                                    [0] => SimpleXMLElement Object
                                        (
                                            [companyName] => AVIS
                                            [name] => NYCC07
                                        )
                                )
                            [vehicleRentalPrefType] => CCAR
                            [rateAmount] => 83.99
                            [rateCurrency] => USD
                        )
                    [2] => SimpleXMLElement Object
                        (
                            [pickupDropoffLocations] => Array
                                (
                                    [0] => SimpleXMLElement Object
                                        (
                                            [companyName] => AVIS
                                            [name] => NYCC06
                                        )
                                )
                            [vehicleRentalPrefType] => CCAR
                            [rateAmount] => 110.54
                            [rateCurrency] => USD
                        )
                    [3] => SimpleXMLElement Object
                        (
                            [pickupDropoffLocations] => Array
                                (
                                    [0] => SimpleXMLElement Object
                                        (
                                            [companyName] => AVIS
                                            [name] => NYCC01
                                        )
                                )
                            [vehicleRentalPrefType] => CCAR
                            [rateAmount] => 210.65
                            [rateCurrency] => USD
                        )

                )

        )

) 
```

这是我正在使用的代码，但不起作用，

```
$results_array = array();

foreach($result[0]->rates as $rate) {
    foreach($result[0]->companyLocationInfo as $info) {
        if($info->name == $rate->pickupDropoffLocations[0]->name) {
            $results_array[] = array(
                'line1' => $info->line1,
                'name' => $info->locationDetails->name,
                'companyName' => $info->companyName,
                'vehicleRentalPrefType' => $rate->vehicleRentalPrefType
            );
        }
    }
}
print_r($results_array); 
```

我希望它看起来像：

```
AVIS 420 EAST 90TH STREET
CCAR 83.99 USD

AVIS 310 EAST 64TH STREET
CCAR 110.54 USD

AVIS 68 EAST 11TH STREET
CCAR 210.65 USD 
```

有人可以告诉该代码的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:39:04.723

结合..这样的东西，也许？

```
$results = array();

foreach($array[0]->companyLocationInfo as $info) {
    foreach($array[0]->rates as $rate) {
        if($info->name == $rate->name) {
            $results[] = array(
                'line1' => $info->line1,
                'name' => $info->name,
                'companyName' => $info->companyName,
                'vehicleRentalPrefType' => $rate->vehicleRentalPrefType
            );
        }
    }
} 
```

然后为你循环`$results`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:54:11.017

尝试将数组对象（http://php.net/arrayobject）插入它:)

# asp.net-mvc-3 - 在 mvc 中提取记录时在视图中设置下拉列表值

> ID：10737578
> 
> 赞同：-1
> 
> 时间：2012-05-24T12:32:37.367
> 
> 标签：asp.net-mvc-3

使用 MVC 3。

我有一个下拉列表，其中填充性别，文本“男性”的值为“M”，文本“女性”的值为“F”。

现在，当我提取记录时，它没有根据记录的值设置值。

我有以下代码。

```
@if(Model != null)
{
    @Html.DropDownListFor(model => model.GENDER, 
        new SelectList(ViewBag.gender, "Value", "key", Model.GENDER))
}
else
{
    @Html.DropDownListFor(model => model.GENDER, 
        new SelectList(ViewBag.gender, "Value", "Key"))
} 
```

上面的代码意味着当页面第一次加载时它没有性别字段的值，因为模型是空的，所以只需填充列表，当提取人员时，即当模型不为空时，它填充并设置值等于`model.gender`。但它没有设置值。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:20:03.693

您是否将 NULL 对象（您的模型）传递给您的视图？你要在视图中写多少地方`@if(Model != null).. .`这不会弄乱干净代码的概念。?

我想这就是你应该这样做的方式。无论是第一次（创建实体）还是编辑时间，您都应该始终将模型/视图模型传递给视图。像这样的东西

```
public ActionResult Create()
{
   CustomerViewModel model=new CustomerViewModel();
   return View(model);
} 
```

对于 Edit 操作，您将填充了数据的 Model/ViewModel 对象。

```
public ActionResult Edit(int id)
{
   CustomerViewModel model=new CustomerViewModel();
   model=CustomerService.GetCustomerFromId(id);
   return View(model);
} 
```

在视图中，你像这样使用它

```
@model CustomerViewModel

@Html.DropDownListFor(model => model.GENDER, 
        new SelectList(ViewBag.gender, "Value", "key", Model.GENDER)) 
```

# objective-c - 有一种简单的方法可以在目标 c 中应用最短路径算法吗？

> ID：10737580
> 
> 赞同：3
> 
> 时间：2012-05-24T12:32:41.867
> 
> 标签：objective-c, xcode, dijkstra

我有一系列由路径链接的点（x，y）。在目标 c 中有一种简单的方法可以应用诸如 Dijkstra 最短路径算法之类的方法，以便知道其中两个变量点之间的最短路径？真正的问题是我有一张图像，上面有一系列位置以及所有这些位置的坐标。现在我需要用户选择其中的两个位置并获得所选位置之间的最短路径。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T14:29:47.303

我找到了一种方法来做到这一点。这里有一个完美的算法实现。希望它可以帮助某人。

[https://github.com/snyderp/PESGraph](https://github.com/snyderp/PESGraph)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T16:21:52.227

你也许可以在网上找到一个C或C++的算法，然后操作它来输入你的列表类型，并输出最短路径点列表，这样你就不必实现实际的算法，只需操作一组已经存在的代码.

# java - 位图大小超出Vm预算错误android

> ID：10737582
> 
> 赞同：6
> 
> 时间：2012-05-24T12:32:51.483
> 
> 标签：java, android, bitmap, out-of-memory

当我更改为横向模式时，很少使用全屏位图创建对象。

当我滚动调用另一个对象并显示其位图时，当我重复执行此操作时，位图大小超出`vm`预算错误，我已经完成了所有的事情，例如`recycle()`，设置 null 然后调用`GC()`，我仍然有同样的错误。创建位图....

```
 bitmap = Bitmap.createBitmap(ChartProperties.getChartWidth(), 
                    ChartProperties.getChartHeight(),
    Bitmap.Config.RGB_565);

    imageCache.put(String.valueOf(LandscapeChartActivity.getActiveFeature()),
                    new SoftReference(bitmap));

    if(imageCache != null){

        for (int i = 0; i < imageCache.size(); i++) {

            if (imageCache.get(String.valueOf(i)) != null) {
                imageCache.get(String.valueOf(i)).get().recycle();
                imageCache.put(String.valueOf(i), null);                    
            }

        }
        Runtime.getRuntime().gc();
        imageCache.clear();
        imageCache = null; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T13:07:26.507

由于位图，我也遇到了同样的问题 OOME。

当方向从 PORTRAIT 变为 LANDSCAPE 或反之时，之前的 UI 将被完全丢弃，并加载并显示新的 UI，在这种情况下，如果您的应用程序中使用了许多位图，则需要在适当的位置释放它们。

要检查设备的方向，请参阅：[检查 Android 手机上的方向](https://stackoverflow.com/questions/2795833/check-orientation-on-android-phone)

在您的情况下，您需要在方向更改期间清除位图。

在上面的链接中，您可以找到如何获取当前方向。因此，在每次方向更改时，调用上面的代码来清理位图。

现在，当我们检查 logcat 时，总是出现一个日志说 GC_，但我无法理解，所以我找到了一个关于内存泄漏问题的惊人文档：http: [//codelog.dexetra.com/getting-around-安卓内存蓝调](http://codelog.dexetra.com/getting-around-android-memory-blues)

上面的链接对您的问题非常有用。

现在，当您的应用程序中存在内存泄漏时，就会发生 OOME。因此，要检查这一点，请安装 MAT for eclipse。您可以在以下位置找到它：http: [//www.eclipse.org/mat/downloads.php](http://www.eclipse.org/mat/downloads.php)

它是一个有点复杂的软件，但是当您使用它时，您会明白，它是非常有用的软件。

即使这不能解决您的问题，也请使用`WeakReference`位图。

请参考此链接：[如何在 Java 和 Android 开发中使用 Wea​​kReference？](https://stackoverflow.com/questions/3243215/how-to-use-weakreference-in-java-and-android-development)

如果我知道更多信息，我会更新这篇文章。

如果您得到解决问题的方法，请更新您的帖子。

谢谢 ：）

# jboss - 队列名称未声明，但它存在于 JBoss JMS MQ 中 - 如何？

> ID：10737583
> 
> 赞同：1
> 
> 时间：2012-05-24T12:33:01.303
> 
> 标签：jboss, queue, jms, mq

我在 JBoss JMS MQ - jbossmq-destinations-service.xml 中只声明了一个名为 MyQueue1 的队列，但是当我通过 JBoss JMX 控制台查看队列列表时。我看到那里有5个队列。

其他队列是如何创建的？有人告诉我，当我们尝试写入不存在的队列时，队列会自动创建 - 这可能吗？不过，我无法在我的桌面上复制这种行为。

我正在使用 JBoss 4.0.x 请指教...谢谢。

# ios - tableview 内存管理 - 单例类

> ID：10737591
> 
> 赞同：0
> 
> 时间：2012-05-24T12:33:28.627
> 
> 标签：ios, networking, singleton, paging, tableview

我是ios编程的新手，所以我有一个问题。我正在开发一个应用程序，将继续在互联网上加载数据，它是分页数据，所以当用户导航到下一页时，它将在互联网上加载页面的数据。我使用单例类来制作它，它工作正常，但我有一个问题 -

当第一页到达时，我将它保存到 self.posts 变量中，例如 - `self.posts = dataA`，当用户转到下一页时，它会将 self.posts 更改为 dataB，例如`self.posts = dataB`。我的问题是，数据A是否会由iOS自动发布，或者不是？如果不是，如何处理这些垃圾内存？你知道它会逐页加载数据，如果加载了这么多页面，那可能是个问题......谢谢。

抱歉忘了告诉你们，该应用程序适用于 iOS 3.x+，所以我猜 ARC 不可用。检查这个函数，它会在HTTP连接完成后被调用，并将JSON解析为NSDictionary，每次它会为一个页面加载大约5个帖子，下一页是另外5个帖子，所以你知道，self.posts改变了如果它是另一个新的 HTTP 网络。

```
- (void) getNextPostsFromJson:(NSData *)data
{
    NSError *theError = nil;

    NSDictionary *dict = [[CJSONDeserializer deserializer] deserializeAsDictionary:data error:&theError];

    if (dict == nil) {
        isValidJson = NO;
        httpStatus = HTTP_STATUS_FAILED;

        NSLog(@"json con - %@ %@",
              [theError localizedDescription],
              [[theError userInfo] objectForKey:NSURLErrorFailingURLStringErrorKey]);   
    } else {

        NSArray *keys = [dict allKeys];        

        if ([keys count] >= TOTAL_SECTIONS) {
            self.posts = dict;
        } else {
            self.posts = nil;
        }

        NSLog(@"posts = %@", self.posts);
        return;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:35:21.803

如果您使用 ARC（自动引用计数）并且任何其他指针（`_strong`）指向它，它将自动释放。所以不用担心:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:45:01.743

只要您除了设置属性之外没有手动保留 dataA ，您就不必担心。使用点表示法将导致设置为属性的对象被保留并在被其他对象替换后再次释放。

**编辑：**您添加的代码示例对我来说似乎很好......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T13:03:11.283

**烤面包机**的建议是正确的。

如果您使用如下属性。

```
@property (nonatomic, retain) NSDictionary* posts; 
```

当你这样做时

```
self.posts = dataB; 
```

旧值引用对象为您释放。

编译器 using 指令合成的 setter`@synthesize`如下所示（此处为伪代码）：

```
- (void)setPosts:(NSDictionary*)newPosts
{
    if(newDict != posts) {

        [newPosts retain]; // retain the new value
        [posts release]; // release the old value
        posts = newPosts; // now posts reference the new value
    }
} 
```

**给你一个简单的建议。**

如果你这样做`self.posts = dataB`你就输了`dataA`。所以当你回来时，你需要再次执行下载。那么，您如何看待下载数据的缓存？例如，创建一个`NSMutableDictionary`其中每个键是页面（页面编号或您喜欢的任何内容），每个值是数据（`dataA`等`dataB`）。通过它，您可以避免每次下载数据。也许您还可以为此缓存设置一个限制（例如 5 个数据）以防止内存问题。

希望能帮助到你。

# ios - Acapela TTS 引擎：XCode 中所有类的“未定义符号”

> ID：10737598
> 
> 赞同：0
> 
> 时间：2012-05-24T12:33:57.827
> 
> 标签：ios, xcode4, linker-errors, text-to-speech

我正在尝试开始使用适用于 iPhone 的 Acapela TTS 引擎。我正在使用 XCode 4，并且一直按照以下说明进行设置：

[http://www.acapela-for-iphone.com/documentation-quick-start-how-to-add-tts-in-your-app](http://www.acapela-for-iphone.com/documentation-quick-start-how-to-add-tts-in-your-app)

我已经添加了声音，并将所有必要的文件（来自`api`和`license`文件夹）添加到一个名为“TTS”的组中，将它们添加到我的项目的目标中，并以与教程相同的方式将它们导入到我的一个视图控制器中. 但是，当我构建时，我收到此消息：

```
Undefined symbols for architecture i386:
  "_OBJC_CLASS_$_AcapelaLicense", referenced from:
      objc-class-ref in NavigationViewController.o
  "_OBJC_CLASS_$_AcapelaSpeech", referenced from:
      objc-class-ref in NavigationViewController.o
      objc-class-ref in AcapelaSetup.o
  "_AcapelaVoiceName", referenced from:
      -[AcapelaSetup SetCurrentVoice:] in AcapelaSetup.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

找不到文件没有错误，当我 cmd+单击`#import`语句时，它会将我带到相关的源代码文件。那么 XCode 怎么会认为符号是未定义的呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:31:39.083

您是否将文件 libBabTTS.a 和 libMobilityStatic.a 包含到您的项目中？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:59:50.070

疯狂猜测：您可以在项目构建阶段检查标题的可见性。

# c# - 在 C# 中自定义编码 0-31 之间的 ascii 字符

> ID：10737600
> 
> 赞同：2
> 
> 时间：2012-05-24T12:34:08.153
> 
> 标签：c#, character-encoding

我从设备中读取了一些数据。然后我通过 xml 将此数据发送到 Web 服务器。数据应该用 xml 表示，所以这使我可以转换 0-31 之间的字符，因为这些字符不能显示在 xml 上。
问题是如何在字符串中转换 0-31 之间的字符，例如`[00]abcde[01]fgh[02]...`
.net 框架中是否有任何内置函数或任何可接受的模式？
谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T12:36:36.593

您应该使用标准 XML 编码：

```
&#12; 
```

您的 XML API 将为您完成这些，因此您无需担心任何事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T12:37:29.900

您可以简单地将数字编码为您编写的 XML 实体，`&#`后跟数字和分号

所以 1 变成`&#1;`13 变成`&#13;`依此类推

但是，正如[dan04](https://stackoverflow.com/users/287586/dan04)所指出的，您不能将 0 表示为数字字符引用，因此在您的数据可能包含 0 的情况下，您将不得不使用不同的编码。您可以将整个二进制数据编码为 base64

大多数 XML 工具箱都会为您对 NCR 进行编码，因此您真的不必担心这一点

# eclipse - Eclipse 不运行

> ID：10737604
> 
> 赞同：-1
> 
> 时间：2012-05-24T12:34:12.680
> 
> 标签：eclipse, java

当我运行 Eclipse 时，它​​会提示找不到 Java 虚拟机。我使用的操作系统是 Windows XP。Java 升级。是否可能是由于JDK安装错误造成的？我将它安装在 D 盘，而不是 C 盘。JDK 也是最新版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:16:36.007

打开 Eclipse 目录并在*eclipse.ini*文件中删除内存值

**前**

```
openFile
--launcher.XXMaxPermSize
256M
-showsplash
org.eclipse.platform 
```

**后**

```
openFile
--launcher.XXMaxPermSize
-showsplash
org.eclipse.platform 
```

现在 Eclipse 运行没有错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:37:31.663

在位于 eclipse 根目录的 eclipse.ini 文件中，放置下一个参数：

```
-vm
C:/Program Files/Java/jdk1.7.0_03/bin/javaw.exe 
```

使用您的 java 安装路径而不是`C:/Program Files/Java/jdk1.7.0_03`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-10-25T14:36:42.267

我遇到了同样的问题，所以我只是从我的 java 主文件夹（C:\program files\java....）中复制了 jre 子文件夹并将其粘贴到 eclipse 文件夹中（找到你的安装位置），eclipse 正在运行太好了....希望对您有所帮助。之后..

# c - xmlReaderForMemory 在第二次调用时崩溃

> ID：10737606
> 
> 赞同：0
> 
> 时间：2012-05-24T12:34:17.007
> 
> 标签：c, libxml2

在长时间使用谷歌之后，我仍然无法找到 xmlReaderForMemory 崩溃的原因/解决方案，但仍然具有有效参数。

我已经使用 libxml 创建了两个解析器函数，当我单独调用它们时它们工作正常。但是当我一个接一个调用它时，它在 xmlReaderForMemory 上崩溃，给出错误如下：

nayak.exe 中 0x7c918fea 的第一次机会异常：0xC0000005：访问冲突写入位置 0x00000010。nayak.exe 中 0x7c918fea 处未处理的异常：0xC0000005：访问冲突写入位置 0x00000010。

现在我给出两个函数的代码：

第一个功能：

```
 char* CB_omniParser(char *omnistring){

        char *parseResult,;
        const char *fileName = omnistring;   
        char *temp,*texttemp,*result=0; 
        int i,len=0,error;
        xmlTextReaderPtr reader;
        len= strlen(omnistring);
        if(len==0)
                    return 0;   
                reader = xmlReaderForMemory(fileName,len,"",NULL,0);    

        if(reader){

            temp = (char *) GlobalAlloc(GPTR, sizeof(char)*len);
            parseResult = (char *) GlobalAlloc(GPTR,sizeof(char)*len+1);
            while(error=xmlTextReaderRead(reader)) {
                if(error==-1){              
                    return 0; // on failure
                }           
                switch(xmlTextReaderNodeType(reader)) {

                    case XML_READER_TYPE_ELEMENT: 

                        temp = (char *)xmlTextReaderConstName(reader);
                            strcat(parseResult,temp);                   
                            strcat(parseResult,"#");                            

                        xmlTextReaderMoveToElement(reader);                     
                          continue;

                    case XML_READER_TYPE_TEXT:  
                        temp = (char *)xmlTextReaderConstValue(reader); 
                                strcat(parseResult,temp);                           
                                strcat(parseResult,"|");                

                        continue;               

                }   

            }

            xmlFreeTextReader(reader);
            xmlCleanupParser();
            return parseResult;//on success returns the parsed omni string
        }
        else
            return 0; // on failure
    } 
```

第二个功能：

```
 char* CB_xmlParserFromMemory(char *xmlstring){
        char *xmlParseresult;   
        char *temp; 
        int i,len,,error;;

        xmlTextReaderPtr reader1;

        len= strlen(xmlstring);
        if(len==0)
            return 0;
        reader1 = xmlReaderForMemory(xmlstring,len,NULL,NULL,0);

        if(reader1){

            temp = (char *) GlobalAlloc(GPTR, sizeof(char)*len);
            while(error=xmlTextReaderRead(reader1)) {

                if(error==-1){
                    return 0; // on failure
                }           
                switch(xmlTextReaderNodeType(reader1)) {

                    case XML_READER_TYPE_ELEMENT: 

                        temp = (char *)xmlTextReaderConstName(reader1);                 

                            strcat(xmlParseresult,"\"");
                            strcat(xmlParseresult,temp);
                            strcat(xmlParseresult,"\"");
                            strcat(xmlParseresult,":");

                        xmlTextReaderMoveToElement(reader1);     
                          continue;

                    case XML_READER_TYPE_TEXT:              

                        temp = (char *)xmlTextReaderConstValue(reader1); 
                        strcat(xmlParseresult,"\"");
                        strcat(xmlParseresult,temp);
                        strcat(xmlParseresult,"\"");
                        strcat(xmlParseresult,",");
                    continue;               

                }   

            }       
            xmlCleanupParser();     
            xmlFreeTextReader(reader1);     
            GlobalFree(temp);
            return xmlParseresult;//on success returns the parsed omni string   
        }
        else
            return 0; // on failure
    } 
```

这两个函数都可以单独工作。但是如果我一个接一个地调用一个函数，那么两个函数都会在上面给定的地方崩溃......同样的错误......请帮助我......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T05:04:47.297

我认为这对我来说是幸运的一天，因为我有机会回答我自己的问题......

现在我很高兴，因为它在我的最后工作得非常好，没有任何问题，问题是记忆（不是那个，你在听了记忆这个词后的想法）。

由于以下声明而提出了这个问题：

```
 xmlCleanupParser(); 
```

正如我使用的那样

```
 xmlInitParser (); 
```

但现在我不会给出原因，因为你们也应该做一些工作......

我会给你一个帮助我摆脱困境的[网址......](http://xmlsoft.org/xmlmem.html)

# mysql - 多个表引用一个表字段

> ID：10737609
> 
> 赞同：1
> 
> 时间：2012-05-24T12:34:23.277
> 
> 标签：mysql, foreign-keys, innodb

有两个表 - 帖子和评论：

```
create table posts
(
    id integer not null primary key auto_increment,
    body text not null
);

create table comments
(
    id integer not null primary key auto_increment,
    body text not null,
    post_id integer not null references posts(id)
); 
```

现在我想再创建一个表 - 报告（“坏帖子”标志），我希望它存储帖子和评论的报告。

```
create table reports
(
    id integer not null primary key auto_increment,
    obj_type tinyint not null, /* '1' for posts and '2' for comments */
    obj_id integer not null,
    body text not null
);

alter table reports add foreign key(obj_id) references posts(id) on delete cascade;
alter table reports add foreign key(obj_id) references comments(id) on delete cascade; 
```

如您所见，单个字段中有两个引用（我通过 obj_id 区分它们），问题是 - 这样做可以吗？

如果不是什么会更好的解决方案？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:40:06.597

直觉上感觉这不是正确的做法。我认为 MySQL 也会感到困惑；它如何验证是否满足约束；它会`posts`先尝试，还是`comments`先尝试……也许两者兼而有之？

我个人会选择创建两个链接表：

*   `comments <-> reports`
*   `posts <-> reports`

这样你就可以`obj_id`正确地消除歧义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:40:10.110

您只需要引用您的评论表，因为它已经引用了帖子表，这样每当您收到报告时，您就拥有评论的关键和帖子的关键。

# android - 几分钟后，SharedPreferences 就会消失。

> ID：10737611
> 
> 赞同：0
> 
> 时间：2012-05-24T12:34:26.160
> 
> 标签：android, sharedpreferences

我有一个奇怪的问题，我还没有找到解决办法。几分钟后，我的 SharedPreferences 消失了，我创建了一个共享首选项编辑器，然后提交了我所做的每一个更改。然后，我使用以下方法获取要使用的 SharedPreferences 值：

```
settings = getSharedPreferences("settings", 0);

if(settings.contains("accesstoken")){

    // create a string that stores the accesstoken from our settings.
    String str_access = settings.getString("accesstoken", null);

    if(accesstoken_file_data != null){
        str_access = accesstoken_file_data;
    } 
```

过了一会儿，我存储的访问令牌以及存储在 SharedPreferences 中的所有其他数据似乎都不存在了……如果我离开手机几分钟。我正在使用 HTC One X 进行开发。

我正在使用这种方法来添加值：

```
 String accesstoken = "someVal";

                            SharedPreferences.Editor editor = settings.edit();

                            editor.putString("accesstoken", accesstoken);
                            editor.commit(); 
```

我还没有找到任何可行的解决方案......如果有人可以帮助或指导我，那将非常感谢......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-04T11:09:18.187

如果应用程序崩溃或被强制停止，SharedPreferences 有一个不幸的趋势是擦除其数据 -

如果从设置中清除应用数据，所有保存方法（外部存储除外）都会被擦除

您可以尝试使用不同的保存方法来存储数据。您有数据库 (SQLite)、内部和外部存储。最后两个是基于文件的。

# java - 如果在 JFrame 中加载图像，如何停止进程

> ID：10737617
> 
> 赞同：-4
> 
> 时间：2012-05-24T12:34:50.527
> 
> 标签：java, swing

我正在尝试在 JFrame 中显示图像。他们打印得很好，没有任何问题。但是当我关闭 JFrame 窗口时，即使窗口关闭，进程仍在运行。如何停止图像加载线程？请用示例编码进行解释。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T12:36:30.400

利用：

```
youJFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
```

或者您可以通过以下方式以编程方式进行：

```
System.exit(0); 
```

或者：

```
youJFrame.dispose(); // this will end the program if no other threads are running. 
```

* * *

**编辑：**

> 如何停止图像加载线程

您可以使用方法向它发送信号`interrupt()`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T12:38:35.913

您可能还没有为 JFrame 设置默认关闭操作。不确定您想要哪个，但可能是当窗口关闭时应用程序应该关闭。如果是这样，

```
frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
```

如果您的 JFrame 被调用`frame`。如果您只想释放 JFrame 占用的任何资源，请改用 JFrame.DISPOSE_ON_CLOSE。

# sharepoint - 在 sharepoint 中使用指定用户的 id 运行工作流

> ID：10737618
> 
> 赞同：1
> 
> 时间：2012-05-24T12:35:00.247
> 
> 标签：sharepoint, sharepoint-2010

我创建了两个自定义列表，L1 和 L2 具有相同的列，如下所示。

```
Title(Single line of text) 
Name(Single line of text) 
```

我编写了一个工作流，使用工作流的“复制列表项”操作将新创建的项目从 L1 复制到 L2。在 L1 中创建新项目的用户对其具有贡献者访问权限，但他对 L2 没有访问权限。这就是我在工作流程中遇到错误的原因。

我可以使用另一个至少在 L2 中具有贡献者访问权限的 ID 运行工作流吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T16:32:21.077

您可以在共享点设计器工作流程中模拟用户。在复制列表项操作周围添加模拟，如果模拟用户有权访问它应该可以工作

编辑：创建模拟步骤...

1.  打开您的工作流程，然后单击“编辑工作流程”按钮将其构建出来。
2.  单击步骤 1 框或**步骤 1**文本**之外的任何一个**
***   在功能区上有一个标记为插入的部分；该部分右下角的模拟步骤现在应该可以选择*   单击模拟步骤以添加将***在工作流作者的凭据下运行的部分*****

 **如果您对此有任何疑问，请告诉我**

# ruby-on-rails - 使用救援时任务不会“失败”

> ID：10737622
> 
> 赞同：0
> 
> 时间：2012-05-24T12:35:33.450
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, resque

我有这样的任务...

```
def self.perform(parsed_json)
 do_hard_work
 use_faye_to_push_status
 rescue => exception
   use_faye_to_push_error
end 
```

但是，当我使用“救援”时，任务不会进入失败的任务列表。有没有办法，甚至使用`rescue`，将任务设置为失败？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T12:45:09.197

从错误中拯救将阻止它在调用堆栈中继续前进。话虽如此，您可以简单地`raise`再次进入`rescue`块内以向上传播它：

```
def self.perform(parsed_json)
  do_hard_work
  use_faye_to_push_status
rescue => exception
  use_faye_to_push_error
  raise
end 
```

# android - android ics中的Dom解析器，无法通过标签名称获取元素

> ID：10737623
> 
> 赞同：0
> 
> 时间：2012-05-24T12:35:40.260
> 
> 标签：android

我尝试使用 dom 解析器从 xml 文件中获取值，例如：

```
InputStream inputStream = new ByteArrayInputStream(
                xml_string.getBytes());
        Document pdom = pbuilder.parse(inputStream);
        Element proot = pdom.getDocumentElement();
        NodeList pitems = proot.getElementsByTagName("Profile"); 
```

但是pitems大小实际上是0，上面的代码在4.0之前的版本中工作。所以我希望我能得到名字和会员项目。现在不知道怎么弄了。请帮助我。

xml 格式：

```
<Profile parameter="S...J">
   <Name>Jon</Name>
   <IsMember>true</Ismember>
</Profile> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T07:43:08.933

您需要像这样更改您的 XML

```
<root>
<Profile parameter="SJ">
   <Name>Jon</Name>
   <IsMember>true</IsMember>
</Profile>
</root> 
```

然后所有其他事情都会正常工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T13:23:29.743

这样做：

```
Document pdom = pbuilder.parse(inputStream);
Element proot = pdom.getDocumentElement();
proot.normalize();  //must call

NodeList pitems = document.getElementsByTagName("Profile");  //get element from document 
```

# c++ - 在线程中修改数据

> ID：10737625
> 
> 赞同：1
> 
> 时间：2012-05-24T12:35:44.713
> 
> 标签：c++, multithreading, mutex

我有一个具有以下结构的类：

```
class Nginx_sender
{
    private:
        std::vector<std::string> mMessagesBuffer;
        boost::mutex mMutex;

       void SendMessage(const std::string &msg)
       {
           mMutex.lock();
           mMessagesBuffer.push_back(msg);
           mMutex.unlock();

           std::cout << "Vector size: " << mMessagesBuffer.size() << std::endl;
       }

       void NewThreadFunction()
       {
          while(true) {
            mMutex.lock();
            if (mMessagesBuffer.size() >= 1) std::cout << ">=1\n";
            mMutex.unlock();

            boost::this_thread::sleep(boost::posix_time::milliseconds(200));
          }
       }
};

int main()
{
   Nginx_sender *NginxSenderHandle;
   boost::thread sender(boost::bind(&Nginx_sender::NewThreadFunction, &NginxSenderHandle));
   // ...
} 
```

`NewThreadFunction`在新线程中运行并检查`mMessagesBuffer`. 现在我在`main`函数中的任何地方调用：`NginxSenderHandle->SendMessage("Test");`

这会出现：`Vector size: 1`第一次，`2`第二次等。

但！它总是== `NewThreadFunction`0。为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:25:19.897

绑定时，您很可能正在创建 Nginx_sender 的另一个副本。你真的需要在将 NginxSenderHandle 传递给 bind() 之前引用它（它已经是一个指针）吗？ [http://www.boost.org/doc/libs/1_49_0/libs/bind/bind.html#with_member_pointers](http://www.boost.org/doc/libs/1_49_0/libs/bind/bind.html#with_member_pointers)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:47:48.000

我打赌编译器正在线程本地缓存中缓存一些 mMessagesBuffer 内部。尝试将 'volatile' 关键字添加到 mMessagesBuffer 以禁用此类优化。

# oop - 类图 - 在模块中重复类？

> ID：10737634
> 
> 赞同：0
> 
> 时间：2012-05-24T12:36:14.333
> 
> 标签：oop, uml

我有一个关于模块之间的类重复的问题。
我有一个包含 24 个类的大模块，并将其分为三个类，共 8 个。但是有一个类（“用户”）出现在两个模块中。我可以重复吗？我需要将属性放在两个模块中吗？
模块中类的最大理想是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T17:13:37.327

实际上：在 UML 中，您确实可以多次描述一个类/或对象。而且，您不必显示所有成员（属性）。

描述类和关系的理想方式是，每个类都包含在一个包中，但是可以在同一个包或不同包中与其他类引用（具有某种关系）。

下面的图表实际上是可以的，并且是在 UML 中描述同一事物的几种方法我试图不让你混淆，有很多图表。

整个想法是，在 UML 中，您可能有多种选择来描述或建模相同的想法。

**图 1\. 同一个包中完整描述的示例类。**

```
...................................................................................
..+--------------------+...........................................................
..|..Streams...........|...........................................................
..+--------------------+---------------------------------------------------------+.
..|..............................................................................|.
..|.+----------------------------------+....+----------------------------------+.|.
..|.|            StreamClass           |....|          ReaderClass             |.|.
..|.+----------------------------------+....+----------------------------------+.|.
..|.| [#] void Read()     <<abstract>> |....| [+] void Read()     <<override>> |.|.
..|.| [#] void Write()    <<abstract>> +<---+ [+] bool CanRead()  <<override>> |.|.
..|.| [+] bool CanRead()  <<virtual>>  |....| [+] bool CanWrite() <<override>> |.|.
..|.| [+] bool CanWrite() <<virtual>>  |....| [+] bool CanRead()  <<virtual>>  |.|.
..|.+----------------------------------+....+----------------------------------+.|.
..|..............................................................................|.
..+------------------------------------------------------------------------------+.
................................................................................... 
```

**图 2\. 同一个包中的示例类，省略了不必要的成员**

```
....................................................................................
..+--------------------+............................................................
..|..Streams...........|............................................................
..+--------------------+----------------------------------------------------------+.
..|...............................................................................|.
..|.+----------------------------------+....+----------------------------------+..|.
..|.|            StreamClass           |....|          ReaderClass             |..|.
..|.+----------------------------------+....+----------------------------------+..|.
..|.| [#] void Read()     <<abstract>> |....| [+] void Read()     <<override>> |..|.
..|.| [#] void Write()    <<abstract>> +<---+ [+] bool CanRead()  <<override>> |..|.
..|.| [+] bool CanRead()  <<virtual>>  |....| [+] bool CanWrite() <<override>> |..|.
..|.| [+] bool CanWrite() <<virtual>>  |....+----------------------------------+..|.
..|.+----------------------------------+..........................................|.
..|...............................................................................|.
..+-------------------------------------------------------------------------------+.
.................................................................................... 
```

**图 3\. 不同包中的示例类**

```
...................................................................................
.+--------------------+...................+--------------------+...................
.|..Streams...........|...................|..Readers...........|...................
.+--------------------+-----------------+.+--------------------+-----------------+.
.|......................................|.|..|...................................|.
.|.+----------------------------------+.|.|.+----------------------------------+.|.
.|.|            StreamClass           |.|.|.|          ReaderClass             |.|.
.|.+----------------------------------+.|.|.+----------------------------------+.|.
.|.| [#] void Read()     <<abstract>> |.|.|.| [+] void Read()     <<override>> |.|.
.|.| [#] void Write()    <<abstract>> +<----+ [+] bool CanRead()  <<override>> |.|.
.|.| [+] bool CanRead()  <<virtual>>  |.|.|.| [+] bool CanWrite() <<override>> |.|.
.|.| [+] bool CanWrite() <<virtual>>  |.|.|.+----------------------------------+.|.
.|.+----------------------------------+.|.|......................................|.
.|......................................|.|......................................|.
.+--------------------------------------+.+--------------------------------------+..
................................................................................... 
```

有时，包在类图中被省略，或者被认为在同一个包中。

**图 4\. 没有包的完整描述类示例。**

```
................................................................................
..+----------------------------------+....+----------------------------------+..
..|            StreamClass           |....|          ReaderClass             |..
..+----------------------------------+....+----------------------------------+..
..| [#] void Read()     <<abstract>> |....| [+] void Read()     <<override>> |..
..| [#] void Write()    <<abstract>> +<---+ [+] bool CanRead()  <<override>> |..
..| [+] bool CanRead()  <<virtual>>  |....| [+] bool CanWrite() <<override>> |..
..| [+] bool CanWrite() <<virtual>>  |....+----------------------------------+..
..+----------------------------------+..........................................
................................................................................ 
```

最后，有时每个类都通过封装的容器进行完整描述，再加上只显示关系的图表。接下来的 3 个数字代表 3 个互补的图表。

**图 5.1 单类示例。**

```
...........................................
..+--------------------+...................
..|..Streams...........|...................
..+--------------------+-----------------+.
..|......................................|.
..|.+----------------------------------+.|.
..|.|            StreamClass           |.|.
..|.+----------------------------------+.|.
..|.| [#] void Read()     <<abstract>> |.|.
..|.| [#] void Write()    <<abstract>> |.|.
..|.| [+] bool CanRead()  <<virtual>>  |.|.
..|.| [+] bool CanWrite() <<virtual>>  |.|.
..|.+----------------------------------+.|.
..|......................................|.
..+--------------------------------------+.
........................................... 
```

**图 5.2 单类示例。**

```
...........................................
..+--------------------+...................
..|..Readers...........|...................
..+--------------------+-----------------+.
..|......................................|.
..|.+----------------------------------+.|.
..|.|            ReaderClass           |.|.
..|.+----------------------------------+.|.
..|.| [#] void Write()    <<abstract>> |.|.
..|.| [#] void Read()     <<override>> |.|.
..|.| [+] bool CanRead()  <<override>> |.|.
..|.| [+] bool CanWrite() <<override>> |.|.
..|.+----------------------------------+.|.
..|......................................|.
..+--------------------------------------+.
........................................... 
```

**图 5.3 类之间的示例关系。**

```
................................................................................
..+----------------------------------+....+----------------------------------+..
..|            StreamClass           +<---+          ReaderClass             |..
..+----------------------------------+....+----------------------------------+..
................................................................................ 
```

**概括**

请记住，UML 是一个指南，而不是一条严格的路径。

干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T09:18:12.813

很好的答案UMLcat。UML 可以在多个类图中重用相同的分类器。我的意思是，多年来 UML 与图形视图相关，有时在同一个视图中与所有项目分类器相关。

UML 元建模方法是简单地创建一个与图表实时同步的 UML 模型。在许多工具中，您都有图形表示和模型之间的映射器。例如，在 Eclipse 中，您有图形映射器 GMF，它调用模型映射器 EMF，然后创建 UML 模型。因此，不可能将 UML 视图与存储在硬盘上的 xmi 格式的 uml 模型实时同步。

几年前，Omondo EclipseUML 已经启动了这个元模型计划。它允许您创建尽可能多的图表，这些图表与磁盘上的 UML 模型实时同步，并立即保存为 XMI UML 2.3 格式。因此，您可以在不同的视图中重用相同的分类器，因为所有模型逻辑都在保存在磁盘上的 modell 中并实时同步。

往返工程不仅在代码和模型之间，而且在模型和元模型之间更深。它为 UML 提供了全部功能！

# javascript - 简单的json数组结构

> ID：10737638
> 
> 赞同：0
> 
> 时间：2012-05-24T12:36:33.350
> 
> 标签：javascript, json

我知道下一个问题一定看起来很愚蠢，但无论如何我都会这样做:)

我有这个结构：

```
{
      "name": "Erjet Malaj",
      "first_name": "Erjet",
      "work": [
        {
          "employer": {
            "id": "110108059015688",
            "name": "Art of Living Foundation"
          },
          "position": {
            "id": "137081429661437",
            "name": "Volunteer"
          },
          "start_date": "0000-00",
          "end_date": "0000-00"
        },
        { 
```

我像这样检索 response.data[i].first_name，我应该如何检索工作 ID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:39:20.900

`work`是一个数组。你需要遍历它

```
var work = response.data[i].work,
    worklen = work.length,
    j, workdetails;

for(j = 0; j < worklen; j++){

    //simplify for readability
    workdetails = work[j];

    //where prop is "employer" or "position"
    workdetails[prop].id 
    workdetails[prop].name
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:46:33.330

数组`id`中每条记录的雇主和职位都有一个`work`。如果您想遍历一个人的工作条目并收集这些 ID，请使用：

```
var person = response.data[i];
var work = person.work;

for(var j = 0; j < work.length; ++j) {
    var work_entry = work[j];
    console.log(work_entry.employer.id);
    console.log(work_entry.position.id); 
} 
```

数组中的`work`条目从 0 开始以数字方式访问。条目本身就是对象，您可以使用`obj_name.property_name`或访问它们的属性`obj_name["property_name"]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T12:38:26.843

你试过了`response.data[i].work.position.id`吗？

再想一想，工作是一个对象数组，所以它的访问方式如下：

`response.data[i].work[0].position.id`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T12:39:53.020

假设您的意思是给定工作的雇主 ID

这应该得到雇主ID

```
response.data[i].work[j].employer.id 
```

你也可以这样做（取决于偏好）

```
response.data[i].work[j]['employer'].id 
```

在这种情况下，工作位置是 j（用作数组索引器），将 j 替换为 0 以获取第一个，用 1 获取第二个等。

# jquery-ui - 禁用自动完成以专注于选择项

> ID：10737640
> 
> 赞同：1
> 
> 时间：2012-05-24T12:36:46.890
> 
> 标签：jquery-ui, autocomplete, jquery-ui-autocomplete

我在 textarea 上使用 jQuery UI 自动完成插件

我想要的是当用户将鼠标悬停在自动完成列表上时不应修改 textarea 内容

这意味着，如果用户滚动列表或将鼠标悬停在选项上，则 textarea 内容不应更改。更改应仅在选择选项时发生。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-24T13:15:10.147

```
$("#my_textarea").autocomplete({
    source: mySource,
    focus: function (event, ui) {
        event.preventDefault() // <-- prevent the textarea from being updated.
    }
}); 
```

**示例：http:** [//jsfiddle.net/hJ9sA/](http://jsfiddle.net/hJ9sA/)

# c++ - 将 const char* 转换为 wstring

> ID：10737644
> 
> 赞同：34
> 
> 时间：2012-05-24T12:37:01.883
> 
> 标签：c++

我正在为基于锌的闪存应用程序开发本机扩展，我需要将 a 转换`const char*`为`wstring`.

这是我的代码：

```
mdmVariant_t* appendHexDataToFile(const zinc4CallInfo_t *pCallInfo, int paramCount, mdmVariant_t **params) {

    if(paramCount >= 2) {
        const char *file    = mdmVariantGetString(params[0]);
        const char *data    = mdmVariantGetString(params[1]);

        return mdmVariantNewInt(native.AppendHexDataToFile(file, data));
    }
    else {
        return mdmVariantNewBoolean(FALSE);
    }
} 
```

但`native.AppendHexDataToFile()`需要两个`wstring`。我对 C++ 不是很好，我认为所有这些不同的字符串类型完全令人困惑，而且我在网络中没有找到有用的东西。所以我问你们怎么做。

**编辑**：字符串是 UTF-8，我使用的是 OSX 和 Windows XP/Vista/7

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-24T13:09:28.733

我建议您尽可能使用`std::string`而不是 C 风格的字符串 ( )。`char*`您可以通过简单地将对象传递给其构造函数来创建`std::string`对象。`const char*`

拥有`std::string`后，您可以创建简单的函数，将`std::string`包含多字节 UTF-8 字符转换为`std::wstring`包含 UTF-16 编码点（来自 的特殊字符的 16 位表示`std::string`）。

还有更多方法可以做到这一点，这里是使用[MultiByteToWideChar 函数](http://msdn.microsoft.com/en-us/library/dd319072%28v=vs.85%29.aspx)的方法：

```
std::wstring s2ws(const std::string& str)
{
    int size_needed = MultiByteToWideChar(CP_UTF8, 0, &str[0], (int)str.size(), NULL, 0);
    std::wstring wstrTo( size_needed, 0 );
    MultiByteToWideChar(CP_UTF8, 0, &str[0], (int)str.size(), &wstrTo[0], size_needed);
    return wstrTo;
} 
```

还要检查这些问题：
[Mapping multibyte characters to their unicode point representation](https://stackoverflow.com/q/6107776/1168156)
[为什么使用 MultiByteToWideCharArray 将 std::string 转换为 std::wstring？](https://stackoverflow.com/q/4582951/1168156)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-09-21T14:00:30.770

AFAIK 这仅适用于 C++11 及更高版本：

```
#include <codecvt>

// ...

std::wstring stringToWstring(const std::string& t_str)
{
    //setup converter
    typedef std::codecvt_utf8<wchar_t> convert_type;
    std::wstring_convert<convert_type, wchar_t> converter;

    //use converter (.to_bytes: wstr->str, .from_bytes: str->wstr)
    return converter.from_bytes(t_str);
} 
```

[参考答案](https://stackoverflow.com/a/18374698/1178267)

**更新**

正如评论中所指出的，<codecvt> 似乎在 C++17 中已被弃用。请参阅此处：[不推荐使用的标头 <codecvt> 替换](https://stackoverflow.com/questions/42946335/deprecated-header-codecvt-replacement)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2016-09-15T21:35:53.093

您可以将`char`字符串`wstring`直接转换为以下代码：

```
char buf1[] = "12345678901234567890";
wstring ws(&buf1[0], &buf1[20]); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-24T13:14:00.430

您需要一个可以编码/解码 UTF8 的库。不幸的是，这个功能不包含在 std c++ 库中。这是您可能使用的一个库：http: [//utfcpp.sourceforge.net/](http://utfcpp.sourceforge.net/)

这是一个使用它的示例：

```
utf8::utf8to32(bytes.begin(), bytes.end(), std::back_inserter(wstr)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T14:12:03.840

在 OS X 上 wstring 使用 UTF-32 而不是 UTF-16。您可以像这样进行转换：

```
#include <codecvt>
#include <string>

// make facets usable by giving them a public destructor
template <class Facet>
class usable_facet
    : public Facet
{
public:
    template <class ...Args>
        usable_facet(Args&& ...args)
            : Facet(std::forward<Args>(args)...) {}
    ~usable_facet() {}
};

std::wstring s2ws(std::string const &s) {
    std::wstring_convert<
        usable_facet<std::codecvt<char32_t,char,std::mbstate_t>>
        ,char32_t> convert;
    std::u32string utf32 = convert.from_bytes(s);
    static_assert(sizeof(wchar_t)==sizeof(char32_t),"char32_t and wchar_t must have same size");
    return {begin(utf32),end(utf32)};
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-28T07:46:09.733

@anhoppe的[答案的补充。](https://stackoverflow.com/a/32697209/634821)以下是如何转换`char*`：

```
#include <codecvt>
#include <locale> 

// ...

std::wstring stringToWstring(const char* utf8Bytes)
{
    //setup converter
    using convert_type = std::codecvt_utf8<typename std::wstring::value_type>;
    std::wstring_convert<convert_type, typename std::wstring::value_type> converter;

    //use converter (.to_bytes: wstr->str, .from_bytes: str->wstr)
    return converter.from_bytes(utf8Bytes);
} 
```

`char*`如果您也已经知道缓冲区的长度，这里是如何转换的：

```
#include <codecvt>

// ...

std::wstring stringToWstring(const char* utf8Bytes, const size_t numBytes)
{
    //setup converter
    using convert_type = std::codecvt_utf8<typename std::wstring::value_type>;
    std::wstring_convert<convert_type, typename std::wstring::value_type> converter;

    //use converter (.to_bytes: wstr->str, .from_bytes: str->wstr)
    return converter.from_bytes(utf8Bytes, utf8Bytes + numBytes);
} 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-05-24T12:43:41.743

这是我找到的代码；

```
std::wstring StringToWString(const std::string& s)
 {
 std::wstring temp(s.length(),L' ');
 std::copy(s.begin(), s.end(), temp.begin());
 return temp; 
 } 
```

这是使用 Windows API 函数 MultiByteToWideChar 的可能的第二个解决方案的原始论坛帖子：

[http://forums.codeguru.com/archive/index.php/t-193852.html](http://forums.codeguru.com/archive/index.php/t-193852.html)

# git - Jenkins、git、带有自定义 URL (SSH) 的子模块

> ID：10737648
> 
> 赞同：2
> 
> 时间：2012-05-24T12:37:15.023
> 
> 标签：git, ssh, jenkins

问题很简单：Jenkins 可以使用**ssh://ci_ro@server**访问主 git 存储库（效果很好），但是我有 URL 不同的子模块：**ssh://server**（没有定义一些用户，这是为了允许开发人员使用此 repo 及其子模块）。我绝对不允许（坦率地说不想）提交 CI 特定的 .gitmodule 文件（这会破坏开发人员的存储库），所以请不要提及它。所以詹金斯可以拉主回购但立即失败：

```
Caused by: hudson.plugins.git.GitException: Command "git submodule update --init --recursive" returned status code 1: Cloning into blah/blah...
Host key verification failed.
fatal: The remote end hung up unexpectedly
Clone of 'ssh://server:someport/blah/blah...' into submodule path 'blah/blah' failed 
```

我的问题：是否可以告诉 Jenkins 使用 ssh://ci_ro@server... 子模块的 URL 前缀而不是 .gitmodules 中配置的前缀？或者任何其他可用的解决方法、插件或黑客？我浏览了工作选项，没有找到任何有用的选项。

**更新**

感谢所有的帮助。解决方案是允许“jenkins”系统用户使用 git 从特定的 ssh 服务器/端口中提取。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-04T08:24:07.547

解决方案是允许运行 Jenkins 的系统用户从指定的主机/端口使用 SSH 拉取。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:46:15.107

您始终可以从 shell 构建步骤手动执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:14:57.060

尝试更改构建服务器上的 /etc/ssh/ssh_config ：

```
 StrictHostKeyChecking no 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T14:23:00.700

在您的构建步骤中，执行

```
git submodule init 
```

然后通过子模块递归并调整它们的遥控器，这是不对的，但是我在 github 用户名更改时使用的脚本是：

```
#!/bin/sh
git remote -v | grep richoH | while read name url type; do
    newurl=`echo $url | sed -e "s/richoH/richo/"`
    git remote set-url $name $newurl
done 
```

然后进行 git 子模块更新，我认为这不会干扰遥控器。这是未经测试的，但我相信声音。

# javascript - 如何使部分文本字段不可编辑？

> ID：10737654
> 
> 赞同：-2
> 
> 时间：2012-05-24T12:37:41.187
> 
> 标签：javascript, jquery, input

我有一个类似于 facebook 的发送消息到：文本字段的要求，其中在您输入一些值后，一旦您选择该字段仍可编辑但所选值变为不可编辑的建议，它将给您建议（您将拥有完全删除它并输入要更改的新值。）如何使用 JavaScript/jquery 执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:42:42.073

我想你正在寻找这个：[http](http://harvesthq.github.com/chosen/) ://harvesthq.github.com/chosen/ 多重选择方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T13:04:10.620

您可以使用 jQuery 自动完成 [http://jqueryui.com/demos/autocomplete/](http://jqueryui.com/demos/autocomplete/)

# database-design - 在树结构中检索父母和孩子

> ID：10737655
> 
> 赞同：2
> 
> 时间：2012-05-24T12:37:45.563
> 
> 标签：database-design, tree

我使用嵌套集架构对数据库中的父子关系进行了建模。

每个孩子（叶子）都链接到一个包含开放日期的表格，但父母没有。

我希望能够检索在某个时间打开的所有叶子，如果该父母的所有孩子都打开了，他们的父母。

有没有办法快速做到这一点？我想像做一个子请求这样的事情，但这既不漂亮，也不快；最好的办法是在一个查询中完成。

我可以将我的嵌套集架构更改为另一个架构，以便更轻松地构建此请求吗？

**编辑：**

我正在使用 MySql，但如果这是实现我的目标所必需的，我可以更改为任何其他数据库。

这是我的节点（父子）表的样子：

```
id (int)
lft (int)
rgt (int)
root_id (int , self reference to the root id, used to generate multi-rooted tree)
level (int)

name (string)
description (string)
... 
```

我的 opening_dates 表如下所示：

```
id (int)
node_id (int)
start (datetime)
end (datetime)
status (bool, 0 for an opened date, 1 for a close one) 
```

我还补充说，我的父子不会经常更改，这就是我决定采用嵌套集合架构的原因。我的目标是在“选择查询”系统时尽可能快。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T13:59:30.097

据我所知，MySQL 不支持分层查询。使用 Oracle 非常简单，但如果是 MySQL，您可能需要为此目的创建存储函数。尝试阅读[这篇如何在 MySQL 中创建分层查询](http://explainextended.com/2009/03/17/hierarchical-queries-in-mysql/)

# xaml - Metro 风格：用鼠标滚轮滚动

> ID：10737656
> 
> 赞同：2
> 
> 时间：2012-05-24T12:37:45.877
> 
> 标签：xaml, gridview, windows-runtime, winrt-xaml, semantic-zoom

我在 gridview 中有 gridview 并想实现鼠标滚轮滚动功能。所以我将此块添加到内部gridview中

```
<GridView.Template>
  <ControlTemplate >
    <ItemsPresenter />
  </ControlTemplate>
</GridView.Template> 
```

但在这种情况下，刷卡不起作用

我该如何解决这个问题？

第 2 部分。我将尝试更深入地描述这种情况。我的主屏幕应该实现类似于 Windows 8 主屏幕上的功能。它应该被放大/缩小。这就是我使用 SenaticZoom 的原因。在 ZoomIn 中，我放置了包含控件的 GridView。该控件包含自己的GridView（我需要实现刷卡功能）。我不知道如何更改此 xaml 文件。有什么建议么？控制代码：

```
<GridView

 x:Name="iGridView"

            Margin="120,0,0,0"
                        ItemsSource="{Binding Source={StaticResource ViewSource}}"
                        ItemTemplateSelector ="{StaticResource ItemTemplateSelector}"
                        IsItemClickEnabled="True"

                        MinCellHeight = "450"
                        MinCellWidth = "245"
                        IsSwipedEnabled="True"
                        >

                <GridView.Template>
                    <ControlTemplate>
                        <ItemsPresenter />
                    </ControlTemplate>
                </GridView.Template>

                <GridView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <VirtualizingStackPanel Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </GridView.ItemsPanel>
                <GridView.GroupStyle>
                    <GroupStyle>
                        <GroupStyle.HeaderTemplate>
                            <DataTemplate>
                                <Grid Margin="0,0,0,20">
                                    <Button

                                        Content="{Binding Title}"
                                        Style="{StaticResource Header}"/>
                                </Grid>
                            </DataTemplate>
                        </GroupStyle.HeaderTemplate>
                        <GroupStyle.Panel>
                            <ItemsPanelTemplate>
                                <VariableSizedWrapGrid VerticalAlignment="Top" Height="550" Orientation="Vertical"/>
                            </ItemsPanelTemplate>
                        </GroupStyle.Panel>
                    </GroupStyle>
                </GridView.GroupStyle>
            </GridView> 
```

和基本页面的代码

```
<SemanticZoom x:Name="sZoom" VerticalAlignment="Stretch" >
                <SemanticZoom.ZoomedInView>
                    <GridView x:Name="zoomIn" SelectionMode="None"
                                  IsItemClickEnabled="False"
                                  IsSwipeEnabled="False"

                              >
                        <GridView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </GridView.ItemsPanel>
                        <GridView.ItemContainerStyle>
                            <Style TargetType="GridViewItem">
                                <Setter Property="Template" Value="{StaticResource ItemTemplate}"/>
                            </Style>
                        </GridView.ItemContainerStyle>
                        <local:Control1 x:Name="Control1" />
                       <local:Control1 x:Name="Control2" />
                    </GridView>
                </SemanticZoom.ZoomedInView> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T11:04:26.367

它是工作 GridView 风格。我删除了 scrollviewr 属性

```
<Style x:Key="GridViewInGridViewStyle" TargetType="GridView">
    <Setter Property="Padding" Value="0,0,0,10"/>
    <Setter Property="IsTabStop" Value="False"/>
    <Setter Property="TabNavigation" Value="Once"/>
    <Setter Property="IsSwipeEnabled" Value="True"/>
    <Setter Property="ItemContainerTransitions">
        <Setter.Value>
            <TransitionCollection>
                <AddDeleteThemeTransition/>
                <ContentThemeTransition/>
                <ReorderThemeTransition/>
                <EntranceThemeTransition IsStaggeringEnabled="False"/>
            </TransitionCollection>
        </Setter.Value>
    </Setter>
    <Setter Property="ItemsPanel">
        <Setter.Value>
            <ItemsPanelTemplate>
                <WrapGrid Orientation="Vertical"/>
            </ItemsPanelTemplate>
        </Setter.Value>
    </Setter>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="GridView">
                <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}">
                    <ItemsPresenter HeaderTemplate="{TemplateBinding HeaderTemplate}" Header="{TemplateBinding Header}" HeaderTransitions="{TemplateBinding HeaderTransitions}" Padding="{TemplateBinding Padding}"/>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T03:55:58.810

如果您重新模板化 GridView 并删除内部 ScrollViewer，则鼠标滚轮滚动将起作用，但滑动选择将不起作用。如果两者都需要，诀窍是使用 AddHandler() 方法为 PointerWheelChanged 事件添加处理程序并将 e.Handled 属性设置为 false。这将允许鼠标滚轮事件正确地冒泡到您的外部 ScrollViewer：

```
public class CustomGridView : GridView
{
    protected override void OnApplyTemplate()
    {
        base.OnApplyTemplate();
        var sv = this.GetTemplateChild("ScrollViewer") as UIElement;
        if (sv != null)
            sv.AddHandler(UIElement.PointerWheelChangedEvent, new PointerEventHandler(OnPointerWheelChanged), true);
    }

    private void OnPointerWheelChanged(object sender, PointerRoutedEventArgs e)
    {
        e.Handled = false;
    }
} 
```

我实现了这个确切的场景，它对我有用。完整的细节在这里：[http ://briandunnington.github.com/gridview-in-a-scrollviewer.html](http://briandunnington.github.com/gridview-in-a-scrollviewer.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T20:10:31.713

**更新：**对不起，我误读了这个问题。如果将 GridView 放置在 GridView 中，则确实有嵌套的 ScrollViewers，并且确实需要内部 GridViews 上的代码，否则鼠标滚轮滚动将不起作用。

但是，为什么要将 GridView 嵌套在 GridView 中？

看看 winrt 内置的分组功能。

或者，将内部 GridViews 放置在一个简单的 ItemsControl 中，其中 StackPanel 具有水平方向作为 ItemsPanel，并将 ItemsControl 放在 ScrollViewer 中。如果您确实将多个 GridViews 放置在 ScrollViewer（直接或间接）中，您确实需要该代码从内部（即嵌套）GridViews 中删除 ScrollViewer，否则鼠标滚轮滚动将不起作用。

**原始答案：**

仅当您将 GridView 放置在 ScrollViewer 中时才需要该代码。

如果 GridView 是唯一要显示的内容，则不需要将其放在 ScrollViewer 中，也不需要该代码。

我认为您真正的问题是关于如何正确布局 GridView，因为 Visual Studio 11 beta（来自消费者预览版）中包含的模板在那里做得非常糟糕。

尝试这个：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="140"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <Grid>
      <!-- Back button and page title go here -->
    </Grid>

    <GridView x:Name="itemsGridView" Grid.Row="1"
            AutomationProperties.AutomationId="ItemsGridView"
            AutomationProperties.Name="Items"
            ItemsSource="{Binding MyListOfSItems}"
            ItemTemplate="{StaticResource myItemTemplate}">
        <GridView.ItemsPanel>
            <ItemsPanelTemplate>
                <WrapGrid x:Name="itemGridViewPanel" Margin="116,53,116,46"/>
            </ItemsPanelTemplate>
        </GridView.ItemsPanel>
    </GridView>

</Grid> 
```

现在只有一个ScrollViewer，即GridView中的那个，所以两个ScrollViewer相互嵌套没有冲突，一个ScrollViewer自动处理鼠标。

另外，边距是正确的，但是当滚动项目时允许移动到边距区域。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-27T03:46:26.613

这对我来说很好：

```
<SemanticZoom>
    <SemanticZoom.ZoomedInView>
        <GridView>
            <GridView.ItemContainerStyle>
                <Style
                    TargetType="GridViewItem">
                    <Setter
                        Property="Width"
                        Value="250" />
                    <Setter
                        Property="Height"
                        Value="250" />
                    <Setter
                        Property="FontSize"
                        Value="32" />
                </Style>
            </GridView.ItemContainerStyle>
            <GridViewItem
                Content="Apple"/>
            <GridViewItem
                Content="Banana" />
            <GridViewItem
                Content="Cherry" />
            <GridViewItem
                Content="Donut" />
            <GridViewItem
                Content="Eggplant" />
            <GridViewItem
                Content="Fig" />
            <GridViewItem
                Content="Grape" />
            <GridViewItem
                Content="Ham" />
            <GridViewItem
                Content="Ice Cream" />
            <GridViewItem
                Content="Jam" />
            <GridViewItem
                Content="Kale" />
            <GridViewItem
                Content="Lemon" />
            <GridViewItem
                Content="Muffin" />
            <GridViewItem
                Content="Nut" />
            <GridViewItem
                Content="Orange" />
            <GridViewItem
                Content="Pear" />
            <GridViewItem
                Content="Raspberry" />
            <GridViewItem
                Content="Steak" />
            <GridViewItem
                Content="Turkey" />
            <GridViewItem
                Content="Udon" />
            <GridViewItem
                Content="Vodka" />
            <GridViewItem
                Content="Wine" />
            <GridViewItem
                Content="Xanthan Gum" />
            <GridViewItem
                Content="Yam" />
            <GridViewItem
                Content="Zucchini" />
        </GridView>
    </SemanticZoom.ZoomedInView>
    <SemanticZoom.ZoomedOutView>
        <GridView
            ItemsSource="ABCDEFGHIJKLMNOPQRSTUVWXYZ">
            <GridView.ItemContainerStyle>
                <Style
                    TargetType="GridViewItem">
                    <Setter
                        Property="Width"
                        Value="400" />
                    <Setter
                        Property="Height"
                        Value="100" />
                    <Setter
                        Property="FontSize"
                        Value="72" />
                </Style>
            </GridView.ItemContainerStyle>
        </GridView>
    </SemanticZoom.ZoomedOutView>
</SemanticZoom> 
```

# php - 会话到期时如何自动删除表的所有记录

> ID：10737659
> 
> 赞同：1
> 
> 时间：2012-05-24T12:37:51.123
> 
> 标签：php, mysql

您能否告诉我当用户会话到期或用户关闭浏览器时如何删除下表中的所有记录。

表名：测试

```
id  sessions_id     value
1    admin_1         12 
2    admin_1         12 
```

我知道临时表，但我不想使用它......因为我在创建表的某个时间后无法获取数据。

谢谢 ：）

我试过的：

```
 function logout(){

   //My query to delete the table
    $this->session->sess_destroy();
   redirect('login');

  } 
```

上面的解决方案工作正常，但我想知道如果任何用户没有注销会发生什么......只是简单地关闭窗口。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T12:40:23.363

尝试这个：

*   在表格中添加一`timestamp`列
*   在每一页上，`UPDATE`此列带有与当前用户相关的每一行的当前时间戳
*   使用一个`cron`调用 PHP 脚本，在该脚本中，您每小时都会查看`DELETE`时间戳太旧的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:44:08.633

快速阅读[http://www.tonymarston.net/php-mysql/session-handler.html](http://www.tonymarston.net/php-mysql/session-handler.html)。它解释了如何在数据库中保存会话并为您提供完整的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T13:24:24.707

```
 <?php 

  // $sessions_id is your session id

      if(empty($sessions_id) == true ){

    //execute query 

      // for ex   delete from test where sessions_id = '$sessions_id';     

     }

     ?> 
```

# applescript - 选择多个项目时的 Aperture 项目 ID

> ID：10737660
> 
> 赞同：2
> 
> 时间：2012-05-24T12:37:53.067
> 
> 标签：applescript

我正在尝试获取库中多个选定项目的项目 ID。当仅选择一个项目时，还会在浏览器中选择一个图像版本，因此我可以通过以下方式访问 id：

```
tell application "Aperture"
    tell item 1 of (selection as list) to set projId to parent's id
end tell 
```

However, when multiple projects are selected, no image version is selected in the browser so the above will not work. 我知道我可以求助于 UI 来选择一张图片，然后循环提取 id，但我想避免这样做。

```
activate application "Aperture"
tell application "System Events"
    tell process "Aperture"
        keystroke (ASCII character 29) -- Right
    end tell
end tell 
```

在 Aperture 中获取所选项目或项目的项目 ID 的最佳方法是什么？

# probability - 概率不均匀时的马尔可夫熵

> ID：10737664
> 
> 赞同：0
> 
> 时间：2012-05-24T12:38:06.173
> 
> 标签：probability, entropy, information-theory, markov

我一直在考虑马尔可夫方程的信息熵：

H = -SUM(p(i)lg(p(i))，其中 lg 是以 2 为底的对数。

这假设所有选择 i 具有相等的概率。但是，如果给定的一组选择中的概率不相等怎么办？例如，假设 StackExchange 有 20 个站点，并且用户访问除 StackOverflow 之外的任何 StackExchange 站点的概率为 p(i)。但是，用户访问 StackExchange 的概率是 p(i) 的 5 倍。

马尔可夫方程在这种情况下不适用吗？还是有我不知道的高级马尔可夫变体？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:56:56.967

从您的示例中，您是否在考虑[马尔可夫链](http://en.wikipedia.org/wiki/Markov_chain)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T02:23:09.243

我相信您混淆了两个概念：熵和马尔可夫方程。熵测量状态分布的“无序”，使用您给出的方程：H = -SUM(p(i)lg(p(i))，其中 p(i) 是观察每个状态 i 的概率。

马尔可夫属性并不意味着每个状态都具有相同的概率。粗略地说，如果观察一个状态的概率仅取决于观察几个先前的状态，则可以说一个系统表现出马尔可夫特性——在某个限制之后，您观察到的额外状态不会为预测下一个状态添加任何信息。

原型马尔可夫模型被称为马尔可夫链。它表示从每个状态 i，您可以以另一个概率移动到任何状态，表示为概率矩阵：

0 1 2
0 0.2 0.5 0.3
1 0.8 0.1 0.1
2 0.3 0.3 0.4

在此示例中，从状态 0 移动到 1 的概率为 0.5，并且仅取决于处于状态 0（了解更多关于先前状态的信息不会改变该概率）。

只要可以从任何状态开始访问所有状态，无论初始分布如何，处于每个状态的概率都会收敛到稳定的长期分布，并且在“长序列”上，您将观察每个状态具有稳定的概率，每个状态不一定相等。

在我们的示例中，我们最终会得到概率 p(0)、p(1) 和 p(2)，然后您可以使用您的公式计算该链的熵。

# xcode - 从自定义单元格转到新视图

> ID：10737671
> 
> 赞同：1
> 
> 时间：2012-05-24T12:38:30.547
> 
> 标签：xcode, ios5, uitableview, storyboard, xib

我创建了一个自定义表格，我可以在其中垂直滚动项目列表，但我也可以左右滚动这些垂直索引。我将如何移动到新视图（在故事板中）？

有谁知道如何以编程方式将自定义单元格中的 segue 添加到新视图中？

这是我创建自定义单元格的代码：

```
static NSString *CellIdentifier = @"ArticleCell";

__block ArticleCell_iPhone *cell = (ArticleCell_iPhone *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier]; 
```

这是我的自定义表格的截图：http: [//i200.photobucket.com/albums/aa42/mininukinfuts/ScreenShot2012-05-24at145417.png](http://i200.photobucket.com/albums/aa42/mininukinfuts/ScreenShot2012-05-24at145417.png)

这是我正在关注的教程的链接：[http ://www.raywenderlich.com/4723/how-to-make-an-interface-with-horizo​​ntal-tables-like-the-pulse-news-app-part -2](http://www.raywenderlich.com/4723/how-to-make-an-interface-with-horizontal-tables-like-the-pulse-news-app-part-2)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T09:06:06.540

为了解决这个问题，我必须将以下代码添加到我的 didSelectRowAtIndexPath 方法中：

```
 musicTime *MP  = [self.sb instantiateViewControllerWithIdentifier:@"playMusic"];
 [self.navCon pushViewController:MP animated:YES]; 
```

我给了我的新视图上面的标识符，然后在我的 .h 中我有：

```
@interface HorizontalTableCell_iPhone : HorizontalTableCell  {
musicTime *Music;
UINavigationController *navCon;
UIStoryboard *sb;
}
@property (nonatomic, retain) musicTime *Music;
@property (nonatomic, retain) UINavigationController *navCon;
@property (nonatomic, retain) UIStoryboard *sb;
@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:01:35.530

我假设您有一个表格视图控制器并将表格视图单元格子类化。

如果您将表格视图单元格子类化，您应该只需要直接从表格视图设置 segue 并传递必要的变量。

分配单元格标识符并设置表格视图单元格类后，只需从每个表格视图单元格按 ctrl+拖动到下一个视图并设置 segue。

# gwt - 共享 GWT 模块中的图像资源（类似小部件）

> ID：10737674
> 
> 赞同：0
> 
> 时间：2012-05-24T12:38:41.273
> 
> 标签：gwt

我在 GWT 中有许多代表图形的类`widgets`。它们被打包为一个`GWT`名为`GWT-Toolbox`. 这个模块现在只有客户端代码。这意味着，所有这些类主要是布局、窗口，我与其他类`GWT-apps`（单独的模块）一起重用。

目前，我这样做的方式是我所有的其他人都`GWT-apps`继承了这个`GWT-Toolbox`模块。

*这是正确的做法吗？*

我的主要问题是关于`images resources`. 我想在`GWT-Toolbox`模块中使用一些将共享的图像`GWT-apps`。

我能做到什么？我不想使用`ClientBundle`，因为它不符合我的需要。

*我在哪里放置我的资源文件，以及它们将如何打包在`GWT-apps`?*

作为记录，我使用的是 GWT 2.4

## 编辑

因此，在社区的帮助下，我想出了如何进行。请注意，此解决方案不使用`ClientBundle`.

**GWT-Toolbox** - 这是文件结构

-src/main/java
--- com.mypackage.toolbox
------ 公共
--------- 图片
------------ img1.png
---- -------- img2.png
--------- GWT-Toolbox.gwt.xml

在 GWT-Toolbox 源代码中，请参考以下图像：

```
GWT.getModuleBaseURL() + "images/img1.png" 
```

就是这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:47:12.673

> 这是正确的做法吗？

绝对地; 这实际上与`com.google.gwt.user.User`模块中的小部件没有什么不同。（提供*继承*手段`<inherits/>`，并将 GWT-Toolbox JAR 放在类路径中）

> 我在哪里放置我的资源文件，以及它们将如何打包到 GWT-apps 中？

您可以将它们作为简单资源放入您的 JAR 中，以便其他模块可以`ClientBundle`通过在`@Source`.
或者您将它们放在模块的`public`子文件夹中（确切地说，是模块的*公共路径*，子文件夹名称默认为但实际上是可配置的），因此它们与编译文件`public`并排部署（这是*主题*`*.cache.*`如何在 GWT 中工作）。

# java - 在 Java 泛型中，List 是什么意思？

> ID：10737675
> 
> 赞同：12
> 
> 时间：2012-05-24T12:38:44.597
> 
> 标签：java, generics

谁能解释这两者如何编译以及它是如何工作的？

```
List<? super String> list = new ArrayList<Object>(); 
```

据我了解，它的实现需要是一个字符串列表或一个将字符串作为超类的对象列表？我错过了什么吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-24T12:40:29.813

不（即是的，你错过了一些东西:-)。`<? super String>`是任何属于（包括它自己）的*超类的类。*（在这种情况下，唯一合适的类是。）`String``String``Object`

您所描述的将是`<? extends String>`（在这种特定情况下，它不会很有用`String`，`final`因此它可以没有子类）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T12:41:14.243

`<? super String>`接受`String`和任何*超类*。

不要混淆：

`<? extends String>`接受`String`和任何子*类*（其中没有任何因为`String`is `final`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T12:42:19.873

由于`String`is `final`，它不能是任何其他类的超类。`List<? super String>`表示作为 . 的超类的任何类型`String`。事实上，`Object`是一个超类`String`（实际上是任何类）。

# machine-learning - 使用 SVM-light 训练分类器以进行目标检测

> ID：10737678
> 
> 赞同：-2
> 
> 时间：2012-05-24T12:38:49.337
> 
> 标签：machine-learning, svm, object-detection

我正在使用 SVM-light。我想使用 SVM-light 来训练分类器进行对象检测。我想出了开始训练的语法：

```
 svm_learn example2/train_induction.dat example2/model 
```

我的问题：如何从一组正面和负面图片中构建“train_induction.dat”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:00:01.910

这个问题有两个部分：

*   在带有 SVM 的图像中，我应该使用什么特征表示来进行对象检测？

*   如何使用（任何特征表示）创建 SVM-light 数据文件？

有关第一个问题的介绍，请参阅[Wikipedia's outline](http://en.wikipedia.org/wiki/Outline_of_object_recognition#Feature-based_methods)。基于[SIFT](http://en.wikipedia.org/wiki/Scale-invariant_feature_transform)或有时[SURF](http://en.wikipedia.org/wiki/Speeded_Up_Robust_Features)或[HOG特征](http://en.wikipedia.org/wiki/Histogram_of_oriented_gradients)[的词袋](http://en.wikipedia.org/wiki/Bag_of_words_model_in_computer_vision)模型是相当标准的。

其次，这在很大程度上取决于您要使用的语言/库。[可以使用OpenCV](http://opencv.willowgarage.com/wiki/)、[vlfeat](http://opencv.willowgarage.com/wiki/)或许多其他工具从图像中提取特征。然后，您可以将这些功能转换为[SVM-light 主页](http://svmlight.joachims.org/)所述的 SVM-light 格式（该页面上没有锚点；搜索“输入文件”）。

如果您更新您想要使用的语言和库，我们可以提供更具体的建议。

# tsql - T-SQL 中的 XML 命名空间

> ID：10737680
> 
> 赞同：1
> 
> 时间：2012-05-24T12:39:06.500
> 
> 标签：tsql, sql-server-2005, xml-namespaces

如果命名空间在所有元素中都有前缀，您将如何编写 t-sql 查询？我已经尝试了很多变化，这就是我到目前为止所得到的，但它只是不起作用......

```
DECLARE @x xml 
SET @x = (SELECT xml_data_column FROM dbo.Table
WHERE xmlFileName = 'E:\trnFile.xml'  )
;WITH XMLNAMESPACES('http://schemas.xmlsoap.org/soap/envelope/' AS [soap]
, 'tns:RetrievePurchaseResponse  xmlns:tns="urn:Transaction"' AS tns) 
SELECT t.c.value('orderRef[1]', 'int') orderReference
, t.c.value('orderNumber[1]', 'varchar(100)') orderNumber
, t.c.value('subtotal[1]', 'varchar(100)') subtotal
FROM  @x.nodes('/soap:Envelope/soap:Body/tns:RetrievePurchaseResponse/tns:purchase') AS t(c) 
```

协助将不胜感激！

这是 XML 输入文件：

```
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
<SOAP-ENV:Body>
<tns:RetrievePurchaseResponse xmlns:tns="urn:Transaction">
  <tns:purchase>
    <tns:orderRef>10027</tns:orderRef>
        <tns:orderNumber>425816</tns:orderNumber>
        <tns:subtotal>95.00</tns:subtotal>
</tns:purchase>
    </tns:RetrievePurchaseResponse>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

预期输出为

```
orderReference,     orderNumber,    orderUserEmail
10027,      425816,              user@domain.com 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:45:05.537

```
DECLARE @x xml

SET @x = (
  SELECT xml_data_column 
    FROM dbo.Table 
   WHERE xmlFileName = 'E:\trnFile.xml'
);

WITH XMLNAMESPACES(
  'urn:Transaction' AS tns
) 
SELECT 
  t.c.value('tns:orderRef[1]', 'int') orderReference
, t.c.value('tns:orderNumber[1]', 'varchar(100)') orderNumber
, t.c.value('tns:subtotal[1]', 'varchar(100)') subtotal
FROM  
  @x.nodes('//tns:RetrievePurchaseResponse/tns:purchase') AS t(c) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T13:47:08.547

```
declare @x xml 
set @x = '
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
  <SOAP-ENV:Body>
    <tns:RetrievePurchaseResponse xmlns:tns="urn:Transaction">
      <tns:purchase>
        <tns:orderRef>10027</tns:orderRef>
        <tns:orderNumber>425816</tns:orderNumber>
        <tns:subtotal>95.00</tns:subtotal>
      </tns:purchase>
    </tns:RetrievePurchaseResponse>
  </SOAP-ENV:Body>
</SOAP-ENV:Envelope>';

with xmlnamespaces('urn:Transaction' as tns) 
select
  @X.value('(//tns:RetrievePurchaseResponse/tns:purchase/tns:orderRef)[1]', 'int') orderReference,
  @x.value('(//tns:RetrievePurchaseResponse/tns:purchase/tns:orderNumber)[1]', 'int') orderNumber,
  @x.value('(//tns:RetrievePurchaseResponse/tns:purchase/tns:orderUserEmail)[1]', 'varchar(100)') orderUserEmail 
```

# java - 减去两天并仅计算工作日（无周六或周日）

> ID：10737685
> 
> 赞同：1
> 
> 时间：2012-05-24T12:39:09.777
> 
> 标签：java, date

我正在寻找能够为我提供以下能力的外部 JAR 或方法：

1.  减去两个日期。
2.  将假期定义为周六和周日，或者周五和周六。
3.  计算有假期或没有假期的差异。

在我进行公历计算之前，任何人都可以推荐一个外部 JAR 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:55:59.617

看看[这个网站](http://www.developerfusion.com/code/5734/calculate-the-difference-between-two-dates-ignoring-weekends/)，他们为您提供了一个 java 程序，可以帮助您：

> wdnum() 方法返回自 1969 年 12 月 29 日星期一以来经过的工作日数（不包括周末）。它的工作原理是计算自 1970 年 1 月 1 日以来的天数（getTime() 除以一天中的毫秒数)，加上 3 并返回整周的周天数，也可能是从那时起过去的部分周。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T13:31:04.300

看看[Joda Time](http://joda-time.sourceforge.net/index.html)，它可能对您尝试做的事情有所帮助。

但是，您很可能必须使用 Calendar 类中的方法（例如 getTimeInMillis() ）来减去 Calendar 类中的日期和字段，例如 Calendar.DAY_OF_WEEK 或 Calendar.DAY_OF_MONTH 以确定一周中的哪一天如果您想从计算中排除一周中的某些天。

# exchangewebservices - 交换 EWS ItemClass 值

> ID：10737693
> 
> 赞同：4
> 
> 时间：2012-05-24T12:39:28.093
> 
> 标签：exchangewebservices

我进行了很多搜索，但找不到[ItemClass](http://msdn.microsoft.com/en-us/library/aa580993%28v=exchg.80%29.aspx)类型可以采用的常见文本值。

我知道可以有自定义值（如`IPM.Note.Custom.MyClass`），但常见值（如`IPM.Note`,`IPM.Contact`等）是否记录在某处？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T13:50:33.820

**项目类型**和**消息类**记录[在 MSDN 上](http://msdn.microsoft.com/en-us/library/office/ff861573.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T15:48:15.203

我一直在寻找同样的东西。SilverNinjas 链接不再起作用。

我在[这里](http://msdn.microsoft.com/en-us/library/office/bb176446%28v=office.12%29.aspx)找到了。

# jquery - 了解 jQuery AJAX 事件——成功和 ajaxSuccess

> ID：10737696
> 
> 赞同：7
> 
> 时间：2012-05-24T12:39:47.033
> 
> 标签：jquery, ajax, events

[需要一些帮助来理解此处](http://docs.jquery.com/Ajax_Events)`success`记录的事件和`ajaxSuccess`事件之间的区别。

`success`是本地事件，`ajaxSuccess`而是全局事件。我了解局部变量和全局变量之间的区别，但在理解事件范围的概念时遇到了一些麻烦。

有哪些示例场景会优先于另一种？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T12:51:25.097

您可以这样使用全局事件：

```
$.ajaxSuccess(function(){
//do my global thing here
}); 
```

因为每次ajax调用成功都会触发全局事件，而不仅仅是一个。

但是

```
success: function(){/* do local here */}); 
```

仅在本地 ajax 调用函数中作为其私有对象触发。

注意

```
$.ajaxComplete(function(){ }); 
```

可能是您所追求的，因为它完全触发 - 有或没有错误。

编辑：`success:`ajaxSetup 全局中本地的特别说明：（不建议这样做，您应该使用`$.ajaxSuccess`）

```
$.ajaxSetup({
    success: function() {
       // local within the ajaxSetup
    }
}); 
```

现在，我们为什么要使用一个而不是另一个？也许您需要对返回的对象进行特殊过滤：

```
$(selector1).ajax({
    success: function(data){
        processMySelector1JSON(data);
    }
});
$(selectorOther).ajax({
    success: function(data){
        processMySelectorOtherJSON(data);
    }
});
$.ajaxSuccess(function(){
  $('#message').text('Ajax Done!').fadeIn(function(){$(this).fadeOut();});
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T13:00:32.283

`success: function()`更好，因为仅在请求成功时才调用此事件。它检查来自服务器的错误，并且数据错误使其变得更好。

# sql-server - 高级 SQL Server 存储过程？

> ID：10737704
> 
> 赞同：-1
> 
> 时间：2012-05-24T12:40:18.823
> 
> 标签：sql-server, stored-procedures

我的数据库中有一张表，我想每年更新一次。我需要从我的 asp.net 页面中提取两个列值，并已经从我的数据库中填充其余列值。

我有一个每年的预算表，年份会根据一年中的月份在我的页面上自动更新。当月份更改为特定月份时，我需要存储过程自行更新以添加具有空白金额的预算项目，以便我可以手动输入金额。

旧数据：

```
Year Code1 Code1Description Code2 Code2Description BudgetAmt($750.00) Initials 
```

新数据：

```
NewYear Code1 Code1Description Code2 Code2Description BudgetAmt($0.00) Initials 
```

这样，当我在我的 gridview 上进入编辑模式时，代码将已经存在，只是空白*`budgetamt`*供我更新。这有意义吗？这是可能的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:15:04.943

你让网页调用存储过程？在这种情况下，只需创建一个包含您要填充的项目代码的表：

```
ALTER PROCEDURE [dbo].[stp_TemplateSPROC]
(@year as int) AS
    INSERT tbl_webpage (Year, code1, code1desc, code2, code2desc, spending, Initials) 
      Select 
         @Year [Year], code1, code1desc, code2, code2desc, 
         0 as spending, '' as Initials
      from tablewithcodesin 
```

这在调用时会填充一个包含年份、代码和零/空白的表格供您填写。

tablewithcodesin 将只是 Code1 Code1Description Code2 Code2Description

# servlets - JSF 2.0 登录 + 设置用户主体

> ID：10737711
> 
> 赞同：1
> 
> 时间：2012-05-24T12:40:51.973
> 
> 标签：servlets, jsf-2, login

我正在尝试使用 jsf 2.0 表单对用户进行身份验证。我还想创建 UserPrincipals。我认为使用 HttpServletRequest.login 方法可以创建一个新的 UserPrincipal。 [http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html)

我所做的是：

配方：

```
 <h:form>
        <h:outputLabel value="Name" for="name"/>
        <h:inputText id="name" value="#{userMng.user.name }"/>
        <br/>
        <h:outputLabel value="Passwort" for="pw"/>
        <h:inputSecret id="pw" value="#{userMng.user.password }"/>
        <br/>
        <h:commandButton type="submit" value="Submit" action="#{ userMng.login }"/>
    </h:form> 
```

UserMng（sessionscoped）：登录方式：

```
public String login() {
        String ret = "error";
        if (user.getName().equals("test") && user.getPassword().equals("test") ) {
            FacesContext context = FacesContext.getCurrentInstance();
            HttpServletRequest request = (HttpServletRequest) context.getExternalContext().getRequest();

        try {
            request.login(this.user.getName(), this.user.getPassword());
            LOGGER.info("Login the user");
            ret = "success";
//          this.user = userDAO.find(this.username, this.password);
        } catch (ServletException e) {
            // Handle unknown username/password in request.login().
            context.addMessage(null, new FacesMessage("Unknown login"));
        }
    }
    LOGGER.info(ret);
    return ret;
} 
```

但是，当我想在登录后打印 UserPrincipal.getName 时，我会在调用时收到 NullpointerException：

```
request.getUserPrincipal().getName(); 
```

那么我的代码或成功登录后创建新 UserPrincipal 的方式有什么问题？

最好的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T13:35:27.283

用户主体仅在登录后的后续请求中可用。您需要在登录后发送重定向以强制浏览器创建新请求。

```
ret = "success?faces-redirect=true"; 
```

在视图中打印用户名时，最好使用 EL。已[`HttpServletRequest`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html)在 EL 中提供`#{request}`。

```
<p>Welcome #{request.userPrincipal.name}!</p> 
```

或者只是捷径

```
<p>Welcome #{request.remoteUser}!</p> 
```

# asp.net - 从数据库中获取值并传递到另一个页面

> ID：10737714
> 
> 赞同：-1
> 
> 时间：2012-05-24T12:41:00.390
> 
> 标签：asp.net

好的，我不知道我的问题是否有意义，但我会尽力描述这一点。

我正在做一个学校项目，我有一个存储“项目”的数据库，字段包括 ProjectID、名称、出版物、状态等。

我还有另一个名为 Publications 的表，其中存储了 ID、PublicationType、ProjectID、Description 等。

在项目页面上，我可以选择添加一个新项目，它还显示当前项目的网格视图，如果您单击它们的名称，它会将您带到一个页面，您可以在其中为该项目添加出版物。我通过值为 Publications.aspx?ProjectID={0} 的 HyperLinkField 传递 ProjectID 的值

当我被重定向到出版物页面时，URL 中会出现 ProjectID，但是，当我尝试插入我的出版物、名称、类型和 ProjectID 时，我的数据库中的 ProjectID 字段为空。

我在设计视图中执行此操作，但这里是出版物页面的插入和选择语句。

```
SELECT ProjectID, PubType, PubDescription, PubDetail, PubLink FROM Publications WHERE (ProjectID = ProjectID)

INSERT INTO Publications(ProjectID, PubType, PubDescription, PubDetail, PubLink) VALUES (ProjectID, ?, ?, ?, ?) 
```

我 100% 确定这是一个逻辑错误，但我不确定如何修复它。我会很感激一些帮助，最好是通过设计界面，但如果需要，我不介意做一些编码。

谢谢！~

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:07:10.660

尝试这样的事情

```
SelectCommand="ProjectID, PubType, PubDescription, PubDetail, PubLink FROM Publications WHERE ProjectID = @prodID" 
```

并添加一个选择参数

```
<SelectParameters>
    <asp:QueryStringParameter Name="prodID" QueryStringField="ProjectID " />
</SelectParameters> 
```

# android - 实现菜单按钮单击扩展 PopupWindow 的类

> ID：10737717
> 
> 赞同：0
> 
> 时间：2012-05-24T12:41:02.770
> 
> 标签：android, popupwindow, popupmenubutton

问题很简单：

如何捕捉从 PopupWindow 扩展的类上的菜单按钮的点击？

我现在正在做的事情如下：

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event)
{
    if (keyCode == KeyEvent.KEYCODE_MENU)
    {
        if (ab != null) {
            ab.showActionOverflowMenu();
        }
    }
    return true;
} 
```

ab.showActionOverflowMenu() 执行以下操作：

```
public boolean showActionOverflowMenu() {
    if (actions.size() >= 4) {
        try {
            if (ag.isVisible()) {
                ag.dismiss();
            } else {
                showActionOverflow();
                return true;
            }
        } catch (Exception e) {
            showActionOverflow();
            Log.d("click", "click");
            return true;
        }
    }
    return false;
} 
```

showActionOverflow() 只是设置弹出窗口并将其附加到按钮上。

tl；博士模式：我希望菜单按钮关闭或显示弹出窗口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:58:19.983

您无法在 PopupWindow 及其扩展程序中捕获菜单事件。

但是，您可以在启动弹出窗口的 Activity 中捕获菜单事件，然后将其分派到弹出窗口。

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event)
{
    if (keyCode == KeyEvent.KEYCODE_MENU)
    {
        yourPopupWindow.menuClicked();
    }

    return super.onKeyDown(keyCode, event);
} 
```

# tfs - 如果两个字段具有特定值，则在 TFS 中分配用户

> ID：10737718
> 
> 赞同：4
> 
> 时间：2012-05-24T12:41:06.100
> 
> 标签：tfs, tfs-process-template

使用附加信息更新问题，因为解决方案不适用。

对不起，我将不得不再次问这个问题。我的目标是为“分配给”字段实现一些 TFS 自动化。该字段将被填充模块中的某些值，并且选择类别字段。

有没有办法在 TFS WI XML 中创建一个“与”运算符来处理这个问题？几个月前我问了这个问题并得到了答案。不幸的是，由于管道中出现了几个项目，我没有时间实施它。当我尝试实施解决方案并导入 WIT 时，TFS 会抛出“WHEN”具有无效的子元素“WHEN”错误。

例子：

`If "Module" field = value X and "Platform" field = value Y, then "Assigned to" field is set to specific user`

给定的解决方案不起作用：

`<FIELD name="QA Owner" refname="<QAOwnerFieldReference>" type="String">
<VALIDUSER />
<WHEN field="<ModuleReferenceName>" value="Compliance">
<WHEN field="<AnotherFieldName>" value="SomeValue">
<DEFAULT from="value" value="<QATester>" />
</WHEN>
</WHEN>
</FIELD>`

我确实有一个想法，是否可以将第二个“WHEN”条件与第一个合并，这样：

`<WHEN field="<ModuleReferenceName>" value="Compliance" && WHEN field="<AnotherFieldName>" value="SomeValue">`

链接到上一篇文章：[如果两个字段具有特定值，则在 TFS 中分配用户](https://stackoverflow.com/questions/10737718/assigning-users-in-tfs-if-two-fields-have-specific-values)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T05:04:55.650

您需要做的是**级联**两个条件，以创建一个**和**效果。不理想，但你会怎么做:)

您的 WIT 字段定义如下所示：

`<FIELD name="QA Owner" refname="<QAOwnerFieldReference>" type="String">
<VALIDUSER />
<WHEN field="<ModuleReferenceName>" value="Compliance">
<WHEN field="<AnotherFieldName>" value="SomeValue">
<DEFAULT from="value" value="<QATester>" />
</WHEN>
</WHEN>
</FIELD>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-15T16:23:23.317

我能找到的唯一可行的解​​决方案是创建一个**自定义控件，该控件**将在保存工作项*之前处理一组规则。*

查看 Gregg Boer 的博客，了解[创建 WI 自定义控件的简短指南](http://blogs.msdn.com/b/greggboer/archive/2010/03/30/work-item-tracking-custom-controls.aspx)。请注意，这需要安装在*每个*桌面客户端的机器上。

请注意，您需要为*BeforeUpdateDatasource*事件编写一个处理程序。

此外，如果您需要它在 Web 上运行，您需要创建一个 Web 访问自定义控件（请参阅 Ewald Hoffman关于 WA 控件的[帖子）。](http://www.ewaldhofman.nl/post/2010/08/10/Create-custom-work-item-control-for-TFS-Web-Access-2010-%28TWA%29.aspx)

# android - 本机堆跟踪问题 - “本机堆”选项卡为空

> ID：10737722
> 
> 赞同：5
> 
> 时间：2012-05-24T12:41:15.063
> 
> 标签：android, memory, native, ddms

我想在我的应用程序中跟踪本机堆。

正如我在教程中看到的那样，我从 /tools sdk 的文件夹中打开了 DDMS，并且确实看到了“Native Heap”选项卡。

但是，当我按下“更新堆”图标时，本机堆仍然是空的 - 我在那里看不到任何信息。

尝试在两台设备上，其中一台已植根。

我该如何解决这个问题？

谢谢！

截屏：

![在此处输入图像描述](../Images/4f5230768476718ec86a9b6d636aa12e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T10:25:29.763

May be [http://bricolsoftconsulting.com/how-to-enable-native-heap-tracking-in-ddms/](http://bricolsoftconsulting.com/how-to-enable-native-heap-tracking-in-ddms/) can help... I tried and succeded with rooted phone as well as emulator.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:44:19.897

我遇到了同样的问题并设法使用模拟器进行修复。我不得不把一个文件放在 /data 中`local.prop`，用`libc.debug.malloc = 1`. 比我不得不关闭并再次启动模拟器。可能它也可以与有根的手机一起使用（我在猜测）。

# php - 将分页添加到 PHP/mySQL 列表

> ID：10737725
> 
> 赞同：0
> 
> 时间：2012-05-24T12:41:21.123
> 
> 标签：php, mysql, pagination

我有一个 php/mysql 列表，我可以在其中显示很多缩略图。

我的问题是一页中显示的图像太多。我想把它分开，这样我就可以得到一些页面链接或底部的东西？

喜欢：1,2,3,4,5,6,7,8 或下一个和上一个...

这是当前代码：

```
<?php
    if ($db_found) {
        $SQL = "SELECT * FROM myTable";
        $result = mysql_query($SQL);

        while ($db_field = mysql_fetch_assoc($result)) {
            echo '<li>';
            echo '<div class="thumb"><img src="images/thumbnails/'.$db_field['image'].'" alt="" /></a></div>';
            echo '</li>';
        }
        mysql_close($db_handle);
    }
?> 
```

如何在此处添加一些页面链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T13:00:35.263

使用 Jquery 更容易，但我建议你从 PHP 开始，它只能开发你的头脑，而不是添加一些 JQuery 代码会让你得到一切。无论如何，使用 PHP 进行简单的分页就是这样，学习这段代码的关键是理解：intval,LIMIT,mysql_num_rows,mysql_fetch_assoc,mysql_fetch_row,ceil,COUNT 在你学会每一个之后，代码会很容易理解，你可以开发它并添加一些您自己的改进。这个优秀网站的功劳：[PHPGuide](http://phpguide.co.il/index.php)

```
 $per_page = 5; 
 $page = 1;

 if (isset($_GET['page'])) 
 {
  $page = intval($_GET['page']); 
  if($page < 1) $page = 1;
}

 $start_from = ($page - 1) * $per_page; 

 mysql_connect(..);
 mysql_select_db(..);

 $current_items = mysql_query( "SELECT * FROM `test` LIMIT $start_from, $per_page");
 if( mysql_num_rows($current_items) > 0)
 {
  while($item = mysql_fetch_assoc($current_items))
  {
    echo $item['text'], '<br/>';
  }
 }
 else
 {
  echo 'this page does not exists'; 
 }

 $total_rows = mysql_query("SELECT COUNT(*) FROM `test`");
 $total_rows = mysql_fetch_row($total_rows);
 $total_rows = $total_rows[0];

 $total_pages = $total_rows / $per_page;
 $total_pages = ceil($total_pages); # 19/5 = 3.8 ~=~ 4

 for($i = 1; $i  <= $total_pages; ++$i)
 {
  echo "<a href='?page=$i'>$i</a> &nbsp;&nbsp;";
 } 
```

该代码非常易于理解且非常简单。关于 prev 和 forward 页面，这是您在获得此代码后将要做的改进之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:50:47.093

```
<?php
    $per_page = 20;
    $start=0; 

    if(isset($_GET['pagenum']))
      {
      $pagenum=$_GET['pagenum'];
      $start=($pagenum*$per_page)
      }
    if ($db_found) {
        $SQL = "SELECT * FROM myTable  Limit $start , $per_page";
        $result = mysql_query($SQL);
        $count = mysql_num_rows($result);
        $pages = ceil($count/$per_page)
        while ($db_field = mysql_fetch_assoc($result)) {
            echo '<li>';
            echo '<div class="thumb"><img src="images/thumbnails/'.$db_field['image'].'" alt="" /></a></div>';
            echo '</li>';
        }
        mysql_close($db_handle);
    }

    //Create you links here 
    for($pagenum=1; $pagenum<=$pages; $pagenum++)
    {
     echo '<a href="'.$pagenum.'">'.$pagenum.'</a>';
    }
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T12:59:51.020

您必须修改查询并为其提供参数，

在这一行：

```
$SQL = "SELECT * FROM myTable"; 
```

使用这样的东西

```
jcho360> select * from actor limit 0,5;
+----------+------------+--------------+---------------------+
| actor_id | first_name | last_name    | last_update         |
+----------+------------+--------------+---------------------+
|        1 | PENELOPE   | GUINESS      | 2006-02-15 04:34:33 |
|        2 | NICK       | WAHLBERG     | 2006-02-15 04:34:33 |
|        3 | ED         | CHASE        | 2006-02-15 04:34:33 |
|        4 | JENNIFER   | DAVIS        | 2006-02-15 04:34:33 |
|        5 | JOHNNY     | LOLLOBRIGIDA | 2006-02-15 04:34:33 |
+----------+------------+--------------+---------------------+
5 rows in set (0.00 sec)

jcho360> select * from actor limit 5,5;
+----------+------------+-----------+---------------------+
| actor_id | first_name | last_name | last_update         |
+----------+------------+-----------+---------------------+
|        6 | BETTE      | NICHOLSON | 2006-02-15 04:34:33 |
|        7 | GRACE      | MOSTEL    | 2006-02-15 04:34:33 |
|        8 | MATTHEW    | JOHANSSON | 2006-02-15 04:34:33 |
|        9 | JOE        | SWANK     | 2006-02-15 04:34:33 |
|       10 | CHRISTIAN  | GABLE     | 2006-02-15 04:34:33 |
+----------+------------+-----------+---------------------+
5 rows in set (0.00 sec)

jcho360> select * from actor limit 10,5;
+----------+------------+-----------+---------------------+
| actor_id | first_name | last_name | last_update         |
+----------+------------+-----------+---------------------+
|       11 | ZERO       | CAGE      | 2006-02-15 04:34:33 |
|       12 | KARL       | BERRY     | 2006-02-15 04:34:33 |
|       13 | UMA        | WOOD      | 2006-02-15 04:34:33 |
|       14 | VIVIEN     | BERGEN    | 2006-02-15 04:34:33 |
|       15 | CUBA       | OLIVIER   | 2006-02-15 04:34:33 |

+----------+------------+-----------+---------------------+ 
```

因此，当您单击下一步/返回时，您将参数提供给查询，您将获得分页

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T13:00:01.520

1.  运行 COUNT 查询以确定数据库中有多少拇指

2.  计算页数：

    ```
    $pageCount = ceil($numberOfThumbs / $thumbsPerPage) 
    ```

3.  每页创建一个包含页码的链接

4.  计算偏移量：

    ```
    $offset = ($page-1)*$thumbsPerPage 
    ```

5.  添加`limit`到您的查询：

    ```
    SELECT * FROM myTable LIMIT $offset, $thumbsPerPage 
    ```

[http://php.about.com/od/mysqlcommands/g/Limit_sql.htm](http://php.about.com/od/mysqlcommands/g/Limit_sql.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T12:48:48.830

可能你可以使用 PEAR 的 [Pager](http://pear.php.net/manual/en/package.html.pager.intro.php)类？

[1) 从http://pear.php.net/package/Pager/download](http://pear.php.net/package/Pager/download)下载模块或在命令提示符处执行以下命令。

```
c:\pear 安装寻呼机
```

2) 将以上内容复制到您的 PEAR 包含目录，该目录最好是“c:\your php 安装目录\Pear”

3）现在看一些实际的代码 -

```
require_once '寻呼机/Pager.php';
/* 我们将绕过数据库连接代码... */
$sqlQuery = "一些 SQL 查询";
$result = mysql_query($sqlQuery);
$totalRows = mysql_num_rows($result);

$pager_options = 数组（
'模式' => '滑动',
'每页' => 10,
'三角洲' => 4,
'totalItems' => $totalRows,
);
$pager = Pager::factory($pager_options);
回声 $pager-> 链接；
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-24T12:58:28.353

您可以查看使用 SQL 的[LIMIT](http://dev.mysql.com/doc/refman/5.0/en/select.html)子句来限制从查询返回的记录数。然后每页增加 LIMIT 中的 offset 参数。

在 PHP 中，您需要生成页面链接并附加一个查询字符串，该字符串告诉 PHP 正在请求哪个页面。将此值乘以每页的记录数，得到 LIMIT 子句的偏移值。

限制来自 MySQL 查询的结果数量的缺点是，您需要在*没有*LIMIT 的情况下运行查询来获取记录总数，以便您可以计算需要在 PHP 中生成多少页面链接。

您需要考虑如何设置页面链接的格式。您想要简单的上一个|下一个链接还是更复杂的第一个|上一个|n|n|n|n|next|last。从用户的角度来看，我总是觉得能够跳到第一页/最后一页和特定的页码很有用，但这取决于你真正需要什么。

那里可能有扩展/类可以自动为您完成这一切，但在构建 SQL 查询时我是一个自己动手的人。

# point - NSBezierPath 中的 NSPoint

> ID：10737728
> 
> 赞同：0
> 
> 时间：2012-05-24T12:41:42.877
> 
> 标签：point, nsbezierpath

我想知道是否有任何方法可以确定 NSPoint 是否在 NSBezierPath 内。喜欢：

```
NSPointInRect(aPoint,aRect) 
```

但是使用 BezierPath。

在此先感谢，本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T19:33:23.277

是的。看这个方法：

```
containsPoint: 
```

返回一个布尔值，指示接收器是否包含指定的点。

```
- (BOOL)containsPoint:(NSPoint)aPoint 
```

参数 aPoint 针对路径进行测试的点，在路径对象的坐标系中指定。

# asp.net-mvc-3 - ActionFilter 在 RedirectToAction 之前读取内容

> ID：10737730
> 
> 赞同：0
> 
> 时间：2012-05-24T12:41:58.853
> 
> 标签：asp.net-mvc-3, entity-framework-4.1

我希望记录删除和编辑，并认为最好的方法是将一个 actionFilter 属性应用于我的删除和编辑 [post] 方法

但是因为最终结果是重定向到操作，所以我的 Context.Result 始终为空，因为只有 Context.RedirectToAction 结果可用。

现在，在我创建一些代码来插入我的删除和编辑功能之前，有没有人尝试过这样的事情！，你能建议吗？

谢谢

操作代码：

```
[HttpPost, ValidateInput(false)]
    [SiteChangeLogger(LogType = "Update", TableName = "Affiliates")]
    public ActionResult Edit(Affiliate affiliate, FormCollection form)
    {
        var existing = db2.Affiliates.SingleOrDefault(x => x.AffiliateId == affiliate.AffiliateId);
        ViewBag.before = Common.Strings.Base64Encode(Common.Strings.ToJsonString(existing));
        if (ModelState.IsValid)
        {
            try
            {
                var curFiles = new NameValueCollection();
                curFiles["AffiliateLogo"] = affiliate.AffiliateLogo;
                if (!String.IsNullOrWhiteSpace(form["AffiliateLogo"]))
                {
                     UploadFiles(form,curFiles);
                     TryUpdateModel(affiliate, form);

                     var oldFileName = affiliate.AffiliateLogo;
                     var newFileName = Common.Strings.RandomFileName();
                     new WebImage(Server.MapPath("~/Content/images/" + affiliate.AffiliateLogo))
                         .Resize(200, 50, true, true)
                         .Crop(1, 1)
                         .Save(Server.MapPath("~/Content/images/" + newFileName), "png", true);
                     affiliate.AffiliateLogo = newFileName + ".png";
                     Common.Common.TryAndDeleteFile("~/Content/images/" + oldFileName);
                }
                else
                {
                    affiliate.AffiliateLogo = existing.AffiliateLogo;
                }

            }
            catch (Exception ex)
            {
                Common.Common.CompileErrorMessage(ex,"ADMIN.Affiliate.Edit");
            }
            finally
            {
                db.Entry(affiliate).State = EntityState.Modified;
                db.SaveChanges();   
            }
            ViewBag.after = Common.Strings.Base64Encode(Common.Strings.ToJsonString(affiliate));
            return RedirectToAction("Index");
        }
        return View(affiliate);
    } 
```

我的过滤器代码

```
public override void OnResultExecuted(ResultExecutedContext fc)
    {
        var viewResult = fc.Result as ViewResult;

        if(viewResult == null) return;

        var beforeData = viewResult.ViewBag.before;
        var afterData = viewResult.ViewBag.after;

        if (beforeData == null && afterData == null) return;

        var ctx = new SgeGamesContext();
        var eventId = 0;
        var siteChangeLogEvent = ctx.SiteChangeLogEvents.SingleOrDefault(x => x.SiteChangeLogEventName == LogType);
        if (siteChangeLogEvent != null)
        {
            eventId = siteChangeLogEvent.SiteChangeLogEventId;
        }

        var model = new Sge.Games.Data.Models.SiteChangeLog
                        {
                            SiteChangeLogTable = TableName,
                            SiteId = 1,
                            SiteChangeLogAfterContent = afterData,
                            SiteChangeLogBeforeContent = beforeData,
                            SiteChangeLogEventId = eventId
                        };
        ctx.SiteChangeLogs.Add(model);
        ctx.SaveChanges();

        base.OnResultExecuted(fc);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T13:10:32.077

您可以直接访问 ViewBag，不需要 ViewResult：

```
public override void OnResultExecuted(ResultExecutedContext fc)
{
    var before = fc.Controller.ViewBag.before;
    var after = fc.Controller.ViewBag.after;
    ...
} 
```

此外，您可能想使用`OnActionExecuted`事件而不是`OnResultExecuted`.

# android - 实时服务器数据库上的 Android 和搜索功能

> ID：10737732
> 
> 赞同：0
> 
> 时间：2012-05-24T12:42:11.583
> 
> 标签：android, database, soap, android-searchmanager

我有一个 android 应用程序，我想实现搜索功能。

此函数将访问实时服务器并请求包含搜索词的所有数据。

问题是数据库非常庞大，而不是等待一次获得所有响应（非常慢），我想尽快显示结果。

例如，用户正在寻找“你好”，在我的数据库中我有 10 个带你好的字符串：

你好1你好2你好3你好4你好2你好6你好7你好8你好9你好10

而不是等待所有的你好，我想先显示 hello1，然后 hello2 会出现等。

你知道如何做到这一点。实际上，我正在使用肥皂请求进行客户端-服务器通信。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:48:48.263

安娜 我认为您可以尝试使用内容提供商。创建一个服务，该服务将从实时服务器中提取数据并更新表。延迟一段时间后开始查询表，并在用户开始滚动时继续更新结果。只是一个想法从未尝试过！！！！

# java - 强制泛型类型成为接口？

> ID：10737737
> 
> 赞同：7
> 
> 时间：2012-05-24T12:42:47.657
> 
> 标签：java, generics

看起来这是不可能的，但是有人有解决这个问题的聪明方法吗？

```
public class SomeClassIterableWrapper<S, T extends SomeClass & S> implements Iterable<S> 
```

Where`S`应该是某种未知类型的接口，并且`SomeClass`是具有行索引的二维数组，在功能上类似于双向 JDBC 结果集。的子类`SomeClass`对每一列都有自定义的 getter 和 setter。我希望能够像列表一样遍历这个结构。我想在我`SomeClass`和 Bean 之间实现一个通用接口来访问 getter 和 setter。因此 S 需要是那个接口。但是我提供的声明不起作用。有没有办法解决这个问题？

编辑以显示我想要的实现：

```
public class SomeClassIterableWrapper<S, T extends SomeClass & S> implements Iterable<S>{

T object;

public SomeClassWrapper(T object){
    this.object = object;
}

@Override
public Iterator<S> iterator() {
    object.setIndex(-1);
    return new SomeClassIterator<S>();
}

private class SomeClassIterator<S> implements Iterator<S> {

    @Override
    public boolean hasNext() {
        return object.index() < object.rowSize() - 1;
    }

    @Override
    public S next() {
        object.next();
        //safe because only interface methods allowed, can't further manipulate index
        return object; 
    }

    @Override
    public void remove() {
        object.deleteRow();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:21:43.743

你不能用 参数化`SomeClass`吗`S`？那么你可以有

```
public class SomeClassIterableWrapper<S, T extends SomeClass<S>> 
      implements Iterable<S>{ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:28:04.627

我认为 S in extends SomeClass & S

公共类 SomeClassIterableWrapper

必须是一个明确的类，因为在这种情况下，S 必须是一个扩展某些东西的类。

有没有一种方法可以缩小用于代替 S 的潜在类的范围？如果您有多个 T 应该扩展的类，则可以使用多个 &

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-24T16:11:57.170

我承认我没有完全理解这个问题，但这就是我的建议：创建一个`S`. 它包含一个方法，它返回`S`对象。

```
public interface SWrapper<S> {

  S getS();

} 
```

然后创建一个实现：

```
public class SImpl implements SWrapper<SImpl> {

    @Override
    public SImpl getS() {
        return this;
    }

} 
```

您现在可以创建：

```
public class SomeClass<T extends SomeClass & SWrapper<T>> {

    private final T object;

    public SomeClass(T object) {
        this.object = object;
    }
} 
```

您将不得不稍微修改您的用法，但也许它可以工作。

# dojo - DojoX Mobile ListItem 通过 AJAX 加载 HTML，然后从 DOM 中删除

> ID：10737745
> 
> 赞同：0
> 
> 时间：2012-05-24T12:43:16.627
> 
> 标签：dojo, dojox.mobile

假设在一个视图中，我有一个 DojoX Mobile ListItem，它通过 AJAX 将 HTML 视图片段拉入 DOM，然后转换到该视图。假设这一切正常。

现在，我返回到上面有 ListItem 的初始视图，然后单击其他一些按钮，该按钮从 DOM 中销毁该视图节点。如果我现在单击先前将该视图节点加载到 DOM 中的 ListItem（现在已被删除），它将尝试转换到不存在的视图。它不知道它已被删除。

是否有某种方法可以告诉 ListItem 它需要再次获取 HTML，因为之前获取的内容不再存在？我在任何地方的任何文档中都没有看到任何关于这样做的信息。我不认为这里真的需要代码示例，但如果需要，我可以提供一个最小的示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T13:20:13.660

我走了一条不同的路线，让视图存在于 DOM 中，并简单地创建了一个函数，将所有敏感数据从视图中清除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:20:13.960

好的，在这种情况下，我想你可以挂钩 ListItem 容器的 onShow 函数（或任何其他 onchange 事件）。为所述句柄创建一个侦听器，以评估您的项目是否需要重新加载。以下假设是 item.onclick 内容显示 - 而不是包含这些信息的项目标签

或者更好的是，在初始化期间执行所有这些操作，以便使用自定义 onClick 代码扩展您的 ListItem 容器。

看起来很简单，但可能会引入一些怪癖，在哪里/何时/如果您以编程方式更改此项目，但是这里有：

```
function checkItem() {
    // figure out if DOM is present and if it should be
    if( isLoggedIn() ) {
       this.getChildren().forEach(function(listitem) {
        if( dojo.query("#ID_TO_LOOK_FOR", listitem.domNode).length == 0 ) {
           // this references the listItem, refresh contents.
           // Note: this expects the listitem to be stateful, have no testing environment at time being but it should be
           listitem.set("url", listitem.url);
        }

       });
    }
} 
```

最好将其设置在您的容器构造`ListItem`中

```
var listItemParent = new dojox.mobile.RoundRectList({
  onShow : checkItem,
  ...
}); 
```

或者创建监听器

```
var listItemParent = dijit.byId('itemRegistryId');
// override onClick - calling inheritance chain once done
dojo.connect(listItemParent, "onClick", listItemParent, checkItem); 
```

# ubuntu - tsung 和 ec2 - 如何允许 ubuntu 的无密码登录

> ID：10737759
> 
> 赞同：0
> 
> 时间：2012-05-24T12:44:19.240
> 
> 标签：ubuntu, amazon-ec2, load-testing, tsung

我在 ec2 上为 ubuntu 完成了以下操作。

1）我的安全组打开了 0-65000 端口 2）我通过运行这些命令来关闭防火墙

```
iptables -X
iptables -t nat -F
iptables -t nat -X
iptables -t mangle -F
iptables -t mangle -X
iptables -P INPUT ACCEPT
iptables -P FORWARD ACCEPT
iptables -P OUTPUT ACCEPT 
```

我还需要做什么才能让宗主与所有的奴隶一起工作？我如何测试它是否有效？我厌倦了 ssh 但仍然要求密钥。

```
ssh ec2-122-248-xxx-xxx.ap-southeast-1.compute.amazonaws.com erl
Permission denied (publickey). 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:58:50.073

这是我使用的 - 我首先编辑我的主机文件并确保我在那里有我所有机器的名称（你也可以使用 DNS，但我宁愿降低成本并使用内部 IP），然后我运行：

```
 #!/bin/bash

    myrsapub=`cat ~/.ssh/id_rsa.pub`

    for i in <my_machine_names_space_delimited>; do
ssh $i -i ~/.ssh/<my_amazon_key> "echo $myrsapub | tee -a ~/.ssh/authorized_keys; ssh-keygen -t rsa << hereintime

    hereintime; sudo hostname $i; exit" &> /dev/null
        ssh $i "echo \"host *
        user ubuntu
        StrictHostKeyChecking no\" | tee -a .ssh/config; sudo sed -i.bak -e \"s/localhost/localhost $i/\" -e \"/$i/d\" /etc/hosts; echo \"# need to have ssh-agent         running
    eval \`ssh-agent\`
    [ -e /home/ubuntu/.ssh/id_rsa.pub ] && ssh-add\" | tee -a ~/.bashrc" &> /dev/null
        newhostline=`grep $i /etc/hosts`
        ssh $i "sudo sed -i -e \"/$i/d\" /etc/hosts; echo $newhostline | sudo tee -a /etc/hosts" &> /dev/null
        <LOAD_MASTER>=`grep <LOAD_MASTER> /etc/hosts` && ssh $i "sudo sed -i -e '/<LOAD_MASTER>/d' /etc/hosts" &> /dev/null
        ssh $i "rm ~/.ssh/known_hosts; echo $<LOAD_MASTER> | sudo tee -a /etc/hosts; ssh <LOAD_MASTER> \"exit\""  &> /dev/null
        ssh $i "cat ~/.ssh/id_rsa.pub" | tee -a ~/.ssh/authorized_keys
        ssh $i "sudo hostname $i; exit"
     done 
```

# qt4 - Metro UI 风格的关闭/最小化/最大化按钮

> ID：10737761
> 
> 赞同：1
> 
> 时间：2012-05-24T12:44:20.863
> 
> 标签：qt4, styles, microsoft-metro

如何设置应用程序的最大化/最小化/关闭按钮的样式以匹配 Metro UI 版本？我会做类似右上角的事情：我在 Windows 7 上使用 Qt 4.8

![在此处输入图像描述](../Images/3b463d6398123763c9124d6c7d8a4cd5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T21:27:53.643

无法设置窗口框架的样式，因为它由底层操作系统管理。您需要创建无框窗口并添加负责最小化/关闭/最大化的小部件

# android - Android rom.zip 中到底有什么

> ID：10737764
> 
> 赞同：0
> 
> 时间：2012-05-24T12:44:31.113
> 
> 标签：android, linux, android-ndk, rom

我想问一下 zip 格式的 Android Rom 的结构是什么。我已经解压缩了其中的一些。但我无法弄清楚引导加载程序如何将它们安装在手机上。谁能告诉我引导加载程序到底是做什么的？

我熟悉Linux。所以我想知道一些低层次的东西。我想知道我是否可以交叉编译 Linux 内核和一些 Linux 的工具（如[CLFS 项目](http://trac.cross-lfs.org/)）并将它们安装在移动设备上。

有人有什么提示吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-11T17:12:57.503

这取决于更新脚本。如果有`boot.img`(kernel+ramdisk)，使用 raw 命令，`boot.img`将在引导分区上闪存。所有其他文件夹将在系统分区上闪存。您应该观看其中的更新脚本`META-INF/com/google/android`或类似的东西。

# android - Android 应用程序设计 - 将 GUI 与一系列声音同步

> ID：10737766
> 
> 赞同：1
> 
> 时间：2012-05-24T12:44:40.217
> 
> 标签：android, multithreading, design-patterns, user-interface

我需要一些建议。我正在构建一个应用程序，该应用程序具有在用户按下按钮时将发生的 4 个操作序列。一旦用户按下 GO，该按钮必须变为未启用，并且界面中的一些视觉提示必须显示 4 个操作中的哪一个正在发生。（例如，更改 ImageView 的可见性）GUI 必须立即更改以与正在播放的声音保持同步。

在这 4 个动作中的每一个之后，GUI 必须更改以反映当前正在发生的动作。

当前尝试——我无法在第一个动作开始之前（播放声音）以及在动作之间的适当时间更改 GUI。动作是播放 4 种不同的声音。目前，我正在使用 MediaPlayer。

我没有任何运气试图在我想要的时候强制 GUI 更新。我使用了 AsyncTask，并尝试了 setEnabled()、invalidate()、forceLayout()、refreshDrawableState() 的所有组合，以尝试在我想要它们时强制在 gui 中发生事情——对应于按顺序播放的 4 个声音。

我的问题似乎是我试图在一个 onClick 处理程序中做 4 件事。我一直在为 validate() 在“未来某个时候”调用 reDraw 而苦苦挣扎。

我不知道哪种设计模式最适合为依次发生的 4 件事提供视觉提示。

我刚刚开始研究处理程序。这是要走的路吗？我以为这很容易。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T06:39:09.453

如果我没记错的话 AsyncTask 的`onPreExecute`和`onPostExecute`方法在 GUI 线程上执行。从这些方法更新 GUI 不起作用吗？

# asp.net - 将图像保存到 VB.net 中的文件夹

> ID：10737768
> 
> 赞同：0
> 
> 时间：2012-05-24T12:44:44.757
> 
> 标签：asp.net, vb.net

我正在尝试使用 vb.net 将图像从客户端保存到文件夹

""具有 myImage ID 的图像 ""

```
<asp:Image runat="server" ID="myImage" ImageUrl="http://www.govcomm.harris.com/images/1F-81-imageLinks650a.jpg" />
<asp:Image runat="server" ID="myImage2" ImageUrl="http://www.govcomm.harris.com/images/2F-81-imageLinks650b.jpg" /> 
```

这只是我要保存图像的位置：我没有运行或尝试使用此代码进行任何操作，我只是想知道如何执行此操作此位置位于服务器端

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
  Dim saveLocation As String = Server.MapPath("PDFs")
End Sub 
```

另外，我想知道是否有一种方法可以使用 id 来保存，因为我可能要保存多个图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:00:38.047

```
Try this one.....
import System.Net
Dim filepath As String = Server.MapPath(myImage.ImageUrl)

Using client As New WebClient()
client.DownloadFile(filepath, Server.MapPath("Specify the path where you want to    store+imagename"))       //------For  example  client.DownloadFile(filepath,Server.MapPath("~/Image/282.gif"))
End Using 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T13:04:52.233

如果要从客户端（通过浏览器从用户）上传文件到服务器文件夹，则需要使用 FileUpload 控件

```
<asp:FileUpload ID="FileUpload1" runat="server" /> 
```

`PostedFile.SaveAs`在您的代码隐藏中，您可以通过调用方法将其保存到某个位置

```
 If FileUpload1.HasFile Then
        somefileNameWithExtension="file.pdf" ' Replace this with a a valid file name
        FileUpload1.PostedFile.SaveAs(somefileNameWithExtension)
    End If 
```

**编辑** ：根据评论

如果要从 Internet 下载文件，可以使用 WebClient 类的 DownloadFile 方法来完成。这是一个例子。

```
 Using webClient As New WebClient()

        Dim targrtFileName = "D:\\myfile.png" ' 
        Dim sourceFile = "http://converter.telerik.com/App_Themes/images/ccHead.png"
        'read the Source of your image control and replace in sourceFile  variable.

        webClient.DownloadFile(sourceFile , targrtFileName)

    End Using 
```

# ios - NSException 对 ios 开发人员有用吗，它的子类有哪些类型

> ID：10737774
> 
> 赞同：-2
> 
> 时间：2012-05-24T12:45:00.170
> 
> 标签：ios, crash, nsexception

> **可能重复：**
> [iphone - 尝试，抓住问题](https://stackoverflow.com/questions/6477416/iphone-try-catch-question)

请告诉我使用@try @catch 对ios 开发很有用。我想知道 NSException 的子类。请给我链接以了解它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:53:19.640

好吧，您错过了@finally 的一部分，它是无论是否抛出异常都会运行的代码段，如果它不存在，则在运行 catch 块之后的代码块。此外，人们通常不使用 @throw 来抛出例外。

`NSException`无论如何，如果已经知道您的异常，建议使用，您可以创建和引发异常。

你可以看看[NSException Apple's Reference](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSException_Class/Reference/Reference.html)和[About Exceptions and Errors](http://blog.jayway.com/2010/10/13/exceptions-and-errors-on-ios/)

# ios - NSFetchedResultsController / CoreData 多线程问题

> ID：10737781
> 
> 赞同：1
> 
> 时间：2012-05-24T12:45:38.360
> 
> 标签：ios, uitableview, core-data, nsfetchedresultscontroller, nsmanagedobjectcontext

我目前正在开发一个使用 CoreData 和 NSFectchedResultsController 的应用程序。这个应用程序只包含一个使用 NSFetchedResultsController 的 UITableView。

**1/**当应用程序启动时，另一个线程被分离。在这个新线程中，WS 调用允许从 Web 服务器检索数据。在 WS 调用之后，我将数据与另一个 NSManagedObjectContext 一起存储在我的 CoreData DB 中（Apple 的最佳实践：另一个线程 => 另一个上下文）。在保存新对象之前，我必须删除该实体的所有对象。我通过 mergeChangesFromContextDidSaveNotification 将这个其他上下文与主上下文合并。

```
 // Data Manager (in another thread)
        NSManagedObjectContext *context = [[NSManagedObjectContext alloc] init];
        [[NSNotificationCenter defaultCenter]   addObserver:self
                                                selector:@selector(contextDidSave:)
                                                name:NSManagedObjectContextDidSaveNotification
                                                object:context];
        [context setMergePolicy:NSMergeByPropertyObjectTrumpMergePolicy];
        [context setPersistentStoreCoordinator:[self getPersistentStoreCoordinator]];

        ...

        for (NSManagedObject * obj in objects) 
        {
            [context deleteObject:obj];
        }

        ...

        for(NSDictionary *serverObj in serverObjects)
        {
            objAd =  [NSEntityDescription
                      insertNewObjectForEntityForName:@"MyEntity" 
                      inManagedObjectContext:context];
            ...
        }

        [context save:&error];

        [[NSNotificationCenter defaultCenter] removeObserver:self name:NSManagedObjectContextDidSaveNotification object:context];
        [context release];

        ...

        - (void)contextDidSave:(NSNotification *)notification
        {

            SEL selector = @selector(mergeChangesFromContextDidSaveNotification:); 
            [[self getContext] performSelectorOnMainThread:selector withObject:notification waitUntilDone:YES];
        }

        - (NSManagedObjectContext *) getContext
        {
            return [(AppDelegate *)[[UIApplication sharedApplication] delegate] managedObjectContext];
        }

        - (NSPersistentStoreCoordinator *) getPersistentStoreCoordinator
        {
            return [(AppDelegate *)[[UIApplication sharedApplication] delegate] persistentStoreCoordinator];
        } 
```

**2/**这是我的 NSFectchedResultsController 的吸气剂：

```
 // UIView
    - (NSFetchedResultsController*) offersFRC {

        if (offersFRC == nil) 
        {
            NSManagedObjectContext *l_ManagedObjectContext = [[DataManager sharedDataManager] getContext];

            NSFetchRequest *l_FetchRequest = [[NSFetchRequest alloc] init];

            NSEntityDescription *l_Entity = [NSEntityDescription entityForName:@"MyEntity" inManagedObjectContext:l_ManagedObjectContext];
            [l_FetchRequest setEntity:l_Entity];

            [l_FetchRequest setFetchBatchSize:5];

            NSNumber *sortType = [self.searchCriterions objectForKey:@"sortType"];
            NSSortDescriptor *l_SortDescriptor = [[NSSortDescriptor alloc] initWithKey:[Constants getFieldNameBySortType:sortType] ascending:[Constants isAscendingBySortType:sortType]];
            [l_FetchRequest setSortDescriptors:[NSArray arrayWithObjects:l_SortDescriptor, nil]];
            [l_SortDescriptor release];

            NSFetchedResultsController *l_FetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:l_FetchRequest                                                                                                      managedObjectContext:l_ManagedObjectContext 
                sectionNameKeyPath:nil                                                                                                     
                cacheName:nil];
            [l_FetchRequest release];

            [self setOffersFRC:l_FetchedResultsController];
            [l_FetchedResultsController release],l_FetchedResultsController = nil;

            [self.offersFRC setDelegate:self];
        }

        return offersFRC;
    } 
```

**3/**启动应用程序时出现以下错误：

```
 2012-02-29 11:56:09.119 Nanopost[1996:207] *** Terminating app due to uncaught exception      'NSObjectInaccessibleException', reason: 'CoreData could not fulfill a fault for '0x5c3c760 <x-coredata://E176B0A1-275B-4332-9231-49FD88238C2B/Ads/p231>''
    *** Call stack at first throw:
    (
    0   CoreFoundation                      0x02bfe919 __exceptionPreprocess + 185
    1   libobjc.A.dylib                     0x02e595de objc_exception_throw + 47
    2   CoreData                            0x028b833f _PFFaultHandlerLookupRow + 1407
    3   CoreData                            0x028b5ee3 _PF_FulfillDeferredFault + 499
    4   CoreData                            0x028b9f3f _sharedIMPL_pvfk_core + 95
    5   CoreData                            0x0292a010 _PF_Handler_Public_GetProperty + 160
    6   Foundation                          0x02442c4f -[NSSortDescriptor compareObject:toObject:] + 128
    7   CoreData                            0x0297db5e +[NSFetchedResultsController(PrivateMethods) _insertIndexForObject:inArray:lowIdx:highIdx:sortDescriptors:] + 286
    8   CoreData                            0x0297e1b2 -[NSFetchedResultsController(PrivateMethods) _postprocessInsertedObjects:] + 402
    9   CoreData                            0x029841bc -[NSFetchedResultsController(PrivateMethods) _managedObjectContextDidChange:] + 1804
    10  Foundation                          0x02380c1d _nsnote_callback + 145
    11  CoreFoundation                      0x02bd6cf9 __CFXNotificationPost_old + 745
    12  CoreFoundation                      0x02b5611a _CFXNotificationPostNotification + 186
    13  Foundation                          0x023767c2 -[NSNotificationCenter postNotificationName:object:userInfo:] + 134
    14  CoreData                            0x028c0519 -[NSManagedObjectContext(_NSInternalNotificationHandling) _postObjectsDidChangeNotificationWithUserInfo:] + 89
    15  CoreData                            0x028f802b -[NSManagedObjectContext mergeChangesFromContextDidSaveNotification:] + 1579
    16  Foundation                          0x02395e9a __NSThreadPerformPerform + 251
    17  CoreFoundation                      0x02bdfd7f __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 15
    18  CoreFoundation                      0x02b3e2cb __CFRunLoopDoSources0 + 571
    19  CoreFoundation                      0x02b3d7c6 __CFRunLoopRun + 470
    20  CoreFoundation                      0x02b3d280 CFRunLoopRunSpecific + 208
    21  CoreFoundation                      0x02b3d1a1 CFRunLoopRunInMode + 97
    22  GraphicsServices                    0x031e62c8 GSEventRunModal + 217
    23  GraphicsServices                    0x031e638d GSEventRun + 115
    24  UIKit                               0x0063cb58 UIApplicationMain + 1160
    25  Nanopost                            0x0000230a main + 170
    26  Nanopost                            0x00002255 start + 53
    )
    terminate called after throwing an instance of '_NSCoreDataException' 
```

**重要说明**：

*   它仅在 iOS4 上崩溃
*   controllerWillChangeContent 是应用程序崩溃前我的代码中调用的最后一个函数。未调用 controllerDidChangeContent / didChangeObject/ didChangeSection。
*   当我评论 [l_FetchRequest setFetchBatchSize:5] => 不再崩溃
*   当我在删除对象之后和插入新对象之前添加 [context save:&error] => 不再崩溃
*   当我使用 [l_FetchRequest setFetchBatchSize:24] => 崩溃时
*   当我使用 [l_FetchRequest setFetchBatchSize:25] => 不再崩溃

我花了很多时间试图理解这个问题，所以非常感谢您的回答！

托马斯

**编辑 1 (@Jody)：** 您好乔迪，非常感谢您的回答！

以下是用于处理 contextDidSave 的代码：

```
 - (void)contextDidSave:(NSNotification *)notification
    {
        SEL selector = @selector(mergeChangesFromContextDidSaveNotification:); 
        [[self getContext] performSelectorOnMainThread:selector withObject:notification waitUntilDone:YES];
    } 
```

“你首先必须告诉我更多关于你正在使用的上下文”：

我在这个应用程序中使用了 2 个上下文：

*   N° 1：在创建 XCodeProject 时默认在 AppDelegate 中创建。我的 FRC 使用此上下文并允许显示 UITableView 的行。

*   N°2：在我的“DataManager”（我的帖子中的第一个代码块）中创建，一个允许刷新我的数据库（WS 调用、删除、重新插入、保存）的单例。

保存上下文 N°2 时，调用 contextDidSave 以将此上下文与主上下文（上下文 N°1）合并。之后，我的 FRC 委托的方法“controllerWillChangeContent”被调用。我认为显示此方法中包含的代码无济于事，因为即使我只是放了一个 NSLog，它也会在此方法之后崩溃（我放了很多 NSLog，而 controllerWillChangeContent 中包含的 NSLog 是之前显示的最后一个迷恋;撞车;崩溃）。

我在 Apple Dev Forum 上发帖，有一个有趣的答案：[https ://devforums.apple.com/thread/152172?tstart=0](https://devforums.apple.com/thread/152172?tstart=0)

**编辑 2 (@Jody)：** 嗨乔迪！

正如您在以下方法中看到的那样，我的 FRC 不使用来自其他线程的 MOC：

```
- (NSManagedObjectContext *) getContext
    {
        return [(AppDelegate *)[[UIApplication sharedApplication] delegate] managedObjectContext];
    } 
```

我的“DataManager”的这个方法返回 AppDelegate 的 MOC（=主线程 MOC）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T16:01:15.963

您在一个上下文中从数据库中删除，因此您必须适当地刷新您的其他上下文，特别是摆脱对已删除数据的对象引用。

您处理 contextDidSave: 的代码是什么？此外，您的 FRC 代表如何处理数据更新通知？

**编辑**

看起来您正在混淆您的托管对象上下文。您正在数据管理器中使用一个来加载和修改数据库...

```
// Data Manager (in another thread)
NSManagedObjectContext *context = [[NSManagedObjectContext alloc] init]; 
```

然后使用“默认” MOC 通过通知将该数据拉入您的应用程序，但看起来您获取的结果控制器也在尝试使用来自另一个线程的 MOC...

```
NSManagedObjectContext *l_ManagedObjectContext = [[DataManager sharedDataManager] getContext]; 
```

它可能也应该使用主 MOC（来自您的应用程序委托）。

# c# - 仅序列化xml文件的一部分并保存

> ID：10737782
> 
> 赞同：3
> 
> 时间：2012-05-24T12:45:38.890
> 
> 标签：c#, xml-serialization

我对 XML 序列化有疑问。我将尝试使用以下示例 xml 文件来解释它

```
<AutoExpo>
  <Details>
    <Venue>XYZ</Venue>
    <StartTime>09:00</StartTime>
    <EndTime>21:00</EndTime>
  </Details>

  <Cars>
      <Car>
        <Company>Chevrolet</Company>
        <Model>Cruz</Model>
        <Color>Red</Color>
      </Car>

      <Car>
        <Company>Ford</Company>
        <Model>Fiesta</Model>
        <Color>Blue</Color>
      </Car>

  </Cars>
</AutoExpo> 
```

现在，当我阅读这个 xml 文件时，我将汽车反序列化为对象。汽车清单可能很大。我的代码使用这个对象并且可以改变一些汽车的属性。现在，如果我只想序列化那些属性已更改的汽车对象，回到 xml 文件并保存它，以便下次我的代码启动时它会获得最新的状态信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:00:16.637

在 XML 文件中到处更改属性是相当困难的，无论它们发生了什么变化。您应该将整个文件读入内存，然后在保存时写出整个文件，覆盖旧文件。

XML 并不是一种糟糕的方法，但据我从问题中可以看出，SQL Server（或其他 RDBMS）数据库会更合适。你不必担心这样的问题，因为数据库引擎会为你做这件事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T13:22:02.843

首先，您的实体必须具有唯一标识符。

```
<AutoExpo>
  <Details>
    <Venue>XYZ</Venue>
    <StartTime>09:00</StartTime>
    <EndTime>21:00</EndTime>
  </Details>

  <Cars>
    <Car id="1">
      <Company>Chevrolet</Company>
      <Model>Cruz</Model>
      <Color>Red</Color>
    </Car>
    <Car id="2">
      <Company>Ford</Company>
      <Model>Fiesta</Model>
      <Color>Blue</Color>
    </Car>
  </Cars>
</AutoExpo> 
```

现在您可以使用 XPath 来选择那些需要更新并更改其内容的节点。

1.  将文档加载到 XDocument
2.  找车：document.Element("Car[id=2]")
3.  设置新值： element.Element("Color").Value = "Black"

但是，使用基于文件的存储的缺点仍然存在。您仍然需要将整个文件加载到内存中并将其写回硬盘驱动器，但您不必序列化所有 Car 对象。我想不出一种简单的方法来从硬盘驱动器流式传输文件并一次性操作它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T12:56:59.750

当您序列化一个对象时，它会生成整个 XML 文档。因此，如果将其保存到文件中，它将覆盖文件的先前内容。因此，如果您希望生成的文件包含所有汽车，包括但不限于修改后的汽车，那么您需要序列化整个东西。如果你只序列化那些改变的，文件会丢失所有没有改变的汽车。如果您真的只想序列化更改的汽车，我建议创建 AutoExpo 对象的新实例，并仅将要保存的汽车插入其中，然后仅使用部分列表序列化该对象。

如果您因为数据太大而只需要修改 XML 中的单个元素而不触及它的其余部分，那么 XML 不是一个好的选择。我会建议使用关系数据库。或者，您可以将每辆汽车存储为自己的 XML 文件，并且仅在必要时单独加载和保存每辆汽车。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T12:58:23.353

你不能用 XML 做到这一点。考虑使用关系数据库。关系数据库具有内置的文件空间管理机制，可以完全按照您的需要进行操作。您可以更新单个记录、添加和删除记录。

Jet .mdb 数据库 (Access) 是替换 XML 文件的理想选择。您可以通过 OLEDB 访问它，但应用程序必须编译为 32 位。无需安装 Access。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T12:54:32.343

虽然它可能不是最好的解决方案，但一个潜在可行的选择是将编辑的列表序列化为一个单独的文件，并在代码中比较这两个文件。如果信息没有任何更改，则两个文本文件应该是相同的。如果没有，您可以用新文件替换旧文件。最简单的方法是，而不是序列化到文件并读/写它，也许将它发送到流并比较它们。

# mysql - MySQL INSERT 失败，复合键弱实体：“重复条目 'xy' for key 'PRIMARY'”

> ID：10737784
> 
> 赞同：1
> 
> 时间：2012-05-24T12:45:55.677
> 
> 标签：mysql, composite-key, mysql-error-1062

我在插入 MySQL 表 DESP_Features_Weak 中的复合键时遇到问题。

我已经查看了 [FK 上唯一的 MySQL 组合](https://stackoverflow.com/questions/2591477/mysql-composite-unique-on-fks)，但我的问题有点不同。

![我的 ERD](../Images/091db8a389345a9976cc7dfc2b555ecf.png)

```
INSERT INTO DESP_Features_Weak (details, Features_f_id, fk_desp_id, fk_dfws_id) VALUES (NULL, 2, 1, 5); 
```

产量，

```
Error Code: 1062\. Duplicate entry '1-2' for key 'PRIMARY' 
```

奇怪的是，使用 1,2 键（甚至 2,1 键）搜索记录不会返回任何记录，因此没有重复条目。

我在[MySQL 文档](http://forums.mysql.com/read.php?136,168833,234067#msg-234067)中阅读了一些人似乎已经放弃了他们的索引来解决他们的问题；我做了同样的事情，它似乎没有改变任何东西，尽管我相信仍然有一个名为 PRIMARY 的索引我无法删除。

这只是我在 MySQL Workbench 中拼凑的一个个人数据库，它没有用于生产或其他任何东西。

相关表的转储如下所示：

```
CREATE TABLE `DESP_Features_Weak` (
  `DESP_Features_Weakcol` varchar(45) DEFAULT NULL,
  `Details` mediumtext,
  `fk_desp_id` int(11) NOT NULL,
  `Features_f_id` int(11) NOT NULL,
  `CostType_ct_id` int(11) NOT NULL,
  `cost_amount` decimal(18,2) DEFAULT NULL,
  `askedAboutFeatureFees` tinyint(1) DEFAULT NULL,
  `fk_dfws_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`fk_desp_id`,`Features_f_id`),
  KEY `fk_DESP_Features_Weak_Features1` (`Features_f_id`),
  KEY `fk_DESP_Features_Weak_DESP_Feature_Weak_State1` (`fk_dfws_id`),
  CONSTRAINT `fk_DESP_Features_Weak_DigitalEditionsSolutionProvider1` FOREIGN KEY (`fk_desp_id`) REFERENCES `DigitalEditionsSolutionProvider` (`desp_id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `fk_DESP_Features_Weak_DESP_Feature_Weak_State1` FOREIGN KEY (`fk_dfws_id`) REFERENCES `DESP_Feature_Weak_State` (`dfws_id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `fk_DESP_Features_Weak_Features1` FOREIGN KEY (`Features_f_id`) REFERENCES `Features` (`f_id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
/ 
```

# c# - 在基于 Googlemap 的标记时间中绘制多边形

> ID：10737785
> 
> 赞同：0
> 
> 时间：2012-05-24T12:46:02.953
> 
> 标签：c#, javascript, google-maps, maps, gpolygon

我想通过连接googlemap中的标记来绘制一个多边形。时间与每个标记相关联。所以我想根据时间连接每个点。我该怎么做。目前代码是这样实现的。我需要改变的地方。

```
 var marker = new Array();
       var points = new Array();
     for(var i=0;i<value.length;i++)
          {
               var tempar=value[i].split(',');
               var center = new GLatLng(tempar[0], tempar[1]);
               var mar = new GMarker(center, icon);
               var imgpth=tempar[3]; 
               var tme=tempar[2];
               marker.push(mar);   
               marker[i].time = tempar[2];
               points.push(marker[i].getLatLng());
               drawMarker(mar,imgpth,tme);                   
        }
          for(i=;i<marker.length;i++)
         {
            map.addOverlay(marker[i]);
          }
           var polyline = new GPolygon(points, "#f33f00", 2, 1, "#ff0000", 0.2);
           map.addOverlay(polyline); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:59:34.437

最简单的方法是`marker`按时间对数组进行排序。假设该`time`属性具有一些合理的值（不是字符串）：

```
marker.sort(function(a,b){return a.time-b.time}); 
```

如果`time`是一个字符串，那么：

```
marker.sort(function(a,b) {
 var date1 = new Date(a.time);
 var date2 = new Date(b.time);
 return date1.getTime() - date2.getTime();

}); 
```

# grails - 编码特殊字符时出错

> ID：10737786
> 
> 赞同：1
> 
> 时间：2012-05-24T12:46:04.840
> 
> 标签：grails, utf-8, character-encoding

有点奇怪的问题（至少对我来说）。在我的 Grails 应用程序中，我正在发送带有一些特殊字符（东欧字母）的电子邮件。我从数据库中获得的带有特殊字符的字符串的值是有效的，但我在应用程序中创建的字符串有“？”。

更令人困惑的是，在开发中一切正常，但是当我将应用程序部署到 Tomcat 实例时，我得到了问号。

我已将所有内容设置为编码为 UTF-8。至少我如此相信——显然我错过了一些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T13:39:54.713

听起来您没有为您尝试显示的语言安装操作系统语言包。

虽然看起来文件本身已正确保存，并且 JVM 因为支持字符集而“理解”它们，但您使用的 GUI 无法显示相应的编码，因为底层操作系统没有显示它们。

我遇到过类似的问题，对我有用的解决方案是在操作系统中打开相应的语言。

# internet-explorer-8 - CSS3PIE 访问被拒绝

> ID：10737788
> 
> 赞同：2
> 
> 时间：2012-05-24T12:46:09.960
> 
> 标签：internet-explorer-8, access-denied, css3pie

我在我的公司网站上工作，主要是改进 CSS。我想消除很多产生圆角、阴影等的小图像。CSS3 是一个完美的选择，但我们仍然有很多用户使用 IE7 和 IE8，所以我也需要为他们准备这个网站。

找了很多关于CSS3PIE的好意见，我是不是下载下来试试用，但是我的IE8不想配合:)。它说：访问被拒绝：PIE.htc 行：0 字符：0 代码：0。我试图将文件放到一个文件夹和不同的文件夹中，在服务器和本地检查这个...我总是有相同的信息.

HTML：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns:og="http://opengraphprotocol.org/schema/">
<head>
<title>title</title>
<link rel="stylesheet" rev="template" type="text/css" href="styles.css">
</head>

<body id="home" class="cols_One">
<div id="wrapper" class="fauxBlock">
        <div id="header">
        <div id="cap">
        <div id="welcome"></div>
        <div id="quicklinks">abc</div>
        </div>
         </div>
    </div>
</body>
</html> 
```

CSS：

```
#cap {
padding: 0 6px; 
font-size: 12px;
border-left: 1px solid #EEE;
border-right: 1px solid #EEE;
margin-bottom: 2px;
text-align: right;
line-height: 25px;
background: #fcfcfc; /*non-CSS3 browsers will use this*/
background: -webkit-gradient(linear, left top, left bottom, from(#f4f4f4) to(#fcfcfc)); /*old webkit*/
background: -webkit-linear-gradient(left top, left bottom, #f4f4f4, #fcfcfc); /*new webkit*/
background: -moz-linear-gradient(#f4f4f4, #fcfcfc); /*gecko*/
background: -ms-linear-gradient(#f4f4f4, #fcfcfc); /*IE10 preview*/
background: -o-linear-gradient(#f4f4f4, #fcfcfc); /*opera 11.10+*/
background: linear-gradient(#f4f4f4, #fcfcfc); /*future CSS3 browsers*/
-pie-background: ulinear-gradient(#f4f4f4, #fcfcfc); /*PIE*/
-moz-box-shadow: 0 2px 2px #d8d8d8;
-webkit-box-shadow: 0 2px 2px #d8d8d8;
box-shadow: 0 2px 2px #d8d8d8;
behavior:url(PIE.htc);

} 
```

编辑：我添加了代码示例

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T10:44:34.173

我已经解决了这个问题，将 PIE.htc 的行尾更改为 Unix（不是 Windows）。在 Windows7 + IE7 和 IE8 上测试。

希望这对你有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-12T09:51:09.663

我尝试将`PIE.htc`文件放在根文件或 ( ) 旁边`ex: html file`。并且在`css`文件中使用了与此完全相同的属性。`yourClass{behavior: url(PIE.htc);}`. 实际上将您的 htc 文件与 html 页面而不是`css`文件相关联。它对我有用。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T20:53:16.777

如果 css3pie 作为本地文件而不是在 Web 服务器上运行，则需要在`behavior:`属性中提供完整路径，例如：

```
behavior:url(C:/foo/PIE.htc); 
```

# ios - 在 ios 中使用 NSThread 时出现“收到内存警告”

> ID：10737794
> 
> 赞同：1
> 
> 时间：2012-05-24T12:46:27.267
> 
> 标签：ios, multithreading, memory-management

我正在开发 iPhone 应用程序。我正在使用 NSThread 连续调用包含 C++ 代码的函数。当我使用 NSThread 或 dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0),^{ 函数调用 } 然后它在 5 分钟后给我“收到内存警告”警告并使应用程序崩溃。但是当我在主线程/队列上运行这个函数时它就可以工作了确实。

我也尝试过 Xcode 分析器来检查内存泄漏，但没有发现内存泄漏。

我该如何解决这个问题？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:55:16.467

Instruments 可能看不到所有的内存泄漏，尤其是当您通过传递保留函数调用某些 C 代码时。

在不知道您的线程包含什么的情况下很难给您答案，但您可能想检查您的代码中是否存在未释放的对象/错误释放/销毁的对象。

您还应该检查您没有创建一大堆线程（`NSThread`），并且它们在终止后正确地释放了它们的内容。

顺便说一句，您的应用程序不应在收到内存警告时终止，这是来自操作系统的正常消息。`viewWillUnload`当/`didReceivedMemoryWarning`函数被调用时检查你的释放。

您还应该尝试使用模拟器手动创建内存警告

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:49:30.703

我在后台线程上使用 NSOperationQueue 时遇到了类似的问题。假设您已经在函数中声明了强制 NSAutoreleasePool ，您可以尝试自己分配/释放对象，除非必要，否则不要使用自动释放，以确保及时释放内存。

第二个建议是使用 Instruments and Allocations，看看究竟是什么占用了你的内存。可能您有一些对象被保留而没有在应该被释放的时候被释放。当谈到这个[http://www.friday.com/bbum/2010/10/17/when-is-a-leak-not-a-leak-using-heapshot-analysis-to-find时，这篇文章令人惊叹-undesirable-memory-growth/](http://www.friday.com/bbum/2010/10/17/when-is-a-leak-not-a-leak-using-heapshot-analysis-to-find-undesirable-memory-growth/)你也可以在这里找到一些有用的信息[http://www.cimgf.com/2008/04/02/cocoa-tutorial-fixing-memory-leaks-with-instruments/](http://www.cimgf.com/2008/04/02/cocoa-tutorial-fixing-memory-leaks-with-instruments/)

否则...您需要发布更多详细信息。

祝你好运！

# app-config - Micsoroft 企业验证框架 -> 如何为每个验证类型拥有一个配置文件

> ID：10737801
> 
> 赞同：0
> 
> 时间：2012-05-24T12:46:56.080
> 
> 标签：app-config, enterprise-library

我正在使用微软企业验证框架。我正在我的 app.config 文件中链接文件“validation.config”。

```
<section name="validation"    type="Microsoft.Practices.EnterpriseLibrary.Validation.Configuration.ValidationSettings, Microsoft.Practices.EnterpriseLibrary.Validation, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
        allowLocation="true" allowDefinition="MachineToApplication" restartOnExternalChanges="false"  />

<validation configSource="LocalConfiguration\validation.config" /> 
```

在'validation.config'文件中我有

```
<?xml version="1.0" encoding="utf-8" ?>
<validation>
    <type name="Car">
     <ruleset>
      <properties>
       <validators>...</validators>
      </properties>
     </ruleset>
    </type>
    <type name="Human">
     <ruleset>
      <properties>
       <validators>...</validators>
      </properties>
     </ruleset>
    </type>
</validation> 
```

问题是：我可以将“汽车”和“人类”类型放在不同的文件中，并将这些文件链接到validation.config 中，还是有任何其他分离方式，因为我的验证器太多，我希望它干净简单读书。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T08:06:55.947

[@.NETJunkie](https://stackoverflow.com/users/264697/)有一篇关于[将验证应用程序块配置拆分为多个文件](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=72)的博客文章，应该可以满足您的需求。

# image - Outlook 2010 不显示使用 multipart/related 发送的 HTML 电子邮件

> ID：10737803
> 
> 赞同：1
> 
> 时间：2012-05-24T12:47:05.153
> 
> 标签：image, debugging, html-email, outlook-2010, multipart

我正在编写带有几个嵌入式图像的电子邮件通讯。标题看起来像：

```
... (snip)
MIME-Version: 1.0
Content-type: multipart/related;
boundary="xyzzy1220091"

This message is in MIME format. Since your mail reader does not understand
this format, some or all of this message may not be legible.

--xyzzy1220091
Content-type: text/html; charset=iso-8859-1; name="tempE924AAC7.html"
Content-description: html
Content-transfer-encoding: 7bit
Content-disposition: INLINE

(HTML newsletter here)

--xyzzy1220091
Content-type: image/jpeg; name="cabecera.jpg"
Content-description: cabecera
Content-transfer-encoding: base64
Content-disposition: inline; filename="cabecera.jpg";
Content-ID: <cabecera> 
```

这在 Gmail、Hotmail、Apple Mail 中都能正常工作……除了 Outlook 2010 之外，我测试过的所有东西都在其中。在其中，它将显示一条空消息，并将 HTML 和 JPG 文件作为附件显示在单独的选项卡中；如果您单击 HTML，它将向您显示一个预览按钮，其中包含有关仅显示来自受信任来源的预览的警告。

如果我不以多部分/相关附件的形式发送时事通讯，而只是以 HTML 电子邮件的形式发送：

```
Content-type: text/html
Content-transfer-encoding: quoted-printable 
```

然后它在 Outlook 中完美显示......但当然，我不能添加内联图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-05T02:53:15.797

> 至于原始问题，我通过使用“multipart/alternative”解决了它，而不是将 HTML 部分附加为文件

# java - 从源类中拆分测试类？

> ID：10737805
> 
> 赞同：1
> 
> 时间：2012-05-24T12:47:08.913
> 
> 标签：java, unit-testing

我正在为插件编写测试，现在我的问题是为测试类创建一个单独的测试源文件夹更好还是我可以将它们全部放在正常的源目录中？

因为我认为最好将功能类与测试类分开。所以不能有错误。此外，如果有人将插件部署到系统中，则除了测试类之外的所有类都将部署。我对吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T12:48:21.217

**将测试类保存在单独的源文件夹中。**

你说的对。最好将它们放在单独的源文件夹中。您不想在部署插件时部署这些类，因此最好将它们分开。当您生成文档时，您也不希望这些测试类混合在一起。

# jquery - 合并到这个 jQuery

> ID：10737806
> 
> 赞同：0
> 
> 时间：2012-05-24T12:47:10.853
> 
> 标签：jquery, merge, this

```
var bottomStack = function () {
                "use strict";
                ...
                jQuery('#bottomstacktitle', this.frame).bind('click', this.toggleFrame);
            };
            var = bottomStackExtends = {
                ...
                toggleFrame: function (animate) {
                    "use strict";
                    if (false !== animate) {
                        animate = true;
                    }
                    this.frame[((animate) ? 'animate' : 'css')]({bottom: (this.bottomStackClosed ?  -180 : 0)});
                    jQuery.cookie("bottomStackClosed", (!this.bottomStackClosed).toString());
                },...
            }; 
```

当它运行时，调试器会说：“未捕获的异常：TypeError：无法将'this.frame'转换为对象”。是的，因为这个“this”不是那个“this”，但是这个“this”是 jQuery('#bottomstacktitle', this.frame)。那么我可以合并到这个“this”，例如：.frame 标签吗？

我试过了：

```
var bottomstacktitle = jQuery('#bottomstacktitle', this.frame);
    bottomstacktitle.frame = this.frame;
    bottomstacktitle.bind('click', this.toggleFrame); 
```

但不工作

你有什么解决办法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T13:16:28.813

您可以使用 jQuery 检索最近的`frame`：

```
var bottomStack = function () {
  "use strict";
   ...
   jQuery('#bottomstacktitle', this.frame).bind('click', this.toggleFrame);
};

var bottomStackExtends = {
  toggleFrame: function (animate) {
    "use strict";
    var currentFrame = jQuery(this).closest("frame").get(0);

    currentFrame[!!animate ? 'animate' : 'css']({
      bottom: this.bottomStackClosed ? -180 : 0
    });
    jQuery.cookie("bottomStackClosed", !this.bottomStackClosed));
  }
  // ...
}; 
```

jQuery 确保它`this`始终指向函数使用的元素。

在`click`处理程序中，它将是接收到单击 ( `'#bottomstacktitle'`) 的元素。由于该元素包含在您的框架中，您可以使用它`.closest()`来检索正确的框架对象。

# oracle - 从oracle中的触发器插入多条记录

> ID：10737807
> 
> 赞同：1
> 
> 时间：2012-05-24T12:47:11.493
> 
> 标签：oracle, plsql, triggers, cursor

我创建了一个触发器，以便在更新职位时插入员工 ID。在某些情况下，一个职位有很多员工，因此触发器无法插入所有员工（只有 1 个）。我需要所有员工 ID

任何人都可以帮我处理这段代码吗？

问候

```
create or replace trigger postn_updt
after update on postn
for each row

declare 

cursor m is 
select u.login
from user u,
party_per s
where u.row_id=s.person_id 
and s.party_id=:new.row_id;

rownum varchar2(10);

begin
if updating ('postn_type_cd') then
open mult;
fetch mult into rownum;

insert into test123
(employee_number,type,request_date,remarks)
values
(( rownum,
'Updated',sysdate,''
);
close m;
end if;
end; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T12:53:47.660

触发器！= 应用程序代码

如果您像这样将应用程序代码嵌入到触发器中，那么维护和调试将非常糟糕，并且您将始终遇到基于触发器的方法由于变异表错误而无法工作的情况。

您最好只为审计和其他非应用程序活动保留触发器，并将这种逻辑放在应用程序本身中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-16T14:47:03.213

要插入多行，您将需要一个 LOOP 或某种形式的“INSERT...SELECT”语句。

例如。

```
create or replace trigger postn_updt
after update on postn
for each row

declare 

cursor m is 
select u.login
from user u,
party_per s
where u.row_id=s.person_id 
and s.party_id=:new.row_id;

begin
if updating ('postn_type_cd') then

  for mult_rec in  m LOOP

    insert into test123
    (employee_number,type,request_date,remarks)
    values
    (( mult_rec.login,
    'Updated',sysdate,''
    );
  END LOOP;

end if;
end; 
```

或者

```
create or replace trigger postn_updt
after update on postn
for each row

declare 
begin
if updating ('postn_type_cd') then

    insert into test123
    (employee_number,type,request_date,remarks)
    select u.login ,'Updated',sysdate,''
    from user u,
        party_per s
    where u.row_id=s.person_id 
    and s.party_id=:new.row_id;

end if;
end; 
```

# objective-c - 复制、粘贴、删除操作的系统音效

> ID：10737809
> 
> 赞同：2
> 
> 时间：2012-05-24T12:47:16.100
> 
> 标签：objective-c, cocoa, audio, copy-paste, finder

有谁知道如何在 OS X 上播放（拖动）复制、粘贴和删除操作的系统音效？我的意思是 Finder 在移动文件时使用的声音。我没有找到任何 API 来做到这一点。有人可能知道这些声音文件的位置吗？我只发现系统警报声（青蛙、潜艇等）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T06:32:54.753

`SystemSounds`可在

`/System/Library/Components/CoreAudio.component/Contents/Resources/SystemSounds/` 地点。

```
NSSound *systemSound = [[NSSound alloc] initWithContentsOfFile:@"/System/Library/Components/CoreAudio.component/Contents/Resources/SystemSounds/finder/move\ to\ trash.aif" byReference:YES];
if (systemSound) {
    [systemSound play];
}  

/System/Library/Components/CoreAudio.component/Contents/Resources/CoreAudioAUUI.bundle/Contents/Resources 
```

# java - 如何在 Java 中解析 .pb 文件？

> ID：10737810
> 
> 赞同：0
> 
> 时间：2012-05-24T12:47:23.797
> 
> 标签：java, parsing, protocol-buffers

我有 .proto 和 .pb 文件。我需要使用 Java 解析 .pb 文件。我不知道如何使用这个 .pb 文件。请问有人可以帮我解析 .pb 文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:54:32.430

假设 *.pb 文件是一个内容符合 *.proto 规范的文件，您可以使用 Google 提供的协议缓冲区代码为 *.pb 文件生成阅读器：[http ://code.google.com/p/ protobuf/](http://code.google.com/p/protobuf/)

有一个专门针对 Java 的教程，介绍如何生成阅读器和反序列化消息。查看[https://developers.google.com/protocol-buffers/docs/javatutorial](https://developers.google.com/protocol-buffers/docs/javatutorial)了解更多详情。

# c - 处理函数内部的常量

> ID：10737811
> 
> 赞同：5
> 
> 时间：2012-05-24T12:47:28.063
> 
> 标签：c, system, constants, c-preprocessor

如果某事为真，我想定义一个常量，并在“system（”）中使用它的值；

例如：

```
#ifdef __unix__
#   define CLRSCR clear
#elif defined _WIN32
#   define CLRSCR cls
#endif

int main(){
    system("CLRSCR"); //use its value here.
} 
```

我知道`clrscr();`conio.h/conio2.h 中有，但这只是一个例子。当我尝试启动它时，它说`cls`未声明，或者 CLRSCR 不是内部命令（bash）

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T12:51:19.613

常量是一个*标识符*，而不是*字符串文字*（字符串文字有双引号；标识符没有）。

另一方面，常量值是字符串文字，而不是标识符。你需要像这样切换它：

```
#ifdef __unix__
#   define CLRSCR "clear"
#elif defined _WIN32
#   define CLRSCR "cls"
#endif

int main(){
    system(CLRSCR); //use its value here.
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T12:51:11.837

你需要这个：

```
#ifdef __unix__
   #define CLRSCR "clear"
#elif defined _WIN32
   #define CLRSCR "cls"
#endif

system(CLRSCR); //use its value here. 
```

# .net - 将小程序与 mvc3 集成

> ID：10737812
> 
> 赞同：0
> 
> 时间：2012-05-24T12:47:30.193
> 
> 标签：.net, asp.net-mvc, applet

如何在视图中集成applet和mvc3。

1.我将小程序代码放在控制器中

归档 = "/Content/Applets/applet.jar"

2.不知何故，小程序没有被加载。

是否与存档有关

# c++ - 当我使用 vector::erase 时它崩溃的原因是什么？

> ID：10737815
> 
> 赞同：2
> 
> 时间：2012-05-24T12:47:49.640
> 
> 标签：c++, stl, vector

我正在尝试对向量进行一些操作。并且仅在某些情况下才在向量上调用擦除。

这是我的代码

```
while(myQueue.size() != 1)
{
    vector<pair<int,int>>::iterator itr = myQueue.begin();
    while(itr != myQueue.end())
    {
        if(itr->first%2 != 0)
            myQueue.erase(itr);
        else
        {
            itr->second = itr->second/2;
            itr++;
        }
    }
} 
```

我在第二次迭代中崩溃了。而且我在消息向量迭代器不兼容的情况下崩溃了。

崩溃的原因可能是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T12:51:12.900

如果`erase()`调用迭代器，则该迭代器无效，然后在循环的下一次迭代中访问该迭代器。[`std::vector::erase()`](http://en.cppreference.com/w/cpp/container/vector/erase)在被擦除的迭代器之后返回下一个迭代器：

```
itr = myQueue.erase(itr); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T12:53:45.040

给定一个迭代器范围`[b, e)`，其中`b`是向量范围的开始和结束，在该范围内某处`e`的迭代器上的擦除操作将使从upto的所有迭代器无效。这就是为什么您在调用时需要非常小心的原因。该成员确实返回了一个新的迭代器，您可以将其用于后续操作，并且您应该使用它：`i``i``e``erase``erase`

```
 itr = myQueue.erase( itr ); 
```

另一种方法是交换`i`元素和最后一个元素，然后擦除最后一个。这更有效，因为`i`需要的元素移动次数更少。

```
myQueue.swap( i, myQueue.back() );
myQueue.pop_back(); 
```

另外，从外观上看，您为什么要使用`vector`? 如果你需要一个`queue`你不妨使用`std::queue`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T12:54:29.597

那是未定义的行为。特别是，一旦你删除了一个迭代器，它就会变得无效，你不能再将它用于任何事情。展开循环的惯用方式如下：

```
for ( auto it = v.begin(); it != v.end(); ) {
   if ( it->first % 2 != 0 )
      it = v.erase(it);
   else {
      it->second /= 2;
      ++it;
   }
} 
```

但是话又说回来，不滚动自己的循环而是使用算法会更有效和惯用：

```
v.erase( std::remove_if( v.begin(),
                         v.end(),
                         []( std::pair<int,int> const & p ) {
                             return p.first % 2 != 0;
                       }),
         v.end() );
std::transform( v.begin(), v.end(), v.begin(), 
                []( std::pair<int,int> const & p ) {
                    return std::make_pair(p.first, p.second/2);
                } ); 
```

这种方法的优点是在擦除时元素的副本数量较少（范围内剩余的每个有效元素将被复制不超过一次），并且更难出错（即误用无效的迭代器...）缺点是没有`remove_if_and_transform`，所以这是一个两遍算法，如果有大量元素，效率可能会降低。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-24T12:58:49.833

在修改循环时进行迭代通常很棘手。

因此，有一个特定的 C++ 习语可用于非关联序列：erase-remove 习语。

它结合了`remove_if`算法的使用和方法的范围重载`erase`：

```
myQueue.erase(
    std::remove_if(myQueue.begin(), myQueue.end(), /* predicate */),
    myQueue.end()); 
```

其中谓词表示为典型的仿函数对象或使用新的 C++11 lambda 语法。

```
// Functor
struct OddKey {
    bool operator()(std::pair<int, int> const& p) const {
        return p.first % 2 != 0;
    }
};

/* predicate */ = OddKey()

// Lambda
/* predicate */ = [](std::pair<int, int> const& p) { return p.first % 2 != 0; } 
```

lambda 形式更简洁，但可能较少自我记录（无名称），并且仅在 C++11 中可用。根据您的口味和限制，选择最适合您的一种。

* * *

可以提升您编写代码的方式：使用[Boost.Range](http://www.boost.org/doc/libs/1_49_0/libs/range/doc/html/index.html)。

```
typedef std::vector< std::pair<int, int> > PairVector;

void pass(PairVector& pv) {
    auto const filter = [](std::pair<int, int> const& p) {
        return p.first % 2 != 0;
    };
    auto const transformer = [](std::pair<int, int> const& p) {
        return std::make_pair(p.first, p.second / 2);
    };

    pv.erase(
        boost::transform(pv | boost::adaptors::filtered( filter ),
                         std::back_inserter(pv),
                         transformer),
        pv.end()
    );
} 
```

您可以在文档中找到[`transform`](http://www.boost.org/doc/libs/1_49_0/libs/range/doc/html/range/reference/algorithms/mutating/transform.html)和[`filtered`适配器](http://www.boost.org/doc/libs/1_49_0/libs/range/doc/html/range/reference/adaptors/reference/filtered.html)，以及许多其他内容。

# php - 将多维数组中的数组值与索引进行比较

> ID：10737816
> 
> 赞同：0
> 
> 时间：2012-05-24T12:47:52.310
> 
> 标签：php, html, arrays

我有一个像这样的多维数组：

```
Array
(
[0] => Array
    (
        [name] => >chr1:2198584545754_genome_1000+
        [score] => 511
        [hit] => 50   

    )

[1] => Array
    (
        [name] => >chr2:2198581212154_genome_1000+
        [score] => 620
        [hit] => 80   

    )

[2] => Array
    (
        [name] => >chr3:2115151215754_genome_1000+
        [score] => 666
        [hit] => 90   

    )

[3] => Array
    (
        [name] => >chr4:2198584545754_genome_1000+
        [score] => 750
        [hit] => 50 

    )

[4] => Array
    (
        [name] => >chr5:1218455145754_genome_1000+
        [score] => 800
        [hit] => 100  

    )

[5] => Array
    (
        [name] => >chr6:1231354645454_genome_1000+
        [score] => 850
        [hit] => 110  

    )

[6] => Array
    (
        [name] => >chr7:1231213211134_genome_1000+
        [score] => 900
        [hit] => 120  

    )

 ) 
```

我有一个 foreach 循环，它将遍历随机序列的每个字母，并使用索引给每个字母一个数字值。如果 ['hit'] 的值与随机序列的索引值匹配，我想插入一个函数。

我无法弄清楚这一点。我认为我的问题在于调用 ['hit'] 的每个值并与索引进行比较。有谁知道如何做到这一点 ？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:15:40.613

将 DaveRandom 的评论放入答案中（稍作修改）：

```
foreach ($outerArray as $index => $innerArray)
{
    if($innerArray['hit'] === $index)
    {
        doSomething();
    }
} 
```

@DaveRandom - 如果我在这里不按顺序发布，请随意删除或重新发布此作为您自己的答案...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T13:29:56.683

```
 foreach ($array as $key) {

       if ($key['hit'] == $index)

        { 

      // you function or logic here

        } 

    } 
```

# perl - Net::Telnet::Cisco 从不同的源地址到路由器

> ID：10737825
> 
> 赞同：0
> 
> 时间：2012-05-24T12:48:33.333
> 
> 标签：perl, telnet, cisco

我有一个带有 eth0 和 eth1 的服务器。

```
eth0 = 10.0.0.10
eth1 = 10.10.0.10 
```

现在，如果我执行以下操作，telnet 将使用来自 eth0 的 IP 地址。

```
 $device_object = Net::Telnet::Cisco->new( Host => $Router);
    $device_object->login( Name => $Username, Passcode => $Password) || die "Can't login to $HOST\n$!\n";
    @output = $session->cmd('show ip int brief');
    print @output; 
```

如何使用 eth1 作为源地址连接到 cisco 路由器，执行命令并获得输出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T13:07:16.470

该模块继承自[IO::Socket::INET](http://p3rl.org/IO%3a%3aSocket%3a%3aINET)，请阅读`LocalAddr`.

# grails - Grails 处理网络连接停止

> ID：10737826
> 
> 赞同：1
> 
> 时间：2012-05-24T12:48:36.540
> 
> 标签：grails, soap, ws-client

我正在使用 Grails Ws-Client 插件，但我的应用程序等待从我正在使用 Web 服务的服务器返回的 SOAP 响应，并且我的应用程序等待此代码

```
def proxy = webService.getClient(wsdlUrl) 
```

这主要发生在服务器关闭或网络连接缓慢时。

如果 Web 服务暂时从服务器中删除并且包含 wsdl 的 url 在尝试在 Web 浏览器上访问时重定向到网站的主页，则等待也会继续。

如何检测 wsdl 是否存在以及如何设置类似属性的超时，以便等待响应存在 10 秒，然后停止等待响应，并且代码开始正常执行以防停顿。

我也没有得到任何异常或错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:52:09.333

听起来默认情况下客户端上没有设置读取和/或连接超时。如果 Web 服务关闭，这应该会有所帮助： `proxy.setConnectionTimeout(value_in_milliseconds)`

不过，我不确定是否设置读取超时，如果主机已启动并接受连接但 Web 服务不可用或没有响应，您会看到这一点。我们为此找到的最佳解决方案是使用 Apache Commons HTTP 客户端而不是默认客户端，这为我们提供了对客户端连接设置更精细的配置。它们可能也在 WS-Client 插件中，但相关文档（实际上是 GroovyWS 文档）似乎没有提到任何有关读取超时的内容。

# iphone - NSDictionary 到 CGPoint

> ID：10737835
> 
> 赞同：0
> 
> 时间：2012-05-24T12:49:22.773
> 
> 标签：iphone, cocos2d-iphone, nsdictionary, cgpoint

我正在开发一款游戏，如果子弹分别在单击和双击上，我会尝试发射两种不同类型的子弹。

这是我在触摸开始方法中所做的事情：

```
- (void)ccTouchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
{
    for( UITouch *touch in touches ) 
    {

        CGPoint location = [touch locationInView: [touch view]];
        location = [[CCDirector sharedDirector] convertToGL: location];

        NSLog(@"TOUCH LOCATION IN TOUCH BEGAN  = (%f , %f)", location.x , location.y);

        NSUInteger tapCount = [touch tapCount];

        switch (tapCount)
        {
            case 1:
            {
                NSDictionary * touchloc = [NSDictionary dictionaryWithObject:[NSValue valueWithCGPoint:location] forKey:@"location"];
                [self performSelector:@selector(startTimer:) withObject:touchloc afterDelay:3];
                break;
            }   
            case 2:
            {
                [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(startTimer) object:nil];
                [self performSelector:@selector(removeBall) withObject:nil afterDelay:1];
                break;
            }

            default:
            {
                break;
            }
        }
  } 
```

现在`perform selector(startTimer:)`我得到了我接触的点的坐标`NSPoint`（当我使用时`NSDictionary`）我想知道的是..我们如何将这些点转换为CGPoints..？

知道我该怎么做吗？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-24T12:55:14.690

如果您正在使用`NSValue`，您可以`CGPoint`使用`CGPointValue`.

例如

```
NSDictionary * touchloc = [NSDictionary dictionaryWithObject:[NSValue valueWithCGPoint:location] forKey:@"location"];
    CGPoint points = [[touchloc valueForKey:@"location"] CGPointValue]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:51:50.077

`CGPointCreateDictionaryRepresentation`和`CGPointMakeWithDictionaryRepresentation`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-08T09:40:00.663

对我来说，保存和返回 cgpoint 到 nsdictionary 的正确函数如下：

```
NSDictionary * touchloc = [NSDictionary dictionaryWithObject:[NSValue valueWithPoint:cgPointPositionTouchPoint] forKey:@"location"];

CGPoint points = [[touchloc valueForKey:@"location"] pointValue]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T13:03:45.463

文档说 NSPoint 是：

```
typedef struct _NSPoint {
    CGFloat x;
    CGFloat y;
} NSPoint; 
```

和 CGPoint 是：

```
struct CGPoint {
     CGFloat x;
    CGFloat y;
};
typedef struct CGPoint CGPoint; 
```

因此它们是等效的结构，您应该能够简单地转换为从一个转换为另一个。两者都不是对象类型，因此您不能直接将它们存储在字典中，而是必须将它们打包在 NSValue 中以将它们转换为对象。您可能从字典中获取 NSValue 对象，并且 NSValue 具有两种类型的访问器，因此您可以直接获得所需的对象而无需强制转换：

```
CGPoint a = [somePoint CGPointValue];
NSPoint b = [somePoint pointValue]; 
```

# architecture - 如何避免后端和前端的逻辑重复？

> ID：10737837
> 
> 赞同：0
> 
> 时间：2012-05-24T12:49:31.217
> 
> 标签：architecture, frontend, backend

**我有一个在PHP 后端**和**前端**有一些逻辑计算重复的 Web 应用程序，由于应用程序的高性能要求和响应能力，即使使用有效的缓存，我也无法将逻辑完全放置到后端并每次都发出 AJAX 请求。

您能否建议解决此问题的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:01:37.010

如果结果不被进一步使用，我会将计算逻辑移到前端。

例如：如果你在做一个简单的抵押贷款计算器，而最终用户在输入首付后想要一个简单的答案等。那么使用前端。

另一方面，如果计算结果必须进一步用于网格、电子邮件或数据库等对象，则将逻辑保留在后端。

# javascript - 如何实现自动调整到视口的滚动效果

> ID：10737838
> 
> 赞同：1
> 
> 时间：2012-05-24T12:49:40.560
> 
> 标签：javascript, jquery, html, scroll

[http://teacakedesign.com/](http://teacakedesign.com/)

这是我指的网站。它将自动调整滚动项目的大小以适应浏览器视口中的可用空间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:58:16.497

我不知道这是否是最好的解决方案，但这就是我要开始的方式：将容器的高度设置为元素数 * 100 %（例如：5 个元素 -> 500%）。每个内部元素的高度为 100 / n 个元素。在 js 文件中，我会在用户滚动时检查窗口的高度，然后将滚动条向上或向下设置“n”个像素的动画。

# ant - 如何将文件复制到目录中而不会丢失ant中目录的先前内容？

> ID：10737839
> 
> 赞同：0
> 
> 时间：2012-05-24T12:49:47.267
> 
> 标签：ant

嗨，这是我将文件从一个位置复制到另一个位置的代码

```
<copy file="${MyParam}\${files.Sloc}\${files.names}" tofile="..\${cmdname}\${files.Tloc}\${files.names}"> </copy> 
```

虽然它正在将文件完美地复制到它的目的地，但你的问题是它正在删除以前的目录结构，如果我有

`D:/a/b/c/d/e``e`如果我现在已经有文件，`1,2,3,4`如果我想将另一个文件放入`e`，而不是将其放入`e`上述任务中，首先删除`D:/a/b/c/d/e` 所有文件`e`并创建新路径`D:/a/b/c/d/e`并将新文件放在那里，所以我失去了一切。无论如何，请帮助。尝试了一些事情，但他们没有工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T16:53:33.997

你错了。我创建了这个例子：

```
<project default="run">
<target name="run">
    <!-- create new directory with some files -->
    <delete dir="a/b/c/d/e"/>
    <mkdir dir="a/b/c/d/e"/>
    <touch file="a/b/c/d/e/1"/>
    <touch file="a/b/c/d/e/2"/>

    <!-- list directory contents -->
    <fileset id="e.contents.before" dir="a/b/c/d/e"/>
    <property name="prop.e.contents.before" refid="e.contents.before"/>
    <echo>Before copy: ${prop.e.contents.before}</echo>

    <!-- copy some file to directory -->
    <copy file="build.xml" tofile="a/b/c/d/e/build.xml"> </copy>

    <!-- list directory contents -->
    <fileset id="e.contents.after" dir="a/b/c/d/e"/>
    <property name="prop.e.contents.after" refid="e.contents.after"/>
    <echo>After  copy: ${prop.e.contents.after}</echo>
</target> 
```

输出在 Linux 上使用 Ant 1.8.2：

构建文件：/tmp/t/build.xml

运行：
[delete] 删除目录/tmp/t/a/b/c/d/e
[mkdir] 创建目录：/tmp/t/a/b/c/d/e
[touch] 创建/tmp/t/ a/b/c/d/e/1
[touch] 创建 /tmp/t/a/b/c/d/e/2
[echo] 复制前：1;2
[copy] 将 1 个文件复制到 /tmp/ t/a/b/c/d/e
[echo] 复制后：1;2;build.xml

构建成功
总时间：0 秒

# oracle - 作业操作字符串太长

> ID：10737840
> 
> 赞同：0
> 
> 时间：2012-05-24T12:49:48.583
> 
> 标签：oracle, action, jobs

我正在尝试创建一个将在午夜同步两个数据库的作业。有 10 个表需要同步。这是一个很长的 PL SQL 脚本。当我将此脚本设置为 JOB ACTION 并尝试创建作业时，我得到“字符串值对于属性作业操作而言太长”。你建议我怎么做？我应该将 scipt 分成 10 个吗？有没有办法让作业将代码作为脚本运行。如果我手动操作，所有 10 个匿名块都会一个接一个地执行。我需要一些能在半夜按 F5 的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:51:29.127

您需要的是一个 DBMS_Scheduler 链，其中每个操作都是一个单独的步骤，并且它们可以同时执行。

[http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_sched.htm](http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_sched.htm)

# asp.net - IIS Worker 进程在第一次请求时永远挂起

> ID：10737845
> 
> 赞同：3
> 
> 时间：2012-05-24T12:50:21.043
> 
> 标签：asp.net, iis, worker-process

我正在努力解决我这几天遇到的问题。每次我的一个站点被重建或 AppPool 被回收时，第一个页面加载将永远挂起（好吧，我只等了 30 分钟）。它只发生在大约 10 个站点中的一个特定站点上。它是一个 ASP.NET 站点。

以下是我观察到的事情：

*   在工作进程下的 IIS 管理器中，我可以看到该请求。动词 = GET，Sate = ExecuteRequestHandler，模块名称 = ManagedPipelineHandler。当然，经过的时间只会不断增加。
*   如果我关闭发出初始请求的浏览器，然后打开一个新的浏览器发出另一个请求，页面将立即加载。
*   在我的代码中，我的 Global.asax 文件的 Application_Start 不会在第一次请求时调用。在第二个请求时调用它。
*   工作进程导致我机器上的内存使用量激增

我在对 IIS 进行故障排除方面缺乏经验，但是数小时的搜索使我无处可去。

我们最近在网站上所做的唯一主要代码更改是我们已经开始使用 log4net 实现日志记录。我已经尝试从我的 web.config 文件和 Global.asax 中删除任何 log4net 代码 - 仍然没有运气。

有没有其他人经历过这种情况，如果有，你是如何解决的？

任何和所有的帮助将不胜感激。

**添加：** 如果我在站点的根目录中放置一个 .txt 文件并将其作为构建后的第一件事加载，它将立即加载。然而，工作进程仍然像以前一样工作，内存使用量仍然很高。

**最终编辑：**

我觉得自己像个白痴。我无法解释为什么，但由于某种原因，我在 Global.asax 中的断点突然被击中，我能够确定问题所在。这是通过实体框架对数据库的调用，写得不好——即过滤是在提取了相关列中的所有行之后完成的。更糟糕的是，过滤是在 foreach 循环中完成的。不管怎样，现在一切都恢复正常了，我很高兴。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T13:57:29.433

可能说明了这一点，但您在 app_start 的全局 asax 中没有任何可能导致此问题的愚蠢代码？

听起来像一个无限循环或什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-24T06:23:00.023

快速记录一下我的情况：

[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)和[Failed Request Tracing](http://www.iis.net/learn/troubleshoot/using-failed-request-tracing/troubleshooting-failed-requests-using-tracing-in-iis)都没有任何帮助。该网站只是（几乎）永远加载。

最后，在等待几分钟后，出现了一个错误，指出它“找不到网络路径”。

**原因**是我输入了一个不存在的 SQL Server 实例的连接字符串，所以它以某种方式一直在搜索服务器。最后，发生了超时。

**解决方案**是在 Web.Config 内的连接字符串中简单地指定正确的 SQL Server。

# java - 如何创建密钥库 (.pfx) 文件

> ID：10737849
> 
> 赞同：0
> 
> 时间：2012-05-24T12:50:32.823
> 
> 标签：java, openssl, keytool

我新购买了 RAPID 通配符 SSL 证书。现在我想生成密钥库（.pfx）文件。谁能帮助我并告诉我相同的步骤是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:58:41.653

从[这个链接](http://www.jpedal.org/PDFblog/2010/09/creating-your-own-test-certificates-and-keys-for-signing-pdf-files/)。

在 Windows 中打开一个控制台窗口，cd 到某个合理的地方并输入：

```
cipher /r:whateveryoulike 
```

输入密码，您将拥有一个证书 (whateveryoulike.cert) 和一个 .pfx 文件 (whateveryoulike.pfx)。

# xcode - 自定义单元格 - 我如何将推文分成组件separatedbyString

> ID：10737850
> 
> 赞同：0
> 
> 时间：2012-05-24T12:50:36.083
> 
> 标签：xcode, tableview

我在表格视图中有一个自定义单元格。所有连接都已建立。我正在进行推特搜索。此结果会在 tableView 中传播自定义单元格。我想使用 componentsseparatedbystring 将单个推文分成一个数组，以便我可以将它们分配给我的自定义单元格中的 4 个标签。任何帮助将不胜感激。这是我的代码。

```
 - (void)fetchTweets
    {
        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
            NSData* data = [NSData dataWithContentsOfURL:
                            [NSURL URLWithString: @"https://api.twitter.com/1/statuses/public_timeline.json"]];

            NSError* error;

            tweets = [NSJSONSerialization JSONObjectWithData:data
                                                     options:kNilOptions
                                                       error:&error];

            dispatch_async(dispatch_get_main_queue(), ^{
                [self.tableView reloadData];
            });
        });
    }

    - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
    {
        return tweets.count;

    }

    - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        static NSString *CellIdentifier = @"TweetCell";

        customCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
        if (cell == nil) {
                // added this bit in
            cell = [[customCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

        }

       // THIS IS THE BIT I'M STRUGGLING WITH
// I'M GUESSING THAT THIS LINE SEPARATES THE TWEETS INTO SINGLE TWEETS?
        NSDictionary *tweet = [tweets objectAtIndex:indexPath.row];
// I THEN CREATE AN ARRAY TO HOLD MY COMPONENTS OF THE TWEET SO THAT I CAN SPLIT FOR MY LABELS
        NSArray *arrayForCustomCell = [[NSArray alloc] init];

        arrayForCustomCell = [tweet componentsSeparatedByString:@":"];

        return cell;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:20:07.197

您已经在异步调用中解析了结果。现在，你有一个'tweet'字典数组，你可以像这样获取任何值：

```
NSDictionary *tweet = [tweets objectAtIndex:indexPath.row];
NSString *tweetText = [tweet valueForKey:@"text"];
NSString *tweetCountry = [tweet valueForKeyPath:@"place.country"] //Nested property 
```

然后你只需设置你的`UILabels`. 你明白了……

# c# - 通过代码从 .net 备份 Oracle 数据库

> ID：10737853
> 
> 赞同：1
> 
> 时间：2012-05-24T12:50:46.303
> 
> 标签：c#, .net, sql, oracle, setup-project

我想通过 .Net 代码备份或恢复我的 oracle 数据库。我搜索了很多，但没有找到任何正确的解决方案。就像我们通过执行查询在 SQL Server 中进行备份一样。

```
backup database :DatabaseName to disk = ':DestinationPath 
```

我想在 Oracle 中做同样的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T13:28:14.260

您可以使用诸如 exp/imp 或更新的 Oracle 数据泵之类的 Oracle 实用程序来创建数据库导出（备份），但您必须在数据库之外的命令行/终端窗口中执行这些操作。有关更多信息，请参见：[http ://www.oracle-base.com/articles/10g/oracle-data-pump-10g.php](http://www.oracle-base.com/articles/10g/oracle-data-pump-10g.php)

**更新**：我的立场得到纠正。数据泵作业可以通过 PL/SQL 启动。谢谢@a-horse-with-no-NAME。

本文介绍如何从 sql 启动数据泵作业：http: [//docs.oracle.com/cd/B19306_01/server.102/b14215/dp_api.htm#i1006925](http://docs.oracle.com/cd/B19306_01/server.102/b14215/dp_api.htm#i1006925)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T09:40:07.397

小心：DataPump 或 Exp 导出不是*真正的*Oracle 备份，您应该进行测试以确保您可以从您正在创建的 Dump 文件中恢复。Oracle 与 SQL Server 的 BACKUP DATABASE 命令最接近的是 RMAN，即便如此，它也完全不同。但是从批处理文件调用非常有用。我同时是 SQL Server 和 Oracle 的 DBA，每个引擎执行备份的方式是最大的区别之一。Exp 和 Imp 更类似于 SQL 的 bcp 命令（但更强大）。Exp 不会备份您的 Controlfile 或 AchiveLogs，在发生灾难时您可能需要这些。对于 Exp，确保使用 CONSISTENT=Y 选项（FLASHBACK_TIME 用于较新的 DataPump 导出）。SQL Server 备份更直接，更容易恢复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T11:23:06.857

我找到了一种通过代码备份 oracle 数据库的简单方法。我通过代码从用户那里获取凭据，并动态地制作 exp/imp 命令的批处理文件。并使用进程类运行此批处理命令。

谢谢大家的回复。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-05-24T13:29:36.750

```
OledbCommand cmd=new OledbCommand ("backup database databasename to disk ='C:\databasename.bak'",con);

con.open();

cmd.ExecutenonQuery();

con.close(); 
```

# c++ - 如何使用 ShellExecute 在 Windows 中使用 C++ 打开 html 文件？

> ID：10737854
> 
> 赞同：2
> 
> 时间：2012-05-24T12:50:46.520
> 
> 标签：c++, windows, visual-c++

我正在尝试使用我的代码中的默认浏览器打开一些 html 文件。

我使用以下代码：

```
ShellExecute(NULL, "open", "HELP\index.html",
            NULL, NULL, SW_SHOWNORMAL); 
```

并包含标题“Windows.h”。但是 ShellExecuter:identifier not found 错误出现并且编译失败。

我使用 Microsoft Visual Studio 2010。如何使 ShellExecute 工作，或者更重要的是，如何从我的代码中打开 html 文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T13:01:10.800

要使用 ShellExecute，您应该包含 Shellapi.h 并与 Shell32.lib 库链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-07T19:04:34.920

我有一个类似的问题：

在 WinXP 上

```
ShellExecute( NULL, NULL, "HELP\index.html", NULL, NULL, NULL ); 
```

以及

```
ShellExecute( NULL, "call", "HELP\index.html", NULL, NULL, NULL ); 
```

两者都工作正常。

而仅在 Window-7 (starter) 上

```
ShellExecute( NULL, "open", "HELP\index.html", NULL, NULL, NULL ); 
```

是可能的。

XP 似乎不知道“打开”，Win-7 似乎不知道“调用”。我在所有建筑物中都使用了 MINGW。

# c++ - Qt中的翻译问题

> ID：10737857
> 
> 赞同：0
> 
> 时间：2012-05-24T12:51:00.663
> 
> 标签：c++, qt, translation

我在使用 Qt 翻译时遇到问题：

在一个 tableView 中，我使用一个 Delegate 来获取一个组合框作为编辑功能：

```
this->gndDelegate = new GenderDelegate(this);
ui->tableView->setItemDelegateForColumn(AthleteModel::GENDER_COLUMN, this->gndDelegate); 
```

ComboBox hast to values，我想用`tr()`命令翻译。所有其他翻译工作正常，但这两个添加的项目没有翻译：

```
QWidget *GenderDelegate::createEditor(QWidget *parent, const QStyleOptionViewItem    &option, const QModelIndex &index) const
{
QComboBox *cmbBox = new QComboBox(parent);
cmbBox->addItem(tr("male"), "male");
cmbBox->addItem(tr("female"), "female");

return cmbBox;
} 
```

qm 文件中存在这两个值的表示形式

谢谢你的帮助 ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-29T21:20:48.287

您必须在委托实现中添加指令 Q_OBJECT。例如：

```
class KeyConfigurationDelegate : public QItemDelegate
{
    Q_OBJECT //Add This directive !!!

public:
    explicit KeyConfigurationDelegate(QObject *parent = 0);
    ~KeyConfigurationDelegate();

    QWidget *createEditor(QWidget *parent, const QStyleOptionViewItem &option, const QModelIndex &index) const;

    void setEditorData(QWidget *editor, const QModelIndex &index) const;

    void setModelData(QWidget *editor, QAbstractItemModel *model, const QModelIndex &index) const;

    void updateEditorGeometry(QWidget *editor, const QStyleOptionViewItem &option, const QModelIndex &index) const;

private:

    QStringList list;
    QStringListModel model;
}; 
```

# php - 应用内计费，如何更新服务器端数据库

> ID：10737858
> 
> 赞同：1
> 
> 时间：2012-05-24T12:51:01.053
> 
> 标签：php, android, in-app-billing

当有人在我的 Android 应用程序中购买托管项目时，我正在尝试实现一项功能来更新我的服务器端数据库。

基本上，我希望用户能够在购买托管项目时登录我的网站，但之前不能。有人可以向我提供有关如何完成此操作的详细信息。我想发送一个用户名/电子邮件或类似于我可以用来更新服务器数据库的网页的人。但是，我需要确保这不能由尚未在我的 Android 应用程序中购买托管项目的用户发送

我已经阅读了一些关于这个主题的好帖子，但我仍然不知道如何在我的解决方案中应用它

*   [如何使用带有 Ruby 的服务器验证 Android 应用内计费？](https://stackoverflow.com/questions/5971031/how-do-i-verify-android-in-app-billing-with-a-server-with-ruby)
*   [http://crazyviraj.blogspot.se/2011/06/some-notes-on-implementing-in-app.html](http://crazyviraj.blogspot.se/2011/06/some-notes-on-implementing-in-app.html)

此致

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T13:01:04.803

Google Play 商店会发送每个购买的签名数据和签名。从您的 android 应用程序成功购买商品后，应用程序需要将签名数据和签名发送到您的服务器。然后需要根据公钥验证此数据。验证成功后，您可以向 android 应用程序提供成功响应和登录所需的凭据。

**编辑：**
[Android Inapp 计费概述](http://developer.android.com/guide/market/billing/billing_overview.html)
[示例 Inapp 计费](http://developer.android.com/guide/market/billing/billing_integrate.html#billing-download)
[示例 BroadcastReceiver](http://developer.android.com/guide/market/billing/billing_integrate.html#billing-broadcast-receiver)

请检查 android 示例应用内计费实现。那有一个地牢的例子，它实现了应用内计费。您需要实现一个从 GooglePlay 获取数据的 BroadcastReceiver。com.android.vending.billing.PURCHASE_STATE_CHANGED 意图表示发生了购买。现在您可以从意图中获取签名数据和签名，例如

```
String signedData = intent.getStringExtra("inapp_signed_data");
String signature = intent.getStringExtra("inapp_signature"); 
```

现在您可能需要将此数据传递到您的服务器以识别实际购买它的用户。希望能帮助到你。

# c# - 将图形内容保存到文件

> ID：10737859
> 
> 赞同：1
> 
> 时间：2012-05-24T12:51:10.843
> 
> 标签：c#, winforms, bitmap

我有一些代码在其中将函数图绘制到`PictureBox`图形中。代码在`Paint`事件中实现。在某些时候，我想将图形内容的位图保存在文件中。

我已经阅读了[这个问题](https://stackoverflow.com/questions/4305168/saving-graphics-to-bitmap-outside-of-paint)的答案，但没有找到我要找的东西。

我需要的是在 PictureBox （或您建议的任何其他控件）中绘制，以便在控件被隐藏或其他东西时不会丢失绘图（所以我认为我不能`CreateGraphics()`）*并且*能够将该绘图保存在按钮的点击事件。

如有必要，我愿意将绘图逻辑排除在`Paint`事件之外。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:46:39.843

我继续并根据我的假设回答了这个问题，

我创建了一个新`Winforms`应用程序

我添加了一个面板和一个按钮，我创建了一个`Bitmap`名为的按钮`buffer`，并在`Form1`构造函数中将其初始化为面板的大小。我没有直接绘制到面板，而是绘制到`Bitmap`，然后设置面板背景图像`buffer`；这将为您的图形增加持久性。如果您真的想写入文件，我可以向您展示。问一下。

要写入文件，您将需要此命名空间引用：

```
using System.IO; 
```

我添加了`ImageToDisc`您要求的功能。

*这是代码：*

```
Bitmap buffer;
public Form1()
{
    InitializeComponent();
    panel1.BorderStyle = BorderStyle.FixedSingle;
    buffer = new Bitmap(panel1.Width,panel1.Height);
}

private void button1_Click(object sender, EventArgs e)
{
    using (Graphics g = Graphics.FromImage(buffer))
    {
        g.DrawRectangle(Pens.Red, 100, 100,100,100);
    }

    panel1.BackgroundImage = buffer;
    //writes the buffer Bitmap to a binary file, only neccessary if you want to save to disc
    ImageToDisc();
    //just to prove that it did write it to file and can be loaded I set the mainforms background image to the file
    this.BackgroundImage=FileToImage();
}

//Converts the image to a byte[] and writes it to disc
public void ImageToDisc()
{
    ImageConverter converter = new ImageConverter();
    File.WriteAllBytes(@"c:\test.dat", (byte[])converter.ConvertTo(buffer, typeof(byte[])));
}

//Converts the image from disc to an image
public Bitmap FileToImage()
{
    ImageConverter converter = new ImageConverter();
    return (Bitmap)converter.ConvertFrom(File.ReadAllBytes(@"c:\test.dat"));
} 
```

# kohana - Kohana 安装：日志目录不可写。无法更改 bootstrap.php 中目录的根目录

> ID：10737863
> 
> 赞同：0
> 
> 时间：2012-05-24T12:51:22.340
> 
> 标签：kohana, kohana-3.2

我刚刚在我的新项目 temp.loc 中安装了 kohana 我在浏览器 temp.loc 中输入，环境测试说：

缓存目录 该`/work/temp.loc/wwwroot/application/cache/`目录不可写。

日志目录 该`/work/temp.loc/wwwroot/application/logs/`目录不可写。

我正在尝试更改`Kohana::$log->attach(new Log_File(APPPATH.'logs'));`bootstrap.php 中的路径。但是，刷新浏览器后，环境测试仍然显示相同`/work/temp.loc/wwwroot/application/logs/`的路径，路径没有刷新。为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T14:58:46.497

不要在引导程序中更改位置，这不是必需的。您收到此错误消息的原因可能是因为这两个目录不可写。如果您在 Mac OSX 或 linux 环境中，您需要将这些目录权限设置为 777，即“chmod 777 缓存”。两者都位于您的应用程序目录中。这是我每次在新服务器上安装 Kohana 时都必须解决的常见问题。

# json - 将嵌套的主干关系模型序列化/反序列化为 JSON

> ID：10737864
> 
> 赞同：4
> 
> 时间：2012-05-24T12:51:22.467
> 
> 标签：json, backbone.js, backbone-relational

给定以下 RelationalModel 模型：

```
var Server = Backbone.RelationalModel.extend({
    relations: [{
        type: Backbone.HasMany,
        key: 'databases',
        relatedModel: 'Database',
        collectionType: 'DatabaseCollection',
        includeInJSON: 'id'
    }],

    defaults: {
        databases: []
    },
});

var Database = Backbone.RelationalModel.extend({});
var DatabaseCollection = Backbone.Collection.extend({
    model: Database
}); 
```

还有这些对象：

```
new Database({
    id: 1,
    name: 'DB1'
});

new Database({
    id: 2,
    name: 'DB2'
});

var s1 = new Server({
    id: 3,
    name: 'S1',
    databases: [1,2]
}); 
```

将此模型序列化/反序列化为接近此 JSON 结构的最简单/推荐的方法是什么？：

```
{
    databases: [
        { id: 1, name: 'DB1' }
        { id: 2, name: 'DB2' }
    ],

    servers: [
        { id: 3, name: 'S1', databases: [1, 2] }                 
    ]
} 
```

这样数据就可以在单个请求中发送到服务器/从服务器读取。

谢谢！

蒂姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-31T14:00:09.467

我能够使用您的示例生成您描述的 JSON，并在我刚刚创建的这个小提琴中进行了一些细微的更改[Example](http://jsfiddle.net/scottluskcis/LQbjE/)。

由于调试器中显示了一些警告并获得您描述的结果，我进行了这些更改。希望这可以帮助。

1.  将 Database Model 和 DatabaseCollection 的声明移到 Server 之前的顶部，因为 Servers relatedModel 和 CollectionType 指向这些模型。
2.  对于 relatedModel 和 collectionType 而不是使用字符串，使用对 Database 和 DatabaseCollection 的引用
3.  为服务器创建了一个名为 ServerCollection 的集合
4.  添加了更多示例

这是您最终得到的代码，我刚刚创建了一个普通的旧 Backbone 模型来将两个集合合并为一个。调用 toJSON 为您提供要传输到服务器的单个 JSON 对象。

```
var Database = Backbone.RelationalModel.extend({});
var DatabaseCollection = Backbone.Collection.extend({
    model: Database
});

var Server = Backbone.RelationalModel.extend({
    relations: [{
        type: Backbone.HasMany,
        key: 'databases',
        relatedModel: Database,
        collectionType: DatabaseCollection, 
        includeInJSON: 'id' 
    }],

    defaults: {
        databases: []
    } 
});
var ServerCollection = Backbone.Collection.extend({
    model: Server 
});

var allDatabases = new DatabaseCollection(); 
allDatabases.add([
    new Database({ id: 1, name: 'DB1' }),  
    new Database({ id: 2, name: 'DB2' }),
    new Database({ id: 3, name: 'DB3' }),
    new Database({ id: 4, name: 'DB4' })
]);   

var allServers = new ServerCollection(); 
allServers.add([
    new Server({
        id: 30,
        name: 'S1', 
        databases: [
          allDatabases.get(1),
          allDatabases.get(2)
        ]
    }),
    new Server({
        id: 40,
        name: 'S2',
        databases: [
          allDatabases.get(3),
          allDatabases.get(4)
        ]
    })
]);  

// combine into an object to transfer to server as one 
var serverObject = new Backbone.Model({
    'servers': allServers,
    'databases': allDatabases
});  
console.log(serverObject.toJSON()); 
```

# c - 为什么使用指针访问共享内存？

> ID：10737868
> 
> 赞同：0
> 
> 时间：2012-05-24T12:51:41.657
> 
> 标签：c, parallel-processing

我见过很多并行编程代码，比如查找数组的最大值、矩阵乘法等。使用指针。我不明白为什么要使用它。例子：`(shseg+(offset*sizeof(float))) = sum;`

矩阵乘法的代码：

```
shseg = shmat(handle,NULL,0);
for(row=SIZE/2;row<SIZE;row++){

  for(column=0;column<SIZE;column++){
    sum = 0;

    for(tindex=0;tindex<SIZE;tindex++){ 
      sum+=a[row][tindex]*b[tindex][column];
    }

    *(shseg+(offset*sizeof(float))) = sum;
    offset++;
  }
} 
```

谁能解释为什么使用指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:01:14.180

这是因为您展示的示例使用了共享内存 API，它为您提供了一块平坦的内存，而不是浮点数组。因此，您需要手动进行所有指针操作。

您还可以将共享指针转换为`float*`并使用索引，如下所示：

```
shseg = shmat(handle,NULL,0);
float *fshseg = (float*)shseg;

...

fshseg[index++] = sum; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T13:03:39.380

好吧，您有一个已分配的内存空间与您的程序共享，您将一直通过内存，如果您不使用指针，您将无法获取内存地址值，这就是为什么你需要使用它。

# c++ - 在 C++ 中将数组变量分配给相同数据类型的指针

> ID：10737872
> 
> 赞同：2
> 
> 时间：2012-05-24T12:51:50.493
> 
> 标签：c++, arrays, visual-c++, pointers

在以下 C++ 代码段中，是否可以进行 a=b 分配？？：

```
unsigned int * a;
D3DCOLOR b[16];
a=(unsigned int)b; 
```

这个赋值会将 b 数组的所有元素复制到 a 中吗？类型转换好吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T12:53:29.753

首先，它应该是：

```
a = (unsigned int *)b; // note the * 
```

更重要的是，这只是`a` *指向 的*内容`b`，而**不是**复制它。如果要复制数组，则必须明确地进行，例如使用`for`循环或`std::copy`，也就是说，如果您不想使用类和其他东西。

旁注：要复制到`a`，您需要内存`a`！您可以在堆栈上执行此操作：

```
unsigned int a[16]; // 16 is an example 
```

或动态（例如使用`new`）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-24T13:09:17.310

您的代码将不起作用，使用指针可以访问与指向它的对象相同的内存。你到底想做什么？从您的代码中，我猜您拥有的数组是一个位数组，并且您想要相应的无符号整数。在这种情况下，请执行以下操作：

```
unsigned int a;
unsigned int length = 16;
D3DCOLOR b[length];
for(int i = 0; i < length; i++)
{
  a |=  b[(length-1) - i] << i;
} 
```

这将获取每一位，将其移动所需的数量，然后将其写入 a. 如果您想了解更多信息，请查看 c/c++ 中的位操作。

（注意：此代码假定大端位序）。

# highcharts - y 轴标签和文本的对齐方式

> ID：10737873
> 
> 赞同：1
> 
> 时间：2012-05-24T12:51:51.663
> 
> 标签：highcharts

当有多个 yAxis 并且相反的情况下，我遇到了 Highcharts y 轴与标签和文本对齐的问题。

例如 [http://jsfiddle.net/EuPwn/17/](http://jsfiddle.net/EuPwn/17/)

提前致谢，

赛

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T13:19:14.223

所以你在右边有两个 yAxis，但在相同的 yAxis ID 上。老实说，我不会那样做。为什么不在左右轴上？或者，如果您希望两者都在右侧，仍然使用 2 个不同的 ID。像这样的东西： [http ://www.highcharts.com/demo/combo-multi-axes](http://www.highcharts.com/demo/combo-multi-axes)

# mysql - 如何在 MySQL 中存储平均评分？

> ID：10737877
> 
> 赞同：3
> 
> 时间：2012-05-24T12:52:27.670
> 
> 标签：mysql, floating-point, decimal, rating, rating-system

哪种 MySQL 数据类型最适合存储平均评分值，例如 IMDB 上的电影评分？浮点数，小数？或者，如果我在 PHP 中将实际值四舍五入到小数点后两位并将其保存为 INT (8.323243 -> 8.32 -> 832)，它可能会更快地工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:55:34.557

你不关心精度，所以没有必要使用小数。如果您只想使用整数，请使用 int。否则，使用浮点数或双精度数。

首先在 PHP 中舍入它不会给您带来任何好处。在 PHP 中在 int 和 double 之间转换它比在数据库中存储双精度值要慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:54:50.920

性能最高、速度最快且最小的数据类型确实是`INT`. 对于这种数据类型，排序、搜索等将是最好的，vs .`decimal`和/或`float`.

# ipad - 在 iPad 应用程序中显示 SSRS 报告

> ID：10737879
> 
> 赞同：1
> 
> 时间：2012-05-24T12:52:28.573
> 
> 标签：ipad, reporting-services, report

> **可能重复：**
> [如何在 iPad 应用程序中显示 Microsoft SQL Server Reporting Services 报告？](https://stackoverflow.com/questions/5888885/how-can-i-display-a-microsoft-sql-server-reporting-services-report-in-an-ipad-ap)
> [在 ipad 上渲染 ssrs 报告](https://stackoverflow.com/questions/10737474/render-ssrs-reports-on-ipad)

如何在 iPad 应用程序中显示 Microsoft SQL Server Reporting Services 报表？

# slick2d - java Slick 2D如何设置颜色

> ID：10737882
> 
> 赞同：0
> 
> 时间：2012-05-24T12:52:37.163
> 
> 标签：slick2d

我正在疯狂地尝试绘制一个非常简单的矩形和一个文本，以便了解它如何与光滑的 2d java 库一起使用。

这是我尝试的：

```
g.setColor(Color.green);
g.fillRect(50, 50, 50 ,50);

g.setColor(Color.orange);
g.drawString("Write something", 100, 100); 
```

我只需要把我画的所有东西都用绿色或橙色，但不是一个绿色一个橙色，就像我想做的那样......

有人可以帮我解决这个问题吗？？？

提前谢谢了

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-17T12:23:16.567

您的代码似乎是正确的，并且适用于我的测试游戏。您是否以适当的方法运行它，public void render(GameContainer gc, Graphics g)？

尝试更新您的 LWJGL 和 Slick2D 库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T11:50:33.477

想象一下，您正在手动绘制屏幕。你拿起一支绿笔，画了一个矩形。然后你拿起一支橙色的笔，画出文字。这就是您告诉 Slick2D 对您的代码执行的操作。不要在两次绘图操作之间更改颜色 - 只需设置颜色，然后绘制两个对象，它们将呈现相同的颜色。

当您更改颜色时，您之后执行的所有形状/文本操作都将采用该颜色，直到您再次更改颜色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-22T09:59:50.017

我也在导入`java.awt.Color;`，这个库不兼容`Slick2D`。

要解决此问题，请将行替换`import java.awt.Color;`为`import org.newdawn.slick.Color;`.

# log4j - 当 logrotate 旋转日志文件时，log4j fileappender 不会切换到新文件

> ID：10737886
> 
> 赞同：11
> 
> 时间：2012-05-24T12:52:47.077
> 
> 标签：log4j, rollingfileappender, logrotate, fileappender, log-rotation

**语境：**

我想使用 log4j 将与审计相关的日志写入特定的日志文件，比如 audit.log。我不想使用 syslogappender（基于 udp），因为我不想容忍数据丢失。另外，当文件达到一定大小时，我正在使用 logrotate 来轮换 audit.log。

**问题：**

我遇到的是，当 logrotate 将文件 audit.log 旋转到 audit.log.1 时，log4j 继续写入 audit.log.1 而不是写入 audit.log。

**可能的方法：**

1.  我知道我可以使用 rollingfileappender 进行日志轮换，而不是使用 logrotate，所以当 rollingfileappender 滚动文件时，它会毫不费力地切换到新文件。但是我不能使用 rollingfileappender 的原因是我想使用 logrotate 的 post rotate 功能在旋转发生后触发一些rollingfileappender 无法提供的脚本。

2.  我能想到的另一种绝望的方法是自己编写一个 log4j 自定义的 appender 来关闭日志文件（audit.log.1）并在检测到文件被轮换时打开新的（audit.log）。

3.  我从未使用过 ExternallyRolledFileAppender，但如果可以使用 logrotate post rotate 将信号发送到 ExternallyRolledFileAppender 并使 log4j 知道文件已旋转，并开始写入新文件？

**问题：**

只是想知道是否已经发明/编写了一些像这样的附加程序？还是我有其他选择来解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T12:58:09.163

查看`logrotate`的`copytruncate`选项，它可能对您的情况有所帮助：

```
copytruncate
       Truncate the original log file to zero size  in  place
       after  creating  a copy, instead of moving the old log 
       file and optionally creating a new  one.   It  can  be  
       used  when  some  program  cannot be told to close its 
       logfile and thus might continue writing (appending) to
       the  previous  log file forever.  Note that there is a
       very small time slice between  copying  the  file  and 
       truncating  it,  so  some  logging data might be lost.
       When this option is used, the create option will  have
       no effect, as the old log file stays in place 
```

# javascript - 不能使用嵌套锚

> ID：10737888
> 
> 赞同：-1
> 
> 时间：2012-05-24T12:52:57.523
> 
> 标签：javascript, jquery, html, css

行。我有以下脚本：

```
$('#exhibitions .item.plain').toggle(
    function() {
        $(this).css({
           'height': '302px',
           'z-index': '10',
           'background': '#3F94AB'
        });
        $(this).find('p.title').css('color', '#E6E6E6');
        $container.isotope('reLayout');
    },
    function() {
        $(this).css({
           'height': "130px", 
           'z-index': '0',
           'background': '#CCC'
    });
    $(this).find('p.title').css('color', '#353334');
    $container.isotope('reLayout');
}); 
```

而`.item.plain`被赋予嵌套的 div `anchor`。当我点击它时，很明显 ))`toggle()`被解雇了。

```
<div class="item plain">
     <!-- some stuff -->
     <a href="url I want to go"></a>
</div> 
```

我该如何解决？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T12:54:08.160

如果我很好理解您不想`.item.plain`在单击链接时切换元素，那么请以这种方式停止事件的传播

```
$('#exhibitions .item.plain a').on('click', function(evt) {
   evt.stopPropagation();
}); 
```

# iphone - 如何在iphone中启动过去停止的同一个计时器

> ID：10737889
> 
> 赞同：0
> 
> 时间：2012-05-24T12:53:06.610
> 
> 标签：iphone

我是 iphone 新手。我正在开发音频播放器，因为在音频播放器中单击播放按钮时会涉及计时器我写了这段代码

```
- (IBAction)playButtonClicked:(id)sender {
    bookTitleString=[[selectBook titleLabel]text];
    startChapterString =[[startChapter titleLabel]text];
    NSString *string = [[NSBundle mainBundle]pathForResource:startChapterString ofType:@"mp3" inDirectory:bookTitleString];
    NSLog(@"string is %@",string);
    NSURL *url = [NSURL fileURLWithPath:string isDirectory:YES];
    NSError *error;
    audioPlayer = [[AVAudioPlayer alloc]initWithContentsOfURL:url error:&error];
    AVURLAsset *audioAsset = [AVURLAsset assetWithURL:url];
    CMTime audioDuration = audioAsset.duration;
    audioDurationInSeconds = CMTimeGetSeconds(audioDuration);
    NSLog(@"audioDurationInSeconds is %f",audioDurationInSeconds);

    slider.userInteractionEnabled= YES;
    slider.minimumValue = 0.0;
    slider.maximumValue = audioDurationInSeconds;
    slider.value = 0.0;
    slider.continuous = YES;
    audioPlayer.delegate = self;
    if(audioPlayer == nil){
        NSLog(@"audio player is nil");
    }
    else
    {
        NSLog(@"audio player is not nil");
        NSLog(@"audioplayer.deviceCurrentTime is %f",audioPlayer.deviceCurrentTime);
        [audioPlayer play];
        timer = [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(sliderTintChanged:) userInfo:nil repeats:YES];
    }
} 
```

在上面我将一个计时器作为一个类变量

完成歌曲播放后转到 AVAudioPlayerDelegate 即 audioPlayerDidFinishPlaying:(AVAudioPlayer *)player 成功:(BOOL)flag

这里是这个 audioPlayerDidFinishPlaying 的代码

```
-(void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag{
    [timer invalidate];
    NSLog(@"song finished playing");
    NSString *startSongNumber = [[startChapter titleLabel]text];
    NSLog(@"startSongNumber is %@",startSongNumber);
    int songNumber = [startSongNumber intValue];
    NSLog(@"songNumber is %d",songNumber);
    songNumber = songNumber+1;
    NSLog(@"songNumber is %d",songNumber);
    NSString *nextSongNumber = [NSString stringWithFormat:@"%d",songNumber];
    NSLog(@"next song number is %@",nextSongNumber);
   NSString *string = [[NSBundle mainBundle]pathForResource:nextSongNumber ofType:@"mp3" inDirectory:bookTitleString];
    NSLog(@"string is in playerdidfinish is %@",string);
    NSURL *url = [NSURL fileURLWithPath:string isDirectory:YES];
    NSError *error;
    audioPlayer = [[AVAudioPlayer alloc]initWithContentsOfURL:url error:&error];
    AVURLAsset *audioAsset = [AVURLAsset assetWithURL:url];
    CMTime audioDuration = audioAsset.duration;
    audioDurationInSeconds = CMTimeGetSeconds(audioDuration);
    NSLog(@"audioDurationInSeconds is %f",audioDurationInSeconds);
    [audioPlayer play];

} 
```

在上面开始时，我使计时器无效，然后获取下一首歌曲路径并开始播放，但我不知道如何启动在上述方法中停止的计时器

如果有人知道这一点，请帮助我..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T13:56:35.293

timer 一般用于时间增量，以秒为单位。在你的方法中

```
timer = [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(sliderTintChanged) userInfo:nil repeats:YES]; 
```

每隔一秒后的计时器调用方法。

```
-(void)sliderTintChanged
{
   //you can use a variable which will keep timer value
   //like this
   count++;
} 
```

count 是一个整数变量 assign int count=0; 计时器何时停止计数以秒为单位的时间，您可以使用它。

和 NSTimer “开火日期” 保留调用该方法的时间的开火细节。有关更多详细信息，请阅读火灾日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:57:30.970

就像你在 playButtonClicked 方法中所做的一样......

```
timer = [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(sliderTintChanged:) userInfo:nil repeats:YES]; 
```

# asp.net - 通过 WWW::Mechanize (PERL) 调用 ASP 操作

> ID：10737891
> 
> 赞同：1
> 
> 时间：2012-05-24T12:53:11.470
> 
> 标签：asp.net, perl, www-mechanize

我需要解析由 ASP 操作 (LoadDialog) 生成的列表，但我不知道如何完成它。如果我执行以下操作，我只会得到一个空的 HTML 文件。

```
#!/usr/bin/perl -w
#
#
use strict;
use WWW::Mechanize;
use HTTP::Cookies;

my $url = "http://MYURL/LOGIN";
my $appurl = "http://MYURL/SOME.asp"; 

#SOME.asp calls http://MYURL/SOME.asp?Action=LoadDialog" to get results

my $username = 'username';
my $password = 'password';

#login to site 
my $mech = WWW::Mechanize->new();
$mech->cookie_jar(HTTP::Cookies->new());
$mech->get($url);
$mech->form_name('login');
$mech->field(UserName => $username);
$mech->field(Password => $password);
$mech->click();

# get results from LoadDialog (?!)
$mech->get($appurl);
my $app_content = $mech->content();
print "$app_content\n"; 
```

Firebug 告诉我`?Action=LoadDialog`上面提到的 URL 正在调用它，但 Mechanize 没有意识到它（猜测）。

简单地`$myappurl`更改`http://MYURL/SOME.asp?Action=LoadDialog`为也给了我一个空的 HTML 文件。

有没有机会获得 ASP 生成的内容？我不能使用任何其他“运行浏览器”的 Perl 模块，我需要找到一个可在 shell 中使用的解决方案。

提前致谢，马利

# c# - XML 文档中的错误 (2,2)

> ID：10737892
> 
> 赞同：7
> 
> 时间：2012-05-24T12:53:18.740
> 
> 标签：c#, xml-serialization

我有一些 xml 文件，我试图在给定的代码中反序列化如下。

```
using (StreamReader srFileContent = new StreamReader(filePath))  
{
    XmlSerializer serializer = new XmlSerializer(typeof(messageType));   
    messageType objMessage = (messageType)serializer.Deserialize(srFileContent);  
} 
```

此处位于 filePath 的文件不包含以下行

```
<?xml version="1.0"?>
<message xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"> 
```

这就是我收到错误的原因。你能帮我在反序列化给定文件的流之前如何在运行时添加这些行吗？

错误如下：

> System.InvalidOperationException：XML 文档中存在错误 (2, 2)。---> System.InvalidOperationException：不是预期的。在 Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationReadermessageType.‌​Read161_message() --- 内部异常堆栈跟踪结束 --- 在 System.Xml.Serialization.XmlSerializer.Deserialize(XmlReader xmlReader, String encodingStyle, XmlDeserializationEvents events) 在 System .Xml.Serialization.XmlSerializer.Deserialize(TextReader textReader) 在 CCR2BB.frmMain.BWConvertProcess_DoWork()

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-24T13:17:46.120

您将不得不查看基本异常以找出问题所在。捕获的异常可能包含 4 个或更多内部异常。

例如：

```
try
{
  ...
}
catch (Exception ex)
{
  Console.WriteLine(ex.GetBaseException());
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T13:11:34.180

另一个问题的解决方案是：

```
XmlRootAttribute xRoot = new XmlRootAttribute();
xRoot.ElementName = "message";
// xRoot.Namespace = "http://www.cpandl.com";
xRoot.IsNullable = true;

XmlSerializer xs = new XmlSerializer(typeof(messageType),xRoot); 
```

也许这是解决您问题的一种方法。因为我的网络无法使用 MSDN，所以我无法为 XmlRootAttribute 提供更多文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:07:27.320

您从哪里获得“messageType”类？

如果您使用 xsd.exe 为您的 xml 创建了 xsd，然后使用 xsd 您创建了此类。

然后您的项目将有两个包含此类的文件。

*   其中一个文件`designer.cs`包含从类派生的`DataSet`此类
*   一个文件只是一个`.cs`文件，它有一个部分类。
*   当您在反序列化时使用此类时，它将引用来自 Designer.cs 的类，该类派生自`DataSet`.
*   但是，如果您从项目中删除 Designer.cs，您的代码将引用 .cs 文件中的部分类。

通过删除这个类派生自的 Designer.cs 文件，`DataSet`我能够解决这个错误。

# java - 如何使用 CDI 在 ajax 调用期间保持状态

> ID：10737901
> 
> 赞同：0
> 
> 时间：2012-05-24T12:53:54.290
> 
> 标签：java, cdi, jboss-weld

我正在使用 CDI (Weld)，我遇到了一个问题，希望您能提供帮助。我有一系列 Primefaces `selectOneMenu`，其中一个中选择的值用于填充下一个。问题是，我需要在我的 ManagedBean 上使用 SessionScoped 来获取已选择项目的值。我知道 JSF 的 ViewScoped 在这种情况下会很有帮助，但由于我使用的是 CDI，所以这不是一个选项。接缝也不是一种选择。有一种解决方法可以使用，例如，RequestScoped，或者我真的需要在我的 bean 上使用 SessionScoped？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:57:43.513

没有什么可以阻止您同时使用 JSF 托管 bean 和 CDI bean。例如，您可以将一个`@javax.faces.bean.ViewScoped @javax.faces.bean.ManagedBean`和`@javax.inject.Inject`CDI bean 放入其中。因此，如果视图范围适合解决问题，请继续使用它。我已经使用库存的 GlassFish 3.1.2 服务器 (JSF 2.1) 对此进行了测试。

另一种选择是使用 CDI `@javax.enterprise.context.ConversationScoped`（[http://docs.jboss.org/weld/reference/1.1.0.Final/en-US/html/scopescontexts.html#d0e1841](http://docs.jboss.org/weld/reference/1.1.0.Final/en-US/html/scopescontexts.html#d0e1841)）。这在涉及一系列请求/视图的场景中效果最佳，这些请求/视图具有明确定义的起点和终点，您可以在其中开始和结束对话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T03:09:18.240

查看 MyFaces CODI 的 ViewScope 或创建您自己的 ViewScope 的 CDI impl :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-28T22:15:57.423

仅使用 CDI 扩展来创建您自己的范围，因为您的 bean 在 facescontext viewroot 映射中的 ajax 回调期间保持活动状态，因此请查看此链接：[http ://www.verborgh.be/articles/2010/01/06/porting -the-viewscoped-jsf-annotation-to-cdi/](http://www.verborgh.be/articles/2010/01/06/porting-the-viewscoped-jsf-annotation-to-cdi/)

# php - Yii 框架中的 sql server 数据库出错

> ID：10737905
> 
> 赞同：0
> 
> 时间：2012-05-24T12:54:11.153
> 
> 标签：php, yii

我正在从 mysql 数据库切换到 sql server。新数据库与以前的数据库相同。但是在创建用户操作中，我遇到了这种类型的错误。

> ```
> include( .php) [<a href='function.include'>function.include</a>]: failed to open stream: No such file or directory 
> ```

谁能建议我能做些什么来解决这个问题？

问题出现在这条线上

```
$profile->attributes = $_POST['YumProfile']; 
```

我从代码中检查了所有对象都在工作并且我正在`$_POST['YumProfile']`正确地获得价值。

实际上，此逻辑与其他表一起正常工作`user`并且正在插入值，但是当我尝试将带有表单的数据插入`profile`表中时，它会显示这种类型的错误。从输入看一切都很好，但我不明白为什么

```
 $profile->attributes = $_POST['YumProfile']; 
```

这条线甚至会给出错误，`profile->validate()`并且在正常工作并填充正确的值`profile->save()`时也会给出此错误。`$profile->attributes``$_POST['YumProfile']`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T15:04:40.320

似乎您的模型的验证规则有问题。检查那里的一切是否到位，可能你错过了什么。这是[一个api文档](http://www.yiiframework.com/doc/api/1.1/CModel#rules-detail)

# ios - 删除警告和内存泄漏

> ID：10737908
> 
> 赞同：0
> 
> 时间：2012-05-24T12:54:24.240
> 
> 标签：ios, xcode, memory-leaks, warnings

我的项目（XCode 4.1、4.3.1）中有一些警告，主要是在开源库中 ![在此处输入图像描述](../Images/f6d03ee801bc1500eaaff7f9ca6b4f5a.png)

可达性
`+ (Reachability*) reachabilityWithAddress: (const struct sockaddr_in*) hostAddress;`

.h：ASIAuthenticationDialog.m：

```
- (UIViewController *)presentingController
{
    if (!presentingController) {
        presentingController = [[ASIAutorotatingViewController alloc] initWithNibName:nil bundle:nil];

        // Attach to the window, but  don't interfere.
        UIWindow *window = [[[UIApplication sharedApplication] windows] objectAtIndex:0];
        [window addSubview:presentingController.view];
        [[presentingController view] setFrame:CGRectZero];
        [[presentingController view] setUserInteractionEnabled:NO];
    }

    return presentingController;
} 
```

ASI下载缓存：

```
- (void)setDefaultCachePolicy:(ASICachePolicy)cachePolicy
{
    [[self accessLock] lock];
    if (cachePolicy == ASIDefaultCachePolicy) {
        defaultCachePolicy = ASIReloadIfDifferentCachePolicy;
    }  else {
        defaultCachePolicy = cachePolicy;   
    }
    [[self accessLock] unlock];
} 
```

`NSDate *expiryDate = [fetchDate addTimeInterval:maxAge];`- addTimeInterval 已弃用

ASIHTTPRequest.m：

```
- (void)setDelegate:(id)newDelegate
{
    [[self cancelledLock] lock];
    delegate = newDelegate;
    [[self cancelledLock] unlock];
} 
```

ASINetworkQueue.m：

```
- (void)setUploadProgressDelegate:(id)newDelegate
{
    uploadProgressDelegate = newDelegate;
    [self resetProgressDelegate:newDelegate];

} 
```

并且有内存泄漏，主要是在 libxml 中： ![在此处输入图像描述](../Images/ca781ff17c9d19d0edf62536cd7bf807.png)

我使用 'useyourloaf' RSS Feed 解析示例：
Feed.h：

```
#import <Foundation/Foundation.h>
#import "TFHpple.h"

@class ASIHTTPRequest, Channel;

@interface Feed : NSObject <NSXMLParserDelegate> {

    NSURL *feedURL;
    ASIHTTPRequest *feedRequest;

    Channel *feedChannel;
    NSMutableArray *feedPosts;

    id currentElement;
    NSMutableString *currentElementData;

    TFHpple *htmlParser;
    NSArray * elements;

}

@property (nonatomic, copy) NSURL *feedURL;
@property (nonatomic, retain) ASIHTTPRequest *feedRequest;
@property (nonatomic, retain) Channel *feedChannel;
@property (nonatomic, retain) NSMutableArray *feedPosts;
@property (nonatomic, assign) id currentElement;
@property (nonatomic, retain) NSMutableString *currentElementData;

- (id)initWithURL:(NSURL *)feedURL;
- (void)refresh;

extern NSString *kFeederReloadCompletedNotification;
extern NSString *kFeederReloadFailedNotification;

@end 
```

饲料.m：

```
#import "Feed.h"
#import "Channel.h"
#import "Post.h"
#import "ASIHTTPRequest.h"
#import "NSString+HTML.h"

@implementation Feed

@synthesize feedURL;
@synthesize feedRequest;
@synthesize feedChannel;
@synthesize feedPosts;
@synthesize currentElement;
@synthesize currentElementData;

NSString *kFeederReloadCompletedNotification = @"kFeederReloadCompletedNotification";
NSString *kFeederReloadFailedNotification = @"kFeederReloadFailedNotification";

#pragma mark -
#pragma mark === Initialization and release ===
#pragma mark -

-(id)initWithURL:(NSURL *)sourceURL 
{

    if (self = [super init]) 
    {

        self.feedURL = sourceURL;
        self.feedPosts = [[NSMutableArray alloc] init];
    }

    return self;
}

- (void)dealloc 
{

    [currentElementData release];
    [feedPosts release];
    [feedChannel release];
    [feedRequest release];
    [feedURL release];

    [super dealloc];
}

#pragma mark -
#pragma mark === ASIHTTPRequest delegates ===
#pragma mark -

- (void)requestFinished:(ASIHTTPRequest *)request 
{

    NSData *responseData = [request responseData];

    //htmlParser = [[TFHpple alloc] init];

    NSXMLParser *parser = [[NSXMLParser alloc] initWithData:responseData];
    [parser setDelegate:self];

    [parser parse];

    if ([parser parse]) 
    {

        [[NSNotificationCenter defaultCenter] 
         postNotificationName:kFeederReloadCompletedNotification
         object:nil];

    }

    [parser release];
}

- (void)requestFailed:(ASIHTTPRequest *)request 
{
    NSError *error = [request error];
    UIAlertView *requestAlert = [[UIAlertView alloc] initWithTitle:[error localizedDescription] message:nil delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
    [requestAlert show];
    [requestAlert release];
    requestAlert = nil;

    [self performSelector:@selector(refresh) withObject:nil afterDelay:30.0];

    [[NSNotificationCenter defaultCenter] 
                        postNotificationName:kFeederReloadFailedNotification
                        object:nil];
}

#pragma mark -
#pragma mark === NSXMLParserDelegate methods ===
#pragma mark -

static NSString * const kChannelElementName = @"channel";
static NSString * const kItemElementName = @"item";

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName
               namespaceURI:(NSString *)namespaceURI
               qualifiedName:(NSString *)qName
               attributes:(NSDictionary *)attributeDict 
{

    if ([elementName isEqualToString:kChannelElementName]) 
    {

        Channel *channel = [[Channel alloc] init];
        self.feedChannel = channel;
        self.currentElement = channel;
        [channel release];
        return;     
    }

    if ([elementName isEqualToString:kItemElementName]) 
    {
        Post *post = [[Post alloc] init];
        [feedPosts addObject:post];
        self.currentElement = post;
        [post release];
        return;     
    }

}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string {

    if (currentElementData == nil) 
    {
        self.currentElementData = [[NSMutableString alloc] init];
    }

    [currentElementData appendString:string];
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName
               namespaceURI:(NSString *)namespaceURI
               qualifiedName:(NSString *)qName 
{

    SEL selectorName = NSSelectorFromString(elementName);
    if ([currentElement respondsToSelector:selectorName]) 
    {       
        if(([currentElement isKindOfClass:[Post class]]) && ([elementName isEqualToString:@"description"]))
        {
            if(htmlParser)
            {
                [htmlParser release];
                htmlParser = nil;
            }
            htmlParser = [[TFHpple alloc] initWithHTMLData:[[[currentElementData stringByDecodingHTMLEntities] stringByRemovingNewLinesAndWhitespace] dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:YES]];
            NSArray *img_array = [htmlParser searchWithXPathQuery:@"//img"];
            if(img_array.count)
            {
                NSURL *img_url = [NSURL URLWithString:[[img_array objectAtIndex:0] objectForKey:@"src"]];
                [currentElement setValue:img_url forKey:@"imageURL"];
            }
            else
            {
                [currentElement setValue:nil forKey:@"imageURL"];
            }
            NSArray *youtube_string_array = [htmlParser searchWithXPathQuery:@"//embed"];
            if(youtube_string_array.count)
            {
                NSString *youtube_string = [[youtube_string_array objectAtIndex:0] objectForKey:@"src"];
                [currentElement setValue:youtube_string forKey:@"youtubeString"];
            }
            else
            {
                [currentElement setValue:nil forKey:@"youtubeString"];
            }
        }

        if(([currentElement isKindOfClass:[Post class]]) && ([elementName isEqualToString:@"pubDate"]))
        {
            NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
            dateFormatter.locale = [[[NSLocale alloc] initWithLocaleIdentifier:@"en_US"]autorelease];
            [dateFormatter setDateStyle:NSDateFormatterMediumStyle];
            [dateFormatter setDateFormat:@"eee, dd MMM yyyy HH:mm:ss ZZZ"];

            NSString *date_string = [[currentElementData stringByConvertingHTMLToPlainText]stringByRemovingNewLinesAndWhitespace];

            NSDate *dateFromString = [dateFormatter dateFromString:date_string];

            //[dateFormatter setDateFormat:@"eee, dd MMM yyyy HH:mm"];
            [dateFormatter setDateStyle:NSDateFormatterLongStyle];
            [dateFormatter setTimeStyle:NSDateFormatterNoStyle];
            dateFormatter.locale = [[[NSLocale alloc] initWithLocaleIdentifier:@"ru_RU"]autorelease];

            date_string = [dateFormatter stringFromDate:dateFromString];
            [currentElement setValue:date_string forKey:elementName];
            [dateFormatter release];
            dateFormatter = nil;
        }
        else if(([currentElement isKindOfClass:[Post class]]) && ([elementName isEqualToString:@"link"]))
        {
            [currentElement setValue:[[currentElementData stringByConvertingHTMLToPlainText] stringByRemovingNewLinesAndWhitespace] forKey:elementName];
        }
        else
        {
            [currentElement setValue:[[currentElementData stringByConvertingHTMLToPlainText] stringByRemovingNewLinesAndWhitespace] forKey:elementName];    
        }
    }

    [currentElementData release];
    self.currentElementData = nil;
}

- (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError {

//  NSString *info = [NSString stringWithFormat:@"Error %i, Description: %@, Line: %i, Column: %i",
//                    [parseError code],
//                    [[parser parserError] description],
//                    [parser lineNumber],
//                    [parser columnNumber]];

    //NSlog(@"RSS Feed Parse Error: %@", info);
}

#pragma mark -
#pragma mark === instance methods ===
#pragma mark -

- (void)refresh {

    self.feedRequest = [ASIHTTPRequest requestWithURL:feedURL];

    [feedPosts removeAllObjects];
    [feedRequest setDelegate:self];
    [feedRequest startAsynchronous];

}

@end 
```

谁能帮我消除这些警告和内存泄漏？任何帮助将不胜感激！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T13:32:03.213

对于可达性问题：

在 Reachability.h 文件的顶部添加以下行

```
struct sockaddr_in; 
```

摆脱第一组警告......

我的文件的前几行读取

```
#import <Foundation/Foundation.h>
#import <SystemConfiguration/SystemConfiguration.h>

struct sockaddr_in;

typedef enum {
    NotReachable = 0,
    ReachableViaWiFi,
    ReachableViaWWAN
} NetworkStatus; 
```

# c# - 隐藏标准标题栏时如何移动窗口

> ID：10737911
> 
> 赞同：1
> 
> 时间：2012-05-24T12:54:29.633
> 
> 标签：c#, .net, winforms, contextmenu, draggable

在我的 .net winform 应用程序的标题栏中，我放置了一个 Panel 控件，其中包含许多其他控件。因此，当我单击面板时，我没有获得上下文菜单或拖动功能。但是，当我在标题栏中的面板外部单击时，也会出现同样的情况。

PS - 显然对于用户来说，应用程序顶部的整个栏被称为“标题栏”，他们希望标题栏上到处都有拖动和上下文菜单（对他们来说，这也包括面板。）

那么有什么方法可以实现这一点。我希望右键单击面板或面板中的任何控件时出现上下文菜单。当我尝试单击并拖动面板或面板中的任何控件时，我还想拖动整个应用程序窗口。

感谢任何形式的帮助。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T13:03:39.020

您必须`WndProc`像“正常”标题栏那样将消息传送到 。

声明：

```
private const int WM_SYSCOMMAND = 0x112;
private const int SC_MOUSEMOVE = 0xf012;
private const int SC_MOUSEMENU = 0xf090;

[DllImport("user32.dll", CharSet = CharSet.Auto)]
private static extern IntPtr SendMessage(IntPtr hWnd, int msg,
    IntPtr wParam, IntPtr lParam); 
```

然后在您的`Panel` `MouseDown`处理程序上为左键单击执行此操作：

```
SendMessage(Handle, WM_SYSCOMMAND, new IntPtr(SC_MOUSEMOVE), IntPtr.Zero); 
```

这是右键单击：

```
SendMessage(Handle, WM_SYSCOMMAND, new IntPtr(SC_MOUSEMENU), IntPtr.Zero); 
```

# performance - 将屏蔽数组添加到另一个 fortran 的最有效方法

> ID：10737914
> 
> 赞同：6
> 
> 时间：2012-05-24T12:54:32.363
> 
> 标签：performance, fortran

我有一个“掩码数组”，我想将它添加到另一个数组中——换句话说，我有 3 个数组`A`，`B`和`mask`。我的问题是存储掩码（作为逻辑数组，作为一个和零的真实数组）的最有效（就执行时间而言）方法是什么？

**编辑**

这是一个你可以玩的玩具程序（如果你有 mpif77）：

```
 program main
  implicit None
  include 'mpif.h'
  integer, parameter :: ntry=10000
  integer, parameter :: asize=1000000
  real,dimension(asize) :: A,B,maskr
  logical,dimension(asize) :: mask
  real*8 :: dd,dt,dtave,dtbest
  integer i

  do i=1,asize
     maskr(i)=mod(i,2)
     mask(i)=.False.
     if(mod(i,2).eq.0) mask(i)=.True.
  enddo

  A=1.0; B=1.0
  dtbest=1d33
  dtave=0.0
  do i=1,ntry
     dt=mpi_wtime()
     call add_arrays_logical(asize,A,B,mask)
     dt=mpi_wtime()-dt
     dtbest=min(dt,dtbest)
     dtave=dtave+dt
  enddo
  print*,"==== logical ==="
  print*,"Average",dtave/ntry
  print*,"Best",dtbest

  A=1.0; B=1.0
  dtbest=1d33
  dtave=0.0
  do i=1,ntry
     dt=mpi_wtime()
     call add_arrays_real(asize,A,B,maskr)
     dt=mpi_wtime()-dt
     dtbest=min(dt,dtbest)
     dtave=dtave+dt
  enddo
  print*,"==== Real ==="
  print*,"Average",dtave/ntry
  print*,"Best",dtbest

  A=1.0; B=1.0
  dtbest=1d33
  dtave=0.0
  do i=1,ntry
     dt=mpi_wtime()
     where(mask) A=A+B
     dt=mpi_wtime()-dt
     dtbest=min(dt,dtbest)
     dtave=dtave+dt
  enddo
  print*,"==== Where ===="
  print*,"Average",dtave/ntry
  print*,"Best",dtbest

  end

  subroutine add_arrays_logical(n,A,B,mask)
  integer n
  real A(n),B(n)
  logical mask(n)
  do i=1,n
     if(mask(i))then
        A(i)=A(i)+B(i)
     endif
  enddo
  end

  subroutine add_arrays_real(n,A,B,mask)
  integer n
  real A(n),B(n),mask(n)
  do i=1,n
     A(i)=A(i)+mask(i)*B(i)
  enddo

  end 
```

**我的结果：**

(gfortran -O2)

```
==== logical ===
Average  1.52590200901031483E-003
Best  1.48987770080566406E-003
==== Real ===
Average  1.78022863864898680E-003
Best  1.74498558044433594E-003
==== Where ====
Average  1.48216445446014400E-003
Best  1.44505500793457031E-003 
```

（gfortran -O3 -funroll-loops -ffast-math）

```
==== logical ===
Average  1.47997992038726811E-003
Best  1.44982337951660156E-003
==== Real ===
Average  1.40655457973480223E-003
Best  1.37186050415039063E-003
==== Where ====
Average  1.48403010368347165E-003
Best  1.45006179809570313E-003 
```

(pfg90 -fast) -- 在一台非常旧的机器上

```
==== logical ===
Average   5.4871437072753909E-003
Best   5.4519176483154297E-003
==== Real ===
Average   4.6096980571746831E-003
Best   4.5847892761230469E-003
==== Where ====
Average   5.3572671413421634E-003
Best   5.3288936614990234E-003 
```

(pfg90 -O2) -- 在一台非常旧的机器上

```
 ==== logical ===
 Average   5.4929971456527714E-003
 Best   5.4569244384765625E-003
 ==== Real ===
 Average   5.5974062204360965E-003
 Best   5.5701732635498047E-003
 ==== Where ====
 Average   5.3811835527420044E-003
 Best   5.3341388702392578E-003 
```

当然，有一些因素可能会影响这一点——例如编译器向量化循环的能力——那么关于如何实现这样的事情是否有经验法则？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T13:06:17.047

为什么不使用“哪里”？

```
where (mask) A = A + B 
```

可能使用面罩是最快的，但唯一确定的方法是测量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T13:06:44.527

如果触发器是指浮点运算，那么第一个选项显然更好，因为在这种情况下，每次循环迭代都有 1 个触发器，其中 mask(n) == .true。. 而对于第二个选项，无论掩码（n）的值如何，每次循环迭代都有 2 个触发器。

OTOH，如果您有兴趣最大限度地减少执行此功能所花费的时间，为什么不在您的数据上尝试两个版本并测试哪个更快？

您可能还想测试使用 Fortran 90+ WHERE 构造的版本

```
where(mask) A = A + B 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-11T22:51:16.487

没有绝对的方法可以提前确定这一点，因为它完全取决于编译器、平台和问题。仅作为一个例子，通过 Polyhedron 网站上的各种 Fortran 编译器查看基准。

...尽管要注意英特尔的基准测试，因为其中有时会出现“有趣”的事情（例如，几年前，英特尔因故意/秘密地在英特尔 cpu 以外的任何东西上阻碍他们的编译器等而被司法部罚款 1000 万美元） ）。

说了这么多，有几点感想：

1) 一些策略的“设置成本”较大，而另一些策略的“执行成本”较高。也就是说，编译器/代码需要一些时间来将正确的位发送到 cpu/微指令，这需要不同的时间量和不同的策略。因此，一种策略在添加短数组时可能会做得更好，而另一种策略可能会在添加长数组时做得更好。

对于您的 Mask 是“密集”与“稀疏”的情况（另见下文），可能存在类似的问题。

2）您的基准参数太小了。基准测试的一个经验法则是，它应该需要至少几到十秒的 exe。使用您的基准测试，执行时间是如此之短，以至于时钟等方面的任何微小差异都会产生较大的相对影响。要清楚地看到这一点，请针对需要几分之一秒、1-2 秒和 7-10 秒的情况运行标准 Linpack 基准测试。通常，1 秒以下的结果对于该示例没有意义。

3) 与 F90/95 结构（ForAll、Where 等）相比，F77 在某些条件下可能（或者至少最近没有测试过）在某些结构上运行得更快。

如果您的编译器允许使用数组部分作为索引，那么有时（例如，当 Mask 为“稀疏”时）最好先创建一个整数数组来保存数组索引为 True，然后只添加 True 数组部分。例如，如果 Integer iIndex(:) 持有 .True。Mask 的索引值，然后像 A(iIndex("bounds")) + B(iIndex("bounds")) 这样的东西可以非常有效，因为与一般算术运算相比，使用逻辑创建索引的成本更小。因此，尽管有额外的“设置”成本，但如果这是一个“稀疏”问题，那么可能只需要少量的添加等。乘法和高级算术甚至更加“昂贵”，因此在稀疏变化时更加明显。这是一种“自制”

Incidentally, there can be differences in exe even with (apparently) the same compiler. For example, Simply Fortran does quite a good job at producing fast code, it uses GCC/gFortran, compared to say Photran/Eclipse (on Windows), which also uses GCC/gFortran (at least on one of my machines). This could be due to different ways of "interleaving" MingW or CygWin etc, and it could also be due to, for example, Simply Fortran's extensive optimisation for specific chips and instructions sets, etc. Some of those issues don't arise on Linux etc, and so is an example also of "platform" matters.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T06:20:49.813

怎么样`A = A + maskr*B`？这完全消除了任何条件行为，代价是扫描所有三个数组，而不考虑掩码的稀疏性。

# c# - 代码优先 - 分配 ID 时未加载外键引用

> ID：10737916
> 
> 赞同：2
> 
> 时间：2012-05-24T12:54:40.907
> 
> 标签：c#, entity-framework, ef-code-first, auto-update

我定义了以下 C# Entity Framework 代码第一个实体：

```
class Program
{
    static void Main(string[] args)

    {
        var context = new MyContext();

        var person = new Person
        {
            FirstName = "Nadege",
                    LastName = "Deroussen",
                    BirthDate = DateTime.Now,
                    AccessCode = new AccessCode { Code = "ABC" }
        };
        context.Persons.Add(person);

        var accessCode = new AccessCode { Code = "MGH" };
        context.AccessCodes.Add(accessCode);
        context.SaveChanges();

        var person = context.Persons.Where(e => e.Id == 1).Single();            
        person.AccessCodeId = 2;

        context.SaveChanges();

        Console.Write("Person saved !");
        Console.ReadLine();
    }
}

public class Person
{
    public int Id { get; set; }
    public string LastName { get; set; }
    public string FirstName { get; set; }
    public DateTime BirthDate { get; set; }

    public int AccessCodeId { get; set; }
    [ForeignKey("AccessCodeId")]
    public virtual AccessCode AccessCode { get; set; }
}

public class AccessCode
{
    public int Id { get; set; }
    public string Code { get; set; }
}

public class MyContext : DbContext
{
    public DbSet<Person> Persons { get; set; }
    public DbSet<AccessCode> AccessCodes { get; set; }
} 
```

在`Main`方法中，分配后`AccessCodeId = 2`，如果我检查`AccessCode`人员中的引用，它仍然指向`AccessCode`with `Id == 1`。我怎样才能得到这个自动更新？

我正在学习EF，所以如果这没有意义，请原谅。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T15:39:04.383

更改外键属性值后，您必须调用 ChangeTracker 的 DetectChanges() 方法

```
person.AccessCodeId = 2;
context.ChangeTracker.DetectChanges(); 
```

注意：我已经在@lucask 代码和您的代码上测试了这种行为。您的代码只需要更正`person`变量的第二个声明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T09:27:36.550

最后，我使用以下代码得到了预期的行为：

```
 namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {
            Database.SetInitializer<TestContext>(new DropCreateDatabaseAlways<TestContext>());
            var context = new TestContext();
            var child = new Child { };
            var parent = new Parent { Child = child };
            context.Parents.Add(parent);
            context.Children.Add(new Child { });

            context.SaveChanges();

            context.Parents.First().ChildId = 2;
            context.SaveChanges();
        }
    }

    public class Parent
    {
        public int Id { get; set; }
        public virtual int ChildId { get; set; }
        public virtual Child Child { get; set; }
    }
    public class Child
    {
        public int Id { get; set; }
    }
    public class TestContext : DbContext
    {
        public DbSet<Parent> Parents { get; set; }
        public DbSet<Child> Children { get; set; }
    }
} 
```

图像显示了调试会话，在分配 ChildId 之后（调用 SaveChanges() 之前），Child 属性也得到正确更新。感谢所有提出宝贵建议的人。

![在此处输入图像描述](../Images/c0efbbd39882cf704238e6d659b63419.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T13:43:53.620

好吧，我不同意@David。Code First、Database First 或 Model First 只是实现相同目标的不同方法。并且带有数据注释或 Fluent API 的 Code First 非常强大。你只需要学习如何使用它。

您的代码将起作用。首先删除`[ForeignKey("AccessCodeId")]`. 这是多余的，无论如何你把它放在了错误的属性上。Code First 将按照**惯例**`AccessCodeId`设置为外键。是导航属性，不会在数据库中生成，它只是为了让您的生活更轻松。有关更多信息，请阅读本文：[代码优先约定](http://msdn.microsoft.com/en-us/library/hh161541%28v=vs.103%29.aspx)。**`AccessCode`**

 **这是工作代码（我测试过）：

```
public class Person
{
    public int Id { get; set; }
    public string LastName { get; set; }
    public string FirstName { get; set; }
    public DateTime BirthDate { get; set; }

    public int AccessCodeId { get; set; }
    public virtual AccessCode AccessCode { get; set; }
}

public class AccessCode
{
    public int Id { get; set; }
    public string Code { get; set; }
}

public class MyContext : DbContext
{
    public DbSet<Person> Persons { get; set; }
    public DbSet<AccessCode> AccessCodes { get; set; }
}

class Program
{
    static void Main(string[] args)
    {
        Database.SetInitializer<MyContext>(new DropCreateDatabaseAlways<MyContext>());

        var context = new MyContext();

        var person = new Person
        {
            FirstName = "Nadege",
            LastName = "Deroussen",
            BirthDate = DateTime.Now,
            AccessCode = new AccessCode { Code = "ABC" }
        };
        context.Persons.Add(person);

        var accessCode = new AccessCode { Code = "MGH" };
        context.AccessCodes.Add(accessCode);
        context.SaveChanges();

        var person2 = context.Persons.FirstOrDefault();
        person2.AccessCodeId = 2;
        // or person2.AccessCode = accessCode;

        context.SaveChanges();

        Console.Write("Person saved !");
        Console.ReadLine();
    }
} 
```

更改将在数据库上下文中可见。**

# imagemagick - RMagick 智能调整大小

> ID：10737918
> 
> 赞同：0
> 
> 时间：2012-05-24T12:55:07.507
> 
> 标签：imagemagick, rmagick

有没有办法让 RMagick 像这样调整图像的大小：

*   调整大小，使宽度和高度都小于 200 像素，但保持纵横比
*   如果宽度 > 200 且宽度 > 高度，则调整大小以使宽度 = 200 并相应地调整高度
*   如果高度 > 200 且高度 > 宽度，则调整大小以使高度 = 200 并相应调整宽度

*编辑*：顺便说一句，我正在寻找实现这一点的[这种](http://www.imagemagick.org/Usage/resize/#resize)语法方式，而不是基于 API 的操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T16:27:51.813

此方法应该有效，图像是 Rmagick 图像，宽度和高度是整数（图像的最大尺寸）

```
def resize_to_limit(image,width, height)
  geometry = Magick::Geometry.new(width, height, 0, 0, Magick::GreaterGeometry)
  image.change_geometry!(geometry) do |new_width, new_height, img|
    img.resize!(new_width, new_height)
  end
  image
end 
```

前任。我想将图像大小调整为 2000，如果它比那个大，保持纵横比

```
image = resize_to_limit(image,2000,2000) 
```

# session - 如何清除销售人员中页面的视图状态

> ID：10737922
> 
> 赞同：0
> 
> 时间：2012-05-24T12:55:17.887
> 
> 标签：session, salesforce, viewstate

我正在使用 apex 创建一个应用程序，我从用户那里获取输入。但是，如果用户不输入某些字段，我想清除为该字段维护的视图状态。这在销售人员中可能吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T23:04:51.647

我不确定我是否理解你在这里的意思——如果他们不填写这些字段，那么你不想要它们中的值？如果他们没有填写任何内容，那么当您在顶点控制器中处理它们时，您的绑定变量将只包含空字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-16T11:11:16.320

使用 transient 关键字声明无法保存的实例变量，并且不应作为 Visualforce 页面的视图状态的一部分传输。

瞬态字符串 inputfieldName;

# php - 将已通过 AJAX 上传到 DIV 的变量传递到同一个 DIV 并用结果替换内容

> ID：10737924
> 
> 赞同：1
> 
> 时间：2012-05-24T12:55:23.350
> 
> 标签：php, javascript, jquery, html, ajax

我目前通过 PHP 提交解析时将页面上的表单更新为 DIV 的表单结果。PHP 文件生成另一种形式，然后我需要将其传递给另一个 PHP 并用结果更新它之前所在的 DIV。

这是我的 HTML：

```
 <div id="content">
  <div id="options">
    <form id="form1">
      <table>
        <tr>
          <td>Date:</td>
          <td><input name="date" type="text" id="datepicker" /></td>
        </tr>
        <tr>
          <td>Size:</td>
          <td><input name="size" type="text" /></td>
        </tr>
        <tr>
          <td colspan="2"><input name="submit" type="submit" value="Submit"/></td>
        </tr>
      </table>
    </form>
  </div>
  <div id="result"> </div>
</div> 
```

以及我的 AJAX 脚本，用于将此表单中的结果加载到 DIV“结果”中。

```
 <script>
            $(function() { 
            $('#form1').submit(function(e) {
                e.preventDefault(); // stops form from submitting naturally
                $.ajax({
                    data: $(this).serialize(),
                      url: 'ajax/ajax-details.php',
                      success: function(response) {
                          $('#result').html(response); 
                      }
                  });
              });
             });
     </script> 
```

我希望它解析为的 PHP 文件称为“ajax/ajax-info.php”，我要从中传递信息的表单名称称为“id='info'”。

我想我现在的剧本快到了。

```
 <script>
            $(function() { 
            $('#info').submit(function(e) {
                e.preventDefault(); // stops form from submitting naturally
                $.ajax({
                    data: $(this).serialize(),
                      url: 'ajax/ajax-info.php',
                      success: function(response) {
                          $('#result').html(response); 
                      }
                  });
              });
             });
     </script> 
```

任何有关如何更改它或在任一文件中找到它以使其工作的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:21:49.453

您必须使用该`live()`函数在动态出现的 DOM 元素上设置事件

```
<script>
        $(function() { 
        $('#info').live('submit', function(e) {
            e.preventDefault(); // stops form from submitting naturally
            $.ajax({
                data: $(this).serialize(),
                  url: 'ajax/ajax-info.php',
                  success: function(response) {
                      $('#result').html(response); 
                  }
              });
          });
         });
 </script> 
```

# javascript - javascript中的httprequest和二进制数据

> ID：10737926
> 
> 赞同：6
> 
> 时间：2012-05-24T12:55:28.773
> 
> 标签：javascript, html, xmlhttprequest, binary-data, responsetext

在多次尝试读取作为 jpg 图像的二进制数据流的 httprequest 的响应后仍然挣扎。

编辑：整件事

```
xmlhttp = false;
        /*@cc_on@*/
        /*@if (@_jscript_version >= 5)
        // JScript gives us Conditional compilation, we can cope with old IE versions.
        // and security blocked creation of the objects.
        try {
            xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
        } catch (e) {
            try {
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            } catch (E) {
                xmlhttp = false;
            }
        }
        @end@*/
        if (!xmlhttp && typeof XMLHttpRequest != 'undefined') {
            try {
                xmlhttp = new XMLHttpRequest();
            } catch (e) {
                xmlhttp = false;
            }
        }
        if (!xmlhttp && window.createRequest) {
            try {
                xmlhttp = window.createRequest();
            } catch (e) {
                xmlhttp = false;
            }
        }

        xmlhttp.open("GET", theUrl, true);  
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState == 4) {

                var headers = xmlhttp.getAllResponseHeaders(); 
            }
        }

        xmlhttp.send(null); 
```

我使用的是 IE8，没有 HTML 5（也在 FF12 中尝试过），所以我总是会遇到类似的错误

```
xhr.overrideMimeType('text\/plain; charset=x-user-defined'); 
```

或者

```
xhr.responseType = "arraybuffer"; 
```

即使复制到变量中也行不通

```
var body = xhr.response; //.responseText , .responseBody 
```

任何想法有什么问题或我可以尝试什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:47:02.567

我做了[这个例子](http://exifdemo.staticloud.com/)来在客户端读取二进制 JPEG 并解析 EXIF 数据。它使用[BinFileReader.js](http://nagoon97.wordpress.com/reading-binary-files-using-ajax)，这使得处理二进制数据和跨浏览器变得非常容易。[这是一个 zip 文件中的全部内容](http://exifdemo.staticloud.com/exif_demo.zip)，包括一个基于节点的网络服务器（使用节点 server.js 运行）我还包括一个[网络工作者示例](http://exifdemo.staticloud.com/worker.html)。

如果您只是从二进制流中制作图像，为什么不直接添加`<img src="blah" />`到您的 DOM 中呢？

```
$('body').append('<img src="' + URL + '"/>'); 
```

# ruby-on-rails - 通过 nginx 流式传输来自 unicorn 的 rails 生成的响应

> ID：10737928
> 
> 赞同：0
> 
> 时间：2012-05-24T12:55:32.070
> 
> 标签：ruby-on-rails, nginx, streaming, unicorn, generated

我的 Rails 应用程序会动态生成 ~10MB 响应，如下所示：

```
self.status_code = 200
self.response-body = Enumerator.new { |y| ... } 
```

`unicorn_rails`通过I can以开发模式启动应用程序，`curl http://127.0.0.1:3000/foo > /dev/null`并查看通过进度反馈流式传输到客户端的响应。使用时`rails server`（启动 webrick），没有流式传输，我看到进度在那里，然后从 0% 跳到 100%。

然而，当部署在 staging/production 上时，unicorn 位于 nginx 和 unix 套接字之后。在该配置中，`curl http://staging/foo > /dev/null`当数据生成时，类似的进程看到进度为 0%，然后在传输时从 0% 到 100%，就像没有流式传输一样。事实上，通过查看服务器日志，我可以看到 curl 在生成请求的整个过程中一直在等待，并且一旦请求完成，curl 在接收数据时就会涓涓细流。

我的假设是某些东西（nginx 或其他）在将整个请求实际发送到客户端之前将其缓冲在某处。

目前我已经`proxy_buffering off`在 nginx 配置中使用过，并且`X-Accel-Buffering`HTTP 响应标头无济于事。我还将 Ubuntu 10.04 的 nginx 0.7 从半官方 ppa 提升到 1.2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T08:40:15.063

事实证明[10738118](https://stackoverflow.com/questions/10738118/)是行为的根源。实际上，`Last-Modified`响应中的缺失会触发 Rails/Rack 中某处的缓冲。

# vb.net - 部分代码片段随机退出当前方法

> ID：10737930
> 
> 赞同：0
> 
> 时间：2012-05-24T12:55:42.803
> 
> 标签：vb.net, clr

这是我有时在某些库中遇到的一个非常奇怪的错误（无论它是否包含在框架中）。

例如，这次我通过 LuaInterface 得到它：

```
//' s = string to existing file path
lua.DoFile(s)
Dim func = lua.GetFunction("ohai_regex()")
Dim ret = func.Call() 'doesnt do anything
//' file s contains function ohai()
MessageBox.Show("Geronimo!") 'NEVER gets reached 
```

我希望 func.Call() 在出现问题时返回异常，或者做任何事情来出错，但在这里它只是谋杀了我的方法，该方法立即返回！这里同样的东西也在一个循环中，它不再进行任何迭代，它只是停止执行这个函数并继续运行程序。

这已经发生在我身上几次了。不过我不记得其他时间了。

（也许我在这里使用的 LuaInterface 代码是错误的，但这不是我的重点......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:00:46.213

我看到两个可能的原因：

*   代码*实际上*确实抛出了一个异常，您可以在其他级别捕获并忽略它。
*   库中的代码被破坏，因此它从堆栈中吃掉自己的返回地址，并在返回时使用您的方法的返回地址。

# android - 安卓助手导入

> ID：10737931
> 
> 赞同：6
> 
> 时间：2012-05-24T12:55:47.260
> 
> 标签：android, import, aidl

我正在尝试将 android.content.Context 导入 AIDL 文件，但 eclipse 无法识别它。

这是我的代码：

```
package nsip.net;

import android.content.Context; // error couldn't find import for class ...

interface IMyContactsService{

void printToast(Context context, String text);

} 
```

谁能帮我？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T13:06:42.360

using`android.content.Context`不会起作用，因为它没有实现`android.os.Parcelable`.

但是-如果您有一个`MyExampleParcelable`要在 AIDL 接口中传输的类（例如）（实际上实现`Parcelable`了），则可以创建一个`.aidl`文件，`MyExampleParcelable.aidl`在其中编写：

```
package the.package.where.the.class.is;

parcelable MyExampleParcelable; 
```

* * *

现在，除非您非常想跨流程交谈，否则您应该考虑本地服务。

**编辑**（稍微更有帮助）：

这是一个*本地服务*（即它只会在您自己的应用程序和进程中使用）？在这些情况下，通常最好实现一个活页夹并直接返回它。

```
public class SomeService extends Service {
    ....
    ....
    public class SomeServiceBinder extends Binder {
        public SomeService getSomeService() {
            return SomeService.this;
        }
    }

    private final IBinder mBinder = new SomeServiceBinder();

    @Override
    public IBinder onBind(Intent intent) {
        return mBinder;
    }

    public void printToast(Context context, String text) {
        // Why are you even passing Context here? A Service can create Toasts by it self.
        ....
        ....
    }
    // And all other methods you want the caller to be able to invoke on
    // your service.
} 
```

基本上，当`Activity`绑定到您的服务时，它只会将结果`IBinder`转换为`SomeService.SomeServiceBinder`、 call `SomeService.SomeServiceBinder#getSomeService()`- 和***bang***，访问正在运行的`Service`实例 + 您可以在其 API 中调用内容。

# javascript - 你如何访问构造函数变量？

> ID：10737937
> 
> 赞同：0
> 
> 时间：2012-05-24T12:56:07.747
> 
> 标签：javascript, prototype-programming

我在 Javascript 中有一个“类”，在构造函数中分配了一个变量。我还使用原型来存储变量/方法：

```
var MyClass = function() 
{ 
    this.age = 100;
};

MyClass.prototype.name = "John";
MyClass.prototype.getAge = function() { return this.age};

alert(MyClass.prototype.name); //Alerts John
alert(MyClass.age); //undefined as expected
alert(MyClass.prototype.getAge()); //undefined?? 
```

所以据我所知，除非我从 Class 创建一个对象，否则我无法访问存储在 MyClass 中的构造函数变量：

```
var theClass = new MyClass();
alert(theClass.age);
alert(theClass.getAge());​ 
```

两个警报都将正确返回年龄。

所以重申一下，我可以直接从 MyClass 访问构造函数变量而无需创建变量吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:58:00.130

`age`不。您示例中的变量是在构造函数运行时*创建的；*因此，在您运行该功能之前，它不会可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T12:58:09.487

> 所以据我所知，除非我从 Class 创建一个对象，否则我无法访问存储在 MyClass 中的构造函数变量

正确的。它们在函数体中分配。在函数执行之前，它们不会存在。

> 所以重申一下，我可以直接从 MyClass 访问构造函数变量而无需创建变量吗？

不。

# iphone - 按住 UIView 并仅移动子视图

> ID：10737942
> 
> 赞同：0
> 
> 时间：2012-05-24T12:56:38.137
> 
> 标签：iphone, ios5, uiview, subview, uipangesturerecognizer

我有一个 UIView，然后我使用 CoreGraphics 绘制了一个几何图形。这个几何图形被添加为 UIView 的子视图。我打算使用 UIPanGestureRecognizer 来移动绘图。是否可以保持 UIView 并仅移动设计？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:16:21.473

写下这段代码。

```
UIPanGestureRecognizer *panRecognizer = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(panPiece:)];
    [panRecognizer setMinimumNumberOfTouches:1];
    [panRecognizer setMaximumNumberOfTouches:1];

    [panRecognizer setDelegate:self];
    [yourSubview addGestureRecognizer:panRecognizer];

- (void)panPiece:(UIPanGestureRecognizer *)gestureRecognizer
{
    UIView *piece = [gestureRecognizer view];

    if ([gestureRecognizer state] == UIGestureRecognizerStateBegan || [gestureRecognizer state] == UIGestureRecognizerStateChanged) {
        CGPoint translation = [gestureRecognizer translationInView:[piece superview]];

        [piece setCenter:CGPointMake([piece center].x + translation.x, [piece center].y + translation.y)];
        [gestureRecognizer setTranslation:CGPointZero inView:[piece superview]];

    }

} 
```

在上述方法中实现您的代码。这将对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T13:01:43.640

如果您的绘图视图是 a `UIView`，您可以随时添加 a`UIPanGestureRecognizer`来移动它，就像这样：

```
UIPanGestureRecognizer *pan = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(drawingMoved:)];    
[_drawingView addGestureRecognizer:pan];
[pan release]; 
```

像这样处理运动：

```
- (void)drawingMoved:(UIGestureRecognizer *)sender
{
    NSUInteger numOfTouch = [sender numberOfTouches];
    if (numOfTouch==1) {
        CGPoint point = [sender locationInView:_parentView];
        UIView *drawingView = sender.view;
        drawingView.center = point;
    }    
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T13:33:01.973

您可以编写 if 条件来过滤移动对象。在此链接上查看我的帖子[单击此处](https://stackoverflow.com/questions/4837368/how-to-drag-only-one-image-with-iphone-sdk/10529446#10529446)：-

谢谢你！

# php - 使用 PHP 在文件系统上获取网站目录

> ID：10737944
> 
> 赞同：1
> 
> 时间：2012-05-24T12:56:42.683
> 
> 标签：php, url, document-root

我在本地计算机上有一个网站。我正在使用 wamp 服务器来运行我的网站。

网站的 URL 是**http://localhost/mywebsite/**

我在我的网站文件夹**mywebsite/component/add/files/add.php中放置了一个 PHP 文件**

所以文件的实际路径是`c:\\wamp\www\mywebsite\component\add\files\add.php`.

我想在我的文件中显示路径**c:\wamp\www\mywebsite 。**

我怎么才能得到它？将来当我将网站移动到其他地方时，我不需要手动更改路径。它必须自动更新。这有什么功能吗？

**例如，如果我在mywebsite/demo**中移动我的网站，路径将是**C:\wamp\www\mywebsite\demo**

我希望这很清楚。我不想在那里显示**http://localhost/mywebsite**路径。

谁能帮我 ？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T13:01:28.413

[$_SERVER 数组](http://php.net/manual/en/reserved.variables.server.php)应该包含您要查找的信息。例如：

```
$_SERVER['DOCUMENT_ROOT'] 
```

这将是为 PHP 服务器配置的文档根目录。在你的情况下，我相信会是`c:\wamp\www`。您还可以使用：

```
$_SERVER['SCRIPT_FILENAME'] 
```

这将是当前运行脚本的绝对路径。还有一些包含有用信息的[魔术常量](http://php.net/manual/en/language.constants.predefined.php)，特别是如果您还有在 Web 服务器上下文之外运行的 PHP 脚本。（后台任务等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T13:04:20.470

利用：

```
 $_SERVER['DOCUMENT_ROOT']; 
```

或者

```
 Perhaps you want: dirname(__FILE__) 
```

[http://php.net/manual/en/language.constants.predefined.php](http://php.net/manual/en/language.constants.predefined.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T13:11:41.587

您可以使用此代码

```
str_replace($_SERVER['DOCUMENT_ROOT'], '', $_SERVER['SCRIPT_FILENAME']) 
```

或者

```
str_replace($_SERVER['DOCUMENT_ROOT'], '', dirname(__FILE__));
str_replace($_SERVER['DOCUMENT_ROOT'], '', __DIR__); // works only in php > 5.3 
```

# django - Celerybeat - Django 的定期任务

> ID：10737947
> 
> 赞同：1
> 
> 时间：2012-05-24T12:57:05.460
> 
> 标签：django, django-celery, celerybeat

我不确定事情如何组合在一起..

我有一个包含活动活动的应用程序，可以宣布获胜者等，并为活动发送提醒。该活动是用 django 创建的，在活动模型中，我有一个字段，表示每 X 天、每周或每小时通知一次获胜者。因此，对于本次活动，获奖者必须在每周五公布。这是每个广告系列，可能有多个广告系列具有不同的获胜者和提醒设置。

我不确定从哪里开始 celerybeat 任务？是否应该保存模型？但是如果你改变一些东西并再次保存模型呢？它不会创建另一个任务，然后导致发送 2 个或更多提醒等吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T13:39:49.753

Celerybeat 是一个守护进程，它应该永久[在后台运行](http://ask.github.com/celery/cookbook/daemonizing.html)（使用类似 supervisord 的东西）。鉴于您的最短提醒延迟是一个小时，它应该每小时运行一个任务。

这个任务应该检查所有的活动，并根据数据库中的数据决定它应该发送哪些提醒。为方便起见，我建议您在发送提醒时计算并保存下次发送提醒的时间。这样下一次，列出要发送的提醒就像列出所有过期提醒一样简单。

# iphone - ObjectForKey - 如何检查 ObjectForKey 是否有 @"String"

> ID：10737957
> 
> 赞同：1
> 
> 时间：2012-05-24T12:57:37.237
> 
> 标签：iphone, xcode, ios5, xcode4

我有这条线...

```
 if(![[[array objectAtIndex:indexPath.row] objectForKey:@"special_trip"] isEqualToString:@""]) { 
```

一切都很酷.. 但是我的 special_trip 有很多信息，所以我只想以字符串 Airport in 的结果为例： 1:Airport, Packet

我只想获取那些在整个字符串中包含 Airport 的结果。

提前致谢。

编辑：抱歉混淆。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T13:01:36.427

用这个：

```
if([myString rangeOfString:@"Airport"].location != NSNotFound ) {
    // myString contains Airport
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T13:01:11.910

我认为您正在寻找功能

```
NSArray *filteredArray = [myArray filteredArrayUsingPredicate:predicate]; 
```

查看[Predicate Programming Guide](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates/Articles/pUsing.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T13:19:31.113

如果我没听错.....为什么不使用这条简单的线-

```
if([[[array objectAtIndex:indexPath.row] objectForKey:@"special_trip"] isEqualToString:@"Airport"])
{
   //
} 
```

如果我错了:-(请让我知道到底是什么问题。

谢谢！

# git - undoing git merge after merge.renameLimit warning plus conflicts

> ID：10737966
> 
> 赞同：15
> 
> 时间：2012-05-24T12:58:24.860
> 
> 标签：git, version-control, git-merge

I am trying to do a merge squash from a devel branch into the master.

```
stefanos-imac:trunk borini$ git merge --squash devel
CONFLICT (content): Merge conflict in test1
warning: inexact rename detection was skipped due to too many files.
warning: you may want to set your merge.renamelimit variable to at least 2224 and retry the command.
Squash commit -- not updating HEAD
Automatic merge failed; fix conflicts and then commit the result. 
```

fair enough.

```
stefanos-imac:trunk borini$ git config merge.renameLimit 999999 
```

Then I try to undo the merge and redo it with the higher limit

```
stefanos-imac:trunk borini$ git merge --abort
fatal: There is no merge to abort (MERGE_HEAD missing). 
```

Ok, so maybe I have to do as it says and just reinvoke the merge command

```
stefanos-imac:trunk borini$ git merge --squash devel
fatal: 'merge' is not possible because you have unmerged files.
Please, fix them up in the work tree, and then use 'git add/rm <file>' as
appropriate to mark resolution and make a commit, or use 'git commit -a'. 
```

oh git, why are you such a git?

More to the point, does anyone know how to get out of this situation ?

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-24T13:11:07.100

Em, `git reset --hard origin/master`?

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-10-01T10:40:54.123

The modern way to undo a merge is (but this only works when MERGE_HEAD is present):

```
git merge --abort 
```

And the slightly older way, which will work in this case (MERGE_HEAD is missing):

```
git reset --merge 
```

The old-school way described in accepted answer (warning: will discard all your local changes):

```
git reset --hard 
```

So notice that `git merge --abort` is only equivalent to `git reset --merge` given that `MERGE_HEAD` is present. This can be read in the git help for merge command.

```
git merge --abort is equivalent to git reset --merge when MERGE_HEAD is present. 
```

After a failed merge, when there is no `MERGE_HEAD`, the failed merge can be undone with `git reset --merge` but not necessarily with `git merge --abort`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-03-12T02:11:30.423

`git merge --abort` will also do the trick. A bit quicker than typing the full git reset command.

Abort also works with `rebase` and `cherry-pick`.

# ruby-on-rails - 无法加载此类文件 -- net/ssh/authentication/agent/socket (LoadError)

> ID：10737968
> 
> 赞同：3
> 
> 时间：2012-05-24T12:58:29.533
> 
> 标签：ruby-on-rails, rubygems, capistrano, net-ssh

如果我跑`rails s`

```
/Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require': cannot load such file -- net/ssh/authentication/agent/socket (LoadError)
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `block in require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/net-ssh-2.5.0/lib/net/ssh/authentication/agent.rb:22:in `<top (required)>'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `block in require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/net-ssh-2.5.0/lib/net/ssh/authentication/key_manager.rb:4:in `<top (required)>'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `block in require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/net-ssh-2.5.0/lib/net/ssh/authentication/session.rb:4:in `<top (required)>'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `block in require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/net-ssh-2.5.0/lib/net/ssh.rb:11:in `<top (required)>'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `block in require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/net-ssh-gateway-1.1.0/lib/net/ssh/gateway.rb:2:in `<top (required)>'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `block in require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/capistrano-2.12.0/lib/capistrano/configuration/connections.rb:2:in `<top (required)>'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `block in require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/capistrano-2.12.0/lib/capistrano/configuration.rb:5:in `<top (required)>'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `block in require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/capistrano-2.12.0/lib/capistrano.rb:3:in `<top (required)>'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.1.3/lib/bundler/runtime.rb:68:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.1.3/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.1.3/lib/bundler/runtime.rb:66:in `each'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.1.3/lib/bundler/runtime.rb:66:in `block in require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.1.3/lib/bundler/runtime.rb:55:in `each'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.1.3/lib/bundler/runtime.rb:55:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.1.3/lib/bundler.rb:119:in `require'
    from /Users/frankie/projects/unitedfreelance/config/application.rb:13:in `<top (required)>'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.0/lib/rails/commands.rb:53:in `require'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.0/lib/rails/commands.rb:53:in `block in <top (required)>'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.0/lib/rails/commands.rb:50:in `tap'
    from /Users/frankie/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.0/lib/rails/commands.rb:50:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

**宝石文件**

```
source 'http://rubygems.org'

gem 'rails', '3.2.0'

# Bundle edge Rails instead:
# gem 'rails',     :git => 'git://github.com/rails/rails.git'

gem 'pg'
gem "cocoon"
gem 'nokogiri'
gem 'hpricot'
gem "formtastic", "~> 2.1.1"
gem "activeadmin", "~> 0.4.4"
gem 'omniauth'
gem 'country-select'
gem "paperclip", "~> 3.0"
gem 'cancan'
gem 'rolify'

gem "meta_search",    '>= 1.1.0.pre'
gem 'bourbon', "~> 2.0.0.rc1"
gem "rails-boilerplate"
gem 'geocoder'
gem 'httparty'
gem 'hashie'
gem 'will_paginate', :git => "git://github.com/mislav/will_paginate.git"
gem 'thinking-sphinx', '2.0.10'
gem 'sanitize'
gem 'feedzirra'
gem "crypt19", "~> 1.2.1"
gem 'wicked_pdf'
gem 'forem', :git => "git://github.com/radar/forem.git"
gem 'thin'
gem 'whenever', :require => false
gem "ckeditor", "3.7.1"
# gem 'sisow'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
end

gem 'haml-rails' 
gem 'jquery-rails'

group :development do
    gem 'ruby_parser'
end

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# Use unicorn as the web server
gem 'unicorn'

# Deploy with Capistrano
gem 'capistrano'

# To use debugger
# gem 'ruby-debug19', :require => 'ruby-debug' 
```

前一秒有效，下一秒无效。

在我尝试按照本指南修复 CKeditor 集成后，我停止了工作： [https ://github.com/galetahub/ckeditor](https://github.com/galetahub/ckeditor)

**更新**

发生此错误是因为我正在使用 Capistrano 并且该 gem 需要`net-ssh`. `net-ssh`gem 从 2.4 -> 2.5.0 更新，这导致了问题。

更新了我的 Gemfile：

```
gem 'rails', '3.2.0'
gem "net-ssh", "~> 2.4.0" 
```

然后跑了`$ gem update net-ssh`

rails s 命令的错误消失了。尚未使用 Capistrano 进行部署，因此无法确定使用部署是否存在错误。

**更新 2**

Capistrano 未能部署，所以这搞砸了。使用时，`cap deploy`我收到您在帖子开头看到的错误消息。

**更新 3**

升级`net-ssh`到，`2.5.1`因为在评论中有人提到`2.5.0`的被破坏了。升级后需求问题得到解决，但是 Capistrano 仍然不会部署。

```
[deploy:update_code] exception while rolling back: Capistrano::ConnectionError, connection failed for: 85.xxx.xxx.xxx (NameError: uninitialized constant Net::SSH::KnownHosts::SUPPORTED_TYPE)
connection failed for: 85.xxx.xxx.xxx (NameError: uninitialized constant Net::SSH::KnownHosts::SUPPORTED_TYPE) 
```

**更新 4（加上解决方法）**

在下面的评论中发布了解决方法。

*   将您的 net-ssh 版本保持在 2.5.1
*   在使用 Capistrano 进行部署之前，请从 ~/.ssh/known_hosts 文件中删除与您的服务器相关的行
*   您现在可以部署一次。在每次部署之前重复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T13:25:14.987

降级到 2.4.0 允许`rails s`工作，但`cap`命令失败。

通过发出以下命令确保使用 2.5.1：

```
bundle update net-ssh 
```

您也可以将其添加到您的 Gemfile 中：

```
gem "net-ssh", "~> 2.5.1" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T13:04:30.107

我认为这是 capistrano gem 的错误。我刚刚为我的项目执行了包更新并且有同样的错误，但是如果我从 Gemfile 中删除 capistrano，一切正常。

UPD：Capistrano gem 使用 1 小时前更新的 net-ssh gem。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T11:56:35.777

Gem 2.5.2 版为我解决了这个问题。

# javascript - 嵌入具有自动高度的小部件

> ID：10737973
> 
> 赞同：1
> 
> 时间：2012-05-24T12:59:01.600
> 
> 标签：javascript, jquery, html, embed

我们正在尝试开发一个可以被第三方嵌入到他们网站上的小部件。小部件的高度应由嵌入脚本自动调整。

我们最初考虑使用由 js 代码创建的 IFrame。我知道由于浏览器安全问题，加载后 IFrame 中的代码无法设置 IFrame 的高度。

有谁知道如何解决这个问题？我们考虑使用 disqus.com 的方式来处理他们的小部件。你可以在这里看到一个例子：http://www.readwriteweb.com/archives/the-webs-original-tv-show-ramp-up-continues-on-hulu-and-youtube.php。看看他们如何加载 html 并将其放置在主页中，而不是使用 IFrame。

期待一些帮助！

谢谢，

阿萨夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T17:06:26.023

[用http://easyxdm.net/wp/2010/03/17/resize-iframe-based-on-content/](http://easyxdm.net/wp/2010/03/17/resize-iframe-based-on-content/)解决了这个问题

# mysql - LOAD DATA LOCAL INFILE 给出错误 The used command is not allowed with this MySQL version

> ID：10737974
> 
> 赞同：10
> 
> 时间：2012-05-24T12:59:09.723
> 
> 标签：mysql, csv, load-data-infile, csv-import

我有一个 PHP 脚本，它调用 MySQL`LOAD DATA INFILE`从 CSV 文件加载数据。但是，在生产服务器上，我最终遇到了以下错误：

> 用户拒绝访问...（使用密码：是）

作为一种快速的解决方法，我将命令更改为`LOAD DATA LOCAL INFILE`有效。但是，相同的命令在客户端服务器上失败并显示以下消息：

> 此 MySQL 版本不允许使用的命令

我认为这与服务器变量有关：如此[处](http://dev.mysql.com/doc/refman/5.1/en/load-data-local.html)[`local_infile = off`](http://dev.mysql.com/doc/refman/5.1/en/server-system-variables.html#sysvar_local_infile)所述。

请提出不涉及更改服务器设置的解决方法。请注意，安装在同一台服务器上的 phpMyAdmin 实用程序似乎接受 CSV 文件，但我不确定它是否使用`LOAD DATA (LOCAL) INFILE`.

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-08-31T06:23:08.623

遇到与root相同的问题并扔了我一会儿

可能是您使用 compile 设置的服务器设置的问题

使用同一用户测试登录到控制台并尝试加载数据命令

如果您遇到相同的错误，请尝试关闭控制台并运行

```
mysql -u USER -p --local-infile=1 DATABASE 
```

现在尝试再次运行加载数据命令

如果它有效，那么您将需要使用命令行选项重新启动 mysqld 或使用配置选项重新安装

参考资料（参考资料适用于 5.0，但适用于 5.5）：

[http://dev.mysql.com/doc/refman/5.0/en/load-data-local.html](http://dev.mysql.com/doc/refman/5.0/en/load-data-local.html)

[http://dev.mysql.com/doc/refman/5.0/en/mysql-command-options.html#option_mysql_local-infile](http://dev.mysql.com/doc/refman/5.0/en/mysql-command-options.html#option_mysql_local-infile)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-18T18:02:59.953

我发现我需要像这样连接到数据库：

```
$dbh=mysql_connect($server,$dbuser,$dbpass,false,128); 
```

传入`128`flags 参数是关键。

请参阅[http://www.php.net/manual/en/mysql.constants.php#mysql.client-flags](http://www.php.net/manual/en/mysql.constants.php#mysql.client-flags)以了解有关标志的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T13:27:09.523

看看这个权限列表，可以单独添加，IE。您可以插入但不更新，或者您可以删除但不选择等...

```
ALL [PRIVILEGES]    Grant all privileges at specified access level except GRANT OPTION
ALTER   Enable use of ALTER TABLE
ALTER ROUTINE   Enable stored routines to be altered or dropped
CREATE  Enable database and table creation
CREATE ROUTINE  Enable stored routine creation
CREATE TEMPORARY TABLES     Enable use of CREATE TEMPORARY TABLE
CREATE USER     Enable use of CREATE USER, DROP USER, RENAME USER, and REVOKE ALL PRIVILEGES
CREATE VIEW     Enable views to be created or altered
DELETE  Enable use of DELETE
DROP    Enable databases, tables, and views to be dropped
EVENT   Enable use of events for the Event Scheduler
EXECUTE     Enable the user to execute stored routines
FILE    Enable the user to cause the server to read or write files
GRANT OPTION    Enable privileges to be granted to or removed from other accounts
INDEX   Enable indexes to be created or dropped
INSERT  Enable use of INSERT
LOCK TABLES     Enable use of LOCK TABLES on tables for which you have the SELECT privilege
PROCESS     Enable the user to see all processes with SHOW PROCESSLIST
REFERENCES  Not implemented
RELOAD  Enable use of FLUSH operations
REPLICATION CLIENT  Enable the user to ask where master or slave servers are
REPLICATION SLAVE   Enable replication slaves to read binary log events from the master
SELECT  Enable use of SELECT
SHOW DATABASES  Enable SHOW DATABASES to show all databases
SHOW VIEW   Enable use of SHOW CREATE VIEW
SHUTDOWN    Enable use of mysqladmin shutdown
SUPER   Enable use of other administrative operations such as CHANGE MASTER TO, KILL, PURGE BINARY LOGS, SET GLOBAL, and mysqladmin debug command
TRIGGER     Enable trigger operations
UPDATE  Enable use of UPDATE
USAGE   Synonym for “no privileges” 
```

我认为你有权选择、删除、插入、更新，但不能做其他事情，

使用这个命令：

```
SHOW GRANTS 
```

在我的情况下，他会告诉你你能做什么。

```
jcho360> show grants;
+-------------------------------------------------------+
| Grants for jbolivar@localhost                         |
+-------------------------------------------------------+
| GRANT ALL PRIVILEGES ON *.* TO 'jbolivar'@'localhost' |
+-------------------------------------------------------+
1 row in set (0.00 sec) 
```

# python - 搜索算法，但对于函数

> ID：10737986
> 
> 赞同：6
> 
> 时间：2012-05-24T13:00:17.770
> 
> 标签：python, algorithm

给定一个输入列表（假设它们只是整数）和一个函数列表（这些函数接受一个整数，并返回 True 或 False）。

我必须获取这个输入列表，看看列表中的任何函数是否会为列表中的任何值返回 True。

有什么方法可以比 O(n^2) 更快地做到这一点

现在我所拥有的是

```
for v in values:
    for f in functions:
        if f(v):
            # do something to v
            break 
```

有更快的方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T13:03:05.397

如果没有关于函数的任何进一步信息，`len(functions) * len(values)`可能的函数调用的结果必须被认为是彼此独立的，因此没有比全部检查更快的方法了。

不过，你可以写得更简洁一些：

```
any(f(v) for v in values for f in functions) 
```

内置函数`any()`也会短路，就像您的原始代码一样。

**编辑**：事实证明，所需的等价物是

```
all(any(f(v) for f in functions) for v in values) 
```

请参阅评论进行讨论。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T13:03:19.897

不，没有更快的方法。O(m*n) 是极限。如果你有更多关于函数的信息，你可能会打败它，但在一般情况下，没有。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T13:07:34.060

如果您对函数或值有更多了解，您可以做常规搜索引擎所做的事情——对值列表应用某种索引，只需要一次通过。

编辑：

这是一种`any()`适用于此用例的方法。

```
for v in values:
    if any(f(v) for f in functions):
        #do something to v 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-24T13:12:39.980

`O(nm)`仅查询它们并且不对手头的功能进行一些简化假设，您不能做得更好。

这是因为不存在任何此类函数的证明要求您证明，对于任何整数和任何函数，查询的结果都是`False`.

为了证明这一点，您只能执行所有查询，因为您的[状态空间](http://en.wikipedia.org/wiki/State_space_search)是`O(2^nm)`并且查询只是将状态空间减半，因此您需要`O(log_2(2^nm)) = O(nm)`查询以将您的状态空间减少到解决方案“每个函数对每个整数都返回 false”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-24T13:15:28.027

这实际上不是 O(n)，但它使您不必每次都迭代函数：

```
#combine all funcs into one with `or`
newFunc = reduce(lambda f,g: (lambda x: f(x) or g(x)), funcs)

#cleaner than for, i think
satisfied = any(map(newFunc, values)) 
```

讨论嵌套 lambdas 是否是 pythonic 是一个完全不同的故事，但在处理函数列表时，我倾向于从函数的角度思考。

# php - 获取文本 和输出

> ID：10737988
> 
> 赞同：0
> 
> 时间：2012-05-24T13:00:28.097
> 
> 标签：php, jquery, jquery-ui, twitter

我正在构建一个部分，它使用 jQuery UI 允许用户在屏幕上拖动单词来创建他们自己的句子，然后他们可以在 Twitter 上分享。

我希望他们创建的文本在他们单击“推文”按钮时输入到 Twitter 文本区域。

我希望，使用 PHP 或 JS，有一种方法可以输出已移动到 div 中的文本，然后将其输入到 Twitter 代码的“&text=Text%20goes%20here”部分。

```
<a href="https://twitter.com/intent/tweet?button_hashtag=SUYearbook&text=Text%20goes%20here" 
   class="twitter-hashtag-button" data-size="large" 
   data-related="username">Tweet #SUYearbook</a> 
```

如果您需要进一步了解，可以在这里查看设置：http: [//goo.gl/s6CBD](http://goo.gl/s6CBD)

重申一下：将文本拖到区域中，按下 Tweet 按钮（或“完成”按钮），它将文本内容添加到 Twitter 代码中，然后它就出现在推文模式中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T13:05:19.247

最简单的方法是`span`在拖放到该区域时为每个单词添加一个类，然后`span`使用适当的类循环遍历每个单词。像这样的东西：

```
$(".twitter-hashtag-button").click(function(e) {
    e.preventDefault();
    var text = $(".selectedWord").map(function() {
        return $(this).text();
    }).get().join(' ');
    window.location.assign("https://twitter.com/intent/tweet?button_hashtag=SUYearbook&text=" + text)
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T13:08:56.810

您最好的选择是`droppable`在目标 div 上使用插件并使用接受事件将单词添加到 twitter 链接。

# tridion - Tridion 2009 SP1 代理不返回结果

> ID：10737993
> 
> 赞同：7
> 
> 时间：2012-05-24T13:00:53.023
> 
> 标签：tridion, tridion2009, tridion-content-delivery

我在从代理加载动态组件演示文稿时遇到问题，该查询基于如下所示的相当简单的查询，我试图根据使用特定关键字标记来加载组件：

```
 private string GetComponentPresentations()
    {
        Logger.Log.Info("Entered GetComponentPresentations");
        var publicationCriteria = new PublicationCriteria(_publicationId);

        int schemaId = int.Parse(SchemaId.Split('-')[1]);

        // Is it the correct content type (Schema)
        var isSpecifedSchema = new ItemSchemaCriteria(schemaId);

        // Type of the item is 16 (Component).
        var isComponent = new ItemTypeCriteria(16);

        // All of the above conditions must be true
        Criteria isCorrectComponent = CriteriaFactory.And(isSpecifedSchema, isComponent);

        var publicationAndIsComponent = CriteriaFactory.And(publicationCriteria, isCorrectComponent);

        //Only get components tagged with the specified keyword
        var keywordCriteria = new KeywordCriteria(_productsCategoryTcmId, ProductFilter, Criteria.Equal);

        //Only get Components of the correct type from the correct publication
        Criteria fullCriteria = CriteriaFactory.And(publicationAndIsComponent, keywordCriteria);

        using (var query = new Query(fullCriteria))
        {
            string[] results = query.ExecuteQuery();
            using (var cpf = new ComponentPresentationFactory(_publicationId))
            {
                if(results != null)
                {
                    var resultString = new StringBuilder();

                    foreach (string componentTcmId in results)
                    {
                        Logger.Log.Info("Looping over results");

                        int componentId = int.Parse(componentTcmId.Split('-')[1]);

                        int templateId = int.Parse(TemplateId.Split('-')[1]);

                        ComponentPresentation cp = cpf.GetComponentPresentation(componentId, templateId);

                        if (cp != null && !string.IsNullOrEmpty(cp.Content))
                        {
                            resultString.Append(cp.Content);
                            Logger.Log.InfoFormat("Appended Content {0}",cp.Content);
                        }
                    }

                    Logger.Log.Info("Returning");
                    return resultString.ToString();
                }

                Logger.Log.Info("Results was null.");
                return string.Empty;
            }
        }

    } 
```

我可以在 Broker 数据库的 ITEMS_CATEGORIES_AND_KEYWORDS 表中看到带有我期望的关键字的项目，如果我注释掉查询并硬编码 TCM ID，我可以手动加载 CP。

我已确保已发布类别并且所有变量的值都是正确的。

我已确保关键字有一个值和一个设置为适当值的键。

我还能检查什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T20:39:29.663

I'd suggest removing each of the criteria from the query one by one, and checking what results get returned for each.

Another thing to check is that you are using the API that you think you are. Tridion has two very similar looking APIs for Broker queries. Double check that you are linking to the correct assemblies.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T13:34:20.357

您是否尝试过在查询中使用 SetCriteria 方法？例如：

```
query.SetCriteria(multipleCombinedFacetCriteria);
String[] itemURIS = query.ExecuteQuery(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T20:21:00.600

在查看 Java API 时，我可以看到这个重载：

```
KeywordCriteria(java.lang.String categoryName, java.lang.String keyword, FieldOperator operator) 
```

Does _productsCategoryTcmId maybe just need to be the name of Category instead of the URI?

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-29T07:51:02.320

I have managed to get this working using the following code:

```
 private string GetComponentPresentationsUsingFilter()
    {
        //RSL: Had to use the obsolete filtering API because could not get anything back from the Broker.
        var filter = new SearchFilter("tcm:0-" + _publicationId + "-1");
        var query = new Query();

        string schemaId = SchemaId.Split('-')[1];
        query.AddCriteria("schema", "=", schemaId);
        query.AddCustomMetaQuery(string.Format("KEY_NAME = 'product' AND CAST(KEY_STRING_VALUE as nvarchar(100))  = '{0}'", ProductFilter));
        string[] results = filter.Match(query, new Sorting("title=asc"), MaxItems);

        if (results == null)
        {
            Logger.Log.Info("Results was null.");
            return string.Empty;
        }

        using (var cpf = new ComponentPresentationFactory(_publicationId))
        {
            var resultString = new StringBuilder();
            Logger.Log.InfoFormat("Got {0} Results", results.Length);

            foreach (string componentTcmId in results)
            {

                int componentId = int.Parse(componentTcmId.Split('-')[1]);
                Logger.Log.InfoFormat("Got componentId as {0}", componentId);

                int templateId = int.Parse(TemplateId.Split('-')[1]);
                Logger.Log.InfoFormat("Got templateId as {0}", templateId);

                ComponentPresentation cp = cpf.GetComponentPresentation(componentId, templateId);

                if (cp != null && !string.IsNullOrEmpty(cp.Content))
                {
                    resultString.Append(cp.Content);
                    Logger.Log.InfoFormat("Appended Content {0}", cp.Content);
                }
            }

            return resultString.ToString();
        }
    } 
```

No idea why I can get results this way but nothing using the Criteria api?

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-12T17:50:07.240

Have you checked that the Category that you are querying on is published? You will need to do this if you are using the newer 'criteria' mechanism. It always gets me that one!

Thanks, Jonathan

# event-handling - mootools 中的 keyup 停止事件不起作用

> ID：10737995
> 
> 赞同：0
> 
> 时间：2012-05-24T13:01:05.977
> 
> 标签：event-handling, mootools, stoppropagation, mootools-events

我试图防止在文本字段中输入非数字字符。我的代码会验证字符，但不会阻止将其添加到文本框中。

我的代码：

```
var isNumberKey = function(e){
    //alert(e.which);
    if (e.which > 31 && (e.which < 48 || e.which > 57)) 
        return false;   
    return true;
}

var isBackSpaceKey = function(e){
    return e.which == 8;
}

var isArrowKey = function(e) {
    return e.which >= 37 && e.which <= 40;
}

var inputs = $$('.numberOnly');
inputs.addEvent('keyup', function(e){
    console.log(e.which);
    if (!isNumberKey(e) && !isBackSpaceKey(e) && !isArrowKey(e)){
        e.stop();
        return false;
    }
    return true;
}); 
```

HTML：

```
<input name="t1" type="text" class="numberOnly" id="t1"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:09:28.943

您应该使用`keydown`事件而不是`keyup`. 我会这样做：

```
var inputs = $$('.numberOnly');
inputs.addEvent('keydown', function(e){
    if (e.code >= 48 && e.code <= 57 ){
        return true;
    }
    e.stop();
    return false;
}); 
```

[http://jsfiddle.net/TsAkb/](http://jsfiddle.net/TsAkb/)

希望这可以帮助

**编辑：**

也许你也想允许“tab”键、“enter”键和“backspace”=P