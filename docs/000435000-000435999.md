# StackOverflow 问答 000435000-000435999

# c# - ListBox ItemsSource 动态过滤器 WPF

> ID：435003
> 
> 赞同：4
> 
> 时间：2009-01-12T10:16:22.480
> 
> 标签：c#, wpf, data-binding

我想通过数据源进行 UI 虚拟化。

这个想法是“过滤”我发送到 UI 的内容（在我的例子中是一个列表框）。

我注意到 ItemsSource （一个可观察的集合）被读取一次，并且更改过滤器不会触发刷新......

我不明白为什么谢谢乔纳森

* * *

我会尽量说清楚：

我有 CollectionViewSource：

```
<CollectionViewSource x:Key="MyItemView"
                                  Source="{Binding Path=Model.CurrentItem}" /> 
```

然后在我的 ListBox 中使用这个数据源：

```
<ListBox x:Name="myListBox"
                 ItemsSource="{Binding Source={StaticResource MyItemView}}" 
```

我想实现一个转换器，它会返回一个过滤的集合（基于当前日期）：

```
<ListBox x:Name="myListBox"
                 ItemsSource="{Binding Source={StaticResource MyItemView}, Converter={StaticResource FilterByTime}, ConverterParameter=CurrentDate }" 
```

我是这样实现的：

```
public class FilterByTimeConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if (value != null)
            {
                System.Windows.Data.ListCollectionView list = value as System.Windows.Data.ListCollectionView;

                var model = DI.Resolve<ApplicationModel>();

                list.Filter = delegate(object item) 
                { 
                    bool r= (((MyModel)item).OriginalDate > model.TimeLine.CurrentDate.AddMonths(-1) 
                        && (((MyModel)item).OriginalDate < model.TimeLine.CurrentDate.AddMonths(1)));

                   // Console.WriteLine ("{0}<{1}<{2} : {3}",model.MyListBox.CurrentDate.AddMonths(-1),((MyModel)item).OriginalDate ,model. MyListBox.CurrentDate.AddMonths(1),r.ToString());
                    return r;
                };

                return list;
            }

            return DependencyProperty.UnsetValue;
        } 
```

这很好用......但只有在第一次出现时。当当前日期更改并且过滤器更改时，列表不会更新。

也许我应该听听 CurrentDate PropertyChange，但我很困惑如何做到这一点

谢谢乔纳森

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-12T10:51:00.053

`CollectionViewSource`本身支持通过其属性`Filter`进行过滤。你为什么不把你的过滤逻辑放在那里？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-10-20T09:20:43.727

好吧，我遇到了类似的问题，但提供了以下适用于我的解决方案：

假设，组合框显示作者列表和列表框所有书籍，我想按选定作者过滤书籍或显示所有未过滤的书籍。

相关的窗口 XAML 片段：

```
<ComboBox ItemsSource="{Binding Authors}"  DisplayMemberPath="FullName" SelectedValue="{Binding FilterAuthorBy, Mode=TwoWay}" />
<ListBox Name="bookList" ItemsSource="{Binding Books}"/> 
```

绑定本身在窗口构造函数上是这样完成的：

```
DataContext = new BookViewModel(this); 
```

视图模型定义如下：

```
public class BookViewModel
{
   private Author _filterAuthorBy;

   public BookViewModel(IBookView view)
   {
      ...
      _books = new CollectionViewSource();
      _books.Source = _bookRepository.FindAll().ToArray();
      _books.Filter += (sender, e) =>
                         {
                             Book book = e.Item as Book;
                             if (_filterAuthorBy == null)
                             {
                                 e.Accepted = true;
                             }
                             else
                             {
                                 e.Accepted = book.Authors.Contains(_filterAuthorBy);
                             }
                         };
   }

   public CollectionView Books
   {
       get
       {               
           return _books.View;
       }
   }

   public ObservableCollection<Author> Authors
   {
      get
      {
         return new ObservableCollection<Author>(_bookRepository.FindAllAuthors());
      }
   }

   public Author FilterAuthorBy
   {
       get
       {
           return _filterAuthorBy;
       }
       set
       {
           _filterAuthorBy = value;
           _books.View.Refresh();
       }
    } 
} 
```

选定的作者被传递给 ViewModel 并通过调用 collectionViewSource.View.Refresh() 更新列表框

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-12T10:52:41.343

您可能需要手动刷新：

```
currentViewSource.View.Refresh() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T10:30:22.857

你说的是什么过滤器？如果您是 CollectionView 然后绑定到它，那么即使控件可以使用也不会发生更改。

# javascript - xslt、javascript 和未转义的 html 实体

> ID：435005
> 
> 赞同：3
> 
> 时间：2009-01-12T10:17:03.570
> 
> 标签：javascript, xslt, html-entities

我对 xslt、js 和 html 实体有一点小问题，例如。在模板中：

```
<script type="text/javascript">
    <xsl:value-of select="/some/node"/>
    for (var i = 0; i &lt; 5; i++) {
        //            ^^^ js error
    }
</script>

<script type="text/javascript">
    <xsl:value-of select="/some/node"/>
    for (var i = 0; i < 5; i++) {
        //            ^ xslt error
    }
</script>

<script type="text/javascript">
    <xsl:value-of select="/some/node"/>
    // <![CDATA[
    for (var i = 0; i < 5; i++) {
        //            ^ becomes &lt;
    }
    // ]]>
</script>

<script type="text/javascript">
    <xsl:value-of select="/some/node"/>
    for (var i = 0; i <xsl:value-of disable-output-escaping="yes" select="string('&lt;')"/> 5; i++) {
        // works of course
    }
</script> 
```

有谁知道我的问题可能来自哪里？我一直认为 xslt 处理器在使用 html 输出方法时会使 <script/> 元素的内容不转义......

我在使用 macportsports 安装的 OSX 上运行 libxslt2 版本 1.1.24 ...

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-12T13:54:28.093

行。长话短说，简短回答：

似乎对于**某些 libxslt 版本**，xslt 处理器在使用 html 输出方法时不会转义 <script/> 元素的内容，**而其他版本则不会**......因此建议使用以下内容：

```
<script type="text/javascript">
    <xsl:value-of select="/some/node"/>
    <xsl:text disable-output-escaping="yes">
        // ^ does the trick ...
        for (var i = 0; i < 5; i++) {
            //            ^ works
        }
    </xsl:text>
</script> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T10:55:01.043

> 我一直认为 xslt 处理器在使用 html 输出方法时会使脚本元素的内容不转义

你是对的：http: [//www.w3.org/TR/xslt#section-HTML-Output-Method](http://www.w3.org/TR/xslt#section-HTML-Output-Method)

```
The html output method should not perform escaping for the content of the script and style elements.
For example, a literal result element written in the stylesheet as
    <script>if (a &lt; b) foo()</script>
or
    <script><![CDATA[if (a < b) foo()]]></script>
should be output as
    <script>if (a < b) foo()</script> 
```

如果您的 XSLT 处理器不这样做，那就是一个错误。

但是，在任何情况下，最好避免在嵌入式脚本中使用 '<' 和 '&'，将所有代码踢出到链接的 .js 文件中是一个更好的主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T10:21:18.600

这些`CDATA`块应该已经工作了；他们总是有我。你的`disable-output-escaping`价值是什么？

更新：使用 Xalan，`disable-output-escaping`默认情况下，我很确定`no`，我的工作 XSL 文件中有以下内容：

*   无`CDATA`块：

    ```
    for (var i = 0; i `&lt;` foo.length; i++) {
    …
    } 
    ```

*   `CDATA`堵塞：

    ```
    <![CDATA[

    for (var i = 0; i < foo.length; i++) { … }

    ]]> 
    ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T10:25:13.507

尝试在第三个解决方案的 CDATA 之前删除双斜杠

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-18T12:32:19.077

如果`xsl:output`方法是 html，则 CDATA 部分将起作用。如果`xsl:output`方法是 xml，< 和 > 符号仍然会被转换。

要解决此问题，您可以使用 xsl:output 元素将脚本元素定义为不以这种方式运行。您还可以使用 xml 或 html 强制输出的方法

```
<xsl:output method="xml" cdata-section-elements="script" />
...
<script type="text/javascript" language="javascript">
<![CDATA[
  for (var i = 0; i &lt; foo.length; i++) { … }
]]>
</script> 
```

# sharepoint - 如何从 _layout SharePoint 页面使用网站的母版页？

> ID：435019
> 
> 赞同：4
> 
> 时间：2009-01-12T10:21:59.533
> 
> 标签：sharepoint, layout, master-pages

我想在我的 SharePoint 12 hive/template/layouts/TelephoneBookList/test.aspx 文件中使用母版文件（如果有意义，则为该网站的文件）。但是，每当我将 MasterPageFile="~/_layouts/simple.master" 或类似内容添加到我的 test.aspx 页面时，我都会在日志文件中看到一个共享点错误页面和以下内容：

2009 年 1 月 12 日 10:56:26.95 w3wp.exe (0x1064) 0x1280 Windows SharePoint Services 拓扑 0 严重 URL 无效：[http://localhost](http://localhost)。您可能还需要更新引用[http://mcdevsp](http://mcdevsp)的任何备用访问映射。有关此错误的帮助：http: [//go.microsoft.com/fwlink/ ?LinkId=114854](http://go.microsoft.com/fwlink/?LinkId=114854)

2009 年 1 月 12 日 10:56:27.09 w3wp.exe (0x1064) 0x1280 Windows SharePoint Services 常规 8dzz 高异常类型：System.Web.HttpException 异常消息：文件 '/_layouts/TelephonebookList/~masterurl/default.master' 确实不存在。

2009 年 1 月 12 日 10:56:27.23 w3wp.exe (0x1064) 0x1280 Windows SharePoint Services 拓扑 0 严重 无效 URL：[http://localhost](http://localhost)。您可能还需要更新引用[http://mcdevsp](http://mcdevsp)的任何备用访问映射。有关此错误的帮助：http: [//go.microsoft.com/fwlink/ ?LinkId=114854](http://go.microsoft.com/fwlink/?LinkId=114854)

01/12/2009 10:56:27.70 w3wp.exe (0x1064) 0x1280 Windows SharePoint Services 常规 8dzw 中 spHttpHandler:GetHash 已启动

01/12/2009 10:56:27.70 w3wp.exe (0x1064) 0x1280 Windows SharePoint Services 常规 8dzx 中 spHttpHandler:GetHash 完成

如果没有 MasterPageFile 属性，它可以完美运行，但是它没有网站的全局外观。

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T14:04:17.340

尝试这个：

将 MasterPageFile 声明保留为默认值 (~/_layouts/simple.master) 并在您的自定义代码中覆盖 OnPreInit。

```
protected override void OnPreInit(EventArgs e)
{
    base.OnPreInit(e);

    this.MasterPageFile = SPContext.Current.Web.MasterUrl;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T17:45:03.213

SharePoint 要求使用 ~/_layouts/application.master 声明 _layouts 页面。然后可以使用 OnPreInit 技术在运行时更改主控。

可使用 HttpModule 更改所有应用程序页面上的主文件：[如何自定义 SharePoint application.master 文件](http://stephenkaye.blogspot.com/2008/03/how-to-customise-applicationmaster-file.html)

# java - Spring context.xml 和 Set.contains()

> ID：435023
> 
> 赞同：1
> 
> 时间：2009-01-12T10:24:53.337
> 
> 标签：java, spring, set, contains

Spring：在我的 context.xml 中，我有：

```
<util:set id="someIDs" 
      set-class="java.util.HashSet"
      value-type="java.lang.String">
         <value>"W000000001"</value>
         <value>"W000000003"</value>
         <value>"W000000009"</value>        
</util:set> 
```

在我的 Java bean 中，实现是：

```
private Set<String> someSet = 
              ComUtilities.uncheckedCast(getApplicationContext()
             .getBean("someIDs"));

boolean found = someSet.contains("W000000009"); 
```

avobe代码块执行后，发现是很诡异的假！怎么会？有什么建议/想法吗？谢谢一堆。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T10:28:33.547

突然想到 - 我很确定 Spring 不需要对字符串数据使用双引号。因此，它可能会将这些字符串插入到地图中，并在开头和结尾使用实际的双引号字符。

尝试检查

```
boolean found = someSet.contains("\"W000000009\""); 
```

看看是不是这样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T10:29:19.910

我认为这是因为您已经引用了 Spring 配置中的值，然后包含检查正在寻找未引用的字符串。用这个替换你的弹簧配置：

```
<util:set id="someIDs" 
  set-class="java.util.HashSet"
      value-type="java.lang.String">
             <value>W000000001</value>
             <value>W000000003</value>
             <value>W000000009</value> 
```

# wpf - 在工作线程上构建 WPF UI？

> ID：435025
> 
> 赞同：3
> 
> 时间：2009-01-12T10:25:44.193
> 
> 标签：wpf, multithreading

我必须在代码中构建一个相当复杂的 WPF UI（一个huge Grid）（没有 xaml invloved）。在构建网格的过程中，有没有办法阻止主 UI 线程阻塞？构建 UI 的某些部分是否可以外包给工作线程？UI 创建的哪些部分实际上必须在 UI 线程上？

*   调用
    控件的构造函数？
*   设置控件的属性？
*   设置数据绑定？
*   构建逻辑树（添加孩子）？

在构建 UI 时，我还有哪些其他选项可以提高性能？暂停调度程序或调用 FrameworkElement.BeginInit 是个好主意吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T10:47:36.660

如果您可以将 UI 的构建分解为多个步骤，则可以将这些步骤中的每一个作为单独的消息执行。这将允许在两者之间处理其他消息。就像是：

```
private delegate void BuildHandler();

private void BuildGridPart1()
{
    //build first part of grid

    Dispatcher.BeginInvoke(new BuildHandler(BuildGridPart2), DispatcherPriority.Background);
}

private void BuildGridPart2()
{
    //build second part of grid

    Dispatcher.BeginInvoke(new BuildHandler(BuildGridPart3), DispatcherPriority.Background);
}

//etc 
```

您可以将其重构为更简洁（例如，使用状态机的一种方法可以告诉您在网格中的位置），并自动将下一条消息以较低的优先级排队，以便始终首先处理输入。Bingo，在 UI 线程上构建 UI 时，您将拥有一个响应式 UI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T18:01:56.393

我的感觉是，除了在 UI 线程上运行之外，您可能没有太多选择。

如果所涉及的时间很长是因为收集和排列数据，那么后台线程将是最佳选择，然后使用 Dispatcher 对象调用任何 UI 依赖项属性。我假设时间不是收集任何数据，它纯粹取决于 UIElements 的编程创建。

`DispatcherObject`据我了解，UI元素派生自`Dispatcher`当前工作线程，因此排除了在另一个线程上创建控件的可能性。

然后在写入时调用所有依赖属性`Dispatcher.VerifyAccess`，如果在错误的线程上访问，则会引发异常。这样就排除了在不同线程上更新数据绑定和属性的可能性。

我的第一反应就像@Kent 写的那样。
稍微详细说明一下，如果每一行都有一个`foreach`循环，每列有一个循环，`foreach`那么即使您在正确的 UI 线程中，您也可以`Dispatcher.BeginInvoke`从长时间运行的方法中暂时调用“yield”。即分解它，然后将控制权返回给 UI 线程，以便稍后继续添加到网格中。布局工作可能要大得多，总时间会更长，但响应速度更快。

```
private void Window_Loaded(object sender, RoutedEventArgs e)
{
  CreateRow(1);
}

private void CreateRow(int i)
{
  // 
  // Construct row i of the grid
  //
  Dispatcher.BeginInvoke(DispatcherPriority.Background, new EventHandler(delegate { CreateRow(i + 1); }));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T19:58:58.603

你有什么理由必须在代码中构建它？如果是因为网格是动态的（IE 列直到运行时才知道），那么有一些方法可以绕过它。

需要您在代码中创建 UI 的确切问题是什么？一旦我们知道我们可以将其推广到模板和绑定。

无论如何，为了解决您的直接问题，您可以将工作转移到工作线程并让它使用 Dispatcher 更新 UI，就像其他人提到的那样。我还想指出，最好将您的工作分解为细粒度的单元......因此，例如，如果您为列表中每个项目的每个单独列创建 UI，您至少应该将其分解为项目级别，最好在列级别。

如果您使用的是 GOOD 网格，它可能使用虚拟化并有一个 API 供您连接到虚拟化事件。（本质上，网格只在需要时构建 UI，或者在需要时请求 UI 元素）。这使您可以避免在加载时构建整个网格。

# ibm-midrange - 如何在 CL 程序中访问当前库的名称？

> ID：435028
> 
> 赞同：1
> 
> 时间：2009-01-12T10:27:47.573
> 
> 标签：ibm-midrange, control-language

我需要在 CL 程序中显式使用当前库名称。

```
CHGVAR &LIB *CURLIB 
```

不起作用（在此行 &lib = '*curlib' 之后）。这应该很简单——有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T10:36:44.043

找到了：

RTVJOBA CURLIB(&LIB)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T00:32:09.230

请注意，给定作业可能没有当前库。在这种情况下 &LIB 的值为 *NONE

# powershell - Powershell在foreach序列中获取外部变量

> ID：435035
> 
> 赞同：2
> 
> 时间：2009-01-12T10:32:04.490
> 
> 标签：powershell

```
 PS C:\Projects> 
    get-childitem  -recurse 
 |  where { $_.Extension -eq ".csproj" }
 | foreach { Get-Content $_.FullName 
          | foreach { $_.Length } } 
```

这将打印 csproj 中每一行的行大小（毫无意义）。当我进一步深入时，我怎么能输出一个外部变量（可以这么说）。因此，例如，假设出于毫无意义的原因，我想让它也打印文件名，所以我会得到：

Dog.csproj：10 Dog.csproj：50 Dog.csproj：4 Cat.csproj：100 Cat.csproj：440

我想我想做这样的事情，但这显然不起作用，（是的，这个例子毫无意义）

```
 PS C:\Projects> 
        get-childitem  -recurse 
     |  STORE THIS IN $filename | where { $_.Extension -eq ".csproj" }
     | foreach { Get-Content $_.FullName 
              | foreach { $filename ":"  $_.Length } } 
```

我玩了 tee-object 和 outputvariable，但我有点迷茫。如果powershell大师可以回答它会有所帮助，而且如果您可以推荐一本书或资源来解释语言语法基础而不是COM / WMI / VB等API猴子的东西......（这似乎是我遇到的大部分内容）它将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-13T17:57:11.457

这是直截了当的方法：

```
`gci . -r "*.csproj" | % { $name = $_.name; gc $_.fullname |
         % { $name + ": " + $_.length }  }` 
```

如果您还不知道缩写，则相当于：

```
`Get-ChildItem . -recurse "*.csproj" | 
      foreach { $name = $_.name; Get-Content $_.fullname | 
      foreach { $name + ": " + $_.length }  }` 
```

至于一本书推荐，一定是布鲁斯·帕耶特的书： [http ://www.amazon.com/Windows-PowerShell-Action-Bruce-Payette/dp/1932394907](https://rads.stackoverflow.com/amzn/click/com/1932394907)

麦克风

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T12:19:00.283

```
get-childitem -recurse -filter *.csproj | select @{n="FileName";e={$_.FullName}},@{n="Lines";e={ $(cat $_.FullName).count}} 
```

它提供如下输出：

```
+--------------------------+---------+
|         FileName         |  Lines  |
---------------------------|---------+
| D:\Scripts\test1.csproj  | 867     |
| D:\Scripts\test2.csproj  | 1773    |
+--------------------------|---------+ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T13:51:55.070

怎么样：

```
dir -r -fo *.csproj | select @{n="FileName";e={$_.FullName}},@{n="LineLong";e={ cat $_.fullName | foreach {$_.length}}} 
```

# visual-studio - 在 MSBuild 中使用 Studio 的“自定义工具”

> ID：435037
> 
> 赞同：10
> 
> 时间：2009-01-12T10:33:02.163
> 
> 标签：visual-studio, msbuild, customtool

我有一个用于 Visual Studio 的“自定义工具”，可以将一些模板文件转换为代码。为了一致性和可移植性，我希望在 Visual Studio 之外构建时能够从 MSBuild 运行此模板处理器。

Visual Studio 为文件创建以下片段：

```
<!-- the template -->
<None Include="Template.in">
  <Generator>Template Processor</Generator>
  <LastGenOutput>Template.in.Designer.cs</LastGenOutput>
</None>
<!-- generated file -->
<Compile Include="Template.in.Designer.cs">
  <AutoGen>True</AutoGen>
  <DesignTime>True</DesignTime>
  <DependentUpon>Template.in</DependentUpon>
</Compile> 
```

这里的问题是，`Template.in`只有 Studio 处理，MsBuild 不处理，可能会导致`Designer.cs`文件过期。

是否有现有的 MSBuild 任务可以`IVsSingleFileGenerator`直接使用（包括从注册表加载其位置），还是我必须手动调用处理器（通过自己实现所述 MSBuild 任务或调整处理器）？

有趣的是，MSDN 上的[Using MSBuild](http://msdn.microsoft.com/en-us/library/bb166190.aspx)文章说：

> 单个文件生成器只能在设计时访问，但 MSBuild 任务可以在设计时和构建时使用。因此，为了获得最大的灵活性，请使用 MSBuild 任务来转换和生成代码。有关详细信息，请参阅项目项 (Visual Studio SDK)。

* * *

**更新：**我已经将这个特定的自定义工具破解为 msbuild 任务，但它并不漂亮。我仍然更喜欢维护良好的通用解决方案。我已经在我的博客上[发布了源代码。](https://web.archive.org/web/20100905141112/http://dasz.at/index.php/2010/02/building-a-simple-msbuild-task/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T18:24:04.413

当您从 VisualStudio 中指定自定义工具时，它会向您的项目或解决方案文件添加什么？由于它们只是 msbuild 文件，您可以使用添加的 xml 作为您自己的构建文件的模板。

# c# - 组合框 SelectedIndex 无法重置

> ID：435039
> 
> 赞同：0
> 
> 时间：2009-01-12T10:33:23.130
> 
> 标签：c#, combobox

我的表单上有一个组合框。如果我选择 ui 中的第 5 个项目，然后以编程方式将所选索引设置为 -1，看起来所选项目已重置 - 不显示文本，如果我用鼠标查看项目，第一项是项目索引为零。但如果我点击向下箭头按钮，则所选项目将是第六个！ComboBox 不知何故记得最后一个选定的项目是第 5 个，并且不关心我重置它。这个问题有什么解决办法吗？我会责怪一些有约束力的东西，但我不确定为什么会这样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T10:36:54.467

这是预期的行为 - 您将在 Windows 中任何位置使用的任何组合/下拉框上看到该行为。如果您想确保在向下箭头时选择组合框中的第一项，只需将 selectedIndex 设置为 0，然后将其设置为 -1。

# html - 将按钮放置在不使用表单 URL 的表单中

> ID：435044
> 
> 赞同：0
> 
> 时间：2009-01-12T10:36:00.787
> 
> 标签：html, xhtml, forms

我有一个带有 url 的常规表单，作为单击提交按钮（或按下输入）时表单提交的操作。
现在我需要第二个按钮可以转到另一个页面。我知道我应该为此使用一个链接，但就客户的要求而言，它应该看起来像一个按钮。
因为 CSS 表不是内部制作的（我无法进行交流），所以我需要表单中的一个按钮，因此不能为按钮使用第二个表单。

我认为以下任何一个标签都可以完成这项工作：

```
<input type="button"> 
```

或者

```
<button> 
```

我可以将其中任何一个设置为在不使用 javascript 的情况下导航到链接吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T10:55:23.553

不使用 JavaScript 的唯一方法是将第二个按钮放在第二个表单中，其操作是所需的目标。您可以使用 CSS 将第二个按钮定位在第一个表单的“内部”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T11:07:14.887

您可以使用以下任一方法执行此操作：

*   第二种形式

*   Javascript

*   CSS模拟锚链接上按钮的外观

似乎您已经排除了所有三个问题，但也许您为内联样式留下了一个小窗口（您说您无法控制“CSS 表格”，但为样式属性留出了空间），但这解决方案当然不会将任何表单信息传递到其他页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T10:45:03.000

不，你必须使用 javascript

> `<input type="button" value="go" onclick="javascript:location.href='http://www.stackoverflow.com';" />`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T10:38:49.843

```
<input type="button" onclick="document.location='my_other_link'" value="Click here"/> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T10:45:18.893

它不能在纯 HTML 中完成。

**编辑：**当然，除了[彼得的方法](https://stackoverflow.com/questions/435044/place-button-in-a-form-that-does-not-use-the-forms-url#435089)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T10:47:44.693

动态更改表单的操作：

这是javascript代码：

```
function submitAnotherURL(){
 var yourForm = document.your_form_name;
 yourForm.action='your_other_link';
 yourForm.submit();
} 
```

html中的按钮：

```
<input type="button" onclick="submitAnotherURL()" value="Click here"/> 
```

# c# - 有没有办法在 C# 中使用可变参数进行引用传递？

> ID：435049
> 
> 赞同：4
> 
> 时间：2009-01-12T10:37:24.747
> 
> 标签：c#, reference, params

我想要一个函数来修改一些变量的参数列表，但它们都是值类型（int，string）。有一种方法可以使 params 关键字与 ref 关键字或类似的关键字一起使用吗？

```
public void funcParams(params object[] list)
{
   /* Make something here to change 'a', 'b' and 'c' */
}

public void testParams()
{
    int a = 1, b = 2, c = 3;

    funcParams(a, b, c);
} 
```

问题是，我试图让我的生活更轻松，制作一种修改对象字段的方法。我正在使用 Cecil 进行一些动态代码生成，并且试图避免编写过多的 IL 生成代码。

为了简化，我想通过引用传递字段列表，我需要更改为更改它们的函数，而不是通过生成相应的 IL 来更改它们。一些参数可以为空，使代码生成更加痛苦。在这种情况下，制作一些重载方法而不是参数不会有太大用处。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-12T10:40:48.560

好吧，你可以声明一些重载，即

```
public void FuncParams(ref int a) {...}
public void FuncParams(ref int a, ref int b) {...} 
```

ETC

否则，您将不得不从数组中读回（`params`实际上意味着“隐式数组”）：

```
object[] args = {1,2,3};
funcParams(args);
Console.WriteLine(args[0]); // updated
Console.WriteLine(args[1]); // updated
Console.WriteLine(args[2]); // updated 
```

（当然，如果它只接受`int`s，最好使用`int[]`通篇）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T11:17:45.273

是的。有可能的。

但是，生成的代码是“不安全的”，这使得它无法验证。

根据您的要求，这可能是也可能不是问题。

无论如何，这里是代码：

```
using System;

namespace unsafeTest
{
    class MainClass
    {
        public static void Main(string[] args)
        {
            Console.WriteLine("Hello World!");
            unsafe 
            {       
                int x = 0;
                int y = 0;
                int z = 0;
                bar(&x, &y, &z);
                Console.WriteLine(x);
                Console.WriteLine(y);
                Console.WriteLine(z);
            }
        }

        unsafe static void bar(params int *[] pInts)
        {
            int i = 0;
            foreach (var pInt in pInts)
            {
                *pInt = i++;
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T10:40:20.263

不，使用简洁的语法是不可能的。原因是，在内部，运行时将该方法视为采用数组参数的简单方法。编译器负责创建一个数组并用指定的参数填充它。由于参数是值类型，它们将被复制到数组中，对它们的任何更改都**不会**影响原始变量。实现它的其他方法将破坏存在的目的，`params`这是可变数量参数的一个很好的语法。

# .net - 如何以编程方式确定已安装的 IIS 版本

> ID：435050
> 
> 赞同：9
> 
> 时间：2009-01-12T10:38:46.270
> 
> 标签：.net, iis, version-detection

以编程方式确定当前安装的 Microsoft Internet 信息服务 (IIS) 版本的首选方法是什么？

我知道可以通过查看 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters 中的 MajorVersion 键找到它。

这是*推荐*的方法吗，还是有任何更安全或更美观的方法可供 .NET 开发人员使用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-02-23T15:20:24.537

```
public int GetIISVersion()
{
     RegistryKey parameters = Registry.LocalMachine.OpenSubKey("SYSTEM\\CurrentControlSet\\Services\\W3SVC\\Parameters");
     int MajorVersion = (int)parameters.GetValue("MajorVersion");

     return MajorVersion;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-13T07:52:16.373

**要从 IIS 进程外部识别版本，一种可能性如下...**

```
string w3wpPath = Path.Combine(
    Environment.GetFolderPath(Environment.SpecialFolder.System), 
    @"inetsrv\w3wp.exe");
FileVersionInfo versionInfo = FileVersionInfo.GetVersionInfo(w3wpPath);
Console.WriteLine(versionInfo.FileMajorPart); 
```

**要在运行时从工作进程中识别它...**

```
using (Process process = Process.GetCurrentProcess())
{
    using (ProcessModule mainModule = process.MainModule)
    {
        // main module would be w3wp
        int version = mainModule.FileVersionInfo.FileMajorPart
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T10:44:11.220

您可以构建一个 WebRequest 并将其发送到环回 IP 地址上的端口 80 并获取服务器 HTTP 标头。

```
HttpWebRequest myHttpWebRequest = (HttpWebRequest)WebRequest.Create("http://127.0.0.1/");
HttpWebResponse myHttpWebResponse = null;
try
{
    myHttpWebResponse = (HttpWebResponse)myHttpWebRequest.GetResponse();
}
catch (WebException ex)
{
    myHttpWebResponse = (HttpWebResponse)ex.Response;
}
string WebServer = myHttpWebResponse.Headers["Server"];
myHttpWebResponse.Close(); 
```

不确定这是否是一种更好的方法，但它肯定是另一种选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:26:33.280

我是这样做的（使用 Powershell）：

```
function Validate-IISVersion([switch] $ContinueOnError = $false)
{
if ($ContinueOnError)
{ $ErrorActionPreference = "SilentlyContinue" }
else
{ $ErrorActionPreference = "Stop" }

# Using GAC to ensure the IIS (assembly) version
$IISAssembly = [System.Reflection.Assembly]::LoadWithPartialName("Microsoft.Web.Administration")
$IISVersion = $IISAssembly.GetName().Version
$IISVersionString = [string]::Format("{0}.{1}.{2}.{3}", $IISVersion.Major, $IISVersion.Minor, $IISVersion.Build, $IISVersion.Revision)
if (!$IISVersionString.Equals("7.0.0.0"))
{
    if ($ContinueOnError)
    {
        Write-Host  "`nConflicting IIS version found! [Version: $IISVersionString]`t    " -NoNewline -ForegroundColor Red
    }
    Write-Error "Conflicting IIS version found [$IISVersionString]! @ $(Split-Path $MyInvocation.ScriptName -leaf)"
    return $false
}
else
{
    return $true
}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-19T19:45:27.730

无需编写代码。您可以在注册表编辑器中找到它

转到运行 -> 输入 - regedit ->

注册表的 LOCAL MACHINE 分支包含 Windows 7 的版本信息。

起始分支位于 (HKLM) HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \InetStp\ VersionString

注意：空格用于阅读目的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-04T09:08:40.077

下面的命令帮助我在 IIS 8.5 (Windows 2012 R2) 和 7.5 Windows 7 SP1 上正确找到了 IIS 版本。

***[System.Diagnostics.FileVersionInfo]::GetVersionInfo("$env:SystemRoot\system32\inetsrv\InetMgr.exe").ProductVersion***

**参考：**

[https://forums.iis.net/p/1171695/1984536.aspx](https://forums.iis.net/p/1171695/1984536.aspx)：来自 f00_beard 的回答

# javascript - 如何激活从 iframe 获取的 javascript-tag？

> ID：435054
> 
> 赞同：0
> 
> 时间：2009-01-12T10:40:40.370
> 
> 标签：javascript, iframe, rtf

我有一个 Javascript 的富文本编辑器，我希望能够在 Javascript 标记中输入嵌入式小部件。IE：

```
<script src="http://www.mydomain.com/script.aspx?id=123" type="text/javascript"></script> 
```

仍然使用 JS 我将 html 内容从 iframe 移动到页面中的 DIV 中：

```
<script>
    function copyRtfToDiv()
    {
        myiframe = document.getElementById('myiframe');
        postDiv = document.getElementById('blogPostDiv');
        content = myiframe.contentWindow.document.body.innerHTML;
        postDiv.innerHTML = content;
    }
</script> 
```

当内容被复制到 DIV 中时，不会调用脚本。有没有办法让这个脚本运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T10:47:21.173

First off, you seem to be copying JavaScript code into a DIV tags. That shouldn't really work, since it'll just treat it like regular text. To illustrate, compare these two blocks of code. The first, is a DIV:

```
<div>alert('hello!');</div> 
```

And it'll look on the page, like this:

alert('hello!');

The second block of code, is a script:

```
<script>alert('hello!');</script> 
```

Which will open a message box with the text "hello!", and await a user-click on "OK". But other than that, won't display anything in the page.

You're aiming for the 2nd option - one that actually runs the JavaScript code that resides between the tags.

I'd recommend wrapping the script you want to invoke in a function, and invoking that function by name. So let's say you have within the IFRAME an HTML document whose body looks something like this:

```
<div id='jscode'>
   function mycode() {
       // This is some code!
       alert('Hello there!'); 
   }
</div> 
```

You could then, in the IFRAME's parent document (the one containing the `<iframe>` tag), to use the following code in the parent to import it into the parent's DOM:

```
function copyRtfToDiv()
{
    myiframe = document.getElementById('myiframe');
    content = myiframe.contentWindow.document.GetElementById('jscode').innerHTML;
    newscripttag = document.createElement('script');
    newscripttag.innerHTML = content;
    mycode();
} 
```

I have no clue why you would want to do something like this - which is basically re-parenting JavaScript code to live within you document's DOM; There are better ways to do this, not least of which is using a different editor that can be simply called externally. For example, [tinyMCE](http://tinymce.moxiecode.com/examples/full.php) and [FCKEditor](http://www.fckeditor.net/demo).

Good luck!

# ruby-on-rails - JRuby on Rails 部署

> ID：435056
> 
> 赞同：1
> 
> 时间：2009-01-12T10:40:54.833
> 
> 标签：ruby-on-rails, apache, ssl, jruby, mongrel

我需要在 Mongrel 上托管一个 JRuby on Rails 应用程序。问题是我需要支持相互身份验证。我知道我可以使用 mod_proxy 将它托管在 Apache 后面，使用 mod_ssl 将 cred 或 cred 的一部分作为请求标头传递给 rails。但我希望整个堆栈都是 Java。是否有 Java 应用程序服务器可以进行 mod_proxy + ssl 类型的配置，而无需我安装 Apache。此外，我们需要它独立于平台。IIS 或 Apache+OpenSSL 实际上不是首选的替代方案。

也欢迎任何替代部署配置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T13:48:24.433

我实际上建议使用[jetty](http://jetty-rails.rubyforge.org/)或[glassfish](http://developers.sun.com/appserver/reference/techart/rails_gf/)来部署您的应用程序。您可以在 JRuby 中运行 mongrel，但它非常[慢](http://blog.headius.com/2007/09/end-is-near-for-mongrel.html)并且不再积极维护。我绝对不会将它用于生产环境（至少在 JRuby 中）。我发现码头更轻量级，都支持 SSL（[码头](http://docs.codehaus.org/display/JETTY/How+to+configure+SSL)，[Glassfish](http://blogs.oracle.com/theaquarium/entry/using_ssl_in_glassfish)）。

# umbraco - 在 umbraco 网站中设置起始节点

> ID：435060
> 
> 赞同：3
> 
> 时间：2009-01-12T10:44:16.260
> 
> 标签：umbraco

我有这个多语言网站的内容结构。

*   内容
    *   丹麦语
        *   福赛德
        *   欧姆奥斯
    *   英语
        *   首页
        *   关于我们

当我启动网站时，它会自动在丹麦节点中启动，但我希望它在“Forside”中启动，而对于侧面的英文部分，我希望它在节点“Frontpage”中启动。

节点“丹麦语”和“英语”也是页面节点，但仅作为逻辑文件夹结构存在。

有什么方法可以选择我的网站应该从哪个内容节点开始？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-19T14:23:05.963

您可以使用内置功能：

1.  将名为“umbracoRedirect”的属性添加到与“丹麦语”节点关联的文档类型。
2.  将属性设置为“内容选择器”类型并保存
3.  在“丹麦”节点处，将属性设置为指向节点“ForSide”。

那应该行得通。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T10:57:44.513

嘿彼得，在做多语言网站时，我倾向于采用以下结构

*   mywebsite.co.uk
    *   关于
    *   接触
*   mywebsite.com
    *   关于
    *   接触

然后，我将主机标头应用到 .co.uk 和 .com 节点，并使用适当的语言来使用字典项。

我会让 Forside/Frontpage 成为我在结构中创建的 .co.uk/.com 节点，因为这看起来像是您创建的不必要的级别。

沃伦

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T15:30:45.980

umbraco 有一种方法可以开箱即用地支持全球化。您不必创建 2 个不同的内容树。

[Umbraco 多语言 1:1 站点](http://www.umbraco.org/documentation/books/multilingual-11-sites)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-24T20:30:00.100

另一个对我有用的简单选项是对根节点进行排序，尽管我接受它可能不适合所有人。Umbraco 似乎只是使用内容树中的第一个内容作为起始页（至少 v6.1.5 确实如此），并且它似乎尊重排序，所以在这个特定的实例中，您可以对其进行排序，以便“英语”逻辑容器节点位于“丹麦”逻辑容器节点之前。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-29T11:28:41.437

Umbraco 选择第一个站点节点作为起始节点。我建议您在名为 isPrimary 的站点节点文档类型中添加一个真/假字段，然后在您的代码中，您可以找到选中此字段的站点节点并导航到它。

# licensing - Windows Server 2008 许可限制

> ID：435067
> 
> 赞同：-1
> 
> 时间：2009-01-12T10:46:24.727
> 
> 标签：licensing, windows-server-2008

我即将购买 Windows Server 2008 的副本（用户 CAL，5 个 CLT） IIS 是否将限制为 5 个并发匿名 Internet 用户？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T10:59:19.320

不，这不对 ：）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T22:57:13.410

没有

[Windows Server 2008 客户端访问许可](http://www.microsoft.com/windowsserver2008/en/us/client-licensing.aspx)

相关部分：

> 每个访问或使用 Windows Server 2008 服务器软件的用户或设备都需要购买 Windows Server 2008 客户端访问许可证 (Windows Server CAL) **，但以下情况除外**：
> 
> *   如果**仅通过 Internet 访问服务器软件的实例，而无需**通过服务器软件或任何其他方式进行身份验证或以其他方式单独识别
> *   如果访问的是 Windows Web Server 2008
> *   如果外部用户正在访问服务器软件的实例，并且您已为每个正在访问的服务器获取了 Windows Server 2008 外部连接器许可证
> *   最多允许两个设备或用户访问您的服务器软件实例，仅用于管理这些实例
> *   如果您仅将 Windows Server 2008 用作虚拟化主机（您仍然需要针对您的相应 WS 版本的 CAL）

# java - java.util.ConcurrentLinkedQueue

> ID：435069
> 
> 赞同：17
> 
> 时间：2009-01-12T10:46:39.923
> 
> 标签：java, tomcat, servlets, concurrency, queue

我想使用 java.util.ConcurrentLinkedQueue 作为 Servlet 的非持久队列。这是该类的 javadoc 中的简介。

> 基于链接节点的无界线程安全队列。当许多线程将共享对公共集合的访问时，ConcurrentLinkedQueue 是一个合适的选择。此队列不允许空元素。

现在想象一下，我在 servlet 上有 1000 个并发请求，每个线程都需要将一个对象加入到 ConcurrentLinkedQueue 中。从描述中，我是否应该得出结论认为处理负载不会有问题？我需要的保证是：

1.  我无需自己进行同步即可自动获得线程安全保证。
2.  如果流量负载超过 1000 个并发请求，我不会丢失任何请求。

谢谢

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-01-12T16:20:52.570

您本质上是在问三个不同的问题（其中两个是明确的，一个是隐含的。）它们是我的答案：

**1.如果我使用，我需要自己做同步`java.util.ConcurrentLinkedQueue`吗？**

并发集合上的原子操作会为您同步。换句话说，对队列的每个单独调用都保证是线程安全的，无需您进行任何操作。**不能**保证线程安全的是您对集合执行的任何非原子操作。

例如，这是线程安全的，您无需执行任何操作：

```
queue.add(obj); 
```

或者

```
queue.poll(obj); 
```

然而; 对队列的非原子调用不是自动线程安全的。例如，以下操作**不是**自动线程安全的：

```
if(!queue.isEmpty()) {
   queue.poll(obj);
} 
```

最后一个不是线程安全的，因为很有可能在调用 isEmpty 和调用 poll 之间，其他线程会从队列中添加或删除项目。执行此操作的线程安全方式如下：

```
synchronized(queue) {
    if(!queue.isEmpty()) {
       queue.poll(obj);
    }
} 
```

再次......对队列的原子调用是自动线程安全的。非原子调用不是。

**`java.util.ConcurrentLinkedQueue`2.如果有1000个并发请求，我是否保证不会丢失呼叫？**

因为这是一个无限制的实现，你可以保证无论有多少并发请求，队列都不会丢失这些请求（因为队列的并发性......你可能会用完内存或类似......但是队列实现本身不会成为您的限制因素。）在 Web 应用程序中，还有其他机会“丢失”请求，但队列的同步（或缺乏同步）不会成为您的原因。

**3.`java.util.ConcurrentLinkedQueue`表现是否足够好？**

通常，当我们谈论并发时，我们会谈论“正确性”。我的意思是，并发类保证它们是线程安全的（或者对死锁、饥饿等具有鲁棒性）。当我们谈论这个时，我们并没有对性能做出任何保证（对集合的调用速度有多快）是）——我们只保证它们是“正确的”。

然而; ConcurrentLinkedQueue 是一个“无等待”的实现，所以这可能是你可以获得的性能。保证 servlet 的负载性能（包括使用并发类）的唯一方法是在负载下对其进行测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T11:01:12.653

请记住，队列仅对单个成员的调用是线程安全的。不要编写这样的代码并期望它能够工作：

```
if (queue.Count!=0)
    queue.Dequeue().DoSomething(); 
```

在这两个操作之间，另一个线程可能已将最后一个元素出队。我对 Java 集合并不熟悉，但我猜 Dequeue 在这种情况下会返回`null`，给你一个例外。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T10:52:35.683

1.  由于队列是线程安全的，因此您不需要执行任何同步来确保线程安全。但是，您应该确保所有线程都可以平等地访问队列，以避免饥饿、忙等待等......

2.  由于队列是无界的，队列的大小仅受可用内存量的限制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T10:59:53.170

是的，对于你的两个问题。

并发队列*是*线程安全的（并且由于下面使用的无块算法而高效）。*线程安全* **意味着**并发访问的数量*不能*有任何区别（我还没有听说过保证不会在 xyz 并发访问以下发生的竞争条件）。

除此之外——多线程应用程序中的最佳性能比这更复杂。但是使用真正的并发集合并不是一个糟糕的开始。

# xml - 用于创作和编辑 XML 文档的最佳免费 Eclipse 插件是什么？

> ID：435084
> 
> 赞同：8
> 
> 时间：2009-01-12T10:53:54.680
> 
> 标签：xml, eclipse

在我以前的工作中，我使用 XMLSpy 进行 XML 创作和编辑，但现在我需要一个免费的 Eclipse 插件来执行此操作。我的基本要求是：

```
- General XML document editing
- Creating XSD files
- Creating WSDL files 
```

你能为此推荐一个免费的 Eclipse 插件吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-12T12:23:00.710

在免费部门，[**WTP**（Web 工具平台）](http://www.eclipse.org/webtools/index.php)（最新版本）确实包含很多功能，
包括[模式创建/修改](http://help.eclipse.org/help33/index.jsp?topic=/org.eclipse.wst.xsdeditor.doc.user/topics/cxmlsced.html)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-05-31T04:18:31.147

有一个用于编辑 XML 的官方 Eclipse 插件。它是[Eclipse WebTools 项目](http://www.eclipse.org/webtools/)的一部分。您可以从 ***[http://download.eclipse.org/webtools/updates](http://download.eclipse.org/webtools/updates)***的更新站点安装它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-05-30T11:50:33.470

希望对你有帮助！

**[XML Eclipse 编辑器和 XMLBuddy](http://www.ibm.com/developerworks/library/os-ecxml/)**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T07:58:39.633

我对在 Eclipse 中编辑 xml 文档的微型[xmlbuddy](http://www.xmlbuddy.com/)插件有积极的体验（基于普通和 xsd/dtd）。可能它对你也有用。它有点旧，但在最新版本的 eclipse (3.x) 中运行良好。[它的功能列表](http://xmlbuddy.com/2.0/features.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-01T06:02:55.850

你可以试试手写！WSDL 起初看起来有点吓人，但实际上只要您熟悉 XML，它就相当简单。

我写了一篇关于[编写 WSDL](http://blog.gamatam.com/2011/01/writing-wsdl-11-web-service-contract-by.html)的教程，希望得到反馈：

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T11:37:36.963

要编写 XML/XSL 文件，您可以使用[oxyxml](http://www.oxygenxml.com/eclipse_plugin.html)

或者免费版的[editix](http://free.editix.com/)

# java - 服务主体名称 (SPN) 是否绑定到特定机器？

> ID：435091
> 
> 赞同：2
> 
> 时间：2009-01-12T10:56:17.377
> 
> 标签：java, kerberos, gssapi

目前，我的 GSS 演示应用程序（在服务器端）收到 KrbException：解密字段的完整性检查失败（31）。现在我正在寻找这个的原因。我怀疑，它来自于这样一个事实

1.  客户端和服务器应用程序在同一台机器 (localhost) 上运行和/或
2.  SPN 是为另一台机器（计算机）生成的

第二个表示服务主体是为机器 xxx0815.domain.net 生成的，所以 SPN 是 HTTP/xxx0815.domain.net@DOMAIN.NET。而且我的机器不是那个，但是我已经拿到了keytab文件，这样服务器的登录方法就成功了。

我怀疑正确还是我犯了另一个错误？

服务器配置及源码：
server.conf

```
Server { 
    com.sun.security.auth.module.Krb5LoginModule 
        required 
        isInitiator=false 
        doNotPrompt=true 
        useKeyTab=true 
        keyTab="gssdemo.keytab" 
        storeKey=true 
        principal="HTTP/xxx0815.domain.net@DOMAIN.NET" 
        debug=true; 
}; 
```

GSSServer.java（省略了样板文件）

```
 GSSManager manager = GSSManager.getInstance();
    GSSName serverName = manager.createName(getServerName(), null);
    GSSCredential serverCred = manager.createCredential(serverName,
                                                        GSSCredential.INDEFINITE_LIFETIME,
                                                        createKerberosOid(),
                                                        GSSCredential.ACCEPT_ONLY);
    GSSContext context = manager.createContext(serverCred);
    System.out.println("Context created successfully. Now incoming tokens could be accepted.");

    ServerSocket serverSocket = new ServerSocket(55555);
    SocketAdapter ca = new SocketAdapter(serverSocket.accept());

    while (!context.isEstablished()) {
        byte[] inToken = ca.readToken();
        byte[] outToken = context.acceptSecContext(inToken, 0, inToken.length);

        if (outToken != null) {
            ca.sendToken(outToken);
        }
    }

    System.out.println("Context established");
    System.out.println("Connected user is: " + context.getSrcName());
    context.dispose(); 
```

客户端配置及源码：
client.conf

```
Client {
    com.sun.security.auth.module.Krb5LoginModule
        required
        useTicketCache=true
        debug=true;
}; 
```

GssClient.java（样板省略）

```
 GSSManager manager = GSSManager.getInstance();
    GSSName clientName = manager.createName(getClientName(), null);
    GSSCredential clientCred = manager.createCredential(clientName,
                                                        8 * 3600,
                                                        createKerberosOid(),
                                                        GSSCredential.INITIATE_ONLY);
    GSSName serviceName = manager.createName("HTTP/xxx0815.domain.net@DOMAIN.NET", null);

    GSSContext context = manager.createContext(serviceName,
                                               createKerberosOid(),
                                               clientCred,
                                               GSSContext.DEFAULT_LIFETIME);
    context.requestMutualAuth(true);
    context.requestConf(false);
    context.requestInteg(true);

    System.out.println("Establishing context");
    SocketAdapter ca = new SocketAdapter(new Socket("localhost", 55555));

    byte[] inToken = new byte[0];
    while (true) {
        byte[] outToken = context.initSecContext(inToken, 0, inToken.length);

        if (outToken != null) {
            ca.sendToken(outToken);
        }

        if (context.isEstablished()) {
            break;
        }

        inToken = ca.readToken();
    }

    System.out.println("Context established: " + context.isEstablished());

    context.dispose(); 
```

我检查了传出和传入的网络数据 - 两边都是一样的，所以我可以排除那里的问题（我对输出进行了 BASE64 编码，然后通过流发送它。我认为没有什么可以去的那里错了...）。

我得到的例外：

```
Caused by: GSSException: Failure unspecified at GSS-API level (Mechanism level: Integrity check on decrypted field failed (31))
    at sun.security.jgss.krb5.Krb5Context.acceptSecContext(Krb5Context.java:741)
    at sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:323)
    at sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:267)
    at de.westlb.mrm.sandbox.gss.GssServer.acceptAndEstablish(GssServer.java:88)
    at de.westlb.mrm.sandbox.gss.GssServer.run(GssServer.java:66)
    ... 4 more
Caused by: KrbException: Integrity check on decrypted field failed (31)
    at sun.security.krb5.internal.crypto.DesCbcEType.decrypt(DesCbcEType.java:154)
    at sun.security.krb5.internal.crypto.DesCbcMd5EType.decrypt(DesCbcMd5EType.java:33)
    at sun.security.krb5.internal.crypto.DesCbcEType.decrypt(DesCbcEType.java:125)
    at sun.security.krb5.internal.crypto.DesCbcMd5EType.decrypt(DesCbcMd5EType.java:33)
    at sun.security.krb5.EncryptedData.decrypt(EncryptedData.java:168)
    at sun.security.krb5.KrbApReq.authenticate(KrbApReq.java:267)
    at sun.security.krb5.KrbApReq.<init>(KrbApReq.java:134)
    at sun.security.jgss.krb5.InitSecContextToken.<init>(InitSecContextToken.java:79)
    at sun.security.jgss.krb5.Krb5Context.acceptSecContext(Krb5Context.java:724)
    ... 8 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T11:15:18.290

如果完整性检查失败，则表明数据未正确发送/接收（或者这是不正确的错误消息）。换句话说，发生了一些修改。

我知道您说您已经在网络级别检查了发送的数据是否与接收的数据匹配，但是您确定它在发送之前或接收之后没有损坏吗？我建议您首先检查您的代码。

编辑：在回答您的问题时，可以将服务主体（实际上是任何票证）绑定到特定机器，但这通常是根据 IP 地址完成的。在任何情况下，类似的事情都会导致不同的更高级别的错误。

您收到的错误听起来像是一开始就无法解密票证。一个可能的原因是它使用了错误的密钥，这可能与您复制密钥表有关。使用错误的票证也可能导致错误的密钥（因为 kerberos 基本上提供了密钥管理协议）。您是否可能缓存了旧的/不正确的票？

# language-agnostic - 如何设计一个允许定义验证的简单类结构？

> ID：435098
> 
> 赞同：0
> 
> 时间：2009-01-12T10:59:30.833
> 
> 标签：language-agnostic

我的公司处理纸质表格，以便将书面数据存入数据库。每个表单都有一组字段。我正在编写一个简单的内部应用程序来定义表单的字段，其中包括字段的验证。我现在正在考虑类结构，我可以想到两种方法：

1.  我可以编写一组类，每个类代表一个验证，例如**RegexValidation**及其**Pattern**属性，**LengthValidation**及其**Min**和**Max**等等。但是，如果将来出现任何新的验证类型，我可能会在项目中有很多地方我必须编写新代码。我真的不认为会有任何新的验证类型，但这是我作为程序员不应该做出的假设。

2.  第二种方法是创建一个抽象类**Validation**并且所有的验证器类都将从它继承。他们将有一个字典，将参数名称映射到它们的值（这样**LengthValidation**将有带有键“ **max** ”和“ **min** ”的项目，而**RegexValidation**将有带有键“**模式的项目”**” 等等）。它看起来很不错，但有一个主要问题 - 将数据写入数据库时​​，我必须知道哪个验证是哪个验证，以便我可以将值放在适当的位置。我可以使用策略设计模式并让验证类具有保存方法，以便每个类都知道它是如何保存在数据库中的。但另一方面，我不希望验证类负责将数据写入数据库。

那你有什么建议？还有其他想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T11:13:44.627

编写类层次结构很好。验证有许多验证子类。

当出现新的验证时，不需要重写任何旧的验证。旧的东西仍然存在并且仍然有效。当有人请求新的 SomeNewIDNumberValidation 时，EmailAddressValidation 不会改变。

如果你发现了一个错误，当然，一个类会被重写。

当您添加新的验证时，您将不会“在项目中有很多地方需要我编写新代码”。您将拥有新的验证和需要新验证的应用程序。没什么。这就是 OO 软件的伟大之处——添加子类不会破坏任何东西。

您需要所有验证器子类都有一个统一的“is_valid”方法。这就是你如何使它们成为多态的。它们不需要具有相同的构造函数，只需相同的验证器即可。

此外，您需要每个验证器对象返回“已清理，可供数据库使用”的值。一些验证者可以（并且应该）清理他们的输入。从信用卡号码中删除空格。例如，删除人们在电话号码中输入的任何奇怪的标点符号。

您想要构建一个包含许多验证器的复合对象。我将使用 Python 语法，因为它更简单。

```
class SomeValidatableObject( object ):
    field1 = ThisValidator( size=12, otherSetting="B" )
    field2 = RegexValidator( expr=r"\d{3}-\d{2}" )
    field3 = SSNValidator()
    field4 = YetAnotherValidator( someSetting=9, size=14 ) 
```

所有构造函数都特定于验证。所有逐个字段的验证都是一种常用`is_valid`方法。每个验证器都可以有一个`clean_data`方法。

您的复合对象可以有一个`save`方法，该方法根据所有不同字段的值构建生成的有效对象。

[这不是我设计的，我是在描述[Django 项目](http://www.djangoproject.com)使用的验证器。] 如果您查看[Forms](http://docs.djangoproject.com/en/dev/#forms)文档，您会看到它们是如何解决这个问题的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T12:02:36.447

grails 有一堆验证器：http: [//www.grails.org/Validation+Reference](http://www.grails.org/Validation+Reference)。考虑构建验证器的层次结构并使用从成员名称到验证器的静态映射。当违反约束时，您可能需要考虑错误消息中的 i18n。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T12:10:04.077

我不知道这是否完全符合你的问题，但是......

我最近使用过微软的模式和实践验证应用程序块——我真的很喜欢这个实现[http://msdn.microsoft.com/en-us/library/cc309509.aspx](http://msdn.microsoft.com/en-us/library/cc309509.aspx)

也许如果您查看他们提供的产品，它会给您一些想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T07:24:14.323

经过几个具有验证逻辑的项目后，我来到了第三个选项。

**通用规则**定义为：

```
///<summary>
/// Typed delegate for holding the validation logics
///</summary>
///<param name="obj">Object to validate</param>
///<param name="scope">Scope that will hold all validation results</param>
///<typeparam name="T">type of the item to validate</typeparam>
public delegate void Rule<T>(T obj, IScope scope); 
```

**IScope**在哪里

```
/// <summary>
/// Concept from the xLim2\. That's simple nesting logger that is used by
/// the validation rules. 
/// </summary>
public interface IScope : IDisposable
{
    /// <summary>
    /// Creates the nested scope with the specified name.
    /// </summary>
    /// <param name="name">New name for the nested scope.</param>
    /// <returns>Nested (and linked) scope instance</returns>
    IScope Create(string name);

    /// <summary>
    /// Writes <paramref name="message"/> with the specified
    /// <paramref name="level"/> to the <see cref="IScope"/>
    /// </summary>
    /// <param name="level">The level.</param>
    /// <param name="message">The message.</param>
    void Write(RuleLevel level, string message);

    /// <summary>
    /// Gets the current <see cref="RuleLevel"/> of this scope
    /// </summary>
    /// <value>The level.</value>
    RuleLevel Level { get; }
} 
```

和**规则级别**是：

```
/// <summary>
/// Levels leveraged by the <see cref="Rule{T}"/> implementations
/// </summary>
public enum RuleLevel
{
    /// <summary> Default value for the purposes of good citizenship</summary>
    None = 0,
    /// <summary> The rule raises a warning </summary>
    Warn,
    /// <summary> The rule raises an error </summary>
    Error
} 
```

有了它，即使不声明新类，您也可以定义新规则：

```
public static void ValidEmail(string email, IScope scope)
{
    if (!_emailRegex.IsMatch(email))
        scope.Error("String is not a valid email address");
} 
```

或通过附件组成新的验证器

```
/// <summary>
/// Composes the string validator ensuring string length is shorter than
/// <paramref name="maxLength"/>
/// </summary>
/// <param name="maxLength">Max string length.</param>
/// <returns>new validator instance</returns>
public static Rule<string> Limited(int maxLength)
{
    Enforce.Argument(() => maxLength, Is.GreaterThan(0));
    return (s, scope) =>
    {
        if (s.Length > maxLength)
            scope.Error("String length can not be greater than '{0}'", maxLength);
    };
} 
```

规则可以组合在一起并且仍然保持可读性：

```
internal static Rule<string>[] UserName = new[]
{
    StringIs.Limited(6, 256),
    StringIs.ValidEmail
}; 
```

为了运行规则，您只需向其传递一个对象、一个范围（将输出写入），然后检查范围以获取结果。

此范例中的其他可扩展点：

*   规则可以通过检查范围的当前错误级别相互“通信”（即：如果已经存在问题，CPU 密集型规则可能会跳过）
*   您可以编写检查复杂业务对象的规则（通过利用 IScope.Create）
*   您可以通过传入不同的范围实现来实现不同的规则行为（无需更改规则）。例如：

    *   快速参数范围可用于检查函数参数并在遇到第一个问题时立即抛出异常
    *   验证范围可用于检查要抛出的函数参数和遇到所有问题的异常
    *   MessageBased 范围可用于通过一些错误提供程序将复杂域对象的规则失败绑定到 UI 元素（范围路径用于此）

在这个简单的概念中有更多的扩展点））

顺便说一句，[开源实现](http://rabdullin.com/journal/2008/11/23/net-application-block-for-validation-and-business-rules.html)可用于 .NET。

PS：在我们公司，我们在单个文件（相当小）中为公共 API 定义了一些规则，并在各处重复使用这些规则进行验证。

# wpf - PreviewCanExecuteEvent 未执行

> ID：435101
> 
> 赞同：0
> 
> 时间：2009-01-12T11:00:35.807
> 
> 标签：wpf, attached-properties

我的 WPF 程序有问题。我正在尝试创建一个对象，它将处理程序添加到同一范围内的所有控件。

以下行不起作用。未处理该事件。

```
element.AddHandler(CommandManager.PreviewCanExecuteEvent, new CanExecuteRoutedEventHandler(scope.CanExecutedHandler), true); 
```

我还有一个绑定到按钮的命令。所以我的想法是我希望命令的 CanExecute 运行：这很好用。我还想要 PreviewCanExecute 的处理程序：这不起作用。

很抱歉，我无法更好地解释。

请参阅下面的代码：

**XAML：**

```
<Window.Resources>
    <my:PermissionScope x:Key="permissionManager"/>
</Window.Resources>
<StackPanel>
    <TextBox Height="23" Name="textBox1" Width="120" />
    <Button Content="Permission Required" Command="{Binding Path=PermissionRequired}" my:PermissionScope.SharedPermissionScope="{StaticResource permissionManager}"/>
    <Button Content="Permission not required" Command="{Binding Path=PermissionRequired}"/>
</StackPanel> 
```

**PermissionScope.cs**

```
public class PermissionScope
{

    public static readonly DependencyProperty SharedPermissionScopeProperty =
        DependencyProperty.RegisterAttached("SharedPermissionScope", typeof(PermissionScope), typeof(PermissionScope),
        new FrameworkPropertyMetadata(null, FrameworkPropertyMetadataOptions.Inherits,
        new PropertyChangedCallback(OnUseGlobalSharedPermissionScopeChanged)));

    public static void SetSharedPermissionScope(DependencyObject depObj, PermissionScope scope)
    {
        // never place logic in here, because these methods are not called when things are done in XAML
        depObj.SetValue(SharedPermissionScopeProperty, scope);
    }

    public static PermissionScope GetSharedPermissionScope(DependencyObject depObj)
    {
        // never place logic in here, because these methods are not called when things are done in XAML
        return depObj.GetValue(SharedPermissionScopeProperty) as PermissionScope;
    }

    private static void OnUseGlobalSharedPermissionScopeChanged(DependencyObject depObj, DependencyPropertyChangedEventArgs args)
    {
        if (depObj is Button)
        {
            if (args.OldValue != null)
            {
                RemoveEventHandlers(depObj as UIElement, args.OldValue as PermissionScope);
            }
            if (args.NewValue != null)
            {
                AttachEventHandlers(depObj as UIElement, args.NewValue as PermissionScope);
            }
        }
    }

    private static void AttachEventHandlers(UIElement element, PermissionScope scope)
    {
        if (element != null && scope != null)
        {
            element.AddHandler(CommandManager.PreviewCanExecuteEvent, new CanExecuteRoutedEventHandler(scope.CanExecutedHandler), true); // we need to see all events to subvert the built-in undo/redo tracking in the text boxes
        }
    }

    private static void RemoveEventHandlers(UIElement element, PermissionScope scope)
    {
        if (element != null && scope != null)
        {
            element.AddHandler(CommandManager.PreviewCanExecuteEvent, new CanExecuteRoutedEventHandler(scope.CanExecutedHandler));
        }
    }

    private void CanExecutedHandler(object sender, CanExecuteRoutedEventArgs e)
    {
        if (e.Command is CommandBase)
        {
            bool hasPermission = false;
            hasPermission = ((CommandBase)e.Command).HasPermission();

            ShowControl((UIElement)e.OriginalSource, hasPermission);
        }
    }

    public static void ShowControl(UIElement element, bool show)
    {
        element.Visibility = show ? Visibility.Visible : Visibility.Collapsed;
    }
} 
```

我真的一点帮助都没有。

最好的问候，迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-12T12:01:22.937

我发现了自己。这仅适用于 RoutedCommands 而不是 ICommand

# asp.net - 为 ASP.NET 应用程序选择足够的规范服务器

> ID：435108
> 
> 赞同：1
> 
> 时间：2009-01-12T11:04:10.667
> 
> 标签：asp.net, sql-server, performance, hardware

我正在开发一个即将推出的应用程序，并且可以就如何选择适当配置的服务器提供一些建议，以便一切运行良好。

该应用程序是 .NET 3.5，使用数据库的 SQL express 版本。我们目前有一台低规格服务器用作测试的暂存环境，它是具有 2GB 内存的 pentium 4。

虽然我不认为一旦上线就足够了，我显然想将数据库移动到它自己的盒子上，以升级到 SQL Server 的完整版本，从其他 2 个服务器对网站进行负载平衡，我m 还在研究使用 memcache 将一些经常使用的数据位保留在内存中。

该站点还使用输出缓存。

我们最初预计每天大约有 25,000 次页面浏览量。对于这里的一些人来说，分享他们已经启动的网站的设置，以及他们成功地满足了多少流量，这将是非常棒的。

谢谢和亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T12:48:56.977

如果您想知道什么是可能的和最佳实践，我建议您查看[High Scalability](http://highscalability.com/)网站。

一般来说（正如您所说），我会将数据库放在自己的服务器上作为第一步。除非你在网络服务器上做一些非常密集的事情，否则我会把钱花在数据库服务器上，因为恕我直言，它会产生更大的影响。

作为规范的最低要求，我认为 2+ gigs，带 SCSI 驱动器的双核（2.0+）应该是一个很好的起点......但这只是猜测，我不知道你的设置是什么样的以及多少微调你已经完成了。

[在您进行负载测试](http://support.microsoft.com/kb/231282)之前，很难确定您需要多少硬件。我建议对您当前的服务器进行负载测试以获得预期的页面浏览量，然后从那里拨打电话。

还有其他工具可以充分利用您的硬件，例如[Yslow](http://developer.yahoo.com/yslow/)和 MSSQL 2005 中的[数据库引擎优化顾问](http://msdn.microsoft.com/en-us/library/ms166575.aspx)。我相信您知道创建一些简单的索引可以让世界变得与众不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T11:33:08.517

每天 25,000 次页面浏览量约为每小时 1042 次，即每分钟 17 次。

您的服务器最初应该能够处理它（也许在新服务器上稍微增强 CPU/Ram，并将其保留为测试服务器以确保安全）。

如果你有钱花，我会从一个网络服务器和一个数据库服务器（完整版，不是特快版）开始。

如果负载增加，请添加更多前端网络服务器。

# sql - 什么会导致 Oracle ROWID 发生变化？

> ID：435109
> 
> 赞同：17
> 
> 时间：2009-01-12T11:04:32.350
> 
> 标签：sql, database, oracle, rowid

Oracle 中的 AFAIK ROWID 表示相应数据文件中记录的物理位置。在哪些情况下记录的 ROWID 可能会改变？

我知道的是分区表上的更新，它将记录“移动”到另一个分区。

还有其他情况吗？我们的大多数数据库都是 Oracle 10。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-12T11:12:05.517

正如您所说，只要行在磁盘上物理移动，就会发生这种情况，例如：

*   表的导出/导入
*   更改表 XXXX 移动
*   ALTER TABLE XXXX 缩小空间
*   闪回表 XXXX
*   拆分分区
*   更新值以使其移动到新分区
*   合并两个分区

如果在索引组织的表中，那么对主键的更新也会给你一个不同的 ROWID。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-12T11:27:37.607

+1 @WW

作为旁白：

索引组织表的 ROWID 是不同的（我相信它们被称为 UROWID），因为行的物理位置可能会在表更新期间发生变化（当树节点拆分或连接时）。

为了使索引仍然可行，UROWID 包括“逻辑 id”（主键）和“可能的物理 id”（常规 ROWID），后者可能已过期。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-12T14:14:10.550

WW的另一个+1，但只是为了增加一点......

如果驱动问题是您是否可以存储 ROWID 以供以后使用，我会说“不要这样做”。

您可以在事务中使用 ROWID - 例如收集一组 ROWID 以执行后续操作 - 但您*永远不*应该将 ROWID 存储在表中并假设它们以后可以使用日期。

# eclipse - 您认为良好的 Eclipse 支持是什么？

> ID：435110
> 
> 赞同：6
> 
> 时间：2009-01-12T11:05:32.067
> 
> 标签：eclipse, sysadmin

作为我工作的一部分，我受雇为公司的开发人员安装和支持开发工具。

Eclipse 是这里很多开发人员使用的 IDE，但我并不积极支持。随着插件种类繁多和新版本的快速发布 - 我发现很难掌握并且无法（显然）支持所有内容。

我在 Eclipse 方面确实有一些经验，但作为一名开发人员 - 您认为您的工作场所在 Eclipse 方面的良好支持是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T11:14:55.777

1.  私有的内部插件中心。您负责更新此 repo 并首先为当前开发的项目测试插件更新 - 因此开发人员无需担心兼容性；他们只会从内部插件仓库更新。
2.  常用设置，例如。定义和维护的编码风格格式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T11:17:15.397

团队范围的安装，带有一组标准插件。

允许用户安装新的，并建议将新的放入标准安装中，但他们应该知道这些不受支持。

您的主要开发人员还将了解这些插件的哪些配置将有助于整个团队 - 例如

*   SVN 设置，
*   Mylyn 集成
*   代码样式
*   检查样式设置
*   查找错误设置

安装和插件都可以预先准备好并作为一个大的 zip 文件分发，或者更灵活的方法是在内部运行您自己的更新站点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T12:02:47.927

我（除其他外）正是从事这项工作。

我想出了一个大的 zip 文件：

*   一个稳定的eclipse版本
*   开发人员认为有用的一些插件（Subclipse、QuickRex、Findbugs、具有通用设置的 Checkstyle，...）
*   三个JDK（！）：1.4、latest1.5、latest 6.0（用于启动eclipse）
*   一个带有别名的 shell（包括 'e' 来启动 eclipse）

用于启动 Eclipse 的脚本：

*   已仔细调整[eclipse.ini 设置](https://stackoverflow.com/questions/142357#144349)
*   检查我的工具/脚本/文件/插件的新版本是否已发布（在公共共享目录上），如果他们这样做，将它们复制到用户的桌面上。

这样，每当我验证一组新的稳定工具时，我的所有“开发配置”都会发展。

基本上，不需要安装/更新每个插件：只需定义您和您的同事每天实际使用的一组通用核心工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T10:19:45.140

对于一组标准插件并保持最新状态，我使用[Yoxos](http://ondemand.yoxos.com/geteclipse/start)配置了一个配置文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T11:15:15.963

在我的工作场所，Eclipse 是标准的开发工具，发布的项目可以使用 Eclipse 进行编译（当我们发现如果 Eclipse 尚未完成构建，Makefile 没有做任何事情时，我就在那里）。简单的解决方案是考虑开发人员的需求并为他们提供所需的基本环境。自定义插件可以由开发人员自己安装在主文件夹中，并带有“不支持”免责声明。只需安装您工作场所中大多数人需要的基本环境和最常用的插件。说： - 基本环境 JDT - 图形开发/网络开发/C++ 开发插件，或任何你需要的东西 - 一些 UML 插件，如果一个明显更好 - 一些分析器，如果你可以让它工作（我已经完成了分析） Netbeans、gprof，甚至 Oprofile，但我永远无法让它与 Eclipse 一起工作——无论如何，进行分析比在 Netbeans 中更复杂）。如果人们使用它。如果人们不这样做，则可能需要重新考虑某些事情，除非因为不需要而根本没有进行优化:-)。这是人们唯一需要支持的东西，恕我直言，其余的对我来说都是透明的。- 也许，在 Linux 上，我想要 gcj 编译版本的 Eclipse 的 RPM，如 Ubuntu 和 RedHat 提供的。除了我没有证据表明它更快，而我有证据表明 ecj（独立的 Eclipse Java 编译器）本身在使用 GCJ 时要慢得多（并且有很多原因表明这是正常的）！有些事情可能需要重新考虑，除非因为不需要而根本没有进行优化:-)。这是人们唯一需要支持的东西，恕我直言，其余的对我来说都是透明的。- 也许，在 Linux 上，我想要 gcj 编译版本的 Eclipse 的 RPM，如 Ubuntu 和 RedHat 提供的。除了我没有证据表明它更快，而我有证据表明 ecj（独立的 Eclipse Java 编译器）本身在使用 GCJ 时要慢得多（并且有很多原因表明这是正常的）！有些事情可能需要重新考虑，除非因为不需要而根本没有进行优化:-)。这是人们唯一需要支持的东西，恕我直言，其余的对我来说都是透明的。- 也许，在 Linux 上，我想要 gcj 编译版本的 Eclipse 的 RPM，如 Ubuntu 和 RedHat 提供的。除了我没有证据表明它更快，而我有证据表明 ecj（独立的 Eclipse Java 编译器）本身在使用 GCJ 时要慢得多（并且有很多原因表明这是正常的）！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T11:33:26.490

关于 Eclipse 的不同版本，只要坚持一个稳定的版本就可以了。在一年左右的时间里，按照 Marcin 的建议支持更新的版本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T09:51:55.913

就我个人而言，我想要一个在单个条目中包含“标准”插件的内部更新站点。这是因为可用的 Eclipse 版本种类繁多，没有人能提前满足熟练开发人员的需求。

带有内部更新站点和安装的“标准”插件以及定义的任何源存储库（以及仔细定义的步骤）的 zip 文件的通用分发将适合大多数开发人员，而不会给您带来太多负担。

# oracle - SQLLoader - DIRECT 模式中的错误“已停止，因为我无法继续”

> ID：435114
> 
> 赞同：1
> 
> 时间：2009-01-12T11:07:10.490
> 
> 标签：oracle, sql-loader

尝试使用 SQLLoader 将大型文本文件加载到 oracle db 时，我们收到以下错误：

```
SQL*Loader-926: OCI-Error; uldlfca:OCIDirPathColArrayLoadStream for table <myTabele>
SQL*Loader-2026: the load was aborted because SQL Loader cannot continue.
SQL*Loader-925: Error in uldlgs: OCIStmtExecute (ptc_hp) 
```

这只发生在 DIRECT 模式下，当我们使用传统的路径方法时，一切都很好（但速度慢很多）。所以我认为数据或控制文件的一般部分不会有问题。

虽然错误消息很有趣，但我该怎么做才能让一切正常工作？

版本：SQLLoader 9.2.0.1，数据库是 10.2.0.3.0（64 位）

**编辑** 经过更多尝试，似乎问题是由使用函数转换某些输入引起的。当我删除函数（表定义中的结果更改）时，一切似乎都工作正常。是否有可能在进行直接加载时无法使用函数？文档说从版本 9.x 开始它应该可以工作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T17:04:40.440

首先，如果人们可以开始指定他们遇到问题的产品的版本信息，那将是一个很大的帮助。

也就是说，我在 metalink 中发现了一个问题：

错误 3073503 - 如果第一个加载的行出现 ORA 错误，则直接路径加载会话失败并出现 OER:klapse_30

描述

```
Direct load via sqlldr may report errors and the server may 
fail with ORA-600 [klaprs_30] if the first loaded row fails 
with oracle error.

eg: After an ORA-1722 loader fails with:
     ORA-26095: unprocessed stream data exists 
     ORA-03113: end-of-file on communication channel 
     SQL*Loader-926: OCI error while uldlfca:OCIDirPathColArrayLoadStream for.. 
     SQL*Loader-2026: the load was aborted because SQL Loader cannot continue. 
     SQL*Loader-925: Error  while uldlgs: OCIStmtExecute (ptc_hp) 

    and the user session fails with ORA-600 [klaprs_30].

Workaround: 
  Use conventional load 
```

据称影响版本 >= 9.2 但 < 10.1.0.2

您可能希望在 SQL 加载程序错误时检查警报日志以查找 ORA-00600 错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T21:59:15.930

检查数据库警报日志。直接路径插入写入表的当前高水位线之上，因此当它厌倦为表分配更多扩展区时可能会出现问题。

# antlr - 如何解决 ANTLR 2 中数字和日期之间的词汇歧义？

> ID：435116
> 
> 赞同：0
> 
> 时间：2009-01-12T11:07:28.100
> 
> 标签：antlr

我的词法分析器中有两种标记类型，定义如下：

```
NUMBERVALUE
    :    ( '0' .. '9' )+ ( '.' ( '0' .. '9' )+ )?
    ;

DATEVALUE
    :    ( '0' .. '9' ) ( '0' .. '9' ) ( '0' .. '9' ) ( '0' .. '9' ) '-' 
         ( '0' .. '9' ) ( '0' .. '9' ) '-' 
         ( '0' .. '9' ) ( '0' .. '9' )
    |    ( '0' .. '9' ) ( '0' .. '9' ) '-' 
         ( '0' .. '9' ) ( '0' .. '9' ) '-' 
         ( '0' .. '9' ) ( '0' .. '9' )
         ; 
```

我会认为，由于日期*必须*在前五个字符内包含连字符，因此在词法分析器选项中设置 k=5 就足以让词法分析器始终将两者区分开来。但是，当我运行 antlr 时，我收到了这个警告：

```
warning:lexical nondeterminism between rules NUMBERVALUE and DATEVALUE upon
    k==1:'0'..'9'
    k==2:'0'..'9'
    k==3:'0'..'9'
    k==4:'0'..'9'
    k==5:'0'..'9' 
```

并且解析器无法识别超过四位数的数字。如何解决词汇歧义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T11:51:11.163

在我看来，由于[Linear 近似前瞻](http://www.antlr.org/doc/glossary.html#Linear_approximate_lookahead)，您会遇到虚假警告。*DATEVALUE的*第1、2、3、4、5 个字符都可以是数字，但不能同时是数字。

我会尝试摆脱 2/4 位数年份的替代方案。首先，您不想为 Y2.1K 错误负责；其次，它为您节省了另一种 DATEVALUE 语法。我尝试的另一个解决方案是使用不同的分组：

```
DATEVALUE
:    ( '0' .. '9' ) ( '0' .. '9' ) (( '0' .. '9' ) ( '0' .. '9' ))? '-' 
     ( '0' .. '9' ) ( '0' .. '9' ) '-' 
     ( '0' .. '9' ) ( '0' .. '9' )
     ; 
```

我认为它更具可读性，因为您不重复月/日部分。为了便于阅读，我会将可选部分放在首位，但我知道在这些情况下应避免从可选部分开始，因为这会使解析变得更加困难。

# gridview - 如何添加 Gridview 列值

> ID：435121
> 
> 赞同：0
> 
> 时间：2009-01-12T11:10:23.307
> 
> 标签：gridview

我在gridview中有三列，如下所示：

考勤内部总计

45（文本框） 5（文本框） 50（文本框） 95（文本框）

这里考试，出勤，内部是入口，

我希望 Total 在内部触发 Click 事件后使用 javascript 自动计算

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-12-22T15:59:13.737

decalre 变量总计，循环遍历行的每个单元格并添加到总计。随心所欲地做总

# sql-server - 在 ms sql server 上进行全文搜索时如何处理用户输入？

> ID：435129
> 
> 赞同：2
> 
> 时间：2009-01-12T11:14:01.567
> 
> 标签：sql-server, full-text-search, user-input

我在 ms sql server 上有一个简单的搜索机制，它使用全文“包含”。我将搜索值作为参数传递给包含谓词 - 直接来自用户的输入（通过 asp.net 网站）。问题是我在各种情况下都会遇到 sql 异常：-当用户输入两个单词时，例如“简单案例”-当用户将 qoute 添加到搜索值时，例如“test”时

我已经使用如下查询进行了测试：

```
declare @val nvarchar(40)
set @val = N'test"' -- or 'simple case'

select x.* FROM xx as x
where CONTAINS(x.[name], @val) 
```

通常我得到：“全文搜索条件'xxx'中'xxx'附近的语法错误。” 问题是我希望允许用户使用“*”、“或”和“和”条件进行高级查询。

你如何处理用户输入？你 qoutename 值吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T15:35:44.807

几年前我使用它构建了一个应用程序；我所做的是前端为您提供了一个文本框来输入您的条款，它有一个下拉菜单可以在以下几个选项之间进行选择：

```
<option selected value="AND">All of the words entered</option>
<option value="OR">Any of the words entered</option>
<option value="ALL">The exact phrase entered</option> 
```

所以我不希望他们输入 ands 或 ors - 我为他们这样做。我确实让他们引用一个副词。

下面是一些完成此操作的代码。生成的短语作为参数发送到过程；正如上面提到的评论者所说，您确实必须这样做以防止 SQL 注入。不幸的是，这段代码是遗留的 ASP VBScript，甚至没有按照该语言的标准编写，但也许这给了你一个想法。

```
 function formatContainsString (sCriteria, sANDorOR)
    dim sReturnBuf 'where we build our string
    dim sWordList 'sCriteria split
    dim lCurPos      'where we are at in sWordList
    dim bInnerQuotes ' an open quote was found
    if sCriteria = "" or sANDorOR = "" then
        formatContainsString = ""
        exit function
    end if

    ' If the passed parameter is 'ALL' then use the exact phrase typed by users
    if sANDorOR = "ALL"  then
        formatContainsString = "'"  & chr(34) & sCriteria  & chr(34) & "'"
        Exit Function
    End If

    sReturnBuf = "'"
    sWordList = split(sCriteria," ")
    for lCurPos = 0 to ubound(sWordList)
        if bInnerQuotes then 'want to pass this as a single phrase
            sReturnBuf = sReturnBuf & " " & sWordList(lCurPos)
            if right(sWordList(lCurPos),1) = chr(34) then
               sReturnBuf = left(sReturnBuf,len(sReturnBuf)-1) & "*" & chr(34)
                sReturnBuf = sReturnBuf & " " & sANDorOR & " "'phrase is over
                bInnerQuotes = False
            end if
        else        
            if left(sWordList(lCurPos),1) = chr(34) then 
                sReturnBuf = sReturnBuf & sWordList(lCurPos)
                bInnerQuotes = True
            else
                sReturnBuf = sReturnBuf & chr(34) & sWordList(lCurPos) & "*" & _ 
                    chr(34) & " " & sANDorOR & " "'quote the word
            end if
        end if
    next
    'finally, remove the last AND or OR... and append the tick
    formatContainsString = left(sReturnBuf,len(sReturnBuf)-(len(sANDorOR)+1)) _ 
        & "'"

end function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T01:20:52.040

在我们的应用程序中，我们使用自己的简单查询语言进行用户输入：仅操作数（带有可选通配符的单词或短语）、运算符（AND、OR、NOT）和括号。

我们解析用户输入，将其分解为组成部分并检查语法等。

如果我们很高兴输入有效，我们将其重建为等效`CONTAINS`条件并将其作为参数发送到我们的搜索存储过程。因为我们自己创建条件，所以我们*知道*它在语法上是正确的。

如果用户输入无效，那么我们可以向用户返回有意义的错误消息，而根本不需要连接到数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T11:20:26.280

根据您遇到的错误，我会说您没有使用查询参数。这是非常危险的，并且允许您的用户执行 sql 注入。

现在，至于您的问题，我认为最好的选择是为您设置 2 种文本输入类型，一种用于普通用户，另一种用于高级用户，这样您就可以知道在哪里解析高级查询。

# oscommerce - 将多个项目批量添加到 osCommerce 网站？

> ID：435133
> 
> 赞同：2
> 
> 时间：2009-01-12T11:15:58.990
> 
> 标签：oscommerce

我需要向 osCommerce 添加数百种产品（呃，我知道，这不是我的选择）但是 osCommerce 没有内置方法（或者至少我找不到），有人知道吗在哪里可以找到关于 osCommerce 如何存储产品的一些（甚至是一半体面的）文档（因为它肯定不是以任何合乎逻辑的方式）？或者可能有一些 **免费的**插件/软件可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T09:21:26.543

使用过[Easy Populate](http://www.oscommerce.com/community/contributions,500)之类的东西，但发现其中的属性部分不能满足项目的需求。破解了一些代码以允许根据客户端规范进行修复。

如果您要导入没有属性的批处理原始数据，并且只想将它们放入商店的基本类别中，则只需使用三个表即可：

*   **产品**- 处理价格和图像

*   **products_description** - 处理名称以及制造商的描述和设置。

*   **products_to_categories** - 排序产品将被放置在商店的哪个类别下。就这张表的工作而言，**0**应该是商店的基本文件夹类别。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-24T02:01:39.450

我使用 phpMyAdmin 插入以前商店的商品。

首先，我必须使用 iconv 进行一些转换为 utf-8，这可能不需要，然后我使用了这些 sql 语句：

```
insert into products_description (
SELECT art_id as products_id, 4 as language_id, naziv as products_name, CONCAT(dolgOpis, '<br /><br />', kratekOpis) as products_description, NULL AS products_url, 0 AS products_viewed from artikel_utf;
); 
```

4 在我的安装中用于英语 - 检查表语言。对于您拥有的每种语言，您必须为每种产品插入一次，并为 language_id 提供相应的编号

那么您需要将您插入的每个产品插入一个类别。我把它们都放在基类中：

```
insert into `products_to_categories` (SELECT products_id, 0 FROM products); 
```

我不确定我是否也填写了制造商和产品描述表。如果您发现必须这样做，您还应该在产品表中为每个产品设置manufacturer_id。products_description 表还需要您使用的每种语言的条目

# php - 我如何使用 PHP 来显示没有秒的日期时间

> ID：435135
> 
> 赞同：0
> 
> 时间：2009-01-12T11:16:48.300
> 
> 标签：php, sql, datetime

我该如何改变前任。2009-01-14 06:38:18 到 2009-01-14 06:38？列类型是`DATETIME`。我不想用`SELECT DATE_FORMAT`

我怎么能用 PHP 做到这一点？ `date("M-d-Y H:i", $userow['regdate'])`给出：

```
Strict Standards: date() [function.date]: It is not safe to rely on the system's timezone settings. Please use the date.timezone setting, the TZ environment variable or the date_default_timezone_set() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T11:19:28.763

正如您的错误所说，之前使用[date_default_timezone_set() 。](http://de3.php.net/manual/en/function.date-default-timezone-set.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T15:07:50.863

错误消息只是建议您指定您的时区，以便最终为您的目标受众打印正确的日期。除此之外， date() 需要一个时间戳作为它的第二个参数，所以这就是为什么使用 strtotime() 将 MySQL 返回的字符串转换为 int 肯定会有所帮助。

# c# - c# - 为动态创建的控件分配方法

> ID：435138
> 
> 赞同：1
> 
> 时间：2009-01-12T11:17:53.103
> 
> 标签：c#, events, plugins, delegates, add-in

我正在设计一个支持插件开发的应用程序。它更多的是一种学习练习。

加载到我的应用程序中的所有程序集（插件）都包含一个 showPrefs() 方法。当我加载每个程序集时，我想为每个程序集分配一个按钮，以便当我单击该按钮时，它会触发该按钮分配到的程序集的 showPrefs() 方法。

我该怎么做呢？一个快速而肮脏的解决方案是将 showPrefs() 方法签名更改为 showPrefs(object sender, EventArgs e)。这样我可以将它分配给按钮，但我认为这是一个便宜的解决方法。

有任何想法吗？

* * *

click 事件处理程序只接受具有 (object o, EventArgs e) 方法签名的委托，所以我不知道如何将 showPrefs() 方法分配给 click 事件。

这就是我遇到的麻烦。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T11:28:25.563

我认为你需要澄清你在说什么，因为你所问的比首先加载程序集要简单得多。

完成程序集加载后，您将获得一个实现接口的类型列表。只需迭代，为每个按钮创建按钮，然后在按钮的单击事件处理程序中运行您的 showPrefs 方法。

这是一些 c# 伪代码：

```
Button b;
foreach(var i in instancesThatHavePrefsMethods)
{
  b = new Button();
  b.Click += (o,e) => { i.showPrefs(); };
  this.Children.Add(b);
} 
```

一旦我有了这些类型，我就可以实例化其中的一个，并保留它们。然后我需要做的就是为每个按钮创建一个按钮，添加一个事件处理程序（由伪代码中的 lambda 创建的外壳保存对正确实例的引用；您也可以创建自己的类来执行此操作或授权一个事件处理程序在您的界面中），然后将按钮添加到您的表单中。

* * *

根据您的说明，有几种不同的方法可以做到这一点。

首先，因此在您的界面上授权一个事件处理程序：

```
public interface IPluginKLol
{
  //snip

  ///<summary>An event handler, when fired, calls <seealso cref="showPerfs"/></summary>
  void ShowPerfsEventHandler(object o, EventArgs e);

  //snip again
} 
```

进而

```
Button b;
IEnumerable<IPluginKLol> instancesThatHavePrefsMethods = GetPlugins();
foreach(var i in instancesThatHavePrefsMethods)
{
  b = new Button();
  b.Click += i.ShowPerfsEventHandler;
  this.Children.Add(b);
} 
```

或者，您可以创建一个类来将事件转换为调用 showPerfs（只需实例化、设置引用并分配事件处理程序）：

```
public class ShowPerfsBroker
{
  public IPluginKLol Victim {get;set;}

  public void ShowPerfsEventHandler(object o, EventArgs e)
  {
    if(Victim == null) return;
    Victim.ShowPerfs();
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T11:47:47.740

如果您查看 Will 的伪代码，他会为 Click 处理程序分配一个 lambda 表达式，如下所示：

```
b.Click += (o,e) => { i.showPrefs(); }; 
```

这是一个任意的方法，接受一个对象和 EventArgs。然后它会在界面上调用您的 showPrefs 函数。它大致等于以下内容：

```
b.Click += delegate(Object o, EventArgs e) { i.showPrefs(); }; 
```

如果您使用的是 c# 2.0，这可能会很有用。

# assembly - x86 最快的虚拟机设计是什么？

> ID：435141
> 
> 赞同：4
> 
> 时间：2009-01-12T11:19:01.010
> 
> 标签：assembly, x86, vm-implementation

我将在 x86 中实现一个虚拟机，我想知道什么样的设计会产生最好的结果。我应该专注于什么来挤出果汁？我将在 x86 程序集中实现整个虚拟机。

我没有太多说明，我可以选择它们的形式。这些指令以块的形式直接投射到 smalltalk 的语法中。我给出了我正在考虑的指令设计：

```
^ ...       # return
^null     # return nothing
object    # address to object
... selector: ... # message pass (in this case arity:1 selector: #selector:)
var := ... # set
var # get 
```

我正在考虑的那种虚拟机：

```
mov eax, [esi]
add esi, 2
mov ecx, eax
and eax, 0xff
and ecx, 0xff00 # *256
shr ecx, 5          # *8
jmp [ecx*4 + operations]
align 8:
    operations:
dd retnull
dd ret
# so on...
    retnull:          # jumps here at retnul
# ... retnull action
    ret:
# ... ret action
#etc. 
```

不要开始问我为什么需要另一个虚拟机实现。解释性程序不是您在需要时才拿起的库存东西。您在其他地方提出的大多数虚拟机都以性能成本为重，注重可移植性。我的目标不是可移植性，我的目标是性能。

之所以需要这个解释器，是因为 smalltalk 块最终不会以同样的方式被解释：

```
A := B subclass: [
    def a:x [^ x*x]
    clmet b [...]
    def c [...]
    def d [...]
]

[ 2 < x ] whileTrue: [...]

(i isNeat) ifTrue: [...] ifFalse: [...]

List fromBlock: [
    "carrots"
    "apples"
    "oranges" toUpper
] 
```

我需要来自解释例程的真正好处，那就是选择在哪里读取程序的上下文。当然，好的编译器应该在大多数情况下编译明显的情况，例如：'ifTrue:ifFalse' 或 'whileTrue: '，或列表示例。对口译员的需求不仅会消失，因为您总是可能遇到无法确定该块得到您期望的治疗的情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T14:19:29.603

我看到这里对可移植性有些困惑，所以我觉得有必要澄清一些问题。这些是我的拙见，因此您当然可以自由反对它们。

如果您认真考虑编写 VM，我假设您遇到过[http://www.complang.tuwien.ac.at/forth/threading/](http://www.complang.tuwien.ac.at/forth/threading/)，所以我不会详述所描述的技术。

已经提到，以 VM 为目标具有一些优点，例如减少代码大小、降低编译器复杂性（通常转化为更快的编译）、可移植性（请注意，VM 的重点是*语言*的可移植性，因此 VM本身不可移植）。

考虑到您的示例的动态特性，您的 VM将比其他更流行的编译器更类似于*JIT 编译器。*因此，尽管 S.Lott 在这种情况下没有抓住重点，但他对 Forth 的提及却非常当场。如果我要为一种非常动态的语言设计一个 VM，我会将解释分为两个阶段；

1.  生产者阶段根据需要咨询 AST 流并将其转换为更有意义的形式（例如，获取一个块，决定它是应该立即执行还是存储在某个地方以供以后执行）可能会引入新类型的令牌。本质上，您恢复了在此处解析时可能丢失的上下文敏感信息。

2.  消费者阶段从 1 获取生成的流并像任何其他机器一样盲目地执行它。如果你让它像 Forth 一样，你可以只推送一个存储的流并完成它，而不是跳转指令指针。

正如您所说，仅以另一种方式模仿该死的处理器的工作方式并不能实现您需要的任何动态性（或任何其他值得该死的功能，例如安全性）。否则，您将编写一个编译器。

当然，您可以在阶段 1 中添加任意复杂的优化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T12:20:31.153

如果您想要真正快速的东西，请尝试使用[LLVM](http://llvm.org/)。它可以根据高级程序描述为大多数处理器生成本机代码。您可以使用自己的汇编语言或生成 llvm 结构跳过汇编阶段，这取决于您认为最方便的方式。

我不确定它是否最适合您的问题，但如果我对无法用程序的其余部分编译的代码执行一些性能关键的执行，它绝对是我会使用的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T11:22:58.383

大多数时候，解释器的重点**是可移植性。**我能想到的最快方法是直接在内存中生成 x86 代码，就像 JIT 编译器所做的那样，但是，当然，你不再有解释器了。你有一个编译器。

但是，我不确定在汇编程序中编写解释器会给您带来最佳性能（除非您是汇编程序专家并且您的项目范围非常有限）。使用高级语言可以帮助您专注于更好的算法，例如符号查找和寄存器分配策略。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-20T13:21:12.987

您可以使用未编码的指令集加速您的调度例程：

```
mov eax, [esi]
add esi, 4
add eax, pOpcodeTable
jmp eax 
```

对于 cpu 的 > Pentium 4 上的每个调度，它应该有一个开销 < 4 个周期。

此外，出于性能原因，最好在每个原始例程中递增 ESI (IP)，因为递增可以与其他指令配对的可能性很高：

```
mov eax, [esi]
add eax, pOpcodeTable
jmp eax 
```

〜1-2个循环开销。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T11:35:45.813

我不得不问，为什么要创建一个注重性能的虚拟机？为什么不直接写 x86 代码呢？没有什么比这更快了。

如果您想要一种*非常*快速的解释语言，请查看[Forth](http://www.forth.org/)。他们的设计非常整洁，很容易复制。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T12:21:09.967

如果您不喜欢 JIT 并且您的目标不是可移植性。我想你可能会对 Google [NativeClient](http://code.google.com/p/nativeclient)项目感兴趣。他们做静态分析、沙盒和其他。它们允许主机执行 RAW x86 指令。

# delphi - 打印时出现“不支持操作”和“所选打印机无效”错误

> ID：435144
> 
> 赞同：11
> 
> 时间：2009-01-12T11:20:29.400
> 
> 标签：delphi, printing

希望有人能够提供帮助。在我的 Delphi 7 应用程序中，一小部分用户在打印时报告错误，我正试图用最后一个解决这个问题。在测试方面我受到了一些限制（因为用户在物理上很遥远，我们正在通过电子邮件解决它），但我从 EurekaLog 获得了一些额外的信息。

无论如何，他得到的第一个错误是**“所选打印机不支持操作”**，在这行代码：

```
Printer.Orientation := AOrientation; 
```

因此，我假设他的打印机不支持 Orientation（我从未听说过，但我想这是可能的）并尝试不使用这行代码。但现在他在这一行得到**“选择的打印机无效” ：**

```
Result := Printer.PageWidth / GetDeviceCaps(Printer.Handle, LOGPIXELSX); 
```

据我所知，打印机选择正确（它是Canon Pixma iP1500，但其他用户有其他型号，喷墨或激光），他已经尝试更新驱动程序。操作系统也有所不同 - 从 XP 到 Vista SP1）。

我建议他尝试使用另一台打印机，但无论他如何回应，我都不知道下一步该往哪里看。谷歌搜索没有给出任何有用的结果（至少对我来说）。有人有想法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T16:28:44.333

不是解决方案，而是减少错误表面的提示：在该系统上安装（或让用户安装）虚拟打印机并尝试打印到该系统。[优秀的PDFCreator](http://sourceforge.net/projects/pdfcreator/)附带了一个免费的（无论是在啤酒中还是在自由中）虚拟 PDF 打印机。它绝对支持页面方向。这将为您提供一个已知的良好基准来进行测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T12:20:47.453

不是直接的解决方案，但它可能有助于解决问题。遇到此类问题，我做的第一件事是从客户那里获得确切的驱动程序版本，然后使用 LPT1 下载驱动程序并将其安装到我的 PC 上。然后我可以对其进行打印以进行测试，并解决驱动程序的任何问题。显然我实际上无法打印，但这通常不是问题。使用虚拟机也有很大帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T11:45:12.050

你说一小部分用户报告了问题。你知道这些和其他用户有什么区别吗？

在想：

*   二手打印机
*   打印机驱动程序（版本）
*   使用的操作系统，包括补丁和更新（不要忘记 IE 更新）
*   您的软件版本
*   其他安装的软件

用户是否有其他应用程序的打印问题？

如果你能重现这个问题，那将是一个很大的帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T14:50:23.643

我有一个客户的问题听起来相同（或至少相似）。我们得到“所选打印机无效”消息的代码行略有不同（在快速报告库中），但它类似地调用`GetDeviceCaps`.

虽然我们还没有找到真正的解决方案，但我们已经找到了一种解决方法。*如果用户在尝试打印报告之前*访问“打印机设置”对话框，则不会出现错误。

您是否看过我在 Google 的帮助下找到的这些网站：

[http://www.delphipages.com/threads/thread.cfm?ID=19871&G=19828](http://www.delphipages.com/threads/thread.cfm?ID=19871&G=19828)

[http://www.contactplus.com/cfaq/index.php?qid=381&catid=4](http://www.contactplus.com/cfaq/index.php?qid=381&catid=4)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-08T16:12:48.877

我曾让用户报告同样的错误，但仅在 Windows Vista 上。Windows XP 和 7 似乎没有同样的问题。我发现在 Windows Vista 计算机上关闭 UAC 将消除此问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-23T19:40:03.597

这对我有用。我在尝试获取打印机手柄之前使用它。

```
procedure InvalidatePrinter;
var
  dev,
  driv,
  port: array[0..80] of Char;
  deviceMode: THandle;
begin
  Printer.GetPrinter(dev, driv, port, deviceMode);
  Printer.SetPrinter(dev, driv, port, 0)
end; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-09-10T12:31:48.343

您得到的错误指向 SetDefaultPrinter 或打印机枚举失败的方向。SetDefaultPrinter 在 Delphi 7 中看起来有点吓人。例如，它尝试从注册表中读取默认打印机。它在较新的 Delphi 版本中变得更好，但我仍然在每个新版本中修补 Printers.pas。

这是我的 Delphi 2009 补丁。您可能需要对 Delphi 7 进行一些调整，但这应该会给您一个想法。原始功能所剩无几。

```
{$IFDEF UNICODE}
function GetDefaultPrinter(DefaultPrinter: PChar; var I: Integer): BOOL; stdcall;
  external winspl name 'GetDefaultPrinterW';
{$ELSE}
function GetDefaultPrinter(DefaultPrinter: PChar; var I: Integer): BOOL; stdcall;
  external winspl name 'GetDefaultPrinterA';
{$ENDIF}

procedure TPrinter.SetToDefaultPrinter; //@@@ SZ
var
  I: Integer;
  Err: DWORD;
  Device: PChar;
begin
  I := 0;
  if not GetDefaultPrinter(nil, I) then       //  (this should return false because the buffer is too small)
  begin
    Err := GetLastError;
    if (Err = ERROR_FILE_NOT_FOUND) or (I = 0) then
       RaiseError(SNoDefaultPrinter)
    else if Err = ERROR_INSUFFICIENT_BUFFER then
    begin
      Device := StrAlloc(I);
      try
        if GetDefaultPrinter(Device, I) then
        with Printers do
          for I := 0 to Count-1 do
          begin
            if AnsiSameText(TPrinterDevice(Objects[I]).Device, Device) then
            begin
              with TPrinterDevice(Objects[I]) do
                SetPrinter(PChar(Device), PChar(Driver), PChar(Port), 0);
              Exit;
            end;
          end
        else
          RaiseLastOSError;
      finally
        StrDispose(Device);
      end;
    end
    else
      RaiseLastOSError;
  end;
  RaiseError(SNoDefaultPrinter);
end; 
```

如果这不起作用，那么下一步将检查打印机枚举失败的原因。查看 TPrinterDevice 列表的“Device”、“Driver”、“Port”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-12T15:57:31.943

这纯粹是轶事，但它可能是相关的。

我刚刚在 Delphi 5 应用程序中查找了“选定的打印机无效”错误消息。

该软件正在创建虚拟打印机以生成 .pdf 文件。我发现“旧”打印机是由它的索引存储的，这是在 pdf 操作完成后返回它的一种不可靠的方法。

通过更改逻辑以便按名称恢复旧打印机，我相信我能够解决我的问题。（我们过几天去测试）

* * *

顺便说一句 - QuickReports 参与其中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-09-12T15:28:46.130

[http://zpay.com/vbulletin/showthread.php?2310-Printer-selected-is-not-valid](http://zpay.com/vbulletin/showthread.php?2310-Printer-selected-is-not-valid) , [http://support.quickbooks.intuit.com/support/articles/SLN40193](http://support.quickbooks.intuit.com/support/articles/SLN40193)和[Delphi Win32 Service "Printer Selected无效”2008 64 位标准服务器上的错误](https://stackoverflow.com/questions/4618833/delphi-win32-service-printer-selected-is-not-valid-error-on-2008-64bit-standar)列表可能的原因。

简而言之，它们都是配置问题，即您的程序无论出于何种原因都无法访问打印机。

我猜Delphi会在您访问相关属性时尝试按需打开打印机，并且由于框架因此而臭名昭著，因此隐藏了真正的错误。

我建议您尝试尽可能明确地打开打印机（例如，使用[`OpenPrinter`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162751%28v=vs.85%29.aspx)，然后尝试 smth like [`GetPrinterDataEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd144913%28v=vs.85%29.aspx)），以便您收到一些错误消息，尽可能具体地提示究竟出了什么问题。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-01-13T09:21:58.733

您可能需要调整delphi 的printer.pas - 至少在较旧的delphi 版本中，打印机实现中存在一些错误，例如，如果网络打印机UNC 名称太长，delphi 可能会崩溃。

# c++ - 在 C/C++ 中将 UTF-8 字符串存储在内存中的最佳方法是什么？

> ID：435147
> 
> 赞同：10
> 
> 时间：2009-01-12T11:22:53.750
> 
> 标签：c++, unicode

查看[unicode 标准](http://www.unicode.org/versions/Unicode5.0.0/ch05.pdf#G23927)，他们建议使用 plain `char`s 来存储 UTF-8 编码的字符串。这对 C++ 和 basic 是否按预期工作`std::string`，或者是否存在 UTF-8 编码会产生问题的情况？

例如，在计算长度时，它可能与字节数不同 - 这应该如何处理？阅读标准，我可能很好地使用`char`数组进行存储，但我仍然需要自己编写诸如`strlen`等之类的函数，这些函数适用于编码文本，因为据我了解问题，标准例程是仅 ASCII，或期望 unicode 标准不推荐的宽文字（16 位或更多）。到目前为止，我发现的关于编码的最佳来源是[Joel 在 Software](http://www.joelonsoftware.com/articles/Unicode.html)上的一篇文章，但它并没有解释我们可怜的 C++ 开发人员应该使用什么:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T11:40:47.207

有一个名为“ [UTF8-CPP](http://utfcpp.sourceforge.net/) ”的库，它允许您将 UTF-8 字符串存储在标准 std::string 对象中，并提供额外的函数来枚举和操作 utf-8 字符。

我还没有测试它，所以我不知道它的价值，但我正在考虑自己使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T12:17:21.253

strlen 计算第一个 \0 之前的非空字符数。在 UTF-8 中，该计数是一个合理的数字（使用的字节数），但计数不是字符数（一个 UTF-8 字符通常是 1-4 个字符）。basic_string 不存储 \0，但它也保留字节数。

strcpy 或 basic_string 复制 ctor 复制所有字节，无需仔细查看。

由于 UTF_8 的编码方式，查找子字符串可以正常工作。字符第一个字节的允许值与第二个到第四个字节不同（前者从不以 10xxxxxx 开头，后者总是）

获取子字符串很棘手 - 你如何指定位置？如果通过搜索 ASCII 文本标记（例如 [ 和 ]）找到了开始和结束，则没有问题。您只会得到中间的字节，它们也是有效的 UTF8 字符串。但是，您不能对位置进行硬编码，甚至不能对相对偏移进行编码。即使是 +1 字符的相对偏移量也很难；那是多少字节？您最终将编写一个类似于 SkipOneChar 的函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T15:00:07.600

[ICU 库](http://icu-project.org/)（C、C++、Java）的示例：

```
#include <iostream>
#include <unicode/unistr.h> // using ICU library

int main(int argc, char *argv[]) {
    // constructing a Unicode string
    UnicodeString ustr1("Привет"); // using platform's default codepage
    // calculating the length in characters, should be 6
    int ulen1=ustr1.length();
    // extracting encoded characters from a string
    int const bufsize=25;
    char encoded[bufsize];
    ustr1.extract(0,ulen1,encoded,bufsize,"UTF-8"); // forced UTF-8 encoding
    // printing the result
    std::cout << "Length of " << encoded << " is " << ulen1 << "\n";
    return 0;
} 
```

像建筑一样

```
$ g++ -licuuc -o icu-example{,.cc} 
```

跑步

```
$ ./icu-example
Length of Привет is 6 
```

在带有 GCC 4.3.2 和 libicu 3.8.1 的 Linux 上为我工作。请注意，无论系统语言环境是什么，它都以 UTF-8 打印。如果您的不是 UTF-8，您将无法正确看到它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T12:11:06.023

这取决于你想用 UTF8 字符串做什么。如果您感兴趣的只是读入和读出 UTF8 字符串，那么只要您设置了正确的语言环境，它就可以正常工作。我们已经这样做了一段时间。我们有几个服务器进程对字符串不做任何事情。字符串由用户在 Java 中设置并以 UTF8 格式到达，我们在标准 c str 缓冲区中处理它们。然后，我们将数据发送回 Java，Java 将其转换回来。

如果您想要 UTF8 字符的长度，那么您需要可以为您处理翻译的函数。

但是您可以自己滚动，例如[utf8-strlen](http://www.daemonology.net/blog/2008-06-05-faster-utf8-strlen.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T12:09:33.810

我们解决的问题是：将 UTF8 存储在 std::string 中。您现在可以执行大多数操作，除了计算长度之类的操作。当您需要此类操作时，使用 UTF8->std::wstring 转换函数（例如 boost::from_utf8）转换为 std::wstring。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T11:30:52.173

来自[UTF-8 和 Unicode 常见问题解答：C 对 Unicode 的支持](http://www.cl.cam.ac.uk/~mgk25/unicode.html#c)：

```
#include <stdio.h>
#include <locale.h>

int main()
{
  if (!setlocale(LC_CTYPE, "")) {
    fprintf(stderr, "Can't set the specified locale! "
            "Check LANG, LC_CTYPE, LC_ALL.\n");
    return 1;
  }
  printf("%ls\n", L"Schöne Grüße");
  return 0;
} 
```

也从[这里](http://evanjones.ca/unicode-in-c.html)：

> 好消息是，如果您使用 `wchar_t*`字符串以及与它们相关的一系列函数，例如 `wprintf`、`wcslen`和`wcslcat`，那么您正在处理 Unicode 值。在 C++ 世界中，您可以使用它`std::wstring`来提供友好的界面。我唯一的抱怨是这些是 32 位（4 字节）字符，所以它们是所有语言的内存猪。这种选择的原因是它保证每个可能的字符都可以用一个值表示。

PS。这可能是特定于 Linux 的。有一个 ICU 库来处理复杂的事情。

# c++ - C++ 链接器错误

> ID：435161
> 
> 赞同：0
> 
> 时间：2009-01-12T11:30:03.750
> 
> 标签：c++, visual-studio, linker

我有一个这样的函数，它不在一个类中：

```
// Gets the maximum number of tracks displayable
const utils::uint32 GetConstMaxSystemRange()
{
    return constMaxSystemNumber - constMinSystemNumber + 1;
} 
```

它在 VS2005 中编译得很好，但是在第一个包含它的文件之后，我得到了每个文件的链接器错误，即使我使用的是 Compile Guards。凭直觉，我用这样的课程包围了它：

```
class CDSLimitsAccess
{
public:
    // Gets the maximum number of tracks displayable
    static const utils::uint32 GetConstMaxSystemRange()
    {
        return constMaxSystemNumber - constMinSystemNumber + 1;
    }

protected:
    CDSLimitsAccess(){}
}; 
```

砰！固定的。

**问题：为什么？**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-12T11:34:18.033

包含守卫仅保护该函数不被包含到同一个翻译单元中两次。但它不会保护该函数不被两次包含到整个程序中。

由于该函数是非内联的，如果它在整个程序中出现不止一次，它就违反了单一定义规则。使其内联以解决问题，或将定义放入实现文件中，仅将其声明放在标题中。

```
// Gets the maximum number of tracks displayable. possible fix:
inline utils::uint32 GetConstMaxSystemRange() {
    return constMaxSystemNumber - constMinSystemNumber + 1;
} 
```

附带说明 - 最好不要将 const 放在内置返回值上。它们的临时变量不能用 const / volatile 限定。但这也不是必需的：无论如何您都不能修改它们。据我所知，它被忽略了。但它永远不会有效果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T11:36:39.603

因为如果它是一个自由浮动函数，在每个包含时，它都会被编译成 .obj 文件，并且在链接时，会有重复。

对于类成员，有一个不同的策略，它允许重复 - 稍后由链接器正确处理。

你可以把它放到一个未命名的命名空间中，或者在它之前添加一个静态，这样它就会成为翻译单元的本地。但是，这不是修复它的正确方法 - 只需在标头中包含声明，然后将实现放入文件中，就可以了。

# macos - 如何在不先启动 MacOS X App 的情况下将文件类型与 MacOS X App 相关联？

> ID：435175
> 
> 赞同：8
> 
> 时间：2009-01-12T11:33:14.447
> 
> 标签：macos, installation, file-association, info.plist

我想将**上次安装**的 Mac OS X 应用程序版本与某种类型的文件相关联。一个小实验表明**info.plist**文件似乎在启动应用程序时被操作系统读取和解释，而不是在将应用程序包拖到磁盘时。[Apple 关于运行时配置的文档](http://developer.apple.com/DOCUMENTATION/MacOSX/Conceptual/BPRuntimeConfig/BPRuntimeConfig.html#//apple_ref/doc/uid/10000170)并没有对此主题进行太多说明。

有什么方法可以使用简单的`.dmg`映像作为安装介质来确保系统将该特定文件类型与我新安装的应用程序相关联，**而无需先启动它**？

我应该澄清一下，我希望在安装过程中自动完成（我不希望我的用户必须自己做）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-12T14:55:11.557

当用户将应用程序拖入 Applications 文件夹时，系统应自动将其注册到 Launch Services。请参阅启动服务指南中的[应用程序注册](http://developer.apple.com/library/mac/#documentation/Carbon/Conceptual/LaunchServicesConcepts/LSCConcepts/LSCConcepts.html#//apple_ref/doc/uid/TP30000999-CH202-TP9)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-07T17:04:45.530

尽管 Tony 的信息是正确的——[这里](https://stackoverflow.com/questions/2969987)也有解释——（拖动`MyApp.app`to`Applications`将使用来自 xml 文件和设置文件关联的信息自动注册到 Launch Services `Info.plist`），但它并没有完全回答有关文件关联的问题。

如果人们遵循这些说明，他们将打开他们的应用程序，但不会打开特定文件。

> [...] 确保系统将该**特定文件类型**与我新安装的应用程序相关联

与其他平台相比，Mac 上的文件关联略有不同。大多数平台，当`*.foo`用 注册时`myapp`，当`MyFile.foo`被双击时，它会按照以下方式调度一些东西：

```
/path/to/myapp MyFile.foo 
```

尽管您可以在 Mac 上的命令行上成功使用此技术，但它根本**无法通过 Finder 工作**，也无法通过双击桌面上的关联文件来工作。

在这里问和回答：

[https://stackoverflow.com/a/19702342/3196753](https://stackoverflow.com/a/19702342/3196753)

有人声称这种方法优于保守的文档打开文件处理，`main()`因为它“只打开应用程序的一个实例”。不管这个决定背后的原因是什么，从 C++ 的角度来看，它使事情变得更加复杂。

*   [此处](https://developer.apple.com/legacy/library/documentation/AppleScript/Conceptual/AppleEvents/AppleEvents.pdf)提供的 108 页 PDF （警告，这被标记为“旧版”，可能会发生 linkrot）。
*   [此处](https://developer.apple.com/library/mac/documentation/DataManagement/Conceptual/DocBasedAppProgrammingGuideForOSX/ApplicationCreationProcess/ApplicationCreationProcess.html)提供了来自苹果开发者门户的相关文档。
*   Qt 的方法[在此处](https://doc.qt.io/archives/qq/qq12-mac-events.html)记录。

来自 qt.io：

> 当用户在 Finder 中双击文件时，Finder 会向与该文件关联的应用程序发送一个 Apple 事件并要求它打开该文件。如果应用程序未运行，则启动它，然后发出请求。这种方法的优点是只有一个应用程序实例在运行。
> 
> 在 Windows 上，这通常通过启动应用程序并将文件名作为命令行参数传递来完成。查看许多文件会导致启动同一应用程序的许多实例。（作为 Qt 解决方案提供的 QtSingleApplication 组件解决了这个问题。）
> 
> Qt 3 没有提供处理 Apple 事件的抽象，但使用 Mac 的 Carbon API 在应用程序中添加对它们的支持很简单。假设我们有一个名为 XpmViewer 的应用程序，它显示 XPM 文件（一种 X11 图像格式）。主窗口类声明如下：[删除代码片段]

```
(BOOL)application:(NSApplication *)theApplication
       openFile:(NSString *)filename 
```

[在 C++ main() 执行](https://stackoverflow.com/questions/29670692) [AEInstallEventHandler 处理程序在启动时未调用之前处理 Mac OS X 文件打开事件](https://stackoverflow.com/questions/8265487)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T14:58:29.727

您可以通过在要关联应用程序的文件上键入 apple-I 来做到这一点，使用名为“打开方式...”的小框并选择您的应用程序。您可以选中“全部更改...”下方的小框以对所有类似文件进行更改。

# c# - C#：自定义排序的 DataGridView

> ID：435177
> 
> 赞同：21
> 
> 时间：2009-01-12T11:34:09.670
> 
> 标签：c#, sorting, datagridview, dataview

我需要使用自然排序（如在资源管理器中）对 DataGridView 进行排序，以便数字和文本（在同一列中）自然排序，而不是按字母顺序排序（因此“位置 3”位于“位置 20”之前，等等）。我有一个 DataGridView，我在其中将一个 DataView 设置为 DataSource。DataView 包含一个 DataTable，它是使用数据库中的一些值创建的。列类型是字符串。我有一个 IComparer，它可以做它应该做的，但我不知道如何使用它，因为我不知道如何进行排序。*完美*的 DataGridView.SortCompare 事件不起作用，因为它是数据绑定的。DataView.Sort 只接受带有列名和排序顺序的字符串。

很烦人。试图在 StackOverflow 上阅读相关问题，并在谷歌上搜索了很多，但我真的找不到太多关于此的内容。只有我真正找到的东西是使用数据视图的 Sort(string) 方法，该方法不起作用，因为它按字母顺序排序。

有谁知道如何在没有太多麻烦的情况下做到这一点？除了我之外，还有其他人在为此苦苦挣扎吗？我真的不想重新实现整个 datagridview 或 dataview 类，只是为了获得自定义排序......

**更新**：如果有人想知道，我仍在寻找这个问题的好答案。尽管与此同时，我最终创建了自己的简单表类，然后手动将其输入到 datagridview 中。重写 SortCompare 方法。有点烦人，但并不太难，因为我只需要显示值（无需编辑或任何东西），因此可以将所有内容转换为字符串。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T14:29:26.960

看看[这个 MSDN 页面](http://msdn.microsoft.com/en-us/library/sa88ktts(VS.80).aspx)和[这个博客文章](http://2000mph.blogspot.com/2008/11/sorting-and-paging-gridview-with-custom.html)。原则上，您需要在数据源（无论是 ObjectDataSource 还是 SqlDataSource）上配置排序，而不是在 GridView 上。

据我所知，DataView 类只支持简单的升序/降序排序。如果没有看到加载和绑定数据的代码，很难做出具体的建议，但您可以：

1.  将数据加载到 List 而不是 DataTable 中，调用传入比较方法的 Sort 方法，然后绑定到该列表。
2.  在您的 aspx 代码中创建一个直接从类获取数据的 ObjectDataSource，并将该 ObjectDataSource 配置为使用您的 IComparer。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-01-03T23:10:02.223

这段代码应该可以工作。它类似于 ListView 的 ListViewItemSorter。使用 IComparer。

要使用：

```
private void dgv_ColumnHeaderMouseClick(object sender, DataGridViewCellMouseEventArgs e)
{
    MyDataGridHelper.DataGridSort(dgv, e.ColumnIndex);
} 
```

MyDataGridHelper.cs：

```
public class MyDataGridHelper
{
    public static void DataGridSort(DataGridView dgv, int column)
    {
        DataGridViewCustomSorter dgvSorter = null;
        if (dgv.Tag == null || !(dgv.Tag is IComparer))
        {
            dgvSorter = new DataGridViewCustomSorter(dgv);
            dgv.Tag = dgvSorter;
        }
        else
        {
            dgvSorter = (DataGridViewCustomSorter)dgv.Tag;
        }
        dgvSorter.SortColumn = column;
        dgv.Sort(dgvSorter);
    }

    private class DataGridViewCustomSorter : IComparer
    {
        private int ColumnIndex;
        private SortOrder OrderOfSort;
        private DataGridView myDataGridView;
        private TypeCode mySortTypeCode;

        public DataGridViewCustomSorter(DataGridView dgv)
        {
            myDataGridView = dgv;
            mySortTypeCode = Type.GetTypeCode(Type.GetType("System.String"));
            ColumnIndex = 0;
            OrderOfSort = SortOrder.None;
        }

        public int Compare(object x, object y)
        {
            int result;
            DataGridViewRow dgvX, dgvY;

            dgvX = (DataGridViewRow)x;
            dgvY = (DataGridViewRow)y;
            string sx = dgvX.Cells[ColumnIndex].Value.ToString();
            string sy = dgvY.Cells[ColumnIndex].Value.ToString();

            //null handling
            if (sx == String.Empty && sy == String.Empty)
                result = 0;
            else if (sx == String.Empty && sy != String.Empty)
                result = -1;
            else if (sx != String.Empty && sy == String.Empty)
                result = 1;
            else
            {
                switch (mySortTypeCode)
                {
                    case TypeCode.Decimal:
                        Decimal nx = Convert.ToDecimal(sx);
                        Decimal ny = Convert.ToDecimal(sy);
                        result = nx.CompareTo(ny);
                        break;
                    case TypeCode.DateTime:
                        DateTime dx = Convert.ToDateTime(sx);
                        DateTime dy = Convert.ToDateTime(sy);
                        result = dx.CompareTo(dy);
                        break;
                    case TypeCode.String:
                        result = (new CaseInsensitiveComparer()).Compare(sx, sy);
                        break;
                    default:
                        result = (new CaseInsensitiveComparer()).Compare(sx, sy);
                        break;
                }
            }
            if (OrderOfSort == SortOrder.Descending)
                result = (-result);

            return result;
        }

        public int SortColumn
        {
            set
            {
                if (ColumnIndex == value)
                {
                    OrderOfSort = (OrderOfSort == SortOrder.Descending ? SortOrder.Ascending : SortOrder.Descending);
                }
                ColumnIndex = value;
                try
                {
                    mySortTypeCode = Type.GetTypeCode(Type.GetType((myDataGridView.Columns[ColumnIndex]).Tag.ToString()));
                }
                catch
                {
                    mySortTypeCode = TypeCode.String;
                }
            }
            get { return ColumnIndex; }
        }

        public SortOrder Order
        {
            set { OrderOfSort = value; }
            get { return OrderOfSort; }
        }
    } //end class DataGridViewCustomSorter
} //end class MyDataGridHelper 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-17T10:18:36.797

这里有一些解决方案“**使用 SortCompare 事件进行**自定义排序 ”和“**使用 IComparer 接口进行自定义排序**”：

[http://msdn.microsoft.com/en-us/library/ms171608.aspx](http://msdn.microsoft.com/en-us/library/ms171608.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T16:28:26.097

您可以创建 2 个隐藏列。将文本部分分配给第一个隐藏列，将数字部分分配给第二个隐藏列。现在按这些隐藏列排序（第一列的字母排序和第二列的数字排序）。

通过这种方式，您可以保留原始列以用于显示目的并让 2 个隐藏列用于排序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-16T12:45:31.510

您可以将排序逻辑移动到您的数据库查询中，并让它返回一个具有正确排序顺序的附加列。

然后（沿着@True C Sharp的回答）你可以有一个包含这个值的隐藏列，并按这个而不是按显示列排序。

这假定确定排序顺序的逻辑可以在 SQL 中执行。如果用于确定排序顺序的算法很复杂，这可能不起作用。

# php - PHP数组，将数组项的深度递归地附加到具有“深度”键的数组中

> ID：435180
> 
> 赞同：5
> 
> 时间：2009-01-12T11:35:15.253
> 
> 标签：php, arrays, recursion, associative-array

根据最底部的示例数组，我希望能够将每个嵌入数组的深度附加到数组内部。例如：

```
    大批 （
      53 =>
      大批 （
        '标题' => '家',
        '路径' => '',
        '类型' => '118',
        'pid' => 52,
        '有孩子' => 0,
      ),

```

根据下面显示的示例数组，深度为 1，因此它现在应该如下所示：

```
    大批 （
      53 =>
      大批 （
        '标题' => '家',
        '路径' => '',
        '类型' => '118',
        'pid' => 52,
        '有孩子' => 0,
        '深度' => 1,
      ),

```

等等...

我所做的所有递归数组函数尝试都非常尴尬。但是，我查看了具有 getDepth 函数的 RecursiveArrayIterator 。我对如何将它附加到当前数组感到困惑......非常感谢任何帮助，谢谢。

```

  大批 （
    'title' => '网站导航',
    '路径' => '',
    '类型' => '115',
    'pid' => 0,
    '有孩子' => 1,
    '孩子' =>
    大批 （
      53 =>
      大批 （
        '标题' => '家',
        '路径' => '',
        '类型' => '118',
        'pid' => 52,
        '有孩子' => 0,
      ),
      54 =>
      大批 （
        '标题' => '特征',
        '路径' => '特征',
        '类型' => '374',
        'pid' => 52,
        '有孩子' => 1,
        '孩子' =>
        大批 （
          59 =>
          大批 （
            '标题' => '艺术'，
            '路径' => '功能/艺术'，
            '类型' => '374',
            'pid' => 54,
            '有孩子' => 1,
            '孩子' =>
            大批 （
              63 =>
              大批 （
                '标题' => '画廊',
                '路径' => '特色/艺术/画廊',
                '类型' => '374',
                'pid' => 59,
                '有孩子' => 1,
                '孩子' =>
                大批 （
                  65 =>
                  大批 （
                    '标题' => '图形',
                    '路径' => '功能/艺术/画廊/图形'，
                    '类型' => '118',
                    'pid' => 63,
                    '有孩子' => 0,
                  ),
                  67 =>
                  大批 （
                    'title' => '混合媒体',
                    '路径' => '功能/艺术/画廊/混合媒体'，
                    '类型' => '118',
                    'pid' => 63,
                    '有孩子' => 0,
                  ),
                  64 =>
                  大批 （
                    '标题' => '概述',
                    '路径' => '特色/艺术/画廊',
                    '类型' => '118',
                    'pid' => 63,
                    '有孩子' => 0,
                  ),
                  68 =>
                  大批 （
                    '标题' => '摄影',
                    '路径' => '特色/艺术/画廊/摄影',
                    '类型' => '118',
                    'pid' => 63,
                    '有孩子' => 0,
                  ),
                  66 =>
                  大批 （
                    '标题' => '传统'，
                    '路径' => '特色/艺术/画廊/传统',
                    '类型' => '118',
                    'pid' => 63,
                    '有孩子' => 0,
                  ),
                ),
              ),
              62 =>
              大批 （
                '标题' => '概述',
                '路径' => '功能/艺术'，
                '类型' => '118',
                'pid' => 59,
                '有孩子' => 0,
              ),
              69 =>
              大批 （
                '标题' => '教程',
                '路径' => '功能/艺术/教程'，
                '类型' => '374',
                'pid' => 59,
                '有孩子' => 1,
                '孩子' =>
                大批 （
                  71 =>
                  大批 （
                    '标题' => '按类别',
                    '路径' => '功能/艺术/教程/按类别/'，
                    '类型' => '118',
                    'pid' => 69,
                    '有孩子' => 0,
                  ),
                  72 =>
                  大批 （
                    '标题' => '按日期',
                    '路径' => '功能/艺术/教程/按日期/'，
                    '类型' => '118',
                    'pid' => 69,
                    '有孩子' => 0,
                  ),
                  70 =>
                  大批 （
                    '标题' => '概述',
                    '路径' => '功能/艺术/教程'，
                    '类型' => '118',
                    'pid' => 69,
                    '有孩子' => 0,
                  ),
                ),
              ),
            ),
          ),
          58 =>
          大批 （
            '标题' => '概述',
            '路径' => '特征',
            '类型' => '118',
            'pid' => 54,
            '有孩子' => 0,
          ),
          61 =>
          大批 （
            '标题' => '项目/实验室',
            '路径' => '功能/项目实验室/'，
            '类型' => '374',
            'pid' => 54,
            '有孩子' => 0,
          ),
          60 =>
          大批 （
            'title' => '网络开发',
            '路径' => '功能/网络开发',
            '类型' => '374',
            'pid' => 54,
            '有孩子' => 1,
            '孩子' =>
            大批 （
              74 =>
              大批 （
                '标题' => '文章',
                '路径' => '功能/网络开发/文章/'，
                '类型' => '374',
                'pid' => 60,
                '有孩子' => 0,
              ),
              73 =>
              大批 （
                '标题' => '概述',
                '路径' => '功能/网络开发',
                '类型' => '118',
                'pid' => 60,
                '有孩子' => 0,
              ),
              75 =>
              大批 （
                '标题' => '教程',
                '路径' => '功能/网络开发/教程',
                '类型' => '374',
                'pid' => 60,
                '有孩子' => 0,
              ),
            ),
          ),
        ),
      ),
      55 =>
      大批 （
        '标题' => '活动',
        '路径' => '活动',
        '类型' => '374',
        'pid' => 52,
        '有孩子' => 0,
      ),
      56 =>
      大批 （
        '标题' => '博客',
        '路径' => '博客',
        '类型' => '374',
        'pid' => 52,
        '有孩子' => 0,
      ),
      57 =>
      大批 （
        '标题' => '关于',
        '路径' => '关于'，
        '类型' => '374',
        'pid' => 52,
        '有孩子' => 1,
        '孩子' =>
        大批 （
          76 =>
          大批 （
            '标题' => '作者',
            '路径' => '关于/作者',
            '类型' => '118',
            'pid' => 57,
            '有孩子' => 0,
          ),
          77 =>
          大批 （
            '标题' => '网站',
            '路径' => '关于/网站',
            '类型' => '118',
            'pid' => 57,
            '有孩子' => 0,
          ),
        ),
      ),
    ),
  ),
);

print_r($example);

?>

```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-12T12:06:49.137

我假设还有另一个数组（在您的示例代码中未包含在顶部。像这样的东西？

```
function array_set_depth($array, $depth = -1)
{
  $subdepth = $depth + 1;
  if ($depth < 0) {
    foreach ($array as $key => $subarray) {
      $temp[$key] = array_set_depth(($subarray), $subdepth);
    }
  }
  if ($array['hasChildren'] && isset($array['children'])) {
    foreach ($array['children'] as $key => $subarray) {
      $temp[$key] = array_set_depth($subarray, $subdepth);
    }
    $array['children'] = $temp;
  }
  $array['depth'] = $depth;
  return $array;
} 
```

示例用法，我将您的数组设置为值 $a：

```
$b = array_set_depth($a);
print_r($b); 
```

编辑：

要在孩子们之前设置深度以获得良好的打印效果，您可以这样做：

```
function array_set_depth($array, $depth = -1)
{
  $subdepth = $depth + 1;
  if ($depth < 0) {
    foreach ($array as $key => $subarray) {
      $temp[$key] = array_set_depth(($subarray), $subdepth);
    }
    return $temp;
  }
  $array['depth'] = $depth;
  if ($array['hasChildren'] && isset($array['children'])) {
    foreach ($array['children'] as $key => $subarray) {
      $temp[$key] = array_set_depth($subarray, $subdepth);
    }
    unset($array['children']);
    $array['children'] = $temp;
  }
  return $array;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T11:42:50.667

像这样的递归函数应该这样做吗？

```
function setDepth(&$a, $depth)
{
    $a['depth']=$depth;
    foreach($a as $key=>$value)
    {
        if (is_array($value))
           setDepth($a[$key], $depth+1);
    }

} 
```

需要注意的是，数组是通过引用传递的，所以我们可以修改它。请注意，我们还在对 setDepth 的递归调用中使用此引用。虽然我使用 foreach 是为了方便，但 $value 变量是一个副本，将其传递给 setDepth 只会在 foreach 循环范围内进行短暂的更改。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-12T13:20:02.500

修改 Pauls 代码以使用此示例。

```
function setDepth(&$a, $depth = -1)
{
    if (($depth > -1) && !($depth % 2))
      $a['depth']= $depth / 2;
    foreach($a as $key=>$value)
    {
        if (is_array($value))
           setDepth($a[$key], $depth+1);
    }

}
setDepth($a);
print_r($a); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T11:56:20.453

像这样的东西应该可以解决问题：

```
function setdepth($arr, $depth = 0)
{
    foreach ($arr as $key => $val)
    {
        $arr[$key]['depth'] = $depth;
        if ($arr[$key]['hasChildren'])
        {
            setdepth(&$arr[$key]['children'], $depth+1);
        }
    }
} 
```

如果您的数组以索引而不是值开头，我会更容易，因此示例用法可能是这样的：

```
$arr[0] = $website;
setdepth(&$arr, 0); 
```

website 是您示例中的数组

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-17T01:14:15.933

这可能会有所帮助：

```
function extend( $arr, $myArr=array() ) {

    foreach( $arr as $key => $value ) {
        if( is_array( $key ) ) {
            extend( $arr[ $key ] );
        } else {
            $myArr[ $key ] = $arr[ $key ];
        }
    }

    return $myArr;
} 
```

称为“扩展”的函数，因为它不仅可以将数组复制到新数组中，还可以扩展现有数组。

要扩展一个数组，你应该把它作为第二个参数，否则放一个空数组。函数 lopps 通过数组属性检查它是否是一个数组，如果它再次被函数调用，否则它将值复制到另一个数组并返回它。

# specman - 如何计算specman中一个uint中设置的位数？

> ID：435188
> 
> 赞同：2
> 
> 时间：2009-01-12T11:39:11.923
> 
> 标签：specman

我想在 Specman 中计算一个 uint 中的设置位数：

```
var x: uint;
gen x;
var x_set_bits: uint;
x_set_bits = ?; 
```

最好的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T11:41:04.493

我见过的一种方法是：

```
x_set_bits = pack(NULL, x).count(it == 1); 
```

`pack(NULL, x)`转换`x`为位列表。
`count`作用于列表并计算条件成立的所有元素。在这种情况下，条件是元素等于 1，即设置的位数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T12:40:23.997

我不知道 Specman，但我看到的另一种方法看起来有点俗气，但往往是有效的：保持 256 元素数组；数组的每个元素都由与该值对应的位数组成。例如（伪代码）：

```
bit_count = [0, 1, 1, 2, 1, ...] 
```

因此，bit_count [2](https://stackoverflow.com/questions/109023/best-algorithm-to-count-the-number-of-set-bits-in-a-32-bit-integer#109025) == 1，因为二进制值 2 有一个“1”位。同样，bit_count[255] == 8。

然后，将 uint 分解为字节，使用字节值对 bit_count 数组进行索引，并将结果相加。伪代码：

```
total = 0
for byte in list_of_bytes
    total = total + bit_count[byte] 
```

**编辑**

这个问题出现在Henry S. Warren 的章节[*Beautiful Code*](http://oreilly.com/catalog/9780596510046/)中。此外，Matt Howells 展示了一种 C 语言实现，可以有效地计算位计数。看到[这个答案](https://stackoverflow.com/questions/109023/best-algorithm-to-count-the-number-of-set-bits-in-a-32-bit-integer#109025)。

# vb.net - 如何限制 MS Access DB 打开

> ID：435206
> 
> 赞同：0
> 
> 时间：2009-01-12T11:50:22.990
> 
> 标签：vb.net, ms-access

我正在使用**vb.net连接到****MS Access DB**，如下所示...

 ****oDBEngine = oAccess.DBEngine oDB = oDBEngine.OpenDatabase(Name:=strFullFileName, Options:=False, ReadOnly:=False, Connect:="")**

然后使用以下语法打开数据库...

**oAccess.OpenCurrentDatabase(filepath:=strFullFileName, Exclusive:=False)**

现在我的问题是：

其中一个数据库包含一个在我们打开数据库时自动打开的表单。所以当我试图为这个特定的数据库运行应用程序时，数据库就会打开。但根据我的要求，我不需要明确打开数据库。

在这种情况下，有没有办法限制数据库打开？

注意：这适用于所有其他情况，即数据库未打开，但我可以根据我的应用程序要求从每个表单中计算 Activex 控件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T00:54:44.500

您可以通过 API 尝试“以编程方式按下 shift 键”：

[http://www.mvps.org/access/api/api0068.htm](http://www.mvps.org/access/api/api0068.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T14:27:40.507

在您之前关于此主题的帖子：[How to prevent to open a MS Access Database while reading data from forms](https://stackoverflow.com/questions/427436/how-to-prevent-to-open-a-ms-access-database-while-reading-data-from-forms#427460)中，我建议将表单导入空白数据库，您没有提到为什么这个选项不适合，我很好奇为什么。

# asp.net - Lucene.Net 和孵化状态

> ID：435207
> 
> 赞同：6
> 
> 时间：2009-01-12T11:51:09.840
> 
> 标签：asp.net, lucene.net

我正在评估选项，以使我们的 .Net 网站上的搜索功能更强大。我需要调查我们是否购买了诸如 Google Search Appliance (GSA) 之类的软件/硬件，或者使用诸如 Lucene.Net 之类的框架来开发解决方案

我们是一家初创公司，GSA 提供了很多开箱即用的好功能，但我们需要两个盒子，第二个作为备份/开发环境，事情开始变得昂贵......

我们过去使用过 SQL Server 全文，但我们热衷于为我们的站点提供非常直观的“Googlesque”类型搜索，并且我们一直在努力使用 SQL Server 做我们想做的一切。

*但是*，我不确定 Lucene.Net 项目的“孵化器状态”实际上意味着什么。我应该考虑一个处于孵化器状态的项目吗？它不活跃吗？它会在某个时候进入更活跃的状态还是被归档？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T12:09:17.960

Lucene.NET 是一个当前活跃且更新的项目。在 Apache 下托管的事实是一件好事，而不是一件坏事。正如您在 Apache 孵化网站上看到的那样，Lucene.NET 正在等待审查和最终批准，但这并不意味着它不稳定或不受支持。关于您的主要问题，我认为如果您是初创公司，将其用于开发阶段将是一个可以接受的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T12:51:34.227

> 我不确定 Lucene.Net 项目的“孵化器状态”实际上意味着什么

这意味着该项目是一个外部项目，正在由 apache 评估以包含在 apache“稳定”中 - 我想他们必须确保流程是正确的，那里没有专利代码等等。

**它对代码没有任何反映**。Lucene.NET 主干是稳定的（v2.1），可下载版本（v2.0）也是稳定的，但不是“稳定”或更新。

如果您有更多问题，我建议您跳上邮件列表 ( [http://incubator.apache.org/lucene.net/](http://incubator.apache.org/lucene.net/) ) 并询问 George 或 DIGY。自 1.xx 以来，我一直在商业项目中使用它——内部（例如[http://www.topgear.com](http://www.topgear.com)）和打包（我不确定，但它是一个电子邮件存档器），而且效果很好。

我建议你也看看 Solr。它使用 Java Lucene，基本上是一个外部搜索服务器，但是您将信息推送到其中，而不是拖网您的站点。它在 apache lucene 网站上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T12:23:51.940

Log4net在 Apache 项目*中长期*处于孵化状态。它仍然被推荐并广泛使用。出于几个原因，我可以使用 Lucene.Net。首先，正如@ste09 所说，孵化状态是一件**好事**。其次，Lucene（Java 版本）是 Apache 的一个成熟项目。与 log4j/log4net 类似，我认为这对 Lucene.Net 来说是个好兆头，使其脱离孵化状态。

# mysql - 如果您尝试更新正在查询的表，MySQL 会做什么？

> ID：435209
> 
> 赞同：2
> 
> 时间：2009-01-12T11:53:31.707
> 
> 标签：mysql, performance

我有一个非常慢的查询，我需要不时在 MySQL 数据库上运行。

我发现在查询完成之前，更新正在查询的表的尝试会被阻止。

我想这是有道理的，否则查询的结果可能会不一致，但这对我来说并不理想，因为查询的重要性远低于更新。

所以我的问题真的有两个部分：

1.  出于好奇，MySQL 在这种情况下究竟做了什么？它会在查询期间锁定表吗？还是尝试在更新前锁定它？

2.  有没有办法让慢查询不阻塞？我想选项可能是：

    *   需要更新时终止查询。
    *   在表的副本上运行查询，就像更新发生之前一样
    *   只是让查询出错。

有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T14:26:31.460

听起来您正在使用 MyISAM 表，它使用表级锁定。在这种情况下，SELECT 将在表上设置共享锁。然后 UPDATE 将尝试请求排他锁并阻塞并等待直到 SELECT 完成。完成后，UPDATE 将正常运行。

[MyISAM 锁定](http://dev.mysql.com/doc/refman/5.1/en/table-locking.html)

如果你切换到 InnoDB，那么你的 SELECT 默认不会设置任何锁。无需像其他人建议的那样更改事务隔离级别（可重复读取是 InnoDB 的默认设置，并且不会为您的 SELECT 设置锁）。UPDATE 将能够同时运行。InnoDB 使用的多版本控制与 Oracle 处理这种情况的方式非常相似。SELECT 设置锁的唯一情况是，如果您在可序列化事务隔离级别中运行，您有查询的 FOR UPDATE/LOCK IN SHARE MODE 选项，或者它是某种写入语句的一部分（例如 INSERT. ..SELECT) 并且您正在使用基于语句的二进制日志记录。

[InnoDB 锁定](http://dev.mysql.com/doc/refman/5.1/en/innodb-transaction-model.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T12:16:34.077

出于 select 语句的目的，您可能应该在连接上发出：
`SET SESSION TRANSACTION ISOLATION LEVEL READ UNCOMMITTED`
命令，这会导致后续的 select 语句在没有锁定的情况下运行。
不要使用 ' `SELECT ... FOR UPDATE`'，因为这肯定会锁定受 select 语句影响的表行。
msql 事务隔离级别的完整列表[在文档中](http://dev.mysql.com/doc/refman/5.0/en/set-transaction.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T12:17:29.363

首先，您需要知道您使用的是什么引擎（MySam 或 InnoDb）。

这显然是一个交易问题。

看看第**13.4.6 节。mysql 手册中的SET TRANSACTION 语法**。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T11:59:45.687

我不知道 MySQL，但这听起来像是事务问题。您应该能够在您的选择查询中将事务类型设置为脏读。

这不一定会给你正确的结果。但它不应该被阻止。

最好是让第一个查询更快。做一些分析并检查您是否可以通过正确的方式加快速度等等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T12:08:53.767

UPDATE LOW_PRIORITY .... 可能会有所帮助 - mysql 文档不清楚这是否会让请求更新的用户继续并且更新在可能的情况下发生（这是我认为发生的）或者用户是否必须等待（这会比现在更糟......），我不记得了。

您使用的是什么表类型？如果你在 MyISAM 上，切换到 InnoDB（如果可以的话——它没有全文索引）为这类事情打开了更多选项，因为它支持事务特性和行级锁定。

# unit-testing - 对于使用 Maven 构建的命令行实用程序，我应该将 Velocity 模板文件放在哪里？

> ID：435210
> 
> 赞同：1
> 
> 时间：2009-01-12T11:54:01.160
> 
> 标签：unit-testing, maven-2, velocity

我有一个使用 Maven 管理的小型命令行实用程序项目。该实用程序是一个非常简单的应用程序，用于填充 Velocity 模板并将结果转储到新文件中。我的问题是在哪里放置我的 Velocity 模板。当我把它们放进去时`src/test/resources/foo/bar/baz`，`mvn test`因为找不到引用的模板而失败，即使它显然在里面`target/classes/foo/bar/baz`，这是`.class`测试文件和被测类所在的位置。如果我将模板放在项目的顶级目录中，则测试通过，但是我没有遵循 Maven 项目结构，并且我怀疑实际打包的 .jar 文件不起作用。我错过了什么？

更新：

**被测方法**：

```
public final void mergeTemplate(final String templateFileName, final Writer writer) throws ResourceNotFoundException, ParseErrorException, MethodInvocationException, IOException, Exception {
    Velocity.init();
    Velocity.mergeTemplate(templateFileName, Charset.defaultCharset().name(), context(), writer);
} 
```

**测试方法**：

```
@Test
public void testMergeTemplate() throws Exception {
    final FooGenerator generator = new FooGenerator();
    final StringWriter writer = new StringWriter();
    generator.mergeTemplate("foo.yaml", writer);
    Assert.assertEquals("Something went horribly, horribly wrong.", EXPECTED_RESULT, writer.toString().trim());
} 
```

我唯一可以放置`foo.yaml`并通过测试的地方是项目的根目录，即作为 and 的对等`src`点`target`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-07-29T17:38:41.577

您可以按如下方式以编程方式配置 TEMPLATE_ROOT：

```
Properties props = new Properties();        
props.put("file.resource.loader.path", templateRootDir);

VelocityEngine engine = new VelocityEngine();
engine.init(props);
engine.evaluate(...); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T12:02:12.173

您应该将它们放在 src/main/resources/foo/bar/baz 中，因为它们需要包含在主 jar 文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T20:18:10.923

所以事实证明，而不是使用类似的东西

```
generator.mergeTemplate("foo.yaml", writer); 
```

我应该使用类似的东西

```
InputStream fooStream = getClass().getResourceAsStream("foo.yaml");
generator.mergeTemplate(fooStream, writer); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T22:40:42.517

您可以将 Velocity 配置为使用 ClasspathResourceLoader，而不是默认的 FileResourceLoader。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-17T06:39:33.043

我已经尝试过 Velocity.setProperty() 来设置类似于上面@Jin Kim 所说的属性并且能够运行它。

```
VelocityEngine ve = new VelocityEngine();
ve.setProperty(RunTimeConstants.RESOURCE_LOADER,"file");
ve.setProperty("file.resource.loader.path",templaterootdir);

ve.init(); 
```

# performance - 谷歌分析有性能开销吗？

> ID：435228
> 
> 赞同：84
> 
> 时间：2009-01-12T12:05:50.573
> 
> 标签：performance, google-analytics, benchmarking

谷歌分析在多大程度上影响性能？

我正在寻找以下内容：

*   基准（包括响应时间/页面加载时间等）
*   与类似基准的链接或结果

在您的网站上测试 Google Analytics (GA) 的一种（可能）方法：

1.  从您自己的服务器上提供 ga.js（Google Analytics JavaScript 文件）。
2.  从 Google Daily（测试 1）和 Weekly（测试 2）更新。

我很想看看这如何减少客户端网络服务器和 GA 服务器之间的通信。

有人做过这些测试吗？如果是这样，你能提供你的结果吗？如果没有，有没有人有更好的方法来测试使用 GA 的性能影响（或缺乏）？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-12T12:38:25.563

**2018 年更新**：您安装 Analytics 的位置和方式一次又一次地发生变化。当前的 gtag.js 代码做了一些事情：

1.  加载 gtag 脚本但异步（非阻塞）。这意味着它不会以任何其他方式减慢您的页面速度，而不是带宽和处理。
2.  在页面上创建一个名为`window.datalayer`
3.  定义一个小`gtag()`函数，将你扔给它的任何东西推入该数组。
4.  使用页面加载事件调用它。

加载主 gtag 脚本后，它会将此数组与 Google 同步并监视它的更改。这是一个很好的系统，与以前的系统不同（例如在之前填充代码`</body>`），这意味着您可以在 DOM 呈现之前调用事件，并且脚本顺序并不重要，只要您`gtag()`先定义即可。

这并不是说这里没有性能开销。我们在加载脚本时仍然使用带宽（它在本地缓存了 15 分钟），而且它们扔给您的脚本并不是一小堆，因此需要一些 CPU 时间来处理它。

**但与（例如）现代前端框架相比，这一切都可以忽略不计。**

如果您要寻找绝对的、最精简的网站，请完全避免使用它。如果您想保护用户的隐私，请不要使用任何第三方脚本......但是如果我们谈论的是一个普通的现代网站，那么*如果*您是打击性能问题。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-12T12:34:56.427

Steve Souders（客户端性能专家）有一些[很棒的幻灯片，内容是：](http://stevesouders.com/docs/googleio-20080529.ppt)

*   并行加载外部 JavaScript 文件的不同技术
*   它们对加载时间和页面渲染的影响
*   浏览器显示什么样的“进行中”指示器（例如状态栏中的“加载”、沙漏鼠标光标）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-12T12:43:57.033

我没有做过任何花哨的自动化测试或编程数字运算，但是使用带有 Firebug 插件和一对 JS 变量的老式 Firefox 来判断所有 GA 代码执行前后的时间差，这就是我发现的。

下载了两个东西：

1.  ga.js 是包含代码的 JavaScript 文件。这是 9kb，因此初始下载可以忽略不计，并且文件名不是动态的，因此它在第一次请求后被缓存。

2.  带有动态 url 的 35 字节 gif 文件（通过查询字符串 args），因此每次都会请求。35 字节的下载量也可以忽略不计（萤火虫说我花了 70 毫秒来下载它）。

就执行时间而言，我的第一个使用干净浏览器缓存的请求平均每次大约 330 毫秒，后续请求在 35 到 130 毫秒之间。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-12T12:21:59.793

根据我自己的经验，添加 Google-Analytics 并没有改变加载时间。

根据 FireBug 的说法，它在不到一秒的时间内加载（平均 648 毫秒），因此根据我的一些其他测试 ~60% - 80% 的时间是从服务器传输数据，这当然会因用户而异。

由于上述原因，我并不特别认为在本地缓存分析代码会改变加载时间。

我在 40 多个网站上使用 Google-Analytics 并没有导致任何甚至很小的速度变慢，大部分时间都花在获取图像上，由于它们的典型尺寸，这些图像是可以理解的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-12T12:22:40.523

您可以毫无问题地将 ga.js 托管在您的服务器上，但想法是您的用户将从他们可能访问过的**其他站点缓存 ga.js。**所以下载 ga.js，因为它非常流行，在很多情况下增加的开销很小（即，它已经被缓存了）。

此外，由于网络拓扑，DNS 查找在不同地方的成本并不相同。缓存行为会根据用户是否使用包含 ga.js 的其他网站而改变。

加载 javascript 后，ga.js 会与 Google 服务器进行通信，但这是一个异步过程。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-06-03T00:27:09.363

这真的取决于日子。我只是将此添加到博客中。我在加利福尼亚州，非常靠近他们的主要数据中心，使用快速低延迟的商业 DSL，使用超频 i5，具有大量 RAM，运行最新的 linux 内核和稳定的 Firefox。

这是一个示例页面加载： ![在此处输入图像描述](https://i.stack.imgur.com/aEBaf.png)

仅 google-analytics 就增加了 5*秒*的网络下载时间……获得 15Kb！

*您可以看到blogger.com*在 300毫秒内提供了 34Kb。快了 32 倍！

另外，看看红线（代表 onLoad 事件，意思是页面上没有更多脚本执行，因此浏览器最终可以停止加载指示器/旋转/等）...看看它向右多远是。这可能是那里发生的 3 秒垃圾 javascript 处理。这条线离资源下载栏的末端很远是非常罕见的。我已经完成了调试，这是 1/3 分析错误，2/3 博主错误。...有人会认为谷歌的东西很快。

编辑：

还有一些数据。这是一个缓存所有内容的请求。以上是第一次访问。

我从上面删除了 googleplus 废话有两个原因，我试图看看他们是否在缓慢的 onLoad 事件中发挥了一些作用（他们不是），因为它大多是无用的。

![在此处输入图像描述](https://i.stack.imgur.com/iVRvf.png)

所以，有了这个，我们可以看到网络时间是你*最不*担心的。即使在装有现代软件的快速计算机上，收费谷歌分析 + 博主在处理时间上仍会将您的页面加载转储到 7 秒后。没有博主，只需检查这个网站，我看到资源加载后有 0.5 秒的延迟并且红线开始了。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-12T12:22:15.360

服务器端没有/最小的站点开销。

Google Analytics 的 HTML 是您放置在网页底部的三行 javascript。这真的没什么，并且不会比版权声明消耗更多的服务器资源。

在客户端，页面可能需要一点时间（最多几秒钟）来完成显示页面。然而 - 根据我的经验，唯一没有加载的页面是谷歌的东西，所以用户可以很好地看到你的页面。你只是让页面顶部的悸动者颤动更长时间。

（注意：您需要将您的谷歌分析代码块放置在任何服务页面的底部，以防出现这种情况。我不知道如果将代码块放在您的 HTML 顶部会发生什么）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-07-26T12:37:13.193

谷歌关于如何包含使用的[传统说明](http://code.google.com/apis/analytics/docs/tracking/gaTrackingOverview.html)。因此，即使浏览器会以某种方式异步加载外部 JavaScript 库，直到实际执行某些代码，它仍然会阻止页面加载。后面的[异步指令](http://code.google.com/apis/analytics/docs/tracking/asyncTracking.html)不直接使用，可能还会阻塞页面加载？`ga.js``document.write()``document.write()``document.write()``insertBefore`

但是，Google 将缓存设置`max-age`为[86,400 秒](http://web-sniffer.net/?url=www.google-analytics.com%2Fga.js)（即 1 天，甚至设置为*public*，因此也适用于代理）。因此，由于许多站点加载相同的 Google 脚本，因此 JavaScript 通常会从缓存中获取。尽管如此，**即使`ga.js`已缓存，只需单击重新加载按钮通常会使浏览器询问 Google 是否有任何更改**。然后，就像`ga.js`还没有缓存的时候一样，浏览器必须等待响应才能继续：

```
获取 /ga.js HTTP/1.1  
主机：www.google-analytics.com  
...  
If-Modified-Since: 2009 年 6 月 22 日星期一 20:00:33 GMT  
缓存控制：max-age=0  

HTTP/1.x 304 未修改  
最后修改时间：2009 年 6 月 22 日星期一 20:00:33 GMT  
日期：2009 年 7 月 26 日星期日 12:08:27 GMT  
缓存控制：max-age=604800，公共  
服务器：高尔夫  
```

请注意，**许多用户点击重新加载他们已经在浏览器窗口中打开的新闻站点、论坛和博客，导致许多浏览器被阻止，直到收到来自 Google 的响应**。您多久重新加载一次 SO 主页？当 Google Analytics 响应缓慢时，这些用户会立即注意到。（网上发布了[很多](http://www.google.com/search?q=asynchronously+load+ga.js)异步加载`ga.js`脚本的解决方案，对这类网站特别有用，但可能不再比谷歌更新的说明好。）

一旦 JavaScript 加载并执行，web bug（跟踪图像）的实际加载应该是异步的。因此，**跟踪图像的加载不应阻止其他任何内容，*除非*页面使用`body.onload()`**. 在这种情况下，如果 web 错误未能及时加载，那么单击重新加载实际上会使事情变得更糟，因为单击重新加载也会使浏览器再次请求脚本，`If-Modified-Since`如上所述。*在*重新加载之前，浏览器只等待网络错误，而*在*单击重新加载后，它还需要`ga.js`脚本的响应。

因此，**使用 Google Analytics 的网站不应使用`body.onload()`**. 相反，应该使用 jQuery 的[$(document).ready()](http://api.jquery.com/ready/)或 MooTools 的[domready event](http://mootools.net/docs/core/Utilities/DomReady)之类的东西。

另请参阅 Google 的[功能概述](http://code.google.com/apis/analytics/docs/concepts/gaConceptsOverview.html)，解释*Google Analytics 如何收集数据？*，包括*跟踪代码的工作原理*。（这也使得谷歌收集第一方 cookie 的内容成为官方的。即：来自您正在访问的网站的 cookie。）

* * *

更新：[2009 年 12 月](http://googlecode.blogspot.com/2009/12/google-analytics-launches-asynchronous.html)，Google 发布[了异步版本](http://code.google.com/apis/analytics/docs/tracking/asyncTracking.html)。上面应该告诉大家升级只是为了确定，虽然[升级并不能解决所有问题](https://meta.stackexchange.com/questions/64213/connecting-to-google-analytics-com-makes-so-unusable)。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-12T13:55:59.323

使用 FireBug 和 YSlow 自行检查。然而，您会发现 GA 的大小约为 9KB（实际上对于它的作用来说相当大），而且它有时加载速度也不是很快（我不知道是什么原因，我认为它可能是服务器有时会“窒息”）

由于[Ajax Samples](http://ra-ajax.org/samples/)的性能问题，我们将其*删除*，但对于我们来说，*超快速*和响应性再次成为优先级 1、2 和 3

 ** * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-12T12:36:13.570

从客户端的角度来看，将任何额外的 javascript 加载到您的页面会增加下载时间。您可以通过将其加载到页面底部来改善这一点，以便即使未加载 GA 也可以呈现您的页面。我会避免缓存，因为您将失去页面客户端缓存的优势。如果客户端从其他页面缓存了它，您页面的请求将由客户端本身填充。如果您将其更改为从您的站点加载，即使客户端已经拥有代码（很可能），它也需要下载。将任务添加到您的软件进程以避免从 Google 加载文件似乎是没有根据的，因为这可能是不必要的优化。很难对此进行测试，因为它总是会在本地更快地提供服务，但真正重要的是它对您的客户的运行速度有多快。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-14T15:04:30.663

好吧，我已经在网上进行了广泛的搜索、研究和探索。但我没有发现任何支持或反对前提的统计数据。

**[然而，来自http://www.ga-experts.com](http://www.ga-experts.com/blog/2006/06/top-ten-google-analytics-myths-busted/#4)的这段摘录声称这是一个神话，即 GA 会减慢您的网站速度。**

> 呃，好吧，也许有点，但我们谈论的是毫秒。GA 通过页面标记工作，每当您向网页添加更多内容时，它都会增加加载时间。但是，如果您遵循最佳实践（在标签之前添加`</body>`标签），那么您的页面将首先加载。另外，请记住，任何基于页面标签的网络分析包（大多数）都将以相同的方式工作

从上面的答案和所有其他来源，我的感觉是，由于脚本包含在页面底部，因此用户无法感知它导致的任何减速。但是，如果我们谈论完整的页面加载，我们可能会说它减慢了页面加载时间。

如果有，请在更多信息中发布，如果有，请在 DATA 中发布。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-12T12:23:35.123

没有什么明显的。

对 Google 的调用（包括 DNS 查找、加载 Javascript（如果尚未缓存）以及实际的跟踪器调用本身）应该由客户端的浏览器在单独的线程中完成，以实际加载您的页面。当然，DNS 查找将由底层系统完成，据我所知，不会算作浏览器内的查找（浏览器对每个站点使用的请求线程数有限制）。

除此之外，浏览器将并行加载 Google 脚本以及所有其他嵌入式资源，因此在最坏的情况下，您下载所有内容所需的时间可能会略微增加（我们按以下顺序进行讨论）毫秒，不明显。如果 Google 脚本是浏览器最后加载的，或者您的页面上没有很多外部资源，或者您的页面的外部资源被浏览器缓存，或者如果 Google 的脚本被浏览器缓存 (极有可能）那么您将看不到任何区别。总体而言，这绝对是微不足道的，粗略地说，与在页面上粘贴额外的小图片的效果相同。

唯一可能产生具体影响的情况是，如果您有一些行为触发 onLoad 事件（等待外部资源加载），*并且*Google 服务器出现故障/缓慢。后者不太可能经常发生，但如果是这种情况，那么在下载脚本之前 onLoad 甚至不会触发。无论如何，您都可以通过使用各种“当 DOM 加载时”事件来解决这个问题，这些事件通常响应更快，因为您也不必等待自己的脚本/图像以这种方式加载。

如果您真的很担心对页面加载时间的影响，那么请查看[Firebug](http://www.getfirebug.com)的“网络速度”部分，它将对此进行量化并为您绘制漂亮的图表。无论如何，我鼓励你自己做这件事，因为即使其他人给你你要求的数据和基准，你自己的网站**也会**完全不同。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-06-12T21:10:10.280

问题是谷歌分析会导致您的网站变慢，答案是肯定的。目前，在撰写此 Google-Analytics.com 时，该网站无法正常工作，因此页面中包含该内容的网站将无法加载页面，因此是的，它可能会减慢并导致您的网站甚至无法加载。google-analytics.com 出现如此长的停机时间并不常见，目前已经超过 10 分钟，但这只是表明它是可能的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-12T13:43:44.587

我认为这不是您要寻找的东西，但是您担心性能是什么？

如果它是您的服务器......那么显然没有影响，因为它驻留在 Google 服务器上。

如果您担心的是您的用户，那么也没有影响。只要您将它放在 body 标记上方，那么您的用户就不会收到比以前慢的任何东西……脚本最后加载并且对用户的外观没有影响。所以基本上没有等待任何东西，甚至继续浏览页面而没有注意到它仍在加载。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-08-22T12:48:01.540

它有两个方面。

1.  分析脚本的（和 gif）下载
2.  下载的脚本执行

下载时间几乎总是小于 100ms，这是可以接受的。

转折来了。

1.  analytics.js 执行 250 毫秒
2.  再营销（如果启用） 300 毫秒
3.  人口统计（如果启用） 200 毫秒

因此，再营销分析平均需要 750 毫秒。我觉得在性能开销方面这是一个巨大的数字。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2019-08-20T14:04:47.730

我注意到 cPanel 中频繁的 I/O 和 CPU 过载导致：

> 站点无法访问错误

在我禁用 WP Analytics 插件后，这种情况就停止了。所以我认为它确实有一些影响。

# wpf - HierarchicalDataTemplate 和 TreeView 绑定编译错误

> ID：435231
> 
> 赞同：0
> 
> 时间：2009-01-12T12:07:16.950
> 
> 标签：wpf, xaml, compiler-errors

我已经实现了一个 UserControl 并在其上放置了一个 TreeView 控件。XAML 文件如下所示。我正在使用 HierarchicalDataTemplate 与 Treeview 进行数据绑定，

```
<UserControl x:Class="Trinity.Windows.Viewer.Alarm.AlarmPage.TrinityDeviceTree"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:src ="clr-namespace:Trinity.Windows.Viewer.Alarm.AlarmPage" 
    Height="300" Width="300">
    <UserControl.Resources>
        <src:SiteList x:Key="SiteListKey"/>
        <HierarchicalDataTemplate DataType="{x:Type src:Site}" 
            ItemsSource="{Binding Path=PartitionsList}">
        <TextBlock Text="{Binding Path=Name}"/>
    </HierarchicalDataTemplate>

    <HierarchicalDataTemplate DataType="{x:Type src:Partition}" 
        ItemsSource="{Binding Path=MasterDeviceList}">
        <TextBlock Text="{Binding Path=Name}"/>
    </HierarchicalDataTemplate>

    <HierarchicalDataTemplate DataType="{x:Type src:MasterDevice}" 
        ItemsSource="{Binding Path=SlaveDeviceList}">
        <TextBlock Text="{Binding Path=Name}"/>
    </HierarchicalDataTemplate>

    <DataTemplate DataType="{x:Type src:SlaveDevice}">
        <TextBlock Text="{Binding Path=Name}"/>
    </DataTemplate> 
</UserControl.Resources>

<Grid Width="auto" Height="auto">
    <Grid.RowDefinitions>
        <RowDefinition/>
    </Grid.RowDefinitions>
    <TreeView Name="DeviceTree"/>
</Grid> 
```

我有绑定到 TreeView 的数据类，如下所示：

```
namespace Trinity.Windows.Viewer.Alarm.AlarmPage
{

    public class Site
    {
        public Site(string name)
        {
            _name = name;
            _partitions = new ObservableCollection<Partition>();
        }
        string _name;
        public string Name { get { return _name; } }
        ObservableCollection<Partition> _partitions;
        public List<Partition> PartitionsList { get { return _partitions; } }
    }

    public class Partition
    {
        public Partition(string name)
        {
            _name = name;
            _masterdevice = new ObservableCollection<MasterDevice>();
        }
        string _name;
        public string Name { get { return _name; } }
        ObservableCollection<MasterDevice> _masterdevice;
        public ObservableCollection<MasterDevice> MasterDeviceList { get { return _masterdevice; } }
    }

    public class MasterDevice
    {
        public MasterDevice(string name)
        {
            _name = name;
            _slavedevice = new ObservableCollection<SlaveDevice>();
        }
        string _name;
        public string Name { get { return _name; } }
        ObservableCollection<SlaveDevice> _slavedevice;
        public ObservableCollection<SlaveDevice> SlaveDeviceList { get { return _slavedevice; } }
    }

    public class SlaveDevice
    {
        public SlaveDevice(string name)
        {
            _name = name;
        }

        string _name;

        public string Name { get { return _name; } }
    }

    public class SiteList : ObservableCollection<Site>
    {
        public Site this[string name]
        {
            get
            {
                foreach (Site objSite in this)
                    if (objSite.Name == name)
                        return objSite;
                return null;
            }
        }
    }
} 
```

但是现在当我编译这段代码时，我得到以下错误：

> 错误 MC1000：未知的构建错误，“无法从程序集“WindowsBase，版本=3.0.0.0，文化=中性，PublicKeyToken=31bf3856ad364e35”加载类型“System.ComponentModel.IEditableCollectionView”。第 9 行位置 87。在 xaml 文件中。

现在，如果我在 XAML 文件中注释包含 HierarchicalDataTemplate 的代码，我的项目编译时不会出错。我不明白为什么我会遇到编译错误。

请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-12T12:22:37.730

你不只需要针对 3.5 框架吗？或者确保您安装了 SP2 of 3.0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T12:23:23.033

我可以根据您的示例创建一个编译解决方案。

该错误可能意味着您的项目目标与已安装框架或类似框架之间的版本不匹配。

另一个问题可能是您的 PC 上的框架安装通常是软管。尝试在全新安装上重现错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T05:08:47.373

解决了... windowsbase.dll 不匹配...

# java - 通用文档格式转换器

> ID：435238
> 
> 赞同：0
> 
> 时间：2009-01-12T12:10:56.193
> 
> 标签：java, html, pdf, ms-word, converter

我希望将任何格式转换为/从 HTML 转换。

我想支持 DOC、DOCX、PDF、ODT、RDF、DocBook 和 TXT。

我发现了很多格式到格式的转换实用程序，但为了便于实施，最好使用单个工具。随着供应商或开源项目扩展库，这也将使添加新格式变得更加容易。

理想的“集线器”格式是 HTML，但我也可以使用另一种集线器格式。

要在服务器端运行，最好是 Java 库，或者 C/C++ 库、COM 或命令行工具；但不是打印机驱动程序、在线服务或 GUI 工具。商业和开源都可以。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-12T12:24:53.343

OpenOffice.org

从这个[链接](http://www.linux.com/articles/61713)：

> OpenOffice.org 鲜为人知的功能之一是它能够作为服务运行。你可以巧妙地利用这种能力。例如，您可以将 OpenOffice.og 变成一个转换引擎，并使用它通过基于 Web 的界面或命令行工具将文档从一种格式转换为另一种格式。JODConverter 可以帮助您释放 OpenOffice.org 的文件转换功能。

这听起来像你在找什么。这一切也都在 Java 中。

这个链接告诉你更多关于上面提到的[JODConverter](http://www.artofsolving.com/opensource/jodconverter)的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T12:24:31.347

我不相信这样的实用程序/转换器已经存在，因为很难合理地进行某些转换。例如，您将如何处理 HTML 到 TXT 到 HTML 的转换？你会剥去什么？您将如何用纯文本表示不同的 HTML 元素？此外，您将如何处理内容中的内容，例如将 TXT 中的 XML 转换为 DOCX，然后再转换为 XHTML？

也就是说，如果我要为此目的制作一个转换器，我会从[Apache POI](http://poi.apache.org/)开始，它是一个用于处理 Office 文档的库。然后我会使用[iText](http://www.lowagie.com/iText/)进行 PDF 连接，确保 [Office 格式] <-> PDF 转换能够像我希望的那样健壮，然后添加[JDOM](http://www.jdom.org/)进行 XML 处理，测试 [Office 格式] <-> XML 和 PDF <-> XML 可以按我的意愿工作，依此类推，你懂的。我会特别避免自己实现文件类型处理程序，因为那时我很可能会重新发明轮子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T12:38:54.687

这是一个不平凡的问题。例如，上个月我一直在[寻找一种强大的 HTML+CSS 到 PHP 中的 PDF 转换，](https://stackoverflow.com/questions/391005/convert-html-css-to-pdf-with-php)尽管我发现了（从那个问题）Prince XML，但我只设法让一个可靠地工作，尽管速度非常慢（html2pdf） ，我的初步测试表明它是一个 sperb 产品。然而它很昂贵。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T12:38:57.247

看看[Freemarker](http://freemarker.sourceforge.net/)

我建议将 XML 作为“集线器”格式，然后将您的样式信息分离到 XSLT 中。

# c# - 如何解析 csv 并返回一个数据集作为结果

> ID：435244
> 
> 赞同：0
> 
> 时间：2009-01-12T12:15:45.047
> 
> 标签：c#, asp.net, csv, parsing

我需要一个 CSVParser 类文件 一个类文件，它解析 csv 并返回一个数据集作为结果 ASP.Net

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T12:40:03.157

我很确定[CSVReader](http://www.codeproject.com/KB/database/CsvReader.aspx) (CodeProject) 可以读取到`DataTable`.

```
 DataTable table = new DataTable();
        // set up schema... (Columns.Add)
        using(TextReader text = File.OpenText(path))
        using(CsvReader csv = new CsvReader(text, hasHeaders)) {
            table.Load(csv);
        } 
```

请注意，手动设置模式是可选的；如果你不这样做，我相信它假定一切都是`string`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T12:19:30.077

简单的谷歌给出了大量的[结果](http://windowsclient.net/blogs/faqs/archive/2006/05/30/how-do-i-load-a-csv-file-into-a-datatable.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T18:00:00.453

我对这个[解析器](http://www.codeproject.com/KB/database/GenericParser.aspx)很幸运。它将结果返回给 DataSet。

您可能想要查看的另一个工具是[FileHelpers](http://www.filehelpers.com/)。我在 SO 上看到此资源的[标签。](https://stackoverflow.com/questions/tagged/filehelpers)

# graphics - 成像问题：如何确定图像质量？

> ID：435257
> 
> 赞同：9
> 
> 时间：2009-01-12T12:19:14.510
> 
> 标签：graphics, analysis, jpeg, imaging

我正在寻找确定摄影质量的方法（jpg）。我想到的第一件事是将文件大小与存储在其中的像素数量进行比较。还有其他方法吗，例如检查 jpg 中的噪声量？有没有人有关于这个主题的良好阅读链接或任何经验？顺便说一句，我正在处理的项目是用 C# (.net 3.5) 编写的，我使用 Aurigma Graphics Mill 进行图像处理。

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-12T13:58:38.583

我不完全清楚你所说的“质量”是什么意思，如果你指的是 JPG 压缩算法中的质量设置，那么你可以从图像的 EXIF 标签中提取它（依赖于捕获设备将它们放入和没有其他人覆盖它们）为您的库请参见此处：

[http://www.aurigma.com/Support/DocViewer/30/JPEGFileFormat.htm.aspx](http://www.aurigma.com/Support/DocViewer/30/JPEGFileFormat.htm.aspx)

如果您指的是任何其他类型的“质量”，那么您需要对质量提出更好的定义。例如，过度曝光可能是一个问题，在这种情况下寻找饱和像素将有助于确定特定类型的质量。或者更一般地，您可以查看 3 个颜色通道中图像直方图的统计数据（平均值、标准偏差）。图像可能失焦，在这种情况下，您可以在图像傅里叶变换的空间频率中寻找截止点。如果您担心散斑噪声，那么您可以尝试对图像应用中值滤波器并与原始图像进行比较（更多的散斑噪声会产生更大的变化） - 我在这里猜测了一下。

如果“质量”是指构图的美学特性等，那么-祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-07T18:00:54.967

图像的“质量”是不可测量的，因为它不对应于任何特定的值。如果您将其视为特定尺寸图像中的像素数，则它不准确。您可能会将在光线不好的情况下拍摄的照片称为“质量差”，即使它与在良好光线条件下拍摄的另一张照片的像素数完全相同。该术语通常用于谈论图像的整体效果，而不是其技术规格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T12:42:20.547

我想做类似的事情，但想要“Soylent Green”选项，并让人们通过进行比较来对图像进行排名。[请参阅此处的问题回复](https://stackoverflow.com/questions/164831/how-to-rank-a-million-images-with-a-crowdsourced-sort)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T13:39:49.417

我想您是在问如何确定压缩过程本身的质量。这可以通过将 JPEG 转换为 BMP 并将该 BMP 与创建 JPEG 的原始位图进行比较来完成。您可以逐个像素地遍历位图，并通过将每对像素的 R、G 和 B 值之间的差异（即原始像素和JPEG）并除以像素总数。这将为您提供原始和 JPEG 之间平均差异的度量。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-12T12:26:04.167

读取图像中的像素数可以告诉您“[百万像素](http://en.wikipedia.org/wiki/Pixel#Megapixel)”大小（#pixels/1000000），这可能是程序质量检查的一种粗略形式，但这不会告诉您照片是否正确聚焦，假设它是假设的集中注意力（想想快速运动的物体，比如火车），也不管天气与否，图片中是否有值得一看的东西，如果你愿意，这将需要一个人或[鸽子。](http://www.google.com/technology/pigeonrank.html)

# version-control - 如何撤消不属于变更集的 bitkeeper 中的签入？

> ID：435259
> 
> 赞同：0
> 
> 时间：2009-01-12T12:19:22.293
> 
> 标签：version-control, undo, bitkeeper

我在 bitkeeper 存储库中的项目中有一个文件。我签入了一个文件，但我没有提交更改以创建变更集。如何撤消签入？

如果我有一个变更集，我可以撤消提交：

```
bk undo -r<rev> 
```

但在这种情况下，我无法提交和撤消变更集，因为我有其他不想接触的签入文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T09:06:13.180

您可以使用以下命令撤消提交之外的签入`bk stripdel`：

```
bk stripdel -r<rev> filename 
```

例如，通过以下方式签入：

```
nfellman@xyz> bk ci a.c 
End comments with "." by itself or a blank line.
a.c 1.242>>  a
a.c@1.242>>  b
a.c@1.242>>  .
a.c revision 1.242: +0 -4 = 6731
a.c 1.242 -> 1.243 

```

然后用这个撤消签入：

```
 nfellman@xyz> bk stripdel -r1.242 a.c
stripdel: removed 1 deltas from a.c 

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T15:08:51.553

对答案略有改进...

您可以使用 -r+ 来引用最高版本。所以 stripdel 变为：

```
bk stripdel -r+ a.c 
```

# asp.net - 带有类库项目的 ASP.NET 解决方案

> ID：435261
> 
> 赞同：9
> 
> 时间：2009-01-12T12:19:48.890
> 
> 标签：asp.net, web-config

我在 VS 2008 中有一个解决方案，其中包含两个类库项目和一个 ASP.NET 网站。ASP.NET 站点引用了类库，其中一个库包含一个 LINQ To SQL 项。

我的问题是关于包含数据库连接字符串的类库中的 app.config。当我构建项目时，此 app.config 不在构建目录中，这意味着我无法动态更改已部署项目的连接字符串。

我在这里做错了什么，我怎样才能部署这些设置，以便我可以更改连接字符串？

提前致谢，

马丁。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-12T12:34:04.247

起初这也让我有些困惑。

您可能认为类库使用了它自己的项目中包含的 app.config 文件，但事实并非如此。它使用引用它的项目的配置文件。

所以你需要做的是`<appSettings/>`在你的 ASP.Net 项目的 web.config 文件中查找标签，并将其更改为`<appSettings></appSettings>`并添加`<add ... />`库项目的 app.config 文件中包含的标签。您无需为 ConfigurationManager 类更改代码中的任何内容即可解决此问题。它知道在哪里自动查找。

希望这是有道理的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T12:21:27.063

`Web.config`您可以在最终产品中编辑该文件。配置 API 通常会从应用程序的主要配置文件中获取配置数据，对于 ASP.NET 应用`Web.config`程序来说是`Myfile.exe.config`. 重要的是要知道项目中的类库通常不会有它们单独的配置文件`MyClassLib.dll.config`（除非您手动引用特定文件）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-03T09:16:45.970

为了克服连接字符串的问题，这里是技巧

1.  在您的类库中声明具有两个属性的模块，一个是setter，另一个是getter，并将它们公开。
    2.  在您的网站项目中，转到全局文件，并在会话启动和应用程序启动下调用您之前声明的 setter 属性，并为其分配位于您的 web.config 中的连接字符串，现在连接字符串将可用在网站的一般范围内，只要您的会话凭据未过期，该值就存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T12:38:51.473

将 connectionString 部分从库的 app.config 文件复制到 web.config 文件。根据需要将实际连接字符串从开发服务器更改为生产服务器。LINQ2SQL 用于获取连接字符串的 ConfigurationManager 类将在 web.config 文件中查找适当命名的连接字符串，如果存在则使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T14:26:57.810

如果您想为开发和生产设置不同的设置，请使用 Web 部署项目。[在这里](http://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&displaylang=en)下载。来自微软的描述：

> Visual Studio 2008 Web 部署项目提供了在 Visual Studio 2008 中构建和部署网站和 Web 应用程序的附加功能。此加载项提供了一个全面的 UI 来管理构建配置、合并以及使用 MSBuild 的构建前和构建后任务.

# .net - 如果文件已经打开，不要让excel打开文件

> ID：435283
> 
> 赞同：0
> 
> 时间：2009-01-12T12:29:22.460
> 
> 标签：.net, excel

我正在使用 Microsoft.Office.Interop.Excel.Workbooks.Open 方法 [http://msdn.microsoft.com/zh-tw/library/microsoft.office.interop.excel.workbooks.open(VS.80).aspx](http://msdn.microsoft.com/zh-tw/library/microsoft.office.interop.excel.workbooks.open(VS.80).aspx)

如果文件已打开，此方法会打开一个对话框窗口，询问用户是否要以只读方式打开或不打开（如果用户选择不打开，该方法返回 null）

我希望阻止此对话框并仅以读/写权限打开文件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T12:33:26.307

做

```
Application.DisplayAlerts = False 
```

帮助？

# jsf - Sun One Web 服务器 6.1 和 Tomahawk

> ID：435301
> 
> 赞同：0
> 
> 时间：2009-01-12T12:38:45.717
> 
> 标签：jsf, deployment, tomahawk, sunone

有谁知道哪个版本的 tomahawk 适合与 Sun One Webserver 6.1 一起使用？

在此先感谢，阿莱霍

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T15:42:09.833

好吧，这是 JSF 的需求表：

```
JSF       | 1.0   | 1.1   | 1.2 (JEE5) | 2.0
---------------------------------------------
Java      | 1.3   | 1.3   | 5          | *
JSP       | 1.2   | 1.2   | 2.1        | *
Servlet   | 2.3   | 2.3   | 2.5        | *
JavaBeans | 1.0.1 | 1.0.1 | 1.0.1      | *
JSTL      | 1.0   | 1.0   | 1.2        | *

*JSF 2.0 Public Review Draft requires JEE5 
```

Sun ONE Web 服务器文档这样说：

> Sun ONE Web Server 6.1 支持 Java Servlet 2.3 规范，包括 Web 应用程序和 WAR 文件（Web ARchive 文件）支持，以及 JavaServer Pages (JSP) 1.2 规范。

所以，我会使用[兼容性矩阵](http://wiki.apache.org/myfaces/CompatibilityMatrix)来检查可能的候选人。

# asp.net - ASP.NET：WebResource.axd 调用 404 错误：如何知道哪个程序集/资源丢失或负责？

> ID：435311
> 
> 赞同：25
> 
> 时间：2009-01-12T12:42:32.730
> 
> 标签：asp.net, assemblies, webresource.axd

我在 ASP.NET 3.5 (AJAX) Web 应用程序内的**特定 WebResource.axd**调用上收到**404 HTTP 状态错误**（未找到） 。我猜这个错误是因为 bin 文件夹/GAC 中缺少特定的引用程序集而引发的。但我不知道是哪个，因为请求资源的页面非常复杂（我使用的是第三方控件和 ASP.NET Ajax。）

 **是否可以从查询的加密“d”查询字符串参数中知道，例如：

```
.../WebResource.axd?d=... 
```

哪个程序集应该创建内容并且可能丢失？

**注意：**还有其他成功执行的 WebRequest.axd 调用。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-12T12:50:52.557

此问题的原因之一是注册的嵌入式资源路径不正确或资源不存在。确保将资源文件添加为[Embedded Resource](http://support.microsoft.com/kb/319292)。

Asp.net 使用[WebResourceAttribute](http://msdn.microsoft.com/en-us/library/system.web.ui.webresourceattribute.aspx)，您必须提供资源的路径。

资源文件需要作为嵌入式资源添加到项目中，并且它的路径将是完整的命名空间加上文件名。

因此，您在项目“MyAssembly”中有以下项目资源“my.js”，资源路径将是“MyAssembly.my.js”。

要检查 Web 资源处理程序未找到哪个文件，您可以解密 WebResource.axd url 上提供的哈希码。请参阅下面的示例以及如何执行此操作。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using System.Web;

namespace WebApplication1
{
    public partial class WebForm1 : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            byte[] encryptedData = HttpServerUtility.UrlTokenDecode("encoded hash value");

            Type machineKeySection = typeof(System.Web.Configuration.MachineKeySection);
            Type[] paramTypes = new Type[] { typeof(bool), typeof(byte[]), typeof(byte[]), typeof(int), typeof(int) };
            MethodInfo encryptOrDecryptData = machineKeySection.GetMethod("EncryptOrDecryptData", BindingFlags.Static | BindingFlags.NonPublic, null, paramTypes, null);

            try
            {
                byte[] decryptedData = (byte[])encryptOrDecryptData.Invoke(null, new object[] { false, encryptedData, null, 0, encryptedData.Length });
                string decrypted = System.Text.Encoding.UTF8.GetString(decryptedData);

                decryptedLabel.Text = decrypted;
            }
            catch (TargetInvocationException)
            {
                decryptedLabel.Text = "Error decrypting data. Are you running your page on the same server and inside the same application as the web resource URL that was generated?";
            } 
        }
    }
} 
```

*Telerik UI 的 ASP.NET AJAX 团队链接的原始代码示例：http: [//blogs.telerik.com/aspnet-ajax/posts/07-03-27/debugging-asp-net-2-0-web-resources-解密-the-url-and-getting-the-resource-name.aspx](http://blogs.telerik.com/aspnet-ajax/posts/07-03-27/debugging-asp-net-2-0-web-resources-decrypting-the-url-and-getting-the-resource-name.aspx)*

这应该返回 aspt.net 认为嵌入资源所在的 URL 路径。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-12-11T21:51:26.267

我只是在一个类似的问题上花了几个小时。由于 Diadistis 指出的精彩文章，我能够解密 WebResource url，并发现我的 WebResource 被翻译成错误的程序集指针，可以通过资源名称前面的垃圾识别。经过多次努力，我发现这是因为我在派生自另一个类的类中使用 Page.ClientScript.GetWebResourceUrl，该类派生于我的资源所在的程序集之外。令人困惑的是，我的类在同一个程序集中，不过派生的类不是。this.GetType() 参数许多文章状态是必须的，结果在我的情况下根本不是必须的。实际上，它需要替换为 typeof() 并且它有效！希望这可以防止其他人像我从这个臭虫那里得到同样的头痛。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-03-09T11:15:29.350

就我而言，404 错误的根源是运行 IIS 的机器的**日期和时间**错误（从过去开始）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T12:52:12.680

您的项目是否缺少任何参考资料？

是否有任何设置为 CopyLocal=False（与 Infragistics 或 GAC'ed refs 共同）的引用无法到达目的地？

诸如反射器或依赖项遍历器之类的实用程序会告诉您您的主程序集是否缺少任何不是立即显而易见的依赖项。

[global.asax 中的Application_Error](http://msdn.microsoft.com/en-us/library/24395wz3.aspx)处理程序是否有产生任何错误信息 (FileNotFoundExceptions) 的捕获？

您是否将[自定义错误](http://msdn.microsoft.com/en-us/library/h0hfz6fc.aspx)设置为“仅限远程”并从本地计算机浏览该站点？

# c++ - 好的或坏的 C++ 成语 - 纯粹用于构造函数/析构函数的对象？

> ID：435322
> 
> 赞同：9
> 
> 时间：2009-01-12T12:50:21.310
> 
> 标签：c++, idioms, raii

我有一些类除了在它们的构造函数/析构函数中什么都不做。这是一个例子

```
class BusyCursor 
{
  private:
    Cursor oldCursor_;

  public:

    BusyCursor()
    {
      oldCursor_ = CurrentCursor();
      SetCursor(BUSY_CURSOR);
    }
    ~BusyCursor()
    {
      SetCursor(oldCursor_);
    }
}

// example of use
    void DoSlowThing
    {
      BusyCursor busy;
      ... do something time-consuming  ...
    } 
```

我有点担心未来的可读性。我在这里是不是太“狡猾”了，变量（“忙”）从未在代码中实际使用过？一些静态分析工具是否可以建议将它们删除，或者这个习语是否足够普遍不用担心？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-12T12:55:30.973

这种技术非常常见，被称为设计模式：[资源获取即初始化 (RAII)](http://en.wikipedia.org/wiki/Resource_acquisition_is_initialization)。

我会毫不犹豫地使用这种设计模式。

使用这种设计模式进行编码要好得多，因为您将通过忘记重置光标或任何有问题的资源来避免错误。

如果您担心其他程序员可能不理解它，那么这些程序员应该受过更多的教育。始终努力以最无错误的方式编写代码，这样您和其他人就不可能在自己/自己的脚上开枪。

* * *

“一些静态分析工具可以建议将它们删除吗？”

*   没有静态分析工具会将此视为问题。
*   不会给出编译器警告
*   没有编译器优化会导致任何问题。

原因是因为创建了对象并调用了构造函数/析构函数。所以它不是一个未引用的变量。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-12T13:41:22.517

正如其他人所说，这是很好的 C++ 风格。为了提高可读性，我总是在此类仅限 RAII 的类前面加上`Scoped`（例如，`ScopedBusyCursor`），以便一目了然地清楚该类的目的是什么。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-12T13:54:35.330

就像其他人回答的那样，这是一个众所周知的良好 C++ 习语。

为了清楚地表明这些类只能在一个范围内使用，而不是在不同的范围之间移动，最好让它们不可复制。这可以通过添加未实现的私有复制构造函数和复制分配运算符来手动完成。更短且更易读的方法是从[boost::noncopyable](http://www.boost.org/doc/libs/1_37_0/libs/utility/utility.htm#Class_noncopyable)派生类：

```
#include <boost/noncopyable.hpp>
class BusyCursor : public boost::noncopyable // for scoped use only
{
    // ...
}; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-12T12:57:51.763

这是一个很好的成语，并且很常用。

它比任何替代方法都好，例如，即使您的*某些耗时的*代码抛出异常，`~BusyCursor`析构函数仍然会被调用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-12T13:42:46.493

可以说不使用这种模式是不好的习惯用法。当您不使用 RAII 时，您的代码最终看起来像这样：

```
void func() {
    Cursor oldCursor = CurrentCursor();
    SetCursor(BUSY_CURSOR);
    try {
        do_slow_stuff();
        SetCursor(oldCursor);
    } catch (...) {
        SetCursor(oldCursor);
        throw;
    }
} 
```

你真的认为在你的代码中乱扔垃圾更利于维护吗？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-12T12:59:48.717

没有理智的静态分析工具会建议删除该变量，因为它*已被*使用。它之所以有效，是因为它的构造函数和析构函数被调用。你应该是绝对安全的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-12T13:36:06.913

其他人已经提到这是经典的 RAII。我要补充的是，这是关于 C++ 最好的事情之一。很少有其他语言支持它，或者至少正确地支持它（甚至 C# 的 using 构造也没有那么好，因为负担仍然在客户端代码上 -[请参阅我的博客条目](http://www.levelofindirection.com/journal/2009/9/24/raii-and-readability-in-c.html)）。

它与 C++ 的联系如此紧密，以至于您应该确信任何阅读它的人都会熟悉它——如果不是的话，他们应该熟悉。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-12T13:14:44.443

我通常将其称为“守卫”。在我看来，它展示了 C++ 的最大优势之一（确定性资源处理）。这是我在使用垃圾收集语言工作时最怀念的事情之一。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-16T23:57:20.753

你也可以使用Andrei Alexandrescu 和 Petru Marginean 的[ScopeGuard](http://www.ddj.com/cpp/184403758)。您的示例将如下所示：

```
void DoSlowThing
{     
    Cursor oldCursor = CurrentCursor();
    SetCursor(BUSY_CURSOR);
    ON_BLOCK_EXIT(SetCursor, oldCursor);
    ... do something time-consuming  ...
} 
```

这使得一次性 RAII 类型的操作更容易，而无需为每个操作创建一个新类。但是，对于您的 Cursor 示例，由于它是一个您可能会重复使用多次的类，因此使用专用类可能会更好。

# ms-word - Aspose.Word 替代品

> ID：435323
> 
> 赞同：18
> 
> 时间：2009-01-12T12:50:42.527
> 
> 标签：ms-word

有谁知道好的 Aspose.Word 替代（或类似）产品？你能提到任何使用的优点/缺点吗？

我目前正在评估 Aspose.Word，虽然它的工作原理很吸引人，但它缺少一些我需要的功能。

更新：我们最终编写了自己的 DOCX 生成器。我们仍在使用 Aspose.Word 在需要时转换为 DOC/HTML。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-15T19:14:16.643

我们的团队正在使用[Docentric Toolkit 专业版](http://www.docentric.com/)。我们做出决定的最重要原因之一是它对于最多 5 名开发人员的团队来说相对实惠的价格。

该工具包适用于 MS Office 2007/2010/2013。在我们的场景中，报告在服务器上集中生成，使用我们定制开发的报告引擎，该引擎使用 Docentric api 调用。因为 Docentric 使用 OpenXML，所以不需要在服务器上安装 Word。

我们有数百个不同的模板，这些模板是普通的 Word 文档，使用占位符进行了增强，Docentric 在报告创建期间在运行时识别和填充数据。

我们广泛使用的其他功能是表格（包括嵌套的）、图像、图表、条件内容和页眉/页脚动态内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T12:58:25.163

我不知道它是否适合您的目的，但您可能想看看 SourceForge 上的 b2xtranslator 项目：

> [http://b2xtranslator.sourceforge.net/](http://b2xtranslator.sourceforge.net/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-02T16:26:43.540

[TX Text Control](http://textcontrol.com)有一个快捷版，但它没有完整版的所有功能。express 是免费的，我已经使用过了，如果您的唯一目的是创建一个文字处理器，它不会提供所有功能。像 Aspose.Words 一样，购买完整版真的很贵（2,398.00 美元！），而且在我看来，这是一个骗局。
利弊正在评估免费
版

*   免费版没有拼写检查
*   在免费版本中无法读取 .docx 或 .doc
*   免费版中没有页眉、页脚或可拖动的文本框（就像 Word 中的一样）

优点：

*   自由的
*   分页符
*   基本文档编辑功能

我们公司使用了一段时间，但厌倦了缺乏功能，最终放弃了它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T02:10:45.613

If Java is an option (or a preference), you could try [docx4j](http://dev.plutext.org)

# ruby - 使用 Ruby 自动化脚本打开 Firefox 浏览器

> ID：435328
> 
> 赞同：2
> 
> 时间：2009-01-12T12:51:41.010
> 
> 标签：ruby, firefox, automation

如何通过 Ruby（用于自动化脚本）打开 FireFox 浏览器？我用

```
 @browser = RSpecSeleniumHelper.connect_browser('/admin/', '*firefox') 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T13:10:29.977

您可以使用以下命令在 ruby​​ 中启动任何程序：

```
`firefox http://www.google.com`
or
system("firefox http://www.google.com") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-15T00:48:21.697

您可以使用 Watir，因为它也支持 Firefox： [http ://wtr.rubyforge.org/platforms.html](http://wtr.rubyforge.org/platforms.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-15T00:58:22.380

您可能需要检查 Selenium Remote Control 是否已启动，通常它在端口 4444 上运行。

```
java -jar selenium-server-xxx.jar 
```

那么你可以使用

```
@browser = Selenium::Client::Driver.new(
    :host => "localhost",
    :port => 4444,
    :browser => "*firefox", #*iexplore, *firefox3, *safari...
    :url => "http://www.google.com/",
    :timeout_in_second => 60)
@browser.start_new_browser_session 
```

希望对您有所帮助，您可以通过下载 Selenium RC 找到更多演示

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-13T14:13:11.877

我在运行这个程序时遇到了两个问题：

1.  如果您从 MacOS 运行 Ruby 应用程序，默认情况下命令 firefox 可能没有正确别名，因此可能会失败而不会在您的 Ruby 控制台上打印错误。

2.  如果您已经打开了一个 Firefox 实例，您将收到一条消息“关闭 Firefox - Firefox 的副本已经打开。一次只能打开一个 Firefox 副本。”

此代码解决了这两个问题：

```
system("open -a /Applications/Firefox.app/Contents/MacOS/firefox-bin http://www.google.com http://www.cpap.com") 
```

1.  open 的 -a 选项 使用指定的应用程序打开。
2.  文件路径列表对我有用。如果它不会为您加载，请先放下它并尝试纯“firefox”，然后尝试“/Applications/Firefox.app/Contents/MacOS/firefox”
3.  上面的示例显示了两个用空格分隔的 URL。您可以只使用一个 URL，也可以使用尽可能多的 URL 来遵循此模式。

# c# - 具有多个结果的 Linq to SQL 存储过程

> ID：435332
> 
> 赞同：2
> 
> 时间：2009-01-12T12:55:18.210
> 
> 标签：c#

我有一个从多个表中选择的存储过程

继承自DataContext的类中调用方法如下

[功能（名称=“dbo.BASE_Product_Retrieve”）]

```
 [ResultType(typeof(BASE_Product))]

    [ResultType(typeof(BASE_Product_Version))]

    [ResultType(typeof(BASE_ItemPrice))]

    [ResultType(typeof(BASE_VendorItem))]

    [ResultType(typeof(BASE_ProductAttachment))]

    [ResultType(typeof(BASE_ItemPrice_Version))]

    public IMultipleResults BASE_Product_Retrieves([Parameter(Name = "ProductId", DbType = "Int")] System.Nullable<int> productId, [Parameter(Name = "Version", DbType = "Int")] System.Nullable<int> version)
    {
        IExecuteResult result = this.ExecuteMethodCall(this, ((MethodInfo)(MethodInfo.GetCurrentMethod())), productId, version);
        return ((IMultipleResults)(result.ReturnValue));
    } 
```

当我从我的课堂上调用它时

var x=RetrieveProductList.GetResult < BASE_ItemPrice > ();

它给了我以下异常

结果中不存在所需的列“ItemPriceId”。

知道 ItemPriceId 是该表中存在的一个 clumn ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T12:59:51.883

你*到底*是如何使用它的？IIRC，您需要以正确的顺序访问网格（最终只是一个`IDataReader`）。

或者引用：“检索下一个结果作为指定类型的序列。”

另请参阅[MSDN](http://msdn.microsoft.com/en-us/library/bb534218.aspx)上的注释：

> 根据您对存储过程的了解，您必须使用 GetResult(TElement) 模式来获取正确类型的枚举数。

因此，如果您想要第三个网格，我希望您需要调用`GetResult`两次（使用适当的类型，然后丢弃它们）才能读取第三个网格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T13:09:16.017

从我有 RetrieveProductList 类型的 RetrieveProductList 的形式。

我将其称为如下 var x=RetrieveProductList.GetResult < BASE_ItemPrice > ();

此方法在我在表单中使用的类中

公共 IMultipleResults RetriveProducts((int ItemId, int Version)

```
 {
        return db.BASE_Product_Retrieves(ItemId, Version);
    } 
```

从DataContext继承的类中的调用方法如下

[功能（名称=“dbo.BASE_Product_Retrieve”）]

```
 [ResultType(typeof(BASE_Product))]

    [ResultType(typeof(BASE_ItemPrice))]

    [ResultType(typeof(BASE_VendorItem))]

    [ResultType(typeof(BASE_ProductAttachment))]

    public IMultipleResults BASE_Product_Retrieves([Parameter(Name = "ProductId", DbType = "Int")] System.Nullable<int> productId, [Parameter(Name = "Version", DbType = "Int")] System.Nullable<int> version)
    {
        IExecuteResult result = this.ExecuteMethodCall(this, ((MethodInfo)(MethodInfo.GetCurrentMethod())), productId, version);
        return ((IMultipleResults)(result.ReturnValue));
    } 
```

在调试时达到

var x=RetrieveProductList.GetResult < BASE_ItemPrice > ();

它给了我那个例外！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T13:33:04.360

我应用了您告诉我的内容，它以某种方式起作用，该异常不再存在，但现在的问题是它没有返回任何值，我使用了数据网格视图并将其数据源设置为

RetrieveProductList.GetResult < BASE_ItemPrice > ();

它返回列，但为空！！！！

# nhibernate - Nhibernate 中具有复合 ID 的意外代理对象

> ID：435342
> 
> 赞同：1
> 
> 时间：2009-01-12T13:00:50.150
> 
> 标签：nhibernate, null, proxy-classes, composite-key

我有一个使用复合 id 的数据结构（我不想将其更改为单个），除了多对一连接之外，一切都加载正常，如果连接为空，而不是将属性映射为 null，而是将其映射为空代理对象。我写了一个丑陋的工作（见吹）。有什么解决办法吗？

私有节点_Parent；

```
 public Node Parent
    {
        get
        {
            return this._Parent;
        }
        set
        {
            this._Parent = Proxy.Check<Node>(value);
        }
    }
internal static class Proxy
{
    public static T Check<T>(T obj) where T : PersistentObject
    {
        if (obj is NHibernate.Proxy.INHibernateProxy && obj != null)
        {
            try 
            {
                int id = obj.ID;
                return obj;             
            }
            catch //Proxy only object cant retrieve ID
            {
                return null;
            }
        }
        else
        {
            return obj;
        }
    } 
```

}

以映射文件开头

```
<class name="Node" table="Node">
    <composite-id>
        <key-property name="ID"/>
        <key-property name="VersionID"/>
    </composite-id> 
```

并通过

```
 <many-to-one name="Node" class="Node" >
        <column name="NodeID"/>
        <column name="VersionID" />
    </many-to-one> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-23T04:13:04.403

不完全确定这是否是这种情况的完美解决方案，但是当我在使用复合键的旧数据库时遇到同样的问题时，这解决了我的问题。

通过在链接上设置 not-found 忽略，NHibernate 会将空对象视为 null 而不是异常。当使用这种技术时，NHibernate 将执行一个单独的查询，因此可能会有小的性能损失，因为这基本上是急切加载对象。

您可以尝试直接加载对象而不是使用这种技术，但我感觉它会返回一个异常，因为它会期待一个对象（不是 null）。如果这不起作用，我建议在 NHibernate 论坛上发布一个问题，因为我绝对不是该领域的专家，但这对您来说可能是一个较小/不那么丑陋的工作。

例如：

```
<many-to-one name="Node" class="Node" not-found="ignore">
    <column name="NodeID"/>
    <column name="VersionID" />
</many-to-one> 
```

希望这可以帮助，

周杰伦

# nhibernate - 我们如何在 Cascade="Delete" 执行时执行自定义方法？

> ID：435346
> 
> 赞同：1
> 
> 时间：2009-01-12T13:02:29.383
> 
> 标签：nhibernate, mapping, cascade

例如，我有两个实体，“RealEstate”和“Picture”。RealEstate 拥有一系列图片。在映射文件中，RealEstate 中有一个用于图片的包，级联是“删除”。

如果您删除房地产，所有相关图片都将被删除。但是有什么方法可以执行自定义方法从网络服务器中删除图片。

我通过分配来做到这一点`cascade="none"`，当我删除房地产时，我首先检查是否有任何与之相关的图片，如果有，我会调用`DeletePicture()`它的方法。

我很好奇你在这种情况下会怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T14:05:33.390

您可以编写一个[拦截器](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/manipulatingdata.html#manipulatingdata-interceptors)并实现将在删除图片时执行的**OnDelete方法。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T19:20:41.007

如果您使用的是 nhibernate 2.0 ，那么新的更好的方法是：使用事件。

关于[nhibernate 2.0 事件的文章](http://www.codinginstinct.com/2008/04/nhibernate-20-events-and-listeners.html)

# javascript - 什么是 jQuery 入门的好资源？

> ID：435347
> 
> 赞同：7
> 
> 时间：2009-01-12T13:02:30.600
> 
> 标签：javascript, jquery, resources

一般来说，jQuery 和 JavaScript 对我来说是新的领域。

有什么好的资源可以让我启动和运行。

我对页面操作特别感兴趣——例如以编程方式移动元素。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-12T13:04:45.463

好吧，[docs.jquery.com](http://docs.jquery.com/)将是一个好的开始（尤其是[操作](http://docs.jquery.com/Manipulation)部分）。通常有很多很好的例子以及文档。

我选择了[jQuery in Action](http://www.manning.com/bibeault/)，非常值得一读。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T13:07:36.067

docs.jquery.com 是显而易见的选择，但是那里有一些很棒的教程[jQuery 对于设计师](http://jqueryfordesigners.com/)来说是最好的之一。

但是，如果您想真正快速入门并动手学习（我建议），我强烈推荐 firebug 控制台和[Visual jQuery](http://visualjquery.com/)并开始修补学习恕我直言的最佳方法，祝您好运！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T13:11:02.267

我推荐[学习 jQuery](https://rads.stackoverflow.com/amzn/click/com/1847192505)和[jQuery 参考](https://rads.stackoverflow.com/amzn/click/com/1847193811)。第一本书很好地让你从很多例子开始，尤其是关于选择各种元素。第二个有利于快速查找属性或方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-12T13:47:09.260

[Visual jQuery](http://visualjquery.com/)是浏览 jQuery 文档的一种更愉快的方式...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T13:11:32.033

这里有一个很好的备忘单：[http ://www.gscottolson.com/jquery/jQuery1.2.cheatsheet.v1.0.pdf](http://www.gscottolson.com/jquery/jQuery1.2.cheatsheet.v1.0.pdf)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T13:12:48.520

您可以订阅 [safaribooksonline的 10 天免费试用](http://www.safaribooksonline.com)

在试用期结束之前，您应该能够阅读 jQuery in Action 一书。到那时你应该知道这本书是否好，它应该让你熟悉 jQuery。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T13:57:32.533

我发现替代资源页面 ( [http://docs.jquery.com/Alternative_Resources](http://docs.jquery.com/Alternative_Resources) ) 上的备忘单非常有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-12T17:40:26.170

[Web Designers Wall](http://www.webdesignerwall.com/tutorials/jquery-tutorials-for-designers/)有很好的介绍。

# java - 如何使用 aspectJ 快速修改已编译的 java 类行为

> ID：435348
> 
> 赞同：3
> 
> 时间：2009-01-12T13:02:48.867
> 
> 标签：java, aop, aspectj

如何使用 aspectJ 为某些 java 应用程序临时添加功能？像创建方面，用ajc编译，使用java命令和一些额外的开关来应用方面？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T19:30:21.613

我相信问题是你能在运行时启用/禁用 Aspectj 编织的代码吗？

我不知道 AspectJ 中是否有内置机制，但我相信您可以使用条件语句将代码包装在 Aspect 中。然后您需要做的就是在运行时打开或关闭该代码

例如

```
// HelloWorld.java
public class HelloWorld {
    public static void say(String message) {
        System.out.println(message);
    }

    public static void sayToPerson(String message, String name) {
        System.out.println(name + ", " + message);
    }
}

// PoliteHelloWorld.java
public aspect PoliteHelloWorld {
    pointcut callSayMessage() : call(public static void HelloWorld.say*(..));
    before() : callSayMessage() {
        if( is_aspectj_turned_on_this_run() ) {
            System.out.println("Good day!");
        }
    }
    after() : callSayMessage() {
        if( is_aspectj_turned_on_this_run() ) {
            System.out.println("Thank you!");
        }
    }
} 
```

您想如何实现“ `is_aspect_j_turned_on_this_run()`”取决于您（可能由命令行参数或用户输入设置？）

有一种更好的方法，即纠正一个处理您希望在运行时禁用的方面的方面。这个新的额外方面将只负责检查您的“ `is_aspect_j_turned_on_this_run()`”。有关此更清洁方法的详细信息，请参见[此处](http://dev.eclipse.org/mhonarc/lists/aspectj-users/msg02142.html)

我不知道是否有比这两种方法更好的方法（很可能），但这至少允许您在运行时根据需要多次打开和关闭它，而无需重新编译。

# iphone - 如何使用 afconvert 从 .caf 转换为 .mp3 格式？

> ID：435349
> 
> 赞同：23
> 
> 时间：2009-01-12T13:03:46.103
> 
> 标签：iphone, core-audio

我正在使用 afconvert 命令行实用程序将音频文件从格式转换`.caf`为`.mp3`格式。我用过`afconvert`：

```
afconvert -f 'MPG3 ' -d '.mp3' -v input.caf output.mp3 
```

但这给了我以下错误：

```
Input file: input.caf, 19008 frames
Error: ExtAudioFileSetProperty ('cfmt') failed ('fmt?') 
```

我还尝试了以下方法：

```
afconvert -f 'MPG3 ' -d LEI32@44100 -v input.caf  output.mp3 
```

这也给了我错误：

```
Input file: min.caf, 19008 frames
Error: ExtAudioFileCreateWithURL failed ('fmt?') 
```

我无法弄清楚为什么这是错误的。

有人可以指导我解决这个问题吗？

预先感谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-21T23:39:54.113

你应该检查这个，

```
afconvert -f mp4f -d aac -b 128000   input.caf output2.mp4 
```

这样您就可以将 CAF 文件转换为 MPEG-4 格式。

阅读：Apple 不随 Mac OS X 提供任何形式的 MP3 编码器，除了 iTunes 中内置的编码器。来源： http: [//lists.apple.com/archives/coreaudio-api/2005/Jul/msg00182.html](http://lists.apple.com/archives/coreaudio-api/2005/Jul/msg00182.html)

如果您需要编码 mp3 Mp3 编码器示例，您应该使用 3rd 方编码器：lame 编码器或 ffmpeg :) 祝你好运。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-12T20:05:38.850

您可以使用 LAME 编码器（在 Mac 上，运行`brew install lame`安装它）。

首先，您必须将 caf 转换为 wav（我没有机会检查 LAME 是否支持 caf 作为输入，但它肯定支持 wav）。然后运行

```
lame --alt-preset cbr 128 sample.wav 
```

这将创建具有 128 kbps 恒定比特率的 mp3 文件。
LAME 有很多设置，您可以根据需要选择 mp3 参数。

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2009-01-31T21:50:49.407

try this:

```
afconvert -f mp4f -d aac -v input.caf output.mp3 
```

I know it's not exactly mp3, but I couldn't get around that same error you are getting, so I tried mp4f and it worked.

# c# - 在 64 位版本服务器中从 C# 读取 Excel 文件

> ID：435350
> 
> 赞同：2
> 
> 时间：2009-01-12T13:04:10.457
> 
> 标签：c#, 64-bit

从 C# 读取 excel 文件在 32 位版本服务器中运行良好。它**不适**用于**64 位版本**（Windows 2003 服务器），因为**64 位版本**不支持 excel 数据连接 dll 。还有其他选择吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T13:14:25.753

在您的项目属性中，将目标平台从“任何”设置为“x86”。

**细节：**

在 Windows x64 中，进程可以作为 32 位或 64 位进程启动。64 位进程只能加载 64 位 dll，32 位进程只能加载 32 位 dll。

如果您的 .Net 应用程序的平台目标（例如在项目属性中指定）设置为“任何 CPU”，则中间代码将根据目标平台编译为 32 位或 64 位代码，即在 x64 系统上，64 位代码将被生成。

因此，代码无法再加载 32 位 dll。

如果您的代码加载非托管程序集，则应始终明确指定目标平台

# linker - 链接共享库时限制符号的可见性

> ID：435352
> 
> 赞同：54
> 
> 时间：2009-01-12T13:05:07.863
> 
> 标签：linker, shared-libraries, gnu, linker-scripts

某些平台要求您向链接器提供共享库的外部符号列表。但是，在大多数 unixish 系统上，这不是必需的：默认情况下，所有非静态符号都可用。

我的理解是 GNU 工具链可以选择性地将可见性限制为明确声明的符号。使用 GNU ld 如何实现这一点？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-01-17T07:51:03.153

GNU`ld`可以在 ELF 平台上做到这一点。

以下是如何使用链接器版本脚本执行此操作：

```
/* foo.c */
int foo() { return 42; }
int bar() { return foo() + 1; }
int baz() { return bar() - 1; }

gcc -fPIC -shared -o libfoo.so foo.c && nm -D libfoo.so | grep ' T ' 
```

默认情况下，所有符号都被导出：

```
0000000000000718 T _fini
00000000000005b8 T _init
00000000000006b7 T bar
00000000000006c9 T baz
00000000000006ac T foo 
```

假设您只想导出`bar()`和`baz()`. 创建一个“版本脚本” `libfoo.version`：

```
FOO {
  global: bar; baz; # explicitly list symbols to be exported
  local: *;         # hide everything else
}; 
```

将其传递给链接器：

```
gcc -fPIC -shared -o libfoo.so foo.c -Wl,--version-script=libfoo.version 
```

观察导出的符号：

```
nm -D libfoo.so | grep ' T '
00000000000005f7 T bar
0000000000000609 T baz 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-01-12T23:56:33.463

我认为最简单的方法是添加`-fvisibility=hidden`到 gcc 选项并明确地在代码中公开某些符号的可见性（通过`__attribute__((visibility("default")))`）。[请参阅此处](https://gcc.gnu.org/onlinedocs/gcc/Code-Gen-Options.html)的文档。

可能有一种方法可以通过 ld 链接器脚本来实现，但我对此知之甚少。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-10-12T23:04:51.937

为调用任何导出的函数或使用任何导出的全局变量而生成的代码比未导出的代码效率低。涉及到一个额外的间接级别。这适用于任何*可能在**编译*时导出的函数。gcc 仍会为稍后由链接描述文件导出的函数产生额外的间接。因此，使用可见性属性将产生比链接描述文件更好的代码。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-10-23T16:39:30.007

似乎有几种方法可以在 GNU/Linux 上管理导出的符号。根据我的阅读，这些是3种方法：

*   源代码注释/装饰：
    *   方法一：`-fvisibility=hidden`配合`__attribute__((visibility("default")))`
    *   方法 2（从 GCC 4 开始）：`#pragma GCC visibility`
*   版本脚本：
    *   方法 3：版本脚本（又名“符号映射”）传递给链接器（例如`-Wl,--version-script=<version script file>`）

我不会在这里讨论示例，因为它们大部分都被其他答案所涵盖，但这里有一些关于我脑海中不同方法的注意事项、优缺点：

*   使用带注释的方法允许编译器稍微优化代码（少一个间接）。
*   如果使用带注释的方法，那么也考虑使用`strip --strip-all --discard-all`.
*   带注释的方法可以为内部功能级单元测试添加更多工作，因为单元测试可能无法访问符号。这可能需要构建单独的文件：一个用于内部开发和测试，另一个用于生产。（从单元测试纯粹主义者的角度来看，这种方法通常不是最佳的。）
*   使用版本脚本会失去优化，但允许符号版本控制，这似乎不适用于带注释的方法。
*   假设代码首先构建到存档 (.a) 文件中，然后链接到 DSO (.so) 中，则使用版本脚本允许进行单元测试。单元测试将与 .a 链接。
*   Mac 不支持版本脚本（至少在使用 Mac 提供的链接器时不支持，即使编译器使用 GCC 也是如此），因此如果需要 Mac，请使用带注释的方法。

我确定还有其他人。

以下是一些我认为有帮助的参考资料（附有示例）：

*   [http://blog.fesnel.com/blog/2009/08/19/hiding-whats-exposed-in-a-shared-library/](http://blog.fesnel.com/blog/2009/08/19/hiding-whats-exposed-in-a-shared-library/)
*   [https://accu.org/index.php/journals/1372](https://accu.org/index.php/journals/1372)
*   [https://akkadia.org/drepper/dsohowto.pdf](https://akkadia.org/drepper/dsohowto.pdf)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-27T22:14:15.590

如果您使用的是 libtool，还有另一种选择，类似于 Employed Russian 的回答。

使用他的例子，它会是这样的：

```
cat export.sym
bar
baz 
```

然后使用以下选项运行 libtool：

```
libtool -export-symbols export.sym ... 
```

请注意，使用 -export-symbols 时，默认情况下不会导出所有符号，仅导出 export.sym 中的符号（因此 libfoo.version 中的“local: *”行实际上隐含在此方法中）。

# sql-server - SQL Server 2005 Express 中的全文索引比较

> ID：435353
> 
> 赞同：2
> 
> 时间：2009-01-12T13:06:12.980
> 
> 标签：sql-server, sql-server-2005, full-text-search

如何将一条记录的文本字段与 SQL Server 中的所有其他记录进行比较以返回，例如，前 5 条最相关的记录？

我所追求的功能的一个示例是 Wordpress 的各种相关帖子插件，它们生成与当前正在查看的帖子相关的帖子的链接列表。

干杯，伊恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T16:17:32.700

感谢这些回复。我熟悉引用的函数，但我不确定它们是否符合我的需要。例如：

```
SELECT P.id, 'Product' AS Type, FT.rank, C.url + '/' + P.url AS url, longTitle, shortTitle, P.description
FROM Products P
     INNER JOIN CONTAINSTABLE (Products, (longTitle, shortTitle), '"my text content"') AS FT ON P.id = FT.[key]
     LEFT JOIN Product_Categories PC ON P.id = PC.productID
     LEFT Join Categories C ON C.id = PC.categoryID
WHERE [primary] = 1
ORDER BY rank DESC 
```

仅返回具有确切短语“我的文本内容”的行 - 我需要仅返回“文本”的行，但排名较低。如果我按如下方式更改查询：

```
SELECT P.id, 'Product' AS Type, FT.rank, C.url + '/' + P.url AS url, longTitle, shortTitle, P.description
FROM Products P
     INNER JOIN CONTAINSTABLE (Products, (longTitle, shortTitle), '"my" or "text" or "content"') AS FT ON P.id = FT.[key]
     LEFT JOIN Product_Categories PC ON P.id = PC.productID
     LEFT Join Categories C ON C.id = PC.categoryID
WHERE [primary] = 1
ORDER BY rank DESC 
```

我得到了更多的行，但是包含所有三个单词的行的排名似乎并没有明显高于包含 1 个单词的行。

还有什么想法吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T17:04:07.443

您需要使用 CONTAINSTABLE ，这将返回一个可用于排序的 RANK 列。

```
SELECT TOP 5 [Key] FROM CONTAINSTABLE ([YourFullText],'SomethingToSearch')
ORDER BY [RANK] DESC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T15:55:15.330

给你，来自优秀的罗伯特凯恩：

[http://arcanecode.com/2007/06/28/getting-started-with-sql-server-2005-full-text-searching-part-3-%E2%80%93-using-sql/](http://arcanecode.com/2007/06/28/getting-started-with-sql-server-2005-full-text-searching-part-3-%E2%80%93-using-sql/)

# binsor - Binsor：如何使用其元素是容器中的组件的字典

> ID：435366
> 
> 赞同：0
> 
> 时间：2009-01-12T13:13:17.207
> 
> 标签：binsor

任何想法如何配置其元素是组件的 SortedList 在 binsor 中的容器上注册。

```
Crud:ICrud
 {                
   public SortedList<string, ICrudTransfer> Proxies
   {
   get { return _proxies;}
   set { _proxies = value; }
   }                    
 } 
```

我想做类似的事情：

```
 component ‘proxy1′, ICrudTransfer
 component ‘proxy2′, ICrudTransfer

 _proxies = SortedList[of string, ICrudTransfer]()
 _proxies['url1']=@proxy1
 _proxies['url2']=@proxy2

 component ’service’, ICrud, Crud:
   Proxies = _proxies 
```

但它不起作用

我想使用诸如属性、数组或列表之类的。这样可行

```
 component ’service’, ICrud, Crud:
  CrudProxy = @proxy3
  CrudProxies = (@proxy1 , @proxy2) 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-20T16:40:35.700

解决方案：

```
 public class TestClass:ITestClass
    {
        IDictionary<string, IClass1> _dictGen = null;
        IList<IClass1> _listGen = null;

        public IList<IClass1> ListGeneric
        {
            get { return _listGen; }
            set { _listGen = value; }
        }

        public IDictionary<string, IClass1> DictionaryGeneric
        {
            get { return _dictGen; }
            set { _dictGen = value; }
        }
    }

component 'c1', IClass1, Class1
component 'c2', IClass1, Class1

component 'd', ITestClass, TestClass:
  DictionaryGeneric = {key1:@c1,key2:@c2}
  ListGeneric = (@c1,@c2) 
```

没有泛型（IList 或 IDictionary）似乎不起作用。

# version-control - 如何恢复 CVS 中的重大变化？

> ID：435368
> 
> 赞同：28
> 
> 时间：2009-01-12T13:13:25.680
> 
> 标签：version-control, cvs, revert

我的一位同事完全弄乱了我们主要 CVS 存储库中目录的内容。我只需要将整个模块恢复到去年底的状态即可。请问执行此操作的 CVS 命令是什么？

他已经添加和删除了数百个文件，因此简单的“从旧的签出和提交中复制文件”是不够的。

我有 RTFM 和 STFW，我试过这个：

```
cvs co modulename  # Note no -P option
cvs up -jHEAD -jMAIN:2008-12-30 modulename 
```

但这不起作用 - 他创建的新文件被删除，但旧文件和目录不会复活。（我没有犯）。

我可能可以为此编写一个 shell 脚本，但这个功能肯定已经在 CVS 中了吗？

更新：一些澄清：

*   我可以在特定日期对模块进行*本地结帐。*问题是如何将其恢复到 CVS 中。

*   我确实有备份，但使用像 CVS 这样的修订控制系统的重点是它应该很容易获得任何历史状态。下次发生这种情况时，我可能没有足够的运气进行备份（例如，每天都有备份，所以我可能会失去一天的工作）。

*   我知道 CVS 已经过时了，我们应该转向更新的东西。但是在拥有大量基于 CVS 的工具（检查和构建脚本、每晚构建服务器等）的大型团队中，这种移动的时间成本是相当可观的。（评估、更新脚本、测试、迁移、培训、浪费开发人员时间、并行维护两个系统，因为旧分支仍然需要 CVS）。因此，这必须由管理层计划和安排。

更新#2：我要开始赏金了。 **要获得赏金资格，您必须解释如何使用普通 CVS 命令恢复，而不是使用 hacky shell 脚本。**

更新#3：服务器是[CVS 1.12.13](http://www.nongnu.org/cvs/)。访问是通过 pserver。我可以在 Linux PC 上使用相同版本的 CVS，或者在 Windows 上使用[CVSNT 2.0.51d](http://en.wikipedia.org/wiki/CVSNT)客户端。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-25T04:05:47.177

实际上，您最初的方法非常接近解决方案。问题是，基于日期的加入不能正确处理删除的文件和目录。您需要先为要加入的代码库设置一个标签：

```
mkdir code_base1 && cd code_base1
cvs co -D "2008-12-30" modulename
cvs tag code_base_2008_12_30 
```

现在进行基于标签的连接，减去从现在到 2008-12-30 之间的所有更改：

```
cd .. && mkdir code_base2 && cd code_base2
cvs co modulename
cvs update -d -j HEAD -j code_base_2008_12_30  # use -d to resurrect deleted directories 
```

比较code_base1 和code_base2 的内容。除了 CVS 元信息之外，它们应该是相同的。最后将 2008 年 12 月 30 日的代码作为新的 HEAD 提交：

```
cvs commit -m "Revert all changes this year" 
```

* * *

请注意，像这样标记您希望加入的代码将不起作用，因为 rtag 在使用 -D 时也无法正确处理已删除的文件和目录：

```
cvs rtag -D "2008-12-30" code_base_2008_12_30 modulename 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T21:37:45.333

CVS 有几个问题，而您遇到了这样的问题。

1.  CVS 是面向文件的，没有变更集或快照的概念。这意味着您想要还原的更改有点难以处理。提交在给定目录内是原子的，而不是在外部。

2.  目录没有版本控制。这意味着空目录将被删除（如果您使用 更新 `-P`）并且您必须指定`-d`在结帐/更新时创建它们。

因此，要回答您的问题，日期可能是唯一的处理方法，因为您没有使用标签来创建一些穷人版本的变更集。

我对备份的评论是，从备份中恢复整个 repo 可能比尝试纠正 CVS 不擅长的事情更容易。

我会鼓励您——但这是另一个主题——尽快更改版本控制。相信我，我在[FreeBSD 项目](http://www.freebsd.org/)中与 CVS 打交道已经有很长一段时间了，并且很快就知道 CVS 是多么可恨……请参阅[此处](http://www.keltia.net/vcs)了解我对版本控制软件的一些看法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T18:34:58.557

我相信您的第二个命令也应该是结帐，而不是更新。我不能用逻辑来证明这一点，因为在 CVS 的世界中没有逻辑，但它对我有用。试试这个：

```
cvs co -P modulename
cvs co -P -jHEAD -jMAIN:2008-12-30 modulename 
```

如果您要恢复 HEAD 以外的分支，例如 X，请在两个命令中传递 -rX 参数：

```
cvs co -P -rX modulename
cvs co -P -rX -jHEAD -jMAIN:2008-12-30 modulename 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T13:59:15.417

我仍然有兴趣知道是否有更简单的方法。（肯定有更简单的方法）。我最终做的是，在使用 bash 的 Linux PC 上：

```
# Get woking copy we're going to change
cd ~/work
rm -rf modulename
cvs up -dP modulename
cd modulename

# Remove all files
find . -name CVS -prune -o -type f -print | xargs cvs rm -f

# Get the old revision
cd ~
mkdir scratch
cd scratch
cvs -q co -D 2008-12-31 modulename
cd modulename

# Copy everything to the working dir and do "cvs add" on it
find . -name CVS -prune -o -type f -print | \
    xargs tar c | \
    (cd ~/work/modulename && tar xv | \
    xargs cvs add)

# Check everything is OK before we commit
cd ~/work/modulename
cvs -nq up

# it gave me an error on readme.txt because I'd deleted and then added it, so:
mv readme.txt x # save good rev
cvs add readme.txt # resurrect the bad rev
mv x readme.txt # clobber file with good rev

# Commit it
cvs commit -m "Revert all changes this year"

# Delete now-empty directories
cvs -q up -dP

# Double-check everything is back how it was
diff -ur -xCVS ~/scratch/modulename ~/work/modulename 
```

然后我发现仍然存在差异 - 我的同事添加了包含空格的文件名，而上述过程没有删除这些文件名。我不得不单独删除这些。（我应该使用`find ... -print0`而不是`-print`，并将`-0`参数传递给`xargs`。我只是没有意识到有带空格的文件。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-28T02:18:09.743

你可以看看cvsps。去谷歌上查询。

此外，使用 quilt（或 Andrew Morton 的补丁脚本，这是 quilt 最初的样子）和 cvsps，可以得到非常接近的变更集。

见[http://geocities.com/smcameron/cvs_changesets.html](http://geocities.com/smcameron/cvs_changesets.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T13:15:15.783

您是否尝试过使用该`-d`选项？（建立子目录）

据我记得，它是隐含的 for `cvs co`，但不是 for `cvs up`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T13:29:22.323

根据[http://www.astro.ku.dk/~aake/MHD/docs/CVS.html](http://www.astro.ku.dk/~aake/MHD/docs/CVS.html)，您需要以下内容：

```
cvs update -D "30 Dec 2008 23:59" 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-12T22:40:41.493

如果您有存储库的备份（服务器上的实际 RCS 文件，例如在磁带上），您可以将 CVS 服务器上的文件夹恢复到之前的状态。在执行此操作之前不要忘记停止 CVS 服务器（然后重新启动它）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-14T01:56:34.047

大问题，没有完整的答案，只是关于处理文件名中空格的脚本的提示。

代替

```
find ... | xargs tar c - | ... 
```

试着把

```
find ... | perl -e '@names = <>;' -e 'chomp @names;' -e 'system( "tar", "c", "-", @names);' | ... 
```

这样，您的存档创建（或类似操作）将不会受到名称中空格的影响，在调用 tar 之前会跳过 shell argv 解析。

还有一件事，如果它确实有效：如果有一个 CVS 到 SVN 实用程序，请使用它（我假设这样的实用程序会从“CVS 阁楼”中提取已删除的文件），*如果*它及时保存每一刻作为项目级别的检查点（因为 SVN 这样做，与 CVS 不同），使用 SVN 来获取正确的时间。很多如果...

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-08-19T17:34:50.450

如果您或您的同事对 git 感到满意，您可以使用它`git cvsimport`来创建一个镜像 CVS 存储库的 git 存储库。在 git 中恢复提交/变更集是微不足道的（使用`git revert`）。然后，您可以使用`git cvsexportcommit`将还原提交发送到 CVS。

这听起来可能过于复杂，但根据我的经验`git cvsimport`，`git cvsexportcommit`一旦你完成了所有设置，工作就会非常好。即使项目仍在使用 CVS，您最终也将获得 git 的所有功能。

# ruby-on-rails - Rails 2.2 中的会话问题“User#register 中的 ActionController::InvalidAuthenticityToken”

> ID：435373
> 
> 赞同：0
> 
> 时间：2009-01-12T13:15:02.510
> 
> 标签：ruby-on-rails, session

我正在阅读和学习这本非常酷的书 Railspace - Building Social Networking sites。

我什么都懂，但我被会话部分困住了。我真的很想把它放在我的腰带上，并希望得到任何帮助！

好的，这是我得到的错误：

```
 ActionController::InvalidAuthenticityToken in User#register

    No :secret given to the #protect_from_forgery call.  Set that or use a session store capable of generating its own keys (Cookie Session Store).

    Extracted source (around line #2):

    1: <h2>Register</h2>
    2: <% form_for :user do |form| %>
    3:   
    4:   <fieldset>
    5:     <legend>Enter Your Details</legend>

d:/Ruby/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/request_forgery_protection.rb:115:in `form_authenticity_token'
(eval):2:in `send'
(eval):2:in `form_authenticity_token'
app/views/user/register.html.erb:2 
```

我的 register.html.rb（或 register.rhtml）文件如下所示：

```
 # Your secret key for verifying cookie session data integrity.
  # If you change this key, all old sessions will become invalid!
  # Make sure the secret is at least 30 characters and all random, 
  # no regular words or you'll be exposed to dictionary attacks.
  config.action_controller.session = {
    :session_key => '_rails_space_session',
    :secret      => '85b34bcc08e24fe0988c46e70c5f38e6a1b689be0a919e75ad433048e638678bae3df444bf2065327be5ebd30c099610e179e8461a5318509df584883d456ff3'
  }

  # Use the database for sessions instead of the cookie-based default,
  # which shouldn't be used to store highly confidential information
  # (create the session table with "rake db:sessions:create")
  config.action_controller.session_store = :active_record_store 
```

我已经运行了命令：

```
rake db:sessions:create 
```

^上面的命令简单地生成了一个 Active Record 类 CreateSessions（够简单吧？）

我需要在这里做什么才能摆脱这个讨厌的小错误？我如何禁用秘密问题（我已经尝试过但还没有运气）;-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T13:32:57.730

更新 => [已解决] 发生的事情是当我运行 rake 时

`db:create:sessions`命令它正在向我的数据库的会话表中添加一个字符串。我删除了它，然后重新启动了 Mongrel，瞧！

我仍然有点困惑的是，当我删除 CreateSessions < ActiveRecord::Migration 文件并重新运行它时，`rake db:create:sessions`它没有将会话字符串添加到会话表中。

我还得想办法解决这个问题......

# c# - C#清除ListView中的所有项目

> ID：435379
> 
> 赞同：30
> 
> 时间：2009-01-12T13:18:50.613
> 
> 标签：c#, listview

我尝试清除我的列表视图，但清除方法不起作用：

```
myListView.Items.Clear(); 
```

这行不通。当我在这一行设置断点时，该行被执行，但我的列表视图不为空。怎么会？？

我通过将它的数据源设置为数据表来填充我的列表视图。

我现在的解决方案是将数据源设置为空数据表。

我只是想知道为什么 clear 不做这个把戏？

我使用母版页。这是按下按钮时内容页面的一些代码。SearchTitle 方法填充 ListView。

相关代码：

```
 protected void Zoek()
    {
        // Clear listbox
        ListView1.DataSource = new DataTable();
        ListView1.DataBind();

        switch (ddlSearchType.SelectedValue)
        {
            case "Trefwoorden":
                SearchKeyword();
                break;
            case "Titel":
                SearchTitle();
                break;
            case "Inhoud":
                SearchContent();
                break;
        }
    } 
```

填充 ListView 的方法

```
 private void SearchTitle()
    {
        // Make panel visible
        pnlResult.Visible = true;
        pnlKeyword.Visible = false;

        Search Search = new Search(txtSearchFor.Text);
        ListView1.DataSource = Search.SearchTitle();
        ListView1.DataBind();
    } 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-12T14:14:43.683

怎么样

```
DataSource = null;
DataBind(); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-01-12T13:38:24.427

试试这个 ...

```
myListView.DataSource = null;
myListView.Items.Clear(); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-17T07:12:33.993

我对此进行了搜索，我正在使用 WPF c#。以防万一您也来这里寻找 WPF 解决方案，请使用以下内容：

yourlistview.ItemsSource = null;

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-12T13:41:37.260

我的猜测是这`Clear()`会导致发送一个`Changed`事件，这反过来又会触发从数据源自动更新列表视图。所以这是一个功能，而不是一个错误 ;-)

你试过`myListView.Clear()`代替`myListView.Items.Clear()`吗？也许这样效果更好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-03-03T16:44:54.190

不要理会 Clear()。只需这样做： ListView.DataSource = null; ListView.DataBind();

关键是databind()；每次都为我工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-10-27T20:37:57.330

出现问题是因为您试图清除整个列表框。只需使用 listView1.Items.Clear();

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-03-22T19:45:32.210

```
listView.Items.Clear()
listView.Refresh() 
```

/e 由于缺乏解释而更新。很多时候，如果紧随其后的事件/方法，Clear() 是不够的。最好在 Clear() 之后使用 Refresh() 更新视图，以便即时反映 listView 的清除情况。无论如何，这已经解决了我的相关问题。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-10-18T20:32:24.560

这有点晚了，但这至少对我有用 UWP

```
myListView.ItemsSource = null; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-11-17T14:27:14.210

试试这个：

```
myListView.ItemsSource = new List< DictionaryEntry >(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-12T14:19:33.907

我建议从基础数据表中删除行，或者如果您不再需要数据表，请将数据源设置为空。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-12T14:23:46.037

可能您的代码有效，但在您清除它后它会在某个地方反弹。确保不是这种情况。如果你提供一些代码会更有帮助。你在哪里设置你的数据源？你在哪里数据绑定？你在哪里清理清单？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-09-08T09:10:16.643

只需使用 clear 方法就像一种魅力。ListView1.Items.Clear() 我认为如果它不起作用，它可能是您放置此代码的位置。也可以尝试使数据源无效。

# c# - 如何在 web.config 之外创建连接字符串

> ID：435380
> 
> 赞同：1
> 
> 时间：2009-01-12T13:19:06.680
> 
> 标签：c#, asp.net, visual-studio, web-config

想一想，是否可以在 ASP.NET 的 web.config 之外创建连接字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T13:36:43.120

可能您正在寻找[configSource](http://stevenharman.net/blog/archive/2007/06/07/tip-put-connection-strings-in-their-own-configuration-file.aspx)？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T13:31:07.907

是的，您可以将它存储在任何地方，它只是文本...... web.config 只是一个 XML 文档，用于存储有关您的应用程序的配置设置。您可以轻松地创建另一个 XML 文件或文本文件并从那里读入。您只是无法使用：

```
ConfigurationManager.ConnectionStrings[].ConnectionString 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-08T17:41:34.627

您可以通过使用 .udl 文件来创建连接字符串。

UDL 文件创建：

1.  右键单击桌面或要在其中创建文件的文件夹。
2.  选择新建，然后选择文本文档。
3.  为文本文档指定任何带有 .udl 扩展名的名称（必须在文件夹选项中启用“显示文件扩展名”）。
4.  将弹出一个窗口警告“如果您更改文件扩展名，该文件可能会变得不可用。您确定要更改它吗？” 选择是。
5.  您现在已经成功创建了一个 UDL 文件。

现在您需要根据您的要求实现 .udl 文件中的设置。提供了一个视频教程，向您解释使用 .udl 文件为 MS SQL Server 创建连接字符串的整个过程。

[http://visiontechno.net/studymats/udlcreation.html](http://visiontechno.net/studymats/udlcreation.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-03T04:02:03.780

如果是 MSSQL 服务器，您可以使用以下内容

```
string connectionString = "Your Connection string"  

using (SqlConnection con = new SqlConnection(connectionString))
{
    //
    // Open the SqlConnection.
    //
    con.Open();
    //
    // The following code uses an SqlCommand based on the SqlConnection.
    //
    using (SqlCommand command = new SqlCommand("SELECT TOP 2 * FROM Dogs1", con))
    using (SqlDataReader reader = command.ExecuteReader())
    {
    while (reader.Read())
    {
        Console.WriteLine("{0} {1} {2}",
        reader.GetInt32(0), reader.GetString(1), reader.GetString(2));
    }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-07T00:53:05.093

您可以将它放在另一个 .config 文件中，该文件由您的 web.config 拉入，如下所示：

```
<appSettings file="../Support/config/WebEnvironment.config">
</appSettings> 
```

然后，您可以像这样在代码中使用它：

```
System.Configuration.ConfigurationManager.AppSettings["DefaultConnection"] 
```

我们拥有它，因此该文件实际上不在我们的站点下，但实际上在它下面。那就是上面的“Support”目录是一个虚拟目录。可以在[这里找到详细信息。](http://blog.digitaltools.com/post/2009/06/18/Another-Place-to-Put-the-Connection-String.aspx)

# java - JasperReports：根据组计算页数

> ID：435385
> 
> 赞同：1
> 
> 时间：2009-01-12T13:21:08.067
> 
> 标签：java, jasper-reports

问题是这样的。

页面上显示的报告页码不应依赖于当前页面，而应依赖于组页面。

让我解释：

我有一个包含 4 页的 2 个组的报告，每个组有两页，我需要做的是：

```
group 1 page 1: should be: 1/2 -> current: 1/4
group 1 page 2: should be: 2/2 -> current: 2/4
group 1 page 1: should be: 1/2 -> current: 3/4
group 1 page 2: should be: 2/2 -> current: 4/4 
```

有什么办法可以做到这一点...

PS。不允许使用黑魔法，我查看了*JasperReports*中定义的变量，但它们都不符合配置文件:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-30T05:46:24.673

您可以尝试将组的 isResetPageNumber 属性设置为 true。

例如`<group name="someGroupName" isResetPageNumber="true" >`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-20T10:18:05.833

user51931 的回答是正确的！它对我也有帮助。

您还可以从设计视图中设置此组属性。

![在此处输入图像描述](https://i.stack.imgur.com/C49N3.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-17T11:32:01.527

找到了这个答案，我能够做到这一点：

> 我能够通过在包含我的 $V{PAGE_NUMBER} 变量的文本字段上将“评估时间”属性设置为“组”来解决此问题。

# c# - 将数据从视图传递到控制器

> ID：435387
> 
> 赞同：3
> 
> 时间：2009-01-12T13:22:08.110
> 
> 标签：c#, .net, asp.net-mvc, view, controller

在 ASP.NET MVC 应用程序中，我正在为管理员制定接受或拒绝新成员的逻辑。我正在显示成员列表和两个按钮接受和拒绝，如下所示：

```
<% foreach (var mm in (ViewData["pendingmembers"] as List<MyMember>)) %>
<% { %>
   <tr><td>Username:<%=mm.UserName %></td><td>
   <tr><td>Firstname:<%=mm.FirstName %></td><td>
   ...etc...
   <tr>
      <td>
      <% using (Html.BeginForm("AcceptPendingUser", "Admin"))
      { %>
          <input type="submit" value="Accept" />
      <% } %>
      </td>
      <td>
      <% using (Html.BeginForm("RejectPendingUser", "Admin"))
      { %>
        <input type="submit" value="Reject" />
      <% } %>
      </td>
    </tr>
<% } %> 
```

因此，待处理的成员数据列表位于 MyMember 对象列表中。每个 MyMember 对象都将打印出成员，并为管理员设置了两个按钮来接受或拒绝待处理的成员。

然后，在控制器中，我将这两个输入字段/表单的处理分开，如下所示：

```
public ActionResult AcceptPendingUser()
{
   // TODO: Add code to save user into DB and send welcome email.
   return RedirectToAction("Index");
}

public ActionResult RejectPendingUser()
{
   // TODO: Add code to remove user from PendingUsers list and send rejection email.
   return RedirectToAction("Index");
} 
```

我想直接获取用户按下的按钮旁边的对象。如何将 MyMember 对象从 View 发送到控制器？或者我如何通过按下按钮发送一个数字索引？也许有一个隐藏的领域？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T13:28:04.230

最简单的选项可能是隐藏输入：

```
<input type="hidden" value="<%=mm.Key%>" name="key" id="key" /> 
```

（相应地命名；在每种形式中）

然后，两个控制器将采用一个名为“key”的参数（重命名以适应）。如果要从多个输入中解析对象，则需要一个`ModelBinder`. 当然，您可以考虑使用基于查询字符串的 url，而不是 2*n 表单，或者使用 jQuery（或其他脚本助手）之类的东西在不需要表单的情况下提交数据（如果脚本可用）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T13:36:04.260

不要使用 HTML 按钮，而是考虑使用 ActionLink 并构造它以包含被批准的成员的 id。另一种选择是有一个复选框（其值是被批准的成员的 id），管理员可以为每个要批准的成员选择一个复选框，一个类似的用于拒绝，一个用于整个表单的每个批准/拒绝按钮。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T19:18:50.620

回答我自己和其他 mvc 新手：

我终于用这段代码得到了它：

看法：

```
 <%=Html.ActionLink(
     "Jump", 
     "Jump", 
     new { name=(ViewData["Person"] as Person).Name, 
     person=ViewData["Person"]}, 
     null) %> 
```

控制器：

```
public ActionResult Index()
{
     ViewData["Title"] = "Home Page";
     ViewData["Message"] = "Welcome to ASP.NET MVC!";
     Person p = new Person();
     p.Name = "Barrack";
     p.Age = 35;
     ViewData["Person"] = p;
     return View();
}

public ActionResult Jump(string name, Person person)
{
    return View();
} 
```

在 Jump 方法中调试应用程序为 name 参数提供了很好的“Barrack”字符串，但 Person 参数为 null。

我也理解善意的评论者试图解释的内容：向控制器发送简单的数据类型（如字符串和整数）很容易，但复杂的类型（如我的 Person 对象）需要其他东西。

基本上传递一个 int 对我来说就足够了。这里最困难的部分是找出设置 ActionLink 的正确方法。

干杯，庞

# delphi - 德尔福调试器？

> ID：435389
> 
> 赞同：1
> 
> 时间：2009-01-12T13:24:05.313
> 
> 标签：delphi, debugging

我正在一家公司完成实习，上个月刚刚被投入到这个项目中，该项目建立在他们“未能”购买源代码的引擎上。现在我的任务是找出它失败的原因，仅在某些情况下，客户反馈并不好。该项目的主要开发人员也休假了几个月。

我安装了引擎并且知道它是用什么语言编写的（delphi6？）。 *注意我从来没有使用过*

我有我们的产品微星。

我应该通过常规应用程序并查明问题。我怀疑这与未正确重新初始化的字段有关。

**有没有办法将调试器附加到 exe 以查看调用堆栈和所有这些热度？**

任何可以避免无数用例的帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T13:46:49.370

您可以将 Delphi 调试器附加到任何正在运行的进程（就像所有其他 win32 调试器一样），但我认为体验不会接近您的预期。Delphi 生成非常紧凑的可执行文件，这意味着构建人类可读的调用堆栈或任何类型的“热度”的信息根本不存在。

如果您的应用程序是 Debug 版本，那么您唯一的机会就是这样。在这种情况下，Delphi 调试器应该比通用调试器提供更多帮助。

您可能还想看看这个线程 -[有没有反编译 Delphi 的程序？](https://stackoverflow.com/questions/335104/is-there-a-program-to-decompile-delphi)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T13:45:09.360

在 Delphi 2006（不确定 6）中，您可以将调试器附加到正在运行的进程。你只会得到汇编指令、寄存器、标志、内存转储和堆栈（十六进制）。希望这就足够了。

很好，我试图附加到 ide/调试器，但他们不允许这样做;-)。

# javascript - 刷新其中包含 Google 广告的 Div

> ID：435391
> 
> 赞同：40
> 
> 时间：2009-01-12T13:27:28.817
> 
> 标签：javascript, ajax, html, refresh, google-ads-api

我有一个`<div>`包含谷歌广告的。我的网站主要是 AJAX，不需要刷新浏览器。这意味着我的广告也不会刷新，这并不理想，用户整天盯着一个广告。

所以我想要一种方法来刷新页面上的特定`<div>`内容。我找到了很多解决方案，但没有奏效。例如，使用 JQuery 的 html 函数：

```
$("#ads").html("google ad script here"); 
```

这设法刷新了整个页面，不知道如何。我还可以向包含 Google 广告的 HTML 页面发出 AJAX 请求，但我猜它的效果与上述尝试相同。

我不想使用 iFrame。

我还有其他选择吗？我的豌豆脑袋想不出来了。:)

## 编辑：

这是允许的，因为我只会在用户单击链接时启动刷新。

一个典型的例子是雅虎邮箱——他们的新 AJAX 邮箱使用相同的方法，当用户点击一个链接时，就会显示一个新广告。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-01-14T00:16:03.390

正如其他两个答案所述，不允许自动刷新您的 AdSense 广告。我了解您只是打算刷新广告以响应用户操作，但*仍然*不允许，即使应该这样做！

请记住，您要更新广告的原因是为了展示新广告。显示广告称为“印象”。当您使用代码刷新广告时，您会自动生成广告展示次数。

[AdSense 计划政策](https://www.google.com/adsense/support/bin/answer.py?hl=en&answer=48182 "AdSense 计划政策")状态（强调我的）：

> 无效点击次数和展示次数
> 
> Google 广告的点击必须来自真正的用户兴趣。**严禁任何人为地在您的 Google 广告上产生点击或展示的方法。**这些被禁止的方法包括但不限于重复手动点击或展示、使用机器人、自动点击和展示生成工具、产生点击或展示的第三方服务，例如付费点击、付费浏览、自动浏览、和点击交换程序，或任何欺骗性软件。

刷新广告违反了禁止产生印象的规则。话虽如此，我认为任何理性的人都会同意，在 AJAX 应用程序中刷新广告以*响应用户行为*（例如响应点击）并不违反规则*精神*。

例如，想象一下重写您的整个应用程序以停止使用 AJAX。这对您的用户来说显然是一种更糟糕的体验（速度较慢，每次点击时页面都会闪烁，页面无法在后台动态更新），但从技术上讲，这并不违反 AdSense 计划政策。

显然，谷歌的*意思*是禁止每五秒自动更换一次广告（创建一个广告“幻灯片”）。谷歌还意味着禁止让您的网站看起来比您实际拥有的访问次数更多，从而使您的网站看起来对广告商更具吸引力。我敢肯定，他们并不*打算*阻止您设计高性能的 AJAX 网站……但不幸的是，有时规则会产生意想不到的后果。

当然，正如您最初指出的那样，如果您将广告嵌入 iframe 并修改其位置，您仍然可以刷新广告。（[以下是在 AJAX 应用程序中使用 iframe 刷新 AdSense 的方法](http://www.jguru.com/forums/view.jsp?EID=1305379 "以下是如何在 AJAX 应用程序中使用 iframe 来刷新 AdSense")。）

您在最初的问题中拒绝了 iframe，也许是因为您知道使用 iframe 会违反 Google 的政策……但如果您坚持违反规则，您还不如一路打破它们！;-)

最终，我认为您会发现以这种方式产生印象并不值得冒险：您将“刷新”广告，却发现 Google 只是向您展示与以前完全相同的广告。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-08-23T01:58:39.410

新的 Google DFP“标签”专门允许“AJAX 广告刷新”

> 刷新
> 
> pubService.refresh(slots) 使用新广告刷新页面上指定的广告位数组。
> 
> 参数：
> 
> array slot - 要刷新的可选插槽数组。如果未提供，则刷新所有广告位。例子：
> 
> var slot1 = googletag.defineUnit("/1234567/leaderboard", [728, 90], "div-1").addService(googletag.pubads());
> 
> var slot2 = googletag.defineUnit("/1234567/skyscraper", [160, 600], "div-2").addService(googletag.pubads());
> 
> // 刷新调用为每个广告位获取一个新广告
> 
> googletag.pubads().refresh([slot1, slot2]); [http://support.google.com/dfp_sb/bin/answer.py?hl=en&answer=2372721&expand=pubservice_details#refresh](http://support.google.com/dfp_sb/bin/answer.py?hl=en&answer=2372721&expand=pubservice_details#refresh)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-07T01:52:10.067

我知道我迟到了一年半，但是......广告的问题可能在于他们正在使用`document.write`（广告服务器因此而臭名昭著，但我不知道 AdSense 是否使用它或不。）

如果是这种情况，我有一个可以提供帮助的库：[writeCapture.js](http://github.com/iamnoah/writeCapture)。例子：

```
$('#ads').writeCapture().html('<script src="whatever-your-adsense-code-is"> </script>'); 
```

那是使用 jQuery，但也有一个独立版本。

至于是否违反TOS... Gmail动态更改广告，所以它不会那么糟糕。只要内容也在变化，我认为没问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-16T19:22:58.363

您可以使用以下代码刷新 Google 广告位。把这个放在你要刷新广告的JS函数中。它应该刷新页面上的所有广告。

```
if ( undefined !== googletag ) {
  googletag.pubads().refresh();
} 
```

[Google Ad Manager 帮助 - 无需刷新页面即可重新加载广告](https://support.google.com/admanager/answer/2694377?hl=en)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-12-04T13:35:09.030

只需将广告包含在您通过 ajax 加载的页面中。通过 ajax 在每页的基础上从文件中加载广告不会有任何问题。

如果我加载包含一些内容和广告的 Read.inc 单击页面上的某些内容，它会将您带到包含内容和广告的 Make.inc。

那有什么问题？那是有机的。将广告作为内容的一部分加载。

这与单击链接相同。

我还没有真正尝试过，但它确实看起来合乎逻辑。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-12T13:45:59.793

不允许（根据 AdSense 条款）在页面生命周期内尝试重新加载广告。此外，这几乎是不可能的（感谢平台架构）。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-01-12T13:53:24.787

这个不允许。但我认为您可以为此使用 iframe。我看到了很好的教程。我尝试通过 ajax 回滚对 Adsense TOS 的更改

# c# - SQL 2005 中的 .Net 函数调用

> ID：435401
> 
> 赞同：1
> 
> 时间：2009-01-12T13:32:53.737
> 
> 标签：c#, .net, sql

在 SQL 2005 中执行 .Net 函数时出现以下错误，有什么想法吗？

> 消息 6522，级别 16，状态 2，第 1 行在执行用户定义的例程或聚合“Function1”期间发生 .NET Framework 错误：System.Security.SecurityException：请求“System.Net.WebPermission，系统”类型的权限，版本=2.0.0.0，文化=中性，PublicKeyToken=b77a5c561934e089' 失败。System.Security.SecurityException：
> 在 System.Security.CodeAccessSecurityEngine.Check(Object demand, StackCrawlMark& stackMark, Boolean isPermSet) 在 System.Net.HttpWebRequest..ctor(Uri uri, ServicePoint servicePoint) 在 System.Net.HttpRequestCreator 在 System.Security.CodeAccessPermission.Demand() .Create(Uri Uri) at System.Net.WebRequest.Create(Uri requestUri, Boolean useUriBase) at System.Net.WebRequest.Create(Uri requestUri) at System.Web.Services.Protocols.WebClientProtocol.GetWebRequest(Uri uri) at System.Web.Services.Protocols.HttpWebClientProtocol.GetWebRequest(Uri uri) 在 System.Web.Services.Protocols.SoapHttpClientProtocol.GetWebRequest(Uri uri) 在 System.Web.Services.Protocols.SoapHttpClientProtocol.Invoke(String methodName, Object[]参数）在 SqlServerProject1.navision.NavisionLink。UserDefinedFunctions.Function1() 处的 GetPONumber（字符串数据库）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T19:12:46.577

您没有使用适当的权限集创建程序集。您的`CREATE ASSEMBLY`声明应如下所示：

```
CREATE ASSEMBLY ... WITH PERMISSION_SET = EXTERNAL_ACCESS 
```

这*应该*允许您进行 Web 服务调用。如果这不起作用，那么您将不得不设置`PERMISSION_SET`为`UNSAFE`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T13:48:37.793

使用系统；使用 System.Data；使用 System.Data.SqlClient；使用 System.Data.SqlTypes；使用 Microsoft.SqlServer.Server；

公共部分类 UserDefinedFunctions { [Microsoft.SqlServer.Server.SqlFunction] 公共静态 SqlString Function1() { SqlServerProject1.navision.NavisionLink po = new SqlServerProject1.navision.NavisionLink();

```
 string test = Convert.ToString(po.GetPONumber("NavisionDev"));
    // Put your code here
    return new SqlString(test);
} 
```

};

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T14:17:49.090

您需要为在 SQLServer 上运行 .NET 代码设置一些安全信息。

请参阅[CodeProject](http://www.codeproject.com/KB/database/Managed_Code_in_SQL.aspx)以查找您需要的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T13:36:04.870

看来您没有足够的安全访问权限？

但是如果您可以发布与该错误相关的代码会更容易

# c# - 如何使用 IComparable 接口？

> ID：435404
> 
> 赞同：18
> 
> 时间：2009-01-12T13:33:32.940
> 
> 标签：c#, .net, icomparable

我需要一个关于如何使用`IComparable`界面的基本示例，以便我可以按升序或降序以及我正在排序的对象类型的不同字段进行排序。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-12T13:47:57.763

好吧，由于您正在使用`List<T>`它，因此仅使用 a 会简单得多`Comparison<T>`，例如：

```
List<Foo> data = ...
// sort by name descending
data.Sort((x,y) => -x.Name.CompareTo(y.Name)); 
```

当然，使用 LINQ，您可以使用：

```
var ordered = data.OrderByDescending(x=>x.Name); 
```

但是您可以很容易地重新引入它`List<T>`（用于就地重新排序）；这是一个允许`Sort`使用`List<T>`lambda 语法的示例：

```
using System;
using System.Collections.Generic;  

class Foo { // formatted for vertical space
    public string Bar{get;set;}
}
static class Program {
    static void Main() {
        List<Foo> data = new List<Foo> {
            new Foo {Bar = "abc"}, new Foo {Bar = "jkl"},
            new Foo {Bar = "def"}, new Foo {Bar = "ghi"}
        };
        data.SortDescending(x => x.Bar);
        foreach (var row in data) {
            Console.WriteLine(row.Bar);
        }
    }

    static void Sort<TSource, TValue>(this List<TSource> source,
            Func<TSource, TValue> selector) {
        var comparer = Comparer<TValue>.Default;
        source.Sort((x,y)=>comparer.Compare(selector(x),selector(y)));
    }
    static void SortDescending<TSource, TValue>(this List<TSource> source,
            Func<TSource, TValue> selector) {
        var comparer = Comparer<TValue>.Default;
        source.Sort((x,y)=>comparer.Compare(selector(y),selector(x)));
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-12T13:34:12.033

这是一个简单的例子：

```
public class SortableItem : IComparable<SortableItem>
{
    public int someNumber;

    #region IComparable<SortableItem> Members

    public int CompareTo(SortableItem other)
    {
        int ret = -1;
        if (someNumber < other.someNumber)
            ret = -1;
        else if (someNumber > other.someNumber)
            ret = 1;
        else if (someNumber == other.someNumber)
            ret = 0;
        return ret;
    }

    #endregion
} 
```

*“那很好，但是如果我想能够控制排序顺序，或者按另一个字段排序呢？”*

简单的。我们需要做的就是向对象添加更多字段。首先，我们将为不同的排序类型添加一个字符串，然后我们将添加一个布尔值来表示我们是按降序还是升序排序，然后添加一个字段来确定我们要搜索的字段。

```
public class SortableItem : IComparable<SortableItem>
{
    public enum SortFieldType { SortNumber, SortString }

    public int someNumber = -1;
    public string someString = "";
    public bool descending = true;    
    public SortFieldType sortField = SortableItem.SortFieldType.SortNumber;        

    #region IComparable<SortableItem> Members

    public int CompareTo(SortableItem other)
    {
        int ret = -1;
        if(sortField == SortableItem.SortFieldType.SortString)
        {
            // A lot of other objects implement IComparable as well.
            // Take advantage of this.
            ret = someString.CompareTo(other.someString);
        }
        else
        {
            if (someNumber < other.someNumber)
                ret = -1;
            else if (someNumber > other.someNumber)
                ret = 1;
            else if (someNumber == other.someNumber)
                ret = 0;
        }
        // A quick way to switch sort order:
        // -1 becomes 1, 1 becomes -1, 0 stays the same.
        if(!descending) ret = ret * -1; 

        return ret;
    }

    #endregion

    public override string ToString()
    {
       if(sortField == SortableItem.SortFieldType.SortString)
          return someString;
       else
          return someNumber.ToString();
    }
} 
```

*“告诉我怎么做！”*

好吧，既然你问得这么好。

```
static class Program
{
    static void Main()
    {

        List<SortableItem> items = new List<SortableItem>();
        SortableItem temp = new SortableItem();
        temp.someString = "Hello";
        temp.someNumber = 1;
        items.Add(temp);
        temp = new SortableItem();
        temp.someString = "World";
        temp.someNumber = 2;
        items.Add(temp);
        SortByString(items);
        Output(items);
        SortAscending(items);
        Output(items);
        SortByNumber(items);
        Output(items);
        SortDescending(items);
        Output(items);
        Console.ReadKey();
    }

    public static void SortDescending(List<SortableItem> items)
    {
        foreach (SortableItem item in items)
            item.descending = true;
    }
    public static void SortAscending(List<SortableItem> items)
    {
        foreach (SortableItem item in items)
            item.descending = false;
    }
    public static void SortByNumber(List<SortableItem> items)
    {
        foreach (SortableItem item in items)
            item.sortField = SortableItem.SortFieldType.SortNumber;
    }
    public static void SortByString(List<SortableItem> items)
    {
        foreach (SortableItem item in items)
            item.sortField = SortableItem.SortFieldType.SortString;
    }
    public static void Output(List<SortableItem> items)
    {
        items.Sort();
        for (int i = 0; i < items.Count; i++)
            Console.WriteLine("Item " + i + ": " + items[i].ToString());
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-12T13:47:39.307

如果你想要动态排序，你可以使用 LINQ

```
var itemsOrderedByNumber = ( from item in GetClasses() orderby item.Number select item ).ToList();
var itemsOrderedByText = ( from item in GetClasses() orderby item.Text select item ).ToList();
var itemsOrderedByDate = ( from item in GetClasses() orderby item.Date select item ).ToList(); 
```

或 List 类的“排序”方法：

```
List<Class1> itemsOrderedByNumber2 = new List<Class1>( GetClasses() );
itemsOrderedByNumber2.Sort( ( a, b ) => Comparer<int>.Default.Compare( a.Number, b.Number ) );

List<Class1> itemsOrderedByText2 = new List<Class1>( GetClasses() );
itemsOrderedByText2.Sort( ( a, b ) => Comparer<string>.Default.Compare( a.Text, b.Text ) );

List<Class1> itemsOrderedByDate2 = new List<Class1>( GetClasses() );
itemsOrderedByDate2.Sort( ( a, b ) => Comparer<DateTime>.Default.Compare( a.Date, b.Date ) ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-10T05:32:39.003

您可以将其用于排序列表

```
namespace GenaricClass
{
    class Employee :IComparable<Employee>
    {
        public string Name { get; set; }
        public double Salary { get; set; }

        public int CompareTo(Employee other)
        {
            if (this.Salary < other.Salary) return 1;
            else if (this.Salary > other.Salary) return -1;
            else return 0;
        }

        public static void Main()
        {
            List<Employee> empList = new List<Employee>()
            {
                new Employee{Name="a",Salary=140000},
                new Employee{Name="b",Salary=120000},
                new Employee{Name="c",Salary=160000},
                new Employee{Name="d",Salary=10000}
            };
            empList.Sort();
            foreach (Employee emp in empList)
            {
                System.Console.Write(emp.Salary +",");
            }
            System.Console.ReadKey();
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T14:25:48.187

这可能与排序顺序无关，但我认为它仍然是一个有趣的用法`IComparable`：

```
public static void MustBeInRange<T>(this T x, T minimum, T maximum, string paramName)
where T : IComparable<T>
{
    bool underMinimum = (x.CompareTo(minimum) < 0);
    bool overMaximum = (x.CompareTo(maximum) > 0);
    if (underMinimum || overMaximum)
    {
        string message = string.Format(
            System.Globalization.CultureInfo.InvariantCulture,
            "Value outside of [{0},{1}] not allowed/expected",
            minimum, maximum
        );
        if (string.IsNullOrEmpty(paramName))
        {
            Exception noInner = null;
            throw new ArgumentOutOfRangeException(message, noInner);
        }
        else
        {
            throw new ArgumentOutOfRangeException(paramName, x, message);
        }
    }
}

public static void MustBeInRange<T>(this T x, T minimum, T maximum)
where T : IComparable<T> { x.MustBeInRange(minimum, maximum, null); } 
```

这些简单的扩展方法允许您对任何实现`IComparable`这样的类型进行参数范围检查：

```
public void SomeMethod(int percentage, string file) {
    percentage.MustBeInRange(0, 100, "percentage");
    file.MustBeInRange("file000", "file999", "file");
    // do something with percentage and file
    // (caller will have gotten ArgumentOutOfRangeExceptions when applicable)
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-20T18:11:14.470

```
using System;
using System.Collections.Generic;
using System.Text;

namespace Sorting_ComplexTypes
{
    class Program
    {
        static void Main(string[] args)
        {
            Customer customer1 = new Customer {
                ID = 101,
                Name = "Mark",
                Salary = 2400,
                Type = "Retail Customers"
            };
            Customer customer2 = new Customer
            {
                ID = 102,
                Name = "Brian",
                Salary = 5000,
                Type = "Retail Customers"
            };
            Customer customer3 = new Customer
            {
                ID = 103,
                Name = "Steve",
                Salary = 3400,
                Type = "Retail Customers"
            };

            List<Customer> customer = new List<Customer>();
            customer.Add(customer1);
            customer.Add(customer2);
            customer.Add(customer3);

            Console.WriteLine("Before Sorting");
            foreach(Customer c in customer)
            {
                Console.WriteLine(c.Name);
            }

            customer.Sort();
            Console.WriteLine("After Sorting");
            foreach(Customer c in customer)
            {
                Console.WriteLine(c.Name);
            }

            customer.Reverse();
            Console.WriteLine("Reverse Sorting");
            foreach (Customer c in customer)
            {
                Console.WriteLine(c.Name);
            }
            }
        }
    }
    public class Customer : IComparable<Customer>
    {
        public int ID { get; set; }
        public string Name { get; set; }
        public int Salary { get; set; }
        public string Type { get; set; }

        public int CompareTo(Customer other)
        {
            return this.Name.CompareTo(other.Name);
        }
    } 
```

# ruby-on-rails - 如何在 Capistrano 中“复制，除非存在更高版本”？

> ID：435408
> 
> 赞同：0
> 
> 时间：2009-01-12T13:34:41.627
> 
> 标签：ruby-on-rails, ruby, security, deployment, capistrano

我想`database.yml`通过使其不受版本控制来保护我的文件。因此，我的 Capistrano 部署方案中有两个任务：

```
task :copy_db_config do
  # copy local config file if it exists and is more
  # recent than the remote one
end

task :symlink_db_config do
  run "ln -nfs #{shared_path}/config/database.yml #{release_path}/config/database.yml"
end 
```

你能帮忙填写第一个任务吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T08:50:34.227

I don't have functioning code for you here and now but..

you can the the local timestamp by using ruby. File class has a function ctime which let's You know when it was changed.

Run the same command on the servers database.yml

If the local one is newest, capistrano has a method for secure upload

`upload("products.txt", "/home/medined", :via => :scp)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-28T17:29:27.167

我有同样的问题，但我的处理方式不同。也许会有所帮助。

设置任务将 database.yml.example 复制到 database.yml。部署任务不涉及 database.yml。我有单独的任务来更改数据库名称、用户名和密码。这是一个例子：

```
desc "Change the database name"
task :change_db_database, :roles => :app do
  database = prompt('Enter new database name: ')
  run <<-CMD
    cd #{shared_path}/config &&
    perl -i -pe '$env = $1 if /^(\\w+)/; s/database:.*/database: #{database}/ if $env eq "#{ENV['CONNECTION'] || ENV['TARGET']}"' database.yml
  CMD
end 
```

我在设置之后但在新盒子上第一次部署之前运行这些。然后，在此之后的任何时候，当我需要更改数据库参数时，我都会使用这些任务而不是复制到新文件中。

# sql - 具有多列的“在哪里”（SQL Server）

> ID：435418
> 
> 赞同：13
> 
> 时间：2009-01-12T13:40:37.887
> 
> 标签：sql, sql-server, sql-server-2005

我正在使用 SQL Server 2005。

查询看起来像这样

```
Select col1, col2, col3 from <subquery> where (col1,col2) in <subquery> 
```

SQL Server 似乎不喜欢这样。任何人都知道的实现方式不涉及转换为 varchars 或其他任何混乱的东西？

这是实际的查询。

```
SELECT * 
FROM         
 (
    SELECT NEWID() AS guid, UserID, RoleId, ClubId, 0 AS GroupRole
    FROM dbo.Portal_UserRoles

    UNION

    SELECT NEWID() AS guid, dbo.Portal_UserGroups.UserId, 
           dbo.Portal_GroupRoles.RoleId, dbo.Portal_UserGroups.ClubId, 
           dbo.Portal_GroupRoles.GroupId AS GroupRole
    FROM dbo.Portal_GroupRoles 
    INNER JOIN dbo.Portal_UserGroups 
        ON dbo.Portal_GroupRoles.GroupId = dbo.Portal_UserGroups.GroupId
  ) AS derivedtbl_1
WHERE (derivedtbl_1.RoleId,derivedtbl_1.ClubId) IN 
      (
         SELECT Portal_GroupRoles.RoleId, Portal_ClubGroups.ClubId
         FROM Portal_GroupRoles 
         INNER JOIN Portal_ClubGroups
             ON Portal_GroupRoles.GroupId = Portal_ClubGroups.GroupId
      ) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-12T15:03:35.473

执行您所寻求的标准的经典方法是 EXISTS 子句：

```
SELECT * 
    FROM         
    (
        SELECT NEWID() AS guid, UserID, RoleId, ClubId, 0 AS GroupRole
        FROM dbo.Portal_UserRoles

        UNION

        SELECT NEWID() AS guid, dbo.Portal_UserGroups.UserId, 
               dbo.Portal_GroupRoles.RoleId, dbo.Portal_UserGroups.ClubId, 
               dbo.Portal_GroupRoles.GroupId AS GroupRole
            FROM dbo.Portal_GroupRoles 
                 INNER JOIN dbo.Portal_UserGroups 
                 ON dbo.Portal_GroupRoles.GroupId = dbo.Portal_UserGroups.GroupId
    ) AS derivedtbl_1
WHERE EXISTS
  (
     SELECT Portal_GroupRoles.RoleId, Portal_ClubGroups.ClubId
         FROM (Portal_GroupRoles 
               INNER JOIN Portal_ClubGroups
               ON Portal_GroupRoles.GroupId = Portal_ClubGroups.GroupId) AS cgr
         WHERE derivedtbl_1.RoleID = cgr.RoleId
           AND derivedtbl_1.ClubId = cgr.ClubId
  ) 
```

小心将两列条件分成两个单独的 IN 子句；它不会给您与在一个 EXISTS 子句中应用两列条件相同的答案（通常）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T13:46:38.920

在派生表上执行连接，而不是使用`in`

```
SELECT * 
FROM  
  (
    SELECT NEWID() AS guid, UserID, RoleId, ClubId, 0 AS GroupRole 
    FROM dbo.Portal_UserRoles 

    UNION 

    SELECT NEWID() AS guid, dbo.Portal_UserGroups.UserId, 
           dbo.Portal_GroupRoles.RoleId, dbo.Portal_UserGroups.ClubId,
           dbo.Portal_GroupRoles.GroupId AS GroupRole 
    FROM dbo.Portal_GroupRoles 
    INNER JOIN dbo.Portal_UserGroups 
        ON dbo.Portal_GroupRoles.GroupId = dbo.Portal_UserGroups.GroupId
  ) AS derivedtbl_1 

INNER JOIN 
  (
    SELECT Portal_GroupRoles.RoleId, Portal_ClubGroups.ClubId 
    FROM Portal_GroupRoles 
    INNER JOIN Portal_ClubGroups 
        ON Portal_GroupRoles.GroupId = Portal_ClubGroups.GroupId
  ) derivedtbl_2
    ON derivedtbl_1.RoleID = derivedtbl_2.RoleID 
      AND derivedtbl_1.ClubId = derivedtbl_2.ClubId 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T15:29:13.610

```
SELECT 
    /*      
    your selected fields, joins here
    */
WHERE -- (derivedtbl_1.RoleId,derivedtbl_1.ClubId) IN 
    EXISTS
    (
        -- actually you can change these two fields to * (asterisk ) or 1, whatever, even your name, what matters only is the testing of existence(see below)
        SELECT Portal_GroupRoles.RoleId, Portal_ClubGroups.ClubId 
        FROM Portal_GroupRoles 
        INNER JOIN Portal_ClubGroups
        ON Portal_GroupRoles.GroupId = Portal_ClubGroups.GroupId

        -- here is your IN (the testing of existence):
        WHERE Portal_GroupRoles.RoleId = derivedtbl_1.RoleId AND 
        AND derivedtbl_1.ClubId = derivedtbl_1.ClubId
      )

alternatively:

SELECT 
    /*      
    your selected fields, joins here
    */
JOIN 
    (
        SELECT Portal_GroupRoles.RoleId, Portal_ClubGroups.ClubId
        FROM Portal_GroupRoles 
        INNER JOIN Portal_ClubGroups
        ON Portal_GroupRoles.GroupId = Portal_ClubGroups.GroupId
    ) X 
    -- here is your IN:
    ON X.RoleId = derivedtbl_1.RoleId
    AND X.ClubId = derivedtbl_1.ClubId 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-10T10:20:03.763

你的语法很有用，并且在标准 SQL 中得到支持。它尚未在 SQL Server 中实现，但您可以[在此处](http://connect.microsoft.com/SQLServer/feedback/details/299231/add-support-for-ansi-standard-row-value-constructors)投票支持它。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-12T13:44:36.817

您必须在两个子句中分开

```
 where col1 in (...) AND col2 in (...) 
```

或者你可以稍微重构一下

```
select * FROM (
     SELECT NEWID() AS guid, UserID, RoleId, ClubId, 0 AS GroupRole FROM dbo.Portal_UserRoles 
     UNION 
     SELECT NEWID() AS guid, dbo.Portal_UserGroups.UserId, dbo.Portal_GroupRoles.RoleId, dbo.Portal_UserGroups.ClubId, dbo.Portal_GroupRoles.GroupId AS GroupRoles FROM dbo.Portal_GroupRoles INNER JOIN dbo.Portal_UserGroups ON dbo.Portal_GroupRoles.GroupId = dbo.Portal_UserGroups.GroupId) 
     AS derivedtbl_1, Portal_GroupRoles, Portal_ClubGroup
where derivedtbl_1.RoleId = Portal_GroupRoles.RoleId
and derivedtbl_1.ClubId = Portal_ClubGroups.ClubId
and Portal_GroupRoles.GroupId = Portal_ClubGroups.GroupId 
```

# orm - 您将如何使用 ORM 为“默认子”标志建模？

> ID：435420
> 
> 赞同：1
> 
> 时间：2009-01-12T13:41:32.783
> 
> 标签：orm, modeling

我正在使用 ORM（SQLAlchemy，但我的问题与实现无关）来模拟父类与其子类之间的多对多关系。我想知道，表达这个概念的简单方法是什么“其中一个孩子是默认/主要的”？

例如，我需要坚持以下内容：
这个 Person 实例有地址 X 和 Y，主要的是 Y。

我看到这是使用像“PersonAddressRelation”这样的“中间”类实现的，它包含“Person”、“Address”和“main”标志，但我认为它看起来有点麻烦..有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T13:53:00.607

最简单的方法是在 Person 表上创建一个连接表 PersonAddressRelation 和一个 DefaultAddress 列，该列作为 Address 表的键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T14:03:23.207

几点评论。

*   M:N 关系没有指定“父”和“子”，因为没有父或子：只有两个实体通过第三个实体（中间实体）具有 m:n 关系。

*   “地址”通常不是有效的实体类型，因为在语义上它没有身份，类似于“姓名”没有身份（名字，姓氏）。当您查看重用地址类型的实体实例时，您会看到这一点：您通常不会这样做。（尽管您将重新使用客户实体实例，例如，当客户有多个订单时）

*   您想在 M:N 关系（默认）上指定一个属性，因为它属于那里。这意味着关系本身形成了一个实体（它是中间实体，通常它只有两个 FK 字段形成 PK）。这被称为“对象化关系”，因为关系本身被视为一个实体。这方面的其他示例是 Employee m:n Department，您希望指定员工开始为员工工作的部门的 StartDate。

所以一般来说：创建中间实体，因为它通常应该在那里，并在那里添加属性。在这种使用地址的特殊情况下，请确保您在相关实体（人）之间重复使用地址实例。如果不是，则将地址与人员合并，或者如果一个人可以有多个地址，则在人员-地址之间创建一个简单的 1:n 关系，将其规范化，但不要害怕将地址数据合并到与之相关的实体中，通常地址数据实际上没有被重复使用（因此您的 m:n 关系实际上不存在：没有与多个人员实例相关的 Address 实例。

# wcf - 多个 WCF 服务可以共享一个公共 BaseAddress 吗？

> ID：435423
> 
> 赞同：12
> 
> 时间：2009-01-12T13:42:48.460
> 
> 标签：wcf, app-config, endpoints, base-address

我有一个包含几个 WCF 服务的程序集，每个服务都有自己的合同。这一切都很好。该服务的 app.config 中的服务配置如下所示：

```
<services>
  <service behaviorConfiguration="WcfService.AlyzaServiceBehavior"
    name="Sam.Alyza.WcfService.ServiceWebsites">
    <endpoint address="" binding="netTcpBinding" contract="Sam.Alyza.WcfInterface.IServiceWebsites">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
    <host>
      <baseAddresses>
        <add baseAddress="net.tcp://localhost:8731/Design_Time_Addresses/SamAlyza/Websites/" />
      </baseAddresses>
    </host>
  </service>
  <service behaviorConfiguration="Sam.Alyza.WcfService.LogReaderServiceBehavior"
    name="Sam.Alyza.WcfService.ServiceLogReader">
    <endpoint address="" binding="netTcpBinding" contract="Sam.Alyza.WcfInterface.IServiceLogReader">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
    <host>
      <baseAddresses>
        <add baseAddress="net.tcp://localhost:8731/Design_Time_Addresses/SamAlyza/LogReader/" />
      </baseAddresses>
    </host>
  </service>
  <service behaviorConfiguration="Sam.Alyza.WcfService.ServiceSystemverwaltungBehavior"
    name="Sam.Alyza.WcfService.ServiceSystemverwaltung">
    <endpoint address="" binding="netTcpBinding" contract="Sam.Alyza.WcfInterface.IServiceSystemverwaltung">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
    <host>
      <baseAddresses>
        <add baseAddress="net.tcp://localhost:8731/Design_Time_Addresses/SamAlyza/Systemverwaltung/" />
      </baseAddresses>
    </host>
  </service>
  [...]
</services> 
```

由于我有一个更大的项目，有更多的合同，我想有一种方法可以在不同的服务合同之间共享 BaseAddress。
如果这只是一个具有不同合约和端点的服务，我可以设置一个通用的基地址，但是如何为多个服务设置一个通用的基地址？

当然，我需要为客户提供类似的东西。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-13T09:15:55.580

您可以将所有合约合并到一个类中，这样您就拥有一个带有基地址的服务和每个合约一个（或多个）端点。

为了避免拥有一个大的类文件，您可以使用部分关键字（假设您使用 c#）将类拆分到多个文件中。每个文件都可以实现一个合约，这使得维护各个接口变得更加容易。

在 C++ 中，您可以使用#includes 或多重继承，但这意味着大量的纪律......

您的配置将如下所示：

```
<services>
  <service behaviorConfiguration="WcfService.AlyzaServiceBehavior"
    name="Sam.Alyza.WcfService.ServiceAll">
    <endpoint address="Websites/" binding="netTcpBinding" contract="Sam.Alyza.WcfInterface.IServiceWebsites">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <endpoint address="LogReader/" binding="netTcpBinding" contract="Sam.Alyza.WcfInterface.IServiceLogReader">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <endpoint address="Systemverwaltung/" binding="netTcpBinding" contract="Sam.Alyza.WcfInterface.IServiceSystemverwaltung">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
    <host>
      <baseAddresses>
        <add baseAddress="net.tcp://localhost:8731/Design_Time_Addresses/SamAlyza/" />
      </baseAddresses>
    </host>
  </service>
</services> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T19:07:45.043

服务可以共享 BaseAddress 值（包括端口号，如果 Net.Tcp 端口共享服务正在运行）。端点地址必须是唯一的。请注意，在您的配置文件中，每个 ServiceHost 的 MEX 端点的地址为“mex”。您的其他端点的地址为空字符串。当您向 WCF 提供端点的相对地址时（至少在配置文件中），基地址会附加到它的前面。因此，LogReader 服务的 MEX 端点地址是“net.tcp://localhost:8731/Design_Time_Addresses/SamAlyza/LogReader/mex”。

由于未在主服务端点上设置相对地址，因此将 ServiceHost 的基地址用作主服务端点的实际地址。因为没有两个端点可以有重叠的 Uri.AbsolutePath 值，所以您的示例会让您相信基地址值不能共享。托管 WCF 服务的 ServiceHost 类没有内置终结点，而 ServiceEndpoint 类有一个 ListenUri 属性，该属性将根据您提供的设置进行填充。

如果您将示例中的 baseAddress 值更改为全部匹配，只要您在 Endpoint 元素上设置唯一的相对地址值，一切都会正常工作。但是，您似乎可能会在使用 MEX 端点时遇到一些挑战，因为它们目前都有地址“mex”。让那些独一无二，你应该没问题。

现在，我必须问，您确定您不只是希望这些服务共享一个命名空间，而不是基地址吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-07T16:28:40.313

如果使用自定义 ServiceHostFactory，还可以在代码中设置基地址。

在配置中，您可以进行一些应用设置：

```
<configuration>
  <appSettings>
    <add key="BaseAddress" value="http://localhost:1234" />
  </appSettings>
<configuration> 
```

然后制作一个自定义的 ServiceHostFactory：

```
public sealed class MyServiceHostFactory : ServiceHostFactory
{
    protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
    {
        var baseAddy = ConfigurationManager.AppSettings["BaseAddress"];
        baseAddresses.Add(new Uri(baseAddy));
        return new ServiceHost(serviceType, baseAddresses);
    }

} 
```

然后，您还必须更改 .svc 文件才能使用该工厂：

```
<%@ ServiceHost Language="C#" Debug="true" Service="MyApp.MyService" CodeBehind="MyService.svc.cs" Factory="MyApp.MyServiceHostFactory" %> 
```

# sql - Postgresql：仅当表不存在时如何创建表？

> ID：435424
> 
> 赞同：53
> 
> 时间：2009-01-12T13:43:37.490
> 
> 标签：sql, database, postgresql

在 Postgresql 中，只有在表不存在的情况下，我如何才能创建创建表？

代码示例赞赏。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2011-09-14T13:48:06.017

我不确定它是什么时候添加的，但为了完整起见，我想指出在 9.1 版（可能之前）`IF NOT EXISTS`中可以使用。`IF NOT EXISTS`如果表不存在，只会创建表。

例子：

```
CREATE TABLE IF NOT EXISTS users.vip
(
  id integer
) 
```

如果表不存在，这将创建一个`vip`在模式中命名的表。`users`

[资源](http://www.postgresql.org/docs/current/static/sql-createtable.html)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-01-12T14:57:39.243

```
create or replace function update_the_db() returns void as
$$
begin

    if not exists(select * from information_schema.tables 
        where 
            table_catalog = CURRENT_CATALOG and table_schema = CURRENT_SCHEMA
            and table_name = 'your_table_name_here') then

        create table your_table_name_here
        (
            the_id int not null,
            name text
        );

    end if;

end;
$$
language 'plpgsql';

select update_the_db();
drop function update_the_db(); 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-01-12T13:54:36.097

只需创建表，不用担心它是否存在。如果它不存在，它将被创建；如果它确实存在，则不会修改该表。您可以随时检查 SQL 查询的返回值，以查看执行 create 语句时表是否存在。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-12T13:59:40.140

我认为检查 pg_class 表可能会对您有所帮助，例如：

```
SELECT COUNT (relname) as a FROM pg_class WHERE relname = 'mytable'

if a = 0 then (CREATE IT) 
```

问候。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-04-19T14:30:10.527

这是一个老问题。我只是带回来建议另一个答案。注意：***已经存在其他更好的答案，这仅用于教育目的*。**

最简单的方法就是照别人说的去做；如果要保留现有数据，请执行 CREATE TABLE；如果您想要新创建的表，请执行 DROP IF EXISTS 然后执行 CREATE TABLE。

另一种选择是查询系统表是否存在并从那里继续。

```
SELECT true FROM pg_tables WHERE tablename = <table> [AND schemaname = <schema>]; 
```

正在使用：

```
-- schema independent:
SELECT true FROM pg_tables WHERE tablename = 'foo';

-- schema dependent:
SELECT true FROM pg_tables WHERE tablename = 'foo' AND schemaname = 'bar'; 
```

如果匹配，您将获得一个真值，否则它应该返回一个空数据集。您可以使用该值来确定是否需要执行 CREATE TABLE。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-02-14T14:32:22.190

如果您运行的是 Postgresql 9.1+，Skalli 给出了最佳答案。

如果像我一样需要使用 Postgresql 8.4 来执行此操作，则可以使用带有“duplicate_table”异常捕获的函数。

这将在表存在时忽略生成的错误并继续生成其他错误。

这是一个在 Postgresql 8.4.10 上工作的示例：

```
CREATE FUNCTION create_table() RETURNS VOID AS
$$
BEGIN
    CREATE TABLE my_table_name(my_column INT);
EXCEPTION WHEN duplicate_table THEN
    -- Do nothing
END;
$$
LANGUAGE plpgsql; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-08-22T05:18:51.013

在创建表之前我用来检查表是否存在（Java 和 PostgreSQL）。我希望这可以帮助别人。这里没有实现创建表部分，只是检查表是否已经存在。传入与数据库和 tableName 的连接，它应该返回该表是否存在。

```
public boolean SQLTableExists(Connection connection, String tableName) {
    boolean exists = false;

    try {
        Statement stmt = connection.createStatement();
        String sqlText = "SELECT tables.table_name FROM information_schema.tables WHERE table_name = '" + tableName + "'";    
        ResultSet rs = stmt.executeQuery(sqlText);

        if (rs != null) {
            while (rs.next()) {
                if (rs.getString(1).equalsIgnoreCase(tableName)) {
                    System.out.println("Table: " + tableName + " already exists!");
                    exists = true;
                } else { 
                    System.out.println("Table: " + tableName + " does not appear to exist.");
                    exists = false;
                }

            }
        }

    } catch (SQLException sqlex) {
        sqlex.printStackTrace();
    }
    return exists;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-05-24T04:40:03.727

[http://www.postgresql.org/docs/8.2/static/sql-droptable.html](http://www.postgresql.org/docs/8.2/static/sql-droptable.html)

```
DROP TABLE [ IF EXISTS ] name [, ...] [ CASCADE | RESTRICT ] 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-10-28T19:00:58.607

最简单的答案是：

```
catch{

#create table here

} 
```

如果不存在则创建一个表，如果存在则产生错误。并且错误被捕获。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-30T08:15:40.460

尝试在表上运行查询。如果它抛出异常，则捕获异常并创建一个新表。

```
try {
    int a =  db.queryForInt("SELECT COUNT(*) FROM USERS;");
}
catch (Exception e) {
    System.out.print(e.toString());
    db.update("CREATE TABLE USERS (" +
                "id SERIAL," +
                "PRIMARY KEY(id)," +
                "name varchar(30) NOT NULL," +
                "email varchar(30) NOT NULL," +
                "username varchar(30) NOT NULL," +
                "password varchar(30) NOT NULL" +
                ");");
}
return db; 
```

# c++ - 与浏览器无关的 C++ DOM 接口

> ID：435429
> 
> 赞同：6
> 
> 时间：2009-01-12T13:44:51.433
> 
> 标签：c++, dom, cross-browser

在 C++ 中针对浏览器的[DOM](http://www.google.co.il/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.w3.org%2FDOM%2F&ei=eUhrSaTCDpyY9QSMr5imBw&usg=AFQjCNH0daWhsLwlt2sAqQJ71Vx8WtrHug&sig2=9eYS8DOTG8VOj3tJSKjyvg)进行编程时，每个引擎都有一组不同的接口，IE 具有基于 COM 的 [MSHTML]( [http://msdn.microsoft.com/en-us/library/aa752279(VS.85).aspx )](http://msdn.microsoft.com/en-us/library/aa752279(VS.85).aspx)) , Mozilla 有基于[XPCOM](http://en.wikipedia.org/wiki/XPCOM)的[Gecko DOM](http://www.xulplanet.com/references/xpcomref/ifaces/nsIDOMNSHTMLElement.html)等。

是否有一个通用 API 具有适用于主要浏览器（和版本）的[适配器？](http://en.wikipedia.org/wiki/Adapter_pattern "适配器模式")

* * *

澄清一下，有问题的应用程序是用 C++ 编写的与浏览器交互的桌面应用程序，目前我们有单独的代码库来支持 IE 和 Mozilla，我正在尝试减少逻辑重复并允许以更少的努力添加新的浏览器.

一个具体的例子可以是获取 HTML 元素的 innerHTML 属性。

```
// Firefox
nsAutoString html;
nsCOMPtr<nsIDOMNSHTMLElement> elem = do_QueryInterface(obj);
if (elem)
    elem->GetInnerHTML(html); 

// IE
CComBSTR html;
MSHTML::IHTMLElementPtr elem = obj;
if (elem) 
     elem->get_innerHTML(&html); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T15:01:50.907

您最好的选择似乎是定义自己的接口并编写不同的适配器。很可能您的 C++ 代码不会使用所有 DOM 遍历功能，您的界面只需要定义一组紧凑的遍历函数。

作为定义自己的接口的一个好处，您可以轻松地为您的单元测试编写一个模拟适配器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T05:13:48.487

我从来没有见过一个。对于我的软件，我简单地用 Firefox 的 javascript 编写了扩展，然后创建了一个 Internet Explorer BHO（我还没有完成）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T22:09:06.950

Moonlight 是在 LGPL 下发布的，如果许可没问题，他们可能会有一些对你有用的东西。

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2009-01-14T16:45:42.863

有什么理由必须是 C++ 吗？你不能使用 jQuery 吗？[或者 WebKit 中的http://webkit.org/blog/156/queryselector-and-queryselectorall/](http://webkit.org/blog/156/queryselector-and-queryselectorall/)之类的东西可能会奏效..

# c - 从 C 中的套接字获取通用日志格式的信息

> ID：435431
> 
> 赞同：0
> 
> 时间：2009-01-12T13:45:51.603
> 
> 标签：c, sockets, unix

我想为我在 UNIX 下用 C 语言编写的网络服务器创建一个日志文件。

日志文件应根据[Common Log Format](http://httpd.apache.org/docs/1.3/mod/mod_log_common.html)进行格式化，但我不知道如何从连接套接字获取 ident 和 authuser。

有没有一种简单的方法可以从套接字中获取这些？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T13:52:19.830

用户名不是套接字的属性 - 您需要从 HTTP 请求中获取它，因此套接字 API 无法帮助您。

# .net - 在 WinForms 应用程序中查找焦点控件的首选方法是什么？

> ID：435433
> 
> 赞同：71
> 
> 时间：2009-01-12T13:46:26.113
> 
> 标签：.net, winforms

在 WinForms 中查找当前正在接收用户（键盘）输入的控件的首选/最简单方法是什么？

到目前为止，我想出了以下几点：

```
public static Control FindFocusedControl(Control control)
{
    var container = control as ContainerControl;
    return (null != container
        ? FindFocusedControl(container.ActiveControl)
        : control);
} 
```

从表单中，这可以简单地称为（在 .NET 3.5+ 中，这甚至可以定义为表单上的扩展方法） -

```
var focused = FindFocusedControl(this); 
```

这合适吗？

是否有我应该使用的内置方法？

请注意，在使用层次结构时，一次调用 ActiveControl 是不够的。想象：

```
Form
    TableLayoutPanel
        FlowLayoutPanel
            TextBox (focused) 
```

(formInstance).ActiveControl 将返回对 TableLayoutPanel 的引用，而不是 TextBox（因为 ActiveControl 似乎只返回控件树中的直接活动子项，而我正在寻找叶控件）。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-01-13T16:13:57.547

如果您已经对 Windows API 进行了其他调用，那么使用 Peters 解决方案并没有什么坏处。但我理解您对此的担忧，并且会倾向于使用与您类似的解决方案，仅使用框架功能。毕竟，性能差异（如果有的话）不应该是显着的。

我会采取非递归的方法：

```
public static Control FindFocusedControl(Control control)
{
    var container = control as IContainerControl;
    while (container != null)
    {
        control = container.ActiveControl;
        container = control as IContainerControl;
    }
    return control;
} 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-12T14:07:18.410

在网上搜索后，我在[George Shepherd 的 Windows Forms FAQ上找到了以下内容](http://www.syncfusion.com/faq/windowsforms/faq_c41c.aspx#q1021q)

> .Net 框架库不提供 API 来查询焦点控件。您必须调用 Windows API 来执行此操作：
> 
> [C＃]

```
public class MyForm : Form
{
          [DllImport("user32.dll", CharSet=CharSet.Auto, CallingConvention=CallingConvention.Winapi)]
          internal static extern IntPtr GetFocus();

          private Control GetFocusedControl()
          {
               Control focusedControl = null;
               // To get hold of the focused control:
               IntPtr focusedHandle = GetFocus();
               if(focusedHandle != IntPtr.Zero)
                    // Note that if the focused Control is not a .Net control, then this will return null.
                    focusedControl = Control.FromHandle(focusedHandle);
               return focusedControl;
          }
} 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-12-20T16:33:31.643

窗体或容器上的 ActiveControl*将*返回该实体的活动控件，无论它嵌套在其他容器中的深度如何。

**在您的示例中，如果 TextBox 具有 Focus ：则：对于 Form、TableLayoutPanel 和 FlowLayoutPanel ：*所有这些*的 'ActiveControl 属性将是 TextBox ！**

一些（但不是全部）“真正的” ContainerControl 类型……例如 Form 和 UserControl……公开关键事件（在 Form 的情况下：只有 Form.KeyPreview == true 才能使用它们）。

根据设计包含其他控件（如 TableLayOutPanel、GroupBox、Panel、FlowLayoutPanel 等）的其他控件**不是**ContainerControl 类型，并且它们不公开 KeyEvents。

将TextBox、FlowLayoutPanel、TableLayoutPanel 等对象*实例**直接*转换为 ContainerControl 的任何尝试都不会编译：它们不是 ContainerControl 类型。

已接受答案中的代码以及纠正第一个答案的拼写错误的下一个答案中的代码将编译/接受上述实例作为参数，因为您通过将参数类型设置为“控制”来“向下转换”它们以键入“控制”

但是在每种情况下，对 ControlContainer 的强制转换都将返回 null，并且传入的实例将被返回（向下转换）：本质上是一个无操作。

而且，是的，如果你将修改后的答案代码传递给它一个“真正的”ControlContainer，就像一个Form实例，它位于ActiveControl的父继承路径中，那么修改后的答案代码将起作用，但你仍然只是在浪费时间复制'ActiveControl.'的功能。

那么什么是“真正的”ContainerControls：查看它们：[ContainerControl 的 MS 文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.containercontrol(VS.100).aspx?queryresult=true)

只有 Peter 的回答才真正回答了明确的问题，但该回答带来了使用互操作的代价，并且“ActiveControl 将为您提供所需的东西。

另请注意，每个控件（容器或非容器）都有一个永远不会为空的控件集合，而且很多（我从未尝试过所有这些：我为什么要尝试？）基本的 WinForms 控件让你“疯狂”东西”，例如将控件添加到“简单”控件（如 Button）的 ControlCollection 中而不会出现错误。

**现在，如果您的问题的*真正意图*是询问您如何找到最外层的 ContainerControl** ...*那不是在 Form 本身上*...*常规的非容器*控件嵌套了一些任意级别的深度...您可以使用一些答案中的*想法*：但代码可以大大简化。

常规控件、ContainerControls、UserControls 等（但不是 Form！）都有一个 'Container 属性，您可以访问它们以获取它们的直接容器，但确保在它们的继承路径中拥有不是 Form 的 'final Container 需要一些代码来“向上走”继承树，这在此处演示。

您可能还希望查看 'Control 的 'HasChildren 属性，该属性通常在处理 WinForms 中的 Focus、ActiveControl 和 Select 问题时很有用。回顾 Select 和 Focus 之间的区别在这里可能很有价值，SO 有一些很好的资源。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-10T20:27:02.973

Hinek 的解决方案对我来说效果很好，除了它是*ContainerControl*，而不是 ControlContainer。（以防万一你对那条红色的波浪线摸不着头脑。）

```
 public static Control FindFocusedControl(Control control)
    {
        ContainerControl container = control as ContainerControl;
        while (container != null)
        {
            control = container.ActiveControl;
            container = control as ContainerControl;
        }
        return control;
    } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-13T06:56:04.550

如果您递归地遵循 ActiveControl，它不会带您到具有焦点的叶控件吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-15T14:20:10.367

ActiveControl 并不总是有效，就像 SplitContainer 一样，ActiveControl.Focused 是错误的。

所以对于一个更简单的方法可以做这样的事情：

```
private IEnumerable<Control> _get_all_controls(Control c)
{
    return c.Controls.Cast<Control>().SelectMany(item =>
        _get_all_controls(item)).Concat(c.Controls.Cast<Control>()).Where(control =>
        control.Name != string.Empty);
}

var _controls = _get_all_controls(this);
foreach (Control control in _controls) 
    if (control.Focused)
    {
        Console.WriteLine(control.Name);
        break;
    } 
```

# vb.net - 如何从组合框中的存储 linq 过程中加载数据？

> ID：435434
> 
> 赞同：0
> 
> 时间：2009-01-12T13:46:30.993
> 
> 标签：vb.net, linq-to-sql, stored-procedures, combobox

我在 dbml 文件中有存储过程，我想做这样的事情

```
 Private Sub GetData()
    Dim dal = New DataAccess
    Dim dateList = dal.context.GetAsDateList()
    Dim enumerator As IEnumerator = dateList.GetEnumerator()

    While enumerator.MoveNext()
      cmbDate.Items.Add(enumerator.Current)
    End While
  End Sub 
```

但我有一个空引用异常。如何以正确的方式做到这一点？

GetAsDateList() 过程是

```
BEGIN
 SET NOCOUNT ON
 SELECT DISTINCT YEAR(TRADE_DATE) AS [Year], MONTH(TRADE_DATE) AS [Month] FROM MyTable
 RETURN
END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T14:07:30.767

你能不能

```
Private Sub GetData()
    Dim dal = New DataAccess
    Dim dateList = dal.context.GetAsDateList()

    cmbData.DataSource = dateList
    cmbData.DataBind()
End Sub 
```

# java - Applet 可以打开一个新的 HTML 窗口*并*绕过弹出窗口阻止程序吗？

> ID：435437
> 
> 赞同：0
> 
> 时间：2009-01-12T13:46:49.903
> 
> 标签：java, applet

我们的 java 小程序需要向网络浏览器打开一个新的 htm 页面，但弹出窗口阻止程序似乎阻止了此代码：

```
 try
    {
      AppletContext a = getAppletContext();
      URL url = new URL(link);
      a.showDocument(url,"_blank");
    } 
```

你能用某种方式使用实时javascript来打开一个窗口吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T13:51:31.623

我可能没有帮助，但弹出窗口阻止程序的任务是阻止弹出窗口。如果有办法欺骗它，它毕竟不是一个好的拦截器。

您必须建议您的用户禁用弹出窗口阻止程序以使用您的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T21:28:17.880

`AppletContext`show document 是通过执行 JavaScript 调用来实现的。但是，弹出窗口阻止程序使用的上下文可能不存在。如果点击发生在小程序之外，您可以只使用 JavaScript 打开弹出窗口，但使用小程序提供的 URL（因此小程序不必调用 JavaScript）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T13:50:34.183

我相当确定任何值得其盐分的弹出窗口阻止程序都会阻止弹出窗口。不管你在你的页面上放了什么，实际上产生一个新窗口的方法很少，而且几乎可以肯定所有这些都会被覆盖。

因此，请考虑您是否真的需要在客户端可能安装了这些的环境中生成弹出窗口。如果这是一个合法的目的，要求客户在他们的弹出窗口阻止程序中将您的网站列入白名单可能不是不合理的。

# javascript - 如何从 Perl CGI 程序发送 JSON 响应？

> ID：435442
> 
> 赞同：20
> 
> 时间：2009-01-12T13:48:10.117
> 
> 标签：javascript, perl, json

我正在编写来自 perl/cgi 程序的 JSON 响应。标头的内容类型需要是“application/json”。但它似乎没有被识别，因为响应是作为文本文件抛出的。

我将使用 jQuery 的 JSON 库来捕获响应。我在发送 JSON 响应时遗漏了哪里。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-12T14:20:28.913

我在 perl/cgi 程序中这样做。

我在我的代码顶部使用这些：

```
use CGI qw(:standard);
use JSON; 
```

然后我打印 json 标头：

```
print header('application/json'); 
```

这是一种内容类型：

```
Content-Type: application/json 
```

然后我像这样打印出 JSON：

```
my $json->{"entries"} = \@entries;
my $json_text = to_json($json);
print $json_text; 
```

我的javascript调用/处理它是这样的：

```
 $.ajax({
        type: 'GET',
        url: 'myscript.pl',
        dataType: 'json',
        data: { action: "request", last_ts: lastTimestamp },
        success: function(data){
            lastTs = data.last_mod;
            for (var entryNumber in data.entries) {
                 //Do stuff here
            }
        },
        error: function(){
            alert("Handle Errors here");
        },
        complete: function() {
        }
    }); 
```

如果您不想安装 JSON 库，则不一定非要使用它，您可以直接打印 JSON 格式的文本，但它可以很容易地将 perl 对象转换为 JSON。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T14:11:58.400

即使您指定类型“application/json”，您仍然需要解析文本。jQuery 为您执行此操作，使用 $.getJSON 函数，即：

```
$.getJSON("http://someurl.com/blabla.json",{some: "info"},function(json){
  alert(json["aKey"]["anotherOne"]);
}); 
```

（这里是[规格](http://docs.jquery.com/Ajax/jQuery.getJSON#urldatacallback)）。

但也许您已经意识到这一点，所以问题出在其他地方：您能否告诉我们您的 json 响应示例，因为问题可能是无效的。我不太清楚为什么你说“似乎没有被识别”：当我编写 json 服务时，我做的第一个测试是在浏览器上调用它们，也许会启动 firebug 并尝试解析它（所以是的响应这是一个文本响应，但是 javascript 它仍然很乐意解析它并返回一个 json 对象）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-21T17:18:17.890

**以下是如何在Perl 的 Web 框架[Mason中生成请求。](http://masonhq.com)**

*Mason 类似于 Pylons 或 Ruby On Rails。*

```
<%init>

use JSON;

my %hash = { a => 'a', b => 'b' };
my @list = ( 1, 2, \%hash );

# Mason object $r for Apache requests, automatically sets the header
$r->content_type('application/json');

# Pass a reference to anything (list, hash, scalar) for JSON to encode
my $json = new JSON;
print $json->encode(\@list);

</%init> 
```

**然后在[Prototype](http://prototypejs.org)中处理它，JavaScript 网络抽象：**

```
var req = new Ajax.Request('request.html', {
    method: 'get',
    parameters: {
        whatever: 'whatever'
    },
    onCreate: function() {
        // Whatever
    },
    onSuccess: function(response) {
        // This only works if you set the 'application/json' header properly
        var json = response.responseJSON;

        // Since you sent a list as the top-level thing in the JSON,
        // then iterate through each item
        json.each(function(item) {
            if (item instanceof Object) {
                item = new Hash(item);
            } else if (item instanceof Array) {
                // Do array stuff
            } else {
                // Do scalar stuff
            }
        });
    },
    onFailure: function() {
        // Failed
    }
}); 
```

# string - 在运行时更改多租户应用程序的 XSD ConnectionString

> ID：435444
> 
> 赞同：8
> 
> 时间：2009-01-12T13:48:55.593
> 
> 标签：string, xsd, dataset, connection, multi-tenant

我正在将我们的应用程序从“一组代码和一个数据库”更改为“一组代码到多个数据库（每个客户一个数据库）”。

原始代码是 VS2005 ASP.NET(VB) 和大量 XSD 在单独的 DLL 中。web.config 的 ConnectionString 将在运行时覆盖存储在 DLL 中的连接字符串。

现在我需要在每次声明数据适配器/数据集/表时更改 ConnectionString，因为调用可能会与上次调用不同的数据库。

有人对此有任何提示吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T17:01:41.007

经过一番研究，XSD 似乎有一个名为 ConnectionModifier 的属性。

要找到它，请在 XSD 图表上单击图表的 TableAdapter 部分（定义查询的位置）。

在属性窗口中，将 ConnectionModifier 更改为 Public，然后单击 Save。（这似乎也改变了该页面上所有数据集的属性。）

回到您网站的主代码，您现在可以执行以下操作：

```
'declare the adapter as normal
Dim AdapterTest As New DataSetTestTableAdapters.TestTableAdapter

'pass the new connection object into the now visible property
AdapterTest.Connection = New Data.SqlClient.SqlConnection("Data Source=Myserver;Initial Catalog=TEST;Integrated Security=True;") 
```

它只需要一个连接对象。

我还没有对此进行适当的测试！不幸的是，每次您从 XSD 声明某些内容时，都必须传递一个新的连接对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T14:21:48.680

还发现虽然提到的属性（ConnectionModifier）是Public，但是当它是QueriesTableAdapter时，仍然无法通过代码看到。因此，我不得不花很长时间删除这些并用普通的“使用查询”块替换它们。

另外，我相信这个项目现在看起来更快了。这可能是尺寸的减小或现在对所有调用使用“使用”（原始代码在我们的 .NET 时代很早，所以本来可以写得更好）。

# javascript - 具有多个句柄的 Jquery Draggable

> ID：435446
> 
> 赞同：6
> 
> 时间：2009-01-12T13:49:23.627
> 
> 标签：javascript, jquery, jquery-ui, draggable, jquery-ui-draggable

是否可以有一个`draggable`具有多个手柄的元素？

我将它初始化两次，每次都使用不同的句柄参数，但它不起作用 - 只有第一个起作用。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-12T14:03:38.090

您应该只传递一次“句柄”参数，它可以是选择器或元素（/s）。

因此，要使其与多个句柄一起使用：

```
$(elem).draggable({
    handle: '#handle1, #handle2',
}); 
```

更多信息/来源：[http ://docs.jquery.com/UI/Draggables/draggable](http://docs.jquery.com/UI/Draggables/draggable)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T14:11:21.787

当然。只需选择这些处理程序即可。

例如：

```
$(element).Draggable({handle:'.handler'}); 
```

# c# - XAML 到 C# 的转换工具

> ID：435452
> 
> 赞同：1
> 
> 时间：2009-01-12T13:51:10.190
> 
> 标签：c#, xaml, baml

是否有 XAML 到 C# 的转换工具？我在 XAML 中定义了一个控件模板，但我想使用 C# 创建这个模板及其样式，所以我可以混淆代码版本（因为我不能混淆 XAML/BAML）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T14:00:03.870

据我所知，没有一种工具可以将 XAML 转换为 C#，但它仍然可以生成 WPF（或 WF，具体取决于您所谈论的 XAML）。

也就是说，您想要混淆 XAML，并且有一些工具可以做到这一点。我听说的一个叫做 {smartassembly} .NET Obfuscator 3.0 - [http://www.smartassembly.com/](http://www.smartassembly.com/)

# c# - VS2008项目文件中的资源被表单设计者创造性地“重用”，可以避免吗？

> ID：435466
> 
> 赞同：4
> 
> 时间：2009-01-12T13:53:44.083
> 
> 标签：c#, visual-studio-2008, resources, form-designer

我们在 Visual Studio 2008 中的项目中有一些自动生成的资源文件，其中包含一些本地化版本，在其中一个本地化版本中，有一个字符串在这种情况下为空。

更明确。我们有一个核心资源文件，里面有很多字符串资源。然后，我们有此文件的 4 个其他本地化版本，并且在这些其他本地化文件之一中，字符串之一被赋予一个空值。

现在的问题是表单设计者很高兴找到了一个字符串的资源，并且显然会不择手段地为任何空字符串重用该资源，它将在生成的设计器代码中为表单分配一个属性。

例如，如果由于某种原因没有为控件上的属性指定默认值（因此即使它是空的，它也会被序列化为代码），那么它将引用我们的资源，而不是在C# 代码。

问题是它引用了本地化版本，并且这些版本没有编译为代码。

这是一个简短的代码示例：

```
this.rpAllFields.KeyTip = 
  global::namespaces.SystemMessagesResources_sv_SE.
    dash_red_shift_info_description; 
```

在这种情况下，`dash_red_shift_info_description`sv-SE 语言环境没有值，因此设计人员在看到代码中的空字符串时，将尝试链接到该资源。但是 SystemMessagesResources_sv_SE 不是现有的类，而是似乎为 SystemMessagesResources 资源文件的瑞典本地化版本生成的类名，该文件*被*编译为一个类。

这可以避免吗？每次我们更改表单文件中的某些内容时，我们都会对搜索/替换感到厌倦，而且我们很确定我们已经做了一个让这种情况发生的事情，但我们是显然我们自己无法找到原因。

如果我们删除资源，上面的代码将如下所示：

```
this.rpAllFields.KeyTip = ""; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T02:38:56.803

如果问题是由资源文件中的空字符串引起的，那么将其设为空格会产生什么影响。因此，资源文件包含“”而不是“”。我不知道这是否是最好的解决方案，但我很想知道它是否会阻止设计者将该资源用作默认的空字符串。但是，不知道它是如何使用的，我不确定将一个应该未定义的值定义为空格会产生什么影响......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T19:07:35.747

您可以尝试创建一个字符串资源empty_string，为每个语言环境定义为“”。如果您将其作为第一个资源，表单设计者将（希望）始终选择该资源作为贯穿您表单的值。这样至少您将使用为此目的指定的字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T15:15:56.683

您需要多少值为空字符串的资源？我可以想象一些多语言场景，其中某些资源键应该对应于某些支持的语言中的空白（如果您对某些 UI 元素使用字符串连接），是的。

但如果我的场景不是这样的，我只会用空字符串废弃资源条目。我只想说，“无论如何，什么独立的 UI 文本转换为空白？”。

*如果在某些*情况下我真的需要资源是空白的（它代表一种语言的文章，而另一种语言中不存在等效的词），我会尝试看看我是否可以通过其他方式产生相同的效果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T15:23:40.583

生成的资源文件和代码示例会很好。

你的意思是：你的命名空间中有一个空字符串文字定义（找到的第一个），但这会导致一些问题吗？它不会一直是空的吗？当你编译代码时——它会做一些奇怪的事情来节省空间。我在生成带有代码隐藏的 XAML 文件以即时自动构建程序集文件时遇到了类似的问题：编译器足够聪明，可以知道“它没有任何区别，但对我们来说确实有区别，因为它会重命名文字（在其他地方使用过）。

为了解决这个问题，我们在命名空间中为这些原语使用了命名类型，并将其设为全局。我在这里看到的是您的全局命名空间正在填补空白——您可能希望有一个“下面”来评估所有空字符串。

我已经一年多没有使用这个了，所以如果我的措辞很糟糕，请原谅我，但我的意思是：想想 XML。您需要在属性中显式使用命名空间或将它们分配得更低（如 xaml 中的附加属性）。

我希望这会有所帮助（并且有意义）

# java - 为什么我无法在 Web 服务“Hello world”示例中生成客户端代码？

> ID：435474
> 
> 赞同：2
> 
> 时间：2009-01-12T13:55:52.833
> 
> 标签：java, web-services

链接是： http: [//people.apache.org/~ruchithf/hw-axis2/](http://people.apache.org/~ruchithf/hw-axis2/)。

命令行是：`javac -extdirs d:\lib\ D:\stub\src\org\apache\ws\axis2\*.java -d d:\clientcode\`

错误是：

```
C:\Program
Files\Java\jdk1.6.0\bin>javac -extdirs
d:\lib\ D:\stub\src\org\apache
\ws\axis2\*.java -d d:\clientcode\
D:\stub\src\org\apache\ws\axis2\Client.java:3:
cannot find symbol symbol  : class
EchoRequest location: class
org.apache.ws.axis2.SimpleServiceStub
import
org.apache.ws.axis2.SimpleServiceStub.EchoRequest;
                                            ^
D:\stub\src\org\apache\ws\axis2\Client.java:12:
cannot find symbol symbol  : class
EchoRequest location: class
org.apache.ws.axis2.Client EchoRequest
request = new
SimpleServiceStub.EchoRequest(); ^
D:\stub\src\org\apache\ws\axis2\Client.java:12:
cannot find symbol symbol  : class
EchoRequest location: class
org.apache.ws.axis2.SimpleServiceStub
EchoRequest request = new
SimpleServiceStub.EchoRequest();
                                           ^ Note:
D:\stub\src\org\apache\ws\axis2\SimpleServiceStub.java
uses unchecked or u nsafe operations.
Note: Recompile with -Xlint:unchecked
for details. 3 errors C:\Program
Files\Java\jdk1.6.0\bin>javac -extdirs
d:\lib\ D:\stub\src\org\apache
\ws\axis2\*.java -d d:\clientcode\
D:\stub\src\org\apache\ws\axis2\Client.java:3:
cannot find symbol symbol  : class
EchoRequest location: class
org.apache.ws.axis2.SimpleServiceStub
import
org.apache.ws.axis2.SimpleServiceStub.EchoRequest;
                                            ^
D:\stub\src\org\apache\ws\axis2\Client.java:12:
cannot find symbol symbol  : class
EchoRequest location: class
org.apache.ws.axis2.Client EchoRequest
request = new
SimpleServiceStub.EchoRequest(); ^
D:\stub\src\org\apache\ws\axis2\Client.java:12:
cannot find symbol symbol  : class
EchoRequest location: class
org.apache.ws.axis2.SimpleServiceStub
EchoRequest request = new
SimpleServiceStub.EchoRequest();
                                           ^ Note:
D:\stub\src\org\apache\ws\axis2\SimpleServiceStub.java
uses unchecked or u nsafe operations.
Note: Recompile with -Xlint:unchecked
for details. 3 errors 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-13T19:05:27.933

IIRC, the axis stub generator is old, and generates pre 1.5 (maybe even pre 1.4) java source code. Try setting the source flag, and see what happens.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T14:21:50.907

检查 Axis 库是否真的在 D:\stub\src\org\apache\ws\

...并尝试使用双反斜杠： D:\\stub\\src\\org\\apache\\ws 和 d:\\lib

由于我使用的是 Linux，因此我无法重现您的问题，而且我记得 Windows 用户有时会遇到反斜杠问题。

# .net - 如何为 x86 和 CF.Net 目标使用相同的 C# 2008 项目？

> ID：435476
> 
> 赞同：2
> 
> 时间：2009-01-12T13:56:37.713
> 
> 标签：.net, compact-framework

我在 VS2008 中有一个 C# 项目，我希望为两个目标构建 - x86 和 dot net (CF.Net) 的紧凑框架，具体取决于所选配置（例如 Debug/SmartDeviceDebug 等）。我该怎么做？我有一个暗示，这可以使用命令行和 msbuild 以某种方式完成，但我对在 VS2008 中工作的解决方案感兴趣。

请注意，我暂时为这两种目标类型使用了两个不同的项目，但要在它们之间保持文件同步是一件苦差事。添加文件作为链接也无济于事（它不是一个可扩展的解决方案，文件的名称和数量变化太频繁。）

任何和所有的建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T14:05:54.293

我相信 csproj 必须完全不同才能为不同的框架构建。但是，有技巧；例如，您可以在 csproj 中使用通配符。我在[protobuf-net](http://code.google.com/p/protobuf-net/)中使用它，它基于 .NET 2.0/3.0/CF 2.0/CF 3.5/Silverlight/Mono - 所以我知道你的意思！

看看我的[CF 2.0 csproj](http://code.google.com/p/protobuf-net/source/browse/trunk/protobuf-net-CF20/protobuf-net-CF20.csproj)；尤其：

```
<ItemGroup>
    <Compile Include="..\protobuf-net\**\*.cs" />
</ItemGroup> 
```

即在主项目中的任何级别查找所有 .cs 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T14:33:42.023

通常，您有两个问题 - 文件属于一种类型但不是另一种类型，以及 CF 和 FFx 之间的引用不同。这些问题*可以*通过手动操作项目文件来解决，但请注意，VS IDE 不喜欢你处理这些问题（它不知道当你的配置更改时它应该重新加载整个项目）。

你可以做什么：

*   从一个 CF 项目开始（你可以从 eitehr 开始，但这就是我们的做法）
*   添加新配置 - 将其命名为“桌面”或您喜欢的任何名称
*   修改 CF 解决方案，使其更明显（命名为 Debug CF 或其他）
*   使用文本编辑器打开项目文件 (*.csproj)。您会发现几个[ItemGroup 节点](http://msdn.microsoft.com/en-us/library/646dk05y.aspx)。这里的重要部分是 msbuild 支持此节点的条件。

因此，如果您有一个用于项目引用的节点，看起来像这样

```
<ItemGroup>
  <Reference Include="System" />
</ItemGroup> 
```

您可以将其修改为

```
<ItemGroup Condition=" '$(Configuration)|$(Platform)' == 'Desktop|AnyCPU' >
  <Reference Include="System, Version=2.0.0.0, Culture=neutral,
       PublicKeyToken=b77a5c561934e089, processorArchitecture=MSIL" />
</ItemGroup> 
```

请注意，您必须在此处为其提供*全*名。

然后，您可以类似地修改 ItemGroup 节点以将文件包含到每个项目中。

现在你已经完成了简单的部分。接下来，您必须按摩[PropertyGroup 节点](http://msdn.microsoft.com/en-us/library/t4w159bs.aspx)。这是查看 CF 项目文件和 FFx 项目文件并将相关节点放入条件父节点的问题。请特别注意**ProjectTypeGuids**和**PlatformFamilyName**之类的内容。

综上所述，我们发现只为需要重叠的 CF 和 FFx 版本维护单独的项目文件的工作量更少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T14:07:57.287

你不能（至少，我不知道）。

首先，项目引用是每个项目的，而不是每个选择的配置，所以你被迫坚持使用 cf dll，因此无法使用常规框架的功能。

这是一个痛苦的屁股，我理解你的问题，因为我正在遭受它们的痛苦:(

# c# - SSIS - PipelineComponent 中的 ProcessInput 被多次调用

> ID：435487
> 
> 赞同：2
> 
> 时间：2009-01-12T14:00:02.980
> 
> 标签：c#, ssis, pipeline

伙计们。我正在为 SSIS 开发一个自定义组件。我在处理输入时遇到问题。问题是“ProcessInput”方法被多次执行。在这种情况下两次。

这是流程输入片段：

```
public override void ProcessInput(int inputID, PipelineBuffer buffer)
{
    IDTSInput90 input = ComponentMetaData.InputCollection.GetObjectByID(inputID);
    if (input.InputColumnCollection.Count > 0)
    {
        while (buffer.NextRow())
        {
            try
            {
                for (int columnIndex = 0; columnIndex < input.InputColumnCollection.Count; columnIndex++)
                {

                    ColumnInfo columnInfo = _columnInfos[input.InputColumnCollection[columnIndex].ID];
                    IDTSInputColumn90 inputColumn = input.InputColumnCollection[columnIndex];
                    try
                    {
                        //write to destination
                    }
                    catch (Exception writeEx)
                    {
                        throw new Exception("Couldn't write to destination");
                    }
                }
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
    }
    else
    {
        throw new Exception("There is no columns in the input collection");
    }

} 
```

我不知道为什么它被调用了两次。这是数据流：

[数据流 http://img371.imageshack.us/img371/3001/dataflowprocessinputrb6.png](http://img371.imageshack.us/img371/3001/dataflowprocessinputrb6.png)

这是映射窗口： [映射窗口 http://img78.imageshack.us/img78/3772/mappingprocessinputzs2.png](http://img78.imageshack.us/img78/3772/mappingprocessinputzs2.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T16:32:04.763

这是设计使然。SSIS 以块（SSIS 术语中的缓冲区）发送数据，以优化内存使用。缓冲区大小是有限的，因此 SSIS 不必将所有数据读入内存（否则 SSIS 将无法处理 TB 级数据）。因此，您可以获得多个 ProcessInput 调用 - 每个缓冲区一个 ProcessInput 调用。

此外，您将在最后获得一个 EndOfRowset 标志设置为 true 的空缓冲区。但是不要依赖这个——这更多的是一个实现细节（最后一个缓冲区被记录为 EndOfRowset = true，但它没有被记录为空）。

# mips - Pascal 到 Mips 代码转换

> ID：435491
> 
> 赞同：1
> 
> 时间：2009-01-12T14:01:33.960
> 
> 标签：mips, pascal

我目前正在为我的 Pascal Parser (Written in C using Lex / Yacc) 开发 Mips 代码生成器。有没有人知道我可以用作参考以确保正确的代码生成的工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T14:07:50.233

这是一个[mips 模拟器](http://pages.cs.wisc.edu/~larus/spim.html)。我在学校用它来检查和运行我的 mips 项目。我记得的一件事是这个模拟器有一些真正的 mips 编译器没有的命令（让我们学生更容易）。我很确定这一切都记录在案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T14:30:28.503

您可以为 MIPS 目标构建[GNU Pascal 编译器](http://www.gnu-pascal.de/gpc/h-index.html)，作为交叉编译器。

# asp.net - ASP.NET 是多线程的（它是如何执行请求的）

> ID：435492
> 
> 赞同：21
> 
> 时间：2009-01-12T14:01:48.063
> 
> 标签：asp.net, multithreading

这可能是一个有点愚蠢的问题，但是；

如果我有两个人同时登录到我的站点，服务器端代码是一个接一个地执行，还是在不同的线程中同时执行？

我很好奇对网站登录的拒绝服务攻击。服务器变慢是因为它有大量的登录队列，还是因为它有十亿个同时登录而变慢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-12T14:08:49.017

这与 ASP.NET 本身无关（我在该领域知之甚少），但通常与 Web 服务器有关。大多数 Web 服务器使用线程（或进程）来处理请求，因此基本上，您拥有的任何代码片段都将并行执行两个连接。当然，如果您访问一个数据库或其他一些放置了锁的后端系统，只允许一个会话执行查询，您可能已经隐式序列化了所有请求。

Web 服务器通常具有最小和最大数量的工作人员，这些工作人员针对当前硬件（CPU、内存等）进行了调整。如果这些都用完了，新请求将排队等待工作人员可用，或者直到达到待处理请求的最大队列长度，此时它忽略新连接，有效地拒绝服务（如果这是故意的，它被称为拒绝服务或 DoS 攻击）。

所以，用你的话来说，它是一个组合，它是大量同时请求填满队列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T14:06:28.083

它应该使用线程池。请注意，它们仍然在同一个应用程序中，因此静态变量等应用程序级项仍然在它们之间共享。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T14:07:48.173

从[这篇文章](http://www.west-wind.com/presentations/howaspnetworks/howaspnetworks.asp)

> "**请记住 ISAPI 是多线程的**，因此请求将通过 ApplicationDomainFactory.Create() 返回的引用**进入多个线程**。清单 1 显示了 IsapiRuntime.ProcessRequest 方法的反汇编代码，该方法接收 ISAPI ecb 对象和服务器类型为参数。该方法是线程安全的，因此多个 ISAPI 线程可以安全地同时调用这个返回的单个对象实例。

所以是的，在 DOS 攻击的情况下，由于大量连接，它会很慢

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T14:26:14.113

正如其他人所说，大多数网络服务器使用多个进程或线程（更好）一次服务多个请求。特别是，您可以为每个 ASP.NET 应用程序池设置最大排队请求数和最大工作进程数。每个进程最多有多个线程（不可配置的 AFAIK，我可能是错的），并且传入的请求是在先进先出的基础上处理的。

此外，ASP.NET 为每个会话处理一个请求 - 但恶意用户可以打开任意数量的会话。

多次登录可能会击中数据库，并可能在网络服务器本身之前使其屈服。

据我所知，除了设置排队请求的最大数量（等待处理）之外，没有内置的方法来限制 ASP.NET 请求。理想情况下，这个数字应该非常小。您可以使用性能计数器监视排队的 ASP.NET 请求的数量。假设您发现，在高峰流量时，此数字为 100。然后您可以更新应用程序，以便在此数字高于 100 时拒绝登录尝试，从而不会命中数据库（从未这样做过，只是一个想法）。

# php - 主页大纲配置文件编辑器

> ID：435495
> 
> 赞同：0
> 
> 时间：2009-01-12T14:03:10.947
> 
> 标签：php, ide

自从 Allaire 拥有 HomeSite 以来，我一直在使用它。我从纯 HTML 开始，然后是经典的 asp，现在我已经将它用于 PHP 开发有一段时间了，但有一个我真正想要的功能，而 Homesite 似乎只是有时这样做。大多数 IDE 会在页面上显示函数列表。Homesite 将使用 Tag Inspector 功能来执行此操作。如果我有一个只是 PHP 用户定义函数（例如`require('functions.php')`）的文件，那么所有函数都可以正常显示。但是，如果我的页面主要是添加了 PHP 函数的 HTML 页面，则它们不会显示在大纲中。

我想我可以让我的所有功能成为“必需”文件的一部分，但我想知道是否有任何家庭运动员可能知道一种更可靠的方法来创建显示用户定义功能的大纲配置文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-13T00:09:40.817

我自己用过 Homesite。Topstyle 有点接手了它（它是由同一个人），现在 TS 本身已经被出售，版本 4 - [http://www.topstyle4.com/](http://www.topstyle4.com/) - （现在处于测试阶段）。

文件/类/函数的代码洞察力不再是特别独特了——我认为各种基于 Eclipse 的 IDE 和 Komodo IDE 现在也可以做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-15T19:18:06.120

我不使用主页，但听起来它可能会关闭文件扩展名。尝试使用不同的扩展名保存您的文件，例如：将“yourfile.html”另存为“yourfile.phtml”。

# apache-flex - Flex [Bindable] 标签有什么作用？

> ID：435527
> 
> 赞同：6
> 
> 时间：2009-01-12T14:14:38.583
> 
> 标签：apache-flex

意义 。. . 我见过将组件绑定到 [Bindable] dataProvider 的案例。当我更新 dataProvider 中的数据时，组件不会立即反映更改。我需要做些什么来刷新数据吗？什么事件导致组件刷新其 dataProvider 数据？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-12T23:30:04.123

这可能有点矫枉过正，但如果您真的对添加 [Bindable] 标记时发生的事情感兴趣，我强烈建议您查看 Michael Labriola在360|Flex!San Jose*的 Data Binding Waters 会话中的潜水。*这是迄今为止你会发现的关于这个主题的最深入的介绍。

要查看它，您需要下载[Adob​​e Media Player](http://www.adobe.com/products/mediaplayer/)（在 Adob​​e Air 上运行）。如果您在 Adob​​e Media Player 中订阅 360|Flex 会话时遇到问题，请按照 Ted Patrick 的建议，从**已删除链接**他的博客文章中获取。

他的演示文稿也在[Slideshare](http://www.slideshare.net/michael.labriola/diving-in-the-flex-data-binding-waters-presentation?src=embed)上，但远没有提供丰富的信息或娱乐性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T05:18:26.620

开发人员指南的第 7 章正好涉及到这一点。我建议你阅读它。

摘抄：

> 尽管原始数据对象（例如字符串或对象数组）在您将它们用作 dataProvider 属性的值时被包装在集合中，但显式使用集合是一种更好的做法。使用集合显式确保数据同步，并提供比直接使用原始对象作为数据提供者时更简单和更复杂的数据访问和操作工具。集合还可以为访问和管理不同类型的数据提供一致的接口。

另请参阅[有关](http://livedocs.adobe.com/flex/3/html/databinding_4.html#190263)数据绑定和数组的内容

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T14:58:44.000

这取决于你对数据做了什么。您是否应用了过滤器，如果是，则需要刷新数据。你做了排序，如果是这样，你需要刷新数据。你的 dataProvider 是一个数组吗，如果是这样，这不做绑定，使用一个 ArrayCollection。

给我们一个没有更新的例子，我们应该能够提供具体的帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T15:03:01.620

如果您喜欢摆弄命令行编译器，可以使用该`compile.keep-generated-actionscript`标志来查看添加`[Bindable]`到属性的效果。创建一个名为 test 的简单 actionscript 类并向其添加单个可绑定字符串属性，然后像这样编译它：

`mxmlc -compiler.keep-generated-actionscript test.as`

这将创建一个名为“generated”的文件夹，其中包含所有额外的操作脚本，在这种情况下，它将是一个名为（可能）“_test-binding-generated.as”的文件。

您应该可以从中看出，添加可绑定标签只是创建了一个包装器，该包装器实现了 IEventDispatcher 并在调用 setter 时调度了一个事件。您的组件将收听的是这个包装器。

如果您的组件没有立即反映其显示的变化，这可能意味着您必须查看该组件的重绘代码。Tree 控件因此类问题而臭名昭著，主要是因为更新成本可能很高。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T17:33:25.997

“当属性是数据绑定表达式的源时，当源属性更改时，Flex 会自动将源属性的值复制到任何目标属性。要向 Flex 发出信号以执行复制，您必须使用 [Bindable] 元数据标记向 Flex 注册属性，并且源属性必须调度一个事件。”

# c# - 继承和关联

> ID：435529
> 
> 赞同：1
> 
> 时间：2009-01-12T14:15:12.700
> 
> 标签：c#, linq-to-sql

我需要创建一个数据库结构，其中“供应商”从“客户”继承。我曾经在客户上有一个我想转移到供应商的关联，但我可以弄清楚如何定义它。IN VS 当我向供应商添加关联时，我只能关联供应商中明确定义的字段（并且我需要关联 Client.Id）。

我可以使用在供应商中添加 ClientId 的解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T14:21:26.027

（更新）

对; 我明白你的意思了。我怀疑使用 LINQ-to-SQL 你只能关联到基类，它会给你适当的类型。`OfType<T>`您可以使用等进行过滤。

您不能简单地将 id 添加到派生类，因为在检查查询表达式时它需要由 LINQ 解析 - 而定制的独立属性则不会。

但是，我还记得这在 EF 中是可能的（即使我不太喜欢 EF ;-p）。

# signal-processing - 检测基频

> ID：435533
> 
> 赞同：19
> 
> 时间：2009-01-12T14:19:22.113
> 
> 标签：signal-processing, detect, frequency, pitch-tracking

印度 IIT-Bombay 有一个科技节，他们在那里举办了一个名为“Artbots”的活动，我们应该设计具有艺术能力的艺术机器人。我有一个关于音乐机器人的想法，它以歌曲为输入，检测歌曲中的音符并在钢琴上播放。我需要一些方法来帮助我计算歌曲音符的音高。关于如何去做的任何想法/建议？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-12T15:34:30.607

这正是我作为我去年的项目在这里所做的:) 除了我的项目是关于跟踪人类歌声的音高的一件事（而且我没有机器人来演奏曲调）

我能想到的最快方法是利用[BASS 库](http://www.un4seen.com/bass.html)。它包含即用型功能，可以为您提供来自默认记录设备的 FFT 数据。看一下 BASS 附带的“livespec”代码示例。

顺便说一句，原始 FFT 数据不足以确定基频。您需要诸如**[谐波乘积谱](http://cnx.org/content/m11714/latest/)**之类的算法来获得 F0。

另一个考虑因素是音频源。如果您要进行 FFT 并在其上应用谐波乘积频谱。您需要确保输入只有一个音频源。如果它包含多个来源，例如在现代歌曲中，则需要考虑很多频率。

> **谐波乘积谱理论**
> 
> 如果输入信号是一个音符，那么它的频谱应该由一系列峰值组成，对应于基频，谐波分量是基频的整数倍。因此，当我们多次压缩频谱（下采样）并将其与原始频谱进行比较时，我们可以看到最强的谐波峰值排列。原始光谱中的第一个峰与压缩了两倍的光谱中的第二个峰重合，这与压缩了三倍的光谱中的第三个峰重合。因此，当各种频谱相乘时，结果将在基频处形成清晰的峰值。
> 
> **方法**
> 
> 首先，我们通过应用汉宁窗将输入信号分成多个段，其中窗口大小和跳数大小作为输入给出。对于每个窗口，我们利用短时傅里叶变换将输入信号从时域转换到频域。一旦输入在频域中，我们将谐波乘积频谱技术应用于每个窗口。
> 
> HPS 包括两个步骤：下采样和乘法。为了下采样，我们通过重采样在每个窗口中将频谱压缩两次：第一次，我们将原始频谱压缩 2 倍，第二次压缩 3 倍。一旦完成，我们将三个光谱相乘并找到对应于峰值（最大值）的频率。该特定频率代表该特定窗口的基频。
> 
> **HPS 方法的局限性**
> 
> 这种方法的一些不错的特点包括：计算成本低、对加性和乘性噪声具有合理的抵抗力，并且可以针对不同类型的输入进行调整。例如，我们可以改变要使用的压缩光谱的数量，我们可以用光谱加法代替光谱乘法。然而，由于人类音高感知基本上是对数的，这意味着低音高的跟踪可能不如高音高准确。
> 
> HPS 方法的另一个严重缺陷是它的分辨率仅与用于计算频谱的 FFT 的长度一样好。如果我们执行一个短而快速的 FFT，我们可以考虑的离散频率的数量是有限的。为了在我们的输出中获得更高的分辨率（因此在我们的音高输出中看到更少的颗粒感），我们需要更长的 FFT，这需要更多的时间。

来自：[http ://cnx.org/content/m11714/latest/](http://cnx.org/content/m11714/latest/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-13T01:53:46.987

只是评论：（谐波）声音*中也可能缺少基本谐波*，这不会改变感知的音高。作为极限情况，如果您采用方波（例如，C# 音符）并完全抑制一次谐波，则感知到的音符仍然是 C#，*在相同的 octave*中。在某种程度上，当我们的大脑猜测一个音符时，它能够补偿一些谐波的缺失，即使是第一个。因此，要使用频域技术检测音高，您应该考虑*所有*谐波（傅里叶变换幅度的局部最大值），并提取它们频率的某种“最大公约数”。音高检测根本不是一个微不足道的问题......

[DAFX](https://rads.stackoverflow.com/amzn/click/com/0471490784)有大约 30 页专门用于音高检测，包括示例和 Matlab 代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-20T17:06:29.527

自相关 - [http://en.wikipedia.org/wiki/Autocorrelation](http://en.wikipedia.org/wiki/Autocorrelation)

过零 - [http://en.wikipedia.org/wiki/Zero_crossing](http://en.wikipedia.org/wiki/Zero_crossing)（这种方法用于廉价的吉他调音器）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-10T06:44:06.133

试试[YAAPT 音高跟踪](http://ws2.binghamton.edu/zahorian/yaapt.htm)，它可以检测时域和频域中的基频。您可以从链接下载 Matlab 源代码，并使用频谱处理部分在 FFT 输出中查找峰值。

Python 包[http://bjbschmitt.github.io/AMFM_decompy/pYAAPT.html#](http://bjbschmitt.github.io/AMFM_decompy/pYAAPT.html#)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-24T14:22:44.440

要从复音音乐中提取旋律的基频，您可以尝试使用 MELODIA 插件：[http ://mtg.upf.edu/technologies/melodia](http://mtg.upf.edu/technologies/melodia)

提取歌曲中所有乐器的 F0（多 F0 跟踪）或将它们转录成音符是一项更加艰巨的任务。旋律提取和音乐转录仍然是开放的研究问题，因此无论您使用哪种算法/工具，都不要期望获得完美的结果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-06T16:11:08.467

只是一个想法 - 但您是否需要处理数字音频流作为输入？

如果不是，请考虑使用音乐的符号表示（例如 MIDI）。然后，音符的音高将被明确说明，您可以非常轻松地合成与音高、节奏和许多其他音乐参数相对应的声音（和动作）。

如果您需要分析数字音频流（mp3、wav、实时输入等），请记住，虽然简单单声道声音的音高检测非常先进，但复音音高检测是一个未解决的问题。在这种情况下，您可能会发现我对[这个问题](https://stackoverflow.com/questions/597743/music-transcription/597804#597804)的回答很有帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-12T14:34:44.593

你试过[维基百科关于音高检测的文章](http://en.wikipedia.org/wiki/Pitch_detection_algorithm)吗？它包含一些您可能会感兴趣的参考资料。

此外，这里[列出了 DSP 应用程序和库](http://www.linux-sound.org/dsp.html)，您可以在其中四处寻找。该列表仅提及 Linux 软件包，但其中许多是跨平台的，并且您可以查看大量源代码。

仅供参考，在单声道录音中检测音符的音高对于大多数精通 DSP 的人来说是触手可及的。检测所有音符的音高，包括和弦等，要困难得多。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-14T02:24:35.093

如果您尝试检测和弦录音的音符（同时有多个音符），祝您好运。这是一个非常棘手的问题。我不知道有什么方法可以听，比如说，弦乐四重奏的录音，并有一个算法将四个声音分开。（也许是小波？）如果一次只有一个音符，那么有几种音高跟踪算法，其中许多在其他评论中提到。

您要使用的算法将取决于您正在听的音乐类型。如果你想让它拾起人们唱歌，那么有很多专门为语音设计的优秀算法。（大部分研究都在那儿。）如果你想选择特定的乐器，你就必须更有创意。语音算法可以很简单，因为人类歌声的范围通常被限制在 100-2000 Hz 左右。（说话范围要窄得多）。然而，钢琴的基本频率从大约 27 Hz 开始。到 4200 Hz，因此您正在处理通常被音高检测算法忽略的更宽范围。

大多数仪器的波形会相当复杂，有很多谐波，所以像计算零点或只取自相关这样的简单方法是行不通的。如果您大致知道要查看的频率范围，则可以进行低通滤波，然后进行零计数。我认为您最好使用更复杂的算法，例如另一个用户提到的谐波产品频谱，或 YAAPT（“另一个音高跟踪算法”）或类似的东西。

最后一个问题：有些乐器，尤其是钢琴，会出现缺少基本音和不和谐的问题。缺失的基本原理可以通过音高跟踪算法来处理……事实上它们必须如此，因为基本原理经常在电子传输中被切断……尽管你可能仍然会遇到一些八度音阶错误。然而，如果有人在钢琴的最低八度音阶中弹奏一个音符，不和谐会给你带来麻烦。正常的音高跟踪算法不是为处理不和谐而设计的，因为人声并没有明显的不和谐。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-12T14:38:22.543

你基本上需要一个频谱分析仪。您可能能够对模拟输入的录音进行 FFT，但这在很大程度上取决于录音的分辨率。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-12T14:42:49.913

我立刻想到了什么：

*   过滤掉非常低的频率（鼓，低音线），
*   滤除高频（谐波）
*   快速傅里叶变换，
*   在 FFT 输出中寻找旋律的峰值

我不确定这是否适用于非常复音的声音 - 也许在谷歌上搜索“FFT、分析、旋律等”。将返回有关可能出现的问题的更多信息。

问候

# iis-6 - 如何配置 ASP.NET Web 应用程序的超时？

> ID：435538
> 
> 赞同：1
> 
> 时间：2009-01-12T14:19:55.217
> 
> 标签：iis-6, asp.net-2.0

我以前对 ASP.NET Web 应用程序的体验（关于超时）是它每 30 分钟注销一次用户，无论正在运行什么模块，有没有办法可以将应用程序超时增加到一两个小时？

任何帮助都非常感谢，在此先感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T14:24:10.200

您可以在 web.config 文件中设置会话超时。

```
<sessionState timeout="60" /> 
```

该值以分钟为单位定义。

我认为您也可以从 HttpContext.Current.Session 对象以编程方式设置它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T14:26:36.717

如果应用程序超时是指会话超时，那么这可以在 web.config 中完成。sessionstate 元素上的 timeout 属性采用一个整数，表示在用户会话超时之前不活动的分钟数。

```
<configuration>
  <sessionstate timeout="20" />
.
.
.
</configuration> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T14:28:16.167

在 web.config 中，将 timeout 属性的值设置为您需要的值。

```
<system.web>
    <authentication mode="Forms">
          <forms timeout="value in minutes"/>
    </authentication>
</system.web> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T14:24:34.897

您的 web.config 中有一个值，您可以在其中设置超时长度。

```
 <sessionState
    timeout="60"
  /> 
```

# sql - SQL 子查询与连接混淆

> ID：435540
> 
> 赞同：2
> 
> 时间：2009-01-12T14:20:06.637
> 
> 标签：sql, ms-access, join

我有一个在 Access 中的数据库（你可以得到它的[链接文本](http://cid-84dd6ce2da273835.skydrive.live.com/self.aspx/.Public/Unisa.accdb)）。如果我跑

```
SELECT DISTINCT Spl.Spl_No, Spl.Spl_Name
FROM Spl INNER JOIN Del 
   ON Spl.Spl_No = Del.Spl_No
WHERE Del.Item_Name <> 'Compass' 
```

它提供了从未交付过指南针的供应商的名称。但是，您可以使用子查询来执行此操作。到目前为止，我自己和其他一些人都无法做到这一点。

我确实接近了以下内容，直到我们添加了更多供应商然后它停止工作

```
SELECT SPL.SPL_Name
FROM SPL
LEFT JOIN DEL ON Del.SPL_No = SPL.SPL_No
WHERE (DEL.Item_Name<>"Compass") OR (DEL.Item_Name IS NULL)
GROUP BY SPL.SPL_Name
HAVING COUNT(DEL.SPL_No) = 0 
```

所以问题是：这可能与子查询有关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T14:35:39.927

我想我会去：

```
SELECT SELECT Spl_No, Spl_Name
FROM Spl
WHERE Spl_No NOT IN 
  (SELECT Spl_No FROM Del
   WHERE Item_Name = 'Compass') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T14:31:24.103

你的意思是这样的吗？

```
SELECT SPL.SPL_Name
FROM SPL
WHERE NOT SPL.SPL_no IN 
 (SELECT SPL_no FROM DEL WHERE DEL.Item_Name = "Compass") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T14:30:43.340

```
SELECT Spl_No
     , Spl_Name
  FROM Spl
 WHERE NOT EXISTS( SELECT *
                     FROM Del
                    WHERE Del.Spl_no = Spl.Spl_no
                      AND Item_name  = 'Compass' ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T14:31:41.370

如果访问存在......

从不存在的 SPL 中选择 SPL.SPL_Name（从 DEL 中选择 1，其中 Del.SPL_No = SPL.SPL_No AND (DEL.Item_Name='Compass')）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T14:33:31.180

它非常接近你用英语所说的方式

“给我那些还没有交付 Compass 的供应商。”

```
Select [Stuff]
From Spl S
Where Not Exists
   (Select * From Del
    Where Spl_no = S.Spl_no 
       And Item_name  = 'Compass') 
```

编辑：如果不存在，您可以使用 Count(*) = 0

```
Select [Stuff]
From Spl S
Where 
   (Select Count(*) From Del
    Where Spl_no = S.Spl_no 
       And Item_name  = 'Compass') = 0 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T14:29:47.023

从未交付过指南针的供应商：

```
SELECT Spl.Spl_No, Spl.Spl_Name
FROM Spl
LEFT JOIN Del ON Del.Spl_No = Spl.Spl_No AND Del.Item_Name = 'Compass'
WHERE Del.Item_Name IS NULL 
```

并使用子查询：

```
SELECT Spl_No, Spl_Name
FROM Spl
WHERE Spl_No IN 
  (
    SELECT Spl_No
    FROM Del
    GROUP BY Spl_No, Item_Name
    WHERE Item_Name = 'Compass'
    HAVING COUNT(*) = 0
  ) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T14:30:41.920

这是你要找的吗？

```
SELECT
   SPL.SPL_name
FROM
   SPL
WHERE
   SPL.SPL_No NOT IN
   (
      SELECT SPL_No FROM DEL WHERE DEL.Item_Name <> "Compass"
   ) 
```

# optimization - 网站内容分区值得吗？

> ID：435542
> 
> 赞同：1
> 
> 时间：2009-01-12T14:21:02.640
> 
> 标签：optimization, web, dns

为了允许关于内容的多种策略......安全、cookie、会话等，我正在考虑将一些内容从我的站点移动到他们自己的域，并且想知道它将带来什么样的红利（如果有的话）。

我知道 cookie 是特定于域的，并且会在每个请求（甚至是图像）时发送，因此如果它们变得太大，它们可能会开始影响性能，因此以这种方式移动静态内容是有意义的（至少对我而言）。

由于我希望那里有人已经做过类似的事情，所以我想知道您是否可以提供一些关于利弊的反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T21:46:10.323

我不知道任何符合您的原因的情况无法在 HTTP 服务器的设置中控制，无论是 Apache、IIS 还是您可能使用的其他任何东西。

我假设您的意思是要将它们拆分为单独的主机，即 www1.domain.com www2.domain.com。并且您是正确的，cookie 是特定于主机/域的。但是，如果 www1 和 www2 仍然是同一台计算机，则实际上并没有任何好处。如果您遇到负载问题并将其拆分到两个不同的服务器之间，则可能会有一些收益。

如果您实际上是指不同的域（www.domain1.com 和 www.domain2.com），我不确定您会寻找什么样的好处......

# django - Django - 带有伴随存储字段的自定义虚拟模型字段

> ID：435544
> 
> 赞同：0
> 
> 时间：2009-01-12T14:21:40.563
> 
> 标签：django, django-models, django-admin, django-orm

我想要一个`ConfirmationField`字段类型。我希望这个字段像布尔字段一样工作。我不需要将此信息存储在数据库中，而是希望将确认日期存储在单独的字段中。

```
class MyModel(models.Model):
    confirmation = ConfirmationField()

m = MyModel()
m.confirmation # False
m.confirmation_timestamp # None

m.confirmation = True
m.save()

m.confirmation_timestamp # datetime object

m.confirmation = False
m.save()

m.confirmation_timestamp # None again 
```

我需要将这两个字段都作为`Field`实例，例如，我需要能够在 Admin 中使用它们。

我已阅读文档并检查代码，`ForeignKey`使用以下代码更改其数据库列名称：

```
def get_attname(self):
    return '%s_id' % self.name 
```

但是我无法确切地弄清楚如何使用其余代码作为示例。看来我的目标不需要太复杂。

保存模型时，我还发现`ImageField`了保存的额外信息：

```
 if self.field.width_field:
        setattr(self.instance, self.field.width_field, self.width)
    if self.field.height_field:
        setattr(self.instance, self.field.height_field, self.height) 
```

但我当然不希望`confirmation`自己存储在数据库中。`confirmation_timestamp`由于 ( -> `confirmation`) `None`==`False`和`<datetime instance>`== ，我会造成冗余`True`。

任何指针/想法表示赞赏。

谢谢。

**编辑：**目前看来这是不可能的。我最终改变了我的 API。这是一个snipplet，可以说明我是如何做到的：

```
 value = {'BooleanField': True,
             'DateTimeField': datetime.datetime.now(),
             'DateField': datetime.date.today(),
             'IntegerField': 1,
            }[instance._meta.get_field(field_name).get_internal_type()]
    setattr(instance, field_name, value) 
```

您可以拥有上述任何类型的确认字段，并设置正确的值。确认检查可以用`bool(getattr(instance, field_name)`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T14:32:17.157

如果我做对了，请考虑：

```
class Modelname(models.Model):
    """(Modelname description)"""

    confirmation_timestamp = models.DateTimeField(blank=True)

    def _set_confirmation(self, value):
        if not value:
            self.confirmation_timestamp = None
        else:
            self.confirmation_timestamp = datetime.datetime.now()

    def _get_confirmation(self):
        return bool(self.confirmation_timestamp)

    confirmation = property(_get_confirmation, _set_confirmation)
    confirmation.short_description = "Confirmation"
    confirmation.boolean = True # have it nicely displayed in admin 
```

# html - 我应该“快速列出”我的国家下拉列表吗？

> ID：435546
> 
> 赞同：4
> 
> 时间：2009-01-12T14:22:38.737
> 
> 标签：html

我的会员可以从国家列表中进行选择。

AZ 名单从阿富汗开始，经过许多不为人知的国家。

我应该得到前十个国家并将它们“快速列出”在列表的顶部吗？

或者这是否被视为某种文化优势yadda yadda？

我正在使用 PHP/MySQL（试图在那里获得编程角度）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T14:25:27.000

我认为这让你更难找到你的国家。德国是（我认为）排名前 10 的国家之一，我总是遇到不知道该搜索什么的问题。在顶部搜索，搜索德国，搜索德国，......我认为最简单的是按字母顺序排列的国家。如果列表很长，您可以开始输入第一个字母以获取您所在国家/地区的旁边。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T15:06:16.387

另一种解决方案是让列表只显示过去作为答案给出的国家，加上一个“其他”选项，用完整的集合扩展列表（或显示第二个列表）。

因此，如果您从未有过来自吉尔吉斯斯坦的访客，那么它根本不会出现在列表中。吉尔吉斯斯坦用户第一次访问该站点时，他们会在列表中选择“其他”，然后您才会显示完整列表。不过，在那之后，由于吉尔吉斯斯坦已得到答复，您将在初始列表中显示它。（阈值不一定是 1 ......它可以是你喜欢的任何数字，并且你想设置它，以便总的来说，更多的人因疏忽而受到帮助，而不是因不得不这样做而受到伤害选择“其他”。）

您还可以包含人口（或使用互联网的人口）指标并自动显示超过一定规模的所有国家，因此像德国这样的大国甚至在他们的第一批用户开始出现之前就会被包括在内。或者，如果您知道您将拥有来自某些国家/地区的大量用户，无论出于何种原因，您都可以拥有一个手动包含的国家/地区列表。

总体而言：不要低估通过精简列表所带来的好处。正是这样的小事情使用户界面“很棒”而不是“好”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-09-29T21:16:34.640

为什么不保持列表完整，而是使用地理定位**预先选择**您的访问者所在的国家/地区？

**根据 IP 地址**确定用户的物理位置。

您可以从[http://www.ip2location.com/](http://www.ip2location.com/)开始，但还有其他免费选择。

从“ip address”谷歌搜索**城市**，或**从“ip address”搜索国家**。

请注意，如果您选择一个简单的国家/地区，则有些物理划分并不明显。例如，法国国家包括法属加勒比地区，如果您正在计算港口，您可能会被淘汰。

除了使用地理定位之外，重要的是使用亚马逊、谷歌、苹果等使用的**相同列表**（并且是相同的标准化列表）。要查看它，只需开始在亚马逊上订购产品并更改您的送货地址国家.

原因是居住在特定国家/地区的人们**已经习惯于从这个特定列表中选择他们的国家**，并且知道如何快速完成。您对列表所做的任何修改，虽然是善意的，但只会**减慢它们的速度**。

请记住，人们将 99.99% 的时间花在**其他网站上**。他们知道如何使用他们已经遇到的工具来提高效率。只要有标准的做事方式，您就应该效仿那些其他网站——其他任何事情都会让您的用户感到困惑。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-12T14:25:00.247

您可以从列表中跟踪选择最多的国家的列表，并将它们放在列表的开头。在此子列表之后添加行，然后排序其余国家/地区的列表。

一段时间后，您可能会删除逻辑并“冻结”n 个“最受欢迎”国家的子列表

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-12T14:36:51.720

我还可以建议使用您网站显示的语言中的国家/地区名称。我总是对英文网站上使用“Deutschland”表示德国的国家/地区列表感到恼火。当我在一个英文网站上时，我会直观地寻找英文国家名称。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-12T15:13:39.790

一个有趣的问题。我也多次想知道这个可用性问题。为什么不创建一个类别呼叫**大陆**，用户会在选择他/她选择的国家之前访问一个大陆？它会让用户更快（或更方便）吗？当然，您的列表现在需要更深层次。或者使用 Ajax，这为一些新的创新可用性想法提供了许多机会。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T14:37:07.897

就个人而言，我不喜欢它。我希望国家只是按字母顺序列出，而不是“美国、加拿大、阿富汗……”

也许如果您知道 95% 的流量来自某个特定国家/地区，那么它可能是可辩护的。

# html - HTML下载和文本提取

> ID：435547
> 
> 赞同：4
> 
> 时间：2009-01-12T14:22:56.757
> 
> 标签：html, linux, text-extraction, download

下载 URL 列表并仅提取文本内容的好工具或工具集是什么？蜘蛛不是必需的，但可以控制下载文件名，线程将是一个额外的好处。

平台是linux。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T14:30:01.703

[`wget`](http://linux.die.net/man/1/wget) `|` [`html2ascii`](http://s23.org/wiki/Html2ascii)

注意：也可以调用 html2ascii`html2a`或`html2text`（我无法在网上找到合适的手册页）。

另见：[`lynx`](http://linux.die.net/man/1/lynx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T15:04:56.360

Python [Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)允许您构建一个[不错的提取器](https://stackoverflow.com/questions/23380171/using-beautifulsoup-to-extract-text-without-tags)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T14:31:16.410

我知道 w3m 可用于呈现 html 文档并将文本内容放入文本文件 w3m www.google.com > file.txt 例如。

对于其余部分，我确信可以使用 wget。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T14:34:47.123

在 Sourceforge 上寻找 PHP 的简单 HTML DOM 解析器。使用它来解析您使用 CURL 下载的 HTML。每个 DOM 元素都有一个“纯文本”属性，它应该只给你文本。很长一段时间以来，我在很多应用程序中都非常成功地使用了这种组合。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T14:36:41.360

PERL（实用提取和报告语言）是一种非常适合此类工作的脚本语言。[http://search.cpan.org/](http://search.cpan.org/)包含许多具有所需功能的模块。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T14:40:37.813

使用 wget 下载所需的 html，然后在输出文件上运行 html2text。

# java - Java 反射性能

> ID：435553
> 
> 赞同：192
> 
> 时间：2009-01-12T14:25:03.023
> 
> 标签：java, performance, optimization, reflection

使用反射创建对象而不是调用类构造函数会导致任何显着的性能差异吗？

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-01-12T14:30:29.550

**是的，一点没错。***从数量上看*，通过反射查找课程的成本更高。

引用[Java 的关于反射的文档](http://java.sun.com/docs/books/tutorial/reflect/index.html)：

> 由于反射涉及动态解析的类型，因此无法执行某些 Java 虚拟机优化。因此，反射操作的性能比它们的非反射对应物慢，并且应该避免在性能敏感的应用程序中经常调用的代码部分中。

这是我在我的机器上用 5 分钟完成的一个简单测试，运行 Sun JRE 6u10：

```
public class Main {

    public static void main(String[] args) throws Exception
    {
        doRegular();
        doReflection();
    }

    public static void doRegular() throws Exception
    {
        long start = System.currentTimeMillis();
        for (int i=0; i<1000000; i++)
        {
            A a = new A();
            a.doSomeThing();
        }
        System.out.println(System.currentTimeMillis() - start);
    }

    public static void doReflection() throws Exception
    {
        long start = System.currentTimeMillis();
        for (int i=0; i<1000000; i++)
        {
            A a = (A) Class.forName("misc.A").newInstance();
            a.doSomeThing();
        }
        System.out.println(System.currentTimeMillis() - start);
    }
} 
```

有了这些结果：

```
35 // no reflection
465 // using reflection 
```

请记住，查找和实例化是一起完成的，在某些情况下可以重构查找，但这只是一个基本示例。

即使您只是实例化，您仍然会受到性能影响：

```
30 // no reflection
47 // reflection using one lookup, only instantiating 
```

再次，YMMV。

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2009-02-13T22:50:55.337

是的，它更慢。

但请记住该死的第一条规则——过早的优化是万恶之源

（好吧，可能与 DRY 的#1 并列）

我发誓，如果有人在工作中找到我并问我这个问题，我会在接下来的几个月里非常注意他们的代码。

在确定需要它之前，永远不要优化，在此之前，只需编写好的、可读的代码。

哦，我也不是说编写愚蠢的代码。只是考虑你可能做的最干净的方式 - 没有复制和粘贴等。（仍然要警惕内部循环和使用最适合你需要的集合之类的东西 - 忽略这些不是“未优化”的编程，这是“糟糕”的编程）

当我听到这样的问题时，我吓坏了，但后来我忘记了每个人都必须自己学习所有规则才能真正掌握它。在你花了一个人月调试某人“优化”的东西后，你会得到它。

编辑：

在这个线程中发生了一件有趣的事情。检查＃1 答案，这是编译器在优化事物方面的强大功能的一个示例。该测试完全无效，因为可以完全排除非反射实例化。

课？在编写干净、代码整洁的解决方案并证明它太慢之前，永远不要优化。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2009-02-13T21:53:23.277

您可能会发现 A a = new A() 正在被 JVM 优化。如果将对象放入数组中，它们的性能就不会那么好。;) 以下打印...

```
new A(), 141 ns
A.class.newInstance(), 266 ns
new A(), 103 ns
A.class.newInstance(), 261 ns

public class Run {
    private static final int RUNS = 3000000;

    public static class A {
    }

    public static void main(String[] args) throws Exception {
        doRegular();
        doReflection();
        doRegular();
        doReflection();
    }

    public static void doRegular() throws Exception {
        A[] as = new A[RUNS];
        long start = System.nanoTime();
        for (int i = 0; i < RUNS; i++) {
            as[i] = new A();
        }
        System.out.printf("new A(), %,d ns%n", (System.nanoTime() - start)/RUNS);
    }

    public static void doReflection() throws Exception {
        A[] as = new A[RUNS];
        long start = System.nanoTime();
        for (int i = 0; i < RUNS; i++) {
            as[i] = A.class.newInstance();
        }
        System.out.printf("A.class.newInstance(), %,d ns%n", (System.nanoTime() - start)/RUNS);
    }
} 
```

这表明我的机器上的差异约为 150 ns。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2009-02-13T23:15:52.640

如果*确实*需要比反射更快的东西，而且这不仅仅是过早的优化，那么使用[ASM](http://asm.objectweb.org/)或更高级别的库生成字节码是一种选择。第一次生成字节码比只使用反射要慢，但是一旦生成了字节码，它就和普通的 Java 代码一样快，并且会被 JIT 编译器优化。

一些使用代码生成的应用程序示例：

*   [在CGLIB](http://cglib.sourceforge.net/)生成的代理上调用方法比 Java 的[动态代理](http://java.sun.com/j2se/1.5.0/docs/guide/reflection/proxy.html)稍快，因为 CGLIB 为其代理生成字节码，但动态代理仅使用反射（[我测量](http://www.projectdarkstar.com/forums/index.php?topic=329.0#msg1967)CGLIB 在方法调用中大约快 10 倍，但创建代理更慢）。

*   [JSerial](http://jserial.sourceforge.net/)生成用于读取/写入序列化对象字段的字节码，而不是使用反射。JSerial 的网站上有[一些基准测试。](http://jserial.sourceforge.net/faq.html)

*   我不是 100% 确定（而且我现在不想阅读源代码），但我认为[Guice](http://code.google.com/p/google-guice/)会生成字节码来进行依赖注入。如我错了请纠正我。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2009-01-12T15:36:06.123

“显着”完全取决于上下文。

如果您使用反射基于某个配置文件创建单个处理程序对象，然后将其余时间花在运行数据库查询上，那么它就无关紧要了。如果您通过紧密循环中的反射创建大量对象，那么是的，这很重要。

一般来说，设计灵活性（在需要的地方！）应该推动您对反射的使用，而不是性能。但是，要确定性能是否是一个问题，您需要进行分析，而不是从讨论论坛中获得任意回复。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2009-01-12T14:30:45.150

反射有一些开销，但在现代 VM 上它比以前小得多。

如果您使用反射来创建程序中的每个简单对象，那么就有问题了。偶尔使用它，当你有充分的理由时，根本不应该是一个问题。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2013-06-20T01:28:58.303

是的，使用反射时性能会受到影响，但优化的一种可能的解决方法是缓存该方法：

```
 Method md = null;     // Call while looking up the method at each iteration.
      millis = System.currentTimeMillis( );
      for (idx = 0; idx < CALL_AMOUNT; idx++) {
        md = ri.getClass( ).getMethod("getValue", null);
        md.invoke(ri, null);
      }

      System.out.println("Calling method " + CALL_AMOUNT+ " times reflexively with lookup took " + (System.currentTimeMillis( ) - millis) + " millis");

      // Call using a cache of the method.

      md = ri.getClass( ).getMethod("getValue", null);
      millis = System.currentTimeMillis( );
      for (idx = 0; idx < CALL_AMOUNT; idx++) {
        md.invoke(ri, null);
      }
      System.out.println("Calling method " + CALL_AMOUNT + " times reflexively with cache took " + (System.currentTimeMillis( ) - millis) + " millis"); 
```

将导致：

**[java] 通过查找自反调用方法 1000000 次耗时 5618 毫秒**

**[java] 使用缓存自反调用方法 1000000 次耗时 270 毫秒**

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2011-10-27T14:53:17.060

有趣的是，设置跳过安全检查的 setAccessible(true) 降低了 20% 的成本。

没有 setAccessible(true)

```
new A(), 70 ns
A.class.newInstance(), 214 ns
new A(), 84 ns
A.class.newInstance(), 229 ns 
```

使用 setAccessible(true)

```
new A(), 69 ns
A.class.newInstance(), 159 ns
new A(), 85 ns
A.class.newInstance(), 171 ns 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2011-07-11T19:37:57.553

反射很慢，尽管对象分配并不像反射的其他方面那样无望。使用基于反射的实例化实现同等性能需要您编写代码，以便 jit 可以判断正在实例化哪个类。如果无法确定类的身份，则无法内联分配代码。更糟糕的是，逃逸分析失败，并且对象不能被堆栈分配。如果幸运的话，如果这段代码变热，JVM 的运行时分析可能​​会派上用场，并且可以动态确定哪个类占主导地位并可能针对该类进行优化。

请注意，此线程中的微基准测试存在严重缺陷，因此请谨慎对待。到目前为止，缺陷最少的是 Peter Lawrey 的：它会进行热身运行以使方法受到影响，并且它（有意识地）击败逃逸分析以确保分配实际发生。但是，即使这样也有其问题：例如，可以预期大量的数组存储会破坏缓存和存储缓冲区，因此如果您的分配非常快，这将主要成为内存基准。（感谢彼得得出正确的结论：差异是“150ns”而不是“2.5x”。我怀疑他做这种事情是为了谋生。）

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-01-12T14:29:21.813

是的，它明显变慢了。我们正在运行一些执行此操作的代码，虽然我目前没有可用的指标，但最终结果是我们不得不重构该代码以不使用反射。如果你知道类是什么，直接调用构造函数即可。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2011-09-06T21:50:15.010

在 doReflection() 中是开销，因为 Class.forName("misc.A") （这将需要类查找，可能扫描 filsystem 上的类路径），而不是类上调用的 newInstance()。我想知道如果 Class.forName("misc.A") 只在 for 循环之外执行一次，统计信息会是什么样子，实际上不必为循环的每次调用都执行它。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-12T14:38:18.097

是的，通过反射创建对象总是会更慢，因为 JVM 无法在编译时优化代码。有关更多详细信息，请参阅 Sun/Java[反射教程](http://java.sun.com/docs/books/tutorial/reflect/index.html)。

看这个简单的测试：

```
public class TestSpeed {
    public static void main(String[] args) {
        long startTime = System.nanoTime();
        Object instance = new TestSpeed();
        long endTime = System.nanoTime();
        System.out.println(endTime - startTime + "ns");

        startTime = System.nanoTime();
        try {
            Object reflectionInstance = Class.forName("TestSpeed").newInstance();
        } catch (InstantiationException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
        endTime = System.nanoTime();
        System.out.println(endTime - startTime + "ns");
    }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-13T17:08:48.200

通常，您可以使用 Apache commons BeanUtils 或 PropertyUtils 进行自省（基本上它们缓存有关类的元数据，因此它们并不总是需要使用反射）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-01-10T04:20:18.633

我认为这取决于目标方法的轻/重。如果目标方法很轻（例如 getter/setter），它可能会慢 1 ~ 3 倍。如果目标方法需要大约 1 毫秒或以上，那么性能将非常接近。这是我用 Java 8 和[reflectasm](https://github.com/EsotericSoftware/reflectasm)做的测试：

```
public class ReflectionTest extends TestCase {    
    @Test
    public void test_perf() {
        Profiler.run(3, 100000, 3, "m_01 by refelct", () -> Reflection.on(X.class)._new().invoke("m_01")).printResult();    
        Profiler.run(3, 100000, 3, "m_01 direct call", () -> new X().m_01()).printResult();    
        Profiler.run(3, 100000, 3, "m_02 by refelct", () -> Reflection.on(X.class)._new().invoke("m_02")).printResult();    
        Profiler.run(3, 100000, 3, "m_02 direct call", () -> new X().m_02()).printResult();    
        Profiler.run(3, 100000, 3, "m_11 by refelct", () -> Reflection.on(X.class)._new().invoke("m_11")).printResult();    
        Profiler.run(3, 100000, 3, "m_11 direct call", () -> X.m_11()).printResult();    
        Profiler.run(3, 100000, 3, "m_12 by refelct", () -> Reflection.on(X.class)._new().invoke("m_12")).printResult();    
        Profiler.run(3, 100000, 3, "m_12 direct call", () -> X.m_12()).printResult();
    }

    public static class X {
        public long m_01() {
            return m_11();
        }    
        public long m_02() {
            return m_12();
        }    
        public static long m_11() {
            long sum = IntStream.range(0, 10).sum();
            assertEquals(45, sum);
            return sum;
        }    
        public static long m_12() {
            long sum = IntStream.range(0, 10000).sum();
            assertEquals(49995000, sum);
            return sum;
        }
    }
} 
```

完整的测试代码可在 GitHub 上获得：[ReflectionTest.java](https://github.com/landawn/AbacusUtil/blob/master/test/com/landawn/abacus/test/ReflectionTest.java)

# c# - 如何更新通过引用传递给方法的通用列表？

> ID：435557
> 
> 赞同：2
> 
> 时间：2009-01-12T14:26:25.343
> 
> 标签：c#, generics

我有一个通用的消息列表，我通过引用传递给一个方法。该方法使用列表中的一条消息并更新该消息。

通过引用传递整个列表时，如何使用新文本更新此消息？

例如

```
private int RetrieveAndProcessQueueEntityRows(
        string sEntityCode,
        string sMessageFIDs,
        int iNumberToFetch,
        ref List<Entity> oMessageList) {

////......

Message currMessage = null;

foreach (Message oMessage in oMessageList) {
     if (oMessage.Message_UID == oPatientInfoEntityCurrent.MessageFID) {
        currMessage = oMessage;
        break;
     }
} 
```

所以现在我可以使用 currMessage 对象进行所需的更新。但是我该如何更新`List<Entity> oMessageList`呢`currMessage`？

感谢你的帮助！- 拉库斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T14:30:55.880

如果消息是一个类，则不需要通过引用传递*任何*一个；您只需更新现有的消息对象，或者创建一个新的消息对象并在列表中交换它（通过索引器，或使用删除/添加）。

`ref`只有在创建新列表时才需要。

因此，如果`Message`是一个可变类，只需：

```
currMessage.SomeProperty = "some value"; // done 
```

如果没有，请使用`oMessageList`'s 索引器（或，如所述`Add`/ `Remove`） - 即

```
oMessageList[index] = replacementMessage; 
```

请注意，如果您在 期间更改列表内容`foreach`，`foreach`迭代器几乎肯定会中断；有一些处理方法，但如果可以的话：只需更新消息本身的属性。

# wordpress - Wordpress 2.7 Admin中的用户名不会根据用户更改

> ID：435577
> 
> 赞同：1
> 
> 时间：2009-01-12T14:31:40.590
> 
> 标签：wordpress

提前感谢您的帮助，伙计们和女孩们！

我刚刚升级到 Wordpress 2.7，并且必须使用管理员帐户，但无论我登录哪个帐户，它仍然在右上角显示“你好，杰西……”。

有人对此有任何见解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T17:40:05.650

每个帐户都可以配置为显示各种不同的名称。下图显示了可供选择的选项。

[视觉名称选择 http://www.freeimagehosting.net/uploads/0cf6c650b4.gif](http://www.freeimagehosting.net/uploads/0cf6c650b4.gif)

如果您想将它们区分开来，您应该能够给每个帐户一个不同的昵称或不同的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T14:44:56.273

Wordpress 通常会显示昵称，而不是用户名。两个帐户是否相同？如果是这样，您可能正确登录到两者。

# c# - 无法连接到 SQL Server 会话数据库

> ID：435582
> 
> 赞同：5
> 
> 时间：2009-01-12T14:32:21.387
> 
> 标签：c#, asp.net, sql-server, session-state

我的 asp.net 应用程序每天都能正常工作。直到上个月，我的网站开始出现 2-3 次 Sqlsession 状态服务器问题，如下所示：

> Blockquote System.Web.HttpException 引发了“System.Web.HttpException”类型的异常。在 System.Web.HttpAsyncResult.End() 在 System.Web.SessionState.SessionStateModule.EndAcquireState(IAsyncResult ar) 在 System.Web.HttpApplication.AsyncEventExecutionStep.OnAsyncEventCompletion(IAsyncResult ar) ============ ======================================= 异常：System.Web.HttpException 无法连接到 SQL服务器会话数据库。在 System.Web.SessionState.SqlSessionStateStore.ThrowSqlConnectionException(SqlConnection conn, Exception e) 在 System.Web.SessionState.SqlSessionStateStore.SqlStateConnection..ctor(SqlPartitionInfo sqlPartitionInfo) 在 System.Web.SessionState.SqlSessionStateStore.GetConnection(String id, Boolean& usePooling ) 在 System.Web.SessionState.SqlSessionStateStore。在 System.Web.SessionState.SqlSessionStateStore.GetItemExclusive（HttpContext 上下文，字符串 id，Boolean& 锁定，TimeSpan& lockAge，Object& lockId，SessionStateActions& actionFlags）在 System.Web.SessionState.SessionStateModule.GetSessionStateItem() 在 System.Web.SessionState.SessionStateModule.PollLockedSessionCallback（对象状态）====================== ============================= 异常：System.InvalidOperationException 超时已过期。在从池中获取连接之前超时时间已过。这可能是因为所有池连接都在使用中并且达到了最大池大小。在 System.Data.ProviderBase。

然后我开始查看我的会话数据库服务器并在我的 sql 客户端中执行“exec sp_who”，结果中发现了很多 AspState 操作记录。

我不知道是什么导致了这种问题，因为我们在应用程序中没有改变任何严重的事情，只是修复了一些错误。

以下是我的 Web 应用程序环境的详细信息：

asp.net 3.5（从 1.1 转换）...在 2 个服务器场中运行良好，会话状态为 sqlmode。

有没有人知道这个问题或有任何调查的想法？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-05-27T14:47:13.907

自从这篇文章首次提出以来已经有一段时间了，但我最近在生产环境中遇到了这个确切的问题，并认为它将来可能对其他人有用。

我们有一个在 .NET 4.5.2 上运行的 ASP.NET MVC Web 应用程序，在两个节点之间进行负载平衡。该应用程序配置为将会话存储在 SQL Server 2012（版本 11.0.5058.0）上的 ASPState 数据库中。我们遇到了间歇性超时：

> 异常信息：异常类型：HttpException 异常消息：无法连接到 SQL Server 会话数据库。超时已过。在从池中获取连接之前超时时间已过。这可能是因为所有池连接都在使用中并且达到了最大池大小。

我认为，此处有关确保代码库中没有其他连接泄漏的一些答案具有误导性。为每个不同的连接字符串创建一个连接池，因此对与其他数据库的连接的任何修复都不会对会话状态数据库产生有益的影响。

我们通过两个更改解决了这个问题：

1.  通过覆盖 web.config 文件中连接字符串中的默认值 100 来提高最大池大小：

    ```
     sqlConnectionString="data source=SERVERNAME;Initial Catalog=AspState;user id=AspStateUser;password=xxxxx;App=xxxx; Max Pool Size=200;" 
    ```

2.  很明显，AspState 数据库是使用 .NET 2.0 命令行创建的，重要的是，dbo.DeleteExpiredSessions SP 已知存在阻塞问题。为了使问题更加复杂，该作业被配置为每分钟执行一次此过程。AspState 数据库是使用 .NET 4.0 命令行重新创建的，如下所示：

> C:\Windows\Microsoft.NET\Framework\v4.0.30319>aspnet_regsql.exe -ssadd - sstype c -S OURSERVERNAME -d "AspState" -E

关键的是，更高版本包括一个性能改进的 DeleteExpiredSessions 过程版本，它包含一个一次删除一个过期会话的游标。我们还将相关作业的时间表更改为每小时执行一次，而不是每分钟执行一次。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-08-17T17:20:48.803

不确定是否有人仍在查看此线程，但我发现了一篇有趣的文章，关于大型会话状态和大量并发会话在删除数据时导致问题（当会话不再有效时）。尽管这里的信息有点过时，但可能值得研究。这是链接： http: [//msmvps.com/blogs/greglow/archive/2007/02/04/improving-asp-net-session-state-database-performance-by-reducing-blocking.aspx](http://msmvps.com/blogs/greglow/archive/2007/02/04/improving-asp-net-session-state-database-performance-by-reducing-blocking.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T14:51:38.337

当开发人员使用大量 SqldataReader 获取数据以构建某种仪表板时，我已经看到这个确切的错误发生，但即使他将命令行为设置为 CloseConnection，他也从未关闭过他的数据读取器。一旦他这样做了（通过使用块的封闭），这些就消失了。同样，这可能不是问题的实际原因，但连接池耗尽通常表明连接未正确关闭。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T03:21:54.147

这听起来确实像是您正在用完池中所有可用连接的情况。浏览您的代码并确保设置您的数据库连接，如下所示：

```
using (SqlConnection cn = new SqlConnection(connectionString))
{
    using (SqlCommand cm = new SqlCommand(commandString, cn))
    {
        cn.Open();
        cm.ExecuteNonQuery(); // or fill a dataset, etc.
    }
} 
```

一旦退出这个“使用”语句，连接将自动关闭。

这样做将清除应用程序中的所有其他数据库连接，并且状态服务器连接将能够在需要时进行连接。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-07-30T01:02:57.757

如果这里的答案都不起作用，请查看`<configuration>`和中的 connectionString `<sessionState>`。在我的例子中，我更新了连接字符串，`<configuration>`但不是在会话状态，以指向不同的 SQL 服务器。

只需指定正确的连接字符串即可`<sessionState>`解决同样的错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T18:48:08.450

你的负载增加了吗？您可能有很多连接，因为您有更多的用户使用该系统。

您可以做的一件事是优化会话使用。您可以指定页面是使用会话状态还是仅进行读取。如果您有不使用或不修改会话的页面，这可以节省大量资金。

# cocoa-touch - 实现可变大小的多行 UITableCell 的最佳方法是什么？

> ID：435588
> 
> 赞同：6
> 
> 时间：2009-01-12T14:34:22.520
> 
> 标签：cocoa-touch

我正在尝试显示一个充满 twitter 状态的表格（是的，这是[Stanford Presence 2](http://cs193p.stanford.edu/downloads/AssignmentPresence2.pdf) assignment），它们的大小是可变的。我可以使用近似的代码相对容易地确定我的行的适当高度（来自[随附的第 9 课](http://cs193p.stanford.edu/downloads/09-TableViews.pdf)）：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *) indexPath
{
    NSString *text = ...;
    UIFont *font = [UIFont systemFontOfSize:...];
    CGSize withinSize = CGSizeMake(tableView.width, 1000];
    CGSize size = [text sizeWithFont:font constrainedToSize:withinSize lineBreakMode:UILineBreakModeWordWrap];

    return size.height + somePadding;
} 
```

我已经尝试了两种方法（以及对这两种方法的一些调整）来将一个多行文字换行字段放入我的表格行中。

1.  将 UILabel 作为子视图添加到我的自定义 UITableCell 子类中，并将`numberOfLines`属性设置为基于上述高度计算的数字（例如 6）或 0（理论上无限）。被`numberOfLines`忽略；我看到 1 或 2 行，没有更多。

2.  添加一个只读 UITextView 作为子视图。这有 UITextView 吃掉我的滚动的问题；我最终在 UITextView 行内滚动，而不是从一行到另一行平滑移动。如果我禁用 UITextView 上的滚动，我最终将无法滚动。

这是很常见的事情。完成它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T14:42:35.407

您可能想查看`userInteractionEnabled`. `UITextView`那应该允许将输入传递给，`UITableView`以便您滚动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-14T20:44:26.073

这是我在此主题上发布的博客的链接。我使用了 numberOfLInes = 0 的 UILabel。我希望这会有所帮助。

[具有可变大小 UITableViewCell 的示例项目](http://www.raddonline.com/blogs/geek-journal/iphone-sdk-resizing-a-uitableviewcell-to-hold-variable-amounts-of-text/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T14:31:41.603

在使用 userInteractionEnabled=NO、scrollEnabled=NO 并在 IB 中设置正确的自动调整参数时，我认为使用带有 numberOfLines=0 的 UILabel 和相同的自动调整参数对于下一个人来说最终是一个更好的主意。

# ajax - 初学者：使用 AJAX 刷新网站的一部分

> ID：435589
> 
> 赞同：0
> 
> 时间：2009-01-12T14:34:24.503
> 
> 标签：ajax, href

我想用 ajax 刷新只是网站的一部分。我搜索了 protorypjs，我找到了 ajax.updater，但我遇到了麻烦使它工作。这是我页面的一部分

```
<li id="Home"><a href="index.html">Home</a></li> 
```

谁能告诉我如何实现这个：Ajax.Updater(container, url[, options]) ？并让它工作？我在 html 中链接了prototype.js。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T14:41:23.333

更新内容的一种解决方案是使用

```
$('#refreshMe').innerHtml(_new_ajax_content_); 
```

其中元素是即

```
<div id="refreshMe"> 
```

如果您需要更具体的帮助，您应该从您的项目中发布更多信息/代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T15:09:27.800

感谢您的帮助。我让它工作

这是我想做的:)

```
<li id="Servicii"><a href=# onclick="new Ajax.Updater('container', 'servicii.html', 
```

{asynchronous:true});">服务

# build-process - IsCmdBld.exe - 随机错误输出

> ID：435593
> 
> 赞同：0
> 
> 时间：2009-01-12T14:35:47.977
> 
> 标签：build-process, installshield

出于某种原因，当我使用 InstallShield 2009 Professional 的独立构建时，有时会出现错误，有时构建成功完成，但没有明显的原因。出现的错误通常如下所示：

IsCmdBld.exe - 应用程序错误

“0xa781543”处的指令引用了“0x6a19a778”处的内存。记忆无法“写入”

单击确定以终止程序

现在，这个消息只是*偶尔*出现，它没有任何规律或模式。有人对此有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T21:45:24.303

如果错误的内存方法没有成功，如果 IsCmdBld.exe 中存在导致此问题的错误，我不会感到惊讶。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T21:41:45.637

我冒昧地猜测您有一些狡猾/不兼容的 RAM。如果你可以让机器离线并让[memtest](http://www.memtest.org/)运行 24 小时，你应该有足够的信息来调试。

过去我在一台机器上遇到过类似的问题，其中 RAM/Mobo 组合大约每 24 小时会导致一个或两个错误。另一台机器上的相同 RAM 就可以了，那台机器上的其他品牌 RAM 就可以了。从 UPS 上运行机器也可以，我想微小的电力波动*足以*突出两个硬件之间的*轻微*不兼容性。

如果这没有帮助，我建议将您的问题提交到 InstallShield 论坛，最后一个是我发现的错误是一个已提交、修复和分发的修补程序的错误。

# wcf - 如何在 HttpTransportBindingElement 上添加 cookie

> ID：435596
> 
> 赞同：6
> 
> 时间：2009-01-12T14:36:33.997
> 
> 标签：wcf, cookies, http-headers

我有一个**WCF 客户端**，它与**WCF 服务**（运行 AspNetCompabilityMode）通信，我想在每次调用此 Web 服务时添加一个**cookie （在客户端上）。**

我查看了**HttpTransportBindingElement**，但找不到在哪里添加我的 cookie - 是否可以将 cookie 添加到 HttpTransportBindingElement，或者我应该考虑另一种方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-10-26T07:50:33.293

[http://megakemp.wordpress.com/2009/02/06/managing-shared-cookies-in-wcf/](http://megakemp.wordpress.com/2009/02/06/managing-shared-cookies-in-wcf/)

与其他答案中提供的其他手册不同，这本手册以结构良好的方式在一个地方包含了您需要的所有信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T20:12:00.653

您必须将绑定的 allowCookies 配置选项设置为**false**。这听起来很奇怪，但这里解释了原因：

[http://kennyw.com/indigo/211](http://kennyw.com/indigo/211)

完成此操作后，您必须使用此处描述的方法自己添加 cookie：

[http://kennyw.com/indigo/153](http://kennyw.com/indigo/153)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-13T21:24:37.963

[http://kennyw.com/indigo/153](http://kennyw.com/indigo/153)中描述的方法在每个服务调用的基础上工作。这意味着您必须确保对您的 WCF 服务的所有调用都是 在创建**OperationContextScope**对象之后并且**在****它**被释放之前进行的。否则 cookie 将永远不会被添加到请求中。

 ****如果您正在寻找一种集中式解决方案来手动将 cookie 添加到向 WCF 服务发出的所有传出 HTTP 请求中，请查看此线程：

[http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/624fb3f9-222d-4795-9140-fe9ef3934361/](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/624fb3f9-222d-4795-9140-fe9ef3934361/)

# linux - 使用常见的 linux 工具检查一堆 ip 地址是否属于给定网络的最简单方法是什么？

> ID：435606
> 
> 赞同：3
> 
> 时间：2009-01-12T14:39:34.897
> 
> 标签：linux, bash, command-line, networking, ip-address

使用常见的 linux 工具检查一堆 ip 地址是否属于给定网络的最简单方法是什么？我只需要一些给定地址属于给定子网的数量。假设网络是 192.16.55.40/27，地址是 192.16.55.45、192.16.55.115、88.87.45.8、192.16.55.37、192.16.55.60 和 192.16.55.210..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T14:49:26.453

我不确定您是否将 Ruby 视为“常用的 linux 工具”，但它有一个名为的不错的模块，它有一个为此`IPAddr`调用的方法`include?`。

```
require 'ipaddr'

net1 = IPAddr.new("192.168.2.0/24")
net2 = IPAddr.new("192.168.2.100")
net3 = IPAddr.new("192.168.3.0")
p net1.include?(net2)     #=> true
p net1.include?(net3)     #=> false 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T17:19:16.560

我需要这个，并决定创建一个简短的脚本。我需要 sed 和 bash。我会称它们为常见的 linux 工具。

*编辑：*显然，脚本太长而无法粘贴。你可以在这里找到它：http: [//folk.ntnu.no/olechrt/netaddr](http://folk.ntnu.no/olechrt/netaddr)

`$ cat ips`

```
192.16.55.45
192.16.55.115
88.87.45.8
192.16.55.210.11
192.16.55.37
192.16.55.60
192.16.55.210
256.87.45.8
```

`$ cat ips | netaddr 192.16.55.40/27`

```
192.16.55.45
Warning: Input IP "192.16.55.210.11" is invalid.
192.16.55.37
192.16.55.60
Warning: Input IP "256.87.45.8" is invalid.
```

最后，对于您要求的计数： `$ cat ips | netaddr 192.16.55.40/27 | wc -l`

```
Warning: Input IP "192.16.55.210.11" is invalid.
Warning: Input IP "256.87.45.8" is invalid.
3
```

# c# - 如何使超链接在 RichTextBox 中工作？

> ID：435607
> 
> 赞同：54
> 
> 时间：2009-01-12T14:39:59.327
> 
> 标签：c#, winforms, richtextbox

当我将 www.stackoverflow.com 添加到我的 RichTextBox 并运行程序时，它显示为蓝色并作为超链接显示，但是当我单击它时，什么也没有发生。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2009-01-12T14:54:28.097

1.  确保 text 属性包含有效的 url。例如[http://www.stackoverflow.com/](http://www.stackoverflow.com/)

2.  将**DetectUrls**属性设置为**true**

3.  **为LinkClicked**事件编写事件处理程序。

就个人而言，我不会像 Microsoft 建议的那样将**“IExplore.exe”**作为参数传递给**Process.Start**调用，因为这假定它已安装，并且是用户的首选浏览器。如果您只是将 url 传递给 process start（如下所示），那么 Windows 将做正确的事情并使用适当的 url 启动用户的首选浏览器。

```
private void mRichTextBox_LinkClicked (object sender, LinkClickedEventArgs e) {
    System.Diagnostics.Process.Start(e.LinkText);
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-12T14:43:42.877

RichTextBox 类允许您自定义用户单击超链接时的行为。[为RichTextBox.LinkClicked](http://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.linkclicked.aspx)事件添加事件处理程序

```
Process p = new Process();

private void richTextBox1_LinkClicked(object sender, LinkClickedEventArgs e)
{
   p = Process.Start("IExplore.exe", e.LinkText);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T14:46:09.767

您应该确保将`DetectUrls`其设置为`true`. 如果这本身不起作用，您可能需要为该`LinkClicked`事件添加一个处理程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T14:43:25.093

`yourTextBox.DetectUrls`设置为真？我们可能需要更多信息来提供更好的答案。

# css - CSS框架是如何使用的？

> ID：435620
> 
> 赞同：9
> 
> 时间：2009-01-12T14:44:50.580
> 
> 标签：css, frameworks

出于某种原因，我从未想过有 CSS 框架。我一直在自己的个人网站上工作，而且我真的很讨厌用 CSS 进行“设计”（我认为更多的程序员可能会同意我的观点）。无论如何，我了解框架对 Java、PHP、[插入语言] 等语言的好处。我下载了几个不同的 CSS 框架，但不知道如何使用它们。我想我可能期待一个 API 或其他东西（鉴于 CSS 中缺乏逻辑，这显然没有意义）......

这里有人使用过（并且会推荐）CSS 框架吗？对于一个相对简单的布局来说是不是有点矫枉过正？

请不要发布到其他网站的链接，我知道如何使用谷歌。我更愿意听取社区的意见和见解。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T14:51:02.080

我在几个项目中使用了[YAML（Yet Another Multicolumn Layout）](http://www.yaml.de/en/)，因为我不喜欢与 Internet Explorer 6 HACKS “战斗”。关于如何使用它有一个很好的解释，您可以根据需要对其进行自定义（只要您要使用多列（2 或 3）布局）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T15:02:05.087

请`framework`在这里简单理解为“完成工作的助手集合”。因此，在大多数情况下，您会得到一组 CSS 定义、重置器和 hack，当考虑到跨浏览器兼容性时，您可能需要自己编写代码。

没有链接？K. 首先，您应该熟悉网格设计技术。我的前端开发人员伙伴推荐 Blueprint 来处理基于 CSS 的布局，无论它们多么复杂。希望这有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T15:07:14.343

*警告：几年来我还没有真正研究过这个主题，情况可能已经改变。*

我过去玩过的少数 CSS 框架或多或少都是为捕捉网格而设计的可怕的东西，将所见即所得带入图片的错误想法，并提供诸如通用圆角之类的东西。它们往往存在一些语义问题 ( `.italic`FTL)，并且需要对框架进行大量手动修改。

对于 CSS 初学者或快速开发站点来说，更实用的可能是 CSS 重置，它可以跨浏览器（[雅虎](http://developer.yahoo.com/yui/3/cssreset/)）（[Erik Meyer](http://meyerweb.com/eric/thoughts/2007/05/01/reset-reloaded/)）为 CSS 提供基线。但这并非没有它自己的[争议](http://snook.ca/archives/html_and_css/no_css_reset/)，而且似乎永远*不够*。

基本上。我发现 CSS 需要你自己的常用技术工具箱，但你会不断挑选和修改。与大多数网络开发人员一样，我认为您获得的经验越多，您就越想自己动手。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T22:47:49.480

960.gs 最近似乎在设计师中相当流行，尽管我自己从未完全理解 CSS 框架的意义。

# delphi - 是否有任何关于如何在 Delphi 中使用接口的视频/屏幕转换或其他资源？

> ID：435623
> 
> 赞同：6
> 
> 时间：2009-01-12T14:45:51.577
> 
> 标签：delphi

嗨，有没有关于如何在 delphi 中使用接口的精彩视频或其他资源？

我追求基础知识和更高级的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-12T17:31:36.610

一旦你在网上阅读了一些东西，你可能应该看看其他程序员的代码，看看他们如何（以及为什么）在*实际*代码中使用接口。

例如，[在 dUnit SourceForge 站点的 Subversion 存储库中，](http://dunit.svn.sourceforge.net/viewvc/dunit/trunk/contrib/DUnitWizard/Source/Common/)您会找到[XPObserver.pas](http://dunit.svn.sourceforge.net/viewvc/dunit/trunk/contrib/DUnitWizard/Source/Common/XPObserver.pas?view=markup)文件，该文件使用接口实现了 Delphi 的观察者模式。这段代码非常有趣，因为通常在这种模式下，每个被观察对象都保存一个观察者列表，每个观察者都保存对他们观察到的对象的引用。使用接口的简单实现会创建循环引用，接口会阻止其引用计数达到 0，这将导致内存泄漏。XPObserver.pas 中的代码显示了如何使用类型转换来解决这个问题。

IMO 大多数 XP*.pas 文件都值得仔细研究。例如[，XPInterfacedObject.pas](http://dunit.svn.sourceforge.net/viewvc/dunit/trunk/contrib/DUnitWizard/Source/Common/XPInterfacedObject.pas?view=markup)包含了为什么聚合接口都必须使用公共引用计数器的解释，并提供了 VCL 中实现的 TAggregatedObject 和 TContainedObject 的替代解决方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T14:59:28.227

不是视频，但这[解释](http://www.delphibasics.co.uk/Article.asp?Name=Interface)了基础知识。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T15:59:20.803

由于 COM 使用接口[，因此本在线课程](http://delphi.about.com/od/comoleactivex/l/aa112304a.htm)也是对接口的介绍。

# c++ - 如何正确地对 [模板化] C++ 程序进行基准测试

> ID：435627
> 
> 赞同：7
> 
> 时间：2009-01-12T14:46:22.933
> 
> 标签：c++, optimization, benchmarking

<背景>

我正处于我真正需要优化 C++ 代码的地步。我正在编写一个用于分子模拟的库，我需要添加一个新功能。过去我已经尝试添加此功能，但后来我使用了嵌套循环中调用的虚函数。我对此有不好的感觉，第一次实施证明这是一个坏主意。然而，这对于测试这个概念来说是可以的。

</背景>

现在我需要这个功能尽可能快（没有汇编代码或 GPU 计算，这仍然必须是 C++ 并且比更少的可读性更强）。现在我对模板和类策略有了更多的了解（来自 Alexandrescu 的优秀书籍），我认为编译时代码生成可能是解决方案。

但是，在将设计实现到库中*之前*，我需要对其进行测试。问题是关于测试此新功能效率的最佳方法。

显然我需要打开优化，因为没有这个 g++（可能还有其他编译器）会在目标代码中保留一些不必要的操作。我还需要大量使用基准测试中的新特性，因为 1e-3 秒的 delta 可以决定设计的好坏（这个特性在实际程序中会被调用百万次）。

问题是 g++ 在优化时有时“太聪明了”，如果它认为计算的结果从未被使用过，它可以删除整个循环。在查看输出汇编代码时，我已经看到过一次。

如果我向标准输出添加一些打印，编译器将被迫在循环中进行计算，但我可能主要对 iostream 实现进行基准测试。

那么如何对从库中提取的小特征进行**正确的基准测试呢？***相关问题：在一个小单元上进行这种体外*测试是正确的方法还是我需要整个背景？

感谢您的建议！

* * *

似乎有几种策略，从允许微调的编译器特定选项到更通用的解决方案，这些解决方案应该适用于每个编译器，如`volatile`or `extern`。

我想我会尝试所有这些。非常感谢您的所有回答！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-13T15:09:17.333

如果要强制*任何*编译器不丢弃结果，请让它将结果写入 volatile 对象。根据定义，该操作无法优化。

```
template<typename T> void sink(T const& t) {
   volatile T sinkhole = t;
} 
```

没有 iostream 开销，只是必须保留在生成的代码中的副本。现在，如果您要从大量操作中收集结果，最好不要将它们一一丢弃。这些副本仍然会增加一些开销。相反，以某种方式将所有结果收集到一个非易失性对象中（因此需要所有单独的结果），然后将该结果对象分配给易失性对象。例如，如果您的各个操作都产生字符串，您可以通过将所有 char 值加在一起以模 1<<32 来强制评估。这几乎不会增加任何开销；字符串可能会在缓存中。添加的结果随后将分配给 volatile，因此每个字符串中的每个字符实际上都必须进行计算，不允许使用快捷方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T14:51:35.090

除非你有一个*非常*激进的编译器（可能发生），否则我建议计算一个校验和（只需将所有结果加在一起）并输出校验和。

除此之外，您可能希望在运行任何基准测试之前查看生成的汇编代码，以便您可以直观地验证任何循环实际上正在运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T15:10:03.277

编译器只允许消除不可能发生的代码分支。只要它不能排除一个分支应该被执行，它就不会消除它。只要某处存在一些数据依赖关系，代码就会存在并运行。编译器不太聪明地估计程序的哪些方面不会运行并且不要尝试，因为这是一个 NP 问题并且几乎不可计算。他们有一些简单的检查，例如 for `if (0)`，但仅此而已。

我的拙见是，您之前可能遇到过其他问题，例如 C/C++ 评估布尔表达式的方式。

但无论如何，由于这是关于速度测试，您可以检查是否为自己调用 - 运行一次而不运行它，然后再次测试返回值。或者增加一个静态变量。在测试结束时，打印出生成的数字。结果将是平等的。

要回答您关于体外测试的问题：是的，请这样做。如果您的应用程序对时间如此紧迫，请执行此操作。另一方面，您的描述暗示了一个不同的问题：如果您的增量在 1e-3 秒的时间范围内，那么这听起来像是一个计算复杂性的问题，因为必须非常非常频繁地调用所讨论的方法（对于几次运行，1e-3 秒可以忽略不计）。

您正在建模的问题域听起来非常复杂，并且数据集可能很大。这样的事情总是一个有趣的努力。不过，请确保您首先绝对拥有正确的数据结构和算法，然后再对您想要的一切进行微优化。**所以，我想说先看看整个上下文。**;-)

出于好奇，您正在计算的问题是什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T15:10:07.177

您对编译的优化有很多控制权。-O1、-O2 等等只是一堆开关的别名。

从手册页

```
 -O2 turns on all optimization flags specified by -O.  It also turns
       on the following optimization flags: -fthread-jumps -falign-func‐
       tions  -falign-jumps -falign-loops  -falign-labels -fcaller-saves
       -fcrossjumping -fcse-follow-jumps  -fcse-skip-blocks
       -fdelete-null-pointer-checks -fexpensive-optimizations -fgcse
       -fgcse-lm -foptimize-sibling-calls -fpeephole2 -fregmove -fre‐
       order-blocks  -freorder-functions -frerun-cse-after-loop
       -fsched-interblock  -fsched-spec -fschedule-insns  -fsched‐
       ule-insns2 -fstrict-aliasing -fstrict-overflow -ftree-pre
       -ftree-vrp 
```

您可以调整并使用此命令来帮助您缩小要调查的选项。

```
 ...
       Alternatively you can discover which binary optimizations are
       enabled by -O3 by using:

               gcc -c -Q -O3 --help=optimizers > /tmp/O3-opts
               gcc -c -Q -O2 --help=optimizers > /tmp/O2-opts
               diff /tmp/O2-opts /tmp/O3-opts Φ grep enabled 
```

一旦你找到了罪魁祸首优化，你就不需要 cout 了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T15:11:01.900

如果这对您来说是可能的，您可以尝试将代码拆分为：

*   您要测试的库在所有优化打开的情况下编译
*   一个测试程序，动态链接库，优化关闭

否则，您可能会使用 optimize 属性为测试函数指定不同的优化级别（看起来您正在使用 gcc ...）（请参阅[http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes .html#Function-Attributes](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html#Function-Attributes)）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-12T15:35:55.580

您可以在单独的 cpp 文件中创建一个不执行任何操作的虚拟函数，但将计算结果的类型作为参数。然后您可以使用计算结果调用该函数，强制 gcc 生成中间代码，唯一的惩罚是调用函数的成本（除非您经常调用它，否则它不应该扭曲您的结果*！*）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-12T17:01:03.690

```
#include <iostream>

// Mark coords as extern.
// Compiler is now NOT allowed to optimise away coords
// This it can not remove the loop where you initialise it.
// This is because the code could be used by another compilation unit
extern double coords[500][3];
double coords[500][3];

int main()
{

//perform a simple initialization of all coordinates:
for (int i=0; i<500; ++i)
 {
   coords[i][0] = 3.23;
   coords[i][1] = 1.345;
   coords[i][2] = 123.998;
 }

std::cout << "hello world !"<< std::endl;
return 0;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-12T21:10:54.950

**编辑**：您可以做的最简单的事情就是在函数运行后并在基准测试之外以某种虚假的方式使用数据。像，

```
StartBenchmarking(); // ie, read a performance counter
for (int i=0; i<500; ++i)
 {
   coords[i][0] = 3.23;
   coords[i][1] = 1.345;
   coords[i][2] = 123.998;
 }
StopBenchmarking(); // what comes after this won't go into the timer

// this is just to force the compiler to use coords
double foo;
for (int j = 0 ; j < 500 ; ++j )
{
  foo += coords[j][0] + coords[j][1] + coords[j][2]; 
}
cout << foo; 
```

* * *

在这些情况下，有时对我有用的是将*体外*测试隐藏在函数中，并通过**易失性**指针传递基准数据集。这告诉编译器它不能折叠对这些指针的后续写入（因为它们可能是*例如*内存映射 I/O）。所以，

```
void test1( volatile double *coords )
{
  //perform a simple initialization of all coordinates:
  for (int i=0; i<1500; i+=3)
  {
    coords[i+0] = 3.23;
    coords[i+1] = 1.345;
    coords[i+2] = 123.998;
  }
} 
```

出于某种原因，我还没有弄清楚它并不总是在 MSVC 中工作，但它经常工作——查看程序集输出以确定。还要记住，**volatile**会阻止一些编译器优化（它禁止编译器将指针的内容保存在寄存器中并强制写入按程序顺序进行），因此只有在将它用于数据的最终写出时才值得信赖。

一般来说，这样的体外测试非常有用，只要您记住这不是全部。我通常像这样孤立地测试我的新数学例程，以便我可以快速迭代算法的缓存和管道特性，以获取一致的数据。

像这样的试管分析与在“现实世界”中运行它之间的区别意味着您将获得变化很大的输入数据集（有时是最好的情况，有时是最坏的情况，有时是病态的），缓存将在进入时处于某种未知状态该函数，并且您可能有其他线程在总线上碰撞；*所以你应该在完成后在vivo*中运行这个函数的一些基准测试。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-12T15:16:32.827

我不知道 GCC 是否有类似的功能，但使用 VC++ 你可以使用：

```
#pragma optimize 
```

选择性地打开/关闭优化。如果 GCC 具有类似的功能，您可以构建完全优化并在必要时将其关闭以确保您的代码被调用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-12T16:18:35.180

只是一个不需要的优化的小例子：

```
#include <vector>
#include <iostream>

using namespace std;

int main()
{
double coords[500][3];

//perform a simple initialization of all coordinates:
for (int i=0; i<500; ++i)
 {
   coords[i][0] = 3.23;
   coords[i][1] = 1.345;
   coords[i][2] = 123.998;
 }

cout << "hello world !"<< endl;
return 0;
} 
```

如果您将代码从“double coords[500][3]”注释到 for 循环的末尾，它将生成完全相同的汇编代码（刚刚使用 g++ 4.3.2 尝试过）。我知道这个例子太简单了，我无法用一个简单的“坐标”结构的 std::vector 来展示这种行为。

但是我认为这个例子仍然表明一些优化可能会在基准测试中引入错误，我想在库中引入新代码时避免这种意外。很容易想象新的上下文可能会阻止一些优化并导致一个非常低效的库。

虚函数也应如此（但我在这里没有证明）。在静态链接可以完成工作的上下文中使用我非常有信心体面的编译器应该消除对虚函数的额外间接调用。我可以在循环中尝试这个调用并得出结论，调用虚函数并不是什么大问题。然后我会在编译器无法猜测指针的确切类型并且运行时间增加 20% 的上下文中调用它十万次......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-12T19:21:16.997

在启动时，从文件中读取。在你的代码中，说 if(input == "x") cout<< result_of_benchmark;

编译器将无法消除计算，如果您确保输入不是“x”，您将不会对 iostream 进行基准测试。

# c# - Castle Windsor - 一个实现多个接口的类

> ID：435629
> 
> 赞同：1
> 
> 时间：2009-01-12T14:46:40.797
> 
> 标签：c#, castle-windsor, ioc-container

我在应用程序启动时注册了我的两个接口：-

```
container.Register(Component.For(typeof(IEntityIndexController)).ImplementedBy(typeof(SnippetController)).LifeStyle.Transient);
container.Register(Component.For(typeof(ISnippetController)).ImplementedBy(typeof(SnippetController)).LifeStyle.Transient); 
```

然后，当我尝试在此处使用第二个接口（ISnippetController）的对象上运行 IoC.Resolve 时，它​​会引发以下异常：-

*无法创建组件“MyApp.Admin.Presenters.SnippetPresenter”，因为它需要满足依赖关系。MyApp.Admin.Presenters.SnippetPresenter 正在等待以下依赖项： 服务：-未注册的 MyApp.Admin.Controllers.ISnippetController。*

如果我切换注册的顺序，它会抱怨它找不到 IEntityIndexController。因此，它似乎只获取一个类的第一个注册，然后忽略映射到同一个具体类的任何其他接口。

这里有什么明显的我想念的吗？（ps即时使用.net 3.5，温莎RC3）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T07:16:29.847

您是否尝试过使用不同的语法 ( `AddComponent<>`) 进行注册？

尝试更新到最新的主干版本，看看是否有帮助。对我来说似乎是一个错误。如果没有发生，请创建一个显示错误的测试，并在[此处提交](http://support.castleproject.org/projects/IOC)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T15:14:15.450

更新到最新的中继 (1015) 并使用修复了问题的转发类型。:-)

# ruby-on-rails - FasterCSV：读取远程 CSV 文件

> ID：435634
> 
> 赞同：3
> 
> 时间：2009-01-12T14:49:01.553
> 
> 标签：ruby-on-rails, url, csv, fastercsv

我似乎无法让它工作。我想从不同的网络服务器中提取一个 CSV 文件以在我的应用程序中读取。这就是我想这样称呼它：

```
url = 'http://www.testing.com/test.csv'
records = FasterCSV.read(url, :headers => true, :header_converters => :symbol) 
```

但这不起作用。我试过谷歌搜索，我想出的只是这段摘录：[实用红宝石宝石](http://books.google.com/books?id=QC0rgGTmeNAC&pg=PA123&lpg=PA123&dq=fastercsv+%22open+url%22&source=web&ots=aMLo1W-6Er&sig=-DmI4m_AeHGL3ulqRgKNFKbEEHU&hl=en&sa=X&oi=book_result&resnum=1&ct=result)

因此，我尝试将其修改如下：

```
require 'open-uri'
url = 'http://www.testing.com/test.csv'
csv_url = open(url)
records = FasterCSV.read(csv_url, :headers => true, :header_converters => :symbol) 
```

...我收到一个`can't convert Tempfile into String`错误（来自 FasterCSV gem）。

谁能告诉我如何使这项工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T22:53:51.327

```
require 'open-uri'
url = 'http://www.testing.com/test.csv'
open(url) do |f|
  f.each_line do |line|
    FasterCSV.parse(line) do |row|
      # Your code here
    end
  end
end 
```

[http://www.ruby-doc.org/core/classes/OpenURI.html](http://www.ruby-doc.org/core/classes/OpenURI.html) [http://fastercsv.rubyforge.org/](http://fastercsv.rubyforge.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T14:52:37.570

我会用`Net::HTTP`例如检索文件并将其提供给`FasterCSV`

摘自`ri Net::HTTP`

```
 require 'net/http'
 require 'uri'

 url = URI.parse('http://www.example.com/index.html')
 res = Net::HTTP.start(url.host, url.port) {|http|
   http.get('/index.html')
 }
 puts res.body 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-02T22:33:33.357

你只是有一个小错字。您应该使用`FasterCSV.parse`而不是`FasterCSV.read`：

```
data = open('http://www.testing.com/test.csv')
records = FasterCSV.parse(data) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-10T22:30:42.910

我会用 rio 下载它 - 就像这样简单：

```
require 'rio'
require 'fastercsv'

array_of_arrays = FasterCSV.parse(rio('http://www.example.com/index.html').read) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-10T18:48:40.137

我使用 Paperclip 上传 CSV 文件并将其保存到 Cloudfiles，然后使用 Delayed_job 开始文件处理。

这对我有用：

```
require 'open-uri'
url = 'http://www.testing.com/test.csv'
open(url) do |file|
  FasterCSV.parse(file.read) do |row|
    # Your code here
  end
end 
```

# svn - 如何在 Tortoise SVN 中更改存储库的修订号？

> ID：435638
> 
> 赞同：5
> 
> 时间：2009-01-12T14:50:41.753
> 
> 标签：svn, tortoisesvn

我有一个修订号为 3960 的项目。但不幸的是，它不受源代码控制。现在我想把它放在 SVN 下并使用 Tortoise SVN。但是当我把它放在那里时，它会从 1、2、3、4 等开始修订。

有没有办法将修订号更改为 3960？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-12T15:07:34.357

我能想到的最安全的方法是制作一个包含适当数量的空修订版的转储文件，而不是加载它。格式类似于：

```
SVN-fs-dump-format-version: 2

Revision-number: 0
Prop-content-length: 56
Content-length: 56

K 8
svn:date
V 27
2009-01-12T14:58:15.449041Z
PROPS-END

Revision-number: 1
Prop-content-length: 56
Content-length: 56

K 8
svn:date
V 27
2009-01-12T14:58:40.758271Z
PROPS-END

Revision-number: 2
Prop-content-length: 56
Content-length: 56

K 8
svn:date
V 27
2009-01-12T14:58:44.509698Z
PROPS-END 
```

您可以省略 svn:date 并且它仍然是一个有效的 svn 存储库，但是 {date} 的查询将不起作用（就像它们在任何情况下都不会随着修订而单调增加日期一样）。所以最好伪造一串似是而非的日期。

如果你想要 3960 这样的修订，你可能想写一个脚本来生成转储文件。我把它作为练习留给读者:-)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-12T14:55:10.310

[理论上](http://www.philmug.ph/forum/showthread.php?t=31613)是可行的，但不是很有用。

如果您需要以某种方式跟踪此信息，您可以考虑创建标签“3960”，否则会继续进行正常的修订过程。

正如手册中所说：

> **全局修订号**
> 与许多其他版本控制系统不同，Subversion 的修订号适用于整个树，而不是单个文件。每个修订号选择一整棵树，在一些提交的更改之后存储库的特定状态。
> 另一种思考方式是修订 N 代表第 N 次提交后存储库文件系统的状态。当一个 Subversion 用户谈到“foo.c 的第 5 版”时，他们的真正意思是“在第 5 版中出现的 foo.c”。</p>

修订号不同于**应用程序版本号”（您的应用程序的版本号）：后者由标签表示。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T14:56:07.517

首先，我不知道如何做到这一点。如果可能的话，我认为你必须使用 svn-hookscript。

其次，Source Control Systems 中的修订号与您的程序的修订（Version）号无关。源代码控制系统会跟踪您提交的每个更改，因此您提交的内容可能比构建代码的次数多得多。如果您不只是使用新的内部版本号提交更改，并且我认为您不应该只以如此大的步骤检查更改，那么每次可能都会有所不同。

为了跟踪您的内部版本号，您应该使用标签。

# java - ActiveMQ：队列查找问题

> ID：435640
> 
> 赞同：6
> 
> 时间：2009-01-12T14:51:17.573
> 
> 标签：java, jms, activemq

[如文档](http://activemq.apache.org/configure-startup-destinations.html)中所述，我通过在 activemq.xml（ActiveMQ 版本 5.2.0）中配置它来设置队列。

```
<destinations>
    <queue physicalName="FOO.BAR" />
    <queue physicalName="DUMMY" />
</destinations> 
```

我正在尝试使用以下代码从java（在同一主机上）访问它：

```
Hashtable properties = new Hashtable();
properties.put(Context.INITIAL_CONTEXT_FACTORY, 
    "org.apache.activemq.jndi.ActiveMQInitialContextFactory");
properties.put(Context.PROVIDER_URL, "tcp://localhost:61616");

context = new InitialContext(properties);

factory = (ConnectionFactory) context.lookup("ConnectionFactory");
connection = factory.createConnection();
session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
queueName = "DUMMY"; // which can be either FOO.BAR or DUMMY
dest = (Destination) context.lookup(queueName); 
```

我收到以下错误，尽管队列在 jconsole（树/org.apache.activemq/队列）中可见：

```
javax.naming.NameNotFoundException: DUMMY 
```

请告诉我我做错了什么。非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-12T20:12:24.383

首先，您不必[在代理中显式创建任何队列，](http://activemq.apache.org/how-do-i-create-new-destinations.html)尽管它没有害处。

此外，代理中可用的目的地也不会使用某种 JNDI 名称自动映射到 JNDI 上下文中。

您可以[按照此处所述明确](http://activemq.apache.org/jndi-support.html)执行此操作。如果您想要 JNDI 的自动神奇填充，则使用*dynamicQueues/DUMMY*的 JNDI 命名约定作为您查找的 JNDI 名称（如[动态创建目的地](http://activemq.apache.org/jndi-support.html)中所述）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T21:40:38.400

嗯..好吧，当我想听队列时，我通常会做这样的事情。（从 javax.jms 导入）

队列队列；

```
 // Connect to ActiveMQ
    ActiveMQConnectionFactory factory = new ActiveMQConnectionFactory(messageBrokerURL);
    connection = factory.createConnection();
    session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);

    // List to Dummy Queue
    queue = session.createQueue("DUMMY");
    messageConsumer = session.createConsumer(queue);
    messageConsumer.setMessageListener(queueHandler);

    // Start the connection
    connection.start(); 
```

并确保您的 Handler 实现了 MessageListener。

# nhibernate - 在 HQL 或标准中获取 DATEPART？

> ID：435645
> 
> 赞同：2
> 
> 时间：2009-01-12T14:52:47.553
> 
> 标签：nhibernate, datetime, hql, criteria

如何使用 HQL 或 Criteria 获得 DATEPART 时间？我已经用谷歌搜索了它并获得了一些提示，但还不够。如果有人以前经历过，请告诉我们。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T15:16:06.617

看看这篇关于在ayende[的 nhibernate 中使用 sql 函数的帖子。](http://ayende.com/Blog/archive/2006/10/01/UsingSQLFunctionsInNHibernate.aspx)

**编辑**我在配置文件中取得了这样的成功：

```
<property name="query.substitutions">
   true 1, false 0, yes 'Y', no 'N',getdate=getdate
</property> 
```

注意getdate = getdate，不确定这是多么推荐，但它正在使用sql函数:)。

有关此的更多信息：[http](http://www.hibernate.org/hib_docs/nhibernate/html/session-configuration.html) : //www.hibernate.org/hib_docs/nhibernate/html/session-configuration.html，搜索 query.substitutions。

# git - 合并 Git 存储库的前两个提交？

> ID：435646
> 
> 赞同：215
> 
> 时间：2009-01-12T14:53:21.203
> 
> 标签：git, rebase, git-rebase, git-rewrite-history

假设您有一个包含三个提交*A、B*和*C*的历史记录：

```
A-B-C 
```

我想将两个提交*A*和*B*合并为一个提交*AB*：

```
AB-C 
```

我试过

```
git rebase -i A 
```

这将打开我的编辑器，其中包含以下内容：

```
pick e97a17b B
pick asd314f C 
```

我把它改成

```
squash e97a17b B
pick asd314f C 
```

然后 Git 1.6.0.4 说：

```
Cannot 'squash' without a previous commit 
```

有没有办法或者这是不可能的？

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2014-02-09T02:14:48.493

`git rebase -i --root` 从 Git[版本 1.7.12](https://github.com/git/git/blob/master/Documentation/RelNotes/1.7.12.txt)开始使用。

在交互式 rebase 文件中，将提交*B*的第二行更改为*squash*并将其他行保留在*pick*：

```
pick f4202da A
squash bea708e B
pick a8c6abc C 
```

这会将两个提交*A*和*B*合并为一个提交*AB*。

在[这个答案](https://stackoverflow.com/a/9254257/105137)中找到。

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2009-02-12T14:29:00.527

你试过：

```
git rebase -i A 
```

如果您继续使用`edit`而不是`squash`：

```
edit e97a17b B
pick asd314f C 
```

然后运行

```
git reset --soft HEAD^
git commit --amend
git rebase --continue 
```

完毕。

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2009-01-12T18:46:20.810

`A`是最初的提交，但现在你想`B`成为最初的提交。git 提交是整棵树，而不是差异，即使它们通常是根据它们引入的差异来描述和查看的。

即使 A 和 B 以及 B 和 C 之间有多个提交，这个配方也有效。

```
# Go back to the last commit that we want
# to form the initial commit (detach HEAD)
git checkout <sha1_for_B>

# reset the branch pointer to the initial commit,
# but leaving the index and working tree intact.
git reset --soft <sha1_for_A>

# amend the initial tree using the tree from 'B'
git commit --amend

# temporarily tag this new initial commit
# (or you could remember the new commit sha1 manually)
git tag tmp

# go back to the original branch (assume master for this example)
git checkout master

# Replay all the commits after B onto the new initial commit
git rebase --onto tmp <sha1_for_B>

# remove the temporary tag
git tag -d tmp 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-12T15:05:39.883

在交互式 rebase 的情况下，您必须在 A 之前执行此操作，以便列表为：

```
pick A
pick B
pick C 
```

成为：

```
pick A
squash B
pick C 
```

如果 A 是初始提交，则必须在 A 之前进行不同的初始提交。Git 考虑差异，它将处理（A 和 B）和（B 和 C）之间的差异。因此，壁球在您的示例中不起作用。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-07-23T15:00:27.867

如果您有数百或数千次提交，请使用[kostmo 的](https://stackoverflow.com/a/21654379/456814)回答

```
git rebase -i --root 
```

*可能是不切实际和缓慢的，只是由于变基脚本必须处理两次*大量提交，一次生成交互式变基编辑器列表（您可以在其中选择对每个提交采取的操作），一次实际执行重新应用提交。

这是一个**替代解决方案，它可以***通过首先不使用交互式 rebase*来避免生成交互式 rebase 编辑器列表的时间成本。这样，类似于[Charles Bailey 的解决方案](https://stackoverflow.com/a/436530/456814)。您只需从第二次提交创建一个*孤立分支*，然后将所有后代提交重新设置在它之上：

```
git checkout --orphan orphan <second-commit-sha>
git commit -m "Enter a commit message for the new root commit"
git rebase --onto orphan <second-commit-sha> master 
```

## 文档

*   [git-checkout(1) 手册页](http://git-scm.com/docs/git-checkout)
*   [git-rebase(1) 手册页](http://git-scm.com/docs/git-rebase)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-14T08:15:03.477

在一个相关的问题中，我设法提出了一种不同的方法来解决第一次提交的压缩需求，也就是说，使它成为第二次提交。

如果您有兴趣：[git：如何将提交作为第一个插入，然后转移所有其他提交？](https://stackoverflow.com/questions/645450/git-how-to-insert-a-commit-as-the-first-shifting-all-the-others)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-22T06:35:18.700

小队的 Git 命令： git rebase -i HEAD~[提交次数]

假设您有以下 git 提交历史记录：

选择 5152061 壮举：添加了对保存图像的支持。(A)
pick 39c5a04 Fix：错误修复。(B)
选择 839c6b3 修复：冲突已解决。（C）

现在你想将 A 和 B 压缩到 AB，执行以下步骤：

选择 5152061 壮举：添加了对保存图像的支持。(A)
s 39c5a04 修复：错误修复。(B)
选择 839c6b3 修复：冲突已解决。（C）

注意：对于压缩提交，我们可以使用 squash 或 s。最终结果将是：
pick 5152061 壮举：增加了对保存图像的支持。(AB)
选择 839c6b3 修复：冲突已解决。（C）

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-12T15:36:17.530

您必须执行一些命令行魔术。

```
git checkout -b a A
git checkout B <files>
git commit --amend
git checkout master
git rebase a 
```

那应该会给您留下一个以 AB 和 C 作为提交的分支。

# flash - 即使鼠标不在面板上，滚动菜单面板也会滚动 - 因此舞台上的其他内容也会滚动

> ID：435647
> 
> 赞同：0
> 
> 时间：2009-01-12T14:53:33.403
> 
> 标签：flash, actionscript-3

我无法将此代码限制为仅滚动 front_mc 和 back_mc，front_mc 中​​的嵌套按钮可以工作并在单击时显示内容 - 但是鼠标移动一直被捕获，因此菜单的内容也会滚动，当鼠标移动。请帮帮我，我不适合处理它。

```
root.addEventListener(MouseEvent.MOUSE_MOVE,f); 
```

var t:Timer=new Timer(40,0); t.addEventListener(TimerEvent.TIMER,moveF); 函数 f(e:MouseEvent) { t.stop(); t.start(); 变量速度：数字= .9；

function moveF(e:TimerEvent) { front_mc.x =speed *front_mc.x+(1-speed)* (stage.stageWidth-front_mc.width) root.mouseX */stage.stageWidth; back_mc.x = 速度*back_mc.x+(1-speed)*(stage.stageWidth-back_mc.width)*root.mouseX/stage.stageWidth; if (Math.abs(front_mc.x- (stage.stageWidth-front_mc.width)*root.mouseX/stage.stageWidth)<1 && Math.abs(back_mc.x-(stage.stageWidth-back_mc.width)*root .mouseX/stage.stageWidth)<1) { front_mc.x = (stage.stageWidth-front_mc.width)*root.mouseX/stage.stageWidth; back_mc.x = (stage.stageWidth-back_mc.width)*root.mouseX/stage.stageWidth; t.stop();

```
}
e.updateAfterEvent(); 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-12T16:47:25.497

不幸的是，它不会改变行为:(但非常感谢你的提示

它做什么&应该做什么：如果mousesY是90和250（它的按钮行比舞台长），这个front_mc水平滚动一个菜单按钮和它们的公共时间线作为menu_mc嵌套在front_mc中。

如果我在菜单上横向移动并且它向左/向右滚动并且我按下一个按钮，则内容被绘制，但是当我返回菜单并且它正在滚动时，绘制的内容也是如此，类似于菜单（同步）。我一定是组织错了。

front_mc.addEventListener(MouseEvent.MOUSE_MOVE,f); var t:Timer=new Timer(30,0); t.addEventListener(TimerEvent.TIMER,moveF);

函数 f(e:MouseEvent) { if(root.mouseY > 90 && root.mouseY < 250) { t.start(); } 其他 { t.stop(); } } var speed:Number = .9; function moveF(e:TimerEvent) { front_mc.x =speed *front_mc.x+(1-speed)* (stage.stageWidth-front_mc.width) root.mouseX */stage.stageWidth; back_mc.x = 速度*back_mc.x+(1-speed)*(stage.stageWidth-back_mc.width)*root.mouseX/stage.stageWidth; if (Math.abs(front_mc.x- (stage.stageWidth-front_mc.width)*root.mouseX/stage.stageWidth)<1 && Math.abs(back_mc.x-(stage.stageWidth-back_mc.width)*root .mouseX/stage.stageWidth)<1) { front_mc.x = (stage.stageWidth-front_mc.width)*root.mouseX/stage.stageWidth; back_mc.x = (stage.stageWidth-back_mc.width)*root.mouseX/stage.stageWidth; t.stop();

} e.updateAfterEvent(); }

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T14:23:01.727

**解决了。**

因为 _root.gotoAndStop(); 从 AS1-2 中删除，Actionscript3 AS3 中引用例如 mc 内的按钮调用内容到舞台的最简单方法是

MovieClip(root).gotoAndStop("Marker1");

我以为我在主时间轴 MTL 上没有 Movieclip，但它确实有效，将其设置为嵌套按钮的动作，你就不会感到意外：就像我的情况一样

我将滚动菜单（front_mc）嵌套在 MTL 上的 mc 中，内容在主舞台上被调用，而不会被我移动的 front_mc 劫持

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-07T14:58:51.710

你使用了太多的文字和代码。您可以添加简单的 if(hitTest) 异常。

# ssis - 如何手动使集成服务中的包失败？

> ID：435651
> 
> 赞同：18
> 
> 时间：2009-01-12T14:55:06.223
> 
> 标签：ssis

我在我的 SSIS 包中运行 Execute SQL Task 语句。执行 SQL 任务正在运行 sql 并检查表是否超过 1000 行。如果它们的行数少于 1000，我想使包失败。

如何在 SQL 语句中强制失败？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-12T15:12:07.327

AFAIK，SSIS 中的任务因错误而失败。因此，如果您的 Execute SQL Task 中有这样的语句：

```
declare @count int
select @count = select count(*) from my_table
if @count < 1000
begin
    raiserror('Too few rows in my_table',16,1)
end
else
begin
    -- Process your table here
end 
```

你应该得到你想要的结果。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2015-06-26T14:56:18.063

我喜欢通过使用脚本任务来强制失败。这真的很容易。

1）添加脚本任务

2) 将自动生成的代码行从：

```
Dts.TaskResult = (int)ScriptResults.Success; 
```

到

```
Dts.TaskResult = (int)ScriptResults.Failure; 
```

你去吧！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-01T10:27:55.537

您可以像这样创建自定义错误消息

```
EXEC sp_ADDMESSAGE 
        @msgnum=55555,
        @severity=1,
        @msgtext='Threshold condition failed. The package execution has been terminated.' 
```

然后，您可以使用 Raiserror() 调用此错误

```
Raiserror (55555,20,-1) WITH LOG 
```

**您需要为严重性**输入一个大于 18 的数字（此处为 20）。您需要为此拥有管理员权限。并且不要忘记**WITH LOG**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-14T11:23:55.167

您需要使属性 FailPackageOnFailure 为 true..尝试检索特定任务的属性 FailPackageOnFailure 并将值分配为 true。因此该软件包将失败。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-08T17:51:05.357

1.  创建用户变量。将记录计数存储在该变量中 (User::Rcnt)
2.  只需使用发送邮件任务并定义工作流程。
3.  在先例约束中 (User::Rcnt<20)

# php - 国际资源标识符验证

> ID：435657
> 
> 赞同：1
> 
> 时间：2009-01-12T14:57:28.510
> 
> 标签：php, validation

验证 RFC 3986 的 URI 相当简单。您可以使用[正则表达式，例如](http://mattfarina.com/2009/01/08/rfc-3986-url-validation)：

```
/^                                                     # Start at the beginning of the text
([a-z][a-z0-9\*\-\.]*):\/\/                            # The scheme
(?:                                                    # Userinfo (optional)                                              
  (?:(?:[\w\.\-\+!$&'\(\)*\+,;=]|%[0-9a-f]{2})+:)*
  (?:[\w\.\-\+%!$&'\(\)*\+,;=]|%[0-9a-f]{2})+@
)?
(?:                                                    # The domain
  (?:[a-z0-9\-\.]|%[0-9a-f]{2})+                       # Domain name or IPv4
  |(?:\[(?:[0-9a-f]{0,4}:)*(?:[0-9a-f]{0,4})\])        # or IPv6
)
(?::[0-9]+)?                                           # Server port number (optional)
(?:[\/|\?]
  (?:[\w#!:\.\?\+=&@!$'~*,;\/\(\)\[\]\-]|%[0-9a-f]{2}) # The path (optional) 
*)?
$/xi 
```

但是，这不适用于国际域名中的国际字符。例如，[http://例え.テスト/メインページ](http://%E4%BE%8B%E3%81%88.%E3%83%86%E3%82%B9%E3%83%88/%E3%83%A1%E3%82%A4%E3%83%B3%E3%83%9A%E3%83%BC%E3%82%B8)。

使用类似的东西

```
filter_var($url, FILTER_VALIDATE_URL, FILTER_FLAG_SCHEME_REQUIRED); 
```

也不适用于这些。这个问题与使用的字符有关。

有没有一种在 PHP 中验证 URI 的好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T10:40:55.627

使用 preg_match \pL 将匹配任何 unicode 字母。所以将 az 替换为 \pL。和 0-9 与 \pN。有关详细信息，请参阅[正则表达式详细](http://au.php.net/manual/en/regexp.reference.php#regexp.reference.unicode)信息。

# c# - C# 中的简单线程池代码

> ID：435668
> 
> 赞同：62
> 
> 时间：2009-01-12T15:00:13.263
> 
> 标签：c#, .net, multithreading, threadpool

为简单的线程池实现寻找一些示例代码（C#）。

我在 codeproject 上找到了一个，但代码库非常庞大，我不需要所有这些功能。

无论如何，这更多是出于教育目的。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-01-12T18:55:27.983

这是我能想到的用于教育目的的最简单、幼稚的线程池实现（C# / .NET 3.5）。它没有以任何方式使用 .NET 的线程池实现。

```
using System;
using System.Collections.Generic;
using System.Threading;

namespace SimpleThreadPool
{
    public sealed class Pool : IDisposable
    {
        public Pool(int size)
        {
            this._workers = new LinkedList<Thread>();
            for (var i = 0; i < size; ++i)
            {
                var worker = new Thread(this.Worker) { Name = string.Concat("Worker ", i) };
                worker.Start();
                this._workers.AddLast(worker);
            }
        }

        public void Dispose()
        {
            var waitForThreads = false;
            lock (this._tasks)
            {
                if (!this._disposed)
                {
                    GC.SuppressFinalize(this);

                    this._disallowAdd = true; // wait for all tasks to finish processing while not allowing any more new tasks
                    while (this._tasks.Count > 0)
                    {
                        Monitor.Wait(this._tasks);
                    }

                    this._disposed = true;
                    Monitor.PulseAll(this._tasks); // wake all workers (none of them will be active at this point; disposed flag will cause then to finish so that we can join them)
                    waitForThreads = true;
                }
            }
            if (waitForThreads)
            {
                foreach (var worker in this._workers)
                {
                    worker.Join();
                }
            }
        }

        public void QueueTask(Action task)
        {
            lock (this._tasks)
            {
                if (this._disallowAdd) { throw new InvalidOperationException("This Pool instance is in the process of being disposed, can't add anymore"); }
                if (this._disposed) { throw new ObjectDisposedException("This Pool instance has already been disposed"); }
                this._tasks.AddLast(task);
                Monitor.PulseAll(this._tasks); // pulse because tasks count changed
            }
        }

        private void Worker()
        {
            Action task = null;
            while (true) // loop until threadpool is disposed
            {
                lock (this._tasks) // finding a task needs to be atomic
                {
                    while (true) // wait for our turn in _workers queue and an available task
                    {
                        if (this._disposed)
                        {
                            return;
                        }
                        if (null != this._workers.First && object.ReferenceEquals(Thread.CurrentThread, this._workers.First.Value) && this._tasks.Count > 0) // we can only claim a task if its our turn (this worker thread is the first entry in _worker queue) and there is a task available
                        {
                            task = this._tasks.First.Value;
                            this._tasks.RemoveFirst();
                            this._workers.RemoveFirst();
                            Monitor.PulseAll(this._tasks); // pulse because current (First) worker changed (so that next available sleeping worker will pick up its task)
                            break; // we found a task to process, break out from the above 'while (true)' loop
                        }
                        Monitor.Wait(this._tasks); // go to sleep, either not our turn or no task to process
                    }
                }

                task(); // process the found task
                lock(this._tasks)
                {
                    this._workers.AddLast(Thread.CurrentThread);
                }
                task = null;
            }
        }

        private readonly LinkedList<Thread> _workers; // queue of worker threads ready to process actions
        private readonly LinkedList<Action> _tasks = new LinkedList<Action>(); // actions to be processed by worker threads
        private bool _disallowAdd; // set to true when disposing queue but there are still tasks pending
        private bool _disposed; // set to true when disposing queue and no more tasks are pending
    }

    public static class Program
    {
        static void Main()
        {
            using (var pool = new Pool(5))
            {
                var random = new Random();
                Action<int> randomizer = (index =>
                {
                    Console.WriteLine("{0}: Working on index {1}", Thread.CurrentThread.Name, index);
                    Thread.Sleep(random.Next(20, 400));
                    Console.WriteLine("{0}: Ending {1}", Thread.CurrentThread.Name, index);
                });

                for (var i = 0; i < 40; ++i)
                {
                    var i1 = i;
                    pool.QueueTask(() => randomizer(i1));
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-01-12T15:07:26.353

无需自己实现，因为使用现有的 .NET 实现并不难。

从[线程池文档](https://docs.microsoft.com/en-us/dotnet/api/system.threading.threadpool.queueuserworkitem?view=netframework-4.8#System_Threading_ThreadPool_QueueUserWorkItem_System_Threading_WaitCallback_System_Object_)：

```
using System;
using System.Threading;

public class Fibonacci
{
    public Fibonacci(int n, ManualResetEvent doneEvent)
    {
        _n = n;
        _doneEvent = doneEvent;
    }

    // Wrapper method for use with thread pool.
    public void ThreadPoolCallback(Object threadContext)
    {
        int threadIndex = (int)threadContext;
        Console.WriteLine("thread {0} started...", threadIndex);
        _fibOfN = Calculate(_n);
        Console.WriteLine("thread {0} result calculated...", threadIndex);
        _doneEvent.Set();
    }

    // Recursive method that calculates the Nth Fibonacci number.
    public int Calculate(int n)
    {
        if (n <= 1)
        {
            return n;
        }

        return Calculate(n - 1) + Calculate(n - 2);
    }

    public int N { get { return _n; } }
    private int _n;

    public int FibOfN { get { return _fibOfN; } }
    private int _fibOfN;

    private ManualResetEvent _doneEvent;
}

public class ThreadPoolExample
{
    static void Main()
    {
        const int FibonacciCalculations = 10;

        // One event is used for each Fibonacci object
        ManualResetEvent[] doneEvents = new ManualResetEvent[FibonacciCalculations];
        Fibonacci[] fibArray = new Fibonacci[FibonacciCalculations];
        Random r = new Random();

        // Configure and launch threads using ThreadPool:
        Console.WriteLine("launching {0} tasks...", FibonacciCalculations);
        for (int i = 0; i < FibonacciCalculations; i++)
        {
            doneEvents[i] = new ManualResetEvent(false);
            Fibonacci f = new Fibonacci(r.Next(20,40), doneEvents[i]);
            fibArray[i] = f;
            ThreadPool.QueueUserWorkItem(f.ThreadPoolCallback, i);
        }

        // Wait for all threads in pool to calculation...
        WaitHandle.WaitAll(doneEvents);
        Console.WriteLine("All calculations are complete.");

        // Display the results...
        for (int i= 0; i<FibonacciCalculations; i++)
        {
            Fibonacci f = fibArray[i];
            Console.WriteLine("Fibonacci({0}) = {1}", f.N, f.FibOfN);
        }
    }
} 
```

# c# - 如何将数据添加到新形成的列

> ID：435676
> 
> 赞同：0
> 
> 时间：2009-01-12T15:03:29.700
> 
> 标签：c#, .net, asp.net

我正在尝试将数据添加到新创建的列...

```
DataSet ds = new DataSet;
ds.Tables[0].Columns.Add("Count");
Data.DataSource = ds;
Data.DataBind(); 
```

我在哪里添加硬编码计数？（我希望计数列有'4'）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T15:06:46.870

您将数据添加到行 - 所以：

```
 DataSet ds = new DataSet();
    DataTable table = ds.Tables.Add();
    table.Columns.Add("Count", typeof(int));
    table.Rows.Add(4); 
```

但是，可能有更简单的选择；a绑定单个值`DataSet`似乎过于**矫枉过正。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T15:08:32.047

从技术上讲，它是一个中继器功能，但如果我获得硬编码功能......我可以制作代码以使其灵活。我让它工作。我正在向现有表中添加一列。这就是我所做的...

```
for int i=0; i<ds.tables[0].Rows.Count; i++)
{
    ds.tables[0].Rows[i]["Count"] = "4";
} 
```

# ruby-on-rails - Rails Single Table Inheritance - 显式设置类型的最佳方法是什么？

> ID：435678
> 
> 赞同：10
> 
> 时间：2009-01-12T15:03:40.293
> 
> 标签：ruby-on-rails

我在我的 rails 应用程序中使用[单表继承](http://api.rubyonrails.org/classes/ActiveRecord/Inheritance.html)，并且想要显式设置实例的类型。

我有以下内容；

```
class Event < ActiveRecord::Base
class SpecialEvent < Event 
```

这是通过单表继承实现的。

`SpecialEvent.new`按预期工作，但我希望能够做类似的事情

```
Event.new(:type => 'SpecialEvent') 
```

所以我可以在应用程序中轻松创建不同的 sub_types。

但是，这不起作用，似乎设置`:type`为`nil`，而不是我设置的值；我怀疑这是因为调用`Event.new`它会覆盖`:type`参数。

有没有人有这样做的好方法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-12T15:25:38.127

如果您尝试动态实例化子类型，并且类型为字符串，则可以执行以下操作：

```
'SpecialEvent'.constantize.new() 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-10-01T13:28:02.713

来自“Pragmatic - Agile Web Development with rails 3rd edition”，第 380 页

> 还有一个不太明显的约束（使用 STI）。属性类型也是 Ruby 内置方法的名称，因此直接访问它来设置或更改行的类型可能会导致奇怪的 Ruby 消息。相反，通过创建适当类的对象来隐式访问它，或者通过模型对象的索引接口访问它，使用如下内容：
> 
> person[:type] = '经理'

伙计，这本书真的很震撼

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-12T15:29:27.543

> 不，我想创建子类型的实例，我想以编程方式确定它们是哪个 sub_type – HermanD

您可以使用[工厂模式](http://en.wikipedia.org/wiki/Factory_method_pattern "维基百科")，尽管我最近听说人们不赞成过度使用这种模式。基本上，使用工厂来创建您想要获得的实际类型

```
class EventFactory
  def EventFactory.create_event(event_type)
    event_type.constantize.new()
  end
end 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-04-04T18:38:25.947

对我来说，听起来你需要一些魔力`event#create`：

```
type = params[:event].delete(:type)

# check that it is an expected value!!!
die unless ['Event', 'SpecialEvent'].include(type)

type.constantize.new(params[:event]) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T19:51:56.170

显然，Rails 不允许您直接设置 Type。这就是我要做的...

```
klass_name = 'Foo'
...
klass = Class.const_get(klass_name)
klass.new # Foo.new 
```

我相信 .constantize 是 Rails 变形器的捷径。const_get 是类和模块上的 Ruby 方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-16T15:03:07.520

首先，我同意 STI 通常不是处理事情的最佳方式。多态，是的，但使用多态关联通常比使用 STI 更好。

也就是说，我有一个系统，其中 STI 很重要。这是一个司法系统，像法庭案件这样的事情在它们的类型上非常相似，并且通常具有它们所有的基本属性。但是，民事案件和刑事案件在他们管理的要素上有所不同。这发生在系统中的多个级别，因此抽象了我的解决方案。

[https://github.com/arvanasse/sti_factory](https://github.com/arvanasse/sti_factory)

长话短说，它使用工厂方法来利用上述常用方法。因此，控制器可以保持中立/不知道您正在创建的特定类型的 STI 类。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-05T14:32:33.163

您可以使用 Rails 的[safe_constantize](http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-safe_constantize)方法，该方法将确保对象/类实际存在。

例如：

```
def typeify(string)
  string.classify.safe_constantize
end

new_special_event = typeify('special_event').new 
```

# apache-flex - 应用程序启动序列中的哪个事件适合触发在 AIR/Flex 中加载配置文件？

> ID：435680
> 
> 赞同：4
> 
> 时间：2009-01-12T15:04:06.860
> 
> 标签：apache-flex, configuration, air, initialization

我正在开发一个小型 AIR 桌面应用程序，我想将一些配置信息存储在一个小文件中，该文件在应用程序启动时加载，并将用于设置根应用程序对象的公共属性。这应该就像我在主 MXML 文件开头的 <mx:Script> 块中声明了公共变量一样工作。

我似乎可以选择三个可用于启动加载配置文件的事件：

*   调用
*   初始化
*   创建完成

我是不是又忽略了一些？哪一个是合适的，为什么？这有关系吗？

我想到的示例问题是：

*   是否所有组件都已可访问，或者我会获得 NULL 引用？
*   我的某些设置会在活动之后的某个阶段被覆盖吗？

可能还有更多。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T17:21:43.790

如果您的处理程序需要直接访问 UI 组件，您应该等待`creationComplete`；否则你会得到 NULL 引用。

如果您只是想在根`Application`对象上设置属性，`initialize`似乎是最好的地方。如果您等到`creationComplete`，并且您设置的属性绑定到您的控件，那么您可能会在更新这些组件时获得运行时调整大小或闪烁。

# cocoa - 如何让透明的 NSView 子类处理鼠标事件？

> ID：435685
> 
> 赞同：12
> 
> 时间：2009-01-12T15:05:28.370
> 
> 标签：cocoa

### 问题

我有一个透明`NSView`就透明`NSWindow`。视图的`drawRect:`方法在视图上绘制了一些内容（`NSImage`s、`NSBezierPath`s 和`NSString`s），但部分内容是透明的。

单击已绘制的视图区域会调用通常的鼠标事件处理方法（`mouseDown:`和`mouseUp:`）。

单击透明区域可以将焦点放在透明窗口后面的任何窗口上。

**我想让部分透明区域可点击**，以便在我的视图上绘制的元素之间意外点击不会导致窗口失去焦点。

* * *

### 已经尝试过的解决方案

*   覆盖`NSView`'`hitTest:`方法。发现`hitTest:`仅在单击视图的非透明区域时调用。
*   覆盖`NSView`'`opaqueAncestor`方法。发现单击视图的任何部分时都没有调用此方法。
*   `[NSColor clearColor]`用该方法填充透明区域的部分`drawRect:`，并用几乎但不是很透明的颜色。这没有效果。
*   在课堂上进行了实验`NSTrackingArea`。这似乎只添加了对`mouseEntered:`、`mouseExited:`、`mouseMoved:`和`cursorUpdate:`方法的支持，而*不是* `mouseUp:`和`mouseDown:`。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-09T16:38:38.377

我有同样的问题。看起来`[window setIgnoresMouseEvents:NO]`会做。

（至少在 Lion 上。见[http://www.cocoabuilder.com/archive/cocoa/306910-lion-breaks-the-ability-to-click-through-transparent-window-areas-when-the-window- is-resizable.html](http://www.cocoabuilder.com/archive/cocoa/306910-lion-breaks-the-ability-to-click-through-transparent-window-areas-when-the-window-is-resizable.html) )

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-12T17:09:21.427

据我所知，窗口透明部分的单击事件根本不会传递给您的应用程序，因此正常的事件链覆盖（即 -hitTest:、-sendEvent: 等）都不起作用。我能想到的唯一方法是使用 Quartz Event Taps 捕获所有鼠标点击，然后手动确定它们是否在窗口的透明区域上。坦率地说，这听起来像是一个巨大的 PITA，但收益并不大。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-23T15:57:51.863

乔治：你提到你尝试用几乎但不太透明的颜色填充部分。在我的测试中，它似乎只有在 alpha 值高于 0.05 时才有效，所以你可能会遇到这样的事情：

```
[[NSColor colorWithCalibratedRed:0.01 green:0.01 blue:0.01 alpha:0.05] set]; 
```

这是一个丑陋的组合，但它可能会很好地避免使用事件水龙头。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T16:11:10.907

您是否尝试过覆盖

```
- (NSView *)hitTest:(NSPoint)aPoint 
```

在你的 NSView 子类中？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-21T07:57:23.830

您可以使用事件监视器来捕获窗口/视图之外的事件。 [https://developer.apple.com/library/mac/documentation/cocoa/conceptual/eventoverview/MonitoringEvents/MonitoringEvents.html](https://developer.apple.com/library/mac/documentation/cocoa/conceptual/eventoverview/MonitoringEvents/MonitoringEvents.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T16:14:27.077

您可以覆盖您的`hitTest`方法，`NSView`以便它始终返回自身。

根据[NSView 文档](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/nsview_Class/Reference/NSView.html#//apple_ref/occ/instm/NSView/hitTest:)，该`hitTest`方法将返回用户单击的 NSView，或者`nil`如果该点不在`NSView`. 在这种情况下，我会调用`[super hitTest:]`，然后仅在结果为其他情况时才返回当前视图`nil`（以防您的自定义视图包含子视图）。

```
- (NSView *)hitTest:(NSPoint)aPoint
{
    NSView * clickedView = [super hitTest:aPoint];
    if (clickedView == nil)
    {
        clickedView = self;
    }

    return clickedView;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-30T17:47:18.627

你可以做：

```
NSView* windowContent = [window contentView];
[windowContent setWantsLayer:YES] 
```

确保背景是透明的：

```
[[windowContent layer] setBackgroundColor:[[NSColor clearColor] CGColor]]; 
```

另一种选择是添加填充 contentView 的透明背景图像。

# mysql - 如何从 mysql 表中选择最新的日期记录集

> ID：435703
> 
> 赞同：25
> 
> 时间：2009-01-12T15:11:08.407
> 
> 标签：mysql, sql, date, greatest-n-per-group

我将各种 rpc 调用的响应存储在 mysql 表中，其中包含以下字段：

```
Table: rpc_responses

timestamp   (date)
method      (varchar)
id          (varchar)
response    (mediumtext)

PRIMARY KEY(timestamp,method,id) 
```

`method`为和的所有现有组合选择最新响应的最佳方法是什么`id`？

*   对于给定的方法/ID，每个日期只能有一个响应。

*   对于给定日期，并非所有呼叫组合都必须存在。

*   有数十种方法，数千个 id 和至少 365 个不同的日期

样本数据：

```
timestamp  method  id response
2009-01-10 getThud 16 "....."
2009-01-10 getFoo  12 "....."
2009-01-10 getBar  12 "....."
2009-01-11 getFoo  12 "....."
2009-01-11 getBar  16 "....." 
```

期望的结果：

```
2009-01-10 getThud 16 "....."
2009-01-10 getBar 12 "....."
2009-01-11 getFoo 12 "....."
2009-01-11 getBar 16 "....." 
```

（我不认为[这](https://stackoverflow.com/questions/189213/sql-selecting-rows-by-most-recent-date)是同一个问题 - 它不会给我最新的`response`）

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-27T16:11:23.303

> 该解决方案最近已更新。
> 以下评论可能已过时

这个可以查询可能执行得很好，因为没有连接。

```
SELECT * FROM (
    SELECT *,if(@last_method=method,0,1) as new_method_group,@last_method:=method 
    FROM rpc_responses 
    ORDER BY method,timestamp DESC
) as t1
WHERE new_method_group=1; 
```

鉴于您希望每个`method`此解决方案的一个结果行应该工作，使用 mysql 变量来避免 JOIN。

仅供参考，PostgreSQL 有一种内置于语言中的方法：

```
SELECT DISTINCT ON (method) timestamp, method, id, response
FROM rpc_responses
WHERE 1 # some where clause here
ORDER BY method, timestamp DESC 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-12T15:12:37.747

自我回答，但我不确定随着表格的增长，这将是一个足够有效的解决方案：

```
SELECT timestamp,method,id,response FROM rpc_responses 
INNER JOIN
(SELECT max(timestamp),method,id FROM rpc_responses GROUP BY method,id) latest
USING (timestamp,method,id); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-07-06T11:05:27.743

试试这个...

```
SELECT o1.id, o1.timestamp, o1.method, o1.response   
FROM rpc_responses o1
WHERE o1.timestamp = ( SELECT max(o2.timestamp)
                       FROM rpc_responses o2
                       WHERE o1.id = o2.id )
ORDER BY o1.timestamp, o1.method, o1.response 
```

...它甚至可以在 Access 中使用！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-26T16:40:01.663

当数据集变大时，子查询非常费力。

试试这个：

```
SELECT t1.* 
FROM rpc_responses AS t1 
INNER JOIN rpc_responses AS t2 
GROUP BY t1.method, t1.id, t1.timestamp
HAVING t1.timestamp=MAX(t2.timestamp)    
ORDER BY t1.timestamp, t1.method, t1.response; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-03T13:32:33.893

我用这个，为我工作

```
select max(timestamp),method,id from tables where 1 group by method,id order by timestamp desc 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-12T15:22:37.180

“最近”的概念相当模糊。如果您的意思是最近的 100 行，那么您可以在子句中添加`TOP(100)`一个`SELECT`。

如果您的意思是基于最近日期的“最近”，那么您可以这样做

```
SELECT timestamp,method,id,response 
FROM rpc_responses
HAVING max(timestamp) = timestamp 
```

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2010-06-06T09:25:05.457

...超过一年后，但我可能会帮助某人选择从最新开始的所有查询

```
SELECT *
FROM rpc_responses
ORDER BY timestamp DESC 
```

# php - 为什么是 ” 我使用xampp在本地开发，然后从直接安装程序安装了 PHP。现在在我的一些 PHP 代码中，只有以"<?php" 开头的 PHP 代码被正确解析。任何以 问问题 Stephane Grenier 问问题 2009-01-12T15:11:44.317 3325 次 This question shows research effort; it is useful and clear 6 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我使用xampp在本地开发，然后从直接安装程序安装了 PHP。现在在我的一些 PHP 代码中，只有以"<?php" 开头的 PHP 代码被正确解析。任何以 " <?" 或 " <?=" 开头的内容都被完全忽略并保持原样。 如何调整配置以解析任一令牌？ 这是一个名为的 php.ini 设置 short_open_tag = 1 # (enabled) phpxampp 4 6 回答 6 This answer is useful 23 这是一个名为的 php.ini 设置 short_open_tag = 1 # (enabled) 于 2009-01-12T15:13:03.487 回答 This answer is useful 20 我建议您禁用short_open_tag并仅使用<?php. 启用后short_open_tag，它会与XML 处理指令 <?xml发生冲突，因为 PHP 打开标记和 XML PI 都以<?. 于 2009-01-12T15:22:25.653 回答 This answer is useful 3 仅使用<? 作为 start 预处理器启动，您可以将预处理器与格式良好的 XML 文档混淆。XML 代表<? 对于processing-instruction，想象一个需要 XSLT 处理的嵌入 XML 的 XHTML 文档......预处理器会与样式表处理指令混淆并抛出错误。 强烈建议使用<?php处理器起始标签，尝试在 php.ini 中使用 short_open_tag = Off。<?php ini_set('short_open_tag', 'On'); >此外，如果遇到问题，您可以尝试使用。 于 2009-01-12T15:45:05.280 回答 This answer is useful 2 您可以在 php.ini 中设置 short_open_tag = On 于 2009-01-12T15:14:33.687 回答 This answer is useful 1 这是一个配置选项，更多信息请访问：http : //www.php.net/ini.core（查找 short_open_tag）。 于 2009-01-12T15:15:19.473 回答 This answer is useful 0 对于较新的版本： short_open_tag = On 于 2013-02-01T20:43:42.397 回答 Related 2 c# - 如何在 Remoting 中使用 singleton 和 singleCall 1 php - preg_match_all 从文本中提取 1 terminal - SSH 进入 MAMP 并出现终端错误 1 sql - 将两组十列重新排列成两列 1 jquery - jQuery 长度函数在复选框字段中无法正常工作 1 java - 如何在一个面板中加载图像和菜单？ 1 windows-phone-7 - 创建 Windows Phone 图片库 1 .htaccess - 禁止某些机器人使用 htaccess 访问某些目录 2 java - 为什么我不能让注射起作用？ 1 android - Android twoWayGridView onItemClickListenter 不起作用 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：435705
> 
> 赞同：6
> 
> 时间：
> 
> 标签：php, xampp

我使用[xampp](http://www.apachefriends.org/en/xampp.html)在本地开发，然后从直接安装程序安装了 PHP。现在在我的一些 PHP 代码中，只有以`"<?php`" 开头的 PHP 代码被正确解析。任何以 " `<?`" 或 " `<?=`" 开头的内容都被完全忽略并保持原样。

如何调整配置以解析任一令牌？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-12T15:13:03.487

这是一个名为的 php.ini 设置

```
short_open_tag = 1 # (enabled) 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-12T15:22:25.653

我建议您禁用[`short_open_tag`](http://www.php.net/manual/en/ini.core.php#ini.short-open-tag)并仅使用`<?php`. 启用后`short_open_tag`，它会与[XML 处理指令](http://www.w3.org/TR/REC-xml/#sec-pi) `<?xml`发生冲突，因为 PHP 打开标记和 XML PI 都以`<?`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T15:45:05.280

仅使用**<?** 作为 start 预处理器启动，您可以将预处理器与格式良好的 XML 文档混淆。XML 代表**<?** 对于*processing-instruction*，想象一个需要 XSLT 处理的嵌入 XML 的 XHTML 文档......预处理器会与样式表处理指令混淆并抛出错误。

强烈建议使用**<?php**处理器起始标签，尝试在 php.ini 中使用 short_open_tag = Off。`<?php ini_set('short_open_tag', 'On'); >`此外，如果遇到问题，您可以尝试使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T15:14:33.687

您可以在 php.ini 中设置 short_open_tag = On

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T15:15:19.473

这是一个配置选项，更多信息请访问：[http](http://www.php.net/ini.core) : //www.php.net/ini.core（查找 short_open_tag）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-01T20:43:42.397

对于较新的版本：

```
short_open_tag = On 
```

# unit-testing - 单元测试 IoC 注册？

> ID：435706
> 
> 赞同：7
> 
> 时间：2009-01-12T15:11:48.607
> 
> 标签：unit-testing, inversion-of-control, ioc-container

您是否应该对将组件注册到 IoC 容器中的代码进行单元测试？

如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T15:24:46.717

在我的测试项目中运行 IoC 容器对我来说感觉有点不对劲。我还注意到，大多数由未解决的依赖关系引起的错误都是由解决依赖关系的顺序引起的，这很难正确测试，也不是我想做的单元测试。

通常我在类的初始化例程中使用 Debug.Assert 语句。这为我提供了一个针对 IoC 相关错误的预警系统，还有助于在我的代码中更好地指定依赖关系。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T15:38:50.867

我对[Guice](http://code.google.com/p/google-guice/) IoC 容器所做的是，首先我使用没有 Guice 的 TDD 为某些功能生成类（这些是单元测试）。然后我使用 Guice 为该功能创建了一个集成测试。此时 IoC 配置（Guice 模块）不完整，因此集成测试将失败。使用 TDD，我逐步添加 IoC 配置，直到集成测试通过。除非需要通过测试，否则我不会添加任何 @Inject 注释、配置行或范围声明。因此，我将进行集成（或验收）测试，以确保 IoC 配置正确且完整。

同样的方法应该适用于任何 IoC 容器或其他系统，它们的配置非常复杂以至于可能会崩溃——除非需要通过测试，否则不要编写任何配置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T15:40:40.187

在 spring 中，您可以进行单元测试，只需加载应用程序上下文而不断言任何内容。这实际上是一个与自动构建相结合的相当有用的测试，因为 spring 在加载完整上下文时会抱怨很多问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T04:21:01.100

@aku、@krosenvold 和 @mookid 为测试依赖项的配置是否正确提供了令人信服的论据。
我不认为这是*单元*测试。
你在测试什么？您不是在尝试对容器本身进行单元测试（可能不是您编写或维护的代码）。
您要测试的是可以创建特定类型的所有依赖项并且可以解析该类型。这听起来像是在您的持续集成环境中进行的非常有用的系统测试或集成测试。
因此，一旦您拥有通过单元测试的二进制文件，您就可以创建容器并在镜像生产环境的机器上运行容器的设置，并测试容器应该能够解析的每种类型是否都可以实际创建并且它们的所有依赖项都可以实例化。
最好在您已应用最新安装程序的新 VM 中运行它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T16:57:46.223

[专门针对温莎城堡](http://www.castleproject.org/container/index.html)回答这个问题：

[Castle Windsor：如何测试所有注册的组件都是可解析的？](https://stackoverflow.com/questions/731616/castle-windsor-how-to-test-that-all-registered-components-are-resolvable)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T04:27:24.190

它很有用，因为一些依赖注入框架（如 Unity）在选择调用哪个构造函数时有奇怪的规则。我肯定会推荐单元测试，以确保您的类型的注册和创建成功发生。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T10:49:21.663

我在一个 ASP.NET MVC 项目中使用 Windsor，我在其中编写了一个简单的测试来验证所有控制器都可以被实例化（即它们的依赖关系可以被解析）。

我对网站的每个配置（例如“开发”、“测试”、“someProductionSite”等）进行了测试，在其中创建具有该特定配置的 Windsor 容器并循环遍历 IController 的所有非抽象实现，检查我可以解决每个实例。

由于控制器工厂是应用程序的唯一入口点，它会生成一个 container.Resolve(...)，所以我 100% 确定所有配置都是有效的。

一般来说，我发现编写作为关于整个系统的断言的测试是非常有用和有价值的。

例如，我还断言所有控制器操作都是虚拟的，这是一个要求，因为我正在使用 Castle 的自动事务管理将控制器操作与事务包围起来。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-12T15:19:39.730

由于您的组件可能有自己的依赖关系或执行一些初始化，我将使用 UT 来介绍这种情况。

就像是

```
iocContainer.Register(typeof(MyService1));
service = iocContainer.Get(typeof(MyService));
Debug.AssertNotNull(service); 
```

# gcc - CMake 中的任何方式都需要 GCC 版本 4+？

> ID：435708
> 
> 赞同：7
> 
> 时间：2009-01-12T15:12:14.113
> 
> 标签：gcc, cmake

我正在使用 GCC v4+ 中提供的一些功能，并希望 CMake 找到 GCC v4 编译器，如果找不到，则返回一个错误，说明需要 GCC v4。

有人对如何做这样的事情有任何模块/想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-12T15:38:28.490

使用 try_compile() 命令并尝试编译以下程序

```
#if __GNUC__ != 4
#error
#endif
int main() { return 0; } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-07-04T11:11:17.367

实现 gcc 版本检查的完全不同（不一定更好）的方法是：

```
if(CMAKE_COMPILER_IS_GNUCXX)
  exec_program(
      ${CMAKE_CXX_COMPILER}
      ARGS                    --version
      OUTPUT_VARIABLE _compiler_output)
  string(REGEX REPLACE ".* ([0-9]\\.[0-9]\\.[0-9]) .*" "\\1"
         gcc_compiler_version ${_compiler_output})
  message(STATUS "C++ compiler version: ${gcc_compiler_version} [${CMAKE_CXX_COMPILER}]")

  if(gcc_compiler_version MATCHES "4\\.[0-9]\\.[0-9]")
    message(FATAL_ERROR "foobar")
    ...

  if(gcc_compiler_version VERSION_GREATER "4.5.99")
  ...
... 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-21T13:13:52.803

cmake 本身可能很快就会有解决方案，参见。[http://cmake.3232098.n2.nabble.com/GCC-compiler-version-td7185771.html](http://cmake.3232098.n2.nabble.com/GCC-compiler-version-td7185771.html)

cmake 的未来版本可能包含两个变量：**CMAKE_C_COMPILER_VERSION**和**CMAKE_CXX_COMPILER_VERSION**。

哈拉斯，我还没有在 2.8.8 更新日志中看到它们。

我现在使用@cmaker 解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-27T14:35:21.853

还有工具链文件，[在 vtk wiki 上提到过](http://www.vtk.org/Wiki/CMake_Cross_Compiling#The_toolchain_file)。这使您可以指定自定义工具链。它通常用于交叉编译，但我以前用它来让其他工具链工作。

# azure - 如果我将 Web 应用程序部署到 Windows Azure，是否需要传统主机？

> ID：435714
> 
> 赞同：2
> 
> 时间：2009-01-12T15:14:22.190
> 
> 标签：azure, deployment, azure-web-app-service

我刚开始阅读有关这项新技术的信息...

有人对此有所了解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T15:18:12.073

[http://www.microsoft.com/azure/howdoesitwork.mspx](http://www.microsoft.com/azure/howdoesitwork.mspx)

> Windows Azure 是一个云服务操作系统，用作 Azure 服务平台的开发、服务托管和服务管理环境。Windows Azure 为开发人员提供按需计算和存储，以通过 Microsoft 数据中心在 Internet 上托管和管理 Web 应用程序。

因此，总而言之，如果您使用 Microsoft 的 Azure，则不需要传统的 Web 主机。另请注意，它仍然仅在社区技术预览中，恕我直言，您现在不应该考虑它。

# php - 如何在 Mac 上开始使用 Apache、MySQL 和（PHP、Perl、Python）？

> ID：435718
> 
> 赞同：2
> 
> 时间：2009-01-12T15:15:48.413
> 
> 标签：php, mysql, perl, apache, macos

对于设置 MAMP 开发堆栈，您有什么建议？

我在[http://www.mamp.info](http://www.mamp.info)看到了快速入门的东西，但我不太喜欢这种方法。我宁愿拥有一个成熟的 Apache，我可以在其中安装任意数量的模块。我记得在 OS X v10.5 (Leopard) Server 演示中看到了一个非常漂亮的 GUI，它允许您设置所有这些东西、添加虚拟主机等，我想知道是否有类似的东西可用于非服务器豹。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T15:33:37.753

您可以使用[Darwin Ports](http://darwinports.com/)或[Fink](http://www.finkproject.org/)从头开始​​安装所有内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T19:09:00.377

OS X 已经带有 Apache、PHP、Perl 和 Python。只需安装 MySQL 并根据需要编辑 Apache 配置文件，你就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-01T20:35:18.593

避免大量使用[MacPorts](http://en.wikipedia.org/wiki/MacPorts)。这是一个糟糕的基于源的发行版。Avalanche 重建，不必要的默认依赖项（xorg for imagemagick）。尽可能使用二进制。

# .net - ASP.Net 表单身份验证 10 分钟后注销用户

> ID：435719
> 
> 赞同：6
> 
> 时间：2009-01-12T15:15:54.277
> 
> 标签：.net, asp.net, cookies, web-config, forms-authentication

我遇到了一个非常糟糕的问题，无论我尝试什么，用户都会在 10 分钟后被注销。

我正在使用在 Server 2003 R2 Standard Edition 上的 IIS 6.0 上运行的 ASP.Net 2.0，作为具有所有适用更新和 .Net 3.5 SP1 的虚拟服务器运行。

客户端是 Internet Explorer 7.0

以下是 web.config 设置：

```
<!-- Authentication Mode -->
<authentication mode="Forms">
  <forms name=".RecipeViewer" timeout="240" />
</authentication> 
```

以下是用于设置授权 cookie 的代码：

```
Private Sub SetCookie(userName)
                ' Use security system to set the UserID within a client-side Cookie
                Dim ticket As New FormsAuthenticationTicket(1,userName, DateTime.Now, DateTime.Now.Add(Me.GetFormsAuthSettings.Forms.Timeout), True, String.Empty, FormsAuthentication.FormsCookiePath)
                Dim hash As String = FormsAuthentication.Encrypt(ticket)
                Dim cookie As New HttpCookie(FormsAuthentication.FormsCookieName, hash)

                cookie.HttpOnly = True

                If (ticket.IsPersistent) Then
                    cookie.Expires = ticket.Expiration
                End If

                Response.Cookies.Add(cookie)

                ' Redirect browser back to originating page
                Response.Redirect(Request.ApplicationPath)
End Sub

    Private Function GetFormsAuthSettings() As System.Web.Configuration.AuthenticationSection
        Return DirectCast(System.Configuration.ConfigurationManager.GetSection("system.web/authentication"), System.Web.Configuration.AuthenticationSection)
    End Function 
```

我以前使用过 FormsAuthentication.SetAuthCookie 甚至尝试过 FormsAuthentication.RedirectFromLoginPage 方法，但是这些方法都具有相同的结果，这就是为什么我最终执行了内部完成的硬 cookie 实现（通过在 Reflector 中查看） FormsAuthentication 类可以。

* * *

该问题在 Visual Studio 2008 asp.net 托管环境或 IIS 7.0 中无法重现**。**

* * *

**编辑**：启用 Cookie，甚至托管站点也已添加为受信任站点。

* * *

**编辑**：谷歌浏览器和火狐没有这个问题。

* * *

**编辑**：目标机器上的已验证 Cookie 根据设置设置为 4 小时后过期（超时 = 240 分钟）。

* * *

**编辑**：正如豪斯所说，每个人都在撒谎。用户实际上并没有测试新的代码库，而是基于一个先入为主的想法，即该软件仍然存在问题。感谢所有在此主题中回复的人。

不要关闭它不再相关，而是保留它以帮助人们解决问题，因为这个问题中有一些非常好的故障排除技术。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T16:46:37.653

也可能（已经）没有设置机器密钥，因此每次初始化应用程序时都会随机生成（这意味着加密的身份验证票证将用新密钥加盐）。

我使用一个站点为我的应用程序生成一个新的机器密钥并将其粘贴在 web.config 中：

[http://www.orcsweb.com/articles/aspnetmachinekey.aspx](http://www.orcsweb.com/articles/aspnetmachinekey.aspx)

```
<?xml version="1.0"?>

<configuration>

    <appSettings/>
    <connectionStrings/>
    <system.web>

        <machineKey validationKey='FED01BCB246D3477F5854D60388A701508AD1DF9099BD3CAC3CA4DAF55F7524B8DD3FA03133BBCA381BC1CD639730445968DFA633A97911187EF187456D692F4' decryptionKey='861E7DF7C2D04297EEFAD47FF3B95F54E87CF28D6C2753D8' validation='SHA1'/>

    </system.web>
</configuration> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T15:42:44.037

虽然您的要求是 IE，但您可以使用带有 Firebug 和 FireCookie 的 Firefox 来监控您的 cookie 和过期时间。

在 IE 中，您可以下载 IE 开发人员工具栏，在其中您可以使用缓存\查看 Cookie 信息菜单查看您的 cookie 值。

如果它在 Google Chrome 中正常工作很奇怪，也许您可​​以使用 global.asax 中的 Application_BeginRequest 事件捕获请求并记录收到的 cookie 及其值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T16:00:21.927

未处理的异常可能会导致 proc 重新启动。这可能会增加奇怪的行为。事件日志中是否有任何报告？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T15:24:42.013

我隐约记得 IIS 会话超时设置能够覆盖您在 web.config 中设置的任何内容。检查您的应用程序属性未设置 10 分钟的超时（属性-> 配置-> 选项）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T15:34:56.767

过去我也遇到过类似的问题，但我不确定你在说什么。您的问题不会发生在生产系统（或任何频繁负载的系统）上，我说得对吗？如果是这样，问题可能是工作线程空闲超时。您可以尝试更改它或在 IIS 管理器下将其关闭 -> 右键单击​​应用程序池，转到性能选项卡，它是空闲超时下的复选框。该对话框的回收选项卡上的内容也可能对您感兴趣。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T16:30:32.317

客户没有测试生产代码，并且在将补丁应用到他们的生产环境之前仍然响应上一个问题。

如果您无法在同一环境中复制它，我建议您召开一次会议，在那里您可以观看他们复制问题。

* * *

48 小时后将此标记为答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-11T08:38:42.930

将会话状态更改为使用 InProc 存储，您可能会面临与我的问题类似的问题，即当用户遇到错误时，每次不使用 InProc 存储会话时，会话基本上都会死掉。

会话类型： http: [//msdn.microsoft.com/en-us/library/ms178586 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms178586(v=vs.100).aspx)

# language-agnostic - 在哪里拆分目录分组？自动对焦 | GK | LP

> ID：435721
> 
> 赞同：4
> 
> 时间：2009-01-12T15:16:16.087
> 
> 标签：language-agnostic, user-interface, grouping, widget

我正在寻找构建一个“快速链接”目录访问小部件。例如（选项 1）

```
0-9 | A-F | G-K | L-P | Q-U | V-Z 
```

其中每个都是指向以该字符开头的目录子块的链接。小部件本身将在多个地方用于查找联系人、公司、项目等。

现在，对于编程部分......我想知道我是否应该像上面那样拆分......

```
0-9 | A-F | G-K | L-P | Q-U | V-Z
10+   6      5     5     5     5 
```

这种拆分相当均匀且在逻辑上分组，但我有兴趣知道是否存在基于以每个字母开头的典型结果数量的更优化拆分。（选项 2）

例如，很少有项目会以“Q”开头。

*（注意：这目前适用于“北美/英语”部署。）*

有没有人有任何统计数据可以支持以不同方式拆分的理由？

同样，对于可用性，用户如何喜欢/不喜欢这种类型的东西？我在心理上知道我是否正在寻找说：“S”我需要一秒钟才能回忆起它属于 QU 部分。

做一个这样的大清单会更好吗？（选项 3）

```
#|A|B|C|D|E|F|G|H|I|J|K|L|M|N|O|P|Q|R|S|T|U|V|W|X|Y|Z 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T15:48:55.740

我建议每个字母**一个链接**并**隐藏**没有任何结果的字母（如果这不需要太多的处理能力）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T15:22:22.847

作为用户，我绝对希望每个字母一个链接。

但更好的（对于我作为用户而言）将是一个搜索框。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-13T00:31:39.180

我认为你在拆分错误的东西。你不应该平均分割字母，你应该平均分割结果（尽可能）。

如果你想要每页 20 个结果，A 有 28 个，而 BC 有 15 个，你会想要

一种

公元前

等等。

此外，您可能必须考虑为什么要使用字母分块而不是更符合上下文的东西。字母分块的问题是用户必须知道他们要查找的名称，并且该名称必须与您的名称相同。

编辑：我们已经在实验室条件下对此进行了测试，用户以几乎相同的方式按结果定位信息与按字母数量定位信息。

EDIT_2：按字母分块几乎总是测试不佳。想想是否有更好的方法来做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T15:20:02.147

嗯，主要的可用性考虑因素之一是均匀分布的组，因此您当前的想法（0-9、AF 等）会运作良好，或者每个字母的列表。对于用户界面来说，拥有大小不一致的组是绝对不允许的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T15:33:32.200

您可能绝对不想拆分一个数字 - 也就是说，类似于

```
0-4 | 5-B | ... 
```

除此之外，我想说看看你的数据在哪里。编写一个程序来进行二、三、四、五等的分组……看看每个分组最均匀的分割是多少。选择一个看起来最好的。如果您的数据稀疏，那么如果只有 1 或 2 个具有该名称的目录，则每个字母都有一个链接可能会很烦人。

再说一次，这取决于典型用户会寻找什么。我无法从您的描述中分辨出这可能是什么 - 他们只是在导航目录树吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T15:22:43.657

我几乎总是使用最后一个选项，因为它对用户来说更容易导航。如果您有足够的空间放置它，请使用它，如果您的屏幕空间有限，请使用另一个。

# c# - 在 IEnumerable 上查找最后一个

> ID：435729
> 
> 赞同：6
> 
> 时间：2009-01-12T15:20:58.387
> 
> 标签：c#, ienumerable, ilist

我想调用`FindLast`一个实现的集合`IEnumerable`，但`FindLast`仅适用于`List`. 什么是最好的解决方案？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-12T15:41:34.040

相当于：

```
var last = list.FindLast(predicate); 
```

是

```
var last = sequence.Where(predicate).LastOrDefault(); 
```

（后者必须检查序列中的*所有*项目，但是......）

实际上，“Where()”是 Find 部分，“Last()”分别是“FindLast”的 Last 部分。类似地，`FindFirst(predicate)`将映射到`sequence.Where(predicate).FirstOrDefault()`并且`FindAll(predicate)`将是`sequence.Where(predicate)`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T15:46:37.990

使用 LINQ-to-Objects 怎么样：

```
var item = data.LastOrDefault(x=>x.Whatever == "abc"); // etc 
```

如果您只有 C# 2，则可以改用实用方法：

```
using System;
using System.Collections.Generic;
static class Program {
    static void Main() {
        int[] data = { 1, 2, 3, 4, 5, 6 };

        int lastOdd = SequenceUtil.Last<int>(
            data, delegate(int i) { return (i % 2) == 1; });
    }    
}
static class SequenceUtil {
    public static T Last<T>(IEnumerable<T> data, Predicate<T> predicate) {
        T last = default(T);
        foreach (T item in data) {
            if (predicate(item)) last = item;
        }
        return last;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T15:30:07.383

您可以通过将集合传递给 List<> 构造函数来将集合添加到新列表中。

```
List<MyClass> myList = new List<MyClass>(MyCol);
myList.FindLast.... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T15:29:08.900

使用位于命名空间 System.Linq 中的扩展方法 Last()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T17:48:23.580

您的问题无效，因为集合没有最后一个元素。具有完整排序的更专业的集合是列表。没有排序的更专业的集合是字典。

# .net - 在 .net 中分析方法时间的简单方法

> ID：435731
> 
> 赞同：1
> 
> 时间：2009-01-12T15:22:14.733
> 
> 标签：.net, profiler

当我运行应用程序时，有人可以帮我找出如何获取 c# 方法的执行时间。

如果我使用 clr profiler，我可以获得对象分配的详细信息。

但我正在寻找需要很长时间才能执行的方法或代码行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T15:27:54.190

试试 JetBrain 的[dotTrace](http://www.jetbrains.com/profiler/)或[ANTS](http://www.red-gate.com/Products/ants_profiler/index.htm)分析器。

dotTrace 分析器输出的屏幕截图：

[![](https://i.stack.imgur.com/jFMIX.gif)](https://i.stack.imgur.com/jFMIX.gif)
[（来源：[jetbrains.com](http://www.jetbrains.com/profiler/features/screenshots/20/cpuSnapshot.gif)）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T15:32:19.517

如果可以的话，我建议你找一个商业分析器。它们提供了更好的布局信息，以帮助您隔离瓶颈和内存泄漏可能在哪里。查看 Red Gate [ANTS 分析器](http://www.red-gate.com/Products/ants_profiler/index.htm)或 JetBrains [dotTrace](http://www.jetbrains.com/profiler/)。我写了一篇小文章，带你了解如何使用[这里](http://thinkersroom.com/bytes/2007/10/01/profiling-net-applications-i/)

# jquery - 延迟jquery悬停事件？

> ID：435732
> 
> 赞同：94
> 
> 时间：2009-01-12T15:22:21.627
> 
> 标签：jquery, events, mouseevent, settimeout

我想延迟 jquery 中的悬停事件。当用户将鼠标悬停在链接或标签上时，我正在读取文件。如果用户只是在屏幕上移动鼠标，我不希望此事件立即发生。有没有办法延迟事件触发？

谢谢你。

示例代码：

```
$(function() {
    $('#container a').hover(function() {
        $('<div id="fileinfo" />').load('ReadTextFileX.aspx',
            {filename:'file.txt'},
            function() {
                $(this).appendTo('#info');
            }
         );
    },
        function() { $('#info').remove(); }
    });
}); 
```

**更新：** *（09 年 1 月 14 日）* 添加 HoverIntent 插件后，将上述代码更改为以下代码以实现它。实现起来非常简单。

```
$(function() {
    hiConfig = {
        sensitivity: 3, // number = sensitivity threshold (must be 1 or higher)
        interval: 200, // number = milliseconds for onMouseOver polling interval
        timeout: 200, // number = milliseconds delay before onMouseOut
        over: function() {
            $('<div id="fileinfo" />').load('ReadTextFileX.aspx', {filename:'file.txt'},
                function() {
                   $(this).appendTo('#info');
                }
             );
        }, // function = onMouseOver callback (REQUIRED)
        out: function() { $('#info').remove();  } // function = onMouseOut callback (REQUIRED)
    }
    $('#container a').hoverIntent(hiConfig)
} 
```

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-01-12T15:31:16.167

使用 jquery 的 hoverIntent 插件：http: [//cherne.net/brian/resources/jquery.hoverIntent.html](http://cherne.net/brian/resources/jquery.hoverIntent.html)

它绝对适合您所描述的内容，我几乎在每个需要鼠标悬停激活菜单等的项目中都使用过它...

这种方法有一个问题，一些接口没有“悬停”状态，例如。移动浏览器，例如 iphone 上的 safari。您可能隐藏了界面或导航的重要部分，而无法在此类设备上打开它。您可以使用特定于设备的 CSS 来解决这个问题。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-01-12T15:40:28.190

您需要在悬停时检查计时器。如果它不存在（即这是第一次悬停），则创建它。如果它存在（即这*不是*第一次悬停），杀死它并重新启动它。将计时器有效负载设置为您的代码。

```
$(function() {
    var timer;

    $('#container a').hover(function() {
        if(timer) {
            clearTimeout(timer);
            timer = null
        }
        timer = setTimeout(function() {
            $('<div id="fileinfo" />').load('ReadTextFileX.aspx',
                {filename:'file.txt'},
                function() {
                    $(this).appendTo('#info');
                }
            );
        }, 500)
    },
    // mouse out
    });
}); 
```

我敢打赌 jQuery 有一个函数可以为你完成这一切。

*编辑*：啊，是的，[jQuery 插件来拯救](https://stackoverflow.com/questions/435732/delay-jquery-hover-event#435760)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-12-08T14:25:42.770

完全同意 hoverIntent 是最好的解决方案，但如果你碰巧是一个不幸的草皮，他在一个网站上工作，需要一个漫长而漫长的 jQuery 插件审批流程，这里有一个快速而肮脏的解决方案，对我来说效果很好：

```
$('li.contracted').hover(function () {
    var expanding = $(this);
    var timer = window.setTimeout(function () {
        expanding.data('timerid', null);

            ... do stuff

    }, 300);
    //store ID of newly created timer in DOM object
    expanding.data('timerid', timer);
}, function () {
    var timerid = $(this).data('timerid');
    if (timerid != null) {
        //mouse out, didn't timeout. Kill previously started timer
        window.clearTimeout(timerid);
    }
}); 
```

如果鼠标在 <li> 上停留的时间超过 300 毫秒，这仅用于扩展 <li>。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-12T15:32:21.077

您可以在 mouseout 事件上使用带有 clearTimeout() 的 setTimeout() 调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-09T13:32:13.970

在 2016 年，Crescent Fresh 的解决方案对我来说没有按预期工作，所以我想出了这个：

```
$(selector).hover(function() {
    hovered = true;
    setTimeout(function() {
        if(hovered) {
            //do stuff
        }
    }, 300); //you can pass references as 3rd, 4th etc. arguments after the delay

}, function() {
    hovered = false;
}); 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2011-09-02T10:37:23.827

我的解决方案很简单。如果用户在 obj 上保持 mouseenter 超过 300 毫秒，则延迟打开菜单：

```
var sleep = 0;
$('#category li').mouseenter(function() {
    sleep = 1;
    $('#category li').mouseleave(function() {
        sleep = 0;
    });
    var ob = $(this);
    setTimeout(function() {                         
        if(sleep) {
            // [...] Example:
            $('#'+ob.attr('rel')).show();
        }
    }, 300);
}); 
```

# java - 是否有有助于构建命令行应用程序的良好 Java 库？

> ID：435740
> 
> 赞同：42
> 
> 时间：2009-01-12T15:24:51.297
> 
> 标签：java, shell, command-line, interactive

我需要用 Java 编写一个简单的命令行应用程序。使用一个负责解析命令并处理标志和可选/强制参数之类的库会很好......

**更新**

具有内置 TAB 完成功能的东西会特别棒。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-12T15:30:04.547

我使用[Apache Commons CLI 库](http://commons.apache.org/cli/)进行命令行参数解析。它相当容易使用并且有[相当好的文档](http://commons.apache.org/cli/introduction.html)。

您选择哪个库可能取决于您喜欢哪种样式的选项（“--gnu-style”或“-javac-style”）。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-12T16:54:31.177

[JLine](https://github.com/jline/jline3/)看起来很有帮助。

> JLine 是一个用于处理控制台输入的 Java 库。它的功能类似于 BSD editline 和 GNU readline。熟悉现代 shell（例如 bash 和 tcsh）的 readline/editline 功能的人会发现 JLine 的大多数命令编辑功能都很熟悉。

它确实在其[功能](https://github.com/jline/jline3/wiki)中列出了选项卡完成。 

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-06-07T00:52:20.643

当您正在寻找可以简化开发交互式 shell 应用程序的库时，我建议您使用[Cliche](http://code.google.com/p/cliche/)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-12T16:57:19.347

在我们公司，我们使用[JewelCli](http://jewelcli.sourceforge.net/)，它使用带注释的 Java 接口定义来以声明式风格描述命令行接口。

轻巧易用，我会推荐它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-13T05:05:50.843

我已经广泛使用了[Java Simple Argument Parser](http://www.martiansoftware.com/jsap/)。它处理各种选项类型，具有精心设计的库（包括编写自定义解析器的选项），并在 JavaDocs 和[在线](http://www.martiansoftware.com/jsap/doc/).

我认为您对制表符完成的渴望将由 shell 而不是命令行解析库来处理。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-13T04:46:58.180

有一个用于命令行解析[的 GNU getopt 库的 Java 端口。](http://www.urbanophile.com/arenn/hacking/download.html)对于命令编辑和 TAB 完成，有 JLine（正如 mmyers 已经推荐的那样）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-09-09T22:14:12.123

也值得一看[--jopt-simple](http://pholser.github.com/jopt-simple/)。

它“尝试尊重 POSIX getopt() 和 GNU getopt_long() 的命令行选项语法。” 它似乎有一些社区吸引力，特别是作为[OpenJDK](http://openjdk.java.net/)选择的命令行解析库。

此外，正如 Brett 所提到的，制表符补全通常由您的 shell 提供——您将编写 shell 函数来提供所需的功能。

ps 抱歉重复的答案，但这个问题几乎与[用于解析命令行参数的 Java 库相同？](https://stackoverflow.com/questions/1200054/java-library-for-parsing-command-line-parameters/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-02-02T16:14:51.793

我尝试了一些库并最终使用了[argparse4j](http://argparse4j.sourceforge.net)。[这是 Python 的argparse](http://docs.python.org/dev/library/argparse.html)的一个非常好的 Java 端口。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-13T05:10:06.480

我用过[JSAP](http://www.martiansoftware.com/jsap/)。我发现它很稳定并且有据可查。

我不确定我理解您所说的“内置 TAB 完成”是什么意思。能否详细说明。

# apache-flex - Flex/AIR + Catalyst：让他们互相交谈的最佳方式是什么？

> ID：435744
> 
> 赞同：3
> 
> 时间：2009-01-12T15:27:20.697
> 
> 标签：apache-flex, perl, web-services, air, catalyst

让 Adob​​e Flex/AIR 与 perl [Catalyst](http://www.catalystframework.org/)通信的最佳方式是什么？

我们目前在 Catalyst 端使用[Catalyst::Plugin::XMLRPC ，在 Flex/AIR 端使用](http://search.cpan.org/perldoc?Catalyst::Plugin::XMLRPC)[as3-rpclib](http://code.google.com/p/as3-rpclib/)。这很好用，但我宁愿将 as3-rpclib 排除在外，并使用 Flex 原生的方法。

据我所知，它的原生组件是 HTTPService、WebService (SOAP) 和 RemoteObject。

哪一个最适合 Catalyst 环境？

另外，你能指出一个很好的“Hello World”获胜者的例子吗？WSDL 让我头晕目眩。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T16:09:26.387

SOAP 和[Catalyst::Controller::SOAP](http://search.cpan.org/~druoso/Catalyst-Controller-SOAP-1.10/lib/Catalyst/Controller/SOAP.pm)看起来就是您想要的。它基于 XML::Compile::SOAP，这是“好的”。这些文档告诉您如何将 WSDL 制作成您的 Catalyst 应用程序提供的服务。

（如果你想另辟蹊径，可以使用 Catalyst::Model::SOAP，但我认为这不是你想要的。）

如果 JSON 是一个选项，您可能会考虑这样做。它很容易与 Catalyst::Controller::REST 或 Catalyst::View::JSON 一起使用。

# mfc - 映射两个按钮时CDialog未关闭

> ID：435746
> 
> 赞同：1
> 
> 时间：2009-01-12T15:27:49.417
> 
> 标签：mfc, cdialog

Visual Studio 2005、C++、Windows XP。

我有一个带有单个按钮的 CDialog，它调用如下函数：

```
BEGIN_MESSAGE_MAP(Foo, BaseDlg) //BaseDlg继承自CDialog
    ON_BN_CLICKED（IDBAR，酒吧）
END_MESSAGE_MAP()
```

单击“X”时对话框关闭。

我将上面的代码更改为：

```
BEGIN_MESSAGE_MAP(Foo, BaseDlg) //BaseDlg继承自CDialog
    ON_BN_CLICKED（IDBAR，酒吧）
    ON_BN_CLICKED（IDBAZ，巴兹）
END_MESSAGE_MAP()
```

我的对话窗口将不再关闭。每当单击 X 时，都会调用 Baz()。由于某种原因，第二个 ON_BN_CLICKED() 处理程序正在替换正常的对话框关闭行为。

如何关闭具有两个或更多按钮映射到功能的对话框？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T17:32:02.083

资源文件中分配给 IDBAR 和 IDBAZ 的数值是什么？一种可能的解释是 IDBAZ == IDCANCEL，它在 MFC 中默认定义为对话框的取消和 X 按钮的 ID。为这个常量定义你自己的处理程序将覆盖默认行为，即关闭窗口。这只适用于如果您以模态方式显示对话框 - 如果它是非模态的，那么您总是必须通过调用 EndDialog() 自己关闭对话框。

# language-agnostic - 撤消/重做级联删除

> ID：435761
> 
> 赞同：9
> 
> 时间：2009-01-12T15:31:28.473
> 
> 标签：language-agnostic, design-patterns, undo

我正在尝试使用[命令模式](http://en.wikipedia.org/wiki/Command_pattern)在我的应用程序中实现撤消/重做功能。我面临一个问题。

为了说明这一点，让我们假设您可以使用我的应用程序创建 2D 配置文件（任意数量）。

从这些 2D 配置文件中，您可以创建具有不同属性（名称、颜色、比例等）的 3D 零件。

```
+--------------+              +--------------+      +--------------+
| 2D profile A |              | 2D profile B |      | 2D profile C |
+--------------+              +--------------+      +--------------+
   |    |                            |
   |  +---------------+      +---------------+
   |  | 3D Part B     |      | 3D Part C     |
   |  | Colour : blue |      | Colour : grey |
   |  | Name : bibi   |      | Name : foo    |
   |  | Scale : 33%   |      | Scale : 100%  |
   |  +---------------+      +---------------+
+--------------+
| 3D Part A    |
| Colour : red |
| Name : aaa   |
| Scale : 50%  |
+--------------* 
```

当一个配置文件被删除时，在这个配置文件上构建的所有 3D 零件也将被自动删除（当一个配置文件即将被删除时，3D 零件经理会收到通知，并将删除过时的 3D 零件。还会通知视图更新图形用户界面）。

这是我面临问题的地方：我正在编写用于删除 2D 配置文件的撤消/重做命令，它看起来像这样（伪代码）：

```
virtual void redo()
{
    m_pProfileList.remove(m_pProfile); // This will automatically delete all 3D parts relying on the deleted 2D profile
}

virtual void undo()
{
   m_pProfileList.add(m_pProfile); // This will add the 2D profile, but the 3D Parts are lost
} 
```

正如您在上面的代码中看到的，删除 2D 轮廓将自动删除依赖于已删除轮廓的所有 3D 零件。

但是在撤消时，将 2D 配置文件重新添加到列表中是不够的：3D 部分丢失了。

我该怎么办 ？撤消/重做命令是否应该负责删除 3D 零件（这实际上是由 3D 零件管理器完成的）？这意味着撤消/重做命令也将负责通知视图更新 GUI。

还是应该撤消/重做命令创建所有将被删除的 3d 零件的内部副本，并让 3d 零件管理器删除 3D 零件？

还是有其他更好的解决方案？

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T16:28:17.237

您需要对此稍作改动：[Memento 模式](http://en.wikipedia.org/wiki/Memento_pattern)。您可以存储完整对象树的快照，也可以存储每次更改时的所有差异。有了这些连续变化的历史，您就可以通过命令来回前进，让您心满意足，而不会丢失依赖对象。

# javascript - 如何在 Flash 的 ExternalInterface 和 JavaScript 之间传递信息？

> ID：435763
> 
> 赞同：1
> 
> 时间：2009-01-12T15:31:59.457
> 
> 标签：javascript, flash, arguments, externalinterface

如何使用 flash 中的外部接口将三个参数传递给 java 脚本函数并取回输出并在 flash 中显示？

* * *

```
import flash.external.ExternalInterface;
var para:Array = new Array();
send_btn.addEventListener(MouseEvent.CLICK, clickListener);
function clickListener(eventObj:Object ):void {
    para.push(mean.text);
    para.push(std.text);
    para.push(points.text);
    trace("click > " + para);
    var output =ExternalInterface.call("calc",int(para[0]),int(para[1]),int(para[2]) );
out.text = output;
} 
```

这是我用来调用函数 calc 的代码，该函数在 java 脚本中接受三个参数，这是正确的做法吗？如何从 javascript 中获取参数并在 flash 中显示它们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T16:24:36.650

AS3：

```
var percent:int = Math.round(100 * done/total);

// pass 3 arguments to javascript
var result:Object = call("progress", { percent:percent, phase:"building", third:"baggage" });

// display what comes back
label.text = "js returned: " + result.status;
if (result.status == "ack")
    continue;
//....

public function call(func:String, args:Object = null):Object
{
   // check to see if we're in a container
   if (ExternalInterface.available)
      return ExternalInterface.call(func, args);
   else
      return { status:"fail" };
} 
```

javascript:

```
<script>
function progress(info)
{
    if (info.phase == "building")
         $("#status").html("Progress: " + info.percent + "% done building");
    //...
    return { status:"ack" };
}
</script> 
```

# asp.net-mvc - ASP.NET MVC 中的 CSS 和 Javascript 相对路径混淆

> ID：435769
> 
> 赞同：22
> 
> 时间：2009-01-12T15:33:28.690
> 
> 标签：asp.net-mvc

我的 javascript 路径在此页面上工作： [http://localhost:53049/](http://localhost:53049/)

但不在此页面上： [http://localhost:53049/Home/Messages](http://localhost:53049/Home/Messages)

原因是相对路径不同，前者需要("js/...")，后者需要("../../js/...")。

我将我的 JavaScript 包含在我的 Site.Master 文件中：

```
<script type="text/javascript" src="js/jquery.jqGrid.js"></script>
<script type="text/javascript" src="~/js/jquery.jqGrid.js"></script>
<script type="text/javascript" src="<%= this.ResolveClientUrl("~/Scripts/jquery-1.2.6.js") %>"></script> 
```

我如何绕过这种相对路径的疯狂，即 ASP.NET MVC 中在 Site.Master 中设置 CSS/Javascript 路径的最佳实践方式是什么，以便它们适用于每个视图，无论视图的 URL 有多深.

**附录：**

似乎对于 Index 视图，任何路径都可以正常工作，奇怪的是：

```
<script type="text/javascript" src="/Scripts/jquery-1.2.6.js"></script>
<script type="text/javascript" src="../../Scripts/jquery-1.2.6.js"></script>
<script type="text/javascript" src="../../../Scripts/jquery-1.2.6.js"></script> 
```

但是对于任何其他页面（具有更深 URL 的页面），这些都不起作用。

这里发生了什么？我们如何在 Site.Master 中设置一次 Javascript 路径并且它们适用于所有页面？

**附录二：**

原来这只是 jqgrid javascript 文件（不是 jquery 文件）的问题，显然在该文件中它引用了其他 javascript 文件并感到困惑：

```
<script type="text/javascript" src="<%= Url.Content ("~/js/jquery.jqGrid.js") %>"></script> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-12T15:47:46.397

您还可以使用 Url.Content 方法调用来确保正确设置了路径。

可以在[此处](https://stackoverflow.com/questions/371591/jquery-in-an-asp-net-mvc-application-using-master-pages#371603)找到示例。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-29T12:48:12.997

关于 CSS 文档中使用的路径：

**/内容/site.css**

```
Body {background-image:url('background.jpg');} 
```

CSS 文档中的相对路径与 CSS 文档相关，而不是与正在显示的文档相关。

这些信息让我有些头疼。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T15:37:37.697

尝试将 javascript 设置为在开头使用正斜杠，例如“/js/jquery.jqGrid.js”，这会将它们设置为使用根域而不是相对路径。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T21:40:30.320

jqGrid 的解决方案：打开文件 jquery.jqGrid.js 并找到该行：

```
var pathtojsfiles = "js/"; // need to be ajusted 
```

正如评论所说，您需要编辑该路径，例如对于典型的 ASP.NET MVC 应用程序，

```
var pathtojsfiles = "/Scripts/js/"; // need to be ajusted 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-20T12:18:44.163

您需要添加`runat="server"`并指定绝对路径，如下所示：

`<script type="text/javascript" runat="server" src="~/js/jquery.jqGrid.js"></script>]`

# c# - 结束 BeginInvoke 的正确方法？

> ID：435772
> 
> 赞同：13
> 
> 时间：2009-01-12T15:34:03.383
> 
> 标签：c#, lambda

我最近[在 MSDN 上阅读了这个帖子](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/b18b0a27-e2fd-445a-bcb3-22a315cd6f0d/)。所以我正在考虑使用 lambda 表达式作为调用 EndInvoke 的一种方式，以确保一切都很好和整洁。哪个更正确？

示例 1：

```
Action<int> method = DoSomething;

method.BeginInvoke(5, (a)=>{method.EndInvoke(a);}, null); 
```

示例 2：

```
Action<int> method = DoSomething;

method.BeginInvoke(5, (a)=>
                                  {
                                      Action<int> m = a.AsyncState as Action<int>;
                                      m.EndInvoke(a);
                                  }, method); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-02-02T05:13:31.230

我不知道这是否可能早在 09 年 1 月，但现在你当然可以写这个：

```
method.BeginInvoke(5, method.EndInvoke, null); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-12T17:30:25.347

您的第二个示例效率更高一些，因为不必在闭包中捕获“方法”委托实例。我怀疑你会注意到。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-12T15:36:14.907

您可能想在 Haacked 的博客上阅读[此主题。](http://haacked.com/archive/2009/01/09/asynchronous-fire-and-forget-with-lambdas.aspx)还没有机会测试它，但要点在于最后一行：

```
ThreadPool.QueueUserWorkItem(callback => im.Send(to, from, subject, body)); 
```

# terminal - Telnet / 终端命令

> ID：435773
> 
> 赞同：1
> 
> 时间：2009-01-12T15:34:07.360
> 
> 标签：terminal, command, telnet, terminal-emulator

我正在尝试调试的代理远程登录服务器出现问题，似乎正在发送的一组字符导致它出现问题....有人知道我在哪里可以获得终端命令列表（沿着[40m)?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T15:38:18.383

您必须进行 telnet 协商，您检查[过 RFC-1091](http://www.ietf.org/rfc/rfc1091.txt)和[RFC-854](http://www.ietf.org/rfc/rfc854.txt)吗？之后，接受什么当然取决于终端类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T15:40:03.073

对于 telnet 协议，您可以查找[RFC854](http://www.isi.edu/in-notes/rfc854.txt)。但是根据您的描述，您可能正在寻找一些终端仿真器的规格。有许多不同的终端类型，每种都有自己的规格。

# javascript - 动态更改样式表路径在 IE 和 Firefox 中不起作用

> ID：435785
> 
> 赞同：4
> 
> 时间：2009-01-12T15:37:28.633
> 
> 标签：javascript, css, ajax

我有以下文件：

```
<html>
<head>
<title></title>
<link rel="css" type="text/css" href="/empty.css" title="css" />
<script type="text/javascript" src="/Prototype"></script>
<script type="text/javascript">
function load_content()
{
  var d = new Date();
  new Ajax.PeriodicalUpdater('content', '/DOC?'+d.getTime(),
  {
    method: 'post',
    frequency: 5,
    onSuccess: function(transport) {
            for(i=0; (a = document.getElementsByTagName('link')[i]); i++) 
            {
                if(a.getAttribute('rel') == 'css' && a.getAttribute("type") == 'text/css') 
                {
                    a.href = '/CSS?'+d.getTime();
                }

            }
    }
  });

}
</script>

</head>

<body>

<div id="content"></div>

<script type="text/javascript">
    load_content();
</script>

</body>
</html> 
```

注意：忽略 d.getTime() 调用...这些只是为了解决 IE 无法从 AJAX 调用加载新页面的问题，因为它的缓存方案过于激进。

基本上，当它在 /DOC 处重新加载文件时，它应该将当前样式表设置为 /CSS 处的文件...... DOC 和 CSS 都在不断变化。

奇怪的是，在 Chrome 中它运行良好。DOC 在“内容” div 中加载，样式表设置为 CSS，并将 CSS 应用于页面。我可以用 CSS 页面进行更改，并且在 5 秒内，当页面刷新时，CSS 也会被刷新。

但在 IE 和 Firefox 中，HTML 将加载，我可以看到样式表链接的 href 属性已**更改**为“/CSS + getTime()”，但是在加载 HTML 时，css*从未*应用于页面。我什至可以更改 DOC 的内容并且它会更新，但 CSS 甚至从未应用过。它只是一个没有样式的页面。

Firefox 和 IE 不支持以这种方式更改样式表引用吗？有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T15:47:08.147

与其在单个链接中更改工作表，不如尝试使用备用样式表。请参阅有关使用备用样式表的链接：

[http://www.alistapart.com/articles/alternate/](http://www.alistapart.com/articles/alternate/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T15:59:08.730

通过 javascript 包含文件的最佳方法是插入一个新的 dom 元素。

```
var a = document.createElement('link');
a.href="inset.css";
a.rel="stylesheet";
document.getElementsByTagName("head")[0].appendChild(a); 
```

但是，很明显，您将遇到的问题是，一旦文档完成加载（并且您正在使用 ajax），firefox 和 ie 将不会重新绘制画布。解决这个问题的方法是获取样式表的内容并将它们包含在样式元素中。此示例代码将动态更改页面上的颜色。

```
function onLoadFunction() {
    var a = document.createElement('style');
    a.appendChild(document.createTextNode('body {color: blue;}'));
    document.getElementsByTagName("body")[0].appendChild(a);
} 
```

加载新工作表时，只需销毁样式元素内的 css 并替换它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T15:42:16.237

也许这会帮助你... [http://www.javascriptkit.com/javatutors/loadjavascriptcss.shtml](http://www.javascriptkit.com/javatutors/loadjavascriptcss.shtml)

```
function loadjscssfile(filename, filetype){
 if (filetype=="js"){ //if filename is a external JavaScript file
  var fileref=document.createElement('script')
  fileref.setAttribute("type","text/javascript")
  fileref.setAttribute("src", filename)
 }
 else if (filetype=="css"){ //if filename is an external CSS file
  var fileref=document.createElement("link")
  fileref.setAttribute("rel", "stylesheet")
  fileref.setAttribute("type", "text/css")
  fileref.setAttribute("href", filename)
 }
 if (typeof fileref!="undefined")
  document.getElementsByTagName("head")[0].appendChild(fileref)
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T15:49:53.163

看起来您每次都只是重新加载现有页面。为什么不直接在标题中使用刷新标签来强制文档每次重新加载并放入 CSS 和内容服务器端。简单得多，即使禁用 javascript 也能正常工作。

```
<meta http-equiv="refresh" content="5;url=http://example.com/DOC" /> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-12T15:43:14.987

可能是缓存问题。如果您进行硬刷新（FF 中的 Ctrl+R，IE 中的 Ctrl+F5）是否正确显示样式？如果确实可以解决问题，您可能需要考虑从 CSS 文件中删除 Last-Modified 标头或添加缓存控制标头，告诉浏览器不要缓存它。

# c# - 如何将 VB5 项目转换为 ac# 项目

> ID：435792
> 
> 赞同：3
> 
> 时间：2009-01-12T15:40:08.020
> 
> 标签：c#, vb6-migration, vb5

我有一个想要升级到 ac# 项目的 VB5（非 .net）项目。有没有人对可以帮助我解决这个问题的方法或免费工具有任何建议。

谢谢

布拉德

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-12T15:43:27.140

你最好直接重写。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T15:50:30.057

我建议首先将项目转换为 VB6。从那里继续前进会容易得多。有许多工具可以帮助您做到这一点。有[VBMigration Partner](http://www.vbmigration.com/)和有[vbto](http://www.vbto.net/)。我也没有尝试过YMMV。

如果成本是一个限制因素，您可以试试这个：Visual Studio 中有一个向导会尝试将 VB6 升级到 VB.NET。它不是 100% 准确的，您必须为 VB.NET 不支持的东西（例如控件数组等）编写代码。一旦代码在 VB.NET 中，您可以使用[SharpDevelop](http://icsharpcode.net)之类的工具将 VB.NET 转换为 C# . 这会有点乏味，但我想所有的道路，无论多么曲折，都会通往罗马。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T15:53:59.380

如果您能够将其迁移到 VB6，您可以使用[代码顾问](http://msdn.microsoft.com/en-us/vbasic/ms789135.aspx)查看如何修复您的项目以与 vb.net 兼容，然后您可以迁移到 vb.net，如果成功，您可以使用[它](http://www.developerfusion.com/tools/convert/vb-to-csharp/)将其转换为 c# 或[Reflector](http://www.red-gate.com/products/reflector/)的工具。

我给它 1x10^(-100)% 的工作机会。祝你好运。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T15:53:18.413

如果您要将 VB5 转换为 .NET（无论是 C# 还是 VB.NET），最快的方法是从 0 重新开始您的实现，这样您就可以充分利用 .NET Framework 类。我不知道是否有工具可以自动进行这种转换。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T18:22:13.590

从一种语言到另一种语言的严格转换很少是一个好主意，尤其是当它们与 VB5 和 C# 一样不同时。

从理论上讲，您可以将 VB5 转换为 VB6，然后将 VB6 转换为 VB.NET，然后将 VB.NET 转换为 C#，但这对我来说听起来很疯狂。

C# 比 VB5 强大得多，以至于您无论如何都不想隐藏代码。毕竟，由于 VB 的 OO 能力较弱，它的设计可能很糟糕。

相反，我建议在 C#（或您想使用的任何其他语言）中重新实现您需要的功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T15:47:01.283

我知道有一个转换工具，但不确定是否有一些用于 vb5。

但是，我建议重新设计项目，利用 vb5 中不可用的 .net 功能。特别是对 OO 语言进行重新设计会很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T15:55:10.610

将 VB5 迁移到 C# 只是为了拥有 .NET 绝不是一个好的理由。我更愿意好好看看我在 VB5 版本中所做的假设和设计决策，重新思考它们，添加新想法，绘制 UI 并改进它以使其看起来更接近现代。

然后这是一个新项目，我什至不会称其为重写，因为会有很多变化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-12T16:21:10.073

我已经将一个小的 1 层 VB6 应用程序迁移到 C#，我再也不会这样做了。

有*一些*应用程序可以很好地从 VB6 迁移到 VB.Net。

//马格纳斯

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-12T18:46:22.823

我过去做过，但不推荐。在“自动迁移”之后让项目正常工作是不值得的。我最终重写了该程序，并因此而变得更好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-12T19:10:16.503

我自己做了这件事后，我谈谈[这里涉及的问题。](https://stackoverflow.com/questions/264375/upgrading-a-large-vb6-app-to-net-opinions-on-vb-migration-partner#265164)

基本上，作为 ocdecio，您至少正在寻找部分重写。您可能需要重构表单以尽可能多地从中移出代码。您还需要重构任何 VB6 特定功能以在可以在 .NET 中重新实现的接口后面工作。尤其是图形命令和打印机功能。对于任何严肃的项目，迁移工具通常毫无价值。

# asp.net - 您对使用 ASP.NET 2.0 webparts 有什么体验？

> ID：435795
> 
> 赞同：3
> 
> 时间：2009-01-12T15:41:01.683
> 
> 标签：asp.net, user-controls, web-parts

我想知道您将 ASP.NET webparts 作为您网站中可重用组件的体验。

你觉得它有多大用处？你发现它有什么严重的问题吗？你会推荐它在任何 asp.net 项目中使用吗？

您想强调的任何最佳实践或提示。

您是否会推荐使用 webparts 作为 asp.net 门户设计的一部分，或者我们会以我们良好的旧 UserControl 作为基础来集中您的设计。

此输入将帮助我为我正在开发的 asp.net 应用程序做出决定。

如果您需要更多说明，请留下评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T15:47:45.320

我个人不会为您的应用程序推荐 WebParts，除非您要全面了解 Webparts 门户范式。我很谨慎地玩弄它们，只是觉得它不像设计自己的作品那样有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T16:06:28.730

WebPart 相对于 UserControl 的优势：

1.  支持用户可编辑的属性和内置的个性化
2.  可定制的编辑器部件
3.  可自定义的标准 WebPart 菜单
4.  在 WebPartZone 之间拖放 WebPart
5.  支持 WebPart 之间的连接，对主/详细视图、过滤器等有用
6.  可以加载用户控件

缺点：

1.  更高的资源使用率
2.  Visual Studio 当前没有对 WebParts 的设计器支持

就像 ocdecio 提到的那样，ASP.NET MVC 现在可能是一个更好的选择，至少在 WebPart 非常重要的 SharePoint 世界之外。

编辑：

有关 ASP.NET 2.0 WebParts 的概述，您可能需要查看：

[在 ASP.Net 2.0 中使用 WebParts](http://dotnetslackers.com/articles/aspnet/UsingWebPartsInASPNet20.aspx "在 ASP.Net 2.0 中使用 WebPart")并 [使用用户控件和自定义 Web 部件个性化您的门户](http://msdn.microsoft.com/en-us/magazine/cc300767.aspx "使用用户控件和自定义 Web 部件个性化您的门户")

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T15:47:51.343

根据我的经验，Web 部件对于为 SharePoint 创建内容很有用。但是现在有了 ASP.NET MVC，我不确定它们是否会成为标准 ASP.NET 应用程序的好选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T15:57:44.240

我同意 TheTXI...就像许多 ASP.NET 技术一样，除非您 100% 购买模型，否则您不会真正从 Web 部件中获得太多好处。

但除此之外，我们还遇到了一些技术问题，主要与跨浏览器 UI 渲染问题有关。这些可能已在最近的版本中得到修复，我不知道：我们最终推出了自己的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T06:09:02.087

ASP.NET MVC 越来越受到关注。从字面上看，它是将其他所有东西都从水中吹出来。我建议先调查一下。Sharepoint 可能很快就会合并 MVC。

# sql-server - Reporting Services 2005 中的适当图表缩放

> ID：435799
> 
> 赞同：1
> 
> 时间：2009-01-12T15:42:40.400
> 
> 标签：sql-server, reporting-services, charts, scaling

我正在使用存储过程作为数据源在 Reporting Services 2005 中开发一个简单的条形图。该图中的值可以是正数也可以是负数，并且可以跨越一个非常大的范围，因此我无法指定任何适用于所有场景的非动态比例。

我面临的问题是自动缩放非常糟糕。我没有线显示零点在哪里，并且 y 尺度标签是从上到下的：

8818

-191181

-391181

等等等等……

所以我的问题是，使量表更适合人类阅读的最佳方法是什么？那里有指南吗？Reporting Services 2008 能更好地处理这个问题吗？

此外，离开 Reporting Services 并不是一个真正的选择。我意识到如何将值和表达式放在最大值、最小值和网格线间隔字段中，尽管这更像是一个问题，我应该在那里放置什么表达式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T21:45:39.437

对于报告服务中的图表，我的体验通常很糟糕。它们不是很灵活，并且有各种令人讨厌的小错误。

如果你坚持使用它们，你应该能够编写一些逻辑来返回你需要的缩放作为存储过程的一部分。然后，您可以使用它们的表达式窗口在图表属性中使用这些值。

我曾经面临同样的问题。现在，我几乎在所有事情上都使用谷歌的图表。修改您的 SP 以返回正确的 URL。设置一个图像来代替您的图表，并拥有由您的 SP 返回生成的图像的 URL。

不幸的是，您需要做一些工作才能习惯图表，但谷歌在这里有很好的文档：[http ://code.google.com/apis/chart/](http://code.google.com/apis/chart/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T10:13:48.727

我自己找到了答案。

Y 轴属性选项卡中有一个名为“侧边距”的复选框...

伙计，我为此浪费了好几个小时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T14:12:50.403

您可能会考虑获得不同的图表控件。我知道我们使用 Dundas 图表，它们适用于我们的大多数场景。对于我的一张图表，其中可能有大量不同的条形图，我在 Y 轴最小值和最大值上设置了这个：

```
Min: =Round(MAX(Fields!ItemTolLower.Value, "AggregateModel") * -1) -1
Max: =Round(MAX(Fields!ItemTolUpper.Value, "AggregateModel")) + 1 
```

我让它在 AggregateModel 数据集中找到高值和低值（我的容差下限始终为正数，但显示为负数，因此我必须乘以 -1）。
但同样，这是使用 Dundas 图表，而不是我没有太多经验的股票 Visual Studio 图表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-05T13:15:33.953

为了回答您关于 Reporting Services 2008 如何处理此类问题的部分问题，我可以说 2008 版的 Reporting Services 比 2005 版要好得多。添加了许多选项来管理音阶、间隔等......

但是，界面不是很直观，但是一旦您习惯了所有选项，您就可以制作出良好且用户友好的图表。

[Linkee.fr](http://www.linkee.fr "Linkee.fr")

# sql-server - SSIS、dtsx 和部署包

> ID：435810
> 
> 赞同：5
> 
> 时间：2009-01-12T15:46:28.663
> 
> 标签：sql-server, ssis

我只是想更好地理解 SSIS 包以及它们是如何部署的。纠正我我错了，但对于任何部署，我相信至少需要两个文件，一个 .SSISDeploymentManifest 和一个 .dtsx。.SSISDeploymentManifest 充当指向 .dtsx 的等效 Windows 安装程序包。dtsx 是实际的“东西”包，在运行安装程序时被引用为外部文件。当您安装它时，该包将被添加到该实例的 ssis 包列表中。

我的进一步问题：

*   如果我想保留同一个包的以前版本，我可以只复制带有上述两个文件的 bin 目录并分开保存，如果我需要回滚到以前的包吗？
*   这些软件包安装在哪里？SSIS 如何知道包在哪里？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-14T16:39:07.277

> 纠正我我错了，但对于任何部署，我相信至少需要两个文件，一个 .SSISDeploymentManifest 和一个 .dtsx。.SSISDeploymentManifest 充当指向 .dtsx 的等效 Windows 安装程序包。dtsx 是实际的“东西”包，在运行安装程序时被引用为外部文件。当您安装它时，该包将被添加到该实例的 ssis 包列表中。

你的假设大多是正确的。您不需要部署清单，但它可以很方便。此外，您不需要部署到 SQL Server 实例。您也可以选择部署到文件系统。我将在下面解释两者。

关于你的第一个问题：

## 版本控制：

确保您正在通过 Visual Studio 开发和签入 dtsx 包。在 sourcesafe 或您正在使用的任何版本控制中标记您的版本。如果您正在签入和标记，那么您应该能够轻松地回滚到以前的版本。正如您所提到的，您也可以只保存旧 bin 目录的副本，但自然地将它们放在过时的子文件夹或其他东西中。但是，这并不能代替适当的版本控制。

关于你的第二个问题：

## 部署：

正如另一张海报所说，您首先要做出决定：

a) 将包部署到文件系统 b) 将包部署到 MSDB

每个人都有好处，每个人都有自己的喜好。我都使用过，但我更喜欢文件系统，因为它更透明，但还有更多需要维护。

有关更多信息，请参阅此帖子：http: [//blogs.conchango.com/jamiethomson/archive/2006/01/05/SSIS_3A00_-Common-folder-structure.aspx](http://blogs.conchango.com/jamiethomson/archive/2006/01/05/SSIS_3A00_-Common-folder-structure.aspx)

代码在 dtsx 包中。通常，为了使您的包可移植，您还将连接字符串和其他可配置信息抽象到配置文件 (.dtsconfig) 或环境变量（不需要文件）中。请参阅 BOL 以了解有关配置的更多信息。

清单文件包含有关要安装哪些 dtsx 和配置文件的元数据。如果你打开一个，你会看到它是一个简单易读的 xml 文件。

清单文件可以轻松地移交给 DBA 进行部署（要求他们双击清单文件并按照说明进行操作，但他们需要说明。

对我来说，清单文件对于部署到 SQL Server 比部署到文件系统更有用。实际上，它所做的只是复制 dtsx 和配置文件并将它们放在您告诉它的地方。您可以轻松地指示 DBA 将您的 dtsx 文件复制到服务器上的公共文件夹，并将配置文件复制到同一服务器上的另一个文件夹。

然后，当您使用 SQL 代理计划作业时，您指定要运行存储在文件系统上的 SSIS 包并浏览到它所在的位置。如果您正在使用配置，那么有一个选项卡可以指定配置文件的位置。

关于 SSIS 包的配置/部署/版本控制有很多要了解的。但希望这能让你走上正确的道路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T16:00:25.950

当您使用 SQL Server 中的导入/导出向导导出 DTS 包时，您可以选择将它们保存到 SQL Server 或本地文件系统上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-04T20:54:12.213

关于 SSIS 包的版本，您需要查询 SSISDB 以提取版本号。令人讨厌的是，此类信息并未直接显示在 Management Studio 中，但在此之前，有人可能会觉得这很有用：

```
SELECT prj.[name] as Project
      ,pkg.[name] as Package
      ,pkg.[version_major]
      ,pkg.[version_minor]
      ,pkg.[version_build]
FROM [SSISDB].[internal].[packages] as pkg
JOIN [SSISDB].[internal].[projects] as prj
ON pkg.[project_id] = prj.[project_id]
ORDER BY prj.[name] 
```

# css - 使用严格的 XHTML 并依赖 CSS 100% 的视觉样式来构建网站是否可行？

> ID：435817
> 
> 赞同：15
> 
> 时间：2009-01-12T15:47:11.517
> 
> 标签：css, xhtml, standards

*当现实情况是，如果我不那么*谨慎，我本可以更快地完成项目，我倾向于经常采用学术方法并在开发过程中坚持严格的原则。我正在寻找合适的实用性。

我想采用“Zen”方法来设计一个网站，（用我的话来说）“将 HTML 严格用于内容结构，让 CSS 魔法来完成剩下的工作”。这在现实中有多实用？我遇到的一个问题是我想先开发（使功能正常）网站，然后再回来设计它。我知道结构方面我希望网站如何流动，但我什至还没有开始使用 CSS 布局、图形或任何其他设计元素。这里的正确方法是什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-12T15:51:20.430

它绝对实用，并提供无限的好处。事实上，这正是 CSS 以及内容和布局分离的目的。

上面给出的正确方法是让不同的团队继续手头的不同任务。这需要（也许）一个可能相当粗糙的初始图形设计，以及针对“#viewport”、“.user”等内容的文档化和协作同意的一组命名约定。

标记团队通常是后端驱动的，通常会稍微领导设计团队，但他们应该而且必须保持足够的灵活性，以便在需要时更改标记，或者将其置于设计师的控制之下。

最后一个只是我的 0.02 美元，但是如果一个人同时担任两个角色，我认为您首先要引导自己使用标记/后端，然后根据需要迭代地进入设计阶段，然后是标记，然后是设计。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T16:01:44.433

您要遵循的方法是正确的。只有两件事：

1.  如果您对 css 或 html 使用验证器，请不要假装您的所有 html 或 css 都通过了测试。显然，理想的目标是一切都得到验证，但在第一阶段，我认为最好不要在验证问题上花费大量时间。请记住，没有一个验证器是完美的，一开始就使用它的好方法是引导您朝着正确的方向前进并避免大错误（即在一个页面中放置两次相同的 id，或者将块元素放入内联元素中。 ..)。然后，当应用程序处于良好阶段时，您可以使您的 css 和 html 完美有效。
2.  不要在最后设计界面。我认为应用程序的界面也可以为您提供如何开发后端的良好指导。所以，在你的位置，我会先用 html 和 css 设计界面，然后我会开始向它添加功能。

（对不起我的英语，欢迎拼写更正。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T15:56:50.637

它非常实用，您会惊讶于您的 HTML 看起来多么干净。我喜欢使用 CSS 重置文件来帮助入门，我个人喜欢[YUI 重置](http://developer.yahoo.com/yui/reset/)。另一个需要考虑的 Zen 项目是使用[不显眼的 JavaScript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)。这进一步分离了代码的不同层。JavaScript 库，如[jquery](http://jquery.com/)、[prototype](http://www.prototypejs.org/)和[dojo](http://dojotoolkit.org/)可以帮助解决这个问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-12T15:57:40.497

这是可以做到的，我认为你的网站（以及你的网页设计技能，尤其是）会更好。但它也有一定的学习曲线。它要求对 XHTML/CSS 规范的理解比许多人都更透彻。

确保可以验证您的 HTML 只是开始。哦，确保所有浏览器在渲染页面时都以严格模式运行。

当然，您*将*需要解决方法来支持 IE，但这可以通过多种方法来完成。首先，IE 支持条件注释，允许您包含特殊的 CSS 样式表来修复 IE 错误，这应该可以帮助您完成大部分工作，而不会影响您符合标准的页面版本。

对于某些事情，您*可能还*需要一些 javascript，但对于大多数常见功能来说，这不是必需的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-12T17:04:59.393

[在http://www.webdevout.net/articles/beware-of-xhtml](http://www.webdevout.net/articles/beware-of-xhtml)中解释了今天反对使用 XHTML 的原因。总而言之，不支持 XHTML，除非您将其作为此类服务，并且如果您针对的是较旧的浏览器（任何 IE 版本都是旧的，因为它的大多数功能都是在它们仍然不成熟并且有一段时间没有发生实质性变化时实现的），您别无选择，但将其作为 HTML 提供。

除非您不需要 XML 提供的功能（如 SVG、MathML），否则请坚持使用 HTML。与 HTML 相比，您不会有任何重大优势，更具语义性，拥有更好的 CSS 支持（甚至更少）。但是您获得了更广泛的兼容性，并且您的布局将更加可预测（例如，表格单元格可以从 HTML 中的行中的第一个单元格继承，在 XML 中没有这样的东西，甚至不确定 XHTML 在某处有任何例外）。

验证器不会比 HTML 更有助于编写 XHTML。甚至很烦人，如果你使用严格的，让你想知道如果你撒谎说它是 HTML，br 标签中的 / 是什么大惊小怪的。（如果您将 XHTML 作为 HTML 提供，Firefox 视图源将显示为鲜红色）。我相信你可以找到更多的例子。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-12T15:53:36.697

当然，你可以这样做，但要准备好它不会在 IE 下呈现。在最近的一个 Web 项目中，我们的大部分前端缺陷是修复 IE 中已经在 Firefox 中运行良好的东西。也许这会在 IE8 中改变，但我对此表示怀疑。在某些情况下，我们甚至不得不编写一些在 IE 上执行的 javascript，以解决仅使用 CSS 无法完成的事情。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-12T16:06:43.927

虽然理论上听起来不错，但您不能 100% 使用 CSS 为网站创建布局。您仍然需要使用一些标记，以便您可以应用 css。也就是说，您可以使用此方法非常接近理想状态。我经常惊讶于真正的 css 大师实际上需要多少标记。

更接近您真正寻找的“禅”方法是 xslt。它通过您的应用程序生成 xml 数据然后 xslt 将该 xml 转换为 html/css 来工作。这需要学习 xslt 并为生成页面的过程增加了另一层复杂性，但增加了您正在寻找的分离。在理想的世界中，理论是程序员只需要担心生成 xml 数据，然后设计人员可以使用该数据生成视觉效果，但是它很少以这种方式工作，因为 xslt 的技术性超出了大多数设计人员的处理能力。大多数时候，程序员最终会生成 xslt，这在某种程度上违背了目的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-12T16:00:03.470

一种对我有用的方法是首先构建 HTML，然后在同一文件的标签中添加一些最小的 CSS（足以创建正确的布局等）。然后，一旦您对结构感到满意，您就可以将 CSS 提取到单独的文件中和/或完全重做 CSS。这对我来说是一个正确的平衡——它仍然是一个轻量级的过程，但它避免了寻找和替换内联 CSS 的潜在麻烦。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-12T15:50:59.090

在理论上是的，在实践中，浏览器的差异可能会迫使您添加一些 javascript 来处理差异。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-05-29T05:41:33.307

现在......某事的好处与做某事的实用性不同。你们是否忘记了 IE，甚至忘记了那些想要完成不可能的事情的客户？

我很想说您必须对您使用的严格 DTD 做出一些例外，以使其在合理的浏览器组中工作，并取悦您的利益相关者对网站/网络应用程序。

我是一个标准狂，如果可以建立一个不违反一条 DTD 规则的网站，没有人会比我更高兴。但是 4 年后，我只是无法将其用于**实际目的**。

当然，如果我是对我将要开发的网站提出要求的人，那是可能的，但我必须改变业务规则以适应这种情况。相信我，这是唯一可行的方法。

# c - 什么类型的程序最好用 C 编写

> ID：435834
> 
> 赞同：27
> 
> 时间：2009-01-12T15:51:14.283
> 
> 标签：c

Joel 和他的公司阐述了学习 C 的优点以及学习语言的最佳方法是如何使用它实际编写程序。为此，哪些类型的应用程序最适合 C 编程语言？

编辑：我正在寻找 C 擅长的东西。这可能与学习 C 的最佳方式不一致。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-12T15:55:44.667

需要绝对控制内存管理的代码。您需要完全控制速度与内存权衡的代码。非常低级的文件操作（例如访问原始设备）。

示例包括操作系统内核和嵌入式应用程序。

在 1980 年代后期，我是 C 系统维护团队的负责人，该系统的代码超过一百万行。它做了数据库访问（Oracle）、X Windows 图形、进程间通信，以及各种好东西。它在 VMS 和多种 Unix 上运行。但是如果我今天要重新创建那个系统，我肯定不会使用 C，我会使用 Java。其他人可能会使用 C#。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-01-12T15:53:38.820

低级功能，例如 OS 内核和驱动程序。对于那些人来说，C 是无与伦比的。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-01-12T16:19:42.450

你可以用 C 写任何东西。它是一种非常通用的语言。这样做一段时间后，您将理解为什么还有其他“更高级别”的语言可用。

无论如何，“学习C”，但不要坚持太久。其他语言的生产力要高得多。

我认为那些说你需要学习 C 的人的要点是让你了解高级代码和机器内部之间的关系，以及位、字节、程序执行等会发生什么。

了解这一点，然后继续前进。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-01-12T15:56:47.097

那 100 行 python 代码占了你执行时间的 80%。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-01-12T15:54:15.120

没有 UI 的小型应用程序，尤其是在您尝试学习时。

**编辑：**在对此进行了更多思考之后，我将添加以下内容：如果您已经了解一种高级语言并且您正在尝试了解更多关于 C 的信息，那么一个好的方法可能是不创建一个全新的 C 应用程序，而是创建一个 C DLL 并向其中添加可以从高级语言调用的函数。通过这种方式，您可以替换您的高级语言已经拥有的简单函数，以确保您的 C 函数完成它应该做的事情（为您提供预先构建的测试），让您主要以您熟悉的方式编写代码，以您已经熟悉的问题，并教您有关互操作的知识。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-01-12T16:02:30.190

任何你想到使用汇编的地方。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-01-12T15:59:11.930

*   数字运算（例如，从其他语言（如 Python）在更高级别使用的库）。
*   嵌入式系统编程。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-01-12T19:23:03.390

很多人都说操作系统内核和设备驱动程序当然是 C 语言的好应用程序。但 C 语言也可用于编写任何需要使用硬件能够提供的所有性能的性能关键应用程序。

我正在考虑诸如数据库管理系统（mySQL、Oracle、SQL Server）、Web 服务器（apache、IIS）甚至我们的浏览器之类的应用程序（看看 chrome 的编写方式）。

您可以在 C 中进行如此多的优化，这些优化在 Java 或 .NET 等虚拟机中运行的语言中是不可能的。例如，数据库和服务器同时支持许多用户，并且需要很好地扩展。数据库可能需要在多个用户（线程/进程）之间共享数据结构，但这样做的方式是有效地使用 CPU 缓存。在 C 中，您可以使用操作系统调用来确定缓存的大小，然后将数据结构与缓存行适当地对齐，这样当多个线程访问相邻但不相关的数据时，缓存行不会在缓存之间“乒乓” （所谓的“虚假分享”）。这是一个例子。还有很多其他的例子。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-01-12T16:11:24.057

引导加载程序。还需要一些组装，这实际上非常好..

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-01-12T21:03:33.890

1.  您觉得需要 100% 控制您的程序的地方。这通常是低层操作系统的情况，如设备驱动程序，或基于 MCU 的真正嵌入式设备：s 等（所有这些和其他已经在上面提到过）

2.  但请注意，C 是一种成熟的语言，已经存在很多年，而且还会存在很多年，它有很多非常好的调试工具，但仍有大量开发人员使用它。（它可能已经比更流行的语言失去了很多，但它仍然是巨大的）它的所有优点和缺点都是众所周知的，语言可能不会再改变了。所以没有太多惊喜的余地……

这也意味着，如果您的应用程序具有较长的预期生命周期，它可能是一个不错的选择。

/约翰

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-12T16:27:52.823

任何你需要最低限度的“魔法”并且需要计算机**完全按照**你的指示去做的事情，不多也不少。任何你不相信垃圾收集的“魔法”来处理你的内存的地方，因为它可能不如你可以手动编码的效率高。任何你不相信内置数组、字符串等的“魔法”不会浪费太多空间的地方。您希望能够准确推断编译器将为给定代码段发出的 ASM 指令的任何内容。

换句话说，在现实世界中并没有太多。大多数事情会从更高级别的抽象中受益，而不是从这种控制中受益。**然而，操作系统代码、设备驱动程序以及一些必须在空间和速度方面都**接近最优的东西可能对用 C 编写有意义。高级语言可以在速度上与 C 竞争，但不一定在空间上。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-12T16:40:25.700

嵌入式的东西，内存使用和 CPU 速度很重要。
操作系统的中断处理程序部分（可能还有两个或三个函数）。

即使你们中的一些人现在开始猛烈抨击我：
我不认为任何像样的应用程序都应该用 C 编写——它太容易出错了。（是的，我确实知道我在说什么，我自己用 C 语言编写了很多代码（操作系统、编译器、VM、网络协议、RT 控制等）。

使用高级语言会使您的工作效率更高。速度通常通过牢记 10-90 规则来获得：90% 的 CPU 时间花费在 10% 的代码中（应该首先优化）。此外，使用正确的算法可能比优化 C 中的位提供更多的性能。而在 C 中正确地做事要麻烦得多。

PS：我的意思是我在上面第二句话中写的；你可以用像 Lisp 或 Smalltalk 这样的高级语言编写一个完整的高性能操作系统，只用 C 语言中的几个小部分。想想 70 年代的 Lisp 机器如何在今天的硬件上运行......

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-13T05:58:55.633

垃圾收集器！

此外，只是主要工作是进行操作系统调用的程序。例如，我需要编写一个简短的 C 程序`timeout`，称为

*   将命令行作为参数，该命令运行的秒数
*   分叉两个子进程，一个运行命令，一个休眠 N 秒
*   当第一个子进程退出时，杀死另一个，然后退出

效果将是运行一个对挂钟时间有限制的命令。

我和这个论坛上的其他人使用 shell 和/或 perl 尝试了几种不同的解决方案。一切都很复杂，没有一个做对了。在 C 中，解决方案将很简单，因为所有操作系统设施都在您可以使用的地方。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-12T16:07:33.253

您的问题中隐含的假设是，像 Python 或 Perl（或 Java 或......）这样的“高级”语言对大多数应用程序来说足够快、足够小、......足够了。对于大多数应用程序和某些选择 X 的语言来说，这当然是正确的。鉴于此，您选择的语言几乎*可以肯定*具有外来函数接口 (FFI)。由于您要*学习*C，因此请在 C 中内置的 FFI 中创建一个模块。

例如，假设您选择的工具是 Python。[在 C 中重新实现Numpy](http://numpy.scipy.org/)的一个子集。由于 C 是一种非常快的语言，并且在 C99 中具有清晰的数字库接口，因此您将有机会在适当的设置中体验 C 的强大功能。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-12T19:31:35.680

我能想到的几种：

*   直接使用 Unix/Linux 或 Win32 系统调用的系统编程
*   没有太多字符串操作的性能关键代码（例如，数字运算）
*   嵌入式编程或其他资源严重受限的应用程序

基本上，C 语言让您可以便携、高效地访问机器的本机功能；其他一切都是你的责任。特别是，C 中的字符串操作是乏味的、容易出错的，而且通常很讨厌。使用 C 进行大量字符串操作的最有效方法可能是使用它来实现一种可以更好地处理字符串的语言......

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-12T22:45:26.740

例如：嵌入式应用程序、内核代码、驱动程序、原始套接字。

但是，如果您发现自己在 C 语言中的工作效率更高，那么请继续构建您想要的任何东西。使用语言作为解决问题的工具。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-14T14:13:18.193

c编译器

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-01-16T17:54:57.553

从事数学和物理研究。可能有两种选择：C 和 C++，但后者的封装和继承等特性在那里用处不大。人们可能更愿意将 C++ 用作“更好的 C”，或者只使用 C。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2011-04-09T13:46:41.140

好吧，大多数人都在建议与系统编程相关的东西，例如 OS 内核、设备驱动程序等。这些都是困难且耗时的。也许 C 语言最有趣的事情就是控制台编程。你听说过 HAM SDK 吗？它是任天堂GBA的完整软件开发工具包，为它制作游戏很有趣。还有支持 NES 编程的 CC65 编译器（虽然不完全）。你也可以制作好的模拟器。相信我，C 非常有帮助。我原本是 Python 爱好者，讨厌 C，因为它很复杂。但是在 yuoget 习惯了它之后，你可以用 C 做任何事情。现在我使用 CPython 将 Python 嵌入到我的 C 程序中（如果需要），并且大部分代码都在 C 中。C 也非常适合可移植性，有一个 C 编译器适用于每个操作系统和几乎所有控制台和移动设备。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-01-12T16:02:52.997

不要将 C 视为增强的汇编程序。当它是自然语言时，我已经在其中完成了一些严肃的应用程序（例如，目标机器是带有 X11 的 Solaris 机器）。

在上面写点肉。编写客户端服务器象棋程序，AI在服务器上，UI在X11中显示；一旦你这样做了，你就会真正了解 C.

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-01-12T16:09:33.343

Internet Information Server 的 ISAPI 过滤器。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-01-12T16:22:04.690

在实际编写 C 代码之前，我建议先阅读好的 C 代码。
选择您想专注的主题，基本上任何应用程序都可以用 C 编写，但我认为 GUI 应用程序不会是您的首选，并且很少有开源项目可供研究。

没有任何开源项目是最好看的代码。我假设在您选择了一个主题之后，还有一个地方可以回答另一个问题，请询问该领域的最佳开源项目。
玩它，了解它是如何工作的，修改一些功能......
最好的学习方式是向优秀的人学习。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-01-12T16:22:42.287

Photoshop 插件过滤器。你可以用这些来做很多很多有趣的图形操作，你需要纯 C 来做。

例如，它是分形生成、傅立叶变换、模糊算法等的门户。实际上任何可以操纵图像/颜色数据并给出有趣结果的东西

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-01-12T19:09:38.847

我想知道为什么没有人说显而易见的：

网络应用程序。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-01-12T21:13:02.560

任何底层库完全在 C 中的地方都适合留在 C 中 - openGL、Lua 扩展、PHP 扩展、老式 windows.h 等。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-01-12T22:54:19.423

我更喜欢 C 用于解析、代码生成之类的任何东西——任何不需要大量数据结构的东西（阅读 OOP）。它的库占用空间很轻，因为类库不存在。我意识到我在这方面很不寻常，但就像很多事情“被认为是有害的”一样，我尝试拥有/使用尽可能少的数据结构。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-01-12T23:42:03.680

好吧，如果您想学习 C 并同时获得一些乐趣，我是否建议您购买 NXC 和 Lego Mindstorms 套装？NXC 是 Lego Mindstorms 的 C 编译器。

这种方法的另一个优点是，您可以将 Mindstorms“砖”与 C 编程的努力进行比较，然后尝试 LEJOS，看看它如何与 Java 一起使用。

都很好玩。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-01-14T00:46:53.360

照着别人说的。C 似乎是一种很好的语言来实现您编写软件其余部分的语言。

并且（比照了）运行其余软件的虚拟机。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-01-14T01:01:13.177

我想说的是，由于运行时环境很小，而且它是自包含的，您可以从创建一些 CLI 实用程序开始，例如 grep 或 tail（或 Unix 中的一半命令）。任何只使用 STDOUT、STDIN 和文件操作的东西都是不错的选择。

这并不能完全回答您的问题，因为我实际上不会选择在这样的应用程序中使用 C，但我希望它回答了您要问的问题——“什么是使用学习 C 的好应用程序类型？”

C 实际上并不是那么糟糕的语言——它很容易在汇编语言级别上理解你的代码，这非常有用，而且语言结构很少，留下了一种非常稀疏的语言。

要回答您的实际问题，C 的最佳用途是创建它的用途——将其自身（和 UNIX）移植到其他 CPU 架构。这很好地解释了语言特征的缺乏；它还解释了指针的存在，它实际上只是一种使编译器工作更少的结构——任何使用指针创建的代码都可以在没有它的情况下创建（同样优化），但是创建一个编译器变得更加困难。 .

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2012-12-05T04:37:54.977

数字信号处理，所有 Pure Data 扩展都是用 C 编写的，这也可以用其他语言完成，但在 C 中取得了很好的成功

* * *

## 回答 #31

> 赞同：-2
> 
> 时间：2009-01-12T19:20:21.007

简短的回答是*没有*。稍长一点的答案是任何时候您有系统的编程任务，并且无法访问任何编译器以获得更好的语言。

对于系统的编程任务，使用像 Ada 这样功能强大但更安全且不易出错的东西会得到更好的服务。对于通用 OO 编程，C++、Java 和 Ada 等语言再次成为更好的选择。对于许多特定任务，例如字符串操作或网站生成，有特定领域的语言可以让您的工作更轻松。

# sql-server-2005 - SQL Server 不存在或访问被拒绝错误

> ID：435838
> 
> 赞同：1
> 
> 时间：2009-01-12T15:53:15.123
> 
> 标签：sql-server-2005, sharepoint, ms-office, performancepoint

我有一个在服务器外执行时运行良好的应用程序。当客户端尝试连接时，他们会收到以下错误：

获取数据失败。*无法初始化数据提供者 *SQL Server 不存在，或访问被拒绝

在我的 Office Web 组件 (MDAC) 上。我猜有一些安全或服务器配置错误，但我无法查明它。我正在运行 SQL Server 2005。

*注意 - 客户不能更改他们的安全设置、公司政策。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T15:59:11.880

当您从命令提示符尝试此操作时：

TELNET 服务器名 1433

发生什么了？如果您得到一个空白屏幕，那么 SQL Server 正在侦听并且您的客户端设置有问题。如果您得到“拒绝访问”或“无响应”类型的答案，则很可能是防火墙问题或 SQL Server 未在侦听，但无论哪种情况，这都是服务器问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T16:13:24.957

SQL Server 2005 默认禁用网络可访问性，您可能需要启用它

[http://msdn.microsoft.com/en-us/library/ms165647(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms165647(SQL.90).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T15:55:21.920

您的防火墙设置可能会阻止来自您的客户端的连接。如果不是，则可能是 DNS 问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T15:57:33.820

很可能是您的防火墙不允许远程连接的问题？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T16:00:12.940

如果它在服务器上工作但客户端遇到问题，我认为错误的“访问被拒绝”部分是这里的关键，这是一个身份验证问题。

您使用哪种身份验证来验证您的客户？服务器是否使用模拟？如果您在 Active Directory 域中运行客户端和服务器，则客户端应用程序（例如 Office 或 Internet Explorer）可能会将凭据传递到服务器用于对数据库进行身份验证的服务器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-13T10:48:46.390

为了使 SQL Server 可以从网络机器上联系，它需要在服务器上为 TCP 流量打开端口 1433。此外，如果您有一个命名实例，您应该检查它正在侦听的端口，因为它可能与默认端口不同，并且可能需要打开。您还必须为 UDP 打开端口 1434 以支持 SQL Browser 服务

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-23T15:57:19.047

防火墙问题。禁用防火墙，再次运行实例

# json - Emacs 模式编辑 JSON

> ID：435847
> 
> 赞同：75
> 
> 时间：2009-01-12T15:54:57.820
> 
> 标签：json, emacs, unicode

有人知道编辑 JSON 的良好 Emacs 模式吗？我正在开发的一个应用程序使用基于 JSON 的通信协议，并且将数据很好地缩进和语法高亮将在我弄清楚它的过程中帮助我很多。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2011-10-28T20:50:16.033

+1 乔希的[json 模式](http://melpa.milkbox.net/#/json-mode)——对我来说效果很好。我添加了

```
(defun beautify-json ()
  (interactive)
  (let ((b (if mark-active (min (point) (mark)) (point-min)))
        (e (if mark-active (max (point) (mark)) (point-max))))
    (shell-command-on-region b e
     "python -m json.tool" (current-buffer) t))) 
```

和

```
(define-key json-mode-map (kbd "C-c C-f") 'beautify-json) 
```

到 json-mode.el 以使 shell 命令调用更容易。

**更新：** 对于那些需要/希望使用 unicode 执行此操作的人，请[在此处](https://stackoverflow.com/questions/11924515/unicode-conversion-issue-using-python-in-emacs)查看我的问题。结果是而不是使用：

```
python -m json.tool 
```

你会想要使用

```
python -c 'import sys,json; data=json.loads(sys.stdin.read()); print json.dumps(data,sort_keys=True,indent=4).decode("unicode_escape").encode("utf8","replace")' 
```

这既美化了 JSON，又保留了原始的 Unicode 内容。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2011-11-16T20:07:42.950

**js-mode 支持 json 文件的语法高亮和缩进。**

这是从 Emacs **23.2**开始的，当时 espresso-mode 被合并到 Emacs 中并重命名为 js-mode。

看看： [http ://www.nongnu.org/espresso/](http://www.nongnu.org/espresso/)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-12T16:01:15.467

您是否尝试过 Steve Yegge 的[Emacs js2 模式](http://code.google.com/p/js2-mode/)？

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2011-09-22T03:59:02.073

如果你想要一些轻量级的东西，试试我一起破解的这个主要模式：[https ://github.com/joshwnj/json-mode](https://github.com/joshwnj/json-mode)

它实际上只不过是在 javascript-mode 之上的一些额外的语法突出显示，但就我的目的而言，我发现它工作得很好。

另一个常见的用例是自动格式化 JSON 文件（例如，如果它是空格压缩的并且您想要更多的可读性）。为此，我只是通过命令行脚本管道传输缓冲区：Cu M-|

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-04-30T12:02:09.693

我已经为[js2-mode](http://code.google.com/p/js2-mode/)准备了一个解决方法，因此它可以解析 json 文件而不会出错。您可以在我的评论中找到它：[http ://code.google.com/p/js2-mode/issues/detail?id=50#c7](http://code.google.com/p/js2-mode/issues/detail?id=50#c7)

（我想将其作为 JF Sebastian 解决方案的评论发布，但似乎我不允许这样做（没有“添加评论”链接））

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-02-19T11:19:56.457

`json.el`Edward O'Connor 自 23.1 (2008) 以来一直是 GNU Emacs 的一部分。

虽然它不是语法荧光笔，但它有一个有用的功能来格式化 JSON：

```
M-x json-pretty-print-buffer RET 
```

因此，如果您有最新版本的 Emacs，则不需要`jq`or `python -m json.tool`。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-04-23T12:03:28.687

由于 JSON 是 YAML 的一个子集，`yaml-mode`因此也可以工作（不过，我不知道它与`js-mode`and相比如何`json-mode`）。

安装（来自 emacs）：`M-x package-install yaml-mode`.

`yaml-mode`与 YAML 和 JSON 文件的关联，在`~/.emacs.d/init.el`：

```
(add-to-list 'auto-mode-alist '("\\.yaml$" . yaml-mode))
(add-to-list 'auto-mode-alist '("\\.json$" . yaml-mode)) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-07T09:07:07.797

[espresso-mode](http://www.nongnu.org/espresso/)支持 JSON

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-02-27T01:21:33.497

js3 模式：[https ://github.com/thomblake/js3-mode](https://github.com/thomblake/js3-mode)

js3-mode 是改进的 js2-mode

这个包可以通过 package-list-packages 命令安装

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-29T04:52:32.537

我也会支持 Josh 的 json-mode，但也推荐 flymake-json 作为补充。它有助于突出语法错误。

我不喜欢使用`python -mjson.tool`，因为它会重新排序 JSON 对象中的项目。我发现`(prog-indent-sexp)`可以很好地重新缩进，并使用`jsonlint` 而不是`python -mjson.tool`用于漂亮的打印/重新格式化`beautify-json`

```
(eval-after-load "json-mode"
  '(progn
     (require 'flymake-json)
     ;; flymake-cursor displays error in minibuffer message area instead of requiring hover
     (require 'flymake-cursor)

     (add-hook 'json-mode-hook 'flymake-json-load)
     (define-key json-mode-map "\C-c\C-n" (function flymake-goto-next-error))
  )
) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-03-04T21:26:55.587

我对 Mariusz Nowak 的[解决方法](https://stackoverflow.com/a/5841588/1713079)进行了扩展，以使其本身可以用作主要模式。除了简单地导出模式之外，几乎不需要修改；Nowak 的工作真正需要的唯一改变是能够将不与文件关联的缓冲区或与名称不以`.json`.

这是增强的解决方法：

```
(make-variable-buffer-local 'js2-parse-as-json)

(defadvice js2-reparse (before json)
    (setq js2-buffer-file-name buffer-file-name))
(ad-activate 'js2-reparse)

(defadvice js2-parse-statement (around json)
    (if (and (= tt js2-LC)
           js2-buffer-file-name
           (or js2-parse-as-json
               (string-equal (substring js2-buffer-file-name -5) ".json"))
           (eq (+ (save-excursion
                    (goto-char (point-min))
                    (back-to-indentation)
                    (while (eolp)
                      (next-line)
                      (back-to-indentation))
                    (point)) 1) js2-ts-cursor))
      (setq ad-return-value (js2-parse-assign-expr))
        ad-do-it))
(ad-activate 'js2-parse-statement)

(define-derived-mode json-mode js2-mode "JSON"
  "Major mode for editing JSON data."
  :group 'json
  (setq js2-parse-as-json t)
  (js2-reparse t))

(add-to-list 'auto-mode-alist '("\\.json$" . json-mode)) 
```

如果你已经使用 js2-mode，这可能是一个比`js-mode`plus更好的选择，`flymake-json`因为你不需要安装任何新的东西（js2-mode 已经做了语法检查，不需要外部工具），并且因为这个模式将继承你的 js2-mode配置，js-mode 不会。

* * *

## 回答 #12

> 赞同：-7
> 
> 时间：2009-01-14T14:45:25.040

我也会推荐 js2-mode。

JSON 代表 JavaScript 对象表示法。它不是另一种语言，甚至不是像 yaml 或 xml 这样的数据容器。如果 JSON 对象内没有函数（或者在这种情况下我们应该说方法），则 JSON 可以用作数据容器，但这不是 JSON 的主要目标 :-)

```
var myJSObject = {
  attr: {foo: "bar", baz: ["quux", "truc", "pouet"]},
  fooAlert: function (num) {
    alert(this.attr.foo+' '+num);
  }
};
myJSObject.fooAlert(42); 
```

# asp.net - 在 ASP.NET Web 表单中使用纯 html 控件表单发布值

> ID：435853
> 
> 赞同：7
> 
> 时间：2009-01-12T15:55:45.197
> 
> 标签：asp.net, html, webforms

我有一个简单的表单，其中包含一些普通的 html 输入，例如使用 ASP.NET Web 表单（不是 MVC）的波纹管

```
<table id="tbl_SchoolDetails">
    <tbody id="tbody_SchoolDetails">
        <tr>
            <td>
            School Name
        </td>
        <td>
            <input id="SchoolDetails_SchoolName" type="text" value="<%= ViewModel.School.Name %>" />
        </td>
    </tr>
    <tr>
        <td>
            Head Teacher
        </td>
        <td>
            <input id="SchoolDetails_HeadTeacher_Name" type="text" value="<%= ViewModel.School.HeadTeacher.Name %>" />
        </td>
    </tr>
    <tr>
        <td>
            Head Teacher Email
        </td>
        <td>
            <input id="SchoolDetails_HeadTeacher_Email" type="text" value="<%= ViewModel.School.HeadTeacher.Email %>" />
        </td>
    </tr>
    <tr>
        <td>
            Regent/Placement Contact
        </td>
        <td>
            <input id="SchoolDetails_Regent_Name" type="text" value="<%= ViewModel.School.Regent.Name %>" />
        </td>
    </tr>
</tbody>
</table> 
```

当我发回服务器时，文本框的值不包含在 Request.Form 元素中。我想念这个有什么原因吗？我不愿意使用 asp.net 控件，因为该页面稍后将需要大量的 javascript 来更改 ui 和其他内容。

我知道我可以使用 MVC 轻松地做到这一点，但不幸的是，目前无法对此进行更改。

干杯科林 G

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-12T16:14:00.493

给输入一个 id 和一个名字，看看这是否不能解决你的问题。

```
<input id="SchoolDetails_SchoolName"
       name="SchoolDetails_SchoolName"
       type="text"
       value="<%= ViewModel.School.Name %>" /> 
```

id 属性仅标识 DOM 中的标记。[name 属性](http://www.w3.org/TR/REC-html40/interact/forms.html#h-17.4)允许将标记作为表单的一部分回发。ASP.NET 控件或带有 的 HTML 元素`runat=server`会自动获取分配的 name 和 id 属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T15:58:54.457

HTML 元素不是 ASP.NET 生命周期的一部分。一个简单的开始方法是将 runat="server" 属性添加到您的 INPUT 元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T13:13:21.123

@tvanfosson 干杯，正如我所愿。

@Bullins 我真的不想使用 runat="server" 因为它会导致控件的 ID 最终像 ctl00_ContentPlaceHolder1_ctl00_SchoolDetails_Address_Postcode 这使得很难实现我正在寻找的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-19T10:01:26.827

@Colin Use`ClientIDMode="Static"`属性和您的服务器端元素名称将在客户端保持相同，即使您在元素上有 runat="server" 也是如此。希望这可以帮助

# iphone - 翻转过渡需要时间

> ID：435875
> 
> 赞同：0
> 
> 时间：2009-01-12T16:00:51.223
> 
> 标签：iphone

我正在使用 iPhone SDK 提供的 TheElements 示例代码中的示例来实现 2 个视图之间的翻转过渡。从第一个视图到第二个视图的转换不如从第二个视图到第一个视图那样响应迅速。我不确定为什么会这样。过渡确实发生了，但需要的时间几乎是应有的两倍。

我厌倦了将我的代码与 TheElements 中的代码进行比较，并且在过渡部分看不出太大的差异。有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T19:13:24.580

它可以是任意数量的东西，但我建议你从你的`viewWillAppear:`and `viewDidAppear`: 方法以及`viewWillDisappear`: and开始`viewDidDisappear:`。

您很可能正在做一些处理器密集型的事情，这会导致速度变慢。

# perl - 有 PDF 文件的测试套件吗？

> ID：435876
> 
> 赞同：8
> 
> 时间：2009-01-12T16:01:08.320
> 
> 标签：perl, testing, pdf, automated-tests

是否有用于 PDF 的测试套件，最好是在 Perl 中？我想要的是一些功能来测试 PDF 文件中某些文本的定位和存在（如果可能的话，还有一个图形的名称）。这在理论上可以使用 PDF 标记吗？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T16:50:12.217

我认为 CPAN 上没有预先构建任何东西，但 Test::Builder 和[CAM::PDF](http://search.cpan.org/~cdolan/CAM-PDF-1.52/lib/CAM/PDF.pm#Document_reading)应该允许您编写您想要的内容。

一旦你得到它的工作，将它上传到 CPAN ......然后会有*一种*方法来测试 CPAN 上的 PDF :)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T04:58:19.373

正如 jrockway 所说，目前还没有 100% 的解决方案可用。使用我的[CAM::PDF](http://search.cpan.org/dist/CAM-PDF/)库，您可以计算文档中任何元素的位置。[请参阅我对“如何从 pdf 文档中获取字符偏移信息？”的](https://stackoverflow.com/questions/196788/how-do-i-get-character-offset-information-from-a-pdf-document)回答。它显示了如何提取页面上所有文本的坐标。

# workflow-foundation - 您是否在现实世界的 Web 应用程序中成功采用了 Windows Workflow？

> ID：435878
> 
> 赞同：18
> 
> 时间：2009-01-12T16:01:34.763
> 
> 标签：workflow-foundation

我最近发布了一个关于在 Web 应用程序中运行的 Windows 工作流的问题。当然，这是一个相当技术性的问题，其中包含诸如 ManualWorkflowSchedulerService、HandleExtrenalEvent 等术语……在 20 天的时间里，它获得了大约 15 次浏览。

虽然很可能是我没有以正确的方式提出问题，但它让我开始思考在现实世界的应用程序中采用 Windows 工作流，尤其是在 Web 应用程序中。

您是否使用 WF 成功实现了现实世界的互联网应用程序，回首过去，您的时间（金钱）投资是否得到回报？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-14T12:40:10.097

我们使用状态机工作流来管理几个服务请求流程，每个流程大约有 10 个状态。我不确定这是否是 100% 正确的选择，因为实现一个简单的状态机设计会更简单（也许我们在这里遇到了 BDUF）。

对我们来说最大的缺点是学习曲线。我的意思是，工作流程实际上是 biztalk 的精简版（免费！）。

在我的脑海中，这些是我们从 WF 中受益的领域：

*   将工作流作为服务托管迫使我们将工作流与其他层分离，而这（到目前为止）是一个相当不错的设计。
*   我们已经能够使用提供的工作流服务主机轻松地与来自各种应用程序的工作流进行交互
*   跟踪服务提供良好的业务指标
*   运行时服务和持久化服务稳定
*   更改运行的工作流程很复杂，但比我们自己尝试做的效果更好

我总是试图记住它确实是一个基础。作为开发人员/架构师，您必须致力于在其之上构建有用的东西。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T16:15:00.133

我在一个 Web 应用程序中使用了 Windows Workflow，该应用程序旨在管理企业系统中变更控制请求的生命周期。诚然，我在其中摸索过，肯定没有正确地做很多事情，但它工作得很好，我很满意我可以轻松地更改规则而无需编写更多代码。

然而，一旦我放弃了这个项目，继承它的人决定他不喜欢 WF 或者不想学习它，所以应用程序死了，他们又回到使用电子邮件和电话。所以实施是成功的，但投资最终是浪费。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T17:39:12.963

嗨，汤姆，我真的不认为 WF 在我们使用 Web 应用程序时表现得很好，因为我们很可能会使用 DB 来保持状态，您已经确切地问了我心中的问题，我们在生产环境中使用了 WF 并且它提供了很多当我们从一个版本升级到另一个版本时出现问题其次它有很多限制，即它不支持环境事务我认为我们应该等待版本 4 或 5 看看它是否有更好的提供

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T16:23:29.710

我的经验与 Out Into Space 类似，我们曾研究过在各种 B2B 场景中使用 WF 来控制复杂多样的订购流程。最后我听说他们正在清理它。

我认为许多开发人员很难从工作流程的角度来思考。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T13:18:51.143

我已经部署了 3 个应用程序。2 个是 ASP.NET 应用程序，其中 1 个工作流部署到 ​​SharePoint 环境。回想起来，我认为投资是值得的。就像前面的人说的，WF 是一个你必须建立在其上的框架。这是需要担心的一层，但收益大于成本。

# c# - 在没有自定义类型的绑定字段上显示连接值？

> ID：435880
> 
> 赞同：2
> 
> 时间：2009-01-12T16:01:50.347
> 
> 标签：c#, asp.net, linq

我有一个绑定到`ICollection<UserAnswer>`需要显示两列的 GridView：

```
<asp:GridView ID="UserAnswersGridView" runat="server">
    <Columns>
         <asp:BoundField DataField="Question.Name" HeaderText="Question Name" SortExpression="QuestionID" />
         <asp:BoundField DataField="Score" HeaderText="Score" SortExpression="Score" />
    </Columns>
</asp:GridView> 
```

但我得到了错误：

> 在所选数据源中找不到名为“Question.Name”的字段或属性。

每个`UserAnswer`都有一个`QuestionId`值，这是我用来查询问题名称的值。在代码中，我只会调用`userAssessment.Question.Name`，但是如何在不创建新类型的情况下使用 GridView 中的绑定列来执行此操作？

作为参考，这是返回数据的方法：

```
public static ICollection<UserAnswer> GetUserAnswers(Int32 userAssessmentId)
{
    DataContext database = new DataContext(GetConnectionString());
    return database.UserAnswers.Where(u => u.UserAssessmentId == userAssessmentId).ToList();
} 
```

对不起，如果这个解释不是很清楚！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T16:08:35.280

我相信`GridView`它只支持立即类型的属性。中继器或类似的东西是一种选择吗？这为您提供了更大的灵活性。

或者，您可以通过部分类将 shim 属性添加到类型：

```
namespace YourLinqNamespace {
    partial class UserAnswer {
        public string QuestionName {get {return Question.Name;}}
    }
} 
```

您不能在过滤器（`Where`等）中使用它，但您应该能够在返回的对象上使用它而不会出现问题。请注意，您可能希望使用`LoadWith`来保存往返：

```
DataLoadOptions options = new DataLoadOptions();
options.LoadWith<UserAnswer>(x=>x.Question);
database.LoadOptions = options; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T16:17:33.437

您还可以使用 ItemDataBoundEvent 在后面的代码中设置字段。或者您可以使用匿名类型，这有点像 Marc 的 shim 属性概念，但您不会修改域模型。

```
 from u in database.UserAnswers
 Where u.UserAssessmentId == userAssessmentId
 select new { QuestionName=u.Question.Name,
              Answer = u.Answer
              //etc etc
            }; 
```

正如 Marc 指出的那样，您不应该从方法返回 Anonymous 类型，我在手动绑定到数据源时使用了技巧，因此：

myGrid.DataSource=来自你等......

在我看来，使用我的第一个建议更好，并在项目数据绑定事件中处理它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T17:01:48.993

像 Marc Gravell 一样，我几乎总是会为这些情况创建 shim 属性。另一种选择是使用模板列而不是绑定列，但这实际上取决于您的情况：

```
<asp:TemplateField HeaderText="Question Name">
  <ItemTemplate>
    <%# Eval("Question.Name") %>
  </ItemTemplate>
</asp:TemplateField> 
```

# visual-studio - 为什么 Visual Studios 安装程序不选择依赖项

> ID：435885
> 
> 赞同：5
> 
> 时间：2009-01-12T16:04:01.263
> 
> 标签：visual-studio, installation, dependencies

我正在使用 Visual Studio 2005。我有一个用 C# 编写的程序。当我创建安装程序然后添加主输出时，它没有获取任何依赖项。甚至没有.Net。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T16:25:22.967

我解决了自己的问题，但我想我会发布“修复”，以防其他任何人遇到问题。我回到我的主项目>引用并删除了对其他项目的引用。然后我右键单击其他每个项目并将它们删除。我将它们全部添加回来并重建了项目。然后我右键单击安装程序中的“检测到的依赖项”文件夹并点击刷新依赖项，它都检测到了它们

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T16:26:56.177

如果您想在您的设置中安装 .NET Framework，您应该在设置和部署项目的属性页上的“先决条件”下添加它。

然后创建的引导程序（即 setup.exe 文件）将检查目标系统上是否存在指定版本的 .NET Framework 并根据需要进行安装。

请注意，此检查仅由 setup.exe 文件完成，而不是在用户双击 msi 文件时完成。原因是 Windows 安装程序不允许一个 msi 文件（您的安装程序）启动另一个 msi 安装（例如 .NET Framework 安装）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T16:07:27.700

尝试构建您的安装程序，它可能会在那时添加依赖项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-26T07:39:35.197

您的依赖 dll 必须在 windows 的二进制搜索路径中。也就是说 PATH=/path/to/dll 必须在环境中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-15T11:17:40.197

以防万一它对某人有帮助...其他答案都不适合我...对我来说问题的原因似乎是我在一步中添加了“主要输出”和“内容文件”（在同时）...一旦我将它们都删除并单独添加它们就可以了。

即，一旦我删除了它们（“主要输出”和“内容文件”）并添加了“主要输出”，检测到的依赖项文件夹被正确填充，然后我继续添加“内容文件”。

# php - mysql_insert_id 似乎从来没有工作过

> ID：435886
> 
> 赞同：0
> 
> 时间：2009-01-12T16:04:11.683
> 
> 标签：php, mysql

我有以下代码：

```
$sql = "INSERT INTO table VALUES ('', ...)";
$result = mysql_query($sql, $link) or die(mysql_error());
$id = mysql_insert_id($result) or die('oops'); //mysql_error() instead of oops produces the same result
echo $id . "\nDone"; 
```

发生此插入的表具有一个自动增量字段，但是此输出的所有内容是：

> 完毕

难道我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-12T16:07:40.850

您不需要将 $result 传递给 mysql_insert_id 您应该传递 $link 变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T16:08:51.987

该[`mysql_insert_id()`函数](http://www.php.net/manual/en/function.mysql-insert-id.php)期望第一个参数是连接资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T16:08:46.730

执行 mysql_insert_id($link) 或 mysql_insert_id() 而不是 mysql_insert_id($result) 因为 mysql_insert_id 参数是 [resource $link_identifier]

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T16:13:44.443

你不需要传递任何东西，如果你这样做，你应该传递连接变量

# java - Find Java classes implementing an interface

> ID：435890
> 
> 赞同：132
> 
> 时间：2009-01-12T16:05:54.473
> 
> 标签：java, interface

Some time ago, I came across a piece of code, that used some piece of standard Java functionality to locate the classes that implemented a given interface. I know the functions were hidden in some non-logical place, but they could be used for other classes as the package name implied. Back then I did not need it, so I forgot about it, but now I do, and I can't seem to find the functions again. Where can these functions be found?

Edit: I'm not looking for any IDE functions or anything, but rather something that can be executed within the Java application.

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-01-12T16:16:53.733

Awhile ago, I put together a package for doing what you want, and more. (I needed it for a utility I was writing). It uses the [ASM](http://asm.objectweb.org/) library. You can use reflection, but ASM turned out to perform better.

I put my package in an open source library I have on my web site. The library is here: [http://software.clapper.org/javautil/](http://software.clapper.org/javautil/). You want to start with the with [ClassFinder](http://software.clapper.org/javautil/api/org/clapper/util/classutil/ClassFinder.html) class.

The utility I wrote it for is an RSS reader that I still use every day, so the code does tend to get exercised. I use ClassFinder to support a plug-in API in the RSS reader; on startup, it looks in a couple directory trees for jars and class files containing classes that implement a certain interface. It's a lot faster than you might expect.

The library is BSD-licensed, so you can safely bundle it with your code. Source is available.

If that's useful to you, help yourself.

Update: If you're using Scala, you might find [this library](http://software.clapper.org/classutil/) to be more Scala-friendly.

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2011-11-17T12:19:00.000

Spring can do this for you...

```
BeanDefinitionRegistry bdr = new SimpleBeanDefinitionRegistry();
ClassPathBeanDefinitionScanner s = new ClassPathBeanDefinitionScanner(bdr);

TypeFilter tf = new AssignableTypeFilter(CLASS_YOU_WANT.class);
s.addIncludeFilter(tf);
s.scan("package.you.want1", "package.you.want2");       
String[] beans = bdr.getBeanDefinitionNames(); 
```

N.B. The TypeFilter is important if you want the correct results! You can also use exclusion filters here instead.

The Scanner can be found in the spring-context jar, the registry in spring-beans, the type filter is in spring-core.

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2012-03-27T14:14:23.920

I really like the [reflections library](https://code.google.com/p/reflections/) for doing this.

It provides a lot of different types of scanners (`getTypesAnnotatedWith`, `getSubTypesOf`, etc), and it is dead simple to write or extend your own.

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2009-01-12T17:21:50.903

The code you are talking about sounds like [`ServiceLoader`,](http://java.sun.com/javase/6/docs/api/java/util/ServiceLoader.html) which was introduced in Java 6 to support a feature that has been defined since [Java 1.3](http://docs.oracle.com/javase/6/docs/technotes/guides/jar/jar.html#Service%20Provider) or earlier. For performance reasons, this is the recommended approach to find interface implementations at runtime; if you need support for this in an older version of Java, I hope that you'll find [my implementation](https://stackoverflow.com/questions/251336/is-something-similar-to-serviceloader-in-java-1-5#251691) helpful.

There are a couple of implementations of this in earlier versions of Java, but in the Sun packages, not in the core API (I think there are some classes internal to ImageIO that do this). As the code is simple, I'd recommend providing your own implementation rather than relying on non-standard Sun code which is subject to change.

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2011-04-29T12:08:03.423

**Package Level Annotations**

I know this question has already been answered a long time ago but another solution to this problem is to use Package Level Annotations.

While its pretty hard to go find all the classes in the JVM its actually pretty easy to browse the package hierarchy.

```
Package[] ps = Package.getPackages();
for (Package p : ps) {
  MyAno a = p.getAnnotation(MyAno.class)
  // Recursively descend
} 
```

Then just make your annotation have an argument of an array of Class. Then in your package-info.java for a particular package put the MyAno.

I'll add more details (code) if people are interested but most probably get the idea.

**MetaInf Service Loader**

To add to @erickson answer you can also use the service loader approach. Kohsuke has an awesome way of generating the the required META-INF stuff you need for the service loader approach:

[http://weblogs.java.net/blog/kohsuke/archive/2009/03/my_project_of_t.html](http://weblogs.java.net/blog/kohsuke/archive/2009/03/my_project_of_t.html)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-04-12T14:13:30.113

You could also use the Extensible Component Scanner (extcos: [http://sf.net/projects/extcos](http://sf.net/projects/extcos)) and search all classes implementing an interface like so:

```
Set<Class<? extends MyInterface>> classes = new HashSet<Class<? extends MyInterface>>();

ComponentScanner scanner = new ComponentScanner();
scanner.getClasses(new ComponentQuery() {
    @Override
    protected void query() {
        select().
        from("my.package1", "my.package2").
        andStore(thoseImplementing(MyInterface.class).into(classes)).
        returning(none());
    }
}); 
```

This works for classes on the file system, within jars and even for those on the JBoss virtual file system. It's further designed to work within standalone applications as well as within any web or application container.

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-12T16:24:48.430

In full generality, this functionality is impossible. The Java ClassLoader mechanism guarantees only the ability to ask for a class with a specific name (including pacakge), and the ClassLoader can supply a class, or it can state that it does not know that class.

Classes can be (and frequently are) loaded from remote servers, and they can even be constructed on the fly; it is not difficult at all to write a ClassLoader that returns a valid class that implements a given interface for *any* name you ask from it; a List of the classes that implement that interface would then be infinite in length.

In practice, the most common case is an `URLClassLoader` that looks for classes in a list of filesystem directories and JAR files. So what you need is to get the `URLClassLoader`, then iterate through those directories and archives, and for each class file you find in them, request the corresponding `Class` object and look through the return of its `getInterfaces()` method.

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-12T17:17:51.693

Obviously, Class.isAssignableFrom() tells you whether an *individual* class implements the given interface. So then the problem is getting the list of classes to test.

As far as I'm aware, there's no direct way from Java to ask the class loader for "the list of classes that you could *potentially* load". So you'll have to do this yourself by iterating through the visible jars, calling Class.forName() to load the class, then testing it.

However, it's a little easier if you just want to know classes implementing the given interface from those that have *actually* been loaded:

*   via the [Java Instrumentation](http://www.javamex.com/tutorials/memory/instrumentation.shtml) framework, you can call **Instrumentation.getAllLoadedClasses()**
*   via reflection, you can query the **ClassLoader.classes** field of a given ClassLoader.

If you use the instrumentation technique, then (as explained in the link) what happens is that your "agent" class is called essentially when the JVM starts up, and passed an Instrumentation object. At that point, you probably want to "save it for later" in a static field, and then have your main application code call it later on to get the list of loaded classes.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-12T16:23:05.953

If you were asking from the perspective of working this out with a running program then you need to look to the java.lang.* package. If you get a Class object, you can use the isAssignableFrom method to check if it is an interface of another Class.

There isn't a simple built in way of searching for these, tools like Eclipse build an index of this information.

If you don't have a specific list of Class objects to test you can look to the ClassLoader object, use the getPackages() method and build your own package hierarchy iterator.

Just a warning though that these methods and classes can be quite slow.

# java - 有没有办法在 JTree 中为多个根提供扩展器图标？

> ID：435892
> 
> 赞同：8
> 
> 时间：2009-01-12T16:06:41.103
> 
> 标签：java, jtree

我有一个具有多个“根”的 JTree（当然，我实际上有一个不可见的真正根和多个孩子）。

双击时节点展开和折叠，但没有可视指示表明您可以执行此操作，因为没有展开器图标。

由于默认情况下树是折叠的，因此情况变得更糟，但是扩展“根”并没有真正帮助，因为每个树都有很多孩子，而且看起来很混乱。

有没有办法显示扩展器图标*而不*使真正的（并且完全没有价值的）根可见？

欢迎任何其他使显示更清晰的建议。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-12T16:21:20.933

显示那些“扩展器图标”[`tree.setShowsRootHandles(true)`](http://java.sun.com/j2se/1.5.0/docs/api/javax/swing/JTree.html#setShowsRootHandles%28boolean%29)是一种[好方法](http://java.sun.com/docs/books/tutorial/uiswing/components/tree.html)吗？

> 树通常还执行一些特定于外观的绘画以指示节点之间的关系。您可以以有限的方式自定义这幅画。
> 
> *   首先，您可以使用`tree.setRootVisible(true)`显示根节点或 tree.setRootVisible(false) 来隐藏它。
> *   其次，您可以使用`tree.setShowsRootHandles(true)`请求**树的顶级节点——根节点（如果可见）或其子节点（如果不可见）——具有允许它们展开或折叠的句柄**。

还要检查您的[外观和感觉](http://coding.derkeiler.com/Archive/Java/comp.lang.java.gui/2007-08/msg00110.html)，以确定渲染器对您的树做了什么。

# java - 有没有人在java小程序中成功使用签名时间戳？

> ID：435912
> 
> 赞同：5
> 
> 时间：2009-01-12T16:11:42.027
> 
> 标签：java, security, applet

Java 1.5 添加了支持签名时间戳的[增强功能。](http://java.sun.com/j2se/1.5.0/docs/guide/security/time-of-signing.html)据我所知，这个想法是签名的 jar 文件不应该因为代码签名证书过期而变得无效，只要文件是在证书有效时签名的。理论上，这意味着我们不必每年在证书到期时重新签名和重新部署我们的应用程序。不幸的是，基于这两个论坛主题，实施中似乎存在问题：

[http://forums.sun.com/thread.jspa?threadID=744677](http://forums.sun.com/thread.jspa?threadID=744677)
[http://forums.sun.com/thread.jspa?threadID=5309004](http://forums.sun.com/thread.jspa?threadID=5309004)

我即将开始对此进行测试，但我想知道是否有人成功地做到了这一点，**而**不必在客户端上导入时间戳证书（这会破坏整个目的）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T16:06:53.207

不幸的是，这个功能在这个时候似乎完全没有价值。对 jar 文件进行签名时添加时间戳很容易，只需在`jarsigner`命令中添加此参数即可：

```
-tsa https://timestamp.geotrust.com/tsa 
```

这是 Thawte 时间戳服务器的 URL。不幸的是，Thawte 时间戳 CA 证书不包含在 Java 运行时的受信任 CA 证书列表中，因此它实际上毫无意义。也就是说，如果您在代码签名证书过期后加载小程序，您将看到“不受信任”警告对话框而不是“受信任”警告对话框。

[这里](http://wiki.cacert.org/wiki/JavaTimeStamping)发布了一种“解决方法”，但它通过在小程序本身中嵌入 Thawte 时间戳 CA 证书并`keytool`在客户端上运行以导入证书来工作。但是我看不出这是如何工作的，因为在此代码运行之前用户已经看到了签名代码对话框。

我会继续寻找解决方案，但我不抱希望。我无法想象为什么在这段时间之后 Java 运行时还没有包含可用的时间戳 CA 证书。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-02-03T14:39:07.400

Thawte TSA 根证书已添加到 Sun 的 6u10 和 5.0u18 的 JRE cacerts 文件中。

# web-services - 网页加载时间跟踪网站

> ID：435916
> 
> 赞同：2
> 
> 时间：2009-01-12T16:13:31.977
> 
> 标签：web-services

我想跟踪和分析用户系统上的网页加载时间。

我遇到了这篇文章[http://www.panalysis.com/tracking-webpage-load-times.php](http://www.panalysis.com/tracking-webpage-load-times.php)使用谷歌分析来跟踪页面，但它对我的需要来说太粗糙了。

是否有任何网站专门允许您使用嵌入网页中的 JavaScript 片段来跟踪页面加载时间？

理想情况下，代码片段如下所示：

```
var startTime = new Date();

// code to load the tracker

window.onload=function() {
  loadTimeTracker.sendData(<customer id>, document.path, new Date() - startTime)
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T16:23:00.633

[Gomez](http://www.gomez.com/)有一项服务，可以跟踪您的网站加载所需的时间。据我所知，它不使用任何 JavaScript。

另一个很好的资源是[http://webpagetest.org/](http://webpagetest.org/)。它允许您手动测试加载时间，但可以对您的页面进行大量分析。延迟、第一个字节的时间、资产、DNS 查找等。很棒的资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T16:25:51.063

您是否希望将数据发送回服务器？如果没有，有很多工具可以跟踪这类事情。我知道firefox的firebug扩展确实如此。

如果您希望将数据库发送到服务器，那么纯粹使用 javascript 将有一些缺点，因为它不包括页面呈现时间，只有从收到第一行 javascript 到页面完成加载的时间，这可能会扭曲您的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T23:49:49.450

[Jiffy](http://code.google.com/p/jiffy-web/)非常好用并且是开源的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T16:23:20.147

在您的页面上启用跟踪，这可能是分析您的页面加载时间的良好开端。

# c# - 可折叠的主细节gridview结构

> ID：435921
> 
> 赞同：5
> 
> 时间：2009-01-12T16:14:20.650
> 
> 标签：c#, asp.net, ajax, asp.net-ajax

我需要关于 ac# asp.net 项目的建议。我的客户希望通过具有主/详细结构的 gridview 对象查看一些报告。

主网格视图将被所有主数据填满，每行的第一个单元格上都有一个**+**图标（或按钮）。当用户单击此图标时，该主行的所有详细信息数据应显示在该主行下方，并带有折叠操作。

我可以处理数据库进程，但我无法弄清楚崩溃的部分。如何在 gridview 对象的特定行下放置一些额外的行？

提前致谢..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T18:40:12.753

[Matt Berseth](http://mattberseth.com/)有关于这种东西的最令人印象深刻的教程之一

到目前为止，它仅包含[28](http://mattberseth.com/blog/gridview/)个关于 GridView 的教程，以及来自其他 asp.net 控件的大量教程，以及与它们一起使用 jQuery。我确实从他那里学到了很多东西。我真的很喜欢他的工作，我只想和你分享这个，你实际上可能从他的代码中得到一些好的和专业的想法！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T16:31:17.760

有一篇带有可下载源代码的文章：

[GridView 内联主/明细记录显示](http://www.codeproject.com/KB/webforms/MasterDetail.aspx "GridView 内联主/明细记录显示")

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-13T19:28:58.137

谢谢，但它的更新或插入。相反，我发现该页面似乎更有效。

[GridView 控件，用于显示主子或主从数据，用 c#、asp.net 和 javascript 编写。](http://www.progtalk.com/ViewArticle.aspx?ArticleID=54)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-15T07:32:52.043

这是另一个不错的 CodeProject 博客。解释没有 JavaScript 的多级主/详细信息。

[http://www.codeproject.com/KB/aspnet/MultiNestMDGridview.aspx](http://www.codeproject.com/KB/aspnet/MultiNestMDGridview.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-22T00:21:15.240

这是我遇到过的最容易使用的控件：

[http://code.msdn.microsoft.com/CompleteGridView](http://code.msdn.microsoft.com/CompleteGridView)

# c# - 从 WPF ListBox 中删除所有左侧填充

> ID：435925
> 
> 赞同：27
> 
> 时间：2009-01-12T16:15:13.283
> 
> 标签：c#, wpf

WPF ListBox 控件中的每个项目似乎都有一些左填充。如何重新设计以删除所有填充？

![默认比较](https://liijba.blu.livefilestore.com/y1pCGMhr_GaDEKJd4JWaVbyA-zXDL_IaGHOYsXQBPYFlihFt_eVmW9DX1EucSipT3nMygvki6UIDga_YLowF7vNmQ/ListBoxPadding.png)

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-01-12T16:46:23.190

您还可以为`ListBoxItem`特定设置 s 的样式`ListBox`，如下所示：

```
<ListBox>
    <ListBox.ItemContainerStyle>
        <Style TargetType="ListBoxItem">
            <Setter Property="Padding" Value="0"/>
        </Style>
    </ListBox.ItemContainerStyle>
</ListBox> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T16:25:15.527

我不太确定为什么会发生这种情况（这似乎不是 ListBox 而是 ListBoxItem 的问题。如果将 LBI 的 Background 属性设置为红色或其他颜色，您可以看到它与左侧齐平LB的一侧。

一个快速的技巧是为按钮设置负边距： **Margin="-3 0 0 0"** 这可能会导致一些意想不到的副作用，但在视觉上可以工作......

*编辑* 快速检查确认 LBI 具有默认填充。你可以像这样关闭它：

```
<ListBoxItem Padding="0"><!-- content here k --></ListBoxItem> 
```

或者，您可以在 Window 的资源中添加一种样式，该样式将从项目中的所有 LBI 中删除（这可能是 pseudoxaml，但您明白了）：

```
<Style TargetType="ListBoxItem">
  <Setter Property="Padding" Value="0"/>
</Style> 
```

# .net - 任何人都可以推荐紧凑框架的 PDF 解决方案吗？

> ID：435927
> 
> 赞同：2
> 
> 时间：2009-01-12T16:15:45.763
> 
> 标签：.net, pdf, compact-framework, components

我们需要使用来自 PDA / 手机的信息生成 PDF 文档。我们无法将信息发送回服务器，因为需要立即获取信息，并且使用设备的工程师可能不在覆盖范围内。

那么，任何人都可以推荐一个用于生成 PDF 的 .NET 紧凑框架组件吗？

能不能也说说你对它的体验？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T16:18:51.530

像[PDF4NET 之](http://www.o2sol.com/pdf4net/products.htm)类的东西？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T16:22:05.003

你可以检查 iTextSharp

[iTextSharp](http://itextsharp.sourceforge.net/)

# objective-c - Objective-C 和 Cocoa 有什么区别？

> ID：435928
> 
> 赞同：41
> 
> 时间：2009-01-12T16:16:05.030
> 
> 标签：objective-c, cocoa

我只是在为 Mac 学习 Objective-C/Cocoa 编程。我一直在使用的所有教程、书籍、博客、播客等都将两者结合在一起。有没有一种简单的方法来区分哪些部分是普通的 Objective-C，哪些来自 Cocoa？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-01-12T16:24:09.320

Objective-C 是一门语言……它定义了所有的东西，比如定义对象的关键字、消息传递对象的语法等等。

Cocoa 是一个开发框架（它实际上是一个综合框架，结合了其他三个框架，Foundation、AppKit 和 CoreData）。

这些框架 (Cocoa) 定义了所有易于使用并与操作系统交互的对象，以及许多功能。例如，Cocoa 定义了`NSString`和之类的东西`NSObject`。Cocoa 目前可以与其他语言绑定一起使用，例如 python 或 ruby​​，过去也可以与 Java 一起使用。因此，如果您在 Java 中使用 Cocoa，您仍然会得到一个`NSString`对象，但您会在 Java 应用程序中调用和使用它。

在没有链接到任何 Cocoa 框架的情况下，Objective-C 仅带有一个非常基本的 Object 类作为预定义的根类。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-12T16:20:40.810

Objective-C 是语言本身。

Cocoa，以前称为 NextStep，是位于 Obj-C 之上的 API 和运行时。任何以 NS（用于 NextStep）开头的东西都是 Cocoa 的一部分，而不是语言的一部分。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-12T16:19:17.910

当然，这很容易——Objective-C 是语言，Cocoa 是您用来构建 Mac App 的 API/库。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-12T16:35:25.740

查看 /usr/include/objc/ — 里面有纯 Objective-C。其他一切都是可可。你可能会注意到你几乎从不直接使用那里的任何东西。

然而，在实践中它几乎没有什么区别。Cocoa 是事实上的 Objective-C 标准库。在没有 Cocoa 的情况下使用 Objective-C 的唯一平台是[Portable Object Compiler](http://users.telenet.be/stes/compiler.html)，我猜可能有三个人还在使用它。

# css - 通过自定义控件添加 css 时如何停止 Visual Studio css intellisense 中断

> ID：435943
> 
> 赞同：2
> 
> 时间：2009-01-12T16:20:57.157
> 
> 标签：css, visual-studio-2008, intellisense, custom-server-controls

我创建了一个简单的 Asp.Net 自定义控件，它自动组合所有正确的样式表以发送到客户端（基于浏览器类型/版本/等）。

但是，因为在设计时 head 标签看起来像这样......

```
<head>
    <cc:CssControl runat="server" />
</head> 
```

...VS 无法为 css 类名提供智能感知。我尝试为通过覆盖 GetDesignTimeHtml() 返回一些硬编码 <link /> 的控件创建一个 ControlDesigner，但这似乎也无济于事。

有人对此有任何想法吗？

谢谢，

西蒙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T16:27:06.910

这个 css 智能感知在用户控件中不起作用。我几乎已经尝试了一切来让它发挥作用。

但是您可以在用户控件中尝试它，就像我们在 UserControl 中包含 jquery intellisense 一样。我还没有尝试过。

```
<% if (false) { %>
<link rel="Stylesheet" href="style.css" type="text/css" />
<% } %> 
```

我希望它有效

# c# - Compact Framework - 检索国家和地区列表

> ID：435951
> 
> 赞同：3
> 
> 时间：2009-01-12T16:22:03.317
> 
> 标签：c#, .net, compact-framework, cultureinfo

下午的人！

我正在尝试在我的 Compact Framework（移动）应用程序上实现县列表。

我可以使用 CultureInfo.GetCultures(..etc) 在完整的 .Net 框架中轻松完成此操作。但是，CF似乎缺少了这个功能？

有什么方法可以返回可以填充到 ComboBox 中的国家（和地区）列表？

操作系统有一个国家列表，所以一定有办法吗？

我期待着回音！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T18:11:16.780

这个怎么样？

```
using System;
using System.Collections.Generic;
using System.Globalization;
using System.Runtime.InteropServices;

namespace OpenNETCF.Globalization
{
    public class CultureInfoHelper
    {
        private delegate int EnumLocalesHandler(string lpLocaleString);

        private static EnumLocalesHandler m_localesDelegate;

        private static List<CultureInfo> m_cultures;

        private static int EnumLocalesProc(string locale)
        {
            try
            {
                m_cultures.Add(CultureInfo.GetCultureInfo(
                    int.Parse(locale, NumberStyles.HexNumber)));
            }
            catch
            {
                // failed for this locale - ignore and continue
            }

            return 1;
        }

        public static CultureInfo[] GetCultures()
        {
            if (m_localesDelegate == null)
            {
                m_cultures = new List<CultureInfo>();
                m_localesDelegate = new EnumLocalesHandler(EnumLocalesProc);
                IntPtr fnPtr = Marshal.GetFunctionPointerForDelegate(
                    m_localesDelegate);
                int success = EnumSystemLocales(fnPtr, LCID_INSTALLED);
            }

            return m_cultures.ToArray();
        }

        private const int LCID_INSTALLED = 0x01;
        private const int LCID_SUPPORTED = 0x02;

        [DllImport("coredll", SetLastError = true)]
        private static extern int EnumSystemLocales(
            IntPtr lpLocaleEnumProc, uint dwFlags);
    }
} 
```

用法如下所示：

```
using OpenNETCF.Globalization;
....
static void Main()
{
    foreach (CultureInfo ci in CultureInfoHelper.GetCultures())
    {            
        Debug.WriteLine(string.Format("0x{0:x2}({1}) : {2}", ci.LCID, ci.Name, ci.EnglishName));
    }
} 
```

输出如下所示：

```
0x402(bg-BG) : Bulgarian (Bulgaria)
0x403(ca-ES) : Catalan (Catalan)
0x405(cs-CZ) : Czech (Czech Republic)
0x406(da-DK) : Danish (Denmark)
0x407(de-DE) : German (Germany)
0x408(el-GR) : Greek (Greece)
0x409(en-US) : English (United States)
...
0x400a(es-BO) : Spanish (Bolivia)
0x440a(es-SV) : Spanish (El Salvador)
0x480a(es-HN) : Spanish (Honduras)
0x4c0a(es-NI) : Spanish (Nicaragua)
0x500a(es-PR) : Spanish (Puerto Rico) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T16:59:50.963

不幸的是，.NET Compact Framework 不支持 CultureInfo.GetCultures 方法，但您可以通过检查 CultureType Enumeration 来遍历设备上的可用区域性。这是指向 MSDN 的[链接](http://msdn.microsoft.com/en-us/library/system.globalization.culturetypes.aspx)，其中包含一些解释和示例

# nunit - 使用 Nunit 进行单个测试的超时

> ID：435954
> 
> 赞同：1
> 
> 时间：2009-01-12T16:22:28.637
> 
> 标签：nunit

有没有办法在 ccnet 上执行的一堆测试中为单个测试实现超时选项。

Mbunit 和 MSTest 具有 [Timeout] 属性。

我正在 Nunit 中寻找类似的功能。

这是为了避免长时间运行的测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T16:26:45.290

您使用的是哪个版本的 nUnit？最新版本（2.5 Beta）有一个[Timeout](http://www.nunit.com/index.php?p=timeout&r=2.5)属性。

# iphone - 在 Xcode 之外为 iPhone 开发

> ID：435957
> 
> 赞同：9
> 
> 时间：2009-01-12T16:23:00.943
> 
> 标签：iphone

我想从命令行和我的个人编辑器开发和运行我的 iPhone 应用程序，而不必使用 Xcode。

到目前为止，我已经能够编辑 Emacs 中的所有文件并运行

```
xcodebuild
```

在项目中编译/链接/等。

下一步是创建一个 Makefile 任务来使用我当前的应用程序启动 iPhone 模拟器。关于我该怎么做的任何想法？

更新：我对调用我的编辑器的 XCode 不感兴趣，我只想尽可能地忘记 IDE。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-12T21:44:55.053

您需要做的就是将构建的 .app 从 XCode 放置到的任何位置复制到`~/Library/Application Support/iPhone Simulator/[some version]/Applications/[somefolder]/`.

然后，启动`/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/Applications/iOS Simulator.app`. 不知道如何让它启动一个特定的应用程序，但这会带你到主屏幕。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T22:06:41.687

另请注意，您可以将 XCode 设置为使用外部编辑器，即使对于源代码也是如此。在此设置中，您将打开 XCode 以查看显示构成项目的文件和其他项目的树视图，但是一旦您双击源代码文件，它将在例如 Emacs 中打开。

Mac Developer Network 上有一个截屏视频演示了这一点：[link](http://www.mac-developer-network.com/screencasts/xqt/xqt003/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-24T02:40:59.667

> > 我对此表示怀疑。如果你越狱你的手机并在上面安装 SSH，你可以设置一些东西来>>通过 wifi 复制 .​​app，但这是一项相当大的工作。– 诺亚威瑟斯彭 2009 年 1 月 13 日 5:24

我以这种方式完成了所有开始的 iphone 开发工作。只需对二进制可执行文件和您可能需要的任何其他文件（在您找到手机上的 App 文件夹后）进行 ssh 操作，实际上比从 xCode 安装应用程序要快得多。请注意，我没有运行调试器。

# apache2 - 在 LocationMatch 指令中使用否定

> ID：435959
> 
> 赞同：14
> 
> 时间：2009-01-12T16:23:05.953
> 
> 标签：apache2

我们的站点在 apache 上运行，并使用客户端证书进行保护。到目前为止，只有一个证书可以提供对整个站点的访问权限。现在，我们需要将 jira 公开给一组新用户，这些用户除了 jira 之外不能访问任何其他内容。我为该组创建了一个单独的证书，并计划使用 SSLRequire 和 Location/LocationMatch 组合来区分它们。

所以标准是：

1.  旧证书的用户可以访问完整的站点
2.  拥有新证书的用户只能访问 /jira URL 模式

我尝试了几种组合，但无法否定 LocationMatch 的工作。任何帮助，将不胜感激。

httpd.conf 文件如下所示：

```
SSLVerifyClient require
SSLVerifyDepth 1
SSLCACertificateFile /etc/apache2/ssl/myca.crt

<Location /jira> 
   SSLRequire   %{SSL_CLIENT_S_DN_CN} in {"AllUsers", "JiraUsers"}
</Location> 

<LocationMatch /!(jira)> 
   SSLRequire   %{SSL_CLIENT_S_DN_CN} eq "AllUsers"
</LocationMatch> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-08-24T18:53:29.007

apache 2.2 不支持负正则表达式

见[https://issues.apache.org/bugzilla/show_bug.cgi?id=10932](https://issues.apache.org/bugzilla/show_bug.cgi?id=10932)

我不知道它是否已在上一个 apache 版本中修复。

作为一种解决方法，使用：

```
<LocationMatch "/[^s][^t][^a][^t][^i][^c]">
</LocationMatch> 
```

或者

```
<LocationMatch "^/(?!static)">
</LocationMatch> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-11-15T01:23:08.997

试试这个：（感谢米洛斯的提示）

```
SSLVerifyClient require
SSLVerifyDepth 1
SSLCACertificateFile /etc/apache2/ssl/myca.crt

<Location /jira> 
   SSLRequire   %{SSL_CLIENT_S_DN_CN} in {"AllUsers", "JiraUsers"}
</Location> 

<LocationMatch "^/(?!jira)"> 
   SSLRequire   %{SSL_CLIENT_S_DN_CN} eq "AllUsers"
</LocationMatch> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-03-20T16:56:26.947

这可能很方便，使所有隐藏的文件/目录不可见（保护 .git、.htaccess 等...）并且仍然允许访问 /.well-known/ 可以安装在任何 apache 2.4 虚拟主机中或直接安装在 apache2.conf

因为我需要这个并且找不到现成的解决方案，所以就在这里。希望能帮助到你。

```
<LocationMatch "^/(?!\.well-known/)">
    RedirectMatch 404 ^(.*/)?\.
</LocationMatch> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-27T02:37:43.697

[Apache2 使用支持 perl5 RE 语法的 pcre，这可以使用http://perldoc.perl.org/perlre.html#Extended-Patterns](http://perldoc.perl.org/perlre.html#Extended-Patterns)中描述的负前瞻。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T20:10:16.163

这是正确使用正则表达式的问题。具有以下正则表达式的 LocationMatch 指令运行良好。

```
SSLVerifyClient require
SSLVerifyDepth 1
SSLCACertificateFile /etc/apache2/ssl/myca.crt

<Location /jira> 
   SSLRequire   %{SSL_CLIENT_S_DN_CN} in {"AllUsers", "JiraUsers"}
</Location> 

<LocationMatch ^/[a-ik-zA-IK-Z]> 
   SSLRequire   %{SSL_CLIENT_S_DN_CN} eq "AllUsers"
</LocationMatch> 
```

# sql - 如何在数据库表中查找重复条目？

> ID：435964
> 
> 赞同：25
> 
> 时间：2009-01-12T16:23:54.843
> 
> 标签：sql, postgresql

以下查询将显示在“book”表中重复的所有杜威十进制数：

```
SELECT dewey_number, 
 COUNT(dewey_number) AS NumOccurrences
FROM book
GROUP BY dewey_number
HAVING ( COUNT(dewey_number) > 1 ) 
```

但是，我想做的是让我的查询显示与重复条目关联的作者姓名（“book”表和“author”表由“author_id”连接）。换句话说，上面的查询将产生以下结果：

```
dewey_number | NumOccurrences
------------------------------
5000         | 2
9090         | 3 
```

我希望显示的结果类似于以下内容：

```
author_last_name | dewey_number | NumOccurrences
-------------------------------------------------
Smith            | 5000         | 2
Jones            | 5000         | 2
Jackson          | 9090         | 3
Johnson          | 9090         | 3
Jeffers          | 9090         | 3 
```

非常感谢您提供的任何帮助。而且，如果它发挥作用，我正在使用 Postgresql DB。

**更新**：请注意“author_last_name”不在“book”表中。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-12T16:30:05.127

嵌套查询可以完成这项工作。

```
SELECT author_last_name, dewey_number, NumOccurrences
FROM author INNER JOIN
     ( SELECT author_id, dewey_number,  COUNT(dewey_number) AS NumOccurrences
        FROM book
        GROUP BY author_id, dewey_number
        HAVING ( COUNT(dewey_number) > 1 ) ) AS duplicates
ON author.id = duplicates.author_id 
```

（我不知道这是否是实现你想要的最快的方法。）

更新：这是我的数据

```
SELECT * FROM author;
 id | author_last_name 
----+------------------
  1 | Fowler
  2 | Knuth
  3 | Lang

SELECT * FROM book;
 id | author_id | dewey_number |         title          
----+-----------+--------------+------------------------
  1 |         1 |          600 | Refactoring
  2 |         1 |          600 | Refactoring
  3 |         1 |          600 | Analysis Patterns
  4 |         2 |          600 | TAOCP vol. 1
  5 |         2 |          600 | TAOCP vol. 1
  6 |         2 |          600 | TAOCP vol. 2
  7 |         3 |          500 | Algebra
  8 |         3 |          500 | Undergraduate Analysis
  9 |         1 |          600 | Refactoring
 10 |         2 |          500 | Concrete Mathematics
 11 |         2 |          500 | Concrete Mathematics
 12 |         2 |          500 | Concrete Mathematics 
```

这是上述查询的结果：

```
 author_last_name | dewey_number | numoccurrences 
------------------+--------------+----------------
 Fowler           |          600 |              4
 Knuth            |          600 |              3
 Knuth            |          500 |              3
 Lang             |          500 |              2 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-12T16:25:46.883

你可能想要这个

```
SELECT dewey_number, author_last_name,
 COUNT(dewey_number) AS NumOccurrences
FROM book
GROUP BY dewey_number,author_last_name
HAVING ( COUNT(dewey_number) > 1 ) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T16:30:12.070

```
SELECT dewey_number, author_last_name,
       COUNT(dewey_number) AS NumOccurrences
FROM book
JOIN author USING (author_id)
GROUP BY dewey_number,author_last_name
HAVING COUNT(dewey_number) > 1 
```

如果 book.author_id 可以为空，则将连接更改为：

```
LEFT OUTER JOIN author USING (author_id) 
```

如果 author_id 列在每个表中具有不同的名称，则不能使用 USING，请改用 ON：

```
JOIN author ON author.id = book.author_id 
```

或者

```
LEFT OUTER JOIN author ON author.id = book.author_id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-10T18:17:28.593

```
select author_name,dewey_number,Num_of_occur
from author a,(select author_id,dewey_number,count(dewey_number) Num_of_occur
                from   book
                group by author_id,dewey_number
                having count(dewey_number) > 1) dup
where a.author_id = dup.author_id 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-30T14:12:38.330

我发现的最简单有效的方法如下所示：

```
SELECT
    p.id
    , p.full_name
    , (SELECT count(id) FROM tbl_documents as t where t.person_id = p.id) as rows
FROM tbl_people as p
WHERE 
    p.id 
IN (SELECT d.person_id FROM tbl_documents as d 
    GROUP BY d.person_id HAVING count(d.id) > 1) 
ORDER BY 
    p.full_name 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-05-21T08:53:31.293

```
select * from author
dewey_number    author_last_name
1   Ramu
2   Rajes
1   Samy
1   Ramu

select * from book
authorid    dewey_number
1   1
2   1

select a.dewey_number,a.author_last_name,count(a.dewey_number) from author a
where a.dewey_number in (
select b.dewey_number from book b )
group by a.dewey_number,a.author_last_name

dewey_number    author_last_name    (No column name)
1   Ramu    2
1   Samy    1 
```

# java - 如何使用 Netbeans 6.5 将文件添加到 jar？

> ID：435971
> 
> 赞同：2
> 
> 时间：2009-01-12T16:25:36.103
> 
> 标签：java, netbeans6.5

我第一次使用 Netbeans 开发一个 Java 项目。我想使用 Netbeans 6.5 创建一个包含大约 50 个文本文件的 jar。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T16:31:52.423

您需要在驱动器上找到项目目录。然后将所有 50 个文本文件放入**src**文件夹。回到 Netbeans。您现在应该在源代码包下看到您的文本文件。然后**构建**项目。您新创建的 JAR 应该在项目目录的**dist**文件夹中。

**编辑：**这是从“默认”包中的文本文件读取的示例源代码。文件名为“hello.txt”。

```
package testtextfile;

import java.io.InputStream;
import java.util.Scanner;
import javax.swing.JLabel;
import javax.swing.JOptionPane;

public class Main {

    public static void main(String[] args) {
        InputStream s = Main.class.getClassLoader().getResourceAsStream("hello.txt");
        Scanner sc = new Scanner(s);
        sc.useDelimiter("\\Z"); // read to the end of file. all at one.
        String contents = sc.next();
        JOptionPane.showMessageDialog(null, new JLabel(contents));
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T16:29:00.073

如果您熟悉 ant，ant 可以做到这一点，而 Netbeans 可以运行 ant 脚本。

# sql - 如何在 SQL Server (2005) 中查找 WITH RECOMPILE 元数据？

> ID：435980
> 
> 赞同：4
> 
> 时间：2009-01-12T16:27:33.477
> 
> 标签：sql, sql-server, metadata

如何在 INFORMATION_SCHEMA、sys.objects 或其他元数据中找到哪些 SP 被声明为 WITH RECOMPILE？

（我正在向我的系统健康监控中添加一些代码，并希望对那些以这种方式声明的不合理的代码发出警告。）

**注意：我不是在寻找“WITH RECOMPILE”的一般文本搜索 - 我已经可以做到这一点，但它会对文本的任何注释或文字版本给出误报。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T16:39:11.160

对于一种快速而肮脏的方式，我会使用：

```
SELECT
     o.name
FROM
     syscomments c
INNER JOIN sys.objects o ON
     o.object_id = c.id
WHERE
     c.text LIKE '%WITH RECOMPILE%' 
```

不过，这对于在实际应用程序中使用可能不是一个好主意。如果我有几分钟的时间，我会尝试挖掘一种更清洁的方法。上面还将捕获已注释掉该字符串的过程，它使用 MS SQL Server 特定表 syscomments 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T16:44:21.307

这是我使用的查询，它将为任何给定的搜索字符串搜索用户定义的视图、存储过程和函数：

```
DECLARE @strSearch varchar(50)
SELECT @strSearch = 'my search string'

SELECT
    so.[Name],
    OBJECT_ID(so.[Name])    
FROM
    [sysobjects] so
JOIN
    syscomments sc
ON
    sc.[ID] = OBJECT_ID(so.[Name])
WHERE 
    (so.[xtype] = 'FN' OR so.[xtype] = 'P' OR so.[xtype] = 'V') AND
    so.[category] = 0 AND
    sc.encrypted = 0 AND
    sc.[text] like '%' + @strSearch + '%' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T20:19:54.040

感谢[SQL Server Central Forums](http://www.sqlservercentral.com/Forums/Topic634987-338-1.aspx)上的[GSquared](http://www.sqlservercentral.com/Forums/UserInfo480409.aspx)，我找到了它，有一个名为in的标志。`is_recompiled``sys.sql_modules`

# asp.net - 有没有办法禁用 .NET 浏览器检测？

> ID：435989
> 
> 赞同：7
> 
> 时间：2009-01-12T16:29:47.327
> 
> 标签：asp.net, browser, .net-2.0

我没有找到禁用asp.net 2.0 添加的浏览器检测功能的方法。
我希望对我的页面的**所有**请求都被视为 IE 正在请求它们。
我的解决方法是在我的项目中添加一个 App_Browsers 文件夹，其中包含以下 .browser 文件：

```
<browsers>
  <browser refID="Default">
    <capabilities>
      <capability name="preferredRenderingMime" value="text/html" />
      <capability name="preferredRenderingType" value="html32" />
      <capability name="requiresFullyQualifiedRedirectUrl" value="false" />
    </capabilities>
  </browser>
</browsers> 
```

有没有办法完全关闭这个功能？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T16:47:14.373

恕我直言，ASP.Net 中更具攻击性的部分之一。除了像这样的配置之外，没有办法将其关闭 AFAIK。

您可能对[Rob Eberhardt](http://slingfive.com/pages/code/browserCaps/)关于该主题的资源池感兴趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T02:32:13.057

[您可以通过将页面上的ClientTarget 属性](http://msdn.microsoft.com/en-us/library/x3k2ssx2.aspx)设置为您希望它做出的选择来覆盖浏览器检测（在您的情况下可能是**上级**）...

# ruby-on-rails - 当实际与预期相同时，为什么这个简单的 Rails 单元测试会失败？

> ID：435993
> 
> 赞同：2
> 
> 时间：2009-01-12T16:30:13.987
> 
> 标签：ruby-on-rails, ruby, unit-testing, testing

我有一个非常简单的单元测试。我不确定为什么当预期与实际相同时它会失败！

这是我正在测试的方法：

```
def calibration_constant
  big_decimal = self.coefficient * (10**self.exponent)
  return big_decimal.to_f
end 
```

请注意，该系数为“6.1”，指数为“1”

这是相关的测试行：

```
assert_equal(61.0.to_f, calibrations[0].calibration_constant) 
```

这是输出：

*test_calibration_constants(PyranometerCalibrationTest): <61.0> 预期但为 <61.0>。*

我一生都无法弄清楚为什么它会声称失败，而显然它们是平等的。有人对这种情况有任何意见吗？我所有其他类似的测试用例都可以正常工作。

我在带有 SQL Server 2005 的 Windows 上使用 Rails 2.1 (Ruby 1.8)。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-12T16:37:20.680

您正在比较两个浮点数。尝试使用具有非常低的增量值（0.000001）的[assert_in_delta](http://www.ruby-doc.org/stdlib/libdoc/test/unit/rdoc/classes/Test/Unit/Assertions.html#M004525)来查看您的问题是否只是精度错误。

# c# - 将事件从存储过程引发到 Windows 服务

> ID：435996
> 
> 赞同：1
> 
> 时间：2009-01-12T16:31:05.797
> 
> 标签：c#, sql-server, clr

是否可以在 Windows 服务中触发操作，或者是否可以从存储过程中引发可以在服务中捕获的事件。

如果您想象一项服务每 5 分钟运行一次，那将执行一些操作。如果数据库中发生了某些事情或执行了存储过程，并且我想在 5 分钟之前触发此操作，该怎么办。

有人有什么想法吗？

谢谢

埃德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T16:48:22.377

听起来您根本不应该使用 Windows 服务。我会设置一个 SQL 作业每 5 分钟运行一次，然后设置一个触发器或任何您希望发生的任何事情，以便在必要时手动运行该作业。

编辑：但是，如果服务在数据库之外执行某些操作，您可以使用 xp_cmdshell 运行系统命令（虽然不是最佳选择）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T16:35:03.090

您可以在 SQL Server 中创建一个 CLR 过程，该过程以某种方式使用 SOAP、Remoting 或任何媒介与服务进行通信。不过这是通用的。我认为 SQL Server 2005 的查询通知功能在这里会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T16:36:52.460

如果您执行 raiserror(@ErrorMessage,16,1)，只要您使用 16 和 1 的严重性和状态，它就应该在客户端生成异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T10:07:35.253

根据 Mehrdad 的评论，我能够使用 .NET 框架中的 SqlDependancy 类解决问题。

此类允许您注册 SQL 查询并与之连接，当该查询的结果发生更改时，将引发一个事件以指示数据的更改。

这让我几乎可以立即捕捉到数据变化并进行适当的处​​理。

为了使用这个类，您需要在要查询的数据库上启用查询通知，请参阅：[启用查询通知](http://msdn.microsoft.com/en-us/library/ms172133(VS.80).aspx)

[在这里](http://msdn.microsoft.com/en-us/library/a52dhwx7(VS.80).aspx)可以找到如何在 Windows 应用程序中使用此类的一个很好的示例。*********