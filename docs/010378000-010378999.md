# StackOverflow 问答 10378000-10378999

# javascript - 查找包含 .myClass 的最近的先前兄弟

> ID：10378000
> 
> 赞同：3
> 
> 时间：2012-04-30T02:58:14.917
> 
> 标签：javascript, jquery

我有一堆，`<tr>`其中一些包含`<td>`有`class="myClass"`但有些没有。所以它看起来像这样。

```
<tr>
<td class="myClass"></td>
<td></td>
</tr>

<tr>
<td></td>
<td></td>
</tr> 
```

如果我在 a `<tr>`，我如何排成一行，直到我碰到最近的包含 a 的行`td.myClass`？有没有聪明的方法来做到这一点？我现在拥有的是一个检查 prev() 的 while 循环，如果它找到 .myClass，它就会中断。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T03:05:30.433

```
$currentTr.prevAll(':has(td.myClass)').first() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T04:36:30.473

这是另一种方法，可以找到与 myClass 类名最接近的 td。如果你想要 tr，你可以简单地获取它找到的父项：

```
var td$ = $("#myTable td.myClass");
$("#myTable td").click(function() {
    td$.removeClass("found");
    var temp$ = td$.add(this);
    var i = temp$.index(this);
    if (i > 0) {
        temp$.eq(i - 1).addClass("found");
    }
}); 
```

这会得到一个带有 myClass 的所有 td 的列表。然后它将单击的元素添加到该 jQuery 对象（添加后 jQuery 会将其排序为 DOM 顺序）。然后它会在该 jQuery 对象中找到被点击元素的索引，如果它不是第一个项目，它只会获取它之前的项目，这将是表中最接近的 td.myClass 对象。

工作 jsFiddle：http: [//jsfiddle.net/jfriend00/XqLzb/](http://jsfiddle.net/jfriend00/XqLzb/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T03:51:41.450

这是一个工作示例，不是很好，但是可以。[http://jsfiddle.net/H2k8m/2/](http://jsfiddle.net/H2k8m/2/)
1) 带有“color”类的 td 将被选中。
2）您可以使用它，也可以直接将所选对象分配给某个变量并在函数外部使用它。

HTML：

```
 <table>
        <tr>
        <td class="myClass">Hi</td>
        <td>world</td>
        </tr>

        <tr>
        <td class="myClass">1</td>
        <td class="myClass" >2</td>
        </tr>

        <tr>
        <td>3</td>
        <td>4</td>
        </tr>

        <tr>
        <td>5</td>
        <td>6</td>
        </tr>
</table> 
```

CSS：

```
.color {
    background: #000;
    color: #fff;
}

table {
    cursor: pointer;
}

tr, td {
    min-width: 50px;
    border: 1px #000 solid;
    padding: 5px;
    text-align: center;
} 
```

查询：

```
$(document).ready(function()
{
    $("table tr td").click(function() {
        if( $(this).prevAll('[class="myClass"]').length <= 0 ) {
            var parents = $(this).parent().siblings();
            for( i = $(this).parent().index(); i >= 0; i-- ) {
                parents.eq( i ).find(".myClass").last().addClass("color");
                if( parents.eq( i ).find(".myClass").length > 0) {
                    break;
                }
            }
         }
        else {
            $(this).prevAll('[class="myClass"]').first().addClass("color");
        }

    });

}); 
```

# ios - bytesWritten，但其他设备从未收到 NSStreamEventHasBytesAvailable 事件

> ID：10378001
> 
> 赞同：5
> 
> 时间：2012-04-30T02:58:18.320
> 
> 标签：ios, cocoa, bonjour, nsstream

我已经在 iPhone 和 Mac 之间建立了 Bonjour 网络。

用户在 Mac 中呈现的一个表格中选择 iPhone 的网络服务，并在两侧创建并打开一对流。

iPhone 首先向 Mac 发送一个代码（一个整数）。Mac 成功接收到它。

在暂停用户输入和处理后，Mac 开始向 iPhone 发送代码：

```
NSInteger bytesWritten = [self.streamOut write:buffer maxLength:sizeof(uint8_t)];
// bytesWritten is 1. 
```

但是 iPhone 永远不会收到 NSStreamEventHasBytesAvailable 事件。在此之前我仔细检查过，iPhone 的 NSInputStream 上的 streamStatus 是 2，应该是 NSStreamStatusOpen。

有什么想法可能是错的吗？

* * *

更新：我进行了一个测试，其中 Mac 是第一个向 iPhone 发送整数的。同样，我从 Mac 的输出流中得到了 1 的 bytesWritten，但 iPhone 从未得到 NSStreamEventHasBytesAvailable 事件。

所以iPhone的输入流一定有问题。但我仔细检查了：

*   iPhone 的 self.streamIn 在 h 文件中正确键入为 NSInputStream
*   iPhone 收到 2 个 NSStreamEventOpenCompleted 事件，我检查了流 arg 的类。一个是KindOfClass:[NSOutputStream 类]，另一个不是。
*   iPhone 永远不会收到 NSStreamEventEndEncountered、NSStreamEventErrorOccurred 或 NSStreamEventNone。
*   如上所述，在 Mac 写入输出流之后，iPhone 的输入流状态为 2，NSStreamStatusOpen。

这是用于创建 iPhone 输入流的代码。它使用 CF 类型，因为它是在 C 风格的套接字回调函数中完成的：

```
CFReadStreamRef readStream = NULL;
CFStreamCreatePairWithSocket(kCFAllocatorDefault, socketNativeHandle, &readStream, NULL);
if (readStream) {
    CFReadStreamSetProperty(readStream, kCFStreamPropertyShouldCloseNativeSocket, kCFBooleanTrue);
    server.streamIn = (NSInputStream *)readStream;
    server.streamIn.delegate = server;
    [server.streamIn scheduleInRunLoop:[NSRunLoop currentRunLoop] 
                               forMode:NSDefaultRunLoopMode];
    if ([server.streamIn streamStatus] == NSStreamStatusNotOpen)
        [server.streamIn open];
    CFRelease(readStream);
} 
```

* * *

更新2：响应阿拉斯泰尔评论的信息：

**套接字选项**

保留、释放和复制描述回调设置为 NULL。optionFlags 设置为acceptCallback。

**套接字创建**

这是用于在 iPhone 和 Mac 上设置套接字的方法，并附有我评论过的试图弄清楚此代码中实际发生的情况，该方法改编自各种教程和实验（有效）：

```
/**
 Socket creation, port assignment, socket scheduled in run loop.
 The socket represents the port on this app's end of the connection.
 */
- (BOOL) makeSocket {
    // Make a socket context, with which to configure the socket.
    // It's a struct, but doesn't require "struct" prefix -- because typedef'd?
CFSocketContext socketCtxt = {0, self, NULL, NULL, NULL}; // 2nd arg is pointer for callback function   
    // Make socket.
    // Sock stream goes with TCP protocol, the safe method used for most data transmissions.
    // kCFSocketAcceptCallBack accepts connections automatically and presents them to the callback function supplied in this class ("acceptSocketCallback").
    // CFSocketCallBack, the callback function itself.
    // And note that the socket context is passed in at the end.
    self.socket = CFSocketCreate(kCFAllocatorDefault, PF_INET, SOCK_STREAM, IPPROTO_TCP, kCFSocketAcceptCallBack, (CFSocketCallBack)&acceptSocketCallback, &socketCtxt);

    // Do socket-creation error checking.
    if (self.socket == NULL) {
        // alert omitted
        return NO;
    }

    // Prepare an int to pass to setsockopt function, telling it whether to use the option specified in arg 3.
    int iSocketOption = 1; // 1 means, yes, use the option

    // Set socket options.
    // arg 1 is an int. C-style method returns native socket.
    // arg 2, int for "level." SOL_SOCKET is standard.
    // arg 3, int for "option name," which is "uninterpreted." SO_REUSEADDR enables local address reuse. This allows a new connection even when a port is in wait state.
    // arg 4, void (wildcard type) pointer to iSocketOption, which has been set to 1, meaning, yes, use the SO_REUSEADDR option specified in arg 3.
    // args 5, the size of iSocketOption, which can now be recycled as a buffer to report "the size of the value returned," whatever that is. 
    setsockopt(CFSocketGetNative(socket), SOL_SOCKET, SO_REUSEADDR, (void *)&iSocketOption, sizeof(iSocketOption));

    // Set up a struct to take the port assignment.
    // The identifier "addr4" is an allusion to IP version 4, the older protocol with fewer addresses, which is fine for a LAN.
    struct sockaddr_in addr4;
    memset(&addr4, 0, sizeof(addr4));
    addr4.sin_len = sizeof(addr4);
    addr4.sin_family = AF_INET;
    addr4.sin_port = 0; // this is where the socket will assign the port number
    addr4.sin_addr.s_addr = htonl(INADDR_ANY);
    // Convert to NSData so struct can be sent to CFSocketSetAddress.
    NSData *address4 = [NSData dataWithBytes:&addr4 length:sizeof(addr4)];

    // Set the port number.
    // Struct still needs more processing. CFDataRef is a pointer to CFData, which is toll-free-bridged to NSData.
    if (CFSocketSetAddress(socket, (CFDataRef)address4) != kCFSocketSuccess) {
        // If unsuccessful, advise user of error (omitted)…
        // ... and discard the useless socket.
        if (self.socket) 
            CFRelease(socket);
        self.socket = NULL;
        return NO;
    }

    // The socket now has the port address. Extract it.
    NSData *addr = [(NSData *)CFSocketCopyAddress(socket) autorelease];
    // Assign the extracted port address to the original struct.
    memcpy(&addr4, [addr bytes], [addr length]);
    // Use "network to host short" to convert port number to host computer's endian order, in case network's is reversed.
    self.port = ntohs(addr4.sin_port);
    printf("\nUpon makeSocket, the port is %d.", self.port);// !!!:testing - always prints a 5-digit number

    // Get reference to main run loop.
    CFRunLoopRef cfrl = CFRunLoopGetCurrent();
    // Schedule socket with run loop, by roundabout means.
    CFRunLoopSourceRef source4 = CFSocketCreateRunLoopSource(kCFAllocatorDefault, socket, 0);
    CFRunLoopAddSource(cfrl, source4, kCFRunLoopCommonModes);
    CFRelease(source4);

    // Socket made
    return YES;
} 
```

**运行循环调度**

是的，所有 4 个流都安排在 runloop 中，都使用与我在上面第一次更新中发布的代码相同的代码。

**运行循环阻塞：**

我没有对同步、多线程、NSLock 等做任何花哨的事情。而且，如果我设置一个按钮操作以将某些内容打印到控制台，它会在整个过程中运行——runloop 似乎运行正常。

* * *

Update4，流端口？

Noa 的调试建议给了我进一步检查流属性的想法：

```
NSNumber *nTest = [self.streamIn propertyForKey:NSStreamSOCKSProxyPortKey]; // always null! 
```

我曾假设流挂在它们的端口上，但令人惊讶的是，`nTest`它总是为空。它在我的应用程序中为空，这似乎表明存在问题 - 但在*有效*的教程应用程序中它也是空的。如果一个流一旦创建就不需要挂起它的端口分配，那么端口属性的目的是什么？

也许端口属性不能直接访问？但`nTest`在以下情况下也始终为空：

```
 NSDictionary *dTest = [theInStream propertyForKey:NSStreamSOCKSProxyConfigurationKey];
    NSNumber *nTest = [dTest valueForKey:NSStreamSOCKSProxyPortKey];
    NSLog(@"\tInstream port is %@.", nTest); // (null)
    nTest = [dTest valueForKey:NSStreamSOCKSProxyPortKey];
    NSLog(@"\tOutstream port is %@.", nTest); // (null) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-06T16:58:32.013

问题在于这一行：

```
CFStreamCreatePairWithSocket(kCFAllocatorDefault, socketNativeHandle, &readStream, NULL); 
```

如果我只在 iPhone 端接收数据，那就没问题了。但是我创建了*一*对流，而不仅仅是一个输入流，所以在这段代码下面我创建了一个写流：

```
CFStreamCreatePairWithSocket(kCFAllocatorDefault, socketNativeHandle, NULL, &writeStream); 
```

CFStream Reference 说，“如果你传递 NULL [for readStream]，这个函数将不会创建一个可读流。” 它并不是说如果传递 NULL，就会使先前创建的流无法运行。但这显然是发生了什么。

这种设置的一个奇怪现象是，如果我先打开 streamIn，我会遇到相反的问题：iPhone 会收到 hasByteAvailable 事件，但永远不会收到 hasSpaceAvailable 事件。如问题中所述，如果我查询流的状态，两者都会返回 NSStreamStatusOpen。所以花了很长时间才弄清楚真正的错误在哪里。

（这个顺序流创建是我几个月前建立的一个测试项目的产物，在该项目中，我测试了仅向一个方向或另一个方向移动的数据。）

**解决方案**

两个流应该成对创建，在一行中：

```
CFStreamCreatePairWithSocket(kCFAllocatorDefault, socketNativeHandle, &readStream, &writeStream); 
```

# algorithm - 这种会议安排方案是否有一个很好理解的算法或解决方案模型？

> ID：10378002
> 
> 赞同：7
> 
> 时间：2012-04-30T02:58:20.707
> 
> 标签：algorithm, language-agnostic, mathematical-optimization, linear-programming

我有一个复杂的问题，我想知道是否存在或适用现有且易于理解的解决方案模型，例如旅行推销员问题。

**输入**：

*   包含 N 个时间事件的日历，由开始和结束时间以及地点定义。
*   每个会议场所的容量（可同时容纳的最大人数）
*   一组对`(Ai,Aj)`，表示服务员`Ai`希望与服务员会面`Aj`并`Aj`接受该邀请。

**输出**：

*   对于每个助理`A`，他将参加的所有活动的时间表。主要标准是每个服务员应尽可能多地遇到接受他邀请的服务员，满足空间限制。

到目前为止，我们考虑使用回溯求解（尝试所有可能的解决方案），并使用线性规划（即定义模型并使用单纯形算法求解）

**更新：**如果在某些情况下`Ai`已经见过面`Aj`，他们就不需要再见面了（他们已经见过面了）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T09:42:00.250

Your problem is as hard as [minimum maximal matching problem](http://www.nada.kth.se/~viggo/wwwcompendium/node21.html) in interval graphs, w.l.o.g Assume capacity of rooms is `2` means they can handle only one meeting in time. You can model your problem with [Interval graphs](http://en.wikipedia.org/wiki/Interval_graph), each interval (for each people) is one node. Also edges are if A_i & A_j has common time and also they want to see each other, set weight of edges to the amount of time they should see each other, . If you find the minimum maximal matching in this graph, you can find the solution for your restricted case. But notice that this graph is n-partite and also each part is interval graph.

P.S: note that if the amount of time that people should be with each other is fixed this will be more easier than weighted one.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T21:05:39.537

如果您可以访问一个好的 MIP 求解器（cplex/gurobi 通过学术倡议，但 coin OR 和 LP_solve 是开源的，而且也不错），我肯定会尝试 simplex。我看了看将您的问题表述为一个混合整数程序，我的感觉是它会有相当强的松弛，因此分支和切割以及价格对您来说会有很长的路要走。如今，这些求解器提供了非常可扩展的解决方案，尤其是商业解决方案。优点是它们还提供了一个上限，因此您可以了解解决方案的质量，而启发式方法并非如此。

公式：

将 z(i,j)（二进制）定义为一个变量，表示 i 和 j 在 {1,2,...,N} 中的至少一个事件 n 中在一起。定义 z(i,j,n)（二进制）以指示它们在事件 n 中在一起。定义 z(i,n) 表示 i 参加 n。Z(i,j) 和 z(i,j,m) 仅在 i 和 j 应该相遇时才存在。

对于每个 t，M^t 是同时举行的时间事件的子集。因此，如果事件 1 是从 9 到 11，事件 2 是从 10 到 12，事件 3 是从 11 到 13，则 M^1 = {事件 1，事件 2) 和 M^2 = {事件 2，事件 3} . 即没有人可以同时参加 1 和 2，或 2 和 3，但 1 和 3 很好。

```
Max sum Z(i,j)                      

z(i,j)<= sum_m z(i,j,m)   
(every i,j)(i and j can meet if they are in the same location m at least once)

z(i,j,m)<= z(i,m)   (for every i,j,m) 
(if i and j attend m, then i attends m)

z(i,j,m)<= z(j,m)     (for every i,j,m) 
(if i and j attend m, then j attends m)

sum_i z(i,m) <= C(m)   (for every m) 
(only C(m) persons can visit event m)

sum_(m in M^t) z(i,m) <= 1  (for every t and i)  
(if m and m' are both overlapping time t, then no person can visit them both. ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T10:54:01.397

正如@SaeedAmiri 所指出的，这看起来是一个复杂的问题。

我的猜测是，您正在考虑的*回溯*和*线性编程*选项会随着助手数量的增加（可能是数十个助手的数量级）而爆炸式增长。

如果不需要最优性，也许您应该考虑一种（元）启发式方法，或者使用约束编程来构建初始模型并查看其扩展方式。

为了给你一个更准确的答案，你为什么需要解决这个问题？参加者的典型人数是多少？房间的数量？

# jquery - jquery 有类和悬停

> ID：10378008
> 
> 赞同：0
> 
> 时间：2012-04-30T03:00:48.090
> 
> 标签：jquery, html, hover

我试过代码：

```
$('a').hasClass('button-hello').hover(function() { alert('ffs'); }); 
```

我试过这个，没有成功。我试图触发悬停在类中有按钮-hello 的任何 A 链接上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T03:02:16.013

以下代码：

```
$('a.button-hello').hover(function() { alert('ffs'); }); 
```

将处理以下元素：

```
<a href="#" class="button-hello">A1</a>
<a href="#" class="button-hello a">A2</a>
<a href="#" class="button-hello a b">A3</a>
<a href="#" class="button-hello a b c">A4</a> 
```

[JsFiddle.net 示例](http://jsfiddle.net/3kNTf/)

# php - 默认 RESTful CakePHP 路由给出 Missing Controller Method 错误

> ID：10378011
> 
> 赞同：1
> 
> 时间：2012-04-30T03:01:11.417
> 
> 标签：php, cakephp, rest

我正在按照本教程[http://book.cakephp.org/2.0/en/development/rest.html](http://book.cakephp.org/2.0/en/development/rest.html)在我的 CakePHP 应用程序中使用 REST 启动和运行。

我已将以下内容添加到我的 routes.php 文件中：

```
Router::mapResources(array('fantasyPicks', 'fantasyPlayers'));
Router::parseExtensions(); 
```

在我的每个控制器中，我都在 beforeFilter() 回调中包含了 RequestHandler 组件和 setContent 到 json。它看起来像这样：

```
class FantasyPicksController extends AppController {
public $components = array('RequestHandler');

public function beforeFilter() {
    parent::beforeFilter();
    $this->RequestHandler->setContent('json','text/x-json');
    $this->layout = 'json/default';
}

public function index() {
    $fantasyPicks = $this->FantasyPick->find('all');
    $this->set('json', $fantasyPicks);
    $this->render('/json/data');
}
... 
```

我的 json/data 视图只是回显 json_encode：

```
<?php echo json_encode($json); ?> 
```

毕竟，导航到 /fantasyPicks/view/1 可以按预期工作。但是， /fantasyPicks/1 给了我以下错误：

```
Missing Method in FantasyPicksController
Error: The action 1 is not defined in controller FantasyPicksController

Error: Create FantasyPicksController::1() in file: app\Controller\FantasyPicksController.php.

<?php
class FantasyPicksController extends AppController {

    public function 1() {

    }

} 
```

有谁知道我做错了什么？任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T03:51:45.347

访问页面时，您必须使用正确的控制器命名约定。

[http://book.cakephp.org/2.0/en/getting-started/cakephp-conventions.html](http://book.cakephp.org/2.0/en/getting-started/cakephp-conventions.html)

Refer to the URL considerations section. So you should be going to /fantasy_picks/1 and it will work properly.

# vim - 如何在 Vim 中插入配置变量的值？

> ID：10378024
> 
> 赞同：20
> 
> 时间：2012-04-30T03:02:39.067
> 
> 标签：vim

我可以`guifont`通过键入以下内容来获取配置值的值：

```
:set guifont? 
```

我可以记住它然后输入它。但是有没有办法直接将该值插入到我的文档中？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-30T03:28:11.880

在[插入模式下](http://vimdoc.sourceforge.net/htmldoc/insert.html#Insert-mode)：

`ctrl`+`r``=&guifont``enter`

有关其工作原理的更多信息，请参阅这些帮助页面：

*   [**`:help i_CTRL-R_=`**](http://vimdoc.sourceforge.net/htmldoc/insert.html#i_CTRL-R_=)
*   [**`:help expr-option`**](http://vimdoc.sourceforge.net/htmldoc/eval.html#expr-option)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-30T03:28:20.603

`redir`您可以使用以下命令重定向 ex 输出：

```
:redir @a
:set guifont?
:redir END
"ap 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-30T03:19:34.820

当然。例如，要在文档顶部添加一行，其中包含`shiftwidth`我可以执行的选项值：

```
:execute append(0, &shiftwidth) 
```

您可以直接输入它，但更常见的是它不会出现`:`在*vimrc 中定义的函数中。*

请参阅[*编写 Vim 脚本*。](http://vimdoc.sourceforge.net/htmldoc/usr_41.html)

# java - 为什么我的 Java 进程一启动就占用 16G 虚拟内存

> ID：10378028
> 
> 赞同：2
> 
> 时间：2012-04-30T03:03:34.863
> 
> 标签：java, process, java-native-interface

我只是在 16 核 CPU 上使用一个简单的独立 java 程序测试一些 JNI 调用。我正在使用 64 位 JVM 和操作系统是 Linux AS5。但是，一旦我使用 64 位 c++ 库启动我的测试程序，我就会看到“SIZE”列显示 16G。最上面的命令输出是这样的：

```
  PID PSID 用户名 THR PRI NICE SIZE RES 状态 时间 CPU 命令
  3505 31483 xxxxxxx 23 16 0    16G 215M睡眠   0:02    0.00% java    
```

我知道我的堆没问题，但是 JNI 内存可以增加进程大小，但我很困惑为什么它以 16G - SIZE 开头，我认为这是虚拟内存大小？真的会占用这么多内存吗？我应该关心它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T04:49:01.720

Greg Hewgill 的评论基本上说明了一切：您只使用了 215 MB 的实际内存。在我的机器上，没有任何 VM 参数的无操作 Java 进程获得 8 GB。你有四倍的核心，所以从两倍的内存开始对我来说是有意义的。

由于这个数字只使用虚拟地址空间，比如 2* *48 B 或 2* * 64 B，它实际上是免费的。您可以使用`-mx1G`以将内存限制为 1 GB，但请注意，这是一个硬限制，当进程需要更多时，您将获得 OOME。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T03:12:25.780

奇怪，但可能是您的 JNI 调用以某种方式快速泄漏内存或分配大量内存块。您使用什么命令行来启动 JVM，以及您的 JNI 代码在做什么？

# ruby - padrino - 添加 html 选项以在 button_to 上提交按钮

> ID：10378029
> 
> 赞同：0
> 
> 时间：2012-04-30T03:03:35.603
> 
> 标签：ruby, padrino

```
button_to 'Submit',url(:account, :login) 
```

生成这样的表格：

```
<form action="/account/login" method="post">
    <input type="submit" value="Submit">
</form> 
```

但我想生成这样的东西：

```
<form action="/account/login" method="post">
    <input type="submit" value="Submit" class="myclass">
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T06:09:35.197

许多标签助手可以接收一个块来捕获内部 html：

```
button_to 'Submit', url(:base, :index) do
  submit_tag 'Submit', :class => 'myclass'
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T03:14:31.713

我相信这应该有效：

```
<%= button_to 'Submit', {:controller => :account, :action => :login}, :class => 'myform' %> 
```

[button_to](http://apidock.com/rails/ActionView/Helpers/UrlHelper/button_to)的第三个参数是`html_options`. 如果您只能使用 html_options 更改表单，那么您可以使用这样的 css 选择器：

```
form.myform input {} 
```

# android - 两种设备，密度相似但图像尺寸不同？

> ID：10378030
> 
> 赞同：0
> 
> 时间：2012-04-30T03:03:42.797
> 
> 标签：android, android-layout

好的，这是一个令我困惑的问题，我真的希望你能帮助我解决这个问题。我正在使用 HTC amaze 和 Galaxy S2 测试我的应用程序（我知道它们都是高密度的）并且都在 3.7-4.3 屏幕范围内

问题是同一张图像在两个屏幕上的大小看起来不同。在 HTC 惊奇它是小得多。我有 3 个不同大小的可绘制文件夹（无论如何我都应该在这里需要，因为两个设备的密度相同）

我在 DisplayMatrics 上做了一些调试，发现 HTC 惊奇如下：

```
density 1.5
desnityDPI 240
Height pixels:540
Width pixels:960
xdpi 258
ydpi 256 
```

但是，对于 S2 星系，显示指标是：

```
density 1.5
desnityDPI 240
Height pixels:480
Width pixels:800
xdpi 160
ydpi 160 
```

那么有人可以向我解释为什么两种设备上的图像尺寸不同。HTC 惊奇图像比 S2 小得多？谢谢

编辑：用于获取 DP 信息的代码是

```
DisplayMetrics mt =getApplicationContext().getResources().getDisplayMetrics(); 
```

编辑：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mainLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/carpet"
    android:clipChildren="false"
    android:clipToPadding="false"
    android:keepScreenOn="true" >
    <RelativeLayout
        android:id="@+id/relativeLayoutBottom"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:clipChildren="false"
        android:clipToPadding="false" >

        <ImageView
            android:id="@+id/ivBottom1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />

        <ImageView
            android:id="@+id/ivBottom2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="20dp" />

        <ImageView
            android:id="@+id/ivBottom3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="40dp" />
    </RelativeLayout>

   </RelativeLayout>

private void initialize(ArrayList<CardSuitNumber> cards) {

    RelativeLayout flBottom = (RelativeLayout) findViewById(R.id.relativeLayoutBottom);
    player1.clearAll();

    for(int i=0; i<GameConstants.MAXRANKS;i++){
        player1.addCard((ImageView)flBottom.getChildAt(i));

    }
}

public void addCard(ImageView im){

        Drawable drawable = card.getCardSuitNumber().getDrawable(mActivity);
        im.setImageDrawable(drawable);
        imsetVisibility(View.VISIBLE);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T12:24:46.540

答案就在你面前的数字中。

来源[http://www.androidauthority.com/htc-amaze-4g-vs-samsung-galaxy-s-ii ​​-t-mobile-27110/](http://www.androidauthority.com/htc-amaze-4g-vs-samsung-galaxy-s-ii-t-mobile-27110/)

> 屏幕尺寸方面，三星 Galaxy S2 的屏幕略大，显示屏为 4.52 英寸。另一方面，HTC Amaze 4G 的屏幕尺寸与 Galaxy S2 的国际版本相似——4.3 英寸。

HTC Amaze 具有更高的分辨率和更小的物理屏幕。这会导致更高的像素密度——这意味着更小的物理像素，因为需要将更多的像素塞进更紧凑的地方。

因此，例如 240x160 的图像在 Amaze 上会显得更小。

报告的 S2 的 DPI 值显然是错误的。根据给定的指标，'800/160 = 5 英寸长边，480/160 = 3 英寸短边。这将给出 sqrt (5 * 5 + 3*3 ) = 5,8 英寸的屏幕尺寸。

The amaze 的 DPI 值是正确的。正如我们所看到的，如果我们做一个简单的毕达哥拉斯。平方 (960/258^2 + 540/256^2) = 4,27"

作为一名开发人员，当我从我的测试设备 HTC 感觉和 S2 移动时，我会遇到同样的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T10:04:39.110

HTC 上的 xdpi 和 ydpi 非常高，这就是图像较小的原因。

我记得有一个错误，报告的 xdpi 和 ydpi 完全错误，老实说，它们看起来是错误的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T10:18:13.557

这是否与此问题有关：[https ://groups.google.com/forum/?fromgroups#!topic/android-developers/g56jV0Hora0](https://groups.google.com/forum/?fromgroups#!topic/android-developers/g56jV0Hora0)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T08:02:31.163

我不确定，但我根据您的问题了解到的一种解决方案是，您必须根据设备屏幕分辨率进行布局。

一样，

Galaxy SII 支持 layout-normal-hdpi

一样，

也许 HTC amaze 支持 layout-large Screen。

因此，请尝试根据设备进行布局，它将解决您的问题。

希望它会帮助你。

与您的问题相同的其他细节在这里：[android-layout-issue-for-htc-evo-3d](https://stackoverflow.com/questions/9988574/android-layout-issue-for-htc-evo-3d)

享受编码。. . . :)

# c# - 插入与外键约束冲突

> ID：10378033
> 
> 赞同：1
> 
> 时间：2012-04-30T03:03:50.080
> 
> 标签：c#, orm, foreign-keys, rdbms, ormlite-servicestack

我正在使用来自[ServiceStack的](http://www.servicestack.net/)[OrmLite](https://github.com/ServiceStack/ServiceStack.OrmLite)构建一个 API 。

* * *

当用测试数据填充它时，我收到以下错误：

> INSERT 语句与 FOREIGN KEY 约束“FK_Order_Customer_CustomerId”冲突。冲突发生在数据库“C:\USERS\ALECTAYLOR\SOCIALBOOTSTRAPAPI\SRC\SOCIALBOOTSTRAPAPI\APP_DATA\USERAUTH.MDF”、表“dbo.Customer”、“Id”列中。该语句已终止。

代码（第 213-236 行 + CreateOrders 函数）：[http ://pastebin.com/Njhz7sD2](http://pastebin.com/Njhz7sD2)

探查器输出： http: [//fiddle.jshell.net/cTen2/1/show/](http://fiddle.jshell.net/cTen2/1/show/)

* * *

感谢您提供有关如何纠正此问题的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T00:07:06.093

好吧，让它工作。

需要设置`ShopId`of`Order`和`orderId`of `orderDetails` `List`。

[http://pastebin.com/TbrW150T](http://pastebin.com/TbrW150T)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T09:16:35.653

由于这是失败的插入，唯一合乎逻辑的解释是客户编号 1 不存在。我看到您在几行之前插入了 3 个客户。也许在插入客户和插入订单之间没有提交事务。

> 插入“订单”（“CustomerId”、“ShopId”、“ShippingAddress”、“OrderDate”、“RequiredDate”、“ShippedDate”、“Total”）值（1、0、'{line1:440 Crescent St, line2: South Melbourne, postCode:7416, city:Melbourne, country:Australia}', '20120430 07:43:18.686', NULL, NULL, 0);

在插入客户之后和插入订单之前尝试提交插入

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T03:41:20.943

FOREIGN KEY 约束通常意味着您试图将值插入到引用表中不存在的表中。查看有关外键的[MSDN](http://msdn.microsoft.com/en-us/library/ms175464.aspx)文章，了解有关它们是什么以及它们如何工作的更多信息。您需要查看数据表 order 和 customer 的实际结构。

我猜您正在将 customerId 插入到客户表中不存在的订单表中。

# compilation - 防止 makefile 重新编译所有源文件

> ID：10378034
> 
> 赞同：1
> 
> 时间：2012-04-30T03:04:02.067
> 
> 标签：compilation, makefile

我已经尝试了一个多小时来修复我的 makefile，但我破坏的比我修复的要多。无论如何，我对 Makefiles 很（非常）新，我几乎没有经验。我的问题是，即使目标文件已经构建（并且源尚未更新），我的 makefile 也会重新编译每个源文件。由于 makefile 很像声明式编程，我不知道我做错了什么。

对不起，我在这方面的知识很有限......

```
#---------------------------------------------------------
# Compiler and linker flags
#---------------------------------------------------------

CC      =   g++
CMNFLAGS    =   -ggdb3 -Wextra -Wall -Wno-int-to-pointer-cast -Wno-reorder -Wno-    write-strings -DOPT_TYPE="\"debugging\""
CFLAGS      =   $(CMNFLAGS) -fPIC
LDFLAGS     =   $(CMNFLAGS) -shared -ldl -lm -static-libgcc

#---------------------------------------------------------
# All the different directories
#---------------------------------------------------------

BUILD       =   build
SOURCE      =   source
INCLUDE     =   include
TARGET      =   $(BUILD)/$(shell basename $(CURDIR))_mm_i386.so

#---------------------------------------------------------
# Directory and include variables/files
#---------------------------------------------------------

SRCSDK      =   ../sdk
METADIR     =   $(INCLUDE)/metafiles

INSTDIR     =   /usr/local/test/$(shell basename $(CURDIR))/dlls
INCLUDES    =   -I$(INCLUDE) -I$(METADIR) -I$(SRCSDK)/engine -I$(SRCSDK)/common \
        -I$(SRCSDK)/pm_shared -I$(SRCSDK)/dlls -I$(SRCSDK)

#---------------------------------------------------------
# Special variables
#---------------------------------------------------------

VPATH       =   $(SOURCE) $(foreach dir, $(MODULES), $(SOURCE)/$(dir))

#---------------------------------------------------------
# Source and object files
#---------------------------------------------------------

MODULES     =   game

SRC_DIR     =   $(addprefix $(SOURCE)/, $(MODULES))
SOURCES     =   $(foreach dir, $(SRC_DIR), $(wildcard $(dir)/*.cpp))

SOURCES     +=  $(wildcard $(SOURCE)/*.cpp)
OBJECTS     =   $(foreach dir, $(SOURCES:.cpp=.o), $(BUILD)/$(notdir $(dir)))

#---------------------------------------------------------
# All the makefile directives
#---------------------------------------------------------

.PHONY: clean install

all: $(SOURCES) $(TARGET)

$(TARGET): $(OBJECTS)
  $(CC) $(LDFLAGS) $(OBJECTS) -o $@

$(BUILD)/%.o: %.cpp $(BUILD)
  $(CC) $(CFLAGS) $(INCLUDES) -o $@ -c $<

$(BUILD):
  @mkdir $@

clean:
  -rm -r $(BUILD)
  @echo clean...

install: $(TARGET)
  @cp $(TARGET) $(INSTDIR)
  @echo installation done... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T03:12:42.937

```
$(BUILD)/%.o: %.cpp $(BUILD) 
```

应该

```
$(BUILD)/%.o: %.cpp 
```

您的行说您的目标文件是从包含它们的目录构建的。几乎任何操作都会更新构建目录的时间戳，因此您的对象几乎总是过时的。

# windows - 如何解释这个非常慢的套接字连接？

> ID：10378036
> 
> 赞同：1
> 
> 时间：2012-04-30T03:04:35.987
> 
> 标签：windows, performance, tcp, winsock

我试图在两台 PC 之间设置带宽测试，它们之间只有一个开关。所有网络硬件都是千兆的。一台机器我放了一个程序来打开一个套接字，监听连接，接受，然后是一个循环来读取数据并根据“性能计数器”测量接收到的字节。在另一台机器上，程序打开一个套接字，连接到第一台机器，然后进入一个紧密循环，以尽可能快地将数据泵入连接，每个 send() 调用以 1K 块为单位。有了这样的设置，事情似乎可以接受的快。在千兆硬件的合理范围内，我可以通过网络获得大约 30 到 40 *MBytes* /sec 的速度 - 明显快于 100BaseT。

乐趣从这里开始：我尝试使用 setsockopt() 将每一端的缓冲区（SO_SNDBUF、SO_RCVBUF）的大小设置为 1K。突然，接收端报告它每秒只有 4,000 或 5,000 个字节。检测事物的传输方面，似乎 send() 调用*每个*需要 0.2 到 0.3 秒，只是发送 1K 块。从接收端删除 setsockopt() 似乎并没有改变事情。

现在很明显，试图操纵缓冲区大小是一个坏主意。我曾认为，也许将缓冲区大小强制为 1K，使用 1K 的 send() 调用，将是一种强制操作系统在每次发送调用时将一个数据包放在线路上的方法，并理解这将阻止网络堆栈有效地组合数据进行传输 - 但我没想到吞吐量会下降到微不足道的 4-5K/秒！

我没有时间在资源上追查这个问题并以我想要的方式真正理解它，但我真的很想知道什么可以让 send() 花费 0.2 秒。就算是在等待对方的ack，0.2秒也太不可思议了。是什么赋予了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T10:40:53.043

纳格尔？

[带有小消息的 Windows 网络](http://support.microsoft.com/kb/214397)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T03:10:47.743

解释很简单，一个 1k 的缓冲区是一个非常*小*的缓冲区，您的发送机器可能一次发送一个数据包。发送方必须等待接收方的确认，然后才能清空缓冲区并接受应用程序发送的下一个块（因为 TCP 层可能需要稍后重新传输数据）。

一个更有趣的练习是将缓冲区大小从系统的默认值（查询它以找出那是什么）一直更改为 1k，并查看每个缓冲区大小如何影响您的吞吐量。

# php - 如何使用行和列设置表格内 div 的位置

> ID：10378040
> 
> 赞同：0
> 
> 时间：2012-04-30T03:05:19.977
> 
> 标签：php, javascript, jquery, html

我有一个表格，第一列的每一行都有一个 div，我想根据我想要的表格行或列来设置它在页面加载时的位置。

这是我的输出表：

```
col1 | col2 | col3 | col4 | col5 |
""""""""""""""""""""""""""""""""""
div1 |      |      |      |      |
""""""""""""""""""""""""""""""""""
div2 |      |      |      |      |
""""""""""""""""""""""""""""""""""
div3 |      |      |      |      | 
```

我想在页面加载时根据我的数据库查询将它们的位置设置为不同的列。例子：

```
col1 | col2 | col3 | col4 | col5 |
""""""""""""""""""""""""""""""""""
     | div1 |      |      |      |
""""""""""""""""""""""""""""""""""
     |      |      | div2 |      |
""""""""""""""""""""""""""""""""""
div3 |      |      |      |      | 
```

可能吗..？我可以使用 javascript 在 javascript 中获得位置

```
 var pos = rd.get_position();
   console.log( pos[0][0] ); 
```

任何方法或建议都可以。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T03:35:43.320

```
 | col1 | col2 | col3 |
"""""""""""""""""""""""""""
row1 |   x  |      |      |
"""""""""""""""""""""""""""
row2 |      |      |  y   |
"""""""""""""""""""""""""""
row3 |      |   z  |      | 
```

jQuery

```
$('table tr:eq(0) td:eq(0)').text('x');
$('table tr:eq(1) td:eq(2)').text('y');
$('table tr:eq(2) td:eq(1)').text('z');​ 
```

或者...

```
$('td', $('table tr').eq(0)).eq(0).text('x');
$('td', $('table tr').eq(1)).eq(2).text('y');
$('td', $('table tr').eq(2)).eq(1).text('z'); 
```

证明：http: [//jsfiddle.net/iambriansreed/mfTec/](http://jsfiddle.net/iambriansreed/mfTec/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T03:53:31.393

我假设您要移动每个 div 以使其成为指定列的子级（而不是将其视觉定位在列上，例如 position: absolute）。

此解决方案使用一个数组，其中表中的每个 div 都有一个项目（因此 posList[0] 保存 div1 的值，postList[2] 保存 div3 的值，等等）。每个数组条目的值是一个数字，指定每个 div 的列。

```
/* 
    posList is an array specifying, for each div, the zero-based column where you want to move each div.

    Example: The array [1, 3, 0] means the first div will be in column 2, the second div in column 4 and the third div in column 1 (remember that they are zero-indexed).

    In this code snippet it has been hard-coded for simplicity but it should be generated from the "query of [your] database" in whatever way is appropriate to your application.

 */
var posList = [1, 3, 0];    // Hard-coded for simplicity: div1 is in col2, div2 is in col4, div3 is in col1.

var rowList = $("table tr");    // Get all the rows in the table.
var divList = rowList.find("div");    // Find all the divs in the rows. This assumes there aren't any other divs in the table at all - make this selector more specific as required).

var i = 0
    ,colIndex = 0
    ,cell = null
    ,div = null
    ,row = null;

for (i = 0; i < posList.length; i++){

    colIndex = posList[i];  // Get the column index for each <div>.
    if (colIndex == 0){
        continue;    // Minor optimisation - if the index is 0 then we don't need to move the <div>.
    }

    div = divList.eq(i);    // The <div> that needs to be moved.
    row = rowList.eq(i);    // This is the <tr> element that is the ancestor of the current <div>.

    cell = row.find("td").eq(colIndex);    // We want to move the <div> to the <td> element specified by the column index from posList.
    div.detach().appendTo(cell);    // Move the <div> to the new column.

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T04:04:57.727

您可以使用：

```
// table is a reference to the table
// div is a reference to the div to move
table.rows(y).cells(x).appendChild(div); 
```

其中 y 是行号（注意它们从顶部开始从零开始索引），x 是列号（从左侧开始从零开始索引）。另请注意，如果您有对 div 的引用，只需将其分配给新位置，它将自动从当前父级中删除并附加到新位置（即您不必先删除然后附加，只需附加）。

# java - 使用 swing 在运行时创建和显示对象

> ID：10378043
> 
> 赞同：1
> 
> 时间：2012-04-30T03:06:00.017
> 
> 标签：java, swing

我正在尝试为允许插入和删除的 BST 树创建一个简单的 GUI。但是，我在运行时将组件插入 GUI 时遇到了很多麻烦。我想做的是每次插入或删除时“刷新”GUI。我创建了一个名为 printBst 的方法，该方法创建 Jlabels 来显示编号索引，如下所示，但它们没有显示出来。之后我尝试重新验证和验证 GUI，但它仍然无法正常工作。有人有想法么？

```
package source;
import javax.swing.*;
import source.BST.BSTnode;

import java.awt.Color;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;
import java.util.ArrayList;
import java.util.List;

public class Frame2 extends JFrame implements  ActionListener{
    BST bst;
    JPanel displayPanel, buttonPanel, totalGUI;
    JButton insertButton, deleteButton, resetButton;
    JTextField insertField, deleteField;

    public JPanel createContentPane (){
        bst = new BST();
        totalGUI = new JPanel();
        totalGUI.setLayout(null);

        displayPanel = new JPanel();
        displayPanel.setLayout(null);
        displayPanel.setLocation(10, 80);
        displayPanel.setSize(400, 300);
        totalGUI.add(displayPanel);

        buttonPanel = new JPanel();
        buttonPanel.setLayout(null);
        buttonPanel.setLocation(10, 0);
        buttonPanel.setSize(800, 80);
        totalGUI.add(buttonPanel);

        insertField = new JTextField(1);
        insertField.addActionListener(this);
        insertField.setLocation(0, 10);
        insertField.setSize(150, 30);
        buttonPanel.add(insertField);

        insertButton = new JButton("Insert");
        insertButton.setLocation(160, 10);
        insertButton.setSize(150, 30);
        insertButton.addActionListener(this);
        buttonPanel.add(insertButton);

        deleteField = new JTextField(1);
        deleteField.addActionListener(this);
        deleteField.setLocation(320, 10);
        deleteField.setSize(150, 30);
        buttonPanel.add(deleteField);

        deleteButton = new JButton("Delete");
        deleteButton.setLocation(480, 10);
        deleteButton.setSize(150, 30);
        deleteButton.addActionListener(this);
        buttonPanel.add(deleteButton);

        resetButton = new JButton("Reset");
        resetButton.setLocation(640, 10);
        resetButton.setSize(150, 30);
        resetButton.addActionListener(this);
        buttonPanel.add(resetButton);

        totalGUI.setOpaque(true);
        return totalGUI;
    }

    public void printBst(BSTnode node, int x, int x2, int y) {
        if (node != null) {
            JLabel current = new JLabel(""+ node.data);
            current.setLocation((x+x2)/2, y);
            current.setSize(100, 30);
            current.setHorizontalAlignment(0);
            displayPanel.add(current);
            printBst(node.left, x, (x2+x)/2, y+60);
            printBst(node.right, (x2+x)/2, x2, y+60);
            System.out.println("here");
        }
    }

    public void actionPerformed(ActionEvent e) {
        if(e.getSource() == insertButton)
        {
            bst.insert(Integer.valueOf(insertField.getText()));
            displayPanel.removeAll();
            printBst(bst.root, 0, 800, 0);
            totalGUI.revalidate();  
            validate(); 
        }
        else if(e.getSource() == deleteButton)
        {
            bst.delete(Integer.valueOf(deleteField.getText()));
            displayPanel.removeAll();
            printBst(bst.root, 0, 800, 0);
            totalGUI.revalidate();  
            validate(); 
        }
        else if(e.getSource() == resetButton)
        {
            bst.clear();
            displayPanel.removeAll();
            printBst(bst.root, 0, 800, 0);
            totalGUI.revalidate();  
            validate(); 
        }
    }

    private static void createAndShowGUI() {

        JFrame.setDefaultLookAndFeelDecorated(true);
        JFrame frame = new JFrame("[=] JButton Scores! [=]");

        Frame2 demo = new Frame2();
        frame.setContentPane(demo.createContentPane());

        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(900, 400);
        frame.setVisible(true);

    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                createAndShowGUI();
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T04:25:00.177

确保您调用`revalidate()`并在从ie`repaint()`中删除组件之后：`displayPanel`

```
displayPanel.removeAll();
printBst(0, 800, 0);
displayPanel.revalidate();
displayPanel.repaint(); 
```

另外，请注意：

```
printBst(0, 800, 0); 
```

导致内部坐标无效（不在边界内）`displayPanel`，其大小定义为 (400, 300) 窗口的左上角为 0,0。尝试以下操作，您应该会在面板中间的某处看到您的标签：

```
printBst(0, 400, 0); 
```

[绝对定位](http://docs.oracle.com/javase/tutorial/uiswing/layout/none.html)可能很难管理。查看[布局管理器的视觉指南](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)，看看您是否可以找到合适的布局来帮助您。

您也可以考虑准备好可以为您提供 2D 画布的框架。例如[JGraph](http://www.jgraph.com/)、[JFreeChart](http://www.jfree.org/jfreechart/)或[Piccolo2D](http://www.piccolo2d.org/learn/grapheditor.html)。

# php - 使用 PHP 创建的 Rest WebService

> ID：10378047
> 
> 赞同：0
> 
> 时间：2012-04-30T03:06:37.547
> 
> 标签：php, android, web-services, rest

我在互联网上找到了这个非常简单的 PHP REST WebService

```
<?php
class MVRest {

    private $supportedMethods;

    public function __construct($supportedMethods) {
        $this->supportedMethods = $supportedMethods;
    }

    public function handleRawRequest($_SERVER, $_GET, $_POST) {
       $url = $this->getFullUrl($_SERVER);
       $method = $_SERVER['REQUEST_METHOD'];
       switch ($method) {
              case 'GET':
          case 'HEAD':
            $arguments = $_GET;
            break;
          case 'POST':
            $arguments = $_POST;
            break;
          case 'PUT':
          case 'DELETE':
            parse_str(file_get_contents('php://input'), $arguments);
            break;
        }
        $accept = $_SERVER['HTTP_ACCEPT'];
        $this->handleRequest($url, $method, $arguments, $accept);
      }

      protected function getFullUrl($_SERVER) {
        $protocol = $_SERVER['HTTPS'] == 'on' ? 'https' : 'http';
        $location = $_SERVER['REQUEST_URI'];
        if ($_SERVER['QUERY_STRING']) {
          $location = substr($location, 0, strrpos($location, $_SERVER['QUERY_STRING']) - 1);
        }
        return $protocol.'://'.$_SERVER['HTTP_HOST'].$location;
      }

      public function handleRequest($url, $method, $arguments, $accept) {
        switch($method) {
          case 'GET':
            $this->performGet($url, $arguments, $accept);
            break;
          case 'HEAD':
            $this->performHead($url, $arguments, $accept);
            break;
          case 'POST':
            $this->performPost($url, $arguments, $accept);
            break;
          case 'PUT':
            $this->performPut($url, $arguments, $accept);
            break;
          case 'DELETE':
            $this->performDelete($url, $arguments, $accept);
            break;
          default:
            /* 501 (Not Implemented) for any unknown methods */
            header('Allow: ' . $this->supportedMethods, true, 501);
        }
      }

      protected function methodNotAllowedResponse() {
        /* 405 (Method Not Allowed) */
        header('Allow: ' . $this->supportedMethods, true, 405);
      }

      public function performGet($url, $arguments, $accept) {    
        echo $url.'<br />';
        print_r($arguments);
        echo $accept.'<br />';
      }

      public function performHead($url, $arguments, $accept) {
        $this->methodNotAllowedResponse();
      }

      public function performPost($url, $arguments, $accept) {
        $fp = fopen('data.txt', 'w');
        fwrite($fp, '1');
        fwrite($fp, '23');
        fclose($fp);
        echo 'GOTTED';
      }

      public function performPut($url, $arguments, $accept) {
        $this->methodNotAllowedResponse();
      }

      public function performDelete($url, $arguments, $accept) {
        $this->methodNotAllowedResponse();
      }

    }

    $rest = new MVRest("GET, POST");
    $rest->handleRawRequest($_SERVER, $_GET, $_POST); 
```

我使用 jQuery 进行消费并且效果很好，但是当我使用 android 消费它时。我得到一个 IOException。io.getMessage() 返回 mydomain.com。

我的安卓代码。有什么问题吗？

```
 HttpPost postMethod = new HttpPost("http://mydomain.com/rest.php");
    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
    nameValuePairs.add(new BasicNameValuePair("name","paulo"));
    nameValuePairs.add(new BasicNameValuePair("last_name","fernandes"));
    try {  
        postMethod.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        DefaultHttpClient hc = new DefaultHttpClient();
        HttpResponse response = hc.execute(postMethod);
        Toast.makeText(context, response.getStatusLine().toString(), Toast.LENGTH_LONG).show();
    } catch (ClientProtocolException e) {  
        Toast.makeText(context, "1: "+e.getMessage(), Toast.LENGTH_LONG).show();
        e.printStackTrace();  
    } catch (IOException e) {  
        Toast.makeText(context, "2: "+e.getMessage(), Toast.LENGTH_LONG).show();
        e.printStackTrace();  
    }  
    Toast.makeText(context, result, Toast.LENGTH_LONG).show(); 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T10:54:16.920

似乎是标题问题，也许您的应用程序响应的不是 OK 200

# arrays - 如何在 NumPy 中将 HDF5 2D 数组转换为 1D？

> ID：10378049
> 
> 赞同：3
> 
> 时间：2012-04-30T03:08:05.267
> 
> 标签：arrays, numpy, hdf5

我有一个从 HDF5 文件中切片的二维数组 (480*640)，如何使用 NumPy 将其转换为一维数组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T03:21:10.743

使用该`reshape`功能。有关示例，请参见[http://docs.scipy.org/doc/numpy/reference/generated/numpy.reshape.html](http://docs.scipy.org/doc/numpy/reference/generated/numpy.reshape.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T12:21:48.113

ravel() 是更指定的用于数组展平的 numpy.array 方法。因此，例如，如果您有名为 A 的 2d numpy.array，那么 A.ravel() 将返回包含来自 A 的元素的 1d 数组。

# javascript - 0.5.3 到 0.9.2 增加了收集效率低下

> ID：10378051
> 
> 赞同：3
> 
> 时间：2012-04-30T03:08:38.317
> 
> 标签：javascript, backbone.js, backbone.js-collections

我从 0.5.3 升级到 0.9.2 的主干.js，我注意到我的应用程序的速度显着下降。该应用程序处理许多大型集合并在某些点添加大量模型。一次添加 0 到 600 个模型。在 0.5.3 版本中，sortedIndex 函数使用最多，占用了 12% 的 CPU。在 0.9.2 版本中，代码变得明显变慢，sortBy 函数占用了 70% 的 CPU。

我怀疑他们正在添加所有模型然后对其进行排序，而不是将每个模型添加到应该保持集合排序的位置。是否有一个标志可以用来让它使用旧方法或任何其他加速它的方法。我意识到我可以为我的大型数据集实现自己的集合类，但我现在更愿意坚持使用骨干集合。

这是收集比较器

```
comparator: function(model) {
    return model.get("timestamp");
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T04:20:51.843

您可以尝试使用两个参数[`comparator`](http://documentcloud.github.com/backbone/#Collection-comparator)：

> 比较器函数可以定义为 a [`sortBy`](http://documentcloud.github.com/underscore/#sortBy)（传递一个接受单个参数的函数），或定义为 a [`sort`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/sort)（传递一个需要两个参数的比较器函数）。

这样您就可以使用本机[`sort`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/sort)而不是下划线的[`sortBy`](http://documentcloud.github.com/underscore/#sortBy); 和调用以及为[Schwartzian Transform](http://en.wikipedia.org/wiki/Schwartzian_Transform)[`sortBy`](https://github.com/documentcloud/underscore/blob/master/underscore.js#L260)构建对象有一些开销；施瓦茨变换只有在计算排序键很昂贵、并不昂贵并且（无论如何都是如此）仍然更便宜时才有意义。[`_.pluck`](http://documentcloud.github.com/underscore/#pluck)[`_.map`](http://documentcloud.github.com/underscore/#map)`m.get(a)``m.attributes[a]`[`get`](https://github.com/documentcloud/backbone/blob/master/backbone.js#L239)

所以一个简单的第一次尝试是：

```
comparator: function(a, b) {
    if(a.attributes.timestamp < b.attributes.timestamp)
        return -1;
    else if(a.attributes.timestamp > b.attributes.timestamp)
        return 1;
    return 0;
} 
```

该[`Collection#add`方法](https://github.com/documentcloud/backbone/blob/master/backbone.js#L626)在每次插入时对集合进行排序：

```
for (i = 0, length = models.length; i < length; i++) {
  //...
  if (this.comparator && options.at == null) this.sort({silent: true});
  //...
} 
```

除非您告诉它使用该`at`选项将模型放在哪里；该`"add"`事件包括新添加元素的索引，因此集合需要对每次插入进行排序，以便事件具有正确的值。但是，如果您可以在调用之前对模型进行预排序`add`并手动找到正确的插入点，那么您可以跳过`sort`内部的调用`add`。当然，您可能必须一个接一个地添加模型，但这应该不难：只需同时浏览新的（预排序的）模型和现有的集合，以找出每个模型的正确插入点。

# javascript - jsPlumb 处理可滚动 div 容器中的元素

> ID：10378052
> 
> 赞同：4
> 
> 时间：2012-04-30T03:08:48.633
> 
> 标签：javascript, jsplumb

我正在使用 jsPlumb 连接一堆 div（很像流程图）。所有的 div 都包含在一个可滚动的父 div 中。有点像下面的代码，但容器 div 中有更多的 div。

```
<div style="height:500px;width:500px;overflow:auto" id="container">
   <div id="node1"></div>
   <div id="node2"></div>
   <div id="node3"></div>
   <div id="node4"></div>
   <div id="node5"></div>
</div> 
```

我的问题是，如果我滚动 div，jsPlumb 生成的连接线只会留在原地，而不是滚动它们应该连接到的 div。我试过使用 jsPlumb.repaint() 但仍然没有运气。似乎 jsPlumb 没有考虑到容器 div 的滚动偏移量。有没有办法解决这个问题？我真的想避免将连接的 div 从容器 div 移到正文中，因为这将需要一些非常烦人的 css/html 重新编码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T23:48:30.030

事实证明，只需使用 jsPlumb.repaintEverything(); 在正确的位置重新绘制线条。jsPlumb.repaint() 似乎用于为特定元素重新绘制线条。例如，jsPlumb.repaint('div_id_goes_here');

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-09T19:06:44.680

你的问题/答案帮助了我。让我用我使用的代码扩展它：

```
 $('#container').scroll(
                function(){
                    jsPlumb.repaintEverything();
                }
            ) 
```

这将导致在滚动容器时重新绘制连接。在 IE 上，它有一点延迟，具体取决于场景（子节点移动，然后连接移动）。

# url-routing - ember-routemanager 可以在加载时动态添加状态吗？

> ID：10378056
> 
> 赞同：0
> 
> 时间：2012-04-30T03:10:09.240
> 
> 标签：url-routing, ember.js

我在下面的代码中定义了一个路由管理器。

```
App.routeManager = Ember.RouteManager.create(); 
```

我不想将视图状态静态添加到管理器；我想确定加载时的状态取决于数据。我怎样才能做到这一点？我正在寻找类似以下代码的内容。

```
foreach(item in itemArray){
      App.routeManager.states.add(Ember.ViewState.create(
             route: 'item.route'
      ));
} 
```

是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T14:20:20.783

您基本上给了自己答案，请参阅[http://jsfiddle.net/pangratz666/xNnTP/](http://jsfiddle.net/pangratz666/xNnTP/)：

```
App.stateManager = Ember.StateManager.create({
    enableLogging: true,
    initialState: 'firstState',
    firstState: Ember.State.create({
        myEvent: function(manager) {
            manager.goToState('addedState');
        }
    })
});

Ember.run.later(function() {
    Ember.setPath(App.stateManager, 'states.addedState', Ember.State.create({
        enter: function() {
            this._super();
            console.log('hello dynamic world');
        }
    }));
    App.stateManager.send('myEvent');
}, 10);​ 
```

# encryption - 哪种算法更适合 TLS：AES-256 还是 Camellia-256？

> ID：10378066
> 
> 赞同：7
> 
> 时间：2012-04-30T03:12:19.047
> 
> 标签：encryption, ssl

简介：对于我的个人网络服务器，我设置了带有自签名证书的 apache，以启用 TLS 安全性来学习和测试。我在虚拟主机中有这一行：

```
SSLProtocol -all -SSLv3 +TLSv1  
SSLCipherSuite TLSv1:+HIGH:!MEDIUM 
```

使用 firefox，我获得了 Camellia-256 加密连接，使用 Opera，我获得了 TLS v1.0 256 位 AES（1024 位 DHE_RSA/SHA），在同一台服务器上具有相同的配置。

这让我产生疑问，AES 还是 Camellia 哪个更强？

我注意到，如果我用`SSLCipherSuite TLSv1:+HIGH:!MEDIUM:!CAMELLIA`then 禁用山茶花，firefox 会采用与 opera 相同的套件。

在我的配置中，我还尝试禁用所有 SSL 版本以仅启用 TLS（如果我没有正确这样做，建议需要），但最初的问题仍然存在：哪个应该更强？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-26T15:40:54.663

我会更担心您的 SSL 加密不安全这一事实，因为您仅使用 1024 位非对称加密来保护您的密钥。

Adi Shamir（RSA 中的“S”）早在 2006 年就建议使用 2048 位密钥，甚至美国标准协会 (NIST) 自 2011 年 1 月起也将 2048 位作为所需的最低强度（请参阅 NIST SP800-57 以了解推荐的最低密钥强度-- 这说明 RSA 和 DH/el-gamal 均为 2048 位）。

简而言之，首先确保您的 RSA 加密足够强大，因为它用于保护对称密钥 (AES/Camellia)。永远不要依赖受较弱密钥保护的密钥（这就像在无线接入点上使用安全的 256 位随机 WPA 2 密钥，然后将其信任 WPS，这将在几个小时内显示！）

即使这是一个测试系统，也要学习按照您打算前进的方式使用加密货币；不要在证书密钥强度上妥协（现在所有的 CA 都应该拒绝 1024 位请求或使用 MD5 的 CSR，如果不是，请不要使用它们；像实际请求一样创建自己的测试证书，不要使用默认值密钥大小）。

很难比较优势，两者都接受了加密分析（更公开的 AES）并且足以保护数据。

冒着重复自己的风险，我更担心用于保护密钥协商的 1024 位。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-30T03:23:34.580

很难判断这些算法的强度。Camellia 在安全性方面被认为大致等同于 AES（[来源](http://phys.org/news5315.html)）。无论如何，差异可能并不重要。这两种算法都足够安全，可以让您的数据通道不再是系统中最薄弱的环节，因此您无需费心修改任何配置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-19T22:27:47.087

OpenSSL 密码列表 TLSv1:+HIGH 是一个非常糟糕的选择。“+something”表示法意味着将所有匹配“something”的密码移动到列表的末尾。因此，您仅将 HIGH 用作最后的手段，而不是 HIGH 首选的任何东西。

一个更好的选择是“DEFAULT:!MEDIUM:!LOW:!EXPORT:+3DES”，它以合理的默认值开始，删除 MEDIUM、LOW 和 EXPORT，最后使用 3DES（无论如何它可能是，但在某些系统上它出现在 AES128 之前，因为它可能被认为是 168 位强的）。

# c# - 在 OpenCL 中使用本地工作人员进行大型矩阵计算

> ID：10378068
> 
> 赞同：1
> 
> 时间：2012-04-30T03:12:26.463
> 
> 标签：c#, opencl, gpu, opencl.net

我是在 Visual Studio C# 中使用 OpenCL（带有 OpenCL.NET 库）的新手，目前正在开发一个计算大型 3D 矩阵的应用程序。在矩阵中的每个像素处，计算 192 个唯一值，然后求和以产生该像素的最终值。因此，从功能上讲，它就像一个 4-D 矩阵，(161 x 161 x 161) x 192。

现在我正在从我的主机代码中调用内核，如下所示：

```
//C# host code
...
float[] BigMatrix = new float[161*161*161]; //1-D result array
CLCalc.Program.Variable dev_BigMatrix = new CLCalc.Program.Variable(BigMatrix);
CLCalc.Program.Variable dev_OtherArray = new CLCalc.Program.Variable(otherArray);
//...load some other variables here too.
CLCalc.Program.Variable[] args = new CLCalc.Program.Variable[7] {//stuff...}

//Here, I execute the kernel, with a 2-dimensional worker pool:
BigMatrixCalc.Execute(args, new int[2]{N*N*N,192});
dev_BigMatrix.ReadFromDeviceTo(BigMatrix); 
```

示例内核代码发布在下面。

```
__kernel void MyKernel(
__global float * BigMatrix
__global float * otherArray
//various other variables...
)
{
    int N = 161; //Size of matrix edges
    int pixel_id = get_global_id(0); //The location of the pixel in the 1D array
    int array_id = get_global_id(1); //The location within the otherArray

    //Finding the x,y,z values of the pixel_id.
    float3 p;
    p.x = pixel_id % N;    
    p.y = ((pixel_id % (N*N))-p.x)/N;
    p.z = (pixel_id - p.x - p.y*N)/(N*N);

    float result;

    //...
    //Some long calculation for 'result' involving otherArray and p...
    //...

    BigMatrix[pixel_id] += result;
} 
```

我的代码目前可以工作，但是我正在寻找此应用程序的速度，我不确定我的工作人员/组设置是否是最佳方法（即工作人员池的尺寸为 161*161*161 和 192）。

我已经看到了将全局工作池组织到本地工作组以提高效率的其他示例，但我不太确定如何在 OpenCL.NET 中实现它。我也不确定这与在工作池中创建另一个维度有何不同。

所以，我的问题是：我可以在这里使用本地组吗？如果可以，我将如何组织它们？一般来说，使用本地组与仅调用 n 维工作池有何不同？（即调用 Execute(args, new int[]{(N*N*N),192})，而不是本地工作组大小为 192？）

感谢所有的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T06:44:01.083

我有几个建议给你：

1.  我认为您的代码有竞争条件。您的最后一行代码具有被多个不同工作项修改的 BigMatrix 的相同元素。
2.  如果您的矩阵确实是 161x161x161，那么这里有很多工作项可以将这些尺寸用作您的唯一尺寸。您已经拥有超过 400 万个工作项，这对于您的机器来说应该是足够的并行度了。你不需要192倍。另外，如果您不将单个像素的计算拆分为多个工作项，则不需要同步最终添加。
3.  如果您的全局工作量不是 2 的大幂的倍数，您可能会尝试将其填充为 1。即使您将 NULL 作为本地工作大小传递，一些 OpenCL 实现也会为不能很好划分的全局大小选择低效的本地大小。
4.  如果您的算法不需要本地内存或屏障，您几乎可以跳过本地工作组。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T15:11:06.860

我认为等待内存访问会损失很多性能。我已经回答了一个[类似的 SO question。](https://stackoverflow.com/questions/9413812/can-this-opencl-code-be-optimized)希望我的帖子能帮到你。请提出任何问题。

优化：

1.  我的内核版本的最大提升来自将 otherArray 读入本地内存。
2.  每个工作项在 BigMatrix 中计算 4 个值。这意味着它们可以同时写入同一缓存行。并行性损失最小，因为仍有 > 1M 工作项要执行。

...

```
#define N 161
#define Nsqr N*N
#define Ncub N*N*N
#define otherSize 192

__kernel void MyKernel(__global float * BigMatrix, __global float * otherArray)
{
    //using 1 quarter of the total size of the matrix
    //this work item will be responsible for computing 4 consecutive values in BigMatrix
    //also reduces global size to (N^3)/4  ~= 1043000 for N=161

    int global_id = get_global_id(0) * 4; //The location of the first pixel in the 1D array
    int pixel_id;
    //array_id won't be used anymore. work items will process BigMatrix[pixel_id] entirely

    int local_id = get_local_id(0); //work item id within the group
    int local_size = get_local_size(0); //size of group

    float result[4]; //result cached for 4 global values
    int i, j;
    float3 p;

    //cache the values in otherArray to local memory
    //now each work item in the group will be able to read the values efficently
    //each element in otherArray will be read a total of N^3 times, so this is important
    //opencl specifies at least 16kb of local memory, so up to 4k floats will work fine
    __local float otherValues[otherSize];
    for(i=local_id; i<otherSize; i+= local_size){
        otherValues[i] = otherArray[i];
    }
    mem_fence(CLK_LOCAL_MEM_FENCE);

    //now this work item can compute the complete result for pixel_id 
    for(j=0;j<4;j++){
        result[j] = 0;
        pixel_id = global_id + j;

        //Finding the x,y,z values of the pixel_id.
        //TODO: optimize the calculation of p.y and p.z
        //they will be the same most of the time for a given work item
        p.x = pixel_id % N;    
        p.y = ((pixel_id % Nsqr)-p.x)/N;
        p.z = (pixel_id - p.x - p.y*N)/Nsqr;

        for(i=0;i<otherSize;i++){
            //...
            //Some long calculation for 'result' involving otherValues[i] and p...
            //...
            //result[j] += ...
        }
    }
    //4 consecutive writes to BigMatrix will fall in the same cacheline (faster)
    BigMatrix[global_id] += result[0];
    BigMatrix[global_id + 1] += result[1];
    BigMatrix[global_id + 2] += result[2];
    BigMatrix[global_id + 3] += result[3];
} 
```

笔记：

1.  全局工作规模需要是四的倍数。理想情况下，4*workgroupsize 的倍数。这是因为没有错误检查来查看每个 pixel_id 是否在以下范围内：0..N^3-1。在等待内核执行时，cpu 可以处理未处理的元素。
2.  工作组的规模应该相当大。这将迫使缓存值被更多地使用，并且在 LDS 中缓存数据的好处将会增加。
3.  px/y/z 的计算需要进一步优化，以避免过多的高成本除法和模运算。请参阅下面的代码。

    ```
    __kernel void MyKernel(__global float * BigMatrix, __global float * otherArray)   {
    int global_id = get_global_id(0) * 4; //The location of the first pixel in the 1D array
    int pixel_id = global_id;

    int local_id = get_local_id(0); //work item id within the group
    int local_size = get_local_size(0); //size of group

    float result[4]; //result cached for 4 global values
    int i, j;
    float3 p;
    //Finding the initial x,y,z values of the pixel_id.
    p.x = pixel_id % N;    
    p.y = ((pixel_id % Nsqr)-p.x)/N;
    p.z = (pixel_id - p.x - p.y*N)/Nsqr;

    //cache the values here. same as above...

    //now this work item can compute the complete result for pixel_id 
    for(j=0;j<4;j++){
        result[j] = 0;
    //increment the x,y,and z values instead of computing them all from scratch
        p.x += 1;
        if(p.x >= N){
            p.x = 0;
            p.y += 1;
            if(p.y >= N){
                p.y = 0;
                p.z += 1;
            }
        }

        for(i=0;i<otherSize;i++){
            //same i loop as above...
        }
    } 
    ```

# php - 解析错误：语法错误，第 25 行 C:\Program Files (x86)\EasyPHP-5.3.9\www\Inventory\addclient.php 中的意外 T_IF

> ID：10378071
> 
> 赞同：0
> 
> 时间：2012-04-30T03:12:47.867
> 
> 标签：php

我是 PHP 新手，在第 25 行收到消息 Parse error: syntax error, unexpected T_VARIABLE in ..。如果有人能帮助我解决这个错误，我将不胜感激，因为它真的开始让我感到压力。一直在dreamweaver上，它说错误，它说 $Username=... 但我似乎无法修复它

```
<?php
    $host="******"; // Host name 
    $username="******"; // Mysql username 
    $password="******"; // Mysql password 
    $db_name="******"; // Database name 
    $tbl_name="avaya"; // Table name

    mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
    mysql_select_db("$db_name")or die("cannot select DB");

    $con = mysql_connect("localhost","root","");
    if (!$con)
      {
      die('Could not connect: ' . mysql_error());
      }
    mysql_select_db("inventory", $con);

    $addavaya="INSERT INTO avaya_pabx(critical_spare_id, serial_no, ,comcode, version, circuit_pack, classification, location, availability, date, client)
    VALUES ('". $_POST['critical_spare_id'] . "', '" . $_POST['serial_no']. "', '". $_POST['comcode'] . "','". $_POST['version'] . "','". $_POST['circuitp_pack'] . "','". $_POST['classification'] . "','". $_POST['location'] . "', '". $_POST['availability'] . "', '". $_POST['date'] . "', '". $_POST['client'] . "')";

    mysql_query($addavaya,$con)

    if (!mysql_query($addavaya,$con))
      {
      die('Error: ' . mysql_error());
      }
    echo "1 record added";

    mysql_close($con);

    ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T03:14:05.827

您在这一行的末尾缺少一个分号：

```
mysql_query($addavaya,$con) 
```

# php - 如何使用固定标题和来自mysql的表格内容使表格可滚动

> ID：10378072
> 
> 赞同：0
> 
> 时间：2012-04-30T03:13:07.137
> 
> 标签：php, html, css

如何使此表可滚动？我尝试了不同的代码，但我总是在这一行遇到问题：`$avaya=mysql_query("SELECT * From avaya_pabx");`. 当我回显`<td>`.

这是我的代码：

```
<div id="pageContent">

<title>Avaya PABX</title>
<table class='hovertable'>
<tr>
<th width="31">---</th>
<th width="12%">Critical Spare ID</th>
<th width="11%">Serial No.</th>
<th width="8%">Comcode</th>
<th width="9%">Version</th>
<th width="12%">Circuit Pack</th>
<th width="13%">Classification</th>
<th width="8%">Location</th>
<th width="12%">Availability</th>
<th width="5%">Date</th>
<th width="7%">Client</th>
</tr>

<?php

$avaya=mysql_query("SELECT * From avaya_pabx");

$alternate=0;

while ($row=mysql_fetch_array($avaya))
{
$alternate++;
if ($alternate==3)
$alternate=1;
echo "<tr class=class$alternate onmouseover=\"this.style.backgroundColor='#ffff66';\"          onmouseout=\"this.style.backgroundColor='#d4e3e5';\">";
echo "<td><font size=1><a href='deleteavaya.php?serial_no=" . $row['serial_no'] . "' onclick=\"return confirmdelete('$row[serial_no]')\">[Delete]</a></font></td>";
echo "<td>" . $row['critical_spare_id'] . "</td>";
echo "<td>" . $row['serial_no'] . "</td>";
echo "<td>" . $row['comcode'] . "</td>";
echo "<td>" . $row['version'] . "</td>";
echo "<td>" . $row['circuit_pack'] . "</td>";
echo "<td>" . $row['classification'] . "</td>";
echo "<td>" . $row['location'] . "</td>";
echo "<td>" . $row['availability'] . "</td>";
echo "<td>" . $row['date'] . "</td>";
echo "<td>" . $row['client'] . "</td>";
}

?>
</table>

<style>
#pageContent 
{
    width:100%;
    height:18cm;
    overflow:scroll;
}
</style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T08:37:06.853

将表内容回显到 div 内的新表中，该表应用了以下 css：

```
width:auto; /* or what you need it to be */
height: 500px; /* make this the size you want the data to be displayed in */
overflow: auto; /* this adds the scroll bars to the div when any data exceeds its hieght */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-17T02:20:36.030

您只需要添加

```
table tbody{
  display: block;
  height: 150px;
  overflow-x: auto;
  overflow-y: scroll;
} 
```

> 在`height`添加您需要的默认值

# c++ - 给定一个指向容器的指针，我将如何向它添加一个项目？

> ID：10378079
> 
> 赞同：0
> 
> 时间：2012-04-30T03:15:25.820
> 
> 标签：c++, arrays, pointers, insertion

我正在尝试创建一个数组，该数组在每个元素处保存一个指向容器的指针。容器是队列类型，基本上是一个链表队列。我想在给定索引处将一个项目添加到链表中，但我不知道该怎么做。

这是正在初始化的数组：

```
Queue<string> * table;

table = new Queue<string>[tableSize]; 
```

这就是我想要的（我知道它不起作用）：

```
table[5] = "SomeString"; 
```

我试过了：

```
Queue<string> *ptr = table[5];
ptr->insert(SomeString); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T03:22:38.653

> 我正在尝试创建一个数组，该数组在每个元素处保存一个指向容器的指针。

对于本地数组：

```
Queue<string> *table[tableSize]; 
```

对于堆分配数组：

```
Queue<string> ** table;
table = new Queue<string>*[tableSize]; 
```

使用任何一个相同的：

```
table[5]->insert("Some String"); 
```

但是，我建议您放弃裸指针和手动分配。使用`std::vector<Queue<string>>`：

```
std::vector<Queue<string>> v(tablesize);
v[5].insert("Some String"); 
```

# google-app-engine - Google Appengine：db.LinkProperty 与 db.URLProperty

> ID：10378080
> 
> 赞同：1
> 
> 时间：2012-04-30T03:15:27.757
> 
> 标签：google-app-engine

在 appengine 中有很多使用属性类型 db.URLProperty 的示例，但它没有在[https://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses](https://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses)中列出。这是否被 db.LinkProperty 弃用了？我似乎找不到关于弃用的文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T03:58:59.917

URLProperty 只是 LinkProperty 的别名。请使用其中任何一个。也许我们应该明确地记录它。

# python - 违反了 CPython 中的字符串不变性

> ID：10378083
> 
> 赞同：15
> 
> 时间：2012-04-30T03:15:55.113
> 
> 标签：python, string, fuzzy

这更像是我在尝试理解的 Python 模块中遇到的“有趣”现象，而不是寻求帮助（尽管解决方案也很有用）。

```
>>> import fuzzy
>>> s = fuzzy.Soundex(4)
>>> a = "apple"
>>> b = a
>>> sdx_a = s(a)
>>> sdx_a
'A140'
>>> a
'APPLE'
>>> b
'APPLE' 
```

是的，所以[模糊](http://pypi.python.org/pypi/Fuzzy)模块完全违反了 Python 中字符串的不变性。它能够做到这一点是因为它是 C 扩展吗？这是否构成 CPython 以及模块中的错误，甚至是安全风险？

另外，任何人都可以想出一种方法来解决这种行为吗？我希望能够保留字符串的原始大小写。

干杯，

亚历克斯

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-30T03:58:02.553

这个错误[早在二月份](https://bitbucket.org/yougov/fuzzy/issue/1/soundex-modifies-input-argument)就解决了；更新您的版本。

要回答您的问题，是的，有几种方法可以在 C 级别修改不可变类型。在这一点上，安全影响是未知的，甚至可能是不可知的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T03:50:03.537

我对 CPython 不太了解，但它看起来像在`fuzzy.c`声明`char *cs = s`中，在哪里`s`输入`__call__`. 然后它 mutates `cs[i]`，这显然会发生变异`s[i]`，因此是原始字符串。这绝对是 Fuzzy 的一个错误，您应该将其归档在[bitbucket](https://bitbucket.org/yougov/fuzzy/issues)上。正如格雷格的回答所说，使用`''.join(a)`将创建一个新副本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-30T03:18:28.113

我现在没有`fuzzy`可用于测试的模块，但以下创建了一个具有新标识的字符串：

```
>>> a = "hello"
>>> b = ''.join(a)
>>> b
'hello'
>>> id(a), id(b)
(182894286096, 182894559280) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T03:49:36.653

如果它更改了不可变字符串，这是一个错误，您可以通过以下方式绕过它：

```
s(a.upper()) 
```

# eclipse - 如何在 Eclipse 插件开发中禁用/启用视图工具栏菜单/操作

> ID：10378087
> 
> 赞同：1
> 
> 时间：2012-04-30T03:17:24.623
> 
> 标签：eclipse, eclipse-plugin, swt, eclipse-rcp, jface

我有延伸的观点`ViewPart`。在这个视图中，我想添加工具栏菜单。

据我所知，我们可以使用`ActionContributionItem`or添加工具栏菜单`Action`，并将其添加到`ToolBarMenu`from `createPartControl`方法中`ViewPart`。

但我不知道的是：我们如何以编程方式禁用/启用工具栏菜单？

所以基本上，我想将*Play*、*Stop*和*Pause*按钮​​添加到工具栏视图。因此，起初，*播放*按钮处于启用模式，而其他按钮则处于禁用状态。当我按下*播放*按钮时，它被禁用，其他的将被启用。

有关更多详细信息，我想要实现的是如下图所示。

红色圆圈中为禁用按钮，蓝色圆圈中为启用按钮。

[![看法](../Images/a3226c4ffeb0c2a4188034414b0b7a57.png)](https://i.stack.imgur.com/CotgL.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T05:15:58.297

不要使用动作，而是看一下 Eclipse 命令（它们以更简洁的方式替代动作和功能）：[http ://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/指南/workbench_cmd.htm](http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/guide/workbench_cmd.htm)

您将在文档中看到您可以启用和禁用命令，并且所有使用它的地方都会自动正确更新它们的状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T04:25:55.837

我在谷歌上偶然发现了另一种方法。这种方法使用 ISourceProvider 来提供变量状态。因此，我们可以在该类（实现 ISourceProvider）中提供命令的启用/禁用状态。这是详细链接[http://eclipse-tips.com/tutorials/1-actions-vs-commands?showall=1](http://eclipse-tips.com/tutorials/1-actions-vs-commands?showall=1)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-09T13:01:10.737

尝试这个..

1：实施你的行动。例如：PlayAction、StopAction。

```
Public class StartAction extends Action {

@Override
public void run() {
    //actual code run here
}

@Override
public boolean isEnabled() {
    //This is the initial value, Check for your respective criteria and return the appropriate value.
    return false;
}

@Override
public String getText() {
    return "Play";
}
} 
```

2：注册您的视图部分（玩家视图部分）

```
Public class Playerview extends ViewPart
    {

 @Override
public void createPartControl(Composite parent) {

 //your player UI code here.

    //Listener registration. This is very important for enabling and disabling the tool bar level buttons
     addListenerObject(this);

    //Attach selection changed listener to the object where you want to perform the action based on the selection type. ex; viewer
    viewer.addselectionchanged(new SelectionChangedListener())  

      }
        }

    //selection changed

    private class SelectionChangedListener implements ISelectionChangedListener        {

    @Override
    public void selectionChanged(SelectionChangedEvent event) {
        ISelection selection = Viewer.getSelection();
        if (selection != null && selection instanceof StructuredSelection) {
            Object firstElement = ((StructuredSelection)selection).getFirstElement();

            //here you can handle the enable or disable based on your selection. that could be your viewer selection or toolbar.
            if (playaction.isEnabled()) { //once clicked on play, stop  should be enabled.
                stopaction.setEnabled(true); //Do required actions here.
                playaction.setEnabled (false);  //do

            }

        }

    }

    } 
```

希望这会对你有所帮助。

# c - C API返回指定时区的时间字符串？

> ID：10378093
> 
> 赞同：6
> 
> 时间：2012-04-30T03:18:58.940
> 
> 标签：c, timezone

在 C 中，是否有任何 API 可以将`time()`函数返回的时间转换为特定时区？有一个函数`strftime()`可以转换为系统的当前时区。但我想要的是函数输入是时间（由返回`time()`）和 timeZone ，它将以所述时区格式转换特定的格式化时间。

有这样的API吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-30T04:29:44.870

POSIX 指定[`tzset()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/tzset.html)：

> 该`tzset()`函数应使用环境变量 TZ 的值来设置 、 、 和 使用的`ctime`时间`localtime`转换`mktime`信息`strftime`。如果环境中不存在 TZ，则应使用实现定义的默认时区信息。

因此，理论上您可以使用类似这样的东西将`t0`(a `time_t`) 转换为美国/东部时间，而这不是您的默认 TZ：

```
char old_tz[64];
strcpy(old_tz, getenv("TZ"));
setenv("TZ", "EST5", 1);
tzset();
struct tm *lt = localtime(&t0);
char buffer[64];
strftime(buffer, sizeof(buffer), "%Y-%m-%d %H:%M:%S", lt);
setenv("TZ", old_tz, 1);
tzset(); 
```

这会保留旧时区的副本（当您使用这些东西时，您不能依赖它不会更改或超出范围），然后在环境中设置目标时区。然后它告诉系统查看 $TZ 并相应地设置本地时区。然后使用 将给定`time_t`值转换为分解的本地时间`localtime()`，格式化字符串，然后重置 TZ 环境变量并告诉系统再次查看它`tzset()`。

在实践中，这可能有效，也可能无效；这取决于系统。

如果您需要这些东西的线程安全版本，您将不得不更加努力。这绝对不是所写的线程安全的。

示例代码省略了错误检查——它没有任何错误检查。

我永远不会声称这是一种简单的方法。应该有更好的方法。

### 测试代码

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

static void time_convert(time_t t0, char const *tz_value)
{
    char old_tz[64];
    strcpy(old_tz, getenv("TZ"));
    setenv("TZ", tz_value, 1);
    tzset();
    char new_tz[64];
    strcpy(new_tz, getenv("TZ"));
    char buffer[64];
    struct tm *lt = localtime(&t0);
    strftime(buffer, sizeof(buffer), "%Y-%m-%d %H:%M:%S", lt);
    setenv("TZ", old_tz, 1);
    tzset();
    printf("%ld = %s (TZ=%s)\n", (long)t0, buffer, new_tz);
}

int main(void)
{
    time_t t0 = time(0);
    char *tz = getenv("TZ");
    time_convert(t0, tz);
    time_convert(t0, "UTC0");
    time_convert(t0, "IST-5:30");
    time_convert(t0, "EST5");
    time_convert(t0, "EST5EDT");
    time_convert(t0, "PST8");
    time_convert(t0, "PST8PDT");
} 
```

### 测试输出

```
1335761328 = 2012-04-29 23:48:48 (TZ=CST6CDT)
1335761328 = 2012-04-30 04:48:48 (TZ=UTC0)
1335761328 = 2012-04-30 10:18:48 (TZ=IST-5:30)
1335761328 = 2012-04-29 23:48:48 (TZ=EST5)
1335761328 = 2012-04-30 00:48:48 (TZ=EST5EDT)
1335761328 = 2012-04-29 20:48:48 (TZ=PST8)
1335761328 = 2012-04-29 21:48:48 (TZ=PST8PDT) 
```

请注意，当 EST 和 PST 的字符串没有指定夏令时代码时，您将获得一个时区偏移量；当设置了夏令时代码（例如`"EST5EDT"`或`"PST8PDT"`）并且要打印的时间在一年中的适当时间（例如四月底）时，您将打印 EDT 或 PDT 时间值。

还要注意，关于如何处理时区的 ISO 标准存在冲突。ISO 8601（用于日期/时间格式）表示 UTC（格林威治）以东的时区为正，UTC 以西的时区为负。至少一些其他标准（例如 SQL、ISO 9075）使用相同的符号。另一方面，POSIX（又名 ISO 9945）在 TZ 中使用相反的约定，如示例代码所示。仅由于长期存在的先例，才接受冲突。C 标准对 TZ 环境变量的格式（或存在）保持沉默（尽管 C99 §7.23.3.5*该`strftime`函数*确实多次引用 ISO 8601）。

而且（就像一个有益的提醒，为什么错误检查是一个好主意），在 Mac OS X 10.7.3 上，我的环境中没有设置 TZ（但它通常是美国/太平洋，又名库比蒂诺，又名美国/洛杉矶， 时间）。所以上面的代码在`getenv()`返回空指针时会崩溃。我`TZ=CST6CDT`在环境中运行它，从输出的第一行可以看出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T04:13:49.723

这里真的有三个步骤。首先，a`time_t`代表一个绝对时间戳——至少在概念上是 UTC 时间戳的顺序。它不是（通常）在任何特定时区 - 它通常表示自某个时期（通常是 1970 年 1 月 1 日午夜）以来的秒数。

您可以将其转换为 a `struct tm`，将时间戳分解为实际的日期和时间——年、月、日、小时、分钟和秒。有两个函数可以进行这种转换：`gmtime`，它将其保留为 UTC 风格的时间（即，在格林威治时区）。另一个是`localtime`，它将其转换为环境已配置为认为代表机器位置的任何时区。

下一步是使用`strftime`将其转换为可读的内容。这是基于当前的语言环境，所以（例如）当我写这篇文章时，我认为它是“星期天”。但是，如果我的机器配置为西班牙语，那可能会显示为“Domingo”或该命令中的其他内容。

你真的有两个完全不同的问题。您只能将 a`time_t`转换为两个时区之一的时间：“本地”时区（至少，无论机器被配置为什么“本地”），或格林威治时间。如果您想要任何其他时区，您几乎会被转换为 GM 时间，然后调整到您选择的时区。

有更多用于调整格式的规定。默认情况下，该库将始终转换为“C”语言环境，这几乎是美国英语的简化版本。您还可以设置无名语言环境 ("")，它会为您提供一个假定与机器配置方式相匹配的语言环境。作为第三种选择，大多数图书馆都允许您为特定语言环境指定名称，因此，如果您希望将日期格式化为加拿大法语区的人所期望的，您可以将语言环境设置为“French_Canada”这就是你得到的（虽然你使用的字符串因标准库而异，所以你可能需要使用类似“fr-can”的东西）。

# .net - sqlite 1.0.80.0 .NET 4 和实体框架

> ID：10378094
> 
> 赞同：0
> 
> 时间：2012-04-30T03:19:02.490
> 
> 标签：.net, sqlite, frameworks, entity

我对 sqlite 1.0.80.0（sqlite-netFx40-setup-bundle-x86-2010-1.0.80.0.exe）有一个奇怪的问题。

首先，我在 Visual Studio 2010 SP1 中安装了 sqlite 1.0.66。我将其卸载以安装最新版本的 system.data.sqlite(1.0.80.0)。安装顺利，没有错误。我制作了一个项目（控制台应用程序）并创建了一个实体框架对象（.edmx）文件。我可以轻松连接 sqlite 文件并从 sqlite 数据库生成模型。

当我尝试运行包含简单 LINQ 请求以从数据库获取某些内容的应用程序时，问题就开始了。我收到以下错误：

> **System.Security.VerificationException ：操作可能会破坏运行时的稳定性。**

我尝试了无数的事情，看看我是否能解决这个问题。但到目前为止还没有解决方案。我尝试使用 sql server 2008，它工作正常。所以 system.data.sqlite 有问题还是我做错了什么？

为了尝试一切，我在 Visual Studio 2010 SP1 上安装了 sqlite 1.0.66，它适用于同一个项目！

有人知道原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T09:02:30.073

Maybe it has something to do with using the bundle package. I just did some research on what is the right package/distribution for me and read through [this article](http://system.data.sqlite.org/index.html/doc/trunk/www/downloads.wiki).

"All the "bundle" packages contain the "System.Data.SQLite.dll" mixed-mode assembly. These packages should only be used in cases where the assembly binary must be deployed to the Global Assembly Cache for some reason (e.g. to support some legacy application on customer machines)."

further...

"Using the Global Assembly Cache (at all) is not recommended; therefore, the "bundle" packages should be avoided unless deemed absolutely necessary."

So giving the XCOPY deployment in conjunction with the native library pre-loading feature a try wouldn't hurt.

# matlab - 在 MATLAB 中的 FOR 循环中绘制多条线

> ID：10378095
> 
> 赞同：0
> 
> 时间：2012-04-30T03:19:28.703
> 
> 标签：matlab

好的，这听起来很容易，但无论我尝试了多少次，我仍然无法正确绘制它。我在同一张图上只需要 3 条线，但仍然有问题。

```
iO = 2.0e-6;
k = 1.38e-23;
q = 1.602e-19;

for temp_f = [75 100 125]
    T = ((5/9)*temp_f-32)+273.15;
        vd = -1.0:0.01:0.6;
        Id = iO*(exp((q*vd)/(k*T))-1);
        plot(vd,Id,'r',vd,Id,'y',vd,Id,'g');
        legend('amps at 75 F', 'amps at 100 F','amps at 125 F');    

end;       

ylabel('Amps');
xlabel('Volts');
title('Current through diode'); 
```

现在我知道他们当前的绘图功能不起作用，并且需要设置某种变量，例如 (vd,Id1,'r',vd,Id2,'y',vd,Id3,'g'); 但是我真的无法掌握改变它的概念并正在寻求帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T03:57:20.220

您可以使用“保持”功能来使每个绘图命令与上一个绘图命令在同一窗口上绘图。

最好跳过 for 循环，而只需一步完成。

```
iO = 2.0e-6; 
k = 1.38e-23; 
q = 1.602e-19; 

temp_f = [75 100 125];
T = ((5/9)*temp_f-32)+273.15;

vd = -1.0:0.01:0.6;
% Convert this 1xlength(vd) vector to a 3xlength(vd) vector by copying it down two rows.
vd = repmat(vd,3,1);

% Convert this 1x3 array to a 3x1 array.
T=T';
% and then copy it accross to length(vd) so each row is all the same value from the original T
T=repmat(T,1,length(vd));

%Now we can calculate Id all at once.
Id = iO*(exp((q*vd)./(k*T))-1);

%Then plot each row of the Id matrix as a seperate line. Id(1,:) means 1st row, all columns.
plot(vd,Id(1,:),'r',vd,Id(2,:),'y',vd,Id(3,:),'g');
ylabel('Amps'); 
xlabel('Volts'); 
title('Current through diode'); 
```

这应该得到你想要的。

# java - 摆脱（隐藏）Android TabWidget 的“聚焦状态”

> ID：10378096
> 
> 赞同：1
> 
> 时间：2012-04-30T03:19:28.893
> 
> 标签：java, android, tabwidget

好的，这就是这个想法；我想创建一组图标，这些图标在我的应用程序上的所有活动中持续存在于屏幕底部。我首先想到的是 TabWidget。

在我花了一些时间之后，我意识到我无法从标签中获得“聚焦状态”，我知道标签应该以这种方式工作，但我的想法是让这些标签看起来像图标 - 它不应该t 看起来他们一直很专注。

我尝试使用`tabHost.setBackgroundColor(color)`，但不幸的是它没有按我的预期工作。

这里有一些可视化来缓解这个问题.. [http://i.stack.imgur.com/uF7fu.png](http://i.stack.imgur.com/uF7fu.png)

*ps，对不起链接。作为新用户，我不允许直接在帖子上发布图片。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T03:41:50.463

一种方法是`Selector`对选项卡状态使用自定义，无论选项卡是否具有焦点。这可能看起来像这样：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <!-- Non focused states -->
    <item android:state_focused="false" android:state_selected="false" android:state_pressed="false" android:drawable="@drawable/tab_unselected" />
    <item android:state_focused="false" android:state_selected="true" android:state_pressed="false" android:drawable="@drawable/tab_unselected" />

    <!-- Focused states -->
    <item android:state_focused="true" android:state_selected="false" android:state_pressed="false" android:drawable="@drawable/tab_unselected" />
    <item android:state_focused="true" android:state_selected="true" android:state_pressed="false" android:drawable="@drawable/tab_unselected" />

    <!-- Pressed -->
    <item android:state_pressed="true" android:drawable="@drawable/tab_press" />
</selector> 
```

您将其添加到您的可绘制目录中，然后配置您的 tabwidget 以在您的活动中使用它（就像这样）：

```
TabWidget tabWidget = getTabWidget();

for(int i = 0; i < tabWidget.getChildCount(); i++) {
RelativeLayout tabLayout = (RelativeLayout) tabWidget.getChildAt(i);
tabLayout.setBackgroundDrawable(res.getDrawable(R.drawable.tab_indicator));
} 
```

更详细的指南在[这里](http://ondrejcermak.info/programovani/custom-tabs-in-android-tutorial/comment-page-1/)。看看这是否适合你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T03:44:43.103

一般来说，您应该有一个“聚焦状态”来指示那些没有触摸屏的设备（即 Google TV）的活动状态，或者帮助视障者使用辅助工具。如果您仍然想沿着隐藏“聚焦状态”的路线走，请参阅 Femi 关于自定义选择器的回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T03:47:23.867

修改像 Femi 显示的选定样式是执行此操作的方法。

# regex - 正则表达式模式以允许带有大小检查的字母数字和特殊 char(,-\s)

> ID：10378101
> 
> 赞同：0
> 
> 时间：2012-04-30T03:20:03.697
> 
> 标签：regex, validation

我想检查一个只包含字母数字和几个特殊字符的字符串：

1) 破折号
2) 空格
3) 点

大小仅 3-255 个字符。

但我下面的表达式似乎不起作用..我认为尺寸有问题..

`@Pattern(regexp = "^[-a-zA-Z\s\.]{3,255}+$"`

我什至试过这个：

`@Pattern(regexp = "^[-a-zA-Z\s\.]\w{2,256}+$"`

但是由于 \w 字符，这引起了大小验证的问题 - 因为我猜它只接受字母数字而不是特殊字符......

任何想法？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T03:29:01.477

破折号也是特殊键。添加反斜杠。而且你不需要 + 到最后。

```
^[\-a-zA-Z0-9\s\.]{3,255}$ 
```

# webkit - webkit 检查器在页面更改时丢失网络数据

> ID：10378103
> 
> 赞同：1
> 
> 时间：2012-04-30T03:20:35.217
> 
> 标签：webkit, inspector

在 Safari 和 Chrome 中，当页面 URL 更改时，我在检查器中丢失了所有网络数据——即使在 URL 更改后，我如何才能将这些数据保留足够长的时间以捕捉我需要的内容/引用该数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T15:13:36.240

在网络选项卡上，底部工具栏（靠近左侧）有一个黑色圆圈。此按钮允许您保留所有数据，直到您清除它（通过单击带有对角线的空心圆圈）或关闭检查器。单击按钮，圆圈将变为红色，表示正在记录所有数据。当圆圈为红色时，您不会丢失任何记录的数据。

# asp.net - 导出为 PDF 到本地文件夹

> ID：10378108
> 
> 赞同：2
> 
> 时间：2012-04-30T03:21:48.753
> 
> 标签：asp.net, windows, reporting-services

我有一个 Asp.net C# windows 应用程序，我在其中调用 SSRS 报告。我希望在我的页面中有一个名为“导出到 pdf”的功能，并且以下 pdf 必须保存到本地文件夹中。是否可以通过编码或其他方式.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T03:41:11.010

使用[WkHtml](http://code.google.com/p/wkhtmltopdf/) 或[itextSharp](http://sourceforge.net/projects/itextsharp/)在开源项目中获得更好的性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T08:32:49.980

是的，但是如果您使用 SOAP 访问报表服务器，则需要自己构建它。如果您正在使用报表查看器控件或 URL 访问，则该功能应该已经存在。

# c - C中的斩波路径

> ID：10378112
> 
> 赞同：2
> 
> 时间：2012-04-30T03:22:50.027
> 
> 标签：c, string, filepath

我想先说我很少用 C 语言进行编程，所以我更愿意知道为什么给定的解决方案有效，而不仅仅是它是什么。

我正在尝试编写一个函数，该函数将采用路径名，并将路径名返回到同一目录中的不同文件。

```
 "/example/directory/with/image.png" => "/example/directory/with/thumbnail.png" 
```

在阅读了`realpath`and的示例用法`dirname`（我正在使用 Linux；如果有跨平台的等价物，请告诉我）之后，我尝试过的是：

```
#include <limits.h>
#include <string.h>
#include <stdio.h>
#include <stdlib.h>

char *chop_path(char *orig) {
  char buf[PATH_MAX + 1];
  char *res, *dname, *thumb;

  res = realpath(orig, buf);
  if (res) {
    dname = dirname(res);
    thumb = strcat(dname, "/thumbnail.png");
    return thumb;
  }
  return 0;
} 
```

编译它似乎工作，但运行程序

```
int main(void) {
  char *res = chop_path("original.png");
  if (res) {
    printf("Resulting pathname: %s", res);
  } 
  return 0;
} 
```

给我一个段错误。有什么提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T03:29:13.890

我看到的唯一问题是您的`chop_path`例程的签名；它应该是

```
char *chop_path(char *orig) { 
```

您的版本缺少`*`. 这实际上有很大的不同；如果没有`*`，您实际上是在将参数字符串`dirname`中`realpath`第一个字符的字符代码解释为数字地址（即指向路径的指针）。这将指向您肯定没有分配的低内存位置；尝试使用它会导致“分段错误”错误，这实际上意味着您正在尝试访问不允许的内存。

另一个问题是该`dirname()`函数是在 中声明的`libgen.h`，而您没有包括在内。如果您不包含该标头，编译器会假定`dirname()`返回`int`而不是指针，并且在 64 位架构上，来自函数的 64 位返回值被削减为 32 位，错误的指针被分配给`dname`，并且这将导致您的 seg 错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T03:51:29.183

如果您不想使用`dirname`, `realpath`, 不需要的字符串缓冲区和字符串操作等 - 您可以执行以下操作：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <limits.h>

#define FILE_MAX 100

void chop_path(char path_name[], char new_file[]) {
    int len = strlen(path_name);
    int i;

    for (i=len-1; i>0 ; i--) {
        if (path_name[i] == '/') {
            strcpy(path_name+i+1, new_file);
            break;
        }   
    }   

    return;
}

int main(void) {
    char path[PATH_MAX + 1] = "/this/is/a/path/filename.c";
    char new_file[FILE_MAX] = "newfilename.txt";

    printf("old : %s \n", path);
    chop_path(path, new_file);
    printf("new : %s \n", path);

    return 0;
} 
```

输出：

```
$ gcc path.c 
$ ./a.out 
old : /this/is/a/path/filename.c 
new : /this/is/a/path/newfilename.txt 
$ 
```

# objective-c - 导航控制器：在横向模式下，“返回”动画会向下推

> ID：10378115
> 
> 赞同：1
> 
> 时间：2012-04-30T03:24:04.223
> 
> 标签：objective-c, uinavigationcontroller, uitabbarcontroller

我在标签栏控制器中有一个导航控制器。在横向模式下，后退按钮动画会向下而不是向右推动。

我需要做什么才能让它像在纵向模式下一样向右推？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T03:30:22.127

如果您的 UIViewController 之一没有横向支持，我之前已经看到过这种情况。

仔细检查您`shouldAutorotateToInterfaceOrientation`的两个 UIViewControllers 并确保它们都为纵向和横向返回 YES。

# node.js - 模拟/测试 Mongodb 数据库 Node.js

> ID：10378116
> 
> 赞同：28
> 
> 时间：2012-04-30T03:24:20.580
> 
> 标签：node.js, mongodb, integration-testing, mocha.js, zombie.js

我正在学习 nodejs，并且我有一个必须与之交互的 mongodb 数据库。我目前正在考虑将 mocha 用于单元测试框架，将zombie.js 用于验收测试框架。我想知道如何进行全面的验收测试来影响 mongodb 数据库。是否有一个框架/模块可以帮助用测试数据库替换数据库，或者 mocha 或zombie.js 是否具有可以轻松用于替换数据库的功能。

还有一个框架类似于创建数据库对象的工厂（而不是固定装置）的想法。

我在 Rails 世界中遇到的一个类似概念是在 rspec 中，有一个 spec_helper.rb 文件在运行测试之前运行，它设置项目配置来决定在运行测试时要访问哪个数据库。它使用 database_cleaner 在运行测试之前清理测试数据库。对于工厂，我在 Rails 世界中再次使用 Factory girl 从数据库模式创建工厂对象。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:00:32.307

如果您的数据库访问是一个单独的模块，您可以使用以下方法之一模拟模块或模块的一部分（例如，配置部分）：

*   [诗乃](https://github.com/cjohansen/Sinon.JS)
*   [重新布线](https://github.com/jhnns/rewire)
*   [呼啦](https://github.com/arunoda/horaa)
*   [沙盒模块](https://github.com/felixge/node-sandboxed-module)

以下相关问题的答案列出了许多可能的解决方案/方法： [如何在 Node.js 中模拟 MySQL（没有 ORM）？](https://stackoverflow.com/questions/8389149/how-do-you-mock-mysql-without-an-orm-in-node-js)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-08-03T12:27:50.993

为了启动一个真正的内存中 mongodb 进行测试，[https://github.com/nodkz/mongodb-memory-server](https://github.com/nodkz/mongodb-memory-server)也有帮助。

# php - Drupal PHP - 仅在删除文件上传和保存时出现内部错误

> ID：10378117
> 
> 赞同：2
> 
> 时间：2012-04-30T03:24:29.050
> 
> 标签：php, drupal, drupal-6, drupal-modules

我遇到的问题如下：

我可以创建一个新节点，我有两个用于图像的上传字段，最初可以上传没有问题。

我可以回去编辑节点内容并保存，也没有问题。

当我尝试删除任一图像附件并保存节点时，我收到 500 错误（服务器内部错误）。查看 PHP 日志，这就是我得到的：

```
[Wed Apr 25 23:34:51 2012] [warn] [client 50.138.84.100] mod_fcgid: stderr: PHP Fatal error: Call-time pass-by-reference has been removed in ../www/sites/all/modules/video/transcoders/video_ffmpeg.inc on line 49, referer: https://www.uleru.com/node/xxx/edit 
```

这种用法在几周前就可以使用，最后一次重大变化是一些软件包的服务器升级（运行 Debian）。不确定这是否是阴谋者，但也许有些人看到过类似的东西？

- - - - - - - - - - - - - - - - - - - - - -编辑 - - - --------------------------------------------------------
在那个包裹上做一个节目，这正是发生的事情，ffmpeg 已被 libav-tools 弃用。我试图记住在 Drupal Admin 中更改 ffmpeg 路径的位置。考虑回滚 = /

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T10:01:08.463

这看起来像服务器升级包括切换到 PHP 5.4（“调用时传递引用”在 5.3 中已弃用，并在 5.4 中删除 - 请参阅[通过引用传递](http://php.net/manual/en/language.references.pass.php)）。

因此，这可能是 video_ffmpeg.inc 中的一个错误，因为它试图通过引用传递参数，而这只能通过将参数声明为调用函数签名中的引用来实现。

举个小例子，请参阅[PHP 5.4 Call-time pass-by-reference - Easy fix available?](https://stackoverflow.com/questions/8971261/php-5-4-call-time-pass-by-reference-easy-fix-available)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T03:56:43.893

ffmpeg 路径位于 ffmpeg_wrapper 配置页面中，假设它像几个月前我在 d6 中使用的那样工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-11T09:15:33.753

我通过使用函数**proc_open**而不是 exec 解决了这个问题。

# c# - 从内部对象方法获取线程名称

> ID：10378118
> 
> 赞同：2
> 
> 时间：2012-04-30T03:24:29.167
> 
> 标签：c#, multithreading

我知道我可以通过调用 Thread.CurrentThread.Name 来获取线程名称

但我遇到了一个棘手的情况。

我创建了两个线程，每个线程启动一个新对象（比如 objA）并运行一个方法。

在对象（objA）方法（objAM）中，我创建了另一个对象（比如objB）并运行一个方法（objBM）。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;

namespace ConsoleApplication1
{
    class Program
    {

        static void Main(string[] args)
        {
            TESTA a = new TESTA();
        }

    }

    class TESTA
    {
        private Thread t;

        public TESTA()
        {
            t = new Thread(StartThread);
            t.Name = "ABC";
            t.IsBackground = true;
            t.Start();

            t = new Thread(StartThread);
            t.Name = "XYZ";
            t.IsBackground = true;
            t.Start();

        }

        private void StartThread()
        {
            objA thisA = new objA();
        }
    }

    class objA
    {
        private System.Threading.Timer t1;

        public objA()
        {
            objAM();
            t1 = new Timer(new TimerCallback(testthread), null, 0, 1000);
        }

        private void objAM()
        {
            Console.WriteLine("ObjA:" + Thread.CurrentThread.Name);
        }

        private void testthread(object obj)
        {
            objB thisB = new objB();
        }
    }

    class objB
    {
        public objB()
        {
            objBM();
        }

        private void objBM()
        {
            Console.WriteLine("ObjB:" + Thread.CurrentThread.Name);
        }
    }
} 
```

但是 objB 中 Thread.CurrentThread.Name 的值返回空。

如何获取 objBM 中的线程名称？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T07:18:14.790

根据[System.Threading.Timer](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)的描述：该方法不在创建计时器的线程上执行；它在系统提供的 ThreadPool 线程上执行。

因此，您的`testthread`方法在未命名的 ThreadPool 线程上执行。顺便说一句，您可以通过调用来验证它`Thread.CurrentThread.IsThreadPoolThread`。

# php - 如何为控制器操作设置页面标题？

> ID：10378119
> 
> 赞同：6
> 
> 时间：2012-04-30T03:24:57.657
> 
> 标签：php, controller, yii

我想为每个控制器和动作设置不同的标题（在头部）。如何从控制器执行此操作？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-30T08:32:03.370

## 你的控制器

```
 class SiteController {
        public function actionIndex() {
            $this->pageTitle = 'Home page';
            //...
        }

        //..
    } 
```

## 布局文件

```
 <title><?php echo $this->pageTitle; ?></title> 
```

也许你忘了在你的 html 中添加引用？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-30T14:34:46.393

## 如果您想在每个操作中使用不同的标题

然后只需[`CController.pageTitle`](http://www.yiiframework.com/doc/api/1.1/CController#pageTitle-detail)在您的操作中设置值：

```
class MyController extends CController {
    public function actionIndex() {
        $this->pageTitle = "my title";
        // other code here
    }
} 
```

## 如果您想在多个操作之间共享特定标题

一种方法是简单地遵循上述方法，可能使用类常量作为页面标题：

```
class MyController extends CController {
    const SHARED_TITLE = "my title";

    public function actionIndex() {
        $this->pageTitle = self::SHARED_TITLE;
        // other code here
    }

    public function actionFoo() {
        $this->pageTitle = self::SHARED_TITLE;
        // other code here
    }
} 
```

但是，这要求您在想要在“标题共享”方案中包含或排除每个操作时分别访问它。没有这个缺点的解决方案是使用[过滤器](http://www.yiiframework.com/doc/guide/1.1/en/basics.controller#filter)。例如：

```
class MyController extends CController {
    public function filters() {
        // set the title when running methods index and foo
        return array('setPageTitle + index, foo');

        // alternatively: set the title when running any method except foo
        return array('setPageTitle - foo');
    }

    public function filterSetPageTitle($filterChain) {
        $filterChain->controller->pageTitle = "my title";
        $filterChain->run();
    }

    public function actionIndex() {
        // $this->pageTitle is now set automatically!
    }

    public function actionFoo() {
        // $this->pageTitle is now set automatically!
    }
} 
```

## 如果您想在所有操作中使用相同的标题

这很明显，但为了完整起见，我提到它：

```
class MyController extends CController {
    public $pageTitle = "my title";

    public function actionIndex() {
        // $this->pageTitle is already set
    }

    public function actionFoo() {
        // $this->pageTitle is already set
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T05:03:37.627

您可以使用函数 init 或 before action 或在实际操作调用之前运行 which call。因此，在该函数中，您可以为控制器设置公共 pageTitle 变量。

像这样使用：

```
public function init()
{
  parent::init();
  $this->pageTitle = "My Page Title";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T05:32:21.160

你可以这样给：-

```
$this->set("title", "Enrollment page"); 
```

并通过给出不同的名称或标题在你的 ctp 文件中使用这个 $title..

试试这个..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-09T08:52:29.690

在 VIEW 页面中（index.php、view.php、create.php 等）

```
$this->setPageTitle('custom page title'); 
```

# python - 在其他类中调用模块

> ID：10378121
> 
> 赞同：0
> 
> 时间：2012-04-30T03:25:27.043
> 
> 标签：python, class, module

所以我有一个 close() 方法，当用户单击关闭按钮时会调用该方法。关闭方法如下：

```
def close(self):
    ThreadedClient.endApplication()

    root.destroy() 
```

close() 方法位于 GUI() 类中。close 方法需要调用 ThreadedClient 类中的 endApplication() 方法。但相反，它给了我这个错误：

```
TypeError: unbound method endApplication() must be called with ThreadedClient instance as first argument (got nothing instead) 
```

这可能是一个简单的解决方案，但我只是不知道如何解决它。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T03:28:06.430

您需要问的问题是*需要* `ThreadedClient`调用`.endApplication()`它。

一旦你有对它的引用（假设你将引用存储在 中`self`）

```
def close(self):
    self.threaded_client.endApplication()
    # ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T03:28:18.883

显然，`endApplication()`是一个实例方法，而是`ThreadedClient`一个*类*。您需要向它提供`ThreadedClient`要结束的实际实例。

例如，如果您在其他地方创建了一个线程客户端...

```
foo = ThreadedClient() 
```

然后稍后你需要打电话...

```
foo.endApplication() 
```

# antlr - antlr 令牌长度和错误处理

> ID：10378123
> 
> 赞同：0
> 
> 时间：2012-04-30T03:25:55.677
> 
> 标签：antlr

我正在使用 altlr 3.4 版。

第一个问题，请看语法：

```
request: 'C' DELIM source DELIM target
  { System.out.println("Hi"); }
  ;
source: ID ;
target: ID ;

DELIM: '|' ;
fragment ALPHA: 'a'..'z' | 'A'..'Z' ;
fragment NUM: '0'..'9' ;
ID: ALPHA (ALPHA | NUM)* ; 
```

“源”和“目标”不能为空。但我的测试显示以下内容：

*   对于输入 "C|n1|n2" ：正常情况，没问题。
*   对于输入“C||n2”：语法错误，并且未打印“Hi”。预期的。好的
*   对于输入“C|n1|” : 语法错误，但打印“Hi”。不好。

如果达到“请求”令牌，我确实需要设置其他内容。但是从上面看，即使是语法错误，代码仍然会到达“请求”令牌。为什么？

第二个问题：如何为固定长度令牌指定规则，例如，精确 10 位的令牌？

第三个问题是关于错误处理的。我在解析器中覆盖了 emitErrorMessage() 以设置错误标志，但我在词法分析器中发现了另一个 emitErrorMessage() 。我不想在解析器和词法分析器对象之间共享错误标志。我可以在词法分析器中覆盖 emitErrorMessage() 而不做任何事情，并且完全依赖解析器来报告错误吗？或者换一种说法，如果有错误，解析器会确定捕获它吗？

并且如果为一个错误设置了错误标志，那么解析器是否真的可以恢复并匹配另一个规则，所以之前的错误是误报？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T06:41:14.647

> *   ...
> *   对于输入“C|n1|” : 语法错误，但打印“Hi”。不好。
> 
> 如果达到“请求”令牌，我确实需要设置其他内容。但是从上面看，即使是语法错误，代码仍然会到达“请求”令牌。为什么？

因为解析器试图从中恢复。如果您不希望解析器（尝试）从不匹配的标记中恢复，只需抛出如下异常：

```
grammar T;

// options...

@members {
  @Override
  public void emitErrorMessage(String message) {
    throw new RuntimeException(message);
  }
}

request
 : 'C' DELIM source DELIM target { System.out.println("Hi"); }
 ;

// more rules... 
```

请注意，它`@members`是 的缩写`@parser::members`，它只会导致`emitErrorMessage(...)`在解析器中被覆盖，而不是在词法分析器中。对于词法分析器成员，您需要执行`@lexer::members`.

> 第二个问题：如何为固定长度令牌指定规则，例如，精确 10 位的令牌？

请参阅：[ANTR3 设置令牌接受的字符数](https://stackoverflow.com/questions/10373620/antr3-set-the-number-of-accepted-characters-for-a-token)

> 第三个问题是关于错误处理的。...

请参阅我的答案的第一部分：只需覆盖`emitErrorMessage()`并在其中不执行任何操作（默认操作是在 上打印`std.err`）。

> 我可以在词法分析器中覆盖 emitErrorMessage() 而不做任何事情，并且完全依赖解析器来报告错误吗？

好吧，解析器和词法分析器处理不同的类型或错误，因此忽略词法分析器中的某些问题可能不会导致解析器产生警告/错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T01:35:40.020

巴特，你的帮助很棒。我也深思熟虑并理解问题#1 的行为是合法的。像编译器一样，解析器将恢复并继续找到尽可能多的错误。

对于问题#2，我还想出了一些固定长度的方法。不知道是不是流行的方式：

示例：精确 3 '|' 精确4；

// 方法 1:
exact3 : (d+=DIGIT)+ {$d!=null && $d.size()==3}? ;

// 方法 2
精确 4 : atmost4 {$atmost4.text.length()==4}? ;
atmost4:
@init {int n=1;}
: ({n<=4}?=>DIGIT {n++;})+
;

数字：'0'..'9'；

对于问题#3，我会在第一个错误时失败，即在词法分析器和解析器中覆盖 emitErrorMessage() 以引发异常。选择 emitErrorMessage(msg) 是因为它已经正确准备了错误消息。

感谢所有分享的人！

# cuda - CUDA GPU 比 CPU 慢

> ID：10378124
> 
> 赞同：3
> 
> 时间：2012-04-30T03:25:58.020
> 
> 标签：cuda

我无法弄清楚为什么我的 cuda 代码运行速度比我的 cpu 代码慢

我的桌面配置是i7 2600S，geforce 560ti

我的代码如下：

```
int** kernel_shiftSeam(int **MCEnergyMat, int **newE, int *seam, int width, int height,     int direction)
{
//time measurement
float elapsed_time_ms = 0;
cudaEvent_t start, stop; //threads per block

dim3 threads(16,16);
//blocks
dim3 blocks((width+threads.x-1)/threads.x, (height+threads.y-1)/threads.y);

int *device_Seam;

int *host_Seam;

int seamSize;
if(direction == 1)
{
    seamSize = height*sizeof(int);
    host_Seam = (int*)malloc(seamSize);
    for(int i=0;i<height;i++)
    host_Seam[i] = seam[i];
}
else
{
    seamSize = width*sizeof(int);
    host_Seam = (int*)malloc(seamSize);
    for(int i=0;i<width;i++)
        host_Seam[i] = seam[i];
}

cudaMalloc((void**)&device_Seam, seamSize);
cudaMemcpy(device_Seam, host_Seam, seamSize, cudaMemcpyHostToDevice);

global_host_MC = MCEnergyMat;
new_host_MC = newE;

//copy host array to device
cudaMemcpy(global_MC, global_MC2, sizeof(int*)*width, cudaMemcpyHostToDevice);
    for(int i=0;i<width;i++)
        cudaMemcpy(global_MC2[i], global_host_MC[i], sizeof(int)*height, cudaMemcpyHostToDevice);

cudaMemcpy(new_MC, new_MC2, sizeof(int*)*width, cudaMemcpyHostToDevice);
    for(int i=0;i<width;i++)
        cudaMemcpy(new_MC2[i], new_host_MC[i], sizeof(int)*height, cudaMemcpyHostToDevice);

cudaEventCreate(&start);
cudaEventCreate(&stop);
cudaEventRecord(start, 0);

//do some operations on the 2d matrix
gpu_shiftSeam<<< blocks,threads >>>(global_MC, new_MC, device_Seam, width, height);

//measure end time for cpu calcuations
cudaEventRecord(stop, 0);
cudaEventSynchronize(stop);
cudaEventElapsedTime(&elapsed_time_ms, start, stop );

execTime += elapsed_time_ms;

//copy out the data back to host (RESULT)
for(int i=0;i<width;i++)
{
    cudaMemcpy(newE[i], new_MC2[i], sizeof(int)*height, cudaMemcpyDeviceToHost);
}

return newE;
} 
```

我循环了 800 次，得到了以下结果：

GPU 计算时间（gpu_shiftseam 部分）：1176 毫秒总程序运行时间：22 秒

CPU 计算时间（与 gpu_shiftseam 相同的操作，但在主机上）：12522ms 总程序运行时间：12s

显然 GPU 的计算时间比 CPU 上的要短，但由于某种原因，gpu 的总程序运行时间要长得多，有人知道为什么吗？是因为我分配的线程/块数不正确吗？还是来自在设备上分配内存的“缓慢”？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T05:01:14.867

Im my experience memory accesses are the #1 reason for slowness.

Profile your array copies to see how much time is being spent. If it is a considerable amount, perhaps try optimizing your code. Instead of copying inside of a for-loop, perhaps see if you can copy `sizeof(int *) * height * width` directly. Reducing the amount of times you call memcpy should help.

```
cudaMemcpy(global_MC, global_MC2, sizeof(int*)*width, cudaMemcpyHostToDevice);
cudaMemcpy(global_MC2, global_host_MC, sizeof(int)*height*width,cudaMemcpyHostToDevice); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-30T18:05:45.863

我有类似的经历，发现 cudaMalloc 是瓶颈，而 cudaMemcpy 不是。在我的设备中，我记得分配 16 MB 需要 160 毫秒。然而，CUDA 内存分配可以在实际计算之前完成，例如，通过另一个函数调用。因此，内存分配时间可以从整体性能度量中删除，例如加速，尽管我会在加速计算中包括 cudaMemcpy 操作。

# c# - 使用正则表达式从句子中检索特定字符串

> ID：10378126
> 
> 赞同：0
> 
> 时间：2012-04-30T03:26:22.087
> 
> 标签：c#, regex, data-retrieval

我正在尝试使用正则表达式从句子中检索特定字符串。这是我最初的正则表达式：

```
 Regex Reg = new Regex(@"^[KB|kb](\w+)[-]?(\w+)$");

  From input of :
  word word word (KB92922-WMP9) word.
  word word word (KB929222910) word word.
  word word kb28928282 word word. 
```

它应该能够检索：

```
 KB92922-WMP9
  KB929222910
  kb28928282 
```

将它们视为句子，我们通过一次传递一个句子来检索数据。在没有括号的情况下检索其数据。

这将如何运作？我不知道。我想我的正则表达式是正确的，但我不太确定如何检索数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T03:32:29.770

您正在寻找[Regex.Matches](http://msdn.microsoft.com/en-us/library/e7sf90t3.aspx)，（假设一个句子可能同时包含 KB12345 和 KB98765）。它类似于[Regex.Match](http://msdn.microsoft.com/en-us/library/twcw2f1c.aspx)，但会给你所有匹配的子字符串。

如果您将整个文本作为一个字符串，则可能没有必要将其拆分为句子。仅获取整个字符串中的所有匹配项将获得与收集同一字符串中所有句子中的所有匹配项相同的结果。

编辑：更新您正在使用的正则表达式

```
Regex Reg = new Regex(@"(KB\d+(?:-[\w\d]+)?)", RegexOptions.IgnoreCase); 
```

# objective-c - 如何在 UITextField 中输入文本时更新 UILabel

> ID：10378137
> 
> 赞同：2
> 
> 时间：2012-04-30T03:28:36.857
> 
> 标签：objective-c, xcode, uitextfield, uilabel, uitextfielddelegate

这是我在 StackOverflow 上的第一篇文章，我也是 Xcode 和 Objective-C 的新手。我已经阅读了有关代表的内容，并且还尝试过其他人的代码。但是，我想看看我是否可以自己创建一些使用委托的东西，而无需复制别人的代码。

为了理解委托，我想要做的是让 UITextField 委托在每次用户在键盘上键入一个键时更新一个标签。

我创建了一个 xib 文件并将一个 TextField 连接到我的 .h 文件中的 UITextField *myTextField 和 Label UILabel *myLabel。

我还添加到我的 ViewController 类的 .h 文件中。

但是，我不确定要使用什么委托方法，因为 UITextFieldDelegate.h 中列出的可选方法似乎只能在编辑完成后更新。此外，我不确定是否应该将 AppDelegate 方法放在与我的 xib 或 AppDelegate.h 文件关联的 .h 文件中。

对于这方面的一些指导，我将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-30T03:33:38.960

您可以将 UIViewController 添加为 UITextField 上的通知观察者，如下所示：

```
[textField addTarget:self action:@selector(textFieldDidChange:) forControlEvents:UIControlEventEditingChanged];

- (void)textFieldDidChange:(UITextField *)textField {
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T19:14:53.783

因此，如果您有一个 UITextField myTextField 链接到您的 nib IB TextField 对象，以及一个 UILabel myLabel 链接到您的 nib IB Label 对象，并且您已经让您的 Textfield 指向您的文件所有者，那么试试这个看看它是否有帮助。

我只是快速输入了这个，我没有测试它，所以先检查它是否有错误。

```
// ViewController.h
@interface ViewController : UIViewController <UITextFieldDelegate> {
    IBOutlet UILabel *myLabel;
    IBOutlet UITextField *myTextField;
}
@property (nonatomic, retain) UILabel *myLabel;
@property (nonatomic, retain) UITextField *myTextField;
@end

//  ViewController.m
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    myLabel.text = myTextField.text;
    return YES;   
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-10T15:27:15.440

```
import UIKit

class ViewController: UIViewController , UITextFieldDelegate {
    // Create a label Outlet
    @IBOutlet weak var label: UILabel!
    // TextField Outlet
    @IBOutlet weak var textField: UITextField!
   // Select the textfield and in connection inspector drag a action from editing changed to the source code
    @IBAction func changed(_ sender: Any) {
       // Set text to label
        label.text = textField.text
        }
    override func viewDidLoad() {
        super.viewDidLoad()
        //Delegate to self
        textField.delegate = self
        textField.autocorrectionType = .no
    }
    // Implement the protocols
    func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
        return true
    }
    func textFieldShouldReturn(_ textField: UITextField) -> Bool {
       textField.resignFirstResponder()
        return true
    }} 
```

# grails - 使用注释的动态 AuditLog（不涉及插件）

> ID：10378142
> 
> 赞同：0
> 
> 时间：2012-04-30T03:29:20.240
> 
> 标签：grails, dynamic, groovy, logging

我正在尝试在不使用任何插件的情况下编写动态审核日志。作为要求，我需要使用注释来编写它。

有没有人尝试过这种方法？

如何在groovy中编写注释？

请帮忙。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T16:11:09.197

我在 Java 应用程序中编写了审计代码。您可能只需要在常规 java 中编写一个注释，我相信这将适用于 groovy 代码。

您是否正在尝试捕获对数据库的数据更改？如果是这样，hibernate 已经提供了数据更改通知的能力，并让您将其写入数据库。

如果您尝试记录的不仅仅是更改的数据，注释可能会很困难，因为您必须告诉 AOP 审计代码您编写的编辑上下文是什么，以及需要记录哪些数据。您可以这样做，但您必须编写自定义审计注释处理程序类来处理您想要的每种特定类型的审计事件（然后在注释中引用它。例如：） `@Auditable(auditHandler="com.your.site.audit.handlers.LoginAuditHandler)`。

# c - 从 int 类型分配给类型 char[2] 时出现“不兼容类型”的编译错误

> ID：10378143
> 
> 赞同：0
> 
> 时间：2012-04-30T03:29:26.310
> 
> 标签：c, sockets

我有上面提到的编译错误。代码行是这样的：

```
if ((strcmp(tempDept, data[1].Dept)==0) && tempCourse == data[i].course){
            if (tempDay = data[i].meet_days &&
                tempTime == data[i].start.hour){  //<---This line
                    printf("this worked");
            }
        } 
```

这是我的结构声明：

```
typedef enum {MW, TR} days;

typedef struct {
  int hour, min;
} Time;

typedef struct {
  char Dept[5];
  int course, sect;
  days meet_days;
  Time start, end;
  char instr[20];
} sched_record; 
```

这是我的变量列表：

```
int switchInput;
int i = 0;
int tempCourse = 0;
char tempDept[5];
char tempDay[2];
int tempTime;
//char tempTime[1];
FILE *filePointer;
sched_record data[MAX_RECORD]; 
```

有人可以告诉我如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T08:39:33.083

```
tempDay = data[i].meet_days 
```

这引起了一个问题，因为`tempDay`char 数组的长度为 2 并且`meet_days`是 enum `days`。在 C 中，枚举中的常量只是`int`类型。另一个你不能分配`int`给`char array`它自己的问题。也许你想要一个等号`==`？现在您必须考虑如何将`int`枚举值转换为`char[2]`. 一种方法是使用`sprintf()`来实现这一点。但具体实现取决于您对枚举常量的解释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T03:31:22.557

```
if (tempDay = data[i].meet_days 
```

您缺少双等号 ==

# php - 我什么时候应该实例化 children 类？

> ID：10378148
> 
> 赞同：0
> 
> 时间：2012-04-30T03:31:13.953
> 
> 标签：php, oop, parent

假设我有 3 件物品：一个键盘、一件 T 恤和一瓶可乐。

```
$keyboard = new Item("Keyboard");
echo $keyboard->getPrice(); // return 50;

$tshirt = new Item("Tshirt");
echo $tshirt->getPrice(); // return 20;

$cola = new Item("Cola");
echo $cola->getPrice(); // return 0 or 2 whether the bottle is empty or not. 
```

`Price`获得一瓶可乐的最佳做法是什么？

我首先创建了 2 个类：

```
Class Item {
    $this->price;

    function __construct($name) {
    // ...
    }

    public function getPrice() {
        return $this->price;
    }
}

Class Bottle extends Item {
    $this->empty;

    function __construct($name) {
    // get from database the value of $this->empty
    }
    public function getPrice() {
        if($this->empty)
            return 0;
        else 
            return $this->price;
    }
} 
```

但现在我想知道；当我使用 : 时`$cola = new Item("Cola");`，我正在实例化一个`Item`对象而不是一个`Bottle`对象，因为我还不知道它是“普通”物品还是瓶子。

我是否应该在我的应用程序中实例化一个 Bottle 对象并研究另一个逻辑？或者有没有办法“重新创建”项目对象并将其转换为瓶子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T03:43:33.903

这是何时使用[工厂模式](http://php.net/manual/en/language.oop5.patterns.php)的完美示例。

对于您的代码，您可以执行类似的操作。

```
class ItemFactory {
    // we don't need a constructor since we'll probably never have a need
    // to instantiate it.
    static function getItem($item){
        if ($item == "Coke") {
            return new Bottle($item);
        } else if ( /* some more of your items here */){
            /*code to return object extending item*/
        } else { 
            // We don't have a definition for it, so just return a generic item.
            return new Item($item);
        }
    }
} 
```

你可以像这样使用它`$item = ItemFactory::getItem($yourvar)`

当您有许多具有相同基（或父）类的对象并且您需要在运行时确定它们是什么类时，工厂模式很有用。

# ios - 调整大小时如何禁用子 calayer 的缩放？

> ID：10378152
> 
> 赞同：1
> 
> 时间：2012-04-30T03:31:28.477
> 
> 标签：ios, calayer, scale

我有一个带有图像的子 CALayer，它总是在改变大小，但我不想缩放它的内容（图像）以适应图层大小。相反，我想要的是始终保持图像大小不变，以便图像会一点一点地出现。

无论如何要实现这个效果？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T03:39:55.247

您应该使用遮罩或将图层的内容重力设置为（有关更多值，`kCAGravityTopLeft`请参见[https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CALayer_class/Introduction/Introduction.html ）。](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CALayer_class/Introduction/Introduction.html)

默认值就是`kCAGravityResize`它被缩放的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-20T16:24:58.100

您不应该为图层的框架设置动画或更改它。CALayer 有财产`contentScale`

你可以试试这样

```
let layer =  CALayer()
layer.frame = yourFrame
layer.contentsRect = CGRect(x: 0, y: 1, width: 1, height: 0)
layer.contentsGravity = .top
let contentsRectAnimation = CABasicAnimation(keyPath: "contentsRect")
contentsRectAnimation.fromValue = layer.contentsRect
contentsRectAnimation.toValue = CGRect(x: 0, y: 0, width: 1, height: 1)
contentsRectAnimation.beginTime = AVCoreAnimationBeginTimeAtZero
contentsRectAnimation.duration = yourDuration
contentsRectAnimation.isRemovedOnCompletion = false
contentsRectAnimation.fillMode = .forwards
layer.add(contentsRectAnimation, forKey: "animation") 
```

这将使动画看起来像您在图层中的图像从上到下变得可见

# postgresql - 是否可以在 postgres 9.1 的重叠子句中进行子选择？

> ID：10378153
> 
> 赞同：0
> 
> 时间：2012-04-30T03:31:32.937
> 
> 标签：postgresql, postgresql-9.1

我的数据库结构如下：

我有一个有上课时间的时间表。每个 scheduletime 都有一个与之关联的具有持续时间的 tclass。我通常会使用某种连接来获取持续时间，但是，由于我在 postgres 中使用重叠比较，我不确定这是否可行。查询看起来像这样......

```
Select (scheduletimes.classtime, scheduletimes.classtime + interval 
(select duration from tclasses where tclass.id = scheduletimes.tclass_id) minutes) OVERLAPS 
(06:50:00, 07:20:00) from schedules where
day = 1 and
schedule_id = 14; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T04:28:26.133

您可以使用子查询，但在您的示例中，您将文字格式与列中的值混合在一起，这是行不通的。通常最好`JOIN`不要使用子查询，所以你可能想要这样的东西：

```
SELECT
    scheduletimes.*,
    (scheduletimes.classtime, scheduletimes.classtime
         + (interval '1 minute' * tclasses.duration))
       OVERLAPS (time '06:50:00', time '07:20:00')
  FROM scheduletimes
  JOIN tclasses ON tclasses.id = scheduletimes.tclass_id
  WHERE day = 1
    AND schedule_id = 14; 
```

# php - 涉及连字符的 PHP MySQL 语法错误

> ID：10378155
> 
> 赞同：0
> 
> 时间：2012-04-30T03:31:38.910
> 
> 标签：php, mysql

```
$names = array();
$names['full-name'] = 'John Doe';

$query = "INSERT INTO users (full_name) VALUES ('$names[full-name]')";
$result = mysql_query($query) or die(mysql_error()); 
```

每当我尝试使用包含连字符的数组键创建 mysql 查询时，我都会遇到语法错误：

解析错误：语法错误，意外的 '-'，期待 ']'

我该如何解决这个问题？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T03:36:07.573

a) 看一下[PDO](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)（特别是准备好的语句），您可能仅通过使用变量就容易受到 SQL 注入的攻击

b）如果您只想修复该部分：

```
$query = "INSERT INTO users (full_name) VALUES ('".$names["full-name"]."')"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T03:53:13.120

由于尚未提及，这是另一种替代语法：

```
$query = "INSERT INTO users (full_name) VALUES ('{$names['full-name']}')"; 
```

在变量/数组索引周围添加`{}`大括号允许您引用它，就像它在字符串之外一样。该`{}`符号还允许您在字符串中嵌入多维数组，例如

```
echo "$x[1][2]"; 
```

通常会被 PHP 视为数组`$x[1]`后跟文字`[2]`文本，因为它的数组解析不是“贪婪”的。但是在整个数组引用中加上大括号会强制 PHP 解析整个事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T03:34:13.597

在`-`变量中有 a 是无效的。改用`_`a

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T03:35:03.127

```
$query = "INSERT INTO users (full_name) VALUES ('".$names[full-name]."')"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-30T03:40:36.183

`('$names[full-name]')`应该改为`('$names[\"full-name\"]')`

# android - 为什么 setBitmap 在 ICS 中似乎不起作用？

> ID：10378157
> 
> 赞同：1
> 
> 时间：2012-04-30T03:32:01.950
> 
> 标签：android, canvas, bitmap, android-4.0-ice-cream-sandwich

我正在绘制画布，只是试图将画布保存为 JPEG。我在某些设备上对此进行了测试，发现它似乎不适用于 ICS，并在我尝试以下代码时出现 UnsupportedOperationException 错误：

```
Bitmap bitmap = Bitmap.createBitmap(w, h, Bitmap.Config.ARGB_8888);
canvas.setBitmap(bitmap);

// Drawing to canvas here

OutputStream stream = new FileOutputStream("/sdcard/test.jpg");
bitmap.compress(CompressFormat.JPEG, 100, stream);
stream.close(); 
```

这一切都在 onDraw 方法中完成，错误在 canvas.setBitmap(bitmap) 上。

这在我的 Droid X(2.3) 和 Tab 10.1(3.1) 上运行良好，但在运行 ICS 时在我的 Galaxy Nexus(4.0) 和 Tab 10.1 上失败。我可能只是在看一些非常简单的东西。我大部分时间都在为此工作，但没有取得任何进展。任何想法将不胜感激！

更新：我关闭了“强制 GPU 渲染”，现在它似乎可以工作了。必须有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T04:44:57.517

在设置中禁用“强制 GPU 渲染”已经解决了这个问题，即使可能有更好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T03:45:43.710

我相当确定问题是启用了[严格模式。](http://developer.android.com/reference/android/os/StrictMode.html "严格模式")由于该`bitmap.compress`方法执行文件 I/O，因此严格模式会对您在主线程上执行此类操作这一事实感到不满。尝试在后台线程上执行压缩步骤[`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html)，例如使用 . 或者，如果您不关心在您的 UI 中可能引入无响应的时刻，只需打开严格模式即可。

# jquery - 在文本中查找链接并使用 jquery 将其包装在标签中

> ID：10378158
> 
> 赞同：0
> 
> 时间：2012-04-30T03:32:06.697
> 
> 标签：jquery, html, css

我正在使用 twitter API 提取推文并将其分配给一个变量。像这样。

```
 self.tweets = $.map(data.results, function(tweet){
                return{
                    author: tweet.from_user,
                    url: 'http://twitter.com/' + tweet.from_user + '/status/' + tweet.id_str,
                    image: tweet.profile_image_url,
                    tweet: tweet.text
                };
            }); 
```

我为我工作。我将推文附加到 HTML。文字是这样的。。

```
 @drwarwick Hi David! Looking forward to catching up with you, but may not get in there today due to work commitments... 
```

我现在要做的是将@drwarwick 包装到@drwarwick 中，以便我可以相应地对其进行样式设置和链接。我如何在推文中找到 uisng jquery 任何这样的词。谢谢。

编辑>>>>>

类似stackoverflow的东西在上面做。它改变了文本的颜色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T03:53:52.117

我只是写了一个辅助方法来做到这一点。

```
function HighLight(input)
{
    var output="";
    var items=input.split(" ");
    $.each(items,function(index,item){
       var word=items[index];
       if(word.match("^@"))
       {
           word="<span class='highlightSpan'>"+word+"</span>";  
       }                         
       output+=word+" ";
    });    
    return output;
} 
```

工作示例：http: [//jsfiddle.net/ZSafX/27/](http://jsfiddle.net/ZSafX/27/)

您可以更改代码以包含这样的代码

```
 self.tweets = $.map(data.results, function(tweet){
            return{
                author: tweet.from_user,
                url: 'http://twitter.com/' + tweet.from_user + '/status/' + tweet.id_str,
                image: tweet.profile_image_url,
                tweet: HighLight(tweet.text)
            };
        }); 
```

# c# - 可以将null插入Cache吗？

> ID：10378161
> 
> 赞同：2
> 
> 时间：2012-04-30T03:32:37.117
> 
> 标签：c#, asp.net, caching, design-patterns, null-object-pattern

我在我的 ASP.NET 网站中积极使用缓存。

但是，从 db 请求的某些对象确实不存在。例如，我通过查看表中的记录来检查特定`Discount`产品是否存在。没有记录意味着没有折扣。`ProductId=@ProductId``ProductsDiscount`

您认为将`null`折扣对象放入缓存中是个好主意吗？

或者我最好发明一些更好的东西（例如使用空对象模式）。事实上，我不太喜欢开始使用空对象模式的想法，因为它需要进行大量的重新设计，我至少现在想避免这种情况。

谢谢。欢迎任何想法。

PS事实上，当我尝试调用时，我什至不能将空对象放入缓存中：

```
HttpContext.Current.Cache.Insert("name...", null); 
```

我收到：

> 值不能为空。

PPS 为什么 MSDN 对这种行为只字未提？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T04:20:56.977

对于您的情况，您可以将`DBNull.Value`其用作“无数据”标记：

```
HttpContext.Current.Cache.Insert("name...", DBNull.Value); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T03:43:50.047

不，您不能在缓存中放置空值，这有什么意义？如果折扣是一个数值，那么缺少折扣（表中为空）实际上表示折扣为 0% - 那么为什么不存储 0？

# php - 错误：您的 SQL 语法有错误；

> ID：10378162
> 
> 赞同：-3
> 
> 时间：2012-04-30T03:32:57.133
> 
> 标签：php, mysql

我仍然遇到错误。

> 错误：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 2 行的“comcode, version, classification, location, availability, date, client) VALUES 附近使用正确的语法

```
 <?php
    $host="localhost"; // Host name 
    $username="user1"; // Mysql username 
    $password="test123"; // Mysql password 
    $db_name="inventory"; // Database name 
    $tbl_name="cisco"; // Table name

    mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
    mysql_select_db("$db_name")or die("cannot select DB");

    $con = mysql_connect("localhost","root","");
    if (!$con)
      {
      die('Could not connect: ' . mysql_error());
      }
    mysql_select_db("inventory", $con);

    $addcisco="INSERT INTO cisco
    (critical_spare_id, serial_no, ,comcode, version, classification, location, availability, date, client)
    VALUES ('". $_POST['critical_spare_id'] . "', '" . $_POST['serial_no']. "', '". $_POST['comcode'] . "','". $_POST['version'] . "','". $_POST['classification'] . "','". $_POST['location'] . "', '". $_POST['availability'] . "', '". $_POST['date'] . "', '". $_POST['client'] . "')";

    mysql_query($addcisco,$con);

    if (!mysql_query($addcisco,$con))
      {
      die('Error: ' . mysql_error());
      }
    echo "1 record added";

    mysql_close($con);

    ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T03:35:10.397

您的插入语句中有一个空列名：

```
(critical_spare_id, serial_no, ,comcode, version,

                              ^ 
```

# visual-studio-2008 - 路径环境变量和未解析的外部符号

> ID：10378171
> 
> 赞同：0
> 
> 时间：2012-04-30T03:34:22.513
> 
> 标签：visual-studio-2008, linker-errors

一个多星期以来，我一直被这个未解决的外部符号错误所困扰。比如说，使用 TBB 库（以及将在另一篇文章中提到的 PointGrey 库），我无法链接到库（我不确定 dll 或库！），它会带来这种链接错误。

![这是英特尔关于 TBB 库的配置指南](../Images/fe952746ba2b729d1f8b99c1eeaf72c3.png)

我正在使用VS2008，win7。本指南意味着我只需要运行脚本文件，然后我创建的每个项目都会自动正确配置（根据（1））。我做对了吗？

到目前为止，英特尔的原始示​​例项目无需我的任何配置即可正常运行，我只需单击运行。但是对于我从相同的示例代码创建的项目，它们有链接错误

PS：脚本为：tbbvars.bat <\arch>\ <\vs>\

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T17:11:23.197

一些库作为 lib 文件链接，有时需要告知项目这些依赖项。您显示的帮助告诉您进入您的项目 -> 属性 -> 链接器 -> 输入 -> 附加依赖项，并添加 tbb_debug.lib 或 tbb.lib （如果您在调试模式下构建，则使用 _debug 版本，另一个在发布）- 他们可能还有其他两个用于 x64 构建的版本，因此您应该为每个构建版本执行此操作。
然后转到项目 -> 属性 -> 链接器 -> 输入 -> 常规 -> 附加库目录并添加他们建议的库目录。（同样，32/64 位的单独目录）。
当然，还有 VC/c++ 属性 -> 常规 -> 包含目录，您将在其中添加 $(TBBROOT)\include。
检查您从英特尔获得的示例项目的项目属性。
如果您运行他们的脚本，如果任何 dll 包含在可执行文件中，它们将被链接器（和/或在执行期间）找到。更重要的是，他们创建了 Env Var TBBROOT，看起来像 - 您应该在属性中添加的内容引用了它。如果您没有该变量，则必须添加绝对路径。
至于您评论中的选项，是的，您可以告诉 VS 在其他地方寻找库，而不是添加额外的 Env Var（或更多路径到 PATH）。唯一需要考虑的是执行是否需要某些 dll - 在这种情况下，您可能希望在构建后将它们复制到与 exe 相同的文件夹中，并在包含中使用绝对路径。它也有点不便携......

# spring-mvc - spring mvc 3.0 和显示标签

> ID：10378177
> 
> 赞同：0
> 
> 时间：2012-04-30T03:35:50.007
> 
> 标签：spring-mvc, displaytag

我正在使用 spring mvc 3.0 并显示标签。所以，使用显示我得到像 1,2,3,4 这样的数据。现在最新的记录出现在第4页。现在我想在第1页显示最新的数据，我该怎么做？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T04:01:00.057

您是否正在尝试实现分页？如果是这样，你带来什么样的记录？例如，如果您要带上具有 id 的名称列表，您可以根据您的要求对 id 进行升序或降序排序，并将其带到前端并相应地显示。根据您的问题，您似乎在第 4 页带来了最新记录。这完全取决于您的要求是否带入哪个顺序。请提供更多详细信息以更好地解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T12:35:26.060

您可以使用属性 defaultorder of

例如

```
<display:table uid="1" name="locationList" class="displaytag" id="location" pagesize="10"  excludedParams="*" requestURIcontext="true" defaultorder="ascending" requestURI="action_name.do" export="true" > 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T05:27:03.737

如果您要显示的数据只是数字，则按照输入顺序按降序对您显示的列表进行排序，我相信列表也是如此，因此您将获得列表底部的最后一个元素。现在你需要做的是反转这个列表的顺序，并利用这个临时反转的列表在 UI 上显示。

# android - 哪些工具和技术用于构建 Android 应用程序，如 instagram、twitter 客户端？

> ID：10378179
> 
> 赞同：0
> 
> 时间：2012-04-30T03:36:05.833
> 
> 标签：android, cordova, appcelerator-mobile

只是想知道哪些工具和技术用于构建流行的 Android 应用程序，如 Instagram 应用程序、Facebook 应用程序、Twitter 客户端等？他们是使用 phoneGap 或 appcelerator 之类的框架，还是编写本机代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T08:02:03.257

appcelerator 不是像电话间隙那样的 webview 包装器。它遵守使用本机代码来生成其应用程序。

我认为大多数大型公司都会投资于为所有解决方案构建本机应用程序。

如果这是为了判断你应该使用什么，最好的方法不是复制别人的做法，而是看看你的应用程序需要什么以及最适合你的技能组合

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-30T06:00:28.413

Twitter 和 Facebook 应用程序大多采用 HTML5。Instagram 应用在某些方面使用 HTML5 网络视图，例如显示流。我想这样做的原因是他们必须支持多个平台，同时保持流的用户体验一致。

PhoneGap 在很大程度上是围绕 Android 和 iPhone 网络视图的包装器。我怀疑 FB/Twitter 是否使用它。

*编辑* Appcelerator 似乎是错误的。

# python - 如何在 Python 中导入私有方法？

> ID：10378181
> 
> 赞同：4
> 
> 时间：2012-04-30T03:36:55.217
> 
> 标签：python

```
def __hello_world(*args, **kwargs):
  ..... 
```

我试过了

```
from myfile import __helloworld 
```

我可以导入非私有的。

如何导入私有方法？

谢谢。

* * *

我现在使用单个下划线。

```
Traceback (most recent call last):
  File "test.py", line 10, in <module>
    from myfile.ext import _hello_world
ImportError: cannot import name _hello_world 
```

在我的 test.py

```
sys.path.insert(0, os.path.abspath(
                    os.path.join(
                        os.path.dirname(__file__), os.path.pardir)))

from myfile.ext import _hello_world 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-30T03:43:22.777

```
$ cat foo.py
def __bar():
    pass 
```

* * *

```
$ cat bar.py
from foo import __bar

print repr(__bar) 
```

* * *

```
$ python bar.py
<function __bar at 0x14cf6e0> 
```

也许你打错字了？

但是，通常双下划线方法并不是真正需要的——通常“公共”API 是零下划线，而“私有”API 是单下划线。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T04:06:01.710

你确定你有最新的源导入？仔细检查您是否正在导入最新的源。

通过这样做检查它：

```
>> import myfile.ext
>> print dir(myfile.ext) 
```

你应该看到所有的方法（我认为双下划线会被跳过，但仍然会出现单下划线）。如果没有，这意味着你有一个旧版本。

如果这显示正常，但您仍然无法导入实际的东西。制作一个virtualenv，然后重试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-10-01T00:50:42.207

```
from "module" import * 
```

只导入“公共”字段和函数。对于私有字段和函数，您需要如其他答案中所述显式导入它们。请参阅下面的完整示例。在 python 3.7.4 上测试

$猫文件_w_privates.py

```
field1=101
_field2=202
__field3=303
__field4__=404

def my_print():                                                                                
  print("inside my_print")                                                                                                                                                                
def __private_print():
  print("inside __private_print")                                                                                             
def __private_print__():                                                                       
  print("inside __private_print__") 
```

$ 猫文件导入.py

```
from file_w_privates import _field2, __field3, __field4__ # import private fields
from file_w_privates import  __private_print, __private_print__ # import private functions
from file_w_privates import *   # import public fields and functions

print(f"field1: {field1}")
print(f"_field2: {_field2}")
print(f"__field3: {__field3}")
print(f"__field4__: {__field4__}")

my_print()
__private_print()
__private_print__() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T03:49:20.790

没有什么可以阻止您导入使用`__`. Python 在类的“私有”方法上实现名称修改以避免派生类中的事故，但它不应影响模块级别的定义。我的测试对此没有任何问题：

文件 A

* * *

```
def __test(): pass 
```

文件 B

* * *

```
from A import __test

print __test  # output is <function __test at 0x024221F0> 
```

我说“私人”是因为有兴趣这样做的人仍然可以导入这些方法。

# c# - 此 SQL 查询如何获取记录？

> ID：10378182
> 
> 赞同：0
> 
> 时间：2012-04-30T03:37:09.330
> 
> 标签：c#, sql, ms-access

我有一个在 MDB 数据库上触发的 sql 查询。

`select * from Products where itemname & ' ' & size & ' ' & quality='A/G RATIO Patient Price' Order by Category`

它给我带来了记录在哪里`itemname`（`A/G RATIO`只有一条记录 itemname 是`A/G RATIO`）。

我的 Product 表有和列`ItemName`，但在特定行中，值在 Itemname 和quality 列中，但是这些值是如何在单个条件下检查的。`size``quality``'A/G RATIO'``'Patient Price'``'A/G RATIO Patient Price'`

我认为有一些关于`&`运营商的东西，我在[谷歌](http://www.google.co.in/#hl=en&gs_nf=1&cp=31&gs_id=4&xhr=t&q=ampersand+operator+in+sql+query&pf=p&output=search&sclient=psy-ab&oq=ampersand+operator+in+sql+query&aq=f&aqi=&aql=&gs_l=&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.,cf.osb&fp=bc7998ee1acacccf&biw=1360&bih=667)上找不到，我错过了。那是什么？这个sql查询是什么意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T03:46:35.123

该查询与列、空格、列、空格和列`'A/G RATIO Patient Price'`值的连接进行比较。`itemname``size``quality`

# session - JSF 注销删除会话

> ID：10378184
> 
> 赞同：-1
> 
> 时间：2012-04-30T03:37:15.077
> 
> 标签：session, jsf, weblogic, login-control

我正在 Eclipse IDE 上开发一个基于 jsf 的 Web 应用程序。我在登录和**注销**操作方面遇到了一些问题。AS 是一个 Weblogic。我可以成功登录并注销应用程序，但以下代码不会破坏会话...：

我的注销功能

```
public String logout() throws IOException {
    FacesContext context = FacesContenter code hereext.getCurrentInstance();
    ExternalContext ec = context.getExternalContext();
    final HttpServletRequest request = (HttpServletRequest) ec.getRequest();
    request.getSession(true).invalidate();
    return ("logout");
} 
```

Faces-Config.xml

```
<navigation-rule>
    <from-view-id>/home.xhtml</from-view-id>
    <navigation-case>
        <from-outcome>logout</from-outcome>
        <to-view-id>/login.xhtml</to-view-id>
        <redirect />
    </navigation-case>
</navigation-rule> 
```

用于记录的主页

```
<body>
<h:form id="Form">
        Hello<span style="color: ORANGE">
            #{profileController.profile.name}</span>

    <h:commandLink value="sign out" action="#{profileController.logout}" />
</h:form> 
```

Web.xml

```
<servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>*.jsf</url-pattern>
</servlet-mapping>
<context-param>
    <param-name>com.sun.faces.enableRestoreView11Compatibility</param-name>
    <param-value>true</param-value>
</context-param> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T06:33:37.483

您看到的页面很可能来自浏览器缓存。您可以禁用某些或所有页面的缓存。[有关详细信息，请参阅类似问题](https://stackoverflow.com/a/4817088/620338)的此答案。

# virtualbox - vagrant：“重置”我的访客 vagrant vm 网络的更好方法？

> ID：10378185
> 
> 赞同：23
> 
> 时间：2012-04-30T03:37:24.220
> 
> 标签：virtualbox, vagrant

我对 vagrant 比较陌生，但到目前为止我肯定喜欢它。

我经常遇到的一个小问题是，当我的主机网络暂时中断时，它会影响我与我的 vagrant guest vm 的连接。

当我的主机网络再次恢复时，我必须 - 在我的主机上 - 运行`vagrant halt`，然后`vagrant up`才能“重置”我的访客 vagrant vm 的网络，以便它可以再次连接到互联网。

是否有更“优雅”的方式通过我的主机网络获取我的虚拟机的互联网连接以检测互联网网络连接是否已备份？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-30T18:42:51.440

是的，最简单的解决方案是重新启动 VM 本身内的网络子系统。不应中断 SSH 连接。在 Ubuntu 上，执行以下操作：

```
sudo /etc/init.d/networking restart 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-13T20:28:58.090

关于 Mitchell 的回答，对于我的 Vagrant 版本 1.5.2，命令略有不同：

须藤/etc/init.d/网络重启

而不是使用“网络”。我知道没什么大不了的，只是想说。

与 Vagrant Mitchell 的伟大合作！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-04T10:48:04.723

这是我所做的：

HOST=VM IP 地址 PRIVATE_KEY_PATH= 私钥路径

`ssh vagrant@$HOST -i $PRIVATE_KEY_PATH`登录到虚拟机

然后，`sudo /etc/init.d/networking restart`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-02T06:26:54.337

其他答案中列出的命令的更新版本（2018 年）*：

对于 Ubuntu 16.04.* LTS（Xenial Xerus）：

```
sudo systemctl restart networking

# Check the status - there is no better way with systemd for now:
# https://github.com/systemd/systemd/issues/1287
sudo systemctl status networking 
```

对于 CentOS 7.5（`network`vs`networking`是非常不幸的区别，但我们在这里）：

```
sudo systemctl restart network

# Check the status - there is no better way with systemd for now:
# https://github.com/systemd/systemd/issues/1287
sudo systemctl status network 
```

*在现代发行版中，答案中列出的脚本只是`systemd`'s 的包装`systemctl`。

# asp.net - ASP.NET 中的 Task.Factory 超时

> ID：10378188
> 
> 赞同：1
> 
> 时间：2012-04-30T03:38:20.260
> 
> 标签：asp.net, vb.net, timeout, taskfactory

我一直在寻找有关异步任务超时设置的信息，但我找不到任何不涉及 wait() 的信息。也许我看错了。

我有一个 API 调用可能需要 10 分钟才能完成文件传输。我产生了一个新线程，因此用户不必坐下来观看这种情况发生。我添加了数据库更新，这样我就可以知道发生了什么。上传开始，几分钟后......什么都没有。传输被中止，没有抛出异常，也没有数据库更新。这一定意味着线程被丢弃了，对吧？我怎样才能让它活得更久？谢谢你的帮助。

```
Sub up_load(s As Object, e As EventArgs)

    Dim uploadtask As Task = Task.Factory.StartNew(Sub() begin_upload(), TaskCreationOptions.LongRunning)

    lblmsg.Text = "Successfully initiated upload"
End Sub

Sub begin_upload()

    Dim request As New YouTubeRequest(settings)
    Dim vidupload As New Video()
    Dim cmdupdate As SqlCommand

    vidupload.Title = "My Big Test Movie"
    vidupload.Tags.Add(New MediaCategory("Nonprofit", YouTubeNameTable.CategorySchema))
    vidupload.Keywords = "church, jesus"
    vidupload.Description = "See the entire video"
    vidupload.YouTubeEntry.Private = False
    vidupload.YouTubeEntry.setYouTubeExtension("location", "Downers Grove, IL")
    vidupload.YouTubeEntry.MediaSource = New MediaFileSource("c:\users\greg\test3.asf", "video/x-ms-wmv")

    'updates fine
    cmdupdate = New SqlCommand("Update transactions set name='upload started' where transactionid='18'", conHyperData)
    conHyperData.Open()
    cmdupdate.ExecuteNonQuery()
    conHyperData.Close()

    Try

        'very long running task +5 min
        Dim createdVideo As Video = request.Upload(vidupload)

        'never gets here 
        cmdupdate = New SqlCommand("Update transactions set name='upload finished' where transactionid='18'", conHyperData)
        conHyperData.Open()
        cmdupdate.ExecuteNonQuery()
        conHyperData.Close()
    Catch ex As Exception

        'never thrown, transfer aborts
        cmdupdate = New SqlCommand("Update transactions set name=@name where transactionid='18'", conHyperData)
        cmdupdate.Parameters.AddWithValue("@name", "failed - " & ex.ToString)
        conHyperData.Open()
        cmdupdate.ExecuteNonQuery()
        conHyperData.Close()
    End Try

End Sub 
```

# javascript - Jasmine 不能监视事件处理程序？

> ID：10378189
> 
> 赞同：10
> 
> 时间：2012-04-30T03:38:38.213
> 
> 标签：javascript, testing, event-handling, jasmine

尝试使用 Jasmine 测试在单击的元素上调用事件处理程序。有一个“Pad”对象，其中包含一个被点击的 DOM 元素“PadElement”。事件处理程序是 Pad 对象上的一个方法：

```
GRAPH.Pad = function(graphDiv, graph) {
    this.graph = graph;

    this.clickHandler = function(e) {
        console.log('padElement clickHandler called');
        //this.graph.createVertex(e.clientX, e.clientY);
    };
    this.padElement = GRAPH.padElement(graphDiv, this.clickHandler);
}

GRAPH.padElement = function(graphDiv, clickHandler) {
    //Initialize pad
    var NS="http://www.w3.org/2000/svg";
    var pad=document.createElementNS(NS,"svg");
    pad.setAttributeNS(null, 'id', 'pad');
    graphDiv.appendChild(pad);
    pad.addEventListener('click', clickHandler)
    return pad;
} 
```

茉莉花测试：

```
var testDiv = document.createElement('div');
var testGraph = new GRAPH.Graph(testDiv);
var testPad = new GRAPH.Pad(testDiv, testGraph);

  it('has its clickHandler function called when its padElement is clicked',
    function() {
      spyOn(testPad, "clickHandler");
      simulateClick(testPad.padElement);
      //testPad.clickHandler();
      expect(testPad.clickHandler).toHaveBeenCalled();
  }); 
```

但是，测试失败。请注意，事件侦听器确实被调用（console.log 通过鼠标单击和模拟单击成功写入），并且如果我直接调用 testPad.clickHandler()，Jasmine 的间谍可以拾取它。但是在实际测试中会发生什么？事件处理程序调用是否在运行时转移到不同的对象？这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T14:37:14.600

您实际上是在测试`GRAPH.padElement`调用提供的`clickHandler`而不是调用`this.clickHandler`的。我会怎么做`GRAPH.Pad``GRAPH.padElement`

```
var testDiv = document.createElement('div');
var clickHandlerSpy = jasmine.CreateSpy();
var padelement = padElement(testDiv , clickHandlerSpy);

  it('has its clickHandler function called when its padElement is clicked',
    function() {
      simulateClick(testPad.padElement);
      expect(clickHandlerSpy).toHaveBeenCalled();
  }); 
```

这听起来可能与您想要实现的目标没什么不同。但是在理想的单元测试世界中，您应该独立测试每个单元，所以我会首先测试`padElement`它应该做的事情（如上所述），然后编写另一个测试以确保`GRAPH.Pad`将正确的处理程序传递给`padElement`. 现在要做到这一点，我不会`padElement`直接从内部创建，`GRAPH.Pad`而是以某种方式从外部注入它，然后在茉莉花规格中模拟它。如果您对这部分不清楚，请告诉我，我可以为您整理一些代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-09-08T13:40:58.153

添加更通用的解释：

**在将函数附加为事件侦听器之前，您需要进行间谍活动**。

一些伪代码：

```
it("succeeds", function(){
  var o = {}
  o.f = function() { console.log("event caught!");} //your eventHandler
  spyOn(o, "f").and.callThrough(); //o.f is now a spy
  addEventListener('click', o.f); //spy listens for event 

  fireEvent("click"); //"event caught!" is written to console

  expect(o.f).toHaveBeenCalled(); //success, we're happy
});

it("fails", function(){
  var o = {}
  o.f = function() { console.log("event caught!");} //your eventHandler
  addEventListener('click', o.f); //your eventHandler function listens for event
  spyOn(o, "f").and.callThrough(); //o.f is now a spy

  fireEvent("click"); //"event caught!" is written to console

  expect(o.f).toHaveBeenCalled(); //fail, we waste a couple of hours not understanding why
}); 
```

因此，如果您知道正在调用您的处理程序，但间谍没有注册为`.tohaveBeenCalled()`检查首先发生的事情：您的间谍或侦听器的分配。间谍需要先来。

# sql - 在 SQL Server 的 SQL 语句的一部分中防止记录计数

> ID：10378195
> 
> 赞同：3
> 
> 时间：2012-04-30T03:39:56.450
> 
> 标签：sql, asp.net, sql-server, delete-operator, record-count

我正在使用 ASP.NET C# 程序中的以下 SQL 语句块：

```
SET XACT_ABORT ON;  --Need to roll back upon failure
BEGIN TRANSACTION;  --Need to be performed atomically
UPDATE MyTable SET Col1='SomeValue' WHERE ColID='N';
DELETE FROM MyTable WHERE ColID='X';
COMMIT;
SET XACT_ABORT OFF; 
```

上面的 SQL 块通过调用应该返回的[SqlCommand.ExecuteNonQuery 方法立即执行：](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executenonquery.aspx)

> 对于 UPDATE、INSERT 和 DELETE 语句，返回值是受命令影响的行数。

但是我从 ExecuteNonQuery() 返回时得到的是添加到已删除记录数中的更新记录数。所以我的问题是，我能不能让它只返回已删除记录的数量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T10:52:17.827

这行代码 SET NOCOUNT ON，放在存储过程的顶部，关闭 SQL Server 在执行每个 T-SQL 语句后发送回客户端的消息。这是对所有 SELECT、INSERT、UPDATE 和 DELETE 语句执行的。

通过从网络中消除这种额外的开销，它可以大大提高数据库和应用程序的整体性能。

如果您仍然需要获取受正在执行的 T-SQL 语句影响的行数，您仍然可以使用 @@ROWCOUNT 选项。通过在此函数 (@@ROWCOUNT) 上发出 SET NOCOUNT 仍然有效，并且仍然可以在您的存储过程中使用来确定受语句影响的行数。

```
SET NOCOUNT ON 
SET XACT_ABORT ON;  --Need to roll back upon failure
BEGIN TRANSACTION;  --Need to be performed atomically
UPDATE MyTable SET Col1='SomeValue' WHERE ColID='N';
SET NOCOUNT OFF
DELETE FROM MyTable WHERE ColID='X';
COMMIT;
SET XACT_ABORT OFF; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:03:15.867

好的，我找到了答案。显然这样调用它会重置第一个 ROWCOUNT_BIG() 的行计数器，第二个调用返回删除的数字：

```
SET XACT_ABORT ON;  --Need to roll back upon failure
BEGIN TRANSACTION;  --Need to be performed atomically
UPDATE MyTable SET Col1='SomeValue' WHERE ColID='N';
SELECT ROWCOUNT_BIG();   --resets rowcount
DELETE FROM MyTable WHERE ColID='X';
SELECT ROWCOUNT_BIG();   --retrieves the needed row count
COMMIT;
SET XACT_ABORT OFF; 
```

# c - 此 C 代码仅获取 HTTP 标头，但不是 html 文件

> ID：10378213
> 
> 赞同：1
> 
> 时间：2012-04-30T03:42:46.260
> 
> 标签：c, linux, http, sockets, network-programming

我在Linux平台上写了这段代码。

运行此程序时，预计会打印`HTTP header`和`html content`. 就像：

```
HTTP/1.1 200 OK\r\n
...
...
<!DOCTYPE html>
...
</html> 
```

但是当我运行它时，我发现它只是打印`HTTP header`

这是我的 C 代码：

```
#include <assert.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <netdb.h>  // for struct sockaddr_in AF_IN
#include <sys/types.h>
#include <sys/socket.h>
#include <arpa/inet.h>  // for inet_pton
#include <netinet/in.h> // for IPPROTO_TCP

#define PORT "80"
#define BAIDU_IP "119.75.217.56"
#define GET_INFO "GET / HTTP/1.1\r\nHost: www.baidu.com:80\r\n\r\n"

int main()
{
    int sock_local;
    in_port_t port = atoi(PORT);
    struct sockaddr_in server;

    memset(&server, 0, sizeof(server));
    server.sin_family = AF_INET;
    server.sin_port = htons(port);

    sock_local = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
    assert(sock_local > 0);

    int retVal = -1;
    retVal = inet_pton(AF_INET, BAIDU_IP, &server.sin_addr.s_addr);
    assert(retVal == 1);

    if (connect(sock_local, (struct sockaddr*)&server, sizeof(server)) < 0)
    {
        perror("connect");
        exit(EXIT_FAILURE);
    }

    ssize_t nByte = send(sock_local, GET_INFO, strlen(GET_INFO), 0);
    if( nByte <= 0)
    {
        perror("send");
        exit(EXIT_FAILURE);
    }

    char BUF[BUFSIZ];
    size_t recived_len = 0;
    while ((recived_len = recv(sock_local, BUF, BUFSIZ-1, 0)) > 0)
    {
        int statu;
        BUF[recived_len] = '\0';
        printf("%s", BUF);
        statu = (recived_len==BUFSIZ-1) ? 0 : 1;
        if (statu) break;
    }
    if (recived_len < 0)
    {
        perror("recv");
    }

    close(sock_local);
    return 0;
} 
```

你能帮忙接收`HTTP head`和'html内容'吗？

我不知道为什么它不起作用。

====================== 解决方法=========================== ==

我很高兴地说，我自己找到了解决这个问题的方法。

我删除`if (statu) break;`，然后它按我的预期工作！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T17:42:56.203

问题似乎就在这里：

```
statu = (recived_len==BUFSIZ-1) ? 0 : 1;
if (statu) break; 
```

我不知道您为什么包含此代码。除非您在上次读取时完全填充缓冲区，否则它似乎退出循环。你这样做的原因是什么？

删除这两行代码，它应该可以工作。

（哦，顺便说一句，这不是你拼写“收到”的方式。）

# c# - 对象通信

> ID：10378220
> 
> 赞同：0
> 
> 时间：2012-04-30T03:43:50.763
> 
> 标签：c#, .net, controls

我有一个带有`bool Selected`变量的自定义用户控件，以及检查它是否被选中的代码，如果是，它会突出显示它，如果它没有被选中，它会隐藏突出显示。很简单。

现在，我有一个充满该对象的面板，我需要它与任何文件资源管理器（例如 Windows 资源管理器）类似地工作。我的意思是，如果您单击该项目，它会自行选择。这不是问题，只需单击鼠标即可。当用户想要选择其他项目时，问题就出现**了**。

我基本上想要的是：

每当用户单击一个项目时，所有其他项目都会取消选择等等。

我试图找到最好的方法，我想到的是有一个父类来指导这些操作（更改布尔值，并调用更新函数），但它似乎太草率了，也许有点复杂。有什么建议么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:58:43.487

最常见的方法是“收集”组件，它管理规则，例如可以选择多少个，并公开有用的信息和事件（例如 SelectedItem 和 SelectedItemChanged）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T18:31:22.333

我发现我的第一个想法是我能找到的最好的（因为“重新发明轮子”，如果不是，过度松懈的答案对于这种情况来说是很好的）。我创建了一个包含这些用户控件列表的类，并为用户控件提供了该列表的属性。

所以当我想选择一个用户控件时，我在它的点击事件中有一个函数，它位于我创建的类中，它取消选择它下面的所有控件，并选择我点击的那个。

它确实像我预期的那样看起来有点草率，但我确信如果我真的全神贯注，我可以让它变得简单而有条理，以防其他人想知道并需要这些信息。

# python - Django - 每个模板中的通用数据

> ID：10378223
> 
> 赞同：1
> 
> 时间：2012-04-30T03:44:24.173
> 
> 标签：python, django

我需要将实现部分传递到我博客的每个页面。从谷歌，我最终创建了一个这样的 context_processor

```
# processor.py 

from myblog.models import Post

def get_date(request):
  return {'dates' : Post.objects.order_by('created')} 
```

这是base.html

```
<ul>
    {% for d in dates %}
        <li><a href="#">{{ d.created|date:"M-Y"}}</a></li>
    {% endfor %}
</ul> 
```

这是 TEMPLATE_CONTEXT_PROCESSORS

```
TEMPLATE_CONTEXT_PROCESSORS = (
  "django.contrib.auth.context_processors.auth",
  "django.core.context_processors.debug",
  "django.core.context_processors.i18n",
  "django.core.context_processors.media",
  "django.core.context_processors.static",
  "django.core.context_processors.tz",
  "django.contrib.messages.context_processors.messages",
  'myblog.processor.get_date',
) 
```

最后，为了让日期出现在页面上，我需要在每个视图中传递 RequestContext。这使我不得不在每个视图中重复代码，但我可以使用[这里](http://lincolnloop.com/blog/2008/may/10/getting-requestcontext-your-templates/)的解决方案来克服它。但是，基于[此](https://softwareengineering.stackexchange.com/questions/131073/why-should-i-not-always-pass-a-django-request-context-in-a-view)，可能会导致性能问题。

最后，Django中这个小任务的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T04:27:16.223

大多数基于现代[类的视图](https://docs.djangoproject.com/en/1.4/ref/class-based-views/)都可以为您完成所有工作，`RequestContext`因此您无需担心。如果您喜欢基于旧式函数的视图 - 有一个[`render`](https://github.com/django/django/blob/master/django/shortcuts/__init__.py#L22)函数。

那个“性能问题”是关于特定 `django.core.context_processors.request`的。只要你不使用它——一切都很好。

# ruby-on-rails - Rails + Sorcery：向现有用户添加外部身份验证

> ID：10378227
> 
> 赞同：2
> 
> 时间：2012-04-30T03:45:28.270
> 
> 标签：ruby-on-rails, authentication, sorcery

我在 Rails 应用程序中使用 Sorcery 进行身份验证。我已经设置好了，我可以通过用户名/密码或外部身份验证添加用户（目前仅使用 twitter）。但是，我无法弄清楚的一件事是如何向现有用户添加身份验证，即。由用户名创建的用户，该用户可能希望稍后添加其 Twitter 帐户作为登录方式。

我尝试向外部模块添加一个方法来启用此功能...

```
module Sorcery
    module Controller
        module Submodules
            module External
                module InstanceMethods
                    protected

                    def add_provider_to_user(provider)
                        provider_name = provider.to_sym
                        provider = Config.send(provider_name)
                        user_hash = provider.get_user_hash
                        config = user_class.sorcery_config

                        user = current_user.send(config.authentications_class.to_s.downcase.pluralize).build(config.provider_uid_attribute_name => user_hash[:uid], config.provider_attribute_name => provider)
                        user.save(:validate => false)

                        return user
                    end
                end
            end
        end
    end
end 
```

......但这没有用。我似乎无法让 Config 类像在内部方法中那样运行，`Config.send('twitter')`总是返回 nil 而不是提供者。

Sorcery 中没有公开的方法。有没有人想出如何将此功能修补到应用程序中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T20:52:25.520

我最近使用[https://github.com/rcarter/sorcery](https://github.com/rcarter/sorcery)添加了将提供者链接到已通过身份验证的用户的功能。这是否符合您的要求？

我应该警告它尝试将 access_token 存储在您的用户模型中......您可能想要删除它。在此处查看更改：[https ://github.com/rcarter/sorcery/commit/f3984749659bceb7f7438cae8ea95ba5a415d1e2](https://github.com/rcarter/sorcery/commit/f3984749659bceb7f7438cae8ea95ba5a415d1e2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-30T07:23:34.890

这是一个非常古老的问题，但我只是想添加我的解决方案来使用 Microsoft ID 执行此操作。我需要让用户使用 Microsoft SSO 登录。我希望能够创建用户帐户并让他们设置为使用他们的 Microsoft 凭据登录。我正在使用 Ruby 2.7、rails 5.1 和 Sorcery 0.15。我使用了魔法 wiki 中的外部提供者示例代码以[https://github.com/Sorcery/sorcery/wiki/External](https://github.com/Sorcery/sorcery/wiki/External)

在 Azure Active Directory 端：

1.  将您的 Web 应用程序添加为已注册的应用程序
2.  下载您的用户的 .csv 文件并使用该信息在您的用户表中创建您的用户配置文件。他们的电子邮件将是他们的用户名。
3.  在 Azure 中注册的应用下创建客户端密码。
4.  为您的应用添加 Web 重定向 URI，例如`http://localhost:32795/oauth/callback?provider=microsoft`

在您的应用中：

1.  在 Authentications 表中创建用户的身份验证条目。每个用户都将拥有来自用户表的 user_id，他们的 uid 是下载的 .csv 文件中的“id”（在 Azure 中，这是他们的对象 ID），提供者是`microsoft`.
2.  为 MSFT 回调添加路由`get "/oauth/callback/microsoft" => "oauths#callback" # for microsoft`
3.  在中设置外部提供程序

app/config/initializers/sorcery.rb

```
config.microsoft.key = <your Application(client)ID>
config.microsoft.secret = <client secret you generated in Azure>
config.microsoft.callback_url = "http://localhost:3000/oauth/callback?provider=microsoft"
config.microsoft.user_info_mapping = {:email => "userPrincipalName", :username => "userPrincipalName"}
config.microsoft.scope = "openid email https://graph.microsoft.com/User.Read" 
```

您的应用程序现在将使用 MSFT ID 进行登录。请注意，即使您在应用程序中注销，当您单击链接以使用 MSFT 登录时，它也会自动让您登录，因为您的 MSFT 凭据已由浏览器保存。如果您转到您的 MSFT 帐户并注销，您将需要在 Azure 中设置一个注销 URI，该 URI 将告诉您的应用程序也注销。或者您可以设置您的应用程序以在您注销时摆脱办公室 cookie。

# ruby-on-rails - 链接图像 CSS 不会居中 Rails 3.2

> ID：10378235
> 
> 赞同：1
> 
> 时间：2012-04-30T03:47:05.473
> 
> 标签：ruby-on-rails, css, center

链接图像拒绝在产品框中居中。我尝试添加 text-align: center 和 display: block and margin: 0 auto 到但它不会居中！出于某种奇怪的原因，描述类有效，但中心类无效！

有人可以告诉我出了什么问题吗？

HTML：

```
1 <div id="container_product_photos">
2 
3 
4 <% @product_photos.each do |photo| %>
5   <div class="product_box" >
6     <%= link_to image_tag(photo.image.url(:small)), product_photo_path(photo), class: 'center' %>
7     <p class='description'><%= photo.name %> </p>
8   </div> 
9 <% end %>
10     
11 </div> 
```

部分 CSS 文件：

```
5 #container_product_photos{
6   margin: 0 auto; 
7   width: 650px;
8   overflow:hidden;
9   .product_box { 
10     height: 200px;
11     width: 180px;
12     float:left;
13     
14     .center {
15       margin: 0 auto;
16 
17     }
18     
19     .description {
20         width: 70px;
21         margin: 0 auto; 
22      }
23   }
24 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T03:55:24.330

.center 类不会对`margin:0 auto`set b/c 执行任何操作，HTML 链接标记 ( `<a></a>`) 不是块元素。你可以这样做：

```
.center {
    display:block;
    width:???px;
    margin: 0 auto;
} 
```

代替 ？？？与图像的宽度。

# android - Android浏览器的SPDY协议支持？

> ID：10378237
> 
> 赞同：3
> 
> 时间：2012-04-30T03:47:49.107
> 
> 标签：android, http, protocols, spdy

不知安卓浏览器是否支持谷歌新的SPDY协议？我可以从 Android 的 Chromium 源代码中找到 SPDY 注释，但我不确定它是否已完全实现。

如果启用，我想将普通 HTTP 与 SPDY 性能与智能手机进行比较。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T04:21:59.243

[Android 版 Chrome](http://www.google.com/intl/en/chrome/android/)支持 SPDY。

Amazon 的 Silk 也在使用 SPDY，但连接本身是通过 Amazon 的 SPDY 服务器代理的，所以这是一个稍微不同的用例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T14:53:57.327

Android 浏览器，因为 Honeycomb 支持 SPDY/2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:43:38.887

有趣的时机——谷歌今天在移动设备上发布了 SPDY 基准。

[https://developers.google.com/speed/articles/spdy-for-mobile](https://developers.google.com/speed/articles/spdy-for-mobile)

# android - JNI，使用本机代码访问 SurfaceTexture

> ID：10378239
> 
> 赞同：3
> 
> 时间：2012-04-30T03:48:05.347
> 
> 标签：android, android-ndk

我需要能够在设备摄像头生成的视频流上执行本机代码（算法），为此，我考虑过 OpenCV 摄像头捕获，不幸的是，目前它不支持 Android 4.0.3 @三星 G2这是我的目标设备，作为替代方案，我考虑使用[Java Camera 对象](http://developer.android.com/reference/android/hardware/Camera.html)进行捕获，并使用 JNI 将捕获的数据~编组~到本机域，但是，这会施加编组开销（处理数据），以避免那，我考虑将捕获的图像（预览）渲染到[GL 纹理](http://developer.android.com/reference/android/graphics/SurfaceTexture.html)（使用例如[Camera.setPreviewTexture](http://developer.android.com/reference/android/hardware/Camera.html#setPreviewTexture%28android.graphics.SurfaceTexture%29)），并直接访问本地域的 GL 纹理，从而避免不必要的应对。

**有没有办法直接访问[TextureSurface](http://developer.android.com/reference/android/graphics/SurfaceTexture.html) @ native domain ？**

任何帮助将不胜感激。

纳达夫在索芬

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T23:53:58.273

我认为，作为 Qualcomm 的 Vuforia 增强现实 SDK 的一部分发布的 VideoPlayback 示例应用程序实现了这一点。在过去的几天里，我自己才刚刚开始检查代码，其中很多对我来说都是新的，所以我不能 100% 确定。

[https://ar.qualcomm.at/content/video-playback-sample-app-posted](https://ar.qualcomm.at/content/video-playback-sample-app-posted)

如果我是对的，该应用程序通过 Java 域的 MediaPlayer 类播放电影文件，该类被渲染到 SurfaceTexture，然后由本机域中的 OpenGL ES 代码访问，以在实际的增强现实显示器上呈现。

# javascript - 其他人完成javascript后触发功能

> ID：10378243
> 
> 赞同：0
> 
> 时间：2012-04-30T03:48:34.813
> 
> 标签：javascript, jquery, function

所以我试图在 JavaScript 中运行一个函数，但我需要在该函数开始之前运行并完成所有其他函数。这是代码（对不起，我知道它很长，但这是我可以说明正在发生的事情的唯一方法）：

```
 getWeather();
        getAverage();

function getWeather() {
    $.getJSON("http://where.yahooapis.com/geocode?q=" + lat + ",+" + lon + "&gflags=R&flags=J", function(data){
        zipCode = data.ResultSet.Results[0].postal;
        zipCode = zipCode.substring(0,5);
        WOEID = data.ResultSet.Results[0].woeid;
        getYahooWeather(WOEID);
        getWeatherbug(zipCode);
        getWeatherUnderground(zipCode);
        getWorldWeather(zipCode);
    });
}

function getYahooWeather(x) {
    var query = escape('select item from weather.forecast where woeid="'+x+'"');
    var url = "http://query.yahooapis.com/v1/public/yql?q=" + query + "&format=json";

    $.getJSON(url, function(data2){
        yahooTemp = data2.query.results.channel.item.condition.temp;
        $("#yahoo-weather p").replaceWith("<p>Weather from Yahoo! powered by The Weather Channel = "+yahooTemp+"&deg;F</p>");
    });
}

function getWeatherbug(x) {
    var url = "http://i.wxbug.net/REST/Direct/GetObs.ashx?api_key="+ weatherbugAPI + "&zip="+x+"&ht=t&ic=1&f=?";
    console.log(url);

    $.ajax({
        url: url,
        dataType: "jsonp",
        success: function(data3) {
            //console.log(data3.temperature);
            wbTemp = data3.temperature;
            $("#wb-weather p").replaceWith("<p>Weather from WeatherBug = "+wbTemp+"&deg;F</p>");
        }
    });
}

function getWeatherUnderground(x) {
    $.ajax({
    url: "http://api.wunderground.com/api/b87325296cd69fa8/geolookup/conditions/q/IA/"+x+".json",
    dataType: "jsonp",
    success: function(parsed_json) {
        var location = parsed_json['location']['city'];
        wuTemp = parsed_json['current_observation']['temp_f'];
        $("#wu-weather p").replaceWith("<p>Weather from Weather Underground = "+wuTemp+"&deg;F</p>");
        }
    });
}

function getWorldWeather(x) {
    var url = "http://free.worldweatheronline.com/feed/weather.ashx?key="+wwKey+"&q="+x+"&fx=no&format=json";

    $.ajax({
        url: url,
        dataType: "jsonp",
        success: function(data6) {
            wwTemp = data6.data.current_condition[0].temp_F;
            $("#ww-weather p").replaceWith("<p>Weather from World Weather Online = "+wwTemp+"&deg;F</p>");
        }
    });
}

function getAverage() {
    avTemp = wbTemp + wwTemp + yahooTemp + wuTemp;
    console.log(avTemp);
} 
```

我遇到的问题是，每当我运行 getAverage 函数时，它都会返回 NaN，因为其他函数还没有返回它们的数据。

有没有办法在所有以前的函数返回它们的数据之后运行一个函数？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T03:54:51.980

一种更简单的方法是使用`async`可以在[https://github.com/caolan/async](https://github.com/caolan/async)找到的异步库。您可以使用该`parallel`函数并行运行 getter，然后在所有 getter 完成后返回。代码最终看起来像：

```
async.parallel([
    function(callback){
        setTimeout(function(){
            callback(null, 'one');
        }, 200);
    },
    function(callback){
        setTimeout(function(){
            callback(null, 'two');
        }, 100);
    },
],
// optional callback
function(err, results){
    // the results array will equal ['one','two'] even though
    // the second function had a shorter timeout.
}); 
```

另一种方法是拥有一个包含您正在等待的回调数量的全局变量。然后在每个天气获取器的回调中，递减计数器。在取平均值之前，只需等到计数器为 0 即可（您可以使用 setTimeout 等待一定时间，然后再次检查）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T03:52:00.253

简而言之：`getAverage`从`getJSON`回调中调用，即在你调用`getWorldWeather(zipCode);`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T04:11:47.443

肯定有。您将需要执行所谓的方法传递或回调。

这是一个**未经测试**的示例，说明您将如何去做：http: [//jsfiddle.net/UDbeV/](http://jsfiddle.net/UDbeV/)

让我更详细地解释一下。

```
var i = 0;
loopCount = function() {
    i++;
    if (i > 5) {
        getAverage();
    }
}); 
```

所以我们正在创建一个名为 loopCount 的函数来存储一个计数器。每次调用时，我们将其计数器加 1。

让我们将回调传递给您的方法：

```
 getYahooWeather(WOEID, callback);
    getWeatherbug(zipCode, callback);
    getWeatherUnderground(zipCode, callback);
    getWorldWeather(zipCode, callback);
    callback(); 
```

现在我们必须更改函数以允许第二个参数：

```
function getYahooWeather(x, callback) { ... 
```

最后，在每个块的末尾，我们要调用它：

```
$.getJSON(url, function(data2) {
    yahooTemp = data2.query.results.channel.item.condition.temp;
    $("#yahoo-weather p").replaceWith("<p>Weather from Yahoo! powered by The Weather Channel = " + yahooTemp + "&deg;F</p>");
    callback();
}); 
```

回调检查“它是否被调用了足够的次数（即：从平均之前你做了多少次调用），然后调用 getAverage();

可能有更有效的方法可以做到这一点，但它是星期一 :P 而且，它未经测试，所以如果你使用它，你可能需要稍微修改一下。:o)

# database - H2数据库如何在更新时保持行无序

> ID：10378245
> 
> 赞同：2
> 
> 时间：2012-04-30T03:48:54.823
> 
> 标签：database, sorting, h2

所以我有一个简单的数据库，其中包含一个包含多列的表，其中大部分是字符串类型，其中一个是布尔类型。

我的问题发生在我更新更改布尔状态的行时，数据库重新组织其自身以让状态为假的值排在第一位，而状态为真的值排在表中的最后。

有没有办法告诉表在更新每一行或创建实际表时不要对表进行排序？

再次感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T05:17:02.393

在 SQL 数据库中，表中的行顺序通常是未定义的。因此，如果您运行查询，例如

```
SELECT * FROM TEST 
```

然后数据库引擎可以以任何顺序返回行。如果要对行进行排序，则需要使用`ORDER BY`：

```
SELECT * FROM TEST ORDER BY NAME 
```

# vbscript - 没有 ... 位移运算符时的位移

> ID：10378246
> 
> 赞同：6
> 
> 时间：2012-04-30T03:49:17.560
> 
> 标签：vbscript, bit-manipulation, bit-shift

我必须实现校验和（CRC16 CCITT）来验证文件的内容。由于 << 和 >> 运算符以及网上提供的许多示例，校验和在 C 或 Java 中实现起来相当简单。

问题是……我的校验和计算必须在 VBScript 中实现。

我对这种语言的体验几乎为零，但据我了解，没有任何东西可以在 VBScript 中进行位移。因此，我依赖于**乘法和除以二。**它工作得很好，除了**负值**。

我进行了一些测试，我相信 VBScript 用二进制补码处理它的 16 位整数。

**Q1：**有人可以证实我这一点（VBScript 中的二进制补码）吗？我没有从 MSDN 网站上找到任何准确的信息。

**Q2：**当负数用二进制补码编码时，是否可以通过简单的数学运算进行位移（左右）？

.

非常感谢，我真的很想避免像处理整数作为'1'和'0'的数组或从VBScript调用一些java / c应用程序这样的混乱。

**编辑**感谢您的帮助，在下面找到我在 VBScript 中右移的实现：

```
Function rightShift(value,bits)
    Dim res

    res = 65535 AND value

    If value>=0 Then
       res = res \ (2^bits)
    Else If value=-1 Then
             res = rightShift(res + 32768, bits - 1)
         Else
             res = rightShift(value \ 2 + 32768, bits - 1)
         End If
    End If

    rightShift = res AND 65535
End Function 
```

请注意上面的代码：值有时会超过 16 位，因此我必须屏蔽未使用的位以避免溢出 ( `AND 65535`)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T04:13:40.013

在二进制补码算术中，负值的唯一影响是除以 2 右移：预期的右移将发生，但它也会在最高有效位 (MSB) 位置引入一个新的 1 位“保持负值”——除非原始值为 -1，在这种情况下所有位都变为 0。因此，要纠正这一点，请尝试以下伪代码：

```
rightshift(x) {
    if x >= 0 return x / 2;
    if x < -1 return x / 2 - MINVAL;    # Strip out sign bit
    # x must be -1, i.e. "all bits on"
    return x - MINVAL;
} 
```

`MINVAL`应该是其表示仅由 MSB 开启和所有其他位关闭的值，对于 16 位，它是 -32768。（之所以这样命名，是因为它将是使用二进制补码的最负数可表示的数字。）有趣的是，`MINVAL`在上述伪代码中，加法和减法一样有效，因为在二进制补码算术中，`x - y`=`x + NOT(y) + 1`和`MINVAL == NOT(MINVAL) + 1`.

使用乘以 2 的左移对负数的作用与对正数的作用一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-17T06:33:22.013

这不是回答，而是评论。@j_random_hacker 给出的答案对我有用。但是在像 C# 这样执行整数除法的语言中（假设您出于某种原因不能使用内置的右移运算符），当 x 不是偶数时，需要四舍五入。

```
static int MINVAL = (int) -0x80000000;
    static int ShiftRight(int n,int bits)
    {
        //if (n >= 0) return n / (int)Math.Pow(2, bits);
        //double temp = n / Math.Pow(2, bits);
        //int r  = (int) Math.Floor(temp);
        //return r;
        if (n >= 0) return n / 2;
        if (n < -1) return (int)Math.Round(n / (double)2, MidpointRounding.AwayFromZero) - MINVAL;//+ (n%2==0?0:-1);    // Strip out sign bit
        // x must be -1, i.e. "all bits on"
        return n - MINVAL;
    } 
```

现在是的，C# 有一个内置的移位运算符，所以这只是教育目的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-08-24T16:41:50.530

太慢了，试试这个。以下适用于值> = 0，但对于位移> 14位将抛出一个数组下标超出范围，代码为：

```
dim ShiftArray
ShiftArray = Array(1, 2, 4, 8, 16, 32, 64, 128, 256, 512,
1024,2048,4096, 8192, 16384)

' example usage
dim num
num = 17
num = num * ShiftArray(2) ' left shift 2 bits
num = num / ShiftArray(3) ' right shift 3 bits 
```

乘以要左移的位数。除以右移。该数组适用于 16 位整数。

对于 32 位整数，对于位移 > 30，数组将超出范围数组下标，并且是：

```
dim ShiftArray
ShiftArray = Array(1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024,   
2048,4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288,
1048576, 2097152, 4194304, 8388608, 16777216, 33554432,
67108864, 134217728, 268435456,  536870912, 1073741824) 
```

# java - [Soap getNodeValue:element withName:@"type"] 中的@"type" 是什么？Sudzc 生成的代码

> ID：10378249
> 
> 赞同：0
> 
> 时间：2012-04-30T03:49:23.450
> 
> 标签：java, sudzc

我已经使用 sudzc 为我现有的 Web 服务 (java) 生成带有 ARC 代码的目标 C。

1.  在 java 中，我有一个名为 syncResponseJB 的对象，其中包含一个 SyncResponseTransactionJB[] 对象数组。当我看到 sudzc 创建的代码时，它创建了 3 个对象。一个。syncResponseJB.m 和 h，b。ArrayOfSyncResponseJB.m 和 h 和 c。SyncResponseTransactionJB。只有 C 包含我想要的所有属性/属性。ArrayOfSyncResponseJB 只包含

    @implementation GRSArrayOfSyncResponseTransactionJB

    *   (id) init { if(self = [super init]) {

        } 返回自我；}

    *   (GRSArrayOfSyncResponseTransactionJB*) newWithNode: (CXMLNode*) node { if(node == nil) { return nil; } return (GRSArrayOfSyncResponseTransactionJB*)[[GRSArrayOfSyncResponseTransactionJB alloc] initWithNode: node]; }

    *   (id) initWithNode: (CXMLNode*) node { if(self = [super initWithNode: node]) { } return self; }

    *   (NSMutableString*) 序列化 { 返回 [self 序列化：@"ArrayOfSyncResponseTransactionJB"]; }

    *   (NSMutableString*) 序列化：(NSString*) nodeName { NSMutableString* s = [NSMutableString string]; [s appendFormat:@"<%@", nodeName]; [s appendString: [self serializeAttributes]]; [s appendString:@">"]; [s appendString: [self serializeElements]]; [s appendFormat:@"", nodeName]; 返回 s; }

    *   (NSMutableString*) 序列化元素 { NSMutableString* s = [超级序列化元素];

        返回 s; }

    *   (NSMutableString*) serializeAttributes { NSMutableString* s = [super serializeAttributes];

        返回 s; }

    -(BOOL)isEqual:(id)object{ if(object != nil && [object isKindOfClass:[GRSArrayOfSyncResponseTransactionJB class]]) { return [[self serialize] isEqualToString:[object serialize]]; } 返回否；}

    -(NSUInteger)hash{ 返回 [Soap generateHash:self];

    }

2.  当我做syncResponseJB.时，它只显示ArrayOfSyncResponseJB，现在显示SyncResponseTransactionJB。我不确定 ArrayOfSyncResponseJB 的使用。我在 Java 中没有等效的类。

3.  如果我忽略 ArrayOfSyncResponseJB 并使用 SyncResponseTransactionJB，它会部分起作用。我的部分意思是，我的实际响应 XML 是

    ProvisioningFor MDT 或 RM 版本 1.2.289DT_MINUTESint1440ApplicationfalseCatherinehttps://dcstest.support.xerox.com:443/download/dcs.jarTest MDT 版本771911BHM000001AddServiceBillingProvisioningFor MDT 或 RM 版本 1.2.289DT_MINUTESint1440ApplicationfalseCatherinehttps://dcs43/support.xerox.com: dcs.jarTest MDT 版本771912BHM000001AddServiceSupplies

但是当我在这一行之后打印输出时，

```
output = [deserializeTo initWithNode: element]; 
```

它只打印 xml 的前半部分，这是我返回的唯一数据。

```
 po [output serializeElements]
(id) $4 = 0x06c47610 <syncResponseTrans><callType>Provisioning</callType>    <dcsBundleDescriptor><bundleDesc>For MDT or RM version 1.2.2</bundleDesc><bundleId>89</bundleId><bundleParms><bundleParmsProperties></bundleParmsProperties></bundleParms><bundleType>Application</bundleType><downloadable>false</downloadable><submitterName>Catherine</submitterName><urlOfBundle>https://dcstest.support.xerox.com:443/download/dcs.jar</urlOfBundle><version>Test MDT Version</version></dcsBundleDescriptor><orderId>77191</orderId><orderItemId>1</orderItemId><serialNo>BHM000001</serialNo><serviceActionParms><serviceAction>AddService</serviceAction><serviceActionParmsProperties></serviceActionParmsProperties></serviceActionParms><serviceName>Billing</serviceName></syncResponseTrans> 
```

我怎样才能得到 XML 的第二段呢？

1.  在另一个角度，我想看看我是否可以使用 deserializeToDictionary 方法。但是，我现在明白了@"type" 是什么。当我按原样使用代码时，它为下面的行返回“int”

    NSString* type = [Soap getNodeValue:element withName:@"xsi:type"];

任何帮助对我来说都会非常有用。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T14:01:43.270

看看[这个](https://stackoverflow.com/q/10384349/1273881)。我认为它的 SudzC 的错误...

# jpa - 无状态会话 Bean - 停止多个调用

> ID：10378252
> 
> 赞同：0
> 
> 时间：2012-04-30T03:49:47.303
> 
> 标签：jpa, ejb-3.1, session-bean

因此，我从 BalusC 的[这篇文章](https://stackoverflow.com/questions/2090033/why-jsf-calls-getters-multiple-times/2090062#2090062)中读到了如何阻止无状态会话 bean 在被 JSF 访问（可能/将进行多次调用）时不断破坏数据存储（例如 DB），所以我已经实现了我的代码'd like to think is in what was posted by [BalusC](https://stackoverflow.com/users/157882/balusc) (and other forum posts from "best practice" I've seen about this issue).

我的无状态会话 bean 如下所示：

```
@Stateless
@Named("productsService")
public class ProductService {

    private static boolean changed = true;

    private List<Product> products;

    private long count;

    @PersistenceContext(name = "myPU")
    private EntityManager em;

    @Inject
    private Product product;

    public ProductService() {
    }

    private void productRecordsFromDB() {
        products = em.createNamedQuery("Product.getAll", Product.class).getResultList();
        Object o = em.createNamedQuery("Product.getCount", Product.class).getSingleResult();
        count = ((Long) o).longValue();
    }

    public void addProduct() {
        synchronized (ProductService.class) {
            changed = true;
            em.persist(product);
        }
    }

    public long countProducts() {
        return count;
    }

    public void removeProduct(Product p) {
        synchronized (ProductService.class) {
            changed = true;
            em.remove(em.merge(p));
        }
    }

    public int removeAllProducts() {
        synchronized (ProductService.class) {
            changed = true;
            return em.createNamedQuery("Product.deleteAll").executeUpdate();
        }
    }

    public List<Product> getProducts() {
        synchronized (ProductService.class) {
            if (changed) {
                productRecordsFromDB();
                changed = false;
            }
        return products;
        }
    }

    public Product getProduct() {
        return product;
    }

    public void setProduct(Product p) {
        product = p;
    }
} 
```

**编辑：**我已将同步块添加到相关部分以确保串行访问，尽管现在这开始感觉更像是一个单例。我仍然很想知道其他人如何处理与多次调用数据存储有关的问题。

具体来说，我创建了一个检查的“脏”标志，如果数据库已更新，则脏标志设置为 true（通过更新数据库）。在检测到脏标志后，它被设置回假，因此只调用了一次数据库。因此，不会发生 DB 抖动。

我的问题是：我所做的，这是解决解决方案的适当“最佳实践”，还是有一种我不知道的更聪明的方法？我在考虑旧的“J2EE”蓝图设计模式以及可能在 Java EE 6 的上下文中丢失的注释。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T08:07:34.800

> 这是解决解决方案的适当“最佳实践”还是我不知道的更聪明的方法？

不幸的是，您构建会话 bean 的方式并不是最佳实践。事实上，正如 Mikko 所解释的，这完全违背了会话 bean 的正常工作方式。因此，尽管您做出了明显的努力，但恐怕您创建的内容是不良做法的主要示例。它几乎做了所有在无状态会话 bean 中不应该做的事情**。**

为了解决 BalusC 概述的问题，您可以使用视图绑定到的单独的支持 bean，而不是让它直接绑定到服务。然后，此支持是在请求期间或在视图范围期间缓存结果的 bean。

例如

服务：

```
@Stateless
public class ProductService {

    @PersistenceContext(name = "myPU")
    private EntityManager em;

    public List<Product> getProducts() {
        em.createNamedQuery("Product.getAll", Product.class).getResultList();
    }

    // ...
} 
```

然后是支持 bean *（如果使用 CDI，则通过例如 CODI 添加 @ViewScoped 注释）*：

```
@ViewScoped
@ManagedBean
public class SomeBacking {

    private List<Product> products;

    @EJB
    ProductService productService;

    @PostConstruct
    public void init() {
        products = productService.getProducts();
    }

    public List<Product> getProducts() {
        return products;
    }
} 
```

我已经在`@PostConstruct`这里调用了服务，但是根据您的确切要求，这当然也可以在操作方法中或通过 getter 中的延迟加载模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T05:06:37.883

你有两个主要问题：

1.  状态在线程之间共享，没有锁保护
2.  无状态 bean 的状态对客户端可见。

*您通过静态更改*变量在 ProductService 的所有实例之间共享状态。但是，对此变量的读取和写入是不同步的。因此，不能保证实例共享相同的*changed*值。您必须通过锁控制访问（与同一个锁同步）或至少使其易失（只是保证您将看到最后写入的值）。

下一个问题是无状态 bean 不应该具有对客户端可见的状态。这就是他们被称为无国籍的原因。哪个实例处理调用对客户端应该没有影响，因为客户端无法控制调用哪些实例。例如，考虑以下场景（实例 s1 和 s2，假设两者都处于新鲜状态）：

1.  s1.getProducts => 改变 = 假
2.  s2.getProducts => 因为 changed 是 false，所以它会返回 null（没有一个给 s2 的实例变量 products 设置值）

**回答已编辑的问题和评论：** 无状态与状态仍然存在相同的问题。无状态用于没有状态的解决方案不适合的情况。正如您从下面看到的，哪个实例将处理业务方法调用仍然很重要：

1.  s1.getProducts => 改变 = 假；
2.  s2.getProducts => 因为 changed 是 false，所以返回 null

请遵循 Arjan Tijms 提供的方法，或者至少遵循相同的精神。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T16:33:14.977

这是迄今为止我在很长一段时间内看到的对无状态会话 bean 的最严重滥用。

您已经创建了一种 Singleton，但在一个绝对不适合此的 bean 中，混合关注全局和本地操作以及通过在类文字上同步导致死锁的风险。

如果您需要 Singleton，则应使用专用的 @Singleton bean，但如果您想在请求期间防止来自 JSF 的重复调用，请使用另一个答案中显示的支持 bean。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T01:03:09.353

作为单例的 EJB 有一个具体的应用程序，示例[Here](http://www.theserverside.com/news/1363656/New-Features-in-EJB-31)。EJB 3.0 标准允许对单个会话 bean 进行分时同步访问。话虽如此，您有以下选项来防止/控制会话缓存。

1) 单例 EJB 可以维护数据库结果的本地缓存副本，该副本使用 EJB 3.0 Timer bean 按计划刷新，这是一个可笑的简单示例[Here](http://www.adam-bien.com/roller/abien/entry/simplest_possible_ejb_3_16)。然后，您可以将这个单例注入到您喜欢的任何上下文中 JSF 托管 bean、CDI bean 等

2）或者，您的特定用例可以缓存它自己的所需数据的本地副本，该副本在 bean 构造时读取*一次*`@PostConstruct`，尽管这种范例更适用于寿命更长的 bean 而不是`@RequestScoped`bean。

3) 与 2) 相关，有一个`@ApplicationScoped`功能与上述 1) 类似的 bean，但现在维护各种列表的（巨大）缓存

# multithreading - 更快的 TMultiReadExclusiveWriteSynchronizer？

> ID：10378253
> 
> 赞同：22
> 
> 时间：2012-04-30T03:49:50.440
> 
> 标签：multithreading, delphi, critical-section, readerwriterlockslim, readerwriterlock

有没有*更快*的那种`TMultiReadExclusiveWriteSynchronizer`？也许是 FastCode？

从 Windows Vista 开始，Microsoft 添加了[Slim Reader/Writer lock](http://msdn.microsoft.com/en-us/library/windows/desktop/aa904937%28v=vs.85%29.aspx)。它[的性能](http://blog.delphi-jedi.net/2011/09/16/slim-readwrite-lock-the-fast-alternative-to-tmultireadexclusivewritesynchronizer/)比 Delphi 的`TMultiReadExclusiveWriteSynchronizer`. 不幸的是，它只存在于 Windows Vista 及更高版本中，实际上很少有客户拥有。

大概 a 中使用的概念`Slim Reader/Writer lock`可以在本机 Delphi 代码中重做 - 但有人做过吗？

我有一种情况，在 a 上获取和释放锁`TMultiReadExclusiveWriteSynchronizer`（即使没有争用 - 单个线程）会导致 100% 的开销（操作时间加倍）。我可以在没有锁定的情况下运行，但是我的类不再是线程安全的。

有更快的`TMultiReadExclusiveWriteSynchronizer`吗？

**注意**：如果我使用 a`TCriticalSection`我只会遭受 2% 的性能损失（尽管已知关键部分在*获取*成功时会很快，即当它是单线程并且没有争用时）。CS 的缺点是我失去了“*多个阅读器*”的能力。

# 测量结果

使用`TMultiReadExclusiveWriteSynchronizer`相当多的时间花在里面`BeginRead`and `EndRead`：

![在此处输入图像描述](../Images/deb735790d4321905b01941812201df2.png)

然后，我将代码移植到使用 Window 自己的**SlimReaderWriter 锁**（一些代码重写，因为它不支持递归锁获取），并分析了结果：

*   **`TMultiReadExclusiveWriteSynchronizer`**: 10,698 ns 每次迭代
    10,697,772,613 ns 迭代 1,000,000 次

*   **`SRWLock`**: 8,802 ns 每次迭代
    8,801,678,339 ns 迭代 1,000,000 次

*   **`Omni Reader-Writer lock`**: 8,941 ns 每次迭代
    8,940,552,487 ns 迭代 1,000,000 次

使用 SRWLocks（又名 Omni 的旋转锁）时提高了 17%。

现在，我无法永久切换代码以使用[Windows Vista SRWLocks](http://msdn.microsoft.com/en-us/library/windows/desktop/aa904937.aspx)，因为有一些完整的客户企业仍在使用 Windows XP。

Slim 锁只是对`InterlockedCompareExchange`功能的谨慎使用；但比我能成功使用的要小心。我离窃取所涉及的 140 条机器指令还差得很远，并且已经完成了*。*

## 奖金阅读

*   [关键部分总是更快吗？](https://stackoverflow.com/questions/853316/is-critical-section-always-faster)
*   [如何编写快速的多线程 Delphi 应用程序](http://synopse.info/forum/viewtopic.php?id=322)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-09-13T06:21:13.227

[`TOmniMREW`](https://stackoverflow.com/a/909591/133516)从`OmniThreadLibrary`声称更快，更轻量级：

OTL 是一个优秀的线程库，顺便说一句。

# 示例代码

```
TOmniReaderWriterLock = class(TInterfacedObject, IReaderWriterLock)
private
   omrewReference: Integer;
public
   { IReaderWriterLock }
   procedure BeginRead;
   procedure EndRead;
   procedure BeginWrite;
   procedure EndWrite;
end;

{ TOmniReaderWriterLock }

procedure TOmniReaderWriterLock.BeginRead;
var
  currentReference: Integer;
begin
    //Wait on writer to reset write flag so Reference.Bit0 must be 0 than increase Reference
    repeat
        currentReference := Integer(omrewReference) and not 1;
    until currentReference = Integer(InterlockedCompareExchange(Pointer(omrewReference), Pointer(Integer(currentReference) + 2), Pointer(currentReference)));
end;

procedure TOmniReaderWriterLock.EndRead;
begin
    //Decrease omrewReference
    InterlockedExchangeAdd(@omrewReference, -2);
end;

procedure TOmniReaderWriterLock.BeginWrite;
var
    currentReference: integer;
begin
    //Wait on writer to reset write flag so omrewReference.Bit0 must be 0 then set omrewReference.Bit0
    repeat
        currentReference := omrewReference and (not 1);
    until currentReference = Integer(InterlockedCompareExchange(Pointer(omrewReference), Pointer(currentReference+1), Pointer(currentReference)));

    //Now wait on all readers
    repeat
    until omrewReference = 1;
end;

procedure TOmniReaderWriterLock.EndWrite;
begin
    omrewReference := 0;
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-28T19:03:40.840

最后我使用了一个折衷的解决方案。`Omni`读写锁使用“ *slim”*原则（旋转位操作）。像 Window 自己的一样，它不支持锁升级。我已经测试过了，它似乎没有*锁定*崩溃~~或~~死锁。

最后，我使用了后备情况。*支持“读写”*概念的最通用的通用接口：

```
IReaderWriterLock = interface
   ['{6C4150D0-7B13-446D-9D8E-866B66723320}']
   procedure BeginRead;
   procedure EndRead;
   procedure BeginWrite;
   procedure EndWrite;
end; 
```

然后我们在运行时决定使用哪个实现。如果我们使用的是 Windows Vista 或新版本，请使用 Window 自己的`SlimReaderWriter`，否则回退到`Omni`版本：

```
TReaderWriterLock = class(TObject)
public
   class function Create: IReaderWriterLock;
end;

class function TReaderWriterLock.Create: IReaderWriterLock;
begin
   if Win32MajorVersion >= 6 then //SRWLocks were introduced with Vista/Server 2008 (Windows version 6.0)
   begin
      //Use the Windows built-in Slim ReaderWriter lock
      Result := TSlimReaderWriterLock.Create;
   end
   else
   begin
      //XP and earlier fallback to Omni equivalent
      Result := TOmniReaderWriterLock.Create;
   end;
end; 
```

> **注意**：任何代码都会发布到公共领域。无需归属。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-04T20:41:18.273

Delphi`TMultiReadExclusiveWriteSynchronizer`非常复杂 - 它可以递归获取，并且您可以从 更新`Read`到`Write`。

这带来了成本，在这种情况下，这意味着每个线程管理一个共享状态桶。由于 Windows 线程本地机制（可通过 访问`threadvar`）对此过于简单（无法处理多个 MREWS 实例），它以一种相当低效的方式完成 - 请参阅 RTL 或 JCL 源 - 实现非常相似，共享较差的性能和更新死锁风险。

首先确保您确实需要 MREWS 功能——我假设，根据锁定开销与工作负载的比例大小，使用`TCriticalSection`.

如果您真的需要它，请使用 Delphi 实现并注意可能隐藏的解锁`BeginWrite`- 请参阅它的文档和返回值含义。

`SRW`可以使用函数或内联程序集来实现类似于 Vista的`Interlocked`功能，但在大多数情况下不值得付出努力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T15:59:53.597

JCL 有一个 MREWS，它是一种不同的实现，可能对您有用。不确定它需要什么版本的 Windows。

[http://wiki.delphi-jedi.org/wiki/JCL_Help:TJclMultiReadExclusiveWrite](http://wiki.delphi-jedi.org/wiki/JCL_Help:TJclMultiReadExclusiveWrite)

[http://wiki.delphi-jedi.org/index.php?title=JEDI_Code_Library](http://wiki.delphi-jedi.org/index.php?title=JEDI_Code_Library)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-20T11:28:48.547

试试这个？它可以用作普通变量：

```
type myclass=class
              Lock:TOBRWLock;
              function ReadIt:Integer;
              procedure WriteIt(A:Integer);
             end;  
function ReadIt:Integer;
begin;
 Lock.LockRead;
 Result:=GetVal;
 Lock.UnLockRead;
end; 
```

有很大的改进空间，您可以从这里构建有利于读写的品种，或者根据需要采取不同的行动。

```
const ldFree    = 0;
      ldReading = 1;
      ldWriting = 2;
type TOBRWLock          = record
                 [Volatile]WritersWaiting,
                           ReadersWaiting,
                           ReadersReading,
                           Disposition    : Integer;
                           procedure LockRead;
                           procedure LockWrite;
                           procedure UnlockRead;
                           procedure UnlockWrite;
                           procedure UnReadWrite;
                           procedure UnWriteRead;
                          end;

procedure TOBRWLock.LockRead;
var SpinCnt : NativeUInt;
    I       : Integer;
begin
 SpinCnt:=0;
 TInterlocked.Increment(ReadersWaiting);
 repeat
  if (Disposition=ldReading)
     then begin
           I:=TInterlocked.Increment(ReadersReading);
           if (Disposition<>ldReading) or (I=1)(*Only 1 read reference or Disposition changed, suspicious, rather retry*)
              then begin
                    TInterlocked.Decrement(ReadersReading);
                    continue;
                   end
              else begin(*Success*)
                    TInterlocked.Decrement(ReadersWaiting);
                    break;
                   end;
          end;
  if (WritersWaiting<>0)or(Disposition<>ldFree)
     then begin
           SpinBackoff(SpinCnt);
           continue;
          end;
  if TInterlocked.CompareExchange(Disposition,ldReading,ldFree)=ldFree
     then begin
           TInterlocked.Increment(ReadersReading);
           TInterlocked.Decrement(ReadersWaiting);
           break;
          end;
  SpinBackoff(SpinCnt);
 until False;
end;

procedure TOBRWLock.LockWrite;
var SpinCnt : NativeUInt;
begin
 SpinCnt:=0;
 TInterlocked.Increment(WritersWaiting);
 repeat
  if (Disposition<>ldFree)
     then begin
           SpinBackoff(SpinCnt);
           continue;
          end;
  if TInterlocked.CompareExchange(Disposition,ldWriting,ldFree)=ldFree
     then begin
           TInterlocked.Decrement(WritersWaiting);
           break;
          end
     else SpinBackoff(SpinCnt);
 until False;
end;

procedure TOBRWLock.UnlockRead;
begin
 {$IFDEF DEBUG}
 if Disposition<>ldReading
    then raise Exception.Create('UnlockRead a lock that is not Reading');
 {$ENDIF}
 TInterlocked.Decrement(ReadersReading);
 if ReadersReading=0
    then begin;
          if TInterlocked.CompareExchange(Disposition,ldFree,ldReading)<>ldReading
             then raise Exception.Create('Impossible 310');
         end;
end;

procedure TOBRWLock.UnlockWrite;
begin
 {$IFDEF DEBUG}
 if Disposition<>ldWriting
    then raise Exception.Create('UnlockWrite a lock that is not Writing');
 {$ENDIF}
 if TInterlocked.CompareExchange(Disposition,ldFree,ldWriting)<>ldWriting
    then raise Exception.Create('Impossible 321');
end;

procedure TOBRWLock.UnReadWrite;
var SpinCnt : NativeUInt;
begin
 {$IFDEF DEBUG}
 if Disposition<>ldReading
    then raise Exception.Create('UnReadWrite a lock that is not Reading');
 {$ENDIF}
 TInterlocked.Increment(WritersWaiting);
 SpinCnt:=0;
 repeat
  if ReadersReading=1(*Only me reading*)
     then begin;
           if TInterlocked.CompareExchange(Disposition,ldWriting,ldReading)<>ldReading(*Must always succeed*)
              then raise Exception.Create('Impossible 337');
           TInterlocked.Decrement(ReadersReading);
           TInterlocked.Decrement(WritersWaiting);
           break;
          end;
  SpinBackoff(SpinCnt);
 until False;
end; 
```

# c# - 什么是 C# 中 Java 的 string.getBytes() 的等价物？

> ID：10378258
> 
> 赞同：3
> 
> 时间：2012-04-30T03:50:52.710
> 
> 标签：c#, java

> **可能重复：**
> [Java 中的 getBytes() 等价于 C#](https://stackoverflow.com/questions/7089640/equivalent-of-getbytes-in-java-to-c-sharp)

在 Java 中：

```
String s="abcde"; 
byte bar[] = s.getBytes(); 
```

在 C# 中：

```
for (int i = 0; i < s.Length; i++)
{
    bar[i] = Convert.ToByte(s.Substring(i, 1)); 
} 
```

我使用 Java 示例 getBytes 来转换 C# 代码。但是上面的 C# 代码不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T03:54:26.537

编码.GetBytes

[http://msdn.microsoft.com/en-us/library/system.text.encoding.getbytes.aspx](http://msdn.microsoft.com/en-us/library/system.text.encoding.getbytes.aspx)

```
byte[] bytes = Encoding.ASCII.GetBytes("Sweet!"); 
```

# extjs4.1 - 锁定列的网格中的对齐问题

> ID：10378260
> 
> 赞同：2
> 
> 时间：2012-04-30T03:51:14.480
> 
> 标签：extjs4.1

我正在使用 ExtJs 4.1。

我有一个带有分页的网格。网格中的前几列被锁定。而且由于结果集很大（很多列），我得到水平滚动条。这就是它的外观：滚动条仅在锁定列之后开始（这在第一列被锁定时才有意义）。

![Paging_One][1]

问题：由于最后一条记录总是在滚动条下，用户看不到它。此外，如果用户使用向下键导航到它，对齐就会消失并且看起来很难看。请参阅下图以查看对齐问题。![在此处输入图像描述][2]

请提供您的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T11:31:37.213

尝试调用：treeGrid.getView().refresh()

调用 treeGrid.show() 之后

# jquery - 如何让这个 jQuery 监听器不会多次触发？

> ID：10378263
> 
> 赞同：0
> 
> 时间：2012-04-30T03:51:18.320
> 
> 标签：jquery, ajax, infinite-scroll

我目前有以下功能，可以有效地从 Django 检索 JSON 并通过无限滚动加载电影。但是，我发现有时此事件会触发多次，并且最终会获得两次相同的页面。

```
$(window).scroll(function() {
  var break_point = $(document).height() - ($(window).height() * 1.02);
  if ($(window).scrollTop() >= break_point) {
    var timePeriod = $('.tab-content').find('.active').attr('id');
    var nextPage = $('#'+timePeriod+' ul li:last').attr('data-next');
    if (nextPage) {
      loadMovies(timePeriod, nextPage);
    }
  }
}); 
```

阻止此侦听器每页执行多次的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T15:01:50.440

感谢罗布的帮助！我只是发布我最终做的事情以供其他人参考。我使用了 underscore.js 库的 debounce 函数。

```
var infiniteScroll = _.debounce(function() {
  var break_point = $(document).height() - ($(window).height() * 1.02);
  if ($(window).scrollTop() >= break_point) {
    var timePeriod = $('.tab-content').find('.active').attr('id');
    var nextPage = $('#'+timePeriod+' ul li:last').attr('data-next');
    if (nextPage) {
      loadMovies(timePeriod, nextPage);
    }
  }
}, 250);

$(window).scroll(infiniteScroll); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T04:00:24.630

使用 .one('scroll', function() 而不是 .scroll(function()

[http://api.jquery.com/one/](http://api.jquery.com/one/)

不过，考虑到您的功能，您可能必须在重新加载时重新附加处理程序。但是 one() 将确保它仅在您附加后触发一次。

# php - 注意处理 PHP 的警告

> ID：10378269
> 
> 赞同：0
> 
> 时间：2012-04-30T03:51:51.557
> 
> 标签：php

我正在为我的媒体课在网页上进行测验，但是，我遇到了麻烦。当我提交测验时，我收到通知说：

> 注意：未定义变量：第 65 行 /var/www/html/horvati2-results.php 中的 all_my_variables
> 
> 注意：未定义的变量：第 69 行 /var/www/html/horvati2-results.php 中的 current_timestamp
> 
> 注意：未定义变量：第 70 行 /var/www/html/horvati2-results.php 中的 SERVER

我的这部分 PHP 看起来像这样：

```
 $csv_filehandle = fopen("/var/www/html/data/quiz.csv",'a');
    fputcsv($csv_filehandle,array($summer,$spring,$fall,$winter));
    fclose ($csv_filehandle);

    $visit_id = uniqid('',TRUE);

    $json_filehandle = fopen("/var/www/html/data/$visit_id.json",'w');
    fwrite($json_filehandle,json_encode($all_my_variables));
    fclose($json_filehandle);

    $all_my_variables = array(
        'timestamp' => $current_timestamp,
        'user_ip' => $SERVER['REMOTE_ADDR'],
        'summer' => $summer,
        'spring' => $spring,
        'fall' => $fall,
        'winter' => $winter,
    );

    $current_hour = date_default_timezone_set("America/Chicago");
    $current_timestamp = date(DATE_RFC822); 
```

我将不胜感激一些帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T03:54:15.720

`$current_timestamp`不存在；不要尝试使用它。

`$SERVER`是错字；它应该是`$_SERVER`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T03:54:24.867

警告来自这一行：

```
fwrite($json_filehandle,json_encode($all_my_variables));
                                    ^^^^^^^^^^^^^^^^^ 
```

在此代码执行时，all_my_variables 尚未定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T03:54:19.000

您正在使用变量：`$all_my_variables`在您声明它之前（2 行之后）。

尝试将其放在行上方：

```
$json_filehandle = fopen("/var/www/html/data/$visit_id.json",'w'); 
```

# ruby-on-rails - Thinking_Sphinx 部分工作匹配

> ID：10378272
> 
> 赞同：0
> 
> 时间：2012-04-30T03:52:26.433
> 
> 标签：ruby-on-rails, search, indexing, thinking-sphinx

我有一个带有think_sphinx 的rails 应用程序，它成功地用于索引/搜索。然而，我想知道是否有办法让部分工作匹配项进行搜索。这意味着如果我有一份标题为“最佳报告”的报告并且我搜索了“最佳”，它将返回该报告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T08:12:19.553

我建议您尝试使用 Thinking Sphinx 进行通配符搜索。

基本上有三种设置支配通配符搜索世界：* enable_star * min_prefix_len * min_infix_len

*   min_prefix_len => 索引的最小单词前缀长度
*   min_infix_len => 中缀索引允许通过'start*'、'*end'和' *middle* '通配符实现通配符搜索

注意： *enabled_star 是必需的，加上另外两个用于启用前缀或中缀搜索的设置（不能同时具有，至少在同一个索引上）*

例如 ：

模型 ：

```
class Comment < ActiveRecord::Base

   #define the indexes for your searchable attributes 

  define_index do
   indexes :comment
   enable_star: true
   min_infix_len: 3
   has created_at,updated_at
  end

end 
```

控制器 ：

```
 class CommentsController < ApplicationController

     def search
      @result = ThinkingSphinx.search "*#{params[:id]}*" ,:classes => [Comment,....] 

     end
    end 
```

然后重建 thinking_sphinx ：

1.  耙 ts:停止
2.  耙 ts:index
3.  耙 ts：开始

（或者）

1.  耙 ts：重建

上面的示例将导致以下实例：

*   评论。搜索“最佳*”

*   评论.搜索“最佳代表*”

*   评论。搜索“*代表*”..等

如果有任何疑问，请随时问我.......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T04:42:44.933

我不确定，但默认情况下它以这种方式工作，但是您可以在此处查看匹配模式[http://freelancing-god.github.com/ts/en/searching.html](http://freelancing-god.github.com/ts/en/searching.html)

# fosuserbundle - FOSUserBundle 注册错误

> ID：10378274
> 
> 赞同：0
> 
> 时间：2012-04-30T03:52:41.453
> 
> 标签：fosuserbundle

当新用户注册时，我遇到了 FOSUserBundle 问题。

注册后，一切似乎都很好，我看到了通知：

```
The user has been created successfully
papi@gmail.com 
```

和 ：

```
Congrats papi@gmail.com, your account is now activated. 
```

然后，如果我单击任何链接，例如“主页”，我会看到“登录/注册”，就好像我不再登录一样。我认为注册后用户应该保持登录状态。另外，我没有经过身份验证的用户的权利，就好像我没有登录一样。

因此，如果我此时尝试登录（在注册后），我会看到登录名/密码提示，但同时我会看到通知：

```
papi@gmail.com Logout 
```

似乎我同时登录（通知）和未登录（网站行为）。FOSUserBundle 的行为不一致。

你对如何解决这个问题有什么建议吗？我不确定我应该在这里发布哪个配置文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T14:43:24.560

这是一个已知的错误。你可以在 github 上找到修复：

[https://github.com/FriendsOfSymfony/FOSUserBundle/pull/578](https://github.com/FriendsOfSymfony/FOSUserBundle/pull/578)

# php - 如何签署 Apache 服务器，以便来自目录的所有请求都通过 HTTPS 并包含您的私钥？

> ID：10378279
> 
> 赞同：1
> 
> 时间：2012-04-30T03:53:45.563
> 
> 标签：php, javascript, apache, ssl, x509certificate

所以我被[MintChip Challenge](http://developer.mintchipchallenge.com/)录取了，但不幸的是我没有支持的移动设备（Android、iPhone 或 Windows Phone），所以我必须使用[Hosted API](http://developer.mintchipchallenge.com/api/hosted/index.php)。我打算使用 JavaScript/PHP 与 API 进行交互。唯一的问题是，当我尝试请求数据时，我收到[403 错误](http://en.wikipedia.org/wiki/Http_status_codes#403)，这意味着 API 理解了我的请求但选择拒绝它。

我知道所有请求都需要 SSL 并[使用您提供的证书进行签名](http://blog.codekills.net/2012/04/07/a-first-look-at-mintchip%27s-hosted-api%27s-crypto/)。我也知道我的证书有效并正确[导入到我的浏览器](http://www.onlinehowto.net/install-ssl-certificate-in-firefox/784)，因为我可以通过点击任何 URL 进入托管 API 并直接查看请求，即： [https ://remote.mintchipchallenge.com/mintchip/info/ json](https://remote.mintchipchallenge.com/mintchip/info/json)

所以最大的问题是，**Apache Web 服务器本身是否可以**像我的浏览器一样为所​​有请求签名，以启用服务器-服务器签名请求。除此之外，PHP 是否有任何库或实用程序可用于导入 x.509 证书并用它签署您的请求？

我通常使用 JSONp 向 JSON API 发出客户端-服务器请求，这可以解决这个需求，但可以理解的是，JSONp 被视为安全风险，因此不受 MintChip 支持。我也想不出任何其他 API 对每个请求都需要这种级别的安全性，通常只是 BASIC Auth 或 ws-security 或其他东西，这是否矫枉过正，甚至会让事情变得更安全吗？一般信息问题通常不被看好，因为我什至在发布之前就已经对这个问题发出警告，但也许一些安全专家有更多关于如何签署 Apache Web 服务器、对来自特定目录的所有请求强制 SSL、保护密钥同时的信息将它们存储在服务器上，通过 PHP 使用 x.509 等？谢谢你的帮助。

（更新：2012-05-04，更改标题以反映您使用私钥签署请求的事实，并且它们当然会使用您的公钥解密）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:01:57.210

通常，您使用私钥签名......而不是使用 X.509 证书将包含的公钥。

至于通过 PHP 使用 X.509...查看[phpseclib，一个纯 PHP X.509 实现](http://phpseclib.sourceforge.net)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T21:58:20.470

不。Apache 服务器不会向 MintChip 本身生成 API 请求，因此无法让它开始签署它不知道的请求。

直接通过客户端 Web 浏览器创建对 MintChip API 的请求很可能是不合适的。无论如何，没有什么好方法可以保证客户拥有适当的证书。

[如果您使用curl](http://php.net/curl)扩展通过 PHP 发出 API 请求，您可以`CURLOPT_SSLCERT`在发出请求时使用该选项来指定要使用的客户端证书。理想情况下，您应该将所有执行 API 请求的代码都放在一个位置（例如，一个`mintchip_api`函数），因此无需将其应用于“源自目录的所有请求”。

# scala - scala中的数组减法数组

> ID：10378282
> 
> 赞同：3
> 
> 时间：2012-04-30T03:54:11.163
> 
> 标签：scala

我正在学习 Scala 的技巧，并且想知道是否有一种简单的方法来进行数组减法。

假设我有两个数组，其中元素的形式为 (K,V)：

```
A: Array((1,2), (2,3), (4,1))
B: Array((1,1), (2,3)) 
```

我想得到

```
A - B: Array((1,1), (4,1)) 
```

相应的键应该减去。

任何帮助表示赞赏。提前致谢！

编辑：似乎“减法”这个词令人困惑。我想做的是减去数组中 (K, V) 对中匹配键的值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-30T05:28:58.243

这通常是一个集合操作，所以如果顺序不重要，您可以尝试使用集合。那么它就会像`A.toSet -- B.toSet`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-30T04:12:27.287

如果您的意思是要为每个匹配的键从 A 中减去 B，并且如果差为 0，则忽略它，然后执行以下操作：

```
val a = Array((1,2), (2,3), (4,1))
val b = Array((1,1), (2,3))

val bMap = b.toMap
a.map{ case (k,v) => (k, v - bMap.getOrElse(k,0)) }.filter(_._2 != 0)
// Array((1,1), (4,1)) 
```

此过程转换`b`为地图以便于查找。然后我们遍历`a`并为每个元素减去`b`该键的值（如果不存在则为 0）。最后，我们删除结果中所有值为 0 的条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-03T11:47:49.517

您可以使用“for 表达式”来做到这一点：

```
val a = Array((1,2), (2,3), (4,1))
val b = Array((1,1), (2,3))

val bMap = b.toMap
for {
  (k, v) <- a                      // get an element from a
  nv =  v - bMap.getOrElse(k,0)    // calculate the new value
  if (nv > 0)                      // filter the 0 values
} yield (k, nv)                    // yield the updated pair 
```

# mysql - 使用逗号分隔值mysql循环触发

> ID：10378285
> 
> 赞同：0
> 
> 时间：2012-04-30T03:54:23.303
> 
> 标签：mysql

我需要在 mysql 中创建一个插入后触发器。

我有3张这样的桌子。

表格1

项目ID（TestP），站点（st1，st2，st3）

表2

项目名称、项目 ID、项目详细信息

表3

项目名称、项目详细信息、站点

现在我必须编写一个触发器，它将在 Table3 中插入​​ 3 行，当我在 Table2 中插入 1 行时（TestProject，TestP，Details1）

表3中的值应该是这样的

第 1 行：TestProject，Details1，st1 第 2 行：TestProject，Details1，st2 第 3 行：TestProject，Details1，st3

请有人帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T05:03:10.347

首先将此过程添加到您的数据库中

[http://forge.mysql.com/tools/tool.php?id=4](http://forge.mysql.com/tools/tool.php?id=4) （编辑 2020-09-09，链接现已失效，但回路机找到源）

```
DELIMITER //

DROP PROCEDURE IF EXISTS split_string //
CREATE PROCEDURE split_string (
    IN input TEXT
    , IN `delimiter` VARCHAR(10) 
) 
SQL SECURITY INVOKER
COMMENT 
'Splits a supplied string using using the given delimiter, 
placing values in a temporary table'
BEGIN
    DECLARE cur_position INT DEFAULT 1 ;
    DECLARE remainder TEXT;
    DECLARE cur_string VARCHAR(1000);
    DECLARE delimiter_length TINYINT UNSIGNED;

    DROP TEMPORARY TABLE IF EXISTS SplitValues;
    CREATE TEMPORARY TABLE SplitValues (
        value VARCHAR(1000) NOT NULL PRIMARY KEY
    ) ENGINE=MyISAM;

    SET remainder = input;
    SET delimiter_length = CHAR_LENGTH(delimiter);

    WHILE CHAR_LENGTH(remainder) > 0 AND cur_position > 0 DO
        SET cur_position = INSTR(remainder, `delimiter`);
        IF cur_position = 0 THEN
            SET cur_string = remainder;
        ELSE
            SET cur_string = LEFT(remainder, cur_position - 1);
        END IF;
        IF TRIM(cur_string) != '' THEN
            INSERT INTO SplitValues VALUES (cur_string);
        END IF;
        SET remainder = SUBSTRING(remainder, cur_position + delimiter_length);
    END WHILE;

END // 
```

它将任何字符串拆分为临时表中的行。

将 Table1 中的列发送到该过程，并使用生成的临时表将值插入 Table3

# heroku - Heroku 附加配置可以在云中随机更改吗？

> ID：10378289
> 
> 赞同：0
> 
> 时间：2012-04-30T03:54:31.017
> 
> 标签：heroku

[作为 Heroku 的新手，我自己对附加组件](https://stackoverflow.com/questions/7843874/heroku-addons-confusion)有点困惑。

大约一年前的这篇[Heroku 博客文章引用了使用附加组件的环境变量作为最佳实践：](http://blog.heroku.com/archives/2011/6/28/the_new_heroku_4_erosion_resistance_explicit_contracts/)

> 您的应用程序从环境变量（例如）中读取支持服务（例如数据库、memcached 或传出 SMTP 服务器`DATABASE_URL`）的配置，而不是硬编码的常量或配置文件。这允许平台轻松连接附加资源（当您运行时`heroku addons:add`），而无需接触您的代码。

我确实在使用环境变量（通过 Heroku 配置），但在一种情况下，我使用的是我自己的变量，而不是由附加组件添加的默认变量。

（具体来说，我更喜欢在 Heroku 的 Redis 缓存中使用 eg `CACHE_HOST`、`CACHE_PORT`等`REDISTOGO_URL`。感觉更精确/模块化和更通用——尤其是当我在开发过程中使用 Redis 的本地实例而不是 RedisToGo 时。）

我想知道，这是一种不好的做法吗？附加配置可以`REDISTOGO_URL`在云中随机更改吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T14:08:16.773

Heroku 附加组件团队的首席工程师。回答你的问题和你的其他观点和推理：

*   插件配置可以改变吗？是的。附加供应商可以随时更改它而不会发出警告。我们建议提供商不要更改它，除非他们绝对必须这样做，因为这会导致您的应用程序和进程重新启动。但它可以改变，所以你应该假设它会改变。

*   更精确/模块化。已经有一种既定的标准化方法来定义指向资源的指针，即 URI。我们建议提供商尽可能使用它。

*   更通用，特别是对于本地开发。是的。我们认识到这是一个问题。我们正在讨论解决它的不同方法，在此期间我建议使用工头和 .env 文件。

希望有帮助。让我知道如果还有什么，

格伦

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T07:25:50.937

这是配置变量的重点。应该/如果/当插件提供者/Heroku 需要更改它的变量时，它可以这样做，而无需您更新任何代码库。显然，如果您选择根据变量将变量拆分为您自己的`REDISTOGO_URL`变量，则确实需要您的干预，但总的来说，我认为这是一个很好的设计。

# python - Blender UV 纹理图像未使用 Python API 更新

> ID：10378290
> 
> 赞同：4
> 
> 时间：2012-04-30T03:54:49.780
> 
> 标签：python, image, blender

我正在使用 Ubuntu 12.04 上的 Python 脚本更新 Blender 2.63 中的 UV 纹理图像。我可以设置 Image 对象的文件路径属性，但图像没有刷新。我尝试调用 Image 对象的 update() 和 reload() 成员但没有成功。单击 GUI 中的重新加载按钮会按预期刷新图像。将鼠标悬停在 GUI 中的重新加载按钮上表明它使用 bpy.ops.image.reload()。但是当我调用它时，它会返回 CANCELED 状态，我假设是因为有一些方法可以在 bpy.context 模块中选择图像对象，但我一直无法弄清楚如何完成。也许这是一个错误？

相关代码如下：

```
# Update the filepath of a UV texture image
obj = bpy.context.scene.objects.active
image = obj.data.materials[0].texture_slots[0].texture.image
image.filepath = '//myfile.png'

# None of these work to refresh the image
image.update ()
image.reload ()
bpy.ops.image.reload() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-05T18:15:09.667

`bpy.data.images['your_image'].reload()` 实际上确实会从磁盘重新加载图像，但是要让搅拌机更新屏幕上的像素，您需要在视口中进行更新（图像编辑器和 3d 视图等）。

导致更新的一种方法是遍历区域，如果 area.type 是“IMAGE_EDITOR”或“VIEW_3D”（或其他一些必需的类型），您可以这样做`.tag_redraw()`

所以像：

```
for area in bpy.context.screen.areas:
    if area.type in ['IMAGE_EDITOR', 'VIEW_3D']:
        area.tag_redraw() 
```

# javascript - 是否可以在 CSS 中进行数学运算？

> ID：10378292
> 
> 赞同：39
> 
> 时间：2012-04-30T03:54:52.280
> 
> 标签：javascript, jquery, html, css

我有 jquery accorion id`#accordion`和 header class name 中的一些内容`.simpleColor`。现在我想给 .simpleColor 一个计算好的边距。在伪......它看起来像这样，

```
.simpleClass {
    margin-left: ((#accordion.width/2) - (.simpleColor.width/2));
} 
```

如果可能的话，我愿意使用任何其他技术（如 javascript）来实现这一点。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2013-05-29T03:26:08.063

有一个名为[calc](https://developer.mozilla.org/en-US/docs/Web/CSS/calc)的 CSS 函数开始得到很好的支持。语法如下：

```
width: calc(50% - 100px); 
```

（请注意，运算符周围的空格很重要）

这允许在 CSS 中实现真正的动态计算支持。使用预处理器，您只能将静态长度与静态长度以及相对长度与相对长度结合起来。

此时 calc 已获得广泛支持，应该可以安全使用，除非您有支持旧版浏览器的特定需求。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-30T04:01:04.863

在 CSS 中原生地进行数学运算是不可能的。您可以使用 JavaScript 在页面加载时更改 CSS 属性，但这很麻烦，并且必须在每次页面加载时都这样做，这会使您的页面变慢。

您需要使用 CSS 预处理器，例如[LESS](http://lesscss.org/#-operations)、[Stylus](http://learnboost.github.com/stylus/)或[SASS](http://sass-lang.com/)。

使用这两种语言的好处是您可以从它们生成实际的 CSS 样式表。您还可以获得诸如函数、mixin、变量等的好处。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-30T04:00:58.243

```
jQuery('.simpleClass').css('margin-left', (jQuery('#accordian').width() / 2) - (jQuery('.simpleColor').width() / 2) + 'px'); 
```

应该做你想做的事。但是你需要在 javascript 中做这样的事情，你不能在纯 CSS 中做到这一点，除非 #accordian 和 .simpleColor 的宽度是预先知道的（因此是预先计算好的）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-07-14T23:48:03.540

您可以在 CSS 中进行数学运算，例如：

`height: calc(100% - 20%);`

CSS 也将处理不同的单位，所以这也有效：

`height: calc(100% - 20px);`

此外，还添加了[**min()**](https://developer.mozilla.org/en-US/docs/Web/CSS/min)、[**max()**](https://developer.mozilla.org/en-US/docs/Web/CSS/max)和[**clamp()**](https://developer.mozilla.org/en-US/docs/Web/CSS/clamp)，允许进行如下计算：

`height: min(calc(100% - 20px), 50%);`

1.  **min()**：获取最小值；
2.  **max()**：获取最大值；和
3.  **clamp()**：通过提供上限和下限来限制值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-30T04:08:06.753

我相信 CSS 应该是纯样式定义。我不喜欢将一些计算与它混合在一起。我会在我的 javascript 中这样做

```
var accWidth=parseInt($("#accordion").css("width").replace("px",""));
var simpWidth=parseInt($(".simpleColor").css("width").replace("px",""));
var marginLeft=((accWidth/2)-(simpWidth/2));       
$(".simpleClass").css("margin-left",marginLeft); 
```

工作示例[http://jsfiddle.net/mzTRw/19/](http://jsfiddle.net/mzTRw/19/)

# java - 安卓图片加载

> ID：10378293
> 
> 赞同：0
> 
> 时间：2012-04-30T03:55:05.497
> 
> 标签：java, android, image

我对 Android 还很陌生，我无法加载图像。我当前的代码如下所示：

```
package com.android.skeleton;

import java.io.IOException;
import java.io.InputStream;
import java.util.Random;

import android.content.Context;
import android.content.res.AssetManager;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.media.SoundPool;

public class GameModel extends Game {
    private Bitmap background;
    private Bitmap gameover;
    public final int PLAYER = 0;
    public final int ENEMY = 1;
    public final int EXIT = 2;
    public final int BIGENEMY = 3;

    private int health;

    Sprite player;
    Enemy enemy1;
    Enemy enemy2;
    BigEnemy enemy3;
    Enemy enemy4;
    Enemy enemy5;
    Enemy enemy6;
    Exit exit;

    //Images
    Bitmap cat;
    Bitmap jellyfish;
    Bitmap bigdog;
    Bitmap exitTile;

    SoundPool music;
    SoundPool damageSound;

    Context context;
    InputStream inputStream = null;

    private static GameModel gameModel = null;
    public static GameModel getGameModel(){
        if(gameModel == null){
            gameModel = new GameModel();
        }
        return gameModel;
    }
    private GameModel(){

    }

    public void update(){

    }

    public void draw(Canvas canvas){

    }

    public boolean processTouchEvent(int x, int y){
        return false;
    }
    @Override
    public void gameStart() {
        // TODO Auto-generated method stub

         try{
                AssetManager assetManager = context.getAssets();
                inputStream = assetManager.open("/resources/blackcat.png");
                cat = BitmapFactory.decodeStream(inputStream);
                inputStream.close();

                inputStream = assetManager.open("/resources/Jellyfish1.png");
                jellyfish = BitmapFactory.decodeStream(inputStream);
                inputStream.close();

                inputStream = assetManager.open("/resources/Dog.png");
                bigdog = BitmapFactory.decodeStream(inputStream);
                inputStream.close();

                inputStream = assetManager.open("/resources/exit.png");
                exitTile = BitmapFactory.decodeStream(inputStream);
                inputStream.close();

                inputStream = assetManager.open("/resources/kitchen.png");
                background = BitmapFactory.decodeStream(inputStream);
                inputStream.close();

                inputStream = assetManager.open("/resources/endscreen.png");
                gameover = BitmapFactory.decodeStream(inputStream);
                inputStream.close();
                }catch(IOException ex){}

         gameSetBackground(background);

        player = new Sprite(cat, 0);
        enemy1 = new Enemy(jellyfish, 0);
        enemy2 = new Enemy(jellyfish, 0);
        enemy4 = new Enemy(jellyfish, 0);
        enemy5 = new Enemy(jellyfish, 0);
        enemy6 = new Enemy(jellyfish, 0);
        enemy3 = new BigEnemy(bigdog, 1.4);
        exit = new Exit (exitTile, 0);

        player.setLocation(320, 480);
        player.setType(0);
        player.setActive();
        health = 10;

        enemy1.setLocation(0, 160);
        enemy1.setVelocity(5, 0);
        enemy1.setType(1);
        enemy1.setActive();

        enemy2.setLocation(640, 320);
        enemy2.setVelocity(-5, 0);
        enemy2.setType(1);
        enemy2.setActive();

        Random random = new Random();
        Random random2 = new Random();
        int i = Math.abs(random.nextInt() % 10);
        int j = Math.abs(random2.nextInt() % 10);

        while (i < 2){
            i = Math.abs(random.nextInt() % 10);
        }
        while (j < 2){
            j = Math.abs(random.nextInt() % 10);
        }

        enemy4.setLocation(640, 0);
        enemy4.setVelocity(-i, j);
        enemy4.setType(1);
        enemy4.setActive();

        Random random3 = new Random();
        Random random4 = new Random();
        int k = Math.abs(random3.nextInt() % 10);
        int l = Math.abs(random4.nextInt() % 10);

        while (k < 2){
            k = Math.abs(random.nextInt() % 10);
        }
        while (l < 2){
            l = Math.abs(random.nextInt() % 10);
        }

        enemy5.setLocation(0, 480);
        enemy5.setVelocity(k, l);
        enemy5.setType(1);
        enemy5.setActive();

        enemy6.setLocation(600, 440);
        enemy6.setVelocity(0, -5);
        enemy6.setType(1);
        enemy6.setActive();

        exit.setLocation(600, 0);
        exit.setVelocity(0, 0);
        exit.setType(2);
        exit.setActive();

        //Add sprites to game
        gameAddSprite(player);
        gameAddSprite(enemy1);
        gameAddSprite(enemy2);
        gameAddSprite(enemy3);
        gameAddSprite(enemy4);
        gameAddSprite(enemy5);
        gameAddSprite(enemy6);
        gameAddSprite(exit);

    }
    @Override
    public void gameEnd() {
        // TODO Auto-generated method stub
        player.setInactive();
        enemy1.setInactive();
        enemy2.setInactive();
        enemy3.setInactive();
        enemy4.setInactive();
        enemy5.setInactive();
        enemy6.setInactive();
        exit.setInactive();
        gameSetBackground(gameover);

    }
    @Override
    public void gameUpdate(Canvas canvas) {
        // TODO Auto-generated method stub
        player.update();

        enemy1.rotate(0.1);
        enemy1.update();

        enemy2.rotate(0.1);
        enemy2.update();

        enemy3.update();

        enemy4.rotate(0.1);
        enemy4.update();

        enemy5.rotate(0.1);
        enemy5.update();

        enemy6.rotate(0.2);
        enemy6.update();

        if(enemy3.getPosy() == 430){
            enemy3.setInactive();
        }

        if(health == 0){
            gameEnd();
        }
    }
    @Override
    public void spriteCollide(Sprite s1, Sprite s2) {
        // TODO Auto-generated method stub

        if(s2.getType() == ENEMY && s1.getType() == PLAYER)
        {
            health -= 1;
        }
        if(s2.getType() == BIGENEMY && s1.getType() == PLAYER)
        {
            health -= 1;
        }
        if (s2.getType() == EXIT && s1.getType() == PLAYER)
        {
            gameEnd();
        }
        if(s2.getType() == ENEMY && s1.getType() == ENEMY)
        {
            double i = s2.getVelx();
            double j = s2.getVely();
            double k = s1.getVelx();
            double l = s1.getVely();
            s2.setVelocity(-i, -j);
            s1.setVelocity(-k,-l);
        }
    }

    public void actionPerformed() {
        // TODO Auto-generated method stub

            //Create random spawn positions for bigdogs
            Random random = new Random();
            Random random2 = new Random();
            int xPos = Math.abs(random.nextInt() % 640);
            int yVel = Math.abs(random2.nextInt() % 20);

            //Make sure y velocity is between 10 and 30\. Set this way for now
            //to hide problems with individual enemy3 sprites becoming inactive.
            while (yVel < 10)
                yVel = Math.abs(random.nextInt() % 30);

            //Spawn big dogs with random x position and y velocity
            //according to timer settings.
                enemy3.setLocation(xPos, 0);
                enemy3.setActive();
                enemy3.setVelocity(0, -yVel);
                enemy3.setType(3);

    }
@Override
public void gameCheckInputs() {
    // TODO Auto-generated method stub

}

} 
```

我知道我可能正在做一些愚蠢的事情，这可能是一个非常快速的解决方案。

已更新完整代码

这是日志文件：

```
04-30 03:49:19.490: W/dalvikvm(749): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
04-30 03:49:19.560: E/AndroidRuntime(749): FATAL EXCEPTION: main
04-30 03:49:19.560: E/AndroidRuntime(749): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.android.skeleton/com.android.skeleton.Android_SkeletonActivity}: java.lang.NullPointerException
04-30 03:49:19.560: E/AndroidRuntime(749):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
04-30 03:49:19.560: E/AndroidRuntime(749):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
04-30 03:49:19.560: E/AndroidRuntime(749):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
04-30 03:49:19.560: E/AndroidRuntime(749):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
04-30 03:49:19.560: E/AndroidRuntime(749):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-30 03:49:19.560: E/AndroidRuntime(749):  at android.os.Looper.loop(Looper.java:137)
04-30 03:49:19.560: E/AndroidRuntime(749):  at android.app.ActivityThread.main(ActivityThread.java:4424)
04-30 03:49:19.560: E/AndroidRuntime(749):  at java.lang.reflect.Method.invokeNative(Native Method)
04-30 03:49:19.560: E/AndroidRuntime(749):  at java.lang.reflect.Method.invoke(Method.java:511)
04-30 03:49:19.560: E/AndroidRuntime(749):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
04-30 03:49:19.560: E/AndroidRuntime(749):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
04-30 03:49:19.560: E/AndroidRuntime(749):  at dalvik.system.NativeStart.main(Native Method)
04-30 03:49:19.560: E/AndroidRuntime(749): Caused by: java.lang.NullPointerException
04-30 03:49:19.560: E/AndroidRuntime(749):  at com.android.skeleton.Game.gameSetBackground(Game.java:61)
04-30 03:49:19.560: E/AndroidRuntime(749):  at com.android.skeleton.GameModel.gameStart(GameModel.java:98)
04-30 03:49:19.560: E/AndroidRuntime(749):  at com.android.skeleton.GameSurfaceView.<init>(GameSurfaceView.java:23)
04-30 03:49:19.560: E/AndroidRuntime(749):  at com.android.skeleton.Android_SkeletonActivity.onCreate(Android_SkeletonActivity.java:18)
04-30 03:49:19.560: E/AndroidRuntime(749):  at android.app.Activity.performCreate(Activity.java:4465)
04-30 03:49:19.560: E/AndroidRuntime(749):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
04-30 03:49:19.560: E/AndroidRuntime(749):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920) 
```

这是游戏设置背景

```
public void gameSetBackground(Bitmap i){
        backgroundImage = i;
        if (clearList == null){
            clearList = new LinkedList<Rect>(); }
        clearList.add(new Rect(0, 0, canvas.getWidth(), canvas.getHeight()));
    } 
```

这是Game.java

```
package com.android.skeleton;

import java.util.LinkedList;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.graphics.Rect;
import android.util.Log;
import android.view.SurfaceHolder;

public abstract class Game implements Runnable {

    private LinkedList<Sprite> spriteList;

    public LinkedList<Sprite> sprites(){
        return spriteList;
    }
    private LinkedList<Rect>clearList;
    private Thread gameThread;
    private Bitmap backgroundImage=null;
    Canvas canvas;
    SurfaceHolder surfaceHolder = null;
    Canvas backGraphics;

    public abstract void gameStart();

    public abstract void gameEnd();

    public abstract void gameUpdate(Canvas c);

    public abstract void spriteCollide(Sprite s1, Sprite s2);

    public void init(){
        spriteList = new LinkedList<Sprite>();
        clearList = new LinkedList<Rect>();
        canvas = new Canvas();
    }

    public void setDebugOn(){
        for(Sprite s: spriteList)
            s.showRectangle();
    }
    public void setDebugOff(){
        for(Sprite s: spriteList)
            s.hideRectangle();
    }

    public void gameAddSprite(Sprite s){
        spriteList.add(s);
    }

    public void gameAddSprites(Sprite []slist){
        for(Sprite sp: slist)
            spriteList.add(sp);
    }

    public void gameSetBackground(Bitmap i){
        backgroundImage = i;
        if (clearList == null){
            clearList = new LinkedList<Rect>(); }
        clearList.add(new Rect(0, 0, canvas.getWidth(), canvas.getHeight()));
    }

    public void start(){
        gameThread  = new Thread(this);
        gameThread.start();
        gameStart();
    }

    public void stop(){
        gameEnd();
        gameThread = null;
    }

    public void update(Canvas canvas){
        for(Sprite s: spriteList){
            if(s.needsCleared()){

        }
        gameUpdate(backGraphics);
        paint(canvas);}
    }

    public void paint(Canvas canvas){
        if(backgroundImage != null) {
            for(Rect r: clearList){
                backGraphics.drawBitmap(backgroundImage, 
                                       r.left, r.top, null);
            }
        } else {
            for(@SuppressWarnings("unused") Rect r: clearList){
            }
        }
        clearList.clear();
        int n = spriteList.size();
        for(int i=n-1; i>=0; i--){
            spriteList.get(i).draw(backGraphics);
        }
    }

    public void run() {
        while(gameThread == Thread.currentThread()){
            if(surfaceHolder.getSurface().isValid()){
                canvas = new Canvas();
            canvas = surfaceHolder.lockCanvas();
            gameCheckInputs();
            checkCollisions();
            paint(canvas);
            try{
                Thread.sleep(40);
            }
            catch(InterruptedException ex){
                ex.printStackTrace();
            }
        }
            surfaceHolder.unlockCanvasAndPost(canvas);
        }
    }

    private void checkCollisions(){
        if(spriteList.size() > 1){
            int nsprites = spriteList.size();
            for(int i=0; i<nsprites; i++) if(spriteList.get(i).isActive()){
                for(int j = i+1; j<nsprites; j++) if(spriteList.get(j).isActive()){
                    if(spriteList.get(i).getRect().intersect(spriteList.get(j).getRect())){
                        spriteCollide(spriteList.get(i), spriteList.get(j));
                    }
                }
            }
        }           
    }

    public void gameCheckInputs() {
        // TODO Auto-generated method stub

    }

    public void gameStart(Context context) {
        // TODO Auto-generated method stub

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:33:39.333

嗨，nutriletter，我可以知道你真正想要做什么 -

```
public void gameSetBackground(Bitmap i){
    backgroundImage = i;
    if (clearList == null){
        clearList = new LinkedList<Rect>(); }
    clearList.add(new Rect(0, 0, canvas.getWidth(), canvas.getHeight()));
} 
```

你没有使用 `backgroundImage`我对吗？

尝试这个 -

```
if(backgroundImage!=null) 
```

你的代码的其余部分..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T04:42:48.687

基本上我做错了什么是我没有在我的 Game.java 类中调用 Init，我加入了一些捕获，例如

```
if (clearList == null){
        clearList = new LinkedList<Rect>(); } 
```

我现在遇到的问题是它只显示一个空白屏幕，但如果我要为这个问题提出一个新问题可能会更好，但是谢谢大家的帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T04:51:19.093

将您的图像放入 assets 文件夹而不是将其放入 assets/resources 文件夹并使用以下代码检索图像。

```
try {
    InputStream bitmap=getAssets().open("icon.png");
    Bitmap bit=BitmapFactory.decodeStream(bitmap);

} catch (IOException e1) {
    // TODO Auto-generated catch block
    e1.printStackTrace();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T18:58:14.623

我很难遵循您的代码，但我看到的一个问题，至少要解决您的异常，是您`getWidth()`可能在画布被绘制之前调用画布。在`onCreate()`一个activity的方法中，你的activity还没有被绘制到屏幕上，所以现在不是操作a的canvas的好时机`View`。我可以肯定知道的最好建议是扩展`SurfaceView`和覆盖该`onDraw()`方法，然后`SurfaceView`在您的 XML 布局中使用您的自定义，并使用完全量化的名称，例如`<com.android.skeleton.MySurfaceView />`.

例如：

```
public class MySurfaceView extends SurfaceView {

    public MySurfaceView(Context context) {
        this(context, null, 0);
    }

    public MySurfaceView(Context context, AttributeSet attrs) {
        this(context, attrs, 0);
    }

    public MySurfaceView(Context context, AttributeSet attrs, int defStyle) {

        super(context, attrs, defStyle);
    }

    @Override
    protected void onDraw(Canvas canvas) {

        super.onDraw(canvas);
        // Draw some stuff
    }
} 
```

如果你在 XML 中扩展你的布局，你会像这样使用你的自定义视图：

```
<com.mypackage.MySurfaceView
    ...
/> 
```

# c# - 关于开发支持大量并发用户的 Web 应用程序的参考资料

> ID：10378294
> 
> 赞同：-1
> 
> 时间：2012-04-30T03:55:09.753
> 
> 标签：c#, java, performance

我们有一个项目需要开发一个支持大量并发用户（大约 5000）的 Web 应用程序。
本应用主要用于提交申请、业务流程管理。所以它不仅仅是一个信息网站。
我们之前开发过类似的应用程序（使用spring + hibernate + jsf），但是在更多的用户参与之后，性能会急剧下降。
我的问题是我应该考虑什么样的架构，我们应该考虑什么样的硬件？是否有任何参考资料（书籍、博客、网站）可以用来开始我的研究并为这个新项目找到更好的架构？

提前感谢您的所有帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T04:48:18.887

I can't give you specific references, but if you go to your favourite online bookstore, and search on "building scalable websites", there are a number of books on the subject.

(I wouldn't worry too much about publication dates because the principles haven't changed radically in the last few years.)

There are also a few past questions on SO whose answers offer good advice. However, this is too large a topic for S) Q&A's to cover adequately. Hence a text book is better.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T11:34:13.017

看看Theo Schlossnagle的[Scalable Internet Architectures和 Abbott 和 Fisher](http://amzn.to/myfMn1)[的 The Art of Scalability](http://amzn.to/jG2AzI)，它们都是非常好的盒子，将带您了解这些原则

# python - python中的'Google Docs like'功能

> ID：10378300
> 
> 赞同：-1
> 
> 时间：2012-04-30T03:56:08.637
> 
> 标签：python

我所拥有的是一个 UI，它允许用户输入关于玩具的信息。
现在用户界面可以同时被多个用户访问，并且用户存储的信息被存储在一个文件中，这可能会导致玩具信息被意外覆盖。
该文件将包含多个玩具的信息，但相同的玩具信息不能再次显示，这在多用户环境中是很有可能的。
我对网络开发相当陌生。还有蟒蛇。
解决此问题的第一步应该是什么？

非常感谢任何帮助。
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T04:03:57.277

允许多人安全地对同一数据进行操作的“流行”算法称为“操作转换”。

有几个提供它的库，虽然我从未使用过任何库，所以我觉得实际上推荐任何库都不舒服。但[这里](https://www.google.com/search?q=operational+transformation+in+python)有一个谷歌搜索，应该让你开始。当然，还有[维基百科](http://en.wikipedia.org/wiki/Operational_transformation)。

# php - PHP DateTime::createFromFormat 不起作用

> ID：10378301
> 
> 赞同：0
> 
> 时间：2012-04-30T03:56:18.640
> 
> 标签：php, date

`DateTime::createFromFormat`似乎无法正常工作，有人知道原因和/或如何解决吗？

鉴于此代码：

```
var_dump(DateTime::createFromFormat('m', '02')->format('m'));
var_dump(DateTime::createFromFormat('n', '2')->format('n')); 
```

我的预期输出是

```
02
2 
```

但是我实际上得到：

```
03
3 
```

示例： [http ://codepad.viper-7.com/e4hns6](http://codepad.viper-7.com/e4hns6)

我已经在许多服务器上进行了测试，包括：

*   赢得 PHP 5.4
*   Linux PHP 5.3
*   蝰蛇键盘

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T04:05:25.803

从[手册](http://www.php.net/manual/en/datetime.createfromformat.php)：

> “如果 format 不包含字符 ! 则生成时间中未在 format 中指定的部分将设置为当前系统时间。”

以下应该按预期工作：

```
var_dump(DateTime::createFromFormat('!m', '02')->format('m'));
var_dump(DateTime::createFromFormat('!n', '2')->format('n'));

# result:
string(2) "02"
string(1) "2" 
```

# lua - 如何使用 Lua/Corona SDK 创建/处理分层图像？

> ID：10378308
> 
> 赞同：0
> 
> 时间：2012-04-30T03:56:56.113
> 
> 标签：lua, coronasdk

假设我想要一个由 2 层组成的动画笑脸：面部背景 + 面部前景。

背景层是一种简单的颜色/纹理。前景层是动画层（动画微笑、哭泣、大笑...等）。

我怎样才能在 Lua 中写出来，以便 Corona 将这些层视为单个对象/实体？我想要一个可以使用的实体（用于碰撞、动画运动等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T13:44:24.807

我会用[displayGroup](http://blog.anscamobile.com/2012/02/corona-display-groups-101/)做到这一点。

像这样的东西：

```
local smiley = display.newGroup()
local emotion = display.newImage("happy.png")
local background = display.newImage("background.png")

smiley:insert(background)
smiley:insert(emotion)

-- moving smiley will also move background and emotion
-- because they are attached to the smiley displayGroup
smiley.x = 100
smiley.y = 100 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T05:06:44.063

希望这可以帮助你。

```
smiley:insert(1,background)
smiley:insert(2,emotion) 
```

数字越大，图像越靠前

# .htaccess - .htaccess ErrorDocument 的相对路径

> ID：10378309
> 
> 赞同：2
> 
> 时间：2012-04-30T03:57:09.640
> 
> 标签：.htaccess, apache2

所以我有一个带有子目录的子域的 apache 服务器。我把我的目录变成子域。所以而不是`example.site.com/mycoolsite`它的`mycoolsite.example.com`. 或者换句话说，我变成`/var/www/mycoolsite`了`/var/mycoolsite`. 我使用以下代码使用 .htaccess 文件执行此操作。

```
RewriteCond %{HTTP_HOST} ^mycoolsite.site.com$ [NC]
RewriteCond %{REQUEST_URI} !^/mycoolsite/
RewriteRule ^(.*)$ /mycoolsite/$1 [L] 
```

伟大的。现在它将目录变成子域。现在的问题是 .htaccess 无法引用我为原始子域设置的 ErrorDocument。我可以去`example.site.com/mycoolsite/aNonExistantDirectory/`获取我设置的正确 404，但是当我尝试时，`mycoolsite.site.com/aNonExistantDirectory/`我得到了基本的服务器 404 错误页面，而不是我设置的页面。两者都在同一台服务器上。为了解决这个问题，我可以制作错误文档的副本并将它们放在`/mycoolsite/`目录中，但我希望我可以简单地参考原始错误文档。

问题是，我不知道如何参考我尝试过的错误`/var/www/error/`文档`/var/www/mycoolsite/`：

```
ErrorDocument 404 ../error/index.php?p=404
ErrorDocument 404 /www/error/index.php?p=404
ErrorDocument 404 www/error/index.php?p=404
ErrorDocument 404 error/index.php?p=404
ErrorDocument 404 /error/index.php?p=404 
```

这些都不起作用。在没有第一个`/`或前面的情况下尝试它`..`会在页面上显示错误文档行。我难住了。我希望我包含了足够的信息，但如果没有，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T09:26:56.007

我认为 apache 不允许您引用当前 document_root 之外的文件。这是一个安全的事情。您可以做的是创建一个虚拟 php 文件，其中只包含一个`include(../error/index.php)`

# css - LESS CSS 中的转义字符会插入不需要的空格

> ID：10378310
> 
> 赞同：7
> 
> 时间：2012-04-30T03:57:14.440
> 
> 标签：css, escaping, less

我正在尝试编写与以下 CSS 代码相对应的 LESS 代码，以在 IE 中生成渐变。

```
filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff9600',endColorstr='#ff6900'); 
```

以下是LESS代码：

```
.gradient(@start_color, @end_color)
{
    filter:~"progid:DXImageTransform.Microsoft.gradient(startColorstr='"@start_color~"',endColorstr='"@end_color~"')";
}
.gradient(#ff9600,#ff6900) 
```

在编译时，它给出了以下 CSS 代码：

```
filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=' #ff9600 ', endColorstr=' #ff6900 '); 
```

如您所见，颜色值的两侧都插入了空格，因此 IE 无法正确读取颜色。

我使用[http://crunchapp.net/](http://crunchapp.net/)和[http://winless.org/](http://winless.org/)编译了 LESS 代码，两者都提供了相同的结果。有没有办法避免这些空间。谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-30T05:56:55.400

使用变量插值而不是结束字符串并重新启动它。

例如

~"bar@{name}foo"

并且不会插入空格。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T10:23:15.277

我正在使用 LESS.app ( [www.lesscss.org](http://www.lesscss.org) ) ...

我只是把

```
filter: progid:dximagetransform.microsoft.gradient(startColorstr='@{start}', endColorstr='@{stopColor}', GradientType=0); 
```

它被正确编译如下：

```
filter: progid:dximagetransform.microsoft.gradient(startColorstr='#76787a', endColorstr='#9d9ea0', GradientType=0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T04:28:13.483

我对[LESS](http://lesscss.org/)不太熟悉；但是，从我在他们的页面上可以看到：

```
.class {
  filter: ~"ms:alwaysHasItsOwnSyntax.For.Stuff()";
} 
```

建议不应该`~`附加到变量上，并且如果您试图通过单引号，它将`"'@var'"`而不是`'"@var"'`在内部而不是外部使用单引号。我在这里做了更多的研究，并认为这是一个答案而不是评论。

# c# - 如何对接 Windows Mobile 6 设备并将其与本地数据库同步？

> ID：10378313
> 
> 赞同：0
> 
> 时间：2012-04-30T03:57:29.893
> 
> 标签：c#, windows-mobile, sql-server-ce

我真的对此感到困惑，我在谷歌上搜索并没有遇到任何教程或代码示例来完成此操作，即使是关于对接 windows mobile 6 设备的简单教程似乎也很难获得。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T04:04:11.690

如果这就是您的要求，请检查活动同步 API [http://msdn.microsoft.com/en-us/library/aa457095.aspx](http://msdn.microsoft.com/en-us/library/aa457095.aspx)

**编辑**示例代码[http://rapi.codeplex.com/discussions/216902](http://rapi.codeplex.com/discussions/216902)

**另一个链接** [http://social.msdn.microsoft.com/Forums/en/windowsmobiledev/thread/65a29ea0-af04-4b73-b40e-73f99de4eafc](http://social.msdn.microsoft.com/Forums/en/windowsmobiledev/thread/65a29ea0-af04-4b73-b40e-73f99de4eafc)

# c# - 如何将 DataContext 附加到此 ContextMenu？

> ID：10378315
> 
> 赞同：1
> 
> 时间：2012-04-30T03:57:35.473
> 
> 标签：c#, windows-phone-7, contextmenu, observablecollection, datacontext

我有一个正在尝试与 ContextMenu MenuItem 一起使用的 ObservableCollection：

```
private void MenuItem_TapCopyDetails(object sender, System.Windows.Input.GestureEventArgs e)
{
    //entries is a table in my datamodel
    var currentItem = ((sender as MenuItem).DataContext) as entries; //when it doesn't work, this is null
    if (currentItem.name == null) //and this throws a null reference exception
        MessageBox.Show("null");
    else
        MessageBox.Show(currentItem.name.ToString());
} 
```

但是第一行是空的。我多次使用该方法，但在这里失败了。实际上，正如您在 XAML 中看到的那样，还有另一个对此方法的调用，它工作正常。

唯一的区别在于 XAML。我在 TextBlocks 上使用绑定略有不同：

```
<!--ContentPanel - place additional content here-->
<Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
    <controls:Pivot Name="pivotControl" Margin="0,-20,0,0" SelectionChanged="Pivot_SelectionChanged">
        <controls:PivotItem Header="search" >
            <StackPanel>
                <ListBox Height="450" HorizontalAlignment="Left" Margin="0,10,0,0" 
                         Name="listBoxHome" VerticalAlignment="Top" Width="434"
                         ItemsSource="{Binding Path=SearchPeopleResults}">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Tap="StackPanel_Tap" Margin="5,0,0,0">

                                <!--These MenuItems work properly-->
                                <toolkit:ContextMenuService.ContextMenu>
                                    <toolkit:ContextMenu>
                                        <toolkit:MenuItem Header="copy details" Tap="MenuItem_TapCopyDetails" />
                                        <toolkit:MenuItem Header="bookmark person" Tap="MenuItem_Tap_BookmarkPerson" />
                                    </toolkit:ContextMenu>
                                </toolkit:ContextMenuService.ContextMenu>

                                <TextBlock Text="{Binding name}" TextTrimming="WordEllipsis" FontSize="22" />
                                <TextBlock Text="{Binding dob}" TextTrimming="WordEllipsis" Margin="5,0,0,0" />
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </StackPanel>
        </controls:PivotItem>

        <controls:PivotItem Header="detail">
            <StackPanel Margin="5">
                <StackPanel Orientation="Horizontal" Name="stackDetail">

                    <!--This MenuItem returns a null exception-->
                    <toolkit:ContextMenuService.ContextMenu>
                        <toolkit:ContextMenu>
                            <toolkit:MenuItem Header="copy details" Tap="MenuItem_TapCopyDetails" />
                        </toolkit:ContextMenu>
                    </toolkit:ContextMenuService.ContextMenu>

                    <TextBlock Text="{Binding EntryDetails[0].name}" FontSize="48" />
                    <TextBlock Text="{Binding EntryDetails[0].dob}" HorizontalAlignment="Right" Margin="10,0,0,0" VerticalAlignment="Bottom" />
                </StackPanel>
                <TextBlock Text="{Binding EntryDetails[0].info}" FontSize="26.667" />

                <ListBox Height="317" HorizontalAlignment="Left" Margin="0,10,0,0" 
                         Name="listBoxExamples" VerticalAlignment="Top" Width="434"
                         ItemsSource="{Binding Path=NotableQuotes}">
                    <TextBlock Text="Examples sentences" Margin="0,5,0,0"/>
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Margin="5,0,0,0">

                                <!--These MenuItems work properly-->
                                <toolkit:ContextMenuService.ContextMenu>
                                    <toolkit:ContextMenu>
                                        <toolkit:MenuItem Header="copy quote" Tap="MenuItem_TapCopyQuote" />
                                        <toolkit:MenuItem Header="bookmark quote" Tap="MenuItem_Tap_BookmarkQuote" />
                                    </toolkit:ContextMenu>
                                </toolkit:ContextMenuService.ContextMenu>

                                <TextBlock Text="{Binding quote}" FontSize="22" TextWrapping="Wrap" Margin="0,15,0,0" />
                                <TextBlock Text="{Binding date}" TextWrapping="Wrap" Margin="10,0,0,0" />
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </StackPanel>
        </controls:PivotItem>
    </controls:Pivot>
</Grid> 
```

如何将`entries`我的 ObservableCollection 作为 DataContext 分配给 ContextMenu？

编辑：

```
//View Model
namespace AppDatabase.ViewModel
{
    public class AppViewModel : INotifyPropertyChanged
    {
        //LINQ to SQL datacontext for the database.
        private TheDataContext appDB;

        public AppViewModel(string dbConnectionString)
        {
            appDB = new TheDataContext(dbConnectionString);
        }

        private ObservableCollection<entries> _searchPeopleResults;
        public ObservableCollection<entries> SearchPeopleResults
        {
            get { return _searchPeopleResults; }
            set { _searchPeopleResults = value; }
        }

        private ObservableCollection<entries> _entryDetals;
        public ObservableCollection<entries> EntryDetails
        {
            get { return _entryDetals; }
            set { _entryDetals = value; }
        }

        private ObservableCollection<quotes> _notableQuotes;
        public ObservableCollection<quotes> NotableQuotes
        {
            get { return _notableQuotes; }
            set { _notableQuotes = value; }
        }

        //...

        //Query the database and load collections used by the pivot pages
        public void LoadEntryDetails(int entryID)
        {
            var details = from entries entry in appDB.Entries
                          where entry.id.Equals(entryID)
                          select entry;

            _entryDetals = new ObservableCollection<entries>(details);
            NotifyPropertyChanged("EntryDetails");
        }

        //...
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T07:57:03.183

将第三行与原始行进行比较。这个有效。

```
<controls:PivotItem Header="detail">
    <StackPanel Margin="5">
        <StackPanel Orientation="Horizontal" Name="stackDetail" DataContext="{Binding Path=EntryDetails[0]}"> 
```

# svn - 将我的 Eclipse 项目链接到 SVN

> ID：10378317
> 
> 赞同：0
> 
> 时间：2012-04-30T03:57:50.263
> 
> 标签：svn

我在 Eclipse 中有一个项目，它在 SVN 上，但现在它没有连接到 SVN，我试图通过转到我的项目 -> 团队 -> 共享项目再次在 svn 上更新它

在那里我已经可以看到这个项目的 SVN 元数据文件夹，如果我想继续，我必须勾选“继续并让 subclipse 为你删除这些文件夹”的选项

我很困惑，我应该继续删除这些文件夹，还是有更好的方法将我的项目连接到 SVN。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T04:14:09.670

如果您在谈论元数据文件夹（复数），也许您的 SVN 客户端已升级到 1.7？版本 1.7 的客户端要求您升级工作副本，它会在顶层生成一个元数据文件夹。

请参阅： [http](http://subversion.apache.org/docs/release-notes/1.7.html) ://subversion.apache.org/docs/release-notes/1.7.html 也可能有帮助： [http ://tortoisesvn.net/tsvn_1.7_releasenotes.html](http://tortoisesvn.net/tsvn_1.7_releasenotes.html)

您始终可以对已签出的目录和实验进行备份。

# android - Android在webview中显示facebook墙？

> ID：10378318
> 
> 赞同：0
> 
> 时间：2012-04-30T03:58:01.713
> 
> 标签：android, facebook, sdk

在我的应用程序中，我有一个 webview，它使用这个 url 加载 facebook 页面：

```
http://touch.facebook.com/#/profile.php?id= 
```

稍后我用 facebook 对象获取用户 ID，并将 ID 与 url 连接起来，这样我就可以在我的 webview 中加载用户的墙，这在几天前可以正常工作，但由于某种原因不再工作，id连接到 url，但 webview 只加载一个 facebook 登录表单。我检查了正在加载的 url，是这样的：

```
https://touch.facebook.com/?_rdr 
```

所以，我想知道这里到底发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T05:33:15.350

在此链接中连接您的用户 ID，然后重试。

*rdr#!/ profile.php* ?_user="> http://m.facebook.com/?rdr#!/profile.php?_user=

# javascript - 在 li 内缩放背景图像

> ID：10378320
> 
> 赞同：0
> 
> 时间：2012-04-30T03:58:02.937
> 
> 标签：javascript, css, background

我有一个在网站上运行的基本滑块。

我有非常高分辨率的图像，所以我可以将图像缩放几百像素。有什么想法可以将背景图像缩放到某个点吗？图片目前为每张幻灯片 1000 像素，想将背景宽度缩放到 1300 像素……如果浏览器那么宽……

对 CSS 或 js 开放，如果能兼容 ie7+ 并在其他浏览器上运行，那就太好了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T08:02:46.713

试试这个：

```
-o-background-size: width height;         
-webkit-background-size: width height;   
-khtml-background-size: width height;    
-moz-background-size: width height;     
background-size: width height; 
```

演示：http: [//jsfiddle.net/tfazD/](http://jsfiddle.net/tfazD/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T08:03:38.547

除了最佳实践（图像应该只与显示的一样大）之外，您可以只使用 CSS 属性[`background-size`](http://www.w3schools.com/cssref/css3_pr_background-size.asp)，遗憾的是这还没有完全支持，所以您必须放弃对糟糕 IE 的支持。

使用 JS，您可以检查`window.innerWidth`（`document.documentElement.clientWidth`对于 IE）并应用`background-size`-property 如果它适合视口（CSS 方式将是[media-queries](http://css-tricks.com/css-media-queries/)）。对于 IE，您必须隐藏背景图像并使用其专有`filter`的`sizingMethod='scale'`声明。

或者，您可以通过 JS 注入标签（如果浏览器不支持 background-size 属性（要检测到这一点，您可以使用[modernizr](http://modernizr.com/)）并对其应用 a `z-index:-9999;`，因此它会留在后台。

使用 JS，您还可以建立某种有条件的延迟加载技术，根据用户的视口大小（移动用户不需要 1300²px）加载不同大小的图像 - 放弃对 IE8 的支持，您还可以使用提到的 CSS 媒体查询上面加载不同的背景图像（或使用类似[response.js](https://github.com/scottjehl/Respond)来模拟 IE 的媒体查询）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T08:19:31.983

从背景中删除它并将图像定位为绝对

```
selectior-name-if-any img{
 width:100%;
 height:auto; 
```

}

也应该在 IE7 中工作。

# django - Heroku 中的 Django 应用程序

> ID：10378321
> 
> 赞同：0
> 
> 时间：2012-04-30T03:58:20.813
> 
> 标签：django, apache, heroku

谁能知道如何在社交网站中使用这些技术？。我曾经介绍过一个社交网站，知道他们已经使用了这些技术。如果你能准备一个流程和使用它的主要目的。这对我有帮助.我计划使用的技术如下所示提前致谢。

*   蟒蛇 2.7。
*   Django 1.3.1。

*   Apache 作为网络服务器。

*   RabbitMQ 作为消息队列。

*   Nginx 作为邮件代理服务器。

*   用于云中负载平衡的 HAProxy。
*   MySQL 5.1 作为数据库系统（Xeround）。

*   Heroku Paas 作为云服务。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T04:18:14.137

我认为你正在倒退这个过程。虽然在开始时大致了解要用于应用程序的技术很有用，但实际上您需要做的是设计应用程序以适应您的需求和预期的用例，并选择合适的技术来匹配。出于这个原因，当您需要选择适合目的的技术时，请某人解释技术的目的没有多大意义。

我无法评论这些技术是否适合您的应用程序，因为“社交网站”描述了一个巨大的可能应用程序领域。你需要一个非常具体的想法，然后才能有人给你建议你想怎么做。

一般来说，Heroku 是适用于各种 Web 应用程序的良好平台，但其中一些选择对 Heroku 没有意义。例如，在这种情况下，将 Apache 用作连接到 Django 的 Web 服务器是没有意义的。Cedar，Heroku 的新技术堆栈（也是唯一支持 Django 的 Heroku 堆栈）将与[gunicorn](http://gunicorn.org/)一起工作得更好。如果您修改 Heroku buildpack 来设置它，Apache plus 例如 mod_wsgi 不可能工作，没有技术原因，但这不是正确的选择。

Heroku 有关于如何使用 Cedar 设置 Django 的[非常明确的文档。](https://devcenter.heroku.com/articles/django)本文档假定您使用的是 Postgres 而不是 MySQL，这实际上通常是个好主意，但您可以轻松地将其配置为使用您喜欢的任何 MySQL 服务。Heroku 附加组件包括价格实惠的 MySQL 软件包。

对于电子邮件，请务必使用[Heroku 附加组件](https://addons.heroku.com/)。不要尝试在 Heroku 堆栈上部署您自己的邮件服务器（虽然这在技术上可能是可行的，但再次通过修补构建包，这不是 Heroku 的重点）。

负载平衡由 Heroku 自动完成。如果 Heroku 的负载平衡因任何原因而不足，我建议您直接联系支持人员，因为当我与他们互动时，他们总是对解决他们服务中任何正确识别的缺陷表现出兴趣。

RabbitMQ 是作为 Heroku 的附加组件提供的，所以如果您确定您的应用程序需要此服务，您应该没有问题。

# iphone - 为什么在 loadView 中设置 frame origin 没有效果？

> ID：10378326
> 
> 赞同：0
> 
> 时间：2012-04-30T04:00:00.647
> 
> 标签：iphone, objective-c, ios

我正在尝试在没有 NIB 的情况下设置我的主视图，所以我使用的是 loadView 方法：

**没有效果：**

```
-(void)loadView {
    self.view.frame = CGRectMake(100, 0, 320, 480);
} 
```

**没有效果：**

```
-(void)viewDidLoad {
    self.view.frame = CGRectMake(100, 0, 320, 480);
} 
```

**这有效：**

```
-(void)viewDidAppear { //or viewWillAppear
    self.view.frame = CGRectMake(100, 0, 320, 480);
} 
```

（所有方法都调用它们各自的`super`方法，我只是没有把它放在那里）

谁能解释为什么会发生这种情况，以及是否有办法在没有`viewDidAppear`or的情况下调整视图`viewWillAppear`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T04:20:01.610

```
-(void)loadView
{
    UIView *contentView = [[UIView alloc] initWithFrame:CGRectMake(100, 0, 320, 480)]];

    self.view = contentView;
    [self.view setBackgroundColor:[UIColor greenColor]];
    [contentView release];
} 
```

[更多请访问这里](http://code-dojo.blogspot.in/2009/11/build-iphone-application-without.html)

希望对你有帮助...

# css - 使用负边距时浮动重叠

> ID：10378328
> 
> 赞同：3
> 
> 时间：2012-04-30T04:00:18.540
> 
> 标签：css, css-float, margin, overlap

这是标记：

```
<div>
    <a href="google.com">my link</a>
    <span>Testing content.</span> 
</div> 
```

和CSS：

```
div > * {
    float: left;
    margin-top: -50px;
}

div{

    margin-top:200px;
} 
```

注意：这里的 div 只是为了演示将所有内容放回原处以便我们看到它的目的。

如果我对 margin-top 使用正值，例如`50px`bot`a`和`span`被下推 50 像素并且不会相互重叠。

如果我对 margin-top 使用负值，比如说`-50px`，两者都被拉高了 50px，但它们也相互重叠。

为什么会发生这种情况，我该如何预防？

编辑，更多信息：

*   不幸的是，我不能将`a`or`span`放在包装器中。
*   我需要保留浮动，因为我需要重新组织流程。
*   `a`我需要向上推`span`。

还有一个小提琴：http: [//jsfiddle.net/xsSVX/](http://jsfiddle.net/xsSVX/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T04:52:47.713

添加

```
div > * {
    float: left;
    margin-top: -50px;
    padding-bottom: 40px;
} 
```

给 div 一些额外的身体..

[http://jsfiddle.net/xsSVX/6/](http://jsfiddle.net/xsSVX/6/)

# iphone - coredata中使用的undoManager

> ID：10378332
> 
> 赞同：2
> 
> 时间：2012-04-30T04:00:56.090
> 
> 标签：iphone, ios, core-data, undo

我有两个实体 A 和 B。A 与 B 具有一对多关系。在更改 B 中的某些属性后，如何撤消 B 中的所有更改？我尝试过回滚方法，但这会影响 A 中的其他属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T11:28:08.370

尝试`disableUndoRegistration`在对 A 进行任何更改之前调用 undoManager，并在对 A`enableUndoRegistration`进行任何更改之后调用。

现在，把这段代码放在哪里？理想情况下，您会为您的 A 类覆盖 NSManagedObject 中的一些方法，但是哪些方法？我认为这些`validate`方法行不通，至少不能用于禁用撤消注册，因为我认为更改可能已经在 undoManager 被调用时注册了。使用起来很诱人`will/didChangeValueForKey:`——但是类引用说“你不能重写这个方法”。

所以我认为你在任何可能影响 A 的界面操作中都无法解决这个问题。

* * *

编辑——这是您要求的示例：

```
- (IBAction) someAction:(id)sender {
    BOOL isA = NO;
    NSManagedObjectContext currentContext = nil;
    if ([[sender objectControlledBySender] isKindOfClass:[subclassedManagedObjectA class]]) {
        isA = YES;
        currentContext = // get a ref to your current context, or just make it an unretained property of this controller's class
        [currentContext.undoManager disableUndoRegistration];
    }
    // Make the changes to the object accessed via sender.
    if (isA)
        [currentContext.undoManager enbleUndoRegistration];
} 
```

“objectControlledBySender”必然是模糊的，因为`sender`可以通过任何类型的控件，使用任何类型的访问器访问它显示或编辑或选择的对象。

# javascript - 对象内部的函数

> ID：10378341
> 
> 赞同：35
> 
> 时间：2012-04-30T04:02:13.393
> 
> 标签：javascript, object

我知道标题很模糊，但我不知道该写什么。
在 javascript 中，我知道如何编写这样调用的函数：

```
argument1.function(argument2); 
```

这是小提琴演示： http: [//jsfiddle.net/rFXhf/](http://jsfiddle.net/rFXhf/)
现在我想知道我是否可以这样做：

```
argument1.argument2.function(argument3);//And even more! 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2018-02-06T14:56:30.433

## 现代 ES6 方法

在对象内部定义函数时不再需要指定`function`关键字。

具有命名函数的第一个选项：

```
const myObj = {
  myMethod(params) {
    // ...do something here
  },
  myOtherMethod(params) {
    // ...do something here
  },
  nestedObj: {
    myNestedMethod(params) {
      // ...do something here
    }
  }
}; 
```

使用匿名函数的第二个选项：

```
const myObj = {
  myMethod: (params) => {
    // ...do something here
  },
  myOtherMethod: (params) => {
    // ...do something here
  },
  nestedObj: {
    myNestedMethod: (params) => {
      // ...do something here
    }
  }
}; 
```

前 ES6 风格：

```
const myObj = {
  myMethod: function myMethod(params) {
    // ...do something here
  },
  myOtherMethod: function myOtherMethod(params) {
    // ...do something here
  },
  nestedObj: {
    myNestedMethod: function myNestedMethod(params) {
      // ...do something here
    }
  }
}; 
```

注意：在第一个示例中，函数被命名并具有自己的 this-context。在第二个示例中，使用了函数外部的 this-context。在第三个示例中，函数没有命名，但有自己的 this-context。

因此，尽管所有方法看起来都相似，但它们还是有些不同。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-04-30T04:08:31.200

您需要像这样定义对象：

```
var argument1 = {
    myvar : "12",
    mymethod : function(test) { return something; }
} 
```

然后像这样调用mymethod：

```
argument1.mymethod(parameter); 
```

或更深的版本：

```
var argument1 = {
    argument2 : {
       mymethod : function(test) { return something; }
    }
} 
```

然后：

```
argument1.argument2.mymethod(parameter); 
```

# php - 无法通过 NSURLRequest 正确发布 NSData

> ID：10378343
> 
> 赞同：1
> 
> 时间：2012-04-30T04:02:56.090
> 
> 标签：php, objective-c, ios, xcode, nsurlrequest

我正在创建一个需要访问在线食谱数据库的食谱应用程序。

目前，我无法在另一端接收数据。但是，我已经验证了 NSURLRequest 是否登陆了正确的页面。

这是请求代码：

***_* __ *_* __.m 文件**

```
NSURL *URL = [NSURL URLWithString:@"http://localhost/"];
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
request = [NSMutableURLRequest requestWithURL:URL
                                         cachePolicy:NSURLRequestUseProtocolCachePolicy
                                     timeoutInterval:60.0];

[request setHTTPMethod:@"POST"];

NSURLConnection *connection= [[NSURLConnection alloc] initWithRequest:request delegate:self];

// store recipe
NSString *path = [[NSBundle mainBundle] pathForResource:@"Recipes" ofType:@"plist"];
NSMutableDictionary *dictionaryOfRecipes = [[NSMutableDictionary alloc] initWithContentsOfFile:path];
NSMutableArray *arrayOfRecipes = [dictionaryOfRecipes objectForKey:@"recipesArray"];
NSData *data = [[NSData alloc] init];
data = [arrayOfRecipes objectAtIndex:self.thisRecipeIndex];

// post data
[request setHTTPBody:data];

[connection start]; 
```

**打印出正在发送的数据** `(NSData *) $2 = 0x09071f40 { ingredients = ( "penne pasta", water ); instructions = ( "put the penne in the water", boil ); recipeName = Penne; }`

***_* ____.php 文件**

```
<?php
// initialize connection to database
$db = mysql_connect('localhost', 'xxxxxxx', 'xxxxxxx');
$db_name = "project3";
mysql_select_db($db_name, $db);

// store incoming data as php variables
error_log(print_r($_POST, true));
$recipeName = $_POST['recipeName'];

// create mysql query
$query = "INSERT INTO recipeNamesTable (recipeName) VALUES '$recipeName'";
mysql_query($query);

mysql_close($db);
?> 
```

我对可能存在的潜在问题有一些猜测，但不确定我是否正确。虽然`[arrayOfRecipes objectAtIndex:self.thisRecipeIndex]`是`NSDictionary`，但我将其存储为`NSData`，尽管这不会返回任何错误，所以我保持这种方式。我是否需要将其存储为原样`NSDictionary`然后将其转换为`NSData`？如果这不是问题，我很想得到一些关于上面还有什么问题的反馈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T05:05:18.140

正如您似乎已经猜到的那样，这两行：

```
NSData *data = [[NSData alloc] init];
data = [arrayOfRecipes objectAtIndex:self.thisRecipeIndex]; 
```

不要按照你的想法去做。第一行分配一个新的空`NSData`对象并将指向该对象的指针存储在`data`变量中。第二行`NSDictionary`从数组中检索 an 并将指向它的指针放入`data`变量中。您现在已经失去了曾经指向的空`NSData`对象的踪迹。`data`此外，您将错误类型的指针存储到`data`变量中。该变量应该保存指向 an 的指针，`NSData`但您已将指向 an 的指针`NSDictionary`放入其中。编译器没有抱怨，因为`-[NSArray objectAtIndex:]`返回的`id`是一个完全通用的对象指针。编译器无法知道实际检索到的对象类型。

所以，是的，您需要决定一种通信协议和一种数据交换格式，用于将字典中的信息传送到服务器。然后您需要将字典转换为该格式并发送结果数据。你可能会调查`NSJSONSerialization`.

# api - 在使用 Google 地图 API 时需要帮助

> ID：10378347
> 
> 赞同：0
> 
> 时间：2012-04-30T04:03:29.703
> 
> 标签：api, google-maps

我一直在试图弄清楚如何对我的页面进行编码，以便在我的表单中输入答案时，它会通过谷歌地图 API 搜索该答案。我似乎无法正确编码，对于我如何实现目标的任何帮助将不胜感激！谢谢。

```
<head>
        <!-- This is my first trashy online quiz! -->
            <title>Extra Quiz Information</title>
</head>
<body>
    <h1> More about your quiz results!</h1>
    <?php 
        if (isset($_COOKIE['visit_id'])){
            $visit_id = $_COOKIE['visit_id'];
            $all_variables = json_decode(file_get_contents("/var/www/html/data/$visit_id.json"), TRUE);
            //var_dump ($all_variables); 
            echo "<p>";
                echo "Our results show that when you took the quiz: What Environment Suits You? on "; echo $all_variables['timestamp'];
                echo ", <br>you expressed that your favorite place to be in the whole world was: "; echo $all_variables['answer1']; 
            echo "</p>";

            $google_map_stuff = json_decode(file_get_contents echo <a href="http://maps.googleapis.com/maps/api/geocode/json?address=', urlencode($all_variables['answer1'])">, TRUE);
            echo $google_map_stuff["results"][0]["types"][0];
            //var_dump($google_map_stuff);
        } else {
            echo "You have not yet taken the quiz titled: What Environment Suits You?<br>
            Please "; echo '<a href="roate1-form.html">take it now</a>'; echo " and then return to this page after you have finished.";
        }

                ?>

</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T04:10:30.377

你有错误信息吗？你真的不应该像现在这样调用 API。如果你想使用 Web 服务 API，你应该从你的服务器上做。否则，如果您想使用 Javascript，请查看[Google Maps Javascript API 参考（我将您直接链接到地理编码器参考](https://developers.google.com/maps/documentation/javascript/reference#Geocoder).

我不会对我的代码感到厌烦，而是为您提供指向[Google 代码示例页面的直接链接。](https://developers.google.com/maps/documentation/javascript/examples/)

# windows - 在 VB.NET 中制作二维动态数组

> ID：10378353
> 
> 赞同：1
> 
> 时间：2012-04-30T04:04:28.053
> 
> 标签：windows, vb.net, arrays, arraylist

我如何在 VB.NET 中创建一个无限范围的数组并获得包含的变量数量？

我试过了：

```
Dim _items(,) As String
_items(0, 0) = "hy"
        _items(0, 1) = "hello"
        _items(1, 0) = "bye"
        _items(1, 1) = "bye2"

        MsgBox(_items.GetLength(1)) 'But i cant get the length 
```

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T06:15:37.427

我认为你的语法是错误的

```
Dim n As Integer = 2
Dim str As String(,) = New String(n - 1, n - 1) {}

 MsgBox(_items.GetLength(1)) //if n is 3 then this will return 3

    Dim n,m As Integer 
     n=3,m=2
    Dim str As String(,) = New String(n - 1, m - 1) {}

 MsgBox(_items.GetLength(1)) //  return 2
 MsgBox(_items.GetLength(1)) //  return 3 
```

# oracle - 编写oracle存储过程生成唯一序列号？

> ID：10378354
> 
> 赞同：2
> 
> 时间：2012-04-30T04:04:35.450
> 
> 标签：oracle, stored-procedures, generator, serial-number

我需要在我们的 Web 应用程序中生成一个唯一的序列号。

我创建了一个名为 SerialNumber 的表，它只有一行。一开始，它的值会像 '0000000000' 十倍于零。每次需要生成序列号时，这将加一。

例如 0000000001、0000000002 等等。

我将列数据类型保留为整数，它将值存储为 0、1、2 等，而不是 0000000001。我希望序列号只有十位数字，并在开头附加零。

请帮我为此编写存储过程。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-30T04:19:37.187

```
select to_char(<column-value>, 'FM0000000000') from serialNumber; 
```

我不知道您的要求*背后*是什么，但很可能，您最好使用[sequence](http://docs.oracle.com/cd/E11882_01/server.112/e25789/schemaob.htm#CNCPT611)。使用表生成唯一 ID 通常是一个糟糕的选择，应该进行审查。

至于存储过程和*序列*，构建的基本框架可能是：

### 序列：

```
create sequence serial_number_seq; 
```

### 存储过程（实际上是一个函数）

```
create or replace function next_serial_number return varchar2 as

       serial_number_ number;
       MAX_SR_NO number;
begin

       select serial_number_seq.nextval into serial_number_ from DUAL;

       Select MAX(sr_no) INTO MAX_SR_NO from serialNumber;

       serial_number_ := GREATEST(serial_number_, MAX_SR_NO); 

       return to_char(serial_number_, 'FM0000000000');

end    next_serial_number;
/ 
```

### 测试

```
begin
  dbms_output.put_line(next_serial_number);
  dbms_output.put_line(next_serial_number);
  dbms_output.put_line(next_serial_number);
  dbms_output.put_line(next_serial_number);
  dbms_output.put_line(next_serial_number);
  dbms_output.put_line(next_serial_number);
-- in the place where you use the serial number the greatest 
--  of inserted value from external system or sequence value will be used
 final_value:= next_serial_number;
end;
/ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T04:18:00.450

请用

```
lpad(serial_no, 10, '0'); 
```

更多信息在

[http://www.techonthenet.com/oracle/functions/lpad.php](http://www.techonthenet.com/oracle/functions/lpad.php)

并且在oracle中使用序列而不是存储在表中也更好

[http://www.techonthenet.com/oracle/sequences.php](http://www.techonthenet.com/oracle/sequences.php)

# .net - 无法研究 FreeText（报告）应用程序

> ID：10378359
> 
> 赞同：1
> 
> 时间：2012-04-30T04:05:41.217
> 
> 标签：.net, formatting, freetext

我正在编写一个将格式化自由文本的类库。我收到的自由文本不是完全随机的，有基本模式的类别和带有标准（例如季节、国家）的附加元数据，以帮助产生预期的输出。

这是自由文本输入和格式化输出文本的示例：

![在此处输入图像描述](../Images/5549ebd8a885bd8f33cfa2e9df6fc2fa.png)

正如你在下面看到的，我对如何做有一些想法 - 替换关键字、删除关键字、使用元数据标准添加条件，甚至还有一些关于分隔文本块并将它们连接在一起的想法命令：

![在此处输入图像描述](../Images/6b5625cf267383e9e89dcee44875759f.png)

在我开始编写测试和编码之前，我正在做市场调查以尝试找到任何其他格式化自由文本的应用程序？

根据[https://blog.stackoverflow.com/2010/11/qa-is-hard-lets-go-shopping/](https://blog.stackoverflow.com/2010/11/qa-is-hard-lets-go-shopping/)我不是在购物或购买建议之后。我正在了解市场上任何其他格式化自由文本的产品，以确认我没有重新设计轮子，获得想法等。

即使为我提供了正确的谷歌术语来查找我会接受的自由文本格式引擎作为答案，所有结果都得出：

**全文 - SQL
文本免费 - 短信
免费文本 - 编辑器**

是否有任何自由文本格式应用程序？还是像那些根据规则微调特定内容的网站抄袭生成器相反的脚本工具？

# php - Youtube Zend Api 函数中断脚本

> ID：10378360
> 
> 赞同：0
> 
> 时间：2012-04-30T04:05:44.560
> 
> 标签：php, api, zend-framework, youtube

这是代码：

```
...
require_once 'Zend/Loader.php'; // the Zend dir must be in your include_path
Zend_Loader::loadClass('Zend_Gdata_YouTube');
Zend_Loader::loadClass('Zend_Uri_Http');
$yt = new Zend_Gdata_YouTube();
$videoEntry = $yt->getVideoEntry($id_video);
.... 
```

在这个脚本的几行中，有时（我不明白为什么这种情况只会发生几次，而不是在其他情况下，似乎是随机的） Zend_Gdata_YouTube() 或 getVideoEntry($id_video) 没有返回，脚本就死了。在脚本的文件夹中没有日志文件，所以我不明白它在运行时会发生什么。任何帮助或建议将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T09:32:02.910

我遇到了同样的问题，但上传 youtube 视频。通过在 Zend 文件中四处挖掘，我找到了脚本死去的地方。它在`Zend/Gdata/HttpAdapterStreamingSocket.php`：

```
while ($chunk !== FALSE) {
    if (! @fwrite($this->socket, $chunk)) {
        require_once 'Zend/Http/Client/Adapter/Exception.php';
        throw new Zend_Http_Client_Adapter_Exception(
            'Error writing request to server');
    }
    $chunk = $body->read(self::CHUNK_SIZE);
} 
```

通过删除`@`from `fwrite`，我得到了超出最大执行时间的错误。通过禁用循环的执行时间限制，错误不再出现：

```
$executionTime = ini_get('max_execution_time');
set_time_limit(0);
while ($chunk !== FALSE) {
    if (! fwrite($this->socket, $chunk)) {
        require_once 'Zend/Http/Client/Adapter/Exception.php';
        throw new Zend_Http_Client_Adapter_Exception(
            'Error writing request to server');
    }
    $chunk = $body->read(self::CHUNK_SIZE);
}
set_time_limit($executionTime); 
```

这可能不是您的确切问题，但请尝试在 Zend 文件中查找 @fwrite 调用并执行相同的操作，因为您的脚本可能在将块写入套接字以及抑制错误的函数时死亡。

# javascript - JS 表单验证

> ID：10378364
> 
> 赞同：0
> 
> 时间：2012-04-30T04:06:03.967
> 
> 标签：javascript, forms, validation

我有一个大型表单，需要一个函数来验证整个表单。

我的表单名称是“orderform” 我在表单末尾正确设置了所有内容，现在我只需要添加到函数中。

我需要确保输入的电子邮件地址有效，它被称为“电子邮件地址”，我需要在函数中包含什么才能发生这种情况？

另外，我有 2 个单选按钮，我需要它，这样当一个被选中时什么都不会发生，但是当另一个被选中时，它会验证另一个部分，例如其他地址。

有人可以帮忙吗？

哦，最后一件事，必须很简单，但是如何验证数字字段并确保它具有一定的长度，例如邮政编码。

感谢大家！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T04:12:29.210

您可以使用以下方式访问表单内的信息：

`document.yourformname.elementname`

要了解如何验证它们，[QuirksMode](http://www.quirksmode.org/js/forms.html)有一个非常出色的介绍，包括您需要的收音机和复选框。表单验证有点太大，无法在一篇文章中回答。;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T04:08:58.253

这是很常见的事情。你检查过任何 JS 验证插件或框架吗？他们中的大多数已经具有常见的验证模式，例如必填字段、数字、电子邮件地址等。

[jQuery Validation](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)内置了用于电子邮件地址、数字、URL 的验证器。它还允许您添加自己的验证器。

我见过一些网站，其中验证器不接受我带有“INFO”TLD 的电子邮件地址。验证电子邮件地址的正则表达式并不是那么简单。这是 jQuery Validator 的摘录：

```
/**
 * jQuery Validation Plugin 1.9.0
 *
 * http://bassistance.de/jquery-plugins/jquery-plugin-validation/
 * http://docs.jquery.com/Plugins/Validation
 *
 * Copyright (c) 2006 - 2011 JÃ¶rn Zaefferer
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
// http://docs.jquery.com/Plugins/Validation/Methods/email
    email: function(value, element) {
        // contributed by Scott Gonzalez: http://projects.scottsplayground.com/email_address_validation/
        return this.optional(element) || /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(value);
    }, 
```

# wpf - 如何避免在 xaml 中重复类似的标记？

> ID：10378365
> 
> 赞同：2
> 
> 时间：2012-04-30T04:06:31.460
> 
> 标签：wpf, xaml

在我的 xaml 文件中，我有两个相同的 DataGrid，它们绑定到不同的集合，并且具有不同的名称和不同的 Grid.Column 属性。有没有办法不重复这些数据网格的标记但有更简洁的东西？就像编程语言中的宏替换？

```
 `<DataGrid AutoGenerateColumns="False"
                CanUserAddRows="False"
                ItemsSource="{Binding View0}"
                Name="DataGrid0"
                SelectedItem="{Binding SelectedTask}"
                SelectionMode="Single"
                Grid.Column="0"
                views:DataGridProperties.RowEditEndingCommand="{Binding UpdateTaskCommand}">
      ...
      </DataGrid>
      ...
      <DataGrid AutoGenerateColumns="False"
                CanUserAddRows="False"
                ItemsSource="{Binding View1}"
                Name="DataGrid1"
                SelectedItem="{Binding SelectedTask}"
                SelectionMode="Single"
                Grid.Column="1"
                views:DataGridProperties.RowEditEndingCommand="{Binding UpdateTaskCommand}">
      ...
      </DataGrid>`

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2012-04-30T04:11:43.427

用于[`Styles`](http://msdn.microsoft.com/en-us/library/system.windows.style.aspx)相同的值，这通常会处理大多数属性，如果属性不相同，通常不需要进一步。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2012-04-30T04:13:53.063

有很多方法可以做到这一点，我认为没有一个正确的答案。这只是我的一些想法：

A）你可以有一个数据网格“生成器”，就像一个函数，并通过代码动态加载你的数据网格。

B）Uou 可以通过 xaml 动态加载您的数据网格（加载 xaml 标记）。

C）在您的 xaml 中定义了一个数据网格。然后动态地将其他数据网格添加到 ContentControl、ItemsControl、StackPanel 或其他任何东西，并从第一个数据网格复制属性。

D) 您可以创建一个 UserControl 来定义您的数据网格（即自定义 DataGrid 控件）。然后，您只需通过 Xaml 或代码添加此数据网格。 
```

# multithreading - 套接字问题

> ID：10378370
> 
> 赞同：1
> 
> 时间：2012-04-30T04:07:51.840
> 
> 标签：multithreading, performance, sockets, thread-safety, zero-copy

有几个套接字问题，找不到明确的是或否，所以如果是转发，请提前道歉：) 平台是 Linux 2.6.30，C++ 应用程序。对网络还是很陌生，要跟上速度。

1.  套接字 API 线程安全吗？例如，如果我在不使用互斥锁的情况下从多个线程进行发送，或者我必须通过使用自己的互斥锁来确保这一点？

2.  轮询/选择以检查我的发送是否会阻塞然后进行发送，而不是仅进行发送并让发送 API 内部排队处理发送是否更好？如果线程无论如何都会阻塞（如果我不使用超时，也就是说），我真的不明白为什么需要轮询然后发送。

3.  Linux中默认情况下套接字是零副本，还是涉及副本？如果有副本，是否有大小限制（不是在 API 方面，而是在粒度方面）？如果答案是内核确实进行了复制，是否存在零复制套接字？

4.  如果我必须在两台机器之间进行通信，我会假设多个套接字会比单个套接字更好地利用带宽。这是一个正确的假设吗？在两台常规 Linux 机器之间使用完整 BW 的最佳方式是什么？

5.你最喜欢测量接口当前带宽使用情况的工具是什么？这可能只是更多的偏好，我查看了 iptraf 等，但想看看其他人使用什么和最喜欢什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T04:34:24.873

1.  套接字 API 在每个套接字的基础上绝对是线程安全的……也就是说，只要任何给定的套接字仅由一个线程访问，其他线程就可以同时访问其他套接字而不会出现任何问题。让多个线程同时访问同一个套接字可能是“线程安全”的，也可能不是“线程安全的”（对于线程安全的某些定义），但无论如何都不建议这样做，因为结果行为不容易预测。（例如，两个线程大约同时在同一个套接字上调用 recv()，哪个线程将从传入的 TCP 流中获取哪些字节？只有上帝知道）

2.  如果您正在使用阻塞 I/O，那么在调用 send() 之前使用 poll/select() 检查并不是非常有用，因为即使 select() 表明您在传出缓冲区中有空间，您也可能会阻塞在 send()反正。（例如，如果缓冲区中有 32 个字节的空间，然后您尝试发送 64 个字节，则 send() 将阻塞）。select() 和 poll() 与非阻塞 I/O 结合使用更有用。

3.  我不太确定 Linux 套接字中的零拷贝状态，但[Wikipedia 文章](http://en.wikipedia.org/wiki/Zero-copy)似乎暗示 Linux 仅在使用 sendfile()、sendfile64() 或 splice() 调用时才进行零拷贝。考虑到现代 CPU，我怀疑它是否有那么重要——除了最高性能的程序之外，所有程序都将有大量 CPU 周期可用于复制网络数据；网络接口本身的速度将成为瓶颈。

4.  多个套接字不会比单个套接字为您提供更好的带宽利用率；如果您足够快地通过它泵送数据，则单个套接字很容易使网络连接饱和。特别是多个 TCP 连接通常会给您带来比单个 TCP 连接更差的带宽利用率，因为每个 TCP 连接都会产生自己的传输开销，更糟糕的是，多个 TCP 连接将争夺带宽，并在某些时候开始导致彼此丢弃数据包，他们将通过降低发送速率来响应，以减少拥塞。

5.  我无法为 Linux 回答这个问题；在 MacOS/X 活动监视器下将显示网络带宽使用情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T16:07:15.373

Jeremy 的第 3 点有些不准确。随着多个高速网络接口和大量数据的移动，零拷贝变得更加重要。在内存中复制缓冲区所花费的时间会影响吞吐量和延迟。异步 IO 和分散/聚集支持对于高速网络系统至关重要。

# node.js - 仅在 node.js 中从服务器端代码分配行为、事件和处理程序？

> ID：10378371
> 
> 赞同：0
> 
> 时间：2012-04-30T04:07:59.810
> 
> 标签：node.js

我习惯了来自 Wicket 等的 Web UI 编程模型，它允许您定义当用户在客户端触发事件时调用的服务器端行为/事件处理程序，标记中很少或没有客户端 JavaScript .

这些处理程序通过元素 id 绑定到标记（在 Wicket 的情况下为 wicket:id）。简化的代码看起来像这样：

斯卡拉：

```
add(new AjaxLink("mylink") {
   override def onClick(target: AjaxRequestTarget) {
     service.doSomething()
   }
} 
```

模板：

```
<a wicket:id="mylink">Click Me</a> 
```

呈现给客户端的 HTML：

```
<a id="mylink" onclick="some-generated-ajax-call()">Click Me</a> 
```

这种方法在 node.js 或相关库中是否可行？清楚我在问什么吗？

我见过的唯一示例集中在服务器端请求处理程序上，我留下的印象是人们需要手动编码 ajax 调用、事件处理程序等，这些调用在模板中使用 jQuery 调用这些服务器端路径， ETC。

好处是模板不需要逻辑，而且很容易重构，你可以把它交给对服务器端逻辑或调用一无所知的网页设计师。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T07:05:48.620

看起来 Meteor 没有使用绑定或 Ajax（根据视频） - 我在文档中没有看到它，但如果它正在将数据推送到客户端，它可能正在使用 websocks。

为什么不使用流星？当然，该功能可以在 NodeJS 中复制，但它已经在 Meteor 中可用。

如果你想使用 NodeJS，你可以实现这样的东西：http: [//blog.new-bamboo.co.uk/2009/12/7/real-time-online-activity-monitor-example-with-node -js 和 websocket](http://blog.new-bamboo.co.uk/2009/12/7/real-time-online-activity-monitor-example-with-node-js-and-websocket)

# entity-framework - 首先在实体框架代码中，有没有办法向导航集合添加分页？

> ID：10378375
> 
> 赞同：7
> 
> 时间：2012-04-30T04:08:25.707
> 
> 标签：entity-framework, collections, ef-code-first, paging

如果我有一个带有 BlogEntries 集合的博客实体，该集合可能有数百个条目，有没有办法首先使用 EF 代码添加任何服务器端分页功能？例如，如果我像在 DbSet 上那样执行典型的 .Skip(x).Take(y)，它会延迟加载整个集合并将其分页到内存中吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-30T07:23:30.180

如果直接查询`DbSet`，可以使用 Take 和 Skip，它确实会在数据库服务器上执行分页（这些方法调用被转换为 SQL）。所以这可以按预期工作：

```
// Loads only 10 expected entries through Linq-to-entities
var entries = context.BlogEntries.OrderBy(e => e.Date).Skip(10).Take(10); 
```

请注意，加载实体上的分页导航属性不能以这种方式工作：

```
var blog = context.Blogs.First();
// Lazy loading always loads all related entries and executes ordering and 
// paging through Linq-to-objects!
var entires = blog.BlogEntries.OrderBy(e => e.Date).Skip(10).Take(10); 
```

如果要对导航属性进行分页，则必须使用显式加载

```
var blog = context.Blogs.First();
var dbEntry = context.Entry(blog);
// This is the way to use Linq-to-entities on navigation property and 
// load only subset of related entities
var entries = dbEntry.Collection(b => b.BlogEntries)
                     .Query()
                     .OrderBy(e => e.Date)
                     .Skip(10)
                     .Take(10)
                     .Load(); 
```

# ios - 使用 UINavigationController

> ID：10378378
> 
> 赞同：0
> 
> 时间：2012-04-30T04:09:07.173
> 
> 标签：ios, uiviewcontroller, uinavigationcontroller

这是我的代码：

```
- (IBAction)play {
    if (!self.mapViewController)
    {
        self.mapViewController = [[MapViewController alloc]initWithNibName:@"MapViewController" bundle:nil];
    }
    [self.navigationController pushViewController:mapViewController animated:YES];
} 
```

发生的情况是：当我第一次按下播放按钮时，新视图没有出现。当我再次按下时，它会崩溃，因为同一个 UIViewController 已多次添加到堆栈中。有谁知道如何解决这一问题？

编辑：感谢您的所有回答。我检查了xib，发现我弄乱了链接。修复 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T04:21:27.637

在你的 -init merhod 中创建视图控制器，然后只在 -play 中推送视图控制器。确保您的视图控制器的设计使用户可以从中“退出”，从而将其从堆栈中弹出，从而不会为多次打开产生错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T04:21:46.443

`UINavigationController`会做比你想象的更多的簿记工作。您只需要创建控制器并推送它。无需维护您自己的参考。

此外，如果您命名 nib `MyView.xib`，则无需明确指定它的名称；它会在初始化时捡起它。从[`nibName`属性文档](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926-CH3-SW13)：

> 如果视图控制器类名以单词“Controller”结尾，如在 MyViewController 中，它会查找名称与类名匹配但不包含单词“Controller”的 nib 文件，如在 MyView.nib 中。

所以你的代码可以变成：

```
- (IBAction)play {
    // Implicitly loads MapViewController.xib
    UIViewController* mapViewController = [[[MapViewController alloc] init] auotrelease];
   [self.navigationController pushViewController:mapViewController animated:YES];
} 
```

只要 Map 使用`popViewController`，`UINavigationController`就会处理解除分配并确保您不会在堆栈上出现多个副本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T04:35:41.213

好的，试试下面的代码，这对我有用：如果当前的 viewcontroller 不是 uinavigation 控制器，试试这个代码：

```
- (IBAction)play {
   MapViewController *mapView = [[MapViewController alloc]initWithNibName:@"MapViewController"    bundle:nil];
   UINavigationController *navController = [[UINavigationController alloc]  initWithRootViewController:mapView];
   [self presentModalViewController:navController animated:YES];
} 
```

（或）如果 currentviewcontroller 是 uinavigation 控制器，请尝试以下代码：

```
 - (IBAction)play {
    MapViewController *mapView = [[MapViewController alloc]initWithNibName:@"MapViewController"    bundle:nil];//Note:Check the mpviewcontroller xib file name as MapViewController is correct
    [self.navigationController pushViewController:mapViewController animated:YES];
   } 
```

谢谢..！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T06:20:31.523

试试这个 -->

```
 - (IBAction)play 
{
    mapViewController = [[MapViewController alloc]initWithNibName:@"MapViewController" bundle:nil];
    [self.navigationController pushViewController:mapViewController animated:YES];
    [mapViewController release];
} 
```

# perl - perl 数组只打印最后一行

> ID：10378379
> 
> 赞同：0
> 
> 时间：2012-04-30T04:09:14.017
> 
> 标签：perl

我有一个大约 3000 行的文件。我将文档中的每个单词与我拥有的参考列表进行匹配。如果该单词与我列表中的单词匹配，那么我将其替换。现在的问题是代码只打印最后一行，而不是整个文件。

我确定我的代码效率不高，需要很长时间才能处理，无论如何可以提高代码的效率

```
open IN, "drug_list.txt" or die "No such file:$!\n";
open OUT, ">synergy1.txt" or die;
while(<IN>) {
      my @a=split /\t/,$_;
      $a[0]=~s/\s//g;
      $a[1]=~s/\s//g;
      $a[2]=~s/\s//g;
      $b[$i]=$a[0];
      $c[$i]=$a[1];
      $d[$i]=$a[2];
      ++$i;
}

use Data::Dumper;
open FILE, "input.txt" or die "No such file:$!\n";
while(<FILE>) {
    my $line= $_;
    chomp $line;
    $line =~ s/(\)|\()//g;
    $line =~ s/,/ ,/g;
    $line =~ s/\./ ./g;
    @array = split ' ',$line;

    for($k=0;$k<$i;++$k) {
        foreach $n(@array) {
            if($n=~m/^\Q$b[$k]\E$/i) {
                $n=~s/$n/<span style="background-color:yellow;">$n<\/span>/;
            }
            if($n=~m/^\Q$c[$k]\E$/i) {
                $n=~s/$n/<span style="background-color:red;">$n<\/span>/;
            }
            if($n=~m/^\Q$d[$k]\E$/i) {
                $n=~s/$n/<span style="background-color:blue;">$n<\/span>/;
            }
         }  # end foreach
     }      # end for
}           # end while
print OUT "@array";
close(FILE);
close(IN); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T05:46:17.880

> 我已经编辑了代码，现在只打印最后一行

`@array`现在您在每次通过时重新分配：

```
 while(<FILE>) 
  { 

[...]

    @array = split ' ',$line;

[...]

  }

  print OUT "@array"; 
```

When array gets printed out, it only contains the last line. The easiest solution is probably to move the `print OUT` line to *inside* the `while()` loop, right at the end. This way it will get printed out *before* it gets reassigned the contents of a new line.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T04:12:06.313

您创建两个名为 的变量`@array`。

```
my @array;
while(<IN>) 
 {
  ...
  my @array = split ' ',$line; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T04:25:44.960

另外你`close(IN)`和几行之后你尝试做`while (<IN>)`。

请提供工作代码和示例数据。否则，找出问题所在将是一项艰巨的工作。

# javascript - Jquery 是准备好的包装器

> ID：10378383
> 
> 赞同：-3
> 
> 时间：2012-04-30T04:10:16.507
> 
> 标签：javascript, jquery

是否有任何 javascript 代码包装可用于等待 Jquery 加载并在成功加载 jquery 后创建回调？

像这样的东西

```
JqueryWait(function(){
   //my magnificent jquery codes ^^
}); 
```

我想要一个像这样的代码包装......

说明：我正在使用 headjs，并且我在 headjs 的单独代码中加载了 jquery。现在我的其他脚本依赖于 jquery，这就是为什么其他脚本必须知道 jquery 是否已经加载。我知道headjs的回调函数但是我的其他脚本不能放在回调函数上

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T04:18:37.803

试试这个：

```
function JqueryWait(fn) {
    if (jQuery) fn();
    else setTimeout(function() { JqueryWait(fn); }, 100);
}

JqueryWait(function(){
   //my magnificent jquery codes ^^
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T04:12:19.407

```
$(function() {
// code jere... jquery is loaded
}); 
```

更多信息：[http ://api.jquery.com/ready/](http://api.jquery.com/ready/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T04:23:07.863

只要您在文档中将 jQuery 文件放在 javascript 文件之前（是否将两个文件放在一个`.js`文件中都没有关系），就应该在代码开始之前加载 jQuery。否则，jQuery 没有正确加载。您可以使用此后备方法检查脚本中的 jQuery：

```
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
<script type="text/javascript">
if (typeof jQuery == 'undefined') {
    document.write(unescape("%3Cscript src='/js/jquery-1.7.2.min.js' type='text/javascript'%3E%3C/script%3E"));
}
</script> 
```

通过[CSS 技巧](http://css-tricks.com/snippets/jquery/fallback-for-cdn-hosted-jquery/)

如果您希望在页面加载*后*加载 jQuery ，您有两种选择。将 jQuery 的脚本标签注入到 DOM 并等待文档加载（如上面的示例），或使用[RequireJS](http://requirejs.org/)之类的异步加载器（老实说，它做的事情几乎相同，但更适合用于许多其他目的，如依赖管理） .

注意：其他答案使用`$(function(){})`：

That method only waits for the DOM to load, it does not check for the existence of jQuery before running code.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-30T04:15:21.390

你不需要额外的功能来做到这一点。jQuery`$(document).ready(function() { });`就足够了。

```
$(function() {
    //ever code written inside here is run, after the jQuery & DOM is ready
}); 
```

Anways，还有另一种方法可以检查 jQuery 是否已加载

```
if (typeof jQuery == 'undefined') {
   //... jquery not loaded
} 
```

# mysql - MySQL OR 条件

> ID：10378386
> 
> 赞同：0
> 
> 时间：2012-04-30T04:10:32.587
> 
> 标签：mysql, sql

我正在尝试从具有语言列的表中获取记录。如果存在具有特定语言代码（例如 US ）的行，我想要这些行，但如果没有，我需要使用通配符语言代码（“*”）获取行。

这在一个查询中是否可行，而无需在查询后过滤结果？

我不认为它可以完成，但是任何可以在一个查询中以这种方式检索数据的想法都会受到赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T04:14:04.190

基本答案很简单；将 OR 语句的各个部分括在括号中。然后好好看看它是人们容易犯错误的地方之一——总是仔细检查你的括号:)

```
where (column = 'US' 
   or (column = '*' 
       and not exists (select 'x' from table where column = 'US') ) ) 
```

对不起 - 错过了这个要求，并编辑了我的答案来解决它。现在括号开始很重要......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:28:03.320

如果您的数据库服务器是 SQL Server 200X、Oracle 或 MySQL，您可以`union`单独使用省略重复行的运算符：

```
select a, b from table where column = 'US'
union 
select a, b from table where column = '*' 
```

操作员将`union`处理重复项，其中 as`union all`还将返回重复项。我也相信与 OR 相比， union 的性能要好得多。

如需进一步阅读：

SQL Server：http: [//msdn.microsoft.com/en-us/library/ms180026.aspx](http://msdn.microsoft.com/en-us/library/ms180026.aspx)

甲骨文：[http ://docs.oracle.com/cd/B12037_01/server.101/b10759/queries004.htm](http://docs.oracle.com/cd/B12037_01/server.101/b10759/queries004.htm)

MySQL：[http ://dev.mysql.com/doc/refman/5.1/en/union.html](http://dev.mysql.com/doc/refman/5.1/en/union.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:31:39.910

尝试自我加入

```
SELECT a.*, b.field as field_original FROM `table` a
LEFT JOIN `table` b ON (a.id = b.id AND b.lang = '*')
WHERE a.lang = 'US' 
```

然后在应用程序中检查字段是否存在，使用字段，否则使用 field_original（您也可以在 select 中添加 case 语句以始终仅选择其中一个值）

```
SELECT CASE a.field IS NULL THEN b.field ELSE a.field END
FROM `table` a
LEFT JOIN `table` b ON (a.id = b.id AND b.lang = '*')
WHERE a.lang = 'US' 
```

（例如，查询未尝试）

# sql-server - 自定义 xml 和 sql 服务器

> ID：10378387
> 
> 赞同：1
> 
> 时间：2012-04-30T04:11:08.893
> 
> 标签：sql-server, xml, sql-server-2008, xsd

我从 sql server 2008 创建了 xml。我当前的 xml 是使用“FOR XML AUTO”生成的

```
<Customer Name="john" City="Mumbai">
  <Project Project_Name="pqr" />
</Customer>
<Customer Name="Rocky" City="Delhi">
  <Project Project_Name="abc" />
  <Project Project_Name="lmn" />
</Customer> 
```

但我想要像这样的输出

```
<Customer >
   <name>John</name>
   <city>Mumbai</city>  
   <Projects>
      <project>
         <Project_Name>pqr</Project_Name>
      </project>
   </Projects>
</Customer>
<Customer >
   <name>Rocky</name>
   <city>Delhi</city>  
   <Projects>
      <project>
         <Project_Name>abc</Project_Name>
        <Project_Name>lmn</Project_Name>
      </project>
   </Projects>
</Customer> 
```

所以基本上我想将父元素的属性转换为子元素。并且想要额外的自定义元素。请帮我。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T04:57:06.237

You need to look at the `FOR XML PATH` option that SQL Server 2005 introduced - see the [What's New in FOR XML in Microsoft SQL Server 2005](http://msdn.microsoft.com/en-us/library/ms345137%28v=sql.90%29.aspx#forxml2k5_topic6) document for more information.

Basically, with `FOR XML PATH`, you can define the shape of your XML very easily. You can define certain structures, you can define certain columns to be output as attributes, and others as elements - totally under your control.

Not knowing your table structure, I can only guess what the tables and columns are called in your case - but you could probably write something like:

```
SELECT 
    c.ID AS '@ID',   -- define output as attribute on node
    c.Name,  -- if you don't specify anything -> output as element of the same name
    c.City,
    (SELECT
         p.Name as 'Project_Name',   -- define different XML element name for column
         p.DueDate
     FROM 
         dbo.Project p
     WHERE
         p.CustomerID = c.ID
     FOR XML PATH('Project'), TYPE
    ) AS 'Projects'
FROM
    dbo.Customer c
FOR XML PATH('Customer'), ROOT('AllCustomers') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T11:11:02.777

这是更详细的`FOR XML EXPLICIT`类型

```
CREATE TABLE #Customers (
            ID              INT
            , Name          VARCHAR(100)
            , City          VARCHAR(100)
            )
CREATE TABLE #Projects (
            ID              INT
            , Name          VARCHAR(100)
            , Customer_ID   INT
            )

INSERT      #Customers
SELECT      1, 'john', 'Mumbai' UNION ALL
SELECT      2, 'Rocky', 'Delhi' UNION ALL
SELECT      3, 'Stan', 'New York' --UNION ALL

INSERT      #Projects
SELECT      1, 'pqr', 1 UNION ALL
SELECT      2, 'abc', 2 UNION ALL
SELECT      3, 'lmn', 2

SELECT      h.Tag
            , h.Parent
            , NULL          AS [Customer!1]
            , c.Name        AS [Name!1000]
            , c.City        AS [City!2000]
            , NULL          AS [Projects!3000]
            , NULL          AS [Project!3100]
            , p.Name        AS [Project_Name!3110]
FROM        (
            SELECT      NULL, 1 UNION ALL
            SELECT          1, 1000 UNION ALL
            SELECT          1, 2000 UNION ALL
            SELECT          1, 3000 UNION ALL
            SELECT              3000, 3100 UNION ALL
            SELECT                  3100, 3110 --UNION ALL
            ) h(Parent, Tag)
LEFT JOIN   (
            SELECT      1                   AS FirstTag
                        , 3000              AS LastTag
                        , c.*
            FROM        #Customers c
            ) c
ON          h.Tag BETWEEN c.FirstTag AND c.LastTag
LEFT JOIN   (
            SELECT      3100                AS FirstTag
                        , 3110              AS LastTag
                        , c.Name            AS CustomerName
                        , p.Name
            FROM        #Customers c
            JOIN        #Projects p
            ON          c.ID = p.Customer_ID
            ) p
ON          h.Tag BETWEEN p.FirstTag AND p.LastTag
ORDER BY    COALESCE(p.CustomerName, c.Name), p.Name, h.Tag
FOR XML EXPLICIT

DROP TABLE #Customers, #Projects 
```

产生这个

```
<Customer>
  <Name>john</Name>
  <City>Mumbai</City>
  <Projects>
    <Project>
      <Project_Name>pqr</Project_Name>
    </Project>
  </Projects>
</Customer>
<Customer>
  <Name>Rocky</Name>
  <City>Delhi</City>
  <Projects>
    <Project>
      <Project_Name>abc</Project_Name>
    </Project>
    <Project>
      <Project_Name>lmn</Project_Name>
    </Project>
  </Projects>
</Customer>
<Customer>
  <Name>Stan</Name>
  <City>New York</City>
  <Projects />
</Customer> 
```

请注意，这与您的原始请求不同：下面`Projects`有单独`Project`的 s 包装项目名称。这也适用于 sql2000。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T05:22:59.737

我已经根据您的 Xml 重建了行集，并使用 FOR XML PATH 您可以根据需要构建您的 Xml（为 marc_s 投票）：

```
DECLARE @x XML = '
<Customer Name="john" City="Mumbai">
  <Project Project_Name="pqr" />
</Customer>
<Customer Name="Rocky" City="Delhi">
  <Project Project_Name="abc" />
  <Project Project_Name="lmn" />
</Customer>
'

SELECT 
    c.Name AS 'name'
    , c.City AS 'city'
    , (SELECT
        p.Project_Name AS 'Project_Name'
    FROM (
    SELECT c.value('../@Name', 'VARCHAR(50)') AS CustomerName
    , c.value('./@Project_Name', 'VARCHAR(50)') AS Project_Name
    FROM @x.nodes('//Project') AS t(c)
    ) p WHERE c.Name = p.CustomerName 
    FOR XML PATH('project'), TYPE) AS 'Projects'
FROM 
(
SELECT c.value('./@Name', 'VARCHAR(50)') AS Name
    , c.value('./@City', 'VARCHAR(50)') AS City
FROM @x.nodes('//Customer') AS t(c)
) c
FOR XML PATH('Customer') 
```

# tridion - 是否可以在 SDL Tridion 2011 SP1 中创建数据库表

> ID：10378388
> 
> 赞同：1
> 
> 时间：2012-04-30T04:11:09.940
> 
> 标签：tridion

我只是想知道，是否可以在 SDL Tridion 2011 SP1 中创建数据库表并从事件处理程序访问它。

> 要求：我想利用在事件处理程序中创建的数据库表来自动为每个创建的组件创建页面。
> 
> 数据库表将包含有关每个模式的页面模板和组件模板的信息。

每当创建组件时，都会触发偶数处理程序。它应该从给定模式的数据库中获取组件模板、页面模板并自动创建一个页面。我想在 Tridion 中创建这个数据库。我只是想知道是否可以在 Tridion 中创建这样的数据库。是否有可能以更好的方式实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T04:26:17.780

这个要求对我来说没有任何意义，但也许我对你想要实现的目标的信息太少了。

因此，严格回答您的问题：在事件处理程序中，您可以做任何您想做的事情，因为您处于完整的 .NET 编程上下文中。如果你想要`create`一个数据库，那是可能的。

**注意：**如果您想在事件系统中自动创建页面，您可以在不创建任何其他数据库或表的情况下执行此操作。同样，我需要更多关于你到底想要完成什么的信息。

**编辑 1：** 我建议不要在 Tridion CM 数据库中创建任何额外的表，这仅仅是为了将事物分开 - Tridion 应该保留 Tridion 并且您创建自定义的任何内容都应该在不同的数据库或命名空间中。当您升级您的 CM 时，您会很高兴您这样做了。

我还建议将自动页面创建所需的参数（例如组件模板、页面模板）存储在数据库表之外。想想文件夹元数据、配置文件等。将其存储在数据库表中本身还不错，但有点过头了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T04:51:33.040

如果您询问是否可以在与 SDL Tridion CM 数据库相同的数据库服务器上创建其他数据库，答案是肯定的。如果这不是你的意思，我不知道你在 Tridion 中创建数据库是什么意思，所以请澄清一下。

另外，使用文件夹上的元数据来解决您的挑战更为常见。这为您带来的好处是您的数据位于一个数据存储中，并且可以在环境之间进行内容移植。

# r - 在向量中查找多个最大值的索引

> ID：10378390
> 
> 赞同：19
> 
> 时间：2012-04-30T04:11:13.973
> 
> 标签：r

`which.max`确定位置，即数字向量的（第一个）最小值或最大值的索引。如果向量有多个最大值，我怎样才能检索所有这些？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-04-30T04:25:10.723

你可以这样做`which( myVector == max(myVector) )`，基本上就是这样`which.max`（除了`which.max`在第一次出现时停止并且更有效地实现）。

# c# - 如何在 Crystal Report 中手动添加 IField 对象（无需向导干预）

> ID：10378399
> 
> 赞同：2
> 
> 时间：2012-04-30T04:12:27.030
> 
> 标签：c#, .net, web-services, crystal-reports, reporting

我需要有关创建水晶报表的帮助。是的，我可以通过 Visual Studio 2008 使用向导制作水晶报表，但这不是我的目标，因为我正在尝试实现一个报表应用程序，该应用程序在未来不需要在数据库连接方面进行配置。向导所做的是，它通过向导请求数据源，如果我要更改数据库，我将再次访问代码以更新数据源。我只希望数据源位于配置文件中，然后我会调用它。

这是我现在的代码，但它似乎不起作用。我需要手动添加 Ifield 对象，而不使用水晶报表的见鬼向导。我已经尝试用谷歌搜索了几天，但没有确切的答案可以解决我的问题，有人可以帮助我吗？谢谢！

```
string connectionString = ConfigurationManager.AppSettings["ConnectionString"].ToString();
        ServiceReference.WebServiceSoapClient service = new ServiceReference.WebServiceSoapClient();

        public Form1()
        {
            InitializeComponent();
            lblString.Text = connectionString;
        }

        private void button1_Click(object sender, EventArgs e)
        {
            DataSet ds = new DataSet();
            ds = (service.getAllUsers());

            dataGridView1.DataSource = ds.Tables[0];

            CrystalReport1 reportCR = new CrystalReport1();
            reportCR.SetDataSource(ds.Tables[0]);

         // crystalReportViewer1.ReportSource = reportCR;

          //crystalReportViewer1.RefreshReport();

        } 
```

# c - 指针赋值二维数组指针的警告信息

> ID：10378402
> 
> 赞同：2
> 
> 时间：2012-04-30T04:12:52.590
> 
> 标签：c, arrays, pointers, types

我编写了一个程序来在运行时读取数组元素，然后它会根据一些配置更改列。

我从 GCC cygwin 编译器收到以下警告消息：

```
pointer.c:73: error: incompatible types in assignment 
```

考虑到下面的代码，我怎样才能删除这个警告？

预先感谢您的帮助

```
typedef struct INPUT_ST
{
    float a;
    float b;
    float c;
}INPUT;
const INPUT lookup[3][3];
main()
{
    INPUT *ptr;
    /*typedef INPUT (st[3][3]);*/
    INPUT (*ptr1)[3][3];
    int i, j;
    ptr = (INPUT *)&lookup;
    (*ptr1)[3][3] = &lookup[0][0];

    for(i=0; i<3; i++)
    {
        for(j=0; j<3; j++)
        {
            printf("Row %d and column %d:\n", i, j);
            printf("%f\n", (*ptr1)[i][j].a);
            printf("%f\n", (*ptr1)[i][j].b);
            printf("%f\n\n", (*ptr1)[i][j].c);
        }
        printf("\n");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T22:49:42.897

导致错误的行如下：

```
(*ptr1)[3][3] = &lookup[0][0]; 
```

原因是赋值的左侧和右侧具有不兼容的类型。

`ptr1`左边是类型`INPUT (*)[3][3]`（指向 3x3 数组的指针`INPUT`）。`(*ptr1)[3][3]`是类型`INPUT`（取消引用（未初始化）指针，然后访问（越界）元素`[3][3]`）。`lookup`右边是类型`const INPUT [3][3]`（3x3 数组`const INPUT`）。这使得`&lookup[0][0]`它成为类型`const INPUT *`（元素的地址`[0][0]`）。所以类型是冲突的：`INPUT`vs. `const INPUT *`.

你真正想做的是让`ptr1`指针指向数组`lookup`。所以需要`const`在指针声明中添加，然后初始化如下：

```
const INPUT (*ptr1)[3][3];
// ...
ptr1 = &lookup; 
```

您使用的部分解决方案`ptr`不起作用，因为它是常规指针（单维），因此您无法访问`ptr[i][j]`，这意味着取消引用`INPUT`不是指针（但您*可以*访问`ptr[i*3+j]`而不是`ptr[i][j]`）。`const`顺便说一句，而不是像你为你所做的那样抛弃你，`ptr`你应该真正声明`ptr`为`const INPUT *ptr;`.

# objective-c - 如何防止 UIScrollView 拦截它自己的视图层次结构之外的触摸？

> ID：10378404
> 
> 赞同：1
> 
> 时间：2012-04-30T04:13:10.207
> 
> 标签：objective-c, ios

我对触摸处理的理解是，当一个视图被触摸时，如果它本身不处理触摸，它会“处理”视图层次结构的触摸，直到它们被处理，或者你在顶部并且它们被丢弃. （本质上，它是递归；它将触摸传递给它们的子视图，此时调用相同的“向上”方向函数将其向上传递）。

我处于一个奇怪的情况，一个 UIScrollView - 应该拦截并处理来自它的孩子的任何和所有触摸 - 似乎正在拦截放置在它“顶部”的 UIImageView 的触摸。删除滚动视图，触摸工作正常。问题是，有问题的 UIImageView 不是 UIScrollView 的子项；这是一个兄弟姐妹。

所以我的问题变成了双重的：首先，我如何阻止它“窃取”这些触摸，第二，它怎么会首先窃取它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T04:18:46.223

尝试`userInteractionEnabled`在 UIImageView 上设置为 YES。如果`userInteractionEnabled`设置为 NO（这应该是 UIImageView 的默认设置），那么触摸将被传递到它下面的对象 - UIScrollView。

# c# - 如何将 null 传递给 WeakReference 构造函数？

> ID：10378407
> 
> 赞同：0
> 
> 时间：2012-04-30T04:13:27.300
> 
> 标签：c#, null, weak-references

[http://msdn.microsoft.com/en-us/library/xt0a1s34(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/xt0a1s34(v=vs.100).aspx)

> 参数
> 
> 目标
> 
> 类型：System.Object
> 
> 要跟踪的对象或 null。

据我所知，这意味着“null”是 WeakReference 对象的有效参数......

我看到的问题如下：提取值时，我将检查 Target 是否不为空......如果不是 - 将其用作对象。但是如果“null”作为原始目标传递，那么weakReference 对象的属性“Target”不会给我信息：对象是否已经被垃圾回收或者它总是为null。

问题：如果“目标”为空，我怎么能理解它，因为原始对象也是空的？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T03:11:53.630

看起来应该使用特殊对象（这意味着“没有数据”）而不是“null”（与[Ca​​n null 是否插入缓存中的答案相同/相似？](https://stackoverflow.com/questions/10378161/can-null-be-inserted-into-cache)问题）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T04:35:54.540

您可能想尝试 IsAlive 属性。这是一个布尔值，它会告诉您指向的对象是否已被收集。

# python - Google App Engine 将嵌套值传递给模板

> ID：10378413
> 
> 赞同：1
> 
> 时间：2012-04-30T04:13:56.400
> 
> 标签：python, google-app-engine

我正在尝试使用 GAE 创建一个 Web 应用程序，数据结构由 Dockets、Projects 和 Tasks 组成。

每个案卷有多个项目，每个项目依次有多个任务。在案卷页面上，我需要显示案卷下的所有内容，因此：

*   项目1：任务a，任务b，任务c，....
*   项目2：任务a，任务c，任务c，......等等......

我设法使用以下代码将所有项目显示在列表中，但是在显示每个项目下的任务时我迷失了。作为 GAE、python 和网络应用程序的完全新手，我什至不知道要搜索的术语，而且我的搜索并没有太大帮助……也许这里有人可以提供帮助。

```
class DocketPage(BaseRequestHandler):
_OUTPUT_TYPES = {
'default': ['text/html', 'html'],
}

def get(self):
 docket = Docket.get(self.request.get('id'))
 docket_name = docket.name
 if not docket:
   self.error(403)
   return

projects_query = Project.all().ancestor(
            docket)
projects = projects_query.fetch(10)

for project in projects:
    tasks_query = Task.all().ancestor(project)
    tasks = tasks_query.fetch(10) 

# Choose a template based on the output type
output_name = self.request.get('output')
output_name_list = DocketPage._OUTPUT_TYPES.keys()
if output_name not in output_name_list:
  output_name = output_name_list[0]
output_type = DocketPage._OUTPUT_TYPES[output_name]

self.response.headers['Content-Type'] = output_type[0]
self.generate('docket_' + output_name + '.' + output_type[1], {
  'docket': docket,
  'projects': projects,
  'tasks' : tasks,
}) 
```

通过以下列方式更改代码，我设法让任务显示在模板中。然而，这显然没有帮助，因为无法知道项目和任务的数量。

```
tasks_query = Task.all().ancestor(projects[0])
tasks = tasks_query.fetch(10) 
```

# java - 在 Tomcat 服务器上托管 java servlet

> ID：10378420
> 
> 赞同：1
> 
> 时间：2012-04-30T04:14:17.477
> 
> 标签：java, web-services, tomcat, servlets

我编写了一个实现“Facebook Connect”功能的 JAVA servlet。我已经在我的笔记本电脑上本地安装了 Tomcat，并且可以成功运行它。

我现在想在 Tomcat 服务器上托管 servlet，以便外部人员可以登录并通过 servlet 提供他们的 Facebook 数据。

我该怎么做呢？我应该从网上购买哪个 Tomcat 服务器托管？完成这项工作将涉及哪些步骤？任何可用的教程/参考资料？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T04:41:07.937

你需要做一些谷歌。有各种托管服务提供商提供私人和共享托管。私人 Tomcat 托管会花费更多，但同时也会让您更好地控制共享 Tomcat 的成本。所以，这完全取决于你的要求。

您还必须购买一个域名。托管服务提供商将为您提供有关如何部署的支持。通常您需要向 `.war`服务提供商提供文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T04:52:24.817

看来您正在寻找托管解决方案，要托管您需要以下内容的网站 1\. 域名 2\. 应用程序服务器/Web 服务器（例如 Was/Tomcat/Weblogic）

如果您想在自己的计算机上托管您的网站，您将需要一个真实/静态 IP，可以从世界任何地方访问，向您的 ISP 询问真实/静态 IP，然后将您的域映射到该 IP，一次传播后，用户就可以看到网站，否则就可以用这个真实的ip访问了。

或者，为了避免 24*7 运行机器的麻烦，您可以从托管服务提供商处租用一些服务器，然后在那里部署您的应用程序以减轻痛苦。

# iphone - 我们如何使用谷歌日历 API？

> ID：10378422
> 
> 赞同：0
> 
> 时间：2012-04-30T04:14:27.273
> 
> 标签：iphone, google-calendar-api

我们如何使用谷歌日历 API？

我正在使用谷歌日历 api 开发一个 iphone 应用程序。

身份验证过程已完成，但之后我无法移动一步。如何在谷歌日历中添加活动？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T04:44:20.630

Google has provided very nice sample code for all their APIs in a variety of languages. For an Objective-C example with Google Calendar API, see : [http://code.google.com/p/google-api-objectivec-client/source/browse/#svn%2Ftrunk%2FExamples%2FCalendarSample](http://code.google.com/p/google-api-objectivec-client/source/browse/#svn%2Ftrunk%2FExamples%2FCalendarSample)

In particular, the file `CalendarSampleWindowController.m` has what you're looking for. See the [`addAnEvent`](http://code.google.com/p/google-api-objectivec-client/source/browse/trunk/Examples/CalendarSample/CalendarSampleWindowController.m#548) method.

# php - 通过 PHP 编辑 csv 文件

> ID：10378429
> 
> 赞同：2
> 
> 时间：2012-04-30T04:16:01.823
> 
> 标签：php

我正在为我的媒体课在网页上做一个测验。我是编程新手。我需要学习如何编辑我的数据 csv 文件以使其更有用。目前，当我查看我的 csv 文件时，我只得到四列数字（测验的结果）。我需要添加两列，一列包含时间戳，另一列显示填写测验的人的 IP 地址。

我的 PHP 的一部分如下所示：

```
 $csv_filehandle = fopen("/var/www/html/data/quiz.csv",'a');
    fputcsv($csv_filehandle,array($summer,$spring,$fall,$winter));
    fclose ($csv_filehandle);

    $visit_id = uniqid('',TRUE);

    $all_my_variables = array(
        'timestamp' => $current_timestamp,
        'user_ip' => $_SERVER['REMOTE_ADDR'],
        'summer' => $summer,
        'spring' => $spring,
        'fall' => $fall,
        'winter' => $winter,
    );

    $json_filehandle = fopen("/var/www/html/data/$visit_id.json",'w');
    fwrite($json_filehandle,json_encode($all_my_variables));
    fclose($json_filehandle);

    $current_hour = date_default_timezone_set("America/Chicago");
    $current_timestamp = date(DATE_RFC822); 
```

我在哪里/如何添加这些列，以便它们显示在我的 csv 文件中？帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T06:13:55.023

这在末尾添加了两列，时间戳和 IP。

```
fputcsv( $csv_filehandle,
        array($summer,
            $spring,
            $fall,
            $winter, 
            time(), 
            $_SERVER['REMOTE_ADDR'] ) 
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T04:35:04.243

您正在使用带有 PHP 的平面文件数据库。您的直接选择：

**丰富您对文本文件的使用：**

*   [http://www.designdetector.com/archives/04/10/FlatFileDatabaseDemo.php](http://www.designdetector.com/archives/04/10/FlatFileDatabaseDemo.php)
*   [http://www.xentrik.net/php/flatfile.php](http://www.xentrik.net/php/flatfile.php)

**升级到最小​​数据库。**
首选工具是 SQLite：

*   [http://www.switchonthecode.com/tutorials/php-tutorial-creating-and-modifying-sqlite-databases](http://www.switchonthecode.com/tutorials/php-tutorial-creating-and-modifying-sqlite-databases)
*   [http://fwebde.com/php/sqlite-php/](http://fwebde.com/php/sqlite-php/)

# wpf - 内存大小在实时图中快速增长

> ID：10378431
> 
> 赞同：-1
> 
> 时间：2012-04-30T04:16:28.287
> 
> 标签：wpf, graph, real-time

我正在使用普通的 Prism 和 MVVM 概念在 WPF 中开发一个实时图形应用程序。

我有一个 ViewModel，我有一个集合说 GraphDotsCollection，它每秒都在更新。每秒增加 100 分。此集合与视图中的图表控件绑定。

现在，随着集合不断增长，内存大小也增长得非常快，最终引发系统内存不足异常。

我不知道如何摆脱这个内存问题。

我正在使用 WPF 工具包。

请帮忙。提前非常感谢。

DJ

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-30T05:57:12.263

我相信你没有犯这个愚蠢的错误，只是为了重新检查。

检查您的视图模型。您必须声明了一些 CLR 属性，并且这些属性绑定到视图控件（例如：-您的图表控件）

您的 CLR 属性应该喜欢这样

```
Public string YourCLRProp
{
      get { return _yourVariable;}
      set { _yourVariable=value;}
} 
```

它不应该那样

```
 Public string YourCLRProp
{
      get { return YourCLRProp;}
      set { YourCLRProp=value;}
} 
```

# javascript - 带有错误“store.fetch 不是函数”的 Dojo 组合框

> ID：10378432
> 
> 赞同：1
> 
> 时间：2012-04-30T04:16:47.890
> 
> 标签：javascript, combobox, dojo

我看不出有什么问题，但错误控制台显示：“_21.store.fetch 不是函数”。组合框只是没有被填充。我尝试了 Memory 和 ItemFileWriteStore，两者都不起作用！怎么了？我正在使用 dojo 1.6.1 顺便说一句。代码如下：

```
<html>
<head>
<script type="text/javascript" src="dojo/dojo.js.uncompressed.js"></script>
<link rel="stylesheet" type="text/css" href="dojo/resources/dojo.css"></style>
<link rel="stylesheet" type="text/css" href="dijit/themes/claro/claro.css"></style>
<script type="text/javascript">
    dojo.require("dijit.form.ComboBox");
    dojo.require("dojo.store.Memory");
    dojo.require("dojo.data.ItemFileWriteStore");
    dojo.require("dojo.data.ItemFileReadStore");
</script>

<script type="text/javascript">
dojo.ready(function(){
    var rateStore, rate;

    rateStore = new dojo.store.Memory({
        data: [
            {id:1, name:"1 X"},
            {id:2, name:"2 X"},
            {id:4, name:"4 X"},
            {id:6, name:"6 X"},
            {id:8, name:"8 X"},
            {id:10, name:"10 X"}
        ]
    });
    /*
    rateStore =  new dojo.data.ItemFileWriteStore({
        data: {
            items:[
                {id:1, name:"1 X"},
                {id:2, name:"2 X"},
                {id:4, name:"4 X"},
                {id:6, name:"6 X"},
                {id:8, name:"8 X"},
                {id:10, name:"10 X"}
            ]
        }
    });
    */
    rate = new dijit.form.ComboBox({
        id: "rate",
        name: "rate",
        store: rateStore,
        searchAttr: name,
        style: "width:50px"
    }, dojo.byId("rate"));
    rate.startup();
});
</script>
</head>
<body class="claro">
<div id="rate"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T10:24:34.283

在 1.6.1 中，ComboBox 不支持 store API。因此，您将需要使用 ItemFileReadStore 或 ItemFileWriteStore。

```
rateStore =  new dojo.data.ItemFileWriteStore({
    data: {
        identifier: 'id',
        label: 'name',
        items:[
            {id:1, name:"1 X"},
            {id:2, name:"2 X"},
            {id:4, name:"4 X"},
            {id:6, name:"6 X"},
            {id:8, name:"8 X"},
            {id:10, name:"10 X"}
        ]
    }
});

rate = new dijit.form.ComboBox({
    id: "rate",
    name: "rate",
    store: rateStore,
    style: "width:250px"
}, dojo.byId("rate"));
rate.startup(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T06:02:02.117

试试这个：

```
rate = new dijit.form.ComboBox({
    id: "rate",
    name: "rate",
    store: rateStore,
    searchAttr: "name",
    style: "width:50px"
}, "rate").startup(); 
```

# c# - 动态命名结构 c#

> ID：10378435
> 
> 赞同：0
> 
> 时间：2012-04-30T04:17:13.150
> 
> 标签：c#, dynamic, struct, naming

我正在编写的程序有许多结构，这些结构因许多因素而异，主要是我无法预测这些结构中有多少，所以程序自己创建它们。

结构看起来像这样；

```
public struct boardState
    {
        public int structid;
        public char[] state;
    } 
```

我怎样才能让程序在没有我明确给它命名的情况下命名这些结构？

理想情况下，将有一个名为 structNum 的 int 跟踪已创建的结构数量，然后将根据 structNum 的值命名任何新结构，但我不确定这是否可以完成，是否存在一种方法还是您能提出更好的方法？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T04:20:57.193

如果您不知道要获得的值的确切数量，则可以使用 a`List<boardState>`可以容纳任意长数量的值。在运行时动态命名不是 .NET 的特性。编译后没有真正的名字。

```
var theList = new List<boardState>();
// add
theList.Add(new new boardState());
// get one
int id = theList[0].structid;
// iterate
foreach(var s in theList)
    // do something
int cnt = theList.Count; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T04:21:27.190

你不能在运行时做动态变量名，而不需要大量的反射。

最简单的解决方案是将结构保存在一个`List`或类似的集合中：

```
List<boardState> boardStates = new List<boardState>(); 
```

# java - 如何修复多线程环境中的 ConcurrentModificationExceptions？

> ID：10378436
> 
> 赞同：2
> 
> 时间：2012-04-30T04:17:18.407
> 
> 标签：java, exception-handling

这是我不断收到的错误。

```
"Exception in thread "Thread-3" java.util.ConcurrentModificationException
at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:782)
at java.util.ArrayList$Itr.next(ArrayList.java:754)
at group1.bt.Announce.run(Announce.java:22)
at java.lang.Thread.run(Thread.java:679)" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T04:21:37.367

您需要列表的同步视图。

```
List list = Collections.synchronizedList(new ArrayList());
   ...
synchronized (list) {
   Iterator i = list.iterator(); // Must be in synchronized block
   while (i.hasNext())
       foo(i.next());
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T04:31:02.623

您的问题是您正在从迭代器循环内部更改基础列表。您应该在 Announce.java 的第 22 行显示代码，以便我们可以看到您具体做错了什么，但是在开始循环之前复制您的列表，使用 for 循环而不是迭代器，或者保存您想要删除的项目从列表到新列表，然后在完成迭代器循环后将它们全部删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T04:46:44.540

您可以使用以下方法来避免 ConcurrentModificationException：

```
 ListIterator

    Synchronizers

    CopyOnWrite

    toArray()

    Concurrent Collections: 
```

在这种情况下，您可以`ConcurrentHashMap`从并发集合 API 中使用。我认为这很容易，并且不会仅在更新时冻结对象。

# design-patterns - 一个班级应该使用它自己的工厂吗？

> ID：10378437
> 
> 赞同：0
> 
> 时间：2012-04-30T04:17:28.833
> 
> 标签：design-patterns

我正在建立设备类的层次结构（linux“块”设备）。我的设备工厂已经从仅仅作为一种从不同输入创建各种设备子类的方式演变为各种构建器。它填充了大量数据。我的问题是，Lvm 类上的 create() 方法是否应该使用设备工厂来填充这些信息？还是我应该考虑将所有这些逻辑移到 Device 子类本身中？看，你可以用足够的信息来实例化一个 lvm 对象以在磁盘上创建一个，但是一旦它被创建，就会有更多的信息可用并且需要填充到对象中。

# c - 静态和内联

> ID：10378442
> 
> 赞同：1
> 
> 时间：2012-04-30T04:18:30.127
> 
> 标签：c, linux, optimization, gcc, inline

我正在用 C 编程。我想要一些关于静态和内联函数的描述。我知道，如果我们将一个函数设为静态，那么它向编译器表明它只有一个翻译单元处于内部链接之下。我对 static 和 inline 有以下疑问：

1.  如果我们将一个函数设为 static ，我们可以在其他翻译单元中使用它......即在其他 .c 文件中吗？如果是..怎么样？
2.  如果我们将函数设为静态内联，那有什么区别呢？编译器将如何处理它？
3.  将函数设为静态会产生与宏相同的效果吗？
4.  将函数处理为内联取决于编译器，具体取决于大小。那么有什么方法可以强行让它像内联一样对待呢？
5.  我们如何使用内联和静态函数进行优化？

请对上述内联内容有所了解。平台是Linux，gcc编译器，C语言。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T04:26:23.113

1.  一个`static`函数不能在其他翻译单元中使用。这就是他们存在的理由。

2.  `inline`提示编译器该函数应该被内联而不是被调用。

3.  将函数设为静态与使用宏不同。宏本质上会否决编译器。无论它是否认为内联是否明智，宏都会被内联；宏是文本替换。您还可以将`static`函数传递给需要函数指针的对象。不能用宏来做到这一点。

4.  宏将强制内联任何内容。即使指定`inline`也可以被否决。

5.  制作不想导出的函数`static`。如果一个函数真的很小，并且你真的认为它应该被内联，你可以告诉编译器用`inline`. 宏实际上仅用于元编程。编译器比你更清楚。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T08:44:23.237

`static`并`inline`服务于两个截然不同的目的。

正如您所说的正确`static`意味着函数的符号不是从定义它的编译单元中导出的。因此不同的编译单元可以有这样的同名符号而不会发生冲突。这是否对应于相同的函数声明和定义取决于您。但是，通过静态或动态导出指向它的指针，可以很好地在不同的编译单元中*使用*所有静态分配的对象等函数。

`inline`是不同的。它的目的是使编译器可以内联你的函数，因此它的名字，但它的主要直接影响是函数符号通常根本不发出。这样做的目的是您可以将函数的*定义*放在头文件中，并将该文件包含在几个编译单元中，而无需在每个编译单元中创建多个符号。对于定义的函数，它还具有不允许在函数`static`内声明变量的效果`inline`，因为根本不清楚该对象必须在哪个编译单元中实现。

总而言之，`static`生成大量函数副本，`inline`没有生成；`static`主要用于`".c"`文件`inline`和`".h"`

第一个具有您可能在某些地方没有检测到两个函数指针指向“相同”函数的效果，第二个可能具有如果您需要一个指向该函数的函数指针的效果，则没有它可以指向的函数对象参考。通过在 .c 文件中放置一种“实例化”，可以强制发出这样的函数（仅在一个编译单元中！）：

```
// .h definition
inline void toto(void) { }

// .c instantiation
void toto(void); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T04:24:09.063

如今，编译器将确定内联函数是否实际上是内联的，因为并非所有函数都适合它。如果是这样，则在引用相应函数的地方简单地注入/内联函数体。

这些函数应该保留给函数体通常很短的频繁函数调用，尽管我认为不一定是这种情况。

# wpf - 我应该使用哪种面板来创建自定义下拉菜单？

> ID：10378452
> 
> 赞同：1
> 
> 时间：2012-04-30T04:20:26.257
> 
> 标签：wpf, mvvm, wpf-controls, wpftoolkit

我需要创建一个自定义下拉菜单，该下拉菜单有一个打开它的按钮和一个显示某些内容的面板，我希望在单击它外部时关闭它，我应该使用哪种面板？我尝试了 popupmenu 但在失去焦点后无法关闭它，并尝试了 contextmenu 但单击它的内部项目时它会关闭。

任何建议都将不胜感激。

我试过这样的事情：

```
 <Button x:Name="toggleButton"  
            ContextMenuService.Placement="Top"  Click="ToggleButton_Click"
            Margin="0" Content="+">
        <Button.ContextMenu>
            <ContextMenu Width="200" 
                         HorizontalContentAlignment="Stretch"
                         VerticalContentAlignment="Stretch" >
                <StackPanel>
                    <DataGrid >
                        <DataGrid.Columns>
                            <DataGridTextColumn/>
                            <DataGridTextColumn/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <TextBlock Text="sadfasdfas" />
                    <TextBox Text="" Width="100"/>
                </StackPanel>
            </ContextMenu>
        </Button.ContextMenu>
    </Button> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T04:23:51.633

你应该使用一个`Popup`控件。 [这](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.popup.aspx)是 MSDN 文档，这里是帮助指明方向的[文章](http://www.switchonthecode.com/tutorials/wpf-tutorial-resizeable-popup)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T07:39:37.417

最后我在 2 天后创建了我需要的东西！！，我真的找不到更好的解决方案，我不得不放两个按钮，一个用于显示弹出窗口，另一个用于关闭弹出窗口！

在xml中

```
 <ToggleButton x:Name="ShowPopup" Width="20" Height="20" Click="buttonShowPopup_Click"  Panel.ZIndex="1" />
    <ToggleButton x:Name="ClosePopup" Width="20" Height="20" Click="ClosePopupPopup_Click"  />
    <Popup x:Name="popup" 
        HorizontalOffset="0"
        VerticalOffset="0"
        PlacementTarget="{Binding ElementName=buttonShowPopup}"
        Placement="Top"
        PopupAnimation="Slide"
        AllowsTransparency="True"
        Focusable="True"

        StaysOpen="False" Margin="36,0,-36,0">
        <Grid LostFocus="Grid_LostFocus" >
            <TextBox Text="asdasd"/>
        </Grid>
    </Popup> 
```

在代码隐藏中

```
 public DropDown()
    {
        InitializeComponent();
        popup.Closed += popup_Closed;
    }

    private void ClosePopupPopup_Click(object sender, RoutedEventArgs e)
    {
        popup.IsOpen = false;
    }
    private void buttonShowPopup_Click(object sender, RoutedEventArgs e)
    {
        popup.IsOpen = true;
        ClosePopup.SetValue(Canvas.ZIndexProperty, 1);
        ShowPopup.SetValue(Canvas.ZIndexProperty, 0);
    }

    void popup_Closed(object sender, EventArgs e)
    {
        ShowPopup.SetValue(Canvas.ZIndexProperty, 1);
        ClosePopup.SetValue(Canvas.ZIndexProperty, 0);
    } 
```

# xml - 不知道如何获取时间属性

> ID：10378453
> 
> 赞同：0
> 
> 时间：2012-04-30T04:20:34.683
> 
> 标签：xml, xpath, google-sheets, google-sheets-importxml

我在使用`ImportXML()`Google 电子表格中的函数时遇到问题。我想[在电子表格中检索在几个 Reddit 帖子](https://docs.google.com/spreadsheet/ccc?key=0AgLkBqMZYl2FdDJ6dFJhUmZWUHVoNVdzRUprOEZRM3c)上发布的时间，但我只有 2012 年 4 月 28 日才有运气，而不是 2012-04-28T02:19:06.348481+00:00，这就是我想要的喜欢。

例如，[在这个网页上](http://www.reddit.com/r/BuyItForLife/comments/sw9m5/choosing_the_right_kitchen_knife_alton_brown/)，我查看源代码并看到以下内容：

```
<div class='spacer'><div class="linkinfo">
    <div class="date">
        <span>this post was submitted on &#32;</span>
            <time datetime="2012-04-28T02:19:06.348481+00:00">28 Apr 2012</time>
    </div>
<div class="score"> 
```

但是，这是我可以做任何事情的唯一线路：

```
=ImportXML(
"http://www.reddit.com/r/BuyItForLife/comments/jtjuz/bi4l_mission_statement_rules_etc/",
"//div[@class='date']") 
```

有什么建议么？我一直在寻找和尝试，寻找和尝试，但没有任何效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-05-26T06:15:45.490

IMPORTXML 要求文档遵循 ​​XML/XHTML 才能正常工作。看起来文档不符合这一点，因此，使用 IMPORTDATA 代替 IMPORTXML，然后使用 QUERY 和 REGEXEXTRACT。

例子：

A1：添加 URL `http://www.reddit.com/r/BuyItForLife/comments/jtjuz/bi4l_mission_statement_rules_etc/`
A2：添加以下公式

```
=REGEXEXTRACT(QUERY(transpose(QUERY(importdata(A1),,1E+100)),,1E+100),
"datetime=""(.*?)""") 
```

结果：`2011-08-25T01:32:23+00:00`

关于QUERY的使用说明：

IMPORTDATA 返回一个二维数组。QUERY 用于连接数组的内容两次，第一次将所有行放在一起，第二次对所有列执行相同操作。

CONCATENATE 和 JOIN 不能使用，因为它们有 50000 个字符的限制。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2015-10-31T15:21:55.777

您提出了棘手的问题，并且可能达到了 google 电子表格的限制 - 通常您可以检查 Xpath 属性的有效性，例如：

```
//*[@datetime="2011-08-25T01:45:37+00:00"] 
```

结果答案单元格必须是

```
TRUE 
```

请参阅沙盒第 21 行示例：

```
//div/@class="md"   TRUE 
```

# javascript - 需要澄清在 JavaScript 中何时使用引号以及何时不使用引号

> ID：10378463
> 
> 赞同：1
> 
> 时间：2012-04-30T04:21:49.687
> 
> 标签：javascript

我是从 codecademy.com 学习 JavaScript 的新手。最近他们引入了括号表示法（与更简单的点表示法相反）。我知道有一些优势，因为您可以引用使用点符号无法引用的内容。但是我不明白为什么我应该在某些情况下使用引号。

例如：

```
var suitcase = {
    shorts: "purple"
};
if (suitcase.hasOwnProperty("shorts")) {
    console.log(suitcase.shorts);
} 
```

为什么短裤需要在行中加上引号`if (suitcase.hasOwnProperty("shorts")) {`？我习惯于引用将某些东西指定为字符串。shorts 是手提箱对象的一个​​属性，所以我认为它会在没有引号的情况下被引用。到目前为止，我已经很好地理解了 JavaScript 的规则，但这并没有得到清楚的解释，所以我发现自己很困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T04:27:10.423

考虑一下：

```
var suitcase = {
    shorts: 'purple',
    shorts: purple
} 
```

是的，它两次分配给“短裤”。但第一行`'purple'`是分配一个字符串，其值为`purple`shorts 对象键。第二行是分配一个名为 VARIABLE 的变量`purple`，该变量尚未定义。

上下文就是 Javascript 中的一切。无需引用该`shorts`部分，因为 JS 解释器知道您在那里定义了一个对象键。但它不够聪明地决定是否`purple`应该是一个表示颜色的字符串，还是一个名称恰好是`purple`. 这就是为什么有引号 - 提供必要的上下文。

同上`hasOwnProperty`。如果 shorts 没有被引用，那么它被视为一个未定义的变量。如果它被引用，那么它是一个字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T04:24:57.010

所有对象的属性名称都只是字符串。您始终可以通过字符串名称来引用属性，例如`a["b"]`. 一个例外是当您使用`.`. 在这种情况下，`a.b`是一个属性。这相当于`a["b"]`。在所有其他情况下，使用字符串来引用属性名称。

`hasOwnProperty`是一种正常的方法。如果您传入`shorts`而不是`"shorts"`，JS 将被`shorts`视为变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T05:28:18.717

您的示例与以下内容相同：

```
 suitcase = new Object();  
    suitcase.shorts = 'purple';
    suitcase.hasOwnProperty('shorts');   //returns true 
```

永远记住，javascript中未包含的参数/参数`qoutes`是可变的。实际上不仅仅是javascript，所有语言。不要将自己与变量混淆。

Javascript 需要一个变量`shorts`。

```
 var shorts = 'shorts';
    suitcase.hasOwnProperty(shorts);   //returns true 
```

[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/hasOwnProperty](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/hasOwnProperty)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T04:25:37.653

该`hasOwnProperty()`函数需要您要检查的属性的名称。因此，它需要作为字符串传入。如果您省略引号，则 javascript 将假定您正在传递一个包含属性名称的变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-30T04:29:19.717

如果没有引号，javascript 会将 shorts 解释为一个对象，并且由于 shorts 是未定义的，所以你会得到。hasOwnProperty 函数正在寻找字符串类型的属性名称。

```
ReferenceError: shorts is not defined 
```

所以

```
suitcase.shorts 
```

返回“紫色”

```
shorts !== suitcase.shorts 
```

shorts 与 suitcase.shorts 不是同一个对象，事实上在你声明它之前它甚至不是一个对象。

```
shorts = "brown" 
```

这将 shorts 的值设置为“brown”，但 suitcase.shorts 仍然是“purple”

我希望这可以解决这个问题。

# cuda - 如何将 cuPrintf 与 .cpp 文件中具有 main() 的 cuda 项目一起使用？

> ID：10378464
> 
> 赞同：1
> 
> 时间：2012-04-30T04:21:51.360
> 
> 标签：cuda, g++, sdl, nvcc

所以我正在尝试加速一些碰撞检测代码，这些代码使用 SDL 将一些碰撞球绘制到 Mac OS X 中的表面/窗口。我可以进行碰撞并以顺序方式绘制东西已经很好了。我希望能够使用 cuPrintf 调试 cuda 版本，但由于我的 main() 不在 .cu 文件中，我无法让它工作。所以无法初始化cuPrintf，也无法打印缓冲区。如果我创建几个外部“C”函数并将它们构建到 .cpp 文件中，我什么也得不到。如果我尝试将包装函数与我的 cuda 代码的其余部分一起放在 .cu 文件中，我会收到“错误：不支持使用外部函数......”。我在较小的项目中使用过它，所有内容都在一个大的 .cu 文件中，效果很好。但是我可以'

其他人有过这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T17:58:49.670

我基本上为 cuPrintf 提供的 3 个调用创建了一个包装器，这些调用需要放在主函数中。在我的 kernel.cu 文件中，我定义了一些外部“C”函数。然后在 main.cpp 中，我声明它们将它们纳入范围。

在 kernel.cu 中：

```
// Include section
#include "cuPrintf.cu"

//define all __device__ and __global__ functions for the kernel here
extern "C"
{
void LaunchKernel(<type> *input) { kernel<<< grid, dim >>>(input); }

void InitCuPrintf() { cudaPrintfInit(); }

void DisplayCuPrintf() { cudaPrintfDisplay(stdout, 1); }

void EndCuPrintf() { cudaPrintfEnd(); }
} 
```

在 main.cpp 中：

```
// you do NOT need to include any cuPrintf files here. Just in the kernel.cu file
#include <SDL.h>  // this is the library requiring me to do this stuff ...
#include "SDL_helper.h"  // all of the SDL functions I defined are separated out
#include <cuda_runtime.h>

// in global space
extern "C" {
void LaunchKernel(struct circle *circles);
void InitCuPrintf();
void DisplayCuPrintf();
void EndCuPrintf();
}

int main(nt argc, char **argv)
{
    // put these where you would normally place the cuPrintf functions they correspond to
    InitCuPrintf();

    // I left his in here because if you're needing to do this for cuPrintf, you prolly need
    // need a wrapper to lauch your kernel from outside the .cu file as well.
    LaunchKernel( input );

    DisplayCuPrintf();

    // SDL functions from SDL.h and SDL_helper.h would be in here somewhere

    EndCuPrintf()
} 
```

而已！我在我的项目目录中制作了 cuPrintf.cu 和 cuPrintf.cuh 的副本，因此我不必在编译中链接到某个随机目录。我的 nvcc / g++ 命令如下。我在 MAC 上编码，所以它们是 Mac OS X 特定的......

```
nvcc ./kernel.cu -I./ -I/usr/local/cuda/include/ -c -m64
g++ ./main.cpp -I./ -I/usr/include/ -I/usr/local/cuda/include/ -L/usr/local/cuda/lib/ -lcudart -LSDLmain -lSDL -framework Cocoa ./SDL_helper.o ./kernel.o 
```

注意：我将所有 SDL 函数分离到一个单独的 SDL_helper.c 文件中，我在运行 nvcc*之前编译了该文件：*

```
g++ ./SDL_helper.c -I./ -c 
```

我希望这对其他人有帮助。

# visual-studio - Visual Studio：基于构建配置的设置项目更改？

> ID：10378467
> 
> 赞同：1
> 
> 时间：2012-04-30T04:22:01.237
> 
> 标签：visual-studio, conditional, project, installation

我有一个为 X 公司构建的项目。然后他们决定允许 Y 公司使用该产品——他们想要进行一些小的品牌类型更改。我来自 C 编程背景，因此我添加了另一个构建配置，该配置指定了一个条件编译符号，具体取决于为哪个品牌构建解决方案。然后源码有几个：

```
#if COMPANY_X
  // do stuff
#elif COMPANY_Y
  // do different stuff
#endif 
```

现在这是我的问题：我可以使用解决方案的构建配置来操作单个（Visual Studio 安装程序）安装项目吗？还是我必须维护多个安装项目来管理它们之间的差异（应用程序名称、安装文件夹、制造商等）？（或者也许更根本的是，我是不是把这一切都搞错了？）

背景信息：Visual Studio 2010、Visual Studio 安装程序、C#

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T04:49:43.983

您可以使用单一 vs 2010 解决方案并创建多个解决方案配置（理想情况下适用于不同的公司或不同的环境）。

VS 2010 Menu --> Build--> Configuration Manager--> Select new from Active solution configuration。使用这种方法，您不必编写条件构建。

# python - 从 SQLAlchemy 中的集合中删除对象

> ID：10378468
> 
> 赞同：7
> 
> 时间：2012-04-30T04:22:05.250
> 
> 标签：python, mysql, sqlalchemy

我将一堆专利数据存储在 MySQL 数据库中，并通过 SQLAlchemy 与之交互。我在 Patent 类中有一个集合，代表受让人（被分配专利的公司）列表：

```
assignees = relationship('Company', secondary=patent_company_table, backref='patents') 
```

我正在处理存储在数据库中的一些对象，对于 Patent 对象`p`，我想从的受让人列表中删除一些受让人`a`（公司对象） 。`p`基于[http://docs.sqlalchemy.org/en/latest/orm/session.html#deleting-from-collections](http://docs.sqlalchemy.org/en/latest/orm/session.html#deleting-from-collections)，似乎调用`s.delete(a)`实际上会删除 Company object `a`。我只是想从受让人`a`列表中删除受让人`p`（即删除专利公司表中的一行），而不是实际删除公司对象，因为`a`可能在另一个专利对象的受让人列表中。

我尝试创建一个新列表`new_assignees`，其中仅包含来自`p`除此之外的受让人`a`，然后调用：

```
p.assignees = new_assignees
s.add(p) 
```

不幸的是，这实际上并没有标记`p`为脏，所以我认为它不会影响数据库。

您对如何从集合中删除对象有任何建议，删除专利公司表中的行而不是从公司表中删除对象？

谢谢你。

## 更新

这是代码片段：

```
assignees = patent.assignees
for assignee in assignees:
    if assignee in duplicate_company_to_default:
        patent.assignees.remove(assignee)
        default_company = duplicate_company_to_default[assignee]
        if default_company not in assignees:
            added_patent_count += 1
            patent.assignees.append(default_company) 
```

循环遍历所有专利后，`added_patent_count = 983672`但`session.dirty()`. `append`通过or修改后是否需要手动添加到会话中`remove`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-30T06:31:56.917

SQLAlchemy 集合支持类似列表的追加/删除操作。

```
p.assignees.remove(c) 
```

这应该删除`c`表单`p.assignees`而不`c`从数据库中删除。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-07T21:41:28.107

一个工作示例脚本意味着，我们可以完全运行它。这是根据您提供的片段生成的脚本。有帮助的一件事是将“受让人”评估为一个列表，因为您要从中删除，很可能您没有正确迭代。

```
from sqlalchemy import *
from sqlalchemy.orm import *
from sqlalchemy.ext.declarative import declarative_base

Base= declarative_base()

patent_company_table = Table('pct', Base.metadata,
    Column('patent_id', Integer, ForeignKey('patent.id')),
    Column('company_id', Integer, ForeignKey('company.id'))
)

class Patent(Base):
    __tablename__ = "patent"
    id = Column(Integer, primary_key=True)

    assignees = relationship('Company', secondary=patent_company_table, backref='patents')

class Company(Base):
    __tablename__ = "company"
    id = Column(Integer, primary_key=True)

e = create_engine("sqlite://")
Base.metadata.create_all(e)

s = Session(e)
p = Patent()
c1, c2, c3, c4, c5 = Company(), Company(), Company(), Company(), Company()
d1, d2 = Company(), Company()
duplicate_company_to_default = {c1:d1, c2:d2, c3:d1, c4:d2}

new_assignees = [c1, c2, c3, c4, c5]
p.assignees = new_assignees
s.add(p)
s.commit()

patent = s.query(Patent).first()
assignees = patent.assignees
added_patent_count = 0
for assignee in list(assignees):
    if assignee in duplicate_company_to_default:
        patent.assignees.remove(assignee)
        default_company = duplicate_company_to_default[assignee]
        if default_company not in assignees:
            added_patent_count += 1
            patent.assignees.append(default_company)

assert p in s.dirty

s.commit()

assert set(p.assignees) == set([d1, d2, c5]) 
```

# ruby-on-rails - 在 Rake 任务中创建数据库值 - Rails

> ID：10378469
> 
> 赞同：1
> 
> 时间：2012-04-30T04:22:07.040
> 
> 标签：ruby-on-rails, rake

我有以下脚本，我想自动更新我的数据库。

```
require 'feedzirra'
require 'sanitize'

namespace :db do

  task :update_pitzer => :environment do

    feed = Feedzirra::Feed.fetch_and_parse('http://www.cafebonappetit.com/rss/menu/219')

    feed.entries.each do |entry|
      date = Sanitize::clean(entry.title)
      summary = Sanitize::clean(entry.summary)
      summary.gsub!(/\s{2}/, " ").to_s
      summary.gsub!(/\s{2}/, "").to_s
      summary.gsub!("&amp;", "&")
      puts "#{date}"

      theDay = Day.create(date: date)
      #theDay.collins_meals.create()

      array = summary.split(/\[/)
      array.collect! {|x| "[" + x}
      array.reject! {|x| x == "[ "}
      array.to_s
      puts array
    end
  end
end 
```

当我在命令行运行 rake db:update_pitzer 时，我得到：

```
 (in /Users/Alex/rails_projects/dining_hall_api)
   rake aborted!
   Don't know how to build task 'db:update_pitzer' 
```

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T10:31:09.183

代码似乎正确。确保您已将“update_pitzer.rb”文件放在 Rails 应用程序的“lib/tasks”文件夹下

# java - 如何在 Java 上同时支持 IPv4 和 IPv6

> ID：10378471
> 
> 赞同：20
> 
> 时间：2012-04-30T04:22:32.030
> 
> 标签：java, linux, networking, network-programming, ipv6

我们的一个 Java 程序启动时，它只监听 IPv6 (8080)

例如

```
# netstat -ntpl

Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -               
tcp6       0      0 :::8080                 :::*                    LISTEN      -               
tcp6       0      0 :::22                   :::*                    LISTEN      - 
```

问题是它无法从外部访问（本地主机除外），为了解决这个问题，我手动添加了这个

```
-Djava.net.preferIPv4Stack=true 
```

但这使得该程序仅适用于 IPv4 网络。

是否可以像上面的**sshd**一样，都支持 IPv4 和 IPv6？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-30T04:39:26.177

我怀疑这与其说是 Java 编程问题，不如说是 OS 网络堆栈/OS 网络配置问题：

> [http://coding.derkeiler.com/Archive/Java/comp.lang.java.help/2009-09/msg00087.html](http://coding.derkeiler.com/Archive/Java/comp.lang.java.help/2009-09/msg00087.html)
> 
> 在某些操作系统上，单个本地 TCP 套接字可以同时侦听 IPv4 和 IPv6 上的端口。它能够接受来自远程 IPv4 和远程 IPv6 客户端的连接。在其他操作系统（例如 WinXP）上，操作系统本机套接字不能这样做，但只能接受来自 IPv4 或 IPv6，而不是两者。在这些操作系统上，为了能够接受来自远程 IPv4 和 IPv6 客户端的连接，必须有两个侦听套接字，一个侦听 IPv4 连接，一个侦听 IPv6。

Windows 7 和 Windows Server 2008 可以很好地处理双堆栈；Windows XP 没那么多:)

您似乎在 Linux 上 - 大多数现代 Linux 桌面和服务器也可以毫无问题地处理双 ipv4 ipv6。

这是一篇关于互操作性的好文章：

*   [http://ntrg.cs.tcd.ie/undergrad/4ba2.02/ipv6/interop.html](http://ntrg.cs.tcd.ie/undergrad/4ba2.02/ipv6/interop.html)

您知道如何为您的 Java 应用程序“关闭”IPV6：`-Djava.net.preferIPv4Stack=true`

您还可以像这样强制您的服务器使用 IPV6：`echo 0 > /proc/sys/net/ipv6/bindv6only`

这可以说是你最好的来源：

*   [http://docs.oracle.com/javase/6/docs/technotes/guides/net/ipv6_guide/index.html](http://docs.oracle.com/javase/6/docs/technotes/guides/net/ipv6_guide/index.html)

您绝对应该能够完成您想要的（至少在 Java 编程级别），除非您受到外部网络问题的限制：

```
Nodes)      V4 Only  V4/V6  V6 Only
            -------  -----  -------
V4 Only     x        x   
V4/V6       x        x      x
V6 Only              x      x 
```

PS：

这是另一个很好的链接，它解释了套接字级别发生的事情。它不是 Java（它是 C），但示例原则完全适用：

*   [接受来自 IPv6 和 IPv4 客户端的连接](http://publib.boulder.ibm.com/infocenter/iseries/v5r3/index.jsp?topic=/rzab6/rzab6xacceptboth.htm)

# javascript - 在导航到新页面时保持 Chrome 扩展弹出窗口打开

> ID：10378477
> 
> 赞同：3
> 
> 时间：2012-04-30T04:23:50.397
> 
> 标签：javascript, google-chrome, google-chrome-extension

我正在开发一个带有弹出窗口的 Google Chrome 扩展程序（这是一个浏览器操作），它改变了页面的位置，从而使弹出窗口消失。我怎样才能让它停留在页面重新加载之间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T04:29:19.947

你不能。browserAction 弹出窗口在弹出窗口之外的任何活动上都会关闭。不过，您可能会使用[桌面通知](https://code.google.com/chrome/extensions/notifications.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T04:29:02.463

~~您需要使用[Background Page](http://code.google.com/chrome/extensions/background_pages.html)，并在每次加载弹出窗口时从中提取信息。无论您的扩展程序当前是否正在使用，后台页面都会运行。~~

不确定这是否有帮助，但来自[常见问题解答](http://code.google.com/chrome/extensions/faq.html#faq-persist-popups)：

> 用户点击离开后，扩展程序可以保持弹出窗口打开吗？
> 
> 不，当用户关注弹出窗口之外的浏览器某些部分时，弹出窗口会自动关闭。用户点击离开后，无法保持弹出窗口打开。

# css - 如何使列表看起来像 iphone 菜单

> ID：10378479
> 
> 赞同：0
> 
> 时间：2012-04-30T04:23:59.583
> 
> 标签：css, list, sencha-touch, extjs, sencha-touch-2

我需要一个类似于 iphone 菜单的列表，请看这张图片

![http://www.demogeek.com/wp-content/uploads/2009/07/img-01281.png](../Images/a63d4f2d3f4c44880e8c7ec5fdde3c48.png)

我的清单实际上是这个

![在此处输入图像描述](../Images/53c488c808491c7594b090b29cedc1f5.png) 我无法获得相同的外观

我的js代码

```
var store = new Ext.data.JsonStore({
        model  : 'Contact',    
        getGroupString : function(record) {
            return record.get('menu')[0];
        },

        data: [
            {menu: '<img src="images/summary2.png" height="42" width="42" /> Shipment Summary ',item:'1'},
                {menu: '<img src="images/detail2.png" height="42" width="42" /> Shipment Details ',item:'2'},
            {menu: '<img src="images/documents2.png" height="42" width="42" /> Shipment Documents ',item:'3'}
        ]
    });

    SL.views.mainMenuBottomBar = new Ext.List
    ({
            id: 'MBB',
            fullscreen: false,
            centered: true,
            cls: 'settingscls',
            disableSelection: true,
            scroll: false,
            dock: 'bottom',
            itemTpl : '<tpl for="."><div class="x-list-group-items">{menu}</div></tpl>',
            grouped : false,
            indexBar: false,
            onItemDisclosure: 
                    function(record)
                   {
                        if(record.get('item')=='1')               {
                       }
                        ...
                   },
       store: store
    }); 
```

我的 CSS 代码

```
.settingscls
{
    background:transparent;
}
.settingscls .x-list-disclosure
{
        margin-top:0.6em;
        right:1em !important;
        -webkit-mask:none;
        -webkit-mask-box-image: url('images/list-arrow.png');
}
.settingscls .x-list-item
{
    background:white;
    left:10px;
    right:10px;
    bottom:10px;
     -webkit-border-top-left-radius: 0.4em ;
         -webkit-border-top-right-radius: 0.4em;
     -webkit-border-bottom-left-radius: 0.4em;
         -webkit-border-bottom-right-radius: 0.4em;
} 
```

- 在 css 中，我无法将边框应用于第一个和最后一个项目列表

- 文本出现在垂直对齐底部

- 字体与 iphone 菜单不同

- 右边距或填充有效

请帮我

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T04:29:25.183

查看 Sencha Touch 论坛上提出的类似问题：-

*   [如何创建类似 iPhone 设置菜单的东西？](http://www.sencha.com/forum/showthread.php?115231-How-to-create-something-like-iPhone-settings-menu)

输出 ：-

![在此处输入图像描述](../Images/6fd21e87e587d57cdcf9884fda0ca630.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T04:35:23.057

确保您的容器左右有填充，并且 ul 显示为块元素，如下所示：http: [//jsfiddle.net/P9pSG/4/](http://jsfiddle.net/P9pSG/4/)

# wpf - 如何将样式基于默认控件的样式？

> ID：10378482
> 
> 赞同：5
> 
> 时间：2012-04-30T04:24:34.740
> 
> 标签：wpf, inheritance, subclass, basedon

我们正在编写 TextBox 的自定义子类，我们只需要更改样式的一些基本部分。现在我们知道当你子类化时`Control`，通常你应该像这样更改元数据......

```
public class EnhancedTextBox : TextBox
{
    static EnhancedTextBox()
    {
        // Commenting this line out lets this use the default TextBox style.
        DefaultStyleKeyProperty.OverrideMetadata(
            typeof(EnhancedTextBox),
            new FrameworkPropertyMetadata(typeof(EnhancedTextBox)));
    }
} 
```

这会将用于该子类类型的键更改为类型本身，这意味着它不再获得默认的 TextBox 样式。没什么大不了的......我们只是注释掉那条线，它再次起作用，因为键仍然设置为 TextBox 直接使用的值。

然而，我们想知道如果我们*确实*想要改变样式中的一些东西，而不是整个样式，我们可以简单地创建一个新样式并设置它的`BasedOn`属性......但是我们在那里设置什么？我们不想手动拉出 XAML 并创建一个新样式，给它一个键，然后使用一个 StaticResource，但我们还没有找到我们可以在那里设置说“这是基于 TextBox风格。

我希望它是简单的，但同样，我们还没有找到它。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-30T04:29:59.870

就这样……我找到了。伙计，踢自己，这很明显，我错过了！

```
<Style TargetType="{x:Type local:EnhancedTextBox}"
    BasedOn="{StaticResource {x:Type TextBox}}">

   ....

</Style> 
```

在这里找到它... [WPF 样式基于当前](https://stackoverflow.com/q/1770935/168179)

# ravendb - 查询“标签”文档的最佳设计方法

> ID：10378483
> 
> 赞同：1
> 
> 时间：2012-04-30T04:24:36.727
> 
> 标签：ravendb

我正在存储文档——每个文档都有一个“标签”集合——就像这样。标签是用户定义的，可以是任何纯文本。

```
{
  "FeedOwner": "4ca44f7d-b3e0-4831-b0c7-59fd9e5bd30d",
  "MessageBody": "blablabla",
  "Labels": [
    {
      "IsUser": false,
      "Text": "Mine"
    },
    {
      "IsUser": false,
      "Text": "Incomplete"
    }
  ],
  "CreationDate": "2012-04-30T15:35:20.8588704"
} 
```

我需要允许用户查询标签的任何组合，即

```
"Mine" OR "Incomplete"
"Incomplete" only
or
"Mine" AND NOT "Incomplete" 
```

这会导致像这样的 Raven 查询：

```
Query: (FeedOwner:25eb541c\-b04a\-4f08\-b468\-65714f259ac2) AND (Labels,
Text:Mine) AND (Labels,Text:Incomplete) 
```

我意识到 Raven 将为它以前从未见过的查询生成一个“动态索引”。我可以看到，这可能会导致很多索引。

使用 Raven 实现此功能的最佳方法是什么？

[编辑]

这是我的 Linq，但我从 Raven 收到错误“不支持所有内容”

```
var result = from candidateAnnouncement in session.Query<FeedAnnouncement>()
where listOfRequiredLabels.All(
    requiredLabel => candidateAnnouncement.Labels.Any(
        candidateLabel => candidateLabel.Text == requiredLabel))
select candidateAnnouncement; 
```

[编辑]

我有一个类似的问题，答案解决了这两个问题：[Raven query returns 0 results for collection contains](https://stackoverflow.com/questions/10392119/raven-query-returns-0-results-for-collection-contains/10393750#10393750)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T07:32:42.660

请注意，如果`FeedOwner`作为文档的唯一属性，查询根本没有多大意义。在这种情况下，您应该使用标准 linq to objects 在客户端上执行此操作。

现在，鉴于这`FeedOwner`不是独一无二的，您的查询基本上是正确的。但是，根据您实际想要返回的内容，您可能需要创建一个静态索引：

如果您使用动态生成的索引，那么您将始终将文档作为返回值，并且您无法获得与查询匹配的特定标签。如果这对您来说没问题，那么只需采用该方法并让查询优化器完成其工作（仅当您*确实*有很多文档预先构建索引时）。

在另一种情况下，您想使用实际标签作为查询结果，您必须预先构建一个简单的地图索引，该索引涵盖您要查询的字段，在您的示例中，这将是 FeedOwner 和每个标签的文本。您必须在要从查询中返回的字段上使用 FieldStorage.Yes，因此请在标签的 Text 属性上启用它。但是，FeedOwner 属性不需要这样做，因为它是实际文档的一部分，raven 会在任何查询结果中为您提供。请参阅 raven 文档以了解如何构建静态索引和使用字段存储。

# java - maven 无法区分不同 jar 中的两个相似类

> ID：10378490
> 
> 赞同：0
> 
> 时间：2012-04-30T04:25:54.513
> 
> 标签：java, jar, maven-3

我正在使用 Maven 3 并尝试构建一个 jar。现在有一个类存在于两个不同的依赖 jar 中。虽然接口中的方法不同，但 maven 正在尝试获取不同 jar 中类中定义的方法。那么如何确保类是从另一个 jar 中挑选出来的呢？例如，所需的类是 xyz.class，并且存在于两个不同的 jar 中：jar1：com/mycompany/xyz.class 和 jar2：com/mycompany/xyz.class但我想要 jar2 中的那个 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T04:47:39.483

This is more of a Java compilation problem than Maven. Check out the answers for: [how to load same class from different jars](https://stackoverflow.com/questions/2854056/how-to-load-same-class-from-different-jars)

You'll need to define your custom class loader for this kind of situation.

# python - 查找单词的一部分是否在 python 字典的值中

> ID：10378497
> 
> 赞同：0
> 
> 时间：2012-04-30T04:27:58.553
> 
> 标签：python, json

解析包含人名和年龄的 json 文件后，

```
{"People":
    [
        {  "name":"damon julian",
           "age":40
         }
    ]
}

data=json.load(file)
d1=data["People"][0] 
```

我有一本这样的字典

```
d1={'name':'damon julian','age':40} 
```

我想知道子字符串是否`'damon'`存在于dict中的一个值中。所以我试过了

```
[(k, v) for (k, v) in d1.iteritems() if 'damon' in v] 
```

然而，这会给出一个错误

```
TypeError: argument of type 'int' is not iterable 
```

我通过将值转换为字符串来解决这个问题

```
[(k, v) for (k, v) in d1.iteritems() if 'damon' in str(v)] 
```

我想知道是否有更好的方法来做到这一点。我转换`json data to dict`然后解析值的方法是否正确？或者是否有更好的方法 - 可能是使用正则表达式或其他东西？

请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T04:33:13.427

```
any(('damon' in v) for v in yourDict.values() if isinstance(v,str)) 
```

或者

```
any((isinstance(v,str) and 'damon' in v) for v in yourDict.values()) 
```

（请注意，这两种结构并不总是等效的）

# c# - 使用 Linq to XML 递归删除 xml 节点

> ID：10378498
> 
> 赞同：1
> 
> 时间：2012-04-30T04:28:11.527
> 
> 标签：c#, xml, linq, file-io, linq-to-xml

对 Linq to XML 相当陌生 如何删除**xml 节点**（递归使用关系）并**保存**文档。

xml 的结构无法更改，因为它来自服务。以下是来自任务服务的 xml。每个任务都可以有嵌套任务，其中可能有一个或多个嵌套任务。嵌套的目的是 upto `N level`。

*   当使用 linq to xml 删除其中一项父任务时，我如何删除它的所有子任务？

*   我如何知道成功删除的所有节点？

xml:

```
<Tasks>
  <Task ID="1">Clean the Room</Task>
  <Task ID="2">Clean the Closet</Task>
  <Task ID="3" ParentId="2">Remove the toys</Task>
  <Task ID="4" ParentId="3">Stack action Figures on Rack</Task>
  <Task ID="5" ParentId="3">Put soft toys under bed</Task>
</Tasks> 
```

在上面的xml中，当`taskId=2`被删除时，它的子任务也`Id = 3`应该被删除。由于`3`被删除，它是子任务`4`，`5`也应该被删除。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T05:37:45.567

我将假设使用 xml：

```
<Tasks> 
  <Task ID="1">Clean the Room</Task>
  <Task ID="2">Clean the Closet</Task>
  <Task ID="3" ParentId="2">Remove the toys</Task>
  <Task ID="4" ParentId="3">Stack action Figures on Rack</Task>
  <Task ID="5" ParentId="3">Put soft toys under bed</Task>

  <Task note="test node" />
  <Task ID="a" note="test node" />
</Tasks> 
```

如果`Task ID=2`被删除，这是一种解决方案：

```
// tasks = XDocument.root;

public static void RemoveTasksAndSubTasks(XElement tasks, int id)
{
  List<string> removeIDs = new List<string>();
  removeIDs.Add(id.ToString());

  while (removeIDs.Count() > 0)
  {
    // Find matching Elements to Remove
    // Check for Attribute, 
    // so we don't get Null Refereence Exception checking Value

    var matches = 
        tasks.Elements("Task")
             .Where(x => x.Attribute("ID") != null
                         && removeIDs.Contains(x.Attribute("ID").Value));

    matches.Remove();

    // Find all elements with ParentID 
    // that matches the ID of the ones removed.
    removeIDs = 
        tasks.Elements("Task")
             .Where(x => x.Attribute("ParentId") != null
                         && x.Attribute("ID") != null
                         && removeIDs.Contains(x.Attribute("ParentId").Value))
             .Select(x => x.Attribute("ID").Value)
             .ToList();

  }
} 
```

结果：

```
<Tasks> 
  <Task ID="1">Clean the Room</Task>

  <Task note="test node" />
  <Task ID="a" note="test node" />
</Tasks> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T04:38:11.183

使用以下答案

```
XDocument doc = XDocument.Load("task.xml");
var q = from node in doc.Descendants("Task")
        let attr = node.Attribute("ID")
        let parent = node.Attribute("ParentId")
        where ((attr != null && attr.Value == "3") || (parent != null && parent.Value == "3"))
        select node;
q.ToList().ForEach(x => x.Remove());
doc.Save("output.xml"); 
```

# php - 在我的机器上本地运行 PHP？

> ID：10378503
> 
> 赞同：0
> 
> 时间：2012-04-30T04:28:26.967
> 
> 标签：php

我下载了 xampp 1.7.7，它有 PHP 和 MySQL。我买了一本名为*HeadFirst PHP MySQL*的书。我的问题是我无法运行书中的示例。

示例文件由 2 个文件组成：一个 HTML 文件和一个 PHP 文件。该示例就像这样，您从 HTML 文件填写表单，然后将其发送到 Web 服务器，然后 php 将处理 HTML 文件，然后将其返回给您。

当我填写表格然后我单击提交按钮时，它没有返回它应该返回的内容。它返回的是实际的 PHP 代码。

我是否需要将书中的所有文件传输到网络主机，这样我就无法尝试我说的示例？如何在本地运行它？

更新！！
我尝试了 anselm 现在所说的 OBJECT not found... url not found 然后是 404 错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T04:32:13.637

确保您通过`http://localhost/file.html`而不是访问 html 文件`c:\etc etc.html`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T04:34:18.663

如果您在 Windows 上开发，我真的建议使用 wamp，它非常易于使用，并且包括主要的 php、mysql、apache，它非常易于安装并自动配置您可以在 c 驱动器上的 wamp 文件夹中找到 www 文件夹的所有内容你必须把你的php文件放在哪里

[http://www.wampserver.com/en/](http://www.wampserver.com/en/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-30T04:30:10.523

您的 PHP 代码没有被 PHP 解析。Apache 配置错误（不太可能因为您安装了 XAMPP，但您可以按照[http://www.php.net/manual/en/install.windows.apache2.php](http://www.php.net/manual/en/install.windows.apache2.php)上的步骤进行检查），或者您的文件不是t 真的命名`.php`。

在 Windows 中，确保您打开了文件扩展名查看，并确保文件扩展名确实是`.php`.

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-30T04:32:21.073

在您的 XAMPP 控制面板中，确保 Apache 已启动。

# javascript - 是否有可能逃脱整个形式？

> ID：10378505
> 
> 赞同：0
> 
> 时间：2012-04-30T04:28:35.650
> 
> 标签：javascript

在发布我的表单之前，我将它们序列化，在此之前我会转义需要转义的各个字段。

是否可以在发布之前转义然后序列化整个表单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T05:59:34.250

[jQuery Form Plugin](http://malsup.com/jquery/form/#api)有一些很好的数据序列化方法。即使您不想使用插件的其他功能，也可以使用它来序列化您的数据。

# html - 覆盖字体样式 - 页面的每个元素

> ID：10378523
> 
> 赞同：0
> 
> 时间：2012-04-30T04:31:29.833
> 
> 标签：html, css

我正在尝试在网络浏览器上为网页注入字体样式。

更改页面的每个元素。

```
* {
 font-size: 100%;
 font-family: Arial!important;
} 
```

在[这个问题](https://stackoverflow.com/questions/3942254/how-to-specify-font-attributes-for-all-elements-on-an-html-web-page)中几乎成功了，但这种风格被覆盖了。我也想阻止这些覆盖。使用javascript来解决也是可以的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T04:33:11.307

如果它被覆盖，请确保它是样式表中的最后一件事（或包含的最后一个样式表）。CSS 中的“级联”意味着最后一个定义获胜。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T04:55:57.873

也添加`!important`到`font-size`声明中：

```
* {
 font-size: 100% !important;
 font-family: Arial !important;
} 
```

如果您在用户样式表中使用它（正如“尝试在 Web 浏览器上为网页注入字体样式”所暗示的那样），那么您的规则不能被覆盖。

另一方面，如果这只是作者样式表的一部分，那么它可以被用户样式表覆盖，而您对此无能为力。它不会被浏览器默认样式表覆盖，因为它们不使用`!important`. 对于其他作者样式表，级联规则意味着您不能被覆盖，除非被使用的规则覆盖`!important`。

在两者都有的作者样式表规则之间的斗争中`!important`，更具体的获胜，具体由 CSS 规范精确定义。在同样特定的设置之间，最新的设置获胜。

选择器`*`具有最低可能的特异性 0,0,0,0。对于任何选择器，您始终可以构造另一个具有更高特异性的选择器。但是，元素属性内的 CSS 规则`style`被认为具有最高的特异性。

因此，如果您知道将使用哪些其他 CSS 规则，则可以通过在选择器列表中添加具有更高特异性的选择器来击败它们。

# android - 添加手势支持后Android崩溃

> ID：10378524
> 
> 赞同：0
> 
> 时间：2012-04-30T04:31:56.030
> 
> 标签：android, crash, gesture

我的应用程序运行良好，虽然没有任何功能，但由于我添加了对手势的支持（代码改编自教程），它现在只是在运行时崩溃。

```
package com.mystraldesign.memorable;

import android.app.Activity;
//import android.gesture.GestureOverlayView;
import android.gesture.GestureOverlayView;
import android.gesture.GestureOverlayView.OnGestureListener;
import android.graphics.Typeface;
import android.os.Bundle;
//import android.widget.RelativeLayout;
import android.view.GestureDetector;
import android.view.GestureDetector.OnDoubleTapListener;
import android.view.MotionEvent;
import android.view.Window;
import android.widget.TextView;

public class MemorableActivity extends Activity implements OnGestureListener,OnDoubleTapListener 
{
    //Define text views
    private TextView textView1;
    private TextView textView2;
    private TextView textView3;
    private TextView textView4;

    //Gesture Detectors
    private GestureDetector gTap; 

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);

        gTap  = new GestureDetector(this,(android.view.GestureDetector.OnGestureListener) this);

        //Remove title bar
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.main);

        //Define textView
        textView1 = (TextView) findViewById(R.id.textView1);
        textView2 = (TextView) findViewById(R.id.textView2);
        textView3 = (TextView) findViewById(R.id.textView3);
        textView4 = (TextView) findViewById(R.id.textView4);

        //Load font file
        Typeface type = Typeface.createFromAsset(getAssets(),"fonts/optima.ttf"); 

        //Set various textViews to font
        textView1.setTypeface(type);
        textView2.setTypeface(type);
        textView3.setTypeface(type);
        textView4.setTypeface(type);

    }

    public boolean onTouchEvent(MotionEvent me){ 
      this.gTap.onTouchEvent(me);
     return super.onTouchEvent(me); 
    }

    public boolean onDown(MotionEvent e) {
      textView1.setText("Down");  
      return false;
    }

    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
      float velocityY) {
        textView1.setText("Fling");
      return false;
    }

    public void onLongPress(MotionEvent e) {
        textView1.setText("Long Press"); 
    }

    public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX,
      float distanceY) {
        textView1.setText("Scroll");
     return false;
    }

    public void onShowPress(MotionEvent e) {
        textView1.setText("Show Press");
    }

    public boolean onSingleTapUp(MotionEvent e) {
        textView1.setText("Sing Tap Up");
     return false;
    }

    public boolean onDoubleTap(MotionEvent e) {
        textView1.setText("Double Tap");
     return false;
    }

    public boolean onDoubleTapEvent(MotionEvent e) {
        textView1.setText("Double Tap Event");
      return false;
    }

    public boolean onSingleTapConfirmed(MotionEvent e) {
        textView1.setText("Single Tap Confirmed");
     return false;
    }

} 
```

我从每个方法的开头删除了一个 @override 语句，因为 Eclipse 声明了它们的错误，并给出了自动修复以删除 @override 语句。

它还在该`public class MemorableActivity extends Activity implements OnGestureListener,OnDoubleTapListener`行上给出了一个错误：

```
Multiple markers at this line
    - The type MemorableActivity must implement the inherited abstract method 
     GestureOverlayView.OnGestureListener.onGestureEnded(GestureOverlayView, MotionEvent)
    - The type MemorableActivity must implement the inherited abstract method 
     GestureOverlayView.OnGestureListener.onGestureCancelled(GestureOverlayView, MotionEvent)
    - The type MemorableActivity must implement the inherited abstract method 
     GestureOverlayView.OnGestureListener.onGestureStarted(GestureOverlayView, MotionEvent)
    - The type MemorableActivity must implement the inherited abstract method 
     GestureOverlayView.OnGestureListener.onGesture(GestureOverlayView, MotionEvent) 
```

它建议修复

```
Add unimplemented methods
Make MemorableActivity abstract
Rename in file
Rename in workspace 
```

我尝试了前两个，但它仍然崩溃，我不确定第二个和第三个是/做什么。

日志中似乎没有任何内容，但这是控制台的输出

```
[2012-04-30 03:54:37 - Memorable] ------------------------------
[2012-04-30 03:54:37 - Memorable] Android Launch!
[2012-04-30 03:54:37 - Memorable] adb is running normally.
[2012-04-30 03:54:38 - Memorable] Performing com.mystraldesign.memorable.MemorableActivity activity launch
[2012-04-30 03:54:38 - Memorable] Automatic Target Mode: launching new emulator with compatible AVD 'Memorable'
[2012-04-30 03:54:38 - Memorable] Launching a new emulator with Virtual Device 'Memorable'
[2012-04-30 03:54:44 - Emulator] 2012-04-30 03:54:44.155 emulator-arm[2796:1107] Warning once: This application, or a library it uses, is using NSQuickDrawView, which has been deprecated. Apps should cease use of QuickDraw and move to Quartz.
[2012-04-30 03:54:44 - Memorable] New emulator found: emulator-5554
[2012-04-30 03:54:44 - Memorable] Waiting for HOME ('android.process.acore') to be launched...
[2012-04-30 03:55:36 - Memorable] HOME is up on device 'emulator-5554'
[2012-04-30 03:55:36 - Memorable] Uploading Memorable.apk onto device 'emulator-5554'
[2012-04-30 03:55:41 - Memorable] Installing Memorable.apk...
[2012-04-30 03:55:57 - Memorable] Success!
[2012-04-30 03:55:57 - Memorable] Starting activity com.mystraldesign.memorable.MemorableActivity on device emulator-5554
[2012-04-30 03:56:00 - Memorable] ActivityManager: Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=com.mystraldesign.memorable/.MemorableActivity } 
```

编辑：

从 Eclipse 添加日志

```
04-30 05:43:25.339: D/AndroidRuntime(333): Shutting down VM
04-30 05:43:25.339: W/dalvikvm(333): threadid=1: thread exiting with uncaught exception (group=0x40015560)
04-30 05:43:25.369: E/AndroidRuntime(333): FATAL EXCEPTION: main
04-30 05:43:25.369: E/AndroidRuntime(333): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.mystraldesign.memorable/com.mystraldesign.memorable.MemorableActivity}: java.lang.ClassCastException: com.mystraldesign.memorable.MemorableActivity
04-30 05:43:25.369: E/AndroidRuntime(333):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
04-30 05:43:25.369: E/AndroidRuntime(333):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
04-30 05:43:25.369: E/AndroidRuntime(333):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
04-30 05:43:25.369: E/AndroidRuntime(333):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
04-30 05:43:25.369: E/AndroidRuntime(333):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-30 05:43:25.369: E/AndroidRuntime(333):  at android.os.Looper.loop(Looper.java:123)
04-30 05:43:25.369: E/AndroidRuntime(333):  at android.app.ActivityThread.main(ActivityThread.java:3683)
04-30 05:43:25.369: E/AndroidRuntime(333):  at java.lang.reflect.Method.invokeNative(Native Method)
04-30 05:43:25.369: E/AndroidRuntime(333):  at java.lang.reflect.Method.invoke(Method.java:507)
04-30 05:43:25.369: E/AndroidRuntime(333):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
04-30 05:43:25.369: E/AndroidRuntime(333):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
04-30 05:43:25.369: E/AndroidRuntime(333):  at dalvik.system.NativeStart.main(Native Method)
04-30 05:43:25.369: E/AndroidRuntime(333): Caused by: java.lang.ClassCastException: com.mystraldesign.memorable.MemorableActivity
04-30 05:43:25.369: E/AndroidRuntime(333):  at com.mystraldesign.memorable.MemorableActivity.onCreate(MemorableActivity.java:33)
04-30 05:43:25.369: E/AndroidRuntime(333):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-30 05:43:25.369: E/AndroidRuntime(333):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
04-30 05:43:25.369: E/AndroidRuntime(333):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T04:51:26.763

您正在实现一种类型`OnGestureListener`但转换为另一种类型。将您的 Activity 类语句更改为：

```
public class MemorableActivity extends Activity implements android.view.GestureDetector.OnGestureListener,OnDoubleTapListener 
```

然后实施必要的方法，您的崩溃应该停止发生。

# php - PHP mySQL 结果数组 - 当行的 id 保持不变时做某事，当行的 id 更改继续时

> ID：10378533
> 
> 赞同：0
> 
> 时间：2012-04-30T04:33:58.883
> 
> 标签：php, mysql

我有一个查询，它正在数据库中搜索订单。我的 SQL 查询返回以订单 ID 为键的订单信息（对于具有多个产品的订单，该 ID 重复）和附加到订单信息的订单信息，包括产品数量和变化。

该查询连接了几个表并输出如下

```
|--orderid--|--orderstatus--|--ordcustid--|--orderprodname--|--orderprodqty--|--orderqty--|
|---12635---|-----11--------|-----4192----|----Product1-----|--------1-------|-----2------|
|---12635---|-----11--------|-----4192----|----Product2-----|--------1-------|-----2------|
|---12636---|-----11--------|-----3531----|----Product3-----|--------1-------|-----1------| 
```

正如你在上面看到的。客户 4192 下了 1 个包含 2 个产品的订单 (orderid 12635)。客户 3531 下了 1 个包含 1 个产品的订单（orderid 12636）。

我想捕获每个订单的信息并将其放在一起。因此，虽然订单 ID 相同，但我正在收集信息。

我当前的脚本看起来像这样，但它只适用于每一行。

```
$result = mysql_query(" 
    SELECT * 
    FROM  orders, orderproducts, productimage, customers
    WHERE orders.orderid = orderproducts.orderorderid
    AND orderproducts.orderprodid = productimage.imageprodid
    AND orders.ordcustid = customers.customerid
    AND ordstatus = '11'
    ORDER BY orderid
");

while($row = mysql_fetch_array($result))
  {
//do stuff
} 
```

该脚本的目的是邮寄每个订单的信息。我当前的脚本正在做的是为每个产品邮寄客户（即客户 4192 将收到两封单独的电子邮件 - 1 封用于 Product1，1 封用于 Product2）。我想要做的是在同一封电子邮件中使用两种产品向客户 4192 发送电子邮件。

如何改进我的脚本，以便在 orderid 相同时，它将从 orderid 相同的所有行（例如 orderproductname、qty ）获取信息，然后在 order id 更改时继续。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T04:37:12.443

跟踪您使用的 orderID，并建立电子邮件，直到 orderID 更改。当它发生时，您发送电子邮件，并为新订单开始新的电子邮件。例如

```
$cur_order = null;
$order_data = array();
while($row = mysql_fetch_assoc($result)) {
   if ($cur_order !== $row['orderid']) {
      sendOrderEmail($order_data);
      $cur_order = $row['orderid'];
      $order_data = array();
   }
   $order_data[] = $row;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T04:37:21.340

尝试在循环之前添加这段代码：

```
 $last_id = 0; 
```

在你的 while() 循环中：

```
 if ( $last_id != $row['orderid'] ) {
      // New Order - do some initiation stuff
      $last_id = $row['orderid'];
 } else {
      // Continuing the current order - do some different stuff
 } 
```

这是代码：

```
$result = mysql_query(" 
    SELECT * 
    FROM  orders, orderproducts, productimage, customers
    WHERE orders.orderid = orderproducts.orderorderid
    AND orderproducts.orderprodid = productimage.imageprodid
    AND orders.ordcustid = customers.customerid
    AND ordstatus = '11'
    ORDER BY orderid
");

$last_id = 0;
while($row = mysql_fetch_array($result)) {
    if ( $last_id != $row['orderid'] ){
        // Initiate a new order

        $message_body = ''; // Reset message body for each order
        $last_id = $row['orderid']; // Keep track of the orderid last used
        if ( $last_id > 0 ){
            // Make certain we didn't just begin the loop, then email the customer

            echo "SAMPLE MESSAGE BODY FOR ORDER $last_id <br/>\r\n";
            echo $message_body;

            // Uncomment following lines to send an email
            // $headers = $headers = 'From: My Store <info@mystore.com>\r\nContent-Type: text/html; charset=ISO-8859-1\r\n";
            // $success = mail( 'customer@email.com', 'Order Confirmation', $message_body, $headers);

        }
    } else {
        // Step through current order

        // Add a line to the message body for each product record
        $message_body .= "Product {$row['orderprodname']}, Qty: {$row['orderprodqty']} <br/>\r\n";
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T04:41:31.287

我认为最好的选择是`group_concat of product names`在查询本身中使用。例如 ，

```
SELECT *,group_concat(orderprodname) 
    FROM  orders, orderproducts, productimage, customers
    WHERE orders.orderid = orderproducts.orderorderid
    AND orderproducts.orderprodid = productimage.imageprodid
    AND orders.ordcustid = customers.customerid
    AND ordstatus = '11' group by orderid
    ORDER BY orderid 
```

因此您可以在特定订单的列中以逗号分隔产品名称

# javascript - mongodb/mongoose：每天的最小值

> ID：10378535
> 
> 赞同：0
> 
> 时间：2012-04-30T04:34:18.430
> 
> 标签：javascript, mongodb, mongoose

在我的 mongodb 中，每天都会保存几次 measure_data (measured_at, value)。有人知道如何用猫鼬找到每天的最低值吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:02:59.300

据我所知，在 mongodb 中并没有真正的好方法，您必须在客户端执行此操作。基本上抓住所有的值，排序，取最低的一个。

如果性能是一个问题，只需在您的猫鼬模型上创建一个名为 min_measured_data 的新属性。然后，您可以使用 mongoose 钩预“保存”并将任何新测量数据与最小值进行比较。如果小于最小值，则相应地更新 min_measured_data。这样，每当您需要读取此属性时，它将是 O(1)，而不必每次都重做排序。

# python - 用于解析程序中标识符的 Python 包（C、Scala、Lisp）？

> ID：10378539
> 
> 赞同：1
> 
> 时间：2012-04-30T04:34:29.740
> 
> 标签：python, c, parsing, scala, lisp

在标题中，我提到了 3 种不同的语言，我想在其中找出是否存在 python 包，它可以为我提供其中任何一种程序的标识符列表；所以不必全部三个，因为我怀疑会有一个这样的。所以我的问题是python中是否存在一个函数或类，它允许我获得一个语言中特定程序的标识符列表，最好是我在标题中列出的3个中的一个。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T13:52:33.363

有[pycparser](http://code.google.com/p/pycparser/)，您可以使用它从代码生成 C AST，然后遍历它以获得您想要的任何内容。

Python 中有[一个简单的 lisp 解释器](http://norvig.com/lispy.html)，您应该可以从中删除解析器。

而且我怀疑 Scala 是否有任何类似且现成的东西，但您可以使用[ply](http://www.google.com.br/url?sa=t&rct=j&q=ply&source=web&cd=1&ved=0CDMQFjAA&url=http://www.dabeaz.com/ply/&ei=mJieT7aqE5Ki8QS7yq2nDw&usg=AFQjCNHv-eylAV812hDOEVG2GLTa0AOZyA)之类的东西来制作解析器。这不会那么容易，但会做到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T11:51:57.160

一般来说，如果没有几乎完整的语言实现，这是不可能的。

C 中有一个基本的预处理器，它可以允许从临时扫描中屏蔽函数声明。Lisp 中有一个强大的元编程，这意味着您只能使用功能齐全的 Lisp 编译器来提取定义，简单的解析根本无济于事。

Scala 是这三个中最简单的，但它的语法仍然过于臃肿，您至少需要一个完整的解析器。Python 几乎不是以任何方式做这类事情的正确工具。

# javascript - 在 JavaScript 中删除最后一个逗号之前的文本

> ID：10378541
> 
> 赞同：2
> 
> 时间：2012-04-30T04:34:36.220
> 
> 标签：javascript, jquery, comma

假设我有一个字符串“cats,dogs,bun,bunnies”，其中兔子是通过自动完成附加的。当然，我希望“bun”被兔子取代。

那么如何删除最后一个逗号之前的文本但保留其他所有内容？所以字符串将是“cats,dogs,bunnies”

编辑

基本上，如果倒数第二项包含在最后一项的第一部分中，则应将其删除。

谢谢！法尔科

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T04:48:49.030

你的意思是：

```
 var str = "cats,dogs,bun,bunnies";
var arr = str.split(",");   
arr.splice((arr.length  - 2) ,1);
arr.join(",");
console.log(arr); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T04:53:06.207

这是一种方法。您也可以使用正则表达式。

```
sList = "cats,dogs,bun,bunnies".split(",");
num = sList.length;
if (sList[num-1].search(sList[num-2]) != -1) {
  sList.splice(-2, 1);
}
required = sList.join(','); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T04:45:20.470

不确定这是否可行，但有两种方法：

```
// Array splice
text = text.split(',')
text.splice(-2, 1)
text = text.join(',')

// regular expression
text.replace(/\w+,([^,]+)$/, '$1') 
```

[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T05:55:06.717

```
 var s="cats,dogs,bunnies"
  var str = s.split(',').reverse();

  str.splice(1,1);
  s=str.join(',') 
```

# ios5 - XCode 无法识别我的 iPhone

> ID：10378543
> 
> 赞同：0
> 
> 时间：2012-04-30T04:35:01.960
> 
> 标签：ios5, xcode4.2, ios5.1

XCode 仅在一天前识别了我的设备，但现在它没有。我在下面的组织者中收到错误。我知道还有很多其他类似的问题，但没有一个回答我的问题。我看不到“**用于开发**”按钮，**添加到门户**也无法解决问题。 **当 5.1 到来时我已经升级了设备并且能够使用该设备进行测试但不知道昨天发生了什么并且它停止识别该设备。**

```
The version of iOS on “Adil Muhammad’s iPhone” does not match any of the versions of iOS supported for development with this installation of the iOS SDK. Please restore the device to a version of the OS listed below, or update to the latest version of the iOS SDK; which is available here.

OS Installed on Adil Muhammad’s iPhone
5.1 (9B176)

Xcode Supported iOS Versions
Latest
5.0 (9A334)
4.3
4.2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T04:41:17.100

you updated your phone, so you need the latest xcode installed to now develop apps on your dev phone

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T04:44:10.213

As your Device ios version is higher than what your xcode support.

Upgrade you xcode with the latest one (xcode 4.3).

This is the only Resason Regards, neil.

# objective-c - 有人可以向我解释这里发生了什么吗？

> ID：10378553
> 
> 赞同：1
> 
> 时间：2012-04-30T04:36:40.827
> 
> 标签：objective-c, ios, three20

我将粘贴下面的代码，然后告诉你我试图从代码中确定什么。

**如果您正在快速阅读本文，请从下一个代码块正上方的文本开始。**

```
- (void)tableViewDidLoadModel:(UITableView*)tableView {
self.items = [NSMutableArray array];
self.sections = [NSMutableArray array];

NSMutableDictionary *groups = [NSMutableDictionary dictionary];

for (int c = 0;c < [_contacts.people count];c++) {
    NSDictionary *person = [_contacts.people objectAtIndex:c];
    NSString *name = [person objectForKey:@"fullName"];
    NSString *letter = [name substringToIndex:1];
    NSMutableArray *section = [groups objectForKey:letter];
    NSLog(@"%@ - %@ - %@", name, [person objectForKey:@"index"], [person objectForKey:@"abId"]);
    if (!section) {
        section = [NSMutableArray array];
        [groups setObject:section forKey:letter];
    }

    TTTableItem *item = [ttItem itemWithText:name URL:[person objectForKey:@"index"]];
    [section addObject:item];
} 
```

其他人编写了这段代码。据我所知，他们正在尝试获取用户的联系人并填写`TableView`.

现在我真正的问题与最后一行有关：

```
TTTableItem *item = [ttItem itemWithText:name URL:[person objectForKey:@"index"]];
    [section addObject:item]; 
```

这是使用 Three20 框架。显然，以前的开发人员所做的是用来`TTTableItem`获得一个预先格式化的`UITableViewCell`. （希望我想对了吗？）我需要用正常的代码替换这行代码。我想过只使用`UITableViewCell`，但除此之外我不确定如何开始？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T04:49:25.213

`-tableViewDidLoadModel:`是一个来自 TTTableViewDataSource 协议的方法，所以如果你想从你的项目中删除 Three20，你要做的不仅仅是替换 TTTableItem。

[TTTableItem](http://api.Three20.info/interface_t_t_table_item.php)是 NSObject 的子类，它似乎唯一添加的是一个`userInfo`属性。要摆脱它，您可以从创建自己的具有相同属性的类开始。

# php - 基于表单数据的表单提交重定向

> ID：10378558
> 
> 赞同：0
> 
> 时间：2012-04-30T04:37:26.723
> 
> 标签：php, javascript, forms

是否可以根据他们在表单中的输入将某人重定向到新页面？基本上，在这个统计网络应用程序上，当有人在搜索框中输入用户名并点击提交时，我希望他们被发送到 domain.com/username_input （本质上，该表单仅用于允许某人输入用户名，它不会被发送到任何地方）。

不确定这在 HTML+PHP 中是否可行，或者是否最好用 JavaScript 来完成（也就是说，如果有可能的话）

我觉得 javascript 重定向或更改标头位置有点不确定。在这种情况下，更改标题位置无论如何都不起作用。

我试过：

```
<input id="submit" value="Submit" type="submit" onclick="window.location = window.location + '/' + string.value; return false;"/> 
```

但我被发送到 domain.com/?string=form_input

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T04:40:11.850

在提交按钮上带有重定向的 javascript 可以工作。

```
<form name="f" onsubmit="javascript:redirect()">
    First name: <input type="text" name="fname">
    <input type="submit" value="Submit">
</form>

function validateForm()
{
    var x=document.forms["f"]["fname"].value;
    window.location = "http://www.page.com/"+x
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T04:47:14.840

```
var form = document.redirect; //access the form
document.onsubmit = function(){
    var username = form.username.value; //get username
    form.action = username + "_input";
    return true; // go to page.
}; 
```

JSFiddle：http: [//jsfiddle.net/TbQWC/2/](http://jsfiddle.net/TbQWC/2/)

​</p>

# android - Android, Video Recorder, what is the reason of application lost the surface?

> ID：10378562
> 
> 赞同：2
> 
> 时间：2012-04-30T04:37:57.057
> 
> 标签：android, video, camera, record

In my application I need to have live streaming (music), buffer it and when it is finished, play it and capture video (video together with music which is playing, something like Karaoke). the problem is When I run the application, Log cat shows me following messages. what is the reason of application lost the surface?

```
 05-05 15:43:48.929: D/MediaRecorder(4745): doCleanUp
05-05 15:43:49.519: E/MediaRecorderJNI(4745): Application lost the surface
05-05 15:43:49.542: D/***VideoRecording***(4745): IOException preparing MediaRecorder: invalid preview surface
05-05 15:43:49.542: D/***VideoRecording***(4745): java.io.IOException: invalid preview surface
05-05 15:43:49.542: D/***VideoRecording***(4745):   at android.media.MediaRecorder._prepare(Native Method)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at android.media.MediaRecorder.prepare(MediaRecorder.java:591)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at com.astro.mania.activities.VideoRecording.prepareVideoRecorder(VideoRecording.java:340)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at com.astro.mania.activities.VideoRecording.onCreate(VideoRecording.java:161)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at android.app.ActivityThread.access$1500(ActivityThread.java:117)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at android.os.Handler.dispatchMessage(Handler.java:99)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at android.os.Looper.loop(Looper.java:123)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at android.app.ActivityThread.main(ActivityThread.java:3687)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at java.lang.reflect.Method.invokeNative(Native Method)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at java.lang.reflect.Method.invoke(Method.java:507)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
05-05 15:43:49.542: D/***VideoRecording***(4745):   at dalvik.system.NativeStart.main(Native Method)
05-05 15:43:49.562: D/MediaRecorder(4745): reset:E
05-05 15:43:49.562: D/MediaRecorder(4745): doCleanUp
05-05 15:43:49.562: D/MediaRecorder(4745): doReset:E
05-05 15:43:49.578: D/MediaRecorder(4745): doReset:X
05-05 15:43:49.578: D/MediaRecorder(4745): close
05-05 15:43:49.582: D/MediaRecorder(4745): reset:X
05-05 15:43:49.582: D/MediaRecorder(4745): release:E 
```

My CamcorderView calss is:

```
public class CamcorderView extends SurfaceView implements SurfaceHolder.Callback{

    private SurfaceHolder mHolder;
    private Camera mCamera;

    //Create constructor of Preview Class. In this, get an object of
    //surfaceHolder class by calling getHolder() method. After that add
    //callback to the surfaceHolder. The callback will inform when surface is
    //created/changed/destroyed. Also set surface not to have its own buffers.

    public CamcorderView(Context context, Camera camera) {
        super(context);
        mCamera = camera;

        // Install a SurfaceHolder.Callback so we get notified when the
        // underlying surface is created and destroyed.
        mHolder = getHolder();
        mHolder.addCallback(this);
        // deprecated setting, but required on Android versions prior to 3.0
        mHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
     }

    // Implement the methods of SurfaceHolder.Callback interface
    // SurfaceCreated : This method gets called when surface is created.
    public void surfaceCreated(SurfaceHolder holder) {
        // The Surface has been created, now tell the camera where to draw the preview.
        try {
            mCamera.setPreviewDisplay(holder);
            mCamera.startPreview();
        } catch (IOException e) {
            Log.e("Error in CamcorderView", "Error setting camera preview: " + e.getMessage(), e);
        }
    }

    public void surfaceDestroyed(SurfaceHolder holder) {
        // empty. Take care of releasing the Camera preview in your activity.
    }

    public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) {
        // If your preview can change or rotate, take care of those events here.
        // Make sure to stop the preview before resizing or reformatting it.

        if (mHolder.getSurface() == null){
          // preview surface does not exist
          return;
        }

        // stop preview before making changes
        try {
            mCamera.stopPreview();
        } catch (Exception e){
          // ignore: tried to stop a non-existent preview
        }

        // set preview size and make any resize, rotate or reformatting changes here
        // start preview with new settings
        try {
            mCamera.setPreviewDisplay(mHolder);
            mCamera.startPreview();
        } catch (Exception e){
            Log.e("Error>>>>>", "Error starting camera preview: " + e.getMessage(), e);
        }
    }
} 
```

and Video recording class:

```
public class VideoRecording extends Activity implements OnBufferingUpdateListener, OnCompletionListener, OnPreparedListener {

    private static final String TAG           = "***VideoRecording***";
    private static final int MEDIA_TYPE_VIDEO = 1;
    private static final String MEDIA_NAME    = "Mania-Karaoke";
    private static final String VIDEO_FORMAT  = ".mp4";
    private static final String AUDIO_SOURCE  = "http://www.hrupin.com/wp-content/uploads/mp3/testsong_20_sec.mp3";
//  private static String AUDIO_SOURCE;

    private boolean mIsMusicReadyToBePlayed = false;
    private boolean mIsMusicPrepared = false;

    private String fileUri; //Holds the address of current video which is capturing
    private Camera mCamera;
    private CamcorderView preview;

    private MediaRecorder mMediaRecorder = null;
    private boolean isRecording = false;
    private boolean isAudioPlayerReady = false;
    private boolean isVideoRecorderReady = false;

    private MediaPlayer mediaPlayer = null;

    private ImageView stopButton;
    private ImageView captureButton;
    private ImageView imHide;
    private RelativeLayout rlMenu;
    private TextView tvInfo;

    private Handler mHandler;
    private Runnable mUpdateUITimerTask;

    private int elapsedTime = 0;
    private DecimalFormat df;

    private Animation animation;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_camcorder_preview);

        Log.i(TAG, "VideoRecording activity started...");

        Bundle extras = getIntent().getExtras();
        if (extras == null) {
            return;
        }
//      AUDIO_SOURCE = extras.getString("SONG_URL");
        Log.i(TAG, "Music comes from: " + AUDIO_SOURCE);

        // Close activity if there is no camera
        if(!checkCameraHardware(VideoRecording.this)){
            Toast.makeText(VideoRecording.this, "Sorry! Your device doesn't have camera.", Toast.LENGTH_LONG).show();
            VideoRecording.this.finish();
        }

        // Create an instance of Camera
        mCamera = getCameraInstance();
        if(mCamera == null){
            Toast.makeText(VideoRecording.this, "Oops! Your device doesn't have camera or it's in use.", Toast.LENGTH_LONG).show();
            releaseCamera();
            VideoRecording.this.finish();
        }

        // Initialize Animation, setting alpha of button view 0 and 1 in order to blink the button
        recordAnimation();

        // Set volume button of mobile device to increase/decrease sound instead of ringtone 
        setVolumeControlStream(AudioManager.STREAM_MUSIC);

        tvInfo = (TextView) findViewById(R.id.tv_info);
        df = new DecimalFormat("#.##");

        mHandler = new Handler();
        mUpdateUITimerTask = new Runnable() {
            public void run() {
                elapsedTime++;

                int hours = elapsedTime / 3600;
                int remainder = elapsedTime - hours * 3600;
                int mins = remainder / 60;
                remainder = remainder - mins * 60;
                int secs = remainder;

                File file = new File(getOutputMediaFileUri());
                float fileSize = file.length();

                if(fileSize <= 1024)
                    tvInfo.setText("E.T: " + hours + ":" + mins + ":" + secs + " / " + df.format(fileSize));
                else if((fileSize > 1024) && (fileSize <= 1024*1024)){
                    fileSize /= 1024;
                    tvInfo.setText("E.T: " + hours + ":" + mins + ":" + secs + " / " + df.format(fileSize) + " K");
                } else if((fileSize > 1024*1024) && (fileSize <= 1024*1024*1024)){
                    fileSize /= 1024*1024;
                    tvInfo.setText("E.T: " + hours + ":" + mins + ":" + secs + " / " + df.format(fileSize) + " M");
                } else{
                    fileSize /= 1024*1024*1024;
                    tvInfo.setText("E.T: " + hours + ":" + mins + ":" + secs + " / " + df.format(fileSize) + " G");
                }

//              Log.i(TAG, " " + elapsedTime + " / " + fileSize + " : " + fileUri.toString());

                mHandler.postDelayed(mUpdateUITimerTask, 1000);
            }
        };

        // Create our Preview view and set it as the content of our activity.
        preview = new CamcorderView(this, mCamera);
        FrameLayout flPreview = (FrameLayout) findViewById(R.id.camera_preview);
        flPreview.addView(preview);

        // initialize media player
        isAudioPlayerReady   = prepareAudioPlayer();
        isVideoRecorderReady = prepareVideoRecorder();

        // Add a listener to the Capture button
        captureButton = (ImageView) findViewById(R.id.btn_record);
        captureButton.setVisibility(View.INVISIBLE);
        captureButton.setOnClickListener(new View.OnClickListener() {
                @Override
                public void onClick(View v) {   
                    captureButton.setEnabled(false);
                    stopButton.setEnabled(true);

                    if (!isRecording) {

                        // initialize video camera
                        if (isAudioPlayerReady && isVideoRecorderReady) {
                            // Play background music
                            startMusicPlayback();

                            // Camera is available and unlocked, MediaRecorder is prepared,
                            // now you can start recording
                            mMediaRecorder.start();

                            // inform the user that recording has started
                            Toast.makeText(VideoRecording.this, "Video recording started", Toast.LENGTH_LONG).show();
                            isRecording = true;

                            captureButton.startAnimation(animation);

                            // Try to call handller each one second to update elapse time on screen
                            mHandler.postDelayed(mUpdateUITimerTask, 1000);
                        } 
                    }
                }
        });

        stopButton = (ImageView) findViewById(R.id.btn_stop);
        stopButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                captureButton.setEnabled(true);
                stopButton.setEnabled(false);

                if (isRecording) {
                    // stop recording and release camera
                    pauseMusicPlayback();

//                    mCamera.lock();         // take camera access back from MediaRecorder

                    // inform the user that recording has stopped
                    Toast.makeText(VideoRecording.this, "Video recording stopped", Toast.LENGTH_LONG).show();
                    isRecording = false;

                    captureButton.clearAnimation();

                    // Try to stop handller
                    elapsedTime = 0;
                    mHandler.removeCallbacks(mUpdateUITimerTask);
                }
            }
        });

        Button btnDone = (Button) findViewById(R.id.btn_done);
        btnDone.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                VideoRecording.this.finish();
            }
        });

        rlMenu = (RelativeLayout) findViewById(R.id.rlMenu);
        imHide  = (ImageView) findViewById(R.id.btn_hide);
        imHide.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                rlMenu.setVisibility(View.INVISIBLE);
            }
        });
    }

    @Override
    protected void onPause() {
        super.onPause();

        Log.i(TAG, "onPause called");

        // Reset Audio manager to stream ring when user pushes volume button
        setVolumeControlStream(AudioManager.STREAM_RING);

        releaseMediaRecorder();       // if you are using MediaRecorder, release it first
        releaseCamera();              // release the camera immediately on pause event

        releaseMediaPlayer();

        elapsedTime = 0;
        mHandler.removeCallbacks(mUpdateUITimerTask);

        captureButton.clearAnimation();

        // Closing the activity
        VideoRecording.this.finish();

        Log.i(TAG, "All resources are released from memory in onPause() method.");
    }   

    public void onBufferingUpdate(MediaPlayer arg0, int percent) {
        if(percent <= 99)
            Log.i(TAG, "onBufferingUpdate percent:" + percent);
        else {
            captureButton.setVisibility(View.VISIBLE);
            mIsMusicReadyToBePlayed = true;
        }
    }

    public void onCompletion(MediaPlayer arg0) {
        Log.i(TAG, "onCompletion called");
    }

    public void onPrepared(MediaPlayer mediaplayer) {
        Log.i(TAG, "onPrepared called");

        mIsMusicPrepared = true;
    }

    private void startMusicPlayback() {
        Log.i(TAG, "startMusicPlayback called");

        if(mIsMusicReadyToBePlayed && mIsMusicPrepared) {
            if(!mediaPlayer.isPlaying()) {
                mediaPlayer.seekTo(0);
                mediaPlayer.start();
            }
        }
    }

    private void pauseMusicPlayback() {
        Log.i(TAG, "pauseMusicPlayback called");

        if(mediaPlayer.isPlaying())
            mediaPlayer.pause();
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {

        rlMenu.setVisibility(View.VISIBLE);

        return super.onTouchEvent(event);
    }

    private boolean prepareVideoRecorder(){

        mMediaRecorder = new MediaRecorder();

        // Step 1: Unlock and set camera to MediaRecorder
        mCamera.unlock();
        mMediaRecorder.setCamera(mCamera);

        // Step 2: Set sources
        mMediaRecorder.setAudioSource(MediaRecorder.AudioSource.CAMCORDER);
        mMediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);

//      // Step *: Optional settings
//      mMediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);

        // Step 3: Set a CamcorderProfile (requires API Level 8 or higher)
        mMediaRecorder.setProfile(CamcorderProfile.get(CamcorderProfile.QUALITY_HIGH));

        // Step 4: Set output file
        mMediaRecorder.setOutputFile(getOutputMediaFile(MEDIA_TYPE_VIDEO).toString());

        // Step 5: Set the preview output
        mMediaRecorder.setPreviewDisplay(preview.getHolder().getSurface());     

        // Step 7: Prepare configured MediaRecorder
        try {
            mMediaRecorder.prepare();
            Log.i(TAG, "Media Recorder prepared successfully.");
        } catch (IllegalStateException e) {
            Log.e(TAG, "IllegalStateException preparing MediaRecorder: " + e.getMessage(), e);
            releaseMediaRecorder();
            return false;
        } catch (IOException e) {
            Log.d(TAG, "IOException preparing MediaRecorder: " + e.getMessage(), e);
            releaseMediaRecorder();
            return false;
        }

        // Optional settings
//      mMediaRecorder.setVideoEncodingBitRate();
//      mMediaRecorder.setVideoSize();
//      mMediaRecorder.setVideoFrameRate();
//      mMediaRecorder.setAudioEncodingBitRate();
//      mMediaRecorder.setAudioChannels();
//      mMediaRecorder.setAudioSamplingRate();

        return true;
    }

    private boolean prepareAudioPlayer() {
        boolean flag = false;

        // Create a new media player and set the listeners       
        mediaPlayer = new MediaPlayer();

        try {
            mediaPlayer.setDataSource(AUDIO_SOURCE);
            mediaPlayer.prepare();
            mediaPlayer.setOnBufferingUpdateListener(this);
            mediaPlayer.setOnCompletionListener(this);
            mediaPlayer.setOnPreparedListener(this);
            mediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);

            flag = true;    
            Log.i(TAG, "Media Player prepared successfully.");
        } catch (IllegalArgumentException e) {
            Log.e(TAG, "Media Player did not prepare successfully.");
            Log.e(TAG, "IllegalArgumentException > " + e.getMessage(), e);
        } catch (IllegalStateException e) {
            Log.e(TAG, "Media Player did not prepare successfully.");
            Log.e(TAG, "IllegalStateException > " + e.getMessage(), e);
        } catch (IOException e) {
            Log.e(TAG, "Media Player did not prepare successfully.");
            Log.e(TAG, "IOException > " + e.getMessage(), e);
        }

        return flag;
    }

    /** Create a file Uri for saving an image or video */
    private String getOutputMediaFileUri(){
          return fileUri;
    }

    /** Create a File for saving an image or video */
    private File getOutputMediaFile(int type) {
        // To be safe, you should check that the SDCard is mounted
        // using Environment.getExternalStorageState() before doing this.
        File mediaStorageDir = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_MOVIES), MEDIA_NAME);
        // This location works best if you want the created images to be shared
        // between applications and persist after your app has been uninstalled.

        // Create the storage directory if it does not exist
        if (! mediaStorageDir.exists()){
            if (! mediaStorageDir.mkdirs()){
                Log.e(MEDIA_NAME, "failed to create directory");
                Toast.makeText(VideoRecording.this, "SD Card not found!", Toast.LENGTH_LONG).show();
                return null;
            }
        }

        // Create a media file name
        String timeStamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());
        File mediaFile;
        if (type == MEDIA_TYPE_VIDEO){
            mediaFile = new File(mediaStorageDir.getPath() + File.separator + MEDIA_NAME + "_"+ timeStamp + VIDEO_FORMAT); // or .mp4
            fileUri = mediaFile.toString();
        } else {
            return null;
        }

        return mediaFile;
    }

    private void releaseMediaRecorder() {
        if (mMediaRecorder != null) {
            mMediaRecorder.reset();   // clear recorder configuration
            mMediaRecorder.release(); // release the recorder object
            mMediaRecorder = null;
            mCamera.lock();           // lock camera for later use

            Log.i(TAG, "Media Recorder released successfully.");
        }
    }

    private void releaseCamera() {
        if (mCamera != null){
            mCamera.release();        // release the camera for other applications
            mCamera = null;

            Log.i(TAG, "Camera released successfully.");
        }
    }

    /** A safe way to get an instance of the Camera object. */
    public Camera getCameraInstance() {
        Camera c = null;
        try {
            c = Camera.open(); // attempt to get a Camera instance
        } catch (Exception e){
            // Camera is not available (in use or does not exist)
            Toast.makeText(VideoRecording.this, "Sorry! Your device doesn't have camera or it's in use.", Toast.LENGTH_LONG).show();
        }
        return c; // returns null if camera is unavailable
    }

    /** Check if this device has a camera */
    private boolean checkCameraHardware(Context context) {
        if (context.getPackageManager().hasSystemFeature(PackageManager.FEATURE_CAMERA)){
            // this device has a camera
            return true;
        } else {
            // no camera on this device
            return false;
        }
    }

    private void releaseMediaPlayer() {
        if(mediaPlayer != null) {
            mediaPlayer.release();
            mediaPlayer = null;

            Log.i(TAG, "Media Player released successfully.");
        }
    }

    private void recordAnimation(){
        animation = new AlphaAnimation(1, 0); // Change alpha from fully visible to invisible
        animation.setDuration(500); // duration - half a second
        animation.setInterpolator(new LinearInterpolator()); // do not alter animation rate
        animation.setRepeatCount(Animation.INFINITE); // Repeat animation infinitely
        animation.setRepeatMode(Animation.REVERSE); // Reverse animation at the end so the button will fade back in
    } 
```

}

# iphone - App crashes on Database Creation attempt

> ID：10378564
> 
> 赞同：11
> 
> 时间：2012-04-30T04:38:20.943
> 
> 标签：iphone, database, sqlite

I created an sql database using "SQLite Database Browser", dragged and dropped it into my Xcode project, and built the app. It works perfectly well on the Simulator but crashes on the iPhone, with this error:

```
*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', 
 reason: 'Failed to create writable database file with message 'The operation could‚ 
not be completed. (Cocoa error 260.)'.' 
```

Here's my code:

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Creates a writable copy of the bundled default database in the application Documents directory:
    NSLog(@"AppDelegate...Looking for embedded Database file...");
    BOOL success;
    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSError *error;
    // Grab the path to the Documents folder:
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *writableDBPath = [documentsDirectory stringByAppendingPathComponent:@"users.sql"];

    success = [fileManager fileExistsAtPath:writableDBPath];
    if (success) {
        NSLog(@"Database File Exists in Documents folder!");
        NSLog(@"Its path is: %@", writableDBPath);
        return YES;
    }
    else {
    // But if the writable database does not exist, copy the default to the appropriate location.
    NSLog(@"!!NO Database File Exists in Documents folder!");
    NSString *defaultDBPath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"users.sql"];
    success = [fileManager copyItemAtPath:defaultDBPath toPath:writableDBPath error:&error];
    if (!success) {
        NSAssert1(0, @"Failed to create writable database file with message '%@'.", [error localizedDescription]);
    }
    else 
        NSLog(@"WROTE THE DATABASE FILE!!!");
}

return YES;
} 
```

Again, this works on the Simulator, but not on the iPhone. (This couldn't possible have anything to do with the file have a ".sql" extension as opposed to a ".sqlite" extension, could it? Cause that's the extensions that "SQLite Database Browser" gives the files it creates...)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-30T13:03:03.933

答案与确保正确设置 sql 文件的“目标成员资格”有关，以便项目“看到”它：

1）点击Xcode左侧窗格中的sql文件

2）打开/显示文件检查器（右窗格）

3）在“目标会员”下，确保“检查”是“检查”

而已。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-21T12:11:57.140

![在此处输入图像描述](../Images/8237e6bdd2b27e4be41acb0bedb7e69a.png)

该解决方案解决了我的问题，希望对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-02T06:11:50.953

在我的问题中：检查这一行：

```
NSString *writableDBPath = [documentsDirectory stringByAppendingPathComponent:@"users.sql"] 
```

检查您的包和代码中的文件名 - 错误也与不同的文件名有关。

# ios - PhoneGap / Cordova + ChildBrowser Open In

> ID：10378568
> 
> 赞同：1
> 
> 时间：2012-04-30T04:39:03.580
> 
> 标签：ios, cordova

I have the latest ChildBrowser for iOS on phone gap 1.4.1 running.. it works perfectly except the share button in the top right corner that opens the "Open In.." menu lists everything but Safari. (it lists iBooks, Kindle...)

I'm no ObjC developer, can anyone tell me how I can tweak that list? I want it to only show Safari as an option.

# html - To show number of alerts/mails/messages a user has got when he logs in. Ajax, Jquery, Struts 2

> ID：10378569
> 
> 赞同：0
> 
> 时间：2012-04-30T04:39:20.757
> 
> 标签：html, ajax, jquery-ui, jquery

I am using Struts2 and Jquery tags. I want to show the user the number of Alert messages that he has received once he logs in. I am using a button to go to inbox. The list of messages comes from Struts action class. on this button at the corner or on the button itself(with change of font or color) I want to show the number of unread messages or alert messages that user has received.
Thanks in anticipation of the help.

# java - 如何用适当的错误消息替换强制关闭屏幕。

> ID：10378571
> 
> 赞同：2
> 
> 时间：2012-04-30T04:39:43.357
> 
> 标签：java, android

如何用对话框和适当的错误消息替换强制关闭屏幕？谁能帮我摆脱困境？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T04:47:57.140

强制关闭屏幕是 Android 的默认显示，它指示您的代码中发生了未处理的错误或异常：您无法覆盖它，防止它的唯一方法是找出并实际处理异常发生在您的代码中。

如果您需要帮助调试以确定实际的异常或错误是什么，请查看[调试指南](http://developer.android.com/guide/developing/debugging/index.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T04:58:00.343

使用 Thread.setDefaultUncaughtExceptionHandler()。

# matlab - Matlab：根据索引和维度设置值

> ID：10378572
> 
> 赞同：1
> 
> 时间：2012-04-30T04:39:52.633
> 
> 标签：matlab, matrix, indexing, set, dimension

我有一个矩阵如下。

```
octave:63> a
a =

ans(:,:,1) =

   0.411710   0.947670
   0.068291   0.368340

ans(:,:,2) =

   0.27178   0.56699
   0.54317   0.27393

ans(:,:,3) =

   0.72621   0.44131
   0.22743   0.61914 
```

使用 max 函数，我可以得到基于某个维度的最大值的索引。

```
octave:64> [a2_val a2_indx] = max(a, [], 2)

a2_indx =

ans(:,:,1) =

   2
   2

ans(:,:,2) =

   2
   1

ans(:,:,3) =

   1
   2 
```

如果我有与 a 相同的矩阵为零值，有什么办法可以用 1 标记最大位置？类似跟随。

```
octave:65> z
z =

ans(:,:,1) =

   0   1
   0   1

ans(:,:,2) =

   0   1
   1   0

ans(:,:,3) =

   1   0
   0   1 
```

我更喜欢像 max 函数那样无维度的解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:02:38.177

最简单的方法可能是沿该维度复制最大矩阵并使用逻辑比较：

```
dim = 2; % The dimension along which we max

% Prep a size matrix for the replication
dims = ones( size( size( a ) ) );
dims( dim ) = size( a, dim ); % (all ones except the
                              % dimension that gets maxed)

result = ( a == repmat( max( a, [], dim ), dims ) ) 
```

# java - Java中openssl的等价物

> ID：10378575
> 
> 赞同：1
> 
> 时间：2012-04-30T04:40:46.123
> 
> 标签：java, email, ssl, email-client

我目前正在编写一个 pop3 电子邮件客户端，以了解有关电子邮件客户端和 RFC 的更多信息...命令： openssl s_client -connect pop.gmail.com:995 将连接到谷歌服务器，并使您能够在身份验证后检索和检查电子邮件. 启动 TCP 套接字连接后，我将如何在 Java 中执行此操作？一个非常糟糕的选择是生成一个在外部运行该命令的进程

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T04:44:16.017

您将打开[SSL 套接字](http://docs.oracle.com/javase/6/docs/api/javax/net/ssl/SSLSocket.html)而不是常规套接字。SSLSockets 需要你做一些额外的事情，比如设置私钥和证书。如果您搜索“SSLSocket java 示例”，您应该会得到一堆示例代码来帮助您进行设置。创建 SSLSocket 并连接到 gmail 后，您可以从套接字获取输入/输出流，就像使用常规套接字一样。

另请参阅：[基于 HTTPS/SSL 的 Java 客户端证书](https://stackoverflow.com/questions/875467/java-client-certificates-over-https-ssl)

# c# - 使用 ABCpdf 将 HTML 转换为 PDF

> ID：10378579
> 
> 赞同：2
> 
> 时间：2012-04-30T04:41:12.267
> 
> 标签：c#, asp.net, html, pdf, abcpdf

我正在创建一个使用 ABCpdf 将 html 页面转换为 pdf 的 Web 应用程序。html页面对一些动态部分使用javascript..

我已经尝试将 UseScript bool 设置为 true，如下所示：

```
theDoc.HtmlOptions.UseScript = true; 
```

它呈现静态文本并省略 javascript 内容。

我尝试转换的 URL 是：[https](https://developers.google.com/chart/interactive/docs/examples) ://developers.google.com/chart/interactive/docs/examples （仅作为示例）

任何有关将启用 javascript 的页面转换为 pdf 的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T12:51:39.307

您可能需要增加超时时间，以便 javascript 有时间完成加载。我不确定默认超时是多少，但这是等待页面呈现的最长时间。

```
doc.HtmlOptions.Timeout = 10000; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:19:18.640

一些 HTML 到 PDF 创建者需要从图像到 javascript 文件的所有内容的完全限定路径。这通常是由于创建者在后台打开 Web 请求并静默捕获渲染。但这只有在一切都完全合格时才有效。ExpertPDF 我也遇到了同样的问题。尝试完全限定所有资源（图像、css、javascript 等）。

# xml - Regarding use of xsl:choose

> ID：10378585
> 
> 赞同：1
> 
> 时间：2012-04-30T04:42:39.007
> 
> 标签：xml, xslt, xslt-1.0

I have an xml file in which their is unit mentioned.

```
 <RQ>2.000</RQ> 
```

I need to check in my xsl file whether in the value their is a + or - sign. If their is no sign then the default will be + sign. I was writing it with xsl:choose element but it was not working out.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T12:35:04.407

**如果可以保证这`RQ`是数字的有效表示，则只需使用：**

```
substring('+-', 2 - (RQ > 0), 1) 
```

**一个完整的演示**：

这种转变：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

 <xsl:template match="/">
     <xsl:value-of select=
       "substring('+-', 2 - (RQ > 0), 1)"/>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于此 XML 文档时：**

```
<RQ>-2.000</RQ> 
```

**产生想要的正确结果**：

```
- 
```

**当应用于本文档时：**

```
<RQ>2.000</RQ> 
```

**再次产生正确的结果：**

```
+ 
```

**如果需要，可以将这个单行 XPath 表达式封装在一个单独的命名模板中，以便从代码中的不同位置调用——如下所示**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

 <xsl:template match="/">
     <xsl:call-template name="sign">
       <xsl:with-param name="pNum" select="RQ"/>
     </xsl:call-template>
 </xsl:template>

 <xsl:template name="sign">
   <xsl:param name="pNum"/>

     <xsl:value-of select=
       "substring('+-', 2 - (RQ > 0), 1)"/>
 </xsl:template>
</xsl:stylesheet> 
```

**但是请注意，对命名模板的调用占用了三行，而简单地使用一个衬垫需要，嗯，一行**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T07:21:59.973

如果你想使用**xsl:choose**，你可以做这样的事情

```
<xsl:template match="RQ">
   <xsl:choose>
      <xsl:when test="number() != number()">NaN</xsl:when>
      <xsl:when test="number() >= 0">+</xsl:when>
      <xsl:otherwise>-</xsl:otherwise>
   </xsl:choose>
</xsl:template> 
```

这也可以处理不包含数字的元素。或者，您可以更好地使用模板匹配，并完全消除对**xsl:choose**的需要。

```
<xsl:template match="RQ[number() != number()]">NaN</xsl:template>

<xsl:template match="RQ[number() >= 0]">+</xsl:template>

<xsl:template match="RQ">-</xsl:template> 
```

# ios - 在 Xcode 4.3 中为应用商店分发捆绑应用

> ID：10378587
> 
> 赞同：0
> 
> 时间：2012-04-30T04:43:00.630
> 
> 标签：ios, xcode, xcode4.3

我无法相信要弄清楚构建应用程序并将其放入应用程序商店的最终过程是多么困难。

我已经为我的应用程序准备了 iTunes Connect，它会显示在 Application Loader 中。

我终于想出了如何“归档”应用程序，尽管我找到的任何指南（包括 Apple 的指南）似乎都没有真正完整地描述这个过程。

现在我有一个 .xcarchive 包。出于某种原因，Application Loader 不会让我选择那种文件。我在某处读到需要存档为 .zip 文件，所以我尝试了一下。现在应用程序加载器允许我选择文件，但是在我单击发送后，它给了我这个错误：

“应用程序包装必须以 .app 结尾。”

从 Xcode 4.3 归档并将应用程序上传到应用商店的过程**到底**是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T04:48:24.310

在 XCode Organizer 中，“存档”选项卡是否允许“分发”？然后，您应该可以选择“提交到 iOS App Store”。

[这在分发你的 iOS 应用](https://developer.apple.com/library/ios/#recipes/xcode_help-archives_organizer/articles/distributing_ios_apps.html)中有更详细的描述。

提交过程没有得到太多描述，因为当它起作用时，它非常简单。您无需手动定位“.xcarchive”包或“.ipa”文件来提交应用商店，仅用于在应用商店外进行测试或备份。（你确实需要存档包，但它只是悄悄地创建然后由 XCode 上传。）

# macos - yiic on Mac Lion doesn't generate webapp

> ID：10378589
> 
> 赞同：1
> 
> 时间：2012-04-30T04:43:21.610
> 
> 标签：macos, yii, osx-lion

I have set up Mac Lion as my development machine. I am not using MAMP and everything is running smoothly. I have run the yii requirements and everything is good. Now I am trying to create my first webapp using yiic. When I follow the instructions here [http://www.yiiframework.com/doc/guide/1.1/en/quickstart.first-app](http://www.yiiframework.com/doc/guide/1.1/en/quickstart.first-app) terminal tells me it has mkdir a bunch of directories and that my webapp was created successfully.

But the testdrive directory is not in the correct directory (or any directory for that matter)

Has anyone run into this? And yes the yiic file and framework directory have execute permissions.

Any help would be much appreciated.

Brent

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T11:49:56.853

您链接的代码在 Lion 上完美运行。你确定你在正确的地方做吗？

```
~/Sites/yii/$> ls ../foo
ls: ../foo: No such file or directory
~/Sites/yii/$> ./framework/yiic webapp ../foo
Create a Web application under '/Users/xcode/Sites/foo'? [Yes|No] yes
      mkdir /Users/xcode/Sites/foo
      mkdir /Users/xcode/Sites/foo/assets
      mkdir /Users/xcode/Sites/foo/css
   generate css/bg.gif
   generate css/form.css
   generate css/ie.css
   generate css/main.css
   generate css/print.css
   generate css/screen.css
      mkdir /Users/xcode/Sites/foo/images
   generate index-test.php
   generate index.php
      mkdir /Users/xcode/Sites/foo/protected
   generate protected/.htaccess
      mkdir /Users/xcode/Sites/foo/protected/commands
      mkdir /Users/xcode/Sites/foo/protected/commands/shell
      mkdir /Users/xcode/Sites/foo/protected/components
   generate protected/components/Controller.php
   generate protected/components/UserIdentity.php
      mkdir /Users/xcode/Sites/foo/protected/config
   generate protected/config/console.php
   generate protected/config/main.php
   generate protected/config/test.php
      mkdir /Users/xcode/Sites/foo/protected/controllers
   generate protected/controllers/SiteController.php
      mkdir /Users/xcode/Sites/foo/protected/data
   generate protected/data/schema.mysql.sql
   generate protected/data/schema.sqlite.sql
   generate protected/data/testdrive.db
      mkdir /Users/xcode/Sites/foo/protected/extensions
      mkdir /Users/xcode/Sites/foo/protected/messages
      mkdir /Users/xcode/Sites/foo/protected/migrations
      mkdir /Users/xcode/Sites/foo/protected/models
   generate protected/models/ContactForm.php
   generate protected/models/LoginForm.php
      mkdir /Users/xcode/Sites/foo/protected/runtime
      mkdir /Users/xcode/Sites/foo/protected/tests
   generate protected/tests/bootstrap.php
      mkdir /Users/xcode/Sites/foo/protected/tests/fixtures
      mkdir /Users/xcode/Sites/foo/protected/tests/functional
   generate protected/tests/functional/SiteTest.php
   generate protected/tests/phpunit.xml
      mkdir /Users/xcode/Sites/foo/protected/tests/report
      mkdir /Users/xcode/Sites/foo/protected/tests/unit
   generate protected/tests/WebTestCase.php
      mkdir /Users/xcode/Sites/foo/protected/views
      mkdir /Users/xcode/Sites/foo/protected/views/layouts
   generate protected/views/layouts/column1.php
   generate protected/views/layouts/column2.php
   generate protected/views/layouts/main.php
      mkdir /Users/xcode/Sites/foo/protected/views/site
   generate protected/views/site/contact.php
   generate protected/views/site/error.php
   generate protected/views/site/index.php
   generate protected/views/site/login.php
      mkdir /Users/xcode/Sites/foo/protected/views/site/pages
   generate protected/views/site/pages/about.php
   generate protected/yiic
   generate protected/yiic.bat
   generate protected/yiic.php
      mkdir /Users/xcode/Sites/foo/themes
      mkdir /Users/xcode/Sites/foo/themes/classic
      mkdir /Users/xcode/Sites/foo/themes/classic/views
   generate themes/classic/views/.htaccess
      mkdir /Users/xcode/Sites/foo/themes/classic/views/layouts
      mkdir /Users/xcode/Sites/foo/themes/classic/views/site
      mkdir /Users/xcode/Sites/foo/themes/classic/views/system

Your application has been created successfully under /Users/xcode/Sites/foo.
~/Sites/yii/$> ls ../foo
assets         css            images         index-test.php index.php      protected          
themes 
```

注意，我的站点是当您启用系统偏好设置 -> 共享 -> 网络共享时 Lion 搜索主页的默认目录。

# python - 我可以在 jinja 模板中使用 get 键吗？

> ID：10378591
> 
> 赞同：0
> 
> 时间：2012-04-30T04:43:32.190
> 
> 标签：python, google-app-engine, python-2.7, jinja2

我有一个键列表，我正在尝试在 Jinja2 模板中获取对象：

`{{item.cities[0].get().name}} UndefinedError: 'google.appengine.api.datastore_types.Key object' has no attribute 'get'`

我认为`get()`即使在模板中也可以在键上使用，但在这里我得到了错误。是真的做不到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T15:54:23.063

看起来您对 NDB 键和 db 键感到困惑。db.Key 类（此处显示为 datastore_types.Key）没有 get() 方法。但是 NDB Key 类（将是 google.appengine.ext.ndb.key.Key）可以。

# javascript - JavaScript: Adding static methods to objects in two different ways

> ID：10378592
> 
> 赞同：0
> 
> 时间：2012-04-30T04:43:55.903
> 
> 标签：javascript, methods

What is the difference between below approaches for adding methods to an object:

```
// Appending methods to a function using nested functions
var myObj1 = {

    myMethod : function() {
        console.log('myObj1.myMethod was called');
    },

    myOtherMethod : function() {
    },

    myOtherOtherMethod : function() {
    }
}

// Appending methods to a function using the dot operator:
var myObj2 = {};

myObj2.myMethod = function(){
    console.log('myObj2.myMethod was called');
}

myObj2.myOtherMethod = function(){
}

myObj2.myOtherOtherMethod = function(){
}    

myObj1.myMethod(); // myObj1.myMethod was called
myObj2.myMethod(); // myObj2.myMethod was called 
```

Both do the same thing. Besides the different syntax, is one approach preferred over the other? From my point of view, both approaches simply add methods (or function if you like) to an object.

[http://jsfiddle.net/NK35z/](http://jsfiddle.net/NK35z/)

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T04:50:43.447

两者在语义上是相同的。对象字面量语法是首选，因为它更清楚您在做什么，并且它还为 JavaScript 引擎提供了优化结果的机会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T04:52:55.800

它们完全相同。当您不想覆盖对象上已经存在的属性/方法时，您必须使用点/方括号访问器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T06:44:30.097

正如其他人所说，没有实际区别。在对象字面量中添加属性是有意义的，因为您预先知道所有内容并且可以分配值。在添加方法之前，一次添加一个属性是有意义的，例如：

```
var obj = {
  /* define some stuff here */
};

if ( whatever ) {
  obj.fn = function(){/* logic A */}
} else {
  obj.fn = function(){/* logic B */}
} 
```

没有正确或错误的方法，在每种情况下使用最适合的方法。可以将两者用于同一个对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-30T05:10:01.710

这两种声明对象/函数的方式没有区别。如果您的意思是“它们不会改变”中的静态方法，那会很好用。

它们不是传统意义上的静态方法。每次创建这样的对象时，它都会在内存中拥有自己独特的表示形式。这意味着您将为该对象的每个实例（函数的 n 个副本）拥有一个函数，而不是内存中的一个函数。

为了制作不需要实例的静态方法（在经典的 OOP 意义上，由类共享的方法（在 JavaScript 中没有类，因此使用相同构造函数/原型的对象）不需要实例），你不能真正做到. 但是，如果您希望函数只占用内存中的一个空间，则必须使用[构造函数模式](http://addyosmani.com/resources/essentialjsdesignpatterns/book/#constructorpatternjavascript)：

```
function Foo()
{
    //we won't assign any properties here.
}

Foo.prototype.method1 = function(var1, var2){
    //don't use `this` here if you want the method to be truly static.
    //static methods shouldn't try and access instance members.
};

Foo.prototype.method2 = function(var2, var3){
   //whatever goes here
};

// Methods on the prototype are shared by all objects of foo, so we can create a new Foo
var f = new Foo();
foo.method1(1,2); // also works. 
```

# google-chrome - ValuePattern's SetValue does not work for Chrome browser's control like address edit (Exception thrown)

> ID：10378594
> 
> 赞同：0
> 
> 时间：2012-04-30T04:44:13.283
> 
> 标签：google-chrome, microsoft-ui-automation

I am trying to use UIA to control browsers (ie, chrome, firefox) operations like nativate, go back, go forward and so on for some testing necessary. I tried to wrote some demo code, but met some problems. I got the AutomationElement for address edit for Chrome, and try to set url for it with ValuePattern, but I got exception below:

```
在 System.Runtime.InteropServices.Marshal.ThrowExceptionForHRInternal(Int32 errorCode, IntPtr errorInfo)
在 MS.Internal.Automation.UiaCoreApi.CheckError(Int32 hr)
在 System.Windows.Automation.ValuePattern.SetValue(String value)
在 BrowserControl.Browser.Browser.Goto(String url) 位置 C:\Users\darren\documents\visual studio 2010\Projects\BrowserControl\BrowserControl\Browser\Browser.cs:行号 109
在 BrowserControl.Program.Main(String[] args) 位置 C:\Users\darren\documents\visual studio 2010\Projects\BrowserControl\BrowserControl\Program.cs:行号 17
在 System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
在 System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
在 Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
在 System.Threading.ThreadHelper.ThreadStart_Context(Object state)
在 System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
在 System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
在 System.Threading.ThreadHelper.ThreadStart() 
```

And I found that SetFoucus method also will got the same exception. I tried to use win32 method to send message to it, found that the element.Current.NativeWindowHandle is null. but I can see the current value from ValuePattern's current property. Just for a address that the UIA cannot find the chrome's control firstly until I called the below method ()UiaRegisterProviderCallback(IntPtr.Zero);

So, not sure what's reason for it, and is there anyway to set value for chrome's control

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T02:23:39.223

如果不深入研究 Chrome 源代码，我无法确定这一点，但我的猜测是 Chrome 中的地址栏实际上是一个自定义控件，这就是为什么你没有看到它像标准文本框那样完全符合 ValuePattern/编辑框。[我在其他地方看到过类似的事情，我通常最终会使用SendKeys](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.aspx)做某种解决方法。

# powershell - PowerShell txt 文件比较未找到匹配项

> ID：10378600
> 
> 赞同：1
> 
> 时间：2012-04-30T04:45:21.750
> 
> 标签：powershell

我的 PowerShell 冒险仍在继续……在最终弄清楚文件操作和一些正则表达式来格式化我的文本之后，我终于有了 2 个需要比较的文本文件。

```
Compare-Object $(Get-Content C:\File1.txt) $(Get-Content C:\File2.txt) -includeequal > C:\Results.txt 
```

问题：在 2 个单独的文本文件上使用 Compare-Object 和 Get-Content 时，比较结果显示不匹配。我知道这是不正确的，因为我可以手动找到与两者相同的字符串。文本是一个随机的 ID 号，结构如下：

**GTD-LVOE-FS-0032**

每个文本文件本身可能包含特定 ID 号的多个副本，并且 File2 是包含所有出现的 ID 号的主列表。

解决方案：我希望带有–includeequal 的Compare-Object 返回一些== 结果，因为我知道是这种情况。是否有我可能忽略的格式问题导致此问题，或者当文件内和文件之间存在多个相同的字符串时，Compare-Object 是否无法像我预期的那样工作？

**编辑：**

作为测试，我创建了 2 个文本文件，每个文件包含以下内容。

```
GTD-LVOE-43-0021
GTD-LVOE-43-0021
GTD-LVOE-43-0021
GTD-LVOE-43-0021 
```

我希望 Compare-Object 说这些文本文件是相同的，而是返回 File2 包含字符串。在我看来，问题在于 Compare-Object 在为比较创建的变量之一中处理相同的字符串。当需要比较的变量中有多个相同的字符串时，是否有另一种 CMDLET 或方​​法用于比较对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T12:57:43.790

对我有用（基于您发布的内容，file1 和 file2 的内容相同）：

```
PS> compare (gc File1.txt) (gc File2.txt) -IncludeEqual | ft -a

InputObject      SideIndicator
-----------      -------------
GTD-LVOE-43-0021 ==
GTD-LVOE-43-0021 ==
GTD-LVOE-43-0021 ==
GTD-LVOE-43-0021 == 
```

# python - scikit learn：未选择所需数量的最佳特征（k）

> ID：10378601
> 
> 赞同：8
> 
> 时间：2012-04-30T04:45:32.640
> 
> 标签：python, machine-learning, scikit-learn, chi-squared

我正在尝试使用卡方（scikit-learn 0.10）选择最佳功能。从总共 80 个训练文档中，我首先提取 227 个特征，然后从这 227 个特征中选择前 10 个。

```
my_vectorizer = CountVectorizer(analyzer=MyAnalyzer())      
X_train = my_vectorizer.fit_transform(train_data)
X_test = my_vectorizer.transform(test_data)
Y_train = np.array(train_labels)
Y_test = np.array(test_labels)
X_train = np.clip(X_train.toarray(), 0, 1)
X_test = np.clip(X_test.toarray(), 0, 1)    
ch2 = SelectKBest(chi2, k=10)
print X_train.shape
X_train = ch2.fit_transform(X_train, Y_train)
print X_train.shape 
```

结果如下。

```
(80, 227)
(80, 14) 
```

`k`如果我设置为 ，它们是相似的`100`。

```
(80, 227)
(80, 227) 
```

为什么会这样？

*编辑：一个完整​​的输出示例，现在没有剪辑，我请求 30 并得到 32 代替：

```
Train instances: 9 Test instances: 1
Feature extraction...
X_train:
[[0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 1 0 1 1 0 1 1 0 0 0 1 0 1 0 0 0 0 1 1 1 0 0 1 0 0 1 0 0 0 0]
 [0 0 2 1 0 0 0 0 0 1 0 0 0 1 1 0 0 0 1 0 0 0 0 1 0 1 1 0 0 1 0 1]
 [1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 1 0]
 [0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 0 1 0 0 0]]
Y_train:
[0 0 0 0 0 0 0 0 1]
32 features extracted from 9 training documents.
Feature selection...
(9, 32)
(9, 32)
Using 32(requested:30) best features from 9 training documents
get support:
[ True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True]
get support with vocabulary :
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30 31]
Training...
/usr/local/lib/python2.6/dist-packages/scikit_learn-0.10-py2.6-linux-x86_64.egg/sklearn/svm/sparse/base.py:23: FutureWarning: SVM: scale_C will be True by default in scikit-learn 0.11
  scale_C)
Classifying... 
```

另一个没有剪裁的例子，我请求 10 并得到 11：

```
Train instances: 9 Test instances: 1
Feature extraction...
X_train:
[[0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 1 0 1 1 0 1 1 0 0 0 1 0 1 0 0 0 0 1 1 1 0 0 1 0 0 1 0 0 0 0]
 [0 0 2 1 0 0 0 0 0 1 0 0 0 1 1 0 0 0 1 0 0 0 0 1 0 1 1 0 0 1 0 1]
 [1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
 [1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 1 0]
 [0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 0 1 0 0 0]]
Y_train:
[0 0 0 0 0 0 0 0 1]
32 features extracted from 9 training documents.
Feature selection...
(9, 32)
(9, 11)
Using 11(requested:10) best features from 9 training documents
get support:
[ True  True  True False False  True False False False False  True False
 False False  True False False False  True False  True False  True  True
 False False False False  True False False False]
get support with vocabulary :
[ 0  1  2  5 10 14 18 20 22 23 28]
Training...
/usr/local/lib/python2.6/dist-packages/scikit_learn-0.10-py2.6-linux-x86_64.egg/sklearn/svm/sparse/base.py:23: FutureWarning: SVM: scale_C will be True by default in scikit-learn 0.11
  scale_C)
Classifying... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T04:57:07.437

您是否检查过`get_support()`函数返回的内容（`ch2`应该有这个成员函数）？这将返回在最佳 k 中选择的索引。

我的猜想是由于您正在执行的数据裁剪（或者由于重复的特征向量，如果您的特征向量是分类的并且可能有重复）而存在联系，并且 scikits 函数返回所有被绑定的条目为前 k 个点。您设置的额外示例`k = 100`对这个猜想产生了一些疑问，但值得一看。

查看`get_support()`返回的内容，并检查`X_train`这些索引的外观，查看裁剪是否会导致大量特征重叠，从而在使用的 chi^2 p 值等级中创建联系`SelectKBest`。

如果事实证明是这种情况，您应该向 scikits.learn 提交错误/问题，因为目前他们的文档没有说明`SelectKBest`在出现平局时会做什么。显然，它不能只取一些绑定索引而不取其他索引，但至少应该警告用户，绑定可能导致意外的特征维度降低。

# m2eclipse - Eclipse Indigo for Java EE + Maven plugin = the Maven menu does not appear in import and preference

> ID：10378602
> 
> 赞同：5
> 
> 时间：2012-04-30T04:45:44.777
> 
> 标签：m2eclipse, eclipse-indigo

I have used Indigo Java (not Java EE) and the maven plugin is already installed. Or at least, I know I have the possibility to import a Maven Project without installing anything.

But then I wanted to use Eclipse Indigo for Java EE developers. This version does not have maven already installed. I can not import a maven project. So I decided to install the m2e plugin.

And I have tried to install it many different ways (information on theses sites):

[http://code.google.com/p/google-web-toolkit/wiki/WorkingWithMaven](http://code.google.com/p/google-web-toolkit/wiki/WorkingWithMaven) [http://googlewebtoolkit.blogspot.com/2011/09/working-with-maven-and-requestfactory.html](http://googlewebtoolkit.blogspot.com/2011/09/working-with-maven-and-requestfactory.html) [http://code.google.com/p/listwidget](http://code.google.com/p/listwidget)

I also tried to use the Eclispe market place for the installation of the plugins. The installation process does not fail. But the Maven menu in import and Windows->Preference does not appear inside Indigo Java EE?

NB: I am running Windows 7, 64 bit edition

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-01-09T07:29:56.920

Here's what I did in Indigo.

Go to Help>>Install New Software

Paste the below URL over there [http://download.eclipse.org/releases/indigo/](http://download.eclipse.org/releases/indigo/)

You will see a list below. From the list expand "Collaboration" and you can see m2e - maven integration for eclipse.

select that and click next. Got one error in between but it's working now.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-07-01T19:47:27.813

此软件存储库[http://download.eclipse.org/releases/indigo/](http://download.eclipse.org/releases/indigo/)提供对 Eclipse indigo 版本软件的访问。它包含 2011 年 6 月发布的代码，以及 2011 年 9 月发布的 SR1 和 2012 年 2 月发布的 SR2。

当您安装 Eclipse 平台或 SDK 时，存储库站点 URL 通常预填充在软件存储库列表中。

有关安装或更新软件的更多信息，请参阅 Eclipse 平台帮助。

还有一系列方便的、可下载的一体化 zip 文件可用于许多兴趣和平台。许多人发现这些一体化软件包是最简单的入门方式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-15T05:31:32.040

我正在使用 Eclipse INDIGO。试试这个链接。这个对我有用。 [http://download.eclipse.org/technology/m2e/releases](http://download.eclipse.org/technology/m2e/releases)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-02-16T22:52:24.390

日蚀靛蓝

转到帮助>>安装新软件

将下面的 URL 粘贴到那里[http://download.eclipse.org/releases/indigo/](http://download.eclipse.org/releases/indigo/)

您将在下面看到一个列表。从列表中展开“协作”，您可以看到 m2e - Eclipse 的 maven 集成。

选择它并单击下一步。中间有一个错误，但它现在可以工作了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-21T13:43:30.040

[http://download.eclipse.org/releases/indigo/](http://download.eclipse.org/releases/indigo/)对我有用。您将在下面看到一个列表。从列表中展开“协作”，您可以看到 m2e - Eclipse 的 maven 集成。eclipse Indigo：内部版本号：20110615-0604

# ios - 如何在 OS X 应用程序中重置内容和设置？

> ID：10378606
> 
> 赞同：1
> 
> 时间：2012-04-30T04:46:52.907
> 
> 标签：ios, xcode, macos, core-data

我需要在我的 OS X 应用程序中按数据库和用户默认值重置。我该怎么做？在 IOS 应用程序中，我们有一个类似“**重置内容和设置**”的选项。但是当我运行 OS X 应用程序时，我没有看到这样的选项。我现在正在做的是，深入到 /users/library 并删除我的项目文件夹下的 .storedata 文件。但是使用这种方法，我无法重置我的 userdefaults 值。有没有其他的出路？我是 OS X 编程的新手。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T05:31:40.353

您将需要手动将 NSUserDefaults 的值设为 nil 并一起删除数据库，然后重新创建它。最好的选择是包含一个空数据库并将其复制到库文件夹（或您访问它的任何地方）（如果它不存在）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-31T02:25:18.067

我在 DebugViewController 中有这个：

```
- (void)removeUserDefaults {
  [[NSUserDefaults standardUserDefaults] setPersistentDomain:[NSDictionary dictionary] forName:[[NSBundle mainBundle] bundleIdentifier]];
} 
```

然后我可以使用 Button-Press 删除 UserDefaults。

# ruby - Metaprogramming with ruby, operator overloading and instance_eval

> ID：10378608
> 
> 赞同：0
> 
> 时间：2012-04-30T04:47:06.407
> 
> 标签：ruby, closures, metaprogramming, block, dsl

For example i've class like :

```
class QueryDSL
  def initialize(&block)
    instance_eval &block
  end

  def ==(value)
    "bla bla '#{value}'"
  end

  def test(param)
    param + param
  end
end 
```

and class Query like :

```
class Query
  def self.where(&block)
    QueryDSL.new(&block)
  end
end 
```

I suspect when execute :

```
Query.where{test == 9} 
```

the output should be :

```
"bla bla 9 bla bla 9" 
```

But i've got exception like :

```
`test': wrong number of arguments (0 for 1) (ArgumentError) 
```

Is there any mistake from my code ? Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T04:55:55.600

Your problem is that you're calling the `QueryDSL#test` method with no arguments when it is defined to take one argument, hence the

```
`test': wrong number of arguments (0 for 1) (ArgumentError) 
```

error.

Either change the `test` method to not take arguments or to have a default for `param` or supply the argument in your block:

```
Query.where { test(6) == 9 } 
```

That still won't call your `==` operator though, `test` doesn't return a QueryDSL instance so the `==` operator for whatever it does return will be used.

# php - .htaccess not allowing sub-directory to work

> ID：10378609
> 
> 赞同：1
> 
> 时间：2012-04-30T04:47:13.457
> 
> 标签：php, .htaccess, directory

Here is the .htaccess file

```
RewriteEngine on
RewriteCond $1 !^(index\.html|index.php|administrator|system|template|js|lib|favicon\.ico|robots\.txt)
RewriteRule ^(.*)$ /index.html?tpl=$1 [L]

Options +FollowSymlinks 
```

However what is happening is that all the following folders wont allow me to go into them and view a PHP file.

```
|administrator|system|template|js|lib 
```

I thought by putting the files in `RewriteCond` that it would allow a user to still go to `http://example.com/news/happy` which then would go to the index.php?tpl=etc etc but it has stopped me from going into any subdirectory like

[http://example.com/system/index.php](http://example.com/system/index.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T06:08:26.390

我不知道这是否适合你。但我所做的是添加此规则以加载对任何没有 .php 结尾的 .php 文件的调用。你可以同时调用这两个，有或没有那个结尾。

例如，您可以调用`my_url.com/myfolder/myfile`它，它会使用友好的 URL 加载`myfile.php`。

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-07T01:10:34.800

我想建议您先阅读有关 mod rewrite 的内容

1 - 将该行放在顶部

```
 Options +FollowSymlinks 
```

该行要求您的服务器遵循符号链接，但我建议您使用更安全的选项“SymLinksIfOwnerMatch”

资源：

[http://httpd.apache.org/docs/2.2/mod/core.html#options#FollowSymLinks](http://httpd.apache.org/docs/2.2/mod/core.html#options#FollowSymLinks)

```
RewriteEngine on 
```

启用或禁用运行时重写引擎

来源： [http ://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriteengine](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriteengine)

```
 RewriteCond $1 !^(index\.html|index.php|administrator|system|template|js|lib|favicon\.ico|robots\.txt) 
```

干得好 。该规则要求 Web 服务器添加重写条件以忽略正则表达式中列出的所有内容

我也为你添加了正则表达式解释

```
 ! 
```

不等于 ^ 开头

```
 RewriteRule ^(.*)$ /index.html?tpl=$1 [L] 
```

您要求将其他所有内容写入 index.html?tpl=$1 ** 我认为您的意思是 index.php 我会假设您不需要查询字符串

我想建议使用更好的方法来处理排除

```
 RewriteEngine On
 Options +FollowSymLinks
 RewriteCond %{REQUEST_FILENAME} !-f
 RewriteCond %{REQUEST_FILENAME} !-d
 RewriteCond %{REQUEST_URI} !(index\.html|index.php|administrator|system|template|js|lib|favicon\.ico|robots\.txt)
 RewriteRule ^(.*)$ /index.html?tpl=$1 [L] 
```

# javascript - Raphael JS / SVG 中的自动换行

> ID：10378611
> 
> 赞同：5
> 
> 时间：2012-04-30T04:47:30.643
> 
> 标签：javascript, browser, svg, raphael

你如何在 RaphaelJS 中将单词包裹在一个盒子里？还是在一般基于浏览器的 SVG 中？

我在上面找到[了这个线程](https://groups.google.com/forum/?fromgroups#!topic/raphaeljs/JgwAHNepo-4)，但它没有任何意义。他们说要使用“widthToCharNum”，但据我所知，这个帖子是互联网上唯一使用过这些词的地方。他们建议使用“宽度”属性，但这没有效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T05:03:38.397

Raphael 或 SVG 规范中没有*内置文本换行。*时期。来自 HTML 世界，我发现没有文本换行非常令人震惊。

但是，您可以自己做，没有太大的困难。有关详细信息和示例，请参阅[此问题。](https://stackoverflow.com/questions/3142007/how-to-either-determine-svg-text-box-width-or-force-line-breaks-after-x-chara)不幸的是，您必须消耗一些客户端周期才能使其动态工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T08:53:29.887

svg.js库有一个[svg.textflow.js](https://github.com/wout/svg.textflow.js)[插件](http://svgjs.com/)。它不是超快，但它可以解决问题。它甚至将溢出的文本存储在数据属性中，因此您可以使用它来创建连续流动的列。[这里是文本流示例页面](http://svgjs.com/textflow/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T04:51:45.207

tspan 标签可以给人一种自动换行的错觉，但没有内置的自动换行功能。

tspan 标记与文本标记相同，但可以嵌套在文本标记内部和自身内部。再加上 'dy' 属性，这允许在 SVG 1.1 中出现自动换行的错觉。请注意，“dy”相对于最后绘制的字形（字符）。[在http://tutorials.jenkov.com/svg/text-element.html](http://tutorials.jenkov.com/svg/text-element.html)上有一个关于如何使用 tspan 的教程。

[http://www.xml.com/pub/a/2002/09/11/quint.html](http://www.xml.com/pub/a/2002/09/11/quint.html)上的文章也可能有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-24T22:52:40.680

我知道现在有点晚了，但你可能对我的[Raphael-paragraph](https://github.com/jbreckmckye/raphael-paragraph)项目感兴趣。

它是一个小型库，可让您创建具有最大宽度和高度约束、行高和文本样式配置的自动换行多行文本。它仍然是 beta-ish，需要大量优化，但它应该可以满足您的目的。

GitHub 页面上提供了使用示例和文档。

# xcode - 设置 NSMutableURLRequest 的 timeOut 值

> ID：10378613
> 
> 赞同：0
> 
> 时间：2012-04-30T04:47:38.917
> 
> 标签：xcode, timeout, nsurlconnection, nsmutableurlrequest

我正在尝试为 NSMutableURLRequest 设置超时值，并且在调试时，我检查了它是否不起作用。谷歌搜索了 10 分钟，我得到的信息是，默认超时值为 240。以下是我现在正在使用的代码，我想我错过了某个地方，我想知道如何为 NSMutableURLRequest 设置 timeOut 值

```
NSURL *url = [[NSURL alloc] initWithString:fURL];

_urlRequest = [[NSMutableURLRequest alloc] url];
[_urlRequest setHTTPMethod:@"GET"];
[_urlRequest setTimeoutInterval:120];

NSURLConnection*  _urlConnection = [[NSURLConnection alloc] initWithRequest:_urlRequest delegate: self]; 
```

我也试过用这个`[_nsmURLRequest initWithURL:nsURL cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:120];`。它不工作。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-22T16:52:22.587

尝试在`setTimeoutInterval`之前移动`setHTTPMethod:@"GET"`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-03T14:57:23.333

根据[这篇](https://stackoverflow.com/a/1765557/1037394)文章，您提到的默认超时值（240）也是最小值。如链接中所述，您必须使用另一个计时器来取消请求。

# c++ - 首次执行后 CPU 霍夫曼压缩更快？

> ID：10378617
> 
> 赞同：2
> 
> 时间：2012-04-30T04:48:09.527
> 
> 标签：c++, compression, huffman-code

我最近在 C++ 中构建了 Huffman 编码的 CPU 实现。为了比较时间，我还在 CUDA 中构建了一个 GPU 版本，但是在测试 CPU 的时间时遇到了一个问题：

当通过压缩大文件进行压力测试时，例如一个 97mb 的文本文件，其中几乎包含字母表中的每个字母和各种其他 ascii 字符，我的 CPU 实现在第一次执行时大约需要 8.3 秒。之后，时间显着下降到 1.7 秒。注意：我只对 CPU 的频率计数进行计时，而不是对字符串的编码和写入文件进行计时。

有什么想法吗？我正在关闭所有文件指针，据我所知不应该缓存任何东西。

如果需要任何源代码，请告诉我，谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T04:59:24.930

第一次运行后，文件内容被系统缓存（并由所有进程共享），因此下一次运行实际上是从内存中读取文件。

# c++ - 提升程序选项 - 如何有条件地键入位置参数？

> ID：10378620
> 
> 赞同：2
> 
> 时间：2012-04-30T04:48:21.243
> 
> 标签：c++, boost, boost-program-options

我正在使用 boost 程序选项，并且我想根据用户指定的命令行开关将一些位置参数解释为字符串或整数。例如：

```
foo -asint outputfile 10 11 12
foo -asstr outputfile 10 11 12 
```

将 (10,11,12) 在第一个示例中列为整数，在第二个示例中列为字符串。

我不知道如何使用 boost po 来做到这一点。这是我的命令行解析的片段：

```
// basic options group
po::options_description genericOpts("allowed options");
genericOpts.add_options()
    ("help,h", "display help message / usage")
    ("asint,i", "interpret arguments ints instead of strings")
;

// hidden options group - don't show in help
po::options_description hiddenOpts("hidden options");
hiddenOpts.add_options()
    ("filename", po::value<string>()->required(),"output file")
    ("inputs", po::value<vector<string>>(), "inputs, either strings or ints")
;

po::options_description cmdline_options;
cmdline_options.add(genericOpts).add(hiddenOpts);

po::positional_options_description p;
p.add("filename",1).add("inputs", -1);

po::variables_map vm;
po::store(po::command_line_parser(argc, argv).
          options(cmdline_options).positional(p).run(), vm); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T07:49:34.493

始终将它们作为字符串读取，并根据其他选项进行一些后处理。

# extjs4 - 为 JSON 对象创建 CheckBox

> ID：10378623
> 
> 赞同：0
> 
> 时间：2012-04-30T04:49:15.813
> 
> 标签：extjs4

我正在使用 extjs4，我需要根据我的 JSON 对象添加复选框组，

**JSON**

```
{"Provider":[{"id":3,"name":"Beta House","npi":0,"taxId":0,
    "address":{
        "state":{"id":"1","stateName":"Alabama","code":"AL"},
    "zipcode":0,"country":"USA","email":"beta@gmail.com"},
"type":"CP","LabProvider":[],"ListOfProvider":[]}]} 
```

**ExtJs** Ext.define('providerList', { extend: 'Ext.data.Model', fields: ['id','name'] });

```
 var provider = Ext.create('Ext.data.Store', {
                model: 'providerList',
                autoLoad: true,
                proxy: {
                    type: 'ajax',
                    url : url+'/lochweb/loch/clinicalProvider/getAll',
                    reader: {
                        type: 'json',
                        root: 'Provider'
                    }
                }
            }); 
```

**控制板**

```
 var checkboxconfigs = [];
                provider.each(function(record) { 
                    checkboxconfigs.push(
                            {                   
                                boxLabel: 'record.id', 
                                name: 'record.name'
                            }) 
                    });

var checkboxes = new Ext.form.CheckboxGroup({  
            fieldLabel:'Providers',  
            columns:2,  
            items:checkboxconfigs
             });

var patientProvider = new Ext.FormPanel({       
                renderTo: "patientProvider",
                frame: true,                 
                title: 'Association',
                bodyStyle: 'padding:5px',           
                width: 500,
                items: [{
                    checkboxes                               
                        }],                     
            }); 
```

表单中没有复选框。如何从 JSON 存储中填充复选框

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T06:02:39.037

您可以在将`items`数组用作`checkboxes`. 数组的每个元素`items`都是根据商店的每条记录创建的。

```
var items = [];
provider.each(function(record) { items.push({boxLabel: 'up-to-you', name: 'up-to-you'}) }, );
var checkboxes = new Ext.form.CheckboxGroup({  
        fieldLabel:'Providers',  
        columns:2,  
        items:items
         }); 
```

在这里您可以确定每个复选框的`boxLabel`and （的属性可以用作前缀、后缀...）`name``record`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T10:45:35.443

几个提示：

在面板项的定义中删除复选框周围的 {}，如下所示：

```
 items: [ checkboxes ] 
```

其次，确保在填充复选框时商店可用。

我的应用程序中有类似的情况，在呈现面板后可以使用商店。面板是动态填充的复选框列表，如下所示：

```
 panel.add(new Ext.form.CheckboxGroup({
        columns: 1,
        vertical: true,
        items: checkItems
    }));
    panel.doLayout(); 
```

编辑：另一个提示：

从此代码中删除 qutoes ''：

```
{                   
    boxLabel: 'record.id', 
    name: 'record.name'
} 
```

否则你最终会得到所有标签'record.id'

# rest - 在 Java 中使用 Rest Api

> ID：10378624
> 
> 赞同：1
> 
> 时间：2012-04-30T04:49:16.337
> 
> 标签：rest, tomcat

我正在使用 tomcat 部署我的 war 文件，并且在我的 war 中有一些 rest api 调用，它们实际上在不同的端口启动了一个 http 服务器。当我在我的 api 调用后按下浏览器上的返回按钮时，我收到了这个错误。我该如何解决？

> 警告：无法解析 HTTP 请求 java.io.IOException：无法解析请求方法。流过早到达终点。在 com.noelios.restlet.http.HttpServerCall.readRequestHead(HttpServerCall.java:347) 在 com.noelios.restlet.http.StreamServerCall.(StreamServerCall.java:88) 在 com.noelios.restlet.http.StreamServerHelper$ConnectionHandler。在 java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303) 在 java.util.run(StreamServerHelper.java:86) 在 java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441) 在 java.util .concurrent.FutureTask.run(FutureTask.java:138) 在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908 ) 在 java.lang.Thread.run(Thread.java:619) 4 月 30 日，2012 年上午 10:13:22 com.noelios.restlet.http.HttpServerCall parseHost 信息：找不到强制性的“主机”HTTP 标头。2012 年 4 月 30 日上午 10:13:22 com.noelios.restlet.LogFilter afterHandle 信息：2012-04-30 10:13:22 127.0.0.1 - - 8182 - - - 404 330 - 0 [http://null](http://null)- - 2012 年 4 月 30 日上午 10:13:22 com.noelios.restlet.http.HttpServerConverter commit 严重：写入响应实体 java.io.IOException 时发生异常：已建立的连接被主机中的软件中止sun.nio.ch.SocketDispatcher.write0(Native Method) 在 sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:33) 在 sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:104) 在 sun。 nio.ch.IOUtil.write(IOUtil.java:75) at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:334) at java.nio.channels.Channels.write(Channels.java:60) at java .nio.channels.Channels.access$000(Channels.java:47) at java.nio.channels.Channels$1.write(Channels.java:134) at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65) at java.io.BufferedOutputStream。flush(BufferedOutputStream.java:123) 在 sun.nio.cs.StreamEncoder.implFlush(StreamEncoder.java:278) 在 sun.nio.cs.StreamEncoder.flush(StreamEncoder.java:122) 在 java.io.OutputStreamWriter.flush (OutputStreamWriter.java:212) 在 org.restlet.resource.StringRepresentation.write(StringRepresentation.java:211) 在 com.noelios.restlet.http.HttpServerCall.writeResponseBody(HttpServerCall.java:492) 在 com.noelios.restlet。 http.HttpServerCall.sendResponse(HttpServerCall.java:428) 在 com.noelios.restlet.http.HttpServerConverter.commit(HttpServerConverter.java:392) 在 com.noelios.restlet.http.HttpServerHelper.handle(HttpServerHelper.java:148)在 com.noelios.restlet.http.StreamServerHelper$ConnectionHandler.run(StreamServerHelper.java:86) 在 java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441）在 java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303) 在 java.util.concurrent.FutureTask.run(FutureTask.java:138) 在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask (ThreadPoolExecutor.java:886) 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) 在 java.lang.Thread.run(Thread.java:619) 2012 年 4 月 30 日 10:13:22 AM com.noelios.restlet.http.HttpServerConverter commit WARNING: Unable to send error response java.io.IOException: 已建立的连接被主机中的软件在 sun.nio.ch.SocketDispatcher.write0(Native Method) 中止在 sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:33) 在 sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:104) 在 sun.nio.ch.IOUtil.write(IOUtil.java:75) ) 在 sun.nio.ch.SocketChannelImpl。write(SocketChannelImpl.java:334) 在 java.nio.channels.Channels.write(Channels.java:60) 在 java.nio.channels.Channels.access$000(Channels.java:47) 在 java.nio.channels。 Channels$1.write(Channels.java:134) at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65) at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123) at com.noelios.restlet.http。 com.noelios.restlet.http.StreamServerCall.writeResponseHead(StreamServerCall.java:201) 处的 HttpServerCall.writeResponseHead(HttpServerCall.java:553) com.noelios.restlet.http.HttpServerCall.sendResponse(HttpServerCall.java:415) 处.noelios.restlet.http.HttpServerConverter.commit(HttpServerConverter.java:410) 在 com.noelios.restlet.http.HttpServerHelper.handle(HttpServerHelper.java:148) 在 com.noelios.restlet.http。StreamServerHelper$ConnectionHandler.run(StreamServerHelper.java:86) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441) at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)在 java.util.concurrent.FutureTask.run(FutureTask.java:138) 在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor .java:908) 在 java.lang.Thread.run(Thread.java:619)runTask(ThreadPoolExecutor.java:886) 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) 在 java.lang.Thread.run(Thread.java:619)runTask(ThreadPoolExecutor.java:886) 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) 在 java.lang.Thread.run(Thread.java:619)

# javascript - chrome 扩展执行脚本

> ID：10378626
> 
> 赞同：2
> 
> 时间：2012-04-30T04:49:18.897
> 
> 标签：javascript, google-chrome-extension

我有一个关于“ **executeScript** ”的问题。我知道 chrome 扩展程序可以使用 chrome.tabs.executeScript 将 javascript 代码注入页面，但我可以将一些代码注入 iframe 页面（与父页面的来源不同）吗？我正在创建一个我想从父页面访问 iframe 的扩展程序（例如在 iframe 中侦听单击事件 ..），但**XMLHttpRequest**似乎无法访问 iframe 页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T05:02:51.240

设置`allFrames: true`为也让脚本在选项卡 iframe 中执行。

[方法执行脚本](https://code.google.com/chrome/extensions/tabs.html#method-executeScript)

# objective-c - 如何在 obj-C 的 C 函数中向 self 发送消息？

> ID：10378629
> 
> 赞同：2
> 
> 时间：2012-04-30T04:50:16.847
> 
> 标签：objective-c, ios, audioqueueservices

我有一个 C 函数（音频队列服务中的回调函数），我想向自己发送消息。怎么做？如果我输入 [self message]，则会出现错误：

```
Use of undeclared identifier 'self' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T04:56:52.977

**您不会在实时回调中执行 objc 消息，例如音频。**原因是 objc 消息传递不是恒定时间，可能会锁定，从而导致错过截止日期，从而导致音频丢失。静态或动态 ( `virtual`) C++ 调用和 C 函数调用当然是常数时间，并且适用于实时上下文。

*如果它不是实时/音频回调*`self`，那么一种选择是作为用户信息或上下文参数传递：

```
void SomeCallback(t_stuff* const stuff, void* userInfo) {
  MONClass * Self = (MONClass*)userInfo;
  [Self doSomething];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T04:56:22.480

`self`仅在类定义的上下文中才有意义——它是指向该类实例的指针。函数不属于任何类，因此没有`self`指针。如果您希望您的回调能够向给定对象发送消息，则需要将指向该对象的指针存储在您的回调可以找到它的位置。这可能是一个全局变量（ick），一个`userInfo`仅用于此类事情的参数（更好），或者其他地方。

# python - 我可以将 cursor.fetchone() 存储在变量中吗

> ID：10378631
> 
> 赞同：1
> 
> 时间：2012-04-30T04:50:44.210
> 
> 标签：python

地狱家伙刚刚跳入python，我很难弄清楚这一点

我有 2 个查询。. **`query1`**现在**`query2`**我怎么能说
**`row = cursor.fetchone()`**我指的是**`query1`**而不是**`query2`**

```
cursor = conn.cursor()
query1  = cursor.execute("select * FROM spam")
query2  = cursor.execute("select * FROM eggs")
row = cursor.fetchone () 
```

多谢你们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T05:09:00.107

执行第二个查询后，第一个查询的结果就消失了。（的返回值`execute`没有用。）同时处理两个查询的正确方法是有两个游标：

```
cursor1 = conn.cursor()
cursor2 = conn.cursor()
cursor1.execute("select * FROM spam")
cursor2.execute("select * FROM eggs")
cursor1.fetchone() #first result from query 1
cursor2.fetchone() #first result from query 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T05:03:30.977

它没有。from 的返回值`cursor.execute`是没有意义的。根据[PEP 249](http://www.python.org/dev/peps/pep-0249/)：

```
.execute(operation[,parameters]) 

        Prepare and execute a database operation (query or
        command)...

        [...]

        Return values are not defined. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T05:03:36.600

你不能按照你想要的方式去做。改为执行以下操作：

```
cursor = conn.cursor()
cursor.execute("select * FROM spam")
results1 = cursor.fetchall()
cursor.execute("select * FROM eggs")

if results1 is not None and len(results1) > 0:
    print "First row from query1: ", results1[0]

row = cursor.fetchone()
if row is not None:
    print "First row from query2: ", row 
```

# iphone - 将信息存储在钥匙串内

> ID：10378634
> 
> 赞同：1
> 
> 时间：2012-04-30T04:51:21.963
> 
> 标签：iphone, ios, ios5

我想知道，iOS 钥匙串中可以存储多少数据？

在线参考时，我可以看到有关存储用户名和密码的网址。不将数据库存储在里面。

请告诉我，我们可以将 db 存储在钥匙串中吗？如何更安全地存储数据库。

帮我起来

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T05:58:08.630

不，它不打算用作通用安全数据存储。来自[iOS App Programming Guide](http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/TheiOSEnvironment/TheiOSEnvironment.html)（强调我的）：

> *钥匙串数据*
> 
> 钥匙串是密码和其他机密的安全加密容器。钥匙串旨在存储少量特定于您的应用的敏感数据。**它不是用于加密和存储数据的通用机制**。

您可能可以做的是将数据存储在更传统的位置，并在钥匙串中保护解密密钥。

# iphone - ios App中的谷歌认证后如何进行

> ID：10378641
> 
> 赞同：1
> 
> 时间：2012-04-30T04:52:16.580
> 
> 标签：iphone, objective-c, ios, google-authentication

ios App中的谷歌认证后如何进行？当我允许访问我的应用程序时。出现的窗口是“请复制此代码，切换到您的应用程序并将其复制到那里：”。我不知道如何从这里开始。这是我写的代码

```
SEL finishedSel = @selector(viewController:finishedWithAuth:error:);

viewController = [[GTMOAuth2ViewControllerTouch 
                                     controllerWithScope:scope
                                      clientID:clientID
                                      clientSecret:clientSecret
                                      keychainItemName:nil
                                      delegate:self                                                     finishedSelector:finishedSel]autorelease];

-(void)viewController:(GTMOAuth2ViewControllerTouch *)viewController
      finishedWithAuth:(GTMOAuth2Authentication *)auth
                 error:(NSError *)error {
    if (error != nil) {
        // Authentication failed
    } else {
        // Authentication succeeded
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-06T06:45:02.720

获得身份验证后，
您可以使用它来获取用户数据，请参阅此代码

```
 NSString *urlStr = @"https://www.googleapis.com/oauth2/v1/userinfo?alt=json";
 NSURL *url = [NSURL URLWithString:urlStr];
 NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
 [self.auth authorizeRequest:request
              completionHandler:^(NSError *error) {
                  NSString *output = nil;
                  if (error) {
                      output = [error description];
                  } else {
                      // Synchronous fetches like this are a really bad idea in Cocoa applications
                      //
                      // For a very easy async alternative, we could use GTMHTTPFetcher
                      NSURLResponse *response = nil;
                      NSData *data = [NSURLConnection sendSynchronousRequest:request
                                                           returningResponse:&response
                                                                       error:&error];
                      if (data) {
                          // API fetch succeeded
                          output = [[[NSString alloc] initWithData:data
                                                          encoding:NSUTF8StringEncoding] autorelease];

                          NSLog(@"output:%@",output);

                      } else {
                          // fetch failed
                          output = [error description];
                      }
                  }

              }]; 
```

请注意，您需要在[https://www.googleapis.com/auth/userinfo.profile范围内添加此 url](https://www.googleapis.com/auth/userinfo.profile)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T06:54:19.110

检查此链接[gtm-oauth2](http://code.google.com/p/gtm-oauth2/)

这是finishedWithAuth的示例代码

```
(void)viewController:(GTMOAuth2ViewControllerTouch *)viewController finishedWithAuth:(GTMOAuth2Authentication *)auth error:(NSError *)error {
      if (error != nil) {
          // Authentication failed (perhaps the user denied access, or closed the
          // window before granting access)
          NSLog(@"Authentication error: %@", error);
          NSData *responseData = [[error userInfo] objectForKey:@"data"]; // kGTMHTTPFetcherStatusDataKey
          if ([responseData length] > 0) {
              // show the body of the server's authentication failure response
              NSString *str = [[[NSString alloc] initWithData:responseData encoding:NSUTF8StringEncoding] autorelease];
              NSLog(@"%@", str);
          }
          self.auth = nil;
      } else {
          // Authentication succeeded
          //
          // At this point, we either use the authentication object to explicitly
          // authorize requests, like
          //
          //  [auth authorizeRequest:myNSURLMutableRequest
          //       completionHandler:^(NSError *error) {
          //         if (error == nil) {
          //           // request here has been authorized
          //         }
          //       }];
          //
          // or store the authentication object into a fetcher or a Google API service
          // object like
          //
          //   [fetcher setAuthorizer:auth];
          // save the authentication object
          self.auth = auth;
      }
} 
```

# php - PHP strtotime 错误

> ID：10378644
> 
> 赞同：2
> 
> 时间：2012-04-30T04:52:27.037
> 
> 标签：php, strtotime

它真的像 30-APR-12 那样连线

两个都 ：

```
date("M", strtotime("-2 months"));
date("M", strtotime("-1 months")); 
```

给我同样的结果：Mar Mar

在其他任何一天都可以。我太新了，不能称之为任何东西告诉我我该怎么办？

我有 XAMPP 1.7.4 包（PHP 5.3.5）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:00:42.833

您实际返回的两个日期是：

*   2012-03-01
*   2012-03-30

当涉及到这样的月份时，的行为`strtotime()`有点棘手。如果你回溯两个月，没有 2 月 30 日，所以你会在 3 月 1 日结束。后 1 个月是您期望的行为。

要解决此问题，只需在使用`strtotime()`.

```
date('M', strtotime('-2 months', strtotime('2012-04-01'))); 
```

只需将年/月替换为当前年/月即可。

# php - PHP：在非 sql 代码上注入代码？

> ID：10378645
> 
> 赞同：0
> 
> 时间：2012-04-30T04:52:27.160
> 
> 标签：php

我已经阅读了 MySQL 注入以及它是如何完成的。我有一个疑问，如果登录代码没有从数据库中获取数据，它怎么会受到攻击？

这是我的登录代码的样子：

```
if($_GET['login'] == "myname" && $_GET['password'] == "mypass"){
     echo 'welcome, admin.';
else
     echo 'login failed.' 
```

ps：这只是为了练习，我知道不应该使用硬编码的密码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T04:55:40.620

如果没有 SQL 数据库，就没有 SQL 注入。

另一个需要注意的常见事情是 XSS 的潜力。这可以通过简单地转义任何用户输出来处理。由于您在示例代码中根本没有从用户那里输出任何东西，所以我认为没有问题。

# vb.net - 2 维数组 VB.NET

> ID：10378646
> 
> 赞同：0
> 
> 时间：2012-04-30T04:52:38.203
> 
> 标签：vb.net, arrays, arraylist

如何将此数组转换为 UNLIMITED 范围数组？

```
Dim multiArray(2, 2) As String 
multiArray(0, 0) = "item1InRow1" 
multiArray(0, 1) = "item2InRow1" 
multiArray(1, 0) = "item1InRow2" 
multiArray(1, 1) = "item2InRow2" 
```

我试过了：

```
Dim multiArray(,) As String 
```

但我没有成功

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T06:02:28.410

数组本质上具有有限的大小，更改它的唯一方法是[Redim / Preserve](http://msdn.microsoft.com/en-us/library/w8k3cys2%28v=vs.100%29.aspx)数组，这可能非常昂贵（请参阅此[链接](http://www.ehow.com/facts_7841787_pros-cons-redim-statement.html)）并且仅重新调整最后一个维度。您可能想考虑使用[ArrayList](http://msdn.microsoft.com/en-us/library/system.collections.arraylist.aspx)之类的东西或文章建议的另一个[集合类。](http://msdn.microsoft.com/en-us/library/system.collections.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T06:07:31.000

使用这样的变量。n 的值可以从用户/某些逻辑中分配。

```
Dim n As Integer = 2
Dim str As String(,) = New String(n - 1, n - 1) {} 
```

# oracle - How do I find what is causing ORA-00054?

> ID：10378651
> 
> 赞同：5
> 
> 时间：2012-04-30T04:52:56.800
> 
> 标签：oracle, oracle11g, ora-00054

For past some time I have noticed that we get `ORA-00054` error while trying to issue `SELECT ... FOR UPDATE NOWAIT`, during large number of concurrent updates to the db. This our development system and we really do not have any other user, or at least that is what we believe.

We have been through the logs of our application and it seems everything is in order; no threads are trying to update the same row.

How can I configure Oracle db to generate a log on which would let me know the user id which holds the lock when this error occurred?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-10T03:24:27.667

from here: [ORA-00054: resource busy and acquire with NOWAIT specified](https://stackoverflow.com/questions/3075738/ora-00054-resource-busy-and-acquire-with-nowait-specified)

You can also look up the sql,username,machine,port information and get to the actual process which holds the connection

```
SELECT O.OBJECT_NAME, S.SID, S.SERIAL#, P.SPID, S.PROGRAM,S.USERNAME,
S.MACHINE,S.PORT , S.LOGON_TIME,SQ.SQL_FULLTEXT 
FROM V$LOCKED_OBJECT L, DBA_OBJECTS O, V$SESSION S, 
V$PROCESS P, V$SQL SQ 
WHERE L.OBJECT_ID = O.OBJECT_ID 
AND L.SESSION_ID = S.SID AND S.PADDR = P.ADDR 
AND S.SQL_ADDRESS = SQ.ADDRESS; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T08:12:54.937

Remove the NOWAIT, and monitor DBA_BLOCKERS/DBA_WAITERS.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T05:45:46.090

Kindly use

```
select * from v$locked_object 
```

for getting the lock information

Since it is development environment you can try the approach provided in the below link

[https://forums.oracle.com/forums/thread.jspa?threadID=324530](https://forums.oracle.com/forums/thread.jspa?threadID=324530)

A more comprehensive Approach is provided using v$lock at the below link

[http://www.orafaq.com/node/854](http://www.orafaq.com/node/854)

# jquery - 为什么我的 jQuery 内联代码阻止了 MVC3 日期时间编辑器模板中的 jQuery 代码

> ID：10378654
> 
> 赞同：0
> 
> 时间：2012-04-30T04:53:11.530
> 
> 标签：jquery, asp.net-mvc-3, datetimepicker

我在 Views/Shared/EditorTemplates 中有一个 DateTime.cshtml 模板，它使用[TimePicker 插件](http://trentrichardson.com/examples/timepicker/)来实现一个 jQuery DateTime 选择器。这一直运行良好，直到......

我最近在我的 CheckOut 页面中添加了一些内联 jQuery 来处理从购物车中删除项目，这导致 jQuery DateTime 选择器在编辑日期/时间时不再出现。模板的 MVC 日期格式部分（见下文）仍在应用中，但是关于内联 jQuery 的某些内容不能与模板 jQuery 配合使用。

如果我在我的 CheckOut 视图上注释掉内联 jQuery，当我单击编辑日期/时间字段时，DateTime 选择器就会出现。

谁能看到我的内联 jQuery 的哪一部分与模板 jQuery 发生冲突？

**DateTime.cshtml 模板**

```
 @model Nullable<System.DateTime> 

@if ( Model.HasValue ) { 
   @Html.TextBox( "" , String.Format( "{0:dd/MM/yy HH:mm tt}" , Model.Value ) , new { @class = "textbox" , @style = "width:200px;" } ) 
} 
else { 
   @Html.TextBox("", String.Format("{0:dd/MM/yy HH:mm tt}", DateTime.Now), new { @class = "textbox", @style = "width:200px;" }) 
} 

@{ 
string name = ViewData.TemplateInfo.HtmlFieldPrefix; 
string id = name.Replace( ".", "_" ); 
} 
<script type="text/javascript">
    $(document).ready(function () {
        $("#@id").datetimepicker
            ({
                dateFormat: 'dd/mm/yy',
                showStatus: true,
                showWeeks: true,
                highlightWeek: true,
                numberOfMonths: 1,
                showAnim: "scale",
                ampm: true,
                hour: 12,
                minute: 0,
                stepMinute: 5,
                hourMin: 6,
                hourMax: 16,
                showOptions: {
                    origin: ["top", "left"]
                }
            });
    }); 
</script> 
```

**结帐查看 jQuery**

```
 <script type="text/javascript">
    $(function () {
        // Document.ready -> link up remove event handler
        $(".RemoveLink").click(function () {
            // Get the id from the link
            var recordToDelete = $(this).attr("data-id");
            if (recordToDelete != '') {
                // Perform the ajax post
                $.post("/ShoppingCart/RemoveFromCart", { "id": recordToDelete },
                    function (data) {
                        // Successful requests get here
                        // Update the page elements
                        if (data.ItemCount == 0) {
                            $('#row-' + data.DeleteID).fadeOut('slow');
                        } else {
                            $('#item-count-' + data.DeleteID).text(data.ItemCount);
                        }
                        //Hide the 'Checkout' button if there is no items in the cart.
                        if (data.CartTotal == 0) {
                            $('#checkout-button').fadeOut('slow');
                        }
                        $('#cart-total').text(data.CartTotal);
                        $('#update-message').text(data.Message);
                        $('#cart-status').text('Cart (' + data.CartCount + ')');
                    });
            }
        });
    });
</script> 
```

**相关生成的 HTML**

```
 <div class="editor-label">
        <label for="Order_PickUpDateTime">Pick up Date and Time</label>
    </div>
    <div class="editor-field">

<input class="textbox" data-val="true" data-val-required="Pick up date and time is required" id="Order_PickUpDateTime" name="Order.PickUpDateTime" style="width:200px;" type="text" value="30/04/12 16:38 PM" /> 
<script type="text/javascript">
$(document).ready(function () {
    $("#Order_PickUpDateTime").datetimepicker
        ({
            dateFormat: 'dd/mm/yy',
            showStatus: true,
            showWeeks: true,
            highlightWeek: true,
            numberOfMonths: 1,
            showAnim: "scale",
            ampm: true,
            hour: 12,
            minute: 0,
            stepMinute: 5,
            hourMin: 6,
            hourMax: 16,
            showOptions: {
                origin: ["top", "left"]
            }
        });
}); 
</script>

        <span class="field-validation-valid" data-valmsg-for="Order.PickUpDateTime" data-valmsg-replace="true"></span>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T01:53:06.097

我自己想通了。

我从页面顶部删除了以下 jQuery 引用，我的日期/时间选择器再次开始工作：

```
<script src="../../Scripts/jquery-1.5.1.min.js" type="text/javascript"></script> 
```

这个文件已经在我的 Razor Shared/_Layout.cshtml 'master page' 中被引用。

我不知道为什么这种双重参考会导致日期时间选择器不起作用，但我很想听听任何人对此的想法。

# eclipse - Cannot instantiate the type Iterator in JSP (Exception: The value for the useBean class attribute ... is invalid)

> ID：10378655
> 
> 赞同：1
> 
> 时间：2012-04-30T04:53:12.783
> 
> 标签：eclipse, jsp, servlets, instantiation, usebean

this is my code, it seems right to me! i don't know why it keeps saying this:

"Cannot instantiate the type Iterator"

this is the servlet:

```
package uges.servlets;

import jess.*;
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import java.util.Iterator;

public class Catalog extends BaseServlet {

public void doGet(HttpServletRequest request,
                   HttpServletResponse response)
    throws IOException, ServletException {
    checkInitialized();

    try {
        String customerId =
            (String) request.getParameter("customerId");
        if (customerId == null || customerId.length() == 0) {
            dispatch(request, response, "/index.html");
            return;
        }

        request.getSession().invalidate();
        HttpSession session = request.getSession();

        session.setAttribute("customerId", customerId);
        session.setAttribute("orderNumber",
                             String.valueOf(getNewOrderNumber()));

        ServletContext servletContext = getServletContext();
        Rete engine = (Rete) servletContext.getAttribute("engine");
        Iterator result =
            engine.runQuery("all-products", new ValueVector());
        request.setAttribute("queryResult", result);

    } catch (JessException je) {
        throw new ServletException(je);
    }

    dispatch(request, response, "/catalog.jsp");
} 
```

this is the dispatch method, it 's in a servlet called BaseServlet:

```
protected void dispatch(HttpServletRequest request,
                        HttpServletResponse response,
                        String page)
    throws IOException, ServletException {

    ServletContext servletContext = getServletContext();
    RequestDispatcher dispatcher =
        servletContext.getRequestDispatcher(page);
    dispatcher.forward(request, response);
} 
```

and this the JSP code:

```
<HTML>
<%@ page import="jess.*" %>
<jsp:useBean id="queryResult" class="java.util.Iterator" scope="request"/> 
```

the error is about the java.util.Iterator in the class type of useBean tag!

the exception says : The value for the useBean class attribute java.util.Iterator is invalid

any help please ..

Thanks in advance!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T08:51:46.443

java.util.Iterator 是一个接口，而不是一个类。你要

```
<jsp:useBean id="queryResult" type="java.util.Iterator" scope="request"/> 
```

为了确认这一点，我使用了以下测试代码：

```
package org.apache.markt.so;

import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/Q001Servlet")
public class Q001Servlet extends HttpServlet {
    private static final long serialVersionUID = 1L;

    @Override
    protected void doGet(HttpServletRequest request,
            HttpServletResponse response) throws ServletException, IOException {

        List<String> list = new ArrayList<String>();
        list.add("item1");
        list.add("item2");

        request.setAttribute("list", list.iterator());

        RequestDispatcher rd = request.getRequestDispatcher("/so/q001.jsp");
        rd.forward(request, response);
    }
} 
```

使用以下 /so/q001.jsp

```
<html>
<jsp:useBean id="list" type="java.util.Iterator" scope="request" />
<body>
  <p><%=list.next()%></p>
</body>
</html> 
```

这是使用最新开发分支中的 HEAD，但您会看到与最新 Tomcat 7 版本相同的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:24:38.077

这是一个演示我的想法的 JSP。

```
<%@ page import="java.util.*" %>
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%> 
<%
   //for testing
   List<String> engineList = new ArrayList<String>();
   engineList.add("zero");
   engineList.add("one");
   engineList.add("two");
   engineList.add("three");
   Iterator<String> result = engineList.iterator();
   // create a list from engine result
   List<String> list = new ArrayList<String>();
   while(result.hasNext())list.add(result.next());
   request.setAttribute("list", list);
%>
<html>
<body>
Complete list is${list}
The first item is ${list[0]}. 
The second item is ${list[1]}. 
If you don't know how many items there are in result, then use JSTL 
<c:forEach var="item" items="${list}" >
        ${item}
</c:forEach>
</body>
</html> 
```

# python - Django NameError urls.py

> ID：10378656
> 
> 赞同：1
> 
> 时间：2012-04-30T04:53:20.647
> 
> 标签：python, django, sitemap, django-urls, nameerror

我收到一个名称错误：`name sitemaps is not defined`当我尝试将站点地图与我的应用程序集成时，来自我的 urls.py。

从我的 urls.py：

```
from django.contrib.sitemaps import Sitemap

(r'^sitemap\.xml$', 'django.contrib.sitemaps.views.sitemap', {'sitemaps': sitemaps}), 
```

我的 urls.py 中的这个正则表达式有问题吗？或者还有其他问题吗？

感谢您的输入

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T05:01:20.027

通常你会做这样的事情 -

```
from django.contrib.sitemaps import Sitemap, FlatPageSitemap

sitemaps = {
  'site': Sitemap,
  'flatpages': FlatPageSitemap,
}

# ..
# Some url patterns. urlpatterns must be defined by now
# ..

urlpatterns += patterns("",
  url(r'^sitemap\.xml$', 
      'django.contrib.sitemaps.views.sitemap', 
      {'sitemaps': sitemaps}
  ),
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T04:54:30.637

从[文档](https://docs.djangoproject.com/en/dev/ref/contrib/sitemaps/#initialization)：

> `sitemaps`应该是一个将短节标签（例如，`blog`或`news`）映射到其`Sitemap`类（例如，`BlogSitemap`或`NewsSitemap`）的字典。它也可以映射到一个类的*实例*`Sitemap`（例如，`BlogSitemap(some_var)`）。

所以...定义它。

# linux - In case of converation error , how to return to the application without checking other methods in pam

> ID：10378659
> 
> 赞同：0
> 
> 时间：2012-04-30T04:53:32.913
> 
> 标签：linux, login, pam

Let us say for my application APP , I have added a file in /etc/pam.d/APP and in APP I have defined the following:

```
 ....
    ....
    auth required method1
    auth required method2
    auth sufficient method3
    ....
    .... 
```

In case of a conversation failure in method1 , how to return without calling pam_sm_authenticate in method2 and method3.

Thanks

-SomaSekhar

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T16:40:09.453

如果你做第一行：

```
auth requisite method1 
```

然后 pam 将立即返回失败。

# php - PHP proc_open 环境变量

> ID：10378660
> 
> 赞同：0
> 
> 时间：2012-04-30T04:53:34.147
> 
> 标签：php, linux, environment-variables, process, proc-open

我正在尝试使用[proc_open()](http://php.net/manual/en/function.proc-open.php)函数运行进程。正如页面上指定的 - 我提供了自定义环境变量并尝试打印出来。它显示了我提供的所有变量 + 总是 3 个变量：'SHVLL'、'PWD'、'_='。我只想打印/使用我提供的环境变量。这 3 个总是与此功能一起出现吗？有没有办法只提供变量？这一切都在 Linux 和 PHP5 下。

```
//Here is the code to clarify : 
$descriptorspec = array(
0 => array("pipe", "r"),  // stdin is a pipe that the child will read from
1 => array("pipe", "w"),  // stdout is a pipe that the child will write to
2 => array("file", "/tmp/error-output.txt", "a") // stderr is a file to write to
);

$env = array('MY_VAR' => 'FOO');

$process = proc_open('./run.php', $descriptorspec, $pipes, $cwd, $env);

if (is_resource($process)) {

fwrite($pipes[0], escapeshellcmd($args));
fclose($pipes[0]);

$output = "";
while (!feof($pipes[1])) {
    $output .= fgets($pipes[1]);
}

print "Output is $output \n";
    fclose($pipes[1]);
    $return_value = proc_close($process);

} 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T05:00:20.567

您可以命名您的环境变量，例如，`PHP_MYVAR`而不是`MYVAR`. 这样您就可以根据公共前缀进行过滤`PHP_`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:02:14.850

这三个变量是由 shell 创建的。如果您不打开外壳，则不会创建它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T22:59:46.480

它只是与Linux有关。它可以在 Solaris 下正常工作。我添加了正则表达式过滤器来删除那些额外的变量。

# sencha-touch - how do i make a Sencha Touch list display in a VBOX layout?

> ID：10378663
> 
> 赞同：6
> 
> 时间：2012-04-30T04:54:16.177
> 
> 标签：sencha-touch

I have a main panel with layout set to vbox. I want to add TWO separate lists to the panel. I want the two lists to appear vertically stacked, and as they overflow the bottom of the main panel, the panel should simply scroll.

However, lists appear to require to be set in a FIT layout, in order to display. Fit layouts do not permit vertically stacking of items.

Am I missing a feature of the layout system that allows me to tell the list to fully display itself inside a parent with a vbox layout?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T05:25:49.087

`Ext.List`组件的超类 is`Ext.DataView`和 not `Ext.Panel`。

因此，您需要在两个单独的面板中添加两个列表，并将这两个面板添加到一个超级面板中。
此外，您需要`layout:'vbox'`为超级面板制作并`layout:'fit'`为其他两个子面板制作

这是你如何做到的。

```
....
....
var superpanel = new Ext.Panel({
    fullscreen: true,
    layout: 'vbox',             // to vertically stack two list.
    items: [
        {
           xtype: 'panel',
           id: 'panel_1',
           width: '100%',
           layout: 'fit',
           items: [
                {
                   xtype: 'list',
                   flex:1,
                   id: 'list1',
                   store: 'samplestore1'
                }
           ]
         },
         {
            xtype: 'panel',
            id: 'panel_2',
            width: '100%',
            layout: 'fit',
            items: [
                 {
                  xtype: 'list',
                  id: 'list2',
                  flex:1,
                  store: 'samplestore2'
                 }
            ]
         }
    ]
 });
....
.... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T10:40:28.490

```
var parent = new Ext.Panel({
    fullscreen: true,
    layout: 'vbox',
    items: [
        {
           xtype: 'list',
           id: 'list_1',
           store: 'store1,
           flex: 1
         },
         {
          xtype: 'list',
           id: 'list_2',
           store: 'store2,
           flex: 1
         }
    ]
 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:51:15.737

将 height:'auto' 放在列表项上

```
items: [
    {
       xtype: 'list',
       height: 'auto'
     },
     {
      xtype: 'list',
       height: 'auto',
     }
] 
```

# actionscript-3 - 如何在 Adob e Flex 4+ 中获取 RadioButtonGroup 的选定索引？

> ID：10378673
> 
> 赞同：0
> 
> 时间：2012-04-30T04:55:40.633
> 
> 标签：actionscript-3, apache-flex, flex4

我知道可以在 radioGroupButton 的更改处理程序或项目单击处理程序上获取选定的值。像这样：

```
protected function rb1_itemClickHandler(event:ItemClickEvent):void
{
    var selectedValue:String=event.currentTarget.selectedValue.toString();          
} 
```

但我需要的是所选值的索引。知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T08:43:22.413

`event.index`像这个例子一样检查：

```
protected function rb1_itemClickHandler(event:ItemClickEvent):void
{
    trace(event.index);
} 
```

# java - Antlr AST 构建

> ID：10378676
> 
> 赞同：1
> 
> 时间：2012-04-30T04:55:56.097
> 
> 标签：java, antlr, abstract-syntax-tree, bnf, antlrworks

我正在尝试使用 ANTLR 为以下语法构建 AST

```
condition_in
    :   column_identifier ('NOT')? 'IN' (sql_element_list | LPAREN select_stmt RPAREN)
    ; 
```

对于上述内容，我如何根据输入在 NOT IN 或 IN 处构建有根树？还是有更好的方法？

同样对于像dicts这样的python，我如何构造一个ast，树，以MAP为根，每个键都有一个子MAP_PAIR：我猜值应该很棒

```
map :   '{' collection_element':'collection_element (',' collection_element':'collection_element)* '}' 
```

我尝试了几种带有标签和树重写的替代方案，但 antrlworks 总是抱怨

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T06:19:50.300

尝试这样的事情：

```
grammar T;

options {
  output=AST;
}

tokens {
  NOT_IN;
  MAP_PAIR;
  MAP;
}

condition_in
 : column_identifier ( 'NOT' 'IN' in_end -> ^(NOT_IN column_identifier in_end)
                     | 'IN' in_end       -> ^('IN' column_identifier in_end)
                     )
 ;

in_end
 : sql_element_list 
 | LPAREN select_stmt RPAREN -> select_stmt
 ;

map
 : '{' (entry (',' entry)*)? '}' -> ^(MAP entry*)

entry
 : k=collection_element ':' v=collection_element -> ^(MAP_PAIR $k $v)
 ;

// ... 
```

# xcode - FMResultSet parameterized query returns no results xcode

> ID：10378684
> 
> 赞同：0
> 
> 时间：2012-04-30T04:57:30.650
> 
> 标签：xcode

I get no result when using the below query however i do when i say "SELECT * FROM ORDER_HEADER". I have typed "SELECT * FROM ORDER_HEADER WHERE CUSTOMER = 1" in SqlLite Database Browser and gotten back the correct data. Why am i not receiving my row result? I have also tried SELECT * FROM ORDER_HEADER WHERE CUSTOMER = %d",1\. Thank you for your help.

```
- (void)viewDidLoad{

[super viewDidLoad];

[super viewDidLoad];
salesOrders = [[NSMutableArray alloc] init];
NSString *databasePath = [[[NSBundle mainBundle] bundlePath] stringByAppendingPathComponent:@"MobilePDQ"];
FMDatabase *db  = [[FMDatabase alloc] initWithPath:databasePath];
[db open];
FMResultSet *fResult = [db executeQueryWithFormat:@"SELECT * FROM ORDER_HEADER WHERE CUSTOMER = %d",1];
NSLog ( @"has results: %@", [fResult hasAnotherRow] ? @"YES" : @"NO" );
while([fResult next])
{
    SalesOrderHeaderController *salesOrder = [SalesOrderHeaderController alloc];
    salesOrder.salesOrderID = [fResult intForColumn:@"ID"];
    salesOrder.creationDate = [fResult stringForColumn:@"CREATION_DATE"];
    [salesOrders addObject:salesOrder];
}
[db close];} 
```

I'm pretty sure it has to do with the CUSTOMER column being a Numeric type? I tried saying "SELECT * FROM ORDER_HEADER WHERE ID = 1" and it worked where ID is an integer primary key datatype. That being said. What do i need to do to search by a Numeric datatype? Thanks again.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T05:21:31.513

似乎您在数据库名称中缺少 .sqlite 。检查数据库是否打开。也试试这个查询

```
[db executeQueryWithFormat:@"SELECT * FROM ORDER_HEADER WHERE CUSTOMER = ?",[NSnumber numberWithInt:1]]; 
```

您的问题可能会得到解决。

# android - Passing images between Activity

> ID：10378689
> 
> 赞同：2
> 
> 时间：2012-04-30T04:58:19.713
> 
> 标签：android, android-image

A bitmap is captured and passed between Activity by declaring static.

## For the first time, the images can be displayed. However, when the second Activity is destroyed and created again, the image cannot be shown. The error is:

```
04-30 12:55:28.988: W/dalvikvm(4034): threadid=1: thread exiting with uncaught exception (group=0x4001d5a0)
04-30 12:55:29.028: E/AndroidRuntime(4034): FATAL EXCEPTION: main
04-30 12:55:29.028: E/AndroidRuntime(4034): java.lang.RuntimeException: Canvas: trying to use a recycled bitmap android.graphics.Bitmap@40531360, 800x480
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.graphics.Canvas.throwIfRecycled(Canvas.java:973)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.graphics.Canvas.drawBitmap(Canvas.java:1062)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.graphics.drawable.BitmapDrawable.draw(BitmapDrawable.java:332)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.widget.ImageView.onDraw(ImageView.java:943)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.View.draw(View.java:7014)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewGroup.drawChild(ViewGroup.java:1732)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1466)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.View.draw(View.java:7126)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewGroup.drawChild(ViewGroup.java:1732)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1459)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewGroup.drawChild(ViewGroup.java:1730)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1459)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewGroup.drawChild(ViewGroup.java:1730)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1459)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewGroup.drawChild(ViewGroup.java:1730)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1459)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewGroup.drawChild(ViewGroup.java:1730)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1459)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.View.draw(View.java:7017)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.widget.FrameLayout.draw(FrameLayout.java:357)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at com.android.internal.policy.impl.PhoneWindow$DecorView.draw(PhoneWindow.java:2054)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewRoot.draw(ViewRoot.java:1632)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewRoot.performTraversals(ViewRoot.java:1335)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1991)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.os.Looper.loop(Looper.java:150)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at android.app.ActivityThread.main(ActivityThread.java:4385)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at java.lang.reflect.Method.invokeNative(Native Method)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at java.lang.reflect.Method.invoke(Method.java:507)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:849)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:607)
04-30 12:55:29.028: E/AndroidRuntime(4034):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

thank you so much!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T09:20:45.827

不要使用静态变量传递它，此规则通常适用于在活动之间共享数据（不是最终的）。

相反，将其传递到意图包中：

```
intent.putExtra("a bitmap", myBitmap); 
```

如果这是一个大图像，您可能希望将其存储到文件中并在意图中传递文件路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T09:21:30.927

错误 -

> 尝试使用回收的位图

当您尝试访问回收的位图时会发生此错误。因此，可能是您正在使用`bitmap.recycle();`然后尝试使用相同的位图，这是不可能的，您不能再次使用回收的位图。最好从中创建一个新的位图或设法不回收位图。

# node.js - 删除 NodeJS Express 中的路由映射

> ID：10378690
> 
> 赞同：24
> 
> 时间：2012-04-30T04:58:45.143
> 
> 标签：node.js, express

我有一条路线映射为：

```
app.get('/health/*', function(req, res){
    res.send('1');
}); 
```

如何在运行时将此路由删除/重新映射到空处理程序？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2015-02-06T15:49:42.137

这将删除`app.use`中间件和/或`app.VERB`(get/post) 路由。在 express@4.9.5 上测试

```
var routes = app._router.stack;
routes.forEach(removeMiddlewares);
function removeMiddlewares(route, i, routes) {
    switch (route.handle.name) {
        case 'yourMiddlewareFunctionName':
        case 'yourRouteFunctionName':
            routes.splice(i, 1);
    }
    if (route.route)
        route.route.stack.forEach(removeMiddlewares);
} 
```

请注意，它**要求**中间件/路由函数具有**名称**：

```
app.use(function yourMiddlewareFunctionName(req, res, next) {
    ...          ^ named function
}); 
```

如果函数是匿名的，它将**不起作用：**

```
app.get('/path', function(req, res, next) {
    ...          ^ anonymous function, won't work                    
}); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-12-25T22:12:22.200

Express（至少从 3.0.5 开始）将其所有路由保留在`app.routes`. 从[文档](http://expressjs.com/api.html#app-settings)中：

> app.routes 对象包含由关联的 HTTP 谓词映射的所有路由。此对象可用于自省功能，例如 Express 在内部不仅将其用于路由，而且还提供默认的 OPTIONS 行为，除非使用 app.options()。您的应用程序或框架也可以通过简单地从该对象中删除路由来删除它们。

你`app.routes`应该看起来类似于：

```
{ get: 
   [ { path: '/health/*',
       method: 'get',
       callbacks: [Object],
       keys: []}]
} 
```

因此，您应该能够循环`app.routes.get`直到找到您要查找的内容，然后将其删除。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-11-08T00:36:26.770

The above approach requires you have a named function for the route. I wanted to do this as well but didn't have named functions for routes so I wrote an npm module that can remove routes by specifying the routing path.

Here you go:

[https://www.npmjs.com/package/express-remove-route](https://www.npmjs.com/package/express-remove-route)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-07T22:18:39.543

可以在服务器运行时删除已安装的处理程序（使用 app.use 添加），尽管没有 API 可以执行此操作，因此不建议这样做。

```
/* Monkey patch express to support removal of routes */
require('express').HTTPServer.prototype.unmount = function (route) {
    for (var i = 0, len = this.stack.length; i < len; ++i) {
        if (this.stack[i].route == route) {
            this.stack.splice(i, 1);
            return true;
        };
    }
    return false;
} 
```

这是我需要的东西，所以很遗憾没有合适的 api，但 express 只是在模仿 connect 在这里所做的事情。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-10-14T18:28:29.870

```
app.get$ = function(route, callback){
  var k, new_map;

  // delete unwanted routes
  for (k in app._router.map.get) {
    if (app._router.map.get[k].path + "" === route + "") {
      delete app._router.map.get[k];
    }
  }

  // remove undefined elements
  new_map = [];
  for (k in app._router.map.get) {
    if (typeof app._router.map.get[k] !== 'undefined') {
      new_map.push(app._router.map.get[k]);
    }
  }
  app._router.map.get = new_map;

  // register route
  app.get(route, callback);
};

app.get$(/awesome/, fn1);
app.get$(/awesome/, fn2); 
```

然后当你去的时候`http://...awesome` `fn2`会被叫:)

编辑：修复代码

Edit2：再次修复...

Edit3：也许更简单的解决方案是在某个时候清除路由并重新填充它们：

```
// remove routes
delete app._router.map.get;
app._router.map.get = [];

// repopulate
app.get(/path/, function(req,res)
{
    ...
}); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-04-30T05:14:04.413

您可以查看 Express[路由中间件](http://expressjs.com/guide.html#route-middleware)并可能进行重定向。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-08-15T22:52:02.580

如上所述，新的 Express API 似乎不支持这一点。

1.  真的有必要完全删除映射吗？如果您只需要停止为路由提供服务，则可以轻松地开始从处理程序返回一些错误。

    唯一（非常奇怪）这还不够好的情况是，如果一直添加动态路由，并且您想完全摆脱旧路由以避免积累太多...

2.  如果你想重新映射它（要么做其他事情，要么将它映射到总是返回错误的东西），你总是可以添加另一个级别的间接：

    ```
    var healthHandler = function(req, res, next) {
        // do something
    };

    app.get('/health/*', function(req, res, next) {
        healthHandler(req, res, next);
    });

    // later somewhere:

    healthHandler = function(req, res, next) {
        // do something else
    }; 
    ```

    在我看来，这比在 Express 中操作一些未记录的内部结构更好/更安全。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-09-03T14:11:06.500

There is no official method but you can do this with **stack**.

```
function DeleteUserRouter(appName){

router.stack = router.stack.filter((route)=>{
  if(route.route.path == `/${appName}`){
     return false;
  }
  return true;
});
} 
```

appName is path name .

Filter the methods in the router.route.stack where the router is express.Router or you can do the same for the app but with app._router.stack.

**Note**: For below 4.0 use - app.router.stack.

# iphone - iPhone 上的 Google 任务

> ID：10378692
> 
> 赞同：0
> 
> 时间：2012-04-30T04:58:55.210
> 
> 标签：iphone

我已经使用 Google 身份验证 API 完成了身份验证。如何将 Google 任务值访问到表视图中并继续

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T05:14:55.780

```
NSString *googleapi = [NSString stringWithString: @"https://maps.googleapis.com/maps/api/place/search/xml?location=34.0522222,-118.2427778&radius=500&types=bank&sensor=false&key=Your_API_Key"];

NSURL *googlePlacesURL = [NSURL URLWithString:googleapi];
NSData *xmlData = [NSData dataWithContentsOfURL:googlePlacesURL]; 
```

[更多 >> 在 iPhone 中使用 Google Places API](http://iphonebyradix.blogspot.in/2011/07/working-with-google-places-api.html)

**编辑添加...**

```
NSString *usergoogleapi = [NSString stringWithString:@"User_API_Key"];// change this api according to user.
NSString *googleapi = [NSString stringWithFormat: @"https://maps.googleapis.com/maps/api/place/search/xml?location=34.0522222,-118.2427778&radius=500&types=bank&sensor=false&key=%@",usergoogleapi]; 
```

希望对你有帮助...

# mysql - MySQL如何存储数据

> ID：10378693
> 
> 赞同：39
> 
> 时间：2012-04-30T04:59:13.713
> 
> 标签：mysql, database, database-design

我环顾谷歌，但没有找到任何好的答案。它是否将数据存储在一个大文件中？它使用什么方法使数据访问比读取和写入常规文件更快？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2018-01-07T10:57:45.487

这个问题有点老了，但我还是决定回答它，因为我一直在做一些研究。我的回答是基于linux文件系统的。基本上，mySQL 将数据存储在硬盘中的文件中。它将文件存储在具有系统变量“datadir”的特定目录中。打开`mysql`控制台并运行以下命令将告诉您该文件夹的确切位置。

```
mysql>  SHOW VARIABLES LIKE 'datadir';
+---------------+-----------------+
| Variable_name | Value           |
+---------------+-----------------+
| datadir       | /var/lib/mysql/ |
+---------------+-----------------+
1 row in set (0.01 sec) 
```

从上面的命令可以看出，我的“datadir”位于`/var/lib/mysql/`. “datadir”的位置在不同的系统中可能会有所不同。该目录包含文件夹和一些配置文件。每个文件夹代表一个 mysql 数据库，并包含包含该特定数据库数据的文件。下面是我系统中“datadir”目录的截图。

[![样本](../Images/3ee11075ad7ad74276431bf8513338be.png)](https://i.stack.imgur.com/NuQ6x.png)

目录中的每个文件夹代表一个 MySQL 数据库。每个数据库文件夹都包含代表该数据库中表的文件。每个表有两个文件，一个带有`.frm`扩展名，另一个带有`.idb`扩展名。请参阅下面的屏幕截图。

[![示例 MySQL 数据库表截图](../Images/a00a65bc9f85ceaef64196c39f4be229.png)](https://i.stack.imgur.com/11QQv.png)

`.frm`表格文件存储表格的格式。详细信息：[MySQL .frm 文件格式](https://dev.mysql.com/doc/internals/en/frm-file-format.html)

该`.ibd`文件存储表的数据。详细信息：[InnoDB File-Per-Table 表空间](https://dev.mysql.com/doc/refman/5.7/en/innodb-multiple-tablespaces.html)

就是这样的人！我希望我帮助了某人。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-04-30T11:03:38.773

> 它是否将数据存储在一个大文件中？

一些 DBMS 将整个数据库存储在一个文件中，一些拆分表、索引和其他对象类型以分隔文件，一些拆分文件不是按对象类型而是按一些存储/大小标准，有些甚至可以[完全绕过文件系统](http://docs.oracle.com/cd/E11882_01/win.112/e10845/ap_raw.htm)等...

我不知道 MySQL 使用哪种策略（这可能取决于您使用的是 MyISAM 还是 InnoDB 等），但幸运的是，这并不重要：从客户端的角度来看，这是客户端的 DBMS 实现细节应该很少担心。

> 它使用什么方法来使数据访问更快，只需读取和写入常规文件？

首先，DBMses 不仅仅与性能有关：

*   他们更关注数据的**安全性**——他们必须确保即使在断电或网络故障的情况下也不会出现数据损坏。¹
*   DBMS 也与**并发**有关——它们必须在访问和可能修改相同数据的多个客户端之间进行仲裁。²

至于您的具体性能问题，关系数据对索引和集群非常“敏感”，DBMS 充分利用它来实现性能。最重要的是，SQL 的基于集合的特性让 DBMS 可以选择检索数据的最佳方式（至少在理论上，一些 DBMS 在这方面比其他的更好）。有关 DBMS 性能的更多信息，我热烈推荐：[使用索引，卢克！](http://use-the-index-luke.com/)

此外，您可能注意到大多数 DBMS 都是相当老的产品。就像*几十年前*一样，从我们行业的角度来看，这确实是亿万年。这样做的结果之一是人们有足够的时间来优化 DBMS 代码库。

理论上，您可以通过文件来实现所有这些事情，但我怀疑您最终会得到一些看起来非常接近 DBMS 的东西（即使您有时间和资源来实际做到这一点）。那么，为什么要重新发明轮子（除非你一开始就不想要轮子；））？

* * *

*¹通常通过某种“日志”或“事务日志”机制。此外，为了最大限度地减少“逻辑”损坏（由于应用程序错误）的可能性并促进代码重用，大多数 DBMS 支持声明性约束（域、键和引用）、触发器和存储过程。*

*²通过[隔离事务](http://en.wikipedia.org/wiki/Isolation_%28database_systems%29)，甚至允许客户端显式锁定数据库的特定部分。*

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-30T05:11:24.977

从技术上讲，一切都是一个“文件”，包括文件夹......你的整个硬盘驱动器都是巨大的文件。话虽如此，是的关系数据库，MySQL 将存储数据包含在硬盘上的数据文件中。数据库和写入/读取文件之间的区别是苹果和橘子。数据库提供了一种结构化的方式来存储和搜索/检索数据，这种方式你永远无法通过读取和写入文件来复制。当然，除非你编写了自己的数据库。

希望有帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-05-29T22:39:27.700

当您将数据存储在平面文件中时，顺序读取是紧凑而高效的，但没有快速的方法来随机访问它。对于可变长度数据（例如文档、名称或字符串）尤其如此。为了允许快速随机访问，大多数数据库使用称为 B-Tree 的数据结构将信息存储在单个文件中。这种结构允许快速插入、删除和搜索，但它可以使用比原始文件多 50% 的空间。但是，通常这不是问题，因为磁盘空间既便宜又大，而主要任务通常需要快速访问。更多信息： [http ://en.wikipedia.org/wiki/B-tree](http://en.wikipedia.org/wiki/B-tree)

仔细查看 MySQL 文档，我们发现索引可以选择设置为“BTREE”或“HASH”类型。在单个 MySQL 文件中，存储了多个索引，它们可以使用任一数据结构。

尽管安全性和并发性很重要，但这些并不是数据库存在的原因，而是附加的特性。最早的数据库之所以**存在**，是因为不可能随机访问包含可变长度数据的顺序文件。

# iphone - iphone: initialize part of a nib file multiple times

> ID：10378694
> 
> 赞同：1
> 
> 时间：2012-04-30T04:59:21.207
> 
> 标签：iphone, objective-c, uitableview, interface-builder

I design my `UITableView` by Interface Builder.

I can use a separate nib file for `UITableViewCell`, but not so convenient for me.

So, I want to have my custom `UITableViewCell` in the same nib file (another object in the same level with UITableView's object)

Do you know how to initialize custom `UITableViewCell` object many times, efficiently way?

Thanks

# java - 将字符串转换为 java 代码

> ID：10378699
> 
> 赞同：0
> 
> 时间：2012-04-30T05:00:28.693
> 
> 标签：java, dynamic

我在运行时构造了一个字符串，例如

```
str = "a+dataValue(i)"; 
```

其中 'a' 是一个变量，`'dataValue(i)'`是一个带有参数 i 的函数

现在我有一个函数，我想在其中使用字符串 str 作为代码的一部分。例如

```
 public void func()
     {
        for(int i=0;i<n;i++)
          Sytem.out.println(converted_to_java_source(str)); //(i.e.) a+dataValue(i);  it should be converted at runtime not compile time 

     } 
```

我需要如下输出：

```
 when a = 2; dataValue(i) returns i; n = 5
 On call to func it should print
 2 3 4 5 6 7 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T05:05:49.080

您正在寻找`eval`与 JavaScript、Perl、Python 等动态类型语言中的函数/方法等效的 Java。不幸的是，没有一个。

在 Java 中有多种方法可以做这种事情，但它们都很昂贵，并且还有许多其他的缺点。

我的建议是寻找另一种（更简单/更便宜）的方式来满足您的要求。

* * *

如果你真的需要走这`eval`条路，那么这里有一些相关的 Q/A，它们对选项进行了合理的覆盖。：

*   [Java 中有 eval() 函数吗？](https://stackoverflow.com/questions/2605032/using-eval-in-java)
*   [是否有与 python eval 函数等效的 java？](https://stackoverflow.com/questions/7143343/is-there-a-java-equivalent-of-the-python-eval-function)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:15:02.180

您可以查看[Byte Code Engineering Libraray (BCEL)](http://commons.apache.org/bcel/)或[ASM](http://asm.ow2.org/)。在任何一种情况下，事情都会变得混乱和过于复杂，所以我会推荐斯蒂芬的建议并尝试寻找另一种方式。

例如，您可以使用 som`if` `else`语句以*通常*的方式调用您的函数，可能类似于：

```
String functionName = "...";
if (functionName.toLowerCase().equals("someMethodName")
{
     someMethodName(someParams);
} 
```

# mysql - MySQL view of just one column?

> ID：10378701
> 
> 赞同：1
> 
> 时间：2012-04-30T05:01:07.717
> 
> 标签：mysql, view

Can a *regular* table (not created by a view) contain a single column which is a view of a column from another table, or does a view always have to create a separate *virtual table?*

If yes, what code (simple example) would be used to add the virtual column?

# java - Red5: Get rtmp stream in java

> ID：10378704
> 
> 赞同：0
> 
> 时间：2012-04-30T05:01:25.510
> 
> 标签：java, red5, rtmp

How to get the current rtmp stream in java on server side?I have seen many pages in StackOverflow, but I got nothing helpful.I think this is a common question.I will be thankful if any one can help me.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T15:55:15.477

在服务器端可以添加 Consumer 或 PipeListener。使用这些意味着您可以对来自流的数据做任何您喜欢的事情。这篇旧的 nabble 帖子还包含有关流事件捕获的更多详细信息：http: [//old.nabble.com/how-can-i-capture-stream-event-in-a-plugin--td28349277.html](http://old.nabble.com/how-can-i-capture-stream-event-in-a-plugin--td28349277.html)

# javascript - Mootools：如果其子项处于活动状态，则打开父/部分手风琴面板

> ID：10378706
> 
> 赞同：0
> 
> 时间：2012-04-30T05:01:48.183
> 
> 标签：javascript, joomla, mootools, accordion

我在这个网站上有 2 个 Mootools 挑战/问题（使用 Joomla 构建），如果有人可以帮助我[链接到该网站](http://dev.digitup.se/suhoski/index.php?option=com_content&view=article&id=89&Itemid=564)，我将不胜感激。

如您所见，我有 4 个手风琴项，其中包括一些子菜单项。主要问题是第一个默认打开，无论其他哪些项目已被单击并处于活动状态。例如，上述链接位于 WEBBDesign 手风琴下。我需要完成的是基本上检查子链接是否处于活动状态并打开相应的父面板。

第二个问题是，如果手风琴中的任何孩子处于活动状态，我想让顶部菜单项 (Tjänster) 处于活动状态。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:24:19.367

我注意到您创建手风琴菜单的电话已

显示：0，

此选项打开具有指定索引的菜单。您需要使用一段 javascript 声明每个页面在手风琴菜单中的位置：

```
<script>
  mymenupos = n;
</script> 
```

然后传递 Fx.accordion 构造函数：

```
 var myAccordion = new Fx.Accordion($('ja-accordion104'), $$('.ja-accordion-title104'), $$('.ja-accordion-content104'), {
        alwaysHide: true,
        display: mymenupos,
        // etc 
```

根据[文档](http://mootools.net/docs/more/Fx/Fx.Accordion)，考虑使用`show`而不是创建菜单，其中项目已经显示，而不是动画显示它，这在这种情况下是多余的。`display``show`

# iphone - why can't my iphone app connect to my server?

> ID：10378707
> 
> 赞同：1
> 
> 时间：2012-04-30T05:02:00.180
> 
> 标签：iphone, rest, networking, get, afnetworking

i have a weird problem. so i've been working on an iphone app where a user can login, and upon logging in, the app would authorize the user by making an http GET request to the server. if the username and password is correct it return an authorization token (typical stuff).

the weird part is that when i test this locally, pointing the http request url to my local machine, it works fine. everything authorizes correctly and all data is returned correctly.

but today, i got the app stable enough that i decided to deploy rest api to my server, but when changed the http request url to my server url, the requests fails.

i thought maybe the server wasn't deployed correctly so i tested the http endpoints with the firefox rest client and everything seems to be working, authorization works, and data gets returned.

does anyone have any thoughts? i'm lost as to what the problem might be.

i'm using AFNetworking library to make the requests.

here's my code:

```
self.apiHttpClient = [[TKRHttpClient alloc] initWithBaseURL:[NSURL URLWithString:@"http://mywebsite.com/api"]];

--------------

NSString *username = [usernameField text];
NSString *password = [passwordField text];
TKRHttpClient *httpClient = [TKRHttpClient sharedInstance];
NSMutableURLRequest *request = [httpClient requestWithMethod:@"GET" path:@"/user/auth" parameters:nil];
[request addValue:username forHTTPHeaderField:@"username"];
[request addValue:password forHTTPHeaderField:@"password"];
AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
    if(response.statusCode == 200){
        NSDictionary * headers = [response allHeaderFields];
        NSString *token = [headers objectForKey:@"auth_token"];
        NSLog(@"token was %@", token);
        [[AppController sharedAppController] initializeDataForUserToken:token];
    }else{
        NSLog(@"upload failed!");
    }
} failure:^(NSURLRequest *request , NSHTTPURLResponse *response , NSError *error , id JSON ) {
    NSLog(@"code was: %i", response.statusCode);
    if(response.statusCode == 401){
        [errorMessage setText:@"Incorrect password or username"];
    }
}];
[operation start]; 
```

i put in break points, and it seems that the request goes straight to the failure block. the line that says "NSLog(@"code was: %i", response.statusCode);" in the failure block prints out 200\. but when i tail the logs on my server, no request was received.

any help would be greatly appreciated. can't figure out for the life of my why it would work against my local tomcat, but won't work when deployed to my server.

thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T13:56:16.130

感谢@Brad 的建议，我找到了问题的原因。

在检查 charles 中的请求后，我发现请求是“http://mywebsite.com”，然后路径是 /user/auth。所以“/ api”部分丢失了。

也许这是标准，我不知道，但似乎 AFHTTPClient 的（我的 TKRHttpClient 扩展了 AFHTTPClient）initWithBaseURL 确实意味着主机 URL。“/api”部分被砍掉了。

它在本地工作的原因是因为我在本地以 root 身份部署了应用程序，所以没有“/api”

所以有两种方法可以解决这个问题。1.以root身份重新部署为应用程序到服务器。或 2\. 更改代码行：

```
NSMutableURLRequest *request = [httpClient requestWithMethod:@"GET" path:@"/user/auth" parameters:nil]; 
```

至：

```
NSMutableURLRequest *request = [httpClient requestWithMethod:@"GET" path:@"api/user/auth" parameters:nil]; 
```

希望这对将来使用 AFNetworking 的人有所帮助。

# git - Maven doesn't copy untracked resources while releasing

> ID：10378708
> 
> 赞同：2
> 
> 时间：2012-04-30T05:02:12.667
> 
> 标签：git, maven, release

My problem is about resources to be included in the jar file when doing release with maven.

I am using maven to build my project and when I run

```
$ mvn package 
```

resources are included in the output jar. But when I run

```
$ mvn release:prepare

$ mvn release:perform 
```

these resources are not included in the release jar.

Resources are located in maven default directory, `src/main/resources`, but they are outside of source control (ignored via `.gitignore`). From the output made by maven I realize that maven does git checkout to different folder and resources are not copied to that folder. This is why maven release plugin doesn't package it to release jar.

My question is what is the best way to deal with such a case?

1.  Make a symlink for resources folder during release process? how?

2.  Copy resources? how?

3.  Or putting resources into SCM is the only way to make them available in released package?

I prepared small testcase for this:

```
#!/bin/sh
# here is pom.xml
cat >pom.xml <<EOF
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <groupId>com.domain</groupId>
  <artifactId>artifact</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <packaging>jar</packaging>

  <name>artifact</name>
  <url>http://maven.apache.org</url>

  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
  </properties>

  <scm>
    <developerConnection>scm:git:file://$(pwd)</developerConnection>
  </scm>

  <distributionManagement>
    <repository>
      <id>internal.repo</id>
      <name>Example Internal Repository</name>
      <url>file://$(pwd)/deploy</url>
    </repository>
  </distributionManagement>

</project>
EOF

#here is src/main/java/Main.java
mkdir src
mkdir src/main
mkdir src/main/java
mkdir src/main/resources

cat >src/main/java/Main.java <<EOF
import java.io.InputStream;

public class Main
{
    public static void main(String args[])
    {
        boolean ok = false;
        InputStream is = new Main().getClass().getResourceAsStream("/some_file_outside_scm");
        ok = is != null;

        System.out.println("ok=" + ok);
    }
}
EOF

#some data in src/main/resources/some_file_outside_scm
cat >src/main/resources/some_file_outside_scm <<EOF
123
456

EOF

#file src/main/resources/.gitignore
cat >src/main/resources/.gitignore <<EOF
some_file_outside_scm
EOF

#.gitignore in the project root
cat >.gitignore <<EOF
target
deploy
EOF

git init .
git add pom.xml
git add src/main/java/Main.java
git commit -m "first commit"

#The test case can be tested with these commands

mvn package
echo !!!!!!!!!!!!!!!!!
echo contents of the packaged jar
jar tf target/artifact-0.0.1-SNAPSHOT.jar
#The file 'some_file_outside_scm' is packaged into jar.

echo !!!!!!!!!!!!!!!!!
echo after mvn package
java -cp target/artifact-0.0.1-SNAPSHOT.jar Main
# ok=true
echo !!!!!!!!!!!!!!!!!

mvn release:prepare
mvn release:perform

echo !!!!!!!!!!!!!!!!!
echo but after mvn release
java -cp deploy/com/domain/artifact/0.0.1/artifact-0.0.1.jar Main
# ok=false

#the file is not included in the release jar
echo !!!!!!!!!!!!!!!!!
echo contents of the release jar
jar tf deploy/com/domain/artifact/0.0.1/artifact-0.0.1.jar 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-05T19:03:49.557

release-plugin 在`release:perform`profile期间激活`release-perform`。您可以使用该配置文件的资源插件来复制您的资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T08:50:49.863

资源必须在您的 SCM 中，因为它们是您项目的一部分。否则，您的项目将无法使用这些资源。因此，您不要将它们置于 src/main/resources 作为其余项目的版本控制下，因此它们永远不会被打包到 jar 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T14:54:13.703

如果您不将资源放入 SCM，则无法将它们作为该项目的一部分发布，正如其他人所提到的。

您可以尝试将资源移动到单独的项目中，并使用[`maven-remote-resources-plugin:bundle`](http://maven.apache.org/plugins/maven-remote-resources-plugin/)它来构建资源包 (jar)。每当您更改该项目中的资源时，您都需要手动修改 POM 中的版本号并执行 a`mvn deploy`以将更改放入您的工件存储库中。

然后，在您当前的项目中，您可以`maven-remote-resources-plugin:process`在构建之前检索资源并将它们放在工件中的适当位置。 `process`默认绑定到`generate-resources`相位；调整它以满足您的需求。

# c# - EF entity.attach does not work

> ID：10378709
> 
> 赞同：4
> 
> 时间：2012-04-30T05:02:12.717
> 
> 标签：c#, .net, entity-framework, sql-server-ce

I have an entity retrieved from db as follows

```
using ( var ctx = new Mycontext() )
   return ctx.MyGroups.First( // query ); 
```

this is bound to UI and updated on user save action as follows

```
using ( var ctx = new Mycontext() )
{
    ctx.MyGroups.Attach(o); // verified object o is updated 
    ctx.SaveChanges();

} 
```

However the db is NOT updated

Environment is .net 4.0, db is sql compact 4

Any help on what could be missing/wrong ?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-30T08:49:20.100

当您将对象附加到上下文时，它们的默认状态是未更改，您应该通过设置强制更新`DBContext.Entry(entity).State = EntityState.Modified;`并且仅在该调用之后`DBContext.SaveChanges();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T08:58:58.357

正如[Ciobanu Ion](https://stackoverflow.com/users/1160440/ciobanu-ion)所建议的，这是您的解决方案：

```
using ( var ctx = new Mycontext() ) 
{ 
    ctx.MyGroups.Attach(o); // verified object o is updated  
    ctx.ObjectStateManager.ChangeObjectState(o, EntityState.Modified);
    ctx.SaveChanges(); 

} 
```

*编辑*从 EF 6 开始，上述解决方案不起作用。相反，请使用以下内容：

```
using ( var ctx = new Mycontext() )
{
    ctx.MyGroups.Attach(o); // verified object o is updated 
    ctx.Entry(entity).State = EntityState.Modified;
    ctx.SaveChanges();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T05:34:59.230

`Attach`方法依赖于主键将实体附加到对象上下文。在我看来，当您的对象从视图和模型绑定更改时，更新的对象中缺少主键值。

# java - 设置背景图片

> ID：10378716
> 
> 赞同：0
> 
> 时间：2012-04-30T05:03:10.970
> 
> 标签：java, android, background

我通过以下方式设置了我的活动背景：

```
<LinearLayout 
xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent" 
android:layout_height="fill_parent"
android:background="@drawable/image"> 
```

我在做什么：在我的主要活动中，它将选择我想要 image1 还是 image2，然后将 image1 或 image 2 作为活动的背景。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T05:09:22.417

试试这个

```
LinearLayout linearLayout = (LinearLayout)findViewById(R.id.linear);
if(condition1)
linearLayout.setBackgroundResource(R.drawable.image1);
else
linearLayout.setBackgroundResource(R.drawable.image2); 
```

在 XML 中，

```
<LinearLayout 
xmlns:android="http://schemas.android.com/apk/res/android"
android:id = "@+id/linear"
android:layout_width="fill_parent" 
android:layout_height="fill_parent"
/> 
```

这将起作用。根据条件，它会设置 image1 或 image2

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:06:27.853

使用该`LinearLayout`方法`setBackgroundResource`并给它drawble id。

# knockout.js - 如何在数据绑定中设置图像的点击属性

> ID：10378717
> 
> 赞同：1
> 
> 时间：2012-04-30T05:03:14.627
> 
> 标签：knockout.js

看法：

```
<td style="white-space: nowrap;">
   <img data-bind="attr: { onclick: PlaySounds }" src="/Images/audioGreen.png" alt="Pronounce word" title="Pronounce word" style="cursor: pointer" />
   <a data-bind="attr: { href: GoogleQuery }" target="_blank">
      <img src="/Images/googleIcon.png" alt="Google Search" title="Google Search" style="cursor: pointer" />
   </a>
</td> 
```

淘汰赛视图模型：

```
function DictionaryEntry() {
   var self = this;
   self.Simplified = ko.observable("");
   self.Traditional = ko.observable("");
   self.Phonetic = ko.observable("");
   self.Definition = ko.observable("");

   self.GoogleQuery = ko.computed(function () {
       return "http://www.google.com/search?q=" + self.Simplified();
   }, self);

   self.PlaySounds = ko.computed(function () {
       return "playSounds('" + self.Phonetic() + "')";
   }, self);
} 
```

关于“attr”绑定的信息：“ [http://knockoutjs.com/documentation/attr-binding.html](http://knockoutjs.com/documentation/attr-binding.html) ”

错误详情：

> Microsoft JScript 运行时错误：无法解析绑定。消息：ReferenceError：“PlaySounds”未定义；绑定值：attr: { onclick: PlaySounds }

不知道我哪里出错了。如果可能，直接绑定而不使用 ko.computed 值将是一个好处。无论哪种方式的解决方案将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T05:28:28.707

您不需要使用`attr`绑定来将功能绑定到点击，为此您应该使用 Knockout`click`绑定：

```
<img data-bind="click: playSounds" src="/Images/audioGreen.png"
     alt="Pronounce word" title="Pronounce word" style="cursor: pointer" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-24T08:22:24.480

我正在回答我自己的问题......有点晚了，但我希望它可以帮助别人：

我为使其工作所做的工作是使用：`click: $root.PlaySounds`并在我的主 ViewModel 中使用该功能..而不是 DictionaryEntry（子）模型.. 像这样：

```
self.PlaySounds = function (entry) {
                playSounds(entry.Phonetic);
                return false;
            }; 
```

那效果很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T22:56:22.613

你想要的绑定是`click: function() { playSounds(Phonetic()) }`. 如果您希望我们实际调试特定错误，请提供您的代码示例（例如，在 jsfiddle 中）。

# html - HTML5 拖放，还是 JqueryUI 拖放？

> ID：10378721
> 
> 赞同：3
> 
> 时间：2012-04-30T05:03:21.090
> 
> 标签：html, jquery-ui, drag-and-drop

我正在开发一个客户端应用程序。它不需要跨浏览器。而且我想使用拖放功能。

我熟悉JqueryUI拖放，但我想知道哪个在性能和易于编程方面更好，Html5还是JqueryUI？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T07:29:39.070

我最近制作了一个应用程序，它允许用户在数百个列表（拖放区）之间拖放数百个项目（包含大量 CSS），我体验了 jQuery 的糟糕性能。然后我改用 HTML5 Drag and Drop API，因为整个事情即使在第一代迅驰上也能顺利运行。难怪，因为使用了本机代码。

HTML5 API 需要习惯，因为它通常也是用非鼠标​​控制设备编写的，但结果并不比 jQuery UI 代码复杂。

因此，作为一个结论，我认为当您只有少量要拖动的项目时，坚持使用 jQuery UI 是可以的。我还希望 jQuery UI 在未来的某个时间在内部使用 HTML5 API，这样您就可以通过升级到另一个 jQuery 版本来自动获得本机代码的好处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-07-26T05:53:22.977

尽管 Jquery UI 提供了额外的功能，但在许多情况下我们不需要它们，这反过来又变得很重，另一方面 HTML5 拖放 API 又流畅又轻巧。

所以它取决于用户：如果你想要额外的功能去 Jquery UI 否则选择 HTML5 拖放

-莫希特

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-05T13:27:46.953

我建议你使用 JqueryUI。它更灵活。将来您改进它会更容易。我从未使用过 HTML5 拖放，也不知道它的存在。所以我无法比较它们，但我认为 jQuery 会更好。

# c++ - OpenCV 线检测

> ID：10378722
> 
> 赞同：2
> 
> 时间：2012-04-30T05:03:23.077
> 
> 标签：c++, opencv, image-processing

我试图在这张图片中找到居中框的边缘： ![黑白盒子](../Images/65ce0200c93e3305f1463c25d97f824f.png)

我尝试过使用 dRho=img_width/1000、dTheta=pi/180 和 threshold=250 的 HoughLines 它在此图像上效果很好，缩放到大小的 1/3，但在全尺寸图像上它只是到处都有线条在各个方向...

我能做些什么来调整这个更准确？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T12:58:36.177

The code to achieve the result below is a slight modification of the one presented in this answer: [how to detect a square](https://stackoverflow.com/questions/7731742/square-detection-doesnt-find-squares/7732392#7732392):

![enter image description here](../Images/ff9e2b069bb40f86531156442c028df2.png)

The original program can be found inside OpenCV, it's called **squares.cpp**. The code below was modified to search squares only in the first color plane, but as it still detects many squares, at the end of the program I discard all of them except the first, and then call `draw_squares()` to show what was detected. You can change this easilly to draw all of them and see everything that was detected.

You can do all sorts of thing from now own, including setting a (ROI) region of interest to extract the area that's inside the square (ignore everything else around it).

You can see that the detected rectangle is not perfectly aligned with the lines in the image. You should perform some pre-processing (erode?) operations in the image to decrease the thickness of lines and improve the detection. But from here on it's all on you:

```
#include <cv.h>
#include <highgui.h>

using namespace cv;

double angle( cv::Point pt1, cv::Point pt2, cv::Point pt0 ) {
    double dx1 = pt1.x - pt0.x;
    double dy1 = pt1.y - pt0.y;
    double dx2 = pt2.x - pt0.x;
    double dy2 = pt2.y - pt0.y;
    return (dx1*dx2 + dy1*dy2)/sqrt((dx1*dx1 + dy1*dy1)*(dx2*dx2 + dy2*dy2) + 1e-10);
}

void find_squares(Mat& image, vector<vector<Point> >& squares)
{
    // TODO: pre-processing

    // blur will enhance edge detection
    Mat blurred(image);
    medianBlur(image, blurred, 9);

    Mat gray0(blurred.size(), CV_8U), gray;
    vector<vector<Point> > contours;

    // find squares in the first color plane.
    for (int c = 0; c < 1; c++)
    {
        int ch[] = {c, 0};
        mixChannels(&blurred, 1, &gray0, 1, ch, 1);

        // try several threshold levels
        const int threshold_level = 2;
        for (int l = 0; l < threshold_level; l++)
        {
            // Use Canny instead of zero threshold level!
            // Canny helps to catch squares with gradient shading
            if (l == 0)
            {
                Canny(gray0, gray, 10, 20, 3); // 

                // Dilate helps to remove potential holes between edge segments
                dilate(gray, gray, Mat(), Point(-1,-1));
            }
            else
            {
                    gray = gray0 >= (l+1) * 255 / threshold_level;
            }

            // Find contours and store them in a list
            findContours(gray, contours, CV_RETR_LIST, CV_CHAIN_APPROX_SIMPLE);

            // Test contours
            vector<Point> approx;
            for (size_t i = 0; i < contours.size(); i++)
            {
                    // approximate contour with accuracy proportional
                    // to the contour perimeter
                    approxPolyDP(Mat(contours[i]), approx, arcLength(Mat(contours[i]), true)*0.02, true);

                    // Note: absolute value of an area is used because
                    // area may be positive or negative - in accordance with the
                    // contour orientation
                    if (approx.size() == 4 &&
                            fabs(contourArea(Mat(approx))) > 1000 &&
                            isContourConvex(Mat(approx)))
                    {
                            double maxCosine = 0;

                            for (int j = 2; j < 5; j++)
                            {
                                    double cosine = fabs(angle(approx[j%4], approx[j-2], approx[j-1]));
                                    maxCosine = MAX(maxCosine, cosine);
                            }

                            if (maxCosine < 0.3)
                                    squares.push_back(approx);
                    }
            }
        }
    }
}

void draw_squares(Mat& img, vector<vector<Point> > squares)
{
    for (int i = 0; i < squares.size(); i++)
    {
        for (int j = 0; j < squares[i].size(); j++)
        {
            cv::line(img, squares[i][j], squares[i][(j+1) % 4], cv::Scalar(0, 255, 0), 1, CV_AA);
        }
    }
}

int main(int argc, char* argv[])
{
    Mat img = imread(argv[1]);

    vector<vector<Point> > squares;
    find_squares(img, squares);

    std::cout << "* " << squares.size() << " squares were found." << std::endl;

    // Ignore all the detected squares and draw just the first found
    vector<vector<Point> > tmp;
    if (squares.size() > 0)
    {
        tmp.push_back(squares[0]);
        draw_squares(img, tmp);
    }
    //imshow("squares", img);
    //cvWaitKey(0);

    imwrite("out.png", img);

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T07:27:42.320

在调整图像大小时，通常首先使用滤波器（例如高斯）对图像进行模糊处理，以去除高频。调整大小效果更好的事实可能是因为您的原始图像有点嘈杂。

首先尝试模糊图像，例如使用`cv::GaussianBlur(src, target, Size(0,0), 1.5)`，然后它应该相当于调整大小。（理论忘记了，如果不行就试试3和6）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-30T07:19:17.947

尝试使用带有侵蚀过滤器的预处理通道。它会给你与缩小相同的效果 - 线条会变得更细并且不会同时消失。

正如 chaiy 所说，“模糊”滤镜也是一个好主意。

这样（模糊）它将变成类似[http://www.ic.uff.br/~laffernandes/projects/kht/index.html](http://www.ic.uff.br/~laffernandes/projects/kht/index.html) （基于内核的霍夫变换）

# python - 从 Python 调用 DOS 可执行文件

> ID：10378729
> 
> 赞同：1
> 
> 时间：2012-04-30T05:03:41.027
> 
> 标签：python

对不起，如果这个问题已经被问过很多次了。我有一个 DOS .exe 文件。通过在 Windows 中双击它可以很好地工作，这会在工作文件夹中生成一些输出文件。但是，我需要从 Python 调用它。我尝试了以下命令（subprocess.Popen 和 os.system），但它只打开一个 DOS 窗口而不保存输出文件。那么有人可以给我一个提示吗？

谢谢！

**代码**

```
a=subprocess.Popen(r"I:/dosefile.exe")
a1=os.system(r"I:/dosefile.exe") 
```

**更新** 它通过将.py脚本文件放入包含dosefile.exe的折叠中来工作。有没有办法让它在不迁移 .py 文件的情况下工作？

想办法。如果 .py 文件在其他地方，我需要使用 os.chdir() 更改工作文件夹

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:08:58.037

尝试将其称为系统调用

```
import os
os.system('I:/dosefile.exe') 
```

然后解析它创建的输出文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T07:10:47.280

更好的方法是使用：

`os.chdir('I:')`

然后你可以使用 subrprocess.
os.system 非常有限，应该首选 subprocess.Popen。

**更好**的是使用 subprocess.Popen 关键字“cwd”，它设置工作目录。

```
subprocess.Popen(self, args, bufsize=0, executable=None, stdin=None, stdout=None, stderr=None,\
preexec_fn=None, close_fds=False, shell=False, cwd=None, env=None, universal_newlines=False, \
startupinfo=None, creationflags) 
```

Python 是一种易于练习的语言，像 os.system 这样的东西确实有效，因为 Python 非常宽容（不像 C ......）。但是，我真的建议努力学习 Python 附带的更强大的工具。
以后你不会后悔的。

# php - 基本 PHP 安全问题

> ID：10378730
> 
> 赞同：0
> 
> 时间：2012-04-30T05:04:03.927
> 
> 标签：php, sql, security

所以我不是真正的后端开发人员，但我需要开发一个基本的密码登录。（完全不合理的）客户明确表示他只想输入密码。不能传递用户名或任何其他信息。由于没有任何用户，因此只有一个密码，我直接将其编码到脚本中。看起来像：

```
$password = $_POST['password']

if ($password == 'mypass') {

do something....

} 
```

这是否容易受到某种注入黑客的攻击？还有其他我应该担心的巨大安全漏洞吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T05:10:28.477

> 这是否容易受到某种注入黑客的攻击？

不，因为你没有向其他任何东西注入任何东西。

> 还有其他我应该担心的巨大安全漏洞吗？

*   它具有极低的熵，攻击者只是自动尝试随机密码不应该有太多的麻烦进入。你可能已经意识到这一点。
*   如果您的服务器曾经被破坏和/或源代码被泄露，硬编码的密码将被泄露并立即可用。您至少可以对其进行加盐和哈希处理以防止发生这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T05:12:34.927

不，您的代码不是易受攻击或可利用的，但是可以改进它。

我建议散列您的密码并使用 srtcmp 而不是 == 运算符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T09:05:10.053

有一种情况可能会受到攻击，您可能会或可能不会遭受攻击。

您的示例要求用户发布密码，重要的是，它没有表明它正在维护服务器端会话。如果没有会话正在使用，这意味着只有包含此代码并且发布了密码的页面才会受到保护。

**如果**您开发了一个多页 Web 应用程序，并且没有将此密码检查代码放入每个敏感资源中，那么您将很容易受到授权绕过攻击。

例如，如果您的网站的页面位于

1.  [http://example.com/](http://example.com/) *公共*
2.  [http://example.com/admin/](http://example.com/admin/) *私有和受保护*
3.  [http://example.com/admin/users.php](http://example.com/admin/users.php) *私有且不受保护*

恶意用户可以直接访问 /admin/users.php，完全绕过您的授权机制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T09:15:03.803

尽可能始终使用一种方式散列，用于存储在数据库表中或硬编码。您可以硬编码密码的 MD5 哈希值，而不是硬编码明文密码。然后计算用户输入的哈希值，然后比较两者。这样你就不必担心有人窃取你的代码并用它泄露密码。

# java - 使用 Java 客户端访问 .NET Web 服务

> ID：10378731
> 
> 赞同：0
> 
> 时间：2012-04-30T05:04:11.857
> 
> 标签：java, web-services, wsdl

我正在尝试使用 Java 客户端访问 .NET Web 服务：

1.  网豆7.01
2.  贾克斯
3.  JDK6
4.  Glassfish 服务器。

我可以使用 .NET Web 服务提供的 WSDL 文件创建存根。但我收到错误：

```
Exception in thread "main" javax.xml.ws.soap.SOAPFaultException: MustUnderstand
headers:[{http://www.w3.org/2005/08/addressing}Action] are not understood
at com.sun.xml.internal.ws.protocol.soap.MUTube.createMUSOAPFaultException(MUTube.java:143)
at com.sun.xml.internal.ws.protocol.soap.ClientMUTube.processResponse(ClientMUTube.java:85)
at com.sun.xml.internal.ws.api.pipe.Fiber.__doRun(Fiber.java:597)
at com.sun.xml.internal.ws.api.pipe.Fiber._doRun(Fiber.java:546)
at com.sun.xml.internal.ws.api.pipe.Fiber.doRun(Fiber.java:531)
at com.sun.xml.internal.ws.api.pipe.Fiber.runSync(Fiber.java:428)
at com.sun.xml.internal.ws.client.Stub.process(Stub.java:211)
at com.sun.xml.internal.ws.client.sei.SEIStub.doProcess(SEIStub.java:124)
at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:98)
at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:78)
at com.sun.xml.internal.ws.client.sei.SEIStub.invoke(SEIStub.java:107)
at $Proxy30.helloMperks(Unknown Source)
at HTTPMain.main(HTTPMain.java:25) 
```

当我通过 Java 客户端访问 .NET Web 服务时。

但我可以使用 .NET Web 客户端访问 .NET Web 服务而不会出现任何错误。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T06:57:31.760

在尝试了不同风格的 Web 服务客户端生成器后，我最终使用 Apache Axis2 作为 Web 服务类生成器，用于连接 MS Dynamics 3 和 4 版本（基于 .Net 框架）。生成器（基于命令行）生成一堆类，我将它们复制到我的 Netbeans 6.9 项目的 src 文件夹中，从中编译、构建和部署它。从那时起，我遇到的主要困难是：

*   身份验证/授权部分，前者是 ntlm，后者必须在 MS Dynamics CRM 中进行配置。
*   向 MS Crm 构建肥皂问题的链接实体方式。

有很多库可供使用（ear 文件 = + 40Mb），但运行良好。我在带有 Jdk1.4 的 Weblogic 8 上开始了该项目，现在它在带有 Jdk1.6 的 Weblogic 10 上运行。问候

# c++ - boost 序列化多态问题

> ID：10378733
> 
> 赞同：2
> 
> 时间：2012-04-30T05:05:12.960
> 
> 标签：c++, serialization, boost, polymorphism, boost-serialization

多态类的Boost序列化似乎不起作用（1.40+ boost），例如使用以下代码，我相信我遵循了规则：导出类，我在gcc4.4（ubuntu）和windows VS2010（使用boost 1.48）上都试过了：在下面的程序中，我希望同时打印 10 和 100，但它只打印 10，这意味着它只序列化了基类；

我主要是从 boost 的文档中复制了这个例子，但它仍然不起作用；有人知道吗？非常感谢LS

```
#include <iostream>
#include <sstream>
#include <boost/serialization/base_object.hpp>
#include <boost/serialization/serialization.hpp>
#include <boost/archive/text_oarchive.hpp>
#include <boost/archive/text_iarchive.hpp>
#include <boost/serialization/export.hpp>
#define NVP(X) X

class base {
public:
friend class boost::serialization::access;
base (){ v1 = 10;}
int v1;
template<class Archive>
void serialize(Archive & ar, const unsigned int file_version)
{
    ar & NVP(v1);
}
};

class derived : public base {
public:
friend class boost::serialization::access;
int v2 ;
derived() { v2 = 100;}
template<class Archive>
void serialize(Archive & ar, const unsigned int file_version){
    boost::serialization::base_object<base>(* this);
    ar & NVP(v2);
}
};
BOOST_CLASS_EXPORT(base);
BOOST_CLASS_EXPORT_GUID(derived, "derived");

int main ( ) 
{
std::stringstream ss;
boost::archive::text_oarchive ar(ss);
base *b = new derived();
ar << NVP(b);
std::cout << ss.str();
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-30T21:00:05.020

你忘了

```
virtual ~base() {} 
```

这不仅是多态序列化工作所必需的（没有它，你的类就**不是**多态的），而且我相信在 48 个州忽略它是一种轻罪。IANAL，所以 YMMV。

哦，它应该是`ar & boost::serialization::base_object<...>`。

# php - 如何删除表格中的一行

> ID：10378735
> 
> 赞同：-5
> 
> 时间：2012-04-30T05:05:23.217
> 
> 标签：php, sql

如何使用 PHP 和 MYSQL 删除表中的一行？使用 account_name、maintenance_type、ma_status、ma_contract_start、ma_contract_end、ma_reference_no

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T05:07:09.647

```
DELETE FROM a_table WHERE account_name="someaccountname" AND maintenance_type="whatever"   etc... 
```

*   [http://dev.mysql.com/doc/refman/5.5/en/delete.html](http://dev.mysql.com/doc/refman/5.5/en/delete.html)
*   [http://www.tizag.com/mysqlTutorial/mysqldelete.php](http://www.tizag.com/mysqlTutorial/mysqldelete.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:07:13.920

听起来你在这里找教程看看这个

[http://w3schools.com/php/php_mysql_delete.asp](http://w3schools.com/php/php_mysql_delete.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T05:08:56.960

你可以像这样使用它：

```
<?php
$con = mysql_connect("localhost","username","password");
if (!$con) {
  die('Could not connect: ' . mysql_error());
}

mysql_select_db("my_db", $con);

mysql_query("DELETE FROM account_name WHERE SomeField='value'");

mysql_close($con);
?> 
```

# algorithm - 最大化矩阵中“非重叠”数字的总和

> ID：10378738
> 
> 赞同：6
> 
> 时间：2012-04-30T05:05:55.197
> 
> 标签：algorithm, matrix, dynamic-programming, mathematical-optimization

只是寻找一点方向，我意识到给出的示例可以使用蛮力迭代来解决，但我正在寻找一个更优雅（即数学？）的解决方案，它可能会解决更大的示例（比如 20x20 或 30x30 ）。这完全有可能无法做到，而且我想出一种不依赖蛮力的方法几乎没有成功......

我有一个矩阵（称为 A），它是 nxn。我希望从矩阵 A 中选择一个点的子集（称为 B）。该子集将包含 n 个元素，其中从 A 的每一行和每一列中取一个且只有一个元素。输出应提供一个解决方案（ B) 使得构成 B 的元素的总和是最大可能值，给定这些约束（例如，在下面的示例中为 25）。如果找到 B 的多个实例（即给出相同最大和的不同解），则应选择具有最大最小元素的 B 的解。

B 也可以是一个选择矩阵，它是 nxn，但只有 n 个所需元素是非零的。

例如：如果 A =

```
|5 4 3 2 1|
|4 3 2 1 5|
|3 2 1 5 4|
|2 1 5 4 3|
|1 5 4 3 2| 
```

=> B 将是

```
|5 5 5 5 5| 
```

但是，如果 A =

```
|5 4 3|
|4 3 2|
|3 2 1| 
```

乙 =

```
|3 3 3| 
```

因为 B 的最小元素是 3 大于 for

```
|5 3 1| 
```

或者

```
|4 4 1| 
```

两者的总和为 9

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T08:52:26.567

您的问题几乎与[分配问题](http://en.wikipedia.org/wiki/Assignment_problem)相同，例如可以通过[匈牙利算法](http://en.wikipedia.org/wiki/Hungarian_algorithm)在多项式时间内解决。

请注意，分配问题通常是一个最小化问题，但是将矩阵乘以 -1 并添加一些常数应该使该方法适用。此外，对于多个最优解的情况，没有正式的平局条件。但是，该方法会为您提供具有最佳总和的解决方案。令 m 为最小和数。通过将所有小于或等于 m 的条目设置为零来修改矩阵并再次求解。要么你得到一个总和比上一个更好的解决方案。如果不是，则先前的解决方案已经是最佳的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T18:17:43.540

正如马蒂亚斯所说，您应该使用回溯。

1.  寻找合理的解决方案。从每一行中选择最大值并查看它们是否不重叠。如果不是，则扰动解的一部分，使结果变得不重叠。
2.  定义部分解决方案的适应度。假设您正在迭代地为每一行获取值，并且您已经从前 k 行中获取了值。该解决方案的适应度等于已选择值的总和 + 剩余行和未选择列的最大值
3.  现在递归地开始寻找解决方案。从第一行中选择值，计算它们的适应度并将它们插入优先级队列。删除所有适应度低于当前最优解（在步骤 1 中初始化）的解。选择队列头部的解决方案，计算下一级解决方案并将它们插入优先级队列。从所有列和行中选择值后，计算总和，如果高于当前最优值，则替换它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T16:53:14.467

哎哟。[**这个算法是错误的；没有证据，因为它是*错误*的，因此不可能证明它是正确的。**](https://cs.stackexchange.com/questions/1597/maximise-sum-of-non-overlapping-numbers-in-square-array-help-with-proof);) 我把它留在这里是因为我太执着于完全删除它，这很好地说明了为什么你应该正式证明算法而不是说“这看起来不错！这不可能失败！”

* * *

我暂时给出这个解决方案没有证据。我有一个证明草图，但我无法证明这个问题的最佳子结构。反正...

# 问题

给定一个数字的方阵，选择尽可能多的“非重叠”数字，以使所选数字的总和最大化。“不重叠”意味着没有两个数字可以来自同一行或同一列。

# 算法

*   让`A`是一个数字的方阵`n by n`。
*   让表示第 th 行和第 th 列中`Aij`的元素。`A``i``j`
*   让表示包含行to和列to的交集的`S( i1:i2, j1:j2 )`方形子数组的非重叠数字的最佳总和。`A``i1``i2``j1``j2`

然后表示非重叠数的最佳总和，`S( 1:n , 1:n )`并给出如下：

```
S( 1:n , 1:n ) = max {  [ S(   2:n , 2:n   ) + A11 ]
                        [ S(   2:n , 1:n-1 ) + A1n ]
                        [ S( 1:n-1 , 2:n   ) + An1 ]
                        [ S( 1:n-1 , 1:n-1 ) + Ann ] }
(recursively)

Note that S( i:i, j:j ) is simply Aij. 
```

也就是说，大小为的方阵的最优和`n`可以通过分别计算四个大小`n-1`为”。

```
S for |# # # #|
      |# # # #|
      |# # # #|
      |# # # #|

Is the best of the sums S for:

|#      |      |      #|      |# # #  |       |  # # #|
|  # # #|      |# # #  |      |# # #  |       |  # # #|
|  # # #|      |# # #  |      |# # #  |       |  # # #|
|  # # #|      |# # #  |      |      #|       |#      | 
```

# 执行

上面的递归算法提出了一个递归解决方案：

```
def S(A,i1,i2,j1,j2):
    if (i1 == i2) and (j1==j2):
        return A[i1][j1]
    else:
        return max ( S( A, i1+1, i2, j1+1, j2) + A[i1][j1] ],
                     S( A, i1+1, i2, j1, j2-1) + A[i1][j2] ],
                     S( A, i1, i2-1, j1+1, j2) + A[i2][j1] ],
                     S( A, i1, i2-1, j1, j2-1) + A[i2][j2] ], ) 
```

请注意，这将`O(4^n)`调用`S()`!! `O(n!)`这比“蛮力”解决方案的阶乘时间复杂度要好得多，但性能仍然很差。

这里要注意的重要一点是，许多调用都*使用相同的参数重复*。例如，在求解一个 3*3 数组时，每个 2*2 数组都会求解多次。

这为加速提供了两种可能的解决方案：

*   使递归函数`S()`缓存结果，以便`S(A,i1,i2,j1,j2)`每个`i1,i2,j1,j2`. 这意味着`S()`只需要计算`O(n^3)`结果 - 所有其他请求都将从缓存中完成。（这称为[*记忆*](http://en.wikipedia.org/wiki/Memoization)。）
*   与其从大`n*n`数组的顶部开始，然后逐步处理较小的子问题，不如从可能的最小子问题的底部开始，逐步建立**案例**`n*n`。这称为*动态规划*。这也是`O(n^3)`，但速度要快得多`O(n^3)`，因为您不必一直访问缓存。

动态规划解决方案有点像：

*   找到所有 1x1 子阵列的最优解。（琐碎的。）
*   找到所有 2x2 子阵列的最优解。
*   找到所有 3x3 子阵列的最佳解决方案。
*   ...
*   找到所有 n-1 * n-1 个子数组的最优解。
*   找到完整 n*n 子数组的最优解。

# 此解决方案的注意事项：

*   还没有证据。我在做这个工作。
*   你会注意到上面的算法只给你`S()`，最优的**总和**。它并没有告诉你哪些数字实际上构成了这个总和。您可以添加自己的方法来追溯解决方案的路径。
*   上面的算法不能保证像`2,2`vs.这样的关系`1,3`会被打破，有利于让所有单独的数字尽可能大（这样才能`2,2`获胜。）我相信你可以定义`max()`打破关系以支持最大的数字可能，这会做你想要的，但我无法证明这一点。

# 一般注意事项：

[动态规划](http://en.wikipedia.org/wiki/Dynamic_programming)是一种强大的技术，可以为任何具有两个属性的问题设计快速算法：

1.  *最优子结构*：一个问题可以分解成更小的部分，每个部分都可以作为原始问题解决方案的一部分。
2.  *重叠子问题*意味着需要解决的实际子问题很少，并且子问题的解决方案被多次重复使用。

如果问题具有最优子结构，并且问题分解为**更**小的问题（例如，大小问题`n`分解为大小子问题），`n-1`则可以通过*动态规划*来解决问题。

如果您可以将问题分成**更**小的块 - 比如说将大小问题`n`分成两半，每个大小`n/2`- 那就是*分而治*之，而不是动态编程。分而治之的解决方案通常*非常*快——例如，二分搜索会`O(log n)`及时在排序数组中找到一个元素。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-30T05:15:47.163

这与[n 皇后问题](http://en.wikipedia.org/wiki/N_queens_problem)有关，只是您不关心对角线并且您有加权解决方案。作为皇后问题，您可以通过（多次）回溯来解决它。

即，一旦找到解决方案，您就会记住它的重要性，将解决方案标记为无效，然后重新开始。(a) 权重最高的解决方案获胜。

# xml - 使用 xslt 合并 xml 中的两个或多个节点

> ID：10378744
> 
> 赞同：0
> 
> 时间：2012-04-30T05:06:24.380
> 
> 标签：xml, xslt

这个问题有3种情况：

**第一种可能性：** 输入：

```
<root>
    <node id="N1">
        <fruit id="1" action="aaa">
            <orange id="x" action="create">
                <attribute>
                    <color>Orange</color>
                    <year>2012</year>
                </attribute>
            </orange>
            <orange id="x" action="change">
                <attribute>
                    <color>Red</color>
                </attribute>
            </orange>
            <orange id="x" action="change">
                <attribute>
                    <color>Blue</color>
                    <condition>good</condition>
                </attribute>
            </orange>
        </fruit>
    </node>
</root> 
```

预期输出：

```
<root>
    <node id="N1">
        <fruit id="1" action="aaa">
            <orange id="x" action="create">
                <attribute>
                    <color>Blue</color>
                    <year>2012</year>
                    <condition>good</condition>
                </attribute>
            </orange>
        </fruit>
    </node>
</root> 
```

**第二种可能性：** 输入：

```
<root>
    <node id="N1">
        <car id="1">
            <bmw id="i" action="change">
                <attribute>
                    <color>Blue</color>
                    <owner>a</owner>
                </attribute>
            </bmw>
            <bmw id="i" action="change">
                <attribute>
                    <color>Yellow</color>
                    <status>avaailable</status>
                </attribute>
            </bmw>
        </car>
    </node>
</root> 
```

预期输出：

```
<root>
    <node id="N1">
        <car id="1">
            <bmw id="i" action="change">
                <attribute>
                    <color>Yellow</color>
                    <owner>a</owner>
                    <status>available</status>
                </attribute>
            </bmw>
        </car>
    </node>
</root> 
```

**第三个场景：**

```
<root>
    <node id="N1">
        <car id="1">
            <bmw id="j" action="delete">
                <attribute>
                    <color>Blue</color>
                    <year>2000</year>
                </attribute>
            </bmw>
            <bmw id="j" action="delete">
                <attribute>
                    <color>Pink</color>
                    <status>available</status>
                </attribute>
            </bmw>
        </car>
    </node>
</root> 
```

预期输出：

```
<root>
    <node id="N1">
        <car id="1">
            <bmw id="j" action="delete">
                <attribute>
                    <color>Pink</color>
                    <year>2000</year>
                    <status>available</status>
                </attribute>
            </bmw>            
        </car>
    </node>
</root> 
```

第二种和第三种情况的解释：

*   两个或多个具有 'action=change' 的节点将合并为一个具有 'action=change' 的节点
*   两个或多个具有 'action=delete' 的节点将合并为一个具有 'action=delete' 的节点
*   在合并时，我们更新我们只保留最后一个节点的值，保留初始节点并添加任何新的附加节点。

我希望解释清楚。

请告诉我有关此问题的 XSLT 解决方案。谢谢你。

亲切的问候，约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T18:59:08.187

[与我在这里](https://stackoverflow.com/questions/10419095/how-to-simplify-xml-node-between-sibling-to-make-sure-no-duplicate-node-exist-us)给您的解决方案相比，这是一种不同风格的解决方案。

我认为一步一步走是值得的。我假设`@action`s 以逻辑顺序出现 -`create`首先、`change`下一个和`remove`最后一个。可以多次出现相同的情况，`@action`但不会是随机的。现在我们准备看看主要逻辑：

```
<xsl:template match="@* | node()">
    <xsl:copy>
        <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
</xsl:template> 
```

我们声明身份转换，然后在几个地方截取它。`@id`我们只在具有相同、 parent`@id`和的节点的唯一出现处停止`@action`：

```
<xsl:template match="node/*/*[a:is-primary(.)]" priority="1">
    <xsl:copy>
        <xsl:apply-templates select="@*"/>
        <xsl:apply-templates select="attribute" mode="consolidate-most-recent"/>
    </xsl:copy>
</xsl:template> 
```

我们忽略“重复”：

```
<xsl:template match="node/*/*[not(a:is-primary(.))]"/> 
```

并且还忽略`create`s后跟 a`change`以及所有`create`s 和`change`后跟 a `remove`。

```
<xsl:template match="node/*/*[@action = 'change'][a:preceded-by(., 'create')]" priority="2"/>
<xsl:template match="node/*/*[@action = 'create' or action='change'][a:followed-by(., 'remove')]" priority="2"/> 
```

当唯一`@action`不跟随另一个`@action`会让我们忽略它的唯一被捕获时，我们做一件简单的事情 - 收集具有相同`@id`忽略的元素的所有属性`@action`并使用它们最近的“最近”值（在文档顺序中最后出现的那些） ）。

```
<xsl:template match="attribute" mode="consolidate-most-recent">
    <xsl:copy>
        <xsl:for-each-group 
                    select="/root/node/*/*[a:matches(current()/parent::*, ., 'any')]/attribute/*" 
                    group-by="local-name()">
            <!-- take the last in the document order -->
            <xsl:apply-templates select="current-group()[last()]"/>
        </xsl:for-each-group>
    </xsl:copy>
</xsl:template> 
```

就是这样。现在让我们看看使它工作的函数：

我们有一个`key`来简化查找

```
<xsl:key name="entity" match="/root/node/*/*" use="concat(parent::*/@id, '_', @id, '_', @action)"/> 
```

一个检查它是否是唯一出现的节点的函数（我们可以将它直接添加到模板`match`谓词中，但由于我们从函数开始，所以让我们保持不变）：

```
<xsl:function name="a:is-primary" as="xs:boolean">
    <xsl:param name="ctx"/>
    <!-- need to establish "focus"(context) for the key() function to work -->
    <xsl:for-each select="$ctx">
        <xsl:sequence select="generate-id($ctx) = generate-id(key('entity', concat($ctx/parent::*/@id, '_', $ctx/@id, '_', $ctx/@action))[1])"/>
    </xsl:for-each>
</xsl:function> 
```

一个`matches`可以为我们做各种比较的函数（同样，可以把它全部放在谓词中，但是这样我们可以在真实的模板中保持它的整洁）：

```
<xsl:function name="a:matches" as="xs:boolean">
    <xsl:param name="src"/>
    <xsl:param name="target"/>
    <!-- can be one of the following:
        'any' - only match the @id(s) and ignore @action
        'same' - match by @id(s) and expect $src/@action to match $target/@action
         a certain value - match by @id(s) and expect @action to match this value
     -->
    <xsl:param name="action"/>

    <xsl:value-of select="
                  ($src/local-name() = $target/local-name()) and
                  ($src/parent::*/@id = $target/parent::*/@id) and 
                  ($src/@id = $target/@id) and 
                  (if ($action = 'any') 
                      then true()
                      else if ($action = 'same')
                          then ($target/@action = $src/@action)
                          else ($target/@action = $action))"/>  
</xsl:function> 
```

以及“原始”函数之上的`preceded-by`and语法糖：`followed-by``matches`

```
<xsl:function name="a:preceded-by" as="xs:boolean">
    <xsl:param name="ctx"/>
    <xsl:param name="action"/>

    <xsl:value-of select="count($ctx/preceding::*[a:matches($ctx, ., $action)]) > 0"/>
</xsl:function>

<xsl:function name="a:followed-by" as="xs:boolean">
    <xsl:param name="ctx"/>
    <xsl:param name="action"/>

    <xsl:value-of select="count($ctx/following::*[a:matches($ctx, ., $action)]) > 0"/>
</xsl:function> 
```

**概括**

这是一个完整的转换：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:a="http://a.com">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:key name="entity" match="/root/node/*/*" use="concat(parent::*/@id, '_', @id, '_', @action)"/>

    <xsl:function name="a:is-primary" as="xs:boolean">
        <xsl:param name="ctx"/>
        <!-- need to establish "focus"(context) for the key() function to work -->
        <xsl:for-each select="$ctx">
            <xsl:sequence select="generate-id($ctx) = generate-id(key('entity', concat($ctx/parent::*/@id, '_', $ctx/@id, '_', $ctx/@action))[1])"/>
        </xsl:for-each>
    </xsl:function> 

    <xsl:function name="a:preceded-by" as="xs:boolean">
        <xsl:param name="ctx"/>
        <xsl:param name="action"/>

        <xsl:value-of select="count($ctx/preceding::*[a:matches($ctx, ., $action)]) > 0"/>
    </xsl:function>

    <xsl:function name="a:followed-by" as="xs:boolean">
        <xsl:param name="ctx"/>
        <xsl:param name="action"/>

        <xsl:value-of select="count($ctx/following::*[a:matches($ctx, ., $action)]) > 0"/>
    </xsl:function>

    <xsl:function name="a:matches" as="xs:boolean">
        <xsl:param name="src"/>
        <xsl:param name="target"/>
        <!-- can be one of the following:
            'any' - only match the @id(s) and ignore @action
            'same' - match by @id(s) and expect $src/@action to match $target/@action
             a certain value - match by @id(s) and expect @action to match this value
         -->
        <xsl:param name="action"/>

        <xsl:value-of select="
                      ($src/local-name() = $target/local-name()) and
                      ($src/parent::*/@id = $target/parent::*/@id) and 
                      ($src/@id = $target/@id) and 
                      (if ($action = 'any') 
                          then true()
                          else if ($action = 'same')
                              then ($target/@action = $src/@action)
                              else ($target/@action = $action))"/>  
    </xsl:function>

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="node/*/*[a:is-primary(.)]" priority="1">
        <xsl:copy>
            <xsl:apply-templates select="@*"/>
            <xsl:apply-templates select="attribute" mode="consolidate-most-recent"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="attribute" mode="consolidate-most-recent">
        <xsl:copy>
            <xsl:for-each-group 
                        select="/root/node/*/*[a:matches(current()/parent::*, ., 'any')]/attribute/*" 
                        group-by="local-name()">
                <!-- take the last in the document order -->
                <xsl:apply-templates select="current-group()[last()]"/>
            </xsl:for-each-group>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="node/*/*[not(a:is-primary(.))]"/>

    <!-- assume a remove is never followed by a change or create -->
    <xsl:template match="node/*/*[@action = 'change'][a:preceded-by(., 'create')]" priority="2"/>
    <xsl:template match="node/*/*[@action = 'create' or action='change'][a:followed-by(., 'remove')]" priority="2"/>
</xsl:stylesheet> 
```

应用于文档时：

```
<root>
    <node id="N1">
        <fruit id="1" action="aaa">
            <orange id="x" action="create">
                <attribute>
                    <color>Orange</color>
                    <year>2012</year>
                </attribute>
            </orange>
            <orange id="x" action="change">
                <attribute>
                    <color>Red</color>
                    <something>!!</something>
                </attribute>
            </orange>
            <orange id="x" action="change">
                <attribute>
                    <color>Blue</color>
                    <condition>good</condition>
                </attribute>
            </orange>
            <orange id="x" action="remove">
                <attribute>
                    <condition>awesome</condition>
                </attribute>
            </orange>
        </fruit>
    </node>
</root> 
```

产生以下结果：

```
<root>
   <node id="N1">
      <fruit id="1" action="aaa">
         <orange id="x" action="remove">
            <attribute>
               <color>Blue</color>
               <year>2012</year>
               <something>!!</something>
               <condition>awesome</condition>
            </attribute>
         </orange>
      </fruit>
   </node>
</root> 
```

我希望这很清楚。您可以扩展此概念并为自己构建一个很好的可重用函数库，然后将其用作简单的谓词，以一种或另一种方式合并您的节点。不太可能是完成工作的最有效方式，但至少是表达解决方案的一种简洁方式。

# asp.net - Safari 的 ASP.NET Facebook 应用程序会话问题

> ID：10378746
> 
> 赞同：1
> 
> 时间：2012-04-30T05:06:28.560
> 
> 标签：asp.net, safari, facebook-apps

目前我正在开发一个 Facebook 应用程序，它是使用 ASP.NET 开发的。

此应用程序适用于 IE（7,8 和 9）FF 和 Chrome。

第一个页面是 default.aspx，它将处理身份验证，然后重定向到 home.aspx

现在唯一的问题是 Safari 不接受跨域 cookie。我已更改 web.config 文件并添加它以避免使用 cookie。

之后，URL 来到 [http://www.testdomain.com/(S(gvsc2i45pqvzqm3lv2xoe4zm))/default.aspx](http://www.testdomain.com/(S(gvsc2i45pqvzqm3lv2xoe4zm))/default.aspx)

它只是不能自动从 default.aspx 重定向到 home.aspx ......

有人有线索吗？

或者，无论如何我可以在 Facebook 应用程序中使用 ASP.Net 会话处理 Safari？

非常感谢

PS。来自 default.aspx 页面的代码

protected void Page_Load(object sender, EventArgs e) { if (!IsPostBack) { if (!string.IsNullOrEmpty(Request.Params["signed_request"])) { string signed_request = Request.Params["signed_request"]; if (!string.IsNullOrEmpty(signed_request)) { // 将签名请求拆分为编码签名和有效负载 string[] signedRequestParts = signed_request.Split('.'); 字符串编码签名 = signedRequestParts[0]; 字符串有效载荷 = signedRequestParts[1];

```
 // decode signature
                string signature = decodeSignature(encodedSignature);
                // calculate signature from payload
                string expectedSignature = hash_hmac(payload, Facebook.FacebookApplication.Current.AppSecret);

                if (signature == expectedSignature)
                {
                    // signature was not modified
                    Dictionary<string, string> parameters = DecodePayload(payload);
                    if (parameters != null)
                    {
                        string UserId = parameters["user_id"];
                        Session.Add("UserId", _SystemUser.SystemUserId);
                        Session.Add("Username", _SystemUser.Username);
                        Response.Redirect("Home.aspx?user_id=" + UserId);
                    }
                }
            }
        }

        if (!String.IsNullOrEmpty(Request["error_reason"])) // user denied your request to login
        {
            logger.Debug("Error Reason: " + Request["error_reason"]);
            //User denied access
        }

        if (String.IsNullOrEmpty(Request["code"])) // request to login
        {
            string url1 = String.Format("https://www.facebook.com/dialog/oauth?client_id={0}&redirect_uri={1}&scope={2}", Facebook.FacebookApplication.Current.AppId, callbackUrl, ext_perms);
            Response.Redirect(url1);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T06:43:14.273

当使用无 cookie 会话时，ASP.Net 将自动将 URL 中没有会话 ID 的任何请求重定向到同一页面，但在 URL 中使用新的 SessionID。但是，它作为 GET 请求重定向，因此不会转发任何 POSTED 参数……因此，在重定向后，您的“parameters”变量，来自解码的signed_request，将丢失，因为页面将不再具有signed_request POSTed 参数.

有两种可能的解决方案（据我所知）：

1.  拦截 Global.ascx 中的初始重定向，而是使用 URL 中的新 SessionID 进行自己的重定向...但是，在 Javascript 中作为自发布表单执行此操作，其中表单还具有带有值的 signed_request 参数签名请求。

2.  重新打开 cookie 会话，并在您的第一页从 FB 重定向到一个页面。在这个页面中设置一个 Session 变量（它将让 ASP.Net 设置一个会话 cookie），然后重定向回 FB。

如果这也在标签页上，您可能/还需要一些代码来处理任何 app_data。

对不起，我不能更有用的代码。我已经为我的工作编写了自己的处理程序，但我的工作场所现在拥有该代码！我永远不确定可以分享多少。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T08:01:49.897

我使用了无 cookie 会话，但随着初始页面的刷新，发布到登录页面的 Facebook“签名请求”丢失了。

作为一种解决方法，我添加了一个 HTTPModule 来覆盖 EndRequest() 事件。如果页面是“初始页面”并且包含“签名请求”POST，则该值将作为查询字符串添加。在页面中，我们将检查查询字符串值并将其设置到会话中，以便在应用程序中使用。

EndRequest 如下：

```
void context_EndRequest(object sender, EventArgs e)
{
    HttpContext cntxt = HttpContext.Current;
    const string paramname = "signed_request";
    const string initialPage= "/startapp.aspx";
    if ((String.Compare(cntxt.Request.Url.AbsolutePath, initialPage, true) == 0) && (!String.IsNullOrEmpty(cntxt.Request[paramname])))
    {
        string strQuerySignedReq = paramname+"=" + cntxt.Request[paramname];
        if (cntxt.Response.RedirectLocation.Contains(".aspx?"))
            cntxt.Response.RedirectLocation = cntxt.Response.RedirectLocation + "&" + strQuerySignedReq;
        else
            cntxt.Response.RedirectLocation = cntxt.Response.RedirectLocation + "?" + strQuerySignedReq;
    }
} 
```

初始页面 - “startapp.aspx”，加载事件将是：

```
protected void Page_Load(object sender, EventArgs e)    
{
   signed_request = Request.QueryString["signed_request"];
} 
```

该代码的缺点是 EndRequest() 将对所有请求执行。此外，链接只能使用相对 url。由于不同浏览器的安全级别不同，我在 cookie 和 Facebook 上有过几次烦人的经历。因此，我可以忍受这些缺点。希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-23T16:40:18.837

我知道这是一个老问题，但我遇到了完全相同的问题并找到了解决方案。如果您在应用程序中使用 SQL Server，则此处的解决方案有效。

使用 cookieless 将您的 SessionId 存储在 URL 中将避免 cookie 问题，但仍然缺少 Safari 中的 Session 问题。

好吧，您需要设置一个 SQL SessionState，这将使您的应用程序与您的数据库通信以存储会话。这适用于 Safari 中的 facebook 画布应用程序。

设置这个很简单：

注册：运行aspnet_regsql.exe（在C:/Windows/Microsoft.NET/Framework/'Framework version'/）查看[https://msdn.microsoft.com/en-us/library/ms229862.aspx](https://msdn.microsoft.com/en-us/library/ms229862.aspx)中的参数（主是-S –ssadd）

在同一路径中，有一个 InstallSqlState.SQL 脚本。在您的数据库服务器上运行它。

现在，在您的 Web.Config 文件中设置此标记：

```
<configuration>
  <system.web>
    <sessionState mode="StateServer" stateConnectionString="tcpip=127.0.0.1:42424" timeout="120" cookieless="true" />
  </system.web>
</configuration> 
```

魔术完成了！

有一些事情要记住。您不能从服务器端向 facebook 执行 WebRequests 以请求访问令牌，因为 facebook 将调用重定向到“有效 OAuth 重定向 URI”，并完全忽略请求 URI 中的 SessionId 参数。您仍然可以向 API 发出 WebRequest，但身份验证需要是异步的，使用 Javascript。

# nhibernate - NHibernate Transaction.Commit 自动关闭 Session

> ID：10378747
> 
> 赞同：1
> 
> 时间：2012-04-30T05:06:35.350
> 
> 标签：nhibernate, session, transactions

我有一个使用绝对最新版本 (3.3) 的 Web 应用程序，并且在 HttpModule 中使用逐个请求会话管理，因此多个会话冲突没有问题。不幸的是，我发现会话在我执行 Transaction.Commit 后立即自动关闭，我只在实际执行创建、更新或删除时才这样做。我在我的 NHibernate 日志中找到了这个。

我知道我没有这样做，因为对 ISession.Close 函数的唯一调用是在我的 HttpModule 中完成的。

是的，当然我可以在我的 SessionManager 中放入代码来检查 IsClosed 参数，然后使用 OpenSession 函数而不是 GetCurrentSession，但这是否应该发生？有什么方法可以通过我的配置或可以在 Session 或 Transaction 对象上设置的某些属性来防止这种情况发生，或者这只是我在任何地方都找不到任何文档的新功能之一？

请帮忙。

布赖恩

我被要求提供一些代码，所以这里是 HttpModule 的代码：

```
public class NhibernateModule : IHttpModule
{
    public void Dispose()
    {
    }

    public void Init(HttpApplication context)
    {
        context.BeginRequest += new EventHandler(context_BeginRequest);
        context.EndRequest += new EventHandler(context_EndRequest);
    }

    public void context_BeginRequest(Object sender, EventArgs e)
    {
        WebSessionContext.Bind(NhibernateSessionManager.GetContextSession());
    }

    public void context_EndRequest(Object sender, EventArgs e)
    {
        ISession session = WebSessionContext.Unbind(NhibernateSessionManager.SessionFactory);

        if (session != null)
        {
            if (session.Transaction != null && session.Transaction.IsActive)
            {
                session.Transaction.Rollback();
            }
            else
                session.Flush();

            session.Close();
        }
    }
} 
```

}

接下来，您将找到我在 SessionManager 中使用的原始代码：

```
public sealed class NhibernateSessionManager
{
    private readonly ISessionFactory sessionFactory;
    public static ISessionFactory SessionFactory
    {
        get { return Instance.sessionFactory; }
    }

    private ISessionFactory GetSessionFactory()
    {
        return sessionFactory;
    }

    public static NhibernateSessionManager Instance
    {
        get { return NestedSessionManager.sessionManager; }
    }

    public static ISession GetContextSession()
    {
        ISession session;
        if (CurrentSessionContext.HasBind(SessionFactory))
        {
            session = SessionFactory.GetCurrentSession();
        }
        else
        {
            session = SessionFactory.OpenSession();
            CurrentSessionContext.Bind(session);
        }
        return session;
    }  

    private NhibernateSessionManager()
    {
        if (sessionFactory == null)
        {
            Configuration configuration;
            configuration = new Configuration().Configure(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "web.config"));
            log4net.Config.XmlConfigurator.ConfigureAndWatch(new FileInfo(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "web.config")));

            //Configuration configuration = new Configuration().Configure();
            if (configuration == null)
            {
                throw new InvalidOperationException("NHibernate configuration is null.");
            }
            else
            {
                sessionFactory = configuration.BuildSessionFactory();
                if (sessionFactory == null)
                    throw new InvalidOperationException("Call to BuildSessionFactory() returned null.");
            }
        }
    }

    class NestedSessionManager
    {
        internal static readonly NhibernateSessionManager sessionManager = new NhibernateSessionManager();
    }
} 
```

最后，这是一个当前导致会话在 Transaction.Commit() 之后立即关闭的函数。每个内部函数都检索当前会话，然后处理 Save 调用。

```
 public static Int32 AddVideo(VideoFile Video, Int32 UserID, Int16 InstID)
    {
        log.Debug("Begin AddVideo");
        Int32 FileID = 0;

        using (ISession Session = NhibernateSessionManager.GetContextSession())
        {
            using (ITransaction Transaction = Session.BeginTransaction())
            {
                Video.Created = DateTime.Now;
                Video.Modified = DateTime.Now;

                FileID = (Int32)Session.Save(Video);
                Video.FileID = FileID;

                // Need to process through all the categories and insert records into the ivxFileCategories table
                // to associate the newly created file with the chosen categories
                if (Video.CategoryAssociations != null)
                {
                    log.Info("Number of categories to be associated with the video: " + Video.CategoryAssociations.Count);
                    for (int i = 0; i < Video.CategoryAssociations.Count; i++)
                    {
                        CategoryFileAssociation Assoc = (CategoryFileAssociation)Video.CategoryAssociations[i];
                        Assoc.FileID = FileID;
                        AssociationManager.AddCategoryFileTransaction(Assoc);
                    }
                }

                // Need to add the default file access for the UserDetail that is creating the new video which will always
                // be Admin because the UserDetail creating a file should always have admin access over the file, no matter
                // what their default role is.
                AssociationManager.AddFileAccessTransaction(FileID, UserID, UserClassConstants.IVXUSERCLASS_ADMIN);

                // Need to add the institutional association based on whether the new video was created by a librarian
                // or one of the iVidix admins
                AssociationManager.AddInstitutionFileTransaction(InstID, FileID);

                Transaction.Commit();
            }
        }

        log.Debug("End AddVideo");
        return FileID;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T21:25:42.060

会话将通过 AddVideo 方法进行处理，因为您正在使用会话的[using 语句](http://msdn.microsoft.com/en-us/library/yh598w02%28v=vs.100%29.aspx)。

```
using (ISession Session = NhibernateSessionManager.GetContextSession())
{

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T12:03:26.240

提交事务将结束该会话。

将您的事务开始移动到 context_BeginRequest 和 context_EndRequest 中的提交/清理

我实际上不喜欢视图模式中的会话，并且更喜欢让我的事务尽可能短地打开，而是将会话注入控制器。然后我在操作或服务中执行事务。我更喜欢这种对事务的细粒度控制，并使它们保持短暂，避免任何锁定问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T11:17:20.870

我完全建议剥离交易内容

```
using (ISession Session = NhibernateSessionManager.GetContextSession())
{
  using (ITransaction Transaction = Session.BeginTransaction())
  {
   ...
  }
} 
```

并将其移动到开始/结束请求中。这样`for`每个请求都有一个 UOW。您会话关闭的原因是因为`using statement`.

然后，您的开始请求代码可以是以下内容：-

```
var session = sessionFactory.OpenSession();
CurrentSessionContext.Bind(session);
session.BeginTransaction(); 
```

和您的最终要求：-

```
var session = CurrentSessionContext.Unbind(sessionFactory);

if (session != null)
{
    if (session.Transaction.IsActive)
    {
        try
        {
            session.Transaction.Commit();
        }
        catch
        {
            session.Transaction.Rollback();
        }
    }
    session.Close();
} 
```

我的 global.asax 中有这个

```
public static ISessionFactory SessionFactory { get; set; } 
```

这在我的存储库中

```
 public ISession Session
    {
        get
        {
            return SessionFactory.GetCurrentSession();
        }
    } 
```

现在我使用 IOC 将我的 sessionFactory 传递给我的存储库层，否则您将需要自己手动传递它。

# sql - Rails 3.2 并让 AR 正确排序此查询

> ID：10378749
> 
> 赞同：0
> 
> 时间：2012-04-30T05:06:51.170
> 
> 标签：sql, ruby-on-rails, activerecord

我目前有一个范围，我正在尝试查找在关联中创建的最后一条记录，如果特定的布尔值为 false，则选择它

IE Foo has_many Bar's 和 Bar's 有一个名为 bazzed 的布尔列

```
scope :no_baz,   joins(:bars).order("bars.id DESC").limit(1).where("bars.bazzed = 'f'") 
```

这个问题是rails把这个查询变成了这样的东西

```
SELECT "foos".* FROM "foos" INNER JOIN "bars" ON "bars"."foo_id" = "foos"."id" WHERE (bars.bazzed = 'f') ORDER BY bars.id DESC LIMIT 1 
```

问题在于 rails 在 where 子句之后调用 order 和 limit，我正在寻找的是先执行 order 和 limit 以尝试找到最后一个设置为 false 的 bar。

是否有本地 AR 方式来执行我试图完成的查询？

编辑

我试图抓住有一个 bar 的 foo，其中最后一个 bar 设置为 false 并且只有当 foo 的最后一个 bar 有 false bazzed 时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T15:46:09.357

Ok, I would suggest this for the query on the "foo" model:

```
Foo.bars.where("bars.bazzed = ?", 'f').all( :order => "created_at DESC").first 
```

Note: 'f' can be replaced by false, depending on the value you use in your "bazzed" column, of course.

[Edit]

Ok, as I think I better understand the problem, here is a suggestion, but for a public method and not a scoped query.

```
def no_baz
  all_no_baz_foos = Array.new
  Foo.all.each do |foo|
      last_bar = foo.bars.all.order("bars.id DESC").first
      if last_bar.bazzed == 'f'
        all_no_baz_foos << foo
      end
  end
  return all_no_baz_foos
end 
```

This method will return an Array with all the no_baz_foos record in it. As I did not test my code, you may have to change few things for it to work, but I think you get the idea.

For the "scope" method, I just can't find a way to chain correctly the queries to have the desired result. If anyone else knows how to achieve that using a scope, I'll be glad to hear the solution too.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:05:26.767

现在使用类方法，但问题在于它返回一个数组对象，而不是我想要返回的活动记录关系。仍在尝试正确完成查询。

# apache - 从另一台服务器重定向的棘手 wordpress 设置

> ID：10378750
> 
> 赞同：0
> 
> 时间：2012-04-30T05:06:53.593
> 
> 标签：apache, wordpress, .htaccess, mod-rewrite, redirect

关于如何从本地登台服务器迁移到生产服务器，我可以使用一些建议。当我试图描述它时，它是一个相当棘手的设置。

我的站点在我的个人服务器上的暂存子域的根目录下设置并运行良好。暂存：staging.mydomain.com

本周晚些时候，我将把它移到 Rackspace 上的新生产服务器上，该服务器目前没有附加域（只是一个 IP 地址）。客户端正在将文件夹重定向到新的机架空间服务器。 [http://www.clientsdomain.com/subfolder/](http://www.clientsdomain.com/subfolder/) 这将是站点所在的位置。但是clientsdomain.com 是世界其他地方的不同服务器（不在机架空间）。他们会将流量重定向到该 URL 到新的机架空间服务器。

所以我的问题是：我为 wordpress 设置的工作阶段位于我的个人服务器子域的根目录中。我应该如何在机架空间上设置它？在IP地址的根？或在子文件夹中模拟任何相关链接的域设置。

我问的原因是我认为我已经正确设置了这个......但是......

我继续尝试将站点移到我的 Rackspace 服务器上的 dev 文件夹中。我的客户设置了一个开发网址

[http://www.clientsdomain.com/dev/subfolder/](http://www.clientsdomain.com/dev/subfolder/)

任何访问该 url 的人都会被重定向到我的服务器（我的 rackspace 服务器只有一个 IP 地址）

网站前端使用绝对网址。但是事情开始失败的地方是 wp-admin。例如，如果我在“常规设置”页面上，然后单击“保存”。它保存数据，然后重定向到 /wp-admin/... 而不是 /dev/subfolder/wp-admin/。由于该文件夹不存在，它会转到我的客户 404 页面。

此外，访问 [http://www.clientsdomain.com/dev/subfolder/wp-admin](http://www.clientsdomain.com/dev/subfolder/wp-admin)会在客户端服务器 404 页面上结束，但是......

[http://www.clientsdomain.com/dev/subfolder/wp-admin/](http://www.clientsdomain.com/dev/subfolder/wp-admin/)（带斜杠）工作正常。

我将站点从我的开发文件夹移动到 Rackspace 的方法是将我的服务器（即 staging.mydomain.com）上 wp-admin 中的 URL 更改为 [http://www.clientsdomain.com/dev/subfolder/](http://www.clientsdomain.com/dev/subfolder/)

然后我保存了这些设置，下载了 db 和 site 文件并将文件和数据库上传到 rackspace 并更改了 wp-config 文件以匹配 rackspace db。

这是我当前的 htaccess 文件：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

我真的很感激这里的一些指导。应该在周二上线。

谢谢！鱼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T05:18:33.310

我最近在标准域 (www.domain.com) 上安装了 WordPress，但不得不将其移至另一个具有子域 (blog.newdomain.com) 的域。我发现我遇到了与您非常相似的问题，尤其是 wp-admin 重定向到不再存在的先前域时。

我遇到了一个方便的 MySQL 数据库搜索和替换工具（可在[http://interconnectit.com/124/search-and-replace-for-wordpress-databases/](http://interconnectit.com/124/search-and-replace-for-wordpress-databases/)获得）并替换了原始 www.domain.com 的所有实例使用新的 blog.newdomain.com 并纠正了我的所有问题。

我希望这些信息对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T15:43:26.087

通常是导致问题的选项表。执行

```
update wp_options set option_value = replace(option_value, 'old_url', 'new_url'); 
```

因为数据库上的直接 SQL 应该可以解决问题（用正确的 url 替换 old_url 和 new_url）。

另一种方法是在 wp-config.php 文件中定义这两个 WP 常量，这将覆盖站点 URL 的 DB 设置：

```
define('WP_HOME','http://sitehomeurl');
define('WP_SITEURL','http://siteurl'); 
```

当然，在针对它运行 SQL 之前备份数据库的警告也适用。

# c# - Html Agility Pack：如何在c#中解析webresponse并获取指定的html元素

> ID：10378754
> 
> 赞同：1
> 
> 时间：2012-04-30T05:07:26.037
> 
> 标签：c#, html, parsing, html-agility-pack

我用谷歌搜索了我的问题，发现要解析的[Html Agility Pack](http://htmlagilitypack.codeplex.com/)是. 但是没有好的例子，我不能用它来达到我的目的。我有一个，它有一个像这样的部分：`html``c#``html document`

```
<div class="pray-times-holder">
    <div class="pray-time">
        <div class="labels">
            Time1:</div>
        04:28:24
    </div>
    <div class="pray-time">
        <div class="labels">
            Time2:</div>
        06:04:41
    </div>
</div> 
```

我想获得`Time1`and的值`Time2`。例如`Time1`有价值`04:28:24`，`Time2`有价值`06:04:41`，我想得到这些价值。你能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:56:42.003

```
HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
doc.LoadHtml(html);

var results = doc.DocumentNode
    .Descendants("div")
    .Where(n => n.Attributes["class"] != null && n.Attributes["class"].Value == "pray-time")
    .Select(n => n.InnerText.Replace("\r\n","").Trim())
    .ToArray(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T07:10:54.290

此控制台应用程序代码：

```
 HtmlDocument doc = new HtmlDocument();
 doc.Load(yourHtml);
 foreach (HtmlNode node in doc.DocumentNode.SelectNodes("//div[@class = 'labels']"))
 {
     Console.WriteLine(node.NextSibling.InnerText.Trim());
 } 
```

将输出：

```
04:28:24
06:04:41 
```

# android - Android TransitionDrawable 当前显示层

> ID：10378756
> 
> 赞同：1
> 
> 时间：2012-04-30T05:07:29.490
> 
> 标签：android, widget, android-ui, transitiondrawable

我有一个使用警报管理器进行频繁更新的小部件（当手机处于唤醒状态时）。由于更新需要访问本地 arduino 网络服务器，因此更新是在服务中完成的。

根据结果​​，希望将 TransitionDrawable 设置为一层或另一层。有没有办法告诉我当前显示的是哪个图层，这样我就可以知道哪个方向以及是否应该过渡？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T06:25:24.047

我不认为有这样的事情。你可以试试 drawable.getLevel() 看看是否有帮助。根据我的经验，transition drawable 实现只提供了 start 和 reset 方法，所以我不会花太多精力在它上面。

如果 getLevel 不起作用，只需使用标记您的状态的标志来处理它，无论如何您必须手动运行它并且只能设置 2 个可绘制对象？

# jquery - jquery中查找和过滤的区别

> ID：10378757
> 
> 赞同：28
> 
> 时间：2012-04-30T05:07:32.153
> 
> 标签：jquery, find, web-crawler

我正在从 wiki 页面获取数据。我正在使用`php`和的组合`jquery`来做到这一点。首先，我使用`curl`in`php`来获取页面内容并回显内容。文件名是`content.php`：

```
$url = $_GET['url'];
$url = trim($url," ");
$url = urldecode($url);
$url = str_replace(" ","%20",$url);

echo "<a class='urlmax'>".$_GET['title']."</a>";
echo crawl($url); 
```

然后`jQuery`用于查找匹配的元素。

```
$.get("content.php",{url:"http://en.wikipedia.org/w/index.php?action=render&title="+str_replace(" ","_",data[x]),title:str_replace(" ","_",data[x])},function(hdata){
                        var imgs = $(hdata).find('a.image img');
                        var ent = $(hdata).filter('a.urlmax');

                        ent = $(ent[0]).text();

}); 
```

我能够成功获取图像，但是对于变量 ent 当我使用 find 而不是 filter 时，它返回一个空数组。只有过滤器在工作。为什么是这样？

编辑：我知道查找和过滤之间的基本区别。这里`a.image img`和`a.urlmax`都是 的后代`hdata`。那为什么 find 不起作用`a.urlmax`。不仅`a.urlmax`如此，它不适用于任何其他类或 id

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-04-30T05:12:40.777

.find() [http://api.jquery.com/find/](http://api.jquery.com/find/)

> 获取当前匹配元素集中*每个元素的后代*，由选择器、jQuery 对象或元素过滤。

另一方面，过滤器适用于当前匹配的元素。这就是为什么 filter 有效但 find 无效（您需要查看当前元素）。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-04-30T05:12:40.457

`filter`将从所选元素中选择元素的子集

`find`将选择所选元素的后代/子代

为了更清楚， filter 将搜索所有元素，而 find 将仅在后代列表中搜索

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-11-14T12:52:37.213

## 。寻找（）

它将返回所选元素的后代元素。

示例（[jsfiddle](https://jsfiddle.net/mhdhamouday/fyac05mr/1/)）：

```
 <style>
      .Cell{
         margin: 15px;
         width: 400px;
         border: 2px solid lightgrey;

      }
      .Cell * {
         display: block;
         border: 2px solid lightgrey;
         color: lightgrey;
         padding: 5px;
         margin: 10px;
    }
    </style>

    <div class='Cell Plus'>div (1)
      <div class='Plus'>Child</div>
    </div>

    <div class='Cell Plus'>div (2)
      <div class='Plus'>Child</div>
    </div> 
```

JS：

```
$(".Cell").find(".Plus").css({"color": "red", "border": "2px solid red"}); 
```

结果：

[![在此处输入图像描述](../Images/e8ed2a2e60b5999ca5288db8b57c2c2b.png)](https://i.stack.imgur.com/ulkBl.png)

* * *

## 。筛选（）

它将返回符合特定条件的元素。

使用上面相同的 html：

```
$(".Cell").filter(".Plus").css({"color": "red", "border": "2px solid red"}); 
```

结果：

[![筛选结果](../Images/9ba44999b058bd3aa2271a7f3335b4ed.png)](https://i.stack.imgur.com/6UYSZ.png)

# html - html搜索表单，我如何减少URL

> ID：10378759
> 
> 赞同：1
> 
> 时间：2012-04-30T05:08:08.177
> 
> 标签：html, forms

我目前正在创建使用 GET 方法的搜索，问题是即使未选择值并将其保留为默认值，它们也会被发送并在 url 中可见。

我只想在 url 中选择值，而不是表单的每个当前值，包括默认值 0。

网址结尾又长又讨厌： search.php?search_shop_name=mcdonalds&search_shop_address=&search_total_rating=0&search_shop_comfort=0&search_shop_service=2&search_shop_ambience=0&search_shop_friendly=0&search_shop_spacious=0&search_shop_experience=0&submit=#legend_total_results

我基本上想整理网址，实际上不确定删除不需要的数据是否是一个好的过程，对这种情况有什么可能的建议吗？不确定我是否对视觉效果有强迫症 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T05:12:36.923

我会做以下事情。使用 JavaScript 或 jQuery 创建一个提交函数，在该函数中对所有字段进行验证搜索，如果它们 = null 则不包括它们。

例如

```
var search;
 function search(){
   if(input[name=search].val() != null)
   {
     search = "q="+input[name=search].val();
   }

   if(input[name=search_shop_experience].val() != null)
   {
     search += "search_shop_experience="+input[name=ssearch_shop_experience].val();
   }
 } 
```

我认为你这样做`.=`或它的`+=`。

# php - HTML 表单的多个操作

> ID：10378760
> 
> 赞同：2
> 
> 时间：2012-04-30T05:08:18.387
> 
> 标签：php, html

我正在尝试将 HTML 表单发布到 2 个不同的 php 脚本。一个在我的服务器上，另一个在另一个服务器上。基本上我试图让它 action="script1.php" action="script2.php" 我不确定我是否可以使用我的 php 脚本将 $_POST 数组转发到另一个 php 脚本。让我知道您是否可以提供帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T05:11:11.377

您可以使用 cURL 将数据从 script1.php POST 到 script2.php。

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'http://whatever/script2.php');
curl_setopt($ch, CURLOPT_POST, TRUE);
curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($_POST);
curl_exec($ch);
curl_close($ch); 
```

未经测试，但类似的东西应该适合你。另见： [http ://davidwalsh.name/execute-http-post-php-curl](http://davidwalsh.name/execute-http-post-php-curl)

[http://php.net/manual/en/function.http-build-query.php](http://php.net/manual/en/function.http-build-query.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T05:09:33.753

在您的 php 服务器上使用[curl](http://php.net/manual/en/book.curl.php)将信息发布到另一台服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T07:16:59.397

您可以使用 javascript 执行此操作。您可以让这个表单有一个特殊的类“DoubleAction”，然后在 javascript 中，您可以检查表单并将其发布到两个操作中，如下面的 javascript 示例所示：

```
if ( obj.hasClass('DoubleAction') ) {
        obj.submit(function() {

            var params = $(this).serialize(); 

            $.post( this.getAttribute("action"), params, clientData.ajaxLinksClient.complete );

            action2 = $(this).attr('action2');
            if ( typeof(action2) != 'undefined' && action2 != null && action2 != '' ) {
                $.post( action2, params );
            }
        });
    } 
```

# javascript - 使用 Javascript 中的指定参数运行 cmd.exe

> ID：10378761
> 
> 赞同：0
> 
> 时间：2012-04-30T05:08:26.740
> 
> 标签：javascript, shell, command-line, cmd

Colls，我写了一个脚本，它应该：

1.  将文件从 C:\PR\DataFiles\Input\CL_CH5\"+k+"\ext_028042012.dat 复制到 C:\PR\DataFiles\Input\ext_028042012.dat - 工作正常

2.  使用指定的命令行运行 cmd.exe (p.3)

3.  运行 cmd.exe 后，脚本应该转到 c: 磁盘，然后将目录更改为 c:/pr，然后在 cmd 行中写入 «process.bat c:\pr ext_028042012.dat auto» 并按 Enter。

**代码是**：

```
 var fso = new ActiveXObject("Scripting.FileSystemObject");  
     for (var k = -2; k <= 0; k++)  
     {  
         var out_dir = "C:\\PROBE\\DataFiles\\Input\\CL_CH5";  
         // now i am copying a ext_028042012 to destination folder    
         fso.CopyFile("C:\\PR\\DataFiles\\Input\\CL_CH5\\"+k+"\\ext_028042012.dat",                                                                            
         "C:\\PR\\DataFiles\\Input\\ext_028042012.dat", 1);  
         WScript.Echo(k+"file copied.");  
         /*Block which run cmd window*/  
         //The following code should open a command window, changes to the path to C:\ ,   and executes the DIR command.
         var oShell = WScript.CreateObject ("WScript.Shell");  
         **oShell.run ("cmd /K cd c:\pr /K process.bat c:\ext_028042012.dat auto");**  
         WScript.Echo(k+ "file proceed!!!"); 
```

1.  不幸的是，它不起作用。脚本不会将 p.3 中的命令行放到打开的 cmd.exe 窗口中。请告诉我我的错误在哪里。十分感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:33:12.393

你的[命令](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/cmd.mspx?mfr=true)字符串，

```
"cmd /K cd c:\pr /K process.bat c:\ext_028042012.dat auto" 
```

看起来是错误的。我不相信你可以指定几个`/K`这样的命令——因为它的意思`/K`是*“执行命令并继续”，*永远不会结束你启动的第一个 shell。

你有没有尝试过：

```
"cmd /K cd c:\pr && process.bat c:\ext_028042012.dat auto" 
```

# java - Android中是否有波斯（Shamsi或Jalali）日历的库或算法？

> ID：10378764
> 
> 赞同：86
> 
> 时间：2012-04-30T05:08:45.040
> 
> 标签：java, android, farsi, jalali-calendar

对于所有版本的 Android，我想将**公历**（西方）日期转换为**波斯**（Shamsi）日期，反之亦然。

有没有完整可靠的库或算法？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-05-07T05:04:17.310

我多年来一直使用这个算法，它在 1901 年到 2099 年之间非常准确。

使用它并享受！:)

```
public class Utilities {

    private class SolarCalendar {

        public String strWeekDay = "";
        public String strMonth = "";

        int date;
        int month;
        int year;

        public SolarCalendar()
        {
            Date MiladiDate = new Date();
            calcSolarCalendar(MiladiDate);
        }

        public SolarCalendar(Date MiladiDate)
        {
            calcSolarCalendar(MiladiDate);
        }

        private void calcSolarCalendar(Date MiladiDate) {

            int ld;

            int miladiYear = MiladiDate.getYear() + 1900;
            int miladiMonth = MiladiDate.getMonth() + 1;
            int miladiDate = MiladiDate.getDate();
            int WeekDay = MiladiDate.getDay();

            int[] buf1 = new int[12];
            int[] buf2 = new int[12];

            buf1[0] = 0;
            buf1[1] = 31;
            buf1[2] = 59;
            buf1[3] = 90;
            buf1[4] = 120;
            buf1[5] = 151;
            buf1[6] = 181;
            buf1[7] = 212;
            buf1[8] = 243;
            buf1[9] = 273;
            buf1[10] = 304;
            buf1[11] = 334;

            buf2[0] = 0;
            buf2[1] = 31;
            buf2[2] = 60;
            buf2[3] = 91;
            buf2[4] = 121;
            buf2[5] = 152;
            buf2[6] = 182;
            buf2[7] = 213;
            buf2[8] = 244;
            buf2[9] = 274;
            buf2[10] = 305;
            buf2[11] = 335;

            if ((miladiYear % 4) != 0) {
                date = buf1[miladiMonth - 1] + miladiDate;

                if (date > 79) {
                    date = date - 79;
                    if (date <= 186) {
                        switch (date % 31) {
                        case 0:
                            month = date / 31;
                            date = 31;
                            break;
                        default:
                            month = (date / 31) + 1;
                            date = (date % 31);
                            break;
                        }
                        year = miladiYear - 621;
                    } else {
                        date = date - 186;

                        switch (date % 30) {
                        case 0:
                            month = (date / 30) + 6;
                            date = 30;
                            break;
                        default:
                            month = (date / 30) + 7;
                            date = (date % 30);
                            break;
                        }
                        year = miladiYear - 621;
                    }
                } else {
                    if ((miladiYear > 1996) && (miladiYear % 4) == 1) {
                        ld = 11;
                    } else {
                        ld = 10;
                    }
                    date = date + ld;

                    switch (date % 30) {
                    case 0:
                        month = (date / 30) + 9;
                        date = 30;
                        break;
                    default:
                        month = (date / 30) + 10;
                        date = (date % 30);
                        break;
                    }
                    year = miladiYear - 622;
                }
            } else {
                date = buf2[miladiMonth - 1] + miladiDate;

                if (miladiYear >= 1996) {
                    ld = 79;
                } else {
                    ld = 80;
                }
                if (date > ld) {
                    date = date - ld;

                    if (date <= 186) {
                        switch (date % 31) {
                        case 0:
                            month = (date / 31);
                            date = 31;
                            break;
                        default:
                            month = (date / 31) + 1;
                            date = (date % 31);
                            break;
                        }
                        year = miladiYear - 621;
                    } else {
                        date = date - 186;

                        switch (date % 30) {
                        case 0:
                            month = (date / 30) + 6;
                            date = 30;
                            break;
                        default:
                            month = (date / 30) + 7;
                            date = (date % 30);
                            break;
                        }
                        year = miladiYear - 621;
                    }
                }

                else {
                    date = date + 10;

                    switch (date % 30) {
                    case 0:
                        month = (date / 30) + 9;
                        date = 30;
                        break;
                    default:
                        month = (date / 30) + 10;
                        date = (date % 30);
                        break;
                    }
                    year = miladiYear - 622;
                }

            }

            switch (month) {
            case 1:
                strMonth = "فروردين";
                break;
            case 2:
                strMonth = "ارديبهشت";
                break;
            case 3:
                strMonth = "خرداد";
                break;
            case 4:
                strMonth = "تير";
                break;
            case 5:
                strMonth = "مرداد";
                break;
            case 6:
                strMonth = "شهريور";
                break;
            case 7:
                strMonth = "مهر";
                break;
            case 8:
                strMonth = "آبان";
                break;
            case 9:
                strMonth = "آذر";
                break;
            case 10:
                strMonth = "دي";
                break;
            case 11:
                strMonth = "بهمن";
                break;
            case 12:
                strMonth = "اسفند";
                break;
            }

            switch (WeekDay) {

            case 0:
                strWeekDay = "يکشنبه";
                break;
            case 1:
                strWeekDay = "دوشنبه";
                break;
            case 2:
                strWeekDay = "سه شنبه";
                break;
            case 3:
                strWeekDay = "چهارشنبه";
                break;
            case 4:
                strWeekDay = "پنج شنبه";
                break;
            case 5:
                strWeekDay = "جمعه";
                break;
            case 6:
                strWeekDay = "شنبه";
                break;
            }

        }

    }

    public static String getCurrentShamsidate() {
        Locale loc = new Locale("en_US");
        Utilities util = new Utilities();
        SolarCalendar sc = util.new SolarCalendar();
        return String.valueOf(sc.year) + "/" + String.format(loc, "%02d",
                sc.month) + "/" + String.format(loc, "%02d", sc.date);
    }
} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-05-07T05:37:31.793

我认为这个java类更容易使用，更可靠。我在[伊朗论坛上](http://barnamenevis.org/archive/index.php/t-273252.html)找到了它，伊朗人使用 Jalali 日历并将其称为“Shamsi”，意思是阳历。这是Java类：

```
package MyUtil;

import java.util.Calendar;
import java.util.GregorianCalendar;

/**
 * Title: Calender Conversion class
 * Description: Convert Iranian (Jalali), Julian, and Gregorian dates to
 * each other
 * Public Methods Summary:
 * -----------------------
 * JavaSource_Calendar();
 * JavaSource_Calendar(int year, int month, int day);
 * int getIranianYear();
 * int getIranianMonth();
 * int getIranianDay();
 * int getGregorianYear();
 * int getGregorianMonth();
 * int getGregorianDay();
 * int getJulianYear();
 * int getJulianMonth();
 * int getJulianDay();
 * String getIranianDate();
 * String getGregorianDate();
 * String getJulianDate();
 * String getWeekDayStr();
 * String toString();
 * int getDayOfWeek();
 * void nextDay();
 * void nextDay(int days);
 * void previousDay();
 * void previousDay(int days);
 * void setIranianDate(int year, int month, int day);
 * void setGregorianDate(int year, int month, int day);
 * void setJulianDate(int year, int month, int day);
 */
public class CalendarTool {

    /**
     * JavaSource_Calendar:
     * The default constructor uses the current Gregorian date to initialize the
     * other private memebers of the class (Iranian and Julian dates).
     */
    public CalendarTool()
    {
        Calendar calendar = new GregorianCalendar();
        setGregorianDate(calendar.get(Calendar.YEAR),
                calendar.get(Calendar.MONTH)+1,
                calendar.get(Calendar.DAY_OF_MONTH));
    }

    /**
     * JavaSource_Calendar:
     * This constructor receives a Gregorian date and initializes the other private
     * members of the class accordingly.
     * @param year int
     * @param month int
     * @param day int
     */
    public CalendarTool(int year, int month, int day)
    {
        setGregorianDate(year,month,day);
    }

    /**
     * getIranianYear:
     * Returns the 'year' part of the Iranian date.
     * @return int
     */
    public int getIranianYear() {
        return irYear;
    }

    /**
     * getIranianMonth:
     * Returns the 'month' part of the Iranian date.
     * @return int
     */
    public int getIranianMonth() {
        return irMonth;
    }

    /**
     * getIranianDay:
     * Returns the 'day' part of the Iranian date.
     * @return int
     */
    public int getIranianDay() {
        return irDay;
    }

    /**
     * getGregorianYear:
     * Returns the 'year' part of the Gregorian date.
     * @return int
     */
    public int getGregorianYear() {
        return gYear;
    }

    /**
     * getGregorianMonth:
     * Returns the 'month' part of the Gregorian date.
     * @return int
     */
    public int getGregorianMonth() {
        return gMonth;
    }

    /**
     * getGregorianDay:
     * Returns the 'day' part of the Gregorian date.
     * @return int
     */
    public int getGregorianDay() {
        return gDay;
    }

    /**
     * getJulianYear:
     * Returns the 'year' part of the Julian date.
     * @return int
     */
    public int getJulianYear() {
        return juYear;
    }

    /**
     * getJulianMonth:
     * Returns the 'month' part of the Julian date.
     * @return int
     */
    public int getJulianMonth() {
        return juMonth;
    }

    /**
     * getJulianDay()
     * Returns the 'day' part of the Julian date.
     * @return int
     */
    public int getJulianDay() {
        return juDay;
    }

    /**
     * getIranianDate:
     * Returns a string version of Iranian date
     * @return String
     */
    public String getIranianDate()
    {
        return (irYear+"/"+irMonth+"/"+irDay);
    }

    /**
     * getGregorianDate:
     * Returns a string version of Gregorian date
     * @return String
     */
    public String getGregorianDate()
    {
        return (gYear+"/"+gMonth+"/"+gDay);
    }

    /**
     * getJulianDate:
     * Returns a string version of Julian date
     * @return String
     */
    public String getJulianDate()
    {
        return (juYear+"/"+juMonth+"/"+juDay);
    }

    /**
     * getWeekDayStr:
     * Returns the week day name.
     * @return String
     */
    public String getWeekDayStr()
    {
        String weekDayStr[]={
                "Monday",
                "Tuesday",
                "Wednesday",
                "Thursday",
                "Friday",
                "Saturday",
        "Sunday"};
        return (weekDayStr[getDayOfWeek()]);
    }

    /**
     * toString:
     * Overrides the default toString() method to return all dates.
     * @return String
     */
    public String toString()
    {
        return (getWeekDayStr()+
                ", Gregorian:["+getGregorianDate()+
                "], Julian:["+getJulianDate()+
                "], Iranian:["+getIranianDate()+"]");
    }

    /**
     * getDayOfWeek:
     * Returns the week day number. Monday=0..Sunday=6;
     * @return int
     */
    public int getDayOfWeek()
    {
        return (JDN % 7);
    }

    /**
     * nextDay:
     * Go to next julian day number (JDN) and adjusts the other dates.
     */
    public void nextDay()
    {
        JDN++;
        JDNToIranian();
        JDNToJulian();
        JDNToGregorian();
    }
    /**
     * nextDay:
     * Overload the nextDay() method to accept the number of days to go ahead and
     * adjusts the other dates accordingly.
     * @param days int
     */
    public void nextDay(int days)
    {
        JDN+=days;
        JDNToIranian();
        JDNToJulian();
        JDNToGregorian();
    }

    /**
     * previousDay:
     * Go to previous julian day number (JDN) and adjusts the otehr dates.
     */
    public void previousDay()
    {
        JDN--;
        JDNToIranian();
        JDNToJulian();
        JDNToGregorian();
    }

    /**
     * previousDay:
     * Overload the previousDay() method to accept the number of days to go backward
     * and adjusts the other dates accordingly.
     * @param days int
     */
    public void previousDay(int days)
    {
        JDN-=days;
        JDNToIranian();
        JDNToJulian();
        JDNToGregorian();
    }

    /**
     * setIranianDate:
     * Sets the date according to the Iranian calendar and adjusts the other dates.
     * @param year int
     * @param month int
     * @param day int
     */
    public void setIranianDate(int year, int month, int day)
    {
        irYear =year;
        irMonth = month;
        irDay = day;
        JDN = IranianDateToJDN();
        JDNToIranian();
        JDNToJulian();
        JDNToGregorian();
    }

    /**
     * setGregorianDate:
     * Sets the date according to the Gregorian calendar and adjusts the other dates.
     * @param year int
     * @param month int
     * @param day int
     */
    public void setGregorianDate(int year, int month, int day)
    {
        gYear = year;
        gMonth = month;
        gDay = day;
        JDN = gregorianDateToJDN(year,month,day);
        JDNToIranian();
        JDNToJulian();
        JDNToGregorian();
    }

    /**
     * setJulianDate:
     * Sets the date according to the Julian calendar and adjusts the other dates.
     * @param year int
     * @param month int
     * @param day int
     */
    public void setJulianDate(int year, int month, int day)
    {
        juYear = year;
        juMonth = month;
        juDay = day;
        JDN = julianDateToJDN(year,month,day);
        JDNToIranian();
        JDNToJulian();
        JDNToGregorian();
    }

    /**
     * IranianCalendar:
     * This method determines if the Iranian (Jalali) year is leap (366-day long)
     * or is the common year (365 days), and finds the day in March (Gregorian
     * Calendar)of the first day of the Iranian year ('irYear').Iranian year (irYear)
     * ranges from (-61 to 3177).This method will set the following private data
     * members as follows:
     * leap: Number of years since the last leap year (0 to 4)
     * Gy: Gregorian year of the begining of Iranian year
     * march: The March day of Farvardin the 1st (first day of jaYear)
     */
    private void IranianCalendar()
    {
        // Iranian years starting the 33-year rule
        int Breaks[]=
            {-61, 9, 38, 199, 426, 686, 756, 818,1111,1181,
                1210,1635,2060,2097,2192,2262,2324,2394,2456,3178} ;
        int jm,N,leapJ,leapG,jp,j,jump;
        gYear = irYear + 621;
        leapJ = -14;
        jp = Breaks[0];
        // Find the limiting years for the Iranian year 'irYear'
        j=1;
        do{
            jm=Breaks[j];
            jump = jm-jp;
            if (irYear >= jm)
            {
                leapJ += (jump / 33 * 8 + (jump % 33) / 4);
                jp = jm;
            }
            j++;
        } while ((j<20) && (irYear >= jm));
        N = irYear - jp;
        // Find the number of leap years from AD 621 to the begining of the current
        // Iranian year in the Iranian (Jalali) calendar
        leapJ += (N/33 * 8 + ((N % 33) +3)/4);
        if ( ((jump % 33) == 4 ) && ((jump-N)==4))
            leapJ++;
        // And the same in the Gregorian date of Farvardin the first
        leapG = gYear/4 - ((gYear /100 + 1) * 3 / 4) - 150;
        march = 20 + leapJ - leapG;
        // Find how many years have passed since the last leap year
        if ( (jump - N) < 6 )
            N = N - jump + ((jump + 4)/33 * 33);
        leap = (((N+1) % 33)-1) % 4;
        if (leap == -1)
            leap = 4;
    }

    /**
     * IsLeap:
     * This method determines if the Iranian (Jalali) year is leap (366-day long)
     * or is the common year (365 days), and finds the day in March (Gregorian
     * Calendar)of the first day of the Iranian year ('irYear').Iranian year (irYear)
     * ranges from (-61 to 3177).This method will set the following private data
     * members as follows:
     * leap: Number of years since the last leap year (0 to 4)
     * Gy: Gregorian year of the begining of Iranian year
     * march: The March day of Farvardin the 1st (first day of jaYear)
     */
    public boolean IsLeap(int irYear1)
    {
        // Iranian years starting the 33-year rule
        int Breaks[]=
            {-61, 9, 38, 199, 426, 686, 756, 818,1111,1181,
                1210,1635,2060,2097,2192,2262,2324,2394,2456,3178} ;
        int jm,N,leapJ,leapG,jp,j,jump;
        gYear = irYear1 + 621;
        leapJ = -14;
        jp = Breaks[0];
        // Find the limiting years for the Iranian year 'irYear'
        j=1;
        do{
            jm=Breaks[j];
            jump = jm-jp;
            if (irYear1 >= jm)
            {
                leapJ += (jump / 33 * 8 + (jump % 33) / 4);
                jp = jm;
            }
            j++;
        } while ((j<20) && (irYear1 >= jm));
        N = irYear1 - jp;
        // Find the number of leap years from AD 621 to the begining of the current
        // Iranian year in the Iranian (Jalali) calendar
        leapJ += (N/33 * 8 + ((N % 33) +3)/4);
        if ( ((jump % 33) == 4 ) && ((jump-N)==4))
            leapJ++;
        // And the same in the Gregorian date of Farvardin the first
        leapG = gYear/4 - ((gYear /100 + 1) * 3 / 4) - 150;
        march = 20 + leapJ - leapG;
        // Find how many years have passed since the last leap year
        if ( (jump - N) < 6 )
            N = N - jump + ((jump + 4)/33 * 33);
        leap = (((N+1) % 33)-1) % 4;
        if (leap == -1)
            leap = 4;
        if (leap==4 || leap==0)
            return true;
        else
            return false;

    }

    /**
     * IranianDateToJDN:
     * Converts a date of the Iranian calendar to the Julian Day Number. It first
     * invokes the 'IranianCalender' private method to convert the Iranian date to
     * Gregorian date and then returns the Julian Day Number based on the Gregorian
     * date. The Iranian date is obtained from 'irYear'(1-3100),'irMonth'(1-12) and
     * 'irDay'(1-29/31).
     * @return long (Julian Day Number)
     */
    private int IranianDateToJDN()
    {
        IranianCalendar();
        return (gregorianDateToJDN(gYear,3,march)+ (irMonth-1) * 31 - irMonth/7 * (irMonth-7) + irDay -1);
    }

    /**
     * JDNToIranian:
     * Converts the current value of 'JDN' Julian Day Number to a date in the
     * Iranian calendar. The caller should make sure that the current value of
     * 'JDN' is set correctly. This method first converts the JDN to Gregorian
     * calendar and then to Iranian calendar.
     */
    private void JDNToIranian()
    {
        JDNToGregorian();
        irYear = gYear - 621;
        IranianCalendar(); // This invocation will update 'leap' and 'march'
        int JDN1F = gregorianDateToJDN(gYear,3,march);
        int k = JDN - JDN1F;
        if (k >= 0)
        {
            if (k <= 185)
            {
                irMonth = 1 + k/31;
                irDay = (k % 31) + 1;
                return;
            }
            else
                k -= 186;
        }
        else
        {
            irYear--;
            k += 179;
            if (leap == 1)
                k++;
        }
        irMonth = 7 + k/30;
        irDay = (k % 30) + 1;
    }

    /**
     * julianDateToJDN:
     * Calculates the julian day number (JDN) from Julian calendar dates. This
     * integer number corresponds to the noon of the date (i.e. 12 hours of
     * Universal Time). This method was tested to be good (valid) since 1 March,
     * -100100 (of both calendars) up to a few millions (10^6) years into the
     * future. The algorithm is based on D.A.Hatcher, Q.Jl.R.Astron.Soc. 25(1984),
     * 53-55 slightly modified by K.M. Borkowski, Post.Astron. 25(1987), 275-279.
     * @param year int
     * @param month int
     * @param day int
     * @return int
     */
    private int julianDateToJDN(int year, int month, int day)
    {
        return (year + (month - 8) / 6 + 100100) * 1461/4 + (153 * ((month+9) % 12) + 2)/5 + day - 34840408;
    }

    /**
     * JDNToJulian:
     * Calculates Julian calendar dates from the julian day number (JDN) for the
     * period since JDN=-34839655 (i.e. the year -100100 of both calendars) to
     * some millions (10^6) years ahead of the present. The algorithm is based on
     * D.A. Hatcher, Q.Jl.R.Astron.Soc. 25(1984), 53-55 slightly modified by K.M.
     * Borkowski, Post.Astron. 25(1987), 275-279).
     */
    private void JDNToJulian()
    {
        int j= 4 * JDN + 139361631;
        int i= ((j % 1461)/4) * 5 + 308;
        juDay = (i % 153) / 5 + 1;
        juMonth = ((i/153) % 12) + 1;
        juYear = j/1461 - 100100 + (8-juMonth)/6;
    }

    /**
     * gergorianDateToJDN:
     * Calculates the julian day number (JDN) from Gregorian calendar dates. This
     * integer number corresponds to the noon of the date (i.e. 12 hours of
     * Universal Time). This method was tested to be good (valid) since 1 March,
     * -100100 (of both calendars) up to a few millions (10^6) years into the
     * future. The algorithm is based on D.A.Hatcher, Q.Jl.R.Astron.Soc. 25(1984),
     * 53-55 slightly modified by K.M. Borkowski, Post.Astron. 25(1987), 275-279.
     * @param year int
     * @param month int
     * @param day int
     * @return int
     */
    private int gregorianDateToJDN(int year, int month, int day)
    {
        int jdn = (year + (month - 8) / 6 + 100100) * 1461/4 + (153 * ((month+9) % 12) + 2)/5 + day - 34840408;
        jdn = jdn - (year + 100100+(month-8)/6)/100*3/4+752;
        return (jdn);
    }
    /**
     * JDNToGregorian:
     * Calculates Gregorian calendar dates from the julian day number (JDN) for
     * the period since JDN=-34839655 (i.e. the year -100100 of both calendars) to
     * some millions (10^6) years ahead of the present. The algorithm is based on
     * D.A. Hatcher, Q.Jl.R.Astron.Soc. 25(1984), 53-55 slightly modified by K.M.
     * Borkowski, Post.Astron. 25(1987), 275-279).
     */
    private void JDNToGregorian()
    {
        int j= 4 * JDN + 139361631;
        j = j + (((((4* JDN +183187720)/146097)*3)/4)*4-3908);
        int i= ((j % 1461)/4) * 5 + 308;
        gDay = (i % 153) / 5 + 1;
        gMonth = ((i/153) % 12) + 1;
        gYear = j/1461 - 100100 + (8-gMonth)/6;
    }

    private int irYear; // Year part of a Iranian date
    private int irMonth; // Month part of a Iranian date
    private int irDay; // Day part of a Iranian date
    private int gYear; // Year part of a Gregorian date
    private int gMonth; // Month part of a Gregorian date
    private int gDay; // Day part of a Gregorian date
    private int juYear; // Year part of a Julian date
    private int juMonth; // Month part of a Julian date
    private int juDay; // Day part of a Julian date
    private int leap; // Number of years since the last leap year (0 to 4)
    private int JDN; // Julian Day Number
    private int march; // The march day of Farvardin the first (First day of jaYear)
} // End of Class 'JavaSource_Calendar 
```

您可以轻松设置公历日、月和年，然后调用“getIranianDate()”方法获取字符串格式的日期，如下面的示例代码：

```
MyUtil.CalendarTool ct = new CalendarTool(2012,10,10);
System.out.println(ct.getIranianDate()); 
```

我希望它有所帮助。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2016-10-21T21:53:52.777

使用**IBM**的**Unicode 国际组件**( [icu4j](http://site.icu-project.org) )。它是[Unicode Consortium](http://blog.unicode.org/2016/05/icu-joins-unicode-consortium.html)的一部分，非常可靠，可用于任何 Java 项目（Java EE、Java SE、Android 等）。将它与[**Gradle**](https://mvnrepository.com/artifact/com.ibm.icu/icu4j)、[**Maven**](https://mvnrepository.com/artifact/com.ibm.icu/icu4j)或简单地通过[下载](http://site.icu-project.org/download)jar 一起使用。

## TL;博士

```
import java.time.Instant;
import java.time.LocalDateTime;
import java.time.ZoneId;
import java.time.ZonedDateTime;
import java.util.Date;
import com.ibm.icu.text.DateFormat;
import com.ibm.icu.text.SimpleDateFormat;
import com.ibm.icu.util.Calendar;
import com.ibm.icu.util.ULocale;

public class DateTimeUtils {
    public static final ULocale PERSIAN_LOCALE = new ULocale("fa_IR@calendar=persian");
    public static final ULocale PERSIAN_EN_LOCALE = new ULocale("en@calendar=persian");
    public static final ZoneId IRAN_ZONE_ID = ZoneId.of("Asia/Tehran");

    public static Calendar fromDateToPersianCalendar(Date date) {
        Calendar persianCalendar = Calendar.getInstance(PERSIAN_LOCALE);
        persianCalendar.clear();
        persianCalendar.setTime(date);
        return persianCalendar;
    }

    /**
     * @param date
     * @param field example: Calendar.YEAR, Calendar.MONTH, Calendar.DAY_OF_MONTH, etc
     */
    public static int fromDateToPersianCalendarField(Date date, int field) {
        return fromDateToPersianCalendar(date).get(field);
    }

    public static String fromDateToPersianString(Date date) {
        DateFormat df = DateFormat.getDateInstance(DateFormat.FULL, PERSIAN_LOCALE);
        return df.format(date);
    }

    public static String fromDateToPersianString(Date date, String pattern) {
        return new SimpleDateFormat(pattern, PERSIAN_LOCALE).format(date);
    }

    public static String fromDateToPersianString(Date date, String pattern, ULocale locale) {
        return new SimpleDateFormat(pattern, locale).format(date);
    }

    /**
     * @param month is zero based. (e.g. Farvardin = 0, Ordibehesht = 1, etc.)
     */
    public static Date fromPersianDateToDate(int year, int month, int day, int hour, int minutes, int seconds) {
        return new Date(fromPersianDate(year, month, day, hour, minutes, seconds));
    }

    /**
     * @param month is zero based. (e.g. Farvardin = 0, Ordibehesht = 1, etc.)
     */    
    public static String fromPersianDateToPersianString(int year, int month, int day, int hour, int minutes, int seconds) {
        return fromDateToPersianString(fromPersianDateToDate(year, month, day, hour, minutes, seconds));
    }

    /**
     * @param month is zero based. (e.g. Farvardin = 0, Ordibehesht = 1, etc.)
     */      
    public static LocalDateTime fromPersianDateToLocalDateTime(int year, int month, int day, int hour, int minutes, int seconds) {
        return fromPersianDateToZonedDateTime(year, month, day, hour, minutes, seconds).toLocalDateTime();
    }

    /**
     * @param month is zero based. (e.g. Farvardin = 0, Ordibehesht = 1, etc.)
     */  
    public static ZonedDateTime fromPersianDateToZonedDateTime(int year, int month, int day, int hour, int minutes, int seconds) {
        return toZonedDateTime(fromPersianDate(year, month, day, hour, minutes, seconds));
    }

    /**
     * @param month is zero based. (e.g. Farvardin = 0, Ordibehesht = 1, etc.)
     */  
    public static long fromPersianDate(int year, int month, int day, int hour, int minutes, int seconds) {
        Calendar persianCalendar = Calendar.getInstance(PERSIAN_LOCALE);
        persianCalendar.clear();
        persianCalendar.set(year, month, day, hour, minutes, seconds);
        return persianCalendar.getTimeInMillis();
    }

    public static ZonedDateTime toZonedDateTime(Long epochMilli) {
        if(epochMilli == null) return null;
        return Instant.ofEpochMilli(epochMilli).atZone(IRAN_ZONE_ID);
    }
} 
```

用法：

```
import java.time.LocalDateTime;
import java.time.ZonedDateTime;
import java.util.Date;
import com.ibm.icu.util.Calendar;

public class DateTimeUtilsTest {
    public static void main(String[] args) {
        System.out.println("Java 7 and before:");
        Date date = new Date(1467262800000L);
        System.out.println("Converting Gregorian date to Persian:");
        Calendar persianCalendar = DateTimeUtils.fromDateToPersianCalendar(date);
        System.out.println(persianCalendar.get(Calendar.YEAR));
        System.out.println(persianCalendar.get(Calendar.MONTH));
        System.out.println(persianCalendar.get(Calendar.DAY_OF_MONTH));
        System.out.println(DateTimeUtils.fromDateToPersianString(persianCalendar.getTime()));

        System.out.println("\nAdding 1 month and 5 days:");
        persianCalendar.add(Calendar.MONTH, 1); // add a month
        persianCalendar.add(Calendar.DAY_OF_MONTH, 5); // add 5 days
        System.out.println(persianCalendar.get(Calendar.YEAR));
        System.out.println(persianCalendar.get(Calendar.MONTH));
        System.out.println(persianCalendar.get(Calendar.DAY_OF_MONTH));
        System.out.println(DateTimeUtils.fromDateToPersianString(persianCalendar.getTime()));

        System.out.println("\nConverting Persian date to Gregorian:");
        Date gregorianDate = DateTimeUtils.fromPersianDateToDate(1395, 3, 10, 9, 30, 0);
        System.out.println(gregorianDate);
        System.out.println(DateTimeUtils.fromDateToPersianString(gregorianDate)); // to Persian string
        System.out.println(DateTimeUtils.fromDateToPersianString(gregorianDate, "dd/MM/yy - H:mm:dd")); // to Persian string with custom format
        System.out.println(DateTimeUtils.fromDateToPersianString(gregorianDate, "dd/MM/yy - H:mm:dd" , DateTimeUtils.PERSIAN_EN_LOCALE)); // to Persian string with custom format and Latin characters

        System.out.println("\n"+"Java 8 onward:");
        ZonedDateTime gregorianZonedDateTime = DateTimeUtils.fromPersianDateToZonedDateTime(1395, 3, 10, 9, 30, 0);
        System.out.println(gregorianZonedDateTime);
        LocalDateTime gregorianLocalDateTime = DateTimeUtils.fromPersianDateToLocalDateTime(1395, 3, 10, 9, 30, 0);
        System.out.println(gregorianLocalDateTime);
    }
} 
```

输出：

```
Java 7 and before:
Converting Gregorian date to Persian:
1395
3
10
۱۳۹۵ تیر ۱۰, پنجشنبه

Adding 1 month and 5 days:
1395
4
15
۱۳۹۵ مرداد ۱۵, جمعه

Converting Persian date to Gregorian:
Thu Jun 30 09:30:00 IRDT 2016
۱۳۹۵ تیر ۱۰, پنجشنبه
۱۰/۰۴/۹۵ - ۹:۳۰:۱۰
10/04/95 - 9:30:10

Java 8 onward:
2016-06-30T09:30+04:30[Asia/Tehran]
2016-06-30T09:30 
```

* * *

## 更详细：

## Java 7 及之前版本：

`java.util.Calendar`除了其他一些功能之外，您还可以期待所有功能：

```
import com.ibm.icu.util.Calendar;
import com.ibm.icu.util.ULocale;

...

ULocale locale = new ULocale("fa_IR@calendar=persian");
Calendar persianCalendar = Calendar.getInstance(locale);
persianCalendar.clear();
persianCalendar.set(1395, 3, 10); // Tir(4th month) 10th 1395 equivalent to June 30th 2016 

java.util.Date gregorianDate = persianCalendar.getTime();
System.out.println(gregorianDate); // Thu Jun 30 00:00:00 IDT 2016

// Gregorian to Persian
java.util.Calendar gregorianCal = java.util.GregorianCalendar.getInstance();
gregorianCal.set(2016, java.util.Calendar.JUNE, 30);

persianCalendar.setTime(gregorianCal.getTime());
System.out.println(persianCalendar.get(Calendar.YEAR));         // 1395
System.out.println(persianCalendar.get(Calendar.MONTH));        // 3
System.out.println(persianCalendar.get(Calendar.DAY_OF_MONTH)); // 10 
```

**警告**：请注意，基于 Java 日历的月份字段为零，因此`calendar.set(1395, 3, 10)`日历将表示 1395 年的第 4 个月，而不是第 3 个月！

如果您需要波斯语文本输出：

```
import com.ibm.icu.text.DateFormat;
import com.ibm.icu.text.SimpleDateFormat;

...

// full date output in persian
DateFormat df = DateFormat.getDateInstance(DateFormat.FULL, locale);
System.out.println(df.format(persianCalendar.getTime()));

// year output in persian
SimpleDateFormat sdf1 = new SimpleDateFormat(SimpleDateFormat.YEAR, locale);
System.out.println(sdf1.format(persianCalendar.getTime()));

// month name output in persian
SimpleDateFormat sdf2 = new SimpleDateFormat(SimpleDateFormat.MONTH, locale);
System.out.println(sdf2.format(persianCalendar.getTime()));

// weekday name output in persian
SimpleDateFormat sdf3 = new SimpleDateFormat(SimpleDateFormat.WEEKDAY, locale);
System.out.println(sdf3.format(persianCalendar.getTime()));

// full date output in YY/MM/dd form
SimpleDateFormat sdf4 = new SimpleDateFormat("YY/MM/dd", locale);
System.out.println(sdf4.format(persianCalendar.getTime())); 
```

输出：

```
ه‍.ش. ۱۳۹۵ تیر ۱۰, پنجشنبه  
۱۳۹۵  
تیر  
پنجشنبه
۹۵/۰۴/۱۰ 
```

如果您需要输出为英文，请更改`new ULocale("fa_IR@calendar=persian")`为`new ULocale("en@calendar=persian")`.

输出：

```
AP 1395 Tir 10, Thu
1395
Tir
Thu
95/04/10 
```

其他好东西：

```
// Get number of days in month
System.out.println(persianCalendar.getActualMaximum(Calendar.DAY_OF_MONTH)); // 31

// Get first day of week
System.out.println(persianCalendar.getFirstDayOfWeek()); // 7 (Saturday according to docs)

// Add some amount of time
persianCalendar.add(Calendar.MONTH, 2);
System.out.println(persianCalendar.get(Calendar.YEAR));         //1395
System.out.println(persianCalendar.get(Calendar.MONTH));        // 5
System.out.println(persianCalendar.get(Calendar.DAY_OF_MONTH)); // 10 
```

有关其他功能，请参阅[icu4j 演示](http://demo.icu-project.org/icu4jweb "icu4j 演示")，特别是：

*   [各种日历字段的演示](http://demo.icu-project.org/icu4jweb/flexTest.jsp?_=fa_IR)
*   当年[的周二和周四列表](http://demo.icu-project.org/icu4jweb/tuthu.jsp?_=fa-IR)
*   [将数字转换为文本表示的演示](http://demo.icu-project.org/icu4jweb/numero.jsp)（`fa_IR`用于区域设置）

另请参阅[日历](http://icu-project.org/apiref/icu4j/com/ibm/icu/util/Calendar.html)和[PersianCalendar](http://icu-project.org/apiref/icu4j/com/ibm/icu/util/PersianCalendar.html) API。

## Java 8 以后：

为了使用or之`java.time`类的类，您可以简单地使用此方法将波斯日期转换为首选类：`ZonedDateTime``LocalDateTime`

```
import java.time.Instant;
import java.time.LocalDateTime;
import java.time.ZoneId;
import java.time.ZonedDateTime;
import com.ibm.icu.util.Calendar;
import com.ibm.icu.util.ULocale;

...

public static LocalDateTime fromPersianDateToLocalDateTime(int year, int month, int day, int hour, int minutes, int seconds) {
    return fromPersianDateToZonedDateTime(year, month, day, hour, minutes, seconds).toLocalDateTime();
}

public static ZonedDateTime fromPersianDateToZonedDateTime(int year, int month, int day, int hour, int minutes, int seconds) {
    return toZonedDateTime(fromPersianDate(year, month, day, hour, minutes, seconds));
}

public static long fromPersianDate(int year, int month, int day, int hour, int minutes, int seconds) {
    Calendar persianCalendar = Calendar.getInstance(new ULocale("fa_IR@calendar=persian"));
    persianCalendar.clear();
    persianCalendar.set(year, month, day, hour, minutes, seconds);
    return persianCalendar.getTimeInMillis();
}

public static ZonedDateTime toZonedDateTime(Long epochMilli) {
    if(epochMilli == null) return null;
    return Instant.ofEpochMilli(epochMilli).atZone(ZoneId.of("Asia/Tehran"));
} 
```

* * *

## 关于罐子大小的备注

如果您担心 icu4j 的 jar 大小，那么您可以重建它并使用 Calendar 模块 (2,176KB)。更多信息：[版本。57 或更早版本](http://userguide.icu-project.org/packaging-icu4j)，版本[。58 或更高版本](http://userguide.icu-project.org/icudata)使用[ICU 数据构建工具](https://github.com/unicode-org/icu/blob/master/docs/userguide/icu_data/buildtool.md)。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-01-19T23:55:11.667

这种方法非常精确，也支持闰年

解释：

第 1 步：今天的时间包含当前时间

第 2 步：为 gregorian 和 jalali 日创建两个数组（g_days_in_month&j_days_in_month）

第 3 步：为日历 (gy,gm,gd) 和变量 g_day_no 之间的保留时间差异创建变量，用于年的天数。

第 4 步：插入月份中的某天并按天收集。

第 5 步：将年数转换为 jalili 年 (jy)

最后：从天数设置 jalali 月份，从 jalali 月份数组中设置 jalali 日。

祝你好运。

```
 Time today = new Time(Time.getCurrentTimezone());
    today.setToNow();
    int Day = (today.monthDay);             // Day of the month (0-31)
    int Month = (today.month);              // Month (0-11)
    int Year = (today.year);                // Year

    String persianDate = GregorianToJalali(Year, Month+1, Day);

  private String GregorianToJalali(int g_y, int g_m, int g_d)
{

  int[] g_days_in_month = {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
  int[] j_days_in_month = {31, 31, 31, 31, 31, 31, 30, 30, 30, 30, 30, 29};

    int gy = g_y-1600;
    int gm = g_m-1;
    int gd = g_d-1;

        int g_day_no = 365*gy+div(gy+3,4)-div(gy+99,100)+div(gy+399,400);

        for (int i=0; i < gm; ++i)
          g_day_no += g_days_in_month[i];
        if (gm>1 && ((gy%4==0 && gy%100!=0) || (gy%400==0)))
         // leap and after Feb 
          g_day_no++;
        g_day_no += gd;

       int j_day_no = g_day_no-79;

        int j_np = div(j_day_no, 12053); //12053 = 365*33 + 32/4 
        j_day_no = j_day_no % 12053;

        int jy = 979+33*j_np+4*div(j_day_no,1461); // 1461 = 365*4 + 4/4 

        j_day_no %= 1461;

        if (j_day_no >= 366) {
          jy += div(j_day_no-1, 365);
          j_day_no = (j_day_no-1)%365;
        }

        int j;
        for (j=0; j < 11 && j_day_no >= j_days_in_month[j]; ++j)
          j_day_no -= j_days_in_month[j];
       int jm = j+1;
       int jd = j_day_no+1;

        String Result= jy+"/"+jm+"/"+jd;

        return (Result);
     }  

  private int div(float a, float b)
  {  
      return (int)(a/b); 
  } 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-10-26T14:38:35.863

我的库[Time4A](https://github.com/MenoData/Time4A)（Time4J 的 Android 改编版）的最新版本 v3.10-2015g 包含对 Jalali 日历的支持。该库部署了[Borkowski](http://www.astro.uni.torun.pl/~kb/Papers/EMP/PersianC-EMP.htm)的算法（有效期至公历 2129 年）。实际上，波斯语月份和时代支持大约 25 种语言（包括波斯语和普什图语，基于 CLDR-28）。

**使用示例：**

```
// current date
PersianCalendar jalali = SystemClock.inLocalView().now(PersianCalendar.axis());
System.out.println(jalali); // AP-1394-08-04

// tomorrow
jalali = jalali.plus(CalendarDays.ONE);
System.out.println(jalali); // AP-1394-08-05

// localized format of tomorrow (English and Farsi)
ChronoFormatter<PersianCalendar> f =
    ChronoFormatter.ofStyle(DisplayMode.FULL, Locale.ENGLISH, PersianCalendar.axis());
Locale farsi = new Locale("fa");
System.out.println(f.format(jalali)); // Tuesday, Aban 5, 1394 AP
System.out.println(f.with(farsi).format(jalali)); // سه‌شنبه, آبان 5, 1394 ه‍.ش.

// shift back to month Farvardin and format the result
jalali = jalali.with(PersianCalendar.MONTH_OF_YEAR, PersianMonth.FARVARDIN);
System.out.println(f.format(jalali)); // Wednesday, Farvardin 5, 1394 AP
System.out.println(f.with(farsi).format(jalali)); // چهارشنبه, فروردین 5, 1394 ه‍.ش.

// conversion to gregorian date
System.out.println(jalali); // AP-1394-01-05
System.out.println(jalali.transform(PlainDate.class)); // 2015-03-25

// create new year in persian calendar and show gregorian counter part
jalali = PersianCalendar.of(1394, PersianMonth.FARVARDIN, 1);
System.out.println(jalali.transform(PlainDate.class)); // 2015-03-21

// create new year in gregorian calendar and show persian counter part
PlainDate gregorianDate = PlainDate.of(2015, Month.JANUARY, 1);
System.out.println(gregorianDate.transform(PersianCalendar.class)); // AP-1393-10-11

// delta between gregorian new year and persian new year
System.out.println(CalendarDays.between(gregorianDate, jalali).getAmount()); // 79 
```

**在 Android 上与 java.util.Date 的互操作性**

由于 Time4A 管理自己的一组不可变类型并且不基于 Android 的主要时间类型，因此我展示了以下桥：

```
// Time4A => Android
PlainDate gdate = jalali.transform(PlainDate.class);
Moment m1 = gdate.atStartOfDay().inTimezone(ASIA.TEHRAN);
java.util.Date jud = TemporalType.JAVA_UTIL_DATE.from(m1);

// Android => Time4A
java.util.Date input = new java.util.Date();
Moment m2 = TemporalType.JAVA_UTIL_DATE.translate(input);
jalali = m2.toZonalTimestamp(ASIA.TEHRAN).toDate().transform(PersianCalendar.class); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-10-14T13:20:07.093

尝试这个

```
import java.util.Calendar;
import java.util.Date;
public class PersianCalendar {

String[] weekDayNames = {
        "شنبه","یکشنبه","دوشنبه",
        "سه شنبه", "چهارشنبه",
        "پنج شنبه", "جمعه"
};
String[] monthNames ={
        "فروردین","اردیبهشت","خرداد","تیر", "مرداد","شهریور",
         "مهر", "آبان", "آذر","دی", "بهمن","اسفند"
};   
String strWeekDay = "";
String strMonth = "";    
int day;
int month;
int year;    
int ld;     
Calendar calendar = Calendar.getInstance();      
int gregorianYear =calendar.get(Calendar.YEAR);
int gregorianMonth = calendar.get(Calendar.MONTH)+1;
int gregorianDate = calendar.get(Calendar.DATE);
int WeekDay = calendar.get(Calendar.DAY_OF_WEEK);

int[] buf1 = {0,31,59,90,120,151,181,212,243,273,304,334};
int[] buf2 = {0,31,60, 91,121,152,182, 213, 244, 274,305,335};

public PersianCalendar(){
    Date gregorianDate = new Date();
    calendar.setTime(gregorianDate);
    toPersian(gregorianDate);
}

public PersianCalendar(Date gregorianDate){
    calendar.setTime(gregorianDate);
    toPersian(gregorianDate);
}    

private void toPersian(Date gregorianDate) 
{
    if ((gregorianYear % 4) != 0) 
        func1();
    else 
        func2();
    strMonth = monthNames[month-1];
    strWeekDay = weekDayNames[WeekDay];
}

private void func1()
{
    day = buf1[gregorianMonth - 1] + gregorianDate;
    if (day > 79){
        day = day - 79;
        if (day <= 186) {               
            int day2 = day;
            month = (day2 / 31) + 1;
            day = (day2 % 31);
            if(day2 % 31 == 0){
                 month--;
                 day = 31;
            }                
            year = gregorianYear - 621;
        } 
        else {
            int day2 = day - 186;
            month = (day2 / 30) + 7;
            day = (day2 % 30);
            if(day2 % 30 == 0){
                month = (day2 / 30) + 6;
                day = 30;
            }
            year = gregorianYear - 621;
        }
    } 
    else{            
        ld = gregorianYear > 1996 && gregorianYear % 4 == 1 ? 11 : 10 ;            
        int day2 = day + ld;
        month = (day2 / 30) + 10;
        day = (day2 % 30);            
        if(day2 % 30 == 0)            {
            month--;
            day = 30;
        }
        year = gregorianYear - 622;
    }
}

private void func2()
{
    day = buf2[gregorianMonth - 1] + gregorianDate;     
    ld = gregorianYear >= 1996 ? 79 : 80 ;        
    if (day > ld) {
        day = day - ld;
        if (day <= 186) {
            int day2 = day;
            month = (day2 / 31) + 1;
            day = (day2 % 31);
            if(day2 % 31 == 0){
                month--;
                day = 31;
            }
            year = gregorianYear - 621;
        } else {
            int day2 = day - 186; 
            month = (day2 / 30) + 7;
            day = (day2 % 30);
            if(day2 % 30 == 0 ){
                month--;
                day = 30;
            }
            year = gregorianYear - 621;
        }
    }
    else {
        int day2 = day + 10;
        month = (day2 / 30) + 10;
        day = (day2 % 30);
        if(day2 % 30==0){
            month--;
            day = 30;
        }
        year = gregorianYear - 622;
    }
  }
} 
```

创建实例

```
PersianCalendar sc = new PersianCalendar();            
String s= sc.strWeekDay  + " " +sc.day  + " " + 
     sc.strMonth + " " + sc.year;
System.out.print(s);
//setTitle(s); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-12-11T00:26:37.710

有一个包含双向DateConverter 的[persianutils项目；](https://github.com/bahmanm/persianutils)公历 <-> 波斯语 (Jalali)。它是用 Scala 编写的，所以我想在 Java 项目中使用它会很容易。

所使用的算法适用于高达 ~3790 的公历年和高达 ~3170 的波斯年。

免责声明：我是 PersianUtils 的作者

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-06-03T21:42:16.727

像这样创建calculateJalaliDate作为函数；然后以字符串形式返回 Jalali 日期

```
public String calculateJalaliDate(){

    Calendar c = Calendar.getInstance();
    String jalaliDate,JalaliMonth;
    int jalaliYear,jalaliMonth,calculateMonth,jalaliDay=0,allDays=0;
    int day=c.get(Calendar.DAY_OF_MONTH);
    int month=c.get(Calendar.MONTH)+1;
    int year=c.get(Calendar.YEAR);

    switch (month){
        case 1: allDays=year*365+31+day;break;
        case 2: allDays=year*365+(31+28)+day;break;
        case 3: allDays=year*365+(31+28+31)+day;break;
        case 4: allDays=year*365+(31+28+31+30)+day;break;
        case 5: allDays=year*365+(31+28+31+30+31)+day;break;
        case 6: allDays=year*365+(31+28+31+30+31+30)+day;break;
        case 7: allDays=year*365+(31+28+31+30+31+30+31)+day;break;
        case 8: allDays=year*365+(31+28+31+30+31+30+31+31)+day;break;
        case 9: allDays=year*365+(31+28+31+30+31+30+31+31+30)+day;break;
        case 10: allDays=year*365+(31+28+31+30+31+30+31+31+30+31)+day;break;
        case 11: allDays=year*365+(31+28+31+30+31+30+31+31+30+31+30)+day;break;
        case 12: allDays=year*365+(31+28+31+30+31+30+31+31+30+31+30+31)+day;break;
    }

    //226899
    jalaliYear=( allDays - 227139 )/365+1;
    calculateMonth=( allDays - 227139 )%365;
    if(calculateMonth<32)jalaliMonth=1;
    else if((calculateMonth-31)<32){jalaliMonth=2;jalaliDay=calculateMonth-31;}
    else if((calculateMonth-62)<32){jalaliMonth=3;jalaliDay=calculateMonth-62;}
    else if((calculateMonth-93)<32){jalaliMonth=4;jalaliDay=calculateMonth-93;}
    else if((calculateMonth-124)<32){jalaliMonth=5;jalaliDay=calculateMonth-124;}
    else if((calculateMonth-155)<32){jalaliMonth=6;jalaliDay=calculateMonth-155;}
    else if((calculateMonth-186)<31){jalaliMonth=7;jalaliDay=calculateMonth-186;}
    else if((calculateMonth-216)<31){jalaliMonth=8;jalaliDay=calculateMonth-216;}
    else if((calculateMonth-246)<31){jalaliMonth=9;jalaliDay=calculateMonth-246;}
    else if((calculateMonth-276)<31){jalaliMonth=10;jalaliDay=calculateMonth-276;}
    else if((calculateMonth-306)<31){jalaliMonth=11;jalaliDay=calculateMonth-306;}
    else {
        jalaliMonth=12;
        if((jalaliYear%4)==0)jalaliDay=calculateMonth-336;
        else jalaliDay=calculateMonth-335;
    }

    /*switch (jalaliMonth){
        case 1:JalaliMonth="فروردین"; break;
        case 2:JalaliMonth="اردیبهشت"; break;
        case 3:JalaliMonth="خرداد"; break;
        case 4:JalaliMonth="تیر"; break;
        case 5:JalaliMonth="مرداد"; break;
        case 6:JalaliMonth="شهریور"; break;
        case 7:JalaliMonth="مهر"; break;
        case 8:JalaliMonth="آبان"; break;
        case 9:JalaliMonth="آذر"; break;
        case 10:JalaliMonth="دی"; break;
        case 11:JalaliMonth="بهمن"; break;
        case 12:JalaliMonth="اسفند"; break;
    }*/

    jalaliDate=String.valueOf(jalaliYear)+"/"+String.valueOf(jalaliMonth)+"/"+String.valueOf(jalaliDay);
    return jalaliDate;
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-07-05T00:14:44.813

您可以将这个稳定且经过测试的库与格式化程序类[Roozh for Java 一起使用](https://github.com/meNESS/Roozh)。它没有被弃用，并且总是使用波斯日期时间所需的酷功能进行更新。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-08-22T03:31:51.897

我已经开发了带有回历 - gerogian- shamsi 事件视图的 Android Shamsi datepicker 小部件： [https ://github.com/irshst/ir.shes.calendar](https://github.com/irshst/ir.shes.calendar)[![Android Shamsi 日期选择器小部件](../Images/e4d0affefa7f917a92a799f7c03c7839.png)](https://i.stack.imgur.com/hgRV1.png)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-12-03T07:56:51.817

除了Time4A、icu4j这些太重的库，我写了一个类来准确处理波斯日历，你可以在这里找到它： [https ://github.com/hadilq/java-persian-calendar/blob/master/persian/src /main/java/ir/hadilq/PersianCalendar.java](https://github.com/hadilq/java-persian-calendar/blob/master/persian/src/main/java/ir/hadilq/PersianCalendar.java)

正如您在其测试中发现的那样，此类支持从回历之前的 3000 年到回历之后的 3000 年。

# ruby-on-rails - Rails - 启动服务器后忽略 ctrl-c

> ID：10378768
> 
> 赞同：0
> 
> 时间：2012-04-30T05:09:02.167
> 
> 标签：ruby-on-rails, command-prompt

我在 Win7 上有 Ruby v1.9.3 和 Rails v3.2.3。我生成 Rails 目录和启动 Ruby 服务器没有问题，但是一旦服务器启动，我没有提示，而且我键入的代码似乎也没有执行。

具体来说 - 这是来自会话的终端代码：

```
 => Booting WEBrick
 => Rails 3.2.3 application starting in development on http://0.0.0.0:3000
 => Call with -d to detach
 => Ctrl-C to shutdown server
 [2012-04-30 06:25:06] INFO  WEBrick 1.3.1
 [2012-04-30 06:25:06] INFO  ruby 1.9.3 (2012-02-16) [i386-mingw32]
 [2012-04-30 06:25:06] INFO  WEBrick::HTTPServer#start: pid=2112 port=3000 
```

在这一点之后，没有提示，我输入的任何命令似乎都不会产生结果（包括 ctrl-c）。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T06:14:05.070

这很有效：我在做一个 Rails 教程，这让我回到了正轨。Ctrl-Pause/Break 停止了服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T01:18:04.490

Ctrl-Pause/Break 有效。“暂停/休息”让我有点困惑，所以如果你像我一样是新手，通常是 F12 旁边的键，上面写着“暂停休息”。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T05:47:11.777

我假设你正在跑到`rails server`这一点。

一切正常。Rails 是一个 Web 框架，当您在服务器模式下运行它时，它不接受来自终端的命令。相反，Rails 在端口 3000 上侦听 Web 请求并做出适当的响应。当服务器运行时，终端窗口显示内部服务器日志。在服务器运行时访问[http://localhost:3000](http://localhost:3000)，你就会明白我的意思了。

如果您想要一些命令行交互性，请`rails console`改为运行。这将加载您的 Rails 环境，但不会在端口上侦听 Web 请求，而是会为您提供一个 irb 提示，您可以在其中键入 ruby​​。

# agda - 在 Windows 7 上安装 Agda

> ID：10378777
> 
> 赞同：6
> 
> 时间：2012-04-30T05:10:04.220
> 
> 标签：agda

我在 Windows 7 64 位电脑上运行 Agda 时遇到问题。我尝试运行以下命令：

```
cabal install agda 
```

和

```
cabal install agda-executable 
```

两者都有效，但我似乎仍然无法使用 emacs，有人可以帮助我吗？我已经尝试过[这里](http://agda.cvs.gr.jp/agda/Agda-setup-2.2.6.exe)的一键安装程序，但它似乎不起作用，我遇到了这个投诉：

```
C:\agda2\bin\agda2-install.cmd failed.
Code = 1
Incorrect Function
Setup was not completed.

Please correct the problem and run setup again 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T17:03:22.657

1.  `Install Agda (cabal install agda agda-executable),`确保`agda-mode.exe`在搜索路径上。这是必需的，因为安装程序会将 (shell-command-to-string " `agda-mode.exe locate"`) 之类的内容放入 .emacs 文件。
2.  运行“agda 模式设置”。
3.  我的 Emacs bin 目录也在搜索路径上，但我不确定它是否需要。无论如何，如果您做错了什么，您将收到错误消息。
4.  您还需要 Haskell 模式 ( `can be obtained from here https://github.com/haskell/haskell-mode`)，并且必须将 ( `load "c:\\haskell\\dev\\haskell-mode\\haskell-site-file.el"`) 添加到您的 .emacs 文件中。我在 Agda 之前加载它，我真的不知道加载顺序是否重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:12:11.243

我有 GHC 7.0.4（使用 Haskell 平台 2011.4.0.0），我可以在 Win7 64b 中安装 Agda 2.3.0 安装程序而不会出现问题。

如果你有 GHC 7.4，你应该试试 Agda 2.3.0.1

# bash - Zenity 不会取消或显示消息，因为它看不到变量

> ID：10378778
> 
> 赞同：1
> 
> 时间：2012-04-30T05:10:08.383
> 
> 标签：bash, variables, wget, zenity

我写了一个简单的脚本来 wget 和 zenity 取消：

```
#!/bin/bash
((
   wget http://d3qnbzt7ix5jlv.cloudfront.net/ubuntu-12.04-desktop-i386.iso & export PID=$$
   wait $PID
   export YES=$?
)&) | zenity --progress --pulsate --auto-close
if [ $? -eq 1 ]; then
  kill $PID
fi
if [ "$YES" = "0" ]; then
   zenity --info
elif [ "$YES" = "1" ]; then
   zenity --error
fi 
```

kill 看不到进程$PID。Zenity 不显示最终窗口 ($YES)。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-28T15:04:02.597

这不完全是一个答案，但评论会使代码片段乱码：

* * *

`/usr/bin/userinstall-wget`：

```
#!/bin/sh
# a wget wrapper to get these under a separate shell *and* progname

[ -n "$1" -a -n "$2" ] || exit 1

LANG=C \
wget -O "$1" --content-disposition --progress=bar:force:noscroll "$2" 2>&1 \
| stdbuf -i0 -o0 -e0 tr '>' '\n' \
| stdbuf -i0 -o0 -e0 sed -rn 's/^.*\<([0-9]+)%\[.*$/\1/p' 
```

* * *

```
# NB: those coughing at this particular killall are welcome with patches
download() {
        userinstall-wget "$outfile" "$url" | (
                trap 'killall userinstall-wget' HUP
                zenity --progress --time-remaining --auto-close --auto-kill \
                        --text="Wait please..." \
                        --title="Downloading file"
        )
} 
```

* * *

这些已作为 ALT Linux 的 userinstall 包装脚本的一部分组合在一起。

高温高压

PS：`--progress=bar:force:noscroll`使用较旧的 wget丢弃

# matlab - 在 Matlab 中检查黑色像素

> ID：10378781
> 
> 赞同：0
> 
> 时间：2012-04-30T05:10:21.837
> 
> 标签：matlab

我有一个图像 (5x5) 像素，其中 3 个值分别为 0、128 和 255。

我想检查索引（1,1）到（1,5）的像素。

如果存在像素值 0（黑色），则索引 (1,1) 到 (1,5) 的像素更改为 128（灰色），如果没有，则将像素更改为 255（白色）。

我想再次执行这些步骤，检查索引（2,1）到（2,5），（3,1）到（3,5），一直到底部。

从上述问题中，我得到了这样的解决方案：

掩码 = repmat(any(I == 0,2),5,1);

我（掩码）= 128；

我（〜掩码）= 255；

但如果我想检查...

如果有像素值 0（黑色）>3，则索引 (1,1) 到 (1,5) 的像素更改为 128（灰色），如果有像素值 0（黑色）<=3 或没有黑色像素，则像素更改为 255（白色）。

有什么解决办法？

谢谢你

问候， Wahyu

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T05:47:39.920

尝试计算矩阵每一行的直方图，然后读取直方图值为零：

```
x = m[1,:];
[counts, bins] = hist(x, unique(x));
[diff, pos] = min(abs(bins - 0));  % replace zero with the value you want to search for
if counts(pos) > 3
    z = 128
else
    z = 255
end
m[1,:] = z * ones(1, size(m)(2)); 
```

我被[这个页面](http://www.mathworks.com/support/solutions/en/data/1-1VV1U8/index.html?product=ML&solution=1-1VV1U8)启发了这个解决方案。

# javascript - IE9 中的 jQuery 和 Knockout

> ID：10378785
> 
> 赞同：0
> 
> 时间：2012-04-30T05:10:59.200
> 
> 标签：javascript, jquery, html, knockout.js

当元素包含带有敲除绑定的内容时，我在使用 jQuery 显示/隐藏元素时遇到问题。如果我尝试在同一页面上显示/隐藏不包含任何绑定的元素，它可以正常工作。这是它的外观：

![在此处输入图像描述](../Images/a9728daf078cbfdef06cf4138d52e131.png)

此问题仅发生在 IE9 中，当我“选择”某些内容或单击页面时，内容会重新呈现。要知道的一件事是，如果我将 IE9 置于兼容模式，则效果很好。

有任何想法吗？

编辑：

我找到了一种似乎在 IE9 中有效的解决方法。

出现问题时，我的代码如下所示：

```
<div id="yada">
  Yayda yada with Knockout-bindings.
</div>
 Total kostnad: <span data-bind="text:$root.totalSum"></span> kr 
```

只是用 jQuery 隐藏#yada div 会导致我描述的问题，但是将文本包装在 div 中解决了这个问题。

```
<div id="yada">
  Yayda yada with Knockout-bindings.
</div>
 <div>
 Total kostnad: <span data-bind="text:$root.totalSum"></span> kr
 </div> 
```

只是想让大家知道。

# android - 从 Django 服务器返回有效 JSON 的 Android 客户端错误

> ID：10378787
> 
> 赞同：0
> 
> 时间：2012-04-30T05:11:11.170
> 
> 标签：android, django, json

我希望有人可以帮助我。

我有一个将 JSON 返回到 iOS 应用程序的 Django 服务器。在 Django 服务器上，我们正在使用

```
return HttpResponse(json.dumps(session_dict),mime_type) 
```

将 JSON 作为（通过 Wireshark）返回给客户端

2f {“会话”：“bcb493fb21ae8fcd9152e1924b3e5d9a”} 0

这个响应对能够被 iOS JSON 客户端库解析的 iOS 应用程序是有效的。这对我来说看起来不像是有效的 Json，所以我很惊讶它可以工作。

但是，如果我在 Android 中使用以下内容，则会收到错误消息：

java.lang.String 类型的值会话无法转换为 JSONObject。

```
jsonObjSend.put("username", strUserName);
                jsonObjSend.put("password", strPassword);

                 Add a nested JSONObject (e.g. for header information)
                JSONObject header = new JSONObject();
                header.put("deviceType","Android"); // Device type
                header.put("deviceVersion","2.0"); // Device OS version
                header.put("language", "es-es");
                jsonObjSend.put("header", header);

                // Output the JSON object we're sending to Logcat:
                Log.i(TAG, jsonObjSend.toString(2));

            } catch (JSONException e) {
                e.printStackTrace();
            }

            try {
                // Send the HttpPostRequest and receive a JSONObject in return
                JSONObject jsonObjRecv = HttpClient.SendHttpPost(URL, jsonObjSend);
                String sessionId = jsonObjRecv.getString("session"); 
```

有什么建议么？

谢谢，

格雷格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T06:03:43.947

google 的 GSON 可能是更好的选择，您可以直接将实例转换为 json 字符串，例如

```
User user =new User("tom","12");
Gson gson =new Gson();
json=gson.toJson(user); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:41:56.840

您的 HttpClient.sendHttpPost 方法是否返回 JSONObject？不确定它是否会自动将来自 HTTP POST 的响应正文解析为 JSONObject。如果没有，那么您将不得不使用[JSONTokener](http://developer.android.com/reference/org/json/JSONTokener.html)或使用像 Gson 这样的库。

# c++ - 使用时钟计算时间的值为零 - linux

> ID：10378801
> 
> 赞同：1
> 
> 时间：2012-04-30T05:12:56.717
> 
> 标签：c++, c, linux, time, cuda

我有一个在 GPU 上执行计算的 cuda 代码。我正在使用时钟（）；找出时间

我的代码结构是

```
__global__ static void sum(){

// calculates sum 
}

extern "C"
int run_kernel(int array[],int nelements){
 clock_t start, end;
  start = clock();
  //perform operation on gpu - call sum
 end = clock();
 double elapsed_time = ((double) (end - start)) / CLOCKS_PER_SEC;
 printf("time required : %lf", elapsed_time);
} 
```

但时间总是 0.0000 我检查了打印开始和结束时间。开始有一些价值，但结束时间总是零。

知道可能是什么原因吗？测量时间的任何替代方法。

任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-30T06:19:39.567

这里有两个问题：

1.  该`clock()`函数的分辨率太低，无法测量您尝试计时的事件的持续时间
2.  CUDA 内核启动是一个异步操作，因此它几乎不消耗时间（在正常平台上通常为 10-20 微秒）。除非您使用同步 CUDA API 调用来强制主机 CPU 阻塞直到内核完成运行，否则您不会测量执行时间。

CUDA 有自己的高精度计时 API，它是在 GPU 上运行的计时操作的推荐方式。使用它的代码如下所示：

```
int run_kernel(int array[],int nelements){

    cudaEvent_t start,stop;
    cudaEventCreate(&start);
    cudaEventCreate(&stop);

    cudaEventRecord(start, 0);

    //
    //perform operation on gpu - call sum
    //

    cudaEventRecord(stop, 0); 
    cudaEventSynchronize(stop); 
    float elapsedTime; 
    cudaEventElapsedTime(&elapsedTime, start, stop); 
    printf("time required : %f", elapsed_time); 

    cudaEventDestroy(start);
    cudaEventDestroy(stop);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-30T06:17:02.277

不要`clock`用来计时 CUDA 内核启动。使用`cudaEventElapsedTime`. 即使`clock`足够高的精度来计时您的内核（不是），内核启动也是异步的，这意味着控制流在内核完成之前返回到您的调用函数。

就是这样：

```
void run_kernel(...)
{
  // create "events" which record the start & finish of the kernel of interest
  cudaEvent_t start, end;
  cudaEventCreate(&start);
  cudaEventCreate(&end):

  // record the start of the kernel
  cudaEventRecord(start);

  // perform operation on gpu - call sum
  sum<<<...>>>(...);

  // record the end of the kernel
  cudaEventRecord(end);

  // get elapsed time. Note that this call blocks
  // until the kernel is complete
  float ms;
  cudaEventElapsedTime(&ms, start, end);

  printf("time required : %f milliseconds", ms);

  cudaEventDestroy(start);
  cudaEventDestroy(end);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T06:11:41.123

我相信你现在应该使用[clock_gettime()](http://linux.die.net/man/3/clock_gettime)来`CLOCK_MONOTONIC`测量经过时间到高分辨率。在我的电脑上，分辨率是 1ns，这已经足够了。

你可以像这样使用它

```
#include <time.h>
...

struct timespec start, end, res;

clock_getres(CLOCK_MONOTONIC, &res);
/* exact format string depends on your system, on mine time_t is long */
printf("Resolution is %ld s, %ld ns\n" res.tv_sec, res.tv_nsec);

clock_gettime(CLOCK_MONOTONIC, &start);
/* whatever */
clock_gettime(CLOCK_MONOTONIC, &end); 
```

编译`-lrt`

*编辑：我看到我在这方面采取了错误的方法，如果你需要的话，显然你应该使用 CUDA 计时。我按照您对系统进行计时的问题的思路进行了操作。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T12:56:32.370

cuda 内核启动是异步的，因此您必须在内核之后添加 cudaThreadSynchronize()。

# java - 如何在 Java 中获取 170 万条记录？

> ID：10378803
> 
> 赞同：3
> 
> 时间：2012-04-30T05:13:19.503
> 
> 标签：java, mysql, linux, centos5

我正在使用 MySQL 数据库，其中一个表有 170 万条记录。通过 Java 中的 Restlet 框架，我想获取这些记录并将其返回给客户端。我使用的是远程服务器 Linux Centos。我已经创建了 WAR 文件并上传到服务器上。当我运行该服务时，需要花费大量时间来响应。我等了 40 分钟，但没有得到任何输出。那么有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T05:22:27.997

这可能行不通：在内存中保存这么多行数据可能会导致内存不足异常（您可以查看服务器上的日志并查看到底发生了什么吗？）。

要执行此类操作，您要么需要放弃该计划并进行某种分页，要么需要一个解决方案，让您将记录流式传输到客户端而不将它们保存在内存中。我不确定 Restlet 框架是否允许您这样做：您可能需要自己使用 servlet 来实现它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T07:15:01.030

当我有大量行时，我使用了内存映射文件。例如，我有一个数据库，我必须在大约一分钟内检索和处理 11 亿行。（超过 200 GB）

这是一种非常专业的方法，我怀疑有一种方法可以调整您的 SQL 数据库或使用 NoSQL 数据库来做您想做的事情。我会认为你可以在一分钟内检索 170 万，具体取决于你在做什么（例如，如果你在几个 TB 中选择这么多，这需要一段时间）

但是，如果真的没有其他选择，您可以编写自定义数据存储。

顺便说一句：只产生一个摘要。不应该期望任何人阅读那么多行，当然不会在浏览器中显示它们。也许您可以做一些事情来生成报告或摘要，以便发送给客户的时间更少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T09:01:55.483

我已经在我的应用程序中成功地完成了这种工作。如果您的客户准备好接受大响应，那么这种方法就没有错。要点是您需要流式传输响应，这意味着您不能将整个响应构建为字符串。获取 HTTP 响应的输出流，并将记录一一写入其中。在 db 端，您需要设置一个可滚动的结果集（在 JDBC 级别和 Hibernate 级别很容易做到）。

# javascript - 如何使下拉列表无法选择？

> ID：10378804
> 
> 赞同：4
> 
> 时间：2012-04-30T05:13:33.817
> 
> 标签：javascript, css, jsf

如何使`<h:selectOneMenu>`下拉列表无法选择？

这不像使用`disabled`. 我只想使下拉列表选项无法选择并以不同的（非活动）样式类出现。

我怎样才能做到这一点？通过 JSF 组件属性或 CSS 或 JavaScript？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-30T05:18:03.383

```
<asp:DropDownList ID="ddlName" runat="server" style="pointer-events: none; cursor: default;">
</asp:DropDownList> 
```

将`style`属性添加到`DropDownList`as `style="pointer-events: none; cursor: default;"`。这将成功，我已经尝试过了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T05:46:50.573

如果我理解正确，您需要做的就是使用该`disabled`属性。

所以，如果你有一个这样的选择标签：

```
<select>
  <option>Value</option>
  <option>Value</option>
  <option>Value</option>
</select> 
```

只需将其更改为：

```
<select disabled>
  <option>Value</option>
  <option>Value</option>
  <option>Value</option>
</select> 
```

一些文档类型要求所有属性都具有值，才能有效。在这种情况下，您可以`disabled="true"`改用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T06:11:22.317

根据[this answer](https://stackoverflow.com/a/602298/620338)，一些浏览器允许更改禁用组件的样式（非IE），一些不允许（IE）。然而，答案是 3 岁——对于浏览器来说是一段很长的时间。因此，您可以尝试以下解决方案：

```
<h:selectOneMenu disabled="true" style="..." ...> 
```

...并使用不同的浏览器检查结果。

或者使用以下`readonly`属性：

```
<h:selectOneMenu readonly="true" style="..." ...> 
```

# android - 无法将 Droid Incredible 2 安装到 Windows 7 PC

> ID：10378806
> 
> 赞同：0
> 
> 时间：2012-04-30T05:13:41.443
> 
> 标签：android, adb, mount

我一直在寻找过去 2 个小时，但无法弄清楚。

我刚刚用jquery mobile / phonegap开发了一个应用程序，下载了所有android sdk的东西，通过sdk下载了google usb驱动程序。

我已经尝试过无数次连接我的 Incredible 2，以便通过设备管理器安装 ADB，就像互联网上到处都在说的那样。但是当我去我的设备管理器时，没有什么说“其他设备”只是“未知设备”在usb端口下......

不确定，我几乎尝试了所有方法，包括修改 google usb inf 文件以添加对 Incredible 2 的支持，但连接后仍然没有运气。不确定我是否必须手动安装谷歌驱动程序或其他东西？我只是用sdk下载了它，还没有做更多的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T18:25:40.970

布雷登，

您需要从 HTC 下载 HTC Sync。链接是：[http](http://www.htc.com/www/help/htc-incredible-s/#download) ://www.htc.com/www/help/htc-incredible-s/#download 。我假设您使用的是 Windows PC，请务必进行完整安装。完成并将手机连接到 PC 后，您应该会看到它出现在 DDMS 的设备列表中。如果之后有问题请告诉我。

摇滚编码器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:16:39.410

请务必转到手机上的“设置”->“应用程序”并允许“未知来源”。

# c# - 使用 MSBuild 时更改路径的替代方法

> ID：10378809
> 
> 赞同：0
> 
> 时间：2012-04-30T05:14:24.137
> 
> 标签：c#, msbuild

我想使用 MSBuild 构建我的解决方案文件，但有一个问题。我的 MSBuild 文件位于`C:\WINDOWS\Microsoft.NET\Framework\v3.5\`. 所以现在只有当我在这个路径中有我的整个解决方案和项目文件时，我才能编译解决方案。但我不能一直将我所有的解决方案和项目文件保存在`C:\WINDOWS\Microsoft.NET\Framework\v3.5\`. 我的解决方案文件的位置可能在我的电脑或 TFS 中的任何位置，我必须使用 MSBuild 来编译它。

我在某个论坛上看到，我必须在 location 中更改 regedit 中的路径 `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSBuild\ToolsVersions\3.5`，但它仍然保持静态。如果我想执行 TFS 中的解决方案文件，那么我将不得不再次更改 regedit 中的路径。

有没有其他选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T06:00:34.877

我的系统上也有 msbuild.exe。这很好，因为这是 VS 的任务或构建工具来处理它。通常您会在路径环境中运行构建脚本`C:\WINDOWS\Microsoft.NET\Framework\v3.5\`，或者您的构建解决方案知道在哪里可以找到它。通常，只有当您重定向到不同的框架版本（例如 4.0）时，才需要更改 msbuild.exe。为了在干净的机器上构建，应正确设置先决条件。所以应该没有必要在你的存储库中包含 msbuild.exe。可能这会被认为是*不好的做法*。你有什么理由，为什么要对 msbuild.exe 进行版本控制？

# javascript - 进行ajax调用时如何正确处理链接上的href值？

> ID：10378812
> 
> 赞同：1
> 
> 时间：2012-04-30T05:15:09.697
> 
> 标签：javascript, ajax, onclick, href

为了快速解释，我页面上的所有链接目前都使用以下格式：

```
<a href="javascript:;" onclick="loadPageWithAjax();">Link</a> 
```

我想做的是将代码升级到以下内容：

```
<a href="actual/path/to/content" onclick="loadPageWithAjax();">Link</a> 
```

我的目标有两个：

1.  使状态栏显示链接指向的 URL
2.  允许用户复制链接位置并使其成为有效 URL

我的问题是这会忽略 onclick 并实际重定向到 URL。解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:55:15.890

如果您使用的是 jQuery，那么我建议您使用[History.js](https://github.com/balupton/History.js/)或[jQuery BBQ](http://benalman.com/projects/jquery-bbq-plugin/)。它们都为 HTML5 pushState 提供了良好的支持，并为 HTML4 浏览器提供了备用。使用 pushState，您将能够更新 URL（使其可收藏），并且您可以使用 statechange 事件来处理导航（例如当用户点击后退按钮时）。查看 History.js 的文档以了解其工作原理的一些示例。

更新：

根据您的评论，我建议为您希望通过 AJAX 请求处理的链接创建一个事件处理程序。

例如，假设您想成为 ajaxy 的所有链接都具有“ajaxify”类。

```
$(document).on("click", "a.ajaxify", function(e) {
    var url = $(this).attr("href");
    History.pushState({}, null, url);

    // do something, like make an ajax request to get the url

    e.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:17:11.957

在您的`loadPageWithAjax()`函数中，您需要能够获取浏览器自动调用的事件数据。

```
function loadPageWithAjax(e){
    e.preventDefault(); stops page from clicking
    //do your ajax stuff
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T05:49:50.873

`history.pushState`除非您使用 window.location.hash 或 new （仅适用于 HTML5 浏览器）使用哈希，否则您无法在不更改加载页面的情况下设置地址栏的 URL 。

# asp.net - 从 Web 服务器发送的电子邮件会导致 gmail 将其视为网络钓鱼。如何摆脱这个？

> ID：10378814
> 
> 赞同：3
> 
> 时间：2012-04-30T05:15:17.157
> 
> 标签：asp.net, email, gmail, phishing

我正在从我的 .net 应用程序发送帐户激活电子邮件。

我将发件人地址设置为“xyz.support@gmail.com”和名称“xyz”，其中xyz 是域的名称，即我们的网站。

当我们使用 Google 的 SMTP 服务器时这不是问题，因为我在发送过程中向 google 提供了凭据。但现在我使用自己的网络服务器的 SMTP 发送电子邮件。

当我在 gmail 中查看激活电子邮件时，我得到以下信息：

> **此邮件的发送者可能不是：xyz.support@gmail.com 了解更多 报告网络钓鱼**

有没有办法摆脱这种情况，使 gmail 和其他客户端不显示此消息？

这是代码：

```
var smtpClient = new SmtpClient();
var message = new MailMessage();

smtpClient.Host = _config.SMTPServer;
message.From = new MailAddress("xyz.support@gmail.com", "xyz");
message.To.Add("newuser@gmail.com");            

message.IsBodyHtml = true;
message.Subject = "Test subject";
message.Body = "Test Body";

smtpClient.Send(message); 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T05:21:15.497

FROM 地址的域必须与发送电子邮件的 SMTP 服务器的域相匹配，否则您的邮件将被视为垃圾邮件。

这解释了为什么您通过 Google 的 SMTP 服务器发送来避免“错误”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-11T22:01:29.730

[IrishChieftain](https://stackoverflow.com/questions/10378814/email-sent-from-web-server-causes-gmail-to-treat-as-phishing-how-to-get-rid-of#comment13379785_10378850)使用[SPF](http://en.wikipedia.org/wiki/Sender_Policy_Framework)的建议帮助了我，所以这里是我所做的步骤的总结：

**1.）**首先，我还在我的 GMail 收件箱中收到了从我的服务器发送的电子邮件，并且收到了*[“此邮件可能不是由...发送”警告](https://support.google.com/mail/troubleshooter/2411000)*。

**2.)**接下来，我查看了 GMail 中电子邮件的来源（单击邮件旁边的箭头并选择“显示原件”）。摘录如下：

> Received-SPF:**失败**（google.com: domain of **me@mydomain.com**未将**211.113.37.19**指定为允许的发件人）client-ip=211.113.37.19；

所以谷歌直接告诉我该怎么做：在我的域“mydomain.com”的DNS中添加一些SPF记录以摆脱这个警告。

**3.)**因此，我登录了我的 DNS 提供商的控制面板并添加了两条 TXT 记录，如下所示：

```
*.mydomain.com. 180 v=spf1 +a +mx ip4:211.113.37.19 -all
mydomain.com. 180 v=spf1 +a +mx ip4:211.113.37.19 -all 
```

请注意，我在*三个*单独的字段中输入了每一行：

*   一个领域`*.mydomain.com.`
*   一个字段`180`（TTL，在我的示例中为 3 分钟）
*   一个领域`v=spf1 +a +mx ip4:211.113.37.19 -all`

**4.)**在那之后，我等了一段时间并尝试重新发送。这成功了。谷歌现在在原版中显示：

> Received-SPF: **pass** (google.com: domain of Received-SPF: pass (google.com: domain of me@mydomain.com 指定 211.113.37.19 为允许的发件人) client-ip=211.113.37.19;

请注意，我选择了 SPF 版本，因为邮件服务器与 Web 服务器位于不同的机器上，因此我无法执行[Mulmot 所写的其他解决方案](https://stackoverflow.com/a/10378850/107625)。

Microsoft还提供了一个[SPF 向导](http://www.microsoft.com/mscorp/safety/content/technologies/senderid/wizard/default.aspx)来正确生成 SPF 记录。或者，这里[还有另一个 SPF 生成器](http://spf.dgrindle.com/)。

# svn - 使用 svn update 是否是登台服务器的好方法

> ID：10378820
> 
> 赞同：1
> 
> 时间：2012-04-30T05:16:45.503
> 
> 标签：svn

我有一个登台服务器，用于在更新生产之前测试功能。我不是每次都使用 svn export 来更新 svn 代码，而是使用 stage 作为 repo 的工作副本。现在每次我需要检查 repo 中提交的内容时，我都会在阶段运行 svn update，我准备好了。

我想知道这样做是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:34:21.943

如果没有其他人在使用舞台，那么它是有效的。否则，您应该首先将它放在开发测试服务器中。无论如何，自动部署然后自动测试是“正确的做法”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T07:40:06.463

这是[持续集成 (CI)](http://martinfowler.com/articles/continuousIntegration.html)中的最佳实践之一。为了获得关于代码更改是否引入任何错误的快速反馈，您可以快速更新持续集成服务器（称为“暂存服务器”）上的代码并运行一组简短的冒烟测试。这使人们可以快速查看（10-20 分钟）是否需要修复任何东西。

但是，另一个最佳实践是每天（通常在晚上）对代码库进行一次干净的检查，并运行更长的测试套件（功能测试、压力测试等）。它可以在相同或不同的 CI 服务器上完成。

重要的事情（正如@YusufX 提到的）这些事情**必须**自动完成。为此，您应该使用持续集成服务器。有几种可用。[就个人而言，我是Jenkins](http://jenkins-ci.org/)的忠实粉丝（它是免费和开源的）。

# xcode - Xcode (iOS) sigabrt 错误'无法在包中加载 NIB

> ID：10378822
> 
> 赞同：1
> 
> 时间：2012-04-30T05:16:59.633
> 
> 标签：xcode

我在我的应用程序项目中使用 Xcode 时遇到了困难，我构建了一个记忆游戏，它包含关卡，游戏在 10 级之前运行完美，之后我遇到了这个崩溃错误，当我尝试删除 10 级时，游戏是工作完美，但是当我再次玩游戏时，游戏在 2 级崩溃！（这意味着 Xcode 不能运行应用程序项目超过 9 或 10 级然后它会崩溃）..

这是我的代码：

```
-(void)delay2 {    
    level3  *second = [[level3 alloc] initWithNibName:@"level3" bundle:nil];

    [self presentModalViewController:second animated:YES];    
} 
```

这里是崩溃报告：

> **由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“无法在包中加载 NIB：“NSBundle（已加载）”，名称为“level3”**第一次抛出调用堆栈：**

我正在使用 Xcode 4.1

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T07:44:25.217

您需要将 xib 添加到您的项目构建阶段[此链接将是 hlpfull](http://codefriends.blogspot.in/2012/04/hi-i-faced-this-problem-and-want-to.html)

去构建阶段并添加xib。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:23:11.420

确保您的项目中有一个名为**level3的****.XIB**文件。还要确保针对此 XIB 检查 TargetMembership，以便在构建时对其进行编译。

# eclipse - 强制 Eclipse 单线程执行多线程 Java 程序

> ID：10378824
> 
> 赞同：0
> 
> 时间：2012-04-30T05:17:02.987
> 
> 标签：eclipse, multithreading

有没有办法强制 Eclipse 或 JVM 序列化多线程 Java 程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:26:32.993

除非你通过重写 Thread 类来做一些聪明的事情。

# php - PHP Session 仅在查看实际 index.php 时有效？

> ID：10378829
> 
> 赞同：0
> 
> 时间：2012-04-30T05:17:34.500
> 
> 标签：php, session

我正在开发一个使用 PHP 会话的站点，但 $_SESSION 数组仅在“/index.php”文件名存在时才起作用。“/”和“/index.php”指向同一个文件，但由于某种原因，PHP 会话仅在“/index.php”出现在 URL 地址中时才有效。我在网上搜索了为什么会这样，但没有找到答案。知道为什么会这样吗？

*注意：会话在本地主机上的“/”和“/index.php”上都有效，但在我的实际服务器上无效！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T06:15:45.843

你在看同一个域吗？我的网站遇到了这个问题 - 请注意 www.example.org 与 example.org 的域不同。

另外，请确保两个 URL 上的 PHPSESSID cookie 相同。如果不是，它正在加载不同的会话。

# android - 模拟器不启动活动

> ID：10378830
> 
> 赞同：3
> 
> 时间：2012-04-30T05:17:35.123
> 
> 标签：android, eclipse

根据控制台“[2012-04-29 12:34:58 - Emulator] NAND：nand_dev_load_disk_state，还原失败：所需大小（705531195755904229）超过设备限制（69206016）”

“[2012-04-29 12:34:58 - 模拟器] savevm：无法加载部分 nand_dev”

[2012-04-29 12:36:35 - 计算] emulator-5554 已断开连接！取消“my.calc.CalcActivity 活动启动”！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T05:24:34.620

如果需要，请关闭您的 Eclipse 和 AVD，使用不同的 API 创建新的 AVD，然后重新开始，一切都会好起来的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T05:31:49.723

打开 AVD 管理器并转到加载失败的 AVD。突出显示该 AVD 并选择“开始”按钮。您应该会看到一个对话框，允许您选择擦除用户数据。这应该会减少保存的磁盘缓存的大小，如果这是您的应用程序，您应该检查您保存到磁盘的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-09T18:53:08.477

我遇到了同样的问题，所以我发现模拟器的最低 API 级别低于我项目的最低 API 级别。所以我只是更改了项目的最低 API 级别，我可以毫无问题地运行它。或者您可以更改模拟器的最低 API 级别。我希望这可以帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-20T06:36:13.617

无需再次创建 AVD 无需再次关闭 eclipse。只需进入模拟器设置>应用程序并在您上次在模拟器上运行时卸载应用程序（或在模拟器卡住之后）。然后从 Eclipse 再次运行应用程序（可能您需要在卸载应用程序后取消模拟器），因为之后您卸载 eclipse 将再次将应用程序加载到模拟器。

# android - 如何从设备获取完整的错误日志

> ID：10378831
> 
> 赞同：-1
> 
> 时间：2012-04-30T05:17:45.030
> 
> 标签：android

当应用程序安装在任何用户的设备上时，如何获取应用程序崩溃的完整错误日志（强制关闭）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T06:23:55.343

您的应用在 Google Play 上吗？如果是这样，只需登录您的开发者帐户，Google 就会为您的应用收集堆栈跟踪，以便您诊断和修复应用中的常见崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:20:08.677

[在此处](https://play.google.com/store/apps/details?id=org.jtb.alogcat&hl=en)下载此应用程序以获取猫日志

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T05:34:29.123

我曾经创建了一个 Applocker 并从 logcat 中读取。

```
 private static final String LogCatCommand = "logcat";

    Process process;
    process = Runtime.getRuntime().exec(LogCatCommand);
    br = new BufferedReader(new InputStreamReader(process.getInputStream())); 
```

这是完整的[源代码](http://code.google.com/p/applocker/source/browse/trunk/AppLocker/src/com/gueei/applocker/DetectorService.java)。

您还需要`android.permission.READ_LOGS`许可。

# jquery - Jquery 弹跳和缩放动画

> ID：10378832
> 
> 赞同：2
> 
> 时间：2012-04-30T05:17:58.460
> 
> 标签：jquery, bounce, zooming

嘿，我在 jsfiddle 上有这段代码：http: [//jsfiddle.net/d7UjD/6/](http://jsfiddle.net/d7UjD/6/)

我有两个问题：

1）我需要一种使用动画 stop() 的方法，这样如果你在图像上快速运行鼠标很多次，它就不会继续播放和播放..

2）我需要家庭帮助来缩放宽度和高度的“缩放”部分。目前我只能做宽度。需要使其均匀缩小。

对此的任何帮助都会很棒！

大卫

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-30T05:46:51.573

animate.css .. 所有动画效果的最佳解决方案..

试试这个[http://daneden.me/animate/](http://daneden.me/animate/)

干杯...！！！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-30T05:42:59.050

可能可以以不同的方式完成，但这是一种方法..

1) 使用mouseleave 功能，在弹跳效果上停止动画。

2) 使用百分比 (%) 代替像素来实现缩放效果。

[http://jsfiddle.net/d7UjD/9/](http://jsfiddle.net/d7UjD/9/)

# java - 尝试在 for 循环中实例化对象并失败

> ID：10378838
> 
> 赞同：-1
> 
> 时间：2012-04-30T05:19:38.480
> 
> 标签：java, object, loops, for-loop

基本上，只要 continue 变量等于“Y”，我就会尝试创建一个新类。我遇到的问题是

```
DigitalMain.java:18: not a statement
    DigitalPhoto[] class = new DigitalPhoto[9]; 
```

编译时。我看过 ArrayLists 但我不太确定它们是否会以与我试图实现的相同的方式实例化类。在理想情况下，我将拥有名称为“class”+i 的对象，并通过其内置的 set 方法为每个对象提供不同的值。

```
// Import classes for class
import java.util.Arrays;
import java.util.List;
import javax.swing.*;
import java.awt.event.*;
import java.text.DecimalFormat;

public class DigitalMain
{
  public static void main(String args[])
  {
    String cont = "Y";
    String heightString,widthString,width,bitpsString;
    double bitps,x,y,totesPrice,totesSize,totesSpeed;
    DecimalFormat wholeDigits = new DecimalFormat("0");
    DecimalFormat dec = new DecimalFormat("0.00");

    DigitalPhoto[] picc = new DigitalPhoto[20];
    for(int i=0; cont.equals("Y") ; i++)
    {
    picc[i] = new DigitalPhoto();
    heightString = JOptionPane.showInputDialog("Please enter height");
    picc[i].setHeight = Double.parseDouble(heightString);
    heightString = JOptionPane.showInputDialog("Please enter width");
    picc[i].setWidth = Double.parseDouble(widthString);
    continueQuestion = JOptionPane.showInputDialog("Height: " + picc[i].getHeight + "\n Width: " + picc[i].getWidth + "\n Resolution: " + picc[i].getResolution + "\n Compression Ratio: " + picc[i].getCompression + "\n Required Storage: " + picc[i].calcStorage() + "\n Price of Scanned Photo: " + picc[i].getCost() + "Please enter 'Y' to try again or anything but 'Y' to accept values.");
    };

    do
    {
    bitpsString = JOptionPane.showInputDialog("Please enter your internet connection speed. Must be an integer between 1 and 99999999");
    bitps = Double.parseDouble(bitpsString);
    } while (bitps > 0 && bitps < 99999999);
    picc0.setSpeed(bitps);

    for(y = 0; y<picc.length; y++) {
      totesPrice += picc+y.getCost();
      totesSize += picc+y.calcStorage();
      totesSpeed = picc0.getSpeed();
    }

    double seconds = transferTime(totesSize, totesSpeed);
    double minutes = seconds / 60;
    double realsec = seconds % 60;

    JOptionPane.showMessageDialog(null, "You will be paying: " + totesPrice + "\nRequired Storage is: " + totesSize + "Required time for transfer is: " + wholeDigits.format(minutes) + " minutes, and " + wholeDigits.format(realsec) + " seconds.");

  }

  public static double transferTime(double totalStorage, double netSpeed) {
    double bits, seconds;
    bits = (totalStorage * 8);
    seconds = (bits / netSpeed);
    return seconds;
    };
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T05:21:48.870

`class`是一个关键字 - 您不能将其用作变量名。

此外，您在这里有一个奇怪的构造：

```
for(int i=0; cont.equals("Y") ; i++)
{
    ...
} while {continue.equalsIgnoreCase(Y)}; 
```

没有“for/while”循环之类的东西 - 有一个普通`for`循环、一个`while`循环和一个`do`/`while`循环。

所以你*实际上*有一个`for`循环，后面跟着一个无效`while`循环。它没有条件。

你需要弄清楚你想要什么。（可能是一个*包含*do/while 循环的 for 循环，尽管我会将内部循环提取到一个单独的方法中。通常，您的代码会从分解为多个方法中受益匪浅。

您稍后会执行类似的操作，尽管这次使用`do`/ `while`：

```
do
{
    ...
} while {bitps > 0 && bitps < 99999999}; 
```

`while`循环的条件放在圆括号*中*，而不是大括号中：

```
do
{
    ...
} while (bitps > 0 && bitps < 99999999); 
```

基本上，您应该阅读可用于循环的语法选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T05:24:37.463

问题很可能是您的阵列的名称。该词`class`是 Java 语言中的关键字，因此不能用于命名变量。你也可以`ArrayLists`像这样使用：

```
List<DigitalPhoto> photoes = new ArrayList<DigitalPhoto>(); 
do
    {
    DigitalPhoto photo = new DigitalPhoto();
    heightString = JOptionPane.showInputDialog('Please enter height');
    photo .setHeight = double.parseDouble(heightString);
    heightString = JOptionPane.showInputDialog('Please enter width');
    photo .setWidth = double.parseDouble(widthtString);
    photos.add(photo)
    continueQuestion = JOptionPane.showInputDialog('Height: ' + class[i].getHeight + '\n\lWidth: ' + class[i].getWidth + '\n\l Resolution: ' + class[i].getResolution + '\n\lCompression Ratio: ' + class[i].getCompression + '\n\lRequired Storage: ' + class[i].calcStorage() + '\n\lPrice of Scanned Photo: ' + class[i].getCost() + 'Please enter "Y" to try again or anything but "Y" to accept values.')
    } while {cont.equals("Y")}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T05:38:42.943

您正在使用什么样的循环。

```
for(...)
{
...
}while(); 
```

没有`for-while`循环。

而且你的`for`循环条件永远不会变成假的。为您的 for 循环设置适当的条件。您的循环
中也存在语法错误。`for-while`IE。最后声明

```
continueQuestion = JOptionPane.showInputDialog('Height: ' + class[i].getHeight + '\n\lWidth: ' + class[i].getWidth + '\n\l Resolution: ' + class[i].getResolution + '\n\lCompression Ratio: ' + class[i].getCompression + '\n\lRequired Storage: ' + class[i].calcStorage() + '\n\lPrice of Scanned Photo: ' + class[i].getCost() + 'Please enter "Y" to try again or anything but "Y" to accept values.') // you miss the ; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T05:43:49.933

[变量](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/variables.html)命名有一些规则

```
 You cannot use any of the following(in list of keywords) as identifiers in your
 programs.The keywords const and goto are reserved, even though they are not 
 currently used. true, false, and null might seem like keywords, but they 
 are actually literals;      you cannot use them as identifiers in your programs. 
```

[关键字列表](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/_keywords.html)

```
for(int i=0; cont.equals("Y") ; i++)
 {
   class[i] = new DigitalPhoto();
   heightString = JOptionPane.showInputDialog('Please enter height');
   class[i].setHeight = double.parseDouble(heightString);
   heightString = JOptionPane.showInputDialog('Please enter width');
   class[i].setWidth = double.parseDouble(widthtString);
   continueQuestion = JOptionPane.showInputDialog('Height: ' + 
   class[i].getHeight + '\n\lWidth: ' + class[i].getWidth + '\n\l Resolution: ' +
   class[i].getResolution + '\n\lCompression Ratio: ' +  class[i].getCompression +
  '\n\lRequired Storage: ' + class[i].calcStorage() + '\n\lPrice of Scanned Photo: ' + 
    class[i].getCost() + 'Please enter "Y" to 
   try again or anything but "Y" to accept values.')
} while {continue.equalsIgnoreCase(Y)}; 
```

在这里我不知道任何循环`for-while`..只需检查一些基础知识..
[java 中的循环](http://www.tutorialspoint.com/java/java_loop_control.htm)

# java - 如果父节点和子节点具有相同的名称，如何查找节点？

> ID：10378839
> 
> 赞同：3
> 
> 时间：2012-04-30T05:19:56.540
> 
> 标签：java, xml

我正在做一个项目，我必须在其中使用 java 操作 XML 文件。早些时候我通过使用节点名称来获取节点，即。`getElementsByTagName()`. 现在，当我有一个具有相同名称的父节点和子节点的 xml 文件时，就会出现问题。
我该如何区分它们。

这是我的 xml 文件的简短示例。

```
 <deviceparameters>
     <parameter>   // parent
        <name>ABC</name> 
        <parameter>Yes</parameter> // child with same name
        <value>20</value> 
     </parameter>
 </deviceparameters> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T05:24:08.307

从按名称查找开始`deviceparameters`，然后找到一个命名的孩子`parameter`，这是你的第一个孩子，然后`parameter`是那个孩子。Javadoc 将告诉您用于查找命名子元素的方法（您可能必须遍历子元素）。

# ruby-on-rails - 使用 Rails 的 atom_feed 助手设置条目 id

> ID：10378843
> 
> 赞同：0
> 
> 时间：2012-04-30T05:20:43.137
> 
> 标签：ruby-on-rails, xml, atom-feed

我正在使用 Rails 3.2.2 中的 atom feed builder 方法为模型的 index 方法创建自定义 atom feed。我需要将提要条目 ID 设置为自定义 url。目前构建器看起来像这样：

```
atom_feed ({:id => request.url}) do |feed|
  feed.title "Title"
  feed.author do |author|
    author.name @user.name
  end
  feed.category("term" => "thing feed")
  feed.updated @things.first.created_at if @things.any?
  @things.each do |thing|
    feed.entry (thing) do |entry|
      [... setting the entry with some thing attributes]
    end
  end
end 
```

如何设置提要条目项目的 id？做类似的事情

```
entry.id "foo" 
```

不起作用，因为它会创建一个重复的 id 节点而不是覆盖默认节点。明智地将其作为`feed.entry`参数的一部分，就像我对传递给的配置哈希所做的`atom_feed`那样，它不起作用，因为它是一个语法错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T06:58:32.557

我想通了，语法是：

```
feed.entry thing, {:id => custom_id} do |entry| 
```

# asp.net - MVC 2/ASP.NET 4.0 应用程序不工作

> ID：10378846
> 
> 赞同：0
> 
> 时间：2012-04-30T05:21:05.590
> 
> 标签：asp.net, asp.net-mvc-2, iis-7, url-routing, asp.net-4.0

我拿起了一个目前已损坏的项目，我正在尝试修复它。

该应用程序最后一次作为 .NET 3.5 Web 窗体应用程序正常工作，其中一些功能在 MVC 2.0 中实现。

该应用程序在升级到 .NET 4.0 并在 IIS 7 上运行时出现故障。Web 窗体功能工作正常，但 MVC 2.0 部分不再工作。浏览到 MVC URL 失败并出现 404 错误。似乎在浏览 URL 时 MVC 没有启动。

我已将 web.config 的摘录放在下面。

```
<compilation defaultLanguage="c#" debug="true">
  <assemblies>
    <add assembly="System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
    <add assembly="System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <add assembly="System.Web.Mvc, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>      
  </assemblies>
</compilation>

<system.webServer>
    <modules>
        <add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    </modules>
    <handlers>
    </handlers>
</system.webServer> 
```

它适用于开发 PC (Windows 7)。为什么 MVC 在部署到 IIS 7 (Win 2k8) 时不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T22:19:20.383

该`modules`元素需要按照[此答案](https://stackoverflow.com/a/6065145/80282)`runAllManagedModulesForAllRequests`中的说明进行设置。

```
<system.webServer>
    <modules runAllManagedModulesForAllRequests="true">
        <add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    </modules>
    <handlers>
    </handlers>
</system.webServer> 
```

# scala - 在 ScalaQuery 中重用会话？

> ID：10378849
> 
> 赞同：2
> 
> 时间：2012-04-30T05:21:11.180
> 
> 标签：scala, scalaquery

我需要通过我的一种 api 方法对我的数据库进行小（但频繁）的操作。当我每次尝试将它们包装到“withSession”中时，我的表现都很糟糕。

```
db withSession {
  SomeTable.insert(a,b)
} 
```

运行上述示例 100 次需要 22 秒。在一个会话中运行它们是即时的。

有没有办法在后续函数调用中重用会话？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T06:08:12.107

您是否有某种类型的连接池（请参阅[JDBC 连接池：连接重用？](https://stackoverflow.com/questions/3083333/jdbc-connection-pooling-connection-reuse)）？如果没有，您将为每个 withSession(...) 使用新连接，这是一种非常缓慢的方法。有关如何将 C3PO 与 ScalaQuery 一起使用的说明，请参阅[http://groups.google.com/group/scalaquery/browse_thread/thread/9c32a2211aa8cea9 。](http://groups.google.com/group/scalaquery/browse_thread/thread/9c32a2211aa8cea9)

如果您使用来自应用程序服务器的托管资源，您通常会“免费”获得它，但在独立服务器（例如码头）中，您必须自己配置它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T05:58:40.887

我可能说的方式太明显了，但是您可以在 withSession 块中放置更多调用，例如：

```
db withSession {
  SomeTable.insert(a,b)
  SomeOtherTable.insert(a,b)
} 
```

或者，您可以创建一个隐式会话，执行您的业务，然后在完成后关闭它：

```
implicit val session = db.createSession
SomeTable.insert(a,b)
SomeOtherTable.insert(a,b)
session.close 
```

# android - Google API 密钥

> ID：10378854
> 
> 赞同：1
> 
> 时间：2012-04-30T05:21:59.580
> 
> 标签：android, google-maps, api-key

我正在使用谷歌地图并生成了一个调试密钥。我听说使用 API v3 不再需要密钥。这个对吗？我可以在没有发布密钥的情况下工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T08:55:59.547

您将*始终*需要一个 API 密钥来下载瓦片地图和地图引擎 v3。请查看谷歌的[API 控制台](https://code.google.com/apis/console/#project:1010634796015)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:37:03.483

是的，您只能对 Google 地图使用调试密钥。

# java - java.io.InvalidClassException：本地类不兼容：

> ID：10378855
> 
> 赞同：53
> 
> 时间：2012-04-30T05:22:27.337
> 
> 标签：java, serialization, client-server, deserialization

我创建了客户端和服务器，然后在客户端添加了一个用于序列化目的的类，然后只需转到我硬盘中客户端的文件夹并将其复制粘贴到服务器相应的位置，两者都`classname.class`分别`classname.java`。

它在我自己的笔记本电脑上运行良好，但是当我想在其他系统上继续工作时，当我打开项目文件夹并且客户端尝试连接到服务器后，出现以下错误：

```
Exception in thread "main" java.io.InvalidClassException: projectname.clasname; local class incompatible: stream classdesc serialVersionUID = -6009442170907349114, local class serialVersionUID = 6529685098267757690
    at java.io.ObjectStreamClass.initNonProxy(ObjectStreamClass.java:562)
    at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:1582)
    at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1495)
    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1731)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1328)
    at java.io.ObjectInputStream.readObject(ObjectInputStream.java:350) 
```

到底是怎么回事？是因为我使用旧版本的 IDE 运行程序吗？

# 编辑

```
import java.io.Serializable;
import java.net.URL;

public class KeyAdr implements Serializable {
  private static final long serialVersionUID = 6529685098267757690L;

  public URL adr;
  public String key;
} 
```

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-04-30T05:29:08.307

如果一个类没有`private static final long serialVersionUID`在代码中显式定义a，它将自动生成，并且不能保证不同的机器会生成相同的id；看起来这正是发生的事情。此外，如果类以任何方式不同（使用不同版本的类），自动生成`serialVersionUID`的 s 也会不同。

从`Serializable`界面的[文档](http://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html)：

> 如果可序列化类没有显式声明 a `serialVersionUID`，则序列化运行时将根据`serialVersionUID`类的各个方面为该类计算默认值，如 Java(TM) 对象序列化规范中所述。但是，*强烈建议*所有可序列化类显式声明`serialVersionUID`值，因为默认`serialVersionUID`计算对类细节高度敏感，这些细节可能因编译器实现而异，因此可能会`InvalidClassExceptions`在反序列化期间导致意外。因此，为了保证`serialVersionUID`不同 java 编译器实现的值一致，可序列化的类必须声明一个显式`serialVersionUID`值。还强烈建议明确`serialVersionUID`声明`private`尽可能使用修饰符，因为此类声明仅适用于立即声明的类——`serialVersionUID`字段作为继承成员没有用。数组类不能声明一个显式的`serialVersionUID`，所以它们总是有默认的计算值，但是数组类不需要匹配`serialVersionUID`值。

您应该`serialVersionUID`在类定义中定义 a，例如：

```
class MyClass implements Serializable {
    private static final long serialVersionUID = 6529685098267757690L;
    ... 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-03-14T09:52:48.410

可能发生的一件事：

*   1：您使用给定的库 A（版本 X）创建序列化数据
*   2：然后您尝试使用相同的库 A（但版本 Y）读取此数据

因此，在版本 X 的编译时，JVM 将生成第一个 Serial ID（用于版本 X），并且它将对另一个版本 Y（另一个 Serial ID）执行相同的操作。

当您的程序尝试反序列化数据时，它不能，因为这两个类没有相同的序列号，并且您的程序不能保证两个序列化对象对应于相同的类格式。

假设您同时更改了构造函数，这对您来说应该是有意义的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-02-03T08:12:17.963

如果您使用的是 Eclipse IDE，请检查您的 Debug/Run 配置。在 Classpath 选项卡中，选择运行器项目并单击 Edit 按钮。 必须选中*仅包括导出的条目。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-08T15:39:23.203

异常消息清楚地表明，将包括类元数据的类版本随着时间的推移发生了变化。也就是说，序列化时的类结构在反序列化时是不一样的。这很可能是“正在发生”的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-30T06:05:51.573

java中的序列化并不意味着长期持久性或传输格式——它太脆弱了。类字节码和 JVM 稍有不同，您的数据就不再可读。为您的任务使用 XML 或 JSON 数据绑定（[XStream](http://x-stream.github.io/)快速且易于使用，并且有很多替代方案）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-30T05:29:35.590

我相信发生这种情况是因为您在客户端和服务器上使用了同一类的不同版本。它可以是不同的数据字段或方法

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-06T13:49:12.343

如果您使用 IntelliJ IDEA，请转到 File->Invalidate Caches。这将清除任何可能导致此问题的缓存类。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-07-24T07:31:59.130

如果您使用 oc4j 部署耳朵。

确保在项目中为 deploy.home= 设置正确的路径

您可以在 common.properties 文件中找到 deploy.home

oc4j需要重新加载ear中新创建的类，使服务端类和客户端类具有相同的serialVersionUID

# android - Android 日志收集器

> ID：10378857
> 
> 赞同：1
> 
> 时间：2012-04-30T05:22:29.867
> 
> 标签：android, android-logcat

是否有任何应用程序可以为**特定应用**程序收集日志消息？还是不可能？

我已经用过`log collector`。它收集设备日志。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T21:58:40.700

是不可能的。您只能按 TAG 过滤日志。如果您知道一个应用程序正在使用的所有标签，您可以执行以下操作：

```
adb logcat  tag1:D tag2:D \*:S 
```

这将在级别调试上记录 tag1 和 tag2，而不是其他任何内容。S 表示静默，\ 表示您的外壳。否则 * (for all) 将由你的 shell 解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:28:22.803

是的，来自[文档](http://developer.android.com/guide/developing/tools/adb.html#logcat)： adb logcat ActivityManager:I MyApp:D *:S

# objective-c - 在子类中更改 ivar 的类（到派生类）

> ID：10378858
> 
> 赞同：4
> 
> 时间：2012-04-30T05:22:30.113
> 
> 标签：objective-c, ios, inheritance, subclass, ivars

假设我有两个基类，`Container`并且`Gizmo`. Class`Container`有一个实例变量 class `Gizmo`。

现在我是子类`Container`（称为`SubContainer`），我也是子类`Gizmo`（`SubGizmo`）。在某些方法中，我需要向一些没有但`SubContainer`有的属性发送消息。有什么方法可以将 ivar 覆盖为in类，以便我可以发送这些消息？`Gizmo``SubGizmo``SubGizmo``SubContainer`

现在，我可以通过在`SubGizmo`每次需要使用此类属性或方法时将继承的 ivar 转换为它来使其工作。

这就是我想要这种行为的原因：我已经有一个可以运行的游戏，但是我添加的模式越多，它就越难维护。如果我想更改/添加将在每种模式下运行的方法；我需要去三个不同的游戏 - 控制器对象并进行更改。

通过子类化，我想将主要的游戏机制保留在基类中，并为每种模式创建一个子类。这样，我在基类中所做的更改将反映在每种模式上。然而，每个控制器和游戏对象都有针对不同模式的新方法，并且它们相互发送消息。这就是我的问题所在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T06:21:26.443

只需使用如下方法引入类型安全和转换逻辑：

```
@interface SubContainer ()

- (SubGizmo *)subGizmo;
// setter is often unnecessary
- (void)setSubGizmo:(SubGizmo *)pSubGizmo;

@end

@implementation SubContainer

...

- (SubGizmo *)subGizmo
{
    Gizmo * ret = self.gizmo;
    // sanity check the type to ensure this is properly initialized,
    // or return nil if holding a Gizmo is valid in this context:
    assert([ret isKindOfClass:[SubGizmo class]]);
    return (SubGizmo *)ret;
}

- (void)setSubGizmo:(SubGizmo *)pSubGizmo
{
    self.gizmo = pSubGizmo;
}

- (void)addWater
{
  [self.subGizmo addWater];
}

@end 
```

然而，逐渐增加的复杂性表明类型的更多变化值得考虑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T06:02:12.517

只需为您的 ivar 使用类型 id，您只需包含正确的头文件以避免警告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T05:37:30.477

最简单的方法是在 Container 中使用 SubGizmo，而不是 Gizmo。:-)

但是，如果你因为某种原因不能直接这样做，你可以在运行时修改 SubContainer （寻找`class_addIvar`or `class_addMethod`，我可以在你需要的时候给你一个例子），但这无助于避免 Xcode 的警告。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-30T06:05:00.783

您可以使用 NSNotifications 向您的所有游戏控制器发送更新。

# php - 在 php/codeigniter 的函数中加载视图文件

> ID：10378860
> 
> 赞同：1
> 
> 时间：2012-04-30T05:22:52.587
> 
> 标签：php, codeigniter

我有一个要插入视图文件的功能。当您只需要`echo`一两件事但我有一些复杂的 html 时，这非常简单，因此想为以下 foreach 循环和 if 语句利用备用 php 语法：

**更新**我`CI->load->view`根据 tpaksu 的建议更正了包含第三个参数。它更接近工作，但仍然不太正确。请参阅代码中的以下注释：

```
<?
  function displayComments(array $comments, $parentId = null) {
  $CI=& get_instance();     
  foreach($comments as $comment){
        if($comment['replied_to_id'] == $parentId){

     echo $CI->load->view('reviews/comment_list', $comments, true); // this doesn't work, it only shows the last array member
              // echo $comment['comment']; this works as expected
    }
   }
  }  
displayComments($comments, $parentId = null);        
?> 
```

以下是“评论/评论列表视图文件”最简单的形式：

```
<ul> 
 <? foreach($comments as $comment): $comment=$comment['comment']?>
  <li>
      <?echo $comment?>
 </li> 
 <?endforeach;>
</ul> 
```

有人知道如何将视图文件嵌入到函数中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:34:53.327

您在第一个文件中的内容：

```
<?php
    $CI=& get_instance();     
    echo $CI->load->view('reviews/comment_list', $comments, true);
?> 
```

和`reviews/comment_list`观点：

```
<ul> 
    <?php
    foreach($comments as $comment){
       $comment=$comment['comment'];
       echo "<li>" . $comment . "</li>";
    }
    ?>
</ul> 
```

写这个然后再试一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T13:26:38.427

我通常在我的项目中有一个**snippet_helper 。**在那里，我有很多函数可以生成大量可重用的东西（也称为*模块*或*组件*）。

我也喜欢在主函数中返回数据的 WordPress 方法（在显示之前您可能需要更多处理）和直接`echo`结果的“姐妹函数”。

我想它会和你一起工作。例如：

```
function get_display_comments(array $comments, $parentId = NULL)
{
    $CI     =& get_instance();
    $return = '';

    foreach ($comments AS $comment)
    {
        if ($comment['replied_to_id'] == $parentId)
        {
            $return .= $CI->load->view('reviews/comment_list', $comments, TRUE);
        }
    }

    return $return;
}

function display_comments(array $comments, $parentId = NULL)
{
    echo get_display_comments($comments, $parentId);
} 
```

# search - 在 Sphinx 搜索中，如何将“hashtag”添加到 charset_table？

> ID：10378865
> 
> 赞同：3
> 
> 时间：2012-04-30T05:23:50.170
> 
> 标签：search, unicode, utf-8, lucene, sphinx

我希望人们能够搜索`#photography`以及`photography`. 在 Sphinx 中，这些应该被视为两个不同的词。默认情况下，`#photography`映射到`photography`，我无法搜索主题标签。

[我在此页面](http://sphinxsearch.com/forum/view.html?id=4564)上读到，您可以将哈希标记添加到 charset_table 来完成此操作。我完全不知道如何做到这一点。我不知道 unicode，也不知道我的 charset_table 应该是什么。

有人能告诉我我的 charset_table 应该是什么吗？谢谢。

```
# charset_table     = 0..9, A..Z->a..z, _, a..z, U+410..U+42F->U+430..U+44F, U+430..U+44F 
```

**注意：我打算使用实时索引。（不确定这是否会有所不同）**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-30T12:01:57.180

这是`U+0023`根据 Unicode 表。所以最终的配置应该是这样的

```
charset_table     = 0..9, A..Z->a..z, _, a..z, U+23, U+410..U+42F->U+430..U+44F, U+430..U+44F 
```

不要忘记`charset_type`变量。AFAIK，此示例`charset_table`适用于`utf-8`. 除此之外，您应该`U+23`从`blend_chars`变量中删除以允许 Sphinx 将其索引为合法字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T09:16:37.150

> > > 我希望人们能够搜索#photography 以及摄影。在 Sphinx 中，这些应该被视为两个不同的词。默认情况下，#photography 映射到摄影，我无法搜索主题标签。

再会。

我认为它可以解决您的问题，但是：

直接从用户查询中调用搜索功能是一种不好的方式。

在 sphinx 引擎中调用搜索功能之前，您需要对用户字符串进行某种处理。例如，您可以检查用户字符串中的某种特殊字符并从查询中删除特殊字符。之后，您可以使用已进行的查询调用搜索功能。

祝你好运。

# android - 我可以在 Android 中实现自动呼叫某人吗？

> ID：10378866
> 
> 赞同：6
> 
> 时间：2012-04-30T05:23:55.163
> 
> 标签：android

我想从我的 android 手机实现自动呼叫。如果我也为特定号码和日期设置消息，那么我的安卓手机应该会自动拨打该号码。是否可以在没有任何用户交互的情况下通过我的安卓手机拨打任何号码？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-30T05:30:07.697

是的，有可能。call 的代码很简单。

```
Intent intent = new Intent(Intent.ACTION_CALL);   
intent.setData(Uri.parse("tel:09999"));    
startActivity(intent); 
```

使用您的号码代替`09999`。不要忘记在 Android Manifest.xml 中指定调用权限

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T05:35:44.750

创建一个`Alarm`将在特定时间触发并添加代码以调用任何特定号码。[**这**](http://justcallmebrian.com/?p=129)是您如何设置`AlarmManager`在特定时间触发的方法。然后，您可以在`Intent.ACTION_CALL`触发警报时拨打电话。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T05:31:53.553

是的，您可以使用[Intent.ACTION_CALL](http://developer.android.com/reference/android/content/Intent.html#ACTION_CALL)。

# ruby - 通过键数组值获取嵌套哈希中的键值

> ID：10378874
> 
> 赞同：0
> 
> 时间：2012-04-30T05:24:31.353
> 
> 标签：ruby

示例哈希：

```
 {
    "audio" =>  {
      "audio/aac" => ["aac"],
      "audio/mpeg" => ["mp3", "mp2"],
      "audio/mp4" => ["m4a", "m4b", "m4r", "3gp"],
      "audio/ogg" => ["ogg", "oga"],
      "audio/flac" => ["flac"],
      "audio/speex" => ["spx"],
      "audio/x-ms-wma" => ["wma"],
      "audio/x-pn-realaudio" => ["rm", "ram"],
      "audio/vnd.wave" => ["wav"],
      "audio/x-musepack" => ["mpc", "mp+", "mpp"],
      "audio/x-aiff" => ["aiff", "aif", "aifc"],
      "audio/x-tta" => ["tta"]
    },
    "video" =>  {
      "video/mp4" => ["mp4"],
      "video/mpeg" => ["mpg", "mpeg"],
      "video/x-m4v" => ["m4v"],
      "video/quicktime" => ["mov"],
      "video/x-msvideo" => ["avi"],
      "video/x-flv" => ["flv"],
      "video/webm" => ["webm"]
    }
  } 
```

给定文件扩展名来获取相关内容类型的最佳方法是什么（第一次匹配可以）？

搜索“flac”应该返回“audio/flac”。

目前我正在使用这个：

```
hsh.each_key do |group|
  hsh[group].each do |k,v|
    return k if v.include?(extension)
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T06:08:42.873

最好在创建时解开这种结构。但是，您可以遍历各个级别并从中获得一些有用的东西。如果我将您的初始哈希分配给`mime_hash`我可以使用以下方法解开它：

```
Hash[*mime_hash.map{ |av, types| types.map{ |mime_type, extensions| extensions.product([mime_type]) } }.flatten] 
```

或更详细地说：

```
Hash[
  *mime_hash.map{ |av, types| 
    types.map{ |mime_type, extensions| 
      extensions.product([mime_type]) 
    } 
  }.flatten
] 
```

哪个会返回：

```
{
     "aac" => "audio/aac",
     "mp3" => "audio/mpeg",
     "mp2" => "audio/mpeg",
     "m4a" => "audio/mp4",
     "m4b" => "audio/mp4",
     "m4r" => "audio/mp4",
     "3gp" => "audio/mp4",
     "ogg" => "audio/ogg",
     "oga" => "audio/ogg",
    "flac" => "audio/flac",
     "spx" => "audio/speex",
     "wma" => "audio/x-ms-wma",
      "rm" => "audio/x-pn-realaudio",
     "ram" => "audio/x-pn-realaudio",
     "wav" => "audio/vnd.wave",
     "mpc" => "audio/x-musepack",
     "mp+" => "audio/x-musepack",
     "mpp" => "audio/x-musepack",
    "aiff" => "audio/x-aiff",
     "aif" => "audio/x-aiff",
    "aifc" => "audio/x-aiff",
     "tta" => "audio/x-tta",
     "mp4" => "video/mp4",
     "mpg" => "video/mpeg",
    "mpeg" => "video/mpeg",
     "m4v" => "video/x-m4v",
     "mov" => "video/quicktime",
     "avi" => "video/x-msvideo",
     "flv" => "video/x-flv",
    "webm" => "video/webm"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:38:34.067

正如您已经意识到您拥有的数据结构很难以您想要的方式进行搜索。假设您将一遍又一遍地搜索相同的数据，您应该为它创建一个索引。

有很多方法可以做到这一点，但最简单的可能只是将散列变平并将其反转，以便您的键成为值，反之亦然。这样你就可以简单地通过调用来搜索它`content_types['flac']`

示例哈希的一部分可能会像这样结束：

```
{
  "aac" => "audio/aac",
  "mp3" => "audio/mpeg",
  "mp2" => "audio/mpeg",
  "m4a" => "audio/mp4",
  "m4b" => "audio/mp4",
  "m4r" => "audio/mp4",
  "3gp" => "audio/mp4",
  "flac" => "audio/flac"
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T05:40:37.047

尝试使用[rassoc()](http://www.ruby-doc.org/core-1.9.3/Hash.html#method-i-rassoc)

定义：

使用 == 搜索将 obj 与值进行比较的哈希。返回匹配的第一个键值对（二元素数组）。另请参见数组#rassoc。

```
a = {1=> "one", 2 => "two", 3 => "three", "ii" => "two"}
a.rassoc("two")    #=> [2, "two"]
a.rassoc("four")   #=> nil 
```

# javascript - 如何禁用提交操作

> ID：10378876
> 
> 赞同：13
> 
> 时间：2012-04-30T05:24:36.410
> 
> 标签：javascript, jquery, ajax, forms

嗨，我有这个表单，我不想在单击提交按钮时执行任何操作。我要做的就是执行将数据加载到 div 中的功能。有任何想法吗？？

```
<form  method="POST"   action="" id="search-form">
          <input type="text" name="keywords"  />
          <input type="submit" value="Search" id="sButton" onclick="loadXMLDoc('file.xml')" />
</form> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-30T05:27:12.997

```
onclick="loadXMLDoc('file.xml'); return false;" 
```

甚至更好：

```
<script>
    window.onload = function() { 
        document.getElementById("search-form").onsubmit = function() { 
            loadXMLDoc('file.xml');
            return false;
        };
    };
</script> 
```

要实现 loadXMLDoc，可以使用 jQuery 中的 ajax 模块。例如：

```
function loadXMLDoc() { 
    $("div").load("file.xml");
} 
```

使用 jQuery 的最终代码：

```
<script>
    $(function() { 
        $("#search-form").submit(function() { 
            $("div").load("file.xml");
            return false;
        });
    });
</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-04T08:48:21.977

I think you need ajax function to load data with in `div` without page reload

Change input type `submit` to `button`

```
<input type="button" value="Search" id="sButton" onclick="AjaxSend()" /> 
```

Ajax CAll:

```
<script type="text/javascript">
    function AjaxSend(){
         $.get('file.xml', function(data) {
              $('div').html(data);
          });
     }
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-04-01T10:28:39.120

使用防止默认值来避免表单操作。请参考下面的代码可能对您有所帮助

```
function createRecord(){	
	event.preventDefault();

}
```

```
<form>

<input type="text"/>
<input type="submit" onclick="createRecord()"/>

</form>
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-17T04:17:44.560

只需`action`从中删除参数`form`并添加`onsubmit="return false"`. 每次单击表单中的任何按钮时，它都会返回 false。试试这样：

```
<form  method="POST" onsubmit="return false" id="search-form">
          <input type="text" name="keywords"  />
          <input type="submit" value="Search" id="sButton" onclick="loadXMLDoc('file.xml')" />
</form> 
```

# android - 无法创建任何表 SQLite / Android

> ID：10378878
> 
> 赞同：0
> 
> 时间：2012-04-30T05:25:02.603
> 
> 标签：android, sqlite

正如主题所暗示的那样，我在 sqlite 中创建新表时遇到了一些问题。无论我用我的代码做什么，我都无法在数据库中创建新表。如果我查看数据库，则只有 android_metadata tb，没有别的。创建一个新的代码是：

```
...
this.createTable(R.string.nametable, "_id INT PRIMARY KEY, " + "parentID INT, " + "name TEXT");
...

public void createTable(int id, String sql) {
        String table = this.getStringById(id);
        String _sql = "CREATE TABLE " + table + "(" + sql + ")";
        Log.d("Controller.createTable", _sql);
        this.mCurrentConnection.rawQuery(_sql, null);
        try {
            Cursor c = this.Select(id, "*", null);
            c.close(); 
            Log.d("Controller.createTable", "create finished");
        } catch (Exception e) {
            Log.d("Controller.createTable", "can't create table: " + table);
        }
    } 
```

我在我的应用程序的构造器中打开或创建数据库

```
if(this.mCurrentConnection == null || !this.mCurrentConnection.isOpen()) {
            this.mCurrentConnection = this.mContext.openOrCreateDatabase(this.mDB, Context.MODE_PRIVATE , null);
        } 
```

我已经尝试了一切：更改 db / tb 的名称，重新安装应用程序，放置“;” 或不在命令末尾，请使用新的干净 vm 进行尝试。我没有找到任何有用的现有帖子/答案来解决我的问题。如果我执行 _sql 语句

```
CREATE TABLE name_table(_id INT PRIMARY KEY, parentID INT, name TEXT) 
```

在 phpmyadmin (MySQL) 中一切正常。

如果你能帮助我，我会很高兴。

问候亚历克斯

编辑：（回答下面的评论）

@VikramBodicherla：这就是问题所在。create 语句本身并没有引起任何异常。选择（检查）语句确实会抛出一个

> 04-30 07:34:14.834: E/Database(305): 插入 parentid=-1 时出错 name=blabla 04-30 07:34:14.834: E/Database(305): android.database.sqlite.SQLiteException:
> 
> 没有这样的表：name_table:，编译时：INSERT INTO name_table(parentid, name) VALUES(?, ?); 04-30 07:34:14.834: E/Database(305): at android.database.sqlite.SQLiteProgram.native_compile(Native Method) 04-30 07:34:14.834: E/Database(305): at android.database .sqlite.SQLiteProgram.compile(SQLiteProgram.java:110) 04-30 07:34:14.834: E/Database(305): at android.database.sqlite.SQLiteProgram.(SQLiteProgram.java:59) 04-30 07: 34:14.834: E/Database(305): 在 android.database.sqlite.SQLiteStatement.(SQLiteStatement.java:41) 04-30 07:34:14.834: E/Database(305): 在 android.database.sqlite。 SQLiteDatabase.compileStatement(SQLiteDatabase.java:1027) 04-30 07:34:14.834: E/Database(305): 在 android.database.sqlite.SQLiteDatabase.insertWithOnConflict(SQLiteDatabase.java:1413) 04-30 07:34: 14.834：E/数据库（305）：在安卓。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:38:07.147

你真的真的很想使用[SQLiteOpenHelper](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html)类及其相关[模式](http://developer.android.com/guide/topics/data/data-storage.html#db)：它不仅用于升级，它还可以干净地处理创建表。

此外，您的 create 语句应该如下所示：

```
CREATE TABLE name_table (_id  INTEGER PRIMARY KEY AUTOINCREMENT, parentID INTEGER, name TEXT) 
```

编辑：从您的跟踪中，您的 CREATE TABLE 永远不会运行（因此该表不存在）。使用 SQLiteOpenHelper 和[`execSQL`](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#execSQL%28java.lang.String%29)函数来创建表，你应该已经准备好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T12:12:35.833

04-30 07:34:14.834: E/Database(305): 插入 parentid=-1 时出错 name=blabla 04-30 07:34:14.834: E/Database(305): android.database.sqlite.SQLiteException:

根据您的错误堆栈，您是否尝试插入 -1 作为父 ID？parentid 是主键，不接受负值

# objective-c - 具有多个数据源的单个 NSTableView

> ID：10378884
> 
> 赞同：0
> 
> 时间：2012-04-30T05:26:20.223
> 
> 标签：objective-c, cocoa, nstableview

让两个数据源填充一个 NSTableView 在逻辑上是否有意义？还是弹出按钮（能够选择读取哪个数据源）更合理？

如果我使用单个 NSTableView 选项，如果我将所有数据输入到单个数据源（例如 NSDictionary）然后填充表格，我会更好吗？我看到这个想法的唯一问题是完成表的选择后会发生什么。我将如何破译选择了哪个原始位置。

另一个突然出现在我脑海中的想法/潜在问题......如果我从数据源中获取数据并直接填充表格，如何在相关的 NSTableView 'count' 方法中给出表格的计数.. 将添加数据存储 1 和数据存储 2 的计数呢？

对不起，如果它有点混乱.. 感谢您的任何意见！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T05:49:01.643

您绝对可以使用多个数据源来将数据显示在表格视图中，但它们都必须通过单个控制器对象进行汇集，该控制器对象被分配为表格视图`datasource`并实现`NSTableViewDatasource`协议。

您必须在控制器对象中编写一些代码，以便跟踪组成的多个源数组，并为表视图提供项目数量和每个项目内容的适当值。

这是一个非常简单的例子：

```
- (NSInteger)numberOfRowsInTableView:(NSTableView *)aTableView
{
    return [array1 count] + [array2 count];
}

- (id)tableView:(NSTableView *)aTableView objectValueForTableColumn:(NSTableColumn *)aTableColumn row:(NSInteger)rowIndex
{
    if(rowIndex >= [array1 count])
    {
        return [array2 objectAtIndex:rowIndex - [array1 count]];
    }
    else
    {
        return [array1 objectAtIndex:rowIndex];
    }
} 
```

至于选择，您的控制器知道它从哪里获取数据，因此当用户选择特定行时，将该行索引转换为您的一个后备存储中的匹配对象应该是微不足道的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T05:31:16.170

根据您的应用程序逻辑，它可能是有意义的。最简单的方法是为每个表格部分设置不同的来源。然后，您可以使用节号作为数据库的选择器。

# iphone - 是否可以在指定的日期和时间自动呼叫？

> ID：10378888
> 
> 赞同：-1
> 
> 时间：2012-04-30T05:26:57.003
> 
> 标签：iphone, ios

我想知道是否可以使用某些系统 API 或以其他方式在 iOS 中的预定义日期和时间对预定义的号码进行自动调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T06:17:10.283

您可以尝试仅在链接下方的 UILocalNotification 警报中执行此操作，以下载我的示例项目

[http://www.4shared.com/zip/QVgHkM1n/Notification.html](http://www.4shared.com/zip/QVgHkM1n/Notification.html)

**注意：通话功能仅适用于 iphone 真机..！**

谢谢..！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T07:50:30.843

这将帮助你[重复 iOS 本地通知](http://useyourloaf.com/blog/2010/9/13/repeating-an-ios-local-notification.html)

# mysql - 更新触发器以在字段中维护正确的 url

> ID：10378891
> 
> 赞同：0
> 
> 时间：2012-04-30T05:27:05.483
> 
> 标签：mysql, triggers

我正在寻找一个短期解决方案，同时我在弄清楚为什么同步会在表中设置一个字段错误我准备了一个触发器，并欢迎对此发表评论，以及任何必要的更正或更好的策略。

```
 CREATE TRIGGER urlcorrect AFTER INSERT ON sym_node
     FOR EACH ROW BEGIN
     IF NEW.sync_url= 'http://wrongaddress' THEN
     UPDATE sym_node SET sync_url= "http://123.456.7.89:1234/etc";
     END IF;;
     END$
     delimiter; 
```

谢谢大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T05:50:48.727

你的触发器在很多方面都是错误的。

首先，我认为您需要一个 BEFORE 触发器，以便您可以在该行进入您的表之前修复该行。

其次，这个：

```
UPDATE sym_node SET sync_url= "http://123.456.7.89:1234/etc"; 
```

会更新表中的每一个`sync_url`，`sym_node`这不是你想要的。而且我认为 MySQL 不会让您在该表的触发器内更新表（如果我在这方面错了，请有人纠正我）。此外，即使 MySQL 允许您使用双引号，您也应该对字符串文字使用单引号，不要从 MySQL 的松懈行为中汲取坏习惯。你想要：

```
set new.sync_url = 'http://123.456.7.89:1234/etc'; 
```

把所有这些放在一起，你会得到：

```
delimiter $
create trigger urlcorrect before insert on sym_node
for each row begin
    if new.sync_url = 'http://wrongaddress' then
        set new.sync_url = 'http://123.456.7.89:1234/etc';
    end if;    
end;
$
delimiter ; 
```

# cordova - SqliteDatabaseCpp 使用 PhoneGap 和 sencha-touch2 时无法打开数据库文件

> ID：10378894
> 
> 赞同：1
> 
> 时间：2012-04-30T05:27:52.997
> 
> 标签：cordova, sencha-touch-2

我是android编程的新手。
* 我下载并安装了phonegap，制作了一个可以运行的hello world 应用程序。
* 我下载了 sencha-touch2 并在 hello world 应用程序的 www 文件夹下创建了一个应用程序。
* 我在 phonegap index.html 和我从 sencha-touch2 获得的 index.html 之间合并。
* 我运行了 android 应用程序并在主 java 代码中尝试了以下操作：
- 我使用 appView 设置了启用数据库的标志。
- 我试图设置数据库的路径。

但是，无论如何，我收到以下消息：

> 04-30 08:19:25.638：I/SqliteDatabaseCpp(14447)：sqlite 返回：错误代码 = 14，msg = 无法在 [8609a15dfa] 的第 27701 行打开文件，db=/data/data/com.phonegap.hello/数据库/webview.db

请帮忙 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T07:10:08.280

这是一个流行的错误，我不知道为什么 Android 团队不修复它。您应该使用这种方式来检查您的数据库是否存在：

```
public boolean databaseExist()
{
    File dbFile = new File(DB_PATH + DB_NAME);
    return dbFile.exists();
} 
```

# android - 从 Internet 下载 Doc/PDF 并保存到内存中

> ID：10378895
> 
> 赞同：9
> 
> 时间：2012-04-30T05:27:57.327
> 
> 标签：android, memory, download, internal

我正在尝试制作一个主要打开和阅读我拥有的一组预定文档的应用程序。最初的想法是在首次运行或安装时将所有文档（大约 40 等于 MB）复制到用户的内部存储器（/data/data/(appname)/files）中。我意识到这可能是一个坏主意，因为某些手机的内存空间有限。我现在正在考虑更改我的应用程序想法，以从 Internet 上的存储位置下载文件并将其保存到内部存储器中。通过这种方式，用户只能查看所需的文档，从而大大减少了所需的内存大小。我已经看到了一些有关如何下载文件的代码片段，对于这种情况，我想使用 PDF，但我找不到将它们保存到内部存储器（/data/data/(app)/files）的方法。

有关如何：1\. 从 Internet 下载 doc/PDFs 文件，2\. 立即将文件保存到内部存储器，3\. 使用 3rd 方程序（例如 adobe reader）从内部存储器启动 doc/PDFs 的任何帮助.

感谢您的帮助！

# jsf-2 - 无法导航到 jsf portlet 中按钮上的另一个页面

> ID：10378900
> 
> 赞同：0
> 
> 时间：2012-04-30T05:28:23.890
> 
> 标签：jsf-2, liferay-6

我正在尝试开发一个 jsf portlet(primefaces 3.2)

我创建了一个 jsf portlet，我在其中显示了一个数据表。在我的数据表中，有一个按钮。

现在，当我单击该按钮时，应该会打开一个 jsp 页面。它实际上不起作用。

我正在尝试使用这种方式来实现它。

```
<div style="text-align:right">
                        <p:lightBox iframe="true" width="1000" height="840">
                            <h:outputLink
                             value="./next.jsp">
                                <p:commandButton value="Add" icon="ui-icon ui-icon-plusthick" style="margin:3px;display: table-cell;vertical-align: middle;"/>
                            </h:outputLink>
                        </p:lightBox>
                    </div> 
```

我当前的 portletViewMode.xhtml（portlet 显示页面）和 next.jsp 存在于 portlet 中（在 xhtml 文件夹中）。

它是一个 jsf 视图（portletViewMode.xhtml），它在您创建 jsf-portlet 时创建，在该视图中我显示了一个数据表，里面有一个按钮。

当我单击该按钮时，我应该能够导航到充当灯箱的 jsp 页面。因此，如果我关闭，我应该能够看到我以前的 jsf 视图。

所以我试图在按钮（这是一个 jsf 组件）的操作上从 jsf 视图导航到另一个 jsp 页面。

我应该为此做些什么？有没有人尝试从 jsf 视图导航到任何其他页面。？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T10:46:18.047

您`p:lightBox`以错误的方式使用。

关于 Primefaces 主页上的示例，您应该使用`p:lightBox`with`iframe="true"`来显示页面内容。

`h:commandButton`用an 包裹 an`h:outputLink`并不是最优雅的解决方案。您可以使用简单的`h:button`，但它也适用于`h:commandButton`：

```
<p:lightBox iframe="true">
    <h:outputLink value="page2.xhtml"  >  
        <h:commandButton action="#" value="Next page" />  
    </h:outputLink>  
</p:lightBox> 
```

注意 iFrame 的内容需要`value`进入`h:outputLink`.

此外，JSP 和 Primefaces 将无法工作。仅使用 facelets。

# c++ - 如何在 C++ 中使用简单的递归下降解析器解析基本算术（例如“5+5”）？

> ID：10378903
> 
> 赞同：15
> 
> 时间：2012-04-30T05:28:35.837
> 
> 标签：c++, parsing, tokenize, recursive-descent

这一直在我的脑海里。我对递归下降解析器很感兴趣，并且想知道如何实现它。我想要的是一个简单的解析器，它可以理解简单的算术，例如“5+5”或“(5+5)*3”。

我认为第一步是编写一个“标记器”，它将整个输入字符串分解为许多子字符串。[这部分我已经完成了（我什至不得不在这里](https://stackoverflow.com/questions/10358598/why-is-this-function-not-breaking-up-this-input-string)询问它。如果你不想的话，你不必点击链接，因为我在这里也发布了相关代码。）使用这个标记器我的，我最终得到一个`vector`of `string`s 或令牌。现在，困难的部分：我想解析这些标记。

我已阅读[有关递归下降解析器的 Wikipedia 文章](http://en.wikipedia.org/wiki/Recursive_descent_parser)。我确实了解整体概念，但与往常一样，实现有点令人困惑。在那篇文章中，有一个用于非常简单的编程语言的递归下降解析器的 C 实现，文章中也进行了讨论。我尽我所能研究了该代码，并尝试基本上编写相同的东西，但对于我的程序。下面是那个代码。

我真正困惑的是这个解析器做了什么。它似乎通过程序并“预期”语法的某些部分。但是一旦它到达那里，它会做什么？例如，这里有一个来自维基百科代码的函数，它应该解析一个“术语”：

```
void term(void) {
    factor();
    while (sym == times || sym == slash) {
        getsym();
        factor();
    }
} 
```

这是为了解析这个语法：

```
term = factor {("*"|"/") factor} . 
```

这是有道理的。但它与实际术语有什么关系？假设该术语只是“6”，或者是“3 * 2”并且结果为6。它将如何将其合并到输入的其余部分中？不应该`term()`返回 a`double`而不是`void`（返回 6）？还是以其他方式完成？

此外，让这样的解析器输出代码和立即对输入采取行动（即编译器与解释器）之间有什么区别？这两个（至少在这个例子中）理论上是用相同的方式实现的，还是根本不同？

欢迎任何意见。到目前为止，这是我的代码：

```
#include <iostream>
#include <string>
#include <vector>
#include <ctype.h>
#include <sstream>

using namespace std;

vector<string> symbolize(string);
bool accept(string);
void getSymbol();
void error(string s);
bool expect(string);
void expression();
void term();
void factor();

int currentPosition = -1;
string symbol;
vector<string> symbols;

int main(int argc, const char * argv[])
{

    string input;
    getline(cin,input);

    symbols = symbolize(input);
    getSymbol();
    expression();

    return 0;
}

void factor(){
    if(isdigit(symbol.c_str()[0])){}
    else if(accept("(")){
        expression();
        expect(")");
    }
    else {
        error("Syntax error");
    }

}

void term(){
    factor();
    while(symbol=="*"||symbol=="/"){
        getSymbol();
        factor();
    }
}

void expression(){
    if(symbol == "+" || symbol == "-") getSymbol();
    term();
    while(symbol == "+" || symbol == "-"){
        getSymbol();
        term();
    }
}

void error(string s){
    cout << endl << "ERROR: " << s << endl;
}

void getSymbol(){
    currentPosition++;
    if(currentPosition>=symbols.size())error("Unexpectedly reached end of input");

}

bool expect(string s){
    if(accept(s))return true;
    else error("Expected '" + s + "'");
    return false;
}

bool accept(string s){
    if(s==symbol){getSymbol();return true;}
    return false;
}

// Takes a string and breaks it into substrings
vector<string> symbolize(string input){
    int position = 0;
    char c;
    //stringstream s;
    vector<string> symbols;
    enum symbolType {TEXT,OPERATOR}symbolType,charType;

    while(position < input.size()){
        stringstream s;
        c = input.at(position);
        if(isalnum(c))symbolType = TEXT;
        else symbolType = OPERATOR;
        charType = symbolType;

        while(symbolType == charType){
            s << c;
            position++;
            if(position>=input.length())break;
            c = input.at(position);
            if(isspace(c)||c=='\n'){position++; break;}
            if(isalnum(c)) charType = TEXT;
            else charType = OPERATOR;
        }

        symbols.push_back(s.str());
    }

    return symbols;
} 
```

**编辑：**我应该提到我的代码*总是*`ERROR: syntax error`从`factor()`函数中打印：

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-30T05:47:41.853

维基百科文章包含一个看起来非常完整的解析器（但没有词法分析器！），它什么都不做。

对于实际*解释*结果，一般的想法是，每个解析函数将部分解释的结果传递回其父/调用者。对于树中的每个规则，结果可能是不同的类型。如果您正在为完整的语言编写解析器，部分解释的结果可能是一个简单的常量（可以是任何类型），也可能是整个函数（您可能需要稍后编译）。在方程解析器的情况下，每个规则将简单地对调用其他函数获得的元素执行所需的操作，并将结果传递回调用它的函数。

想到了两种方法：

1.  让每个函数接受一个`something* result`参数。在一个简单的方程解析器的情况下，这可能`float* result`适用于所有元素。

2.  只需将所有函数从 更改为 即可返回`void rule_x()...`结果`float rule_x()...`。

无论哪种情况，您都需要某种方法来处理错误。如果您在 C 中，则没有例外，因此您最好使用选项 1 并使用返回值来指示成功。那么会有很多

```
if(!expression(&result)) return 0; 
```

但在 C++ 中，您可以将解析包装在异常处理程序中，并在错误中抛出异常，从而中止解析的其余部分。

当您愿意时，事情会变得更加有趣，例如使用优化或 JIT 编译整个语言，并尝试从语法错误中优雅地恢复并继续解析。

入题的书是[龙书](http://en.wikipedia.org/wiki/Compilers:_Principles,_Techniques,_and_Tools)。

# qt - “Qt Creator”的 TFS 插件

> ID：10378905
> 
> 赞同：5
> 
> 时间：2012-04-30T05:28:52.053
> 
> 标签：qt, plugins

**qt creator** IDE是否有可用的 TFS 插件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T04:37:19.920

Qt Creator 支持 perforce、git、mercurial、subversion 和 cvs 作为版本控制系统。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-19T12:22:50.633

Qt 论坛中的相同问题：http: [//qt-project.org/forums/viewthread/40225](http://qt-project.org/forums/viewthread/40225)

答：oktet.net 上有一个插件：[http ://www.oktet.net/2014/02/04/team-foundation-server-plugin-for-qt-creator/](http://www.oktet.net/2014/02/04/team-foundation-server-plugin-for-qt-creator/)

我个人没有尝试过，所以我不能评论质量或有用性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T20:19:17.813

它还支持 Bazaar 和 ClearCase。

# selenium - 从 Web 应用程序记录 Selenium 测试。

> ID：10378912
> 
> 赞同：0
> 
> 时间：2012-04-30T05:30:10.817
> 
> 标签：selenium

我们有一个用 Flex 编写的 Web 应用程序，我们已经在使用 Selenium 进行测试。如果您的任务是调查一些允许用户从应用程序中按下记录按钮并实际记录 Selenium 测试的解决方案，您将从哪里开始？

我想您需要将整个 Flex 元素包装在一些能够拦截点击和跟踪输入的东西中。这甚至可能吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-20T06:30:49.960

为此，您必须使用 Autoit Recorder 记录此事件。编译 Autoit 脚本后将生成 .exe 文件。因此，您可以通过从 selenium RC 执行此 .exe 文件来测试该部分

# html - 如何增加html文本框字符长度

> ID：10378914
> 
> 赞同：-4
> 
> 时间：2012-04-30T05:31:02.567
> 
> 标签：html, database

我正在尝试将 100 个字符存储在数据库中，但 30 个字符存储在数据库中，其余字符未存储在数据库中请给我建议以增加 html 文本框的字符长度

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T05:32:16.047

```
<input type="text" maxlength="100" /> 
```

除非您的数据库字段只是一个 varchar(30)，在这种情况下，您必须将`ALTER TABLE`其扩展为 100 个字符。

您提供的详细信息不足以准确找出问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:36:10.813

这取决于那是否是注释字段，是否为该字段提供文本属性..它将需要..

或者如果它是名称，用户名，给 varchar(100) 它将采取..

[http://forums.mysql.com/read.php?24,105964,105964](http://forums.mysql.com/read.php?24,105964,105964)

# unit-testing - MVP总是值得的吗？

> ID：10378915
> 
> 赞同：5
> 
> 时间：2012-04-30T05:31:09.107
> 
> 标签：unit-testing, gwt, mvp

[MVP](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93presenter)是否被认为是*所有* GWT 应用程序的最佳实践？

*   小型内部 Web 应用程序呢？
*   不对此类应用程序或任何应用程序 使用[单元测试](http://en.wikipedia.org/wiki/Unit_testing)是错误的吗？
*   对于不会进行单元测试的应用程序，我可能还有其他原因想要使用 MVP 吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-30T06:40:15.940

1.  一般来说，MVP 被认为是开发 GWT 应用程序的最佳实践。[在这个 Google I/O Presentation](http://www.google.com/events/io/2009/sessions/GoogleWebToolkitBestPractices.html)中可以找到应用该模式的几个原因。
2.  MVP 是有代价的，它将为您的应用程序引入更多的类和复杂性。但它也会最大限度地减少耦合，并使您的应用程序更具可测试性；因此，作为设计师，您可以决定该模式是否值得痛苦。
3.  一些方法——[比如极限编程](http://www.extremeprogramming.org/rules/unittests.html)——鼓励在软件开发过程中包含自动化测试。同样，包含测试将要求您的团队编写更多代码，但作为交换，您的代码将是健壮且值得信赖的。我强烈建议您包含单元测试，即使应用程序很小。
4.  正如我之前所说，简单的测试是 MVP 的好处之一，但它不是唯一的好处。根据[谷歌的这篇文章](https://developers.google.com/web-toolkit/articles/mvp-architecture)：

> MVP 以允许多个开发人员同时工作的方式解耦开发

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T05:58:29.093

嗯，这是主观的，设计的东西总是权衡取舍。

尽管小型应用程序的范围/大小/未来也值得商榷，但我们通常会为小型应用程序保持简单以降低复杂性或避免用佳能杀死苍蝇

但是，如果您的团队已经对 MVP 感到满意，我强烈建议您选择 MVP，因为随着规模的增加，模式将帮助您避免意大利面条式代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T08:31:46.757

我可以看到 MVP 范例的优点，但就我自己而言，我不希望在模型和 GWT 特定视图类之间有额外的表示层。我确保严格地将所有业务规则排除在视图类（UIBinder 的东西）之外，并将其放在模型类中。

同样，我将所有`GWT.create(..)`东西都排除在模型之外。这让我可以毫不费力地访问服务器端的模型类。[然后，我在我的 RPC 调用的JUnit](http://en.wikipedia.org/wiki/JUnit)测试中大量使用 SyncProxy 。

最终，当您编写富 Web 客户端时，您不能过多地依赖视图的自动化测试，尤其是当它由为各种平台（即浏览器）生成的代码呈现时。布丁的证据在于 Internet Explorer、Firefox 和 Chrome 的制作方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-30T05:50:26.627

不使用 MVP 并不一定意味着不可测试。您始终可以使用自动化测试工具通过 UI 测试您的应用程序，但这些工具更难编写且更脆弱。如果您的应用程序很复杂，或者您需要维护它，那么从长远来看，使其可进行单元测试将是值得的。

# java - System.out.println('teststring') 如何在控制台上打印值？哪种本机方法正在完成实际工作？

> ID：10378921
> 
> 赞同：2
> 
> 时间：2012-04-30T05:32:03.523
> 
> 标签：java

`System.out.println()`我正在搜索在控制台上打印参数值的java 源代码。我检查了`PrintStream`和`FilterOutputStream`类`OutputStream`，它们都没有完整的方法实现，也没有任何对本机代码的引用。

值如何`System.out.println`打印在控制台上，哪个本地方法正在执行实际工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T08:52:12.140

您必须深入了解装饰器模式包装器。在底部你会发现`FileOutputStream`，特别是这个方法：

```
private native void writeBytes(byte b[], int off, int len) throws IOException; 
```

使用此代码来玩它：

```
public static void main(String[] args) throws Exception {
  nav(nav(System.out));
}

static Object nav(Object o) throws Exception {
  final Field[] fs = o.getClass().getSuperclass().getDeclaredFields();
  for (Field f : fs) {
    f.setAccessible(true);
    final Object r = f.get(o);
    System.out.println(r);
    return r;
  }
  return null;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:53:33.947

```
public static final PrintStream out 
```

“标准”输出流。此流已经打开并准备好接受输出数据。通常，此流对应于主机环境或用户指定的显示输出或另一个输出目的地。对于简单的独立 Java 应用程序，编写一行输出数据的典型方法是：

```
System.out.println(data) 
```

在哪里：

```
void println(String x) 
```

打印一个字符串，然后终止该行。

# string - 如何在jsf页面上以html格式显示字符串

> ID：10378926
> 
> 赞同：4
> 
> 时间：2012-04-30T05:32:31.180
> 
> 标签：string, jsf-2, string-formatting

我正在使用 jsf2.0。我正在制作一个电子邮件应用程序，我正在调用 Web 服务来读取文件的内容，并使用 SAX 解析器从文件中提取内容以读取文件。我将该内容存储在字符串变量中并在setter方法中设置它。并将其显示在 outputLabel 中。现在，问题是当内容显示在 jsf 页面中时，它没有以正确的格式显示。它显示在一行中。但是当我在视图源中看到当时页面的视图源时，它会以正确的格式显示。那么，解决方案应该是什么。请回复我。提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-30T05:49:42.247

看看`h:outputText`'s `escape`flag set to 是否`false`可以帮助你。

> escape：此属性设置一个布尔标志值，用于确定是否应在组件生成的输出中转义敏感的 HTML 和 XML 字符。它的默认值为“真”。

（来自[这里](http://www.roseindia.net/jsf/outputText.shtml)的描述）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T19:00:26.813

`white-space`将父元素的 CSS属性设置为`pre`.

例如

```
<h:outputText value="#{bean.xml}" styleClass="preformatted" /> 
```

和

```
.preformatted {
    white-space: pre;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T06:04:24.083

我认为`<pre>...</pre>`你的文本周围的好旧 html 会显示你喜欢的文本（假设它是没有标记的纯文本）。

# java - ECPoint 到 BigInteger 的转换

> ID：10378929
> 
> 赞同：1
> 
> 时间：2012-04-30T05:32:47.090
> 
> 标签：java, bouncycastle, elliptic-curve

谁能帮我解决这个问题？我需要将公钥转换为`BigInteger`. 这里的公钥是`ECPoint`曲线上的一个点`(x,y)`。我不知道如何将其转换为`BigInteger`. 请帮我。这是我的代码：

```
public static void main(String[] args) throws  Exception {
    Security.addProvider(new BouncyCastleProvider());
    ECCurve curve = new ECCurve.Fp(
        new BigInteger("883423532389192164791648750360308885314476597252960362792450860609699839"), // q
        new BigInteger("7fffffffffffffffffffffff7fffffffffff8000000000007ffffffffffc", 16), // a
        new BigInteger("6b016c3bdcf18941d0d654921475ca71a9db2fb27d1d37796185c2942c0a", 16)); // b

    ECParameterSpec ecSpec = new ECParameterSpec(
        curve,
        curve.decodePoint(Hex.decode("020ffa963cdca8816ccc33b8642bedf905c3d358573d3f27fbbd3b3cb9aaaf")), // G
        new BigInteger("883423532389192164791648750360308884807550341691627752275345424702807307")); // n
    KeyPairGenerator kpg = KeyPairGenerator.getInstance("ECDSA", "BC");
    kpg.initialize(ecSpec, new SecureRandom());
    KeyPair keyPair = kpg.generateKeyPair();
    PublicKey pubKey = keyPair.getPublic();
    System.out.println(pubKey);
    PrivateKey privKey = keyPair.getPrivate();
    System.out.println(privKey);
    BigInteger s = ((ECPrivateKey) privKey).getS();
    System.out.println(s);
    java.security.spec.ECPoint a = ((ECPublicKey) pubKey).getW();
} 
```

# .net - Delphi 7 - 免注册 COM 激活

> ID：10378934
> 
> 赞同：0
> 
> 时间：2012-04-30T05:33:23.767
> 
> 标签：.net, delphi, com, delphi-7, dllregistration

我有一个 Delphi 客户端 (exe) 和 .NET COM dll，我试图在不需要注册 dll 的情况下运行它们。我已按照[此处](https://stackoverflow.com/questions/5074563/registration-free-com-dll)的步骤进行操作，并且我的 Delphi 客户端可以正常编译。但是，我不是 Delphi 专家，我无法弄清楚如何在 Deplhi 中使用该对象。以链接到的 Skype4COM.dll 示例为例，我将如何从 Delphi 7 访问 dll 及其方法？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T05:55:21.180

*这不是答案，但我想包含一个代码示例，这是我知道 Stack Overflow 上的唯一方法。*

如果它可能对您有所帮助，这里有一个示例，说明我们如何在 SxS 中部署的一个 VB6 项目中包含对 MS Flex Grid 控件的引用。客户端是 AbbottMST.exe，COM 服务器是 MSTEngine.dll，这是来自客户端清单文件 AbbottMST.exe.manifest 的精简示例。

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
    <assemblyIdentity type="win32" name="AbbottMST" version="4.0.0.7"/>
    <dependency>
        <dependentAssembly>
            <assemblyIdentity type="win32" name="MSTEngine" version="4.0.0.4"/>
        </dependentAssembly>
    </dependency>
    <file name="msflxgrd.ocx">
        <comClass clsid="{6262D3A0-531B-11CF-91F6-C2863C385E30}"
            tlbid="{5E9E78A0-531B-11CF-91F6-C2863C385E30}"
            progid="MSFlexGridLib.MSFlexGrid.1"
            description="Microsoft FlexGrid Control, version 6.0 (SP6)"
        />
    </file>
</assembly> 
```

请注意，如果您包含清单，那么您*必须*将其部署为并排。对于这个项目，我们需要一个不支持 SxS 的 Windows 2000 的普通注册版本和一个 XP 的并行版本。绑定了此清单的 EXE 版本将不会在非 SxS 安装中运行。（可能有一些我们不知道的魔法咒语，但那是我们的经验。）

# matlab - 矩阵操作的问题

> ID：10378935
> 
> 赞同：0
> 
> 时间：2012-04-30T05:33:27.757
> 
> 标签：matlab, matrix, sparse-matrix

我有两个矩阵 A 和 B 以及一个矩阵 C

C=A/B

现在我想取 C 的导数，即

```
(B*dA/dx - A*dB/dx)/B^2 
```

我不确定上面会是什么样子。我发现某个地方看起来像

```
(B/B)*((dA/dx)/B) - (A/B)*(dB/dx)/B 
```

我很困惑我可以执行什么样的操作。我可以这样做吗

```
(B/B^2) * (dA/dx) - (A/B^2)*(dB/dx) 
```

我尝试了以上两个，他们给了我不同的结果。我不确定允许哪些操作，尤其是在矩阵的情况下，尤其是乘法和除法。那么有人可以澄清一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T07:52:07.100

我假设您的矩阵`A`和`B`大小相同，并且都是正方形。如果不是这种情况，请告诉我。

在这种情况下，`A/B`与 是一样的`A * inv(B)`。为了区分这一点，您使用正常的 Leibniz 规则进行区分，注意保持产品的顺序相同（因为矩阵乘法不会对易）：

```
d/dx (A * inv(B)) = dA/dx * inv(B) + A * d(inv(B))/dx 
```

如果您查看[维基百科](http://en.wikipedia.org/wiki/Invertible_matrix#Derivative_of_the_matrix_inverse)，您会发现矩阵逆的导数是

```
d(inv(B))/dx = -inv(B) * dB/dx * inv(B) 
```

所以对于你得到的产品的衍生物

```
d/dx (A * inv(B)) = dA/dx * inv(B) - A * inv(B) * dB/dx * inv(B) 
```

`inv(B)`您可以将两边的乘法分解出来，给出

```
d/dx (A * inv(B)) = (dA/dx - A * inv(B) * dB/dx) * inv(B) 
```

你现在可能想使用 Matlab 的左右除法运算符来编写表达式，给出

```
d/dx (A/B) = (dA/dx - (A/B) * dB/dx) / B 
```

这是你能做到的最简洁的。通常，您不希望任何`A`, `B`,`dA/dx`或`dB/dx`相互通勤，因此您不能再简化此操作。当然，如果在您的应用程序中，您*确实*有某些理由认为这些矩阵中的某些矩阵将始终通勤，那么进一步的简化可能是可能的。

# jaxb - 如何使用 JAXB 按特殊顺序制作 @XmlAttribute？

> ID：10378936
> 
> 赞同：7
> 
> 时间：2012-04-30T05:33:32.613
> 
> 标签：jaxb, xml-attribute

我有一个元素中需要 3 个属性的 XML 文件。如何按照我的意愿制作街道、邮编和城市属性的顺序？

```
<address street="Big Street" zip="2012" city="Austin">
</address> 
```

```
@XmlType(name="Street)
@XmlRootElement(name = "Street")
public class Street {

@XmlAttribute
private String name;

@XmlAttribute
private String type;

    ... set and get method
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-13T23:28:13.197

有趣的是，这些属性似乎与代码中提到的顺序相反。就我而言，我使用了两个变量（名称和值），我必须将它们声明为：

```
// The inverse order of name & value seems to make them render in XML in name/value order
@XmlAttribute
protected String value;
@XmlAttribute
protected String name; 
```

生成 XML 时，会产生以下结果：

```
<attribute name="nameValue" value="valueValue"/> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-30T05:46:06.430

您可以使用[@XmlAccessorOrder](http://docs.oracle.com/javaee/5/api/javax/xml/bind/annotation/XmlAccessorOrder.html)（具有预定义值）或[@XmlType](http://docs.oracle.com/javaee/6/api/javax/xml/bind/annotation/XmlType.html)（仅适用于属性）来管理排序。

[样品](http://docs.oracle.com/cd/E19355-01/819-3669/bnbcz/index.html)

编辑 ：

对于自定义订购，JAXB 规范不提供任何东西，但如果您的 JAXB 提供者为您提供一些功能，您可以这样做。

找到了这个[链接](https://forums.oracle.com/forums/thread.jspa?threadID=975397)，它谈到了使用 EclipseLink JAXB 进行排序。

# ruby - 如何使用 hadoop 流和 ruby mappers/reducers 设置分布式 map-reduce 作业？

> ID：10378937
> 
> 赞同：0
> 
> 时间：2012-04-30T05:33:36.130
> 
> 标签：ruby, hadoop, hadoop-streaming

我能够运行使用 ruby​​ 和输入文件构建的本地映射器和减速器。

不过，我不清楚分布式系统的行为。

对于生产系统，我在两台机器上设置了 HDFS。我知道如果我在 HDFS 上存储一个大文件，它会在两台机器上都有一些块以允许并行化。我是否还需要在 HDFS 上存储实际的映射器和减速器文件（在这种情况下是我的 ruby​​ 文件）？

另外，我将如何实际运行流式作业，以便它在两个系统上以并行方式运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T03:45:32.780

如果您要使用用 ruby​​（或 Java 以外的任何东西）编写的 mapper/reducers，则必须使用 hadoop-streaming。在将作业发送到集群时，Hadoop 流有一个选项来打包您的映射器/减速器文件。以下链接应该有您要查找的内容。

[http://hadoop.apache.org/common/docs/r0.15.2/streaming.html](http://hadoop.apache.org/common/docs/r0.15.2/streaming.html)

# google-api - 是否有公开的谷歌日历 API 密钥？

> ID：10378940
> 
> 赞同：0
> 
> 时间：2012-04-30T05:33:46.123
> 
> 标签：google-api, google-calendar-api

我想分享一个使用谷歌日历 api V3 提要制作的自定义日历应用程序的示例和代码，但我不想用我的 api 密钥显示我的日历。是否有公开的谷歌日历和 API 密钥？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T05:43:10.087

Google API 密钥不属于 Google Calendar API 等独特服务，它适用于使用您的帐户激活的所有服务。

# objective-c - Phonegap 应用程序中的 UIWebOverflowScrollView 异常

> ID：10378946
> 
> 赞同：0
> 
> 时间：2012-04-30T05:34:53.303
> 
> 标签：objective-c, html, jquery-mobile, cordova

我正在使用 jQuery mobile 为 iPad 开发 Phonegap 应用程序。我的应用程序运行良好。但有时它会给出这个例外。

“-[UIWebOverflowScrollView _viewDelegate]：消息发送到释放的实例 0x8f2cb70”

有谁知道这是什么原因？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-30T05:59:40.907

似乎你过早地释放了一些东西，你可以使用启用 Zombie 的分配工具来找出那个对象是什么。你在 iOS >= 5.0 上吗？

# java - 匹配标签内的内容

> ID：10378948
> 
> 赞同：0
> 
> 时间：2012-04-30T05:35:06.503
> 
> 标签：java, regex, pattern-matching

我需要从输入文件中解析一些字符串。Hadoop 中需要这些字符串。问题是，这些字符串在标记标签中。

有人可以建议我一个模式，以匹配和存储它们

```
<id>INIcE89C561</id>  <id>INIcE89C560</id>  <id>Q1S5WLipQW2</id> 
```

我需要 id 标签之间的字符串。所有标签都来自不同的输入文件。我需要将它们用作价值。在键值对中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T05:40:55.013

要获取 id 标签之间的文本，您可以使用以下内容：

```
<id>([^<]*)</id> 
```

然后提取第一个捕获的组（这是您的值）。

然而，一般来说，正则表达式并不是解析 XML 的最佳选择。

我推荐使用更适合的 XML 解析器。

例如看一下[本](http://www.mkyong.com/tutorials/java-xml-tutorials/)教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:41:29.483

你可以尝试使用类似这样的东西：`<id>(.*?)</id>`. 这应该匹配`<id>`和`</id>`标签之间的所有字符。但问题可能是正则表达式捕获的文本组很可能会被正则表达式捕获的下一组文本覆盖，这意味着到一天结束时，您将只有最后一组匹配的文本。

我建议您首先将这些按空格字符拆分（假设您获得的文本与您作为示例发布的文本相同），然后将正则表达式应用于各个块。此外，如果有比这更多的标签，我建议您使用其他方式来提取您的信息，因为正则表达式并非完全设计用于从标记语言中提取信息。

# html - 我如何将这个 html 翻译成剃须刀？

> ID：10378952
> 
> 赞同：1
> 
> 时间：2012-04-30T05:35:52.040
> 
> 标签：html, razor

我想使用剃刀语法复制以下 html：

```
<a href="index.html" data-description="I Want This Description">Home</a> 
```

我知道我会为链接这样做：

```
@Html.ActionLink("Home", "Index", "Home") 
```

如何在 "data-description="I Want This Description"" 上方的 html 标记中添加信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:51:29.083

您可以通过添加包含匿名对象的参数来添加 html 属性，该匿名对象包含您想要的属性和值。

```
@Html.ActionLink("Home", "Index", "Home", new { data_description = "I want this desription" }) 
```

注意下划线而不是连字符。显示视图时，MVC 会自动将下划线替换为连字符。

# objective-c - 使用 Accelerate Framework 的 iOS 的 FFT 音高检测？

> ID：10378953
> 
> 赞同：7
> 
> 时间：2012-04-30T05:36:06.947
> 
> 标签：objective-c, ios, signal-processing, fft, accelerate-framework

我已经阅读了一段时间的 FFT 和音高检测，但我无法将它们拼凑在一起。

我已经发现 Accelerate 框架可能是最好的方法，我已经阅读了来自苹果的示例代码，了解如何将它用于 FFT。如果我想实时运行音高检测，FFT 的输入数据是什么？我只是从麦克风传入音频流吗？我该怎么做？

另外，在获得 FFT 输出后，如何从中获得频率？我一直在到处阅读，但找不到任何例子或解释？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-30T08:24:10.800

频率和音高不是一回事——频率是一个物理量，音高是一种心理感知——它们是相似的，但有重要的区别，这对你来说可能很重要，也可能无关紧要，这取决于你所使用的乐器类型试图测量音高。

您需要阅读一些关于各种音高检测算法（以及音高本身的含义）的信息，确定您要使用的算法，*然后*才开始实施它。[有关音高](https://en.wikipedia.org/wiki/Pitch_%28music%29)和音高检测的详细概述，请参阅[此 Wikipedia 页面](https://en.wikipedia.org/wiki/Pitch_detection)（请注意，您可以将 FFT 用于基于自相关和频域的方法）。

至于使用 FFT 来识别频谱中的峰值及其相关频率，在 SO 上已经有很多与此相关的问题和答案，例如：[如何获取 FFT 中每个值的频率？](https://stackoverflow.com/questions/4364823/how-to-get-frequency-from-fft-result/4371627#4371627)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T23:20:52.420

我有一个适用于 ios 5.1 的自相关函数的示例实现。查看[这篇文章](https://stackoverflow.com/a/11042610/1457445)以获取有关如何找到最近的音符以及如何创建表示音高的字符串（A、A#、B、B# 等）的实现和函数的链接

虽然 FFT 在许多应用中非常有用，但如果您尝试进行简单的音高检测，它可能不是最准确的。（它可以一样准确，但你必须处理复数才能进行大量相位计算）

# for-loop - Big-O 和通用时间单位？

> ID：10378956
> 
> 赞同：1
> 
> 时间：2012-04-30T05:36:36.657
> 
> 标签：for-loop, big-o

我有这两个问题，我认为我理解如何回答（问题后的答案）。我只是想看看我是否理解时间复杂度计算以及如何找到 BigO。
泛型只是表达式右侧每个值的乘积。
BigO 是多项式中的最大幂。这种思维方式正确吗？

```
int sum = 0;
for (int i = 0; i < n; i++)
   for (int j = 0; j < n * n; j++)
      for (int k = 0; k < 10; k++)
         sum += i; 
```

这段代码需要多少个通用时间单位？n(n^2)*10 这段代码的大运行时间是多少？O(n^3)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:54:44.920

是的。基本上，大 O 的定义表明您的时间单位（正如您所说的那样）从上面受到一个常数时间的限制，您的表达式从某个（任意高）自然数到无穷大。在更数学的符号中，这是：

如果存在一个常数 C 和一个数 N 使得 f(n) < C*g(n) 对于所有 n > N，则函数 f(n) 是 O(g(n))。

在您的上下文中，f(n) = n(n^2)*10 和 g(n) = n^3。

顺便说一句，你也可以说函数是 O(n^4)。您可以使用大 theta 符号来表示这也是下限：f(n) 是 $\theta(n^3)。

在此处查看更多信息：[https ://en.wikipedia.org/wiki/Big_O_notation](https://en.wikipedia.org/wiki/Big_O_notation)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T05:47:36.987

是的，你的理解是正确的。但有时你也必须处理对数项。查看对数项的方法可以将其视为 n^(1+epsilon)。其中 epsilon 是一个小量。

# javascript - Firefox 不在 iframe 中加载本地文件

> ID：10378965
> 
> 赞同：4
> 
> 时间：2012-04-30T05:38:09.310
> 
> 标签：javascript, html, firefox, iframe

我有一个文件

> file:///C:/Users/7%20Legged%20Spider/Desktop/test.html

当我将它设置为 iframe

> <iframe src="file:///C:/Users/7%20Legged%20Spider/Desktop/test.html">

iframe 是空白的，这是为什么，我该如何解决

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T05:40:45.883

这是因为安全问题。你不能以任何方式绕过它。

您不应该使用本地文件，`href`因为：

*   安全问题
*   “意外” URL（不是每个人都有 C:\）
*   如果您仅将它用于开发，您可能需要将文件上传到您的服务器以包含它。

# asp.net-mvc - 自托管 asp.net mvc

> ID：10378966
> 
> 赞同：39
> 
> 时间：2012-04-30T05:38:26.577
> 
> 标签：asp.net-mvc, self-hosting

是否可以在另一个应用程序中自行托管 asp.net mvc，即。控制台、Windows 窗体、服务等。

我想构建一个提供 Web 界面来控制它的应用程序，并且我想将 asp.net mvc 用于它的 Web 部分。

我确实快速浏览了一下 Nancy，它看起来可以工作，虽然它不是 asp.net mvc，但它确实支持 razor，尽管它对它的支持水平与 asp.net 不完全相同（例如，强类型视图)

我确实也发现了这个问题，但它并没有真正深入了解 [可能在没有 IIS 的情况下使用 ASPNET MVC2？](https://stackoverflow.com/questions/4795717/possible-to-use-aspnet-mvc2-without-iis)

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-04-30T05:53:18.777

您可以使用“IIS 7.0 Hostable Web Core”并将 Web 服务器托管为任何用户进程的一部分，甚至是控制台应用程序。好处是它与完整的 IIS（包括配置等）非常相似，但 Web 服务器本身正在您的进程中运行。

看看以下文章：

1.  [使用 IIS 7.0 Hostable Web Core 在您的应用程序中托管您自己的 Web 服务器](http://blogs.msdn.com/b/carlosag/archive/2008/04/14/hostyourownwebserverusingiis7.aspx)
2.  [创建托管 Web 核心应用程序](http://msdn.microsoft.com/en-us/library/ms689327%28v=vs.90%29.aspx)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-11T08:20:04.727

请看一下[http://cassinidev.codeplex.com/](http://cassinidev.codeplex.com/) 它有很多优点，例如

*   客户端机器上不需要 IIS 7
*   支持MVC（我自己测试过）
*   与 Windows 窗体和 Web 浏览器控件配合使用，以打包为 Windows 应用程序
*   Cross Win OS 平台（Windows XP、Vista、7）我已经安装了 .NET 4 测试 XP

希望这可以帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-12-14T11:17:55.107

我知道这个问题很老，但它仍然是相关的，所以使用 .NET Core 1.0 + ASP.NET MVC 6，您可以轻松地自托管您的 MVC 应用程序。您甚至可以将 MVC 和 WebAPI 应用程序合二为一，您可以稍后再决定是否要使用 IIS、IIS Express 或 .NET Core 的自托管功能。

如果您遵循这篇文章中的 Yeoman 方法，您可以尝试一下： [https ://stackoverflow.com/a/30314393/980247](https://stackoverflow.com/a/30314393/980247)

# c++ - boost::spirit::qi 期望解析器和解析器分组意外行为

> ID：10378970
> 
> 赞同：4
> 
> 时间：2012-04-30T05:38:46.810
> 
> 标签：c++, parsing, boost, boost-spirit, boost-spirit-qi

我希望有人可以通过我在精神解析中使用`>`and运算符的无知来照亮。`>>`

我有一个有效的语法，顶级规则看起来像

```
test = identifier >> operationRule >> repeat(1,3)[any_string] >> arrow >> any_string >> conditionRule; 
```

它依赖于属性将解析值自动分配给融合适应的结构（即提升元组）。

但是，我知道一旦我们匹配了 operationRule，我们必须继续或失败（即我们不想让回溯尝试其他以 开头的规则`identifier`）。

```
test = identifier >> 
           operationRule > repeat(1,3)[any_string] > arrow > any_string > conditionRule; 
```

这会导致一个神秘的编译器错误 ( `'boost::Container' : use of class template requires template argument list`)。Futz 绕了一下，编译如下：

```
test = identifier >> 
           (operationRule > repeat(1,3)[any_string] > arrow > any_string > conditionRule); 
```

但属性设置不再起作用 - 我的数据结构在解析后包含垃圾。这可以通过添加类似的动作来解决`[at_c<0>(_val) = _1]`，但这似乎有点笨拙 - 以及根据 boost 文档使事情变慢。

所以，我的问题是

1.  是否值得防止回溯？
2.  为什么需要分组运算符`()`
3.  我上面的最后一个示例是否真的在匹配后停止回溯`operationRule`（我怀疑不是，似乎如果`(...)`失败回溯中的整个解析器将被允许）？
4.  如果上一个问题的答案是/no/，我该如何构造一个规则，如果`operation`/not/匹配则允许回溯，但一旦操作/is/匹配则不允许回溯？
5.  为什么分组运算符会破坏属性语法 - 需要操作？

我意识到这是一个相当广泛的问题 - 任何指向正确方向的提示都将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T20:56:46.010

1.  **是否值得防止回溯？**

    绝对地。一般来说，防止回溯是提高解析器性能的一种行之有效的方法。

    *   减少使用（负）前瞻（运算符！，运算符 - 和一些运算符＆）
    *   排序分支（运算符 |、运算符 ||、运算符^ 和某些运算符 */-/+），以便最频繁/最可能的分支首先排序，或者最昂贵的分支最后尝试

    使用期望点 ( `>`) 并不会从本质上减少回溯：*它只会禁止它*。这将启用有针对性的错误消息，防止无用的“解析为未知”。

2.  **为什么我需要分组`operator ()`**

    我不知道。[我从这里使用我的](https://stackoverflow.com/questions/9404189/detecting-the-parameter-types-in-a-spirit-semantic-action/9405265#9405265)[助手](https://stackoverflow.com/questions/9404189/detecting-the-parameter-types-in-a-spirit-semantic-action/9405265#9405265)进行了检查[`what_is_the_attr`](https://stackoverflow.com/questions/9404189/detecting-the-parameter-types-in-a-spirit-semantic-action/9405265#9405265)

    *   `ident >> op >> repeat(1,3)[any] >> "->" >> any`
        综合属性：

        ```
        fusion::vector4<string, string, vector<string>, string> 
        ```

    *   `ident >> op > repeat(1,3)[any] > "->" > any`
        综合属性：

        ```
        fusion::vector3<fusion::vector2<string, string>, vector<string>, string> 
        ```

    我还没有发现*需要*使用括号对子表达式进行分组（东西编译），但显然`DataT`需要修改以匹配更改后的布局。

    ```
    typedef boost::tuple<
        boost::tuple<std::string, std::string>, 
        std::vector<std::string>, 
        std::string
    > DataT; 
    ```

下面的完整代码显示了我希望如何使用适应的结构来做到这一点。

1.  **我上面的例子在 operationRule 匹配后真的停止回溯吗（我怀疑不是，似乎如果 (...) 内的整个解析器失败，回溯将被允许）？**

    绝对地。如果未满足期望，`qi::expectation_failure<>`则抛出异常。默认情况下，这会*中止*解析。您可以将 qi::on_error 用于`retry`、`fail`或. MiniXML[例子有很好的例子来使用期望点](http://www.boost.org/doc/libs/1_41_0/libs/spirit/doc/html/spirit/qi/tutorials/mini_xml___error_handling.html#spirit.qi.tutorials.mini_xml___error_handling.on_error)`accept``rethrow`[`qi::on_error`](http://www.boost.org/doc/libs/1_41_0/libs/spirit/doc/html/spirit/qi/tutorials/mini_xml___error_handling.html#spirit.qi.tutorials.mini_xml___error_handling.on_error)

2.  **如果上一个问题的答案是/no/，** ~~我该如何构造一个规则，如果操作是/not/匹配则允许回溯，但一旦操作/is/匹配则不允许回溯？~~

3.  **为什么分组运算符会破坏属性语法 - 需要操作？**

    它不会破坏属性语法，它只是改变暴露的类型。因此，如果您将适当的属性引用绑定到规则/语法，则不需要语义操作。现在，我觉得应该有办法不用 grouping ~~，所以让我试试（最好在你的简短自包含样本上）。~~ *事实上，我发现没有这种需要*。我添加了一个完整的示例来帮助您了解我的测试中发生了什么，而不是使用语义操作。

## 完整代码

完整的代码展示了 5 个场景：

*   选项 1：没有期望的原创

    *（无相关变化）*

*   选项2：有期望

    *对 DataT 使用修改后的 typedef（如上图）*

*   选项 3：适应结构，没有期望

    *使用带有 BOOST_FUSION_ADAPT_STRUCT 的用户定义结构*

*   选项 4：适应结构，有期望

    *从选项 3 修改适应的结构*

*   选项 5：前瞻黑客

    *这个利用了一个**“聪明的”（？）hack**，通过将所有内容都`>>`变成预期，并事先检测到`operationRule`-match 的存在。这当然不是最理想的，但允许您保持不变`DataT`，并且不使用语义操作。*

显然，`OPTION`在编译之前定义为所需的值。

```
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/karma.hpp>
#include <boost/spirit/include/phoenix.hpp>
#include <boost/fusion/adapted.hpp>
#include <iostream>

namespace qi    = boost::spirit::qi; 
namespace karma = boost::spirit::karma; 

#ifndef OPTION
#define OPTION 5
#endif

#if OPTION == 1 || OPTION == 5 // original without expectations (OR lookahead hack)
    typedef boost::tuple<std::string, std::string, std::vector<std::string>, std::string> DataT;
#elif OPTION == 2 // with expectations
    typedef boost::tuple<boost::tuple<std::string, std::string>, std::vector<std::string>, std::string> DataT;
#elif OPTION == 3 // adapted struct, without expectations
    struct DataT
    {
        std::string identifier, operation;
        std::vector<std::string> values;
        std::string destination;
    };

    BOOST_FUSION_ADAPT_STRUCT(DataT, (std::string, identifier)(std::string, operation)(std::vector<std::string>, values)(std::string, destination));
#elif OPTION == 4 // adapted struct, with expectations
    struct IdOpT
    {
        std::string identifier, operation;
    };
    struct DataT
    {
        IdOpT idop;
        std::vector<std::string> values;
        std::string destination;
    };

    BOOST_FUSION_ADAPT_STRUCT(IdOpT, (std::string, identifier)(std::string, operation));
    BOOST_FUSION_ADAPT_STRUCT(DataT, (IdOpT, idop)(std::vector<std::string>, values)(std::string, destination));
#endif

template <typename Iterator>
struct test_parser : qi::grammar<Iterator, DataT(), qi::space_type, qi::locals<char> >
{
    test_parser() : test_parser::base_type(test, "test")
    {
        using namespace qi;

        quoted_string = 
               omit    [ char_("'\"") [_a =_1] ]             
            >> no_skip [ *(char_ - char_(_a))  ]
             > lit(_a); 

        any_string = quoted_string | +qi::alnum;

        identifier = lexeme [ alnum >> *graph ];

        operationRule = string("add") | "sub";
        arrow = "->";

#if OPTION == 1 || OPTION == 3   // without expectations
        test = identifier >> operationRule >> repeat(1,3)[any_string] >> arrow >> any_string;
#elif OPTION == 2 || OPTION == 4 // with expectations
        test = identifier >> operationRule  > repeat(1,3)[any_string]  > arrow  > any_string;
#elif OPTION == 5                // lookahead hack
        test = &(identifier >> operationRule) > identifier > operationRule > repeat(1,3)[any_string] > arrow > any_string;
#endif
    }

    qi::rule<Iterator, qi::space_type/*, qi::locals<char> */> arrow;
    qi::rule<Iterator, std::string(), qi::space_type/*, qi::locals<char> */> operationRule;
    qi::rule<Iterator, std::string(), qi::space_type/*, qi::locals<char> */> identifier;
    qi::rule<Iterator, std::string(), qi::space_type, qi::locals<char> > quoted_string, any_string;
    qi::rule<Iterator, DataT(),       qi::space_type, qi::locals<char> > test;
};

int main()
{
    std::string str("addx001 add 'str1'   \"str2\"       ->  \"str3\"");
    test_parser<std::string::const_iterator> grammar;
    std::string::const_iterator iter = str.begin();
    std::string::const_iterator end  = str.end();

    DataT data;
    bool r = phrase_parse(iter, end, grammar, qi::space, data);

    if (r)
    {
        using namespace karma;
        std::cout << "OPTION " << OPTION << ": " << str << " --> ";
#if OPTION == 1 || OPTION == 3 || OPTION == 5 // without expectations (OR lookahead hack)
        std::cout << format(delimit[auto_ << auto_ << '[' << auto_ << ']' << " --> " << auto_], data) << "\n";
#elif OPTION == 2 || OPTION == 4 // with expectations
        std::cout << format(delimit[auto_ << '[' << auto_ << ']' << " --> " << auto_], data) << "\n";
#endif
    }
    if (iter!=end)
        std::cout << "Remaining: " << std::string(iter,end) << "\n";
} 
```

所有选项的输出：

```
for a in 1 2 3 4 5; do g++ -DOPTION=$a -I ~/custom/boost/ test.cpp -o test$a && ./test$a; done
OPTION 1: addx001 add 'str1'   "str2"       ->  "str3" --> addx001 add [ str1 str2 ]  -->  str3 
OPTION 2: addx001 add 'str1'   "str2"       ->  "str3" --> addx001 add [ str1 str2 ]  -->  str3 
OPTION 3: addx001 add 'str1'   "str2"       ->  "str3" --> addx001 add [ str1 str2 ]  -->  str3 
OPTION 4: addx001 add 'str1'   "str2"       ->  "str3" --> addx001 add [ str1 str2 ]  -->  str3 
OPTION 5: addx001 add 'str1'   "str2"       ->  "str3" --> addx001 add [ str1 str2 ]  -->  str3 
```

# appcelerator - 在 appcelerator 中使用 3rd 方模块时，在 ios 设备上安装失败并出现回溯错误

> ID：10378971
> 
> 赞同：0
> 
> 时间：2012-04-30T05:38:47.660
> 
> 标签：appcelerator

“在 ios 设备上安装”对于我的其他项目来说工作正常。但在这个项目中，它因回溯错误而失败。

> [错误] [错误]错误：回溯（最近一次调用最后）：文件“/Library/Application Support/Titanium/mobilesdk/osx/1.8.2/iphone/builder.py”，第1440行，在主execute_xcode（“iphoneos %s" % iphone_version,args,False) 文件 "/Library/Application Support/Titanium/mobilesdk/osx/1.8.2/iphone/builder.py", 第 1200 行，在 execute_xcode 输出 = run.run(args,False,错误，o) 文件“/Library/Application Support/Titanium/mobilesdk/osx/1.8.2/iphone/run.py”，第 39 行，运行 sys.exit(rc) SystemExit: 1

我正在使用 AGCalendar 3rd 方 ios 模块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T19:24:56.330

此问题已在最新版本中修复，如果您还没有，请继续从 github 下载。

# javascript - 如何在....仍然允许滚动时停止页面滚动？

> ID：10378972
> 
> 赞同：5
> 
> 时间：2012-04-30T05:39:01.430
> 
> 标签：javascript, jquery, cordova, scroll, mobile-application

我正在用 PhoneGap 制作一个移动应用程序。我有这个——

```
function preventBehavior(e)
{
e.preventDefault();
};
document.addEventListener("touchmove",preventBehavior, false); 
```

您知道如何通过拖动将页面从智能手机屏幕上拖出一小段距离，然后当您释放它时它会立即弹回？而你看到的背后都是黑色的？这就是这段代码要防止的。它确实如此。

但它也阻止了所有标准滚动，例如滚动列表。有谁知道解决方案？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-29T13:37:59.813

Cordova 1.7+ 的简单解决方案 在您的 Xcode 项目中找到 Cordova.plist。顶部会显示“UIWebViewBounce”。将此设置为否。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T06:53:00.637

你有两个选择：

1.  iScroll - 在产生这种效果方面非常有效。当然，它确实有它的局限性。

2.  -webkit-溢出滚动：触摸；在 ios 5 中引入了一种新的 css 方法，它运行良好，但在 phonegap 中也有其局限性。

我个人将 iScroll 用于 phonegap 应用程序，如果您没有超大的滚动项目列表，它会非常有用。如果您正在寻找一种更原生的方式，我建议使用溢出滚动方法，这已被证明会在 webview 中引起一些奇怪的效果。Phonegap 使用 webview 与移动 safari，因此您的支持有所不同。

iScroll - [http://cubiq.org/iscroll-4](http://cubiq.org/iscroll-4) webkit-scrolling - [http://johanbrook.com/browsers/native-momentum-scrolling-ios-5/](http://johanbrook.com/browsers/native-momentum-scrolling-ios-5/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-30T07:53:45.213

你应该在你的 head 标签中添加这个：（现在不需要你的监听器代码）

```
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" /> 
```

这基本上禁用了缩放（放大/缩小）和您不想要的拖动效果。所以页面不会滚动，但仍然可以跟踪 touchmove 事件。

# c# - C# 应用程序在启动前崩溃

> ID：10378973
> 
> 赞同：0
> 
> 时间：2012-04-30T05:39:27.827
> 
> 标签：c#, .net, monodevelop

我来找你是因为我很绝望。我使用最新的 MonoDevelop 在 C# 中开发了一个 GTK# 应用程序。它是为 .NET 框架 4.0 / x86 构建的，它使用的唯一外部库是官方的 Mysql .Net 连接器。它旨在在 Windows XP 下运行。

这是我用这个 IDE 制作的第一个应用程序。我对结果和开发时间非常满意，但部署确实令人头疼。

它在开发机器上完美运行。调试很干净。一切都好。

然后，由于找不到有关部署的任何信息，我安装了一个干净的 XP 来尝试它，看看我应该在客户端机器上安装什么。

我已经安装了 SP3、.NET 4.0 并使用构建日志中提到的所有 DLL 复制了发布包（这使它在开发机器中的 MonoDevelop 之外工作）。但是我得到一个“应用程序遇到问题需要关闭”的错误，在 kernel32.dll 中，偏移 0012aeb 无一例外。

我尝试在 4.0 之前安装 .NET 3.5，更新了 IE（以防万一……），将更多 GTK# 和 Monodevelop DLL 复制到 exe 的文件夹中，安装了 Mysql .NET 连接器，安装了 Mono 2.8……但什么都没有。仍然得到那个无法解释的错误。

Google 和 StackOverflow 搜索对我没有帮助。在过去的 12 个小时或更长时间里，我在没有离开这台机器的情况下研究并尝试了很多东西。

你有什么建议吗？可能是什么原因造成的？有什么方法可以调试exe（不安装VS ...）？有谁知道这种可执行文件的所有依赖项是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T05:48:16.350

WinDbg 可以帮助您解决一些 JIT 问题...

即使它不是直观的并且需要技能，也值得一试。可能会弹出一些东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:58:38.473

在生产机器上安装 Visual Studio 有多种选择，其中之一是[Remote Debugging Monitor](http://msdn.microsoft.com/en-us/library/xf8k2h6a.aspx)。它不需要安装 Visual Studio。您可以将文件从开发机器复制到服务器。我把它们放在下面了`C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\Remote Debugger`。

您还可以将它用于[本地构建项目的远程调试](http://msdn.microsoft.com/en-us/library/8x6by8d2.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T05:50:10.770

如果它打算在 Windows 下运行，那么您可能应该使用 Visual C# 编译器对其进行编译。

但是，与您的问题更相关 - 在您的部署机器中获取一个[调试器](http://www.mono-project.com/Debugger)并在其上运行应用程序。这是找出问题的最佳方法，因为我们真的无法猜测。

[Mono 应用程序部署指南](http://www.mono-project.com/Guidelines%3aApplication_Deployment)

# python - 国际化 html 模板的性能

> ID：10378975
> 
> 赞同：3
> 
> 时间：2012-04-30T05:39:53.537
> 
> 标签：python, internationalization, flask, template-engine, jinja2

我正在使用 Python 和 Flask 微框架编写一个 Web 应用程序。该应用程序将支持多种语言，我现在正在尝试决定如何编写启用 i18n 的 html 模板。我的模板引擎是 Jinja2（尽管在我的项目中还很早，我可以在必要时切换到其他东西）。

让我首先展示一个带有 gettext 标签的模板的示例部分：

```
{% if error %}<div class="error">{{ _(error) }}</div>{% endif %}
<h1>{{ _("Hello, World!") }}</h1> 
```

在此模板中，应用程序需要知道如何翻译两种字符串：

1.  在模板上下文中仅在运行时才知道的动态字符串（`error`字符串）
2.  随时已知的静态字符串（`"Hello, World!"`字符串）

第一种情况很容易处理。该字符串在运行时传递给 gettext 引擎以获取翻译版本。那里没有问题。

虽然可以以相同的方式处理第二种情况，但我的印象是必须有一种更有效的方式来处理这些静态字符串。我为 gettext、Babel 或 Jinja2 阅读的文档中没有提到任何关于优化静态字符串的翻译，每次需要渲染模板时都必须搜索和定位这些字符串。

我认为很有意义的一种方法是将每个模板预渲染为一组特定于语言的子模板，其中每个子模板都解析了静态字符串，只留下动态文本部分供 gettext 在运行时处理.

因此，例如，如果我想支持英语和西班牙语，我上面的模板将由某个工具离线处理，该工具将生成两个将被写入模板缓存的子模板：

模板-en.html：

```
{% if error %}<div class="error">{{ _(error) }}</div>{% endif %}
<h1>Hello, World!</h1> 
```

模板-es.html：

```
{% if error %}<div class="error">{{ _(error) }}</div>{% endif %}
<h1>¡Hola, Mundo!</h1> 
```

然后在运行时，模板引擎需要检查缓存中是否有针对所请求语言环境的特定子模板，如果找到，则渲染速度会快得多。

是否有任何框架、工具、模板引擎等实现了这样的功能？

或者有没有其他方法可以避免一遍又一遍地在翻译数据库中搜索相同的小文本片段的开销？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T06:08:47.543

您是否测量过这种“优化”对整个请求-响应周期的影响？如果你能看到任何有意义的加速，我会感到非常惊讶，尤其是在使用已知速度非常快的模板语言时，比如 Jinja2。

作为一般规则：在衡量优化的潜在收益之前永远不要优化。在这方面，直觉通常是完全错误的。当优化在代码、开发或部署中引入复杂性时尤其如此——总是衡量它是否值得麻烦。

`dict`在优化数据库查询或缓存昂贵的操作（查找，`gettext`基本上是，根本不昂贵）方面，您可能会取得更大的成功。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:45:04.740

你这样做是错的。你永远不应该 I18Nize 变量（你的第一种类型），***只有***静态文本（你的第二种类型）。您需要 I18Nize 可以使用的字符串，而`error`不是变量本身。

并且应该在消息目录（gettext）级别进行优化，而不是在您的代码中。

# android - 如何使用surfaceview播放全屏视频？

> ID：10378980
> 
> 赞同：1
> 
> 时间：2012-04-30T05:40:40.797
> 
> 标签：android, video, surfaceview

我正在使用surfaceview播放本地mp4视频这是布局

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mainLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

<SurfaceView
    android:id="@+id/surface"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >
</SurfaceView>

</FrameLayout> 
```

从代码我将全屏设置为surfaceview

```
 int height = getWindowManager().getDefaultDisplay().getHeight(); //metrics.heightPixels;
    int width = getWindowManager().getDefaultDisplay().getHeight(); //metrics.widthPixels;

    mPreview = (SurfaceView) findViewById(R.id.surface);
    LayoutParams lp = new FrameLayout.LayoutParams(width, height);

    mPreview.setLayoutParams(lp);
    holder = mPreview.getHolder();
    holder.addCallback(this);
    holder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
    //holder.setFixedSize(width, height);
    holder.setSizeFromLayout(); 
```

但是，现在的问题是视频没有全屏播放，视频上方出现黑屏。

截图[http://i.imgur.com/WNFDM.png](http://i.imgur.com/WNFDM.png) 如何播放全屏视频？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T10:41:16.197

不知道这是几岁..试试这个

```
requestWindowFeature(Window.FEATURE_NO_TITLE);  
getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN); 
```

在对活动的 onCreate 方法执行 setContentView 之前

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T06:43:59.267

尝试

```
 mPreview = (SurfaceView) findViewById(R.id.surface);
  LayoutParams lp = new FrameLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT);

    mPreview.setLayoutParams(lp);
    holder = mPreview.getHolder();
    holder.addCallback(this);
    holder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
    holder.setSizeFromLayout(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T06:06:51.233

你能试试这个。

```
 mPreview = (SurfaceView) findViewById(R.id.surface);
            holder = mPreview.getHolder();
            holder.addCallback(this); 
```

根本不要设置宽度和高度......在你的oncreate中

# perl - 为什么我得到“在减法中使用未初始化的值 $num”？

> ID：10378986
> 
> 赞同：1
> 
> 时间：2012-04-30T05:41:07.177
> 
> 标签：perl

我正在开发一个使用 XS 绑定到 C 库的 Perl 模块。当我构建它时，我收到一条警告消息说`Use of uninitialized value $num in subtraction (-) at /usr/lib/perl5/vendor_perl/5.14.2/ExtUtils/ParseXS.pm line 1769, <GEN8> line 90.`

这是由[ExtUtils::Constant](http://search.cpan.org/perldoc?ExtUtils%3a%3aConstant)生成的代码触发的。`INCLUDE: const-xs.inc`注释掉 Foo.xs 中的行会删除警告。但我不知道该错误是在[ExtUtils::ParseXS](http://search.cpan.org/perldoc?ExtUtils%3a%3aParseXS)中还是在 ExtUtils::Constant 中。

我正在使用 ExtUtils::Constant 0.23、ExtUtils::ParseXS 3.15、Module::Build 0.38 和 Perl 5.14.2。

我已经设法将它缩减为一个不需要任何外部 C 库的相当[小的测试用例，但它仍然太大，无法在此处发布。](https://github.com/madsen/ParseXS-ExtUtils-Constant-bug)我已经把它放在了[GitHub repo](https://github.com/madsen/ParseXS-ExtUtils-Constant-bug)中。要重现该错误，请克隆存储库，`perl Build.PL`然后键入`./Build`. 你应该看到：

```
$ perl Build.PL
Regenerating constants...
Created MYMETA.yml and MYMETA.json
Creating new 'Build' script for 'Foo' version '0.01'
$ ./Build 
Building Foo
Use of uninitialized value $num in subtraction ...
gcc ... -o lib/Foo.o lib/Foo.c
ExtUtils::Mkbootstrap::Mkbootstrap('blib/arch/auto/Foo/Foo.bs')
gcc ... -o blib/arch/auto/Foo/Foo.so lib/Foo.o 
```

如果您安装了 ExtUtils::Constant，您只会看到“正在重新生成常量...”。您不需要它来重现错误，因为我已将生成的文件添加到存储库中。

无论问题是什么，它似乎都不会阻止代码工作，因为包含的测试确实通过了。

**更新：**我已将此报告为[RT#112776](https://rt.perl.org/rt3/Ticket/Display.html?id=112776)。共识似乎是它是 ExtUtils::ParseXS 中的一个错误，但解决方案尚不清楚。

# php - 检查 Javascript 并将其重定向到另一个页面

> ID：10378991
> 
> 赞同：4
> 
> 时间：2012-04-30T05:42:58.673
> 
> 标签：php, javascript, html

我想检查是否启用了 Javascript。如果启用，则显示其余代码，但如果禁用，它将重定向到 google.com

现在，该怎么做？我正在尝试编写以下代码：

```
<script type="text/javascript">
document.write("Hello World!")
</script>
<noscript>Your browser does not support JavaScript!
<p>JS must be enabled</p>
<META HTTP-EQUIV=Refresh CONTENT="3; URL='www.google.com'">
</noscript>
<p>this code must be hidden when JS is disabled</p> 
```

但结果是：

```
Your browser does not support JavaScript!
JS must be enabled
this code must be hidden when JS is disabled 
```

我想要的是，如果没有启用 JS，则 noscript 之外的代码将不会运行，因此，在示例中它会是这样的：

```
Your browser does not support JavaScript!
JS must be enabled
(go to google) 
```

信息：我正在使用 PHP

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T05:52:36.473

我认为您的代码是正确的，请更改

```
<META HTTP-EQUIV=Refresh CONTENT="3; URL='www.google.com'">
this to
<META HTTP-EQUIV=Refresh CONTENT="3; URL='http://www.google.com'"> 
```

使用**http://**

对于内容隐藏，使用 body 类并将其属性设置为不显示，并使用 jquery 函数添加显示块以显示内容，jquery 函数仅在启用 javascript 时才有效。所以内容在 javascript 禁用模式下被禁用。

例如。，

```
<style>
.test
{
  display:none;
}
</style>
<script>
$(document).ready(function(){
    $(".test").show();
});
</script>
<p class="test">The section should hidden for javascript disabled mode</p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T05:56:34.467

你可以这样做：

```
<noscript>Your browser does not support JavaScript!
<p>JS must be enabled</p>
<META HTTP-EQUIV=Refresh CONTENT="3; URL='http://www.google.com'"> <!- Note: remind to put the http:// prefix -->
</noscript>
<body style="display:none">
--- YOUR CONTENT HERE ---
--- USE JAVASCRIPT TO MAKE THE BODY VISIBLE ---
</body> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T06:00:10.907

使用 JavaScript 重定向到您想要的页面更容易（并且符合标准）。如果未启用 JavaScript，它只会`<noscript>`在页面上加载信息，因为 JavaScript 无法重定向。

# css - 当 Twitter Bootstrap 未修复导航栏内容时将其居中？

> ID：10378993
> 
> 赞同：3
> 
> 时间：2012-04-30T05:43:02.933
> 
> 标签：css, twitter, twitter-bootstrap, centering

我正在尝试将“内容”集中在导航栏上。当它是“navbar-fixed-top”时，UL 菜单居中。但是，由于我不想将菜单固定到顶部，因此我删除了该类，但现在菜单未居中。它漂浮在左侧。它应该与容器的边缘对齐。类似于[http://twitter.github.com/bootstrap/scaffolding.html](http://twitter.github.com/bootstrap/scaffolding.html)但我不希望它被固定在顶部。

![在此处输入图像描述](../Images/8ea1337ec30cec231c1467be94f69017.png)

这是代码

```
 <div class="navbar ">
            <div class="navbar-inner">
                <div class="container" >
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="#">Project name</a>
                    <div class="nav-collapse">
                        <ul class="nav">
                            <li class="active"><a href="#">Home</a></li>
                            <li><a href="#about">About</a></li>
                            <li><a href="#contact">Contact</a></li>
                        </ul>
                    </div><!--/.nav-collapse -->
                </div>
            </div>
        </div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-18T11:28:07.983

使用`navbar-static-top`.

如果它不起作用，请查看最新的引导程序版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T07:28:30.273

这曾经是默认行为，至少它在 2.0.1 中有效，但似乎在最新版本中发生了一些变化，因此当导航栏不固定时，导航栏内容不再居中。

解决方法似乎是将以下内容添加到您的 CSS 中：

```
.navbar-inner > .container { width:940px; } 
```