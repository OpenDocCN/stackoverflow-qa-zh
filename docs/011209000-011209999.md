# StackOverflow 问答 11209000-11209999

# php - 选择选项更改的不同验证规则 [Yii]

> ID：11209000
> 
> 赞同：1
> 
> 时间：2012-06-26T13:58:38.340
> 
> 标签：php, ajax, yii, validation

我有以下情况： 我想通过 AJAX 验证一个表单。此表单的第一个字段是一个带有两个选项的选择元素。当用户更改选择元素值时，验证规则会更改。我在控制器中添加了以下功能：

```
protected function performAjaxValidation($model)
{
    if(isset($_POST['ajax']) && $_POST['ajax']==='inquilini-form')
    {
                    $model->scenario = $_POST['Inquilini']['tipo'];
                    //$model->save();
        echo CActiveForm::validate($model);
        Yii::app()->end();
    }
} 
```

模型是`Inquilini`，选择元素是`tipo`，我只是在值更改时更改场景，但随后没有应用 AJAX 验证！没有添加任何 CSS`error`或`success`类！

有人能帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T05:59:56.207

好吧，我想您需要在您`Form` `'enableAjaxValidation'=>true` 的进一步详细信息中执行以下操作，请参阅[如何使用 AJAX 表单验证](http://learnyii.blogspot.com/2010/12/yii.html)

# c# - C# MS Access 查询返回字符串聚合

> ID：11209002
> 
> 赞同：0
> 
> 时间：2012-06-26T13:58:41.517
> 
> 标签：c#, string

我的数据库中有 [Customer] 和 [Car] 表之间的一对多关系，其中一个客户可能拥有零辆或多辆汽车。

我的项目要求我输出所有客户的列表，其中有一列显示来自汽车的车辆登记 [VehicleReg]。如果客户有多辆汽车，他们的所有车辆登记必须用逗号分隔。如果客户没有汽车，则该列应为空白。

这是查询的基础，但我不知道如何返回注册号。

SELECT [Customer].[FirstName], [CustomerLastName], **COMMA SEPARATED VEHICLE REGS** FROM [Customer] LEFT JOIN [Car] ON [Customer].[CustomerId] = [Car].[fkCustomerId]

我正在寻找的输出是这样的

```
FirstName   | LastName    | VehicleRegistrations
-------------------------------------------------
John        | Smith       | MY51 4RT
Joe         | Mason       | MU08 5TH
Connor      | Norman      |
Graham      | Naughton    | HT09 6TY, HT11 8UQ
Lilly       | Adams       | JK55 8HY 
```

我正在使用 MS Access 1997 数据库、C# 和 .NET 4.0。

在这个阶段，性能不是主要问题。

到目前为止，我唯一可行的解​​决方案是将车辆登记保存到 [Customer] 表中的列中。虽然这会起作用，但它将涉及手动使新列与 [Car] 表中对车辆登记所做的任何更改保持同步，这并不太难，但一旦我将项目传递给其他人，这可能是一种危险的方法维持。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:36:05.187

你需要一个辅助函数来实现这个

```
Public Function JoinFromRecordset( _
    DataSource As String, Optional Delimiter As String = ";", _
    Optional Columns As Long = 1) As String

    Dim db As DAO.Database, rs As DAO.Recordset, s As String, col As Long

    Set db = CurrentDb
    Set rs = db.OpenRecordset(DataSource, dbOpenForwardOnly)
    Do Until rs.EOF
        For col = 0 To Columns - 1
            If s = "" Then
                s = Nz(rs(col))
            Else
                s = s & Delimiter & Nz(rs(col))
            End If
        Next col
        rs.MoveNext
    Loop
    rs.Close: Set rs = Nothing
    db.Close: Set db = Nothing
    JoinFromRecordset = s
End Function 
```

现在你可以写

```
SELECT FirstName, CustomerLastName,
    JoinFromRecordset('SELECT VehicleReg FROM Car WHERE fkCustomerId=' & 
        CustomerId) As VehicleRegistrations
FROM Customer 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:58:08.953

我将保持数据库原样并在您的应用程序中运行报表操作，类似于我在下面所做的操作，使用 Northwind 数据库并将客户加入订单，订单 ID 代替您的注册号。

创建两个类：

```
public class Customer
{
    public string Name { get; set; }
    public IEnumerable<Order> Orders { get; set; }
}

public class Order
{
    public int Id { get; set; }
} 
```

为您的数据创建一个数据集，其中包含客户和订单的数据表以及外键上的表之间的关系。我使用了一个类型化的数据集来自动创建适配器，但如果你手动滚动，同样的原则也适用。

创建一个 ViewModel 类来获取数据并对其进行排列。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace SO_StringAggregate
{
    public class ViewModel
    {
        public ViewModel()
        {
            // populate the data set
            var dataSet = new NorthwindDataSet();
            using (var customersAdp = new NorthwindDataSetTableAdapters.CustomersTableAdapter())
            using (var ordersAdp = new NorthwindDataSetTableAdapters.OrdersTableAdapter())
            {
                customersAdp.Fill(dataSet.Customers);
                ordersAdp.Fill(dataSet.Orders);
            }

            // populate your domain objects
            var customers = dataSet.Customers.ToArray().Select(cust => new Customer
            {
                Name = cust.Company_Name,
                Orders = cust.GetOrdersRows().Select(order => new Order { Id = order.Order_ID })
            });

            this.Customers = customers;

            // build the report
            StringBuilder report = new StringBuilder();
            string formatString = "{0,-30}|{1}";

            report.Append(string.Format(formatString, "Name", "Order Ids"));
            report.Append(Environment.NewLine);
            Customers.ToList().ForEach(cust => report.AppendLine(string.Format(
                formatString, 
                cust.Name, 
                string.Join(",", cust.Orders.Select(o => o.Id).ToArray()))
                ));

            // display the report
            Report = report.ToString();
        }

        public IEnumerable<Customer> Customers { get; set; }

        public string Report { get; set; }

    }
} 
```

然后，您可以在绑定到 Report 属性的视图中显示数据。

```
<Window x:Class="SO_StringAggregate.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <TextBox FontFamily="Consolas" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Text="{Binding Report}" />
    </Grid>
</Window> 
```

# javascript - 有什么理由从外部调用 Backbone.View.render？

> ID：11209003
> 
> 赞同：1
> 
> 时间：2012-06-26T13:58:43.417
> 
> 标签：javascript, backbone.js, backbone-views

以下似乎是在 Backbone.js 中创建小型子视图的一种非常常见的模式`this.$el.append(new ListItem({...}).render().el)`：

我只能想到外部原因调用的问题`render`，例如尚未获取视图的数据。这就是为什么我让视图处理它自己的渲染。我在这里错过了什么吗？

编辑：伪代码示例（省略无关代码等）以澄清事情：

为什么要`render`显式调用以下内容：

```
var FruitView = Backbone.View.extend({
  render: function() {
    this.$el.html(...);
  }
});

var FruitListView = Backbone.View.extend({
  render: function() {
    this.collection.each(function(fruit) {
      this.$el.append(new FruitView({...}).render().el);
    });
  }
}); 
```

而不是这个 where`FruitView`负责自己的渲染：

```
var FruitView = Backbone.View.extend({
  initialize: function() {
    this.render();
  },

  render: function() {
    this.$el.html(...);
  }
});

var FruitListView = Backbone.View.extend({
  render: function() {
    this.collection.each(function(fruit) {
      this.$el.append(new FruitView({...}).el);
    });
  }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:10:37.670

父视图可能绑定到一个集合，并且每个“行”都绑定到一个模型。

所以实例化和渲染视图并不重要，只要你有一个重新渲染集合'reset'和'add'的绑定（或一个单独的函数，用于在'add'上附加一个新的渲染行）和一个重新例如，在“更改”行上呈现绑定。

在最常见的情况下，我猜如果集合是空的，那么您的代码行所在的循环甚至都不会运行。然后集合将“重置”，视图将第一次呈现数据。

然而，和往常一样，我可能错过了重点；-) 今天下午我会看这个帖子，看看你有什么笔记

**编辑**

我明白你的意思了。我真的不明白为什么。我想我通常只是用另一种方式写，因为这是我第一次接触它时看到的很多模式。

正如您所说 - 所有数据/加载/绑定问题都不会涉及。

我想在 init() 上不 render() 的唯一原因是你有时想在不渲染的情况下初始化？

# asp.net - 如何在 ASCX 用户控件中设置控件焦点？

> ID：11209004
> 
> 赞同：0
> 
> 时间：2012-06-26T13:58:43.417
> 
> 标签：asp.net

如何在 Asp.Net 用户控件（ascx 文件）上设置控件焦点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T13:49:10.073

属性示例：

ASCX 的 CS 文件：

```
public partial class MyAscxControl : System.Web.UI.UserControl
{
    // add a property to the ascx control  
    public WebControl MyTextbox 
    { 
        get
        {
            return txtMyTextbox; // the control's id on your ASCX page
        } 
    }
} 
```

包含 ASCX 控件的页面的 CS 文件：

```
protected void Page_Load(object sender, EventArgs e)
{
    yourAscxControlId.MyTextBox.Focus();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:00:15.063

从用户控件公开属性/控件。在父页面上访问它并设置调用 .Focus() 函数。

例如

```
((TextBox)userControl.FindControl("TextBox1")).Focus(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:44:53.733

或者只是 TextBox1.Focus() 如果你想在后面的控制代码中使用它:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-17T17:11:58.463

如果你想从客户端...

```
$("#id").focus(); 
```

# javascript - jQuery Source File 一起运行；我该怎么办？

> ID：11209007
> 
> 赞同：1
> 
> 时间：2012-06-26T13:58:45.987
> 
> 标签：javascript, jquery, formatting

所以我的主管参加了这个与我们行业相关的会议，并带着所有这些新的和令人兴奋的材料回来（她是那个兴奋的人）。其中一部分是一组 jQuery 源文件（我在 jScript 方面的经验很少，更不用说 jQuery），并希望我在我们的环境中实现它。这是我如何收到代码的片段：

```
(function(a,b){function cg(a){return d.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cd(a){if(!bZ[a]){var b=d("<"+a+">").appendTo("body"),c=b.css("display");b.remove();if(c==="none"||c==="")c="block";bZ[a]=c}return bZ[a]}function cc(a,b){var c={};d.each(cb.concat.apply([],cb.slice(0,b)),function(){c[this]=a});return c}function bY(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function bX(){try{return new a.XMLHttpRequest}catch(b){}}function bW(){d(a).unload(function(){for(var a in bU)bU[a](0,1)})}function bQ(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var e=a.dataTypes,f={},g,h,i=e.length,j,k=e[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h==="string"&&(f[h.toLowerCase()]=a.converters[h]);l=k,k=e[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=f[m]||f["* "+k];if(!n){p=b;for(o in f){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=f[j[1]+" "+k];if(p){o=f[o],o===!0?n=p:p===!0&&(n=o);break}}} 
```

此文件中不存在格式。 **是否有任何工具至少可以格式化此代码？（换行符、制表符等。）** 当然，我很确定提供的示例可能是一个 jQuery 库源文件，但即使是附带的自定义代码也是如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:01:55.380

您正在查看的代码是缩小的源代码，如果您想要非缩小的源代码，则必须从 CDN 或[http://jQuery.com](http://jQuery.com)本身之一获取它。( [http://code.jquery.com/jquery.js](http://code.jquery.com/jquery.js) )

如果您想开始学习 jquery，我建议您从[http://www.learningjquery.com/](http://www.learningjquery.com/)开始，然后从初学者类别中进行一些演示。

编辑：实际上......很多这些演示可能已经过时了。它们至少会向您展示概念，但是在最新版本中可能存在一些语法差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:19:34.333

[您可以通过http://jsbeautifier.org](http://jsbeautifier.org)在线美化 javascript

# java - 在 jsf 支持 bean 和模型之间传递会话

> ID：11209009
> 
> 赞同：0
> 
> 时间：2012-06-26T13:58:56.550
> 
> 标签：java, session, jsf

*   *背景*：

我有支持 bean，它具有在文件上传时侦听的上传方法。现在我将此文件传递给解析器，并在解析器中对 csv 文件中存在的行进行验证检查。

如果验证失败，我必须记录信息并保存在数据库的记录表中​​。

*   *我的最终目标*：

是在日志记录bean中获取会话信息，以便我可以获取`initialContext`并调用以`ejb`将数据保存到数据库。

*   *发生了什么*：

在我的上传支持 bean 中，正在获取会话，但是当我调用解析器时，我不传递会话信息，因为我不希望解析器依赖于会话，因为我想单独对解析器进行单元测试。

所以在我的解析器中，我没有`session`信息，解析器正在调用`logging bean(just a bean with some ejb methods)`但在这个日志记录 bean 中，我需要会话，因为我需要获取`initial context`.

**问题**

1.  在 JSF 中有没有一种方法可以让我得到`session`我`logging bean`的我的`upload backing bean`？

我试着做：

```
FacesContext ctx = FacesContext.getCurrentInstance();
HttpSession session = (HttpSession) ctx.getExternalContext().getSession(false); 
```

但`session`价值是`null`，更一般的问题是：

1.  如何在模型 bean 或从我们有会话的支持 bean 引用的其他 bean 中获取会话信息？
2.  我们在 jsf 中是否有通用方法，我们可以使用它访问整个 JSF 应用程序的会话信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T15:12:16.810

所以我做了什么来解决这个问题，

`xhtml`我将参数保存为来自like from的查询字符串`status.xhtml`

```
<h:link outcome="Log" value="${result.id}">
                <f:param name="jobid" value="${result.id}"/>
                <f:param name="userid" value="${result.userId}"/>
            </h:link> 
```

现在在我的`log.xhtml`，我有

```
<f:metadata>
<f:viewParam name="jobid" value="#{bean.jobId}"/>
<f:viewParam name="userid" value="#{bean.userId}"/>
</f:metadata> 
```

在我的`log`豆子里，我有，

```
public void init()
    {
        String userId1 = FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap().get("userid");
        String jobId1 = FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap().get("jobid");
        userId = Long.parseLong(userId1);
        jobId = Long.parseLong(jobId1);

    } 
```

Reference: [Processing Get Parameters](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#ProcessingGETRequestParameters)

# android - Android - 将视图 ID 传递给 AsyncTask

> ID：11209010
> 
> 赞同：1
> 
> 时间：2012-06-26T13:58:57.737
> 
> 标签：android, android-asynctask

我有很多关于主要活动的按钮。每个按钮都运行相同`AsyncTask`的 HTTP POST 方法，但发布不同的值（我存储在`Button.Tag`属性中）。所以我有一个`AsyncTask`所有按钮。问题是当`AsyncTask`完成他的工作时，它应该知道必须在回调中更新哪个按钮（执行的按钮`AsyncTask`）。我不想将对象（按钮实例）传递给，`AsyncTask`因为我读到系统可以在许多情况下（方向改变等）重新创建活动，所以传递给的对象`AsyncTask`可能是无效的。但是`View.ID`财产呢？它也可以在活动生命周期中由系统更改，或者我可以使用这个整数值，将它传递给`AsyncTask`并`onPostExecute`通过这个 ID 找到这个按钮（调用`findViewByID`）？

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:06:44.363

一个元素的id不能改变，因为它是Android在R.java上生成的。所以你可以使用我认为的这个值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:10:27.423

你应该在你的 AsyncTask 中有一个观察者，当你的活动消失时你可以为空。

例子

活动：

```
private List<MyAsyncTask> mMyAsyncTasks;

private void addAsyncTask(MyAsyncTask task) {
    mMyAsyncTasks.add(task);
}

public void onDestroy() {
    for(MyAsyncTask task : mMyAsyncTasks) {
        task.removeObserver();
    }
} 
```

异步任务：

```
public class MyAsyncTask extends AsyncTask<Something, Something, Something> {
    private MyAsyncTaskObserver mObserver;
    private int mButtonId;

    public MyAsyncTask(MyAsyncTaskObserver observer, int buttonId) {
        mObserver = observer;
        mButtonId = buttonId;
    }

    public void removeObserver() {
        mObserver = null;
    }

    public void onPostExecute(Something result) {
        ...
        if (mObserver != null) {
            mObserver.onMyDataAvailable(result, mButtonId);
        }
    }
} 
```

此外，您的 AsyncTask 不应该在您的 Activity 中，因为如果您的 Activity 被销毁，它可能会导致内存泄漏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T14:15:54.870

一个简单的想法是传递一个标识特定按钮的唯一值。例如，如果单击 button1，则将“button1”传递给异步任务。在执行后，我们可以使用 switch case 来更新所需的按钮。就这么简单。

编辑：最好还是使用[findViewWithTag](http://developer.android.com/reference/android/view/View.html#findViewWithTag%28java.lang.Object%29)方法来识别按钮，因为您已经将标签值发送到异步任务。在这种情况下不需要使用 switch 案例

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T14:05:18.873

是的，如果您确保您的视图都具有唯一标识符，无论是用 XML 还是代码制作 - 然后`findViewById(int id)`在 AsyncTask 完成后调用您的 ViewGroup 以获取正确的视图（`onPostExecute()`在 AsyncTask 中覆盖以确保您在 UI 线程上）。

编辑：这是假设您已经在片段/活动中创建了 AsyncTask 并且可以调用`getView()`它来获取您的层次结构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-26T14:07:24.033

如果您在活动中将异步任务作为内部类，则可以通过调用 OnPostExecute 使用整数 id 值`findViewById(int id)`。

在其他情况下，您传递持有按钮的 viewGroup。

# dns - 正在传输到新服务器/DNS...丢失

> ID：11209011
> 
> 赞同：0
> 
> 时间：2012-06-26T13:58:58.160
> 
> 标签：dns, whm, server.transfer

我必须在这里遗漏一些明显的东西。

我有一个客户目前通过雅虎进行托管。我使用 WHM 并通过 Hostgator 拥有一个经销商帐户。我设置了一个新帐户，并在帐户创建过程中输入了 URL。

问题是，它正确地创建了所有内容，但所有内容都指向旧 URL，所以没有任何效果。

例如，我安装了 Wordpress，它在“http://domainname.com/style.css”中查找 .css 文件，但它仍然指向旧位置。如果我手动将其更改为“http://newIPaddress/style.css”，它将起作用。

我忘了一步吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:07:29.980

我不得不移动一次 WP 安装，我似乎记得遇到过类似的问题。

我认为这是因为数据库中存储了对旧域的引用。

这里有一个脚本：http: [//interconnectit.com/124/search-and-replace-for-wordpress-databases/](http://interconnectit.com/124/search-and-replace-for-wordpress-databases/)这将有助于解决这个问题。

**但是请阅读下面的文档**，其中涉及一些怪癖。我认为这应该有助于解决您遇到的问题。

文档： [http ://codex.wordpress.org/Moving_WordPress](http://codex.wordpress.org/Moving_WordPress)

# javascript - 这两种模块模式之间的差异

> ID：11209012
> 
> 赞同：3
> 
> 时间：2012-06-26T13:58:58.923
> 
> 标签：javascript

这两种 JavaScript 模块模式在功能上有什么不同吗？

```
var MODULE = (function() {

    var privvy = "I'm private!";

    return {
        getPublic: function() {
            return "I'm public";
        },      
        getPriv: function() {
            return privvy;
        }       
    };
}()); 
```

和

```
var MODULE = (function() {

    var privvy = "I'm private!";

    return new function() {
        this.getPublic = function() {
            return "I'm public";
        };
        this.getPriv = function() {
            return privvy;
        };
    };
}()); 
```

我认为首先，一个具有两个公共成员的对象被显式声明然后返回。其中一个成员具有一个作为值的函数，该函数具有对“私有”变量的引用（即，闭包由立即执行的函数形成，但 getPublic() 方法在该函数完成执行后仍然可以访问该变量 -我认为）

在第二种情况下，通过匿名构造函数创建一个对象，该构造函数将两个函数分配给可公开访问的变量，IEF 创建一个闭包，以相同的方式限制对 priv 变量的访问。

这两种变化是否会产生完全相同的对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:02:52.477

它们在功能上没有什么不同。无论哪种方式，该`MODULE`对象的工作方式都相同，但首选第一种方式，因为语法更简洁。不需要`new`和`this`。

[JSLint](http://www.jslint.com/)证实了这一点。对于第二种模式，它抱怨`return new function() {`是一个“奇怪的结构”。

**编辑：**正如@zzzzBov 和@Bergi 所指出的，对象的原型存在差异。请参阅他们的答案以获取详细说明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:10:53.267

这两个版本是非常不同的。作为参考，我添加了基本格式（*版本 A*和*版本 B*）的简单示例。功能上没有显着差异，但是*版本 B*增加了一层范围：

```
var foo; //global scope
var module = (function () {
    var foo; //module scope
    return new function () {
        var foo; //inner scope
    };
}()); 
```

此外，在*版本 A*中返回的对象的原型将为`Object.prototype`，而在*版本 B*中，原型将是匿名函数的原型。

[通过对照 .检查模块的`__proto__`属性`Object.prototype`](http://jsfiddle.net/hfsw9/)可以看出这种差异。

* * *

*版本 A*本质上是以下的简写：

```
var module = (function () {
    var temp;
    temp = new Object();
    temp.foo = function () {...};
    return temp;
}()); 
```

*版本 B*本质上是以下的简写：

```
var module = (function () {
    function anon() {
        this.foo = function () {...};
    }
    return new anon();
}()); 
```

* * *

### 版本 A

```
var module = (function () {
    return {...};
}()); 
```

### 版本 B

```
var module = (function () {
    return new function () {...};
}()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T14:11:40.970

结果没有太大区别，除了第二个示例中的对象有一个（不可枚举的）原型属性“构造函数”指向该匿名函数。这意味着，您可以使用`new MODULE.constructor`.

创建单例对象时，首选第一种语法。第二个示例通常不使用`new`关键字，返回构造函数，`MODULE`以便您可以创建它的实例，可以访问所有相同的（“静态”）`priv`变量。

您可以使用另一种具有类似结果的模式：

```
var MODULE = new function() {
    var priv = "I'm private!";
    this.getPublic = function() {
        return "I'm public";
    };
    this.getPriv = function() {
        return priv;
    };
}(); 
```

它的行为更像您的第一个示例，但泄漏了一个创建新`priv`变量而不是共享静态变量的构造函数。

# javascript - Javascript：从字符串（包括查询字符串）中提取 URL 并返回数组

> ID：11209016
> 
> 赞同：11
> 
> 时间：2012-06-26T13:59:03.477
> 
> 标签：javascript, jquery, parsing, url, extract

我知道这已经被问过一千次了（道歉），但是搜索 SO/Google 等我还没有得到一个确凿的答案。

基本上，我需要一个 JS 函数，当传递一个字符串时，它会根据正则表达式识别和提取所有 URL，返回所有找到的数组。例如：

```
function findUrls(searchText){
    var regex=???
    result= searchText.match(regex);
    if(result){return result;}else{return false;}
} 
```

该函数应该能够检测并返回任何潜在的 url。我知道与此相关的固有困难/问题（右括号等），所以我觉得这个过程需要：

将字符串 ( `searchText`) 拆分为不同的部分（开始/结束），在其任一侧都没有空格或回车，从而产生不同的内容块，例如进行拆分。

对于拆分产生的每个内容块，查看它是否符合任何构造的 URL 的逻辑，即它是否包含紧跟文本的句点（限定潜在 URL 的一个不变规则）。

正则表达式应该查看句点后面是否紧跟其他文本，该类型允许用于 tld、目录结构和查询字符串，并且前面是否有 URL 允许类型的文本。

我知道可能会导致误报，但是随后将通过调用 URL 本身来检查任何返回的值，因此可以忽略它。我发现的其他函数通常也不返回 URL 查询字符串（如果存在）。

因此，从文本块中，该函数应该能够返回任何类型的 URL，即使这意味着将 will.i.am 标识为有效 URL！

> 例如。[http://www.google.com](http://www.google.com)、 google.com 、 www.google.com 、[http://google.com](http://google.com)、 ftp.google.com 、 https:// 等...及其任何带有查询字符串的派生词应该退货...

非常感谢，如果这存在于 SO 的其他地方，再次道歉，但我的搜索还没有返回它..

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-09-07T06:11:18.817

我只是使用 URI.js——让它变得简单。

```
var source = "Hello www.example.com,\n"
    + "http://google.com is a search engine, like http://www.bing.com\n"
    + "http://exämple.org/foo.html?baz=la#bumm is an IDN URL,\n"
    + "http://123.123.123.123/foo.html is IPv4 and "
    + "http://fe80:0000:0000:0000:0204:61ff:fe9d:f156/foobar.html is IPv6.\n"
    + "links can also be in parens (http://example.org) "
    + "or quotes »http://example.org«.";

var result = URI.withinString(source, function(url) {
    return "<a>" + url + "</a>";
});

/* result is:
Hello <a>www.example.com</a>,
<a>http://google.com</a> is a search engine, like <a>http://www.bing.com</a>
<a>http://exämple.org/foo.html?baz=la#bumm</a> is an IDN URL,
<a>http://123.123.123.123/foo.html</a> is IPv4 and <a>http://fe80:0000:0000:0000:0204:61ff:fe9d:f156/foobar.html</a> is IPv6.
links can also be in parens (<a>http://example.org</a>) or quotes »<a>http://example.org</a>«.
*/ 
```

*   [https://github.com/medialize/URI.js](https://github.com/medialize/URI.js)
*   [http://medialize.github.io/URI.js/](http://medialize.github.io/URI.js/)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-06-26T14:03:18.967

您可以使用来自[URI.js](http://medialize.github.com/URI.js/)的正则表达式：

```
// gruber revised expression - http://rodneyrehm.de/t/url-regex.html
var uri_pattern = /\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/ig; 
```

[String#match](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/match)和或[String#replace](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace)可能会有所帮助……</p>

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-01-10T10:37:24.123

以下正则表达式从字符串（包括查询字符串）中提取 URL 并返回数组

```
var url = "asdasdla hakjsdh aaskjdh https://www.google.com/search?q=add+a+element+to+dom+tree&oq=add+a+element+to+dom+tree&aqs=chrome..69i57.7462j1j1&sourceid=chrome&ie=UTF-8 askndajk nakjsdn aksjdnakjsdnkjsn";

var matches = strings.match(/\bhttps?::\/\/\S+/gi) || strings.match(/\bhttps?:\/\/\S+/gi); 
```

**输出：**

```
["https://www.google.com/search?q=format+to+6+digir&…s=chrome..69i57.5983j1j1&sourceid=chrome&ie=UTF-8"] 
```

**注意：** *这可以处理带有单冒号的 http:// 和带有双冒号的 http::// 字符串，反之亦然，因此您可以安全使用。:)*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-26T14:05:07.483

尝试这个

```
var expression = /[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi; 
```

你可以使用这个网站来测试正则表达式[http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-22T09:23:15.537

在 UIPath Studio 中定义了以下内置的正则表达式规则：

`/(?:(?:https?|ftp|file):\/\/|www\.|ftp\.)(?:\([-a-zA-Z0-9+&@#\/%=~_|$?!:,.]*\)|[-a-zA-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([-a-zA-Z0-9+&@#\/%=~_|$?!:,.]*\)|[a-zA-Z0-9+&@#\/%=~_|$])/`

# neo4j - Neo4j 根据关系数量删除断开连接的图

> ID：11209018
> 
> 赞同：1
> 
> 时间：2012-06-26T13:59:06.343
> 
> 标签：neo4j

我有一个图表，嗯，Neo4j 中的一系列断开连接的图表。

我想删除仅连接到另一个节点的所有节点。

所以我想摆脱这些对，但保持所有至少有 3 个节点的图以某种方式连接。

我在输入数据时使用了 get 或 create 方法，所以它应该全部被索引。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T15:13:18.520

这只是我在短时间内想出的一个解决方案。所以它可能不是最好的，但我希望你明白这个想法并可以根据你的情况进行调整。

```
TraversalDescription td = Traversal.description().depthFirst().evaluator(new Evaluator() {
        @Override
        public Evaluation evaluate(Path path) {
            if (path.length() == 1) {
                int count = 0;
                Iterator<Relationship> it = path.endNode().getRelationships().iterator();
                while (it.hasNext()) {
                    it.next();
                    count++;
                }
                if (count == 1) {
                    count = 0;
                    it = path.startNode().getRelationships().iterator();
                    while (it.hasNext()) {
                        it.next();
                        count++;
                    }
                    if (count == 1) {
                        return Evaluation.INCLUDE_AND_PRUNE;
                    } else {
                        return Evaluation.EXCLUDE_AND_PRUNE;
                    }
                } else {
                    return Evaluation.EXCLUDE_AND_PRUNE;
                }
            }
            return Evaluation.EXCLUDE_AND_CONTINUE;
        }
    });

    Traverser traverser = td.traverse(**MYNODE**); 
```

此遍历描述应返回仅包含 2 个节点的所有路径。我没有测试过它，但想法是：它检查路径（长度为 1）的开始和结束节点是否有多个关系。如果是这样，它就不可能是路径的尽头，因此不是一对。否则它将由遍历器稍后返回。有关遍历的信息，请查看[neo4j 文档](http://docs.neo4j.org/chunked/stable/tutorials-java-embedded-traversal.html)。

对于您当前的数据库布局，您必须为数据库中的每个节点执行遍历器。这通常是一种不好的做法，因为它做了很多不必要的迭代。如果你只这样做一次，它可能是暂时的解决方案。如果您想将此功能集成到您的最终应用程序中，我建议您添加一些关系（将每个集群连接到根节点）。

您可以添加从根节点 (id=0) 到数据库中每个节点的关系。然后从根节点开始，使用上面的遍历描述进行遍历（只需将 if 更改`(path.length() == 1)`为 if`(path.length() == 2)`并删除 startnode 上的计数检查）。然后，您将通过一次遍历一次获得所有路径。这要快得多。您甚至可以在之后删除这些关系。基本上你可以按照你想要的方式设计你的关系，你总是可以忽略查询或遍历中的特定关系。但有时你需要它们，以获得更好的性能和更容易的遍历描述。

希望能给你一些想法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-26T15:19:28.037

使用 Cypher，您可以通过以下查询完成您的任务：

```
start a=node(*) 
match a-[r]->b 
where length(a--()) = 1 and length(b--()) = 1 
delete a,r,b 
```

这是一个链接，您可以在其中看到它的实际效果：[http ://console.neo4j.org/r/1re6t](http://console.neo4j.org/r/1re6t)

希望这可以帮助！

# mercurial - 偶尔会出现奇怪的（错误的？）与 Tortoise-Hg 的合并行为

> ID：11209020
> 
> 赞同：0
> 
> 时间：2012-06-26T13:59:17.020
> 
> 标签：mercurial, tortoisehg, branching-and-merging

最近，我们在 Mercurial (Tortoise-Hg 2.2) 中遇到了一个奇怪的合并问题。有时，当我们在一个命名分支中合并两个头时（工作台：“与本地合并”），Tortoise-Hg 会卡在“提交合并结果”对话框中：“提交”按钮变灰，提交消息设置为“与默认值合并”（即使它不是与默认值合并）而不是“合并”。

此时似乎没有其他解决方案，只能取消合并，再次合并，丢弃现有合并，解决冲突（再次！）并提交（这次不会像上面那样卡住）。

任何想法为什么会发生这种情况和/或如何在不丢弃第一次合并的情况下解决它？

# assembly - 使用带有 Microsoft ARM 汇编器的 ARM NEON 指令的未知操作码

> ID：11209023
> 
> 赞同：1
> 
> 时间：2012-06-26T13:59:17.763
> 
> 标签：assembly, windows-mobile, arm

我正在使用 Visual Studio 2008 附带的 Microsoft ARM Assembler v15.00.20720 (armasm.exe)。我正在尝试构建一个使用 ARM Cortex-A8 NEON 指令的程序集文件，但出现“未知操作码”`VLD1`错误`VST1`说明 我的处理器是 TI OMAP 3430。

我的命令行：

```
armasm -32 -CPU ARM8 myfile.asm  myfile.obj 
```

例如：

```
VLD1.64 {d0-d3}, [r1@128]! ; unknown opcode VLD1
VST1.64 {d4-d7}, [r3@128]! ; unknown opcode VST1 
```

我该如何解决这些错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:41:29.820

VS2008 的 armasm 仅支持不包括 NEON 的 ARMv6 (ARM11) 架构。（[文档](http://msdn.microsoft.com/en-us/library/ms253568%28v=vs.90%29.aspx)说只到 v5，但我认为它在 SP1 中得到了扩展。）

对于 ARMv7，您可以使用最新的 WinCE (=Windows Embedded Compact) Platform Builder 或 Visual Studio 2012（尽管我不能 100% 确定 VS2012 是否支持以 WinCE 为目标）。

# backbone.js - Backbone：视图中的视图列表

> ID：11209030
> 
> 赞同：2
> 
> 时间：2012-06-26T14:00:01.727
> 
> 标签：backbone.js, underscore.js

让我先展示我需要什么，以便您了解我的问题。我有一个联系人视图，例如：

```
ContactView = Backbone.View.extend({
    template: _.template("Name: <%= name %>
                          E-mail: <%= email %>
                          Phones
                          <%= label1 %> - <%= number1 %>
                          <%= label2 %> - <%= number2 %>"),
    render: function() {
       var contact = this.template(this.model.toJSON());
       this.$el.html(contact);
    }
}); 
```

到目前为止一切顺利，问题是电话部分是一个列表，我的模型包含一系列电话，我需要将它动态地放入该模板中。

我的想法是为此创建另一个模型并查看 Phone 和 PhoneView。然后在 ContactView 中，我将创建一个方法 render_phones，例如：

```
render_phones: function() {
    var phones = this.model.get('phones');
    var phones_str = "";
    for (var i in phones) {
        var phone = new Phone(phones[i]);
        var phoneView = new PhoneView({model: phone});
        phones_str += phoneView.render();
    }
    return phones_str;
} 
```

我将 ContactView 模板更改为：

```
template: _.template("Name: <%= name %>
                      E-mail: <%= email %>
                      Phones
                      <%= phones %>"), 
```

**但是如何让我的渲染方法获得渲染的电话列表并放入模板中？**

我找不到处理这种情况的模式。而且代码开始看起来不太好。

ps：这只是一个例子，我的应用程序还有几个其他部分需要这个，一个需要生成包含列表内容的子视图的视图。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T14:30:47.700

看起来您正在使用 underscore.js 来呈现模板，underscore.js 提供了一种在模板中[呈现集合](http://documentcloud.github.com/underscore/#template)的方法（请看第二个示例）。例如

```
template: _.template("Name: <%= name %>
                          E-mail: <%= email %>
                          Phones
                <% _.each(phones, function (phone) { %>
                 <%= label %> - <%= number %>
                <% }); %>"), 
```

您还可以为每个模型渲染一个单独的视图，并在同一个渲染模型中修改`el`以在那里渲染它，但除非您需要该视图（例如内容将更改或您正在收听事件），否则它可能不会支付那样做。这是一个如何实现的示例

```
render: function () {
  this.$el.html(this.model.toJSON());
  _.each(this.model.get('phones'), function(phone) {
    this.$el.find('.phoneArea').append(new phoneView({model: phone}).render().el));
  },this);
  return this;
} 
```

此外，如果您要走这条路，请注意缓存视图可能会有所帮助，但如果您只需要呈现内容，那么将电话号码保留为数组并将其呈现在模板。

# html - HTML中的粗体西里尔文字

> ID：11209034
> 
> 赞同：1
> 
> 时间：2012-06-26T14:00:24.370
> 
> 标签：html, bold

我遇到的问题是西里尔文字看起来很粗体（[Example](http://postimage.org/image/qfto1rmtn/)），即使在同一个地方的其他语言都可以。这种行为的原因可能是什么？会不会是使用的字体没有这些字符并且使用了一些替代字体？或者是因为错误的字符集或其他原因（抱歉，在编码等方面我完全是菜鸟……）。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:11:10.327

正如您所怀疑的，最可能的原因是西里尔字母取自另一种字体。字体具有不同的特性，因此与另一种字体中的文本相比，一种字体中的正常粗细文本看起来很粗。

页面的 URL 会有所帮助，但图像表明字体存在差异。西里尔字母略高，形状与拉丁字母不同。例如，拉丁文“e”与西里尔文“е”不同，但在包含两者的任何合理字体中，它们是相同的。“a”同上。

解决方案是检查您的字体设置，以便您在规则中建议的所有字体都`font-family`包含拉丁字母和西里尔字母（以及您可能使用的任何其他字符）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:26:04.610

好的，您的 URL 有助于堆。

您正在使用来自 Google Font API 的 Ubuntu 字体：[http ://www.google.com/webfonts#UsePlace:use/Collection:Ubuntu](http://www.google.com/webfonts#UsePlace:use/Collection:Ubuntu)

您需要确保在您的字体中使用西里尔字母和/或西里尔字母扩展子集。

再次转到字体页面并选择正确的复选框，然后再复制脚本以包含在页面中。

检查 CSS 的 URL 是否如下所示：

`<link href='http://fonts.googleapis.com/css?family=Ubuntu:300,400,500,700,400italic&subset=latin,latin-ext,cyrillic' rel='stylesheet' type='text/css'>`

# c# - 为什么我的复选框没有注册为选中状态？

> ID：11209038
> 
> 赞同：3
> 
> 时间：2012-06-26T14:00:35.427
> 
> 标签：c#, asp.net, gridview, checkbox

我一直在努力处理 ASP .NET / C# 中 GridView 中的 CheckBox 列。完成后，此页面应显示我办公室的当前空缺职位。人们应该能够检查他们想申请的尽可能多的职位，然后继续到下一个屏幕（实际申请开始的地方）。

这是单击“立即应用”按钮时我运行的例程。在尝试了我的老板和这里的人建议的十几种其他组合后，我在这里找到了这段代码。当我运行它时，isChecked = false，因此它不会在该 if 语句中运行任何内容。我错过了一些明显的东西吗？

```
for (int i = GridView1.Rows.Count - 1; i > -1; i--)
{
    GridViewRow row = GridView1.Rows[i];
    bool isChecked = ((CheckBox)row.FindControl("cbx_apply")).Checked;

    if (isChecked)
    {
        try
        {
            Response.Write("Hello world");
            PositionsAppliedFor.Add(Convert.ToInt32((GridView1.Rows[i].Cells[1].Text)));
            Session["SelectedPositionIDList"] = PositionsAppliedFor;
        }
        catch (Exception error)
        {
            Response.Write(error.Message);
        }
    }
} 
```

编辑：另外，我意识到我在 if 语句中所做的事情并不重要。我只是想让它做 /something/。

ASP.NET：

```
<asp:GridView ID="GridView1" runat="server" 
              onselectedindexchanged="UpdateSelectedPostions">
    <Columns>
        <asp:TemplateField>
            <ItemTemplate>
                <asp:CheckBox ID="cbx_apply" runat="server" 
                              OnCheckedChanged="UpdateSelectedPostions"
                              AutoPostBack="false"/>
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

很简单，而且可能遗漏了很多。我是/非常/ ASP.NET 的新手。

这是我为网格加载数据并绑定它的地方：

```
string sqlstatement = "SELECT * FROM dbo.POSITION WHERE PositionStartDate < GETDATE() AND PositionEndDate > GETDATE()";
command = new SqlCommand(sqlstatement, connection);
ds = new DataSet();
adapter = new SqlDataAdapter(command);
builder = new SqlCommandBuilder(adapter);
adapter.Fill(ds);
GridView1.DataSource = ds.Tables[0];
GridView1.DataBind();
connection.Close(); 
```

希望这已经足够了，因为它真的是我所拥有的。我还没有在页面上放任何其他东西——只是想让这些愚蠢的复选框同意我的观点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-26T14:21:44.150

确保您的绑定代码位于这样的块中：

```
if (!Page.IsPostBack)
{

} 
```

否则，您将在每次回发时重新创建复选框，从而失去它们已被选中的事实。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-26T14:21:36.783

如果你的代码

```
string sqlstatement = "SELECT * FROM dbo.POSITION WHERE PositionStartDate < GETDATE() AND PositionEndDate > GETDATE()";
command = new SqlCommand(sqlstatement, connection);
ds = new DataSet();
adapter = new SqlDataAdapter(command);
builder = new SqlCommandBuilder(adapter);
adapter.Fill(ds);
GridView1.DataSource = ds.Tables[0];
GridView1.DataBind();
connection.Close(); 
```

在 page_load 方法中，每次您回帖时都会调用它，您应该阅读[此](http://msdn.microsoft.com/en-us/library/ms178472.aspx)内容，这将使您对此有更好的理解。

为避免每次回发时都运行此代码

```
if(!Page.IsPostBack)
{

} 
```

另外在旁注中，您正在调用 CheckChanged 和 SelectedIndexChanged 上的 UpdateSelectedPostions 您是否打算这样做？

# java - KD 树 - 最近邻算法

> ID：11209040
> 
> 赞同：2
> 
> 时间：2012-06-26T14:00:37.920
> 
> 标签：java, algorithm, data-structures, nearest-neighbor, kdtree

我不太了解[wikipedia](http://en.wikipedia.org/wiki/K-d_tree)中的 O(log n) 最近邻算法。

> 1.  …</li>
> 2.  …</li>
> 3.  该算法展开树的递归，在每个节点执行以下步骤：
>     1.  ...
>     2.  该算法检查在分割平面的另一侧是否有任何点比当前最佳点更靠近搜索点。从概念上讲，这是通过将分割超平面与搜索点周围的超球面相交来完成的，该超球面的半径等于当前最近的距离。由于超平面都是轴对齐的，因此这是一个简单的比较，以查看搜索点和当前节点的分割坐标之间的差异是否小于搜索点到当前最佳点的距离（整体坐标）。
>         1.  如果超球面穿过平面，则平面的另一侧可能有更近的点，因此算法必须从当前节点向下移动树的另一个分支以寻找更近的点，遵循与整个搜索相同的递归过程.
>         2.  如果超球面不与分割平面相交，则算法继续沿树向上走，并消除该节点另一侧的整个分支。

是 3.2 让我感到困惑，我已经看到[了这个](https://stackoverflow.com/questions/1627305/nearest-neighbor-k-d-tree-wikipedia-proof)问题。我正在用 Java 实现算法，但不确定我是否做对了。

```
//Search children branches, if axis aligned distance is less than current distance
if (node.lesser!=null) {
    KdNode lesser = node.lesser;
    int axis = lesser.depth % lesser.k;
    double axisAlignedDistance = Double.MAX_VALUE;
    if (axis==X_AXIS) axisAlignedDistance = Math.abs(lastNode.id.x-lesser.id.x);
    if (axis==Y_AXIS) axisAlignedDistance = Math.abs(lastNode.id.y-lesser.id.y);
    else if (axis==Z_AXIS) axisAlignedDistance = Math.abs(lastNode.id.z-lesser.id.z);

    //Continue down lesser branch
    if (axisAlignedDistance<=lastDistance && !set.contains(lesser)) {
        searchNode(value,lesser,set,K);
    }
}
if (node.greater!=null) {
    KdNode greater = node.greater;
    int axis = greater.depth % greater.k;
    double axisAlignedDistance = Double.MAX_VALUE;
    if (axis==X_AXIS) axisAlignedDistance = Math.abs(lastNode.id.x-greater.id.x);
    if (axis==Y_AXIS) axisAlignedDistance = Math.abs(lastNode.id.y-greater.id.y);
    else if (axis==Z_AXIS)axisAlignedDistance = Math.abs(lastNode.id.z-greater.id.z);

    //Continue down greater branch
    if (axisAlignedDistance<=lastDistance && !set.contains(greater)) {
        searchNode(value,greater,set,K);
    }
} 
```

上面的代码是否完成了算法的 3.2 方面？特别是我填充“axisAlignedDistance”变量的地方。

[您可以在此处](http://code.google.com/p/java-algorithms-implementation/source/browse/trunk/src/com/jwetherell/algorithms/data_structures/KdTree.java)找到 KDTree 的完整源代码。

感谢您的任何帮助/指点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T17:48:02.500

我正在添加这个，希望它可以帮助其他找到同样问题的人。我最终使用以下代码解决了 3.2。虽然，我不确定它是否 100% 正确。它通过了我提出的所有测试。上面的原始代码在许多相同的测试用例上都失败了。

使用点、线、矩形和立方体对象的更明确的解决方案：

```
int axis = node.depth % node.k;
KdNode lesser = node.lesser;
KdNode greater = node.greater;

//Search children branches, if axis aligned distance is less than current distance
if (lesser!=null && !examined.contains(lesser)) {
    examined.add(lesser);

    boolean lineIntersectsRect = false;
    Line line = null;
    Cube cube = null;
    if (axis==X_AXIS) {
        line = new Line(new Point(value.x-lastDistance,value.y,value.z), new Point(value.x+lastDistance,value.y,value.z));
        Point tul = new Point(Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Point tur = new Point(node.id.x,Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Point tlr = new Point(node.id.x,Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Point tll = new Point(Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Rectangle trect = new Rectangle(tul,tur,tlr,tll);
        Point bul = new Point(Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY);
        Point bur = new Point(node.id.x,Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY);
        Point blr = new Point(node.id.x,Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY);
        Point bll = new Point(Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY);
        Rectangle brect = new Rectangle(bul,bur,blr,bll);
        cube = new Cube(trect,brect);
        lineIntersectsRect = cube.inserects(line);
    } else if (axis==Y_AXIS) {
        line = new Line(new Point(value.x,value.y-lastDistance,value.z), new Point(value.x,value.y+lastDistance,value.z));
        Point tul = new Point(Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Point tur = new Point(Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Point tlr = new Point(Double.POSITIVE_INFINITY,node.id.y,Double.NEGATIVE_INFINITY);
        Point tll = new Point(Double.NEGATIVE_INFINITY,node.id.y,Double.NEGATIVE_INFINITY);
        Rectangle trect = new Rectangle(tul,tur,tlr,tll);
        Point bul = new Point(Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY);
        Point bur = new Point(Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY);
        Point blr = new Point(Double.POSITIVE_INFINITY,node.id.y,Double.POSITIVE_INFINITY);
        Point bll = new Point(Double.NEGATIVE_INFINITY,node.id.y,Double.POSITIVE_INFINITY);
        Rectangle brect = new Rectangle(bul,bur,blr,bll);
        cube = new Cube(trect,brect);
        lineIntersectsRect = cube.inserects(line);
    } else {
        line = new Line(new Point(value.x,value.y,value.z-lastDistance), new Point(value.x,value.y,value.z+lastDistance));
        Point tul = new Point(Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Point tur = new Point(Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Point tlr = new Point(Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Point tll = new Point(Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Rectangle trect = new Rectangle(tul,tur,tlr,tll);
        Point bul = new Point(Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY,node.id.z);
        Point bur = new Point(Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY,node.id.z);
        Point blr = new Point(Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY,node.id.z);
        Point bll = new Point(Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY,node.id.z);
        Rectangle brect = new Rectangle(bul,bur,blr,bll);
        cube = new Cube(trect,brect);
        lineIntersectsRect = cube.inserects(line);
    }

    //Continue down lesser branch
    if (lineIntersectsRect) {
        searchNode(value,lesser,K,results,examined);
    }
}
if (greater!=null && !examined.contains(greater)) {
    examined.add(greater);

    boolean lineIntersectsRect = false;
    Line line = null;
    Cube cube = null;
    if (axis==X_AXIS) {
        line = new Line(new Point(value.x-lastDistance,value.y,value.z), new Point(value.x+lastDistance,value.y,value.z));
        Point tul = new Point(node.id.x,Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Point tur = new Point(Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Point tlr = new Point(Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Point tll = new Point(node.id.x,Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Rectangle trect = new Rectangle(tul,tur,tlr,tll);
        Point bul = new Point(node.id.x,Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY);
        Point bur = new Point(Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY);
        Point blr = new Point(Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY);
        Point bll = new Point(node.id.x,Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY);
        Rectangle brect = new Rectangle(bul,bur,blr,bll);
        cube = new Cube(trect,brect);
        lineIntersectsRect = cube.inserects(line);
    } else if (axis==Y_AXIS) {
        line = new Line(new Point(value.x,value.y-lastDistance,value.z), new Point(value.x,value.y+lastDistance,value.z));
        Point tul = new Point(Double.NEGATIVE_INFINITY,node.id.y,Double.NEGATIVE_INFINITY);
        Point tur = new Point(Double.POSITIVE_INFINITY,node.id.y,Double.NEGATIVE_INFINITY);
        Point tlr = new Point(Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Point tll = new Point(Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY);
        Rectangle trect = new Rectangle(tul,tur,tlr,tll);
        Point bul = new Point(Double.NEGATIVE_INFINITY,node.id.y,Double.POSITIVE_INFINITY);
        Point bur = new Point(Double.POSITIVE_INFINITY,node.id.y,Double.POSITIVE_INFINITY);
        Point blr = new Point(Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY);
        Point bll = new Point(Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY);
        Rectangle brect = new Rectangle(bul,bur,blr,bll);
        cube = new Cube(trect,brect);
        lineIntersectsRect = cube.inserects(line);
    } else {
        line = new Line(new Point(value.x,value.y,value.z-lastDistance), new Point(value.x,value.y,value.z+lastDistance));
        Point tul = new Point(Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY,node.id.z);
        Point tur = new Point(Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY,node.id.z);
        Point tlr = new Point(Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY,node.id.z);
        Point tll = new Point(Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY,node.id.z);
        Rectangle trect = new Rectangle(tul,tur,tlr,tll);
        Point bul = new Point(Double.NEGATIVE_INFINITY,Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY);
        Point bur = new Point(Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY);
        Point blr = new Point(Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY);
        Point bll = new Point(Double.NEGATIVE_INFINITY,Double.POSITIVE_INFINITY,Double.POSITIVE_INFINITY);
        Rectangle brect = new Rectangle(bul,bur,blr,bll);
        cube = new Cube(trect,brect);
        lineIntersectsRect = cube.inserects(line);
    }

    //Continue down greater branch
    if (lineIntersectsRect) {
        searchNode(value,greater,K,results,examined);
    }
} 
```

我认为[这个](http://code.google.com/p/java-algorithms-implementation/source/browse/src/com/jwetherell/algorithms/data_structures/KdTree.java)更简单的代码也应该可以工作，它已经通过了与上述代码相同的所有测试。

```
int axis = node.depth % node.k;
KdNode lesser = node.lesser;
KdNode greater = node.greater;

//Search children branches, if axis aligned distance is less than current distance
if (lesser!=null && !examined.contains(lesser)) {
    examined.add(lesser);

    double p1 = Double.MIN_VALUE;
    double p2 = Double.MIN_VALUE;
    if (axis==X_AXIS) {
        p1 = node.id.x;
        p2 = value.x-lastDistance;
    } else if (axis==Y_AXIS) {
        p1 = node.id.y;
        p2 = value.y-lastDistance;
    } else {
        p1 = node.id.z;
        p2 = value.z-lastDistance;
    }
    boolean lineIntersectsCube = ((p2<=p1)?true:false);

    //Continue down lesser branch
    if (lineIntersectsCube) {
        searchNode(value,lesser,K,results,examined);
    }
}
if (greater!=null && !examined.contains(greater)) {
    examined.add(greater);

    double p1 = Double.MIN_VALUE;
    double p2 = Double.MIN_VALUE;
    if (axis==X_AXIS) {
        p1 = node.id.x;
        p2 = value.x+lastDistance;
    } else if (axis==Y_AXIS) {
        p1 = node.id.y;
        p2 = value.y+lastDistance;
    } else {
        p1 = node.id.z;
        p2 = value.z+lastDistance;
    }
    boolean lineIntersectsCube = ((p2>=p1)?true:false);

    //Continue down greater branch
    if (lineIntersectsCube) {
        searchNode(value,greater,K,results,examined);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T17:56:59.967

重要的是要注意 3 中的以下内容：

> “该**算法展开树的递归**，在每个节点执行以下步骤：”

您的实现似乎只是进行递归调用，而不是在展开递归时进行任何操作。

尽管您似乎正确地检测到了交叉点，但您并没有在递归退出（展开）时执行这些步骤。进行递归调用后，执行了 0 步（包括 3.2 步）。

> 3.2 状态：“如果超球面不与分裂平面相交，则算法继续向上走，并且该节点另一侧的整个分支被消除”

这是什么意思？到达基本情况（算法到达叶节点）后，递归开始展开。在展开每一级递归后，算法会检查子树是否可能包含更近的邻居。如果可以，则在该子树上进行另一个递归调用，如果不是，则算法继续展开（沿着树向上走）。

你应该从这个开始：

> “从根节点开始，算法递归地向下移动树，就像插入搜索点时一样”

然后开始考虑在解开递归期间要采取哪些步骤以及何时采取。

这是一个具有挑战性的算法。如果你已经完成了这个数据结构的 insert() 方法，你可以用它作为这个算法的开始框架。

**编辑：**

```
//Used to not re-examine nodes
Set<KdNode> examined = new HashSet<KdNode>(); 
```

只需在每个节点中放置一个标记，您可以将其标记为“已访问”，这可能更容易、更快，并且会使用更少的内存。理想情况下，HashSets 有一个恒定的时间查找，但实际上没有办法保证这一点。这样，您不必在每次访问时搜索一组节点。在对树进行搜索之前，您可以及时将所有这些值初始化为 false `O(N)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-09T02:39:01.977

是的，维基百科上对 KD 树中 NN（最近邻）搜索的描述有点难以理解。NN KD Tree 搜索中的很多顶级 Google 搜索结果都是完全错误的，这无济于事！

有关正确的解释/算法，请参阅[https://stackoverflow.com/a/37107030/591720](https://stackoverflow.com/a/37107030/591720)。

# fullcalendar - fullCalendar 比较时间

> ID：11209042
> 
> 赞同：1
> 
> 时间：2012-06-26T14:00:48.160
> 
> 标签：fullcalendar

在选择事件上，我将事件的开始日期和结束日期作为参数。

我也有时间清单

我想看看我列表中的任何项目是否在事件开始和结束时间之间

3 个对象采用日期格式

我如何比较日期的 3 次以查看其是否为真？？？？

```
select: function (start, end, allDay) {
        var defaultTemplate = undefined;
        $.each(jsonTimeTemplates, function(){
            templateStartTime = $.fullCalendar.parseDate(this.Start);
            templateEndTime = $.fullCalendar.parseDate(this.End);
            if(( templateStartTime.getTime() >= start.getTime()) && (  templateStartTime.getTime() <= end.getTime())){
                defaultTemplate = this;
            }
        });            
    }, 
```

在这种情况下，jsonTimeTemplates 是我的对象列表，但是当我使用 firebug 进行调试时，if 语句从不适用。

在这里，我有一个调试屏幕截图，其中我有 8:00>=8:00 && 8:00 <= 8:15 ![在此处输入图像描述](../Images/f961c73b77d61c107d4941b4ba212e66.png)

我希望日期不会在这里造成问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:14:36.607

```
function compareDates(dateFrom, dateTo){
    if ( Date.parse( dateTo ) < Date.parse( dateFrom ) )
        return true;

    return false;
} 
```

如果**dateTo**小于**dateFrom** ，此函数返回 true 。您可以使用此功能来实现您的目标。

函数调用：

```
var startDateStr = $.fullCalendar.formatDate(start, 'MM/dd/yyyy hh:mm tt');
var endDateStr = $.fullCalendar.formatDate(end, 'MM/dd/yyyy hh:mm tt');
compareDates(startDateStr, endDateStr); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:46:15.937

同时，我使用函数 gethours 和 getminutes 进行比较。但我希望有更好的方法来做到这一点

```
if( ( templateStartTime.getHours() >= start.getHours() ) && ( templateStartTime.getHours() <= end.getHours() ) &&
    (templateStartTime.getMinutes() >= start.getMinutes() ) && ( templateStartTime.getMinutes() <= end.getMinutes() ))
{
    defaultTemplate = this;
} 
```

# linux - 在 Linux 上的进程之间共享套接字

> ID：11209047
> 
> 赞同：0
> 
> 时间：2012-06-26T14:01:09.543
> 
> 标签：linux, sockets, network-programming

我有多个守护进程（一个网关和多个服务，都在同一个节点上运行），其中一些服务守护进程需要“软实时”响应网络上到达的请求，我的拱门就像我有一个网关守护进程，它根据一些协议标签将传入的数据包路由到相应的服务守护进程。服务守护进程处理请求并将响应发送回连接到网络的 gw 守护进程。一切都很好，但我没有达到“软实时”并看到滞后。

我计划以下面的方式即兴创作，在网关和服务守护进程之间共享网络连接，我将有一个通知方案，当数据包到达连接时，gw 守护进程不会从套接字中取出数据包queue 查看协议头并“通知”相应的服务守护程序“数据已到达”，服务守护程序在接收到通知时获取二进制信号量并将数据从套接字队列中取出。将有 2 个这样的信号量，一个用于写入，另一个用于读取。当服务守护进程需要发送数据时，它会抓取写入信号量并发送数据。当它收到来自网关守护进程的“数据到达”通知时，它会抓取读取的信号量并将数据从套接字中取出。

有没有人尝试过这个方案？你觉得这种方法有什么问题吗？请评论/建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T12:45:20.303

如果您想避免复制开销，您可能应该使用`splice`，而不是尝试在多个守护程序之间共享套接字。该解决方案将非常难以调试和维护。

我希望（并希望）您的网络协议有一个标头，它可以让网关轻松知道将数据包路由到哪里，然后是一个用于服务守护程序的有效负载。

在伪代码中，网关执行以下操作：

```
while (data on socket)
{
    header = read(socket, sizeof(header));

    service_socket = find_service(header);
    splice(socket, NULL, service_socket, NULL, header->payload_length, 0);
} 
```

# bash - sed 命令中的 Bash 变量

> ID：11209049
> 
> 赞同：2
> 
> 时间：2012-06-26T14:01:12.633
> 
> 标签：bash, sed, expand

我需要根据文件名递归地向多个文件添加头文件。

所以我试过：

```
for i in *file 
do     
sed -i '1 i \A;B;C;D;E;F;G;H;${i%??}' a_${i} > header_a_${i}
done 
```

问题是反映文件名称的变量没有扩展，并且在标题中我有 ${i%??} 而不是名称文件的一部分（%?? 是删除一些结尾字符）。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:02:24.913

使用双引号：

```
 sed '1 i\
A;B;C;D;E;F;G;H;'"${i%??}" a_${i} > header_a_${i} 
```

使用 -i 和重定向输出没有任何意义，所以我省略了 -i。另外，我在插入命令之后添加了一个转义的换行符。有些 sed 不需要换行符，但很多都需要。但是，为此使用 sed 似乎很奇怪。相反，只需执行以下操作：

```
for i in *file; do     
  { echo "A;B;C;D;E;F;G;H;${i%??}"; cat a_${i}; } > header_a_${i}
done 
```

# c# - 调试工作版本显示其他细节 C#

> ID：11209053
> 
> 赞同：0
> 
> 时间：2012-06-26T14:01:16.613
> 
> 标签：c#, .net

我正在通过调试测试一个函数，它向我展示了良好的结果，如果我在发布时对其进行测试，它会显示不同的结果。

这里是：

```
int index = 0;
        char[] result = new char[input.Length];
        for (int i = 0; i < input.Length; i++)
        {
            System.Random RandNum = new System.Random();
            int MyRandomNumber = RandNum.Next(0, 100);
            if ((input[i] == '|') && (MyRandomNumber < 35))
            {
                result[index++] = ' ';
            }
            else
                result[index++] = input[i];
        }
        return new string(result, 0, index); 
```

我有一个字符串，例如：“how|you're|doing|today”，我想替换 35% 的 | 带有“”（空格）的字符；

例如，在调试中它显示：你如何|今天|在发布中，或者你今天如何|你在|今天或你今天如何。

你怎么看 ？

如果您有其他建议，我愿意接受。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T14:04:44.990

您的问题几乎肯定与您创建随机数的方式有关。如果您创建一个新的 System.Random 而不向其传递种子，它将使用当前时间。如果这发生得足够快，新对象将使用相同的种子创建，因此将为每个随机数提供相同的数字。

要解决此问题，请更改您的代码，如下所示：

```
 int index = 0;
    char[] result = new char[input.Length];
    System.Random RandNum = new System.Random();
    for (int i = 0; i < input.Length; i++)
    {
        int MyRandomNumber = RandNum.Next(0, 100);
        if ((input[i] == '|') && (MyRandomNumber < 35))
        {
            result[index++] = ' ';
        }
        else
            result[index++] = input[i];
    }
    return new string(result, 0, index); 
```

也许其他人可以解释为什么这只发生在 Release 中，老实说，那部分在我头上。关于调试需要更长的时间所以种子不同的东西？

# python - 文件读取如何在 utf-8 编码中工作？

> ID：11209054
> 
> 赞同：4
> 
> 时间：2012-06-26T14:01:19.343
> 
> 标签：python, utf-8, io

对于输入文本文件，我知道 .seek 和 .tell 通常都使用字节进行操作 - 也就是说，.seek 查找与其给定参数指定的点相关的一定数量的字节，并且 .tell 返回字节数从文件开始。

我的问题是：在使用其他编码（如 utf-8）时，这是否同样有效？例如，我知道 utf-8 需要几个字节来表示某些字符。

看起来，如果这些方法在解析 utf-8 文件时仍然处理字节，则可能会导致意外行为（例如，光标可能最终位于字符的多字节编码中，或者多字节字符可能注册为几个字符）。

如果是这样，是否有其他方法可以完成相同的任务？特别是在解析文件时需要有关光标位置的字符信息。

另一方面，如果您在 open() 函数中指定编码...

> infile = 打开（文件名，编码='utf-8'）

.seek 和 .tell 的行为会改变吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:53:25.547

假设您正在使用[`io.open()`](http://docs.python.org/library/io.html#io.open)（与 builtin 不同`open()`），那么使用文本模式可以获得 a 的实例`io.TextIO`，所以这应该回答您的问题：

> 二进制存储（例如文件）上的文本 I/O 比相同存储上的二进制 I/O 慢得多，因为它意味着使用字符编解码器从 unicode 转换为二进制数据。如果您处理大量文本数据（例如非常大的日志文件），这可能会变得很明显。此外， **由于使用了重建算法，TextIOWrapper.tell() 和****TextIOWrapper.seek()**都非常慢。

 ****注意**：您还应该知道，这仍然不能保证 seek() 会跳过字符，而是 unicode 代码点（单个字符可以由多个代码点组成，例如`ą`可以写为`u'\u0105'`或`u'a\u0328'`-两者都将打印相同的字符）。

来源：[http ://docs.python.org/library/io.html#id1](http://docs.python.org/library/io.html#id1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:51:47.247

对 utf-8 编码的一些实验（在具有大量多字节字符的文件中重复查找和打印 .read(1) 方法）表明，是的，.seek() 和 .read() 在 utf-8 中的行为确实不同文件...它们不处理单个字节，而是单个字符。这包括几个简单的代码重写，以不同的模式阅读和寻找。

感谢@satuon 的帮助。**

# c# - Debug an application in production

> ID：11209057
> 
> 赞同：8
> 
> 时间：2012-06-26T14:01:28.440
> 
> 标签：c#, visual-studio, debugging, production-environment

Some weird bugs occur in production with our home-made application written in C# with the framework 3.5\. The application is logless (I know...) and the crashes don't give us usable information even in the event viewer. Further more, the error handling is poor when it exists.

Checkout the code and hunt the problem in a dev environment is **not** the solution as we don't know what the problem is.

We'd like to "debug" the application in the production environment. We're dreaming about something like using a tool with the feature of Visual Studio Debugger and ILSpy. That's, making step by step execution with deassembled code.

Well, what are the solutions when we don't have logs or error handling to debug an application in production?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-26T14:05:18.937

See [How to: Setup Remote Debugging](http://msdn.microsoft.com/en-us/library/bt727f1t%28v=vs.100%29.aspx)

Edit: After seeing some of the responses to the main response, my suggestion continues with

*   Add more Try/Catch Blocks to the code.
*   Put in more check for null variables and lists
*   Put in more error handling. Do a divide and conquer strategy for this situation. Determine where the errors reside and start putting in error handling, logging and general plumbing to facilitate better code.

If you do those items the problem in question will be resolved; for you now have the tools to track down the error(s).

# c# - DataGridView 鼠标滚轮滚动停止工作

> ID：11209059
> 
> 赞同：4
> 
> 时间：2012-06-26T14:01:31.487
> 
> 标签：c#, datagridview

我的应用程序中有一个 DataGridView，我无法使用鼠标滚轮滚动它。它以前工作得很好。我不确定我做了什么导致这种情况，因为我最近才在对代码进行多次更改后才注意到它。

我没有发布任何代码，因为有超过 2k 行，我不确定错误可能在哪里。

有什么想法可能导致这种情况吗？如果您需要任何代码，我可以在之后编辑问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-28T12:31:23.110

几乎可以肯定，因为 DataGridView 失去了焦点，所以会出现问题。这可能是因为您的表单上的另一个控件需要焦点，或者您的表单默认设置为提供不同的控件焦点。

您可以强制 DataGridView 获得焦点。如果您想模拟当鼠标悬停在控件上时启用鼠标滚轮滚动的标准 Microsoft Windows 行为，则只需使用下面的代码。

```
private void SettingsGrid_MouseEnter(object sender, EventArgs e)
{
     dataGridView1.Focus();
} 
```

如果您想滚动网格而不管哪个控件具有焦点，那么代码将与上面类似，只是稍微调整一下。

# html - 嵌入的html样式不影响表格？

> ID：11209060
> 
> 赞同：0
> 
> 时间：2012-06-26T14:01:31.543
> 
> 标签：html, css, html-table

我正在尝试使用样式来影响 html 表格中单元格的间距。我正在尝试使用边距使我的单元格仅在右侧有间距。我做错了什么，如何使用样式来影响单元格间距？

```
<html>
  <head>
    <meta http-equiv="content-type" content="text/html;charset=ISO-8859-1">

<style>
body {
  font-family: Verdana, Arial, Helvetica, sans-serif;
  font-size: 9pt;
}

table {
  font-family: Verdana, Arial, Helvetica, sans-serif;
  font-size: 9pt;
}

td {
  margin: 0px 20px 0px 0px;
  color: #585858;
}

a {
  color: #326ea1;
}
</style>

    <title>Request</title>
  </head>
  <body>

    <table border="0" cellpadding="0" cellspacing="0">
      <tbody>
        <tr>
          <td> Request ID </td>
          <td>516<br>
          </td>
        </tr>
        <tr>
          <td>Assigned<br>
          </td>
          <td>Fred Flintstone<br>
          </td>
        </tr>
        <tr>
          <td>Requestor<br>
          </td>
          <td>Bugs Bunny<br>
          </td>
        </tr>
        <tr>
          <td>Type<br>
          </td>
          <td>Construction<br>
          </td>
        </tr>
        <tr>
          <td>Location<br>
          </td>
          <td>Brazil<br>
          </td>
        </tr>
        <tr>
          <td> <br>
          </td>
          <td> <br>
          </td>
        </tr>
        <tr>
          <td style=" vertical-align: top;">Description</td>
          <td>Lorem ipsum dolor sit amet, consectetur adipisicing elit, <br>
              sed do eiusmod tempor incididunt ut labore et dolore <br>
              magna aliqua. Ut enim ad minim veniam, quis nostrud <br>
              exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. 
          </td>
        </tr>
        <tr>
          <td><br>
          </td>
          <td><br>
          </td>
        </tr>
      </tbody>
    </table>

  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:05:05.877

不幸的是，表格单元格没有边距属性，但您可以在它们上设置填充以获得所需的行为。W3Schools 有一个关于样式表的页面，可能对您有所帮助：http: [//www.w3schools.com/css/css_table.asp](http://www.w3schools.com/css/css_table.asp)

如果您将代码更改为以下内容，它应该可以工作：

```
td {
 padding: 0px 20px 0px 0px;
 color: #585858;
} 
```

您还可以在表格上设置单元格间距属性。这将在单元格边界*之间*放置空间- 但是，这会影响单元格四周的间距。

# javascript - 移动 Safari：frame.src 与 window.location

> ID：11209063
> 
> 赞同：1
> 
> 时间：2012-06-26T14:01:34.320
> 
> 标签：javascript, ios, webview, webkit

**嗨，**快速提问。

从 webview 调用本机的最佳方法是什么。**iframe**还是**window.location**？_

例如：

```
gapBridge = document.createElement("iframe");
gapBridge.setAttribute("style", "display:none;");
gapBridge.setAttribute("height","0px");
gapBridge.setAttribute("width","0px");
gapBridge.setAttribute("frameborder","0");
document.documentElement.appendChild(gapBridge);
gapBridge.src = custom + "://" + custom; 
```

或者 ：

```
window.location = custom + "://" + custom; 
```

Ps：顺便说一句，在嵌入的 webview 中更改 src 似乎不起作用。正如堆栈上的其他文章所揭示的[那样](https://stackoverflow.com/questions/6447607/mobile-safari-and-iframe-src-attribute)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T17:56:09.783

在我的情况下，iframe 似乎更好。我看到的问题`window.location`是，如果您按顺序有多个调用，浏览器将忽略一些。在使用 iframe 时，您实际上可以为每个调用创建多个 iframe。我也在延迟后删除了 iframe，因此我发现自己没有大量的空 iframe DOM。

这是我使用的功能：

```
function _callNative(url){
    var _frame = document.createElement('iframe');
    _frame.width=0; _frame.height=0;_frame.frameBorder=0;
    document.body.appendChild(_frame);
    if (url.indexOf('?') >= 0){
        url = url + "&cb=";
    }else{
        url = url + "?cb=";
    }
    _frame.src = url + Math.round(Math.random()*1e16);
    // Remove the iframe
    setTimeout(function(){document.body.removeChild(_frame);}, 2000);
} 
```

例如：

```
_callNative('native://doSomethingNative()');
_callNative('native://doSomethingElse') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-10T11:54:02.797

以下是考虑了性能的不同替代方案的概要：http: [//blog.persistent.info/2013/10/a-faster-uiwebview-communication.html](http://blog.persistent.info/2013/10/a-faster-uiwebview-communication.html) [http://blog.persistent.info/2015/08/wkwebview-communication -latency.html](http://blog.persistent.info/2015/08/wkwebview-communication-latency.html)

基本上，如果您支持 iOS 8 或更低版本，那么您最好使用`location.replace`.

如果您支持 iOS 9 及更高版本并且差异很小，您可以选择您喜欢的`location.replace`或`WKScriptMessageHandler`.

# cucumber - 钩前黄瓜中的特征和场景大纲名称

> ID：11209066
> 
> 赞同：4
> 
> 时间：2012-06-26T14:01:48.453
> 
> 标签：cucumber

如果我有一个简单的黄瓜*功能*和*场景*，像这样（示例代码来自[黄瓜维基](https://github.com/cucumber/cucumber/wiki/Scenario-outlines)）：

```
Feature: Eating cucumbers

Scenario: eat 5 out of 12
  Given there are 12 cucumbers
  When I eat 5 cucumbers
  Then I should have 7 cucumbers 
```

我知道如何在钩子中获取*功能*和*场景*名称：`before`

```
Before do |scenario|
  p [scenario.feature.name, scenario.name]
end 
```

上面的代码返回：

```
["Eating cucumbers", "eat 5 out of 12"] 
```

问题是该*功能*是否具有*场景大纲*：

```
Scenario Outline: eating
  Given there are <start> cucumbers
  When I eat <eat> cucumbers
  Then I should have <left> cucumbers

  Examples:
    | start | eat | left |
    |  12   |  5  |  7   | 
```

当我运行上面的代码时，我得到：

```
undefined method `feature' for #<Cucumber::Ast::OutlineTable::ExampleRow:0x007fb0f94a8240> (NoMethodError) 
```

如何在黄瓜钩子中获取*功能*和*场景大纲名称？*`before`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T14:01:48.813

将钩子更改`before`为此：

```
Before do |scenario|
  p [scenario.scenario_outline.feature.name, scenario.scenario_outline.name, scenario.name]
end 
```

输出：

```
["Eating cucumbers", "eating", "| 12 | 5 | 7 |"] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-08T20:15:01.077

场景.gets 应该给你功能名称。

# php - 位类型的 PDO 列没有值

> ID：11209076
> 
> 赞同：0
> 
> 时间：2012-06-26T14:02:20.713
> 
> 标签：php, pdo

我正在使用 PDO 查询我的 mysql-db，使用普通的“SELECT * FROM Invoices”查询。现在，如果我对查询结果执行 print_r，所有“位”类型的列都会得到一个空白值

```
Array
(
    [0] => stdClass Object
        (
            [ID] => 1
            [Client] => 1
            [Title] => Mars 2012
            [Issued] => 2012-04-02
            [Expiration] => 2012-04-22
            [OurReference] => 1
            [TheirReference] => 
            [Payed] => 
            [Sent] => 
        )

    [1] => stdClass Object
        (
            [ID] => 2
            [Client] => 4
            [Title] => Apputveckling
            [Issued] => 2012-04-30
            [Expiration] => 2012-05-21
            [OurReference] => 1
            [TheirReference] => 
            [Payed] => 
            [Sent] => 
        )

    [2] => stdClass Object
        (
            [ID] => 3
            [Client] => 4
            [Title] => Administration
            [Issued] => 2012-05-28
            [Expiration] => 2012-06-18
            [OurReference] => 1
            [TheirReference] => 
            [Payed] => 
            [Sent] => 
        )

) 
```

怎么可能？这是我使用的getData方法

```
public function getData($sql, $data = null)
{
    $statement = $this->query($sql, $data);
    try
    {
        $result = $statement->fetchAll();
    }
    catch(Exception $e)
    {
        echo "Error: " . $e->getMessage() . " ";
        return array();
    }

    if(count($result) > 1)
    {
        return $result;
    }
    else if(count($result) == 1)
    {
        return $result[0];
    }
    else
    {
        return array();
    }
} 
```

编辑：忘了提，这些行在数据库中的字段中确实有值

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:06:47.717

位字段映射到布尔值。布尔值`false`将`print_r`完全按照您在问题中看到的方式打印。这是一个测试脚本，显示：

```
$a = array(new stdClass());
$a[0]->Payed = false;
print_r($a); 
```

改用[var_dump](http://php.net/var_dump)，您应该能够看到每个属性的数据类型以及布尔值内容。

# html - Internet Explorer 7 textarea 字段和下拉字段

> ID：11209085
> 
> 赞同：-2
> 
> 时间：2012-06-26T14:02:38.583
> 
> 标签：html, css, internet-explorer-7

我们有一个使用 IE7 的客户，由于某种原因，下拉框和文本区域字段无法正确显示。下拉框的箭头不出现，文本区域框的右边框不显示。

适用于 IE 8/9、Chrome、FF。 **见附图**![在此处输入图像描述](../Images/19e97ed3d6eecbe6fbbc5335ec261516.png)

有谁知道是什么原因造成的，我该如何解决？

这是一个 html/php 应用程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:05:17.937

您没有包含标记，所以我们只能猜测。没有办法确定。我会检查 Firebug 中的文本框或类似的东西，看看它们是否继承了你不知道的样式。

# google-app-engine - 如何从 Google App Engine High Replication 数据存储中导出数据？

> ID：11209091
> 
> 赞同：5
> 
> 时间：2012-06-26T14:02:56.670
> 
> 标签：google-app-engine, google-cloud-datastore

我正在考虑将 Google App Engine 用于一个项目，并希望确保在我决定离开 GAE（或 GAE 关闭）时能够导出所有数据。

我搜索的关于从 GAE 导出数据的所有内容都指向[https://developers.google.com/appengine/docs/python/tools/uploadingdata](https://developers.google.com/appengine/docs/python/tools/uploadingdata)。但是，该页面包含此注释：

> 注意：本文档适用于使用主/从数据存储的应用程序。如果您的应用使用 High Replication 数据存储，则可以从应用复制数据，但 Google 目前不支持此用例。如果您尝试从 High Replication 数据存储中复制，您将在 Admin Console 中看到 high_replication_warning 错误，并且下载的数据可能不包括最近保存的实体。

问题是最近不推荐使用主/从数据存储以支持 High Replication 数据存储。我知道在一段时间内仍然支持主/从数据存储，但我对使用已正式弃用且即将淘汰的东西感到不舒服。因此，我只能使用 High Replication 数据存储，而似乎导出数据的唯一方法是上述不受官方支持的方法（因此不能保证我可以将数据取出）。

是否有任何其他（官方支持的）方法可以从 High Replication 数据存储中导出数据？如果使用 Google App Engine 意味着我的数据可能永远被锁定在那里，我会感到不舒服。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T06:37:23.260

我花了很长时间来设置从 GAE 下载数据，因为文档并不像应有的那样清晰。

如果您从 Unix 服务器中提取数据，您也许可以重用下面的脚本。

此外，如果您不提供“config_file”参数，它将提取您的所有此类数据，但采用专有格式，只能用于事后恢复数据。

```
#!/bin/sh
#------------------------------------------------------------------
#-- Param 1 : Namespace
#-- Param 2 : Kind (table id)
#-- Param 3 : Directory in which the csv file should be stored
#-- Param 4 : output file name
#------------------------------------------------------------------
appcfg.py download_data --secure --email=$BACKUP_USERID --        config_file=configClientExtract.yml --filename=$3/$4.csv --kind=$2 --url=$BACKUP_WEBSITE/remote_api --namespace=$1 --passin <<-EOF $BACKUP_PASSWORD EOF 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-27T13:43:12.707

目前应用引擎数据存储也支持另一个选项。数据备份规定可用于将选定的数据复制到 blob 存储或谷歌云存储。此功能在应用引擎控制台的数据存储管理区域下可用。如果需要，可以从 Blob 查看器或云存储中下载备份的数据。对于高复制数据存储的备份，建议在进行备份之前禁用数据存储写入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:14:37.810

您需要配置一个名为[remote_api](https://developers.google.com/appengine/docs/python/config/appconfig#Builtin_Handlers)的内置函数。[本文](https://developers.google.com/appengine/docs/python/tools/uploadingdata)包含您现在和将来下载所有数据所需的所有信息和指南。

# jquery - 当页面嵌入到 iframe 中时，Webshim polyfiller 在 IE9 上不起作用

> ID：11209092
> 
> 赞同：0
> 
> 时间：2012-06-26T14:03:00.530
> 
> 标签：jquery, html, cross-browser, modernizr, polyfills

我正在使用**Webshim polyfiller**来解析 IE7+ 上的 HTML 5 表单元素。它在 IE7 和 IE8 中运行良好，但**在 iframe 内调用页面时会在 IE9 上引发“未指定错误”。**

当 HTML 页面（使用 polyfiller.js 加载的页面）嵌入到 iframe IE9 中时，会引发“未指定错误”，并且用于输入字段类型（如数字、范围和占位符属性）的 polyfill 不起作用。当页面的 url 直接访问时，一切正常。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:08:41.790

IE9 是否需要相同的 polyfill？

您可以尝试使用条件注释添加 polyfill：

```
<!--[if lt IE9]><script src="/your-polyfill.js"></script><![endif]--> 
```

# performance - 如何估计scala中数据结构的大小？

> ID：11209101
> 
> 赞同：6
> 
> 时间：2012-06-26T14:03:24.147
> 
> 标签：performance, scala, jvm

我有一个查询返回大约 600 万行，这太大了，无法在内存中一次处理。

每个查询都返回一个 Tuple3[String, Int, java.sql.Timestamp]。我知道字符串永远不会超过 20 个字符，UTF8。

我怎样才能计算出这些元组之一的最大大小，更一般地说，我怎样才能近似这样的 scala 数据结构的大小？

我正在使用的机器上有 6Gb。但是，正在使用 scala-query 从数据库中将数据读取到 scala 的列表中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T14:22:28.947

Scala 对象遵循与 Java 对象大致相同的规则，因此有关这些的任何信息都是准确的。 [这是一个来源](http://www.javamex.com/tutorials/memory/object_memory_usage.shtml)，至少对于 32 位 JVM 来说似乎是正确的。（64 位 JVM 每个指针使用 8 个字节，这通常会产生 4 个字节的额外开销加上每个指针 4 个字节的开销——但如果 JVM 使用压缩指针可能会更少，我认为现在默认情况下它会这样做。）

我假设一台没有压缩指针的 64 位机器（最坏情况）；然后 a`Tuple3`有两个指针（16 个字节）加上一个`Int`（4 个字节）加上对象开销（~12 个字节）四舍五入到最接近的 8 或 32 个字节，加上一个额外的对象（8 个字节）作为非专用版本的存根的`Int`。（遗憾的是，如果您在元组中使用原语，它们会比使用包装版本时 占用*更多的空间。）。*`String`是 32 字节，IIRC，加上数据的数组，即 16 加上每个字符 2。 `java.sql.Timestamp`需要存储几个`Long`s （我认为是），所以这是 32 个字节。总而言之，它大约是 120 个字节加上每个字符两个，大约 20 个字符是 160 个字节。

Alternatively, see [this answer](https://stackoverflow.com/questions/52353) for a way to measure the size of your objects directly. When I measure it this way, I get 160 bytes (and my estimate above has been corrected using this data so it matches; I had several small errors before).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:15:19.050

你有多少内存可供使用？三元组的 600 万个实例真的不是很多！

每个引用都有 4 或 8 个字节的开销，具体取决于您运行的是 32 位还是 64 位（没有压缩的“oops”，尽管这是 JDK7 中 32Gb 以下堆的默认设置）。

所以你的三元组有 3 个引用（由于专业化可能会有额外的引用 - 所以你可能会得到 4 个引用），你`Timestamp`是一个围绕 a `long`（8 个字节）的包装器（引用）。您`Int`将是专门的（即底层`int`），因此这又产生了 4 个字节。字符串为 20 x 2 字节。所以你基本上有一个每行*远低于*100 字节的最坏情况；所以每 kb 10 行，每 Mb 10,000 行。因此，您可以在 1 Gb 以下的堆中轻松处理 600 万行。

坦率地说，我认为我在这里犯了一个错误，因为我们每天在这个空间中舒适地处理大约 20 个字段（包括小数、字符串等）的几百万行。

# php - PHP，迭代器接口

> ID：11209107
> 
> 赞同：-2
> 
> 时间：2012-06-26T14:03:48.170
> 
> 标签：php, interface, iterator, spl

我正在研究 PHP SPL -（标准 PHP 库），并且在理解接口迭代器时遇到了一些问题。

我正在研究这个例子：[Iterator Interface](http://pastebin.com/3CDpdUWW)。

而且我真的不明白迭代器接口如何允许我们通过类元素使用“foreach”循环运行，如果有人可以通过这段代码传递给我，我将非常感激，谢谢大家，祝你有美好的一天。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:07:03.040

该接口定义了允许您“使用 foreach 循环运行”所需的几个函数。整个想法是没有代码，只有一个接口。

手册中列出了这些功能，并且还有一个示例，其中包含如何使用它们的代码：

[http://php.net/manual/en/class.iterator.php](http://php.net/manual/en/class.iterator.php)

真的不能比这更清楚了。

# html - HTML - 如果答案字段有一些特定的单词，如何检查它

> ID：11209114
> 
> 赞同：-1
> 
> 时间：2012-06-26T14:04:12.943
> 
> 标签：html

我想制作一个网页，其中包含一些您必须回答的问题，例如：

我能赚多少钱？

答案可以是任何东西，但他的答案中必须有“钱”，例如

我赚了10块钱。

如何检查用户在答案字段中输入的文本并检查其中是否包含某些特定单词？我希望你能理解我，希望你能帮助我。如果你不明白，请问我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:09:32.927

您可以使用.search [()](http://www.w3schools.com/jsref/jsref_search.asp)：input.value.search("money")。

search 返回匹配的数量，因此您只需检查 input.value.search("money") > -1

而 .match() 返回一个匹配数组

例子：

在**HTML中**

```
<head>
...
    include jquery library
...
</head>
...
<input name="answer" type="text"/> 
```

在 .js 文件中

```
$(document).ready(function(){
    $("input").change(function(){
        if($(this).val().search("money") >= 0) ... ok
        else...
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:07:15.330

您可以使用 JavaScript 执行此操作。更具体地说，您可以使用 match 函数将输入的字符串与您提供的内容进行匹配。

```
var myString = "I earn money"; 
var matches = string.match(/money/g); 
```

返回具有匹配项的数组...如果数组元素的计数大于 0，则您有匹配项。

[Javascript 匹配](http://www.w3schools.com/jsref/jsref_match.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:07:34.363

您可以通过 PHP `preg_match(pattern, subject);` [http://php.net/manual/en/function.preg-match.php](http://php.net/manual/en/function.preg-match.php)执行此操作 。例如，您可以制作 HTML 表单，通过 从中获取价值`$_POST`，然后检查“金钱”：

```
$value=$_POST['text'];
if (preg_match("/money/", $value)) {
//do something
}

echo <<<_END
<form method="post" action="">
<input type="text" name="text" value="$value" 
<input type="submit" value="Submit"/>
</form>
_END; 
```

享受！

# python - 在python中创建所需长度的高斯滤波器

> ID：11209115
> 
> 赞同：11
> 
> 时间：2012-06-26T14:04:18.950
> 
> 标签：python, scipy

谁能建议哪个库支持创建所需长度和 sigma 的高斯滤波器？我基本上需要以下 matlab 函数的等效函数：

```
fltr = fspecial('gaussian',[1 n],sd) 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-26T14:25:37.730

您不需要用于简单一维高斯的库。

```
from math import pi, sqrt, exp

def gauss(n=11,sigma=1):
    r = range(-int(n/2),int(n/2)+1)
    return [1 / (sigma * sqrt(2*pi)) * exp(-float(x)**2/(2*sigma**2)) for x in r] 
```

注意：这将始终返回一个以 0 为中心的奇数长度列表。我想在某些情况下，您可能需要一个偶数长度的高斯函数，其值为 x = [..., -1.5, -0.5, 0.5, 1.5, ...]，但在这种情况下，你需要一个稍微不同的公式，我会把它留给你；）

具有默认值的输出示例`n = 11`，`sigma = 1`：

```
>>> g = gauss()
1.48671951473e-06
0.000133830225765
0.00443184841194
0.0539909665132
0.241970724519
0.398942280401
0.241970724519
0.0539909665132
0.00443184841194
0.000133830225765
1.48671951473e-06

>>> sum(g)
0.99999999318053079 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-26T14:09:47.293

也许`scipy.ndimage.filters.gaussian_filter`？我从未使用过它，但文档位于：[https ://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.ndimage.filters.gaussian_filter.html](https://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.ndimage.filters.gaussian_filter.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-15T16:33:47.807

试试看`scipy.ndimage.gaussian_filter`，但你真的想要内核还是也想应用它？（在这种情况下，您可以只使用此函数。）在前一种情况下，将过滤器应用于一个数组，该数组处处为 0，但中心为 1。对于更容易编写的一维情况，例如：

```
>>> ndimage.gaussian_filter1d(np.float_([0,0,0,0,1,0,0,0,0]), 1)
array([  1.33830625e-04,   4.43186162e-03,   5.39911274e-02,
         2.41971446e-01,   3.98943469e-01,   2.41971446e-01,
         5.39911274e-02,   4.43186162e-03,   1.33830625e-04]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-26T13:54:48.953

如果运行时速度很重要，我强烈建议创建一次过滤器，然后在每次迭代中使用它。不断进行优化，但几年前这大大加快了我编写的一些代码。（上面的答案显示了如何创建过滤器）。

# sas - SAS 中的日期计算

> ID：11209121
> 
> 赞同：0
> 
> 时间：2012-06-26T14:04:34.257
> 
> 标签：sas

我想将 1 天添加到任意 SAS 日期。我有以下有效的代码，但我想知道是否有对这样的日期计算的内置支持：

```
proc fcmp outlib=whatever;  
function lastDayInYear(d);  
    if datdif(d,mdy(12,31,year(d)),'ACT/365')=0 then return(1); else return(0);  
endsub;  

function advanceDate(d);
    if d=. then return(.);
    if lastDayInYear(d) then
        return(mdy(1,1,year(d)+1));
    else
        return(datejul(juldate7(d)+1));
endsub;
quit; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-26T14:29:52.260

日期只是数字，所以要提前一天，你只需，嗯，加 1。

你在哪里找到那个代码？谈论用大锤敲碎坚果......

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-26T15:51:43.163

Itzy 是对的......只需添加 1。如果您想做更高级的日期计算，您可以使用`intnx()`and`intck()`函数。

例如

```
data _null_;
  tomorrow            = date() + 1;
  same_day_next_month = intnx('month',date(),1,'same');
  first_day_next_week = intnx('week' ,date(),1,'beginning');
  last_day_of_year    = intnx('year' ,date(),0,'end');

  put _all_; 
run; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-26T14:32:02.607

在 SAS 中，没有 DATE 或 DATETIME 数据类型，此类值存储为通用数值数据类型，其中对于日期：存储的数字表示表示的日期和 1960 年 1 月 1 日之间的天数。对于日期时间，它类似，只有秒数是存储。您将在下面的代码中看到这一点。人类可读的日期、时间和日期时间表示是通过 SAS 日期/时间格式实现的。如需进一步解释，只需在网络和文档上搜索 SAS 日期即可。

回到你的问题：要在代表 DATE 的值上添加一天，只需进行数学加法：+1。

```
data _null_;
    length mydate mydatetime 8;
    mydate='1jan1960'd;
    mydatetime='1jan1960:00:00:00'dt;
    nextdate = mydate + 1;
    nextminute = mydatetime + 60;
    put mydate 8\. +4 mydate yymmdds10.;
    put nextdate 8\. +4 nextdate yymmdds10.;
    put mydatetime 12\. +4 mydatetime datetime.;
    put nextminute 12\. +4 nextminute datetime.;
run; 
```

# entity-framework - 可以通过 EF 向 DB 添加更改吗？

> ID：11209122
> 
> 赞同：1
> 
> 时间：2012-06-26T14:04:34.630
> 
> 标签：entity-framework

我有一个关于由 aspnet_regsql.exe 创建的表和存储过程的问题。设想：

1.  新的空数据库：foodb

2.  为此数据库执行脚本 aspnet_regsql.exe。

现在：我可以为这个数据库添加一个实体模型框架，并向现有实体（例如 ASPNET_Users）添加额外的实体和关联吗？

最好的祝福

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:16:36.597

所以，是的，您可以将任何数据库对象引入实体框架模型。我不起诉您为什么要这样做，因为这些东西并不是真正可以直接访问的（有 API 可以获取这些数据）。

对于您添加新关联的第二个问题，我认为您无法做到这一点。就记忆而言，EF 设计器不允许您仅连接不存在的关联。因此，您需要在 SQL Server 中实际建立关联，然后将它们导入模型中。

如果您仍在使用任何 API，我不建议您这样做，因为它可能会产生意想不到的后果。

# google-app-engine - 如何在 Google App Engine 中解决带有条件的聚合查询

> ID：11209129
> 
> 赞同：0
> 
> 时间：2012-06-26T14:04:46.783
> 
> 标签：google-app-engine, aggregate, conditional-statements, large-data-volumes

假设，在我的应用程序中，我要求用户输入一些字符串。用户可以多次输入字符串。每当任何用户输入一个字符串时，我都会将它与日期一起记录到数据库中。许多字符串可以相同，即使由不同的用户输入。在主页中，我需要提供界面，以便任何用户都可以在任何时间段（例如最近 45 天或 2012 年 1 月 10 日至 2012 年 1 月 30 日之间）查询前 n 个（例如 50 个）字符串。如果是 SQL，我可以编写如下查询：

```
select string, count(*)
from userStrings where day >= d1 and day <= d2
group by string 
order by count(*) desc
limit n 
```

对于每个用户查询，我无法在查询时处理记录 - 可能有数百万条记录。如果时间段限制不存在，我可以做这样的事情 - 为 UserString 创建一个类并为每个不同的用户字符串维护它的唯一对象，为用户输入的字符串检索相应的对象，并增加它的计数 [即使使用方法，我假设数据存储区必须处理所有 UserStrings 对象（~100000）并返回前 n 个 - 所以它本身可能是非常繁重的查询]。

我正在使用 JDO。我的明显目标是最小化应用引擎成本：CPU + 数据。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T17:39:00.643

您可以使用[App Engine 任务队列](https://developers.google.com/appengine/docs/java/taskqueue/overview)离线处理字符串。如果您需要实时答案，您可以使用 memcache 存储该词在白天输入的次数的临时记录，并在后台处理。

# ios - .xib 在 iOS 4.3 上没有正确加载，在 5.0 上可以吗？

> ID：11209131
> 
> 赞同：1
> 
> 时间：2012-06-26T14:04:51.983
> 
> 标签：ios, xcode, uiview, ios4, uiviewcontroller

我遇到了一个棘手的故障。

我有一个 .xib，它是在我创建新`UIViewController`子类时由 XCode 创建的。它有很多元素，包括一些`UIButton`s、一堆`UILabel`s、一个里面有一些其他视图的 small`UIView`以及一个`UIImageView`包含大部分透明图像的 a。

在`viewDidLoad`中，我将 的背景颜色设置为`UIImageView`使用图案图像的颜色。

当我在模拟器或我的 iPhone 4（都运行 iOS 5.1）上显示这个视图控制器时，一切都很顺利；图案背景显示，所有交互工作，等等。

然而，当我在 iOS 4.3 上进行测试时（无论是在模拟器中还是在我的 iPod Touch 2G 上），我试图基于插座（例如`[self.myBackgroundImageView setBackgroundColor...]`或`[self.mySegmentedControl setEnabled:NO]`）进行操作的一切似乎都根本不起作用。

当视图被呈现时，我正在做的唯一甚至是模糊不寻常的事情就是这样，这使得它在弹出窗口中的大小合适：

```
- (void) viewWillAppear:(BOOL)animated {        
    CGSize size = CGSizeMake(320, 480); // size of view in popover
    self.contentSizeForViewInPopover = size;

    [super viewWillAppear:animated];
} 
```

我真的想不出还有什么可能是问题所在。我已经清理，重建，所有这些东西。还是没有骰子。

有人遇到过这种情况么？

**根据 ott 的请求**更新：****

 **在 -viewDidLoad 末尾添加以下内容：

```
NSLog(@"self.myBackgroundImageView = %@ | %@", [self.myBackgroundImageView description], [[self.myBackgroundImageView backgroundColor] description]); 
```

...输出是：

**`self.myBackgroundImageView = <UIImageView: 0x6d48c80; frame = (0 0; 320 480); autoresize = RM+BM; userInteractionEnabled = NO; layer = <CALayer: 0x6d48b60>> | <UIImageView: 0x5f459b0; frame = (0 0; 320 480); autoresize = RM+BM; userInteractionEnabled = NO; layer = <CALayer: 0x5f45890>> // kCGColorSpaceModelPattern 1`**

所以……不是零。不知道这里的故事是什么。

**更新 2：** 在 iOS 4.3 中禁用 UISegmentedControl 似乎不会使其显示变暗，所以这就是那部分的内容。至于背景图案图像：我找不到对此的确认，但我开始认为这是 iOS 4 中的一个错误，它使使用图案图像 UIColor 的背景颜色无法在 UIImageView 上正确显示。如果我使 UIImageView 具有清晰的背景并将图案图像 UIColor 作为主视图的背景，则效果很好。如果有人提出解决方法，或确认这确实是 iOS 4 错误，将不胜感激。**

# php - 此数组的输出

> ID：11209132
> 
> 赞同：1
> 
> 时间：2012-06-26T14:04:52.073
> 
> 标签：php

```
array(2) {
  [0]=>
  array(4) {
    ["id"]=>
    string(1) "1"
    ["name"]=>
    string(3) "Lim"
    ["subproject_id"]=>
    string(1) "5"
    ["subproject_name"]=>
    string(4) "Mads"
  }
  [1]=>
  array(1) {
    [0]=>
    array(4) {
      ["id"]=>
      string(1) "1"
      ["name"]=>
      string(3) "Lim"
      ["subproject_id"]=>
      string(1) "4"
      ["subproject_name"]=>
      string(5) "KANYE"
    }
  }
} 
```

我怎样才能输出每个`name`and `subproject_name`？

一个简单`foreach()`的只会得到第一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:11:02.430

不知道该数组的变化有多大，但这是一个简单的解决方案。

```
foreach($array as $key => $value){

    if(!isset($value['id']))
        $value = $value[0];

    echo $value['name'];
    echo $value['subproject_name'];
} 
```

如果它越来越深，您可以使用“while”而不是“if”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:19:27.763

试试这个：

```
array_walk_recursive($array, function($item, $key) {
    if (in_array($key, array('name', 'subproject_name'))) {
        echo $item;
    }
}); 
```

见[http://php.net/manual/en/function.array-walk-recursive.php](http://php.net/manual/en/function.array-walk-recursive.php)

注意：对于 PHP 5.3.0，您可以使用[callback](http://www.php.net/manual/en/functions.anonymous.php)，在早期版本中您需要非匿名函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:08:39.243

查阅 php 文档，查找“array_walk”和“array_walk_recursive”。

# ios - iOS 应用程序变暗

> ID：11209137
> 
> 赞同：0
> 
> 时间：2012-06-26T14:05:07.657
> 
> 标签：ios, screen

很难解决的问题...这只发生在未插入的真实设备上。当我的应用程序加载到主视图时，我会显示一个等待对话框，同时一些后台线程会启动并搜索产品。这大约需要 5-7 秒。如果我加载应用程序并在大约 1-3 秒内，我关闭应用程序并转到另一个应用程序，然后返回我的应用程序，屏幕边缘变暗并且应用程序只是冻结。

我为这个屏幕变暗做了一些谷歌搜索，但找不到任何东西

该应用程序永远不会崩溃。

# jquery - 使用 jQuery 解析复杂的 XML

> ID：11209139
> 
> 赞同：1
> 
> 时间：2012-06-26T14:05:12.253
> 
> 标签：jquery, xml, parsing

我正在尝试使用以下 jQuery 解析以下 XML。页面上不显示任何内容。我知道它正在获取文件。我在网上看过，虽然有很多用 jquery 解析 xml 的例子，但没有一个看起来像这种格式。

XML:

```
<?xml version="1.0" encoding="utf-8"?>
<wcm:root xmlns:wcm="http://www.stellant.com/wcm-data/ns/8.0.0" version="8.0.0.0">

    <wcm:element name="title"></wcm:element>
    <wcm:element name="wide_image">&lt;img src=&#39;[!--$wcmUrl&amp;amp;x28;&#39;resource&amp;#39;,&amp;#39;CMS3_130980&amp;#39;&amp;amp;x29;--]&amp;#39;/&gt;</wcm:element>
    <wcm:element name="image">&lt;img src="[!--$wcmUrl('resource','CMS3_132821')--]"/&gt;</wcm:element>
    <wcm:element name="body">&lt;p&gt;
        Paragraph of text goes here.&lt;br /&gt;&lt;br /&gt;
        Paragraph of text goes here.&lt;br /&gt;&lt;br /&gt;
        Paragraph of text goes here.&lt;br /&gt;&lt;br /&gt;
        Paragraph of text goes here.&lt;br /&gt;&lt;br /&gt;
        Paragraph of text goes here.&lt;/p&gt;
</wcm:element>
</wcm:root> 
```

HTML 和 jQuery：

```
<html>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<script type="text/javascript">

$(document).ready(function () {
    $.ajax({
        type: "GET",
        url: "link_to_my_file.xml",
        dataType: "xml",
        success: parseXml
    });
});

function parseXml(xml){
    $(xml).find("wcm\\3a root").each(function(){
    alert("Test");
        $("#output").append($(this).attr("title") + "<br />");
        $("#output").append($(this).attr("wide_image") + "<br />");
        $("#output").append($(this).attr("image") + "<br />");
        $("#output").append($(this).attr("body") + "<br />");
        });
     };

</script>

<div id="output"></div>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:07:53.740

您必须在选择器中转义：[http :](http://mathiasbynens.be/notes/css-escapes) [//mothereff.in/css-escapes#1wcm%3Aroot](http://mothereff.in/css-escapes#1wcm%3Aroot)`:`

所以，而不是：

```
$(xml).find("wcm:root") 
```

采用：

```
$(xml).find("wcm\\3a root") 
```

此外，您的代码片段是无效的 JavaScript（`}`在`parseXml`函数声明后丢失）。检查您的错误控制台。

# java - Netbeans 平台应用程序中的 JavaFx 2.0 GUI

> ID：11209153
> 
> 赞同：1
> 
> 时间：2012-06-26T14:05:52.307
> 
> 标签：java, javafx-2, netbeans-platform

有没有办法在 Netbeans 平台应用程序中集成 JavaFx 2.0 GUI？我已经尝试搜索该主题，但没有找到我要查找的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:15:17.600

我对 Netbeans RCP 不是很熟悉，但它是基于 Swing 的，因此您可以像在 Swing 应用程序中嵌入它们一样嵌入 Java FX 2 组件：将 JFXPanels 用于 FX2/Swing 桥，然后将这些面板嵌入 RCP与添加 Swing 组件的方式相同。

我也看过

*   [本教程](http://netbeans.dzone.com/javafx-2-in-netbeans-rcp)，但没有尝试过
*   以及[关于 SO 的相关问题](https://stackoverflow.com/questions/10474072/using-javafx-in-a-netbeans-platform-application)。

# android - 编辑单个框时，如何防止我的 EditText 列表编辑多个框？

> ID：11209154
> 
> 赞同：2
> 
> 时间：2012-06-26T14:05:59.590
> 
> 标签：android, android-listview, android-arrayadapter, android-edittext

我正在尝试使用 EditText 控件实现 listView。问题是当我编辑其中一个字段时，视图中也修改了其他一些字段。但是，我的 Java 对象只反映了我所做的更改（而不是设置的其他 EditText）

我的安卓活动

```
public class LoanRepaymentActivity extends ListActivity implements View.OnClickListener {

private Location lastKnownLocation;
private ArrayList<CurrentRepaymentInstallment> loansForRepayment;
@Override
public void onCreate(Bundle savedInstanceState){
    lastKnownLocation = Utility.getLastKnownLocation(this);
    super.onCreate(savedInstanceState);

    Intent intent = getIntent();

    RepaymentInfo repaymentInfo = (RepaymentInfo)intent.getSerializableExtra(Constants.CURRENT_REPAYMENT_INSTALLMENT);
    loansForRepayment = repaymentInfo.getLoansForRepayment();
    boolean repaymentsNotPresent = loansForRepayment == null || loansForRepayment.isEmpty(); 
    if(repaymentsNotPresent){
        Dialog dialog = Utility.getDialogWithText(LoanRepaymentActivity.this, getText(R.string.noLoansForRepayment).toString());
        Utility.getDialogButton(dialog, LoanRepaymentActivity.this, PartnerGroupListActivity.class, intent.getStringExtra(Constants.ACECSS_TOKEN_PARAM));
        dialog.show();
    }

    ArrayAdapter<CurrentRepaymentInstallment> adapter = new LoanRepaymentListAdapter(this, loansForRepayment);

    View footer = getLayoutInflater().inflate(R.layout.loan_disbursement_footer, null);
    getListView().addFooterView(footer);

    setListAdapter(adapter);
/*       if(!repaymentsNotPresent)  {
        TextView textView = (TextView)findViewById(R.id.screenTitle);
        String currentInstallmentLabel = getText(R.string.currentInstallmentLabel).toString() + repaymentInfo.getCurrentGroupInstallment();
        textView.setText(currentInstallmentLabel);
    }*/

    Button button = (Button)findViewById(R.id.disburse);
    button.setOnClickListener(this);
} 
```

我的 XML 布局

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:orientation="vertical"
>

<TextView android:id="@+id/screenTitle" 
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" >
</TextView>

 <ListView
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_above="@+layout/loan_disbursement_footer"
     />
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:orientation="vertical" >
<TextView
    android:id="@+id/borrowerName"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@+id/label"
    android:textSize="14sp"
     >
</TextView>

<TextView
    android:id="@+id/loanAmount"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@+id/label"
    android:textSize="14sp"
     >
</TextView>

<TextView
    android:id="@+id/installmentNumber"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@+id/label"
    android:textSize="12sp"
    >
</TextView>

<TextView
    android:id="@+id/estimatedTotal"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@+id/label"
    android:textSize="12sp"
    >
</TextView>

</LinearLayout>
<EditText
    android:id="@+id/repaymentAmount"
    android:layout_width="100sp"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:inputType="numberDecimal"
    android:textSize="12sp"
     >
</EditText>
</RelativeLayout> 
```

用于设置 ListView 的自定义数组适配器

```
public class LoanRepaymentListAdapter extends ArrayAdapter<CurrentRepaymentInstallment> {

private final List<CurrentRepaymentInstallment> loansForRepayment;
private final Activity context;

public LoanRepaymentListAdapter(Activity context, List<CurrentRepaymentInstallment> loansForRepayment) {
    super(context, R.layout.loan_repayments, loansForRepayment);
    this.context = context;
    this.loansForRepayment = loansForRepayment;
}

static class ViewHolder {
    protected TextView borrowerName;
    protected TextView loanAmount;
    protected TextView installmentNumber;
    protected TextView estimatedTotal;
    protected EditText repaymentAmount;
}

@Override
public View getView(final int position, View convertView, ViewGroup parent) {
    View view = null;
    if (convertView == null) {
        LayoutInflater inflator = context.getLayoutInflater();
        view = inflator.inflate(R.layout.loan_repayments, null);
        final ViewHolder viewHolder = new ViewHolder();
        viewHolder.borrowerName = (TextView) view.findViewById(R.id.borrowerName);
        viewHolder.loanAmount = (TextView) view.findViewById(R.id.loanAmount);
        viewHolder.installmentNumber = (TextView) view.findViewById(R.id.installmentNumber);
        viewHolder.estimatedTotal = (TextView) view.findViewById(R.id.estimatedTotal);
        viewHolder.repaymentAmount = (EditText) view.findViewById(R.id.repaymentAmount);
//          viewHolder.repaymentAmount.setEditableFactory(Editable.Factory.getInstance());
        viewHolder.repaymentAmount.addTextChangedListener(new TextWatcher() {
            @Override
            public void afterTextChanged(Editable arg0) {

            }
            @Override
            public void beforeTextChanged(CharSequence s, int start,
                    int count, int after) {
                // TODO Auto-generated method stub

            }
            @Override
            public void onTextChanged(CharSequence s, int start, int before, int count) {
                CurrentRepaymentInstallment loanRepayment = (CurrentRepaymentInstallment) viewHolder.repaymentAmount.getTag();
                String repaymentAmount =  s.toString();
                loanRepayment.setRepaymentAmount(repaymentAmount);
            }
        });
        view.setTag(viewHolder);
        viewHolder.repaymentAmount.setTag(loansForRepayment.get(position));
    } else {
        view = convertView;
        ((ViewHolder) view.getTag()).repaymentAmount.setTag(loansForRepayment.get(position));
    }
    ViewHolder holder = (ViewHolder) view.getTag();
    holder.borrowerName.setText(loansForRepayment.get(position).getLoanProfileBasicInfo().getBorrowerBasicInfo().getFirstName());
    holder.loanAmount.setText("Rs. " + Float.toString(loansForRepayment.get(position).getLoanProfileBasicInfo().getLoanAmountInPaisa()/100));
    holder.estimatedTotal.setText("Rs. " + Float.toString(loansForRepayment.get(position).getEstimatedTotalAmount()/100));
    holder.installmentNumber.setText("Inst no : " + Integer.toString(loansForRepayment.get(position).getInstallmentNumber()));
    float repaymentAmt = loansForRepayment.get(position).getRepaymentAmount();
    if(repaymentAmt != 0.0) holder.repaymentAmount.setText(Float.toString(repaymentAmt));
    return view;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T09:32:17.710

原因是 Android ListView 回收.. 请查看以下链接 [EditText in ListView 中接受的答案，无需回收输入](https://stackoverflow.com/questions/9438676/edittext-in-listview-without-it-recycling-input)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-04T02:42:08.237

解决方案是在设置文本之前删除添加的 textwatcher。否则，该视图上的前一个 textwatcher 仍将与新的 textwatcher 一起被调用。将 textwatcher 作为标签存储在 EditText 上以跟踪它。

```
Object oldWatcher = viewHolder.quantitySold.getTag();
if(oldWatcher != null){
    viewHolder.quantitySold.removeTextChangedListener((CustomTextWatcher)oldWatcher);
} 
String oldText =  inputValues.get("key"+position);
Log.d(TAG, "oldText: "+oldText+" position: "+position);
viewHolder.quantitySold.setText(oldText == null ? "" : oldText);
CustomTextWatcher watcher = new CustomTextWatcher(
        cursor.getString(SKUFragment.COL_NAME),
        cursor.getInt(SKUFragment.COL_ID),
        cursor.getDouble(SKUFragment.COL_UNIT_PRICE),
        position
) {
    @Override
    public void beforeTextChanged(CharSequence s, int start, int count, int after) {

    }

    @Override
    public void onTextChanged(CharSequence s, int start, int before, int count) {

    }

    @Override
    public void afterTextChanged(Editable s) {
        if (s != null) {
            int quantity = 0;
            if (!TextUtils.isEmpty(s.toString())) {
                quantity = Integer.parseInt(s.toString());
                inputValues.put("key"+mPosition, "" + quantity);
            }else{
                inputValues.put("key"+mPosition, "");
            }
            double value = quantity * skuPrice;
            mListener.onQuantityChanged(skuName+", position: "+mPosition, skuId, quantity, value);
        }
    }
};
viewHolder.quantitySold.setTag(watcher);
viewHolder.quantitySold.addTextChangedListener(watcher); 
```

# function - 如何将任意数据类型写入 Matlab 单元数组

> ID：11209158
> 
> 赞同：2
> 
> 时间：2012-06-26T14:06:11.150
> 
> 标签：function, matlab, types, return-value, cell-array

这是一个普遍问题，与特定操作无关。我希望能够将任意函数的结果写入元胞数组的元素，而不考虑函数返回的数据类型。考虑这个伪代码：

```
zout = cell(n,m);
myfunc = str2func('inputname'); %assume myfunc puts out m values to match zout dimensions
zout(1,:) = myfunc(x,y); 
```

这将适用于 "inputname" == "strcat" ，例如，假设`x`and`y`是具有适当维度的字符串或字符串单元格。但是如果 "inputname" == "strcmp" 那么输出是一个逻辑数组，并且 Matlab 会抛出一个错误。我需要做

```
zout(1,:) = num2cell(strcmp(x,y)); 
```

所以我的问题是：有没有办法填充单元格数组`zout`而无需测试生成的变量类型`myfunc(x,y` ？我应该首先使用 a`struct`吗（如果是，填充它的最佳方法是什么）？
（我通常是 R 用户，我可以轻松使用`list`变量）

编辑：为了简化整体范围，添加以下“要求”：我们现在假设，对于返回多个输出的函数，只需要在`zout`. 但是当这个输出是 N 个值的向量或单元格的向量（即 Nx1 单元格数组）时，这些 N 个值被映射到`zout(1,1:N)`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T15:16:38.207

> 所以我的问题是：有没有一种方法可以填充元胞数组 zout 而无需测试 myfunc(x,y) 生成的变量类型？我应该首先使用结构（如果是，填充它的最佳方法是什么）？

@NotBoStyf 提供的答案几乎就在那里，但并不完全。元胞数组是正确的方法。然而，答案很大程度上取决于函数的输出数量。

## 只有一个输出的函数

该函数`strcmp`只有一个输出，即一个数组。原因是

```
zout{1,:} = strcmp(x,y) 
```

给你一个错误信息，当 zout 的尺寸为 N x 2 时，左侧 ( `zout{1,:}`) 期望右侧有两个输出。您可以使用以下方法解决此问题：

```
[zout{1,:}] = num2cell(strcmp(x,y));  % notice the square brackets on the LHS 
```

但是，真的没有理由这样做。您可以简单地定义`zout`为 N x 1 元胞数组并捕获结果：

```
zout = cell(1,1);

x = 'a';
y = { 'a', 'b' };

zout{1} = strcmp(x,y);

% Referring to the results:
x_is_y_1 = zout{1}(1);
x_is_y_2 = zout{1}(2); 
```

还有一种情况要考虑...

## 具有多个输出的函数

如果您的函数产生多个输出（而不是作为数组的单个输出），那么这只会捕获第一个输出。产生多个输出的函数定义如下：

```
function [outA,outB] = do_something( a, b )
  outA = a + 1;
  outB = b + 2;
end 
```

在这里，您需要显式捕获两个输出参数。否则，你只会得到`a`. 例如：

```
outA = do_something( [1,2,3], [4,5,6] ); % outA is [2,3,4]

[outA,outB] = do_something( [1,2,3], [4,5,6] ); % outA is [2,3,4], outB is [6,7,8]

Z1 = cell(1,1);
Z1{1,1} = do_something( [1,2,3], [4,5,6] ); % Z1{1,1} is [2,3,4]

Z2 = cell(1,2);
Z2{1,1:2} = do_something( [1,2,3], [4,5,6] ); % Same error as above.  
% NB: You really never want to have a cell expansion that is not surrounded 
% by square brackets.

% Do this instead:
[Z2{1,1:2}] = do_something( [1,2,3], [4,5,6] ); % Z2{1,1} is [2,3,4], Z2{1,2} is [6,7,8] 
```

这也可以通过编程方式完成，但有一些限制。假设我们有一个函数 `func`，它接受一个输入并返回一个恒定（但未知）数量的输出。我们有一个单元格数组`inp`，其中包含我们要处理的输入，我们希望将结果收集到周围的单元格中`outp`：

```
N = numel(inp);
M = nargout(@func);  % number of outputs produced by func 
outp = cell(N,M);
for i=1:N
  [ outp{i,:} ] = func( inp{i} );
end 
```

这种方法有一些注意事项：

1.  它捕获**所有**输出。这并不总是你想要的。

2.  捕获所有输出通常可以改变函数的行为。例如，`find`如果只使用一个输出，则该函数返回线性索引，如果使用两个输出，则返回行/列索引，如果使用三个输出，则返回行/列/值。

3.  它不适用于具有可变数量输出的函数。这些函数定义为`function [a,b,...,varargout] = func( ... )`。 `nargout`如果函数已在其输出列表中声明，则将返回负数`varargout`，因为 Matlab 无法知道将产生多少输出。

## 将数组和单元格输出解包到一个单元格中

> 到目前为止一切都是真的，但是：我希望的是一个通用的解决方案。如果函数产生单元格输出，我不能使用 num2cell 。因此，对 strcmp 有效的方法对 strcat 无效，反之亦然。现在让我们假设，对于一个返回多个输出的函数，只需要在 zout 中捕获第一个输出 – Carl Witthoft

要为返回单元格或数组的所有函数提供统一的输出语法，请使用适配器函数。这是一个处理数值数组和单元格的示例：

```
function [cellOut] = cellify(input)
  if iscell(input)
    cellOut = input;
  elseif isnumeric(input)
    cellOut = num2cell(input);
  else
    error('cellify currently does not support structs or objects');
  end
end 
```

要将输出解包到二维元胞数组中，每个输出的大小必须是恒定的。假设`M`输出：

```
N = numel(inp);
% M is known and constant
outp = cell(N,M);
for i=1:N
  outp(i,:) = cellify( func( inp{i} ) );  % NB: parentheses instead of curlies on LHS
end 
```

然后可以将输出寻址为`outp{i,j}`。另一种方法允许输出的大小变化：

```
N = numel(inp);
% M is not necessary here
outp = cell(N,1);
for i=1:N
  outp{i} = cellify( func( inp{i} ) );  % NB: back to curlies on LHS
end 
```

然后可以将输出寻址为`outp{i}{j}`，并且输出的大小可以变化。

要记住几件事：

1.  Matlab 单元基本上是低效的指针。JIT 编译器并不总是像数值数组一样优化它们。

2.  将数值数组拆分为单元格会占用大量内存。每个拆分值实际上是一个数值数组，具有与其相关的大小和类型信息。在数值数组形式中，每个数组都会发生一次。拆分数组时，每个元素都会发生一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:27:33.550

赋值时使用花括号代替。使用

```
 zout{1,:} = strcmp(x,y); 
```

相反应该工作。

# jsf - JSF 无法在托管 bean 中设置当前变量实体，以便了解用户选择了哪个实体

> ID：11209162
> 
> 赞同：1
> 
> 时间：2012-06-26T14:06:34.787
> 
> 标签：jsf, jakarta-ee, primefaces

我正在尝试使用 Primefaces 在 JSF 中实现对实体的修改。

我列出用户的主要视图如下：

```
<p:growl id="growlEditUnit" showDetail="true" life="12000" />
    <p:dialog id="dialogEditUnit" header="Edit Unit" widgetVar="editUnitDialog" showEffect="fade" hideEffect="fade" resizable="false" >
        <ui:include src="editUnit.xhtml" />
    </p:dialog>

<h:form id="form2">  

        <p:dataTable id="units" var="unit" value="#{unitController.unitsOfLoggedInUser}" >  

            <f:facet name="header">  
                Click Edit or Delete after selecting a unit to modify or remove it  
            </f:facet>  

            <p:column headerText="Code">  
                #{unit.unitCode}  
            </p:column>  

            <p:column headerText="Name">  
                #{unit.unitName}  
            </p:column>  

            <p:column headerText="Semester" >  
                #{unit.semester}  
            </p:column>  

            <p:column headerText="Academic Year">  
                #{unit.academicYear}  
            </p:column>

            <p:column headerText="Twitter Username">  
                #{unit.twitterUsername}  
            </p:column>

            <p:column headerText="Actions">  
                <p:commandButton id="editButton" value="Edit" action="#{unitController.setCurrent(unit)}" update=":dialogEditUnit" oncomplete"editUnitDialog.show()" />  
            </p:column>  

        </p:dataTable> 

    </h:form> 
```

此视图正确列出了所有数据。但是，当我按当前时，我的目标是根据单击的按钮设置托管 bean 的当前属性（下面列出的代码）。在此之后，我尝试更新编辑对话框，因此它将填充该单元的值，然后使用 oncomplete 属性使其可见。但是，似乎在单击编辑按钮时从未调用托管方法 setCurrent(unit)。随后对话框显示为空。有人可以帮我解决我做错了什么吗？我也在发布托管 bean 代码。

```
@ManagedBean(name = "unitController")
@ViewScoped
public class UnitController implements Serializable {

private Unit current;

private List<Unit> unitsOfLoggedInUser;

@ManagedProperty(value="#{loginController.checkedUser}")
private Lecturer lecturer;

@EJB
private web.effectinet.ejb.UnitFacade ejbFacade;
@EJB
private web.effectinet.ejb.LecturerFacade lecturerFacade;

public UnitController() {
}

@PostConstruct
public void init(){
    if (lecturer.getLecturerId() == null)
        unitsOfLoggedInUser = null;
    else
        unitsOfLoggedInUser = (List<Unit>) lecturer.getUnitCollection();
}

public List<Unit> getUnitsOfLoggedInUser() {

        return unitsOfLoggedInUser;

}

public void setCurrent(Unit current) {
    this.current = current;
}

public Lecturer getLecturer() {
    return lecturer;
}

public void setLecturer(Lecturer lecturer) {
    this.lecturer = lecturer;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:16:47.803

commandButton 的 action 属性在没有关于`unit`变量值的信息的情况下呈现。

要将单元传递给托管 bean 的操作方法，则需要`unit`在 commandButton 的`<f:param>`子标记中传递 ID。

```
<p:commandButton action="#{managedBean.actionMethod}" ........>
   <f:param name="unitid" value="#{unit.id}" /> 
</p:commandButton> 
```

从您的操作方法中，您可以通过名称获取请求参数，`ExternalContext`这将为您提供在 dataTable 中按下命令按钮的单元的 ID。

# iphone - 如何从 Twitter 为我的 iOS 应用程序获取 OAuthConsumerKey 和 OAuthConsumerSecret？

> ID：11209166
> 
> 赞同：0
> 
> 时间：2012-06-26T14:06:58.683
> 
> 标签：iphone, objective-c, ios, xcode, twitter

我正在开发一个 iOS 应用程序，我想在其中从我的应用程序中发布一些文本。我的疑问是

1.  如何在 Twitter 网站上创建（注册）我的应用程序？和
2.  如何为我的应用从 Twitter 获取 OAuthConsumerKey 和 OAuthConsumerSecret？

提前感谢任何链接或参考或文档或任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:09:39.337

> 如何在 Twitter 网站上创建（注册）我的应用程序？

阅读[http://dev.twitter.com上的文档](http://dev.twitter.com)

> 如何为我的应用从 Twitter 获取 OAuthConsumerKey 和 OAuthConsumerSecret？

您必须使用某种 Objective-C OAuth 库来为您处理这个问题。考虑使用过于流行的[ShareKit](http://getsharekit.com/)或我修改后的[OAuth 库](http://github.com/H2CO3/MPOAuthiOS)

# javascript - 在延迟期间加载图像

> ID：11209170
> 
> 赞同：0
> 
> 时间：2012-06-26T14:07:14.237
> 
> 标签：javascript, ajax, image, loading, delay

当您单击按钮时，我得到了延迟工作，但我无法在延迟期间显示加载 gif。

谢谢

```
function () {
    $('.sectionThreeTab:not(.tabActive)').click(function () {
        $('ajax-loader.gif').bind('ajaxStart', function () {
            $(this).show();
        }).bind('ajaxStop', function () {
            $(this).hide();
        });
        $('.tabActive').removeClass('.tabActive');
        $(this).addClass('tabActive');
        var lesson = $(this).attr('lesson');
        var self = $(this);
        setTimeout(function () {
            $.ajax({
                type: "GET",
                url: 'lessons/' + lesson + '.htm',
                datatype: "json",
                success: function (data) {
                    $('#sectionTabContent').append(data);
                }
            })
        }, 3000);
        return false;
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:14:44.183

我相信您错误地定位了加载图像，请尝试：

```
$('#ajaxLoader').bind('ajaxStart', function () {
    $(this).show();
}).bind('ajaxStop', function () {
    $(this).hide();
}); 
```

您的加载图像具有 Id 的位置`#ajaxLoader`（替换以适合您的 HTML）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T15:18:32.583

你可以试试这个而不是你所拥有的：删除这部分：

```
$('ajax-loader.gif').bind('ajaxStart', function () {
            $(this).show();
        }).bind('ajaxStop', function () {
            $(this).hide();
        }); 
```

并将 setTimeout 更改为：

```
setTimeout(function () {
            $("#loading").show();
            $.ajax({
                type: "GET",
                url: 'lessons/' + lesson + '.htm',
                datatype: "json",
                success: function (data) {
                    $('#sectionTabContent').append(data);
                },
                complete: function() {
                    $("#loading").hide();
                }
            })
        }, 3000); 
```

还请发布您的 html，以便我们查看其他所有内容是否正常。

编辑：

```
<div id="loading" class="grayBackground withBorder10" style="display:none"> 
<img alt="Loading..." src="img/ajax-loader.gif" />
</div> 
```

# jquery - 未选中复选框时的默认值

> ID：11209172
> 
> 赞同：1
> 
> 时间：2012-06-26T14:07:22.863
> 
> 标签：jquery, ruby-on-rails, ruby, ruby-on-rails-3

我有一个用于创建具有隐藏字段的用户的 rails 表单：

```
= hidden_field_tag "user[site_ids][]", @current_site.id, :data => @current_site.id, :class => 'current_site_id' 
```

它设置 current_site 的 site_id。

我还有几个复选框列出了所有站点：

```
- Site.all.each do |site|
  %label.checkbox
    = check_box_tag 'user[site_ids][]', site.id, false, :class => "sites_checkbox"
    = site.name 
```

我有隐藏字段的原因是 si 如果用户没有选择任何复选框，它至少会设置`@current_site`.

我正在考虑像这样使用 JQuery：如果用户选择我将值设置为 999 的复选框之一，该复选框不在数据库中：

```
$(".roles_selected").click(function() {
  var selected = $(this).closest("label");
  if (selected.attr("data") == 'superadmin') {
    $('.current_site_id').val(999);
  } else {
    $('.current_site_id').val($('.current_site_id').attr('data'));
  }
}); 
```

并且在控制器中可能会删除 999`params[:user][:site_ids]`

这似乎太骇人听闻了……还有其他想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T14:17:59.540

更直接的解决方案是在控制器的创建/更新方法中设置默认站点。例如，类似：

```
@user = User.new(params[:user])
@user.sites << @current_site if params[:user][:site_ids].empty? 
```

然后您可以摆脱表单和 jquery 中的隐藏字段。

# html - django - 我如何编辑表单字段中显示的 html？

> ID：11209178
> 
> 赞同：1
> 
> 时间：2012-06-26T14:07:44.143
> 
> 标签：html, django

我正在使用引导程序，我想设置表单中一些元素的跨度。

差不多，而不是：

```
<input id="id_display_name" type="text" name="display_name"> 
```

我想展示

```
<input id="id_display_name" type="text" name="display_name" class="span4"> 
```

初始行由以下方式生成：

```
{{ form.display_name }} 
```

我如何粘贴新的html？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:15:12.140

[https://docs.djangoproject.com/en/dev/ref/forms/widgets/#django.forms.Widget.attrs](https://docs.djangoproject.com/en/dev/ref/forms/widgets/#django.forms.Widget.attrs)

```
display_name = forms.TextInput(attrs={'class': 'span4'}) 
```

将导致：

```
<input id="id_display_name" type="text" name="display_name" class="span4" />' 
```

# c# - 设置 Selenium 网格集线器和节点后，我的下一步是什么？

> ID：11209189
> 
> 赞同：2
> 
> 时间：2012-06-26T14:08:28.297
> 
> 标签：c#, selenium, webdriver, selenium-grid

我有一个 Selenium Grid 集线器版本 2.22.0，运行 5 个节点。这里是他们的名单：

*   1 运行 Windows 7 的本地节点（我的机器）
*   1 运行 Windows XP 的虚拟机
*   1 运行 Windows Vista 的虚拟机
*   2 运行 Windows 7 的虚拟机

我希望能够将作业发送到那些将加载特定浏览器并使用 webdriver 通过它们驱动命令的机器。

我需要使用带有 C# 语言的 Visual Studio 来完成它。***（另外，我使用Java***独立服务器启动了网格和所有节点，这是否意味着我的 webdriver 也需要用***Java***编写？）

如果您知道任何**当前**使用 webdriver 和网格的教程，那就太好了。（我能找到的所有教程都使用 selenium 网格版本 1）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T15:36:12.753

当你启动你的节点时，你会给他们一些类似的东西

```
-browser "-browserName=internetexplorer,version=9,platform=windows" 
```

当您编写测试时，您可以将此节点与以下代码一起使用：

```
String gridconfig = "your grid url";    
DesiredCapabilities capabilities = new DesiredCapabilities("internetexplorer", "9", Platform.WINDOWS);
RemoteWebDriver driver = new RemoteWebDriver(new URL(this.gridconfig), capabilities);
//Do your test stuff with driver 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T10:30:21.883

这些是 Java 特定的命令，用于启动 Grid 并注册节点。它与脚本无关。

您可以使用您喜欢的语言（C#、Java..等）编写脚本。

这里有一些页面提供了有关如何在 C# 中编写 Selenium 代码以及如何使用 Grid 的更多信息。

[http://www.theautomatedtester.co.uk/tutorials/selenium/selenium_two_csharp_nunit.htm](http://www.theautomatedtester.co.uk/tutorials/selenium/selenium_two_csharp_nunit.htm) [http://code.google.com/p/selenium/wiki/Grid2](http://code.google.com/p/selenium/wiki/Grid2)

我希望这可以帮助你......一切顺利:)

# javascript - 评估错误，黑莓 5.2，Javascript

> ID：11209190
> 
> 赞同：1
> 
> 时间：2012-06-26T14:08:28.857
> 
> 标签：javascript, html, blackberry

我正在开发一个 Blackberry 5.2 浏览器应用程序。我有一些返回一些 JSON 的 JavaScript。我知道较旧的黑莓手机不支持 JSON 解析，但能够使用 eval 来完成工作。

然而，在运行 5.2 的 Blackberry Curve 上，我的 eval 语句会引发错误。错误是

> SyntaxError：eval（）中的错误：期望';' 成立 '：' ...

它试图解析的字符串是正确且干净的。

javascript看起来像这样......

```
 request.open("POST", url, false);

            request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            request.setRequestHeader("Accept", "text/json");

            request.send(params);
            return eval(request.responseText); 
```

它试图评估的响应看起来像这样......

```
{
    "Authenticated": true,
    "StatusCode": "Success",
    "InternalErrorId": null,
    "AuthenticationToken": "PxjcYnjBLN21ZMcWrEzKi9LC3vdXehMVSegEbVz61aca52113",
    "AuthenticationTokenExpiry": "/Date(1340734497405)/",
    "SessionTimeoutMinutes": 240
} 
```

有谁知道这里可能发生了什么以及如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:16:27.083

用于`eval`解析 JSON 时，需要将 JSON 包装在`()`.

```
return eval('('+request.responseText+')'); 
```

# asp.net-mvc - 如何使用 RedirectToAction 包含模型？

> ID：11209191
> 
> 赞同：75
> 
> 时间：2012-06-26T14:08:32.130
> 
> 标签：asp.net-mvc

在`RedirectToAction`下面，我想传递一个`viewmodel`. 如何将模型传递给重定向？

我设置了一个断点来检查模型的值，以验证模型是否正确创建。这是正确的，但生成的视图不包含模型属性中的值。

```
//
// model created up here...
//
return RedirectToAction("actionName", "controllerName", model); 
```

ASP.NET MVC 4 RC

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2012-06-26T14:15:03.853

`RedirectToAction`向客户端浏览器返回 302 响应，因此浏览器将对到达浏览器的响应的 location 标头值中的 url 发出新的 GET 请求。

如果您尝试将简单的精益平面视图模型传递给第二个操作方法，则可以使用该方法的[此重载](https://msdn.microsoft.com/en-us/library/system.web.mvc.controller.redirecttoaction(v=vs.118).aspx#M:System.Web.Mvc.Controller.RedirectToAction%28System.String,System.String,System.Object%29)`RedirectToAction`。

```
protected internal RedirectToRouteResult RedirectToAction(
    string actionName,
    string controllerName,
    object routeValues
) 
```

`RedirectToAction`会将传递的对象（r​​outeValues）转换为查询字符串并将其附加到 url（从我们传递的前 2 个参数生成），并将生成的 url 嵌入到响应的位置标头中[。](https://en.wikipedia.org/wiki/HTTP_location)

假设您的视图模型是这样的

```
public class StoreVm
{
    public int StoreId { get; set; }
    public string Name { get; set; }
    public string Code { set; get; } 
} 
```

而你在你的第一个动作方法中，你可以将 this 的一个对象传递给这样的`RedirectToAction`方法

```
var m = new Store { StoreId =101, Name = "Kroger", Code = "KRO"};
return RedirectToAction("Details","Store", m); 
```

此代码将向浏览器发送 302 响应，其位置标头值为

```
Store/Details?StoreId=101&Name=Kroger&Code=KRO 
```

假设您的`Details`操作方法的参数是 type `StoreVm`，查询字符串参数值将正确映射到参数的属性。

```
public ActionResult Details(StoreVm model)
{
  // model.Name & model.Id will have values mapped from the request querystring
  // to do  : Return something. 
} 
```

以上将适用于通过小型平面视图模型。但是如果你想传递一个复杂的对象，你应该尝试遵循 PRG 模式。

# PRG模式

PRG 代表**POST** - **REDIRECT** - **GET**。使用这种方法，您将在查询字符串中发出具有唯一 id 的重定向响应，第二个 GET 操作方法可以使用该响应再次查询资源并将某些内容返回给视图。

```
int newStoreId=101;
return RedirectToAction("Details", "Store", new { storeId=newStoreId} ); 
```

这将创建 url`Store/Details?storeId=101` 并在您的详细信息`GET`操作中，使用传入的 storeId，您`StoreVm`将从某处获取/构建对象（从服务或查询数据库等）

```
public ActionResult Details(string storeId)
{
   // from the storeId value, get the entity/object/resource
   var store = yourRepo.GetStore(storeId);
   if(store!=null)
   {
      // Map the the view model
      var storeVm = new StoreVm { Id=storeId, Name=store.Name,Code=store.Code};
      return View(storeVm);
   }
   return View("StoreNotFound"); // view to render when we get invalid store id
} 
```

# 临时数据

遵循[PRG 模式](https://en.wikipedia.org/wiki/Post/Redirect/Get)是处理此用例的更好解决方案。但是如果你不想这样做并且真的想在**无状态 HTTP**请求中传递一些复杂的数据，你可以使用一些临时存储机制，比如`TempData`

```
TempData["NewCustomer"] = model;
return RedirectToAction("Index", "Users"); 
```

`GET`并再次在您的 Action 方法中阅读它。

```
public ActionResult Index()
{      
  var model=TempData["NewCustomer"] as Customer
  return View(model);
} 
```

`TempData`使用`Session`场景背后的对象来存储数据。但是一旦读取数据，数据就会终止。

Rachel 写了一篇很好的博客[文章](http://rachelappel.com/when-to-use-viewbag-viewdata-or-tempdata-in-asp.net-mvc-3-applications)，解释了何时使用 TempData /ViewData。值得一读。

# 在 Asp.Net Core 中使用 TempData 将模型数据传递给重定向请求

在 Asp.Net 核心中，**您不能在 TempData 中传递复杂类型**。您可以传递简单的类型，如,`string`等。`int``Guid`

如果您绝对想通过 TempData 传递复杂类型的对象，您有 2 个选项。

**1）将您的对象序列化为字符串并传递它。**

这是一个使用 Json.NET 将对象序列化为字符串的示例

```
var s = Newtonsoft.Json.JsonConvert.SerializeObject(createUserVm);
TempData["newuser"] = s;
return RedirectToAction("Index", "Users"); 
```

现在在您的`Index`操作方法中，从 TempData 读取此值并将其反序列化为您的`CreateUserViewModel`类对象。

```
public IActionResult Index()
{
   if (TempData["newuser"] is string s)
   {
       var newUser = JsonConvert.DeserializeObject<CreateUserViewModel>(s);
       // use newUser object now as needed
   }
   // to do : return something
} 
```

**2) 将简单类型的字典设置为 TempData**

```
var d = new Dictionary<string, string>
{
    ["FullName"] = rvm.FullName,
    ["Email"] = rvm.Email;
};
TempData["MyModelDict"] = d;
return RedirectToAction("Index", "Users"); 
```

稍后阅读

```
public IActionResult Index()
{
   if (TempData["MyModelDict"] is Dictionary<string,string> dict)
   {
      var name = dict["Name"];
      var email =  dict["Email"];
   }
   // to do : return something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-03T16:28:45.460

另一种方法是将其存储在会话中。

```
var s = JsonConvert.SerializeObject(myView);
HttpContext.Session.SetString("myView", s); 
```

并把它拿回来

```
string s = HttpContext.Session.GetString("myView");
myView = JsonConvert.DeserializeObject<MyView>(s); 
```

# objective-c - 同一个 UIViewController 的多个实例

> ID：11209193
> 
> 赞同：0
> 
> 时间：2012-06-26T14:08:35.923
> 
> 标签：objective-c, uiviewcontroller, uinavigationcontroller

我有一个`UIViewController`在 a 中的那个根`UINavigationController`。我在那里做的是实例化另一个`UIViewController`相同类型的，设置一些属性并将其推到堆栈顶部。

这里的问题是父视图控制器也在改变它的属性。

这是我的做法：

```
RootViewController *rootViewController = [[RootViewController alloc] initWithRequest:request];
[self.navigationController pushViewController:rootViewController animated:YES]; 
```

为什么会这样？这不是创建视图控制器的新实例并将相同的确切属性复制到不同的对象实例中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:10:48.027

两个视图控制器现在都有一个指向同一个`request`对象的指针。您所做的任何更改都会反映在两个控制器中。`request`如果控制器能够修改它，您可能需要复制该对象。

# android - 通过意图将参数传递给查询

> ID：11209200
> 
> 赞同：2
> 
> 时间：2012-06-26T14:09:08.480
> 
> 标签：android, sqlite, android-intent

我需要从 EditText 传递一个参数，当我单击该按钮时，它将启动另一个活动并获取该参数并将其传递给查询。它跟随：

```
final Button ara = (Button) findViewById(R.id.maddebutton);
    ara.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            String maddeno = madde.getText().toString(); //madde is my EditText
            Intent intent = new Intent(Anayasa.this, MaddeBul.class);
            intent.putExtra("maddeler", maddeno);
            startActivity(intent);
            }
    }); 
```

我的第二堂课如下：

```
Intent intent = getIntent();
    int maddebul = intent.getIntExtra("maddeler", 0); //I don't want to set a default value but it pushes me

try {
        Cursor cursor = FetchRecord(db.query("anayasa", SELECT,
                "no = maddebul", null, null, null, null));
        ShowRecord(cursor);
    } finally {
        database.close();
    } 
```

我的`FetchRecord(Cursor c)`和`ShowRecord(Cursor cursor)`函数工作正常，因为我在其他类中使用它们。我的“anayasa”数据库中有“no”列，其中包含整数值。

在 LogCat 上，它说“没有像 maddebul 这样的列”。这是真的，没有。它应该是：

```
SELECT * FROM anayasa WHERE no = maddebul; //as sql command 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:13:13.333

您在这里添加额外的字符串：

```
intent.putExtra("maddeler", maddeno); 
```

但是，当您尝试检索额外的内容时，您将其作为 int 检索：

```
int maddebul = intent.getIntExtra("maddeler", 0); 
```

尝试使用这个

```
String maddebul = intent.getStringExtra("maddeler", ""); 
```

[这里的参考是getStringExtra() 方法](http://developer.android.com/reference/android/content/Intent.html#getStringExtra%28java.lang.String%29)的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:16:37.390

```
On LogCat, it says "no column such maddebul". It is true, there isn't. 
```

由于在 whereClause "no = maddebul" 中，maddebul 不是变量，它是字符串部分，因此更改 whereClause 以获取它的值

```
Cursor cursor = FetchRecord(db.query("anayasa", SELECT,
                    "no = maddebul", null, null, null, null)); 
```

应该

```
Cursor cursor = FetchRecord(db.query("anayasa", SELECT,
                "no = "+maddebul, null, null, null, null)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:13:30.003

你正在用双引号写 maddebul。

代替

```
Cursor cursor = FetchRecord(db.query("anayasa", SELECT,
                "no = maddebul", null, null, null, null)); 
```

经过

```
Cursor cursor = FetchRecord(db.query("anayasa", SELECT,
                "no = "+maddebul, null, null, null, null)); 
```

更好地使用以下

```
Cursor cursor = FetchRecord(db.query("anayasa", SELECT,
                "no = ?",new String[]{String.valueOf(maddebul)}, null, null, null)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T14:14:06.677

您将 Extra 设置为 String 并将其设置为 Integer - 也许这就是问题所在？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-26T14:16:19.113

有多个问题：

你把`maddebul`as String 放在这里所以需要像这样得到它：

```
String maddebul = intent.getStringExtra("maddeler", ""); 
```

此外，您正在形成错误的 SQL 查询，`maddebul`将其作为字符串传递给数据库，而您实际上想要传递该变量的值。所以它可能是这样的：

```
Cursor cursor = FetchRecord(db.query("anayasa", SELECT,
                "no = ?",new String[]{maddebul}, null, null, null)); 
```

# r - 有条件地申请？

> ID：11209201
> 
> 赞同：2
> 
> 时间：2012-06-26T14:09:14.770
> 
> 标签：r, if-statement, multiple-tables, lapply

我尝试使用 lapply 代替与 for 循环一起使用的功能。我对 R 很陌生，对 lapply 不满意。我特别不知道如何制作“如果”条件。

我当前的带有 for 循环的代码看起来像这样（它规范化卷系列）：

```
function(TableVolume,VolumeM,VolumeStD,n){
TableBN = TableVolume[n:nrow(TableVolume),]

for(k in 1:nrow(TableBN)){for (i in 2:ncol(TableBN)){if(!is.na(VolumeM[k,i]) && (VolumeM[k,i]) && (TableVolume[n-1+k,i]>VolumeM[k,i]+1.96/sqrt(n)*VolumeStD[k,i])){TableBN[k,i]=TableVolume[n-1+k,i]/VolumeM[k,i]}else{TableBN[k,i]=0}}}
TableBN=TableBN[n:nrow(TableVolume),]
return(TableBN)
} 
```

我从[Apply over two data frames](https://stackoverflow.com/questions/3557652/r-apply-over-two-data-frames)中知道如何执行一个适用于 2 个数据帧的函数，但我仍然看不到如何处理测试。

感谢您的支持，文森特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-09-05T14:35:45.913

您需要使用`lapply`（或其他应用家庭功能）。当您有一些非向量化函数应用于向量化参数时，通常需要它。您的函数和条件是算术函数的组合，它们被很好地矢量化了。所以你可以使用子集和`ifelse`函数请看如下：

```
set.seed(123)

# simulation
TableBN <- matrix(1:12, nrow = 3)
VolumeM <- matrix(12:1, nrow = 3)
VolumeStD <- matrix(12:1, nrow = 3)
TableVolume <- matrix(abs(rnorm(10)), nrow = 5)

# function
f <- function(TableVolume, VolumeM, VolumeStD, n){
  TableBN <- TableVolume[n:nrow(TableVolume), ]

  ifelse(
    test = !is.na(VolumeM) && VolumeM && TableBN[, -1] > (VolumeM + 1.96 / sqrt(n) * VolumeStD), 
    yes = TableBN[, -1] / VolumeM,
    no = 0)
}

# Test
f(TableVolume, VolumeM, VolumeStD, 3) 
```

输出：

```
0 
```

# xaml - Listbox.SelectedItems.Add 不会导致 SelectionChanged 事件

> ID：11209210
> 
> 赞同：1
> 
> 时间：2012-06-26T14:09:42.177
> 
> 标签：xaml, listbox

我有一个扩展 Listbox 类的自定义用户控件。在其中，我将覆盖 OnSelectionChanged 以将 Adorner 添加/删除到任何选定/未选定的项目。当我使用鼠标选择一个项目时，这一切都有效，但是当我使用以编程方式将项目添加到列表框时

```
myListBox.SelectedItems.Add(newItem) // newItem is already a member of myListBox.Items 
```

它不执行 OnSelectionChanged 代码。

**更新**：除非我疯了（这总是可能的），否则从父对象调用它之间的行为似乎有所不同

```
myListBox.SelectedItems.Add(newItem) 
```

以及我的扩展列表框类中的这个方法

```
Public Sub AddSelectedItem(newItem as Object)
    Me.SelectedItems.Add(newItem)
End Sub 
```

出于某种原因，第二个选项会触发事件，而第一个选项则不会。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:58:10.873

你需要先添加这行代码

```
myListBox.Items.Add(newItem) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T15:23:02.360

这里的解决方案是从 ListBox 的扩展中调用 SelectedItems.Add()

```
public class MyListBox : ListBox
{
public void AddSelectedItems(object newSelectedItem)
{
  // works
  this.SelectedItems.Add(newSelectedItem);
}
} 
```

将触发 OnSelectionChanged 事件。

从窗口这样调用它不会触发事件

```
private sub SomeWindowMethod()
{
   // does not work
   this.MyListBoxInstance.SelectedItems.Add(newSelectedItem);
} 
```

# email - HTML Mail 中的图像是否被替换？

> ID：11209219
> 
> 赞同：1
> 
> 时间：2012-06-26T14:10:09.417
> 
> 标签：email, image

是否有可能多个邮件应用程序（例如 Hotmail、Thunderbird、OSx Mail）替换整个`<img>`标签？

在生成的时事通讯中，我有例如：

```
<img style="padding: 0px 10px 0px 0px; outline: none; " class="editor-img" src="/upload/11/2_5.jpg" alt="image" width="165" height="107"> 
```

在收到的时事通讯中，我得到了类似的信息：

```
<img src="foo" border="0"> 
```

有人可以向我解释一下，我该如何防止这种情况发生？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T15:35:50.390

是的，这是绝对可能的。例如，德国的 T-Online 会将以 .php 结尾的图像与虚拟图像交换。许多网络邮件程序在最终呈现在收件箱之前解析和调整电子邮件代码。就像 Gmail 电话：-链接它认为是电话号码的号码。在您的情况下，相对路径没有任何意义。尝试使用绝对图像路径，例如`src="http://www.YOURDOMAIN/upload/11/2_5.jpg"`.

# .htaccess - .htaccess 文件夹的 URL 重写

> ID：11209220
> 
> 赞同：0
> 
> 时间：2012-06-26T14:10:21.773
> 
> 标签：.htaccess, mod-rewrite, url-rewriting

我有一个应用程序位于文件夹内`example.com/app`的`signin.php`, `signup.php`,`index.php`等处。

现在客户想要在`example.com/signin.php`等处访问应用程序，但我想将应用程序文件保留在应用程序文件夹中以便更好地管理。

我尝试使用它，它可以工作，但是我无法访问根目录中已有的文件：

```
RewriteCond %{HTTP_HOST} ^example\.com$ [OR]
RewriteCond %{HTTP_HOST} ^www\.example\.com$
RewriteCond %{REQUEST_URI} !^/app/
RewriteRule (.*) /app/$1 
```

有没有办法排除根目录中的页面受到影响？还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:12:54.373

你不能让你的http服务器指向他的app文件夹作为基础吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:14:21.517

查阅apaches mod_rewrite的文档，查看RewriteMap指令。使用它，您可以轻松命名您想要或不想被重写的所有名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T19:00:43.513

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/app/
RewriteRule (.*) /app/$1 
```

使用 -f 和 -d 确保它不会弄乱任何现有文件或目录。

# javascript - Selenium 测试 - 事件似乎没有被触发

> ID：11209221
> 
> 赞同：2
> 
> 时间：2012-06-26T14:10:23.533
> 
> 标签：javascript, events, selenium, glassfish, selenium-rc

我正在使用嵌入式 glassfish 来部署我的 Web 应用程序并使用 arquillian 遥控器对其进行测试。虽然到目前为止一切都很好，但我们在尝试处理应用程序中的建议功能时发现了一个问题。它基本上由一个文本框组成，一旦输入了 3 个或更多字符，它就会提供一个可能匹配的项目列表。

```
 <div class="uiModuleSelectingConcepts suggestion_${cc.id}">
    <div class="searchBox">
        <fieldset>
            <input type="text" 
                   class="sample" 
                   value="${cc.attrs.input_label}"
                   placeholder="${cc.attrs.input_label}"/>
                   <i></i>
        </fieldset>
    </div>
    <a4j:outputPanel id="suggestion_component_container"
                     styleClass="suggestionsWrapper" 
                     layout="block">
        <div class="suggestionsList_${cc.id}">
        </div>
    </a4j:outputPanel>
</div> 
```

添加了一些事件，以便正确显示这些建议，如下所示（在以下代码中，参数 inputNode）是用户键入的文本框本身......我们添加事件的地方）：

```
 this.addEventHandlers = function (inputNode, suggestionCallback, params) {
           var parent = this;
           inputNode
           /*
            * keypress event.
            */
           .keypress(function(event) {
               if (event.keyCode === 13) {
                   event.preventDefault();
               }
           })
           /*
            * keyup event. 
            */
           .keyup(function(event) {
                       switch (event.keyCode) {
                       /**
                        * Up arrow.
                        */
                       case 38: 
                           event.stopPropagation();
                           event.preventDefault();
                           var suggestionsWrapper = parent._params.list;
                           var currentSelectedValue = null;
                           if (suggestionsWrapper.find(".suggestionItem").length) {
                               if (suggestionsWrapper.find(".suggestionItem:first").hasClass("focused")) {
                                   suggestionsWrapper.find(".focused").removeClass("focused");
                                   suggestionsWrapper.find(".suggestionItem:last").addClass("focused");
                                   //currentSelectedValue =  suggestionsWrapper.find(".suggestionItem:last").val();
                               } else {
                                   suggestionsWrapper.find(".focused").removeClass("focused").prev().addClass("focused");
                               };
                               //set the selected value to input.
                               //console.debug("Current Valiue", suggestionsWrapper.find(".focused"));
                               var e = suggestionsWrapper.find(".focused");
                               if (e.length > 0) {
                                   //console.debug("Current e", e);
                                   currentSelectedValue =  typeof e  === 'undefined' ? null : e.attr('data-suggest');
                                   //console.debug("Current Valiue", currentSelectedValue);
                                   if (currentSelectedValue != null) {
                                       jQuery(this).val(Encoder.htmlDecode(currentSelectedValue));
                                   }
                               }
                           }
                           parent._blur = false;
                           break;
                       /**
                        * Down arrow.
                        */    
                       case 40: 
                           var suggestionsWrapper = parent._params.list;
                           var currentSelectedValue = null;
                           if (suggestionsWrapper.find(".suggestionItem").length) {
                               if (suggestionsWrapper.find(
                                       ".suggestionItem:last").hasClass("focused")) {
                                   suggestionsWrapper.find(".focused").removeClass("focused");
                                   suggestionsWrapper.find(".suggestionItem:first").addClass("focused");
                               } else {
                                   suggestionsWrapper.find(".focused").removeClass("focused").next().addClass("focused");
                               };
                               //console.debug("Current Valiue", suggestionsWrapper.find(".focused"));
                               var e = suggestionsWrapper.find(".focused");
                               //console.debug("Current e", e);
                               if (e.length > 0) {
                                   currentSelectedValue =  typeof e  === 'undefined' ? null : e.attr('data-suggest');
                                   //console.debug("Current Valiue", currentSelectedValue);
                                   if (currentSelectedValue != null) {
                                       jQuery(this).val(Encoder.htmlDecode(currentSelectedValue));
                                   }
                               }
                           }
                           parent._blur = false;
                           break;
                       /**
                        * ENTER key
                        */
                       case 13: 
                           event.stopPropagation();
                           event.preventDefault();
                           var suggestionsWrapper = parent._params.list;
                           var oConcept = suggestionsWrapper.find(".focused");
                           if (typeof oConcept !== "undefined") {
                               oConcept.trigger("click");
                           }
                           parent._blur = true;                            
                           parent._cleanSuggestions();
                           jQuery(this).blur();
                           break;
                       /**
                        * ESC key event.
                        */    
                       case 27: 
                           event.stopPropagation();
                           event.preventDefault();
                           var sValue = jQuery(this).attr("data-default");
                           sValue = jQuery.trim(sValue);
                           if (sValue === jQuery(this).attr("data-default")) {
                               jQuery(this).addClass("sample").blur();
                           }
                           parent._blur = true;
                           parent._cleanSuggestions();
                           jQuery(this).val("");
                           jQuery(this).blur();
                           break;
                       default:
                           var suggestionsWrapper = parent._params.list;
                           //var typeRight = jQuery(this).parents(".tabContent").attr("id");
                           var sValue = jQuery.trim(jQuery(this).val());
                           //var oThisInput = jQuery(this);
                           if (sValue.length > MEDIA.configuration.SUGGESTION_LIMIT) {
                               suggestionsWrapper.find(".suggestionItem").remove();
                               global.uiDelay( function() {      
                                   parent.displayLoading();
                                   suggestionCallback(sValue, MEDIA.util.getTrueFalseValue(parent._params.retrieveOnlyClasses) ? suggestOnlyConcepts : "");
                               }, 1000);
                           } else {
                               parent.writeMore();
                           }
                           parent._blur = true;
                           break;
                       };
                   }).keydown(function(event) {
                   switch (event.keyCode) {
                       case 38: // up
                           event.stopPropagation();
                           event.preventDefault();
                           break;
                       case 40: // down
                           event.stopPropagation();
                           event.preventDefault();
                           break;
                       default:
                       break;
                   };
           }).focus(function() {
               jQuery(this).val("");
               parent._blur = true;
              // when suggestions lose focus
           }).blur(function() {
               if (parent._blur) {
                   jQuery(this).val("");
                   parent._cleanSuggestions();
               }
           });
       }; 
```

当应用程序正常部署时（没有测试目的，没有硒），它按预期工作，并且在输入某些内容时会显示建议。但是，当使用 Selenium 时，无论在框中输入什么，都不会发生任何事情。我们已经尝试了许多可能性和组合，使用 .keyDown()、.keyPress()、.keyUp() 及其 char、keyCode 和原生变体。此外，.type()、.typeKeys()....所有这些都无济于事。似乎由于某些原因，这些事件被忽略了（有趣的是，如果我们在浏览器中手动输入一些文本 selenium 打开以测试应用程序，建议 -do- 显示。只有当它是 selenium 时它们才不会打字）。

任何帮助将不胜感激。不确定我是否完全有道理，我们很乐意澄清。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T10:10:09.450

我使用了这个简单的测试页和 jQuery 1.7.2（第一个字段的输入应该被复制到另一个字段中）：

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
    </head>
    <body>
        <input type="text" id="myInput" />
        <input type="text" id="yourInput" />
        <script>
            $("#myInput").keyup(function(event) {
                $("#yourInput").val(this.value);
            });
        </script>
    </body>
</html> 
```

* * *

让我在一开始就说明一个令人讨厌的事实：*使用 WebDriver，一切都运行良好且顺利。*

```
WebDriver driver = new InternetExplorerDriver();
driver.get("the path to the file");
driver.findElement(By.id("myInput")).sendKeys("Hello.");
driver.quit(); 
```

* * *

无论如何，我也能够使它在 Selenium RC 中工作：

```
sele.focus("id=myInput");
sele.keyPressNative(String.valueOf(KeyEvent.VK_H));
sele.keyPressNative(String.valueOf(KeyEvent.VK_E));
sele.keyPressNative(String.valueOf(KeyEvent.VK_L));
sele.keyPressNative(String.valueOf(KeyEvent.VK_L));
sele.keyPressNative(String.valueOf(KeyEvent.VK_O)); 
```

这有点糟糕，但这是我想出的最好的活动地点。

# c# - 如何在为 DynamicMethod 发出的代码上调试 InvalidProgramException

> ID：11209225
> 
> 赞同：6
> 
> 时间：2012-06-26T14:10:31.867
> 
> 标签：c#, debugging, reflection.emit, dynamicmethod

在搜索了 stackoverflow 和大量谷歌搜索之后，为调试 DynamicMethods 发出的代码提供的解决方案似乎已经过时并且非常笨拙。

在 LCG（轻量级代码生成）发布后的 4 年或更长时间内，肯定有人找到了更好的方法。

您发现验证您编写的动态 IL 并对其进行调试的最简单方法是什么？

你使用 peverify 或 ILDasm 还是其他的？这两个工具需要将程序集写入磁盘，但 DynamicMethod 没有提供任何直接的方法来做到这一点。

显然 WinDbg aso 提供了一种查看 IL 的方法，但处理它非常尴尬。

像 VisualStudio 2010 的插件之类的东西将是理想的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-12-19T15:32:37.700

您可以使用 ILGenerator.MarkSequencePoint 允许逐步调试您发出的代码。

# css - 如何对 backgroundImage URL 进行淘汰赛绑定？

> ID：11209227
> 
> 赞同：32
> 
> 时间：2012-06-26T14:10:31.650
> 
> 标签：css, binding, knockout.js

我有一个可观察的数组

```
var items= [
    {"image": "/images/image1.jpg" },
    {"image": "/images/image2.jpg" },
    {"image": "/images/image3.jpg" }
]; 
```

我的模板如下所示：

```
<div data-bind="foreach: items">
   <div class="box" data-bind="style: {'background-image': url(image)}"></div>
</div> 
```

不幸的是，这不起作用。我想要的是这样的：

```
<div>
  <div class="box" style="background-image: url(/images/image1.jpg)"></div>
  <div class="box" style="background-image: url(/images/image2.jpg)"></div>
  <div class="box" style="background-image: url(/images/image3.jpg)"></div>
</div> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-06-26T14:12:50.543

你需要连接你的字符串：

```
data-bind="style: { backgroundImage: 'url(\'' + image() + '\')' }" 
```

如果`image`实际上是一个可观察的，您将需要调用它，否则您最终将连接该函数。

请注意，由于您要绑定到涉及该属性的表达式，因此您必须调用该函数（使用`()`）。否则，您将得到一个连接函数本身的 Javascript 表达式。
您不需要`()`简单绑定的唯一原因是 Knockout 会检测绑定何时返回属性函数并为您调用它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-26T18:54:37.210

我不知道这是更好还是更糟......

我在模型视图中组装了 url()：

```
var items= [
    {"image": "url(/images/image1.jpg)" },
    {"image": "url(/images/image2.jpg)" },
    {"image": "url(/images/image3.jpg)" }
]; 
```

然后我可以像往常一样对图像进行数据绑定：

```
data-bind="style: { 'background-image': image }" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-13T16:45:08.673

这是我的例子。始终使用它

```
<div data-bind="foreach: items">
    <div class="box" data-bind="style: {'backgroundImage': 'url('+ image +')'}"></div>
</div> 
```

# optimization - 对 CUDA 内核中的不同部分进行计时

> ID：11209228
> 
> 赞同：10
> 
> 时间：2012-06-26T14:10:32.647
> 
> 标签：optimization, cuda, benchmarking

我有一个调用一系列设备功能的 CUDA 内核。

获取每个设备功能的执行时间的最佳方法是什么？

在其中一个设备功能中获取一段代码的执行时间的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T14:12:10.643

在我自己的代码中，我使用该`clock()`函数来获取精确的时间。为方便起见，我有宏

```
enum {
    tid_this = 0,
    tid_that,
    tid_count
    };
__device__ float cuda_timers[ tid_count ];
#ifdef USETIMERS
 #define TIMER_TIC clock_t tic; if ( threadIdx.x == 0 ) tic = clock();
 #define TIMER_TOC(tid) clock_t toc = clock(); if ( threadIdx.x == 0 ) atomicAdd( &cuda_timers[tid] , ( toc > tic ) ? (toc - tic) : ( toc + (0xffffffff - tic) ) );
#else
 #define TIMER_TIC
 #define TIMER_TOC(tid)
#endif 
```

然后可以使用这些来检测设备代码，如下所示：

```
__global__ mykernel ( ... ) {

    /* Start the timer. */
    TIMER_TIC

    /* Do stuff. */
    ...

    /* Stop the timer and store the results to the "timer_this" counter. */
    TIMER_TOC( tid_this );

    } 
```

然后您可以阅读`cuda_timers`主机代码中的内容。

几点注意事项：

*   计时器在每个块的基础上工作，即如果您有 100 个块执行同一个内核，则将存储它们所有时间的总和。
*   话虽如此，计时器假定第零个线程处于活动状态，因此请确保不要在代码的可能不同部分调用这些宏。
*   计时器计算时钟滴答的数量。要获得毫秒数，请将其除以设备上的 GHz 数，然后乘以 1000。
*   计时器会稍微减慢您的代码速度，这就是为什么我将它们包装在其中`#ifdef USETIMERS`以便您可以轻松地关闭它们。
*   虽然`clock()`返回 type 的整数值`clock_t`，但我将累积值存储为`float`，否则对于花费超过几秒的内核（在所有块上累积），这些值将环绕。
*   选择`( toc > tic ) ? (toc - tic) : ( toc + (0xffffffff - tic) ) )`是必要的，以防时钟计数器回绕。

PS 这是我对[这个问题](https://stackoverflow.com/questions/11070298/timing-cuda-kernels/11070746#11070746)的回复的副本，因为所需的时间是针对整个内核的，所以没有得到很多分数。

# java - 使用 Selenium webdriver 从文件系统中拖放文件

> ID：11209234
> 
> 赞同：3
> 
> 时间：2012-06-26T14:10:46.400
> 
> 标签：java, selenium, drag-and-drop, webdriver

我正在测试一个 Web 应用程序，其中一种情况是能够将文件从文件系统中拖放到组件上。

与此类似：

[http://s3u.github.com/har-view/](http://s3u.github.com/har-view/)

[http://html5demos.com/dnd-upload](http://html5demos.com/dnd-upload)

有没有办法使用 Web 驱动程序模拟将文件从文件系统拖放到元素上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:08:51.470

不，不幸`WebDriver`的是，它只驱动浏览器，不能触摸它之外的任何东西。如果你想拖放一些东西，你必须使用[`Robot`](http://docs.oracle.com/javase/7/docs/api/java/awt/Robot.html)或任何其他工具（[可能有一个库](https://www.google.com/search?q=Java%20drag%27n%27drop%20programmatically)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-17T22:32:24.607

唯一对我有帮助的是运行我在[Selenium 中找到的 JS 代码：从文件系统拖放到 webdriver？](https://stackoverflow.com/questions/38829153/selenium-drag-and-drop-from-file-system-to-webdriver)

只需将整个内容复制粘贴到您的项目中即可。

请参阅：静态无效 DropFile（IWebElement 目标，字符串文件路径，int offsetX = 0，int offsetY = 0）{

```
 if (String.IsNullOrWhiteSpace(filePath))
        {
            throw new ArgumentNullException("filePath");
        }

        if (!File.Exists(filePath))
        {
            throw new FileNotFoundException(filePath);
        }

        IWebDriver driver = ((RemoteWebElement)target).WrappedDriver;
        IJavaScriptExecutor jse = (IJavaScriptExecutor)driver;
        WebDriverWait wait = new WebDriverWait(driver, TimeSpan.FromSeconds(30));

        string JS_DROP_FILE = @"
    var target = arguments[0],
        offsetX = arguments[1],
        offsetY = arguments[2],
        document = target.ownerDocument || document,
        window = document.defaultView || window;

    var input = document.createElement('INPUT');
    input.type = 'file';
    input.style.display = 'none';
    input.onchange = function () {
      target.scrollIntoView(true);

      var rect = target.getBoundingClientRect(),
          x = rect.left + (offsetX || (rect.width >> 1)),
          y = rect.top + (offsetY || (rect.height >> 1)),
          dataTransfer = { files: this.files };

      ['dragenter', 'dragover', 'drop'].forEach(function (name) {
        var evt = document.createEvent('MouseEvent');
        evt.initMouseEvent(name, !0, !0, window, 0, 0, 0, x, y, !1, !1, !1, !1, 0, null);
        evt.dataTransfer = dataTransfer;
        target.dispatchEvent(evt);
      });

      setTimeout(function () { document.body.removeChild(input); }, 25);
    };
    document.body.appendChild(input);
    return input;
    ";

        IWebElement input = (IWebElement)jse.ExecuteScript(JS_DROP_FILE, target, offsetX, offsetY);
        input.SendKeys(filePath);
        wait.Until(ExpectedConditions.StalenessOf(input)); 
```

# citations - 多重引用标准

> ID：11209236
> 
> 赞同：0
> 
> 时间：2012-06-26T14:10:48.620
> 
> 标签：citations

我们知道有一些标准，如果某些站点实施它们，它将与 zotero 兼容。

多次报废有标准吗？网站开发者在搜索结果页面中应该执行哪个标准？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T16:13:55.573

从 Zotero 论坛重新发布：unAPI（首选）和 COinS 都可以处理多个项目。其他方法不适用于搜索结果。

作为 unAPI 的示例，请参见例如 inSpire： [http ://inspirehep.net/search?p=citedby%3Aauthor%3Aellis+-refersto%3Aauthor%3Awitten](http://inspirehep.net/search?p=citedby%3Aauthor%3Aellis+-refersto%3Aauthor%3Awitten)

搜索页面上的 COinS 示例有哈佛的新霍利斯目录： [http ://hollis.harvard.edu/](http://hollis.harvard.edu/)

# javascript - D3 和 Dojo GFX 的比较

> ID：11209238
> 
> 赞同：5
> 
> 时间：2012-06-26T14:10:55.203
> 
> 标签：javascript, dojo, d3.js, dojox.gfx

我打算使用 D3 或 Dojo GFX 中的一种来创建一些大数据视觉效果，例如 TreeMap、Wave-forms 等。D3 的优点在于，许多这些可视化效果已经可以作为示例实现用于快速开发。它的进入-更新-退出范式也非常适合我的数据集。但是，如果据说 Dojo GFX 更稳定且更适合移动设备，我并不反对使用 Dojo GFX（并编写我自己的 Treemap 等实现）。

寻求建议和比较...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-25T20:18:31.190

**简而言之**，答案很简单：如果您使用的是 dojo，请使用 GFX 模块。如果您不使用 dojo，请使用 D3。

**更重要的是**，GFX 和 D3 实际上是同一件事：低级绘图 API（此处为*可视化工具包*），两者都可以与更大的 javascript 框架一起使用。实际上，GFX*必须*在 dojo 中使用。

由于图形/图表/绘图/其他通常只是 Web 应用程序的一部分，因此底层框架架构应该是选择可视化工具包的驱动力。所以基本上，如果你去 dojo 与否，将为你回答这个问题，如果你这样做，GFX 是一个很好的选择，因为它已经被烘焙了（尽管我应该提到 D3 可以包装在 AMD 中，如此处所[引用](https://github.com/mbostock/d3/pull/745)）。

### 现在，一个真正的答案

如果您认为可视化工具包是选择 javascript 框架的驱动力，而不是相反，那么这里有一些关于 GFX 与 D3 的想法：

**社区支持：**越来越多的人正在开发 D3 并提出问题。查看 github watchs/stars/forks，[D3](https://github.com/mbostock/d3)以 1.9k/22.7k/4.7k 领先[GFX 的](https://github.com/dojo/dojox/pulse)54/52/91（dojox 是 GFX 的父模块）。在 stackoverflow 上，与[GFX 的](https://stackoverflow.com/questions/tagged/dojox.gfx)26 个相比，[D3有近 7k 个标签。](https://stackoverflow.com/questions/tagged/d3.js)

**特点：** GFX 可以使用 SVG、VML、canvas 甚至 silverlight 进行渲染。由此，GFX 拥有卓越的跨平台、浏览器和版本支持。除此之外，这两个可视化工具包都可以访问您在以声明方式编写可视化时获得的每个功能。

**Learning Curve:** Both toolkits are very low level APIs that are complicated to learn. D3's enter-update-exit pattern may be especially confusing for those not familiar with extensive method chaining.

**Frameworks:** Both of these visualization toolkits are used in larger charting frameworks. GFX is used by [Dojo Charting](http://dojotoolkit.org/documentation/tutorials/1.8/charting/), D3 is used by many including [NVD3](http://nvd3.org/), [D3plus](http://d3plus.org/), and [Vega](http://trifacta.github.io/vega/) to name a few.

# oop - 如何显示静态方法的用法 UML 类图

> ID：11209240
> 
> 赞同：24
> 
> 时间：2012-06-26T14:11:04.783
> 
> 标签：oop, uml, class-diagram, conceptual

如何在 UML 类图中显示静态方法的使用？

```
class A{
    public static void test(){
    }
}

class B{
    public void b(){
    A.test();
    }
} 
```

显示关系的类图会是什么样子？如果有差异，将准备 UML 2.0。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-26T18:26:28.400

要显示静态方法，您需要在静态方法的名称下划线 - 在[这里](http://www.uml-diagrams.org/class-diagrams.html)查看更多详细信息。

至于驾驭这种关系；`class B`取决于 的存在`class A`。我们可以说 B 类对 A 类有“使用依赖关系”

```
class B ----uses----> class A 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-26T21:09:14.740

@RobertMS 是对的。

另一种选择是使用*刻板印象*：

```
..............................................................
....+----------------------------------------------------+....
....|                StringUtilityClass                  |....
....+----------------------------------------------------+....
....| [+] void: lowerCase()              <<non virtual>> |....
....| [+] void: upperCase()              <<non virtual>> |....
....| [+] String: toString()                <<override>> |....
....+----------------------------------------------------+....
....| [+] String: LowerCaseCopy(String Value) <<static>> |....
....| [+] String: UpperCaseCopy(String Value) <<static>> |....
....| [+] String: ReverseCopy(String Value)   <<static>> |....
....+----------------------------------------------------+....
.............................................................. 
```

**注意** 一些编程语言的最佳实践，尤其是那些`C`区分大小写的语法，将静态函数大写，并将其余函数保留为驼峰式小写。

干杯。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-03-12T11:12:46.797

要在 UML 类图中显示静态方法和属性，请在它们下划线：请参阅[UML Distilled p.66 或](https://rads.stackoverflow.com/amzn/click/com/0321193687)[UML 上层结构规范](http://www.omg.org/spec/UML/2.4/Superstructure/PDF)的第 7.3.19 节（功能）：

> 静态特征带有下划线。

为了显示类 B 和 A 之间的关系（其中 B 只使用 A 中的静态方法），您使用依赖项，而不是关联。关联总是在每一端的类*实例*之间，如 UML 上层结构规范的第 7.3.3 节（关联）：

> 关联指定可以在类型化实例之间发生的语义关系。

但是 B 类*依赖*于 A 类，如规范的第 7.3.12 节中所示：

> 依赖关系是一种关系，表示单个或一组模型元素需要其他模型元素来进行规范或实现。

用刻板印象来澄清依赖的性质可能是值得的。您*可以*使用`use`构造型，但这是非常通用的，实际上包含实例之间的标准关联（尽管您显然通常使用关联来显式显示它们）。正如 Fowler 在 UML Distilled 中所说，

> 许多 UML 关系暗示了依赖关系。从订单到客户的可导航关联 [在他的一个示例中......] 意味着订单依赖于客户。

关于使用什么刻板印象似乎没有标准。我曾经`usesStatically`很清楚依赖的性质；那是

`B --usesStatically--> A`

（或者，如果 B 类有一个 A 的实例作为静态字段，我会使用类似的东西，`B--containsStatically--> A`如果我在类图中明确表示 B；否则在 B 中只有一个带下划线的 A 类型的静态属性。）

# c# - “对象不能从 DBNull 转换为其他类型”

> ID：11209241
> 
> 赞同：12
> 
> 时间：2012-06-26T14:11:08.817
> 
> 标签：c#, datarow

当我的网站进入以下代码时，它会出现以下异常：

> System.InvalidCastException：对象不能从 DBNull 转换为其他类型。

为简洁起见，我只展示了相关代码（这是我得到的 4000+ LOC 文件）。

```
if (dr["STAGE"] is DBNull)
{
    dto.Stage = 1; // This is the line throwing the exception, according to stack trace
}
else
{
    dto.Stage = Convert.ToInt32(dr["STAGE"]);
} 
```

在这里，`dr`是一个 DataRow 对象，它是对数据库的查询结果，`dto`是一个只包含一些属性的基本类，它是其中`dto.Stage`的一个`int`成员。

我查看了具有相同错误消息的其他问题，但其中大多数似乎建议“检查它是否为 DBNull”，我已经在这样做了。

那么有人可以提出解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T14:13:23.597

使用`==`代替`is`

```
if (dr["STAGE"] == DBNull.Value)
{

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:19:48.420

使用这种稍微更有效的方法

```
int stageOrdinal = dr.GetOrdinal("STAGE");
while (dr.Read()) {
     dto = new DataTransferObject();
     if (dr.IsDBNull(stageOrdinal)) {
         dto.Stage = 1;
     } else {
         dto.Stage = dr.GetInt32(stageOrdinal);
     }
     //TODO: retrieve other columns.
     dtoList.Add(dto);
} 
```

按索引访问列比按名称访问要快。可以使用 的`GetOrdinal`方法检索列的索引`DataReader`。这最好在循环之前完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T14:14:09.963

请改用[System.Data.DataRow.IsNull](http://msdn.microsoft.com/en-us/library/3fwatee0.aspx)函数。

```
if(dr.IsNull("Stage"))
{
 ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T14:23:40.620

下面是一个可空数据类型的示例，您可以使用它来避免 DBNull 错误。下面的示例不是您遇到的问题的真正解决方案，而是您如何解决问题的示例。把它想象成学习钓鱼，而不是被给予一条鱼。

我从[http://msdn.microsoft.com/en-us/library/1t3y8s4s.aspx中提取了这个](http://msdn.microsoft.com/en-us/library/1t3y8s4s.aspx)

```
class NullableExample
{
    static void Main()
    {
        int? num = null;
        if (num.HasValue == true)
        {
            System.Console.WriteLine("num = " + num.Value);
        }
        else
        {
            System.Console.WriteLine("num = Null");
        }

        // y is set to zero
        int y = num.GetValueOrDefault();

        // num.Value throws an InvalidOperationException if num.HasValue is false
        try
        {
            y = num.Value;
        }
        catch (System.InvalidOperationException e)
        {
            System.Console.WriteLine(e.Message);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-07T10:05:40.673

@MarcGravell 在他的评论中有权利：

> 忽略堆栈跟踪中的确切行号；数字可能会略有偏差-我一直都看到。而是在带有断点的调试器中运行它，或者在确定它的同时添加额外的日志记录

@Sergey 的回答完全是错误的。

# mysql - MYSQL - 计算单个表内的差异

> ID：11209247
> 
> 赞同：4
> 
> 时间：2012-06-26T14:11:32.937
> 
> 标签：mysql

我正在寻找一种方法来计算单个表中整数之间的差异。

我正在计划一个如下所示的 MYSQL 表：

```
user    question    answer

1       1           3
1       2           3
1       3           2
1       4           5
1       5           1

2       1           2
2       2           3
2       3           1
2       4           5
2       5           3

3       1           3
3       2           3
3       3           4
3       4           5
3       5           3

4       1           5
4       2           3
4       3           2
4       4           5
4       5           1 
```

每个用户（在本例中）回答了 5 个问题，给出了 1 到 5 分的答案。

我正在寻找的是用户 2、3 和 4 中哪一个给出的答案与用户 1 提供的答案最相似。

我想到的是计算每个用户对每个问题给出的答案与用户 1 的答案之间的差异，然后将这些差异相加。

添加后数字最小的用户将与用户 1 最相似。

很抱歉，我真的不知道从哪里开始构建一个可以有效执行此操作的查询，并且想知道是否有人可以指出我正确的方向？我也愿意接受任何更好或更合乎逻辑的方法来构建相同结果的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:46:50.997

```
SELECT SUM(ABS(t2.answer - t1.answer)) AS total_diff, t2.user 
FROM my_table AS t1 
LEFT JOIN my_table AS t2 USING(question)
WHERE t1.user = 1 AND t2.user != t1.user
GROUP BY t2.user
ORDER BY total_diff ASC 
```

结果：

```
total_diff  user 
2       4
4       2
4       3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:58:44.627

```
SELECT 
yt1.user,
SUM(CASE WHEN yt1.answer = yt2.answer THEN 1 ELSE 0 END) AS howMuchAnswersInCommon
FROM yourTable yt1
INNER JOIN yourTable yt2 ON yt1.question = yt2.question 
WHERE yt2.user = 1 AND yt1.user != 1
GROUP BY yt1.user
ORDER BY howMuchAnswersInCommon DESC 
; 
```

这将为您提供最常见的用户 1 答案。

测试数据：

```
/*
create table yourTable (user int, question int, answer int);
insert into yourTable values 
(1,       1,           3),
(1,       2,           3),
(1,       3,           2),
(1,       4,           5),
(1,       5,           1),

(2,       1,           2),
(2,       2,           3),
(2,       3,           1),
(2,       4,           5),
(2,       5,           3),

(3,       1,           3),
(3,       2,           3),
(3,       3,           4),
(3,       4,           5),
(3,       5,           3),

(4,       1,           5),
(4,       2,           3),
(4,       3,           2),
(4,       4,           5),
(4,       5,           1);
*/ 
```

输出：

```
user    howMuchAnswersInCommon
4           4
3           3
2           2 
```

# jquery - JQGrid 不显示 json 数据

> ID：11209248
> 
> 赞同：0
> 
> 时间：2012-06-26T14:11:34.077
> 
> 标签：jquery, asp.net-mvc, jqgrid

我已经很努力了，但我没有得到任何成功。

我的控制器是

 `````
public ActionResult CompOff()
        {

            return View();

        }

         [HttpPost]
        public JsonResult CompOff(RegisterCompOff r)
        {
            var compoffs = db.RegisterCompOffs.Where(l => l.Employee.Id == this.EmployeeId).Select(l => new { l.CompOffDate, l.Description, l.ExpiryDate, l.IsApproved, l.IsUtilized }).ToList();
            return Json(compoffs);

        } 
````  `我的看法是

 `````
<table id="jqgProducts" cellpadding="0" cellspacing="0"></table>
<div id="jqgpProducts" style="text-align:center;"></div>

<script src="@Url.Content("~/Scripts/jquery.jqGrid.min.js")" type="text/javascript"></script>
 <script type="text/javascript">
     $(document).ready(function () {

         $('#jqgProducts').jqGrid({
             //url from wich data should be requested
             url: '@Url.Action("CompOff")',
             //type of data
             datatype: 'json',
             //url access method type

             mtype: 'POST',
             //columns names

             colNames: ['CompOffDate', 'Description', 'ExpiryDate', 'IsApproved', 'IsUtilized'],
             //columns model
             colModel: [
                            { name: 'CompOffDate', index: 'CompOffDate', align: 'left' },
                              { name: 'Description', index: 'Description', align: 'left' },
                            { name: 'ExpiryDate', index: 'ExpiryDate', align: 'left' },
                            { name: 'IsApproved', index: 'IsApproved', align: 'left' },

                            { name: 'IsUtilized', index: 'IsUtilized', align: 'left' }

                          ],
             //pager for grid
             pager: $('#jqgpProducts'),
             //number of rows per page
             rowNum: 10,
             //initial sorting column
             sortname: 'CompOffDate',
             //initial sorting direction
             sortorder: 'asc',
             //we want to display total records count
             viewrecords: true,
             //grid height
             height: '100%'
         });
     });
    </script> 
````  `我在我的控制器的 post 方法中得到 json 结果，但数据没有绑定到我的网格..我看到的是一个空网格，当我尝试绑定一些本地数据时，它工作得很好，可以有人吗请帮助我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T17:04:54.020

您必须使用必要的参数以正确的格式返回 JSON 数据。

例如。

```
return Json(new{
                 total = 1,
                 page = 1,
                 records = collection.Count, // actual data count
                 rows = collection // actual data
              }); 
```

您没有返回`total`、`page`（当前页面）`records`和`rows`。

试试这个..

```
[HttpPost]
public JsonResult CompOff(RegisterCompOff r)
{
        var compoffs = db.RegisterCompOffs.Where(l => l.Employee.Id == 
        this.EmployeeId).Select(l => new { l.CompOffDate, l.Description, l.ExpiryDate, 
        l.IsApproved, l.IsUtilized }).ToList();

        return Json(new{
            total = 100, // change into actual value
            page = 1, //first page
            records = compoffs.Count(), // no. of records you are returning now
            rows = compoffs // data
        });
} 
```

并添加以下部分以查看

 `````
jsonReader : {
                root: "rows",
                page: "page",
                total: "total",
                records: "records",  
                repeatitems: false,
                cell: "cell",
                id: "id",
                userdata: "userdata",    
               }, 
`````````

# cocoa - 使用 NSOutputStream POST 到 url

> ID：11209249
> 
> 赞同：2
> 
> 时间：2012-06-26T14:11:35.950
> 
> 标签：cocoa, post, nsoutputstream

所以我想做的就是向 url 发送一个 POST 请求。现在我尝试使用 NSURLRequest/NSURLConnection，但遇到问题并决定移到较低级别，也是因为我想发送大文件并认为直接处理流可能会更好。但是输出流委托似乎从未被调用，而且我似乎无法找到使用 NSOutputStream 的示例`initWithURL`。

```
NSURL *url = [NSURL URLWithString:NSString stringWithFormat: @"http://url"];
self.outputStream = [[NSOutputStream alloc] initWithURL:url append:NO];
[outputStream retain];
[outputStream setDelegate:self];
[outputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
[outputStream open]; 
```

似乎在 init 之后 outputStream 为空，我无法理解，因为我的 url 是一个有效的 url——我可以从终端 ping 它并从其他来源发送数据。我做错了什么，或者谁能告诉我如何使用流向 URL 写入 POST 请求？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:36:18.247

您不能用于`NSOutputStream`向 HTTP 服务器发送 POST 请求。

好的方法是创建一个`NSMutableURLRequest`并为该请求提供一个`HTTPBodyStream`然后创建一个`NSURLConnection`来发送请求。

这`HTTPBodyStream`是一个`NSInputStream`请求将从中读取正文。您可以使用`NSData`对象或文件的内容对其进行初始化。

如果您想提供自定义内容（例如，您想上传文件作为`multipart/form-data`请求的一部分），您可能需要子类化`NSInputStream`. 在这种情况下，我建议您查看[如何实现 CoreFoundation 免费桥接 NSInputStream 子类](http://blog.octiplex.com/2011/06/how-to-implement-a-corefoundation-toll-free-bridged-nsinputstream-subclass/)，它解释了如何解决使用自定义输入流时出现的问题`NSURLConnection`。或者您可以使用[ASIHTTPRequest](https://github.com/pokeb/asi-http-request)，它提供开箱即用的多部分 HTTP 请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-16T11:49:44.570

是的，您可以使用 NSOutputStream 发送 HTTP GET/POST 请求。

1.make & 打开你的流。

2.当流准备好写入时，`NSStreamEventHasSpaceAvailable`事件将在方法中发送：

```
- (void)stream:(NSStream *)aStream handleEvent:(NSStreamEvent)eventCode 
```

[https://developer.apple.com/documentation/foundation/nsstreamdelegate/1410079-stream?language=objc](https://developer.apple.com/documentation/foundation/nsstreamdelegate/1410079-stream?language=objc)

3.制作一个`CFHTTPMessageRef`&并写入数据。

像这样的代码：

```
- (void)stream:(NSStream *)aStream handleEvent:(NSStreamEvent)eventCode{
    switch (eventCode) {
    case NSStreamEventOpenCompleted:{
        // 
    }
        break;
    case NSStreamEventHasSpaceAvailable:{
        [self sendHTTPMessage];
    }
        break;
    default:{
        //
    }
        break;
}

- (void)sendHTTPMessage{
    //create a http GET message
    CFStringRef requestMethod = (CFStringRef)CFAutorelease(CFSTR("GET"));
    CFHTTPMessageRef httpRequest = (CFHTTPMessageRef)CFAutorelease(CFHTTPMessageCreateRequest(kCFAllocatorDefault, requestMethod, (__bridge  CFURLRef)yourURL,kCFHTTPVersion1_1));
    //set HTTP header
    CFHTTPMessageSetHeaderFieldValue(httpRequest, (__bridge CFStringRef)@"Host", (__bridge CFStringRef)@"yourhost.com");
    CFHTTPMessageSetHeaderFieldValue(httpRequest, (__bridge CFStringRef)@"Connection", (__bridge CFStringRef)@"close");
    //set HTTP Body
    ...
    //let's send it
    CFDataRef serializedRequest = CFHTTPMessageCopySerializedMessage(httpRequest);
    NSData *requestData = (__bridge_transfer NSData *)serializedRequest;
    [self.outStream write:requestData.bytes maxLength:requestData.length];
    [self.outStream close];
} 
```

请记住，关键是将 CFHTTPMessageRef 转换为要写入的字节。

# web-services - 是否有任何带有历史事实数据库的公共 API？

> ID：11209252
> 
> 赞同：5
> 
> 时间：2012-06-26T12:40:18.363
> 
> 标签：web-services, api, resources, wikipedia

免费历史信息的最常见来源是维基百科，但我缺少一个 API，可用于查询 2010 年 1 月 23 日发生的所有事情。一些 iPhone 应用程序背后有数据库（想到 www.historysurferapp.com，但还有大量的“今天发生的事情”应用程序”），但它们似乎是本土的和/或基于维基百科的。

任何人都知道某处是否有这样一个公共的“一切时间表”数据库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T13:20:14.123

最接近的是维基百科。答案是不。

编辑：这些是我问这个问题后发现的一些：

```
http://thebigdb.com/

http://www.mediawiki.org/wiki/API:Main_page 
```

EDIT2： [http://gdeltproject.org/](http://gdeltproject.org/) - 全球事件数据库

# ruby-on-rails - 在哪里可以找到可以包含在 Sprockets 指令中的库列表？

> ID：11209254
> 
> 赞同：3
> 
> 时间：2012-06-26T14:11:48.247
> 
> 标签：ruby-on-rails, asset-pipeline, ruby-on-rails-3.2, sprockets

我想在我的 Rails 应用程序中像我的其他 js 库一样包含[所选](http://harvesthq.github.com/chosen/)`application.js`库，如下所示：

```
//= require jquery
//= require jquery_ujs
//= require bootstrap
//= require_tree . 
```

但我不知道我是否只需要打字就`//= require chosen`可以了。

所以我试图找到一个可以包含在 sprockets 中的库列表，但我什么也没得到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:18:12.673

您需要将该 javascript 库打包为 gem。你很幸运，有[一颗](https://rubygems.org/gems/chosen-rails)宝石。

添加`gem chosen-rails`到您的`Gemfile`并运行`bundle install`- 命令。之后，您可以`//= require chosen-jquery`在您的`application.js`-file 中使用。

如需更多信息，请访问[此 gem 的 github 主页](https://github.com/tsechingho/chosen-rails)。

对你的问题。`chosen`如今，将此类库按原样打包到 gem中是很常见的。[只需在http://rubygems.org/](http://rubygems.org/)甚至 google上搜索您要查找的库的名称。

如果不存在这样的 gem，您可以自己打包一个（请参阅[这篇](http://prioritized.net/blog/gemify-assets-for-rails/)精彩的文章）或手动将库添加到您的`vendor`-assets 目录中。

# php - symfony：数据库连接真的需要root用户吗

> ID：11209259
> 
> 赞同：2
> 
> 时间：2012-06-26T14:11:59.990
> 
> 标签：php, database, security, symfony

作为 Symfony 设置的一部分，我需要执行以下任务：

```
php app/console doctrine:schema:update --force 
```

如果我指定的用户`app/config/parameters.ini`没有所有权限，则会失败。很公平，因为如果您想更新架构，您将需要足够的权限才能进行受限操作，例如删除/更改表。

然而，让我担心的是，在应用程序的常规使用中，同样的数据库用户也将被使用。我认为这是一个安全漏洞。

我应该如何避免这种情况？

--

额外信息：

[Symfony 2：多动态数据库连接](https://stackoverflow.com/questions/6409167/symfony-2-multiple-and-dynamic-database-connection)

这个问题向我展示了如何指定多个数据库供 Symfony 使用。这对我有用吗？我真的不需要能够在数据库之间切换，而只是能够指定应用程序在运行时使用受限用户；但是，在系统管理时，我需要能够使用 root 权限。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T15:49:40.667

在 config.yml 中，使用 root 用户。这将在控制台和开发模式下工作。

```
 doctrine:
          dbal:
             driver:   %database_driver%
             host:     %database_host%
             port:     %database_port%
             dbname:   %database_name%
             user:     root
             password: pw
             charset:  UTF8 
```

在 config_prod.yml 中，添加相同的配置块，但更改用户名/密码。然后，当应用程序在生产模式下运行时，它将使用权限较低的用户。

# jquery - 与 Jquery ui 手风琴插件作斗争

> ID：11209260
> 
> 赞同：0
> 
> 时间：2012-06-26T14:12:05.140
> 
> 标签：jquery, accordion

我已经使用 jquery ui 手风琴插件构建了这个手风琴，我有点理解它是如何工作的，但我正在努力寻找手风琴关闭鼠标的正确方法。当手风琴部分打开时，我还希望我自己的箭头图标换成向下箭头。这是小提琴：[jquery 手风琴插件](http://jsfiddle.net/AJBweb1986/Z6LWH/)

任何帮助表示赞赏，即使它指向正确的方向。最重要的是在mouseout时折叠

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:59:38.490

给你：[小提琴](http://jsfiddle.net/Z6LWH/14/)

```
$(function() {
    $( "#accordion" ).accordion({
        event: 'click',
        collapsible: true,
        active: false,
        icons: {
            "header": "yourIconClassClosed",
            "headerSelected": "yourIconClassOpen"
        }
    }).on('mouseleave', function() {
        $(this).accordion( "option", "active", false );
    }).children('li').on('mouseenter', function() {
        $(this).find('h3').trigger('click');
    });
}); 
```

编辑：你必须考虑我重建的 HTML：

```
<div id="helpmenu">
<ul id="accordion">
    <li>
        <h3><a href="#">About us</a></h3>
        <div class="accordhidden">
            <ul>
                <li>List item one</li>
                <li>List item two</li>
                <li>List item three</li>
            </ul>
        </div>
    </li>
   <li>
       <h3><a href="#">Section 1</a></h3>
        <div class="accordhidden">
            <ul>
                <li>List item one</li>
                <li>List item two</li>
                <li>List item three</li>
            </ul>
        </div>
    </li>
    <li>
        <h3><a href="#">Section 2</a></h3>
        <div class="accordhidden">
            <ul>
                <li>List item one</li>
                <li>List item two</li>
                <li>List item three</li>
            </ul>
        </div>
    </li>
    <li>
        <h3><a href="#">Section 3</a></h3>
        <div class="accordhidden">
            <ul>
                <li>List item one</li>
                <li>List item two</li>
                <li>List item three</li>
            </ul>
        </div>
    </li>
    <li>
        <h3><a href="#">Section 4</a></h3>
        <div class="accordhidden">
            <ul>
                <li>List item one</li>
                <li>List item two</li>
                <li>List item three</li>
            </ul>
        </div>
    </li>
</ul>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:20:44.833

这可能会回答您的部分问题

[http://jsfiddle.net/Z6LWH/1/](http://jsfiddle.net/Z6LWH/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:34:59.040

解决方案的另一部分：[设置图标类](http://jsfiddle.net/Z6LWH/7/)

```
$( "#accordion" ).accordion({
    event: "mouseover",
    collapsible: true,
    active: false,
    alwaysOpen: false,
    icons: {
        "header": "yourIconClassClosed",
        "headerSelected": "yourIconClassOpen"
    }
}); 
```

然后在这些类上设置样式。

# ios - 检测 UITableView 部分标题是否浮动

> ID：11209261
> 
> 赞同：5
> 
> 时间：2012-06-26T14:12:09.947
> 
> 标签：ios, uitableview

有没有办法检测一个节的标题`UITableView`当前是否浮动？我只想在浮动时将表格视图滚动到标题位置。

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T14:18:40.197

如果该部分的第一个单元格不再可见，则标题将浮动。所以：

```
NSIndexPath *topCellPath = [[self.tableView indexPathsForVisibleRows] objectAtIndex:0];
if (topCellPath.row != 0)
{
    // Header must be floating!
} 
```

`scrollToRowAtIndexPath:atScrollPosition:animated:`您可以通过滚动到索引路径和滚动位置来实现类似的效果`UITableViewScrollPositionNone`- 如果该部分中的第一个单元格已经在屏幕上，则不会滚动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-15T18:26:25.650

添加@robdashnash 答案的快速端口

```
extension UITableView
{
     func isFloatingSectionHeader( view:UITableViewHeaderFooterView )->Bool
     {
          if let section = section( for:view )
          {
              return isFloatingHeaderInSection( section:section )
          }
          return false
      }

     func isFloatingHeaderInSection( section:Int )->Bool
     {
         let frame = rectForHeader( inSection:section )
         let y = contentInset.top + contentOffset.y
         return y > frame.origin.y
     }

     func section( for view:UITableViewHeaderFooterView )->Int?
     {
         for i in stride( from:0, to:numberOfSections, by:1 )
         {
             let a = convert( CGPoint.zero, from:headerView( forSection:i ) )
             let b = convert( CGPoint.zero, from:view )
             if a.y == b.y
             {
                 return i
             }
         }
         return nil
     }
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-07T12:31:18.120

这行得通。

```
@implementation UITableView (rrn_extensions)

-(BOOL)rrn_isFloatingSectionHeaderView:(UITableViewHeaderFooterView *)view {
    NSNumber *section = [self rrn_sectionForHeaderFooterView:view];
    return [self rrn_isFloatingHeaderInSection:section.integerValue];
}

-(BOOL)rrn_isFloatingHeaderInSection:(NSInteger)section {
    CGRect frame = [self rectForHeaderInSection:section];
    CGFloat y = self.contentInset.top + self.contentOffset.y;
    return y > frame.origin.y;
}

-(NSNumber *)rrn_sectionForHeaderFooterView:(UITableViewHeaderFooterView *)view {
    for (NSInteger i = 0; i < [self numberOfSections]; i++) {
        CGPoint a = [self convertPoint:CGPointZero fromView:[self headerViewForSection:i]];
        CGPoint b = [self convertPoint:CGPointZero fromView:view];
        if (a.y == b.y) {
            return @(i);
        }
    }
    return nil;
}

@end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-06-01T12:53:54.833

**iOS 11.0+ solution for `UITableViews` as well as `UICollectionViews`**

In both cases, use the `scrollViewDidScroll` method. You can use the `currentHeader` property to store current header displayed at the top. `HEIGHT_OF_HEADER_VIEW` is a value you should specify yourself.

For `UITableView`

```
private var currentHeader: UITableViewHeaderFooterView? {
    willSet {
        // Handle `old` header
    } didSet {
        // Hanlde `new` header
    }
}

func scrollViewDidScroll(_ scrollView: UIScrollView) {
    let point = CGPoint(x: 0, y: HEIGHT_OF_HEADER_VIEW + tableView.contentOffset.y + tableView.adjustedContentInset.top)
    guard let path = tableView.indexPathForRow(at: point) else {
        return
    }

    let section = path.section
    let rect = tableView.rectForHeader(inSection: section)
    let converted = tableView.convert(rect, to: tableView.superview)
    let safeAreaInset = tableView.safeAreaInsets.top

    // Adding 1 offset because of large titles that sometimes cause slighly wrong converted values
    guard converted.origin.y <= safeAreaInset,
        let header = tableView.headerView(forSection: section) else {
        return
    }
    currentHeader = header
} 
```

For `UICollectionView`

```
private var currentHeader: UICollectionReusableView? {
    willSet {
        // Handle `old` header
    } didSet {
        // Handle `new` header
    }
}

func scrollViewDidScroll(_ scrollView: UIScrollView) {
    let x = (collectionView.collectionViewLayout as? UICollectionViewFlowLayout)?.sectionInset.left ?? 0
    let point = CGPoint(x: x, y: HEIGHT_OF_HEADER_VIEW + collectionView.contentOffset.y + collectionView.adjustedContentInset.top)

    guard let path = collectionView.indexPathForItem(at: point),
        let rect = collectionView.layoutAttributesForSupplementaryElement(ofKind: UICollectionView.elementKindSectionHeader, at: IndexPath(row: 0, section: path.section))?.frame else {
        return
    }

    let converted = collectionView.convert(rect, to: collectionView.superview)
    let safeAreaInset = collectionView.safeAreaInsets.top

    guard converted.origin.y <= safeAreaInset,
        let header = collectionView.supplementaryView(forElementKind: UICollectionView.elementKindSectionHeader, at: IndexPath(row: 0, section: path.section)) else {
        return
    }
    currentHeader = header
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-16T11:56:36.030

该代码对我有用。

```
- (BOOL)isSection0HeaderSticky {
    CGRect originalFrame = [self.listTableView rectForHeaderInSection:0];

    UIView *section0 = [self.listTableView headerViewForSection:0];

    if (originalFrame.origin.y < section0.frame.origin.y) {
        return  YES;
    }
    return NO;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-18T02:00:21.293

您可以先存储节标题视图的原始矩形。

```
 headerView.originalPoint = [tableView rectForHeaderInSection:section].origin; 
```

并将`scrollViewDidScroll:scrollView`消息发送到标题。

在您的标题视图中

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
   BOOL isFloating = self.frame.origin.y > self.originalPoint.y;
   if (isFloating) {
       //DO what you want
   }
} 
```

# php - 加入后的分组结果？

> ID：11209264
> 
> 赞同：2
> 
> 时间：2012-06-26T14:12:11.193
> 
> 标签：php, mysql, codeigniter, join, group-by

所以，我有三张桌子。`Movies`,`movies_genres`和`genres`. 我想通过它的 ID 获得一部电影，并在结果中加入它的流派。我设法加入了结果，但它没有按我想要的那样显示。我不确定我要问的是否可行。

这是我的查询：

```
SELECT `movies`.*, GROUP_CONCAT(genres.id) AS genre_id, GROUP_CONCAT(genres.name) AS genre_name
FROM (`movies`)
INNER JOIN `movies_genres`
    ON `movies_genres`.`movie_id` = `movies`.`id`
INNER JOIN `genres`
    ON `genres`.`id` = `movies_genres`.`genre_id` WHERE `movies`.`id` = 19908
GROUP BY `movies`.`id` 
```

查询是由 Codeigniters Active Record 类生成的，如果有帮助，这里是 Codeigniter 代码：

```
$this->db->select('movies.*, GROUP_CONCAT(genres.id) AS genre_id, GROUP_CONCAT(genres.name) AS genre_name');
$this->db->from('movies');
$this->db->where('movies.id', $movie_id);
$this->db->join('movies_genres', 'movies_genres.movie_id = movies.id', 'inner');
$this->db->join('genres', 'genres.id = movies_genres.genre_id', 'inner');
$this->db->group_by('movies.id'); 
```

这是我目前得到的结果：

```
Array
(
    [id] => 19908
    [movie_title] => Zombieland
    [overview] => An easily spooked guy...
    [genre_id] => 28,12,35,27
    [genre_name] => Action,Adventure,Comedy,Horror
) 
```

这就是我想要的：

```
Array
(
    [id] => 19908
    [movie_title] => Zombieland
    [overview] => An easily spooked guy...
    [genres] => array(
        0 => array(
            'id' => 28,
            'name' => Action
        ),
        1 => array(
            'id' => 12,
            'name' => Adventure
        ),
        1 => array(
            'id' => 35,
            'name' => Comedy
        ),
        1 => array(
            'id' => 27,
            'name' => Horror
        )
    )
) 
```

这可能吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:22:34.427

您列出的查询将有*n*行（其中*n* = 电影数），而您似乎想要的查询将有更多行（电影类型的条目数）。您最好保留该查询，并进行一些后期处理。

考虑：

得到它之后，只需通过以下方式运行您的结果（例如`$result`）数组：

```
foreach($result as &$row)
{
    // Split over commas
    $gi_elements = explode(',', $row['genre_id']);
    $gn_elements = explode(',', $row['genre_name']);

    // Build genre 
    $row['genre'] = array();
    for($i=0; $i<count($gi_elements); $i++)
    {
        $row['genre'][] = array('id' => $gi_elements[$i], 'name' => $gn_elements[$i]);
    }

     // Cleanup
     unset($row['genre_id']);
     unset($row['genre_name']);
} 
```

之后，$results 将完全符合您的要求，无需额外的数据库工作。

***编辑：***修正了一些错别字。

# ruby-on-rails - Neography 和 Neo4j 的困境

> ID：11209265
> 
> 赞同：2
> 
> 时间：2012-06-26T14:12:16.593
> 
> 标签：ruby-on-rails, heroku, devise, neo4j, neography

我正在尝试使用 neo4j 实现 rails 应用程序。对于托管，我发现 Heroku 支持 neo4j REST（公开测试版）。在寻找宝石时，我找到了neography 和neo4j。

我从 neo4j 开始，并没有找到对 REST 的支持。是否可以使用 REST？嵌入式数据库有什么好处吗？

如果我选择neography，可以在项目中使用像设计这样的宝石吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T06:35:11.203

我认为只有在使用 MRI Ruby 时才需要neography。如果您使用 jruby，则不需要使用 restful 服务器，并且根据文档，您的 neo4j 查询将运行得更快。Devise 可以很好地与 jruby 一起工作，尽管您会发现其他 gem 不能很好地与 Neo4j 一起工作（例如，声明式授权或 cancan），因为它们依赖于 ActiveRecord 而 Neo4j 只满足 ActiveModel。

如果你最终使用了 jruby，我强烈建议你使用 rvm 来安装它，并且不要忘记在运行 ruby​​ 时添加 '--1.9' 标志（或运行 "export JRUBY_OPTS='--1.9'"），因为jruby 1.6 默认为 ruby​​ 1.8，它不能立即与 Rails 3 兼容。

抱歉，我无法回答您关于 REST 客户端的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T09:08:21.913

原则上，Neo4j 嵌入式版本的优势在于出色的 Rails3 和性能提升，您无需被迫执行 REST。但是，Heroku 不提供永久字段系统，这就是 Neo4j 插件在 REST 上运行的原因，因此 Neography 对您来说是一个不错的选择。

# java - 使用 ServiceLoader 进行动态库加载和前后检查

> ID：11209267
> 
> 赞同：0
> 
> 时间：2012-06-26T14:12:21.740
> 
> 标签：java, dll, serviceloader

[这个问题是解决附加库动态加载问题](https://stackoverflow.com/questions/11134159/how-to-load-attachprovider-attach-dll-dynamically)的下一步。我有一些这样的：

```
public static void loadAttachProvider(String binPath) throws Exception {
    /*
     * If AttachProvider is already available now then propably we are in JDK
     * or path to attach.dll was specified as java.library.path on startup
     */
    if (isAttachProviderAvailable()) return;

    /*
     * In normall-use code I have generated binPath appropriate to platform (VM)
     * family and bitness (e.g. win32 or win64)
     */
    System.setProperty("java.library.path", binPath);

    // Reload library path hack
    Field sys = ClassLoader.class.getDeclared("sys_paths");
    sys.setAccessible(true);
    sys.set(null, null);

    // Here I want to be sure that AttachProvider is available
    //System.loadLibrary("attach"); <- I'm try this too, but it's not suffiecient
    if (!isAttachProviderAvailable()) {
        throw new IOException("AttachProvider not available");
    }
} 
```

检查 AttachProvider 的可用性如下所示：

```
public static boolean isAttachProviderAvailable() {
    // This line is a substance of AttachProvider.providers() method
    ServiceLoader<AttachProvider> providers = ServiceLoader.load(AttachProvider.class, AttachProvider.class.getClassLoader());
    try {
        for (Iterator<AttachProvider> it = providers.iterator(); it.hasNext();) {
            /*
             * In normall-use code the "windows" constant is replaced
             * by something like platform-specific PLATFORM_FAMILY
             */
            if (it.next().type().equals("windows")) return true;
        }
    } catch (ServiceConfigurationError ex) {}
    return false;
} 
```

如果您使用 JDK 的私有 JRE 运行它，那么一切都会好起来的，因为 JDK`attach.dll`在默认库路径中。

## 问题

仅当我删除第一次出现时，这才有效`isAttachProviderAvailable`，因为如果我尝试`AttachProvider`在它可用之前实例化，那么我无法在稍后`attach.dll`加载时实例化它。`ServiceLoader`不会根据新的库路径刷新。如何解决这个问题？如何在`AttachProvider`不实例化的情况下检查可用性或如何刷新`ServiceLoader`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:46:37.027

解决了第一个附加检查替换为如下内容：

```
try {
    System.loadLibrary("attach");
    if (isAttachProviderAvailable()) return;
    throw new IOException("AttachProvider not available");
} catch (UnsatisfiedLinkError ex) {
   /*
    * dll can't be loaded, so we need to specify special binpath
    * and reload library path as post above
    */
} 
```

但是我正在等待更好的解决方案。

# javascript - 删除重复的功能

> ID：11209268
> 
> 赞同：0
> 
> 时间：2012-06-26T14:12:22.537
> 
> 标签：javascript, jquery, function

这很难解释，所以我会尽力而为。

是否可以使用 .remove() 删除重复的 javascript 函数？

**功能**

```
function readytouseCard() {
    console.log(this);
    $('.cardCVV input[name=cvv1]').keyup(function () {
        console.log("s");
        var checkCVV = $('.cardCVV input[name=cvv1]').filter(function () {
            return $.trim(this.value).length < 3;
        }).length === 0;
        if (checkCVV) {
            $("li.checkCode").addClass("checked");
        } else {
            $("li.checkCode").removeClass("checked");
        }
        checklistCheck();
    });

    function checklistCheck() {
        var counting = $("li.checked:not(.title)").length;
        if (counting == 6) {
            console.log(counting);
            $("input[name=purchase]").attr("disabled", false);
            $("input[name=purchase]").removeClass("purchase-btn-disabled");
            $("input[name=purchase]").addClass("purchase-btn");

        } else {
            $("input[name=purchase]").attr("disabled", true);
            $("input[name=purchase]").removeClass("purchase-btn");
            $("input[name=purchase]").addClass("purchase-btn-disabled");
        }
    }
} 
```

**主要的**

```
$("li#usercurrentcc").click(function (e) {
    e.preventDefault();
    var selectedID = $(this).attr("data-id");
    var qString = 'selectedID=' + selectedID;
    $.post('/assets/inc/get-logged-info-card.php', qString, function (results) {
        if ($("#usercurrentccbox, #addnewccbox").length != 0) {
            $("#usercurrentccbox, #addnewccbox").fadeOut("fast", function () {
                $(this).remove();
                $("<div class='creditCardDetails' id='usercurrentccbox'><div class='creditCard'><div class='cardChoice'><span>Choose Card Type</span><input name='cctype1' type='radio' value='V' class='lft-field' id='visa' /><label for='visa'></label><input name='cctype1' type='radio' value='M' class='lft-field' id='mastercard' /><label for='mastercard'></label><input name='cctype1' type='radio' value='A' class='lft-field' id='amex' /><label for='amex'></label></div><!--cardChoice--><div class='cardNumber'><input name='ccn1' id='ccn' type='text' class='long-field' value='" + results[0].maskccn + "' maxlength='19' readonly /></div><div class='cardCVV'><input name='cvv1' id='cvv' type='text' maxlength='5' class='small-field' /></div><div class='creditCardName'><input name='ccname1' id='ccname' type='text' class='long-field' value='" + results[0].ccname + "' readonly/></div><div class='cardDate'><input name='exp11' id='exp1' type='text' maxlength='2' class='small-field' value='" + results[0].ccm + "' readonly /><input name='exp21' id='exp2' type='text' maxlength='4' class='small-field' value='" + results[0].ccy + "' readonly /></div></div><!--creditCard-->").insertAfter("#paymentCardChoice");
                $('#usercurrentccbox .cardChoice input#' + results[0].cct + '').attr("checked", true);
                $('#usercurrentccbox .cardChoice label').removeClass("active");
                $('#usercurrentccbox .cardChoice label[for="' + results[0].cct + '"]').addClass("active");
                $("li:not(.title,.checkCode)").addClass("checked");
            });
            readytouseCard();
        } else {
            $(".submit-btn").fadeIn();
            $("<div class='creditCardDetails' id='usercurrentccbox'><div class='creditCard'><div class='cardChoice'><span>Choose Card Type</span><input name='cctype1' type='radio' value='V' class='lft-field' id='visa' /><label for='visa'></label><input name='cctype1' type='radio' value='M' class='lft-field' id='mastercard' /><label for='mastercard'></label><input name='cctype1' type='radio' value='A' class='lft-field' id='amex' /><label for='amex'></label></div><!--cardChoice--><div class='cardNumber'><input name='ccn1' id='ccn' type='text' class='long-field' value='" + results[0].maskccn + "' maxlength='19' readonly /></div><div class='cardCVV'><input name='cvv1' id='cvv' type='text' maxlength='5' class='small-field' /></div><div class='creditCardName'><input name='ccname1' id='ccname' type='text' class='long-field' value='" + results[0].ccname + "' readonly/></div><div class='cardDate'><input name='exp11' id='exp1' type='text' maxlength='2' class='small-field' value='" + results[0].ccm + "' readonly /><input name='exp21' id='exp2' type='text' maxlength='4' class='small-field' value='" + results[0].ccy + "' readonly /></div></div><!--creditCard-->").insertAfter("#paymentCardChoice");
            $('#usercurrentccbox .cardChoice input#' + results[0].cct + '').attr("checked", true);
            $('#usercurrentccbox .cardChoice label').removeClass("active");
            $('#usercurrentccbox .cardChoice label[for="' + results[0].cct + '"]').addClass("active");
            $("li:not(.title,.checkCode)").addClass("checked");
        }
        readytouseCard();
    }, "json");
});
readytouseCard(); 
```

该功能在第一次单击时启动并工作，但之后它不再工作。控制台日志只显示**Window #**，当我再次单击时它显示**Window # Window #**

所以我希望有一种方法可以使用 .remove(); 杀死函数 readytouseCard();

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:21:28.973

它是全局的，这意味着我们可以通过窗口访问它。

```
window.readytouseCard() = function(){
  return false;
} 
```

现在我们已经完成了，函数内容已被替换为`return false;`which will mimic `nothing happening`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:22:21.600

您不能“删除”函数，只能覆盖它们，例如`readytouseCards = function(){}`.

但是我不明白，你为什么要那样做。控制台日志记录`Window`是正确的，因为您`console.log(this);`在函数的第一行。由于您`readytouseCards`从全局上下文中调用，`this`因此绑定到`window`.

**您的实际问题是您在** `readytouseCards()`. 因此第二次调用该函数会附加事件处理程序**两次**。这导致在`checklistCheck()`每个 keyup 上被调用两次。这由您的控制台记录`window`两次来指示。

您需要重构整个代码：

在开始时通过`.on()`（[jQuery on()](http://api.jquery.com/on/)）附加事件处理程序一次，以便稍后添加到 dom 的元素也附加事件处理程序。

```
$(document).on('keyup', '.cardCVV input[name=cvv1]', function () { ... } 
```

`readytouseCard()`并通过将其移`checklistCheck()`出来终止该功能。最后，省略`readytouseCard();`调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:22:28.290

我已经重新缩进了你的代码。正如你现在看到的，当`#usercurrentccbox, #addnewccbox`Ajax请求后发现有，该函数会被调用两次。只需删除第一个。

如果您想在事件侦听器执行一次后自动删除它，jQuery 提供[`.one()`](http://api.jquery.com/one/).

您不能删除函数。如果函数在每次调用时都由标识符确定，则您可以使用不同的函数覆盖该变量。但是，当对函数的引用存储在不可访问的变量中时，例如添加为事件侦听器时，这将不起作用。然后你需要编码：

```
var called = false;
function executeOnlyOnce(...) {
    if (called) return;
    called = true;
    ...
} 
```

# java - 包 org.python.util 不存在

> ID：11209271
> 
> 赞同：0
> 
> 时间：2012-06-26T14:12:34.083
> 
> 标签：java, classpath, embed, package, jython

另一个问题。我已经将我的 Jython.jar 放入我的计算机识别为 Java CLASSPATH 的地方。完成后，编译器找不到从 Org.Python 导入的任何内容！我是否也需要将 Jar 与 java 代码放在同一个文件夹中？

感谢任何回复的人：D

- - - - - - - - - - - - - - - - - - - - - - -更新 - - --------------------------------------

还是行不通

在 CLASSPATH 我有 Jython.jar。在我的代码和批处理编译器的位置，我有 jar。我输入了“import org.python.util.*;” 没有别的东西是我的代码的开始

它仍然给我错误：C

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:22:16.780

确保您正确拼写了包裹！在 java 中，约定是使用小写字母的包：`org.python`

如果您使用命令行编译和运行代码，则需要添加包含给定`Jyhton.jar`文件的文件夹。

如需更多帮助，请查看：[http ://docs.oracle.com/javase/1.3/docs/tooldocs/win32/classpath.html](http://docs.oracle.com/javase/1.3/docs/tooldocs/win32/classpath.html)

如果您使用的是 IDE：

**蚀：**

得到了`Properties/Java Build Path/Libraries`。从那里您可以添加外部罐子。

**网豆：**

转到项目`Properties/Libraries/Compile`选项卡并添加您想要包含的所有 JAR。

# git - 从 Mercurial 向 Git 贡献补丁？

> ID：11209273
> 
> 赞同：8
> 
> 时间：2012-06-26T14:12:44.397
> 
> 标签：git, mercurial, repository

我想派生一个 Git 存储库，将其转换为 Mercurial，并在完成后将我的更改贡献回原始 Git 存储库。我更关心安全稳定的转换过程，而不是它的便利性。我会`pull`定期将 Git 更改为 Mercurial，但很少回馈任何更改。

我不习惯使用[hg-git](https://bitbucket.org/durin42/hg-git)，因为针对该项目报告的许多错误多年来都没有得到答复。我怀疑使用`hg convert`将 Git 转换为 Hg 比使用`hg-git`.

我的问题是：假设我已经将存储库转换为 Mercurial 并进行了一些更改，**我如何将这些更改贡献回官方存储库？**我想在不丢失任何历史信息的情况下将我的更改贡献回官方 Git 存储库（也就是说，我不想将多个更改集折叠成一个）。

最简单和最安全的方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-26T15:55:45.720

您可以尝试将 Mercurial 提交导出为补丁：

```
hg export --git -r 1 >patch.diff 
```

这个`.diff`文件应该被 Git 识别，并且可以添加到 git repo 中[`git apply`](http://git-scm.com/docs/git-apply.html)。
（这在“[将 Mercurial Repository 转换为 Git](https://stackoverflow.com/questions/1389307/convert-a-mercurial-repository-to-git) ”中提出了建议，其中还提到了更新的[脚本）`hg-fast-export`](http://repo.or.cz/w/fast-export.git)

`--git`选项将[`hg export`](http://www.selenic.com/mercurial/hg.1.html#export)确保您生成 git 扩展差异格式的差异。有关[`hg help diffs`](http://www.selenic.com/mercurial/hg.1.html#diffs)更多信息，请参阅。

# php - php sdk - 在没有应用授权的情况下获取 user_id

> ID：11209274
> 
> 赞同：0
> 
> 时间：2012-06-26T14:12:45.980
> 
> 标签：php, facebook, facebook-php-sdk, authorize

是否可以在不要求用户授权应用程序的情况下从 facebook 用户获取 user_id？

我只想让 user_id 来识别用户..如果用户不想使用该应用程序，则用户不需要 id..但是 facebook 中的每个用户都可以投票给用户解决方案..因此我需要用户 id识别用户..我不想在用户名或其他内容中写一些东西..

[http://developers.facebook.com/docs/authentication/signed_request/](http://developers.facebook.com/docs/authentication/signed_request/)

在这里我读到应该返回user_id..但是我删除了我的用户的应用程序权限..现在我在签名请求中缺少user_id..

请有人帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:35:52.940

> 是否可以在不要求用户授权应用程序的情况下从 facebook 用户获取 user_id？

不。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:35:04.907

如果您有电子邮件，您可以执行以下操作：

```
$facebook->api('/me?fields=email'); 
```

它将返回：

```
Array
(
    [email] => xxx
    [id] => 934579348

) 
```

# postgresql - 如何在具有一对多关系的表上维护记录历史？

> ID：11209277
> 
> 赞同：2
> 
> 时间：2012-06-26T14:12:54.153
> 
> 标签：postgresql, database-design, one-to-many

我有一个“服务”表，用于详细说明我们提供的服务。需要记录的数据中有几个小的一对多关系（都具有对 service_id 的外键约束），例如：

```
service_owners -- user_ids responsible for delivery of service
service_tags -- e.g. IT, Records Management, Finance
customer_categories -- ENUM value
provider_categories -- ENUM value
software_used -- self-explanatory 
```

我遇到的问题是我想保留对服务的更新历史记录，为此我在表上使用了更新触发器，该触发器执行插入到与原始列匹配的历史记录表中。但是，如果对上述数据使用规范化方法，为每个一对多关系使用单独的表和外键，则对这些表的任何更新都不会在服务历史记录中被识别。

有没有人有什么建议？似乎我需要将子密钥存储在服务表中以保持服务历史记录的完整性。带分隔符的文本字段在这里是一种有效的方法吗？或者，当我使用 postgreSQL 时，也许数组也是一种有效的选择？虽然这些感觉有点脏！

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:27:35.347

如果您的表是：

```
create table T (
    ix int identity primary key,
    val nvarchar(50)
) 
```

你的历史表是：

```
create table THistory (
    ix int identity primary key,
    val nvarchar(50),
    updateType char(1), -- C=Create, U=Update or D=Delete
    updateTime datetime,
    updateUsername sysname
) 
```

然后你只需要在所有感兴趣的表上放置一个更新触发器。然后，您可以找出任何/所有表在历史上任何时候的状态，以确定当时的关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T18:26:03.907

我会尽可能避免在任何数据库中使用数组。

我不喜欢更新，因为你在这里说的确切原因......你会丢失信息，因为它被覆盖了。我的回答很简单……不要更新。不确定您是否处于可以实现这一点的地步……但是如果可以的话，我建议您使用主表本身来存储历史记录（不需要第二组历史记录表）。

在主标题表中添加一个名为“活动”的列。这可以是一个字符或一个位（0 表示关闭，1 表示打开）。然后它有点触发魔法......当执行更新时，您在表中插入一行与被覆盖的记录相同，状态为“0”（或非活动），然后更新现有行（这进程保持活动记录上的 ID 列相同，新插入的记录是具有新 ID 的非活动记录）。

这样就不会丢失任何数据（诚然，您存储了很多行......）并且可以通过选择 active = 0 轻松查看历史记录。

这里的痛苦是，如果你正在处理已经实现的东西……每个现有的查询到这个表都需要更新，以包括对活动列的检查。如果您正在设计一个新系统，那么这个解决方案很容易实现，但如果它是一个长期存在的应用程序，那就很痛苦了。不幸的是，在您可以修改 where 子句之前，现有报告将包括关闭和打开记录（不会引发错误）

# bash - 通过批处理查询文件写入状态（CMD客户端到BASH服务器）

> ID：11209279
> 
> 赞同：0
> 
> 时间：2012-06-26T14:12:54.770
> 
> 标签：bash, batch-file, cmd

**小故事：需要一种方法从客户端（使用 CMD 批处理）获取服务器上文件的写入状态（使用 BASH）。**

长期潜伏者，首次海报。我对我正在寻找的各种变体进行了多次搜索，但还没有找到足够的数据。

我正在用 CMD 编写一个批处理文件（因为客户端可以是安装了未知软件包的任何 WinOS [XP - up]）。该批次使用 puTTY 的“plink”通过 SSH 连接到服务器。一旦连接到服务器，plink 就会执行命令将数据写入新文件。写完那个文件后，我使用 PSCP 将文件复制到客户端 *到目前为止，一切顺利；我已经成功地完成了这一切。*

该文件的创建是即时的，但写入所有数据所需的时间是未知/可变的。因此，我需要一种自动化方法来确定文件何时完成，然后复制它。在我的情况下，简单地使用超时/睡眠 XX 秒是不可行的。

到目前为止，我采取的方法（迄今为止尚未成功）是使用“stat -c '%s' filemane”重复抓取文件大小并循环运行，直到grab1 EQU grab2，指示一个完整的文件。我发现这很困难，因为我无法将 stat 的输出放入 CMD 批处理中进行处理。

Q1：这（统计结果进入 CMD for 循环）是最好的方法吗？也许 BASH 中存在一些东西？

Q2：如果 Q1 为真，关于如何将统计结果作为变量放入 CMD 批处理以解析/分析数据的任何想法？

提前感谢您的建议和您的时间。DCT

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:22:52.763

让写入文件的命令使用临时文件名写入文件。因此，如果将调用它`xyz.txt`，将其写入 filename `tmpxyz.txt.tmp`，那么最后一步将是重命名。

这样您就可以检查命名文件是否存在。

我发现通常给文件一个唯一的名称是个好主意，可能包含日期和时间。

# emacs - js2 模式下的高锁坏了

> ID：11209282
> 
> 赞同：2
> 
> 时间：2012-06-26T14:12:57.357
> 
> 标签：emacs, elisp

这困扰了我一段时间。我使用 `hi-lock' 或更具体地说是[highlight-symbol](http://nschum.de/src/emacs/highlight-symbol/)。但是，突出显示在 js2 模式下不起作用。

在我深入挖掘之前，想知道是否有人能快速获胜。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T08:56:36.910

这也可能有帮助： http: [//mihai.bazon.net/projects/editing-javascript-with-emacs-js2-mode/js2-highlight-vars-mode](http://mihai.bazon.net/projects/editing-javascript-with-emacs-js2-mode/js2-highlight-vars-mode)

它更聪明，理解变量的范围，并且内置了基本的重构（即你可以用 Mr 重命名所有出现的变量）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T03:09:11.263

解决了：

```
(eval-after-load "hi-lock"
  '(defadvice hi-lock-set-pattern (around js2-hack activate compile)
     "js2 sets `font-lock-fontified' to t but doesn't really use the font-lock mechanism "
     (if (eq major-mode 'js2-mode)
         (let ((font-lock-fontified nil))
           ad-do-it)
       ad-do-it))) 
```

# jquery - jquery $("#id").load() 第二次没有触发 document.ready()

> ID：11209285
> 
> 赞同：0
> 
> 时间：2012-06-26T14:13:02.213
> 
> 标签：jquery, asp.net-mvc-3, razor, jqgrid

我在 Razor 视图引擎的 asp.net MVC3 中使用 jquery。我有 jquery 选项卡控件，在选项卡导航上我加载了 myusercontrol.cshtml 页面。在 myusercontrol.cshtml 页面上，我有

```
 $(document).ready(function (){ loadjqgrid();});. 
```

单击每个选项卡时，我都会这样做

```
 $("#fragment-1").load("MyAction_in_controller"); 
```

这仅在我单击选项卡时第一次调用，第二次单击时控制不会传递给控制器​​。相反，什么也没有发生。请指教。

提前非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:15:36.020

`$(document).ready`仅触发`DOMContentLoaded`只能发生一次的事件。加载新内容不会触发该事件。

相反，将其背后的代码抽象为一个函数并调用该函数。

```
function domready () {
    // do stuff
}

$(document).ready(domready);

$("#fragment-1").load("MyAction_in_controller",domready); 
```

但是，很可能有更好的方法来处理它，例如委托事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:43:05.287

如果我对您的理解正确，您想`loadjqgrid`在加载事件后每次单击选项卡时运行？如果是这样，您可以这样做：

`$("#fragment-1").load("MyAction_in_controller",loadjqgrid);`

# cpu-architecture - CISC指令长度

> ID：11209286
> 
> 赞同：2
> 
> 时间：2012-06-26T14:13:02.333
> 
> 标签：cpu-architecture, instruction-set

我想知道，当今大多数 CISC 架构上 CISC 指令的最大可能长度是多少？

我还没有找到明确的答案，但理论上[建议它是 16 字节长](http://archive.org/details/IntroductoryIntelX86ArchitectureAssemblyApplicationsDay1Part1)。

在大约 15:00 分钟的视频中，为什么演讲者建议“理论上”，为什么正好是 16 个字节？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T14:32:31.003

在实践中也是如此。对于 x86-64，AMD 已将允许的指令长度限制为 15 个字节。之后，指令解码器将放弃并发出错误信号。

否则，由于有多个指令前缀和覆盖字节，我们不知道该指令究竟能得到多长时间。如果我们允许某些前缀的冗余重复，则完全没有限制。

Agner Fog 描述了这个问题：

> 同时执行三个、四个或五个指令并不罕见。限制不是我们有很多的执行单元，而是指令解码器。一条指令的长度可以是 1 到 15 个字节。如果我们想同时解码多条指令，那么我们就有一个严重的问题。在我们知道第二条指令从哪里开始之前，我们必须知道第一条指令的长度。所以我们不能在解码第一条指令之前解码第二条指令。解码本质上是一个串行过程，需要大量硬件才能在每个时钟周期解码多条指令。换句话说，指令的解码可能是一个严重的瓶颈，指令代码越复杂，情况就越糟糕。

[在此处](http://www.agner.org/optimize/blog/read.php?i=25)查看他的博客文章的其余部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-14T08:57:17.843

CISC 是一种*设计理念*，而不是**架构**，因此没有“CISC 指令长度”之类的东西，只有特定 CISC 架构（如 x86 或摩托罗拉 68k）的指令长度

专门谈论 x86 那么限制是 15 个字节。理论上，指令长度可以是*无限*的，因为前缀可以重复。然而，这使得解码器变得困难，因此英特尔在 80286 中开始将其限制为 10 个字节，然后在以后的 ISA 版本中限制为 15 个字节。有关它的更多信息，请阅读

*   [x86_64 ASM - 指令的最大字节数？](https://stackoverflow.com/q/14698350/995714)
*   [没有任何前缀的 Intel 386 指令的最大长度是多少？](https://stackoverflow.com/q/34052200/995714)

另请注意，RISC 并不意味着固定长度的指令。现代 MIPS、ARM、RISC-V……[都有变长指令模式](https://en.wikipedia.org/wiki/Instruction_set_architecture#Variable_length)来增加代码密度

# python - urlencode 不起作用

> ID：11209287
> 
> 赞同：0
> 
> 时间：2012-06-26T14:13:08.910
> 
> 标签：python, urllib2

代码：

```
import urllib,urllib2
url = 'http://www.pythonchallenge.com/pc/def/linkedlist.php'
print urllib2.urlopen(url).read()
print urllib2.urlopen(url,urllib.urlencode({'nothing':12345})).read() 
```

我遇到的问题是为什么两个“打印”输出相同的内容，我的代码哪里有问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:21:24.237

urlopen 的第二个参数是要发布的数据。如果您需要 URL 参数，则需要创建 URL：

```
print urllib2.urlopen("%s?%s" % (url,urllib.urlencode({'nothing':12345}))).read() 
```

# google-chrome - 向 Google Chrome 扩展程序注入广告

> ID：11209290
> 
> 赞同：3
> 
> 时间：2012-06-26T14:13:14.850
> 
> 标签：google-chrome, google-chrome-extension

我正在开发一个谷歌浏览器扩展，并计划使用允许的功能注入广告。我在“广告行为”前面检查了“此扩展程序将广告注入某些第三方网站”。

我的问题是，我如何以及在哪里提及广告来源？说，如果我想显示 google adsense，我该如何设置？

我今天一整天都在搜索它，但在任何地方都没有得到任何信息。

谢谢，
詹姆斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T20:04:05.043

注入广告并不是那么简单。您将面临的第一个问题是找到一个允许扩展程序在页面中注入广告的广告网络。AdSense 不允许这种行为。第二个（也许更复杂）的问题是注入广告。在 chrome 扩展中，您可以使用[脚本注入](http://code.google.com/chrome/extensions/content_scripts.html#pi)将广告添加到页面。真正的问题是在哪里放置广告。它们应该以巧妙的方式放置；确保它们不与页面布局/功能冲突；它们不应该无处不在，在每个页面上，否则您的用户会立即卸载该扩展程序；如果您不希望您的扩展程序被标记为恶意软件，那么您绝对不应该只替换现有广告。

由于这些和其他问题，我还没有在我的扩展程序中添加广告，我正在努力从中获得一些钱，因为它花费了我大量的时间来创建它，而且我收到的捐款非常非常少考虑到超过 150.000 个用户。

希望我能帮上忙。

# iphone - 如何在 iphone 中只获取一次当前的地理点？

> ID：11209295
> 
> 赞同：6
> 
> 时间：2012-06-26T14:13:29.447
> 
> 标签：iphone, cllocationmanager

我在 viewDidLoad 方法中使用以下代码

```
 CLLocationManager *locationManager = [[CLLocationManager alloc] init];
    locationManager.delegate = self;
    locationManager.distanceFilter = kCLDistanceFilterNone; // whenever we move
    locationManager.desiredAccuracy = kCLLocationAccuracyBestForNavigation; 
    [locationManager startUpdatingLocation]; 
```

然后在位置改变时连续调用下面的方法。

```
- (void)locationManager:(CLLocationManager *)manager
    didUpdateToLocation:(CLLocation *)newLocation
           fromLocation:(CLLocation *)oldLocation 
```

但我只想要一次当前的地理点。有没有什么方法可以直接为您提供当前的地理点？当我单击某个按钮时，我想计算当前地理位置与其他位置之间的距离。如果有人知道，请帮助我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T14:18:44.063

在`- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation`你可以打电话

```
[manager stopUpdatingLocation]; 
```

# php - 如何在 MySQL 数据库表列中查找最常用的单词

> ID：11209297
> 
> 赞同：2
> 
> 时间：2012-06-26T14:13:30.397
> 
> 标签：php, mysql, sql

我有以下格式的表格：

```
id | title
---+----------------------------
1  | php jobs, usa
3  | usa, php, jobs
4  | ca, mysql developer
5  | developer 
```

我想在标题字段中获取最受欢迎的关键字，请指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:24:55.183

如果您有关键字列表，则可以执行以下操作：

```
select kw.keyword, count(*)
from t cross join
     keywords kw
     on concat(', ', t.title, ',') like concat(', ', kw.keyword, ',') 
```

但是，正如其他人所提到的，您有一个非关系数据库设计。标题中的关键字应存储在单独的行中，而不是作为逗号分隔的列表。

如果您的数据很小（几十万行或更少），您可以将其放入 Excel，使用文本到列功能，重新排列关键字，并在数据库中创建一个新的、更好的表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:14:59.770

```
SELECT title 1, COUNT(*) FROM table GROUP BY title 1 
```

**编辑**

由于您已经编辑并呈现了一个非标准化表格，我建议您对其进行标准化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:18:22.633

阅读：[http ://blog.fedecarg.com/2009/02/22/mysql-split-string-function/](http://blog.fedecarg.com/2009/02/22/mysql-split-string-function/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T14:27:05.530

您需要修改您的数据库。你应该有这样的东西：

```
items
+----+---------------+
| id | title         |
+----+---------------+
| 1  | something     |
| 3  | another thing |
| 4  | yet another   |
| 5  | one last one  |
+----+---------------+

keywords
+----+-----------------+
| id | keyword         |
+----+-----------------+
| 1  | php jobs        |
| 2  | usa             |
| 3  | php             |
| 4  | jobs            |
| 5  | ca              |
| 6  | mysql developer |
| 7  | developer       |
+----+-----------------+

items_to_keywords
+---------+------------+
| item_id | keyword_id |
+---------+------------+
| 1       | 1          |
| 1       | 2          |
| 3       | 2          |
| 3       | 3          |
| 3       | 4          |
| 4       | 5          |
| 4       | 6          |
| 5       | 7          |
+---------+------------+ 
```

你看到优势了吗？建立关系的能力是你应该在这里利用的。

# matlab - Matlab中ndgrid的动态输出

> ID：11209301
> 
> 赞同：3
> 
> 时间：2012-06-26T14:13:57.630
> 
> 标签：matlab, dynamic

我想使用*ndgrid*为 n 维数组生成索引。由于尺寸可能会改变，有没有办法包装 ndgrid 以便 ndgrid 的输出数量是动态的？例如，我希望二维数组的*输出*为：

```
 [output{1} output{2}]=ndgrid(1:5) 
```

3维数组的*输出*为：

```
 [output{1} output{2} output{3}]=ndgrid(1:5) 
```

等等等等...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T09:45:38.770

如果您想要不同尺寸的不同尺寸，您可能需要考虑类似： [创建邻接矩阵](http://www.wisdom.weizmann.ac.il/~bagon/matlab_code/sparse_adj_matrix.m)。相关部分是：

```
ndim = numel(sz);
I=cell(ndim,1);
% construct the neighborhood
for di=1:ndim
    I{di}=1:sz(di);
end
[I{1:ndim}]=ndgrid(I{:}); 
```

# python - python脚本递归搜索特定文件名的FTP并且超过24小时

> ID：11209302
> 
> 赞同：2
> 
> 时间：2012-06-26T14:14:06.740
> 
> 标签：python, recursion, ftp, ftputil

我们的存储区遇到了 SMB 连接问题，现在我们被迫使用 FTP 定期访问文件。因此，我没有使用 Bash，而是尝试使用 python，但遇到了一些问题。该脚本需要递归搜索 FTP 目录并找到所有超过 24 小时的文件“*1700_m30.mp4”。然后将所有这些文件复制到本地。

这是我到目前为止所得到的——但我似乎无法获取脚本来下载文件或从文件中获取统计信息来告诉我它们是否比 24 小时新。

```
#!/usr/bin/env python
# encoding: utf-8

import sys
import os
import ftplib
import ftputil
import fnmatch
import time

dir_dest = '/Volumes/VoigtKampff/Temp/TEST1/' # Directory where the files needs to be downloaded to
pattern = '*1700_m30.mp4' #filename pattern for what the script is looking for 
print 'Looking for this pattern :', pattern # print pattern

print "logging into GSP" # print 
host = ftputil.FTPHost('xxx.xxx','xxx','xxxxx') # ftp host info
recursive = host.walk("/GSPstor/xxxxx/xxx/xxx/xxx/xxxx",topdown=True,onerror=None) # recursive search 
for root,dirs,files in recursive:
    for name in files:
        print 'Files   :', files # print all files it finds
        video_list = fnmatch.filter(files, pattern)
        print 'Files to be moved :', video_list # print list of files to be moved 
        if host.path.isfile(video_list): # check whether the file is valid 
            host.download(video_list, video_list, 'b') # download file list 

host.close 
```

这是根据 ottomeister 的出色建议修改后的脚本（谢谢！！） - 现在的最后一个问题是它会下载，但它会继续下载文件并覆盖现有文件：

```
import sys
import os
import ftplib
import ftputil
import fnmatch
import time
from time import mktime
import datetime
import os.path, time 
from ftplib import FTP

dir_dest = '/Volumes/VoigtKampff/Temp/TEST1/' # Directory where the files needs to be downloaded to
pattern = '*1700_m30.mp4' #filename pattern for what the script is looking for 
print 'Looking for this pattern :', pattern # print pattern
utc_datetime_less24H = datetime.datetime.utcnow()-datetime.timedelta(seconds=86400) #UTC time minus 24 hours in seconds
print 'UTC time less than 24 Hours is: ', utc_datetime_less24H.strftime("%Y-%m-%d %H:%M:%S") # print UTC time minus 24 hours in seconds
print "logging into GSP FTP" # print 

with ftputil.FTPHost('xxxxxxxx','xxxxxx','xxxxxx') as host: # ftp host info
    recursive = host.walk("/GSPstor/xxxx/com/xxxx/xxxx/xxxxxx",topdown=True,onerror=None) # recursive search 
    for root,dirs,files in recursive:
        for name in files:
            print 'Files   :', files # print all files it finds
            video_list = fnmatch.filter(files, pattern) # collect all files that match pattern into variable:video_list
            statinfo = host.stat(root, video_list) # get the stats from files in variable:video_list
            file_mtime = datetime.datetime.utcfromtimestamp(statinfo.st_mtime) 
            print 'Files with pattern: %s and epoch mtime is: %s ' % (video_list, statinfo.st_mtime)
            print 'Last Modified: %s' % datetime.datetime.utcfromtimestamp(statinfo.st_mtime) 
            if file_mtime >= utc_datetime_less24H: 
                for fname in video_list:
                    fpath = host.path.join(root, fname)
                    if host.path.isfile(fpath):
                        host.download_if_newer(fpath, os.path.join(dir_dest, fname), 'b') 

host.close() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T17:34:54.000

这一行：

```
 video_list = fnmatch.filter(files, pattern) 
```

为您提供与您的 glob 模式匹配的文件名列表。但是这一行：

```
 if host.path.isfile(video_list): # check whether the file is valid 
```

是假的，因为`host.path.isfile()`不希望文件名列表作为其参数。它需要一个路径名。因此，您需要一次迭代`video_list`构造一个路径名，将这些路径名中的每一个传递给`host.path.isfile()`，然后可能下载该特定文件。像这样的东西：

```
 import os.path

    for fname in video_list:
        fpath = host.path.join(root, fname)
        if host.path.isfile(fpath):
            host.download(fpath, os.path.join(dir_dest, fname), 'b') 
```

请注意，我`host.path.join()`用于管理远程路径名和`os.path.join()`管理本地路径名。另请注意，这会将所有下载的文件放入一个目录中。如果要将它们放入镜像远程布局的目录层次结构中（如果不同远程目录中的文件名可能发生冲突，则必须执行类似操作），那么您需要构建不同的目标路径，并且您可能还必须创建本地目标目录层次结构。

要获取时间戳信息，请使用`host.lstat()`或`host.stat()`取决于您要如何处理符号链接。

是的，那应该是`host.close()`。没有它，连接将在`host`变量超出范围并被垃圾收集后关闭，但最好显式关闭它。更好的是，使用一个`with`子句确保连接关闭，即使异常导致此代码在到达`host.close()`调用之前被放弃，如下所示：

```
 with ftputil.FTPHost('xxx.xxx','xxx','xxxxx') as host: # ftp host info
        recursive = host.walk(...)
        ... 
```

# jqgrid - 功能 jqGrid - 它可以呈现的最大行数（分页和虚拟滚动关闭）

> ID：11209308
> 
> 赞同：2
> 
> 时间：2012-06-26T14:14:19.290
> 
> 标签：jqgrid

我有一个关于能力 jqGrid 的问题。我们想关闭分页并在客户端加载所有数据而不实现虚拟滚动（分页也关闭）。jqGrid 可以实际处理多少条记录，因为我们一直在尝试加载 50,000 条记录 * 20 列并且它似乎爆炸了（注意：虚拟滚动关闭和分页关闭）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T16:39:11.947

我不认为这是个好主意。没有用户能够查看 100 万个单元格。因此，您希望向客户端发送 99.9%（或更多）不需要的数据。您真正需要的是实现面向主题的数据*过滤*。

网格的性能主要取决于您使用的 Web 浏览器的 JavaScript 引擎。由于 JavaScript 性能非常不同，没有人可以为您推荐 IE6 和 Chrome 19。

无论如何，我确信您必须*在服务器端*实现分页、排序和过滤。我认为在 100 万个数据单元的情况下确实需要它。

# c++ - C++：从字符串流到字符**

> ID：11209311
> 
> 赞同：0
> 
> 时间：2012-06-26T14:14:27.473
> 
> 标签：c++, string, stdvector, stringstream

我有一个带有`parse(int argc, char* argv[])`函数的类，我必须使用它来设置对象的所需状态。我正在使用 gui 获取参数`stringstream`，然后尝试将它们转换为 char** 以将它们传递给函数。这是我所拥有的：

```
std::stringstream sstream;

sstream << "-clip" << " " << min_x_entry.get_text()
        << " " << max_x_entry.get_text(); // etc.

std::cout << sstream.str();    // All looks good here

std::vector<std::string> args;
std::vector<char*> argv;
std::string arg;

while (sstream >> arg)
{
    args.push_back(arg);
    argv.push_back(const_cast<char*>(args.back().c_str()));
}
argv.push_back(0);

int argc = args.size();

for (int i = 0; i < argc; ++i)
    std::cout << &argv[0][i];    // This outputs garbage

my_object.parse(argc, &argv[0])  // And this fails 
```

我错过了什么？有没有更好的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T14:19:47.837

一个问题是向量的重新分配，`args`如果[`push_back()`](http://en.cppreference.com/w/cpp/container/vector/push_back)需要的话，向量的大小会增加：

> 如果 new size() 不大于 capacity()，则没有迭代器或引用无效。**否则所有迭代器和引用都将失效。**

该`argv`向量存储指向 中元素内部的指针`args`，因此这些将无效。

一种解决方案是先创建`args`向量，然后再创建`argv`向量：

```
while (sstream >> arg) args.push_back(arg);

for (auto i = args.begin(); i != args.end(); i++)
{
    argv.push_back(const_cast<char*>(i->c_str()));
}
argv.push_back(0); 
```

`for`打印出字符串的循环`argv`不正确。这个：

```
&argv[0][i] 
```

是 a`char*`但从`i`中第一个条目的第 th 元素开始`argv`。例如，如果第一个 c 字符串`argv`是`"string"`：

```
&argv[0][1] is "tring"
&argv[0][2] is "ring" 
```

改成：

```
for (int i = 0; i < argc; i++)
    std::cout << argv[i] << std::endl; // Added 'endl' to flush 'cout'. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T14:26:11.833

```
std::vector<std::string> args;
std::vector<char*> argv;

/* ... */

    argv.push_back(const_cast<char*>(args.back().c_str())); 
```

这里有很多问题。

1.  `c_str()`不保证返回的指针在任何后续调用相同的非`const`成员函数后有效`string`。从返回的指针`c_str()`通常不应该存储和以后使用，特别是如果您不确定其他代码是否会调用`const`.`string`
2.  您正在`const_cast`将`const`-nedd 远离由 . 返回的指针`c_str()`。演员表本身是合法的，如果不是反模式的话。但是，如果您稍后尝试*修改*存储在该指针处的数据，那就是未定义的行为。

以下是标准必须说的`c_str()`：

## 21.3.6 basic_string 字符串操作 [lib.string.ops]

```
const charT* c_str() const; 
```

> 1/ 返回： 指向长度为 size() + 1 的数组的初始元素的指针，其第一个 size() 元素等于由 *this 控制的字符串的相应元素，其最后一个元素是 charT() 指定的空字符.
> 
> 2/ 要求：程序不得更改存储在数组中的任何值。在任何后续调用指定与 this 相同的对象的类 basic_string 的非常量成员函数之后，程序也不会将返回值视为有效指针值。常量 charT* 数据（）常量；
> 
> 3/ 返回：如果 size() 不为零，则该成员返回指向数组初始元素的指针，该数组的第一个 size() 元素等于由 *this 控制的字符串的相应元素。如果 size() 为零，则该成员返回一个非空指针，该指针是可复制的并且可以添加零。
> 
> 4/ 要求：程序不得更改存储在字符数组中的任何值。在对指定与 this 相同的对象的 basic_string 的非 const 成员函数的任何后续调用之后，程序也不会将返回值视为有效指针值。allocator_type get_allocator() 常量；
> 
> 5/ 返回：用于构造字符串的分配器对象的副本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T14:31:38.360

您忘记`i`在循环中初始化变量。并且您试图仅打印出 vector 中的第一项`argv`。

```
for (int i = 0; i < argc; ++i)
    std::cout << argv[i]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T15:13:40.373

您可以通过执行以下操作摆脱`const_cast`而不用担心`parse()`可能修改参数的方法：

```
std::vector<std::vector<char>> args;

std::for_each(std::istream_iterator<std::string>(sstream),
              std::istream_iterator<std::string>(),
              [&args](const std::string& str)
              {
                  std::vector<char> temp(str.begin(), str.end());
                  temp.push_back('\0');
                  args.push_back(temp);
              });

std::vector<char*> argv(args.size());

for (auto& v : args) argv.push_back(v.data());

my_object.parse(argv.size(), argv.data()); 
```

# jquery - 使用 jquery 访问嵌套的 div

> ID：11209324
> 
> 赞同：1
> 
> 时间：2012-06-26T14:15:16.773
> 
> 标签：jquery, jquery-selectors

我定义了一个`tabs`使用`JQuery`

```
<div id="tabs">
  <ul>
    <li><a href="#tabs-1">Tab 1</a></li>
    <li><a href="#tabs-2">Tab 2</a></li>
  </ul>

  <div id="tabs-1">
    <table>
      <tr><td>demo</td></tr>
    </table>        
  </div>
  <div id="tabs-2">
    <table>
      <tr><td>demo</td></tr>
      <div id="hello">
        <tr><td>Hello World</td></tr>
      </div>
    </table> 
  </div> 
```

我可以`tabs-1`用简单的代码隐藏

```
function hideTabs1() {
   $("#tabs-1").hide(); 
} 
```

我怎样才能只隐藏“Hello World”这个词？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:16:53.080

试试这个：

```
$("#hello td").hide(); 
```

或更好 ：

```
$("#tabs-2 td:eq(1)").hide(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:17:19.943

尝试这个：

```
$('#hello td').css('visibility', 'hidden'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T14:19:28.953

尝试这个：

```
$('#hello').css('display', 'none');

<div id="tabs-2">
    <table>
      <tr><td>demo</td></tr>
       <tr  id="hello"><td>Hello World</td></tr>
    </table> 
  </div> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-26T14:23:14.853

您应该真正将 HTML 修复为这样的内容，以使其有效：

```
...
<div id="tabs-2">
   <table>
      <tr><td>demo</td></tr>
      <tr id="hello"><td>
         Hello World
      </td></tr>
   </table> 
</div>
... 
```

那么你将是 jQuery：

```
$("#hello td").hide(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-26T15:07:36.563

对我来说，解决方案是结合几个人的答案。（我不确定 SO 协议是什么，所以我回答了我自己的问题，并标记了所有其他答案）

一旦我意识到 DIV 不能是 TABLE 的子项（感谢 bfavaretto 和 Sirko），然后我意识到我可以将表分成两个表，并给我想要隐藏 ID 的表（使用 Ruben 和 Ryan 的想法a `td`) 然后隐藏这个表。

谢谢大家。

# c++ - 返回值优化和私有复制构造函数

> ID：11209326
> 
> 赞同：1
> 
> 时间：2012-06-26T14:15:18.900
> 
> 标签：c++

我写了一个简单的链表，因为最近的一次面试编程挑战向我展示了我的 C++ 已经生锈了。在我的列表中，我声明了一个私有副本构造函数，因为我想明确避免制作任何副本（当然还有懒惰）。当我想按值返回一个拥有我的列表之一的对象时，我遇到了一些麻烦。

```
class Foo
{
   MyList<int> list;  // MyList has private copy constructor

   public:
      Foo() {};
};

class Bar
{
   public:
      Bar() {};

      Foo getFoo()
      {
         return Foo();
      }
}; 
```

当我尝试按值返回 Foo 对象时，我收到一个编译器错误，指出 MyList 有一个私有复制构造函数。Return-Value-Optimization 是否应该否定任何复制的需要？我需要编写一个复制构造函数吗？在我开始寻找这个问题的解决方案之前，我从来没有听说过移动构造函数，这是最好的解决方案吗？如果是这样，我将不得不阅读它们。如果不是，解决此问题的首选方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T14:16:59.137

该标准明确指出构造函数仍然需要可访问，即使它已被优化掉。请参阅`12.8/32`最近的草稿。

在这种情况下，我更喜欢使对象可移动且不可复制。它使所有权非常清晰和明确。

否则，您的用户始终可以使用`shared_ptr`. 隐藏共享所有权充其量是一个值得怀疑的想法（除非您可以保证所有值都是不可变的）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T15:17:07.090

基本问题是按值返回*可能会*复制。标准不要求 C++ 实现在适用的地方应用复制省略。这就是为什么对象仍然必须是可复制的：以便实现决定何时使用它不会影响代码是否格式正确。

无论如何，它不一定适用于用户可能喜欢的每个副本。例如，没有省略复制分配。

我认为你的选择是：

*   实施正确的副本。如果有人由于复制而导致程序运行缓慢，那么他们的分析器会告诉他们，如果您不想阻止他们，则不必将其作为您的工作。
*   实现正确的移动，但没有副本（仅限 C++11）。
*   更改`getFoo`为采用`Foo&`（或可能`Foo*`）参数，并通过以某种方式改变其对象来避免复制。高效的`swap`会派上用场。`getFoo`如果真的像您的示例中那样返回默认构造的，这是毫无意义`Foo`的，因为调用者需要在调用`Foo`之前构造 a `getFoo`。
*   `Foo`返回包装在智能指针中的动态分配：要么`auto_ptr`或`unique_ptr`。定义为创建对象并将唯一所有权转移给调用者的函数*不应*返回`shared_ptr`，因为它没有`release()`函数。
*   提供一个复制构造函数，但如果它曾经被使用过，它会以某种方式爆炸（链接失败、中止、抛出异常）。这样做的问题是（1）它注定要失败，但编译器什么也没说，（2）你正在强制执行质量，所以如果有人出于任何原因故意禁用 RVO，你的类就不起作用。

我可能错过了一些。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T14:22:57.397

解决方案是实现您自己的复制构造函数，该构造函数将使用其他方法`MyList`来实现复制语义。

> ...我想明确避免制作任何副本

你必须选择。要么你不能复制一个对象，比如`std::istream`; 那么你必须将这些对象保存在指针/引用中，因为它们可以被复制（在 C++11 中，你可以使用移动语义）。或者您实现复制构造函数，这可能比在每个需要复制的地方解决问题更容易。

# android - 奇怪的双字符串转换

> ID：11209328
> 
> 赞同：-1
> 
> 时间：2012-06-26T14:15:19.113
> 
> 标签：android, double

我正在使用以下代码在我的一项活动中填充 Spinner ...

```
 for( double i = 0; i < 10 ; i+=0.1 ) {
        rVoltsList.add( Double.toString( i ) );
    }
    Spinner rVoltsSpinner = (Spinner) findViewById( R.id.recloseVoltsSpinner );
    ArrayAdapter<String> rVoltsAdapter = new ArrayAdapter<String>( this, android.R.layout.simple_spinner_item, rVoltsList );
    rVoltsSpinner.setAdapter( rVoltsAdapter ); 
```

我假设这会给我一个如下列表：0.0、0.1、0.2、0.3、0.4 等等。但是，这是我运行程序时列表的样子：

```
0.0
0.1
0.2
0.30000000000000000000000004
0.4
0.5
0.6
0.7
0.79999999999999999999
0.89999999999999999999
0.99999999999999999999
1.09999999999999999999
1.2
1.3
and this goes on until 9.99999999999999999998 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T14:18:37.777

用这个：

```
rVoltsList.add( String.format("%.1f", i) ); 
```

问题是`Double.toString(i)`不会圆。

奇怪的值是由于 0.1（以 10 为底）`double`在 Java 中没有像 a 那样的精确表示，所以每次将它添加到循环变量时，您添加的内容与您的想法有些不同（如果您会原谅双关语）。

舍入的相同问题表明您不应该使用 a`double`作为循环变量。你不太可能完全达到你的循环限制。我会重写你的循环如下：

```
for( int i = 0; i < 100 ; ++i ) {
    rVoltsList.add( String.format("%.1f", i / 10.0) );
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:18:19.790

```
DecimalFormat dtime = new DecimalFormat("#.#"); 

for( double i = 0; i < 10 ; i+=0.1 ) 
{   
    String i2= Double.valueOf(dtime.format(i));
    rVoltsList.add( Double.toString( i2 ) );
} 
```

# maven - 从 Maven Central 安装 Maven

> ID：11209329
> 
> 赞同：2
> 
> 时间：2012-06-26T14:15:21.453
> 
> 标签：maven, maven-2, maven-3

我有一个 Maven 插件，我想针对不同的 Maven 版本进行测试（例如：2.2.1 和 3.0.4）。理想情况下，我不希望运行构建的用户必须手动安装这些确切的版本。

是否可以从 Maven Central 或其他一些源安装特定版本的 Maven，然后将它们缓存在本地 Maven 存储库中以供后续构建？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:40:37.747

为什么不简单地安装一个持续集成 (CI) 服务器，例如 Jenkins / Hudson / TeamCity / 等？CI 服务器允许您针对不同版本的 SDK 运行构建。

如果您的插件是 OSS（并且在 GitHub 上），我相信您可以从[Cloudbees](http://www.cloudbees.com)获得免费的 Jenkins 托管。

无法从 Maven Central 下载 Maven 本身。您只能从他们的网站下载它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:48:37.343

Maven 发行版存储在 Maven 中央存储库中，如您在此处看到的：

*   [http://mvnrepository.com/artifact/org.apache.maven/apache-maven](http://mvnrepository.com/artifact/org.apache.maven/apache-maven)
*   [https://repository.sonatype.org/index.html#nexus-search;gav~org.apache.maven~apache-maven~~~~kw,versionexpand](https://repository.sonatype.org/index.html#nexus-search;gav~org.apache.maven~apache-maven~~~~kw,versionexpand)

因此，它可以用作具有以下坐标的正常依赖项：

tar.gz 变体：

```
<dependency>
    <groupId>org.apache.maven</groupId>
    <artifactId>apache-maven</artifactId>
    <version>3.0.4</version>
    <classifier>bin</classifier>
    <type>tar.gz</type>
</dependency> 
```

zip 变体：

```
<dependency>
    <groupId>org.apache.maven</groupId>
    <artifactId>apache-maven</artifactId>
    <version>3.0.4</version>
    <classifier>bin</classifier>
    <type>zip</type>
</dependency> 
```

其余部分非常标准 - 您可能会在集成测试 pom 中使用它，并按照@khmarbaise 的推荐使用[maven-invoker-plugin调用它们。](http://maven.apache.org/plugins/maven-invoker-plugin)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T19:10:33.793

您可以执行以下操作：

```
 <profile>
      <id>run-its</id>
      <build>
        <!--  Download the different Maven versions -->
        <plugins>
          <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>wagon-maven-plugin</artifactId>
            <version>1.0-beta-3</version>
            <executions>
              <execution>
                <id>download-maven-2.0.11</id>
                <phase>prepare-package</phase>
                <goals>
                  <goal>download-single</goal>
                </goals>
                <configuration>
                  <url>http://archive.apache.org/dist/maven/binaries/</url>
                  <fromFile>apache-maven-2.0.11-bin.tar.gz</fromFile>
                  <toDir>${project.build.directory}/maven/download/</toDir>
                </configuration>
              </execution>
              <execution>
                <id>download-maven-2.2.1</id>
                <phase>prepare-package</phase>
                <goals>
                  <goal>download-single</goal>
                </goals>
                <configuration>
                  <url>http://archive.apache.org/dist/maven/binaries/</url>
                  <fromFile>apache-maven-2.2.1-bin.tar.gz</fromFile>
                  <toDir>${project.build.directory}/maven/download/</toDir>
                </configuration>
              </execution>
              <execution>
                <id>download-maven-3.0.3</id>
                <phase>prepare-package</phase>
                <goals>
                  <goal>download-single</goal>
                </goals>
                <configuration>
                  <url>http://archive.apache.org/dist/maven/binaries/</url>
                  <fromFile>apache-maven-3.0.3-bin.tar.gz</fromFile>
                  <toDir>${project.build.directory}/maven/download/</toDir>
                </configuration>
              </execution>
            </executions>
          </plugin>

          <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>truezip-maven-plugin</artifactId>
            <version>1.0-beta-4</version>
            <executions>
              <execution>
                <id>extract-maven-2.0.11</id>
                <goals>
                  <goal>copy</goal>
                </goals>
                <phase>prepare-package</phase>
                <configuration>
                  <fileset>
                    <directory>${project.build.directory}/maven/download/apache-maven-2.0.11-bin.tar.gz</directory>
                    <outputDirectory>${project.build.directory}/maven/tools/</outputDirectory>
                  </fileset>
                </configuration>
              </execution>
              <execution>
                <id>extract-maven-2.2.1</id>
                <goals>
                  <goal>copy</goal>
                </goals>
                <phase>prepare-package</phase>
                <configuration>
                  <fileset>
                    <directory>${project.build.directory}/maven/download/apache-maven-2.2.1-bin.tar.gz</directory>
                    <outputDirectory>${project.build.directory}/maven/tools/</outputDirectory>
                  </fileset>
                </configuration>
              </execution>
              <execution>
                <id>extract-maven-3.0.3</id>
                <goals>
                  <goal>copy</goal>
                </goals>
                <phase>prepare-package</phase>
                <configuration>
                  <fileset>
                    <directory>${project.build.directory}/maven/download/apache-maven-3.0.3-bin.tar.gz</directory>
                    <outputDirectory>${project.build.directory}/maven/tools/</outputDirectory>
                  </fileset>
                </configuration>
              </execution>
            </executions>
          </plugin>

          <!--
            This is currently needed due to a bug of the truezip-plugin cause it unpacks without permission!
            see http://jira.codehaus.org/browse/MOJO-1796
           -->
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <version>1.7</version>
            <executions>
                <execution>
                  <id>chmod-files</id>
                  <phase>package</phase>
                  <goals>
                    <goal>run</goal>
                  </goals>
                  <configuration>
                    <target>
                      <chmod file="${project.build.directory}/maven/tools/apache-maven-2.0.11/bin/mvn" perm="+x"/>
                      <chmod file="${project.build.directory}/maven/tools/apache-maven-2.2.1/bin/mvn" perm="+x"/>
                      <chmod file="${project.build.directory}/maven/tools/apache-maven-3.0.3/bin/mvn" perm="+x"/>
                    </target>
                  </configuration>
                </execution>
              </executions>
          </plugin>

          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-invoker-plugin</artifactId>
            <version>1.5</version>
            <dependencies>
              <dependency>
                <groupId>org.codehaus.groovy</groupId>
                <artifactId>groovy</artifactId>
                <version>1.8.4</version>
              </dependency>
            </dependencies>
            <configuration>
              <debug>false</debug>
                  <!-- src/it-ip as for integration tests invoker plugin for the time of transition to maven-invoker-plugin -->
              <projectsDirectory>src/it</projectsDirectory>
              <showVersion>true</showVersion>
              <pomIncludes>
                <pomInclude>*/pom.xml</pomInclude>
              </pomIncludes>
              <preBuildHookScript>setup</preBuildHookScript>
              <postBuildHookScript>verify</postBuildHookScript>
              <settingsFile>src/it/settings.xml</settingsFile>
            </configuration>
            <executions>
              <execution>
                <id>integration-test-maven-2.0.11</id>
                <goals>
                  <goal>install</goal>
                  <goal>run</goal>
                </goals>
                <configuration>
                  <reportsDirectory>${project.build.directory}/invoker-reports-2.0.11</reportsDirectory>
                  <localRepositoryPath>${project.build.directory}/local-repo-2.0.11</localRepositoryPath>
                  <cloneProjectsTo>${project.build.directory}/it-2.0.11</cloneProjectsTo>
                  <mavenHome>${project.build.directory}/maven/tools/apache-maven-2.0.11</mavenHome>
                  <goals>
                    <goal>clean</goal>
                    <goal>test</goal>
                  </goals>
                </configuration>
              </execution>
              <execution>
                <id>integration-test-maven-2.2.1</id>
                <goals>
                  <goal>install</goal>
                  <goal>run</goal>
                </goals>
                <configuration>
                  <reportsDirectory>${project.build.directory}/invoker-reports-2.2.1</reportsDirectory>
                  <localRepositoryPath>${project.build.directory}/local-repo-2.2.1</localRepositoryPath>
                  <cloneProjectsTo>${project.build.directory}/it-2.2.1</cloneProjectsTo>
                  <mavenHome>${project.build.directory}/maven/tools/apache-maven-2.2.1</mavenHome>
                  <goals>
                    <goal>clean</goal>
                    <goal>test</goal>
                  </goals>
                </configuration>
              </execution>
              <execution>
                <id>integration-test-maven-3.0.3</id>
                <goals>
                  <goal>install</goal>
                  <goal>run</goal>
                </goals>
                <configuration>
                  <reportsDirectory>${project.build.directory}/invoker-reports-3.0.3</reportsDirectory>
                  <localRepositoryPath>${project.build.directory}/local-repo-3.0.3</localRepositoryPath>
                  <cloneProjectsTo>${project.build.directory}/it-3.0.3</cloneProjectsTo>
                  <mavenHome>${project.build.directory}/maven/tools/apache-maven-3.0.3</mavenHome>
                  <goals>
                    <goal>clean</goal>
                    <goal>test</goal>
                  </goals>
                </configuration>
              </execution>
            </executions>
          </plugin>
        </plugins>
      </build>
    </profile> 
```

这将下载不同的 Maven 版本，解压缩 .tar.gz 档案并使 mvn 可执行，并使用[maven-invoker-plugin](http://maven.apache.org/plugins/maven-invoker-plugin/)运行所有与这些不同 maven 版本的集成测试。

**但**我不能推荐。更好的方法是使用包含不同 Maven 安装的 CI 解决方案（如前所述）。您可以分别为每个 Maven 版本运行集成测试。

# scala - Scala 2.8 vs 2.9 基准测试，奇怪的结果

> ID：11209336
> 
> 赞同：3
> 
> 时间：2012-06-26T14:15:45.713
> 
> 标签：scala, optimization, benchmarking, scala-2.8, scala-2.9

前段时间，我写了一些代码来决定用新值（但不创建新对象）更新可变变量的哪种方法更快。一种方法使用临时值并且有额外的复制，而另一种则没有。

*代码示例 #1 - 重新分配*

```
class Test(var x: Float, var y: Float) {
    @inline final def :=(x: Float, y: Float) = {
        this.x = x
        this.y = y
    }
    //...
    @inline final def :=(o: Test) = { //reassign from arg "o"
        x = o.x
        y = o.y
    }
    //...
}
object Benchmark {
    //...
    val tmp = new Test(0, 0)
    @inline final def calc_something_for_reassign(a: Float, b: Float) = {
        tmp := (a, b)
        tmp.something_m //this is a simple method that changes the object
        tmp
    }
    //...
} 
```

*代码示例 #2 - 无需重新分配*

```
class Test(var x: Float, var y: Float) {
    @inline final def := (x: Float, y: Float) = //it's the same as in sample #1
    //...
    @inline final def := (of: (Test) => Unit) = { //apply mutating function "of"
        of(this)
    }
//...
}
object Benchmark {
    //...
    @inline final def calc_something_for_forwarding(a: Float, b: Float) = {
        (result: Test) => {
            result := (a, b)
            result.something_m
        }
    }
} 
```

## 完整代码在这里：http: [//ideone.com/A62Ts](http://ideone.com/A62Ts)

在我的 PC（scala 编译器 v. 2.8，jre7）上，结果看起来像预期的那样：

```
reassignment: 0.046sec; Result:42.0, 3.0
forwarding: 0.007sec; Result:42.0, 3.0
forwarding: 0.006sec; Result:42.0, 3.0
reassignment: 0.044sec; Result:42.0, 3.0 
```

（是的，如果我增加测试长度，比例是一样的，编译器选项无关紧要。）

我在装有 Android OS 2.3.4 的手机上执行了此测试，获胜者仍然相同。但是，正如我们所见，在 Ideone.com 上发生了相反的事情，第二种方法要慢得多。那么你能解释一下，那里实际发生了什么吗？哪个（这两个）版本的 Scala 编译器工作正常？它是 scala-2.9.1 中的错误吗？

更新：在 scala 2.9 测试打印以下内容（尝试了很多次，没有太大变化）：

```
reassignment: 0.047sec; Result:42.0, 3.0
forwarding: 0.032sec; Result:42.0, 3.0
forwarding: 0.219sec; Result:42.0, 3.0
reassignment: 0.045sec; Result:42.0, 3.0 
```

并且对于任意数量的循环，第三次运行比所有其他运行都长。会导致GC吗？或者为什么还会发生这种奇怪的事情？*如果我改为按b、b、a、b、b、a*的顺序调用它们，那么就不会有这样奇怪的峰：

```
println(Benchmark.run_b(Int.MaxValue/10))
println(Benchmark.run_b(Int.MaxValue/10))
println(Benchmark.run_a(Int.MaxValue/10))
println(Benchmark.run_b(Int.MaxValue/10))
println(Benchmark.run_b(Int.MaxValue/10))
println(Benchmark.run_a(Int.MaxValue/10)) 
```

*scala 2.8 中的结果（稳定）：*

```
forwarding: 0.012sec; Result:42.0, 3.0
forwarding: 0.012sec; Result:42.0, 3.0
reassignment: 0.347sec; Result:42.0, 3.0
forwarding: 0.011sec; Result:42.0, 3.0
forwarding: 0.005sec; Result:42.0, 3.0
reassignment: 0.333sec; Result:42.0, 3.0 
```

*scala 2.9 中的结果（稳定）：*

```
forwarding: 0.184sec; Result:42.0, 3.0
forwarding: 0.179sec; Result:42.0, 3.0
reassignment: 0.354sec; Result:42.0, 3.0
forwarding: 0.17sec; Result:42.0, 3.0
forwarding: 0.169sec; Result:42.0, 3.0
reassignment: 0.342sec; Result:42.0, 3.0 
```

然而，在 scala 2.9 中重新分配的方法与在 scala 2.8 中一样长，**但在 scala 2.9 中，快速方法大约慢 10 倍（但仍然比慢方法快大约 2 倍）。所以最初的问题仍然存在，为什么它在 scala 2.9 中要慢得多。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:21:46.817

一方面，ideone 运行时将驻留在内存中，并且 JVM 可能有一些被其他用户歪曲的统计数据，这导致它构建了一些稍微奇怪的本机代码。我很想忽略任何从性能方面产生的东西，因为有很多未知的东西会影响基准。他们甚至可能有一个修改版本来更具体地满足他们的需求。

# python - # Error: TypeError: unbound method __init__() must be called with shape instance as the first argument (得到str instance) #

> ID：11209339
> 
> 赞同：0
> 
> 时间：2012-06-26T14:15:53.300
> 
> 标签：python, inheritance

这是我的脚本：

```
class shape:
    def __init__(self, name):
        self.name = name

    def printMyself(self):
        print 'I am a shape named %s.' % self.name

shape1 = shape(name = 'myFirstShape.')
shape2 = shape(name = 'mySecondShape.')
shape1.printMyself()
shape2.printMyself()

class polyCube(shape):
    def __init__(self, name, length, width, height):
        shape.__init__(name)
        self.length = length
        self.width = width
        self.height = height

    def printMyself(self):
        shape.printMyself(self)
        print 'I am also a cube with dimensions %.2f, %.2f, %.2f.' % (length, width, height)

class polySphere(shape):
    def __init__(self, name, radius):
        shape.__init__(name)
        self.radius = radius

    def printMyself(self):
        shape.printMyself(self)
        print 'I am also a sphere with dimensions of %.2f.' % (radius)

cube1 = polyCube('firstCube', 2.0, 1.0, 3.0)
cube2 = polyCube('secondCube', 3.0, 3.0, 3.0)
sphere1 = polySphere('firstSphere', 2.2)
sphere2 = polySphere('secondSphere', 3.5)
shape1 = shape('myShape')
cube1.printMyself()
cube2.printMyself()
sphere1.printMyself()
sphere2.printMyself() 
```

我的错误：

```
# Error: TypeError: unbound method __init__() must be called with shape instance as first argument (got str instance instead) # 
```

我不明白。为什么我收到此错误消息？解决方案是什么？为什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:20:19.207

您的代码的工作版本，我已经在评论中解释了错误

```
class shape:
  def __init__(self, name):
    self.name = name

  def printMyself(self):
    print ('I am a shape named %s.' % self.name)

shape1 = shape(name = 'myFirstShape.')
shape2 = shape(name = 'mySecondShape.')
shape1.printMyself()
shape2.printMyself()

class polyCube(shape):
    def __init__(self, name, length, width, height):
        shape.__init__(self,name) #pass self here, you're calling parent's __init__() explicitly so you should pass self.

        self.length = length
        self.width = width
        self.height = height

    def printMyself(self):
     shape.printMyself(self)
     #use self.length ,self.width instead of just length,width etc
     print ('I am also a cube with dimensions %.2f, %.2f, %.2f.' % (self.length, self.width, self.height)) 

class polySphere(shape):
    def __init__(self, name, radius):
        shape.__init__(self,name) #pass self here

        self.radius = radius

    def printMyself(self):
     shape.printMyself(self)
     print ('I am also a sphere with dimensions of %.2f.' % (self.radius)) #use self.radius here

cube1 = polyCube('firstCube', 2.0, 1.0, 3.0)
cube2 = polyCube('secondCube', 3.0, 3.0, 3.0)
sphere1 = polySphere('firstSphere', 2.2)
sphere2 = polySphere('secondSphere', 3.5)
shape1 = shape('myShape')
cube1.printMyself()
cube2.printMyself()
sphere1.printMyself()
sphere2.printMyself() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:25:31.007

通常，您应该发布**完整**的回溯。它使事情更容易调试。问题（除了我认为来自复制/粘贴错误的缩进）是当您调用时：

```
shape.__init__(name) 
```

当您从形状继承时。

如果您查看`shape.__init__`' 的“原型”，它看起来像`shape.__init__(self,name)`- 这就是您应该使用的。错误来了，因为你正在传递`name`（一个字符串）你应该传递的地方`self`（a `PolyCube`，因此也是`shape`由于继承）

*在旁边*

此外，在 python 2.x 中，始终从`object`. 例如：

```
class shape(object):
   ... 
```

这允许您使用与新型类相关的所有优点。（在python 3中，所有类都是新式类）

# php - 如何从 php 数组中的 url 输入变量

> ID：11209341
> 
> 赞同：0
> 
> 时间：2012-06-26T14:16:02.427
> 
> 标签：php, arrays, variables

一个新手问题！

我已经设置了一些代码来使用这个 url 创建一个图像：

> www.mywebpage.php?wc1=99&wc2=6&wc3=23

在 php 页面中，想要使用来自 url 的 wc1、wc2 和 wc3 变量作为条形图图形的输入

接收网页上的代码包括这一行：

```
$datay=array($_REQUEST['wc1'], $_REQUEST['wc2'], $_REQUEST['wc3']); 
```

并使用 datay 数组，我得到了一个带有三个条形的漂亮条形图。

我的问题是我想用任意数量的 wc 创建 url？变量，然后在生成的条形图中创建一个包含任意数量条形的数组。条数应该由其他一些实时进程动态设置。

所以我意识到我需要嵌入这行代码：

```
$datay=array($_REQUEST['wc1'], $_REQUEST['wc2'], $_REQUEST['wc3']); 
```

在一个循环中并将变量一一添加到数组中，直到它们全部添加（无论有多少）。

但是，我遇到了第一个障碍，因为我不知道如何将变量添加到数组中。

此代码不起作用：

```
$firstBit = $_REQUEST['wc1'];
$datay=array(firstBit, $_REQUEST['wc2'], $_REQUEST['wc3']); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:17:57.693

您只是缺少`$`变量名中的

```
 $datay=array($firstBit, $_REQUEST['wc2'], $_REQUEST['wc3']); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:22:02.087

```
foreach($_GET as $key=>$value){
    echo $key;
    echo "<br/>";
    echo $value;
    echo "<br/>";
} 
```

你很快就会明白

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:21:54.443

在您的请求中，这样传递值：

```
www.mywebpage.php?wc[]=99&wc[]=6&wc[]=23 
```

然后你有一个开箱即用的数组......

```
$myArray = $_REQUEST['wc']; 
```

# forms - 在表单数据源中插入行，插入正常，行不可见

> ID：11209342
> 
> 赞同：1
> 
> 时间：2012-06-26T14:16:10.033
> 
> 标签：forms, insert, datasource, axapta, x++

基本上，我想以 InventJournalTransfer 的形式插入行。我添加了一个菜单项按钮，该按钮调用一个打开一个对话框的类，在该对话框中我填充了一个 WMSLocationId，然后我在 Inventsum 表上循环以获取该 WMSLocationId 的所有可用数量的 ItemId，并将它们插入到 InventJournalTrans 表中。

我编写的代码似乎正在工作，因为我在表中插入了正确的记录（在表浏览器中可见，正确的 journalId、linenum itemId、qty 等...）但插入的记录没有出现在我的表单中。我尝试使用或不使用代码来刷新我的表单，但我的网格仍然是空的。

我查看了 InventCountCreate 类，它可以在不同的期刊类型中完成我想做的事情，但由于我是一个新手，我很难准确理解这个类是如何工作的。

谁能向我解释如何在我的表单中显示我插入的行或提供其他线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T18:17:29.413

您是否尝试在 AOT 中右键单击表单节点并单击“恢复”？也许您的表单仍在使用缓存数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T06:15:39.327

`InventJournalTrans`is 表内部连接到两个，`InventDim`一个通过`InventDimId`字段相关，另一个通过`ToInventDimId`。

两个字段都必须填写`InventDimId`对现有`InventDim`记录有效的表单才能显示记录。

# html - 我是否打算将 Bootstrap 用于布局的所有方面？

> ID：11209343
> 
> 赞同：2
> 
> 时间：2012-06-26T14:16:10.657
> 
> 标签：html, css, twitter-bootstrap

这只是一个关于使用引导程序的程度的问题。

我应该将它用于网站的所有布局方面吗？或者是否可以自己做一些布局工作（即使用 CSS 等设置宽度、边距等）。

具体来说，我指的是引导程序的网格布局方面。如果我将网格用于某些区域（或者可能是父区域），我*是否需要*继续将其用于子/兄弟元素？在 iPad 或类似设备上观看时，两种样式的混合是否会成为问题的根源？你能说出任何可能出现的具体问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:59:09.797

在使用引导响应时，我个人更喜欢坚持使用 twitter 引导类进行布局。

对于 boostrap.css，我倾向于先应用 boostrap.css，然后再应用另一个样式表来覆盖 twitter 引导行为。

在`!important`某些情况下，可能需要 css 属性来强制覆盖。

但是混合使用 twitter bootstrap 和您自己的 css 进行布局是完全可以的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T08:48:49.050

我成功地将内容和 span12 用于最外层的 div（和其他一些元素），并使用我自己的类来布置内部 div，所以我想你应该不会有任何问题

# javascript - parseFloat 函数无法按预期工作

> ID：11209345
> 
> 赞同：2
> 
> 时间：2012-06-26T14:16:15.653
> 
> 标签：javascript, jquery, parsefloat

我需要验证文本框条目。如果用户在绑定期间在此字段中输入字符，它应该只允许整数，因为实体框架会失败。

这是问题：

当用户`10-d`在此字段中输入时，以数字形式`parseFloat`返回并忽略其余值。虽然 IMO 它应该抛出 NAN 错误，因为输入文本无法转换为浮点数。`true``10`

请参阅以下示例，您可以使用它。 [http://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_parsefloat](http://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_parsefloat)

在上面的示例中，我感兴趣的是获得 40 年的 NAN 输入。

```
document.write(parseFloat("40 years") + "<br />"); 
```

让我知道是否需要进行更多验证。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T14:20:09.413

听起来您想使用该`isNaN`功能。

```
isNaN('40'); //false, as '40' is a number
isNaN('40 years'); //true, as '40 years' is not a number 
```

**更新**

如前所述，这不检查整数。为此，您可以使用

```
function isInt(value) { 
  return !isNaN(value) && value % 1 === 0; 
} 
```

对于“40”、40、“40”，这将返回 true。“40-d”、“40.12”、40.12、“40 年”为假。

[**jsFiddle 演示**](http://jsfiddle.net/jackwanders/3GfYY/1/)

如果您不想要尾随小数，那么@jakeclarkson 的正则表达式解决方案会更好

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:24:25.780

如果您只想允许**整数**，那么您可以使用：

```
function isInteger(str) {
    return /^[0-9]*$/.test(str);
} 
```

`isNaN``false`如果您提供小数，将返回，即

```
isNaN("3.14"); // false, i.e. it is a number 
```

而`isInteger()` `function`上述将正常工作，即

```
isInteger("3.14"); // false 
```

# ruby-on-rails - has_many 至少有两个条目

> ID：11209347
> 
> 赞同：2
> 
> 时间：2012-06-26T14:16:23.577
> 
> 标签：ruby-on-rails, ruby, rspec, factory-bot

我需要一个至少有两个条目的 has_many 关联，我如何编写验证以及如何使用 RSpec + factory-girl 对其进行测试？这是我到目前为止所得到的，但它失败了`ActiveRecord::RecordInvalid: Validation failed: Bars can't be blank`，我完全陷入了 RSpec 测试。

**/example_app/app/models/foo.rb**

```
class Foo < ActiveRecord::Base
  has_many :bars
  validates :bars, :presence => true, :length => { :minimum => 2}
end 
```

**/example_app/app/models/bar.rb**

```
class Bar < ActiveRecord::Base
  belongs_to :foo
  validates :bar, :presence => true
end 
```

**/example-app/spec/factories/foo.rb**

```
FactoryGirl.define do
  factory :foo do
     after(:create) do |foo|
       FactoryGirl.create_list(:bar, 2, foo: foo)
     end
  end
end 
```

**/example-app/spec/factories/bar.rb**

```
FactoryGirl.define do
  factory :bar do
    foo
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T15:29:05.447

```
class Foo < ActiveRecord::Base
  validate :must_have_two_bars

  private
  def must_have_two_bars
    # if you allow bars to be destroyed through the association you may need to do extra validation here of the count
    errors.add(:bars, :too_short, :count => 2) if bars.size < 2
  end
end

it "should validate the presence of bars" do
  FactoryGirl.build(:foo, :bars => []).should have_at_least(1).error_on(:bars)
end

it "should validate that there are at least two bars" do
  foo = FactoryGirl.build(:foo)
  foo.bars.push FactoryGirl.build(:bar, :foo => nil)
  foo.should have_at_least(1).error_on(:bar)
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T15:25:05.777

您想使用自定义验证器

```
class Foo < ActiveRecord::Base
  has_many :bars
  validate :validates_number_of_bars

  private
  def validates_number_of_bars
    if bars.size < 2
      errors[:base] << "Need at least 2 bars"
    end
  end
end 
```

# excel - 关闭文件夹中的所有文件

> ID：11209348
> 
> 赞同：0
> 
> 时间：2012-06-26T14:16:25.730
> 
> 标签：excel, excel-2010, vba

我有以下代码可以打开指定文件夹中的所有文件

```
Sub OpenFiles()
    Dim MyFolder As String
    Dim MyFile As String
    MyFolder = "\\ILAFILESERVER\Public\Documents\Renewable Energy\FiTs\1 Planning Department\Marks Tracker\Quality Control Reports"
    MyFile = Dir(MyFolder & "\*.xlsx")

    Do While MyFile <> ""
        Workbooks.Open Filename:=MyFolder & "\" & MyFile
        MyFile = Dir
    Loop
End Sub 
```

是否有可能有一个类似的代码来关闭文件夹中的所有文件。非常感谢您在此问题上提供的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:27:45.920

Workbooks.Open 将返回对工作簿指针的引用。打开工作簿后立即将其保存在集合中（使用 Collection.Add）。如果要关闭所有工作簿，请遍历集合（使用 For Each）并关闭每个元素。然后从集合中删除所有元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T17:35:26.677

尝试

`Workbooks.Close`

从 Excel Visual Basic 帮助文档：

> 此示例关闭所有打开的工作簿。如果任何打开的工作簿中有更改，Microsoft Excel 会显示相应的提示和对话框以保存更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:23:32.167

您是否需要同时打开它们？因为否则：

```
Sub OpenFiles()
    Dim MyFolder As String
    Dim MyFile As String
    MyFolder = "\\ILAFILESERVER\Public\Documents\Renewable Energy\FiTs\1 Planning Department\Marks Tracker\Quality Control Reports"
    MyFile = Dir(MyFolder & "\*.xlsx")
    Dim wb As Workbook

    Do While MyFile <> ""
        Set wb = Workbooks.Open Filename:=MyFolder & "\" & MyFile
        'Do stuff
        wb.Close False 'The false will close without saving
        MyFile = Dir
    Loop
End Sub 
```

# android - 如何在android中动态隐藏framelayout

> ID：11209354
> 
> 赞同：7
> 
> 时间：2012-06-26T14:16:41.977
> 
> 标签：android

我想在android中动态隐藏framelayout，我怎么能做到这一点。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-26T14:19:56.153

通过在 xml 文件中定义它为您的 frameLayout 提供一个 id 属性：

```
android:id="@+id/someID" 
```

并在代码中编写以下内容：

```
FrameLayout layout = (FrameLayout)findViewById(R.id.someID);
layout.setVisibility(View.GONE); 
```

你也可以使用

> View.INVISIBLE

这意味着该元素将仍然存在。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-26T14:20:05.767

像这样更改可见性：

```
FrameLayout layout = (FrameLayout) findViewById (R.id.your_id);
layout.setVisibility (View.GONE); // or View.INVISIBLE, depending on what you exactly want 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T14:20:10.047

[您可以使用setVisibility(int)](http://developer.android.com/reference/android/view/View.html#setVisibility%28int%29)隐藏或显示视图。

# java - 如何在 MAT Eclipse 的 OQL 中使用“AND 运算符 (&&)”

> ID：11209355
> 
> 赞同：2
> 
> 时间：2012-06-26T14:16:47.650
> 
> 标签：java, heap-memory, jvisualvm, oql, eclipse-mat

我正在对**java rmi**应用程序进行性能调整，并使用 OQL 执行以下查询：

```
select tpoint.host.value.toString() from sun.rmi.transport.tcp.TCPEndpoint tpoint
where (tpoint.host!=null && tpoint.csf!=null) 
```

上面的查询在**JVisualVM**上成功编译，一些记录后跟此错误：-

> 结果太多。请细化您的查询。

相同的查询无法在**Eclipse-MAT**中执行。

之后，`&& tpoint.csf!=null`从 中删除，它在**Eclipse-MAT**`above query`中编译得很好。与 JVisualVM 相比，它花费**的时间也非常少，并且可以显示所有记录。**

 ****我无法找到`&& operator`在 Eclipse-MAT 中使用的正确语法。

**面对很难为Eclipse-MAT**找到好的 OQL 参考，好的参考是值得赞赏的。

提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T05:09:29.707

代替 && 运算符，您可以使用 '**和**' 进行组合查询。好像MAT只支持'and' 'or' 'not'，不支持'&&' '||' '^'。

下面是 MAT 中的有效 OQL 查询。

```
SELECT tpoint.host.value.toString() FROM sun.rmi.transport.tcp.TCPEndpoint tpoint WHERE ((tpoint.host != null) and (tpoint.csf != null)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T05:28:47.403

MAT-Eclipse OQL 和 JVisualVM OQL 之间存在语法差异。

在撰写此答案时，与 MAT-Eclipse 相比，可以在 JVisualVM OQL (AFAIK) 中编写更复杂的查询。

唯一的缺点是，JViualVM 查询的响应时间非常大，而且响应不包括所有的记录。

如果 MAT 开发人员在帮助内容中提供 MAT OQL 查询（groupby、子查询、字符串操作运算符）的良好文档，那就太好了。****

# java - 更改请求的正文

> ID：11209360
> 
> 赞同：3
> 
> 时间：2012-06-26T14:16:53.670
> 
> 标签：java, servlets, request

我有一个处理 REST 请求的 Java Servlet。但是，当它接收到无效数据时，这会中断。这是以 XML 格式发布的，为了尝试解决这个问题，我在过滤器链中添加了一个过滤器。正在调用过滤器，我可以访问请求正文中的数据，访问 XML。

我可以验证这一点并对其进行操作以确保数据正确，但我无法弄清楚如何将其重置回请求对象。

如何设置 HttpServletRequest 对象的主体？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:27:51.663

您可以用一个新类包装您的 HttpServletRequest 对象，我们将其命名为：NewHttpServletRequest。实际的重写应该在适当的覆盖方法中完成，例如 getParameter(String)

```
package com.example;

import javax.servlet.http.HttpServletRequestWrapper;

public class MyHttpServletRequest extends HttpServletRequestWrapper {

    public MyHttpServletRequest(HttpServletRequest request) {
        super(request);
    }

    public String getParameter(String name) {
        String str = super.getParameter(name);
        // DO THE REWRITING
        return str;
    } 
```

}

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:34:22.030

看看[HttpServletRequestWrapper](http://docs.oracle.com/javaee/1.3/api/javax/servlet/http/HttpServletRequestWrapper.html)

您可以使用[公共 HttpServletRequestWrapper(HttpServletRequest request)](http://docs.oracle.com/javaee/1.3/api/javax/servlet/http/HttpServletRequestWrapper.html#HttpServletRequestWrapper%28javax.servlet.http.HttpServletRequest%29)构造函数将原始请求包装为新对象，您不必自己做很多工作。

# c++ - XCode 4 和 OpenCV 库

> ID：11209361
> 
> 赞同：0
> 
> 时间：2012-06-26T14:16:53.970
> 
> 标签：c++, opencv, xcode4, osx-lion, homebrew

我一直在谷歌搜索并尝试解决我运气不好的问题，所以我在这里问我的第一个问题。

**我有一台装有 Lion (1.7.4)、Xcode 4 的 MacBook。我需要使用 Leopard 和 Xcode 3 制作的 C++ 应用程序。**

该应用程序带有自己的 OpenCV.framework，并且是为 32 位架构制作的（如图 1 所示）

![图 1：Xcode 项目中链接的 OpenCV.framework](../Images/f3fd492407e41852e657415960a40041.png)

我试图让它在**Xcode 3**上工作，它工作得很好，不需要安装 OpenCV 或其他东西（那是因为 OpenCV.framework 包含在项目中，对吧？）。

在**Xcode 4**上它不起作用。这就是我尝试过的：

*   “按原样”运行它：即使 OpenCV.framework 在应用程序目录中，我也会收到以下错误：

> dyld：库未加载：@executable_path/../Frameworks/OpenCV.framework/Versions/A/OpenCV
> 引用自：/Users/fabrizioborgia/Library/Developer/Xcode/DerivedData/suiviGUI-awhilvjpoqatfdansnpqcexpnxaw/Build/Products/Debug/suiviGUI .app/Contents/MacOS/suiviGUI 原因：找不到图像

*   删除 OpenCV.framework，通过**MacPorts**安装 OpenCV并链接库。不，这些库是 64 位的，我的程序是 32 位的。删除了 OpenCV 和 MacPorts。

*   **删除 OpenCV.framework，通过Homebrew** (brew install opencv --build32)安装 32 位 OpenCV并链接库。不，我收到以下错误，所以我假设这些库仍然是 64 位的。正确的？删除了 OpenCV 和 Homebrew。

> ld：警告：忽略文件/usr/local/Cellar/opencv/2.4.1/lib/libopencv_calib3d.2.4.1.dylib，文件是为不受支持的文件格式构建的，它不是被链接的体系结构（i386）

*   删除 OpenCV.framework，**自己**安装 OpenCV 2.4.1 （使用 make 和其他东西）并链接项目中的库。不，如果我在 32 位架构上运行程序，它会告诉我这些库不适用于 32 位架构。

无论如何，如果我尝试在 64 位上运行它，编译成功但程序无法正常运行。

**伙计们，真的，我没有想法，也许我走错了方向，也许我只需要找到另一个 OpenCV.framework 或者我缺少一些链接设置，并且程序看不到框架。**

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T19:16:10.197

解决了这个问题。我应用了某种“divide et impera 方法”并在 SO 上提出了一个新问题，你可以在这里找到它：[OS X Lion 上的 32-bit OpenCV？可能的？](https://stackoverflow.com/questions/11223305/32-bit-opencv-on-os-x-lion-possible)我发现 MacPorts 和 Homebrew 和 Cmake 方法默认安装本机架构（在我的情况下为 64 位）OpenCV 库，我需要 32 位，所以我按照以下步骤操作：

第 1 步：下载 OpenCV 2.4.0

第 2 步：下载并安装 CMake。

第 3 步：解压 OpenCV 包。

第 4 步：在 OpenCV 包中创建一个单独的目录用于构建

```
mkdir build
cd build
cmake -G "Unix Makefiles" -D CMAKE_OSX_ARCHITECTURES=i386 -D CMAKE_C_FLAGS=-m32 -D CMAKE_CXX_FLAGS=-m32 .. 
```

（这将强制 32 位编译）

```
make -j8
sudo make install 
```

第 5 步：使用“Link Binary to Libraries”构建阶段链接 Xcode 项目中的全新库。

第6步：点击“运行”:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T19:07:03.930

我建议您使用 XCode 4（[教程](http://tilomitra.com/opencv-on-mac-osx/)）在 Lion 中使用 OpenCV（如果还没有）。使用链接教程中的示例对其进行测试。一旦成功，然后从项目中复制您无法工作的类。

换句话说，放弃旧项目并从工作项目基础重新构建它。

# javascript - 在移动设备上禁用 Fancybox

> ID：11209366
> 
> 赞同：3
> 
> 时间：2012-06-26T14:17:13.083
> 
> 标签：javascript, jquery, mobile, fancybox, handheld

经过大量研究和挫折后，我想我在移动设备上禁用fancybox的方法可能出错了

```
<script type="text/javascript">
$(document).ready(function() 

{ 
if( $(window).width() > 480 && (!navigator.userAgent.match(/Android/i) ||
!navigator.userAgent.match(/webOS/i) ||
!navigator.userAgent.match(/iPhone/i) ||
!navigator.userAgent.match(/iPod/i) ||
navigator.userAgent.match(/BlackBerry/))
){
$("a#for_fancybox").fancybox({
'overlayShow'  : false,
'transitionIn' : 'elastic',
'transitionOut'    : 'elastic'
}
else( $("a#for_fancybox").fancybox({ "scrolling": "yes", "centerOnScroll": "yes",        "showCloseButton": true, "height": "95%", "width": "95%", "type": "iframe", "autoScale": true,   "cyclic": true, "overlayOpacity": 0.8, "showNavArrows": false, "titleShow": false, "content":     "<div> n"}

</script> 
```

我相信这很简单，并且会感谢任何人提供的任何建议。

* * *

*我一直在玩，并且正在取得进展，但是脚本仍在手机上运行。我想知道我是否正确执行了 detectmobilebrowser.js 执行（转换为 .js 文件并在站点的头文件中放置脚本标记）。

```
`<script type="text/javascript">
if( !jQuery.browser.mobile){
$(document).ready(function() {
$("#single1").fancybox({
"scrolling": "yes", "centerOnScroll": "yes", "showCloseButton": true, "height": "95%",     "width": "95%", "type": "iframe", "autoScale": true, "cyclic": true, "overlayOpacity": 0.8,     "showNavArrows": false, "titleShow": false, "content": "<div> n" 
});
$("#single2").fancybox({
"scrolling": "yes", "centerOnScroll": "yes", "showCloseButton": true, "height": "95%",     "width": "95%", "type": "iframe", "autoScale": true, "cyclic": true, "overlayOpacity": 0.8,     "showNavArrows": false, "titleShow": false, "content": "<div> n" 
});
});
}
</script>` 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-06T01:04:25.447

不过，我使用的一种方法远非理想，因为它仍在初始化 Fancybox，它是检查仅在移动响应视图中显示的元素的可见性，然后使用我的其他操作劫持点击绑定。

例如：

```
$('.fancybox').click(function() {
    if($('#mobile').is(':visible')) {
        // do something here
        return false;
    }
});

$('.fancybox').fancybox(); 
```

就像我说的那样，并不理想，但是嘿，它可以在完全响应的环境中工作，不需要依赖浏览器检测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T17:41:28.030

我不完全确定我理解了你的代码的逻辑，因为在你的条件语句中，无论条件是`true`还是`false`......我想你误会了 API 选项`overlayShow`，它适用于覆盖在页面和fancybox 后面，但不是fancybox 本身。

无论如何，我已经在一些生产站点中运行了这个场景，我的方法是基于这样一个事实，即*启用*某些`if`条件存在而不是*禁用*某些`if`条件存在要容易得多。换句话说，`if`你检测到一个`mobile device`then DON'T load fancybox，很简单。

我的首选方法是使用此脚本[http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)来检测移动设备（浏览器）。请注意本页中有关 Apple iPhone 和 iPad（平板电脑部分）的[说明](http://detectmobilebrowsers.com/about)。

那么你的条件语句应该如下所示：

```
<script type="text/javascript">
 if(!jQuery.browser.mobile){
  jQuery(document).ready(function() {
   alert("not a mobile device, fancybox will be enabled");
   jQuery("a#for_fancybox").fancybox({
    // options here
   }); // fancybox
  }); // ready
 } // if
</script> 
```

# css - 在 Firefox 中使用 inline-block 进行水平滚动，但在 Chrome 中不起作用

> ID：11209367
> 
> 赞同：3
> 
> 时间：2012-06-26T14:17:15.810
> 
> 标签：css, google-chrome

我已经在 Firefox 中实现了水平滚动，但它在 Chrome 中不起作用。在 Firefox 中我有这种情况（其中 A、B、C、D 是 div）：

![火狐](../Images/48612cf298cc95f4295f20e37651f648.png)

但是当使用 Chrome 访问同一页面时，这就是我所看到的：

![铬合金](../Images/7e2b35e700016235f8e5191326a49c27.png)

div 的结构如下：

```
<div class="news-list-container">
    <div class="news-list-item">A</div>
    <div class="news-list-item">B</div>
    <div class="news-list-item">C</div>
    <div class="news-list-item">D</div>
    <div class="news-list-item">E</div>
    <div class="news-list-item">F</div>
</div> 
```

和CSS：

```
.news-list-container {
    display: inline-block;
    display: -moz-inline-box;
    height: 187px;
    overflow-x: auto;
    overflow-y: hidden;
    width: 700px;
}

.news-list-item {
    border: 1px solid #E5E5E5;
    float: left;
    height: 175px;
    padding: 5px;
    width: 184px;
} 
```

显然，Chrome 无法识别 display: inline-block。是否有类似/等效于 -moz-inline-block 的东西对 Chrome 有同样的作用？如果没有，我怎样才能在两个浏览器上获得相同的水平滚动？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T15:37:31.530

经过一些实验后解决了。我必须在两者之间添加另一个 div 并将其宽度设置为包含元素的总宽度（考虑边框和填充）。这样就不再需要*显示属性，并且一切都在 Firefox 和 Chrome 中运行。*

```
<div class="news-list-container">
  <div id=container>
    <div class="news-list-item">A</div>
    <div class="news-list-item">B</div>
    <div class="news-list-item">C</div>
    <div class="news-list-item">D</div>
    <div class="news-list-item">E</div>
    <div class="news-list-item">F</div>
  </div>
</div>

.news-list-container {
    overflow-x: auto;
    overflow-y: hidden;
}

#container {
    height: 187px;
    width: 1176px;
}

.news-list-item {
    border: 1px solid #E5E5E5;
    float: left;
    height: 175px;
    padding: 5px;
    width: 184px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-16T12:31:55.710

在 CSS 属性下方使用。

`-webkit-backface-visibility: hidden`

# asp.net - 如何在动态添加的用户控件中调用页面方法？

> ID：11209368
> 
> 赞同：0
> 
> 时间：2012-06-26T14:17:16.027
> 
> 标签：asp.net

我在页面上动态添加用户控件，用户控件有一个保存按钮，该按钮从用户控件和页面获取数据以保存在数据库中，在相同的保存方法中，我想访问页面中写入的方法，所以我那个方法有代码来重新绑定页面中保存的网格。

那么如何在动态添加的用户控件中调用页面方法呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:24:10.807

我打算建议为您的页面创建一个基类，但找到了一种更好的方法来完成此任务：

[http://www.codeproject.com/Articles/115008/Calling-Method-in-Parent-Page-from-User-Control](http://www.codeproject.com/Articles/115008/Calling-Method-in-Parent-Page-from-User-Control)

控制代码：

```
public partial class CustomUserCtrl : System.Web.UI.UserControl
{
    private System.Delegate _delWithParam;
    public Delegate PageMethodWithParamRef
    {
        set { _delWithParam = value; }
    }

    private System.Delegate _delNoParam;
    public Delegate PageMethodWithNoParamRef
    {
        set { _delNoParam = value; }
    }

    protected void Page_Load(object sender, EventArgs e)
    {
    }

    protected void BtnMethodWithParam_Click(object sender, System.EventArgs e)
    {
        //Parameter to a method is being made ready
        object[] obj = new object[1];
        obj[0] = "Parameter Value" as object;
        _delWithParam.DynamicInvoke(obj);
    }

    protected void BtnMethowWithoutParam_Click(object sender, System.EventArgs e)
    {
        //Invoke a method with no parameter
        _delNoParam.DynamicInvoke();
    }
} 
```

页面代码：

```
public partial class _Default : System.Web.UI.Page
{
    delegate void DelMethodWithParam(string strParam);
    delegate void DelMethodWithoutParam();
    protected void Page_Load(object sender, EventArgs e)
    {
        DelMethodWithParam delParam = new DelMethodWithParam(MethodWithParam);
        //Set method reference to a user control delegate
        this.UserCtrl.PageMethodWithParamRef = delParam;
        DelMethodWithoutParam delNoParam = new DelMethodWithoutParam(MethodWithNoParam);
        //Set method reference to a user control delegate
        this.UserCtrl.PageMethodWithNoParamRef = delNoParam;
    }

    private void MethodWithParam(string strParam)
    {
        Response.Write(“&lt;br/>It has parameter: ” + strParam);
    }

    private void MethodWithNoParam()
    {
        Response.Write(“&lt;br/>It has no parameter.”);
    }
} 
```

# android - Application crash after open preferences

> ID：11209371
> 
> 赞同：0
> 
> 时间：2012-06-26T14:17:24.940
> 
> 标签：android, android-intent, android-preferences

When I click Settings in my application's menu, app crash instantly. I don't have idea how to repair it.

I am new to Android and I learn from **Hello, Android** book.

Application files below:

* * *

PrefsFragment.java:

```
package org.example.sudoku;

import android.os.Bundle;
import android.preference.PreferenceFragment;

public class PrefsFragment extends PreferenceFragment {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.preferences);
    }
} 
```

* * *

res/xml/preferences.xml:

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >

    <CheckBoxPreference
        android:key="music"
        android:title="@string/music_title"
        android:summary="@string/music_summary"
        android:defaultValue="true" />

    <CheckBoxPreference
        android:key="hints"
        android:title="@string/hints_title"
        android:summary="@string/hints_summary"
        android:defaultValue="true" />

￼￼￼&lt;/PreferenceScreen> 
```

* * *

Logcat:

```
06-26 16:14:26.600: W/dalvikvm(2827): threadid=1: thread exiting with uncaught exception (group=0x40a041f8)
06-26 16:14:26.610: E/AndroidRuntime(2827): FATAL EXCEPTION: main
06-26 16:14:26.610: E/AndroidRuntime(2827): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{org.example.sudoku/org.example.sudoku.PrefsFragment}: java.lang.ClassCastException: org.example.sudoku.PrefsFragment cannot be cast to android.app.Activity
06-26 16:14:26.610: E/AndroidRuntime(2827):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1993)
06-26 16:14:26.610: E/AndroidRuntime(2827):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2104)
06-26 16:14:26.610: E/AndroidRuntime(2827):     at android.app.ActivityThread.access$600(ActivityThread.java:132)
06-26 16:14:26.610: E/AndroidRuntime(2827):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1157)
06-26 16:14:26.610: E/AndroidRuntime(2827):     at android.os.Handler.dispatchMessage(Handler.java:99)
06-26 16:14:26.610: E/AndroidRuntime(2827):     at android.os.Looper.loop(Looper.java:137)
06-26 16:14:26.610: E/AndroidRuntime(2827):     at android.app.ActivityThread.main(ActivityThread.java:4575)
06-26 16:14:26.610: E/AndroidRuntime(2827):     at java.lang.reflect.Method.invokeNative(Native Method)
06-26 16:14:26.610: E/AndroidRuntime(2827):     at java.lang.reflect.Method.invoke(Method.java:511)
06-26 16:14:26.610: E/AndroidRuntime(2827):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:789)
06-26 16:14:26.610: E/AndroidRuntime(2827):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:556)
06-26 16:14:26.610: E/AndroidRuntime(2827):     at dalvik.system.NativeStart.main(Native Method)
06-26 16:14:26.610: E/AndroidRuntime(2827): Caused by: java.lang.ClassCastException: org.example.sudoku.PrefsFragment cannot be cast to android.app.Activity
06-26 16:14:26.610: E/AndroidRuntime(2827):     at android.app.Instrumentation.newActivity(Instrumentation.java:1023)
06-26 16:14:26.610: E/AndroidRuntime(2827):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1984)
06-26 16:14:26.610: E/AndroidRuntime(2827):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:30:32.500

The problem is that you need to extend [PreferenceActivity](http://developer.android.com/reference/android/preference/PreferenceActivity.html), not PreferenceFragment. [PreferenceActivity](http://developer.android.com/reference/android/preference/PreferenceActivity.html) extends ListActivity, which extends Activity, while [PreferenceFragment](http://developer.android.com/reference/android/preference/PreferenceFragment.html) extends Fragment.

That's why you have the ClassCast Exception.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:31:17.120

How did you access to your PreferenceFragment ?

Is it contained in a FragmentActivity ?

You cannot call directly a Fragment with startActivity();

# java - Weblogic + JPA 不刷新 Oracle 数据库上的数据

> ID：11209375
> 
> 赞同：0
> 
> 时间：2012-06-26T14:17:41.317
> 
> 标签：java, oracle, jpa, weblogic, eclipselink

我有一个基于 Oracle10g (datasource) + Weblogic 10.3 + Eclipselink 的系统。

如果我通过带有 DAO 的 Java 软件插入或删除数据，所有数据都立即可用，但如果我手动插入数据（通过 SqlDeveloper 或使用 java.sql.Connection 类），则不会从数据库中获取新数据。
为什么会发生？以及如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T17:43:24.477

发生这种情况是因为 EclipseLink 无法意识到通过其他一些方法对数据库进行了更改。外部工具不会通知 EclipseLink 有关更改，并且 EclipseLink 并不总是轮询数据库内容以查找可能的更改。这样的实现会降低性能。通过 JPA 批量操作进行的更改也会发生同样的情况，例如 JPQL 和本机 SQL DELETE 和 INSERT 查询。

您无法真正解决问题，但是当您关闭共享缓存时，它会更容易解决。请注意可能会影响性能。

在 JPA 1 中：

```
<property name="eclipselink.cache.shared.default" value="false"/> 
```

在 JPA 2 中：

```
<shared-cache-mode>NONE</shared-cache-mode> 
```

作为共享缓存的补充，EntityManager 也维护缓存。单个实体可以通过[refresh](http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html#refresh%28java.lang.Object%29)方法从数据库中刷新。

# maven - 使用 Gradle 构建 Maven 插件

> ID：11209382
> 
> 赞同：13
> 
> 时间：2012-06-26T14:18:07.240
> 
> 标签：maven, maven-plugin, gradle

我正在考虑搬到 Gradle。但是，我确实有一些 Maven 插件需要在可预见的将来得到支持。

有没有办法使用 Gradle 构建 Maven 插件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-19T00:44:49.497

[这](https://github.com/evgeny-goldin/build-info/blob/3712d354f31d813c18c10a35dc07e9581979e61f/build.gradle#L360)对我有用：

*   编译插件的源代码后生成项目的 POM：`"install.repositories.mavenInstaller.pom.writeTo( 'pom.xml' )"`
*   生成 POM 补丁并提供插件的坐标和正确的目标目录
*   跑`"mvn org.apache.maven.plugins:maven-plugin-plugin:3.2:descriptor"`

这种方式`"build/classes/main/META-INF/maven/plugin.xml"`是由任务创建然后正确打包的`jar`，这就是 jar 文件成为 Maven 插件 AFAIK 所需的全部内容。另外，我相信，应该在插件中使用[“maven-plugin-annotations” 。](https://maven.apache.org/plugin-tools/maven-plugin-plugin/examples/using-annotations.html)

```
task pluginDescriptor( type: Exec ) {
    commandLine 'mvn', '-e', '-B', 'org.apache.maven.plugins:maven-plugin-plugin:3.2:descriptor'
    doFirst {
        final File pom = project.file( 'pom.xml' )
        install.repositories.mavenInstaller.pom.writeTo( pom )
        assert pom.file, "[$pom.canonicalPath] was not created"

        pom.text = pom.text.
            replace( '<groupId>unknown</groupId>',             "<groupId>${project.group}</groupId>" ).
            replace( '<artifactId>empty-project</artifactId>', "<artifactId>${project.name}</artifactId>" ).
            replace( '<version>0</version>',                   """
                                                              |<version>${version}</version>
                                                              |  <packaging>maven-plugin</packaging>
                                                              |  <build>
                                                              |    <directory>\${project.basedir}/build</directory>
                                                              |    <outputDirectory>\${project.build.directory}/classes/main</outputDirectory>
                                                              |  </build>
                                                              |""".stripMargin().trim())
    }
    doLast {
        final  pluginDescriptor = new File(( File ) project.compileGroovy.destinationDir, 'META-INF/maven/plugin.xml' )
        assert pluginDescriptor.file, "[$pluginDescriptor.canonicalPath] was not created"
        println "Plugin descriptor file:$pluginDescriptor.canonicalPath is created successfully"
    }
}

project.compileGroovy.doLast{ pluginDescriptor.execute() } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:42:34.747

我不知道允许构建 Maven 插件的第三方 Gradle 插件。一种可能性是调用 Maven 来完成部分工作（特别是元数据生成）。可以即时创建必要的 POM。另一种可能性是将元数据提交到源代码管理并手动更新它（可能在需要时通过运行 Maven）。最后但同样重要的是，您可以编写一些代码在 Gradle 端执行元数据生成，可能重用一些 Maven 代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-30T21:11:12.993

我发现这个 Gradle Plugin 可以用来创建 Maven Plugin [Maven Plugin Builder Gradle Plugin](https://dev.liferay.com/develop/reference/-/knowledge_base/7-0/maven-plugin-builder-gradle-plugin)但我还没有让它工作

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-26T14:40:56.503

目前该功能不受支持，但它在[开发路线图](http://forums.gradle.org/gradle/topics/deep_import_of_maven_projects)上。每隔一段时间检查一次[路线图仪表板](http://www.gradle.org/roadmap)，看看状态是否发生了变化。

# php - 在 PHP 数组中查找元素（如果存在）

> ID：11209385
> 
> 赞同：2
> 
> 时间：2012-06-26T14:18:10.173
> 
> 标签：php

我想知道是否有更优雅的方式来做到这一点：

```
$foo = (isset($bar) and array_key_exists('meh', $bar)) ? $bar['meh'] : ''; 
```

如果我删除`isset`部分，如果`$bar`不是数组， PHP 会发出警告；如果我删除`array_key_exists`部分，如果`meh`键不在数组中，PHP 会发出警告。有没有更优雅、无警告的方式来达到同样的目的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:21:09.807

您可以直接引用密钥。如果 $bar 未定义，它内部`isset`甚至不会抛出异常。

```
$foo = isset($bar['meh']) ? $bar['meh'] : ''; 
```

[array_key_exists](http://php.net/array_key_exists)和[isset](http://php.net/isset)之间的区别在于，如果键对应于一个值，`isset`它将返回。因此，在我上面的代码中，一个值将导致开始为空字符串，而不是. 如果这是一个问题，那么您当前的方法将是最好的。`FALSE``NULL``NULL``$foo``NULL`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:21:19.467

您完全按照您提到的警告“保护”代码所需的步骤。

但是，警告是有原因的。通常，检查是否可以防止您尝试访问的变量未初始化的情况更有意义。

# ios - 在 Xcode 项目中为 2 个不同的目标构建会产生意想不到的结果

> ID：11209389
> 
> 赞同：0
> 
> 时间：2012-06-26T14:18:21.140
> 
> 标签：ios, xcode, build, target, targets

我正在使用 Xcode 4.3.3。我的项目有 2 个目标，它们非常相似（一个与另一个重复）。唯一的问题是它们有不同的名称，并且有少量#ifdef 正在进行。一个项目比另一个项目编译更多的文件并复制更多的捆绑资源。除此之外，它们应该是相同的。这就像拥有 Pro 和 Lite 应用程序版本。

我似乎有一些问题（为其中一个目标构建绝对没问题，所以所有这些问题都与“另一个”目标有关）......

1.  在构建“其他”目标时，它会给我警告“输出文件的多个构建命令......”。它指的是“icon-72.png”。但是，我不仅删除了对该文件的第二个引用（仍然收到警告），而且还完全删除了该文件并删除了我可以找到的所有引用，包括从目标摘要中删除图标，确保该项目的 Finder 中的任何项目文件夹中都不存在该文件，并确保它未列在“构建阶段”的“复制捆绑资源”中。警告仍然出现。

2.  在构建“其他”目标时，它不会给我通常的警告。这些警告此时应该存在于两个版本中。我已经检查了正在编译的内容，并且应该生成这些警告的文件都包含在两个目标的“构建阶段”的“编译源”中。

3.  建立“其他”目标让我“失败”。但是，在问题导航器中没有解释失败的原因。

顺便说一句，“另一个”目标是原来的目标，而不是新目标。

此外，我在每次构建尝试之前都尝试过清理，并且还重新启动了 Xcode。我最近也重新启动了计算机。

任何指向正确方向的帮助或一般性指示将不胜感激。

属性。

编辑....

我按照问题导航器中的提示更新了项目设置以使用 LLDB。现在我没有收到任何一个目标的任何警告，但“其他”目标仍然无法无缘无故地构建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T20:56:31.243

对。好吧，事实证明[这](https://stackoverflow.com/questions/9843129/warning-is-not-displayed-in-xcode-issue-navigator)主要是答案（检查最后一条评论）。我在（cmd-W）中用我的项目关闭了实际的 Xcode 窗口，然后我转到 File > Open 并从那里打开项目文件（而不是从启动窗口或最近列表打开它）。

现在我可以看到警告并说明构建失败的原因。呸！！

# zend-framework - Zend 检查模块是否已安装并处于活动状态

> ID：11209391
> 
> 赞同：1
> 
> 时间：2012-06-26T14:18:22.777
> 
> 标签：zend-framework

我想为我正在运行的应用程序创建一个模块。我选择了模块，以便可以选择将其添加到应用程序中。

我想创建以下内容。安装模块后（模块子文件夹放置在 /application/modules/ 中）我想向我的应用程序添加一个新按钮/功能。

我想在控制器操作中检查这个已安装的模块。

有没有办法做到这一点？

问候， 马克斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:44:48.387

这应该有助于：

```
$modules = Zend_Controller_Front::getInstance()->getControllerDirectory(); 
```

然后模块由返回的数组的键给出：

```
array(
    'default' => '../application/controllers',
    'blog'    => '../modules/blog/controllers',
    'news'    => '../modules/news/controllers',
) 
```

然后，您可以在您的操作中执行检查：

```
if (array_key_exists('myModule', $modules)) {
    // do something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T17:18:53.737

为了让应用程序生成新菜单，我喜欢做的是创建一个保存菜单的全局变量。这样，在新模块 Bootstrap 中，我可以将项目添加到菜单中。我使用的代码很长，所以我不会在这里发布，但如果你需要，可以给我发电子邮件。

# drools - Drools ：用于生成 .drl 文件或基于 XML 的规则内容的工具

> ID：11209392
> 
> 赞同：4
> 
> 时间：2012-06-26T14:18:22.823
> 
> 标签：drools, rule-engine

我们正在为我们的 Java Web 应用程序使用 Drools Rul 引擎。

编写 DRL 文件似乎很容易出错，我只是想知道是否有任何工具可以自动生成 .drl 文件或基于 xml 的规则？

提前致谢 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-05T09:15:08.143

您还可以使用基于电子表格（xls 文件）的决策表。这使用起来很方便。

你可以在这里阅读更多信息：http: [//docs.jboss.org/drools/release/5.2.0.Final/drools-expert-docs/html/ch06.html](http://docs.jboss.org/drools/release/5.2.0.Final/drools-expert-docs/html/ch06.html)

或者，您也可以使用“Fluent API”从 java 代码创建规则，请阅读此处：

[http://docs.jboss.org/drools/release/5.2.0.Final/droolsjbpm-introduction-docs/html/ch02.html#d0e124](http://docs.jboss.org/drools/release/5.2.0.Final/droolsjbpm-introduction-docs/html/ch02.html#d0e124)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-11T20:43:34.803

您可以查看 Drools Guvnor 项目[http://www.jboss.org/drools/drools-guvnor.html](http://www.jboss.org/drools/drools-guvnor.html)，它允许您通过 GUI 创建规则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T11:04:56.953

实际上我不知道有什么工具可以做到这一点，但它确实有助于为您的 ide 安装插件。

例如，如果您正在运行 eclipse，那么有一整套套件可以对您的规则文件进行语法检查，并在编写规则时自动报告静态类型检查错误。

请参阅[此处的文档...](http://docs.jboss.org/drools/release/5.2.0.Final/droolsjbpm-introduction-docs/html/ch03.html)

由于在“预编译”时规则文件和你的类之间没有真正的硬绑定，这有很大帮助。

# magento - Magento - 相同的代码产生不同的 SQL

> ID：11209393
> 
> 赞同：0
> 
> 时间：2012-06-26T14:18:22.887
> 
> 标签：magento, collections

我有以下代码：

```
set_time_limit(7200);
error_reporting(E_ALL);
ini_set('display_errors','On');

$start = microtime_float();
require_once 'app/Mage.php';
Mage::app();
$storeId = array(1);

// Empty Latest Products
$_category = Mage::getModel('catalog/category')->loadByAttribute('name', 'Latest Products');
$latestProductsId = $_category->getId();

emptyCategory($latestProductsId);

addLatestProducts($latestProductsId);

function emptyCategory($catId)
{
    $category = Mage::getModel("catalog/category")->load($catId);
    $collection = $category->getProductCollection();
    foreach($collection as $product)
    {
        $curCats = $product->getCategoryIds();
        $changed = false;
        foreach($curCats as $key => $value) 
        {
            if($value == $catId) 
            {
                unset($curCats[$key]); // remove the category
                $changed = true;
            }
        }
        if($changed) // only save the product if nessesary
        {
            $product->setCategoryIds($curCats);
            $product->save();

        }
    }
}

function addLatestProducts($latestProductsId)
{
    $tomorrow = date('Y-m-d 00:00:00', strtotime("tomorrow"));
    $nWeeksAgo = date('Y-m-d 00:00:00', strtotime("-2 weeks"));

    $visibility = array(Mage_Catalog_Model_Product_Visibility::VISIBILITY_BOTH, Mage_Catalog_Model_Product_Visibility::VISIBILITY_IN_CATALOG);
    $status = array(Mage_Catalog_Model_Product_Status::STATUS_ENABLED);
    $storeId = 1;

    $_productCollection = Mage::getResourceModel('catalog/product_collection')
        ->addAttributeToSelect('*')
        ->addAttributeToFilter('visibility', $visibility)
        ->addAttributeToFilter('status', $status)
        ->setStoreId($storeId)
        ->setPageSize(30)
        ->setOrder('entity_id', 'DESC')
        ->addAttributeToFilter('created_at', array(
            'from' => $nWeeksAgo,
            'to' => $tomorrow,
            'date' => true, // specifies conversion of comparison values
            ));

    $i=0;
    echo $_productCollection->getSelect(); //<---- This is where the SQL is generated

    foreach ($_productCollection as $product) {
        $curCats = $product->getCategoryIds();
        if(!in_array($latestProductsId, $curCats)){
            // not currently in the latest products category. Add it.
            $curCats[] = $latestProductsId;
            $product->setCategoryIds($curCats);
            $product->save();
            unset($product);
        }
        $i++;
    }
    unset($_productCollection);
} 
```

这背后的想法是获取过去 2 周内添加的所有产品，清空“最新产品”类别，并用过去 2 周内添加的所有产品重新填充它。

它一直运行良好，但最近 addLatestProducts() 生成的集合似乎生成了 2 个不同的选择语句。有时它有效..有时它没有。它生成的两个 SQL 位是：

```
SELECT `e`.*,
  IF(_table_visibility.value_id > 0, _table_visibility.value, _table_visibility_default.value) AS `visibility`,
  IF(_table_status.value_id > 0, _table_status.value, _table_status_default.value) AS `status`,
  IFNULL(`entity_id_option_value_t2`.`value`, `entity_id_option_value_t1`.`value`) AS `entity_id_value`

FROM `catalog_product_entity` AS `e`

INNER JOIN `catalog_product_entity_int` AS `_table_visibility_default` ON (`_table_visibility_default`.`entity_id` = `e`.`entity_id`) AND (`_table_visibility_default`.`attribute_id` = '91') AND `_table_visibility_default`.`store_id` = 0
LEFT JOIN `catalog_product_entity_int` AS `_table_visibility` ON (`_table_visibility`.`entity_id` = `e`.`entity_id`) AND (`_table_visibility`.`attribute_id` = '91') AND (`_table_visibility`.`store_id` = '1') 
INNER JOIN `catalog_product_entity_int` AS `_table_status_default` ON (`_table_status_default`.`entity_id` = `e`.`entity_id`) AND (`_table_status_default`.`attribute_id` = '84') AND `_table_status_default`.`store_id` = 0 
LEFT JOIN `catalog_product_entity_int` AS `_table_status` ON (`_table_status`.`entity_id` = `e`.`entity_id`) AND (`_table_status`.`attribute_id` = '84') AND (`_table_status`.`store_id` = '1')
LEFT JOIN `catalog_product_entity` AS `entity_id_t1` ON `e`.`entity_id`=`entity_id_t1`.`entity_id` AND `entity_id_t1`.`attribute_id`='' AND `entity_id_t1`.`store_id`='0'
LEFT JOIN `catalog_product_entity` AS `entity_id_t2` ON `e`.`entity_id`=`entity_id_t2`.`entity_id` AND `entity_id_t2`.`attribute_id`='' AND `entity_id_t2`.`store_id`='1'
LEFT JOIN `eav_attribute_option_value` AS `entity_id_option_value_t1` ON `entity_id_option_value_t1`.`option_id`=IF(`entity_id_t2`.`value_id`>0, `entity_id_t2`.`value`, `entity_id_t1`.`value`) AND `entity_id_option_value_t1`.`store_id`='0'
LEFT JOIN `eav_attribute_option_value` AS `entity_id_option_value_t2` ON `entity_id_option_value_t2`.`option_id`=IF(`entity_id_t2`.`value_id`>0, `entity_id_t2`.`value`, `entity_id_t1`.`value`) AND `entity_id_option_value_t1`.`store_id`='1'

WHERE ((
     (IF(_table_visibility.value_id > 0, _table_visibility.value, _table_visibility_default.value) = '4')
  or (IF(_table_visibility.value_id > 0, _table_visibility.value, _table_visibility_default.value) = '2')
))
AND (((IF(_table_status.value_id > 0, _table_status.value, _table_status_default.value) = '1')))
AND (e.created_at >= '2012-06-12' and e.created_at <= '2012-06-27')

ORDER BY `entity_id_value` DESC 
```

和

```
SELECT `e`.*,
  IF(_table_visibility.value_id > 0, _table_visibility.value, _table_visibility_default.value) AS `visibility`,
  IF(_table_status.value_id > 0, _table_status.value, _table_status_default.value) AS `status`

FROM `catalog_product_entity` AS `e`

INNER JOIN `catalog_product_entity_int` AS `_table_visibility_default` ON (`_table_visibility_default`.`entity_id` = `e`.`entity_id`) AND (`_table_visibility_default`.`attribute_id` = '91') AND `_table_visibility_default`.`store_id` = 0
LEFT JOIN `catalog_product_entity_int` AS `_table_visibility` ON (`_table_visibility`.`entity_id` = `e`.`entity_id`) AND (`_table_visibility`.`attribute_id` = '91') AND (`_table_visibility`.`store_id` = '1') 
INNER JOIN `catalog_product_entity_int` AS `_table_status_default` ON (`_table_status_default`.`entity_id` = `e`.`entity_id`) AND (`_table_status_default`.`attribute_id` = '84') AND `_table_status_default`.`store_id` = 0 
LEFT JOIN `catalog_product_entity_int` AS `_table_status` ON (`_table_status`.`entity_id` = `e`.`entity_id`) AND (`_table_status`.`attribute_id` = '84') AND (`_table_status`.`store_id` = '1')

WHERE ((
     (IF(_table_visibility.value_id > 0, _table_visibility.value, _table_visibility_default.value) = '4')
  or (IF(_table_visibility.value_id > 0, _table_visibility.value, _table_visibility_default.value) = '2')
))
AND (((IF(_table_status.value_id > 0, _table_status.value, _table_status_default.value) = '1')))
AND (e.created_at >= '2012-06-12' and e.created_at <= '2012-06-27')

ORDER BY `e`.`entity_id` DESC, `e`.`entity_id` DESC 
```

最上面的 SQL 失败，第二个有效，但它们都是从 5 秒后运行的相同代码生成的。（只需在浏览器中点击刷新！）

知道是什么原因造成的吗？Magento 1.5.1.0

谢谢

**更新*：**好的，所以它似乎每隔***一次***都会失败。第一次运行没问题。第二次运行失败。第三次运行就OK了。第 4 次运行失败。ETC...

# c# - Database.ExecuteSprocAccessor() 未正确映射 blob 数据

> ID：11209394
> 
> 赞同：0
> 
> 时间：2012-06-26T14:18:27.613
> 
> 标签：c#, asp.net-mvc-3, sql-server-2008, enterprise-library-5, data-access-app-block

如果有人能帮我解决这个问题，我将不胜感激。对于初学者，我有这样的课程：

```
public class Blob
{
    public int BlobID { get; set; }
    public string BlobName { get; set; }
    public string FileName { get; set; }
    public string FileMimeType { get; set; }
    public int FileSize { get; set; }
    public byte[] FileContent{ get; set; }
    public DateTime DateCreated { get; set; }
    public int CreatedByProfileID { get; set; }
} 
```

非常标准，它只是一个映射到具有完全相同字段名称的表的对象。SQL Server 中的表如下所示：

![在此处输入图像描述](../Images/a1f043f977c1a5858efdb763160cae2c.png)

我的控制器具有添加和查看操作来读取和写入数据库。我可以使用下面的操作代码很好地编写文件：

```
[HttpPost]
public ActionResult Add(HttpPostedFileBase file)
{
    if (file != null && file.ContentLength > 0)
    {
        Database db = DatabaseFactory.CreateDatabase("dbconnstr");

        byte[] fileContent = new byte[file.ContentLength];
        file.InputStream.Read(fileContent, 0, file.ContentLength);

        object[] paramaters = 
        {
            file.FileName,
            file.FileName,
            file.ContentType,
            file.ContentLength,
            fileContent,
            DateTime.Now,
            12518
        };

        db.ExecuteNonQuery("sp_Blob_Insert", paramaters);
    }

    return RedirectToAction("Index");
} 
```

但是，当我使用下面的查看操作代码将文件读取到浏览器时，FileContent 字段始终为空：

```
public ActionResult View(int id)
{
    Database db = DatabaseFactory.CreateDatabase("dbconnstr");

    Blob blob = db.ExecuteSprocAccessor<Blob>("sp_Blob_SelectByPkValue", id).Single();

    return File(blob.FileContent, blob.FileMimeType, blob.FileName);
} 
```

但是，如果我专门映射字段名称，它可以工作：

```
public ActionResult View(int id)
{
    Database db = DatabaseFactory.CreateDatabase("dbconnstr");

    IRowMapper<Blob> mapper = MapBuilder<Blob>.MapAllProperties().MapByName(x => x.FileContent).Build();

    Blob blob = db.ExecuteSprocAccessor<Blob>("sp_Blob_SelectByPkValue", mapper, id).Single();

    return File(blob.FileContent, blob.FileMimeType, blob.FileName);
} 
```

这是 ExecuteSprocAccessor() 函数的错误吗？我做错什么了吗？

提前感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-09T12:15:19.733

您可以使用以下代码：

```
.Map(x => x.FileContent).WithFunc(ConvertVarBinaryToByteArray); 
```

然后像这样创建函数：

```
private static byte[] ConvertVarBinaryToByteArray(IDataRecord dataRecord) 
{ 
    return (byte[]) dataRecord.GetValue(dataRecord.GetOrdinal("FileContent")); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-07T13:15:48.110

我这样解决了这个问题：

在执行 ExecuteSprocAccessor 之前添加此代码：

```
IRowMapper<FileEmail> rowMapper = MapBuilder<FileEmail>.MapAllProperties()
        .Map(x => x.MyFile)
        .WithFunc(ConvertVarBinaryToByteArray).Build(); 
```

并创建 Russ 上面所说的方法：

```
private static byte[] ConvertVarBinaryToByteArray(IDataRecord dataRecord)
    {
        return (byte[])dataRecord.GetValue(dataRecord.GetOrdinal("FileContent"));
    } 
```

# asp.net-mvc-4 - 为什么 MVC4 捆绑和缩小会使我的文件变大？

> ID：11209396
> 
> 赞同：10
> 
> 时间：2012-06-26T14:18:31.930
> 
> 标签：asp.net-mvc-4, asp.net-optimization

我正在 MVC4 中实现捆绑和缩小支持，看起来好像它使我的 javascript 文件比没有捆绑/缩小时更大。我正在使用 nuget 中可用的最新版本（启用预发布选项）。我在我的 RegisterBundles 类中设置了以下捆绑包。

```
bundles.Add(new ScriptBundle("~/bundles/baseJS").Include(
                    "~/Scripts/jquery-1.7.1.js",
                    "~/Scripts/jquery.cookie.js",
                    "~/Scripts/jquery-ui-1.8.11.js",
                    "~/Scripts/bootstrap.js",
                    "~/Scripts/jquery.pjax.js",
                    "~/Scripts/kendo/2012.1.515/js/kendo.all.min.js",
                    "~/Scripts/jquery.jstree.js",
                    "~/Scripts/jquery.unobtrusive-ajax.js",
                    "~/Scripts/jquery.validate.js",
                    "~/Scripts/jquery.validate.unobtrusive.js",
                    "~/RIS.Scripts/PostJson.js")); 
```

我正在使用将它加载到我的 _Layout.cshtml 中

```
@Scripts.Render("~/bundles/baseJS") 
```

当我在调试模式下将 Fiddler 中收到的这些脚本的字节数相加时，我得到以下信息

```
Name                        Size(bytes)
jquery                      98013
jquery cookie               1455
jquery ui                   124704
bootstrap                   52378
pjax                        8138
kendo.all                   219751
jstree                      55045
unobtrusive-ajax            2492
validate                    13323
validate-unobtrusive        5138
postjson                    634

Total                       581071 
```

当我在生产服务器上运行它时，我从提琴手那里得到了整个 js 包的以下信息。

```
Bytes Received:  999,396 
```

这里发生了什么？大多数文件在某种程度上都被缩小了，但它不应该几乎是我的有效负载大小的两倍。

其他详细信息 - 当我从本地开发盒（fiddler 报告大小 379kb）和服务器（fiddler 报告大小 999kb）下载 js 文件并将它们放入 kdiff 时，它们是二进制相同的。当我查看 Chrome 的开发者工具网络选项卡时，本地服务器下载 379kb，但“解析器”的值为 975kb。这个解析器值是多少。是否有一些 IIS 压缩设置未在我的服务器中设置但在我的本地 IIS 服务器上？我注意到的唯一区别是我在开发机器上运行的 IIS Express 是 8.0，而服务器是 IIS 7.5。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-29T22:57:40.020

您在这里看到的很可能是来自`FileExtensionReplacementList`.

让我们以 jQuery 为例。通常在您的脚本文件夹中，您将看到每个文件的两个副本，即`jquery-1.6.2.js`和`jquery-1.6.2.min.js`.

默认情况下，优化将使用`min.js`版本 when `debug=false`，并使用常规`jquery-1.6.2.js`when `debug=true`，因为通常这会使调试更容易（没有捆绑和缩小捆绑）。

此文件选择“魔术”是通过`FileExtensionReplacementList`on控制的`BundleCollection`。

在下一个版本 (RTM) 中，此列表中的粒度会更细一些，因为通常开发人员会希望确定何时应该使用它们，即

```
list.Add("min", OptimizationMode.WhenEnabled);
list.Add("debug", OptimizationMode.WhenDisabled); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T21:27:58.530

您可以使用捆绑选项，但缩小是通过`BundleTable.EnableOptimizations = true`设置和一些您尚未参与的“转换”选项完成的。请参阅 CssMinify 和 JsMinify。

类似于以下内容：

```
 var b1 =new ScriptBundle("~/bundles/jquery").Include(
                "~/Scripts/jquery-1.*");

        b1.Transforms.Add(new JsMinify());

        bundles.Add(b1); 
```

- 和 -

```
BundleTable.EnableOptimizations = true; 
```

# ios - Facebook SDK 从我的个人资料中加载默认图像而不是图像，为什么？

> ID：11209397
> 
> 赞同：1
> 
> 时间：2012-06-26T14:18:32.850
> 
> 标签：ios, facebook, facebook-graph-api

我在我的应用程序中设置了这些 facebook 权限：

```
NSArray *permissions = [[NSArray alloc] initWithObjects:
                                    @"user_games_activity", 
                                    @"friends_games_activity",
                                    @"publish_actions",
                                    @"user_photos",
                                    nil];
            [[myDelegate facebook] authorize:permissions]; 
```

我提出这样的要求：

```
NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObjectsAndKeys:@"name,picture",@"fields",nil];
    [[delegate facebook] requestWithGraphPath:@"me" andParams:params andDelegate:self]; 
```

并处理如下响应：

```
else if([request.url rangeOfString:@"me"].location != NSNotFound)
    {
        NSString *username = [result objectForKey:@"name"];
        NSLog(@"We think the username is %@", username);
        helloGreeting.text = [NSString stringWithFormat:@"Hello %@", username];

        NSString *pictureUrl = [result objectForKey:@"picture"];
        NSLog(@"Now loading image [%@]", pictureUrl);
        NSData *data = [NSData dataWithContentsOfURL:[NSURL URLWithString:pictureUrl]];
        profilePhoto.image = [UIImage imageWithData:data];  
    } 
```

我得到的日志输出是：

```
2012-06-26 15:10:49.002 FacebookIntegrator[10549:f803] We think the username is James Elsey
2012-06-26 15:10:49.003 FacebookIntegrator[10549:f803] Now loading image [http://profile.ak.fbcdn.net/static-ak/rsrc.php/v2/yo/r/UlIqmHJn-SK.gif] 
```

![在此处输入图像描述](../Images/d658dc555fc1f779b09177364c47efce.png)

**问题**：为什么它获得一个默认的通用 facebook 图标而不是我自己的头像？[在Graph Explorer](https://developers.facebook.com/tools/explorer?method=GET&path=563645402/picture)上使用相同的访问令牌，我可以访问我的个人资料图片图像 URL

状态的[文档](https://developers.facebook.com/docs/authentication/permissions/)`user_photos`：

> 提供对用户上传的照片以及用户已标记的照片的访问权限

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:35:45.987

用户个人资料图片不需要`user_photos`权限。图片可能来自 facebook 缓存，您应该使用以下 url 获取图片。

```
http://graph.facebook.com/<facebook id>/picture 
```

# sencha-touch-2 - Sencha Touch 2 Store TypeError

> ID：11209398
> 
> 赞同：1
> 
> 时间：2012-06-26T14:18:37.713
> 
> 标签：sencha-touch-2

我正在关注 Sencha 网站上的视频，以创建我的第一个应用程序。

这是我正在关注的视频：[视频](http://player.vimeo.com/video/37974749 "视频")

这是我用于博客选项卡的代码：

```
Ext.define('GS.view.Blog',{
    extend: 'Ext.navigation.View',
    xtype: 'blogpanel',

    requires: [
        'Ext.dataview.List',
        'Ext.data.proxy.JsonP'
    ],

    config: {
        title: 'Blog',
        iconCls: 'star',

        items: {
            xtype: 'list',
            itemTpl: '{title}',

            store: {
                autoLoad: true,
                fields: ['title', 'author', 'content'],

                root: {
                    leaf: false
                },

                proxy: {
                    type: 'jsonp',
                    url: 'https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&q=http://feeds.feedburner.com/SenchaBlog',

                    reader: {
                        type: 'json',
                        rootProperty: 'responseData.feed.entries'
                    }
                }
            }
        }
    }
}); 
```

在 Safari 控制台中，它在 StoreManager.js:97 上给了我以下错误：

```
TypeError: 'undefined' is not a valid argument for 'instanceof' (evaluating 'store instanceof Ext.data.Store') 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:28:36.127

在行添加此代码`store:`

```
 store: new Ext.create('Ext.data.Store',{
            autoLoad: true,
            fields: ['title', 'author', 'content'],

            root: {
                leaf: false
            },

            proxy: {
                type: 'jsonp',
                url: 'https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&q=http://feeds.feedburner.com/SenchaBlog',

                reader: {
                    type: 'json',
                    rootProperty: 'responseData.feed.entries'
                }
            }
        }) 
```

# python - 在 Python 中使用成本生成树

> ID：11209402
> 
> 赞同：1
> 
> 时间：2012-06-26T14:18:47.543
> 
> 标签：python, graph, tree

最近，我尝试在 C++ 中从图形边缘生成树，但这会导致过多的 if 条件或 for 循环。我将注意力转向 python，它似乎在用最少的复杂代码生成树。我是 python 新手，这就是我寻求帮助的原因。论坛上已经发布了类似的问题，但它们并没有解决我试图解决的相同问题。所以问题是我有一些图边，比如 1---->2，成本为 10；1--->3 成本为 20 等。如果“1”是根节点，我想生成多个可能的树以及它们的成本。我想我的代码看起来像；

```
class Edge:
    def __init__(v1, v2, v3):
        self.v1 = v1
        self.v2 = v2
        self.v3 = v3
graph = [Edge(1, 2, 10), Edge(2, 4, 20)] 
```

这是我应该得到的；

```
map = {}
map[1] = [Edge(1, 2)] Cost: 10
map[2] = [Edge(1, 2), Edge(2, 4)] Cost: 30 
```

如果 2 是根节点；

```
map = {}
map[1] = [Edge(2, 4)] Cost: 20 
```

如果有人可以帮助我，我会很高兴，因为过去 5 天我一直被这个问题困扰，似乎无法找到解决方案。虽然，我查看了 networkx 模块，但不知道如何使用它们的 API。:(

编辑：总而言之，给定一个森林，我如何生成多个独特的“树”？

# php - 过滤并发送联系人数据库

> ID：11209405
> 
> 赞同：0
> 
> 时间：2012-06-26T14:18:54.383
> 
> 标签：php, mysql, database, email

我有一个将电子邮件发送到联系人列表的脚本。我想在每次发送时过滤大列表，并想知道存储临时列表的最佳方式是什么？

我正在考虑创建一个包含过滤结果的临时表，然后将其放在脚本末尾。有没有更简单的方法来存储结果？

联系人列表数以千计。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:47:13.417

我同意使用临时表，但也建议独立视图。

如果您经常过滤表并需要创建许多临时表，为什么不创建多个视图，其中仅包含您希望的标准的结果，并基于此发送邮件。

这将避免创建和删除表的需要，但只有在您多次使用相同的过滤器时才会使您受益。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:23:02.080

临时表可以正常工作。除非您非常缺乏硬件，或者正在执行大量复杂的连接，否则数千条记录对 MySQL 来说毫无意义。

# android - Android ListFragment 列表视图在方向更改时重叠

> ID：11209412
> 
> 赞同：6
> 
> 时间：2012-06-26T14:19:24.430
> 
> 标签：android, android-listfragment

我正在使用 ListFragment 并从 Android 兼容性包中实现 LoaderManager.LoaderCallbacks 以在应用程序中显示列表视图。列表显示正常，但是当方向改变时，列表视图不正确（我认为视图与前一个重叠）

图片在这里：[列表视图在方向改变后](http://tinypic.com/r/2vablnr/6)

有没有人遇到过同样的问题？您能否让我知道可能是什么问题，或者是否需要提供更多详细信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-02T06:25:41.033

我发现了错误。这是由于每次创建活动时都会创建列表片段，即使是由于配置更改。但默认情况下，android 在配置更改期间重新创建活动期间保留片段。

这样做解决了我的问题。仅当 savedInstanceState 为空时才创建片段。

```
if(savedInstanceState == null) {
// Initialize fragment here.
} 
```

# ruby-on-rails - 没有资产管道的 gmaps4rails

> ID：11209413
> 
> 赞同：0
> 
> 时间：2012-06-26T14:19:27.137
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, gmaps4rails

我正在使用 Rails 3.2.3 和 Ruby 1.9.3 以及最新版本的 gmaps4rails。我一生都无法获得要显示的地图。我不断收到 JS 错误，指出未定义 gmap。我按照 gmaps4rails 文档无济于事。

我认为我的主要问题是我没有 gmap .js 文件，只有 .js.coffee 文件。我应该将咖啡脚本文件转换为 js 文件吗？

任何帮助将不胜感激。我已经花了 4 个小时试图让它工作：[

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:35:29.940

gmaps4rails gem 并不关心您是否启用了资产管道。看看生成器：[https ://github.com/apneadiving/Google-Maps-for-Rails/blob/master/lib/generators/gmaps4rails/install_generator.rb#L8](https://github.com/apneadiving/Google-Maps-for-Rails/blob/master/lib/generators/gmaps4rails/install_generator.rb#L8)

一个快速的解决方法是手动复制 js 文件。

```
mkdir public/javascripts/gmaps4rails
cp `bundle show gmaps4rails`/public/javascripts/gmaps4rails/*.js public/javascripts/gmaps4rails 
```

QnD，但应该让你去:-)

编辑：当然这同样适用于 css 文件

```
cp `bundle show gmaps4rails`/public/stylesheets/gmaps4rails.css public/stylesheets/ 
```

# php - 从实体对象symfony 2调用学说

> ID：11209416
> 
> 赞同：3
> 
> 时间：2012-06-26T14:19:31.817
> 
> 标签：php, symfony

我正在研究 symfony 2 框架。在我的示例应用程序中，我有 Blog 实体和 BlogEntry 实体。它们与一对多的关系相连。这是 BlogEntry 类：

```
class BlogEntry
{
    ....
    private $blog;
    ....
    public function getBlog()
    {
        return $this->blog;
    }

    public function setBlog(Blog $blog)
    {
        $this->blog = $blog;
    }
} 
```

我想将方法​​ setBlogByBlogId 添加到 BlogEntry 类，我是这样看的：

```
public function setBlogByBlogId($blogId)
    {
        if ($blogId && $blog = $this->getDoctrine()->getEntityManager()->getRepository('AppBlogBundle:Blog')->find($blogId))
        {
            $this->setBlog($blog);
        }
        else
        {
            throw \Exception();
        }
    } 
```

这是在模型课上获得学说的任何方法吗？从 Symfony 2 MVC 架构的角度来看，这是否正确？或者我应该在我的控制器中执行此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T16:56:50.273

在尝试在 BlogEntry 实体上设置博客对象之前，您应该使用 blogId 查询存储库中的博客对象。

一旦你有了 blog 对象，你可以简单地在你的 BlogEntry 实体上调用 setBlog($blog)。

您可以在控制器中执行此操作，也可以创建一个博客服务（博客管理器）来为您执行此操作。我建议在服务中这样做：

在 Your/Bundle/Resources/config/services.yml 中定义您的服务：

```
services
    service.blog:
    class: Your\Bundle\Service\BlogService
    arguments: [@doctrine.orm.default_entity_manager] 
```

你的/Bundle/Service/BlogService.php：

```
class BlogService
{

    private $entityManager;

    /*
     * @param EntityManager $entityManager
     */
    public function __construct($entityManager)
    {
        $this->entityManager = $entityManager;
    }

    /*
     * @param integer $blogId
     *
     * @return Blog
     */
    public function getBlogById($blogId)

        return $this->entityManager
                    ->getRepository('AppBlogBundle:Blog')
                    ->find($blogId);
    }
} 
```

然后在你的控制器中你可以简单地去：

```
$blogId = //however you get your blogId
$blogEntry = //however you get your blogEntry

$blogService = $this->get('service.blog');
$blog = $blogService->getBlogById($blogId);

$blogEntry->setBlog($blog); 
```

# concurrency - 没有中央控制点的冗余？

> ID：11209422
> 
> 赞同：3
> 
> 时间：2012-06-26T14:19:39.930
> 
> 标签：concurrency, erlang, distribution

如果有可能向多个客户端提供服务，如果提供此服务的服务器出现故障，另一个服务器将取代它——没有某种集中的“控制”来检测主服务器是否已出现故障并将客户端重定向到新服务器？

没有集中的接口/网关可以吗？

换句话说，这有点像问你能否设计一个节点平衡器而无需集中控制直接客户端？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T14:58:14.367

好吧，您没有提供有关您所询问的“服务”的太多信息，所以我将以*通用*的方式回答。

对于我回答的第一部分，我假设您正在谈论一个涉及 IP 地址的“集中式接口/网关”。为此，有引用自[wiki](http://en.wikipedia.org/wiki/Common_Address_Redundancy_Protocol)的 CARP（通用地址冗余协议） ：

> 通用地址冗余协议或 CARP 是一种允许同一本地网络上的多个主机共享一组 IP 地址的协议。它的主要目的是提供故障转移冗余，尤其是在与防火墙和路由器一起使用时。在某些配置中，CARP 还可以提供负载平衡功能。它是思科 HSRP 的免费、无专利保护的替代方案。CARP 主要在 BSD 操作系统中实现。

引用 netbsd 的“ [CARP 简介](http://www.netbsd.org/docs/guide/en/chap-carp.html)”：

> CARP 的工作原理是允许同一网段上的一组主机共享一个 IP 地址。这组主机称为“冗余组”。为冗余组分配了一个在组成员之间共享的 IP 地址。在该组中，一台主机被指定为“主”，其余主机被指定为“备份”。主控主机是当前“持有”共享 IP 的主机；它响应指向它的任何流量或 ARP 请求。每台主机一次可能属于多个冗余组。

这可能会在网络级别解决您的问题，让从属按顺序接管 IP 地址，而不会出现单点故障。

现在，对于答案的第二部分（应用程序级别），使用分布式 erlang，您可以拥有多个节点（一个集群），这将为您提供容错和冗余（因此您不会在这里使用 ip 地址，而是“分布式 erlang “ - 一个 erlang 节点集群 - 代替）。

[启动分布式](http://www.erlang.org/doc/design_principles/distributed_applications.html)应用程序时，您将有很多节点，并且您的应用程序资源文件将包含可以运行应用程序的节点列表（有序）。

[分布式 erlang](http://www.erlang.org/doc/reference_manual/distributed.html)将控制哪些节点是“主节点”，并在不同节点上下移动时自动启动和停止您的应用程序。

[从http://www.erlang.org/doc/design_principles/distributed_applications.html](http://www.erlang.org/doc/design_principles/distributed_applications.html)引用（尽可能少）：

> 在具有多个 Erlang 节点的分布式系统中，可能需要以分布式方式控制应用程序。如果运行某个应用程序的节点出现故障，则应在另一个节点重新启动该应用程序。
> 
> 应用程序将在由分布式配置参数指定的第一个节点启动，该节点已启动并正在运行。应用程序照常启动。
> 
> 为了使应用程序控制的分发正常工作，分布式应用程序可能运行的节点必须相互联系并协商从何处启动应用程序。
> 
> 启动时，节点将等待由sync_nodes_mandatory 和sync_nodes_optional 指定的所有节点出现。当所有节点都启动时，或者当所有强制节点都启动并且经过了 sync_nodes_timeout 指定的时间时，将启动所有应用程序。如果不是所有强制节点都出现了，则该节点将终止。
> 
> 如果运行应用程序的节点出现故障，则应用程序在第一个节点处重新启动（在指定的超时后），由分布式配置参数指定，该节点已启动并运行。这称为故障转移

分布式 = [{应用程序，[超时，] NodeDesc}]

> 如果启动了一个节点，根据分布式优先级高于当前运行分布式应用程序的节点，应用程序将在新节点重新启动并在旧节点停止。这称为接管。

好的，这只是一个总体概述，因为它可能是一个很长的话题:)

具体细节，强烈推荐阅读[learnyousomeerlang的](http://learnyousomeerlang.com)[分布式OTP应用](http://learnyousomeerlang.com/distributed-otp-applications)章节（当然还有之前的链接： [http](http://www.erlang.org/doc/design_principles/distributed_applications.html) ://www.erlang.org/doc/design_principles/distributed_applications.html ）

此外，您的“服务”可能依赖于其他外部系统，例如数据库，因此您也应该考虑那里的容错和冗余。整个架构需要容错和分布式，以便“服务”以这种方式工作。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-26T14:59:17.497

这个答案是对网络应用程序高可用性的一般概述，而不是特定于 Erlang。我还不太了解 OTP 框架中可用的内容，因为我是该语言的新手。

* * *

这里有几个不同的问题：

1.  客户端连接必须移动到备份机器
2.  会话可能包含状态数据
3.  如何检测崩溃

**问题 1 - 移动客户端连接**
这可以通过许多不同的方式在网络架构的不同层上解决。最简单的方法是将其直接编码到客户端中，这样当连接丢失时，它会重新连接到另一台机器。

如果您需要网络透明性，您可以使用一些技术在不同机器之间同步 TCP 状态，然后将所有流量重新路由到新机器，这可能对客户端*完全*不可见。这比第一个建议更难做到。

我敢肯定在这两者之间有很多事情要做。

**问题 2 - 状态数据**
您显然需要将会话状态从崩溃的机器转移到备份机器。这真的很难以可靠的方式完成，您可能会丢失最后几笔交易，因为崩溃的机器可能无法发送崩溃前的最后一个状态。您可以通过这种方式使用同步调用来确保*不会*丢失状态：

1.  事务/消息从客户端进入主机。
2.  主机更新一些状态。
3.  新状态被发送到备份机器。
4.  备份机确认新状态的到来。
5.  主机向客户端确认成功。

在某些情况下，这可能会很昂贵（或至少响应不够快），因为您甚至在向客户端确认任何内容之前都依赖于备份机器及其连接，包括延迟。为了使其性能更好，您可以让客户端在连接时与备份机器检查它接收到的事务，然后重新发送丢失的事务，使客户端有责任将工作排队。

**问题 3 - 检测崩溃**
这是一个有趣的问题，因为崩溃并不总是明确定义的。真的有什么东西崩溃了吗？考虑一个网络程序，它关闭了客户端和服务器之间的连接，但两者仍处于启动状态并连接到网络。或者更糟糕的是，使客户端在服务器没有注意到的情况下与服务器断开连接。以下是一些需要思考的问题：

*   客户端应该连接到备份机器吗？
*   如果主服务器更新某些状态并将其发送到备份机器，而备份连接了真正的客户端 - 会不会出现数据竞争？
*   主计算机和备用计算机是否可以同时启动，或者您是否需要关闭其中一台计算机并移动所有会话？
*   在这件事上你是否需要某种权威，某种协议来决定哪个是*主设备*，哪个是*从设备*？那个权威是谁？你如何去中心化它？
*   如果您的节点失去了它们之间的连接但两者都继续按预期工作（称为*网络分区*）怎么办？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T12:51:48.563

请参阅 Google 的论文[“Chubby lock server”（PDF）](http://static.googleusercontent.com/external_content/untrusted_dlcp/research.google.com/en//archive/chubby-osdi06.pdf)和[“Paxos made live”（PDF）](http://www.eecs.harvard.edu/cs262/Readings/paxosmadelive.pdf)来了解一下。

简而言之，该解决方案涉及使用共识协议在处理所有请求的一组服务器中选举一个主服务器。如果主节点失败，则再次使用该协议来选举下一个主节点。

此外，请参阅[gen_leader](https://github.com/abecciu/gen_leader_revival)以获取领导者选举中的示例，该示例可用于检测故障和转移服务所有权。

# c# - 在安装过程中选择 ClickOnce 应用程序的安装路径

> ID：11209427
> 
> 赞同：3
> 
> 时间：2012-06-26T14:19:48.073
> 
> 标签：c#, .net, oneclick

我可以在安装期间询问用户在哪里安装应用程序吗？大多数设置都会提示用户在哪里安装应用程序，我相信您对它很熟悉。我如何使用 Visual Studio 发布者做到这一点？（如果无法从 VS 发布者处完成，您能否推荐一个可以做到的程序？还是我必须手动完成？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T14:24:19.493

根据[此](http://social.msdn.microsoft.com/Forums/en/winformssetup/thread/84b5ed72-2406-4518-97e7-f7c6cf7132a7)MSDN 帖子：“ClickOnce 应用程序是按用户安装在用户应用程序缓存中的。这些应用程序由 ClickOnce 服务管理。如果您想安装到用户指定的位置，例如 Program Files……您应该使用 MSI 或其他一些安装技术。”

[此处](http://msdn.microsoft.com/en-us/library/wx3b589t.aspx)讨论了 Visual Studio 支持的其他部署方法

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T14:25:06.993

不，你不能。ClickOnce 将应用程序安装在用户的 AppData 文件夹中，它不像传统应用程序那样安装。如果您想更好地控制此类内容，则需要编写自己的安装程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T14:25:11.240

不确定它是否已更改，但 ClickOnce 应用程序是按用户安装在用户应用程序缓存中的。你不能改变那个位置。这意味着如果 2 个不同的用户共享同一台机器，则您的应用程序有 2 个不同的副本。

# java - 如果我这样做，在 android 中创建的文件在哪里

> ID：11209429
> 
> 赞同：0
> 
> 时间：2012-06-26T14:19:55.083
> 
> 标签：java, android

此函数创建一个文件，但我不知道该文件在哪里创建，如果有人有解决方案从外部存储在特定目录中创建文件，非常欢迎:) 非常感谢

```
private void writeFileToInternalStorage() {
    String eol = System.getProperty("line.separator");
    BufferedWriter writer = null;
    try {
      writer = new BufferedWriter(new OutputStreamWriter(openFileOutput("myfile", MODE_WORLD_WRITEABLE)));
      writer.write("This is a test1." + eol);
      writer.write("This is a test2." + eol);
    } catch (Exception e) {
            e.printStackTrace();
    } finally {
      if (writer != null) {
        try {
            writer.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
      }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:22:12.083

`openFileOutput`始终在本地项目目录中创建文件，即与返回的文件相同 `getFilesDir()`

您的文件将创建于 `/data/data/your.package.name/`

要写入外部存储，您需要执行类似的操作。

```
File sdCard = Environment.getExternalStorageDirectory();
File dir = new File (sdcard.getAbsolutePath() + "/MyDir");
dir.mkdirs();
File file = new File(dir, "filename");

FileOutputStream f = new FileOutputStream(file);
... 
```

最后别忘了包括

`<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>`

在清单中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:25:06.123

它将在内部文件夹上创建：`/data/data/com.package.name/`您无法使用文件浏览器访问该文件夹。

如果您想轻松访问该文件，您可以尝试在 SD 卡上创建它：

```
/*...*/
String baseDir = Environment.getExternalStorageDirectory().getAbsolutePath();
String fileName = baseDir + "/"+ "myFile.txt";
FileOutputStream writer = null;
try {
    writer = new FileOutputStream(fileName);
    writer.write("This is a test1." + eol);
    /*...*/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:25:13.987

查询

*   将在哪里创建文件

它将按照函数名称在内部存储中创建，就像 /data/data/yourApp_package_as_in_manifest/ （可以在 DDMS 中看到）

查询

*   如果有人有从外部存储在特定目录中创建文件的解决方案，非常欢迎

根据链接[在Android的外部存储中写入文件](https://stackoverflow.com/questions/8330276/write-a-file-in-external-storage-in-android) ............

```
** Method to check whether external media available and writable. This is adapted from
       http://developer.android.com/guide/topics/data/data-storage.html#filesExternal */

     private void checkExternalMedia(){
          boolean mExternalStorageAvailable = false;
        boolean mExternalStorageWriteable = false;
        String state = Environment.getExternalStorageState();

        if (Environment.MEDIA_MOUNTED.equals(state)) {
            // Can read and write the media
            mExternalStorageAvailable = mExternalStorageWriteable = true;
        } else if (Environment.MEDIA_MOUNTED_READ_ONLY.equals(state)) {
            // Can only read the media
            mExternalStorageAvailable = true;
            mExternalStorageWriteable = false;
        } else {
            // Can't read or write
            mExternalStorageAvailable = mExternalStorageWriteable = false;
        }   
        tv.append("\n\nExternal Media: readable="
                +mExternalStorageAvailable+" writable="+mExternalStorageWriteable);
    }

    /** Method to write ascii text characters to file on SD card. Note that you must add a 
       WRITE_EXTERNAL_STORAGE permission to the manifest file or this method will throw
       a FileNotFound Exception because you won't have write permission. */

    private void writeToSDFile(){

        // Find the root of the external storage.
        // See http://developer.android.com/guide/topics/data/data-  storage.html#filesExternal

        File root = android.os.Environment.getExternalStorageDirectory(); 
        tv.append("\nExternal file system root: "+root);

        // See https://stackoverflow.com/questions/3551821/android-write-to-sd-card-folder

        File dir = new File (root.getAbsolutePath() + "/download");
        dir.mkdirs();
        File file = new File(dir, "myData.txt");

        try {
            FileOutputStream f = new FileOutputStream(file);
            PrintWriter pw = new PrintWriter(f);
            pw.println("Hi , How are you");
            pw.println("Hello");
            pw.flush();
            pw.close();
            f.close();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
            Log.i(TAG, "******* File not found. Did you" +
                    " add a WRITE_EXTERNAL_STORAGE permission to the   manifest?");
        } catch (IOException e) {
            e.printStackTrace();
        }   
        tv.append("\n\nFile written to "+file);
    } 
```

并向清单添加 WRITE_EXTERNAL_STORAGE 权限

# mysql - innodb如何恢复事务？

> ID：11209433
> 
> 赞同：2
> 
> 时间：2012-06-26T14:20:04.890
> 
> 标签：mysql, transactions, innodb

我最近正在阅读 InnoDB 代码，需要在上面写一些代码。我知道在 S2PL 中，冲突的事务完成后将恢复被阻止的事务。但是，我不确定 InnoDB 如何在块后恢复事务，是否有处理此类工作的线程？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T16:20:20.300

当需要锁但无法授予时，锁会进入页面级别的锁队列。当任何锁被释放时，释放事务会搜索队列并从队列中授予下一个新的非冲突锁。请参阅MySQL 源代码中的`lock_rec_enqueue_waiting`、`lock_rec_dequeue_from_page`、`lock_grant`等。`storage/innobase/lock/lock0lock.c`

# python - Sifting a list returned from a webscrape produced with Beautiful Soup

> ID：11209434
> 
> 赞同：0
> 
> 时间：2012-06-26T14:20:05.053
> 
> 标签：python, python-2.7, web-scraping, beautifulsoup

I am using python to code. I have been trying to webscrape the names, team images, and colleges of nba draft prospects.However when I scrape for the name of the colleges I get both the college page and the college name. How do I get it so that I only see the colleges? I have tried adding .string and .text to the end of anchor (anchor.string).

```
import urllib2
from BeautifulSoup import BeautifulSoup
# or if your're using BeautifulSoup4:
# from bs4 import BeautifulSoup

list = []
soup = BeautifulSoup(urllib2.urlopen(
                            'http://www.cbssports.com/nba/draft/mock-draft'
                             ).read()
                     )

rows = soup.findAll("table",
                    attrs = {'class':'data borderTop'})[0].tbody.findAll("tr")[2:]

for row in rows:
  fields = row.findAll("td")
  if len(fields) >= 3:
    anchor = row.findAll("td")[2].findAll("a")[1:]
    if anchor:
      print anchor 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:37:34.547

Instead of just:

```
print anchor 
```

use:

```
print anchor[0].text 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-26T14:32:25.520

The format of an anchor in html is `<a href='web_address'>Text-that-is-displayed</a>` so unless there's already a fancy html parser library (I'd bet there is, just don't know of any), you'll likely need to use some kind of regular expressions to parse out the part of the anchor that you want.

# image - 如何为图片创建点赞按钮？

> ID：11209438
> 
> 赞同：1
> 
> 时间：2012-06-26T14:20:12.300
> 
> 标签：image, facebook, facebook-like, gallery

我正在尝试为网络画廊创建一个赞按钮，在每张图片下方创建一个 Facebook 赞按钮。我确实在某个地方获得了一个赞按钮，但是当用户单击赞按钮来分享它时，它会显示一个指向画廊图片的文本链接，而不是图像的缩略图。当用户单击“赞”按钮时，如何获得“赞”按钮以显示画廊图像的缩略图？

提前致谢。

# html - 有没有小数像素之类的东西？

> ID：11209439
> 
> 赞同：0
> 
> 时间：2012-06-26T14:20:13.173
> 
> 标签：html, css

我刚开始帮助一些工作同事进行一些网页设计。没什么大不了的，但是我对应该填充分配的 div 区域的样式菜单元素有问题，我注意到虽然我可以通过在其中添加小数点来调整 ff 中的宽度设置，但我注意到在铬中，最后一个样式之间的差距元素和 div 边框很大。我检查了尺寸并意识到铬以四舍五入的整数值显示尺寸（S）。有人知道这是为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:22:49.777

没有*小数*像素之类的东西。像素是最小的屏幕单位。

您遇到的事情是由于浏览器数学引擎而发生的。其中一些将十进制像素部分向上舍入到下一个整数，其中一些将其向下取整。

为避免这种情况，只需定义不带小数点的像素。如果您想让 2 个元素在**视觉上**更接近，您可以使用颜色，例如 - 如果您为某些元素提供更暗的边框，它们似乎更接近 - [http://jsfiddle.net/fDbUj/](http://jsfiddle.net/fDbUj/)

# asp.net-mvc - 无法让 Razor if 语句正常工作

> ID：11209440
> 
> 赞同：2
> 
> 时间：2012-06-26T14:20:12.910
> 
> 标签：asp.net-mvc, razor

我有以下简单的代码：

```
@for (int j = 0; j < file.Items.Count; j++) {
var item = file.Items[j];
if (item.Errors.Count > 0)
{
    Html.Raw("<tr class='errors'>");
}
else {
    Html.Raw("<tr>");
}
    <td>blah</td>
    </tr>
} 
```

但是，我不断收到一个解析错误，说结束`</tr>`没有开始标签。我错过了什么？如果我用常规替换 if 语句，`<tr>`那么它工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:27:27.963

我相信这只是一个智能感知问题，试试这个黑客：

```
@for (int j = 0; j < file.Items.Count; j++) {
   var item = file.Items[j];
   if (item.Errors.Count > 0)
   {
       @:<tr class="errors">
   }
   else {
       @:"<tr>");
   }
       @:<td>blah</td>
       @:</tr>
 } 
```

我认为您的代码完全可以，请查看[这个](https://stackoverflow.com/questions/4781896/razor-view-engine-complex-looping-and-html)SO question 以获得很好的解释。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:26:18.433

在这两种情况下都尝试丢失 Html.Raw。我不明白你为什么需要它们

# iphone - 如何使用侧面的处理程序创建可调整大小的视图以在 ios 中拉伸或调整大小？

> ID：11209445
> 
> 赞同：0
> 
> 时间：2012-06-26T14:20:23.153
> 
> 标签：iphone, objective-c, ios4, uiview, uitouch

我正在创建一个应用程序，用户在其中触摸屏幕并在屏幕上放置一个矩形视图，他可以像任何其他裁剪视图一样通过触摸其角来移动或调整大小。我已经完成了这个功能，但我想要在那个矩形的边上有八个处理程序，以便用户可以使用这些处理程序来调整它的大小。现在我无法创建这样的功能。我尝试在该矩形视图上添加八个按钮作为子视图，但是当该视图增加其大小时调整大小时，所有八个按钮都会更改它们的位置。任何人都可以帮助我使用此功能吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T16:00:11.913

嗨，我从这里得到了答案。这是一个制作可调整大小视图的好课。开发人员的出色工作

[使用 UITouch 在 ios 中创建可调整大小的视图](https://stackoverflow.com/questions/8906700/changing-view-size-using-user-touch-input)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:52:24.413

要做到这一点，你就走对了。

您需要创建一个自定义视图，根据视图的大小定位这八个手柄。当视图改变大小时，您需要重新评估这些句柄的位置，因此可能有一个在调整视图大小时调用的函数，在这里您只需根据视图大小更改其 x 和 y 原点即可更改每个句柄的位置。

# java - 在 Java 中获取 HTTP 响应代码

> ID：11209449
> 
> 赞同：0
> 
> 时间：2012-06-26T14:20:38.547
> 
> 标签：java, html, response

我需要在 java 中找到 URL 的 HTTP 响应代码。我知道这可以使用 URL 和 HTTPURLConnection API 来完成，并且已经解决了之前的问题，例如[this](https://stackoverflow.com/questions/6467848/how-to-get-http-response-code-for-a-url-in-java) 和[this](https://stackoverflow.com/questions/4946598/java-http-response-code-url-ioexception)。

我需要在大约 2000 个链接上执行此操作，因此速度是最需要的属性，其中我已经使用[crawler4j](http://code.google.com/p/crawler4j/)抓取了 150-250 个页面并且不知道从该库获取代码的方法（因此我将不得不在这些链接上再次与另一个库建立连接以查找响应代码）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:36:23.050

在 Crawler4J 中，WebCrawler 类有一个方法 handlePageStatusCode，这正是您要查找的内容，如果您已经查找过，您也会找到。覆盖它并快乐。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:26:48.353

第一个链接背后的答案包含您需要的一切： [如何在 Java 中获取 URL 的 HTTP 响应代码？](https://stackoverflow.com/questions/6467848/how-to-get-http-response-code-for-a-url-in-java)

```
 URL url = new URL("http://google.com");
    HttpURLConnection connection = (HttpURLConnection)url.openConnection();
    connection.setRequestMethod("GET");
    connection.connect();

    int code = connection.getResponseCode(); 
```

响应码是服务器返回的 HTTP 码。

# android - android将视图放置在图像上方的特定位置

> ID：11209450
> 
> 赞同：0
> 
> 时间：2012-06-26T14:20:43.983
> 
> 标签：android, xml, image, android-layout, android-relativelayout

我想创建一个包含图像的布局，我想在其上放置许多图像和 TextView。我知道如何使用 RelativeLayout 将图像放在另一个之上，但是如何以所需的方式对齐它们？例如，我希望图像恰好位于我的“背景”图像具有特定黑色圆圈的位置。使用 android:layout_marginTop 等值似乎并不能在每个屏幕上产生效果。

那么处理这些问题的正确方法是什么？

编辑：我无法上传图像，但我在这里上传了我想要的非常简单的草图：http: [//imageshack.us/photo/my-images/715/buttonlayout.png/](http://imageshack.us/photo/my-images/715/buttonlayout.png/) 所有按钮也有图标和文本（这必须是一个文本视图，以便我可以在需要时以编程方式更改它）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:36:31.980

您必须创建一个自定义布局，将图像专门放置在您想要它们相对于父视图大小的位置。如果您选择，您可以覆盖`LayoutParams`并应用自定义属性以供您的自定义视图读取。

无论如何，要专门放置一个项目，例如从顶部向下 30% 和从左侧向下 20%，您将覆盖`onLayout()`.

```
@Override
public void onLayout(boolean c, int left, int top, int right, int bottom) {
    super.onLayout(c, left, top, right, bottom);

    int width = right - left;
    int height = bottom - top;

    View v = getTheChildView();
    int viewL = left + (int)(width * .2f); // The left pixel is 20% down the total width of the parent view
    int viewR = viewL + v.getWidth(); // The right pixel is the left pixel plus the measured width of the child view itself
    int viewT = top + (int)(height * .3f); // The top pixel is 30% down the total height of the parent view
    int viewB = top + v.getHeight(); // The bottom pixel is the top pixel plus the measured height of the child view itself   
    v.layout(viewL, viewT, viewR, viewB);
} 
```

# android - 谷歌地理定位是否仅在移动时向服务器发出请求？

> ID：11209453
> 
> 赞同：0
> 
> 时间：2012-06-26T14:20:53.143
> 
> 标签：android, geolocation, maps

有谁知道谷歌地理定位功能/api是否向服务器发出实际请求，即使它检测到您没有移动？例如，如果 wifi 热点及其优势自上次位置以来没有改变，他们可以假设您没有移动，因此无需访问 google 的服务器！他们在客户端有这种逻辑性能吗？我对 Android google maps api 更感兴趣。

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T15:13:56.947

比这更好：网络位置 API 将数据缓存在您的手机上，因此即使您移动它也可能不需要发出请求。

在我的 Nexus One 上看到的日志示例：

```
D/androidNlpServiceThread(  194): adding listener com.google.android.location.internal.client.NetworkLocationClient$1@405575e8 with period 45
D/androidNetworkLocationListeners(  194): Still have listener com.google.android.location.internal.client.NetworkLocationClient$1@405575e8
D/androidNlpServiceThread(  194): adding listener com.google.android.location.internal.client.NetworkLocationClient$1@405575e8 with period 45
D/androidNetworkLocationListeners(  194): Still have listener com.google.android.location.internal.client.NetworkLocationClient$1@405575e8
D/WifiLocator(  194): Good cache hits. Computing WiFi location locally hasLocation=4 noLocation=0 cacheMiss=0
D/WifiLocator(  194): Computing location using MaxLre.
D/WifiLocator(  194): Finished computing WiFi location: WifiLocationResult [position=Position [redacted], confidence=78, outliers=[]]
D/CellLocator(  194): Found cell location: Position [redacted]
D/androidNlpServiceThread(  194): reporting Location[mProvider=network,mTime=1340791812841,mLatitude=****,mLongitude=****,mHasAltitude=false,mAltitude=0.0,mHasSpeed=false,mSpeed=0.0,mHasBearing=false,mBearing=0.0,mHasAccuracy=true,mAccuracy=42.0,mExtras=Bundle[{networkLocationSource=cached, networkLocationType=wifi}]]
D/ClientReporter(  194): reported location 
```

# database - 关于超文件数据库的建议

> ID：11209457
> 
> 赞同：5
> 
> 时间：2012-06-26T14:21:12.337
> 
> 标签：database, windev

在我的工作中，我的同事正在考虑使用超文件作为 Windev 项目的数据库服务器。我什至不知道那种数据库，它来自开发windev的公司PCSOFT。

由于windev 也可以与microsoft sql server 一起工作，我正在向已经使用过它的人寻求关于这种数据库（性能、稳定性等）的建议。

问候！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-31T10:53:09.413

这取决于您的项目的大小。实际上，Windev 与 HyperFileSQL 配合得很好。它是为它设计的！通过使用另一个 DBMS，您可以在表中削减一些功能，例如直接读取/修改/删除。

一旦表中有大量记录（> 100'000），您的性能就会显着下降。您的数据库管理将成为一场噩梦，因为您无法同时执行多个 SQL 请求。例如，我正在使用一个法国人开发的另一个工具来管理我的数据库并执行一些更新。

尽管如此，它还是稳定的，并提供了一种与 Windev 的字段交互的简单方法。

在我看来，Hyperfile SQL 应该用于具有少量特征和数据的小型应用程序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-05-10T18:23:01.027

加上 Samuël Tremblay 已经写过的内容，我想说的是，在将 Windev 与 HFSQL（旧名称是 HyperFile SQL）一起使用 2 年多之后，这是我的结论（我使用了 Windev 版本 20 和 22）：

**优点：**

*   将数据库复制到另一台服务器相当容易设置。您可以选择复制整个数据库或选择的表。但是像 PostgreSQL 这样的 DBMS 实际上提供了高级复制设置 ( [https://www.2ndquadrant.com/en/resources/pglogical/](https://www.2ndquadrant.com/en/resources/pglogical/) )。

*   轻松导出到查询/表的 Microsoft Excel 文件

*   通过图形用户界面 (GUI) 创建和更改数据库的架构/结构

**缺点：**

*   当您使用Windev提供的数据库服务器（即HFSQL）时，您必须使用*Windev*（即强加给您）。**您不能使用 Windev 以外的其他语言/框架与您的数据库进行交互，**您必须使用 Windev 来查询 HFSQL 数据库。如果您改用 PostgreSQL、mySQL/MariaDB 等 DBMS，您可以（并且将能够）使用其他语言查询数据库：C++、Java、JavaScript 等。假设您现在想打开数据到客户通过网络应用程序，您实际上将需要使用他们的其他软件*Webdev*从他们的软件套件中（并实际购买）。或者说，有一天，你想用 Qt 或其他方式为智能手机开发一个简单的应用程序。好吧，如果你的数据库运行在 HFSQL 上，那么你将无法查询你的数据库，除非你使用 Windev（实际上是你也需要购买的*Windev Mobile ）。*
*   UNIQUE 约束不适用于 NULL 的存在（包含 NULL 的两行将被视为违反 UNIQUE 约束）。
*   （几乎）每次更新“分析/分析”（基本上是数据库模式）时，您还需要更新二进制可执行文件。您将需要重新编译您的软件并将其再次分发给用户。比如你修改了一个表，增加了一个列，或者修改了一个列的类型，那么你就需要重新编译。用户拥有的可执行文件不会运行，它会说数据库上的“分析”（模式）的版本与可执行文件中的版本不同，并且会停止。砰！
*   HyperFile SQL (HFSQL) 服务器不是那么稳定，当执行没有那么多行的稍微高级的查询时，它会（经常）崩溃......
*   您不能创建脚本来查询 HFSQL 数据库：您必须使用 Windev 创建一个二进制可执行文件（一个新项目）。假设你想快速修改一些东西——>你需要重新编译（并随身携带一个 Windev IDE）。
*   假设您在旅途中，旅行时忘记带上带有 Windev 加密狗密钥（许可证加密 USB 密钥：如果您没有它，则无法运行 Windev）的计算机，您需要做一些在数据库上工作。PCSoft 提供了一个名为 HFSQL Control Center（一个 GUI 软件）的软件，可以与数据库进行交互，但遗憾的是无法从 Internet 上下载。您实际上是在购买Windev时获得的，您可以将其分发给您想要的人，但不能从PCSOFT网站下载。而如果你的数据库引擎是另一个引擎，比如 PostgreSQL 或 MariaDB，你可以简单地下载 PGAdmin 或同等的，然后你就可以与你的数据进行交互。
*   在我看来，HFSQL 不是真正的/真正的 DBMS，让我自己解释一下：您可以在分析中设置的约束（例如 UNIQUE）并不总是得到尊重。例如，在模式（分析）中添加 UNIQUE 约束并编译程序后，我看到如果我从可执行文件中将一些数据插入到表中，它会在应该发生的时候检测到违反 UNIQUE 约束的情况。但是，如果我通过 HFSQL 控制中心插入相同的数据集，则不会强制执行约束并且会插入重复项。
*   还有很多话要说...

**底线：**根据我自己的经验，我强烈鼓励任何想要开发“必须”使用 Windev 开发的可靠且可靠的软件（并且需要数据持久性）的人，不要使用他们的数据库 HFSQL。使用 PostgreSQL 或 MariaDB 等 RDBMS 会更好。今年夏天，我们实际上将把我们的数据库从 HFSQL 移植到 PostgreSQL。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-27T16:00:32.833

您应该仔细考虑将使用哪些 sql 函数。例如 deg2rad、rad2deg、... 无法正常工作。

此外，如果您想在移动设备（适用于 iOS 或 Android 的 Windev Mobile）上使用它，您应该使用 SQLLite。因为 HyperFile 使用大量内存，在移动设备上会出现问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-12-30T16:55:08.773

如果您想要一个免费的数据库，请使用 PostgreSQL，用于 PostgreSQL 的 Windev 连接器可以免费下载并安装在您的 Windev 上，作为 HFSQL 的替代品，它在使用通常的 hFunction 时会更强大，就像使用 HFSQL 一样，而且您将在网络上找到大量文档来做强大的事情。

HFSQL 实际上与旧的 ISAM DBASE 数据库相同，因此它需要重新索引以及类似于那些旧数据库系统时代的东西。

PostgreSQL 就像拥有一个免费的 Oracle 数据库，具有所有强大的功能和可靠性，为此我们放弃了 HFSQL，性能提高了十倍以及所有其他好处，同时保持我们的代码几乎相同，每天感觉就像我们从那里发现免费赠品和礼物自我们迁移以来的 ProsgreSQL :)

免费 VS 免费...您必须使用强大的网络文档和可提供帮助的人员。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-02T07:37:18.913

在 WinDev Mobile 18 及更高版本中，您可以在设备上使用 Hyperfile。我推荐它，因为它更快，而且 SQLLite 将 blob-size 限制为 1MB！

@Spek 手机上 HyperFile 的内存使用情况？你能给我任何价值观吗？我想如果你想做一个全功能的APP你不能忽视HyperFile的好处......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-03T15:32:17.783

仅供参考：Windev 版本 19 中的新增功能：Hyperfile SQL 是 ACID。

# c# - WCF 中的事件委托类比

> ID：11209463
> 
> 赞同：2
> 
> 时间：2012-06-26T14:21:42.767
> 
> 标签：c#, .net, wcf

我有实现 MVC 模式的 WinForms 应用程序，其中模型从视图（表单）异步运行（后台工作线程）。View 订阅了从 Model 引发的几个事件。

现在我需要将其转换为 WCF 应用程序，其中必须存在 event-eventHandler 概念。
起初，我想通过回调接口来实现这一点，但在我的例子中，模型中的一种方法引发了不止一种类型的事件，并且在定义服务合同时我受限于单个回调接口的使用。

这时我想到了在回调服务中指定不同类型的事件作为方法并在客户端实现它的想法。例如：

```
public interface ICallbacks
{
  [OperationContract(IsOneWay = true)]
  void EventHandler1();

  [OperationContract(IsOneWay = true)]
  void EventHandler2(string callbackValue);

  [OperationContract(IsOneWay = true)]
  void EventHandler3(string callbackValue);
} 
```

我应该接受这个解决方案还是有一些更好的选择（发布-订阅 wcf 模式）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:28:20.443

听起来你肯定想要这里的 pub/sub 架构。

从这篇 MSDN 文章中查看 Juval Lowy 的发布-订阅框架：http: [//msdn.microsoft.com/en-us/magazine/cc163537.aspx](http://msdn.microsoft.com/en-us/magazine/cc163537.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:35:21.273

您可以使用带有基本类型参​​数的单一方法来激活您的调用。然后在您的服务代码中，根据事件的类型跳转到特定的处理程序。

```
public class BaseEvent { }

public class MyFirstEvent : BaseEvent { }

public class MySecondEvent : BaseEvent { }

public class MyThirdEvent : BaseEvent { }

public interface ICallbacks
{
  [OperationContract(IsOneWay = true)]
  void EventHandler(BaseEvent myEvent);
}

public class MyService : ICallbacks
{
   public void EventHandler(BaseEvent myEvent)
   {
      //Now you can check for the concrete type of myEvent and jump to specific method.
      //e.g.: 
      if (myEvent is MyFirstEvent)
      {
         //Call your handler here.
      }

      //Another approach can be predefined dictionary map of your event handlers
      //You want to define this as static map in class scope, 
      //not necessarily within this method.
      Dictionary<Type, string> map = new Dictionary<Type, string>()
      {
         { typeof(MyFirstEvent), "MyFirstEventHandlerMethod" },
         { typeof(MySecondEvent), "MySecondEventHandlerMethod" }
         { typeof(MyThridEvent), "MyThirdEventHandlerMethod" }
      };

      //Get method name from the map and invoke it.
      var targetMethod = map[myEvent.GetType()];
      this.GetType().GetMethod(targetMethod).Invoke(myEvent);
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T15:26:01.983

使用双工不是一个好主意，除非您的应用程序至少在同一网络上运行在同一网络上，并且没有代理等可以干扰。您还将最终在发布者和订阅者之间实现紧密耦合。

# xaml - WinRT XAML 中的硬编码 PCH 名称

> ID：11209467
> 
> 赞同：2
> 
> 时间：2012-06-26T14:21:47.287
> 
> 标签：xaml, windows-runtime, c++-cx

WinRT 项目，C++/CX。编译我的 XAML 文件时，生成的代码文件包含

#包括“pch.h”

线。`stdafx.h`出于遗留代码的原因，我希望以不同的方式调用我的预编译器标头。在项目属性中更改它会影响 C++ 源代码，但不会影响 XAML 编译器 - 它仍然会发出该`pch.h`行。我在项目属性的任何地方都找不到 XAML 编译器设置。

请问如何更改 XAML 编译器假定的 PCH 名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T17:48:47.723

预编译头文件的名称在 Visual Studio 2012 的 XAML 编译器中不可配置。假定为**pch.h**，这是所有项目模板中文件的默认名称。

可以调整构建目标文件以禁用 XAML 生成的 C++ 源文件的预编译头文件；我对目标不是很熟悉，所以我不能肯定。或者，您可以为您的项目禁用预编译头文件的使用，然后为项目中所有未生成的 C++ 源文件启用每个文件的使用。

如果此功能对您很重要，请考虑在[Microsoft Connect](http://connect.microsoft.com/VisualStudio)上打开一个问题。

# python - Entry小部件Tkinter中的回调问题

> ID：11209469
> 
> 赞同：0
> 
> 时间：2012-06-26T14:21:49.060
> 
> 标签：python, tkinter, tkinter-entry

我有以下代码（仅部分代码）用于获取我创建的 4 个条目框中的条目。但是我有两个小问题：

*   当我在每个框中输入时，它会输入相同的内容，我希望输入不同的数字并将它们全部分配给单独的变量。

*   有没有办法在一个循环中产生 4 个盒子并且比这更少的行？

    number = StringVar() def numberwritten(*args): number.trace("w", numberwritten) fg = number.get() print fg

    # 在单独的定义中 def ChoiceBox(choice): (不是这个 def 下的完整代码)

    def 选择框（选择）：i = [0, 1, 2, 3]

    ```
     for i in i:
            choice_title = Label(choice_frame, text='Value %g'% float(i+1), bg='white', borderwidth=0, width=0)
            choice_title.grid(row=0, column=column+i, sticky="nsew", padx=1, pady=1)

        box1 = Entry(choice_frame, bg='white', borderwidth=0, width=0, textvariable=number)
        box1.grid(row=1, column=0, sticky="ew", padx=1, pady=1)
        box2 = Entry(choice_frame, bg='white', borderwidth=0, width=0, textvariable=number)
        box2.grid(row=1, column=1, sticky="ew", padx=1, pady=1)
        box3 = Entry(choice_frame, bg='white', borderwidth=0, width=0, textvariable=number)
        box3.grid(row=1, column=2, sticky="ew", padx=1, pady=1)
        box4 = Entry(choice_frame, bg='white', borderwidth=0, width=0, textvariable=number)
        box4.grid(row=1, column=3, sticky="ew", padx=1, pady=1) 
    ```

更新/编辑：

这是我拥有的代码部分，由于我收到语法错误，因此无法弄清楚它最后出了什么问题：

```
def numberwritten(number):
    fg = number.get()
    print fg

numbers = [StringVar() for i in xrange(4) ] #Name available in global scope. 
for i in numbers: 
    i.trace('w',lambda n=i: numberwritten(n) ) 

def ChoiceBox(choice):

    column = 0
    if choice == "Fixed":
        choice_frame.grid_forget()      
    tkMessageBox.showinfo("Message", "No optimisation, value fixed.")
    elif choice == "List":

        for i in xrange(4): 
            choice_title = Label(choice_frame, text='Value %g'% float(i+1), bg='white', borderwidth=0, width=0) 
        choice_title.grid(row=0, column=column+i, sticky="nsew", padx=1, pady=1) 
        boxes=[] 

        tkMessageBox.showinfo("Message", "Please fill in list values.")

    elif choice == "Interval" or "Optimisation":
        i = [0, 1]
        choice_title1 = Label(choice_frame, text='Min Value', bg='white', borderwidth=0, width=0)
        choice_title1.grid(row=0, column=column, sticky="N S E W", padx=1, pady=1)
        choice_title2 = Label(choice_frame, text='Max Value', bg='white', borderwidth=0, width=0)
        choice_title2.grid(row=0, column=column+1, sticky="nsew", padx=1, pady=1)

        boxes=[]

        tkMessageBox.showinfo("Message", "Enter Min/Max values.")

for i in xrange(4): 
        box=Entry(choice_frame,bg='white',borderwidth=0,textvariable=numbers[i]) 
        box.grid(row=1,column=i, sticky='ew', padx=1, pady=1 
        boxes.append(box)
    box1,box2,box3,box4=boxes 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:46:55.187

这`StringVar`是`Entry`（以及 Tkinter 中的其他一些东西）的模型。您已经为每个`Entry`实例提供了对同一`StringVar`对象的引用，因此它们自然而然地共享模型并因此显示相同的内容。您需要制作四个不同的`StringVar`对象，每个对象一个`Entry`。（那些，您将在一个循环中创建一个遍历`StringVar`s 集合的循环……）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:47:05.887

首先，请停止使用：

```
i=[1,2,3,4]
for i in i:
    ... 
```

采用：

```
for i in (1,2,3,4):
    ... 
```

反而。

或更好：

```
for i in xrange(1,5): #range in python3.x
    ... 
```

现在，在循环中创建东西很容易：

```
strvars=[]
boxes=[]
for i in xrange(1,5):
    svar=StringVar()
    box=Entry(choice_frame, bg='white', borderwidth=0, width=0, textvariable=svar)
    box.grid(row=1, column=i-1, sticky="ew", padx=1, pady=1)
    svar.trace('w',numberwritten)
    #If you want to pass the box associated with the stringvar, you can do this:
    #svar.trace('w',lambda a,b,c,box=box : numberwritten(box)) #box.get() get's the contents of an Entry too!
    strvars.append(svar)
    boxes.append(box)

number1,number2,number3,number4=strvars  #unpack stringvars 
box1,box2,box3,box4=boxes   #unpack boxes 
```

`StringVar`每个盒子都需要一个不同的。仅当您知道包含 StringVars 和 Entry 框的列表中有多少项目时，拆包才有效。否则，您可以获得对您想要的框/变量的引用，`boxes[0]`例如`strvars[0]`。

**编辑**

像这样的东西应该工作......

```
def numberwritten(number):
    fg = number.get()
    print fg 

numbers = [StringVar() for i in xrange(4) ]  #Name available in global scope.
for i in numbers:
    i.trace('w',lambda a,b,c,n=i: numberwritten(n) )

# In separate definition def ChoiceBox(choice): (not full code under this def)
def ChoiceBox(choice):  

    for i in xrange(4):
        choice_title = Label(choice_frame, text='Value %g'% float(i+1), bg='white', borderwidth=0, width=0)
        choice_title.grid(row=0, column=column+i, sticky="nsew", padx=1, pady=1)

    boxes=[]
    for i in xrange(4):
        box=Entry(choice_frame,bg='white',borderwidth=0,textvariable=numbers[i])
        box.grid(row=1,column=i, sticky='ew', padx=1, pady=1
        boxes.append(box)

    box1,box2,box3,box4=boxes 
```

顺便说一句，你为什么`width=0`到处使用？没有宽度的条目/标签几乎没用。

# android - Android，如何在“ndk-build”中为 openssl 使用 fipsld

> ID：11209476
> 
> 赞同：2
> 
> 时间：2012-06-26T14:22:04.223
> 
> 标签：android, openssl, fips, android-ndk

为了在android上使用支持fips的openssl库（在我的例子中是libcrypto.a），我需要在my.so（JNI代码）中链接构建的libcrypto.a。根据openssl fips 2.0 用户手册，应该使用fipsld 来验证和生成hmac 签名。我目前正在使用“ndk-build”链接 libcrypto.a 并生成 my.so，我的问题是，如何将 fipsld 集成到我的 Android.mk 中？

如果使用 Android.mk / ndk-build 很难，我会​​改用 arm-eabi-gcc 链接 libcrypto.a 并创建 my.so。使用 fipsld 的 gcc 方式记录在 openssl fips 用户手册中。任何人都可以为我提供一个构建 .so 链接 .a for android 的示例集（配置/Makefile）的链接。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:14:11.700

无需使用 fipsld，使用构建 fips openssl 共享库

```
make fips shared --with-fipsdir=xxxxx 
```

并用于`ndk-build`通过符号链接 libcrypto.so 链接到 libcrypto.so.1.0.0。

# html - 可以使用 Twitter Bootstrap 实现 Modernizr 吗？

> ID：11209478
> 
> 赞同：39
> 
> 时间：2012-06-26T14:22:06.283
> 
> 标签：html, twitter-bootstrap, modernizr, html5shiv

可以用 Twitter Bootstrap 实现 Modernizr 吗？

我目前正在将 Bootstrap 与 Google 的 html5shiv 一起使用，我想知道我是否可以使用 Modernizr 或者只是为旧的 IE 浏览器激活 HTML5 元素是否过大？

提前致谢

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-06-26T14:26:21.163

Modernizr 是一个测试套件，它通过应用于 body 标签的类添加*特征检测。*它包括 HTML5Shi(v|m) 以添加旧版浏览器兼容性。您不需要 Modernizr 只是为了在旧浏览器中设置新标签的样式。

也就是说，**在 Twitter Bootstrap 中包含 Modernizr 是可以的**。您甚至可以使用[Initializr](http://www.initializr.com/)中包含的 Bootstrap 和 Modernizr 获得自动生成的 H5BP 模板。

# iphone - NSMutableArray 索引混淆

> ID：11209480
> 
> 赞同：1
> 
> 时间：2012-06-26T14:22:08.980
> 
> 标签：iphone, ios, xcode, nsmutablearray

我目前正在尝试这个`iCarousel` `Multiple Carousel`例子。在我的数组中，我使用 NSMutableDictionary 添加了图像：

我有其中两个：（ myImages 和 myImages2 用于我在 ViewDidLoad 中加载的轮播中的两个插槽）

```
self.myImages = [NSMutableArray array];
for(int i = 0; i <= 10; i++) 
{ 
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDir = [paths objectAtIndex:0];

    NSString *savedPath = [documentsDir stringByAppendingPathComponent:[NSString stringWithFormat:@"myImages%d.png", i]]; 
    if([[NSFileManager defaultManager] fileExistsAtPath:savedPath]){ 
        NSMutableDictionary *container = [[NSMutableDictionary alloc] init];
        [container setObject:[UIImage imageWithContentsOfFile:savedPath] forKey:@"image"];
        [container setObject:[NSNumber numberWithInt:i] forKey:@"index"];
        [images addObject:container];
        [container release]; // if not using ARC 
    } 
} 
```

在我的 iCarousel 中：

```
- (UIView *)carousel:(iCarousel *)carousel viewForItemAtIndex:(NSUInteger)index reusingView:(UIView *)view
{
    if (carousel == carousel1)
    {
        NSDictionary *obj = [items1 objectAtIndex:index];
        view = [[UIImageView alloc] initWithImage:[obj objectForKey:@"items1"]];
        view.tag = index;
    }else
    {
        NSDictionary *obj = [items2 objectAtIndex:index];
        view = [[UIImageView alloc] initWithImage:[obj objectForKey:@"items2"]];
        view.tag = index;
    }

    return view;
} 
```

在另一个视图中，这些数组也被加载，用户有机会选择一个图像进行比较，

当用户选择一个图像时，一个与其标签等效的 int 被传递到我的两个 Carousel 所在的位置。

以下是我比较它们的方法：

```
NSInteger image = [prefs integerForKey:@"image"];
NSInteger image1 = [prefs integerForKey:@"image2"];

        if (image == [(UIImageView*)[self.carousel1 currentItemView] tag] || image2= [(UIImageView*)[self.carousel2 currentItemView] tag] || ) { 
```

我以这种方式删除索引：

```
 NSInteger index = carousel1.currentItemIndex;
    [carousel1 removeItemAtIndex:index animated:YES];
    [items1 removeObjectAtIndex:index]; 
```

我想我把它删错了，因为索引没有更新，我想要的是保持它的索引不要像这里的图像一样调整：

[在 NSMutableArray 中删除](https://stackoverflow.com/questions/11203568/deleting-in-nsmutablearray)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:56:02.323

如果我了解您现在要做什么，即移动两个轮播直到中间一个匹配，然后不让索引简单地消失，那么您可以不从数组中删除项目，而是填充位置您正在尝试使用 nil 图像（或具有您选择的支持的有效图像）以及表明它已经匹配的标签来删除。

这当然取决于我对您想要什么的理解是否有效。

# android - android - 动态第一个单选按钮处于真实状态

> ID：11209502
> 
> 赞同：0
> 
> 时间：2012-06-26T14:23:08.143
> 
> 标签：android, dynamic, radio-button, radio-group

在我的 android 应用程序中，我尝试使用以下代码在单选组内根据 arraylist 大小创建一个动态单选按钮

```
for (int aa = 0; aa < itemname.length(); aa++)
{
    String iname = itemname.getJSONObject(aa).getString("item");

    final RadioButton[] radioButton = new RadioButton[itemname.length()];
    radioButton[aa] = new RadioButton(this);
    radioGroup.addView(radioButton[aa]);
    radioButton[aa].setTextColor(R.color.black);
    radioButton[aa].setText(iname);
    radioButton[aa].setButtonDrawable(R.drawable.about_us_tab);                       

    radioButton[aa].setId(h_count);
    radioGroup.setOnCheckedChangeListener(new     android.widget.RadioGroup.OnCheckedChangeListener()
     {   
         public void onCheckedChanged(RadioGroup group, int checkedId)
         {   
             int selectedBtn = radioGroup.getCheckedRadioButtonId();
          }
       });
       h_count++;
      }
  } 
```

我以正确的顺序获取所有数据，并且无线电组的 onclick 操作也正常工作。但我希望第一个单选按钮处于选定模式。为此，我尝试使用如下 if 条件

```
if(aa == 0)
    {
        radioButton[aa].setChecked(true);
        radioButton[aa].setId(h_count);
    } 
```

但这里的问题是，第一个被选中，并且在无线电组的 onclick 操作中，第一个没有被取消选中，所有其他的都工作正常。

如何在单选组的 onclick 动作中取消选择第一个

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T05:42:19.283

以这种方式尝试及其工作

```
for (int aa = 0; aa < itemname.length(); aa++)
{
    String iname = itemname.getJSONObject(aa).getString("item");

    final RadioButton radioButton = new RadioButton(this);
    radioGroup.addView(radioButton;
    radioButton.setTextColor(R.color.black);
    radioButton.setText(iname);
    radioButton.setButtonDrawable(R.drawable.about_us_tab);                       

    if(aa == 0)
    {
        radioButton.setChecked(true);
    }

    radioButton.setId(h_count);
    radioGroup.setOnCheckedChangeListener(new     android.widget.RadioGroup.OnCheckedChangeListener()
    {   
         public void onCheckedChanged(RadioGroup group, int checkedId)
         {   
             int selectedBtn = radioGroup.getCheckedRadioButtonId();
         }
    });
    h_count++;
} 
```

# batch-file - SET 和 SETLOCAL 的问题

> ID：11209505
> 
> 赞同：1
> 
> 时间：2012-06-26T14:23:18.313
> 
> 标签：batch-file

为了清楚起见，我已经查看了有关此主题的其他问题，但它们要么没有解决这个问题，要么通常不解决这个问题。

我怀疑这个问题与嵌套的 FOR 循环以及 SETLOCAL 的放置位置有关。

我有一个功能来检查文件是否自特定时间以来已被修改：

```
:CheckCopied result directory filename since -- returns whether the file has been modified in the time since 'since'
::                      -- result    [out]    - 0=FAIL, 1=SUCCESS
::                      -- directory [in]     - target directory
::                      -- filename [in]      - target filename
::                      -- since [in]         - the time the script started
SETLOCAL ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION
set directory=%~2
set filename=%~3
set since=%~4

ECHO.CheckCopied directory="%directory%", filename=%filename%, since=%since%

FOR /F "tokens=1,2 delims= " %%d IN ('echo ^| dir "%directory%" ^| find "%filename%"') DO  (
    FOR /F "tokens=1,2 delims=:" %%h IN ('echo %%e') DO (
        ECHO Hours:  %since:~0,2%  vs  %%h
        ECHO Minutes:  %since:~3,2%  vs  %%i
        SET hours=!since:~0,2!
        SET minutes=%since:~3,2%
        ECHO hours=%hours%   minutes=%minutes%
        SET /A minutesSince=60*hours+minutes
        ECHO %minutesSince%
        SET hours=%%h
        SET minutes=%%i
        ECHO hours=%hours%   minutes=%minutes%
    )
)

EXIT /b 
```

这输出：

```
CheckCopied directory="<my directory>" filename=<my filename> since=15:18:34.98
Hours:  15  vs  15
Minutes:  18  vs  11
hours=  minutes=
ECHO is off.
hours=  minutes= 
```

所以“SET hours=!since:~0,2!” 似乎不起作用。

我试过了：

```
SET hours=!since:~0,2!
SET hours=%since:~0,2%
SET /A hours=!since:~0,2!
Every combination I could think of of SETLOCAL ENABLEDELAYEDEXPANSION and ENDLOCAL 
```

我假设这与 SETLOCAL 有关，但我找不到神奇的组合......

**编辑：**

非常感谢下面的 jeb。我已经按照他的建议重做了这个功能：

```
:CheckCopied result directory filename since -- returns whether the file has been modified in the last 5 minutes
::                      -- result    [out]    - 0=FAIL, 1=SUCCESS
::                      -- directory [in]     - target directory
::                      -- filename [in]      - target filename
::                      -- since [in]         - the time the script started
SETLOCAL ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION
set directory=%~2
set filename=%~3
set since=%~4

ECHO.CheckCopied directory="%directory%", filename=%filename%, since=%since%

FOR /F "tokens=1,2 delims= " %%d IN ('echo ^| dir "%directory%" ^| find "%filename%"') DO (
    FOR /F "tokens=1,2 delims=:" %%h IN ('echo %%e') DO (
        ECHO Hours:  %since:~0,2%  vs  %%h
        ECHO Minutes:  %since:~3,2%  vs  %%i
        SET hours=!since:~0,2!
        SET minutes=!since:~3,2!
        ECHO hours=!hours!   minutes=!minutes!
        SET /A minutesSince=60*hours+minutes
        ECHO !minutesSince!
        SET /A hoursx=%%h
        SET /A minutesx=%%i
        ECHO hours=!hoursx!   minutes=!minutesx!
        SET /A minutesSincex=60*hoursx+minutesx
        ECHO !minutesSincex!
    )
)
ENDLOCAL

EXIT /b 
```

总之，预期与必需：

```
SET hours=%since:~0,2%  ==> SET hours=!since:~0,2!
ECHO hours=%hours%      ==> ECHO hours=!hours!
SET hoursx=%%h          ==> SET /A hoursx=%%h 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:44:15.117

问题不在于 SET 其百分比扩展。
这不像您期望的那样工作，它在解析块时扩展，而不是在执行时扩展。
因此，您应该尝试延迟扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-09T10:07:39.240

我学会了避免嵌套块并尽可能编写短块。长块或嵌套块是调试和块中断`for`循环中的任何 goto 的噩梦。所以我经常写一个子程序，并`call:subRoutine`从它返回`goto:eof`。该子例程以常规方式工作：可以更改变量并使用`%variable%`. `Echo`，当*on*时，写入命令的实际参数。`GoTo`也可以。您像调用另一个批处理文件一样传递参数 - 子例程可以是单独的文件。然后 . 后面没有冒号`call`。

当然，仍然存在使用块很方便并且需要延迟扩展的情况。我想在这里只是为了表明还有另一种方式。

# sql - 在本地部署 azure 网站，更新数据库不起作用：数据库“主”中的 CREATE DATABASE 权限被拒绝

> ID：11209506
> 
> 赞同：0
> 
> 时间：2012-06-26T14:23:18.310
> 
> 标签：sql, visual-studio, azure, web

我已经完成了本教程： [https ://www.windowsazure.com/en-us/develop/net/tutorials/web-site-with-sql-database/?redirectToLocale=false](https://www.windowsazure.com/en-us/develop/net/tutorials/web-site-with-sql-database/?redirectToLocale=false)

当我在我的 Azure 在线帐户上发布它时它就可以工作，并且数据库运行良好。但问题是，当我按照教程进行操作时，它要求这样做：1\. enable-migrations 2\. add-migrations 3\. update-database

1.  和 2\. 有效，但是当我在包管理器控制台中运行 3\. (update-database) 时，我收到此错误：

> 数据库“master”中的 CREATE DATABASE 权限被拒绝。

所以我无法在本地部署我的网站，这是我的问题......当我运行 Ctrl+F5 时，它会打开

```
> http://localhost:2700/ 
```

它显示了这个错误：

```
> Server Error in '/' Application.
> 
> CREATE DATABASE permission denied in database 'master'.
> 
> Description: An unhandled exception occurred during the execution of
> the current web request. Check the stack trace for more information
> about the error and where it originated in the code.
> 
> Exception Details: System.Data.SqlClient.SqlException: CREATE DATABASE
> Permission denied in database 'master'.
> 
> Source Error:
> 
> 
> Line 20: public ActionResult Index ()
> Line 21: { 
> Line 22:   return View(db.ToDoItems.ToList ()); 
> Line 23: } 
> 
> Source File: c: \ Users \ baudouin \ Documents \ Visual Studio 2012 \
> Projects \ ToDoListApp \ ToDoListApp \ Controllers \ HomeController.cs
> Line: 22 
```

当我打开 SQL Server Management Studio 时，我确实可以访问我的主数据库......当我在 Visual Studio 2012 RC 中时，它说我的数据连接 DefaultConnection(ToDoApp) 有一个错误：

```
> Server Explorer can not execute this operation.
>     For more information, see details below:
>     Cannot attach the file 'C:\Users\baudouin\documents\visual studio 2012\Projects\ToDoListApp\ToDoListApp\App_Data\aspnet-ToDoListApp-20120625114938.mdf'
> as database 'aspnet-ToDoListApp-20120625114938'. 
```

我在教程中没有看到与 .mdf 相对应的内容......而且我不明白为什么 update-database 根本不起作用。

你能帮我么 ？

谢谢 ！！【来自巴黎的法国学生】

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T18:00:54.213

你的连接字符串是什么？您似乎在测试代码时尝试连接到本地 SQLExpress DB？

当您从 Visual Studio 运行代码时，VS 和数据库都可以在两个不同的帐户上运行。例如，Windows Azure Compute Emulator 使用“网络服务”帐户凭据运行，因此为主数据库添加相同的“网络服务”凭据可以解决问题。

因此，尝试为 NT AUTHORITY\NETWORK SERVICE 添加登录到您的 SQLExpress 实例并授予它 sysadmin 角色，看看问题是否已解决。

尽管授予 sys admin 角色授予 db_owner 角色到 NT AUTHORITY\NETWORK SERVICE 仅用于主 DB。这还需要重新启动服务一次，建议重新启动系统。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-03T10:09:35.023

正如 Avkash 所指出的，该问题与您尝试连接到本地数据库有关。这可能在本地有效，但在 Windows Azure 中无效。请使用 Azure SQL 数据库。连接字符串的数据源需要指向 tcp:... 而不是本地 mdf 文件。实际上您指出的教程已经使用了 Azure SQL 数据库，请参阅它以获取更多详细信息。

# sql - 两个日期之间每天未结订单的 SQL 计数

> ID：11209507
> 
> 赞同：4
> 
> 时间：2012-06-26T14:23:19.567
> 
> 标签：sql, sql-server

我试过搜索，但很可能我使用了错误的关键字，因为我找不到答案。

我正在尝试查找两个日期之间以及按员工打开的订单数量。我有一个显示员工列表的表，另一个显示包含打开和关闭日期的订单列表以及日期表（如果有帮助的话）。

加入的员工和订单表将返回如下内容：

```
employee    order ref   opened          closed
a           123         01/01/2012      04/01/2012
b           124         02/01/2012      03/01/2012
a           125         02/01/2012      03/01/2012 
```

我需要将这些数据转换为：

```
Date            employee    Count
01/01/2012      a           1
02/01/2012      a           2
02/01/2012      b           1
03/01/2012      a           2
03/01/2012      b           1
04/01/2012      a           1 
```

我正在从 SQL Server 中提取数据。

有任何想法吗？

谢谢

缺口

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T05:02:09.687

加入and`Dates`之间的连接结果，然后按日期和员工分组以获得计数，如下所示：`Employees``Orders`

```
SELECT
  d.Date,
  o.Employee,
  COUNT(*) AS count
FROM Employees e
  INNER JOIN Orders o ON e.ID = o.Employee
  INNER JOIN Dates d ON d.Date BETWEEN o.Opened AND o.Closed
GROUP BY
  d.Date,
  o.Employee 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:50:00.253

我最喜欢的方法是计算累积打开次数和累积关闭次数。

```
with cumopens as
    (select employee, opened as thedate,
            row_number() over (partition by employee order by opened) as cumopens,
            0 as cumcloses
     from eo
    ),
     cumcloses as
    (select employee, closed as thedate, 0 as cumopens,
            row_number() over (partition by employee order by closed ) as cumcloses
     from eo
    )
select employee, c.thedate, max(cumopens), max(cumcloses),
       max(cumopens) - max(cumcloses) as stillopened
from ((select *
       from cumopens
      ) union all
      (select *
       from cumcloses
      )
     ) c
group by employee, thedate 
```

这种方法的唯一问题是只报告有员工活动的日期。这适用于您的情况。

更通用的解决方案需要一个序列号来生成日期。为此，我经常从一些具有足够行的现有表中创建一个：

```
with nums as
    (select row_number() over (partition by null order by null) as seqnum
     from employees
    )
select employee, dateadd(day, opened, seqnum) as thedate, count(*)
from eo join
     nums
     on datediff(day, opened, closed) < seqnum
group by employee, dateadd(day, opened, seqnum)
order by 1, 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:46:50.467

调用结果列计数有点奇怪，因为它实际上似乎是一个行号。您可以通过使用 ROW_NUMBER 来做到这一点。

另一个有趣的部分是您还希望打开日期和关闭日期作为单独的行。使用一个简单的 UNION 就可以解决这个问题。

```
WITH cte 
     AS (SELECT Row_number() OVER ( PARTITION BY employee  
                                    ORDER BY order_ref) count, 
                employee, 
                opened, 
                closed 
         FROM   orders) 
SELECT employee,  opened date,  count 
FROM   cte 
UNION ALL 
SELECT employee,  closed date,  count 
FROM   cte 
ORDER  BY Date, 
          employee 
```

[演示](http://sqlfiddle.com/#!3/6710f/8)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T14:27:35.467

```
SELECT opened,employee,count(*)
FROM employee LEFT JOIN orders
WHERE opened < firstDate and opened > secondDate
GROUP BY opened,employee 
```

或者您可以更改第一个条件

```
WHERE opened BETWEEN firstDate and secondDate 
```

# php - 使用PHP执行cmd命令

> ID：11209509
> 
> 赞同：8
> 
> 时间：2012-06-26T14:23:22.133
> 
> 标签：php, cmd, shell-exec

如何使用 php 在命令行中正确执行命令？例如，我在命令行中使用以下命令将 docx 文件转换为 pdf 文件：

```
pdfcreator.exe /PF"D:\Documents\sample.docx 
```

现在使用 PHP 代码，我希望能够执行相同的命令，但似乎什么都没有发生：

```
<?php
shell_exec('pdfcreator.exe /PF"D:\Documents\sample.docx"');
?> 
```

这在 PHP 中是否可行？如果可以，我该怎么做？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-26T14:27:03.193

```
system("c:\\path\\to\\pdfcreator.exe /PF\"D:\\Documents\\sample.docx""); 
```

试试这个。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-26T14:29:06.300

不要忘记使用[escapeshellcmd()](http://www.php.net/manual/en/function.escapeshellcmd.php)转义您的命令。这将防止您不得不使用难看的反斜杠和转义字符。

还有其他可能有效的替代方案：

```
`command` // back ticks drop you out of PHP mode into shell
exec('command', $output); // exec will allow you to capture the return of a command as reference
shell_exec('command'); // will return the output to a variable
system(); //as seen above. 
```

此外，请确保您的 .exe 包含在您的 $PATH 变量中。如果没有，请包含命令的完整路径。

# c# - 将 Linq 与 SQLite 一起使用：表已识别但“结果视图”给出错误

> ID：11209511
> 
> 赞同：0
> 
> 时间：2012-06-26T14:23:30.973
> 
> 标签：c#, linq, sqlite

我正在尝试使用 SQLITE 在 . 但是我遇到了一个奇怪的问题：

```
// Start of code
connection = new SQLiteConnection(myConnectionString);
connection.Open();
myDataContext = new Main(connection, new SqliteVendor());
// End of code 
```

执行后检查“myDataContext”（使用调试器），我看到它的类型为“Main”（应该是:)），并且作为成员，我在 DB 中定义的表的名称（到目前为止 - 很好...），但是...尝试打开一个表（其中有（！）记录），然后尝试打开该表的“ResultView”成员，我面临着字符串“SQLite error\n No such table : main:XXXX" （XXXX 是表名...）（我是来检查结构的，因为当我尝试通过 linq 命令获取记录时 - 我有一个例外。）你有什么想法什么会导致这种行为？谢谢，里夫卡

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T11:01:13.453

好的，我找到了它的来源......（实际上是在我发布问题几个小时后找到的......）我正在使用 Visual Studio，我的数据库文件名是项目的一部分。由于我更改了 db 文件名的（名称和内容......），我忘记将其标记为“始终复制”......这导致了问题。请标记为已解决...

# xml - 如何从 XML::Simple 中提取数据结构中的属性？

> ID：11209513
> 
> 赞同：0
> 
> 时间：2012-06-26T14:23:38.197
> 
> 标签：xml, perl, xml-parsing

我已经转储了以下 XML 结构。

```
$VAR1 = {
    'events'    => {},
    'docvalues' => {
        'docvalue' => {
            'ENGLAND' => {
                'doc' => {
                    'England' => {
                        'value1' => '0.70312',
                        'value2' => '52.16045',
                        'type'   => 'other',
                        'rank'   => '21'
                    },
                    'New England District' => {
                        'value1' => '151.65',
                        'value2' => '-30.51667',
                        'type'   => 'other',
                        'rank'   => '18'
                    }
                },
                'id' => 'rb5'
            },
            'MS' => {
                'contains'   => 'rb7',
                'abbrev-for' => 'Mississippi',
                'doc'        => {
                    'Mississip pi' => {
                        'value1' => '31.64850330352783',
                        'value2' => '-91.29143524169922',
                        'type'   => 'other',
                        'rank'   => '8'
                    },
                    'Mississippi County' => {
                        'value1' => '-89.31674',
                        'value2' => '36.81672',
                        'type'   => 'other',
                        'rank'   => '6'
                    }
                },
                'id' => 'rb9'
            }
        }
    }
}; 
```

我不知道如何从`value1`和`value2`属性中提取值。我尝试使用[XML::Simple](http://p3rl.org/XML%3a%3aSimple)，但以哈希值而不是属性结束。

```
my $doclist   = XMLin('my file.xml');
my $docvalues = $doclist->{docvalues};
my @docvalue  = $docvalues->{docvalue};
my ($v1, $v2, $v3) = @_;
foreach my $doc_value (@docvalue) {
    my @doc = $doc_value->{doc};
    foreach my $values (@doc) {
        $v1 = $values->{'value1'};
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:35:47.793

它相当直截了当，但有点长。

```
foreach my $country (keys %{ $VAR1->{'docvalues'}->{'docvalue'} } ) {
  print "Country: $country\n";
  foreach my $doc (keys %{ $VAR1->{'docvalues'}->{'docvalue'}->{$country}->{'doc'} }) {
    print "doc: $doc\n";
    print "value1: " . $VAR1->{'docvalues'}->{'docvalue'}->{$country}->{'doc'}->{$doc}->{'value1'} . "\n";
    print "value2: " . $VAR1->{'docvalues'}->{'docvalue'}->{$country}->{'doc'}->{$doc}->{'value2'} . "\n";
  }
} 
```

输出：

```
Country: ENGLAND
doc: England
value1: 0.70312
value2: 52.16045
doc: New England District
value1: 151.65
value2: -30.51667
Country: MS
doc: Mississip pi
value1: 31.64850330352783
value2: -91.29143524169922
doc: Mississippi County
value1: -89.31674
value2: 36.81672 
```

诀窍是检查事情在哪里再次发生。很明显，似乎有几个国家，所以我们需要一个循环。然后每个国家都有一个叫做`doc`两个区域的东西。我们必须遍历这些，因为它们包含`value1`and `value2`。

* * *

重新缩进以增加可编辑性并在文本编辑器中缩小（较小的字体）对我有帮助。

```
my $VAR1 = {
  'events'    => {},
  'docvalues' => {
    'docvalue' => {
      'ENGLAND' => {
        'doc' => {
          'England' => {
            'value1' => '0.70312',
            'value2' => '52.16045',
            'type'   => 'other',
            'rank'   => '21'
          },
          'New England District' => {
            'value1' => '151.65',
            'value2' => '-30.51667',
            'type'   => 'other',
            'rank'   => '18'
          }
        },
        'id' => 'rb5'
      },
      'MS' => {
        'contains'   => 'rb7',
        'abbrev-for' => 'Mississippi',
        'doc'        => {
          'Mississip pi' => {
            'value1' => '31.64850330352783',
            'value2' => '-91.29143524169922',
            'type'   => 'other',
            'rank'   => '8'
          },
          'Mississippi County' => {
            'value1' => '-89.31674',
            'value2' => '36.81672',
            'type'   => 'other',
            'rank'   => '6'
          }
        },
        'id' => 'rb9'
      }
    }
  }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T20:08:47.713

您可以通过以下方式获取值：

```
print "$ref->{docvalues}->{docvalue}->{ENGLAND}->{doc}->{England}->{value1}\n";
print "$ref->{docvalues}->{docvalue}->{ENGLAND}->{doc}->{England}->{value2}\n";
print "$ref->{docvalues}->{docvalue}->{ENGLAND}->{doc}->{'New England District'}->{value1}\n";
print "$ref->{docvalues}->{docvalue}->{ENGLAND}->{doc}->{'New England District'}->{value2}\n";
print "$ref->{docvalues}->{docvalue}->{MS}->{doc}->{Mississippi}->{value1}\n";
print "$ref->{docvalues}->{docvalue}->{MS}->{doc}->{Mississippi}->{value2}\n"; 
```

# xaml - DXGrid 更改网格行 DevExpress WPF 的颜色

> ID：11209514
> 
> 赞同：3
> 
> 时间：2012-06-26T14:23:39.093
> 
> 标签：xaml, devexpress, dxgrid

我有拥有财产的实体`IsRemoved`。当它成为真正的网格行应该是灰色的。

为此，我使用以下代码：

```
 <dxg:TableView.RowStyle>
        <Style TargetType="{x:Type dxg:GridRowContent}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding DataContext.IsRemoved, Mode=OneWay}" Value="True">
                    <Setter Property="Background" Value="Gray" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </dxg:TableView.RowStyle>
</dxg:TableView> 
```

但它只会在网格第一次显示时运行。我想在值改变时改变颜色。属性实现`INotifyPropertyChange`事件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T01:57:02.960

> 注意：这个答案是遗留的（见我的另一个答案）。
> 
> 此答案适用于 v14.1 之前的 DevExpress 版本，或 DevExpress v14.1 及之后的版本 `UseLightweightTemplates="None"`。

您需要为要更改的属性设置一个初始设置器。这是由于 WPF 使用样式的顺序。

在您的样式标签之后包含这一行：

`<Setter Property="Background" Value="Black" />`

完整示例：

```
<dxg:TableView.RowStyle>
    <Style TargetType="{x:Type dxg:GridRowContent}">
        <Setter Property="Background" Value="Black" />
        <Style.Triggers>
            <DataTrigger Binding="{Binding DataContext.IsRemoved, Mode=OneWay}" Value="True">
                <Setter Property="Background" Value="Gray" />
            </DataTrigger>
        </Style.Triggers>
    </Style>
</dxg:TableView.RowStyle> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-25T11:37:08.430

从 DevExpress v14.1 开始，他们引入了[使用轻量级模板的优化模式](https://documentation.devexpress.com/#WPF/CustomDocument17112)。这使一切变得更快，但需要更改样式和 DataTriggers 的指定方式。

轻量级模板由附加属性控制`UseLightweightTemplates="Row"`，默认情况下该属性处于启用状态。它可以切换到`None`向后兼容。

`IsDirty`这是一个有效的 MVVM 示例，说明如果为任何网格行设置了属性，如何为行着色。

```
<dxg:GridControl x:Name="MyGridControl"
        ItemsSource ="{Binding MyViewModelList}" 
        SelectionMode="None"
        VerticalAlignment="Stretch">
    <dxg:GridControl.Resources>
        <SolidColorBrush x:Key="GridRowIsDirty" Color="#FF602D2D" />
    </dxg:GridControl.Resources>
    <dxg:GridControl.View>
        <dxg:TableView UseLightweightTemplates="Row" >
            <dxg:TableView.RowStyle>
                <Style TargetType="dxg:RowControl">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Row.IsDirty}" Value="True">
                            <Setter Property="Background" Value="{StaticResource GridRowIsDirty}" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </dxg:TableView.RowStyle>
        </dxg:TableView>
    </dxg:GridControl.View>
    <dxg:GridControl.Columns>
        <dxg:GridColumn x:Name="Included" FieldName="Included"/>
        <dxg:GridColumn x:Name="ColumnB" Header="Column B" FieldName="ColumnB" ReadOnly="True"/>
        <dxg:GridColumn x:Name="ColumnC" Header="Column C" FieldName="ColumnC" ReadOnly="True"/>ReadOnly="True"/>
    </dxg:GridControl.Columns>
</dxg:GridControl> 
```

在这个网格后面的 ViewModel 中：

```
public ObservableCollection<MyViewModel> MyViewModelList { get; set; } 
```

网格中的每一行都指向一个 type 类`MyViewModel`，其中包含一个自定义 IsDirty 标志，我们可以根据需要设置它：

```
public bool IsDirty
{
    get { return _isDirty; }
    set
    {
        _isDirty = value;
        OnPropertyChanged();
    }
} 
```

### 附录 A：附加链接

*   请参阅[DevExpress：如何禁用聚焦/选定的行颜色](https://www.devexpress.com/Support/Center/Question/Details/Q403755)。
*   请参阅[DevExpress：优化模式](https://documentation.devexpress.com/#WPF/CustomDocument17112)。
*   请参阅[DevExpress：DXGrid：DataTrigger 似乎不适用于 UseLightweightTemplates="All"](https://www.devexpress.com/Support/Center/Question/Details/T384426)。
*   请参阅[DevExpress：绑定到 RowData.Row 属性在更改特定数据行属性时不会更新](https://www.devexpress.com/Support/Center/Question/Details/T171740)。
*   请参阅[DevExpress: DxGrid: Grid 不会更新，直到我滚动关闭该行和一个屏幕](https://www.devexpress.com/Support/Center/Question/Details/T384756)。

### 附录 B：其他解决方案

这在大多数情况下也有效，但如果事件的来源是通过上下文菜单将不起作用，因此不推荐：

```
 <DataTrigger Binding="{Binding DataContext.IsDirty}" Value="True">
    <Setter Property="Background" Value="{StaticResource GridRowIsDirty}" />
 </DataTrigger> 
```

### 附录 C：AllowLiveDataShaping

如果触发器未触发，请尝试在`AllowLiveDataShaping="True"`中打开`<GridControl>`。但是，尽量避免这种情况，因为它（理论上）会影响大型复杂网格的速度（它对大多数合理大小的网格没有明显的影响）。

### 附录 D：如果一切都失败了，请使用自定义 ControlTemplate

随着“UseLightweightTemplates”的推出，DevExpress 一直专注于速度。但是，用于速度的技术涉及关闭可能会减慢速度的绑定。

这意味着如果我们更改 DxGrid 单元格中的某些内容，则 ViewModel 中的值不会改变，直到用户移动到下一个单元格或行。这意味着 ViewModel 落后于网格中的实际情况。

为了解决这个问题，我能找到的唯一解决方案是完全绕过 DevExpress 的模板，并使用我自己的。这意味着 DxGrid 别无选择，只能显示自定义模板，该模板会在用户编辑 ViewModel 时立即更新，这意味着行颜色会立即更改：

```
 <dxg:GridControl Grid.Row="3" x:Name="TrsGridControl"
        ItemsSource ="{Binding MyObservableCollection}"                             
        VerticalAlignment="Stretch"
        AllowLiveDataShaping ="True">
    <dxg:GridControl.Resources>
        <converter:TestConverter x:Key="TestConverter" />
        <ControlTemplate x:Key="DisplayedOnTicketTrs">
                <dxe:CheckEdit x:Name="DisplayedOnTicketCheckEdit" HorizontalAlignment="Center" IsChecked="{Binding RowData.Row.DisplayedOnTicket, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
         </ControlTemplate>
    </dxg:GridControl.Resources>
    <dxg:GridControl.View>
        <dxg:TableView UseLightweightTemplates="All"/>
    </dxg:GridControl.View>
    <dxg:GridControl.Columns>            
        <dxg:GridColumn x:Name="DisplayedOnTicketTrs" DisplayTemplate="{StaticResource DisplayedOnTicketTrs}" Header="Displayed On Ticket?" HeaderToolTip="Displayed On Ticket?" AllowEditing="False"/>
                        Header ="Displayed On Ticket?"/>
        <dxg:GridColumn x:Name="ColumnA" Header="ColumnA" FieldName="ColumnA" ReadOnly="True"/>
        <dxg:GridColumn x:Name="ColumnB" Header="ColumnB" FieldName="ColumnB" ReadOnly="True"/>            
    </dxg:GridControl.Columns>
 </dxg:GridControl> 
```

在我做出这个改变之后，一切都开始起作用了：

*   单击复选框时，背景颜色会立即更改（如果我们添加触发器以更改背景颜色，如上）。
*   编辑 DxGrid 会立即更改 ViewModel。
*   更改 ViewModel 会立即更新 DxGrid。
*   如果 ContextMenu 更新了 ViewModel，那么一切正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-23T13:05:37.707

你应该只写“Row”而不是“DataContext”

# c# - 如何在 TreeView 中包装 TextBlock 内容？

> ID：11209515
> 
> 赞同：2
> 
> 时间：2012-06-26T14:23:40.513
> 
> 标签：c#, wpf, xaml, treeview

我有`TreeView`，它使用数据模板显示一些数据。这是 XAML：

```
<TreeView Grid.Row="0" ItemsSource="{Binding Railways}" x:Name="tvDatawareObjects"
          ScrollViewer.HorizontalScrollBarVisibility="Disabled">
    <TreeView.ItemContainerStyle>
        <Style TargetType="{x:Type TreeViewItem}">
            <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}" />
            <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" />
        </Style>
    </TreeView.ItemContainerStyle>
    <TreeView.Resources>
        <!-- other templates here... -->
        <HierarchicalDataTemplate DataType="{x:Type viewModels:ProjectViewModel}" ItemsSource="{Binding Phases}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <TextBlock Text="{Binding Model.Code}" FontWeight="DemiBold" />
                <TextBlock Text="{Binding Model.Title}" TextWrapping="Wrap" Foreground="Gray" Grid.Row="1" />
            </Grid>
        </HierarchicalDataTemplate>

        <HierarchicalDataTemplate DataType="{x:Type viewModels:CollectionViewModel}" ItemsSource="{Binding Items}">
            <TextBlock Text="{Binding CollectionName}" />
        </HierarchicalDataTemplate>
    </TreeView.Resources>
</TreeView> 
```

文本换行`<TextBlock Text="{Binding Model.Title}" TextWrapping="Wrap" Foreground="Gray" Grid.Row="1" />`不起作用。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T03:43:03.957

我相信`TextBlock`不是包装，因为它没有定义的宽度。所在的网格列`TextBlock`具有 * 宽度，该宽度将随着`TextBlock`宽度的增长而增长。尝试在 或 列上设置宽度`TextBlock`，看看更改是否会导致`TextBlock`换行。

**更新：**

更具体地说，问题在于`TreeViewItem`will 将自身调整为其内容的大小，`ColumnDefinition`将填充（无限）可用空间`TextBlock`，并且 没有宽度限制，永远不会换行。[这篇文章](http://leecampbell.blogspot.com/2009/01/horizontal-stretch-on-treeviewitems.html)很好地描述了 TreeViewItem 的行为方式。总结一下：内容区域`TreeViewItem`设置为“自动”，因此它会增长以适应内容。要显式设置`TreeViewItem`尝试将宽度绑定`ColumnDefinition`到`TreeView`'s的宽度`ActualWidth`。

XAML：

```
<TreeView Width="100">
    <TreeViewItem>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="{Binding RelativeSource={RelativeSource AncestorType=TreeView}, Path=ActualWidth}"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <TextBlock Text="Lorem Ipsum" />
            <TextBlock Text="Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book." 
                       TextWrapping="Wrap" Grid.Row="1"/>
            </Grid>
        </TreeViewItem>
    </TreeView> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T08:20:48.090

我做到了。:)

根据 Dan 的答案中提供的链接，原因在于默认的 TreeViewItemTemplate。

不幸的是，简单的绑定`TreeView.ActualWidth`无济于事。这是因为每个项目的宽度都小于`TreeView.ActualWidth`定义 - 项目以一些水平偏移呈现，具体取决于它们的级别。

因此，为了解决这个问题，我需要像这样计算项目的宽度：

```
width = actual_width_of_tree_view - relative_horizontal_offset_of_item 
```

更准确地说，我需要`ScrollViewer.ViewportWidth`，因此 TreeViewContent 可能会垂直滚动，并且可见区域`TreeView`会小于`TreeView.ActualWidth`这种情况。

这是附加属性：

```
 public static Double GetProjectTitleWidth(DependencyObject obj)
    {
        return (Double)obj.GetValue(ProjectTitleWidthProperty);
    }

    public static void SetProjectTitleWidth(DependencyObject obj, Double value)
    {
        obj.SetValue(ProjectTitleWidthProperty, value);
    }

    public static readonly DependencyProperty ProjectTitleWidthProperty = DependencyProperty.RegisterAttached(
        "ProjectTitleWidth", 
        typeof(Double), 
        typeof(DatawareSearchView),
        new UIPropertyMetadata(0.0, ProjectTitleWidthChanged));

    private static void ProjectTitleWidthChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var targetElement = d as FrameworkElement;
        if (targetElement != null)
        {
            var bindingExpr = targetElement.GetBindingExpression(ProjectTitleWidthProperty);
            var sourceElement = bindingExpr.DataItem as FrameworkElement;
            if (sourceElement != null)
            {
                // calculating relative offset
                var leftTop = targetElement.TranslatePoint(new Point(0.0, 0.0), sourceElement);

                // trying to find ScrollViewer
                var border = VisualTreeHelper.GetChild(sourceElement, 0);
                if (border != null)
                {
                    var scrollViewer = VisualTreeHelper.GetChild(border, 0) as ScrollViewer;
                    if (scrollViewer != null)
                    {
                        // setting width of target element
                        targetElement.Width = scrollViewer.ViewportWidth - leftTop.X;
                    }
                }
            }
        }
    } 
```

...和标记：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*" />
    </Grid.RowDefinitions>

    <TextBlock Text="{Binding Model.Code}" FontWeight="DemiBold" />
    <TextBlock Text="{Binding Model.Title}" TextWrapping="Wrap" Foreground="Gray" x:Name="tbTitle" Grid.Row="1"
               localviews:DatawareSearchView.ProjectTitleWidth="{Binding RelativeSource={RelativeSource AncestorType=TreeView}, Path=ActualWidth}"/>
</Grid> 
```

当然，提供的解决方案不是通用的 - 它假设 TreeView 具有`Border`和`ScrollViewer`.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-26T15:03:09.663

试试这个

```
<TextBlock Text="{Binding Model.Title}" Width="{Binding ActualWidth,
      ElementName=tvDatawareObjects}" TextWrapping="Wrap" Foreground="Gray" Grid.Row="1"/> 
```

# javascript - 如何在原型中按类选择元素？

> ID：11209517
> 
> 赞同：0
> 
> 时间：2012-06-26T14:23:44.070
> 
> 标签：javascript, prototypejs

我在下面有这段代码。我需要使用类 id 而不是索引来更新项目。假设我的班级名称是“首字母”我将如何使用它来更新字段而不是索引，以防万一有人更改它？

```
 $$('select.employee_select').each( function(elm) {
            elm.observe('change', function(ev) {
                item = elm.childElements().find(function(ele){return !!ele.selected});
                item = item.readAttribute('value');
                elm.up().previousSiblings()[3].update(item); *** I want to change this line by class name instead of the index ***
                serv_id = elm.up().previousSiblings()[13];
                serv_id = serv_id.readAttribute('value');
                employee_id = elm.up().previousSiblings()[4];
                employee_id = employee_id.readAttribute('value'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:34:24.147

您可以在数组表示法中引用它：

```
$$('select.employee_select .initials')[0] 
```

或者如果它是该类的唯一元素：

```
$$('.initials')[0] 
```

# c# - 如何正确构建 RavenDB 空间索引，同时检查是否有 List 匹配？

> ID：11209518
> 
> 赞同：6
> 
> 时间：2012-06-26T14:23:43.893
> 
> 标签：c#, linq, ravendb

按照[RevenDB 网站上的示例](http://ravendb.net/docs/client-api/advanced/spatial-search)，我想出了这个：

```
public class Place_ByLocationsAndCategoryId : AbstractIndexCreationTask<Place> {
    public Place_ByLocationsAndCategoryId() {
        Map = places => from p in places
                                select new { p.Categories, _ = Raven.Database.Indexing.SpatialIndex.Generate(p.Location.Lat, p.Location.Lng) };
    }
} 
```

**地方**看起来像这样：

```
Place {
    string Id;
    List<Category> Categories;
    ...
} 
```

**类别**看起来像这样：

```
Category {
    string Id;
    string Name;
    ...
} 
```

如何建立我的索引，以便我可以按纬度/经度的给定半径内的地点进行查询，并包含给定的类别？

我试图像这样查询上面的索引：

```
 var placesFromDb = RavenSession.Advanced.LuceneQuery<Place>("Place/ByLocationsAndCategoryId").WhereIn("Id", new []{cat.Id}).WithinRadiusOf(radius: 5, latitude: Lat, longitude: Lng).ToList<Place>(); 
```

查询处理，但不返回任何结果（当我知道有结果要返回时。我的错误可能在`.WhereIn()`语句中，但是当我尝试使用时，`.Where(x => x.Categories.Any(c => c.Id == id))`我得到一个构建错误，说明它已过时。

* * *

## **- 更新 -**

我将我的索引切换到这个（正如 Ayende 推荐的那样）

```
public Place_ByLocationsAndCategoryId() {
    Map = places => from p in places
                    select new { Categories_Id = p.Categories.Select(x => x.Id), _ = Raven.Database.Indexing.SpatialIndex.Generate(p.Location.Lat, p.Location.Lng) };
} 
```

我在文档存储中创建索引，如下所示：

```
IndexCreation.CreateIndexes(typeof(Place_ByLocationsAndCategoryId).Assembly, Store); 
```

我像这样查询它：

```
var placesFromDb = RavenSession.Advanced.LuceneQuery<Place>("Place/ByLocationsAndCategoryId").WhereEquals("Categories_Id ", cat.Id).WithinRadiusOf(radius: 15, latitude: Lat, longitude: Lng).ToList<Place>(); 
```

这是 RavenDB 本身的索引的样子：

```
docs.Places
    .Select(p => new {Categories_Id = p.Categories
    .Select(x => x.Id), _ = SpatialIndex.Generate(((System.Double)(p.Location.Lat)), ((System.Double)(p.Location.Lng)))}) 
```

查询似乎运行，但返回 0 个结果（我知道有地方可以找到）。我注意到的一件事是我的模型中的 Lat 和 Lng 数据类型是浮点数，而索引似乎设置为 Double。

尝试像这样在索引中投射坐标，也不起作用：

```
public Place_ByLocationsAndCategoryId() {
    Map = places => from p in places
                    select new { Categories_Id = p.Categories.Select(x => x.Id), _ = Raven.Database.Indexing.SpatialIndex.Generate((float)p.Location.Lat, (float)p.Location.Lng) };
} 
```

所以我把我的模型换成了双打；仍然返回 0 个结果。

* * *

## **--更新2--**

如果我删除索引的类别部分，只查询空间部分，它会返回位置。看来类别部分没有按计划运行。

如果有帮助，以下是存储文档的部分外观（JSON 视图）：

```
{
  "Id": "4dca6d56d22da18f4e626f54",
  "Name": "焼肉",
  "Categories": [
    {
      "PlaceCategories": null,
      "Name": "Korean Restaurant",
      "Icon": "korean.png",
      "Id": "4bf58dd8d48988d113941735",
      "IsPrimary": true
    }
  ],
  "Location": {
    "Lat": "35.6709824",
    "Lng": "139.374588"
  },
  ...
} 
```

（注意：Categories就是List，categories可以有子categories，在自己的List属性中命名为PlaceCategories）

* * *

## **--更新3--**

这是管理工作室的索引错误：

> ```
> Places/ByLocationsAndCategoryId 
> Cannot convert type 'string' to 'float' 
> 6/27/2012 
> places/1025
> ... and repeats 50 times 
> ```

我已经将我的模型从浮点数更改为双精度数，因为它看起来像空间生成器想要双精度数。很有可能日志中有一些错误（看不到过去 50），说明“无法将类型“字符串”转换为“浮点数”

我很好奇，在我之前的模型中，我的 Lat/Lng 是浮动的。字符串从哪里来？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T15:13:28.597

你想要这样：

指数：

```
public class Place_ByLocationsAndCategoryId : AbstractIndexCreationTask<Place> {
    public Place_ByLocationsAndCategoryId() {
        Map = places => from p in places
                                select new { Categories_Id =  p.Categories.Select(x=>x.Id), _ = Raven.Database.Indexing.SpatialIndex.Generate(p.Location.Lat, p.Location.Lng) };
    }
} 
```

询问：

```
 var placesFromDb = RavenSession.Advanced.LuceneQuery<Place>("Place/ByLocationsAndCategoryId").WhereEquals("Categories_Id ", cat.Id).WithinRadiusOf(radius: 5, latitude: Lat, longitude: Lng).ToList<Place>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T13:28:30.047

原来这是我的模型。为了将来参考，如果你想在 Raven 中使用空间索引，你必须将你的坐标存储为双精度（我的最初是浮点数）。我确实更改为双精度，但必须编写一个脚本来遍历数据库中的所有文档并将坐标转换为双精度。

在那之后像冠军一样工作。

# python - 覆盖 __new__ 的基元类生成具有错误 __module__ 的类

> ID：11209521
> 
> 赞同：1
> 
> 时间：2012-06-26T14:23:47.903
> 
> 标签：python, metaclass

我发现 cpython 2.5、2.7、3.2 和带有 metaclass 的 pypy 的奇怪行为`__new__`在使用 python 2 / python 3 兼容的方式使用 metaclass 时会被覆盖：

给定一个模块 m1：

```
class C1Meta(type):
    def __new__(cls, name, bases, dct):
        return type.__new__(cls, name, bases, dct)

C1 = C1Meta('C1', (object,), {})

class C2Meta(type):
    pass

C2 = C2Meta('C2', (object,), {}) 
```

以及以下主程序：

```
import m1

C10 = m1.C1Meta('C10', (m1.C1,), {})

class C11Meta(m1.C1Meta):
    pass

C11 = C11Meta('C11', (m1.C1,), {})

class C12Meta(m1.C1Meta):
    def __new__(cls, name, bases, dct):
        return m1.C1Meta.__new__(cls, name, bases, dct)

C12 = C12Meta('C12', (m1.C1,), {})

class C13Meta(m1.C1Meta):
    def __new__(cls, name, bases, dct):
        return type.__new__(cls, name, bases, dct)

C13 = C13Meta('C13', (m1.C1,), {})

C20 = m1.C2Meta('C20', (m1.C2,), {})

class C21Meta(m1.C2Meta):
    pass

C21 = C21Meta('C21', (m1.C2,), {})

class C22Meta(m1.C2Meta):
    def __new__(cls, name, bases, dct):
        return m1.C2Meta.__new__(cls, name, bases, dct)

C22 = C22Meta('C22', (m1.C2,), {})

class C23Meta(m1.C2Meta):
    def __new__(cls, name, bases, dct):
        return type.__new__(cls, name, bases, dct)

C23 = C23Meta('C23', (m1.C2,), {})

print(C10)
print(C11)
print(C12)
print(C13)

print(C20)
print(C21)
print(C22)
print(C23) 
```

运行脚本将产生以下输出（包含所有提到的 python 版本）：

```
<class 'm1.C10'>
<class 'm1.C11'>
<class 'm1.C12'>
<class '__main__.C13'>
<class '__main__.C20'>
<class '__main__.C21'>
<class '__main__.C22'>
<class '__main__.C23'> 
```

-> C10、C11 和 C12 类模块是错误的！

这是预期的行为吗？

有没有办法覆盖不会引发问题的**新方法？**

谢谢，

克里斯托夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T21:16:43.517

显然，该`__module__`属性是在元类执行时设置的。在您的情况下，元类在内部执行`m1`。对于正常定义的类，`__module__`属性会自动生成并传递给元类。但是，您正在通过手动调用元类来创建类，并传入一个*空*的属性字典。因此，您的类不提供`__module__`属性。该`__module__`属性是自动创建的，但直到`type.__new__`被调用。由于这发生在模块内部`m1`，因此当时的`__module__`created 指的是`m1`.

我不确定您为什么要明确调用元类。元类的全部意义在于允许您自定义使用`class`语句定义类时发生的情况。如果您不想使用`class`语句，您可以只使用常规函数来创建您的类，而根本不需要使用元类。

也就是说，我相信您可以通过以下方式获得所需的行为，例如，

```
C11 = C11Meta('C11', (m1.C1,), {'__module__': __name__}) 
```

# android - EntityLayer 未链接到 MapView

> ID：11209522
> 
> 赞同：0
> 
> 时间：2012-06-26T14:23:49.403
> 
> 标签：android, bing-maps

我正在尝试在Bing 地图`Pushpin`上显示多个对象。`EntityLayer`在`Pushpins`正确检索数据并且正确`EntityLayer`存储`Pushpins`时，`MapView`不显示`EntityLayer`.

```
JSONObject json = retrieveJSON();
JSONArray array = json.getJSONArray("Sites");

Coordinate closestGauge;

fooLayer = new EntityLayer("foos");

for(int i = 0; i < array.length(); i++)
{
    JSONObject site = array.getJSONObject(i);
    double lon = site.getDouble("Longitude");
    double lat = site.getDouble("Latitude");
    Pushpin foo = null;
    fooCoordinate = new Coordinate(lat, lon);
    PushpinOptions fooData = new PushpinOptions();
    fooData.Text = Double.toString(site.getDouble("Data"));
    fooData.Icon = Constants.PushpinIcons.RedFlag;
    foo = new Pushpin(fooCoordinate, fooData);
    _FWSGPSLayer.add(foo);
}

fooMap.getLayerManager().addLayer(fooLayer);
fooLayer.updateLayer(); 
```

从 Debug 的角度来看，我注意到`EntityLayer`never 链接到 ，`MapView`因为它的`_map`参数/值总是设置为`null`. 我尝试了各种显示图层的方法，例如调用`setBingMapsView`方法 from`EntityLayer`但到目前为止没有任何效果。

有什么我做错了吗？我试图将事情与示例 Bing 地图应用程序相匹配，但它没有帮助。

编辑：我已经进行了一些调试，这就是我到目前为止所发现的：当我注释掉 for 循环并简单地添加一个图钉时，它就可以工作了。这让我相信必应地图对可以添加的图钉数量有限制。然而，我的数组只包含约 200 个数据点，而我被引导相信上限是数千个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T20:26:44.107

好吧，我傻了。浏览我的`JSONArray`，我注意到，散布在我的阵列中，`Doubles`实际上有几个正在返回`null`。当然，由于我是在具有几乎恒定`Location`更新流的 Android 设备上进行调试的，所以我几乎无法`NullPointerException`在我的 LogCat 中发现它。

吸取教训，经常检查`nulls`。

# delphi - 如何在设计时禁用子控件？

> ID：11209523
> 
> 赞同：3
> 
> 时间：2012-06-26T14:23:53.787
> 
> 标签：delphi, controls, design-time

我有自己的控制，源自`TCustomPanel`. 它上面有一个孩子 ( `TEdit`)。

```
type
  TMyControl = class(TCustomPanel)
  private
    FEditor: TEdit;
  public
    constructor Create(AOwner: TComponent);
    destructor Destroy(); override;
  end;

  constructor TMyControl.Create(AOwner: TComponent);
  begin
    FEditor := TEdit.Create(nil);
    FEditor.Parent := Self;
  end;

  destructor TMyControl.Destroy(); 
  begin
    FEditor.Free();
  end; 
```

当我在设计时单击子控件时，它充当运行时`TEdit`，捕获焦点。

如何在设计时完全禁用子控件？

我希望他们停止回复鼠标/键盘消息。当我在设计时单击它们时，我希望选择并拖动父控件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T14:52:17.920

`Self`在编辑构造函数中用作所有者以使您的编辑面板*成为*面板的子组件并让面板处理其销毁。并为每个子组件调用参数设置为 True 的[`SetSubComponent`](http://docwiki.embarcadero.com/Libraries/en/System.Classes.TComponent.SetSubComponent)函数，以将您的面板控件视为结构窗格中的一个。`IsSubComponent`

```
constructor TMyControl.Create(AOwner: TComponent);
begin
  ...
  FEditor := TEdit.Create(Self);
  FEditor.SetSubComponent(True);
  FEditor.Parent := Self;
  ...
end; 
```

# iphone - 简体中文应用，但在中文 App Store 中显示为英文

> ID：11209527
> 
> 赞同：1
> 
> 时间：2012-06-26T14:24:05.470
> 
> 标签：iphone, ios, localization, app-store, app-store-connect

我的应用程序本地化有一个奇怪的问题。它被翻译成英文、中文（简体）、法文、德文、意大利文、葡萄牙文、俄文和西班牙文。在 App Store 中切换到不同国家会显示该国家/地区语言的正确翻译描述，但中国除外。以下是我的本地化内容的屏幕截图：

![钢琴和弦和音阶，项目设置](../Images/e677849ea8fab92a03600eaf0481a2ce.png) ![钢琴和弦和音阶，元数据](../Images/53f597f611a8c4426b3a0da74f20dbe8.png) ![钢琴和弦和音阶，App Store](../Images/fbec0009cb01c3fd192ed786bb0bb4d1.png) ![钢琴和弦和音阶，语言设置](../Images/b7cf401fb04adc5970da5fccd399aa94.png)

我按照[这里](https://stackoverflow.com/a/7405304/845587)的建议做了，但我仍然得到中国 App Store 的英文版。我错过了一些东西，有什么建议吗？

**更多信息：**此应用程序的 iTunes Store 中文链接以中文显示，但单击“在 iTunes 中查看”会在 iTunes 中以英文打开它

[http://itunes.apple.com/cn/app/piano-chords-scales/id500492595?mt=8](http://itunes.apple.com/cn/app/piano-chords-scales/id500492595?mt=8)

# php - 如何从服务访问应用程序参数？

> ID：11209529
> 
> 赞同：86
> 
> 时间：2012-06-26T14:24:09.197
> 
> 标签：php, symfony, yaml

从我的控制器，我访问应用程序参数（那些`/app/config`）

```
$this->container->getParameter('my_param') 
```

但我不知道如何从服务访问它（我想我的服务类不应该扩展`Symfony\Bundle\FrameworkBundle\Controller\Controller`）。

我是否应该像这样将所需的参数映射到我的服务注册中：

```
#src/Me/MyBundle/Service/my_service/service.yml
parameters:
    my_param1: %my_param1%
    my_param2: %my_param2%
    my_param3: %my_param3% 
```

或类似的东西？我应该如何从服务访问我的应用程序参数？

* * *

[这个问题](https://stackoverflow.com/q/13901256/305189)看起来是一样的，但我实际上回答了它（来自控制器的参数），我说的是从服务访问。

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2012-06-26T16:17:07.697

您可以通过在服务定义中指定参数，以与注入其他服务相同的方式将参数传递给您的服务。例如，在 YAML 中：

```
services:
    my_service:
        class:  My\Bundle\Service\MyService
        arguments: [%my_param1%, %my_param2%] 
```

其中`%my_param1%`etc 对应一个名为 的参数`my_param1`。那么您的服务类构造函数可以是：

```
public function __construct($myParam1, $myParam2)
{
    // ...
} 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2018-03-03T13:02:49.710

# 清洁方式 2018

**自 2018 年和 Symfony 3.4 以来，**有更清洁的方式 - 易于设置和使用。

**您可以通过它的构造函数将参数传递给类**，而不是使用容器和服务/参数定位器反模式。别担心，这不是耗时的工作，而是*设置一次后忘记*的方法。

如何分两步设置？

### 1.`config.yml`

```
# config.yml
parameters:
    api_pass: 'secret_password'
    api_user: 'my_name'

services:
    _defaults:
        autowire: true
        bind:
            $apiPass: '%api_pass%'
            $apiUser: '%api_user%'

    App\:
        resource: .. 
```

## 2.任何`Controller`

```
<?php declare(strict_types=1);

final class ApiController extends SymfonyController
{
    /**
     * @var string 
     */
    private $apiPass;

    /**
     * @var string
     */
    private $apiUser;

    public function __construct(string $apiPass, string $apiUser)
    {
        $this->apiPass = $apiPass;
        $this->apiUser = $apiUser;
    }

    public function registerAction(): void
    {
        var_dump($this->apiPass); // "secret_password"
        var_dump($this->apiUser); // "my_name"
    }
} 
```

## 即时升级准备就绪！

如果您使用较旧的方法，您可以[使用 Rector 将其自动化](https://github.com/rectorphp/rector/pull/333)。

# 阅读更多

这称为服务定位器方法**上的构造函数注入。**

要了解更多信息，请查看我的文章[How to Get Parameter in Symfony Controller the Clean Way](https://www.tomasvotruba.cz/blog/2018/01/22/how-to-get-parameter-in-symfony-controller-the-clean-way)。

（它已经过测试，我会为新的 Symfony 主要版本（5、6...）更新它）。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2015-09-07T09:16:32.137

与其一一映射你需要的参数，为什么不让你的服务直接访问容器呢？这样做，如果添加了新参数（与您的服务相关），您不必更新映射。

为此：

对您的服务类进行以下更改

```
use Symfony\Component\DependencyInjection\ContainerInterface; // <- Add this

class MyServiceClass
{
    private $container; // <- Add this
    public function __construct(ContainerInterface $container) // <- Add this
    {
        $this->container = $container;
    }
    public function doSomething()
    {
        $this->container->getParameter('param_name_1'); // <- Access your param
    }
} 
```

在 services.yml 中添加 @service_container 作为“参数”

```
services:
  my_service_id:
    class: ...\MyServiceClass
    arguments: ["@service_container"]  // <- Add this 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2018-11-06T12:56:10.547

自 symfony 4.1 以来，有一种非常干净的新方法可以实现它

```
<?php
// src/Service/MessageGeneratorService.php

use Symfony\Component\DependencyInjection\ParameterBag\ParameterBagInterface;

class MessageGeneratorService
{
 private $params;
 public function __construct(ParameterBagInterface $params)
 {
      $this->params = $params;
 }
 public function someMethod()
 {
     $parameterValue = $this->params->get('parameter_name');
...
 }
} 
```

来源：[https](https://symfony.com/blog/new-in-symfony-4-1-getting-container-parameters-as-a-service) ://symfony.com/blog/new-in-symfony-4-1-getting-container-parameters-as-a-service 。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-11-16T19:51:07.010

作为提到的一些问题的解决方案，我定义了一个数组参数然后注入它。稍后添加一个新参数只需要添加到参数数组，而不需要对 service_container 参数或构造进行任何更改。

所以扩展@richsage的答案：

参数.yml

```
parameters:
    array_param_name:
        param_name_1:   "value"
        param_name_2:   "value" 
```

服务.yml

```
services:
    my_service:
        class:  My\Bundle\Service\MyService
        arguments: [%array_param_name%] 
```

然后访问类内

```
public function __construct($params)
{
    $this->param1 = array_key_exists('param_name_1',$params)
        ? $params['param_name_1'] : null;
    // ...
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2018-10-24T12:12:28.507

Symfony **4.1**的解决方案非常简单。

这是原始帖子的一个片段：

```
// src/Service/MessageGenerator.php
// ...

use Symfony\Component\DependencyInjection\ParameterBag\ParameterBagInterface;

class MessageGenerator
{
    private $params;

    public function __construct(ParameterBagInterface $params)
    {
        $this->params = $params;
    }

    public function someMethod()
    {
        $parameterValue = $this->params->get('parameter_name');
        // ...
    }
} 
```

链接到原帖： [https ://symfony.com/blog/new-in-symfony-4-1-getting-container-parameters-as-a-service](https://symfony.com/blog/new-in-symfony-4-1-getting-container-parameters-as-a-service)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-28T02:39:27.537

@richsage 是正确的（对于 Symfony 3.?），但它不适用于我的 Symfony 4.x。所以这里是 Symfony 4。

在 services.yaml 文件中

```
parameters:
    param1: 'hello'

Services:
    App\Service\routineCheck:
            arguments:
                $toBechecked: '%param1%'  # argument must match in class constructor 
```

在你的服务类routineCheck.php文件中做这样的构造函数

```
private $toBechecked;

public function __construct($toBechecked)
{
    $this->toBechecked = $toBechecked;
}

public function echoSomething()
{
    echo $this->toBechecked;
} 
```

完毕。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2018-10-17T20:44:31.957

Symfony 3.4 在这里。

经过一些研究，我不认为通过它的构造函数将参数传递给类/服务总是一个好主意。想象一下，如果您需要向控制器/服务传递比 2 或 3 个更多的参数。然后呢？比方说，最多传递 10 个参数会很荒谬。

相反，`ParameterBag`在 yml 中声明服务时，将类用作依赖项，然后使用任意数量的参数。

一个具体的例子，假设你有一个邮件服务，比如 PHPMailer，并且你想在`paramters.yml`文件中包含 PHPMailer 连接参数：

```
#parameters.yml
parameters:
    mail_admin: abc@abc.abc
    mail_host: mail.abc.com
    mail_username: noreply@abc.com
    mail_password: pass
    mail_from: contact@abc.com
    mail_from_name: contact@abc.com
    mail_smtp_secure: 'ssl'
    mail_port: 465

#services.yml
services:
    app.php_mailer:
        class: AppBundle\Services\PHPMailerService
        arguments: ['@assetic.parameter_bag'] #here one could have other services to be injected
        public: true

# AppBundle\Services\PHPMailerService.php
...
use Symfony\Component\DependencyInjection\ParameterBag\ParameterBag;
...
class PHPMailerService
{
    private $parameterBag;
    private $mailAdmin;
    private $mailHost;
    private $mailUsername;
    private $mailPassword;
    private $mailFrom;
    private $mailFromName;
    private $mailSMTPSecure;
    private $mailPort;
}
public function __construct(ParameterBag $parameterBag)
{
    $this->parameterBag = $parameterBag;

    $this->mailAdmin      = $this->parameterBag->get('mail_admin');
    $this->mailHost       = $this->parameterBag->get('mail_host');
    $this->mailUsername   = $this->parameterBag->get('mail_username');
    $this->mailPassword   = $this->parameterBag->get('mail_password');
    $this->mailFrom       = $this->parameterBag->get('mail_from');
    $this->mailFromName   = $this->parameterBag->get('mail_from_name');
    $this->mailSMTPSecure = $this->parameterBag->get('mail_smtp_secure');
    $this->mailPort       = $this->parameterBag->get('mail_port');
}
public function sendEmail()
{
    //...
} 
```

我认为这是一个更好的方法。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2019-05-22T00:27:08.357

在 symfony 4 中，我们可以通过依赖注入的方式访问参数：

服务：

```
 use Symfony\Component\DependencyInjection\ContainerInterface as Container;

   MyServices {

         protected $container;
         protected $path;

         public function __construct(Container $container)
         {
             $this->container = $container;
             $this->path = $this->container->getParameter('upload_directory');
         }
    } 
```

参数.yml：

```
parameters:
     upload_directory: '%kernel.project_dir%/public/uploads' 
```

# google-apps-script - 即使使用正确的 ID 也无法制作文档副本

> ID：11209531
> 
> 赞同：0
> 
> 时间：2012-06-26T14:24:11.163
> 
> 标签：google-apps-script

我有一个脚本，它通过电子表格，从单元格中检索值并将值插入到文档中。该代码运行良好，但我注意到当我复制文档时，运行相同的代码并在代码中传递文档 ID，我收到以下错误：

**找不到具有给定 ID 的项目，或者您无权访问它。**

我试图将文档公开，但我得到了同样的错误。有趣的是，如果我创建一个新文档并将该文档 ID 传递给函数，它就可以正常工作。

编码：

```
var templateid = "1IrEbukq3cVKg9MAPT-Aanfe4XCzoc-RCJKq6sOpQKGU"; // get template file id    
var copyDoc = DocsList.getFileById(templateid).makeCopy(docName); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T15:03:50.583

我不确定我是否完全理解您出现问题的时间，但我猜是您尝试访问 copyDoc 时。这是因为您尝试通过其 ID 访问它（从错误消息中显示）并且您没有它：从您在此处编写的代码中 copyDoc 是一个文档，如果您想要它的 ID，只需`.getId()`在末尾添加即可这个 ：

```
var copyDoc = DocsList.getFileById(templateid).makeCopy(docName).getId(); 
```

希望我猜对了;-)

你也可以这样做，这样你就可以使用所有东西了：

```
 var doctemplate = DocumentApp.openById("1IrEbukq3cVKg9MAPT-Aanfe4XCzoc-RCJKq6sOpQKGU");// this can be placed outside the function as a global variable
  var docname="new name for the copy";
  var copydoc=DocsList.copy(doctemplate,docname);
  var copydocId = copydoc.getId(); 
```

编辑：纠正 jwesonga 评论后代码中的错误（谢谢）

# sql - SQL 语法中的冒号 (':') 是什么意思？

> ID：11209538
> 
> 赞同：7
> 
> 时间：2012-06-26T14:24:33.020
> 
> 标签：sql, database, syntax, oracle11g

> **可能重复：**
> [冒号“:”在 SQL 查询中有何作用？](https://stackoverflow.com/questions/2177978/what-does-the-colon-sign-do-in-a-sql-query)

简单的 SQL 问题：`:`代表什么？

例如：

```
SELECT * FROM myTable
WHERE Employee_column = :P_EmplId; 
```

当`:`你不知道这叫什么时，谷歌并不容易。即使在这里搜索也无济于事。如果这有什么不同，我正在使用 Oracle 11g。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-26T14:27:22.893

它是一个[绑定变量](http://www.akadia.com/services/ora_bind_variables.html)：

> SQL 语句中的占位符，必须替换为有效值或值地址才能使语句成功执行。通过使用绑定变量，您可以编写在运行时接受输入或参数的 SQL 语句。以下示例显示了一个使用 v_empid 作为绑定变量的查询：

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T14:27:15.093

您很可能从模板中获取查询。它旨在使用 php 的 MDB2 sql 框架进行处理。“:”（冒号）表示语句中的占位符，意在执行查询时被替换。

# facebook-graph-api - facebook Opengraph 和 Linked in 的最佳 Drupal 模块

> ID：11209546
> 
> 赞同：-1
> 
> 时间：2012-06-26T14:24:58.870
> 
> 标签：facebook-graph-api, drupal-modules, facebook-opengraph, linkedin, facebook-oauth

我想使用drupal创建校友会网站。所以用户（学生、校友、员工）可以使用facebook/linked in注册/登录。他们的详细信息应该从他们的社交网络个人资料中获取。所以哪个模块适合这个标准。谢谢提前建议我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:28:28.177

让我分享一下我使用 Drupal 和 Facebook 以及相关模块的经验。

在那里的所有模块中，我最喜欢[facebook 的 drupal](http://drupalforfacebook.org)。配置非常简单，效果很好。缺点是它有点重，而且它仍然不支持一些现代 facebook 的东西（比如 opengraph、自定义操作等）。但毫无疑问，它是我用过的关于 Facebook 的最佳模块。

现在出现了在 Facebook 中使用 Drupal 模块的问题。我发现所有这些都使用 PHP-sdk 并且速度很慢而且对现代的东西不友好（一旦用户登录就会重新加载页面等）。

现在你有两个选择，1\. 如果你正在编程或者可以为这个小任务雇用一个，创建一个小模块（一个 javascript 文件和一个 php 文件，就是这样）并完成它。尽管这是我的第一个 drupal 模块，但我做得很好。如果您愿意，我（和很多人）可以帮助您完成编码部分。2\. 如果你不想这样，请使用 drupal for facebook。

# javascript - 如何创建自己的确认对话框？

> ID：11209552
> 
> 赞同：0
> 
> 时间：2012-06-26T14:25:12.130
> 
> 标签：javascript, jquery

确认框只有两个选项：确定和取消。

我想自己做一个，所以我可以添加第三个按钮：保存并继续。但是我目前不知道如何解决的问题是：一旦自定义确认对话框启动，我如何阻止以前运行的脚本（或导航）运行？然后如何使按钮返回值以进行确认？

我对确认对话框的理解是：它是一个可视布尔值，具有阻止页面上的导航和脚本的能力。那么，我该如何模仿呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:28:41.110

如果你想要一个可靠的、经过验证的解决方案......使用 jQuery......它可以在每个浏览器上运行，而不必担心糟糕的 IE 等。[http://jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:34:40.307

在 javascript 中，您不会在等待用户操作时停止：您设置了一个回调（一个函数），您的对话框将在关闭时调用该回调（一个函数）。

这是一个小型对话框库的示例，您可以在其中看到如何传递回调。

```
dialog = {};

dialog.close = function() {
    if (dialog.$div) dialog.$div.remove();
    dialog.$div = null;
};

// args.title
// args.text
// args.style : "", "error"  (optionnel)
// args.buttons : optional : map[label]->function the callback is called just after dialog closing
// args.doAfter : optional : a callback called after dialog closing
dialog.open = function(args) {
    args = args || {};
    if (this.$div) {
        console.log("one dialog at a time");
        return;
    }
    var html = '';
    html += '<div id=dialog';
    if (args.style) html += ' '+args.style;
    html += '><div id=dialog-title>'; 
    html += '</div>';
    html += '<div id=dialog-content>';
    html += '</div>';
    html += '<div id=dialog-buttons>';
    html += '</div>';
    html += '</div>';
    this.$div=$(html);
    this.$div.prependTo('body');
    $('#dialog-title').html(args.title);
    $('#dialog-content').html(args.text);
    var buttons = args.buttons || {'Close': function(){return true}};
    for (var n in buttons) {
        var $btn = $('<input type=button value="'+n+'">');
        $btn.data('fun', buttons[n]);
        $btn.click(function(){
            if ($(this).data('fun')()) {
                dialog.close();
                if (args.doAfter) args.doAfter();
            }
        });
        $btn.appendTo($('#dialog-buttons'));
    }
    this.$div.show('fast');
    shortcuts.on('dialog', {
        27: function(){ // 27 : escape
            dialog.close();
        }
    }); 
} 
```

两个通话样本：

```
dialog.open({
    title: 'ccccc Protection Error',
    text: 'There was an error related to cccc Protection. Please consult <a href=../cccc.jsp>this page</a>.',
    style: 'error'
});

var ok = false;
dialog.open({
        title: sometitle,
        text: someHtmlWithInputs,
        buttons: {
            'OK': function() {
                if (// inputs are valid) ok = true;
                return true;
            },
            'Cancel': function() {
                return true;
            }
        },
        doAfter: function() {
            if (ok) {
                if (newvg) {
                    cccmanager.add(vg);
                } else {
                    cccmanager.store();
                }
                if (doAfter) doAfter();
            } 
        }
    }); 
```

正如其他人所指定的，如果您只想制作一个对话框，您可能不需要自己的库。

# algorithm - 在 O(K*log(K)) 中打印给定堆中最大的 K 个元素？

> ID：11209556
> 
> 赞同：15
> 
> 时间：2012-06-26T14:25:30.023
> 
> 标签：algorithm, search, tree, heap, big-o

鉴于以下问题，我不完全确定我当前的解决方案：

**问题 ：**

给定一个包含元素的最大堆`n`，它存储在一个数组`A`中，是否可以打印所有最大的`K`元素`O(K*log(K))`？

**我的回答**：

是的，它是，因为搜索一个元素需要`O(log(K))`，因此这样做

for`K`元素需要 `O(K * log(K))`运行时间。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-26T14:36:24.437

在大小为 N 的堆中搜索元素不是 O(K)。首先，查找*一个*元素的时间复杂度取决于您尝试提取的元素数量（这就是 K 表示的）是没有意义的。此外，没有在堆中搜索这样的事情——除非您将标准的查看每个元素的搜索计算在 O(N) 中。

然而，在堆中找到最大的元素是 O(1) 设计的（我显然假设它是一个最大堆，所以最大元素在堆的顶部），并从堆中删除最大的元素大小 N 为 O(log(N)) （将其替换为叶元素，并让该叶从堆中向下渗透）。

因此，从堆中提取 K 个元素，*并返回未提取元素的堆*，将花费 O(K·log(N)) 时间。

如果从堆中*非破坏性地提取 K 个元素会发生什么？*您可以通过保留堆堆来做到这一点（其中堆的值是其最大元素的值）。最初，这个堆只包含一个元素（原始堆）。要提取下一个最大元素，请提取顶部堆，提取其顶部元素（即最大值），然后将两个子堆重新插入堆中。

这会在每次删除时将堆堆增加一个（删除一个，添加两个），这意味着**它永远不会容纳超过 K 个元素**，因此 remove-one-add-two 将花费 O(log(K) ）。迭代这个，你会得到一个实际的 O(K·log(K)) 算法，它确实返回了前 K 个元素，但无法返回未提取元素的堆。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-26T15:38:28.407

这在最大堆中是可能的，因为您只是从树中打印元素，而不是提取它们。

首先确定位于根节点的最大元素。形成一个指向节点的指针并将其添加到一个空的“最大值”列表中。然后，对于每个`k`值，循环执行以下步骤。

*   从列表中弹出最大元素，取 O(1)。
*   打印它的值，取 O(1)。
*   将此最大元素的每个子元素插入到列表中。插入时保持排序，花费 O(log(size of list)) 时间。这个列表的最大大小，因为我们正在执行这个循环 k 次，是 branch-size*k。因此，这一步需要 O(log(k)) 时间。

总而言之，运行时间为 O(klog(k))，根据需要。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-09-14T06:49:22.250

我发现其他答案令人困惑，所以我决定用一个实际的示例堆来解释它。假设原始堆大小为 N，并且您想找到第 k 个最大的元素，该解决方案需要 O(klogk) 时间和 O(k) 空间。

```
 10 
   /  \
  5    3 
 / \   /\
4   1 2  0
Original Heap, N = 7 
```

想找到第五大元素。k = 5 注意：在新堆中，需要存放指向原堆的指针。这意味着，您不会删除或更改原始堆。原始堆是只读的。因此，您永远不必执行任何需要 O(logN) 时间的操作。

设 x' 是指向原始堆中值 x 的指针。

第一次迭代：将根节点的指针放入新堆

步骤 1：添加指向节点 10 的指针

```
 10'
 New Heap, size = 1, root = 10', root->left = 5, root right->3 
```

打印第一个最大的元素 = 10

第二次迭代：参考原始堆并将其两个子代插入新堆。（存储指向它们的指针而不是值本身）。您要存储指针的原因是，您可以稍后在 O(1) 中从原始堆访问它们以搜索它们的子代，而不是 O(N) 来搜索该值在原始堆中的位置。

Step 2a：从原堆中寻找新堆根节点的左子节点。将左孩子的指针（在本例中为 5'）添加到新堆。

```
 10' 
 /
5'
New Heap, size = 2, root = 10', root->left = 5, root right->3 
```

步骤 2b：从原始堆中寻找新堆根节点的右子节点。将左孩子的指针（在本例中为 3'）添加到新堆。

```
 10' 
 / \
5'  3'
New Heap, size = 3, root = 10', root->left = 5, root right->3 
```

步骤 2c：从新堆中删除根节点。（用最右边的叶子交换最大节点，删除根节点并向下冒泡当前根以保持堆属性）

```
 10'   swap    3'  remove & bubble   5'    
 / \     =>    / \       =>          /
5'  3'        5'  10'               3'
New Heap, size = 2, root = 5', root->left = 4, root right->1 
```

打印第二大元素 = 5

Step 3a：从原堆中寻找新堆根节点的左子节点。将左孩子的指针（在本例中为 4'）添加到新堆。

```
 5'
 / \
3'  4'
New Heap, size = 3, root = 5', root->left = 4, root right->1 
```

Step 3b：从原堆中寻找新堆根节点的右孩子。将左孩子的指针（在本例中为 1'）添加到新堆。

```
 5'
   / \
  3'  4'
 /
1'
New Heap, size = 4, root = 5', root->left = 4, root right->1 
```

步骤 3c：从新堆中删除根节点。（将新堆的最大节点（5'）与其最右边的从新堆的原始堆（1'）交换，删除根节点并向下冒泡当前根以保持堆属性）

```
 5'        Swap     1' remove & bubble     4'
   / \         =>     / \       =>           / \
  3'  4'            3'   4'                 3'  1'
 /                 / 
1'                5'
New Heap, size = 3, root = 4', root->left = NULL, root right->NULL 
```

打印第三大元素 = 4

步骤 4a 和步骤 4b 什么都不做，因为在这种情况下，根节点没有来自原始堆的任何子节点。

步骤 4c：从新堆中删除根节点。（用最右边的叶子交换最大节点，删除根节点并向下冒泡当前根以保持新堆中的堆属性）

```
 4'        Swap     1' remove & bubble     3'
   / \         =>     / \       =>           / 
  3'  1'            3'   4'                 1'  
New Heap, size = 2, root = 3', root->left = 2, root right->0 
```

打印第 4 大元素 = 3

Step 5a：从原堆中寻找新堆根节点的左子节点。将左孩子的指针（在本例中为 2'）添加到新堆。

```
 3'
    / \
   1'  2'
New Heap, size = 3, root = 3', root->left = 2, root right->0 
```

步骤 5b：从原始堆中寻找新堆根节点的右子节点。将左孩子的指针（在本例中为 0'）添加到新堆。

```
 3'
    / \
   1'  2'
  /
 0'
New Heap, size = 4, root = 3', root->left = 2, root right->0 
```

步骤 5c：从新堆中删除根节点。（将最大节点（3'）与新堆中原始堆（即0'）的最右边离开，删除根节点并向下冒泡当前根以保持新堆中的堆属性）

```
 3'    Swap        0'  Remove & Bubble      2'
    / \     =>        / \         =>           / \
   1'  2'            1'  2'                   1'  0'
  /                 /
 0'                3'
New Heap, size = 3, root = 2', root->left = NULL, root->right = NULL 
```

打印第 5 个最大元素 = 2

最后，由于我们经历了 k 次迭代，k = 5。我们现在可以从新堆中提取根元素的值。在这种情况下，值为 2。因此，我们从原始堆中找到了第 k 个最大值。

时间复杂度，T(N,k) = O(klogk) 空间复杂度，S(N,k) = O(k)

希望这可以帮助！

顺志龙，

多伦多大学。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-06-30T12:47:13.540

```
It is a simple and elegant algorithm to get first k elements of a max heap in k log(k) time.

steps:-

1.construct another max heap name it auxiliary heap
2.add root element of main heap to auxiliary heap
3.pop out the element from auxiliary heap and add it's 2 children to the heap
4.do step 2 and 3 till k elements have been popped out from auxiliary heap. Add the popped element's children to the auxiliary heap. 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-26T14:31:38.730

确实，这太容易了，提取最大元素就是`O(log(N))`堆`N`的大小。和`N≠K`。

我将添加搜索随机元素 is`O(N)`和 not `O(Log(N))`，但在这种情况下，我们要提取最大值。

# distribution - 三阶段提交

> ID：11209564
> 
> 赞同：16
> 
> 时间：2012-06-26T14:25:45.000
> 
> 标签：distribution, distributed, distributed-transactions

据我了解，三阶段提交是为了解决“两阶段提交”的问题，因为在第二阶段协调员和队列同时失败，无法知道协调员是否已决定提交消息。

显然，三阶段提交旨在通过添加一个额外的阶段来解决这个问题。但是，如果协调员和队列失败，您在第三阶段不会面临完全相同的问题吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-26T04:58:42.123

在 3PC 中，可以通过查询剩余的活动群组来找出失败的协调器决策。如果任何活动群组处于预提交状态 - 这意味着他们所有人都同意提交（否则协调员不会发送预提交）。我们需要提交其余的队列，因为失败的队列可能已经提交。

如果没有任何群组处于预提交状态 - 我们可以假设协调员没有向任何群组发送“提交”，因此没有发生副作用并且我们可以中止。

这是很好的解释： [http ://the-paper-trail.org/blog/consensus-protocols-three-phase-commit/](http://the-paper-trail.org/blog/consensus-protocols-three-phase-commit/)

# jquery - jQuery 工具提示在 Ajax 调用时停留在屏幕上

> ID：11209566
> 
> 赞同：0
> 
> 时间：2012-06-26T14:25:48.700
> 
> 标签：jquery, jquery-plugins, jquery-tooltip

我正在做一个 Ajax 调用，它将一些 HTML 拉入一个 Div。在我拥有的 div 里面

带有标题的文本。然后我将该标题用作工具提示。

```
$.ajax({
    url: '/feedme.aspx',
    success: function (data) {
        $('#liveContent').html(data);
        $("#liveContent .liveReader").tooltip({ tipClass: 'tool-tip' });

    }
}); 
```

ajax调用返回的内容是

```
<div id="liveContent">
    <div id="item1" class="liveReader" title="item 1"><p>Text 1</p></div>
    <div id="item2" class="liveReader" title="item 2"><p>Text 2</p></div>
</div> 
```

工具提示有效，但是当刷新内容时，工具提示会停留在屏幕上！如何在更新提要之前删除任何工具提示？

实际上，我之前已经使用 Mootools 完成了此操作，但无法找到使用 jQuery 执行此操作的代码，而 jQuery 刚刚转而使用它。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:43:02.640

工具提示插件（我不知道您使用的是哪一个）可能会在`body`标签末尾添加另一个 div，其 ID 可能类似于`tooltip`. ajax 成功回调的第一步应该是隐藏/删除这个 div。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-18T22:52:17.330

当您使用工具提示悬停 div 时，似乎添加了两个“div”。在 Ajax 调用之前添加这两行为我解决了这个问题：

```
$('.tooltip-inner').remove();
$('.tooltip-arrow').remove(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-16T06:13:25.647

fwiw - 我有同样的问题。最好的方法是等到工具提示气泡被卡住，然后使用检查元素（铬，萤火虫）并找到元素的名称，并在任何后续删除之前从那里简单地删除。例如（我的是#tooltip）：

```
$("#tooltip").remove();
/* rest of code here */ 
```

# p2p - 如何在一台笔记本电脑上设置 p2p 共享程序的模拟环境？

> ID：11209575
> 
> 赞同：0
> 
> 时间：2012-06-26T14:26:11.367
> 
> 标签：p2p, multicast

全部！

现在我正在局域网中开发一个 p2p 文件共享程序（我使用 python）。该程序需要向其他对等方发送多播，并与其他人进行对话。但是我只有一台笔记本电脑，那么如何在一台计算机上模拟两个对等方的通信。对等体使用相同的端口和相同的多播端口

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:29:05.390

您可以让每个对等方使用不同的端口！

将端口号作为命令行参数传递，如果未提供，则默认为您当前使用的端口号。

这样，当您可以在具有多台机器的环境中运行时，您无需执行任何其他操作，您的应用程序用户也不必传递端口参数。

或者，您可以使用[ModelNet](http://modelnet.ucsd.edu/)。

# entity-framework - 与流利的 api 的一对一关系。哈克方式？

> ID：11209583
> 
> 赞同：1
> 
> 时间：2012-06-26T14:26:37.607
> 
> 标签：entity-framework, foreign-key-relationship, one-to-one

英孚 4.3.1。我已经定义了`User`实体`Box`。每个框可能分配给用户，也可能不分配给用户。
我想要实现的是在类中有一个`OwnBox`属性，在`User`类中有一个`Owner`属性`Box`。
在数据库中，我`OwnerId`在`Boxes`（`Boxes.OwnerId`与`Users.UserId`）中定义了外键。
为了定义与 fluent api 的关系，我定义了以下类：

```
public partial class User
{
    public int UserId {get; set;}
    public virtual Box OwnBox { get; set; }
}

public partial class Box
{
    public int? OwnerId { get; set; }
    public virtual User User { get; set; }
} 
```

然后在我的 Mapping 类中`Box`，我定义了如下关系：

```
this.HasOptional(t => t.User).WithOptionalDependent(d => d.OwnBox).
    Map(m => m.MapKey("OwnerId")).WillCascadeOnDelete(true); 
```

但是通过启动项目，我得到了错误：

> 指定的架构无效。错误：（56,6）：错误 0019：类型中的每个属性名称必须是唯一的。已定义属性名称“OwnerId”。

所以我不得不告诉 EF 先忘记这个`OwnerId`专栏：

```
this.Ignore(t => t.OwnerId); 
```

现在项目运行良好。但是我仍然怀疑这是否是一种好方法，并且在具有外键关联的 CRUD 操作上一切正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T19:46:20.220

First of all, this is not one-to-one relationship. In one-to-one relationship the foreign key must be a primary key.

I believe in your scenario the situation can happen:

```
User = { UserID = 2 }

Box1 = { UserID = 2 }
Box2 = { UserID = 2 } 
```

Nothing stops you from doing that, but which box should be returned when you do that: User.OwnBox, Box1 or Box2?

EF can deal with that using Independent Association. It will create foreign key, hidden from your POCO class. You can specify the name of the column using MapKey as you did. However, because you also created a property called OnwerID, just as the column used with MapKey, the EF has a problem as two properties are mapped to the same column.

When you use ignore, the POCO OwnerID property is ignored by EF so that fixes the problem of two properties, however, the OwnderID value never gets saved or read to the database. Because EF just ignores it.

Thanks for your question, I have learnt a lot thanks to this.

# mysql - as2 和 "e; 在文本文件中停止读取文本

> ID：11209590
> 
> 赞同：1
> 
> 时间：2012-06-26T14:26:58.713
> 
> 标签：mysql, coldfusion, actionscript-2, flashvars

我有一个文本文件，它通过 flashvars 加载到 swf 中：

*   数据存储在Mysql中，
*   数据使用coldfusion和cfquery存储
*   通过coldfusion将数据读出到文本文件中
*   通过将文件名传递给 flashvars，数据被加载到 swf，然后被读入 actionscript。

问题是，所有文本都被初始化，直到第一个

```
&quote; 
```

而且我不确定如何逃避这一点，我应该在什么时候逃避。

我使用coldfusion存储原始文本，并将数据设置为html编辑格式

```
#HTMLEditFormat(form.content)# />

The boy grinned as he led back to the trail.
&quot;A big un, Granser,&quot; he chuckled 
```

以下是完整的动作脚本

```
// This will be the starting position of the textbox

var starting_ypos:Number;

// Load the Flashvars into the script
text1.text = myVariable;
text2.int = mySecondVariable;

// Make a load vars object
my_data = new LoadVars();

// This will be how fast the text box will scroll 
var scroll_speed:Number = text2.int;

// Make my on load function
my_data.onLoad = function() {

// Fix the double space issue
var my_text = unescape(this.content).split("\r\n");
my_text = my_text.join("\n");
my_text = my_text.split("\r");
my_text = my_text.join("\n");

// Set the text in the text box
scroll_text.Text = my_text;

// Set the autosize
scroll_text.autoSize = true;

// Set the starting_ypos
starting_ypos = scroll_text._y;

};

// Load the external text file
my_data.load(text1.text);

// Start the scrolling
this.onEnterFrame = function() {

// Check for hit test with the mask and the mouse
if(!mask_mc.hitTest(_root._xmouse, _root._ymouse)) {

    // Check to see if we are in the mask
    if(mask_mc.hitTest(scroll_text)) {

        // Move the textbox
        scroll_text._y -= scroll_speed;

    } else {

        // Reset the text box
        stop();

    }

}

}

// Simple stop command 
 stop(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T16:32:24.143

将变量输入到 flash 文件中时，与号用于分隔变量，很像 URL 参数。

所以 flash 是这样写的：

> 男孩笑着带他回到小路上。“一个大联合国，格兰瑟，”他笑着说

像这样：

```
var1 = The boy grinned as he led back to the trail. 
var2 = quot;A big un, Granser,
var3 = quot; he chuckled 
```

尝试使用`URLEncodedFormat(FORM.content)`so 对 flash 的 vars 进行编码。

# c# - C# 组合框选择的索引更改会在另一个组合框中触发旧值

> ID：11209595
> 
> 赞同：0
> 
> 时间：2012-06-26T14:27:11.680
> 
> 标签：c#, .net, combobox

我在这些链接上找到了最接近我的问题的参考：

> [ComboBox 在 Clear() 之后有它的旧值](https://stackoverflow.com/questions/6306719/combobox-has-its-old-value-after-clear)
> [为什么只有在 ListItem 的索引更改后才会触发选定的索引？](https://stackoverflow.com/questions/2406681/why-selected-index-fires-only-once-the-index-of-the-listitem-is-changed)

我有 4 个组合框：`cmbcountry`、`cmbstate`和. 按方法填充加载事件。按方法填充，该方法将's selectedvalue 作为参数并返回相关状态的列表，依此类推 for and ... `cmbdistrict``cmbcity``cmbcountry``GetCountry()``cmbstate``GetState(countryid)``cmbcountry``cmbdistrict``cmbcity`

问题在于在 中选择不同的项目`cmbState`，`cmbDistrct`没有填充正确的项目。

.例如状态：“中央邦”，“外邦”，“拉杰斯坦”

对于“Rajsthan”，cmbdistrict 填充了相关值，但对于“Utter pradesh”，cmbdistrict 仍然具有旧值。

以下是相关代码：

```
private void TestForm1_Load(object sender, EventArgs e)
{
    cmbCountry.ItemSource = Lookups.Lookup.GetCountries();
}

private void cmbCountry_SelectionChangeCommitted(object sender, EventArgs e)
{
    cmbState.Text = "";
    cmbState.Clear();
    cmbState.SelectedIndex = -1;
    cmbState.SelectedItem = null;
    //cmbState.Items.Clear();
    int countryId = Convert.ToInt32(cmbCountry.SelectedValue);
    cmbState.ItemSource = Lookups.Lookup.GetStates(countryId);
}

private void cmbState_SelectionChangeCommitted(object sender, EventArgs e)
{
    cmbDistrict.Text = "";
    cmbDistrict.Clear();
    cmbDistrict.SelectedIndex = -1;
    cmbDistrict.SelectedItem = null;
    //cmbDistrict.Items.Clear();            
    int stateId = Convert.ToInt32(cmbState.SelectedValue);
    cmbDistrict.ItemSource = Lookups.Lookup.GetDistricts(stateId);
}

private void cmbDistrict_SelectionChangeCommitted(object sender, EventArgs e)
{
    cmbCity.Text = "";
    cmbCity.Clear(); 
    cmbCity.SelectedIndex = -1;
    cmbCity.SelectedItem = null;
    //cmbCity.Items.Clear();
    int DistrictId = Convert.ToInt32(cmbDistrict.SelectedValue);
    cmbCity.ItemSource = Lookups.Lookup.GetCities(DistrictId);
}

private void cmbBank_SelectionChangeCommitted(object sender, EventArgs e)
{
    int bankId = Convert.ToInt32(cmbBank.SelectedValue);
    cmbControlBranch.ItemSource = Lookups.Lookup.GetBranches(bankId);
} 
```

我有上述所有方法来清除组合框中的先前数据......如果我使用它，items.clear() 会出错。

请告诉我是否还有其他我遗漏的相关参考资料。

# backbone.js - 在对路由处理程序的后续调用中，骨干视图未正确呈现

> ID：11209598
> 
> 赞同：0
> 
> 时间：2012-06-26T14:27:19.383
> 
> 标签：backbone.js, backbone-views, backbone-routing

我在从路由处理程序（浏览器应用程序）成功呈现主干.js 视图时遇到问题。

我的 javascript 模块当前设置如下：

```
$(function () { // DOM ready
    myModule.Init();
});

var myModule = (function () {

// Models
    var DonorCorpModel = Backbone.Model.extend({ });

// Collections
    var DonorCorpsCollection = Backbone.Collection.extend({ model : DonorCorpModel });

// Views
    var DonorCorpsListView = Backbone.View.extend({
        initialize : function () {
            _.bindAll(this, 'render');
            this.template = Handlebars.compile($('#pre-sort-actions-template').html())
            this.collection.bind('reset', this.render);
        },
        render : function () {
            $(this.el).html(this.template({}));

            this.collection.each(function (donorCorp) {
                var donorCorpBinView = new DonorCorpBinView({
                    model : donorCorp,
                    list : this.collection
                });

                this.$('.donor-corp-bins').append(donorCorpBinView.render().el);
            });

            return this;
        }
    });

    var DonorCorpBinView = Backbone.View.extend({
        tagName : 'li',
        className : 'donor-corp-bin',
        initialize : function () {
            _.bindAll(this, 'render');
            this.model.bind('change', this.render);
            this.template = Handlebars.compile($('#pre-sort-actions-donor-corp-bin-view-template').html());
        },
        render : function () {
            var content = this.template(this.model.toJSON());
            $(this.el).html(content);
            return this;
        }
    })

// Routing
    var App = Backbone.Router.extend({
        routes : {
            '' : 'home',
            'pre-sort' : 'preSort'
        },

        initialize : function () {
            // ...
        },

        home : function () {
            // ...
        },

        preSort : function () {
            if (donorCorps.length < 1) {
                donorCorps.url = 'http://my/api/donor-corps';
                donorCorps.fetch();
            }

            var donorCorpsList = new DonorCorpsListView({ collection : donorCorps }).render().el;
            $('#document-action-panel').empty().append(donorCorpsList);

            // ...
        }
    });

// Private members
    var app;
    var donorCorps = new DonorCorpsCollection();

// Public operations
    return {
        Init: function () { return init(); }
    };

// Private operations
    function init () {
        app = new App();
        Backbone.history.start({ root: '/myApp/', pushState: true });
        docr.navigate('/', { trigger: true, replace: true});
    }

}(myModule || {})); 
```

当我运行应用程序时，一切都运行良好......它按预期导航到主视图。我设置了带有处理程序的链接，以适当地导航到不同的路线，当我运行`app.navigate('pre-sort', { trigger: true, replace: true})`它时，它运行得很好，并按预期呈现列表中的预期项目。

当我尝试*返回*主视图，然后再次返回预排序视图时，问题就出现了……列表中的项目没有像我期望的那样显示在屏幕上。我只是得到`pre-sort-actions-template`没有附加子视图的空渲染。我已经单步执行了代码，并且可以看到集合已填充并且项目在那里......但由于某种原因，我的代码没有正确地将它们呈现到视图中，我似乎无法弄清楚为什么或我做错了什么。有任何想法吗？？我对骨干很陌生，所以我确信这段代码写得并不完全正确……欢迎提供建设性的反馈。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T16:20:52.640

回家后代码如何将其渲染到视图中，然后再次进行预排序？你能提供一些细节吗？重复项目？空视图？

此外，我喜欢在渲染子视图时保留它们的索引，以便父视图始终可以访问它们而不管范围如何。我在这里找到了一个非常好的技术：[Backbone.js Tips : Lessons from the trees](http://devblog.supportbee.com/2011/07/29/backbone-js-tips-lessons-from-the-trenches/)

我所指的模式的快速概述如下：

```
var ParentView = Backbone.View.extend({
    initialize: function () {
        this._viewPointers = {};
    },
    render: function (item) {
        this._viewPointers[item.cid] = new SubView ({
            model: item
        });
        var template = $(this._viewPointers[item.cid].render().el);
        this.$el.append(template);
    }
});

var SubView = Backbone.View.extend({
    initialize: function () {
        this.model.on("change", this.render, this);
    },
    render: function () {
        this.$el.html( _.template($('#templateId').html(), this.model.attributes) );
        return this;
    }
}); 
```

我意识到这个答案相当“宽泛”，但如果我能理解渲染的确切问题，用更多细节来回答会更容易。无论如何，希望它有所帮助:)

# java - 如何在java中包含0的字节中转换用false初始化的bitSet

> ID：11209600
> 
> 赞同：3
> 
> 时间：2012-06-26T14:27:27.873
> 
> 标签：java, byte, bitset

我正在开发一个小型 Java 项目，旨在将一个 BitSet 转换为几个 BitSet，然后将它们转换为几个字节数组：

例如，我希望将 BitSet 分成两部分并将每个部分转换为 int ：

```
 byte[] bytesToBeConverted = {(byte)0x05, (byte)0x00};
    BitSet bitSetToBeConverted = BitSet.valueOf(bytesToBeConverted);

BitSet BitSetPart1 =new BitSet(8);
BitSetPart1=bitSetToBeConverted.get(0,8);
int intPart1 = (int)(BitSetPart1.toByteArray()[0]); //intPart1 ==5

BitSet BitSetPart2 =new BitSet(8);
BitSetPart2 = bitSetToBeConverted.get(8,16);
int intPart2 = (int)(BitSetPart2.toByteArray()[0]); //intPart2 == 0 is wanted 
```

虽然在第一部分（将 bitSetPart1 转换为 intPart1）中确实没有出现问题，但在第二部分中，BitSetpart2 必须使用 false 进行初始化，这会导致在访问 toByteArray() 方法的结果时引发异常：java.lang .ArrayIndexOutOfBoundsException toByteArray 在这种情况下似乎返回 null 。

这是否意味着零是该类型操作的禁止值？在这种情况下，您宁愿扩展 BitSet 类并覆盖 toByteArray() 方法吗？或者创建一个与 BitSet 完全分离的类，并使用额外的方法来克服该问题？

还是有另一种方法来执行我没有提到的那种操作？

非常感谢你的回答！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:33:30.267

来自的Javadoc `toByteArray()`：

> 更准确地说，如果
> 
> ```
> byte[] bytes = s.toByteArray(); 
> ```
> 
> 然后
> 
> ```
> bytes.length == (s.length()+7)/8 
> ```

并来自Javadoc `length()`：

> 返回此 BitSet 的“逻辑大小”：BitSet 中最高设置位的索引加一。如果 BitSet 不包含设置位，则返回零。

由于第二个`BitSet`不包含设置位，因此它返回一个长度为零的数组，正如 Javadoc 明确指定的那样。

如果要将`toByteArray()`out 的结果填充到指定的字节数，请使用`Arrays.copyOf(bitSet.toByteArray(), desiredLength)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:32:53.590

空位集返回一个空数组，因此获取`[0]`确实是非法的。

尝试

```
BitSetPart2 = bitSetToBeConverted.get(8,16);
byte[] temp = BitSetPart2.toByteArray();
int intPart2 = temp.length == 0 ? 0 : (int)(temp[0]); 
```

反而

# c# - NServiceBus 升级 2.5 到 3.2 总是重新安装 MSMQ，有没有办法阻止这种情况？

> ID：11209610
> 
> 赞同：4
> 
> 时间：2012-06-26T14:27:37.263
> 
> 标签：c#, nservicebus

我目前正在更新我们的应用程序以使用 NServiceBus 3.2 而不是我们一直在使用的 2.5。我遇到的问题是，当我参考 3.2 运行服务时，它在创建性能计数器时出现问题，这导致我运行 RunMeFirst.bat 来创建计数器。

完成此操作后，服务将按预期运行，但问题是 RunMeFirst.bat 总是在我们的环境中重新安装 MSMQ，这反过来又会删除所有存在的队列/消息。在生产环境中，这对我们来说并不是一个真正的选择，所以可以通过安装性能计数器但不必重新安装 MSMQ 的方式来做，这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T12:35:06.443

指导方针是只在新机器上调用 RunMeFirst.bat 以避免您提到的问题。也就是说，我们计划在这方面改进我们的基础设施安装程序：

[https://github.com/NServiceBus/NServiceBus/issues/651](https://github.com/NServiceBus/NServiceBus/issues/651)

# nosql - Redis 通过字段值查找哈希

> ID：11209613
> 
> 赞同：10
> 
> 时间：2012-06-26T14:27:47.330
> 
> 标签：nosql, redis

使用 Redis 创建“记录”时，您可以创建包含多个字段的哈希。例如：

```
HMSET myhash field1 "Hello" field2 "World"
HMSET myhash2 field1 "Goodbye" field2 "World" 
```

您可以通过知道键值来检索它，但是我想知道有没有办法检索在 field2 中具有“世界”的所有散列？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-26T14:36:00.290

redis中没有索引，也没有实现SQL。这是一个键值存储。你提供一个键，它就会给你一个值。

也就是说，您可以通过自己维护二级索引来实现这一点。例如：

创建记录和索引条目

```
HMSET myhash field1 Hello field2 World
SADD field2_world myhash 
```

更新记录，删除旧的索引条目，创建新的

```
SREM field2_world myhash
HMSET myhash field2 Mundo
SADD field2_mundo myhash 
```

查找所有包含“世界”的记录`field2`

```
SMEMBERS field2_world 
```

我希望你能明白。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-12T16:09:56.583

对于下一位读者，[SORT 命令](https://redis.io/commands/sort)可能有助于使用“BY 模式”参数

```
HMSET myhash field1 Hello field2 World
SORT myhash BY World 
```

[模式示例 (w3resource)](https://www.w3resource.com/redis/redis-key-pattern.php)

# ruby-on-rails - 有没有办法缓存 .all 调用？

> ID：11209617
> 
> 赞同：5
> 
> 时间：2012-06-26T14:27:57.213
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, caching

例如，我的索引控制器中有这个

```
@users = User.current 
```

这是我的用户模型

```
 scope :current, :conditions => { :active => true }, :order => 'LOWER(first_name), LOWER(last_name) ASC' 
```

这基本上是抓取所有记录并且我没有分页，因为我使用的是具有出色过滤器搜索功能的 jquery datatables 表......我想要实现的问题是尽可能缓存这些，除非有新用户......这并不经常发生

我读到了fresh_when，但不知道这里可以使用什么

**更新**

按照下面的答案后，我在日志中看不到缓存，我看到的是

```
 Company Load (0.4ms)  SELECT `companies`.* FROM `companies` INNER JOIN `positions` ON `companies`.`id` = `positions`.`company_id` WHERE `positions`.`user_id` = 551
  Company Load (0.4ms)  SELECT `companies`.* FROM `companies` INNER JOIN `positions` ON `companies`.`id` = `positions`.`company_id` WHERE `positions`.`user_id` = 93
  Company Load (0.4ms)  SELECT `companies`.* FROM `companies` INNER JOIN `positions` ON `companies`.`id` = `positions`.`company_id` WHERE `positions`.`user_id` = 668 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T14:31:45.440

```
class User < ActiveRecord::Base
  after_save :clear_cache

  def self.current
    Rails.cache.fetch("current_users", expires_in: 1.hour) do
      User.where(active: true).order("LOWER(first_name), LOWER(last_name) ASC").all
    end
  end

private

  def clear_cache
    Rails.cache.delete("current_users")
  end

end 
```

确保在 config/environments/*.rb 中启用了缓存：

```
config.action_controller.perform_caching = true 
```

这就是你想要的。在这里阅读更多：
[http ://robotmay.com/post/23161612605/everyone-should-be-using-low-level-caching?bda26d48](http://robotmay.com/post/23161612605/everyone-should-be-using-low-level-caching?bda26d48)
[http://www.tmatthew.net/blog/rails-caching-example](http://www.tmatthew.net/blog/rails-caching-example)
[http： //api.rubyonrails.org/classes/ActiveSupport/Cache/Store.html#method-i-fetch](http://api.rubyonrails.org/classes/ActiveSupport/Cache/Store.html#method-i-fetch)

在缓存中存储模型时，您可能会遇到一个奇怪的问题，即在加载模型之前获取缓存时发生的问题。不用担心，这只会在开发中发生，并且有一个修复（application_controller.rb）：

```
before_filter :load_models_if_dev
def load_models_if_dev
    if Rails.env == 'development'
        User; Post; Comment # whatever other classes that can get cached.
    end
end 
```

**更新**
注意`.all`in `User.where().order().all`。没有它，存储在缓存中的值只是一个 ActiveRecord 关系而不是实际结果。没有 .all 查询仍然必须运行。感谢@Frederick Cheung 引起我们的注意。

# java - Java JAR 导出图像文件夹错误

> ID：11209621
> 
> 赞同：1
> 
> 时间：2012-06-26T14:28:07.440
> 
> 标签：java, eclipse, image, executable-jar

感谢您阅读本文以及您给我的任何帮助。嗯...我正在使用 Eclipse，我正在尝试将我的项目导出为 .jar。

问题是......我有一个在 Eclipse 中作为类文件夹在我命名为“res”的构建路径中列出的文件夹。res 文件夹内还有另一个名为“Images”的文件夹。当我导出我的 .JAR 并查看其中的文件时，我看到的只是图像文件夹，而不是 res，这会弄乱我在项目中的图像加载方法。

关于如何以不同方式导出 res 文件夹或如何使我的图像方法在 Eclipse 的测试模式和 .jar 中正常工作，是否有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:36:55.873

您的图像应该位于源文件夹中（我们称之为“资源”），并遵守与 Java 源文件相同的包层次结构规则。

如果您使用 加载图像`SomeClass.class.getResourceAsStream("/res/images/foo.png")`，则资源源文件夹中必须有一个名为“res”的包，其中包含一个名为“images”的包，其中包含`foo.png`：

```
src <- source folder
   com
      foo
         bar
           Application.java
           SomeClass.java
resources <- source folder
   res
      images
         foo.png 
```

生成的 jar 文件将如下所示：

```
theJar.jar
   com
      foo
         bar
           Application.class
           SomeClass.class
   res
      images
         foo.png 
```

# msbuild - NuGet 2.0 中我的 .csproj 文件中的新参考项是什么？

> ID：11209623
> 
> 赞同：0
> 
> 时间：2012-06-26T14:28:12.367
> 
> 标签：msbuild, nuget, csproj

我们的一个底层项目通过 NuGet 打包并分发（内部），以便其他团队可以使用该库 - 我们称之为“核心”。在 NuGet 1.x 中，我们在 .csproj 文件中获得了如下所示的引用：

```
<Reference Include="Core">
    <SpecificVersion>False</SpecificVersion>
<HintPath>..\packages\Core.1.4.1.381\lib\net40\Core.dll</HintPath> 
```

升级到 NuGet 2.0 后，相同的参考如下所示：

```
<Reference Include="Core, Version=1.4.1.381, Culture=neutral, processorArchitecture=MSIL">
    <SpecificVersion>False</SpecificVersion>
<HintPath>..\packages\Core.1.4.1.381\lib\net40\Core.dll</HintPath> 
```

在`Include`属性中，版本是否重要？我明确设置`SpecificVersion`为假。我查看了[MSBuild Project File Schema Reference](http://msdn.microsoft.com/en-us/library/5dy88c2e)，但没​​有看到有关如何解析此属性的任何内容。

感谢您对此的意见。

-SethO

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T09:24:11.333

我在VS2010下试过，如果你指定：

```
<SpecificVersion>False</SpecificVersion> 
```

下面的版本`<Reference></Reference>`被忽略。

# iphone - 如何正确地将标签放在一行

> ID：11209628
> 
> 赞同：1
> 
> 时间：2012-06-26T14:28:31.827
> 
> 标签：iphone, objective-c, ipad

我有三个`UILabel`不同的字体，我想把它们放在一行上。

问题是由于那些标签的文本长度不固定，我必须根据之前标签的文本长度更改第二个和第三个标签的位置，否则文本会重叠。

我打算根据之前标签的文字长度设置位置，我必须识别大写和小写。如果我使用其他语言，我必须考虑更多。

我想知道有没有更好的方法来解决这个问题，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:56:26.097

```
CGSize size = [@"SomeString" sizeWithFont:[UIFont systemFontOfSize:20.0]];
CGFloat width = size.width; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:30:18.793

查看 CoreText 框架。与使用 UILabel 相比，您将能够更好地控制您的文本特征。

开发者参考： [https ://developer.apple.com/library/mac/#documentation/StringsTextFonts/Conceptual/CoreText_Programming/Introduction/Introduction.html](https://developer.apple.com/library/mac/#documentation/StringsTextFonts/Conceptual/CoreText_Programming/Introduction/Introduction.html)

教程： [http ://www.raywenderlich.com/4147/how-to-create-a-simple-magazine-app-with-core-text](http://www.raywenderlich.com/4147/how-to-create-a-simple-magazine-app-with-core-text)

# php - 用于检查粉丝页面的 PHP 代码有时工作有时不工作

> ID：11209636
> 
> 赞同：0
> 
> 时间：2012-06-26T14:28:49.550
> 
> 标签：php, javascript, facebook

我在下面有脚本来检查用户是否是我的粉丝页面。如果是，他们将被重定向到另一个页面。如果没有，他们将在继续之前显示一个喜欢的框来喜欢该页面。

该脚本有时有效，但有时无效。我希望这与 header() 有问题，因为它出现 500 内部服务器错误。但是，我已经放了 ob_start()。这不应该解决问题吗？

```
<?
ob_start();
require_once('../../src/facebook.php');

$app_id = "APP_ID";
$app_secret = "APP_SECRET";

// Init facebook api.
$facebook = new Facebook(array(
    'appId' => $app_id,
    'secret' => $app_secret,
    'cookie' => false,
));

//Facebook Authentication part
$user_id = $facebook->getUser();
    $loginUrl   = $facebook->getLoginUrl(
        array(
            'scope'         => 'publish_stream, user_likes'
        )
);

if (!$user_id) {
    echo "<script type='text/javascript'>top.location.href = '$loginUrl';</script>";
    exit;
}

$likes = $facebook->api("/me/likes/PAGE_ID");
if( !empty($likes['data']) ){
    ob_end_clean();
    header ('location: xyz.php');      //if is a fan, redirect to xyz.php
    exit;
} else {
    continue;                          //if not a fan, show below html code
}

?>

<HTML>
.
.
Please like page first
.
.
</HTML> 
```

# jquery-mobile - Jquery Mobile 对齐文本框

> ID：11209638
> 
> 赞同：0
> 
> 时间：2012-06-26T14:28:50.843
> 
> 标签：jquery-mobile

我有以下带有文本框的列表视图。我想获得与 ipad 相同的感觉。如何对齐文本框，使其正好在彼此下方。目前它看起来不匹配。

```
 <ul data-role="listview" data-inset="true" style="width:30%;">
  <li data-role="fieldcontain">
  <label for="name">First Name:</label>
        <input type="text" name="fname" id="fname" value=""    />            
  </li>

        <li data-role="fieldcontain">
  <label for="name">MI:</label>
        <input type="text" name="mi" id="mi" value="" style="width:5%;"  />                
  </li>
      </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T16:57:21.167

不知道为什么需要为 ul 和 input 标签设置样式。但我已经把你可以实现的不同风格的小提琴放在一起。
[http://jsfiddle.net/nachiket/nnRPv/](http://jsfiddle.net/nachiket/nnRPv/)
是否有任何帮助？

# c# - 我可以在单元测试中写入控制台吗？如果是，为什么控制台窗口没有打开？

> ID：11209639
> 
> 赞同：183
> 
> 时间：2012-06-26T14:28:50.913
> 
> 标签：c#, .net, visual-studio, unit-testing, console-application

我在 Visual Studio 中有一个测试项目。我使用*Microsoft.VisualStudio.TestTools.UnitTesting*。

我在我的一个单元测试中添加了这一行：

```
Console.WriteLine("Some foo was very angry with boo");
Console.ReadLine(); 
```

当我运行测试时，测试通过了，但控制台窗口根本没有打开。

有没有办法让控制台窗口可以通过单元测试进行交互？

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2016-07-14T14:15:34.617

有人评论了 Visual Studio 2013 中这个明显的新功能。起初我不确定他的意思，但现在我知道了，我认为它应该得到自己的答案。

我们可以正常使用 Console.WriteLine 并显示输出，只是不在输出窗口中，而是在测试详情中单击“输出”后在新窗口中显示。

[![在此处输入图像描述](../Images/761f316372caa10edb471e9f7ca59989.png)](https://i.stack.imgur.com/VqYXj.png)

* * *

## 回答 #2

> 赞同：139
> 
> 时间：2012-06-26T14:39:18.993

注意：下面的原始答案应该适用于从 Visual Studio 2012 开始的任何版本的 Visual Studio。Visual Studio 2013 似乎不再有测试结果窗口。相反，如果您需要特定于测试的输出，您可以使用@Stretch 的建议`Trace.Write()`将输出写入输出窗口。

* * *

该`Console.Write`方法不写入“控制台”——它写入连接到正在运行进程的标准输出句柄的任何内容。同样，`Console.Read`从连接到标准输入的任何内容中读取输入。

通过 Visual Studio 2010 运行单元测试时，标准输出由测试工具重定向并存储为测试输出的一部分。您可以通过右键单击“测试结果”窗口并将名为“Output (StdOut)”的列添加到显示中来看到这一点。这将显示写入标准输出的任何内容。

您*可以使用*[P/Invoke](https://en.wikipedia.org/wiki/Platform_Invocation_Services)手动打开控制台窗口，如[sinni800 所说](https://stackoverflow.com/questions/11209639/can-i-write-into-the-console-in-a-unit-test-if-yes-why-doesnt-the-console-win/11209736#11209736)。通过阅读`AllocConsole`文档，该函数似乎将重置`stdin`并`stdout`处理以指向新的控制台窗口。（我对此不是 100% 确定；如果我已经重定向`stdout`到 Windows 以从我这里窃取它，这对我来说似乎有点错误，但我没有尝试过。）

不过，总的来说，我认为这是一个坏主意。如果您只想使用控制台转储有关单元测试的更多信息，那么输出就在那里。继续使用`Console.WriteLine`您的方式，并在完成后检查“测试结果”窗口中的输出结果。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2012-06-26T16:55:50.573

您可以使用此行写入Visual Studio 的[输出窗口](http://www.dotnetperls.com/debug-write)：

```
System.Diagnostics.Debug.WriteLine("Matrix has you..."); 
```

必须在调试模式下运行。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2012-06-26T15:03:27.903

如前所述，单元测试旨在无需交互即可运行。

但是，您可以*调试*单元测试，就像任何其他代码一样。最简单的方法是使用`Debug`“测试结果”选项卡中的按钮。

能够调试意味着能够使用断点。因此，能够使用断点意味着能够使用**[Tracepoints](http://msdn.microsoft.com/en-us/library/232dxah7.aspx)**，我发现它在日常调试中非常有用。

本质上，跟踪点允许您写入*输出*窗口（或更准确地说，写入标准输出）。或者，您可以继续运行，也可以像常规断点一样停止。这为您提供了您所要求的“功能”，而无需重新构建代码或用调试信息填充它。

只需添加一个断点，然后右键单击该断点。选择“当命中...”选项：

![点击选项时](../Images/111934d94bab86317194849ffdd8e007.png)

这带来了对话框：

![遇到断点时](../Images/1a91b257702146aa6425a85c0ef22570.png)

需要注意的几点：

1.  请注意，断点现在显示为菱形，而不是球体，表示跟踪点
2.  您可以通过像 {this} 一样将其括起来来输出变量的值。
3.  取消选中“继续执行”复选框以在此行中断代码，就像任何常规断点一样
4.  您可以选择运行宏。请小心 - 你可能会导致有害的副作用。

有关更多详细信息，请参阅文档。

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2016-03-08T19:33:14.153

有几种方法可以在 C# 中编写 Visual Studio 单元测试的输出：

*   Console.Write - 当您在测试资源管理器中选择测试并单击输出链接时，Visual Studio 测试工具将捕获并显示它。在运行或调试单元测试时不会显示在 Visual Studio 输出窗口中（可以说这是一个错误）*。*
*   Debug.Write - Visual Studio 测试工具将捕获此内容并将其显示在测试输出中。*调试*单元测试时会出现在 Visual Studio 输出窗口中，除非将 Visual Studio 调试选项配置为将输出重定向到即时窗口。如果您只是在没有调试的情况下运行测试，则输出（或立即）窗口中不会出现任何内容。默认情况下，仅在 Debug 构建中可用（即定义 DEBUG 常量时）。
*   Trace.Write - Visual Studio 测试工具将捕获此内容并将其显示在测试输出中。调试单元测试时会出现在 Visual Studio 输出（或立即）窗口中（但在没有调试的情况下仅运行测试时不会出现）*。*默认情况下在 Debug 和 Release 版本中都可用（即，在定义 TRACE 常量时）。

在 Visual Studio 2013 Professional 中确认。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2014-03-25T16:22:15.847

您可以使用

```
Trace.WriteLine() 
```

在调试单元测试时写入*输出*窗口。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2017-07-13T15:31:50.673

在 Visual Studio 2017 中，“TestContext”不会在测试资源管理器中显示输出链接。

但是， Trace.Writeline() 显示输出链接。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-06-26T14:34:54.823

首先，根据**设计**，单元测试应该在没有交互的情况下完全运行。

除此之外，我认为没有考虑过这种可能性。

您可以尝试使用[AllocConsole P/Invoke](http://www.pinvoke.net/default.aspx/kernel32.allocconsole)进行破解，即使您当前的应用程序是 GUI 应用程序，它也会打开一个控制台。然后该`Console`课程将发布到现在打开的控制台。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-08-21T07:23:35.903

Debug.WriteLine() 也可以使用。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-12-10T19:57:57.977

恕我直言，在大多数情况下，输出消息仅与*失败的测试用例*相关。我制作了以下格式，您也可以自己制作。这显示在 Visual Studio 测试资源管理器窗口本身中。

我们如何在 Visual Studio 测试资源管理器窗口中抛出此消息？

像这样的示例代码应该可以工作：

```
if(test_condition_fails)
    Assert.Fail(@"Test Type: Positive/Negative.
                Mock Properties: someclass.propertyOne: True
                someclass.propertyTwo: True
                Test Properties: someclass.testPropertyOne: True
                someclass.testPropertyOne: False
                Reason for Failure: The Mail was not sent on Success Task completion."); 
```

您可以为您专门开设一个单独的课程。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-06-16T21:11:52.373

我有一个更简单的解决方案（出于许多懒惰的原因，我最近使用了自己）。将此方法添加到您正在使用的类中：

```
public static void DumbDebug(string message)
{
    File.WriteAllText(@"C:\AdHocConsole\" + message + ".txt", "this is really dumb. I wish Microsoft had more obvious solutions to its solutions problems.");
} 
```

然后...打开目录 AdHocConsole，并按创建时间排序。确保在添加“打印声明”时。虽然它们是不同的，否则会有杂耍。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-07-02T23:34:33.037

### 适用于 Mac 的 Visual Studio

*其他解决方案均不适用于 Visual Studio for Mac*

如果您使用的是**NUnit**，您可以将一个小型`.NET` **控制台项目**添加到您的解决方案中，然后在该新**控制台项目的****引用**中引用您希望测试的项目。

 **无论您在`[Test()]`方法中做什么，都可以在`Main`控制台应用程序中以这种方式完成：

```
class MainClass
{
    public static void Main(string[] args)
    {
        Console.WriteLine("Console");

        // Reproduce the unit test
        var classToTest = new ClassToTest();
        var expected = 42;
        var actual = classToTest.MeaningOfLife();
        Console.WriteLine($"Pass: {expected.Equals(actual)}, expected={expected}, actual={actual}");
    }
} 
```

* * *

在这些情况下，您可以自由使用`Console.Write`和`Console.WriteLine`在您的代码中。**

# regex - 用正则表达式替换一个字符

> ID：11209643
> 
> 赞同：3
> 
> 时间：2012-06-26T14:29:05.627
> 
> 标签：regex, replace, sed

有很多方法可以用一个字符替换多个字符。

```
s/a\{100\}/a/ 
```

有什么方法可以在不输入100 次的情况下将其替换为反之亦然（一个`a`与100 次） ？`a``a`

附言。我在`sed`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T15:07:16.337

怎么样：

```
sed ':x;/a\{100\}/b;s/a/aa/;tx' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:43:24.300

不像你想要的那样简洁，但你可以做这样的事情：

```
sed -e 's/a/aaaaaaaaaa/' -e 's/\(aaaaaaaaaa\)/\1\1\1\1\1\1\1\1\1\1/' 
```

基本上用其中的 10 个替换原件`a`，然后用 10 个副本替换 10 个的序列。对于 100 以外的数字，显然，你会以不同的方式考虑它。

# python - 瀑布图python？

> ID：11209646
> 
> 赞同：20
> 
> 时间：2012-06-26T14:29:14.920
> 
> 标签：python, matlab, numpy, matplotlib, scipy

是否有一个 python 模块可以像 MATLAB 那样做瀑布图？我用谷歌搜索了“numpy 瀑布”、“scipy 瀑布”和“matplotlib 瀑布”，但没有找到任何东西。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-27T07:26:22.577

您可以使用[PolyCollection](https://matplotlib.org/api/collections_api.html?highlight=polycollection#matplotlib.collections.PolyCollection)类在 matplotlib 中制作瀑布图。请参阅此特定[示例](https://matplotlib.org/examples/mplot3d/polys3d_demo.html)以获取有关如何使用此类执行瀑布的更多详细信息。

此外，您可能会发现这篇[博](http://austringer.net/wp/index.php/2011/05/20/plotting-a-dolphin-biosonar-click-train/)文很有用，因为作者表明您可能会在某些特定情况下获得一些“视觉错误”（取决于选择的视角）。

下面是一个使用 matplotlib 制作的瀑布示例（图片来自博客文章）：（ [来源：][[austringer.net](http://austringer.net/images/biosonar/wfall_demo.png)][）][![图片](../Images/4449cae6ed581f3bc628b64045776686.png)](https://i.stack.imgur.com/sqRcC.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-26T14:45:45.413

看看[mplot3d](http://matplotlib.sourceforge.net/mpl_toolkits/mplot3d/tutorial.html#wireframe-plots)：

```
# copied from 
# http://matplotlib.sourceforge.net/mpl_examples/mplot3d/wire3d_demo.py

from mpl_toolkits.mplot3d import axes3d
import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
X, Y, Z = axes3d.get_test_data(0.05)
ax.plot_wireframe(X, Y, Z, rstride=10, cstride=10)

plt.show() 
```

![http://matplotlib.sourceforge.net/mpl_toolkits/mplot3d/tutorial.html#wireframe-plots](../Images/fa91fbd145ca3cb8ba30113e4b3b6ce6.png)

我不知道如何获得像 Matlab 一样好的结果。

* * *

如果你想要更多，你也可以看看[MayaVi](http://matplotlib.sourceforge.net/mpl_toolkits/mplot3d/faq.html#how-is-mplot3d-different-from-mayavi)：[http ://mayavi.sourceforge.net/](http://mayavi.sourceforge.net/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-28T12:43:02.443

维基百科类型的[瀑布图](http://en.wikipedia.org/wiki/Waterfall_chart)也可以这样获得：

```
import numpy as np
import pandas as pd

def waterfall(series):
    df = pd.DataFrame({'pos':np.maximum(series,0),'neg':np.minimum(series,0)})
    blank = series.cumsum().shift(1).fillna(0)
    df.plot(kind='bar', stacked=True, bottom=blank, color=['r','b'])
    step = blank.reset_index(drop=True).repeat(3).shift(-1)
    step[1::3] = np.nan
    plt.plot(step.index, step.values,'k')

test = pd.Series(-1 + 2 * np.random.rand(10), index=list('abcdefghij'))
waterfall(test) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-06-22T01:00:14.397

我已经生成了一个函数，可以复制 matplotlib 中的 matlab 瀑布行为。那是：

1.  它生成 3D 形状，因为它有许多独立和平行的 2D 曲线
2.  它的颜色来自 z 值中的颜色图

我从 matplotlib 文档中的两个示例开始：[多色线](https://matplotlib.org/gallery/lines_bars_and_markers/multicolored_line.html)和[3d plot 中的多条线](https://matplotlib.org/examples/mplot3d/polys3d_demo.html)。从这些示例中，我只看到可以根据示例后面的 z 值绘制颜色在给定颜色图之后变化的线条，这正在重塑输入数组以通过 2 个点的线段绘制线并将线段的颜色设置为这两个点之间的 z 平均值。

因此，给定输入矩阵`n,m`matrixes和`X`，函数在 之间的最小维度上循环，以将每个瀑布图独立线绘制为 2 个点段的线集合，如上所述。`Y``Z``n,m`

```
def waterfall_plot(fig,ax,X,Y,Z,**kwargs):
    '''
    Make a waterfall plot
    Input:
        fig,ax : matplotlib figure and axes to populate
        Z : n,m numpy array. Must be a 2d array even if only one line should be plotted
        X,Y : n,m array
        kwargs : kwargs are directly passed to the LineCollection object
    '''
    # Set normalization to the same values for all plots
    norm = plt.Normalize(Z.min().min(), Z.max().max())
    # Check sizes to loop always over the smallest dimension
    n,m = Z.shape
    if n>m:
        X=X.T; Y=Y.T; Z=Z.T
        m,n = n,m

    for j in range(n):
        # reshape the X,Z into pairs 
        points = np.array([X[j,:], Z[j,:]]).T.reshape(-1, 1, 2)
        segments = np.concatenate([points[:-1], points[1:]], axis=1)  
        # The values used by the colormap are the input to the array parameter
        lc = LineCollection(segments, cmap='plasma', norm=norm, array=(Z[j,1:]+Z[j,:-1])/2, **kwargs)
        line = ax.add_collection3d(lc,zs=(Y[j,1:]+Y[j,:-1])/2, zdir='y') # add line to axes

    fig.colorbar(lc) # add colorbar, as the normalization is the same for all
    # it doesent matter which of the lc objects we use
    ax.auto_scale_xyz(X,Y,Z) # set axis limits 
```

因此，可以使用与 matplotlib 曲面图相同的输入矩阵轻松生成看起来像 matlab 瀑布的图：

```
import numpy as np; import matplotlib.pyplot as plt
from matplotlib.collections import LineCollection
from mpl_toolkits.mplot3d import Axes3D

# Generate data
x = np.linspace(-2,2, 500)
y = np.linspace(-2,2, 60)
X,Y = np.meshgrid(x,y)
Z = np.sin(X**2+Y**2)-.2*X
# Generate waterfall plot
fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
waterfall_plot(fig,ax,X,Y,Z,linewidth=1.5,alpha=0.5) 
ax.set_xlabel('X'); ax.set_ylabel('Y'); ax.set_zlabel('Z') 
fig.tight_layout() 
```

[![默认瀑布](../Images/3692b4300b759345306634b7727e2ac6.png)](https://i.stack.imgur.com/PtfJp.png)

该函数假设在生成网格网格时，`x`数组是最长的，默认情况下，线的 y 是固定的，x 坐标是变化的。但是，如果`y`数组的大小较长，则矩阵会被转置，从而生成具有固定 x 的线。因此，生成尺寸倒置 (`len(x)=60`和`len(y)=500`) 的网格网格会产生：

[![非默认瀑布](../Images/361d5689b89ee9cb0ef68aced6663cc8.png)](https://i.stack.imgur.com/kD6Av.png)

要查看`**kwargs`参数的可能性，请参阅[LineCollection 类文档](https://matplotlib.org/api/collections_api.html#matplotlib.collections.LineCollection)及其[`set_`方法](https://matplotlib.org/api/collections_api.html#matplotlib.collections.LineCollection.set)。

# ios - 使用 CADisplayLink 的快速自定义动画会导致频闪效果。如何避免？

> ID：11209649
> 
> 赞同：0
> 
> 时间：2012-06-26T14:29:23.297
> 
> 标签：ios, uiscrollview, core-animation

设想：

使用重用的页面视图水平滚动 UIScrollView（因此只有少数页面视图控制器像 UITableView 单元格一样被重用）。为了使它们能够更新新内容并重复使用，我需要知道 UIScrollView 内容视图的确切位置（偏移量）。这很好用。

现在我需要实现自定义滚动动画 - 我的意思是以编程方式移动内容视图，以便用户触摸一些按钮，并且滚动视图使用此自定义动画滚动到所需位置。运动可以非常快而且非常远。我不能为此使用核心动画，因为我无法在动画期间跟踪位置（CA 报告您只报告运动的开始和结束）。所以我决定使用**CADisplayLink**，并计算每个位置的每个 UIScrollView 内容。这也很好用。

唯一的问题是，有时我会看到**频闪效应**- 比如说我将内容向右移动，看起来它正在向左移动。**如果我使用setContentOffset:animated:**查看 UISCrollView 中的内置动画，则动画流畅且美观。有谁知道，如何摆脱这种频闪效应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-12T06:53:53.353

您的问题很可能是时间戳是 a`double`并且您将其分配给 a`float`

浮点数有 7 位，而双打有 15-16 位。

因此，换句话说，您正在经历数据丢失。通过使用 double 你应该看到一个丝般平滑的动画。

# grails - Grails 上的 spring-security-oauth2-provider 提供程序

> ID：11209650
> 
> 赞同：1
> 
> 时间：2012-06-26T14:29:24.560
> 
> 标签：grails, oauth-2.0

我需要公开我的 Grails Web 应用程序的特定 URL。但是，我希望它受到 OAuth2 客户端凭据流（grant_type）的保护。准确地说，外部代理会向类似的东西发送请求

```
http://server-url/oauth/token?client_id=clientId&client_secret=clientSecret&grant_type=client_credentials 
```

并获得一个access_token。然后，我的 URL（受保护的资源）应该可以通过类似的方式访问

```
http://server-url/resource?access_token={access-token obtained before} 
```

到目前为止，我的方法涉及使用这个 grails 插件（spring-security-oauth2-provider：[http://grails.org/plugin/spring-security-oauth2-provider](http://grails.org/plugin/spring-security-oauth2-provider)）。

按照[https://github.com/adaptivecomputing/grails-spring-security-oauth2-provider](https://github.com/adaptivecomputing/grails-spring-security-oauth2-provider)提供的文档，我已经能够设置授予 access_token 部分（注册的客户端能够通过提供其 id 来获取访问令牌和秘密。但是，我无法从教程中了解如何保护给定资源（仅使用访问令牌限制对客户端的访问）。

上面的文档链接只提到了设置访问令牌分发的阶段，然后转到用户批准（我不需要）。

关于如何进行的任何指示都会很好。或者，也欢迎有关满足要求的任何其他选项的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T16:10:13.447

grails 插件是 spring 安全插件[spring-security-oauth](https://github.com/SpringSource/spring-security-oauth)的一个包装，请查看 spring-security-oauth 文档。我假设您已经熟悉 ouath2 规范，如果没有阅读请[在此处输入链接描述](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-27)，甚至[google oauth2 API](https://developers.google.com/accounts/docs/OAuth2)也是 google 文档示例。你正在使用的插件没有更新到 spring-security-oauth 的最后一个版本，如果你想看看我已经在[github上 fork 和更新了它](https://github.com/ftaiolivista/grails-spring-security-oauth2-provider)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T19:33:59.297

您可以使用 spring-security-core 来保护您的资源。示例：可以在 Requestmap 中列出 url 路径。

```
new Requestmap(url: '/api/v1/states/**', configAttribute: 'ROLE_USER,ROLE_USER').save()
new Requestmap(url: '/api/v1/subscriptions/**', configAttribute: 'ROLE_USER,ROLE_USER').save()
new Requestmap(url: '/api/v1/surveys/**', configAttribute: 'ROLE_USER,ROLE_USER').save() 
```

我已经使用 grails 插件“spring-security-oauth2-provider:1.0.0.M5.1”进行了测试。

# plone - 在时事通讯主题中添加时事通讯时，Plone Gazatte 抛出回溯

> ID：11209652
> 
> 赞同：1
> 
> 时间：2012-06-26T14:29:31.167
> 
> 标签：plone

我正在使用克隆 4.1.3。我安装了没有任何挂载点的 PloneGazatte 产品，它工作正常。在同一版本中，我创建了**挂载点**并安装了产品。当我在时事通讯主题中创建时事通讯时，它会引发回溯错误。

谁能帮我解决这些错误？

```
Traceback (innermost last):
  Module ZPublisher.Publish, line 126, in publish
  Module ZPublisher.mapply, line 77, in mapply
  Module ZPublisher.Publish, line 46, in call_object
  Module Products.CMFFormController.FSControllerPythonScript, line 105, in __call__
  Module Products.CMFFormController.Script, line 145, in __call__
  Module Products.CMFCore.FSPythonScript, line 130, in __call__
  Module Shared.DC.Scripts.Bindings, line 322, in __call__
  Module Shared.DC.Scripts.Bindings, line 359, in _bindAndExec
  Module Products.PythonScripts.PythonScript, line 344, in _exec
  Module script, line 31, in createObject
   - <FSControllerPythonScript at /en/indg.in/createObject used for /en/indg.in/indg-newsletter>
   - Line 31
  Module Products.CMFCore.PortalFolder, line 295, in invokeFactory
  Module Products.CMFCore.TypesTool, line 835, in constructContent
  Module Products.CMFCore.TypesTool, line 313, in constructInstance
  Module Products.CMFCore.TypesTool, line 554, in _constructInstance
  Module Products.PloneGazette.Newsletter, line 81, in addNewsletter
  Module OFS.ObjectManager, line 356, in _setObject
  Module zope.event, line 31, in notify
  Module zope.component.event, line 24, in dispatch
  Module zope.component._api, line 136, in subscribers
  Module zope.component.registry, line 321, in subscribers
  Module zope.interface.adapter, line 585, in subscribers
  Module zope.component.event, line 32, in objectEventNotify
  Module zope.component._api, line 136, in subscribers
  Module zope.component.registry, line 321, in subscribers
  Module zope.interface.adapter, line 585, in subscribers
  Module Products.CMFCore.CMFCatalogAware, line 265, in handleContentishEvent
  Module Products.CMFCore.CMFCatalogAware, line 191, in notifyWorkflowCreated
  Module Products.CMFCore.WorkflowTool, line 292, in notifyCreated
  Module Products.CMFCore.WorkflowTool, line 638, in _reindexWorkflowVariables
  Module Products.CMFCore.CMFCatalogAware, line 91, in reindexObject
  Module Products.CMFCore.CatalogTool, line 304, in reindexObject
  Module Products.CMFPlone.CatalogTool, line 387, in catalog_object
  Module Products.ZCatalog.ZCatalog, line 476, in catalog_object
  Module Products.ZCatalog.Catalog, line 322, in catalogObject
  Module Products.ZCatalog.Catalog, line 272, in updateMetadata
  Module Products.ZCatalog.Catalog, line 396, in recordify
  Module plone.indexer.wrapper, line 59, in __getattr__
  Module plone.indexer.delegate, line 16, in __call__
  Module plone.contentratings.catalog, line 20, in average_rating
  Module plone.contentratings.catalog, line 9, in _first_user_rating
  Module contentratings.browser.aggregator, line 8, in get_rating_categories
  Module contentratings.browser.aggregator, line 8, in <genexpr>
  Module zope.component.registry, line 250, in getAdapters
  Module contentratings.category, line 69, in __call__
  Module zope.component._api, line 120, in queryMultiAdapter
  Module zope.component.registry, line 238, in queryMultiAdapter
  Module zope.interface.adapter, line 532, in queryMultiAdapter
  Module contentratings.category, line 102, in __init__
  Module contentratings.category, line 121, in _lookup_or_create_storage
TypeError: ('Could not adapt', <Newsletter at /en/indg.in/indg-newsletter/newsletter.2012-06-26.1477811319>, <InterfaceClass zope.annotation.interfaces.IAnnotations>) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T16:42:40.093

看起来 plone.contentratings 与 PloneGazette 不兼容。plone.contentratings 在这里假设它可以注释 Newsletter，但它无法检查 Newsletter 是否可以适应 IAnnotation 接口。

我想说这需要在 plone.contentratings （或其依赖 contentratings）中进行修复。但我也希望 PloneGazette 可以被改编，所以它可能也可以在那里修复。

我建议找到这两个包的错误跟踪器并在那里提交错误。或者希望其中一位作者阅读这个 stackoverflow 问题。

# android-layout - 如何使用 ListView 在布局中设置标题？

> ID：11209655
> 
> 赞同：0
> 
> 时间：2012-06-26T14:29:43.487
> 
> 标签：android-layout, android-listview

我正在尝试实现一个带有标题的 ListView。但是，使用下面的代码，会发生以下情况：

标题出现在第一个列表元素上。有一个 EditText 出现在顶部其他人的前面。

我的安卓活动

```
public class LoanRepaymentActivity extends ListActivity implements View.OnClickListener  {

private Location lastKnownLocation;
private ArrayList<CurrentRepaymentInstallment> loansForRepayment;
@Override
public void onCreate(Bundle savedInstanceState){
    lastKnownLocation = Utility.getLastKnownLocation(this);
    super.onCreate(savedInstanceState);

    Intent intent = getIntent();

    RepaymentInfo repaymentInfo = (RepaymentInfo)intent.getSerializableExtra(Constants.CURRENT_REPAYMENT_INSTALLMENT);
    loansForRepayment = repaymentInfo.getLoansForRepayment();
    boolean repaymentsNotPresent = loansForRepayment == null || loansForRepayment.isEmpty(); 
    if(repaymentsNotPresent){
        Dialog dialog = Utility.getDialogWithText(LoanRepaymentActivity.this, getText(R.string.noLoansForRepayment).toString());
        Utility.getDialogButton(dialog, LoanRepaymentActivity.this, PartnerGroupListActivity.class, intent.getStringExtra(Constants.ACECSS_TOKEN_PARAM));
        dialog.show();
    }

    setContentView(R.layout.loan_repayments);

    ArrayAdapter<CurrentRepaymentInstallment> adapter = new LoanRepaymentListAdapter(this, loansForRepayment);

    View footer = getLayoutInflater().inflate(R.layout.loan_disbursement_footer, null);
    getListView().addFooterView(footer);

    setListAdapter(adapter);
         if(!repaymentsNotPresent)  {
        TextView textView = (TextView)findViewById(R.id.screenTitle);
        String currentInstallmentLabel = getText(R.string.currentInstallmentLabel).toString() + repaymentInfo.getCurrentGroupInstallment();
        textView.setText(currentInstallmentLabel);
    }

    Button button = (Button)findViewById(R.id.disburse);
    button.setOnClickListener(this);
} 
```

XML

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:orientation="vertical"
>

<TextView android:id="@+id/screenTitle" 
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" >
</TextView>

 <ListView
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_above="@+layout/loan_disbursement_footer"
     />
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:orientation="vertical" >
<TextView
    android:id="@+id/borrowerName"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@+id/label"
    android:textSize="14sp"
     >
</TextView>

<TextView
    android:id="@+id/loanAmount"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@+id/label"
    android:textSize="14sp"
     >
</TextView>

<TextView
    android:id="@+id/installmentNumber"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@+id/label"
    android:textSize="12sp"
    >
</TextView>

<TextView
    android:id="@+id/estimatedTotal"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@+id/label"
    android:textSize="12sp"
    >
</TextView>

</LinearLayout>
<EditText
    android:id="@+id/repaymentAmount"
    android:layout_width="100sp"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:inputType="numberDecimal"
    android:textSize="12sp"
     >
</EditText> 
```

自定义阵列适配器

```
public class LoanRepaymentListAdapter extends ArrayAdapter<CurrentRepaymentInstallment> {

private final List<CurrentRepaymentInstallment> loansForRepayment;
private final Activity context;

public LoanRepaymentListAdapter(Activity context, List<CurrentRepaymentInstallment> loansForRepayment) {
    super(context, R.layout.loan_repayments, loansForRepayment);
    this.context = context;
    this.loansForRepayment = loansForRepayment;
}

static class ViewHolder {
    protected TextView borrowerName;
    protected TextView loanAmount;
    protected TextView installmentNumber;
    protected TextView estimatedTotal;
    protected EditText repaymentAmount;
}

@Override
public View getView(final int position, View convertView, ViewGroup parent) {
    View view = null;
    if (convertView == null) {
        LayoutInflater inflator = context.getLayoutInflater();
        view = inflator.inflate(R.layout.loan_repayments, null);
        final ViewHolder viewHolder = new ViewHolder();
        viewHolder.borrowerName = (TextView) view.findViewById(R.id.borrowerName);
        viewHolder.loanAmount = (TextView) view.findViewById(R.id.loanAmount);
        viewHolder.installmentNumber = (TextView) view.findViewById(R.id.installmentNumber);
        viewHolder.estimatedTotal = (TextView) view.findViewById(R.id.estimatedTotal);
        viewHolder.repaymentAmount = (EditText) view.findViewById(R.id.repaymentAmount);
//          viewHolder.repaymentAmount.setEditableFactory(Editable.Factory.getInstance());
        viewHolder.repaymentAmount.addTextChangedListener(new TextWatcher() {

            @Override
            public void afterTextChanged(Editable arg0) {

            }

            @Override
            public void beforeTextChanged(CharSequence s, int start,
                    int count, int after) {
                // TODO Auto-generated method stub

            }

            @Override
            public void onTextChanged(CharSequence s, int start, int before, int count) {
                String repaymentAmount =  s.toString();
                try {
                    loansForRepayment.get(position).setRepaymentAmount(Float.parseFloat(repaymentAmount));
                } catch (Exception ex){
                    loansForRepayment.get(position).setRepaymentAmount(0.0F);
                }
            }

        });
        view.setTag(viewHolder);
        viewHolder.repaymentAmount.setTag(loansForRepayment.get(position));
    } else {
        view = convertView;
        ((ViewHolder) view.getTag()).repaymentAmount.setTag(loansForRepayment.get(position));
    }
    ViewHolder holder = (ViewHolder) view.getTag();
    holder.borrowerName.setText(loansForRepayment.get(position).getLoanProfileBasicInfo().getBorrowerBasicInfo().getFirstName());
    holder.loanAmount.setText("Rs. " + Float.toString(loansForRepayment.get(position).getLoanProfileBasicInfo().getLoanAmountInPaisa()/100));
    holder.estimatedTotal.setText("Rs. " + Float.toString(loansForRepayment.get(position).getEstimatedTotalAmount()/100));
    holder.installmentNumber.setText("Inst no : " + Integer.toString(loansForRepayment.get(position).getInstallmentNumber()));
    float repaymentAmt = loansForRepayment.get(position).getRepaymentAmount();
    if(repaymentAmt != 0.0) holder.repaymentAmount.setText(Float.toString(repaymentAmt));
    return view;
       }
   } 
```

如果有人能告诉我如何做到这一点，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T10:00:50.470

为标题设置新布局并将其作为标题添加到 ListView。

XML

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_alignParentBottom="true"
    >

<TextView android:id="@+id/repaymentScreenTitle" 
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content"
    android:text="@string/repaymentsTitle" >
</TextView>
</LinearLayout> 
```

在您的活动中将此块替换为它下面的块

```
 if(!repaymentsNotPresent)  {
    TextView textView = (TextView)findViewById(R.id.screenTitle);
    String currentInstallmentLabel = getText(R.string.currentInstallmentLabel).toString() + repaymentInfo.getCurrentGroupInstallment();
    textView.setText(currentInstallmentLabel);
}

    View headerView = getLayoutInflater().inflate(R.layout.loan_repayment_title, null);
    TextView titleView = (TextView) headerView.findViewById(R.id.repaymentScreenTitle);
    String titlePrefix = (String) getText(R.string.groupInstallmentLabel);
    titleView.setText(titlePrefix + " " + repaymentInfo.getCurrentGroupInstallment());
    getListView().addHeaderView(headerView); 
```

# actionscript-3 - 保护 Flash AS3 代码 + 与服务器的安全通信

> ID：11209656
> 
> 赞同：5
> 
> 时间：2012-06-26T14:29:44.670
> 
> 标签：actionscript-3, flash, protection, decompiler, data-protection

我需要我的 Flash 客户端与服务器安全通信（通过二进制套接字）。为此，我正在考虑在 AS3 代码中嵌入一个预共享密钥，并通过自定义协议交换异或数据。

有人告诉我，SWF 反编译器在使所有嵌入式代码清晰可见和可读方面做得很好。这是否意味着我不能真正隐藏我的密钥？

如果这种方法不切实际，还有哪些其他选择？我尝试过 as3crypto，却发现它充满了缺点并且缺乏严肃的文档。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T14:54:24.353

您根本无法隐藏您的密钥 - SWF 完全不受信任，可以轻松反编译。处理 SWF 的安全性非常困难，因为它们在客户端上运行并且不受信任。

这可能具体取决于您通过安全通信尝试完成的任务。例如，如果您试图保护一个高分系统，这几乎是不可能的，因为游戏在客户端（SWF）上运行，他们可以操纵它向服务器吐出他们想要的任何分数。这是一个很好的阅读：[什么是阻止人们破解基于 PHP 的 Flash 游戏高分表的最佳方法](https://stackoverflow.com/questions/73947/what-is-the-best-way-to-stop-people-hacking-the-php-based-highscore-table-of-a-f)

如果您只能将 SWF 用作前端 UI，并且所有逻辑都发生在后端，那么您可以保护您的应用程序（使用上面的高分示例，如果游戏不是 AS3 游戏但实际上在服务器本身，它会更容易保护，因为后端是受信任的，用户不能修改或查看），但如果逻辑发生在 SWF 上，那么你就很不走运了。

# jquery - jquery更新隐藏字段依赖于复选框

> ID：11209658
> 
> 赞同：0
> 
> 时间：2012-06-26T14:29:52.300
> 
> 标签：jquery, function, input, field, hidden

我正在使用它来查看是否选中了指定表中的每一行复选框。

```
$("#table_pdf_view input[type=checkbox][checked]").each(

    function() {

    }

 ); 
```

如果选中该行，我希望它使用复选框输入 id 来更新单独的隐藏表。

```
echo '<td width="200px"><input type=" checkbox" id="'.$row['client_id'].'" name="download"></td>'.PHP_EOL; 
```

隐藏表将包含一个输入字段。如果检查了多行，我想用逗号分隔每个 id。

​</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:33:52.993

做类似的事情

```
var $checkboxes = $("#table_pdf_view input[type=checkbox]");
$checkboxes.on('change',function(){
   var ids = $checkboxes.filter(':checked').map(function(){
      return this.id; 
   }).get().join(',');
   $('#Hidden_input_id').val(ids);
}); 
```

`#Hidden_input_id`使用隐藏输入的 ID 进行更改。这将`hidden input's value`在用户`check/uncheck`选中复选框时更新。

**演示：http:** [//jsfiddle.net/npmB3/1/](http://jsfiddle.net/npmB3/1/)

阅读更多关于[`.on()`](http://api.jquery.com/on)和[`.map()`](http://api.jquery.com/map/)

# iphone - 表视图中的 UILabel - 正确的方法？

> ID：11209659
> 
> 赞同：0
> 
> 时间：2012-06-26T14:29:53.477
> 
> 标签：iphone, uitableview, xcode4, uilabel

我试图在一个单元格中实现一个 UILabel ，当我上下滚动表格几次时，我得到的是一些值的重叠。我使用 ARC，所以当我想要的时候没有发布，所以我的问题是：将 Label 实现到 tableView 单元格的正确方法是什么？

[这是它的外观](http://s16.postimage.org/z66vpzrmd/Screen_Shot_2012_06_26_at_4_24_31_PM.png)

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

    }
     // Configure the cell...  

    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    cell.textLabel.textColor = [UIColor colorWithRed:0.6 green:0.6 blue:0.6 alpha:1];
    cell.textLabel.highlightedTextColor = [UIColor colorWithRed:0.753 green:0.651 blue:0.1569 alpha:1]; 

    UILabel *cellLabelS1 = [[UILabel alloc] initWithFrame:CGRectMake(250, 0, cell.frame.size.width, cell.frame.size.height)];
    cellLabelS1.backgroundColor = [UIColor clearColor];
    cellLabelS1.font = [UIFont boldSystemFontOfSize:16];
    [cellLabelS1 setTextColor:[UIColor whiteColor]];

    [cellLabelS1 setText:temperatureString];
    temperatureString = nil;
    [cell addSubview:cellLabelS1];
    [[cell imageView]setImage:[UIImage imageNamed:imageFromCodeDay1]];
    [[cell textLabel]setText:cityString];

    return cell; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:32:09.043

仅当您没有标签时，才应向单元格添加标签。如果您在第二遍重复使用单元格，则再次添加它。所以我的建议是为标签设置一个标签，并尝试查看单元格 contentView 是否已经是标签。如果没有创建并添加它。

```
 UILabel *myLabel = (UILabel *)[cell.contentView viewWithTag:2002];
            if(!myLabel){
                myLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 100, 22)];
                myLabel.tag = 2002;
                [cell.contentView addSubview:myLabel];
            }
             myLabel.text = @"my new text"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:40:57.297

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

        UILabel *cellLabelS1 = [[UILabel alloc] initWithFrame:CGRectMake(250, 0,cell.frame.size.width, cell.frame.size.height)];
cellLabelS1.backgroundColor = [UIColor clearColor];
cellLabelS1.tag = 200; 
cellLabelS1.font = [UIFont boldSystemFontOfSize:16];
[cellLabelS1 setTextColor:[UIColor whiteColor]];
[cell addSubview:cellLabelS1];
}
 // Configure the cell...  

cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
cell.textLabel.textColor = [UIColor colorWithRed:0.6 green:0.6 blue:0.6 alpha:1];
cell.textLabel.highlightedTextColor = [UIColor colorWithRed:0.753 green:0.651 blue:0.1569 alpha:1]; 

UILabel *cellLabelS1 = (UILabel*)[cell viewWithTag:200];
[cellLabelS1 setText:temperatureString];
temperatureString = nil;

[[cell imageView]setImage:[UIImage imageNamed:imageFromCodeDay1]];
[[cell textLabel]setText:cityString];

return cell;
} 
```

这可能会帮助你....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:32:39.400

您的问题出在以下几行：

```
UILabel *cellLabelS1 = [[UILabel alloc] initWithFrame:CGRectMake(250, 0, cell.frame.size.width, cell.frame.size.height)];
cellLabelS1.backgroundColor = [UIColor clearColor];
cellLabelS1.font = [UIFont boldSystemFontOfSize:16];
[cellLabelS1 setTextColor:[UIColor whiteColor]]; 
```

当你从表格视图中得到一个重用的单元格时，它已经包含了这个标签。避免添加重复标签的方法是仅在需要分配新单元格时添加它。但是，这会使从重复使用的单元格中检索标签变得非常复杂。

我个人建议在界面生成器中创建一个自定义 UITableViewCell，并创建一个具有 UILabel 属性的自定义 UITableViewCell 子类。

# ios - UIScrollView“触摸”问题

> ID：11209661
> 
> 赞同：0
> 
> 时间：2012-06-26T14:29:57.433
> 
> 标签：ios, uiview, uiscrollview

我对一个`UIScrollView`问题感到很困惑。- 我将一系列附加`UIImageViews`到 a`UIScrollView`并且工作正常，并且“contentsize”正在适当更新。-`UIScrollView`接下来是内部`UIView`（所有其他交互元素都可以正常工作） - 视图仅水平滚动 - scrollView 框架为 300 x 40（宽度/高度）。- 系统说明：我正在为 iOS 5+ 制作这个

我的问题：我只能通过触摸滚动视图的最左侧来滚动这个视图。整个视图应该响应触摸而不是响应！！！看起来左边的 25-30% 正在响应触摸并允许我滚动。该视图未被任何其他可能阻碍交互性的视图/组件覆盖。

所有的帮助都会减轻一些压力-AJ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T15:04:12.370

听起来 UIScrollView 的迭代被 UIImageViews 掩盖了。尝试更改一些属性。

# iphone - 核心图 - 隐藏轴一侧之外的图形

> ID：11209663
> 
> 赞同：1
> 
> 时间：2012-06-26T14:30:16.783
> 
> 标签：iphone, ios, graph, core-plot

我正在寻找一种方法在轴的某一侧（由下图中的红色框包围）隐藏图形的一部分（即轴和图）。我希望标签仍然可见并且图表仍然可以滚动。

![图形](../Images/fb4ca01697b9cbd3c8be9bd69655ad91.png)

我尝试过设置`visibleRange`，但它隐藏了固定范围的轴，并且在图形可滚动时不太有效。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T00:29:03.277

在绘图区域框架上设置填充。有关示例代码，请参阅绘图库示例应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T08:35:34.027

只是我有一个想法，但我不确定这是否会让你满意。

我已将`axisContstrains`属性用于 X 和 Y 轴。

所以你盒子里的图不是为我绘制的。我希望这将有助于解决这个问题。

# javascript - google dart 是否生成对 ES5 友好的 javascript，并且今天是否包含或排除 IE8？

> ID：11209668
> 
> 赞同：10
> 
> 时间：2012-06-26T14:30:34.097
> 
> 标签：javascript, internet-explorer-8, dart

我正在做一些研究，看看当前的 google dart 实现是否对 IE8 友好。我们的团队必须支持 IE8 一段时间，我正试图找出今天从 dart 生成的 javascript 是否适用于这个旧版浏览器。

dart 转编译器是否像 coffeescript 那样对输出 javascript 进行 lint？

最后，dart 会生成 ES5 友好的 javascript 吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-26T16:06:29.977

Dart 只针对支持 ES5 的浏览器，即 Internet Explorer >= 9、Firefox >= 4、Opera >= 12 以及相当新的基于 WebKit 的浏览器。IE 8 不在讨论范围内。

另外，我认为目前，除了最新的 Chromium/Chrome 之外，它更有可能在浏览器中遇到问题，但我对此没有直接经验。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-26T18:30:27.267

来自 Dart 常见问题解答 -[您计划支持哪些浏览器作为 JavaScript 编译目标？](http://www.dartlang.org/support/faq.html#what-browsers-supported)：

> 我们目前的目标是支持以下浏览器：
> * Internet Explorer，最新的两个 9 或更高版本。
> * Firefox，最新的两个 7 或更高版本。
> * Chrome，最新版本。
> * Safari，最新的两个 5.1 或更高版本。
> * Opera，12 或更高版本的最新版本。
> 
> 这是一个目标；我们实际上并不支持所有这些浏览器。目标可能会变得更严格或更宽松。

所以不，他们目前不打算支持 IE8。

# jquery - 如何将 jquery javascript 应用于多个标签

> ID：11209670
> 
> 赞同：1
> 
> 时间：2012-06-26T14:30:42.257
> 
> 标签：jquery, pdf, iframe, dialog

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:33:18.883

在链接上使用一个类并将代码应用于类名：

```
<a id="link1" class="changethis" runat="server" href="http://www.selab.isti.cnr.it/ws-mate/example.pdf" title="PDF">Open iFrame</a> 
```

然后将您的javascript更改为：

```
<script type="text/javascript">
$(function () {
    $(".changethis").click(function() { // Use the CLASS here, not the ID
        //e.preventDefault();
        var $this = $(this);
        $('<iframe id="externalSite"  frameborder="0" src="' + this.href + '" />').dialog({
            title: ($this.attr('title')) ? $this.attr('title') : 'External Site',
            autoOpen: true,
            width: 700,
            height: 600,
            modal: true,
            resizable: true,
            overlay: {
            opacity: 0.5,
            background: "black"
        }
    }).width(650).height(550);
    return false;
});
});
</script> 
```

您可以拥有无​​限数量的具有相同类名的超链接，并且每次单击该类的任何链接时都会执行该函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:33:01.073

给所有锚标签同一类，然后按类选择它们。

```
<a class="thelink" runat="server" href="http://www.selab.isti.cnr.it/ws-mate/example.pdf" title="PDF">Open iFrame</a> 
```

和js：

```
<script type="text/javascript">
$(function () {
    $(".thelink").click(function() {
        //e.preventDefault();
        var $this = $(this);
        $('<iframe id="externalSite"  frameborder="0" src="' + this.href + '" />').dialog({
            title: ($this.attr('title')) ? $this.attr('title') : 'External Site',
            autoOpen: true,
            width: 700,
            height: 600,
            modal: true,
            resizable: true,
            overlay: {
                opacity: 0.5,
                background: "black"
            }
        }).width(650).height(550);
        return false;
    });
});
</script> 
```

那一个 js 块将影响`thelink`该类的所有锚标记。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:34:38.860

`<a>`在从服务器渲染时向标签添加一个类，例如`class="iframelink"`

```
<script type="text/javascript">
$(function () {
    $(".iframelink").click(function() {
        //e.preventDefault();
        var $this = $(this);
        $('<iframe id="externalSite"  frameborder="0" src="' + this.href + '" />').dialog({
            title: ($this.attr('title')) ? $this.attr('title') : 'External Site',
            autoOpen: true,
            width: 700,
            height: 600,
            modal: true,
            resizable: true,
            overlay: {
                opacity: 0.5,
                background: "black"
            }
        }).width(650).height(550);
        return false;
    });
});
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T14:54:38.617

# mongodb - CakePHP 和 MongoDB：非 utf8 字符串通知

> ID：11209673
> 
> 赞同：0
> 
> 时间：2012-06-26T14:30:58.530
> 
> 标签：mongodb, utf-8, nginx, debian, cakephp-2.0

我最近将一个网站从运行 apache 2 的专用 ubuntu 服务器迁移到运行 nginx 的专用 debian 6 服务器。

这个网站使用的是 CakePHP 2.0 + [ichikaway 的 mongodb 插件](https://github.com/ichikaway/cakephp-mongodb)（所以使用 MongoDB）

由于我更改了服务器，当我尝试使用“français”或“èéï”等特殊字符保存“标签”子文档时，我收到了一个奇怪的通知。

它适用于其他控制器/模型/集合（例如，当我使用特殊字符保存新评论时）。

我已经强制 nginx 使用 utf-8，我所有的网站页面都有元字符集 utf-8，所有 .php（和 .ctp）脚本都以 utf-8 编码。我还尝试强制 utf8_encode() 和 utf8_encode(utf8_decode()) （是的，这很糟糕......）字符串错误得到了同样的错误。

**这是通知：（**并注意文档未保存）

```
Notice (1024): non-utf8 string: fran��ais [APP/Plugin/Mongodb/Model/Datasource/MongodbSource.php, line 715] 
```

**和上下文：**

```
MongodbSource::update() - APP/Plugin/Mongodb/Model/Datasource/MongodbSource.php, line 715
Model::save() - CORE/Cake/Model/Model.php, line 1614
FiltersController::edit() - APP/Plugin/Administration/Controller/FiltersController.php, line 137
ReflectionMethod::invokeArgs() - [internal], line ??
Controller::invokeAction() - CORE/Cake/Controller/Controller.php, line 473
Dispatcher::_invoke() - CORE/Cake/Routing/Dispatcher.php, line 107
Dispatcher::dispatch() - CORE/Cake/Routing/Dispatcher.php, line 89
[main] - APP/webroot/index.php, line 96 
```

我祈祷“堆栈溢出之神”来拯救我，我真的不知道该去哪里让它像以前一样工作了:(

谢谢你的阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T15:07:00.907

好的，我终于找到了！

我使用的是 strtolower()，正是这个函数破坏了编码。

所以我用 mb_strtolower() 强制 utf-8 来改变它，它再次运行良好

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-06T22:36:13.850

我解决了添加这些行的问题：

```
for($i=0; $i<=count($values)-1; $i++){
            if(is_string($values[$i]))
                $values[$i] = utf8_encode($values[$i]);
        } 
```

在 ../Pluggin/Mongodb/Model/DataSource/MongodbSource.php 之后

```
if (!$this->isConnected()) {
            return false;
        } 
```

在更新和创建函数中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T16:02:44.283

[utf8_encode()](http://php.net/utf8_encode)仅处理 ISO-8859-1 输入数据，因此您可能需要查看[iconv](http://php.net/manual/en/book.iconv.php)以处理其他字符集。这里的一个挑战可能是检测传入数据的字符集（我之前在 Facebook 的 API 的响应中遇到过这个问题），但是[这个问题](https://stackoverflow.com/q/910793/162228)应该提供一些可能性。

副手，您使用的是什么版本的 MongoDB 和 PECL 驱动程序？我在 PECL 驱动程序的 MongoDB 2.1 和 1.2.11dev 上，并且能够在 PHP 中毫无问题地执行此操作：

```
$m = new Mongo();
$m->test->foo->insert(array('fran��ais' => 'français')); 
```

我还可以通过 Mongo shell 查看文档：

```
> db.foo.find()
{ "_id" : ObjectId("4fe9d924e84df1844f000002"), "fran��ais" : "français" } 
```

我意识到 BSON 规范需要 UTF-8，但 Mongo 在这种情况下没有抱怨。我很好奇旧版本是否对此更严格。

# php - zend 装饰器表单在表中创建行表

> ID：11209674
> 
> 赞同：0
> 
> 时间：2012-06-26T14:31:01.213
> 
> 标签：php, zend-framework, zend-form, zend-form-element

我有以下代码，我想在行表中创建表单。第一个 for 循环是一个表，第二个 for 循环将是子表。我将使用 javascript 使用加号/减号按钮来显示和隐藏这些子表。

```
 <?php

class Application_Form_LineData extends Zend_Form
{
    private $lineId;
    private $dataId;
    private $name;

    public function init()
    {
        /* Form Elements & Other Definitions Here ... */
    }

    public $elementDecoration = array(
            'ViewHelper',
            array(array('data' => 'HtmlTag'), array('tag' => 'td'))
    );

    public $elementRowDecoration = array(
            'ViewHelper',
            array(array('row' => 'HtmlTag'), array('tag' => 'tr'))
    );

    public $elementTableDecoration = array(
            'ViewHelper',
            array(array('data' => 'HtmlTag'), array('tag' => 'td')),
            array(array('row' => 'HtmlTag'), array('tag' => 'tr'))
    );

    public function setLineId($lineId)
    {
        $this->lineId = $lineId;
    }

    public function setName($name)
    {
        $this->name = $name;
    }

    public function setDataId($dataId)
    {
        $this->dataId = $dataId;
    }

    public function startform($entries)
    {
        $this->setMethod('post') ->setAttrib('enctype', 'multipart/form-data');
        //$this->setName('linedata');
        //$this->setAction($_SERVER["REQUEST_URI"]);
        //$this->setAction('line/submit');
        $count = count($entries);

        for($i=0;$i<$count;$i++){

            $this->addElement('text', 'lineid_'.$entries[$i]['PGA_Id'], array(
                    'required' => true,
                    'value'     => $entries[$i]['PGA_Id'],

                    'decorators' => $this->elementDecoration,

            ));

            $this->addElement('text', 'name_'.$entries[$i]['PGA_Name'], array(
                    'required' => true,
                    'value'     => $entries[$i]['PGA_Name'],
                    'readonly' =>true,
                    'decorators' => $this->elementDecoration
            ));

            $this->addElement('checkbox', 'check'.$entries[$i]['PGA_Id'], array(
                    'decorators' => $this->elementDecoration,

            ));
            $this->setElementDecorators(
                    array(
                            'ViewHelper',
                            'Label'
                    ),
                    array(
                            'lineid_'.$entries[$i]['PGA_Id'],
                            'name_'.$entries[$i]['PGA_Name'],
                            'check'.$entries[$i]['PGA_Id']
                    )

            );

            // Data sets for each line
            /*
            $countData = count($entries[$i]['Data_Set']);
            for($x=0;$x<$countData;$x++){

            $this->addElement('hidden', 'dataid_'.$entries[$i]['Data_Set'][$x]['PGA_Id'], array(
                    'required' => true,
                    'decorators' => $this->elementDecoration,
                    'decorators' => $this->elementRowDecoration,
                    //'decorators' => $this->elementTableDecoration,
            ));

            $this->addElement('text', 'name_'.$entries[$i]['Data_Set'][$x]['PGA_Name'], array(
                    'required' => true,
                    'value'     => $entries[$i]['Data_Set'][$x]['PGA_Name'],
                    'readonly' =>true,
                    'decorators' => $this->elementDecoration
            ));

            $this->addElement('hidden', 'path_'.$entries[$i]['Data_Set'][$x]['PGA_Path'], array(
                    'required' => true,
                    'value'     => $entries[$i]['Data_Set'][$x]['PGA_Path'],
                    'readonly' =>true,
                    'decorators' => $this->elementDecoration
            ));

            $this->addElement('checkbox', 'check'.$entries[$i]['Data_Set'][$x]['PGA_Id'], array(
                    'decorators' => $this->elementDecoration
            ));
            }
            */

        }
        //show var here
        //var_dump($this->lineId);

        $this->addElement('submit', 'submit', array(
                'ignore'   => true,
                'label'    => 'Submit',
                'decorators' => $this->elementDecoration
        ));
        /*
         $this->setElementDecorators(array(
                'ViewHelper',
                'Errors',
                array(array('data' => 'HtmlTag'), array('tag' => 'td')),
                //array(array('row' => 'HtmlTag'), array('tag' => 'tr'))
         ));
        */
        $this->setDecorators(array(
                'FormElements',
                array(array('data'=>'HtmlTag'),array('tag'=>'table')),
                'Form'
        ));

        //print_r($this);
        //exit();

        return $this;
    }

    //$this->setDecorators(array('FormElements', array('SimpleTable', ), 'Form'));

} 
```

# javascript - 如何在浏览器中检查文件下载

> ID：11209675
> 
> 赞同：1
> 
> 时间：2012-06-26T14:31:02.393
> 
> 标签：javascript, modernizr, browser-feature-detection

# 客观的

如果浏览器不支持下载文件，请删除下载按钮的显示。

# 语境

我有这个[页面](http://www.hillsong.co.uk/podcasts/)，可以播放和/或下载播客的功能。该页面运行良好，除非在 iOS 设备上我不想显示下载按钮，因为它要么无法正常工作，要么是多余的，因为点击它无论如何都不允许您下载。

整个网站的设计都带有功能测试，并以[Modernizr](http://modernizr.com/)为核心。我如何使用功能测试来删除不允许下载的浏览器/操作系统上的下载按钮？

最后的手段是隐藏使用`if (isiPad || isiPhone)`.

# javascript - Javascript中的人体检测

> ID：11209676
> 
> 赞同：8
> 
> 时间：2012-06-26T14:31:15.610
> 
> 标签：javascript, detection

是否有任何用于在图像或视频中检测人体的 JavaScript 库？我知道C++ 和 Python 中的[OpenCV](http://sourceforge.net/projects/opencvlibrary/)，但我在 JavaScript 中需要它。还有人脸检测的库，但我找不到全身的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-05T19:28:09.397

是的，有一些 OpenCV 的 JavaScript 端口可以实时对图像或视频执行对象检测：[js-objectdetect](https://github.com/mtschirs/js-objectdetect)（包含上身分类器）和[HAAR.js。](https://github.com/foo123/HAAR.js)

更多分类器可以在 OpenCV 发行版或[互联网上](http://alereimondo.no-ip.org/OpenCV/34)找到，它们只需要转换成另一种格式，然后才能被 JavaScript 库读取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T01:53:27.073

您还可以使用集成在 NPAPI 中的相同 C++ 库，然后从您的 javascript 代码中调用 C++ 函数。

# objective-c - 带有 UITableView 的 UIViewController 中可能存在内存泄漏

> ID：11209678
> 
> 赞同：5
> 
> 时间：2012-06-26T14:31:21.040
> 
> 标签：objective-c, xcode, cocoa-touch, uitableview, uiviewcontroller

我有一个以模态方式呈现的 UIViewController。当我查看内存分配 Instrument 时，显示视图时内存使用量会增加，但退出时内存不会释放。如果我不断打开和关闭视图，内存只会越来越高。Instruments 不会报告内存泄漏！这可能是什么原因造成的？视图控制器代码如下（我跳过了 didSelectRow 代码）。总是调用 Dealloc。

编辑 - 我正在使用 ARC

。H

```
#import <UIKit/UIKit.h>
@class OutlineTextUILabel;

@interface StoreViewController : UIViewController <UITableViewDelegate, UITableViewDataSource> {

    int starCount;
    NSMutableArray *_singleUseArray;
    NSMutableArray *_fullUseArray;

}

@property (weak, nonatomic) IBOutlet UITableView *tableView;
@property (weak, nonatomic) IBOutlet OutlineTextUILabel *starCountLbl;
- (IBAction)exitBtnPressed:(id)sender; 
```

.m

```
#import "StoreViewController.h"
#import "NSUserDefaults+MPSecureUserDefaults.h"
#import "PowerUpCell.h"
#import "OutlineTextUILabel.h"
#import "PowerUpSingleton.h"
#import "PowerUp.h"

#define kPrefsNumberOfStars             @"numberOfStars"

@interface StoreViewController ()

@end

@implementation StoreViewController
@synthesize tableView = _tableView;
@synthesize starCountLbl;

#pragma mark View Methods

- (void)viewDidLoad
{
    [super viewDidLoad];

    // Display star count
    NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
    BOOL valid = NO;
    starCount = [prefs secureIntegerForKey:kPrefsNumberOfStars valid:&valid];
    if (!valid) {
        NSLog(@"Stars Tampered With!");
        self.starCountLbl.text = @"Err";
    } else {
        self.starCountLbl.text = [NSString stringWithFormat:@"%d",starCount];
    }

    // Tableview setup
    CGRect frame2 = CGRectMake(0, 0, 320, 40);
    UIView *footer = [[UIView alloc] initWithFrame:frame2];
    footer.backgroundColor = [UIColor clearColor];
    self.tableView.tableFooterView = footer;
    self.tableView.opaque = NO;
    self.tableView.backgroundView = nil;
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:YES];

    if (![[PowerUpSingleton sharedList] refreshArray]) {
        NSLog(@"Error, %s",__FUNCTION__);
    } else {
        [self performSelectorOnMainThread:@selector(workOutSingleUseToDisplay) withObject:nil waitUntilDone:YES];
        [self performSelectorOnMainThread:@selector(workOutFullUseToDisplay) withObject:nil waitUntilDone:YES];
        [self.tableView reloadData];
    }
}

- (void)workOutSingleUseToDisplay
{
    _singleUseArray = [[NSMutableArray alloc] init];
    for (PowerUp *pu in [[PowerUpSingleton sharedList] sharedArray]) {
        if (!pu.fullUnlock) {
            [_singleUseArray addObject:pu];
        }
    }
}

- (void)workOutFullUseToDisplay
{
    _fullUseArray = [[NSMutableArray alloc] init];
    for (PowerUp *pu in [[PowerUpSingleton sharedList] sharedArray]) {
        if (pu.prefFullName != nil) {
            [_fullUseArray addObject:pu];
        }
    }

}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait || interfaceOrientation == UIInterfaceOrientationPortraitUpsideDown);
}

- (void)viewDidUnload {
    [self setTableView:nil];
    [self setStarCountLbl:nil];
    [super viewDidUnload];
}

#pragma mark TableView Setup Methods

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 2;
}

- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section
{
    if (section == 0) {
        return @"Single Use";
    } else if (section == 1) {
        return @"Use forever";
    }

    return nil;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    if (section == 0) {
        return [_singleUseArray count];
    } else if (section == 1) {
        return [_fullUseArray count];
    }

    return 0;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSString *cellIdentifier;
    if (indexPath.section == 0) {
        cellIdentifier = @"powerUpCellSingleUse";
    } else if (indexPath.section == 1) {
        cellIdentifier = @"powerUpCell";
    }

    PowerUpCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];
    if (cell == nil) {
        cell = [[PowerUpCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];
    }

    if (indexPath.section == 0) {
        PowerUp *tmpPU = [_singleUseArray objectAtIndex:indexPath.row];
        cell.descriptionLbl.text = tmpPU.displayName;
        int cost = tmpPU.costSingle;
        cell.costLbl.text = [NSString stringWithFormat:@"%d",cost];
        if (cost > starCount) {
            cell.costLbl.textColor = [UIColor redColor];
        } else {
            cell.costLbl.textColor = [UIColor blueColor];
        }
        int howMany = tmpPU.numberOwned;
        cell.howManyLbl.text = [NSString stringWithFormat:@"%d",howMany];

    } else if (indexPath.section == 1) {
        PowerUp *tmpPU = [_fullUseArray objectAtIndex:indexPath.row];
        cell.descriptionLbl.text = tmpPU.displayName;
        int cost = tmpPU.costFull;
        cell.costLbl.text = [NSString stringWithFormat:@"%d",cost];
        if (cost > starCount) {
            cell.costLbl.textColor = [UIColor redColor];
        } else {
            cell.costLbl.textColor = [UIColor blueColor];
        }
        if (tmpPU.fullUnlock) {
            cell.costLbl.textColor = [UIColor greenColor];
            cell.costLbl.text = @"---";
        }
    }

    return cell;
}

#pragma mark -

- (IBAction)exitBtnPressed:(id)sender
{
    [self dismissModalViewControllerAnimated:YES];
}

- (void)dealloc
{
    NSLog(@"%s",__FUNCTION__);
    self.tableView = nil;
    self.starCountLbl = nil;
}

@end 
```

编辑 ------------- 有些事情似乎不对。我已将 NSLog 添加到单元分配中，并且它从未被调用，即使单元已创建！

```
PowerUpCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];
    if (cell == nil) {
        NSLog(@"new cell");
        cell = [[PowerUpCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];
    } 
```

编辑 7 月 1 日 ------ 我添加了一个导航控制器，现在使用推送而不是模式，这个问题仍然存在。我已经通过在视图之间来回移动几次来使用 Instruments 进行大量拍摄，似乎单元格仍然在附近徘徊，因为此屏幕截图显示手势识别器仍然存在于先前加载的视图中。 ![截屏](../Images/21a5385a43680d50f5fec47db097f71f.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T09:08:52.443

这是因为您将 IBOutlets 用作`weak`，而不是使用`strong`.

我实际上认为这是 XCode 环境中的一个缺陷，因为它应该警告您这种行为。

作为最佳实践，我建议让 XCode 通过将视图拖到 Interface Builder 中的代码来生成 IBOutlets，以避免这种烦人的陷阱。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T21:40:47.407

看起来您已经找到了一些解决方法，但以防万一这有帮助：

1) 确保您在调试时没有打开 Zombies，因为这会导致对象在您认为它们应该被释放后挂起（编辑方案 -> 运行 -> 诊断）。

2）你正在使用ARC，所以我假设你的故事板/NIB中有故事板或至少原型UITableView单元？如果是这样，那么你下面的 NSLog() 永远不会被调用的原因是因为 dequeueReusableCellWithIdentifier 调用知道通过定义的 cellIdentifier 从这些原型单元格创建单元格。很方便。

```
PowerUpCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];
    if (cell == nil) {
        NSLog(@"new cell");
        cell = [[PowerUpCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];
    } 
```

您必须依靠 UITableView 来管理 UITableViewCells 的缓存，并适当地释放它们。所以他们可能只是在闲逛，因为你的 UITableView 没有被释放（尽管我认为你说的是​​）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:42:45.023

我不确定我是否得到了答案，但是您的代码中有一些奇怪的地方：

您正在使用弱属性：

```
@property (weak, nonatomic) IBOutlet UITableView *tableView;
@property (weak, nonatomic) IBOutlet OutlineTextUILabel *starCountLbl; 
```

但根据[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocProperties.html)（搜索“弱”），`weak`propoerty 与`assign`.

在你dealloc中，你有

```
self.tableView = nil;
self.starCountLbl = nil; 
```

我很确定这些属性的生成设置器根本不会释放它们！

**但是，如果您声明您的属性，例如：**

```
@property (nonatomic, retain) IBOutlet UITableView *tableView;
@property (nonatomic, retain) IBOutlet OutlineTextUILabel *starCountLbl; 
```

生成的设置器就像

```
(void)setTableView(UITableView *)newTableView {
    [tableView release];
    if(newTableView != nil)
        tableView = [newTableView retain];
} 
```

你的财产将被释放。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T14:42:19.637

**[编辑]**

在您的 viewWillAppear 方法中，您是否打印出来以查看您通过 else 子句的频率。在我看来，您似乎调用了 workOutSingleUseToDisplay 和 workOutFullUseToDisplay 方法。每次调用它们时，都会分配 _singleUseArray 和 _fullUseArray。仅仅因为您移入和移出视图，并不意味着它会调用 dealloc，或者它会自动释放您当前的数组。我认为您看到的是，当您移出视图时，它不会释放这两个数组，而是会尝试重新分配它们。

**[ORIGINAL]** 好吧，在您的 viewDidLoad 中，您执行了分配。在您的 dealloc 中，我没有看到 [页脚释放]。这可能是你的泄漏！！！我也没有看到释放您的 _singleUseArray 或 _fullUseArray 数组

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T05:59:53.823

至少，使用 Leaks 工具来监控内存泄漏。Allocations 工具实际上不会显示内存泄漏。如果您运行分析，您将看到可能导致泄漏的行。

这是你的代码：

```
 PowerUpCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];
 if (cell == nil) {
    NSLog(@"new cell");
    cell = [[PowerUpCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];
 } 
```

你看，`cell`不会`nil`……这在 API doc 中有说明`dequeueReusableCellWithIdentifier:`：

> 返回值
> 
> 具有关联标识符的 UITableViewCell 对象，如果可重用单元队列中不存在此类对象，则返回 nil。

无论如何，如果有泄漏，也许它们很大程度上是由以下原因引起的：

```
_singleUseArray = [[NSMutableArray alloc] init]; 
```

和

```
_fullUseArray = [[NSMutableArray alloc] init]; 
```

当你宣布

```
NSMutableArray *_singleUseArray;
NSMutableArray *_fullUseArray; 
```

我认为，默认情况下，两者都分配有`__strong`限定符。我不太确定，但这可能是问题的真正原因。改为声明这个怎么样？

```
NSMutableArray * __weak _singleUseArray;
NSMutableArray * __weak _fullUseArray; 
```

另外，在声明之前

```
_singleUseArray = [[NSMutableArray alloc] init]; 
```

和

```
_fullUseArray = [[NSMutableArray alloc] init]; 
```

如何首先将其分配给以`nil`删除先前的引用？

```
_singleUseArray = nil;
_singleUseArray = [[NSMutableArray alloc] init]; 
```

和

```
_fulUseArray = nil;
_fullUseArray = [[NSMutableArray alloc] init]; 
```

# javascript - 数字排序列表

> ID：11209684
> 
> 赞同：0
> 
> 时间：2012-06-26T14:31:59.060
> 
> 标签：javascript, drag-and-drop

以下代码按如下方式对列表进行排序：1\. item, 10\. item, 100\. item... 我要添加或更改什么以按数字顺序排列列表（1,2,3...）？

```
 function sortUnorderedList(ul, sortDescending) {
      if(typeof ul == "string")
        ul = document.getElementById(ul);

      var lis = ul.getElementsByTagName("LI");
      var vals = [];

      for(var i = 0, l = lis.length; i < l; i++)
        vals.push(lis[i].innerHTML);

      vals.sort();

      if(sortDescending)
        vals.reverse();

      for(var i = 0, l = lis.length; i < l; i++)
        lis[i].innerHTML = vals[i];
    }

    window.onload = function() {
      var desc = false;
      document.getElementById("test").onclick = function() {
        sortUnorderedList("lister", desc);
        sortUnorderedList("bin", desc);
        desc = !desc;
        return false;
      }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:38:47.603

你只需要改变：

```
vals.push(lis[i].innerHTML); 
```

至：

```
vals.push(+lis[i].innerHTML); 
```

这会将 转换`String`为数字并按照您的意愿进行排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:35:54.303

您的集合的元素存储为字符串，因此它们按字母顺序排列。如果您使用 parseInt 函数将元素添加为整数，我相信您的排序应该按预期工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:41:54.270

代替

```
vals.sort() 
```

你应该做：

```
vals.sort(function(a,b){return a-b}); 
```

这将对“数字”进行排序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T15:26:10.487

实际上，将字符串（如字符串和整数）排序​​为整数是一种很好的做法。

因此，我建议您为项目中可能出现的数据类型编写各种排序函数，并使用正则表达式确定要使用的函数。

还有一个很棒的 jQuery 插件，可以很容易地扩展：[http ://tablesorter.com/docs/](http://tablesorter.com/docs/)

# android - Android 菜单到选项卡式操作栏

> ID：11209688
> 
> 赞同：1
> 
> 时间：2012-06-26T14:32:13.110
> 
> 标签：android, menu, android-actionbar, menuitem

我正在创建一个包含 4 个主要部分的应用程序。我想要一种非常简单的导航方式，这意味着如果手机支持操作栏，那么我希望它显示一个选项卡式操作栏。否则显示菜单的常规菜单按钮很好。

问题在于，当在具有实际支持操作栏的 sdk 版本的手机上试用时，操作栏接缝无法管理或无法创建。

我正在使用 menu/menu.xml 文件来创建要显示的菜单和项目。然后，我使用带有 MenuInflater 的 onCreateOptionsMenu() 来填充每个 Activity 的菜单。这在所有手机上都可以正常工作，但在使用操作栏的手机上，我得到一个标题类型栏，最左边是应用程序图标，旁边是当前活动标题，然后在最右边是*图标*第一个菜单项后跟 3 个方块（当您单击它们时，会显示其余的菜单项）。无论我在哪个活动中，这种情况都保持不变。

我想要的是一个选项卡式操作栏，而不是显示图标和文本（如果有文本空间），并且用户正在查看的任何当前活动都在选项卡式操作栏中被“选中”。此处显示的相同方式：

[http://developer.android.com/images/ui/actionbar.png](http://developer.android.com/images/ui/actionbar.png)（由于是新用户，我无法将其设为图像）

这是我正在使用的代码：

**清单.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest
    xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.mypackage"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-permission
        android:name="android.permission.INTERNET" />
    <uses-permission
        android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission
        android:name="android.permission.READ_PHONE_STATE" />

    <uses-sdk
        android:minSdkVersion="10"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/icon"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.Holo">

        <uses-library android:name="com.google.android.maps" />

        <activity
            android:name=".ActivityLoad"
            android:label="label">

            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
        </activity>

        ....more activities....

    </application>

</manifest> 
```

**菜单.xml**

```
<?xml version="1.0" encoding="utf-8"?>

<menu
    xmlns:android="http://schemas.android.com/apk/res/android">

    <item
        android:id="@+id/menuMap"
        android:title="@string/A_MAP_TITLE"
        android:icon="@drawable/nav_map"
        android:showAsAction="ifRoom|withText">
    </item>

    <item
        android:id="@+id/menuList"
        android:title="@string/A_LIST_TITLE"
        android:icon="@drawable/nav_list"
        android:showAsAction="ifRoom|withText">
    </item>

    <item
        android:id="@+id/menuMore"
        android:title="@string/A_MORE_TITLE"
        android:icon="@drawable/nav_more"
        android:showAsAction="ifRoom|withText">
    </item>

    <item
        android:id="@+id/menuReport"
        android:title="@string/A_REPORT_TITLE"
        android:icon="@drawable/nav_report"
        android:showAsAction="ifRoom|withText">
    </item>

</menu> 
```

**我的活动.java**

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.options, menu);
    return super.onCreateOptionsMenu(menu);
} 
```

我已经尝试在我的活动 onCreate() 方法中使用此代码设置操作栏导航模式，但所发生的只是一个空白操作栏显示在我默认获得的“坏”操作栏下方：

```
ActionBar actionBar = getActionBar();
actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS); 
```

所有教程都只是说“使用样式”或其他内容，但我不知道在哪里放置样式 xml 文件或如何将其设置到我的菜单或我应该在这里实际做什么。如果有人可以提供帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T23:22:41.093

首先确保您的**MyActivity.java**正在实现 ActionBar.TabListener 这意味着您将需要覆盖 3 个函数。我不知道您是如何制作片段的，但这就是我在**MyActivity.java**中的做法：

```
public class MyActivity extends FragmentActivity implements ActionBar.TabListener {

    private static final String STATE_SELECTED_NAVIGATION_ITEM = "selected_navigation_item";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        // Set up the action bar.
        final ActionBar actionBar = getActionBar();
        actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

        // For each of the section, add a tab to the action bar.
        actionBar.addTab(actionBar.newTab().setText(R.string.title_status).setTabListener(this));
        actionBar.addTab(actionBar.newTab().setText(R.string.title_configuration).setTabListener(this));
    }

    @Override
    public void onRestoreInstanceState(Bundle savedInstanceState) {
        if (savedInstanceState.containsKey(STATE_SELECTED_NAVIGATION_ITEM)) {
            getActionBar().setSelectedNavigationItem(
                    savedInstanceState.getInt(STATE_SELECTED_NAVIGATION_ITEM));
        }
    }

    @Override
    public void onSaveInstanceState(Bundle outState) {
        outState.putInt(STATE_SELECTED_NAVIGATION_ITEM,
                getActionBar().getSelectedNavigationIndex());
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        //getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    @Override
    public void onTabUnselected(ActionBar.Tab tab, FragmentTransaction fragmentTransaction) {
    }

    @Override
    public void onTabSelected(ActionBar.Tab tab, FragmentTransaction fragmentTransaction) {
        // When the given tab is selected, show the tab contents in the container
        Fragment fragment = new DummySectionFragment();
        Bundle args = new Bundle();
        args.putInt(DummySectionFragment.ARG_SECTION_NUMBER, tab.getPosition() + 1);
        fragment.setArguments(args);
        getSupportFragmentManager().beginTransaction()
                .replace(R.id.container, fragment)
                .commit();
    }

    @Override
    public void onTabReselected(ActionBar.Tab tab, FragmentTransaction fragmentTransaction) {
    }

    /**
     * A dummy fragment representing a section of the app, but that simply displays dummy text.
     */
    public static class DummySectionFragment extends Fragment {
        public DummySectionFragment() {
        }

        public static final String ARG_SECTION_NUMBER = "section_number";

        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container,
                Bundle savedInstanceState) {
            TextView textView = new TextView(getActivity());
            textView.setGravity(Gravity.CENTER);
            Bundle args = getArguments();
            textView.setText(Integer.toString(args.getInt(ARG_SECTION_NUMBER)));
            return textView;
        }
    }
} 
```

为了自定义操作栏，您需要使用以 Theme.Holo 作为父级的自定义样式。这样，它继承了 Holo 主题的所有内容，但是您可以覆盖您想要的内容。在**manifest.xml 中**使用：

```
 <application
        android:theme="@style/AppTheme"> 
```

代替：

```
 <application
        android:theme="@android:style/Theme.Holo"> 
```

然后在**values/styles.xml 中**放置您的自定义样式：

```
<resources xmlns:android="http://schemas.android.com/apk/res/android">
    <style name="AppTheme" parent="android:Theme.Holo.Light">
       <item name="android:actionBarStyle">@style/MyActionBar</item>
       <item name="android:actionBarTabStyle">@style/MyActionBarTabStyle</item>
       <item name="android:actionBarTabBarStyle">@style/MyActionBarTabBar</item>
    </style> 
```

这是它变得有点棘手的地方。在同一个文件（**values/styles.xml**）中，您需要定义上面引用的每种样式。

```
<style name="MyActionBar" parent="@android:style/Widget.Holo.Light.ActionBar">
    <item name="android:background">@drawable/menu_bar</item> <!-- remove if you don't have custom background for action bar -->
    <item name="android:displayOptions"></item>  <!-- get rid of logo on left and title, if you want logo on left put useLogo here -->
    <item name="android:customNavigationLayout">@layout/custom_action_bar</item> <!-- This is where you define how you want things to layout in your actionbar. I use a relative layout -->     
</style>

<!-- Style for tab bar -->
<style name="MyActionBarTabBar" parent="@android:style/Widget.Holo.Light.ActionBar.TabBar">
    <item name="android:showDividers">none</item>
    <item name="android:paddingLeft">20dp</item>
</style>

<!-- Style for action bar tabs -->
<style name="MyActionBarTabStyle" parent="@android:style/Widget.Holo.Light.ActionBar.TabView">
    <item name="android:background">@drawable/menu_tab</item> <!-- I use a background for my tabs also -->
</style> 
```

如果您不关心每个选项卡的自定义背景，请从上面删除最后一个样式。如果每个选项卡都有自定义背景（需要选中状态 .9.png 图像和未选中状态 .9.png 图像），则需要**drawable/menu_tab.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android"
    android:constantSize="false"
    android:dither="true"
    android:variablePadding="false" >
    <item android:state_selected="true" >
        <inset android:insetTop="23dp"
               android:insetBottom="26dp" >
               <bitmap android:src="@drawable/menu_selected" ></bitmap>
        </inset> 
    </item>
    <item android:state_selected="false" > 
        <inset android:insetTop="20dp"
               android:insetBottom="26dp" >
               <bitmap android:src="@drawable/menu_not_selected" ></bitmap>
        </inset> 
    </item>      
</selector> 
```

现在创建**layout/custom_action_bar.xml**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >
    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:contentDescription="@string/LogoText"
        android:paddingRight="20dp"
        android:paddingTop="20dp"
        android:src="@drawable/ic_launcher" />

</RelativeLayout> 
```

custom_action_bar 可以是您想要布局其余操作栏元素的方式。我只是将徽标放在右侧，但在您的情况下，您可以使用溢出菜单按钮或任何您想要的。我为操作栏和每个选项卡使用自定义背景。如果这样做，您将需要创建 .9.png 文件以确保它们与不同的屏幕兼容。

完成的结果如下所示： ![自定义操作栏](../Images/7665f2e36aecd17940bdab641d06dad4.png)

# ios - 如何以编程方式获取 UIBarButtonItems 的状态？

> ID：11209689
> 
> 赞同：1
> 
> 时间：2012-06-26T14:32:17.900
> 
> 标签：ios, state, uibarbuttonitem, uicontrol

使用`UIControl`诸如a 之类的东西，`UIButton`您可以使用类似的东西 `myControl.state` 来确定控件当前是否被按下。

但是，我需要对一些`UIBarButtonItems`（不是从 派生的`UIControl`）做同样的事情，这样我就可以在其中一个被按下时停止我的表格的编辑。

这是我的代码：

```
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath {
    //other checks
    for(int b=0; b<self.toolbar.items.count; b++)
    {
        UIControl *currentControl= [self.toolbar.items objectAtIndex:b];
        if(currentControl.state==UIControlStateHighlighted)
        {
            return NO;
        }
    }
    return YES;
} 
```

显然，它不起作用，因为它假设`UIBarButtonItems` *可以*被视为`UIControls`，但是我将如何做我在这里尝试做的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:45:00.450

如果您想更好地控制您`UIBarButtonItems`的最佳做法是将它们重新创建为`UIButtons`（使用自定义艺术等），然后使用`-initWithCustomView`of`UIBarButtonItem`从实际的 UIViews 创建按钮项。

这将使您可以完全访问通常的按钮交互方法：唯一的缺点是默认情况下您不会获得漂亮的条形按钮样式，并且您必须自己为此提供艺术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:33:06.400

我之前也遇到过类似的问题。我无法修复它，所以我继续前进。这是我所做的：

使用 ToolBar 代替导航栏，然后使用 UIButton 代替工具栏中的 UIBarButtonItem。

# html - 使组合高度等于浏览器窗口的高度

> ID：11209692
> 
> 赞同：2
> 
> 时间：2012-06-26T14:32:31.370
> 
> 标签：html, css

[http://featuredfotografer.com/](http://featuredfotografer.com/)

.Codemirror div 与 #header div 组合占用的高度超过了浏览器的高度。如何使它们的总高度为浏览器窗口的 100%，这样我就没有滚动条了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:35:44.113

> 使组合高度等于浏览器窗口的高度

只需添加这段代码。它会将您的内容设置`100%`为浏览器窗口。

```
body,html {
   height: 100%;
} 
```

你也可以检查[这个](http://www.communitymx.com/content/article.cfm?page=2&cid=BAD95)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:49:00.710

我会对此采取不同的方法。您可以制作一个 1px 高和 30px 宽的小图像，看起来像行号后面的背景，并将其应用于`body`a`repeat-y`和对齐`left`。删除div`height:100%`上的`.CodeMirror`

或者你可以

`<div class="CodeMirror-gutter bodyGutter"></div>`在结束标记之前添加`</body>`并将其添加到您的 CSS，并再次删除div`height:100%`上的：`.CodeMirror`

```
.bodyGutter {
  height: 100%;
  z-index: -1;
  width: 20px;
  left: -8px;
} 
```

这也是在你的身体上添加一个假的排水沟，并将其推到背景中，以提供 100% 高度的假外观。

# android-layout - 图像大小压缩。无法使 imageView 看起来像 Photoshop 图像

> ID：11209693
> 
> 赞同：0
> 
> 时间：2012-06-26T14:32:32.710
> 
> 标签：android-layout

我有一个平板电脑 Galaxy tab gt-p5110，我正在尝试采用 Photoshop 设计。这款平板电脑的分辨率为 1280 x 800，我的 Photoshop 设计也具有相同的分辨率。但是，当我在 Android 布局上传输图像 Photoshop 时，一切似乎都被压缩且更小了。它实际上并不像 Photoshop 设计中的那样。

我在这里想念什么？分辨率是一样的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:35:40.290

也许你有不同的颜色配置文件在使用？

# php - 在删除数据库值之前有一个确认屏幕

> ID：11209694
> 
> 赞同：0
> 
> 时间：2012-06-26T14:32:35.443
> 
> 标签：php, javascript, sql

我在制作确认屏幕时遇到问题。

我想在删除数据库中的值之前弹出一个确认屏幕。通过单击图标/按钮调用弹出屏幕。但是，当我按下“确定”时，值被删除，当我按下“取消”时也是如此。

这是我的代码：

```
<script type="text/javascript">
function confirmation() {
    var answer = confirm("Weet u zeker dat u deze activiteit wilt verwijderen?")
    if (answer){
        alert("De activiteit wordt nu verwijderd.")
        window.location = "roosters_verwijderen.php";
    }
    else{
        alert("De activiteit is niet verwijderd.")

    }
}
</script> 
```

按钮：

```
<a href="roosters_verwijderen.php?activiteitID='. $row['activiteitID'] .'" onclick="confirmation()" value=""><IMG src="iconen/kruis.png" border="0"></a> 
```

有谁看到问题是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T14:33:59.137

将“onclick”更改为`confirmation(); return false`

这将阻止浏览器执行您的`<a>`标签的默认操作。现在，您将遇到的另一个问题是编码到`<a>`标签中的“id”值在您的函数中不存在。我猜你可以将它作为参数传递。

# android - 巨大的 HttpPost 响应：JSON

> ID：11209697
> 
> 赞同：1
> 
> 时间：2012-06-26T14:32:43.280
> 
> 标签：android, json, http, bufferedreader

我正在发送一个 HttpPost 请求并以 JSON 格式获取响应。但是，由于响应如此巨大，与我在浏览器中看到的相比，我只收到一小部分响应。我的代码如下：

```
StringBuilder builder = new StringBuilder();
HttpPost httpPost = new HttpPost(uri);
HttpResponse response = client.execute(httpPost);
HttpEntity entity = response.getEntity();
InputStream content = entity.getContent();
BufferedReader reader = new BufferedReader(new InputStreamReader(content));
String line;
while ((line = reader.readLine()) != null) {
    builder.append(line);
} 
```

由于默认缓冲区大小为 8192 个字符。我只是尝试提供更多价值，但这没关系。所以，关于这个的任何建议......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T16:45:33.643

我认为 +Che Jami 在 OP 中有所作为。

Manjunath，logcat 一次只会输出 1024 个字符。您是否尝试过一次输出字符串生成器 1024 个字符？读入字符串后是否检查了字符串的长度？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-26T14:49:52.443

在您的回复中仅发送您的完整回复的块（批次），并且在您的回复未完成时使用轮询。

# xml - 为具有 XMLSchemaType(name="date") 的 XMLGregorianCalendar 创建 xml 适配器

> ID：11209701
> 
> 赞同：1
> 
> 时间：2012-06-26T14:32:54.840
> 
> 标签：xml, jaxb

我想为具有 @XMLSchemaType(name="date") 的属性创建客户 JAXB 适配器

我怎样才能做到这一点？

谢谢， 哈里什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:47:25.217

您可以使用`XmlAdapter`. 如果你`XmlAdapter`是这样的：`XmlAdapter<Date, MyDateType>`那么实际的 XML 元素的类型应该是“xs:date”，而你的 Java 对象的类型应该是 MyDateType。

# javascript - GetElementById 找不到 ID

> ID：11209702
> 
> 赞同：1
> 
> 时间：2012-06-26T14:32:57.037
> 
> 标签：javascript, getelementbyid

嗨，我一直在研究这个代码，它为每个单词创建一个带有单选按钮的表格。目前效果很好，但是我没有在单选按钮上创建点击功能并提交。单击时它们都会调用被调用的函数，但是一旦在函数中，我调用`getElementById`以验证或更改颜色，则找不到 ID，或者至少这是我的假设，因为发出警报后，什么都没有出现。

我在 javascript 方面相对较新，所以任何建议都会有所帮助。有人告诉我，这可能是因为它们在创建之前就被调用了，但从我在代码中看到的情况来看，情况并非如此。有什么建议么？

**编辑：**

这是出现问题的代码。只有西班牙语有一次点击它。没有提交验证，因为我认为它们是同一个问题

```
for (i = 0; i < sentences.length; i++) {
    document.write('<p><a onclick ="javascript:ShowHide(\'Sentence' + (i + 1) + '\')" href="javascript:;"><font color="#0000FF"><u>Sentence' + (i + 1) + '</u></font></a></p>');
    document.write('<table style="display: none; table-layout: fixed" id="Sentence' + (i + 1) + '" border = "1">');
    writeSentence(i, words, "Sentences");
    document.write('</table>');
    document.write('<input type="checkbox" name="Sentence_lang ' + (i + 1) + '" id = "Sentence_lang ' + (i + 1) + '" value="All_English" /> All English    ');
    document.write('<input type="checkbox" name="Sentence_lang ' + (i + 1) + '" id = "Sentence_lang ' + (i + 1) + '" value="All_Spanish" /> All Spanish <br />');
}
document.write('</p>')

function writeSentence(i, array, name) {
    var Name = name;
    document.write('<tr>');
    document.write('<td>');
    document.write('</td>');
    for (j = 0; j < array[i].length; j++) {
        var word = array[i][j];
        document.write('<td>');
        if (Name == "Sentences") document.write('<span class="kept" id="word_' + i + '_' + j + '">');
        document.write(word);
        if (Name == "Sentences") document.write('</span> ');
        document.write('</td>');
    }
    document.write('</tr>');
    document.write('<td>');
    document.write('English');
    document.write('</td>');
    for (j = 0; j < array[i].length; j++) {
        document.write('<td>');
        document.write('<input type="radio" name="' + Name + (i + 1) + '_' + (j) + '" id="Eng_' + (i + 1) + '_' + (j) + '" value="English" >');
        document.write('</td>');
    }
    document.write('</tr>');
    document.write('<tr>');
    document.write('<td>');
    document.write('Spanish');
    document.write('</td>');
    for (j = 0; j < array[i].length; j++) {
        document.write('<td>');
        document.write('<input type="radio" onclick = "color(' + i + ',' + j')" name="' + Name + (i + 1) + '_' + (j) + '" id="Spa_' + (i + 1) + '_' + (j) + '" value="Spanish"> ');
        document.write('</td>');
    }
    document.write('</tr>');
    document.write('<tr>');
    document.write('<td>');
    document.write('Other');
    document.write('</td>');
    for (j = 0; j < array[i].length; j++) {
        document.write('<td>');
        document.write('<input type="radio"  name="' + Name + (i + 1) + '_' + (j) + '" id="Other_' + (i + 1) + '_' + (j) + '" value="other" > ');
        document.write('</td>');
    }
    document.write('</tr>');
    if (Name == "Sentences") for (j = 0; j < array[i].length; j++)
    document.write('<input type="radio" input style= "display: none" name="' + Name + (i + 1) + '_' + (j) + '" id="' + Name + (i + 1) + '_' + (j) + '" value="Norm" checked>');
}

function color(i, j,lang) {
    var word = document.getElementById('word_' + i + '_' + j + '');
    aleart(word);
    if (lang == "Spa") word.className = "blue";
} 
```

编辑最后一个 if 语句是我想要做的。第三个参数目前为空，因为我无法弄清楚如何正确传递字符串 Spa。但如果需要，我可以解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:39:08.327

您有一个错字：`aleart(word);`，该错误应该在您的控制台中可见。将其更改为`alert(word);`并应出现警报框。

除此之外，您不应使用`document.write`. 一旦加载文档，它将无法工作。请参阅[document.write](https://stackoverflow.com/q/10762202/1048572)的替代方案或[document.write 的替代方案是什么？](https://stackoverflow.com/q/4537963/1048572)

# ruby-on-rails - has_many + accept_nested_attributes_for + :update_only => true

> ID：11209708
> 
> 赞同：2
> 
> 时间：2012-06-26T14:33:10.183
> 
> 标签：ruby-on-rails, associations

据我所知，update_only 不适用于 has_many 关联。

我正在更新嵌套属性，它每次都会创建新的孩子并且不会删除旧的孩子。在每次更新时自动删除它们的好方法是什么（模仿适用于 has_one 的 :update_only 行为）？

我知道：allow_destroy。但是，我没有孩子的身份来让 rails 知道应该销毁什么。

PS 我最初在 2012 年问过这个问题，然后我找到了一个 hacky 解决方案来覆盖 assign_nested_attributes_for_collection_association。我想知道 Rails 中是否引入了任何东西来解决这个问题。它看起来像非常常见的简单案例。我想知道为什么有一个内置的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:51:30.803

我发现的最佳方法是覆盖对象上的方法assign_nested_attributes_for_collection_association，检查关联类型。如果它是 has_many，那么在这个关联上做 destroy_all。

这样的代码可以被推广并移动到一个模块中以供进一步重用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-04T20:57:10.893

这两个问题中提到的镇上似乎有更好的解决方案：

*   [Rails 4 has_many nested_attributes 替换所有](https://stackoverflow.com/questions/28591636/rails-4-has-many-nested-attributes-to-replace-all)
*   [Rails 替换集合而不是从 has_many 嵌套属性表单中添加](https://stackoverflow.com/questions/27161314/rails-replace-collection-intead-of-adding-to-it-from-a-has-many-nested-attribute)

解决方案是

```
def foo_attributes=(*attrs)
  self.foo.clear
  super(*attrs)
end 
```

# ruby-on-rails-3 - 将 firebird 数据库与 rails 3 连接

> ID：11209715
> 
> 赞同：2
> 
> 时间：2012-06-26T14:33:37.597
> 
> 标签：ruby-on-rails-3, firebird, firebird2.5

我想将我的 rails 3 应用程序连接到 firebird 数据库。我已关注

[https://help.ubuntu.com/community/Firebird2.5](https://help.ubuntu.com/community/Firebird2.5)

和

[http://mapopa.blogspot.in/2009/02/rails-on-firebird-status-after-adapter.html](http://mapopa.blogspot.in/2009/02/rails-on-firebird-status-after-adapter.html)

链接。此外，我已将 gem 'activerecord-fb-adapter' 和 gem 'fb' 包含到 gemfile 中。

但是，我收到**“没有建立 Firebird 连接”的响应。**

同时运行 rake db:create 结果

```
 {:adapter=>"fb",
  :database=>"localhost/3050:/var/lib/firebird/2.5/data/rubyonfire.fdb",
  :username=>"SYSDBA",
  :password=>"*******",
  :host=>"localhost",
  :downcase_names=>true}

 {:adapter=>"fb",
  :database=>"localhost/3050:/var/lib/firebird/2.5/data/rubyonfire_test.fdb",
  :username=>"SYSDBA",
  :password=>"*******",
  :host=>"localhost",
  :downcase_names=>true} 
```

非常感谢任何帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T06:46:17.530

在 database.yml 中添加**create: true解决了这个问题。**有关详细信息，请参阅以下链接：-

[https://github.com/rowland/activerecord-fb-adapter/issues/1#issuecomment-6608210](https://github.com/rowland/activerecord-fb-adapter/issues/1#issuecomment-6608210)

谢谢

# xml - R XML - 尝试将节点添加到内部节点时出错

> ID：11209716
> 
> 赞同：2
> 
> 时间：2012-06-26T14:33:44.933
> 
> 标签：xml, r

我正在使用 R 和 XML 包读取 XML 文件。我希望读取 XML 文档，执行一些统计计算并将结果作为子节点插入 XML 文档，然后将更新的 XML 文件保存到新位置。

这是一个说明性示例。我正在阅读的 XML 文件（insert_node_error.xml）：

```
<library>
    <book>
        <title>Book1</title>
        <author>AuthorA</author>
    </book>
    <book>
        <title>Book2</title>
        <author>AuthorB</author>
    </book>     
</library> 
```

这是我正在运行的代码：

```
#load file
file.name <- "xml\\insert_node_error.xml"
input.xml <- xmlInternalTreeParse(file.name)

#produce list of books in library (my actual code has loops and calcs here)
books.xml <- getNodeSet(input.xml, "//book")

#set price for first book as "price" node
price.xml <- xmlNode("price", 19.99)

#attempt to insert that price as child within the first book node
books.xml[[1]] <- addChildren(books.xml[[1]], price.xml) 
```

输出附加了节点，但已从其中剥离了所有 XML，并且仅提供文本。

```
> input.xml
<?xml version="1.0"?>
<library>
  <book><title>Book1</title><author>AuthorA</author>pricetext19.99</book>
  <book>
    <title>Book2</title>
    <author>AuthorB</author>
  </book>
</library> 
```

我想看看：

```
<library>
    <book>
        <title>Book1</title>
        <author>AuthorA</author>
    <price>19.99</price>
    </book>
    <book>
        <title>Book2</title>
        <author>AuthorB</author>
    </book>     
</library> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T15:43:06.333

它总是有点反复试验。你的 xmlNode 看起来不错....

```
library(XML)
#load file
file.name <- "insert_node_error.xml"
input.xml <- xmlInternalTreeParse(file.name)

#produce list of books in library (my actual code has loops and calcs here)
books.xml <- getNodeSet(input.xml, "//book")

price.xml <- xmlNode("price", 19.99)

#set price for first book as "price" node
top = newXMLNode("price",19.99)

#attempt to insert that price as child within the first book node
books.xml[[1]] = addChildren(books.xml[[1]], top)
books.xml 
```

# javascript - 在小部件中使用 Facebook API

> ID：11209724
> 
> 赞同：0
> 
> 时间：2012-06-26T14:34:20.330
> 
> 标签：javascript, facebook, backbone.js

我正在构建一个可以放置在各种站点上的小部件，并且让用户能够通过 facebook 登录连接到小部件父站点上的帐户。我打算使用 Facebook JS SDK 来执行此操作，但小部件可能会放置在已经使用不同的应用程序 ID 在其上初始化 FB JS SDK 的站点上，如果我以这种方式运行代码，它可能会导致到命名空间问题。

我想出的唯一当前解决方案是进行服务器端类型授权，并有一个重定向 URL 可以返回到托管小部件的当前页面，并使用状态参数来提醒骨干路由器用户已登录。

我想到的第一个问题是在 facebook docs 网站上它说

> 为安全起见，redirect_uri 必须与应用设置的 App Domain 属性中指定的基本域相同，或者是[https://apps.facebook.com/YOUR_APP_NAMESPACE](https://apps.facebook.com/YOUR_APP_NAMESPACE)形式的 URL 。

如何让人们在登录后回到它托管的小部件的原始页面？有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T00:24:27.633

您可以使用服务器端身份验证和 redirect_uri 到您的站点，该站点将重定向到各个站点

重定向uri =`https://www.mydomain.com/?r=https%3A%2F%2Fwww.somesite.me`

在您的服务器上，您将查看查询参数 r 并将请求重定向到 r 值。

您还可以为用户进行自己的身份验证（当他们第一次登录时）并将 facebook access_token 存储在您的数据库中，一旦您的小部件正在运行（在 https 下）并且您在身份验证中识别了用户，您可以向小部件客户端发送用户的access_token 并使用它。

您甚至可以创建自己的 Simple FB-like ajax 库，对于大多数事情来说，这将是一个简单的 get/post/put 调用，其中 access_token 作为 url 参数

希望它有帮助

# iphone - PurgeIdleCellConnections 导致应用程序冻结然后崩溃

> ID：11209725
> 
> 赞同：19
> 
> 时间：2012-06-26T14:34:21.633
> 
> 标签：iphone, ios, xcode

我的应用程序不断快速地向我抛出这个问题，直到我们耗尽内存并挂起：

```
purgeIdleCellConnections: found one to purge conn = 0x1ddde360
purgeIdleCellConnections: found one to purge conn = 0x1dddb9a0
purgeIdleCellConnections: found one to purge conn = 0x1e87d4b0
purgeIdleCellConnections: found one to purge conn = 0x21b98a60
purgeIdleCellConnections: found one to purge conn = 0x21baeae0
purgeIdleCellConnections: found one to purge conn = 0x1dde92c0
purgeIdleCellConnections: found one to purge conn = 0x21b3a3a0
purgeIdleCellConnections: found one to purge conn = 0x21ce0a40
purgeIdleCellConnections: found one to purge conn = 0x1e81b4d0
purgeIdleCellConnections: found one to purge conn = 0x21987880
purgeIdleCellConnections: found one to purge conn = 0x21994d50
purgeIdleCellConnections: found one to purge conn = 0x21b463b0
purgeIdleCellConnections: found one to purge conn = 0x1e81b2b0
purgeIdleCellConnections: found one to purge conn = 0x1dde2130
purgeIdleCellConnections: found one to purge conn = 0x1dd02cc0
purgeIdleCellConnections: found one to purge conn = 0x21987130
purgeIdleCellConnections: found one to purge conn = 0x1e89b610
purgeIdleCellConnections: found one to purge conn = 0x21a7c5a0
purgeIdleCellConnections: found one to purge conn = 0x219307e0
purgeIdleCellConnections: found one to purge conn = 0x21b44240
purgeIdleCellConnections: found one to purge conn = 0x21b6f290
purgeIdleCellConnections: found one to purge conn = 0x219c1db0
purgeIdleCellConnections: found one to purge conn = 0x1e81c5f0
purgeIdleCellConnections: found one to purge conn = 0x21957890
purgeIdleCellConnections: found one to purge conn = 0x21cd86f0
purgeIdleCellConnections: found one to purge conn = 0x21cd6660
purgeIdleCellConnections: found one to purge conn = 0x21b43140
purgeIdleCellConnections: found one to purge conn = 0x21cd4400 
```

知道这是什么吗？我对iOS相当陌生，但我找不到任何东西。

希望有人以前见过这个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T13:26:11.667

Apple 开发者论坛中正在对此进行讨论：[https ://devforums.apple.com/message/687713#687713](https://devforums.apple.com/message/687713#687713)

# android - 如何使用 Azure 中包含的 android 中的 wsdl 服务

> ID：11209729
> 
> 赞同：0
> 
> 时间：2012-06-26T14:34:35.943
> 
> 标签：android, soap, azure, wsdl

1).我从 WSDL 生成 Web 服务客户端（使用 Axis2 1.5 carnel、wsdl2java、Tomcat 7.0）；

2）。从 Android 访问 JAX-WS Web 服务使用 KSoap2-android 库（我在服务[http://www.webservicex.net/ConvertWeight.asmx](http://www.webservicex.net/ConvertWeight.asmx)上测试了这个库，它工作正常）。但是使用 [http://xxx.svc?wsdl](http://xxx.svc?wsdl) 我无法连接到该服务。当我从 Android Progect 生成 Web 服务客户端时，我收到此错误：“IWAB0399E 从 WSDL 生成 Java 时出错：java.io.IOException：发射器失败。WSDL 文档中有一个未定义的绑定 (BasicHttpBinding_ICustomerService)。提示：确保完全合格。”

3）。从 Web 服务客户端我制作了 service.jar，它在 Android Progect 上使用如何 lib，但无法正常工作。

4）。当我使用 ksoap2 时，出现此错误：

[2012-06-26 17:25:33 - TranscribeMe_2.2] Dx 1 错误；中止 [2012-06-26 17:25:33 - TranscribeMe_2.2] 转换为 Dalvik 格式失败，出现错误 1 ​​[2012-06-26 17:26:32 - TMP] Dx 警告：忽略匿名内部类的 InnerClasses 属性(org.ksoap2.transport.KeepAliveHttpsTransportSE$1) 没有关联的 EnclosureMethod 属性。此类可能是由不针对现代 .class 文件格式的编译器生成的。推荐的解决方案是从源代码重新编译类，使用最新的编译器并且不指定任何“-target”类型选项。忽略此警告的后果是此类上的反射操作将错误地指示它*不是*一个内部类。[2012-06-26 17:26:33 - TMP] Dx 故障处理“javax/xml/ws/Dispatch.class”：

不构建核心库时对核心类（java.* 或 javax.*）的不明智或错误使用。

这通常是由于在使用 IDE（例如 Eclipse）时无意中在应用程序的项目中包含了核心库文件。如果您确定您不是故意定义核心类，那么这是对正在发生的事情的最可能的解释。

但是，您实际上可能正在尝试在核心命名空间中定义一个类，例如，您可能从非 Android 虚拟机项目中获取了该类的源代码。这肯定是行不通的。至少，它会危及您的应用程序与平台未来版本的兼容性。它的合法性也经常受到质疑。

如果你真的打算构建一个核心库——它只适合作为创建完整虚拟机发行版的一部分，而不是编译应用程序——然后使用“--core-library”选项来抑制这个错误消息。

如果您继续使用“--core-library”，但实际上正在构建应用程序，那么请预先警告您的应用程序在某些时候仍将无法构建或运行。请为愤怒的客户做好准备，他们会发现，例如，一旦他们升级操作系统，您的应用程序就会停止运行。你会为这个问题负责。

如果您合法地使用了一些恰好位于核心包中的代码，那么您拥有的最简单安全的替代方法是重新打包该代码。也就是说，将有问题的类移动到您自己的包命名空间中。这意味着它们永远不会与核心系统类发生冲突。JarJar 是一个可以帮助您完成这项工作的工具。如果你发现你做不到这一点，那么这表明你所走的道路最终会导致痛苦、痛苦、悲伤和悲叹。

[2012-06-26 17:26:33 - TMP] Dx 1 错误；中止 [2012-06-26 17:26:33 - TMP] 转换为 Dalvik 格式失败，错误 1

请帮我...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:12:17.423

如果您将在 StackOverFlow 中搜索 Axis 和 WCF/WSDL 问题，您会发现很多没有任何答案或建议的问题，因此您无法解决很多问题

关于您的以下错误：

```
There is an undefined binding (BasicHttpBinding_ICustomerService) in the WSDL document.
Hint: make sure is fully qualified." 
```

我可以说这个问题可能与您如何定义 ICustomerService 绑定有关。由于您选择了 BasicHttpBinding，请确保所有参数都正确。如果您检查 Axis 生成的 WSDL，您将能够轻松地验证它。

此外，在某些情况下，您可能会遇到命名空间问题，这可能会导致 Axis WSDL 生成 service.svc?wsdl=wsdl0 和 service.svc?wsdl=wsdl1。如果是这种情况，您可以通过为每个数据合同添加名称空间属性以及消息头、正文和在 Web 服务端点中添加的绑定名称空间属性来解决名称空间问题。

我的第一个建议是创建一个简单的 C# 客户端应用程序并连接到您的 Windows Azure WCF 服务并验证您可以使用 BasicHttpBindings 毫无问题地进行连接，然后使用 Java 应用程序执行相同操作。如果您发现问题，请比较两者之间的网络流量以查看不同之处，这可能有助于您找出根本原因，对于非常具体的问题，请向 SO 提问，您将获得适当的帮助。祝你好运！！

# ember.js - 一起使用 ObjectController 和 ArrayController 有意义吗？

> ID：11209740
> 
> 赞同：1
> 
> 时间：2012-06-26T14:35:04.290
> 
> 标签：ember.js

我有一个对象列表，存储在 arrayController 中并使用`#each`宏在视图上呈现

```
{{#each item in controller}}
  {{view App.ItemView}}
{{/each}} 
```

每个项目视图都有依赖于用户操作的类名绑定。举个例子 ：

```
App.ItemView = Ember.View.extend {
  classNameBindings: ['isSelected:selected']
} 
```

`isSelected`取决于每个项目的状态：我必须将选定的项目存储在某处，如果触发点击事件，则将其与新的选定项目进行比较。

问题是：我应该在哪里计算这个`isSelected`属性？在`itemsController`? 在一个`itemController`？直接在每个 itemView 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T15:00:56.407

对我来说，将它放入视图中确实很有意义，而且，它确实是一个显示问题。

你在这里有一个例子：http: [//jsfiddle.net/MikeAski/r6xcA/](http://jsfiddle.net/MikeAski/r6xcA/)

**车把**：

```
<script type="text/x-handlebars" data-template-name="items">
    {{#each item in controller}}
        {{view App.ItemView contentBinding="item"}}
    {{/each}}
</script>

<script type="text/x-handlebars" data-template-name="item">
    Item: {{item.label}}
</script> 
```

**​JavaScript** :

```
App.ItemsController = Ember.ArrayController.extend({
    selected: null
});

App.ItemsView = Ember.View.extend({
    templateName: 'items'
});

App.ItemView = Ember.View.extend({
    templateName: 'item',
    classNameBindings: ['isSelected:selected'],

    isSelected: function() {
        var item = this.get('content'),
            selected = this.getPath('controller.selected');
        return item === selected;
    }.property('item', 'controller.selected'),

    click: function() {
        var controller = this.get('controller'),
            item = this.get('content');
        controller.set('selected', item);
    }
});

App.ItemsView.create({
    controller: App.ItemsController.create({
        content: [{ label: 'My first item' },
                  { label: 'My second item' },
                  { label: 'My third item' }]
    })
}).append();
​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:55:43.740

听起来您需要两件事 -`isSelected`项目本身（模型）上的一个属性，它回答了“这个项目是否被选中？”这个问题，以及一个`selectedItem`属性`itemsController`，它回答了“哪个项目被选中？”这个问题。模型上的属性只是一个获取/设置；您可以`itemsController.selectedItem`通过过滤项目列表来计算其中一个`isSelected`为真的项目，或者您可以使用一些代码明确设置它以取消选择以前未选择的项目。

# jquery - 单击标签时清除表单输入文本区域

> ID：11209750
> 
> 赞同：0
> 
> 时间：2012-06-26T14:35:38.920
> 
> 标签：jquery, forms, input, field

我有一个表格，下面有一些标签。当您单击每个标签时，它会很好地进入该字段，但目前我在该字段中有一个默认值，并希望它在您单击任一标签时消失。目前它可以工作，但是当您单击另一个标签添加到该字段时，它会使所有其他标签消失。

表单默认值为“请点击标签选择您喜欢的区域”。当您单击消失的标签时，该字段将填充其下方的选定标签。

有没有人知道我会如何做到这一点？

谢谢，马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:43:41.613

你是如何实现你的默认文本的？您可以使用 HTML5“占位符”属性来存储您的默认文本吗？

**更新** 如果我理解正确，这就是你想要做的事情，或者类似的事情，[小提琴](http://jsfiddle.net/LZM8v/)

# jsf - 如何避免特定页面中出现 web.xml 错误页面

> ID：11209751
> 
> 赞同：1
> 
> 时间：2012-06-26T14:35:39.830
> 
> 标签：jsf, web.xml, jsf-1.2

`error-pages`我的文件中有以下内容`web.xml`：

```
<error-page>
    <exception-type>javax.faces.application.ViewExpiredException</exception-type>
    <location>/pages/inactivity.jsf</location>
</error-page>

<error-page>
    <exception-type>java.lang.Throwable</exception-type>
    <location>/pages/error.jsp</location>
</error-page> 
```

问题如下：

有时，我得到`ViewExpiredException`，然后它进入`inactivity`页面，但是，似乎某些`.xhtml`文件试图使用不再处于会话中的东西，然后我通常得到`NullPointerException`. 但是，第二个错误是第一个错误的孩子，所以，我的第一个错误句柄应该足够了。

我想知道是否有一种方法可以使`error-page`特定`exception-type`页面中未显示特定页面（在我的情况下处于不活动状态）。

有没有办法做到这一点？

顺便说一句：我正在使用 JSF 1.2。

* * *

**编辑**

[完全异常](https://gist.github.com/2997436)。

另外，我刚刚意识到它不会发生在 Firefox 中，只是 chrome。不要在 IE 中测试，因为我没有它:)

# c# - 无法实例化方言类 NHibernate.Dialect.Oracle9iDialect

> ID：11209756
> 
> 赞同：1
> 
> 时间：2012-06-26T14:35:48.480
> 
> 标签：c#, .net, nhibernate

我在 Windows Server 2003 中使用带有 NHibernate-2.1.2.GA 的 Visual Studio 2005。

我尝试在我的 ASP.net 程序中将 oracle 与 NHibernate 连接起来。

要获取我的 oracle 版本，我运行以下 SQL：`select * from v$version`

结果显示 oracle 版本为`oracle9i`.

所以，我这样写`NHibernate.cfg.xml`：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-configuration  xmlns="urn:nhibernate-configuration-2.2" >
  <session-factory>
        <property name="connection.driver_class">NHibernate.Driver.OracleClientDriver</property>
        <property name="connection.connection_string">
          Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=localhost)(PORT=1521)))
          (CONNECT_DATA=(SERVICE_NAME=MYORACLE)));
          user id=team;password=team;
        </property>
        <property name="adonet.batch_size">10</property>
        <property name="show_sql">true</property>
        <property name="dialect">NHibernate.Dialect.Oracle9iDialect</property>
        <property name="use_outer_join">true</property>
        <property name="command_timeout">10</property>
        <property name="query.substitutions">true 1, false 0, yes 'Y', no 'N'</property>
        <property name="proxyfactory.factory_class">
          NHibernate.ByteCode.Castle.ProxyFactoryFactory,
          NHibernate.ByteCode.Castle
        </property>
        <mapping assembly="NHibernateSample.Domain"/>
      </session-factory>
    </hibernate-configuration> 
```

现在，当我运行尝试连接 oracle 并执行查询 sql 的测试单元时：

```
 private ISession _session;
    private SessionManager _helper;
    private NHibernateSample _sample;
    public void TestFixtureSetup()
     {
            _helper = new SessionManager();
        }
        public void Setup()
        {
            _session = _helper.GetSession();
            _sample = new NHibernateSample(_session);
        }
        [NUnit.Framework.Test]
        public void GetCustomerById1Test()
        {
            TestFixtureSetup();
            Setup();
            NHibernateSample _sample = new NHibernateSample(_session);
            Assert.AreEqual(1, _sample.GetCustomerById(1).Id);
        } 
```

它报告如下错误：

```
Test 'NHibernateSample.Data.Test.NHibernateSampleFixture.GetCustomerById1Test' failed: NHibernate.MappingException : Could not compile the mapping document: NHibernateSample.Domain.Mappings.Customer.hbm.xml
  ----> NHibernate.HibernateException : Could not instantiate dialect class NHibernate.Dialect.Oracle9iDialect
  ----> System.TypeLoadException : Could not load type org.NHibernate.Dialect.Oracle9iDialect. Possible cause: no assembly name specified. 
```

我知道这是初学者的问题，但我只是一个新手！我很欣赏你的想法...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:41:13.600

再次尝试`org.`从`dialect`

```
<property name="dialect">NHibernate.Dialect.Oracle9iDialect</property> 
```

查看官方文档中的[NHibernate SQL 方言以获取更多详细信息。](http://nhibernate.info/doc/nh/en/index.html#configuration-optional-dialects)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T08:43:34.110

感谢大神，终于解决了这个问题。Thers 是结果中的一条消息，我忘记粘贴在上面，它是这样的：

```
未能从程序集“mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089”中加载类型“System.DateTimeOffset” 
```

这是因为我的 .Net2.0 版本太旧了。然后我安装 .Net2.0 SP1 并且问题修复了！同样感谢克劳迪奥·雷迪！

# perl - 从复杂的 Perl 数据结构中修剪空的和单例的数组引用

> ID：11209758
> 
> 赞同：3
> 
> 时间：2012-06-26T14:35:53.660
> 
> 标签：perl, data-structures, perl-data-structures, traversal

我正在尝试整理从 JSON 读取的 Perl 中的大型数据结构。两个典型的元素看起来像这样（在 JSON 中）：

```
[
    [ [ {'payload':'test'} ], [ [ {'payload':'reply'} ], [] ] ],
    [ [ {'payload':'another thread'} ] 
] 
```

我想完全删除该元素底部的空 arrayref，并将每个仅包含单个 hashref 的 arrayref 替换为包含的 hashref。换句话说，结果应该是这样的：

```
[
    [ {'payload':'test'}, [ {'payload':'reply'} ] ],
    [ {'payload':'another thread'} ]
] 
```

目前我的代码如下：

```
use v5.12;
use strict;
use warnings;
use JSON::XS;
use Data::Walk;

sub cleanup {
    if (ref $_ eq 'ARRAY') {
        if (scalar(@{$_}) == 0) {
            die 'mysteriously I never reach this branch!';
            while (my ($key,$value) = each @{$Data::Walk::container}) {
                if ($value == $_) {
                    delete ${$Data::Walk::container}[$key]
                }
            }
        } elsif (scalar(@{$_}) == 1 and ref @{$_}[0]) {
            $_ = @{$_}[0];
        } else {
            my $tail = ${$_}[scalar(@{$_})-1];
            if (ref $tail eq 'ARRAY' and scalar(@{$tail}) == 0) {
                $#{$_}--;
            }
        }
    }
}

sub get {
    my $begin = shift;
    $begin = 0 unless $begin;
    my $end = shift();
    $end = $begin + 25 unless $end;
    my $threads;
    {
        local $/;
        open(my $f, '<emails.json');
        $threads = decode_json <$f>;
        close($f);
    }
    $threads = [ @{$threads}[$begin .. $end] ];
    walkdepth(\&eliminate_singleton, $threads);
    return $threads;
}

print JSON::XS->new->ascii->pretty->encode(&get('subject:joke')); 
```

尽管它成功地删除了空数组引用，但它未能折叠单例。如何更正此代码以使其可以折叠单例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T18:25:07.147

我看到您想删除作为数组元素的空数组，但我不明白*将每个单例 arrayref 替换为对其元素的引用*。您是否可能打算用其内容替换作为单元素数组的每个散列值？

所以

```
[
  "data1",
  [],
  "data3",
] 
```

被转换为

```
[
  "data1",
  "data3",
] 
```

和

```
{
  "key1" : ["val1", "val2"],
  "key2" : ["val3"],
  "key3" : ["val4", "val5"],
} 
```

被转换为

```
{
  "key1" : ["val1", "val2"],
  "key2" : "val3",
  "key3" : ["val4", "val5"],
} 
```

在您的程序中，后者对应于`"tags" : ["inbox"]`成为`"tags" : "inbox"`.

如果是这种情况，那么这个版本的`eliminate_singleton`做你想要的。

它从容器节点获取视图并检查内部是否需要修改。从节点本身的角度来看这样做可能会导致节点在被扫描时被修改，这将破坏程序。实际上，从数组末尾向后循环是安全的，因为它不会删除任何未访问的节点。

```
use Scalar::Util 'reftype';

sub eliminate_singleton {

  my $node = $_;
  my $type = reftype $node // '';

  if ($type eq 'ARRAY') {
    for (my $i = $#$node; $i >= 0; $i--) {
      my $subnode = $node->[$i];
      my $subtype = reftype($subnode) // '';
      delete $node->[$i] if $subtype eq 'ARRAY' and @$subnode == 0;
    }
  }
  elsif ($type eq 'HASH') {
    for my $k (keys %$node) {
      my $subnode = $node->{$k};
      my $subtype = reftype($subnode) // '';
      if ($subtype eq 'ARRAY' and @$subnode == 1) {
        $node->{$k} = $node->{$k}[0];
      };
    }
  }
} 
```

# django - django - 带有比萨的印度语言的 HTML 到 PDF

> ID：11209764
> 
> 赞同：2
> 
> 时间：2012-06-26T14:36:08.200
> 
> 标签：django, pdf, pdf-generation, pisa

我正在使用[Pisa](https://pypi.org/project/pisa/)在 Django 中将 HTML 文件转换为 PDF 。当内容仅为英文时，它正在工作。但这里的内容将是英语和其他五种印度语言（泰米尔语、印地语、泰卢固语、马拉雅拉姆语和卡纳达语）。我在下面给出了我的代码。

**视图.py**

```
def render_to_pdf1(template_src, context_dict):
    template = get_template(template_src)
    context  = Context(context_dict)
    html     = template.render(context)
    result   = StringIO.StringIO()
    pdf      = pisa.pisaDocument(StringIO.StringIO(html.encode('UTF-8')), result)
    return result.getvalue()

def print_pdf(request):
    message = Message.objects.get(id = 1)
    html_table_string = ''
    html_table_string += '%s' % message.english
    html_table_string += '%s' % message.tamil
    html_table_string += '%s' % message.hindi
    html_table_string += '%s' % message.telugu
    html_table_string += '%s' % message.kannada
    html_table_string += '%s' % message.malayalam

    fileread = str(settings.TEMPLATE_DIRS[0])+str('/base_file.html')
    fr = open(fileread, "r").read()
    fr = fr.replace('message_content', html_table_string)
    result = StringIO.StringIO()
    filewrite = str(settings.TEMPLATE_DIRS[0]) + str('/temp_file.html')
    empty = ""
    fw = open(filewrite, 'w')
    fw.write(empty)
    fw.write(fr)
    fw.close()
    pdf_contents     = render_to_pdf1('temp_file.html',result)
    file_to_be_saved = ContentFile(pdf_contents)
    name             = (str(request.user.email) + ".pdf").replace("@", '')
    pdf              = Pdf.objects.create(name = name, user = request.user, created_by = request.user)
    pdf.name.save(name ,file_to_be_saved)
    file_path = Pdf.objects.get(user = request.user).name
    pdf_file = str(file_path).split("media")[1]
    return HttpResponseRedirect('/site_media' + pdf_file) 
```

我正在做的是：

*   有一个基本模板**base_file.html**。
*   通过 ID 获取消息对象（ID 将动态提供）。
*   然后将**message_content**替换为当前内容。
*   将其写入文件**temp_file.html**。
*   将**temp_file.html**转换为 PDF 文件。

转换后的 PDF 将包含英语、泰米尔语、印地语、泰卢固语、卡纳达语和马拉雅拉姆语的消息。但是我无法在 HTML 文件中写入其他语言内容，也无法对其进行转换。我得到的错误是`'ascii' codec can't encode characters in position 1066-1075: ordinal not in range(128)`并且发生在行中`fw.write(fr)`。

那么我该如何实现呢？我想打印包含所有这些语言内容的 PDF 文件。

# c# - 显示对象的内容

> ID：11209765
> 
> 赞同：2
> 
> 时间：2012-06-26T14:36:14.843
> 
> 标签：c#, reflection, localization

```
[Serializable]
public class SampleBase
{
    [HumanReadableAttribute("The Base")]
    public string BaseProp { get; set; } // "testing things"
    public bool AllUrBase { get; set; } // true

    public string AsHumanReadable()
    {
        var type = GetType();
        var properties = type.GetProperties();
        var stringRepresentation = new List<string>();
        foreach (var p in properties)
        {
            var ca = p.GetCustomAttributes(true).FirstOrDefault(a => a is HumanReadableAttribute);
            var v = p.GetValue(this, null);
            var t = v.GetType();
            var e = t.IsEnum ? t.GetField(Enum.GetName(t, v)).GetCustomAttributes(typeof(HumanReadableAttribute), false).FirstOrDefault() as HumanReadableAttribute : null;
            stringRepresentation.Add(string.Format("{0}: {1}", ca ?? p.Name, v is bool ? ((bool) v ? "Yes" : "No") : e ?? v));
        }
        return string.Join("\r\n", stringRepresentation);
    }
}

[Serializable]
public class SampleClass {
    public enum MyEnum {
        [HumanReadableAttribute("It makes sense")]
        MakesSense,
        [HumanReadableAttribute("It's weird")]
        Nonsense
    }
    [HumanReadableAttribute("What do you think about this")]
    public MyEnum MyProperty { get; set; } // Nonsense
} 
```

调用`AsHumanReadable`方法会产生

```
The Base: testing things
AllUrBase: Yes
What do you think about this: It's weird 
```

我的用户可以将`SampleClass`对象（或实现的各种其他对象`SampleBase`）添加到购物车，该购物车将被存储以备后用。客户服务人员将阅读输出以检查事情。

我考虑过制作 ToString 方法（如`return "The Base" + BaseProp;`）。我的第一个想法是属性方法更灵活。

这两种方法（维护、本地化（尽可能避免使用魔法字符串）等）的优缺点是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:43:18.570

我建议放弃自定义实现并查看[`ServiceStack.Text`](https://github.com/ServiceStack/ServiceStack.Text)，尤其是[`T.Dump`](http://www.servicestack.net/mythz_blog/?p=202)方法。

这是已经实现且可靠的东西。它唯一没有涵盖的是友好的布尔字符串（是/否）/。

自定义实现首先需要创建一个良好且有效的解决方案，这需要时间，然后是维护和添加对新东西的支持，这也需要时间。有很多方法可以做到这一点，属性就是其中之一，但是当你拥有`ServiceStack`.

最终，您可以修改 T.Dump 方法并自定义它们以满足您的要求。它仍然不是从头开始的东西。

# cocoa - NSView 边框颜色

> ID：11209768
> 
> 赞同：7
> 
> 时间：2012-06-26T14:36:19.917
> 
> 标签：cocoa

我正在为 NSView 应用边框，但如何更改边框颜色。将 NSColor 与 setBorderColor 一起使用会显示警告。我想在边框中使用橙色

```
 [self setWantsLayer:YES];
    self .layer.masksToBounds   = YES;    
    self.layer.borderWidth      = 6.0f ;

    [self.layer setBorderColor:CGColorGetConstantColor(kCGColorBlack)]; 
```

如何在边框中设置其他颜色（不包括黑色和白色）

问候，哈西娜

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T14:59:24.700

您需要转换为 CGColorRef

```
NSColor *orangeColor = [NSColor orangeColor];

// Convert to CGColorRef
NSInteger numberOfComponents = [orangeColor numberOfComponents];
CGFloat components[numberOfComponents];
CGColorSpaceRef colorSpace = [[orangeColor colorSpace] CGColorSpace];    
[orangeColor getComponents:(CGFloat *)&components];    
CGColorRef orangeCGColor = CGColorCreate(colorSpace, components);

// Set border
self.view.layer.borderColor = orangeCGColor;

// Clean up
CGColorRelease(orangeCGColor); 
```

或者，如果您需要 10.8+，请使用[`[aColor CGColor]`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSColor_Class/Reference/Reference.html#//apple_ref/occ/instm/NSColor/CGColor)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-06-29T12:42:31.713

您可以使用`NSBox`，它是一个子类，`NSView`旨在处理这些情况

```
let box = NSBox()
box.boxType = .custom
box.alphaValue = 1
box.borderColor = NSColor.red
box.borderType = .lineBorder
box.borderWidth = 4 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-12T11:33:34.673

哇...这些天这么简单。创建时在您的 NSView 中：

```
self.wantsLayer = YES;
self.layer.borderWidth = 1; 
```

然后在`drawRect`（以便您可以响应暗模式或其他外观的更改）设置边框颜色....并且不要忘记使用响应外观更改的系统颜色或您在支持所有外观的资产目录中定义的颜色你支持。

```
-(void)drawRect:(NSRect)rect
{
    self.layer.borderColor = [NSColor systemGrayColor];
    // or color defined in Asset Catalog
    self.layer.borderColor = [NSColor colorNamed:@"BorderColor"].CGColor;
    [super drawRect:rect];
} 
```

就是这么简单。

# wpf - 将 ViewModel 中的 ObservableCollection 同步到 Model 中的 ObservableCollection（同类型）

> ID：11209771
> 
> 赞同：0
> 
> 时间：2012-06-26T14:36:25.173
> 
> 标签：wpf, mvvm, observablecollection

我目前有几个模型对象如下：

```
public class ModelBaseClass : INotifyPropertyChanged
{
    //Members omitted for brevity, but there is a DateTime property
    //that becomes important further down (see dummy method in application controller)      
} 
```

另一个：

```
public class ModelCollectionClass : INotifyPropertyChanged
{
    private ObservableCollection<ModelBaseClass> modelBaseClasses;
    public ObservableCollection<ModelBaseClass> ModelBaseClasses
    {
        get { return modelBaseClasses; }
        set
        {
            modelBaseClasses = value;
            OnPropertyChanged(new PropertyChangedEventArgs("ModelBaseClasses");
        }
    }

    private void modelBaseClasses_CollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
    {
        OnPropertyChanged(new PropertyChangedEventArgs("ModelBaseClasses"));
    }
} 
```

然后在我的视图的一个视图模型中，我有这样的可观察集合：

```
private ObservableCollection<ModelBaseClass> modelBaseClasses;
public ObservableCollection<ModelBaseClass> ModelBaseClasses
{
    get{ return modelBaseClasses ?? (modelBaseClasses = new ObservableCollection<ModelBaseClass>()); }
    set
    {
        modelBaseClasses = value;                
        OnPropertyChanged(new PropertyChangedEventArgs("ModelBaseClasses"));
    }
}    

private ObservableCollection<ModelCollectionClass> modelCollectionClasses;
public ObservableCollection<ModelCollectionClass> ModelCollectionClasses
{
        get { return modelCollectionClasses ?? (modelCollectionClasses = new ObservableCollection<ModelCollectionClass>()); }
        set
        {
            modelCollectionClasses = value;
            OnPropertyChanged(new PropertyChangedEventArgs("ModelCollectionClasses"));                
        }
 } 
```

然后在我的应用程序控制器（代表工作到视图模型）中，我有一个虚拟方法可以加载 ModelBaseClass 集合，如下所示：

```
for (int i = 0; i < 8; i++)
{
    myViewModel.ModelBaseClasses.Add(new ModelBaseClass()
    {
       DateTimeProperty = Convert.ToDateTime("06/2" + i + "/2012 09:00:00 AM")
       //Other properties get set as well, using the i variable...
    }
} 
```

应该注意的是，这种方法中有多个 for 循环，因此我可以处理大量数据。

接下来，我有一个方法可以获取大量对象并按日期对它们进行分组，如下所示：

```
myViewModel.ModelBaseClasses
                .GroupBy(modelBaseClass => ((DateTime)modelBaseClass.DateTimeProperty).Date)
                .Select(group => group.ToList())
                .ToList()
                .ForEach(
                    list => myiewModel.ModelBaseCollections.Add(new ModelBaseCollection() { ModelBaseClasses = new ObservableCollection<ModelBaseClass>(list) })
                ); 
```

现在这就是它开始变得更加复杂的地方。在我的视图的 XAML 中，我声明了一个 ItemsControl，它的 ItemsSource 绑定到我的视图模型中的 ModelCollectionClasses 属性。它看起来像这样：

```
<ItemsControl ItemsSource="{Binding Path=DataContext.ModelCollectionClasses, RelativeSource={RelativeSource AncestorType={x:Type views:MyView}}}"
                              ItemTemplate="{StaticResource ItemsTemplate}">                    
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <StackPanel Width="{Binding ElementName=scroller, Path=ViewportWidth}"/>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
</ItemsControl> 
```

然后在这个特定视图的资源字典中，我有一个 DataTemplate 声明如下：

```
<DataTemplate x:Key="ItemsTemplate">
    <Grid DataContext="{Binding ModelBaseClasses}">            

        <DataGrid AutoGenerateColumns="False"
                  HeadersVisibility="None"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  ItemsSource="{Binding Path=DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Grid}}}"
                  SelectedItem="{Binding Path=DataContext.SelectedModelBaseClass, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type views:MyView}}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">                

            <DataGrid.Columns>                                          
                    ...Omitted for brevity...
            </DataGrid.Columns>
        </DataGrid>            
    </Grid>
</DataTemplate> 
```

现在，综上所述，我得到了我最初想要的数据的所需可视化表示。但是，我现在遇到的问题是当我想删除 ModelBaseClass 对象之一时。因为 DataGrid 的 ItemsSource 被绑定到 ModelCollectionClass 的 ModelBaseClasses 属性，而不是我的视图模型中的 ModelBaseClasses，所以当我从视图模型中找到的 ModelCollectionClass 中删除 ModelBaseClass 时，我需要以某种方式通知 ModelCollectionClass此更改也会使 UI 正确更新。

我已经看到了一些其他示例，其中有些人创建了包装类来同步模型集合和视图模型集合，但是我很难用我自己的应用程序来实现这样的事情。任何见解或有用的提示/想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T17:43:16.873

坦率地说，您的问题如此复杂，以至于我不确定我是否得到您想要做的事情。但是我在您的代码中注意到一件事：在`ModelCollectionClass`您设置`ModelBaseClass`属性但通知您设置`ModelBaseClasses`（**es**）。不确定它是否有帮助。

# javascript - 在 jQuery 中使用 grep 编写通用过滤器

> ID：11209776
> 
> 赞同：0
> 
> 时间：2012-06-26T14:36:44.783
> 
> 标签：javascript, jquery

有没有办法我可以编写以下代码更通用？

```
var result = $.grep(myObjectArray, function(e){ 

    return e.Prop1 == 'SomeVal';

}); 
```

这就是我想做的。

一个通用函数，将接受`myObjectArray`(Object Array to filter)、`Prop1`(Property name) 和`SomeVal`(Value to filter) 作为参数。

我面临的问题是我不知道如何在对象中找到 PropertyName，因为它可以是任何东西。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:39:10.130

要从对象中获取属性，只需使用

```
myObject[Prop1] 
```

要确定对象是否具有属性，请使用

```
myObject.hasOwnProperty(Prop1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:39:25.500

```
function filterObjectArray(myObjectArray, prop1, someVal) {
    return $.grep(myObjectArray, function (e) {
        return e[prop1] === someVal;
    };
} 
```

注意对象属性访问使用方括号语法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:55:08.827

它可以像这样通用吗？

```
function filterArray(inputArray,customFunction){
 return $.grep(inputArray, function(e){       return customFunction(e);  });
} 
```

where`customFunction`可以是用户定义的函数来限定对象为选中状态

例子 ：

```
var sampleArray = [{name:"Ahamed",age: 21}, 
                   {name:"AhamedX",age: 21}, 
                   {name:"Babu",age: 25}, 
                  {name:"Mustafa",age: 27} ];

function nameComparator(obj){
       return obj["name"]=="Ahamed";
}

function ageFilter(obj){
    return obj["age"]>=25;
 }

var filteredArray=filterArray(sampleArray,nameComparator);
alert(filteredArray.length);
var filteredArray=filterArray(sampleArray,ageFilter);
alert(filteredArray.length); 
```

小提琴链接：http: [//jsfiddle.net/MAq6c/](http://jsfiddle.net/MAq6c/)

# javascript - Jquery 图片悬停效果错误

> ID：11209781
> 
> 赞同：0
> 
> 时间：2012-06-26T14:37:14.110
> 
> 标签：javascript, jquery, wordpress

我检查了这个链接 SO：[Pop Images like Google Images](https://stackoverflow.com/a/7412302/59913)

并尝试设置图像悬停效果。

当我在[这里测试时一切正常](http://jsfiddle.net/roXon/HmTrw/)

```
// ibox image zoomer plugin // roXon

(function($) {
    $.fn.ibox = function() {

        // set zoom ratio //
        resize = 20;
        ////////////////////
        var img = this;
        img.parent().append('<div id="ibox" />');
        var ibox = $('#ibox');
        var elX = 0;
        var elY = 0;

        img.each(function() {
            var el = $(this);

            el.mouseenter(function() {
                ibox.html('');
                var elH = el.height();
                elX = el.position().left - 6; // 6 = CSS#ibox padding+border
                elY = el.position().top - 6;
                var h = el.height();
                var w = el.width();
                var wh;
                checkwh = (h < w) ? (wh = (w / h * resize) / 2) : (wh = (w * resize / h) / 2);

                $(this).clone().prependTo(ibox);
                ibox.css({
                    top: elY + 'px',
                    left: elX + 'px'
                });

                ibox.stop().fadeTo(200, 1, function() {
                    $(this).animate({top: '-='+(resize/2), left:'-='+wh},400).children('img').animate({height:'+='+resize},400);
                });
            });

            ibox.mouseleave(function() {
                ibox.html('').hide();
            });
        });
    };
})(jQuery);

$(document).ready(function() {
    $('.item').ibox();
}); 
```

但是当我将它添加到我的网站时，我收到以下错误

```
Uncaught TypeError: Property '$' of object [object Window] is not a function
    $('.hovermore').ibox(); 
```

我猜它是因为网站中的其他 jquery 效果。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:41:16.963

尝试使用以下代码开始您的代码：

```
jQuery(document).ready(function ($) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:43:02.897

那是因为你忘记加载 jQuery 了：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.js"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:45:03.720

在调用之前，您是否在页面中包含了 jQuery `$('.hovermore').ibox();`？

另外，我认为这无关紧要，但也要确保您使用的是最新版本的 jQuery。

您能否发布一个链接到它不起作用的页面，以便我们可以看到所有代码？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T14:48:21.183

您忘记包含 jQuery 库。

访问[此](http://jsbin.com/ifefop/edit#javascript,html,live)演示，转到 SAVE -> DOWNLOAD 并查看下载的文件。

[http://jsbin.com/ifefop/edit#javascript,html,live](http://jsbin.com/ifefop/edit#javascript,html,live)

你的文件应该有：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script> 
```

如果您将脚本放在外部文件中：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script src="js/ibox.js"></script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-26T14:54:23.517

请试试

```
jQuery(document).ready(function($) {
    $('.item').ibox();
}); 
```

或者

```
jQuery(document).ready(function() {
    jQuery('.item').ibox();
}); 
```

# oop - 哪个类设计更合适——依赖、关联或组合

> ID：11209786
> 
> 赞同：0
> 
> 时间：2012-06-26T14:37:39.193
> 
> 标签：oop, design-patterns, uml, class-design

我有三种可能的设计，我正在尝试确定哪一种更好，在哪些情况下它们会更好。所有设计的总体思路是有一个存储一些数据的数据对象和一个分析数据的分析器对象。

我需要在这些设计之间做出选择，我最喜欢 Design 2。但是，与我一起工作的开发人员正在推动设计 3，我认为这是最糟糕的。对于任何设计，我是否缺少任何优点或缺点？让我知道是否需要澄清。

## 设计一

![设计一](../Images/52f8d8f123b1551029d3dd9c74666a4f.png)

在设计 1 中，DataAnalyzer 有一个在构造期间提供的 Data 对象。当客户来电时`dataAnalyzer.analyze()`，数据被分析。在这个设计中，每个对象的职责是明确的；Data 对象只保存数据，DataAnalyzer 对象分析数据。更改存储的数据只会更改 Data 类，添加分析方法类型只会更改 DataAnalyzer 类。这种设计的一个问题是DataAnalyzer对象只能用于构建时传入的Data对象，所以如果数据对象很多，就需要创建很多DataAnalyzers。另一个缺点（从设计 3 会更清楚）是客户需要知道两个类，而不仅仅是一个。如果有更多类与 Data 关联，则客户端将必须使用所有这些类。

## 设计二

![设计二](../Images/f800e7f39db9f1d4fb4e6e91063f9479.png)

设计 2 与设计 1 非常相似，只是现在 DataAnalyzer 是可重用的（用于不同的数据对象）。客户端仍然需要使用两个类，而不是设计 3 中的一个类。职责仍然非常明确，维护也很容易。

## 设计3

![设计3](../Images/8ce3585d3e5fd4cd5b36eb8d552766ac.png)

设计 3 允许客户使用一个对象。客户可以说`data.analyze()`但不知道有关 DataAnalyzer 的任何信息。我不确定这是否违反单一责任规则；Data 对象有一个允许分析的接口，但责任实际上委托给了 DataAnalyzer。另一个问题是，无论数据是否需要分析，都会为每个创建的 Data 对象创建一个 DataAnalyzer。现在，如果添加更多功能，很多事情都会改变。如果创建了 DataPrinter 类（假设这比让数据打印数据本身更好），客户端不必担心创建 dataPrinter 对象并调用`dataPrinter.printData()`，它可以调用`data.print()`. 但是，通过添加这个类，我不得不改变 Data 的接口。向任何 DataXX 类添加更多方法会导致将方法添加到 Data 类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T16:13:06.380

**如果分析需要很长时间或大量资源，则设计 1**很有用，并且您可以使用某种缓存来使对相同数据的顺序分析运行得更快（或使用更少的资源）。
- 如果您需要存储中间结果或缓存每个正在分析的数据实例的最终结果，请使用此选项。

**如果您想要一个静态的、线程安全的分析器，该分析器可以为不同的数据反复调用，并且不需要资源来执行此操作，或者可以从资源池中为每个请求获取不同的资源，那么**设计 2很有用。****

 **如果您有各种数据类型（具有相同的基类或接口），您可以使用访问者模式、依赖注入、反射或命令模式从主类到达正确的具体数据分析器类，因此不会违反单一职责原则。

**设计 3**是一个坏主意，因为这意味着您将数据类型与对其进行的处理相结合 - 每次您想要添加或更改处理时，如果您决定使用此设计，您将诅咒您的决定 :-)

在某些语言中，例如在 C# 3.0+ 中，有一种[糖语法](http://en.wikipedia.org/wiki/Extension_method)可以使设计 2 的操作使用设计 3 的语法工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T20:56:27.637

**快速回答**

从面向对象的角度很容易想到，**Design 3**可能会更好，因为“数据”是一个对象，而“分析”似乎不仅仅是一个操作。

但是，在实践中，正如@Danny Varod 所说：数据的“糟糕耦合”。

在现实生活中，分析器变化很小，而数据变化很大，从面向对象的角度来看，分析器会改变数据，因此**设计 1**似乎更适合您的情况。

**评论**

我在业余时间使用编译器和解析器以及他们分析的编程语言。这种情况看起来与您的问题相似。解析器看起来像您的“数据分析器”，要解析的源代码看起来像您的“数据”。

关系示例：

```
................................
....+----------------------+....
....|      CPPParser       |....
....+----------------------+....
....| [+] CPPStream Source |....
....+----------+-----------+....
...............|................
...............|................
...............v................
....+----------+-----------+....
....|     <<abstract>>     |....
....|       CPPStream      |....
....+----------------------+....
................................ 
```

但是，由于我的“数据提供者”，在这种情况下，流可以被后代类替换，例如 FileStream、StringStream。

继承图示例：

```
............................................................
....+----------------------+................................
....|      CPPStream       |................................
....+----------------------+................................
....| [+] CPPStream Source |................................
....+----------+-----------+................................
...............^............................................
...............|............................................
...............|............................................
...............+---------------------------+................
...............|...........................|................
...............|...........................|................
...............|...........................|................
....+----------+-----------+....+----------+-------------+....
....|     <<concrete>>     |....|      <<concrete>>      |....
....|    CPPFileStream     |....|     CPPFileStream      |....
....+----------------------+....+------------------------+....
....| [+] String Filename  |....| [+] String StringValue |....
....+----------------------+....+------------------------+....
............................................................ 
```

怎么样，你的场景，由一个类表示的数据可以被一个后代类替换吗？

如果是这样，**设计 1**似乎更适合。

干杯。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T18:40:18.180

看看你的担忧，它看起来像分析是一种静态方法。因此，您可以拥有一个 Utility 类，该类将分析作为接受数据作为输入的静态方法。dataPrinting 可以是同一实用程序类中的另一个静态方法。如果有多种方法（算法）来分析数据，这种设计就会失败。如果这是必需的，那么策略模式可以帮助您。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T15:55:19.967

设计 3 不是很理想，因为数据分析器必须始终存在。我敢肯定，在很多情况下，您并不总是需要将该类附加到 DO。另外，我同意它违反了单一责任原则。

如果不同数据对象类型存在不同的内部机制/方法，则设计 2 可能会出现一些问题。您每次都必须重新初始化它。我认为这也违反了单一职责原则。数据分析器应该只需要担心一种类型的数据对象。每次有新数据对象进入时，它不应该重置和重做其内部工作。

设计 1 是三者中我最喜欢的，但不是我理想的设计。理想情况下，我会将数据对象传递给分析器工厂。工厂为该特定数据对象生成一个分析器，然后分析器可以完成它的工作。这可能是最可维护的解决方案。**

# python - 在整个 python 中使用变量的正常方式

> ID：11209787
> 
> 赞同：4
> 
> 时间：2012-06-26T14:37:40.490
> 
> 标签：python

在 python 脚本顶部为程序声明配置变量的标准方法是什么？这些在整个程序中用于多个类和函数。是最好的方法：

1.  使用配置选项创建混合字典，并将它们传递给需要它们的任何类。缺点：这需要传递额外的属性。例如：

    ```
    config = {'parseTags': {'title','font','p'},    
        'name': 'steve',                
        'logFrequencies': 10,               
        'print_rate': False  
        } 
    ```

    ```
    newCustomObject = CustomClass(config)
    customfunction(config)
    print 'hi',config['name'] 
    ```

2.  在文件开头创建全局变量并在整个程序中调用它们。缺点：破坏了类的封装。

3.  别的东西。

这样做的最pythonic方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T14:44:22.973

对于单个文件（模块）中使用的常量，我通常只是在顶部声明全局变量。这不会以任何有意义的方式失去封装（这与将这些常量放在每个类都继承自的基类中没有什么不同）。

django 配置系统提供了一种创建共享常量的好方法：您创建一个模块，配置系统从中创建一个只读对象，公开模块的成员。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T14:45:00.570

好吧，选项1与选项2实际上并没有那么大的区别。选项 1 中的字典本身是全局的，字典中的值是硬编码的。

我不知道最 Pythonic 的方法是什么，但我会在一个单独的配置文件中提取配置并使用 Python 的标准[ConfigParser](http://docs.python.org/library/configparser.html)模块来读取它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T14:46:19.710

当使用类并且配置选项作为其成员（不是实例成员）访问时，我发现它最易读，即：

```
class config:
    option = 3

# code code code
foo = config.opt 
```

然后，如果它变大，您可以轻松地将其从文件中放入模块中，然后执行`import config from config`.

# c++ - C++ 枚举评估为意外值

> ID：11209788
> 
> 赞同：1
> 
> 时间：2012-06-26T14:37:42.863
> 
> 标签：c++, arrays, enums

我有一个定义如下的枚举，所以期望它返回 0-6 之间的值

```
enum blocks
{ none = 0, red, green, blue, yellow, white, black };

Grid<blocks> gameGrid; // initialised to none 
```

我正在尝试将枚举用作包含块颜色的数组的偏移量。但是`gameGrid[y][x]`返回的数字超出了上述范围，导致分段错误。

```
fixedColor = colourArray[gameGrid[y][x]]; 
```

我检查了 y 和 x 在范围 (0-19) 内，gdb 报告：

> ```
> (gdb) print y
> $1 = 19
> (gdb) print x
> $2 = 5
> (gdb) print gameGrid[y][x]
> $3 = (blocks &) @0x8201dc4: 136172580 
> ```

下面是网格的定义：

```
template <typename T>
class Grid
{
    std::deque<Row<T> > rows;
    T defaultValue;

public:
    const unsigned width, height;

    Grid(unsigned inWidth, unsigned inHeight, T inValue) : defaultValue(inValue), width(inWidth), height(inHeight)
    {
        Row<T> r(width, inValue);  
        for (unsigned i = height; i; --i)        
            rows.push_back(r);
    }    

    Row<T>& operator[](unsigned arg) { return rows[arg]; } 
```

......

至于行：

```
template <typename T>
class Row
{
public:
    std::vector<T> elements;
    Row(unsigned inWidth, T inValue) : elements(inWidth, inValue) {};
    T& operator[](unsigned arg) { return elements[arg]; } 
```

……

我打电话给：

```
Game::Game(App& inApp) : theApp(inApp), bgColour(sf::Color::Black), gridWidth(10), gridHeight(20), gameGrid(gridWidth, gridHeight, blocks::none), 
```

......

我很好奇积木类型的 gameGrid 的值如何评估为 136172580。对我所缺少的任何想法将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:43:34.150

这感觉很像一个未初始化的变量问题——在所有情况下，您都没有在网格中初始化您的枚举。当您使用 gdb 时，您可能在 Linux 平台上。您是否尝试过通过[valgrind](http://valgrind.org/)运行您的 exe ？它会告诉你这些事情......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:47:09.547

我的心理调试能力告诉我，您`gameGrid`是根据向量的向量（或类似向量）实现的，并且其中一个向量的范围不够大（您是否忘记调用`push_back`或`resize`？）：您正在运行用您选择的`x`和关闭空间的尽头`y`。一旦您超出了您的空间范围，所有关于您读取的内存值的赌注都将被取消。

从您的问题来看，您很可能来自 C 或 C++ 以外的语言。在 C++ 中，虽然它为您提供了帮助编写正确代码的重要工具，但仍有各种各样的错误代码仍然可以正常编译。编译器假定您知道自己在做什么并分配了适当的内存量。如果您编写了不正确的代码，C++ 可以让您从几乎任意内存中读取，因此您可能会为您的枚举类型获得一个看似无效/垃圾的值，这并不奇怪。

编辑：这里想到的一个新想法。如果在`sf::Style::Fullscreen Game::Game`类中您的`gameGrid`成员在宽度和高度成员之前声明，它将首先使用垃圾值初始化。您在构造函数中列出它们的顺序与它们实际初始化的顺序无关。g++ 甚至对此有警告。

# c# - 从数组中获得最低 n 的最快方法

> ID：11209797
> 
> 赞同：10
> 
> 时间：2012-06-26T14:38:33.753
> 
> 标签：c#, arrays

我需要从双精度数组中找到 n 最低的（不是 0）（我们称之为数组*samples*）。我需要在循环中多次执行此操作，因此执行速度至关重要。我尝试先对数组进行排序，然后取前 10 个值（不是 0），然而，虽然 Array.Sort 据说很快，但它成为了瓶颈：

```
const int numLowestSamples = 10;

double[] samples;

double[] lowestSamples = new double[numLowestSamples];

for (int count = 0; count < iterations; count++) // iterations typically around 2600000
{
    samples = whatever;
    Array.Sort(samples);
    lowestSamples = samples.SkipWhile(x => x == 0).Take(numLowestSamples).ToArray();
} 
```

因此，我尝试了一个不同但不太干净的解决方案，首先读取前 n 个值，对它们进行排序，然后循环遍历*样本*中的所有其他值，检查该值是否小于排序后的*最低样本*数组中的最后一个值。如果该值较低，则将其替换为数组中的值并再次对数组进行排序。结果证明这快了大约 5 倍：

```
const int numLowestSamples = 10;

double[] samples;

List<double> lowestSamples = new List<double>();

for (int count = 0; count < iterations; count++) // iterations typically around 2600000
{
    samples = whatever;

    lowestSamples.Clear();

    // Read first n values
    int i = 0;
    do
    {
        if (samples[i] > 0)
            lowestSamples.Add(samples[i]);

        i++;
    } while (lowestSamples.Count < numLowestSamples)

    // Sort the array
    lowestSamples.Sort();

    for (int j = numLowestSamples; j < samples.Count; j++) // samples.Count is typically 3600
    {
        // if value is larger than 0, but lower than last/highest value in lowestSamples
        // write value to array (replacing the last/highest value), then sort array so
        // last value in array still is the highest
        if (samples[j] > 0 && samples[j] < lowestSamples[numLowestSamples - 1])
        {
            lowestSamples[numLowestSamples - 1] = samples[j];
            lowestSamples.Sort();
        }
    }
} 
```

虽然这工作相对较快，但我想挑战任何人提出更快更好的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:50:02.317

这称为选择算法。

此 Wiki 页面上有一些通用解决方案：

[http://en.wikipedia.org/wiki/Selection_algorithm#Selecting_k_smallest_or_largest_elements](http://en.wikipedia.org/wiki/Selection_algorithm#Selecting_k_smallest_or_largest_elements)

（但您必须做一些工作才能转换为 c#）

您可以使用 QuickSelect 算法找到第 n 个最低的元素，然后遍历数组以获取每个元素 <= 那个元素。

这里有一个 C# 中的 QuickSelect 示例：http: [//dpatrickcaldwell.blogspot.co.uk/2009/03/more-ilist-extension-methods.html](http://dpatrickcaldwell.blogspot.co.uk/2009/03/more-ilist-extension-methods.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:49:50.240

理想情况下，您只想对集合进行一次传递，因此您的解决方案非常巧妙。但是，当您只需要提升其前面的数字时，您会在每次插入时使用整个子列表。但是，对 10 个元素进行排序几乎可以忽略不计，增强它并不会真正给您带来太多好处。对于您的解决方案，最坏的情况（就浪费的性能而言）是如果您从一开始就有 9 个最低的数字，因此对于您发现的每个后续数字 < `lowestSamples[numLowestSamples - 1]`，您将对一个已经排序的列表进行排序（这是最坏的情况快速排序的场景）。

最重要的是，由于您使用的数字很少，因此考虑到使用托管语言执行此操作的开销，您无法进行很多数学改进。

对酷算法的赞誉！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T15:17:49.223

无需重复排序最低样本，只需将样本插入它所在的位置：

```
int samplesCount = samples.Count;

for (int j = numLowestSamples; j < samplesCount; j++)
{
    double sample = samples[j];

    if (sample > 0 && sample < currentMax)
    {
        int k;

        for (k = 0; k < numLowestSamples; k++)
        {
           if (sample < lowestSamples[k])
           {
              Array.Copy(lowestSamples, k, lowestSamples, k + 1, numLowestSamples - k - 1);
              lowestSamples[k] = sample;

              break;
           }
        }

        if (k == numLowestSamples)
        {
           lowestSamples[numLowestSamples - 1] = sample;
        }

        currentMax = lowestSamples[numLowestSamples - 1];
    }
} 
```

现在，如果 numLowestSamples 需要非常大（接近 samples.count 的大小），那么您可能希望使用可能更快的优先级队列（通常为 O(logn) 来插入新样本而不是 O(n/ 2) 其中 n 是 numLowestSamples)。优先级队列将能够有效地插入新值并在 O(logn) 时间敲掉最大值。

当 numLowestSamples 为 10 时，真的不需要它——特别是因为您只处理双精度数而不是复杂的数据结构。对于堆和小 numLowestSamples，为堆节点（大多数优先级队列使用堆）分配内存的开销可能大于任何搜索/插入效率增益（测试很重要）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-26T15:33:53.800

两种不同的想法：

1.  无需对数组进行排序，只需对其执行一次[插入排序](https://en.wikipedia.org/wiki/Insertion_sort)。您已经知道新添加的项目将是唯一未排序的项目，因此请使用该知识。
2.  看看[堆排序](https://en.wikipedia.org/wiki/Heapsort)。它构建一个二进制最大堆（如果你想从最小到最大排序），然后通过将索引 0 处的最大元素与仍然是堆的一部分的最后一个元素交换来开始从堆中删除元素。现在，如果您假装从最大到最小的元素对数组进行排序，则可以在对 10 个元素进行排序后停止排序。数组末尾的 10 个元素将是最小的，剩余的数组仍然是数组表示中的二进制堆。我不确定这将如何与[Wikipedia 上基于 Quicksort 的选择算法进行](https://en.wikipedia.org/wiki/Selection_algorithm#Selecting_k_smallest_or_largest_elements)比较。无论您要选择多少个元素，都将始终为整个数组构建堆。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-26T15:51:12.010

我认为你的想法是正确的。即，一次通过并保持最小大小的排序数据结构通常是最快的。您对此的性能改进是优化。

您的优化将是：1）您每次通过都对结果进行排序。这对于小尺寸可能是最快的，但对于较大的套装来说不是最快的。考虑可能有两种算法，一种用于低于给定阈值，另一种（如堆排序）用于高于阈值。2) 跟踪必须从最小集合中删除的任何值（您当前通过查看最后一个元素来执行此操作）。您可以跳过插入和排序任何大于或等于被踢出的任何值的值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-26T14:47:17.510

我认为您可能想尝试维护最小堆并测量性能差异。这是我一直在研究的称为斐波那契堆的数据结构。它可能需要做一些工作，但你至少可以检验我的假设。

```
public sealed class FibonacciHeap<TKey, TValue>
{
    readonly List<Node> _root = new List<Node>();
    int _count;
    Node _min;

    public void Push(TKey key, TValue value)
    {
        Insert(new Node {
            Key = key,
            Value = value
        });
    }       

    public KeyValuePair<TKey, TValue> Peek()
    {
        if (_min == null)
            throw new InvalidOperationException();
        return new KeyValuePair<TKey,TValue>(_min.Key, _min.Value);
    }       

    public KeyValuePair<TKey, TValue> Pop()
    {
        if (_min == null)
            throw new InvalidOperationException();
        var min = ExtractMin();
        return new KeyValuePair<TKey,TValue>(min.Key, min.Value);
    }

    void Insert(Node node)
    {
        _count++;
        _root.Add(node);
        if (_min == null)
        {
            _min = node;
        }
        else if (Comparer<TKey>.Default.Compare(node.Key, _min.Key) < 0)
        {
            _min = node;
        }
    }

    Node ExtractMin()
    {
        var result = _min;
        if (result == null)
            return null;
        foreach (var child in result.Children)
        {
            child.Parent = null;
            _root.Add(child);
        }
        _root.Remove(result);
        if (_root.Count == 0)
        {
            _min = null;
        }
        else
        {
            _min = _root[0];
            Consolidate();
        }
        _count--;
        return result;
    }

    void Consolidate()
    {
        var a = new Node[UpperBound()];
        for (int i = 0; i < _root.Count; i++)
        {
            var x = _root[i];
            var d = x.Children.Count;
            while (true)
            {   
                var y = a[d];
                if (y == null)
                    break;                  
                if (Comparer<TKey>.Default.Compare(x.Key, y.Key) > 0)
                {
                    var t = x;
                    x = y;
                    y = t;
                }
                _root.Remove(y);
                i--;
                x.AddChild(y);
                y.Mark = false;
                a[d] = null;
                d++;
            }
            a[d] = x;
        }
        _min = null;
        for (int i = 0; i < a.Length; i++)
        {
            var n = a[i];
            if (n == null)
                continue;
            if (_min == null)
            {
                _root.Clear();
                _min = n;
            }
            else
            {
                if (Comparer<TKey>.Default.Compare(n.Key, _min.Key) < 0)
                {
                    _min = n;
                }
            }
            _root.Add(n);
        }
    }

    int UpperBound()
    {
        return (int)Math.Floor(Math.Log(_count, (1.0 + Math.Sqrt(5)) / 2.0)) + 1;
    }

    class Node
    {
        public TKey Key;
        public TValue Value;
        public Node Parent;
        public List<Node> Children = new List<Node>();
        public bool Mark;

        public void AddChild(Node child)
        {
            child.Parent = this;
            Children.Add(child);
        }

        public override string ToString()
        {
            return string.Format("({0},{1})", Key, Value);
        }
    }
} 
```

# facebook - Facebook 身份验证对话框 - 将数据传递到 redirect_uri

> ID：11209799
> 
> 赞同：1
> 
> 时间：2012-06-26T14:38:43.343
> 
> 标签：facebook, parameter-passing, facebook-authentication

我在需要 facebook 访问的页面之间传递数据时遇到问题。

这是一个简单的示例：
第 1 页 - 有数据 ({str:"123"}) （但仍然没有获得 facebook 访问权限）
然后它重定向到 facebook_authentication 重定向到 redirect_uri （第 2 页）
第 2 页 - 需要从第一页获取数据，但它被 facebook auth 对话框打断。（第 2 页需要 facebook 访问才能提交 str 数据）。

有什么方法可以将数据从第一页通过身份验证对话框传递到第二页？
像这样：auth_url..parameters..?str=123 然后我会在第 2 页得到它，就像这样 $_GET['str'];

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:46:28.587

我们在 oAuth 流程实现过程中遇到的同样的问题，两种可能的解决方案是

1.  将您的数据保存在第 1 页的 cookie 中并在第 2 页读取 cookie。

2.  其他解决方案是将数据放入会话中。

如果是用户特定的数据，我会建议使用 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:49:44.070

我写了一个在 facebook 上运行过的应用程序，也不得不处理这个问题。我用过这样的东西

```
$sAppId = '12345567999455';

$sFBUrl = 'http://www.facebook.com/pages/<name>/<id>?sk=app_<app_id>&app_data=key:val;key:val';

$sDialogUrl = 'https://www.facebook.com/dialog/oauth?client_id=' . $sAppId . '&redirect_uri=' . urlencode($sFBUrl)

echo "<script>top.location.href='" . $sDialogUrl . "'</script>"; 
```

然后解析数据

```
$aAppData = explode(';', $aSignedRequest['app_data']); 
```

这为您的案例带来了解决方案

```
https://www.facebook.com/dialog/oauth?client_id=app_id&redirect_uri=your_url?str=123 
```

在我的上一个应用程序中，我使用了我在这里解释的技巧：[SSO Website-Network with Facebook Login](https://stackoverflow.com/questions/10599778/sso-website-network-with-facebook-login/11013193#11013193)

问候

# c# - 没有默认构造函数的对象的 System.Configuration.Cast 失败

> ID：11209806
> 
> 赞同：0
> 
> 时间：2012-06-26T14:39:22.427
> 
> 标签：c#, configuration, console

正在执行以下操作：

```
var temp = ConfigurationManager.AppSettings.Cast<KeyValueConfigurationElement>(); 
```

上面的行抛出一个错误，说它无法投射。我可能看到的原因是 KeyValueConfigurationElement 类只有一个参数化的构造函数。没有默认构造函数。

你能帮忙解决这个问题吗？

谢谢尼山特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:59:49.027

您可以创建一个扩展方法来转换值。

```
public static class NameValueCollectionExtensions
{
    public static KeyValueConfigurationCollection CastToConfigurationCollection(this NameValueCollection settings)
    {
        var collection = new KeyValueConfigurationCollection();

        for (int i = 0; i < settings.Count; i++)
        {
            var keyValue = new KeyValueConfigurationElement(settings.Keys[i], settings[i]);
            collection.Add(keyValue);
        }

        return collection;
    }
} 
```

**用法**

```
var configurationCollection = ConfigurationManager.AppSettings.CastToConfigurationCollection(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:43:25.980

显式进行转换

```
var temp = ConfigurationManager.AppSettings
    .Cast<object>()
    .Select((a, i) => new KeyValueConfigurationElement(
                              ConfigurationManager.AppSettings.GetKey(i),
                              a.ToString())); 
```

`AppSettings`是一个`NameValueCollection`实现非泛型`IEnumerable`接口的。因此`.Cast<object>()`需要将其转换`IENumerable<T>`为后续的 LINQ-Select。

# dll - PInvoke C# 到 C++。字符串末尾的奇怪字符

> ID：11209810
> 
> 赞同：3
> 
> 时间：2012-06-26T14:39:27.917
> 
> 标签：dll, pinvoke, intptr

我几乎阅读了有关该主题的所有问题，但仍然没有解决方案。

这是DLL函数：

```
int start(char* ipad, char* porta, char* codec, char* key_TX, char* key_RX){

FILE *myfile;
myfile = fopen("parameters.txt", "w");

fprintf(myfile, "Ip: %s\nPort: %d\nCodec: %s\nkeyTX: %s\nkeyRX: %s\n",ipad, porta, codec, key_TX, key_RX);

fclose(myfile); 
//Do something with my parameters
return 0;
} 
```

在我的 C# 应用程序中，我已经尝试不成功地传递字符串和 StringBuilder 参数。在[这个](https://stackoverflow.com/questions/684133/passing-c-sharp-data-type-parameters-to-dll-written-in-c)问题中，建议使用[PInvoke Interop Assistant](http://clrinterop.codeplex.com/releases/view/14120)，并建议使用 IntPtr。这是我的包装 C# 类：

```
class MyPjMedia
{
    [System.Runtime.InteropServices.DllImportAttribute("PjLibDLL.dll", EntryPoint = "start", CharSet = CharSet.Auto)]
    private static extern int start( System.IntPtr ip, 
                                     System.IntPtr port, 
                                     System.IntPtr codec, 
                                     System.IntPtr key_TX, 
                                     System.IntPtr key_RX);

    public static int StartPjMedia()
    {
        string url = "127.0.0.1";
        string porta = "3700";
        string codec = "SPEEX/8000/1";
        string key_TX = "111111111122222222223333333333444444444455555555556666666666";
        string key_RX = "111111111122222222223333333333444444444455555555556666666666";

        IntPtr url_ptr = Marshal.StringToBSTR(url);
        IntPtr porta_ptr = Marshal.StringToBSTR(porta);
        IntPtr codec_ptr = Marshal.StringToBSTR(codec);
        IntPtr key_TX_ptr = Marshal.StringToBSTR(key_TX);
        IntPtr key_RX_ptr = Marshal.StringToBSTR(key_RX);

        int result = start(url_ptr, porta_ptr, codec_ptr, key_TX_ptr, key_RX_ptr);
        return result;
    }
} 
```

在所有情况下，结果总是相同的：parameters.txt

```
Ip:    127.0.0.1
Porta: 3700
Codec: SPEEX/8000/1L
keyTX: 111111111122222222223333333333444444444455555555556666666666ñ
keyRX: 111111111122222222223333333333444444444455555555556666666666° 
```

这是一个移动应用程序，所以我使用的是 .NET Compact Framework 3.5。

有什么建议么？感谢您的时间。

# hardware - 如何提高我的 VHDL 体验？

> ID：11209812
> 
> 赞同：-1
> 
> 时间：2012-06-26T14:39:35.247
> 
> 标签：hardware, vhdl, fpga, digital-logic

我是电子工程学院的学生，去年我们学习了 VHDL 基础知识，我想提高我在这个领域和数字设计领域的经验，我想成为这个领域的专家。我怎样才能做到这一点？我在网上搜索了很多，没有找到任何东西。请提供任何帮助。十分感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-26T16:14:21.453

对于数字设计领域的初学者，特别是可编程逻辑器件领域的初学者来说，最困难的事情之一就是认识到您正在用更高级别的编程语言描述电路。尽管该语言可能支持许多奇特的构造，但这些构造中只有一部分描述了可以在您感兴趣的目标硬件上实际实现的电路。

那么如何更好地理解这一点呢？（你的问题）

我的建议：

*   最重要的是：有（或没有）演示板的**爱好项目。**拥有硬件可以让它变得有趣，但你甚至在接触硬件之前就做了很多事情。您将在这里做很多“重新发明轮子”，只是为了学习。不要害怕在 FPGA 中实现 100 万次 UART；你将学习。
*   在您从事业余爱好项目时，请**花时间弄清楚您在 VHDL 中描述的内容与您所针对的设备的实际硬件之间的关系**。例如，一旦您综合了您的设计，研究 RTL 和/或技术视图以了解它是如何实际实现的。是你所期望的吗？
*   **阅读/参考资源**，例如面向用于综合的 VHDL 或针对 PLD 的 VHDL 的教科书。有很多关于 VHDL 的指导信息，但只有一部分适用于“现实世界实现”的世界。我还建议您查看 VHDL 2008 信息，因为 VHDL 2008 带来了一些很棒的新功能，使 VHDL 在某些情况下不那么痛苦。
*   阅读有关该主题的**论坛/新闻组**，例如 comp.arch.fpga。我发现最有趣的讨论是关于“最佳实践”的。这是一个打破教科书和演讲厅中的想法的好机会。

爱好项目的一些想法：

*   7段显示界面
*   液晶界面
*   UART
*   键盘接口
*   4 功能计算器
*   与传感器接口（例如温度）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T02:07:00.947

查看 fpga4fun.com verilog 项目并将它们转换为 vhdl 并让它们工作。或者只是从头开始用 vhdl 编写它们。如上所述，uart 是一个很好的学习项目。

制作自己的简单 cpu（微控制器）。从 Josh 提到的四个函数计算器开始，并将其扩展为一个简单的 cpu。

或者向现有的软 cpu 核心之一添加额外的功能，如 zpuino（arduino 克隆）

很多书都是针对大学科目的

合理的免费书免费范围 fpga [http://www.freerangefactory.org/site/pmwiki.php/Main/Books](http://www.freerangefactory.org/site/pmwiki.php/Main/Books)

一个不错的 VHDL FPGA 原型设计示例：Xilinx Spartan-3 版本

找一块板子。设计和实施项目。从简单开始，逐步建立。不要试图马上去复杂。

Digilentinc 有一些便宜的或 avnet USB 加密狗板，它以 80 美元的价格购买 digilentinc pmod 扩展插件

gadget factory Papilio 平台看起来很合理，而且背后似乎有很多经验教训和支持（来自 xilinx 的 spartan 3 或 spartan 6 芯片） papilio.cc

来自小工具工厂 papillio + 插件板 (wings) [http://www.kickstarter.com/projects/13588168/retrocade-synth-one-chiptune-board-to-rule-them-al](http://www.kickstarter.com/projects/13588168/retrocade-synth-one-chiptune-board-to-rule-them-al)

对于 altera，terasic 板看起来不错

我最喜欢的几本 fpga 书籍（不是介绍书籍） 基于 FPGA 的原型设计方法手册：原型设计最佳实践 FPGA 设计人员的 100 个电源技巧

抱歉，必须以新用户的身份切断链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-15T09:23:48.627

熟能生巧。以下是一些项目的想法：（按难度排序）

*   半加器
*   全加器
*   4位纹波加法器/减法器
*   进行前瞻加法器
*   ALU 包括加/减有符号/无符号、AND、OR、NOR、左移/右移逻辑/算术等操作
*   状态机的实现。
*   7 段计数器并始终参考 VHDL 参考手册。

# redis - 禁用 Redis 持久性是否会提高性能？

> ID：11209817
> 
> 赞同：0
> 
> 时间：2012-06-26T14:39:53.440
> 
> 标签：redis

我正在考虑使用 Redis 作为一些高度瞬态数据的存储（我们正在谈论它在被驱逐之前一次可能会存在 30 秒）。我知道当启用持久性时，Redis 每隔一段时间就会产生一个工作人员来持久化到磁盘。如果我禁用持久性机制，会给系统的其余部分带来什么样的性能优势。

另外，有没有人看到这有任何不利之处——因为如果数据丢失，恢复它无论如何都是没有意义的，因为它可能已经过期了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T14:47:23.853

如果您的数据生命周期那么短，您可能不想保留它们。禁用持久性后，您不会从 redis 获得 I/O 负载，也不会在保存期间出现内存峰值。当 redis 想要转储数据时，它会自行分叉并继续工作。但是，如果它处于繁重的写入负载下，则必须在转储过程中复制修改过的密钥。这就是所谓[的写时复制](http://en.wikipedia.org/wiki/Copy-on-write)机制。

当您不需要持久化数据时，不持久化绝对是有意义的。

# java - Java SQL 结果到 InputStream

> ID：11209818
> 
> 赞同：11
> 
> 时间：2012-06-26T14:39:59.057
> 
> 标签：java, sql-server, jtds

我需要一个 Java 函数，它返回 SQL`SELECT`查询的结果作为`InputStream`另一个系统的参数，该系统通过网络发送结果。

但是，`InputStream`必须`String`使用自定义分隔符（即通常但不总是 CSV）。

虽然我可以轻松地创建一个函数来检索结果，创建一个 delimited`String`并最终将其转换`String`为一个`InputStream`，但 SQL 结果通常太大而无法在内存中处理。此外，在返回结果之前处理整个结果集会导致不必要的等待时间。

如何返回一个`InputStream`以迭代 SQL 结果并在从数据库返回时发送已处理（分隔）的数据？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-28T22:51:28.597

发布（未测试）代码片段，它应该给你基本的想法：

```
/**
 * Implementors of this interface should only convert current row to byte array and return it.
 * 
 * @author yura
 */
public interface RowToByteArrayConverter {
    byte[] rowToByteArray(ResultSet resultSet);
}

public class ResultSetAsInputStream extends InputStream {

    private final RowToByteArrayConverter converter;
    private final PreparedStatement statement;
    private final ResultSet resultSet;

    private byte[] buffer;
    private int position;

    public ResultSetAsInputStream(final RowToByteArrayConverter converter, final Connection connection, final String sql, final Object... parameters) throws SQLException {
        this.converter = converter;
        statement = createStatement(connection, sql, parameters);
        resultSet = statement.executeQuery();
    }

    private static PreparedStatement createStatement(final Connection connection, final String sql, final Object[] parameters) {
        // PreparedStatement should be created here from passed connection, sql and parameters
        return null;
    }

    @Override
    public int read() throws IOException {
        try {
            if(buffer == null) {
                // first call of read method
                if(!resultSet.next()) {
                    return -1; // no rows - empty input stream
                } else {
                    buffer = converter.rowToByteArray(resultSet);
                    position = 0;
                    return buffer[position++] & (0xff);
                }
            } else {
                // not first call of read method
                if(position < buffer.length) {
                    // buffer already has some data in, which hasn't been read yet - returning it
                    return buffer[position++] & (0xff);
                } else {
                    // all data from buffer was read - checking whether there is next row and re-filling buffer
                    if(!resultSet.next()) {
                        return -1; // the buffer was read to the end and there is no rows - end of input stream
                    } else {
                        // there is next row - converting it to byte array and re-filling buffer
                        buffer = converter.rowToByteArray(resultSet);
                        position = 0;
                        return buffer[position++] & (0xff);
                    }
                }
            }
        } catch(final SQLException ex) {
            throw new IOException(ex);
        }
    }

    @Override
    public void close() throws IOException {
        try {
            statement.close();
        } catch(final SQLException ex) {
            throw new IOException(ex);
        }
    }
} 
```

这是非常直接的实现，可以通过以下方式进行改进：

*   可以删除 read 方法中 if 和 else 之间的代码重复 - 它只是为了澄清而发布
*   而不是为每一行重新创建字节数组缓冲区（`new byte[]`操作成本很高），可以实现更复杂的逻辑来使用字节数组缓冲区，它只初始化一次然后重新填充。然后应该更改`RowToByteArrayConverter.rowToByteArray`方法的签名，`int fillByteArrayFromRow(ResultSet rs, byte[] array)`该签名应该返回填充的字节数并填充传递的字节数组。

因为字节数组包含它可以包含的有符号字节`-1`（实际上`255`是无符号字节），因此表明流的不正确结束，所以`& (0xff)`用于将有符号字节转换为无符号字节作为整数值。具体参考[Java如何将int转换为byte？](https://stackoverflow.com/questions/842817/how-conversion-of-int-to-byte-happens-in-java).

另请注意，如果网络传输速度较慢，这可能会长时间保持打开的结果集，从而给数据库带来问题。

希望这可以帮助 ...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T16:51:50.753

我将通过引入以下内容来改进@Yura 建议的答案：
使用使用 ByteArrayOutputStream 初始化的 DataOutputStream，以便在 RowToByteArrayConverter 的实现中方便地将数据写入字节数组。
事实上，我建议有一个转换器的层次结构，它们都扩展同一个抽象类（这是我的想法的代码片段 - 可能不会从第一次编译）

```
public abstract class RowToByteArrayConverter {
  public byte[] rowToByteArray(ResultSet resultSet) {
      parseResultSet(dataOutputStream, resultSet);
      return byteArrayOutputSteam.toByteArray();
  }

  public RowToByteArrayConverter() {
    dataOutputStream = new DataOutputStream(byteArrayOutputStream);
  }

  protected DataOutputStream dataOutputStream;
  protected ByteArrayOutputStream byteArrayOutputStream;

  protected abstract void parseResultSet(DataOutputStream dataOutputStresm, ResultSet rs); 
} 
```

现在，您可以通过简单地覆盖 parseResultSet 方法来覆盖这个类，
例如 - 编写代码，从记录中的“名称”列获取名称作为字符串。并在 DataOputputStream 上执行 writeUTF8。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-19T11:08:45.370

上述答案为超出限制大小的字符串生成器的问题提供了有用的解决方案。它们还具有内存效率。但是，我的测试表明它们比仅仅将数据写入字符串构建器并调用

新的 ByteArrayInputStream(data.getBytes("UTF-8"))

获取输入流。

我发现性能更高的是通过使用分区函数对传入数据进行切片，然后对每个线程使用多个线程：

1.  在源数据库中查询数据的子集
2.  将数据写入目标

这也避免了总数据可能超过字符串缓冲区的最大大小的问题。

例如，我在 SQL Server 表中有 6m 条记录，其中有一列名为“RecordDate”。Recorddate 中的值在 2013 年和 2016 年之间变化。所以我将每个线程配置为分别请求 2013、14、15、16 的数据。然后，每个线程将转码后的数据写入 StringBuilder 并通过使用上述 getBytes() 转换为 Inputstream 将每个批量加载到目标。

这导致了 2 倍的加速。

为什么？因为源数据库和目标数据库可以处理多个并发请求，所以整体工作负载分布在所有三个进程中的多个线程上：源数据库、代码转换器、目标数据库。

# android - 再次包裹同一对象时获取解组未知类型代码

> ID：11209825
> 
> 赞同：4
> 
> 时间：2012-06-26T14:40:23.240
> 
> 标签：android, android-activity, parcelable

我有一个循环活动工作流程，例如

A -> B -> C -> A -> B -> C -> A -> B -> C...

我正在将一个 Parcelable 从 activit B 传递到 C。它第一次起作用。第二次它给了我

> Parcel android.os.Parcel@405156d0：在偏移量 1108 处解组未知类型代码 7471204

在读取对象的行中。

对象没有改变。不知道是不是一模一样的实例，但至少内容是一模一样的。为什么第一次有效，第二次无效？

有时它也是第一次发生。

我尝试删除写入/读取中的所有内容（仅使用一个整数字段进行测试），但仍然得到相同的结果。

当错误出现时，**根本不读取**对象，执行带有的行，`getParcelable()`但它永远不会执行`createFromParcel`或进一步执行构造函数。它只是给出错误并且什么都不做。所以这不是字段打包的错误。

我完全一无所知...

我尝试使用一个非常小的测试环境进行复制 - 2 个活动和一个非常小的对象在那里我可以根据需要多次传递 parcelable 并且它是正确的。

我不能在这里发布我的整个代码。

我只想知道哪种情况会导致此错误。和`writeToParcel`构造函数是正确的，数据以相同的顺序写入和读取，正确的 tpyes，还有 CREATOR 变量也是正确的，我检查了所有内容 100 次。正如所说，它可以工作很多次。有时对象中的数据完全相同（检查，每个字段都包含相同的值），第一次工作，第二次显示这种“Unmarshalling unknown type”。

另一件非常有趣且可能相关的事情，我也不明白，虽然我`putExtra`只执行了一次，但 parcelable 却被写了两次。我放了日志，它肯定`putExtra`只执行一次。但是`writeToParcel`执行了两次......不知道为什么。在简化的示例中，这不会发生。

欢迎任何提示。我做了所有的工作来使用 Parcelable 将我的参数传递到任何地方，而且它们很多，因为每个人都说“我强烈鼓励使用 Parcelable”，你说你的牙齿在流血并得到“使用 Parcelable”。现在我正在使用 Parcelable，我得到的只是一堆新问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-12T20:15:01.937

我在使用 Parcelable 类时遇到了这个错误，我在这个类中添加了一个变量，忘记将此变量添加到方法“writeToParcel”和带有 Parcel 对象的构造函数中

通过将此变量添加到以下方法来解决此问题。

```
@Override
    public void writeToParcel(Parcel dest, int flags) {
        dest.writeString(id);
        dest.writeString(name);

}

public ItemDetails(Parcel source) {
        id = source.readString();
        name = source.readString();
} 
```

# .net - 实施针对 3.5 和 4.0 的 .Net 项目

> ID：11209826
> 
> 赞同：2
> 
> 时间：2012-06-26T14:40:28.717
> 
> 标签：.net, msbuild, nuget

我们有一个项目（日志库），供标准 asp.net 应用程序（4.0 框架）和 sharepoint 解决方案（3.5 框架）使用。

有没有办法定义两个目标，以便在我们构建项目时构建两个版本？

另外，因为有人实现了这样的东西并通过nuget分发它？在 nuget 上发布两个版本的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T16:26:16.940

答案是[`<supportedRuntime>`](http://msdn.microsoft.com/en-us/library/w4atty68.aspx)配置元素。这允许您指定您的应用程序可以支持和运行的所有 .NET 运行时。当然，在您的应用程序中，您只能使用您选择的所有 .NET 框架版本提供的功能。

简而言之，你应该在你的配置中有这个：

```
<configuration>
  <startup>
    <supportedRuntime version="v2.0.50727"/>
    <supportedRuntime version="v4.0"/>
  </startup>
</configuration> 
```

最初可能需要将您的应用程序定位到 .NET 3.5，因为它`<supportedRuntime>`允许在版本中升级而不是下降。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:52:02.843

您可以创建两个 C# 项目（csproj 文件），其中包含相同的源文件（或更多项目，具体取决于您的结构）。一个项目应针对 .NET 3.5，另一个项目应针对 .NET 4.0。

如果您想使用特定于 .NET 4.0 的功能，则可以使用.NET 4 项目中定义的[条件编译符号来实现。](http://www.codeproject.com/Articles/49448/Use-Visual-Studio-Conditional-Compilation-to-manag)

或者，您还可以添加一个或多个解决方案（用于 VS2008 和 VS2010），每个解决方案都使用一个 C# 项目。

# javascript - 在 highcharts 中动态插入系列数据

> ID：11209829
> 
> 赞同：1
> 
> 时间：2012-06-26T14:40:43.350
> 
> 标签：javascript, highcharts

我是 highcharts 的新手，我正在尝试通过将数据从我的控制器文件传递到我的视图文件来创建一个 highchart。不幸的是，我无法动态地将数据放入我的系列中。下面是我的控制器和视图文件：

### 控制器：graph.php

```
<?php
class Graph extends CI_Controller {
function __construct() {
    parent::__construct();
}

function index() {

            $data['title']='Graph for hourly distribution of results based on Location';
            $xaxis=array('2','4','6','8','10');
            $y1axis=array(5,8,4,6,4);
            $y2axis=array(4,6,8,4,5);
            $yaxis=array($y1axis,$y2axis);
            $data['xlabel']='X-Axis Name';
            $data['ylabel']='Y-Axis Name';
            $data['type']='line';
            $arry = array('xdata' => $xaxis,'ydata' => $yaxis,'title' => $data['title'],'type' => $data['type'],'xlabel' => $data['xlabel'],'ylabel' => $data['ylabel']);
            $this -> load -> view('graph_js', $arry);
        } 

    }

?> 
```

### 查看文件：graph_js.php

```
<html>
<head>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js" type="text/javascript"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script type="text/javascript" src="../../Highcharts-2.2.5/js/themes/gray.js"></script>
<script type="text/javascript" src="../../Highcharts-2.2.5/js/modules/exporting.js">    </script>
<div id="container" style="min-width: 400px; height: 400px; margin: 0 auto"></div>

<script type="text/javascript">
var chart;
$(document).ready(function() {
        var options = {
        chart: {
            renderTo: 'container',
            type: 'line',
            marginRight: 130,
            marginBottom: 25
        },

        title: {
            text: '<?php echo $title ?>',
            x: -20 //center
        },

        subtitle: {
            text: '<?php echo $xlabel ?>',
            x: -20
        },

        xAxis: {
            categories: []
        },

        yAxis: {
            title: {
                text: '<?php echo $ylabel ?>'
            },
            plotLines: [{
                value: 0,
                width: 1,
                color: '#808080'
            }]
        },

        tooltip: {
            formatter: function() {
                    return '<b>'+ this.series.name +'</b><br/>'+
                    this.x +': '+ this.y;
            }
        },

        legend: {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'top',
            x: -10,
            y: 100,
            borderWidth: 0
        },

        series: []

    }
            options.xAxis=new Array();
            options.xAxis[0] = new Object();
            options.xAxis[0].categories = new Array(<?php echo join(", ", $xdata) ?>);

            options.series = new Array();

            var i;
            var j=<?php echo count($ydata) ?>;
            <?php echo $k=0; ?>;
            for(i=0;i<j;i++)
            {
                options.series[i] = new Object();
                options.series[i].name = 'Sample'+i;
                options.series[i].data = new Array(<?php echo join(", ", $ydata[$k++]) ?>);

            }

            chart = new Highcharts.Chart(options);         

});

</script>
</head>
</html> 
```

上面的代码绘制了图形的第一个系列并与第一个系列本身的第二个系列重叠，但是如果我尝试通过放置以下代码而不是 for 循环来手动完成它，它可以通过绘制两个不同的系列来正常工作

```
options.series[0] = new Object();
options.series[0].name = 'Sample1';
options.series[0].data = new Array(<?php echo join(", ", $ydata[0]) ?>);

options.series[1] = new Object();
options.series[1].name = 'Sample2';
options.series[1].data = new Array(<?php echo join(", ", $ydata[1]) ?>); 
```

有人可以帮我解决这个问题吗？我的循环有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:47:13.593

改用 JSON... 用于`json_encode()`创建系列... 老实说，它会为您节省很多麻烦 :)

# c# - 在 c#.net 中执行 javascript 函数。我究竟做错了什么？

> ID：11209830
> 
> 赞同：-3
> 
> 时间：2012-06-26T14:40:43.927
> 
> 标签：c#, javascript, function, call

我想在 ac# 代码中执行一个 javascript 函数。这是我所做的：

```
string jscript = "$(function () { $('#dialog-modal').dialog('open'); });";
Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "clientScript", jscript, true); 
```

我不知道该怎么做，我不明白这种方法是如何工作的

谢谢 ：）

obs.: 我只是写“clientScript”，但我不知道它是如何工作的

我的Javascript：

```
<script type="text/javascript">
$(function () {

            $("#dialog:ui-dialog").dialog("destroy");

            var fancyboxInitOld = jQuery("#dialog-modal").dialog({
                autoOpen: false,
                height: 200,
                width: 370,
                modal: true

            });
            fancyboxInitOld.parent().appendTo(jQuery("form:first"));

        });
</script> 
```

我的 C# 代码

```
try
        {
            client.Send(message);
        }
        catch
        {
            string jscript = "$('#dialog-modal').dialog('open');";
            Page.ClientScript.RegisterStartupScript(this.GetType(), "clientScript", jscript, true);
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:42:43.743

改用[`RegisterStartupScriptMethod`](http://msdn.microsoft.com/en-us/library/z9h4dk8y.aspx)：

```
string jscript = "$(function () { $('#dialog-modal').dialog('open'); });";
Page.ClientScript.RegisterStartupScript(this.GetType(),
  "clientScript", jscript, true); 
```

我看到你已经在你的`catch`街区做了这个。`RegisterClientScriptBlock`是否可以呈现客户端代码以供以后使用，例如某些功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:43:32.887

尝试

```
string jscript = "$('#dialog-modal').dialog('open');";
Page.ClientScript.RegisterStartupScript(this.GetType(), "clientScript", jscript, true); 
```

# twig - .tpl 文件和 %%。树枝引擎模板

> ID：11209842
> 
> 赞同：0
> 
> 时间：2012-06-26T14:41:19.617
> 
> 标签：twig

我得到 .tpl 文件，其中包含 %% 变量。

例子：

```
%%GLOBAL_Error%% 
```

这是树枝模板引擎吗？我想检查变量是否不为空，但我不能用常规的 twig 语法来做到这一点。

```
{% if GLOBAL_Error is defined %} 
```

我怎样才能做到这一点？

树枝链接... [http://twig.sensiolabs.org/doc/tags/if.html](http://twig.sensiolabs.org/doc/tags/if.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:51:58.147

这不是树枝。我想这很[聪明](http://www.smarty.net/)

通过快速查看文档，我想这`%`是用于逃避`%`本身，所以`%%GLOBAL_Error%%` 将是`%GLOBAL_Error%`

# objective-c - 从外部类访问私有变量 - iOS

> ID：11209843
> 
> 赞同：7
> 
> 时间：2012-06-26T14:41:22.663
> 
> 标签：objective-c, ios

我在一个类中有一个私有变量，我正在尝试从外部类访问该变量。有没有办法我可以做到这一点？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-26T14:51:00.277

根据定义，私有实例变量是私有的。您无法从外部访问它们。如果您是该类的作者，您应该为变量提供访问器方法。如果不是，则应避免访问该变量。

但是，有一些方法可以规避这种限制。

您可以在第一个类上创建一个类别并为实例变量添加一个访问器方法。

或者您可以使用键值编码来访问变量。

```
[object valueForKey:@"variable_name"];
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:49:47.680

根据定义，私有意味着它不能被外部类访问。访问私有数据的唯一真正方法是通过接口中提供的访问器方法。

在objective-c 中，您可以创建所谓的类别。这些方法组基本上可以用来扩展类的功能。我不赞成访问在外部类中声明的私有成员（那些你没有完整实现的），但我能够为我自己的类编写一个访问私有成员的类别。

```
#import "OtherClass.h"

@interface OtherClass(RandomAccessor)

-(int) getMyVar;

@end

@implementation OtherClass(RandomAccessor)

-(int) getMyVar
{
    return self->myPrivateVar;
}

@end 
```

不过，我真的不建议这样做，因为开发人员通常出于某种原因将数据设为私有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:49:21.590

您可以创建自己的 get/set 方法...或者您可以通过在 .h 文件中将变量声明为属性，然后在 .m 文件中合成它来使用 Objective-C 标准...请记住，如果其他类可以看到并访问该变量，则它不再是“私有”变量

测试视图控制器.h

```
@interface testViewController : UIViewController
{
    NSString *someString;
}

@property (nonatomic, retain) NSString *someString;

@end 
```

测试视图控制器.m

```
#import testViewController.h

@interface testViewController
@synthesize someString=_someString;
@end 
```

# javascript - 使用 d3.js 在强制布局中添加和删除节点的问题

> ID：11209847
> 
> 赞同：1
> 
> 时间：2012-06-26T14:41:42.577
> 
> 标签：javascript, d3.js, zabbix, force-layout

我试图通过从 Zabbix API 获取数据来可视化服务器的可用性（以及稍后的其他事情，一旦这工作）。您可以在 Zabbix API 文档中查看有关返回数据的示例 [此处][1]。

获取数据不是问题，但我认为 d3.js 的数据加入有一些问题，或者更确切地说我应该如何做到这一点。

获取数据后，我得到了一组按字母顺序排序的服务器，我希望新的服务器出现，删除的服务器会消失，可用性的任何变化（或将来）都会用颜色或其他任何东西反映出来可能会想到。

关键是图形不应该重新初始化，它应该通过添加或删除节点来更新。

这是我遇到的问题。我设法将越来越多的节点添加到列表中（从不清除它），我设法让它们在每次获取新数据时“重绘”，即再次添加所有节点，并像他们一样捕捉到中心加载页面时首先执行此操作。

第三个导致所有节点都卡在左上角。

后者是我的代码的当前状态。

我有点不确定我在这一点上做错了什么，我正在看[这](http://bl.ocks.org/1095795#index.html)似乎与我需要的相当接近，无论如何都没有链接（现在）。这很好用，我试图在我的代码中复制这种行为，但它不起作用。

如果有人对我有一些指示，我将不胜感激，那将是很棒的。过去一周我在工作中一直在玩这个，但没有进一步了解:)

谢谢！

因为我只能在工作中访问 Zabbix，所以我真的只能在 CET 时间的 16-21 时间段内进行测试，今天大约还有 4~ 小时。如果有人在晚上有任何建议，我明天会试试看：D

我在 GitHub 上的代码将在我的帖子下方的链接中，因为在这个网站上缺乏声誉让我陷入了一个阴暗的洞，我只能在我的帖子中添加两个链接。

为什么这不是全球性的？我在其他 SE 网站上有 10 多个代表。

**编辑：**

仍然遇到问题，每次刷新数据时，圆圈都会像您第一次加载时一样“输入”：http: [//mbostock.github.com/d3/talk/20111018/collision.html](http://mbostock.github.com/d3/talk/20111018/collision.html) 现在不知道该怎么做： /

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T18:06:02.520

您在那里提到的是 D3 的默认行为。添加节点时，它们将插入左上角。您可以通过编写自己的放置方法并在将每个节点添加到力有向图时直接设置每个节点的 X 和 Y 来更改此行为。

诀窍是应用这个算法：

1）计算视口的限制（比如绘图区域的限制 - 20）并使用力定向绑定示例（[http://bl.ocks.org/1129492](http://bl.ocks.org/1129492)）中的技巧

2）然后对于每个可视化刻度执行以下操作：计算力以将节点保持在视口中

3) 将节点保留在视口中的算法将遵循以下原则：对于每个节点，根据可应用于 4 个方向（左上、左下、右上、右下）的力计算 X 和 Y - 如果它更靠近左上角，然后您将相应地设置 X 和 Y....无论如何它不会在屏幕之外....

另一个技巧是在中心设置根节点（参见这篇文章：[How do I set the focus node in a D3.js Force Directed Graph?](https://stackoverflow.com/questions/10887027/how-do-i-set-the-focal-node-in-a-d3-js-force-directed-graph/10906002#10906002)）。这将有助于稳定您的图表。另一个建议是尽量不要将 ajax 调用与重绘混合使用。理想情况下，在加载数据时使用一些回调并调用重绘，否则您将得到意大利面条代码（强制有向图大于 1000 行并不罕见）。

希望能帮助到你。

# ios - 如何从 iOS 中的 mapKit 获取纬度、经度？

> ID：11209848
> 
> 赞同：1
> 
> 时间：2012-06-26T14:41:42.727
> 
> 标签：ios, frameworks, mapkit

我已将 mapkit 框架集成到我的项目中，一切正常。我只是在地图中显示用户的当前位置，如下所示：

```
mapView.delegate = self;
    mapView.showsUserLocation = YES;
    MKUserLocation *userLocation = mapView.userLocation;
    //numbers show map zoom. 500,500 = map stretches 500 meters to the North and the South of current location
    MKCoordinateRegion region =
    MKCoordinateRegionMakeWithDistance (userLocation.location.coordinate,1000,1000);
    [mapView setRegion:region animated:NO]; 
```

问题是我需要将当前位置的纬度和经度存储到 2 个变量中，但是这些值存储在哪里？

我试图打印以下内容，但它给了我 0.000。

```
NSLog(@"Latitude: %f" , mapView.userLocation.coordinate.latitude);
NSLog(@"Longitude: %f" , mapView.userLocation.coordinate.latitude); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:47:17.523

实现这个委托方法：

```
- (void)mapView:(MKMapView *)mapView didUpdateUserLocation:(MKUserLocation *)userLocation 
```

基本上，一旦确定了用户的位置，MapView 就会调用这个位置。如果您即时检查**userLocation**，则无法保证。

**您可以在MKMapViewDelegate 协议参考**中找到其余的委托方法

 **[http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKMapViewDelegate_Protocol/MKMapViewDelegate/MKMapViewDelegate.html#//apple_ref/occ/intf/MKMapViewDelegate](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKMapViewDelegate_Protocol/MKMapViewDelegate/MKMapViewDelegate.html#//apple_ref/occ/intf/MKMapViewDelegate)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:54:26.590

用这个：

```
- (void)mapView:(MKMapView *)mapView didUpdateUserLocation:(MKUserLocation *)userLocation
{
    NSLog(@"Latitude: %f" , userLocation.coordinate.latitude);
    NSLog(@"Longitude: %f" , userLocation.coordinate.latitude);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-05T08:02:35.847

另一种方法是将地址作为文本提供。

```
geocoder = [[CLGeocoder alloc] init];    

[geocoder geocodeAddressString:@"1 Infinite Loop" 
  completionHandler:^(NSArray* placemarks, NSError* error){
 for (CLPlacemark* aPlacemark in placemarks)
 {
     // Process the placemark.
 }
}]; 
```

它在这里解释：[https ://developer.apple.com/library/ios/documentation/userexperience/conceptual/LocationAwarenessPG/UsingGeocoders/UsingGeocoders.html](https://developer.apple.com/library/ios/documentation/userexperience/conceptual/LocationAwarenessPG/UsingGeocoders/UsingGeocoders.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-25T06:11:37.217

```
-(void) locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations {
    CLLocation *location = locations.lastObject;
    NSLog(@"Latitude: %f" , self.mapview.userLocation.coordinate.latitude);
    NSLog(@"Longitude: %f" , self.mapview.userLocation.coordinate.longitude);

} 
```**

# css - 如果在 IE 中查看时没有触发 IE for css

> ID：11209849
> 
> 赞同：0
> 
> 时间：2012-06-26T14:41:43.853
> 
> 标签：css, html

我在其中添加了以下条件，`<style></style>`但由于某种原因，从 IE 中查看时它不会触发。知道为什么吗？

```
<!--[if IE]>
According to the conditional comment this is IE<br />
<![endif]--> 
```

它在 div 中也不起作用。我想出一个特定的风格比如灰`height:3px`当它是IE

代码在：http: [//jsfiddle.net/z4bn8/](http://jsfiddle.net/z4bn8/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:48:05.677

我认为在 css 文件或样式标签之间是不可能的。尝试将条件放在样式部分或包含样式表中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:49:35.060

[如果 IE] 在 style 或 .css 中不起作用，请尝试以下操作：

```
<!--[if IE]>
<style type="text/css">
/* css for IE goes here */
</style>
<![endif]--> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T15:20:35.837

见答案：http: [//jsfiddle.net/z4bn8/2/](http://jsfiddle.net/z4bn8/2/)

# c# - 无法使用命名空间反序列化 XmlArray

> ID：11209852
> 
> 赞同：1
> 
> 时间：2012-06-26T14:42:04.207
> 
> 标签：c#, xml-serialization, xml-deserialization

我有以下 XML：

```
 <MovieRunTimes>
      <ShowDate>6/9/2012</ShowDate>
      <ShowTimesByDate xmlns:a="http://schemas.microsoft.com/2003/10/Serialization/Arrays">
        <a:string>12:25</a:string>
        <a:string>17:30</a:string>
        <a:string>22:35</a:string>
      </ShowTimesByDate>
      <TicketURI>http://www.fandango.com/tms.asp?t=AANCC&amp;m=112244&amp;d=2012-06-09</TicketURI>
    </MovieRunTimes> 
```

以及以下 C# 类：

```
public class MovieRunTimes
{
    [XmlElement("ShowDate")]
    public string ShowDate { get; set; }

    [XmlElement("TicketURI")]
    public string TicketUri { get; set; }

    [XmlArray("ShowTimesByDate", Namespace = "http://schemas.microsoft.com/2003/10/Serialization/Arrays")]
    public List<string> ShowTimesByDate { get; set; }

} 
```

不幸的是，我反序列化后 ShowTimesByDate 是空的。如果我从 ShowTimesByDate 元素中删除名称空间并从字符串元素中删除前缀，那么它可以很好地反序列化。如何正确使用命名空间来反序列化 XML？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T16:09:42.557

我发现了如何做到这一点。如果我将课程修改为：

```
public class MovieRunTimes
{
    [XmlElement("ShowDate")]
    public string ShowDate { get; set; }

    [XmlElement("TicketURI")]
    public string TicketUri { get; set; }

    [XmlArray("ShowTimesByDate")]
    [XmlArrayItem(Namespace = "http://schemas.microsoft.com/2003/10/Serialization/Arrays")]
    public List<string> ShowTimesByDate { get; set; }

} 
```

它正确反序列化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T15:45:33.467

诀窍是在您的 Collection 包装器元素中添加一个命名空间前缀（在您的情况下为“a”）：

```
<MovieRunTimes >
  <ShowDate>6/9/2012</ShowDate>
  <a:ShowTimesByDate xmlns:a="http://schemas.microsoft.com/2003/10/Serialization/Arrays">
    <a:string>12:25</a:string>
    <a:string>17:30</a:string>
    <a:string>22:35</a:string>
  </a:ShowTimesByDate>
  <TicketURI>http://www.fandango.com/tms.asp?t=AANCC&amp;m=112244&amp;d=2012-06-09</TicketURI>
</MovieRunTimes> 
```

这就是使用此代码序列化后的结果：

```
 XmlSerializer xs = new XmlSerializer(typeof(MovieRunTimes));
        XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
        ns.Add("a", "http://schemas.microsoft.com/2003/10/Serialization/Arrays");
        string result = null;
        using(StringWriter writer = new StringWriter())
        {
            xs.Serialize(writer,mrt,ns);
            result = writer.ToString();
        } 
```

# javascript - 向文本添加 html 标记会禁用按钮功能

> ID：11209853
> 
> 赞同：1
> 
> 时间：2012-06-26T14:42:11.057
> 
> 标签：javascript, jquery, html

请参阅下面的代码。我有整页部分，每个部分都有一个按钮。当按下按钮时，我希望页面进入下一部分。一切正常，除非我将文本包含在`<h1></h1>`或`<p></p>`标记中。例如，请参阅第 1 节和第 2 节，在我添加这些标签后，由于某种原因，按钮无法正常工作。它正在其他部分工作。即使在第 1 节中，如果我删除`<h1></h1>`标签它也可以正常工作。这些标签与按钮的功能有什么关系？

```
<!DOCTYPE html>
<html>
<head>
    <title>Selecting multiple DIV tags with jquery</title>
    <script type="text/javascript" src="./jquery.js">
    </script>
    <style type="text/css">

        html{
            overflow: hidden;
        }

        body {
            backround-color: rgb(250, 250, 250);
        }

        h1 {
            font-size: 48px;
            color: rgb(90,90,90);
        }

        .slide {
            display: block;
            position: absolute;
            border-style: solid;
            border-width: 1px;
            top: 0px;
            left: 0px;
            padding:20px;
            height: 95%;
            width: 100%;
            font-family: Georgia;
        }
    </style>
</head>
<body>

    <section class="slide">
        <h1>This is the first div.</h1>
    </section>

    <section class="slide">
        <p>This is the second div.</p> 
    </section>

    <section class="slide">This is the third div.</section>

    <section class="slide">This is the fourth div.</section>

    <section class="slide">This is the fifth div.</section>

    <section class="slide">This is the sixth div.</section>

    <script type="text/javascript">

    // Assign ids to each section in the order they appear.

    $(document).ready(function(){
        $("section").each(function(index){
            idtag = 's' + (index + 1)
            $(this).attr('id', idtag);
            $(this).append('<button>Next div</button>');
            $(this).css('opacity', 0);
        });

    var presentation = function() {

        $("section").each(function(index){
            $(this).css('opacity', 0);
        });     
        // Check if the current url points to a specific id. If not point
        // it to id = 1, otherwise point it to the id specified in the URL.

        var currenturl = $(location).attr('href');

        var indexhash = currenturl.lastIndexOf('#')

        if (indexhash === -1) {
            var newurl = currenturl + '#s1';
            $("#1").css('opacity',1);
            window.location.href = newurl;
        }
        else {
            var currentid = currenturl.substring(indexhash, currenturl.length);
            console.log(currentid);
            $(currentid).css('opacity', 1);
            window.location.href = currenturl;
            // window.location.assign(currenturl);
        }

    };

        var nextdiv = function() {
            currenturl = location.href;
            currentid = location.hash;
            console.log(currentid);
            newidnum = parseInt(currentid.substring(currentid.indexOf('s')+1, currentid.length),10)+1;
            newid = "#s" + newidnum;
            newurl = currenturl.substring(0,currenturl.lastIndexOf('#'))+newid;
            console.log(newurl);
            window.location.href = newurl;

        };

        // $(document).ready(presentation);
        presentation();
        $(window).bind('hashchange', presentation);
        $('button').bind('click', nextdiv);

    });

    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T15:52:28.423

这与 section 元素中的 HTML 元素无关，它与您将所有元素堆叠在一起并将不透明度设置为零而不是使用 display 属性实际隐藏它们的事实有关（`display:none`与`opacity:0`）。如果您删除除第一个部分元素之外的所有元素，它可以正常工作，您可以看到这一点。此外，如果您使用 Chrome 的开发者工具之类的工具检查您的代码，您会发现第六部分元素实际上是最上面的元素，并阻止了它下面的所有内容。您还每次都单击相同的顶部按钮，而不是该部分元素的子按钮。您可以通过为每个按钮分配一个 id 然后控制台记录它来看到这一点`$('button').click(function(){console.log($('button').attr('id'));});`

# python - 如何编写一个可以同时接受多个客户端的 Tornado Web 服务器？

> ID：11209855
> 
> 赞同：0
> 
> 时间：2012-06-26T14:42:31.727
> 
> 标签：python, multithreading, asynchronous, callback, tornado

我正在编写一个龙卷风网络服务器，并试图阻止它阻塞一个功能。

```
class TokenHandler(tornado.web.RequestHandler):
    @tornado.web.asynchronous
    def post(self):
        global t
        email = self.get_argument("text")
        thread = MetaToken.ExeThread(email,t,self._on_response)
        thread.start()
        #data = t.analyze(email)

    def _on_response(self,json):
        self.write(json)
        self.finish() 
```

分析在 t 中调用，可能需要几秒钟才能完成。只要可以同时处理其他客户的请求，我就可以了。这在大多数情况下都有效，但会在流关闭的某些连接上引发错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T09:02:20.153

不要以这种方式在龙卷风中使用线程！

如果您有需要线程的繁重任务，请使用[celery](https://stackoverflow.com/questions/7934675/invoke-celery-task-from-tornado)。如果任务很轻 - 只需将其交给[gen](http://www.tornadoweb.org/documentation/gen.html)。

# java - Java中URL类中的getHost和getAuthority方法有什么区别？

> ID：11209858
> 
> 赞同：8
> 
> 时间：2012-06-26T14:42:40.833
> 
> 标签：java, networking

我有一系列不同形式的字符串（URL）：

1.  `http://domain name.anything/anypath`
2.  `https://dmain name.anything/anypath`
3.  `http://www.domain name.anything/anypath`
4.  `https://www.dmain name.anything/anypath`

这些字符串保存在 CSV 文件中。我需要解析每个 URL 才能仅获取域名，`domain name.anything`. 即第一个之后`.`和第一个之前的部分`/`。

我使用方法分隔字符串`split`，然后将每个字符串转换为 URL，然后使用该`toAuthority`函数仅获取域名。问题是，`toAuthority`并且`toHost`正在为我做同样的工作，它们包括`www.`我不想要的。虽然，在 Oracle 的[教程](http://docs.oracle.com/javase/tutorial/networking/urls/urlInfo.html)中，似乎`toAuthority`应该返回没有`www.`.

如何在没有`www.`URL 的情况下仅提取域名部分？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-26T14:56:38.483

> URL 类中的 getHost 和 getAuthority 方法有什么区别？

要真正理解这一点，您应该阅读[URI 规范 - RFC 2396](http://www.ietf.org/rfc/rfc2396.txt)。

简短的回答是，权限组件由主机组件以及可选的端口号、用户名和密码组成……取决于所使用的 URL 方案。

* * *

> 如何在没有“www.”的情况下仅提取域名部分。的网址？？

您调用`getHost()`，测试它是否以字符串开头，`"www."`如果是，则将其删除。

但在你开始做这样的事情之前，你需要了解删除“www”。可能会为您提供一个不起作用的 URL，或者解析为与原始 URL 解析到的文档或服务不同的文档或服务。无偿整理 URL 是个坏主意……除非您详细了解相关网站的组织方式。

“foo.com”和“www.foo.com”是同一个地方的约定*只是*约定，很多网站都没有实现。删除“www”。这将是一个坏主意，因为它很可能将可解析的 URL 转换为无法解析的 URL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-29T11:44:53.197

您可以使用 google guava 从主机名中获取域名：

```
InternetDomainName.from(hostname).topPrivateDomain().toString() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-23T20:53:51.253

听起来您正在寻找有效的二级域。对于少数公共后缀，例如 .com、.net、.org，这很容易提取，方法是首先获取主机名，如 Stephen 所述，然后从末尾的第二个句点开始提取子字符串。但是，许多公共后缀（例如 co.uk）会破坏这个简单的算法。可以在此处找到完整的公共后缀列表：[http](http://publicsuffix.org/) ://publicsuffix.org/然后您可以在查找表中使用公共后缀来获得有效的二级域。

# symfony - symfony2 dom_import_simplexml()

> ID：11209867
> 
> 赞同：0
> 
> 时间：2012-06-26T14:43:06.647
> 
> 标签：symfony

我有这个错误信息：

> 警告：dom_import_simplexml(): Invalid Nodetype to import in .../Symfony/vendor/symfony/src/Symfony/Component/DependencyInjection/Loader/XmlFileLoader.php 第 437 行

当我在安装我的 sf2 框架后尝试`Symfony/web/app_dev.php/`在我的网络服务器上获取 sf2 页面时。

我该如何解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T09:13:03.477

有可能 ：

*   PHP 5.4 安装的问题 [ [Symfony 问题 #3643](https://github.com/symfony/symfony/issues/3643) ]
*   APC 在 PHP 5.4 中破坏 simplexml 的问题 [ [PHP Bug #61956](https://bugs.php.net/bug.php?id=61956) ]
*   libxml 的过时版本 [检查 SimpleXML[要求](http://www.php.net/manual/en/simplexml.requirements.php)、[安装](http://www.php.net/manual/en/simplexml.installation.php)和 libxml[安装](http://www.php.net/manual/en/libxml.installation.php)]

# sql-server-2008 - FTP 任务 SSIS 包中的通配符

> ID：11209869
> 
> 赞同：0
> 
> 时间：2012-06-26T14:43:11.957
> 
> 标签：sql-server-2008, ssis

我正在尝试从 FTP 下载文件，但有时间戳。文件格式为 YYYYMMDDHHMMSS。我怎样才能在当天提取文件？我将在哪里添加通配符

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:26:04.610

这个[链接](http://microsoft-ssis.blogspot.co.uk/2011/08/foreach-ftp-file-enumerator.html)应该是一个好的开始。

您需要将当前日期构建为字符串，例如 YYYYMMDD，这可以使用脚本组件或 SQL 任务来完成。

将当前日期字符串值传递给一个变量，使用该变量使用 SSIS 表达式，比较当前日期变量与当前 FTP 文件名的前 8 个字符，来自每个枚举器。

# objective-c - 如何在不同的班级中获得用户点击的通知？

> ID：11209870
> 
> 赞同：0
> 
> 时间：2012-06-26T14:43:14.287
> 
> 标签：objective-c, xcode4

我有一个创建日历的类。其中一种方法查找用户点击的日期，并将其存储在*同一类的 CFGregorianDate 对象中*。

当用户点击日历日期时，我需要*在另一个类*中知道，但是在更新 CFGregorianDate 对象之后，我可以做一些后端处理。

如何在二等舱中获得点击通知？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:57:20.670

考虑[NSNotificationCenterClass](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsnotificationcenter_Class/Reference/Reference.html)一个选项给你..

```
 // add this in your anotherClass
 [[NSNotificationCenter defaultCenter] removeObserver:self];
 [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(objectUpdated:) name:@"objectUpdated" object:nil];

 //then post notification after you updated the CFGregorianDate
 NSNotificationCenter *ncSubject = [NSNotificationCenter defaultCenter];  
 [ncSubject postNotificationName:@"objectUpdated" object:nil];  
 [ncSubject removeObserver:self]; 
```

# css - 在 CSS 属性中访问的 GWT ImageResource？

> ID：11209876
> 
> 赞同：36
> 
> 时间：2012-06-26T14:43:33.363
> 
> 标签：css, gwt

Google/GWT 创建 ImageResource 的例子理解：

```
interface MyResources extends ClientBundle {
  @Source("image.png")
  ImageResource image();

  @Source("my.css");
  CssResource css();
}

@sprite .myImage {
  gwt-image: 'image';
} 
```

我了解如何使用 ImageResources 和应用样式名称，但是......

在我的应用程序中，我有多个主题，它们使用 CSS 和延迟绑定应用于各种小部件。所以我定义了一个我想使用 .myImage 类的 CSS 规则（“背景”），但它没有做任何事情：

```
background {
    background-attachment: fixed;
    background-image: .myImage;  //??  This is the question!
    background-size: contain
} 
```

在“背景”CSS 属性中使用 .myImage 类的语法是什么？看来我应该能够将 .myImage 类指定为背景图像的参数。

**编辑：做了一些更多的研究，并找到了使用 DataResource 执行此操作的正确语法。**

```
MyClientBundle extends ClientBundle {

    //Background Image
    @Source("resources/background.png")
    DataResource backgroundImage();

} 
```

(mypanel.css)

```
@url background backgroundImage;

.myPanel {
    border-radius: 0px;
    background-color:#ffffff;
    opacity:0.6;
    background-image: background;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-19T19:30:10.670

如果您将“myImage”作为样式名称添加到任何小部件，它将设置这些小部件的背景...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-02T17:38:55.110

在“背景”css 属性中使用 .myImage 类的语法

```
MyClientBundle extends ClientBundle {

        //Background Image
        @Source("resources/background.png")
        DataResource backgroundImage();
    } 
```

(mypanel.css)

```
@url background backgroundImage;

.myPanel {
    border-radius: 0px;
    background-color:#ffffff;
    opacity:0.6;
    background-image: background;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-02T14:53:43.753

我认为正确的方法是`@ImageOptions`在 css-class 本身中定义和其余的定义。

对我来说，下面的代码

**主题.java**

```
public interface Theme extends ClientBundle {

  @ImageOptions(repeatStyle = RepeatStyle.None, preventInlining = true)
  @Source("path/logo.png")
  ImageResource logo();

  @Source("theme.css")
  ThemeCss css();

  interface ThemeCss extends CssResource {
      String logo();
  }

} 
```

**主题.css**

```
@sprite .logo {
  gwt-image: "logo";
  background-size: contain;
  background-attachment: fixed;
} 
```

产生这个输出：

```
.GLOMG3GI {
  height: 344px;
  width: 633px;
  overflow: hidden;
  background:url(data:image/png;base64,iV...=) -0px -0px no-repeat;
  background-size: contain;
  background-attachment: fixed;
} 
```

您可以在 gwt-image 属性之后或使用 ImageOptions 覆盖所需的任何 css 属性。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-02-20T09:17:01.940

您可以使用这样的样式`myResources.css.myImage`。我的意思是无论你想在 UiBinder 中使用样式的任何地方，都可以通过使用`styleName`具有此值的属性来使用它。

在您的情况下，无论您在哪里应用 class `.myPanel`，都可以应用`styleName='myResources.css.myImage'`, 来应用背景图像。

如果你想在java中使用它（即没有UiBinder），你可以像这样使用

```
MyResources myResources = GWT.create(MyResources.class);
widget.setStyleName("myResources.css.myImage"); 
```

这里的小部件是小部件的对象，您要对其应用背景。

我建议你看一下这个[解释](https://stackoverflow.com/questions/4535094/how-do-i-use-image-sprites-in-gwt)，以便清楚地理解。

# android - Android，HttpsUrlConnection：POST参数和密码接收InputStream

> ID：11209882
> 
> 赞同：3
> 
> 时间：2012-06-26T14:43:54.203
> 
> 标签：android, database, post, parameters, httpsurlconnection

希望你们中的一些人可以帮助我解决我的“大脑僵局”。

（只是为了理解）我正在尝试使用 php 脚本接收数据库。因此，我必须调用一个网络地址/服务器，只有当我使用有效的用户名/密码组合并发送正确的参数时，我才能访问 php 脚本。

使用 HttpClient 和 HttpPost 时，我的代码运行良好。（在 GOOD 代码下方）

```
 InputStream myInputDB = null;
    OutputStream myOutputDB = null;
    HttpResponse response = null;
    // Path to the just created empty db
    String dbFilePath = DB_PATH + KeyConstants.DB_NAME;

    try {
        // Creating HTTP client
        HttpClient httpClient = new DefaultHttpClient();
        // Creating HTTP Post
        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
        nameValuePairs.add(new BasicNameValuePair("version", "20110516140000"));
        HttpPost httppost = new HttpPost("http://USERNAME:PASSWORD@SomeAdress/u/db2.php");
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        response = httpClient.execute(httppost);
        //Open your local db as the input stream
        myInputDB = response.getEntity().getContent();
        //Open the empty db as the output stream
        myOutputDB = new FileOutputStream(dbFilePath);
        //transfer bytes from the inputfile to the outputfile
            byte[] buffer = new byte[1024];
        int length;
        while ((length = myInputDB.read(buffer)) > 0) {
            myOutputDB.write(buffer, 0, length);
        }
        //Close the streams
        myOutputDB.flush();
        myOutputDB.close();
        myInputDB.close(); 
```

现在我正在尝试使用 HttpURLConnection/HttpsURLConnection 而不是上述解决方案。为什么要清楚，live-system使用HTTPS（服务器认证）。

到现在为止，我浪费了几天试图弄清楚如何...

1.  带有 HttpURLConnection 的 POST 参数
2.  在服务器上进行身份验证
3.  一般避免认证检查（用于测试！）

我只是不知道我在哪里犯了错误。到目前为止，在我的代码下方...

```
 String urlString = "http://USERNAME:PASSWORD@SomeAdress/u/db2.php";
    String params = "version=20110516140000";
    InputStream stream = null;
    url = new URL(urlString);
    if (url.getProtocol().toLowerCase().equals("https")) {
        trustAllHosts();

        HttpsURLConnection urlconn = (HttpsURLConnection) url.openConnection();
        urlconn.setHostnameVerifier(DO_NOT_VERIFY);
        urlconn.setDoInput(true);
        urlconn.setDoOutput(true);
        urlconn.setRequestMethod("POST");
        urlconn.setRequestProperty("Content-Type", "text/xml");
        urlconn.setRequestProperty("Content-Length", String.valueOf(params.getBytes().length));

        OutputStreamWriter wr = new OutputStreamWriter(urlconn.getOutputStream());
        wr.write(params);
        wr.flush();

        stream = urlconn.getInputStream();
        if ("gzip".equals(urlconn.getContentEncoding())) {
            stream = new GZIPInputStream(stream);
        }

        wr.close();

    } else {            
        // Almost the same as if-path, but without trustAllHosts() and with HttpURLConnection instead of HttpsURLConnection         
    }

    return stream; 
```

我需要的是一个 InputStream，然后我可以在 android 手机上保存/复制它（如在工作代码中）。现在我得到的结果是一个 IOException。调用 urlconn.getInputStream() 后，Activity 立即中止。但是 getOutputStream() 也没有有效值。

现在的问题。任何人都可以查看我的代码并告诉我如何以正确的方式发布参数。除此之外，您知道我是否可以通过 URL 发送身份验证吗？特别是 HTTP'S' 部分让我很感兴趣。对于非安全模式，我已经有一个正在运行的解决方案。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T12:33:39.323

如果您可以使用浏览器（例如 Firefox）手动执行 HTTPS 连接，那么您只需查看浏览器发送的请求（例如使用 Firebug Firefox 扩展）并从那里复制您需要的标头并将它们放入您的代码中。

这个想法是首先使用标准工具（在这种情况下是浏览器）登录，然后查看成功时发送和接收的内容。

# ruby - 如何构建基于 Linux 的 SMTP 插件

> ID：11209883
> 
> 赞同：1
> 
> 时间：2012-06-26T14:44:07.443
> 
> 标签：ruby, plugins, smtp

我正在寻找有关如何开发依赖于与 SMTP 服务器交互的特定解决方案的建议。本质上，我想要一个 SMTP 服务器设置来接收所有传入的电子邮件，解析凭据并与基于服务器的应用程序（用 Ruby 编写）进行交互。该应用程序可以发回响应，然后 SMTP 服务器将转发该消息。

详细地说，我正在寻找的东西是：

*   与任何基于 Linux 的高质量 SMTP 服务器（Postfix、QMail、Sendmail 等）一起使用的插件（脚本或应用程序）。
*   执行以下操作的插件：
    *   从传入的 SMTP 请求中提取身份验证，将其发布到服务器端应用程序
    *   接收真或假响应，接受或拒绝消息
    *   在接受时，拉取收件人、主题和正文，并将其发布到服务器端应用程序
    *   接收修改后的消息正文，替换电子邮件消息
    *   将消息转发到最终目的地

我正处于我什至不知道自己在寻找什么的阶段。它可以与 Postfix 的配置指令串在一起吗？procmail 在某种程度上是其中的一部分吗？我是否需要开发人员为某个 SMTP 服务器编写一个成熟的插件？我熟悉管理这些应用程序，但不熟悉开发。

所有的见解和指针表示赞赏！

# grand-central-dispatch - GCD 队列类型

> ID：11209884
> 
> 赞同：3
> 
> 时间：2012-06-26T14:44:08.323
> 
> 标签：grand-central-dispatch

我试图了解队列类型之间的差异。据我了解，有3种类型：

*   全局队列 - 并发 - 无论顺序如何，块都会尽快执行
*   主队列 - 串行 - 块在提交时执行
*   私有队列 - 串行

我想知道的是：dispatch_sync 和 dispatch_async 在提交到每种队列时有什么区别？到目前为止，我是这样理解的：

```
dispatch_sync(global_queue)^
{
     // blocks are executed one after the other in no particular order
     // example: block 3 executes. when it finishes block 7 executes.
}

dispatch_async(global_queue)^
{
     // blocks are executed concurrently in no particular order
     // example: blocks 2,4,5,7 execute at the same time.
}

dispatch_sync(main_queue)^
{
     // blocks are executed one after the other in the order they were submitted
     // example: block 1 executes. when it finishes block 2 will execute and so forth.
}

dispatch_async(main_queue)^
{
     // blocks are executed concurrently in the order they were submitted
     // example: blocks 1-4 (or whatever amount of threads the system can handle at one time) will fire at the same time. 
     // when the first block completes block 5 will then execute.
} 
```

我想知道我对此的看法在多大程度上是正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T04:29:00.477

dispatch_sync 和 dispatch_async 之间的区别有点像 windows API 中的 sendmessage 和 postmessage。dispatch_sync 提交一个块对象以在调度队列上执行并等待该块完成。dispatch_async 在调度队列上提交一个异步执行块并立即返回。

目标队列确定该块是串行调用还是与提交到同一队列的其他块并发调用。独立的串行队列相对于彼此同时处理。

在发布问题之前，您应该先仔细阅读文档。

# java - 如何在java中再次抛出IOException？

> ID：11209885
> 
> 赞同：1
> 
> 时间：2012-06-26T14:44:08.667
> 
> 标签：java, exception, methods, ioexception, throw

代码：

```
 catch (IOException e) {
        LOGGER.error("IOException exception happened");
        //now need throw again the same exception to be 
                       //catched in    the    upper method
    } 
```

但是当我简单地尝试时：

```
 catch (IOException e) {
        LOGGER.error("IOException exception happened");
        //now need throw again the same exception to be 
                       //catched in    the    upper method
               throw e;
    } 
```

Eclipse 假设我将“throw e”放在 try catch 块中。但这是无稽之谈。如何解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T14:46:53.937

由于[`IOException`](http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html)是已[检查异常](http://www.javapractices.com/topic/TopicAction.do?Id=129)`IOException`，因此如果您希望该方法传播，则需要将该方法声明为 throwing 。例如：

```
void myMethod() throws IOException {
    try {
        //code
    }
    catch(IOException e) {
        LOGGER.error("IOException exception happened");
        throw e;
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-26T14:47:26.607

第二个代码片段很好。请记住，您必须将您的方法声明为：

```
public void myMethod() throws IOException {
    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T14:48:23.453

尝试添加`throws IOException`到您的方法中，例如：

```
private void yourMethodName() throws IOException {
    # your method
} 
```

然后 Eclipse 不会要求第二个 try catch 块。

# java - 如何在android中存储.txt字典文件并从中检索单词

> ID：11209886
> 
> 赞同：1
> 
> 时间：2012-06-26T14:44:10.367
> 
> 标签：java, android, autocomplete, android-widget

我正在开发 android 应用程序，它将提供字典支持（打字时的建议）。所以，我有一个 50000 字的文本格式（.txt）的目录。所以是否可以`.txt`像在 android 中一样存储和检索文件。

请提出一些方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:51:47.510

您可以将该文件放入`assets`或`raw`文件夹中

读书

```
String url = "file:///android_asset/raw/filename.txt"; 
```

有关更多信息，请参阅[此](https://stackoverflow.com/a/11157926/1289716)答案

# sql - SQL Select 查询以从同一行中提取多个值作为单独的行

> ID：11209888
> 
> 赞同：0
> 
> 时间：2012-06-26T14:44:17.533
> 
> 标签：sql, db2

我有一个存储位置值的数据表，如下所示：CTY_CD、STATE_CD、COUNTRY_CD 并且我想在给定城市代码的情况下从该表中进行选择，并选择所有三个位置代码作为单独的行，另一列显示它是什么 loc 类型，所以结果的查询看起来像：

```
Given city code DEN:

Type         |    Code
CTY_CD            DEN
STATE_CD          CO
COUNTRY_CD        US 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:46:19.780

像这样的东西？

```
 select 'CTY_CD' AS Type,  CTY_CD AS Code FROM tableName WHERE CTY_CD = 'DEN'
 UNION
 select 'STATE_CD' AS Type, STATE_CD AS Code FROM tableName WHERE CTY_CD = 'DEN'
 UNION
 select 'COUNTRY_CD' AS Type, COUNTRY_CD AS Code FROM tableName WHERE CTY_CD = 'DEN' 
```

# .net - 从 BindingSource.PositionChanged 运行时的并行任务块

> ID：11209893
> 
> 赞同：1
> 
> 时间：2012-06-26T14:44:52.083
> 
> 标签：.net, winforms, c#-4.0, task-parallel-library, bindingsource

一个非常简单的任务：

```
Task.Factory.StartNew(() =>
{
    Thread.Sleep(5000);
}).ContinueWith(_ =>
{
    lblStatus.Text = "Done";
}, TaskScheduler.FromCurrentSynchronizationContext()); 
```

它在运行时按预期执行，`Form_Load()`但在从与 BindingSource 相关的任何事件运行时会阻塞 5 秒。

我错过了一些关于 BindingSources 的东西吗？我正在使用.NET 4。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:12:05.827

您的代码将 ThreadPool 线程阻塞 5 秒。如果您为大量事件执行此代码，您可能会耗尽所有线程池线程并有效地阻塞您的应用程序，直到所有 Sleep 语句完成。

两个代码示例都使用默认线程调度程序执行。不同之处在于第二个示例使用 TaskCreationOptions.LongRunning 指示调度程序创建新线程而不是等待池线程。这可能会克服最初的问题，但它仍然不是正确的解决方案，因为您仍在浪费线程并且可能没有线程可用于其他任务。

一个正确的实现是使用一个TaskSource，它会在定时器到期时发出信号。这样你就不会阻塞任何线程。

[C# 5 已经通过Task.Delay](http://msdn.microsoft.com/en-us/library/hh160377%28v=vs.110%29)方法支持这一点。如果您使用Visual Studio 2012的[异步目标包](http://www.microsoft.com/en-us/download/details.aspx?id=29576)或2010的[Async v3 CTP ，则可以在 .NET 4.0 中使用它](http://www.microsoft.com/en-us/download/details.aspx?id=9983)

您还可以在 ParallelExtensionExtras 库中找到类似的方法。TaskFactory.StartNewDelayed扩展方法的工作[方式](http://blogs.msdn.com/b/pfxteam/archive/2010/04/04/9990342.aspx)几乎相同。[Stephen Toub 文章中](http://blogs.msdn.com/b/pfxteam/archive/2009/06/03/9691796.aspx)的示例代码提供了一个简化版本：

```
public static Task StartNewDelayed(int millisecondsDelay, Action action) 
{ 
// Validate arguments 
if (millisecondsDelay < 0) 
    throw new ArgumentOutOfRangeException("millisecondsDelay"); 
if (action == null) throw new ArgumentNullException("action"); 

// Create a trigger used to start the task 
var tcs = new TaskCompletionSource<object>(); 

// Start a timer that will trigger it 
var timer = new Timer( 
    _ => tcs.SetResult(null), null, millisecondsDelay, Timeout.Infinite); 

// Create and return a task that will be scheduled when the trigger fires. 
return tcs.Task.ContinueWith(_ => 
{
    timer.Dispose();
    action();
}); 
} 
```

使用 ParallelExtensionsExtras 中的版本，您可以重写代码，如下所示：

```
Task.Factory.StartNewDelayed(5000).ContinueWith(_ =>
{
    lblStatus.Text = "Done";
}, TaskScheduler.FromCurrentSynchronizationContext()); 
```

**编辑：**

看来实际代码毕竟没有 Thread.Sleep 。它执行一些繁重的数据库相关操作。不过效果是一样的。在每个 BindingSource 事件之后启动一个新任务可能会导致线程池耗尽的运行任务过多。

一种解决方案是再次使用带有[TaskFactory.StartNew(Action,TaskCreationOptions)](http://msdn.microsoft.com/en-us/library/dd321263)覆盖的 TaskCreationOptions.LongRunning 标志来指示调度程序创建更多线程。

更好的解决方案是异步执行数据库操作，使用 BeginExecuteXXX,EndExecuteXXX 方法结合[TaskFactory.FromAsync](http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskfactory.fromasync)将异步调用转换为任务。这样数据库操作根本不会阻塞任何线程。

你可以这样写：

```
Task<SqlDataReader> task = Task<SqlDataReader>.Factory.FromAsync(
    cmd.BeginExecuteReader(CommandBehavior.CloseConnection),
    cmd.EndExecuteReader)
.ContinueWith(reader=>
{
    //do some processing
    reader.Close();
});
.ContinueWith(_ => 
{
    lblStatus.Text="Done";
},TaskScheduler.FromCurrentSynchronizationContext()); 
```

异步读取和处理数据，并在处理完成后更新 UI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T17:46:41.147

我通过将默认任务调度程序分配给任务来解决这个问题。最终形式变为：

```
Task.Factory.StartNew(() =>
{
    Thread.Sleep(5000);
}, CancellationToken.None, TaskCreationOptions.LongRunning, TaskScheduler.Default).ContinueWith(_ =>
{
    lblStatus.Text = "Done";
}, TaskScheduler.FromCurrentSynchronizationContext()); 
```

我不是 C# 方面的专家，所以我真的不知道它为什么会这样工作。

# javascript - 链式选择框不起作用

> ID：11209897
> 
> 赞同：0
> 
> 时间：2012-06-26T14:45:03.863
> 
> 标签：javascript, jquery

我有三个选择框 state、city 和 locality，id 与 name 相同

```
$(document).ready(function() {
    $("#state").on('change',function(){
        var state = $("#state").attr('value');
        $("#city").load('http://localhost/trial/index.php/new/view_cities/'+state).change();
    }).change();

    $("#city").on('change',function(){
        var city = $("#city").attr('value');
        $("#locality").load('http://localhost/trial/index.php/new/view_localities/'+city);
    }).change();
}); 
```

页面加载状态会正确显示，因为它直接来自数据库，并且城市选项会自动更新，但地区不会。当我改变城市时，地方可能会改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:48:40.613

该`.load()`函数只是`$.ajax()`异步调用的包装器；如果您尝试与作为该调用的结果加载到元素中的元素进行交互，则需要传递一个回调函数，该函数在 AJAX 请求返回成功响应后执行。

尝试更换：

```
$("#city").load('http://localhost/trial/index.php/new/view_cities/'+state).change(); 
```

和

```
$("#city").load('http://localhost/trial/index.php/new/view_cities/'+state, 
function() {
    $("#city").change();
}); 
```

还有一些一般性的观点：

您可以`this`在函数内部使用事件处理程序来引用触发事件的元素。而不是：

```
$("#state").on('change',function(){
    var state = $("#state").attr('value'); 
```

你可以这样做：

```
$("#state").on('change',function(){
    var state = this.value; 
```

此外，如果您**打算**使用 jQuery 来获取元素的值，请使用`.val()`函数而不是`.attr('value')`.

# python - 在 python 中， ++x 是正确的语法。“++x”是什么意思？

> ID：11209899
> 
> 赞同：1
> 
> 时间：2012-06-26T14:45:06.620
> 
> 标签：python, syntax

> **可能重复：**
> [Python：递增和递减运算符的行为](https://stackoverflow.com/questions/1485841/python-behaviour-of-increment-and-decrement-operators)

```
>>> a=2
>>> ++a
2
>>> a++
Traceback (  File "<interactive input>", line 1
    a++
      ^
SyntaxError: invalid syntax
>>> ++a
2 
```

为什么 ++x 可以？

（我在问，因为有人在工作中习惯性地写了 ++i，它没有按（习惯性地）预期的那样做，但也没有抛出错误，所以花了一些时间来找到错误。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-26T14:47:01.580

它的意思是`+(+a)`，即与的意思相反`-(-a)`（虽然显然在这种情况下，结果是一样的！）

请参阅[http://docs.python.org/library/stdtypes.html#numeric-types-int-float-long-complex](http://docs.python.org/library/stdtypes.html#numeric-types-int-float-long-complex)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T14:48:52.760

它相当于`+(+a)`：

```
>>> +-2
-2
>>> -+2
-2
>>> --2
2
>>> ++++-2
-2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T14:48:49.960

Python 的可能重复项[：递增和递减运算符的行为](https://stackoverflow.com/questions/1485841/python-behaviour-of-increment-and-decrement-operators)。

尽管我无法找到有关操作员确切推理的文档，但我将在链接问题中引用已接受答案的一部分，我认为是这种情况：

> *   更简单的语言。++ 只不过是 += 1 的同义词。它是一种简写，因为 C 编译器很愚蠢，不知道如何将 += 1 优化为大多数计算机具有的 inc 指令。在优化编译器和字节码解释语言的今天，向一种语言添加运算符以允许程序员
>     优化他们的代码通常是不受欢迎的，尤其是在像 Python 这样的设计为一致和可读的语言中。

# ruby-on-rails - Rails：参数太少

> ID：11209900
> 
> 赞同：39
> 
> 时间：2012-06-26T14:45:10.617
> 
> 标签：ruby-on-rails, ruby-on-rails-3, controller, ruby-on-rails-3.2

我试图让一些 Javascript 在我的 Rails 应用程序中工作。

我想让我的索引页面允许我编辑索引页面上的单个项目，然后在编辑时重新加载索引页面。

我的 index.html.erb 页面如下所示：

```
<div id="index">
<%= render 'index' %>
</div> 
```

在我的 index.js.erb 我有：

```
$('#index').html("<%=j render 'index' %>"); 
```

在我的 holder_controller 中：

```
def edit
  holder = Holder.find(params[:id])
 end

def update
  @holder = Holder.find(params[:id])
  if @holder.update_attributes(params[:holder])
    format.html { redirect_to holders_path } #, flash[:success] = "holder updated")
    ## ^---Line 28 in error
    format.js
  else
    render 'edit'
  end
end 
```

当我加载索引页面时，它很好。只要单击编辑按钮并提交表单，我就会得到以下信息：

![在此处输入图像描述](../Images/de63ae0fc03908d72054512a2e97b3ad.png)

但是，如果我返回并刷新索引页面，则将保存编辑。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2012-06-26T14:48:08.487

你忘了写`responds_to`块：

```
def update
  @holder = Holder.find(params[:id])
  if @holder.update_attributes(params[:holder])
    respond_to do |format|
      format.html { redirect_to holders_path } #, flash[:success] = "holder updated")
      format.js
    end
  else
    render 'edit'
  end
end 
```

但是我对您的 index.html.erb 持怀疑态度，我认为这不会像您想的那样真正起作用。

# javascript - 为什么使用 (function() { .... }());

> ID：11209903
> 
> 赞同：10
> 
> 时间：2012-06-26T14:45:28.387
> 
> 标签：javascript

> **可能重复：**
> [(function() {})() 构造如何工作以及人们为什么使用它？](https://stackoverflow.com/questions/1639180/how-does-the-function-construct-work-and-why-do-people-use-it)

为什么现代 JavaScript 文件使用如下结构：

```
(function () {
   // some real code
 }()); 
```

即我知道正在创建一个匿名函数，然后立即调用，没有传递任何参数……但是为什么要这样做而不只是调用`some real code`呢？外面的一对圆括号是干什么用的？

特别是我盯着Github上的[js/start.js文件：](https://github.com/hdragomir/Pocket-Island/blob/1d1295ddc53666b57bb283d93fcbdf3c72fdd30b/js/start.js)

```
(function() {
    "use strict";

    wooga.castle.GRID_UNIT = 48;
    wooga.castle.IMAGES_BASE_URL = "images/entities/";

    (function () {
        var style = document.createElement('div').style,
            prefix;
        var candidates = {
            webkit: 'webkitTransform',
            moz:    'MozTransform', // 'M' is uppercased
            ms:     'msTransform',
            o:      'oTransform',
            '':     'transform'
        };
        for (var prefix in candidates) {
            var candidate = candidates[prefix];
            if ('undefined' !== typeof style[candidate]) {
                wooga.castle.prefix = prefix;
                wooga.castle.prefixedTransform = candidate;
                break;
            }
        }
    }());

    // XXX why the 2 wrapped "function"s here? XXX

    wooga.castle.isNativeWrapper = function() {
        var result = !wooga.castle.capabilities.desktop && !wooga.castle.capabilities.android && (! /Safari/.test(navigator.userAgent));
        wooga.castle.isNativeWrapper = function () {
            return result;
        };
        return result;
    };
}()); 
```

凭借我的基本 JavaScript 和 jQuery 技能，我理解上面列出的单个命令，但我不明白为什么它们会包含在几个`function`s. 我们不能打电话给：

```
 "use strict";

    wooga.castle.GRID_UNIT = 48;
    wooga.castle.IMAGES_BASE_URL = "images/entities/";
    var style = document.createElement('div').style,
        prefix;
    var candidates = {
        webkit: 'webkitTransform',
        moz:    'MozTransform', // 'M' is uppercased
        ms:     'msTransform',
        o:      'oTransform',
        '':     'transform'
    };
    for (var prefix in candidates) {
        var candidate = candidates[prefix];
        if ('undefined' !== typeof style[candidate]) {
            wooga.castle.prefix = prefix;
            wooga.castle.prefixedTransform = candidate;
            break;
        }
    }

    wooga.castle.isNativeWrapper = !wooga.castle.capabilities.desktop && !wooga.castle.capabilities.android && (! /Safari/.test(navigator.userAgent)); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-26T14:48:19.583

这样做是为了使里面的代码不会干扰全局范围内的变量。

例如：

```
var myLibrary = {};
var _privateVar = []; 
```

现在，这两个都是全球性的。但是，我不想那样。所以，如果我创建一个函数，我可以创建一个新的范围。

```
(function(){
    window.myLibrary = {}; // global
    var _privateVar = []; // private
}()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T14:47:05.973

它被称为闭包，它旨在封装代码，以便变量和函数不在全局范围内声明，从而防止冲突。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T14:47:15.193

这样做是为了防止“污染全局范围”。通过用匿名函数包围代码，变量只存在于函数的范围内，从而防止了全局命名空间中可能发生的冲突。

需要外括号，因为`function(){}`它本身就是一个声明，您需要通过在其前面添加`(...)`or 和将其转换为表达式`!`才能执行它。

# java - 为什么我的 onTouchListener 被调用来获取邻居视图？

> ID：11209904
> 
> 赞同：1
> 
> 时间：2012-06-26T14:45:35.703
> 
> 标签：java, android, events, touch

在我的应用程序中，我想为按钮和其他充当按钮的视图添加一个简单的动画。

为此，我为所有视图设置了一个自定义 onTouchListener 并在它们上调用 startAnimation。

我的 onTouch 方法如下所示：

```
public boolean onTouch(View v, MotionEvent event) {

    // Only show animation when enabled.
    if (v.isEnabled()) {
        switch (event.getAction()) {
        case MotionEvent.ACTION_DOWN:
            v.startAnimation(shrink);
            break;
        case MotionEvent.ACTION_UP:
            v.startAnimation(grow);
            break;
        }
    }
    return v.onTouchEvent(event);
} 
```

这可以正常工作，因为当用户按下按钮时视图被调整为较小的尺寸，并在用户松开手指时返回到原始尺寸。

然而，由于某种原因，位于触摸按钮附近的其他按钮也会获得 UP 事件，因此它们也会获得一个小的动画闪烁。

为什么会这样，更重要的是，我该如何防止这种恼人的行为？

编辑：只是为了清楚。邻居视图也注册到同一个侦听器实例，但我的手指没有触摸它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T06:37:37.203

问题是在多个视图上使用相同的动画实例。为每个视图创建单独的实例解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:56:54.410

然后，您已注册侦听器的视图应该只收到通知，然后也使用以下方法。

您可以明确检查 View 的 id 是什么，然后只启动动画。

```
public boolean onTouch(View v, MotionEvent event) {

    if (v.getId() == R.id.desired_view_id) {
        // Only show animation when enabled.
        if (v.isEnabled()) {
            switch (event.getAction()) {
            case MotionEvent.ACTION_DOWN:
                v.startAnimation(shrink);
                break;
            case MotionEvent.ACTION_UP:
                v.startAnimation(grow);
                break;
            }
        }
    }
    return v.onTouchEvent(event);
} 
```

# java - Objectify/GAE - 一个具体的非规范化问题

> ID：11209908
> 
> 赞同：1
> 
> 时间：2012-06-26T14:45:46.170
> 
> 标签：java, google-app-engine, objectify

我正在使用 Google App Engine 和 Objectify 3.1，并根据它们的用法慢慢学习非规范化和设计实体，但我仍然在某些方面苦苦挣扎。

我目前正在构建一个用户实体可以参与游戏实体的系统，并且需要能够找到用户参与的所有游戏。在我看来，有两个基本解决方案：

**解决方案1）**

在游戏中存储用户密钥（participantKeys）列表，并找到成员参与的游戏，如下所示：

```
List<Key<User>> userList = new ArrayList<Key<User>>();
userList.add(new Key<User>(User.class, myUserId));
Collection<Game> games = ofy().query(Game.class).filter("participantKeys in" , userList).list(); 
```

**解决方案2）**

除了在游戏实体上存储参与者列表外，还要在用户实体上存储用户参与的游戏列表并找到游戏，如下所示：

```
User myUser = userDao.getUser(myUserId);
Collection<Game> games = user.getParticipatedGameKeys(); 
```

一旦系统中有很多游戏，解决方案 1 会变得非常慢。

解决方案 2 可以更快地找到游戏，但我需要在用户加入和离开游戏时不断更新列表。

一旦用户长时间使用系统，游戏列表也会变大。我只想返回用户当前参与的所有游戏，因此需要遍历列表并排除“历史”游戏。

我错过了一个更优雅的解决方案吗？以上都不是很吸引人。

非常感谢任何和所有帮助！

**编辑：**

在考虑了很长时间的替代方案后，我决定尝试像 Mikl 建议的东西。所以很高兴听到一个非常相似的解决方案:-)

我创建了一个 GameParticipation 实体，其中包含指向游戏的链接、指向用户的链接以及我需要能够获取的所有其他信息。

每次加入游戏时，我都会更新 GameParticipation 实体以反映游戏的当前状态。离开游戏时，我删除实体。此外，当游戏更改时，我会更新所有相关的 GameParticipation 实体。

我做了一些性能测试，它似乎工作得相当好！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T08:08:58.623

你也可以有另一个实体，我不知道你怎么称呼它（UserGame？），但在这个实体中，你将存储游戏密钥、用户密钥以及你想要访问的一些信息，例如用户名称，游戏名称等。然后，当用户进入游戏时，您将创建此实体。

使用此实体，您可以轻松检索成员参与的游戏以及参与游戏的所有用户。

此方法的不便之处在于，如果用户属性或游戏属性发生更改，您还需要更新存储在 USerGame 实体中的信息，例如 userName。

我不知道这是否是一个好的解决方案，但它应该可以工作。

# javascript - 如何确定在javascript中已经过去了多少分钟

> ID：11209910
> 
> 赞同：4
> 
> 时间：2012-06-26T14:45:56.887
> 
> 标签：javascript, datetime

我有从 JSON 格式的数据填充的变量。类似的东西： `var time=my_data[data.results[i].id].time;` 这让我有时间以这种格式从数据库中获取时间：`2012-06-19 15:48:18.140`

如何保存其他变量值，例如`active`，如果我从数据库获得的值与存在的时间（现在）之间的时间小于 5 分钟，`inactive`如果超过 5 分钟

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T15:07:47.570

请参阅[文档](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date)以获取 javascript 日期

日期构造函数接受一个[日期字符串](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/parse)。我在 chrome 控制台中试过你的，它工作正常。然后您可以使用[getTime](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/getTime)获取自 1970 年 1 月 1 日以来的毫秒数

最后

```
var past = new Date(yourTimeString).getTime();
var fiveMin = 1000 * 60 * 5; 
var isPast = (new Date().getTime() - past < fiveMin)?false:true; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:50:07.040

```
var fiveMinutes = 1000 * 60 * 5;
var otherVariable = ((new Date().getTime() - time) < fiveMinutes) ? "active": "inactive"; 
```

但我不确定您从 JSON 中获得的类型，因此您可能需要改用此变体：

```
var fiveMinutes = 1000 * 60 * 5;
var otherVariable = ((new Date().getTime() - new Date(time).getTime()) < fiveMinutes) ? "active": "inactive"; 
```

# java - 列表 在java中

> ID：11209913
> 
> 赞同：0
> 
> 时间：2012-06-26T14:46:07.463
> 
> 标签：java, arrays

我如何实例化列表中的对象，例如

我喜欢在文件中搜索开始，如果找到，则在其后添加存储代码。这是示例

```
public abstract class Structure 
{   
    private List<Structure> structureList = new ArrayList<Structure>();

    protected void setStructure(Filemanager file, String line)
    {
    /*
     * set all values at the object structure
     */
    line = file.getSourceLine();

    while (!line.contains("END_"))
    {
                    if (line.contains("TRANSLATE"))
                    {

                    }
                    else if (line.contains("BEGIN_OBJECT"))
                    {
                        structureList.add(new FunctionalStructure(line));
                    }
                    else 
                    {
                        setValue(line);
                    }
                    line = file.getSourceLine();
            }
    }

    protected abstract void setValue(String line);  
}

public abstract class FunctionalStructure extends Structure 
{ 
    private String name;
    public FunctionalStructure(String line) 
    { 
        super();
        this.name = line.substring(line.indexOf("\"")+1, line.lastIndexOf("\"")); 
    } 
    public String getName() 
    { 
        return this.name; 
    } 
    public List<Structure> Startfunctional() 
    { 
        return null;
    } 
    protected abstract void setValue(String line); 
} 
```

我在实例化 structureList.add(new FunctionalStructure(line)); 中遇到问题

谁能告诉上面一行有什么问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:51:32.433

我认为那`FunctionalStructure`一定是一个抽象类（大概是 extends `Structure`）。您不能实例化抽象类。

这就是为什么您会收到如下错误：

```
Cannot instantiate the type FunctionalStructure 
```

如果您创建了 FunctionalStructure 类，也许您不小心将其标记为抽象的。假设它实现了 setValue(String) 方法，您可以从类声明中删除 abstract 修饰符。

`FunctionalStructure`或者，使用在您正在使用的 API 中扩展的合适的具体类。

或者，使用匿名内部类：

```
structureList.add(new FunctionalStructure(line){
    public void setValue(String value) {
        // your implementation here
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:57:06.613

您可能会发现以下示例有助于理解该概念：-

```
package pack;

public class Demo {

    public static void main(String[] args) {

        MyGeneric<A> obj = new MyGeneric<A>() ;

        //obj.add(new C()) ; //don't compile
        obj.testMethod(new A()) ; //fine
        obj.testMethod(new B()) ; //fine
    }
}

class A{}

class C{}

class B extends A{}

class MyGeneric<T>{

    public void testMethod(T t) {

    }
} 
```

**编辑：因此，结构和功能结构**之间必须存在 IS-A 关系才能成功编译代码。

# android - android定位服务GPS精度值范围

> ID：11209915
> 
> 赞同：2
> 
> 时间：2012-06-26T14:46:12.683
> 
> 标签：android, gps

我的手机 Motorola Fire Android 2.2 显示 GPS 读数的最差精度为 250 米。这已通过“GPS 测试”程序得到证实。除此之外，GPS 读数不可用，图标开始闪烁......但是我听到不同的 android 手机显示不同的最差精度数字。这是真的 ？如果是，如何确定程序中最差的预期精度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:51:31.503

从 API 级别 9 (Android 2.3) 开始，您可以通过[Criteria](http://developer.android.com/reference/android/location/Criteria.html#ACCURACY_COARSE)中的值指定准确性。`ACCURACY_LOW`，`ACCURACY_MEDIUM`并`ACCURACY_HIGH`为您提供其标准匹配项的估计最小值/最大值。

对于 API <9，如果您查看 Android 的源代码，可能会有一些信息，但我相当确定没有提到关于它的 SDK 级别。

# javascript - 将类的所有元素的内容放入数组中..为什么我会收到这些错误消息

> ID：11209920
> 
> 赞同：1
> 
> 时间：2012-06-26T14:46:27.870
> 
> 标签：javascript, jquery

我正在尝试将具有特定类的所有 div 的文本加载到数组中，但这

```
var temp = $('.theClass').text();
    temp = temp.toArray();
    console.log(temp); 
```

一直给我错误

`Uncaught TypeError: Object has no method 'toArray'`

和

```
var tempArr = [];
var temp = $('.theClass').text();

for (var t in temp){

    tempArr.push(t);
}
console.log(tempArr); 
```

导致一个数组填充了许多对象中的许多对象，这些对象只填充了整数。 ![chrome控制台截图](../Images/2e5dfc97babd9d7ca0352cc3577763de.png)

可以在[此处](https://stackoverflow.com/a/4948779/1252748)找到有关如何正确执行此操作的说明，但我想知道是否有人可以向我解释为什么会出现这些错误。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:48:40.047

您可以使用[`map`](http://api.jquery.com/map/)迭代匹配集的每个元素并返回一些数据（在本例中为文本）。然后，您可以使用[`get`](http://api.jquery.com/get/)将生成的 jQuery 对象转换为实际数组：

```
var arr = $('.theClass').map(function () {
    return $(this).text();
}).get(); 
```

您的第一次尝试失败，因为该`text`方法返回一个字符串，而字符串没有`toArray`方法（因此您的“对象没有方法”错误）。

您的第二次尝试失败，因为您正在使用循环遍历字符串`for...in`。此循环遍历字符串的字符。每次迭代`t`都分配了字符的索引，因此您最终得到一个数组，字符串中的每个字符都有一个元素。您永远不应该真正使用`for...in`循环来迭代对象属性以外的任何内容，即使那样，您也应该始终包含`hasOwnProperty`检查。

# jquery - jquery fileupload - 如何停止/暂停上传

> ID：11209924
> 
> 赞同：3
> 
> 时间：2012-06-26T14:46:44.493
> 
> 标签：jquery, jquery-plugins, file-upload

我正在使用 BlueImp 的 jquery fileupload 插件，并试图弄清楚如果没有提供其他表单字段，如何以编程方式停止上传。除了完全销毁实例之外，似乎没有停止上传的方法，这不是我想要做的。这是我正在尝试做的一个例子：

```
$('#fileupload').fileupload({
        maxFileSize: 5000000,
        acceptFileTypes: /(\.|\/)(gif|jpe?g|png)$/i,
        send: function(){
           // Validate text fields
           if (($('#name').text() == '') || ($('#division').text() == '') || ($('#location').text() == ''))
            alert('Please complete all of the fields');
            $('#fileupload').fileupload('destroy');
        }
    }); 
```

好的，想通了 - “提交”事件提供了一个回调，如果返回 false，则阻止上传请求启动 - 这是验证失败时我想要做的

# asp.net-mvc - jqgrid中绑定下拉列的问题

> ID：11209926
> 
> 赞同：1
> 
> 时间：2012-06-26T14:46:46.777
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, drop-down-menu, jqgrid

我在 razor 视图引擎中使用 jqgrid 和 MVC3，在 jqgrid 我有一个下拉列，我像加载下拉列表一样......

```
colModel: [{ 
    name: 'Company', 
    index: 'Company', 
    width: 200, 
    editable: true, 
    edittype: 'select', 
    editoptions: { 
        dataUrl: '@Url.Action("PopulateDropdown", "ControllerName")' 
    }] 
```

如果我有 100 行，那么控制器操作会被调用 100 次。因此我`[OutputCache(Duration = 10, VaryByParam = "none", VaryByCustom = "Browser")]`在 mycontroller 中使用。

请提出任何其他想法，以便下拉列表项在视图中仅获取一次，并使用相同的内容绑定其余项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T16:32:26.143

如果您有 100 行，则不需要一次编辑所有行。通常使用内联编辑或表单编辑来编辑*一个*指定的行。然后通过按下`Enter`并选择另一行来保存该行。所以只有一行将被编辑，所有其他行将在相应的单元格中只有一些文本。

另一方面，如果您确实需要缓存服务器响应，`'@Url.Action("PopulateDropdown", "ControllerName")'`则可以`Cache-Control: max-age=60`直接在 JSON 响应的 HTTP 标头中设置：

```
Response.CacheSetMaxAge (new TimeSpan (0, 1, 0)); // cache for 1 minute 
```

# sql - 获取由另一列分组的列的总和，然后分组到另一列

> ID：11209933
> 
> 赞同：4
> 
> 时间：2012-06-26T14:46:56.003
> 
> 标签：sql, sql-server, sql-server-2008, tsql, sql-server-2008-r2

我已经尝试了一段时间来解决这个问题，但是我缺乏更高级的 SQL 技能使我退缩了。

```
Executions(TradeDate, Symbol, Side, Price, Under, Account)

TEMP DATA:
2012-06-20, AAPL 120716C00600000, BUY, 3.25, AAPL, XYZ123
2012-06-20, AAPL 120716C00600000, SELL, 3.30, AAPL, XYZ123
2012-06-20, AAPL 120716C00600000, BUY, 3.25, AAPL, XYZ123
2012-06-20, AAPL 120716C00600000, SELL, 3.30, AAPL, XYZ123
2012-06-20, GRPN 120716C00027000, BUY, 2.25, GRPN, XYZ123
2012-06-20, GRPN 120716C00027000, SELL, 2.30, GRPN, XYZ123
2012-06-20, GRPN 120716C00027000, SELL, 2.30, GRPN, XYZ123
2012-06-20, GRPN 120716C00027000, BUY, 2.25, GRPN, XYZ123

-UNDER----Side(Buy)----Side(Sell)
 AAPL      6.50         6.60
 GRPN      4.50         4.60 
```

如您所见，我正在尝试获取每边的价格总和，然后按下分组。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T14:51:19.817

用于`GROUP BY`按`Under`列分组并`CASE`关联`SUM`以获得所需的结果：

```
SELECT e.Under,
       SUM(case when e.Side = 'BUY' them e.Price else 0 end) as 'Side(Buy)',
       SUM(case when e.Side = 'SELL' them e.Price else 0 end) as 'Side(Sell)'
FROM Executions e
GROUP BY e.Under 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T14:53:24.617

您可以为此使用[PIVOT 。](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)（参见[SQL Fiddle 的演示](http://sqlfiddle.com/#!3/0dc1e/1)）

```
select *
from 
(
    select under, price, side
    from executions
) x
PIVOT
(
    sum(price)
    for side in ([BUY], [SELL])
) p 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:52:10.720

这是一种方法：

```
SELECT e.under
     , SUM(CASE WHEN e.side = 'BUY'  THEN e.price ELSE NULL END) AS [Side(Buy)]
     , SUM(CASE WHEN e.side = 'SELL' THEN e.price ELSE NULL END) AS [Side(Sell)]
  FROM Executions e
 GROUP BY e.under 
```

这里的“技巧”是使用 CASE 表达式仅返回特定侧值的价格。（注意：正如有人不可避免地指出的那样，ELSE NULL 是隐含的，可以省略。）

这不是唯一的方法。但如果您还需要获取例如每个总和中包含的行的“计数”以及所有行的计数，这是一种非常灵活的方法，效果很好。为了说明正在使用的这种方法：

```
 SELECT e.under
     , SUM(CASE WHEN e.side = 'BUY'  THEN e.price ELSE NULL END) AS [SUM_Side(Buy)]
     , SUM(CASE WHEN e.side = 'BUY'  THEN 1       ELSE 0    END) AS [COUNT_Side(Buy)]
     , SUM(CASE WHEN e.side = 'SELL' THEN e.price ELSE NULL END) AS [SUM_Side(Sell)]
     , SUM(CASE WHEN e.side = 'SELL' THEN 1       ELSE 0    END) AS [COUNT_Side(Sell)]
     , SUM(CASE WHEN e.side IN ('BUY','SELL') THEN 1 ELSE 0 END) AS [COUNT_(Buy+Sell)]
  FROM Executions e
 GROUP BY e.under 
```

这种方法通常具有非常可预测的性能，并且它要求源数据集只被引用一次（在这种情况下，一个简单的表引用）

这种方法几乎适用于所有关系数据库。（甲骨文、SQL Server、MySQL、Teradata、DB2、...）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T14:52:14.907

```
 select Symbol, sum(case when side = 'BUY' THEN Price else 0 END) as [Side(Buy)], sum(case when side = 'SELL' THEN Price else 0 END) as [Side(Sell)] group by Symbol 
```

# wcf - wcf 异常：服务器没有提供有意义的回复

> ID：11209934
> 
> 赞同：0
> 
> 时间：2012-06-26T14:46:57.743
> 
> 标签：wcf, exception, tcp

我有一个使用 tcp 绑定的服务，该服务允许客户端与数据库交互。我使用 EF 和自我跟踪实体。

我想做的一件事是将文件存储在数据库中，为了不使线路过载，我有两个表及其对应的实体。一个表 Documents 包含文档信息（类型、大小...等），另一个表 Files 存储二进制信息，即文件。

好吧，在本地，当我在同一台计算机上运行客户端和服务时，我可以存储我想要的文件。我尝试使用 6MB 的文件。但是如果我在同一局域网的其他计算机上运行客户端，那么我会遇到很多问题。

例如，如果我尝试存储一个 50kB 的小文件，我没有问题，但如果我尝试存储 6MB 的文件，那么我会得到不同的错误。

例如，如果我在客户端配置一个低超时，例如 1 分钟，我会收到错误：

System.TimeoutException：发送到 net.tcp://192.168.1.5:7997/CMMSHost 的此请求操作未在配置的超时 (00:01:00) 内收到回复。

如果我将客户端配置为超时 10 分钟，则会收到以下错误：

服务器没有提供有意义的回复

该服务托管在 wpf 应用程序中，并且在将文档添加到数据库中的服务的 Begin 方法中，我发送带有日志的文本以了解是否收到呼叫。当我收到一些错误时，没有收到呼叫，所以我认为问题可能是自我跟踪实体由于某种原因没有到达服务。

我的服务的 app.config 如下：

```
<endpoint address=""
                  binding="netTcpBinding"
                  bindingConfiguration="tcpBinding"
                  name="NetTcpBindingEndpoint"
                  contract="GTS.CMMS.Service.IService">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>

        <endpoint contract="IMetadataExchange" binding="mexTcpBinding" address="net.tcp://localhost:5000/mex" />
      </service>
    </services>

    <behaviors>
      <serviceBehaviors>
        <behavior name="behaviorConfig">
          <!--
          <serviceMetadata httpGetEnabled="true" />-->
          <!--Necesario para poder enviar excepciones desde el servicio al cliente.-->
          <serviceDebug includeExceptionDetailInFaults="true"/>
          <serviceThrottling maxConcurrentCalls="100" maxConcurrentSessions="100" />
          <serviceMetadata/>
        </behavior>
      </serviceBehaviors>
    </behaviors>

    <bindings>
      <netTcpBinding>
        <binding name="tcpBinding" maxBufferSize="67108864"
                      maxReceivedMessageSize="67108864" maxBufferPoolSize="67108864"
                       transferMode="Buffered" closeTimeout="00:00:10"
                       openTimeout="00:00:10" receiveTimeout="00:20:00"
                       sendTimeout="00:01:00" maxConnections="100">
          <security mode="None"/>
          <readerQuotas maxArrayLength="67108864" maxBytesPerRead="67108864" maxStringContentLength="67108864"/>
          <reliableSession enabled="true" inactivityTimeout="00:20:00" />
        </binding>
      </netTcpBinding>
    </bindings>
  </system.serviceModel> 
```

客户端配置是：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.serviceModel>
    <bindings>
      <netTcpBinding>
        <binding name="NetTcpBinding_IService" closeTimeout="00:01:00"
          openTimeout="00:01:00" receiveTimeout="00:01:00" sendTimeout="00:01:00"
          transactionFlow="false" transferMode="Buffered" transactionProtocol="OleTransactions"
          hostNameComparisonMode="StrongWildcard" listenBacklog="10" maxBufferPoolSize="524288"
          maxBufferSize="65536" maxConnections="10" maxReceivedMessageSize="65536">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <reliableSession ordered="true" inactivityTimeout="00:20:00"
            enabled="true" />
          <security mode="None">
            <transport clientCredentialType="Windows" protectionLevel="EncryptAndSign" />
            <message clientCredentialType="Windows" />
          </security>
        </binding>
      </netTcpBinding>
    </bindings>
    <client>
      <endpoint address="net.tcp://192.168.1.5:7997/CMMSHost" binding="netTcpBinding"
        bindingConfiguration="NetTcpBinding_IService" contract="IService"
        name="NetTcpBinding_IService" />
    </client>
  </system.serviceModel>
</configuration> 
```

我使用大的 readquotes，试图丢弃问题是文件的大小，但问题仍然存在。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T15:07:21.843

我不认为这是与 WCF 相关的问题。我认为它与您的 IIS 相当相关。您可以在 web.config 中尝试以下代码片段吗？

```
<system.webServer>
        <security>
            <requestFiltering>
                <requestLimits maxAllowedContentLength="524288000"/>
            </requestFiltering>
        </security>
</system.webServer> 
```

# java - 将一种日期格式更改为另一种

> ID：11209935
> 
> 赞同：2
> 
> 时间：2012-06-26T14:46:59.163
> 
> 标签：java, date, format, datetime-format

我得到以下格式的日期（`Date`而不是`String`）：

```
Tue Jun 26 07:00:00 EDT 2012 
```

我想将日期的格式更改为（日期）：

```
6/26/2012 10:19:15 AM 
```

以便在数据库中更新相同的内容。我尝试了以下代码：

```
Date dte;
Date dte1;(Tue Jun 26 07:00:00 EDT 2012)
SimpleDateFormat formatter = new SimpleDateFormat("m/dd/yyyy hh:mm:ss a");
String formattedDate = formatter.format(dte1);
dte  = formatter.parse(formattedDate);
SystemUtils.trace("test", " date>>>" + dte); 
```

正在产生以下响应：

```
Thu Jan 26 07:00:00 EST 2012 
```

任何人都可以分享一段代码来尽快做同样的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T14:58:49.710

您不必格式化日期以将它们插入数据库。如果使用 JDBC，请使用准备好的语句。

但是，要回答您的问题，`m`不能同时表示*分钟*和*月份*。`M`指月份。`m`表示*分钟*。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T15:04:25.457

此代码输出所需的结果：

```
Date dte = new Date();//or something else
SimpleDateFormat formatter = new SimpleDateFormat("MM/dd/yyyy hh:mm:ss a");
String formattedDate = formatter.format(dte);
System.out.println(formattedDate); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T18:51:53.297

试试这个，下面的代码将满足您的需要。

```
public class DateWala {

    public static void main(String[] args){

    System.out.println(new SimpleDateFormat("MM/dd/yyyy hh:mm:ss a").format(new Date()));

   }

 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-16T10:31:55.360

你可以使用这个小功能

```
// send your time
private String convertTime(String dateTime) {
//source format will go there
SimpleDateFormat sdfSource = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS");
    Date date = null;
    try {
        date = sdfSource.parse(dateTime);
    } catch (ParseException e) {
        e.printStackTrace();
    }
    //destination format will go there
    SimpleDateFormat sdfDestination = new SimpleDateFormat("dd-MM-yyyy HH:mm");

    return sdfDestination.format(date);
} 
```

# sql - 即使我不希望它发生，也会发生列更新

> ID：11209957
> 
> 赞同：0
> 
> 时间：2012-06-26T14:47:34.263
> 
> 标签：sql, sql-server-2005

我有一个案例陈述：

```
UPDATE
   Answer
SET
   AnswerID = @AnswerID,
   AnsweredBy = CASE WHEN LEN(@AnsweredBy) > 0 THEN @AnsweredBy END 
```

即使什么时候`@AnsweredBy`它`NULL`仍然将`AnsweredBy`列设置为空。

我也尝试通过这样做来测试 null ：

```
 UPDATE
    Answer
 SET
    AnswerID = @AnswerID,
    AnsweredBy = CASE WHEN @AnsweredBy IS NOT NULL THEN @AnsweredBy END 
```

意思是我不想更新`answeredby`列，除非有值。

即使在我的 C# 代码中，我也不会将值传递给我的存储过程：

```
if (answeredBy.Length > 0)
   cmdSelect.Parameters.Add("@AnsweredBy", SqlDbType.VarChar).Value = answeredBy; 
```

除非有值。在我的存储过程中，我将该列变量默认为空：

```
@RunoffAnswerID bigint,
@AnswerID varchar(3)=NULL,
@AnsweredBy varchar(50)=NULL, 
```

所以我的问题是如何执行其余的更新，因为还有大约 5-10 列，但只更新`answeredby`if 中是否有值`@AnsweredBy`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T14:49:32.370

```
SET AnsweredBy = ISNULL(@AnsweredBy, AnsweredBy) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:50:24.767

```
UPDATE 
    Answer 
SET 
    AnswerID = @AnswerID, 
    AnsweredBy = CASE WHEN LEN(@AnsweredBy) > 0 THEN @AnsweredBy ELSE AnsweredBy END 
```

# visual-studio-2010 - Excel 2010 使用 VB 转 PDF

> ID：11209960
> 
> 赞同：1
> 
> 时间：2012-06-26T14:47:42.580
> 
> 标签：visual-studio-2010, pdf, excel-2010

我有数百个 Excel 文件保存在一个文件夹中。我想知道如何在 Visual Basic 中编写一些东西来将它们转换为 PDF。有没有办法调用 Excel 2010 的另存为功能将它们保存在不同的文件夹中？我已经检查了谷歌和这里，我能找到的只是对第三方应用程序的引用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:50:18.857

```
 Dim excel As Microsoft.Office.Interop.Excel.Application
    excel = New Microsoft.Office.Interop.Excel.Application
    Dim tmpWorkbooks As Workbooks
    tmpWorkbooks = excel.Workbooks
Dim wb As Microsoft.Office.Interop.Excel.Workbook
    wb = tmpWorkbooks.Open(pathOfExcelFile)
    excel.Visible = False
  wb.Activate()
wb.ExportAsFixedFormat(XlFixedFormatType.xlTypePDF, fileName, , , , 1, 1, False, ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:54:00.750

在 Excel 2010 中，您可以使用此 VBA 代码：

```
ActiveSheet.ExportAsFixedFormat _
    Type:=xlTypePDF, _
    Filename:="C:\Temp\Workbook1.pdf", _
    Quality:=xlQualityStandard, _
    IncludeDocProperties:=True, _
    IgnorePrintAreas:=True, _
    OpenAfterPublish:=False 
```

当然，您需要`Filename`为您的机器设置正确的路径，并且当它使用时，`ActiveSheet`我想如果您的工作簿中有多个工作表，您需要遍历您的工作表。有关 ExportAsFixedFormat 函数的更多详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.exportasfixedformat.aspx)。

# jquery - onfocus 从 textarea 中删除文本

> ID：11209962
> 
> 赞同：1
> 
> 时间：2012-06-26T14:47:53.867
> 
> 标签：jquery, html, css

我已经在谷歌上寻找一种方法来删除焦点上的文本，但如果在该字段中没有输入任何内容，我无法弄清楚我们如何将其添加回来。

这是我目前所拥有的......

```
onfocus="if(this.value == 'Name*') { this.value = ''; }" value="Name*" 
```

这将删除“名称*”，但即使我没有在该字段中输入，它也会被完全删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:54:09.000

使用 onblur 事件，并带有类似的 if 语句，如果它不等于任何内容，那么 this.value 应该等于我的占位符文本。

```
onblur="if(this.value==''){this.value='Name*';}" 
```

[模糊](http://www.w3schools.com/jsref/event_onblur.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:50:15.117

这就是您要查找的内容：[http ://webdesignerwall.com/tutorials/cross-browser-html5-placeholder-text](http://webdesignerwall.com/tutorials/cross-browser-html5-placeholder-text)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:53:47.263

使用 jQuery

```
$("textarea").focus(function() {

    if( $(this).val() == "Name*" ) {
        $(this).val("");
    }

}); 
```

# objective-c - 如何在 NSDictionary 中添加字符串？

> ID：11209964
> 
> 赞同：4
> 
> 时间：2012-06-26T14:47:59.110
> 
> 标签：objective-c, ios

> **可能重复：**
> [如何添加到 NSDictionary](https://stackoverflow.com/questions/3159844/how-to-add-to-an-nsdictionary)

当我这样做时：

```
NSDictionary *dic = [NSDictionary dictionary];
[dic setValue:@"nvjd" forKey:@"name"]; 
```

我的应用程序崩溃了。我不明白为什么。我应该如何在字典中添加字符串？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-26T14:48:51.543

您需要使您的字典[mutable](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsmutabledictionary_Class/Reference/Reference.html)，否则它不会响应`setValue:forKey:`选择器：

```
NSMutableDictionary *dic = [NSMutableDictionary dictionary]; 
```

这是 cocoa 中的常见模式：您经常看到成对声明的类：`NSArray`/ `NSMutableArray`、`NSSet`/ `NSMutableSet`、`NSString`/`NSMutableString`等等。可变版本能够做不可变版本可以做的所有事情，但它也支持更改其内容的操作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-26T14:49:40.893

```
NSMutableDictionary *dic = [NSMutableDictionary dictionary];
[dic setValue:@"nvjd" forKey:@"name"]; 
```

或者

```
NSDictionary *dic = [NSDictionary dictionaryWithObjectsAndKeys:@"nvjd",@"name" nil]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T14:51:34.160

你有两个选择。`NSDictionary`您可以使用一个键/值对（或多个）初始化您的，或者创建一个`NSMutableDictionary`并稍后添加它。

```
// Immutable
NSDictionary *dic = [NSDictionary dictionaryWithObject:@"nvjd" forKey:@"name"];

// Mutable
NSMutableDictionary *dic = [NSMutableDictionary dictionary];
[dic setValue:@"nvjd" forKey:@"name"]; 
```

# javascript - 在 Javascript 中，是否有以下名称：变量 = 变量 = 值；

> ID：11209966
> 
> 赞同：5
> 
> 时间：2012-06-26T14:48:02.377
> 
> 标签：javascript, coding-style

有这个名字吗？这是我想说的一个例子：

```
var i = 0;
var j = 0;
i = j = 1; 
```

很明显两者`i`和`j`都设置为 1。但是这种做法有名称吗？另外，就良好的编码标准而言，通常会避免这种事情吗？我还可以获得一个示例或解释为什么它是/不是好的做法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T14:56:11.883

正如丹尼尔所说，它被称为链式分配。通常会避免这种情况，因为对于某些值（例如对象），该行`i = j = _something_`会创建一个引用 from `i`to `j`。如果你以后改变`j`，那么`i`也会改变。

```
var i = {};
var j = {};
i = j = {a:2};
j.a = 3; //Now, j.a === 3 AND i.a === 3 
```

有关示例，请参见此 jsFiddle 演示：http: [//jsfiddle.net/jackwanders/a2XJw/1/](http://jsfiddle.net/jackwanders/a2XJw/1/)

如果您不知道将要做什么`i`，`j`您可能会遇到问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:51:04.407

我相信它被称为“分配链”。

我们说赋值是“右结合”。这意味着

```
i = j = 1; 
```

相当于

```
i = (j = 1); 
```

`j = 1`将数字分配给`1`然后`j`返回 j 的值（现在是`1`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:57:05.813

有时它被称为“链式赋值”，有时被称为“多变量赋值”。此外，您可能想查看[此](https://stackoverflow.com/questions/6257131/multiple-variable-assignment)问题的答案。

# cakephp - Cakephp 如何验证我的 DOB 字段，以便年龄不会大于输入的居住期限

> ID：11209968
> 
> 赞同：1
> 
> 时间：2012-06-26T14:48:08.300
> 
> 标签：cakephp, cakephp-1.3, cakephp-2.0, cakephp-2.1

我的表单中有两个字段应该相互对应。如果用户在 DOB 字段中输入出生日期，则不得允许他/她输入大于 DOB 的居住时间

我在 add.ctp 中的两个字段如下

```
echo $this->Form->input('DOB',array('label' => 'Date of birth*', 'minYear' => 1900,    'maxYear' => 2000));

echo $this->Form->input('period_of_residence', array('label' =>'Period of residence in   Zimbabwe')); 
```

所以现在我不知道我如何验证这两者，以便用户无法输入大于年龄的居住期。即使它在提交时验证，我也喜欢它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T16:39:56.970

您可以在模型中创建自己的自定义验证函数，如下所示：

```
class MyModel extends AppModel {

    public $validate = array(
        'DOB' => array(
            'rule' => 'checkDOB',
            'message' => 'DOB cannot be greater than period of residence.'
        )
    );

    public function checkDOB($check) {
        return strtotime($check['DOB']) < strtotime($this->data['MyModel']['period_of_residence']);
    }
} 
```

# .net - 游戏在退出后持有 wma 文件的句柄

> ID：11209973
> 
> 赞同：2
> 
> 时间：2012-06-26T14:48:35.747
> 
> 标签：.net, xna, filehandle

我有一个在 dll 文件中导出的 xna 游戏。运行游戏的所有东西（除了内容）都在这个库中，尤其是主游戏类。

在另一个程序集中，我加载游戏 dll，实例化游戏类并调用`Run()`它。这将运行游戏。之后，当游戏关闭时，我调用`Dispose()`以完全关闭游戏。主程序（加载 dll 的那个）仍在运行。

到这里为止，没有问题。

但是，当游戏使用 a`Song`和 时`MediaPlayer`，似乎游戏并没有完全关闭。在游戏的内容目录中，有歌曲的相应文件`.xnb`和`.wma`文件。虽然游戏不再运行，但我无法删除该`.wma`文件，因为一个进程（我的主程序）仍然持有该文件的句柄。该`.xnb`文件可以毫无问题地删除。

我发现游戏创建了一个额外的线程，游戏退出后没有关闭。我怀疑这个线程是仍然持有文件句柄的媒体播放器线程。有什么办法可以强制 xna 放弃文件句柄？也许杀死额外的线程是一种选择（虽然它不是很好），但如何做到这一点？

调用不会改变这种行为`Stop()`。`MediaPlayer`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T03:59:48.680

通常，创建 XNA 游戏时的一般做法是根本不使用 MediaPlayer，而是使用 Sound & SoundInstance 替代方案。虽然它们可能使用不同的声音格式，但它们的性能更好，因为 MediaPlayer 是一个巨大的猪，在你的情况下，线程问题。

我可能错了，但我认为 MediaPlayer 实际上将本地机器称为实际的 MediaPlayer。这可能是为什么很难阻止它的线程的原因之一。

这取决于你，但我会完全避免使用 MediaPlayer。这对我来说是一个诅咒：D

# matlab - MATLAB散点图中的线性回归线

> ID：11209974
> 
> 赞同：6
> 
> 时间：2012-06-26T14:48:36.590
> 
> 标签：matlab, regression, least-squares

我正在尝试获取两个变量散点图的残差。`lsline`我可以使用matlab的函数得到最小二乘线性回归线。但是，我也想获得残差。我怎样才能在matlab中得到这个。为此，我需要知道线性回归线的参数`a`和`b`

```
ax+b 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-26T14:51:11.040

使用该函数[`polyfit`](http://www.mathworks.co.uk/help/techdoc/ref/polyfit.html)获取回归参数。然后，您可以评估拟合值并相应地计算残差。

基本上对指定的度数*N*`polyfit`执行[最小二乘回归](http://en.wikipedia.org/wiki/Least_squares)，在您的情况下，对于直线回归，该度数为 1。回归参数由函数返回，您可以使用其他函数从回归参数中获取拟合值*[`polyval`](http://www.mathworks.com/help/matlab/ref/polyval.html)*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:54:02.493

如果您有[曲线拟合工具箱](http://www.mathworks.com/products/curvefitting/)，请输入 cftool 并按 Enter 键，GUI 将出现。

您可以使用此工具查找给定数据集的线性多项式拟合以及许多其他拟合。*

# wcf - 将 HTML5 UI 添加到现有 WCF/WIF/MVVM 代码库

> ID：11209980
> 
> 赞同：0
> 
> 时间：2012-06-26T14:48:44.843
> 
> 标签：wcf, html, mvvm, wif

我们开发了一个 SOA 产品，它使用 WCF 和 WIF 以及自定义安全令牌服务，为使用 MVVM 和 WPF 编写的客户端提供服务，甚至还集成了一个 Sharepoint 集成 Silverlight 解决方案。

我们的一位客户现在提出了一个要求，要求他们制作 HTML5 Web 前端，以便他们可以通过 iPad 托管的 Web 应用程序访问这些资源。

这显然是我们的新领域，并提出了几个我们正在努力通过网络回答的问题。

1.  HTML5 的 Websocket 支持多少 WCF/WIF？例如`IssuedTokenWSTrustBinding`& `WS2007FederationHttpBinding`。

2.  我们是否需要重写大量的 MVVM 代码，或者可以将 HTML5 绑定到 C# `ViewModel`？

任何对这些问题的见解将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T15:02:25.687

1.  Websockets 只是...... Websockets 除了数据传输之外，它们并没有做任何花哨的事情。所以它不会像 IssuedTokenWSTrustBinding 或 WS2007FederationHttpBinding 那样处理任何事情。

2.  通常，移动应用程序应该不同于完整的桌面浏览器应用程序，必须考虑一些事情，例如：导航、图像大小、流量中使用的数据量。每件事都必须保持在尽可能低的速度。如果您不介意忽略以上所有内容，那么答案是肯定的，您可以将所需的 HTML5 功能添加到您的 Views/ViewMODels 中。

# python - 我可以在使用配置文件、Python 或任何编程语言时创建单个 exe 吗？

> ID：11209981
> 
> 赞同：0
> 
> 时间：2012-06-26T14:48:45.273
> 
> 标签：python, exe

我有一个项目要做。主要的基本要求之一是提供给客户以作为单个 exe 运行。哪种编程语言无关紧要，但是它将比较一组默认文件和客户文件之间的文件。有什么办法可以让我有一个exe吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:53:29.083

py2exe 库允许您从 python 代码创建 exe 文件。我没有使用它，但它可能会完成这项工作！

[http://www.py2exe.org/](http://www.py2exe.org/)

或者，您可以尝试[pyinstaller](http://www.pyinstaller.org/)。

另请参阅：[py2exe - 生成单个可执行文件](https://stackoverflow.com/questions/112698/py2exe-generate-single-executable-file)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:52:57.067

你很幸运！您可以使用 Python 使用 py2exe 转换实用程序来做到这一点。

您可以在以下位置找到它：http: [//www.py2exe.org/](http://www.py2exe.org/)

# jquery - 使用 jQuery 从 html 复选框中删除和添加禁用属性

> ID：11209993
> 
> 赞同：5
> 
> 时间：2012-06-26T14:49:08.400
> 
> 标签：jquery, html

我正在学习 jQuery，并且在从 html 复选框中添加和删除 disabled 属性时有点麻烦。我想要它，这样当您选中该框时，您不能在文本区域中写入地址，否则您必须从搜索框中进行选择。我已经完成了后者，但是复选框给我带来了麻烦。这是我的函数调用。它很好地进入了函数，但在检查时没有删除禁用的属性，并抛出一个错误，它不能使用 addAttr 方法将禁用的属性添加回来。

```
//attach an event for clicking on the informal contact button
jQuery(document).ready(
    function () {
        jQuery('.InformalContact').live('click',
        function (event) {
            TestIfInformalContactIsChecked(event);
        });
    }
);

//check the status of the informalcontact checkbox when a user activates it
//If checked, user can input data in the contactinfo manually.
function TestIfInformalContactIsChecked(event) {
    var thisCheck = jQuery(event.target);
    if (thisCheck.is(':checked')) {
        jQuery("#ContactInfo").removeAttr('disabled');
    }
    else {
        jQuery("#ContactInfo").addAttr('disabled');     
    }
} 
```

这是html...

```
<div class="TBItemColumn1">
    Name: <input id="Name" value="" class="TBFindContact" style="width: 150px;" maxlength="50" type="text" /><br />
    <input id="InformalContact" class="InformalContact" maxlength="50" type="checkbox" ClientIDMode="Static"  />Informal Contact<br />
    <div id="TBContactSearchBox"></div>
    Notes:
    <br />
    <textarea id="Notes" style="width: 280px; height: 20px;"></textarea>
  </div>
  <div class="TBItemColumn2">
    <div class="FloatLeft">
      Contact Info:
      <br />
      <textarea id="ContactInfo" value="" style="width: 280px; height: 70px;" disabled="disabled"></textarea>
    </div>
  </div> 
```

我在复选框上设置 disabled 属性有什么问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-26T14:52:16.623

要启用此功能

```
jQuery("#ContactInfo").prop('disabled', true); 
```

这要禁用

```
jQuery("#ContactInfo").prop('disabled', false); 
```

如果您将本机属性删除为`disabled`using `removeAttr`(or `removeProp`)，您将无法再次添加它。它不应该用于更改属性值。

# python - 为什么在 for 循环中第一次返回正确的计数值？

> ID：11209994
> 
> 赞同：1
> 
> 时间：2012-06-26T14:49:08.897
> 
> 标签：python, parsing, loops

在下面的 for 循环中，我试图理解为什么`count`仅在循环第一次运行时才返回正确的值。

我正在创建一个解析程序来查找文本文件中的某些字符串并计算它们。但是，我在一个地方遇到了一些麻烦。

```
def callbrowse():
    filename = tkFileDialog.askopenfilename(filetypes = (("Text files", "*.txt"),("HTML files", ".html;*.htm"),("All files", "*.*")))
    print filename
    try:
        global filex
        global writefile
        filex = open(filename, 'r')
        print "Success!!"
        print filename
    except:
        print "Failed to open file"

######This returns the correct count only the first time it is run.  The next time it  ######returns 0\.  If the browse button is clicked again, then this function returns the ######correct count again.
def count_errors(error_name):
    count = 0
    for line in filex:
        if error_name == "CPU > 79%":
            stringparse = "Utilization is above"
        elif error_name == "Stuck touchscreen":
            stringparse = "Stuck touchscreen"
        if re.match("(.*)" + "Utilization is above" + "(.*)",line):
            count = count + 1
    return count 
```

谢谢你的帮助。我似乎无法让它正常工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T15:11:54.237

该方法仅在第一次有效，因为文件是通过末尾传递的。如果再次调用该方法，则不再有行。您可以通过在 for 循环之前调用 filex.seek(0) 来重置文件位置。

# java - JSR-223 Scala 脚本引擎

> ID：11209995
> 
> 赞同：7
> 
> 时间：2012-06-26T14:49:12.167
> 
> 标签：java, scala

我正在尝试使用 Scala 作为脚本语言，它将从 java 调用，之后我需要获取一些对象作为脚本执行的结果。

我试图找到一个可以做我需要但不成功的好的翻译。Scala 是否存在 JSR-223 的实现？或者可能有人知道如何解决我的问题。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-02T14:36:36.287

scala 的官方支持从 2.11 版开始，如此封闭票所示：[https ://issues.scala-lang.org/browse/SI-874](https://issues.scala-lang.org/browse/SI-874)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T00:27:40.950

这个库：[http](http://code.google.com/p/scalascriptengine/) ://code.google.com/p/scalascriptengine/ 可能有助于解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-22T08:45:58.390

为了能够运行（[如何使用 scala 作为脚本语言设置 jsr223 脚本](https://stackoverflow.com/questions/5654888/how-do-i-set-up-jsr223-scripting-with-scala-as-scripting-language)）中提到的 Codesnippet，我需要进行以下更改。我使用了 Scala 2.11.0-M4

```
public static void main(String args[]){
  ScriptEngine engine = new ScriptEngineManager().getEngineByName("scala");

  // Set up Scriptenvironment to use the Java classpath
  List nil = Nil$.MODULE$;
  $colon$colon vals = $colon$colon$.MODULE$.apply((String) "true", nil);
  ((IMain)engine).settings().usejavacp().tryToSet(vals);ScriptContext.ENGINE_SCOPE);

  engine.getContext().setAttribute("labelO", new Integer(4), ScriptContext.ENGINE_SCOPE);
  try {
    engine.eval("val label = labelO.asInstanceOf[Integer]\n"+
                "println(\"ergebnis: \" + (2 + label ))");
  } catch (ScriptException ex) {
    ex.printStackTrace();
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-23T21:41:19.333

这是一个可靠的[ScriptingEngine 实现](https://github.com/apache/clerezza/tree/master/scala-scripting)