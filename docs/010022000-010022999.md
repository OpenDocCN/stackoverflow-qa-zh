# StackOverflow 问答 10022000-10022999

# python - 模块内的类

> ID：10022002
> 
> 赞同：1
> 
> 时间：2012-04-05T02:43:05.257
> 
> 标签：python

可以说我有代码：

```
class NoneDict(dict):
    def __getitem__(self, name):
        try:
                return super(NoneDict, self).__getitem__(name)
        except:
                return None 
```

我希望人们能够在不写出所有这些代码的情况下创建一个 NoneDict 对象。我尝试将它包含在一个模块中，然后输入：

```
import nonedict
foo = NoneDict() 
```

但它没有用。我怎样才能做到这一点，以便有人可以导入模块，然后能够在不输入所有代码的情况下创建一个非字典？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:46:34.867

```
import nonedict
foo = nonedict.NoneDict() 
```

或者

```
from nonedict import NoneDict
foo = NoneDict() 
```

或（感谢@Joel Cornett）

```
from nonedict import NoneDict as nd
foo = nd() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T02:44:50.523

[`foo = nonedict.NoneDict()`](http://docs.python.org/tutorial/modules.html)

# c++ - 如何在 C 中将 u_char* 转换为 char[]

> ID：10022003
> 
> 赞同：2
> 
> 时间：2012-04-05T02:43:10.897
> 
> 标签：c++, c, arrays, char, memcpy

我正在使用 snmp，requests->requestvb->val.string 函数返回一个 u_char*，我试图将它存储到一个 char[255] 中。

```
u_char newValue = *(requests->requestvb->val.string)
char myArray[255]; 
```

我尝试了几种方法将 newValue 的内容复制到 myArray 中，但一切似乎都是段错误。我究竟做错了什么？

我努力了 `memcpy(myArray, newValue);`

又一次尝试`strncopy(myArray, newValue, sizeof(myArray));`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:48:25.267

你`newValue`的属于 type `char`，出于所有意图和目的，你`myArray`的属于 type `char*`。

首先，我将假设您使用`memcpy`正确，并且您传入 3 个参数而不是 2 个参数，其中第 3 个参数与您在`strncpy`.

当您尝试使用`strncpy`or时`memcpy`，当您尝试`newValue`将所有内容复制到`myArray`.

修复应该很简单：

```
u_char* newValue = requests->requestvb->val.string; 
```

一旦你这样做了，这应该工作。当然，这是假设的大小`myArray`实际上大于或等于 255 :)

`myArray`作为旁注（这应该不言而喻），如果您打算打印它，请确保最后有一个空终止字符。执行复制操作后没有一个，然后尝试打印是一个非常常见的错误，也可能导致段错误。

# php - 提交信息到url，也可以打开PDF

> ID：10022009
> 
> 赞同：1
> 
> 时间：2012-04-05T02:43:56.367
> 
> 标签：php, javascript, html, wordpress, mailchimp

**编辑：[这个私人发布的页面](http://www.careerchoiceswithlaura.com/home-new)是我需要使用的。*密码：stackOF***

我的客户希望让她的 Wordpress 博客在她的主页上显示一个 MailChimp 表单，作为 .pdf 的网关。当用户单击“提交”时，我需要发生以下行为：

1.  执行包含的 MailChimp 的 javascript 文件；这可以确保正确填写表格，然后执行新闻通讯列表的注册（这部分不需要帮助）
2.  然后向用户显示信息 PDF 以供下载或查看 **编辑：逻辑顺序从我最初发布此内容时开始翻转。脚本应该执行，并且只有当脚本正确执行时，PDF 才会显示给用户**

笔记：

*   我在 HTML 和 PHP 方面的经验水平是 3/4，而对于 JS，我是 2/4**编辑：（此时似乎更像是 1/4，哈哈）**。如果我的研究是正确的，PHP（服务器端语言）将用于做客户想要的事情。
*   **在这种情况下，除了 MailChimp 的脚本提供的（它确保用户已经提交了完整的表单）之外，不需要额外的验证**（客户说如果电子邮件根本无效也可以）。
*   .pdf URL 和内容是静态的，只需要显示，而不是生成。

----RESEARCH---- 我知道Mailchimp表单使用以下行来实际提交信息，但我想做下面提到的动作，*以及*打开前面提到的.pdf：

```
<form action="http://*BLAH*.us2.list-manage.com/subscribe/post?u=*BLAHBLAH*&amp;id=*BLAHBLAHBLAH*" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank"> 
```

我在其他网站上阅读，我可以想象将“动作”指向一个 .php 文件，但如果有办法用 javascript 做到这一点 - 因为它使用我已经为此创建的 .js 文件，那么我会最开心。除此之外，我会拿走我能得到的..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T08:10:13.037

您可以尝试以下方法：

`onsubmit`在 mailchimp 表单上添加一个处理程序，如下所示：

```
<form onsubmit="runMyStuff(this)" action="http://*BLAH*.us2.list-manage.com/subscribe/post?u=*BLAHBLAH*&amp;id=*BLAHBLAHBLAH*" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank"> 
```

你的javascript函数：

```
function runMyStuff( o ) {
    // open the pdf file in a separate window
    window.open( PATH_TO_YOUR_PDF_URL );

   // now, submit the form
   o.submit();
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:57:34.777

您可能会创建一个页面，其中包含您的脚本并有一个指向 PDF 的 URL 的 iframe。

# licensing - 使用 Nuget 查找第三方许可证

> ID：10022013
> 
> 赞同：12
> 
> 时间：2012-04-05T02:44:27.320
> 
> 标签：licensing, nuget

我是一个 NuGet 新手，来自 Maven 世界。

最近我的任务是更新我们项目的第三方许可信息。使用 Maven 项目，我已经能够使用该`license:download-licenses`插件来获取许可证信息。

我想知道是否有办法使用 Nuget 获取这些信息？最好使用命令行界面，这样我就可以在 CI 构建级别自动化它。从大型手动预构建步骤中删除它。

**编辑：**

由于我找不到任何实用程序来执行此操作，因此我将[LegSec 命令行实用程序](http://legsec.codeplex.com/)放在一起。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-07T15:06:54.637

据我所知，目前没有任何东西可以直接从命令行获取许可证信息作为 CI 构建的一部分。您需要创建一个应用程序来打开 .nupkg zip 文件，从 .nuspec 文件中提取许可证 url 并从该 url 下载许可证。

或者，您可以使用 Visual Studio 中的包管理器控制台窗口，并使用一些 PowerShell 下载许可证文件。

下面显示了一个获取项目中所有包的许可证文件的简单示例。这需要扩展以获取解决方案中的所有项目，您应该能够使用 Get-Project cmdlet 完成这些项目。这仍然需要有人运行脚本来下载许可证。

```
$wc = New-Object System.Net.WebClient
Get-Package -ProjectName YourProject | ForEach-Object {
    $wc.DownloadFile($_.LicenseUrl, 'd:\licenses\' + $_.Id + ".html")
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-30T16:02:15.200

我设法使用以下命令获取许可证信息：

```
@(@(Get-Project -All | ForEach-Object {
    Get-Package -ProjectName $.ProjectName
}) | Select Id -Unique ) | ForEach-Object {
    $pkg = $_
    $pkgId = $_.Id
    if ($pkgId -notlike 'microsoft*') {
        $url = Open-PackagePage $pkgId -License -WhatIf -PassThru
        Write-Host "$pkgId $url"
    }
} 
```

# assembly - 加载常驻程序并执行它们

> ID：10022017
> 
> 赞同：0
> 
> 时间：2012-04-05T02:45:33.073
> 
> 标签：assembly, x86, nasm

我的 porpouse 是构建汇编代码以将 2 个其他程序加载到 RAM 内存，然后在我选择时从父程序执行它们。我刚刚开始学习汇编语言，顺便说一下，我正在使用 NASM 16 位。我一直在广泛阅读这方面的内容，我发现这个主题非常难以理解。

这是我一直用于文档的链接：[http ://maven.smith.edu/~thiebaut/ArtOfAssembly/artofasm.html](http://maven.smith.edu/~thiebaut/ArtOfAssembly/artofasm.html)

有人可以帮我这样做吗？

我很乐意提供任何需要的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:39:58.267

听起来您要求做的基本上是将程序链接到内存中，然后再执行它。

链接是将磁盘上文件中的程序代码转换为内存中可以执行的内容所必需的工作。在现代操作系统中，这不是一项小任务。

普遍的共识是您应该使用操作系统来执行此操作。首先，了解如何在程序集中调用 windows 系统调用（假设您还没有）。然后查看这些函数：

*   [创建过程](http://msdn.microsoft.com/en-us/library/ms682425%28VS.85%29.aspx)
*   [LoadLibraryEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684179%28v=vs.85%29.aspx)

看看他们是否能做你需要的。

# python - 如何调试python中的缩进错误

> ID：10022018
> 
> 赞同：16
> 
> 时间：2012-04-05T02:45:38.120
> 
> 标签：python, debugging, indentation

我正在尝试编写我的第一个 python 脚本。这是可行的，但经过一些轻微的重构，我显然打破了缩进。我无法确定是什么问题。解释器抱怨以下方法。有人可以指出吗？

```
def dataReceived(self, data):
    a = data.split(':')
    print a
    if len(a) > 1:
        command = a[0]
        content = a[1]

        msg = ""
        if command == "iam":
            self.name = content
            msg = self.name + " has joined"

        elif command == "msg":
            msg = self.name + ": " + content
            print msg 
```

> 错误显示：文件“python_server.py”，第 17 行 a = data.split(':') ^ IndentationError: expected an indented block

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-07-22T17:08:05.263

我在使用 Sublime Text 2 时遇到了类似的问题。

要解决此问题，请单击编辑器底部的“Tab Size”，然后选择“Convert Indentation to Tabs”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-05T02:48:01.310

您开始使用允许显示缩进的文本编辑器，并且在使用空格而不是制表符方面变得一致，并在编辑器中强制执行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T02:49:31.077

您可以在这里做很多事情：

1.  使用可以显示控制字符的编辑器（例如`vi`with `set list`）。
2.  使用十六进制转储程序，例如`od -xcb`.
3.  只需删除该行开头的空白并重新插入（可能还需要检查前一行）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-13T17:37:19.800

如果您使用的是“Sublime Text 2”编辑器，那么我发现这个答案很有帮助 - 它详细说明了如何打开空格字符并将制表符转换为空格

[sublime-text-2-view-whitespace-characters](https://stackoverflow.com/questions/10153998/sublime-text-2-view-whitespace-characters)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-05T14:02:49.060

试试 Editra - www.editra.org

您的代码看起来不错，语法看起来不错......您的文本编辑器可能会创建您的错误。使用 Editra 查看您的文件以查看/查看缩进级别。

Editra 挽救了我的理智——我认为在文本编辑器中查看我的脚本时语法正确，包括带有 python 缩进插件的 Notepad++。但是，当我运行脚本时，它每次都会抛出缩进错误。我终于在 Editra 中打开了脚本，我可以看到问题所在。Notepad++ 和其他文本编辑器没有显示正确的缩进/制表符/空格。Editra 显示错误，例如意外空格、制表符 - 我能够更正。

Editra 将自动缩进您的脚本 [并显示错误 - 选项卡、空格 - 可能不会出现在其他文本编辑器中]。

> 如果您有缩进错误，它将显示为蓝色下划线段；
> 
> > 如果您正在编写脚本 [添加/删除行] Editra 将自动缩进脚本。

**我建议打开您的脚本并在 Editra 中进行编辑。

希望这可以帮助！祝你好运。str8箭头

# php - Smack 库和 PHP

> ID：10022019
> 
> 赞同：1
> 
> 时间：2012-04-05T02:45:46.297
> 
> 标签：php, smack

我阅读了一些使用 Smack 库连接到 GTalk 的示例。但所有示例都使用 Java。Smack 库可以与 PHP 一起使用吗？

感谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T02:59:10.990

您可以使用 Java 桥接器来实现这一点。

```
http://php-java-bridge.sourceforge.net/pjb/ 
```

Zend Server 还有另一个桥接器：

```
http://www.zend.com/en/products/server-ce/ 
```

PS。Bridge 是一种协议，而不是扩展。它从 Apache、IIS （如 SOAP、RPC）连接到 Java 服务。

# c++ - 当一个线程遇到异常时是否可以冻结所有线程

> ID：10022020
> 
> 赞同：1
> 
> 时间：2012-04-05T02:46:01.337
> 
> 标签：c++, windows, multithreading

我能够打印在运行时捕获异常的线程的堆栈跟踪。我还需要打印在同一进程中运行的其他线程的跟踪。我有兴趣找到一种在一个线程中捕获异常后立即冻结所有线程的好方法。

现在，我所能做的就是查询每个活动线程，然后对其进行 SuspendThread() 查询。但是，这将导致每个线程在捕获初始异常后执行的时间更长。有没有办法立即让每个线程挂起？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T03:52:36.203

您是否尝试从被捕获异常的工作线程中使用 PostMessage() 到 GUI 线程？

建议的简要步骤：
1）GUI 线程产生少量工作线程
2）工作线程 PostMessage() 一旦捕获异常
3）GUI 线程接收消息
4）GUI 线程指示剩余工作线程暂停

注意：定义你自己的消息

通过这种方式，您仍然会在暂停工作线程之前看到一些延迟。

另一种方法是在工作线程之间使用像事件句柄这样的同步对象。

# git - 为 2 次连续合并提交推送评论的最佳方式是什么？

> ID：10022021
> 
> 赞同：0
> 
> 时间：2012-04-05T02:46:08.203
> 
> 标签：git

我有一个名为“branchT”的本地主题分支，它与名为“branchM”的远程主分支进行了 2 次连续合并，我怎样才能将合并提交推送到 gerrit 以供审查，其中包含我的“branchT”中的所有内容，包括 2 个合并结果.

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T07:24:22.637

你真的不应该使用 gerrit 合并。在我看来，`git reabse`是gerrit的朋友。

相信我，合并会让你的 gerrit 完全一团糟。

你可以更详细地描述你的问题，现在我不能给你更多好的建议。

兄弟，蒂姆

# objective-c - 局部变量设置为零？（目标-C）

> ID：10022025
> 
> 赞同：21
> 
> 时间：2012-04-05T02:47:30.333
> 
> 标签：objective-c, instance-variables, null, static-variables

我正在阅读一本关于 Objective-C 的书，作者说如果没有为局部变量赋值，它们将被设置为 nil，但静态变量将被设置为零。所以，我设置`int a`并没有给它赋值。然后`NSLog(@"%i", a)`显示它并`a`显示为零。我对此有点困惑，我想知道是否有人可以为我澄清一下？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-04-05T03:26:43.163

启用 ARC 后，无论您在何处创建它们，您的 Objective-C 对象指针变量都将设置为 nil。

如果没有 ARC，对于内置的 C 类型，您的变量将不会被初始化。

当你分配一个对象时，Objective-C 对象的实例变量总是设置为 0（或 nil）。

静力学设置为 0。

不过，我已经养成了总是给变量一个默认值的习惯。这是一个好习惯。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-05T02:56:17.943

没有²。就像在“普通”C 中一样，局部变量*没有*分配默认值。（虽然你可能会在第一次使用堆栈的一部分时很幸运：*不要*依赖这个！。）

无论如何，`nil` *是*0 ¹ - 也就是说，`nil == 0`始终为真 - 所以`NSLog("@%i", nil)`说“嘿，将参数记录为整数”，即 ... 0。

快乐编码。

* * *

¹看到[gdb中的nil没有定义为0x0？](https://stackoverflow.com/questions/4130325/nil-in-gdb-is-not-defined-as-0x0)其中更详细地涵盖了技术定义，包括 Objective-C++ 案例。请注意，类型也会根据架构发生变化，因此对于特定系统`"@%i"`很可能是*错误的。*

²请参阅 wbyoung 对*ARC 特定*规则的回答。

# mysql - MYSQL将所有用户对单个用户购买的物品的总赞成票和反对票相加

> ID：10022027
> 
> 赞同：4
> 
> 时间：2012-04-05T02:47:54.220
> 
> 标签：mysql, select, group-by

我想仅对单个用户购买的商品进行总的赞成票和反对票。我有一张大桌子，所以我不想总结每个人对每个项目的所有投票，只是特定用户购买的项目。

到目前为止，这是我的查询：

```
select SUM(purchaseyesno) AS tots, SUM(rating=1) AS yes, SUM(rating=0) AS no, item_id
from items_purchased
where purchaser_account_id=12373 
group by item_id 
```

正如您所料，这些总和只是汇总用户 12373 的信息，因此它只是一个值。我不确定如何获取用户 12373 购买的所有 item_ids 购买。

我确定有某种子查询，我需要包含嵌套的东西，但我一无所知。

这是我希望我的数据看起来的样子，item_id=3,4,5 都是由 user=12373 购买的。而 item_id=1,2,6 被其他用户购买。

```
item_id    tots    yes    no
   3        7       4      2
   4        5       1      3
   5        1       0      1 
```

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T02:57:05.637

```
select item_id, SUM(purchaseyesno) tots, SUM(rating = 1) yes, SUM(rating = 0) no
from items_purchased
where item_id in (
    select item_id from items_purchased
    where purchaser_account_id = 12373
)
group by item_id 
```

# jquery - JQuery避免URL中的空值？

> ID：10022033
> 
> 赞同：-9
> 
> 时间：2012-04-05T02:48:34.210
> 
> 标签：jquery

我只是想知道是否有任何方法可以避免 jsp 中的 parameter=null ？

会不会有任何类似于[Java 的功能？:](http://www.cafeaulait.org/course/week2/43.html) Jquery 的运算符？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T02:52:33.320

条件运算符或三元运算符是您正在寻找的术语......并且为了澄清 jQuery 是一个构建在 Javascript 编程语言之上的库。条件运算符作为语言的一部分而不是框架存在。

你可以在这里阅读更多关于它们的信息。[https://developer.mozilla.org/en/JavaScript/Reference/Operators/Conditional_Operator](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Conditional_Operator)

# android - 关于android查询contentprovider

> ID：10022034
> 
> 赞同：0
> 
> 时间：2012-04-05T02:48:52.883
> 
> 标签：android

我想使用快速搜索框（qsb）。但我在这里遇到了一些问题，

```
 @Override
public Cursor query(Uri uri, String[] projection, String selection,
        String[] selectionArgs, String sortOrder) {
    // TODO Auto-generated method stub
    String s2 = strFileName + " like '"+selectionArgs[0]+"%'";
    Cursor  cursor = dbHelper.getReadableDatabase().query(strTableName, 
                           projection, s2, null, null, null, sortOrder);
    Log.i("QQQQQQQQQQ",String.valueOf(cursor.getCount()));
    return cursor;
} 
```

问题是我总是得到一个搜索结果（显示在搜索列表视图中）；但是，日志信息显示结果大于1。有人知道如何解决吗？

# c++ - C++ 模板复制构造函数深度复制

> ID：10022037
> 
> 赞同：2
> 
> 时间：2012-04-05T02:49:26.223
> 
> 标签：c++, arrays, templates, containers

为了方便起见，我正在编写一个通用的 Array 类和重载运算符。我已经让我的 Array<> 对象来保存其他 Array<> 对象，但是我在覆盖 * 运算符时遇到了麻烦。我需要复制左边的对象，所以我的 operator* 代码是这样的：

```
Array<T>& operator*(const double scalar) {
    return Array<T>(*this) *= scalar;
} 
```

（operator*= 已经超载并且可以工作）。

我覆盖了复制构造函数，如下所示：

更新：新的复制构造函数：

```
Array<T> (const Array<T>& copyfrom) {
    size_=copyfrom.size();
    data=new T[size_];
    copy(&copyfrom.data[0], &copyfrom.data[size_], data);
} 
```

我的想法是，如果数组不是通用的，但总是用原语填充，那么这段代码就可以工作。但我认为这里发生了一些事情，因为我使用的模板会导致我不期望的行为。新“深度复制”数组中的数据数组就像它只是“copyfrom”数据数组的浅指针副本一样。

如何使用模板使这个复制构造函数同时适用于基元和对象？或者，更好的是，有没有办法重载 operator* 而不必担心复制构造函数？谢谢。

编辑：这是`operator*=`. 但是，我仍然认为我的问题在于我使用了复制构造函数。

```
Array<T>& operator*=(const double scalar) {
    for (int i=0; i<size_; i++)
        data[i]*=scalar;
    return *this;
} 
```

编辑：我意识到我遇到了问题，因为我忽略了`size`我的数组数组中的内部数组。现在事情更可靠了。每个人都非常乐于助人，我想我正在努力完成这项工作。我的`operator=`（我没有超载；很好，迈克尔）现在如下。它按预期运行，但我开始`malloc`在我的程序中遇到错误，我正在探索原因。这里的内存管理有什么问题吗？

```
Array<T>& operator=(const Array<T>& a) {
    if (this==&a)
        return *this;
    delete [] data;

    size_=a.size();
    data=new T(size_);
    copy(&a.data[0], &a.data[a.size()], data);

    return *this;
} 
```

编辑：我修复了`malloc`错误！我的方法现在都按预期工作。内存问题来了，因为我有这个方法头：

```
template <typename T>
static Array<T> matrixSolve (Array<Array<T> > m); 
```

我正在按值获取一组数组。各种问题。通过引用获取数组，一切都解决了。谢谢大家的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:56:22.383

你会希望你的 operator* 成员函数看起来像这样：

```
Array<T> operator*(const double scalar) const {
    Array<T> result(*this);
    result *= scalar;
    return result;
} 
```

如果您返回一个`Array<T> &`，那么您将返回一个对将被销毁的临时对象的引用，从而导致未定义的行为。

# python - 使用 Django 对 SQLite 执行原始 SQL 会导致 `DatabaseError: near "?": syntax error`

> ID：10022040
> 
> 赞同：2
> 
> 时间：2012-04-05T02:49:43.987
> 
> 标签：python, django, sqlite, django-1.3

例如，当我`cursor.execute()` [按照记录](https://docs.djangoproject.com/en/dev/topics/db/sql/#executing-custom-sql-directly)使用时：

```
>>> from django.db import connection
>>> cur = connection.cursor()
>>> cur.execute("DROP TABLE %s", ["my_table"])
django.db.utils.DatabaseError: near "?": syntax error 
```

当不使用 Django 的参数替换时，查询按预期工作：

```
>>> cur.execute("DROP TABLE my_table")
django.db.utils.DatabaseError: no such table: my_table 
```

我究竟做错了什么？如何使参数化查询起作用？

笔记：

*   为查询添加后缀`;`无济于事
*   根据文档，`%s`应该使用，而不是 SQLite `?`（Django 转换`%s`为`?`）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T02:52:06.253

您不能在 SQL 语句中使用参数来代替标识符（列名或表名）。您只能使用它们来代替单个*值*。

相反，您必须使用动态 SQL 来构造整个 SQL 字符串并将其发送到数据库（如果表名来自您的代码之外，请格外小心以避免注入）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T02:51:57.717

您不能在参数化查询中替换元数据。

# constructor - guice什么时候注入？

> ID：10022041
> 
> 赞同：0
> 
> 时间：2012-04-05T02:49:50.123
> 
> 标签：constructor, guice

嗨：我想在 Guice 用必要的参数“水合”我的班级后立即运行一项操作。这样做的惯用方法是什么？是否有 @after_running_constructor 注释...或类似的东西，我可以标记“post-guice”初始化方法？

通常，我会简单地在 init() 方法或构造函数本身中执行此操作，但事实证明，在类的构造函数运行之前，Guice 不会将必要的信息注入到我的类中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T08:17:50.137

确保您的类获得所有必要的“参数”的唯一惯用方法是将这些参数传递给构造函数。[在此处](http://code.google.com/p/google-guice/wiki/MinimizeMutability)查看关于可变性的简短讨论。

如果由于构造涉及注入和参数化而无法使用构造函数注入，则可以使用工厂模式或[AssistedInject](http://code.google.com/p/google-guice/wiki/AssistedInject)。

如果要连接某些域类，您需要了解 Guice 内部，我的猜测是应该重新审视您的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T05:16:07.597

Guice 不支持生命周期方法。[这里](https://stackoverflow.com/questions/2093344/guice-call-init-method-after-instantinating-an-object)提出了一个类似的问题，那里的人推荐了 Guice 扩展库[GuiceyFruit](http://code.google.com/p/guiceyfruit/)，但我不确定该项目是否已被维护。

此外，Guice 注入的顺序在[此处](http://code.google.com/p/google-guice/wiki/InjectionPoints)的文档中定义。

我很好奇，你为什么要为你的类同时进行构造函数和方法注入？我确信有一些用例，但是您可以通过仅使用构造函数注入来解决 init() 问题。

# emacs - 在 emacs lisp 中使用侧滑手势

> ID：10022044
> 
> 赞同：3
> 
> 时间：2012-04-05T02:50:35.907
> 
> 标签：emacs, elisp

我想在 emacs 中使用两指侧滑手势。对于上下滑动，它们绑定到`[mouse-4]`和`[mouse-5]`。是否还有另一种用于两指侧滑的绑定？如果没有，是否有任何事件在`two finger mouse`运动时触发？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T03:42:50.457

我希望这是可能的，但我认为 Emacs 默认情况下对触摸板一无所知。您在向上和向下滑动时看到的事件是鼠标滚轮向上/向下事件：

```
`(wheel-up POSITION)'

`(wheel-down POSITION)'
     These kinds of event are generated by moving a mouse wheel.  Their
     usual meaning is a kind of scroll or zoom.

     The element POSITION is a list describing the position of the
     event, in the same format as used in a mouse-click event (*note
     Click Events::).

     This kind of event is generated only on some kinds of systems. On
     some systems, `mouse-4' and `mouse-5' are used instead.  For
     portable code, use the variables `mouse-wheel-up-event' and
     `mouse-wheel-down-event' defined in `mwheel.el' to determine what
     event types to expect for the mouse wheel. 
```

`M-:` `(info "(elisp) Misc Events")` `RET`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-21T02:07:34.847

听起来您`mouse gestures`或多或少地在问。如果是这样，那么答案是肯定的。Emacs 具有鼠标手势支持：库`strokes.el`和次要模式`strokes-mode`正是为此而设计的。这是文档字符串：

Toggle Strokes 模式，一种全局次要模式。使用前缀参数 ARG，如果 ARG 为正则启用 Strokes 模式，否则禁用它。如果从 Lisp 调用，如果 ARG 被省略或为零，则启用该模式。

```
Strokes are pictographic mouse gestures which invoke commands.
Strokes are invoked with S-down-mouse-2\.  You can define
new strokes with M-x strokes-global-set-stroke.  See also
M-down-mouse-2 for `complex' strokes.

To use strokes for pictographic editing, such as Chinese/Japanese, use
M-x strokes-compose-complex-stroke, which draws strokes and inserts them.
Encode/decode your strokes with M-x strokes-encode-buffer,
M-x strokes-decode-buffer.

key             binding
---             -------

<M-down-mouse-2>                strokes-do-complex-stroke
<S-down-mouse-2>                strokes-do-stroke 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-21T02:14:34.057

这就是我在 OSX 10.6.8 上上下滚动的方式。

```
(global-set-key [(wheel)] 'mwheel-scroll) ;; magic mouse track-pad 
```

# hadoop - 限制所有reducer集体产生的记录数量

> ID：10022050
> 
> 赞同：1
> 
> 时间：2012-04-05T02:51:51.367
> 
> 标签：hadoop, mapreduce, nutch

这是用例：

输入 url 由地图读取，然后在一些过滤后发出。然后分区器根据它们的主机名对它们进行分区。

运行 map-reduce 作业后，我对输出 url 有一个全局限制。我将它均匀地分布在所有减速器上。IE。如果全局限制为 1000，reducer 的数量为 5，那么每个 reducer 最多会发出 (1000/5 = 200) 个 url 作为输出

问题是，如果只有 2 个主机的 url（由于用户输入）并且这 2 个主机中的每一个都有 100000 个 url，则处理这些 url（相同主机，相同分区）的 2 个 reducer 将每个限制为 200 个 url输出。由于分区和发出 0 条记录，Rest reducer 不会获取任何数据进行处理。

因此，即使我有 100000 个 url/主机和 1000 的全局限制，输出也只有 400 个 url（200 个 url/主机）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T09:14:32.373

Hadoop 内置了对全局[计数器](http://hadoop.apache.org/common/docs/r0.20.2/mapred_tutorial.html#Counters)的支持。您可以定义自己的计数器，并从映射器或缩减器代码中递增/读取它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T15:33:49.337

如果您不必按主机名分区，则可以通过随机分区器解决您的问题。

如果您必须按主机名进行分区，我认为没有任何简单的答案。每个 reducer 都不知道有多少记录即将到来。每个 reducer 必须累积 100000 条记录，或者与它接收到的一样多。您需要覆盖减速器中的清理功能。Reducers 需要在“清理”函数中相互交谈（也许通过计数器），并决定需要多少条记录，并且只在清理函数中写出记录。

你怎么看？

# wcf - 时间戳如何帮助防止 Web 服务中的重放攻击

> ID：10022053
> 
> 赞同：7
> 
> 时间：2012-04-05T02:52:08.937
> 
> 标签：wcf, web-services, security, web, timestamp

我试图理解 Web 服务中请求标头中时间戳的概念，但不知何故仍然无法完全理解它是如何工作的。

如果有人可以解释时间戳在 Web 服务的请求和响应中的端到端使用，我将不胜感激。

真的是万无一失的防止重放攻击的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T03:01:37.330

时间戳本身是不够的，但通常它与散列机制相结合，以保证值没有被篡改。

这个想法是客户端生成参数，并使用他们的私钥对参数进行哈希处理。[哈希 + 原始值 + 公钥] 然后随请求一起发送。服务器可以使用公钥查找私钥，并确保参数正确。

时间戳与一些阈值一起使用，以确保特定请求不能被多次使用。如果阈值很小（几百毫秒），那么重放攻击几乎是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-02T05:33:00.407

时间戳没有加密，它应该在soap头中。

```
 <wsu:Timestamp wsu:Id="timestamp">
        <wsu:Created>2014-07-01T11:30:28.123+05:30</wsu:Created>
        <wsu:Expires>2014-07-01T11:35:28.123+05:30</wsu:Expires>
    </wsu:Timestamp> 
```

如果过期时间在 Created 时间之后很短，则可以最大限度地减少重放攻击。实际上，它不仅仅是时间戳。您应该将时间戳摘要添加到 SignedInfo 部分。

```
<ds:Reference URI="#timestamp">
    <ds:Transforms>
        <ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#">
            <InclusiveNamespaces PrefixList="wsse soap" xmlns="http://www.w3.org/2001/10/xml-exc-c14n#"/>
        </ds:Transform>
    </ds:Transforms>
    <ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
    <ds:DigestValue>TGgFBvglhb+jZCvjV0+oVnNaivpVBp5iVbJEqkTfaCU=</ds:DigestValue>
</ds:Reference> 
```

所以在服务器端，这些摘要必须匹配。即使这还不是全部，然后您使用私钥对整个 signedInfo 进行签名，并将签名值添加到 Signature 元素，如下所示。

```
<ds:SignatureValue>jdO5GIZ9v1VTngFZcMpz5hz62RwToq2W24A9KhJ5JNySZW1AHhd3s+eTduZZPD0Ok6Wtgzu5kquK
    IinPdi5IbGjlg6mXGDbVkLd79RBdnbzFxsJFBtRr9r3mQZp9xfU7zSJW3kbizz6Jjk3h+S2nNbUu
    f7rFrNN53ciRtj9RlKzQzmW7BDaFuq18DUfcr70muSkmd4DIqxYDGScjEjgIqLE2pYwIdDDRUGPD
    MuwuIN3DgB051QwcE75SVrKBKsTHmFADmN3nKzmQ/JUQuLot0vW6WUFRMLVlAcl5C09SGPOcpow2
    kjbuWx/bI7Aj4nAaAnmAYsWKIA3xVao+nPBOWmM0Lg7kpC4Dr5DwahmjH0/78aVUU23DEiMc0kR0
    YDg5CxD8MUuj24w8tAjuzoHrvcsIYw+vWCTKvucnXwTlZ+K3QFB6gkct2zVOyQeYaPpkAnmPYS3W
    DDpNmsx3lDcNr+5QWTsUbSQaFDddjHT/zoOJ8+iZKY/RujOI5vfXVwgN</ds:SignatureValue> 
```

现在我们可以确保重放攻击是不可能的。由于其他任何人都不能拥有相同的私钥，因此无法更改时间戳并仍然具有有效的签名。

# java - Java 7 的 ForkJoinTask 中的 get() 和 invoke() 有什么区别？

> ID：10022055
> 
> 赞同：3
> 
> 时间：2012-04-05T02:52:17.423
> 
> 标签：java, fork, java-7, executorservice, fork-join

这是两者的[javadoc](http://docs.oracle.com/javase/7/docs/api/index.html?java/util/concurrent/ForkJoinTask.html)：

1.  get()：如有必要，等待计算完成，然后检索其结果。
2.  invoke()：开始执行此任务，如有必要，等待其完成，并返回其结果，或者如果底层计算这样做，则抛出（未经检查的）RuntimeException 或 Error。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T03:26:40.490

get() 支持可中断和/或定时等待完成并使用 Future 约定报告结果。方法invoke()在语义上等价于fork()；join() 但总是尝试在当前线程中开始执行。

# android - 来自 Google Play 的应用内结算广播顺序不正确？（静态测试）

> ID：10022057
> 
> 赞同：3
> 
> 时间：2012-04-05T02:52:30.747
> 
> 标签：android, in-app-billing

In-app Billing 的 Android 文档似乎对以下问题非常清楚。在`REQUEST_PURCHASE`您显示带有未决意图的结帐后（很好，没有问题），然后用户与结帐交互并点击购买按钮（在这种情况下，我使用的是静态产品 ID `android.test.purchased`）。

现在我的广播接收器应该收到一个`RESPONSE_CODE`然后**是**一个`IN_APP_NOTIFY`。好吧，那没有发生。有时我会先收到回复，但通常我会在收到通知后收到回复。

下面引用的 Android Doc 部分的第二个强调部分是为什么这是一个问题。如果我在收到对购买请求的异步响应时将我的应用程序中的状态更新为待处理，因为文档似乎表明我应该这样做，那么如果该响应出现在通知之后，我的应用程序陷入待处理状态。是否应该说“当您从即时同步响应中收到 result_ok 时”？

是 Goole Play 的 bug（我手机上的 Google Play 版本是 3.5.15，Android os 版本是 2.2）？我误解了文档吗？文档是完全错误的吗？是静态测试产品的问题吗？是不是还有什么问题？请注意，在我这边，一切都在 UI 线程中运行，所以这不是线程问题。

典型的非工作运行的日志输出显示在底部。

Android文档的相关部分（强调我的）：

> 处理广播意图
> 
> 一个 REQUEST_PURCHASE 请求还会触发两个异步响应（广播意图）。**首先，Google Play 应用程序发送一个 RESPONSE_CODE 广播意图**，它提供有关请求的错误信息。如果请求没有产生错误，则 RESPONSE_CODE 广播意图返回 RESULT_OK，表示请求发送成功。（需要明确的是，RESULT_OK 响应并不表示请求的购买成功；它表示请求已成功发送到 Google Play。）
> 
> 接下来，当请求的交易改变状态时（例如，购买成功通过信用卡扣款或用户取消购买），Google Play 应用程序发送一个 IN_APP_NOTIFY 广播意图。此消息包含一个通知 ID，您可以使用它来检索 REQUEST_PURCHASE 请求的交易详细信息。
> 
> 注意：Google Play 应用程序还会发送 IN_APP_NOTIFY 请求退款。有关更多信息，请参阅处理 IN_APP_NOTIFY 消息。
> 
> **因为购买过程不是即时的，并且可能需要几秒钟（或更长时间），所以您必须假设从您收到 RESULT_OK 消息到您收到交易的 IN_APP_NOTIFY 消息为止，购买请求处于待处理状态**。当交易处于待处理状态时，Google Play 结账 UI 会显示“授权购买...”通知；但是，此通知会在 60 秒后关闭，您不应依赖此通知作为向用户传达交易状态的主要方式。相反，我们建议您执行以下操作：

我的日志中的示例未按预期顺序进行：

```
MAKING REQUEST: PurchaseRequest
EXECUTING REQUEST: PurchaseRequest
IMEDIATE RESPONSE IN: PurchaseRequest, IS RESULT_OK
REQUEST ID: 1814990809059790249, PurchaseRequest
Receiver: Notify
Notify String in IN_APP_NOTIFY intent: android.test.purchased
PROCESSING NOTIFICATION
MAKING REQUEST: PurchaseInformationRequest
EXECUTING REQUEST: PurchaseInformationRequest
IMEDIATE RESPONSE IN: PurchaseInformationRequest, IS RESULT_OK
REQUEST ID: 602248989635492868, PurchaseInformationRequest
Receiver: purchase state changed
PROCESSING PURCHASE_STATE_CHANGE
newestMarketPurchaseState = PURCHASED
SetState on product 'Enterprise'. Message: PURCHASED
MAKING REQUEST: ConfirmNotificationsRequest
EXECUTING REQUEST: ConfirmNotificationsRequest
IMEDIATE RESPONSE IN: ConfirmNotificationsRequest, IS RESULT_OK
REQUEST ID: 693394902887436727, ConfirmNotificationsRequest
Receiver: Response Code = RESULT_OK
Receiver: Response Code requestId = 602248989635492868
PROCESSING RESPONSE
ASYNCH RESPONSE IN: PurchaseInformationRequest, IS RESULT_OK
Receiver: Response Code = RESULT_OK
Receiver: Response Code requestId = 1814990809059790249
PROCESSING RESPONSE
ASYNCH RESPONSE IN: PurchaseRequest, IS RESULT_OK
SetState on product 'Enterprise'. Message: PURCHASE PENDING
Receiver: Response Code = RESULT_OK
Receiver: Response Code requestId = 693394902887436727
PROCESSING RESPONSE
ASYNCH RESPONSE IN: ConfirmNotificationsRequest, IS RESULT_OK
Confirm Notifications Request returned asynch OK 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T17:06:43.590

我也遇到过同样的问题。根据问题中的答案[是否按顺序接收 Android 广播？](https://stackoverflow.com/questions/6737622/are-android-broadcasts-received-in-order/), 不能绝对保证按照发送的顺序接收意图。他们通常这样做，但不一定。因此，即使 Google Play 正确订购了它们，它们仍然可以以其他顺序到达。

在我看来，唯一的解决方案是不要假设 RESPONSE_CODE 到达的时间。在这方面，Android 文档对我来说确实是错误的。响应代码可能应该通过回调实现，而不是广播。我不得不承认，谷歌有时会变得相当粗心。

# bing-maps - Bing Map Ajax 7.0 图钉文本未显示

> ID：10022059
> 
> 赞同：0
> 
> 时间：2012-04-05T02:52:51.977
> 
> 标签：bing-maps

为图钉指定的文本未显示在图钉上（Bing Maps Ajax 7.0 控件）。

这是从交互式 sdk 虚拟复制的代码：

```
var offset = new Microsoft.Maps.Point(0, 5);
alert($(".LocationPushPin a", $(this)).text());
var pushpinOptions = {text: $(".LocationPushPin a", $(this)).text(), visible: true, textOffset: offset};
var pushpin = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location($(".RetailLocationLatitude", $(this)).text(), $(".RetailLocationLongitude", $(this)).text(), pushpinOptions));
BingMap.entities.push(pushpin); 
```

警报确实显示了我认为给定此代码会出现的值（“1001”等）。Firebug 或 IE9 调试器中没有语法或其他错误。

我错过了什么？感谢你给与我的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T09:44:17.653

我有一个放错位置的括号（在选项之后：

```
var pushpin = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location($(".RetailLocationLatitude", $(this)).text(), $(".RetailLocationLongitude", $(this)).text()), pushpinOptions); 
```

很抱歉您审核了这个问题。

# string - 给定一个搜索词列表，我如何判断我的字符串包含哪些搜索词？

> ID：10022062
> 
> 赞同：2
> 
> 时间：2012-04-05T02:53:29.443
> 
> 标签：string, search

有很多软件会使用搜索字符串并在数据库中找到包含它的所有文本（MySQL `WHERE MATCH('searchterm', string_column)`、Google 等），但是有没有好的算法可以反过来呢？

假设我有一个搜索词列表：

> 丰田普锐斯、丰田塔科马、本田思域、雪佛兰 Nova、雪佛兰 Volt

我有一个字符串，比如：

> 1962 年雪佛兰 Nova 敞篷车

有没有一个好的算法可以让我把列表和字符串放进去，然后`Chevy Nova`出去？

如果它们都易于标记，我可以标记它们并进行内部连接，但我对我无法分辨输入字符串的哪一部分是“重要”部分的情况感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T17:13:35.463

如果您要对“1962 Chevy Nova 敞篷车”[原文如此] 进行标记，您最终会得到四个足够重要或有趣的标记。如果您正在跟踪您的语言中所有可能的单词，那么您将拥有每个单词的索引。

另一方面，你有你的搜索词。在每种情况下，您都对有趣的单词进行了标记和索引。每一个都可以看作是一对两个令牌索引。

那么，如果您接受输入并寻找匹配的搜索词，您会问哪些搜索词具有输入的任何词？

因为我本质上是一个数据库专家，所以我可以想象像这样创建令牌列表：

```
CREATE TABLE aa_tokens (
  id INT NOT NULL AUTO_INCREMENT PRIMARY KEY ,
  word VARCHAR( 40 ) NOT NULL 
);

insert into aa_tokens (word) values
  ('1962'),           -- 1
  ('Chevy'),          -- 2
  ('Civic'),          -- 3
  ('Honda'),          -- 4
  ('Nova'),           -- 5
  ('Prius'),          -- 6
  ('Tacoma'),         -- 7
  ('Toyota'),         -- 8
  ('Volt'),           -- 9
  ('convertable');    -- 10 
```

和一个搜索表，以便每个搜索都有一个 id：

```
CREATE TABLE aa_search (
  id INT NOT NULL AUTO_INCREMENT PRIMARY KEY ,
  text VARCHAR( 255 ) NOT NULL
);

insert into aa_search (text) values
  ('Toyota Prius'),   -- 1
  ('Toyota Tacoma'),  -- 2
  ('Honda Civic'),    -- 3
  ('Chevy Nova'),     -- 4
  ('Chevy Volt');     -- 5 
```

然后是一个组合搜索和标记的表：

```
CREATE TABLE aa_searchToks (
  search INT NOT NULL,
  token INT NOT NULL
);

insert into aa_searchToks (search, token) values
  (1, 8),
  (1, 6),
  (2, 8),
  (2, 7),
  (3, 4),
  (3, 3),
  (4, 2),
  (4, 5),
  (5, 2),
  (5, 9); 
```

现在，如果我们将输入字符串“1962 Chevy Nova convertable”转换为标记（1、2、5、10），我们可以进行查询以查看搜索词的标记：

```
select search, count(*) from aa_searchToks
  where token in (1, 2, 5, 10) group by search; 
```

结果是：

```
+--------+----------+
| search | count(*) |
+--------+----------+
|      4 |        2 |
|      5 |        1 |
+--------+----------+ 
```

或查询有点不同：

```
select search, (select text from aa_search s where st.search = s.id) as text, 
  count(*) from aa_searchToks st where token in (1, 2, 5, 10) group by search; 
```

导致：

```
+--------+------------+----------+
| search | text       | count(*) |
+--------+------------+----------+
|      4 | Chevy Nova |        2 |
|      5 | Chevy Volt |        1 |
+--------+------------+----------+ 
```

我们可以看到“Chevy Nova”匹配两个标记并且是最佳匹配，当然，它是。

# spring - 如何调试不执行任何操作且不引发异常的 Spring webflow 提交

> ID：10022067
> 
> 赞同：4
> 
> 时间：2012-04-05T02:54:29.700
> 
> 标签：spring, spring-mvc, spring-webflow

我有 spring 2.5 应用程序，并且流程中的几个页面可以完美运行 - 它们根据我的 flow.xml 进行。“损坏”的页面具有以下形式的提交：

```
<input type="image" name="_eventId_submit" src="<c:url value="images/continue.png" />" /> 
```

此页面的流程定义看起来正确：

```
<view-state id="coverages" view="tiles.coverages" model="rtrForm">
    <on-entry>
 ...
    </on-entry>
    <transition on="submit" to="policyVehicleDetailsDecisionForward">
        <evaluate expression="coverageFormAction.bindAndValidate" />
        <evaluate expression="coverageFormAction.evaluateCoverages(rtrForm)" />
    </transition>
</view-state> 
```

我在 mainFlowAction.evaluateCoverages(...) 中有调试语句，我在日志文件中没有看到这一点，但我也没有看到任何异常 - 有人知道从这里去哪里吗？我已将 eclipse 附加到 Tomcat 6.0.33 以进行远程调试，但我仍然没有看到任何异常...我在这一点上被难住了，不知道如何解决这个问题 - 任何帮助或欢迎提出建议。

所以我更进一步，我已经覆盖了 QuoteFormAction.bindAndValidate() 方法，遗憾的是，我没有在日志中看到这个方法被调用 - 所以我假设此时表单是'甚至没有调用它......我使用与所有有效页面相同的模式。我已经缩写了表格 - 也许我忽略了一些明显的东西：

```
<form id="rtrForm" action="/rtrSite/main.svc?execution=e1s5" method="post">
...
<select name="quoteForm.policyLevelCoverages.towing" class="violationType" id="TOWING"  validate="selectOneOption" req="">
...
<select name="quoteForm.vehicleLevelCoverages[0].rental" class="violationType" id="RENTAL"  validate="selectOneOption" req="">
...
<input type="image" name="_eventId_submit" src="images/continue.png" />
<input type="image" name="_eventId_save" src="images/save.png" value='Save -n- Return' />
<input type="image" src="images/back.png" name="_eventId_back" value='Back' />
<input type="reset" id="reset" />
</form> 
```

JSP 表单生成：

```
<c:forEach var="policyCoverageList" varStatus="policyCoverageStatus" items="${quoteForm.coverages.jspCoverageCodesPolLevel}">

          <spring:bind path="quoteForm.policyLevelCoverages.${fn:toLowerCase(policyCoverageList.coverageCode)}" >
           <select name="${status.expression}" class="violationType" id="${policyCoverageList.coverageCode}"  validate="selectOneOption" req="">
                <c:if test="${policyCoverageList.isRequired == 'N'}">
                   <option value="-1"><spring:message code="coverage.decline" /></option>
                 </c:if>
                 <c:forEach var="policyCoverage" items="${policyCoverageList.limits}">
                     <option value="${policyCoverage.id}" <c:if test="${policyCoverage == 'TODO'}">SELECTED</c:if>>
                          ${policyCoverage.coverageLimits}
                      </option>
                  </c:forEach>
              </select>
           </spring:bind>

</c:forEach> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-16T16:59:15.373

在记录器中打开调试级别

```
<logger
        name="org.springframework.webflow">
        <level value="debug" />
    </logger> 
```

您将在控制台/日志文件中看到消息，这将帮助您找出问题所在

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:57:56.120

`"tiles.coverages"`每次都返回视图吗？如果是这样，我会假设您遇到某种绑定/验证错误。在jsp里面放上来`<form:errors path="*"/>`看看是不是真的。

编辑：

这两个选择都是非空的，第二个不是空的吗？因此对于

```
quoteForm.vehicleLevelCoverages[0].rental 
```

vehicleLevelCoverages 列表/数组中至少有一个元素？

一方面不是：

您使用的是 Spring Weblflow 2 吗？如果你是你不需要做 bindAndValidate 它无论如何都会为你做。

# mysql - 找出崩溃率最高的年份？

> ID：10022069
> 
> 赞同：1
> 
> 时间：2012-04-05T02:55:07.593
> 
> 标签：mysql, sql

```
SELECT MAX(crash_year) AS crash_year, COUNT(crash_year) AS COUNT 
FROM nyccrash 
GROUP BY crash_year 
ORDER BY COUNT(crash_year) DESC; 
```

该语句将返回 20 年的整个范围。但是我如何只检索第一行？

```
+------------+-------+
| crash_year | count |
+------------+-------+
|       1999 |   862 |
|       1990 |   847 |
|       1992 |   812 |
|       1991 |   810 |
|       1993 |   806 |
|       2000 |   803 |
|       1994 |   782 |
|       1989 |   763 |
|       2001 |   729 |
|       1995 |   698 |
|       1997 |   672 |
|       1996 |   671 |
|       1998 |   665 |
|       2002 |   497 |
|       2003 |   419 |
|       2006 |   384 |
|       2004 |   377 |
|       2007 |   364 |
|       2005 |   363 |
+------------+-------+ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T02:57:21.597

添加`LIMIT 1`到查询的末尾，因此：

```
SELECT MAX(crash_year) AS crash_year, COUNT(crash_year) AS COUNT 
FROM nyccrash 
GROUP BY crash_year 
ORDER BY COUNT(crash_year) DESC
LIMIT 1; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T03:01:56.763

取决于您使用的 SQL 数据库引擎。有些在 SELECT 之后使用 TOP 1，有些在 ORDER BY 子句之后使用 LIMIT 1。

此外，您不需要在 crash_year 的第一个实例周围使用 MAX()。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T03:15:09.463

不知道为什么你有一个`MAX`crash_year。去掉它。所以问题是：

> 找出崩溃率最高的年份？

在 MySQL 和 PostgreSQL 中：

```
SELECT crash_year
FROM nyccrash 
GROUP BY crash_year 
ORDER BY COUNT(crash_year) DESC
LIMIT 1 
```

在 SQL Server 中：

```
SELECT TOP 1 crash_year
FROM nyccrash 
GROUP BY crash_year 
ORDER BY COUNT(crash_year) DESC 
```

在 DB2 中：

```
SELECT crash_year
FROM nyccrash 
GROUP BY crash_year 
ORDER BY COUNT(crash_year) DESC
FETCH FIRST 1 ROWS ONLY 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-05T02:57:03.990

```
SELECT TOP 1
    crash_year, COUNT
FROM
(
    SELECT MAX(crash_year) AS crash_year, COUNT(crash_year) AS COUNT 
    FROM nyccrash 
    GROUP BY crash_year 
    ORDER BY COUNT(crash_year) DESC;
) AS T 
```

刚刚看到一个 LIMIT 1 与一个 top 1。我想如果你将你的 SQL 风格添加为标签，我们可以更具体。

# cordova - 我可以在 PhoneGap 中使用 Mojo.Controller.showAlertDialog 吗？

> ID：10022073
> 
> 赞同：0
> 
> 时间：2012-04-05T02:55:48.710
> 
> 标签：cordova, mojo

今天下午我正在尝试PhoneGap 1.5，我不能使用`navigator.notification.alert("Hello", function() {}, "OK")`但`navigator.notification.alert("Hello")`可以工作。我检查了 phonegap.js 并确实找到了`Notification.prototype.alert = function(message, response, icon) {...};`. 那么，怎么了？其实我只是想看看我是否可以使用这样的东西`Mojo.Controller.showAlertDialog`来显示一个模式对话框，以便用户可以选择发生了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T08:56:32.313

您是否尝试过将 JQuery Mobile 与 PhoneGap 中的 HTML 一起使用？

最新版本的 JQM 涵盖了很多此类内容，此外还使用 JQuery 函数来涵盖 AJAX、按钮等

# c++ - 参数列表中任意点的默认参数是否可能？

> ID：10022078
> 
> 赞同：1
> 
> 时间：2012-04-05T02:56:31.877
> 
> 标签：c++, default-arguments

希望读到这里的人都知道默认参数：

```
void setCase (string &str, int form = UPPERCASE)
{
    for (char &c : str)
        c = (form == UPPERCASE ? c & ~0x20 : c | 0x20); //this bit differentiates english uppercase and lowercase letters
}

int main()
{
    string s1 = "HeLlO", s2 = s1, s3 = s1;
    setCase (s1, UPPERCASE); //now "HELLO"
    setCase (s2, LOWERCASE); //now "hello"
    setCase (s3); //now "HELLO" due to default argument
} 
```

使用默认参数的一个缺点是您必须在列表末尾开始默认参数。有时这涉及将参数重新排列成一个看起来很愚蠢的顺序。为了解决这个问题，必须进行单独的重载。

让我以一个 Window API 函数[FindWindow](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633499%28v=vs.85%29.aspx)为例，它通过类名、标题或两者来查找窗口：

```
HWND WINAPI FindWindow( //returns handle to window
  __in_opt  LPCTSTR lpClassName, //param equivalent to const TCHAR *, classes are like templates for windows
  __in_opt  LPCTSTR lpWindowName //the text that appears on the title bar (for normal windows, for things like buttons, it's what text is on the button)
); 
```

为了包装这一点，人们可能希望默认搜索选项是标题。有三种理想的实现方式（假设使用了其他包装技术）。完美的解决方案很可能如下：

```
Window FindWindow (LPCTSTR className = 0, LPCTSTR windowName){...} 
```

第二种解决方案是重载该函数的一个版本以仅接受标题，而另一个版本则接受两者。第三个是切换参数的顺序。

第二个主要问题是对于更长的列表，随着列表的增长，重载的空间量可能会变得非常大。第三个的主要问题是任何事先使用过这个函数的人都会习惯于首先指定类名。这也适用于常规 C++ 函数。参数往往具有自然顺序。

当然，第一个解决方案的主要问题是它不受 C++ 语言的支持。我的问题是：
**将来是否有可能实现这一点？**

例如，编译器能否在需要时自动生成适当的重载？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T03:19:16.350

这不太可能。有*很多*极端案例。当前规则非常容易学习：“所有默认参数都必须位于参数列表的末尾。” 新规则将是：“省略的默认参数的组合不得有歧义，除非必须保留向后兼容性。” 更糟糕的是，这甚至不是您可以在定义时测试的规则，因为 C++ 现在甚至不会为重载函数执行此操作。例如，取以下两个函数定义：

```
void foo();
void foo(int x = 0); 
```

这些都是完全合法的，即使期望第一个被调用是不合理的：任何看起来像的调用`foo()`都是模棱两可的。现在考虑一个假设的 C++ 版本，其中默认参数不必放在最后：

```
void foo(int x = 0, int y = 0); 
```

来电`foo(1)`做什么？好吧，要向后兼容，它必须调用`foo(1, 0)`. 这很有趣，因为这个函数没有这样的困难：

```
void bar(const char* a = 0, int b = 0); 
```

以下是对该函数的一些合法调用：

```
bar("foo");
bar(1);
bar("foo", 1);
bar(); 
```

所以该`foo`函数只生成三个版本：`foo()`、`foo(int)`和`foo(int, int)`。但是这个也有两个默认参数，生成四个。（而且它们并不是明确的：`foo(0)`是一个模棱两可的调用。）好吧，您可以使用标准中的一些复杂语言来解决这个问题。但现在考虑这个函数：

```
struct A;
struct B;
A some_A();
B some_B();
void baz(const A& a = some_A(), const B& b = some_B()); 
```

现在生成版本的数量取决于您的用户定义类型的转换，这甚至可能在您的函数*定义中不可见。*在当前版本的 C++ 中，调用`baz(B())`总是会尝试将`B`实例转换为`A`，否则会失败。现在，有人可以合理地期望`B`在第二个参数中传递您的实例，如果您编写`baz`as `baz()`、`baz(const A&)`、`baz(const B&)`、的四个重载版本会发生这种情况`baz(const A&, const B&)`。`baz(B())`除非您想破坏现有代码，否则您甚至不能认为默认参数乌托邦世界中的调用是模棱两可的。

转换甚至使“默认参数由不同类型的非默认参数分隔”的相对简单的情况变得混乱。例如，这个：

```
void quux(A* a = nullptr, B* b, C* c = nullptr); 
```

完全明确：可调用为`quux(B*)`, `quux(A*, B*)`, `quux(B*, C*)`, 和`quux(A*, B*, C*)`. 除非`A`继承自`B`哪个继承自`C`（反之亦然）。当然，这与重载解析必须面对的问题相同，但到目前为止，默认参数已经完全明确，现在我们陷入了微妙的泥潭。

即使你找到了一个让每个人都满意的一致解决方案，也几乎不可能简明扼要地解释清楚，这可能是一个净损失。

# php - 尝试制作一个 PHP 界面来使用 EXIM 监控传出的电子邮件

> ID：10022080
> 
> 赞同：1
> 
> 时间：2012-04-05T02:56:53.203
> 
> 标签：php, email, exim

我在一家律师事务所担任 IT 人员。我最近被要求创建一个系统，其中从我们的服务器发送到我们客户的所有外发电子邮件将首先被搁置，并在发送给客户之前等待批准。

我们的邮件服务器使用 Exim（这就是它在 cPanel 中所说的）。我计划创建过滤器，将传出的电子邮件转发到编辑器帐户。然后，编辑将审查和编辑电子邮件的内容。当编辑已经批准这封电子邮件时，它会由编辑发送给客户，但在“发件人：”和“回复：”字段中仍使用原始发件人。

我从这个站点找到了一些指针 => [http://www.devco.net/archives/2006/03/24/saving_copies_of_all_email_using_exim.php](http://www.devco.net/archives/2006/03/24/saving_copies_of_all_email_using_exim.php)。

一旦过滤器就位，我想为编辑器制作一个简单的 PHP 界面，以检查转发的电子邮件并在必要时对其进行编辑。然后编辑器可以单击“批准”按钮，最终将使用原始发件人传递消息。

我也在想也许一个没有 PHP 的系统就足够了。编辑可以从他自己的电子邮件客户端接收电子邮件，对其进行编辑，然后像原始发件人一样简单地发送电子邮件。

1.  我的计划可行吗？
2.  会不会有我忽略的问题？
3.  它是否有被其他邮件服务器视为垃圾邮件的危险，因为我会弄乱标题？

# c# - 通过加密的查询字符串传递字典

> ID：10022081
> 
> 赞同：1
> 
> 时间：2012-04-05T02:56:55.737
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, serialization, deserialization

我有一个要加密的字典对象，然后将其放入查询字符串中，然后在另一端解密。

我为此使用 JavaScriptSerializer。现在我已经在同一页面上尝试了这个，它有效。所以我使用的加密/解密扩展方法正在工作。这使我相信查询字符串存在一些问题。

例如

```
 var js = new JavaScriptSerializer();
        var d = new Dictionary<string, string>();
        d.Add("ID", "123456");
        d.Add("Name", "HELLO TEST");
        d.Add("Email", "test@email.com");
        var s = js.Serialize(d).EncryptString();
        var ds = js.Deserialize<Dictionary<string, string>>(s.DecryptString());
        @ViewBag.Test = ds["Name"]; 
```

在上面的示例中，`EncryptString()`并且`DecryptString()`是我正在使用的扩展方法。这按预期工作，因此它为`"Name"`.

当我将序列化的加密字符串放入查询字符串然后尝试对其进行解码时，我遇到了问题。

**所以在第一页**，我有这样的东西：

```
 var js = new JavaScriptSerializer();
        var d = new Dictionary<string, string>();
        d.Add("ID", "123456");
        d.Add("Name", "HELLO TEST");
        d.Add("Email", "test@email.com");
        var s = HttpUtility.UrlEncode(js.Serialize(d).EncryptString()); 
```

`s`然后用作查询字符串。

**在接收页面上**，我有这个：

```
public ActionResult Display(string r)
{
        var js = new JavaScriptSerializer();
        var decryptedString = HttpUtility.UrlDecode(r).DecryptString();
        var s = js.Deserialize<Dictionary<string, string>>(decryptedString);
        return View();
} 
```

这会引发错误：`System.FormatException: Invalid length for a Base-64 char array or string.`解密字符串行上的此错误。

我不明白发生了什么......我在文本进入查询字符串之前对其进行urlencoding，然后在反序列化之前对其进行urldecoding..

**编辑**

想通了..我加密了两次...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T03:03:12.847

您可能不需要对字符串进行 UrlDecode，因为 MVC 会在分配`r`参数值之前完成此操作。直接解密试试`r`。

当然，我必须发出警告：你在这里所做的似乎是一个非常糟糕的主意。无论您想通过在 URL 中发送这个加密字典来完成什么，几乎肯定有更好的方法来完成它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T03:04:09.587

很可能某些字符不会以您期望的方式往返（即，在这种情况下，“+”往往会变成空格）。

使用 Fiddler（或任何其他 HTTP 调试工具）检查实际发送到服务器/从服务器发送的内容。比检查是否出现“显示”动作的字符串 - 你很可能会看到问题所在。

# linux - 基本的 Linux dmesg 问题

> ID：10022082
> 
> 赞同：1
> 
> 时间：2012-04-05T02:57:00.540
> 
> 标签：linux, embedded, driver, init, xilinx

并感谢您查看此问题。

我正在总线标准 (PLB -> AXI) 之间移植一个 Linux (2.6.37) 驱动程序，以准确用于 Xilinx FPGA-SoC。设备驱动程序在树中内联编译。我有几个问题，我相信你们可以帮助我。

1.  Linux 内核树中的哪些列表允许设备在 dmesg 上打印 device_init *_*字符串？上市需要什么文件？
2.  通常，当设备驱动程序在树外编译时，使用的扩展名（通常）是 *.ko，当设备驱动程序在树内编译并使用“make modules”合并时是这种情况吗？

***为清晰而编辑***

假设您有一个名为“foo”的设备，它必须在树中编译。我观察到“foo”正在为 PLB 打印 dmesg 字符串，但不是为 AXI 打印。我想问如何将设备添加到“init”？哪个文件包含“foo”的条目，告诉 init 必须加载“foo”？

从更大的意义上说， foo = xilinx_hwicap

谢谢 RRS

PS 感谢您的耐心等待

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T03:00:15.740

1.  `printk(9)` [打印到系统消息环](https://stackoverflow.com/questions/4036624/where-does-printk-print-to)。

2.  2.6+ 中的所有模块，无论位置如何，都以“.ko”结尾。

# php - 为 mysql 配置 php.ini

> ID：10022092
> 
> 赞同：2
> 
> 时间：2012-04-05T02:57:48.420
> 
> 标签：php, mysql, apache

我正在尝试在 Windows 上安装 phpmyadmin。我得到了可怕的 mysql 扩展丢失。请检查您的 PHP 配置。

我已经找了好几个小时，我发现的每一个修复都会导致 apache 无法重新启动。这是我的版本信息。

> phpMyAdmin 3.4.10
> 
> MySQL5.5
> 
> PHP 版本 5.2.17
> 
> 阿帕奇 2.2.21
> 
> 视窗

我无计可施。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T05:27:57.967

在 php.ini 中，你必须缺少这个

```
 ;extension=php_exif.dll      ; Must be after mbstring as it depends on it
    extension=php_mysql.dll
    extension=php_mysqli.dll
    ;extension=php_oci8.dll 
```

注意非分号线。

也有一些不错的教程

[阿帕奇指南](http://apacheguide.org/apache.php)

# ruby - 开始使用 ActiveRecord - 我想存储一个 HTML 表并将其转换为 Hash

> ID：10022094
> 
> 赞同：0
> 
> 时间：2012-04-05T02:57:53.967
> 
> 标签：ruby, activerecord

在将 HTML 表中的一些 gif 和 url 替换为有用的数据之前，我得到了社区的一些帮助，然后将其放入 2D 数组中，但我认为我真正需要的是将表的每一行作为哈希存储在活动记录条目。

这是带有标题的第一行示例数据：

```
html2 = <<TABLE2
<table class="status">
<caption class="status">Drive status</caption>
<tr class="status">
<th class="status"></th>
<th class="status">Drive</th>
<th class="status">State</th>
<th class="status">Health</th>
<th class="status">Make/Model</th>
<th class="status">Speed</th>
<th class="status">Serial</th>
<th class="status">Firmware</th>
<th class="status"><a href="/cgi-bin/status_dylan?cont=0&amp;dylan=0&amp;display=1">Sectors</a></th>
<th class="status">Temp</th>
<th class="status"> </th>
</tr>
<tr class="status">
<td class="status"><img border="0" src="/tick_green.gif"></td>
<td class="status">0</td>
<td class="status">Ready</td>
<td class="status"><a href="/cgi-bin/status_drive?cont=0&amp;dylan=0&amp;drive=0"><img border="0" src="/bar10.gif"></a></td>
<td class="status">SEAGATE ST3146807FC</td>
<td class="status">10000 RPM</td>
<td class="status">3HY61E1B</td>
<td class="status">XR12</td>
<td class="status">286749488</td>
<td class="status"> 29.0&#176;C</td>
<td class="status" style="background-color: #fefe00">&#160;
</td>
</tr>

clean_table2 = []
  table2.css('tr').each do |tr|
    clean_row = []
    tr.css('td').each do |td|
      #for each cell, look for img tags, and replace the images with text as appropriate, then strip the html
      img = td.at('img')
      clean_row.push case
      when img && img[:src][/bar(\d+)\.gif/] then 'Health: '+$1
      when img && img[:src][/tick_green/] then 'Healthy'
      when img && img[:src][/cross_red/] then 'Failed'
      when img && img[:src][/caution/] then 'Caution'
      else td.text.strip
      end

    end
  clean_table2.push clean_row
  #puts clean_row[5]
  end
  puts "\n"
#puts clean_table.join("\n")
clean_table2.each {|x|
  puts "#{x}"
} 
```

这是删除所有不重要的内容并用合理文本替换“无用”gif的代码-=但是我创建的散列并不像我希望的那样有用-所以我宁愿使用表头创建一个散列作为键然后我可以将它与服务器序列号和数组地址一起输入到一个活动记录条目中，以便我可以比较和显示记录实例之间的增量（例如，如果驱动器运行状况从 10 下降到 5）你们都怎么做思考？我可以比较数组，但我认为由于记录检索速度很快，我只能存储不同的变化，而不是每次发生变化时都存储一个二维数组（我认为这会很快失控）

...正如您可能猜到的那样，我也试图在我的脑海中直截了当；）非常感谢斯科特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T03:09:04.497

稍微改写一下，让它更合乎逻辑......

```
 table = html_page.parser.xpath('//table/caption[contains(.,"Drive")]/..')
  #loop through each row individually (or do I want to chuck the whole thing into a nice juicy hash)
  #Am I using this?  #REMOVE
  clean_table = Array.new
  clean_head=[]
  table.css('tr').each do |tr|
    #stash WWN number, fake interface and fake address [can get, but not needed at this stage]
    clean_row = {:wwn=>cells[0],:dyl_if=>'1',:dyl_addr=>'0'}
    #grab headers
    tr.css('th').each_with_index do |th,i| 
      if i == 0
        clean_head.push "Drive Health"
      else if i == 10
        clean_head.push "BG Temp"
      else clean_head.push th.text.strip
      end
    end
  end
    #each td in each tr - add index so I can add table headers as keys in hash
    tr.css('td').each_with_index do |td, i|
      #for each cell, look for img tags, and replace the images with text as appropriate, then strip the html
      img = td.at('img')

      clean_row[clean_head[i]] = case 
      when img && img[:src][/bar(\d+)\.gif/] then 'Health: '+$1
      when img && img[:src][/tick_green/] then 'Healthy'
      when img && img[:src][/cross_red/] then 'Failed'
      when img && img[:src][/caution/] then 'Caution'
    else td.text.strip
      end
    end
    #Debug output - confirm nothing cocked up
    puts clean_row
    if clean_row.has_key?("Health")
      Drive_Record.create(clean_row)
      puts "Add Drive Recprd"
     end

end 
```

# apache - 将流量重定向到 CDN 页面

> ID：10022096
> 
> 赞同：0
> 
> 时间：2012-04-05T02:58:16.843
> 
> 标签：apache, .htaccess, mod-rewrite

所以任何时候有人访问这个页面：

```
http://www.site.com/page/image_(.*).png 
```

他们被重定向到cdn url，这将是

```
http://cdn.site.com/page/image_(.*).png 
```

我怎样才能使用 htaccess 做到这一点？我只需要这个网址。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T03:02:46.833

使用 mod_alias，如果您有权访问虚拟主机配置，请在您的主虚拟主机（对于 www）中添加：

```
RedirectMatch 301 ^/page/image_(.*)\.png http://cdn.site.com/page/image_$1.png 
```

如果您没有访问权限并且必须使用 .htaccess 文件，则需要 mod_rewrite：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^(www\.)?site.com [NC]
RewriteRule ^page/image_(.*).png http://cdn.site.com/page/image_$1.png [R=301,L] 
```

# ios - 对于我不合成的属性，我是否需要 ARC 关键字？

> ID：10022097
> 
> 赞同：6
> 
> 时间：2012-04-05T02:58:35.067
> 
> 标签：ios, properties, xcode4.2, automatic-ref-counting

我有一个我不合成的属性，而是我自己创建了一个 getter 和 setter。因此，我认为 ARC 关键字（强或弱）没有意义，因此我将其删除。这在 Xcode 4.3 上运行良好，但是当我的同事在 XCode 4.2 上打开它们时，编译器抱怨没有强/弱关键字，所以我指示他再次毫无意义地重新输入关键字。哪个是正确的（有或没有关键字）？

需要明确的是：我有一个这样的属性，`@property (nonatomic) NSString *foo`并且在我实现的 .m 文件中`-(NSString *)foo`并且`-(void)setFoo:(NSString *)foo`不包含`@synthesize foo`. 另一个相关细节是没有对应的 iVar，而是属性与 Core Data 对象交互。除非我在关键字中添加强或弱，否则这不会在 XCode 4.2 中编译。

**编辑**我想到了一件更相关的事情，其中​​一个属性在协议上，我不知道这是否会有所作为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T22:22:00.947

您引用的声明属性是可选的。引用文档：

> **属性声明和实现**
> @property 指令声明一个属性。可选的带括号的属性集提供有关存储语义和属性的其他行为的其他详细信息 - 请参阅“属性声明属性”以获取可能的值。
> 
> **属性声明属性**
> 您可以使用表单来装饰属性`@property(attribute [, attribute2, ...])`。与方法一样，属性的范围仅限于其封闭的接口声明。对于使用逗号分隔的变量名列表的属性声明，属性属性适用于所有命名属性。
> 
> 如果您使用该`@synthesize`指令告诉编译器创建访问器方法（请参阅“属性实现指令”），它生成的代码与关键字给出的规范相匹配。如果您自己实现访问器方法，则应确保它与规范匹配（例如，如果您指定复制，则必须确保确实复制了 setter 方法中的输入值）。

如果您然后使用`@dynamic`而不是`@synthesize`它，则告诉编译器您将编写自己的方法并防止它在找不到合适的方法时抱怨。

更多信息可以在[这里](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocProperties.html)找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T15:41:09.530

博登，

首先，你为什么要在你的属性声明中省略你的记忆策略？它向您所在班级的消费者宣布该政策是什么。你不想让他们知道吗？

其次，@synthesize 不是 nop。它是语言支持 KVO 的机制。虽然您现在可能不会使用它，但您为什么要在未来排除这种使用。

坦率地说，通过不使用@property 中的完整描述或使用@synthesize，IMO，您正在从事过早的优化。您当前的设计不会为您节省消息发送，并迫使您在必要时管理 ivars 的创建和键入。而且您正在失去该语言的功能。

除非您有充分的理由超出首选 Obj-C v2+ 模式的范围，并且您没有列出这些，否则我将返回使用标准模式。然后你的问题就消失了。

安德鲁

# c - IGraph 中没有显示图形

> ID：10022102
> 
> 赞同：0
> 
> 时间：2012-04-05T02:59:45.973
> 
> 标签：c, igraph

我一直在尝试使用 c 中的 igraph 库制作图表。我什至重新安装了它，但我无法理解问题所在。整个程序编译成功，但我没有得到任何图形作为输出。所有的 printf 都被执行并显示在输出中，只有图表似乎丢失了。

请帮助我陷入这个问题。

```
#include <igraph.h>

int main(void)
{
 igraph_real_t diameter;
 igraph_t graph;
 igraph_erdos_renyi_game(&graph, IGRAPH_ERDOS_RENYI_GNP, 1000, 5.0/1000,
                         IGRAPH_UNDIRECTED, IGRAPH_NO_LOOPS);
 igraph_diameter(&graph, &diameter, 0, 0, 0, IGRAPH_UNDIRECTED, 1);
 printf("Diameter of a random graph with average degree 5: %f\n",
         (double) diameter);
 igraph_destroy(&graph);
 return 0;
} 
```

这是我正在使用的代码。仅打印 printf 语句。没有错误或警告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:56:52.567

您正在使用 C 中的 igraph，而 igraph 的 C 核心完全缺乏绘图功能。（这是故意的）。如果要绘制图形，则必须使用 igraph 的 Python 或 R 绑定；在 Python 和 R 模块中，绘图是在 C 核心库之上实现的。

# cakephp - Cakephp 从 1.3 升级到 2.1

> ID：10022103
> 
> 赞同：6
> 
> 时间：2012-04-05T02:59:46.203
> 
> 标签：cakephp, cakephp-1.3, cakephp-2.0

更新：我问的问题并没有完全涵盖我在升级过程中的深度！如果你偶然发现这个，我希望我推送的答案对你有用

因此，为了让“论坛”插件正常工作，我决定将 cakephp 从 1.3 升级到 2.1

（这是因为论坛插件使用了一种叫做 CakeDC utils 的东西，它们已经升级到 cakephp 2.0，令人惊讶的是，论坛的 2.3 版本并不清楚它可以与哪些 utils 一起使用......）

好的，所以我已经按照此处的说明运行了蛋糕升级程序魔法的东西：

[http://book.cakephp.org/2.0/en/console-and-shells/upgrade-shell.html#upgrade-shell](http://book.cakephp.org/2.0/en/console-and-shells/upgrade-shell.html#upgrade-shell)

我运行了升级程序，它说它做了很多事情，看起来它*确实*做了很多事情。

现在，当我访问我的网站时，它已关闭 - 根本没有响应。

apache中的错误日志如下：

> [Thu Apr 05 02:58:04 2012] [error] [client 173.45.125.112] PHP 致命错误：找不到应用程序核心文件。请创建 /cake_install/app/config/core.php，并确保它可以被 PHP 读取。在第 393 行的 /cake_install/cake/libs/configure.php

该文件不存在的原因是它在升级中更改为大写的“C”配置。我错过了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-05T11:22:09.883

mensch 给出的答案并不是我所需要的——我从未接触过 index.php 文件——所以我将详细说明我在这里尝试的内容。

我使用这个网站作为指南，但也有我自己的评论！ [http://www.paulmarshall.us/blog/migrating-from-cakephp-13-to-cakephp-20](http://www.paulmarshall.us/blog/migrating-from-cakephp-13-to-cakephp-20)

（我还发现了这个：[https](https://github.com/dereuromark/upgrade) ://github.com/dereuromark/upgrade ，如果上面的教程失败了，我可能会尝试一下。不过我不太喜欢它，我喜欢超级详尽的文档，而不是

```
Put `CakePlugin::loadAll();` in your app bootstrap to make sure this plugin is loaded 
```

这对我来说毫无意义......你能指定文件的文件夹吗？文件中的任何特定位置要添加该行？等等......我会努力对我所做的事情保持特别的态度！）

首先，我注意到我的蛋糕使用的 index.php 不是 cake2.1 代码附带的 index.php。不确定为什么会这样，但我复制了“新”2.1 index.php（是的，这是 app/webroot/index.php 文件），现在我有一个新错误：

> 注意：未定义索引：第 94 行 /cake_install/lib/Cake/Core/Configure.php 中的错误 注意：未定义索引：第 95 行 /cake_install/lib/Cake/Core/Configure.php 中的异常 致命错误：类名必须是第 126 行 /cake_install/lib/Cake/Error/ErrorHandler.php 中的有效对象或字符串

（其中 cake_install 是我的蛋糕应用程序所在的文件夹）

现在正在处理这个...

现在我看到升级工具没有升级 core.php 文件 - 在 app/Config 中找到（对于 2.1，app/config 对于 1.3）......升级工具到底做了什么？我已经剪切并粘贴了 2.1 版本（也就是说，从 2.1 代码的 zip 文件中，我将 /app/Config/core.php 移到了我的 /app/Config 目录中），并确保交换了盐值和安全值。而已。

仍然没有运气。所以现在我已经升级了 database.php 文件（也在 app/Config 或 app/config 中）~我改变了

```
'driver' => 'mysqli', 
```

至

```
'datasource' => 'Database/Mysqli', 
```

随机配置文件很有趣！

啊，好的，所以升级到核心和数据库改变了错误信息......这很好吗？仍然不确定他们大肆吹嘘的“升级”脚本做了什么......它只是改变了文件名？真的吗？

> 警告（2）：file_put_contents（/cake_install/app/tmp/logs/error.log）：无法打开流：权限被拒绝 [CORE/Cake/Log/Engine/FileLog.php，第 69 行]
> 
> 注意 (1024)：请将 app/Config/core.php 中“Security.cipherSeed”的值更改为特定于您的应用程序的数字（仅限数字）种子值 [CORE/Cake/Utility/Debugger.php，第 810 行]
> 
> 致命错误：在第 31 行的 /cake_install/lib/Cake/View/Helper/HtmlHelper.php 中找不到类“AppHelper”

好的，所以我 777 /cake_install/app/tmp/logs/ 文件夹（chmod 777 -R folderHere）和

...我猜我从未升级过密码种子。好的，编了一个新号码！（你问密码种子有什么作用？嗯，嗯，bing 没有多大帮助 - 我读了代码。似乎用于从 cookie 中加密/解密？好吧，我可以忍受）

引导程序.php

我将 zip 文件中的引导程序移到了我的版本中（感谢一点，升级脚本！）。还没有做任何改变，我想我需要加载插件......我相信这是有据可查的（哈！）

所以这给我留下了这个错误：

> 致命错误：在第 31 行的 /cake_install/lib/Cake/View/Helper/HtmlHelper.php 中找不到类“AppHelper”

当然，大肆吹嘘的蛋糕升级器未能进行另一次升级。查看此页面： [http ://book.cakephp.org/2.0/en/appendices/2-1-migration-guide.html](http://book.cakephp.org/2.0/en/appendices/2-1-migration-guide.html)

好的，所以现在我必须制作文件 - 就像它们在那个页面中一样。唯一的技巧是，是的，它在 app 文件夹中，不，我的 cakePhp 制作的 app/View 文件夹没有“Helper”子文件夹......所以对于 AppHelper.php，我必须制作一个 Helper /app/View/ 下的子文件夹。

...

嘿！现在我得到一个背景和一个标志......还有这些：

> 注意（8）：未定义变量：loggedIn [APP/pages/top_menu.html，第 3 行]
> 
> 注意（8）：未定义变量：html [APP/pages/top_menu.html，第 25 行]
> 
> 致命错误：在第 25 行的 /cake_install/app/pages/top_menu.html 中的非对象上调用成员函数 link()

伟大的。某种很酷的新蛋糕 2 功能意味着我不能使用 $html？这似乎......奇怪的合适，真的。

难以置信的。现在我需要改变 $this->data 的工作方式？？？为什么？？为什么？？为什么这群人不能弄清楚 api 往往是固定的合同，而不是浮动的想法……啊。没关系，我现在最常用的蛋糕生产线是……错了。从现在开始，我正在使用 scala 或 django 进行开发，初级语言很烂。

这是我跑的： find . -type f -exec sed -i 's/$this->data/$this->request->data/g' {} \;

我去了 /app 目录这样做。这个 2.1 ......最好是真的很棒......每个人都必须做的工作量才能让它起来。我想，这是与初级语言一起工作的正常一天吗？

啊太棒了，$html 问题是因为有人不喜欢小写字母造成的？只能想知道： [在 CakePHP 2.0 中使用 Html Helper 时未定义的 var](https://stackoverflow.com/questions/7162405/undefined-var-when-using-html-helper-in-cakephp-2-0) 解决方案是：（感谢 SO 中的另一篇文章）

> 寻找 。-type f -exec sed -i 's/$html/$this->Html/g' {} \;

$session 自然也有同样的问题——

寻找 。-type f -exec sed -i 's/$session/$this->Session/g' {} \;

...

事情正在发生！现在我有一个难以理解的错误：

> 找不到控制器类 PagesController。

哦，为了爱......所以我需要移动在这里找到的 PagesController：

lib/Cake/Console/Templates/skel/Controller/PagesController.php

并把它放在这里

应用程序/控制器/

再一次，Cake 安装程序/升级程序似乎在工作中睡着了。

现在我有

找不到帮助程序类 JavascriptHelper。

这还不错 - 您不会找到对“JavascriptHelper”的任何引用，但您会在“$helpers”数组中找到对“Javascript”的引用。后端添加了 Helper 一词以进行额外的混淆。无论如何，我在我的 php 文件中搜索了任何 $helpers 数组，并在 AppController(2.1) 类中找到了一个。

我不喜欢也不理解帮手——反正是javascript——所以我从来没有用过它们。我一定是在某个时候盲目地遵循了一个教程并将它添加到......但我不需要它，所以它出去了！

现在我需要清理我拥有的所有 ctp 文件，在那里我使用了“require”来确保使用了正确的 html。再一次，我将使用上面的 find 命令（将它们指向“视图”而不是“视图”文件夹）叹息。好吧，不，没那么简单，是吗？我以前在哪里：

要求（应用程序/视图/页面/man_front.html）

我现在需要：

要求（/cake_folder/app/View/Pages/man_front.html）

（蛋糕文件夹是我所有蛋糕的地方。不确定为什么会这样，但一个简单的查找修复了它：

```
find . -type f -exec sed -i 's/app\/View\/Pages/\/cake_folder\/app\/View\/Pages/g' {} \; 
```

（\ 将“削弱”一个 /）

好的，完成所有这些并让您的网站达到某种可接受的水平，下一步是什么？好吧，您现在可能会发现一些数据库问题：

> 警告 (2): mysqli::mysqli() 期望参数 1 是字符串，数组给定 [CORE/Cake/Model/ConnectionManager.php, line 101]
> 
> 致命错误：在第 3383 行的 /cake_install/lib/Cake/Model/Model.php 中调用未定义的方法 mysqli::getSchemaName()

当然，不再支持mysqli。编辑 database.php 以使用 mysql 代替（即我刚刚删除了结尾的“i”）

（cakephp 中的窥视有什么问题？？？ API 的意思是“如果它会破坏现有代码，就永远不要更改所有内容。”而不是“更改！OBAMAAAAA！”〜下一次升级，我会将我所有的代码推送到 django或弹簧或斯卡拉。红润的胡说八道。）

下一个问题是我正在使用的“组件” - 我收到一个蛋糕错误说：

> 缺少插件
> 
> 错误：应用程序正在尝试从 Uploader 插件加载文件
> 
> 错误：确保您的插件 Uploader 位于 app/Plugin 目录中并已加载

```
<?php
CakePlugin::load('Uploader'); 
```

> 加载所有插件：如果您希望一次加载所有插件，请在 app/Config/bootstrap.php 文件中使用以下行

```
CakePlugin::loadAll(); 
```

所以......不仅我的所有代码都被破坏了，而且所有旧插件也被破坏了？好的。

解决方案是创建一个 app/Plugin 文件夹（是的，魔法升级程序也不这样做），然后查看您拥有的插件。现在！这与您的组件不同！我还不知道怎么做 - 查看我的问题以获得可能的答案：[cakephp 2.1 中“组件”和“插件”之间的区别？](https://stackoverflow.com/questions/10094460/difference-between-a-component-and-a-plugin-in-cakephp-2-1)- 但现在，我们只是查看“PLUGIN”文件夹和一般的插件。看起来，在 cake 1.3 中，插件是这样列出的：

> var $components = array('Uploader.Uploader',...);

也就是说，使用点符号。我可以忍受这一点。就我而言，我需要获取最新版本的 Uploader 插件（谢天谢地，它已升级为与 2.x 兼容！）并将其放在 app/Plugin 文件夹中

所以我得到了：

```
app
    Plugin
        Uploader
            Config
            Locale
            <the other files here too!> 
```

这似乎现在有效，万岁！

下一个错误是：

> 警告 (2)：为 foreach() 提供的参数无效 [CORE/Cake/Utility/Set.php，第 1048 行]
> 
> 警告 (2): array_multisort() [ [http://php.net/function.array-multisort]](http://php.net/function.array-multisort]) : 参数 #1 应该是一个数组或一个排序标志 [CORE/Cake/Utility/Set.php，第 1087 行]
> 
> 警告 (2)：array_unique() 期望参数 1 为数组，给定 null [CORE/Cake/Utility/Set.php，第 1089 行]
> 
> 警告 (2)：为 foreach() 提供的参数无效 [CORE/Cake/Utility/Set.php，第 1091 行]
> 
> 警告 (2)：无法修改标头信息 - 标头已由（输出开始于 /cake_install/lib/Cake/Utility/Debugger.php:761）[CORE/Cake/Network/CakeResponse.php，第 395 行]

啊，那好吧。这很清楚。我很高兴我知道我的代码中的错误是什么。很好的错误信息！

现在我明白了，愚蠢的我认为如果第一个数组为空，实用程序 Set::Sort 将继续工作！确实，cakephp 人不是站在巨人的肩膀上，而是站在他们的额头上。

似乎新的 2.1 升级取消了这种破旧的做法，所以现在我需要在任何 Set:Sort 调用之前进行检查，以避免相关数组为空或 null。美好的。很简单，但是……哎呀。

*   我刚投了一个

    if (!empty($theArray)){ Set::sort($theArray,...); }

这解决了这个问题。

现在我收到 FormHelper 错误 - 视图中的 $form 现在看起来变成了 $this->Form，所以我有另一个快速脚本来替换它：

> 寻找 。-type f -exec sed -i 's/$form/$this->Form/g' {} \;

现在我得到的下一个错误是：

> 致命错误：第 1804 行的 /cake_install/lib/Cake/View/Helper/FormHelper.php 中不支持的操作数类型

现在他们已经搞砸了 FormHelper 中的“选择”方法 - 所以之前，我有这个：

> echo $this->Form->select('treatment_id', $treatments, null, array('empty' => '-- 选择要评分的治疗 -- '));

我现在有这个：

> echo $this->Form->select('treatment_id',$treatments, array('empty' => '-- 选择要评分的治疗 -- '));

现在我的一个组件——实际上，You_tube_loader_component——坏了。我需要修改它，以便标题显示：

```
class YouTubeLoaderComponent extends Component {
    function __construct(ComponentCollection $collection, $settings = array()) {
        parent::__construct($collection, $settings);
        ...
    }
} 
```

以前我只是默认了 uname 和密码的值 - 现在我把它们放在“...”部分而不是搞乱神秘的“设置”数组！

接下来是：

> 警告 (2)：非法偏移类型 [CORE/Cake/Model/Model.php，第 2689 行]
> 
> 警告 (2)：非法偏移类型 [CORE/Cake/Model/Model.php，第 2665 行]

Soooo 这是一个在 cake 1.3 中没有出现的问题，但在 2.1 中

问题是在被引用的控制器动作中，有一个没有类型参数的“查找”调用。也就是说，我有

> $results = $this->User->find(array(...), array(...), null, false);

我应该有的地方：

```
$results = $this->User->find('first',array(
    'conditions' => array("User.id" => ($this->Auth->user("id"))),
    'fields' => array("User.confirmed") 
)
); 
```

我遇到的另一个问题是，无论出于何种原因，检查：

> $this->set('loggedIn', $this->Auth->user('id'));

不工作。显然（虽然我不确定如何/为什么），2.x 中的 cakePHP 身份验证将不再将所有用户的详细信息存储到会话中。我不知道*它将哪些*详细信息存储到会话中，或者如何修改它们 - 调查一下！- 但我的代码没有保存“id”值，所以上面的检查总是将loggedIn值设置为false。

为了补救，我将调用修改为：

> $this->set('loggedIn', $this->Auth->loggedIn());

这对我来说很好。

下一个问题是 thios->auth->user('id') 在登录用户后不会给我任何回报。幸运的是，我遇到了这篇文章，这让事情变得更清楚了：

> [http://ask.cakephp.org/questions/view/unable_to_access_logged-in_users_data_in_2_0](http://ask.cakephp.org/questions/view/unable_to_access_logged-in_users_data_in_2_0)

令人惊讶的是，蛋糕实验室的天才们认为改变登录的工作方式将有助于消除一些困惑。老实说，我唯一感到困惑的是，谁对 auth 组件在登录后拥有所有用户的详细信息这一事实如此困惑。但不要害怕，他们已经消除了混乱并......删除了该功能完全。

那么，你要做什么？上面的链接建议获取所有用户详细信息，然后将其发送到身份验证登录部分。我不是特别喜欢这个（因为这是一个愚蠢的问题，我无法相信需要如此不雅的东西），但这是我必须做的。欢迎提出建议！

所以而不是哦，那么令人困惑：

```
if ($this->Auth->login($this->request->data)) {
    ... //argh! I am so confused by that line above!!!1 
```

我现在有：

```
$user = $this->User->find('first', array(
    'conditions' => array('User.email' =>   $this->request->data['User']['email'])
    )
);
// Use the AuthComponent~Rs login action
if ($this->Auth->login($user['User'])) {
    ... //omg the extra check that the entry is in the db is just brilliant and efficient 
```

这不是更整洁，更不混乱吗？干得好，cakephp 小牛！

下一个错误是

> 未找到授权适配器“控制器”。

哪个有点模糊...

啊! 此处已在堆栈溢出时回答： [在 cakePHP 中未找到授权适配器](https://stackoverflow.com/questions/10184388/authorization-adapter-was-not-found-in-cakephp)

就是这样！可能还有其他问题 - 上帝的速度 - 但我没有遇到它们，所以我不能再帮助你了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T06:30:43.447

您可能在`app/webroot/index.php`. Cake 2.0 的目录结构略有改变，通常这将由新代码处理，该代码会自动为`CAKE_CORE_INCLUDE_PATH`. 另外，请确保在同一文件`APP_DIR`中正确设置。`index.php`

确保`app/webroot/index.php`包含正确的 Cake 路径，即`/path/to/cake/lib`.

```
if (!defined('CAKE_CORE_INCLUDE_PATH')) {
  define('CAKE_CORE_INCLUDE_PATH', DS.'path'.DS.'to'.DS.'cake'.DS.'lib');
} 
```

`define('CAKE_CORE_INCLUDE_PATH', ROOT)`如果 Cake 的设置方式不是太定制，那么恢复到标准也可能会起作用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-06T14:32:39.553

这是我关于从 1.3 迁移到 2.x 的博客文章：[http ://www.forceflow.be/2011/11/12/migrating-from-cakephp-1-3-to-2-0/](http://www.forceflow.be/2011/11/12/migrating-from-cakephp-1-3-to-2-0/)

为了将来参考，我在此处包含了该帖子的内容。享受！

**入门**

有几种更新方法，但对于中小型项目，我发现最好解压缩新的 CakePHP 2 结构，然后手动将控制器和视图复制到它们的新文件夹中。请注意，文件夹结构已发生重大变化。例如，控制器映射现在是控制器。注意你复制文件的位置——不要担心文件名本身，我们稍后会谈到。

确保使用应用程序的值更新 core.php 和 database.php（现在位于 (cakephp root)/app/Config）。确保也复制旧安装中的 salt 和 cipherseed 值，因为当您使用默认值时，CakePHP 会继续抱怨——这是一个安全风险。此外，为了使数据库连接重新启动并运行，语法已更改：

```
'driver' => 'mysqli' 
```

变成

```
'datasource' => 'Database/Mysql' 
```

**批量工作：通过控制台升级**

为了将所有应用程序文件重命名为新的 CakePHP 文件结构，有一个控制台命令。CakePHP 2.0 的新功能是现在每个应用程序都有自己的控制台。导航到 /app/Console 中的应用程序控制台（不是 /lib/Cake 中的控制台！），通过对其执行 chmod +x 确保控制台命令是可执行的，然后执行：

```
./cake upgrade all 
```

这会将所有文件重命名为新的蛋糕标准，并更新 PHP 代码中的所有引用。

**打扫干净**

不幸的是，这还没有结束。您的代码现在运行良好的可能性很小。查看 CakePHP 2.0 迁移指南以获取更多信息。我将在这里总结一下我处理得最多的问题：

在您看来，您现在必须通过*$this*对象来处理 Helper 类。例如，不再调用

```
$html->link( 
```

， 它的

```
$this->Html->link( 
```

现在，先生。

还：

*   *JavascriptHelper*现在称为 JsHelper。
*   *Auth*组件发生了显着变化。使用组件时不会自动添加*login()*操作，您现在必须手动指定它。查看新的 Auth 组件文档以获取更多信息。

*AjaxHelper*以及用于 AJAX 样式搜索的便捷功能（如 observefield ）已被*删除*。我已经使用 jQuery 制作了自己的*观察域*——使用风险自负。我序列化了一个表单，在这种情况下，它包含一个查询输入框，允许我对预订进行实时搜索和更新。

```
$this->Js->get('#query')->event('keyup', $this->Js->request(
array('controller' => 'sales','action' => 'searchReservations', $event['Event']['id']),
array(
'update' => '#view',
'async' => true,
'dataExpression' => true,
'method' => 'post',
'data' => $this->Js->serializeForm(array('isForm' => false, 'inline' => true))) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-07T18:27:06.500

使用 Cake Shell 升级工具后，我遇到了同样的问题。虽然我们的 Web 应用程序很大，但我们从未自定义 index.php 文件。

用新下载的 CakePHP **cakephp-2.3.4/app/webroot/index.php**替换我们的**myapp/app/webroot/index.php**为我解决了这个问题。

 **我不确定为什么[CakePHP 升级外壳](http://book.cakephp.org/2.0/en/console-and-shells/upgrade-shell.html)或其说明没有指定更改 index.php 文件，但正如@bharal 冗长而出色的答案所示，由于升级外壳没有，还有很多工作要做做任何事。**

# android - 我该怎么做？（Android Whack-A-Mole）

> ID：10022105
> 
> 赞同：0
> 
> 时间：2012-04-05T03:00:08.813
> 
> 标签：android, xml, animation, selector, drawable

我正在制作一个简单的打地鼠游戏作为我的第一个安卓迷你项目。我不知道该怎么做。我知道设置一切的基础知识等等，但我不知道如何为鼹鼠设置动画并制作它，以便当鼹鼠处于向上位置时可以轻敲它并计算一个点。我知道我可以做一个图像按钮并使计数器上升（计数器++），但我需要能够将帧从孔中的痣切换到向上位置的痣。我被告知要使用一种称为选择器的可绘制对象或某种 xml 动画，但我不太明白该怎么做。如果有人可以为我提供某种示例，我将不胜感激，或者如果有人能指出我正确的方向。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:03:44.210

使用游戏引擎。两个最受欢迎的（在我看来）引擎是[AndEngine](http://www.andengine.org/)和[LibGDX](http://code.google.com/p/libgdx/)。前者更适合初学者，是一个完整的引擎，而后者更多是面向中高级开发人员的框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T09:21:48.563

我之前创建了一个简单的打鼹鼠游戏。为了便于查看，我将用项目符号格式写出来：

```
- First, you have to set a 3 cols and 4 rows table (depends on you).
- Place a picture of a hole in every cell, a total of 12 images.
- You have to place those images in an array.
- The logic is to create a timer and for every tick there's a for loop that reads the array.
- In each array, there's a random boolean generator.
- If it is true, change the picture in that array to a hole with a mole appearing
- If it is false, change the picture to a hole without a mole
- To sum it all up: Every tick, it will loop all the picture(array) and randomize each whether it's true or false. Depending on the value, the picture changes. 
```

# recursion - 如何消除这种递归？

> ID：10022110
> 
> 赞同：0
> 
> 时间：2012-04-05T03:00:51.043
> 
> 标签：recursion, real-time, go, stackless

这比简单的左递归或尾调用递归要复杂一些。所以我想知道如何消除这种递归。正如您在下面看到的，我已经保留了自己的堆栈，因此该函数不需要参数或返回值。但是，它仍在将自身向上（或向下）调用到某个级别，我想将其变成一个循环，但现在已经为此挠头了一段时间。

这是简化的测试用例，用 printf("dostuff at level #n") 消息替换所有“真实逻辑”。这是在 Go 中，但该问题适用于大多数语言。使用循环和 goto 是完全可以接受的（但我玩过这个，它变得令人费解、失控并且一开始似乎不可行）；但是，应避免使用额外的辅助函数。我想我应该把它变成某种简单的状态机，但是......哪个？;)

至于实用性，这是以每秒大约 2000 万次的速度运行（稍后堆栈深度的范围可以从 1 到 25 最大）。在这种情况下，维护我自己的堆栈必然比函数调用堆栈更稳定/更快。（此函数中没有其他函数调用，只有计算。）此外，没有垃圾生成 = 没有垃圾收集。

所以这里是：

```
func testRecursion () {
    var root *TMyTreeNode = makeSomeDeepTreeStructure()
    // rl: current recursion level
    // ml: max recursion level
    var rl, ml = 0, root.MaxDepth
    // node: "the stack"
    var node = make([]*TMyTreeNode, ml + 1)

    // the recursive and the non-recursive / iterative test functions:
    var walkNodeRec, walkNodeIt func ();

    walkNodeIt = func () {
        log.Panicf("YOUR ITERATIVE / NON-RECURSIVE IDEAS HERE")
    }

    walkNodeRec = func () {
        log.Printf("ENTER LEVEL %v", rl)
        if (node[rl].Level == ml) || (node[rl].ChildNodes == nil) {
            log.Printf("EXIT LEVEL %v", rl)
            return
        }
        log.Printf("PRE-STUFF LEVEL %v", rl)
        for i := 0; i < 3; i++ {
            switch i {
            case 0:
                log.Printf("PRECASE %v.%v", rl, i)
                node[rl + 1] = node[rl].ChildNodes[rl + i]; rl++; walkNodeRec(); rl--
                log.Printf("POSTCASE %v.%v", rl,  i)
            case 1:
                log.Printf("PRECASE %v.%v", rl, i)
                node[rl + 1] = node[rl].ChildNodes[rl + i]; rl++; walkNodeRec(); rl--
                log.Printf("POSTCASE %v.%v", rl,  i)
            case 2:
                log.Printf("PRECASE %v.%v", rl, i)
                node[rl + 1] = node[rl].ChildNodes[rl + i]; rl++; walkNodeRec(); rl--
                log.Printf("POSTCASE %v.%v", rl,  i)
            }
        }
    }

    // test recursion for reference:
    if true {
        rl, node[0] = 0, root
        log.Printf("\n\n=========>RECURSIVE ML=%v:", ml)
        walkNodeRec()
    }

    // test non-recursion, output should be identical
    if true {
        rl, node[0] = 0, root
        log.Printf("\n\n=========>ITERATIVE ML=%v:", ml)
        walkNodeIt()
    } 
```

}

**更新**——经过这里的一些讨论，并进一步思考：

我刚刚编写了以下伪代码，理论上*应该*可以满足我的需要：

```
curLevel = 0
for {
    cn = nextsibling(curLevel, coords)
    lastnode[curlevel] = cn
    if cn < 8 {
        if isleaf {
            process()
        } else {
            curLevel++
        }
    } else if curLevel == 0 {
        break
    } else {
        curLevel--
    }
} 
```

当然，棘手的部分是为我的自定义用例填写 nextsibling() 。但就像在保持我需要的深度优先遍历顺序的同时消除内部递归的一般解决方案一样，这个粗略的轮廓应该以某种形式这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:43:16.983

我不确定我是否理解您想要做什么，因为您的递归代码看起来有点奇怪。但是，如果我了解您的 TMyTreeNode 的结构，那么这就是我将为非递归版本所做的。

```
// root is our root node
q := []*TMyTreeNode{root}
processed := make(map[*TMyTreeNode]bool
for {
  l := len(q)
  if l < 1 {
    break // our queue is empty
  }
  curr := q[l - 1]
  if !processed[curr] && len(curr.childNodes) > 0 {
    // do something with curr
    processed[curr] = true
    q = append(q, curr.childNodes...)
    continue // continue on down the tree.
  } else {
    // do something with curr
    processed[curr] = true
    q := q[:l-2] // pop current off the queue
  }
} 
```

注意：这将任意深入结构。如果这不是您想要的，则需要进行一些修改。

# java - sun.awt.geom.Crossings 有什么作用？

> ID：10022115
> 
> 赞同：3
> 
> 时间：2012-04-05T03:01:22.117
> 
> 标签：java, awt

我已经离开 Java 好几年了，所以请原谅我的生锈。我继承了一些针对 Java SE 1.5 的代码。在 Java 1.7.0 下构建时，文本中有几个构建警告：

> Crossings 是内部专有 API，可能会在将来的版本中删除。

我想纠正这个构建警告，可能通过用我自己的代码替换这个代码。在检查代码时，我看到有问题的完整类是`sun.awt.geom.Crossings`. 当然，[OpenJDK 代码](http://hg.openjdk.java.net/jdk6/jdk6/jdk/file/2d585507a41b/src/share/classes/sun/awt/geom/Crossings.java)是可用的，但我不了解该类的总体目的或其具体实现。目的是`sun.awt.geom.Crossings`什么？在哪里可以找到更多文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T16:47:21.780

自从@ee。还没有回来重写他或她的评论作为答案，我会在这里这样做。@ee.，如果你停下来，我很乐意用你的答案打勾。

检查这个[http://docstore.mik.ua/orelly/java/awt/ch02_01.htm#JAWT-CH-2-FIG-9](http://docstore.mik.ua/orelly/java/awt/ch02_01.htm#JAWT-CH-2-FIG-9)：

> > 填充多边形是一个复杂的话题。它不像填充矩形或椭圆那么容易，因为多边形可能不是闭合的，它的边缘可能会交叉。AWT 使用奇偶规则来填充多边形。该算法通过计算每条扫描线穿过多边形边缘的次数来工作。如果当前点左侧的交叉点总数为奇数，则该点为彩色。如果它是偶数，那么这一点就不管了。

你可以看到这里使用了 Crossings 类；例如：Area.contains() 检查区域内矩形区域的交叉点。在[http://kickjava.com/src/java/awt/geom/Area.java.htm](http://kickjava.com/src/java/awt/geom/Area.java.htm)。由于它的应用主要是在其他常用的类中使用，所以你不必太担心。但是，如果你直接使用它，那么你以后可能会遇到问题！

# php - 为什么 memory_get_usage() 会在一行代码中使用这么多内存？

> ID：10022116
> 
> 赞同：1
> 
> 时间：2012-04-05T03:01:30.023
> 
> 标签：php, memory

我开始担心内存使用情况，所以我决定插入 memory_get_usage() 来检查我的页面使用了多少内存。我最终在一个页面中有将近 16MB。但最奇怪的是，我制作了一个页面只是为了测试它，而使用这一行代码的页面需要超过 15MB：

```
Total memory used: <?php echo memory_get_usage(); ?> 
```

该单行使用 15072216 的内存。

我在[其他页面](https://stackoverflow.com/questions/4010781/php-memory-get-usage)中看到，最初分配一些内存是正常的……比如 300k 左右。但是我分配的内存大约是那个的 40 倍。这是正常限制之间的内存使用量还是我应该联系网络主机管理员？我正在使用 000webhost.com 和 php 5.2。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T08:48:07.933

这是因为 PHP 总是会在不知道需要哪一个（如果有的话）的情况下加载它的所有扩展。因此，您安装的附加组件越多，每次执行脚本时 PHP 分配的内存就越多。

# c++ - 为什么要在 C++ 中使用 std::string 而不是 c 风格的字符串？

> ID：10022117
> 
> 赞同：16
> 
> 时间：2012-04-05T03:01:35.797
> 
> 标签：c++, string, c-strings

“人们应该始终使用**[std::string](http://www.cplusplus.com/reference/string/string/)**而不是 c 风格的 strings( `char *`)”是几乎所有发布在此处的源代码的建议。虽然建议无疑是好的，但要解决的实际问题不允许详细说明**为什么？**方面的建议详细。这个问题是作为相同的占位符。

一个好的答案应该包括以下几个方面（详细）：

1.  为什么要`std::string`在 C++ 中使用 c 风格的字符串？
2.  中提到的做法有哪些缺点（如果有的话）`#1`？
3.  在哪些情况下，与中提到的建议相反`#1`是一种好的做法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-05T03:05:09.710

1.  std::string 管理自己的内存，因此您可以轻松地复制、创建、销毁它们。
2.  您不能将自己的缓冲区用作 std::string。
3.  您需要将 ac 字符串/缓冲区传递给期望获得缓冲区所有权的东西 - 例如第 3 方 C 库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T03:12:55.683

好吧，如果您*只*需要一个字符数组，std::string 几乎没有什么优势。但面对现实，这种情况多久发生一次？通过使用像 std::string 这样的附加功能包装一个 char 数组，您可以获得某些操作的功率和效率。

例如，确定字符数组的长度需要“计数”数组中的字符。相比之下，std::string 为这个特定任务提供了有效的操作。（见[https://stackoverflow.com/a/1467497/129622](https://stackoverflow.com/a/1467497/129622)）

1.  为了动力、效率和理智
2.  比“仅”一个字符数组更大的内存占用
3.  当您*只*需要一个字符数组时

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T07:54:14.833

3)当然，*总是*使用`string`的建议必须带有一点常识。字符串文字是`const char[]`，如果你将文字传递给一个接受`const char*`（例如`std::ifstream::open()`）的函数，那么将它包装在`std::string`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T21:15:02.943

char* 基本上是指向字符的指针。C 所做的是经常使这个指针指向数组中的第一个字符。

std::string 是一个很像向量的类。在内部，它处理字符数组的存储，并为用户提供几个成员函数来操作所述存储数组以及几个重载运算符。

在 std::string 上使用 char* 的原因：

```
C backwards-compatibility.
Performance (potentially).
char*s have lower-level access. 
```

在 char* 上使用 std::string 的原因：

```
Much more intuitive to use.
Better searching, replacement, and manipulation functions.
Reduced risk of segmentation faults. 
```

例子 ：

char* 必须与 char 数组或动态分配的 char 数组结合使用。毕竟，一个指针是毫无价值的，除非它真的指向某个东西。这主要用在 C 程序中：

```
char somebuffer[100] = "a string";
char* ptr = somebuffer;  // ptr now points to somebuffer
cout << ptr; // prints "a string"
somebuffer[0] = 'b';  // change somebuffer
cout << ptr;  // prints "b string" 
```

请注意，当您更改“somebuffer”时，“ptr”也会更改。这是因为 somebuffer 在这种情况下是实际的字符串。ptr 只是指向/引用它。

使用 std::string 就不那么奇怪了：

```
std::string a = "a string";
std::string b = a;
cout << b;  // prints "a string"
a[0] = 'b';  // change 'a'
cout << b;  // prints "a string" (not "b string") 
```

在这里，您可以看到更改 'a' 不会影响 'b'，因为 'b' 是实际的字符串。

但实际上，主要区别在于，对于 char 数组，您负责管理内存，而 std::string 为您完成。在 C++ 中，几乎没有理由在字符串上使用 char 数组。100 次中有 99 次你最好用一根绳子。

在您完全了解内存管理和指针之前，只需省去一些麻烦并使用 std::string。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-07-26T13:22:52.830

> 为什么要在 C++ 中使用 std::string 而不是 c 风格的字符串？

主要原因是它使您无需管理字符串数据的生命周期。您可以将字符串视为值，让编译器/库担心管理内存。

手动管理内存分配和生命周期是乏味且容易出错的。

> #1 中提到的做法有哪些缺点（如果有的话）？

您放弃了对内存分配和复制的细粒度控制。这意味着您最终会选择由您的工具链供应商选择的内存管理策略，而不是选择与您的程序需求相匹配的策略。

如果您不小心，最终可能会出现大量不需要的数据复制（在非引用实现中）或引用计数操作（在引用计数实现中）

在混合语言项目中，任何参数使用 std::string 的函数或任何包含 std::string 的数据结构都不能直接从其他语言中使用。

> 在哪些情况下，与 #1 中提到的建议相反是一种好的做法？

不同的人对此会有不同的看法，但IMO

*   对于函数参数，在“const char *”中传递字符串是一个不错的选择，因为它避免了不必要的复制/引用，并为调用者提供了关于它们传递的内容的灵活性。
*   对于用于与其他语言互操作的东西，您别无选择，只能使用 c 风格的字符串。
*   当您有已知的长度限制时，使用固定大小的数组可能会更快。
*   在处理非常长的字符串时，最好使用一个肯定会被引用而不是复制的结构（例如包装在 shared_ptr 中的字符数组），或者实际上完全使用不同类型的数据结构

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-04-13T17:35:14.023

一般来说，您应该始终使用 std::string，因为它不太容易出错。请注意，std::string 的内存开销很大。最近我做了一些关于 std::string 开销的实验。一般来说，它大约是 48 字节！文章在这里：http: [//jovislab.com/blog/](http://jovislab.com/blog/?p=76) ?p=76 。

# java - java中所有可能大小的所有可能排列

> ID：10022126
> 
> 赞同：1
> 
> 时间：2012-04-05T03:02:41.573
> 
> 标签：java, algorithm, vector

假设我有数字 1、2、3。为了采用所有可能大小的所有可能排列，该算法会是什么样子。输出：

`1, 2 ,3 | 3, 2 ,1 | 2, 1 ,3 | 1, 3, 2 ... | 1, 2 | 2, 1 | 3, 1 |..... 1 | 2 | 3`

你会做正常的排列算法并输入每个数量的字母作为子问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:26:39.807

您需要生成所有可能的子集并排列它们。

伪代码（遵循 C++）

```
generate (a[]) {
    int size = a.size;
    sort(a)
    for (i = 1; i < (1<<size); i++) {
        b[];
        for (j = 0; j < size; j++) {
            if (i&(1<<j)) {
                add a[j] to b;
            }
        }

        do {
            for (i=0 to b.size) {
                print b[i];
            }
        }while(next_permutation(b.begin(), b.end());
    }
} 
```

# jquery - 浏览器缩放时查找任何 DOM 元素的实际高度

> ID：10022134
> 
> 赞同：0
> 
> 时间：2012-04-05T03:03:38.487
> 
> 标签：jquery, dom, height, zooming

有什么方法可以找到在 DOM 上呈现的元素的高度。

即使我放大/缩小，它也应该给我元素的实际高度。目前我使用过：

**HTML：**

```
<div >
    <span><img src="Desert.jpg" style="border:none;width:100px" id="imgdiv"/></span>
    <br/>
    <input type="button" id="heightcalc" value="Find Height" />
</div> 
```

**jQuery：**

```
$('#heightcalc').click(function(){
    alert($('#imgdiv').height());
}); 
```

现在使用 100% 缩放图像的高度为 75。使用 200%/300%/400% 缩放，高度相同，即 75。我的要求是每当我增加缩放时，高度也应该改变。有什么办法可以找到图像的相对高度。我在 IE9、Chrome/Firefox 中试过这个——结果是一样的。

此外，我确实尝试了 clientHeight、offsetHeight、outerHeight 没有运气！

任何帮助是极大的赞赏。

谢谢阿尼尔班

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:33:58.623

我使用以下方法计算所有浏览器的缩放效果：

[https://github.com/yonran/detect-zoom](https://github.com/yonran/detect-zoom)

通过这个可以得到乘法因子，然后将该因子乘以元素的实际高度。

这是代码：请注意，我正在为我们的应用程序使用 require js。

```
require(["Widgets/detectzoom"], function (detectZoom) {
                zoom = detectZoom.ratios();
            });

            var heightofeachNode = ($("#dmcontent  ul li a span").eq(0).height()) * zoom.devicePxPerCssPx;
            self.pageSize = Math.round(($("#dmcontent").height()) / heightofeachNode) + 20 ;//20 - Its is the offset value 
```

我已经在所有浏览器中测试过 [IE9, Chrome18.0, FF 11.0]

希望这可以帮助。

阿尼尔班

# javascript - 将javascript字符串转换为对象方法并调用它？

> ID：10022135
> 
> 赞同：1
> 
> 时间：2012-04-05T03:03:41.817
> 
> 标签：javascript

我遇到了一些代码，它允许您将函数名称的字符串转换为函数并使用它：

```
var strFun = "someFunction";
var strParam = "this is the parameter";

//Create the function
var fn = window[strFun];

//Call the function
fn(strParam); 
```

我想知道是否有办法对对象方法做同样的事情，例如：

```
var fn = window["onclick"];
var body = document.body;
body.onclick = function() {
    alert('yo');
}
// This won't work [Uncaught TypeError: Object #<HTMLBodyElement> has no method 'fn']
body.fn(); // expecting body.onclick(); via substitution of fn with a onclick function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T03:15:05.887

我想你正在寻找：

```
var body = document.body;
body.onclick = function() {
    alert('yo');
}

var strfun = 'onclick';
var fn = body[strfun];
fn(); 
```

调用body的onclick函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T03:08:34.023

您可以在对象的上下文中调用该函数：

```
fn.call(your object); 
```

# mysql - 有没有办法在 MySQL 中设置代表“n/a”的字符？

> ID：10022139
> 
> 赞同：3
> 
> 时间：2012-04-05T03:04:01.107
> 
> 标签：mysql

我正在使用一个使用句点“。”的 CSV 文件。符号来表示一个空值。例如，

```
item  weight  unit_price
 1      5.1       10
 2      .         20
 3      7.5       30
 4      .         40
 5      2.0       50 
```

使用以下命令将其读入 MySQL (v. 5.5) 中的表：

```
CREATE TABLE products(
  item SMALLINT NOT NULL,
  weight float DEFAULT NULL,
  unit_price SMALLINT);

LOAD DATA INFILE ".../data.txt"
IGNORE
INTO TABLE products
FIELDS TERMINATED BY ","
LINES TERMINATED BY "\r\n"
IGNORE 1 LINES; 
```

LOAD DATA 块中的 IGNORE 关键字强制转换 '.' 到 0 - 有没有办法可以将它设置为 NULL 呢？

我尝试过的唯一解决方法是：

```
LOAD DATA INFILE ".../data.txt"
IGNORE
INTO TABLE products
FIELDS TERMINATED BY ","
LINES TERMINATED BY "\r\n"
IGNORE 1 LINES
(item,
 @weight,
 unit_price
)
SET
 weight = if(@weight = '.', NULL, @weight); 
```

然而，我正在使用的实际数据有超过 1000 万行和 15 列，其中 '.' 用于表示空值。有没有更简洁的方法默认为空？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T17:57:17.987

使用 csv 中的查找和替换工具取出 . 并用 ""(nothing) 替换，然后当你加载它时，它会自动为重量列下的那一行输入 NULL

# python - 以多种方式控制子进程（特别是 gdb）

> ID：10022141
> 
> 赞同：1
> 
> 时间：2012-04-05T03:04:24.033
> 
> 标签：python, subprocess, popen

我正在使用 python 围绕 gdb 开发一个包装器。基本上，我只是希望能够预先检测到一些设置烦恼，并能够运行单个命令来调用 gdb，而不是每次都必须记住一个巨大的字符串。

也就是说，我正在使用两种情况。第一个工作正常，通过创建一个新进程并附加到它来调用 gdb。这是我的代码：

```
def spawnNewProcessInGDB():
    global gObjDir, gGDBProcess;
    from subprocess import Popen
    from os.path import join
    import subprocess
    binLoc = join(gObjDir, 'dist');
    binLoc = join(binLoc, 'bin');
    binLoc = join(binLoc, 'mycommand')

    profileDir = join(gObjDir, '..')
    profileDir = join(profileDir, 'trash-profile')

    try:
        gGDBProcess = Popen(['gdb', '--args', binLoc, '-profile', profileDir], cwd=gObjDir)
        gGDBProcess.wait()
    except KeyboardInterrupt:
        # Send a termination signal to the GDB process, if it's running
        promptAndTerminate(gGDBProcess) 
```

现在，如果用户在它运行时按下`CTRL-C`，它就会中断（即，它会将 CTRL-C 转发到 GDB）。这是我想要的行为。

第二种情况稍微复杂一些。可能是我已经在我的系统上运行了这个程序，它崩溃了，但被抓住了。在这种情况下，我希望能够使用 gdb 连接到它以获取堆栈跟踪（或者我可能已经在运行它，我现在只想连接到已经在内存中的进程）。

作为一个方便的功能，我创建了一个镜像函数，它将使用 gdb 连接到正在运行的进程：

```
def connectToProcess(procNum):
    global gObjDir, gGDBProcess
    from subprocess import Popen
    import subprocess
    import signal

    print("Connecting to mycommand process number " + str(procNum) + "...")

    try:
        gGDBProcess = Popen(['gdb', '-p', procNum], cwd=gObjDir)
        gGDBProcess.wait()
    except KeyboardInterrupt:
            promptAndTerminate(gGDBProcess) 
```

同样，这似乎按预期工作。`CTRL-C`它启动 gdb，我可以设置断点，运行程序等。唯一的问题是，如果我在程序运行时按下它，它不会转发到 gdb。相反，它立即跳转到`promptAndTerminate()`.

我想知道是否有人能明白为什么会发生这种情况——这两个调用对`subprocess.Popen()`我来说似乎相同，尽管一个调用 gdb 以不同的模式运行。

我也尝试用`subprocess.Popen()`以下内容替换调用：

```
gGDBProcess = Popen(['gdb', '-p', procNum], cwd=gObjDir, stdin=subprocess.PIPE) 
```

但这也会导致不良结果，因为它实际上并没有与子 gdb 进程进行任何通信（例如，如果我在`c`从 gdb 连接中断后输入以启动程序再次运行，它不会做任何事情） . 同样，当我键入`CTRL-C`.

任何帮助，将不胜感激！

# linux - 通过 linux 中的 shell 脚本与正在运行的进程进行通信的标准方法

> ID：10022143
> 
> 赞同：3
> 
> 时间：2012-04-05T03:04:35.303
> 
> 标签：linux

是否有用于与长时间运行的进程进行通信的标准 linux/unix 模式？

例如，我有几百个进程，用 C++ 编写，并在各种机器上运行，我想通过 shell 脚本向它们发送一个命令，如重新加载配置、启动、停止等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T03:06:07.283

[信号。](http://en.wikipedia.org/wiki/Unix_signal)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T03:35:35.883

如果您尝试触发简单的操作，如您所描述的启动/停止/重新加载配置，最常见的方法是使用[信号](http://linux.die.net/man/2/signal)。

在您的 shell 脚本中，您可以使用该`kill`命令将特定信号发送到特定进程。在您的流程中，您将实现一个或多个信号处理程序。信号处理程序被注册以通过使用`signal()`函数或`sigaction()`函数接收一个或多个信号。

通常`SIGHUP`用于触发重新加载配置。`SIGSTOP`并且`SIGCONT`可能适合暂停和恢复。

[`man 7 signal`](http://linux.die.net/man/7/signal)将向您显示可供选择的可用信号的完整列表。

* * *

如果您需要触发更复杂的操作，您可以创建命名管道。让您的进程创建管道，并从您的 shell 脚本中，`echo`向它发送命令。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T04:53:26.927

由于您还关心远程进程，并且假设您可以修改所有程序的源代码，您可以考虑一些与它们通信的方式：

*   定义您自己的小型文本协议，并让每个进程侦听某个套接字或某个命名管道。您可能需要一些多路复用系统调用，例如[poll](http://linux.die.net/man/2/poll)

*   使用现有的库和工具，如[MPI](http://en.wikipedia.org/wiki/Message_Passing_Interface)、[Corba](http://en.wikipedia.org/wiki/Corba)或[D-Bus](http://en.wikipedia.org/wiki/D-Bus)或[ONC/RPC/XDR](http://en.wikipedia.org/wiki/Open_Network_Computing_Remote_Procedure_Call)

*   更改应用程序的配置文件，并具有信号约定，例如 catch`SIGHUP`以重新加载配置并`SIGTERM`正确终止它（但无法远程发送信号；您需要例如`ssh`某些`kill`命令）。

# arrays - Underscore.js groupBy 多个值

> ID：10022156
> 
> 赞同：24
> 
> 时间：2012-04-05T03:06:26.637
> 
> 标签：arrays, underscore.js, javascript-objects

使用 Underscore.js，我试图多次对项目列表进行分组，即

按 SIZE 分组，然后为每个 SIZE，按 CATEGORY 分组...

[http://jsfiddle.net/rickysullivan/WTtXP/1/](http://jsfiddle.net/rickysullivan/WTtXP/1/)

理想情况下，我想要一个函数或扩展[`_.groupBy()`](http://underscorejs.org/#groupBy)，以便您可以将一个数组与参数一起扔给它以进行分组。

```
var multiGroup = ['size', 'category']; 
```

应该可以做个mixin吧……

```
_.mixin({
    groupByMulti: function(obj, val, arr) {
        var result = {};
        var iterator = typeof val == 'function' ? val : function(obj) {
                return obj[val];
            };
        _.each(arr, function(arrvalue, arrIndex) {
            _.each(obj, function(value, objIndex) {
                var key = iterator(value, objIndex);
                var arrresults = obj[objIndex][arrvalue];
                if (_.has(value, arrvalue))
                    (result[arrIndex] || (result[arrIndex] = [])).push(value); 
```

我的头很痛，但我认为这里需要更多的推动......

```
 });
        })
        return result;
    }
});

properties = _.groupByMulti(properties, function(item) {

    var testVal = item["size"];

    if (parseFloat(testVal)) {
        testVal = parseFloat(item["size"])
    }

    return testVal

}, multiGroup); 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-12-13T21:48:50.577

一个简单的递归实现：

```
_.mixin({
  /*
   * @mixin
   *
   * Splits a collection into sets, grouped by the result of running each value
   * through iteratee. If iteratee is a string instead of a function, groups by
   * the property named by iteratee on each of the values.
   *
   * @param {array|object} list - The collection to iterate over.
   * @param {(string|function)[]} values - The iteratees to transform keys.
   * @param {object=} context - The values are bound to the context object.
   * 
   * @returns {Object} - Returns the composed aggregate object.
   */
  groupByMulti: function(list, values, context) {
    if (!values.length) {
      return list;
    }
    var byFirst = _.groupBy(list, values[0], context),
        rest    = values.slice(1);
    for (var prop in byFirst) {
      byFirst[prop] = _.groupByMulti(byFirst[prop], rest, context);
    }
    return byFirst;
  }
}); 
```

[在你的 jsfiddle 中演示](http://jsfiddle.net/WTtXP/25/)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-03-28T15:27:47.370

我认为@Bergi 的答案可以通过利用 Lo-Dash `mapValues` （用于将函数映射到对象值）来简化一点。它允许我们以嵌套方式通过多个键对数组中的条目进行分组：

```
_ = require('lodash');

var _.nest = function (collection, keys) {
  if (!keys.length) {
    return collection;
  }
  else {
    return _(collection).groupBy(keys[0]).mapValues(function(values) { 
      return nest(values, keys.slice(1));
    }).value();
  }
}; 
```

我将该方法重命名为，`nest`因为它最终服务于 D3 的[嵌套](https://github.com/mbostock/d3/wiki/Arrays#-nest)操作员所服务的角色。有关详细信息，请参阅[此要点](https://gist.github.com/joyrexus/9834587)，有关您的示例的演示用法，请参阅[此小提琴](http://jsfiddle.net/V7an5/2/)。

[lodash](/questions/tagged/lodash "显示标记为“lodash”的问题") [巢群](/questions/tagged/nest "显示标记为“巢”的问题") [比](/questions/tagged/groupby "显示标记为“groupby”的问题")

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-08-22T18:48:39.177

这个相当简单的hack怎么样？

```
console.log(_.groupBy(getProperties(), function(record){
    return (record.size+record.category);
})); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T21:15:54.973

查看这个下划线扩展：[Underscore.Nest](https://github.com/iros/underscore.nest)，由 Irene Ros 编写。

这个扩展的输出会和你指定的略有不同，但是这个模块只有大约 100 行代码，所以你应该可以扫描得到方向。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-12T23:36:59.257

*这是map-reduce的**reduce*阶段的一个很好的用例。它不会像多组功能那样在视觉上优雅（您不能只传递一组键来进行分组），但总体而言，这种模式为您提供了转换数据的更大灵活性。[例子](http://jsfiddle.net/tynman/djQnD/1/ "EXAMPLE")

 *```
var grouped = _.reduce(
    properties, 
    function(buckets, property) {
        // Find the correct bucket for the property
        var bucket = _.findWhere(buckets, {size: property.size, category: property.category});

        // Create a new bucket if needed.
        if (!bucket) {
            bucket = {
                size: property.size, 
                category: property.category, 
                items: []
            };
            buckets.push(bucket);
        }

        // Add the property to the correct bucket
        bucket.items.push(property);
        return buckets;
    }, 
    [] // The starting buckets
);

console.log(grouped) 
```

但是，如果您只想将它​​放在下划线 mixin 中，这是我的尝试：

```
_.mixin({
'groupAndSort': function (items, sortList) {
    var grouped = _.reduce(
        items,
        function (buckets, item) {
            var searchCriteria = {};
            _.each(sortList, function (searchProperty) { searchCriteria[searchProperty] = item[searchProperty]; });
            var bucket = _.findWhere(buckets, searchCriteria);

            if (!bucket) {
                bucket = {};
                _.each(sortList, function (property) { bucket[property] = item[property]; });
                bucket._items = [];
                buckets.push(bucket);
            }

            bucket._items.push(item);
            return buckets;
        },
        [] // Initial buckets
    );

    grouped.sort(function (x, y) {
        for (var i in sortList) {
            var property = sortList[i];
            if (x[property] != y[property])
                return x[property] > y[property] ? 1 : -1;
        }
        return 0;
    });

    return _.map(grouped, function (group) {
        var toReturn = { key: {}, value: group.__items };
        _.each(sortList, function (searchProperty) { toReturn.key[searchProperty] = group[searchProperty]; });
        return toReturn;
    });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-07T02:21:40.243

Joyrexus 对 bergi 方法的改进没有利用下划线/lodash 混合系统。这是一个混合：

```
_.mixin({
  nest: function (collection, keys) {
    if (!keys.length) {
      return collection;
    } else {
      return _(collection).groupBy(keys[0]).mapValues(function(values) {
        return _.nest(values, keys.slice(1));
      }).value();
    }
  }
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-17T12:09:02.990

一个 lodash 和 mixin 的例子

```
_.mixin({
'groupByMulti': function (collection, keys) {
if (!keys.length) {
 return collection;
 } else {
  return _.mapValues(_.groupBy(collection,_.first(keys)),function(values) {
    return _.groupByMulti(values, _.rest(keys));
  });
}
}
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-29T18:51:15.580

这是一个易于理解的功能。

```
function mixin(list, properties){

    function grouper(i, list){

        if(i < properties.length){
            var group = _.groupBy(list, function(item){
                var value = item[properties[i]];
                delete item[properties[i]];
                return value;
            });

            _.keys(group).forEach(function(key){
                group[key] = grouper(i+1, group[key]);
            });
            return group;
        }else{
            return list;
        }
    }

    return grouper(0, list);

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-11-01T18:34:31.397

在大多数情况下，按复合键分组对我来说效果更好：

```
const groups = _.groupByComposite(myList, ['size', 'category']); 
```

[使用 OP 的小提琴演示](https://jsfiddle.net/ve91w4jv/6/)

## 米信

```
_.mixin({
  /*
   * @groupByComposite
   *
   * Groups an array of objects by multiple properties. Uses _.groupBy under the covers,
   * to group by a composite key, generated from the list of provided keys.
   *
   * @param {Object[]} collection - the array of objects.
   * @param {string[]} keys - one or more property names to group by.
   * @param {string} [delimiter=-] - a delimiter used in the creation of the composite key.
   *
   * @returns {Object} - the composed aggregate object.
   */
  groupByComposite: (collection, keys, delimiter = '-') =>
    _.groupBy(collection, (item) => {
      const compositeKey = [];
      _.each(keys, key => compositeKey.push(item[key]));
      return compositeKey.join(delimiter);
    }),
}); 
```*

# java - Java：迷宫图标：做什么？

> ID：10022159
> 
> 赞同：1
> 
> 时间：2012-04-05T03:06:58.000
> 
> 标签：java

我是一个完整的java菜鸟。我仍然真的不知道如何编码。我的迷宫有问题。我现在可以从 start(2) 转到 end(3)，但问题是 (start) 的图标。我试图打印出我们迷宫（mazePlan）的值，这很好。唯一的问题是图标。只有在递归函数完成后图标才会更改（我使用了 setIcons）。我需要获取这些图标以开始移动。谢谢！我真的需要一些帮助。谢谢！

```
 class solveButton implements ActionListener{
    private boolean goal;
    public void actionPerformed(ActionEvent e1)
    {  
        int i,j, a = 0,b = 0;
        goal = false;

        //Find 2/start
        for(i = 0; i<10; i++){
            for ( j = 0; j<10; j++){
                if (getMazePlan()[i][j] == 2){
                    a= i; b = j;
                }       
            }
        }   

        function(a,b);

        //print only
        for (i=0;i<10;i++){
            for(j = 0; j < 10; j++){
                System.out.print(getMazePlan()[i][j] + " ");
            }
            System.out.println();
        }

    }

    public void function(int y, int x){

        int ctr = 0,b ,a;

        //CHECKING FOR WALLS
        //LEFT
            if(x-1 >= 0 && x-1 <= 9){
                if(getMazeBoolean()[y][x-1] == false) 
                    ctr++;
            }
        //UP
            if(y-1 >= 0 && y-1 <= 9){
                if(getMazeBoolean()[y-1][x] == false) 
                    ctr++;
            }
        //RIGHT
            if(x+1 >= 0 && x+1 <= 9){
                if(getMazeBoolean()[y][x+1] == false) 
                    ctr++;
            }
        //DOWN
            if(y+1 >= 0 && y+1 <= 9){
                if(getMazeBoolean()[y+1][x] == false) 
                    ctr++;
            }

        try{
            Thread.sleep(1000);
        }catch(Exception e){}

            //print only
        System.out.println("Move");
        for (int i=0;i<10;i++){
            for(int j = 0; j < 10; j++){
                System.out.print(getMazePlan()[i][j] + " ");
            }
            System.out.println();
        }

        stack1.push(x);
        stack1.push(y);
        setMazePlan1(0, y, x);
        maze[y][x].setIcon(end);
        setMazeBoolean(true, y , x);

        //LEFT
        if(ctr > 0 && goal == false){
        if(x-1 >= 0 && x-1 <= 9){
            if(getMazeBoolean()[y][x-1] == false && getMazePlan()[y][x-1] != 3){
                setMazePlan1(2, y, x-1);
                function(y, x-1);
                ctr--;

                if(ctr != 0  && goal == false){
                    b = stack1.pop();
                    a = stack1.pop();
                    setMazePlan1(2, b , a);
                    stack1.push(a);
                    stack1.push(b);

                    try{
                        Thread.sleep(1000);
                    }catch(Exception e){}

                    setMazePlan1(0, b , a);
                }
            }
            else if(getMazePlan()[y][x-1] == 3){
                System.out.println("FINISH");
                goal = true;
            }
        }
        }
        //UP
        if(ctr > 0 && goal == false){
        if(y-1 >= 0 && y-1 <= 9){
            if(getMazeBoolean()[y-1][x] == false && getMazePlan()[y-1][x] != 3){
                setMazePlan1(2, y-1, x);
                function(y-1, x);
                ctr--;

            if(ctr != 0  && goal == false){
                b = stack1.pop();
                a = stack1.pop();
                setMazePlan1(2, b , a);
                stack1.push(a);
                stack1.push(b);

                try{
                    Thread.sleep(1000);
                }catch(Exception e){}

                setMazePlan1(0, b , a);
            }
            }
            else if(getMazePlan()[y-1][x] == 3){
                System.out.println("FINISH");
                goal = true;
            }
        }
        }
        //RIGHT
        if(ctr > 0 && goal == false){
        if(x+1 >= 0 && x+1 <= 9){
            if(getMazeBoolean()[y][x+1] == false && getMazePlan()[y][x+1] != 3 ){
                setMazePlan1(2, y, x+1);
                function(y, x+1);
                ctr--;

            if(ctr != 0  && goal == false){
                b = stack1.pop();
                a = stack1.pop();
                setMazePlan1(2, b , a);
                stack1.push(a);
                stack1.push(b);

                try{
                    Thread.sleep(1000);
                }catch(Exception e){}

                setMazePlan1(0, b , a);
            }
            }
            else if(getMazePlan()[y][x+1] == 3){
                System.out.println("FINISH");
                goal = true;
            }
        }
        }
        //DOWN
        if(ctr > 0 && goal == false){
        if(y+1 >= 0 && y+1 <= 9){
            if(getMazeBoolean()[y+1][x] == false && getMazePlan()[y+1][x] != 3){
                setMazePlan1(2, y+1, x);
                function(y+1, x);
                ctr--;

            if(ctr != 0  && goal == false){
                b = stack1.pop();
                a = stack1.pop();
                setMazePlan1(2, b , a);
                stack1.push(a);
                stack1.push(b);

                try{
                    Thread.sleep(1000);
                }catch(Exception e){}

                setMazePlan1(0, b , a);
            }
            }
            else if(getMazePlan()[y+1][x] == 3){
                System.out.println("FINISH");
                goal = true;
            }
        }
        }
        //DEADEND
        if(goal == false && ctr == 0){

            b = stack1.pop();
            a = stack1.pop();
            setMazePlan1(0, b , a);
            try{
            b = stack1.pop();
            a = stack1.pop();
            stack1.push(a);
            stack1.push(b);
            setMazePlan1(2, b , a);
            }
            catch(Exception e){

            }

            try{
                Thread.sleep(1000);
            }catch(Exception e){}

            //print only
            System.out.println("Pop");
            for (int i=0;i<10;i++){
                for(int j = 0; j < 10; j++){
                    System.out.print(getMazePlan()[i][j] + " ");
                }
                System.out.println();
            } 
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T07:28:56.530

不要阻塞 EDT（事件调度线程）——当这种情况发生时，GUI 将“冻结”。而不是调用 实现重复任务`Thread.sleep(n)`的 Swing或长时间运行的任务。有关更多详细信息，请参阅[Swing 中的并发。](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)`Timer``SwingWorker`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T03:15:02.593

在不尝试破译您的大量代码的情况下，听起来好像需要在设置图标后强制重绘/绘制。

这里实际上没有足够的代码知道如何调用 repaint()...

您可能还想看看 Java GUI 应用程序/GUI 线程（即，如果可能需要一段时间，您不应该在 GUI 线程上做所有“迷宫”工作）

# applescript - 用applescript打开程序

> ID：10022161
> 
> 赞同：26
> 
> 时间：2012-04-05T03:08:06.777
> 
> 标签：applescript

2部分问题：

我只是想从终端使用 applescript 运行程序，所以我尝试了：

```
$ osascript tell application "iTunes" to activate 
```

并得到错误：

```
osascript: tell: No such file or directory 
```

提供程序的完整路径也不起作用。我错过了什么？问题的第二部分是我最终想要使用 applescript 的目的。我想用它来打开我使用 py2app 构建的应用程序。applescript 可以打开任何 Mac 应用程序或仅打开某些已经兼容的应用程序。

谢谢

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-05T07:02:52.283

尝试这个。请注意，您在编写命令时使用了“-e”。如果没有“-e”，您将给出一个运行 AppleScript 的路径。另请注意，字符串命令必须用引号引起来。

```
osascript -e "tell application \"iTunes\" to activate" 
```

如果你有一个多行的applescript，你可以在每一行之前使用“-e”，就像这样......

```
osascript -e "tell application \"iTunes\"" -e "activate" -e "end tell" 
```

如果你想打开一个应用程序，只需使用 unix "open" 命令...

```
open "/path/to/application" 
```

如果您想使用 applescript 打开应用程序并且“激活”命令不起作用（尽管它应该适用于几乎所有内容）然后告诉 Finder 打开它。请记住，applescript 使用冒号分隔的路径...

```
osascript -e "tell application \"Finder\" to open file \"path:to:application\"" 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-12T14:42:45.547

在 bash shell（如终端）中，您可以使用“here document”将多行发送到 osascript。

```
osascript -e "tell application \"iTunes\"" -e "activate" -e "end tell" 
```

变成

```
osascript <<EOF
tell application "iTunes"
   activate
end tell
EOF 
```

作为一个老式的 Unix 黑客，我将这些小片段保存在我的 $HOME/bin 目录中，并从命令行调用它们。不过，仍在学习细节。

艾伦

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-06-15T22:31:21.917

osascript 的替代方案：

```
open -a Calendar 
```

靠近：

```
pkill Calendar 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-04-05T19:44:17.367

尝试：

```
do shell script "open /Applications/iTunes.app" 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-12-31T17:53:35.243

你需要在告诉周围加上单引号：

osascript -e '告诉应用程序“iTunes”激活'

否则你在运行 -e 时定义了一个变量

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-30T12:47:23.477

我也是脚本新手。

我很困惑，所以我扫描了一篇名为的文章`AppleScript Language Guide` ，当我浏览脚本命令项时，我了解到如果你想激活一个应用程序`mac os`，`applescript editor`你应该在编辑器中输入代码，然后编译并运行它们！也许这个答案会对你有所帮助，这里的代码：

```
// applescript editor code    

----------    

activate application "iTunes" line 1    

----------    

tell application "iTunes" to activate line 2 
```

# batch-file - BATCH 迭代 FOR /F 变量

> ID：10022164
> 
> 赞同：0
> 
> 时间：2012-04-05T03:08:28.570
> 
> 标签：batch-file, for-loop

我有看起来像这样的简单文件：

提交日志

```
Submitting job(s)..
2 job(s) submitted to cluster 528.
Submitting job(s)..
2 job(s) submitted to cluster 529. 
```

然后我只需要输出第二行（集群）的最后一个数字，在这种情况下，所需的输出将是：

```
528
529 
```

我尝试使用下面的脚本，但我不知道为什么它不起作用。我需要使用批处理来完成，这是我们系统的限制。

```
@ECHO OFF
FOR /F "tokens=6" %%g IN (Submit.log) DO (
set Job=%%g
echo %Job:.=%
) 
```

一个优雅的解决方案绝对是一个加分项，但如果有人可以通过一个简单的解决方案帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:17:44.213

以下脚本将完成这项工作：

```
@setlocal enableextensions enabledelayedexpansion
@echo off
for /f "tokens=1-6" %%a IN (submit.log) do (
    if %%c==submitted (
        set job=%%f
        echo !job:.=!
    )
)
endlocal 
```

而且，由于我基本上是谦虚的类型，我不会争辩说它既优雅*又*简单:-)

它基本上只查看第三个单词所在的那些行`submitted`（如果这证明有问题，您也可以使用其他规则），然后修改并输出第六个单词。

请注意延迟扩展的使用（使用`!`而不是`%`），这是确保在循环开始之前不评估变量所必需的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T11:20:55.133

这是一个有效的衬里。FINDSTR 搜索可以很容易地进行调整以使搜索非常精确。

```
@echo off
for /f "tokens=6 delims=. " %%N in ('findstr /c:"submitted to cluster" "submit.log"') do echo %%N 
```

paxdiablo 解决方案也可以简化，因此它不需要修改值，因此不需要延迟扩展。无需捕获所有令牌，只需捕获您要使用的令牌即可。分隔符设置为查找点和空格（默认为空格和制表符）。正如 paxdiablo 所说，可以测试更多的令牌以使搜索更精确，但这不如 FINDSTR 方便。

```
@echo off
for /f "tokens=5,6 delims=. " %%A in (submit.log) do if %%A==cluster echo %%B 
```

# java - 在 JAR 中创建和使用 .exe

> ID：10022168
> 
> 赞同：0
> 
> 时间：2012-04-05T03:09:13.070
> 
> 标签：java, jar, exe

我有一些用 Java 编写的代码，可以执行一些 .exe 文件。它首先从执行它的位置创建一个临时文件，然后在执行完成后销毁该文件。

唯一的问题是，它要求可执行文件与具有 main 函数的类在同一个包中。我也想从其他位置放置和访问我的 .exe 文件，因为在创建我的项目的 JAR 文件时，它从不执行该 exe 文件。

有没有其他方法可以让我的 .exe 文件成为我的 JAR 文件的一部分，而不管它在我的项目中的位置如何？

这是代码：

```
package com.web.frame;
import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;
//import java.net.URL;

public class Test{
  public void Test1(String fileAddr,String filename, String destFilenam) throws       Exception {
    // Place .exe into the package folder. 
  InputStream src =this.getClass().getResourceAsStream("DECRYPT.exe");
if(src!=null) {
   File exeTempFile = File.createTempFile("dspdf", ".exe");
   byte []ba=new byte[src.available()];
   src.read(ba,0,ba.length);
 exeTempFile.deleteOnExit();  
   FileOutputStream os=new FileOutputStream(exeTempFile);
   os.write(ba,0,ba.length);
   os.close();
   String hello=exeTempFile.getParent();
   System.out.println("Current Directory Of file : "+hello);
   String hello1=exeTempFile.getName();
   System.out.println("Full Name Of File : "+hello1);
   int l=hello1.length();
    l=l-4;
   char[] carray=hello1.toCharArray();
   String s = new String(carray,0,l);
   System.out.println(s);
   String param="cmd /c cd "+hello+" && "+s+" d 23 11 23 "+fileAddr+"\\"+filename+" "+destFilenam;
   Runtime.getRuntime().exec(param);
   Runtime.getRuntime().exec("c:\\Program Files\\VideoLAN\\VLC\\vlc.exe "+hello+"\\"+destFilenam);
   Runtime.getRuntime().exec("cmd /c del"+hello+"\\"+destFilenam);
  }
else
   System.out.println("Executable not found");
  } 

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:25:25.410

您最多可以将您的 exe 放在类路径中的任何位置。确保 jar 的清单具有类路径元素。然后你应该可以通过说 Test.class.getResourceAsStream("") 来访问 exe

因此，创建一个文件夹，将 exe 放入该文件夹并将该文件夹包含在您的类路径中。

# java - 如何在不访问私有变量的情况下测试 jUnit 测试中的时间传递？

> ID：10022169
> 
> 赞同：5
> 
> 时间：2012-04-05T03:09:23.213
> 
> 标签：java, unit-testing, junit, tdd

我正在对一门课程进行单元测试，我需要一定的时间才能检查结果。具体来说，我需要通过 x 分钟才能判断测试是否有效。我已经读过，在单元测试中我们应该测试接口而不是实现，所以我们不应该访问私有变量，但是除了在我的单元测试中休眠之外，我不知道如何在不修改私有变量的情况下进行测试。

我的测试是这样设置的：

```
@Test
public void testClearSession() {
    final int timeout = 1;
    final String sessionId = "test";
    sessionMgr.setTimeout(timeout);
    try {
        sessionMgr.createSession(sessionId);
    } catch (Exception e) {
        e.printStackTrace();
    }
    DBSession session = sessionMgr.getSession(sessionId);
    sessionMgr.clearSessions();
    assertNotNull(sessionMgr.getSession(sessionId));
    Calendar accessTime = Calendar.getInstance();
    accessTime.add(Calendar.MINUTE, - timeout - 1);
    session.setAccessTime(accessTime.getTime()); // MODIFY PRIVATE VARIABLE VIA PROTECTED SETTER
    sessionMgr.clearSessions();
    assertNull(sessionMgr.getSession(sessionId));
} 
```

除了修改 accessTime 私有变量（通过创建 setAccessTime 设置器或反射）或在单元测试中插入睡眠之外，是否可以对此进行测试？

编辑 2012 年 4 月 11 日

我特别想测试我的 SessionManager 对象是否在特定时间段过去后清除会话。我正在连接的数据库将在一段固定时间后断开连接。当我接近该超时时，SessionManager 对象将通过调用数据库上的“最终会话”过程来清除会话，并从其内部列表中删除会话。

SessionManager 对象被设计为在单独的线程中运行。我正在测试的代码如下所示：

```
public synchronized void clearSessions() {
    log.debug("clearSessions()");
    Calendar cal = Calendar.getInstance();
    cal.add(Calendar.MINUTE, - timeout);
    Iterator<Entry<String, DBSession>> entries = sessionList.entrySet().iterator();
    while (entries.hasNext()) {
        Entry<String, DBSession> entry = entries.next();
        DBSession session = entry.getValue();
        if (session.getAccessTime().before(cal.getTime())) {
            // close connection
            try {
                connMgr.closeconn(session.getConnection(), entry.getKey());
            } catch (Exception e) {
                e.printStackTrace();
            }
            entries.remove();
        }
    }
} 
```

对 connMgr（ConnectionManager 对象）的调用有点令人费解，但我正在重构遗留代码，目前就是这样。Session 对象存储与数据库的连接以及一些相关数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T06:44:50.920

*   测试可以进行一些重构以使意图更清晰。如果我的理解是正确的...

.

```
public void TestClearSessionsMaintainsSessionsUnlessLastAccessTimeIsOverThreshold() {

    final int timeout = 1;
    final String sessionId = "test";
    sessionMgr = GetSessionManagerWithTimeout(timeout);
    DBSession session = CreateSession(sessionMgr, sessionId);

    sessionMgr.clearSessions();
    assertNotNull(sessionMgr.getSession(sessionId));

    session.setAccessTime(PastInstantThatIsOverThreshold()); // MODIFY PRIVATE VARIABLE VIA PROTECTED SETTER
    sessionMgr.clearSessions();
    assertNull(sessionMgr.getSession(sessionId));
} 
```

*   现在到了无需暴露私有状态的测试问题
    *   现实生活中如何修改私有变量？您是否可以调用其他一些公共方法来更新访问时间？
    *   既然时钟/时间是一个重要的概念，为什么不把它明确地作为一个角色。因此，您可以将 Clock 对象传递给 Session，它使用它来更新其内部访问时间。在你的测试中，你可以传入一个 MockClock，它的 getCurrentTime() 方法会返回你想要的任何值。我正在编写模拟语法..所以用你正在使用的任何内容进行更新。

.

```
public void TestClearSessionsMaintainsSessionsUnlessLastAccessTimeIsOverThreshold() {

      final int timeout = 1;
      final String sessionId = "test";
      expect(mockClock).GetCurrentTime(); willReturn(CurrentTime());
      sessionMgr = GetSessionManagerWithTimeout(timeout, mockClock);
      DBSession session = CreateSession(sessionMgr, sessionId);

      sessionMgr.clearSessions();
      assertNotNull(sessionMgr.getSession(sessionId));

      expect(mockClock).GetCurrentTime(); willReturn(PastInstantThatIsOverThreshold());
      session.DoSomethingThatUpdatesAccessTime();
      sessionMgr.clearSessions();
      assertNull(sessionMgr.getSession(sessionId));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T05:43:32.920

**编辑：我更喜欢 Gishu 的回答。他还鼓励你嘲笑时间，但他将其视为一流的对象。**

您要测试的规则到底是什么？如果我没看错您的代码，您似乎希望验证与 ID“test”关联的会话是否在给定超时后过期，对吗？

时间在单元测试中是一件棘手的事情，因为它本质上是全局状态，所以这是验收测试的更好候选者（就像 zerkms 建议的那样）。

如果您仍想对其进行单元测试，通常我会尝试抽象和/或隔离对时间的引用，因此我可以在测试中模拟它们。一种方法是对被测类进行子类化。这是封装的一个小突破，但它比提供受保护的 setter 方法更干净，并且比反射好得多。

一个例子：

```
class MyClass {
  public void doSomethingThatNeedsTime(int timeout) {
    Date now = getNow();
    if (new Date().getTime() > now.getTime() + timeout) {
      // timed out!
    }
  }

  Date getNow() {
    return new Date();
  }
}

class TestMyClass {
  @Test
  public void testDoSomethingThatNeedsTime() {
    MyClass mc = new MyClass() {
      Date getNow() {
        // return a time appropriate for my test
      }    
    };

    mc.doSomethingThatNeedsTime(1);

    // assert
  }
} 
```

这是一个人为的例子，但希望你明白这一点。通过子类化 getNow() 方法，我的测试不再受制于全局时间。我可以随时替换。

就像我说的那样，这有点破坏封装，因为 REAL getNow() 方法永远不会被测试，它需要测试知道一些关于实现的东西。这就是为什么保持这种方法小而专注，没有副作用的原因。这个例子还假设被测试的类不是最终的。

尽管有缺点，但（在我看来）它比为私有变量提供范围设置器更干净，这实际上可以让程序员造成伤害。在我的示例中，如果某个流氓进程调用 getNow() 方法，则不会造成真正的伤害。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T06:54:13.730

看起来正在测试的功能是 SessionManager 驱逐所有过期的会话。

我会考虑创建扩展 DBSession 的测试类。

```
AlwaysExpiredDBSession extends DBSession  {
....
// access time to be somewhere older 'NOW'

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T07:07:35.767

我基本上遵循了 Gishu 的建议[https://stackoverflow.com/a/10023832/1258214](https://stackoverflow.com/a/10023832/1258214)，但我认为我会记录这些更改只是为了让其他阅读本文的人受益（因此任何人都可以评论实施问题）。感谢评论将我指向 JodaTime 和 Mockito。

相关的想法是及时识别代码的依赖性并将其提取出来（参见：[https](https://stackoverflow.com/a/5622222/1258214) ://stackoverflow.com/a/5622222/1258214 ）。这是通过创建一个接口来完成的：

```
import org.joda.time.DateTime;

public interface Clock {
    public DateTime getCurrentDateTime() ;
} 
```

然后创建一个实现：

```
import org.joda.time.DateTime;

public class JodaClock implements Clock {

    @Override
    public DateTime getCurrentDateTime() {
        return new DateTime();
    }

} 
```

然后将其传递给 SessionManager 的构造函数：

```
SessionManager(ConnectionManager connMgr, SessionGenerator sessionGen,
        ObjectFactory factory, Clock clock) { 
```

然后我可以使用类似于 Gishu 建议的代码（注意 testClear 开头的小写“t”......我的单元测试在使用大写“T”时非常成功，直到我意识到测试不是跑步...）：

```
@Test
public void testClearSessionsMaintainsSessionsUnlessLastAccessTimeIsOverThreshold() {
    final String sessionId = "test";
    final Clock mockClock = mock(Clock.class);

    when(mockClock.getCurrentDateTime()).thenReturn(getNow());
    SessionManager sessionMgr = getSessionManager(connMgr,
            sessionGen, factory, mockClock);
    createSession(sessionMgr, sessionId);

    sessionMgr.clearSessions(defaultTimeout);
    assertNotNull(sessionMgr.getSession(sessionId));

    when(mockClock.getCurrentDateTime()).thenReturn(getExpired());

    sessionMgr.clearSessions(defaultTimeout);
    assertNull(sessionMgr.getSession(sessionId));
} 
```

这运行得很好，但是我删除 Session.setAccessTime() 与另一个测试 testOnlyExpiredSessionsCleared() 产生了问题，我希望一个会话过期而不是另一个。这个链接[https://stackoverflow.com/a/6060814/1258214](https://stackoverflow.com/a/6060814/1258214)让我想到了 SessionManager.clearSessions() 方法的设计，我将检查会话是否从 SessionManager 到 DBSession 对象本身.

从：

```
if (session.getAccessTime().before(cal.getTime())) { 
```

到：

```
if (session.isExpired(expireTime)) { 
```

然后我插入了一个 mockSession 对象（类似于 Jayan 的建议[https://stackoverflow.com/a/10023916/1258214](https://stackoverflow.com/a/10023916/1258214)）

```
@Test
public void testOnlyOldSessionsCleared() {
    final String sessionId = "test";
    final String sessionId2 = "test2";

    ObjectFactory mockFactory = spy(factory);
    SessionManager sm = factory.createSessionManager(connMgr, sessionGen,
        mockFactory, clock);

    // create expired session
    NPIISession session = factory.createNPIISession(null, clock);
    NPIISession mockSession = spy(session);
    // return session expired
    doReturn(true).when(mockSession).isExpired((DateTime) anyObject());

    // get factory to return mockSession to sessionManager
    doReturn(mockSession).when(mockFactory).createDBSession(
        (Connection) anyObject(), eq(clock));
    createSession(sm, sessionId);

    // reset factory so return normal session
    reset(mockFactory);
    createSession(sm, sessionId2);

    assertNotNull(sm.getSession(sessionId));
    assertNotNull(sm.getSession(sessionId2));

    sm.clearSessions(defaultTimeout);
    assertNull(sm.getSession(sessionId));
    assertNotNull(sm.getSession(sessionId2));
} 
```

感谢大家对此的帮助。如果您发现更改有任何问题，请告诉我。

# paypal - shopify 不支持 paypal 网站支付标准

> ID：10022174
> 
> 赞同：0
> 
> 时间：2012-04-05T03:09:45.940
> 
> 标签：paypal, e-commerce, payment-gateway, shopify

我有一个 shopify 的基本帐户，shopify 允许我从以下贝宝解决方案中进行选择

```
PayPal Website Payments Pro (UK)
PayPal Website Payments Pro (CA)
PayPal Payments Pro (US)
PayPal Payflow Link
PayPal Express Checkout 
```

shopify 不支持“paypal 网站支付标准”有什么特别的原因吗？

我正在为客户构建电子商务解决方案，并建议客户使用“贝宝网站支付标准”。出于任何原因，这不是一个受欢迎的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T12:45:16.413

PayPal 标准的集成选项不如其他 PayPal 集成强大，因此 Shopify 不支持它。标准提供的任何选项都应包含在其他贝宝产品中；您应该能够获得相同的功能。

客户是否需要其他服务不提供的 PayPal 标准中的特别内容？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-31T17:36:43.420

这与功能无关。这是与其他贝宝计划相关的每月费用。Paypal 标准不需要任何月费。这就是区别，这就是我们希望在网站上实际使用它的原因。

# ruby-on-rails - Rails 不会创建新项目，因为它认为它在一个项目中

> ID：10022175
> 
> 赞同：0
> 
> 时间：2012-04-05T03:09:48.050
> 
> 标签：ruby-on-rails, ruby

我正在尝试创建一个新的 Rails 项目，因为我正在阅读《Agile Web Development with Rails》一书。我安装了 Aptana Studio 3 并在其默认工作区中成功创建了一个项目。然后我决定我宁愿把它放在另一个文件夹中，所以我删除了那个并尝试创建一个新的到不同的路径。那是我得到错误的时候：

> 无法在另一个目录中初始化新的 Rails 应用程序，请先切换到非 Rails 目录。输入“rails”寻求帮助。

然后，我在命令提示符下导航到该目录以确认它是空的。使用“rails new TestApp”会出现同样的错误。我升级了一个级别并创建了一个新目录（作为应用程序的父目录）并在那里收到了相同的消息。我能够在 C:\tmp 中创建多个项目，但它不允许我在 C:\Users\Account\Development 下创建任何项目。我设置了要显示的隐藏文件，但是我应该寻找什么东西会让 Rails 认为我的 Development 文件夹是一个项目吗？

我在 Windows 7 中使用 ruby​​ 1.9.3p125 和 rails 3.2.3。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T20:51:00.160

您可能已经创建了一个 rails 应用程序，它是您现在尝试创建的文件夹的父文件夹。我认为如果文件夹是 rails 应用程序，rails 会在尝试访问时寻找 Gemfile（我可能错了）。查看您的父类别并进行搜索。您可能会发现其他相关的部分（app/、vendor/ 等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T06:39:27.887

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-30T19:34:43.210

您已经在父文件夹中拥有 Rails 应用程序。您应该从那里卸载应用程序。从此文件夹中删除所有 Rails 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-11T03:34:14.413

如果父目录上已经存在 rails 应用程序，则可能会出现此错误。转到父目录，删除所有 rails 文件/文件夹，包括 Gemfile。转到 /Users/{your_comp_name}/ 并查看您是否有 rails 文件/文件夹。如果这样做，请删除它们，然后再次启动您的 rails 应用程序。这有点痛苦，但你可能不得不回溯。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-31T02:23:59.237

对我有用的是删除 rails 生成的所有文件和文件夹（~/app、~/bin、~/config、~/Gemfile、~/Gemfile.lock）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-15T23:58:53.090

从二进制文件夹中删除 rails 文件夹后，它起作用了：

`cd /bin sudo rm -rf /bin/rails`

# mysql - 使用 ruby on rails 活动记录插入多条记录

> ID：10022178
> 
> 赞同：45
> 
> 时间：2012-04-05T03:10:10.967
> 
> 标签：mysql, ruby-on-rails, ruby, activerecord, insert

有没有办法一次插入多个记录而不是一个？

我有一个非常丑陋的 rake 任务，它正在执行以下操作......

```
 VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2000-03-07", :party => row[45], :participate => participated(row[45]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "GE", :election => "2000-11-07", :party => row[46], :participate => participated(row[46])) 
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "SP", :election => "2000-05-08", :party => row[47], :participate => participated(row[47]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "GE", :election => "2001-11-06", :party => row[48], :participate => participated(row[48]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2002-05-07", :party => row[49], :participate => participated(row[49]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "GE", :election => "2002-11-05", :party => row[50], :participate => participated(row[50]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "SP", :election => "2003-05-06", :party => row[51], :participate => participated(row[51]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "GE", :election => "2003-11-04", :party => row[52], :participate => participated(row[52]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2004-03-02", :party => row[53], :participate => participated(row[53]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "GE", :election => "2004-11-02", :party => row[54], :participate => participated(row[54]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "SP", :election => "2005-02-08", :party => row[55], :participate => participated(row[55]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2005-05-03", :party => row[56], :participate => participated(row[56]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2005-09-13", :party => row[57], :participate => participated(row[56]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "GE", :election => "2005-11-08", :party => row[58], :participate => participated(row[58]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "SP", :election => "2006-02-07", :party => row[59], :participate => participated(row[59]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2006-05-02", :party => row[60], :participate => participated(row[60]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "GE", :election => "2006-11-07", :party => row[61], :participate => participated(row[61]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2007-05-08", :party => row[62], :participate => participated(row[62]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2007-09-11", :party => row[63], :participate => participated(row[63]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "GE", :election => "2007-11-06", :party => row[64], :participate => participated(row[64]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2007-11-06", :party => row[65], :participate => participated(row[65]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2007-12-11", :party => row[66], :participate => participated(row[66]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2008-03-04", :party => row[67], :participate => participated(row[67]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2008-10-14", :party => row[68], :participate => participated(row[68]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "GE", :election => "2008-11-04", :party => row[69], :participate => participated(row[69]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "GE", :election => "2008-11-18", :party => row[70], :participate => participated(row[70]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2009-05-05", :party => row[71], :participate => participated(row[71]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2009-09-08", :party => row[72], :participate => participated(row[72]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2009-09-15", :party => row[73], :participate => participated(row[73]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2009-09-29", :party => row[74], :participate => participated(row[74]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "GE", :election => "2009-11-03", :party => row[75], :participate => participated(row[75]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2010-05-04", :party => row[76], :participate => participated(row[76]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2010-07-13", :party => row[77], :participate => participated(row[77]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2010-09-07", :party => row[78], :participate => participated(row[78]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "GE", :election => "2010-11-02", :party => row[79], :participate => participated(row[79]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2011-05-03", :party => row[80], :participate => participated(row[80]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2011-09-13", :party => row[81], :participate => participated(row[81]))
        VoteRecord.create(:prospect_id => prospect.id, :state => "OH", :election_type => "GE", :election => "2011-11-08", :party => row[82], :participate => participated(row[82])) 
```

这必须非常低效，并且必须有更好的方法......

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-04-05T03:19:37.863

该`create`方法还接受一个数组作为参数。

```
VoteRecord.create(
  [
    { :prospect_id => prospect.id, :state => "OH", :election_type => "GE", :election => "2011-11-08", :party => row[82], :participate => participated(row[82]) },
    { :prospect_id => prospect.id, :state => "OH", :election_type => "PR", :election => "2011-09-13", :party => row[81], :participate => participated(row[81]) }
    ...
  ]
) 
```

但是，这仍然对每个条目执行一个 SQL 查询，而不是单个 SQL 查询。它更有效，因为它只需要在后台创建一个 activerecord 对象。

> 如果您同时从同一个客户端插入多行，请使用带有多个 VALUES 列表的 INSERT 语句一次插入多行。这比使用单独的单行 INSERT 语句要快得多（在某些情况下快很多倍）。如果要向非空表添加数据，则可以调整 bulk_insert_buffer_size 变量以使数据插入更快。请参见第 5.1.3 节，“服务器系统变量”。

[从mysql页面](https://dev.mysql.com/doc/refman/5.0/en/insert-speed.html)（但我想其他数据库应该是一样的）

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-07-13T20:52:37.723

不幸的是，这在 Rails 中是不可能的。

然而，对于 Rails 3.x， [activerecord-import](https://github.com/zdennis/activerecord-import)是一个很棒的 gem，它`import`为你的模型类添加了一个方法，并且作为一个单一的 SQL 插入语句完成了你想要的事情。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2019-09-25T18:34:49.273

Rails 6 现在支持这个开箱即用：

[https://blog.bigbinary.com/2019/04/15/bulk-insert-support-in-rails-6.html](https://blog.bigbinary.com/2019/04/15/bulk-insert-support-in-rails-6.html)

> 可以使用新添加的方法执行批量插入：insert_all、insert_all！和 upsert_all。

* * *

## 回答 #4

> 赞同：-7
> 
> 时间：2015-07-09T00:06:53.470

您可以将 ActiveRecord 语句包装在`ActiveRecord::Base.transaction`：

```
ActiveRecord::Base.transaction do 
  1000.times { Post.create(options) } 
end 
```

有关其他技术，请参阅[这篇文章](https://www.coffeepowered.net/2009/01/23/mass-inserting-data-in-rails-without-killing-your-performance/)。

# android - FragmentPagerAdapter 带有 ViewPager 和两个 Fragment。从第二个转到第一个并更新第一个的文本

> ID：10022179
> 
> 赞同：8
> 
> 时间：2012-04-05T03:10:18.260
> 
> 标签：android, android-fragments, android-viewpager, updating, fragmentpageradapter

我不熟悉`FragmentPagerAdapter`，所以这将是我们（你）批判性地阅读描述的问题之一。

**结构：**我有一个`FragmentPagerAdapter`（下面的代码），一次可以容纳两个片段。第一个显示书籍摘录，第二个显示书名列表。

**目标：**我想实现标题中描述的内容：用户可以导航到分页器中的第二个片段，单击一个标题，然后我想将用户移回第一个片段并告诉第一个片段进行更新文本。第一个片段有一个`triggerRefresh`方法。

**代码：**我相信我的问题是因为`FragmentPagerAdapter`重用/创建片段的方式（我不明白）。这是我的课：

```
static class MyFragmentPagerAdapter extends FragmentPagerAdapter {

    public MyFragmentPagerAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public int getCount() {
        return NUM_ITEMS;
    }

    @Override
    public Fragment getItem(int position) {
        switch(position) {
        case 0:
            return new ExcerptsFragment();
        case 1:
            return new BookListFragment();
        default:
            throw new IllegalArgumentException("not this many fragments: " + position);
        }
    }
} 
```

这就是我创建相关成员的方式：

```
ViewPager mViewPager = (ViewPager) findViewById(R.id.pager);
MyFragmentPagerAdapter mFragmentPagerAdapter = new MyFragmentPagerAdapter(getSupportFragmentManager());
mViewPager.setAdapter(mFragmentPagerAdapter); 
```

这就是我在我的活动中其他地方尝试过的，当我收到来自书名片段的回调并选择了标题时：

```
mViewPager.setCurrentItem(0); // back to excerpts screen page. It's OK.
// Here's the problem! How to identify the fragment 0 
// to ExcerptsFragment and call its triggerRefresh()?!? 
```

**系列问题：**

调用适配器`getView()`将不起作用，因为它将返回 的新实例`ExcerptsFragment`，该实例不是当前附加的实例（如预期的那样，引发异常）。

我在这里看到很多人（[示例](https://stackoverflow.com/a/9214669/489607)）只是将片段存储在`getView()`. 那正确吗？因为通过查看官方示例，对我来说似乎是一种反模式（通过持有项目来击败自动参考）。这也是[这里](https://stackoverflow.com/a/7098081/489607)和[这里](https://stackoverflow.com/a/9759024/489607)的意见（在我看来是正确的）。

有什么建议么？如果我不理解所有这一切，我不会感到惊讶......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T04:23:04.377

免责声明：*虽然这对我来说之前工作得非常好，**但您应该意识到依赖内部私人行为的经典陷阱**。虽然我编写的测试最终会在内部实现发生变化时警告我，但我已经转向[更环保的牧场](https://stackoverflow.com/q/14035090/489607)。你也应该这样做。因此，在我看来，这个问题及其答案的价值只是历史性的。*

* * *

对不起那个问题，我想是时候了。

为了解决这个问题，我按原样实施[了这个解决方案](https://stackoverflow.com/a/9744146/489607)。似乎工作得很好。所以，我相信这只是通过弄清楚它的 Id 是如何命名的来找到（当前附加的）片段实例的问题。上面的链接解释了它是如何制作的。

我选择回答我自己的问题而不是删除它，因为我相信像我这样的寻呼机新手将从“真实案例场景”中受益。我见过的大多数答案都在谈论理论，顺便说一句，这是正确的方法……但是如果没有一个真实的例子可以研究，有时像我这样的人会迷路。

无论如何，这是我需要的最后一段代码（上面的注释部分）：

```
int n = 0;
mViewPager.setCurrentItem(n); // in the question I had stopped here.

ExcerptsFragment f = (ExcerptsFragment) ContainerActivity.this
        .getSupportFragmentManager().findFragmentByTag(getFragmentTag(n));
f.triggerRefresh();

// ... below the helper method: used the solution from the link.

private String getFragmentTag(int pos){
    return "android:switcher:"+R.id.pager+":"+pos;
} 
```

所以，我感觉这是一个强大的解决方案，因为我没有持有任何对片段的引用（因此存在引用过时的风险）。我将自己的代码保持在最低限度，因此最大限度地减少了我做蠢事的机会。

**当然，如果您有什么要补充、向我们展示、告诉我们这样做有什么问题或可以改进的地方，我会很高兴收到您的来信。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-07T14:10:14.187

我自己搜索了一段时间来解决这个问题。您的方法原则上有效，但如果 Android 基类实现中的片段标记创建代码发生更改，它将破坏您的代码。这是一个非常讨厌的依赖！

更优雅的方法是扭转问题并在片段中保留基本活动的实例。在您的活动中为标签实现一个设置器，并在创建时在片段内调用它 - 那里的标签只需使用 getTag() 即可。

可以在[此处](https://stackoverflow.com/questions/13685099/keep-instances-of-fragments-inside-fragmentpageradapter#new-answer)找到示例实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-24T10:16:26.703

我通过在创建时对片段使用 Wea​​kReferences 解决了这个问题。请参阅：[https ://stackoverflow.com/a/23843743/734151](https://stackoverflow.com/a/23843743/734151)

如果您发现此方法有任何问题，请发表评论。

# c++ - 如何仅构建 boost 所需的模块？

> ID：10022180
> 
> 赞同：23
> 
> 时间：2012-04-05T03:10:21.213
> 
> 标签：c++, visual-studio-2010, boost

我刚开始编译 boost C++ 库。通过我发出的以下命令，它正在构建整个 boost 库，这很耗时，而且对我的需要来说不是必需的。

刚刚解压`boost_1_49_0.7z`存档并从`Visual Studio 2010 command line tool`我运行`bootstrap.bat`它创建了`b2`可执行文件。

我使用这个可执行文件`b2 --toolset=msvc-10.0 --build-type=complete architecture=x86 address-model=64 stage`来构建库。

此时我需要的是要构建的“信号”模块。

需要为引导创建的可执行文件提供哪些切换命令才能仅编译和构建那些特定的库？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-04-05T07:37:38.157

`b2.exe --help`输出以下内容。

`--show-libraries Displays the list of Boost libraries that require build and installation steps, then exit.`

`--with-<library> Build and install the specified <library> If this option is used, only libraries specified using this option will be built.`

也可以使用该`-jX`选项在 X 进程中并行编译 BOOST。

# android - Openfeint：对openfeint服务器的批量请求（获取成就、解锁成就、提交分数）

> ID：10022185
> 
> 赞同：0
> 
> 时间：2012-04-05T03:11:28.150
> 
> 标签：android, ios, openfeint

我有一个场景，我想向 Openfeint 服务器发送多个请求以同时解锁多个成就。从 API 来看，我似乎只能通过对 Openfeint 的服务器的一个请求来解锁一项成就。这是否意味着如果我想解锁多个成就，我必须发出多个请求？

另外，如何获取用户已经获得的成就列表？

任何帮助，将不胜感激！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:45:43.680

1）据我所知，是的，您需要一一解锁。如果您为它编写一个函数，那么每个成就只需一行代码。

2）您可以使用仪表板轻松做到这一点。仪表板包含成就、排行榜、个人资料页面等。

```
// Open OpenFeint Achievements
Dashboard.openAchievements(); 
```

编辑：我可能误解了你。我不想给你一个愚蠢的答案，但我会做以下事情： -我会将我所有的成就 ID 存储在一个数组中 -我会通过这种方式检查它们是否已解锁：

```
Achievement aAchievement = new Achievement(ID);
if (aAchievement.isUnlocked){
 ...
} else {
 ...
} 
```

# java - 如何将数组中的某些 File 元素复制到新的 File 数组？

> ID：10022187
> 
> 赞同：0
> 
> 时间：2012-04-05T03:11:39.217
> 
> 标签：java, arrays, swing, file, list

这有可能实现吗？我有一个包含 5 个文件列表的文件 foo[]。但我只想将 foo[0] 和 foo[3] 复制到文件 bar[] 中，这样 bar[] 将只有 2 个元素。

我的代码获取 foo[] 的长度，然后如果所选文件的索引等于 i 的索引，则将 foo[i] 添加到 bar[i]。这是我构建的可能代码：

```
for(int i = 0; i < foo.length; i++){

    if(list_fileListing.getSelectedIndex() == i){
        bar[i] = foo[i];
    }
} 
```

* **list_fileListing.getSelectedIndex() 保存从 JList 中选择的文件列表。*** 原因是我有一个在 JList 中可选择的文件列表。从该列表中，我希望用户能够选择要附加到电子邮件的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:34:52.520

如果你调用`getSelectedValues()`你的 JList，你会得到一个包含当前选择的所有项目的数组：

```
Object[] selectedObjects = list_fileListing.getSelectedValues();

for (int i = 0; i < selectedObjects.length; i++)
{
    File aFile = (File)selectedObjects[i];

    // attach this file
} 
```

这足够了吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T04:50:26.147

看起来您正在使用 Java7，因为您已`JList.getSelectedValues()`弃用。尝试改用[getSelectedValuesList()](http://docs.oracle.com/javase/7/docs/api/javax/swing/JList.html#getSelectedValuesList%28%29)方法。如果你需要一个数组，你可以使用`list.getSelectedValuesList().toArray()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T06:01:41.890

根据您的评论，您`JList`包含`String`实例而不是`File`实例。所以你可以做类似的事情

```
List<String> selectedFilesAsStrings = list_fileListing.getSelectedValuesAsList();
//selectedFilesAsStrings will never be null, but can be empty
List<File> selectedFiles = new ArrayList<File>( selectedFilesAsStrings.size() );
for( String fileName : selectedFilesAsStrings ){
  selectedFiles.add( new File( fileName ) );
}
File[] bar = selectedFiles.toArray( new File[ selectedFiles.size() ] ); 
```

这会将`bar`数组设置为指向包含所选`File`实例的数组

# python - Facepy 无法将图像上传到 Facebook

> ID：10022188
> 
> 赞同：2
> 
> 时间：2012-04-05T03:11:41.830
> 
> 标签：python, facebook-graph-api, post, photos, facepy

我正在尝试使用[Facepy](https://github.com/jgorset/facepy)（一种用于 Facebook 和 Python 的 API）来简单地将图像从我的桌面发布到我拥有授权代码和 publish_stream 和 upload_photo 权限的 Facebook 页面。（**更新**：我如何**验证**这是真的？）

它不适合我，虽然它*适用*于 Facepy 的作者。我不知道是什么导致了这个问题。当我运行此代码时，取自 Facepy 站点（并在我的计算机上使用 .jpg）：

**更新**：这是我正在运行的全部代码：

```
from facepy import GraphAPI

print 'Trying Facebook page...'
my_token = 'xxxxxxxxxxxxxxxxx'
graph = GraphAPI(my_token)

# Get my latest posts
my_posts = graph.get("me/posts")

 #Post a photo of a parrot
graph.post(path = "me/photos",source = open("python.png"))

print 'Done.' 
```

Facepy 返回此错误：

```
Error: (#1) An unknown error occurred 
```

我已经在 WinXP 上使用 Python 2.5 和 Python 2.7 进行了尝试，但未成功。然而，Facepy 可以通过`graph.get('me/posts')`

任何让这个工作的建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-02-10T15:16:56.350

我有同样的问题。显然找到了答案。

根据[GitHub page](https://github.com/jgorset/facepy)，`source`参数需要一个`rb`模式：

```
graph.post(
path = 'me/photos',
source = open('parrot.jpg', 'rb') 
```

为我工作（使用 Python 3 和 Graph API 2.8）。

要从 URL 发布，您可以使用`url`：

```
par = {
    "caption": "Some text",
    "url": "https://example.com/1.jpg"}

send_post = graph.post(path='me/photos', **par) 
```

# mysql - MySQL插入查询无法完成

> ID：10022189
> 
> 赞同：2
> 
> 时间：2012-04-05T03:11:43.980
> 
> 标签：mysql

我正在将一个大表的一部分插入到一个新的 MyISAM 表中。我尝试了命令行和phpmyadmin，都需要很长时间。但是我在mysql的data文件夹中发现，table文件其实有GB的数据，但是在phpmyadmin中却显示没有记录。然后我“检查”表格，这就像永远......

这里有什么问题？我应该更改为 innoDB 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:21:24.127

您的表格上是否定义了指标？如果您对快速插入大量数据最感兴趣，可以考虑删除索引，进行插入，然后重新添加索引。总体上它不会更快（实际上手动干预可能会使整体操作变慢），但它可以让您更直接地了解数据插入与随后的索引所花费的时间。

# javascript - 每个字母的第一个字母

> ID：10022191
> 
> 赞同：3
> 
> 时间：2012-04-05T03:11:50.627
> 
> 标签：javascript, jquery, html, anchor

使用**javascript**我正在循环遍历我的 H3 元素，如下所示：

```
$('h3').each(function(){ }); 
```

然后，我为该标签生成一个锚点，格式如下：“section-x”，其中 x 为页面上的每个 H3 递增。我遇到的问题是我希望标题的第一个字母成为锚链接，如下所示：

* *H* *标题

.. 其中 H 带有下划线，表示链接。我可以格式化锚点，但是我不知道如何在每个标题的第一个字母周围加上超链接标签。一些帮助将不胜感激。

问候， kvanberendonck

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T03:16:27.477

像这样的东西？

```
$('h3').each(function(){ 
    var currentHeading = $(this).text();

    $(this).html("<a href='link'>" + currentHeading.substr(0,1) + "</a>" + currentHeading.substr(1, currentHeading.length - 1));
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T03:30:06.807

让我们加入一些普通的 javascript 代码：

```
$('h3').html(function(i){
    var self = $(this)
      , html = self.html()

    return html[0].anchor('section-'+i) + html.substring(1)
}) 
```

*   `html`（和大多数其他 setter 函数）接受一个函数作为参数并使用每个元素的返回值
*   `"string".link(target)`创建代码`<a href="#target">string</a>`。一个很好的复古有用的方法

**编辑：**从切换`.link`到`.anchor`. 虽然不推荐使用锚点，但您应该开始为此使用 ID：

```
$('h3').html(function(i){
    var self = $(this)
      , text = self.text()

    // give the H3 an id and link to it
    // ideally the headers should already have an id
    this.id = 'section-'+i
    return text[0].link('#section-'+i) + text.substring(1)
}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T03:24:51.800

```
$('h3').each(function(i){
   var firstLetter = $(this).text()[0];
   $(this).html('<a href="where.html">' + firstLetter + '</a>' + $(this).text().substr(1));
}); 
```

不知道你想把`section-x`那个标题放在哪里，但你可以`i`在里面使用`each()`来获取当前的迭代索引。

# ruby-on-rails - 使用 ruby 并行处理 CSV 文件

> ID：10022194
> 
> 赞同：0
> 
> 时间：2012-04-05T03:12:27.100
> 
> 标签：ruby-on-rails, ruby, csv, parallel-processing

我有一个非常大的 CSV 文件，大约 800,000 行。我想尝试并行处理这个文件以加快我的脚本。

如何使用 Ruby 将文件分成 n 个小块？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T03:28:00.573

对于 csv 文件，您可以这样做：

```
open("your_file.csv").each_line do |line|
  # do your stuff here like split lines
  line.split(",")

  # or store them in an array
  some_array << line

  # or write them back to a file
  some_file_handler << line
end 
```

通过将行（或拆分行）存储在数组（内存）或文件中，您可以将大文件分成更小的部分。之后，可以使用线程来处理每个部分：

```
threads = []
1.upto(5) { |i| threads << Thread.new { do your stuff with file[i] } }

threads.each(&:join) 
```

请注意，您有责任确保线程安全。

希望这可以帮助！

更新：

根据 pguardiario 的建议，我们可以使用stand library 中的csv 而不是直接打开文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T06:15:03.313

将 CSV 文件分成块是按顺序排列的，但您必须记住，每个块都需要与 CSV-header 保持第一行！

所以 UNIX '分裂' 不会削减它！

您必须编写自己的小 Ruby 脚本，该脚本读取第一行并将其存储在变量中，然后将接下来的 N 行分发到新的部分 CSV 文件，但首先将 CSV-header 行复制到其中。ETC..

在使用标题和一大段行创建每个文件后，您可以使用 Resque 征集这些文件以供 Resque 工作人员进行并行处理。

[http://railscasts.com/episodes/271-resque](http://railscasts.com/episodes/271-resque)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T03:21:10.943

我会使用 linux split 命令将此文件拆分为许多较小的文件。然后，将处理这些较小的部分。

# java - 四舍五入到小数点后三位的最快方法是什么？

> ID：10022195
> 
> 赞同：8
> 
> 时间：2012-04-05T03:12:27.593
> 
> 标签：java

SO 社区是对的，在你问性能问题之前分析你的代码似乎比我随机猜测的方法更有意义:-) 我分析了我的代码（非常密集的数学）并且没有意识到我超过 70% 的代码显然是在某种程度上，我认为这不是导致减速的原因，四舍五入。

```
static double roundTwoDecimals(double d) {
    DecimalFormat twoDForm = new DecimalFormat("#.###");
    return Double.valueOf(twoDForm.format(d));
} 
```

我的问题是我得到的十进制数通常是 .01、.02 等。但有时我会得到类似 0.070000000001 的东西（我真的只关心 0.07，但浮点精度会导致我的其他公式失败），我只是想要前 3 位小数来避免这个问题。

那么有没有更好/更快的方法来做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-05T03:17:34.480

舍入（正）数字的标准方法是这样的：

```
double rounded = floor(1000 * doubleVal + 0.5) / 1000; 
```

示例 1：`floor(1000 * .1234 + 0.5) / 1000`= `floor(123.9)/1000`=`0.123`
示例 2：`floor(1000 * .5678 + 0.5) / 1000`= `floor(568.3)/1000`=`0.568`

但正如@nuakh 评论的那样，你总是会在某种程度上受到四舍五入错误的困扰。如果您想要*精确*的 3 位小数，最好的办法是转换为千分之一（即，将所有内容乘以 1000）并使用整数数据类型*（*`int`、`long`等）

 *在这种情况下，您将跳过最后除以 1000 并使用整数值`123`和`568`进行计算。如果你想要百分比形式的结果，你可以除以 10 来显示：

123 → 12.3%
568 → 56.8%

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T06:08:31.113

Using a cast is faster than using floor or round. I suspect a cast is more heavily optimised by the HotSpot compiler.

```
public class Main {
    public static final int ITERS = 1000 * 1000;

    public static void main(String... args) {
        for (int i = 0; i < 3; i++) {
            perfRoundTo3();
            perfCastRoundTo3();
        }
    }

    private static double perfRoundTo3() {
        double sum = 0.0;
        long start = 0;
        for (int i = -20000; i < ITERS; i++) {
            if (i == 0) start = System.nanoTime();
            sum += roundTo3(i * 1e-4);
        }
        long time = System.nanoTime() - start;
        System.out.printf("Took %,d ns per round%n", time / ITERS);
        return sum;
    }

    private static double perfCastRoundTo3() {
        double sum = 0.0;
        long start = 0;
        for (int i = -20000; i < ITERS; i++) {
            if (i == 0) start = System.nanoTime();
            sum += castRoundTo3(i * 1e-4);
        }
        long time = System.nanoTime() - start;
        System.out.printf("Took %,d ns per cast round%n", time / ITERS);
        return sum;
    }

    public static double roundTo3(double d) {
        return Math.round(d * 1000 + 0.5) / 1000.0;
    }

    public static double castRoundTo3(double d) {
        return (long) (d * 1000 + 0.5) / 1000.0;
    }
} 
```

prints

```
Took 22 ns per round
Took 9 ns per cast round
Took 23 ns per round
Took 6 ns per cast round
Took 20 ns per round
Took 6 ns per cast round 
```

Note: as of Java 7 floor(x + 0.5) and round(x) don't do quite the same thing as per this issue. [Why does Math.round(0.49999999999999994) return 1](https://stackoverflow.com/questions/9902968/why-does-math-round0-49999999999999994-return-1)

This will round correctly to within the representation error. This means that while the result is not exact the decimal e.g. 0.001 is not represented exactly, when you use toString() it will correct for this. Its only when you convert to BigDecimal or perform an arithmetic operation that you will see this representation error.*

# c# - SharePoint 2010 FAST Search：显示用户无权访问的记录

> ID：10022196
> 
> 赞同：1
> 
> 时间：2012-04-05T03:12:48.380
> 
> 标签：c#, .net, sharepoint, search

首先，我知道这个标题听起来很奇怪，但这是我们的一位客户提出的有效且合格的要求。我们希望做的是向他们显示由于无法访问而未显示在搜索结果中的所有记录的记录名称和位置（只读）。

```
public class VisualWebPart1 : Microsoft.Office.Server.Search.WebControls.CoreResultsWebPart
{
    protected override void ConfigureDataSourceProperties()
    {
        base.ConfigureDataSourceProperties();

        CoreResultsDatasource ds = DataSource as CoreResultsDatasource;

        if (ds.UserCredentials.ContainsKey(ds.Location))
            ds.UserCredentials.Remove(ds.Location);

        ds.UserCredentials.Add(ds.Location, new NetworkCredential("user", "password", "domain"));
    }
} 
```

现在，我们想要执行此操作的第一种方法是直接使用搜索 API 调用 FAST 搜索 Web 服务。但是，我们希望它能够与现有的快速搜索中心无缝协作，即它们仍然可以使用现有的搜索框、高级搜索等。据我们了解，除非我们将 API 转换为基于 URL 的搜索查询，否则该 API 可能无法很好地集成查询到 FQL。如果有如下替代方案，我们宁愿不走这条路；

我们有一个想法来扩展 CoreResultsWebPart 组件，以便在执行搜索时将用户权限临时提升为管理员帐户。反编译并查看 CoreResultsWebPart 的代码后，我认为使用以下代码会非常简单；

但是，我们错了，这根本行不通。查看 CoreResultsWebPart 的代码很奇怪，我没有看到任何其他访问控制机制，我的意思是，除了数据源 (UserCredentials) 中的此处，我没有看到正在处理用户凭据的任何地方。 '确定 CoreResultsWebpart 必须直接调用 Web 服务，但我不知道凭据传递到哪里。

在我们开始研究简单地创建自定义 Web 部件之前，我们将不胜感激任何帮助。即使是告诉我我们走错了路！

谢谢！

阿德里安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:29:56.553

如果您的 RunWithElevatedPrivileges 没有传递系统帐户的用户令牌，您可能想尝试类似于链接的[WindowsIdentity](https://stackoverflow.com/questions/1192631/open-a-shared-file-under-another-user-and-domain)模拟，您必须有一个固定的用户/密码才能进行搜索，但这通常是您必须回退到的在谈论代码模拟时。

# java - 在java中创建一个gui元素

> ID：10022202
> 
> 赞同：2
> 
> 时间：2012-04-05T03:13:51.967
> 
> 标签：java, swing

当您像这样创建一个 GUI 元素（例如 JFrame）时

```
new JFrame(); // nothing pointing to it. 
```

这是错误的，因为没有任何东西指向它，所以它将被垃圾收集。我意识到这很有效，但我想确保它一直有效，即使垃圾收集器运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T03:17:36.430

您不需要保存引用该`JFrame`对象的引用变量（除非您以后想使用它）。您只需要调用构造函数`JFrame()`，窗口就会被构建。因此，在所有情况下，它都应该毫无问题地工作。

# ruby-on-rails-3 - 如何使用 sunspot_rails gem 为 belongs_to 关联编写可搜索的方法

> ID：10022203
> 
> 赞同：2
> 
> 时间：2012-04-05T03:14:06.227
> 
> 标签：ruby-on-rails-3, full-text-search, sunspot, sunspot-rails, sunspot-solr

我有两个模型。一个是品牌，另一个是product_detail。Brands 表有 id 和 name 字段，product_details 表有 id、name、price、discount 和 brand_id 字段。

品牌有很多 product_details 和 product_detail 属于品牌

brand.rb 看起来像：

```
class Brand < ActiveRecord::Base
    has_many :product_details
end 
```

和 product_details.rb 看起来像

```
class ProductDetail < ActiveRecord::Base
    belongs_to :Brand, :dependent=>:destroy
end 
```

我正在尝试使用太阳黑子轨道进行搜索。我想使用用户输入的文本根据品牌名称和产品名称进行搜索。为此，我编写了这样的可搜索方法：

```
class ProductDetail < ActiveRecord::Base
    belongs_to :brands, :dependent=>:destroy

     searchable do
      text :name
      text :brands do
        brands.map(&:name)
      end
    end
end 
```

当我运行 rake sunspot:reindex

它为 nil 类抛出错误未定义的方法映射

如果像这样更改代码

```
class ProductDetail < ActiveRecord::Base
    belongs_to :Brand, :dependent=>:destroy

     searchable do
      text :name
      text :Brand do
        brands.map(&:name)
      end
    end
end 
```

它为 product_detail 类抛出错误未定义的方法品牌

请帮助我如何做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T08:11:38.543

它应该是

```
belongs_to :brand, :dependent=>:destroy 
```

但是您确定要在删除与之关联的 product_detail 时删除该品牌吗？

在任何情况下，可搜索块应写为

```
searchable do
  text :name
  text :brand do
    brand.name
  end
end 
```

我希望，这会有所帮助。

# iphone - 我可以控制 iPhone 通话吗？

> ID：10022207
> 
> 赞同：0
> 
> 时间：2012-04-05T03:14:41.907
> 
> 标签：iphone, api, call

我正在开发一个 iOS 应用程序中的呼叫程序。这仅供个人使用，不适用于 App Store。我想控制 iPhone 应用程序在需要时给某人打电话、接听电话和断开电话。我可以控制 iPhone 通话吗？如果可以的话，我可以使用什么api？请说出一些，非常感谢！</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:19:13.027

不，这不能通过 iOS SDK 实现。

（不知道有没有针对越狱设备的解决方案。）

# python - 打开 .pyc 文件时出错

> ID：10022208
> 
> 赞同：0
> 
> 时间：2012-04-05T03:14:43.343
> 
> 标签：python

每当我尝试打开 .pyc 或 .pyo 文件时，我总是会收到一条错误消息，提示无法解码。

```
OS: Lion
Python: 3.0.1 
```

*我正在尝试在 IDLE 中打开它们，它询问我文件的当前编码是什么，并且预先输入的是`us-ascii`*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T03:16:26.383

这些是编译的 Python 字节码；它们可以由解释器执行，但它们不是人类可读或可编辑的。

```
python helloworld.pyc 
```

# django - django管理员登录不重定向

> ID：10022216
> 
> 赞同：7
> 
> 时间：2012-04-05T03:15:50.660
> 
> 标签：django, django-admin

我可以浏览 django 管理员登录页面，但是在键入正确的登录详细信息后，它将保留在具有空文本框的同一登录页面上。如果登录详细信息错误，它将显示消息。我有以下内容，我可以通过哪些方式进行故障排除，因为日志没有说明任何重要内容。

在 shell 上测试登录的方法有哪些？

使用 manage.py createsuperuser 创建超级用户，因为我在运行 syncdb 期间错过了默认用户

清除cookies，重试还是一样。

在 settings.py 中更正 SITE_ID

```
settings.py
import logging 
import pwd
import os

DEBUG = True
TEMPLATE_DEBUG = DEBUG
DEBUG_TOOLBAR = False
PROFILER_ON = False
INTERNAL_IPS = (
'127.0.0.1'
)

ADMINS = (
    ('Admin', 'test@domain.com'),
)

SEND_BROKEN_LINK_EMAILS = False
MANAGERS = ADMINS

DEFAULT_FROM_EMAIL = 'test@domain'
SERVER_EMAIL = DEFAULT_FROM_EMAIL

EMAIL_HOST = 'test'

UPLOAD_ROOT = '/domain/uploads'

 PUBLIC_UPLOAD_ROOT = '/domain/htdocs/public_uploads'

DATABASES = {
'default': {
    'ENGINE': 'django.db.backends.mysql',
    'NAME': 'table_name',
    'USER': 'username',
    'PASSWORD': 'password',
    'HOST': 'localhost',
    'PORT': '',
    # use this to create InnoDB tables
    'OPTIONS': {
        'init_command': 'SET storage_engine=InnoDB',
        'charset': 'utf8',
    }
}
}

#SESSION_COOKIE_SECURE = True

# Setup logging
LOGGING = {
'version': 1,
'disable_existing_loggers': True,
}

TIME_ZONE = 'America/Chicago'

LANGUAGE_CODE = 'en-us'

LANGUAGES = (
  ('en-us', _('English(US)')),
)

SITE_ID = 1
SITE_NAME = 'my site'

USE_I18N = True

MEDIA_ROOT = os.path.join(os.path.dirname(__file__), 'media')

MEDIA_URL = '/media/'

PUBLIC_UPLOAD_URL = '/public_uploads/'

UPLOAD_URL = '/uploads/'

UPLOAD_IMAGES_DIR = 'images/'

ADMIN_MEDIA_PREFIX = '/djangomedia/'

SECRET_KEY = 'test'

#SESSION_COOKIE_HTTPONLY = True

#SESSION_COOKIE_DOMAIN = 'domain'

# List of callables that know how to import templates from various sources.
TEMPLATE_LOADERS = (
'django.template.loaders.filesystem.Loader',
'django.template.loaders.app_directories.Loader',
)
MIDDLEWARE_CLASSES = (
'django.middleware.common.CommonMiddleware',
'django.contrib.sessions.middleware.SessionMiddleware',
'django.middleware.locale.LocaleMiddleware',
'django.middleware.csrf.CsrfViewMiddleware',
'django.contrib.auth.middleware.AuthenticationMiddleware',
'django.contrib.messages.middleware.MessageMiddleware',
'django.middleware.transaction.TransactionMiddleware',
'django.middleware.doc.XViewMiddleware',
'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware',
)

LOGIN_URL = '/login/'

LOGIN_REDIRECT_URL = '/users/main/'
# The URL where requests are redirected for logout.
LOGOUT_URL = '/logout/'

TEMPLATE_CONTEXT_PROCESSORS = (
'django.contrib.auth.context_processors.auth',
'django.core.context_processors.i18n',
'django.core.context_processors.request',
'django.contrib.messages.context_processors.messages',
)

AUTHENTICATION_BACKENDS = (
'django.contrib.auth.backends.ModelBackend',
)

ROOT_URLCONF = 'myapp.urls'

TEMPLATE_DIRS = (
os.path.join(os.path.dirname(__file__), 'templates'),
)

INSTALLED_APPS = (
'django.contrib.auth',
'django.contrib.contenttypes',
'django.contrib.sessions',
'django.contrib.sites',
'django.contrib.messages',
'django.contrib.admin',
'django.contrib.admindocs',
'django.contrib.flatpages',
)

urls.py
url(r'^admin/', include(admin.site.urls)), 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T16:39:15.470

> 这实际上是由于我的 settings.py 中的 SESSION_COOKIE_SECURE = True，我不小心在 2 个地方定义了它，一个评论了另一个未评论的地方，导致这种情况发生，因为该站点尚未在 https 下运行。这是个愚蠢的错误 – user1076881 4 月 5 日 7:27

# solr - solr 数据导入处理程序 jndi websphere

> ID：10022217
> 
> 赞同：0
> 
> 时间：2012-04-05T03:15:51.390
> 
> 标签：solr, websphere, jndi, dataimporthandler

我正在尝试在 db-data-config.xml 中使用 jndiName 属性。这在tomcat中效果很好。但是在 websphere 中存在问题。

抛出以下异常

“确保 J2EE 应用程序不会在静态代码块内或由该 J2EE 应用程序创建的线程中对“java:”名称执行 JNDI 操作。此类代码不一定在服务器应用程序请求的线程上运行，因此不受支持通过对“java:”名称的 JNDI 操作。[根异常是 javax.naming.NameNotFoundException：在上下文“java:”中找不到名称 comp/env/jdbc。”

似乎 websphere 从静态代码访问 jndi 资源时遇到问题。有没有人经历过这个？

```
 DataImporter  E org.apache.solr.common.SolrException log Full Import failed:org.apache.solr.handler.dataimport.DataImportHandlerException: Unable to execute query: <REMOVE SQL from here>
    at org.apache.solr.handler.dataimport.DataImportHandlerException.wrapAndThrow(DataImportHandlerException.java:72)
    at org.apache.solr.handler.dataimport.JdbcDataSource$ResultSetIterator.<init>(JdbcDataSource.java:253)
    at org.apache.solr.handler.dataimport.JdbcDataSource.getData(JdbcDataSource.java:210)
    at org.apache.solr.handler.dataimport.JdbcDataSource.getData(JdbcDataSource.java:39)
    at org.apache.solr.handler.dataimport.SqlEntityProcessor.initQuery(SqlEntityProcessor.java:59)
    at org.apache.solr.handler.dataimport.SqlEntityProcessor.nextRow(SqlEntityProcessor.java:73)
    at org.apache.solr.handler.dataimport.EntityProcessorWrapper.nextRow(EntityProcessorWrapper.java:238)
    at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:596)
    at org.apache.solr.handler.dataimport.DocBuilder.doFullDump(DocBuilder.java:268)
    at org.apache.solr.handler.dataimport.DocBuilder.execute(DocBuilder.java:187)
    at org.apache.solr.handler.dataimport.DataImporter.doFullImport(DataImporter.java:359)
    at org.apache.solr.handler.dataimport.DataImporter.runCmd(DataImporter.java:427)
    at org.apache.solr.handler.dataimport.DataImporter$1.run(DataImporter.java:408)
Caused by: javax.naming.ConfigurationException: A JNDI operation on a "java:" name cannot be completed because the server runtime is not able to associate the operation's thread with any J2EE application component.  This condition can occur when the JNDI client using the "java:" name is not executed on the thread of a server application request.  Make sure that a J2EE application does not execute JNDI operations on "java:" names within static code blocks or in threads created by that J2EE application.  Such code does not necessarily run on the thread of a server application request and therefore is not supported by JNDI operations on "java:" names. [Root exception is javax.naming.NameNotFoundException: Name comp/env/jdbc not found in context "java:".]
    at com.ibm.ws.naming.java.javaURLContextImpl.throwConfigurationExceptionWithDefaultJavaNS(javaURLContextImpl.java:428)
    at com.ibm.ws.naming.java.javaURLContextImpl.lookup(javaURLContextImpl.java:399)
    at com.ibm.ws.naming.java.javaURLContextRoot.lookup(javaURLContextRoot.java:214)
    at com.ibm.ws.naming.java.javaURLContextRoot.lookup(javaURLContextRoot.java:154)
    at javax.naming.InitialContext.lookup(InitialContext.java:436)
    at org.apache.solr.handler.dataimport.JdbcDataSource$1.call(JdbcDataSource.java:140)
    at org.apache.solr.handler.dataimport.JdbcDataSource$1.call(JdbcDataSource.java:128)
    at org.apache.solr.handler.dataimport.JdbcDataSource.getConnection(JdbcDataSource.java:363)
    at org.apache.solr.handler.dataimport.JdbcDataSource.access$200(JdbcDataSource.java:39)
    at org.apache.solr.handler.dataimport.JdbcDataSource$ResultSetIterator.<init>(JdbcDataSource.java:240)
    ... 11 more
Caused by: javax.naming.NameNotFoundException: Name comp/env/jdbc not found in context "java:".
    at com.ibm.ws.naming.ipbase.NameSpace.getParentCtxInternal(NameSpace.java:1837)
    at com.ibm.ws.naming.ipbase.NameSpace.lookupInternal(NameSpace.java:1166)
    at com.ibm.ws.naming.ipbase.NameSpace.lookup(NameSpace.java:1095)
    at com.ibm.ws.naming.urlbase.UrlContextImpl.lookup(UrlContextImpl.java:1233)
    at com.ibm.ws.naming.java.javaURLContextImpl.lookup(javaURLContextImpl.java:395)
    ... 19 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T15:11:48.213

Solr 在这里使用非托管线程，并在其中一个线程的 java: 命名空间中进行 JNDI 查找。这在 WebSphere 中不受支持，因为 WebSphere 根据执行查找的线程来识别 java: 名称空间。Tomcat 基于线程上下文类加载器来执行此操作，这解释了行为上的差异。请注意，J2EE 规范不允许非托管线程，因此 WebSphere 的行为实际上是符合标准的。

# php - 使用 PHP 和 google Maps Api 计算 2 纬度和经度之间的距离

> ID：10022218
> 
> 赞同：0
> 
> 时间：2012-04-05T03:15:55.353
> 
> 标签：php, google-maps

只是想知道如何使用 PHP 和 Google Maps Api 计算 2 个纬度和经度之间的距离。

有人有任何想法或示例链接吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:19:42.987

[计算谷歌地图V3中两点之间的距离](https://stackoverflow.com/questions/1502590/calculate-distance-between-two-points-in-google-maps-v3)

我想你可能会追求这样的东西，它有一些很好的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T14:06:46.587

```
function calcDistance($lat1,$Lang1, $lat2, $Lang2)
{
    //RAD
    $b1 = ($lat1/180)*M_PI;
    $b2 = ($lat2/180)*M_PI;
    $l1 = ($Lang1/180)*M_PI;
    $l2 = ($Lang2/180)*M_PI;
    //equatorial radius
    $r = 6378.137;
    // Formel
    $e = acos( sin($b1)*sin($b2) + cos($b1)*cos($b2)*cos($l2-$l1) );
    return round($r*$e, 4);
} 
```

# android - 在 xml 中引用 android.R.drawable.ic_menu_preferences

> ID：10022219
> 
> 赞同：4
> 
> 时间：2012-04-05T03:16:07.240
> 
> 标签：android

我知道只有两种形式可以检索 xml 文件中的资源值：'@' 用于可绘制资源和 '?' 用于主题资源。

现在我想使用“android.R.drawable.ic_menu_preferences”作为选项菜单项“设置”的图标。但这不起作用：

```
<item android:icon="@android.R.drawable/ic_menu_preferences"> 
```

这可以在代码中解决：

```
MenuItem settings;
settings.setIcon(android.R.drawable.ic_menu_preferences); 
```

但是从开发指南中，我知道最好在 xml 中创建菜单项。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-05T03:20:53.883

利用

```
<item android:icon="@android:drawable/ic_menu_preferences"> 
```

# c# - 将数据从一个网格视图复制到另一个略有不同的网格视图

> ID：10022223
> 
> 赞同：1
> 
> 时间：2012-04-05T03:16:34.963
> 
> 标签：c#, gridview, copy

我有一个带有 2 列 A 和 B 的 gridview1，我希望能够将这些列复制到 gridview2 中，它有 3 列 AB 和 C，其中 A 和 B 与 gridview1 中的 A 和 B 具有相同的标题。我如何在 C# 中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:37:28.130

如果您将gridview1 与数据表动态绑定，那么您可以将C 列添加到数据表并将其绑定到gridview2。

如果您没有数据表，那么您可以尝试将gridview1 数据转换为数据表并添加coulmn C，然后绑定到gridview2。

如在帖子中：[如何将 GridView.DataSource 导出到数据表或数据集？](https://stackoverflow.com/questions/785799/how-can-i-export-a-gridview-datasource-to-a-datatable-or-dataset)

# java - Maven Build 与依赖树不同

> ID：10022225
> 
> 赞同：7
> 
> 时间：2012-04-05T03:17:15.813
> 
> 标签：java, maven

我正在使用 Maven 3 构建一个具有 3 层的 Java 应用程序 - 服务器、ejb 和 ui。EJB 项目依赖于Server 项目，UI 项目只依赖EJB，并为Server 传递依赖提供了排除。

当 UI 项目构建为战争时，尽管它没有显示在 dependency:tree 命令中，但仍包含服务器依赖项。

这是运行的相关输出`mvn dependency:tree`

```
**project.name:UI:war:1.0 SNAPSHOT**
+-  project.name:Common:jar:1.0 SNAPSHOT:compile
|   +  org_common:_lib:jar:16.0.006:compile
|   |  +- log4j:log4j:jar:1.2.16:compile
|   |  \- commons configuration:commons configuration:jar:1.6:compile
|   |     +- commons lang:commons lang:jar:2.4:compile
|   |     +- commons digester:commons digester:jar:1.8:compile
|   |     \- commons beanutils:commons beanutils core:jar:1.8.0:compile
|   +- org_common:_security_lib:jar:16.0.006:compile
|   \- org.springframework:spring:jar:2.0:compile
+-  **project.name:EJB:ejb client:client:1.0 SNAPSHOT:compile**
|   \- com.ibm.websphere.appserver:j2ee:jar:7.0.0.9:compile
+-  org_common:_uicomponent:jar:16.0.006:compile 
```

这是运行时的输出依赖树`mvn clean install -X`

```
**project.name:UI:war:1.0 SNAPSHOT**
+-  project.name:Common:jar:1.0 SNAPSHOT:compile
|   +  org_common:_lib:jar:16.0.006:compile
|   |  +- log4j:log4j:jar:1.2.16:compile
|   |  \- commons configuration:commons configuration:jar:1.6:compile
|   |     +- commons lang:commons lang:jar:2.4:compile
|   |     +- commons digester:commons digester:jar:1.8:compile
|   |     \- commons beanutils:commons beanutils core:jar:1.8.0:compile
|   +- org_common:_security_lib:jar:16.0.006:compile
|   \- org.springframework:spring:jar:2.0:compile
+-  **project.name:EJB:ejb client:client:1.0 SNAPSHOT:compile**
|   +- **project.name:Server:jar:1.0 SNAPSHOT:compile**
|   |   +- javassist:javassist:jar:3.4.GA:compile
|   |   +- project.filestore:filestore_client:jar:7.0.003:compile
|   |   +- com.ibm.db2:db2jcc:jar:9.7.fp1.aix64.s091114:compile
|   |   +- com.ibm.db2:db2java:jar:9.7.fp1.aix64.s091114:compile
|   |   +- com.ibm.db2:db2jcc_license_cu:jar:9.7.fp1.aix64.s091114:compile
|   \- com.ibm.websphere.appserver:j2ee:jar:7.0.0.9:compile
+-  org_common:_uicomponent:jar:16.0.006:compile 
```

对 Server 的依赖是两棵树之间的唯一区别。这两个输出不应该总是相同的吗？什么可能导致包含未显示在依赖项中的库：树？

父 POM 将模块定义为：

```
<modules>
    <module>Server</module>
    <module>EJB</module>
    <module>UI</module>
</modules> 
```

EJB POM 中列出的依赖项是：

```
<dependencies>
        <dependency>
            <groupId>project.name</groupId>
            <artifactId>Server</artifactId>
            <version>${project.version}</version>
        </dependency>
    </dependencies> 
```

UI中的依赖是：

```
<dependencies>
        <dependency>
            <groupId>project.name</groupId>
            <artifactId>EJB</artifactId>
            <version>${project.version}</version>
            <type>ejb-client</type>
            <exclusions>
                <exclusion>
                    <groupId>project.name</groupId>
                    <artifactId>Server</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
</dependencies> 
```

我知道我可以明确地将服务器 jar 排除在 WAR 中，但我更愿意解决实际问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T02:19:15.333

你是对的，两种情况下的输出应该是相同的。然而，Maven 3 转而使用 Aether 进行依赖解析，但截至目前，dependency:tree 使用旧的依赖解析机制，这就是差异的原因。详情请查看以下链接。

[https://cwiki.apache.org/MAVEN/maven-3x-compatibility-notes.html#Maven3.xCompatibilityNotes-DependencyResolution](https://cwiki.apache.org/MAVEN/maven-3x-compatibility-notes.html#Maven3.xCompatibilityNotes-DependencyResolution)

由于这个原因，您应该只依赖 mvn clean install -X 的输出来进行依赖管理。

**编辑**

由于 Maven 依赖插件的 2.5 版，`dependency:tree`也使用 Aether（请参阅[错误报告](http://jira.codehaus.org/browse/MDEP-339)和[发行说明](http://jira.codehaus.org/secure/ReleaseNote.jspa?projectId=11214&version=18077)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T07:45:33.880

正如我们在评论中发现的那样，问题的根源是有缺陷的 Maven 3.0.3。3.0.4 版解决了这个问题。

我在那里的评论：

> 您使用哪个确切的 Maven 版本？如果不是 3.0.4，试试看它是否有帮助。在使用以前的 Maven 3 版本（主要是 3.0.2）时，我发现了非常非常糟糕的问题。

# python - Python/Django 的数据库本地化（多语言）设计

> ID：10022226
> 
> 赞同：2
> 
> 时间：2012-04-05T03:17:19.283
> 
> 标签：python, database, django, localization, translation

我目前正在创建一个应用程序，说不同语言的人将在该应用程序上访问信息。这些信息将是高度独特的，因此使用翻译工具还不够好。所有信息都需要使用不同的语言，当用户登录时，信息会根据他的设置显示。现在，该应用程序基于 Django 和 MySQL。我看到 Django 有本地化功能，但我不太明白。是调用翻译机制还是什么？我不明白。

撇开这一点不谈，我想知道解决这个问题的最佳方法是什么。目前尚不清楚不同语言的数量。所以我不认为将每一列的准确翻译存储在**一个表中**是一个好主意，即使它可以在查询时节省时间。（没有内部连接等）。

1) 我应该研究 Django 本地化功能吗？究竟是什么？[我真的不想将翻译存储到文件中。]

2) 哪种数据库设计最适合多语言应用程序？我找到了那些：

*   [http://www.codeproject.com/Articles/8084/Creating-multilingual-websites-Part-2](http://www.codeproject.com/Articles/8084/Creating-multilingual-websites-Part-2)
*   将每个信息的翻译存储在同一个表中，并在不同的列中附加 _language。
*   [多语言数据库的架构](https://stackoverflow.com/questions/316780/schema-for-a-multilanguage-database)

人们通常如何解决这个问题？非常感谢！

编辑：我并不是特别在寻找易于使用的东西。主要是为了一些高性能并且不会在我的数据库中造成巨大混乱的东西......这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T09:36:59.927

1) Django i18n 机制用于允许本地化静态文本-模板中的标签、字段名称、错误消息-基本上是您不存储在数据库中的所有文本。它对数据库内容的翻译没有多大帮助。

2）我看到的多语言 django 模型的每一项主要工作都使用以下方法之一：

*   将 modelname_lang 列添加到同一个表中。
*   将共享字段存储在一个表中，将翻译存储在另一个表中。

我建议您决定您更喜欢哪种方法，并为所选方法使用记录最好的模型翻译应用程序。

如果您要使用几种语言，那么我建议您采用第一种方法。另一方面，如果语言的数量越来越多，则第二种方法可能更可行。

# objective-c - NSFetchedResultsController 返回具有空属性的对象

> ID：10022233
> 
> 赞同：0
> 
> 时间：2012-04-05T03:18:17.137
> 
> 标签：objective-c, ios, cocoa-touch, core-data

所以我将 mogenerator 与 Core Data 一起使用，当我第一次加载 tableview 时，resultsController 返回具有有效属性的好对象。但是当我滚动表格时，所有重新加载的单元格都填充有从 resultsController 返回的具有空属性的对象。是缓存问题吗？

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    // Configure the cell...
    Log *log = [self.resultsController objectAtIndexPath:indexPath];
    cell.textLabel.text = [NSString stringWithFormat:@"%@", log.text];
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T07:34:01.793

原来我不应该将 resultsController 放在 viewWillLoad 或 viewDidLoad 中。我将它放入它自己的访问方法中，现在它工作正常。

# xml - 下载多个小图像的最佳方法

> ID：10022235
> 
> 赞同：1
> 
> 时间：2012-04-05T03:18:26.937
> 
> 标签：xml, image, download

我发现了另一个类似的问题：[Best way to download images from XML content](https://stackoverflow.com/questions/9002019/best-way-to-download-images-from-xml-content) in StackOverflow，但不完全相同。

我有多个来自 XML 内容的小图像，并且我可以控制服务器端和客户端。我应该将图像字节嵌入 XML 还是只传递 XML 中每个图像的 url 并期望客户端再次发起 http 调用以下载图像？我正在拍摄低延迟但不是很多图像：100 张大小为 10-15k 的图像。

欢迎任何建议/评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:41:07.383

这取决于您的 XML 将如何被使用。

如果只使用部分图像，那么将 URL 放入 XML 中是最好的解决方案。

如果您期望 XML 用户每次都会使用所有图像，那么将图像嵌入到 XML 中并不是一个坏主意。

如果是我，我会将 URL 放入 XML 中，因为这是更可扩展的解决方案，并且可能更易于维护。XML 的一个重要“特性”是可读性强。将大量二进制数据放入 XML 会破坏该目的。

在 XML 中包含 URL 可能不会引入巨大的延迟问题，因为客户端可以使用许多技术来减少延迟（就像 SLaks 建议的那样）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T03:24:37.127

您应该使用单个 HTTP 请求并返回[多部分 MIME 响应](http://en.wikipedia.org/wiki/MIME#Multipart_messages)。

# c - 为什么 (void)0 停止“声明无效”警告？

> ID：10022239
> 
> 赞同：9
> 
> 时间：2012-04-05T03:19:24.440
> 
> 标签：c, macros

我有一个`trace()`宏，我用另一个宏打开和关闭，例如

```
#ifdef TRACE
    #define trace(x) trace_val(x, 0)
#else
    #define trace(x) 0
#endif 
```

当我使用undefined`warning: statement with no effect`调用时，这会从 gcc生成。经过一番搜索，我发现改变了`trace()``TRACE`

```
#define trace(x) 0 
```

到

```
#define trace(x) (void)0 
```

使错误静音。我的问题是：为什么？有什么不同？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T03:22:45.310

强制转换为 void 清楚地表明程序员打算将结果丢弃。警告的目的是表明该语句没有效果并不明显，因此提醒程序员注意这一点是有用的，以防它是无意的。这里的警告没有任何意义。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-05T03:22:59.647

警告和解决方法是特定于编译器的。但是，您可以执行以下操作：

```
#define NOP do { } while(0)

#ifdef ENABLE_TRACE
    #define TRACE(x) trace_val(x, 0)
#else
    #define TRACE(x) NOP
#endif 
```

这首先避免了潜在的问题。

# c# - Neo4j 与 C# 在生产中

> ID：10022242
> 
> 赞同：3
> 
> 时间：2012-04-05T03:19:49.410
> 
> 标签：c#, api, rest, neo4j

有人在生产中使用 Neo4j 和 REST API 吗？我一直在查看 REST API 的不同实现，并注意到这个已经被下载了好几次

[http://hg.readify.net/neo4jclient/overview](http://hg.readify.net/neo4jclient/overview)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T23:21:35.587

瑞安，

我是图书馆的开发人员之一。我们的日常项目有一个由 5 名开发人员组成的专门团队，并在生产中使用 Neo4j（在 Azure 上，只是为了更好地衡量）。在构建解决方案时，我们一直在构建库。

我们的解决方案 100% 依赖于这个库的可靠性。

高温下，

泰坦

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T19:21:10.210

那里有很多生产实例，基本上任何使用 REST 绑定之一的人（参见[http://docs.neo4j.org/chunked/snapshot/tutorials-rest.html](http://docs.neo4j.org/chunked/snapshot/tutorials-rest.html)）都在针对它运行。也许在邮件列表中询问，[http ://groups.google.com/group/neo4j/about](http://groups.google.com/group/neo4j/about)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T03:40:05.600

Just to update this question with a more current option consider using the Neo4jClient from NuGet. The package and links to the project site are at [http://nuget.org/packages/Neo4jClient](http://nuget.org/packages/Neo4jClient)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T04:30:50.937

您可以在此处查看使用此库并且是开源的示例应用程序：

hg 克隆[https://bitbucket.org/romiko/frictionfree](https://bitbucket.org/romiko/frictionfree)

高温高压

# java - 通过 USB 传输 Android 文件

> ID：10022245
> 
> 赞同：0
> 
> 时间：2012-04-05T03:20:16.710
> 
> 标签：java, android

如何使用 Java 通过 USB 连接从 Android 手机复制文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:41:40.490

您可以使用“adb pull”命令或 TCP，adb pull 也基于 TCP。Runtime.getRuntime().exec("adb pull ...");

请试试这个。

# asp.net - 扩展表单身份验证以对票证使用自定义 http 标头

> ID：10022246
> 
> 赞同：6
> 
> 时间：2012-04-05T03:20:23.790
> 
> 标签：asp.net, forms-authentication, webhttp

我有一个 wcf webhttp 服务，它使用表单身份验证来对用户进行身份验证。如果票在 cookie 集合或 url 中，这很好用。

但现在我想在自定义 http 标头中发送表单身份验证票的字符串，并更改表单身份验证模块以检查该标头而不是 cookie。

我认为扩展表单身份验证来实现这一点应该很容易，但找不到任何资源。你能为我指出正确的方向吗 ？

这是我的身份验证流程的工作方式，

1.  客户端使用用户名和密码调用身份验证方法
2.  服务返回加密的票证字符串
3.  客户端将收到的票证字符串与每个后续请求一起发送到 http 标头中
4.  服务检查身份验证标头并验证身份验证票

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T03:57:48.493

FormAuthentication 模块不可扩展，但您可以编写自己的身份验证。这很简单：

身份验证（2）：

```
 var formsTicket = new FormsAuthenticationTicket(
    1, login, DateTime.Now, DateTime.Now.AddYears(1), persistent, String.Empty);
var encryptedFormsTicket = FormsAuthentication.Encrypt(formsTicket);
//return encryptedFormsTicket string to client 
```

附有票证的服务电话（4）：

```
 var ticket = FormsAuthentication.Decrypt(encryptedFormsTicket)
//extract authentication info from ticket: ticket.Name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T14:31:33.570

我不确定这是要走的路（优雅方面），但是如何在 global.asax.cs 中为 Application BeginRequest 添加一个事件并从标头中获取字符串并自己将 cookie 注入请求中（表单身份验证应该然后拿起它）。

就像是：

```
 protected void Application_BeginRequest()
{
    // Your code here to read request header into cookieText variable
    string cookieText = ReadCookieFromHeader();

    var cookieData = FormsAuthentication.Decrypt(cookieText);

    if (!cookieData.Expired)
    {
        HttpContext.Current.Request.Cookies.Add(new HttpCookie(cookieData.Name, cookieText));
    }
} 
```

免责声明：请注意，我没有对此进行测试，只是以您的方式提出一种可能的方法！

# css - 需要帮助设置此列表的样式

> ID：10022255
> 
> 赞同：1
> 
> 时间：2012-04-05T03:22:16.690
> 
> 标签：css, wordpress, list

我正在设计来自 wordpress 插件的最近帖子和图像列表。我知道有一个 wordpress 部分，但我的问题是就如何设置此列表的样式获得一些建议。

[网站在这里](http://ambergoodwin.com/averylawoffice/averytest)

这就是它现在的样子。

![在此处输入图像描述](../Images/25e403315f2bafd7a12257ae2ad8a143.png)

这是我的 CSS

```
.advanced-recent-posts { 
        list-style-type: none; 
    }

    .advanced-recent-posts li { 
        font-size: .7em; 
        font-weight: bold; 
        line-height: 20px; 
        color: #761616; 
        margin-bottom: 10px;
        text-transform: uppercase; 
        width: 250px; 
        position: relative; 
        top: -35px; 
        border: 1px solid #000;
    }

    .advanced-recent-posts li a {
        margin-left: 10px;
    }

    .advanced-recent-posts li img {
        position: relative; 
        top: 0px; 
        left: -10px; 
        padding: 5px; 
        border: 1px solid #999;
    } 
```

到目前为止一切顺利。但是因为图像和标题和日期都在一些

*   它们一起移动，这不是我想要的，但因为它是一个插件，我不知道如何改变它。因此，我希望通过提供的网站和 CSS，有人可以帮助我将最近每篇文章的第二行直接放在第一行之下。就像我在这里的设计一样。

    ![在此处输入图像描述](../Images/e2b9943658d312ff52f7a8569cb4b60b.png)

    @Bonjour：这就是我要做的

    ```
    .advanced-recent-posts li { display:table-row; vertical-align:top;} 
    ```

    （当然还有我上面的所有其他样式）

    ![在此处输入图像描述](../Images/799e5d3dadd7176eae19580f7ad99c74.png)

    帖子标题至少是正确的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:27:09.037

尝试修改锚的样式，即。

```
.advanced-recent-posts li a {
    display: block;
    margin-left: 10px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T03:51:56.937

那里发生了一些奇怪的定位。无论如何，有两种方法可以做到这一点：

1.  将图像向左浮动，添加一点右/下填充。这样文字自然会在图像下方流动
2.  `li`利用图像上的和设置的相对定位`position:absolute`，同时提供`li`足够的填充以从其下方移动文本。这样文字将永远不会在图像下方流动

示例：http: [//jsfiddle.net/Ucrsk/](http://jsfiddle.net/Ucrsk/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T04:23:01.273

只是重申我在您问题中的评论，请尝试使用：

```
li {
    display:table-cell;
    vertical-align:top;
} 
```

**或者**

```
li {
    display:table-row;
    vertical-align:top;
} 
```

# batch-file - .bat %server% 通配符访问服务器共享

> ID：10022262
> 
> 赞同：0
> 
> 时间：2012-04-05T03:23:27.703
> 
> 标签：batch-file, cmd, share

我们正在编写一个将导航到服务器共享的 .bat 脚本，我们打算为几个不同的网络执行此操作。共享将保持不变，但服务器将始终由于不同的客户网络而变化。我们需要以与使用 %username% 或 %domain% 类似的方式使用通配符。由于我们有多个网络和服务器名称来处理此脚本，因此需要非常通用。

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T02:30:16.587

好的答案系统变量是 %LOGONSEVER% = Local 返回验证当前登录会话的域控制器的名称。谢谢您的帮助

# java - 建议修复 if 语句中的错误非法状态异常

> ID：10022263
> 
> 赞同：0
> 
> 时间：2012-04-05T03:23:32.730
> 
> 标签：java, primes

我正在编写一个打印具有给定长度的素数集的应用程序。这是一个通用长度的应用程序，例如从 1 到 100 的所有数字

```
import java.util.Iterator;
import java.util.Set;
import java.util.TreeSet;

public class Sieve
{
    private int number;

    public Sieve (int maxPrime)
    {
        number = maxPrime;
    }

    public Set<Integer> getPrimes()
    {
        Set<Integer> setNumbers = new TreeSet<Integer>();

        for(int i=2; i<=number; i++)
        {
            setNumbers.add(i);
        }

        Iterator<Integer> iter = setNumbers.iterator();

        while(iter.hasNext())
        {
            int number1 = iter.next();

            for( int i = 2; i <= Math.sqrt(number); i++ )
            {
                if( number1 % i == 0)
                {
                    iter.remove();
                }
            }

        } 
        return setNumbers;
    }
} 
```

给我错误的部分是 if 语句中的部分。它说非法状态异常。有人可以帮我弄清楚如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:26:42.690

您在`remove`之间多次调用该方法`next`。从[文档](http://docs.oracle.com/javase/7/docs/api/java/util/Iterator.html#remove%28%29)：

> “IllegalStateException - 如果尚未调用下一个方法，或者在最后一次调用下一个方法之后已经调用了删除方法”

它应该是：

```
bool isComposite = false;

for( int i = 2; i <= Math.sqrt(number1); i++ )
{
    if( number1 % i == 0)
    {
        isComposite = true;
        break;
    }
}

if(isComposite)
{
    iter.remove();
} 
```

算法错误是您要达到`number`（要考虑的最大可能素数）的平方根，而不是`number1`您正在考虑的当前素数的根。这意味着您将排除 2，因为它小于 sqrt(100) 并且是 2 的倍数。

这表明您应该使用更好的变量名。

# php - 32 字节空缓冲区

> ID：10022264
> 
> 赞同：0
> 
> 时间：2012-04-05T03:23:43.633
> 
> 标签：php, encryption, buffer

我确信这是一件简单的事情，但在 php 中我需要创建一个 32 字节的清空变量（即全为零）。我正在尝试在 php 中解码初始化向量全为零的 AES 加密消息。如果我使用 null 或 0，那么我会收到一个错误，它需要 32 个字节，如果我使用“000000000000000000000000000000000”，那是字符串，也不是全零。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T03:28:30.907

如果“全零”是指*零字节*：

```
str_repeat("\x0", 32) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T03:27:22.030

尝试使用这个：

```
pack(str_repeat('x', 32)) 
```

# visual-studio-express - 在 Visual Studio Express 中设置启动程序

> ID：10022273
> 
> 赞同：2
> 
> 时间：2012-04-05T03:24:53.507
> 
> 标签：visual-studio-express

我想`Nuint`在 Visual 中运行，所以我设置

```
<StartAction>Program</StartAction>
<StartProgram>$(NUNIT_PATH)\nunit.exe</StartProgram>
<StartArguments>Test.dll</StartArguments>
<StartWorkingDirectory>Test\bin\Debug</StartWorkingDirectory> 
```

在我的 csproj 文件中。但它仍然不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T06:39:21.363

这些条目对于项目文件看起来是正确的。问题的最可能原因`$(NUNIT_PATH)`是没有正确设置，因此被评估为无。这将导致 Visual Studio 在`Test\bin\Debug`目录中查找 nunit.exe。

要对此进行测试，请尝试将 nunit.exe 二进制文件的完整路径硬编码到文件中。

```
<StartProgram>C:\the\path\nunit.exe</StartProgram> 
```

如果这有效，则该`NUNIT_PATH`值未正确设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T13:42:51.470

不幸的是，Express 版本不支持 StartAction 机制。请参阅 MSDN [How to: Change the Start Action for Application Debugging](http://msdn.microsoft.com/en-us/library/68c8335t.aspx)。

我正在寻找替代品；-)

更新参见[SO-a/10572249/717355](https://stackoverflow.com/a/10572249/717355)：尝试[http://www2.wealth-lab.com/Wiki/kbDebugExpress.ashx](http://www2.wealth-lab.com/Wiki/kbDebugExpress.ashx)步骤 13 以获取有关让 MSVC 认为它直接调试您的代码的建议。- 未尝试。

# ruby-on-rails - 无法在 Rails 应用程序中重新创建 postgres 数据库

> ID：10022276
> 
> 赞同：3
> 
> 时间：2012-04-05T03:25:14.153
> 
> 标签：ruby-on-rails, postgresql

因此，在我的开发 Mac 上使用我的 rails 应用程序有一个工作的 postgres db 实例，但是当我从头开始构建模型（即添加、删除、更改列）时，迁移变得难以管理，所以我决定开始清理。运行 rake db:drop 后，我无法通过 rake db:create 重新创建。我只是得到以下信息：

无法为 {"adapter"=>"postgresql"、"encoding"=>"unicode"、"database"=>"xyz_development"、"pool"=>5、"username"=>"xyz" 创建数据库， “密码”=>无}

我想我需要在 postgres 中创建用户，但它不应该从初始设置就在那里吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:44:14.787

您应该会在日志输出中看到创建数据库的 SQL 语句，并且可能还会看到错误。检查那个。

还要检查数据库是否不存在。尝试使用您在 rails 中使用的用户名/密码手动创建数据库`psql(1)`，看看会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T07:27:51.187

```
$ createdb xyz_development 
```

使用 postgres bin createdb

# c#-2.0 - DataGridView 的 OnPaint 事件中的无限循环是否正常？

> ID：10022278
> 
> 赞同：2
> 
> 时间：2012-04-05T03:25:16.307
> 
> 标签：c#-2.0

我有以下代码：

```
int a = 0;
    protected override void OnPaint(System.Windows.Forms.PaintEventArgs e)
    {

       base.OnPaint(e);         

        this.Rows[1].Cells[1].Value = a += 1;
    } 
```

我可以看到变量增加到无穷大。我正在用它来绘制一个图形来制作它的一个实例，它工作正常。这是正常的吗？我正在创建无限图实例？或者我有问题但我不知道

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T03:27:57.793

当您更改值时，网格需要重新`Paint`自身，从而`Paint`再次触发事件并重新执行您的代码。
此行为是设计使然。

通常，您永远不应该更改`Paint`处理程序中的外部状态；绘图代码应该是幂等的（除了提供的`Graphics`）。
`Paint`事件是不可预测的，并且会经常触发。

# windows - 将更改推送到远程分支时出现奇怪的无效字符错误

> ID：10022282
> 
> 赞同：1
> 
> 时间：2012-04-05T03:25:28.250
> 
> 标签：windows, git

我正在使用 Windows 机器来推送我在 Eclipse 中更改的 java 文件中的更改。我能够成功提交更改，但是当我尝试将这些更改推送到远程分支时，它会引发以下错误

```
 fatal: invalid characters in /tuscany/jupiter
  fatal: The remote end hung up unexpectedly 
```

我尝试通过 TortoiseGot/GIT UI/GIT Bash 推送更改，但它们都给出了相同的错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T10:53:07.960

您是否在要推送到的目标服务器上使用 Gitolite？

*   我在 Git 存储库本身（请参阅[GitHub:git/git 搜索结果](https://github.com/search?utf8=%E2%9C%93&q=repo%3agit/git%20%22invalid%20characters%22&repo=&langOverride=&start_value=1&type=Code&language=)）中没有找到该错误消息，而不是在 Egit 存储库（[Egit 搜索结果](https://github.com/search?utf8=%E2%9C%93&q=repo%3aeclipse/egit%20%22invalid%20characters%22&repo=&langOverride=&start_value=1&type=Code&language=)）中
*   但是，我确实在 Gitolite rpeo 中发现了该错误消息（参见[GitHub:sitaramc/gitolite 搜索结果](https://github.com/search?utf8=%E2%9C%93&q=repo%3asitaramc/gitolite%20%22invalid%20characters%22&repo=&langOverride=&start_value=1&type=Code&language=)），[例如在`gl-mirror-shell`](https://github.com/sitaramc/gitolite/blob/master/src/gl-mirror-shell#L157).

在这种情况下（Gitolite），请确保远程仓库的名称（见`git remote -v show`输出）遵循模式。

```
$repo =~ s/\.git$//;
$repo =~ s(^/)(); 
```

# linux - sed 脚本不适用于某些条目

> ID：10022285
> 
> 赞同：3
> 
> 时间：2012-04-05T03:25:49.973
> 
> 标签：linux, sed

我有一个名为的文件`messages.properties`，其中包含带有语法的行`<key>=<string>`。每个`key`都是独一无二的，但`string`不是。许多键可以有相同的字符串。同样在同一个文件夹中，我有一些 java 类从`messages.properties`. 他们通过方法获取字符串`Messages.getString("<key>")`。所以我需要做的是`Messages.getString("<key>")`通过`"<key>"`从`messages.properties`. 这是来自@potong 的 sed onliner 可以解决问题。

```
sed 's|^\([^=]*\)=\(.*\)|s@Messages.getString("\1")@"\2"@g|;s/\\/\\\\/g' messages.properties |
sed -i -f - *.java 
```

然而，这个问题是它不适用于`messages.properties`. 我应该如何修改脚本来解决这个问题？这是一个相关的问题[Search and replace with sed](https://stackoverflow.com/q/10002904/1068546) 。

示例messages.properties

```
Sting.1=Str
Sting.2=String
Sting.3=String
Sting.4=Strring
Sting.5=Str 
```

示例 java 类

```
System.Out.println(Messages.getString("Sting.1"));
System.Out.println(Messages.getString("Sting.2"));
System.Out.println(Messages.getString("Sting.3"));
System.Out.println(Messages.getString("Sting.4"));
System.Out.println(Messages.getString("Sting.5")); 
```

需要的java类

```
System.Out.println("Str");
System.Out.println("String");
System.Out.println("String");
System.Out.println("Strring");
System.Out.println("Str"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:11:57.063

实际问题是日食分裂

```
Messages.getString("String.3") 
```

分成2行，

```
 Messages
        .getString("String.3") 
```

所以这行得通。

```
sed 's|^\([^=]*\)=\(.*\)|s@.getString("\1")@"\2"@g|;s/\\/\\\\/g' messages.properties |
sed -i -f - *.java 
```

# django - django 中的简单错误日志消息

> ID：10022288
> 
> 赞同：0
> 
> 时间：2012-04-05T03:26:16.157
> 
> 标签：django, logging

我在 1.3 中通过 Django 的日志记录机制设置了错误电子邮件。发生错误时，它会向我发送一封不错的电子邮件。但是，当我记录一个简单的错误消息时，它的格式很奇怪，我不知道为什么。

例如，我的应用程序中有一个条件，如果我想知道的数据库中不存在某些内容，但我有一个合适的默认值可以正常工作。因此，我想向我发送一封包含一些信息的电子邮件；它不一定发生在异常上。

如果我做这样的事情：

logger.error("数据库中不存在操作 %s 的费用", "actionX")

日志文件中的信息很好，但电子邮件确实缺少一些信息。这是主题行：

```
[Django] ERROR: Test this jazz %s 
```

然后是身体：

```
None

Request repr() unavailable 
```

我的问题是，我如何获得 A) 显示在主题中的值和 B) 在正文中获得一些实际的相关信息....比如行号或类似的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T19:26:25.320

你需要承认两件事：

1.  您想使用 Python 的内置日志系统发送电子邮件，并且
2.  您没有记录常规异常，因此用于发送电子邮件的内置机制将不起作用，因为它取决于要传递的异常类型对象以及要存储在回溯中的内容。

总之，不是不可能！

```
LOGGING = {
   ...
   'handlers': {
        ...
        'my_special_mail_handler': {
            'level': 'ERROR',
            'filters': [],
            'class': 'myapp.loggers.MyEmailHandler',
            'include_html': False,
        },
    },
    'loggers': {
        ...
        'my_special_logger': {
            'handlers': ['console', 'my_special_mail_handler'],
            'level': 'DEBUG',
            'propagate': True,
        },
    }
}

MY_RECIPIENTS = (("Name of person", "email@example.com"),) 
```

...这些东西已合并到您的设置中。

然后是您的特殊日志记录类 MyEmailHandler：

```
from django.utils.log import AdminEmailHandler
from django.core.mail.message import EmailMultiAlternatives
from django.conf import settings

class MyEmailHandler(AdminEmailHandler):

    def emit(self, record):
        if not getattr(settings, "MY_RECIPIENTS", None):
            return
        subject = self.format_subject(record.getMessage())
        message = getattr(record, "email_body", record.getMessage())
        mail = EmailMultiAlternatives(u'%s%s' % (settings.EMAIL_SUBJECT_PREFIX, subject),
                    message, settings.SERVER_EMAIL, [a[1] for a in settings.MY_RECIPIENTS],)
        mail.send(fail_silently=False) 
```

现在您可以创建一个特殊的日志记录条目，该条目既可以通过电子邮件发送，也可以通过这种方式输出到终端：

```
import logging
logger = logging.getLogger("my_special_logger")
error = logger.makeRecord(
    logger.name, logging.ERROR, 0, 0,
    u"Subject: Some error occured",
    None, None, "", None,
)
error.email_body = msg
logger.handle(error) 
```

为了使事情变得简单，请使用实用功能：

```
import logging
def my_log(msg, body, level=logging.ERROR):
    logger = logging.getLogger("my_special_logger")
    error = logger.makeRecord(
        logger.name, level, 0, 0,
        u"Subject: Some error occured",
        None, None, "", None,
    )
    error.email_body = msg
    logger.handle(error) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T08:29:04.633

[Django Logging 文档](https://docs.djangoproject.com/en/dev/topics/logging/)状态：

> 当然，仅仅将日志调用放入您的代码是不够的。您还需要配置记录器、处理程序、过滤器和格式化程序，以确保以有用的方式输出记录输出。

您需要在您的[logging.config()](http://docs.python.org/library/logging.config.html#configuration-dictionary-schema)字典中调整您的设置。这使您可以准确地列出您想要的信息以及如何格式化。

从文档中删减一点：

```
'formatters': {
    'verbose': {
        'format': '%(levelname)s %(asctime)s %(module)s %(process)d %(thread)d %(message)s'
    }, 
```

让您了解如何影响输出，python 的 logging.config 文档将填写可用选项。

# java - Java 图形库

> ID：10022289
> 
> 赞同：2
> 
> 时间：2012-04-05T03:26:23.383
> 
> 标签：java, graph

我一直在这里寻找对用于图形可视化表示的 java 库的任何引用，但我只找到直方图、饼图等库。我正在寻找一个图形库，带有顶点、节点和所有这些的图形库。任何人都可以推荐任何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T03:29:16.417

我会选择[JUNG](http://jung.sourceforge.net/) java 图形库。它不仅有顶点和节点，还有最常见的算法，如最短路径算法或计算图属性的算法——如聚类系数、度数分布等指标。它的社区很活跃，并且对用户邮件列表上的问题反应良好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T04:24:05.150

[jgraph](http://www.jgraph.com/jgraph.html)很有希望。仅供参考，还有 JGraphT（但这只是用于处理图形而不是可视化。

# javascript - 如何验证多个不同的表单字段，我已经搜索并搜索了一周

> ID：10022290
> 
> 赞同：0
> 
> 时间：2012-04-05T03:26:26.953
> 
> 标签：javascript, forms

如何验证 dd/mm/yyyy、数字贷款金额、字母顺序、姓氏。我在使用这个论坛时遇到问题。谢谢你这么快回复！

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script type="text/javascript">
<!--//
function validate(form){
    var message = 'Please fill in the following fields:\n\n\t';
    for(var i=0; i<form.elements.length; i++){
        if(form.elements[i].value.length == 0){
            message+= form.elements[i].name.toUpperCase()+'\n\t'; 
        }
    } 
    message+= '\nOK   submit incomplete form';
    message+= '\nCANCEL  return to the form';
    message = confirm(message);
    if(!message){ return false };
    else{ return true };
}
//-->
</script>
</head>
<body>
    <form name="loanform" action="processform.htm" method="get" onsubmit="return validate(this)">
        First Name: <input type="text" name="firstname" maxlength="15"><br>
        Last Name: <input type="text" name="lastname" maxlength="15"><br>
        Birth Date: <input type="text" name="birthdate"  maxlength="8"><br>
        Loan Amount: <input type="text" name="loanamount"  maxlength="6" ><br>
        Years: <input type="text" name="years"  maxlength="2"><br>
        <br>
        <input type="reset" value="clear">
        <input type="submit" value="submit">
    </form>                                                                   
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:31:03.640

您可以使用这样的功能。它为每种类型的字段设置一个正则表达式，然后制作一个表格，说明哪个正则表达式用于哪个表单元素。它使用命名的表单元素来访问各个值。

```
function validate(form) {
    var nameRE = /^[A-Za-z \.]+$/;
    var dateRE = /^(\d{1,2})\/(\d{1,2})\/(\d{4})$/;
    var amountRE = /^\$?[\d\.,]+$/;
    var yearsRE = /^\d+$/;

    var formItems = [
        {name: "firstname", re: nameRE, tag: "First Name"},
        {name: "lastname", re: nameRE, tag: "Last Name"},
        {name: "birthdate", re: dateRE, tag: "Birth Date", isDate: true},
        {name: "loanamount", re: amountRE, tag: "Loan Amount", min: 50000, max: 750000},
        {name: "years", re: yearsRE,  tag: "Years", min: 5, max: 30}
    ];

    var item, val, num, month, day, year, valid, matches, incomplete = false;
    var msg = 'Please fill in the following fields:\n\n\t';
    for (var i = 0; i < formItems.length; i++) {
        item = formItems[i];
        // strip leading or trailing whitespace
        var val = form[item.name].value.replace(/^\s+|\s+$/g, "");
        form[item.name].value = val;
        // see if it matches the regex
        valid = item.re.test(val);
        if (valid && item.isDate) {
            matches = val.match(item.re);
            month = parseInt(matches[1], 10);
            day = parseInt(matches[2], 10);
            year = parseInt(matches[3], 10);
            if (month <= 0 || month > 12 || 
                day <= 0 || day >= 31 || 
                year < 1900 || year > 2020) {
                valid = false;
            }
        }
        if (!valid) {
            incomplete = true;
            msg += item.tag + '\n\t';
        } else {
            if (item.min && item.max) {
                // clear out non-numeric chars
                val = val.replace(/[,\$\s]/g, "");
                // convert to a number
                num = parseInt(val, 10);
                // compare to min and max
                if (num < item.min || num > item.max) {
                    incomplete = true;
                    msg += item.tag + " (must be between " + item.min + " and " + item.max + ")\n\t";
                }
            }
        }
    }
    if (incomplete) {
        msg += '\nOK   submit incomplete form';
        msg += '\nCANCEL  return to the form';
        return(confirm(msg));
    }
    return(true);
} 
```

​ 工作演示：http: [//jsfiddle.net/jfriend00/GChEP/](http://jsfiddle.net/jfriend00/GChEP/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T05:36:13.970

一种方法是使用类来了解您需要对给定的`input`. 此外，您可以使用该`title`属性对`input`.

您的 HTML 将如下所示：

```
<form name="loanform" action="processform.htm" method="get" onsubmit="return validate(this)">
    First Name (text only): <input class="validate-text" title="First Name" type="text" name="firstname" maxlength="15"><br>
    Last Name (text only): <input class="validate-text" title="Last Name" type="text" name="lastname" maxlength="15"><br>
    Birth Date (format dd/mm/yyyy): <input class="validate-date" title="Birth Date" type="text" name="birthdate"  maxlength="8"><br>
    Loan Amount (US dollars, numeric only): <input class="validate-number" title="Loan Amount" type="text" name="loanamount"  maxlength="6" ><br>
    Years (numeric only): <input class="validate-number" title="Years" type="text" name="years"  maxlength="2"><br>
    <br>
    <input type="reset" value="clear">
    <input type="submit" value="submit">
</form> 
```

还有你的 JavaScript 函数（正则表达式似乎是最好的方法）：

```
function validate(f) {
  var message=new Array(); //will contain the fields that are misfilled
  var reText=new RegExp("^[a-z \-'\.]+$", "i"); //a RegExp to match names: only letters, "-", "'" and "." allowed
  var reDate=new RegExp("^[0-9]{2}/[0-9]{2}/[0-9]{4}$"); //a RegExp to match a date in the format dd/mm/yyyy
  var reNumber=new RegExp("^[0-9]+$"); //a RegExp to match a number
  for(var e in f.elements) { //loop on every input of the form
    var test=null; //set or reset the RegExp to use for the current input
    var input=f.elements[e]; //assign the input to a var (easier to type, not needed)
    if(!input.className) //if this input doesn't have any class declared
      continue; //then we skip the rest of the loop to keep going with the next input
    var classes=input.className.split(" "); //maybe the input has several classes, so we split them in a "classes" array
    for(var c in classes) { //we loop on every class of the current input
      switch(classes[c]) { //and we test if the current class of the current input is one of the classes we're interested in
        case "validate-text": //if it is a text
          test=reText; //the variable "test" will contain the RegExp we want to use
          break;
        case "validate-date": //same for a date
          test=reDate;
          break;
        case "validate-number": //and same for a number
          test=reNumber;
          break;
        default: //if the class is not something we want, nothing to do
          break;
      } //end switch
    } //end classes loop
    //here test is either null (no "validate-something" class found for the current input), or it contains the RegExp telling us the kind of input we must validate.
    if(test!=null && !input.value.match(test)) { //if it is not null and if the input's value does not match the RegExp
      message.push(input.title); //we add the field to the "message" array
    }
  } //end input loop
  if(message.length>0) { //if the arary is not empty, we display a confirm box
    return confirm("Please correctly fill the following field(s), or click OK to send an incomplete form:\n"+message.join("\n"));
  }
  //otherwise, the form is correctly filled, we return true to submit the form
  return true;
} 
```

# ssis - 在执行 SQL 任务中存储存储过程的返回值时出错

> ID：10022301
> 
> 赞同：0
> 
> 时间：2012-04-05T03:27:56.947
> 
> 标签：ssis

执行 sql 任务的错误是

分配给变量“User::ReturnResult”的值的类型与当前变量类型不同。变量在执行期间可能不会改变类型。变量类型是严格的，除了 Object 类型的变量。

迄今为止，SSIS 软件包运行良好，但今天突然出现错误。

我在执行 sql 任务中编写的脚本是

```
Declare @ReturnValue int
EXEC @ReturnValue =   DATABASE.dbo.StoredProcedure
Select @ReturnValue 
```

结果集配置为单行并在结果集中

```
ResultName= 0
VariableName=User::ReturnResult 
```

存储过程的返回值是 0 或 -1（成功或失败），因为这是一个生产问题，我无权访问 SP 或表。那么这个错误是否会由于 Sybase 服务器的连接问题或存储过程的问题而发生

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T11:55:20.437

您的错误消息告诉您存储的过程不再只返回您期望的 0 或 -1（它会返回 null 吗？）

使用 sql server profiler 之类的工具来验证传递到存储过程中的参数并模拟相同的步骤以了解返回类型不同的原因。

# javascript - 如何从 Express.js 的动态辅助函数中访问 res.render() 中设置的变量？

> ID：10022304
> 
> 赞同：1
> 
> 时间：2012-04-05T03:28:02.593
> 
> 标签：javascript, express

我正在尝试在 Express.js 中创建一个 dynamicHelper。是否可以从 dynamicHelper 中访问 res.render 中设置的变量？特别是我希望能够访问变量“标题”。我能想到的唯一选择是将我想要的数据附加到 req 或 res 对象，并以这种方式从 dynamicHelper 中访问它。但是，我想知道它是否已经可以通过其他方式访问？

以下代码显示了 res.render() 的当前结构。由于变量“title”是建立在数据库调用的结果之上的，因此同样可以提出这样一个问题：如何从 dynamicHelper 中访问数据库查询的结果？

```
exports.viewContact = function(req, res) {
  var id = req.params.id;
  // Get document from DB.
  var Contact = mongoose.model('Contact');
  Contact.findOne({ _id: id}, function(err, results) {
    var breadcrumb = theme.breadcrumb({ path: url.parse(req.url).path, title: results.surname + ', ' + results.given_name });
    res.render('viewContact', {
      locals: {
        title: results.surname + ', ' + results.given_name,
        surname: results.surname,
        givenName: results.given_name,
        org: results.org,
        phones: results.phone,
        emails: results.email,
        addresses: results.address,
        breadcrumb: breadcrumb
      }
    });
  });
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:39:50.827

不，无法访问其他函数中的局部变量。

# wordpress - 从主页中删除特定类别的帖子

> ID：10022305
> 
> 赞同：0
> 
> 时间：2012-04-05T03:28:10.113
> 
> 标签：wordpress, wordpress-theming

如何从 wordpress 的主页中删除特定类别的帖子？我想按类别的名称或 ID 或...

我使用循环来获取我的帖子，如下所示：

```
if (!have_posts()) : while (have_posts()) : the_post(); 
```

多谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:29:16.603

您可以使用此功能，无需知道您的 cat-id 是什么，只需使用 category-slug：

```
function exclude_category($query) {
if ( $query->is_front_page ) {
    $category_ID1 = get_cat_id(category_slugA);
    $category_ID2 = get_cat_id(category_slugB);
    $query->set('cat',"-$category_ID1 -$category_ID2");
} return $query;
} add_filter('pre_get_posts', 'exclude_category'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T00:58:55.677

我推荐[Advanced Category Excluder](http://wordpress.org/extend/plugins/advanced-category-excluder/)。非常容易使用。几乎令人痛苦地易于使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T14:27:32.460

您可以尝试使用此插件：wordpress.org/extend/plugins/front-page-excluded-categories 您也可以尝试将此代码添加到您的“functions.php”中：

```
<?php function excludeCat($query) { if ( $query->is_home ) { $query->set('cat', '-3,-5,-23'); }  return $query; } add_filter('pre_get_posts', 'excludeCat'); ?> 
```

其中 -3、-5 和 -23 是您要删除的类别 ID。

# r - R httpd 问题 - 使用本地 IP 无法加载帮助页面

> ID：10022309
> 
> 赞同：0
> 
> 时间：2012-04-05T03:29:19.087
> 
> 标签：r, apache

这可能是一个普遍的话题，但我在使用 Rook 包处理一些代码时遇到了这个问题。

最近的 R 版本包括一个 http 服务器。您可能在使用 RGui 检查帮助主题时看到了这一点。它会打开一个带有 IP/端口等的新浏览器。

例如，如果我输入 ?paste，就会出现，

[http://127.0.0.1:31234/library/.../paste.html](http://127.0.0.1:31234/library/.../paste.html)

但是如果我使用我的 IP，比如 192.168.1.2 代替 127.0.0.1，页面无法加载，我收到错误

```
 While trying to retrieve the URL:http://192....
    The following error was encountered:
    We can not connect to the server you have requested 
```

我有其他具有 httpd 接口的应用程序，我可以使用 127.0.0.1 和 192.168.1.2 ... 等访问这些应用程序的 http 接口。所以，就系统/网络权限而言 - 我不认为那是这里的问题。

相反，有一些特定于 R httpd 进程的东西不允许使用域名等访问它？

以上是在公司网络中测试的。当我从我的家庭网络尝试相同的过程时，它运行良好。但是，由于我已经从公司 PC 访问了许多其他本地安装的应用程序的 http 接口，我认为可能需要检查 R 的 http 进程的特定内容？

工作站正在运行 - Windows XP

如果您对以上内容有任何想法，请告诉我，

问候，

*   拉吉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T14:54:10.940

解决它。诀窍是指定，

```
s <- Rhttpd$new()
s$start(listen="0.0.0.0",port="20000") 
```

启动 Rook 进程时。指定 0.0.0.0 使其监听所有接口，现在我可以使用我的外部 IP 访问它。非常感谢您的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T14:24:30.913

我的猜测是您的公司网络上可能有一个代理。您的浏览器可能已配置为使用该代理访问 Internet。大多数浏览器会排除他们知道的本地地址（`127.0.0.1`或`localhost`）使用代理，但可能不会排除任何其他 IP。

尝试在浏览器中禁用代理（甚至是“自动检测”，完全关闭代理），看看您是否能够连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T03:35:34.183

打开 TCP 端口时，可以选择本地 IP 地址。对于传入连接，通常将 INADDR_ANY (-1) 提供给 bind()，这意味着在每个可用接口上打开端口。

但是，很可能只在您机器上的一个接口（在本例中为 127.0.0.1）上打开一个端口，只需提供接口的 IP 地址即可。似乎R就是这样做的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-30T18:37:27.063

我有同样的问题。

如果您使用的是 RStudio，这可能是 RStudio 中的一个错误。查看此链接： https: [//support.rstudio.com/hc/communities/public/questions/202656007-Cryptic-error-on-starting-RStudio-daily-with-R-devel](https://support.rstudio.com/hc/communities/public/questions/202656007-Cryptic-error-on-starting-RStudio-daily-with-R-devel)

使用最新版本的 R 更新到最新版本的 RStudio 可以解决此问题。

# homebrew - Homebrew 一直告诉我更新，但它不允许我更新

> ID：10022317
> 
> 赞同：3
> 
> 时间：2012-04-05T03:31:26.257
> 
> 标签：homebrew

```
$ brew doctor 

Warning: Your Homebrew is outdated
You haven't updated for at least 24 hours, this is a long time in brewland! 
```

然后：

```
$ brew update 
$ brew --config

HOMEBREW_VERSION: 0.9
HEAD: (none)
HOMEBREW_PREFIX: /usr/local
HOMEBREW_CELLAR: /usr/local/Cellar
CPU: 8-core 64-bit sandybridge
OS X: 10.7.3
Kernel Architecture: x86_64
Xcode: 4.3.2
GCC-4.0: N/A
GCC-4.2: build 5666
LLVM: build 2335
Clang: 2.1 build 163
MacPorts or Fink? false
X11: /usr/X11
System Ruby: 1.8.7-249
/usr/bin/ruby => /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby
Which Perl:   /usr/bin/perl
Which Python: /usr/local/bin/python => /System/Library/Frameworks/Python.framework/Versions/2.6/Resources/Python.app/Contents/MacOS/Python
Which Ruby:   /Users/luis/.rvm/rubies/ruby-1.9.2-p318/bin/ruby 
```

这发生在我的另一台 Mac 上，当我 brew upgrade 时我`brew outdated`什么也没发生。恐怕即使面团是新安装的，这也会做同样的事情。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T16:12:59.593

`brew update`和之间有区别`brew upgrade`

`brew update`

更新可用（不再可用）可安装软件包的本地数据库，否则在 brew 术语中称为公式。

`brew upgrade`

当前更新系统上所有已安装的软件包。例如将 PHP 5.3.20 升级到 5.3.21。

在您尝试更新后我没有看到错误，如果您更新然后`brew doctor`再次运行并且它不再显示过时错误，那么您完全是最新的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T08:03:41.217

您是否尝试使用**brew update**而不是使用**brew upgrade**。它为我解决了这个问题。

# mysql - 给定方形网格坐标，如何计算来自该范围内的不同表中的数据？

> ID：10022318
> 
> 赞同：2
> 
> 时间：2012-04-05T03:31:39.853
> 
> 标签：mysql, sql

我的表格*网格*中有一堆坐标，其模式**id 为 x1,x2,y1,y2，**如下所示：

```
22,910000,920000,120000,130000
67,930000,940000,170000,180000
171,980000,990000,210000,220000 
```

*网格*表也有每个坐标元组的 ID。

在单独的*崩溃*表中，我有关于汽车碰撞的信息，其中最后两个值分别是“ **x_coordinate** ”和“ **y_coordinate** ”。

```
2007,2,9,4,1,1028977,202232
2004,1,1,1,4,1012600,214101
2003,1,9,1,1,958775,156149
1999,1,1,1,1,997349,175503 
```

1-如何计算每个方格的崩溃次数？（显示 2 列：网格 ID 和与之关联的崩溃数）

*2-如果朝另一个方向发展，我将如何检索在接下来的几年中发生超过 60 次崩溃的所有“方形网格”（x1、x2、y1、y2 的元组）：2005、2006 和 2007 年？（在 HTML 中，它看起来像一个包含 3 列的表格：2005 | 2006 | 2007 以及每年以下 - 坐标元组 x1,x2,y1,y2 满足 >=60 次车祸的标准。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T03:55:50.363

#1 很简单：（这原本是“我如何从网格表中计算出哪些汽车事故属于 x1、x2、y1、y2 坐标的方格？”）

```
SELECT  DISTINCT
            grid.ID
FROM        crashes
INNER JOIN  grid    
            ON  crashes.x_coordinate BETWEEN grid.x1 AND grid.x2
            And crashes.y_coordinate BETWEEN grid.y1 AND grid.y2 
```

#2 只是有点难：（这最初是“我将如何检索在接下来的几年中发生超过 60 次崩溃的所有“方形网格”（x1、x2、y1、y2 的元组）......？”）

```
SELECT  
            grid.ID, COUNT(*) AS CrashCount
FROM        crashes
INNER JOIN  grid    
            ON  crashes.x_coordinate BETWEEN grid.x1 AND grid.x2
            And crashes.y_coordinate BETWEEN grid.y1 AND grid.y2
WHERE       crashes.yearCol IN(2005, 2006, 2007)
GROUP BY    grid.ID
HAVING      COUNT(*) >= 60 
```

* * *

修改后的问题的解决方案...

对于 #1 “我如何计算每个方形网格的崩溃次数？”，只是原始 #2 的简化：

```
SELECT  
            grid.ID, COUNT(*) AS CrashCount
FROM        crashes
INNER JOIN  grid    
            ON  crashes.x_coordinate BETWEEN grid.x1 AND grid.x2
            And crashes.y_coordinate BETWEEN grid.y1 AND grid.y2
WHERE       crashes.yearCol IN(2005, 2006, 2007)
GROUP BY    grid.ID 
```

对于＃2“我将如何检索在以下年份（***每年***）发生超过 60 次崩溃的所有“方形网格”（x1、x2、y1、y2 的元组）：2005、2006 和 2007 年？

```
SELECT *
FROM
(
    SELECT  grid.ID,
            grid.x1, grid.x2, grid.y1, grid.y2,
            (   SELECT  COUNT(*)
                FROM    crashes
                WHERE   yearCol = 2005
                  And   crashes.x_coordinate BETWEEN grid.x1 AND grid.x2
                  And   crashes.y_coordinate BETWEEN grid.y1 AND grid.y2
            )   As year05,
            (   SELECT  COUNT(*)
                FROM    crashes
                WHERE   yearCol = 2006
                  And   crashes.x_coordinate BETWEEN grid.x1 AND grid.x2
                  And   crashes.y_coordinate BETWEEN grid.y1 AND grid.y2
            )   As year06,
            (   SELECT  COUNT(*)
                FROM    crashes
                WHERE   yearCol = 2007
                  And   crashes.x_coordinate BETWEEN grid.x1 AND grid.x2
                  And   crashes.y_coordinate BETWEEN grid.y1 AND grid.y2
            )   As year07,
    FROM    grid
) As gridSum
WHERE   year05  >= 60
  And   year06  >= 60
  And   year07  >= 60 
```

这在 TSQL 中更容易完成，我们有 WITH 子句可以使用......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T04:04:19.923

这将为您提供崩溃表中发生崩溃的 GridId。我假设您的意思是下面提到的 BETWEEN 快捷方式，而不是 >= 和 <=

```
SELECT
     crashes.*
    ,(
        SELECT grid.id
        FROM grid
        WHERE
                crashes.x_coordinate BETWEEN grid.x1 AND grid.x2
            AND crashes.y_coordinate BETWEEN grid.y1 AND grid.y2
     ) AS GridId
FROM crashes 
```

至于几年之间网格崩溃的第二个问题，试试这个

```
SELECT GridId, SUM(CrashesInGrid) AS TotalCrashesInGrid
FROM
(   
    SELECT T.GridId, T.year, COUNT(*) AS CrashesInGrid
    FROM
    (
        SELECT
             *
            ,(
                SELECT grid.id
                FROM grid
                WHERE
                        crashes.x_coordinate BETWEEN grid.x1 AND grid.x2
                    AND crashes.y_coordinate BETWEEN grid.y1 AND grid.y2
             ) AS GridId
        FROM crashes
    ) AS T
) AS T2
WHERE T2.year >= 2005 AND T2.year <= 2007
GROUP BY T2.Year
HAVING SUM(CrashesInGrid) >= 60 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T04:39:25.603

我无法比巴里更好地解决第一个问题:)

但是，这是否解决了第二个问题？如果没有，请告诉我。

```
SELECT id FROM (
  SELECT g.id, c.yearCol, COUNT(*) CrashCount FROM crashes c
  INNER JOIN grid g
  ON c.x_coordinate BETWEEN g.x1 and g.x2 AND c.y_coordinate BETWEEN g.y1 AND g.y2
  WHERE c.yearCol IN (2005, 2006, 2007)
  GROUP BY g.id, c.yearCol
  HAVING COUNT(*) >= 60
) final
GROUP BY id
HAVING COUNT(yearCol) = 3 
```

# grammar - 此语言的上下文相关语法

> ID：10022322
> 
> 赞同：0
> 
> 时间：2012-04-05T03:32:00.727
> 
> 标签：grammar, context-sensitive-grammar

语言 X = { 0^m 使得 m = 2n+1 其中 n >= 0}

有人可以帮我找到 X 的上下文相关语法吗？我已经尝试了很多年，但我仍然没有接近。

我现在拥有的：

S -> B0C|00

B0 -> DD0|00

BD -> DD

0C -> 0EE|00

欧共体-> EE

D -> B

E -> C

但这不起作用。我不知道如何将零的数量加倍。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T18:56:38.377

为什么不只使用一个简单的语法（在这种情况下甚至是上下文无关的，尽管我也可以制作一个不是），例如：

```
S -> 0 | 00S 
```

# bash - 在 bash 中检查 isatty

> ID：10022323
> 
> 赞同：20
> 
> 时间：2012-04-05T03:32:01.990
> 
> 标签：bash, shell

我希望我的 shell 检测是否是人类行为，然后显示提示。

所以，假设文件名是 test.bash

```
#!/bin/bash
if [ "x" != "${PS1:-x}" ] ;then
 read -p "remove test.log Yes/No" x
 [ "$x" = "n" ] && exit 1
fi
rm -f test.log 
```

但是，我发现如果我没有设置 PS1，它就无法工作。有没有更好的方法？

我的测试方法：

```
./test.bash                  # human interactive
./test.bash > /tmp/test.log  # stdout in batch mode
ls | ./test.bash             # stdin in batch mode 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-04-05T03:45:05.253

详细说明，我会尝试

```
 if [ -t 0 ] ; then
    # this shell has a std-input, so we're not in batch mode 
   .....
 else
    # we're in batch mode

    ....
 fi 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-05T03:34:04.093

来自`help test`：

> ```
>  -t FD          True if FD is opened on a terminal. 
> ```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-05T03:40:44.880

您可以使用该`/usr/bin/tty`程序：

```
if tty -s
then
    # ...
fi 
```

我承认我不确定它的可移植性，但它至少是 GNU coreutils 的一部分。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-07-15T16:20:59.637

请注意，在 bash 脚本中（请参阅 中的`test expr`条目`man bash`），没有必要使用 beefy`&&`和`||`shell 运算符来组合命令的两个单独运行`[`，因为该`[`命令具有自己的内置*and* `-a` and *or* `-o`运算符，可以让您组合几个更简单的测试成一个单一的结果。

因此，您可以通过以下方式实现您所要求的测试——如果输入*或*输出已被重定向离开 TTY，您将进入批处理模式——使用单个*调用*`[`：

```
if [ -t 0 -a -t 1 ]
then
    echo Interactive mode
else
    echo Batch mode
fi 
```

# java - 从子类的提供者构造超类提供者

> ID：10022324
> 
> 赞同：1
> 
> 时间：2012-04-05T03:32:24.243
> 
> 标签：java, guice

我有一个超类，它有自己的嵌套类，它在构造函数中传递（/作为提供者注入）。

同样，我有一个带有自己的嵌套类的子类，该子类被注入（作为提供者）在构造函数中。Subclass.NestedClass 扩展了 Superclass.NestedClass。

```
public class SuperClass {
  @Inject SuperClass(Provider<SuperClass.Parameters> superParam) {
  }

  public class Parameters {
    int a;  
  }
}

public class Sub extends SuperClass {
  @Inject Sub(Provider<Sub.Parameters> subParam) {
     // Need to call super here with the appropriate superclass's provider
  }

  public class Parameters extends SuperClass.Parameters {
    int b;
  }
} 
```

有没有办法可以将 Sub.Parameters 的提供者转换为 SuperClass.Parameters 的提供者，以便我可以在 Sub 的构造函数中调用 super（使用该提供者）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:59:10.897

Java 泛型在这里帮助了我。

解决方案：

```
public class SuperClass {
  // Constructor
  @Inject SuperClass(Provider<? extends SuperClass.Parameters> superParam) {
  }

  public class Parameters {
    int a;  
  }
}

public class Sub extends SuperClass {
  @Inject Sub(Provider<Sub.Parameters> subParam) {
     super(subParam);
  }

  public class Parameters extends SuperClass.Parameters {
    int b;
  }
} 
```

观察超类构造函数的参数“?extends”的区别。

# google-app-engine - GAE 缓存对象化查询

> ID：10022326
> 
> 赞同：3
> 
> 时间：2012-04-05T03:32:40.423
> 
> 标签：google-app-engine, gwt, objectify

我有一个简单的问题

在 objectify 文档中它说“只有 get()、put() 和 delete() 与缓存交互。query() 不被缓存” [http://code.google.com/p/objectify-appengine/wiki /IntroductionToObjectify#Global_Cache](http://code.google.com/p/objectify-appengine/wiki/IntroductionToObjectify#Global_Cache)。

我想知道 - 如果你有一个根实体（我没有使用@Parent，因为它似乎有所有可伸缩性问题）所有其他实体都有一个密钥，你做一个查询，比如

```
ofy.query(ChildEntity.class).filter("rootEntity", rootEntity).list() 
```

这是完全绕过缓存吗？

如果是这种情况，是否有一种有效的缓存方式来对条件进行查询 - 或者就此而言，您是否可以使用父项缓存查询，您必须在其中进行实际的祖先查询，如下所示

```
Key<Parent> rootKey = ObjectifyService.factory().getKey(root)
ofy.query(ChildEntity.class).ancestor(rootKey) 
```

谢谢

* * *

至于下面的评论之一，我添加了一个编辑

示例 dao（忽略 validate 方法 - 它只是进行一些空值和数量检查）：

这是从请求工厂 ServiceLocator 正在使用的 DAO 调用的委托中查找所有方法的示例

```
public List<EquipmentCheckin> findAll(Subject subject, Objectify ofy, Event event) {
  final Business business = (Business) subject.getSession().getAttribute(BUSINESS_ATTRIBUTE);
  final List<EquipmentCheckin> checkins = ofy.query(EquipmentCheckin.class).filter(BUSINESS_ATTRIBUTE, business)
    .filter(EVENT_CONDITION, event).list();
  return validate(ofy, checkins);
} 
```

现在，当执行此操作时，我发现实际上在我的 AbstractDAO 中调用了以下方法。

```
/**
* 
* @param id
* @return
*/
public T find(Long id) {
  System.out.println("finding " + clazz.getSimpleName() + " id = " + id);
  return ObjectifyService.begin().find(clazz, id);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T03:59:33.400

是的，所有查询都会绕过 Objectify 的集成内存缓存并直接从数据存储中获取结果。数据存储提供了（越来越复杂的）查询引擎，它了解如何返回结果；从客户端确定查询结果的缓存失效几乎是不可能的。

另一方面，Objectify4 确实提供了混合查询缓存，查询会自动转换为仅键查询，然后是批量获取。仅键查询仍然需要数据存储，但任何实体实例都从内存缓存中提取（并在未命中时填充）。它可能会为您省钱。

# android - 静态实例，构造函数和 GC，冲洗，重复

> ID：10022327
> 
> 赞同：0
> 
> 时间：2012-04-05T03:32:47.450
> 
> 标签：android, static

对一个类的静态实例进行如此多的 GC 处理是否正常且“正常”？我构建了一个图形子集，一旦在我的应用程序中执行图形选项，我就会看到 GC 和我的静态实例被擦除。

我没有问题，只是在寻找一些学习反馈。这个跟踪测试是在我的 Galaxy Nexus 上完成的。

![在此处输入图像描述](../Images/d04776fbfc466c54eb42cc67efd79a17.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:38:20.947

这是正常的，因为您的应用程序（可能是内容提供商？）仅在必要时由操作系统保持运行。

让安卓做它的事。

# activemq - ActiveMQPrefetchPolicy 是如何工作的？queueBrowserPrefetch 是什么意思？

> ID：10022328
> 
> 赞同：3
> 
> 时间：2012-04-05T03:32:49.320
> 
> 标签：activemq

我正在尝试使用 ActiveMQPrefetchPolicy，但不太了解如何使用它。

我正在使用队列，我可以为 PrefetchPolicy 定义 3 个参数：

queuePrefetch、queueBrowserPrefetch、inputStreamPrefetch

其实我不明白 queueBrowserPrefetch 和 inputStreamPrefetch 的含义，所以我不知道如何使用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:22:37.953

I assume that you have seen the ActiveMQ page on [prefetch limits](http://activemq.apache.org/what-is-the-prefetch-limit-for.html).

*   queueBrowserPrefetch sets the maximum number of messages sent to a
    [ActiveMQQueueBrowser](http://activemq.apache.org/maven/5.4.0/activemq-core/apidocs/org/apache/activemq/ActiveMQQueueBrowser.html) until acks are received.
*   inputStreamPrefetch sets the maximum number of messages sent
    through a [jms-stream](http://activemq.apache.org/jms-streams.html) until acks are received

Both queue-browser and jms-stream are specialized consumers. You can read more about each one of them but if you are not using them it won't matter what you assign to their prefetch limits.

# wpf - 将按钮 IsEnabled 绑定到属性

> ID：10022332
> 
> 赞同：3
> 
> 时间：2012-04-05T03:33:39.627
> 
> 标签：wpf, binding, inotifypropertychanged, isenabled

我有一个已经实现的类`INotifyPropertyChanged`。这个类`UserInfo`有一个布尔变量 isuserLoggedIn。现在在我的主窗体中，我有希望绑定到其 isEnabled 的按钮`UserInfo.isuserLoggedIn`。

怎么做？

```
 public  class UserInfo : INotifyPropertyChanged
    {
        private static readonly UserInfo _instance = new UserInfo();
        private string username; 

        private  bool isLoggedIn;

        public string UserName
        {
            get { return username; }
            set
            {
                username = value;
                NotifyPropertyChanged("UserName");
            }
        }

        public  bool UserLoggedIn
        {
            get { return isLoggedIn; }
            set
            {
                isLoggedIn = value;
                NotifyPropertyChanged("UserLoggedIn");
            }
        }

        public  event PropertyChangedEventHandler PropertyChanged;

        public void NotifyPropertyChanged(string propertyName)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
            }
        }               

    public static UserInfo GetUserInfo()
    {
        return _instance;
    }

} 
```

我主要有：

```
public class MainWindow
{
    UserInfo currentUser = UserInfo.GetUserInfo();
} 
```

XAML 是：

```
<Button IsEnabled="{Binding ElementName=currentUser, Path=UserLoggedIn}"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T03:48:22.913

您需要将视图的 DataContext 设置为 UserInfo 类的实例。然后将按钮的 IsEnabled 属性绑定到 UserInfo 视图模型上的 UserIsLoggedIn 布尔属性。这是一个将元素的属性绑定到相应视图模型上的属性的示例：[将 gridview 选定项值传递给不同 Usercontrol 的不同 ViewModel](https://stackoverflow.com/questions/9468881/passing-a-gridview-selected-item-value-to-a-different-viewmodel-of-different-use/9470374#9470374)

看到您的编辑后，您需要再次将视图的 DataContext 设置为 currentUser 对象，然后删除按钮的 IsEnabled 绑定表达式的 ElementName 部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-11T14:02:46.897

您可以绑定`IsEnabled`到`Length`用户名文本框：

```
<TextBox Name="usernameTxt" Width="100" Height="30"/>
<Button Content="SomeButton " Width="100" Height="30" 
  IsEnabled="{Binding ElementName=usernameTxt, Path=Text.Length, Mode=OneWay}"></Button> 
```

# ruby - 如何为 -v ， -o 之类的 ruby 脚本提供标志并相应地放置代码？

> ID：10022335
> 
> 赞同：-2
> 
> 时间：2012-04-05T03:33:56.920
> 
> 标签：ruby, options, flags

我创建了一个 ruby​​ 脚本，我想在控制台上运行一些标志，比如 -v 标志在控制台上打印输出，-o 将输出存储在新文件中，文件名是我从控制台获取的`gets()`

我的代码具有以下结构：

```
puts "Enter filename to analyze:\n\n"
filename = gets().chomp
puts "Provide filename to store result in new text file:\n\n"
output = gets().chomp
filesize = File.size(filename)
puts "File size in Bytes:\n#{filesize.to_i}\n"
pagecontent = filesize - 20
puts "\n\nData:\n#{pagecontent}\n\n"
File.open(filename,'r') do |file|
         #whole process with few do..end in between that I want to do in 2 different #ways.
    #If I provide -v flag on console result of this code should be displayed on console
    #and with -o flag it should be stored in file with filename provided on console #stored in output variable declared above
end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T05:00:24.323

使用[标准库 OptionParser](http://ruby-doc.org/stdlib-1.9.3/libdoc/optparse/rdoc/OptionParser.html)

# mysql - MYSQL 在 'WHERE' 子句中使用 'LIKE' 在子查询中搜索

> ID：10022338
> 
> 赞同：20
> 
> 时间：2012-04-05T03:34:09.870
> 
> 标签：mysql, sql, subquery, where-clause, sql-like

您将如何使用“LIKE”在子查询中进行搜索？

例如，我尝试过这样做，但不起作用：

```
SELECT *
FROM mytable
WHERE name
    LIKE '%
        (SELECT name FROM myothertable)
        %' 
```

* * *

到目前为止我有这个：

```
SELECT * FROM t1
WHERE t1.name IN (SELECT t2.name FROM t2)
AND (t1.title IN (SELECT t2.title FROM t2)
    OR t1.surname IN (SELECT t2.surname FROM t2)) 
```

它工作正常，因为它返回完全匹配，但它似乎没有返回我的其他类似记录，所以我还想检查一下：

t1.title LIKE '%t2.title%' AND t1.surname LIKE ' %t2.surname%'

我该怎么做？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-05T03:46:13.783

使用连接：

```
SELECT a.*
  FROM mytable a
  JOIN myothertable b ON a.name LIKE CONCAT('%', b.name, '%') 
```

`myothertable`...但是如果给定`mytable`记录有多个匹配项，则可能存在重复项。

使用存在：

```
SELECT a.*
  FROM mytable a
 WHERE EXISTS (SELECT NULL 
                 FROM myothertable b 
                WHERE a.name LIKE CONCAT('%', b.name, '%')) 
```

使用[全文搜索`MATCH`](http://dev.mysql.com/doc/refman/5.5/en/fulltext-query-expansion.html)（需要`myothertable`MyISAM）

```
SELECT a.*
  FROM mytable a
  JOIN myothertable b ON MATCH(a.name) AGAINST (b.name) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-05T03:38:40.117

例如：

```
SELECT a_column
FROM   mytable t
WHERE  EXISTS (
           SELECT 1
           FROM   myothertable ot
           WHERE  t.`name` LIKE '%' || ot.`name` || '%'); 
```

就术语而言：这称为相关子查询。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-05T07:55:47.793

只是另一种方式：

```
select a.field, b.code
from table1 a 
inner join (select code from table2 where ....) b on a.field like CONCAT('%', b.code, '%') 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-08T12:38:31.810

这个字符串对我来说很好。

```
"SELECT * FROM table1 WHERE field like CONCAT('%', (SELECT id FROM table2), '%')"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-15T11:28:37.233

它对我有用

```
SELECT *
FROM mytable
WHERE name
LIKE CONCAT('%',(SELECT name FROM myothertable),'%') 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-16T01:51:15.523

```
SELECT * 
FROM t1
WHERE t1.name IN (SELECT t2.name FROM t2)
AND (t1.title IN (SELECT t2.title FROM t2)
    OR t1.surname IN (SELECT t2.surname FROM t2)) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-05T04:45:17.673

最好的方法是创建名为 NameMatch() 的函数

最终查询：

```
SELECT * FROM mytable  WHERE dbo.NameMatch(name) = 1 
```

该功能看起来像：

```
create function dbo.NameMatch 
(@_name varchar(100))
returns bit 
as  begin

    declare @res bit 
    if exists (select 1 from myothertable where @_name like '%' + name + '%' )
     set @res = 1
    else set @res  = 0
    return @res

end 
```

# android - 如何在android中找到可以处理来电的应用程序？

> ID：10022340
> 
> 赞同：0
> 
> 时间：2012-04-05T03:34:39.993
> 
> 标签：android, android-intent, permissions

在 android 中，如果我们将解析意图与 CATEGORY_HOME 或 CATEGORY_LAUNCHER 一起使用，我将取回所有已安装的家庭应用程序或可分别启动的应用程序的应用程序。同样，有什么**方法可以找到可以处理来电的应用程序**，例如普通的 android 手机应用程序、Viber、Skype 等。

问候科兹洛夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:06:17.800

将[ACTION_ANSWER](http://developer.android.com/reference/android/content/Intent.html#ACTION_ANSWER)操作添加到您的 Intent 怎么样？

```
Intent intent = new Intent(Intent.ACTION_ANSWER);
PackageManager pm = getPackageManager();
List<ResolveInfo> results = pm.queryIntentActivities(intent, PackageManager.MATCH_DEFAULT_ONLY); 
```

# ios - 保存 UITextFields、UILabels 和 UITextView 等字符串

> ID：10022344
> 
> 赞同：0
> 
> 时间：2012-04-05T03:35:21.110
> 
> 标签：ios, xcode, nsstring

我在通过导航控制器运行时保存外部变量时遇到问题，这是一个应用程序，我在这里计算游戏点数，我的代码用于计算点数：

这是用于计算点数的 IBAction：

```
- (IBAction)RedTeloBallsTotal:(id)sender {

NSString *firstString = RedTeloBallsOne.text;
NSString *secondString = RedTeloBallsTwo.text;
NSString *thirdString = RedTeloBallsThree.text;
NSString *fourthString = RedTeloBallsFour.text;

NSString *LEGAL = @"0123456789";
NSCharacterSet *characterSet = [[NSCharacterSet characterSetWithCharactersInString:LEGAL] invertedSet];
NSString *filteredOne = [[firstString componentsSeparatedByCharactersInSet:characterSet] 
                         componentsJoinedByString:@""];
NSString *filteredTwo = [[secondString componentsSeparatedByCharactersInSet:characterSet] 
                         componentsJoinedByString:@""];
NSString *filteredThree = [[thirdString componentsSeparatedByCharactersInSet:characterSet] 
                           componentsJoinedByString:@""];
NSString *filteredFour = [[fourthString componentsSeparatedByCharactersInSet:characterSet] 
                          componentsJoinedByString:@""];

firstString = filteredOne;
secondString = filteredTwo;
thirdString = filteredThree;
fourthString = filteredFour;

//Here we are creating three doubles
double num1;
double num2;
double num3;
double num4;
double output;
//Here we are assigning the values 
num1 = [firstString doubleValue];
num2 = [secondString doubleValue];
num3 = [thirdString doubleValue];
num4 = [fourthString doubleValue];

output = num2 + (num1 * 2) + num4 + (num3 * 25);

//Now we are going to display the output in the label.
RedTeloBallsTotal.text = [NSString stringWithFormat:@"%.0f",output];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:58:34.653

要保存计算的值，您应该在对象中为其创建一个声明的属性。

例如，在此对象的标题中，将其与其他属性一起添加：

```
@property (nonatomic, assign) double redTeloBallsTotalOutput; 
```

然后，在实现文件（.m 文件）的顶部，您应该会看到其他 @synthesize 行，添加以下行：

```
@synthesize redTeloBallsTotalOutput; 
```

为了在上面的函数中设置值，请使用：

```
self.redTeloBallsTotalOutput = output; 
```

最后，要在此对象的其他位置使用它，请使用：

```
self.redTeloBallsTotalOutput 
```

# java - Android 获取资源/缓冲区读取器问题

> ID：10022345
> 
> 赞同：0
> 
> 时间：2012-04-05T03:35:32.550
> 
> 标签：java, android, resources, inputstream, bufferedreader

**我的代码似乎可以运行，但它没有显示结果文本视图上的任何结果我猜测是因为我设置代码的方式。代码在下面有人请帮助我。谢谢**

```
 public void onCreate(Bundle savedInstanceState) {
                super.onCreate(savedInstanceState);
                setContentView(R.layout.main3);

                Button button = (Button) findViewById(R.id.but);

                input = (EditText) findViewById(R.id.editTextj);

                display = (TextView) findViewById(R.id.textView8);

                button.setOnClickListener(new View.OnClickListener() {
                    public void onClick(View v) {
                        CCActivity3 fs = new CCActivity3();
                        fs.fileReader();

                    }// button
                });// button end
            }

            public void fileReader() {

                try {
                InputStream is=this.getResources().openRawResource(R.raw.file);

                BufferedReader bc = new BufferedReader(new InputStreamReader(is));

                    String cLine;
                    String inputText = "";

                    List<String> test2 = new ArrayList<String>();   

                    // read file line by line

                    while ((cLine = bc.readLine()) != null) {

                         inputText = inputText + cLine + "\n";

                    }

                    s = input.getText().toString();

                    test = CCActivity3.getPermutation(s);//Permutation method
                          test2.retainAll(test);//intersection
                    String fg = "";

                    for (String s2 : test2) {
                        fg += s2 + "\n";
                    }

                    display.setText(fg);

                     bc.close();

                } catch (Exception e) {// catch any errors if necessary

                    display.setText(e.getMessage());
                }

        } 
```

如果您检查资源行，我很确定没有得到正确的结果，而且我相信它们只是分散了代码的格式。提示 res/raw 路径上的 file.txt 有超过 100,000 个字符串/单词，这可能是原因。再次感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:54:30.280

关于您的代码：

> ```
>  button.setOnClickListener(new View.OnClickListener() {
>                 public void onClick(View v) {
>                     CCActivity3 fs = new CCActivity3();
>                     fs.fileReader();
> 
>                 }// button
>             });// button end 
> ```

CCActivity3 是从 Activity 派生的吗？如果是这样，那么您不应该以这种方式构建它。你不能实例化你自己的 Activity 类。只有 Android 框架可以做到这一点。
这里似乎发生的是，在 fileReader() 内部，您正在调用其上下文尚未由 onCreate() 正确初始化的 Activity 的 getResources()。

无论如何，您可以做的一件事是直接调用 fileReader() 方法而不实例化 CCActivity3，如下所示：

```
 button.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            fileReader();
        }// button
    });// button end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:04:30.813

test = CCActivity3.getPermutation(s);//置换方法 test2.retainAll(test);//交集

上面的代码能得到正确的回报吗？

# c# - 将 SQL Server 数据库转换为 SQL Server CE？

> ID：10022348
> 
> 赞同：0
> 
> 时间：2012-04-05T03:35:41.843
> 
> 标签：c#, sql-server, sql-server-2008, compact-framework, sql-server-ce

我有一个可以读取的 SQL Server 数据库，有没有一种快速的方法可以通过 C# 将其转换为 SQL Server CE 数据库，或者我必须读取所有数据然后将其输出到 SQL Server CE 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T07:45:16.067

您可以使用我的 SQL Server Compact 脚本 API，它允许您将服务器数据库导出到脚本文件，并从您的 C# 代码针对 SQL Server Compact 数据库运行生成的文件。[http://exportsqlce.codeplex.com/wikipage?title=Scripting%20API%20samples&referringTitle=Documentation](http://exportsqlce.codeplex.com/wikipage?title=Scripting%20API%20samples&referringTitle=Documentation)

# javascript - html按钮和选择框不对齐

> ID：10022352
> 
> 赞同：1
> 
> 时间：2012-04-05T03:37:26.443
> 
> 标签：javascript, html, css

我正在尝试创建一个富文本编辑器。我创建了一些带有 IMG 值的按钮。我在按钮之间也有一些选择框。问题是选择框没有与其余按钮对齐。

![在此处输入图像描述](../Images/1165f61b7732e648c223d73245703749.png)

我试图修改边距和填充。试图为按钮和选择框创建单独的 DIV 元素。似乎没有任何效果。如果我不在按钮内使用 IMG，那么一切都很好。下面是我的代码

```
button.formatbutton, button.formatbutton:link, button.formatbutton:visited
{
    display:inline;
    height: 25px; 
    width: 25px; 
    margin:1px 0px;
    padding:0px;
    border:1px solid #ADB96E;
    background-color: #ADB96E;
    cursor:pointer;
}

button.formatbutton:hover, button.formatbutton:active
{
    display:inline;
    height: 25px; 
    width: 25px; 
    margin:1px 0px;
    padding:0px;
    border:1px solid #ADB96E;
    background-color: #7A991A;
}

select.formatSelect
{
    display:inline;
    height: 25px; 
    width: 100px; 
    margin:0px 0px 0px 0px;
    border:1px solid #ADB96E;
    background-color: #ADB96E;
    cursor:pointer;
}

div.divToolbar
{
    width: 850px;
    height:27px; 
    text-align: center; 
    margin: 0px; 
    padding: 0px; 
    border: 1px solid #ADB96E;
}

div.divIframe
{
    width: 850px;
    height:350px; 
    text-align: center; 
    margin: 0px; 
    padding: 0px; 
    border: 0px;
    border-left: 1px solid #ADB96E;
    border-right: 1px solid #ADB96E;
    border-bottom: 1px solid #ADB96E;
}

div.divToolbar img
{
    height: 25px; 
    width: 25px; 
    display:inline;
    padding:0px;
    margin:0px;
    border:0px;     
}

iframe
{
    display:block;
    width: 850px; 
    height: 250px; 
    margin: 0px; 
    padding: 0px; 
    border:0px;

}

    <div align="center" class="divToolbar">

<button id="1" type="button" class="formatbutton" style="font-weight: bold;" value="B" 
onClick="clickButton(this, '<c:url value="/resources/"/>');fontEdit('bold')" onBlur="blurButton(this)" onFocus="buttonFocus(this)" >
<img src="<c:url value="/resources/bold.png"/>" height="28px" width="28px" /></button><button 
id="2" type="button" class="formatbutton" style="font-style: italic;" value="I" onClick="clickButton(this, '<c:url value="/resources/"/>');fontEdit('italic')" onBlur="blurButton(this)" onFocus="buttonFocus(this)">
<img src="<c:url value="/resources/italics.png"/>" height="28px" width="28px" /></button><button 
id="3" type="button" class="formatbutton" style="text-decoration: underline;" value="U" onClick="clickButton(this, '<c:url value="/resources/"/>');fontEdit('underline')" onBlur="blurButton(this)" onFocus="buttonFocus(this)">
<img src="<c:url value="/resources/underline.png"/>" height="28px" width="28px" /></button> 

<button id="4" type="button" class="formatbutton" value="L" onClick="clickButton(this, '<c:url value="/resources/"/>');fontEdit('justifyleft')"  onBlur="blurButton(this)" onFocus="buttonFocus(this)" title="align left">
<img src="<c:url value="/resources/text_align_left.png"/>" height="28px" width="28px" /></button><button
id="5" type="button" class="formatbutton" value="C" onClick="clickButton(this, '<c:url value="/resources/"/>');fontEdit('justifycenter')"  onBlur="blurButton(this)" onFocus="buttonFocus(this)" title="center">
<img src="<c:url value="/resources/text_align_center.png"/>" height="28px" width="28px" /></button><button 
id="6" type="button" class="formatbutton" value="R" onClick="clickButton(this, '<c:url value="/resources/"/>');fontEdit('justifyright')"  onBlur="blurButton(this)" onFocus="buttonFocus(this)" title="align right">
<img src="<c:url value="/resources/text_align_right.png"/>" height="28px" width="28px" /></button>

<select class="formatSelect"
    onChange="fontEdit('fontname',this[this.selectedIndex].value)">
    <option value="Arial">Arial</option>
    <option value="Comic Sans MS">Comic Sans MS</option>
    <option value="Courier New">Courier New</option>
    <option value="Monotype Corsiva">Monotype</option>
    <option value="Tahoma">Tahoma</option>
    <option value="Times">Times</option>
</select> 
<select class="formatSelect"
    onChange="fontEdit('fontsize',this[this.selectedIndex].value)">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
</select> 
<select class="formatSelect"
    onChange="fontEdit('ForeColor',this[this.selectedIndex].value)">
    <option value="black">-</option>
    <option style="color: red;" value="red">red</option>
    <option style="color: blue;" value="blue">blue</option>
    <option style="color: green;" value="green">green</option>
    <option style="color: pink;" value="pink">pink</option>
</select>

<button id="7" type="button" class="formatbutton" value="1" onClick="clickButton(this, '<c:url value="/resources/"/>');fontEdit('insertorderedlist')"  onBlur="blurButton(this)" onFocus="buttonFocus(this)" title="Numbered List">
<img src="<c:url value="/resources/list_numbered.png"/>" height="28px" width="28px" /></button><button 
id="8" type="button" class="formatbutton" value="●" onClick="clickButton(this, '<c:url value="/resources/"/>');fontEdit('insertunorderedlist')"  onBlur="blurButton(this)" onFocus="buttonFocus(this)" title="Bullets List">
<img src="<c:url value="/resources/list_bulleted.png"/>" height="28px" width="28px" /></button><button 
id="9" type="button" class="formatbutton" value="←" onClick="clickButton(this, '<c:url value="/resources/"/>');fontEdit('outdent')"  onBlur="blurButton(this)" onFocus="buttonFocus(this)" title="Outdent">
<img src="<c:url value="/resources/outdent.png"/>" height="28px" width="28px" /></button><button 
id="10" type="button" class="formatbutton" value="→" onClick="clickButton(this, '<c:url value="/resources/"/>');fontEdit('indent')"  onBlur="blurButton(this)" onFocus="buttonFocus(this)" title="Indent">
<img src="<c:url value="/resources/indent.png"/>" height="28px" width="28px" /></button>
</div>
<div align="center" class="divIframe">
<iframe id="textEditor">
</iframe>
<button type="button" onClick="ShowHtml()">ShowFrameContent</button>
</div> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T03:51:03.840

写`vertical-align:top`在你的**内联**元素中。像这样写：

```
select, button{
 vertical-align:top;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T04:09:45.913

如果您希望事物正确排列，并且它们只是图像，请不要使用内联。内联元素会受到行高等因素的影响......当试图将它全部排列成像素完美时，它通常不会很好。

如果还没有，请制作您的图像块。制作您的按钮并选择块，并将所有内容向左/固定浮动，使其看起来像内联。如果您只使用较新的浏览器，另一种方法是让您的图像块和按钮并选择内联块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T03:50:47.410

我已经测试过这个...

```
select.formatSelect
{
display:inline;
height: 25px; 
width: 100px; 
margin:0px 0px 0px 0px;
position:relative;
top:-7px;
border:1px solid #ADB96E;
background-color: #ADB96E;
cursor:pointer;
} 
```

# html - 如何在 CSS 中设置 ul li 样式？

> ID：10022353
> 
> 赞同：1
> 
> 时间：2012-04-05T03:37:57.300
> 
> 标签：html, css

> **可能重复：**
> [我想将列表项显示为 2 列或更多列（动态对齐）](https://stackoverflow.com/questions/8092830/i-want-to-show-list-items-as-2-or-more-columns-dynamic-alignment)

对不起我的英语不好！

我对 ul li 有疑问：

我的 HTML：

```
<ul>

    <li>1</li>
    <li>2</li>
    <li>3</li>
    <li>4</li>
    <li>5</li>
    <li>6</li>
    <li>7</li>
    <li>8</li>
    <li>9</li>
    <li>10</li>
</ul> 
```

我的CSS：

```
ul {
width:60px;

}

ul li{
float:left;
width:20px;
list-style:none;
} 
```

我的列表分为 3 列，例如：

```
1 2 3
4 5 6
7 8 9
10 
```

所以，我的问题是：我怎样才能对我的列表进行排序：

```
1 4 7 10
2 5 8
3 6 9 
```

感谢您的帮助：D

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T03:46:18.850

您可以为此使用**css3** `column-count`属性检查更多信息

[我想将列表项显示为 2 列或更多列（动态对齐）](https://stackoverflow.com/questions/8092830/i-want-to-show-list-items-as-2-or-more-columns-dynamic-alignment/8092856#8092856)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T04:05:13.940

请参阅小提琴的代码和演示

小提琴：http: [//jsfiddle.net/pGHCd/](http://jsfiddle.net/pGHCd/)

演示：http: [//jsfiddle.net/pGHCd/embedded/result/](http://jsfiddle.net/pGHCd/embedded/result/)

ss:

![在此处输入图像描述](../Images/2669beca6ff33eab5df01c94a6dfbb2b.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T04:10:41.240

嗨，您可以像这样在 css3 属性上执行此操作

**CSS**

```
ul{
    -moz-column-count: 3;
    -moz-column-gap: 33%;
    -webkit-column-count: 3;
    -webkit-column-gap: 33%;
    column-count: 4;
    column-gap: 33%;
    background:green;
    width:100px;

}
li{
    height:20px;
    list-style:none;
} 
```

HTML

```
<ul>

    <li>1</li>
    <li>2</li>
    <li>3</li>
    <li>4</li>
    <li>5</li>
    <li>6</li>
    <li>7</li>
    <li>8</li>
    <li>9</li>
    <li>10</li>
</ul>
​ 
```

现场演示[http://jsfiddle.net/rohitazad/pMbtk/376/](http://jsfiddle.net/rohitazad/pMbtk/376/)

但不是工作IE

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T03:53:33.460

CSS3 来救援！

```
ul {
    width:60px; height: 60px;
}

ul li{
    float:left;
    width:20px;
    list-style:none;
}
ul, ul li {
    -moz-transform: rotate(-90deg) scaleX(-1);
    -o-transform: rotate(-90deg) scaleX(-1);
    -webkit-transform: rotate(-90deg) scaleX(-1);
    -ms-transform: rotate(-90deg) scaleX(-1);
    transform: rotate(-90deg) scaleX(-1);
} 
```

​</p>

​</p>

[http://jsfiddle.net/rlemon/Y5ZvA/2/](http://jsfiddle.net/rlemon/Y5ZvA/2/)

# git - 在不同的目录结构中从 Origin 获取多个分支

> ID：10022354
> 
> 赞同：-1
> 
> 时间：2012-04-05T03:37:59.307
> 
> 标签：git, github

我已经克隆了包含近 10 个不同分支的项目的 repo，我通常同时在 2-3 个分支上工作，所以我需要克隆 repo 3 次，然后将它们切换到不同的分支。或者我可以从 repo 创建三个不同的目录结构，以便我可以在 eclipse 中将它们作为 3 个不同的项目导入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:25:55.067

根据设计，Git 使得从一个分支转换到另一个分支变得非常容易，包括保存正在进行的工作（使用“git stash”）。您可能会考虑一个更加结构化的开发过程，您一次在一个分支上工作，完成一小部分工作，提交它然后继续 - 到另一个分支或同一分支上的另一个“工作单元”。

如果您必须同时在三个分支上工作，则克隆您的项目的 repo 三次并拥有三个 eclipse 项目；除了将每个克隆推回项目存储库时，将它们全部分开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T03:41:06.003

如果您想将它们作为 Eclipse 项目的单独目录，您最好只制作 3 个克隆。

单个克隆通常最好与单个工作目录相关联。（如果不是这样，事情就会变得复杂。）

# c++ - C++ 中 const 的内部链接，但我得到重复的符号

> ID：10022355
> 
> 赞同：1
> 
> 时间：2012-04-05T03:38:22.277
> 
> 标签：c++

有人可以建议吗？

如果`const`在 C++ 中默认为内部链接，为什么在下面的代码中会出现多个定义错误？

首先，文件`dem.h`：

```
#ifndef _DEM_H_
    #define _DEM_H_
    class Dem {
        public:
            static const int i;
    };

    const int Dem::i = 10;
#endif 
```

他们`imp1.cpp`：

```
#include "dem.h"
#include <iostream>

using namespace std;
extern int foo();

int main() {
        cout << foo() << endl;
} 
```

和`imp2.cpp`：

```
#include "dem.h"

int foo() {
    return Dem::i ;
} 
```

我使用以下命令和结果进行编译：

```
$ g++ imp1.cpp imp2.cpp
/tmp/ccmGt0OY.o:imp2.cpp:(.rdata+0x0): multiple definition of `Dem::i'
/tmp/cc5sN7dz.o:imp1.cpp:(.rdata+0x0): first defined here
collect2: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T03:45:36.463

从 C++11 `[basic.link]`，第 5 段：

> 此外，成员函数、静态数据成员、类范围的命名类或枚举，或在类范围 typedef 声明中定义的未命名类或枚举，使得类或枚举具有用于链接目的的 typedef 名称 (7.1\. 3)，如果类名有外部链接，则有外部链接。

因为你的类有外部链接，所以你的静态数据成员也有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T03:49:56.337

它对编译单元是静态的。您分两步进行编译——首先是 impl1.cpp，然后是 impl2.cpp——并且在每个单元中，编译器都会实例化静态数据成员。当链接器尝试将两个关联的目标文件链接在一起时，它会看到同一个符号的两个不同定义，因此您会收到多重定义错误。

# xml - Can't expose REST XML, REST JSON and SOAP properly via configuration only for WCF

> ID：10022358
> 
> 赞同：3
> 
> 时间：2012-04-05T03:38:44.187
> 
> 标签：xml, json, wcf, rest, configuration

I'm wanting to be able to build a WCF service which achieves the following:

*   RESTfully exposes JSON
*   RESTfully exposes XML
*   Exposes SOAP
*   Other bindings if necessary

The key here, is that I want to do this all **via configuration**, and only one function written in code for each required method, rather than having to specify separately in code `ResponseFormat=ResponseFormat.Json` or `ResponseFormat=ResponseFormat.Xml` above separate functions for the RESTful methods. I've done plenty of research and I can't find anything solid for whether this is possible purely by configuration.

The strange thing is, when I build the project the RESTful methods work when I access them via URL, but the WSDL throws an error - i.e. if someone wanted to reference/consume the service via SOAP it would fail at the WSDL import step.

The code for the service is below, as well as the configuration, and the service is hosted locally for testing under [http://localhost/WCF](http://localhost/WCF). The following 2 RESTful calls work succesfully and return successful XML and JSON in the browser:

localhost/WCF/service1.svc/json/students

localhost/WCF/service1.svc/rest/students

But, if I call [http://localhost/WCF/service1.svc?wsdl](http://localhost/WCF/service1.svc?wsdl) I get the error below. If I remove one of the webhttpBinding endpoint configurations, the WSDL works and displays correctly, and can therefore be referenced.

Is it just not possible to have multiple webHttpBindings in the config (i.e. has to be done via separate methods and attributes such as `ResponseFormat=ResponseFormat.Json`) for WSDL generation to be valid? Or have I configured something incorrectly here?

Any help appreciated, would be so much more straightforward to do it via config that extra functions with serialization specified. Thanks.

**WSDL generation error**

```
An ExceptionDetail, likely created by IncludeExceptionDetailInFaults=true, whose value is:
    System.NullReferenceException: Object reference not set to an instance of an object.
       at System.ServiceModel.Description.WsdlExporter.CreateWsdlBindingAndPort(ServiceEndpoint endpoint, XmlQualifiedName wsdlServiceQName, Port& wsdlPort, Boolean& newBinding, Boolean& bindingNameWasUniquified)
       at System.ServiceModel.Description.WsdlExporter.ExportEndpoint(ServiceEndpoint endpoint, XmlQualifiedName wsdlServiceQName)
       at System.ServiceModel.Description.WsdlExporter.ExportEndpoints(IEnumerable`1 endpoints, XmlQualifiedName wsdlServiceQName)
       at System.ServiceModel.Description.ServiceMetadataBehavior.MetadataExtensionInitializer.GenerateMetadata()
       at System.ServiceModel.Description.ServiceMetadataExtension.EnsureInitialized()
       at System.ServiceModel.Description.ServiceMetadataExtension.get_Metadata()
       at System.ServiceModel.Description.ServiceMetadataExtension.HttpGetImpl.InitializationData.InitializeFrom(ServiceMetadataExtension extension)
       at System.ServiceModel.Description.ServiceMetadataExtension.HttpGetImpl.GetInitData()
       at System.ServiceModel.Description.ServiceMetadataExtension.HttpGetImpl.TryHandleMetadataRequest(Message httpGetRequest, String[] queries, Message& replyMessage)
       at System.ServiceModel.Description.ServiceMetadataExtension.HttpGetImpl.ProcessHttpRequest(Message httpGetRequest)
       at SyncInvokeGet(Object , Object[] , Object[] )
       at System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(Object instance, Object[] inputs, Object[]& outputs)
       at System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(MessageRpc& rpc)
       at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage5(MessageRpc& rpc)
       at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage31(MessageRpc& rpc)
       at System.ServiceModel.Dispatcher.MessageRpc.Process(Boolean isOperationContextSet) 
```

**Web.config**

```
<?xml version="1.0"?>
<configuration>
  <system.web>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>
  <system.serviceModel>
    <services>
      <service behaviorConfiguration="httpGetBehavior" name="WCF.Service1">
        <endpoint address="json" binding="webHttpBinding" name="jsonRest" contract="WCF.IService1" behaviorConfiguration="jsonBehavior"></endpoint>
        <endpoint address="rest" binding="webHttpBinding" name="xmlRest" contract="WCF.IService1" behaviorConfiguration="restBehaviour"></endpoint>
        <endpoint address="soap" binding="basicHttpBinding" name="soap" contract="WCF.IService1"></endpoint>
        <endpoint name="mex" address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost/WCF"/>
          </baseAddresses>
        </host>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="httpGetBehavior">
          <serviceMetadata httpGetEnabled="true"/>
        </behavior>
      </serviceBehaviors>
      <endpointBehaviors>
        <behavior name="jsonBehavior">
          <webHttp defaultOutgoingResponseFormat="Json"/>
        </behavior>
        <behavior name="restBehaviour">
          <webHttp/>
        </behavior>
      </endpointBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>  
</configuration> 
```

**Code**

```
public class Service1 : IService1
{       
    public IList<Student> GetStudents()
    {
        IList<Student> students = new List<Student>();
        students.Add(new Student() { FirstNme = "Bob", LastName = "Long", StudentId = 1, Subject = "Economics" });
        students.Add(new Student() { FirstNme = "Jack", LastName = "Short", StudentId = 2, Subject = "IT" });
        return students;
    }
}

[ServiceContract]
public interface IService1
{       
    [WebGet(UriTemplate = "/students")]
    [OperationContract]
    IList<Student> GetStudents();

}

[DataContract]
public class Student
{
    private int _studentId;
    private string _firstName;
    private string _lastName;
    private string _subject;

    [DataMember]
    public int StudentId
    {
        get { return _studentId; }
        set { _studentId = value; }
    }

    [DataMember]
    public string FirstNme
    {
        get { return _firstName; }
        set { _firstName = value; }
    }

    [DataMember]
    public string LastName
    {
        get { return _lastName; }
        set { _lastName = value; }
    }

    [DataMember]
    public string Subject
    {
        get { return _subject; }
        set { _subject = value; }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T15:47:17.987

This is a known issue where having json, xml and soap endpoints for a single service throws an exception.

I have raised it as an error on [MS Connect](http://connect.microsoft.com/wcf/feedback/details/711802/hosting-multiple-endpoints-soap-xml-and-json-causes-an-exception-when-accessing-the-service).

If you switch your Framework to 3.5 then that would work or an workaround is provided as well. You can just get the content-header from the request object and determine that in your code to set the response format and send the response back accordingly.

Also in the Web API, the framework automatically determines this based on the content type if nothing is specified in your WebGet/WebInvoke attributes and returns the response accordingly.

**NOTE**: At the moment when i try to open the link on MS Connect I get some system error on the MS Connect site. If you would like the workaround let me know i can send it across. Also MS has confirmed that they are not going to Fix it as not many clients would want to expose all the 3 formats on a single service.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:27:26.723

Hmmm, I have created a very simple service that works with having SOAP, JSON, and XML endpoints. Does it work only because of its simplicity?

I found out that I had to declare separate binding configurations (albeit empty) for json and xml. Here is the configuration (updated, because only the system.serviceModel section was visible before):

```
<?xml version="1.0"?>
<configuration>

  <system.web>
    <compilation debug="true" targetFramework="4.0"/>
  </system.web>

  <system.serviceModel>

    <bindings>
      <webHttpBinding>
        <!-- separate bindings are necessary -->
        <binding name="jsonBinding"/>
        <binding name="xmlBinding"/>
      </webHttpBinding>
    </bindings>

    <behaviors>
      <serviceBehaviors>
        <behavior>
          <serviceMetadata httpGetEnabled="true"/>
          <serviceDebug includeExceptionDetailInFaults="true"/>
        </behavior>
      </serviceBehaviors>

      <endpointBehaviors>
        <behavior name="xmlEndpoint">
          <webHttp helpEnabled="true" defaultOutgoingResponseFormat="Xml"/>
        </behavior>
        <behavior name="jsonEndpoint">
          <!-- do not specify enableWebScript or UriTemplate will not work -->
          <webHttp helpEnabled="true" defaultOutgoingResponseFormat="Json"/>
        </behavior>
      </endpointBehaviors>
    </behaviors>

    <services>
      <service name="Services.Addressbook.AddressbookService">
        <endpoint address="" binding="basicHttpBinding" name="soap" contract="Services.Addressbook.IAddressbookService" />
        <endpoint address="mex" binding="mexHttpBinding" name="mex" contract="IMetadataExchange" />
        <endpoint address="json" behaviorConfiguration="jsonEndpoint" binding="webHttpBinding" bindingConfiguration="jsonBinding" name="restJson" contract="Services.Addressbook.IAddressbookService" />
        <endpoint address="xml" behaviorConfiguration="xmlEndpoint" binding="webHttpBinding" bindingConfiguration="xmlBinding" name="restXml" contract="Services.Addressbook.IAddressbookService" />
      </service>
    </services>

    <serviceHostingEnvironment multipleSiteBindingsEnabled="true"/>

  </system.serviceModel>

  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>

</configuration> 
```

This is the service contract:

```
[ServiceContract]
public interface IAddressbookService {
  [OperationContract]
  [WebGet(UriTemplate = "Version")]
  string GetVersion();

  [OperationContract]
  [WebGet(UriTemplate = "Entries/Count")]
  int GetEntriesCount();

  [OperationContract]
  [WebGet(UriTemplate = "Entries")]
  Address[] GetEntries();

  [OperationContract]
  [WebGet(UriTemplate = "Entries/{name}")]
  Address[] SearchEntriesByName(string name);

  [OperationContract]
  [WebInvoke(Method = "POST", UriTemplate = "Entries/Add")]
  bool AddEntry(Address entry);

  [OperationContract]
  [WebInvoke(Method = "DELETE", UriTemplate = "Entries/Remove")]
  bool RemoveEntry(Address entry);
} 
```

And here is the data contract:

```
[DataContract]
public class Address {
  [DataMember]
  public string FirstName { get; set; }
  [DataMember]
  public string LastName { get; set; }
  [DataMember]
  public string Street { get; set; }
  [DataMember]
  public string City { get; set; }
  [DataMember]
  public int ZipCode { get; set; }
  [DataMember]
  public string Country { get; set; }
  [DataMember]
  public string Phone { get; set; }
  [DataMember]
  public string Email { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T03:15:15.980

Please try [this](http://social.msdn.microsoft.com/Forums/en/wcf/thread/845d0bbd-52b4-420f-bf06-793d53ef93ba)

```
<bindings>
  <webHttpBinding>
    <binding name="webBindingXML"></binding>
    <binding name="webBindingSOAP"></binding>
  </webHttpBinding>
</bindings> 
```

# css - CSS：如何使标签出现在收音机的右侧？

> ID：10022363
> 
> 赞同：9
> 
> 时间：2012-04-05T03:40:11.120
> 
> 标签：css, radio-button

假设我有以下标记：

```
<label for="name">Name:</label>
<input type="radio" name="name" id="name"/> 
```

标签的顺序对我来说似乎是正确的（在语义上：标签在你要标记的东西之前）。但我想首先将其显示为单选按钮，然后是标签。我怎样才能在 CSS 中做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-05T03:43:37.537

你不需要 CSS。将您的输入包装在标签中并将文本放在最后。

```
<label><input type="radio" name="name" id="name"/>Name:</label> 
```

这对你来说仍然是语义的吗？

或者你可以试试浮动。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T03:45:12.023

在这种情况下，标签顺序无关紧要。即使这样做了，也会反过来——首先你必须创建单选按钮，然后在标签中引用它。

要回答您的问题：只需按照您要显示的顺序执行即可

```
<input type="radio" name="name" id="name"/>
<label for="name">Name:</label> 
```

小提琴[http://jsfiddle.net/Jm2JR/1/](http://jsfiddle.net/Jm2JR/1/) ..

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T03:44:36.290

像这样写：

```
input{
 float:left;
} 
```

检查这个[http://jsfiddle.net/3cLRg/](http://jsfiddle.net/3cLRg/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T03:42:52.587

```
<label for="name" style="float:right;">Name:</label> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-05T03:47:02.973

尝试这个：

```
<label style="position:relative; left:100px;" for="name">Name:</label>
<input type="radio" name="name" id="name"/> 
```

第二种方法是：

```
<input type="radio" name="name" id="name"/>
<label for="name">Name:</label> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-05T03:57:00.560

嗨，您只需像这样定义您的输入标签

```
<label>Name:
<input type="radio" name="name" id="name"/></label>

<br />

<label>
<input type="radio" name="name" id="name"/> Name    
</label>
​ 
```

现场演示[http://jsfiddle.net/rohitazad/bhBQn/1/](http://jsfiddle.net/rohitazad/bhBQn/1/)

# emacs - CEDET 覆盖颜色主题

> ID：10022367
> 
> 赞同：3
> 
> 时间：2012-04-05T03:40:55.927
> 
> 标签：emacs

在我的 .emacs 文件中，我有：

```
(add-to-list 'load-path (expand-file-name "emacs/site/jde/lisp"))
(add-to-list 'load-path (expand-file-name "emacs/site/cedet/common"))
(add-to-list 'load-path (expand-file-name "emacs/site/cedet/semantic"))
(add-to-list 'load-path (expand-file-name "emacs/site/cedet/speedbar"))
(add-to-list 'load-path (expand-file-name "emacs/site/cedet/eieio"))
    (setq jde-check-version-flag nil)
(load-file (expand-file-name "emacs/site/cedet/common/cedet.el"))
(add-to-list 'load-path (expand-file-name "emacs/site/elib"))

(require 'jde)

(add-to-list 'load-path "~/elisp")
(add-to-list 'load-path "~/elisp/color-theme")
(require 'color-theme)
  (color-theme-initialize)
  (color-theme-clarity) 
```

上半部分运行 JDEE，下半部分为我提供清晰度颜色主题。我的问题是，当我使用 JDEE 时，Java 文本的颜色会恢复到我应用颜色主题之前的颜色。这是一个问题，因为默认颜色很糟糕，无论如何我都希望我的颜色主题适用。有没有办法让颜色主题优先于 JDEE？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T07:15:50.933

正如我在 JDEE 源代码中看到的，它对 Java 源文本使用自己的面孔，而不是标准的字体锁定面孔。您需要使用`M-x customize-group jde-java-font-lock-faces`命令自定义 JDEE 面...另一种更新它们的方法 - 添加代码，将标准字体锁定面的值分配给变量，例如`jde-java-font-lock-number-face`（完整列表在`jde-java-font-lock.el`文件中），尽管 JDEE 定义的面比字体锁定更多提供。

PS 关于加载 CEDET 的一条评论 - 如果您`cedet.el`用于加载 CEDET，那么它将`load-path`相应设置，因此您无需手动更新它。

# javascript - 可以在 Ext JS 中将 XML 响应作为流读取吗

> ID：10022368
> 
> 赞同：1
> 
> 时间：2012-04-05T03:40:57.670
> 
> 标签：javascript, ajax, http, extjs, streaming

我有一个生成 XML 响应的请求。由于某些当前的限制，响应可能会非常缓慢地完成，但确实开始快速返回数据。

是否可以在响应完成之前读取 Ext JS 中的响应流？我的理解是，`*Readers`只有在完成后才会给出响应文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T10:00:23.787

似乎没有用于[Comet 技术的 Ext.Proxy](http://en.wikipedia.org/wiki/Comet_%28programming%29)，而且我认为写起来会很困难。首先，您需要编写一个 Sax 解析器来理解不完整的 XML 文档。然后，您需要编写一个代理，在新数据通过时重复执行操作。ExtJS 并不是真正为此而设计的，但尝试一下会是一件有趣的事情。不过，我不确定它有多实用。任何实现的 Ext.Proxy 的行为都会与其他代理大不相同；虽然它可能有同名的方法，但它会是一个非常不同的接口。您必须扩展 Ext.Model 和 Ext.Store 以了解如何使用流数据填充自己，为块事件编写新的侦听器，并为 Stores 和 Models 的消费者编写新的数据协定。我不确定这是否值得你花时间！

但是，如果您只需要在流块通过时抛出一个事件，那么这在 Gecko 和 WebKit 浏览器中是可能的。您只需要将处理程序附加到 XHR 的 onreadystate 事件，每次接收到数据时都会触发该事件。

实验上：

```
Ext.define('Ext.proxy.StreamEventedAjax',{
    extend: 'Ext.proxy.Ajax',
    doRequest: function(operation, callback, scope) {

        if (Ext.isIE) return null;

        // do other doRequest setup here, use this.buildRequest, etc

        var me = this,
            req = new XMLHttpRequest(),
            responseLength = 0,
            newText = "";
        req.onreadystate = function(e) {

           newText = req.responseText.substring(responseLength);
           responseLength = req.responseText.length;

           operation.fireEvent('datareceived',e,newText);

        }

        req.open(me.getMethod(request),request.url);

    }
}); 
```

# javascript - JavaScript 将数组转换为函数数组

> ID：10022376
> 
> 赞同：2
> 
> 时间：2012-04-05T03:42:08.053
> 
> 标签：javascript, arrays, function

您好，我正在解决一个问题，该问题需要我将一组数字更改为一个将原始数字作为函数返回的数组。所以我们得到了 a2 而不是 a[2] 的返回值。

我不想要答案，我只需要一个提示。我知道我可以遍历数组并使用 .pop() 来获取数组的最后一个值，但是我不知道如何从那里将其转换为函数。任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:55:51.787

```
var numToFun = [1, 2, 3];
var numToFunLength = numToFun.length;

for (var i = 0; i < numToFunLength; i++) {
    (function(num){
        numToFun.unshift(function() {
            return num;
        });
    }(numToFun.pop())) 
} 
```

[演示](http://jsfiddle.net/77cr3/)

基本上它从最后一个数字中弹出一个数字，用返回的数字构建一个函数，然后放回数组的第一个。一个完整的循环后，它们都是函数。

问题是：这是如何工作的，由你来研究

为什么循环看起来不像简单的 pop-unshift：

```
for (var i = 0; i < numToFunLength; i++) {
    numToFun.unshift(function() { //put into first a function
        return numToFun.pop()     //that returns a number
    });
} 
```

以及我为什么这样做：（提示：性能）

```
var numToFunLength = numToFun.length; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T04:00:03.680

这里有三个重要步骤：

*   从数组中提取数值。在带有 的迭代器的循环中`i`，它可能如下所示：

    `var num = numArray[i];`

*   这很重要，因为`i`它不会保留它在创建新函数时所具有的值 - 一旦`for`循环完成，它将以它所具有的最后一个值结束。函数本身可能如下所示：

    `function() { return num; }`

*   没有`i`更多的参考，这很重要 - 为了更好地理解，请阅读有[关闭包](https://developer.mozilla.org/en/JavaScript/Guide/Closures)的内容。最后一步是将新函数添加到所需的函数数组中。

......你就完成了！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T03:47:15.113

**编辑：查看其他人的答案以获得如何正确执行此操作的良好解释，不过我也会修复我的**

正如其他人所指出的那样，许多人在 javascript 中遇到的棘手问题之一（显然包括我自己）是 javascript 中的作用域变量与许多其他语言不同。范围几乎完全由函数定义，而不是像 java/C 那样由 for 循环的 {} 块定义。

因此，您可以在下面看到（以及此处的其他答案）范围界定功能可以帮助解决此类问题。

```
var numArray = [12, 33, 55];
var funcArray = [];
var numArrLength = numArray.length; // Don't do this in for loop to avoid the check multiple times
for(var j=0; j < numArrLength; j++) {
    var scopeMe = function() {
        var numToReturn = numArray[j];
        console.log('now loading... ' + numToReturn);
        var newFunc = function() {
           return numToReturn;
        };
        return newFunc;
   }();
   funcArray.push(scopeMe);
};
console.log('now me');
console.log(funcArray);

console.log(funcArray[0]());
console.log(funcArray[1]());
console.log(funcArray[2]());
console.log(funcArray[1]()); // To ensure it's repeatable 
```

**在下面编辑我的旧错误答案**

你想要做的是

```
var funcArray = [];
for(...) {

   var newFunc = function() {
     return numArray.pop();

   }
   funcArray.push(newFunc); 
} 
```

这里的关键是javascript中的函数可以命名为变量，并且可以这样传递:)

# ruby-on-rails - 每次打开 .html.erb 文件时都设置 eruby-nxhtml-mumamo-mode

> ID：10022379
> 
> 赞同：5
> 
> 时间：2012-04-05T03:42:31.870
> 
> 标签：ruby-on-rails, emacs, nxhtml

我下载了 nxhtml 并解压缩。然后我把它放在我的 .emacs 文件中。

```
(add-to-list 'load-path "~/nxhtml/util")
    (require 'mumamo-fun)
    (setq mumamo-chunk-coloring 'submode-colored)
    (add-to-list 'auto-mode-alist '("\\.rhtml\\'" . eruby-nxhtml-mumamo-mode))
    (add-to-list 'auto-mode-alist '("\\.html\\.erb\\'" . eruby-nxhtml-mumamo-mode)) 
```

当我打开一个 .html.erb 文件时，它没有设置正确的模式（因此语法突出显示不正确）。我知道 require 语句运行正确 b/c 我可以手动将 aquamacs 设置为 eruby-nxhtml-mumamo-mode ，如果我注释掉 require 行，我什至无法切换到该模式。我什至尝试将 eruby...-mode 替换为其他模式，例如 c++-mode 和其他我知道可以工作但也不起作用的模式。

那么我的正则表达式有问题吗？我不确定。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T20:35:21.987

尝试以下操作：

```
(add-to-list 'auto-mode-alist '("\\.rhtml?$" . eruby-nxhtml-mumamo-mode))
(add-to-list 'auto-mode-alist '("\\.html?\\.erb$" . eruby-nxhtml-mumamo-mode)) 
```

您的表达式末尾似乎有一个转义逗号。

我不知道您的标题中缺少“l”是否是故意的，但无论哪种方式，问号都应该说明这一点。美元符号将表达式锚定到字符串的末尾，名义上是可选的，但最好是明确的。

# c# - C# hybird Winforms / 控制台应用程序返回到cmd提示符

> ID：10022380
> 
> 赞同：1
> 
> 时间：2012-04-05T03:42:36.713
> 
> 标签：c#

我见过很多 C# 混合 gui/cli 应用程序的例子。我已经实现了这样一个应用程序，但是我很难弄清楚如何防止 .exe 在命令行上运行时不立即返回到提示符。

```
 //defines for commandline output     
    [DllImport("kernel32.dll")]
    static extern bool AttachConsole(int dwProcessId);
    private const int ATTACH_PARENT_PROCESS = -1;

    [STAThreadAttribute]
    static void Main(string[] args)
    {
        // load cli
        // redirect console output to parent process;         
        // must be before any calls to Console.WriteLine()         
        AttachConsole(ATTACH_PARENT_PROCESS);

        if (args.Length == 0)
        {
            //loads gui
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new form_Main());
        }
        else
        {

            cli_main cli = new cli_main();
            cli.start_cli(args);

            Console.WriteLine("finished");

            System.Windows.Forms.SendKeys.SendWait("{ENTER}");
            Application.Exit();

        }
    } 
```

我得到以下输出

```
C:\Users\john\Documents\Visual Studio 2010\Projects\test\test\test\bin\Debug>test.exe -param1 test 
-param2 test2

C:\Users\john\Documents\Visual Studio 2010\Projects\test\test\test\bin\Debug>Output was successful. File saved as: c:\test\test.html
finished 
```

“完成”行是当我知道我已经到达主代码末尾时输出的字符串......这在 Winforms 中运行良好，我的项目是 Winforms，我将它作为 gui 启动，但现在我正试图让它混合gui/cli

它似乎正在运行我的主要代码和线程，我在调试中看到它们，它创建了我的最终输出文件......

我只是对如何在从 cmd 行执行时保留 .exe 及其参数而不返回命令提示符感到困惑？让它等待闪烁的光标，然后输出关于 html 文件的行，然后输出“完成”行，最后返回命令提示符。

我已经尝试了很多东西，比如删除

```
System.Windows.Forms.SendKeys.SendWait("{ENTER}");
Application.Exit(); 
```

而不是使用`Application.Exit();`use`Environment.Exit(0);`但它总是立即返回到命令提示符，我也尝试在该行之后进入睡眠 5 秒

```
cli.start_cli(args); 
```

但这也不起作用，我想我不明白它如何立即返回命令提示符，而且它甚至没有这条线

```
Console.WriteLine("finished"); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T15:55:01.123

FWIW，我也尝试了第一种方法。我最终只是使用以下方法隐藏了控制台窗口：

```
IntPtr handle = GetConsoleWindow();
if (handle != IntPtr.Zero)
{
    ShowWindow(handle, 0);  // 0=SW_HIDE
} 
```

这完全隐藏了窗口，甚至在任务栏中也是如此。它会闪烁一秒钟，但在我的情况下这是可以接受的

# c# - 将未知的装箱简单值类型（char、int、ulong 等）转换为 UInt64

> ID：10022383
> 
> 赞同：3
> 
> 时间：2012-04-05T03:42:59.107
> 
> 标签：c#

扩展 Jon Skeet 对[This Previous Question](https://stackoverflow.com/questions/631994)的回答。Skeet 没有解决当负值和二进制补码值进入图片时发生的故障。

简而言之，我想将任何简单类型（保存在一个未知的 boxed 中`object`）转换为，`System.UInt64`以便我可以使用底层的二进制表示。

**我为什么要这样做？请参阅底部的说明。**

下面的示例显示了`Convert.ToInt64(object)`和`Convert.ToUInt64(object)`都中断 ( `OverflowException`) 的情况。

造成以下情况的原因只有两个`OverflowExceptions`：

1.  `-10UL`转换为时会导致异常，`Int64`因为负值强制转换为`0xfffffffffffffff6`（在未经检查的上下文中），这是一个大于`Int64.MaxValue`. **我希望将其转换为`-10L`.**

2.  转换为 时`UInt64`，持有负值的有符号类型会导致异常，因为`-10`小于`UInt64.MinValue`。**我希望这些转换为它们真正的二进制补码值（即`0xffffffffffffffff6`）。**无符号类型并不真正持有负值`-10`，因为它在未经检查的上下文中被转换为二进制补码；因此，无符号类型不会发生异常。

kludge 解决方案似乎是转换为，`Int64`然后是未经检查的转换为`UInt64`. 这种中间转换会更容易，因为`Int64`在直接转换为`UInt64`.

*注意：该示例使用`unchecked`上下文仅用于在装箱期间将负值强制转换为无符号类型（这会创建正的二进制补码等效值）。这种`unchecked`背景不是当前问题的一部分。*

```
using System;

enum DumbEnum { Negative = -10, Positive = 10 };

class Test
{
  static void Main()
  {
    unchecked
    {
      Check((sbyte)10);
      Check((byte)10);
      Check((short)10);
      Check((ushort)10);
      Check((int)10);
      Check((uint)10);
      Check((long)10);
      Check((ulong)10);
      Check((char)'\u000a');
      Check((float)10.1);
      Check((double)10.1);
      Check((bool)true);
      Check((decimal)10);
      Check((DumbEnum)DumbEnum.Positive);

      Check((sbyte)-10);
      Check((byte)-10);
      Check((short)-10);
      Check((ushort)-10);
      Check((int)-10);
      Check((uint)-10);
      Check((long)-10);
      //Check((ulong)-10);   // OverflowException
      Check((float)-10);
      Check((double)-10);
      Check((bool)false);
      Check((decimal)-10);
      Check((DumbEnum)DumbEnum.Negative);

      CheckU((sbyte)10);
      CheckU((byte)10);
      CheckU((short)10);
      CheckU((ushort)10);
      CheckU((int)10);
      CheckU((uint)10);
      CheckU((long)10);
      CheckU((ulong)10);
      CheckU((char)'\u000a');
      CheckU((float)10.1);
      CheckU((double)10.1);
      CheckU((bool)true);
      CheckU((decimal)10);
      CheckU((DumbEnum)DumbEnum.Positive);

      //CheckU((sbyte)-10);  // OverflowException
      CheckU((byte)-10);
      //CheckU((short)-10);  // OverflowException
      CheckU((ushort)-10);
      //CheckU((int)-10);    // OverflowException
      CheckU((uint)-10);
      //CheckU((long)-10);   // OverflowException
      CheckU((ulong)-10);
      //CheckU((float)-10.1);  // OverflowException
      //CheckU((double)-10.1); // OverflowException
      CheckU((bool)false);
      //CheckU((decimal)-10);  // OverflowException
      //CheckU((DumbEnum)DumbEnum.Negative); // OverflowException
    }
  }

  static void Check(object o)
  {
    Console.WriteLine("Type {0} converted to Int64: {1}",
                    o.GetType().Name, Convert.ToInt64(o));
  }

  static void CheckU(object o)
  {
    Console.WriteLine("Type {0} converted to UInt64: {1}",
                    o.GetType().Name, Convert.ToUInt64(o));
  }
} 
```

# 为什么？

为什么我希望能够在所有这些值类型之间相互转换`UInt64`？因为我编写了一个类库，可以将结构或类转换为打包成单个`UInt64`值的位字段。

示例：考虑`DiffServ`每个 IP 数据包头中的字段，该字段由许多二进制位字段组成：

![IP 数据包 DiffServ 字段](../Images/2209d48a7fd577c96e84acdfc3fcdf0a.png)

使用我的类库，我可以创建一个结构来表示 DiffServ 字段。我创建了一个`BitFieldAttribute`指示哪些位属于二进制表示中的位置：

```
struct DiffServ : IBitField
{
    [BitField(3,0)]
    public PrecedenceLevel Precedence;

    [BitField(1,3)]
    public bool Delay;

    [BitField(1,4)]
    public bool Throughput;

    [BitField(1,5)]
    public bool Reliability;

    [BitField(1,6)]
    public bool MonetaryCost;
}

enum PrecedenceLevel
{
    Routine, Priority, Immediate, Flash, FlashOverride, CriticEcp,
    InternetworkControl, NetworkControl
} 
```

然后，我的类库可以将此结构的实例与其正确的二进制表示形式相互转换：

```
// Create an arbitrary DiffServe instance.
DiffServ ds = new DiffServ();
ds.Precedence = PrecedenceLevel.Immediate;
ds.Throughput = true;
ds.Reliability = true;

// Convert struct to value.
long dsValue = ds.Pack();

// Create struct from value.
DiffServ ds2 = Unpack<DiffServ>(0x66); 
```

为了实现这一点，我的类库会查找用`BitFieldAttribute`. 获取和设置成员检索包含装箱值类型（int、bool、enum 等）的对象。因此，我需要拆箱任何值类型并将其转换为其准系统二进制表示，以便可以提取和打包位成一个`UInt64`值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:22:38.807

我将发布我最好的解决方案作为大众的饲料。

这些转换在取消装箱中包含的未知简单值类型时消除了所有异常（除了`float, double, decimal`不适合 64 位整数的非常大的值）`object o`：

```
long l = o is ulong ? (long)(ulong)o : Convert.ToInt64(o));
ulong u = o is ulong ? (ulong)o : (ulong)Convert.ToInt64(o)); 
```

对此的任何改进都将受到欢迎。

# c - 对返回长度 C 和 C++ 的 char* list[] 的怀疑

> ID：10022384
> 
> 赞同：1
> 
> 时间：2012-04-05T03:43:00.847
> 
> 标签：c, visual-c++

如果我这样写，我返回结果为1。不明白为什么？预期答案是 5。

```
 int main()
    {
      const char* list_of_filename[] = {"One","Two","Three","Four","Five"};

      printf("%d", countFiles(list_of_filename));

      return 0;
    }

    int countFiles(const char* list_of_filename[])
    {
      return sizeof(list_of_filename) / sizeof(list_of_filename[0]);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T03:45:17.483

`sizeof`对于数组仅适用于声明数组的范围。

```
 const char* list_of_filename[] = {"One","Two","Three","Four","Five"};
  printf("%d", sizeof(list_of_filenames) / sizeof(list_of_filenames[0])); 
```

在 C 中，您不能传递数组。所以：

```
int countFiles(const char* list_of_filename[]) 
```

与以下内容完全相同：

```
int countFiles(const char **list_of_filename) 
```

因此，您正在比较两个指针的大小。`const char *`和的大小`const char **`在您的系统上是相同的。

这个[答案](https://stackoverflow.com/a/4415646/47773)（由 Michael Burr 提供，但最初来自 Chromium）提供了一个执行数组大小计算的宏，以及像这样的一些无效结构的错误（但不是这个）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T03:47:43.253

作为函数参数，

```
const char* list_of_filename[] 
```

实际上意味着：

```
const char** list_of_filename. 
```

因此，您实际上计算的是：

```
sizeof(char**) / sizeof(char*) 
```

`char**`and`char*`都只是指针，并且由于所有指针*通常*具有相同的大小（至少在这种情况下，对您而言，这两个是）：

```
x / x
= 1 
```

**编辑：**将数组传递给 C 中的函数时，您通常要么想要传递数组的大小，要么用特定值终止数组，以便能够确定它的长度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T03:52:44.710

来自 C 标准 ( `C11 6.3.2.1 Lvalues, arrays, and function designators, para 3`)：

> 除非它是 sizeof 运算符、_Alignof 运算符或一元 & 运算符的操作数，或者是用于初始化数组的字符串文字，否则类型为 ''array of type'' 的表达式将转换为具有type ''pointer to type'' 指向数组对象的初始元素并且不是左值。

换句话说，当您将该数组传递给函数时，它变成了指向数组第一个元素的指针，因此它的大小就是指针的大小。

如果要将其视为函数中的数组，则需要显式传递大小信息，例如：

```
void printArray (int *arr, size_t sz) {
    for (size_t i = 0; i < sz; i++)
        print ("%d ", arr[i]);
    puts ("");
}
:
int xyzzy[] = {3,1,3,1,5,9,2,6,5,3,5,8,9};
printArray (xyzzy, sizeof (xyzzy) / sizeof (*xyzzy)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T04:47:50.380

**C数组和指针不一样！**

新手 C 程序员经常听到的第一件事是“数组与指针相同”。不幸的是，这是一个危险的半真半假。ANSI C 标准第 6.5.4.2 段建议您

> 注意声明之间的区别：

```
extern int *x;
extern int y[]; 
```

> 第一个声明 x 是一个指向 int 的指针；第二个声明 y 是一个未指定大小的 int 数组（一个不完整的类型），其存储在别处定义。

该标准没有比这更详细地讨论这个问题。

因此，当您尝试`sizeof`从数组中获取时，它以字节为单位返回整个数组的大小（对象大小的总和），当您尝试获取`sizeof`指针时 - 它以字节为单位返回指针的大小。指针的大小在一个平台上始终是恒定值。一般为 4 或 8 个字节。

记住这一点 ：）

# iphone - 在我将它们保存到 plist 之前，变量会丢失它们的值

> ID：10022388
> 
> 赞同：0
> 
> 时间：2012-04-05T03:43:18.633
> 
> 标签：iphone, ios, plist, nsobject

我正在为我的 plist 编写一个控制器类，它是从另一个类调用的。控制器类有一个read和save方法，read方法打开plist并将其保存到documents文件中进行读写。在这个读取类中，我将之前保存的所有值放入它们自己的变量中。

然后在从另一个类调用的 Save 方法调用中，所有值都作为参数传入，然后从那里我将新值传递给正确的变量并将其传递给 plist.. 但是我的 plist 中有一个字典并且它只保存一个值并将其他值重置为空。我想知道如何确保这些变量保持它们的值？

这是我的.h

```
#import <Foundation/Foundation.h>

@interface EngineProperties : NSObject {

NSString *signature;
NSNumber *version;
NSNumber *request;
NSNumber *dataVersion;
NSMutableDictionary *cacheValue;
//cachevalue Items
NSNumber *man;
NSNumber *mod;
NSNumber *sub;

}

@property (copy, nonatomic) NSString *signature;
@property (copy, nonatomic) NSNumber *version;
@property (copy, nonatomic) NSNumber *request;
@property (copy, nonatomic) NSNumber *dataVersion;
@property (copy, nonatomic) NSMutableDictionary *cacheValue;
//cachevalue Items
@property (copy, nonatomic) NSNumber *man;
@property (copy, nonatomic) NSNumber *mod;
@property (copy, nonatomic) NSNumber *sub;

- (void) readPlistData;
- (void) saveData:(NSString *)methodName signature:(NSString *)pSignature Version:(NSNumber *)pVersion request:(NSNumber *)rNumber dataVersion:(NSNumber *)dvReturned cacheValue:(NSNumber *)cValue;

@end 
```

这是我的 .m

```
#import "EngineProperties.h"

@implementation EngineProperties

@synthesize signature;
@synthesize version;
@synthesize request;
@synthesize dataVersion;
@synthesize cacheValue;

@synthesize man;
@synthesize mod;
@synthesize sub;

//This opens up and reads the current plist ready to be used
-(void) readPlistData
{
    // Data.plist code
    // get paths from root direcory
    NSArray *paths = NSSearchPathForDirectoriesInDomains (NSDocumentDirectory, NSUserDomainMask, YES);
    // get documents path
    NSString *documentsPath = [paths objectAtIndex:0];
    // get the path to our Data/plist file
    NSString *plistPath = [documentsPath stringByAppendingPathComponent:@"EngineProperties.plist"];

    // check to see if Data.plist exists in documents
    if (![[NSFileManager defaultManager] fileExistsAtPath:plistPath])
    {
        // if not in documents, get property list from main bundle
        plistPath = [[NSBundle mainBundle] pathForResource:@"EngineProperties" ofType:@"plist"];
    }

    // read property list into memory as an NSData object
    NSData *plistXML = [[NSFileManager defaultManager] contentsAtPath:plistPath];
    NSString *errorDesc = nil;
    NSPropertyListFormat format;
    // convert static property liost into dictionary object
    NSDictionary *tempRoot = (NSMutableDictionary *)[NSPropertyListSerialization propertyListFromData:plistXML mutabilityOption:NSPropertyListMutableContainersAndLeaves format:&format errorDescription:&errorDesc];
    if (!tempRoot)
    {
        NSLog(@"Error reading plist: %@, format: %d", errorDesc, format);
    }
    // assign values
    self.signature = [tempRoot objectForKey:@"Signature"];
    self.version = [tempRoot objectForKey:@"Version"];
    self.request = [tempRoot objectForKey:@"Request"];
    self.dataVersion = [tempRoot objectForKey:@"Data Version"];

    man = [cacheValue objectForKey:@"Man"];
    mod = [cacheValue objectForKey:@"Mod"];
    sub = [cacheValue objectForKey:@"SubMod"];

    cacheValue = [tempRoot objectForKey:@"Cache Value"];
}

- (void) saveData:(NSString *)methodName signature:(NSString *)pSignature Version:(NSNumber *)pVersion request:(NSNumber *)rNumber dataVersion:(NSNumber *)dvReturned cacheValue:(NSNumber *)cValue;
{
    // get paths from root direcory
    NSArray *paths = NSSearchPathForDirectoriesInDomains (NSDocumentDirectory, NSUserDomainMask, YES);
    // get documents path
    NSString *documentsPath = [paths objectAtIndex:0];
    // get the path to our Data/plist file
    NSString *plistPath = [documentsPath stringByAppendingPathComponent:@"EngineProperties.plist"];

    // set the variables to the values in the text fields
    self.signature = pSignature;
    self.version = pVersion;
    self.request = rNumber;
    self.dataVersion = dvReturned;

    //do some if statment stuff here to put the cache in the right place or what have you.
    if (methodName == @"manufacturers")
    {
        self.man = cValue; 
    }
    else if (methodName == @"models")
    {
        self.mod = cValue;
    }
    else if (methodName == @"subMod")
    {
        self.sub = cValue;
    }

    self.cacheValue = [NSDictionary dictionaryWithObjectsAndKeys:
                       man, @"Manufacturers",
                       mod, @"Models",
                       sub, @"SubModels", nil];

    NSDictionary *plistDict = [NSDictionary dictionaryWithObjectsAndKeys:
                               signature, @"Signature",
                               version, @"Version",
                               request, @"Request",
                               dataVersion, @"Data Version",
                               cacheValue, @"Cache Value", nil];

    NSString *error = nil;
    // create NSData from dictionary
    NSData *plistData = [NSPropertyListSerialization dataFromPropertyList:plistDict format:NSPropertyListXMLFormat_v1_0 errorDescription:&error];

    // check is plistData exists
    if(plistData)
    {
        // write plistData to our Data.plist file
        [plistData writeToFile:plistPath atomically:YES];

        NSString *myString = [[NSString alloc] initWithData:plistData encoding:NSUTF8StringEncoding];
        //        NSLog(@"%@", myString);
    }
    else
    {
        NSLog(@"Error in saveData: %@", error);
        //        [error release];
    }
}

@end 
```

我正在尝试找出如何在这三个 var、man、mod、sub 中保留正确的值，以便我可以将它们放入我的缓存值字典中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T03:49:47.217

问题是当您准备好数据以创建字典时，此处：

```
if (methodName == @"manufacturers")
{
    self.man = cValue; 
}
else if (methodName == @"models")
{
    self.mod = cValue;
}
else if (methodName == @"subMod")
{
    self.sub = cValue;
} 
```

这不是比较字符串的正确方法（您实际上是在比较字符串的地址，因此它们可能永远不会相同），您应该使用以下方法：

```
if ([methodName isEqualToString:@"manufacturers"])
{
    self.man = cValue; 
}
else if ([methodName isEqualToString:@"models"])
{
    self.mod = cValue;
}
else if ([methodName isEqualToString:@"subMod"])
{
    self.sub = cValue;
} 
```

另一个问题是，在 readPlistData 中，您正在读取键“Man”、“Mod”和“SubMod”，但它们应该与您在字典中写入的内容相同：“Manufacturers”、“Models”和“SubModels”。（任何一个都可能是正确的，但它们需要匹配，以便您读取和写入相同的键！）

`EngineProperties`最后，您是在每次调用时使用相同的实例还是每次`saveData`都创建一个新对象？如果您不使用同一个对象，则每次调用 iVar 时都会将其重置为零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:08:36.927

首先当你打电话时

```
- (void) saveData:(NSString *)methodName signature:(NSString *)pSignature Version:(NSNumber *)pVersion request:(NSNumber *)rNumber dataVersion:(NSNumber *)dvReturned cacheValue:(NSNumber *)cValue; 
```

参考[this](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/compare%3aoptions%3arange%3a)比较字符串值

```
 //This opens up and reads the current plist ready to be used
-(void) readPlistData
{
    // Data.plist code
    // get paths from root direcory
    NSArray *paths = NSSearchPathForDirectoriesInDomains (NSDocumentDirectory, NSUserDomainMask, YES);
    // get documents path
    NSString *documentsPath = [paths objectAtIndex:0];
    // get the path to our Data/plist file
    NSString *plistPath = [documentsPath stringByAppendingPathComponent:@"EngineProperties.plist"];

    // check to see if Data.plist exists in documents
    if (![[NSFileManager defaultManager] fileExistsAtPath:plistPath])
    {
        // if not in documents, get property list from main bundle
        plistPath = [[NSBundle mainBundle] pathForResource:@"EngineProperties" ofType:@"plist"];
    }

    // read property list into memory as an NSData object
    NSData *plistXML = [[NSFileManager defaultManager] contentsAtPath:plistPath];
    NSString *errorDesc = nil;
    NSPropertyListFormat format;
    // convert static property liost into dictionary object
    NSDictionary *tempRoot = (NSMutableDictionary *)[NSPropertyListSerialization propertyListFromData:plistXML mutabilityOption:NSPropertyListMutableContainersAndLeaves format:&format errorDescription:&errorDesc];
    man = [cacheValue objectForKey:@"Man"];
    mod = [cacheValue objectForKey:@"Mod"];
    sub = [cacheValue objectForKey:@"SubMod"];
    if (tempRoot && [tempRoot count]){
         // assign values
        self.signature = [tempRoot objectForKey:@"Signature"];
        self.version = [tempRoot objectForKey:@"Version"];
        self.request = [tempRoot objectForKey:@"Request"];
        self.dataVersion = [tempRoot objectForKey:@"Data Version"];
        cacheValue = [tempRoot objectForKey:@"Cache Value"];
    }

}

- (void) saveData:(NSString *)methodName signature:(NSString *)pSignature Version:(NSNumber *)pVersion request:(NSNumber *)rNumber dataVersion:(NSNumber *)dvReturned cacheValue:(NSNumber *)cValue
{
    // get paths from root direcory
    NSArray *paths = NSSearchPathForDirectoriesInDomains (NSDocumentDirectory, NSUserDomainMask, YES);
    // get documents path
    NSString *documentsPath = [paths objectAtIndex:0];
    // get the path to our Data/plist file
    NSString *plistPath = [documentsPath stringByAppendingPathComponent:@"EngineProperties.plist"];

    // set the variables to the values in the text fields
    self.signature = pSignature;
    self.version = pVersion;
    self.request = rNumber;
    self.dataVersion = dvReturned;

    //do some if statment stuff here to put the cache in the right place or what have you.
    if (methodName isEqualToString:@"manufacturers") {
        self.man = cValue; 
    } else if (methodName isEqualToString:@"models") {
        self.mod = cValue;
    } else if (methodName isEqualToString:@"subMod") {
        self.sub = cValue;
    }

    self.cacheValue = [NSDictionary dictionaryWithObjectsAndKeys:
                   man, @"Manufacturers",
                   mod, @"Models",
                   sub, @"SubModels", nil];

    NSDictionary *plistDict = [NSDictionary dictionaryWithObjectsAndKeys:
                           signature, @"Signature",
                           version, @"Version",
                           request, @"Request",
                           dataVersion, @"Data Version",
                           cacheValue, @"Cache Value", nil];

    NSString *error = nil;
    // create NSData from dictionary
    NSData *plistData = [NSPropertyListSerialization dataFromPropertyList:plistDict format:NSPropertyListXMLFormat_v1_0 errorDescription:&error];

    // check is plistData exists
    if(plistData) {
        // write plistData to our Data.plist file
        [plistData writeToFile:plistPath atomically:YES];

        NSString *myString = [[NSString alloc] initWithData:plistData encoding:NSUTF8StringEncoding];
       //        NSLog(@"%@", myString);
    } else {
           NSLog(@"Error in saveData: %@", error);
          //  [error release];
    }
}
@end 
```

# c++ - 如何设置 WINDOWCLASSX hbrBackground alpha 通道？(C++)

> ID：10022391
> 
> 赞同：2
> 
> 时间：2012-04-05T03:43:49.350
> 
> 标签：c++, winapi, user-interface, alpha, winmain

所以，我有一个想要设置背景的 WINDOWCLASSX，包括 alpha 通道，但我只看到了一个“RGB”宏；没有RGBA。

那么如何在 hbrBackground 上设置 alpha 呢？这是我的代码：

```
 WNDCLASSEX wincl;  

wincl.hInstance = hThisInstance;
wincl.lpszClassName = szClassName;
wincl.lpfnWndProc = WindowProcedure;      
wincl.style = CS_DBLCLKS;               
wincl.cbSize = sizeof (WNDCLASSEX);

wincl.hIcon = LoadIcon (GetModuleHandle(0), MAKEINTRESOURCE(IDI_MYAPP));
wincl.hIconSm = LoadIcon (GetModuleHandle(0), MAKEINTRESOURCE(IDI_MYAPP));
wincl.hCursor = LoadCursor (NULL, IDC_ARROW);
wincl.lpszMenuName = MAKEINTRESOURCE(IDR_MAINFRAME);               
wincl.cbClsExtra = 0;                     
wincl.cbWndExtra = 0;                     

wincl.hbrBackground = (HBRUSH)GetStockObject(BLACK_BRUSH); 
```

在最后一行，我希望能够设置 alpha。

-谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:42:36.497

您不能在窗口类上使用背景画笔创建 Alpha 通道。您必须改为将`WS_EX_LAYERED`样式应用到窗口，然后使用`SetLayeredWindowAttributes()`或`UpdateLayeredWindow()`设置窗口的 Alpha 通道。阅读 MSDN 文档了解更多详细信息：

[使用分层窗口](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632598.aspx#layered_win)

[分层窗口](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632599.aspx#layered)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-30T12:56:08.957

这对我来说很有效：

```
// Set WS_EX_LAYERED on this window 
SetWindowLong(g_mainWnd, GWL_EXSTYLE, GetWindowLong(g_mainWnd, GWL_EXSTYLE) | WS_EX_LAYERED);

// Make this window 70% alpha
SetLayeredWindowAttributes(g_mainWnd, 0, (255 * 70) / 100, LWA_ALPHA); 
```

该`g_mainWnd`变量是对相应窗口的引用（在我的例子中是一个 HWND 变量）。

# ruby-on-rails - Rails 中可重复的自定义计划

> ID：10022393
> 
> 赞同：0
> 
> 时间：2012-04-05T03:44:47.033
> 
> 标签：ruby-on-rails, ruby-on-rails-3, schedule

我正在创建一个 Rails 应用程序，允许用户设置周日到周六的可用性，包括开始时间、结束时间和位置（简单字符串）。我有一个用户对象，我不确定如何继续。我知道我可以拥有大量的 Time 对象，如下所示：

```
class User
    field :mondayStartTime, :type => Time
    field :mondayEndTime, :type => Time
    field :mondayLocation, :type => String
    field :tuesdayStartTime, :type => Time
    field :tuesdayEndTime, :type => Time
    field :tuesdayLocation, :type => String
    ...
    field :sundayEndTime, :type => Time
    field :sundayLocation, :type => String
end 
```

然而，这似乎非常低效，尽管创建另一个唯一的对象类似乎同样糟糕并且只会导致更多的代码行。有没有更简单的方法来实现周日到周六时间表的开始/结束时间？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:50:36.047

您是否考虑过为一周中的每一天创建具有 start、end 和 location 属性的对象？

或者，一个包含开始时间、结束时间和位置字段的 Jobs 对象（模型）。

这样就可以做到 has_many :jobs ，然后您可以按天缩小范围，或按特定日期选择。使用 ruby​​ Time Class 或 ActiveSupport 类（3.days.from_now 等），缩小范围应该是可行的。

```
irb(main):001:0> require 'active_support/all'
=> true
irb(main):002:0> 2.days.ago
=> 2012-04-03 08:30:31 -0700
irb(main):003:0> 2.days.from_now
=> 2012-04-07 08:33:01 -0700 
```

编辑显示活跃的支持时间类

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T03:58:36.213

乍一看，我会创建一个具有 start_at、end_at、location 和 day_of_week 属性的“可用性”模型/类（或不太容易拼写错误的东西，如“Schedule”），并让该类属于用户（和用户具有“has_many :availabilities”或“has_many :schedules”）。这似乎（再次乍一看）是最有效和最容易获取数据的方法 - 您可以使用该单独的类来更轻松地将计划/可用性组合在一起。

# qt - Ubuntu-Linux 11.10 中的 QT5-alpha 构建错误

> ID：10022398
> 
> 赞同：1
> 
> 时间：2012-04-05T03:45:13.890
> 
> 标签：qt, qtwebkit, qt5

我尝试了从 GIT 构建最新 QT5-Alpha（http://qt-project.org/wiki/Qt-5-Alpha [http://qt-project.org/wiki/Building_Qt_5_from_Git](http://qt-project.org/wiki/Building_Qt_5_from_Git)）的说明，但在 Wayland 中面临编译文件

Ubuntu Linux 11.10

```
__make[4]: Entering directory `/home/xyz/build/newqt5/qt5/qtwayland/src/plugins/platforms/wayland'
g++ -c -pipe -g -fvisibility=hidden -fvisibility-inlines-hidden -D_REENTRANT -Wall -W -fPIC -DQT_NO_LIBUDEV -DQ_PLATFORM_WAYLAND -DQT_NO_WAYLAND_XKB -DQT_WAYLAND_GL_SUPPORT -DQT_WAYLAND_WINDOWMANAGER_SUPPORT -DQ_FONTCONFIGDATABASE -DQT_COMPILES_IN_HARFBUZZ -DQT_PLUGIN -DQT_GUI_LIB -DQT_CORE_LIB -I/home/xyz/build/newqt5/qt5/qtbase/mkspecs/linux-g++ -I. -I/home/xyz/build/newqt5/qt5/qtbase/include/QtCore/5.0.0 -I/home/xyz/build/newqt5/qt5/qtbase/include/QtCore/5.0.0/QtCore -I/home/xyz/build/newqt5/qt5/qtbase/include/QtCore -I/home/xyz/build/newqt5/qt5/qtbase/include/QtGui/5.0.0 -I/home/xyz/build/newqt5/qt5/qtbase/include/QtGui/5.0.0/QtGui -I/home/xyz/build/newqt5/qt5/qtbase/include/QtGui -I/home/xyz/build/newqt5/qt5/qtbase/include/QtPlatformSupport/5.0.0 -I/home/xyz/build/newqt5/qt5/qtbase/include/QtPlatformSupport/5.0.0/QtPlatformSupport -I/home/xyz/build/newqt5/qt5/qtbase/include/QtPlatformSupport -I/home/xyz/build/newqt5/qt5/qtbase/include -I../../../shared -Igl_integration/xcomposite_share -I.moc/debug-shared -o .obj/debug-shared/qwaylandintegration.o qwaylandintegration.cpp 
```

> **在 qwaylandshmwindow.h:45:0 包含的文件中，来自 qwaylandintegration.cpp:46: qwaylandwindow.h:112:18: 错误：'wl_callback_listener' 没有命名类型**

```
make[4]: *** [.obj/debug-shared/qwaylandintegration.o] Error 1_ 
```

有什么办法可以克服这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:11:16.290

在此处下载 alpha 源包：[http](http://releases.qt-project.org/qt5.0/alpha/) ://releases.qt-project.org/qt5.0/alpha/并使用 README 文件中的步骤。

git 中的 master 不是作为 alpha 发布的。构建脚本不同。您必须等待他们添加 alpha 标签才能从 git 中提取它。但是为什么不直接抓取 gz 文件呢？

# python - 在 python 中重载 += 用于映射类型

> ID：10022405
> 
> 赞同：2
> 
> 时间：2012-04-05T03:46:09.567
> 
> 标签：python, dictionary, operator-overloading

我想使用 += 符号来更新 Python 中的类似 dict 的对象。我希望具有与 dict.update 方法相同的行为。这是我的课程（带有“。”访问权限的字典）：

```
class sdict(dict):
    def __getattr__(self, attr):
        return self.get(attr, None)
    __setattr__= dict.__setitem__
    __delattr__= dict.__delitem__ 
```

我试过：

```
__iadd__ = dict.update 
```

和：

```
def __iadd__(self, other):
    self.update(other)
    return self 
```

但这些都不起作用。（第一个破坏了原来的字典，第二个产生了 SyntaxError）

更新：
第二个定义确实有效。它对我不起作用，因为我忘记了`def`。第一个不起作用，因为 dict.update 返回 None。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-05T03:50:05.813

我认为你所缺少的只是一个定义：

```
class sdict(dict):
    def __getattr__(self, attr):
        return self.get(attr, None)
    __setattr__= dict.__setitem__
    __delattr__= dict.__delitem__
    def __iadd__(self, other):
        self.update(other)
        return self

>>> a = sdict()
>>> a.b = 3
>>> a
{'b': 3}
>>> a.b
3
>>> a['b']
3
>>> a += {'fred': 3}
>>> a
{'b': 3, 'fred': 3} 
```

# scala - scala中的一切都是函数、表达式或对象吗？

> ID：10022408
> 
> 赞同：8
> 
> 时间：2012-04-05T03:46:38.717
> 
> 标签：scala

我很困惑。

我认为一切都是表达式，因为语句返回一个值。但我也听说在 scala 中一切都是对象。

现实中是什么？为什么 scala 选择以一种方式或另一种方式来做呢？这对 Scala 开发人员意味着什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-05T03:56:40.060

> 我认为一切都是表达式，因为语句返回一个值。

有些东西没有价值，但在大多数情况下，这是正确的。这意味着我们基本上可以放弃 Scala 中“语句”和“表达式”之间的区别。

然而，术语“返回一个值”不太合适。我们说一切都“评估”为一个价值。

> 但我也听说在 scala 中一切都是对象。

这根本不与前面的陈述相矛盾:) 它只是意味着每个可能的*值*都是一个对象（因此每个表达式都计算为一个对象）。顺便说一句，函数作为 Scala 中的一等公民，也是对象。

> 为什么 scala 选择以一种方式或另一种方式来做呢？

需要注意的是，这实际上是 Java 方式的概括，其中语句和表达式是不同的事物，并非所有事物都是对象。您可以将每段 Java 代码翻译成 Scala 而不需要进行大量调整，但反过来就*不行*。所以这个设计决策使得Scala实际上在简洁性和表达性方面**更加强大**。

> 这对 Scala 开发人员意味着什么？

例如，这意味着：

*   您通常不需要`return`，因为您可以将返回值作为方法中的最后一个表达式
*   `if`您可以利用and是表达式的事实`case`来使您的代码更短

一个例子是：

```
def mymethod(x: Int) = if (x > 2) "yay!" else "too low!"

// ...
println(mymethod(10))  // => prints "yay!"
println(mymethod(0))   // => prints "too low!" 
```

我们还可以将这样一个复合表达式的值赋给一个变量：

```
val str = value match {
            case Some(x) => "Result: " + x
            case None    => "Error!"
          } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-05T13:34:22.240

The distinction here is that the assertion *"everything is a expression"* is being made about blocks of code, whereas *"everything is an object"* is being made about the values in your program.

* * *

## Blocks of Code

In the Java language, there are both *expressions* and *statements*. That is, any "block" of code is *either* an expression *or* a statement;

```
//the if-else-block is a statement whilst (x == 4) is an expression
if (x == 4) {
    foo();
}
else {
    bar();
} 
```

Expressions have a *type*; statements do not; statements are invoked **purely for their side-effects**.

In scala, *every block of code is an expression*; that is, it has a type:

```
if (x == 4) foo else bar //has the type lub of foo and bar 
```

This is extremely important! I cannot stress this enough; it's one of the things which makes scala a pleasure to work with because I can assign a value to an expression.

```
val x = if (x == 4) foo else bar 
```

## Values

By value, I mean something that we might reference in the program:

```
int i = foo(); //i is a reference to a value
java.util.TimeUnit.SECONDS; 
```

In Java, the `i` above is not an object - it is a primitive. Furthermore I can access the field `SECONDS` of `TimeUnit`, but `TimeUnit` is not an object either; it is a *static* (for want of a better phrase). In scala:

```
val j = 4
Map.empty 
```

As far as the *language* is concerned, `j` is an object (and I may dispatch methods to it), as is `Map` - the module (or companion object) for the type `scala.collection.immutable.Map`.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-05T13:57:36.173

> scala中的一切都是函数、表达式或对象吗？

没有。

有些东西不是对象。例如类、方法。

有些东西不是表达。eg`class Foo { }`是一个语句，不计算任何值。（这与上面的基本相同。）

有些东西不是函数。我不需要为此提及任何示例，因为在任何 Scala 代码中都会看到很多。

换句话说，“一切都是 X”只不过是一种推销（在 Scala 的情况下）。

# ninject - Ninject 使用构造函数注入手动初始化

> ID：10022414
> 
> 赞同：0
> 
> 时间：2012-04-05T03:47:24.760
> 
> 标签：ninject

手动初始化类时如何进行构造函数注入？

```
public class ApiKeyHandler : DelegatingHandler
{
    private IApiService apiService;

    public ApiKeyHandler(IApiService apiService)
    {
        this.apiService = apiService;
    }
} 
```

初始化：

```
var apiKey = new ApiKeyHandler(/*inject here */); 
```

我该如何做到这一点？我的绑定和一切都已经设置好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:51:31.863

你想做这样的事情：

```
var apiKey = new ApiKeyHandler(kernel.Get<IApiService>()); 
```

但是，为什么不注入`ApiKeyHandler`自身呢？

```
var apiKey = kernel.Get<ApiKeyHandler>(); 
```

[这是一篇关于 Ninject 的文章](http://stefanoricciardi.com/2011/01/21/ninject-mini-tutorial-part-1/)：

您基本上想在代码的开头设置它并使其在全球范围内可用：

```
public IKernel kernel  = new StandardKernel(); 
```

...

```
kernel.Bind<IApiService>()
      .To<SomeConcreteApiService>(); 
```

# java - 使用 Gson 序列化 JSON 时包装某些值

> ID：10022420
> 
> 赞同：1
> 
> 时间：2012-04-05T03:48:11.773
> 
> 标签：java, json, gson

使用 GSON 将对象模型序列化为 JSON 时，如何包装某些值？示例模型：

```
class Order {
  Customer cust;
}

class Customer {
  String name;
  int age;
} 
```

序列化客户通常会产生如下内容：

```
{cust:{name:joe, age:21}} 
```

我想做的是将 Order 和 Customer 值包装在具有类名的附加元素中。所以预期的 JSON 将是：

```
{Order:{cust:Customer:{name:joe, age:21}}} 
```

我将要序列化的实际类可以是任何东西，所以我不能在序列化程序中硬编码特定属性。但我想用它们的类名包装某些属性。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T11:05:51.123

虽然这不是一个有效的 json 字符串：

```
{Order:{cust:Customer:{name:joe, age:21}}} 
```

在您的应用程序中，您必须正确建模/实现您的域类，然后才能将其用于序列化/反序列化 json 字符串，换句话说，在调用 toJson/fromJson 方法之前应该知道域类。然而，实际的域类类型可以在运行时动态确定，通过使用 Java Generic Type。

查看Gson 用户指南中的[序列化和反序列化通用类型部分：](https://sites.google.com/site/gson/gson-user-guide#TOC-Serializing-and-Deserializing-Gener)

```
public class Foo<T> {
  public T value;
} 
```

序列化它：

```
Gson gson = new Gson();
Type fooType = new TypeToken<Foo<Bar>>() {}.getType();
gson.toJson(foo, fooType); 
```

要反序列化它：

```
Gson gson = new Gson();
Type fooType = new TypeToken<Foo<Bar>>() {}.getType();
gson.fromJson(json, fooType); 
```

# bash - 如何从文件名中获取字符串并将其用作参数

> ID：10022422
> 
> 赞同：3
> 
> 时间：2012-04-05T03:48:26.830
> 
> 标签：bash, shell

如果文件名是这种格式

```
assignment_number_username_filename.extension 
```

前任。

```
assignment_01_ssaha_homework1.txt 
```

我只需要提取用户名以在脚本的其余部分中使用它。

我如何只使用用户名并将其用作参数。

这接近我正在寻找的但不完全是：

[从文件名中提取字符串](https://stackoverflow.com/questions/1999682/extracting-a-string-from-a-file-name)

如果有人可以解释 sed 在这种情况下的工作原理，那将同样有帮助！

这是我到目前为止所拥有的；我有一段时间没有使用`cut`了，所以在尝试刷新自己时收到错误消息。

```
 #!/bin/sh 
 a = $1
 grep $a /home | cut -c 1,2,4,5 echo $a` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:13:46.347

您可能需要命令替换，加上`echo`plus `sed`。您需要知道`sed`正则表达式可以记住匹配的部分。你需要知道基本的正则表达式。在上下文中，这加起来是：

```
filename="assignment_01_ssaha_homework1.txt"

username=$(echo "$file" | sed 's/^[^_]*_[^_]*_\([^_]*\)_[^.]*\.[^.]*$/\1/') 
```

表示法`$(...)`是命令替换。括号之间的命令运行，输出被捕获为字符串。在这种情况下，字符串被分配给变量`username`。

在该命令中，整个命令对输入的每一行（此处为一行）`sed`应用特定的替换 ( ) 操作。`s/match/replace/`正则表达式的`[^_]*`组件匹配一系列（零个或多个）非下划线。该`\(...\)`部分会记住封闭的正则表达式（第三个非下划线序列，即用户名）。最后的切换`[^.]*`识别分隔符从下划线到点的变化。替换文本`\1`用模式的记住部分替换整个名称。通常，您可以记住该模式的几个小节。如果文件名与模式不匹配，您将获得输入作为输出。

在`bash`中，有一些方法可以避免`echo`; 您可能可以使用一些更深奥的（意思是“在其他 shell 中不可用”）机制来提取数据。这将适用于大多数现代 POSIX 派生的 shell（Korn、Bash 等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T05:54:26.477

```
filename="assignment_01_ssaha_homework1.txt"

username=$(echo "$file" | awk -F_ '{print $3}') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T14:54:57.800

猛击：

```
filename="assignment_01_ssaha_homework1.txt"
tmp=${filename%_*}
username=${tmp##*_} 
```

[http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion)

# php - 我得到一个空白值和未定义的索引

> ID：10022424
> 
> 赞同：0
> 
> 时间：2012-04-05T03:49:23.193
> 
> 标签：php, javascript, html

我在下面有一个代码，它通过查看在“ImageFile []”中输入的内容来查找 ImageId，然后我使用 INSERT VALUES 插入值（目前我正在使用 echo $questionsql）。但问题是当我回显它时该值是空白的。我也收到了 imageFile [] 的未定义索引通知。$插入问题 = 数组（）；

```
 $imagequery = "SELECT ImageId FROM Image WHERE (ImageFile = '". mysql_real_escape_string($_POST['imageFile'])."')";
    $imagers = mysql_query($imagequery);
    $imagerecord = mysql_fetch_array($imagers);
    $imageid = $imagerecord['ImageId']; 

        $insertquestion[] = "'".
                    mysql_real_escape_string( $imageid ) ."'";

 $questionsql = "INSERT INTO Question (ImageId) 
    VALUES (" . implode('), (', $insertquestion) . ")";

    echo($questionsql); 
```

我认为它与“imageFile []”的空白值相呼应的原因以及为什么它声明“imageFile []”未定义是因为在`<form>`下面没有imageFile []。imageFile[] 位于 javascript 代码中，并附加到表单表中。

所以我想知道的是我怎样才能得到它，这样我就可以得到一个隐藏的输入，它与附加的 ImageFile'[]' 匹配到表单代码中，这样当我在 php 代码所在的下一页中发布 imageFile[] 时，我没有得到未定义的索引，也不会得到 'imageFile[] 的空白值？

下面是javascript和表单代码：

```
<script>

    function insertQuestion(form) {   

    var $tbody = $('#qandatbl > tbody'); 
    var $tr = $("<tr class='optionAndAnswer' align='center'></tr>");
    var $image = $("<td class='image'></td>");

    var $imagefile = $('<input />')
        .attr({
            type: 'file',
            name: 'imageFile[]',
            class: 'imageFile'
    });

    $tr.append($qid); 
    $tr.append($image);   
    $tbody.append($tr); 

    }

</script>

<form id="QandA" action="insertQuestion.php" method="post" >

<table id="qandatbl" align="center">
<thead>
<tr>
    <th class="image">Image</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:55:20.937

当您对 post 字段使用 PHP 数组语法时，`[]`不会出现在 $_POST 数组中。对于您在表单中命名的每个字段，语法将是`$_POST['imageFile'][0]`, `$_POST['imageFile'][1]`, etc...。`imageFile[]`

同样，我怀疑您的 implode() 稍后会产生无效的 SQL。它将进行查询：

```
INSERT INTO Question (ImageId)
VALUES ('value1''),(''value2''),etc... 
```

您已经在前一行中用引号将值括起来，然后添加更多引号作为内爆的一部分，因此您最终会在查询字符串中得到一些不平衡的引号。

# r - do.call 结合“::”

> ID：10022436
> 
> 赞同：20
> 
> 时间：2012-04-05T03:51:03.900
> 
> 标签：r

我大量使用“do.call”来生成函数调用。例如：

```
myfun <- "rnorm";
myargs <- list(n=10, mean=5);
do.call(myfun, myargs); 
```

但是，有时我想从某个包中显式调用一个函数。类似于例如`stats::rnorm(n=10, mean=5)`。有什么方法可以使用 do.call，或者创建一个行为类似于 do.call 的函数来使其工作：

```
myfun <- "stats::rnorm";
myargs <- list(n=10, mean=5);
do.call(myfun, myargs); 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-05T03:58:25.347

没有名为“stats::rnorm”的函数。您必须`rnorm`在“stats”命名空间中找到该函数：

```
myfun <- get("rnorm", asNamespace("stats"))
myargs <- list(n=10, mean=5);
do.call(myfun, myargs); 
```

现在，您当然也可以使用“stats::rnorm”之类的名称并将其拆分为命名空间部分和函数名称：

```
funname <- "stats::rnorm"
fn <- strsplit(funname, "::")[[1]]
myfun <- if (length(fn)==1) fn[[1]] else get(fn[[2]], asNamespace(fn[[1]]))
myargs <- list(n=10, mean=5);
do.call(myfun, myargs); 
```

**更新**我只是想表明这种方法比@Jeroen 的方法快 2.5 倍......

```
do.call.tommy <- function(what, args, ...) {
  if(is.character(what)){
    fn <- strsplit(what, "::")[[1]]
    what <- if(length(fn)==1) {
        get(fn[[1]], envir=parent.frame(), mode="function")
    } else {
        get(fn[[2]], envir=asNamespace(fn[[1]]), mode="function")
    }
  }

  do.call(what, as.list(args), ...)
}

# Test it
do.call.tommy(runif, 10)
f1 <- function(FUN) do.call.tommy(FUN, list(5))
f2 <- function() { myfun<-function(x) x; do.call.tommy(myfun, list(5)) }
f1(runif)
f1("stats::runif")
f2()

# Test the performance...    
system.time(for(i in 1:1e4) do.call.jeroen("stats::runif", list(n=1, max=50))) # 1.07 secs
system.time(for(i in 1:1e4) do.call.tommy("stats::runif", list(n=1, max=50)))  # 0.42 secs 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-05T04:02:30.843

您可以删除引号：这将是函数本身，而不是它的名称。

```
myfun <- stats::rnorm
myargs <- list(n=10, mean=5)
do.call(myfun, myargs) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T23:36:53.473

感谢您的回复。我想我会这样做：

```
do.call.jeroen <- function(what, args, ...){
  if(is.function(what)){
    what <- deparse(as.list(match.call())$what);
  }
  myfuncall <- parse(text=what)[[1]];
  mycall <- as.call(c(list(myfuncall), args));
  eval(mycall, ...);
} 
```

这似乎是一个很好的概括，`do.call`因此我仍然可以为参数传递一个字符串`what`，但它巧妙地模拟了一个`stats::rnorm(n=10, mean=5)`调用。

```
myfun1 <- "rnorm";
myfun2 <- "stats::rnorm";
myargs <- list(n=10, mean=5);
do.call.jeroen(myfun1, myargs);
do.call.jeroen(myfun2, myargs);
do.call.jeroen(rnorm, myargs);
do.call.jeroen(stats::rnorm, myargs); 
```

这样做的好处是，如果我正在调用的函数使用 match.call() 将调用存储在某处，它将保留实际的函数名称。例如：

> do.call.jeroen("stats::glm", list(formula=speed~dist, data=as.name('cars')))

```
Call:  stats::glm(formula = speed ~ dist, data = cars)

Coefficients:
(Intercept)         dist  
     8.2839       0.1656  

Degrees of Freedom: 49 Total (i.e. Null);  48 Residual
Null Deviance:      1370 
Residual Deviance: 478  AIC: 260.8 
```

# javascript - AppleScript 到 Javascript

> ID：10022437
> 
> 赞同：4
> 
> 时间：2012-04-05T03:51:30.360
> 
> 标签：javascript, macos, applescript, finder

Javascript中下面的等效代码是什么？这个苹果脚本可以转换成java脚本吗？

```
tell application "Finder"
    activate
    set position of Finder window 1 to {607, 276}
    close Finder window 1
end tell 
```

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-01-15T12:07:42.863

自 OS X Yosemite 发布以来，[JavaScript 可用于自动化](https://developer.apple.com/library/mac/releasenotes/InterapplicationCommunication/RN-JavaScriptForAutomation/)。

相当于您的代码将是：

```
var finder = Application('Finder');

finder.activate();
finder.windows[0].position = {x: 607, y: 276};
finder.windows[0].close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-22T19:37:34.460

您可以使用节点 js 模块：[https ://github.com/TooTallNate/node-applescript](https://github.com/TooTallNate/node-applescript)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-06-25T22:54:21.860

目前（2013 年），没有可用于 Mac OS X 的 JavaScript 界面，可以控制 GUI 元素。我知道的唯一一个 OSX 的 JS 实现 LatenightSW，十年来没有更新。这意味着你想要的现在用 JavaScript 是不可能的。

# python - 为什么我的 Python 继承/超级示例不起作用？

> ID：10022438
> 
> 赞同：3
> 
> 时间：2012-04-05T03:51:31.477
> 
> 标签：python, inheritance, super

为什么以下不起作用：

```
class CTest(tuple):
    def __init__(self,arg):
        if type(arg) is tuple:
            super(CTest,self).__init__((2,2))
        else:
            super(CTest,self).__init__(arg)
a=CTest((1,1))
print a 
```

输出是 (1,1)，而我希望看到 (2,2)。

另外，为什么我会收到该对象的弃用警告。**init** () 不带参数？我应该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T04:16:39.303

元组是不可变的，你必须重写`__new__`：

```
class CTest(tuple):
    def __new__(cls, arg):
        if type(arg) is tuple:
            return super(CTest, cls).__new__(cls, (2, 2))
        else:
            return super(CTest, cls).__new__(cls, arg) 
```

现在这可以按预期工作：

```
a = CTest((1,1))
print a
> (2, 2) 
```

请查看这篇[文章](https://stackoverflow.com/q/1565374/201359)以获取更多详细信息。

# java - 如何将一个 ArrayList 的内容移动到另一个？

> ID：10022441
> 
> 赞同：4
> 
> 时间：2012-04-05T03:52:18.120
> 
> 标签：java, collections, arraylist

有没有办法在 O(1) 中将 ArrayList 的全部内容移动到另一个 ArrayList 实例？

即：只有对支持数组的引用从一个实例传递到另一个实例（元素不会一个一个地复制）。

例如：

```
ArrayList<String> a = new ArrayList<>(Arrays.asList("A", "B", "C"));
ArrayList<String> b = new ArrayList<>();
a.moveContentsTo(b);
// 'a' is now empty, while 'b' contains everything that 'a' did before and 'a != b'
// It is desired that the 'moveContentsTo' method is O(1) 
```

更好的是，有`ArrayList#swapContents(ArrayList)`什么方法吗？

* * *

**进一步的解释和用例**：

*进一步解释*1：'a'和'b'的引用不能互换。我不是在寻找`tmp = a; a = b; b = tmp;`解决方案的类型。

*进一步解释*2：运算必须及时~O(1)。

*用例*：当对象想要封装外部构造的列表时，这很有用：

```
public class A {
    private ArrayList<String> items = new ArrayList<>();

    /**
     * This method takes the sole ownership of the contents. Whoever
     * passed the list from the outside will not be able to modify
     * contents of 'this.items' from outside the class.
     */ 
    public AnImmutableObject(ArrayList<String> items) {
        if (items != null) {
            items.moveContentsTo(this.items);
        }
    }

    /**
     * Other collections that do not provide the 'move' functionality
     * must be copied. If we just stored the reference to 'items' we
     * would break encapsulation as whoever called the constructor
     * still have write capabilities to the collection.
     */ 
    public A(Collection<String> items) {
        if (items != null) {
            this.items.addAll(items);
        }
    }

    public List<String> getItems() {
        return Collections.unmodifiableList(items);
    }
} 
```

请注意，我们希望避免进行复制（以提高速度并减少内存使用）。关键是被调用者必须失去修改（现在封装的）的能力`ArrayList`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:55:18.283

AFAIK，跟踪引用的“所有权”（至少在程序员方面）非常不像 Java，这就是为什么我怀疑你会找到`std::move()`你想要的类似功能的原因。它在 Java 中并不是很常用。我猜 C++ 需要明确地跟踪对象所有权，因为没有垃圾收集。

我认为你最好的选择是在你的构造函数中创建一个防御性副本并通过依赖不可变对象的复制构造函数来节省空间：

```
public class AnImmutableObject {

    private final List<String> items;

    /**
     * Creates a new immutable object with the given list of items.
     * Always deep copy from an outside source, because we can't know if the
     * calling code will modify that collection later.
     */ 
    public AnImmutableObject(Collection<String> items) {
        // It's a constructor. We know items needs to be set.
        // We are creating a new array list, using its constructor which deep
        // copies the collection, and immediately wrapping it to make it truly
        // immutable. We are guaranteed that no one will hold a reference to the
        // mutable view of the new ArrayList.
        this.items = Collections.unmodifiableList(new ArrayList<String>(items));
    }

    /**
     * Creates a new immutable object with the same items as another.
     * Copying the reference here is completely safe because we
     * enforce the immutability of the items array.
     */ 
    public AnImmutableObject(AnImmutableObject source) {
        items = source.items;
    }

    public List<String> getItems() {
        return items;
    }
} 
```

此时，您可以在自己的不可变对象之间在 O(1) 中“传递数组”（真正共享它们）：

```
ImmutableObject a = new ImmutableObject(Arrays.asList("A", "B", "C")); // O(n)
ImmutableObject b = new ImmutableObject(a); // O(1) 
```

希望这样的事情可以满足您的目的。

您可以采用的另一条路线是使用[Guava](http://code.google.com/p/guava-libraries/)的[ImmutableList](http://guava-libraries.googlecode.com/svn/tags/release09/javadoc/com/google/common/collect/ImmutableList.html)。由于这些是不可变的，您可以安全地将引用复制到`ImmutableList`构造函数中。

主要方法是让您可以安全地复制对列表的引用，而不是获得对它们的所有权。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T04:08:23.797

@Lirik 的答案是 +1。但是，如果您正在寻找一个真正的`ArrayList#swapContents(ArrayList)`，您可以这样做：

```
public static void swapContents(ArrayList<String> listA, ArrayList<String> listB)
{
    List<String> temp = new ArrayList<String>(listA);
    listA.clear();
    listA.addAll(listB);
    listB.clear();
    listB.addAll(temp);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T03:56:30.357

这应该这样做：

```
ArrayList<String> a = new ArrayList<>(Arrays.asList("A", "B", "C"));
ArrayList<String> b = a;
a = new ArrayList<>(); 
```

从概念上讲，`a`现在是空的，`b`包含`a`之前包含的内容。有一个单一的任务，没有数据复制，这大约是你能做到的最快的。这是否满足您的要求，或者您是否真的想`a`引用同一个数组，除了给定的数组现在应该是空的？

## 更新

~~我不相信在 C++ 中移动操作的时间复杂度也是 O(1)。~~还要谨慎指出“因为 Java 中的类使用引用语义，所以这些语言中从来没有任何对象的隐式副本。**移动语义解决的问题在 Java 中不存在也不存在。** ”（参见 FredOverflow 的回答：[C++ 右值引用和移动语义](https://stackoverflow.com/questions/9498381/c-rvalue-references-and-move-semantics?answertab=votes#tab-top)）

> 有没有办法将 ArrayList 的全部内容移动到另一个 ArrayList 以便只有对支持数组的引用从一个传递到另一个（即，这样元素就不会一个一个地复制）。

鉴于上面的语句，那么如果你在 Java 中从一个数组复制`a`到另一个数组，两个数组将引用相同的数据。`b`您在 C++ 中使用移动语义所做的所有事情就是保存需要创建的临时对象以制作这样的副本：

```
X foo();
X x;
// perhaps use x in various ways
x = foo(); 
```

最后一个是：

```
destructs the resource held by x,
clones the resource from the temporary returned by foo,
destructs the temporary and thereby releases its resource. 
```

移动语义可以：

```
swap resource pointers (handles) between x and the temporary,
temporary's destructor destruct x's original resource. 
```

你保存了一个destruct，但只在C++中......上面的问题在Java中不存在！有关移动语义的更多详细信息，请参阅本文：http: [//thbecker.net/articles/rvalue_references/section_02.html](http://thbecker.net/articles/rvalue_references/section_02.html)

# c# - 创建一个随机（甘特图）图表

> ID：10022442
> 
> 赞同：0
> 
> 时间：2012-04-05T03:52:28.360
> 
> 标签：c#, algorithm

我正在尝试为我的一个音频程序编写测试，但我无法将我的大脑包裹在这个测试设置中。首先，我有一个需要填充的 60 行 x 10000 列的表。每个单元格都有一个值 ON、OFF 或 LEFT（这意味着我的值与我左边最近的 ON/OFF 相同）。我希望在任何给定时间随机打开 20 到 40 行。每个都必须打开随机 6 到 200 个单元格。设置 ON 或 OFF 的命令必须按行然后按列排序。我正在描绘一个带有坐标键和开/关值的稀疏字典。我不明白的是如何存储我的开/关单元格，以便我可以轻松确定当前行是开还是关。帮助？谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T14:48:36.367

经过进一步思考，我意识到我可以分两次完成。这就是我最终的结果。随意评论这种方法：

```
 var table = new byte[60, 10000];
        for(int i = 0; i < 60; i++)
        {
            // we want at least half the row to be blank
            int j = 0;
            while(j < 10000)
            {
                var width = rand.Next(7, 200);
                j += width * 2;
                var vol = (byte)rand.Next(50, 125);
                for(int k = j - width; k < Math.Min(10000, j); k++)
                    table[i, k] = vol;
            }
        }

        var midiEvents = new List<BASS_MIDI_EVENT>();
        midiEvents.Add(new BASS_MIDI_EVENT(BASSMIDIEvent.MIDI_EVENT_PROGRAM, 0, 0, 0, 0));

        for(int j = 0; j < 10000; j++)
        {
            for(int i = 0; i < 60; i++)
            {
                var cur = (int)table[i, j];
                var left = j > 0 ? table[i, j - 1] : 0;
                if(cur > 0 && left == 0)
                {
                    cur <<= 8;
                    cur |= i + 33;
                    midiEvents.Add(new BASS_MIDI_EVENT(BASSMIDIEvent.MIDI_EVENT_NOTE, cur, 0, j, 0));
                }
                else if(cur == 0 && left > 0)
                {
                    midiEvents.Add(new BASS_MIDI_EVENT(BASSMIDIEvent.MIDI_EVENT_NOTE, i + 33, 0, j, 0));
                }
            }
        } 
```

# algorithm - 牛顿拉夫森的初步猜测

> ID：10022447
> 
> 赞同：2
> 
> 时间：2012-04-05T03:53:06.100
> 
> 标签：algorithm, math, newtons-method

如何`Ax+Bsin(x)=C`根据 A,B 和 C 确定方程的初始猜测？我正在尝试使用 Newton Raphson 解决它。A、B 和 C 将在运行时给出。

为此目的，还有其他方法比牛顿拉夫森更有效吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T04:08:41.967

最佳初始猜测是根本身，因此找到“最佳”猜测并不是真正有效的。

任何猜测最终都会给你一个有效的解决方案，只要`f'(x0) != 0`对于任何步骤，它只出现在 的零点`cos(x)`，`k*pi + pi/2`对于任何整数`k`。

我会尝试`x0 = C * pi`，只是看看它是否有效。

但是，您最大的问题是函数的周期性。牛顿的方法对于您的功能来说会很慢（如果它甚至有效），因为`sin(x)`会`x0`一遍又一遍地来回移动。

* * *

**预防：**

![](../Images/e1af8fcbf9645607ee175d56295bd3bf.png)

在牛顿的方法中，你注意到`f'(xn)`分母是多少吗？无限次`f'(x)`接近。`0`如果你的`f'(x) = 0.0001`（或任何接近零的地方，有可能发生），你`xn+1`会被扔得离`xn`.

更糟糕的是，由于`f'(x)`是周期性函数，这可能会一遍又一遍地发生，这意味着牛顿方法甚至可能永远不会收敛于任意`x0`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T04:14:54.147

最简单的“好”近似是假设 sin(x) 近似为零，因此设置：

```
x0 = C/A 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-03T15:36:07.873

好吧，如果 A、B 和 C 是实数且不为 0，则`(B+C)/A`是最高根的上引号和`(C-B)/A`最低根的下引号，如`-1 <= sin(x) <= 1`。你可以从这些开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-21T19:16:25.527

牛顿法适用于任何猜测。问题很简单，如果有一个方程，我猜 x0=100，它的最佳接近解是 x0=2，我知道答案是 2.34*，通过使用世界上的任何猜测，你最终会得到 2.34*方法说选择一个猜测，因为如果没有一个有效的猜测，它将需要许多令人不舒服的解决方案，没有人愿意重复该方法 20 次，猜测解决方案并不难，你只需找到一个临界点 - 例如，3 也是big and 2 太小了，所以答案在 2 和 3 之间，但是如果你猜 2 你猜 50 你仍然会得到正确的解决方案。

# php - 需要将文件名解析为cli

> ID：10022448
> 
> 赞同：0
> 
> 时间：2012-04-05T03:53:17.363
> 
> 标签：php, filesystems

我有一个 php 脚本，我需要在其中创建一个包含文件名数组的 zip 存档

所以我通过 php 运行 zip；使用 shell_exec()。

当涉及到具有以下名称的文件时，我遇到了一个问题

/var/www/某人的文件 (3)

因为我的 zip 命令看起来像

```
shell_exec("zip -r -j myzip.zip /var/www/someone's file (3)"); 
```

现在我需要一种方法来解析文件名，所以它看起来像

/var/www/someone\'s\ file\ (3)

非常感谢您对此的任何帮助，是否有任何功能可以直接执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T03:56:11.957

你正在寻找[`escapeshellarg()`](http://www.php.net/manual/en/function.escapeshellarg.php).

# sencha-touch - Sencha 面板对象

> ID：10022451
> 
> 赞同：0
> 
> 时间：2012-04-05T03:53:44.733
> 
> 标签：sencha-touch, extjs, sencha-touch-2

伙计们，我有两个问题：

1.  如何创建煎茶面板对象？
2.  如何隐藏和显示面板？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:44:03.110

在 Sencha Touch 2 中创建面板非常简单：

```
var myPanel = Ext.create('Ext.Panel', {
    html: 'my panel'
}); 
```

或者如果您只想定义扩展 Ext.Panel 的类：

```
Ext.define('myPanel',{
    extend: 'Ext.Panel'
}); 
```

要显示和隐藏您的面板，请设置对它的引用并分别使用`show()`或`hide()`方法

# facebook - 如何在不为其创建公共页面的情况下测试 Facebook 页面选项卡应用程序？

> ID：10022452
> 
> 赞同：7
> 
> 时间：2012-04-05T03:53:52.317
> 
> 标签：facebook

我正在开发一个 FB 页面选项卡应用程序，我想为我的客户提供一个用于测试应用程序的 URL。我没有专门针对这个应用程序的页面，我也不想创建一个 - 应用程序的测试版本应该保持私有。以这种方式私下测试页面标签应用程序的正常过程是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-05T04:00:15.637

尝试这个：

转到您的应用程序：developers.facebook.com/apps 打开您的应用程序，在左侧有一个名为高级（设置->高级）的部分，只需单击它，您会发现创建一个 facebook 页面选项，您可以创建一个facebook页面，创建后，您可以设置发布或取消发布。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T08:09:57.040

您必须`Sandbox Mode`在应用程序设置中启用。
如果您想让其他用户访问该应用程序，您需要在`Roles`设置中将他们添加为开发人员或测试人员。

# android - 在网格视图中显示空白项

> ID：10022456
> 
> 赞同：3
> 
> 时间：2012-04-05T03:54:40.450
> 
> 标签：android, gridview

在应用程序的主屏幕上，如何显示类似于 android 菜单但不需要在特定单元格中显示项目的菜单。考虑到 3 x 3 的网格，只需在 (Row, Col) 处显示五个项目：[0,1]、[1,0]、[1,1]、[1,2]、[2,1] .

我们已经尝试了 GridView 并将不需要显示的项目的可见性设置为 GONE (convertView.setVisibility(View.GONE);)。在此之后，项目不会显示在网格中，但是当用户使用上下键浏览空白项目或直接单击空白项目时，该图标会突出显示并被选中，就好像它是网格中的空白项目一样。我们希望它是空白的，它不应该响应用户事件，既没有突出显示也没有选择。

网格视图代码：

```
package org.XXX;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.graphics.BitmapFactory;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.BaseAdapter;
import android.widget.GridView;
import android.widget.ImageView;
import android.widget.TextView;
import android.widget.Toast;

public class XXXActivity extends Activity {
    GridView MyGrid;

    @Override
    public void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);
        setContentView(R.layout.maingrid);
        MyGrid = (GridView)findViewById(R.id.MyGrid);
        MyGrid.setAdapter(new ImageAdapter(this));

        MyGrid.setOnItemClickListener(new OnItemClickListener() {

            @Override
            public void onItemClick(AdapterView<?> arg0, View arg1, int position, long arg3) {
                Toast.makeText(arg0.getContext(), position + " selected", Toast.LENGTH_LONG).show();

                switch(position) {
                case 0:break;
                case 1:
                    //Browse
                    Intent newIntent = new Intent(XXXActivity.this, YYYListItemIcons.class);
                    startActivity(newIntent);
                    break;
                case 2:break;
                case 3:
                    //Saved Searches
                    newIntent = new Intent(XXXActivity.this, ZZZListItemIcons.class);
                    startActivity(newIntent);
                    break;
                case 4:
                    //Sign in
                    break;
                case 5:
                    //Reminders
                    break;
                case 6:break;
                case 7:
                    //Sign up
                    break;
                case 8:break;
                }
            }

        });

        //onSearchRequested(); //to open search by default
    }

    public class ImageAdapter extends BaseAdapter
    {
        Context MyContext;

        public ImageAdapter(Context _MyContext)
        {
            MyContext = _MyContext;
        }

        @Override
        public int getCount()
        {
            return 9;
        }

        public View getView(int position, View convertView, ViewGroup parent) {

            ViewHolder holder;
            LayoutInflater mInflater = LayoutInflater.from(MyContext);

            if (convertView == null) {
                convertView = mInflater.inflate(R.layout.grid_item, null);
                holder = new ViewHolder();
                holder.text = (TextView) convertView.findViewById(R.id.grid_item_text);
                holder.icon = (ImageView) convertView.findViewById(R.id.grid_item_image);
                convertView.setTag(holder);
            } else {
                holder = (ViewHolder) convertView.getTag();
            }

            // Bind the data efficiently with the holder.
            holder.text.setText(getTextId(position));
            holder.icon.setImageBitmap(BitmapFactory.decodeResource(MyContext.getResources(), getIconId(position)));
            if(getIconId(position) == R.drawable.nothing) {
                convertView.setVisibility(View.GONE);
            }
            return convertView;
        }

        @Override
        public Object getItem(int arg0) {
            return arg0;
        }

        @Override
        public long getItemId(int arg0) {
            return arg0;
        }

        private int getIconId(int position) {
            int iconImages[] = {
                    R.drawable.nothing,
                    R.drawable.browse,
                    R.drawable.nothing,
                    R.drawable.saved_searches,
                    R.drawable.sign_in,
                    R.drawable.reminders,
                    R.drawable.nothing,
                    R.drawable.sign_up,
                    R.drawable.nothing
            };
            return iconImages[position];
        }

        private int getTextId(int position) {
            int iconNames[] = {
                    R.string.nothing,
                    R.string.browse,
                    R.string.nothing,
                    R.string.saved_searches,
                    R.string.sign_in,
                    R.string.reminders,
                    R.string.nothing,
                    R.string.sign_up,
                    R.string.nothing
            };
            return iconNames[position];
        }

    }

    static class ViewHolder {
        TextView text;
        ImageView icon;
    }

} 
```

网格布局：

```
<GridView xmlns:android="http://schemas.android.com/apk/res/android"
   android:id="@+id/MyGrid"
   android:layout_width="wrap_content"
   android:layout_height="wrap_content"
   android:layout_gravity="center"
    android:padding="5dp"
    android:verticalSpacing="5dp"
    android:horizontalSpacing="20dp"
    android:numColumns="auto_fit"
    android:columnWidth="60dp"
    android:stretchMode="columnWidth"
    android:gravity="center">
</GridView> 
```

网格中的 PerItemIconLayout：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
   android:id="@+id/GridItem"
   android:layout_width="wrap_content"
   android:layout_height="wrap_content"
   android:orientation="vertical"
   android:gravity="center_horizontal">

   <ImageView android:id="@+id/grid_item_image"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content">
   </ImageView>

   <TextView android:id="@+id/grid_item_text"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:text="TextView"
      android:gravity="center_horizontal"
      android:textColor="#FFFFFF">
   </TextView>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:32:43.173

```
if(getIconId(position) == R.drawable.nothing) {
convertView.setVisibility(View.GONE);
} 
```

用下面替换上面的行并尝试....

```
if(getIconId(position) == R.drawable.nothing) {
   convertView.setVisibility(View.GONE);
   convertView.setClickable(false);
   convertView.setEnabled(false);
} 
```

在 getview() 中尝试此代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:51:46.193

现在您已经发布了代码，我不确定您是否可以从技术上删除，但您可以禁用您正在谈论的“突出显示”点击，这样，当用户点击其中一个图标时，它将不再强调。

这可以通过 XML 或在您的代码中完成：

```
https://stackoverflow.com/questions/2865683/android-disable-highlighting-in-gridview

Code: GridView.setSelector(new ColorDrawable(Color.TRANSPARENT));
XML: android:listSelector="#00000000" 
```

但是，这将影响 gridview 中的所有图标。

也看看这个：

[https://stackoverflow.com/questions/5514629/how-to-disable-item-click-for-particular-positions-in-grid-view-in-android](https://stackoverflow.com/questions/5514629/how-to-disable-item-click-for-particular-positions-in-grid-view-in-android)

# php - bind_param 困难

> ID：10022457
> 
> 赞同：2
> 
> 时间：2012-04-05T03:54:40.773
> 
> 标签：php, mysql, mysqli

我遇到了问题，下面的代码没有给我任何结果。但是，如果我取消注释指示的行，并注释掉 bind_param 行它可以工作，但这不是违背 mysqli 的目的吗？我的 var_dump 给我的字符串（1）“1”

```
function teams($mysqli, $league_id) {
    echo 'league id = ' . var_dump($league_id);
    $sql = "SELECT team_id, team_name FROM teams where league_id='?'";
//  $sql = "SELECT team_id, team_name FROM teams where league_id='".$league_id."'";
    $stmt = $mysqli->prepare($sql);
    $stmt->bind_param('i', $league_id);
    $stmt->execute();
    $stmt->bind_result($col1, $col2);  
    while($stmt->fetch()) {
        $results[] = array(  
            'team_id' => $col1,  
            'team_name' => $col2  
        );  
    }  
    $stmt->close();
    var_dump($results);
    return $results;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:08:18.877

函数 bool mysqli_stmt::bind_param ( 字符串 $types , 混合 &$var1 [, 混合 &$... ] )

接受以下 $types

类型规范字符

人物描述

**我对应的变量具有整数类型**

d 对应变量的类型为 double

s 对应的变量为字符串类型

b 对应的变量是一个 blob，将在数据包中发送

您将 $types 指定为 'i' 并将值作为单引号中的字符串给出。删除引号并尝试将 $league_id 转换为 int 值。

[http://php.net/manual/en/mysqli-stmt.bind-param.php](http://php.net/manual/en/mysqli-stmt.bind-param.php)

快乐编码！

# wpf - 在 WPF 中，如何从资源中加载菜单？

> ID：10022458
> 
> 赞同：0
> 
> 时间：2012-04-05T03:54:56.327
> 
> 标签：wpf, resources, menu

在提出这个问题之前，我花了很多时间浏览 StackOverflow 和 Google，但找不到任何非常有用的东西。我正在寻找有关如何从已编译的 Xaml 文件加载菜单并将其附加到菜单控件的指南。我是WPF新手，所以请多多包涵。

在我的页面中，我有以下 Xaml：

```
<Menu ItemsSource="{Binding MainMenu}">
</Menu> 
```

我的视图模型类目前看起来像这样：

```
public class MainWindowViewModel : ViewModelBase
{
    public ItemCollection MainMenu { get; set; }

    public MainWindowViewModel()
    {
        Menu m = (Menu)Application.LoadComponent(new Uri("/Assets/Menus/StartupShellMenu.xaml", UriKind.Relative));
        MainMenu = m.Items;
    }
} 
```

StartupShellMenu.xaml 文件如下所示：

```
<Menu xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <MenuItem Header="_File">
        <MenuItem Header="_Open">
            <MenuItem.Icon>
                <Image Height="16" Width="16" Source="/Assets/Icons/Open.png"/>
            </MenuItem.Icon>
        </MenuItem>
        <Separator/>
        <MenuItem Header="E_xit"/>
    </MenuItem>
</Menu> 
```

我看到的是我的菜单项出现了，但是一旦我的鼠标移出菜单（我不必单击），菜单就会消失。此外，正常的键盘功能不起作用；按 Alt+F 不显示菜单，一旦显示，向上/向下键不起作用。我尝试将 MainMenu 属性的类型更改为 ObservableCollection，但没有任何变化。有什么想法吗？我确定我错过了一些明显的愚蠢的东西，但我在搜索中找不到任何有用的东西。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:40:44.417

对我来说，这感觉就像 100% 的视图，而 ViewModel 可能不应该参与其中。

你为什么要为此使用 ViewModel？您是否真的允许在运行时更改菜单，使其成为动态菜单？

如果没有，则为 StartupShellMenu.xaml 文件中的类指定一个类名，然后加载它。

```
<Menu x:Class="StartupShellMenu"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <MenuItem Header="_File">
        <MenuItem Header="_Open">
            <MenuItem.Icon>
                <Image Height="16" Width="16" Source="/Assets/Icons/Open.png"/>
            </MenuItem.Icon>
        </MenuItem>
        <Separator/>
        <MenuItem Header="E_xit"/>
    </MenuItem>
</Menu> 
```

然后从 ViewModel 中拉出它，因为那里不需要它。

无需将 Menu 放入 XAML 并绑定到 MainMenu，只需将新的 StartupShellMenu 类直接添加到 XAML 中即可。

```
<local:StartupShellMenu ItemsSource="{Binding MainMenu}" /> 
```

如果菜单仅存在于视图中，则将所有菜单代码 100% 保留在视图中。

# jquery - FancyBox 没有出现

> ID：10022461
> 
> 赞同：0
> 
> 时间：2012-04-05T03:55:06.707
> 
> 标签：jquery, fancybox

我在设置 FancyBox 时遇到了一些麻烦，我对 jQuery 有点陌生。我按照他们的指南进行操作，但我没有看到任何可能出错的地方。

我已经链接了我需要的 .css 文件和 .js 文件。我知道它们已正确链接，因为如果我查看源代码并单击`/assets/jquery.fancybox.css?body=1`，`/assets/jquery.fancybox.css?body=1`我可以看到正确的 Javscript 和 CSS 文件。

因为我使用的是 Ruby on Rails，所以我将此行添加到我的 application.js 文件中：

```
$(document).ready(function() {
    $(".fancybox").fancybox();
}); 
```

然后只是为了测试我将它添加到我的一个页面中，但它没有出现在 FancyBox 中，它只是在新页面中打开图像：

```
<a class="fancybox" rel="group" href="http://farm8.staticflickr.com/7171/6417719753_374653e28c_b.jpg"><img src="http://farm8.staticflickr.com/7171/6417719753_374653e28c_m.jpg" alt="" />link</a> 
```

据我所知，它应该可以工作，我将类设置为“fancybox”，并且脚本正在寻找具有“fancybox”类的对象。

编辑：我似乎通过添加来修复它

```
$(document).ready(function() {
    $(".fancybox").fancybox();
}); 
```

到特定页面的 .erb 文件。如果添加到 application.js，为什么这不起作用？有没有解决这个问题的好方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:48:15.100

我猜您的`application.js`文件是在 jQuery 源代码之前加载的，因此`$`尚不可用。

在这些情况下，请务必检查您的浏览器控制台是否有错误 - 它可以为您省去很多麻烦。

# ruby-on-rails - MultiJson::DecodeError 743: 发送 json 数据以将请求 url 放入海报时出现意外令牌添加到 firefox

> ID：10022462
> 
> 赞同：0
> 
> 时间：2012-04-05T03:55:11.213
> 
> 标签：ruby-on-rails, json, httpwebrequest

我将以下 json 数据作为海报正文的参数发送

zip='{"zipcode":"501234","cityname":"hyd","countyname" : "Poweshiek","statename" : "Iowa"}'&Accept=application%2Fjson

我收到错误

'

# MultiJson::DecodeError`在此处输入代码`

```
743: 'zip='{"zipcode":"501234","cityname":"hyd","countyname" : "Poweshiek","statename" : "Iowa"}'&Accept=application%2Fjson' 处出现意外标记
```

`Rails.root: e:/rails/vivadesi`

' **下面是日志文件：** '在 2012-04-05 07:31:17 +0530 解析请求参数时发生错误，为 127.0.0.1 开始 PUT "/orgs/updatezip.json?id=4f676eb33e454911a000aea1"。内容：

MultiJson::DecodeError (743: 'zip='{"zipcode":"501234","cityname":"hyd","countyname" : "Poweshiek","statename" : "Iowa"}'&Accept=应用程序%2Fjson'):

渲染 gem/ruby/1.9.1/gems/actionpack-3.1.0/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.0ms) 渲染 gem/ruby/1.9.1/gems/actionpack-3.1.0 /lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (1.0ms) 在救援中渲染 gem/ruby/1.9.1/gems/actionpack-3.1.0/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb /布局（12.0毫秒）'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T02:46:36.870

您通过邮寄或获取发送，因为当您尝试将字符串转换为 json（格式参数）时会出现此错误。

'zip' 将是一个想要获取代码的变量。
& Accept = application% 2Fjson 可以作为 json 中的参数

示例
发送 json 用于测试

```
zip='{"zipcode":"501234","cityname":"hyd","countyname" : "Poweshiek","statename" : "Iowa"}'&Accept=application%2Fjson

{"zip":{"zipcode":"501234","cityname":"hyd","countyname" : "Poweshiek","statename" : "Iowa"},"accept":"application%2Fjson"} 
```

# android - Android WebView - 表单数据持久化

> ID：10022463
> 
> 赞同：1
> 
> 时间：2012-04-05T03:55:18.500
> 
> 标签：android, webview, oauth-2.0

我正在使用 Webview 来执行 OAuth 身份验证。在登录页面中，有一个“记住用户名”复选框，它可能将用户名保存在用户名文本字段中。

但是检查一下，并没有真正为我的 webview 保存用户名。（它总是空白）

有没有办法获得“记住用户名”？功能工作。请记住，我无权访问用户名。

如果不可能，我也想确认一下。谢谢。

**编辑**：即使在应用程序关闭后，我也需要 webview 记住用户名。下次我加载同一页面时，用户名应该在那里。似乎有一个`setSaveFormData`功能。但这似乎没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:26:11.927

可能是以下链接解决您的问题。

[使用 Save Instance State 保存 Android Activity 状态](https://stackoverflow.com/questions/151777/how-do-i-save-an-android-applications-state)

[Android WebView-记住用户名和密码](https://stackoverflow.com/questions/4270293/android-webview-remember-username-and-password)

[使 Android WebView 不存储 cookie 或密码](https://stackoverflow.com/questions/5404274/make-android-webview-not-store-cookies-or-passwords)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:37:01.623

if (savedInstanceState == null) { mwebView.loadUrl("http://abc.com"); } 其他 { mwebview.restoreState(savedInstanceState); }

在将 url 加载到 webview 时尝试使用上述行...如果上述方法不起作用，您可以覆盖 onSaveInstanceState(Bundle savedInstanceState)。

有关更多参考，请参阅此[LINK](http://developer.android.com/reference/android/app/Activity.html#onCreate%28android.os.Bundle%29)然后试试这个......

WebSettings websetting = yourwebviewinstance.getSettings(); mWebSettings.setSavePassword(true);

# ruby-on-rails - rails，将 helper 传递给 action mailer

> ID：10022477
> 
> 赞同：0
> 
> 时间：2012-04-05T03:57:07.773
> 
> 标签：ruby-on-rails, actionmailer, helper

我想知道如何使操作邮件程序可以使用帮助文件的功能？我有一个名为 UserMailer 的动作邮件程序和一个名为 sessions_helper.rb 的助手。如何使 UserMailer 可以使用这些方法？我试过“包括”，但它给出了以下错误

我试图获取的方法是“current_user”，我收到错误

```
undefined local variable or method `cookies' 
```

我正在使用 Rails 3.2.1

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T04:12:19.013

你可以像这样在你的邮件中提供帮助，

```
类通知器 < ActionMailer::Base

  add_template_helper(ApplicationHelper)

  #...

结尾

```

As far as current_user go, I don't think mailers have any concept of cookies as ActionController does. As a better design choice I'd keep my mailer independent of the current_user. Mailers are not concerned with who the current_user is ( similar to models ). For that matters, mailers are not even concerned with who the user is, they are concerned with "email, subject, and body".

So when calling mailer methods, you can pass them the user object ( it can be of the current_user or any body else ) so that they can get the email , generate the subject and the body.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T04:05:22.153

我不得不为此添加一个文件`config/initializers`：

```
class ActionMailer::Base
    helper MiscHelper
    helper ExtraMailHelper
end 
```

我想您会根据需要为其他助手添加行，例如：

```
class ActionMailer::Base
    helper MiscHelper
    helper ExtraMailHelper
    helper SessionsHelper
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T06:14:10.533

If you want to include specific helpers in specific mailers you have, you can use this.

```
class RegistrationMailer < ActionMailer::Base

  include MyOwnHelper

  def method
  end
end 
```

# php - PHP [数组键]：将“0”转换为“A”，“1”转换为“B”......（因此“89”将成为“IJ”）函数

> ID：10022481
> 
> 赞同：2
> 
> 时间：2012-04-05T03:58:31.707
> 
> 标签：php, function, array-key

假设我有一个这样的数组：

```
$array = array
("this","is","me","and","I","am","an","array","hello","beautiful","world"); 
```

**如何创建一个将 0 转换为“A”、1 转换为“B”的函数......？** *使用`Foreach`还是...？*

所以，而不是

```
 Array
(
    [0] => this
    [1] => is
    [2] => me
    [3] => and
    [4] => I
    [5] => am
    [6] => an
    [7] => array
    [8] => hello
    [9] => beautiful
    [10] => world
) 
```

我会得到

```
 Array
(
    ['A'] => this
    ['B'] => is
    ['C'] => me
    ['D'] => and
    ['E'] => I
    ['F'] => am
    ['G'] => an
    ['H'] => array
    ['I'] => hello
    ['J'] => beautiful
    ['BA'] => world
) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T04:03:08.503

```
function digits_to_letters($input) {
    return strtr($input, "0123456789", "ABCDEFGHIJ");
}

$result = array_flip(array_map("digits_to_letters", array_flip($original))); 
```

（示例运行：http: [//ideone.com/TQNYj](http://ideone.com/TQNYj)）

* * *

如果您更喜欢`foreach`+ `array_flip`，`array_map`则可以改用它：

```
$result = array();
foreach($original as $k => $v) {
    $result[strtr($k, "0123456789", "ABCDEFGHIJ")] = $v;
} 
```

# xpages - 如何过滤 xpage 上的道场网格？

> ID：10022484
> 
> 赞同：2
> 
> 时间：2012-04-05T03:58:36.157
> 
> 标签：xpages, dojox.grid

我们如何过滤从 REST 服务组件获取数据的 dojo 网格（extlib 组件）？我从 REST 服务组件正确地加载了视图中的数据。我在 xpage 上还有一个下拉列表，用户可以在其中选择一个值，该值是同一视图中某一列的 dbcolumn。我尝试将 REST 服务键值设置为 viewScope.filterCat01 （这是组合框的变量），并且我还尝试在按钮中设置过滤器（BY 是字段/列名称）但似乎没有过滤它。有任何想法吗？在我检查网格属性的按钮中，它确实有效，所以我知道网格对象是有效的 - 但过滤器似乎没有做任何事情。我也尝试过执行 grid._refresh() 以及在 REST 服务组件中设置键，但没有成功。

```
var filterValue = XSP.getElementById("#{id:comboBox2}").value;
var grid = dijit.byId("#{id:djxDataGrid1}");
grid.filter({ By: filterValue}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T15:41:56.213

This is definitely one of those things that you need to piece together a thousand cryptic clues to work it out (Domino - never!). Anyway, I had to work this one out last year. Here's an example 'search' button:

```
var searchText = dojo.byId('#{id:searchText}').value.replace(/"/g, '|"');
if (searchText) {
  var ftSearchText = '[Title] CONTAINS "' + searchText + '" OR [Description] CONTAINS "' + searchText + '" OR [URL] CONTAINS "' + searchText + '"';
  dijit.byId('#{id:grid}').filter('?search=(' + ftSearchText + ')', false);
} else {
  dojo.byId('#{id:reset}').click();
} 
```

As you can see, it's doing an ft search when a filter is applied. The key is to put "?search=" on to the beginning of the filter string.

and here's the 'reset' button example:

```
dojo.byId('#{id:searchText}').value="";
var grid = dijit.byId('#{id:grid}');
grid.filter("",true);
grid.store.close();
grid._refresh(); 
```

This was developed with 8.5.2\. There might be some cleaner ways to do things in 8.5.3 with dojo 1.6.1.

Enjoy!

# iphone - 根据 iphone 中的计时器，音频文件无法正常播放

> ID：10022489
> 
> 赞同：0
> 
> 时间：2012-04-05T04:00:15.320
> 
> 标签：iphone, objective-c

我在标签中显示从 5 到 1 的倒数计时器。当我的倒数计时器显示时，我试图在特定标签的背景中播放音频，即如果显示 5，则应播放 5 的音频声音，如果 1 秒后显示 4，应该播放4的音频等等。我已经完成了代码，但问题是5、4、3、2、1的所有音频同时播放。这是我的代码。

```
-(void)viewWillAppear:(BOOL)animated
{
    countDown = 7;
    exitcountdown = 0;
    lblCountdown.hidden = YES;
    btnCancel.hidden = YES;
    lblCancel.hidden = YES;
    countDownTimer = [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(updateTime:) userInfo:nil repeats:YES];
    [countDownTimer fire];

}

-(void)updateTime:(NSTimer*)timerParam
{

    countDown--;
    if (countDown==5)
    {
        lblCountdown.hidden = NO;
        lblCountdown.text = [NSString stringWithFormat:@"%d",countDown];
        NSString *path = [[NSBundle mainBundle] pathForResource:[NSString stringWithFormat:@"%d",countDown] ofType:@"mp3"]; 
                if ([player isPlaying])
        {
            [player stop];
        }
        player= [[AVAudioPlayer alloc]initWithContentsOfURL:[NSURL fileURLWithPath:path] error:NULL];
        player.delegate = self;
        [player stop];
        [player setCurrentTime:0.0];
        [player setVolume:100.0];
        [player play];
        lblCancel.hidden = NO;
        btnCancel.hidden = NO;
        lblWarning.hidden = YES;
        lblGps.hidden = YES;

        [countDownTimer fire];
    }
    else if (countDown==0)
    {
        [self sendRequest];
        countDownTimerexit = [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(exitBackground:) userInfo:nil repeats:YES];
        [countDownTimerexit fire];
        NSString *phoneLinkString = [NSString stringWithFormat:@"tel://%@", self.emergencyphonenumber];
        NSURL *phoneLinkURL = [NSURL URLWithString:phoneLinkString];
        [[UIApplication sharedApplication] openURL:phoneLinkURL];

        [self clearCountDownTimer];
        btnCancel.hidden = YES;
        lblCancel.hidden = YES;

    }
    lblCountdown.text = [NSString stringWithFormat:@"%d",countDown];
} 
```

lblCountdown 是将 countDown 打印为 5、4、3、2、1 的标签。countDown 是一个 int 变量 countDownTimer 是 NSTimer 变量

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:26:24.470

我认为您的代码中发生的事情是在标签上显示文本比播放声音要快。显示 5 并且您在 5 声到达结束计数器变为 4 之前请求播放声音，然后您停止播放器并请求下一个文件。

尝试在播放声音和显示下一个数字之间插入一些延迟。

# jquery - jQuery if($(element).find(selector)) 在找不到时停止脚本

> ID：10022491
> 
> 赞同：0
> 
> 时间：2012-04-05T04:00:36.970
> 
> 标签：jquery

作为我正在编写的脚本的一部分，我有以下内容：

```
loop
if($(element).find(selector))
{ do stuff }
else
{ do other stuff }
/loop 
```

这个想法是有两个版本的元素循环，我需要区分它们（基于内容）以确定要采取的操作。

如果 find 成功，这将非常有用。如果不是，则脚本有一个致命错误。

我找不到任何关于查找失败时会发生什么的文档。我该如何进行这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:08:46.600

这个怎么样？

```
if($(element).find(selector).length > 0)
{ do stuff } 
```

它有点长，但应该工作。

在我看来，您最初的 find 测试总是评估为 true。测试长度可以得到一个布尔结果来评估。

# c++ - C++：在 std::map 中引用计数值；std::multimap 是更好的选择吗？

> ID：10022492
> 
> 赞同：2
> 
> 时间：2012-04-05T04:00:37.570
> 
> 标签：c++, multimap, stdmap, reference-counting

目前我已经实现了映射值的引用计数缓存，如下所示：

```
//filename or name of bitmap, reference count, memory location...
std::map<std::string, std::pair<long, BITMAP*> > _cache; 
```

使用 std::multimap 是更好的选择吗？

```
//filename or name of bitmap, memory location...
std::multimap<std::string, BITMAP*> _cache; 
```

或者只是一种不同的方式？

**- 编辑 -**

这是为了清楚我的意图的特定类它旨在成为一个私有类，对用户从未见过的其余代码严格实用。对他们来说，他们只是在创建一个 Sprite。**注意：**该`BITMAP`结构被认为是私有的，创建/销毁/修改结构的唯一方法是通过第 3 方 C 库中需要使用原始指针的众多函数*之一*。

位图缓存.h

```
#ifndef A2DE_CBITMAPCACHE_H
#define A2DE_CBITMAPCACHE_H

#include "../a2de_vals.h"
#include <allegro/file.h>
#include <allegro/gfx.h>
#include <allegro/draw.h>
#include <allegro/datafile.h>
#include <allegro/color.h>

#include <map>
#include <utility>
#include <string>

struct BITMAP;

_A2DE_BEGIN

class BitmapCache {
public:
    static BITMAP* GetBitmap(std::string filename);
    static BITMAP* StoreBitmap(std::string name, BITMAP* bmp);
    static BITMAP* RetrieveBitmap(std::string name);
    static std::string GetBitmapName(BITMAP* file);
    static void RemoveBitmap(std::string name);

protected:
private:
    static std::map<std::string, std::pair<long, BITMAP*> > _cache;
    static void CleanCache();

};

_A2DE_END

#endif 
```

位图缓存.cpp

```
#include "CBitmapCache.h"

#include <algorithm>
#include <map>

_A2DE_BEGIN

//filename or name of bitmap, reference count, memory location...
typedef std::map<std::string, std::pair<long, BITMAP*> > MapStrBmp;
typedef MapStrBmp::iterator MapStrBmpIter;

MapStrBmp BitmapCache::_cache;

BITMAP* BitmapCache::GetBitmap(std::string filename) {
    //Return NULL if a bad filename was passed.
    if(filename.empty()) return NULL;
    if(exists(filename.c_str()) == false) return NULL;

    //Reduce incorrect results by forcing slash equality.
    filename = fix_filename_slashes(&filename[0]);

    //Clean the cache if it's dirty.
    CleanCache();

    //Search for requested BITMAP.
    MapStrBmpIter _iter = _cache.find(filename);

    //If found, return it.
    if(_iter != _cache.end()) {
        _iter->second.first++;
        return _iter->second.second;
    }

    //Otherwise, create it, store it, then return it.
    BITMAP* result = load_bmp(filename.c_str(), NULL);
    if(result == NULL) return NULL;
    _cache.insert(std::make_pair(filename, std::make_pair(static_cast<long>(1), result)));
    return result;
}

BITMAP* BitmapCache::StoreBitmap(std::string name, BITMAP* bmp) {
    if(name.empty() || bmp == NULL) return NULL;

    CleanCache();
    name = fix_filename_slashes(&name[0]);
    MapStrBmpIter _iter = _cache.find(name);
    if(_iter != _cache.end()) {
        _iter->second.first++;
        return _iter->second.second;
    }

    _cache.insert(std::make_pair(name, std::make_pair(static_cast<long>(1), bmp)));
    return bmp;
}
BITMAP* BitmapCache::RetrieveBitmap(std::string name) {
    if(name.empty()) return NULL;

    name = fix_filename_slashes(&name[0]);
    MapStrBmpIter _iter = _cache.find(name);
    if(_iter != _cache.end()) {
        _iter->second.first++;
        return _iter->second.second;
    }
    return NULL;
}

void BitmapCache::RemoveBitmap(std::string name) {
    if(name.empty()) return;

    name = fix_filename_slashes(&name[0]);
    MapStrBmpIter _iter = _cache.find(name);

    if(_iter != _cache.end()) {
        _iter->second.first--;
        CleanCache();
    }
}

std::string BitmapCache::GetBitmapName(BITMAP* file) {
    if(file == NULL) return std::string("");

    CleanCache();
    MapStrBmpIter b = _cache.begin();
    MapStrBmpIter e = _cache.end();
    for(MapStrBmpIter _iter = b; _iter != e; ++_iter) {
        if(_iter->second.second != file) continue;
        return _iter->first;
    }
    return std::string("");
}

void BitmapCache::CleanCache() {

    //Clean the cache of any bitmaps that are no longer referenced.
    MapStrBmpIter b = _cache.begin();
    MapStrBmpIter e = _cache.end();
    for(MapStrBmpIter _iter = b; _iter != e; /* DO NOTHING */ ) {
        if(_iter->second.first > 0) {
            ++_iter;
            continue;
        }
        destroy_bitmap(_iter->second.second);
        _iter->second.second = NULL;
        _cache.erase(_iter++);
    }
}

_A2DE_END 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T04:10:48.473

```
std::map<std::string, std::pair<long, BITMAP*> > _cache; 
```

不要重新发明轮子。使用`shared_ptr`（在某些编译器的 boost 或 tr1 命名空间中或在较新编译器的 std:: 命名空间中可用）或任何其他现有的经过良好测试的智能指针类。重新发明轮子是常见的编程错误之一 - 通过尝试重新实现某些东西（已经由其他人编写），您将浪费开发时间而一无所获。

- 编辑 -

> 和 destroy_bitmap 方法

boost::shared_ptr 支持自定义删除器。使用它们。

> 我该怎么做才能在传入相同的文件名时不创建几个 BITMAP

`std::map<std::string, boost::weak_ptr<BITMAP> >`. 如果 map 中不存在 value，或者现有的 weak_ptr 已过期，则使用 deleter 创建新的 shared_ptr 并将 weak_ptr 放入 map 并返回此 shared_ptr。否则（weak_ptr 尚未过期）从 weak_ptr 中提取 shared_ptr 并返回它。

当然，这取决于使用模式。如果您没有编写某种“资源缓存/池”（未使用的资源即使在地图中也会被删除），那么您可以`shared_ptr`在地图中使用删除器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T05:40:04.070

假设你有：

```
struct BITMAP;
BITMAP* create_bitmap(std::string const& filename);
void destroy_bitmap(BITMAP*); 
```

那么你可以拥有：

```
typedef std::shared_ptr<BITMAP> bitmap_ptr;

class bitmap_cache {
public:
    bitmap_ptr
    make(std::string const& filename)
    {
        auto it = map.find(filename);
        if(it != map.end()) {
            return it->second;
        } else {
            bitmap_ptr p(create_bitmap(filename), &destroy_bitmap);
            map.insert(std::make_pair(filename, p));
            return p;
        }
    }

private:
    std::map<std::string, bitmap_ptr> map;
}; 
```

请注意，每个`bitmap_cache`创建`BITMAP`的 s 在其生命周期内都保持活动状态，但未使用`BITMAP`的 s 将在缓存到达其生命周期结束时被正确处理（缓存`BITMAP`的某些客户端正在使用的 s 将保持安全活动状态）。如果需要，您可以通过`std::weak_ptr<BITMAP>`在地图中使用来改进这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T22:52:32.627

好吧，事实证明我不能将 STL 智能指针用于我正在尝试做的事情。在重新处理上述代码以使用智能指针后，程序在关闭时不断崩溃。事实证明，allegro 4.2 库 API 明确指出，在取消初始化 allegro 后尝试调用 allegro 方法（特别是处理位图的方法......）会使程序崩溃。智能指针只有在超出范围后才会销毁自己（并尝试调用其包含的指针的删除器方法）......在程序结束并且 allegro 被取消初始化之后，这反过来又使程序崩溃。

所以现在，滚动我自己的引用计数实现的当前解决方案是变通方法。

无论如何，感谢您的建议和帮助。

# java - 在 Play Web Service 中使用 GET 参数？

> ID：10022493
> 
> 赞同：0
> 
> 时间：2012-04-05T04:00:40.083
> 
> 标签：java, web-services, playframework

我尝试使用 Play Framework 1.2.3 构建 Web 服务服务器，但遇到了一些问题：

1.  我试过这个教程[如何使用播放！开发 web 服务的框架](http://tjureyoung.blogcn.com/articles/how-to-use-play-framework-to-develop-webservice.html)。我不知道如何使用GET参数请求Web服务，如何使用参数请求Web服务？
2.  是否可以在 Play 中使用 GIF 文件返回结果？如果是，任何人都可以为此提供示例或链接（之前尝试过谷歌搜索，但没有结果）？

谢谢你的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T06:14:38.847

对于所描述的 web 服务，它应该很容易。例如，如果您有如下操作

```
public class Application extends Controller {

    public static void sum(Float num1, Float num2) {
        Float result = num1 * num2;
        render(result);
    }
} 
```

和一条路线

```
GET /webservices/sum                 Application.sum(format:'xml') 
```

那么你需要做的就是像下面这样调用服务

```
/webservices/sum?num1=10.1&num2=13.5 
```

这将通过传入所需的参数来执行您的操作

对于问题的第二部分。您将`renderBinary`在您的操作中使用以返回您的 GIF 文件。

# c++ - 用 For 循环或 If 语句包装字符串

> ID：10022494
> 
> 赞同：1
> 
> 时间：2012-04-05T04:01:02.477
> 
> 标签：c++, string, if-statement, for-loop

假设我们声明了一个字符串...

```
string paragraphy = "This is a really really long string containing a paragraph long content. I want to wrap this text by using a for loop to do so."; 
```

使用此字符串变量，如果文本宽度超过 60 并且在 60 宽度之后有空格，我想包装文本。

有人可以为我提供代码或任何帮助来创建这样的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:19:37.733

解决这个问题的一个基本思路是跟踪该段中第 60 个字符之前的一段字符串中的最后一个空格。

由于这是家庭作业，我会让你想出代码，但是这里有一些粗略的上述建议的伪代码：

```
- current_position = start of the string
- WHILE current_position NOT past the end of the string
   - LOOP 1...60 from the current_position (also don't go past the end of the string)
      - IF the character at current_position is a space, set the space_position to this position
   - Replace the character (the space) at the space_position with a newline
   - Set the current_position to the next character after the space_position

- If you're printing the string rather than inserting newline characters into it, you would print any remaining part of the string here. 
```

您可能还需要考虑在 60 个字符的块中没有任何空格的情况。

# javascript - 正则表达式电话号码

> ID：10022496
> 
> 赞同：-1
> 
> 时间：2012-04-05T04:01:08.340
> 
> 标签：javascript, regex, phone-number

> **可能重复：**
> [用于电话号码验证的综合正则表达式](https://stackoverflow.com/questions/123559/a-comprehensive-regex-for-phone-number-validation)

有人可以给我电话号码的正则表达式吗？可输入XXX-XXX-XXXX或(XXX)-XXX-XXXX或XX-XXX-XXXX或XXXXXXXXX格式

这是我所拥有的：

```
/\d{2,3}-\d{3}-\d{4}$/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:06:40.593

蛮力/易于维护/易于阅读/我认为这就是你所拥有的。

`(\d\d\d\-\d\d\d\-\d\d\d\d)|(\(\d\d\d\)\-\d\d\d\-\d\d\d\d)|(\d\d\-\d\d\d\-\d\d\d\d)|(\d\d\d\d\d\d\d\d\d)`

或者，如果您愿意：

`(\d{3}\-\d{3}\-\d{4})|(\(\d{3})\-\d{3}\-\d{4})|(\d{2}-\d{3}\-\d{4})|(\d{9})`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:27:29.757

大多数情况下，您关心数字：

```
 /^([()-]*\d)[()-]*){9,10}$/.test(string);

    or even

    /^(\D*\d\D*){9,10}/.test(string); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T04:04:23.990

```
((\d{2,3}|\(\d{3}\))-\d{3}-\d{4}|\d{9}) 
```

# asp.net-mvc-3 - 在 appsettings web.config 中设置电子邮件设置

> ID：10022498
> 
> 赞同：6
> 
> 时间：2012-04-05T04:01:25.727
> 
> 标签：asp.net-mvc-3

在 web.config 中设置电子邮件详细信息 - 但没有发送电子邮件！

```
 <appSettings>
    <add key="webpages:Version" value="1.0.0.0" />
    <add key="ClientValidationEnabled" value="true" />
    <add key="UnobtrusiveJavaScriptEnabled" value="true" />
    <add key="smtpServer" value="smtp.live.com" />
    <add key="EnableSsl" value = "true"/>
    <add key="smtpPort" value="587" />
    <add key="smtpUser" value="MyEmail@live.co.uk" />
    <add key="smtpPass" value="mypasswordgoeshere" />
    <add key="adminEmail" value="no-reply@no-reply.com" />
  </appSettings> 
```

我正在使用以下课程

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Net.Mail;
using System.Net;
using System.Configuration;

namespace MVCcars.Utils
{
  public static class MailClient
  {
    private static readonly SmtpClient Client;
    static MailClient()
    {
      Client = new SmtpClient
      {
        Host =
          ConfigurationManager.AppSettings["SmtpServer"],
        Port =
          Convert.ToInt32(
            ConfigurationManager.AppSettings["SmtpPort"]),
        DeliveryMethod = SmtpDeliveryMethod.Network

      };
      Client.UseDefaultCredentials = false;
      Client.Credentials = new NetworkCredential(
      ConfigurationManager.AppSettings["SmtpUser"],
      ConfigurationManager.AppSettings["SmtpPass"]);
    }

    private static bool SendMessage(string from, string to,
      string subject, string body)
    {
      MailMessage mm = null;
      bool isSent = false;
      try
      {
        // Create our message
        mm = new MailMessage(from, to, subject, body);
        mm.DeliveryNotificationOptions =
        DeliveryNotificationOptions.OnFailure;
        // Send it
        Client.Send(mm);
        isSent = true;
      }
      // Catch any errors, these should be logged and
      // dealt with later
      catch (Exception ex)
      {
        // If you wish to log email errors,
        // add it here...
        var exMsg = ex.Message;
      }
      finally
      {
        mm.Dispose();
      }
      return isSent;
    }

    public static bool SendWelcome(string email)
    {
      string body = "Put welcome email content here...";
      return SendMessage(
        ConfigurationManager.AppSettings["adminEmail"],
          email, "Welcome message", body);
    }
  }
} 
```

这是帐户控制器：

```
[HttpPost]
public ActionResult Register(RegisterModel model)
{
    if (ModelState.IsValid)
    {
        // Attempt to register the user
        MembershipCreateStatus createStatus;
        Membership.CreateUser(model.UserName,
          model.Password, model.Email, null, null,
          true, null, out createStatus);
        if (createStatus ==
            MembershipCreateStatus.Success)
        {
          // Send welcome email
          MailClient.SendWelcome(model.Email);
          FormsAuthentication.SetAuthCookie(
            model.UserName,
            false /* createPersistentCookie */);
          return RedirectToAction("create", "Customer");
        }
        else
        {
          ModelState.AddModelError("",
            ErrorCodeToString(createStatus));
        }
    }
    // If we got this far, something failed,
    // redisplay form
    return View(model);   
} 
```

web.config 中的应用设置是否适合 enableSsl？欢迎任何建议

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-05T04:07:28.277

在 .NET 中使用 SmtpClient 的一种更简单的方法是使用 system.net 配置设置。这将允许您为创建的任何 SmtpClient 设置默认值，而无需编写代码来设置所有属性。这样您就可以轻松地修改整个设置，而无需更改任何代码。

```
 <system.net>
    <mailSettings>
      <smtp from="no-reply@no-reply.com">
        <network host="smtp.live.com" password="mypasswordgoeshere" port="587" userName="MyEmail@live.co.uk"  enableSsl="true"/>
      </smtp>
    </mailSettings>
  </system.net> 
```

然后在代码中

```
 System.Net.Mail.SmtpClient smtp = new System.Net.Mail.SmtpClient();
 smtp.Send(mailMessage); 
```

**编辑**这是我在下面发布的原始代码：

```
static MailClient() 
{ 
     Client = new SmtpClient 
     { 
         Host = ConfigurationManager.AppSettings["SmtpServer"], 
         Port = Convert.ToInt32(ConfigurationManager.AppSettings["SmtpPort"]), 
         DeliveryMethod = SmtpDeliveryMethod.Network,
         EnableSsl = bool.Parse(ConfigurationManager.AppSettings["EnableSsl"])

     };
  .....
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T04:38:24.393

除了上面尼克博克的回答之外，您可能需要对您的 asp 页面进行一些更改并使用

> 邮件设置组

. 希望此链接对您有所帮助 [如何使用不太新的 MailSettingsSectionGroup](http://www.diaryofaninja.com/blog/2010/01/27/how-to-use-the-notsonew-mailsettingssectiongroup)

# android - 在 android 中创建烛台图

> ID：10022500
> 
> 赞同：0
> 
> 时间：2012-04-05T04:01:50.213
> 
> 标签：android, stocks

我正在查看股票图表 - [http://code.google.com/p/stock-chart](http://code.google.com/p/stock-chart)用于在我的应用程序中创建烛台图。我找不到任何好的教程。有谁知道一些使用股票图表的好教程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:09:09.710

您可以尝试免费的烛台图表 API。它包含所有类型的图表。以下链接包含示例代码

[自由图](http://code.google.com/p/afreechart/source/browse/trunk/)

也试试这个链接

[JFreeChart 中的烛台图](http://www.java2s.com/Code/Java/Chart/JFreeChartCandlestickDemo.htm)

我想它可以帮助你..

# php - 从 php 到 mysql 的日期字段返回错误 0000-00-00

> ID：10022501
> 
> 赞同：0
> 
> 时间：2012-04-05T04:01:51.263
> 
> 标签：php, mysql

我有一个 php 表单，我必须手动输入日期。当我输入日期为 Y/M/DI 时没有任何问题。但是，如果我将日期输入为 d/m/y，它将以 0000-00-00 的形式存储在我的数据库中

```
$TransactionDate= $row['DealDate']; 
```

TransactionDate = 我的字段名 DealDate = 我的列名

我需要帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:33:32.417

试试这个代码

```
$date = mysql_real_escape_string($_POST['DealDate']); 
```

1.  如果您的 MySQL 列是 DATE 类型：

    ```
    $date = date('Y-m-d', strtotime(str_replace('-', '/', $date))); 
    ```

2.  如果您的 MySQL 列是 DATETIME 类型：

    ```
    $date = date('Y-m-d H:i:s', strtotime(str_replace('-', '/', $date))); 
    ```

如果日期分隔符是 - 你不能使用 strototime()，因为它不适用于破折号 - 分隔符，它会尝试做减法。

在这种情况下使用正则表达式

```
$date = mysql_real_escape_string($_POST['DealDate']);
$date = preg_replace('#(\d{2})/(\d{2})/(\d{4})\s(.*)#', '$3-$2-$1 $4', $date);
echo $date; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T04:03:58.403

MySQL 唯一可接受的直接使用日期格式是`YYYY-mm-dd hh:mm:ss`. 插入任何其他内容几乎总是会导致插入 0000-00-00 默认日期值。

如果您的日期字符串是其他格式，您必须先将其转换为 MySQL 可接受的格式。

# c - 有没有办法解决关闭使用管道函数创建的文件描述符

> ID：10022504
> 
> 赞同：0
> 
> 时间：2012-04-05T04:02:00.573
> 
> 标签：c, linux, pipe

我想知道我们是否真的可以创建一个解决方法/别名来关闭文件描述符。意思是，close(fd) 应该在与 fd（文件描述符）关联的流内部做一些事情。我们能否在不实际使用文件描述符上的关闭函数的情况下获得/提供关闭函数的功能。

我希望在我不想关闭管道的写入端（使用 pipe() 函数创建）的情况下这样做，但另一端不应该知道这一点。管道的另一端应该感觉另一端实际上是封闭的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:08:40.143

也许您正在寻找该`shutdown`功能。但这用于全双工连接以指示数据以一个方向结束。

也许可以关闭单向管道以`shutdown`从写入端写入？从来没有听说过这样做。

这将是最接近以类似于关闭的方式操作连接状态的方法，而无需实际处理文件描述符。（如果可以对这些对象进行该操作。）

你继续做豚鼠。;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T05:02:57.807

“如果你创建一个与系统函数同名的外部可见函数，*你的*函数将被称为_instead_of_原始系统函数。”

```
#include<stdio.h>
int open(const char *p,int f) {
    printf("we are in our open()\n");
}
int close() {
    printf("we are in our close()\n");
}

main() {
    open("test",1);
    close();
    return 0;
} 
```

[从这里挑选](http://fixunix.com/unix/353470-intercepting-system-calls-linux.html)

# api - Skype API 帮助和行为很奇怪

> ID：10022505
> 
> 赞同：0
> 
> 时间：2012-04-05T04:02:16.763
> 
> 标签：api, skype

我为 Skype 制作了一个名为 (Skype PWN4G3) 的大型应用程序，其中一个功能是以下代码行：

//控制的

```
 private void botOn_Click(object sender, EventArgs e)
        {
            if (toolStripLabel5.Text == "Not attached")
            {
                MessageBox.Show(notAttached, "Skype Pwnage - Info!", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
            }
            else
            {
                botStop = false;
                skype.Attach(7, false);
                skype.MessageStatus += new _ISkypeEvents_MessageStatusEventHandler(skype_MessageStatus);
                botOn.Text = "Running";
                botOn.Enabled = false;
                botOff.Enabled = true;
            }
        }

        private void botOff_Click(object sender, EventArgs e)
        {
            botStop = true;
            botOn.Text = "Enable";
            botOn.Enabled = true;
            botOff.Enabled = false;
        } 
```

//功能

```
private void skype_MessageStatus(ChatMessage msg, TChatMessageStatus status)
{
    if (botStop == true)
    {
    }
    else
    {
        try
        {
            string command = msg.Body.Remove(0, trigger.Length).ToLower();
            string[] lines = richTextBox4.Text.Split('\n');
            foreach (string ln in lines)
            {
                string[] commands = ln.Split(':');
                if (radioButton6.Checked == true)
                {
                    if (command.Contains(commands[0]))
                    {
                        listBox2.Items.Add(DateTime.Now +"> "+ commands[0]);
                        skype.SendMessage(msg.Sender.Handle, string.Format(commands[1]));
                        break;
                    }
                }
                    if (radioButton4.Checked == true)
                    {
                        if (command == commands[0])
                        {
                            listBox2.Items.Add(DateTime.Now + "> " + commands[0]);
                            skype.SendMessage(msg.Sender.Handle, string.Format(commands[1]));
                            break;
                        }
                    }
                }
            }
        catch (Exception err0)
        {
        }

    }
} 
```

现在我的问题是这个代码工作很棒，如果他们说某个词，它会自动回复一个人。但是演技很奇葩。如果您在 Skype 窗口最小化的情况下启动机器人并让它工作，它会很好地工作，直到您停止然后启动它或将单选按钮从“精确”更改为“包含”，然后它下次运行时会回复 2 次，然后如果你再次执行上述操作，它将回复 3 次，依此类推，

另一个非常奇怪的问题是，一旦您打开 Skype 窗口并从您身边查看消息，它就会再次重新发送它们。知道为什么吗？

如果有人知道我如何正确停止/启动它，那就再多一个，那就太棒了。如果你知道怎么做，那么它就不会听来自聊天组的消息，只有 PM 会很棒，因为现在它会听聊天然后发送给 User.Handle，除非我可以通过某种方式让它发送到聊天消息发送的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T20:42:24.283

1) 回复 2、3 次和更多次 - 似乎问题在于`skype.MessageStatus += ...`每次单击 botOn 时都会调用它。调用`-=`或确保事件订阅只发生一次。

2) 再次发送消息：skype_MessageStatus 被调用一条消息两次 - 检查 SKYPE4COMLib.TChatMessageStatus cmsSending/cmsReceived - 当消息被传递时和 cmsSent/cmsRead 当目标用户点击并实际查看消息时 - 所以你需要做的就是检查值`SKYPE4COMLib.TChatMessageStatus Status`

3）在您的代码中测试直接消息和聊天组之间的差异

```
SKYPE4COMLib.ChatMessage pMessage;
if (pMessage.Chat.Members.Count == 2)
{
    // process direct messages
}
else if(pMessage.Chat.Members.Count > 2)
{
    // do whatever you want to do to process chat messages
} 
```

# jsf-2 - primefaces 计划时间未在一周显示

> ID：10022515
> 
> 赞同：0
> 
> 时间：2012-04-05T04:03:41.307
> 
> 标签：jsf-2, primefaces

这是我的问题。当我点击星期时，它没有显示时间。

![在此处输入图像描述](../Images/bc1d4599d9f786458e26f3a5541d25ec.png)

![在此处输入图像描述](../Images/951b649bd9dd246bcfb194cd759364e6.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:36:23.803

:)

再看日历...

您的 4 月月视图也显示了 5 月初。

所以它的 1/5 和 4/5 事件实际上属于 May

虽然周显示向您显示四月的第一周....您应该将周视图进一步推进到五月初...在那里您应该看到 1/5 和 4/5 的事件

# php - mysqli::error 对比。mysqli_stmt：错误

> ID：10022519
> 
> 赞同：1
> 
> 时间：2012-04-05T04:04:21.627
> 
> 标签：php, mysqli

[mysqli::error](http://www.php.net/manual/en/mysqli.error.php)是否包含[mysqli_stmt::error](http://www.php.net/manual/en/mysqli-stmt.error.php)？如果在准备语句或执行语句时发生错误，myqli::error 将包含该错误，还是该错误仅包含在 mysqli_stmt::error 中？

编辑：为了清楚起见，我试图了解我是否需要专门检查 mysqli_stmt::error 来处理和报告故障，或者是否可以在整个过程中使用 mysqli::error 而不会遗漏任何错误。

编辑 2：如果错误是单独的，应该用于 mysqli::stmt_init() 失败？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T07:24:11.383

```
$mysqli = new mysqli('localhost', 'root', 'yabadaba', 'testdb');
$stmt = $mysqli->prepare('MESSUP(?'); //no error thrown
var_dump($mysqli->error); //... right syntax to use near 'MESSUP(?' 
```

虽然有一个[异常类](http://ru.php.net/manual/en/class.mysqli-sql-exception.php)- 我似乎找不到任何实际抛出它的方法。看起来一切都在`$mysqli->error`。

# ruby - Ruby 中的“+=”（加号）是什么意思？

> ID：10022524
> 
> 赞同：4
> 
> 时间：2012-04-05T04:04:44.403
> 
> 标签：ruby

我正在阅读 Ruby 教程，但我无法掌握 += 语句。谷歌没有帮助，“Ruby +=”只搜索“Ruby”。

帮助表示赞赏。

样本：

```
num = -10
num += -1 if num < 0
puts num   
#=> -11 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T04:06:10.657

```
num += -1 
```

相当于

```
num = num + -1 
```

或者，对于这个例子

```
num = num - 1 
```

反过来，它可以写成

```
num -= 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:06:17.897

它同时做两件事。

(1) 将 + 1 添加到 num (2) 将结果分配回 num

它的捷径：

`num = num + 1`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T04:11:21.503

段`a += b`只是`a = a + b`. 所以你的陈述：

```
num += -1 if num < 0 
```

如果它已经是负数（如果），则会简单地减去一个（通过添加`-1`which is ... quaint，这可能就像我一样有礼貌）..`num``num < 0`

# mysql - 用户<>评论关系中的 MySql 选择、计数（*）和子查询

> ID：10022527
> 
> 赞同：15
> 
> 时间：2012-04-05T04:05:13.113
> 
> 标签：mysql, sql, subquery, aggregate-functions

我的任务是计算评论数 > X 的用户数量。

我的 SQL 查询如下所示：

```
SELECT users.id,
       users.display_name, 
       (SELECT COUNT(*) 
          FROM cms_comments 
         WHERE cms_comments.author_id = users.id) AS comments_count 
  FROM users 
HAVING comments_count > 150; 
```

一切正常，它正确显示了所有用户。但我需要查询以一行返回所有这些用户的数量。我不知道如何更改此查询以使其生成正确的数据。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-05T04:26:44.657

我想这就是你要找的：

```
select count(*) from (
    select u.id from users u
    join cms_comments c on u.id = c.author_id
    group by u.id
    having count(*) > 150
) final 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-05T04:16:16.290

使用 group by 子句

```
SELECT users.id,
       users.display_name, 
       (SELECT COUNT(*) 
          FROM cms_comments 
         WHERE cms_comments.author_id = users.id) AS comments_count 
FROM users 
GROUP BY users.id, user.display_name
HAVING comments_count > 150; 
```

这将为您计算每个 users.id、users.display_name 的commments_count > 150

至于您对获取用户总数的评论，最好更新您的问题，但如果您想要计算符合此条件的所有用户，请使用

```
SELECT COUNT(*) AS TotalNumberOfUsersMatchingCritera
FROM
(
    SELECT users.id,
           users.display_name, 
           (SELECT COUNT(*) 
              FROM cms_comments 
             WHERE cms_comments.author_id = users.id) AS comments_count 
    FROM users 
    GROUP BY users.id, user.display_name
    HAVING comments_count > 150;
) AS T 
```

# objective-c - 用鼠标移动一个 NSRect

> ID：10022531
> 
> 赞同：-2
> 
> 时间：2012-04-05T04:05:24.293
> 
> 标签：objective-c, xcode, cocoa

如何创建一个 NSRect ，它是可选择的并且可以在视图内移动？是 CGRect 还是 NSRect 来完成这个？我要添加什么：

```
NSRect viewFrame = NSMakeRect(0, 0, 100, 100); 
```

我是否首先必须使其可选择然后使用 NSEvent，或者我是否可以让 NSRect 原点等于我在 NSTracking 中的鼠标位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:32:02.633

NSRect 和 CGRect 只是包含定义矩形的数据的结构。如果你想在屏幕上绘制一个矩形，你需要创建一个绘制矩形的视图。要移动该矩形，您将告诉视图在不同位置绘制矩形，或者只是移动视图。

# cakephp - CakePHP 的版本号

> ID：10022532
> 
> 赞同：17
> 
> 时间：2012-04-05T04:05:26.507
> 
> 标签：cakephp, cakephp-1.2

我从海外的老承包商那里继承了代码。我看到的 cakephp 版本是：

CakePHP v 0.2.9

这适合在哪里？它早于 1.0 还是这是一些 2.0 约定？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-04-05T06:36:34.493

Cake 2.0 的当前版本号可以在`/path/to/cake/lib/Cake/VERSION.txt`. txt 文件包含一个注释块，其中包含文件描述（说明它自 Cake 0.2.9 以来一直存在），后跟实际版本号。

相同的文件可以在 Cake 1.3 的`/path/to/cake/cake/VERSION.txt`.

以下是 2.0.5 的内容`VERSION.txt`：

```
////////////////////////////////////////////////////////////////////////////////////////////////////
    // +--------------------------------------------------------------------------------------------+ //
    // CakePHP Version
    //
    // Holds a static string representing the current version of CakePHP
    //
    // CakePHP(tm) : Rapid Development Framework (http://cakephp.org)
    // Copyright 2005-2011, Cake Software Foundation, Inc. (http://cakefoundation.org)
    //
    // Licensed under The MIT License
    // Redistributions of files must retain the above copyright notice.
    //
    // @copyright     Copyright 2005-2011, Cake Software Foundation, Inc. (http://cakefoundation.org)
    // @link          http://cakephp.org
    // @package       cake.libs
    // @since         CakePHP(tm) v 0.2.9
    // @license       MIT License (http://www.opensource.org/licenses/mit-license.php)
    // +--------------------------------------------------------------------------------------------+ //
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    2.0.5 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-04-05T07:54:29.627

查找当前版本的最简单方法是

```
echo Configure::version(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-14T21:17:38.383

最好的方法是 command .\cake version 这个 cammand 将显示你使用的 cakephp 版本。

# objective-c - UIImage 的 CGImage 返回 NULL

> ID：10022534
> 
> 赞同：9
> 
> 时间：2012-04-05T04:06:10.103
> 
> 标签：objective-c, ios, uiimage, cgimage

我创建了一个用于将图像拆分为多个图像的函数，但是当我获取 UIImage 的 CGImage 时，CGImage 返回 NULL

```
NSArray* splitImage(UIImage* image,NSUInteger pieces) {

NSLog(@"width: %f, %zu",image.size.width,CGImageGetWidth(image.CGImage));
NSLog(@"%@",image.CGImage);
returns NULL
NSMutableArray* tempArray = [[NSMutableArray alloc]initWithCapacity:pieces];

CGFloat piecesSize = image.size.height/pieces;

for (NSUInteger i = 0; i < pieces; i++) {

    // take in account retina displays
    CGRect subFrame = CGRectMake(0,i * piecesSize * image.scale ,image.size.width * image.scale,piecesSize * image.scale);

    CGImageRef newImage = CGImageCreateWithImageInRect(image.CGImage,subFrame);

    UIImage* finalImage =[UIImage imageWithCGImage:newImage];

    CGImageRelease(newImage);

    [tempArray addObject:finalImage];

}

NSArray* finalArray = [NSArray arrayWithArray:tempArray];

[tempArray release];

return finalArray;

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T20:22:08.203

如果 UIImage 是从另一个图像（例如 IOSurface 或 CIImage）创建的，则 CGImage 属性将返回 nil。为了在这种特殊情况下解决这个问题，我可以使用 c 函数从 IOSurface 创建一个 CGImage，然后将其转换为 UIImage。

```
UICreateCGImageFromIOSurface(IOSurfaceRef surface); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-01-24T13:29:40.557

我`UIImage`从`CGImage`.

```
CIImage *ciImage = image.CIImage;
CIContext *context = [CIContext contextWithOptions:nil];
CGImageRef ref = [context createCGImage:ciImage fromRect:ciImage.extent];
UIImage *newImage = [UIImage imageWithCGImage:ref]; 
```

而现在`newImage.CGImage`不是`nil`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T04:22:40.617

您现在所做的只是创建具有**0.f 宽度**的片段，您应该使用两个`for`s 为您的片段定义`width`& `height`。像这样的代码示例（尚未测试，但它应该可以工作）：

```
for (int height = 0; height < image.size.height; height += piecesSize) {
  for (int width = 0; width < image.size.width; width += piecesSize) {
    CGRect subFrame = CGRectMake(width, height, piecesSize, piecesSize);

    CGImageRef newImage = CGImageCreateWithImageInRect(image.CGImage, subFrame);
    UIImage * finalImage = [UIImage imageWithCGImage:newImage];
    CGImageRelease(newImage);

    [tempArray addObject:finalImage];
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T06:17:14.640

在某些情况下，当我们尝试裁剪图像时会发生这种情况。我找到了这样的解决方案试试这可能对你有帮助：-

```
NSData *imageData = UIImageJPEGRepresentation(yourImage, 0.9);
newImage = [UIImage imageWithData:imageData]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-07-03T11:29:24.030

使用此将 CGImage 转换为 UIImage 并且 cgImage 不会为空：

```
func convert(cmage:CIImage) -> UIImage
{       
    let context:CIContext = CIContext.init(options: nil)
    let cgImage:CGImage = context.createCGImage(cmage, from: cmage.extent)!        
    let image:UIImage = UIImage.init(cgImage: cgImage)        
    return image
} 
```

# java - 使用枚举的 Java 方法重构

> ID：10022538
> 
> 赞同：5
> 
> 时间：2012-04-05T04:06:23.470
> 
> 标签：java

下面的 getCategory 方法似乎非常多余，我想知道是否有人对重构它有一些建议，以使其更清洁，可能使用枚举。根据传入的“val”，我需要 getCategory 从 Category 类返回正确的 Category 实例。Category 类是生成的 JNI 代码，所以我不想更改它。有人有想法么？

**重构方法：**

```
private Category getCategory(String val) throws Exception{
        Category category;
        if (val.equalsIgnoreCase("producer")) {
            usageCategory = Category.CATEGORY_PRODUCER;
        } else if (val.equalsIgnoreCase("meter")) {
            usageCategory = Category.CATEGORY_METER;
        } else if (val.equalsIgnoreCase("consumer")) {
            usageCategory = Category.CATEGORY_CONSUMER;
        } else {
            throw new Exception("Invalid value: " + val);
        }       
        return usageCategory;
    } 
```

**Category.java：生成的 JNI（无法更改）：**

```
public final class Category {
  public final static Category CATEGORY_PRODUCER = new Category("CATEGORY_PRODUCER", SampleJNI.CATEGORY_PRODUCER_get());
  public final static Category CATEGORY_METER = new Category("CATEGORY_METER", SampleJNI.CATEGORY_METER_get());
  public final static Category CATEGORY_CONSUMER = new Category("CATEGORY_CONSUMER", SampleJNI.CATEGORY_CONSUMER_get());

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T04:13:38.707

您的方法本质上是从预定*映射*`String`到 a `Category`，那么为什么不使用 a`Map`呢？具体来说，我推荐 Guava's [`ImmutableMap`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableMap.html)，因为这些映射是静态的：

```
private static final ImmutableMap<String, Category> CATEGORIES_BY_STRING =
        ImmutableMap.of(
            "producer", Category.CATEGORY_PRODUCER,
            "meter", Category. CATEGORY_METER,
            "consumer", Category.CATEGORY_CONSUMER
        ); 
```

或者如果您不想使用第三方库，则使用标准方式：

```
private static final Map<String, Category> CATEGORIES_BY_STRING;
static {
    Map<String, Category> backingMap = new HashMap<String, Category>();
    backingMap.put("producer", Category.CATEGORY_PRODUCER);
    backingMap.put("meter", Category.CATEGORY_METER);
    backingMap.put("producer", Category.CATEGORY_CONSUMER);
    CATEGORIES_BY_STRING = Collections.unmodifiableMap(backingMap);
} 
```

您仍然可以使用您的方法来检查无效值（并支持不区分大小写，正如 David Harkness 指出的那样）：

```
private Category getCategory(String val) {
    Category category = CATEGORIES_BY_STRING.get(val.toLowerCase());
    if (category == null) {
        throw new IllegalArgumentException();
    }
    return category;
} 
```

* * *

**关于使用枚举：**

如果您可以完全控制`String`传递给 s 的 s `getCategory`，并且只会传递文字值，那么切换到 a 确实有意义`enum`。

**编辑：**以前，我建议[`EnumMap`](http://docs.oracle.com/javase/6/docs/api/java/util/EnumMap.html)在这种情况下使用，但[阿德里安的回答](https://stackoverflow.com/a/10022765/697449)更有意义。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-05T04:39:07.093

如果您说要基于枚举进行重构，我假设您的意思是您不再希望将 String 传递给 getCategory 来完成所有这些工作。该代码直接使用枚举，而不是使用字符串。

如果是这种情况，请继续阅读

幸运的是，您的 Category 是静态变量，因此您可以直接做一些真正的事情

```
public enum FooCategory {  // give a better name yourself
  PRODUCER(Category.CATEGORY_PRODUCER),
  METER(Category.CATEGORY_METER),
  CONSUMER(Category.CATEGORY_CONSUMER)

  private Category category;
  FooCategory(Category category) {
    this.category=category;
  }
  Category getCategory() {
    return this.category;
  }
} 
```

在您的旧代码中，您正在执行以下操作：

```
String fooCategory = "producer";
//....
Category category = getCategory(fooCategory);
// work on category 
```

现在你正在做一些更整洁的事情

```
FooCategory fooCategory = FooCategory.PRODUCER;
//...
Category category = fooCategory.getCategory();
// work on category 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T05:31:38.847

@PaulBellora 和 @AdrianShum 的答案都很棒，但我认为你不能避免使用像“producer”（不区分大小写）这样的魔法值来生产`Category`存储原因。所以恐怕其中的冗余代码`getCategory`也无法避免。（不幸的是，用于初始化`Category`和获取的魔法值`Category`不一样）

以下是要使用的代码`Enum`（Java 1.5 或更高版本）：

```
public enum Category {
    CATEGORY_PRODUCER,
    CATEGORY_METER,
    CATEGORY_CONSUMER;

    public static Category of(String val) throws Exception {
        Category usageCategory;
        if (val.equalsIgnoreCase("producer")) {
            usageCategory = Category.CATEGORY_PRODUCER;
        } else if (val.equalsIgnoreCase("meter")) {
            usageCategory = Category.CATEGORY_METER;
        } else if (val.equalsIgnoreCase("consumer")) {
            usageCategory = Category.CATEGORY_CONSUMER;
        } else {
            throw new Exception("Invalid value: " + val);
        }       
        return usageCategory;
    }
} 
```

如果你使用相同的魔法值来生产、获取和存储，你可以：

```
public enum Category {
    CATEGORY_PRODUCER("producer"),
    CATEGORY_METER("meter"),
    CATEGORY_CONSUMER("consumer");

    private String category;
    private Category(String category) {
        this.category = category;
    }

    public static Category of(String val) throws Exception {
        Category usageCategory;
        // You can use equals not equalsIgnoreCase, so you can use map to avoid redundant code.
        // Because you use the same magic value everywhere.
        if (val.equals("producer")) {
            usageCategory = Category.CATEGORY_PRODUCER;
        } else if (val.equals("meter")) {
            usageCategory = Category.CATEGORY_METER;
        } else if (val.equals("consumer")) {
            usageCategory = Category.CATEGORY_CONSUMER;
        } else {
            throw new Exception("Invalid value: " + val);
        }       
        return usageCategory;
    }
} 
```

并创建一个`Category`：

```
Category category = Category.of("producer"); 
```

当然，您必须更改代码以包含`SampleJNI.CATEGORY_CONSUMER_get()`.

# c - 伯克利数据库 - 重复条目分段错误

> ID：10022540
> 
> 赞同：1
> 
> 时间：2012-04-05T04:06:31.317
> 
> 标签：c, database, segmentation-fault, berkeley-db

所以我目前正在通过 C 语言处理伯克利数据库，我遇到了一个关于允许重复数据的小问题。如果我不允许通过 DB->set_flags 重复条目，并且我使用游标遍历数据库中的项目，那么一切正常。当我在我的程序中添加 DB->set_flags 行并且没有更改任何其他内容时，我遇到了分段错误并且我不知道如何修复它，考虑到它可以正常工作而没有重复条目。代码如下：

```
DB *dates_db;
db_create(&dates_db, NULL, 0);
dates_db->set_flags(dates_db, DB_DUP);
dates_db->open(dates_db, NULL, "da.idx", NULL, DB_BTREE, 0, 0664);

DBT key, data;
memset(&key, 0, sizeof(key)); 
memset(&data, 0, sizeof(data));

DBC *DBpointer;
dates_db->cursor(dates_db, NULL, &DBpointer, 0);

while(DBpointer->c_get(DBpointer, &key, &data, DB_NEXT) != DB_NOTFOUND)
{
    printf("The key is: %s\nThe data is: %s\n", (char *)key.data, (char *)data.data);
} 
```

谁能告诉我我需要添加什么？我已经检查了包含有关 Berkeley DB 的所有信息的 sourceforge 页面，据我所知，我只需要添加 DB->set_flags 行以允许重复条目，但是我可能错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:42:15.280

首先，当函数可能失败时，您应该始终检查返回值。

具体来说，`db_create`, `set_flags`, `open`,`cursor` *都*返回错误指示。

如果正如您在评论中指出的那样，它是`c_get`导致 SIGSEGV 的原因，您可能希望确保光标确实是正确创建的。

改变：

```
DBC *DBpointer;
dates_db->cursor(dates_db, NULL, &DBpointer, 0); 
```

到：

```
DBC *DBpointer = (DBC*)0xdeadbeef;
int rc = dates_db->cursor(dates_db, NULL, &DBpointer, 0);
printf ("DEBUG: %d %p\n", rc, DBpointer);
fflush (stdio); // and possibly also: fsync (fileno (stdio)); 
```

将是一个好的开始。

最好是一路走来并使用类似的东西：

```
#define CHKERR(x) if(rc!=0){printf("%s err=%d\n",x,rc);fflush(stdout);exit(1);}
int rc;
DB *dates_db;

rc = db_create(&dates_db, NULL, 0);
CHKERR("create");

rc = dates_db->set_flags(dates_db, DB_DUP);
CHKERR("set_flags");

rc = dates_db->open(dates_db, NULL, "da.idx", NULL, DB_BTREE, 0, 0664);
CHKERR("open");

DBT key, data;
memset(&key, 0, sizeof(key)); 
memset(&data, 0, sizeof(data));

DBC *DBpointer;
rc = dates_db->cursor(dates_db, NULL, &DBpointer, 0);
CHKERR("cursor");

while((rc = DBpointer->c_get(DBpointer, &key, &data, DB_NEXT)) != DB_NOTFOUND)
{
    CHKERR("c_get");
    printf("The key is: %s\nThe data is: %s\n", (char *)key.data, (char *)data.data);
} 
```

* * *

根据您在公开呼叫中收到错误 22 的进一步评论，那是`EINVAL`（至少在我的系统上）这意味着您的参数之一不正确。

根据网络搜索，该调用似乎有一些变化`open`，范围在 5 到 7 个参数之间。一些[Oracle BDB doco](http://docs.oracle.com/cd/E17076_02/html/programmer_reference/BDB_Prog_Reference.pdf)声明它需要*五个*参数（没有数据库指针和事务指针），但同一文档（和[其他 Oracle doco](http://docs.oracle.com/cd/E17076_02/html/api_reference/C/BDB-C_APIReference.pdf)）中的示例代码具有您的七参数形式。

查看您的 BDB 头文件以查看您应该使用哪个可能是值得的。

# node.js - 引擎盖下的 node.js 是基于什么的？

> ID：10022541
> 
> 赞同：3
> 
> 时间：2012-04-05T04:06:40.360
> 
> 标签：node.js

引擎盖下的 node.js 是基于什么的？它是从头开始编写的，还是基于另一个项目？

（另外，任何人都可以确定制作 http 模块的 Web 服务器技术吗？）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T04:23:57.823

*...它是基于另一个项目吗？*

Node.js 利用了几个项目：

*   [v8](http://code.google.com/p/v8/) (谷歌)
*   [利夫夫](http://software.schmorp.de/pkg/libev.html)
*   [自由](http://software.schmorp.de/pkg/libeio.html)
*   [c-ares](http://c-ares.haxx.se/)（来自 curl 的作者）
*   [EVCOM](https://github.com/ry/evcom)
*   [http解析器](https://github.com/joyent/http-parser)

通过：[http ://blog.zorinaq.com/?e=34](http://blog.zorinaq.com/?e=34)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T04:18:03.647

Node.js 是一个基于 Chrome V8 javascript 引擎构建的事件驱动平台。

它基于用其他语言构建的类似平台，例如 Python 中的 Twisted、Ruby 中的 EventMachine 或 C 中的 libevent。

它是从头开始写的。你可以在这里阅读更多关于它的信息[http://nodejs.org/about/](http://nodejs.org/about/)。如果您想要更深入的答案，也可以加入 nodejs 开发者邮件列表。

* * *

具体来说，关于 node.js http 服务器，从上面链接的 Node 页面中提取：

> HTTP 是 Node.js 中的第一类协议。Node 的 HTTP 库源于作者开发和使用 Web 服务器的经验。例如，通过大多数 Web 框架流式传输数据是不可能的。Node 尝试在其 HTTP 解析器和 API 中纠正这些问题。再加上 Node 的纯事件基础设施，它为 Web 库或框架奠定了良好的基础。

# jquery - 在 url 中使用 # 打开模式

> ID：10022543
> 
> 赞同：5
> 
> 时间：2012-04-05T04:07:11.957
> 
> 标签：jquery, url, modal-dialog

对于这个可能很愚蠢的问题，我很抱歉，但我想简单地在 url 中打开带有 # 的模式。因此，如果我调用 www.domain.com/#modal1 它将打开已经弹出模式的页面。

哦，我正在使用 jquery。

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-05T04:10:31.513

许多应用程序框架（我偏爱[主干](http://documentcloud.github.com/backbone/)）使用某种路由器来完成此任务，但您可以通过检查`window.hash`并运行适当的功能来伪造自己的：

```
function popModal() {
  // code to pop up modal dialog
}

var hash = window.location.hash;
if (hash.substring(1) == 'modal1') {
  popModal();
} 
```

​​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T01:09:22.287

谢谢解答，

这是我的实现：

```
function bf_hashCheck(){
var hash = window.location.hash;        
if (hash){
    if (jQuery(hash).css('display')=='none'){           
        jQuery(hash).fadeIn(300);
    }
}
} 
```

只是一个简单的例子

# javascript - 内容的历史可编辑的替代品

> ID：10022546
> 
> 赞同：4
> 
> 时间：2012-04-05T04:07:17.543
> 
> 标签：javascript, html, contenteditable

> 相关：[ContentEditable 替代方案](https://stackoverflow.com/questions/9250272/contenteditable-alternative)

我很确定以前有在线所见即所得的编辑器之类的`contentEditable`。我确实记得使用 GDocs 和 GMail 以及与`contentEditable`.

所以，我想要一个（最好是技术性的）历史，了解这些东西在`contentEditable`存在之前是如何设计的。如果变通办法的历史很长，您无需解释所有细节 - 只需基本想法，以便我可以查找它（尽管链接赞赏），和/或自己弄清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T10:11:15.967

contentEditable 是在 Internet Explorer 5.5 中引入的；是的，很久以前。这比任何 GMail、GDocs 或类似的东西都要早一点。

在此之前，IE 通过自定义 ActiveX 控件（例如在 FrontPage 中使用）提供编辑功能

您可以[在 WHATWG 博客上阅读完整的历史记录](http://blog.whatwg.org/the-road-to-html-5-contenteditable)

# node.js - 发布请求以解析移动数据管理

> ID：10022547
> 
> 赞同：0
> 
> 时间：2012-04-05T04:07:20.720
> 
> 标签：node.js, httprequest

我正在尝试向 Parse 发送发布请求：[https](https://parse.com/docs/rest#objects-creating) ://parse.com/docs/rest#objects-creating 。无法使其正常工作。我在我的程序中使用真实的 App 和 Rest API ID。

```
var https = require('https');

var options = {
 host: 'api.parse.com',
 port: 443,
 path: '/1/classes/GameScore',
 method: 'POST',
 headers: {
    X-Parse-Application-Id: "",
    X-Parse-REST-API-Key: "",
    Content-Type: "application/json";
}
 data: {
    "score": 1337, "playerName": "Sean Plott", "cheatMode": false
 }
}

};

var req = https.request(options, function(res) {
 console.log("statusCode: ", res.statusCode);
 console.log("headers: ", res.headers);

res.on('data', function(d) {
 process.stdout.write(d);
 });
});
req.end();

req.on('error', function(e) {
 console.error(e);
}); 
```

编辑：添加错误响应：

```
SyntaxError: Unexpected token -
at Module._compile (module.js:406:25)
at Object..js (module.js:417:10)
at Module.load (module.js:343:31)
at Function._load (module.js:302:12)
at Array.<anonymous> (module.js:430:10)
at EventEmitter._tickCallback (node.js:126:26) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T11:03:27.233

您不能将`-`其用作不带引号的对象的键。

所以你需要改变

```
headers: {
  X-Parse-Application-Id: "",
  X-Parse-REST-API-Key: "",
  Content-Type: "application/json";
} 
```

成为

```
headers: {
  "X-Parse-Application-Id": "",
  "X-Parse-REST-API-Key": "",
  "Content-Type": "application/json";
} 
```

# java - Java 从子类访问受保护的变量

> ID：10022548
> 
> 赞同：2
> 
> 时间：2012-04-05T04:07:27.260
> 
> 标签：java

我正在做一个关于java继承的家庭作业。我在理解如何从子类访问超类中的数组时遇到了一些麻烦。我看了其他几个问题，因为我对 java 还很陌生，所以我还是不太明白。

这是超级班

```
import java.text.NumberFormat;

/**
 * Bank represents a single Bank containing a number of BankAccounts.
 */
public class Bank {

    // Member variables:

    /** The array of BankAccount objects contained in this bank. */
    protected BankAccount[] myAccounts = new BankAccount[2000];

    /** The number of BankAccount objects stored in the array in this bank. */
    protected int numberOfAccounts = 0;

    // Constructors:

    /**
     * Creates a Bank.
     */
    public Bank() {}

    // Methods:

    /** 
     * Creates an account with the name and balance, and adds it to 
     * the bank's list of accounts.
     * If the name already exists, no account will be created.
     * @param aName The name for the new account.
     * @param aBalance The initial balance for the new account.
     */
    public void createAccount( String aName, double aBalance) {
        BankAccount existing = this.findAccount( aName);
        if( existing != null) return;
        BankAccount anAccount = new BankAccount( aBalance, aName);
        this.myAccounts[ numberOfAccounts] = anAccount;
        this.numberOfAccounts++;
    }

    /** 
     * Finds an account in the bank's list of accounts by name.
     * If no account is found, this method returns null.
     * @param aName The name of the BankAccount to search for.
     * @return The BankAccount bearing the given name, if found.
     */
    public BankAccount findAccount( String aName) {
        BankAccount answer = null;
        for( int index = 0; index < numberOfAccounts; index++) {
            BankAccount anAccount = this.myAccounts[ index];
            if( aName.equals( anAccount.getName())) {
                return( anAccount);
            }
        }
        return( answer);
    }

    /** 
     * Returns a String which represents a short summary of 
     * all the accounts in the bank.
     * @return A String representation of all accounts and their balances in the bank.
     */
    public String toString() {
        String answer = "";
        NumberFormat currencyFormatter = NumberFormat.getCurrencyInstance();
        for( int index = 0; index < numberOfAccounts; index++) {
            BankAccount anAccount = this.myAccounts[ index];
            String money = currencyFormatter.format( anAccount.getBalance());
            answer += anAccount.getName() + " \t" + money + "\n";
        }
        return( answer);
    }

} 
```

这是子类的开始

```
public class BankSubClass extends Bank{
    private double interestPaid;

    // Constructor
    public BankSubClass(String aName, double aBalance, double aInterest) {
        super();
        this.interestPaid = aInterest;
    }

    // Getters
    public double getInterestPaid() {return(this.interestPaid);}

    // Setters
    public void setInterestPaid(double setInterestPaid) {this.interestPaid = setInterestPaid;}

    // Other methods
    public double endOfYear() {
        for (i=0;i<BankAccount.length();i++) {

        }
    }

} 
```

最后的那个 for 循环是事情有点出错的地方。Netbeans 抛出错误说“找不到符号：变量 i”。也许这与我尝试使用的银行帐户数组无关，我不知道。任何帮助深表感谢

谢谢你的时间！

*编辑*

所以这是相同作业的延续

感谢大家的回复，您的建议解决了这个问题，但是我目前正在遇到另一个减速带。for 循环所在的这个方法背后的想法是遍历 BankAccount 对象数组，检查它们中的任何一个是否属于 InterestAccount 类型（我之前构建的一个类），如果是，则调用 yearlyUpdate()该类的方法

这是 InterestAccount 类

```
public class InterestAccount extends BankAccount {
    private double interestRate;

    // Constructor
    /**
     * Create and interest bearing bank account with a balance, name,
     * and interest rate
     * @param aBalance The balance of the account
     * @param aName The name tied to the account
     * @param myInterestRate The interest rate of the account
     */
    public InterestAccount(double aBalance, String aName, double myInterestRate) {
        super(aBalance, aName);
        this.interestRate = myInterestRate;
    }

    // Getters
    /**
     * Gets the interest rate of the account
     * @return the interest rate of the account
     */
    public double getInterestRate() {return(this.interestRate);}

    // Setters
    /**
     * Sets the interest rate of the account
     * @param interestSet The new interest rate of the account
     */
    public void setInterestRate(int interestSet) {this.interestRate = interestSet;}

    // Other Methods
    /**
     * Calculates the interest earned on the account over a year
     * @return the interest earned over a year
     */
    public double yearlyUpdate() {
        double answer = (super.getBalance()*this.interestRate);
        return answer;
    }
} 
```

这是我目前正在使用的超级类

```
import java.text.NumberFormat;

/**
 * Bank represents a single Bank containing a number of BankAccounts.
 */
public class Bank {

    // Member variables:

    /** The array of BankAccount objects contained in this bank. */
    protected BankAccount[] myAccounts = new BankAccount[2000];

    /** The number of BankAccount objects stored in the array in this bank. */
    protected int numberOfAccounts = 0;

    // Constructors:

    /**
     * Creates a Bank.
     */
    public Bank() {}

    // Methods:

    /** 
     * Creates an account with the name and balance, and adds it to 
     * the bank's list of accounts.
     * If the name already exists, no account will be created.
     * @param aName The name for the new account.
     * @param aBalance The initial balance for the new account.
     */
    public void createAccount( String aName, double aBalance) {
        BankAccount existing = this.findAccount( aName);
        if( existing != null) return;
        BankAccount anAccount = new BankAccount( aBalance, aName);
        this.myAccounts[ numberOfAccounts] = anAccount;
        this.numberOfAccounts++;
    }

    /** 
     * Finds an account in the bank's list of accounts by name.
     * If no account is found, this method returns null.
     * @param aName The name of the BankAccount to search for.
     * @return The BankAccount bearing the given name, if found.
     */
    public BankAccount findAccount( String aName) {
        BankAccount answer = null;
        for( int index = 0; index < numberOfAccounts; index++) {
            BankAccount anAccount = this.myAccounts[ index];
            if( aName.equals( anAccount.getName())) {
                return( anAccount);
            }
        }
        return( answer);
    }

    /** 
     * Returns a String which represents a short summary of 
     * all the accounts in the bank.
     * @return A String representation of all accounts and their balances in the bank.
     */
    public String toString() {
        String answer = "";
        NumberFormat currencyFormatter = NumberFormat.getCurrencyInstance();
        for( int index = 0; index < numberOfAccounts; index++) {
            BankAccount anAccount = this.myAccounts[ index];
            String money = currencyFormatter.format( anAccount.getBalance());
            answer += anAccount.getName() + " \t" + money + "\n";
        }
        return( answer);
    }

} 
```

最后，这是我试图在其中运行这个 for 循环的子类

```
public class BankSubClass extends Bank{
    private double interestPaid;

    // Constructor
    public BankSubClass(String aName, double aBalance, double aInterest) {
        super();
        this.interestPaid = aInterest;
    }

    // Getters
    public double getInterestPaid() {return(this.interestPaid);}

    // Setters
    public void setInterestPaid(double setInterestPaid) {this.interestPaid = setInterestPaid;}

    // Other methods
    public double endOfYear() {
        double trackInterest=0;
        for (int i=0;i<numberOfAccounts;i++) {
            BankAccount working = myAccounts[i];
            boolean hasInterest = working instanceof InterestAccount;
            if (hasInterest) {
                trackInterest = trackInterest + working.yearlyUpdate();
            }
            return trackInterest;
        }
    }

} 
```

目前netbeans在尝试在“工作”时调用它时找不到“yearlyUpdate（）”方法我不明白的是因为前面的代码验证了工作对象是InterestAccount类型，它应该有该方法可用

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:10:28.113

```
// Other methods
public double endOfYear() {
    for (i=0;i<BankAccount.length();i++) {

    }
} 
```

你需要声明`i`

```
// Other methods
public double endOfYear() {
    for (int i=0;i<BankAccount.length();i++) {

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:10:31.640

就像错误所说：我是未定义的。

尝试：

```
for (int i=0;i<BankAccount.length();i++) 
```

我猜这仍然很糟糕，因为您想要数组的长度，而不是 BankAccount 类（可能未定义）

```
for (int i=0;i<myAccounts.length();i++) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T04:10:42.753

对于该错误，您需要在 BankSubClass.endOfYear 中使用之前定义变量 i。声明应该是

```
for (int i=0;i<BankAccount.length();i++) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T04:11:31.017

您没有`i`在 for 循环中声明

```
for (int i=0;i<BankAccount.length();i++) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T04:18:05.887

在您的循环中，变量`i`未声明。另外，由于我认为您希望遍历数组中的帐户，因此我认为您应该使用以下内容：

```
for(int i = 0; < numberOfAccounts; i++)
{
    BankAccount bankAccount = myAccounts[i];
    // other stuff
} 
```

# java - 插入数据库

> ID：10022552
> 
> 赞同：-1
> 
> 时间：2012-04-05T04:08:24.220
> 
> 标签：java, android, sql

我已经编写了一个查询来将值插入到 Android 中的数据库中：

```
db.execSQL("CREATE TABLE " + TABLE_NAME + "( " + KEY_SITUATION_NAME
         + " TEXT NOT NULL, " + KEY_CATEGORY_NAME + " TEXT NOT NULL,"
         + KEY_LATTIUDE +" NOT NULL," + KEY_LONGITUDE + " NOT NULL," + " );"); 
```

但是，当我执行它时，会引发错误。谁能指出其中的错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:28:22.730

```
db.execSQL("CREATE TABLE " + TABLE_NAME + "( " + KEY_SITUATION_NAME
     + " TEXT NOT NULL, " + KEY_CATEGORY_NAME + " TEXT NOT NULL,"
     + KEY_LATTIUDE +" INTEGER NOT NULL," + KEY_LONGITUDE + " INTEGER NOT NULL" + " );"); 
```

为 KEY_LATITUDE 和 KEY_LONGITUDE 提供数据类型。

而且你最后保留了一个（，），这是不需要的......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:17:40.970

```
 db.execSQL("CREATE TABLE " + TABLE_NAME + "( " + KEY_SITUATION_NAME
             + " TEXT NOT NULL, " + KEY_CATEGORY_NAME + " TEXT NOT NULL,"
             + KEY_LATTIUDE +" NOT NULL," + KEY_LONGITUDE + " NOT NULL);"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T04:22:31.483

正确的代码是：

```
db.execSQL("CREATE TABLE " + TABLE_NAME + "( " + KEY_SITUATION_NAME
        + " TEXT NOT NULL, " + KEY_CATEGORY_NAME + " TEXT NOT NULL," + KEY_LATTIUDE +" NOT NULL," + KEY_LONGITUDE + " NOT NULL," + " )"); 
```

# 64-bit - 不同位大小的操作系统上的数据类型有区别吗？

> ID：10022559
> 
> 赞同：0
> 
> 时间：2012-04-05T04:09:30.350
> 
> 标签：64-bit, 32bit-64bit, 32-bit

我有一个 C 程序，我知道它可以在 32 位系统上运行。在 64 位系统（*至少我*的）上，它工作到一个点然后停止。阅读一些论坛的程序可能不是 64 位安全的？我认为这与 32 位和 64 位系统之间的数据类型差异有关。

两者都一样吗`char`？`int`或者`long`它们的`unsigned`变体呢？32 位程序是否有任何其他方式不会是 64 位安全的？如果我想验证应用程序是 64 位安全的，我应该采取哪些步骤？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:16:28.413

C 中的常规数据类型具有最小的值范围，而不是特定的位宽。例如，a`short`必须至少能够表示 -32767 到 32767（含）。

所以，是的，如果你的代码依赖于环绕在 32768 的值，那么如果 short 是一些大喇叭的 128 位庞然大物，它就不太可能表现良好。

如果您想要特定宽度的数据类型，请查看`stdint.h`诸如此类`int64_t`的内容。有多种选择，具体宽度，“至少”宽度等等。与“常规”整数类型不同，它们还要求对这些进行补码：

*   具有某些精确宽度的整数类型；
*   具有至少某些指定宽度的整数类型；
*   具有至少某些指定宽度的最快整数类型；
*   整数类型足够宽以保存指向对象的指针；
*   具有最大宽度的整数类型。

例如，来自`C11 7.20.1.1 Exact-width integer types`：

> typedef 名称 intN_t 指定宽度为 N、无填充位和二进制补码表示的有符号整数类型。因此， int8_t 表示这种宽度正好为 8 位的有符号整数类型。

如果您遵守规则（例如不将指针转换为整数），您的代码应该可以在任何实现和任何架构上编译和运行。

如果没有，您只需开始调试，然后在专门讨论此类问题的论坛站点上发布似乎导致问题的详细信息和代码。现在我最近在哪里见过其中之一？:-)

# ruby - 启动 redmine 1.2 失败

> ID：10022562
> 
> 赞同：0
> 
> 时间：2012-04-05T04:10:02.207
> 
> 标签：ruby, gem, redmine

当我尝试使用与 redmine 本身绑定的服务器启动 redmine 1.2 时，它向我显示 gem 错误，信息如下：

```
[root@XPG redmine-1.2.0]# ruby script/server webtrick -e production
Missing the i18n 0.4.2 gem. Please `gem install -v=0.4.2 i18n` 
```

即使我安装了它说的gem：

```
[root@XPG redmine-1.2.0]# gem list --local

*** LOCAL GEMS ***

aasm (2.2.0)
abstract (1.0.0)
actionmailer (2.3.5)
actionpack (2.3.5)
activerecord (2.3.5)
activeresource (2.3.5)
activesupport (2.3.5)
arel (2.0.10)
Ascii85 (1.0.1)
block_helpers (0.3.3)
builder (2.1.2)
bundler (1.0.14)
capybara (1.0.0)
childprocess (0.1.9)
cucumber (1.0.0)
cucumber-rails (1.0.2)
diff-lcs (1.1.2)
edavis10-object_daddy (0.4.3)
erubis (2.6.6)
ffi (1.0.9)
gherkin (2.4.1)
holidays (1.0.2)
i18n (0.4.2)
icalendar (1.1.6)
json (1.6.1, 1.5.3)
json_pure (1.5.3)
mail (2.2.19)
mime-types (1.16)
mocha (0.9.12)
mysql (2.8.1)
nokogiri (1.5.0)
pdf-reader (0.9.2)
polyglot (0.3.1)
prawn (0.11.1)
rack (1.2.3, 1.1.2, 1.0.1)
rack-mount (0.6.14)
rack-test (0.5.7)
rails (2.3.5)
rake (0.9.0)
rubygems-update (1.8.11, 1.8.4, 1.5.3, 1.3.7)
rubyzip (0.9.4)
selenium-webdriver (0.2.2)
shoulda (2.10.3)
sqlite3 (1.3.3)
sqlite3-ruby (1.3.3)
term-ansicolor (1.0.5)
thor (0.14.6)
treetop (1.4.9)
ttfunk (1.0.1)
tzinfo (0.3.27)
xpath (0.1.4) 
```

但是问题还是出现了，请问有解决的办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:25:11.390

据我所知，您的命令不正确。

1.  服务器的名称是 webrick，而不是“webtrick”
2.  即使使用webrick，它也不支持生产环境。
3.  似乎您没有使用 rails3/bundle

我建议你使用 mongrel 或 Thin 启动 webserver，它们都比 webrick 更快更稳定。

# .net - Active Directory 中的 Powershell 访问列表

> ID：10022566
> 
> 赞同：0
> 
> 时间：2012-04-05T04:10:27.587
> 
> 标签：.net, windows, powershell, active-directory

当我在同一次运行中`GrantGenericRead`创建一个对象时，我有一个函数可以工作。`$ouUnixGroups`我试图弄清楚如何从我可以运行的 AD 中获取一个对象`GrantGenericRead`，但似乎当我以我知道的各种方式尝试这个时（adsi，使用 .Path 查找），我无法访问某些属性设置它的对象。我很想有人告诉我我做错了什么。

此代码在同时运行时有效：

```
function CreateADGroup([string] $server, [string] $name, [string] $container, [string] $gtype)
{
    $objClass = "group";
    $strCn = GetCn -name $name -objClass $objClass;
    $objDsGroup  = CreateDsObject -server $server -container $container -name $name -objClass $objClass 
    [Void] $objDsGroup.Put("sAMAccountName", $name)
    if ($gtype -eq "global")
    {
        # Global Distribution Group 
        [Void] $objDsGroup.Put("groupType", 0x80000002)
    }
    elseif ($gtype -eq "dlg")
    {
        # Domain Local Distribution Group  
        [Void] $objDsGroup.Put("groupType", 0x80000004)
    }
    elseif ($gtype -eq "uni")
    {
        # Universal Security Group 
        [Void] $objDsGroup.Put("groupType", 0x80000008)
    }
    else
    {
        Write-Host("Invalid group type {0}" -f $gtype)
    }
    [Void]$objDsGroup.SetInfo()
    return $objDsGroup
}

function CreateDsObject([string] $server, [string] $container, [string] $name, [string] $objClass)
{
$strConatinerPath = GetLdapPath -server $server -dn $container
$objContainer = [adsi] $strConatinerPath
$strChildCn = GetCn -name $name -objClass $objClass
$strChildDn = "{0},{1}" -f $strChildCn, $container
$strChildPath = GetLdapPath -server $server -dn $strChildDn
$objChildEntry = $objContainer.Create($objClass, $strChildCn)
[Void]$objChildEntry.SetInfo()
    return $objChildEntry
}

function GrantGenericRead($dsTrustee, $dsResources)
{
    $strSid = GetSid -dsObj $dsTrustee
    $objSid = New-Object Security.Principal.SecurityIdentifier($strSid)
    $ace = New-Object DirectoryServices.ActiveDirectoryAccessRule($objSid, $AD_RIGHT::GenericRead, $AC_TYPE::Allow)
    [Void] $dsResources.psbase.ObjectSecurity.AddAccessRule($ace)
    [Void] $dsResources.psbase.CommitChanges()
}

function GetSid($dsObj)
{
    $dn = $dsObj.distinguishedName.Value
    $binary = $dsObj.psbase.Properties["objectSid"].Value
    $sid = New-Object Security.Principal.SecurityIdentifier($binary, 0)
    return $sid.ToString()
}

$adminContainerDn = "OU=Zone Administration,{0}" -f   $adminContainer.Get("distinguishedName") #returns OU=Zone Administration,OU=asdfasdf,DC=baldur,DC=vm
$ouUnixGroups   = CreateDsObject -server $server -container $ouDN -name $strOuUnixGroups   -objClass "OrganizationalUnit"
$joinOps = CreateADGroup -server $server -name "Join Operators" -container $adminContainerDn -gtype "global"

GrantGenericRead -dsTrustee $joinOps -dsResources $ouUnixGroups 
```

我想要完成的是能够修改`$joinOps`和`$ouUnixGroups`从不创建它们的脚本。我如何访问它们？我可以得到 sid，但这似乎对我没有帮助，除非我在这里遗漏了一些真正关键的东西。

```
GrantGenericRead -dsTrustee $joinOps -dsResources [adsi]$ouUnixGroups.Path 
```

如果有人想看看，我将从我在[http://pastebin.com/uF3nrDuw](http://pastebin.com/uF3nrDuw)上发布的安装程序脚本中提取其中的一些行。你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T07:15:20.157

你可以试试：

```
GrantGenericRead -dsTrustee [adsi]"cn=Agroup,ou=AnOU,dc=dompn,dc=domp0" -dsResources [adsi]"ou=theUnixOU,ou=AnOtherOU,dc=dompn,dc=domp0" 
```

# matlab - OpenCV 2.3 相机校准

> ID：10022568
> 
> 赞同：6
> 
> 时间：2012-04-05T04:10:30.950
> 
> 标签：matlab, opencv, computer-vision, vision, camera-calibration

我正在尝试使用`OpenCV 2.3`python 绑定来校准相机。我在 matlab 中使用了下面的数据并且校准工作，但我似乎无法让它在 OpenCV 中工作。我作为初始猜测设置的相机矩阵非常接近从 matlab 工具箱计算的答案。

```
import cv2
import numpy as np

obj_points = [[-9.7,3.0,4.5],[-11.1,0.5,3.1],[-8.5,0.9,2.4],[-5.8,4.4,2.7],[-4.8,1.5,0.2],[-6.7,-1.6,-0.4],[-8.7,-3.3,-0.6],[-4.3,-1.2,-2.4],[-12.4,-2.3,0.9],    [-14.1,-3.8,-0.6],[-18.9,2.9,2.9],[-14.6,2.3,4.6],[-16.0,0.8,3.0],[-18.9,-0.1,0.3],    [-16.3,-1.7,0.5],[-18.6,-2.7,-2.2]]
img_points = [[993.0,623.0],[942.0,705.0],[1023.0,720.0],[1116.0,645.0],[1136.0,764.0],[1071.0,847.0],[1003.0,885.0],[1142.0,887.0],[886.0,816.0],[827.0,883.0],[710.0,636.0],[837.0,621.0],[789.0,688.0],[699.0,759.0],[768.0,800.0],[697.0,873.0]]

obj_points = np.array(obj_points)
img_points = np.array(img_points)

w = 1680
h = 1050
size = (w,h)

camera_matrix = np.zeros((3, 3))
camera_matrix[0,0]= 2200.0
camera_matrix[1,1]= 2200.0
camera_matrix[2,2]=1.0
camera_matrix[2,0]=750.0
camera_matrix[2,1]=750.0 

dist_coefs = np.zeros(4)
results = cv2.calibrateCamera(obj_points, img_points,size, 
    camera_matrix, dist_coefs) 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-05T05:29:52.900

首先，您的相机矩阵是错误的。如果您阅读[文档](http://opencv.itseez.com/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#calibratecamera)，它应该如下所示：

```
fx  0 cx
 0 fy cy
 0  0  1 
```

如果你看看你的，你就搞错了：

```
fx  0  0
 0 fy  0
cx cy  1 
```

所以首先，设置`camera_matrix`为`camera_matrix.T`（或改变你的构造方式`camera_matrix`。记住那`camera_matrix[i,j]`是*row* `i`，*column* `j`）。

```
camera_matrix = camera_matrix.T 
```

接下来，我运行了你的代码，我看到“似乎无法让它工作”意味着以下错误（顺便说一下 - 总是在你的问题中说出“似乎无法让它工作”的意思- 如果它是一个错误，发布错误。如果它运行但给你奇怪的数字，这么说）：

```
OpenCV Error: Assertion failed (ni >= 0) in collectCalibrationData, file /home/cha66i/Downloads/OpenCV-2.3.1/modules/calib3d/src/calibration.cpp, line 3161
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
cv2.error: /home/cha66i/Downloads/OpenCV-2.3.1/modules/calib3d/src/calibration.cpp:3161: error: (-215) ni >= 0 in function collectCalibrationData 
```

然后我阅读了[文档](http://opencv.itseez.com/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#calibratecamera)`obj_points`（顺便说一句非常有用）并注意到它`img_points`必须是**向量的向量**，因为可以为同一棋盘的多个图像（/校准点）输入一组对象/图像点。

因此：

```
cv2.calibrateCamera([obj_points], [img_points],size, camera_matrix, dist_coefs) 
```

什么？我仍然得到同样的错误？！

然后，我查看了 OpenCV python2 示例（在文件夹中`OpenCV-2.x.x/samples/python2`），并注意到`calibration.py`向我展示了如何使用校准函数（永远不要低估示例，它们通常比文档更好！）。

我试图运行`calibration.py`，但它没有运行，因为它没有提供必要的`camera_matrix`and`distCoeffs`参数。所以我修改了它来喂一个假人`camera_matrix`，`distCoeffs`嘿，它有效！

我可以看到我的`obj_points`/`img_points`和他们的之间的唯一区别是他们的有`dtype=float32`，而我的没有。

所以，我改变了我的`obj_points`and`img_points`也有 dtype float32 （OpenCV 的 python2 接口很有趣；当矩阵没有 a 时，函数通常不起作用`dtype`）：

```
obj_points = obj_points.astype('float32')
img_points = img_points.astype('float32') 
```

然后我再试一次：

```
>>> cv2.calibrateCamera([obj_points], [img_points],size, camera_matrix, dist_coefs)
OpenCV Error: Bad argument 
(For non-planar calibration rigs the initial intrinsic matrix must be specified) 
in cvCalibrateCamera2, file .... 
```

什么？！至少是一个不同的错误。但我*确实*提供了一个初始内在矩阵！

所以我回到文档，并注意`flags`参数：

> flags – 不同的标志，可能为零或以下值的组合：
> 
> `CV_CALIB_USE_INTRINSIC_GUESS`cameraMatrix 包含进一步优化的 fx、fy、cx、cy 的有效初始值
> 
> ...

啊哈，所以我必须*明确*告诉函数使用我提供的初始猜测：

```
cv2.calibrateCamera([obj_points], [img_points],size, camera_matrix.T, dist_coefs,
                    flags=cv2.CALIB_USE_INTRINSIC_GUESS) 
```

欢呼！有用！

（故事的寓意 - 仔细阅读 OpenCV 文档，如果您使用 Python`cv2`接口，请使用最新版本（即在 opencv.itseez.com 上）。此外，请查阅目录中的示例`samples/python2`以补充文档。有了这些两件事你应该能够解决大多数问题。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-11T21:28:07.687

值得一提的是，以下代码片段目前在 2.4.6.1 下工作：

```
 pattern_size = (16, 12)
    pattern_points = np.zeros( (np.prod(pattern_size), 3), np.float32)
    pattern_points[:, :2] = np.indices(pattern_size).T.reshape(-1, 2).astype(np.float32)
    img_points = pattern_points[:, :2] * 2  + np.array([40, 30], np.float32)
    print(cv2.calibrateCamera([pattern_points], [img_points], (400, 400), flags=cv2.CALIB_USE_INTRINSIC_GUESS)) 
```

请注意，不需要 camera_matrix 和 dist_coefs。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T21:32:56.893

在 math.coffee 的帮助下，我可以运行这个 3d 校准。

```
import cv2
from cv2 import cv
import numpy as np

obj_points = [[-9.7,3.0,4.5],[-11.1,0.5,3.1],[-8.5,0.9,2.4],[-5.8,4.4,2.7],[-4.8,1.5,0.2],[-6.7,-1.6,-0.4],[-8.7,-3.3,-0.6],[-4.3,-1.2,-2.4],[-12.4,-2.3,0.9],[-14.1,-3.8,-0.6],[-18.9,2.9,2.9],[-14.6,2.3,4.6],[-16.0,0.8,3.0],[-18.9,-0.1,0.3],[-16.3,-1.7,0.5],[-18.6,-2.7,-2.2]]
img_points = [[993.0,623.0],[942.0,705.0],[1023.0,720.0],[1116.0,645.0],[1136.0,764.0],[1071.0,847.0],[1003.0,885.0],[1142.0,887.0],[886.0,816.0],[827.0,883.0],[710.0,636.0],[837.0,621.0],[789.0,688.0],[699.0,759.0],[768.0,800.0],[697.0,873.0]]

obj_points = np.array(obj_points,'float32')
img_points = np.array(img_points,'float32')

w = 1680
h = 1050
size = (w,h)

camera_matrix = np.zeros((3, 3),'float32')
camera_matrix[0,0]= 2200.0
camera_matrix[1,1]= 2200.0
camera_matrix[2,2]=1.0
camera_matrix[0,2]=750.0
camera_matrix[1,2]=750.0 

dist_coefs = np.zeros(4,'float32')

retval,camera_matrix,dist_coefs,rvecs,tvecs = cv2.calibrateCamera([obj_points],[img_points],size,camera_matrix,dist_coefs,flags=cv.CV_CALIB_USE_INTRINSIC_GUESS) 
```

我现在唯一的问题是为什么从校准函数返回时 dist_coefs 向量的长度为 5 个元素。文档说“如果向量包含四个元素，则意味着 K3=0”。但实际上使用的是 K3，无论 dist_coefs 的长度（4 或 5）。此外，我似乎无法让标志 CV_CALIB_FIX_K3 工作，绑定到使用该标志来强制 K3 为零。现金说整数是必需的。这可能是因为我不知道如何一次做多个标志，我只是这样做，flags = (cv.CV..., cv.CV...)。

```
Just to compare, from the matlab camera cal routine the results are...
    Focal length: 2210\. 2207.
    principal point: 781\. 738.
    Distortions: 4.65e-2 -9.74e+0 3.9e-3 6.74e-3 0.0e+0
    Rotation vector: 2.36 0.178 -0.131
    Translation vector: 16.016 2.527 69.549

From this code,
    Focal length: 1647\. 1629.
    principal point: 761\. 711.
    Distortions: -2.3e-1 2.0e+1 1.4e-2 -9.5e-2 -172e+2
    Rotation vector: 2.357 0.199 -0.193
    Translation vector: 16.511 3.307 48.946 
```

我想如果我能弄清楚如何强制 k3=0，其余的值就会对齐。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-22T11:02:18.353

将 dist_coeffs 向量设为 5 维零向量，然后使用 CV_CALIB_FIX_K3 标志。您可以看到向量 (K3) 中的最后一个元素将为零。

当涉及到使用多个标志时，您可以对它们进行 OR。

示例：cv.CV_CALIB_USE_INTRINSIC_GUESS | cv.CV_CALIB_FIX_K3

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-22T19:03:12.253

使用`Point3f`and`Point2f`而不是`Point3d`and`Point2d`来定义`object_points`and`image_points`并且它会起作用。

# php - AES在php中解密

> ID：10022571
> 
> 赞同：0
> 
> 时间：2012-04-05T04:10:35.057
> 
> 标签：php, encryption, base64, aes, decoding

我是 AES 新手，但我发现有几种模式（ECB、CBC 等），不同的模式需要不同的初始化向量要求、块和编码。我正在尝试解码以下内容

```
Xrb9YtT7cHUdpHYIvEWeJIAbkxWUtCNcjdzOMgyxJzU/vW9xHivdEDFKeszC93B6MMkhctR35e+YkmYI5ejMf5ofNxaiQcZbf3OBBsngfWUZxfvnrE2u1lD5+R6cn88vk4+mwEs3WoAht1CAkjr7P+fRIaCTckWLaF9ZAgo1/rvYA8EGDc+uXgWv9KvYpDDsCd1JStrD96IACN3DNuO28lVOsKrhcEWhDjAx+yh72wM= 
```

使用 php 和（文本）键“043j9fmd38jrr4dnej3FD11111111111”，模式为 CBC，IV 为全零。我可以让它与[这个工具](http://isv.appspot.com/app/enc)一起工作，但不能在 php 中得到它。这是我正在使用的代码：

```
function decrypt_data($data, $iv, $key) {
    $data   = base64_decode($data);
    $cypher = mcrypt_module_open(MCRYPT_RIJNDAEL_256, '', MCRYPT_MODE_CBC, '');

    // initialize encryption handle
    if (mcrypt_generic_init($cypher, $key, $iv) != -1) {
            // decrypt
            $decrypted = mdecrypt_generic($cypher, $data);

            // clean up
            mcrypt_generic_deinit($cypher);
            mcrypt_module_close($cypher);

            return $decrypted;
    }

    return false;
} 
```

我想我可能会遗漏与 base 64 编码或首先将密钥转换为二进制相关的内容。我试过解码很多东西，但我能产生的只是胡言乱语。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T05:43:57.113

好吧，该工具本身并没有说明它是如何加密的。而且您也不能设置 IV，因此很难正确设置参数（因为它们必须相等）。

经过一番猜测，我发现了以下内容：

*   IV 附加在密文前面
*   密文使用 aes-128-cbc 加密

所以你必须修改代码：

```
function decrypt_data($data, $iv, $key) {
    $cypher = mcrypt_module_open(MCRYPT_RIJNDAEL_128, '', MCRYPT_MODE_CBC, '');

    if(is_null($iv)) {
        $ivlen = mcrypt_enc_get_iv_size($cypher);
        $iv = substr($data, 0, $ivlen);
        $data = substr($data, $ivlen);
    }

    // initialize encryption handle
    if (mcrypt_generic_init($cypher, $key, $iv) != -1) {
            // decrypt
            $decrypted = mdecrypt_generic($cypher, $data);

            // clean up
            mcrypt_generic_deinit($cypher);
            mcrypt_module_close($cypher);

            return $decrypted;
    }

    return false;
}

$ctext = "Xrb9YtT7cHUdpHYIvEWeJIAbkxWUtCNcjdzOMgyxJzU/vW9x" .
         "HivdEDFKeszC93B6MMkhctR35e+YkmYI5ejMf5ofNxaiQcZb" .
         "f3OBBsngfWUZxfvnrE2u1lD5+R6cn88vk4+mwEs3WoAht1CA" .
         "kjr7P+fRIaCTckWLaF9ZAgo1/rvYA8EGDc+uXgWv9KvYpDDs" .
         "Cd1JStrD96IACN3DNuO28lVOsKrhcEWhDjAx+yh72wM=";

$key = "043j9fmd38jrr4dnej3FD11111111111";

$res = decrypt_data(base64_decode($ctext), null, $key); 
```

我不确定为什么不使用密钥长度来使用 aes-256-cbc 对其进行加密 - 我已经检查了[as3crypto-library](http://code.google.com/p/as3crypto/)的来源并且它有点支持它，但我必须调试它才能真正验证它。

# c#-4.0 - 需要将图像文件转换回 XY 坐标格式

> ID：10022578
> 
> 赞同：0
> 
> 时间：2012-04-05T04:11:15.693
> 
> 标签：c#-4.0

我正在绘制如下所示的签名并获取 XY 坐标并将其保存到数组列表中。

```
Bitmap bmp;

        //Graphics object 
        Graphics graphics;

        //Pen object
        Pen pen = new Pen(Color.Black);

        // Array List of line segments
        ArrayList pVector = new ArrayList();

        //Point object
        Point lastPoint = new Point(0, 0);

 protected override void OnMouseDown(MouseEventArgs e)
        {
            base.OnMouseDown(e);

            // process if currently drawing signature
            if (!drawSign)
            {
                // start collecting points
                drawSign = true;

                // use current mouse click as the first point
                lastPoint.X = e.X;
                lastPoint.Y = e.Y;
            }

        }

 protected override void OnMouseMove(MouseEventArgs e)
        {
            base.OnMouseMove(e);

            // process if drawing signature
            if (drawSign)
            {
                if (graphics != null)
                {
                    // draw the new segment on the memory bitmap
                    graphics.DrawLine(pen, lastPoint.X, lastPoint.Y, e.X, e.Y);
                    pVector.Add(lastPoint.X + " " + lastPoint.Y + " " + e.X + " " + e.Y);

                    // update the current position
                    lastPoint.X = e.X;
                    lastPoint.Y = e.Y;

                    // display the updated bitmap
                    Invalidate();
                }
            }
        } 
```

使用 arrylist (pVector) 我将值作为字符串 (singature) 和图像保存到数据库中，如下所示

```
//Saving value to Database
ArrayList arrSign = new ArrayList();
                arrSign = this.signatureControl.getPVector();

                string singature = "";

                for (int i = 0; i < arrSign.Count; i++)
                {
                    singature = singature + arrSign[i].ToString() + "*";
                }

 the string singature  wiil be like this 
60 46 59 48*59 48 59 51*59 51 59 53*59 53 60 49*60 49 61 44*61 44 62 38*62 38 64 31*64 31 67 23*67 23 70 14*70 14 72 10*72 10 75 3*75 3 77 -2*77 -2 76 2*76 2 75 6*75 6 72 17*72 17 71 24*71 24 69 31*69 31 68 46*68 46 67 59*67 59 68 71*68 71 69 79*69 79 70 86*70 86 71 89*71 89 71 93*71 93 71 95*71 95 71 97*71 97 70 95*70 95 69 88*69 88 68 81*68 81 69 77*69 77 69 68*69 68 71 60

//Saving as Image file

   Pen pen = new Pen(Color.Black);
                                 string[] arrStr = (signature.Split('*'));

                                 Graphics graphics;
                                 Bitmap bmp = new Bitmap(300, 200);

                                 graphics = Graphics.FromImage(bmp);
                                 graphics.Clear(Color.White);

                                 for (int i = 0; i < arrStr.Length - 2; i++)
                                 {
                                     string[] strArr = new string[4];
                                     strArr = ((arrStr[i].ToString()).Split(' '));
                                     graphics.DrawLine(pen, Convert.ToInt32(strArr[0].ToString()), Convert.ToInt32(strArr[1].ToString()),
                                         Convert.ToInt32(strArr[2].ToString()), Convert.ToInt32(strArr[3].ToString()));
                                 }

                                 string pathToCopyImage = systemBus.TempFile;

                                 bmp.Save(pathToCopyImage + "\\" + dsReportDetails.Tables["tblDelivery"].Rows[0]["PKDelivery"].ToString() + "_Signature.bmp", System.Drawing.Imaging.ImageFormat.Bmp);
                                 bmp.Dispose(); 
```

我的问题是，在将签名另存为图像文件后，我无法将其转换回 arrylist，就像我用来将值保存在数据库中的那个一样。即我需要将图像文件转换回如下格式

```
60 46 59 48*59 48 59 51*59 51 59 53*59 53 60 49*60 49 61 44*61 44 62 38*62 38 64 31*64 31 67 23*67 23 70 14*70 14 72 10*72 10 75 3*75 3 77 -2*77 -2 76 2*76 2 75 6*75 6 72 17*72 17 71 24*71 24 69 31*69 31 68 46*68 46 67 59*67 59 68 71*68 71 69 79*69 79 70 86*70 86 71 89*71 89 71 93*71 93 71 95*71 95 71 97*71 97 70 95*70 95 69 88*69 88 68 81*68 81 69 77*69 77 69 68*69 68 71 60 
```

有人能帮我吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T06:39:17.583

从图像中获取“签名字符串”并不容易，因此您只需将“字符串签名”添加到保存的图像作为图像的元数据标签（例如作为描述）。所以然后你读回你的图像，你不需要从图像中识别“签名字符串”，你可以从元数据中读取它作为字符串。Msdn 有一篇关于图像元数据和使用它们的 api 的好文章。[http://msdn.microsoft.com/en-us/library/ms748873.aspx](http://msdn.microsoft.com/en-us/library/ms748873.aspx)

顺便说一句，您用于连接“签名字符串”的代码很慢并且很消耗内存。在 .Net 中这种情况下最好使用 StringBuilder。并且整体字符串不是存储点列表的最佳数据结构。但这取决于您的应用程序的要求。

# android-emulator - Android 模拟器只显示黑屏和 adb 设备显示“设备离线”

> ID：10022580
> 
> 赞同：223
> 
> 时间：2012-04-05T04:11:19.363
> 
> 标签：android-emulator

我只是想在 Android 中开始开发。所以，问题是当我尝试通过发出命令**emulator @A2**来启动模拟器时，屏幕上会出现一个模拟器。但即使等待了 2-3 小时，它所显示的只是黑屏。甚至没有 android 主屏幕或 android 徽标。只是黑屏。虽然最初“adb devices”将模拟器显示为脱机。2-3 分钟后，附加设备列表变为空白。

我在网上搜索并尝试了那里提到的所有步骤，例如杀死并重新启动 adb，将 java/android 安装在没有空格的目录中，但无济于事。

我的 Jdk 和 Android 安装位于以下文件夹中：

C:\Java32BitInstallation C:\AndroidSdkInstallation 这是我已经下载/安装的东西列表：

1.  Android SDK 工具，修订版 13
2.  Android SDK 平台工具，修订版 10
3.  SDK 平台 Android 4.0.3，API 15，修订版 1
4.  jdk jdk-7u3-windows-i586

在我的**路径**变量中，我添加了 *C:\AndroidSdkInstallation\android-sdk\platform-tools\;C:\AndroidSdkInstallation\android-sdk\tools\;C:\Java32BitInstallation\;C:\Java32BitInstallation\bin*

同样在从网上某处读取后，我添加了 JAVA_HOME 变量，其值为 C:\Java32BitInstallation\ 但仍然没有用。

我的系统上同时安装了 IntelliJ 和 Eclipse。但是因为启动模拟器，我没有使用任何这些，我不怀疑这些有任何犯规。

那么，任何人都可以帮助我解决这些让我发疯的事情。我正在尝试过去 10-12 天，但无法启动模拟器，更不用说编写我的第一个“Hello world”程序了。

附加说明：我的系统是 Windows 7（64 位）机器。早些时候我已经安装了 64 位版本的 jdk，但是那个时候问题也出现了。现在在互联网上搜索后，我卸载了它并安装了 32 位版本的 Java。但是，再次没有用。不过，有一件事，这个 32 位版本的 java (jdk 7 update 3)，首先安装 jre 作为 jdk 安装的一部分，然后安装 jre 7 。所以现在我有 2 个文件夹：C:\Java32BitInstallation 目录中的 jre 和 jre7。这可能与我的模拟器没有出现有关吗？我是否需要指定其他环境变量或修改现有变量？请帮忙。

顺便说一句，我有没有提到 logcat 什么也没显示。

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2012-11-16T15:37:42.720

**25.07.2018 更新：**

最新的 Android Studio 版本不再有这个选项。如果问题仍然存在，请尝试在“[验证配置](https://developer.android.com/studio/run/managing-avds#verifyconfigpage)”对话框（如果可用）中的“模拟性能”下拉列表的值之间切换，或参阅[配置模拟器图形渲染和硬件加速](https://developer.android.com/studio/run/emulator-acceleration)。

**2014 年 2 月 26 日更新：**

[developer.android.com 的配置图形加速](http://developer.android.com/tools/devices/emulator.html#accel-graphics)章节中有两个提示。

> 注意：从 SDK Tools Revision 17 开始，模拟器的图形加速功能是实验性的；使用此功能时请注意不兼容和错误。

和

> 启动 AVD 管理器并创建一个目标值为 Android 4.0.3（API 级别 15），修订版 3 或更高版本的新 AVD。

所以Android 4.0.3（API Level 15）似乎是图形加速的最低要求。

**原始答案**

我对最新的 Android SDK 也有同样的问题。

我只是在虚拟设备的设置中禁用了“使用主机 GPU”复选框，它又开始工作了。

“使用主机 GPU”仅适用于我将 Android 4.2 作为“目标”。

* * *

## 回答 #2

> 赞同：103
> 
> 时间：2017-10-04T09:51:59.527

我最近在模拟器 Nexus 5 (Android O) 中遇到了同样的问题。我已经去 Android 虚拟设备管理器和擦除用户数据，它解决了我的问题。

[![Android 虚拟设备管理器](../Images/7e362866bdf2afa39a4ef22c47a6d522.png)](https://i.stack.imgur.com/wv8TZ.png)

* * *

## 回答 #3

> 赞同：83
> 
> 时间：2014-03-05T22:39:26.883

我在模拟更大的设备（Nexus7 和 10）时遇到了问题，而手机大小的模拟器效果很好。平板电脑只会持续数小时黑屏。真正有帮助的是这里大多数人推荐的相反：在设置“使用主机 GPU”的复选框并将目标设置为最高的 android（在撰写本文时为 4.4.2）之后，7 和 10 可以作为预期的！

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2019-03-23T17:10:04.320

您是否尝试过电源按钮 :) ......它真的对我有用。实际上，模拟器会在关闭之前保存设备状态，因此在上次运行时，如果您关闭设备并关闭模拟器，那么在下一次运行中，它将加载先前的状态并显示已关闭的手机，即黑屏。尽管此问题可能还有许多其他原因。

[![在此处输入图像描述](../Images/e1741c36def62b8f0db356dc1689fafe.png)](https://i.stack.imgur.com/25anm.jpg)

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2014-06-27T17:09:01.793

在启动选项中选中“擦除用户数据”为我修复了它。

转到Android虚拟设备管理器->选择您的设备->开始->检查“擦除用户数据”->启动

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2015-03-03T18:36:10.250

Mac 用户：不幸的是，如果您有一台较旧的 Mac（例如 2009 年末）并且正在使用 Yosemite，则不能将 HAXM 用于 64 位架构。根据 HAXM 的发行说明：

> HAXM 驱动程序不支持在基于 Core 微架构（Core、Core2 Duo 等）的 Intel 系统上模拟 64 位系统映像。支持所有基于 Nehalem 及更高版本的系统。（Corei3、Core i5 和 Core i7 机器）。

当我看到这句话时，我花了一天时间试图解决这个问题。唯一可行的是在您的 AVD 中使用最新操作系统的非 x86 版本（例如 Lollipop Android 5.0.1 armeabi-v7a）

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2018-11-11T08:15:35.250

在**“Android 设备管理器”**中恢复**出厂设置**。

 **在较新版本的 Android Studio 中，这称为“擦除数据”，它位于虚拟设备管理器中设备的右键菜单中。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2020-07-10T01:01:35.117

我是如何解决这个问题的。打开 AVD 管理器，单击下拉箭头：

选择>>擦除数据之后你可以选择>>冷启动..

它对我有用[![在此处输入图像描述](../Images/6d3210a69a3a4c7b6813a6ac5a502c12.png)](https://i.stack.imgur.com/JTJb5.png)

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2015-01-15T15:33:46.870

这是我解决它的方法：我使用以下命令运行模拟器：

```
sudo /home/code/Android/Sdk/tools/emulator -avd Nexus_S_API_21 -netspeed full -netdelay none -debug-init -logcat '*:v' 
```

并在输出中收到以下内容：

```
NAND: could not write file /tmp/android-code/TMP7.tmp, No space left on device. (similar error, could not reproduce it) 
```

所以，我刚刚从 ubuntu 中的 /home 目录中释放了一些磁盘空间（对于 Windows，释放 C: 驱动器空间），然后它顺利启动。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2019-07-15T01:49:24.997

也突然出现了这个问题。Android Studio 占用了 100% 的 CPU，在 expo 中出现以下错误：

```
Couldn't start project on Android: Error running adb: This computer is not authorized to debug the device. Please follow the instructions here to enable USB debugging: https://developer.android.com/studio/run/device.html#developer-device-options. If you are using Genymotion go to Settings -> ADB, select "Use custom Android SDK tools", and point it at your Android SDK directory. 
```

冷启动为我修复了它，就像 boltup_im_coding 的答案一样。如果它已经在运行（黑屏），您也可以通过这种方式冷启动。

[![在此处输入图像描述](../Images/915138790e6dadfb5c35f8443704924c.png)](https://i.stack.imgur.com/f8Uz8.png)

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2018-03-01T05:22:42.730

我将其更改为始终“冷启动”以解决我的问题。在此之前，当我运行它时，`adb devices`它总是显示为`offline`.

[![冷启动截图](../Images/6355246b763ade141f62f352a58cf981.png)](https://i.stack.imgur.com/dDMOc.png)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2013-06-18T07:20:54.480

从它的声音你有一个错误配置的设备。如果你这样做，它将永远不会启动并且永远不会在 Logcat 中显示任何内容。

我建议使用 AVD 管理器中可用的默认“设备定义”之一创建新设备。就像在“设备定义”选项卡中突出显示您想要的设备类型并单击“创建 AVD...”按钮一样简单，然后填写一些详细信息。我首先将“内部存储”调整为 8GB 左右，（也许）调整为 2GB 的“SD 卡”，而其他一切都保持不变。尝试启动设备，如果您在屏幕上看到“Android”弹出，您正在运行。第一次启动通常需要一些时间，所以请稍等并观察 Logcat 是否有任何问题（“DDMS”视角在这里会有所帮助）。

如果您仍然看到带有默认设备定义的黑屏，那么您在其他地方遇到了导致设备失败的问题。如果是这种情况，挖掘日志可能是您唯一的机会。如果没有其他方法，您可以随时尝试重新下载 ADT 并重新安装 SDK。

这里的目标是让您使用（非常）基本的设备启动并运行，所以在这一点上不要为超级令人印象深刻的规格而拍摄，只是为尝试让它运行而拍摄。一旦发生这种情况，请尝试逐个调整设置，直到您将其指定为您喜欢的方式。请记住，模拟器有其局限性，并且无法替代真实设备（尽管它在大多数情况下都可以工作；）

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2014-10-07T13:32:25.170

确保您已安装最新的 HAXM 版本。我在 1.0.1 版本中遇到了同样的黑屏问题，而 1.0.8 版本已经可用。安装程序可以通过 SDK 工具下载，以实际安装您必须执行的模块

> android-sdk-directory\extras\intel\Hardware_Accelerated_Execution_Manager\intelhaxm.exe

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2019-12-14T09:43:46.413

在我的 Nexus 7、Nexus 10 和 Pixel 上也有这个问题，这意味着在所有模拟器中。

经过几天的努力解决这个问题，我终于弄明白了。好吧，上面有很多答案可能对您有用，也可能不适合您，因为它们的配置可能与您的配置略有不同。

我告诉你我的解决方案：

在创建这些模拟器时，我检查了**硬件 - 图形中的 GLES 2.0**以获得更好的性能。对我来说**，这就是问题所在**。

如果你也这样做了，

```
Go to AVD Manager -> Select your emulator -> Click on Edit configuration (in Actions column marked as pencil) -> in Emulated performance - Graphics -> Select Software - GLES 2.0. 
```

然后点击`Show Advanced Settings -> Set none for both Front and Back camera`和`hit Finish`。

现在`select your emulator in AVD Manager and click on Dropdown arrow in Actions column -> select Cold Boot Now`。

是的，你准备好了

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2021-06-27T16:31:34.233

对我有帮助（Windows 10，英特尔）：

1.  在 Windows 中禁用 Hyper-V
2.  卸载 HAXM（控制面板中的“Intel Hardware Accelerated ...”）
3.  重启
4.  使用 android studio 安装 HAXM（设置 -> Android SDK -> SDK 工具 -> Intel x86 Emulator Accelerator (HAXM Installer) -> 安装）
5.  运行模拟器（也可以尝试擦除 VD 数据/冷启动 VD）

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2014-02-21T06:51:49.903

如果您在创建 AVD 时选择了“使用主机 GPU”选项，这是一个已知错误。 [https://code.google.com/p/android/issues/detail?id=28614](https://code.google.com/p/android/issues/detail?id=28614)
取消选中该选项，它应该可以工作！

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2014-06-12T13:45:28.233

只需尝试在“Intel Atom (x86)”上设置 CPU/ABI 并取消激活“使用主机 GPU”复选框。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2017-08-13T11:12:12.707

与模拟器黑窗相关的问题：

安装新窗口时发生。与 windows 图形相关的问题在 windows 的 CD 上。您必须更新 windows 并按照以下步骤操作。

如果 Emulated Performance Graphics 是（软件 GLES 然后选择它到-->Automatic）

或者如果仿真性能图形是（自动然后选择它到-->软件 GLES）

这种交替可以解决这个问题。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2019-04-25T04:51:23.290

以下修复对我有用：

1.  找到 AVD 文件夹`~/.android/avd`
2.  打开`config.ini`
3.  用这些值替换以下设置：

    ```
    hw.gpu.enabled=yes
    hw.gpu.mode=on 
    ```

4.  保存并关闭文件
5.  **不要**在 Android Studio 中打开 AVD 设置屏幕，否则会恢复上述设置
6.  启动模拟器

感谢[Sunsugh Park](http://Sungsuh%20Park)提供[修复](https://stackoverflow.com/questions/10022580/android-emulator-shows-nothing-except-black-screen-and-adb-devices-shows-device#comment98309723_13419712)。

我已经在[Black screen started API 15](https://issuetracker.google.com/issues/131264563)向 Google 报告了这一点。请给问题加注星标，让他们修复它。

### 编辑

实际上，虽然模拟器启动正常，但打开应用程序后它就崩溃了。因此，模拟器团队必须出于某种原因禁用硬件图形。不幸的是，让模拟器工作似乎是不可能的。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2018-07-29T23:37:33.053

我在 API 28 上遇到了同样的问题，修复结果如下；

**为 Android UI 启用 Skia 渲染**

当使用 API 27 或更高版本的图像时，模拟器可以使用 Skia 渲染 Android UI，从而可以更流畅、更高效地渲染。

**要启用 Skia 渲染，请在adb shell**中使用以下命令：

```
su
setprop debug.hwui.renderer skiagl
stop
start 
```

[https://developer.android.com/studio/run/emulator-acceleration#accel-graphics](https://developer.android.com/studio/run/emulator-acceleration#accel-graphics)

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2019-01-29T14:36:37.370

我在我的 Mac 上遇到了这个问题。当您创建设备时，如果您将“图形”从“自动”更改为“软件”，它可以解决问题，或者至少它对我有用。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2012-04-05T04:21:20.780

我也遇到了同样的问题。当我将 Eclipse 从 EE 更改为 Eclipse Classic 时，它运行良好。在 Win 专业 64 位。试试看，它也可能对你有用..

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2014-12-17T09:41:02.333

我也有同样的问题。我发现 HAXM 硬件加速器最近更新了，但没有重新安装，因为更新管理器只是更新了保存到硬盘驱动器的安装程序包。您将需要删除 HAXM，然后运行该安装程序包以完成更新。通常这会安装到 ANDROID-SDK-ROOT\android-sdk\extras\intel\Hardware_Accelerated_Execution_Manager。ANDROID-SDK-ROOT 是你的 android sdk 所在的位置。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2014-05-16T14:50:53.920

如需解决方法，请尝试使用 Intel Atom (x86) 映像的 Android 4.0.3 (API 15)。我可以在启用“使用主机 gpu”和 HAXM 的情况下捕获 DDMS 屏幕截图。只有这种组合对我有用。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2014-05-14T21:55:08.580

我已经成功地通过 Delphi 在 Android 模拟器上启动和调试了一个 Android 测试应用程序。

我有 Windows 7 64 位、4GB RAM、3GHz 双核处理器和 Delphi XE 5。

以下是我为工作中的同事匆忙准备的链接，但我会在第一次机会时将其做得更好：

[使用 Delphi 调试 Android 应用程序](https://web.archive.org/web/20170907044428/http://www.thepdacorner.com:80/delphiXE5_android.html)

请原谅我的英语语言，但我不是以英语为母语的人。我希望你能找到这个小教程

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2015-06-30T21:19:38.480

对我来说，我不得不关闭前后摄像头。希望这可以帮助！

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2019-02-01T16:58:26.777

我使用[Microsoft 使用 Hyper-V 的闪电般快速的 Android](https://docs.microsoft.com/en-us/xamarin/android/get-started/installation/android-emulator/)模拟器，无论我如何设置 GPU 模式（自动、主机、台面、角度、swiftshader、关闭），我创建的每个 Android 模拟器都有相同的黑屏。虽然我的情况显然与 OP 不同，但我认为它可能对那些使用 Microsoft Android 模拟器并在搜索“android 模拟器黑屏”后来到这里的人有用。

就我而言，解决方案是更新所有 Android 工具：

```
 Visual Studio > Tools > Android > Android SDK Manager > Tools 
```

截至今天（2019-02-01），如果您全新安装 Visual Studio 2017，Android 模拟器将出现此黑屏问题。VS 会自动显示 NuGet 包、扩展工具等更新的通知，但不适用于 Android工具更新。您必须手动检查和更新它们。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2019-01-10T12:16:25.133

我有同样的问题。这是我的解决方案（适用于 Mac OS）。我只是将 Android Emulator 的版本降级（从 28.0.3 到 27.3.8）。[这](https://stackoverflow.com/a/49284378/6108739)是一个详细的说明如何做到这一点。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2019-05-23T05:30:01.693

我在win10 64位也遇到了同样的问题。经过大量搜索，我找到了这个解决方案。（如果您使用的是英特尔系统（CPU、GPU、主板等））希望它也对您有用。

**第 1 步：确保在您的设备上启用了虚拟化：**

重新启动计算机，然后按 F2 进行 BIOS 设置。您应该找到虚拟化标签并确保它被标记为已启用。如果未启用，则无法在您的设备上运行任何虚拟设备。

**第 2 步：在您的设备上安装/更新英特尔硬件加速执行管理器（英特尔 HAXM）：**

应安装或更新此软件以运行任何 AVD。您可以通过谷歌搜索“HAXM”下载最新版本。下载后，安装 .exe 文件并重新启动计算机。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2018-10-01T01:58:19.927

另一个错误来源可能是`PATH`系统变量的长度（在 Windows 系统上）。运行具有`PATH`超过 2047 个字符的变量的基于英特尔的图像，似乎将此变量的空值传递给控制台/模拟器，因此它无法正确启动。

这是描述此行为的文章： [https ://software.intel.com/en-us/articles/limitation-to-the-length-of-the-system-path-variable](https://software.intel.com/en-us/articles/limitation-to-the-length-of-the-system-path-variable)

我有同样的问题。通过删除未使用/不存在的路径将这个系统变量的总长度减少到 1354 个字符为我修复了它。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2018-05-15T22:09:59.247

在运行模拟器时出现蓝屏死机后，我遇到了这个问题。这是我的解决方案（至少适用于 Windows）。我的解决方案是完全重新安装 AVD。Android Studio 正常卸载过程的问题在于它不会删除*所有内容*，因此如果您的 AVD 文件已损坏，它们在重新安装时仍将损坏。

为了解决这个问题，我删除了两个目录：

> C:\Users\(我的用户名)\.Android

和

> C:\Users\(我的用户名)\.AndroidStudio3.1

然后我在安装程序中重新运行。

*我认为如果您的模拟器以前可以工作*，这是最简单的解决方案，因为它会强制完全刷新 Android Studio 的 AVD 组件。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2020-11-16T02:44:35.457

也面临这个问题，尝试了大多数答案，没有帮助。最后，以下操作帮助了我：

1.  在 SDK 工具中卸载 HAXM
2.  重新安装 HAXM
3.  重启电脑
4.  擦除 VD 数据
5.  冷启动 VD

不知道对你有没有帮助，仅供参考。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2020-06-15T04:52:53.290

[![.](../Images/4685f45abbe72d8ae1c050fa0a479b89.png)](https://i.stack.imgur.com/R408E.png)

我遇到了同样的问题。通过选择擦除数据对我有用。**

# sbt - 为多模块 SBT 项目中的子模块执行 packageBin 任务

> ID：10022581
> 
> 赞同：1
> 
> 时间：2012-04-05T04:11:19.470
> 
> 标签：sbt

我有一个多模块 SBT 项目。它具有三个模块；核心、连接器和集成。子模块集成取决于核心和连接器。我想为项目集成编写一个自定义任务来打包部署的所有东西。从该任务中，我应该能够创建所有子模块的 jar 文件，并将它们与其他项目依赖项一起放入 lib 文件夹中。我已经设法使用

```
fullClasspath in Runtime 
```

有了这个，我还得到了两个依赖项目（核心、连接器）的编译类文件夹。但我想要的是包含从核心和连接器创建的 jar 文件。

我可以在我的子模块中单独运行 package 命令并从我的自定义任务中复制 jar。但我认为应该有一种方法可以直接从我的自定义任务中创建子模块的 jar 文件。目前我正在创建此自定义任务绑定到使用的集成子模块的 jar 文件

```
packageBin in Compile 
```

我认为应该有一种方法可以从我的自定义任务中在其他模块中执行相同的命令。可以在 SBT 中做到这一点吗？

# javascript - 您可以使用 javascript 获取用户的屏幕尺寸/分辨率吗？

> ID：10022584
> 
> 赞同：8
> 
> 时间：2012-04-05T04:04:09.287
> 
> 标签：javascript

有没有办法使用 javascript 获取用户的屏幕大小/分辨率？我认为您可能无法使用 PHP 来执行此操作，因为它是服务器端的，但由于 javascript 是客户端，我认为它可能是一种选择。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T04:09:24.880

是的，您可以使用以下方法打印出分辨率，例如：

```
<script type="text/javascript">
document.write(screen.width+'x'+screen.height);
</script> 
```

可能不适用于较旧的浏览器，但适用于最新的浏览器。

更多信息在这里：

[http://www.javascriptkit.com/howto/newtech3.shtml](http://www.javascriptkit.com/howto/newtech3.shtml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-29T11:42:12.873

是的，我使用了以下代码并且效果很好。

```
var screenW = 640, screenH = 480;
if (parseInt(navigator.appVersion)>3) {
screenW = screen.width;
screenH = screen.height;
}
else if (navigator.appName == "Netscape" 
&& parseInt(navigator.appVersion)==3
&& navigator.javaEnabled()
) 
 { 
var jToolkit = java.awt.Toolkit.getDefaultToolkit();
var jScreenSize = jToolkit.getScreenSize();
screenW = jScreenSize.width;
screenH = jScreenSize.height;
}

document.write(
"Screen width = "+screenW+"<br>"
+"Screen height = "+screenH
) 
```

礼貌：[http ://www.javascripter.net/faq/screensi.htm](http://www.javascripter.net/faq/screensi.htm)

# iphone - 如何圆角图像

> ID：10022586
> 
> 赞同：2
> 
> 时间：2012-04-05T04:11:43.653
> 
> 标签：iphone, ios

为了使图像变圆角，我正在执行以下操作

```
UIImageView     *myView     =   [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, size.width, size.height)];
[myView setImage:[UIImage imageNamed:@"xcode_57X57"]];
myView.layer.cornerRadius      =   10.0;
myView.layer.borderWidth       =   1.0;
myView.layer.borderColor       =   [UIColor blueColor].CGColor;
myView.layer.shadowRadius      =   8; 
```

但是，我得到的是 myView 的角是圆角的，但图像的角是圆角的。下图显示了我的问题。

如果你之前遇到过这个问题，请给我建议。

![在此处输入图像描述](../Images/8b535ff49a69d66a737367cda1ace188.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T04:15:57.483

您需要剪辑子视图：

```
myView.clipsToBounds = TRUE; 
```

# javascript - 如何根据下拉上下文更改 jQuery 输入掩码掩码？

> ID：10022589
> 
> 赞同：0
> 
> 时间：2012-04-05T04:12:16.960
> 
> 标签：javascript, jquery, html

我目前正在使用[jQuery 输入掩码](https://github.com/RobinHerbots/jquery.inputmask)来实现以下效果： ![在此处输入图像描述](../Images/33f512910ac40139ee3f9c71bca05cb7.png)

对于美国和加拿大的电话号码格式，使用以下内容相当简单：

```
$("#user_phone").inputmask("mask", { "mask": "(999) 999-9999" }); 
```

但是，我想根据“国家代码”下拉列表更改此格式设置上下文，这样当它是英国时，它使用另一个掩码等。我将如何实现这一点，以便掩码将根据下拉列表更改上下文js/jQuery?

这是现在工作源的示例：http: [//jsfiddle.net/j9aNh/1/](http://jsfiddle.net/j9aNh/1/)

更新：好的，我想我现在已经可以令人满意地工作了，并且会感谢任何关于正确干燥它的建议：http: [//jsfiddle.net/j9aNh/3/](http://jsfiddle.net/j9aNh/3/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T06:30:57.717

我不知道这是否是您正在寻找的，但它可能就像我想的那样简单。

```
$('select').change(function() {

var country=$(this).val() //or if you want to get text you may use var country=$(this).text()
 var maskuse;
if(country=='USA')
{
maskuse="(999) 999-9999";

}
if(country=='Canada')
{

maskuse="(999) 999-9999";

}
/// and soon changing mask for a country 

$("#user_phone").inputmask("mask", { "mask": maskuse });

}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-07T19:07:45.100

如果您正在寻找[选择电话号码的输入掩码](http://andr-04.github.io/inputmask-multi/en.html)，请使用[inputmask-multi](https://github.com/andr-04/inputmask-multi)

# jquery - 如何使用 jquery 选择某个列表克隆？

> ID：10022591
> 
> 赞同：0
> 
> 时间：2012-04-05T04:12:28.227
> 
> 标签：jquery

如何使用 jquery 选择列表的某个克隆？

```
 <ul id=testList>
      <li><input type=checkbox" /><p> Test A </p></li>
      <li><input type=checkbox" /><p> Test B </p></li>
      <li><input type=checkbox" /><p> Test C </p></li>
      <li><input type=checkbox" /><p> Test D </p></li>
      <li><input type=checkbox" /><p> Test E </p></li>
 </ul>

     var $cloneList = $("#testList").clone();

     $cloneList.find("li input:checked")each(function()
     {
          alert($(this.outerHTML);
     }); 
```

下面列出了我试图用上面的这个 jquery 代码完成的输出，只需选择已选中的复选框并删除输入标签：

```
 <li><p> Test E </p></li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:23:43.283

为了得到你想要的，代码应该是这样的：

```
$(document).ready(function(){
    $('#clone').click(clone);
});

function clone(){
    clonedList = $('#testList').clone();
    clonedList.find('input[type=checkbox]:not(:checked)').each(function(){
        $(this).parent().remove();
    });
    clonedList.find('input').remove();
    alert(clonedList.html());
} 
```

查看工作小提琴：http: [//jsfiddle.net/Kh476/3/](http://jsfiddle.net/Kh476/3/)

我想指出一件事——那些没有适当标签的复选框让我发疯。改为这样做：

```
<label><input type="checkbox" name="group1" value="A"/> Check This A</label>    ​ 
```

这将允许屏幕阅读器找出哪个文本与哪个复选框一起使用，它还允许人们单击文本，而不必找到要单击的框。更实用。

要获取 outerHtml，请查看以下答案：[获取选定元素的外部 HTML](https://stackoverflow.com/questions/2419749/get-selected-elements-outer-html)

# php - php中的异常，请解释

> ID：10022600
> 
> 赞同：0
> 
> 时间：2012-04-05T04:13:11.097
> 
> 标签：php, try-catch

一般来说，我对编程很陌生，在阅读我看到的 PHP 时，我`try {}`想`catch {}`知道是否有人可以帮助我理解他们的意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:24:50.147

例外的入门级入门：

```
function doSomething($arg1)
{
    if (empty($arg1)) {
        throw new Exception(sprintf('Invalid $arg1: %s', $arg1));
    }

    // Reached this point? Sweet lets do more stuff
    ....
}

try {

    doSomething('foo');

    // Above function did not throw an exception, I can continue with flow execution
    echo 'Hello world';

} catch (Exception $e) {
    error_log($e->getMessage());
}

try {

    doSomething();

    // Above function DID throw an exception (did not pass an argument)
    // so flow execution will skip this
    echo 'No one will never see me, *sad panda*';

} catch (Exception $e) {
    error_log($e->getMessage());
}

// If you make a call to doSomething outside of a try catch, php will throw a fatal
//  error, halting your entire application
doSomething(); 
```

通过在 try/catch 块中放置函数/方法调用，您可以控制应用程序的流程执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T04:14:45.130

PHP 有很好的文档——你应该从那里开始：

[http://php.net/manual/en/language.exceptions.php](http://php.net/manual/en/language.exceptions.php)

# c# - WPF中的可拖动控件？

> ID：10022605
> 
> 赞同：2
> 
> 时间：2012-04-05T04:13:46.550
> 
> 标签：c#, wpf, xaml, drag-and-drop

尽管我在 Forms 方面有一些经验，但我对 WPF 有点陌生，我决定最终尝试弄清楚如何使用 WPF。所以当我开始使用可拖动控件时，这是我想出的代码（我试图将其更改为与 WPF 一起使用，但控件只是到处抽搐）：

```
private void rectangle1_MouseMove(object sender, MouseEventArgs e)
{
    if (e.LeftButton == MouseButtonState.Pressed) {
        double x = this.Left + (double)e.GetPosition(this).X - (double)rectangle1.Margin.Left;
        double y = this.Top + (double)e.GetPosition(this).Y - (double)rectangle1.Margin.Top;
        rectangle1.Margin = new Thickness(x, y, rectangle1.Margin.Right, rectangle1.Margin.Bottom);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T04:16:04.957

您想使用[装饰器](http://msdn.microsoft.com/en-us/library/ms743737.aspx)来实现拖动、调整大小、旋转等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T04:36:40.430

[这](https://docs.microsoft.com/en-us/dotnet/framework/wpf/advanced/drag-and-drop-overview)是 MSDN 上关于此事的一篇相当不错的文章。此外，在 Google 上进行快速搜索会发现一个名副其实的聚宝盆，为您带来 DnD 用餐乐趣。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-05-26T09:07:42.467

选择：

1.  安装 NuGet 包：`Microsoft.Xaml.Behaviors.Wpf`
2.  将此添加到根元素：

```
xmlns:behaviors="http://schemas.microsoft.com/xaml/behaviors" 
```

3.  只需将其放在您的元素中：

```
<Grid>
    <behaviors:Interaction.Behaviors>
        <behaviors:MouseDragElementBehavior ConstrainToParentBounds="True"/>
    </behaviors:Interaction.Behaviors>
</Grid> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T04:35:19.697

如果您想手动操作，请使用以下算法：

1.  `MouseDown`事件发生时：保存*鼠标位置*、控件的TopLeft *位置*和这些坐标的 delta(offset)，并设置一些布尔字段标志，例如。`IsDragStartted`为真。
2.  `MouseMove`检查拖动是否开始并使用*鼠标位置*和偏移量来计算控件的TopLeft*位置*的新值

3.  事件`MouseUp`设置`IsDragStartted`为假

# php - PHP $_SESSION 未定义的偏移量

> ID：10022606
> 
> 赞同：0
> 
> 时间：2012-04-05T04:14:06.567
> 
> 标签：php, session, undefined, offset, cart

例如，当我执行以下代码时：cart.php?p=1&action=add

```
<?php
session_start();

if (isset($_GET['p']) && isset($_GET['action'])) {
$p_id = (int)$_GET['p'];
$action = $_GET['action'];

switch($action) {

    case "add":
        $_SESSION['cart'][$p_id]++;
        echo $_SESSION['cart'][$p_id];//for debug
    break;

    case "remove":
        $_SESSION['cart'][$p_id]--;
        echo $_SESSION['cart'][$p_id];
        if($_SESSION['cart'][$p_id] == 0) unset($_SESSION['cart'][$p_id]);
    break;

    case "empty":
        unset($_SESSION['cart']);
    break;
}
}
?> 
```

我收到以下错误：

```
Notice: Undefined offset: 1 in cart.php on line 11 
```

如何正确配置 PHP $_SESSION？我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T04:17:36.223

改变这个：

```
$_SESSION['cart'][$p_id]++ 
```

至：

```
$_SESSION['cart'][$p_id] = 1 + (isset($_SESSION['cart'][$p_id]) ? $_SESSION['cart'][$p_id] : 0); 
```

这样您就不会尝试增加数组中不存在的元素。

# php - PHP Exec 带参数和 mysql 插入

> ID：10022607
> 
> 赞同：0
> 
> 时间：2012-04-05T04:14:11.887
> 
> 标签：php, exec

我正在尝试使用带有参数的 php exec 运行 mysql 插入查询。

执行代码：

```
exec("php exec.php $parameter1 >1.log &"); // I have a 1.log with 777 
```

在 Exec.php 中：

```
include $_SERVER['DOCUMENT_ROOT']."/functions/connection.php";

if($_REQUEST['parameter1']!="")
   $proxy_id=$_REQUEST['parameter1'];
else
   $proxy_id= $argv[1];

mysql_query("INSERT INTO proxy_log(proxy_id,last_used_time) VALUES($proxy_id,NOW())"); 
```

但是当我运行它时什么都没有发生。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:33:42.677

该变量`$_SERVER['DOCUMENT_ROOT']`在 CLI 模式下不可用。使用绝对路径。

```
include "/your/absolute/path/functions/connection.php"; 
```

`$_REQUEST`也不可用，您的 if 语句将始终放在 else 部分。

# ajax - 在 Jquery Get (AJAX) 期间避免缓存的有效方法

> ID：10022608
> 
> 赞同：0
> 
> 时间：2012-04-05T04:14:19.113
> 
> 标签：ajax, asp.net-mvc, caching, jquery

我正在经历通过 Jquery 的 get 创建的 Ajax 请求缓存的随机事件。

Jquery 以最直接的传统方式完成（路由 + 参数 + 回调）

我已经在使用

```
$.ajaxSetup({cache:false}); 
```

但它似乎并不总是有效。我知道 ajaxSetup no cache 是如何工作的，我看到添加的随机参数被添加到我的请求 url。

我目前的浏览器是 IE 8.0

有谁知道除了 ajaxSetup 方式之外的另一种解决方案......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:29:44.830

浏览器本身根本不允许/不能缓存具有不同参数的请求，如`{cache:false}`.

听起来缓存正在您链中的其他地方发生，可能在您的 Web 服务器/应用程序中。使用 firebug 的 net 选项卡准确检查浏览器请求的内容以及 URL 的确切内容，然后从那里获取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:51:44.090

事实证明，我对缓存 ajax 请求的假设是错误的。真正的问题是缓存后续重定向到发生在服务器上的操作请求（响应原始 ajax 调用）。解决方案最终成为以下属性。

```
[OutputCache(Location = OutputCacheLocation.None)] 
```

它可以应用于控制器级别或操作级别。

# android - 按下“关闭”后不要让应用程序再次启动

> ID：10022614
> 
> 赞同：1
> 
> 时间：2012-04-05T04:15:24.820
> 
> 标签：android, eclipse, android-activity

我正在使用以下代码在活动之间切换：

```
Intent b = new Intent(nowActivity.this, About.class);
startActivity(b);
return true; 
```

这段代码运行良好，但它似乎使它在现有活动之上开始了一个新活动。

**示例**：我在我的 Android 手机上启动应用程序并按下菜单按钮以在屏幕上显示选项菜单。然后我点击“关于”进入应用程序的关于页面。如果我然后按菜单中的“关闭”选项，第一页（应用程序的主屏幕）将在屏幕上可见，一切都回到方块 1，就像我再次打开应用程序一样。

我不希望它像这样，我现在问你，我该如何解决这个问题？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:43:57.427

我让它工作了！这是解决方案：

**nowActivity.java**

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    // Handle item selection
    switch (item.getItemId()) {
    case R.id.menuItem1:
        Toast.makeText(this, "Du är redan på startsidan", Toast.LENGTH_SHORT).show();
        return false;

    case R.id.menuItem2:
        Intent b = new Intent(nowActivity.this, About.class);
        b.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(b);
        return true;

    case R.id.menuItem3:
        android.os.Process.killProcess(android.os.Process.myPid());
        return true;

    default:
        return super.onOptionsItemSelected(item);
    }
} 
```

**关于.java**

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case R.id.menuItem1:
        Intent a = new Intent(About.this, nowActivity.class);
        a.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(a);
        return true;

    case R.id.menuItem2:
        Toast.makeText(this, "Du är redan på \"Om\"-sidan", Toast.LENGTH_SHORT).show();
        return false;

    case R.id.menuItem3:
        Intent intent = new Intent(Intent.ACTION_MAIN);
        intent.addCategory(Intent.CATEGORY_HOME);
        startActivity(intent);
        System.exit(0);
        return true;

    default:
        return super.onOptionsItemSelected(item);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:20:30.567

编辑您的代码：调用 finish() 以销毁第一个活动

```
Intent b = new Intent(nowActivity.this, About.class);
startActivity(b);
finish();
return true; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T04:28:45.203

当用户单击您的“关闭”按钮时返回主屏幕怎么样？

以下代码摘自： [How to return to home screen from Activity](https://stackoverflow.com/questions/5900276/how-to-return-to-home-screen-from-activity)

```
Intent intent = new Intent(Intent.ACTION_MAIN);
intent.addCategory(Intent.CATEGORY_HOME);
startActivity(intent); 
```

# c# - 如何使用 XNA 删除 XBOX 上的“请重新连接控制器”对话框？

> ID：10022616
> 
> 赞同：2
> 
> 时间：2012-04-05T04:15:31.177
> 
> 标签：c#, xna, xbox360

在我的 XNA 游戏中，如果玩家断开控制器 #1，会出现一个对话框，显示“请重新连接控制器”。如果他们开始使用控制器 2，他们可以继续播放，我想在这种情况下以编程方式关闭对话框。我在网上搜索和翻阅 XNA 文档时一无所获……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:41:23.827

不幸的是，该消息内置于 Xbox 360 固件中，因此无法从 XNA 框架中控制或消除它。

由于配置文件与 Xbox 360 上的控制器相关联，因此当游戏运行并且控制器与仍登录的配置文件断开连接时，该消息将始终出现。您应该能够通过使用另一个控制器签署配置文件来验证这一点，然后断开该控制器。

您可能想在 XNA 论坛上查看[此线程](http://forums.create.msdn.com/forums/p/33750/334130.aspx)，以获取有关您的游戏如何响应控制器断开连接的更多信息。

[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/bb203901%28v=xnagamestudio.40%29.aspx)还提供了一些有关处理控制器断开连接的信息。

# gwt - GWT：调试事件捕获/冒泡

> ID：10022617
> 
> 赞同：2
> 
> 时间：2012-04-05T04:15:38.203
> 
> 标签：gwt, smartgwt

我想知道是否有一种方法可以逐步调试已编译的 GWT 代码，以确定某些事件是如何被触发的。

我对此感兴趣的是我正在使用 SmartGWT，并且由于某种原因，它们组件上的单击事件会传播到占据相同位置的弹出窗口。但是，这只发生在 Mobile Safari 中。

更有趣的是，它只发生在 smartGWT 版本的 onClick 上，而不是普通的 GWT onClick。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T10:09:23.840

现在主要是 hack，但我想它会起作用（尽管你必须重新编译你的应用程序）：

1.  首先，从主干编译一个最近的 GWT：[https ://developers.google.com/web-toolkit/makinggwtbetter#workingoncode](https://developers.google.com/web-toolkit/makinggwtbetter#workingoncode)
2.  然后在启用源映射的情况下重新编译您的应用程序：[http ://code.google.com/p/google-web-toolkit/wiki/SourceMaps](http://code.google.com/p/google-web-toolkit/wiki/SourceMaps)
3.  按照此 wiki 页面评论中的步骤，以便能够在 Chrome 中使用 SourceMaps，然后重新部署您的应用程序
4.  在 Dev 频道上获取 Chrome：http: [//www.chromium.org/getting-involved/dev-channel](http://www.chromium.org/getting-involved/dev-channel)
5.  使用[http://www.iwebinspector.com/](http://www.iwebinspector.com/)启动 Mobile Safari 并进行远程调试，然后从 Chrome 桌面连接到它：[http ://www.webkit.org/blog/1620/webkit-remote-debugging/](http://www.webkit.org/blog/1620/webkit-remote-debugging/)
6.  最后，在 Chrome 中启用源映射，这样您就可以在 Web Inspector 中看到您的*Java代码！*

请参阅[http://www.youtube.com/watch?v=-xJl22Kvgjg预览使用 GWT 进行调试的未来，这将在](http://www.youtube.com/watch?v=-xJl22Kvgjg)*不久的将来以一种不那么**骇人听闻*的方式实现这种事情。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T06:14:37.073

我不知道是否有调试编译的**javascript** GWT 代码的好方法，但为什么需要它呢？

出于描述的目的，最好使用带有调试选项的 GWT 开发模式。您可以将以下参数添加`e-Xdebug -Xrunjdwp:transport=dt_socket,address={PORT},server=y,suspend=n`到开发模式运行命令中，它会给客户端 GWT/SmardGWT 源代码添加断点的机会。然后为了调试，你应该从你的 java IDE 连接到参数中指定的端口。

调试 GWT [https://developers.google.com/web-toolkit/doc/latest/DevGuideCompilingAndDebugging](https://developers.google.com/web-toolkit/doc/latest/DevGuideCompilingAndDebugging)*

# c# - 客户端应用程序更新

> ID：10022618
> 
> 赞同：3
> 
> 时间：2012-04-05T04:15:42.640
> 
> 标签：c#, .net, wpf, wcf

我正在使用 .Net、C#、WCF、WPF 开发客户端-服务器应用程序。现在我需要实现客户端应用程序更新过程（客户端 dll）。有人可以为此提出一些好的模式吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T04:19:48.413

[Click-Once](http://msdn.microsoft.com/en-us/library/t71a733d%28v=vs.100%29.aspx)使更新客户端计算机上的应用程序相对轻松。

*   [https://stackoverflow.com/questions/1635103/how-to-basic-tutorial-to-write-a-clickonce-app](https://stackoverflow.com/questions/1635103/how-to-basic-tutorial-to-write-a-clickonce-app)

*   [指导](http://weblogs.asp.net/shahar/archive/2008/01/29/how-to-use-clickonce-to-deploy-your-applications.aspx)

*   [教程](http://www.codeguru.com/csharp/.net/article.php/c19523/ClickOnce-Deployment-in-NET-Framework-20.htm)

*   [登录](http://msdn.microsoft.com/en-us/library/ms227123(v=VS.80).aspx)

# jpa-2.0 - 在事务中两次包含一个实体有什么害处吗？

> ID：10022621
> 
> 赞同：0
> 
> 时间：2012-04-05T04:16:02.447
> 
> 标签：jpa-2.0, eclipselink

我目前正在编写一个棘手的更新任务，其中单个实体对象可能会在原子事务中多次更新。我的合并操作看起来像这样（为了清楚起见，省略了**try** / **catch**）：

```
@PersistenceContext protected EntityManager   em;
@Resource           protected UserTransaction utx;    
...
utx.begin();
for (Record r : listOfRecords) em.merge(r);
utx.commit(); 
```

如果列表中有多个对给定实体的引用，会发生什么不好的事情吗？

这与 EclipseLink 2.3.2 作为 JPA 提供者有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:54:59.223

**持久性上下文：**持久性上下文是一组托管实体实例，其中对于任何持久性实体身份，都有一个唯一的实体实例。在持久化上下文中，实体实例及其生命周期由实体管理器管理。

**merge() ：**将给定实体的状态合并到当前持久化上下文中。

因此，在持久上下文中一次只存在一个实体实例。因此，即使您多次更新实体，它也只会在事务提交时反映到数据库中一次。

# java - 使用 Scanner 的 compareTo 和 Strings

> ID：10022635
> 
> 赞同：1
> 
> 时间：2012-04-05T04:18:08.130
> 
> 标签：java, string, java.util.scanner, comparable

我正在实现一种左派最小堆形式，它按长度存储任意单词。所以，我为 Scanner 编写了一个包装类，并更改了 compareTo，就像这样

```
public class ScannerWrapper implements Comparable<String>

//a Scanner, sc and a String, current
public int compareTo(String str){
    if(current.length() > str.length()) return -1;
    if(current.length() > str.length()) return 1;
    else return 0;
} 
```

其中 current = sc.next() 而不是 \n 字符。

在这种情况下，如果我有 ScannerWrapper.next() > foo ，其中 foo 是任意长度的字符串 > ScannerWrapper.next();
它会使用我写的 compareTo(String)，返回 false，还是会做一些其他随机的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:49:22.443

很难理解你的问题 - 所以你可能会考虑改写它。这是在黑暗中拍摄的：

```
 public class ScannerWrapper implements Comparable<ScannerWrapper>

    //your wrapper has a handle to the scanned data.   Presumably it's
    //initialized on construction, which is omitted here
    private final String scannedData;        

    public String getScannedData() { 
        return this.scannedData;
    }

    public int compareTo(ScannerWrapper other) {
        //if this scannedData is longer than the other, return 1
        if(this.str.length() > other.getStr().length()) {
            return 1;
        } else if(this.scannedData.length() < other.getScannedData().length()) {
        //if the other scannedData is longer return -1   
            return -1;
        }
        //if they are equal return 0
        return 0;
    }

 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:37:04.837

多次阅读您的问题后，我想我明白您现在在问什么。如果您尝试`ScannerWrapper`使用比较运算符比较类的两个实例，那么不，它不会起作用。

您不能在 Java 中重载运算符（您可以在 C++ 中），因此为了比较`ScannerWrapper`彼此的实例，您将不得不调用该`compareTo()`方法。

此外，您的两个`if`语句条件都是相同的，因此您可能需要修复它。

# wcf - WF4.0 哪个架构更好？

> ID：10022636
> 
> 赞同：0
> 
> 时间：2012-04-05T04:18:11.987
> 
> 标签：wcf, workflow-foundation-4

我们的团队将为日志运行流程设计一个工作流解决方案。我们必须为工作流维护持久性、跟踪和版本控制。工作流服务器需要执行多个工作流。我们正在使用 wf4.0。我们正在为工作流服务器寻找最佳架构。以下几点是我们心中的考虑。

1.  WCF 和 wf 之间的集成以及存储在数据库中的工作流。在这种方法中，客户端调用 wcf 服务，该服务从数据库加载工作流 xaml 文件，并使用加载的工作流创建 WorkflowApplication 对象并执行此操作。在这种方法中，只有一个端点与 wcf 服务一起公开。现在 wcf 服务负责使用工作流应用程序类启动工作流。

2.  工作流服务与 wcf 的内置集成。在其中使用消息活动开发工作流并使用工作流服务主机托管，客户端直接通过其端点调用。

现在我必须从其中一种方法中选择一种方法。请建议我选择一种或任何其他最适合日志运行工作流的方法，该工作流还保持持久性、跟踪和版本控制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T06:57:36.923

使用 WCF 集成公开工作流是迄今为止最简单的方法。您可以自己管理一切，但在大多数情况下，您所做的只是复制已经为您编写的代码。如果您喜欢挑战并按小时计酬，但如果您想完成任务，则内置解决方案的生产力要高得多。

# php - 使用 PHP shell_exec() 分离终端会话时遇到问题

> ID：10022642
> 
> 赞同：1
> 
> 时间：2012-04-05T04:19:43.973
> 
> 标签：php, shell-exec, nohup

我维护一个游戏服务器，不守规矩的玩家经常让应用程序崩溃。我的审核团队需要能够重新启动服务器进程，但允许 ssh 访问将是不切实际/不安全的，因此我使用 shell exec 传递所需的命令以从基于 Web 的界面重新启动服务器进程。问题是，shell 会话没有正确分离，因此 php 保持其会话，直到它最终超时并关闭会话/停止服务器进程。这是我调用 shell_exec 的方式： $command='nohup java -jar foobar_server.jar'; shell_exec($command);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:28:16.867

shell_exec 将等到您执行的命令返回（例如返回到shell 提示符）。如果您想将其作为后台任务运行，那么 shellL_exec 立即返回，然后执行

```
$command='nohup java -jar foobar_server.jar &'; 
                                            ^--- run in background 
```

当然，这假设您在 unix/linux 主机上执行此操作。对于 Windows，它会有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T08:33:31.117

如果你尝试这个，你会发现它不起作用。要在 PHP 中完全分离，您还必须进行标准输出重定向，否则即使使用 '&'，shell_exec 也会挂起。

这是你真正想要的：

```
shell_exec('java -jar foobar_server.jar >/dev/null 2>&1 &'); 
```

但为了更进一步，我将摆脱 Web 界面，并将其设为一分钟间隔的 cronjob，它首先检查进程是否正在运行，以及它是否没有启动新实例：

```
#!/bin/bash
if ! pidof foobar_server.jar; then
    java -jar foobar_server.jar >/tmp/foobar_server.log 2>&1 &;
fi 
```

并且让它每分钟运行一次，如果它找到一个正在运行的进程，它什么也不做，否则它会启动一个新实例。服务器崩溃后的最坏情况是停机 59 秒。

干杯

# php - 创建扩展另一个 PHP 扩展的 PHP 扩展？

> ID：10022651
> 
> 赞同：2
> 
> 时间：2012-04-05T04:20:54.947
> 
> 标签：php, memcached

我在 Internet 上搜索了几个关于如何创建 PHP 扩展的文档，但不幸的是，没有任何关于链接到另一个扩展的内容（并且要求在创建新扩展之前加载该扩展）。

我想我可以简单地将必要的头文件#include 到我的源代码中，但不确定链接。

作为一个例子，为了玩扩展创建，我想创建的第一个解决方案是我实现的一个解决方案，它允许在 memcached [github](https://github.com/StormBytePP/NSSMemcache)中使用命名空间，但想知道如何将我的自定义扩展中的其他扩展代码用于其他用途。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T22:44:01.377

我不知道如何用 StormByte 回复线程，但听起来你需要做一些负载平衡或缓存，而不是扩展 PHP。

如果您真的想在代码级别执行此操作，可以使用`exec()`调用 Python 脚本，[该脚本会自动编译为字节码](http://effbot.org/zone/python-compile.htm)。

# c#-4.0 - 如何在 Silverlight 中自定义 DataGrid 标头？

> ID：10022652
> 
> 赞同：1
> 
> 时间：2012-04-05T04:20:57.500
> 
> 标签：c#-4.0, silverlight-4.0, datagrid

我刚刚开始学习 Silverlight 和它的控件。我很确定我们可以像 JQuery 和 Flex 等其他技术一样使用 silverlight 为数据网格创建这种标题。但我不知道该怎么做。有人可以建议一些示例或网站，我可以在其中学习自定义这样的标题吗？

```
 _______________________________________________________
   |       Name          |   Age     |        Marks      |
   |_____________________|           |___________________|
   |First Name| Last Name|           |Sub1 | Sub2  |Sub3 |
   |_____________________|___________|___________________| 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T05:02:21.363

在 Xaml 中尝试此代码：

```
 <UserControl  x:Class="SilverlightApplication16.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk"
    xmlns:dataprimitives="clr-namespace:System.Windows.Controls.Primitives;assembly=System.Windows.Controls.Data"

mc:Ignorable="d"
d:DesignHeight="300" d:DesignWidth="400">
<UserControl.Resources>
    <Style x:Key="DataGridBaseHeaderStyle"    
           TargetType="dataprimitives:DataGridColumnHeader">
        <Setter Property="FontWeight" Value="Bold" />
    </Style>
    <Style x:Key="NameHeaderStyle"   TargetType="dataprimitives:DataGridColumnHeader"     
           BasedOn="{StaticResource DataGridBaseHeaderStyle}">
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="HorizontalContentAlignment" Value="Left"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="SeparatorBrush" Value="#FFC9CACA"/>
        <Setter Property="Padding" Value="8"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Grid x:Name="Root">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Rectangle x:Name="BackgroundRectangle" Fill="#FF1F3B53" Stretch="Fill" Grid.ColumnSpan="2"/>
                        <Rectangle x:Name="BackgroundGradient" Stretch="Fill" Grid.ColumnSpan="2">
                            <Rectangle.Fill>
                                <LinearGradientBrush EndPoint=".7,1" StartPoint=".7,0">
                                    <GradientStop Color="#FCFFFFFF" Offset="0.015"/>
                                    <GradientStop Color="#F7FFFFFF" Offset="0.375"/>
                                    <GradientStop Color="#E5FFFFFF" Offset="0.6"/>
                                    <GradientStop Color="#D1FFFFFF" Offset="1"/>
                                </LinearGradientBrush>
                            </Rectangle.Fill>
                        </Rectangle>
                        <Grid HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"                        VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="20" />
                                <RowDefinition Height="1" />
                                <RowDefinition Height="20" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="1" />
                                <ColumnDefinition Width="100"/>
                            </Grid.ColumnDefinitions>
                            <!-- Row 0 -->
                            <ContentPresenter Content="Name"                                       
                                              VerticalAlignment="Center" HorizontalAlignment="Center"                                        Grid.ColumnSpan="3" />
                            <!-- Row 1 -->
                            <Rectangle Fill="#FFC9CACA" VerticalAlignment="Stretch" Height="1"                                 Visibility="Visible" Grid.Row="1" Grid.ColumnSpan="3" />
                            <!-- Row 2 -->
                            <ContentPresenter Content="First Name " Grid.Row="2" VerticalAlignment="Center"                                        HorizontalAlignment="Center" />
                            <Rectangle Fill="#FFC9CACA" VerticalAlignment="Stretch" Width="1"                                  Visibility="Visible" Grid.Row="2" Grid.Column="1" />
                            <ContentPresenter Content="Last Name" Grid.Row="2" Grid.Column="2"                                        VerticalAlignment="Center" HorizontalAlignment="Center" />
                        </Grid>
                        <Rectangle x:Name="VerticalSeparator" Fill="#FFC9CACA"                           
                                   VerticalAlignment="Stretch" Width="1" Visibility="Visible"               
                                   Grid.Row="1" Grid.Column="1"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="MarkHeaderStyle"   TargetType="dataprimitives:DataGridColumnHeader"     BasedOn="{StaticResource DataGridBaseHeaderStyle}">
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="HorizontalContentAlignment" Value="Left"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="SeparatorBrush" Value="#FFC9CACA"/>
        <Setter Property="Padding" Value="8"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Grid x:Name="Root">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Rectangle x:Name="BackgroundRectangle" Fill="#FF1F3B53" Stretch="Fill" Grid.ColumnSpan="2"/>
                        <Rectangle x:Name="BackgroundGradient" Stretch="Fill" Grid.ColumnSpan="2">
                            <Rectangle.Fill>
                                <LinearGradientBrush EndPoint=".7,1" StartPoint=".7,0">
                                    <GradientStop Color="#FCFFFFFF" Offset="0.015"/>
                                    <GradientStop Color="#F7FFFFFF" Offset="0.375"/>
                                    <GradientStop Color="#E5FFFFFF" Offset="0.6"/>
                                    <GradientStop Color="#D1FFFFFF" Offset="1"/>
                                </LinearGradientBrush>
                            </Rectangle.Fill>
                        </Rectangle>
                        <Grid HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"                        VerticalAlignment="{TemplateBinding VerticalContentAlignment}" >
                            <Grid.RowDefinitions>
                                <RowDefinition Height="20" />
                                <RowDefinition Height="1" />
                                <RowDefinition Height="20" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="1" />
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="1" />
                                <ColumnDefinition Width="100"/>
                            </Grid.ColumnDefinitions>
                            <!-- Row 0 -->
                            <ContentPresenter Content="Marks"                                        VerticalAlignment="Center" HorizontalAlignment="Center"                                        Grid.ColumnSpan="6" />
                            <!-- Row 1 -->
                            <Rectangle Fill="#FFC9CACA" VerticalAlignment="Stretch" Height="1"                                 Visibility="Visible" Grid.Row="1" Grid.ColumnSpan="5" />
                            <!-- Row 2 -->
                            <ContentPresenter Content="Sub1" Grid.Row="2" VerticalAlignment="Center"                                        HorizontalAlignment="Center" />
                            <Rectangle Fill="#FFC9CACA" VerticalAlignment="Stretch" Width="1"                                  Visibility="Visible" Grid.Row="2" Grid.Column="1" />
                            <ContentPresenter Content="Sub2" Grid.Row="2" Grid.Column="2"                                        VerticalAlignment="Center" HorizontalAlignment="Center" />
                            <Rectangle Fill="#FFC9CACA" VerticalAlignment="Stretch" Width="1"                                  Visibility="Visible" Grid.Row="2" Grid.Column="3" />
                            <ContentPresenter Content="Sub3" Grid.Row="2" Grid.Column="4"                                        VerticalAlignment="Center" HorizontalAlignment="Center" />
                        </Grid>
                        <Rectangle x:Name="VerticalSeparator" Fill="#FFC9CACA"                            
                                   VerticalAlignment="Stretch" Width="1" Visibility="Visible"                      
                                   Grid.Row="1" Grid.Column="1"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</UserControl.Resources>
<Grid x:Name="LayoutRoot" Background="White">
    <sdk:DataGrid AutoGenerateColumns="False" Height="100" HorizontalAlignment="Left" Margin="12,101,0,0" Name="dataGrid1" VerticalAlignment="Top" Width="598">
        <sdk:DataGrid.Columns>
            <sdk:DataGridTemplateColumn Header="Tue" HeaderStyle="{StaticResource NameHeaderStyle}">
                <sdk:DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBox Text="{Binding FistName}"/>
                            <Rectangle Fill="#FFC9CACA" VerticalAlignment="Stretch" Width="1" />
                            <TextBox Text="{Binding LastName}" Margin="2,0,0,0"/>
                        </StackPanel>
                    </DataTemplate>
                </sdk:DataGridTemplateColumn.CellTemplate>
            </sdk:DataGridTemplateColumn>
            <sdk:DataGridTemplateColumn   HeaderStyle="{StaticResource DataGridBaseHeaderStyle}" CanUserReorder="True" Header="Age" CanUserResize="True" CanUserSort="True" Width="Auto" />
            <sdk:DataGridTemplateColumn Header="Tue" HeaderStyle="{StaticResource MarkHeaderStyle}">
                <sdk:DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBox Text="{Binding Subject1}"/>
                            <Rectangle Fill="#FFC9CACA" VerticalAlignment="Stretch" Width="1" />
                            <TextBox Text="{Binding Subject2}" Margin="2,0,0,0"/>
                            <Rectangle Fill="#FFC9CACA" VerticalAlignment="Stretch" Width="1" />
                            <TextBox Text="{Binding Subject3}" Margin="2,0,0,0"/>
                        </StackPanel>
                    </DataTemplate>
                </sdk:DataGridTemplateColumn.CellTemplate>
            </sdk:DataGridTemplateColumn>
        </sdk:DataGrid.Columns>
    </sdk:DataGrid>
</Grid> 
```

# c++ - 在 Google Test 中取消注册测试用例

> ID：10022655
> 
> 赞同：2
> 
> 时间：2012-04-05T04:21:46.870
> 
> 标签：c++, googletest

Google Test 框架会自动注册测试。

我们正在加载一个包含测试的 dll（它注册测试），卸载 dll，然后调用“RunAllTests”。

由 TEST() 宏实例化的静态测试类对象在调用其析构函数时不会取消注册（因为 dll 卸载）。

最终结果是卸载的 dll 中的测试仍然被注册，因此 RunAllTests 尝试访问无效内存。

有没有解决的办法？

# c# - 将数据网格导出到 Excel 时出错

> ID：10022656
> 
> 赞同：0
> 
> 时间：2012-04-05T04:22:01.783
> 
> 标签：c#, asp.net, export-to-excel

我正在尝试将数据网格导出到 Excel。使用代码。

```
 Response.Clear();
                    Response.AddHeader("content-disposition", "attachment;filename=Salary_JV_Posting_For_PG_.xls");
                    Response.Charset = "";
                    Response.ContentType = "application/vnd.xls";
                    System.IO.StringWriter stringWrite = new System.IO.StringWriter();
                    stringWrite.Write("&nbsp;&nbsp;<b><font color=#336699 size = 25px><u>test</u></font></b> ");
                    stringWrite.Write(Environment.NewLine);
                    stringWrite.Write(Environment.NewLine);
                    System.Web.UI.HtmlTextWriter htmlWrite = new HtmlTextWriter(stringWrite);
                    Response.Flush();
                    dgLine.RenderControl(htmlWrite);
                    Response.Write(stringWrite.ToString());
                    Response.End(); 
```

我尝试调试，但是当执行最后一行（response.end）时出现以下错误

```
Data = Unable to evaluate expression because the code is optimized or a native frame is on top of the call stack. 
```

我正在使用 AJAX。

问候库马尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:42:49.337

`Response.End()`绝对会停止页面生命周期的执行。

也许你可以试试`HttpContext.Current.ApplicationInstance.CompleteRequest();`

而不是它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T07:09:29.580

试试这个朋友

```
 Public Sub ExportGridToExcel(ByVal GridView1 As DataGrid, ByVal fileName As String)
        Response.Clear()
        Response.AddHeader("content-disposition", String.Format("attachment;filename={0}.xls", fileName))
        Response.Charset = ""
        Response.ContentType = "application/vnd.xls"
        Dim stringWrite As New StringWriter()
        Dim htmlWrite As New HtmlTextWriter(stringWrite)
        GridView1.RenderControl(htmlWrite)
        Response.Write(stringWrite.ToString())
        Response.Flush()
        Response.[End]()
    End Sub 
```

并像这里一样在按钮上调用它

```
Protected Sub ImageButton1_Click(ByVal sender As Object, ByVal e As System.Web.UI.ImageClickEventArgs) Handles ImageButton1.Click
    ExportGridToExcel(DataGrid1, "IT-ADEEL")
End Sub 
```

干杯

# asp.net-mvc-3 - 带有剃刀视图引擎的mvc3中的日期选择器，不使用jquery

> ID：10022667
> 
> 赞同：0
> 
> 时间：2012-04-05T04:23:13.963
> 
> 标签：asp.net-mvc-3, razor

我是 mvc3 的新手，我正在使用 c# 编码和剃刀我的视图引擎。有没有办法使用日期选择器而不使用 jquery 和其他东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T06:28:03.813

如果您不使用 javascript 和 jquery，那么您就剩下 HTML。而且您知道在 HTML 中您有标准输入字段，例如`<input type="text">`. 使用纯 HTML，您无法在用户单击某些日期输入时显示动态日期选择器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:52:45.930

好吧，如果你想避免“所有脚本语言”，我想你应该有三个下拉菜单，

1.  月 (1 - 12)
2.  天数 (1 - 31)
3.  年

您的模型需要为月、日和年获取三个单独的字段。然后在您的控制器操作中，您将需要进行一些日期解析以确保它是有效日期，如果不是，请添加 ModelState 异常。

由于 MVC 带有 jQ​​uery（并且验证器非常有用），您为什么要避免使用它们？

所有这一切都可以用 jQuery 甚至纯 JavaScript 来完成，所以你真的是在限制自己。

**编辑 - 添加代码示例**

你的模型

```
using System.ComponentModel;
using System.ComponentModel.DataAnnotations;

public class DatePickerViewModel
{
     [Required]
     [DisplayName("Month")]
     [Range(1,12,ErrorMessage = "Month must be between 1 and 12")]
     public int? Date_Month {get;set;}

     [Required]
     [DisplayName("Day")]
     [Range(1,31,ErrorMessage = "Day must be between 1 and 31")]
     public int? Date_Day {get;set;}

     [Required]
     [DisplayName("Day")]
     [Range(1900,2012,ErrorMessage = "Year must be between 1900 and 2012")]
     public int? Date_Year {get;set;}
} 
```

你的控制器

```
public class DatePickerController : Controller
{
     [HttpGet]
     public ActionResult Choose()
     {
          return View(new DatePickerViewModel());
     }

     [HttpPost]
     public ActionResult Choose(DatePickerViewModel model)
     {
          if(!ModelState.IsValid)
               return View(model);
          else
          {
               DateTime date;
               if(!DateTime.TryParse(String.Format("{0}/{1}/{2}",model.Date_Month, model.Date_Day, model.Date_Year),out dt))
               {
                    ModelState.AddModelError("","Invalid Date");
                    return View(model);
               }

               //Do something with the variable "date"
               return View("SomeOtherView");
          }

     }
} 
```

还有你的看法

```
@model DatePickerViewModel

@using(Html.BeginForm())
{
     <div>
          <div>@Html.LabelFor(m => m.Date_Month) @Html.ValidationMessageFor( m => m.Date_Month)</div>
         <div>@Html.DropDownListFor(m => m.Date_Month, (from n in Enumerable.Range(0, 12) select new SelectListItem{ Text = n==0? "":n.ToString(),Value =  n ==0? "":n.ToString()})</div>
     </div>
     <div>
          <div>@Html.LabelFor(m => m.Date_Day) @Html.ValidationMessageFor( m => m.Date_Day)</div>
         <div>@Html.DropDownListFor(m => m.Date_Day, (from n in Enumerable.Range(0, 31) select new SelectListItem{ Text = n==0? "":n.ToString(),Value =  n ==0? "":n.ToString()})</div>
     </div>
     <div>
          <div>@Html.LabelFor(m => m.Date_Year) @Html.ValidationMessageFor( m => m.Date_Year)</div>
         <div>@Html.DropDownListFor(m => m.Date_Year, (from n in Enumerable.Range(1899, 2012) select new SelectListItem{ Text = n==1899? "":n.ToString(),Value =  n == 1899? "":n.ToString()})</div>
     </div>
     <div><input type="submit" value="Submit"/></div>
} 
```

如您所见，您需要创建大量的原始代码来启用日期选择器而不使用 JavaScript。考虑到如果您只使用任何 jQuery 日期选择器，您所需要的只是模型/视图模型上的可为空的 DateTime 属性、视图上的文本框和一小段 JS 以将文本框转换为日期选择器。

避免重新发明轮子并重用已经存在的代码以了解如何使用任何 jQuery Date Picker 插件。

# mysql - mysql获取大于10小时的记录

> ID：10022669
> 
> 赞同：3
> 
> 时间：2012-04-05T04:23:53.877
> 
> 标签：mysql

我的表中有一个时间戳（2012-04-04 20:44:53），我想选择从当前时间开始超过 10.5 小时的所有记录。谢谢你的帮助

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-05T04:25:15.637

```
SELECT ...
FROM ...
WHERE yourtimestampfield <= (NOW() - INTERVAL 10.5 HOUR) 
```

# c# - 何时编译 LINQ to SQL 的查询可以提高性能

> ID：10022672
> 
> 赞同：12
> 
> 时间：2012-04-05T04:24:10.303
> 
> 标签：c#, performance, linq-to-sql

我指的[是一篇](http://www.albahari.com/nutshell/speedinguplinqtosql.aspx)专注于加快 LINQ to SQL 查询的文章。它提到的技术之一是“使用编译查询”并解释了如何使用它。

我想看到编译查询的性能改进，因此我尝试了作者提供的相同示例。我使用 Northwind Db 作为数据上下文。我尝试了正常执行和编译查询执行，并在 LINQ PAD 上检查了它们。

首先，我尝试在**不**使用 CompileQuery 的情况下执行查询。耗时 2.065 秒。

```
var oo =   from o in Orders
   where o.OrderDetails.Any (p => p.UnitPrice > 100)
   select o;

oo.Dump ("Order items with unit price more than $100");

var oo1 = from o in Orders
   where o.OrderDetails.Any (p => p.UnitPrice > 10)
   select o;

oo1.Dump ("Order items with unit price more than $10"); 
```

其次，使用 CompileQuery 的**查询**。花了 2.100 秒。

```
var oo = CompiledQuery.Compile ((TypedDataContext dc, decimal unitPrice) =>    
   from o in Orders
   where o.OrderDetails.Any (p => p.UnitPrice > unitPrice)
   select o
);

oo (this, 100).Dump ("Order items with unit price more than $100");
oo (this, 10).Dump ("Order items with unit price more than $10"); 
```

多次重新执行它们表明两种方法所花费的时间几乎相似。

在这里，我们只看到每个方法的两次查询执行。我尝试为每个查询进行 10 个查询。但他们两个都完成了大约 7 秒。

预编译查询真的可以提高性能吗？还是我弄错了它的使用条款？

感谢您的时间和考虑。

**编辑：** 阅读接受的答案后，读者可能还想阅读[这篇文章](http://www.codeproject.com/Articles/38174/How-to-improve-your-LINQ-query-performance-by-5-X)，该文章很好地解释了编译查询如何提高性能。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-05T04:32:08.983

请记住，LINQ 查询的两个主要部分可能特别昂贵：

1.  将 LINQ 表达式编译为 SQL 语句。
2.  运行 SQL 语句并检索结果

在您的情况下，您有一个相对简单的查询，或者是一个非常慢的数据库连接、一些非常大的数据集，或者没有以运行此特定查询的最佳方式索引的表。或者也许是这三者的结合。

因此，与为您的查询生成 SQL 所花费的时间（可能是 10-50 毫秒）相比，第二步花费的时间非常多（约 1000 毫秒），以至于您几乎无法注意到差异。

如果以下条件都成立，您会看到显着的改进：

1.  您的 LINQ 查询很复杂，
2.  您可以快速连接到数据库，
3.  SQL 查询本身在该数据库上快速运行，并且
4.  结果集足够小，可以相对较快地从数据库传回。

在实践中，我的查询可能需要 500 毫秒以上的时间来编译，但实际运行只需要几毫秒。这些通常是我专注于预编译查询的情况。

提前了解预编译查询可以获得什么样的性能提升的一种好方法是使用对象对查询的*第二个*实例进行计时`Stopwatch`，然后使用 LINQPad 的分析 SQL 功能直接运行生成的 SQL。如果 SQL 查询快速返回但 LINQ 查询需要很长时间，那么这是一个很好的预编译候选者。

# javascript - 当页面上的链接悬停时，将一个 div 背景更改为多个图像

> ID：10022674
> 
> 赞同：0
> 
> 时间：2012-04-05T04:24:44.597
> 
> 标签：javascript, css, hover, background-image, onhover

我有一个我正在处理的页面，它有几个链接，但是有一个持久区域，当任何这些链接悬停在上面时，背景会淡入新图像。有点像这个脚本：[http ://www.dynamicdrive.com/dynamicindex4/thumbnail2.htm](http://www.dynamicdrive.com/dynamicindex4/thumbnail2.htm)

除了该脚本的唯一选择是让这些链接以该大图像为目标之外，我需要这些链接完全转到不同的位置。

我能做些什么呢？谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:32:46.803

您只需将此代码放在每个小图像中，然后根据目的地更改“where_you_want_it_to_go”部分。

```
onmouseover=document.getElementById('where_you_want_it_to_go').innerHTML= '<img src="image.jpg/>';" 
```

这是你要找的吗？

# xcode - App Store 提交两个成对运行的相关应用

> ID：10022678
> 
> 赞同：2
> 
> 时间：2012-04-05T04:25:03.860
> 
> 标签：xcode, app-store, app-store-connect, submission

我有两个独立的 iOS 应用程序，一个是客户端，一个是服务器。它们需要一起使用，要么单独使用是没有用的。客户端是免费的，服务器是有费用的。

我知道我可以将其作为单个应用程序提交，并且可以通过应用内购买解锁服务器功能。

但是，如果我想将其作为两个单独的应用程序提交怎么办？提交两个相关应用以供 Apple 审核的程序是什么？我可以将它们中的每一个的发布日期设置为将来的某个日期，以防一个被批准而另一个被拒绝并需要修复。这样，一旦两者都获得批准，我就可以为它们协调一个发布日期。

有经验的人愿意分享吗？

下面是我为什么要这样做的一个例子：假设我的服务器应用程序非常大，因为它有内容、图形等等。服务器用于大型聚会，许多人希望作为客户加入其中。当时他们都需要通过蜂窝数据下载客户端应用程序。我希望相关的客户端应用程序占用空间小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:49:22.400

> 它们需要一起使用，要么单独使用是没有用的。

这就是为什么您应该制作一个将服务器功能锁定为应用内购买的单个应用程序的原因。再想一想。

*   下载免费客户端版本的人无论如何都不能在不购买其他应用程序的情况下使用它。不好。
*   下载免费客户端版本的人无法轻松将其升级到完整版本。不好。
*   经历麻烦并安装这两个应用程序的人必须以某种方式在它们之间切换。他们的主屏幕上也多了一个图标。

如果可以，请发布一个应用程序。在首次发布的信息视图中告诉您的用户发生了什么，让他们立即升级。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T07:22:58.060

要绕过客户端服务器无用的问题，首先提交一个两者都可以的付费应用程序，然后提交免费客户端，然后提交付费服务器，然后，如果销售和收入趋势表明这是一种收入优化，请删除销售的组合应用程序。

# python - 无法将 qgis.core 导入到 python

> ID：10022680
> 
> 赞同：2
> 
> 时间：2012-04-05T04:25:26.357
> 
> 标签：python, qgis

我是 Python 新手。我想在 Window 7 64bit 上使用 QGIS 库使用 Python 创建 GIS 应用程序。

我这样做的方式：

*   安装 QGIS 1.7.0
*   我设置***PYTHONPATH=D:\Program Files (x86)\Quantum GIS Wroclaw\apps\qgis\python***
*   我从 Python 运行 python 存在于***D:\Program Files (x86)\Quantum GIS Wroclaw\bin***
*   我输入 import qgis.core，出现一个带有文本“的弹出窗口”

> 程序无法启动，因为您的计算机缺少 qgis_core.dll。尝试重新安装程序以解决此问题

" 并且 cmd 中的文本是 "

> ImportError：DLL 加载失败：找不到指定的模块。

"

预先感谢。

# ruby-on-rails - rails，ajax请求完成后如何编写回调函数

> ID：10022682
> 
> 赞同：1
> 
> 时间：2012-04-05T04:26:03.423
> 
> 标签：ruby-on-rails, ajax, callback

我想知道在 ajax 请求完成后如何/在哪里编写回调函数？

我正在构建一个 twitter 应用程序，并在用户单击“关注”后尝试发送电子邮件通知。以下/取消关注是使用 ajax 完成的。当用户点击关注时，我有...

```
 def follow!(other_user)
    relationships.create!(followed_id: other_user.id)
  end 
```

依次调用

```
 def create
    @user = User.find(params[:relationship][:followed_id])
    current_user.follow!(@user)
    respond_to do |format|
        format.html {redirect_to @user}
        format.js
    end

    UserMailer.is_now_following(@user, current_user).deliver
  end 
```

但是，通过添加该 UserMailer 行，它落后于我的 ajax 很多。我应该在哪里/如何放置电子邮件请求？我在考虑 ajax 完成后的回调函数，但我不确定在哪里添加它或如何添加它。

抱歉，我对此还是很陌生。多谢！

嗯，我发现这样做的一个好方法是使用 jquery。我决定给关注按钮

```
<%= f.submit "Follow", :class => "btn btn-large btn-primary", 
        :id => "follow_button"%> 
```

一个 id 和使用的 jquery

```
$("#follow_button").bind('ajax:success', function() {

}); 
```

之后发送电子邮件。但是，我真的很确定我如何传递变量。我想要达到的最终目标是

```
UserMailer.is_now_following(@user, current_user).deliver 
```

current_user 是一个函数 btw，它分配/返回 current_user

我该怎么做？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:47:45.073

这些 railscasts 系列已经很老了，但可能会有所帮助

[http://railscasts.com/episodes/127-rake-in-background](http://railscasts.com/episodes/127-rake-in-background)

[http://railscasts.com/episodes/128-starling-and-workling](http://railscasts.com/episodes/128-starling-and-workling)

[http://railscasts.com/episodes/129-custom-daemon](http://railscasts.com/episodes/129-custom-daemon)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-05T23:53:31.937

考虑：

Resque - [https://github.com/resque/resque](https://github.com/resque/resque)

Sidekiq - [https://github.com/mperham/sidekiq](https://github.com/mperham/sidekiq)

延迟工作 - [https://github.com/collectiveidea/delayed_job](https://github.com/collectiveidea/delayed_job)

# facebook - Facebook喜欢按钮：隐藏文字

> ID：10022683
> 
> 赞同：8
> 
> 时间：2012-04-05T04:26:11.270
> 
> 标签：facebook, button, facebook-like

我刚刚在我的网站上添加了一个 Facebook 的点赞按钮，只是最基本的一个，但您无法选择隐藏“注册以查看您的朋友喜欢什么”。文本。

因为按钮的区域太小，我不想要这个文本，因为它与旁边的其他文本重叠。

有没有办法隐藏这部分？我基本上只想要具有相同功能的like按钮。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-22T02:54:57.597

您现在可能已经想通了，但是对于尚未解决此问题的其他人，请尝试 data-layout="button_count"。

您可以在这里玩更多选项：[https ://developers.facebook.com/docs/reference/plugins/like/](https://developers.facebook.com/docs/reference/plugins/like/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-05T04:33:46.950

您可以将 layout="simple" (XFBML) 或 HTML5 的 "data-layout"="simple" 添加到标签中。

这将只显示一个赞按钮，没有计数、面孔或废话:)

# git - 使用 Git 创建更改文件的存档

> ID：10022685
> 
> 赞同：11
> 
> 时间：2012-04-05T04:26:12.380
> 
> 标签：git

我正在寻找一个简单的解决方案来存档最近更改的文件。

[我从谷歌](http://tosbourn.com/2011/05/git/using-git-to-create-an-archive-of-changed-files/)得到这个简单的命令

```
git archive -o update.zip HEAD $(git diff --name-only HEAD^) 
```

当我在 GIT BUSH 中运行它时，它一直说 **致命：不是有效的对象名称**

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-05T06:51:15.980

在那种情况下，我使用[这个答案告诉我](https://stackoverflow.com/questions/1678032/exporting-archiving-changed-files-only-in-git)

```
tar czf changed-files.tar.gz `git diff --name-only [diff options]` 
```

例如，要创建一个包含最近四个修订版中更改的文件的存档，我会这样做

```
tar czf changed-files.tar.gz `git diff --name-only HEAD~4..` 
```

这假设——当然——`HEAD~4`确实存在。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-09-01T00:36:49.150

我使用这个别名来包含不在 HEAD 中的新文件：

```
alias gittar='tar -czvf working-files.tgz \
              $(git status -s | sed -r "s/..(.*)/\1 /")' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-01-16T09:09:43.420

您只需要过滤掉该差异时删除的文件即可修复该错误：

```
git archive -o update.zip HEAD $(git diff --name-only --diff-filter=d HEAD^..HEAD) 
```

可能`git archive`是该任务的开销，您应该使用[@eckes 的答案](https://stackoverflow.com/a/10023894/2110496)。
但是，您仍然应该添加`--diff-filter=d`以从存档中排除已删除的文件。

# objective-c - 从迭代 NSMutableArray 中删除对象

> ID：10022687
> 
> 赞同：1
> 
> 时间：2012-04-05T04:26:36.153
> 
> 标签：objective-c, ios

根据[迭代时从 NSMutableArray 中删除的最佳方法？](https://stackoverflow.com/questions/111866/best-way-to-remove-from-nsmutablearray-while-iterating)，我们不能在迭代时从 NSMutableArray 中删除一个对象，是的。

但是，如果我有如下代码怎么办

```
- (void)sendFeedback {
    NSMutableArray *sentFeedback = [NSMutableArray array];
    for (NSMutableDictionary *feedback in self.feedbackQueue){
        NSURL *url = [NSURL URLWithString:@"someApiUrl"];
        ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];
        [request setPostValue:[feedback objectForKey:@"data"] forKey:@"data"];
        [request setCompletionBlock:^{
            [sentFeedback addObject:feedback];
        }];
        [request startAsynchronous];
    }
    [self.feedbackQueue removeObjectsInArray:sentFeedback];
} 
```

我正在使用 NSRunLoop 创建一个 NSThread 以每隔一段时间执行一次 sendFeedback 方法。我向API发送数据的方式是使用**异步**方法（它会为每个请求创建一个后台线程）一旦反馈已经发送，必须在NSRunner下一次执行该方法之前将其删除，以避免重复提交数据.

通过使用异步，循环（主线程）将继续运行，而无需等待服务器的响应。在某些情况下（可能是大多数情况下），循环将在每个请求的服务器的所有响应返回之前完成运行。如果是这样，完成块的代码将在**removeObjectsInArray**之后执行，这将导致发送的数据保留在 self.feedbackQueue

我很确定有几种方法可以避免这个问题。但我能想到的唯一方法是使用**同步**方法，以便在所有请求的响应返回（成功或失败）之前不会执行**removeObjectsInArray 。**但如果我这样做，则意味着互联网连接必须可用更长的时间。sendFeedback 线程所需的时间会更长。即使它将由新创建的 NSThread 运行，这不会导致应用程序不响应，但无论如何都需要资源。

那么，除了我上面提到的方法之外，还有其他方法吗？欢迎任何建议。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T04:37:26.413

有几种方法可以处理此类问题。我建议使用一个调度组来同步你的反馈，并使用一个实例变量来防止执行一个新的反馈批处理，而一个仍在进行中。对于这个例子，假设你创建了一个`_feedbackUploadInProgress`以你的类命名的实例变量，你可以`-sendFeedback`像这样重写你的方法：

```
- (void)sendFeedback
{
  if( _feedbackUploadInProgress ) return;
  _feedbackUploadInProgress = YES;

  dispatch_group_t group = dispatch_group_create();
  NSMutableArray *sentFeedback = [NSMutableArray array];
  for (NSMutableDictionary *feedback in self.feedbackQueue) {
    // enter the group for each item we're uploading
    dispatch_group_enter(group);
    NSURL *url = [NSURL URLWithString:@"someApiUrl"];
    ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];
    [request setPostValue:[feedback objectForKey:@"data"] forKey:@"data"];
    [request setCompletionBlock:^{
      [sentFeedback addObject:feedback];
      // signal the group each time we complete one of the feedback items
      dispatch_group_leave(group);
    }];
    [request startAsynchronous];
  }
  // this next block will execute on the specified queue as soon as all the
  // requests complete
  dispatch_group_notify(group, dispatch_get_main_queue(), ^{
    [self.feedbackQueue removeObjectsInArray:sentFeedback];
    _feedbackUploadInProgress = NO;
    dispatch_release(group);
  });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T04:54:05.833

一种方法是跟踪正在进行的请求，并在它们全部完成后清理队列。跟踪块有点棘手，因为天真的方法会产生一个保留周期。这是做什么：

```
- (void)sendFeedback {

    NSMutableArray *sentFeedback = [NSMutableArray array];

    // to keep track of requests
    NSMutableArray *inflightRequests = [NSMutableArray array];

    for (NSMutableDictionary *feedback in self.feedbackQueue){
        NSURL *url = [NSURL URLWithString:@"someApiUrl"];

        ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];

        // save it
        [inflightRequests addObject:request];

        // this is the ugly part. but this way, you can safely refer
        // to the request in it's block without generating a retain cycle
        __unsafe_unretained ASIFormDataRequest *requestCopy = request;

        [request setPostValue:[feedback objectForKey:@"data"] forKey:@"data"];
        [request setCompletionBlock:^{
            [sentFeedback addObject:feedback];

            // this one is done, remove it
            // notice, since we refer to the request array here in the block,
            // it gets retained by the block, so don't worry about it getting released
            [inflightRequests removeObject:requestCopy];

            // are they all done?  if so, cleanup
            if (inflightRequests.count == 0) {
                [self.feedbackQueue removeObjectsInArray:sentFeedback];
            }
        }];
        [request startAsynchronous];
    }
    // no cleanup here.  you're right that it will run too soon here
} 
```

# ios - 核心数据获取 entity1 并从变量中限制它

> ID：10022695
> 
> 赞同：-1
> 
> 时间：2012-04-05T04:27:52.723
> 
> 标签：ios, core-data, nsfetchrequest

对不起，如果我让任何人感到困惑，但我会尽力描述我的问题。

我有一个名为 Document 的实体和另一个名为 Customer 的实体，该 Document 有一个名为 CustomerID 的属性，该属性是从 Customer 属性 CustomerID 分配的，并且它有一个 updatedDate 属性。

我想获取最近的 10 个文档，但只获取每个 CustomerID 的最新文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T12:28:11.183

如果我理解正确，您想从指定客户那里获得 10 个最新的文档吗？这很容易。

```
NSFetchRequest *request = [[NSFetchRequest alloc] init];
   request.entity = [NSEntityDescription entityForName:@"Document" inManagedObjectContext:managedObjectContext];//Specify the entity Name
   request.predicate = [NSPredicate predicateWithFormat:@"customerID = %@",customerID];//Specify the ID you need
   request.sortDescriptors = [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"updatedDate" ascending:YES]];//Sorted by most recent ones
   request.fetchLimit = 10;//You'll get ten latest Documents
   NSError *error = nil;

 latestDocuments =  [managedObjectContext executeFetchRequest:request error:&error]; 
```

# 编辑

正如我们发现的那样，任务是获取十个最近的文档，但每个客户只有一个，我真的认为没有办法以某种方式有效地做到这一点（我的意思是，没有 IN 查询，它将包含您已经获取的客户 ID） ，但是要为您的客户添加新的一对一的情感- **latestDocument**，并与之相反，只需对文档提出请求，其中**isLatestToCustomer**不为零。

# java - 在Android中执行数学方程

> ID：10022701
> 
> 赞同：7
> 
> 时间：2012-04-05T04:28:25.250
> 
> 标签：java, javascript, android

我需要能够在我的应用程序中处理诸如“(45+9)/8”之类的数学方程。我只想使用 JavaScript 评估它，但意识到我不能在 Android 中使用 javax.script。所以，我找到了 WebView，但我在使用它时遇到了一些麻烦。大多数示例是指使用带有 JS 代码的外部页面，或者使用“javascript: var return ...etc”。我需要使用后者，但是将变量返回到我的应用程序时遇到了一些麻烦。

是否可以让 JS 对其进行评估，然后将值写入隐藏的 TextView？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-05T05:09:22.247

查看[exp4j](http://projects.congrace.de/exp4j/)。它是一个简单的 java 表达式求值器。对于您在问题中发布的方程式，您可以这样做：

```
Calculable calc = new ExpressionBuilder("(45+9)/8").build()
double result1=calc.calculate(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-29T12:15:32.150

试试这个：

```
import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;
import javax.swing.JOptionPane;

private void btnEqualsActionPerformed(java.awt.event.ActionEvent evt) {
    String expression = txtResult.getText();
    ScriptEngineManager mgr = new ScriptEngineManager();
    ScriptEngine engine = mgr.getEngineByName("JavaScript");
    try {
        result = engine.eval(expression).toString();
        txtResult.setText(result);
    } catch (Exception e) {
        JOptionPane.showMessageDialog(null, txtResult.getText() + " cannot be calculated. Try again!", "Error on calculation!", JOptionPane.WARNING_MESSAGE);
        txtResult.setText("");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T06:19:50.827

更高级表达的有趣选项可能是将[一些在线计算器](http://www.math.sc.edu/cgi-bin/sumcgi/calculator.pl)变成可以在手机上使用的网络服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-14T10:39:16.540

您可以在 android studio 中使用**exp4j执行此操作。**

*   从官方网站下载 exp4j 二进制 jar。[下载](http://www.objecthunter.net/exp4j/exp4j-0.4.8.jar)

*   通过复制文件夹中的 jar 文件将 exp4j 导入 android studio `app/libs` 。

*   `build.gradle`在模块文件依赖项中添加以下行。

    ```
    dependencies {
        implementation fileTree(dir: 'libs', include: ['*.jar'])
        ...
    } 
    ```

现在您可以尝试以下演示，

```
package com.example.expressionevaluator;

import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.util.Log;

import de.congrace.exp4j.Calculable;
import de.congrace.exp4j.ExpressionBuilder;
import de.congrace.exp4j.UnknownFunctionException;
import de.congrace.exp4j.UnparsableExpressionException;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Calculable calc = null;
        try {
            calc = new ExpressionBuilder("(200 + 100) / 2 + 300").build();
            double result = calc.calculate();
            Log.d("result", result);

        } catch (UnknownFunctionException e) {
            e.printStackTrace();
        } catch (UnparsableExpressionException e) {
            e.printStackTrace();
        }
    }
} 
```

更多：

[https://lallafa.objecthunter.net/exp4j/](https://lallafa.objecthunter.net/exp4j/)

[https://github.com/codemaker2015/Expression-Evaluator](https://github.com/codemaker2015/Expression-Evaluator)

# php - PHP & MySQL 中的数学运算

> ID：10022702
> 
> 赞同：2
> 
> 时间：2012-04-05T04:28:41.137
> 
> 标签：php, mysql, count, html-table

我正在使用 MySQL 查询中的 PHP 创建一个表，该表返回数据库中两列“total_tr”和“total_rc”的总行数。

我已经完成并成功查看了PHP表中的计数，编码为：

```
 while($row = mysql_fetch_array($result))
      {
            echo "<tbody>";
              echo "<tr>";
                  echo "<td>Zone</td>";
                  echo "<td>" . $row['segment_code'] . "</td>";
                  echo "<td>" . $row['COUNT(total_tr)'] . "</td>";
                  echo "<td>" . $row['COUNT(repeat_rc)'] . "</td>";
              echo "</tr>";
            echo  "</tbody>"; 
      } 
```

我现在的问题是，我想将“total_tr”的总计数值除以“repeat_rc”的总计数并乘以100得到total_rc的百分比。

关于我该怎么做的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:31:21.377

```
$myresult = $row['COUNT(total_tr)'] / $row['COUNT(repeat_rc)'] * 100; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:31:11.000

在回显行时保持运行计数

```
$total_tr = 0;
$total_rc = 0;
while($row = ...) {
    $total_tr += $row['COUNT(total_tr)']);
    $total_rc += $row['COUNT(repeat_rc)']);
    ... html here ...
}
echo $total_tr / $total_rc * 100; 
```

# jsp - response.sendRedirect 不起作用

> ID：10022704
> 
> 赞同：6
> 
> 时间：2012-04-05T04:28:57.003
> 
> 标签：jsp, jdbc, response

response.sendRedirect() 方法在我的程序中不起作用。

代码通过并成功打印`out.println("wrong user");`，但重定向到谷歌页面不起作用。

```
String id="java";

try 
{
    query = "select Id from Users where Id= ?";
    ps  =Database.getConnection().prepareStatement(query);
    ps.setString(1, id);
    rs  =   ps.executeQuery();

    if(rs.next())
    {
        out.println(rs.getString(1));
    }
    else 
    {
        out.println("wrong user");
        response.sendRedirect("www.google.com");
    }
    rs.close();
}
catch(Exception e)
{
    //e.printStackTrace();
    System.out.print(e);
} 
```

有什么答案吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-05T04:31:59.473

你应该`return`在重定向之后。

```
response.sendRedirect("http://www.google.com");
return; 
```

调用 sendRedirect() 后不会自动返回。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T07:58:12.893

**HttpServletResponse.sendRedirect() 的工作方式如下：**

*   如果 URL 是绝对的`http://www.google.com`，它会重定向到`http://www.google.com`.
*   如果 URL 不是 absolute ，它会相对于当前 URL 进行重定向。如果 URL 以`/`相对于上下文根的重定向开头，否则它将重定向到当前 url

根据以上规则`in your case it redirects to http://currenturl/www.google.com`。

**而是像这样修改您的代码**

```
response.sendRedirect("http://www.google.com");
return; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T09:21:26.900

尝试这个

```
<% response.sendRedirect("http://www.google.com/"); %> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-05T06:20:42.950

尝试提供协议。

```
response.sendRedirect("http://www.google.com");
return; 
```

# c++ - 在使用代码块配置 boost 时遇到问题

> ID：10022706
> 
> 赞同：0
> 
> 时间：2012-04-05T04:29:29.430
> 
> 标签：c++, boost, configuration, compiler-errors, codeblocks

我以前已经配置过boost，但是这次我不知道是什么导致了问题。我提供了一些屏幕截图，显示了我在 CodeBlocks (svn7550) 中的设置。我使用这些命令构建了我的 Boost 库。

Boost被提取到`F:\`主文件夹地址为：

```
F:\boost_1_49_0 
```

以下是命令：

```
F:\
F:\ cd Boost_1_44_0
F:\ Boost_1_44_0> bootstrap.bat
F:\ Boost_1_44_0>bjam toolset=gcc --build-type=complete stage 
```

* * *

上面没有做任何好事，所以我写了这个并且实际上编译得很好：

```
F:\ Boost_1_44_0>bjam variant=debug,release link=static address-model=32 
```

进而

```
F:\boost_1_49_0>bjam toolset=gcc variant=debug,release link=static threading=multi address-model=32 --build-type=complete stage 
```

然后当我尝试编译一个线程示例时：

```
 #include <boost/thread.hpp>
#include <iostream>

void wait(int seconds)
{
  boost::this_thread::sleep(boost::posix_time::seconds(seconds));
}

boost::mutex mutex;

void thread()
{
  for (int i = 0; i < 5; ++i)
  {
    wait(1);
    mutex.lock();
    std::cout << "Thread " << boost::this_thread::get_id() << ": " << i << std::endl;
    mutex.unlock();
  }
}

int main()
{
  boost::thread t1(thread);
  boost::thread t2(thread);
  t1.join();
  t2.join();
} 
```

它因以下错误而失败：

```
||=== Boost Example, Debug ===|
obj\Debug\main.o||In function `Z6threadv':|
D:\Documents and Settings\Master\My Documents\Projects\Boost Example\main.cpp|18|undefined reference to `_imp___ZN5boost11this_thread6get_idEv'|
obj\Debug\main.o||In function `main':|
D:\Documents and Settings\Master\My Documents\Projects\Boost Example\main.cpp|27|undefined reference to `_imp___ZN5boost6thread4joinEv'|
D:\Documents and Settings\Master\My Documents\Projects\Boost Example\main.cpp|28|undefined reference to `_imp___ZN5boost6thread4joinEv'|
D:\Documents and Settings\Master\My Documents\Projects\Boost Example\main.cpp|28|undefined reference to `_imp___ZN5boost6threadD1Ev'|
D:\Documents and Settings\Master\My Documents\Projects\Boost Example\main.cpp|28|undefined reference to `_imp___ZN5boost6threadD1Ev'|
D:\Documents and Settings\Master\My Documents\Projects\Boost Example\main.cpp|28|undefined reference to `_imp___ZN5boost6threadD1Ev'|
D:\Documents and Settings\Master\My Documents\Projects\Boost Example\main.cpp|28|undefined reference to `_imp___ZN5boost6threadD1Ev'|
F:\boost_1_49_0\boost\thread\win32\thread_data.hpp|161|undefined reference to `_imp___ZN5boost11this_thread18interruptible_waitEPvNS_6detail7timeoutE'|
obj\Debug\main.o||In function `thread<void (*)()>':|
F:\boost_1_49_0\boost\thread\detail\thread.hpp|205|undefined reference to `_imp___ZN5boost6thread12start_threadEv'|
||=== Build finished: 9 errors, 0 warnings (0 minutes, 58 seconds) ===| 
```

虽然上面的线程示例失败了，但这段代码编译得很好：

```
#include <boost/lambda/lambda.hpp>
#include <iostream>
#include <iterator>
#include <algorithm>

int main()
{
    using namespace boost::lambda;
    typedef std::istream_iterator<int> in;

    std::for_each(
        in(std::cin), in(), std::cout << (_1 * 3) << " " );
} 
```

这些是我目前的 CB 截图：

[http://upload.ustmb.ir/uploads/13336039464.jpg](http://upload.ustmb.ir/uploads/13336039464.jpg)

[http://upload.ustmb.ir/uploads/13336039463.jpg](http://upload.ustmb.ir/uploads/13336039463.jpg)

[http://upload.ustmb.ir/uploads/13336039462.jpg](http://upload.ustmb.ir/uploads/13336039462.jpg)

[http://upload.ustmb.ir/uploads/13336039465.jpg](http://upload.ustmb.ir/uploads/13336039465.jpg)

这是我的 stage/lib 文件夹的内容：

[http://upload.ustmb.ir/uploads/13335642651.jpg](http://upload.ustmb.ir/uploads/13335642651.jpg)

有人能告诉我问题是什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T20:58:00.110

我使用这个命令来编译 boost：

```
F:\
F:\ cd Boost_1_44_0
F:\ Boost_1_44_0> bootstrap.bat
F:\ Boost_1_44_0>bjam toolset=gcc --build-type=complete stage variant=debug,release threading=multi link=static 
```

其余配置相同。我只是按照[这里的指南](http://stackoverflow.com/questions/5288641/g-including-boost-library) 并添加了：

```
#define BOOST_THREAD_USE_LIB 
```

到我的源代码的第一行，错误就消失了。

# apache - 直接管理 cron 工作，我这样做对吗？

> ID：10022707
> 
> 赞同：0
> 
> 时间：2012-04-05T04:29:36.800
> 
> 标签：apache, cron

我正在尝试在我的网络服务器上加载一个 cron 作业。我希望它每 5 分钟运行一次 php 脚本。这就是我所拥有的

```
 */5    *   *   *   *   /usr/local/bin/php home/myusername/domains/servername.com/public_html/timecheck.php 
```

但这似乎不起作用。根据脚本的结果，它应该发送一封电子邮件。如果我通过 url 运行脚本，它工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:53:19.030

可能需要一个`/`在前面`home/...`，具体取决于您在哪个用户 ID 下运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:33:41.840

*/5 应该可以，也许试试 0-59/5

如果这不起作用，请努力... 0,5,10,15,20,25,30,35,40,45,50,55

# wireshark - 在wireshark中设置数据包长度过滤器

> ID：10022710
> 
> 赞同：37
> 
> 时间：2012-04-05T04:30:02.773
> 
> 标签：wireshark, pcap, libpcap

我已经捕获了一个 pcap 文件并将其显示在 wireshark 上。我想分析那些“长度”列等于 443 的 udp 数据包。

在wireshark上，我试图找到合适的过滤器。

```
udp && length 443 # invalid usage
udp && eth.len == 443 # wrong result
udp && ip.len == 443 # wrong result 
```

顺便问一下，wireshark 的过滤器可以直接应用在 libpcap 的过滤器上吗？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-04-05T08:36:09.273

所有这些都适用于 Wireshark 的过滤器

```
frame.len==243  <- I use this
ip.len==229
udp.length==209
data.len==201 
```

# jquery - speedtest.net api

> ID：10022711
> 
> 赞同：13
> 
> 时间：2012-04-05T04:30:06.977
> 
> 标签：jquery, google-chrome-extension

我想制作一个小部件来显示用户最近的速度测试结果。speedtest.net 有我可以使用的 api 吗？我尝试向[http://speedtest.net/csv.php?csv=1&ria=0&s=0](http://speedtest.net/csv.php?csv=1&ria=0&s=0)发出 ajax 请求，但出现跨域错误。我尝试了一个 iframe，但这只是让它出现在下载中。

这将位于 Google Chrome 扩展程序中，因此我可以在必要时使用 chrome api。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-05T06:50:15.320

speedtest.net 由[Ookla 及其 Speed Test 应用程序运行](http://www.ookla.com/speedtest)。不幸的是，他们没有为您可以使用的 speedtest.net 提供任何公共 API。

尽管我怀疑其中任何一个都不能满足您的需求，但它们确实[为其完整的 Speed Test 软件包](http://www.ookla.com/speedtest)（包括 CSV 导出功能）提供了[Speed Test Mini](http://speedtest.net/mini.php)和托管报告解决方案。

您无法使用 AJAX 的原因是 Chrome 不允许 JavaScript 执行跨站点请求，除非在[`Access-Control-Allow-Origin`](http://www.w3.org/TR/cors/#access-control-allow-origin-response-header)speedtest.net 的响应中设置响应标头以允许此类请求。

但是，在 Chrome 扩展程序中，您可以通过将 URL 添加到文件的权限部分来允许跨域请求[`manifest.json`](http://code.google.com/chrome/extensions/manifest.html#permissions)。例如：

```
"permissions": [
  "http://*/"
], 
```

然后，您可以使用一些 jQuery 将 CSV 数据作为字符串检索（请参阅[此答案](https://stackoverflow.com/a/8186194/1166205)）：

```
$.get('http://speedtest.net/csv.php?csv=1&ria=0&s=0', function(data) {
    var csv = new String(data);
    // do stuff with csv
}, dataType='text'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-08-09T08:01:21.090

试试[MySpeed.today](https://myspeed.today)。它可能会奏效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-09-13T15:22:13.370

Ookla 确实提供了一个[API](https://support.ookla.com/hc/en-us/articles/115002187768-Speedtest-Intelligence-Data-Extracts-API)

您需要获取他们的 API 密钥。他们还提供了一个示例 Python 脚本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T06:32:43.757

您可以在 chrome 扩展程序中创建跨域 XMLHttpRequests，**前提是**您已为其请求权限。

在您的[`manifest.json`](http://code.google.com/chrome/extensions/manifest.html#permissions)文件中，添加 URI：

```
"permissions": ["http://speedtest.net/csv.php?*"] 
```

另请参阅：[匹配模式](http://code.google.com/chrome/extensions/match_patterns.html)。

# java - 带有Java play 2.0的mongodb数据库

> ID：10022719
> 
> 赞同：6
> 
> 时间：2012-04-05T04:31:28.523
> 
> 标签：java, mongodb, playframework, playframework-2.0

是否有教程如何在 Java play 2.0 中使用 mongodb 数据库？

在官方网站 (playframework.org) 上似乎只有 NoSql 示例。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-11T17:07:38.080

在 github 上查看这个演示。[https://github.com/czihong/playMongoDemo](https://github.com/czihong/playMongoDemo)

我使用morphia连接play 2.o和mongodb。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T06:40:06.070

使用 scala play 2.0 教程和[这个讨论](https://groups.google.com/forum/#!topic/play-framework/K7IrXyXvL8w/discussion)检查[mongodb 数据库](https://stackoverflow.com/questions/9885257/mongodb-database-with-scala-play-2-0-tutorial)。不幸的是，目前没有官方教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T11:22:38.823

在 github [https://github.com/leodagdag/play2-morphia-plugin](https://github.com/leodagdag/play2-morphia-plugin)上查看这个演示。这不是官方教程。这是一个 leodagdag.play2morphia.Model。

# loops - 如何创建一个错误循环，限制用户只能输入数字和小数点。

> ID：10022720
> 
> 赞同：1
> 
> 时间：2012-04-05T04:31:39.677
> 
> 标签：loops, floating-point, python-3.2

我正在做一个家庭作业，用户将输入一个成绩百分比，它会输出一个字母成绩。我的问题是我想限制用户只能使用数字键和小数点。如果用户输入任何其他内容，他们将收到一条错误消息提示，并有机会再次输入。这是我的代码，它可以在没有小数的情况下工作，但我需要 int 是浮点数。请帮忙！任何反馈将不胜感激！！

```
 def percentLoop()
    while True:
    a = input('Enter a percent: ')
    try:
        number = int(a)
        if (0< number <= 100):
            return number
        else:
            print ('Enter a percent between 0 and 100.')
    except:
        print ('Please enter a percent between 0 and 100.') 
```

感谢您查看我所拥有的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:41:16.607

我已经很久没有做过python了，但这只是改变的问题`number = int(a)`吗`number= float(a)`？

# css - Compass Sass 框架 Sprite 路径和布局设置 (SASS/CSS)

> ID：10022721
> 
> 赞同：3
> 
> 时间：2012-04-05T04:31:40.400
> 
> 标签：css, sass, compass-sass

我正在使用 Sass & Compass 框架来编译我的 CSS。我在本地环境中工作。当我处理 Compass Sprite 图像生成时，我遇到了两个不同的问题。

1.  我想将布局设置为水平或智能或默认垂直以外的任何内容，但我不能。我检查了语法，我使用的是正确的，文件夹名称加上布局，但无法让它工作。所有其他设置，如间隙、间距，都可以。

2.  我目前没有运行服务器。我需要从我的 css 文件夹到图像文件夹的相对路径。像这样的“../images/xxx.png”。Compass 全部使用基于我的配置文件的绝对文件路径。无论如何我可以将设置设置为使用相对路径而不是绝对路径？我尝试了 URL helper mixin，它也生成了绝对路径。

我非常感谢所有的帮助。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T07:34:23.240

对于`relative_assets = true`配置文件中的#2 使用。

如果您还没有，我还建议您使用[stylesheet-url 和 image-url Compass](http://compass-style.org/reference/compass/helpers/urls/)函数，它们会自动计算您配置的图像和 css 文件夹的路径，从那里调用它们。如果您`image-url(myfile.jpg)`从 css 文件夹中的 .css 文件调用，它将编译为`url(../images/myfile.jpg)`.

# git - git-log 和 git-whatchanged 的 区别？

> ID：10022722
> 
> 赞同：39
> 
> 时间：2012-04-05T04:31:53.703
> 
> 标签：git, git-log

1.  鉴于另一个问题的[答案](https://stackoverflow.com/a/280140/10608)，并且
2.  鉴于[git-log](http://linux.die.net/man/1/git-log)和[git-whatchanged](http://linux.die.net/man/1/git-whatchanged)的​​手册页都说他们从[git-rev-list 中](http://linux.die.net/man/1/git-rev-list)提取...

...那么这两个命令之间有什么区别？为什么要费心拥有他们两个？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-09-03T06:11:33.270

[提交 52f425e1](https://github.com/git/git/commit/52f425e1a9ab8b0ae572d06fe2a1b428f741ef4a) （2013年8 月 30 日）提到：

> **鼓励新用户改用 ' `log`'。这些天来，这些命令是统一的，只是有不同的默认值**。
> 
> ' `git log`' 仅在 2005 年 6 月上旬添加时允许您查看日志消息并且没有差异。直到 2006 年 4 月上旬，该命令才学会采用差异选项。
> 因此，高级用户倾向于使用`whatchanged`自 2005 年 5 月中旬以来已经存在并支持差异选项的 ' '。

* * *

这就是[新版本的手册页`git whatchanged`](https://github.com/git/git/blob/52f425e1a9ab8b0ae572d06fe2a1b428f741ef4a/Documentation/git-whatchanged.txt#L17-L25)现在所说的：

> 鼓励新用户[`git log`](http://git-scm.com/docs/git-log)改用。该 `whatchanged`命令基本相同，[`git log`](http://git-scm.com/docs/git-log) 但默认显示原始格式差异输出并跳过合并。
> 
> 保留该命令主要是出于历史原因；**许多很久以前学习 Git 的人`git log`是通过阅读 Linux 内核邮件列表发明的，他们的手指都经过训练可以打字**。

作为[torek](https://stackoverflow.com/users/1256452/torek) [评论](https://stackoverflow.com/questions/10022722/difference-between-git-log-and-git-whatchanged#comment95635582_18585297)，`git whatchanged`等价于：

```
git log --raw --no-merges 
```

（这样可以避免[这个问题](https://stackoverflow.com/q/54412432/6309)）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-05T06:00:51.117

'git log' 以最简单的形式显示每个提交（sha、作者、日期、消息），而 'git whatchanged' 显示提交以及更改的文件。例如：

```
$ git log
commit db9f525674443314a9822a6bd6c3acce49c8f8d6
Author: ...
Date:   Wed Apr 4 22:55:33 2012 -0700

Add more

commit eed0b7aa3cad5d985b5f1d52f3c0605339c119a1
Author: ...
Date:   Tue Apr 3 20:36:04 2012 -0700

del bing/one.c 
```

但改变了什么：

```
$ git whatchanged
commit db9f525674443314a9822a6bd6c3acce49c8f8d6
Author: ...
Date:   Wed Apr 4 22:55:33 2012 -0700

Add more

:100644 100644 f2e4113... d415016... M  bar.c

commit eed0b7aa3cad5d985b5f1d52f3c0605339c119a1
Author: ...
Date:   Tue Apr 3 20:36:04 2012 -0700

del bing/one.c

:100644 000000 e69de29... 0000000... D  bing/one.c 
```

有很多选项可以更改每个命令的输出。例如 'git whatchanged -p' 以差异/补丁形式显示更改。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-22T22:55:06.377

我不完全同意。你能看到合并更改的文件`log`吗？

我没有找到此功能，对于了解文件何时合并到某个分支中非常有用，例如：

`file c.c`in`branch1`的提交日期为 2012 年 1 月 1 日，如果您合并到`branch2`，并且稍后想跟踪该提交的引入日期`branch2`，可以`git log`提供帮助吗？如果你有合并，你可以在其中搜索`git whatchanged -m sha1`

# c++ - 调用 FreeSid() 函数会使我在 Windows 7 上的 MFC 应用程序崩溃

> ID：10022729
> 
> 赞同：0
> 
> 时间：2012-04-05T04:33:12.050
> 
> 标签：c++, windows, winapi, mfc

`FreeSid()`我们的 MFC 应用程序在 Windows 7 上经常崩溃。多年来，它在 Windows XP 中一直运行良好。

有谁知道这个的解决方法？

[其他人在 VB 中遇到了同样的问题](https://stackoverflow.com/questions/1913087/checktokenmembership-in-vb6-crashing-on-freesid-on-windows-7-and-windows-2008)，但尚不清楚如何在 C++ 中修复它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T09:53:48.813

有多种释放 SID 的方法。如果您从 获取它`ConvertStringSidToSid`，请使用`LocalFree`. 如果您从 获取它`AllocateAndInitializeSid`，请使用`FreeSid`. 将两者混合会产生未定义的结果，Windows 版本之间可能会有所不同。

# c# - 在 C# 上从 Rails 读取 JSON 和 XML

> ID：10022731
> 
> 赞同：0
> 
> 时间：2012-04-05T04:33:30.603
> 
> 标签：c#, .net, xml, json

我需要从 WebService 读取一些以 JSON 和 XML 返回的列表。我们将 C# 与 .NET Framework 4 结合使用。

以下是 JSON 的示例：

> [{"category":{"category_name":"Imagens","category_desc":null,"parent_id":0,"created_at":"2012-03-18T00:07:20Z","updated_at":"2012- 03-18T00:07:20Z","id":1}},
> 
> {"category":"category_name":"V\u00eddeos","category_desc":null,"parent_id":0,"created_at":"2012-03-18T00:07:20Z","updated_at":"2012- 03-18T00:07:20Z","id":2}}]

在这里，XML：

```
<categories>
  <category>
    <category-name>Imagens</category-name>
    <category-desc></category-desc>
    <parent-id>0</parent-id>
    <created-at>2012-03-18T00:07:20Z</created-at>
    <updated-at>2012-03-18T00:07:20Z</updated-at>
    <id>1</id>
  </category>
  <category>
    <category-name>Videos</category-name>
    <category-desc></category-desc>
    <parent-id>0</parent-id>
    <created-at>2012-03-18T00:07:20Z</created-at>
    <updated-at>2012-03-18T00:07:20Z</updated-at>
    <id>2</id>
  </category>
</categories> 
```

请记住，此回复来自 Ruby on Rails 应用程序，因此我无法更改其格式。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T06:06:50.023

使用[Json.Net](http://json.codeplex.com/)

```
dynamic jObj= JsonConvert.DeserializeObject(jsonstring);
foreach (var cat in jObj)
{
    Console.WriteLine(cat.category.category_name);
} 
```

顺便说一句：您的服务器应用程序没有形成有效的 json 对象。第二行`{`之间`"category"`和之间有一个缺失。`"category_name"`

# python - 如何从 facebook 运行我的 web2py 应用程序？

> ID：10022738
> 
> 赞同：0
> 
> 时间：2012-04-05T04:34:34.200
> 
> 标签：python, web2py, web2py-modules

我已经创建了一个 web2py 应用程序，现在我必须将此应用程序部署到 facebook，以便用户可以登录到 facebook 并可以从那里访问此应用程序，有什么办法可以实现吗？

请帮我解决这个问题。

问候， 皮克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:57:38.343

您必须开始了解 Facebook 应用程序的工作原理，之后您将能够使用任何框架开发 Web 应用程序并“部署”以用作 Facebook 应用程序。

从这里开始：[https ://developers.facebook.com/](https://developers.facebook.com/)

# javascript - 由于 Facebook Connect 代码中的单个字符，验证失败

> ID：10022741
> 
> 赞同：0
> 
> 时间：2012-04-05T04:34:51.197
> 
> 标签：javascript, facebook, validation

我正在尝试在我的一个页面中使用一些 Facebook 代码。

代码是：

```
<script type="text/javascript">(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=000000000";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script> 
```

但是，当我尝试将其验证为 XHTML+RDFa 页面时，出现错误。该错误是由这部分“xfbml=1&appId”中的&符号引起的。WC3 验证器建议使用：

```
&amp; 
```

即使在它说的网址中。

但是，当我将 & 符号更改为：

```
&amp; 
```

该脚本不再起作用。

有没有办法让它正常工作并仍然有效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:38:25.977

您应该能够通过将代码包装在`CDATA`标签中来对其进行验证，如下所示：

```
<script type="text/javascript">(function(d, s, id) {
//<![CDATA[
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=000000000";
  fjs.parentNode.insertBefore(js, fjs);
//]]>
}(document, 'script', 'facebook-jssdk'));</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T04:40:23.423

```
<script type="text/javascript">
/*<![CDATA[*//*---->*/
(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=000000000";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
/*--*//*]]>*/
</script> 
```

XHTML 解析器无法正确解释大部分 JavaScript。您需要使用 CDATA 对其进行转义。

# android - Activity 过渡完成后播放音频

> ID：10022742
> 
> 赞同：3
> 
> 时间：2012-04-05T04:35:05.417
> 
> 标签：android, audio, animation, android-activity

我正在写一个活动。它应该显示一些视图并播放声音。一切都很棒，除了......我不确定将代码放在哪里来播放声音。
目前我在`onCreate()`Activity 的方法中播放它，但声音在 Activity 转换完成之前开始播放。我非常希望在过渡完成并且整个视图可见后播放声音。
是否有任何方法可以覆盖/我可以实现的任何侦听器，在转换完成后被调用？有什么方法可以知道过渡的持续时间，所以我可以简单地`postDelayed(Runnable action, long delayMillis)`查看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:40:24.587

您是否尝试将播放声音的代码放入`onResume()`？因为它在 Activity 处于前台时被调用。

从文档，

**onResume() -**

> 在 onRestoreInstanceState(Bundle)、onRestart() 或 onPause() 之后调用，以便您的活动开始与用户交互。这是开始动画、打开独占访问设备（例如相机）等的好地方

# sql - 从数据库 ASP.NET/C# 返回特定值

> ID：10022754
> 
> 赞同：2
> 
> 时间：2012-04-05T04:37:32.833
> 
> 标签：sql, asp.net

我的问题涉及从数据库中的表中返回特定值。我想让它在您登录后显示用户的名字和姓氏。

桌子看起来像这样。

**人**

```
UID(PK), FName, LName, Uname, Upass 
```

我如何只返回`Fname`and`LName`以便我可以将它放在标签中？

这是我当前的代码。请记住，这是针对母版页的。

```
string strConn = WebConfigurationManager.ConnectionStrings["cloud2"].ConnectionString;

protected void btnlogin2_Click(object sender, EventArgs e)
{
    string strCmd = "Select * From Person Where uname = @uname and upass = @upass";

    SqlConnection objConn = new SqlConnection(strConn);

    SqlCommand objCmd = new SqlCommand(strCmd, objConn);
    objCmd.Parameters.AddWithValue("@uname", txtusername.Text);
    objCmd.Parameters.AddWithValue("@upass", txtpassword.Text);

    using (objConn)
    {
        objConn.Open();
        SqlDataReader objDR = objCmd.ExecuteReader();

        if (objDR.HasRows)
        {
            btnlogin2.Visible = false;
            txtusername.Visible = false;
            txtpassword.Visible = false;

            Response.Redirect("member.aspx");

            lblLogin.Text = "Logged in as: Test " ; //Display login name?
        }
        else
        {
            btnlogin2.Text = "Failed";
        }
    } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:22:48.543

我会做三件事：

*   将您的 UI 逻辑与数据库逻辑分开 - 不要在`button_Click`事件处理程序中间直接访问您的数据库......

*   如果您只需要名字和姓氏，那么**只需**从表中选择这两列！

*   把所有的一次性物品都像块一样`SqlConnection, SqlCommand, SqlDataReader`，`using(...) {...}`以便在使用后妥善处理

所以我的代码看起来像这样：

**界面层**：

```
protected void btnlogin2_Click(object sender, EventArgs e)
{
    // call the database layer to get the first and last name
    FirstAndLastName data = GetFirstAndLastName(txtusername.Text, txtpassword.Text);

    if (data != null)  // something was returned - show it
    {
         lblLogin.Text = string.Format("You're logged in as {0} {1}", 
                                       data.FirstName, data.LastName);
    }
    else
    {
         lblLogin.Text = "Not logged in...."; 
    }
} 
```

**数据库层**：

```
string strConn = WebConfigurationManager.ConnectionStrings["cloud2"].ConnectionString;

internal class FirstAndLastName
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
}

protected FirstAndLastName GetFirstAndLastName(string userName, string password)
{
    FirstAndLastName result = null;

    // if you only need FName und LName - then only select those two columns! 
    // don't just use SELECT * all the time because it's easy and because you're lazy
    string strCmd = "SELECT FName, LName FROM dbo.Person WHERE uname = @uname AND upass = @upass";

    // wrap everything into using blocks
    using(SqlConnection objConn = new SqlConnection(strConn))
    using(SqlCommand objCmd = new SqlCommand(strCmd, objConn))
    {
       objCmd.Parameters.AddWithValue("@uname", userName);
       objCmd.Parameters.AddWithValue("@upass", password);

       objConn.Open();

       using(SqlDataReader objDR = objCmd.ExecuteReader())
       {
          if (objDR.Read())
          {
              result = new FirstAndLastName();

              result.FirstName = objDR.GetString(objDR.GetOrdinal("FName"));
              result.LastName = objDR.GetString(objDR.GetOrdinal("LName"));
          }
       }
    } 

    return result;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T05:00:40.487

首先，我会稍微重构一下您的逻辑，以将 UI VS 数据库调用稍微分开。其次，重构您的代码以检索使用连接字符串、用户名、密码和输出名和姓的代码的名字和姓氏。

```
string firstName, lastName;
if(ValidateUser(txtusername.Text, txtpassword.Text, out firstName, out lastName)
{
    //put your UI Logic and redirect in here
    lblLogin.Text = "Welcome: " + firstName + " " + " lastName;
}
else
{
    //login faild code
}

private bool ValidateUser(string strConn, string username, string password, out string firstName, out string lastName)
{
    firstName = string.Empty;
    lastName = string.Empty;

    using (var con = new SqlConnection(strConn))
    using (var cmd = con.CreateCommand())
    {
        cmd.CommandText = "Select * From Person Where uname=@uname and upass=@upass";
        cmd.Parameters.AddWithValue("@uname", username);
        cmd.Parameters.AddWithValue("@upass", password);

        con.Open();
        using (var r = cmd.ExecuteReader())
        {
            if (r.Read())
            {
                firstName = r["FName"].ToString();
                lastName = r["LName"].ToString();

                return true;
            }
            else
            {
                return false;
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T04:51:10.103

```
string Name=objDR ["FName"].ToString() +  ["LName"].ToString()
lblLogin.Text = "Logged in as:"+Name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T04:52:00.087

`SqlDataReader`您可以通过以下方式阅读实例：

```
WebConfigurationManager.ConnectionStrings["cloud2"].ConnectionString; protected void btnlogin2_Click(object sender, EventArgs e) {

string strCmd = "Select * From Person Where uname=@uname and upass=@upass";
SqlConnection objConn = new SqlConnection(strConn);
SqlCommand objCmd = new SqlCommand(strCmd, objConn);
objCmd.Parameters.AddWithValue("@uname", txtusername.Text);
objCmd.Parameters.AddWithValue("@upass", txtpassword.Text);

using (objConn)
{
    objConn.Open();
    SqlDataReader objDR = objCmd.ExecuteReader();

    if (objDR.Read())
    {

        string fName= (string)objDR["FName"];
        string lName= (string)objDR["LName"];
        btnlogin2.Visible = false;
        txtusername.Visible = false;
        txtpassword.Visible = false;
       Response.Redirect("member.aspx");
        lblLogin.Text = "Logged in as: Test "+fName+" "+lName; //Display login name?

    }
    else
    {

        btnlogin2.Text = "Failed";

    }
} 
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T05:11:02.443

您的问题是如何从查询中只返回您想要的数据，或者如何从数据读取器访问它？

听起来您可能需要 ExecuteScalar()，并且您可以在查询中组合 fname 和 lastname 字段，这样您就可以只提取一个结果：

```
string strCmd = "Select Fname + ' ' + LName From Person Where uname=@uname and upass=@upass";
SqlConnection objConn = new SqlConnection(strConn);
SqlCommand objCmd = new SqlCommand(strCmd, objConn);
objCmd.Parameters.AddWithValue("@uname", txtusername.Text);
objCmd.Parameters.AddWithValue("@upass", txtpassword.Text);

using (objConn)
{
    objConn.Open();
    var username = objConn.ExecuteScalar() as string;

    if (!string.IsNullOrEmpty())
    {
        btnlogin2.Visible = false;
        txtusername.Visible = false;
        txtpassword.Visible = false;
       Response.Redirect("member.aspx");
        lblLogin.Text = "Logged in as:  " + username ; //Display login name?
    } 
```

编辑：刚刚注意到一个细节......你在重定向后设置 lblLogin.Text ......所以不要认为任何人都会看到它。可以将其添加到查询字符串中并在 member.aspx 上显示...

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-04-05T04:49:08.740

你可以做类似的事情

`lblLogin.Text = "Logged in as: " + objDR.GetString(dr.GetOrdinal("FName")) + " " + objDR.GetString(dr.GetOrdinal("LName"));`

如果有记忆，您可能还需要先调用`objDR.Read();`以开始遍历数据读取器。

# javascript - Selenium IDE - 错误：权限被拒绝 获取属性 Location.href

> ID：10022755
> 
> 赞同：4
> 
> 时间：2012-04-05T04:37:45.987
> 
> 标签：javascript, selenium, cross-domain

我在 Ubuntu 11.10 上运行的 Firefox 11 上使用 Selenium 1.7.2。直到昨天，我们还没有使用`document.domain`javascript。我们需要将它添加到我们生成的 HTML 和我们的一个 javascript 文件中。现在，当我们运行 Selenium IDE 测试套件时，我们会收到以下错误：

```
Error: Permission denied for <http://dev.example.com> to get property Location.href 
```

`dev.example.com`是我们的应用服务器（Glassfish 3.1.2 落后于 Apache+mod_jk）

如果我注释掉`document.domain`一切正常（至少在 Firefox 中，因为 document.domain 是为了防止 IE 阻止 PIE.htc 脚本...*叹息*）

[我尝试添加在这里](http://old.nabble.com/Enhancement-request-for-Selenium-for-document.domain-td3613716.html)找到的用户扩展脚本：

```
function setdom(str,doc,dom) {
  doc.domain = dom;
}

Selenium.prototype.doDocumentDomain = function(domain) {
  var lw;
  setdom('ts',frames['testSuiteFrame'].document, domain);
  setdom('tf', getTestFrame().contentWindow.document, domain);
  setdom('my', frames['myiframe'].document, domain);

  lw = LOG.getLogWindow();
  if (lw) {
    setdom('log', lw.document, domain);
    }
  setdom('doc', document, domain);
  } 
```

但这看起来很旧，可能不再兼容。它在第一次调用该`setdom('ts',frames['testSuiteFrame'].document,domain);`行时返回一个错误

我没有在 HTTP 和 HTTPS 之间来回浏览，我已经阅读了许多 StackOverflow 和 Google Group 相关的问题，但没有结果。

我可以修改我们的代码以`document.domain`仅包含 IE，但它不是很干净......

问题：如何在设置 document.domain 时使 Selenium IDE 工作而没有安全问题？或者我怎样才能修复他上面的用户扩展以在 Selenium IDE 1.7.2 中工作？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:28:00.540

所以我决定更改 Selenium javascript 以允许我使用以下方法设置 document.domain：

在第 920 行的 `chrome/content/selenium-core/scripts/selenium-browserbot.js（适用于 1.7.2 版）中：

```
 //Samit: Fix: open command sometimes fails if current url is chrome and new is not
    windowObject = core.firefox.unwrap(windowObject);
    // -------------- Start My Change ----------------
    updateDomain(windowObject.document);
    // -------------- End My Change ----------------
    if (this._windowClosed(windowObject)) {
        LOG.debug("pollForLoad WINDOW CLOSED (" + marker + ")");
        delete this.pollingForLoad[marker];
        return;
    } 
```

然后在 user-extensions.js 中：

```
var validDomain = null;

Selenium.prototype.doDocumentDomain = function(domain) {
  validDomain = domain;
}

function updateDomain(doc) {
  if(validDomain==null) {
    return;
    }
  LOG.info("Current domain: " + doc.domain);
  if(doc.domain != validDomain && (doc.domain+"").indexOf(validDomain)>0 ) {
    doc.domain = validDomain;
    }
  LOG.info("New domain: " + doc.domain);
  } 
```

我在设置新域之前检查它是否是我要设置的域的子域。我在 Selenium IDE 中使用它：

```
documentDomain | example.com 
```

所以当它打开 dev.example.com 和 static.example.com 时，它会`example.com`在域中找到并替换域。

# objective-c - CALayer 中的事件

> ID：10022756
> 
> 赞同：0
> 
> 时间：2012-04-05T04:37:56.757
> 
> 标签：objective-c, ios, calayer

我在我的代码中使用 CALayers 动画。下面是我的代码

```
CALayer *backingLayer = [CALayer layer];
        backingLayer.contentsGravity = kCAGravityResizeAspect;
        // set opaque to improve rendering speed
        backingLayer.opaque = YES;

        backingLayer.backgroundColor = [UIColor whiteColor].CGColor;

        backingLayer.frame = CGRectMake(0, 0, templateWidth, templateHeight);

        [backingLayer addSublayer:view.layer];
        CGFloat scale = [[UIScreen mainScreen] scale];
        CGSize size = CGSizeMake(backingLayer.frame.size.width*scale, backingLayer.frame.size.height*scale);
        UIGraphicsBeginImageContextWithOptions(size, NO, scale);
        CGContextRef context = UIGraphicsGetCurrentContext();
        [backingLayer renderInContext:context];

        templateImage = UIGraphicsGetImageFromCurrentImageContext();

        UIGraphicsEndImageContext(); 
```

这个backingLayer有很多子层是这样添加的，这个view就是我的subView。但是现在我如何在各个 UIViews 中获取视图的事件，因为我已将它们添加为子层，我正在尝试实现类似 Flipboard 应用程序的功能，即使它们是子层，它们也具有页面导航和单击事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T05:02:41.737

CALayers 的重点是它们重量轻，特别是没有事件处理开销。这就是 UIView 的用途。您的选择是将您的代码转换为使用 UIViews 进行事件跟踪，或者编写您自己的事件传递代码。对于第二个，基本上，你会让你的包含 UIView 为每个子层的边界做一堆“在矩形中的点”查询，并将事件传递给（一个自定义方法）具有最高 z 位置的 CALayer .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T15:59:59.833

正如 claireware 所提到的，CALayers 不直接支持事件处理。但是，您可以在包含 CALayer 的 UIView 中捕获事件，并向 UIView 的隐式层发送“hitTest”消息以确定触摸了哪个层。例如：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];
    CGPoint location = [touch locationInView:self];
    CALayer *target = [self.layer hitTest:location];
    // target is the layer that was tapped
} 
```

以下是 Apple 文档中有关 hitTest 的更多信息：

```
Returns the farthest descendant of the receiver in the layer hierarchy (including itself) that contains a specified point.

Return Value
The layer that contains thePoint, or nil if the point lies outside the receiver’s bounds rectangle. 
```

# android - 使用android模拟器捕获和保存图像时出现空指针异常

> ID：10022758
> 
> 赞同：3
> 
> 时间：2012-04-05T04:38:02.270
> 
> 标签：android, android-emulator

我正在尝试通过 Android 模拟器捕获和保存图像，正在捕获图像，但正在保存的文件已损坏。

这可能是什么原因造成的？谁能帮我找出可能的错误点？

下面是我的代码：

```
**public void onCreate**(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    **Intent** intent = new **Intent**("android.media.action.IMAGE_CAPTURE");
    try {
        fileUri = getOutputMediaFileUri(MEDIA_TYPE_IMAGE);
    } 

    catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    intent.putExtra(**MediaStore**.EXTRA_OUTPUT, fileUri);
    startActivityForResult(intent, CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE);
}

@Override
**protected void onActivityResult**(int requestCode, int resultCode, Intent data) {
    if (requestCode == CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE) {
        if (resultCode == RESULT_OK) {
            StoreImage(this, data.getData(),
            mediaFile);
            finish();
        } 

        else if (resultCode == RESULT_CANCELED) {
            // User cancelled the image capture
        } 

        else {
            finish();
            try {
            } 

            catch (Exception e) {
               e.printStackTrace();
            }
        }
    }

} 
```

**堆栈跟踪如下::**

```
04-05 23:55:40.369: E/AndroidRuntime(534): FATAL EXCEPTION: main
04-05 23:55:40.369: E/AndroidRuntime(534): java.lang.RuntimeException: Unable to start activity ComponentInfo{camera.android/camera.android.CameraActivity}: java.lang.NullPointerException: file
04-05 23:55:40.369: E/AndroidRuntime(534):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1955)

04-05 23:55:40.369: E/AndroidRuntime(534): Caused by: java.lang.NullPointerException: file
04-05 23:55:40.369: E/AndroidRuntime(534):  at android.net.Uri.fromFile(Uri.java:441)
04-05 23:55:40.369: E/AndroidRuntime(534):  at camera.android.CameraActivity.getOutputMediaFileUri(CameraActivity.java:72)
04-05 23:55:40.369: E/AndroidRuntime(534):  at camera.android.CameraActivity.onCreate(CameraActivity.java:34)
04-05 23:55:40.369: E/AndroidRuntime(534):  at android.app.Activity.performCreate(Activity.java:4465)
04-05 23:55:40.369: E/AndroidRuntime(534):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
04-05 23:55:40.369: E/AndroidRuntime(534):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1919) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T04:44:32.737

换乘这条线，

```
if (requestCode == CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE) {
                if (resultCode == RESULT_OK) { 
```

到

```
 if (resultCode == RESULT_OK) {
                    if (requestCode == CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE) { 
```

首先检查子活动是否成功完成其工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T05:49:35.303

检查您是否在清单文件中添加了以下权限::

```
<uses-feature android:name="android.hardware.camera" />
<uses-feature android:name="android.hardware.camera.autofocus" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.CAMERA" /> 
```

也在

```
fileUri = getOutputMediaFileUri(MEDIA_TYPE_IMAGE); 
```

我认为您还必须附上要保存的文件名，仅提供路径是不够的....

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T08:28:24.137

“@Agarwal：关于调用 onActivityResult”

```
@Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        if (requestCode == CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE) {
            if (resultCode == RESULT_OK) {
                StoreImage(this, data.getData(), mediaFile);
                finish();

            } else if (resultCode == RESULT_CANCELED) {
                // User cancelled the image capture
            } else {
                finish();
                try {

                } catch (Exception e) {
                    e.printStackTrace();
                }
            }

        }

    } 
```

“如果结果成功，则将来自实习生的数据存储为 n 文件，该文件创建并保存为 jpeg 格式”

```
public static void StoreImage(Context mContext, Uri imageLoc, File imageDir) {
        Bitmap bm = null;
        try {
            bm = Media.getBitmap(mContext.getContentResolver(), imageLoc);
            FileOutputStream out = new FileOutputStream(imageDir);
            bm.compress(Bitmap.CompressFormat.JPEG, 100, out);
            bm.recycle();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (Exception e) {
            e.printStackTrace();
        }

    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-18T10:21:10.883

试试下面的代码，

```
Intent i = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);

    File file=getOutputMediaFile(1);
    picUri = Uri.fromFile(file); // create
    i.putExtra(MediaStore.EXTRA_OUTPUT,picUri); // set the image file

    startActivityForResult(i, CAPTURE_IMAGE); 
```

getOutputMediaFile(int) 将在哪里，

```
/** Create a File for saving an image */
private  File getOutputMediaFile(int type){
    File mediaStorageDir = new File(Environment.getExternalStoragePublicDirectory(
              Environment.DIRECTORY_PICTURES), "MyApplication");

    /**Create the storage directory if it does not exist*/
    if (! mediaStorageDir.exists()){
        if (! mediaStorageDir.mkdirs()){
            return null;
        }
    }

    /**Create a media file name*/
    String timeStamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());
    File mediaFile;
    if (type == 1){
        mediaFile = new File(mediaStorageDir.getPath() + File.separator +
        "IMG_"+ timeStamp + ".png");
    } else {
        return null;
    }

    return mediaFile;
} 
```

最后，

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (resultCode == Activity.RESULT_OK) {
        Intent i;
        switch (requestCode) {
        case CAPTURE_IMAGE:
            //THIS IS YOUR Uri
            Uri uri=picUri; 
            break;
        }
    }   
} 
```

干杯....：）

# html - 如何设置html样式 像谷歌这样的标签？

> ID：10022759
> 
> 赞同：-6
> 
> 时间：2012-04-05T04:38:05.883
> 
> 标签：html, tags, styles

查看[gmail 注册](https://accounts.google.com/SignUp?service=mail)页面并查看生日和性别字段。请有人告诉我怎么做。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:46:14.233

能做成这样的不是风格。这是一个图像+输入框，当您单击图像时，会在 javascript 中生成 DIV 并填充其中的所有条目。类似的例子是[这样](http://www.jankoatwarpspeed.com/examples/reinventing-drop-down/#)的。

# image - 我想在游戏中使用大的背景图像，背景移动而角色保持不变，图像使用什么文件格式？

> ID：10022769
> 
> 赞同：0
> 
> 时间：2012-04-05T04:39:56.100
> 
> 标签：image

我使用的平台是java小程序，我想知道我是否应该使用jpg，gif，png

jpg往往会降低游戏速度，gif闪烁太多对png的速度没有太大希望

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:28:37.037

对于性能和内存消耗而言，一张大图像通常是个坏主意。您想将其拆分为较小的块并在不使用时加载/卸载它们。

在 java2D 中，我总是使用 PNG。在其他库中，这可能并不重要，因为它们会将图像格式转换为对 GPU 更友好的格式。

另一方面，bmp 加载速度更快（您不需要处理-即解压缩-图像），但它可能会增加您的整体游戏大小。

# php - 如何使用 jquery 设置动态下拉列表的选定值？

> ID：10022772
> 
> 赞同：1
> 
> 时间：2012-04-05T04:40:21.200
> 
> 标签：php, jquery, html, drop-down-menu

我有一个在页面加载时使用 ajax 动态生成的下拉列表。另一方面，我有一个 php 变量，其中包含默认选择的值。但是，当我尝试这样做时，它并没有选择值。以下是代码：

HTML 和 PHP

```
<h1>Venue: Edit</h1>
<a href="/venue"><< Back to Venue List</a>
<br />
<form method="post" id="venueEdit" action="<?php echo URL;?>venue/editSave/<?php echo $this->venue['id']; ?>">
    <fieldset>
            <p>
                <label for="cvenue" class="main">Venue</label>
                <input id="cvenue" class="required" type="text" name="venue" value="<?php echo $this->venue['name']; ?>" />
            </p>
            <p>
                <label for="ccity" class="main">City</label>
                <input id="ccity" class="required" type="text" name="city" value="<?php echo $this->venue['city']; ?>" />
            </p>
            <p>
                <label for="ccountry" class="main">Country</label>
                    <select id="ccountry" class="required" name="country">
                        <option value="">-- Select Country --</option>
                    </select>

            </p>
            <p>
                <label class="main">&nbsp;</label><input type="submit" value="Save" />
            </p>
        </fieldset>   
</form> 
```

JS：

```
function populateCountryDropDown(url){
    $.get(url, function(o) {
        for(var i = 0; i < o.length; i++){
            $('select[name="country"]').append('<option value="' + o[i].id + '">' + o[i].name + "</option>");
        }
    }, 'json');
}

$(document).ready(function(){
        populateCountryDropDown('<?php echo URL; ?>' + 'country/xhrGetCountryList');
        $('select[name="country"]').val('<?php echo $this->venue['countryid']; ?>');
        $("#venueEdit").validate();
    }); 
```

我试图提醒 php 值，这没关系，但如果我提醒选择选项值，它始终为空，因为此时它仍在填充下拉列表。我不知道如何解决这个问题。会感谢你们的帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:51:11.430

您需要移动代码以将值设置到回调中，以在 AJAX 调用由返回触发*后触发设置的值。*`$.get()`

```
function populateCountryDropDown(url){
    $.get(url, function(o) {
        for(var i = 0; i < o.length; i++){
            $('select[name="country"]').append('<option value="' + o[i].id + '">' + o[i].name + "</option>");
        }
        $('select[name="country"]').val('<?php echo $this->venue['countryid']; ?>');
        $("#venueEdit").validate();
    }, 'json');
}

$(document).ready(function(){
        populateCountryDropDown('<?php echo URL; ?>' + 'country/xhrGetCountryList');
}); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-05T04:51:45.130

这段代码在这里：

```
$('select[name="country"]').val('<?php echo $this->venue['countryid']; ?>'); 
```

尝试更改为：

```
$('select[name="country"]').val('<?php echo $this->venue["countryid"]; ?>');  // Double quotes around countryid vs the single quote. 
```

# php - 用于实时执行分析的 PHP 工具？

> ID：10022777
> 
> 赞同：0
> 
> 时间：2012-04-05T04:40:53.643
> 
> 标签：php, code-analysis, php-ide

对于那些曾经以需要一些非常复杂的公式的方式使用[Microsoft Excel](http://en.wikipedia.org/wiki/Microsoft_Excel)的人来说，您可能已经注意到有一个功能，您可以“进入”公式以实时查看正在计算的数据每个函数，一个单元格的真实值等等。

我白天是[SAP](http://en.wikipedia.org/wiki/SAP_ERP)顾问，晚上是 coder，在 SAP 中运行 debug 模式非常强大。它可以让您设置断点，在您逐步执行代码中的循环、函数调用等时实时查看变量，这对于开发分析非常有用。

PHP 世界中是否有任何工具可以让某人对代码执行进行这种实时分析？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:44:15.903

我建议你试试[Eclipse](http://en.wikipedia.org/wiki/Eclipse_%28software%29)（[下载](http://www.eclipse.org/pdt/downloads/)）：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:44:54.390

看看[XDebug](http://xdebug.org/docs/)，一个 PHP 扩展。

# prolog - Prolog - 列表的不寻常的 cons 语法

> ID：10022779
> 
> 赞同：26
> 
> 时间：2012-04-05T04:41:12.557
> 
> 标签：prolog, iso-prolog

*[我在 Lee Naish 的论文Higher-order logic programming in Prolog](http://www.csee.umbc.edu/771/papers/mu_96_02.pdf)*中遇到了一些不熟悉的 Prolog 语法。这是论文中的第一个代码示例：

```
% insertion sort (simple version)
isort([], []).
isort(A.As, Bs) :-
    isort(As, Bs1),
    isort(A, Bs1, Bs).

% insert number into sorted list
insert(N, [], [N]).
insert(N, H.L, N.H.L) :-
    N =< H.
insert(N, H.LO, H.L) :-
    N > H,
    insert(N, LO, L). 
```

我的困惑在于`A.As`in `isort(A.As, Bs) :-`。从上下文来看，它*似乎*是列表的另一种 cons 语法，相当于`isort([A|As], Bs) :-`.

也`N.H.L`似乎是一种更方便的说法`[N|[H|L]]`。

但是 SWI Prolog 不会接受这种不寻常的语法（除非我做错了什么）。

有人认得吗？我的假设正确吗？哪个 Prolog 解释器接受它作为有效语法？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-05T13:02:09.933

点运算符用于 1972 年第一个 Prolog 系统中的列表，用 Algol-W 编写，有时称为 Prolog 0。它的灵感来自 LISP 系统中的类似符号。以下示例来自 Alain Colmerauer 和 Philippe Roussel（Prolog 的创造者）的论文[Prolog 的诞生。](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.85.7438)

```
+ELEMENT(*X, *X.*Y).
+ELEMENT(*X, *Y.*Z) -ELEMENT(*X, *Z). 
```

那个时候，`[]`曾经`NIL`。

下一个 Prolog 版本由 Battani & Meloni 用 Fortran 编写，使用案例来区分原子和变量。然后，DECsystem 10 Prolog 引入了方括号表示法，替换`nil`and `X.Xs`with `[]`and `[X,..Xs]`，在后来的 DECsystem 10 版本中，它`[X|Xs]`作为替代方案被接收。在 ISO Prolog 中，只有`[X|Xs]`,`.(X,Xs)`和 as 规范语法`'.'(X,Xs)`。

请注意，点在 ISO Prolog 中有许多不同的角色。它已经作为

*   **后跟一个`%`或布局字符（如 SPACE、NEWLINE、TAB）时的**结束标记。****

***   **浮点数中的小数点**，例如`3.14159`

    *   **图形标记 char**形成图形标记为`=..`** 

 **因此，如果您现在声明`.`为中缀运算符，则必须非常小心。无论是您编写的内容还是 Prolog 系统将读取的内容。一个额外的空格可以改变一个术语的含义。考虑两种符号中的两个数字列表：

```
[1,2.3,4]. [5].
1 .2.3.4.[]. 5.[]. 
```

请注意，您必须在 . 之后添加一个空格`1`。在这种情况下，数字前面的额外空格可能会改变您的术语的含义。像这样：

```
[1|2.3]. [4]. 5\. [].
1 .2.3\. 4.[]. 5\. []. 
```

这是另一个可能更有说服力的例子：

```
[1,-2].
1.(-2).[]. 
```

负数需要点列表中的圆括号。

今天，只剩下 YAP 和 XSB 仍然`.`默认提供中缀——而且[它们的做法不同](http://www.complang.tuwien.ac.at/ulrich/iso-prolog/conformity_assessment#141)。XSB 甚至无法识别上述点语法：您需要在一些非负数周围加上圆括号。

你写的那`N.H.L`似乎是一种更方便的说法`[N|[H|L]]`。有一个简单的经验法则可以简化 ISO Prolog 中的此类表达式：每当您在列表中看到标记`|`并且`[`紧随其后时，您可以将它们替换为`,`（并删除`]`右侧的相应标记）。所以你现在可以写：`[N,H|L]`看起来还**不错**。

您也可以在另一个方向使用该规则。如果我们有一个列表`[1,2,3,4,5]`，我们可以将`|`其用作“剃须刀片”，如下所示 `[1,2,3|[4,5]]`：

* * *

再说一句，因为您正在阅读 Naish 的论文：同时，[很好理解](http://www.complang.tuwien.ac.at/ulrich/Prolog-inedit/naish.html)only`call/N`是必需的！并且 ISO Prolog支持最多`call/1`.`call/2``call/8`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-05T06:52:44.180

是的，你是对的，点是列表*cons*中缀运算符。它实际上是 ISO Prolog 标准所要求的，但通常是隐藏的。我前段时间发现（并使用过）该语法：

```
:- module(eog, []).
:- op(103, xfy, (.)).

% where $ARGS appears as argument, replace the call ($ARGS) with a VAR
% the calle goes before caller, binding the VAR (added as last ARG)
funcs(X, (V, Y)) :-
    nonvar(X),
    X =.. W.As,

    % identify meta arguments
    (   predicate_property(X, meta_predicate M)
        % explicitly exclude to handle test(dcg)
        % I'd like to handle this case in general way...
    ,   M \= phrase(2, ?, ?)
    ->  M =.. W.Ms
    ;   true
    ),

    seek_call(As, Ms, Bs, V),
    Y =.. W.Bs.

% look for first $ usage
seek_call([], [], _Bs, _V) :-
    !, fail.
seek_call(A.As, M.Ms, A.Bs, V) :-
    M @>= 0, M @=< 9, % skip meta arguments
    !, seek_call(As, Ms, Bs, V).
seek_call(A.As, _, B.As, V) :-
    nonvar(A),
    A = $(F),
    F =.. Fp.FAs,
    (   current_arithmetic_function(F) % inline arith
    ->  V = (PH is F)
    ;   append(FAs, [PH], FBs),
        V =.. Fp.FBs
    ),
    !, B = PH.
seek_call(A.As, _.Ms, B.As, V) :-
    nonvar(A),
    A =.. F.FAs,
    seek_call(FAs, Ms, FBs, V),
    !, B =.. F.FBs.
seek_call(A.As, _.Ms, A.Bs, V) :-
    !, seek_call(As, Ms, Bs, V).

:- multifile user:goal_expansion/2.
user:goal_expansion(X, Y) :-
    ( X = (_ , _) ; X = (_ ; _) ; X = (_ -> _) )
    -> !, fail % leave control flow unchanged (useless after the meta... handling?)
    ;  funcs(X, Y).

/* end eog.pl */ 
```

有人建议我不要这样做。实际上，[A|B] 语法是 . 运算符，为了可读性而引入。

**OT**：那是什么代码？

上面的代码是我尝试用函数使 Prolog 变得更甜。即，根据要求引入`$`算术表达式所需的临时变量（例如）

```
fact(N, F) :-
     N > 1 -> F is N * $fact($(N - 1)) ; F is 1. 
```

每个 $ 引入一个变量。展开后，我们有一个更传统的事实/2

```
?- listing(fact).
plunit_eog:fact(A, C) :-
    (   A>1
    ->  B is A+ -1,
        fact(B, D),
        C is A*D
    ;   C is 1
    ). 
```

在我们有很多表达方式的地方，这可能很有用......

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-05T06:22:37.467

此语法来自 NU-Prolog。见[这里](http://ww2.cs.mu.oz.au/~lee/src/nuprolog/)。它可能只是普通的列表仿函数 '.'/2 重新定义为中缀运算符，而不需要尾随的空列表：

```
?- L= .(a,.(b,[])).
L = [a,b]
Yes (0.00s cpu)
?- op(500, xfy, '.').
Yes (0.00s cpu)
?- L = a.b.[].
L = [a,b]
Yes (0.00s cpu) 
```**

# javascript - 为逗号分隔的单词生成搜索链接

> ID：10022781
> 
> 赞同：0
> 
> 时间：2012-04-05T04:41:26.000
> 
> 标签：javascript, list, hyperlink, keyword

一如既往，非常重视您的帮助<3

我的网站上有描述中包含元数据关键字的列表。我想让这些看起来像标签（我们的 cms 不支持标签，因此这个 hack）。它只打印用逗号分隔的单词，如下所示：

```
<div class="tags">abp, accredited building practitioners, calendar of events, upcoming events</div> 
```

javascript 是否能够在这些 div 中找到任何单词并用链接到 oursite.com/search?query=THEWORD 的 href 替换它们？如果是这样，是否有人可以共享脚本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:50:56.423

**看一下这个。如果您看到的警报消息是您要查找的内容，则只需将其附加到 div 中。 [http://jsfiddle.net/UH5U9/3/](http://jsfiddle.net/UH5U9/3/)

## 编辑

```
$('.tags').each(function(){
var s = $(this).html()

a = s.split(',');      
var temp='';      
for (var i = 0; i < a.length; i++)
{
    temp =temp + '<a href="oursite.com/search?query='+a[i]+'">'+a[i]+'</a>';

 }
$(this).html('');
$(this).html(temp);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T05:05:18.140

这是一个用一点 jQuery 构建的工作函数，虽然可以很容易地转换为基本的 JavaScript：

**jQuery：**

```
<script>
    $(function(){
        $('.tags').each(function(){
            var obj=$(this),tags=obj.text().split(','),i=0,len=tags.length;
            if(obj.text()) {
                for(i;i<len;i++) {
                    var tag=tags[i].replace(/(^\s*)|(\s*$)/g,'');
                    tags[i]='<a href="http://oursite.com/search?query='+encodeURIComponent(tag)+'">'+tag+'</a>';
                }
                obj.html(tags.join(', '));
            }
        });
    });
</script> 
```

**HTML：**

```
<div class="tags">abp, accredited building practitioners, calendar of events, upcoming events</div>
<div class="tags">test, another test, some more testing, etc</div>
<div class="tags">the, code, needed, to, be , in, an, each(), loop</div>
<div class="tags"></div>
<div class="tags">random, words, that, show, work, hopefully</div>
<div class="tags">the, return, false, was, causing, problems</div>
<div class="tags"></div> 
```

# css - 使用三个图像和 css 的按钮的圆角

> ID：10022787
> 
> 赞同：-1
> 
> 时间：2012-04-05T04:42:34.053
> 
> 标签：css, internet-explorer, rounded-corners

我正在寻找一种在 css 中使用三个图像作为背景 url 来创建带圆角的链接/按钮的方法。左侧的图像左上角和左下角的圆角，中间的图像可重复，右侧的图像右上角和右下角的圆角。

理想情况下，代码可以同时用于链接和按钮，理想情况下我不需要为每个链接或按钮指定宽度。如果可能，宽度将是文本的宽度和一些边距或按钮的宽度。

Internet Explorer 7-9 以及最新版本的 Firefox、Chrome 和 Safari 是否可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:25:03.403

嗨，您可以定义三个 div 并像这样定义属性

您可以在背景中定义图像替换为颜色。

**CSS**

```
a{
    display:inline-block;
}

.left, .middle, .right{
    float:left;
    height:100px;
    width:100px;
}

.left{
    background:yellow url(../..) no-repeat ;
}

.middle{
    background:red url(../..) repeat-x;
    width:auto;
    line-height:100px;
}

.right{
    background:green url(../..) no-repeat;
} 
```

**HTML**

```
<a href="">
<span class="left"></span>
<span class="middle">Heere you text </span>
<span class="right"></span>
</a>
​ 
```

现场演示[http://jsfiddle.net/rohitazad/HAjLZ/](http://jsfiddle.net/rohitazad/HAjLZ/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:46:16.357

您不需要预先分割背景图像。看看这个页面上的按钮：http: [//easyhanzi.com/](http://easyhanzi.com/)

这是仅使用一张使用 CSS 分割的图像来完成的。然后是三个DIV——一个左、一个中间和一个右。内容可以有任何宽度。

这是HTML：

```
<div id="download-button">
    <div id="download-button-left"></div>
    <div id="download-button-middle">
        <center><div id="download-button-main-text">Download free trial</div><div id="download-button-subtext">Version 3.1 for Windows</div></center>
    </div> <!-- download-button-middle -->
    <div id="download-button-right"></div>
</div> 
```

和 CSS：

```
#download-button-left {
    float: left;
    background: url(img/download-button.png) 0 0;
    width: 12px;
    height: 85px;
}

#download-button-middle {
    color: #ffffff;
    padding-right: 20px;
    padding-left: 20px;
    padding-top: 15px;

    float: left;
    background: url(img/download-button.png) -12px 0;
    width: auto;
    padding-left: 20px;
    height: 70px;
}

#download-button-right {
    float: left;
    background: url(img/download-button.png) -399px 0;
    width: 12px;
    height: 85px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T04:51:03.027

您可以将 jquery mobile 用于此链接中显示的水平分组按钮----> [Grouped Buttons](http://jquerymobile.com/demos/1.1.0-rc.1/docs/buttons/buttons-grouped.html)

# c++ - 具有非静态成员函数的 std::function

> ID：10022789
> 
> 赞同：17
> 
> 时间：2012-04-05T04:42:40.027
> 
> 标签：c++, winapi, visual-studio-2010

我试图理解一个概念和一个错误。这有什么问题？

```
class A
{
public:
    A()
    {
        std::function<void(int)> testFunc(&A::func);
    }

private:
    void func(int) {}
} 
```

我的问题是，是否可以创建任何类型的对象，该对象能够调用特定实例的成员，其中 std::function 就像成员函数指针一样，除非没有不能用作函数参数的古怪类型定义在继承类。例如：

```
class A
{
public:
    A()
    {
         index[WM_CREATE] = &A::close;
         index[WM_DESTROY] = &A::destroy;
    }

protected:
    map<UINT msg, void (A::*)(HWND, UINT , WPARAM, LPARAM)> index;
    void close(HWND,UINT, WPARAM, LPARAM);
    void destroy(HWND, UINT, WPARAM, LPARAM);
};

class B : public A
{
public:
    B()
    {
        index[WM_CREATE] = &B::create; // error because it's not a pointer of type A::*
    }
private:
    void create(HWND, UINT, WPARAM, LPARAM);

}; 
```

我在想我在使用 std::functions 的正确轨道上，如下所示：

```
class A
{
public:             //         Gigantic stl error with these two
    A()             //                         |
    {               //                         V
         index[WM_CREATE] = std::function<void(HWND, UINT, WPARAM, LPARAM>(&A::close);
         index[WM_DESTROY] = std::function<void(HWND, UINT, WPARAM, LPARAM>(&A::destroy);
    }

protected:
    map<UINT msg, std::function<void(HWND, UINT, WPARAM, LPARAM)> > index;
    void close(HWND,UINT, WPARAM, LPARAM);
    void destroy(HWND, UINT, WPARAM, LPARAM);
};

class B : public A
{
public:                    //               and this one
    B()                    //                     |
    {                      //                     V
        index[WM_CREATE] = std::function<void(HWND, UINT, WPARAM, LPARAM)>(&B::create);
    }
private:
    void create(HWND, UINT, WPARAM, LPARAM);

}; 
```

如果有人能解释这些巨大的神秘错误的含义以及如何解决它们，我将不胜感激。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-05T05:18:06.573

我认为您遇到的问题是成员函数不仅需要函数指针，还需要指向调用对象的指针。换句话说，成员函数有一个额外的隐式参数，即指向调用对象的指针。

要将成员函数设置为 std::function，您需要像这样使用 std::bind：

```
std::function<void(int)> testFunc(std::bind(&A::func, this, _1)); 
```

这将当前 A 实例的 this 指针绑定到函数，因此它具有函数指针和对象实例，这些信息足以正确调用函数。_1 参数表示在调用函数时将提供第一个显式参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-08-16T07:27:56.373

使用 c++11，您还可以使用比以下内容更容易阅读的 lambda `std::bind`：

```
index[WM_CREATE] = [this](HWND h, UINT u, WPARAM w, LPARAM l)
{
  create(h, u, w, l);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T05:16:29.710

> 我的问题是，是否可以创建能够调用特定实例成员的任何类型的对象

在这种情况下，唯一缺少的信息实际上是`std::function`对象应该使用的特定实例：`&A::func`不能单独使用（例如与 instance 一起`(this->*&A::func)(0)`使用）。尝试：`&A::func``*this`

```
std::function<void(int)> testFunc = std::bind(&A::func, this); 
```

（注意这一点`std::bind(&A::func, *this)`，`std::bind(&A::func, this)`语义略有不同。）

# .net - 如何在没有窗口句柄的情况下使用 RegisterDeviceNotification？

> ID：10022794
> 
> 赞同：3
> 
> 时间：2012-04-05T04:43:32.707
> 
> 标签：.net, vb.net, dll, usb, winusb

我正在编写一个 DLL 库，它在 VB.NET 中使用 winusb 连接到 USB 设备。

因为它是一个 DLL，所以我没有窗口，而且我的库的用户也可能没有窗口（例如命令行应用程序）。

我见过的示例检测设备附加和分离所有使用`RegisterDeviceNotification`，这需要一个窗口句柄来接收附加/分离消息。

如何在没有窗口的情况下将这些消息直接接收到函数中以获取句柄？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-04T16:17:42.363

对于没有 GUI 的应用程序，我最近发现了一个似乎比 RegisterDeviceNotification 更优雅的解决方案。

```
 void onEventArrived(object sender, EventArrivedEventArgs e)
    {
        ManagementBaseObject _o = e.NewEvent["TargetInstance"] as ManagementBaseObject;

        if (_o != null)
        {
            using (ManagementObject mo = new ManagementObject(_o["Dependent"].ToString()))
            {
                if (mo != null)
                {
                    try
                    {
                        if (mo.GetPropertyValue("DeviceID").ToString() != string.Empty)
                        {
                            //connected
                        }
                    }

                    catch (ManagementException ex)
                    {
                        //disconnected
                    }
                }
            }
        }
    } 
```

通过调用初始化此代码

```
 System.Management.WqlEventQuery _q = new WqlEventQuery("__InstanceOperationEvent", "TargetInstance ISA 'Win32_USBControllerDevice' ");
        _q.WithinInterval = TimeSpan.FromSeconds(1);
        ManagementEventWatcher _w = new ManagementEventWatcher(_q);
        _w.EventArrived += new EventArrivedEventHandler(onEventArrived);
        _w.Start(); 
```

还要确保添加对 System.Management 的引用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T14:57:30.317

虽然这不适用于 .NET，但它在 C++ 中提供了一个模板，用于创建处理窗口回调所需的结构，并提供了一种在没有真实窗口的情况下注册自定义窗口句柄的方法：

[http://msdn.microsoft.com/en-us/library/aa363432%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa363432%28VS.85%29.aspx)

> 此示例使用窗口句柄来通知设备更改，并包含大量代码来支持窗口机制。打算作为 Windows 服务安装的应用程序将包含不同的支持代码。
> 
> 每当发送 USB 设备接口事件通知时，应用程序都会收到 WM_DEVICECHANGE 消息。
> 
> 系统向所有应用程序和服务广播一组默认设备更改事件。您无需注册即可接收这些默认事件。有关详细信息，请参阅 RegisterDeviceNotification 中的备注部分。
> 
> ```
> #include <windows.h>
> #include <stdio.h>
> #include <tchar.h>
> #include <strsafe.h>
> #include <dbt.h>
> 
> // This GUID is for all USB serial host PnP drivers, but you can replace it 
> // with any valid device class guid.
> GUID WceusbshGUID = { 0x25dbce51, 0x6c8f, 0x4a72, 
>                       0x8a,0x6d,0xb5,0x4c,0x2b,0x4f,0xc8,0x35 };
> 
> // For informational messages and window titles
> PWSTR g_pszAppName;
> 
> // Forward declarations
> void OutputMessage(HWND hOutWnd, WPARAM wParam, LPARAM lParam);
> void ErrorHandler(LPTSTR lpszFunction);
> 
> //
> // DoRegisterDeviceInterfaceToHwnd
> //
> BOOL DoRegisterDeviceInterfaceToHwnd( 
>     IN GUID InterfaceClassGuid, 
>     IN HWND hWnd,
>     OUT HDEVNOTIFY *hDeviceNotify 
> )
> // Routine Description:
> //     Registers an HWND for notification of changes in the device interfaces
> //     for the specified interface class GUID. 
> 
> // Parameters:
> //     InterfaceClassGuid - The interface class GUID for the device 
> //         interfaces. 
> 
> //     hWnd - Window handle to receive notifications.
> 
> //     hDeviceNotify - Receives the device notification handle. On failure, 
> //         this value is NULL.
> 
> // Return Value:
> //     If the function succeeds, the return value is TRUE.
> //     If the function fails, the return value is FALSE.
> 
> // Note:
> //     RegisterDeviceNotification also allows a service handle be used,
> //     so a similar wrapper function to this one supporting that scenario
> //     could be made from this template.
> {
>     DEV_BROADCAST_DEVICEINTERFACE NotificationFilter;
> 
>     ZeroMemory( &NotificationFilter, sizeof(NotificationFilter) );
>     NotificationFilter.dbcc_size = sizeof(DEV_BROADCAST_DEVICEINTERFACE);
>     NotificationFilter.dbcc_devicetype = DBT_DEVTYP_DEVICEINTERFACE;
>     NotificationFilter.dbcc_classguid = InterfaceClassGuid;
> 
>     *hDeviceNotify = RegisterDeviceNotification( 
>         hWnd,                       // events recipient
>         &NotificationFilter,        // type of device
>         DEVICE_NOTIFY_WINDOW_HANDLE // type of recipient handle
>         );
> 
>     if ( NULL == *hDeviceNotify ) 
>     {
>         ErrorHandler(TEXT("RegisterDeviceNotification"));
>         return FALSE;
>     }
> 
>     return TRUE;
> }
> 
> //
> // MessagePump
> //
> void MessagePump(
>     HWND hWnd
> )
> // Routine Description:
> //     Simple main thread message pump.
> //
> 
> // Parameters:
> //     hWnd - handle to the window whose messages are being dispatched
> 
> // Return Value:
> //     None.
> {
>     MSG msg; 
>     int retVal;
> 
>     // Get all messages for any window that belongs to this thread,
>     // without any filtering. Potential optimization could be
>     // obtained via use of filter values if desired.
> 
>     while( (retVal = GetMessage(&msg, NULL, 0, 0)) != 0 ) 
>     { 
>         if ( retVal == -1 )
>         {
>             ErrorHandler(TEXT("GetMessage"));
>             break;
>         }
>         else
>         {
>             TranslateMessage(&msg);
>             DispatchMessage(&msg);
>         }
>     } 
> }
> 
> //
> // WinProcCallback
> //
> INT_PTR WINAPI WinProcCallback(
>                               HWND hWnd,
>                               UINT message,
>                               WPARAM wParam,
>                               LPARAM lParam
>                               )
> // Routine Description:
> //     Simple Windows callback for handling messages.
> //     This is where all the work is done because the example
> //     is using a window to process messages. This logic would be handled 
> //     differently if registering a service instead of a window.
> 
> // Parameters:
> //     hWnd - the window handle being registered for events.
> 
> //     message - the message being interpreted.
> 
> //     wParam and lParam - extended information provided to this
> //          callback by the message sender.
> 
> //     For more information regarding these parameters and return value,
> //     see the documentation for WNDCLASSEX and CreateWindowEx.
> {
>     LRESULT lRet = 1;
>     static HDEVNOTIFY hDeviceNotify;
>     static HWND hEditWnd;
>     static ULONGLONG msgCount = 0;
> 
>     switch (message)
>     {
>     case WM_CREATE:
>         //
>         // This is the actual registration., In this example, registration 
>         // should happen only once, at application startup when the window
>         // is created.
>         //
>         // If you were using a service, you would put this in your main code 
>         // path as part of your service initialization.
>         //
>         if ( ! DoRegisterDeviceInterfaceToHwnd(
>                         WceusbshGUID, 
>                         hWnd,
>                         &hDeviceNotify) )
>         {
>             // Terminate on failure.
>             ErrorHandler(TEXT("DoRegisterDeviceInterfaceToHwnd"));
>             ExitProcess(1);
>         }
> 
>         //
>         // Make the child window for output.
>         //
>         hEditWnd = CreateWindow(TEXT("EDIT"),// predefined class 
>                                 NULL,        // no window title 
>                                 WS_CHILD | WS_VISIBLE | WS_VSCROLL | 
>                                 ES_LEFT | ES_MULTILINE | ES_AUTOVSCROLL, 
>                                 0, 0, 0, 0,  // set size in WM_SIZE message 
>                                 hWnd,        // parent window 
>                                 (HMENU)1,    // edit control ID 
>                                 (HINSTANCE) GetWindowLong(hWnd, GWL_HINSTANCE), 
>                                 NULL);       // pointer not needed 
> 
>         if ( hEditWnd == NULL )
>         {
>             // Terminate on failure.
>             ErrorHandler(TEXT("CreateWindow: Edit Control"));
>             ExitProcess(1);
>         }
>         // Add text to the window. 
>         SendMessage(hEditWnd, WM_SETTEXT, 0, 
>             (LPARAM)TEXT("Registered for USB device notification...\n")); 
> 
>         break;
> 
>     case WM_SETFOCUS: 
>         SetFocus(hEditWnd); 
> 
>         break;
> 
>     case WM_SIZE: 
>         // Make the edit control the size of the window's client area. 
>         MoveWindow(hEditWnd, 
>                    0, 0,                  // starting x- and y-coordinates 
>                    LOWORD(lParam),        // width of client area 
>                    HIWORD(lParam),        // height of client area 
>                    TRUE);                 // repaint window 
> 
>         break;
> 
>     case WM_DEVICECHANGE:
>     {
>         //
>         // This is the actual message from the interface via Windows messaging.
>         // This code includes some additional decoding for this particular device type
>         // and some common validation checks.
>         //
>         // Note that not all devices utilize these optional parameters in the same
>         // way. Refer to the extended information for your particular device type 
>         // specified by your GUID.
>         //
>         PDEV_BROADCAST_DEVICEINTERFACE b = (PDEV_BROADCAST_DEVICEINTERFACE) lParam;
>         TCHAR strBuff[256];
> 
>         // Output some messages to the window.
>         switch (wParam)
>         {
>         case DBT_DEVICEARRIVAL:
>             msgCount++;
>             StringCchPrintf(
>                 strBuff, 256, 
>                 TEXT("Message %d: DBT_DEVICEARRIVAL\n"), msgCount);
>             break;
>         case DBT_DEVICEREMOVECOMPLETE:
>             msgCount++;
>             StringCchPrintf(
>                 strBuff, 256, 
>                 TEXT("Message %d: DBT_DEVICEREMOVECOMPLETE\n"), msgCount);
>             break;
>         case DBT_DEVNODES_CHANGED:
>             msgCount++;
>             StringCchPrintf(
>                 strBuff, 256, 
>                 TEXT("Message %d: DBT_DEVNODES_CHANGED\n"), msgCount);
>             break;
>         default:
>             msgCount++;
>             StringCchPrintf(
>                 strBuff, 256, 
>                 TEXT("Message %d: WM_DEVICECHANGE message received, value %d unhandled.\n"), 
>                 msgCount, wParam);
>             break;
>         }
>         OutputMessage(hEditWnd, wParam, (LPARAM)strBuff);
>     }
>             break;
>     case WM_CLOSE:
>         if ( ! UnregisterDeviceNotification(hDeviceNotify) )
>         {
>            ErrorHandler(TEXT("UnregisterDeviceNotification")); 
>         }
>         DestroyWindow(hWnd);
>         break;
> 
>     case WM_DESTROY:
>         PostQuitMessage(0);
>         break;
> 
>     default:
>         // Send all other messages on to the default windows handler.
>         lRet = DefWindowProc(hWnd, message, wParam, lParam);
>         break;
>     }
> 
>     return lRet;
> }
> 
> #define WND_CLASS_NAME TEXT("SampleAppWindowClass")
> 
> //
> // InitWindowClass
> //
> BOOL InitWindowClass()
> // Routine Description:
> //      Simple wrapper to initialize and register a window class.
> 
> // Parameters:
> //     None
> 
> // Return Value:
> //     TRUE on success, FALSE on failure.
> 
> // Note: 
> //     wndClass.lpfnWndProc and wndClass.lpszClassName are the
> //     important unique values used with CreateWindowEx and the
> //     Windows message pump.
> {
>     WNDCLASSEX wndClass;
> 
>     wndClass.cbSize = sizeof(WNDCLASSEX);
>     wndClass.style = CS_OWNDC | CS_HREDRAW | CS_VREDRAW;
>     wndClass.hInstance = reinterpret_cast<HINSTANCE>(GetModuleHandle(0));
>     wndClass.lpfnWndProc = reinterpret_cast<WNDPROC>(WinProcCallback);
>     wndClass.cbClsExtra = 0;
>     wndClass.cbWndExtra = 0;
>     wndClass.hIcon = LoadIcon(0,IDI_APPLICATION);
>     wndClass.hbrBackground = CreateSolidBrush(RGB(192,192,192));
>     wndClass.hCursor = LoadCursor(0, IDC_ARROW);
>     wndClass.lpszClassName = WND_CLASS_NAME;
>     wndClass.lpszMenuName = NULL;
>     wndClass.hIconSm = wndClass.hIcon;
> 
>     if ( ! RegisterClassEx(&wndClass) )
>     {
>         ErrorHandler(TEXT("RegisterClassEx"));
>         return FALSE;
>     }
>     return TRUE;
> }
> 
> //
> // main
> //
> 
> int __stdcall _tWinMain(
>                       HINSTANCE hInstanceExe, 
>                       HINSTANCE, // should not reference this parameter
>                       PTSTR lpstrCmdLine, 
>                       int nCmdShow
>                       )
> {
> //
> // To enable a console project to compile this code, set
> // Project->Properties->Linker->System->Subsystem: Windows.
> //
> 
>     int nArgC = 0;
>     PWSTR* ppArgV = CommandLineToArgvW(lpstrCmdLine, &nArgC);
>     g_pszAppName = ppArgV[0];
> 
>     if ( ! InitWindowClass() )
>     {
>         // InitWindowClass displays any errors
>         return -1;
>     }
> 
>     // Main app window
> 
>     HWND hWnd = CreateWindowEx(
>                     WS_EX_CLIENTEDGE | WS_EX_APPWINDOW,
>                     WND_CLASS_NAME,
>                     g_pszAppName,
>                     WS_OVERLAPPEDWINDOW, // style
>                     CW_USEDEFAULT, 0, 
>                     640, 480,
>                     NULL, NULL, 
>                     hInstanceExe, 
>                     NULL);
> 
>     if ( hWnd == NULL )
>     {
>         ErrorHandler(TEXT("CreateWindowEx: main appwindow hWnd"));
>         return -1;
>     }
> 
>     // Actually draw the window.
> 
>     ShowWindow(hWnd, SW_SHOWNORMAL);
>     UpdateWindow(hWnd);
> 
>     // The message pump loops until the window is destroyed.
> 
>     MessagePump(hWnd);
> 
>     return 1;
> }
> 
> //
> // OutputMessage
> //
> void OutputMessage(
>     HWND hOutWnd, 
>     WPARAM wParam, 
>     LPARAM lParam
> )
> // Routine Description:
> //     Support routine.
> //     Send text to the output window, scrolling if necessary.
> 
> // Parameters:
> //     hOutWnd - Handle to the output window.
> //     wParam  - Standard windows message code, not used.
> //     lParam  - String message to send to the window.
> 
> // Return Value:
> //     None
> 
> // Note:
> //     This routine assumes the output window is an edit control
> //     with vertical scrolling enabled.
> 
> //     This routine has no error checking.
> {
>     LRESULT   lResult;
>     LONG      bufferLen;
>     LONG      numLines;
>     LONG      firstVis;
> 
>     // Make writable and turn off redraw.
>     lResult = SendMessage(hOutWnd, EM_SETREADONLY, FALSE, 0L);
>     lResult = SendMessage(hOutWnd, WM_SETREDRAW, FALSE, 0L);
> 
>     // Obtain current text length in the window.
>     bufferLen = SendMessage (hOutWnd, WM_GETTEXTLENGTH, 0, 0L);
>     numLines = SendMessage (hOutWnd, EM_GETLINECOUNT, 0, 0L);
>     firstVis = SendMessage (hOutWnd, EM_GETFIRSTVISIBLELINE, 0, 0L);
>     lResult = SendMessage (hOutWnd, EM_SETSEL, bufferLen, bufferLen);
> 
>     // Write the new text.
>     lResult = SendMessage (hOutWnd, EM_REPLACESEL, 0, lParam);
> 
>     // See whether scrolling is necessary.
>     if (numLines > (firstVis + 1))
>     {
>         int        lineLen = 0;
>         int        lineCount = 0;
>         int        charPos;
> 
>         // Find the last nonblank line.
>         numLines--;
>         while(!lineLen)
>         {
>             charPos = SendMessage(
>                 hOutWnd, EM_LINEINDEX, (WPARAM)numLines, 0L);
>             lineLen = SendMessage(
>                 hOutWnd, EM_LINELENGTH, charPos, 0L);
>             if(!lineLen)
>                 numLines--;
>         }
>         // Prevent negative value finding min.
>         lineCount = numLines - firstVis;
>         lineCount = (lineCount >= 0) ? lineCount : 0;
> 
>         // Scroll the window.
>         lResult = SendMessage(
>             hOutWnd, EM_LINESCROLL, 0, (LPARAM)lineCount);
>     }
> 
>     // Done, make read-only and allow redraw.
>     lResult = SendMessage(hOutWnd, WM_SETREDRAW, TRUE, 0L);
>     lResult = SendMessage(hOutWnd, EM_SETREADONLY, TRUE, 0L);
> }  
> 
> //
> // ErrorHandler
> //
> void ErrorHandler(
>    LPTSTR lpszFunction
> ) 
> // Routine Description:
> //     Support routine.
> //     Retrieve the system error message for the last-error code
> //     and pop a modal alert box with usable info.
> 
> // Parameters:
> //     lpszFunction - String containing the function name where 
> //     the error occurred plus any other relevant data you'd 
> //     like to appear in the output. 
> 
> // Return Value:
> //     None
> 
> // Note:
> //     This routine is independent of the other windowing routines
> //     in this application and can be used in a regular console
> //     application without modification.
> { 
> 
>     LPVOID lpMsgBuf;
>     LPVOID lpDisplayBuf;
>     DWORD dw = GetLastError(); 
> 
>     FormatMessage(
>         FORMAT_MESSAGE_ALLOCATE_BUFFER | 
>         FORMAT_MESSAGE_FROM_SYSTEM |
>         FORMAT_MESSAGE_IGNORE_INSERTS,
>         NULL,
>         dw,
>         MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),
>         (LPTSTR) &lpMsgBuf,
>         0, NULL );
> 
>     // Display the error message and exit the process.
> 
>     lpDisplayBuf = (LPVOID)LocalAlloc(LMEM_ZEROINIT, 
>         (lstrlen((LPCTSTR)lpMsgBuf)
>                   + lstrlen((LPCTSTR)lpszFunction)+40)
>                   * sizeof(TCHAR)); 
>     StringCchPrintf((LPTSTR)lpDisplayBuf, 
>         LocalSize(lpDisplayBuf) / sizeof(TCHAR),
>         TEXT("%s failed with error %d: %s"), 
>         lpszFunction, dw, lpMsgBuf); 
>     MessageBox(NULL, (LPCTSTR)lpDisplayBuf, g_pszAppName, MB_OK); 
> 
>     LocalFree(lpMsgBuf);
>     LocalFree(lpDisplayBuf);
> } 
> ```
> 
> 以下是使用 SDK 或 Visual Studio 命令提示符处的 nmake.exe 构建前面示例代码的示例 makefile。
> 
> ```
> proj = main
> 
> all: $(proj).exe
> 
> # Update the object file if necessary
> 
> $(proj).obj: $(proj).cpp
>   cl -c  /D_UNICODE /DUNICODE -DWIN32 -D_WIN32 -DNDEBUG -GS -D_X86_=1 -D_WIN32_WINNT=0x0501 -DCRTAPI1=_cdecl -DCRTAPI2=_cdecl -D_MT -D_DLL -MD $*.cpp
> 
> # Update the executable file if necessary
> 
> $(proj).exe: $(proj).obj
>   link -release -incremental:no -nologo -subsystem:windows,5.01 $(proj).obj kernel32.lib user32.lib advapi32.lib gdi32.lib shell32.lib -out:$(proj).exe 
> ```

# java - 为什么我收到此错误文件过早结束？

> ID：10022796
> 
> 赞同：30
> 
> 时间：2012-04-05T04:43:54.127
> 
> 标签：java, xml, httpurlconnection

我正在尝试解析一个`XML response`，但我失败了。我最初以为`xml`只是没有在响应中返回，所以我制作了下面的代码，并直接链接到我的`xml`在线文件。我可以毫无问题地打印`XML`到屏幕。但是，当我调用我的解析方法时，我得到**了文件的提前结束。**

如果我直接传递 URL，它会起作用：

*   builder.parse("");

但是当我通过 InputStream 时失败：

*   builder.parse(connection.getInputStream());

    ```
     try {
        URL url = new URL(xml);
        URLConnection uc =  url.openConnection();
        HttpURLConnection  connection = (HttpURLConnection )uc;

        connection.setDoInput(true);
        connection.setDoOutput(true);

        InputStream instream;
        InputSource source;
        //get XML from InputStream
        if(connection.getResponseCode()>= 200){
            connection.connect();       
            instream = connection.getInputStream();         
            parseDoc(instream);     
        }
        else{
            instream = connection.getErrorStream();
        }

    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (ParserConfigurationException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (SAXException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

     static void parseDoc(InputStream instream) throws ParserConfigurationException,
     SAXException, IOException{

      BufferedReader buff_read = new BufferedReader(new InputStreamReader(instream,"UTF-8"));
        String  inputLine = null;

        while((inputLine = buff_read.readLine())!= null){
            System.out.println(inputLine);
        }

      DocumentBuilderFactory factory =DocumentBuilderFactory.newInstance();
      factory.isIgnoringElementContentWhitespace();
      DocumentBuilder builder = factory.newDocumentBuilder();
      Document doc = builder.parse(instream);
    } 
    ```

我得到的错误：

```
 [Fatal Error] :1:1: Premature end of file.
org.xml.sax.SAXParseException: Premature end of file.
    at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)
    at javax.xml.parsers.DocumentBuilder.parse(Unknown Source)
    at com.ameba.api.network.MainApp.parseDoc(MainApp.java:78)
    at com.ameba.api.network.MainApp.main(MainApp.java:41) 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-04-05T05:36:36.283

当你这样做时，

```
while((inputLine = buff_read.readLine())!= null){
        System.out.println(inputLine);
    } 
```

您在流内消耗所有内容，因此流内是空的。现在，当尝试这样做时，

```
Document doc = builder.parse(instream); 
```

解析将失败，因为您向其传递了一个空流。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-06-05T01:21:21.533

您收到错误是因为 SAXBuilder 不够智能，无法处理“空白状态”。因此，它至少会查找一个`<xml ..>`声明，当这导致无数据响应时，它会创建您看到的异常，而不是报告空状态。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-08-16T06:46:23.763

对于那些到达此帖子以获得答案的人：

**这主要是因为正在`InputStream`使用的 DOM 解析器是空的**

所以在我遇到的情况下，可能有两种情况：

1.  您传递给解析器的`InputStream`已被使用并因此被清空。
2.  `File`您创建的 from 或任何内容可能`InputStream`是空文件或字符串或其他任何内容。空虚可能是导致问题的原因。所以你需要检查你的来源`InputStream`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-01T08:57:18.423

我遇到了同样的错误，并且可以通过记录异常轻松找到问题所在：

```
documentBuilder.setErrorHandler(new ErrorHandler() {
    @Override
    public void warning(SAXParseException exception) throws SAXException {
        log.warn(exception.getMessage());
    }

    @Override
    public void fatalError(SAXParseException exception) throws SAXException {
        log.error("Fatal error ", exception);
    }

    @Override
    public void error(SAXParseException exception) throws SAXException {
        log.error("Exception ", exception);
    }
}); 
```

或者，您可以不记录错误，而是在处理条目的地方使用`throw`它`catch`，这样您就可以打印条目本身以更好地指示错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-03-30T08:05:16.597

使用一次输入流不要多次使用它并执行 inputstream.close()

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-12-18T21:44:56.060

我通过将源提要从[http://www.news18.com/rss/politics.xml](http://www.news18.com/rss/politics.xml)转换为[https://www.news18.com/rss/politics.xml解决了这个问题](https://www.news18.com/rss/politics.xml)

使用 http 下面的代码正在创建一个空文件，这导致了问题

```
 String feedUrl = "https://www.news18.com/rss/politics.xml"; 
    File feedXmlFile = null;

    try {
    feedXmlFile =new File("C://opinionpoll/newsFeed.xml");
    FileUtils.copyURLToFile(new URL(feedUrl),feedXmlFile);

          DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
          DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
          Document doc = dBuilder.parse(feedXmlFile); 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2019-08-06T03:43:59.020

另一个原因是，您应该在 mongodb 设置中将您的 IP 地址 (IPv4) 列入白名单。希望能解决！

# android - Android 应用程序 - 显示计算结果的最佳方式

> ID：10022800
> 
> 赞同：0
> 
> 时间：2012-04-05T04:44:15.940
> 
> 标签：android, textview

我正在开发适用于 Android 的计算器应用程序。我想知道显示计算值的最佳选择是什么？目前我正在`EditText`控件中显示结果。

我想知道 Android 中的标签控件之类的东西是否可用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:45:51.300

> 标签是否有等效控件？

是的。它相当于[TextView](http://developer.android.com/reference/android/widget/TextView.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:46:56.487

是的，您可以`TextView` 在 Android 中使用相当于标签功能的控件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T04:59:39.530

如果您希望该用户也从键盘编写图形，那么您应该提供一个[EditText](http://developer.android.com/reference/android/widget/EditText.html)。

如果您只有 Keyborad 用于输入，则提供一个[TextView](http://developer.android.com/reference/android/widget/TextView.html)。

# oracle - 在 Oracle 中检查约束

> ID：10022805
> 
> 赞同：0
> 
> 时间：2012-04-05T04:45:13.523
> 
> 标签：oracle, constraints

我一直在努力寻找一种插入支票的方法，这样它就不会允许付款日期早于发票日期。基本上，我有两张表：发票和付款。所以我想要一个支票约束来输入发票表中购买日期之前的日期。Invoice 表中的 invoice_id 是付款表中的 FK。有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T06:08:37.180

A check constraint can only look at columns on the table it is defined on.

You'll need to use a TRIGGER to do this.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T07:14:46.440

一种方法可能是在支付表中复制购买日期，在 invoice_id + 购买日期的组合上添加第二个唯一约束，然后修改 FK 约束以包含它。然后，您可以拥有行级约束。例如

```
CREATE TABLE invoices
( invoice_id    NUMBER NOT NULL
, purchase_date DATE NOT NULL
, CONSTRAINT invoice_pk PRIMARY KEY (invoice_id)
, CONSTRAINT invoice_uk UNIQUE (invoice_id, purchase_date)
);

CREATE TABLE payments
( payment_id    NUMBER NOT NULL
, invoice_id    NUMBER NOT NULL
, purchase_date DATE NOT NULL
, payment_date  DATE NOT NULL
, CONSTRAINT payment_pk PRIMARY KEY (payment_id)
, CONSTRAINT payment_invoice_fk
    FOREIGN KEY (invoice_id, purchase_date)
    REFERENCES invoices (invoice_id, purchase_date)
, CONSTRAINT payment_date_ck
    CHECK (payment_date >= purchase_date)
); 
```

缺点：更新 invoices.purchase_date 变得有点棘手。

# asp.net-mvc - 部署 MVC 网站时的问题

> ID：10022809
> 
> 赞同：0
> 
> 时间：2012-04-05T04:45:58.150
> 
> 标签：asp.net-mvc, deployment

我在尝试部署 mvc 网站时遇到错误：当前身份（NT AUTHORITY\NETWORK SERVICE）没有对“ `C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files`”的写访问权

我尝试了以下解决方案，但仍然遇到相同的错误：

1.  重新安装 IIS
2.  在 cmd 中运行以下命令：

`C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727>aspnet_regiis -ga "NT Authority\Network Service"`&

```
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727>aspnet_regiis.exe -i 
```

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T05:18:44.693

这可能是您的 Web 应用程序的应用程序池问题。检查您是否仍在使用 ASP.Net 经典或集成池。如果是这样，您必须在您的 ISS 服务器上安装一些 MVC 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-24T06:11:06.660

答案似乎很愚蠢，但确实如此。刚刚重新启动服务器后，它开始正常工作。

# java - Hibernate 错误地在子类而不是超类中寻找属性的设置器？

> ID：10022816
> 
> 赞同：0
> 
> 时间：2012-04-05T04:46:58.770
> 
> 标签：java, hibernate, inheritance, orm

我有两个类， class`Event`和 class`HazardSubmission`扩展 class `Event`。

类`Event`有一个属性`dateCreated`, with `getDateCreated()`, and `setDateCreated(String)`;

当我尝试：

```
HazardSubmission hs = new HazardSubmission();
hs.setDateCreated("A"); 
```

我假设它会调用 class 中的 setter `Event`，但它正在寻找 class `HazardSubmissio`n 中的 setter！

这是错误，非常感谢一些帮助！:)

```
SEVERE: Servlet.service() for servlet DispatcherServlet threw exception
org.hibernate.PropertyNotFoundException: Could not find a setter for property dateCreated in class nz.co.company.healthsafety.stripes.model.HazardSubmission
    at org.hibernate.property.BasicPropertyAccessor.createSetter(BasicPropertyAccessor.java:240)
    at org.hibernate.property.BasicPropertyAccessor.getSetter(BasicPropertyAccessor.java:233)
    at org.hibernate.mapping.Property.getSetter(Property.java:299)
    at org.hibernate.tuple.entity.PojoEntityTuplizer.buildPropertySetter(PojoEntityTuplizer.java:307)
    at org.hibernate.tuple.entity.AbstractEntityTuplizer.<init>(AbstractEntityTuplizer.java:142)
    at org.hibernate.tuple.entity.PojoEntityTuplizer.<init>(PojoEntityTuplizer.java:78)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at org.hibernate.tuple.entity.EntityTuplizerFactory.constructTuplizer(EntityTuplizerFactory.java:107)
    at org.hibernate.tuple.entity.EntityTuplizerFactory.constructDefaultTuplizer(EntityTuplizerFactory.java:135)
    at org.hibernate.tuple.entity.EntityEntityModeToTuplizerMapping.<init>(EntityEntityModeToTuplizerMapping.java:80)
    at org.hibernate.tuple.entity.EntityMetamodel.<init>(EntityMetamodel.java:323)
    at org.hibernate.persister.entity.AbstractEntityPersister.<init>(AbstractEntityPersister.java:456)
    at org.hibernate.persister.entity.JoinedSubclassEntityPersister.<init>(JoinedSubclassEntityPersister.java:113)
    at org.hibernate.persister.PersisterFactory.createClassPersister(PersisterFactory.java:87)
    at org.hibernate.impl.SessionFactoryImpl.<init>(SessionFactoryImpl.java:267)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1341)
    at nz.co.company.healthsafety.stripes.action.BaseController.<clinit>(BaseController.java:36)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at java.lang.Class.newInstance0(Class.java:355)
    at java.lang.Class.newInstance(Class.java:308)
    at net.sourceforge.stripes.controller.AnnotatedClassActionResolver.makeNewActionBean(AnnotatedClassActionResolver.java:432)
    at net.sourceforge.stripes.controller.AnnotatedClassActionResolver.getActionBean(AnnotatedClassActionResolver.java:360)
    at net.sourceforge.stripes.controller.NameBasedActionResolver.getActionBean(NameBasedActionResolver.java:264)
    at net.sourceforge.stripes.controller.AnnotatedClassActionResolver.getActionBean(AnnotatedClassActionResolver.java:293)
    at net.sourceforge.stripes.controller.DispatcherHelper$1.intercept(DispatcherHelper.java:106)
    at net.sourceforge.stripes.controller.ExecutionContext.proceed(ExecutionContext.java:158)
    at net.sourceforge.stripes.controller.BeforeAfterMethodInterceptor.intercept(BeforeAfterMethodInterceptor.java:113)
    at net.sourceforge.stripes.controller.ExecutionContext.proceed(ExecutionContext.java:155)
    at net.sourceforge.stripes.controller.ExecutionContext.wrap(ExecutionContext.java:74)
    at net.sourceforge.stripes.controller.DispatcherHelper.resolveActionBean(DispatcherHelper.java:102)
    at net.sourceforge.stripes.controller.DispatcherServlet.resolveActionBean(DispatcherServlet.java:238)
    at net.sourceforge.stripes.controller.DispatcherServlet.service(DispatcherServlet.java:141)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at net.sourceforge.stripes.controller.StripesFilter.doFilter(StripesFilter.java:247)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:230)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:104)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:261)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:581)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)
    at java.lang.Thread.run(Thread.java:619)
5/04/2012 4:34:42 PM net.sourceforge.stripes.util.Log warn 
```

我的映射 xml 的简化：

```
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <class name="nz.co.company.healthsafety.stripes.model.Event" table="events">
        <id name="id"  type="java.lang.Integer" column="id">
            <generator class="native" />
        </id>
        <property name="dateCreated" column="dateCreated" type="timestamp" not-null="true" length="200" />

        <joined-subclass name="nz.co.company.healthsafety.stripes.model.HazardSubmission" table="hazard_submissions">
            <key column="id" />
            <property name="reporterFirstName" column="reporterFirstName" type="java.lang.String" not-null="true" length="200" />
            <property name="reporterLastName" column="reporterLastName" type="java.lang.String" not-null="true" length="200" />

        </joined-subclass>

    </class>
</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T06:10:12.983

根据您的 XML，创建的日期应该是时间戳，但您似乎已将该属性声明为字符串。

您可以更改其中一种类型以使它们匹配吗？

# iphone - 如何解析json字符串并将对象存储在iphone的数组中

> ID：10022817
> 
> 赞同：0
> 
> 时间：2012-04-05T04:47:26.947
> 
> 标签：iphone, objective-c, json

我正在从服务器获取数据，它作为响应提供了一个 NSString，其中包含 json 数据我希望将 json 数据存储在一个数组中如何做到这一点

```
 NSData *urlData=[NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];

       NSString *data=[[NSString alloc]initWithData:urlData encoding:NSUTF8StringEncoding];

       NSLog(data);

   NSData* data=[dataString dataUsingEncoding:NSUTF8StringEncoding];

    [self performSelectorOnMainThread:@selector(fetchedData:) 
                           withObject:data waitUntilDone:YES];

     - (void)fetchedData:(NSData *)responseData {
      //parse out the json data
       NSError* error;
       NSDictionary* json = [NSJSONSerialization 
                      JSONObjectWithData:responseData //1

                      options:kNilOptions 
                      error:&error];

     NSArray* latestLoans = [json objectForKey:@"loans"]; //2

       NSLog(@"loans: %@", latestLoans); //3
   } 
```

这是从服务器返回的数据日志

```
 [{"CodeValue":"90658","CodeDescription":"flu shot","IsActive":"1","CodeType":"CPT","CodeID":"6","UpdateDateTime":"2012-04-02 02:09:46"}] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:07:18.413

```
NSData *urlData=[NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];

NSString *data=[[NSString alloc]initWithData:urlData encoding:NSUTF8StringEncoding];

NSArray *dataArr=[data JSONValue];

for (int i=0; i<[dataArr count]; i++) {

    NSDictionary *dict=[dataArr objectAtIndex:i];

    NSString *codeV=[dict valueForKey:@"CodeValue"];
    NSString *codeD=[dict valueForKey:@"CodeDescription"];
    NSString *active=[dict valueForKey:@"IsActive"];
    NSString *codeT=[dict valueForKey:@"CodeType"];
    NSString *codeId=[dict valueForKey:@"CodeID"];
    NSString *updatedTime=[dict valueForKey:@"UpdateDateTime"];

    NSLog([dict description],nil);
}

    NSLog(@"%@", json_string);

//May this will help you out. 
```

务必将 JSON 库类包含到您的项目中。

我正在以这种方式插入数组，但它返回 o 对象

```
 NSDictionary *dict=[dataArr objectAtIndex:i];

        SearchCode *theObject =[[SearchCode alloc] init];

        theObject.codeValue=[dict valueForKey:@"CodeValue"];
        theObject.codeDescription=[dict valueForKey:@"CodeDescription"];
        theObject.codeType=[dict valueForKey:@"CodeType"];
        theObject.codeID=[dict valueForKey:@"CodeID"];
        theObject.UpdateDateTime=[dict valueForKey:@"UpdateDateTime"];

        NSLog(codeType);

        [cptArray addObject:theObject];
        [theObject release];
        theObject=nil;

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
     return [cptArray count];    
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
static NSString *CellIdentifier = @"Cell"; 
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

    cell.selectionStyle=UITableViewCellSelectionStyleGray;
    cell.accessoryType = UITableViewCellAccessoryNone;

     }
SearchCode *theObject =[cptArray objectAtIndex:indexPath.row];
cell.textLabel.text=theObject.codeValue; //& so on you can access any value from "theObject" here

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T14:42:08.000

如果您想要更完整的解决方案，请查看：[https ://github.com/stig/json-framework](https://github.com/stig/json-framework)

它是一个很棒的框架，要解析 JSON，您只需键入

```
[string_here JSONValue]; 
```

# sql - 在 SSIS 中将数据从 Access 迁移到 SQL Server 的最佳方法

> ID：10022818
> 
> 赞同：0
> 
> 时间：2012-04-05T04:47:32.690
> 
> 标签：sql, sql-server, ssis

请让我知道这两个 SSIS 活动是否有任何最佳方法。

1.  将访问数据迁移到 SQL Server 表

    使用多个 Access 数据库作为源将数据迁移到 SQL 表中。

2.  SQL 服务器表到 SQL 服务器表

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T17:53:39.870

使用 SQL server 导入导出向导，最后不要点击立即运行，保存包，你可以安排这些包为你做同样的事情，

是的，您可以从访问权限复制到 SQL 表，以及从 SQL 表复制到 SQL 表。

[http://msdn.microsoft.com/en-us/library/ms140052%28v=sql.105%29.aspx](http://msdn.microsoft.com/en-us/library/ms140052%28v=sql.105%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T05:08:36.657

这是一项应该定期完成的一次性工作吗？

如果是一次性工作，那么您可以使用 SQL Server 导入数据实用程序轻松完成这两件事。

如果只是从源到目标的数据副本，没有对数据进行任何修改，那么就没有必要使用 SSIS。

# javascript - 如何将信息发送到新实例化的 Backbone 集合？

> ID：10022827
> 
> 赞同：1
> 
> 时间：2012-04-05T04:48:27.220
> 
> 标签：javascript, backbone.js

我有一个 API，它根据 URL 中存在的 ID 过滤一组对象，如下所示：

```
http://localhost:8000/api/v1/goal_update/?goal__id=12&format=json 
```

我有一个对上述 URL 执行 GET 请求的集合。这是集合的代码：

```
 var GoalUpdateList = Backbone.Collection.extend({

    // Reference the Goal Update model
    model: GoalUpdate,

    // Do HTTP requests on this endpoint
    url: function() {
      return "http://localhost:8000/api/v1/goal_update/?goal__id=" + this.goal_id + "&format=json";
    },

    // Set the goal ID that the goal update list corresponds to
    initialize: function(goal_id) {
      this.goal_id = goal_id;
    },

  }); 
```

我想在创建集合的新实例时传入 ID，所以我创建了一个包含以下代码的视图：

```
this.collection = new GoalUpdateList(this.model.get("id")); 
```

不过，它认为我正在传递模型参数。我正在尝试传递告诉集合使用哪个 URL 的信息。因此，它通过验证函数运行 ID，并弄乱了其余的主干代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T05:05:23.367

正如您已经注意到的，Backbone 的集合期望模型数据作为第一个参数。但是您可以将第二个参数指定为对象字面量，就像其他 Backbone 对象一样。只需将`null`or`undefined`作为第一个参数传递，然后在您的集合`initialize`方法中，将 the`options`作为第二个参数。

```
 GoalUpdateList = Backbone.Collection.extend({

  initialize: function(data, options){
    this.goal_id = options.goal_id;
  }

});

new GoalUpdateList(null, model.get("goal_id")); 
```

# android - TAG_DISCOVERED、NDEF_DISCOVERED 和 TECH_DISCOVERED 与在 android 中发现 NFC 设备或标签有什么区别？

> ID：10022828
> 
> 赞同：8
> 
> 时间：2012-04-05T04:48:31.120
> 
> 标签：android, android-manifest, nfc, intentfilter

在 android 中发现 NFC 设备或标签时和时`TAG_DISCOVERED`有`NDEF_DISCOVERED`什么区别？`TECH_DISCOVERED`

# linux - 将同时的客户端桥接到单个连接的代理

> ID：10022832
> 
> 赞同：1
> 
> 时间：2012-04-05T04:49:04.137
> 
> 标签：linux, sockets, networking, proxy, vpn

我正在寻找一种工具（在 linux 下），它允许我设置一个端到端代理，该代理在一个端口上接受多个同时客户端，通过*单个*连接将数据转发到另一端，然后“扩展”另一端的连接以连接回接受多个连接的服务。为了澄清，这是我想要实现的图表：

[http://i.stack.imgur.com/rgTMd.png](http://i.stack.imgur.com/rgTMd.png)

（显然我需要超过 10 个代表才能将图像嵌入此页面）

如果您有兴趣，我尝试这样做的原因是因为我想构建一个系统，该系统可以更轻松地通过任意协议进行隧道传输，只要协议支持某种方式从一端发送一些消息到其他。在上图中，我会将系统置于代理端 A 和代理端 B 之间。

这是我希望它如何工作的示例：

首先，我将运行以下命令

`mkfifo backpipe`

`nc -l 7778 0<backpipe | tee f1 | nc localhost 7777 | tee f2 >backpipe`

“服务器代理”将在端口 7777 上运行。

应用程序将连接到的“客户端代理”将在端口 8080 上运行

客户端代理将连接到端口 7778

解决“服务器代理”和“客户端代理”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T14:29:07.383

`-D`OpenSSH 已经通过以下选项支持此功能：

```
ssh -D <port> -l username remotehost 
```

SOCKS 服务器将侦听连接并将它们转发到 SSH 连接的另一端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T12:19:32.303

同时，我决定编写自己的解决方案。这是一段接受多个客户端的python代码，基本上通过标准输入/输出代理通信。如果有人有兴趣，这里的代码[http://pastebin.com/1E45Exsy](http://pastebin.com/1E45Exsy)

不要相信此代码可以完美运行。我没有正确测试它，它不处理断开客户端。

我将继续寻找更优雅、更强大的解决方案，但同时应该这样做。如果我制作它们，我将在此处发布代码更新。

# excel - 如何仅使用函数在 excel 中编写类似查询的数据库？

> ID：10022836
> 
> 赞同：1
> 
> 时间：2012-04-05T04:49:22.190
> 
> 标签：excel, excel-formula, vba

我有一些数据在这样的表中结构化：

![现有表](../Images/3c0f4f57668c5e760fa35b5a94a4c80a.png).

我的电子表格上有另一个选项卡，我在其中消除了任何重复的类别条目，并希望将数据连接起来，如下所示：

![新表](../Images/8dde469eab2528de7c6b0f1467d8dc25.png)

我需要**使用函数**而**不是宏或 Visual Basic**创建它。我已经编写了函数来消除任何重复的类别条目，现在我需要弄清楚如何获取每个独特的类别并在其后面附加数据。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T07:26:05.563

假设第一个图像来自`Sheet1`和第二个`Sheet2`，这是一种方法。您需要向 中添加至少一个计算列`Sheet1`和可选的两个计算行`Sheet2`。

1.  唯一标识 上的每一行`Sheet1`。添加一个`A`包含公式`=B3&COUNTIF($B$3:B3,B3)`的新列`A3`并填写。你会有`first1`in `A3`，`first2`in`A4`等等。
2.  识别 上的每个列块`Sheet2`。添加一个`6`包含公式`=COUNTIF($B$2:B2,B2)`的新行`B6`并填写。值将是`1,1,1,2,2,2,3,3,3`。如果您愿意，您可以手动输入这些，但它不会那么容易扩展。
3.  计算出每个数据项的列，`Sheet1`并放入列中`Sheet2`。使用公式添加一个新行`7`并填写。值将是。我们现在知道，对于 中的每个单元格，我们拥有类别的哪个实例以及数据变量来自哪一列。`Sheet2``=MATCH(B2,Sheet1!$A$2:$E$2,0)``3,4,5,3,4,5,3,4,5``Sheet2`
4.  用于`VLOOKUP`查找`first1`和返回数据`3`表中的数据列。在 上`Sheet2`，将单元格设置`B3`为`=VLOOKUP($A3&B$6,Sheet1!$A$2:$E$8,B$7,FALSE)`并向下填充。
5.  您将遇到许多`#N/A`错误（例如 cell `E4`）。如果您有更新版本的 Excel，您可以使用它`IFERROR()`来转义；否则，使用第 4 步`=IF(ISNULL(<formula>), "", <formula>)`中`<formula>`的公式。

总结一下：

*   为源中的每一行创建一个唯一的、连续的、可计算的行 ID。
*   确定目标中的每一列使用该序列的哪个实例。这将附加到类别的末尾以确定在上一步中形成的行 ID。
*   确定哪一列包含目标中每一列的数据。
*   查找具有计算的行 ID 的行并找到该数据项的相关列。
*   适当地格式化结果。

# python - 如何选择 PyMongo 只有唯一的记录？

> ID：10022839
> 
> 赞同：4
> 
> 时间：2012-04-05T04:49:39.770
> 
> 标签：python, mongodb, pymongo, nosql

如何选择 PyMongo 只有唯一的记录？

```
>>> db.houses.find({"street":{"$regex": "Fl", "$options":"i"}}).count()
107
>>> for item in db.houses.find({"street":{"$regex": "Fl", "$options":"i"}}):
...  print item["street"]
...
Flatbush Avenue
Flatbush Avenue
Flatbush Avenue
Flatlands Avenue
Flatlands Avenue
Flatlands Avenue
Flatlands Avenue
Flatlands Avenue
Flushing Avenue
Flushing Avenue
...more 
```

如何在响应查询时获得唯一的“街道”记录？也就是说，为了避免重复记录：

```
Flatbush Avenue
Flatlands Avenue
Flushing Avenue 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T04:57:57.247

根据文档 - [Cursor.distinct](http://api.mongodb.org/python/current/api/pymongo/cursor.html#pymongo.cursor.Cursor.distinct)应该可以解决问题：

```
db.houses.find({"street":{"$regex": "май", "$options":"i"}}).distinct("street") 
```

# jakarta-ee - 无法在 Windows 7 64 位中删除 Glassfish

> ID：10022853
> 
> 赞同：1
> 
> 时间：2012-04-05T04:51:27.203
> 
> 标签：jakarta-ee, glassfish, uninstallation

我尝试在 Windows 7 64bit 中卸载 Glassfish，但由于以下错误而无法卸载：

> 在 'c:\glassfish3\jdk7' 中找不到所需的 java(tm) 2 运行时环境版本，并且此应用程序需要 1.6 或更高版本的 java(tm) 2 运行时环境。如果没有安装所需的 java(tm) 2 运行环境，您可以从以下网站下载：http: [//java.sun.com/j2se](http://java.sun.com/j2se)或者如果您已经安装了所需的 java(tm) 2 运行环境，尝试使用以下用法重新运行该应用程序：'uninstall.exe' -j

我已经针对这个问题采取了一种解决方案，但它没有用。谁能帮我卸载 Glassfish？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T13:42:53.760

```
uninstall.exe -j "C:\Program Files\Java\jdk1.7.0_7\jre" 
```

应该卸载 Glassfish！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T04:57:13.067

好的，在这里，您可以使用以下命令将其卸载：

```
uninstall.exe -j "%JAVA_HOME%" 
```

其中 %JAVA_HOME% 可以是你设置的环境变量，也可以是安装 java 的绝对路径，例如：

```
uninstall.exe -j "C:\Program Files\Java\jdk1.6.0_25\bin" 
```

看看这是否有效。

有关 Glassfish 的更多信息，请[访问](http://docs.oracle.com/cd/E18930_01/html/821-2427/gjxfv.html)oracle/sun 网站

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-03T13:50:16.013

对我来说，这很有效：

```
uninstall -j "C:\Program Files\Java\jdk1.7.0" 
```

不要选择 Bin-folder，这没有帮助，例如`%JAVA_HOME%`（也尝试过）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-15T16:10:55.903

这些对我在 Windows 7 中运行 java 1.6.0_24 不起作用：

*   我尝试修改 glassfish 用来查找 jre 以指向我的 jre 的 asenv.bat 文件。

*   我尝试手动将其放入 C:\glassfish3\uninstall.exe -j 中。这是根据官方 Oracle 文档。

唯一有效的是使用原始路径并将 bin 和 lib 文件夹从我的 java 安装移动到错误对话框指定的目录。然后 Glassfish 卸载启动并顺利完成。

# c# - 在 WatiN 中创建一个 Chrome 实例

> ID：10022861
> 
> 赞同：1
> 
> 时间：2012-04-05T04:52:25.777
> 
> 标签：c#, google-chrome, watin

我一直在使用 WatiN 和 IE 并取得了巨大的成功，但是现在我想转向 Chrome。在我看来，如果我可以创建一个 Chrome 浏览器的实例，它应该是一个类似的过程，但是创建一个 Chrome 的实例被证明是一项棘手的任务。我目前正在查看：WatiN.Core.Native.Chrome.ChromeBrowser 我在正确的轨道上吗？还是我缺少 WatiN.Core.Chrome 的程序集？

编辑：我现在已经研究了 Selenium，并在 Chrome、Firefox 和 IE 上使用它并取得了一些成功。对于那些需要多浏览器支持的人，我会建议 Selenium 而不是 WatiN，至少在他们完成 Firefox 和 Chrome 实现之前。不过，两者对于一般的 UI 测试都非常方便！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T05:27:25.063

官[网](http://watin.org/)声明只支持IE 6-9和FF 2-3的浏览器。Chrome 浏览器仅处于实验模式，尚不支持。有几个这样的[帖子](https://stackoverflow.com/questions/2320516/automating-firefox-and-chrome-browsers)指出在 Watin 中使用 chrome 没有成功。

# actionscript-3 - 确定是否从网络服务器调用

> ID：10022862
> 
> 赞同：0
> 
> 时间：2012-04-05T04:52:26.803
> 
> 标签：actionscript-3, apache-flex

我可以从 Flex/AS3 中调用什么来告诉我 flex-app/web 页面是在本地文件系统中执行还是从 Web 服务器（本地主机或某个远程服务器）提供服务。希望这很清楚。如果 Javascript 中有一些可以接受的东西，但一些 AS3 功能当然会更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:56:39.657

您可以使用`ExternalInterface`获取应用程序的当前 URL，并评估方案的字符串：

文件：///
http://
https://

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009"
               xmlns:s="library://ns.adobe.com/flex/spark"
               xmlns:mx="library://ns.adobe.com/flex/mx"
               creationComplete="creationCompleteHandler(event)">

    <fx:Script>
        <![CDATA[
            import mx.events.FlexEvent;

            protected function creationCompleteHandler(event:FlexEvent):void
            {
                trace(String(ExternalInterface.call(" function(){ return document.location.href.toString();}")));
            }
        ]]>
    </fx:Script>

</s:Application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T05:12:53.670

Application 类有一个属性：url

url:String [只读]

语言版本：ActionScript 3.0
产品版本：Flex 4
运行时版本：Flash Player 10、AIR 1.5

从中加载此应用程序的 SWF 文件的 URL。

实现
公共函数get url():String

# android - Android 谷歌地图 api 与 JavaScript 谷歌地图 api

> ID：10022864
> 
> 赞同：0
> 
> 时间：2012-04-05T04:52:54.850
> 
> 标签：android, google-maps, google-maps-api-3

使用实际的 Android Google maps api 与在 WebView 中使用 JavaScript Google maps api 相比，在 Android 应用程序中包含 Google 地图的优点/缺点是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T19:45:34.077

Activty 中的 MapView：考虑到您可以访问的所有类（`ItemizedOverlay,Overlay,OverlayItem`），我认为这是最好的选择。它提供了一个很好的框架来与`MapActivity`. 如果您使用的是全屏地图或大地图，或者正在使用超过 10 个左右的航点进行操作，我会使用地图视图。

Javascript MapView - 我会将其用于较小尺寸的地图（四分之一屏幕）或具有一两个航点的任何东西。请记住，这是对 MapView 的轻量级包装，因此对多个叠加层的繁重处理可能需要更长时间，因为您必须重新执行 JS 代码并刷新 WebView。

总的来说，恕我直言，我会在 a 中使用 MapView，`MapActivity`因为它提供了更强大的界面，以及对一些更好的类的访问。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T06:05:41.397

[这里](https://stackoverflow.com/questions/14445923/google-maps-android-api-v2-vs-google-maps-javascript-api-v3)有一个真正的线程 ，这个线程的目的是找到哪一个最符合我对下一个应用程序的需求。我已经开始分析javascript v3和android v2的一些基本特性。

# bash - 在 Makefile prerequesite 中重用百分号作为子目录名称

> ID：10022872
> 
> 赞同：5
> 
> 时间：2012-04-05T04:54:31.400
> 
> 标签：bash, unix, makefile

我想学习如何在我的 makefile 目标的先决条件中重新使用 % 符号，假设目标是`X.pdf`，并且 prerequesite 在`X/X.tex`.

详细地说，我目前有一个像这样的makefile：

```
all: foo.pdf

%.pdf: %.tex
    pdflatex $*.tex 
```

我还有一个文件`foo.tex`，当我输入`make`它时，它会`foo.pdf`运行`pdflatex foo.tex`。

现在由于各种我无法控制的原因，我的目录结构发生了变化：

```
my_dir
|- Makefile
|- foo
   |- foo.tex 
```

我想修改我的 Makefile 以便当它尝试 make 时`X.pdf`，它​​会查找文件`X/X.tex`。

我尝试了以下方法（我试图把 '%/%.tex' 告诉它寻找`foo/foo.tex`）：

```
all: foo.pdf

%.pdf: %/%.tex
    pdflatex $*/$*.tex 
```

但是，这会产生：

```
No rule to make target `foo.pdf', needed by `all'. Stop. 
```

也是如此`%.pdf: $*/$*.tex`。

如果我将其更改`%/%.tex`为`foo/%.tex`按预期工作，但我不想`foo`在那里硬编码，因为将来我会这样做`all: foo.pdf bar.pdf`，它应该寻找`foo/foo.tex`and `bar/bar.tex`。

我对 Makefiles 相当陌生（经验仅限于根据我的需要修改别人的文件），并且从未做过绝对基本的，所以如果有人能给我一个有用的指针（我真的不知道在 Makefile 文档中搜索什么词 - 唯一看起来很有希望的是`%`and `$*`，我无法开始工作）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T08:09:57.577

您可以使用 VPATH 指定 make 应该搜索的目录列表。

示例生成文件：

```
# Find all tex files
tex := $(shell find -iname '*.tex')

# Make targets out of them
PDFS := $(notdir $(tex:%.tex=%.pdf))
# specify search folder
VPATH := $(dir $(tex))

all : $(PDFS)

%.pdf : %.tex
        pdflatex $< 
```

甚至更好的是使用 vpath （小写）：

```
vpath %.tex $(dir $(tex)) 
```

它只会在这些目录中查找 .tex 文件。

# google-maps-api-3 - 通过单击地图关闭谷歌地图中的信息窗口？

> ID：10022873
> 
> 赞同：39
> 
> 时间：2012-04-05T04:54:37.630
> 
> 标签：google-maps-api-3

我正在制作一个移动网络应用程序。

应用程序的一部分会掉落几个标记，单击这些标记可以打开信息窗口。让我恼火的是，如果您继续使用地图而不承认它们，这些不会消失，就像在 iOS 地图应用程序中一样。

有没有办法设置它，如果用户点击底层地图，所有打开的信息窗口都会关闭？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2015-03-13T09:26:24.210

尝试这个：

```
google.maps.event.addListener(map, "click", function(event) {
    infowindow.close();
}); 
```

这很简单，应该也可以。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-04-05T06:38:41.373

将监听器添加到地图的单击事件并在其处理程序中关闭信息框

```
google.maps.event.addListener(map, "click", function(event) {
    for (var i = 0; i < ibArray.length; i++ ) {  //I assume you have your infoboxes in some array
         ibArray[i].close();
    }
}); 
```

我在典型的网站上这样做，但看不出它在移动设备上不起作用的任何原因

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-08-21T15:15:00.730

```
google.maps.event.addListener(marker, 'click', function() {
    if(!marker.open){
        infoWindow.open(map,marker);
        marker.open = true;
    }
    else{
        infoWindow.close();
        marker.open = false;
    }
    google.maps.event.addListener(map, 'click', function() {
        infoWindow.close();
        marker.open = false;
    });
}); 
```

完美运行

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-20T03:29:05.657

我注意到其他答案存在一些问题。

**马库斯·隆美尔和斯拉维克温的回答：**

单击标记时，会触发地图单击事件。所以当标记点击打开窗口时，点击事件传播到地图会立即再次关闭窗口。

**user1724001的回答：**

每次单击标记时创建侦听器也不是一个好主意。这会污染内存。

因此，我只想在第一个答案中添加一些附加信息，以阻止事件传播到地图。只有在没有点击任何标记的情况下，Windows 才会关闭。

```
marker.addListener("click", function(event) {
    // open your window here
    event.stopPropagation(); // this prevents propagation of marker click to map click
});

map.addListener("click", function() {
    // close your window
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-10T17:19:07.543

我对所有 senario 都有更好的解决方案。

试试这个：[JSFiddle](https://jsfiddle.net/L1bej93w/23/)

```
const infoWindow = new google.maps.InfoWindow();

function init() {
    const map = new google.maps.Map(document.getElementById('map'), {
        zoom: 6,
        center: new google.maps.LatLng(39.9646, 30.8259),
        mapTypeId: google.maps.MapTypeId.TERRAIN
    });

    map.addListener('click', () => {
        if (infoWindow) {
            infoWindow.close();
        }
    });

    const istanbulMark = new google.maps.Marker({
        position: new google.maps.LatLng(41.0876, 28.9288),
        map: map,
        label: 'I'
    });

    istanbulMark.addListener('click', () => {
        infoWindow.setContent(`
            <h1>Hi mate</h1>
            <hr>
            <p>Welcome to İstanbul!</p>
          `)
        infoWindow.open(map, istanbulMark);
    });

    const ankaraMark = new google.maps.Marker({
        position: new google.maps.LatLng(39.9162, 32.8437),
        map: map,
        label: 'A'
    });

    ankaraMark.addListener('click', () => {
        infoWindow.setContent(`
            <h1>Hi mate</h1>
            <hr>
            <p>Welcome to Ankara!</p>
          `)
        infoWindow.open(map, ankaraMark);
    });
}

google.maps.event.addDomListener(window, 'load', init);
```

```
 html, body, #map {
      height: 100%;
      margin: 0px;
      padding: 0px
  }
```

```
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true">
  </script>
</head>
<body>
  <div id="map"></div>
</body>
</html>
```

# pdf - 在不同方向的页面上呈现 abcpdf 中的页脚

> ID：10022875
> 
> 赞同：3
> 
> 时间：2012-04-05T04:55:08.127
> 
> 标签：pdf, abcpdf

我正在按照示例将带有页码的页脚添加到 abcpdf 文档站点的“页眉和页脚示例”页面。

问题是我的 pdf 文档有多个页面，它们具有不同的方向和不同的页面大小。

大多数页面是纵向和 A4 或横向和 A3，但 A3 可能是纵向的。

有没有一种方法可以轻松地将每个页面的页脚放在文档的正确部分，特别是考虑到一旦添加了文档，我似乎无法轻松判断方向/页面大小是什么用过的。

目前，我正在为每个部分构建单独的文档并设置方向，然后将它们附加到主文档。

我需要将页码以“Y 页 X”的格式输入，如果我为每个子文档执行此操作，我能够使页码正常工作，但我需要它用于整个文档

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:03:02.080

当您阅读文档/PDF 时，您可以访问诸如 pdf 宽度和 pdf 高度等属性。在页眉上添加对象的位置是 x: 0, y:0 页脚只是文档的高度 - 页脚对象的高度，X 再次为 0。

在这里看到这个：[http ://www.websupergoo.com/helppdf8net/source/2-getting_started/3-coordinates.htm](http://www.websupergoo.com/helppdf8net/source/2-getting_started/3-coordinates.htm)

这是如何放置矩形的一个很好的例子，在你的矩形内是你的文本，即第 2 页，共 16 页

[http://www.websupergoo.com/helppdf8net/default.htm?page=source%2F2-getting_started%2F3-coordinates.htm](http://www.websupergoo.com/helppdf8net/default.htm?page=source%2F2-getting_started%2F3-coordinates.htm)

cropbox 是获取文档实际大小的方法，因此知道为包含文本的矩形输入什么坐标。

但是，如果您考虑百分比而不是固定数字，您会发现更容易，无论文档大小，从底部开始的 10% 始终是 10%！

# javascript - 如何使用 jQuery 覆盖来获取弹出窗口的单选按钮？

> ID：10022878
> 
> 赞同：4
> 
> 时间：2012-04-05T04:55:54.407
> 
> 标签：javascript, php, jquery, html, modal-dialog

我正在关注本教程并设计和提醒窗口（包括在线演示），
[http://jquerytools.org/demos/overlay/modal-dialog.html](http://jquerytools.org/demos/overlay/modal-dialog.html)

我可以修改源代码并**在警报消息中添加单选按钮。**源代码如下所示（您不必浏览整个代码。只需查看我添加单选按钮的位置和访问值的位置的单选按钮），

```
<!DOCTYPE html>
<html>
<!--
   This is a jQuery Tools standalone demo. Feel free to copy/paste.
   http://flowplayer.org/tools/demos/

   Do *not* reference CSS files and images from flowplayer.org when in
   production Enjoy!
-->
<head>
  <title>jQuery Tools standalone demo</title>

    <!-- include the Tools -->
  <script src="jquery.tools.min.js"></script>

  <!-- standalone page styling (can be removed) -->
  <link rel="shortcut icon" href="/media/img/favicon.ico">
  <link rel="stylesheet" type="text/css"
        href="/media/css/standalone.css"/>

  <style>
    .modal {
    background-color:#fff;
    display:none;
    width:350px;
    height:250px;
    padding:15px;
    text-align:left;
    border:2px solid #333;

    opacity:0.8;
    -moz-border-radius:6px;
    -webkit-border-radius:6px;
    -moz-box-shadow: 0 0 50px #ccc;
    -webkit-box-shadow: 0 0 50px #ccc;
  }

  .modal h2 {
    background:url(/media/img/global/info.png) 0 50% no-repeat;
    margin:0px;
    padding:10px 0 10px 45px;
    border-bottom:1px solid #333;
    font-size:20px;
  }
  </style>
</head>
<body><!-- the triggers -->
<p>
  <button class="modalInput" rel="#yesno">Yes or no?</button>
  <button class="modalInput" rel="#prompt">User input</button>
</p>

<!-- yes/no dialog -->
<div class="modal" id="yesno">
  <h2>This is a modal dialog</h2>

  <p>
    You can only interact with elements that are inside this dialog.
    To close it click a button or use the ESC key.
  </p>

  <!-- yes/no buttons -->
  <p>
    <button class="close"> Yes </button>
    <button class="close"> No </button>
  </p>
</div>

<!-- user input dialog -->
<div class="modal" id="prompt">
  <h2>This is a modal dialog</h2>

  <p>
    You can only interact.
  </p>

  <!-- input form. you can press enter too -->
  <form>
    //Added radio buttons
    <input type="radio" name="sex" value="male" id="male"> Male<br />
    <input type="radio" name="sex" value="female" id="female"> Female<br />

    <button type="submit">Submit</button>

  </form>
  <br />

</div>

<script>
$(document).ready(function() {
    var triggers = $(".modalInput").overlay({

      // some mask tweaks suitable for modal dialogs
      mask: {
        color: '#ebecff',
        loadSpeed: 200,
        opacity: 0.9
      },

      closeOnClick: false
  });

    var buttons = $("#yesno button").click(function(e) {

      // get user input
      var yes = buttons.index(this) === 0;

      // do something with the answer
      triggers.eq(0).html("You clicked " + (yes ? "yes" : "no"));
  });

    $("#prompt form").submit(function(e) {

      // close the overlay
      triggers.eq(1).overlay().close();

      // get user input
      var input = $("input", this).val(); // this input value always return 'male' as the output  

      // do something with the answer
      triggers.eq(1).html(input);

      // do not submit the form
      return e.preventDefault();
  });
  });
</script>
</body>
</html> 
```

**此演示有两个警报窗口。我说的是具有文本输入的警报消息。在我的示例中，我删除了文本输入并添加了两个单选按钮。**

**但是当我单击“提交”按钮时，它总是返回“男性”作为输出**
，有人可以帮我解决这个问题吗？我需要将拉丁按钮的输出转换为变量“输入”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T07:47:49.183

使用它来弹出框。在 HTML 中保留单选按钮。

```
<table style="width: 100%; border: 0px;" cellpadding="3" cellspacing="0">
  <tr>
     <td class="web_dialog_title">Email this Article</td>
     <td class="web_dialog_title align_right">
        <a href="#" id="btnClose">Close</a>
     </td>
  </tr>
<TR><TD> 
```

使用单选按钮。

```
</TD></TR>
 </table>
  <script type="text/javascript">

$(document).ready(function ()
{
  $("#btnShowSimple").click(function (e)
  {
     ShowDialog(false);
     e.preventDefault();
  });

  $("#btnClose").click(function (e)
  {
     HideDialog();
     e.preventDefault();

  });

$(document).keyup(function(e) {
 if (e.keyCode == 27) {
     HideDialog(); }
});

 });

function ShowDialog(modal)
{
  $("#overlay").show();
  $("#dialog").fadeIn(300);

  if (modal)
  {
     $("#overlay").unbind("click");
  }
  else
  {
     $("#overlay").click(function (e)
     {
        HideDialog();
     });
  }
}

function HideDialog()
{
  $("#overlay").hide();
  $("#dialog").fadeOut(300);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T14:42:14.297

perdickss 为这个例子提供了一个很好的答案。但是，如果您在页面中有多个输入，这将不起作用。所以你应该使用这样的东西：

```
 var input = $("input[name=FIELD_NAME]:checked", this).val(); 
```

其中 FIELD_NAME 是您要检查的输入的名称。在这种情况下，代码如下所示：

```
var input = $("input[name=sex]:checked", this).val(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T09:57:50.677

正如您在代码中所写：

```
<form>
<input type="radio" name="sex" value="male" id="male"> Male<br />
<input type="radio" name="sex" value="female" id="female"> Female<br />

<button type="submit">Submit</button>
</form> 
```

您的 中有两个输入字段`#prompt form`，因此当您使用此代码获得价值时：

```
var input = $("input", this).val(); 
```

您将始终获得第一个匹配元素的值（即`male`）。

您所要做的就是使用`:checked`选择器指定检查的输入，我建议您另外添加输入的名称：

```
var input = $("input[name=sex]:checked", this).val(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T11:39:42.253

您将文本类型输入更改为单选类型输入。所以你必须改变

```
var input = $("input", this).val(); 
```

有了这个

```
var input = $("input:checked", this).val(); 
```

# ruby-on-rails - 数据库计数列

> ID：10022879
> 
> 赞同：0
> 
> 时间：2012-04-05T04:56:36.233
> 
> 标签：ruby-on-rails, database, activerecord

我有两张桌子：

```
"sites" has_many "users" 
"users" belongs_to "sites" 
```

**每当将用户**添加到**站点**时，我在站点表中添加名为**users_count**的列并将其递增一，这样会更好吗？还是对用户表进行条件计数是最好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T05:01:04.117

“更好”是一个主观术语。

但是，我会坚持这一点。数据库中不应该有两个相同信息的来源，因为它们可能会脱节。

确定有多少用户属于一个站点的最终方法是使用`count`对他们进行计数。

第三种范式要求每个非键属性都依赖于键、整个键，并且只依赖于键（帮助我，Codd）。

如果您向站点添加用户计数，这*不仅*取决于`sites`键值，还取决于其他表中的信息。

如果您了解其中的含义并减轻数据不一致的可能性（例如使用触发器），您*可以*从第三范式恢复性能，但绝大多数情况应保持 3NF。

# cappuccino - CPOpenPanel 在卡布奇诺中不起作用

> ID：10022883
> 
> 赞同：0
> 
> 时间：2012-04-05T04:57:19.250
> 
> 标签：cappuccino

我正在尝试使用 CPOpenPanel 选择要上传的文件，当我在 CPOpenPanel 对象上调用 runModal 时，它会引发异常，如 CPInvalidArgumentException: - [CPOpenPanel runModel] 无法识别的选择器已发送到实例 0x005585

CPOpenPanel 在卡布奇诺框架中是否仍然存在错误？我错过了什么吗？我刚刚创建了一个对象并在该对象上调用 runModal。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T12:04:07.940

CPOpenPanel 仅适用于我们的 NativeHost 环境，而不是浏览器。CPSavePanel 也是如此。这些是唯一适用的课程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T06:28:41.847

该错误显示 CPopenPanel 不存在 runModel。它不是 runModel 而是 runModal，如果您想上传文件，请查看此线程[https://groups.google.com/forum/m/?fromgroups#!topic/objectivej/6ZupNuR5DIw](https://groups.google.com/forum/m/?fromgroups#!topic/objectivej/6ZupNuR5DIw)

它大约有 2 个库，用于通过简单的按钮上传文件或拖放上传。

本

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-15T07:06:39.590

这应该适用于 NativeHost (jake run-desktop)：

```
var panel = [[CPOpenPanel alloc] init]; 
[panel runModal]; 
```

# python - 在 Boto 中使更改持久化

> ID：10022884
> 
> 赞同：0
> 
> 时间：2012-04-05T04:57:25.593
> 
> 标签：python, amazon-simpledb, boto

我有一个 SimpleDB 实例，我使用 boto for Python 更新和读取它：

```
 sdb = boto.connect_sdb(access_key, secret_key)
    domain = sdb.get_domain('DomainName')
    itemName = 'UserID'
    itemAttr = {'key1': 'val1', 'key2': val2}
    userDom.put_attributes(itemName, itemAttr) 
```

这符合预期。将在域中插入一个名为“UserID”且值为 val1 和 val2 的新项目。

现在，我面临的问题是，如果我在更新其属性后立即查询该域，

```
 query = 'select * from `DomainName` where key1=val1'
    check = domain.select(query)
    itemName = check.next()['key2'] 
```

我会收到一个错误，因为找不到该行中的值。但是，如果我在写入和读取之间添加 time.sleep(1) 一切正常。

我怀疑这个问题是由于 put_attributes 向数据库发出写入信号的事实，但不会等到此更改已持久化。我也尝试过使用创建一个项目然后保存该项目（item.save（））来编写，但没有取得多大成功。有谁知道在继续下一个操作之前如何确保值已写入 SimpleDB 实例？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T13:35:14.150

这里的问题是 SimpleDB 默认情况下最终是一致的。因此，当您写入数据然后立即尝试读取它时，虽然您可以保证最终数据将保持一致，但您无法保证获得最新数据。使用 SimpleDB，最终通常意味着不到一秒，但无法保证这可能需要多长时间。

但是，有一种方法可以告诉 SimpleDB 您想要一个一致的数据视图并且愿意等待，如果有必要的话。您可以通过稍微更改查询代码来做到这一点：

```
query = 'select * from `DomainName` where key1=val1'
check = domain.select(query, consistent_read=True)
itemName = check.next()['key2'] 
```

这应该总是返回最新的值。

# android - Android，解析 JSON 时捕获错误

> ID：10022889
> 
> 赞同：-1
> 
> 时间：2012-04-05T04:57:40.530
> 
> 标签：android, json, parsing

我可以连接到服务器并获取 json 数据。它是这种格式：

```
 {"clazz":"ManiaContestantList","contestants":[

    {"clazz":"ManiaContestant","contestantId":"1","contestantName":"Adira","photoUrl":"/fileFeed.action?service=astroManiaService&action=viewFile&type=JPG&path=1/1_CONTESTANT_PHOTO.png"},
    {"clazz":"ManiaContestant","contestantId":"2","contestantName":"Akim","photoUrl":"/fileFeed.action?service=astroManiaService&action=viewFile&type=JPG&path=2/2_CONTESTANT_PHOTO.png"},
.
.
.
    ]} 
```

我的代码是这样的：

```
@Override
    protected void onStart() {
        super.onStart();
        Log.i("NewsList", "inside onStart();");

        try {
            URL url = new URL("/MY URL/");
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setConnectTimeout(Manager.ConnTimeout);
            conn.setReadTimeout(Manager.ReadTimeout);

            int responseCode = conn.getResponseCode();
            Log.i("Connection oppened", "Response code is:" + responseCode);
            if (responseCode == HttpURLConnection.HTTP_OK) {
                BufferedReader in = new BufferedReader(new InputStreamReader(conn.getInputStream()));
                if (in != null) {
                    StringBuilder strBuilder = new StringBuilder();
                    // Read character by character              
                    int ch = 0;
                    while ((ch = in.read()) != -1)
                        strBuilder.append((char) ch);

                    // get returned message and show it
                    strServerResponseMsg = strBuilder.toString();
                    Log.i("Data returned by server:", strServerResponseMsg);

                    JSONArray jObjects = new JSONArray(strServerResponseMsg);
                    for(int i=0; i<jObjects.length(); i++){
                        System.out.println(jObjects.getJSONObject(i).getString("contestantId").toString());
                        System.out.println(jObjects.getJSONObject(i).getString("contestantName").toString());
                        System.out.println(jObjects.getJSONObject(i).getString("photoUrl").toString());
                }
                in.close();
            }

        } catch (IOException e) {
            e.printStackTrace();
        } catch (JSONException e) {
            e.printStackTrace();
        }       

    } 
```

我在“strServerResponseMsg”变量中有我的响应 Json。但在“ `JSONArray jObjects = new JSONArray(strServerResponseMsg);`”行中，Logcat 显示`typemismatch`错误。

请告诉我我的问题是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T05:05:45.143

`{`暗示它是一个对象。`[`暗示它是一个数组。由于您的字符串以它开头，`{`所以它是一个 JSONObject 而不是 JSONArray。

```
JSONArray jObjects = new JSONArray(strServerResponseMsg); 
```

一定是这样的

```
JSONObject jObjects = new JSONObject(strServerResponseMsg); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T05:00:56.660

给出的 json 示例不是 jsonarray 它是 jsonobject 所以你应该像下面这样

```
JSONObject jObj = new JSONObject(strServerResponseMsg);
JSONArray jArray = new JSONArray(jObj.getJSONArray("contestants")); 
```

然后遍历 jArray

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T05:15:11.487

这是你得到的 JSONObject，'{' 很明显。

```
 JSONObject j=null;

    try{
 j=new JSONObject(strServerResponseMsg);
}
catch(JSONException r)
{
    //Handle it.
    r.printStackTrace();

 }
 Log.w("json",j.toString()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T06:20:10.920

JSON是回溯的，如果你使用json你必须非常小心处理。因此，使用谷歌开发的 GSON api。它是在 json api 的帮助下制作的。请访问此链接 - [单击此处](http://www.javacodegeeks.com/2011/01/android-json-parsing-gson-tutorial.html)

# gpu - gpu 的非图形基准

> ID：10022891
> 
> 赞同：0
> 
> 时间：2012-04-05T04:58:14.330
> 
> 标签：gpu, gpgpu, nvidia

gpu 性能和负载测试的大多数基准测试都与图形相关。是否有任何计算密集但与图形无关的基准？我正在使用 DELL XPS 15 笔记本电脑、nvidia GT 525M 显卡、安装了 bumblebee 的 Ubuntu 11.04。

我想对我的系统进行负载测试，以得出显卡可以处理的最大负载。gpu 是否有任何非图形基准？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-09T23:10:25.893

你到底想测量什么？
要测量卡上的 GFLOPS，只需在 Cuda（或 OpenCL）中编写一个简单的内核。
如果您从未在 CUDA 中写过任何东西，请告诉我，我可以为您发布一些内容。
如果您的应用程序不是计算密集型应用程序（请查看屋顶线论文），那么 I/O 将成为瓶颈。从全局（卡）内存获取数据到处理器需要 100 个周期。
另一方面，如果您的应用程序是计算密集型的，那么只需计时并计算您每秒处理的字节数。为了达到最大 GFLOPS（你的卡可以达到 230），每次内存访问需要很多 FLOP，这样处理器就很忙，不会因为内存和切换线程而停顿。

# javascript - 使用 CSS 或 Javascript 将页脚固定到浏览器底部的 10%？

> ID：10022892
> 
> 赞同：1
> 
> 时间：2012-04-05T04:58:15.710
> 
> 标签：javascript, html, css

我有一个页脚部分高度为 400 像素的网页。现在我希望将页脚固定到浏览器底部的 10%，并且只有当页面向下滚动到页面末尾时，页脚的剩余部分才应该可见。

任何帮助，将不胜感激。

问候，

马尼谢卡瓦特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T07:09:58.943

解决方案基本上是为两个版本的页脚制作 css - 一个用于页脚将在文档流中有机地存在的`position:fixed;`另一个版本。`position:static;`

然后，您可以编写一个函数，通过监听[滚动事件在两者之间切换](https://developer.mozilla.org/en/DOM/window.onscroll)

# php - 服务器遇到内部错误或配置错误，无法完成您的请求

> ID：10022893
> 
> 赞同：0
> 
> 时间：2012-04-05T04:58:42.473
> 
> 标签：php, codeigniter

我安装了一个产品。我有这样的错误。我不知道如何解决这个问题。我也检查了 Php.ini 文件、.htacess 文件和文件权限。全部正确。任何人告诉解决方案。

错误信息 ：

内部服务器错误

服务器遇到内部错误或配置错误，无法完成您的请求。

请联系服务器管理员 webadmin@xxxxxx.xx 并告知他们错误发生的时间，以及您所做的任何可能导致错误的事情。

服务器错误日志中可能提供有关此错误的更多信息。

此外，在尝试使用 ErrorDocument 处理请求时遇到 404 Not Found 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T21:07:16.690

显示 404 错误的原因是因为它试图将错误写入日志，而您没有启用该日志：

首先要做的是，如果您可以进入网站的管理部分，请确保您已将错误报告设置为打开：

以下是启用错误报告的方法：

system_configuration_ADVANCED_Developer（系统>配置>高级>开发人员）

当您打开该选项卡时，您会看到一个名为“日志设置”的部分，请选择以下内容：

-启用为是 - 系统日志文件名：system.log（或者您可以将系统替换为另一个词，如 magensys.log） -异常日志文件名：exception.log

现在这两个日志文件都可以在 /var_log 中找到（www.domainhere.com/var/log 或者如果它是本地安装 magentofolder/var/local）

尝试重新加载发生此错误的页面，如果再次发生，请打开错误日志以查看错误。

大多数情况下，这是由于扩展与您要完成的任务不一致。

选项2）转到app_etc_local（app/etc/local）并删除local.xml，然后重新加载您的站点并重新安装magento，这不会删除您的站点，只是重新加载您的基本设置，这样您就可以一切恢复正常。

如果您可以更清楚地了解您正在安装的产品类型、安装位置等……这将有助于查明错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T05:10:34.683

也许[这篇文章](http://php.net/manual/en/errorfunc.configuration.php) 会对你有所帮助。尝试使用

```
<?php
    # test.php
    error_reporting(E_ALL);
    ini_set('display_errors','On');

    ini_set('error_log','my_file.log');
    foreach(1 as $i);

    ini_set('error_log','');
    foreach(1 as $i);

    ini_set('error_log','/dev/null'); #linux
    foreach(1 as $i);
 ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T05:02:42.983

您需要检查您的 php 错误日志，如果您不知道它在哪里，您可以从终端执行以下操作：

```
$ -> `php -i | fgrep -i error` 
```

您应该会看到`error_log`. 跟踪该文件并刷新页面，它应该显示错误。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-10-29T17:22:00.613

由于 httaccs 文件中的条目错误，我遇到了这个错误。请检查您的 http 访问文件

# java - Windows Server 2003 与 Windows Server 2008 上的 Java 运行批处理文件问题

> ID：10022894
> 
> 赞同：2
> 
> 时间：2012-04-05T04:59:01.507
> 
> 标签：java, batch-file

使用java的“runtime.exec”我执行一个批处理文件。通过java本身创建的批处理文件。我的查询是在运行时创建的批处理文件在我的机器（XP）和 Windows Server 2008 R2 上执行良好。但是在 Windows Server 2003 上，批处理文件得到了顶饰，但它没有执行。但是如果我双击它执行的批处理文件。

```
Process process = runtime.exec("cmd /c start /b "+batchFile.getPath()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T05:22:38.263

`cmd.exe`这可能是因为在 Windows Server 2003 上运行批处理所需的（缺少）管理员权限。

**方法 1**为运行批处理作业的用户帐户 授予`cmd.exe`程序读取和执行权限。为此，请按照下列步骤操作：

1.  单击开始，然后单击 Windows 资源管理器。
2.  找到并右键单击该`cmd.exe`文件。Cmd.exe 文件位于该`%windir%\System32`文件夹中。
3.  单击属性。
4.  单击安全选项卡。
5.  单击添加。
6.  在“输入要选择的对象名称”框中，键入运行批处理作业的用户名，然后单击“确定”两次。

**注意**添加用户时，会自动授予用户读取和执行权限。7\. 当系统提示您继续时，单击是。

**方法 2** 将文件的读取和执行权限授予`cmd.exe`批处理组。这允许所有批处理进程运行命令处理器。为此，请按照下列步骤操作：

1.  单击开始，然后单击 Windows 资源管理器。
2.  找到并右键单击该`cmd.exe`文件。该`cmd.exe`文件位于`%windir%\System32`文件夹中。
3.  单击属性。
4.  单击安全选项卡。
5.  单击添加。
6.  在“输入要选择的对象名称”框中，键入 Batch，然后单击“确定”两次。
7.  当系统提示您继续时，单击是。

有关详细信息，请参阅以下 Microsoft 知识库文章：

[在基于 Windows Server 2003 的计算机上运行批处理作业时出现“拒绝访问”错误消息](http://support.microsoft.com/kb/867466)

# android - 从平板电脑转移到手机

> ID：10022895
> 
> 赞同：0
> 
> 时间：2012-04-05T04:59:11.023
> 
> 标签：android

我已经为平板电脑开发了我的应用程序。现在我需要将其转换为在手机上运行。我需要做哪些改变？我需要遵循什么特定步骤吗？我尝试在手机模拟器上按原样部署应用程序，但东西似乎被切断了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:05:36.243

你问了一个笼统的问题，所以我能做的就是给你一个笼统的答案。[此处](http://developer.android.com/guide/practices/screens_support.html)概述的步骤和程序应该正是您正在寻找的。在一个非常普遍的意义上，你只是想要为不同的屏幕尺寸有不同的布局。Android 使用他们的资源“桶”很容易做到这一点。

# ms-access - Access Query - MS Access 查询中语句的正确格式

> ID：10022899
> 
> 赞同：2
> 
> 时间：2012-04-05T04:59:55.087
> 
> 标签：ms-access

我在 Access 数据库中有 VBA 代码。我收到一条错误消息“运行时错误 3464 - 表达式中的数据类型不匹配”，我的代码中有以下几行。该行的正确格式是什么？我确定它是一个简单的引号或行中缺少的东西。

在数据库中，有一列称为 APIC 成员。我只想要在单元格中列出“1”的记录。

```
Table$ = "SELECT * From WHY_Open_Cases_YTD WHERE WHY_Open_Cases_YTD.[APIC Member] = 1;"
Set RST = myDB.OpenRecordset(Table$) 
```

请告知我做错了什么。当我调试消息时，我得到`Set RST = myDB.OpenRecordset (Table$)`突出显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:40:24.270

在我的 Access 2003 和 2007 系统上，错误 #3464 的完整描述是“*标准表达式中的数据类型不匹配*”。数据库引擎抱怨您要求它使用的 SQL 语句。

如果`[APIC Member]`是文本数据类型而不是数字数据类型，请在您比较的值周围添加引号。

```
Table$ = "SELECT * From WHY_Open_Cases_YTD WHERE [APIC Member] = '1';" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T05:10:51.547

“数据类型不匹配”对我来说听起来好像您打开了错误类型的记录集。
`myDB.OpenRecordset()`期望 a `DAO.Recordset`，而你`RST`的可能是`ADODB.Recordset`.

请参阅此答案以获得更深入的解释：
[在 Access 2003/2007 中打开记录集](https://stackoverflow.com/questions/6034959/open-recordset-in-access-2003-2007/6035362#6035362)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-15T16:01:45.473

尝试

```
Table$ = "SELECT * From WHY_Open_Cases_YTD WHERE '[APIC Member]' = '1';" 
```

我对 DAO 有同样的问题，事实证明它不会接受 SQL 查询，直到你也引用了字段名称。

# c# - 服务器拒绝接受来自客户端的请求

> ID：10022901
> 
> 赞同：0
> 
> 时间：2012-04-05T05:00:05.683
> 
> 标签：c#, client-server, tcpclient, serversocket, tcplistener

这是一个从文件中搜索字符串的程序。客户端所需的字符串是从客户端给出的，在我的例子中，使用 telnet。我编写的程序是服务器端程序。它接受多个客户端。但是，我无法纠正的问题是——

*   它不检查文件中的字符串。
*   一旦客户端建立连接，客户端就无法在该特定文件中输入他们想要搜索的字符串。
*   它不会将回复发送回（即文件中是否存在字符串）给客户端。它只显示在服务器端。

我该如何进一步进行？有人能告诉我我哪里出错了吗？有人可以帮我写代码吗？这是我对程序的尝试..

```
class Program
{

    static void Main(string[] args)
    {
        IPAddress ipad = IPAddress.Parse("192.168.0.181");
        TcpListener serversocket = new TcpListener(ipad, 8888);
        TcpClient clientsocket = default(TcpClient);
        Byte[] bytes = new Byte[256];

        serversocket.Start();

        Console.WriteLine(">> Server Started");
        while(true)
        {
            clientsocket = serversocket.AcceptTcpClient();
            Console.WriteLine("Accepted Connection From Client");

            LineMatcher lm = new LineMatcher(clientsocket);
            Thread thread = new Thread(new ThreadStart(lm.Run));
            thread.Start();
            Console.WriteLine("Client connected");
        }

        Console.WriteLine(" >> exit");
        Console.ReadLine();
        clientsocket.Close();
        serversocket.Stop();

    }
}

public class LineMatcher //I've jumbled it up here. Don't know what exactly to do..
{
     public string fileName = "c:/myfile2.txt";
     private TcpClient _client;

     public LineMatcher(TcpClient client)
     {
         _client = client;
     }

     public void Run()
     {
         try
         {
              StreamReader sr = new StreamReader("c:/myfile2.txt");
              using (var reader = new StreamReader(_client.GetStream()))
              {
                  string line ="";
                  int lineNumber = 0;
                  while (null != (line = sr.ReadLine()))
                         {
                             lineNumber += 1;
                             byte[] data = new byte[1024];
                             NetworkStream stream = _client.GetStream();
                             //if (line.Equals(line))
                             for (int ct = stream.Read(data,0, data.Length-1); 0 < ct; ct = stream.Read(data,0,data.Length-1))

                                 line += Encoding.ASCII.GetString(data, 0, ct);
                             line = line.Trim();

                             {
                                 lineNumber.ToString();

                                 data = Encoding.ASCII.GetBytes(line);
                                 _client.Client.Send(data, data.Length, SocketFlags.None);
                                 Console.WriteLine("Line {0} matches {1}", lineNumber, line);
                             }
                         }
             }
         }
         catch (Exception ex)
         {
             Console.Error.WriteLine(ex.ToString());
         }
         Console.WriteLine("Closing client");
         _client.Close();
     }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T13:11:31.310

我认为您在 Run-method 中交换了一些部分 - 这是一个应该完成这项工作的版本：

```
public void Run()
{
     byte[] data;
     try
     {
        using (var r = new StreamReader("c:/myfile2.txt"))
        {
            string line ="";
            int lineNumber = 0;
            while (null != (line = r.ReadLine()))
            {
                data = Encoding.ASCII.GetBytes(line + "\n");
                _client.Client.Send(data, data.Length, SocketFlags.None);
            }
        }
     }
     catch (Exception ex)
     {
         Console.Error.WriteLine(ex.ToString());
     }
     Console.WriteLine("Closing client");
     _client.Close();
} 
```

请注意，我不是 100% 确定您要做什么（我认为您希望您的文本文件逐行发送到您的终端） - 所以您可能需要在这里和那里更改一些位。

不知道代码中的 Stream-messes 来自哪里，但我猜您尝试了各种教程/片段并忘记清理；）

# internet-explorer-7 - IE7 中的 Z-index 问题

> ID：10022905
> 
> 赞同：0
> 
> 时间：2012-04-05T05:00:40.857
> 
> 标签：internet-explorer-7, z-index

我在页面标题的弹出窗口中有一个登录表单，在它下面我有一个导航，当我打开弹出窗口时，导航链接显示在弹出窗口上方。我已将导航的 z-index 设置为 1，弹出窗口的 z-index 为 10，但在 IE7 中不起作用。任何人都可以帮助我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T08:47:53.487

这是 IE7 的一个已知错误。不适用于 IE7 和 IE8（兼容性视图）。解决方法是：您需要检查层次结构。弹出窗口都应该在同一个堆叠上下文中/或者你可以说必须有父子关系。并将父/弹出窗口保持为相对，z-index 应大于子级。

您还可以从我获得示例的地方查看以下链接

[http://brenelz.com/blog/squish-the-internet-explorer-z-index-bug/](http://brenelz.com/blog/squish-the-internet-explorer-z-index-bug/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T05:03:24.723

您需要将弹出位置设置为相对，IE 仅在其位置设置为相对时读取 z-index，试一试

# sql - 是否有与 SQL Server/Oracle WITH 关键字等效的 Sybase？

> ID：10022911
> 
> 赞同：1
> 
> 时间：2012-04-05T05:01:28.473
> 
> 标签：sql, sybase

在 Oracle / SQL Server 中，我可以使用 WITH 关键字来定义用于视图的临时表：

```
WITH a AS (SELECT something_horrible FROM somewhere_horrible)
SELECT * FROM a 
```

当“表”a 可能在查询中多次使用时非常方便。我认为当 a 的 SELECT 令人费解（我认为它通常只执行一次）时，性能会有所提高。

Sybase 中是否有等价物？

（注意我知道有临时表，但我正在尝试编写视图，因此没有创建/使用临时表的语法）

提前致谢

瑞安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T05:07:07.173

AFAIK Sybase 支持 CTE。所以你可以同时使用 WITH 和 WITH RECURSIVE 关键字

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-30T19:35:00.763

这个技术怎么样：

```
SELECT h.* FROM
    (SELECT something_horrible FROM somewhere_horrible) h 
```

# jquery - Kendo UI vs jQuery UI - 大小和 javascript 框架

> ID：10022912
> 
> 赞同：5
> 
> 时间：2012-04-05T05:01:41.407
> 
> 标签：jquery, jquery-ui, kendo-ui

我看过两者的比较，但有一件事我不清楚。

新的 Kendo 产品是使用 jQuery 还是使用自己的框架。我问的原因是我已经在使用 jQuery，如果我使用 Kendo 会要求我有另一个框架吗？

此外，Kendo 的大小与 jQuery / jQuery UI 相比如何，如果我使用 Kendo，是否有办法只选择特定的组件，还是需要下载整个代码 / css？

是否有任何 jQuery UI 用户正在考虑或已经转向 Kendo UI？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T05:16:55.090

> 新的 Kendo 产品是使用 jQuery 还是使用自己的框架。

Kendo 完全基于 jQuery。它有自己的组件 API，文档齐全且易于使用。

> 此外，Kendo 的大小与 jQuery / jQuery UI 相比如何，如果我使用 Kendo，是否有办法只选择特定组件，还是需要下载整个代码 / css？

我建议你下载剑道试用版，你会找到你正在寻找的所有答案。下载包由单独的组件 js/css 文件和组合文件组成。您可以选择包含哪些内容。

# android - 安卓图形和视图

> ID：10022913
> 
> 赞同：0
> 
> 时间：2012-04-05T05:01:58.860
> 
> 标签：android, android-canvas, android-view

我对绘图时画布的工作有疑问，提到画布保存绘图调用，位图保存实际像素数据，例如在代码中

```
public class MyView extends View{

    private Paint _p;
    public float x=10,y=10;
    private Canvas _canvas;
     static int cnt=0;

    public MyView(Context context) {
        super(context);
        // TODO Auto-generated constructor stub
        _p = new Paint();
        _p.setColor(Color.GREEN);
        _canvas = new Canvas();

        this.setOnTouchListener(new OnTouchListener() {

            @Override
            public boolean onTouch(View v, MotionEvent event) {
                // TODO Auto-generated method stub
                cnt++;
                _canvas.drawCircle(event.getX(), event.getY(), 10, _p);
                if(cnt>3){
                    cnt = 0;
                    invalidate();
                }
                return false;
            }
        });

    }

    public void onDraw(Canvas can){
        _canvas = can;
        super.onDraw(_canvas);
        _canvas.drawColor(Color.BLACK);
        _canvas.drawCircle(x, y, 10, _p);
        x = x +10;
        y= y+10;
    }
} 
```

应该画3个圆圈，但事实并非如此，有人可以解释一下吗？提前谢谢

问候， 罗希特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:12:06.977

你的 onTouch 只有一次检查来绘制圆圈，它不是一个递归循环，直到绘制 3 为止。这是假设您的 _canvase.drawCircle() 事件（未显示）未绘制 3 个圆圈。

# apache-flex - Flex Mobile：无法在 ActionBar 的标题内容区域中正确定位组件

> ID：10022914
> 
> 赞同：1
> 
> 时间：2012-04-05T05:02:00.563
> 
> 标签：apache-flex, mobile, flex-actionbar

当我尝试在 ActionBar 的 titleContent 中放置一个按钮时，事情变得很奇怪。设置“left”和“horizo​​ntalCenter”都不能移动我的按钮。代码如下：

```
 <s:titleContent>
       <s:Button label="HELLO" left="50"/>
    </s:titleContent> 
```

如何在此操作栏的中间放置一个按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T07:16:29.250

[文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/components/ActionBar.html)说 titleContent 的默认布局是Horizo [​​ntalLayout](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/layouts/HorizontalLayout.html)。所以 'left' 和 'horizo​​ntalCenter' 不适用。

您可以使用该属性为标题内容`titleLayout`使用不同的布局 ( [BasicLayout )：](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/layouts/BasicLayout.html)

```
<s:titleLayout>
    <s:BasicLayout />
</s:titleLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-03T19:36:46.987

您还可以使用 css ：

```
s|ActionBar 
{
    titleAlign: center;
} 
```

# php - 当前登录用户“拥有”的安全更新或插入行

> ID：10022919
> 
> 赞同：1
> 
> 时间：2012-04-05T05:02:51.487
> 
> 标签：php, mysql, security

我试图弄清楚如何构建这个数据库：

![在此处输入图像描述](../Images/674f5d99712d8854fdef0f4f7c067780.png)

我有桌子`Users`、桌子`Galleries`和桌子`Images`。

用户登录后，我将他的 ID 存储为`$_SESSION[user_id]`

* * *

表`Galleries`有列 user_id 来存储谁拥有它。

表`Images`有gallery_id 来存储它们属于哪个画廊。

在客户端，当我想将新图像上传到图像中时，我使用当前的画廊 ID 来设置`gallery_id`图像的。

这样做的问题是，有人可以通过更改`gallery_id`.

我是否也应该`user_id`在图像表中添加一个并检查`$_SESSION[user_id]`或者可能为每个图像、画廊和用户生成一个完全唯一的 ID 并在客户端使用它，或者我可以加入所有 3 个表然后检查`user_id`？

最佳做法是什么？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T06:16:10.020

如果您在 images 表中的 gallery_id 列不为空，那么您可以执行以下操作

```
INSERT INTO images (gallery_id,image_file) 
    SELECT id,'$image_file'
    FROM Galleries 
    WHERE id = $gallery_id AND user_id = {$_SESSION[user_id]} 
```

我很确定（未经测试）如果 $gallery_id 和 $_SESSION['user_id'] 不匹配任何行，则 SELECT 将返回 gallery_id 作为 NULL，因此 INSERT 将失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T05:05:12.250

不，在您实际接受上传的文件并将记录添加到`images`表之前 - 您只需执行一个微小的检查用户是否是正确的查询：

```
SELECT COUNT(*) AS cnt FROM Galleries WHERE id = $gallery_id AND user_id = {$_SESSION[user_id]} 
```

如果这个查询没有返回`0`- 那么一切都很好，继续处理。否则中止

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-05T05:19:27.580

套用你 -**问题是有人可以通过更改gallery_id来篡改数据并将图像上传到其他人的画廊。**

您将 存储`user_id`在会话变量中，为什么不存储`gallery_id`在会话中...这将防止最终用户意外篡改数据流。

通过将`gallery_id`url /传递`gallery_id`给用户，总会有滥用的机会。由于此变量更改直接影响您的数据（它不是只读的，它会修改数据），因此公开传播并不是一个好主意，将其留给操作/数据完整性错误。

# variables - 哪些语言具有交换变量的原始操作？

> ID：10022921
> 
> 赞同：2
> 
> 时间：2012-04-05T05:03:00.847
> 
> 标签：variables, programming-languages, language-features

在大多数语言中，如果你想交换两个变量，它是这样的：

```
var c = b
b = a
a = c 
```

是的，如果你愿意的话，你可以用 XOR 做一些花哨的 hack，但是对于单个操作来说，它通常是 3 行代码。是否有任何语言将交换变量作为语言中的原语？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T05:05:18.037

Lua、Python、Ruby 等支持这种表示法：

```
a, b = b, a 
```

而且javascript当然也不需要临时变量；）

```
a = -(b = (a += b) - b) + a; 
```

有关如何交换变量（86 种语言）的更多示例，请参见：[http ://rosettacode.org/wiki/Generic_swap](http://rosettacode.org/wiki/Generic_swap)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T05:05:23.350

在大多数动态语言中，您可以执行以下操作来交换：

```
a, b = b, a 
```

现在 a 具有 b 的值，b 具有 a 的值。我不确定这是否是您的意思。

# java - 在JFrame之外找到鼠标的位置？

> ID：10022924
> 
> 赞同：0
> 
> 时间：2012-04-05T05:03:46.917
> 
> 标签：java, swing, awt

> **可能重复：**
> [如何在Java中获取我的窗口外的鼠标点击坐标](https://stackoverflow.com/questions/2419555/how-to-obtain-mouse-click-coordinates-outside-my-window-in-java)

我基本上需要找出鼠标指针的位置。我试过这个：

```
package main;

import java.awt.event.MouseEvent;
import java.awt.event.MouseMotionListener;

public class MouseListen implements MouseMotionListener{

    public void mouseDragged(MouseEvent arg0) {     
    }

    public void mouseMoved(MouseEvent arg0) {
        mouseX = arg0.getX();
        mouseY = arg0.getY();
    }

   public int mouseX, mouseY;

} 
```

现在这仅在`JFrame`窗口内有效。我怎么可能在外面找到鼠标的 x 和 y 位置`JFrame`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T07:29:29.103

```
MouseInfo.getPointerInfo().getLocation().x;
MouseInfo.getPointerInfo().getLocation().y; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T05:25:01.430

您想要屏幕上鼠标指针的 X 和 Y 坐标吗？尝试使用`MouseEvent.getXOnScreen()`and `MouseEvent.getYOnScreen()`（从 Java 1.6 开始）

# javascript - 检查 ascii 纯文本

> ID：10022925
> 
> 赞同：2
> 
> 时间：2012-04-05T05:04:16.403
> 
> 标签：javascript, jquery, html

如何检查上传的文件是否为 ascii 纯文本？

```
$("#my_file").change(function(){
    //alert if not ascii 
});
<input type="file" name="my_file" id="my_file" /> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T05:22:18.920

使用[HTML5 文件 API](http://www.html5rocks.com/en/tutorials/file/dndfiles/)（尚未最终确定，并非所有主流浏览器的所有版本都支持），您可以通过读取原始文件内容`FileReader.readAsBinaryString(file)`并确保每个字节（字符）具有[ASCII 字符范围](http://en.wikipedia.org/wiki/ASCII)（0-127 ）。

例如（[请参阅此处的工作 jsFiddle](http://jsfiddle.net/KQYNe/5/)）：

```
function ensureAsciiFile(evt) {
  var file, files=evt.target.files;
  for (var i=0; file=files[i]; i++) {
    var reader = new FileReader();
    reader.onload = (function(theFile, theReader) {
      return function(e) {
        var fileContents = theReader.result;
        if (fileContents.match(/[^\u0000-\u007f]/)) {
          alert('ERROR: non-ASCII file "' + theFile.name + '"');
        } else {
          alert('OK: ASCII file "' + theFile.name + '"');
        }
      };
    })(file, reader);
    reader.readAsBinaryString(file);
  }
}
$('#my_file').change(ensureAsciiFile); 
```

# python - 无法在 Mac 上的 Eclipse 中安装 BeautifulSoup

> ID：10022928
> 
> 赞同：0
> 
> 时间：2012-04-05T05:04:56.650
> 
> 标签：python, eclipse, macos, beautifulsoup, pydev

```
ImportError: No module named BeautifulSoup 
```

我已经试过了`easy_intall`，`python setup.py install`都不管用。即使我安装了 BeautifulSoup，我仍然遇到同样的错误。

我已经从 python.org 预安装了 python 2.7.2 和 python 2.7 和 3.2。

我根据终端在python 2.7的目录下安装了soup，如下。

```
running install
running build
running build_py
running install_lib
running install_egg_info
Removing /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/beautifulsoup4-4.0.3-py2.7.egg-info
Writing /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/beautifulsoup4-4.0.3-py2.7.egg-info 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T06:52:16.507

如果一切都失败了，只需将 BeautifulSoup 源代码放在你的 python 目录中。就像在 ~/Python_install_dir/Lib/

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T12:31:51.450

您已经安装了 Beautiful Soup 4（“beautifulsoup4-4.0.3-py2.7.egg-info”），但您正在使用 Beautiful Soup 3 的导入语句。

软件包名称从“BeautifulSoup”更改为“bs4”，以便两个版本可以在同一个安装中共存。

将您的导入语句更改为这样的内容，它应该可以工作：

```
from bs4 import BeautifulSoup 
```

有关详细信息，请参阅文档部分[“将代码移植到 BS4”](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#porting-code-to-bs4)。BS4 并不完全向后兼容 BS3，但大多数 BS3 代码在您更改导入语句后应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T06:57:13.040

您确定使用与安装相同的解释器吗？如果您有 2 个 python 解释器（例如 2.6 和 2.7）并使用 2.6 easy_install 安装了 BeautifulSoup，那么它在您的 2.7 中将不可用。

# javascript - 如何知道点击了哪个元素

> ID：10022934
> 
> 赞同：0
> 
> 时间：2012-04-05T05:05:27.587
> 
> 标签：javascript, dom, onclick, classname

我有这个代码：

```
( function() {
  var i, ii, e = Elements.Select('.drop');
  for ( i = 0, ii = e.length; i < ii; i++ ) {
    e [ i ].onclick = function () {
      alert ( e [ i ].getAttribute('data-open') );
    }
  }
})(); 
```

我所做的是，当单击具有 className 'drop' 的元素时，会提醒我单击的元素的属性。但不起作用的。

这段代码是我用来通过她的类名选择一个元素的代码。不要太在意，它只是向我们展示只是向他们展示我是如何选择元素的。

```
(function() {
  Select : function ( element ) { 
  var object, index  = element.substr( 0, 1 ), name = element.substr( 1, element.length ),      clases = [ ], i, all = document.body.getElementsByTagName("*"); 
  switch ( index ) { 
    case '.' : 
      for ( i = 0; i < all.length; i ++ ) { 
        if ( all [ i ].className == name ) {   
          clases.push( all [ i ] ); 
        } 
      } 
      object = clases; 
    break;  
    return object 
    } 
  } 
})(); 
```

¿ 答案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:12:01.510

```
( function() {
  var i, ii, e = Elements.Select('.drop');
  for ( i = 0, ii = e.length; i < ii; i++ ) {
    e [ i ].onclick = function () {
      //by the time that this gets executed, the for loop is ended, thus i equals ii
      // instead of using e[i]... try using this : 
      alert (this.getAttribute('data-open'));
      alert ( e [ i ].getAttribute('data-open') );
    }
  }
})(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-05T05:11:04.237

您可以为此使用 jquery。这里，“this”关键字为您提供了当前单击的元素。此函数在类名为“drop”的任何元素的单击事件上触发。

```
$(".drop").click( function(){
   var x=$(this).attr("data-open");
}); 
```

# jquery - 用于文本框验证的 jquery 函数

> ID：10022944
> 
> 赞同：0
> 
> 时间：2012-04-05T05:08:14.893
> 
> 标签：jquery

我需要一个 jquery 函数来验证我的文本框值。

要求：必填字段：true，最小长度：8，最大长度：16，应仅允许字母、数字。

我写了一个函数：

```
jQuery.validator.addMethod("nameRegex", function (value) {
      //  alert(value);
        if (value.length >= 8) {
           // alert(value.length); 
                return value.match(/^[a-zA-Z0-9 ]+$/.test(value)); 
        }
    }, "Contain only letters, numbers."); 
```

但这不起作用，任何人都可以帮助我。

-辛杜.A

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T06:08:30.760

Hiya hope this help :)) **Working Demo** : [http://jsfiddle.net/2FByp/2/](http://jsfiddle.net/2FByp/2/)

Like @zerkms said please be very clear what is not working. you can always refer to the validation plugin documentation && this might help you as well: [using the jquery validation plugin, how can I add a regex validation on a textbox?](https://stackoverflow.com/questions/1053618/using-the-jquery-validation-plugin-how-can-i-add-a-regex-validation-on-a-textbo)

**NOTE** Please make sure all the rules are added correctly and compare your implementation with the jsfiddle above, else flick me jsfiddle I might be help BUT this js fiddle will help you to find out why it is not working. :)

**HTML**

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script type="text/javascript" src="http://jquery.bassistance.de/validate/jquery.validate.js"></script>

<script type="text/javascript">

</script>

<form method="post" id="myForm">

    Name regex (alphanumeric):<input type="text" name="name" />  
    <input type="submit" value="Go" />  
</form>​ 
```

**JQuery Code**

```
 $(function() {

    $.validator.addMethod("nameRegex", function(value, element) {
        return this.optional(element) || /^[a-z0-9\-]+$/i.test(value);
    }, "Username must contain only letters, numbers, or dashes.");

    $("#myForm").validate({
        rules: {
            "name": {
                required: true,
                nameRegex: true,
                minlength: 8

            }
        },
        messages: {
            "name": {
                required: "You must enter a login name",
                nameRegex: "Contain only letters, numbers."
            }
        }
    });

});​ 
```

Hope this is helpful cheers!

# sql-server - 如何从 Hibernate 执行 INSERT 的 SQL Server 存储过程？

> ID：10022946
> 
> 赞同：0
> 
> 时间：2012-04-05T05:08:28.783
> 
> 标签：sql-server, sql-server-2008, hibernate, stored-procedures, jdbc

我已经能够在 hibernate 中执行存储过程以将结果查询映射到 Java Bean。

例如，我有一个名为 Profesor.hbm.xml 的文件：

```
<hibernate-mapping>
        <class name="model.Profesor" table="Profesor" catalog="dbo">
            <id name="idProfesor" type="int">
                <column name="idProfesor" />
                <generator class="assigned" />
            </id>
        <property name="Nombre" type="string">
            <column name="Nombre"  length="25" not-null="false" />
        </property>
        <property name="ApellidoP" type="string">
            <column name="ApellidoP" length="20" not-null="false" />
        </property>

        <property name="ApellidoM" type="string">
            <column name="ApellidoM" length="20" not-null="false" />
        </property>
            </class>

        <sql-query name="getProfesors" callable="true">
        <return alias="getProfesors" class="model.Profesor">

        <return-property name="idProfesor" column="idProfesor"/>
        <return-property name="Nombre" column="Nombre"/>
        <return-property name="ApellidoP" column="ApellidoP"/>
        <return-property name="ApellidoM" column="ApellidoM"/>
        </return>
        exec getProfesors :idTT
        </sql-query>
</hibernate-mapping> 
```

然后在我的教授课程中，我有以下代码：

```
SessionFactory sf = new Configuration().configure().buildSessionFactory();
session = sf.getCurrentSession();

public List <Profesor> getProfesors(String idTT){
    session.beginTransaction();

    query.setString("idTT", idTT);

return query.list();
} 
```

这完美地工作，我没有问题，存储过程执行并用结果填充我的名为 Profesor 的模型类。

现在我有另一个存储过程，它插入数据以在数据库中创建一个新的 Profesor。

我尝试了这样的事情但没有成功：

```
session.beginTransaction();
Connection c = session.connection();
CallableStatement cs = c.prepareCall( "{call addProfesor(?,?,?)}" ) ;
cs.setString(1, "George");
cs.setString(2, "Williams");
cs.setString(3, "Mathematics");

cs.executeUpdate(); 
```

它甚至没有向我显示错误消息，只是不会插入数据。我也在读，就像有一个 <"sql-query"> 标记，有一个 <"sql-insert"> 但是我看不到调用那个 <"sql-insert"> 的方法，因为它没有像 sql-query 那样的“名称”属性。

使用 <"sql-query"> 我们可以这样做：

```
 Query query =session.getNamedQuery("getProfesors"); 
```

就像我之前展示的那样，但是由于 sql-insert 没有该属性名称，我不知道该怎么做。我也被迫使用存储过程，因为这是一个非常特殊的要求，否则我会使用其他 Hibernate 持久性功能。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:25:19.813

您可以为插入、更新和删除指定“自定义 sql”。请参阅有关它[的文档](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/querysql.html#querysql-cud)。

这些不是命名查询。当 Hibernate 插入、更新或删除这个实体时，它们总是被使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T06:31:08.523

另一种方法是从准备好的语句中调用存储过程。如果存储过程更新多条记录（批量更新），这可能很有用。

```
PreparedStatement ps = getSession().connection().prepareStatement("{exec sp_batchRateUpdate}");
ps.execute(); 
```

[但请注意：自 Hibernate 3.2.4 ( https://hibernate.onjira.com/browse/HHH-2603](https://hibernate.onjira.com/browse/HHH-2603) )以来，休眠会话的 connection() 方法已被弃用。

```
PreparedStatement ps = ((SessionFactoryImplementor)sessionFactory).getConnectionProvider()
                    .getConnection().prepareStatement("{exec sp_batchRateUpdate}");
ps.execute(); 
```

# android - 如何通知 Activity 应用程序中全局变量的变化？

> ID：10022950
> 
> 赞同：3
> 
> 时间：2012-04-05T05:08:49.053
> 
> 标签：android, notifications, broadcastreceiver, intentservice

我有一个 IntentService 可以更新扩展应用程序类中的全局变量。在我的几个活动中，我需要知道变量何时更改。我是否必须在我的所有活动中实现广播接收器（并从我的服务发送意图），还是有更简单的方法来通知我的活动？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T05:32:49.727

我也遇到过这类问题。解决方案之一中的广播接收器。但我对此并不满意。所以，我尝试了另一种方法。您可以在 Android 中的对象观察者模式中找到更多详细信息，[请参阅此链接](http://rameshandroidworld.wordpress.com/2012/04/05/object-observer-pattern-in-android/)。

```
public class TestActivity extends Activity implements Observer {
        BaseApp myBase;

        @Override
        protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

            myBase = (BaseApp) getApplication();
            myBase.getObserver().addObserver(this);
            myBase.getObserver().setValue(10);

        }

        @Override
        public void update(Observable observable, Object data) {
            // This method is notified after data changes.

            Toast.makeText(this, "I am notified" + myBase.getObserver().getValue(),
                    0).show();
        }
    }

    public class Test extends Observable
    {

        private int value=2;

        /**
         * @return the value
         */
        public int getValue() 
        {
            return value;
        }

        /**
         * @param value
         *            the value to set
         */
        public void setValue(int value) 
        {
            this.value = value;
            setChanged();
            notifyObservers();
        }
    }

    package app.tabsample;

    import android.app.Application;

    public class BaseApp extends Application {
        Test mTest;

        @Override
        public void onCreate() {
            super.onCreate();

            mTest = new Test();
        }

        public Test getObserver() {
            return mTest;
        }

    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-05T05:19:23.833

是的，BroadcastReceivers 就是为此而设计的。也就是说，为什么不只创建一个具有 BroadcastReceiver 和所有相关逻辑的父类？然后，您的其他活动唯一要做的就是从该父类继承。

请注意，每次发送广播时，您还应该在持久存储中设置某种全局变量（如共享首选项）。这样，如果在发送广播时您的某个活动不在前台，它可以在该`onResume()`方法返回时检查持久存储中的变量并采取相应措施。

# silverlight - 绑定到用户控件元素的列表框？

> ID：10022951
> 
> 赞同：1
> 
> 时间：2012-04-05T05:08:52.670
> 
> 标签：silverlight, xaml, silverlight-toolkit

这不适合我：

```
<StackPanel>
    <ListBox x:Name="MyListBox"
        ItemsSource="{StaticResource UserControlsCollection}">
        <ListBox.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel Orientation="Horizontal" />
            </ItemsPanelTemplate>
        </ListBox.ItemsPanel>
    </ListBox>
    <UserControl
        Content="{Binding ElementName=MyListBox, Path=SelectedValue}"
        />
</StackPanel> 
```

我在运行时收到此“项目不在预期范围内”错误。这些是数据：

```
<toolkit:ObjectCollection x:Key="UserControlsCollection">
    <UserControl Style="{StaticResource UserControlListItemStyle}">
        <Button>One Button</Button>
    </UserControl>
    <UserControl Style="{StaticResource UserControlListItemStyle}">
        <ComboBox>
            <ComboBoxItem Content="One" IsSelected="True" />
            <ComboBoxItem Content="Two" />
            <ComboBoxItem Content="Three" />
        </ComboBox>
    </UserControl>
    <UserControl Style="{StaticResource UserControlListItemStyle}">
        <Rectangle
            Fill="Red"
            Width="120" Height="120"
            />
    </UserControl>
</toolkit:ObjectCollection> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T11:18:23.863

您试图显示相同的 FrameworkElements（集合中的那些）两次：一次作为 ListBox 中的项目，然后在绑定的 UserControl 中选择第二次。

所有 FrameworkElements 只能在可视化树中挂接一次（即当它们触发加载的事件时）。

要实现您想要做的事情，您需要分离模型和视图。模型将在您的集合中并且可以是任何类型，通常实现 INotifyPropertyChanged 或从 DependencyObject 派生，并且您的视图可以是 DataTemplates 作为资源，Target 属性是模型的类型。

从 SL5 开始，任何以模型作为其内容的 ContentControl（类似地，将模型作为绑定集合的元素的 ListBox）如果在范围内，则将自动拾取这些 DataTemplate。然后，模板可能会为每个模型实例化多次。

# python - if a in list（我想向列表中的元素添加一些内容）Python

> ID：10022952
> 
> 赞同：2
> 
> 时间：2012-04-05T05:08:58.363
> 
> 标签：python, syntax, if-statement

正如主题所述：

```
list = ["a", "b"]

element = "ac" 
```

我可以使用：

```
if element in list: 
```

如果元素等于 (list + "c") 中的元素

我想要实现的伪代码：

```
if element in (list+c) 
```

在 python 中获得这种行为的最佳方法是什么？

**编辑：**我知道有很多方法可以解决这个问题，但是可以像上面的代码那样在一行中完成。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T05:11:58.347

更有效的是：

```
if any(x+'c' == element for x in your_list): 
```

因为它避免了两次扫描列表（一次用于制作“+c”版本，一次用于检查元素是否在结果列表中）。如果它在遍历整个列表之前找到元素，它也会“短路”（即快速继续）。

* * *

PS - 最好不要命名变量`list`，因为这已经是实际列表*类型*的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T05:11:04.430

```
if element in [elem + 'c' for elem in my_list]:
    # ... 
```

调用变量`list`（或`int`, `float`, `map`,`tuple`等）绝不是一个好习惯，因为您正在失去那些内置类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T06:14:00.237

```
if element[0] in list: 
```

您不想添加`"c"`到列表中的每个项目并检查是否`"ac"`在结果中；您想检查第一个字母`"ac"`是否在列表中。除了容易得多之外，这是相同的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T06:27:42.523

```
if element[:-1] in list: 
```

最好计算没有'c'的元素。所以你只做一个计算。

# c# - 如何使用 c# 在 Asp.net 中生成动态模板字段？

> ID：10022958
> 
> 赞同：-3
> 
> 时间：2012-04-05T05:09:46.350
> 
> 标签：c#, asp.net, gridview, dynamic

我对此很陌生，所以问这些问题..

如何使用 C# 在 Asp.net 中生成动态模板字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:15:56.707

您可以使用`DynamicallyTemplatedGridViewHandler`实现`ITemplate` 接口.....有关详细信息，请查看[here](http://aspalliance.com/1125_Dynamically_Templated_GridView_with_Edit_Delete_and_Insert_Options.all)

# android - Android：BATTERY_STATUS_DISCHARGING 和 BATTERY_STATUS_NOT_CHARGING 之间的区别

> ID：10022960
> 
> 赞同：11
> 
> 时间：2012-04-05T05:10:24.670
> 
> 标签：android

我想知道这两个标志之间的区别

```
BatteryManager.BATTERY_STATUS_DISCHARGING 
```

和

```
BatteryManager.BATTERY_STATUS_NOT_CHARGING 
```

我开发了一个使用这两个标志的应用程序，当我从充电器上拔下手机时，我希望看到“正在放电”，但它只是说“不充电”。

两者有什么区别 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T07:48:58.937

从 :[电池电量低。充电电流不够...在显示此消息之前是否有意图？](https://stackoverflow.com/questions/7404185/battery-is-low-charging-current-not-enough-is-there-intent-before-this-messag)

某些设备（平板电脑？）消耗的电量比通过 USB 端口提供的电量要多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-29T11:41:53.573

我无法在 Android API 或在线其他地方找到这两者的明确定义。

我最好的猜测是，这`BATTERY_STATUS_DISCHARGING`表明设备正在消耗电量，同时`BATTERY_STATUS_NOT_CHARGING`表明设备已插入但没有接收到足够的电量来实际充电——例如，如果它插入了低功耗 USB 端口。

但是，开发人员还有其他报告称某些设备永远不会返回`BATTERY_STATUS_DISCHARGING`，即使完全拔掉电源：[https ://groups.google.com/a/chromium.org/forum/#!topic/chromium-reviews/1AjyPYt0tQs](https://groups.google.com/a/chromium.org/forum/#!topic/chromium-reviews/1AjyPYt0tQs)

特别是 Nexus 7 2013 似乎有这个错误（个人经验证实）：[https](https://code.google.com/p/android/issues/detail?id=124768) ://code.google.com/p/android/issues/detail?id=124768 。

据推测，您遇到了类似的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-16T19:07:36.723

不充电的另一种选择只是电池已充满，因此无需充电或根本没有电池。

# android - 无法在 Android 服务中读取文件

> ID：10022963
> 
> 赞同：0
> 
> 时间：2012-04-05T05:10:41.243
> 
> 标签：android, media-player, ioexception

我想使用 APIDemo 的 MediaPlayer 在动态壁纸中播放视频 a.m4v。我使用了以下代码并且在 MediaPlayer 活动中工作正常。

```
 AssetFileDescriptor afd = getResources().openRawResourceFd(R.raw.a);
            mMediaPlayer.setDataSource(afd.getFileDescriptor(), afd.getStartOffset(), afd.getLength()); 
```

当我将代码放入 LivWallpaperService 时它失败了。我认为这是由于文件许可。

```
04-05 12:32:58.598: D/MediaPlayerDemo(5308): onPrepared called
04-05 12:32:58.598: V/MediaPlayerDemo(5308): startVideoPlayback
04-05 12:32:59.153: D/MediaPlayerDemo(5308): player starting
04-05 12:33:00.004: E/MediaPlayer(5308): error (1, -19)
04-05 12:33:00.004: E/MediaPlayer(5308): Error (1,-19) 
```

因此，我尝试将文件复制到临时文件中，但仍然出现错误。

```
 InputStream is = getResources().openRawResource(R.raw.a);

            File tempfile = File.createTempFile("mediaplayer", "temp",this.getCacheDir());
            String tempfilepath = tempfile.getAbsolutePath();
             FileOutputStream fo = new FileOutputStream(tempfile);
             BufferedOutputStream bis = new BufferedOutputStream(fo);

             int count = 0;
             byte buf[] = new byte[128];
             do {

              int numread = is.read(buf);
              count+=numread;
              if (numread <= 0)
               break;
              bis.write(buf, 0, numread);
             } while (true); 

             Log.d(TAG, "tempfile.length()"+tempfile.length());

             Log.d(TAG, is.toString());

             mMediaPlayer.setDataSource(tempfilepath)

04-05 12:46:36.981: E/MediaPlayerDemo(6000): error: null
04-05 12:46:36.981: E/MediaPlayerDemo(6000): java.lang.IllegalStateException
04-05 12:46:36.981: E/MediaPlayerDemo(6000):    at
android.media.MediaPlayer.setDataSource(Native Method) 
```

有人知道为什么我不能从 AssetFileDescriptor 中读取吗？

为什么我无法读取我在包中创建的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:17:41.723

Android`/asset`只能由应用程序本身访问，所以你不能。没有其他应用程序可以访问您应用程序的 /asset 目录中的资源。

因此，将其复制到`internal storage`或`external storage`使用它是个好主意。

只需检查`/temp`目录中的文件是否具有`WORLD_READABLE`权限。

```
FileOutputStream fos = openFileOutput(FILENAME, Context.MODE_WORLD_READABLE);
fos.write(string.getBytes());
fos.close(); 
```

# ios - 隐藏键盘时工具栏消失

> ID：10022966
> 
> 赞同：1
> 
> 时间：2012-04-05T05:10:54.697
> 
> 标签：ios, ios5, uinavigationcontroller, uitoolbar

我有一个带有工具栏的导航控制器。当键盘出现时，我使工具栏也出现在键盘顶部。当我关闭键盘时，工具栏消失，在屏幕底部留下一个黑色矩形，就在工具栏应该没有键盘的地方。

这是我初始化工具栏的方式：

```
- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];
    [self.navigationController setToolbarHidden:NO];

    // this makes sure the toolbar appears on top of the keyboard
    // instead of going below it.
    // _nameText is a UITextField
    _nameText.inputAccessoryView = self.navigationController.toolbar;
} 
```

这就是我隐藏键盘的方式：

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField {
    [textField resignFirstResponder];
    [self.navigationController setToolbarHidden:NO]; // this doesn't help
    return NO;
} 
```

我也尝试过`[self.view setNeedsLayout]`，但这没有用。

编辑：我怀疑这可能与我将工具栏指定为我的文本字段的输入附件视图这一事实有关。我认为当键盘消失时，文本字段会隐藏其附件视图。我仍然不知道如何覆盖这种行为。

编辑2：我发现那`self.navigationController.toolbar.superview`是`nil`在键盘消失之后。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T06:34:33.193

好的，所以虽然我无法正面解决问题，但我找到了一个可以接受的解决方法。

1.  为您的工具栏创建一个 .xib

2.  将 (1) 中的工具栏加载到对象中

3.  将该对象分配给`inputAccessoryView`您的文本字段的属性

4.  设置此工具栏中按钮的目标和操作，以便您可以响应点击

现在一切就绪。您的原始工具栏（可能是您在 Interface Builder 中创建的）仅在键盘隐藏时可见。当键盘可见时，无法看到原始工具栏，但您的另一个工具栏（使用上述步骤创建）现在出现在键盘上方。答对了！

如果有人对这个问题有更优雅的解决方案，我很高兴听到它:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T03:20:00.203

@BlackRider，我遇到了和你一样的问题。这很烦人。

我不想设置 2 个不同的工具栏作为解决方法，因为我不想在 2 个不同的地方处理工具栏按钮的状态。

我已经使用了使用通知的答案中讨论的方法：[iPhone：如何将 inputAccessoryView 修复为 View？](https://stackoverflow.com/questions/6784171/iphone-how-to-fix-inputaccessoryview-to-view)

它工作正常 - 我的直觉反应是在尝试各种设备尺寸/方向时会遇到问题。

# c++ - C++ 数组与指针

> ID：10022970
> 
> 赞同：0
> 
> 时间：2012-04-05T05:11:03.793
> 
> 标签：c++

在 C++ 中以下是有效的

```
 int *p = new int[3];
    *p=0;
    *(++p)=1; 
```

以下也是有效的

```
 int j[] = { 0, 1, 2};
    *j = 3; 
```

给定，*j =3 有效，为什么以下无效

```
 *(++j)=4;//invalid.. lvalue required as increment operand 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T06:17:47.123

在这样的表达中

```
*(++j)=4;//invalid.. lvalue required as increment operand 
```

`j`这是一个数组 int[3] “衰减”到指向该数组第一个元素的指针。该指针是一个右值，不能被赋值，因此你不能做类似`*(++j)`.

在您的另一个示例`p`中，是一个非常量且可以分配的指针：

```
 int *p = new int[3];
 *p=0;
 *(++p)=1; 
```

您使用右值获得的行为类似于使用 const 指针会发生的行为：

```
 int const *p = new int[3];
 *p=0;
 *(++p)=1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T05:15:12.940

数组和指针是相似的，但这是不同的地方。

如果要遍历数组，请使用单独的指针变量：

```
int j[] = { 0, 1, 2};    
int* jp = j; 
```

`jp`然后指向 的第一个元素`j`。然后：

```
*(++jp) = 4; 
```

将工作。

# iphone - 如何在 `UIScrollview` 中提供翻页效果？

> ID：10022973
> 
> 赞同：3
> 
> 时间：2012-04-05T05:11:52.037
> 
> 标签：iphone, objective-c, ipad

我正在开发我正在使用的应用程序，`UIScrollview`因为我需要使用翻页效果。

我怎样才能给页面翻转效果`UIScrollview`？

**注意**：在 UIScrollview 中，当我们更改页面时，向前和向后滚动页面。是否可以在我们滚动页面的时候赋予页面滚动效果？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T06:19:24.737

前空翻——

```
CATransition *animation = [CATransition animation];
[animation setDelegate:self];
[animation setDuration:1.0f];
animation.startProgress = 0;
animation.endProgress   = 1;
[animation setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut]];
animation.type = @"pageCurl";
animation.subtype=@"fromRight";
animation.fillMode = kCAFillModeForwards;

[animation setRemovedOnCompletion:NO];
[animation setFillMode: @"extended"];
[animation setRemovedOnCompletion: NO];
[lyr addAnimation:animation forKey:@"WebPageCurl"]; 
```

后空翻——

```
CATransition *animation = [CATransition animation];
[animation setDelegate:self];
[animation setDuration:1.5f];
animation.startProgress = 0;
animation.endProgress   = 1;
[animation setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut]];
animation.type = @"pageUnCurl";
animation.subtype=@"fromRight";
animation.fillMode = kCAFillModeBackwards;

[animation setRemovedOnCompletion:NO];
[animation setFillMode: @"extended"];
[animation setRemovedOnCompletion: NO];
[lyr addAnimation:animation forKey:@"WebPageCurl"]; 
```

您可以在 UIScrollView 委托时使用此代码。

# php - 强制打印到只有 1 页

> ID：10022978
> 
> 赞同：2
> 
> 时间：2012-04-05T05:12:19.710
> 
> 标签：php, javascript, html, css, printing

是否有可能的代码（php、java、css、html）会强制页面显示打印对话框，并且默认情况下只允许打印 X 的第 1 页，或者只是将打印对话框设置为那些设置？

我有一个页面正在通过条形码打印机打印出来，该打印机喜欢根据边距和其他愚蠢的东西打印大量空白页。我只需要第一页的内容，如果可能的话，打印对话框弹出框会更好！

关于什么代码类型和指导我的一些资源的任何想法都会很棒，谷歌并没有出现太多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T06:28:30.170

您可以通过触发[window.print](http://www.javascriptkit.com/howto/newtech2.shtml)事件来获取打印对话框。这只会打开浏览器的打印对话框，但是，除了在打开的对话框中设置内容之外，您无法控制实际的打印过程。

至于空白页打印，最好的办法是设置页面样式以避免这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T08:48:56.570

我不知道您的页面结构如何，div 块或表格的排列方式如何，但就我而言，我可以使用 CSS 轻松完成。

考虑你有一个*id="FAQ"的**div*并且这是你想要打印的唯一的东西，你可以这样做：

 *```
<style>
    @media print
        {
        body div, body table {display: none;}
        body div#FAQ, body div#FAQ table {display: block;}
        }
</style> 
```

这样我隐藏了除*div id="FAQ"*之外的所有内容。

我不相信这是最好的方法，因为我使用*@media print*来隐藏一些 div 以防止打印，例如说明或常见问题解答，而不是相反，但是，这是一种方法。

虽然，*bamba1*似乎有一个不错的答案。*

# javascript - 从鼠标滚轮事件中查找鼠标位置

> ID：10022979
> 
> 赞同：1
> 
> 时间：2012-04-05T05:12:41.073
> 
> 标签：javascript, jquery, events, javascript-events

相对于注册侦听器的元素的位置，在 javascript 事件处理程序中查找鼠标位置的正确方法是什么？我原以为这很容易，但无论如何我似乎无法让它跨浏览器工作。在 chrome 中我有`offsetX`并且`offsetY`正在工作，但这些属性在 Firefox 中不存在。

如果重要的话，我正在使用 jQuery 插件监听鼠标滚轮事件......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T06:19:04.657

你的意思是这样的：

```
 $(document).ready(function() {
    $('someElement').mousewheel(function(event, delta, deltaX, deltaY) {   
        var mousePosition = { x: event.pageX, y: event.pageY };        
    });
}); 
```

希望能帮助到你

# iphone - 上传到 iTunes 商店时出错

> ID：10022981
> 
> 赞同：9
> 
> 时间：2012-04-05T05:12:55.530
> 
> 标签：iphone, ios, push-notification, xcode4.3, itunes-store

使用 Xcode 4.3.2。

从昨天开始，我无法上传到 iTunes Store。我找不到任何理由。

存档-> 验证...没问题。

但是，分发时发生错误。

![在此处输入图像描述](../Images/e2f6f75fe035c6e1048c2db1dcff9d19.png)

我的应用程序正在使用推送。

我的 Xcode 版本是 4.3.2。

我该怎么做才能摆脱这种状态？

请帮助我...谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-05T06:58:10.543

我遇到了类似的问题..我可以使用此处提到的解决方案进行修复-[上传到 iTunes Store 时出错-请升级 Java](https://stackoverflow.com/questions/10011635/an-error-occurred-uploading-to-the-itunes-store-please-upgrade-java/10017638#comment12809592_10017638)

为了快速参考，我也在此处添加解决方案

打开终端窗口并执行以下代码行

```
cd /System/Library/Frameworks/JavaVM.framework/Versions
sudo ln -s CurrentJDK /System/Library/Frameworks/JavaVM.framework/Versions/1.5
sudo ln -s CurrentJDK /System/Library/Frameworks/JavaVM.framework/Versions/1.5.0 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-20T08:12:35.557

我升级到 java 1.7（2012 年 10 月）并应用了最新的 Apple 补丁 2012-006（如果我没记错的话）

好吧，它禁用了 Java 首选项（Oracle Java 首选项在 System Pref 中使用）并且 Utilities 文件夹中的 Java 首选项已被删除（由最新的 Apple 补丁），因为他们似乎希望你强迫你使用最新的 Java发布（考虑到安全问题，我可以理解）。

结果：我无法提交到应用商店，也无法重新启用它

XCode 在其核心功能中使用 Java，而 Java 中的一个问题使 Apple XCode 无法提交到 App Store ......我没有怀疑。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-10-21T12:12:53.877

好吧，我设法通过更新我的符号链接来解决这个问题。这是我所做的：

> cd /System/Library/Frameworks/JavaVM.framework/Versions
> 
> ls -l
> 
> 总共 72 个 lrwxr-xr-x 1 个根轮 10 Oct 18 16:41 1.4 -> CurrentJDK
> 
> lrwxr-xr-x 1 根轮 10 Oct 18 16:41 1.4.2 -> CurrentJDK
> 
> lrwxr-xr-x 1 根轮 10 Oct 18 16:41 1.5 -> CurrentJDK
> 
> lrwxr-xr-x 1 根轮 10 Oct 18 16:41 1.5.0 -> CurrentJDK
> 
> lrwxr-xr-x 1 根轮 10 Oct 18 16:41 1.6 -> CurrentJDK
> 
> lrwxr-xr-x 1 根轮 10 Oct 18 16:41 1.6.0 -> CurrentJDK
> 
> drwxr-xr-x 8 根轮 272 Oct 18 16:42 A
> 
> lrwxr-xr-x 1 根轮 10 Oct 18 17:18 Current -> A
> 
> lrwxr-xr-x 1 根轮 59 Oct 18 16:41 CurrentJDK -> /System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents
> 
> sudo mv 当前 Current.bak
> 
> sudo ln -s CurrentJDK 当前
> 
> java版本
> 
> java 版本“1.6.0_37”Java(TM) SE 运行时环境（构建 1.6.0_37-b06-434-11M3909）Java HotSpot(TM) 64 位服务器 VM（构建 20.12-b01-434，混合模式）

这会将“Current”符号链接更改为指向“CurrentJDK”指向的相同版本。这在您的系统上可能相同也可能不同，因此请仔细检查。这可能会或可能不会导致其他问题，但到目前为止我还没有看到任何问题。

要撤消更改，只需返回同一目录并：

> sudo rm 当前
> 
> sudo mv Current.bak 当前

希望这可以帮助！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-09T20:39:24.633

尝试使用“Apple 符号”中的“软件更新...”也可以

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-08T09:06:24.330

如果 Xcode 在控制台中给你以下错误

> 错误：需要 Java 1.5、1.6 或 1.7。目前，java 是默认的 java 版本。请升级。

检查是否有软件更新。就我而言，有一个：Java for OSX 2012-002

> Java for OS X 2012-002 通过将 Java SE 6 更新到 1.6.0_31 提供了改进的兼容性、安全性和可靠性。
> 
> 请在安装此更新之前退出所有 Web 浏览器和 Java 应用程序。
> 
> 有关此更新的更多详细信息，请参阅[http://support.apple.com/kb/HT5055](http://support.apple.com/kb/HT5055)。
> 
> 有关此更新的安全内容的信息，请参阅[http://support.apple.com/kb/HT1222 。](http://support.apple.com/kb/HT1222)

更新后，我可以毫无错误地提交我的应用程序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-06T00:02:16.557

这是最后一个 java 版本的问题，终端写入的解决方法：

```
sudo ln -s CurrentJDK /System/Library/Frameworks/JavaVM.framework/Versions/1.5
sudo ln -s CurrentJDK /System/Library/Frameworks/JavaVM.framework/Versions/1.5.0 
```

然后就可以正常上传了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-30T01:53:21.170

这并没有解决我的问题。我遇到了这个问题，因为我安装了 Oracle Java 1.7 并将其设置为默认值。禁用它并使用 Apple Java，这个问题就消失了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-07T15:10:33.740

Oracle Java 1.7 再次破坏了 Xcode 应用程序上传器！！我将此作为 ADC 上的错误提交，并因此得到承认。

我能够解决两种方法：

1.  卸载 Java 1.7 并回退到 Apple Java 1.6.34 或 35 工作。
2.  暂时关闭 Java 1.7。转到：应用程序 > 实用程序 > Java 首选项并取消选中 java 1.7。之后，上传者工作。如果您需要 1.7，您可以在上传后重新打开它。

# android - OpenFeint Android：无法初始化 OF 样本。屏幕上出现“假动作需要有效的网络连接”

> ID：10022982
> 
> 赞同：0
> 
> 时间：2012-04-05T05:13:46.287
> 
> 标签：android, openfeint

我正在尝试在 Android 2.2 上运行 openfeint android 示例以验证其功能。我确定我已正确输入产品密钥等。我有两个问题：

1>消息出现在底部“假装需要一个有效的网络连接”。（我确定我的互联网连接很好）

2>有时openfeint加载页面出现并自动消失而不显示请求用户许可的页面。（这种情况经常发生）

请建议我如何解决上述问题。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:29:45.457

- 您显然需要一个有效的互联网连接，并且清单中的以下权限：

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

-那很有意思。你想什么时候连接到 OpenFeint？我强烈建议您在加载等主菜单后调用它。但如果没有进一步的信息，很难找到。

# java - 类定义中的有界通配符不起作用？

> ID：10022983
> 
> 赞同：2
> 
> 时间：2012-04-05T05:14:04.283
> 
> 标签：java

我正在尝试进行以下工作：

```
import java.io.Serializable;
public abstract class Thing implements Iterable<? extends Serializable> {} 
```

但我编译并得到以下错误：

```
Thing.java:2: unexpected type
found   : ? extends java.io.Serializable
required: class or interface without bounds
public abstract class Thing extends Iterable<? extends Serializable> {} 
```

我不确定为什么这里有歧义？编译器不应该知道我的意图吗？如果可能的话，我希望能够获得这个确切的功能，并理解为什么这不起作用。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T05:45:36.070

我假设您的意图是具有以下内容：

```
public class FooBar implements Iterable<? extends Serializable> {
    public Iterator<? extends Serializable> iterator() {
        return new Itr();
    }
} 
```

但是，这在功能上等同于将泛型参数设为 just `Serializable`。在 an 上调用该`next`方法会`Iterator<? extends Serializable>`返回一个`Serializable`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T05:18:04.140

java.lang.Iterable 类定义

```
Iterable<T> 
```

所以它总是期望任何**类**或**接口**分配给通用参数**T**

但是您传递了一个导致错误的绑定类型参数。

# node.js - Nodejs node-sqlite3运行回调不起作用

> ID：10022984
> 
> 赞同：4
> 
> 时间：2012-04-05T05:14:16.777
> 
> 标签：node.js, sqlite

我正在尝试使用`nodejs`和`node-sqlite3`包执行删除 sqlite db 中的一行。

当我运行删除命令并手动检查条目时，我可以看到查询成功删除了该行，但我似乎无法编写确认这一点的代码。

这是查询

```
db.run("DELETE FROM Table1 WHERE id=? AND username=?", [id, user], function(error) {
console.log(error);
}); 
```

无论输入错误或正确，它都会输出`null`到控制台。如果给出了正确的详细信息，它将删除它并打印 null，如果给出了错误的 id 和用户，它仍然打印 null。

关于什么可能是错的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T14:20:40.573

这里的 node 和 node-sqlite3 行为没有任何问题。这里有两个部分首先解释节点和其他关于 Sqlite 的部分。

**`Node`**

您的回调在执行语句后被调用。所以这里没有错，因为你的回调被调用了（正如'null'作为输出所证明的那样）。

**`Sqlite`**

如果子句中给出的条件评估为真，则 Sqlite 中的删除查询将删除`where`，否则不会删除任何内容。

参考[node-sqlite3 文档的 Database#run api](https://github.com/developmentseed/node-sqlite3/wiki/API)：

> 回调（可选）：如果给定，它将在语句准备或执行的任何步骤发生错误时以及在运行查询之后调用。如果发生错误，第一个（也是唯一的）参数将是包含错误消息的错误对象。如果执行成功，第一个参数为空。

因此，在您的情况下，查询执行成功，没有任何错误，导致`error`回调函数的参数，`null`如您在输出中看到的那样。

此外，如果要检查是否实际删除了任何行，可以使用`changes`文档中提到的属性：

> 如果执行成功，它包含两个名为“lastID”和“changes”的属性，分别包含最后插入的行 ID 的值和受此查询影响的行数。请注意，“lastID”仅在查询是成功完成的 INSERT 语句时包含有效信息，而“changes”仅在查询是成功完成的 UPDATE 或 DELETE 语句时包含有效信息。在所有其他情况下，这些属性的内容是不准确的，不应使用。.run() 函数是设置这两个值的唯一查询方法；所有其他查询方法，例如 .all() 或 .get() 都不会检索这些值。

希望能帮助到你...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-03T15:28:09.393

对于我之前的问题，问题是我使用*胖箭头*进行回调声明。从 javascript 文档中，我发现在*箭头函数*（胖箭头）中，*this*具有*词法范围*，因此该结果未定义，并且不像库文档中所说的那样被重视。使用其他匿名函数， this 在*动态范围内*有界，因此**this.changes**被重视。

现在，使用如下代码，就可以了：

```
var sql = 'update recipes set stars = stars + 1 where id = ?';

db.run(sql,
    [
    1 // id = 1 execute update - if id = 11111 do nothing
    ], function(err) {
        if(err)
            throw err;

        console.log("VALUE CHANGES: " + this.changes + " - " + util.inspect(this, { showHidden: false, depth: null }));

        if(this.changes == 1)
            console.log("WORK DONE");
        else
            console.log("NOTHING DONE");

    }); 
```

这里有更多解释：[https ://github.com/mapbox/node-sqlite3/issues/606](https://github.com/mapbox/node-sqlite3/issues/606)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-19T20:39:50.073

我有类似的问题，回调只是不会触发。时期。问题是我在其他地方调用了 process.exit(1)，所以我的代码在回调有机会返回之前就退出了。

搜索 process.exit，这可能（或可能不会）为您节省数小时的调试和责备 sqlite :)

题外话：让我心烦意乱的是为什么他们在 lastID 中全大写 ID。它不像 SQL 或 USA 那样的缩写。它代表识别，这是一个词。

# c# - 在c#中使用HttpWebRequest发送base64字符串将“+”转换为空格问题

> ID：10022985
> 
> 赞同：4
> 
> 时间：2012-04-05T05:14:24.173
> 
> 标签：c#

我将图像转换为base64字符串以通过c#中的HttpWebRequest上传。当我收到base64字符串时，“+”符号已转换为空格“”。将此base64字符串转换为字节数组时出错。我不想在服务器端（在Web服务中）进行任何更改。我想在客户端解决这个问题。我的客户端代码如下。

/////////////////

WSManagerResult wsResult = new WSManagerResult();

```
 try
        {
            HttpWebRequest req = (HttpWebRequest)HttpWebRequest.Create(serviceURL);
            req.Method = "POST";
            req.ProtocolVersion = HttpVersion.Version11;
            req.ContentType = "application/x-www-form-urlencoded";
            //  req.ContentType = "application/x-www-form-urlencoded; charset=utf-8";
            // req.CookieContainer = new CookieContainer();

            string content = string.Empty;
            foreach (KeyValuePair<string, string> entry in paramDic)
            { 
```

// entry.Value 是一个基于图像的 64 位字符串基因

```
 content = content + entry.Key + "=" + entry.Value + "&&";
            }
            content = content.TrimEnd('&'); // input parameter if u have more that one //a=b&dd=aa               
            req.ContentLength = content.Length;
            // req = URLEncode(content);
            Stream wri = req.GetRequestStream();

            byte[] array = Encoding.ASCII.GetBytes(content);
            if (array.Length > 0)
                wri.Write(array, 0, array.Length);
            wri.Flush();
            wri.Close();
            WebResponse rsp = (HttpWebResponse)req.GetResponse();

            byte[] b = null;
            using (Stream stream = rsp.GetResponseStream())
            using (MemoryStream ms = new MemoryStream())
            {
                int count = 0;
                do
                {
                    byte[] buf = new byte[1024];
                    count = stream.Read(buf, 0, 1024);
                    ms.Write(buf, 0, count);
                } while (stream.CanRead && count > 0);
                b = ms.ToArray();
            }
            wsResult.result = Encoding.ASCII.GetString(b);
        }
        catch (Exception e)
        {
            clsException.ExceptionInstance.HandleException(e);
            wsResult.error = e.Message;
        }

        return wsResult; 
```

上面 base64 字符串中的所有“+”符号都转换为“”空格。这会导致上述问题。

请帮我解决这个问题。

问候

沙阿哈立德

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T06:56:28.557

非常感谢 Rob.it 通过在客户端将 '+' 替换为十六进制 '%2B' 以通过wire.as 在c# 中发布数据来解决我的问题。

```
/*Using standard Base64 in URL requires encoding of '+', '/' and '=' characters into special percent-encoded hexadecimal sequences ('+' = '%2B', '/' = '%2F' and '=' = '%3D')*/ 

String stbase64datatopost =stbase64datatopost.Replace("+",@"%2B"); 
stbase64datatopost = stbase64datatopost .Replace("/",@"%2F");      
stbase64datatopost=stbase64datatopost.Replace("=",@"%3D"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T05:30:34.643

有一种称为[Base64Url 编码](http://en.wikipedia.org/wiki/Base64#RFC_4648)的编码就是为此而设计的。但是，您可能必须在各自的末端进行编码/解码。

在 Base64 Url 中，它转换`+`为`-`和`/`，`_`以便它可以安全地通过网络传递，而无需标准 URL 编码器添加奇怪的空格或百分比十六进制

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T06:15:06.710

尝试将您的 base64 编码数据发布到 Web 服务`HttpUtility.UrlEncode(entry)`

Web 服务应该能够在不更改代码的情况下解析它

# php - 为本地 PHP 应用程序实施试用期

> ID：10022990
> 
> 赞同：1
> 
> 时间：2012-04-05T05:14:47.297
> 
> 标签：php, localhost, trial

我最近完成了我的 PHP 应用程序，我想知道是否有可能有某种试用期。因此，当达到该时间段时，屏幕上会出现错误。

感谢您的时间和答案。我最欣赏他们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T05:18:19.483

您可以使用 Zend Encoder 或 Ioncube 加密您的源，或对其进行混淆处理。

但事实是，上面的所有内容都可以修补。因此，如果目标用户有足够的经验 - 他们可以删除您的试用期检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-18T16:29:01.377

是的，你可以：当前段时间出现需要时，我也做了同样的事情。它很简单，你可以改进它。遵循这个算法；

1.  获取今天的日期
2.  设置试用期
3.  将试用期添加到今天（作为开始日期）以获取到期日期
4.  检查上面的代码是否已经执行过
    如果没有，则将 startdate 和 `expierydate` 发送到 mysql 中的表中
    Else 获取开始日期并与今天比较
    如果它匹配 displ

这是代码。

```
function timebomb(){
  $today = date("d-M-Y",time());
  $trialPeriod = 1;
  $startDate = date("d-M-Y", time());
  $getExpiryDate = strtotime('+'.$trialPeriod."days", strtotime($startDate));
  $expiryDate = date("d-M-Y", $getExpiryDate);
  $checkStatus = mysql_num_rows(mysql_query("SELECT * FROM timebomb"));
    if($checkStatus == 0){
    mysql_query("INSERT INTO timebomb(StartDate,ExpiryDate) values   
         ('$startDate','$expiryDate')") or die(mysql_error());
   }else{
   $getPeriod = mysql_query("SELECT * FROM timebomb");
    WHILE($period = mysql_fetch_object($getPeriod)){
    $endOfTrial = $period->ExpiryDate;
    }
    IF($endOfTrial == $today){`enter code here`
    echo 

    <center><font size='5' color='red'>
 PLEASE YOUR TRIAL PERIOD IS OVER. 
 IF YOU ENJOYED USING THIS PRODUCT, <br/>
 CONTACT ALBERT (0205173224) FOR THE FULL VERSION. 
  THANK YOU."

;
    exit();
            }

        }

    }
timebomb(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T06:15:01.673

一种解决方案是使用应用程序的某种已编译（或字节编译）形式而不是源文件。结帐此链接。 [http://php.net/manual/en/book.bcompiler.php](http://php.net/manual/en/book.bcompiler.php) , [http://www.phpcompiler.org](http://www.phpcompiler.org)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-06T10:32:07.953

**按照以下步骤在 php 项目中获得完全安全的试用期...**

**1** . 在您的数据库中为试用期创建一个表

```
ex. trial(id,reg_date,days_of_trial). 
```

**2** . 在您的索引页面或登录页面中，添加代码逻辑如下

```
i.get 'reg_date','days_of_trial' from 'trial' table.<br/>
   ii.get today's date.<br/>
   iii.calculate difference using as $dDiff= date_diff($reg_date,$today); <br/>
   iv.now compare difference with 'days_of_trial'.<br/><br/>
      ex. <br/>
          if($dDiff->days>=$row['days_of_trial'])<br/>
            {    <br/>
                 v.update trial table set days_of_trial=0.<br/><br/>
                 //redirect to expired page..<br/><br/>
              ex.
              header("Location:http://localhost/project_dir/expired/index.php");}. 
```

**3** . 在 expired/index.php 文件中删除您的项目主目录为..`<br/><br/>`

```
 ex.
<br/>
          if(file_exists("../folder1"))<br/>
          rmdir("../folder1");  
   redirect to expired page wherein you can display "Trial expired  message"<br/>
    ex.
<br/>
           header("Location: http://localhost/proj_dir/expired/expired.html");<br/><br/> 
```

**4** . 现在替换您的原始主页代码以重定向到过期页面..

```
ex.
    $file = fopen("../index.php","w");<br/>
fwrite($file,"<?php header('Location: http://localhost/proj_dir/expired/');?>");<br/>
fclose($file);<br/> 
```

*   不要忘记备份项目目录和数据库..
*   您的 php 项目在试用期是完全安全的.....

# dynamic - 弹体碰撞缺少接触监听器

> ID：10022992
> 
> 赞同：0
> 
> 时间：2012-04-05T05:15:00.307
> 
> 标签：dynamic, listener, box2d, collision, bullet

我正在开发一个游戏，我们的玩家在点击时触发。有时在子弹体与其他动态体碰撞期间不会接触到侦听器，因此子弹体会保留在屏幕上并且不会被移除。

使用 box2d 接触侦听器，我正在检测动态和静态主体之间的碰撞。

静态物体不会出现问题，但动态物体碰撞会出现问题，并且子弹体没有接触到侦听器。

# cmake - CMake：构建跨平台分发

> ID：10022993
> 
> 赞同：2
> 
> 时间：2012-04-05T05:15:02.050
> 
> 标签：cmake, package, software-distribution

在我的 MacOSX 上，我开发了一个使用 Qt 和 VTK 库的应用程序。我使用 CMake 生成 makefile。

现在我想在 Windows 上编译一个最终用户自包含的包，它应该可以在最终用户机器上工作，而不需要预先安装 Qt 或 VTK 库。我认为可以通过修改 CMakeLists.txt 文件来做到这一点，但网络搜索并没有为我指明正确的方向。

如何使用 CMake 为 Windows 制作可分发的包？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T08:21:37.533

我在自己的一个项目中所做的是编写一个小脚本，它将为我提供来自 VTK 的 cmake-variables 和 QT_LIBRARIES 变量的 .so 文件或 .dll 文件。

之后，我将这些 .dll 或 .so 文件添加到我的安装目标（下面的示例脚本），安装目标会将这些 .dll 或 .so 文件从 VTK_DIR 或 QTDIR 复制到 ${CMAKE_INSTALL_PREFIX}\bin。这与 CPack 兼容，因此您也可以编写一个小 cpack-script。

但是请注意，您需要在 Windows 上多一点才能获得*最终用户自包含的包*：您还需要“系统库”（msvcrt.dll、msvcrp.dll 或 mingwm10.dll、libstdc++.dll） . 例如看看[这个问题](https://stackoverflow.com/questions/5970845/cmake-how-to-determine-all-the-dll-so-files-that-are-need-for-an-executable)。

在 Windows 上，以下脚本从 VTK_DIR 中查找**所有**Vtk dll。

```
file( GLOB VTK_DLLS ${VTK_RUNTIME_LIBRARY_DIRS}/*.dll )
if( VTK_DLLS )
    foreach( Vtk_library ${VTK_DLLS} )
        # Add it to the list of 'desired' vtk-libraries for later installation
        list( APPEND Vtk_Install_Libraries ${Vtk_library} )
    endforeach( Vtk_library ${VTK_DLLS} )
    list( REMOVE_DUPLICATES Vtk_Install_Libraries )
    install( FILES ${Vtk_Install_Libraries} DESTINATION bin COMPONENT ThirdParty  )
endif( VTK_DLLS ) 
```

对于 Qt，脚本要长一些，因为我需要同时找到调试库和发布库。好的一面：它只搜索我请求的那些组件`find_package( Qt4 ... )`

```
# If Qt-4 was used, add the 'found' Qt-libraries to the Install-target.
if ( USE_QT )
    foreach( Qt_library ${QT_LIBRARIES} )
        # With QT_USE_IMPORTED_TARGETS, we should extract the dll info 
        # from the target properties
        get_target_property( Qt_lib_name ${Qt_library} IMPORTED_LOCATION )
        get_target_property( Qt_lib_name_debug ${Qt_library} IMPORTED_LOCATION_DEBUG )
        get_target_property( Qt_lib_name_release ${Qt_library} IMPORTED_LOCATION_RELEASE )

        # Initially assume the release dlls should be installed, but 
        # fall back to debug if necessary
        if ( Qt_lib_name_release AND EXISTS ${Qt_lib_name_release} )
            set( Qt_library_location ${Qt_lib_name_release} )
        elseif ( Qt_lib_name_debug AND EXISTS ${Qt_lib_name_debug} AND ENVIRONMENT_DEBUG )
            set( Qt_library_location ${Qt_lib_name_debug} )
        elseif ( Qt_lib_name AND EXISTS ${Qt_lib_name} )
            set( Qt_library_location ${Qt_lib_name} )
        endif ( Qt_lib_name_release AND EXISTS ${Qt_lib_name_release} )

        # Extract the filename part, without the lib-prefix or the .a or ..lib suffix
        get_filename_component( Qt_library_name ${Qt_library_location} NAME_WE )
        string( REGEX REPLACE "^lib(.*)" "\\1" Qt_library_name ${Qt_library_name} )

        set( Qt_shared_library ${QT_BINARY_DIR}/${Qt_library_name}.dll )
        if ( EXISTS ${Qt_shared_library} )
            # Add it to the list of 'desired' qt-libraries for later installation
            list( APPEND Qt_Install_Libraries ${Qt_shared_library} )
        else ( EXISTS ${Qt_shared_library} )
            message( WARNING "    could not find ${Qt_shared_library}" )
        endif ( EXISTS ${Qt_shared_library} )
    endforeach( Qt_library ${QT_LIBRARIES} )
    # When building against a static Qt, the list of Qt_Install_Libraries can be empty
    if ( Qt_Install_Libraries )
        list( REMOVE_DUPLICATES Qt_Install_Libraries )
        install( FILES ${Qt_Install_Libraries} DESTINATION bin COMPONENT ThirdParty )
    endif ( Qt_Install_Libraries )
endif ( USE_QT ) 
```