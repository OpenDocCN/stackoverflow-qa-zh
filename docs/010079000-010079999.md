# StackOverflow 问答 10079000-10079999

# c# - A* 算法 System.StackOverflowException

> ID：10079000
> 
> 赞同：4
> 
> 时间：2012-04-09T19:57:58.430
> 
> 标签：c#, a-star

```
public List<Location2D> Path(Location2D start, Location2D goal)
{
    openset = new List<NodeInfo>(); // The set of tentative nodes to be evaluated, initially containing the start node.
    closedset = new List<NodeInfo>(); // The set of nodes already evaluated.
    path = new List<Location2D>(); // The path result.
    came_from = new Dictionary<Location2D, Location2D>();

    NodeInfo Start = new NodeInfo();
    Start.SetLoction(start.X, start.Y);
    Start.H = GetHValue(start, goal);
    openset.Add(Start);

    while (openset.Count > 0) { // while openset is not empty
        NodeInfo current = CheckBestNode(); //the node in openset having the lowest f_score[] value

        if (current.Location.Equals(goal)) {
            ReconstructPathRecursive(current.Location);
            return path;
        }

        for (int i = 0; i < 8; i++) { // neighbor nodes.
            NodeInfo neighbor = new NodeInfo();
            neighbor.SetLoction((ushort)(current.Location.X + ArrayX[i]), (ushort)(current.Location.Y + ArrayY[i]));

            bool tentative_is_better = false;

            if (closedset.Contains(neighbor))
                continue;
            if (!map.Cells[neighbor.Location.X, neighbor.Location.Y].Walkable) { closedset.Add(neighbor); continue; }

            Double tentative_g_score = current.G + DistanceBetween(current.Location, neighbor.Location);

            if (!openset.Contains(neighbor)) {
                openset.Add(neighbor);
                neighbor.H = GetHValue(neighbor.Location, goal);
                tentative_is_better = true;
            } else if (tentative_g_score < neighbor.G) {
                tentative_is_better = true;
            } else {
                tentative_is_better = false;
            }

            if (tentative_is_better) {
                came_from[neighbor.Location] = current.Location;
                neighbor.G = tentative_g_score;
            }
        }
    }
    return null;
}

private void ReconstructPathRecursive(Location2D current_node)
{
    Location2D temp;
    if (came_from.TryGetValue(current_node, out temp)) {
        path.Add(temp);
        ReconstructPathRecursive(temp);
    } else {
        path.Add(current_node);
    }
} 
```

实现 A* 算法也是如此，当它找到目标时，它会转到 `ReconstructPathRecursive` 应用程序崩溃并抛出此异常`An unhandled exception of type 'System.StackOverflowException' occurred in mscorlib.dll`

和`This thread is stopped with only external code frames on the call stack. External code frames are typically from framework code but can also include other optimized modules which are loaded in the target process.`

idk怎么了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:06:37.900

它实际上不必是递归的，因为它是尾递归的。所以你可以像这样重写它：

```
private void ReconstructPathIterative(Location2D current_node)
{
    Location2D temp;
    while (came_from.TryGetValue(current_node, out temp))
    {
        path.Add(temp);
        current_node = temp;
    }
    path.Add(current_node);
} 
```

这仅在路径太长而无法放入堆栈时才有帮助，如果它是无限的，则无济于事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T10:32:30.090

`NodeInfo Parent {get; set; }`我通过在类中添加一个文件来修复它，并在暂定更好时`NodeInfo`添加新的`List<NodeInfo>`调用：-`Nodes`

```
if (tentative_is_better) {
                        neighbor.Parent = current;
                        nodes.Add(neighbor);
                        neighbor.G = tentative_g_score;
                    } 
```

然后当它找到目标时：-

```
if (current.Location.Equals(goal)){
                    ReconstructPath(current);
                    path.Reverse();
                    return path;
                } 
```

哪里`ReconstructPath`： -

```
private void ReconstructPath(NodeInfo current) {
            if (current.Parent == null) return;
            path.Add(current.Parent.Location);
            ReconstructPath(current.Parent);
        } 
```

现在工作正常。

# xml - 来自 XML 的 Google Maps V3 地理编码

> ID：10079002
> 
> 赞同：1
> 
> 时间：2012-04-09T19:58:15.933
> 
> 标签：xml, google-maps, geocode

我正在尝试从 Google Maps 中获取此示例，并使用地址而不是 lat/long 来放置 XML 文档中的标记：

[http://gmaps-samples-v3.googlecode.com/svn/trunk/xmlparsing/jqueryget.html](http://gmaps-samples-v3.googlecode.com/svn/trunk/xmlparsing/jqueryget.html)

有没有人有任何指示？您是否使用 Google 地图显示使用地址的记录并提供示例？我已经用尽了所有我知道要看的地方。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:08:29.937

[http://www.geocodezip.com/v3_MW_example_map3.html](http://www.geocodezip.com/v3_MW_example_map3.html)

我会发布的不仅仅是一个网址——但在不知道问题是什么的情况下，很难具体说明。如果您编辑您的问题以包含失败的代码（或指向您的页面的链接），则应该可以准确地说出出了什么问题。

# jakarta-ee - 在 Springmvc 中使用 Webapplicationinitializer 注入调度程序 servlet

> ID：10079003
> 
> 赞同：1
> 
> 时间：2012-04-09T19:58:21.340
> 
> 标签：jakarta-ee, servlets, spring-mvc

我必须动态加载调度程序 servlet 及其配置文件。我正在研究使用 webapplicationinitializer 注入调度程序 servlet 的概念，这是春季的一项最新发展。以下文档给出了概述： [http ://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/WebApplicationInitializer.html](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/WebApplicationInitializer.html)

我正在尝试进行基本设置，但它不起作用。我无法理解从哪里开始摆脱传统的弹簧开发。谁能举例说明如何使用这种新机制？我使用了以下代码：

```
 public class MyWebAppInitializer implements WebApplicationInitializer {

@Override
public void onStartup(ServletContext container) {
  // Create the 'root' Spring application context
  AnnotationConfigWebApplicationContext rootContext =
    new AnnotationConfigWebApplicationContext();
  rootContext.register(AppConfig.class);

  // Manage the lifecycle of the root application context
  container.addListener(new ContextLoaderListener(rootContext));

  // Create the dispatcher servlet's Spring application context
  AnnotationConfigWebApplicationContext dispatcherContext =
    new AnnotationConfigWebApplicationContext();
  dispatcherContext.register(DispatcherConfig.class);

  // Register and map the dispatcher servlet
  ServletRegistration.Dynamic dispatcher =
    container.addServlet("dispatcher", new DispatcherServlet(dispatcherContext));
  dispatcher.setLoadOnStartup(1);
  dispatcher.addMapping("/");
} 
```

}

此外，如果我们动态注入调度程序 servlet，是否意味着调度程序 servlet 在 Web 容器（tomcat）启动期间加载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T16:37:26.317

尝试将您的映射从 更改`/`为`dispatcher.addMapping("/*")`。

`/`已经映射到 Tomcat 的默认 Servlet，所以`addMapping("/")`不会做任何事情。

这仅适用于您使用的 Tomcat 版本 <= 14。

在 Tomcat 启动时，tomcat 会寻找一个`implements ServletContainerInitializer`. 在 Spring 中，它会找到 class `SpringServletContainerInitializer`。这个类将被提供一组 Tomcat 加载的类（基本上是你的所有类）。然后它将寻找其中任何一个`implements WebApplicationInitializer`并调用`onStartup()`它们。这就是您在上面发布的方法发挥作用的地方，初始化上下文和 Spring 的 `DispatcherServlet.

# forms - Joomla 2.5 - 组件开发 - 使用表单

> ID：10079006
> 
> 赞同：2
> 
> 时间：2012-04-09T19:58:26.313
> 
> 标签：forms, joomla, components, save

我正在尝试向我的组件添加一些表单，但我不确定必须应用哪些命名约定才能使其正常工作。

目前我有一个工作表单 - 它显示存储在 XML 文件中的字段并将数据从数据库加载到它。但是，当我尝试提交此表单（编辑或添加新记录）时，它不起作用。按下提交（保存（）方法）后，它只是重定向我并显示该记录已成功编辑，但事实并非如此。当我尝试编辑现有记录时，按下提交后没有任何反应，当我尝试添加新记录时，它只会添加空/空白记录。

所以我做了一点调试，发现问题出在 JController::checkEditId() 方法中。它总是返回 false，这意味着 JControllerForm::save() 也返回 false，这就是它不能正确保存它的原因。表单的 HTML 代码是正确的，我可以使用全局数组 $_POST 访问数据。

我怀疑这个问题是因为 JModelAdmin 类的 loadFormData、getForm 方法中的命名约定。我不知道如何命名该表格。

所以这是我与这个问题相关的代码：

**用于显示表单的子控制器 - controllers/slideshowform.php**

```
class SlideshowModelSlideshowForm extends JModelAdmin{

public function getForm($data = array(), $loadData = true){
    return $this->loadForm('com_slideshow.slideshowform', 'editform', array('load_data' => $loadData, 'control' => 'jform'));
}

protected function loadFormData(){  
        $data = JFactory::getApplication()->getUserState('com_slideshow.edit.slideshowform.data', array());
        if (empty($data)) 
        {
            $data = $this->getItem();
        }
        return $data;
}

public function getTable($table = "biometricslideshow"){
    return parent::getTable($table);
}

} 
```

**视图/slideshowform/view.html.php**

```
class SlideshowViewSlideshowForm extends JView{

public function display($tmpl = null){
        if (count($errors = $this->get('Errors'))) 
        {
            JError::raiseError(500, implode('<br />', $errors));
            return false;
        }
    $this->form = $this->get('form');
    $this->item = $this->get('item');
    JToolBarHelper::save('slideshowform.save');
    parent::display();
}

} 
```

**视图/slideshowform/tmpl/default.php**

```
<?php
defined('_JEXEC') or die('Restricted access');
JHtml::_('behavior.tooltip');

?>

<form method="post" action="<?php echo JRoute::_("index.php?option=com_slideshow&id=".(int) $this->item->id)?>" name="adminForm" id="slideshow-form">
  <fieldset class="adminform">
    <legend>Edit slide</legend>
    <table>
      <input type="hidden" name="task" value="">
      <?php echo JHtml::_('form.token'); ?>

      <?php

      foreach($this->form->getFieldset() as $field){
      ?>
      <tr><td><?php echo $field->label ?></td><td><?php echo $field->input ?></td></tr>

      <?php
      }
      ?>

    </table>
  </fieldset>
</form> 
```

有人可以看看吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T05:48:51.993

您必须添加控制器`SlideshowControllerSlideshowForm`和代码`save`方法。在那里，您必须验证表单数据并调用`SlideshowModelSlideshowForm->save`事件，然后使用成功/失败消息重定向。

# drupal - 无法在 Drupal 7 中提取字段值。这是一个错误吗？

> ID：10079008
> 
> 赞同：1
> 
> 时间：2012-04-09T19:58:27.693
> 
> 标签：drupal, drupal-7, drupal-views, drupal-modules

全球$用户；

```
$items = field_get_items('user', $user, 'field_patientid', $user->language); 
```

我在用户实体上有一个字段，并且在调试中总是得到 FALSE 值。

在我的数据库中，我有正确的实体类型，即用户。为什么我没有得到任何值？

我可以使用以下方法提升价值：

```
$user_fields->field_patientid['und']['0']['value']; 
```

为什么上面提到的语句不起作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:32:20.807

如果您查看 的代码[`field_get_items()`](http://api.drupal.org/api/drupal/modules!field!field.module/function/field_get_items/7)，您会注意到您要查找的字段信息需要已经存在于`$user`对象中才能由函数返回。

但`global $user`不提供现场数据。

来自[http://api.drupal.org/api/drupal/developer%21globals.php/global/user/7#comment-13744](http://api.drupal.org/api/drupal/developer%21globals.php/global/user/7#comment-13744)

> 全局用户对象包含来自 Drupal 核心的一些基本数据。它不会自动包含来自其他模块的数据，包括核心配置文件模块。要获取用户对象中的所有数据，您需要执行完整的[user_load()](http://api.drupal.org/api/drupal/modules!user!user.module/function/user_load/7)。

# qt - QPixmap 和 SVG

> ID：10079011
> 
> 赞同：7
> 
> 时间：2012-04-09T19:58:34.020
> 
> 标签：qt, svg, qpixmap

您建议如何使用 QPixmap 处理 svg？

`QPixmap(":/myfile.svg");`然后调用的构造`scaled()`不起作用。QPixmap 被像素化。

谢谢。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2016-04-29T10:42:00.917

现在有更简单的方法而不需要 SVG 模块

```
QIcon("filepath.svg").pixmap(QSize()) 
```

如此简单并且工作正常。至少在我的情况下它起作用了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-09T20:12:27.983

您应该使用[SVGRenderer](http://qt-project.org/doc/qt-4.8/qsvgrenderer.html)将其渲染到`QImage`. 从那里您可以转换为`QPixmap`with `QPixmap::convertFromImage`。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-07-30T06:22:16.083

像这样的东西：

```
QSvgRenderer renderer(svg_file_name);
QPixmap pm(width, height);
pm.fill(fill_color);
QPainter painter(&pm);
renderer.render(&painter, pm.rect()); 
```

# sql - 我需要一个 sql 查询按名称分组，但根据最新条目返回其他字段

> ID：10079013
> 
> 赞同：1
> 
> 时间：2012-04-09T19:58:37.380
> 
> 标签：sql, sql-server-2008, tsql

我正在查询一个名为 PhoneCallNotes 的表。每次通话都会记录来电者的 FirstName、LastName 和 DOB 以及许多其他字段，包括通话的唯一 ID (PhoneNoteID)，但没有来电者的唯一 ID。我的要求是从他们最近的条目中返回一个删除重复的呼叫者列表以及 PhoneNoteID 等。我可以使用名称、DOB 和 Max(CreatedOn) 上的 Group By 来获取我想要的用户列表，但是如何包含 uniqueID（结果中的最新条目？）

```
select  O.CallerFName,O.CallerLName,O.CallerDOB,Max(O.CreatedOn)
from [dbo].[PhoneCallNotes] as O
where O.CallerLName like 'Public'
group by O.CallerFName,O.CallerLName,O.CallerDOB order by Max(O.CreatedOn) 
```

结果：

```
John    Public  4/4/2001    4/6/12 16:42
Joe     Public  4/12/1988   4/6/12 16:52
John    Public  1/2/1950    4/6/12 17:01 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:19:42.197

如果您选择 TOP (1) WITH TIES 并将 ROW_NUMBER() 表达式放在 ORDER BY 子句中，您还可以将 Andrey 写的内容写得更紧凑：

```
SELECT TOP (1) WITH TIES
  CallerFName,
  CallerLName,
  CallerDOB,
  CreatedOn,
  PhoneNoteID
FROM [dbo].[PhoneCallNotes]
WHERE CallerLName = 'Public' 
ORDER BY ROW_NUMBER() OVER(
  PARTITION BY CallerFName, CallerLName, CallerDOB
  ORDER BY CreatedOn DESC
) 
```

（顺便说一句，没有理由使用 LIKE 进行简单的字符串比较。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:10:28.130

尝试这样的事情：

```
;WITH CTE AS (
    SELECT  
        O.CallerFName,
        O.CallerLName,
        O.CallerDOB,
        O.CreatedOn,
        PhoneNoteID,
        ROW_NUMBER() OVER(PARTITION BY O.CallerFName, O.CallerLName, O.CallerDOB ORDER BY O.CreatedOn DESC) AS rn
    FROM [dbo].[PhoneCallNotes] AS O 
    WHERE 
        O.CallerLName LIKE 'Public' 

)
SELECT 
    CallerFName,
    CallerLName,
    CallerDOB,
    CreatedOn,
    PhoneNoteID
FROM CTE
WHERE rn = 1
ORDER BY 
    CreatedOn 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T20:08:04.090

假设 [ `FirstName`, `LastName`, `DateOfBirth`] 的集合是唯一的（#shudder#），我相信以下内容应该适用于几乎所有主要的 RDBMS：

```
SELECT a.callerFName, a.callerLName, a.callerDOB, a.createdOn, a.phoneNoteId
FROM phoneCallNotes as a
LEFT JOIN phoneCallNotes as b
ON b.callerFName = a.callerFName
AND b.callerLName = a.callerLName
AND b.callerDOB = a.callerDOB
AND b.createdOn > a.createdOn
WHERE a.callerLName LIKE 'Public'
AND b.phoneNoteId IS NULL 
```

基本上，查询正在查找特定姓名/dob 组合的每个电话呼叫记录，其中没有最近的行（`b`为空）。但是，如果您有两行具有相同的创建时间，则会得到重复的行。

# php - 将 mod_rewrite 规则转为 PHP 规则

> ID：10079015
> 
> 赞同：0
> 
> 时间：2012-04-09T19:58:55.377
> 
> 标签：php, wordpress, .htaccess, mod-rewrite

我希望能够从 PHP 而不是我的 .htaccess 文件中处理 mod 重写，这样当我有需要新重写的自定义模块时，我不必重做 .htaccess 文件。

我想模仿 WordPress 执行 .htaccess 的方式，即：

```
RewriteEngine On RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)$ /index.php/$1 [L,QSA] 
```

我当前的 .htaccess 是这样的：

```
Options +FollowSymlinks
RewriteEngine On

RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
# MBP Rules
RewriteRule ^module/([A-Za-z-_]+)/([A-Za-z-_]+)/?$ /index.php?p=module&prefix=$1&module_page=$2 [NC,QSA,L]
RewriteRule ^module/([A-Za-z-_]+)/([A-Za-z-_]+)/([A-Za-z-_]+)/?$ /index.php?p=module&prefix=$1&module_page=$2&page=$3 [NC,QSA,L]
RewriteRule ^module/([A-Za-z-_]+)/([A-Za-z-_]+)/([0-9]+)/?$ /index.php?p=module&prefix=$1&module_page=$2&id=$3 [NC,QSA,L]
RewriteRule ^([A-Za-z-_]+)/?$ /index.php?p=$1 [NC,QSA,L]
RewriteRule ^([A-Za-z-_]+)/([A-Za-z-_]+)/?$ /index.php?p=$1&s=$2 [NC,QSA,L]
RewriteRule ^([A-Za-z-_]+)/([A-Za-z-_]+)/([0-9]+)/?$ /index.php?p=$1&s=$2&id=$3 [NC,QSA,L] 
```

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:04:20.210

我的方法是更换

```
RewriteRule ^(.+)$ /index.php/$1 [L,QSA] 
```

和

```
RewriteRule ^(.+)$ /index.php?path=$1 [L,QSA] 
```

然后你必须像 modrewrite 那样做类似的解析和所有事情，但你可以使用 $_GET['path'] 上的 preg_match 自己做。IE

```
if (preg_match('/id/([0-9]*)', $_GET['path'], $matches)) {
    Do code;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:02:45.433

当然，让`.htaccess`文件看起来像您拥有的第一个示例，然后从那里构建您的脚本。

可能会编写某种`Router`类，将请求路由到它们的位置，基本原理是将接收到的查询拆分为`/`，这为您提供了 URL 部分的数组，然后开始调节。

# ios - 如何将 UITapGestureRecognizer 添加到表格视图单元格内的 UILabel ？

> ID：10079019
> 
> 赞同：23
> 
> 时间：2012-04-09T19:59:22.957
> 
> 标签：ios, uitapgesturerecognizer

我正在使用 NIB 文件来布局自定义表格视图单元格。这个单元格有一个名为 lblName 的带有出口的标签。向此标签添加 UITapGestureRecognizer 永远不会触发关联的事件。我有 userInteractionEnabled = YES。

我猜问题是 UILabel 在 TableView 中，并且表格/单元格视图正在拦截水龙头。我可以对此做些什么吗？

我要做的就是在按下 UILabel 时执行一些自定义操作！我见过的所有这样做的解决方案都是荒谬的。使用标准工具集应该很容易。但显然不是。

这是我正在使用的代码：

```
- (void)tapAction {
    NSLog(@"Tap action");
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib

    UITapGestureRecognizer *recognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapAction)]; 
    [recognizer setNumberOfTapsRequired:1];
    //lblName.userInteractionEnabled = true;  (setting this in Interface Builder)
    [lblName addGestureRecognizer:recognizer];
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-10T10:43:18.743

**简单的方法：**

您也可以使用该标签顶部的隐形按钮。因此，它将减少您为该标签添加 tapGesture 的工作。

**替代方式：**

您不应该为此创建 IBOutlet `UILabel`。当您这样做时，您将在自定义类实现文件中添加一个出口。您无法在其他文件中访问。因此，在自定义类中为该标签设置标签并在方法`IB`中编写代码。`cellForRowAtIndexPath:`

**更新：**

在`cellForRowAtIndexPath:`方法上，

```
for(UIView *view in cell.contentViews.subviews) {
    if(view.tag == 1) {
        UITapGestureRecognizer *tap=[[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapAction)];
        [tap setNumberOfTapsRequired:1];
        [view addGestureRecognizer:tap];
    }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-07-24T09:32:02.440

```
UITapGestureRecognizer *recognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapAction)]; 
[recognizer setNumberOfTapsRequired:1];
lblName.userInteractionEnabled = YES;  
[lblName addGestureRecognizer:recognizer]; 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-04-09T20:16:07.663

这样做没有问题：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
{
   ...
   // create you cell
   UILabel *lbl = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 100, 50)];
   [lbl setText:@"example"];
   [lbl setUserInteractionEnabled:YES];
   [cell.contentView addSubview:lbl];
   UITapGestureRecognizer *tap=[[UITapGestureRecognizer alloc] initWithTarget:self    action:@selector(tapAction:)];
   tap.tag = [NSIndexPath row];
   [tap setNumberOfTapsRequired:1];
   [lbl addGestureRecognizer:tap];
   ... 
}

- (void)tapAction:(id)sender {
  switch(((UITapGestureRecognizer *)sender).view.tag) {
     case 0:
          // code
          break;
     case 1:
         // code
         break;
      ....
     }
} 
```

即使在使用 IB 创建 UILabel 的情况下

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-10-02T07:29:49.360

**您可以使用下面的代码在 UITableView 单元格中的 UILable 上添加点击手势**

```
UITapGestureRecognizer *tapGeature = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(lblClick:)];
tapGeature.delegate =self;
tapGeature.numberOfTapsRequired = 1;

cell.lbl.userInteractionEnabled = YES;
[cell.lbl addGestureRecognizer:tapGeature]; 
```

**并访问选择器方法**

```
- (void)lblClick:(UITapGestureRecognizer *)tapGesture {
    UILabel *label = (UILabel *)tapGesture.view;
    NSLog(@"Lable tag is ::%ld",(long)label.tag);
} 
```

**对于斯威夫特**

```
let tapGesture : UITapGestureRecognizer = UITapGestureRecognizer.init(target: self, action: #selector(lblClick(tapGesture:)))
tapGesture.delegate = self
tapGesture.numberOfTapsRequired = 1
cell.lbl.userInteractionEnabled = true
cell.lbl.tag = indexPath.row
cell.lbl.addGestureRecognizer(tapGesture)

func lblClick(tapGesture:UITapGestureRecognizer){
   print("Lable tag is:\(tapGesture.view!.tag)")
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-12-11T09:27:56.267

基于 Hardik Thakkar 的解决方案，使用 Swift 5 更新 2019 年。要检测单元格中 UIlabel 上的点击，请在下面的视图控制器中找到 cellForRowAt 方法。

```
override func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {} 
```

在返回单元格之前，将以下代码放入上述方法中：

```
let tapGesture : UITapGestureRecognizer = UITapGestureRecognizer.init(target: self, action: #selector(labelTap(tapGesture:)))
tapGesture.delegate = self
tapGesture.numberOfTapsRequired = 1
cell.yourLabel.isUserInteractionEnabled = true
cell.yourLabel.tag = indexPath.row
cell.yourLabel.addGestureRecognizer(tapGesture)            
return cell 
```

向视图控制器添加一个方法来处理点击：

```
@objc func labelTap(tapGesture:UITapGestureRecognizer){
    print("Label tag is:\(tapGesture.view!.tag)")
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-18T08:31:27.567

您可以在单元格的 -awakeFromNib 方法中添加下一个

```
UITapGestureRecognizer* gesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapGestureRecognizerAction:)];
[self.yourLabel setUserInteractionEnabled:YES];
[self.yourLabel addGestureRecognizer:gesture]; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-10-20T16:46:43.370

一旦您将点击手势分配给 UILabel 并将用户交互设置为启用，在您的回调函数中，您可以从单元格视图中找到索引路径，但搜索超级视图的嵌套：

```
- (UITableViewCell *) findCellInSuperview:(UIView *)view
{
UITableViewCell *cell = nil;

    NSString *className = NSStringFromClass([[view superview] class]);
    if ([className isEqualToString:@"UITableViewCell"]) {
        cell = (UITableViewCell *)[view superview];
    } else {
        if ([view superview] != nil) {
            cell = [self findCellInSuperview:[view superview]];
        }
    }

return cell;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-08-24T00:14:23.850

对于斯威夫特 3

```
let tapGesture : UITapGestureRecognizer = UITapGestureRecognizer.init(target: self, action: 
#selector(lblClick(tapGesture:)))
tapGesture.delegate = self
tapGesture.numberOfTapsRequired = 1
cell.lbl.isUserInteractionEnabled = true
cell.lbl.tag = indexPath.row
cell.lbl.addGestureRecognizer(tapGesture) 
```

进而

```
func lblClick(tapGesture:UITapGestureRecognizer){
    print("Lable tag is:\(tapGesture.view!.tag)")
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-11T17:28:36.617

Dinesh 建议的方式将在没有使用属性变量的 for 循环的情况下工作。

```
UITapGestureRecognizer *tap=[[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapAction)];
[tap setNumberOfTapsRequired:1];
[self.myUILabel addGestureRecognizer:tap]; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-05-09T13:41:47.390

对于 Swift，您可以在 cellForRowAtIndexPath 方法中添加它。

```
var tap = UITapGestureRecognizer(target: self, action: "labelTapped")
tap.numberOfTapsRequired = 1
cell.label.addGestureRecognizer(tap)
cell.label.tag = indexPath.row 
```

然后行动

```
func labelTapped(gesture: UITapGestureRecognizer) {
    let indexPath = NSIndexPath(forRow: gesture.view!.tag, inSection: 0)
    let cell = tableView.cellForRowAtIndexPath(indexPath) as UITableViewCell

    // Do whatever you want.
} 
```

# php - 对mysql查询的结果进行排序

> ID：10079025
> 
> 赞同：1
> 
> 时间：2012-04-09T20:00:04.380
> 
> 标签：php, mysql, search, sorting

我很难找出一个优雅的解决方案来根据分隔字符串对 mysql 查询的结果进行排序。我将在下面更详细地解释

我正在创建一个联系人数据库，个人用户可以在其中从列表中添加/删除人员。当用户添加新联系人时，我将添加的联系人 ID 附加到分隔字符串，并将该数据存储在与该用户关联的数据库列中（命名为联系人）：

```
$userID = ?? //YOUR ID
$contactID = ?? //WHATEVER THE ADDED USER ID IS
$confirm = 0 //has the user been confirmed
$sql = "SELECT contacts FROM user WHERE id = '$userID'";
$query = mysql_query($sql);
$row = mysql_fetch_array($query);
$contact = $row['contacts']; 
$contact .= '|'.$contactID.':'.$confirm;
$update = mysql_query("UPDATE user SET contacts = '$contact' WHERE id = '$userID'");

//contact column data might be:  |10:0|18:0|36:0|5:0 
```

当用户搜索他们的联系人时，我从联系人列中获取数据，分解/拆分字符串并返回各个用户的姓名：

```
$userID = ?? //YOUR ID
$sql = "SELECT contacts FROM user WHERE id = '$userID'";
$query = mysql_query($sql);
$row = mysql_fetch_array($query);
$contacts = explode("|", $row['contacts']);
foreach($contacts as $item)
{
 list($contactID,$confirm) = split(":", $item);
 $sql = "SELECT name FROM ".user." WHERE id = '$contactID'";  
 $query = mysql_query($sql);
 $row = mysql_fetch_array($query);
 echo($row['name'].'<BR>');
} 
```

这确实会返回所有名称，但它会按分隔字符串的顺序返回它们。我似乎找不到一种按名称按字母顺序排序的优雅方式。

我不应该将联系人列表存储在分隔字符串中吗？你会如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:04:18.087

没错，您不应该将联系人存储在字符串中。而是使用另一个包含用户信息的表。新表应如下所示：

```
Table: user_contacts
| user_id    |    contact_id    | confirm |
-------------------------------------------
|  your data here...                      | 
```

然后，当您需要联系人列表时，您可以简单地执行另一个查询：

```
SELECT * FROM `user_contacts`
JOIN `users` ON `users`.`id` = `user_contatcs`.`user_id`
WHERE `users`.`id` = $id
ORDER BY `users`.`name`; 
```

或者您需要订购它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:04:51.137

有两种明显的方法：

1.  获取结果后对结果进行排序
2.  在一个查询中获取它们并让数据库对它们进行排序

对于#1，使用`usort()`：

```
$rows = array();
foreach ($contacts as $item){
    list($contactID,$confirm) = split(":", $item);
    $query = mysql_query("SELECT name FROM user WHERE id = '$contactID'");
    $rows[] = mysql_fetch_array($query);
}
usort($rows, 'sort_by_name');

function sort_by_name($a, $b){
    return strcmp($a['name'], $b['name']);
}

foreach ($rows as $row){
    echo($row['name'].'<BR>');
} 
```

对于 #2，构建一个 ID 列表并使用`IN`：

```
$ids = array();
foreach ($contacts as $item){
    list($contactID,$confirm) = split(":", $item);
    $ids[] = $contactID;
}
$ids = implode(',', $ids);
$query = mysql_query("SELECT name FROM user WHERE id IN ($ids) ORDER BY name ASC");
while ($row = mysql_fetch_array($query)){

    echo($row['name'].'<BR>');
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T20:08:17.583

如果您使用的是关系数据库，那么您需要的是一个单独的表来存储人员-联系人关系。然后，您将修改您的 sql 查询以基于跨两个表的连接进行选择

```
SELECT * FROM person, contact
JOIN contact ON person.id = contact.personid
JOIN person ON contact.contactid = person.id
WHERE person.id = $id
ORDER BY person.lastname 
```

（该代码可能不太正确。）

如果您使用的是 no-sql 类型实现，那么您的操作方式很好，除了您必须在事后以编程方式排序，或者在插入时排序。插入排序意味着您必须在插入联系人时查询当前的联系人列表，然后进行排序以找到正确的位置并将 id 插入分隔字符串。然后将其保存回数据库。这样做的缺点是您只能以一种方式排序。

通常，人们使用关系数据库并如上所述“规范化”它们。

# html - 浏览器在代码中没有空格的地方放置空格

> ID：10079037
> 
> 赞同：2
> 
> 时间：2012-04-09T20:01:12.483
> 
> 标签：html

`<li></li>`当源中没有空格时，为什么以下标记会在 each 之后产生一个空格？如果我将它们全部放在一行上，则预览页面时空格会消失。但是为什么浏览器将我的标签读取为空格？

（您可以在第一张图片的左侧看到服务旁边的边框。该边框和服务之间是空间。它在图片 2 中不存在。）

![在此处输入图像描述](../Images/9f332ad985c9599433c960942ed1ce9b.png)

```
<nav>
    <ul>
        <li><a href="#" class="active">HOME</a></li>
        <li><a href="#">SERVICES</a></li>
        <li><a href="#">PRODUCTS</a></li>
        <li><a href="#">ABOUT</a></li>
        <li><a href="#">CONTACT</a></li>
        <li><a href="#">LIKE US</a></li>
    </ul>
</nav> 
```

这是删除所有选项卡的情况：

![在此处输入图像描述](../Images/6dad6db2d1c28533d924e845ede70b29.png)

```
<nav>
    <ul>
        <li><a href="#" class="active">HOME</a></li><li><a href="#">SERVICES</a></li><li><a href="#">PRODUCTS</a></li><li><a href="#">ABOUT</a></li><li><a href="#">CONTACT</a></li><li><a href="#">LIKE US</a></li>
    </ul>
</nav> 
```

编辑：

浏览器是 OSX Lion 上的 Safari 5.1.5。编辑是 Espresso。还尝试了TextMate。这是导航的 CSS。

```
nav {
    position: relative;
    width: 960px;
    padding: 0 30px;
    background: #281601; /* Old browsers */
    background: -moz-linear-gradient(left,  #3f2c16 0%, #281601 5%, #281601 95%, #3f2c16 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, right top, color-stop(0%,#3f2c16), color-stop(5%,#281601), color-stop(95%,#281601), color-stop(100%,#3f2c16)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(left,  #3f2c16 0%,#281601 5%,#281601 95%,#3f2c16 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(left,  #3f2c16 0%,#281601 5%,#281601 95%,#3f2c16 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(left,  #3f2c16 0%,#281601 5%,#281601 95%,#3f2c16 100%); /* IE10+ */
    background: linear-gradient(left,  #3f2c16 0%,#281601 5%,#281601 95%,#3f2c16 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#3f2c16', endColorstr='#3f2c16',GradientType=1 ); /* IE6-9 */
    font-family: 'Crimson Text', serif;
    color: #fff;
}

nav:before {
    position: absolute;
    left: -12px;
    top: 0px;
    content: url('../img/nav-left.png');
}

nav:after {
    position: absolute;
    left: 960px;
    top: 0px;
    content: url('../img/nav-right.png');
}

nav ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

nav ul li {
    display: inline-block;
}

nav ul li a, nav ul li a:visited {
    display: block;
    color: #c7beb4;
    text-decoration: none;
    font-size: 95%;
    letter-spacing: 0.08em;
    padding: 12px 20px;
    border-right: 1px solid #3b2b18;
}

nav ul li:first-child a:before {
    content: url('../img/nav-icon-home.png');
    margin: 0px 8px 0 0;
}

nav ul li:first-child a:hover:before {
    content: url('../img/nav-icon-home-active.png');
}

nav ul li:last-child {
    float: right;
}

nav ul li:last-child a {
    border:none;
}

nav ul li:last-child a:before {
    content: url('../img/nav-icon-facebook.png');
    margin: 0px 8px 0 0;
}

nav ul li:last-child a:hover:before {
    content: url('../img/nav-icon-facebook-active.png');
}

nav ul li a:hover {
    background: #c7beb4;
    color: #281601;
    box-shadow: inset 0 0 15px rgba(40,22,1,0.5);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:14:16.113

将 li 的显示更改为 display:table-cell 而不是 display:inline-block。

# django - 来自 Django 模板的字符串，但没有返回 HTTPResponse

> ID：10079038
> 
> 赞同：1
> 
> 时间：2012-04-09T20:01:14.400
> 
> 标签：django, json, templates

我有一个查询集，我想用它的对象来填充模板。我以一种观点结束

```
return render_to_response('entry.json', {'entry_list':r}, mimetype="application/json; charset=utf-8") 
```

但是，我希望能够使用这样的模板序列化为 json，而不必返回 HTTPResponse。在伪代码中，这可能是：

```
render('entry.json', {'entry_list':r}) #returns a string with the template entry.json 
```

这可能吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T20:06:58.593

@HankGay 说的是正确的，尽管您有时可能希望在不返回 HttpResponse 的情况下获得模板响应，即使您正确使用了 Django。

阅读：[渲染上下文](https://docs.djangoproject.com/en/dev/ref/templates/api/#rendering-a-context)：

```
>>> from django.template import Context, Template
>>> t = Template("My name is {{ my_name }}.")

>>> c = Context({"my_name": "Adrian"})
>>> t.render(c)
"My name is Adrian."

>>> c = Context({"my_name": "Dolores"})
>>> t.render(c)
"My name is Dolores." 
```

这就是你所追求的吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T20:16:54.823

Django 为此提供了一个内置的快捷方式。

[https://docs.djangoproject.com/en/dev/ref/templates/api/#the-render-to-string-shortcut](https://docs.djangoproject.com/en/dev/ref/templates/api/#the-render-to-string-shortcut)

我不太明白您要完成什么，但是您可以将 JSON 作为 HTTPResponse 返回。您可以将对象序列化为 jason 并在不使用任何模板的情况下将其返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T20:02:53.517

老实说，如果您不处理 HTTP 请求，那么使用 Django 没有多大意义。在[Jinja 2](http://jinja.pocoo.org/docs/)中寻找一个与 Django 有很多共同点的简单模板引擎，并在[SQLAlchemy](http://www.sqlalchemy.org/)中寻找与 Django 相同或更好的 ORM。

# android - 安卓服务关闭

> ID：10079045
> 
> 赞同：0
> 
> 时间：2012-04-09T20:02:04.120
> 
> 标签：android, android-service

这是我第一次尝试android服务，所以我有点迷茫。我正在开发一个需要服务始终在后台运行的应用程序。该服务是从主活动中的 onclick 事件初始化的。要启动服务，我使用以下代码：

```
Intent Test = new Intent(this, testService.class);
startService(Test); 
```

在服务中我基本上有两件事。在 onCreate 方法中，我初始化了一个计时器，它每 30 分钟打开一个新线程并检查服务器是否有任何新数据。在 onStart 方法上，我注册了一个接收器。

几个小时后服务被杀死，垃圾收集器是否有可能正在删除服务？我怀疑我初始化服务的方式仍然绑定到活动“主”进程。我可以做些什么来确保服务继续运行？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:39:00.497

您需要 AlarmManager 而不是计时器来完成此任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T09:57:30.743

当操作系统需要资源时，操作系统可以终止任何正常优先级或用户定义的后台服务，因此，如果您希望服务始终运行，则可以将后台服务设置为前台，或者如果您不想让手机进入睡眠模式，您可以使用唤醒锁...通过这些您可以将您的服务设置为始终开启模式......谢谢

# c# - 正则表达式 - 获取所有未用“/”包裹的单词

> ID：10079054
> 
> 赞同：3
> 
> 时间：2012-04-09T20:02:33.667
> 
> 标签：c#, regex, string

我真的很想学习正则表达式，所以就到这里了。

我真的很想得到一个字符串中没有“/”的所有单词。例如，我需要这样做：“Hello Great /World/” 我需要得到结果：“Hello”“Great”

这在正则表达式中是否可行，如果可以，我该怎么做？我想我希望将结果存储在字符串数组中:)

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T20:36:38.190

Just use this regular expression `\b(?<!/)\w+(?!/)\b`:

```
var str = "Hello Great /World/ /I/ am great too";
var words = Regex.Matches(str, @"\b(?<!/)\w+(?!/)\b")
    .Cast<Match>()
    .Select(m=>m.Value)
    .ToArray(); 
```

This will get you:

```
Hello
Great
am
great
too 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:11:12.047

```
 var newstr = Regex.Replace("Hello Great /World/", @"/(\w+?)/", ""); 
```

如果你真的想要一个字符串数组

```
var words = Regex.Matches(newstr, @"\w+")
    .Cast<Match>()
    .Select(m => m.Value)
    .ToArray(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T20:09:11.307

我首先将字符串拆分为数组，然后过滤掉匹配的单词。此解决方案也可能比大的正则表达式更干净，因为您可以更好地发现“单词”和过滤器的要求。

大的正则表达式解决方案类似于单词边界 - 不是斜杠 - 许多无空格 - 不是斜杠 - 单词边界。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T20:07:47.403

我会使用正则表达式替换将所有 /[a-zA-Z]/ 替换为 '' (nothing) 然后获取所有单词

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T20:17:02.553

**试试这个：（**点击[这里查看演示](http://regexr.com?30jbs)）

```
(\s(?<!/)([A-Za-z]+)(?!/))|((?<!/)([A-Za-z]+)(?!/)\s) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-10T17:43:32.203

使用此示例摘录：

> /character/“_”（下划线/下划线）可以在/变量/名称/in/许多/programming//languages/中/使用/，而/character/“/”（斜线/笔划/solidus）通常是不允许的。

...此表达式匹配任何前后*都*没有字符的字母、数字、下划线或撇号（英语中“单词”的典型概念`/`）*字符串*-**`wrapped with a "/"`**

 **```
\b([\w']+)\b(?<=(?<!/)\1|\1(?!/)) 
```

...并且是最纯粹的形式，仅使用一个字符类来定义“单词”字符。它与示例匹配如下：

```
Matched               Not Matched
-------------         -------------
The                   character
_                     used
underscore            variable
under                 in
strike                programming
can                   languages
be                    character
in                    stroke
names
many
while
the
slash
solidus
is
typically
not
allowed 
```

如果不需要排除`/stroke/`, ，则在末尾限制中添加一点将允许它，具体取决于您要如何定义“下一个”单词的开头：

```
\b([\w']+)\b(?<=(?<!/)\1|\1(?!/([^\w]))). 
```

更改`(?!/)`为，*如果它*后面紧跟一个字母、数字或下划线`(?!/([^\w]))`，则允许。这将从上面的“不匹配”列表移动到“匹配”列表。`/something/` *`stroke`*

 **注意：`\w`匹配大写或小写字母、数字和下划线字符*

如果您想从上面更改“单词”的概念，只需`[\w']`将表达式部分中包含的字符和速记字符类交换`[a-zA-Z']`为排除数字或`[\w'-]`包含连字符之类的东西，这将捕获`under-strike`为单个匹配项，而不是比两个单独的匹配：

```
\b([\w'-]+)\b(?<=(?<!/)\1|\1(?!/([^\w]))) 
```

* * *

***重要的替代品！！！*** *（我认为）*

*我只是想到了匹配*任何*未*用符号包裹的单词的替代方法`/`：只需*消耗*所有这些符号和*它们*包围的单词（拆分）。这有几个好处：没有环视意味着这可以在更多的上下文中使用（JavaScript 不支持环视，一些正则表达式根本不支持环视）同时提高效率；此外，使用拆分表达式意味着字符串数组的直接结果：

```
string input = "The /character/ "_" (underscore/under-strike) can be..."; //etc...
string[] resultsArray = Regex.Split(input, @"([^\w'-]+?(/[\w]+/)?)+"); 
```

瞧！***

# c++ - 从 Python 输出数组值然后通过 C++ 接收它们的好方法？

> ID：10079055
> 
> 赞同：0
> 
> 时间：2012-04-09T20:02:35.057
> 
> 标签：c++

由于令人讨厌的 C++ 溢出问题，我想改用 Python 来预先计算一些值。我有一个函数 f(a,b) 然后会吐出一个值。我希望能够根据 a 和 b 的范围将我需要的所有值输出到一个文件中，然后在 C++ 中读取该文件并流行一个向量或数组或其他更好的值。

1.  输出 f(a,b) 的好格式是什么？
2.  将其读回 C++ 的最佳方法是什么？
3.  矢量或多维数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:12:47.833

您可以使用 Python 写出与 C++ 源语法兼容的 .h 文件。

```
h_file.write('{')
for a in range(a_size):
    h_file.write('{' + ','.join(str(f(a, b)) for b in range(b_size)) + '},\n')
h_file.write('}') 
```

您可能想要修改该代码以添加一些额外的换行符，事实上我有这样的代码可以稍后显示（现在无法访问它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:57:45.687

如果有兆字节的数据，那么我会通过内存映射数据文件读取数据，只读。我会安排一些事情，这样我就可以直接使用数据文件，而不必在启动时将其全部读取。

这样做的原因是，如果您只想使用一些值，您不想在启动时读取兆字节的数据。通过使用内存映射，您的操作系统将自动读取您需要的文件部分。而且，如果您的 RAM 不足，您的操作系统可以重用为该文件分配的内存，而不必浪费时间将其写入交换文件。

如果你的函数的输出是一个数字，你可能只需要一个整数数组。您可能需要一个二维数组，例如：

```
#define DATA_SIZE (50 * 25)
typedef const int (*data_table_type)[50];
int fd = open("my_data_file.dat", O_RDONLY);
data_table_type data_table = (data_table_type)mmap(0, DATA_SIZE,
                                  PROT_READ, MAP_SHARED, fd, 0);
printf("f(5, 11) = %d\n", data_table[5][11]); 
```

有关内存映射文件的更多信息，请参阅[Wikipedia](http://en.wikipedia.org/wiki/Memory-mapped_file)或[UNIX mmap() 函数](http://pubs.opengroup.org/onlinepubs/009695399/functions/mmap.html)或[Windows CreateFileMapping() 函数](http://msdn.microsoft.com/en-us/library/aa366537.aspx)。

如果需要更复杂的数据结构，可以将 C/C++ 结构和数组放入文件中。但是您不能嵌入指针或任何具有虚拟对象的 C++ 类。

一旦决定了如何读取数据，下一个问题就是如何生成数据。 [struct.pack()](http://docs.python.org/library/struct.html)对此非常有用 - 它允许您将 Python 值转换为格式正确的 Python 字符串，然后您可以将其写入文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T21:14:18.940

您可以使用 Python 编写包含数据的 C++ 源代码。例如：

```
def f(a, b):
    # Your function here, e.g:
    return pow(a, b, 65537)
num_a_values = 50
num_b_values = 50
# Write source file
with open('data.cpp', 'wt') as cpp_file:
    cpp_file.write('/* Automatically generated file, do not hand edit */\n\n')
    cpp_file.write('#include "data.hpp"\n')
    cpp_file.write('const int f_data[%d][%d] =\n'
                       % (num_a_values, num_b_values))
    cpp_file.write('{\n')
    for a in range(num_a_values):
        values = [f(a, b) for b in range(num_b_values)]
        cpp_file.write('  {' + ','.join(map(str, values)) + '},\n')
    cpp_file.write('}\n')
# Write corresponding header file
with open('data.hpp', 'wt') as hpp_file:
    hpp_file.write('/* Automatically generated file, do not hand edit */\n\n')
    hpp_file.write('#ifndef DATA_HPP_INCLUDED\n')
    hpp_file.write('#define DATA_HPP_INCLUDED\n')
    hpp_file.write('#define NUM_A_VALUES %d\n' % num_a_values)
    hpp_file.write('#define NUM_B_VALUES %d\n' % num_b_values)
    hpp_file.write('extern const int f_data[%d][%d];\n'
                              % (num_a_values, num_b_values))
    hpp_file.write('#endif\n') 
```

然后将生成的源代码编译为项目的一部分。然后，您可以通过#include 标头并`f_data[]`直接访问数组来使用它。

这非常适用于中小型数据表，例如图标。对于较大的数据表（数百万条目），一些 C 编译器会失败，您可能会发现编译/链接速度慢得无法接受。

如果您的数据更复杂，您可以使用相同的方法来定义结构。

[基于 Mark Ransom 的回答，但有一些风格差异和更多解释]。

# c - (int (*)[30]) 中的 (*) 是什么意思？

> ID：10079056
> 
> 赞同：5
> 
> 时间：2012-04-09T20:02:37.043
> 
> 标签：c

在 C 中是什么`(int (*)[30])`意思？例如，在：

```
int (*b)[30] = (int (*) [30]) malloc(30 * sizeof(int [20])); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-09T20:05:43.627

大致意思是“是一个指针”。

```
int (*b)[30] 
```

这意味着“`b`是一个指向 30 个整数数组的指针”。

```
(int (*) [30]) 
```

这意味着“转换为指向 30 个整数数组的指针”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T21:07:08.860

```
int (*b)[30] = (int (*) [30]) malloc(30 * sizeof(int [20])); 
```

分解它：

```
 b        -- b
    (*b)       -- is a pointer
    (*b)[30]   -- to a 30-element array
int (*b)[30]   -- of int. 
```

在声明和表达式中，后缀运算符 like`[]`比一元运算符 like 具有更高的优先级`*`，因此`T *a[]`被解释为`T *(a[])`; IOW，`a`是一个指针数组`T`。要指定`a`一个*指向数组*的指针，我们必须强制分组`T (*a)[]`。

类似地，强制转换表达式的`(int (*) [30])`意思是“将返回的指针值`malloc`视为指向 30 元素数组的指针`int`”。请注意，从技术上讲，强制转换表达式是多余的，应该删除。

`malloc`调用本身似乎非常错误。您正在分配 20 元素数组的 30 个实例`int`，但将结果分配给指向 ; 的 30 元素数组的指针`int`。这会导致问题。假设您正在尝试分配 的 N x 30 矩阵`int`，则以下内容会更安全：

```
int (*b)[30] = malloc(N * sizeof *b); 
```

表达式的类型`*b`是`int [30]`，所以`sizeof *b`与 相同`sizeof (int [30])`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T20:07:28.533

如何解析 C 声明和类型：从外向内展开。

*   `int (*b)[30]`.
*   `(*b)[30]`是一个`int`。
*   `(*b)`是一个`int`长度数组`30`。
*   `b`是一个指向`int`长度数组的指针`30`。

无名版本`int (*) [30]`完全相同，只是省略了名称。

如果你有一本 The C Programming Language 的副本，那么里面有一个名为`cdecl`可以将此类声明转换为英语的程序。随着时间的推移，它已经进行了各种修改，例如Debian 中的[cutils](http://packages.debian.org/cutils)支持无名形式，并且[cdecl.org](http://cdecl.org/)是在线的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T20:09:50.517

您可以使用`cdecl`来解决这些问题：

```
cdecl> explain (int (*) [30]) 
cast unknown_name into pointer to array 30 of int 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T20:09:50.470

真的没有什么特别的`(*)`。由于您只是在类型转换中引用一个类型（而不是具有该类型名称的变量），因此您只需省略该名称。这里仍然需要括号来区分指针数组和指向数组的指针。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-09T20:07:09.317

变量名前的 (*) 表示它是一个 POINTER。

我们刚刚看到，存储对另一个变量的引用的变量称为指针。据说指针“指向”它们存储其引用的变量。

使用指针，我们可以直接访问存储在它指向的变量中的值。为此，我们只需在指针的标识符前面加上一个星号 (*)，它充当解引用运算符，可以直译为“指向的值”。

# sql - sql server 代理中的 ssis 作业

> ID：10079060
> 
> 赞同：0
> 
> 时间：2012-04-09T20:02:55.013
> 
> 标签：sql, sql-server-2008, ssis

我创建了一个 SSIS 包，它在 Sql Server 商业智能中运行良好。问题是当我尝试安排一个作业运行时，我对其进行了测试，它说该 exe 在目录中不存在，它列出了该 exe 所在目录的路径。exe 显然在那里，并且 exe 运行良好，只是当我尝试安排作业时它不喜欢这个包。

我可以在作业活动监视器中看到的错误是

说明：目录“DirectoryName”中不存在文件/进程“FileName.exe”结束错误

有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:15:34.690

SSIS 包不是 EXE。该名称通常类似于“MyPackageName.dtsx”。该包由与 SQL Server 实例一起运行的 DTS 实用程序解释和执行。

我们使用 SQL 代理来运行 SSIS 包作为我们应用程序的标准部分，所以它本身不应该是一个问题。您是如何定义 SQL 代理作业的？

# c# - 未填充 SOAP 响应对象

> ID：10079062
> 
> 赞同：1
> 
> 时间：2012-04-09T20:03:13.830
> 
> 标签：c#, wcf, wsdl, axis

我正在通过 .Net 解决方案调用第三方的 AXIS Web 服务

通过以下 WSDL 文件向我的 VS 项目添加了服务参考（服务位置已被删除，因为它是一种受限使用）

```
<?xml version="1.0" encoding="UTF-8"?>
<wsdl:definitions
    name="PremiumCharging"
    targetNamespace="http://premiumcharging.verisign.com"
    xmlns:pmg="http://types.premiumcharging.verisign.com"
    xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
    xmlns:tns="http://premiumcharging.verisign.com"
    xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <wsdl:types>
    <xsd:schema
        targetNamespace="http://types.premiumcharging.verisign.com"
        xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"
        xmlns:pmg="http://types.premiumcharging.verisign.com"
        xmlns:xsd="http://www.w3.org/2001/XMLSchema">
      <xsd:complexType name="UserInfo">
        <xsd:sequence>
          <xsd:element name="aggregatorId" type="xsd:int"/>
          <xsd:element name="pwd" type="xsd:string"/>
          <xsd:element name="version" type="xsd:string"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="StatusInfo">
        <xsd:sequence>
          <xsd:element name="errorCode" type="xsd:int"/>
          <xsd:element name="errorDescription" type="xsd:string"/>
          <xsd:element name="transactionId" type="xsd:int"/>
        </xsd:sequence>
      </xsd:complexType>
    </xsd:schema>
  </wsdl:types>
  <wsdl:message name="chargeSubscriberResponse">
    <wsdl:part name="chargeSubscriberReturn" type="pmg:StatusInfo"/>
  </wsdl:message>
  <wsdl:message name="chargeSubscriberRequest">
    <wsdl:part name="user" type="pmg:UserInfo"/>
    <wsdl:part name="mdn" type="xsd:string"/>
    <wsdl:part name="productId" type="xsd:string"/>
    <wsdl:part name="shortCode" type="xsd:string"/>
    <wsdl:part name="carrierId" type="xsd:int"/>
    <wsdl:part name="chargeId" type="xsd:string"/>
    <wsdl:part name="msgtxid" type="xsd:string"/>
  </wsdl:message>
  <wsdl:portType name="PremiumChargingPortType">
    <wsdl:operation name="chargeSubscriber">
      <wsdl:input message="tns:chargeSubscriberRequest"/>
      <wsdl:output message="tns:chargeSubscriberResponse"/>
    </wsdl:operation>
  </wsdl:portType>
  <wsdl:binding name="PremiumChargingBinding" type="tns:PremiumChargingPortType">
    <soap:binding style="rpc" transport="http://schemas.xmlsoap.org/soap/http"/>
    <wsdl:operation name="chargeSubscriber">
      <soap:operation/>
      <wsdl:input>
        <soap:body parts="user mdn productId shortCode carrierId chargeId msgtxid" use="literal"/>
      </wsdl:input>
      <wsdl:output>
        <soap:body parts="chargeSubscriberReturn" use="literal" />
      </wsdl:output>
    </wsdl:operation>
  </wsdl:binding>
  <wsdl:service name="PremiumCharging">
    <wsdl:port binding="tns:PremiumChargingBinding" name="PremiumChargingPort">
      <soap:address location="...location removed..."/>
    </wsdl:port>
  </wsdl:service>
</wsdl:definitions> 
```

我能够生成请求并接收响应（通过 Fiddler 捕获），但是在调用“chargeSubscriber”之后创建了实际响应对象（typeof StatusInfo），但值为零（对于 int 属性）和空字符串（对于字符串属性.)

这是在 Fiddler 中捕获的响应 XML 的示例：

```
<?xml version="1.0" encoding="utf-8"?>
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <soapenv:Body>
    <chargeSubscriberResponse soapenv:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
      <chargeSubscriberReturn href="#id0"/>
    </chargeSubscriberResponse>
    <multiRef id="id0" soapenc:root="0" soapenv:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xsi:type="ns1:StatusInfo" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:ns1="http://types.premiumcharging.verisign.com">
      <errorCode href="#id1"/>
      <errorDescription xsi:type="soapenc:string">Non-Carrier MIN</errorDescription>
      <transactionId href="#id2"/>
    </multiRef>
    <multiRef id="id2" soapenc:root="0" soapenv:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xsi:type="xsd:int" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/">2216</multiRef>
    <multiRef id="id1" soapenc:root="0" soapenv:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xsi:type="xsd:int" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/">-105</multiRef>
  </soapenv:Body>
</soapenv:Envelope> 
```

我已经读过某些命名空间和命名引用不匹配可能是一个问题，但我无法找到哪个。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:35:21.087

我能够通过创建一个客户端消息检查器来操纵响应，如下所述：

[如何绕过 WCF 缺少预览](http://keithelder.net/2008/01/15/How-to-Get-Around-WCFs-Lack-of-a-Preview-Web/)

连同@SixtoSeaz 建议的 SO 答案：

[所以回答](https://stackoverflow.com/questions/30171/why-wont-net-deserialize-my-primitive-array-from-a-web-service?answertab=votes#tab-top)

在客户端消息检查器的“AfterReceiveReply”方法中，我通过在引用 multiRef 项的每个节点上分配 InnerXml 来更改 SOAP 响应。然后，StatusInfo 响应对象确实根据需要填充了正确的值。

行为和 ClientMessageInspector：

```
public class MyBehavior :  IEndpointBehavior
{
    public void AddBindingParameters(ServiceEndpoint endpoint, BindingParameterCollection bindingParameters)
    {
    }

    public void ApplyClientBehavior(ServiceEndpoint endpoint, ClientRuntime clientRuntime)
    {
        clientRuntime.MessageInspectors.Add(new MyMessageInspector());
    }

    public void ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher)
    {
    }

    public void Validate(ServiceEndpoint endpoint)
    {
    }
}

public class MyMessageInspector : IClientMessageInspector
{
    public void AfterReceiveReply(ref Message reply, object correlationState)
    {
        XmlDocument doc = new XmlDocument();
        doc.LoadXml(reply.ToString());

        List<XmlElement> items = new List<XmlElement>();
        Dictionary<string, XmlElement> multiRefs = new Dictionary<string,XmlElement>();

        InspectNodes(doc.DocumentElement, items, multiRefs);

        FixNodes(items, multiRefs);

        MemoryStream ms = new MemoryStream();

        XmlWriter writer = XmlWriter.Create(ms);
        doc.WriteTo(writer);
        writer.Flush();
        ms.Position = 0;

        XmlReader reader = XmlReader.Create(ms);
        reply = Message.CreateMessage(reader, int.MaxValue, reply.Version);
    }

    public object BeforeSendRequest(ref Message request, IClientChannel channel)
    {
        return null;
    }

    private static void InspectNodes(XmlElement element, List<XmlElement> items, Dictionary<string, XmlElement> multiRefs)
    {
        string val = element.GetAttribute("href");
        if (val != null && val.StartsWith("#id"))
            items.Add(element);
        else if (element.Name == "multiRef")
            multiRefs[element.GetAttribute("id")] = element;

        foreach (XmlNode node in element.ChildNodes)
        {
            XmlElement child = node as XmlElement;
            if (child != null)
                InspectNodes(child, items, multiRefs);
        }

    }

    private static void FixNodes(List<XmlElement> items, Dictionary<string, XmlElement> multiRefs)
    {
        // Reverse order so populate the id refs into one single element. This is only a solution in relation to the WSDL definition.
        for (int x = items.Count - 1; x >= 0; x--)
        {
            XmlElement element = items[x];

            string href = element.GetAttribute("href");
            if (String.IsNullOrEmpty(href))
                continue;

            if (href.StartsWith("#"))
                href = href.Remove(0, 1);

            XmlElement multiRef = multiRefs[href];

            if (multiRef == null)
                continue;

            element.RemoveAttribute("href");
            element.InnerXml = multiRef.InnerXml;

            multiRef.ParentNode.RemoveChild(multiRef as XmlNode);
        }
    }

} 
```

然后将 Behavior 分配给 EndPoint（服务引用为 PMGReference）

```
MyBehavior behavior = new MyBehavior();
PMGReference.PremiumChargingPortTypeClient client = new PMGReference.PremiumChargingPortTypeClient();
client.Endpoint.Behaviors.Add(behavior); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:23:44.390

此 XML 模式定义：

```
 <xsd:complexType name="StatusInfo">
    <xsd:sequence>
      <xsd:element name="errorCode" type="xsd:int"/>
      <xsd:element name="errorDescription" type="xsd:string"/>
      <xsd:element name="transactionId" type="xsd:int"/>
    </xsd:sequence>
  </xsd:complexType> 
```

应该生成如下所示的 XML（以及 WCF 所期望的）：

```
 <StatusInfo>
      <errorCode>-105</errorCode>
      <errorDescription>Non-Carrier MIN</errorDescription>
      <transactionId>2216</transactionId>
  </StatusInfo> 
```

Java 服务正在创建 XML，该 XML 使用 WCF 序列化程序无法理解的 href/multiref 约定对。如果您能够更改服务配置，请查看此[表单帖子以了解如何避免这种类型的编码。](http://forum.springsource.org/showthread.php?58749-How-to-consume-multiref-in-a-Soap-body-using-WebServiceTemplate)另一种选择可能是采用生成的服务数据合同并按照此[SO 答案手动修改它们。](https://stackoverflow.com/questions/30171/why-wont-net-deserialize-my-primitive-array-from-a-web-service?answertab=votes#tab-top)

# javascript - RaphaelJS 2.1 与 1.5.2 getBBox 错误

> ID：10079066
> 
> 赞同：2
> 
> 时间：2012-04-09T20:03:52.780
> 
> 标签：javascript, raphael

我正在尝试创建一个类似于[http://raphaeljs.com/graffle.html](http://raphaeljs.com/graffle.html)的可拖动图形（适用于 1.5.2 和 2.1），但我想在框中包含文本。

我使用另一个问题中的建议添加了文本：[如何在 Raphael javascript 库中组合对象？](https://stackoverflow.com/questions/3679436/how-can-i-combine-objects-in-the-raphael-javascript-library)

该解决方案在 RaphaelJS 1.5.2 中运行良好，但在 RaphaelJS 2.1 中中断。

**jsFiddle 示例：http:** [//jsfiddle.net/ScBtZ/](http://jsfiddle.net/ScBtZ/)

我发现的唯一区别是`Element.getBBox()`返回的结果非常不同。

***样本：***

*在 1.5.2 中：*

```
SVGRect
  height: 40
  width: 100
  x: 526.5
  y: 25 
```

*在 2.1 中：*

```
Object
  height: 500780.9482062537
  width: 1009980
  x: 526.51
  x2: 1010506.51
  y: -399735.94795512746
  y2: 101045.00025112627 
```

我是否错过了从 v1.5 到 v2 的变化，或者这个奇怪的 BBox 是一个错误？有什么想法可以解决这个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T07:15:27.217

Raphael 2 getBBox 可能有点错误，但在您的情况下，您的数据是错误的。尝试删除数字周围的 "：

[http://jsfiddle.net/nhatcher/ScBtZ/9/](http://jsfiddle.net/nhatcher/ScBtZ/9/)

好例子！

（请注意，其他解决方案在 VML 中被破坏）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T19:27:05.723

我在接受答案后到达这里，但我仍然遇到一些问题。如果你像我一样，你可能想从 Raphael.js GitHub 上获取最新的开发版本： [https ://github.com/DmitryBaranovskiy/raphael/](https://github.com/DmitryBaranovskiy/raphael/)

拉斐尔似乎已经合并了安德烈亚斯的答案（在 1972 行，而不是写答案时的 1300 行）。Raphael 的最新开发版本对我有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T21:24:37.173

`getBBox`好吧，在 Raphael 中，似乎有人尝试用自定义实现替换本机方法。这背后的原因可能是原生的 getBBox 方法存在一些错误，并且它对某些形状返回了不正确的结果。另一个原因可能是浏览器的可移植性，我不确定 VML 中是否有 getBBox 方法。

但是，从您指出的值来看，这种自定义实现似乎有其缺陷。您可以通过以下代码在 Raphael 2.x 中使用本机 getBBox：

```
var bb1 = obj1.node.getBBox(),
    bb2 = obj2.node.getBBox(), 
```

我对其进行了测试，看起来不错：http: [//jsfiddle.net/ScBtZ/2/](http://jsfiddle.net/ScBtZ/2/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-16T08:32:40.660

如果您将**BBox**与**transformation**结合使用，Raphael 确实有错误。我找到了一个适合我的修复程序。

***raphael.js 中的第 1300 行***

```
var pathDimensions = R.pathBBox = function (path) {
    var pth = paths(path);
    if (pth.bbox) {
        return clone(pth.bbox) ; // FREEGROUP FIX!!!!!!
    }
    if (!path) {
        return {x: 0, y: 0, width: 0, height: 0, x2: 0, y2: 0};
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-30T08:58:37.490

安德烈亚斯的回答是对的......

也参考了[https://github.com/DmitryBaranovskiy/raphael/issues/543](https://github.com/DmitryBaranovskiy/raphael/issues/543)

如果您需要多次重复使用 getBBox() 函数，因为它在内部发生了变化，那么 clone 是正确的解决方法......

顺便说一句：感谢 Dimitry 的 Raphael.js，它确实是一项了不起的工作！

# wpf - 在 button_click 事件中绘图会使按钮消失？

> ID：10079067
> 
> 赞同：0
> 
> 时间：2012-04-09T20:04:03.870
> 
> 标签：wpf, button

我还是 WPF 的新手，在使用它时仍然面临一些问题。单击按钮时，我想画一些圆圈。我把绘制这个圆圈的说明放在了 button_click 的方法中，这意味着当我单击按钮时应该绘制圆圈。圆圈绘制正确，但我放置在表单中的所有按钮和工具都消失了。我想这是因为我在放置按钮的网格中绘制。那么有没有办法在某个边界内绘制圆圈或没有任何东西的东西消失？

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="449" Width="677">
<Grid Height="297" Width="460">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="181*" />
        <ColumnDefinition Width="279*" />
    </Grid.ColumnDefinitions>
    <Button Content="Button" Height="31" HorizontalAlignment="Left" Margin="185,-53,0,0" Name="button1" VerticalAlignment="Top" Width="94" Click="button1_Click" Grid.Column="1" />
</Grid> 
```

# c++ - 来自 QPixmap 的 QML 背景

> ID：10079068
> 
> 赞同：0
> 
> 时间：2012-04-09T20:04:06.507
> 
> 标签：c++, qt

如何使用在 QML 文件中声明的 C++ 对象设置背景，该文件通过其中一种方法返回 QPixmap。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:12:07.470

你需要实现 QDeclarativeImageProvider，[这里](http://kunalmaemo.blogspot.com/2011/12/using-qdeclarativeimageprovider-to-load.html)是示例代码。

# c++ - c++ 代码跳过获取行语句的问题

> ID：10079073
> 
> 赞同：0
> 
> 时间：2012-04-09T20:04:25.400
> 
> 标签：c++

嘿伙计们，我正在处理的任务有问题。

代码如下：

```
#include <iostream>
#include <fstream>
#include <iomanip>
#include <cmath>
#include <cstdio>
#include <cstring>

using namespace std;

class payroll
{
private:
    char empnum[10];
    char empfirstname[150];
    char emplastname[150];
    char empsin[9];
    char empdob[10];
    char empphone [15];
    char empstreet[100];
    char empcity[60];
    char empprovince[150];
    char empcountry[200];
    char empstatus[50];       //Employee status. EX: Terminated, On leave, Active etc.
    int empsalaryei;
    int empsalaryfedtax;
    int empsalarycpp;
    int empsalarynet;
    int empsalarygross;

public: 
    void addrec(void);
    void modrec(void);
    void viewrec(void);
    void exit(void);
};

payroll rec;
payroll emp;
ifstream inFile1;
ifstream inFile2;
bool check = false;

int main()
{
    system("CLS");
    char ch;

    do
    {
        cout<<"1\. Add an employee\n";
        cout<<"2\. Modify employee record\n";
        cout<<"3\. View employee record\n";
        cout<<"0\. Exit\n";
        cout<<"Please choose an item: ";
        if (check == true)
        {
            system("CLS");
            ch=0;
        }
        else
            cin>>ch;

        switch(ch)
        {
            case '1':
                emp.addrec();
                break;

            case '2':
                emp.modrec();
                break;

            case '3':
                emp.viewrec();
                break;

            case '0':
                emp.exit();
                return 0;
        }
    }while(ch !=0);

    return 0;

}

void open_employee_info()               //function to open employee data file
{
    string filename1 = "employee-details.dat";        //define which file to open 

    inFile1.open(filename1.c_str());  //open our payroll file
    if(inFile1.fail())                                                       //if our file open fails....
    {
        cout << "\nSorry the file was not opened successfully"<< "\n Please check that the file does exist or create it" << endl;
        exit(1);
    }
    cout << "\n The file was opened successfully" << endl;
}

void open_payroll_info()               //function to open payroll salary information file
{
    string filename2 = "payroll-info.dat";          //define file name

    inFile2.open(filename2.c_str());
    if(inFile2.fail())
    {
        cout << "\nSorry the file was not opened successfully"<< "\n Please check that the file does exist or create it" << endl;
        exit(1);
    }
    cout << "\n The file was opened successfully" << endl;
}

void payroll::addrec(void)          //Record adding
{
    char userinputadd = ' ';

    cout << "\nPlease Enter the Employee number: ";
    gets(rec.empnum);
    cout << "\nPlease Enter the Employee's First Name: ";
    gets(rec.empfirstname);
    cout << "\nPlease Enter the Employee's Last Name: ";
    gets(rec.emplastname);
    cout << "\nPlease Enter the Employee's Date of Birth (mmddyyyy): ";
    gets(rec.empdob);
    cout << "\nPlease Enter the Employee's Social Insurance Number: ";
    gets(rec.empsin);
    cout << "\nPlease Enter the Employee's Phone Number: ";
    gets(rec.empphone);
    cout << "\nPlease Enter the Employee's Address: ";
    gets(rec.empstreet);
    cout << "\nPlease Enter the Employee's City: ";
    gets(rec.empcity);
    cout << "\nPlease Enter the Employee's Province: ";
    gets(rec.empprovince);
    cout << "\nPlease Enter the Employee's Country: ";
    gets(rec.empcountry);
    cout<<"\nPlease Enter the Employee's Status: ";
    gets(rec.empstatus);
    cout << "\nPlease Enter the Employee's Weekly Gross Salary: ";
    cin >> rec.empsalarygross;

    cout<<"Would you like to return to the main menu?(y), else the program will exit: ";
    cin>>userinputadd;
    if (userinputadd =='y' || userinputadd =='Y')
        main();
    else
        exit();
}

void payroll::modrec(void)          //Record Modification
{
    system("CLS");
    int empmodnum=0;
    check = false;
    char userinputmod = ' ';

    cout<<"\nEnter the employee number for the record you would like to modify: ";
    cin>>empmodnum;

    cout<<"Would you like to return to the main menu?(y), else the program will exit: ";
    cin>>userinputmod;
    if (userinputmod =='y' || userinputmod =='Y')
        main();
    else
        exit();
}

void payroll::viewrec(void)         //Record viewing
{
    system("CLS");
    check = false;
    char userinputview = ' ';

    cout<<"Would you like to return to the main menu?(y), else the program will exit: ";
    cin>>userinputview;
    if (userinputview =='y' || userinputview =='Y')
        main();
    else
        exit();

}

void payroll::exit(void)
{
    inFile1.close();
    inFile2.close();
    check = true;
} 
```

因此，如果您在前面的菜单中按 1 添加记录，您会看到它跳过了第一个 cin 语句，即员工编号。

有谁知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:08:50.590

按 1 后，您将在输入流中留下换行符。

考虑您正在键入的所有键。如果您为 addrec 输入“1”，然后输入员工 ID 987，然后输入姓名“John”，您的输入流如下所示：

```
1, \n, 9, 8, 7, \n, J, o, h, n, \n 
```

您用 读取第一个字符`cin >> ch`。您拥有的下一个输入语句是`gets()`.

`gets()`正确读取直到下一个换行符的所有字符。由于您仍然有后面的换行符，`'1'`因此第一行将被读取为空白。

尝试将其添加到您的程序中：

```
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:14:52.547

您可能有缓冲区问题，因此您需要刷新标准输入。查看谷歌了解详情。

# c# - 我必须做什么才能访问我自己的公共方法？

> ID：10079074
> 
> 赞同：1
> 
> 时间：2012-04-09T20:04:29.097
> 
> 标签：c#, .net, winforms

我在我的项目中创建了名为 Classes、Forms 和 Models 的文件夹。

假设我的项目名为 ABC，因此文件夹层次结构为：

```
ABC
    Classes
    Forms
    Models 
```

在 \Models\ 中，我有一个名为 ApplicationModel.cs 的类，它包含一个名为 GetApplications() 的公共方法。

但是，当我从同一个 ABC 项目的其他地方调用该方法时，我得到“当前上下文中不存在名称‘GetApplications’”

我已经添加：

```
using ABC.Models; 
```

到调用类，但这没有区别。我右键单击 GetApplications() 以希望在那里看到“解决”，但不行。

我必须做什么才能访问我自己的公共方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T20:09:37.090

`GetApplications()`查看它的定义和尝试调用它的代码会很有帮助，但我假设它是类的[静态](http://msdn.microsoft.com/en-us/library/79b3xss3(v=vs.100).aspx)方法或实例方法`ApplicationModel`。在任何一种情况下，您都可能`ApplicationModel`使用 using 语句让您的代码知道类的命名空间，但是必须在类或类的实例上调用该方法，如下所示：

如果`GetApplications`是静态方法，

```
var applications = ApplicationModel.GetApplications(); 
```

如果是实例方法：

```
var appModel = new ApplicationModel(); // or, retrieve the instance from elsewhere...

var applications = appModel.GetApplications(); 
```

一种或另一种方式，您必须引用包含的类`GetApplications`才能调用它。如果这不能帮助您解决问题，请编辑您的问题以包含方法的定义和调用代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:09:07.930

听起来您正在使用静态函数。你忘记了 static 关键字吗？

静态函数从类而不是对象“运行”：

```
public static string[] GetApplications() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T20:10:46.850

如果没有一些关于如何尝试调用该方法的代码，很难给出明确的建议。我可以想到两种可能的方法：

*   要么您尝试通过`ApplicationModel` *类*( `ApplicationModel.GetApplications()`) 调用该方法，在这种情况下您需要声明该方法`static`
*   或者您需要在对象上调用该方法，但您使用的是该类型——在这种情况下，声明/创建一个类型的对象`ApplicationModel`并在该对象上调用该方法；（例如`ApplicationModel model = new ApplicationModel(); model.GetApplications();`）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T04:36:45.533

看起来该课程未标记为公开。

你的课应该是

```
 namespace ABC 
  {
    namespace Models
    {
        public class ApplicationModel  //class needs to be public is accessed outside the namespace
        {

        }
    }
  } 
```

# ios - iPhone应用程序，如何处理带有动态内容的后退按钮

> ID：10079083
> 
> 赞同：0
> 
> 时间：2012-04-09T20:05:15.620
> 
> 标签：ios, ios5, uitabbarcontroller

我有一个从 api 调用加载记录的选项卡栏控制器视图。由于每个选项卡上的同一记录显示不同的数据，我将对象存储在应用程序委托中，并在 viewDidLoad 上抓取它。

我遇到的问题是该记录与其他记录相关，并且其中一个选项卡列出了其他记录。因此，如果您单击其中一个，它实际上需要重新加载相同的标签栏控制器。

我将使用 instantiateViewControllerWithIdentifer 方法重新加载同一个控制器，但是后退按钮将如何工作，因为如果它返回该对象现在已经消失了。

我对重新加载旧对象的想法是保留加载记录的所有 id 的数组，然后返回到最后一个 id 并从 api 重新加载对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:31:45.633

对于您正在尝试做的事情，我建议您创建自己的标签栏控制器的自定义实现。通过这样做，您将能够将每个记录中的数据作为属性存储在您的自定义标签栏控制器中。然后，您可以拥有标签栏控制器的多个实例，每个实例都有自己的数据（并且您不必在应用程序委托中存储任何内容，理想情况下无论如何都不应该将其用于此目的。）

这是一个示例教程，作者在其中创建了一个类似于您需要的自定义标签栏控制器：

[http://www.iphonedevcentral.com/create-uitabbarcontroller/](http://www.iphonedevcentral.com/create-uitabbarcontroller/)

# c# - MVC2 HTML 链接 - 这是正确的，还是有更好的方法？

> ID：10079086
> 
> 赞同：1
> 
> 时间：2012-04-09T20:05:37.600
> 
> 标签：c#, asp.net-mvc-2, hyperlink

我已经有一年多没有做过 MVC2（或任何 MVC）了，虽然这很有效，但我想确保它是最好的方法。

我有一个“启动”页面，允许用户选择他们想要处理的内容；接口、事件、参数或任务。HTML 是：

```
<a href="/Interfaces/Index">
    <div id="homeInterfaces" class="homeLinks">
        <h1>Interfaces</h1>
        <h2>Create, Edit or Delete Interfaces</h2>
    </div>
</a>
<a href="/Tasks/Index">
    <div id="homeTasks" class="homeLinks">
        <h1>Tasks</h1>
        <h2>Create, Edit or Delete Tasks</h2>
    </div>
</a>
<a href="/Parameters/Index">
    <div id="homeParameters" class="homeLinks">
        <h1>Parameters</h1>
        <h2>Create, Edit or Delete Parameters</h2>
    </div>
</a>
<a href="/Events/Index">
    <div id="homeEvents" class="homeLinks">
        <h1>Events</h1>
        <h2>Create, Edit or Delete Events</h2>
    </div>
</a> 
```

链接工作并转到相应的页面，但无论出于何种原因，我不确定这是否是正确的方法。我有每个控制器，适当的文件夹，每个文件夹都有索引视图。我不认为我应该使用 Html.ActionLink，但也许我应该使用其他东西。有什么想法吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:11:20.113

是的，你应该为这些使用助手。这将确保您生成的链接使用适当的路由，如果您对 URL 做任何花哨的事情或部署到非根路径（即`/`） ，这将使您的生活更加轻松

在您的情况下，最简单的解决方案是将 URL 替换为`@Url.Action`. 我会使用它，`Html.ActionLink`因为`Html.ActionLink`不会让您轻松链接比简单文本更复杂的内容（例如您的 html）。

```
<a href="@Url.Action("Index", "Interfaces")">
  <div id="homeInterfaces" class="homeLinks">
    <h1>Interfaces</h1>
    <h2>Create, Edit or Delete Interfaces</h2>
  </div>
</a> 
```

如果您不使用 Razor，请先切换到该版本。这很值得。或者放下`@`标志并添加一些`<%= ... %>`.

不过，正如@MichalFran 指出的那样，如果它现在有效，您可以随时开始遵循此建议，并在/如果您需要继续前进时重新审视您已经完成的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:31:28.920

这个答案不是独立的。我将其发布为我喜欢[的 Michael Haren 答案的补充。](https://stackoverflow.com/a/10079168/304832)

我想作为“想法”添加的另一件事是[T4MVC](http://mvccontrib.codeplex.com/wikipage?title=T4MVC)。我是它的忠实粉丝，因为它可以帮助你摆脱`@Url.Action`和`@Html.Action`. 例如，以 Michael 的示例代码为例：

```
<a href="@Url.Action("Index", "Interfaces")">
    ... 
```

使用 T4MVC，您可以摆脱魔术字符串，并像这样呈现路由 URL：

```
<a href="@Url.Action(MVC.Interfaces.Index())"> 
```

然后，如果您重命名`InterfacesController`或重命名/更改`Index()`操作方法的签名，**视图将无法编译，而不是在运行时获得 404**。

另一个很酷的事情是，您可以将参数传递给路由引擎，就好像您正在调用操作方法一样：

```
public ActionResult ById(int entityId) { ... } 

<a href="@Url.Action(MVC.Interfaces.Index(Model.EntityId))">
    ... 
```

我不知道为什么更多的人不发布这个！

# c - C函数的隐式int返回值

> ID：10079089
> 
> 赞同：30
> 
> 时间：2012-04-09T20:05:49.320
> 
> 标签：c, function, legacy-code

我用谷歌搜索，似乎无法找到这个简单问题的答案。

使用遗留代码库（最近移植到 Linux，并慢慢更新到新的编译器），我看到了很多

```
int myfunction(...)
{
// no return...
} 
```

我知道函数的隐式返回 TYPE 是 int，但是当没有指定返回时，隐式返回 VALUE 是什么。我已经测试并得到了 0，但这仅适用于 gcc。这个编译器是特定的还是标准定义为 0？

编辑：12/2017 调整了接受的答案，基于它引用了更新版本的标准。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-09T20:12:35.570

从新约中引用的'89标准：

> 从函数的末尾流出相当于没有表达式的返回。在任何一种情况下，返回值都是未定义的。

该标准通常表达预先存在的实现的实际行为。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-09T20:30:47.377

这样的事情是可能的，但前提是函数的返回值从未被使用过。C11 标准在第 6.9.1 段中说：

> 如果到达终止函数的 }，并且调用者使用了函数调用的值，则行为未定义。

（AFAIR 以前版本的标准有类似的措辞）

因此，将您必须使用的所有此类函数转换为函数将是一个好主意`void`，因此此类函数的任何用户都不会被诱惑使用返回值。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-04-09T20:32:10.027

return 语句永远不会在函数末尾强制执行，即使函数返回类型不是`void`。不需要诊断，也不是未定义的行为。

示例（定义的行为）：

```
int foo(void)
{
}

int main()
{
    foo();
} 
```

但是读取 的返回值`foo`是未定义的行为：

```
int bla = foo();  // undefined behavior 
```

来自 C 标准：

> （[C99](https://en.wikipedia.org/wiki/C99)，第 12 页上的 6.9.1）“如果到达终止函数的 }，并且调用者使用了函数调用的值，则行为未定义。”

该`main`函数是该规则的一个例外，就好像`}`在它中到达的`main`一样，就好像有一个`return 0;`语句一样。

> （[C99 草案](http://www.open-std.org/jtc1/sc22/WG14/www/docs/n1256.pdf)，第 13 页上的 5.1.2.2.3）...到达`}`终止`main`函数的返回值 0。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-04-09T20:12:36.253

那只是未定义的行为；如果您不填充返回区域（例如，通常是[x86 系列处理器上的 eax/rax](http://en.wikipedia.org/wiki/X86_calling_conventions)），它将具有最后通过函数中的某些副作用设置的值。

请参阅[对于不返回 void 的 C++ 函数是否必须使用 return 语句？](https://stackoverflow.com/questions/2784075/is-a-return-statement-mandatory-for-c-functions-that-do-not-return-void)这基本上是这个问题的副本（除了它被标记为 C++）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-09T20:19:08.893

如果`return`语句始终不返回值，则最好将函数转换为并声明为返回`void`：

```
void myfunction(...)
{
    ...
    return;
    ...
} 
```

如果函数中有一些`return expr;`和一些`return;`语句，那么您需要确定哪个是更好的行为，并使它们保持一致——要么总是返回一个值并将类型保留为原样，`int`要么从不返回一个值并将类型更改为`void`.

请注意，您需要声明修改为返回的函数`void`（在标头中，除非它们是 - 或应该是 -`static`并隐藏在单个源文件中），因为默认返回类型（假定的返回类型）`int`不再有效。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-09T20:13:55.850

在该函数中它可能始终为零，但在大多数体系结构（当然是 x86）上，return 语句将特定寄存器的内容移动到堆栈上的特定位置，调用者将检索该位置并将其用作其返回函数。

return 语句会将传递给它的变量放在该位置，以便它成为不同的值。我没有放置特定返回语句的经验是，返回的内容是相当随机的，您不能依赖它是同一件事。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-09T20:12:39.640

我确信对于返回类型不是`void`省略`return`语句的函数来说，这是未定义的行为。在 C99 中有一个例外`main`，如果`return`省略该语句，则假定它隐式返回 0，但这不适用于任何其他函数。

它可能适用于特定的平台/编译器组合，但您永远不应该依赖这些细节。在代码中使用任何类型的未定义行为都会使其不可移植。但是，在遗留代码中看到未定义的行为是很常见的。

# iphone - AudioQueue 输出回调仅触发 3 次（nBuffers 次）

> ID：10079090
> 
> 赞同：1
> 
> 时间：2012-04-09T20:05:50.683
> 
> 标签：iphone, audioqueue

当我使用 启动音频输出过程时`AudioQueueStart(out.queue, nil)`，输出回调仅触发 3 次（这是分配的缓冲区数）。

这是我的输出回调代码：

```
static void AQOutputCallback(void* aqr,
                             AudioQueueRef outQ,
                             AudioQueueBufferRef outQB)
{
  AQCallbackStruct *aqc = (AQCallbackStruct *) aqr;

  NSLog(@"Out");

  // Check if AudioQueue is stopped
  if (!aqc->run) {
    NSLog(@"Stopped");
    return;
  }

  // Processing data

  // Check enqueue error
  int err = AudioQueueEnqueueBuffer(outQ, outQB, 0, NULL);
  if (err != noErr) NSLog(@"OutputCallback AudioQueueEnqueueBuffer() %d ", err);
  NSLog(@"Enqueued");
} 
```

我认为这是由于缺少缓冲区，但我的输出是：

```
Out
Enqueued
Out
Enqueued
Out
Enqueued 
```

所以第一个缓冲区在 AudioQueue 开始填充第三个缓冲区之前入队，它不应该用完缓冲区。

这里会发生什么？

## 编辑：设置代码

```
#define AUDIO_BUFFERS 3

typedef struct AQCallbackStruct {
  AudioStreamBasicDescription mDataFormat;
  AudioQueueRef queue;
  AudioQueueBufferRef mBuffers[AUDIO_BUFFERS];
  unsigned long frameSize;
  BOOL *run;
} AQCallbackStruct;

// In some method
AQCallbackStruct out;

out.mDataFormat
out.mDataFormat.mFormatID = kAudioFormatLinearPCM;
out.mDataFormat.mSampleRate = 44100.0;
out.mDataFormat.mChannelsPerFrame = 2;
out.mDataFormat.mBitsPerChannel = 16;
out.mDataFormat.mBytesPerPacket =
  out.mDataFormat.mBytesPerFrame =
    out.mDataFormat.mChannelsPerFrame * sizeof(short int);
out.mDataFormat.mFramesPerPacket = 1;
out.mDataFormat.mFormatFlags =
    kLinearPCMFormatFlagIsBigEndian
  | kLinearPCMFormatFlagIsSignedInteger
  | kLinearPCMFormatFlagIsPacked;

out.frameSize = 735;

int err;
err = AudioQueueNewOutput(&out.mDataFormat,
                          AQOutputCallback,
                          &out,
                          CFRunLoopGetCurrent(),
                          kCFRunLoopCommonModes,
                          0,
                          &out.queue);

if (err != noErr) NSLog(@"AudioQueueNewOutput() error: %d", err);

for (int i=0; i<AUDIO_BUFFERS; i++) {         
  err = AudioQueueAllocateBuffer(out.queue, out.frameSize, &out.mBuffers[i]);
  if (err != noErr) NSLog(@"Output AudioQueueAllocateBuffer() error: %d", err);
  out.mBuffers[i]->mAudioDataByteSize = out.frameSize;

  err = AudioQueueEnqueueBuffer(out.queue, out.mBuffers[i], 0, NULL);
  if (err != noErr) NSLog(@"Output AudioQueueEnqueueBuffer() error: %d", err);
}

AudioQueueStart(out.queue, nil); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T09:51:54.113

我终于发现问题出在哪里：[AudioQueue callback in simulator but not on device](https://stackoverflow.com/questions/5218335/audioqueue-callback-in-simulator-but-not-on-device/)

但是，输出回调在模拟器中正确触发，但在我的设备上没有，我仍然不知道为什么 AudioSession 设置存在差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:56:14.627

请查看此页面：[从哪里开始在 iPhone 上进行音频合成](https://stackoverflow.com/questions/2067267/where-to-start-with-audio-synthesis-on-iphone)。

那里的 BleepMachine 示例代码是我开始使用它的原因。

# r - 使用 for 循环检索两个数据帧之间的匹配行

> ID：10079093
> 
> 赞同：1
> 
> 时间：2012-04-09T20:05:57.057
> 
> 标签：r

我一直在尝试这样做，但没有成功。任何帮助将不胜感激。

```
df1 <- data.frame(chrom = "chr1", start=c(10,20,30), end = c(100,200,300), stringsAsFactors=FALSE)
df2 <- data.frame(chrom = c("chr1", "chr2", "chr3"),start=c(15,500,150), end = c(75,1000,300), stringsAsFactors=FALSE) 
```

我想获取 df2 where 的所有行`df1$chrom == df2$chrom`。或者更好：我想在新向量中生成输出并显示 df1 的行，然后显示 df2 ，反之亦然 where `df1$chrom == df2$chrom`。

我已经尝试过使用 for 循环，如下所示：

```
for(i in 1:nrow(df2)){
    x[i] <- df2[which(df1$chrom == df2$chrom[i])]
} 
```

不工作！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:16:19.537

这是你想要的吗？

```
df2[df2$chrom == df1$chrom, ]
#   chrom start end
# 1  chr1    15  75 
```

根据您的评论，您可能还想尝试以下操作。

```
merge(df1, df2, by = 'chrom') 
```

这将在两个框架（“表”）上执行数据库“连接”。结果是这样的。

```
 chrom start.x end.x start.y end.y
1  chr1      10   100      15    75
2  chr1      20   200      15    75
3  chr1      30   300      15    75 
```

采用 R 并不总是一种有效的方法，但它很方便。您可以使用参数控制“.x”内容（请参阅帮助页面：?merge）。如果您希望包含 df2 中的所有字段，则可以添加“all = TRUE”参数设置以进行合并。

正如我之前提到的，最好考虑整体方法。这不一定是处理数据的有效方法，因为现在您已在结果帧中输入了大量冗余。相反，在数据库术语中，我们将 df2 视为“查找”表。df1 中的“chr1”引用了 df2（外键）中与 df1 相关联但与之不同的信息。而不是如上面的合并所示，重复 df2 的信息，我们可以在需要时简单地访问它。这就是合并方便的地方。

# escaping - SOQL 转义字符

> ID：10079095
> 
> 赞同：4
> 
> 时间：2012-04-09T20:06:09.177
> 
> 标签：escaping, salesforce, soql

我正在尝试让我的 Escape 角色在 Force.com 资源管理器中工作。

这正是 Salesforce 中数据的样子，

等待托管人数据 - 等待“8”

我需要使用这样的查询语句过滤这些数据，

其中 policy__r.Policy_Status__c = '等待保管人数据 - 待定'8''

这是我尝试过的，但我无法开始工作，

'等待托管人数据 - 待定 \'8\''

'等待托管人数据 - 待定''8'''

'等待保管人数据 - 待处理 \'\8\'\'

'等待托管人数据 - 待定'8''

“等待保管人数据 - 待定“8””

我不知道什么在这里不起作用，有人知道吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T20:13:59.450

SOQL 要求 ' 用 \ 转义，这会让你

```
where policy__r.policy_status__c='awaiting custodian data - pending \'8\'' 
```

（适用于soap api），如果您在apex中构建此字符串，那么\'也是apex中的转义序列，因此您需要将其转义为类似`\\\'8\\\'`

# java - 使用 ProcessBuilder 运行 ImageMagick 命令

> ID：10079098
> 
> 赞同：1
> 
> 时间：2012-04-09T20:06:24.440
> 
> 标签：java, imagemagick, processbuilder

我正在尝试从 Java 类运行一个简单的 ImageMagick 命令，并且由于我只需要运行一些我认为而不是使用 Im4Java 的命令，因此我可以直接使用 ProcessBuilder.start()。我正在使用以下代码-

```
ProcessBuilder pb = new ProcessBuilder("convert","pic2.png","pic52.png");
          pb.directory(new File("/user/gaurav_kl"));
         pb.start(); 
```

但我收到错误 IOException - Cannot run program "convert" (in directory "/user/gaurav_kl"): error=2, No such file or directory 这可能是什么原因。当我从终端运行相同的命令时，它可以从任何 Dir 正常工作，因为 IM 已添加到类路径

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T22:04:43.597

ProcessBuilder 在搜索可执行命令时的行为取决于系统/jvm。虽然您可能期望它使用与底层 shell（即 BASH）相同的逻辑，但[文档](http://docs.oracle.com/javase/6/docs/api/java/lang/ProcessBuilder.html)中并不能保证它。

根据您（和其他人）的经验，最好提供完整的命令路径。例如：

```
String IMGK_PATH="/usr/local/magick/bin";
ProcessBuilder pb = new ProcessBuilder(IMGK_PATH + "/convert","pic2.png","pic52.png");
pb.directory(new File("/user/gaurav_kl"));
pb.start(); 
```

# html - 标题栏宽度问题

> ID：10079105
> 
> 赞同：1
> 
> 时间：2012-04-09T20:06:41.390
> 
> 标签：html, css

我正在尝试制作一个延伸到我的网页顶部的“栏”（如 Facebook）。然后我在右边有一些导航链接。但是，如果您调整页面大小，然后使用水平滚动条，则缺少红色背景。

[http://jsfiddle.net/ejJnL/embedded/result/](http://jsfiddle.net/ejJnL/embedded/result/)

[http://jsfiddle.net/ejJnL/](http://jsfiddle.net/ejJnL/)

```
<div class="header-container">
    <div class="header">
        <ul class="main-navigation">
            <li><a href="#">A</a></li>
            <li><a href="#">B</a></li>
            <li><a href="#">C</a></li>
            <li><a href="#">D</a></li>
            <li><a href="#">E</a></li>
        </ul>
        <div class="clear"></div>
    </div>
</div> 
```

CSS：

```
.header-container {
    background-color: red;
    height: 40px;
    width: 100%;
}

.header {
    height: 100%;
    line-height: 40px;
    margin: 0 auto;
    width: 960px;
}

.header img {
    vertical-align: middle;
}

.main-navigation {
    float: right;
    list-style: none;
    margin: 0;
    padding: 0;
}

.main-navigation li {
    float: left;
}

.main-navigation a {
    color: #ffffff;
    font-weight: bold;
    text-decoration: none;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:33:44.690

```
.header-container {
    background-color: red;
    height: 40px;
    position: fixed:
    left: 0;
    right: 0;
} 
```

1.  Fix the position and declare it attached to the left and right edges of the viewport as shown above.

2.  You don't need declarations of width: 100% or height: 100% as `div` are already block elements and will fill their containers.

3.  You should declare `body { margin:0}` if you want the bar to extend to the page edges.

4.  You should probably use `max-width` not `width` for your `.header` so the menu still shows in a small window.

5.  You may also want to add an `overflow: none` to the `.header-container`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:47:50.547

[http://jsfiddle.net/SbpZG/](http://jsfiddle.net/SbpZG/)

`.header-container`上和`position: relative`上的固定宽度`.main-navigation`

# java - 算法：将 y 个球放入 x <= y 的 x 个盒子中

> ID：10079106
> 
> 赞同：4
> 
> 时间：2012-04-09T20:06:42.930
> 
> 标签：java, algorithm

我在 Android 上开发应用程序时遇到了一个问题。然而，问题是：

有`x`盒子和`y`球的地方`x <= y`，我想把球**按顺序放在盒子里**。例如：3盒；`box A`,`box B`和`box C`- 和 5 个球; `ball 1`, `ball 2`, `ball 3`, `ball 4`, `ball 5`.

我需要的是把第一个球`ball 1`放在里面`box A`，`ball 5`里面`box C`和其他的球都分布在它们之间（如果一个盒子的球比其他的多，这无关紧要）。这是一个模拟问题的循环（缺少增量值）：

```
int boxCount = 0; // first box is 0 and last box is x
int numOfBalls = y;
for(int i = 0; i < numOfBalls; i++, boxCount += ???)
{
    boxes.get(boxCount).add(balls.get(i));
} 
```

我应该使用什么方程来代替`???`解决问题？

* * *

**编辑：**

由于`x <= y`，这意味着：

*   没有一个框应该是空的。
*   盒子的球数之差不应大于1。

* * *

**编辑2**

，`in order`我的意思是：

```
A   B   C
---------
1   3   5
2   4 
```

不是

```
A   B   C
---------
1   2   3
4   5 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:12:08.487

您可以在第一个盒子`(int)n/k`中的每个盒子中分配球，`k-1`在最后一个盒子中分配其余的球。这将是最简单的编码。

有了这个：`boxCount += (i % (numOfBalls/numOfBoxes) == 0 && boxCount < numOfBoxes-1 ? 1 : 0)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T20:27:06.340

```
int flag;
int lastBallAdded = 0;
int k = numOfBalls/numOfBoxes;
int m = numOfBalls%numOfBoxes;

for(int i = 0; i < numOfBoxes; i++, lastBallAdded+=k+flag) {
    flag = i<m;

    for(int j=lastBallAdded;j<lastBallAdded + k + flag;j++) 
        boxes.get(i).add(balls.get(j));
} 
```

这是此解决方案背后的原因：

根据问题的定义，算法应该`k= numOfBalls/numOfBoxes`在每个盒子里放球，除了第一个`m = numOfBalls%numOfBoxes`盒子，你应该放`k+1`球。

您也可以将其写为

```
int i;
for(i = 0; i < m; i++) {
    //add k+1 balls
}

for(;i<numOfBoxes; i++) {
    //add k balls
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T20:49:18.233

```
int ball = 0;
for( int box = 0; box < x; ++box )
   while ( x * (ball+1) <= y * (box+1) )
      boxes.get(box).add(balls.get(ball++)); 
```

循环不变：左边的`k`盒子包含`k/x`球的一部分（圆形）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T20:29:16.107

好的，新的尝试：

```
boxCount = ((i * nbrOfBoxes) / nbrOfBalls) + 1; 
```

请注意，球的索引从 0 到 4 编号（如在 for 循环中）。删除`+ 1`if yo 希望 boxCount 从零开始。

# python - pymongo 排序和 find_one 问题

> ID：10079107
> 
> 赞同：17
> 
> 时间：2012-04-09T20:06:47.993
> 
> 标签：python, mongodb, pymongo

我正在尝试`user_score`使用 key对调用的集合进行排序`position`并获取结果的第一个文档。在这种情况下，集合`user_score`不存在，我希望得到结果`None`，但我得到了一个光标。

1\. 结果 =

```
db.user_score.find({'score':'$lt':score}}).sort("position,pymongo.DESCENDING").limit(1) 
```

现在我改变了我的查询，如下所示，没有得到任何预期的结果。

2\. 结果 =

```
db.user_score.find_one({'score':{'$lt':score}}, sort=[("position", pymongo.DESCENDING)]) 
```

我的第一个查询有什么问题？

谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2018-02-04T11:19:59.757

我的回复有点晚了，但看起来 PyMongo 的当前版本确实支持对 find_one 调用进行[排序](http://api.mongodb.com/python/current/api/pymongo/cursor.html#pymongo.cursor.Cursor.sort)操作。

从[此处](http://api.mongodb.com/python/current/api/pymongo/collection.html)的文档页面（请查找 find_one 部分）：

> find() 的所有参数也是 find_one() 的有效参数，尽管任何限制参数都将被忽略。返回单个文档，如果没有找到匹配的文档，则返回 None。

示例用法如下：

```
filterdict = {'email' : 'this.is@me.com'}
collection.find_one(filterdict, sort=[('lastseen', 1)]) 
```

希望这可以帮助更多最近的搜索者！

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-12-27T15:59:25.447

在您的第一个查询中，在您传递一个参数的排序函数中`("position,pymongo.DESCENDING")`，当您应该传递两个参数时`("position", pymongo.DESCENDING)`。

请务必注意引号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T20:31:50.063

这是 find 的默认 mongodb 行为。每当你使用`find`时，你都会得到一个结果列表（在这种情况下是一个可迭代的游标）。只有- 或者如果查询没有匹配`findOne`项，它的 PyMongo 等效项`find_one`将返回。`None`

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2016-09-30T00:20:45.197

使用 list 将光标的值转换为 dict：

`list(db.user_score.find({'score':'$lt':score}}).sort("position",pymongo.DESCENDING).limit(1))[0]`

# javascript - 分配 InfoWindows 数组元素结果未定义

> ID：10079109
> 
> 赞同：0
> 
> 时间：2012-04-09T20:07:01.877
> 
> 标签：javascript, google-maps-api-3

我正在尝试使用以下代码生成多个 InfoWindows：**编辑：**为了澄清，我希望所有窗口同时打开。

```
 for (var i = 0; i < 3; i++) {
      var markerOptions = {position:point[i], map:map};
      var marker = new google.maps.Marker(markerOptions);
      content = "Hello " + i;
      infowindow[i] = new google.maps.InfoWindow({content: content}); 
      google.maps.event.addListener(marker, 'mouseover', function()
      {
        infowindow[i].open(map,this);   
      });
    } 
```

[（完整来源）](http://jsfiddle.net/wR8PB/1)

但是，我在 Chrome 中收到以下错误：Uncaught TypeError: Cannot call method 'open' of undefined。

当我使用普通变量“infowindow”而不是数组时，单个 infowindow 会按预期显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:14:02.043

您只能创建一个 infoWindow。我在这样的项目中使用过：

```
var infowindow = new google.maps.InfoWindow();

for (var i = 0; i < 3; i++) 
{
    var markerOptions = {position:point[i], map:map, html:'Hello' };
    var marker = new google.maps.Marker(markerOptions);

    google.maps.event.addListener(marker, 'mouseover', function()
    {
        infowindow.setContent(this.html); // this is the trick: html attribute on markerOptions :), I used a array here
        infowindow.open(map,this);   
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:13:03.353

您是否将 infowindow[i] 输出到控制台（firebug）以查看它是否是您所期望的？我认为通常这样做的方法是生成一个 infowindow 对象并重用/移动和更改 infowindow 的内容。

这个链接可能很方便：http://www.svennerberg.com/2009/09/google-maps-api-3-infowindows/

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T20:13:47.523

工作样本

```
 var map;
      var mapOptions = { center: new google.maps.LatLng(0.0, 0.0), zoom: 2,
        mapTypeId: google.maps.MapTypeId.ROADMAP };
      var infowindow = new google.maps.InfoWindow();
      function initialize() {
        map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
        point = [];
        point[0] = new google.maps.LatLng(0.0,0.0);
        point[1] = new google.maps.LatLng(0.0,10.0);
        point[2] = new google.maps.LatLng(0.0,20.0);

          for (var i = 0; i < 3; i++) {
                var content = "Hello"+i;
                addInfowindows(point[i], content )             
          }
      }
function addInfowindows(point, content){

          var markerOptions = {position:point, map:map};
          var marker = new google.maps.Marker(markerOptions);

          google.maps.event.addListener(marker, 'mouseover', function()
          {
            infowindow.setContent(content);
            infowindow.open(map,this);   
          });

}
 google.maps.event.addDomListener(window, 'load', initialize); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T14:47:41.653

为了完成我想要的，我了解到需要[一个闭包](https://stackoverflow.com/a/10095428/1238040)：

```
for (var i = 0; i < 3; i++) 
{
  (function(i) {
    var markerOptions = {position:point[i], map:map, html:'Hello' };
    var marker = new google.maps.Marker(markerOptions);

    google.maps.event.addListener(marker, 'mouseover', function()
    {
        infowindow.setContent(this.html); // this is the trick: html attribute on markerOptions :), I used a array here
        infowindow.open(map,this);   
    });
  })(i);
} 
```

# jquery-ui - jquery ui datepicker 格式不变

> ID：10079112
> 
> 赞同：2
> 
> 时间：2012-04-09T20:07:17.113
> 
> 标签：jquery-ui, datepicker

在我的网站中，我有两个日期输入，

```
 <label>From : </label><input class="datepicker" id="from" name="from" value="<?php echo $from;?>" size=11 type="text">
 <label>To : </label><input class="datepicker" id="to" name="to" value="<?php echo $to ;?>" size=11 type="text"> 
```

在javascript部分，我有以下代码

```
$(function() {
  $( ".datepicker" ).datepicker({ altFormat: 'yy-mm-dd' });
  //getter
  var altFormat = $( ".datepicker" ).datepicker( "option", "altFormat" );
  //setter
  $( ".datepicker" ).datepicker( "option", "altFormat", 'yy-mm-dd' );
  }); 
```

但是当我选择日期时，它仍然返回格式为 04/04/2012 的日期，而不是 yy-mm-dd。

我应该如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:22:45.013

大声笑，我们又来了。首先：

*   **替代格式**：`The dateFormat to be used for the altField option. This allows one date format to be shown to the user for selection purposes, while a different format is actually sent behind the scenes. For a full list of the possible formats see the formatDate function`

*   **日期格式**：`The format for parsed and displayed dates. This attribute is one of the regionalisation attributes. For a full list of the possible formats see the`[格式日期](http://docs.jquery.com/UI/Datepicker/formatDate)`function.`

在此处查看工作[*jsFiddle*](http://jsfiddle.net/SpYk3/ZayWQ/)

你可能还想看看我[几分钟前在这里给出的答案，还有更多的小提琴](https://stackoverflow.com/questions/10079112/jquery-ui-datepicker-format-does-not-change/10079329#10079329)。

# android - 将未知数量的项目添加到我的 Android 应用程序的对话框中的列表中

> ID：10079126
> 
> 赞同：0
> 
> 时间：2012-04-09T20:08:28.723
> 
> 标签：android, listview, android-alertdialog

我正在尝试循环浏览 JSONObject 以查看有多少乘客，然后我想在对话窗口中很好地显示它们。看起来有几种方法可以做到这一点，但总的来说我只是对如何去做感到困惑。这是我得到的最接近的，它有效，但正如你所见，我只添加了一项。所以我的警报对话框中只显示一个项目，应该还有更多。我的 alertdialog（称为 ticketbuilder）是在其他地方创建的，我只是想在这个 for 循环中添加所有内容。如何将我的所有乘客添加到要显示的列表中？提前致谢！

```
for (int i = 0; i < tickets.length(); i++) {

        final int ticketCount = i;
        JSONObject ticket;
        try {
            ticket = tickets.getJSONObject(ticketCount);
            passengername = ticket.getString("passengername");
            ticketnumber = ticket.getString("ticketnumber");
            CharSequence[] array = {passengername + " \n" + ticketnumber}; 
            ticketBuilder.setItems(array, null); //adding to my dialog

        } catch (JSONException e) {
            System.out.println(e);
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:15:23.593

尝试将 CharSequence 放在循环之外并像这样初始化它：

```
CharSequence[] array = new CharSequence[tickets.length()]; 
```

然后在循环中将东西添加到数组中：

```
array[i] = {passengername + " \n" + ticketnumber}; 
```

将 ticketBuilder.setItems 移动到循环之外。

# javascript - jQuery AJAX 和 JSON 性能查询

> ID：10079132
> 
> 赞同：4
> 
> 时间：2012-04-09T20:09:07.103
> 
> 标签：javascript, json, jquery

我将一些 JSON 数据存储在一个文本文件中，以便在我的页面中使用 jQuery Ajax 进行查询。目前，我的文本文件包含大约 10 个方面的数据（可能包含另外 30 个方面的数据）。JSON 数据包含一个问题和这些问题的答案。

在我的 JavaScript 文件中，我设置了不同的函数来获取特定的数据位。

例如：

```
function GetAnswer(questionName) {
    var correctAnswer = null;

    jQuery.ajax({
        type: "GET",
        url: "../content/questions.txt",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        data: "",
        async: false,
        success: function (result) {
            $.each(result, function (i, q) {    
                if (q.questionID == questionName) {
                    correctAnswer = q.correctAnswer;
                    return false;
                }
            });
        },
        error: function () {   },
        complete: function () {   }
    });

    return correctAnswer ;
} 
```

正如您从我的代码片段中看到的那样，我正在循环通过我的 JSON 来获取我需要的数据。我还有其他以类似方式编码的函数来获取问题类型、问题名称等。

我发现我一个接一个地调用这些函数来获取我需要的数据。我认为从性能的角度来看，我查询 JSON 数据的方式并不好，因为我循环遍历整个 JSON 数据集，直到找到匹配项。

有没有更好的方法来查询我的 JSON 数据？

注意：由于我使用的技术（SCORM 1.2）的限制，我不得不使用文本文件来存储问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:19:52.767

循环遍历您的 JSON 对象相对较快。缓慢的（相对而言）是每次都加载该文本文件（尽管它可能被缓存）。

无论哪种方式，我建议在用户第一次启动问题/答案情况时加载 JSON，或者只是在页面加载时加载它（您可以异步执行）并将其存储以供以后使用。

后者的例子：

```
jQuery(document).ready(function(){
    var questions = '';

    jQuery.ajax({
        type: "GET",
        url: "../content/questions.txt",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        data: "",
        async: false,
        success: function (result) {
            questions = result;
        },
        error: function () {   },
        complete: function () {   }
    });

    function GetAnswer(questionName) {
        var correctAnswer = null;
        $.each(questions, function (i, q) {    
            if (q.questionID == questionName) {
                correctAnswer = q.correctAnswer;
                return false;
            }
        });

        return correctAnswer ;
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:14:15.437

为什么不更改 Q&A 对象的结构以包含每个问题的 id，并使 id 成为对象中的属性？然后您可以将 id 传递给 GetAnswer() 并通过引用正确的属性让它直接进入正确的问题？该对象可能如下所示：

```
{"myQuiz" :
    "Q1" :
        { "q" : "What color was George Washington's white horse?",
          "a" : "White"
        },
    "Q2" :
        { "q" : "In what city would you find the Leaning Tower of Pisa?",
          "a" : "Pisa"
        }
} 
```

如果 this 被分配给`result`，并且 an`id`被`Q2`传递给`GetAnswer(id)`，你可以很容易地`return result.myQuiz[id].a;`

作为替代方案，如果问题的顺序是一致的，您可以使用包含 q 和 a 对的数组的对象，并通过索引而不是 id 来引用它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T20:15:08.623

问题是您已`async`设置为`false`. 这是不好的。这会在等待您的请求时停止浏览器，并且会导致性能感觉非常滞后。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T20:13:52.967

为什么不将逻辑移动到像 PHP 这样的服务器端脚本，它可以接受 POST 参数并针对 JSON 集执行查询并仅返回您希望接收的记录。或者，如果您打算将其保留在所有 js 中，您可以简单地将 JSON（只要它是非敏感数据）存储在本地变量中并在本地查询它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T20:14:29.443

您可以在服务器上建立某种机制来加载数据。然后您可以发送诸如 QuestionName 之类的参数并过滤数据。这将降低通过网络发送的有效载荷。

# c++ - 模板类中模板方法的朋友，在模板类中

> ID：10079136
> 
> 赞同：0
> 
> 时间：2012-04-09T20:09:16.337
> 
> 标签：c++, templates, c++11, friend

描述可能令人难以置信，所以我直接进入示例：

```
#include <iostream>
#include <typeinfo>
using namespace std;

template<typename T> class fr{
    static void privatestuff(){
        cout<<"private of "<<typeid(T).name()<<endl;
    }
public:
    template<typename TT> void callsomeone(){
        fr<TT>::privatestuff();
    }
    //template<typename TT> friend void fr<TT>::callsomeone<T>();
    //template<> template<typename TT> friend void fr<TT>::callsomeone<T>();
    //template<typename TT> template<> friend void fr<TT>::callsomeone<T>();
    //no other combinations... how to get it?
};

int main(){
    fr<bool> obj;
    obj.callsomeone<int>();
} 
```

基本上，我希望 fr 能够调用`fr<int>::privatestuff`. 但我也希望不要暴露超出需要的内容，因此与*only*、 not或其他人交`fr<int>`朋友。 *`fr<bool>::callsomeone<int>``fr<bool>::callsomeone<char>`*

 *如果需要，我可以依靠 c++11。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:14:01.937

```
template<class x> template<class y> friend void fr<x>::callsomeone(); 
```

您不应将任何模板参数传递给 callsomeone，因为您想与函数模板交朋友，而不是它的特化（换句话说，您想与它的所有特化交朋友）。*

# android - 对数据库执行查询时，Android“android.database.sqlite.SQLiteException：没有这样的表”错误

> ID：10079143
> 
> 赞同：3
> 
> 时间：2012-04-09T20:09:48.423
> 
> 标签：android, sqlite, create-table

我有一个数据库，它已经包含一个表“LocalLogin”，并且设置正确，可以毫无问题地查询，设置方式与我的新表“PersonList”相同。但是，当我尝试在 PersonList 上执行查询以选择某些值时，出现错误

```
android.database.sqlite.SQLiteException: no such table: PersonList: , while compiling: SELECT ... 
```

尽管我在 SQLiteOpenHelper 类的 onCreate 方法中执行了一个创建查询，但它给了我一个从未创建表的想法。与 LocalLogin 具有相同的数据库名称是可能的问题吗？

以下是相关代码：

数据库适配器类

```
public class GoingOutPersonListDbAdapter {
private static final String DATABASE_NAME = "GoingOutData";
private static final String DATABASE_TABLE_PERSONLIST = "PersonList";
private static final int DATABASE_VERSION = 1;

public static final String PERSONLIST_ID = "PersonList_id";
public static final String PERSONLIST_LOGIN = "Login";
public static final String PERSONLIST_PASSWORD = "Password";

private static final String TAG = "Debugstring";

private PersonListDatabaseHelper mPersonListDbHelper;
private SQLiteDatabase mDb;

private static final String DATABASE_CREATE = 
    "CREATE Table " + DATABASE_TABLE_PERSONLIST+ " ( "
    + PERSONLIST_ID + " integer PRIMARY KEY Autoincrement, "
    + PERSONLIST_LOGIN + " text NOT NULL,"
    + PERSONLIST_PASSWORD + " text NOT NULL );";

private final Context mCtx;

private static class PersonListDatabaseHelper extends SQLiteOpenHelper {
    PersonListDatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }
    @Override
    public void onCreate(SQLiteDatabase db) {
        Log.d(TAG,DATABASE_CREATE);
        db.execSQL(DATABASE_CREATE);
    }
}

public GoingOutPersonListDbAdapter(Context ctx) {
    this.mCtx = ctx;
}

public GoingOutPersonListDbAdapter open() throws SQLException {
    mPersonListDbHelper = new PersonListDatabaseHelper(mCtx);
    mDb = mPersonListDbHelper.getWritableDatabase();
    return this;
}

public Cursor searchPerson(String searchString) {
    return mDb.query(DATABASE_TABLE_PERSONLIST, new String[] {PERSONLIST_ID, PERSONLIST_LOGIN, PERSONLIST_PASSWORD}, searchString, null, null, null, null);
} 
```

}

在我的活动课上：

```
private GoingOutPersonListDbAdapter mPersonListDbHelper;

...

mPersonListDbHelper = new GoingOutPersonListDbAdapter(this);
mPersonListDbHelper.open();

...

//loginEditText is properly set
Cursor personList = mPersonListDbHelper.searchPerson(GoingOutPersonListDbAdapter.PERSONLIST_LOGIN + " = '" + loginEditText + "'");
startManagingCursor(personList); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T20:19:17.030

If you're adding a new table, you need to increment your database version so onUpdate will fire and your database will be recreated with the new table.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:16:16.033

您两次声明“private static final String DATABASE_CREATE”。我很惊讶这个编译，实际上？也就是说，您应该向 db.execSQL(DATABASE_CREATE); 添加一条日志记录语句。调用，看看它是否真的成功。

# java - 访问 Jar 中的 .jpg 文件

> ID：10079146
> 
> 赞同：1
> 
> 时间：2012-04-09T20:09:59.520
> 
> 标签：java, ant, jar

我有一个关于访问 .jpg 文件的问题，该文件包含在 ant 生成的 java jar 文件中。我的 java 项目包含我使用的 Java 代码和一些 .jpg 文件。我希望能够引用该 .jpg 文件并能够从 jar 复制到目录。

有什么办法吗，还是我总是必须将 jar 放在 jar 文件之外？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:19:02.177

您可以将 jar 作为库导入您的项目并访问资源目录或放置 JPG 的任何位置，如果您想直接从项目中引用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:16:50.987

Jar 文件只是带有清单的 .zip。如果您知道 jpg 在 jar 文件中的位置，您只需解压缩 jar 并将 jpg 复制到所需位置。

# tridion - 仍然需要“图像元数据”组件？

> ID：10079147
> 
> 赞同：2
> 
> 时间：2012-04-09T20:10:02.487
> 
> 标签：tridion

为了避免强连接多媒体元数据，我看到“图像元数据”组件具有以下字段：

*   图片（多媒体组件链接）
*   替代文字
*   标题
*   宽度
*   高度

这使我们能够分离特定于上下文的信息。例如，横幅组件可以充当此角色，并可能链接到多媒体图像。由于替代文本还取决于上下文，因此在多媒体元数据中设置这些字段没有意义。我们还可以将与多媒体分开的媒体文本本地化。

在 SDL Tridion 2011 中，我为富文本字段提供了高级图像选项。添加图像时，我可以设置：

*   （替代）文本
*   结盟
*   宽度
*   高度
*   部分

![伙伴](../Images/f508ffa5551a48c5806ab2f0e9251dff.png)

这会影响源中的属性。例如：

```
<img src="tcm:5-274" title="buddy" alt="buddy" style="vertical-align: top; width: 70px; height: 70px;"/> 
```

**这些 in-RTF 选项是何时引入的，它们是否可配置？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T23:22:15.087

我认为拥有单独的元数据组件的原因是因为并非所有使用图像的场景都发生在 RTF 中，您可以在其中为正在编辑的特定 rtf 添加附加属性。在某些情况下，您希望使用图像，但根据使用位置具有不同的元数据。

**场景 A：** 图像的元数据强烈依赖于使用图像的最终内容，并且仅在该上下文中使用，您可以执行由多媒体链接 + 元数据字段构建的嵌入式模式。在将使用图像的内容中，将该元数据模式添加为字段

**场景B：** 图像的元数据不依赖于消耗图像的最终内容，并且不同的元数据存在一些变化，相同的图像。在这种情况下，应该是用于存储元数据的常规模式，其中包含指向二进制文件的二进制链接。此架构可以被其他架构引用为组件链接。

**场景C：** 无论在哪里消费，图像的元数据总是相同的。在这种情况下，您将元数据添加到多媒体模式的元数据中。当用户选择该图像时，您可以扩展 UI 以将这些值自动应用到 RTF，但仍然可以让他们灵活地更改这些值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:15:24.413

我不能确切地告诉你它们是哪个版本引入的，但它们不是最新的。我曾在 Tridion 2009、5.3 甚至 5.2 IIRC 中看到过它们。

如果通过可配置您的意思是更改（添加/删除）这些属性 - 不，它们无法配置。

# ruby - Savon 将 XML 作为字符串返回，而不是哈希

> ID：10079148
> 
> 赞同：1
> 
> 时间：2012-04-09T20:10:04.230
> 
> 标签：ruby, xml, savon

我正在尝试使用 Savon 解析 SOAP 响应。响应是 XML，但作为一个长字符串返回。如果我使用 #to_hash 整个 XML 对象仍然是一个字符串，现在存储在

```
hash[:response][:return] 
```

这意味着它仍然是一个巨大的无法使用的混乱。

我的代码看起来像

```
response = soapClient.request(:get_sites_user_can_access) do
  soap.body = { :sessionid  => session[:login_response][:login_return],
                :eid        => user }
end

rep = response.to_hash

pp rep[:get_sites_user_can_access_response][:get_sites_user_can_access_return] 
```

为了从响应中获取有用的信息，我错过了什么步骤？注意：不幸的是，由于它包含的信息，我无法发布 XML 响应，但它看起来像存储为字符串的整个 XML 文档。它的类是**Nori::StringWithAttributes**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T21:20:54.430

我能够获得所需的结果，但使用[此文档](http://rubydoc.info/gems/nori/frames)解析 Nori 字符串（？） 。这似乎是一个不太理想的方法，但我意识到最后一个元素是一个哈希数组。所以它是散列，散列，带有一个*散列数组*。无论如何，这对我有用。将不胜感激有关如何减少丑陋和笨拙的建议。

```
response = soapClient.request(:get_sites_user_can_access) do
  soap.body = { :sessionid  => session[:login_response][:login_return],
                :eid        => user }
end

rep = response.to_hash[:get_sites_user_can_access_response][:get_sites_user_can_access_return]

hrep = Nori.parse(rep)

hrep[:list][:item].each { |item| pp item[:site_id] } 
```

# ruby-on-rails - 获取访问令牌！在 Google API 中——“缺少授权码”。

> ID：10079149
> 
> 赞同：1
> 
> 时间：2012-04-09T20:10:08.580
> 
> 标签：ruby-on-rails, ruby, google-api

我正在使用 Google API Ruby Client 获取对用户日历的访问权限。

我可以通过以下方式访问：

```
 client_id: "xxxxx"
  client_secret: "xxxxx"
  access_type: "offline"
  approval_type: ""
  scope: "https://www.google.com/calendar/feeds/ https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/calendar"
  callback_path: "/app/oauth_response" 
```

* * *

```
 provider :google_oauth2, GOOGLE_API['client_id'], GOOGLE_API['client_secret'], 
            { access_type: GOOGLE_API['access_type'], 
              approval_prompt: GOOGLE_API['approval_prompt'], 
              scope: GOOGLE_API['scope'], 
              callback_path: GOOGLE_API['callback_path'],
              path_prefix: GOOGLE_API['path_prefix']} 
```

当响应返回时，它有一个刷新令牌、访问令牌、expired_at 等。然后我可以使用访问代码发出 API 请求。但是一旦访问代码过期（一个小时后），我相信我需要使用刷新令牌来获取新的访问令牌，对吗？

这是我正在打的电话：

```
HTTParty.get('https://www.google.com/calendar/feeds/default/owncalendars/full', :query => {:alt => "jsonc", :access_token => access_token}) 
```

这告诉我我的令牌已过期。所以我试着买一个新的。但是当我尝试这样做时，我得到了这个：

```
@client.authorization.fetch_access_token!
ArgumentError Exception: Missing authorization code. 
```

我在我的@client 对象@code=nil 中看到了这一点。我假设这是需要设置的，但我没有从我的初始请求中返回“代码”属性。

我如何获得该代码，或者如果我不需要它，我做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:33:45.643

很可能在您调用 fetch_access_token 时未在 @client.authorization 中设置刷新令牌！

看看[https://github.com/google/signet/blob/master/lib/signet/oauth_2/client.rb](https://github.com/google/signet/blob/master/lib/signet/oauth_2/client.rb)

该错误消息仅在未知/未指定的 grant_type 中出现。grant_type 本身是根据授权客户端的状态推断出来的。

在您的用例中，尝试刷新令牌，它应该是“refresh_token”，如果设置了 refresh_token，grant_type 将返回该值。我的直觉是，如果您转储 @client.authorization.refresh_token 和 @client.authorization.grant_type 的值，它们都将为 nil。

解决方法是确保在调用该方法之前正确恢复 refresh_token。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:41:08.630

Ruby 客户端库会在刷新令牌过期时自动从刷新令牌中获取新的访问令牌，因此您无需执行任何操作来处理这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-17T20:59:25.257

在客户端有以下代码（[https://github.com/google/signet/blob/621515ddeec1dfb6aef662cdfaca7ab30e90e5a1/lib/signet/oauth_2/client.rb#L935](https://github.com/google/signet/blob/621515ddeec1dfb6aef662cdfaca7ab30e90e5a1/lib/signet/oauth_2/client.rb#L935)），所以你需要删除 aredirect_uri，当你不想获取访问令牌。

```
if self.redirect_uri
  # Grant type was intended to be `authorization_code` because of
  # the presence of the redirect URI.
  raise ArgumentError, 'Missing authorization code.'
end 
```

# php - 奇怪的 MYSQL/PHP 错误：以 now()+$i 作为时间戳插入偶尔会插入 0

> ID：10079150
> 
> 赞同：4
> 
> 时间：2012-04-09T20:10:08.660
> 
> 标签：php, mysql, database, innodb

我观察到了这个奇怪的问题。插入`now()`很好，但是在向其中添加数字`now()`时有时会插入 0。这似乎是随机的。

这是查询

```
mysql_query("INSERT INTO action_data (user_id, value, create_time, site_id) VALUES (807809, 20, now()+$i, 409666)"); 
```

桌子：`ENGINE=InnoDB AUTO_INCREMENT=164865 DEFAULT CHARSET=latin1`

mysql_version

```
+-------------------------+------------------------------------------+
| Variable_name           | Value                                    |
+-------------------------+------------------------------------------+
| innodb_version          | 1.0.13-11.6                              |
| protocol_version        | 10                                       |
| version                 | 5.1.52-rel11.6-log                       |
| version_comment         | Percona Server (GPL), 11.6, Revision 140 |
| version_compile_machine | x86_64                                   |
| version_compile_os      | unknown-linux-gnu                        |
+-------------------------+------------------------------------------+ 
```

我在一个循环中运行了 100 次，其中大约前 1/3ish 以时间 0 插入，其余的都很好。有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:17:29.573

在这里猜测......但它似乎在数字上下文中（比如，如果你将一个数字添加到返回值），`NOW()`返回一个看起来像时间戳的数字（不是秒数！）。就像，今天它可能会回来`20120409161530.000000`。现在...根据 的值`$i`，这似乎很容易导致无效值。我的意思是，如果是这样`666666`呢？你最终会得到`20120409828196.000000`，这作为时间戳没有任何意义......而且我很确定 MySQL 只是将无效值变为 0。

您可能需要考虑类似`NOW() + INTERVAL $i SECOND`, 并将其重新定义`$i`为秒数（或分钟、天、甚至几年，如果您愿意...只需更改`SECOND`为您决定的任何内容）。你得到的时间不太可能一团糟。

# entity-framework - 防止 MVC 3 和实体框架在模型和数据库之间进行匹配

> ID：10079151
> 
> 赞同：0
> 
> 时间：2012-04-09T20:10:09.050
> 
> 标签：entity-framework, asp.net-mvc-2

关于另一个[SO](https://stackoverflow.com/questions/10078150/display-a-byte-as-a-checkbox-using-a-editortemplate)帖子，我需要更新我的模型，以便“新”列 ActiveBool 不会尝试与数据库表匹配。

该模型：

```
public class StatusList
    {
        [Key]
        public int StatusID { get; set; }

        [Required]        
        public byte Active { get; set; }

       //I want this column to be ignored by Entity Framework
        public bool ActiveBool
        {
            get { return Active > 0; }
            set { Active = value ? Convert.ToByte(1) : Convert.ToByte(0); }

        }
    } 
```

有可以使用的 DataAnnotation 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T14:38:31.553

您需要使用 [NotMapped] 注释：

```
public class StatusList 
    { 
        [Key] 
        public int StatusID { get; set; } 

        [Required]         
        public byte Active { get; set; } 

       //I want this column to be ignored by Entity Framework so I add [NotMapped]
        [NotMapped]
        public bool ActiveBool 
        { 
            get { return Active > 0; } 
            set { Active = value ? Convert.ToByte(1) : Convert.ToByte(0); } 

        } 
    } 
```

# python - reportlab.platypus - 在模板标题中以右对齐图像作为背景渲染模板

> ID：10079152
> 
> 赞同：2
> 
> 时间：2012-04-09T20:10:15.227
> 
> 标签：python, django, pdf-generation, django-views, reportlab

我正在尝试使用 Reportlab 在一个简单的 Django 应用程序上输出发票。做这样简单的事情似乎很困难。这是我的代码：

```
def print_pdf(fattura, soggetto, buffer=None):

import time
from reportlab.lib.enums import TA_LEFT, TA_CENTER, TA_RIGHT, TA_JUSTIFY
from reportlab.lib.pagesizes import letter
from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Image, ParagraphAndImage
from reportlab.lib.styles import ParagraphStyle, getSampleStyleSheet
from reportlab.lib.units import inch

static_files_dir_path = settings.SITE_ROOT+'/'+settings.CURRENT_APP_NAME+settings.STATIC_URL+'user/images/';
img_file = 'Logo_effetti.jpg'
img_height = 75
img_width = 99

str_data_fatt = (fattura.data).strftime('%d/%m/%Y')
fattura_file_name = str('fattura_'+str_data_fatt+'_'+str(fattura.soggetto)+'.pdf')

img = Image(static_files_dir_path+img_file, img_width, img_height)

styles = getSampleStyleSheet()
normalStyle = styles["Normal"]

nfattura_ptext = 'numero fattura: '+str(fattura.numerofattura)

if buffer:
    doc = SimpleDocTemplate(buffer, pagesize=letter)
else:
    doc = SimpleDocTemplate(fattura_file_name, pagesize=letter)
elems = []

intestazione_studio_ptext = 'Studio AAA<br/>Via XXX 99<br/> 20202 DDDDDDD'
prestazioni = []

elems.append(Paragraph(intestazione_studio_ptext, styles["Normal"]))
elems.append(Spacer(1,12))
elems.append(Spacer(1,12))
elems.append(Spacer(1,12))

elems.append(Paragraph(nfattura_ptext, styles["Normal"]))
cliente_ptext = soggetto.nome+" "+soggetto.cognome+"<br/>"+soggetto.indirizzo+", "+soggetto.cap+" "+soggetto.citta+"<br/>C.F.: "+soggetto.codfisc
if(soggetto.is_privato):
    cliente_ptext += "P.IVA: "+soggetto.piva

prezzo = Prezzo.objects.get(pk=1)

if fattura.riabmot > 0:
    prestazioni.append({'nome':'Rieducazione motoria','qta': fattura.riabmot,'p_unit': prezzo.riabmot,
                        'p_finale': fattura.riabmot * prezzo.riabmot,'id':'riabmot'})
if fattura.riabacq > 0:
    prestazioni.append({'nome':'Riabilitazione in acqua','qta': fattura.riabacq,'p_unit': prezzo.riabacq,
                        'p_finale': fattura.riabacq * prezzo.riabacq,'id':'riabacq'})
if fattura.riabdom > 0:
    prestazioni.append({'nome':'Riabilitazione domiciliare','qta': fattura.riabdom,'p_unit': prezzo.riabdom,
                        'p_finale':fattura.riabdom * prezzo.riabdom,'id':'riabdom'})
if fattura.osteo > 0:
    prestazioni.append({'nome':'Osteopatia','qta': fattura.osteo,'p_unit': prezzo.osteo,
                        'p_finale':fattura.osteo * prezzo.osteo,'id':'osteo'})
if fattura.masso > 0:
    prestazioni.append({'nome':'Massoterapia','qta': fattura.masso,'p_unit': prezzo.masso,
                        'p_finale':fattura.masso * prezzo.masso,'id':'masso'})
if fattura.diate > 0:
    prestazioni.append({'nome':'Diatermia','qta': fattura.diate,'p_unit': prezzo.diate,
                             'p_finale':fattura.diate * prezzo.diate,'id':'diate'})
if fattura.laser > 0:
    prestazioni.append({'nome':'Laserterapia','qta': fattura.laser,'p_unit': prezzo.laser,
                            'p_finale':fattura.laser * prezzo.laser,'id':'laser'})
if fattura.usman > 0:
    prestazioni.append({'nome':'US Manuale','qta': fattura.usman,'p_unit': prezzo.usman,
                            'p_finale':fattura.usman * prezzo.usman,'id':'usman'})
if fattura.usacq > 0:
    prestazioni.append({'nome':'US in acqua','qta': fattura.usacq,'p_unit': prezzo.usacq,
                            'p_finale':fattura.usacq * prezzo.usacq,'id':'usacq'})
if fattura.tens > 0:
    prestazioni.append({'nome':'TENS','qta': fattura.tens,'p_unit': prezzo.tens,
                            'p_finale':fattura.tens * prezzo.tens,'id':'usacq'})
if fattura.ets > 0:
    prestazioni.append({'nome':'Elettroterapia stimolante','qta': fattura.ets,'p_unit': prezzo.ets,
                             'p_finale': fattura.ets * prezzo.ets,'id':'ets'})
if fattura.magneto > 0:
    prestazioni.append({'nome':'Magnetoterapia','qta': fattura.magneto,'p_unit': prezzo.magneto,
                            'p_finale':fattura.magneto * prezzo.magneto,'id':'magneto'})
if fattura.iono > 0:
    prestazioni.append({'nome':'Ionoforesi','qta': fattura.iono,'p_unit': prezzo.iono,
                            'p_finale':fattura.iono * prezzo.iono,'id':'iono'})

totale = 0
totale += fattura.diate * prezzo.diate
totale += fattura.ets * prezzo.ets
totale += fattura.iono * prezzo.iono
totale += fattura.tens * prezzo.tens
totale += fattura.laser * prezzo.laser
totale += fattura.magneto * prezzo.magneto
totale += fattura.masso * prezzo.masso
totale += fattura.usacq * prezzo.usacq
totale += fattura.usman * prezzo.usman
totale += fattura.osteo * prezzo.osteo
totale += fattura.riabacq * prezzo.riabacq
totale += fattura.riabdom * prezzo.riabdom
totale += fattura.riabmot * prezzo.riabmot

prestazioni_instestazione_ptext = "Prestazione     N.Sedute     Pr. unitario (euro)     Pr. finale (euro)"
elems.append(Paragraph(prestazioni_instestazione_ptext, styles["Normal"]))
elems.append(Spacer(1,12))
for p in prestazioni:
    prestazione_ptext = p['nome']+"     "+str(p['qta'])+"     "+str(p['p_unit'])+"     "+str(p['p_finale'])
    elems.append(Paragraph(prestazione_ptext, styles["Normal"]))

elems.append(Spacer(1,12))
elems.append(Spacer(1,12))
totale_ptext = "Importo totale: "+str(totale)+" euro"
elems.append(Paragraph(totale_ptext, styles["Normal"]))

doc.build(elems);
return buffer; 
```

使用此代码，我的标题图像始终呈现在页面中心。我想把它插在右边（像[那样](http://i.imgur.com/0Ahww.png)），或者更好的是把图像放在右边，把文字放在左边。我已经尝试了很多方法（设置 img 的 hAlign 或 oAlign 属性，在 ParagraphAndImage 可流动的图像中插入图像），但总是出现错误或相同的对齐方式。什么是正确的方法？

我试图查看 Reportlab 文档，但对我来说似乎不太清楚，而且代码片段也很差。

tnx给大家，

卢克

* * *

感谢您的回复。我已经通过这种方式修改了代码：

```
def print_fatt_pdf(fattura, soggetto, buffer=None):

import time
from reportlab.lib.enums import TA_LEFT, TA_CENTER, TA_RIGHT, TA_JUSTIFY
from reportlab.lib.pagesizes import letter
from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer
from reportlab.platypus.frames import Frame
from reportlab.lib.styles import ParagraphStyle, getSampleStyleSheet
from reportlab.lib.units import inch, cm
from PIL import Image
from reportlab.pdfgen.canvas import Canvas

static_files_dir_path = settings.SITE_ROOT+'/'+settings.CURRENT_APP_NAME+settings.STATIC_URL+'user/images/';
img_file = 'Logo_effetti.jpg'
img_height = 75
img_width = 98
elems = []

str_data_fatt = (fattura.data).strftime('%d/%m/%Y')
fattura_file_name = str('fattura_'+str_data_fatt+'_'+str(fattura.soggetto)+'.pdf')
print 'fattura_file_name',fattura_file_name

f = Frame(1.5*cm, 1.5*cm, 6*inch, 9*inch)
p = Canvas(buffer);

# adding flowables
styles = getSampleStyleSheet()
normalStyle = styles["Normal"]

nfattura_ptext = 'numero fattura: '+str(fattura.numerofattura)
intestazione_studio_ptext = 'Studio Fisiodel<br/>Via Sant\'Isaia 99<br/>20012 Mantegazza di Vanzago (MI)'
print 'intestazione_studio_ptext type: ',type(intestazione_studio_ptext)
elems.append(Paragraph(intestazione_studio_ptext, normalStyle))
elems.append(Spacer(1,12))
elems.append(Spacer(1,12))
elems.append(Spacer(1,12))

elems.append(Paragraph(nfattura_ptext, styles["Normal"]))
cliente_ptext = soggetto.nome+" "+soggetto.cognome+"<br/>"+soggetto.indirizzo+", "+soggetto.cap+" "+soggetto.citta+"<br/>C.F.: "+soggetto.codfisc
if(soggetto.is_privato):
    cliente_ptext += "P.IVA: "+soggetto.piva

prezzo = Prezzo.objects.get(pk=1)

prestazioni = []
if fattura.riabmot > 0:
    prestazioni.append({'nome':'Rieducazione motoria','qta': fattura.riabmot,'p_unit': prezzo.riabmot,
                        'p_finale': fattura.riabmot * prezzo.riabmot,'id':'riabmot'})
if fattura.riabacq > 0:
    prestazioni.append({'nome':'Riabilitazione in acqua','qta': fattura.riabacq,'p_unit': prezzo.riabacq,
                        'p_finale': fattura.riabacq * prezzo.riabacq,'id':'riabacq'})
if fattura.riabdom > 0:
    prestazioni.append({'nome':'Riabilitazione domiciliare','qta': fattura.riabdom,'p_unit': prezzo.riabdom,
                        'p_finale':fattura.riabdom * prezzo.riabdom,'id':'riabdom'})
if fattura.osteo > 0:
    prestazioni.append({'nome':'Osteopatia','qta': fattura.osteo,'p_unit': prezzo.osteo,
                        'p_finale':fattura.osteo * prezzo.osteo,'id':'osteo'})
if fattura.masso > 0:
    prestazioni.append({'nome':'Massoterapia','qta': fattura.masso,'p_unit': prezzo.masso,
                        'p_finale':fattura.masso * prezzo.masso,'id':'masso'})
if fattura.diate > 0:
    prestazioni.append({'nome':'Diatermia','qta': fattura.diate,'p_unit': prezzo.diate,
                             'p_finale':fattura.diate * prezzo.diate,'id':'diate'})
if fattura.laser > 0:
    prestazioni.append({'nome':'Laserterapia','qta': fattura.laser,'p_unit': prezzo.laser,
                            'p_finale':fattura.laser * prezzo.laser,'id':'laser'})
if fattura.usman > 0:
    prestazioni.append({'nome':'US Manuale','qta': fattura.usman,'p_unit': prezzo.usman,
                            'p_finale':fattura.usman * prezzo.usman,'id':'usman'})
if fattura.usacq > 0:
    prestazioni.append({'nome':'US in acqua','qta': fattura.usacq,'p_unit': prezzo.usacq,
                            'p_finale':fattura.usacq * prezzo.usacq,'id':'usacq'})
if fattura.tens > 0:
    prestazioni.append({'nome':'TENS','qta': fattura.tens,'p_unit': prezzo.tens,
                            'p_finale':fattura.tens * prezzo.tens,'id':'usacq'})
if fattura.ets > 0:
    prestazioni.append({'nome':'Elettroterapia stimolante','qta': fattura.ets,'p_unit': prezzo.ets,
                             'p_finale': fattura.ets * prezzo.ets,'id':'ets'})
if fattura.magneto > 0:
    prestazioni.append({'nome':'Magnetoterapia','qta': fattura.magneto,'p_unit': prezzo.magneto,
                            'p_finale':fattura.magneto * prezzo.magneto,'id':'magneto'})
if fattura.iono > 0:
    prestazioni.append({'nome':'Ionoforesi','qta': fattura.iono,'p_unit': prezzo.iono,
                            'p_finale':fattura.iono * prezzo.iono,'id':'iono'})

totale = 0
totale += fattura.diate * prezzo.diate
totale += fattura.ets * prezzo.ets
totale += fattura.iono * prezzo.iono
totale += fattura.tens * prezzo.tens
totale += fattura.laser * prezzo.laser
totale += fattura.magneto * prezzo.magneto
totale += fattura.masso * prezzo.masso
totale += fattura.usacq * prezzo.usacq
totale += fattura.usman * prezzo.usman
totale += fattura.osteo * prezzo.osteo
totale += fattura.riabacq * prezzo.riabacq
totale += fattura.riabdom * prezzo.riabdom
totale += fattura.riabmot * prezzo.riabmot

prestazioni_instestazione_ptext = "Prestazione     N.Sedute     Pr. unitario (euro)     Pr. finale (euro)"
elems.append(Paragraph(prestazioni_instestazione_ptext, normalStyle))
elems.append(Spacer(1,12))
for p in prestazioni:
    prestazione_ptext = str(p['nome']+"     "+str(p['qta'])+"     "+str(p['p_unit'])+"     "+str(p['p_finale']))
    print 'prestazione_ptext type : ',type(prestazione_ptext)
    elems.append(Paragraph(prestazione_ptext, styles["Normal"]))

elems.append(Spacer(1,12))
elems.append(Spacer(1,12))
totale_ptext = "Importo totale: "+str(totale)+" euro"
print 'totale_ptext: ',totale_ptext
elems.append(Paragraph(totale_ptext, styles["Normal"]))

f.addFromList(elems,p)
p.drawImage(static_files_dir_path+img_file,450,730,img_width,img_height)
p.save()
return buffer 
```

但它仍然不起作用。问题似乎在这一部分：

```
for p in prestazioni:
    prestazione_ptext = str(p['nome']+"     "+str(p['qta'])+"     "+str(p['p_unit'])+"     "+str(p['p_finale']))
    print 'prestazione_ptext type : ',type(prestazione_ptext)
    elems.append(Paragraph(prestazione_ptext, styles["Normal"])) 
```

我收到以下错误：

*/fattura/pdf/ 'dict' 对象的 AttributeError 没有属性 'saveState'*

删除该部分代码有效。有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T20:44:29.700

如果您使用的是鸭嘴兽，则需要在页面上设置框架。然后您可以指定将特定内容放入页面的哪个框架。在您的情况下，这就像设置一个框架来包含图像，然后设置一个框架来包含内容。然后，您可以从框架构建页面模板，并在生成它们时将这些页面模板应用于特定页面。这是在 ReportLab 中使用鸭嘴兽进行复杂布局的一般模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-09T14:37:13.890

我试图实现这一目标。查看当前的[源代码](https://bitbucket.org/rptlab/reportlab/src/b591b402f4cfe770d56b3f970630b42bf4a4ec4f/src/reportlab/platypus/flowables.py?at=default#cl-385)，我想出了以下解决方案：

```
from reportlab.platypus import Image

class AlignedImage(Image):
    def __init__(self, filename, hAlign='CENTER', **kwargs):
        Image.__init__(self, filename, **kwargs)
        self.hAlign = hAlign

# simply use it like this ('LEFT' can also be used):
my_image = AlignedImage('/foo/bar.png', hAlign='RIGHT') 
```

所有必需的代码都已经在这里了；我已经[报告了](https://bitbucket.org/rptlab/reportlab/issue/54/allow-to-specify-horizontal-alignment-to)直接在 Image 类中添加此参数的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-27T09:00:30.720

看起来现在在那里！

```
from reportlab.platypus import SimpleDocTemplate, Paragraph, Image, HRFlowable

ss = reportlab.lib.styles.getSampleStyleSheet() 
p1 = Paragraph("Title", ss['Heading1'])                                                                    
p2 = Paragraph("normal paragraph", ss['BodyText'])                                                         
p3 = HRFlowable(width="100%")  
p4 = Image("/home/usr/Downloads/me.jpg", width=100, height=75, hAlign="LEFT")                  

flo = [p4,p3,p1,p3,p2]  
pdf = SimpleDocTemplate("test.pdf") 
pdf.showboundary = 1
pdf.build(flo) 
```

# php - Codeigniter -> 文件上传路径 | 文件夹创建

> ID：10079153
> 
> 赞同：4
> 
> 时间：2012-04-09T20:10:17.783
> 
> 标签：php, codeigniter, image-uploading

目前我有以下内容：

`$config['upload_path'] = 'this/path/location/';`

我想做的是创建以下控制器，但我不知道如何攻击它！！

```
$data['folderName'] = $this->model->functionName()->tableName;

$config['upload_path'] = 'this/'.$folderName.'/'; 
```

我将如何`$folderName?`在服务器上创建字典？

**杰米：**

我可以执行以下操作吗？

```
if(!file_exists($folderName))
{

  $folder = mkdir('/location/'$folderName);

   return $folder; 
}
else
{
 $config['upload_path'] = $folder; 
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T15:51:47.660

我不确定他们在使用 file_exist 函数在说什么，因为您需要检查它是否是目录..

```
$folderName = $this->model->functionName()->tableName;
$config['upload_path'] = "this/$folderName/";
if(!is_dir($folderName))
{
   mkdir($folderName,0777);
} 
```

请注意：

1.  我已将**权限**添加到该文件夹​​，以便您可以将文件上传到该文件夹​​。
2.  我已经删除了，`else`因为它在这里没有用（正如@mischa 指出的那样）..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T05:15:29.523

这是不正确的：

```
if(!file_exists($folderName))
{
   mkdir($folderName);
}
else
{
   // Carry on with upload
} 
```

如果文件夹不存在，则不会上传任何内容！你必须摆脱 else 子句。

```
$path = "this/$folderName/";

if(!file_exists($path))
{
   mkdir($path);
}

// Carry on with upload
$config['upload_path'] = $path; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T20:24:43.767

不太清楚你所说的“字典”是什么意思，但如果你问的是如何创建一个变量：

```
$folderName = $this->model->functionName()->tableName;

$config['upload_path'] = "this/$folderName/"; 
```

* * *

添加/检查目录是否存在：

```
if(!file_exists($folderName))
{
   mkdir($folderName);
}
else
{
   // Carry on with upload
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T20:39:57.933

不是 100% 确定您想要从描述中得到什么，所以这里有一些建议：

如果您需要使用 PHP 以编程方式创建文件夹，您可以使用 mkdir() 函数，请参阅： http: [//php.net/manual/en/function.mkdir.php](http://php.net/manual/en/function.mkdir.php)

此外，请查看 Codeignitor 文件帮助程序以读取和写入文件： [http ://codeigniter.com/user_guide/helpers/file_helper.html](http://codeigniter.com/user_guide/helpers/file_helper.html)

如果文件夹已经存在，您需要确保权限是可写的。在 Windows 上，您可以右键单击文件夹、属性、安全性并在那里进行编辑。在 Linux 上，您需要 chmod 命令。

# java - sql：如何执行两个从属查询？

> ID：10079154
> 
> 赞同：-1
> 
> 时间：2012-04-09T20:10:25.857
> 
> 标签：java, sql

我有 2 个表（table1，table2）table1 有一个字段 id，table2 有一个字段 id_eid，它引用 table1 的 id 字段作为外键。

我必须从 table1 中删除与确定标准匹配的所有行，然后如果在 table2 中引用了这些数据，则也从中删除数据。

我做了类似的事情，假设`con`是 Connection 对象并且 autocommit 设置为 false 。

```
 String query1 = "delete from table2 where exists 
(select * from table1 where someparameter = ? and table1.id = table2.id_eid)" 
```

然后我使用 PreparedStatement 执行第一个 query1。

然后我有

```
 String query2 = "delete from table1 where someparameter = ? 
and exists (select * from table2 where table1.id = table2.id_eid)" 
```

我用另一个 PreparedStatment 执行了这个。

最后我有`con.commit()`。

这不起作用，我想使用自动提交来假这两个查询是一起执行的，但事实并非如此，第二个查询不删除任何行，我该怎么做？

重要说明，并非 table1 中的所有行在 table2 中都有引用行。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:23:59.620

您总是可以先查询要删除的数据，然后再删除它：

1)`Select ID from table1 where <criteria>`

2)`Select ID from table2 where <criteria>`

3)`Delete from table1 where ID in <results from (1)>`

4)`Delete from table2 where ID in <results from (2)>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T22:06:18.947

如果您“必须从 table1 中删除所有符合确定条件的行”，我认为 String query2 必须是

```
 String query2 = "delete from table1 where someparameter = ?" 
```

# r - gls 和 dynlm 调用在技术上是否不同（不是说统计意义）？

> ID：10079157
> 
> 赞同：1
> 
> 时间：2012-04-09T20:10:32.570
> 
> 标签：r, plyr

我编写了一个小函数来运行具有不同滞后的多个单变量回归：

```
f <- function(x,l) {
lm.obj <- dynlm(GNP~L(get(as.character(x)),l),
              data=longley)
names(lm.obj$coefficients)[2] <- paste(x,l,sep=".")
return(lm.obj)
} 
```

`mlply`在使用 .创建可能的滞后变量组合的框架之后，这非常有效`expand.grid`。`longley`使用包中的数据集的可重现示例`datasets`如下所示：

```
data(longley)
require(plyr)
vars <- expand.grid(x=names(longley)[-c(1:3)],l=1:3)

regressionList <- mlply(vars,f, .progress= "text")
summaries <- lapply(regressionList,summary) 
```

这工作得很好。但是现在我尝试使用 gls 做同样的事情。

```
require(nlme)

f.gls <- function(x,l) {
gls.obj <- gls(GNP~lag(get(as.character(x)),-l),
              data=longley)
names(gls.obj$coefficients)[2] <- paste(x,l,sep=".")
return(gls.obj)
} 
```

但我得到的只是这个错误：

`Error in eval(expr, envir, enclos) : object 'x' not found`

我尝试使用`debug()`，但里面的一切似乎都一样。我也尝试在外面调用该函数，`mlply`但它不起作用。也尝试过没有滞后。只是找不到 x。

# regex - 提取该行的 url 部分

> ID：10079158
> 
> 赞同：0
> 
> 时间：2012-04-09T20:10:33.830
> 
> 标签：regex, bash, sed, awk

我有很多行的html页面，其中一行是：

```
var premium_download_link = 'http://www.someurl.com/'; 
```

如何在 html 页面中找到该行并从该行中提取[http://www.someurl.com](http://www.someurl.com)？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:31:03.807

```
echo "var premium_download_link = 'http://www.someurl.com/'" | awk '{print substr ($4,2,23)}' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T21:07:29.470

您可以通过`awk`定义字段分隔符变量来提取特定的字段值。

例如，以下应该工作 -

```
$ echo "var premium_download_link = 'http://www.someurl.com/';" | 
awk -F"'" '{ print $2 }' 
http://www.someurl.com/ 
```

但是，您的`html`文件可能包含其他内容。因此，您可以在脚本前面添加一个正则表达式，以确保它仅在遇到特定行时运行。

例如 -

```
awk -F"'" '/premium_download_link/{ print $2 }' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T20:16:31.570

使用`sed`：

```
sed -n -e "s/.*var premium_download_link = '\([^']*\)';.*/\1/p" 
```

该`-n`标志禁止打印，除非我们使用`p`. 因此只打印匹配（然后替换）的行。

**编辑（基于 OP 评论）：**

要在 shell 变量中获取它，您可能需要以下内容：

```
url=$(wget -qO - "http://originalurl.com/" | sed -n -e "s/.*var premium_download_link = '\([^']*\)';.*/\1/p") 
```

这会获取页面并运行它`sed`。输出应该是 url，它存储在一个名为`url`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-09T20:26:16.243

With awk :

```
awk -F "'" '{ for (f=1; f<=(NF-1)/2; f++) print $(f*2) }' $1 
```

`-F "'"` define the quote `'` as the separator for given input.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-09T23:18:25.640

```
grep -Po "(?<=premium_download_link = ')[^']+" 
```

# delphi - 密码加密

> ID：10079162
> 
> 赞同：3
> 
> 时间：2012-04-09T20:10:59.987
> 
> 标签：delphi, delphi-7

我已经设法使用以下代码对输入的密码进行简单加密，然后在标签标题中显示加密的密码，

```
procedure TfrmLogin.edtAddPasswordClick(Sender: TObject);
var
  NormalPassword, EncryptedPassword: string;
  PasswordChar: Char;
  EncryptedCharValue: string;
  CharPtr: Integer;
  Ptr, n: Integer;
begin
  NormalPassword := Edit1.text;
  EncryptedPassword := '';
  for CharPtr := 1 to Length(NormalPassword) do
  begin
    PasswordChar := NormalPassword[CharPtr];
    EncryptedCharValue := IntToStr (Ord(PasswordChar) * 5 + 14);
    EncryptedPassword := EncryptedPassword + EncryptedCharValue;
    Label1.Caption := EncryptedPassword;
  end;
end; 
```

问题是我想通过单击另一个按钮将 label1.caption 中显示的加密密码转换回其原始形式，但我无法弄清楚如何做到这一点。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T20:31:07.793

与其创建自己的算法来散列（或加密）密码，不如尝试使用经过良好测试且可靠的算法，如 SHA1、MD5 等。

回到您将加密值转换为原始值的问题，您所要做的就是反转您的算法，试试这个示例。

```
var
  NormalPassword, EncryptedPassword: String;
  PasswordChar : char;
  EncryptedCharValue : String;
  CharPtr : Integer;
begin
  NormalPassword    :='';
  EncryptedPassword := Label1.Caption; //here is stored the encrypted password
  CharPtr := 1;
  while CharPtr< length(EncryptedPassword) do
    Begin
      EncryptedCharValue:=Copy(EncryptedPassword, CharPtr, 3);
      Inc(CharPtr, 3);
      PasswordChar     := Chr((StrToint(EncryptedCharValue)-14) div 5);
      NormalPassword  :=NormalPassword+ PasswordChar;
    end;
    Label2.Caption := NormalPassword; 
end; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T20:43:17.780

我知道这是为了家庭作业，想法是获取逆向代码，其他人为此目的提供了太多细节，但我需要给出这个作为答案，因为它的概念太重要了，无法在注释中说明：

如果你真的在谈论密码，那么你*不能*让密码可逆。用户*希望*他们的密码安全可靠且不可撤销。

如果您要这样做的原因是因为您想在他们忘记密码时向他们发送密码，那么答案是*不要*。

当一个人丢失或忘记了他们的密码时，您不应该*将*其还给他们，因为这证明它是不安全的。相反，正确的做法是，在确保他们是注册用户（通过电子邮件地址或其他方式）之后，允许他们输入他们选择的新密码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T20:31:12.953

如果您决心按照您描述的方式进行操作，则可以通过更改行使其可逆：

```
EncryptedCharValue := IntToStr (Ord(PasswordChar) * 5 + 14); 
```

到

```
EncryptedCharValue := format('%.4d', [Ord(PasswordChar) * 5 + 14]); 
```

这将允许您稍后将字符串分成四个字符块，减去 14，除以 5，然后将其转换回字符。不过，我坚持我之前的评论 - 如果您确实有一个需要可逆安全性的用例，请使用更强大的算法，例如在[这个问题](https://stackoverflow.com/questions/133393/password-encryption-in-delphi)中讨论。

[编辑：四个字符显然更健壮]

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T20:16:22.700

You 函数是一种非常简单的哈希算法，无法反转。以可以反转的方式存储密码是没有意义的，因为它不会增加任何额外的安全层（除非您使用基于非对称加密的复杂方案）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-10T05:34:40.367

简单哈希算法： [如何用 Delphi 对字符串进行哈希处理？](https://stackoverflow.com/questions/58621/how-do-i-hash-a-string-with-delphi)

使用密钥算法（CRAM，HMac）散列： [Delphi 中的 HMAC-SHA256](https://stackoverflow.com/questions/2003194/hmac-sha256-in-delphi)

# python - 在 ngram 上训练朴素贝叶斯分类器

> ID：10079163
> 
> 赞同：11
> 
> 时间：2012-04-09T20:11:04.850
> 
> 标签：python, ruby, nlp, machine-learning, classification

我一直在使用[Ruby Classifier 库](http://classifier.rubyforge.org/)对[隐私政策](https://stackoverflow.com/questions/9709293/interesting-nlp-machine-learning-style-project-analyzing-privacy-policies)进行分类。我得出的结论是，这个库中内置的简单的词袋方法是不够的。为了提高分类准确度，除了单个单词之外，我还想在 n-gram 上训练分类器。

我想知道是否有一个库用于预处理文档以获取相关的 n-gram（并正确处理标点符号）。一种想法是我可以预处理文档并将伪 ngram 输入 Ruby 分类器，例如：

> wordone_wordtwo_wordthree

或者，也许有更好的方法可以做到这一点，例如从一开始就内置了基于 ngram 的朴素贝叶斯分类的库。如果他们完成工作，我愿意在这里使用除 Ruby 之外的语言（如果需要，Python 似乎是一个很好的候选者）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-09T20:21:11.283

如果你对 python 没问题，我会说[nltk](http://www.nltk.org/data)对你来说是完美的。

例如：

```
>>> import nltk
>>> s = "This is some sample data.  Nltk will use the words in this string to make ngrams.  I hope that this is useful.".split()
>>> model = nltk.NgramModel(2, s)
>>> model._ngrams
set([('to', 'make'), ('sample', 'data.'), ('the', 'words'), ('will', 'use'), ('some', 'sample'), ('', 'This'), ('use', 'the'), ('make', 'ngrams.'), ('ngrams.', 'I'), ('hope', 'that'
), ('is', 'some'), ('is', 'useful.'), ('I', 'hope'), ('this', 'string'), ('Nltk', 'will'), ('words', 'in'), ('this', 'is'), ('data.', 'Nltk'), ('that', 'this'), ('string', 'to'), ('
in', 'this'), ('This', 'is')]) 
```

你甚至有一个方法`nltk.NaiveBayesClassifier`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T04:24:06.040

```
>> s = "She sells sea shells by the sea shore"
=> "She sells sea shells by the sea shore"
>> s.split(/ /).each_cons(2).to_a.map {|x,y| x + ' ' +  y}
=> ["She sells", "sells sea", "sea shells", "shells by", "by the", "the sea", "sea shore"] 
```

Ruby 可枚举对象有一个名为 enum_cons 的方法，该方法将从可枚举对象中返回 n 个连续项目中的每一个。使用该方法生成 ngram 是一个简单的单行。

# jquery - 同步 AJAX 调用的问题，为什么它对我来说是异步的？

> ID：10079172
> 
> 赞同：0
> 
> 时间：2012-04-09T20:11:51.733
> 
> 标签：jquery

我试图避免剪切和粘贴代码，所以我制作了一个用于将数据保存到网络服务器的包装器：

```
 function saveData(newData) {
    //clear our error message out.
    $("#Status").html("");
    var anID;

    //save the data to the server
    $.ajax({
        type: "POST",
        url: "/John/SaveSomeData",
        data: JSON.stringify(newData),
        async: false,
        contentType: 'application/json; charset=utf-8',
        datatype: "json",
        traditional: false,
        success: function (sReturn) {
            anID = parseInt(sReturn);
            if (isNaN(anID)) {
                $("#Status").html("Error: " + sReturn);
                return -1;
            }
        }
    });    //end AJAX call
    return anID;
} //end save data 
```

基本上，上面的函数如果有效则返回一个正整数，如果它从服务器收到错误则返回-1。如果数据被成功添加，网络服务器将返回一个整数值，如果发生错误，则返回一些文本。

发送和返回的数据以字节为单位......绝对最坏的情况是 200 字节（是的，字节，不是千字节、兆字节或千兆字节......只是字节）所以我不关心很多的可能性正在发送的数据以及处理它的时间。

我使用上面的代码如下（一个在添加按钮中，另一个在保存按钮中）：

```
$("#addButton").click(function (event) {
    //validate data locally
    //cut some unimportant code

    var newData = /*newdata junk cut*/

    var myID = saveData(newData);
    if (myID != -1) {
       //cut code for adding result to a list
//snip the rest of the code 
```

我遇到的明显问题是 jquery 触发 ajax 调用并继续不等待 ajax 调用完成。基本上，服务器可以返回“添加失败”并且“添加按钮事件”将继续处理，就像它成功一样。

发送到网络服务器的数据很好，处理正确，并且来自网络服务器的响应是正确的。这纯粹是同步/异步问题，而不是与服务器之间的数据。

我的理解是“async：false”行应该强制 jquery 在执行任何其他操作之前等待 ajax 调用完成。

添加与保存时发生的事情的编码不同，因此我不希望将代码与 Ajax 一起使用。

我是否需要将 ajax 部分转换为更像：

```
var ajaxReturn = $.ajax({         
    type: "POST",         
    url: remote_url,         
    async: false,     }).responseText;

ajaxReturn.done(function(msg) { 
    $("#log").html( msg ); 
}); 

ajaxReturn.fail(function(jqXHR, textStatus) { 
  alert( "Request failed: " + textStatus ); 
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:17:47.987

不确定这是否是让您认为它不同步的原因，但您的函数将永远不会返回`-1`，因为您将该`return`语句放在`success:`回调中。相反，它应该分配`-1`给`anID`.

```
 success: function (sReturn) {
        anID = parseInt(sReturn);
        if (isNaN(anID)) {
            $("#Status").html("Error: " + sReturn);
            anID = -1; // do an assignment
        }
    }
});    //end AJAX call
return anID; 
```

# msbuild - CSPROJ 文件中的表达式语法参考

> ID：10079173
> 
> 赞同：4
> 
> 时间：2012-04-09T20:12:05.417
> 
> 标签：msbuild, csproj

有人可以指点我参考 Visual Studio 中 csproj/vbproj 文件中使用的表达式语言的语法吗？我一直在看到如下用法：

```
 <FilesForPackagingFromProject Include="%(CustomFiles.Identity)"> 
```

...我正在尝试理解“.Identity”位。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T20:05:24.510

Identity 位是许多[MSBuild Well-known Item Metadata](http://msdn.microsoft.com/en-us/library/ms164313.aspx)之一。它本质上是 msbuild [Items](http://msdn.microsoft.com/en-us/library/ms171453.aspx)的元数据。您可以使用元数据来[转换项目类型](http://msdn.microsoft.com/en-us/library/ms171453.aspx#BKMK_Transforming)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-12T03:58:24.317

这个问题[How do you include additional files using VS2010 web deployment packages？](https://stackoverflow.com/questions/2747081/how-do-you-include-additional-files-using-vs2010-web-deployment-packages)没有直接解决您的问题，但最受欢迎的答案包含大量有用的信息，并提供了有关 % 符号含义的线索。

```
<_CustomFiles Include="..\Extra Files\**\*" />
<FilesForPackagingFromProject  Include="%(_CustomFiles.Identity)"> 
```

我认为该`_CustomFiles`标签会创建一个指向外部文件的链接，然后`%(_CustomFiles.Identity)`引用该外部文件中的一个元素。

更新：

不！这个不对。% 表达式给出一个标量值。_CustomFiles 是一个项目，语法的 .Identity 部分指的是众所周知的元数据，正如 Marcos 在接受的答案中所解释的那样。

# php - 对象到字符串。如何？

> ID：10079176
> 
> 赞同：1
> 
> 时间：2012-04-09T20:12:18.490
> 
> 标签：php, oop, object

我做了一些研究。我发现您可以序列化然后反序列化以获取字符串......但我想要一个更好的解决方案。

我得到了 IMAP pear 模块 ( `function imap_getmailboxes`) 返回的对象数组。

```
public function GetMailBoxes(){
    $List = imap_getmailboxes($this->Link, '{'.$this->Server.':'.$this->Port.'}', '*');

    $Data = array();
    if(is_array($List)){
        foreach($List as $Key => $Value){
            $Value = unserialize(serialize($Value));
            $In = strpos($Value->name, '{');
            $Out = strpos($Value->name, '}');

            $Part = substr($Value, $Out);
            $Value->real_name = explode($Value->delimiter, imap_utf7_decode($Part));
            $Value->real_name = (isset($Value->real_name[1]) ? $Value->real_name[1] : null);

            $Data[$Key] = $Value;
        }
    }

    return $Data;
} 
```

这里的问题是 strpos 告诉我这个`Warning: substr() expects parameter 1 to be string, object given in /home/david/domains/davidbelanger.net/public_html/panel/drivers/mail.php on line 178`。

如何将对象转换为字符串？任何想法，以前从未这样做过。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T20:13:45.697

我认为而不是

```
$Part = substr($Value, $Out); 
```

你要

```
$Part = substr($Value->name, $Out); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:13:49.840

您可以覆盖魔术方法`__toString()`

如此处所述：[http ://www.php.net/manual/en/language.oop5.magic.php#object.tostring](http://www.php.net/manual/en/language.oop5.magic.php#object.tostring)

# session - 带有 EJB3.0 和 websphere6.1 的无状态会话 bean 的问题

> ID：10079183
> 
> 赞同：0
> 
> 时间：2012-04-09T20:12:45.917
> 
> 标签：session, ejb-3.0, javabeans, stateless

**我无法使用 EJB3.0 和 Websphere 6.1 创建无状态会话 bean。

我将所有内容打包在 EAR 文件中并将其部署在 Websphere 上。我正在尝试创建一个无状态会话 bean 并期望它实例化会话 bean 并调用 ejbCreate()。**

```
Following is my code and xml file.

package com.aa.otrs.datacollector.reject.ejb;

import javax.annotation.Resource;
import javax.ejb.Stateless;
import javax.ejb.Timeout;
import javax.ejb.Timer;
import javax.ejb.TimerService;
import javax.interceptor.Interceptors;
import com.aa.otrs.datacollector.logging.DataCollectorLogger;
import com.aa.otrs.fraudnet.service.FraudNetSoapWrapperService;
import com.google.inject.Inject;

@Stateless
@Interceptors(GuiceInterceptor.class)
public class RejectServiceBean implements IRejectServiceBean{

     @Inject
     private DataCollectorLogger logger;
     @SuppressWarnings("unused")
     @Inject
            private FraudNetSoapWrapperService fraudnetWebService;
     @Resource
     private TimerService timerService;

     public void ejbCreate() throws javax.ejb.CreateException {
         logger.debug("On ejbCreate");
         logger.debug(“RejectServiceBean ");

     }

     public void ejbActivate() {
         logger.debug("ejbActivate");
     }

}

This is ibm-ejb-jar-bnd xml file under META-INF folder.

<ejb-jar-bnd xmlns="http://websphere.ibm.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://websphere.ibm.com/xml/ns/javaee     http://websphere.ibm.com/xml/ns/javaee/ibm-ejb-jar-bnd_1_0.xsd"
    version="1.0">
    <message-driven name="PnrMessageBean">
        <listener-port name="RECLOCATOR.LP" />
    </message-driven>

    <session name="RejectServiceBean">
    <interface class="com.aa.otrs.datacollector.reject.ejb.IRejectServiceBean" 
                binding-name="ejblocal:ejb/RejectServiceBean"/>
    </session>

</ejb-jar-bnd>

import javax.ejb.Local;

@Local
public interface IRejectServiceBean {

    void callingInterface();
}

I have tried implementing stateless session with or without interface and xml file. 

import com.google.inject.Inject;
import javax.annotation.Resource;
import javax.ejb.Stateless;
import javax.ejb.TimedObject;
import javax.ejb.Timeout;
import javax.ejb.Timer;
import javax.ejb.TimerService;
import javax.interceptor.Interceptors;
import com.aa.otrs.datacollector.logging.DataCollectorLogger;
import com.aa.otrs.fraudnet.service.FraudNetSoapWrapperService;

@Stateless
@Interceptors(GuiceInterceptor.class)
public class RejectServiceSessionBean {
     @Inject
     private DataCollectorLogger logger;
     @Inject
     private FraudNetSoapWrapperService fraudnetWebService;

     public void ejbCreate() throws javax.ejb.CreateException {
         logger.debug("On ejbCreate");
         logger.debug("In RejectServiceSessionBean constructor");

     }
     public void ejbActivate() {
         logger.debug("ejbActivate");
     }

public class GuiceInterceptor{
       private static final Injector injector = Guice.createInjector(new EjbEnvironmentModule());

       @PostConstruct
       @PostActivate
       public void autowireBean(InvocationContext invocationContext) {
           Object target = invocationContext.getTarget();
           injector.injectMembers(target);
       }

    } 
```

问题：从上面的两个代码片段中，它永远不会调用 ejbCreate 或 ejbActivate 方法。我已经放置了记录器，以便我可以验证它是否通过这些方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T05:04:17.577

对于 EJB-3.0 无状态 bean，您可以通过使用`@PostConstruct`&`@PreDestroy`注释来拥有生命周期回调方法。

这些方法必须是公共的，返回 void & 不带任何参数。

# php - 用于分页的数组层次结构

> ID：10079186
> 
> 赞同：0
> 
> 时间：2012-04-09T20:12:52.030
> 
> 标签：php, arrays, hierarchy

我遇到了这个表的问题，它通过编码导致了一点停顿。

我有一个 mysql 表，我需要从中创建一个数组。在此示例中，我正在查看 ID 为 9 且没有 parent_id 的 islenska-stig1。

```
INSERT INTO `posts` (`id`, `parent_id`, `category`, `position`, `post_slug`, `titill`) VALUES
(9, 0, 3, 0, 'islenska-stig1', 'Íslenska stig 1'),
(10, 0, 3, 0, 'islenska-stig2', 'Íslenska stig 2'),
(19, 9, 3, 0, 'kafli1', 'Kafli 1'),
(20, 9, 3, 0, 'kafli2', 'Kafli 2',),
(21, 19, 3, 0, 'serhljodar', '1.1 Serhljodar'),
(22, 19, 3, 0, 'samhljodar', '1.2\. Samhljóðar'),
(23, 19, 3, 0, 'malnotkun', '1.3 Málnotkun'),
(24, 21, 3, 1, 'aefing1', 'Æfing 1'),
(26, 21, 3, 3, 'prof1', 'Próf 1'); 
```

我需要将这些信息转换成一个数组，我可以用它来分页（下一个，从当前 slug 开始）。我试图设置的数组看起来像这样：

```
Array
(
    [0] => islenska-stig1
    [1] => kafli1
    [2] => serhljodar
    [3] => aefing1
    [4] => prof1
    [5] => samhljodar
    [6] => malnotkun
    [7] => kafli2
) 
```

然后，当我打开数组 [7] 或 kafli2 时，数组会循环。

任何建议都无需打开与数据库的多个连接？

**添加解释以下内容**

> 然后，当我打开数组 [7] 或 kafli2 时，数组会循环。

如我所见，否则我会从查询中填充更多数据，即 kafli2 （ID#20）的孩子或创建一个新的分页数组。

**选项一**

```
Array
(
    [0] => islenska-stig1
    [1] => kafli2
    [2] => ... 
) 
```

**选项二**

```
Array
(
    [0] => islenska-stig1
    [1] => kafli1
    [2] => serhljodar
    [3] => aefing1
    [4] => prof1
    [5] => samhljodar
    [6] => malnotkun
    [7] => kafli2
    [8] => ... 
) 
```

# algorithm - 哪个函数增长得更快 lg( √n ) vs. √ log n

> ID：10079188
> 
> 赞同：2
> 
> 时间：2012-04-09T20:13:09.683
> 
> 标签：algorithm, big-o

哪个函数增长得更快：lg( √n ) vs. √ lg n？

当我进行计算时，我得到 lg (√n) 更快。它是否正确？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T20:14:56.790

你的计算是正确的。lg (√n) = lg (n ^(1/2) ) = lg(n) / 2，增长为 (√ log n) ²

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:29:53.673

正如评论中提到的，如果我不确定哪一个增长得更快，我通常会绘制两个函数。通常，您会为它们绘制在预期输入范围附近的 n 值，但在这种情况下，您可以看到即使 n 的值很小，lg (√n) 也会增长得更快。

![功能图](../Images/6b893d8a2d03106f77560d683e11cdc2.png)

注意：上图假设**lg以 2 为底，** **log**以 10 为底。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T21:02:12.857

你在比较

**(1)** lg( √n ) = lg( n ^ (1/2) ) = (1/2) * lg( n )

和

**(2)** √ log n = (√ lg n) / (√ lg 10)

去掉常数，剩下的就是`lg( n )`和`√ lg n`。显然，第一个增长得更快。

作为旁注，以 B 为底的 A 的对数等于以 X 为底的 A 的对数除以以 X 为底的 B 的对数，其中 X 是作为对数底的有效值。

# mysql - MySQL 日期时间与前一行的比较

> ID：10079190
> 
> 赞同：0
> 
> 时间：2012-04-09T20:13:19.717
> 
> 标签：mysql, window-functions

我有一个包含两个日期列的表。DATE1 有时为 NULL，有时包含重复值。DATE2 始终填充且唯一。我的表格按最新的 DATE2 日期排序。

我想创建一个新的日期列，其中将选择 DATE1，除非它的值与下一行重复或者它为 NULL。在这种情况下，我想取 DATE2 的值。我还需要两个布尔列来告诉我什么时候满足这些条件。让我用一个例子来演示一下，这样就更清楚了。

在下表中，第 5 行和第 6 行的值为**2011 年 7 月 27 日，**因此我想将第 5 行的新日期列设置为**2011 年 8 月 4 日**（即 DATE2）。在第 3 行中，DATE1 的值为 NULL，所以我想取 DATE2 的值。

我尝试了一些内部选择语句，但无法使其正常工作。有任何想法吗？

我的表目前在数据库中：

```
 Row     DATE1           DATE2
    --------------------------------------
    1       Oct 10, 2011    Nov 13, 2011    
    2       Oct 10, 2011    Oct 10, 2011    
    3       NULL            Oct 8, 2011     
    4       Aug 12, 2011    Aug 12, 2011    
    5       Jul 27, 2011    Aug 4, 2011     
    6       Jul 27, 2011    Jul 28, 2011    
    7       Jul 1, 2011     Jul 26, 2011    
    8       May 24, 2011    Jun 13, 2011 
```

我期望最终结果如下所示：

```
 Row     FINAL_DATE      DATE1_DUPLICATE   DATE1_WAS_NULL
    ----------------------------------------------------------
    1       Nov 13, 2011    TRUE              FALSE   
    2       Oct 10, 2011    FALSE             FALSE
    3       Oct 8, 2011     FALSE             TRUE
    4       Aug 12, 2011    FALSE             FALSE
    5       Aug 4, 2011     TRUE              FALSE 
    6       Jul 27, 2011    FALSE             FALSE
    7       Jul 1, 2011     FALSE             FALSE
    8       May 24, 2011    FALSE             FALSE 
```

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:24:23.020

这可以通过对表的顺序扫描和使用 MySQL 变量来处理。您可以在（**更新**的）[SQL-fiddle](http://sqlfiddle.com/?_escaped_fragment_=2/5063c/3#!2/5063c/19)中进行测试：

```
SELECT date2
     , dd 
     , DATE_FORMAT(dd, '%b %e, %Y') AS final_date
     , date1_duplicate
     , date1_was_null
FROM
( SELECT date2
       , COALESCE( (date1 = @d OR date1 = @prev), FALSE)
           AS date1_duplicate
       , (date1 IS NULL)               AS date1_was_null
       , @d := CASE WHEN (date1 = @d OR date1 = @prev) 
                 THEN date2 
                 ELSE COALESCE(date1, date2) 
               END AS dd
       , @prev := date1 AS pre
  FROM tableX AS t
    CROSS JOIN
      ( SELECT @d := DATE('1000-01-01')
             , @prev := @d 
      ) AS dummy
  ORDER BY date2 ASC 
) AS tmp
ORDER BY date2 DESC
; 
```

# javascript - 如何验证日期输入到 3 个单独的字段？

> ID：10079192
> 
> 赞同：1
> 
> 时间：2012-04-09T20:13:23.400
> 
> 标签：javascript, date

我有三个日期输入字段 - 日、月、年。一旦输入，我应该验证它。使用以下代码：

```
$('#test').click(function(event) {
    var daySelector = "#dd",
        monthSelector = "#mm",
        yearSelector = "#yyyy";
    var day = $(daySelector).val() == "" ? 1 : parseInt($(daySelector).val(), 10);
    var month = $(monthSelector).val() == "" ? 1 : parseInt($(monthSelector).val(), 10);
    var year = parseInt($(yearSelector).val(), 10);
    var date = new Date(year, month, day);
    var result = !isNaN(date.getTime());    
}); 
```

但它接受（即返回`true`）错误值，例如 33/55/2000。我的错误在哪里？ [演示](http://jsfiddle.net/and7ey/43BpT/1/)

我尝试[了另一种方法](http://jsfiddle.net/43BpT/3/)- 它也效果不佳。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:22:07.057

日期对象自动转换溢出。

因此，如果您创建 32.01.2000 并且一月只有 31 天，那么它将创建日期为 01.02.2000 的对象

您必须将验证逻辑从“Is Nan”更改为更复杂的内容；）

需要注意的一件事:)

date.getMonth() 返回 0-11 -> 0 等于 1 月 :P 这是我在答案中最初错误的根源。似乎您必须减少发送给 Date 构造函数的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:18:07.947

考虑现有的解决方案：

*   [https://github.com/JerrySievert/node-date-utils](https://github.com/JerrySievert/node-date-utils)
*   [http://momentjs.com/docs/#/parsing/javascript-date-object/](http://momentjs.com/docs/#/parsing/javascript-date-object/)

=========

**UPD**刚刚从以下框架之一中提取功能：

```
validateDay = function (day, year, month) {
    var date = new Date(year, month, day);
    return (date.getFullYear() === year &&
        date.getMonth() === month &&
        date.getDate() === day);
};​ 
```

# ruby-on-rails - 如何在 ruby on rails 迁移中设置主键？

> ID：10079195
> 
> 赞同：11
> 
> 时间：2012-04-09T20:13:42.063
> 
> 标签：ruby-on-rails, migration

如何为 IdClient 字段设置主键？我已经尝试了所有方法，但我会得到错误（rails 3.0.9）......你能帮帮我吗？

```
class CreateCustomers < ActiveRecord::Migration
  def self.up
    create_table :customers do |t|
      t.integer :IdCustomer
      t.string :username
      t.string :crypted_password
      t.string :password_salt
      t.string :persistence_token
      t.string :email
      t.string :Skype
      t.string :ICQ
      t.string :Firstname
      t.string :Lastname
      t.string :Country
      t.string :State
      t.string :City
      t.string :Street
      t.string :Building
      t.integer :Room
      t.string :AddressNote
      t.date :DateOfReg
      t.integer :CustGroup
      t.float :TotalBuy

      t.timestamps
      add_index(:customers, :IdCustomer, :unique => true)
    end
  end

  def self.down
    drop_table :customers
  end
end 
```

还有如何在模型中设置关系？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-09T20:28:35.343

不要这样做。使用内置`id`字段作为主键。如果你打算使用 Rails，你应该以“Rails 方式”构建你的应用程序，除非你有*充分*的理由不这样做。

如果你真的想这样做，你可以将一个`:primary_key`选项传递给[`create_table`](http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html#method-i-create_table)：

```
create_table :customers, :primary_key => :idClient do |t|
  # ...
end 
```

您还需要通过以下方式告诉模型其主键的名称`self.primary_key = "idClient"`

# sockets - 通过套接字发送结构并在访问该结构时进行段错误

> ID：10079198
> 
> 赞同：0
> 
> 时间：2012-04-09T20:13:45.083
> 
> 标签：sockets, pointers, client, linked-list

我正在构建一个建筑服务器和一个客户端程序。我试图让它们通过套接字进行通信（以防我在 32 位操作系统 Linux 上编写并且客户端和服务器都将在同一系统上运行）。现在，我有下一个结构：

```
struct config_line {
    char name[MAX_WORD];   //1 byte
    int  time;             //4 bytes
};

struct config {
    struct config_line *lines; // 4 bytes, points to a struct of 8 bytes
    int count;                 // 4 bytes
}; 
```

configData 定义如下

```
struct config configData; // global 
```

我像这样发送 configData：

```
send (clients [scn], &configData, sizeof (configData), 0) 
```

现在，在我的客户端程序中，当我尝试访问

```
configData.lines[configIndex].name 
```

它在那条线上有段错误。任何人都知道为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:21:38.383

当您发送 type`config`时，它​​有一个*指针*的空间`config_line`，但不包含（我假设）该指针指向的动态分配的数组中的数据。

然后客户端获取`config`类型，但它具有无效的指针值（在客户端），因为未发送数组并且指针未设置为该数组。（指针在发送方有效，但在客户端无效——它们使用单​​独的内存空间）

您将需要指定一个固定大小的数组，`config`其中可以包含您想要存储的最大元素数量（然后发送将包含该数据），或者发送动态数组的内容并在客户端解析它并将`config`指针设置为该数组，因此取消引用是有效的

# python - Python中的千位分隔符

> ID：10079210
> 
> 赞同：3
> 
> 时间：2012-04-09T20:14:19.303
> 
> 标签：python

> **可能重复：**
> [如何在 Python 2.x 中用逗号打印数字作为千位分隔符](https://stackoverflow.com/questions/1823058/how-to-print-number-with-commas-as-thousands-separators-in-python-2-x)

有谁知道比这更简单的方法来使数字具有数千个分隔符：

```
def addComma(num):
    (num, post) = str(num).split('.')
    num = list(num)
    num.reverse()

    count = 0
    list1 = []

    for i in num:
        count += 1
        if count % 3 == 0:
            list1.append(i)
            list1.append(',')
        else:
            list1.append(i)

    list1.reverse()

    return ''.join(list1).strip(',') + '.' + post 
```

它有效，但它似乎真的很脆弱......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:17:03.643

`locale.format()`与_`grouping=True`

```
>>> import locale
>>> locale.setlocale(locale.LC_NUMERIC, 'en_US')
'en_US'
>>> locale.format("%d", 1234567, grouping=True)
'1,234,456' 
```

有关详细信息，请参阅[http://docs.python.org/library/locale.html#locale.format](http://docs.python.org/library/locale.html#locale.format)。

# php - 如何上传照片

> ID：10079213
> 
> 赞同：-4
> 
> 时间：2012-04-09T20:14:31.303
> 
> 标签：php, facebook, upload, photo

> **可能重复：**
> [使用 facebook API 上传图片](https://stackoverflow.com/questions/1518194/upload-image-with-facebook-api)

有人可以告诉我如何将照片上传到 facebook api。上传不同的照片。我尝试了很多代码，它们可以工作，但 facebook 限制了应用程序，我想要 facebook 不限制它们的代码。帮助我，一些应用程序总是有效.. 1\. [http://www.facebook.com/pages/Fu% C3%9Fballfieber/248155528600196?sk=app_155808804537600](http://www.facebook.com/pages/Fu%C3%9Fballfieber/248155528600196?sk=app_155808804537600) 2\. [http://www.facebook.com/pages/Wundervoll/179034668874524?sk=app_282756095126852](http://www.facebook.com/pages/Wundervoll/179034668874524?sk=app_282756095126852)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:48:44.873

不太确定你想在这里获得什么，但你需要的一切都应该在 facebook 的开发部分。尝试阅读此页面[https://developers.facebook.com/blog/post/498/](https://developers.facebook.com/blog/post/498/)或[https://developers.facebook.com/docs/reference/api/photo/](https://developers.facebook.com/docs/reference/api/photo/)

# python - 在python中跳过for循环的第一个条目？

> ID：10079216
> 
> 赞同：231
> 
> 时间：2012-04-09T20:14:55.987
> 
> 标签：python

在 python 中，我该怎么做：

```
for car in cars:
   # Skip first and last, do work for rest 
```

* * *

## 回答 #1

> 赞同：453
> 
> 时间：2012-04-09T20:16:57.183

要跳过 Python 中的第一个元素，您可以简单地编写

```
for car in cars[1:]:
    # Do What Ever you want 
```

或跳过最后一个元素

```
for car in cars[:-1]:
    # Do What Ever you want 
```

您可以将此概念用于任何[`sequence`](https://docs.python.org/3/glossary.html#term-sequence)（[`iterable`](https://docs.python.org/3/glossary.html#term-iterable)但不能用于任何）。

* * *

## 回答 #2

> 赞同：309
> 
> 时间：2012-04-09T20:17:58.137

其他答案仅适用于序列。

对于任何可迭代，跳过第一项：

```
itercars = iter(cars)
next(itercars)
for car in itercars:
    # do work 
```

如果你想跳过最后一个，你可以这样做：

```
itercars = iter(cars)
# add 'next(itercars)' here if you also want to skip the first
prev = next(itercars)
for car in itercars:
    # do work on 'prev' not 'car'
    # at end of loop:
    prev = car
# now you can do whatever you want to do to the last one on 'prev' 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2012-10-16T09:23:05.857

跳过第一项的最佳方法是：

```
from itertools import islice
for car in islice(cars, 1, None):
    pass
    # do something 
```

[`islice`](https://docs.python.org/3/library/itertools.html#itertools.islice)在这种情况下，用 的起点`1`和 的终点调用`None`，表示 的结束[`iterable`](https://docs.python.org/3/glossary.html#term-iterable)。

为了能够从`iterable`. 例如，`islice(cars, 1, len(cars)-1)`将跳过`cars`.

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2012-04-09T21:06:32.293

这是一个更通用的生成器函数，它从可迭代的开头和结尾跳过任意数量的项目：

```
def skip(iterable, at_start=0, at_end=0):
    it = iter(iterable)
    for x in itertools.islice(it, at_start):
        pass
    queue = collections.deque(itertools.islice(it, at_end))
    for x in it:
        queue.append(x)
        yield queue.popleft() 
```

示例用法：

```
>>> list(skip(range(10), at_start=2, at_end=2))
[2, 3, 4, 5, 6, 7] 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2012-04-09T20:16:50.097

```
for item in list_name[1:-1]:
    #...do whatever 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2019-11-16T09:42:39.007

例子：

```
mylist=['one','two','three','four','five']
for i in mylist[1:]:
   print(i) 
```

In python index start from 0, We can use slicing operator to make manipulations in iteration.

```
for i in range(1,-1): 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-06-28T22:41:03.880

这是我的首选。它不需要在循环中添加太多内容，并且只使用内置工具。

从...来：

```
for item in my_items:
  do_something(item) 
```

到：

```
for i, item in enumerate(my_items):
  if i == 0:
    continue
  do_something(item) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-04-09T20:22:52.677

好吧，您的语法一开始就不是真正的 Python。

Python 中的迭代在容器的内容之上（嗯，从技术上讲，它在迭代器之上），语法为`for item in container`. 在这种情况下，容器是`cars`列表，但您想跳过第一个和最后一个元素，这意味着`cars[1:-1]`（python 列表是从零开始的，负数从末尾开始计数，并且`:`是切片语法。

所以你要

```
for c in cars[1:-1]:
    do something with c 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-09-16T20:21:44.167

基于@SvenMarnach 的答案，但更简单且不使用双端队列

```
>>> def skip(iterable, at_start=0, at_end=0):
    it = iter(iterable)
    it = itertools.islice(it, at_start, None)
    it, it1 = itertools.tee(it)
    it1 = itertools.islice(it1, at_end, None)
    return (next(it) for _ in it1)

>>> list(skip(range(10), at_start=2, at_end=2))
[2, 3, 4, 5, 6, 7]
>>> list(skip(range(10), at_start=2, at_end=5))
[2, 3, 4] 
```

另请注意，根据我的`timeit`结果，这比双端队列解决方案略快

```
>>> iterable=xrange(1000)
>>> stmt1="""
def skip(iterable, at_start=0, at_end=0):
    it = iter(iterable)
    it = itertools.islice(it, at_start, None)
    it, it1 = itertools.tee(it)
    it1 = itertools.islice(it1, at_end, None)
    return (next(it) for _ in it1)
list(skip(iterable,2,2))
    """
>>> stmt2="""
def skip(iterable, at_start=0, at_end=0):
    it = iter(iterable)
    for x in itertools.islice(it, at_start):
        pass
    queue = collections.deque(itertools.islice(it, at_end))
    for x in it:
        queue.append(x)
        yield queue.popleft()
list(skip(iterable,2,2))
        """
>>> timeit.timeit(stmt = stmt1, setup='from __main__ import iterable, skip, itertools', number = 10000)
2.0313770640908047
>>> timeit.timeit(stmt = stmt2, setup='from __main__ import iterable, skip, itertools, collections', number = 10000)
2.9903135454296716 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-04-09T20:17:17.673

如果`cars`是一个序列，你可以这样做

```
for car in cars[1:-1]:
    pass 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-07-18T16:13:35.787

另一种方法：

```
for idx, car in enumerate(cars):
    # Skip first line.
    if not idx:
        continue
    # Skip last line.
    if idx + 1 == len(cars):
        continue
    # Real code here.
    print car 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-06-13T22:57:20.893

该[`more_itertools`](https://more-itertools.readthedocs.io/en/latest/)项目扩展`itertools.islice`到处理负指数。

例子

```
import more_itertools as mit

iterable = 'ABCDEFGH'
list(mit.islice_extended(iterable, 1, -1))
# Out: ['B', 'C', 'D', 'E', 'F', 'G'] 
```

因此，您可以优雅地在可迭代的第一项和最后一项之间应用它切片元素：

```
for car in mit.islice_extended(cars, 1, -1):
    # do something 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2016-12-20T16:20:29.643

我是这样做的，尽管它看起来像一个 hack，但它每次都有效：

```
ls_of_things = ['apple', 'car', 'truck', 'bike', 'banana']
first = 0
last = len(ls_of_things)
for items in ls_of_things:
    if first == 0
        first = first + 1
        pass
    elif first == last - 1:
        break
    else:
        do_stuff
        first = first + 1
        pass 
```

# mysql - 使用 LIKE 搜索重复客户

> ID：10079218
> 
> 赞同：2
> 
> 时间：2012-04-09T20:15:04.750
> 
> 标签：mysql

我试图在如下所示的表中找到重复的客户：

```
customer_id | first_name | last_name 
-------------------------------------
          0 | Rich       | Smith
          1 | Paul       | Jones
          2 | Richard    | Smith
          3 | Jimmy      | Roberts 
```

在这种情况下，我需要一个返回 customer_id 0 和 customer_id 2 的查询。该查询需要找到客户可能缩短了他们的名字的匹配项，Rich 而不是 Richard，或者 Rob 而不是 Robert。

我有这个查询，但它只返回一个（不是两个）匹配项。我需要查询返回的 Rich 和 Richard。

```
select distinct customers.customer_id, concat(customers.first_name,' ',customers.last_name) as name from customers
inner join customers dup on customers.last_name = dup.last_name
where (dup.first_name like concat('%', customers.first_name, '%')
and dup.customer_id <> customers.customer_id )
order by name 
```

有人可以指出我正确的方向吗？

根据@tsOverflow，这是解决我的问题的最后一个查询：

```
select distinct customers.customer_id, concat(customers.first_name,' ',customers.last_name) as name 
from customers
    inner join customers dup on customers.last_name = dup.last_name
where ((dup.first_name like concat('%', customers.first_name, '%') 
            OR (customers.first_name like concat('%', dup.first_name, '%')) 
        )
    and dup.customer_id <> customers.customer_id )
order by name 
```

上述解决方案可能存在性能问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:25:04.173

您的问题是因为 Rich 是 Richard 的子字符串，但反之则不然。

这将检查两种方式：

```
select distinct randomtest.customer_id, concat(randomtest.first_name,' ',randomtest.last_name) as name 
from randomtest
    inner join randomtest dup on randomtest.last_name = dup.last_name
where ((dup.first_name like concat('%', randomtest.first_name, '%') 
            OR (randomtest.first_name like concat('%', dup.first_name, '%')) 
        )
    and dup.customer_id <> randomtest.customer_id )
order by name 
```

我添加了 OR 并反过来检查。请注意，在查询中使用 like 语句会影响性能 - 我不是这方面的专家，只是一个想法。

编辑：正如其他人在评论中提到的那样-这只会捕获“缩短”版本实际上只是一个子字符串的情况，它不会捕获迈克尔->迈克或威廉->比尔的情况，另一方面约翰和一些人名叫约翰逊的人也可能是两个完全不同的人。

# facebook - 获得用户批准后在 facebook 上更改用户的个人资料图片

> ID：10079219
> 
> 赞同：0
> 
> 时间：2012-04-09T20:15:05.697
> 
> 标签：facebook, facebook-graph-api

我正在开发一个 facebook 应用程序，并想问如果我问用户他是否同意将他的个人资料图片更改为我向他展示的图片，并且如果他同意，我会更改是否可能并且不违反 Facebook 规定。

提前致谢。

纳达夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T06:34:46.453

我想这回答了你的问题...... [Facebook API/PHP - 是否可以通过 FB Graph API 更改用户的个人资料图片？](https://stackoverflow.com/questions/4370669/facebook-api-php-is-it-possible-to-change-a-users-profile-image-via-fb-graph) 查看有关此问题的已接受答案，该答案表示您无法使用 API 更改个人资料图片。

# c# - 从数据表中加载标签的文本属性

> ID：10079222
> 
> 赞同：1
> 
> 时间：2012-04-09T20:15:10.960
> 
> 标签：c#

我想从数据库中的值加载 lsbel lbl 商定的数量，我的代码是

```
public void Vehiclenocomboboxload()
       {

           OleDbConnection oleDbConnection1 = new System.Data.OleDb.OleDbConnection(connString);
           oleDbConnection1.Open();

           OleDbCommand oleDbCommand1 = new System.Data.OleDb.OleDbCommand("SELECT driverassignmastertable.drivername, driverassignmastertable.vehicleno, driverassignmastertable.amount, driverassignmastertable.driverpk FROM driverassignmastertable WHERE(((driverassignmastertable.jobcodepk)= @jobcodepk))", oleDbConnection1);
           oleDbCommand1.Parameters.AddWithValue("@jobcodepk", cmbjobcode.SelectedValue);
           OleDbDataReader reader = oleDbCommand1.ExecuteReader();
           DataTable dt = new DataTable();

           dt.Columns.Add("vehicleno", typeof(string));
           dt.Columns.Add("drivername", typeof(string));
           dt.Columns.Add("amount", typeof(int));
           dt.Columns.Add("driverpk", typeof(int));
           dt.Load(reader);
           if (dt.Rows.Count == 0)
           {
               MessageBox.Show("No vehicle Assigned to this Jobcode");

               cmbVehicleno.DataSource = null;
               txtvehicleno.Text = "";
           }
           else
           {

               cmbVehicleno.ValueMember = "driverpk";
               cmbVehicleno.DisplayMember = "vehicleno";
               lblagreeamount.Text = "amount"

               cmbVehicleno.DataSource = dt.DefaultView;

           }

           oleDbConnection1.Close();

       } 
```

一切都很好，但我的问题是我的 lblagreed 金额没有从数据库中获得任何价值我的代码部分是 lblagreeamount.Text = "amount"

任何人都可以建议任何其他数据绑定方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:21:08.583

You haven't assigned a value to your label, just the static "amount":

```
lblagreeamount.Text = "amount" 
```

You need to read the appropriate field of the `DataTable`'s first row:

```
lblagreeamount.Text = dt.Rows[0].Field<int>("amount").ToString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:18:29.390

就用这个

```
lblagreeamount.Text = dt.Row[0]["amount"].ToString(); 
```

# php - mysql 在更新时触发问题

> ID：10079223
> 
> 赞同：3
> 
> 时间：2012-04-09T20:15:15.213
> 
> 标签：php, mysql, stored-procedures, triggers

我正在考虑在我的数据库中使用触发器来跟踪预订的变化。每次添加预订时，我都会在表格中添加一个点，该表格在“任期”中保持得分。

当我运行这个命令时，我可以在添加触发器之前更改 id。

```
UPDATE bookit SET prov_id = 32 where book_id=2; 
```

添加以下触发器后，我无法更新 prov_id 并收到此错误

# 1054 - 'where 子句'中的未知列'bookit.prov_id'

扳机：

```
 delimiter //

 CREATE TRIGGER update_tenure_it BEFORE

 UPDATE ON bookit FOR EACH ROW

 BEGIN

 if(new.prov_id<>old.prov_id) THEN

 UPDATE provider_score set tenure=(tenure+1) where bookit.prov_id=provider_id;

 END IF;

 END;

 // 
```

你知道我做错了什么以及问题出在哪里吗？我什至应该考虑使用触发器进行此类操作还是只在 PHP 中编写代码？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:31:15.497

`TABLENAME.FIELD`在触发器中，您无法通过;直接访问表。相反，更新触发器分别为您提供`old`.* 和`new`.* 作为更新触发之前和之后的行的别名。在这种情况下，以下应该起作用：

```
 delimiter //

 CREATE TRIGGER update_tenure_it BEFORE

 UPDATE ON bookit FOR EACH ROW

 BEGIN

 if(new.prov_id<>old.prov_id) THEN

 UPDATE provider_score set tenure=(tenure+1) where new.prov_id=provider_id;

 END IF;

 END;

 // 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:23:28.637

您的更新需要在 bookit 表中加入您正在更新的 provider_score 表。现在它只是参考了 bookit 悬空。

# php - 为什么我的 h3 会被添加到 wordpress 的 li 标签中？

> ID：10079227
> 
> 赞同：0
> 
> 时间：2012-04-09T20:15:25.840
> 
> 标签：php, javascript, wordpress

我有侧边栏，当我向其中添加组件时，标题会添加到 ul 的 li 项中，使其看起来很难看。我该如何克服这一点。不幸的是，我对 wordpress 和 php 知之甚少或一无所知。

这是我在萤火虫中得到它的方法：

```
<li class="widget widget_categories" id="categories-8"><h2 class="widgettitle">Categories</h2>
        <ul>
    <li class="cat-item cat-item-1"><a title="View all posts filed under Uncategorized" href="http://localhost/wordpress/wordpress/?cat=1">Uncategorized</a>
</li>
        </ul>
</li> 
```

这是我在侧边栏中的内容，除了一些静态的 html ul li 片段：

```
<?php if ( function_exists('dynamic_sidebar') && dynamic_sidebar() ) : else : ?>
        <ul class="ul-cat">

        <?php wp_list_categories('show_count=1&title_li='); ?> 

        <?php wp_get_archives('type=monthly'); ?> 
</ul>       
        <?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:47:34.313

> 要在 sidebar.php 中使用**wp_list_categories**和**wp_get_archives**，您可以关注 [**wp_list_categories**](http://codex.wordpress.org/Template_Tags/wp_list_categories)和[**wp_get_archives**](http://codex.wordpress.org/Template_Tags/wp_get_archives)。

如果您的主题支持动态侧边栏，那么您可以从 sidebar.php 中删除`wp_list_categories`和`wp_get_archives`调用函数，并且可以使用 WordPress 管理 > 外观 > 小部件中的动态小部件，并将`Categories`小部件添加`Archives`到侧边栏。这只是一个例子，基本驻留在里面`functions.php`，生成动态小部件

```
if ( function_exists('register_sidebar') )
register_sidebar(array(
    'name' => 'Sidebar',
    'before_widget' => '<li id="%1$s" class="widget %2$s">',
    'after_widget' => '</li>',
    'before_title' => '<h2 class="widgettitle">',
    'after_title' => '</h2>'
)); 
```

如果你留下`before_title`空白`after_title`如下

```
'before_title' => '',
'after_title' => '' 
```

那么你的`h2`意志就没有了。

**注意：**在您提到的问题中，`h3`但在您生成的 HTML 代码中，我看到了`h2`.

# ruby-on-rails-3 - Rails 应用程序，MySQL 中的foreign_key 列未知

> ID：10079228
> 
> 赞同：1
> 
> 时间：2012-04-09T20:15:26.397
> 
> 标签：ruby-on-rails-3, activerecord, mysql2

我在 Rails 3 应用程序中为遗留数据迁移设置了一个额外的 MySQL 数据库。我可以通过这个类轻松连接到它：

```
class External < ActiveRecord::Base
  self.abstract_class = true
  establish_connection :legacy
end 
```

有两个模型继承了这个类：

```
class LegacySize < External

  set_table_name 'size'
  set_primary_key 'size_id'
  belongs_to :product, :class_name => 'LegacyProduct', :foreign_key => 'product_id'

end

class LegacyProduct < External

  set_table_name 'product'
  set_primary_key 'product_id'
  has_many :sizes, :class_name => 'LegacySize'

end 
```

几个简单的 ActiveRecord 查询看起来不错：

```
> ls = pp LegacySize.all
  LegacySize Load (0.8ms)  SELECT `size`.* FROM `size` 
[#<LegacySize size_id: 1, name: "small", product_id: 1>,
 #<LegacySize size_id: 2, name: "medium", product_id: 1>,
 #<LegacySize size_id: 3, name: "large", product_id: 1>]

> lp = pp LegacyProduct.all
  LegacyProduct Load (0.7ms)  SELECT `product`.* FROM `product` 
[#<LegacyProduct product_id: 1, name: "shirt", price: 10.0>] 
```

但是当我尝试访问关联时，它会查找列“legacy_product_id”而不是“product_id”，我将其定义为大小模型中的外键：

```
> lp = LegacyProduct.find(1).sizes
  LegacyProduct Load (0.9ms)  SELECT `product`.* FROM `product` WHERE `product`.`product_id` = 1 LIMIT 1
  LegacySize Load (0.6ms)  SELECT `size`.* FROM `size` WHERE `size`.`legacy_product_id` = 1
Mysql2::Error: Unknown column 'size.legacy_product_id' in 'where clause': SELECT `size`.* FROM `size`  WHERE `size`.`legacy_product_id` = 1
ActiveRecord::StatementInvalid: Mysql2::Error: Unknown column 'size.legacy_product_id' in 'where clause': SELECT `size`.* FROM `size`  WHERE `size`.`legacy_product_id` = 1 
```

有人看到我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T02:05:09.560

Move the `foreign_key` option from the `belongs_to` to the `has_many :sizes`:

```
class LegacyProduct < External
    ...
    has_many :sizes, :class_name => 'LegacySize', :foreign_key => 'product_id'
    ... 
```

# objective-c - 对于 xCode 中的 XMLparser，我要测试什么字符串名称？

> ID：10079229
> 
> 赞同：1
> 
> 时间：2012-04-09T20:15:27.600
> 
> 标签：objective-c, ios, xml-parsing

我一直在阅读 XML，但仍然无法理解这部分。这很复杂，因为有不止一条类似的线路。对于 xml 文件中的第二行，我如何测试 elementName？“链接”不起作用，“预览”也不起作用，我试过很多其他的

XML 文件：

```
<link rel="alternate" type="text/html" href="http://itunes.apple.com/gb/app/do-not-press-the-red-button/id317885341?mt=8&amp;uo=2"/>

<link title="Preview" rel="enclosure" type="image/jpeg" href="http://abc.jpg" im:assetType="preview"><im:duration>0</im:duration></link> 
```

Xcode 项目：

```
static NSString *kImageStr = @"link";
if ([elementName isEqualToString:kImageStr]){
    //parse it
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:44:18.157

如果您自己正在创建此 XML，那么您可以为其使用命名空间，否则您将必须根据属性区分元素......

在 didStartElement..

```
if ([elementName isEqualToString:@"link"]){

    NSString * name = [attributeDict objectForKey:@"title"];
 } 
```

顺便说一句@“link”应该根据我的工作......

# c++ - 什么会导致在一台计算机上而不是另一台计算机上出现模棱两可的符号错误？

> ID：10079230
> 
> 赞同：2
> 
> 时间：2012-04-09T20:15:34.217
> 
> 标签：c++, visual-studio-2010, compiler-errors

我正在使用 Visual Studio 2010 处理 C++ 代码。该项目及其所有内容已由其他人编写，并复制到共享驱动器上。当创建者在他的计算机上构建它时，它工作正常。当我尝试构建解决方案时，我得到了一大堆这些错误

```
error C2872: '<lambda0>' : ambiguous symbol could be 
 '[File].cpp(66) : anonymous-namespace'::<lambda0>' or 
 '[Different file].h(549) : `anonymous-namespace'::<lambda0>'. 
```

这是一个据说是错误的行的示例：

```
std::pair<int, std::pair<int, Point>> b) -> bool { return (a.second.second < b.second.second ); }); 
```

似乎错误总是以'});'结尾的行发生。在这里展示的完整代码相当庞大，并且它可以在其他计算机上运行，​​所以大概是我的设置或其他什么问题。任何人都可以冒险猜测它们可能是什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:17:25.037

不确定您是否看过这个，但根据 MSDN 页面的编译器错误：

`C2872 can occur if a header file includes a using Directive (C++), and a subsequent header file is #include'd and contains a type that is also in the namespace specified in the using directive. Specify a using directive only after all your header files are specified with #include.`

[MSDN 页面](http://msdn.microsoft.com/en-us/library/t57wswcs.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T21:55:55.013

我在模棱两可的符号问题上遇到了同样的问题。对我来说，事实证明我使用了两个功能相同但定义明显不同的命名空间。我必须停止使用其中一个命名空间，这解决了这个问题。

举个例子：

```
using namespace cv;
using namespace boost::accumulator;
accumulator_set<double, stats<tag::mean, tag::variance> > acc;
double meanval = mean (acc); 
```

这将通过编译错误：`error C2872: 'mean' : ambiguous symbol`这是因为命名空间 cv 和 boost::accumulator 具有相同的函数“mean”

我希望这有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-02T12:24:30.753

我遇到了同样的问题安装 VS2010 SP1`anonymous-namespace'::<lambda0>`为我解决了这个模棱两可的问题。没有 SP1 的 VS2010 存在 lambda 问题。

# android - Android C++ fopen fwrite 和 fclose 如何工作？

> ID：10079232
> 
> 赞同：1
> 
> 时间：2012-04-09T20:16:04.157
> 
> 标签：android, file-io, filesystems

我正在为 android 开发游戏，但我注意到一个我无法解决的错误：

我将游戏进度保存到文件“X”，文件大小为288字节，关闭文件后的最后修改日期为Z，之后，我取出电池并重新放入，我做的第一件事就是读取文件，我注意到文件大小现在为 0 字节，最后修改日期早于 Z =s。

我真的不知道是谁在更改我的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:21:58.757

在卸下电池之前，您是否等待了足够长的时间（不知道在 android 上等待了多长时间，至少超过 3 分钟）？

Android 每 x 秒只将文件写入闪存一次。如果您想确保您的数据实际写入闪存，请使用“ [fsync](http://linux.die.net/man/2/fsync) ”命令。

# c# - 为什么 Regex CompileToAssembly 的性能比已编译的 regex 和 Interpreted Regex 慢？

> ID：10079233
> 
> 赞同：6
> 
> 时间：2012-04-09T20:16:05.090
> 
> 标签：c#, .net, regex

我正在使用以下代码针对已编译的正则表达式测试 CompileToAssembly 性能，但结果不合适。请让我知道我错过了什么。谢谢！！！

```
static readonly Regex regex = new Regex(@"(stats|pause\s?(all|\d+(\,\d+)*)|start\s?(all|\d+(\,\d+)*)|add\s?time\s?(all|\d+(\,\d+)*)(\s\d+)|c(?:hange)?\s?p(?:asskey)?|close)(.*)", RegexOptions.Compiled);
static readonly Regex reg = new Regex(@"(stats|pause\s?(all|\d+(\,\d+)*)|start\s?(all|\d+(\,\d+)*)|add\s?time\s?(all|\d+(\,\d+)*)(\s\d+)|c(?:hange)?\s?p(?:asskey)?|close)(.*)");
static readonly Regex level4 = new DuplicatedString();

    static void Main()
    {
        const string str = "add time 243,3453,43543,543,534534,54534543,345345,4354354235,345435,34543534 6873brekgnfkjerkgiengklewrij";
        const int itr = 1000000;
        CompileToAssembly();
        Match match;
        Stopwatch sw = new Stopwatch();
        sw.Start();
        for (int i = 0; i < itr; i++)
        {
             match = regex.Match(str);
        }
        sw.Stop();
        Console.WriteLine("RegexOptions.Compiled: {0}ms", sw.ElapsedMilliseconds);

        sw.Reset();
        sw.Start();
        for (int i = 0; i < itr; i++)
        {
            match = level4.Match(str);
        }
        sw.Stop();

        Console.WriteLine("CompiledToAssembly: {0}ms", sw.ElapsedMilliseconds);

        sw.Reset();
        sw.Start();
        for (int i = 0; i < itr; i++)
        {
            match = reg.Match(str);
        }
        sw.Stop();
        Console.WriteLine("Interpreted: {0}ms", sw.ElapsedMilliseconds);
        Console.ReadLine();
    }

    public static void CompileToAssembly()
    {
        RegexCompilationInfo expr;
        List<RegexCompilationInfo> compilationList = new List<RegexCompilationInfo>();

        // Define regular expression to detect duplicate words
        expr = new RegexCompilationInfo(@"(stats|pause\s?(all|\d+(\,\d+)*)|start\s?(all|\d+(\,\d+)*)|add\s?time\s?(all|\d+(\,\d+)*)(\s\d+)|c(?:hange)?\s?p(?:asskey)?|close)(.*)",
                   RegexOptions.Compiled,
                   "DuplicatedString",
                   "Utilities.RegularExpressions",
                   true);
        // Add info object to list of objects
        compilationList.Add(expr);

        // Apply AssemblyTitle attribute to the new assembly
        //
        // Define the parameter(s) of the AssemblyTitle attribute's constructor 
        Type[] parameters = { typeof(string) };
        // Define the assembly's title
        object[] paramValues = { "General-purpose library of compiled regular expressions" };
        // Get the ConstructorInfo object representing the attribute's constructor
        ConstructorInfo ctor = typeof(System.Reflection.AssemblyTitleAttribute).GetConstructor(parameters);
        // Create the CustomAttributeBuilder object array
        CustomAttributeBuilder[] attBuilder = { new CustomAttributeBuilder(ctor, paramValues) };

        // Generate assembly with compiled regular expressions
        RegexCompilationInfo[] compilationArray = new RegexCompilationInfo[compilationList.Count];
        AssemblyName assemName = new AssemblyName("RegexLib, Version=1.0.0.1001, Culture=neutral, PublicKeyToken=null");
        compilationList.CopyTo(compilationArray);
        Regex.CompileToAssembly(compilationArray, assemName, attBuilder);
    } 
```

以下是结果：

```
RegexOptions.Compiled: 3908ms
CompiledToAssembly: 59349ms
Interpreted: 5653ms 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T20:35:52.240

Your code has a problem: static field initializers will run *before* static methods run. That means that `level4` has already been assigned before `Main()` runs. This means that the object referred to by `level4` is *not* an instance of the class created in `CompileToAssembly()`.

Note that the example code for `Regex.CompileToAssembly` shows the compilation of the regex and its consumption in *two different programs.* The actual regex you're timing as "CompiledToAssembly" could therefore be a different regex that you compiled in an earlier test.

Another factor to consider: the overhead of loading an assembly into memory and jitting it to machine code might be significant enough that you need more than 1,000,000 iterations to see a benefit.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T20:41:50.587

您正在调试器 (Visual Studio) 下运行。它将防止在加载程序集时发生 JIT 优化。尝试在没有调试器的情况下运行 (ctrl-f5)。

# javascript - 如何隐藏 Jquery 中已使用 .load 函数加载的元素

> ID：10079238
> 
> 赞同：1
> 
> 时间：2012-04-09T20:16:24.810
> 
> 标签：javascript, jquery, ajax, callback, jquery-load

我有一些使用 JQuery 加载函数更新的类。当页面首次加载时，我将它们作为目标并像这样隐藏它们：

```
$('.classname').hide(); 
```

我这样做 ajax`load`是这样的：

```
$.ajax({  
  type: "GET",  
  url: "index.php",  
  data: dataString,  
  success: function() {  
      $('.wrapperClass').load('index.php .wrapperClass');
      $('.classname').hide();
  },
      error: function() {

      }  
}); 
```

为了简单起见，html 是这样的：

```
<div class="wrapperClass">
    <span class="classname">Content 1</span>
    <span class="classname">Content 2</span>
</div> 
```

问题是，`wrapperClass`get 中的所有内容都重新加载正常，但是内部的 span 没有被隐藏，它们重新出现，我不知道在通过 Ajax 重新加载它们后如何隐藏它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T20:18:23.120

您可能（\应该）知道，`load`这是一个 ajax 请求，因此当您尝试隐藏元素时不会加载元素。

将处理加载内容的代码移至完成回调：

```
success: function() {  
      $('.wrapperClass').load('index.php .wrapperClass', function(){
              $('.classname').hide();              
          });
      } 
```

**完整代码：**

```
$.ajax({
    type: "GET",
    url: "index.php",
    data: dataString,
    success: function() {
        $('.wrapperClass').load('index.php .wrapperClass', function() {
            $('.classname').hide();
        });
    },
    error: function() {

    }
});​ 
```

`load` [文档](http://api.jquery.com/load/)：

`.load( url [, data] [, complete(responseText, textStatus, XMLHttpRequest)])`

*   `url`包含请求发送到的 URL 的字符串。
*   `data`随请求发送到服务器的映射或字符串。
*   `complete(responseText, textStatus, XMLHttpRequest)` **请求完成时执行的回调函数。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:21:13.780

您需要坚持`$('.classname').hide();`使用`.load()`. 现在，它试图在元素存在于页面之前隐藏它们。尝试这个：

```
$.ajax({  
  type: "GET",  
  url: "index.php",  
  data: dataString,  
  success: function() {  
      $('.wrapperClass').load('index.php .wrapperClass', function() {$('.classname').hide();});
  },
      error: function() {

      }  
}); 
```

# html - 获取滚动条的默认高度

> ID：10079240
> 
> 赞同：1
> 
> 时间：2012-04-09T20:16:39.777
> 
> 标签：html, css

滚动条的默认高度是多少（水平）？我在网上找不到文件。

更新：我们可以编写一个 javascript 函数来获取它吗？请不要投反对票。很难得到它。 ![高度。](../Images/8bf2d43f76c3f0a987ff8dac2e49423f.png) 谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:05:31.000

在这里找到：[如何获取浏览器的滚动条大小？](https://stackoverflow.com/questions/986937/javascript-get-the-browsers-scrollbar-sizes)

```
function getScrollBarWidth () {
  var inner = document.createElement('p');
  inner.style.width = "100%";
  inner.style.height = "200px";

  var outer = document.createElement('div');
  outer.style.position = "absolute";
  outer.style.top = "0px";
  outer.style.left = "0px";
  outer.style.visibility = "hidden";
  outer.style.width = "200px";
  outer.style.height = "150px";
  outer.style.overflow = "hidden";
  outer.appendChild (inner);

  document.body.appendChild (outer);
  var w1 = inner.offsetWidth;
  outer.style.overflow = 'scroll';
  var w2 = inner.offsetWidth;
  if (w1 == w2) w2 = outer.clientWidth;

  document.body.removeChild (outer);

  return (w1 - w2);
};

alert( getScrollBarWidth () ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:19:04.727

这将取决于客户端的屏幕分辨率和浏览器。如果您解释为什么要问，那么我可能会给出更好的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T20:19:24.077

无论用户的计算机设置什么。对此没有硬性规定。例如，在我的 Ubuntu 机器上，默认滚动条大小为 0 - 而不是传统的滚动条，它有一个带有箭头的滚动线，当鼠标靠近它时会出现，并且它不会占用文档上的空间。但是，在我的 Windows 安装中，滚动条大小为 14 像素，但我可以将其设置为介于 8 到 500 之间的任何值...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T21:03:19.003

有趣的问题。我的想法是：当您感兴趣的房产不可用时，请进行测试。

我能想到的一个 DOM 属性会受到滚动条高度的影响，如果您将其设置为 100%，那么它是主体（或任何具有滚动条的框）的 clientHeight。这可能是一种愚蠢的方法，并且不确定它到底有多有用，但请检查一下：

*   获取clientHeight之前
*   扩展内部元素的宽度，宽度足以产生滚动条
*   之后获取clientHeight
*   减去

我做了一个小提琴。就像我说的，不确定这种方法在现实生活中会有多大用处，但也许这是一个开始。 [http://jsfiddle.net/brico/t6zMN/](http://jsfiddle.net/brico/t6zMN/)

# ruby-on-rails - 可以跳过对 update_attributes 的验证吗？

> ID：10079258
> 
> 赞同：17
> 
> 时间：2012-04-09T20:17:41.243
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

这似乎是一个愚蠢的问题，但我无法在任何地方找到答案！

是否可以`update_attributes()`跳过验证，例如`save(validate: false)`？

我有一个带有一些冗长`text`（不是`string`）字段的长表单，我想为用户提供在表单上保存进度的能力。通常，在他们能够提交并继续之前，我希望答案的长度最小值等，但如果他们只是点击“保存”，我想把他们取得的任何进展放进去数据库，以便他们稍后可以回来完成。在这种情况下有没有办法跳过验证？

环顾四周，似乎我唯一能做的就是像这样单独枚举每个字段：

```
@obj.field1 = ...
@obj.field2 = ...
@obj.field3 = ...
...
@obj.save(:validate => false) 
```

真的是这样吗？我会担心将来某个时候添加另一个字段而忘记在此处更新控制器。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-09T20:22:38.477

```
@obj.attributes = params[:obj]
@obj.save(false) 
```

**Rails 3 更新**

```
@obj.attributes = params[:obj]
@obj.save(:validate => false) 
```

# objective-c - 将脚本属性添加到从 NSObject 派生的 Cocoa 应用程序 ?

> ID：10079263
> 
> 赞同：0
> 
> 时间：2012-04-09T20:17:53.577
> 
> 标签：objective-c, cocoa, applescript, cocoa-scripting

有人可以指出这个工作的一个例子。我只想通过 AppleScript 设置一个属性值。我已经浏览了所有可编写脚本的示例，它们的设置不同。

```
<?xml version="1.0" encoding="UTF-8"?>
<dictionary title="">
<suite name="Circle View Scripting" code="bccS" description="Commands and classes for     Circle View Scripting">
    <class name="application" code="capp" description="" >
        <cocoa class="NSApplication"/>

        <property name="circletext" code="crtx" type="text" description="The text that gets spun into a circle">
            <cocoa key="circleText"/>
        </property>
        <property name="myint" code="crmy" type="integer" description="The text that gets spun into a circle">
            <cocoa key="myInt"/>
        </property>
    </class>
</suite> 
```

头文件：

```
// header 
@interface MyDelegate : NSObject <NSApplicationDelegate> 
{
    WebScriptObject *scriptObject;
    WebView *webView;
    NSWindow *window;
    NSInteger myInt; 
}

// implementation
- (BOOL)application:(NSApplication*)sender delegateHandlesKey:(NSString*)key 
{ 
    return key isEqualToString:@"myInt"] || [key isEqualToString:@"circleText"];;
}

-(NSInteger)myInt
{
    NSInteger myInteger = 42;
    return myInteger;
}

-(void)setMyInt:(NSInteger*)newVal
{
    // do nothing right now
    NSLog(@"SETTER  CALLED");
} 
```

// Applescript 尝试设置属性“myInt”

```
tell application "BrowserConfigClient"  
set myint to 7
properties
end tell 
```

最终，调用了 delegateHandlesKey 方法，我能够为属性返回一个值，但永远不会调用 setter。提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T15:20:26.613

Your method statement has an error...

```
-(void)setMyInt:(NSInteger*)newVal 
```

There should not be a "*" as NSInteger is not a "pointer" variable. I see in the comments of your question that Ken Thomases has already told you this so make sure to fix it.

So if this is not your problem then look at your sdef file. I can see you did not close the dictionary tag. You need this as the last line of that file.

```
</dictionary> 
```

I also have this as the second line in my sdef files...

```
<!DOCTYPE dictionary SYSTEM "file://localhost/System/Library/DTDs/sdef.dtd"> 
```

# mysql - 如何正确查询规范化数据库

> ID：10079264
> 
> 赞同：3
> 
> 时间：2012-04-09T20:17:56.990
> 
> 标签：mysql, database

我正在重新设计一个 MySQL 数据库，该数据库具有一个包含大约 1,500 列的表以及其他表。我们希望通过创建第二个表来规范化该表中的数据，该表将为初始表中存在的每一列/行提供一条记录。我们称这些表为 Master 和 MasterData。Master 将包含该表中所有记录所需的基本信息。MasterData 将包含一些与主表中的记录有关的附加数据的值。所以假设 Master 看起来像这样：

```
MasterID     Property1     Property2
1            Yes           No
2            No            Yes
3            Yes           Yes
4            No            No 
```

假设 MasterData 看起来像这样：

```
MasterID     Property     Value
1            Property3    Yes
1            Property4    No
3            Property3    No
4            Property7    Yes 
```

跟我到现在？如何查询此数据，并且每个匹配的主行仅返回一行，但包含所有相关的 MasterData 信息。我已经搜索并找到了几个示例，但它们需要很长时间才能在我们的数据上执行。我根据前面提到的一个巨大表中的现有数据创建了一个测试 MasterData 表。这导致 MasterData 有大约 450 万条记录，并且以下查询的执行时间太长并且超时。

```
SELECT Property1, Property2, Master.MasterID,
    GROUP_CONCAT(case when Property = "Property3" then Value end) as Property3, 
    GROUP_CONCAT(case when Property = "Property7" then Value end) as Property7
FROM Master LEFT JOIN MasterData USING (MasterID) GROUP BY MasterID
HAVING Property3='Yes' OR Property7='Yes'; 
```

或者

```
Select * FROM Master AS M, MasterData AS MD1, MasterData AS MD2 
WHERE M.MasterID=MD1.MasterID AND MD1.Property='Property3' AND MD1.Value='Yes' 
AND M.MasterID=MD2.MasterID AND MD2.VAR='Property7' AND MD2.Value='Yes'; 
```

同样，我们的目标是能够在一行中检索 MasterData 中的所有数据，就好像它是 Master 中的一列一样。这可能吗？

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:12:51.277

> 同样，我们的目标是能够在一行中检索 MasterData 中的所有数据，就好像它是 Master 中的一列一样。这可能吗？

在没有完全理解你的目标的情况下，我会冒险说这可能是*可能的*，严格来说。但这在任何实际意义上都不太可能。即使在最好的情况下（只有一两个属性），性能也可能很糟糕；在可能的情况下（什么，在 30 到 500 个属性之间），您可能会完全关闭服务器。

*规范化*并不意味着“创建第二个表，该表将为初始表中存在的每一列/行记录”。这并不意味着任何事情，即使是*那样*的遥远。但是标准化*可能*会真正解决您的问题。（根据我的经验，大多数数据库问题都是结构性的。）

您在这里提出的解决方案不能很好地解决您没有说明的问题。要充分利用 StackOverflow 的专业知识，请说明您尝试解决的问题以及您尝试过的解决方案。

[关于数据库规范化的维基百科文章](http://en.wikipedia.org/wiki/Database_normalization)

* * *

如果你从这样的表开始。. .

```
create table master_data (
  master_id integer not null,
  property_name varchar(30) not null,
  property_value boolean not null default true,
  primary key (master_id, property_name)
);

insert into master_data values
(1, 'Property3', true),
(1, 'Property4', false),
(3, 'Property3', false),
(4, 'Property7', true); 
```

. . . 那么您可以通过一个简单的查询获得所有事物的所有属性。（假设您的所有属性都是布尔值。）

```
select * 
from master_data
order by master_id, property_name
--
1   Property3   t
1   Property4   f
3   Property3   f
4   Property7   t 
```

应用程序代码可以非常简单地循环。您也许可以删除 property_value 为 false 的所有行。

这种结构允许每个事物有无限数量的属性。但是您的要求是 a) 在单行中返回任意数量的属性，并且 b) 对应用程序代码进行最小的更改必须更改。没有办法解决这个问题。

* * *

如果您的表包含这些行。. .

```
insert into master_data values
(1, 'Property3', true),
(1, 'Property4', false),
(3, 'Property3', false),
(4, 'Property7', true),
(1, 'Property7', true); 
```

这是获取一组符合条件的“事物”并将该集合连接到主数据表的一种方法。

```
select md.* 
from master_data md
inner join (select master_id
            from master_data
            where (
              (property_name = 'Property3' and property_value = true) or
              (property_name = 'Property7' and property_value = true)
            )
            group by master_id 
            having count(*) = 2 ) cd
  on (md.master_id = cd.master_id) 
```

就其价值而言，标准化仍然*可能是*您长期维护和性能的最佳选择。这种结构（上图）没有归一化；大数据集的性能通常很差。（在这方面，带有可选 hstore 模块的 PostgreSQL 可能比 MySQL 更好。）

# java - 在 Java 中复制 HashMap

> ID：10079266
> 
> 赞同：135
> 
> 时间：2012-04-09T20:18:00.047
> 
> 标签：java, copy, hashmap, clone

我正在尝试保留一个包含 member 的类的临时容器：

```
HashMap<Integer,myObject> myobjectHashMap 
```

一个名为 myobjectsList 的类

然后我做

```
myobjectsListA = new myobjectsList();
myobjectsListB = new myobjectsList(); 
```

然后：将一些哈希图项添加到 A（如 2）

然后：

```
myobjectListB = myobjectListA; //B has 2 
```

然后：将 hashmap 项添加到 A（如 4 个以上）

然后：将A返回到B中存储的项目

```
myobjectListA = myobjectListb; 
```

但是当我这样做时，B 与 A 一起增长，而我将 hashmap 项添加到 A。A 现在有 6 个项目，因为 B 有 6 个。

我希望 A 在最后一次分配后仍然有原来的 2。在 C++ 中我会使用对象的复制，java 的等价物是什么？

补充：好的，我遗漏了一些东西来解释这一点。`MyObjectsList`不包含 HashMap，它派生自`MyBaseOjbectsList`具有 HashMap 成员和`MyObjectsList`extends的类`MyBaseOjbectsList`。这有什么不同吗？

* * *

## 回答 #1

> 赞同：256
> 
> 时间：2012-04-09T20:31:42.587

如果你想要一份 HashMap 的副本，你需要用它来构造一个新的。

```
myobjectListB = new HashMap<Integer,myObject>(myobjectListA); 
```

这将创建地图的（浅）副本。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-04-02T13:50:41.840

你也可以使用

```
clone() 
```

将所有元素从一个 hashmap 复制到另一个 hashmap 的方法

将所有元素从一个 hashmap 复制到另一个的程序

```
import java.util.HashMap;

public class CloneHashMap {    
     public static void main(String a[]) {    
        HashMap hashMap = new HashMap();    
        HashMap hashMap1 = new HashMap();    
        hashMap.put(1, "One");
        hashMap.put(2, "Two");
        hashMap.put(3, "Three");
        System.out.println("Original HashMap : " + hashMap);
        hashMap1 = (HashMap) hashMap.clone();
        System.out.println("Copied HashMap : " + hashMap1);    
    }    
} 
```

来源： [http ://www.tutorialdata.com/examples/java/collection-framework/hashmap/copy-all-elements-from-one-hashmap-to-another](http://www.tutorialdata.com/examples/java/collection-framework/hashmap/copy-all-elements-from-one-hashmap-to-another)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-04-09T20:25:05.420

不同之处在于，在 C++ 中，您的对象位于堆栈中，而在 Java 中，您的对象位于堆中。如果 A 和 B 是对象，那么在 Java 中的任何时候你都可以：

```
B = A 
```

A 和 B 指向同一个对象，所以你对 A 做的任何事情都会对 B 做，反之亦然。

`HashMap()`如果您想要两个不同的对象，请使用 new 。

您可以使用`Map.putAll(...)`在两个地图之间复制数据。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-02-08T09:24:26.563

这里有一个小的（巨大的）轻描淡写。如果要复制`HashMap`具有嵌套结构的 a，`HashMap.putAll()`将按引用复制，因为它不知道如何准确复制您的对象。[例如：](https://code.sololearn.com/c6Eq9jB2WTfs)

```
import java.util.*;
class Playground {
    public static void main(String[ ] args) {
        Map<Integer, Map<Integer,List<Float>>> dataA = new HashMap<>();
        Map<Integer, Map<Integer,List<Float>>> dataB = new HashMap<>();

        dataA.put(1, new HashMap<>());
        dataB.putAll(dataA);

        assert(dataB.get(1).size() == 0);

        dataA.get(1).put(2, new ArrayList<>());

        if (dataB.get(1).size() == 1) { // true
            System.out.println(
                "Sorry object reference was copied - not the values");
        }
    }
} 
```

所以基本上你需要像这里一样自己复制字段

```
List <Float> aX = new ArrayList<>(accelerometerReadingsX);
List <Float> aY = new ArrayList<>(accelerometerReadingsY);

List <Float> gX = new ArrayList<>(gyroscopeReadingsX);
List <Float> gY = new ArrayList<>(gyroscopeReadingsY);

Map<Integer, Map<Integer, Float>> readings = new HashMap<>();

Map<Integer,List<Float>> accelerometerReadings = new HashMap<>();
accelerometerReadings.put(X_axis, aX);
accelerometerReadings.put(Y_axis, aY);
readings.put(Sensor.TYPE_ACCELEROMETER, accelerometerReadings);

Map<Integer,List<Float>> gyroscopeReadings = new HashMap<>();
gyroscopeReadings.put(X_axis, gX);
gyroscopeReadings.put(Y_axis, gY);
readings.put(Sensor.TYPE_GYROSCOPE, gyroscopeReadings); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-05-23T09:52:12.857

如果我们想在 Java 中复制一个对象，我们需要考虑两种可能性：**浅拷贝**和**深拷贝**。

**浅拷贝**是我们只复制字段值的方法。因此，副本可能依赖于原始对象。在**深度复制**方法中，我们确保树中的所有对象都被深度复制，因此副本不依赖于任何可能会更改的早期现有对象。

这个问题是对**深拷贝**方法应用的完美定义。

首先，如果您有一个简单的`HashMap<Integer, List<T>>`地图，那么我们只需创建一个这样的解决方法。创建`List<T>`.

```
public static <T> HashMap<Integer, List<T>> deepCopyWorkAround(HashMap<Integer, List<T>> original)
{
    HashMap<Integer, List<T>> copy = new HashMap<>();
    for (Map.Entry<Integer, List<T>> entry : original.entrySet()) {
        copy.put(entry.getKey(), new ArrayList<>(entry.getValue()));
    }
    return copy;
} 
```

这个使用`Stream.collect()`方法创建克隆地图，但使用与前一种方法相同的想法。

```
public static <T> Map<Integer, List<T>> deepCopyStreamWorkAround(Map<Integer, List<T>> original)
{
    return original
            .entrySet()
            .stream()
            .collect(Collectors.toMap(Map.Entry::getKey, valueMapper -> new ArrayList<>(valueMapper.getValue())));
} 
```

但是，如果里面的实例`T`也是**可变对象**，我们就有大问题了。在这种情况下，真正的深拷贝是解决此问题的替代方案。它的优点是至少对象图中的每个**可变对象**都是递归复制的。由于副本不依赖于之前创建的任何**可变对象**，因此不会像我们在浅副本中看到的那样意外修改它。

为了解决这个问题，这个深拷贝实现将完成这项工作。

```
public class DeepClone
{
    public static void main(String[] args)
    {
        Map<Long, Item> itemMap = Stream.of(
                entry(0L, new Item(2558584)),
                entry(1L, new Item(254243232)),
                entry(2L, new Item(986786)),
                entry(3L, new Item(672542)),
                entry(4L, new Item(4846)),
                entry(5L, new Item(76867467)),
                entry(6L, new Item(986786)),
                entry(7L, new Item(7969768)),
                entry(8L, new Item(68868486)),
                entry(9L, new Item(923)),
                entry(10L, new Item(986786)),
                entry(11L, new Item(549768)),
                entry(12L, new Item(796168)),
                entry(13L, new Item(868421)),
                entry(14L, new Item(923)),
                entry(15L, new Item(986786)),
                entry(16L, new Item(549768)),
                entry(17L, new Item(4846)),
                entry(18L, new Item(4846)),
                entry(19L, new Item(76867467)),
                entry(20L, new Item(986786)),
                entry(21L, new Item(7969768)),
                entry(22L, new Item(923)),
                entry(23L, new Item(4846)),
                entry(24L, new Item(986786)),
                entry(25L, new Item(549768))
        ).collect(entriesToMap());

        Map<Long, Item> clone = DeepClone.deepClone(itemMap);
        clone.remove(1L);
        clone.remove(2L);

        System.out.println(itemMap);
        System.out.println(clone);
    }

    private DeepClone() {}

    public static <T> T deepClone(final T input)
    {
        if (input == null) return null;

        if (input instanceof Map<?, ?>) {
            return (T) deepCloneMap((Map<?, ?>) input);
        } else if (input instanceof Collection<?>) {
            return (T) deepCloneCollection((Collection<?>) input);
        } else if (input instanceof Object[]) {
            return (T) deepCloneObjectArray((Object[]) input);
        } else if (input.getClass().isArray()) {
            return (T) clonePrimitiveArray((Object) input);
        }

        return input;
    }

    private static Object clonePrimitiveArray(final Object input)
    {
        final int length = Array.getLength(input);
        final Object output = Array.newInstance(input.getClass().getComponentType(), length);
        System.arraycopy(input, 0, output, 0, length);
        return output;
    }

    private static <E> E[] deepCloneObjectArray(final E[] input)
    {
        final E[] clone = (E[]) Array.newInstance(input.getClass().getComponentType(), input.length);
        for (int i = 0; i < input.length; i++) {
            clone[i] = deepClone(input[i]);
        }

        return clone;
    }

    private static <E> Collection<E> deepCloneCollection(final Collection<E> input)
    {
        Collection<E> clone;
        if (input instanceof LinkedList<?>) {
            clone = new LinkedList<>();
        } else if (input instanceof SortedSet<?>) {
            clone = new TreeSet<>();
        } else if (input instanceof Set) {
            clone = new HashSet<>();
        } else {
            clone = new ArrayList<>();
        }

        for (E item : input) {
            clone.add(deepClone(item));
        }

        return clone;
    }

    private static <K, V> Map<K, V> deepCloneMap(final Map<K, V> map)
    {
        Map<K, V> clone;
        if (map instanceof LinkedHashMap<?, ?>) {
            clone = new LinkedHashMap<>();
        } else if (map instanceof TreeMap<?, ?>) {
            clone = new TreeMap<>();
        } else {
            clone = new HashMap<>();
        }

        for (Map.Entry<K, V> entry : map.entrySet()) {
            clone.put(deepClone(entry.getKey()), deepClone(entry.getValue()));
        }

        return clone;
    }
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-06-27T09:05:16.857

从 Java 10 开始可以使用

```
Map.copyOf 
```

用于创建一个**浅拷贝**，它也是不可变的。（这是它的[Javadoc](https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/util/Map.html#copyOf(java.util.Map))）。对于**深层副本**，如本[答案中所述，您](https://stackoverflow.com/a/56272565/2381172)需要某种值映射器来制作值的安全副本。不过，您不需要复制*密钥*，因为它们必须是*不可变*的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-04-09T20:24:27.943

在 Java 中，当您编写时：

```
Object objectA = new Object();
Object objectB = objectA; 
```

`objectA`并且`objectB`是相同的并且指向相同的引用。改变一个会改变另一个。因此，如果您更改`objectA`（而不是其引用）的状态，`objectB`也将反映该更改。

但是，如果你写：

```
objectA = new Object() 
```

Then`objectB`仍然指向您创建的第一个对象（ original `objectA`），而`objectA`现在指向一个新对象。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-11-17T08:46:27.163

由于这个问题仍然没有答案，而且我遇到了类似的问题，我会尝试回答这个问题。问题（正如其他人已经提到的）是您只是将引用复制到同一个对象，因此对副本的修改也会修改原始对象。所以你要做的是复制对象（你的地图值）本身。最简单的方法是让所有对象都实现可序列化接口。然后序列化和反序列化您的地图以获得真实副本。您可以自己执行此操作，也可以使用您可以在此处找到的 apache commons SerializationUtils#clone()： [https ://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/ lang/SerializationUtils.html](https://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/SerializationUtils.html)但请注意，这是最简单的方法，但序列化和反序列化大量对象是一项昂贵的任务。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-09T20:30:07.990

您将一个对象分配给另一个对象，您所做的只是复制对该对象的*引用*，而不是它的内容。您需要做的是获取对象 B 并手动将对象 A 的内容复制到其中。

如果您经常这样做，您可能会考虑`clone()`在类上实现一个方法，该方法将创建一个相同类型的新对象，并将其所有内容复制到新对象中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-03-04T16:39:57.290

由于 OP 已经提到他无法访问其中存在 HashMap 的基类 - 恐怕只有很少的选项可用。

在 Java 中执行对象的深层复制的一种（非常缓慢且资源密集的）方法是滥用许多类有意或无意扩展的“可序列化”接口，然后利用它来将您的类序列化为 ByteStream。反序列化后，您将拥有相关对象的深层副本。

可以在此处找到此指南：[https ://www.avajava.com/tutorials/lessons/how-do-i-perform-a-deep-clone-using-serializable.html](https://www.avajava.com/tutorials/lessons/how-do-i-perform-a-deep-clone-using-serializable.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-08-03T14:53:40.083

Java supports **shallow**(not deep) copy concept

You can archive it using:

*   constructor
*   `clone()`
*   `putAll()`

# android - Android Opengl-es glAlphaBlend() 从图片中去除绿色

> ID：10079273
> 
> 赞同：0
> 
> 时间：2012-04-09T20:18:40.070
> 
> 标签：android, opengl-es, alphablending

我试图弄清楚如何删除我正在渲染的图片的所有绿色像素。我已经在网上搜索过，但没有找到我可以使用的东西。

我知道我可能必须使用这个功能：

```
 gl.glEnable(GL10.GL_BLEND);
    gl.glBlendFunc(GL10.GL_SRC_ALPHA, GL10.GL_ONE_MINUS_SRC_ALPHA); 
```

如果我是对的，如何将颜色更改为绿色？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:25:37.413

你的意思是你有一个纹理，它有绿色像素，应该是透明的？（对此的搜索词可能是“色度键”）

如果是这样，那么在 OpenGL 中启用此功能并非易事。你有两个选择：

*   预处理图像以将所有绿色像素转换为 ALPHA=0 像素，然后启用 alpha 测试。
*   编写一个自定义片段着色器，拒绝某种颜色的片段。

# php - 在 php 中回显带有参数的 javascript 函数

> ID：10079274
> 
> 赞同：2
> 
> 时间：2012-04-09T20:18:43.373
> 
> 标签：php, javascript

我正在尝试在 php 中传递带有 onclick 事件的 JavaScript 函数。我面临的问题是我需要传递的函数有一个需要用双引号括起来的参数，如下所示：

```
onclick="removeElement("div8")" 
```

现在，当我使用 JavaScript 生成参数时，结果很好，但是每当我在 php 中使用 echo 函数时，当我在浏览器中查看该函数时会发生以下情况

```
onclick="removeElement(" div8")" 
```

我用来生成它的代码是：

```
echo '<div><img src="img.png" alt="image" onclick="removeElement("div'.$x.'")" /></div>'; 
```

其中 $x 是要添加到参数的数字。

有没有办法将函数作为一个整体返回，而不是在两者之间留出空间？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-09T20:21:14.857

发生这种情况是因为引号内有引号。这将不起作用，并且会破坏 HTML 解析器。它将 onclick 视为`removeElement(`，然后它看到一个名为 的属性`div8")"`。

试试这个：

```
echo '.....onclick="removeElement(&quot;div'.$x.'&quot;)"...'; 
```

HTML 实体在属性内部进行解析，因此结果将是您的工作代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:20:43.393

将您的回声更改为：

```
echo '<div><img src="img.png" alt="image" onclick="removeElement(\'div'.$x.'\')" /></div>'; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T20:23:08.200

您必须在 javascript 中转义引号。代替

```
onclick="removeElement("div8")" 
```

你应该写

```
onclick="removeElement(&quot;div8&quot;)" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T20:21:25.823

尝试转义你的单引号

```
echo '<div><img src="img.png" alt="image" onclick="removeElement(\'div'.$x.'\')" /></div>'; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-09T20:22:00.973

只要您不在属性值中使用任何空格，您就可以省略 html 属性值周围的引号。所有浏览器都会处理得很好。所以你可以写：

```
onclick=removeElement("div8") 
```

您也可以使用单引号：

```
onclick="removeElement('div8')" or 
onclick='removeElement("div8")' 
```

或者您可以转义双引号：

```
echo '<div><img src="img.png" alt="image" onclick="removeElement(\"div'.$x.'\")" /></div>'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-09T20:37:14.297

但更简单的解决方案是直接用 html 编写：

```
?>
<div>
 <img src='img.png' alt='image' onclick='removeElement("div<?php echo $x; ?>")' />
</div> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-04T02:57:29.183

当你使用 php echo 试试这段代码

```
<a href="javascript:add_cota(<?php echo $value->ID .','.$k.', \''.$st.'\'';?>)"> 
```

> $st 是避免 ReferenceError: Active is not defined 错误的字符串参数

# cakephp-1.3 - 对 multilpe 记录使用表单助手

> ID：10079283
> 
> 赞同：0
> 
> 时间：2012-04-09T20:19:21.803
> 
> 标签：cakephp-1.3, formhelper, multiple-records

我有一张桌子叫`specs`. 我需要以一种形式从其中编辑多行并立即保存。

```
// table structure
specs [id, name, value, owner_id]
// controller part
$data = $this->Spec->find('all'); // skipping the conditions and other sub-code
$data = set::combine(...);
/*
result, keyed using the spec[id] column.
array (
  [3] = array(id=>...),
  [22] = array(id=>...)
)
*/ 
```

现在我不确定如何继续。我知道如何构建一个准备好创建新的多条记录的表单（Model.{n}.fieldname），但是我怎样才能创建一个允许的“编辑”表单`saveAll()`？

尝试遍历结果数组使表单关闭..但我看不到输入元素中字段的值..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:47:36.280

你可以试试这个：

在控制器中：

```
public function edit() {
    $products = $this->Product->find('all');
    if (!empty($this->data)) {
        if ($this->Product->saveAll($this->data['Product'])) {
            $this->Session->setFlash('ok');
        } else {
            $this->Session->setFlash('not ok');
        }
    } else {
        $this->data['Product'] = Set::extract($products, '{n}.Product');
    }
    $this->set(compact('products'));
} 
```

在视图中：

```
echo $this->Session->flash();

echo $this->Form->create('Product');

foreach ($products as $i => $product) {
    echo $this->Form->input("$i.id");
    echo $this->Form->input("$i.name");
}

echo $this->Form->end('Save'); 
```

PS：我认为您可以`Product`根据您的需要调整我的示例，不是吗？:)

# unicode - Overriden browser "encoding" setting causes invalid characters to be sent in POST data

> ID：10079285
> 
> 赞同：0
> 
> 时间：2012-04-09T20:19:26.207
> 
> 标签：unicode, encoding, character-encoding

I'm running into a frustrating problem that arises when the browser "encoding" setting is forced into something other than "Auto-Detect." When my HTML form gets POSTed, characters such as "?" or "Â" are making their way into the database. Is there a good way to deal with this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T21:39:23.667

似乎至少在某些浏览器上，`accept-charset`标签`form`中指定了表单数据的编码，其方式不受用户可能对设置所做的事情的影响。这听起来很合理。表单数据编码可能与页面的编码不同，属性就是为此而存在的。

# javascript - 带有 ASP.NET 的 jQuery UI 模式确认对话框未触发 onClick 事件

> ID：10079286
> 
> 赞同：1
> 
> 时间：2012-04-09T20:19:31.490
> 
> 标签：javascript, jquery, asp.net, jquery-ui, jquery-ui-dialog

jQuery新手在这里。我在这个网站上查看了几十个类似的问题，以及到目前为止提供的答案，所有答案都几乎相同，我已经尝试了所有这些问题，但没有任何东西对我有用。

对于我的 .aspx 中的 Javascript 代码，我目前有：

```
<script type="text/javascript" src="/resources/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="/resources/jquery-ui-1.8.20.custom.min.js"></script>
<link rel="stylesheet" type="text/css" href="/resources/ui-lightness/jquery-ui-1.8.20.custom.css" />

<script language="javascript" type="text/javascript">
    $(function() {
        var $myDialog = $("#cancelDialog").dialog({
            autoOpen: false,
            modal: true,
            buttons: {
                'Yes, cancel': function() {
                    $(this).dialog('close');
                    return true;
                },
                'No, resume editing': function() {
                    $(this).dialog('close');
                    return false;
                }
            }
        });

        $("[id$=btnCancel]").click(function(e) {
            //e.preventDefault();
            alert('boo');
            //$myDialog.dialog('open');
        });
    });
</script> 
```

“btnCancel”的标记看起来像这样 - 请注意我没有“onClientClick”属性，因为 jQuery 应该为我执行此操作，对吗？

```
<asp:Button ID="btnCancel" CssClass="btnCancel" runat="server" Text="Cancel"
    CausesValidation="false" UseSubmitBehavior="false" /> 
```

这是我对取消对话框的标记：

```
<div id="cancelDialog" style="display: none;" title="Please confirm cancellation">
    <p>Are you sure you wish to cancel and abandon your changes?</p>
</div> 
```

根据我见过的所有示例（以及此处提供的答案），这应该会给我一个 jQuery UI 弹出窗口，其中包含两个可以正常工作的按钮。当我点击取消按钮时，该页面不再发回（由于我在 Patrick Scott 的建议下所做的更改）。我可以为此使用标准的 Javascript 确认（）对话框，但我希望能够自定义提示/样式。

我能想到的唯一其他信息是此代码位于 ASP.NET 向导控件上（取消按钮位于 StepNavigationTemplate 中），但这不重要，不是吗？

非常感谢任何有关我需要更改以使其正常工作的提示！

*（问题和代码已更新以反映我最近所做的更改）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:32:04.107

它不起作用的原因是按钮的 ID 在呈现到页面时会发生变化。要在 JavaScript 中访问控件，您需要使用以下`ClientID`属性：

```
$("#<%= btnCancel.ClientID %>").click(function(e){
    //open the dialog
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:38:55.597

使用 $("[id$=btnCancel]") 作为点击事件的选择器。

$= 表示以 jquery 选择器结尾，并且 webforms 添加了一堆会使您的 id 不匹配的东西。

```
$("[id$=btnCancel]").click(function(e) { 
```

我也不明白为什么您将按钮与对话框的其余部分分开声明...

改为这样做：

```
$(function() {
        var $myDialog = $("#cancelDialog").dialog({
            autoOpen: false,
            modal: true,
            buttons: {
                    'Yes, cancel': function() {
                        $(this).dialog('close');
                        return true;
                    },
                    'No, resume editing': function() {
                        $(this).dialog('close');
                        return false;
                    }
                }
        });

        $("[id$=btnCancel]").click(function(e) {
            e.preventDefault();
            $myDialog.dialog('open');
        });
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T20:33:50.533

您需要将其分解 - 听起来 JS 中有另一个错误，您看不到，因为页面正在重新发布。尝试点击警报：

```
$('#btnCancel').click(function(e) {
alert('boo');
}); 
```

如果这不起作用，您需要制作最简单的脚本使其工作，然后添加到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T17:18:29.417

我想到了！事实证明，`<script>`标签（似乎也不是大多数其他标签）在 HTML4 或 HTML5 中不能自闭合。我是这样写的：

```
<script type="text/javascript" src="whatever" /> 
```

当根据标准时，它们必须这样写：

```
<script type="text/javascript" src="whatever"></script> 
```

这使我的第一个`<script>`包含工作（jquery-1.7.2.min.js），但随后的失败。很奇怪吧？

以下是一些支持信息的链接：

*   [http://www.w3.org/TR/html4/interact/scripts.html#h-18.2.1（HTML4](http://www.w3.org/TR/html4/interact/scripts.html#h-18.2.1)规范）
*   [<script> 标签不能自闭吗？](https://stackoverflow.com/questions/4531772/can-the-script-tag-not-be-self-closed)
*   [http://tiffanybbrown.com/2011/03/23/html5-does-not-allow-self-closing-tags/](http://tiffanybbrown.com/2011/03/23/html5-does-not-allow-self-closing-tags/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-16T16:20:42.683

```
<%=this.Page.ClientScript.GetPostBackEventReference(new PostBackOptions(this.Button1))%>; 
```

将其连接到模态确认对话框上的“是”按钮。您需要根据需要更改 ID。

# c++ - 尝试使用 Boost.Filesystem 但它似乎没有链接？

> ID：10079287
> 
> 赞同：2
> 
> 时间：2012-04-09T20:19:31.810
> 
> 标签：c++, boost, filesystems, boost-filesystem

我正在使用 OS X 10.7.3。我已经玩了一段时间的 boost 标头，我想继续使用 Boost.Filesystem 库，但是它一直向我抛出这个消息：

```
Undefined symbols for architecture x86_64:
  "boost::system::generic_category()", referenced from:
      __static_initialization_and_destruction_0(int, int)in ccOhIhNG.o
      boost::filesystem3::detail::create_directories(boost::filesystem3::path const&,     boost::system::error_code*)in libboost_filesystem.a(operations.o)
      boost::filesystem3::detail::canonical(boost::filesystem3::path const&,     boost::filesystem3::path const&, boost::system::error_code*)in     libboost_filesystem.a(operations.o)
  "boost::system::system_category()", referenced from:
      __static_initialization_and_destruction_0(int, int)in ccOhIhNG.o
      (anonymous namespace)::error(bool, boost::system::error_code const&,     boost::filesystem3::path const&, boost::system::error_code*, std::basic_string<char,     std::char_traits<char>, std::allocator<char> > const&)in libboost_filesystem.a(operations.o)
      (anonymous namespace)::error(bool, boost::filesystem3::path const&,     boost::system::error_code*, std::basic_string<char, std::char_traits<char>,     std::allocator<char> > const&)in libboost_filesystem.a(operations.o)
      (anonymous namespace)::error(bool, boost::filesystem3::path const&,     boost::filesystem3::path const&, boost::system::error_code*, std::basic_string<char,     std::char_traits<char>, std::allocator<char> > const&)in libboost_filesystem.a(operations.o)
      boost::filesystem3::detail::dir_itr_close(void*&, void*&)in     libboost_filesystem.a(operations.o)
      boost::filesystem3::detail::directory_iterator_increment(boost::filesystem3::directory_itera    tor&, boost::system::error_code*)in libboost_filesystem.a(operations.o)
      boost::filesystem3::detail::directory_iterator_construct(boost::filesystem3::directory_itera    tor&, boost::filesystem3::path const&, boost::system::error_code*)in     libboost_filesystem.a(operations.o)
      ...
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status 
```

当我尝试使用它进行编译时，我得到了这个：

```
g++ -o test main.cpp -I -l/opt/local/include ~/boost/libs/libboost_filesystem.a 
```

所以我回到了 boost.org 教程并尝试了正则表达式示例。使用它完美地工作：

```
g++ -o test main.cpp -I -l/opt/local/include ~/boost/libs/libboost_regex.a 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T20:28:19.680

尝试

```
g++ -o test main.cpp -I/opt/local/include -L/opt/local/lib  -lboost_filesystem 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T20:35:36.663

您的编译器标志似乎有点不对劲。通常，以下情况成立：

```
-I // Sets the path for the relevant header files
-L // Sets the path where your libraries reside
-l // specifies the library you want to link against. 
```

所以，如果你在 ~/libs/ 中有一个名为 mylib 的库，并且需要使用位于 ~/include 中的头文件，你会通过

```
-I ~/include -L ~/libs -lmylib 
```

作为编译器的标志。

# c - 对给定值进行排序的最佳算法

> ID：10079298
> 
> 赞同：2
> 
> 时间：2012-04-09T20:20:19.507
> 
> 标签：c, algorithm, sorting

假设我有以下值： -

```
xyz12@abc
xyz1@abc
xyz15@abc
xyz2@abc
xyz22@abc 
```

我希望排序后的输出格式为：-

```
xyz1@abc
xyz2@abc
xyz12@abc
xyz15@abc
xyz22@abc 
```

如果我使用 strcmp，那么它将按每个字符进行比较，并将 xyz1@ > xyz12 作为我不想要的 @ > 2 给出。我可以使用哪些不同的算法以所需的格式对其进行排序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:30:54.483

您要查找的 Google 关键字是“自然排序”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:26:21.740

看看 sort 实用程序是如何实现的：

```
$ cat test.txt | sort
xyz12@abc
xyz15@abc
xyz1@abc
xyz22@abc
xyz2@abc 
```

现在使用 -V 开关...

```
$ cat test.txt | sort -V
xyz1@abc
xyz2@abc
xyz12@abc
xyz15@abc
xyz22@abc 
```

[http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/sort.c](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/sort.c)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T20:54:41.223

如果 XYZ 始终相同，则对整数值使用[计数排序。](http://en.algoritmy.net/article/40549/Counting-sort)否则，它可能是使用一些基于通用比较的排序和自定义比较器（即[合并排序](http://en.algoritmy.net/article/39650/Merge-sort)）的最简单方法。

通用我的意思是使用一些预编程的排序算法，它准备接受一些比较器函数（如果 A > B，通常返回 1，如果 A < B，则返回 -1，否则返回 0）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-09T20:36:04.593

我强烈建议你看看这个网站：

[http://www.c.happycodings.com/Sorting_Searching/index.html](http://www.c.happycodings.com/Sorting_Searching/index.html)

在 C 语言中有一个排序算法的分支。显然选择那些性能更好的算法（nlogn）。

# c - 在没有“extern”关键字的情况下在头文件中声明变量有什么缺点吗？

> ID：10079304
> 
> 赞同：1
> 
> 时间：2012-04-09T20:20:57.213
> 
> 标签：c, header-files, extern

我最近开始意识到强烈建议使用“extern”关键字。因此，我开始怀疑我使用头文件的当前（无外部）方式是否有任何问题：

主.c：

```
#include "main.h"
#include "function.h"

int main(void){
    globalvariable = 0;

    testfunction();
    return 0;
} 
```

主.h：

```
#ifndef MAIN_H_
#define MAIN_H_

int globalvariable;

#endif /* MAIN_H_ */ 
```

函数.c：

```
#include "main.h"
#include "function.h"

void testfunction(){
    globalvariable++;
    return;
} 
```

函数.h：

```
#ifndef FUNCTION_H_
#define FUNCTION_H_

void testfunction(void);

#endif /* FUNCTION_H_ */ 
```

因此，每个需要访问*globalvariable*的新源文件只需要包含 main.h。

这种方法的一个明显缺点是数组：一旦声明了数组，就不能使用 {element0, element1, ...} 格式为数组赋值。

顺便说一句，当我给*globalvariable*一个初始值为零时，我是在那个时候定义它吗？还是更早分配内存？

另外，我使用的方法有官方术语吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:24:17.810

您的代码的缺点是您可能会收到链接器错误。¹

* * *

[1\. “可能”是基于在一大堆不同的工具链上构建代码的概念。]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:25:59.477

这样做的问题是，当您尝试链接程序时，可能会由于多个定义而出现链接错误。您在这里取决于实现定义的行为 - 允许实现将重复定义视为全部引用单个对象，但不是必需的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T20:26:13.160

```
extern int globalvariable; 
```

是一个*声明*

```
int globalvariable; 
```

既是声明又是*暂定定义*。

在 C 中，同一个变量有多个定义是非法的，如果您在包含在多个翻译单元中的头文件中使用后者，就会发生这种情况。

然而，Unix 系统在历史上允许这种用法，因此大多数编译器都会接受该代码，尽管它是无效的 C。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-09T21:17:17.780

对于您使用的方法，我知道的唯一官方术语是“实现依赖行为”。一旦您开始使用不同的编译器（甚至可能是同一编译器的不同版本）进行构建，您将遇到该方法的各种问题。有些会抛出链接器错误，但有些会接受它（尽管不能保证它会如何解释）。我强烈建议您采用更标准的方法，编译器将以可预测的方式进行解释。

变量的*定义*需要在 .c 文件中。如果要从另一个 .c 文件访问该变量，请在标题中添加`extern` *声明。*这种技术是标准的 C 语言，可以在任何符合标准的编译器上进行可预测的解释。

为了回答您的分配问题，在程序开始运行之前分配了所有全局变量的内存。全局变量即使只用在从不运行的代码的子部分中也会占用空间。您的`globalvariable = 0;`行实际上并没有给变量一个*初始*值。C 编译器将确保所有未初始化的全局变量在程序加载时自动初始化为零。您的代码在技术上重新分配了变量的值。如果要确保将全局初始化为特定值，请将初始化程序添加到定义中，例如`int globalvariable = 42;`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-20T13:25:13.347

ANSI C 标准说

> 如果对象标识符的声明具有文件范围且没有存储类说明符，则其链接是外部的。

# jquery - jquery 倒计时 - 到期时自动提交表单？

> ID：10079306
> 
> 赞同：2
> 
> 时间：2012-04-09T20:20:58.093
> 
> 标签：jquery, forms

我正在使用 jquery_countdown (http://keith-wood.name/countdown.html) 设置一个 60 分钟的计时器。我知道我可以在时间到期时运行回调函数，但是有没有办法自动提交表单？

我尝试了以下方法，但提交失败（尽管 firebug 控制台中没有错误）：

```
<div class="countdown"></div>
<form id="formsamp" action="#">
<textarea name="bft"></textarea>
<input type="submit" name="op" value="Submit" />
</form>

jquery_countdown_add
(
    ".countdown", 
    array
    (
        "until" => 10, 
        "onExpiry" => "finished"
    )
);

function finished() { 
  $('#formsamp').submit(function(){return true;}); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:24:07.887

```
"onExpiry" => function(){ return finished() } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:24:49.520

最有可能的是，jQuery 将您的代码混淆为将函数绑定到`submit`事件。

相反，要在元素上触发该事件，请尝试使用更显式的`.trigger()`，如下所示：

```
function finished() { 
  $('#formsamp').trigger('submit');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T21:19:13.930

尝试以下操作：

```
$('#formsamp').submit(); 
```

或者

```
$('input[type=submit][name=op]').trigger('click'); 
```

# html - 如何在我的 HTML 输入标签文本框的右下角获取调整大小小部件？

> ID：10079316
> 
> 赞同：0
> 
> 时间：2012-04-09T20:21:25.967
> 
> 标签：html, input, tags

看到右下角的小点了吗？我怎样才能得到那些使用 html 输入标签？ [http://i.imgur.com/kpk7h.png](http://i.imgur.com/kpk7h.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:24:38.553

你要还是不要？您可以将 CSS 属性设置`resize`为这些值之一，但并非所有浏览器都支持。

*   没有任何
*   水平的
*   垂直的
*   两个都

# javascript - Javascript 对象字面量赋值

> ID：10079319
> 
> 赞同：0
> 
> 时间：2012-04-09T20:21:37.310
> 
> 标签：javascript, backbone.js

我正在使用backbone.js 来创建应用程序。我的代码JS代码如下，

```
window.RequestsView = Backbone.View.extend({

initialize:function ( input ) {

    console.log('input ' + JSON.stringify(input) );

    this.variables = {   request_id:input.model.id,
                         status:input.model.status,
                         mavenGav:input.model.mavenGav, 
                         email:input.model.emailId, 
                         errorNo:input.model.errorNo, 
                         errorDesc:input.model.errorDesc };

    console.log("variables : "+ JSON.stringify( this.variables ) );

    this.template = _.template(tpl.get('requests'));
    var out = this.template( input );

    console.log("out: "+ JSON.stringify( out ) );

    // deep copy the object
    this.request =  $.extend( true, {},  input);
} 
```

});

当我在 chrome 调试器中调试它时，我得到以下日志，

```
input {"model":{"mavenGav":"fgdfgfdgdfg:fgdfgfd:gdfgdfg","repositories":["dfgdfgdfgf"],"emailId":"gdfg","id":1083,"createdTime":null,"status":"CREATED","errorNo":0,"errorDesc":null}}
requests.js:12variables : {"request_id":1083} 
```

没有错误。分配给 this.variables 的 javascript 文字的其余部分会发生什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:28:09.940

`undefined`值不会被字符串化为 json，因为 json 只知道数字、字符串、布尔值、null 和对象/数组。所以属性存在，但它们在转换中“迷失”了。

尝试`console.debug("variables :",this.variables)`，这将让您检查变量对象。

# c# - 如何从 C# 中的先前方法调用中获取参数值？

> ID：10079325
> 
> 赞同：0
> 
> 时间：2012-04-09T20:22:28.357
> 
> 标签：c#, .net, reflection

这个问题与我之前的问题*[How to get a IDictionary<string, object> of the parameters previous method called in C#有关？](https://stackoverflow.com/questions/10078611)*. 我写了代码，但仍然缺少一块。如何从参数中获取值？

如果执行以下代码，则输出仅显示参数的名称，而不显示值。

```
using System;
using System.Collections.Generic;
using System.Diagnostics;

namespace Question {
    internal class Program {
        public static void Main(string[] args) {
            var impl = new Implementation();
            var otherClass = new OtherClass { Name = "John", Age = 100 };
            impl.MethodA(1, "two", otherClass);
        }
    }

    internal class Implementation {
        public void MethodA(int param1, string param2, OtherClass param3) {
            Logger.LogParameters();
        }
    }

    internal class OtherClass {
        public string Name { get; set; }
        public int Age { get; set; }
    }

    internal class Logger {
        public static void LogParameters() {
            var parameters = GetParametersFromPreviousMethodCall();
            foreach (var keyValuePair in parameters)
                Console.WriteLine(keyValuePair.Key + "=" + keyValuePair.Value);
        }

        private static IDictionary<string, object> GetParametersFromPreviousMethodCall() {
            var stackTrace = new StackTrace();
            var frame = stackTrace.GetFrame(2);
            var method = frame.GetMethod();

            var dictionary = new Dictionary<string, object>();
            foreach (var parameterInfo in method.GetParameters())
                dictionary.Add(parameterInfo.Name, parameterInfo.DefaultValue);
            return dictionary;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:50:59.040

您的代码可能是死胡同。堆栈帧中没有任何内容可以让您获取参数值。

但是，完全可以执行此任务。您想要的与编写分析器非常相似。您可能希望将代码注入任何您想要记录的方法中以向量化其参数。假设您从这样的课程开始：

```
public class ParameterBlob {
    public ParameterInfo Info { get; set; }
    public object Value { get; set; }
} 
```

假设你有一个这样的方法：

```
public static void LogMethodCall(MethodInfo method, param ParameterBlob[] parameterBlobs) { /* ... */ } 
```

这或多或少是您要注入的内容：

```
MethodInfo methodInfo = MyLogging.GetMyMethodInfo();
ParameterBlob[] blobs = new ParameterBlobs[MyLogging.GetMyParameterCount(methodInfo);
ParameterBlob blob = new ParameterBlob();
blob.Info = MyLogging.GetParameterInfo(methodInfo, 0);
blob.Value = param0; // More on this
blobs[0] = blob;
blob = new ParameterBlob();
blob.Info = MyLogging.GetParameterInfo(methodInfo, 1);
blob.Value = param1; // More on this
blobs[1] = blob;
// ...
blob = new ParameterBlob();
blob.Info = MyLogging.GetParameterInfo(methodInfo, n);
blob.Value = paramn; // more on this
blobs[n] = blob;
MyLogging.LogMethodCall(methodInfo, blobs); 
```

那么那些说“更多关于这个”的行？你实际上不能写它们。但是您可以编写一个示例例程来引用它自己的参数来执行此操作。您*将*拥有的是[ldarg](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.ldarg.aspx)指令和[stloc](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.stloc.aspx)指令（以及介于两者之间的其他一些指令）。关键是，用 C# 编写它，然后使用编译器和[ILDASM](http://en.wikipedia.org/wiki/Common_Intermediate_Language#Generation)向您显示一个参数所需的正确代码，然后您可以编写一个例程来为您生成该[CIL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)，然后将其插入 .NET分析 API 以附加到您想要的任何例程。

有关更多信息，请参阅文章*[Rewrite MSIL Code on the Fly with the .NET Framework Profiling API](http://msdn.microsoft.com/en-us/magazine/cc188743.aspx)*。

您可能还想使用属性将方法标记为可记录或不可记录。

唯一的问题是您必须具有运行时访问权限才能执行此操作，而您可能没有。你完全不走运吗？不。

通过使用[Cecil](http://www.mono-project.com/Cecil)，您可以在运行之前访问整个程序集并对其进行预处理以为您注入日志记录调用。Cecil 非常简单，重写任何程序集以包含日志调用应该需要几天的时间。如果您可以先验地知道您正在目标程序集中执行此操作并且已经设置了适当的引用，则更少。本质上，您将访问程序集中的每个方法，如果它是可记录的，您将注入 CIL 以记录其所有参数，就像上面的示例一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:38:54.140

根据先前的问题（[如何获取调用方法的参数值？](https://stackoverflow.com/questions/492600/how-can-i-get-the-values-of-the-parameters-of-a-calling-method)），通过 StackTrace 是不可能的。

AOP 是你的朋友。

# iphone - 在 iOS 上从用户设置时间获取 AM / PM

> ID：10079328
> 
> 赞同：4
> 
> 时间：2012-04-09T20:22:44.357
> 
> 标签：iphone, ios, xcode, cocoa-touch

我想知道是否有一种方法可以从用户在 iOS 上设置的时间获取上午/下午。

我目前正在使用这种方法来获取时间：

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"HH"];
hours.text = [formatter stringFromDate:[NSDate date]];

[formatter setDateFormat:@"m"];
minutes.text = [formatter stringFromDate:[NSDate date]];
if ([minutes.text intValue] < 10) {
    minutes.text = [NSString stringWithFormat:@"0%@",[formatter stringFromDate:[NSDate date]]];
}
[formatter release]; 
```

我知道我使用 HH 来获取小时数，对于 12 小时格式，我必须使用“hh”但这不能解决问题，我需要检索 AM/PM。

希望有人可以提供帮助！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-09T20:24:48.833

干得好。这是上午/下午格式的日期。

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"hh:mm:ss a"];
NSLog(@"Today's Date and Time: %@", [formatter stringFromDate:[NSDate date]]);
[formatter release]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-29T14:40:46.380

Swift 最简单的答案：

```
let dateFormatter = NSDateFormatter()
dateFormatter.dateFormat = "a"
let currentAMPMFormat = dateFormatter.stringFromDate(NSDate()).uppercaseString 
```

# sql-server-2008 - 将索引从 SQL Server 2008 迁移到 SQL Azure

> ID：10079330
> 
> 赞同：1
> 
> 时间：2012-04-09T20:22:48.167
> 
> 标签：sql-server-2008, azure-sql-database

我正在尝试将数据库从 SQL Server 2008 迁移到 SQL Azure。我相信我已经成功地将我所有的表和存储过程迁移到了 SQL Azure。但是，当我尝试将记录插入到我的一个表中时，我收到一条错误消息：

System.Data.SqlClient.SqlException (0x80131904)：此版本的 SQL Server 不支持没有聚集索引的表。请创建聚集索引并重试。

如何将表索引从 SQL Server 2008 迁移到 SQL Azure。请假设我是愚蠢的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:09:35.687

更新 - 此答案仅适用于 SQL Azure（SQL 数据库）的 Web 和商业版本 - 请参阅下面的评论：

与 SQL Server 2008 不同，SQL Azure需要在每个表上创建[一个聚集索引。](http://msdn.microsoft.com/en-us/library/windowsazure/ee336245.aspx#cir)如果您将 SQL Server 2008 架构迁移到包含没有聚集索引的表的 SQL Azure，您将收到问题中提到的错误。将聚集索引添加到有问题的表中，插入就可以正常工作。

# c++ - 定义与标识符相同的宏有什么用

> ID：10079333
> 
> 赞同：2
> 
> 时间：2012-04-09T20:23:01.567
> 
> 标签：c++, c, macros

在查看 poco 库时，我看到了一些具有相同标识符以及替换文本的宏：

例如在文件 XML/inlucde/XML/expat.h

```
 47   XML_STATUS_ERROR = 0,
  48 #define XML_STATUS_ERROR XML_STATUS_ERROR
  49   XML_STATUS_OK = 1,
  50 #define XML_STATUS_OK XML_STATUS_OK
  51   XML_STATUS_SUSPENDED = 2
  52 #define XML_STATUS_SUSPENDED XML_STATUS_SUSPENDED 
```

我想知道像这样定义宏有什么用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T20:24:49.493

我可以在这里想到两个用例：

*   `#define`如果标识符以前在其他地方是 d，则使一切正常。您不想使用它定义的值，对吧？因此，在这里，您确保使用该标识符的代码是有效的。
*   允许`#ifdef`识别标识符（即检查它们是否已经定义）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:26:38.120

这似乎很荒谬，不是吗？我唯一的想法是它允许您`#ifdef`在符号上使用，但我看不出这在这个特定示例中有用。

# c# - 为什么 WPF ComboBox 不能正确反映绑定值？

> ID：10079334
> 
> 赞同：6
> 
> 时间：2012-04-09T20:23:06.013
> 
> 标签：c#, wpf, xaml, data-binding

我有一个 ComboBox，其属性 ItemsSource 和 SelectedValue 绑定到模型。有时，模型需要将所选项目调整为不同的项目，但是当我在模型中执行此操作时，模型值不会反映在视图中，即使正确设置了 SelectedValue（使用 snoop 和在 SelectionChanged 中检查事件处理程序）。

为了说明这个问题，这里是一个简单的 xaml：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525" DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <Grid>
      <ComboBox Height="25" Width="120" SelectedValue="{Binding SelectedValue}" SelectedValuePath="Key" ItemsSource="{Binding PossibleValues}" DisplayMemberPath="Value"/>
   </Grid>
</Window> 
```

这是模型：

```
using System.Collections.Generic;
using System.Windows;
using System.ComponentModel;

namespace WpfApplication1
{
   public partial class MainWindow : Window, INotifyPropertyChanged
   {
      int m_selectedValue = 2;
      Dictionary<int, string> m_possibleValues = new Dictionary<int, string>() { { 1, "one" }, { 2, "two" }, { 3, "three" }, {4,"four"} };

      public int SelectedValue
      {
         get { return m_selectedValue; }
         set 
         {
            if (value == 3)
            {
               m_selectedValue = 1;
            }
            else
            {
               m_selectedValue = value;
            }
            PropertyChanged(this, new PropertyChangedEventArgs("SelectedValue"));
         }
      }
      public Dictionary<int, string> PossibleValues
      {
         get { return m_possibleValues; }
         set { m_possibleValues = value; }
      }

      public MainWindow()
      {
         InitializeComponent();
      }

      public event PropertyChangedEventHandler PropertyChanged;
   }
} 
```

我预计行为如下：

1.  最初，选择两个
2.  选择“一”-> ComboBox 显示“一”
3.  选择“二”-> ComboBox 显示“二”
4.  选择“三” -> ComboBox 显示“**一**”
5.  选择“四”-> ComboBox 显示“四”

然而，在#4 中，显示“三”。为什么？模型中的值更改为 1（“一”），但视图仍显示 3（“三”）。

我通过在 SelectionChanged 事件处理程序中显式更新绑定目标找到了一种解决方法，但这似乎是错误的。还有另一种方法可以实现这一目标吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T21:58:13.177

当您选择一个项目时，绑定引擎将更新模型，并忽略`PropertyChanged`它在调用属性设置器期间刚刚更改的任何属性。如果没有，事情可能会陷入无限循环。

系统假定 setter 不会更改它传递的值。这里的解决方法很简单：使用`Dispatcher.BeginInvoke()`或设置`IsAsync=True`您的绑定以获得您正在寻找的行为。但是，我个人**强烈建议**您不要这样做。不仅因为它引入了一大堆与时间相关的新问题，而且主要是因为它是一种解决原本不应该存在的问题的方法。

根本不要这样做。它不仅适用于 WPF：任何更改 setter 的东西都可以期望它刚刚设置的值被正确设置，不会引发异常。更改设置器中的值是反直觉的，以后可能会咬你。另外，对于您的应用程序的用户来说，看到组合框忽略其选择可能会非常令人不安。

如果您不喜欢传递的值，请抛出异常并用于`Binding.ValidatesOnExceptions`告诉 WPF 它是预期的。如果您不希望用户选择此值，请不要将其放在列表中。如果由于其他业务规则，该项目不应该有条件地可用，请动态过滤列表或应用触发器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T21:30:50.410

`SelectedValue`在绑定到控件的和/或`SelectedItem`属性时，我一直存在正确更新`ComboBox`控件的问题。

为了解决这个问题，我不得不绑定到`SelectedIndex`属性。在我的 ViewModel 中处理“索引”属性更麻烦，但它解决了`ComboBox`不更新的问题。

# wpf - 为什么 WPF 显示部分损坏的文本？以及如何解决？

> ID：10079336
> 
> 赞同：0
> 
> 时间：2012-04-09T20:23:08.227
> 
> 标签：wpf, fonts, rendering, corruption

我正在使用 .NET 4.0 的 WPF 显示一个简单的文本，该文本在前 100 个像素左右出现损坏。字体系列：Tahoma；尺寸：12。

示例（使用 VS 缩放进行缩放）：

![WPF 损坏的文本](../Images/a5ba5b78efe87fcfe3525efcbb6ba1bf.png)

为什么会这样？我该如何解决？

# c++ - 为什么我没有收到我的字节数组中的数据？

> ID：10079338
> 
> 赞同：0
> 
> 时间：2012-04-09T20:23:12.373
> 
> 标签：c++, pointers, arduino

我是 C++ 的初学者，正在尝试为我的 Arduino 创建一个程序。下面的代码编译得很好，但结果与我预期的不同。

我希望在我的 PC 上收到的是：0x04、0x61、0x62、0x63。

我在 PC 上收到的是：0xff 0x00 0xb1 0x00。

我试图以一种只解决我遇到的问题的方式最小化代码。

```
byte *assembleFrame() {
  byte frame[] = { 4 , 'a' , 'b' , 'c' , 'd' };
  return frame;
}

void setup() {
  Serial.begin( 115200 );
};

void loop() {
  byte *frame = assembleFrame();
  Serial.write( frame , 4 );
  // should send 0x04 0x61 0x62 0x63, leaving out 0x64 being 5th element.
  while ( 1 ) {
  }
} 
```

我认为它与指针有关，但无法弄清楚。

供参考：

```
Serial.write( buf , len ) arguments:    
  buf: an array to send as a series of bytes
  len: the length of the buffer 
```

**编辑：** 到目前为止的解决方案：

```
int assembleFrame( byte *frame ) {
  int octetCounter = 0;
  frame[ octetCounter++ ] = 'A'; // preamble
  frame[ octetCounter++ ] = 'B'; // preamble
  frame[ octetCounter++ ] = 0;   // frame length set at end of function
  frame[ octetCounter++ ] = h;
  frame[ octetCounter++ ] = m;
  frame[ octetCounter++ ] = s;
  frame[ 2 ] = octetCounter;  // frame length

  return frame[ 2 ];
}

void loop() {
  int bytes_in_frame = assembleFrame( frame );
  Serial.write( frame, bytes_in_frame ); // assuming ptr + bytes to send
  delay( 1000 );
} 
```

它给出了预期的结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:42:52.060

+ Krister 的回答很好，如果可能的话，我会建议您将缓冲区传递到您的汇编函数中来改进它。

```
/* Takes in an array of bytes with at least the given size, returns
 * the number of bytes written into the frame.
 */
int assembleFrame(byte *frame, int frame_size) {
  frame[0] =  4;
  frame[1] = 'a';
  frame[2] = 'b';
  frame[3] = 'c';
  frame[4] = 'd';
  return 5; // only used five bytes in the frame
}

  /* then in loop() */
  byte frame[10];
  bytes_in_frame = assembleFrame(frame, 10);
  someDataSendingFunction(frame, bytes_in_frame); // assuming ptr + bytes to send 
```

这样您就不会在以后产生内存泄漏的可能性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:32:17.287

您的 assembleFrame() 函数返回一个局部变量，该变量将在函数返回时超出范围。你可以这样做：

```
 byte* assembleFrame() {
      byte* frame = new byte[5];
      frame[0] = 4;
      frame[1] = 'a';
      frame[2] = 'b';
      frame[3] = 'c';
      frame[4] = 'd';
      return frame;
 } 
```

*请注意*，应使用 assembleFrame() 返回的内存：

```
void loop() {
   byte* frame = assembleFrame();
   Serial.write( frame , frame[ 0 ] );
   // release the memory allocated by assembleFrame()
   delete [] frame;
   while ( 1 ) {
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T20:53:03.303

首先，正如所说，你现在有悬空指针和欠精细的行为。如果您启用警告（`-Wall`），您将获得

> 警告：返回局部变量“frame”的地址

就目前而言，由于 Arduino 正在嵌入，并且由于资源限制，使用动态动态内存管理与嵌入（[您甚至不能默认调用 new ，呵呵）不愉快，您可能需要使用以下灵魂：](https://stackoverflow.com/questions/9805829/arduino-c-destructor/980607)

1.  制作`frame`静态：

    ```
    char *assembleFrame() {
        static char frame[] = { 'a' , 'b' , 'c' , 'd', 0 };
        return frame;
    } 
    ```

    当然，如果您在`assembleFrame`调用后更改代码中的数组，这种更改将持续存在。

2.  制作`frame` `const`指针并返回字符串

    ```
    const char *assembleFrame() {
        const char* frame = "abcd\0";
        return frame;
    } 
    ```

# jquery - jquery同时提交input和textareas

> ID：10079340
> 
> 赞同：1
> 
> 时间：2012-04-09T20:23:17.853
> 
> 标签：jquery

下面的代码保存了所有的输入字段。如果我将单词“INPUT”更改为“TEXTAREA”，它将保存 textarea 文本框，有没有办法更改代码以同时保存所有输入字段和 textarea 字段，而不是运行代码两次？

```
// JQUERY: Run .autoSubmit() on all INPUT fields within form
$(function(){
$('#ajax-form INPUT').autoSubmit(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:24:21.580

```
$('#ajax-form input, #ajax-form textarea').autoSubmit(); 
```

或者更好的是，使用匹配,和的[`:input`选择器](http://api.jquery.com/input-selector/)：`input``textarea``select`

```
$('#ajax-form :input').autoSubmit(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:24:51.860

jQuery 允许多个选择器，使用逗号。

```
$('#ajax-form INPUT, #ajax-form textarea').autoSubmit(); 
```

或者，如果你觉得很辣，你可以给选择器一些上下文：

```
$('input, textarea', '#ajax-form').autoSubmit(); 
```

那将寻找`input`并且`textarea`只在其中`#ajax-form`

# android - 用于组行的 Android ExpandableListView onClickListener

> ID：10079344
> 
> 赞同：0
> 
> 时间：2012-04-09T20:23:28.450
> 
> 标签：android

Tab1 是可扩展列表视图，而 Tab2 是视图。默认选择的选项卡是 Tab1。当我单击组行时，会弹出一个 web 视图。

当我选择 Tab2 并再次选择 Tab1 时，组行 Web 视图不会在第一次单击时打开。它在第二次点击时打开。那么发生了什么？我很困惑...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:15:16.697

第一次触摸视图获得焦点。二是点击。您可以通过将视图设置为不可聚焦来解决此问题。然后第一次触摸将注册为点击。

# ios - 从用户输入的网址中检测自定义 url 方案

> ID：10079354
> 
> 赞同：0
> 
> 时间：2012-04-09T20:24:33.553
> 
> 标签：ios, uiwebview, nsstring, nsurl, nsstringencoding

我正在尝试使用 UIWebView 构建简单的 Web 浏览器的教程。如果用户只是在没有任何方案的情况下键入地址，则其中有将方案“http://”前缀到 url 的功能。例如：用户输入 google.com 而不是[http://google.com](http://google.com) 这是使用 NSURL 的 scheme 属性实现的。一切都很好，直到地址很简单。

如果地址是这样的：“test1.samplewebsite.com:81” NSURL 方案将字符串“test1.samplewebsite.com”检测为方案而不是无方案。

这在 safari 上运行良好，它没有检测到任何方案并立即为 http 添加前缀。

在开始编写代码检测方案之前，我想检查一下，是否有任何系统 API 用于检测有效方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:54:35.703

不幸的是，在您的示例中，`test1.samplewebsite.com`将是根据规范（或[维基百科所说](http://en.wikipedia.org/wiki/URI_scheme)的任何内容，因为我不是规范读者）的方案。

但是您可以使用`-[UIApplication canOpenURL:(NSURL *)]`来确定设备是否可以打开给定的方案，自定义或其他方式。这是[UIApplication 文档的链接](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIApplication_Class/Reference/Reference.html)（我希望我可以直接链接到该方法）。

# django - django 管理站点模型未显示

> ID：10079358
> 
> 赞同：4
> 
> 时间：2012-04-09T20:24:48.743
> 
> 标签：django, django-admin

我有一个带有 django 的站点，显示基本视图和管理站点，

但是当我登录管理站点时，我看不到模型： ![在此处输入图像描述](../Images/de8a35dc8b717db2208304d7301a7f9a.png)

这是我的models.py

```
from django.db import models

# Create your models here.
class Poll(models.Model):
    question = models.CharField(max_length=200)
    pub_date = models.DateTimeField('date published') 
    class Admin:
        pass

class Choice(models.Model):
    poll = models.ForeignKey(Poll)
    choice = models.CharField(max_length=200)
    votes = models.IntegerField()
    class Admin:
        pass 
```

所以我从我的数据库方案中引用了管理员，

但在我的管理员中看不到这个表，

缺什么？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-09T20:28:04.307

您需要创建一个名为`admin.py`并[注册](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#modeladmin-objects)您希望从 Django 管理员访问的任何模型的文件：

```
from django.contrib import admin
from myproject.myapp.models import MyModel

class MyModelAdmin(admin.ModelAdmin):
    pass
admin.site.register(MyModel, MyModelAdmin) 
```

# javascript - 如果不使用像 three.js 这样的库，我将如何在 webgl 中进行环境反射？

> ID：10079368
> 
> 赞同：8
> 
> 时间：2012-04-09T20:25:28.143
> 
> 标签：javascript, webgl, texture-mapping

我试图弄清楚如何将环境映射到对象上。这是设置：

![茶壶](../Images/baafd772510f9389c3c1e856a64c810f.png)

如何让茶壶的表面反射周围的环境？所以我的意思是，茶壶不是那种灰色的阴影，它的表面应该反映它的环境，所以它应该把棋盘映射到它的表面上。

这是我试图完成的一个例子，但它使用[Three.js](https://github.com/mrdoob/three.js/)，我想自己做这个（这是一个类）。

[http://aerotwist.com/tutorials/create-your-own-environment-maps/demo/](http://aerotwist.com/tutorials/create-your-own-environment-maps/demo/)

这有意义吗？我将如何开始？

* * *

## **跟进**

我在完成作业后回答了这个问题：[https](https://stackoverflow.com/a/10093646/196921) ://stackoverflow.com/a/10093646/196921 。请参阅链接和代码的答案:)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-10T17:36:46.410

我在这里找到了这个茶壶的一个很好的例子......

[https://cvs.khronos.org/svn/repos/registry/trunk/public/webgl/sdk/demos/google/shiny-teapot/index.html](https://cvs.khronos.org/svn/repos/registry/trunk/public/webgl/sdk/demos/google/shiny-teapot/index.html)

通过查看源代码，我找到了我正在寻找的内容：

```
function loadCubeMap(base, suffix) {
    var texture = gl.createTexture();
    gl.bindTexture(gl.TEXTURE_CUBE_MAP, texture);
    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);
    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MAG_FILTER, gl.LINEAR);

    var faces = [["posx.png", gl.TEXTURE_CUBE_MAP_POSITIVE_X],
                 ["negx.png", gl.TEXTURE_CUBE_MAP_NEGATIVE_X],
                 ["posy.png", gl.TEXTURE_CUBE_MAP_POSITIVE_Y],
                 ["negy.png", gl.TEXTURE_CUBE_MAP_NEGATIVE_Y],
                 ["posz.png", gl.TEXTURE_CUBE_MAP_POSITIVE_Z],
                 ["negz.png", gl.TEXTURE_CUBE_MAP_NEGATIVE_Z]];
    for (var i = 0; i < faces.length; i++) {
        var face = faces[i][1];
        var image = new Image();
        image.onload = function(texture, face, image) {
            return function() {
                gl.bindTexture(gl.TEXTURE_CUBE_MAP, texture);
                gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);
                gl.texImage2D(face, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);
            }
        } (texture, face, image);
        image.src = faces[i][0];
    }
    return texture;
} 
```

...和示例片段着色器（它比我需要的环境反射映射更多）...

```
precision mediump float;
const float bumpHeight = 0.2;

uniform sampler2D normalSampler;
uniform samplerCube envSampler;

varying vec2 texCoord;
varying vec3 worldEyeVec;
varying vec3 worldNormal;
varying vec3 worldTangent;
varying vec3 worldBinorm;

void main() {
    vec2 bump = (texture2D(normalSampler texCoord.xy).xy * 2.0 - 1.0) * bumpHeight;
    vec3 normal = normalize(worldNormal);
    vec3 tangent = normalize(worldTangent);
    vec3 binormal = normalize(worldBinorm);
    vec3 nb = normal + bump.x * tangent + bump.y * binormal;
    nb = normalize(nb);
    vec3 worldEye = normalize(worldEyeVec);
    vec3 lookup = reflect(worldEye nb);
    vec4 color = textureCube(envSampler, lookup);  // <--- this was the aha! line
    gl_FragColor = color;
} 
```

结果出来有点酷……

![带环境映射的茶壶](../Images/f10b44ececa7992bbf135c0265488e78.png)

[请随时在http://hristo.oskov.com/projects/cs418/mp3/](http://hristo.oskov.com/projects/cs418/mp3/)上查看。源代码都在那里......代码很烂所以请不要评判我:) 这是主要的 JS 文件：[http ://hristo.oskov.com/projects/cs418/mp3/js/mp3 .js](http://hristo.oskov.com/projects/cs418/mp3/js/mp3.js)。着色器位于 index.html 页面中，因此只需查看源代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:53:50.167

渲染反射对象的基本方法是：

1.  将相机放置在对象的中心，将场景渲染到六个纹理上，这些纹理代表该对象周围立方体的六个面的视图。
2.  编写一个片段着色器，通过表面法线反射视线并追踪到与立方体相交的位置，以找到反射中看到的颜色。

（我自己从来没有真正做过，但我看过这样的教程[）](http://www.reindelsoftware.com/Documents/Mapping/Mapping.html)。

# php - PHP数组每个元素到每个

> ID：10079373
> 
> 赞同：0
> 
> 时间：2012-04-09T20:25:41.923
> 
> 标签：php, arrays

我有`n`数组（例如 2 个数组）：

```
$tab['1'] = array('1', '2', '3');
$tab['2'] = array('A', 'B', 'C'); 
```

我怎样才能得到这个结果？

```
1 A
1 B
1 C
2 A
2 B
2 C
3 A
3 B
3 C 
```

也就是说，来自第一个数组的每个元素与来自其他数组的每个元素。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T20:28:17.757

您将进行二维迭代。

像这样运行第一个数组

```
foreach ($tab[1] as $number) {...} 
```

对于第一个数组中的每个数字，将执行括号中的代码。如果要计算每个数字的每个字母，只需在内部重复相同的迭代：

```
foreach ($tab[1] as $number) {
    foreach ($tab[2] as $letter) {
        print($number.' '.$letter."\n");
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T20:28:28.167

```
foreach ($tab[1] as $num) {
   foreach ($tab[2] as $letter) {
      echo "$num $letter\n";
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T21:01:37.960

另一种方法（为了好玩）

```
array_map(function($a, $b) {
             foreach( $b as $e ) {
                 echo "$a $e\n";
             }
          }, 
          $tab['1'], 
          array_fill(0, count($tab['1']), $tab['2'])); 
```

# .net - How to remove warning message in .net

> ID：10079374
> 
> 赞同：-3
> 
> 时间：2012-04-09T20:25:44.157
> 
> 标签：.net, c#-4.0

how to remove warning in.Net 2010

"Consider changing the 'Embed Interop Typess' property on either assembly."

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:39:26.417

**通常**您不需要禁用构建警告。最佳做法是发出高级别警告。如果碰巧您的项目有一些细节，您可以导航到`build properties`您的`csproj`并添加部分（您正在寻找的警告代码是 1762）`warning code`。`Suppress warnings:`

**要修复您的警告，您应该**：转到引用中的 Dll，右键单击并转到属性并在那里更改“嵌入互操作类型”属性。

**要完全禁用**项目中的警告，请将警告级别设置为 0。不推荐！

# objective-c - Parse (objective-c) 框架对通道有限制吗？

> ID：10079376
> 
> 赞同：3
> 
> 时间：2012-04-09T20:25:51.147
> 
> 标签：objective-c, frameworks, push-notification, parse-platform

[Parse](http://parse.com)对我可以拥有的频道数量有限制吗？我正在尝试向单个用户发送推送通知，而我能弄清楚如何做到这一点的唯一方法是为每个用户设置一个频道。其他问题：有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T21:33:25.390

我给 Parse 发了电子邮件，这是我得到的回复：

> 不，频道没有限制。我们将很快提供一种更好的方式来推送给特定用户。当它准备好时，我会让你得到通知。

编辑：

Parse 最近一封关于“更好的方法”的电子邮件：

> 我想让您知道，您现在可以在 iOS 上直接向用户推送，前提是您通过 REST API 发送通知。这篇博文有更多信息：[http](http://blog.parse.com/2012/07/06/pushing-to-queries-in-ios/) ://blog.parse.com/2012/07/06/pushing-to-queries-in-ios/ 。您还可以通过设备令牌、地理区域或根据您在每个设备上存储的任何其他数据来定位推送通知。

# c++ - Why do my C# and C++ dlls exhibit different behavior?

> ID：10079377
> 
> 赞同：0
> 
> 时间：2012-04-09T20:25:58.400
> 
> 标签：c++, visual-c++, dll, com, atl

I am working on a project that involves the creation of a dll that honours a certain interface in order to plug into some software in order to add functionality to it. This is done by a dll that calls my dll (I do not have the source code for the dll that does the calling). Originally I was given an interface and a C# implementation that created a COM visible dll. However after using this for a while I found I wanted to make use of some large C++ libraries and as creating wrappers would take a long time I thought about creating a C++ ATL COM dll instead. I did this and the methods of my class appear to be called correctly (I register my dll, run the program and the methods appear to be called in the correct order), however I have found some of the behavior to be different.

I am not sure how to go about explaining this as my code relates to a closed source API but perhaps if I describe an example someone might have some ideas as to where I might want look.

For instance, in the C# dll I attempt to open a file by doing this:

```
FMANFileControl fileControl = new FMANFileControl();
FMANFile wFile = null;
const string filePath = @"C:\Data\April 4\Data_IDA.wiff";
wFile = fileControl.GetFileObject(filePath, 1);
long numSamples = wFile.GetNumberOfSamples(); 
```

I get the correct number of samples.

In my C++ dll I have this (with some of the HRESULT checks removed in order to keep the code shorter):

```
std::string filePath = "C:\\Data\\April 4\\Data_IDA.wiff";
_bstr_t fileName(filePath.c_str());
IFMANFilePtr ipFMANFile;
IFMANFileControlPtr ipFMANFileControl;
hr = ipFMANFileControl.CreateInstance(__uuidof(FMANFileControl));
hr = ipFMANFile.CreateInstance(__uuidof(FMANFile));
ipFMANFile = ipFMANFileControl->GetFileObject(fileName, 1);
long numSamples = ipFMANFile->GetNumberOfSamples(); 
```

but the files does not open correctly, resulting is zero samples.

Using oleview I looked at the typelib and it says this for the function:

```
[id(0x00000001), helpstring("method GetWiffFileObject")] 
IFMANWiffFile* GetWiffFileObject( [in] BSTR WiffFileName, [in] long sample); 
```

The file I get information from is one that is being written to during an experiment and just before it obtains more data it calls my method and I should be able to obtain the newest file. In the C# dll this is possible, but in the C++ dll this is not. While I realize the specifics of this is hidden, I am wondering is anyone has any idea why a C++ COM dll and a C#, comvisible dll that make use of the same interface would exhibit different behavour when being called by the same dll.

I am pretty stumped at this moment so any ideas at all would be appreciated, even if they turn out to be way off base. I can share my source code if anyone thinks they might be able to help.

EDIT: I tried the solution to answer 1, however I could not compile my code. When reading about this I found this post: [Differences between [in, out] and [out, retval] in COM IDL definitions](https://stackoverflow.com/questions/1575818/differences-between-in-out-and-out-retval-in-com-idl-definitions) that seems to suggest that since the FMANFile pointer is marked [out, retval] that the method becomes:

```
IFMANFilePtr ExploreData::IFMANFileControl(BSTR filename, long sample); 
```

or am I misinterpreting that article?

EDIT 2: Got it working though I am not really sure why. Originally I had the variables declared in the header as private member variables of the class, like this:

```
class ATL_NO_VTABLE CUserIDA :
public CComObjectRootEx<CComSingleThreadModel>,
public CComCoClass<CUserIDA, &CLSID_UserIDAObject>,
public IUserIDA
{
.
.
.
public:
STDMETHOD(GetSwitchCriteria)(DOUBLE* intensity, DOUBLE* minMass, DOUBLE* maxMass, VARIANT_BOOL *selectIntensity, LONG* numOfDepCycles);
    .
    .
    .
private:
    ExploreDataObjects::IFMANWiffFilePtr ipFMANWiffFile;
ExploreDataObjects::IFMANWiffFile2Ptr ipFMANWiffFile2;
}; 
```

Just to try it I moved them to the top of the class delcaration like this:

```
class ATL_NO_VTABLE CUserIDA :
public CComObjectRootEx<CComSingleThreadModel>,
public CComCoClass<CUserIDA, &CLSID_UserIDAObject>,
public IUserIDA
{

ExploreDataObjects::IFMANWiffFilePtr ipFMANWiffFile;
ExploreDataObjects::IFMANWiffFile2Ptr ipFMANWiffFile2; 
```

I thought that by default these would also be private members and the same as before so I am at a loss to explain why this seemed to work. Can someone explain this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T07:04:59.617

您的 C++ 代码是正确的，但以下行除外：

```
hr = ipFMANFile.CreateInstance(__uuidof(FMANFile)); 
```

它没有任何意义，因为 ipFMANFile 在下一条语句中再次初始化。

不幸的是，这个 IDL 声明：

```
IFMANWiffFile* GetWiffFileObject([in] BSTR WiffFileName, [in] long sample); 
```

仅限于调试目的，因为它不支持通过 HRESULT 报告异常的本机 COM 机制。符合 COM 的声明将是：

```
HRESULT GetWiffFileObject([in] BSTR WiffFileName, [in] long sample, [out, retval] IFMANWiffFile** fileInstance); 
```

我相信您无法更改库的代码，因此我建议您在运行 CPP 测试用例时尝试一些外部调试工具，如“procmon.exe”和“dbgview.exe”来检查应用程序事件。查找所有失败的操作。

我希望这会以某种方式帮助你

# c++ - 关于非聚合结构的初始化

> ID：10079382
> 
> 赞同：2
> 
> 时间：2012-04-09T20:26:12.360
> 
> 标签：c++, c++11

考虑以下代码：

```
template<size_t head,size_t ... Dims> struct make_vec {
      typedef typename make_vec<Dims...>::type type[head];
};

template<size_t head> struct make_vec<head> {typedef float type[head];};

template<size_t ... Dims>
struct vec {
    typename make_vec<Dims...>::type _data;
}; 
```

由于该类`vec`是一个聚合类，因此我可以使用大括号封闭初始化器列表来初始化`vec`.

```
vec<3,3> foo = {{
    {1,2,3},
    {4,5,6},
    {7,8,9}
}}; 
```

如果我向我的 vec 类添加一个构造函数（例如，允许使用表达式模板，这是我的最终目标），则不再允许此语法，因为`vec`不再是聚合。

在这种情况下，逻辑上要做的事情是使用`std::initializer_list`; 但是，当我编译使用此构造的代码时，即使启用了优化，我也会得到一个很长的汇编代码（我曾经`std::uninitialized_copy`从 initializer_list 复制到我的 vec 类数据成员）。

我没有运气使用可变参数模板来获得相同的结果。初始化用户定义的固定大小多数组类型的最佳方式是什么（即良好的运行时性能和清晰的语法）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:48:16.840

您可以编写一个构造函数

```
typename make_vec<Dims...>::type const& 
```

这将允许用户代码使用与聚合相同的初始化样式。如果您使用的是 GCC，则可能需要最新版本，例如 GCC 4.7。

但是，我不知道生成的代码。

# ant - Error while building an xtext project with ant: Generation of the Grammar classes fails

> ID：10079384
> 
> 赞同：4
> 
> 时间：2012-04-09T20:26:14.550
> 
> 标签：ant, grammar, xtext, temp

I am developing an xtext plug-in project for an eclipse application for my Bachelor thesis.

I want to do the 'Generate Xtext Artifacts' at runtime with an ant script executing the Mwe2Launcher class and do the generation in an temp folder.

I wrote an Activator to create in the temp folder a project folder and copy the mwe2 file, my grammar file and the ant script.

Executing the Ant script leads to this error:

```
osgi> start 360
gen:
 [java] 0    INFO  StandaloneSetup    - Registering platform uri 'C:\Foo-test'
 [java] 2461 INFO  DirectoryCleaner   - Cleaning C:\Foo-test\org.xtext.example.foobar\..\org.xtext.example.foobar\src-gen
 [java] 2503 INFO  DirectoryCleaner   - Cleaning C:\Foo-test\org.xtext.example.foobar\..\org.xtext.example.foobar.ui\src-gen
 [java] 3056 INFO  LanguageConfig     - generating infrastructure for org.xtext.example.foobar.Foo with fragments : ImplicitRuntimeFragment, ImplicitUiFragment, GrammarAccessFragment, EcoreGeneratorFragment, ParseTreeConstructorFragment, ResourceFactoryFragment, XtextAntlrGeneratorFragment, JavaValidatorFragment, ImportNamespacesScopingFragment, QualifiedNamesFragment, BuilderIntegrationFragment, GeneratorFragment, FormatterFragment, LabelProviderFragment, OutlineTreeProviderFragment, QuickOutlineFragment, QuickfixProviderFragment, JavaBasedContentAssistFragment, XtextAntlrUiGeneratorFragment, TypesGeneratorFragment, XbaseGeneratorFragment, CodetemplatesGeneratorFragment
 [java] 6253 INFO  GenModelHelper     - Registered GenModel 'http://www.xtext.org/example/foobar/Foo' from 'file:/C:/Foo-test/org.xtext.example.foobar/src-gen/org/xtext/example/foobar/Foo.genmodel'
 [java] org.eclipse.emf.common.util.WrappedException: java.io.IOException: The path '/org.xtext.example.foobar/src-gen/org/xtext/example/foobar/foo/FooPackage.java' is unmapped
 [java]     at org.eclipse.emf.codegen.ecore.generator.AbstractGeneratorAdapter.generateJava(AbstractGeneratorAdapter.java:1112)
 [java]     at org.eclipse.emf.codegen.ecore.genmodel.generator.GenPackageGeneratorAdapter.generatePackageInterface(GenPackageGeneratorAdapter.java:467)
 [java]     at org.eclipse.emf.codegen.ecore.genmodel.generator.GenPackageGeneratorAdapter.generateModel(GenPackageGeneratorAdapter.java:219)
 [java]     at org.eclipse.emf.codegen.ecore.genmodel.generator.GenBaseGeneratorAdapter.doGenerate(GenBaseGeneratorAdapter.java:221)
 [java]     at org.eclipse.emf.codegen.ecore.generator.AbstractGeneratorAdapter.generate(AbstractGeneratorAdapter.java:290)
 [java]     at org.eclipse.emf.codegen.ecore.generator.Generator.generate(Generator.java:617)
 [java]     at org.eclipse.emf.codegen.ecore.generator.Generator.generate(Generator.java:528)
 [java]     at org.eclipse.xtext.generator.ecore.EcoreGeneratorFragment.doGenerate(EcoreGeneratorFragment.java:144)
 [java]     at org.eclipse.xtext.generator.ecore.EcoreGeneratorFragment.generate(EcoreGeneratorFragment.java:211)
 [java]     at org.eclipse.xtext.generator.CompositeGeneratorFragment.generate(CompositeGeneratorFragment.java:81)
 [java]     at org.eclipse.xtext.generator.LanguageConfig.generate(LanguageConfig.java:108)
 [java]     at org.eclipse.xtext.generator.Generator.generate(Generator.java:352)
 [java]     at org.eclipse.xtext.generator.Generator.invokeInternal(Generator.java:126)
 [java]     at org.eclipse.emf.mwe.core.lib.AbstractWorkflowComponent.invoke(AbstractWorkflowComponent.java:126)
 [java]     at org.eclipse.emf.mwe.core.lib.Mwe2Bridge.invoke(Mwe2Bridge.java:34)
 [java]     at org.eclipse.emf.mwe.core.lib.AbstractWorkflowComponent.invoke(AbstractWorkflowComponent.java:201)
 [java]     at org.eclipse.emf.mwe2.runtime.workflow.AbstractCompositeWorkflowComponent.invoke(AbstractCompositeWorkflowComponent.java:35)
 [java]     at org.eclipse.emf.mwe2.runtime.workflow.Workflow.run(Workflow.java:19)
 [java]     at org.eclipse.emf.mwe2.launch.runtime.Mwe2Runner.run(Mwe2Runner.java:97)
 [java]     at org.eclipse.emf.mwe2.launch.runtime.Mwe2Runner.run(Mwe2Runner.java:73)
 [java]     at org.eclipse.emf.mwe2.launch.runtime.Mwe2Launcher.run(Mwe2Launcher.java:76)
 [java]     at org.eclipse.emf.mwe2.launch.runtime.Mwe2Launcher.main(Mwe2Launcher.java:35)
 [java] Caused by: java.io.IOException: The path '/org.xtext.example.foobar/src-gen/org/xtext/example/foobar/foo/FooPackage.java' is unmapped
 [java]     at org.eclipse.emf.ecore.resource.impl.PlatformResourceURIHandlerImpl.createOutputStream(PlatformResourceURIHandlerImpl.java:428)
 [java]     at org.eclipse.emf.ecore.resource.impl.ExtensibleURIConverterImpl.createOutputStream(ExtensibleURIConverterImpl.java:339)
 [java]     at org.eclipse.emf.codegen.ecore.generator.AbstractGeneratorAdapter.createOutputStream(AbstractGeneratorAdapter.java:1440)
 [java]     at org.eclipse.emf.mwe2.ecore.CvsIdFilteringGeneratorAdapterFactoryDescriptor$IdFilteringGenModelGeneratorAdapterFactory$IdFilteringGenPackageAdapter.createOutputStream(CvsIdFilteringGeneratorAdapterFactoryDescriptor.java:39)
 [java]     at org.eclipse.emf.codegen.ecore.generator.AbstractGeneratorAdapter.generateJava(AbstractGeneratorAdapter.java:1104)
 [java]     ... 21 more
 [java] org.eclipse.emf.common.util.WrappedException: java.io.IOException: The path '/org.xtext.example.foobar/src-gen/org/xtext/example/foobar/foo/Model.java' is unmapped
 [java]     at org.eclipse.emf.codegen.ecore.generator.AbstractGeneratorAdapter.generateJava(AbstractGeneratorAdapter.java:1112)
 [java]     at org.eclipse.emf.codegen.ecore.genmodel.generator.GenClassGeneratorAdapter.generateInterface(GenClassGeneratorAdapter.java:123)
 [java]     at org.eclipse.emf.codegen.ecore.genmodel.generator.GenClassGeneratorAdapter.generateModel(GenClassGeneratorAdapter.java:106)
 [java]     at org.eclipse.emf.codegen.ecore.genmodel.generator.GenBaseGeneratorAdapter.doGenerate(GenBaseGeneratorAdapter.java:221)
 [java]     at org.eclipse.emf.codegen.ecore.generator.AbstractGeneratorAdapter.generate(AbstractGeneratorAdapter.java:290)
 [java]     at org.eclipse.emf.codegen.ecore.generator.Generator.generate(Generator.java:617)
 [java]     at org.eclipse.emf.codegen.ecore.generator.Generator.generate(Generator.java:528)
 [java]     at org.eclipse.xtext.generator.ecore.EcoreGeneratorFragment.doGenerate(EcoreGeneratorFragment.java:144)
 [java]     at org.eclipse.xtext.generator.ecore.EcoreGeneratorFragment.generate(EcoreGeneratorFragment.java:211)
 [java]     at org.eclipse.xtext.generator.CompositeGeneratorFragment.generate(CompositeGeneratorFragment.java:81)
 [java]     at org.eclipse.xtext.generator.LanguageConfig.generate(LanguageConfig.java:108)
 [java]     at org.eclipse.xtext.generator.Generator.generate(Generator.java:352)
 [java]     at org.eclipse.xtext.generator.Generator.invokeInternal(Generator.java:126)
 [java]     at org.eclipse.emf.mwe.core.lib.AbstractWorkflowComponent.invoke(AbstractWorkflowComponent.java:126)
 [java]     at org.eclipse.emf.mwe.core.lib.Mwe2Bridge.invoke(Mwe2Bridge.java:34)
 [java]     at org.eclipse.emf.mwe.core.lib.AbstractWorkflowComponent.invoke(AbstractWorkflowComponent.java:201)
 [java]     at org.eclipse.emf.mwe2.runtime.workflow.AbstractCompositeWorkflowComponent.invoke(AbstractCompositeWorkflowComponent.java:35)
 [java]     at org.eclipse.emf.mwe2.runtime.workflow.Workflow.run(Workflow.java:19)
 [java]     at org.eclipse.emf.mwe2.launch.runtime.Mwe2Runner.run(Mwe2Runner.java:97)
 [java]     at org.eclipse.emf.mwe2.launch.runtime.Mwe2Runner.run(Mwe2Runner.java:73)
 [java]     at org.eclipse.emf.mwe2.launch.runtime.Mwe2Launcher.run(Mwe2Launcher.java:76)
 [java]     at org.eclipse.emf.mwe2.launch.runtime.Mwe2Launcher.main(Mwe2Launcher.java:35)
 [java] Caused by: java.io.IOException: The path '/org.xtext.example.foobar/src-gen/org/xtext/example/foobar/foo/Model.java' is unmapped
 [java]     at org.eclipse.emf.ecore.resource.impl.PlatformResourceURIHandlerImpl.createOutputStream(PlatformResourceURIHandlerImpl.java:428)
 [java]     at org.eclipse.emf.ecore.resource.impl.ExtensibleURIConverterImpl.createOutputStream(ExtensibleURIConverterImpl.java:339)
 [java]     at org.eclipse.emf.codegen.ecore.generator.AbstractGeneratorAdapter.createOutputStream(AbstractGeneratorAdapter.java:1440)
 [java]     at org.eclipse.emf.mwe2.ecore.CvsIdFilteringGeneratorAdapterFactoryDescriptor$IdFilteringGenModelGeneratorAdapterFactory$IdFilteringGenClassAdapter.createOutputStream(CvsIdFilteringGeneratorAdapterFactoryDescriptor.java:73)
 [java]     at org.eclipse.emf.codegen.ecore.generator.AbstractGeneratorAdapter.generateJava(AbstractGeneratorAdapter.java:1104)
 [java]     ... 21 more
 [java] org.eclipse.emf.common.util.WrappedException: java.io.IOException: The path '/org.xtext.example.foobar/src-gen/org/xtext/example/foobar/foo/Greeting.java' is unmapped
 [java]     at org.eclipse.emf.codegen.ecore.generator.AbstractGeneratorAdapter.generateJava(AbstractGeneratorAdapter.java:1112)
 [java]     at org.eclipse.emf.codegen.ecore.genmodel.generator.GenClassGeneratorAdapter.generateInterface(GenClassGeneratorAdapter.java:123)
 [java]     at org.eclipse.emf.codegen.ecore.genmodel.generator.GenClassGeneratorAdapter.generateModel(GenClassGeneratorAdapter.java:106)
 [java]     at org.eclipse.emf.codegen.ecore.genmodel.generator.GenBaseGeneratorAdapter.doGenerate(GenBaseGeneratorAdapter.java:221)
 [java]     at org.eclipse.emf.codegen.ecore.generator.AbstractGeneratorAdapter.generate(AbstractGeneratorAdapter.java:290)
 [java]     at org.eclipse.emf.codegen.ecore.generator.Generator.generate(Generator.java:617)
 [java]     at org.eclipse.emf.codegen.ecore.generator.Generator.generate(Generator.java:528)
 [java]     at org.eclipse.xtext.generator.ecore.EcoreGeneratorFragment.doGenerate(EcoreGeneratorFragment.java:144)
 [java]     at org.eclipse.xtext.generator.ecore.EcoreGeneratorFragment.generate(EcoreGeneratorFragment.java:211)
 [java]     at org.eclipse.xtext.generator.CompositeGeneratorFragment.generate(CompositeGeneratorFragment.java:81)
 [java]     at org.eclipse.xtext.generator.LanguageConfig.generate(LanguageConfig.java:108)
 [java]     at org.eclipse.xtext.generator.Generator.generate(Generator.java:352)
 [java]     at org.eclipse.xtext.generator.Generator.invokeInternal(Generator.java:126)
 [java]     at org.eclipse.emf.mwe.core.lib.AbstractWorkflowComponent.invoke(AbstractWorkflowComponent.java:126)
 [java]     at org.eclipse.emf.mwe.core.lib.Mwe2Bridge.invoke(Mwe2Bridge.java:34)
 [java]     at org.eclipse.emf.mwe.core.lib.AbstractWorkflowComponent.invoke(AbstractWorkflowComponent.java:201)
 [java]     at org.eclipse.emf.mwe2.runtime.workflow.AbstractCompositeWorkflowComponent.invoke(AbstractCompositeWorkflowComponent.java:35)
 [java]     at org.eclipse.emf.mwe2.runtime.workflow.Workflow.run(Workflow.java:19)
 [java]     at org.eclipse.emf.mwe2.launch.runtime.Mwe2Runner.run(Mwe2Runner.java:97)
 [java]     at org.eclipse.emf.mwe2.launch.runtime.Mwe2Runner.run(Mwe2Runner.java:73)
 [java]     at org.eclipse.emf.mwe2.launch.runtime.Mwe2Launcher.run(Mwe2Launcher.java:76)
 [java]     at org.eclipse.emf.mwe2.launch.runtime.Mwe2Launcher.main(Mwe2Launcher.java:35)
 [java] Caused by: java.io.IOException: The path '/org.xtext.example.foobar/src-gen/org/xtext/example/foobar/foo/Greeting.java' is unmapped
 [java]     at org.eclipse.emf.ecore.resource.impl.PlatformResourceURIHandlerImpl.createOutputStream(PlatformResourceURIHandlerImpl.java:428)
 [java]     at org.eclipse.emf.ecore.resource.impl.ExtensibleURIConverterImpl.createOutputStream(ExtensibleURIConverterImpl.java:339)
 [java]     at org.eclipse.emf.codegen.ecore.generator.AbstractGeneratorAdapter.createOutputStream(AbstractGeneratorAdapter.java:1440)
 [java]     at org.eclipse.emf.mwe2.ecore.CvsIdFilteringGeneratorAdapterFactoryDescriptor$IdFilteringGenModelGeneratorAdapterFactory$IdFilteringGenClassAdapter.createOutputStream(CvsIdFilteringGeneratorAdapterFactoryDescriptor.java:73)
 [java]     at org.eclipse.emf.codegen.ecore.generator.AbstractGeneratorAdapter.generateJava(AbstractGeneratorAdapter.java:1104)
 [java]     ... 21 more
 [java] 6768 INFO  EcoreGeneratorFragment - Diagnostic ERROR source=org.eclipse.emf.codegen.ecore code=0 Generating code data=[] [Diagnostic OK source=org.eclipse.emf.common code=0 OK data=[], Diagnostic OK source=org.eclipse.emf.common code=0 OK data=[], Diagnostic OK source=org.eclipse.emf.common code=0 OK data=[], Diagnostic OK source=org.eclipse.emf.common code=0 OK data=[], Diagnostic OK source=org.eclipse.emf.common code=0 OK data=[], Diagnostic ERROR source=org.eclipse.emf.codegen.ecore code=0 Generating Java interface org.xtext.example.foobar.foo.FooPackage failed with an unhandled exception data=[] [Diagnostic ERROR source=org.eclipse.emf.common code=0 IOException: The path '/org.xtext.example.foobar/src-gen/org/xtext/example/foobar/foo/FooPackage.java' is unmapped data=[java.io.IOException: The path '/org.xtext.example.foobar/src-gen/org/xtext/example/foobar/foo/FooPackage.java' is unmapped]], Diagnostic ERROR source=org.eclipse.emf.codegen.ecore code=0 Generating Java interface org.xtext.example.foobar.foo.Model failed with an unhandled exception data=[] [Diagnostic ERROR source=org.eclipse.emf.common code=0 IOException: The path '/org.xtext.example.foobar/src-gen/org/xtext/example/foobar/foo/Model.java' is unmapped data=[java.io.IOException: The path '/org.xtext.example.foobar/src-gen/org/xtext/example/foobar/foo/Model.java' is unmapped]], Diagnostic ERROR source=org.eclipse.emf.codegen.ecore code=0 Generating Java interface org.xtext.example.foobar.foo.Greeting failed with an unhandled exception data=[] [Diagnostic ERROR source=org.eclipse.emf.common code=0 IOException: The path '/org.xtext.example.foobar/src-gen/org/xtext/example/foobar/foo/Greeting.java' is unmapped data=[java.io.IOException: The path '/org.xtext.example.foobar/src-gen/org/xtext/example/foobar/foo/Greeting.java' is unmapped]], Diagnostic OK source=org.eclipse.emf.common code=0 OK data=[], Diagnostic OK source=org.eclipse.emf.common code=0 OK data=[], Diagnostic OK source=org.eclipse.emf.common code=0 OK data=[], Diagnostic OK source=org.eclipse.emf.common code=0 OK data=[]]
 [java] 10385 INFO  JavaValidatorFragment - generating Java-based EValidator API
 [java] 13246 INFO  Workflow           - Done. BUILD SUCCESSFUL Total time: 27 seconds 
```

The ".java" file which are unmapped were also not generated. The whole "/src-gen/...../foobar/foo" folder is missing.

I guess this is the reason and what should be fixed.

I really don't know, where the problem is. I already had a discussion in an [Eclipse forum](http://www.eclipse.org/forums/index.php/m/839974/#msg_839974) there you can find the build.xml but for another project, also an Activator class to activate the plugin and do the copy stuff and execute the ant script, also you find the mwe2 file I use.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T19:42:36.567

您必须确保在工作流程中将您的临时文件夹注册为平台 URI。Xtext 使用 EMF 的 platform:/resource URI 方案。因此，必须注册平台根目录，以便根据平台路径定义从文件系统上的绝对位置到逻辑位置的路径映射。您也可以尝试复制 .project 文件。如果您已经将临时文件夹注册为平台路径，我认为这会有所帮助。

# c - Manually calling C function with arbitrary stack data at run time

> ID：10079387
> 
> 赞同：1
> 
> 时间：2012-04-09T20:26:20.987
> 
> 标签：c, stack

I know the reasons why this is a bad idea and I also know that this is the reason C++ templates were created, but I'm doing it in C for the fun and learning.

I'm embedding Python into my application and I wanted to make it possible to register certain C functions, with any arbitrary type, to be callable at the application run-time. Because of this a pointer to them is stored (as a simple void*).

With some basic macro fun I have gotten all the information I need about these functions and stored that too - the function pointer, the size of the return value (and if it is void), the number of arguments and each of their sizes.

So I'm stuck at the final stage - which is the actual calling of the function pointer with the appropriate data. I'm fairly certain this sort of thing should be possible (I've caused stack errors in my own time), but I was wondering if there was a more...legitimate way to do it.

I guess the ideal would look something like this:

```
void call_function(void* function, void* return, void* arg_data, int arg_data_size); 
```

Does such a thing exists?

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:30:45.670

您可以声明一个指向函数的函数指针`void* (*f) (void*);`，该函数接受一个`void*`参数并返回一个`void*`返回值——您可以将它放在`call_function`.

然后调用`call_function`为：

```
void* function(void*);
ret_type ret;
arg_type arg_data;
call_function(&function, (void*)&ret, (void*)&arg_data, sizeof(arg_data)); 
```

where`arg_type`是您要在内部使用的实际参数类型，`function`并且`ret_type`是 的返回值的实际类型`function`。

注意：您可能还想指定返回值类型的大小。

注意：这将适用于一个参数的任何函数。该解决方案可以扩展到 中的固定/已知数量的参数`function`，但不能处理未知数量的参数。

注意：`return`不允许将第二个参数命名为`return`关键字。

# jquery - 带有和的jQuery event.target 标签

> ID：10079394
> 
> 赞同：1
> 
> 时间：2012-04-09T20:26:58.893
> 
> 标签：jquery, zepto

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T20:30:34.023

使用`this`而不是`event.target`.

```
var href = this.href; 
```

* * *

*   `event.target`是被点击的嵌套最深的元素

*   `this`是处理程序绑定到的元素*（或者在委托的情况下`.live()`，它是成功匹配选择器的元素）*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T20:31:03.963

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T20:33:02.843

首先，您应该使用`.on`（如果有的话）甚至更糟，`.delegate`而不是`.live`. 除此之外，您可以`href`从事件绑定到的对象而不是目标中获取：

```
var href = $(this).attr('href'); 
```

如果你*真的*想使用目标，你可以找到最近的anchor parent：

```
var href = $(event.target).closest('a').attr('href'); 
```

# java - Oracle RAW id 列和 JDBC

> ID：10079398
> 
> 赞同：0
> 
> 时间：2012-04-09T20:27:16.060
> 
> 标签：java, oracle, jdbc

我正在尝试开发一个调用 Oracle 11g XE 数据库的简单 Java servlet。我提供的数据库对所有表的 ID 使用 RAW 列类型。

最初，我试图从 JDBC 中获取数据，并对返回的 VARBINARY 字节数组进行 base64 编码，这样我就可以通过 JSON 将结果传递给前端系统。但是，在 base64 解码并尝试将字节数组设置回列之后，Oracle/JDBC 没有返回数据。

我决定尝试让 Oracle 进行编码/解码，并能够使用 SQL Developer 2 在 Oracle 中触发以下查询。

```
SELECT utl_encode.base64_encode(IDCOLUMN), FIRST_NAME FROM TABLENAME
SELECT utl_encode.base64_encode(IDCOLUMN), FIRST_NAME FROM TABLENAME WHERE IDCOLUMN = utl_encode.base64_decode('BASE64STRING') 
```

但是，当使用 JDBC 执行这些查询时：

```
conn = isConnSupplied ? userConn : ResourceManager.getConnection();
Statement stmt = conn.createStatement();
 try {
   ResultSet rset = stmt.executeQuery("SELECT utl_encode.base64_encode(IDCOLUMN), FIRST_NAME FROM TABLENAME");
   try {
     while (rset.next())
       System.out.println (rset.getString(1));   // Print col 1
   } 
   finally {
      try { rset.close(); } catch (Exception ignore) {}
   }
 } 
 finally {
   try { stmt.close(); } catch (Exception ignore) {}
 } 
```

我收到以下错误：

```
java.sql.SQLException: ORA-29261: bad argument
ORA-06512: at "SYS.UTL_ENCODE", line 8
ORA-06512: at "SYS.UTL_ENCODE", line 243

oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:445)
oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:396)
oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:879)
oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:450)
oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:192)
oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:531)
oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:193)
oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:866)
oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:1167)
oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1289)
oracle.jdbc.driver.OracleStatement.executeQuery(OracleStatement.java:1491)
oracle.jdbc.driver.OracleStatementWrapper.executeQuery(OracleStatementWrapper.java:406)
com.pearson.familyportal.servlet.WebController.doPost(WebController.java:97)
com.pearson.familyportal.servlet.WebController.doGet(WebController.java:171)
javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

问题：当我必须在客户端传递这些 RAW ID 列字节数组时，最好的方法是什么？如果让 Oracle 进行转换，我做错了什么 JDBC 不喜欢？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:35:20.317

尝试使用 RAWTOHEX 和 HEXTORAW。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T21:01:19.227

我有 Oracle Database 10g Enterprise Edition Release 10.2.0.1.0 和 Java 1.6，
这段代码运行良好

```
 Statement stmt = conn.createStatement();
       ResultSet rset = stmt.executeQuery("SELECT utl_encode.base64_encode(ID), NAME FROM raw_table");
        while (rset.next())
        {
            Object obj = rset.getString(1);
            logger.debug(obj);
        } 
```

另外我想说的是，Tom Kyte 不建议使用 RAW 类型。

# ruby-on-rails - 在 Rails 3 中使用 Ajax 更新部分内容

> ID：10079399
> 
> 赞同：2
> 
> 时间：2012-04-09T20:27:43.527
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3, partials

我有一个项目列表和一个边栏，其中显示有关项目的详细信息。侧边栏是一个局部的，当 onmouseenter 事件在列表中的某个项目上被触发时，它应该随着 Ajax 的变化而改变。

我已经设法通过 Ajax 将（我输入鼠标的项目的）id 发送到我的控制器的操作“列表”，但部分没有更新...... :(

我确信我非常接近解决方案。我是 Ajax 新手，整个下午我都在 StackOverflow 和许多其他网站上进行了搜索，但他们总是解释如何使用 Ajax 管理 CRUD 操作，但它似乎对我不起作用......

这是代码：

- ajax 部分：

```
$("div.item").mouseenter(function(event){
 var id = $(this).attr('data');
    var url = "/item/list?id="+id+"&lg=en";
    var data = $(this).serialize();
    $.post(url,function(response_data){$("#item_details").html(response_data)});
    return false;
}); 
```

-控制器动作：

```
def list
    @items = Item.all
    if request.xhr?
        id_exists?("item", params[:id], "item", "list"){@item = Item.find(params[:id])}

        render :partial => "item/sidebar/sidebar_home", :object => @item
    else
        @item = @items.first unless @items.empty?
    end
end 
```

- 火腿：

```
content_for :sidebar do
   #item_details
       =render :partial => "item/sidebar/sidebar_home", :object => @item

.items_wrapper
-if @items.empty?
    ="No items"
-else
    = render :partial => "item/partials/item", :collection => @items 
```

在第二部分里面，我有 div.item 包装了所有东西。所以基本上，我想更新侧边栏的内容，仅此而已。

对不起，如果这个问题看起来很愚蠢，并提前感谢您的帮助。

感谢Ogz向导，问题解决了！XD

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:14:38.957

您需要传递一个回调函数来处理来自您的 AJAX 请求的响应。见[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

一个示例可能如下所示：

```
$.post(url, data, function(response_data){ $("#sidebar_id").replaceWith(response_data) }); 
```

# c++ - 找不到包含文件 在 OS X 上？

> ID：10079403
> 
> 赞同：1
> 
> 时间：2012-04-09T20:28:10.303
> 
> 标签：c++, osx-lion

我无法在 mac 中使用 mqueue.h。当我尝试在我的 C++ 程序中包含这个头文件时，它说找不到包含文件。有没有办法在 mac 中使用它？或者是否有任何通用的替代方案。

我想使用 mqueue.h 中存在的 O_NOBLOCK 标志？

我发现 IPC 消息队列有以下限制，在决定使用它们之前可能会有用。

```
Max Number of Msg Queue Identifiers = 16
Max Size of Messages = 8192 (Bytes)
Default Max Size of a Message Queue = 16384 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T01:16:50.637

`mqueueh.h`用于 POSIX 消息队列，在 OS X 上不可用。 `O_NONBLOCK`与此无关，在`fcntl.h`.

`#include <sys/fcntl.h>`

应该做的伎俩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T01:10:25.500

我不记得 mqueue.h 是什么，但 O_NONBLOCK 不需要它。你想要`<fcntl.h>`。

# file - 在 Windows .bat 文件中，我如何找到任意文件的路径，然后将其写入变量

> ID：10079413
> 
> 赞同：0
> 
> 时间：2012-04-09T20:28:54.220
> 
> 标签：file, search, variables, batch-file, return

例如，我将提供一个文件名，并且我希望脚本在计算机中搜索该文件并返回变量的路径。伪调用是：

设置 pathToMyFile = SomeSearchFunction(myFileToSearchFor.ext)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:03:05.557

`dir /b /s "c:\myFileToSearchFor.ext"`将列出 C: 驱动器中文件的每一次出现，包括完整的路径信息。

该文件可能存在于多个位置。

此批处理命令会将变量设置为最后找到的位置：

```
for /f "delims=" %%F in ('dir /b /s "c:\myFileToSearchFor.ext"') do set "pathToMyFile=%%~dpF" 
```

此批处理脚本会将变量设置为第一个找到的位置：

```
for /f "delims=" %%F in ('dir /b /s "c:\myFileToSearchFor.ext"') do (
  set "pathToMyFile=%%~dpF"
  goto :foundIt
)
:foundIt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T21:07:29.863

据我所知，没有任何功能/程序可以执行此操作。如果您需要效率，您可以编写一个程序，对所有目录进行花哨的树搜索。但是，我确实找到了批量解决方案！

`@echo off
for /r "C:\somebasepath" %%i in (*) do (
if "%%~nxi" EQU "%1" (
echo %%i
break
)
)`

将要找到的文件作为第一个参数传递给批处理文件。但是如果它在一个很深的目录中，这是非常非常慢的。

# java - 用多个空格分割字符串

> ID：10079415
> 
> 赞同：61
> 
> 时间：2012-04-09T20:29:07.440
> 
> 标签：java, regex, string, split

我想拆分一个字符串

```
"first     middle  last" 
```

与`String.split()`. 但是当我尝试拆分它时，我得到了

```
String[] array = {"first","","","","middle","","last"} 
```

我尝试`String.isEmpty()`在拆分它们后检查空字符串，但它在android中不起作用。这是我的代码：

```
String s = "First  Middle Last";
String[] array = s.split(" ");
for(int i=0; i<array.length; i++) {
  //displays segmented strings here
} 
```

我认为有一种方法可以像这样拆分它：`{"first","middle","last"}`但无法弄清楚如何。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2012-04-09T20:33:21.320

由于 to 的参数[`split()`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#split%28java.lang.String%29)是一个[正则表达式](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#sum)，您可以查找一个或多个空格 ( `" +"`) 而不仅仅是一个空格 ( `" "`)。

```
String[] array = s.split(" +"); 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-04-09T20:34:44.940

尝试使用这个`s.split("\\s+");`

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-10-11T11:55:14.897

如果你有一个字符串

```
String s = "This is a test string  This is the next part    This is the third part"; 
```

并想得到一个像

```
String[] sArray = { "This is a test string", "This is the next part", "This is the third part" } 
```

你应该试试

```
String[] sArray = s.split("\\s{2,}"); 
```

该`{2,}`部分定义至少需要 2 个和最多几乎无限个空格字符才能进行拆分。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-09-21T12:53:55.857

这对我有用。

```
s.split(/\s+/) 
```

```
var foo = "first     middle  last";

console.log(foo.split(/\s+/));
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-09T20:33:53.937

由于`split()`使用了[正则表达式](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html)，因此您可以`s.split("\\s+")`将拆分分隔符设置为任意数量的空白字符。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-24T05:01:08.003

如何使用 Android SDK 开箱即用的东西。

```
TextUtils.split(stringToSplit, " +"); 
```

# c# - 无法使用 ADOX 创建 Access 数据库

> ID：10079418
> 
> 赞同：2
> 
> 时间：2012-04-09T20:29:17.660
> 
> 标签：c#, ms-access, adox

我对 ADOX Interop 有一个非常奇怪的问题。

我有这个代码：

```
 try
        {
            if (File.Exists(path))
                File.Delete(path);

            var cat = new CatalogClass();
            cat.Create("Provider=Microsoft.Jet.OLEDB.4.0; Data Source = d:\\Test.mdb; Jet OLEDB:Engine Type=5");

            Marshal.ReleaseComObject(cat);
            cat = null;
            GC.Collect();
        }
        catch (FileNotFoundException e)
        {
            throw new FileNotFoundException("El archivo no se encuentra", e);
        }
        catch (COMException e)
        {
            throw new COMException(connStr + e.Message);
        }
        catch (Exception e)
        {
            throw new Exception(connStr, e);
        } 
```

代码在 cat.Create() 行中失败。真正奇怪的是，在我的本地开发人员机器上它工作正常，但在生产服务器中却没有......这不是写权限问题，因为我试图在问题行之前生成一个随机文件并且工作完美。COMException 消息只是“未指定错误”HResult:-2147467259

服务器操作系统是 Windows 2008 32 位。我认为是服务器配置问题，但你能给我一些启示吗？我不知道我还能做什么...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:10:53.323

如果您将应用程序部署在 64 位机器上，您的代码将无法通过 JET.OleDB.4.0 使用 ADOX。
如果是这种情况，那么一个快速的解决方案可能是将您的目标架构更改为 x86。

否则，您可以尝试在目标机器上下载并安装 64 位版本的[Microsoft Access 数据库引擎](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=13255)驱动程序，但我不知道它们是否支持 ADOX。您还需要更改连接字符串

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T00:09:54.977

看看你是否可以在你的 c# 代码之外使用 ADOX Catalog。如果您安装了 Access，请按照 Steve 的建议尝试使用 Access VBA。如果没有安装 Office，请尝试使用 VBScript。

这适用于我的 32 位 Windows 7。在 64 位 Windows 7 上，它失败并出现有关“类未注册”的错误。我意识到这不是你的情况，因为你说你的服务器是 32 位的（回复一个已经被删除的答案）。但是我希望脚本要么成功，要么给你一个比你从 c# 错误条件中得到的信息更丰富的错误消息。

```
'Const cPath = "C:\Users\hans\Documents\Test.mdb"
Const cPath = "d:\Test.mdb"
Dim objCat
Dim strConnect
strConnect = "Provider=Microsoft.Jet.OLEDB.4.0;" & _
    "Data Source=" & cPath & ";Jet OLEDB:Engine Type=5"
WScript.Echo strConnect

Set objCat = CreateObject("ADOX.Catalog")
objCat.Create strConnect
Set objCat = Nothing 
```

我命名了该文件`AdoxCreateDb.vbs`并`cscript`从命令提示符窗口运行它。

```
cscript AdoxCreateDb.vbs 
```

# sql - 如何根据另一个表中的值从一个表中获取值？

> ID：10079419
> 
> 赞同：0
> 
> 时间：2012-04-09T20:29:24.593
> 
> 标签：sql, database, vb.net

说我有桌子

```
 Parts
    PartID (Primary Key)
    Part Name

    Orders
    OrderID (Primary Key)
    CustID (Foreign Key)

    OrderDetails
    OrderDetailsID (Primary Key)
    PartID (Foreign Key)
    Quantity
    OrderID (Foreign Key) 
```

如果我想从 OrderDetails 中获取多个 PartID 的 Part Name，我该怎么做呢？我会使用两个数据表吗？我很困惑，因为我看不到有效的方法来做到这一点。我唯一能想到的就是用 SQL 创建一个 DataTable：

```
 SELECT * FROM OrderDetails WHERE OrderID=OrderID; 
```

然后可能使用 For 循环来获取每个 PartID，创建另一个 DataTable 以找到 PartName，然后将其提供给变量。最多可以搜索 10 个 PartID，我不希望有 PartID1 PartID2 等变量。

我希望我能够有效地传达我的问题。

谢谢

编辑：

```
 SQLCmd = "SELECT tblParts.PartID, tblParts.PartName, tblOrderDetails.Quantity, OrderDetails.OrderID FROM tblOrderDetails, tblParts "
    SQLCmd = SQLCmd & "WHERE tblParts.PartID = OrderDetails.PartID AND OrderID=" & OrderID & ";" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:38:45.093

我想你正在寻找`join`. 语法稍微取决于您使用的 SQL 类型，但它通常看起来像这样：

```
SELECT `Part Name`
FROM Parts p
INNER JOIN OrderDetails o ON p.PartID = o.PartID
WHERE o.OrderDetailsID = ...; 
```

据我了解，这将创建一个临时表，其中包含两个表的字段组合。理论上，它将在组合表中为来自两个原始表的每个可能的记录组合创建一个记录。为了将其减少到一个合理的数量，您引入了关系`p.PartID = o.PartID`，这将其减少到仅那些大约相同的组合`PartID`。

内连接意味着它将仅从具有关联部件 ID 的订单中选择，并且仅从订单中的部件中进行选择。`LEFT`和`RIGHT`join 可以做相反的事情 - 选择所有部分，即使它们不在订单中（左）或所有订单，即使它们没有部分（右）。

W3Schools 在这里有更多关于连接的信息：http: [//www.w3schools.com/sql/sql_join.asp](http://www.w3schools.com/sql/sql_join.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:44:58.330

就像是：

```
SELECT o.orderID, p.partname, od.quality
FROM orders o
INNER JOIN orderdetails od ON o.orderID = od.orderID
INNER JOIN parts p ON od.partID = p.partID 
```

就我个人而言，尽管我会将零件名称和价格存储在订单详细信息中，以便对实际订购的内容进行历史记录。毕竟，例如，如果价格上涨，您不希望历史订单发生变化。

# c# - 从列表转换 到 int

> ID：10079428
> 
> 赞同：1
> 
> 时间：2012-04-09T20:30:06.087
> 
> 标签：c#, casting

谁能告诉我这是否可以做到，如果可以，怎么做？

我有一个`List<float> FocalLengthList`填充了一些值的值。然后这个列表存储在一个`List<List<float>> MainFocalLenghtList`. 但是，在我的应用程序中，我需要使用来自MainFocalLenghtList 的值来更新对象的 3D 位置。所以我需要转换`fromMainFocalLenghtList [0]`为`int`.

这可以做到吗？怎么做？

这是我的代码的一小部分来解释。将值添加到 FocalLengthList 然后将该列表添加到`List<List<float>> MainFocalLenghtList`

```
float newFocalLength = focalLength * pixelSize; 
FocalLengthList.Add(newFocalLength); 
MainFocallengthList.Add(FocalLengthList); 
FocalLengthList = new List<float>(); 
```

然后我打算如何使用这些值（不起作用）

```
int zComponent = MainFocallengthList[0]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:37:15.563

You can certainly cast a `float` to an `int`, as long as you do so explicitly (since it may involve a loss of precision).

The problem with the code you've posted is that you're indexing into a list *of other lists*. The value returned by `MainFocallengthList[0]` will itself be a `List<float>`. You must then index into *that* list to get a value you can actually cast to int.

Assuming both the target list and the target float *in* that list are at the first index of their respective containers:

```
int zComponent = (int)MainFocalLengthList[0][0]; 
```

That first index returns the `FocalLengthList` that you added to `MainFocalLengthList`. The second index returns the `newFocalLength` value that you added to `FocalLengthList`. Clear? :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:34:26.197

我可能会这样做：

```
int zComponent = (int)Math.Ceiling(MainFocallengthList[m][n]); 
```

尽管您希望将实际值替换为*m* ^(th中的第)*n*^个项目。 *^(`FocalLengthList`)*

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T20:43:27.347

Give this a shot:

```
var floatList = new List<float>();

var intList = floatList.Select(f => (int)Math.Ceiling(f)).ToList(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T20:43:33.923

Since `MainFocalLengthList` is a List of `List<float>`

```
var intarr = Array.ConvertAll(MainFocalLengthList[0].ToArray(), f=>(int)f); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T20:34:37.880

您可以这样做，但您需要内部和外部列表的索引：

```
// The first [0] indicates the index of the nested list within MainFocallengthList
// The second [0] indicates the index of the item that you want in the nested list
int zComponent = (int)(MainFocallengthList[0][0]) 
```*

# java - 基于使用 DOM 的特定属性从 xml 文件中删除元素节点

> ID：10079431
> 
> 赞同：0
> 
> 时间：2012-04-09T20:30:11.177
> 
> 标签：java, xml-parsing

我有以下xml文件结构

```
<?xml version="1.0" encoding="UTF-8"?>
<data Calls="1" Method="setDescription(java.lang.String) void" Class="Symptom" Package="emrservicedesign" Base_Time_.seconds.="0.000004"/>
<data Invoked_by="1" Method="testSetDescription() void" Class="SymptomTest"/>
<data Calls="4" Method="setDescription(java.lang.String) void" Class="Symptom" Package="emrservicedesign" Base_Time_.seconds.="0.000004"/>
</View> 
```

我要做的是删除所有具有“Invoked_by”作为属性的元素节点，因此上述 xml 文件的结果应该是

```
<?xml version="1.0" encoding="UTF-8"?>
<data Calls="1" Method="setDescription(java.lang.String) void" Class="Symptom" Package="emrservicedesign" Base_Time_.seconds.="0.000004"/>
<data Calls="4" Method="setDescription(java.lang.String) void" Class="Symptom" Package="emrservicedesign" Base_Time_.seconds.="0.000004"/> 
</View> 
```

这是我写的代码

```
NodeList nodes = doc.getElementsByTagName("data");     
for (int i = 1; i < nodes.getLength(); i++) 
{Node node = nodes.item(i); 
Element e = (Element) node;
if (e.hasAttribute("Invoked_by")){ nodes.item(i).removeChild(node);} 
```

**这是错误**

```
org.w3c.dom.DOMException: NOT_FOUND_ERR: An attempt is made to reference a node in a context where it does not exist. 
```

如果有任何机构可以提供帮助，我将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-08T00:02:11.180

因为 Invoked_by 不是每个节点的属性，所以在对 Invoked_by 属性应用 XML 的 remove 方法之前，首先检查每个节点中属性的可用性。

# c# - 在 C# 中，我们有哪些选择来克隆对象或复制其属性？

> ID：10079433
> 
> 赞同：0
> 
> 时间：2012-04-09T20:30:26.053
> 
> 标签：c#, oop, clone

> **可能重复：**
> [在 C# 中克隆对象](https://stackoverflow.com/questions/78536/cloning-objects-in-c-sharp)

[所以我们没有标准的定义](https://stackoverflow.com/questions/2200409/what-is-the-difference-between-copying-and-cloning)来区分*克隆*和*复制*，让我们假设它们是相同的。

似乎在 C# 中克隆对象[非常复杂。](https://stackoverflow.com/questions/8025890/is-there-a-much-better-way-to-create-deep-and-shallow-clones-in-c/8026574#8026574)至少与[javascript](https://stackoverflow.com/questions/122102/what-is-the-most-efficient-way-to-clone-a-javascript-object)相比。确实有[很多](https://stackoverflow.com/questions/78536/cloning-objects-in-c-sharp)不同的方法可以[做到这一点](https://stackoverflow.com/questions/930433/apply-properties-values-from-one-object-to-another-of-the-same-type-automaticall)。甚至[有人认为复制对象没有意义](http://www.agiledeveloper.com/articles/cloning072002.htm)。

也就是说，我们所有的内置选项是什么？例如，是否有任何我们不需要担心[保护](https://stackoverflow.com/questions/1308803/why-is-cloning-in-net-so-difficult)[的非序列化](https://stackoverflow.com/questions/2585652/methods-for-deep-cloning-objects-in-c-sharp)选项？

有哪些常见的方法来做到这一点？我们有他们的名字吗，就像我们有[排序](http://en.wikipedia.org/wiki/Sorting_algorithm#Summaries_of_popular_sorting_algorithms)一样？

# asp.net-mvc - 对于同一个 IIS 网站下的不同 IIS 应用程序，如何配置单独的 Forms 身份验证？

> ID：10079434
> 
> 赞同：3
> 
> 时间：2012-04-09T20:30:32.633
> 
> 标签：asp.net-mvc, iis-7, forms-authentication

我有一个使用表单身份验证的 Asp.Net MVC 应用程序，它以不同的应用程序名称发布到同一个 IIS 网站：

```
Default Web Site/Dashboard
Default Web Site/Partner 
```

使用 Chrome，如果我转到`Dashboard`实例并登录，一切似乎都正常。如果我打开一个单独的浏览器窗口并导航到该`Partner`实例，系统会提示我按预期登录。登录`Partner`实例后，一切似乎也正常。 **当我返回之前的浏览器窗口并尝试访问`Dashboard`实例上经过身份验证的资源时，就会出现问题，在那里我被重定向到登录页面，就好像我以某种方式被注销一样。** 如果我在`Dashboard`实例上再次登录，事情就会再次正常工作。但如果我去`Partner`例如，我发现我在那里登出。似乎登录到另一个应用程序实例的行为以某种方式让我退出了前一个应用程序实例。我做了一些检查，看来问题是由我的表单身份验证 cookie 设置引起的。这是我使用的：

```
<authentication mode="Forms">
  <forms loginUrl="~/Account/LogOn"
         timeout="1576800"/>
</authentication> 
```

我没有明确指定 cookie 路径，所以我认为 cookie 路径可能由应用程序实例共享，因此它被覆盖了。所以我试图明确指定一个cookie路径。所以当我发布时`Dashboard`，我使用了这个：

```
 <authentication mode="Forms">
      <forms loginUrl="~/Account/LogOn"
             timeout="1576800"
             cookieless="UseCookies"
             path="/Dashboard" />
 </authentication> 
```

而对于`Partner`，我使用了这个：

```
 <authentication mode="Forms">
      <forms loginUrl="~/Account/LogOn"
             timeout="1576800"
             cookieless="UseCookies"
             path="/Partner" />
 </authentication> 
```

然而，这根本不起作用。使用这些设置，我什至无法正确登录和注销。 **我的目标是让 Dashboard 和 Partner 实例完全独立于表单身份验证，因此登录其中一个不会影响另一个。如果不将它们放在不同的 IIS 网站名称中，这可能吗？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T02:18:22.670

在每个应用程序的 web.config 中，为您的身份验证标签中的 cookie 名称设置唯一名称

```
 <authentication name="DashBoard" mode="Forms">
 <forms loginUrl="~/Account/LogOn" />
</authentication> 
```

# jsf - JSF IllegalException：组件 ID 表单：`xyz` 已在视图中找到

> ID：10079441
> 
> 赞同：1
> 
> 时间：2012-04-09T20:31:02.700
> 
> 标签：jsf, file-upload, icefaces

我`IllegalStateException`说组件 ID 表单已经在视图中找到，我不确定是什么导致了这个问题，我一开始不想要这个异常。

**例外**

```
Servlet.service() for servlet Faces Servlet threw exception: java.lang.IllegalStateException:
Component ID form:_captureFileOnsubmit has already been found in the view.
at com.sun.faces.util.Util.checkIdUniqueness(Util.java:846) [:2.1.7-SNAPSHOT]
at com.sun.faces.util.Util.checkIdUniqueness(Util.java:830) [:2.1.7-SNAPSHOT]
at com.sun.faces.util.Util.checkIdUniqueness(Util.java:830) [:2.1.7-SNAPSHOT]
at com.sun.faces.application.view.StateManagementStrategyImpl.saveView(StateManagementStrategyImpl.java:135) [:2.1.7-SNAPSHOT]
at com.sun.faces.application.StateManagerImpl.saveView(StateManagerImpl.java:133) [:2.1.7-SNAPSHOT]
at com.sun.faces.application.view.WriteBehindStateWriter.flushToWriter(WriteBehindStateWriter.java:225) [:2.1.7-SNAPSHOT]
at com.sun.faces.application.view.FaceletViewHandlingStrategy.renderView(FaceletViewHandlingStrategy.java:419) [:2.1.7-SNAPSHOT]
at com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:125) [:2.1.7-SNAPSHOT]
at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:121) [:2.1.7-SNAPSHOT]
at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101) [:2.1.7-SNAPSHOT]
at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139) [:2.1.7-SNAPSHOT]
at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594) [:2.1.7-SNAPSHOT]
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:324) [:6.0.0.Final]
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:242) [:6.0.0.Final] 
```

我的`xhtml`页面看起来像：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:icecore="http://www.icefaces.org/icefaces/core"   xmlns:ace="http://www.icefaces.org/icefaces/components"    xmlns:ice="http://www.icesoft.com/icefaces/component">
    <script type="text/javascript" src="/js/icefaces/ace-jquery.js" />
    <script type="text/javascript" src="/js/icefaces/ace-components.js" />
    <script type="text/javascript" src="/js/icefaces/icepush.js" />
    <script type="text/javascript" src="/js/icefaces/bridge.js" />
    <script type="text/javascript" src="/js/icefaces/compat.js" />
    <script type="text/javascript" src="/js/icefaces/fileEntry.js" />
    <script type="text/javascript" src="/js/icefaces/jsf.js" />
    <script type="text/javascript" src="/js/icefaces/icefaces-compat.js" />

    <h:head>
        <title>ICEfaces 3</title>
        <link rel="stylesheet" type="text/css" href="/xmlhttp/css/rime/rime.css"/>
    </h:head>
    <h:body>
             <h:form id="form">
                <h:outputText value="Welcome to ICEfaces 3, select current date: "/>
                <ace:dateTimeEntry renderAsPopup="true">
                    <f:convertDateTime pattern="MM/dd/yyyy" timeZone="Canada/Mountain"/>
                </ace:dateTimeEntry>
                <ace:fileEntry id = "fileUpload"
                               label="File Entry"
                               relativePath="uploaded"
                               fileEntryListener="#{fileUpload.uploadFile}"/>
             <h:commandButton value="Upload File" />
             </h:form>
    </h:body>
</html> 
```

我所做的只是让`fileUpload`功能正常工作，奇怪的是文件夹中存在`javascript`的`css`东西在`javax.faces.resources`应用程序中没有被引用，所以我得到了一些奇怪的错误。

另一件需要注意的事情是，如果我使用`eclipse`插件，`icefaces`那么`fileUplaod`功能可以正常工作，但如果我尝试在没有插件的情况下构建它们并且只使用标准的所需 jar 集，那么我会得到与组件 ID 相关的 IllegalStateException。

有什么想法，建议？

**更新**

```
<context-param>
    <param-name>javax.faces.FACELETS_SKIP_COMMENTS</param-name>
    <param-value>true</param-value>
</context-param>

<context-param>
<param-name>javax.faces.VALIDATE_EMPTY_FIELDS</param-name>
<param-value>false</param-value>
</context-param>

<context-param>
<param-name>com.icesoft.faces.concurrentDOMViews</param-name>
<param-value>false</param-value>
</context-param>

<context-param>
<param-name>com.icesoft.faces.synchronousUpdate</param-name>
<param-value>false</param-value>
</context-param>

<context-param>
<param-name>com.icesoft.faces.blockingRequestHandler</param-name>
<param-value>icefaces</param-value>
</context-param>

<context-param>
<param-name>com.icesoft.faces.checkJavaScript</param-name>
<param-value>false</param-value>
</context-param> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T21:15:40.540

当我将 javax.faces.PROJECT_STAGE 设置为 Development 时，使用 mojarra 会出现这样的错误。如果您有此设置，请将其更改为生产并查看错误是否消失。

我虽然它是已知的错误，但找不到任何东西。

# regex - MongoDB中的慢正则表达式查询

> ID：10079444
> 
> 赞同：5
> 
> 时间：2012-04-09T20:31:05.523
> 
> 标签：regex, mongodb

我在一个带有索引“名称”字段的集合中有 150 万个文档。查询喜欢`db.things.find({name: /^foo/i})`大约需要 5 秒，这非常慢。具有相同记录的类似 MySQL 表`SELECT * FROM things WHERE name LIKE 'foo%'`在不到 10 毫秒内执行。

mongo的解释：

```
db.things.find({name: /^foo/i}).limit(10).explain()
{
    "cursor" : "BtreeCursor name_1 multi",
    "nscanned" : 325730,
    "nscannedObjects" : 10,
    "n" : 10,
    "millis" : 4758,
    "nYields" : 89,
    "nChunkSkips" : 0,
    "isMultiKey" : false,
    "indexOnly" : false,
    "indexBounds" : {
        "name" : [
            [
                "",
                {

                }
            ],
            [
                /^foo/i,
                /^foo/i
            ]
        ]
    }
} 
```

那么 mongo 中的正则表达式查询*是*慢还是我做错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T03:38:10.693

不区分大小写的正则表达式搜索会很慢，因为它不能有效地利用索引。如果您只使用该字段进行搜索，则应考虑以全小写形式存储文本并使用区分大小写的正则表达式进行搜索。

# lua - 结合使用 dofile 和 require

> ID：10079445
> 
> 赞同：1
> 
> 时间：2012-04-09T20:31:06.887
> 
> 标签：lua

在我当前的项目中，我试图通过在我的`main.lua`. 然后，我需要第三个文件，该文件使用我试图在项目中添加的全局文件；`attempting to index the global value`但是这样做时我收到一个错误。

例如，在下面的示例中，我使用 dofile() 试图使 test1:hello() 在我的项目中全局可用，但在需要 test2.lua 的过程中，我收到错误：

```
PANIC: unprotected error in call to Lua API (test2.lua: attempt to index global 'test1' (a nil value)) 
```

在这种情况下， test1 不应该已经作为全局存在吗？我怎样才能解决这个问题？

main.lua:

```
dofile('test1.lua')
require('test2') 
```

测试1.lua

```
test1 = {}
function test1:hello()
   print("hello")
end 
```

测试2.lua

```
module('test2')

test1:hello() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T21:05:58.207

在 main.lua 中：

```
require("test2.lua") 
```

应该：

```
require("test2") 
```

在 test2.lua 中，我必须将 package.seeall 作为第二个参数传递给 module() 以便它可以看到 test1 中的值

```
module('test2', package.seeall)
test1:hello() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:56:41.503

我刚刚测试了代码（在普通的 Lua 5.1 中），它对我有用（虽然我不得不替换`require('test2.lua')`）`require('test2')`。

可能是你的环境有问题。你在哪里执行这个 Lua 代码。它允许全局声明吗？

如果是，那么听起来好像您并没有完全按照您在问题中所说的那样做。

检查以下内容：

*   `dofile('test1.lua')`*之前真的*执行过`require('test2.lua')`
*   变量名是可以的（比如你没有写`tset1`而不是`test1`在某个地方）

# c - readv：错误的地址

> ID：10079450
> 
> 赞同：0
> 
> 时间：2012-04-09T20:31:18.240
> 
> 标签：c, unix, system

在我使用的库中，`Bad address`由于`readv`.

错误的确切来源是什么？是目的地还是源头？为什么不呢`segfault`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:55:37.170

`Bad Address`是 的错误消息`EFAULT`， http: [//linux.die.net/man/2/read](http://linux.die.net/man/2/read)解释（`read()`错误代码与 for 相同`readv()`）的意思`buf`是在您的进程的可寻址内存之外。因为`readv()`这意味着要么`iov`（可能，但我猜这会导致段错误，因为它只是库 - “解释” AFAIK），或者更可能的是 - 指针之一`iov_base`（传递给适当的系统调用来实现`readv()`）在外部你的可寻址内存；`EFAULT`是告诉您用于数据交换的传入指针无效的内核方式。

检查`NULL`-pointers 或类似的东西，正如评论者所说：`valgrind`可以帮助您诊断问题的根源 - 如果您有可用于库和用户代码的调试符号。

# c++ - 使用 pugixml 或实际的 HTML 解析器进行 HTML 解析

> ID：10079451
> 
> 赞同：4
> 
> 时间：2012-04-09T20:31:18.783
> 
> 标签：c++, html, html-parsing, pugixml

我对使用[pugixml](http://pugixml.org/)解析 HTML 文档很感兴趣，但是 HTML 有一些[可选的结束标签](http://www.w3.org/TR/REC-html40/index/elements.html)。这是一个例子：`<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">`

Pugixml 在遇到未关闭的标签时立即停止读取 HTML，但在 HTML 中缺少关闭标签并不一定意味着开始-结束标签不匹配。

解析 pugixml 的 HTML 文档的简单测试失败，因为元标记是 HTML 文档的第二行：http: [//pugixml.googlecode.com/svn/tags/latest/docs/quickstart.html](http://pugixml.googlecode.com/svn/tags/latest/docs/quickstart.html)

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>pugixml 1.0</title>
<link rel="stylesheet" href="pugixml.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
<link rel="home" href="quickstart.html" title="pugixml 1.0">
</head>
<!--- etc... --> 
```

如果我尝试使用 pugixml 解析它们，很多 HTML 文档都会失败。有没有办法避免这种情况？如果没有办法“修复”它，那么是否还有另一个与 pugixml 一样快的 HTML 解析工具？

## 更新

如果 HTML 解析器也支持 XPATH，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T22:23:59.137

我最终采用了 pugixml，将其转换为 HTML 解析器，并为它创建了一个 github 项目：[https ://github.com/rofldev/pugihtml](https://github.com/rofldev/pugihtml)

目前它并不完全符合 HTML 规范，但它在解析 HTML 方面做得足够好，我可以使用它。我正在努力使其符合 HTML 规范。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T22:48:44.807

解决此问题的一种方法是进行一些将 HTML 转换为 XHTML 的预处理，然后它会“正式”被视为 XML 并且可用于 XML 工具。如果您想走这条路，请参阅以下问题： [如何将 HTML 转换为 XHTML？](https://stackoverflow.com/questions/138555/how-to-convert-html-to-xhtml)

# java - 空 JPanel 相对于其他 JPanel 未正确定位

> ID：10079455
> 
> 赞同：2
> 
> 时间：2012-04-09T20:31:29.130
> 
> 标签：java, swing, jpanel

我正在使用 swing 使用 BorderLayout 管理器在一个 JPanel 内构建一个带有 4 个 JPanel 的 GUI：

1.  一排标签
2.  一列 JButton
3.  显示区域（它是一个扩展 JPanel 的类，没有添加任何内容，用作绘图区域）
4.  另一列按钮

我的代码如下所示：

```
 JPanel middle = new JPanel();
    middle.setLayout(new BorderLayout());
    middle.add(midLabels,BorderLayout.NORTH);
    middle.add(pickupButtons,BorderLayout.WEST);
    middle.add(simulation,BorderLayout.CENTER);
    middle.add(dropButtons,BorderLayout.EAST); 
```

模拟面板只是一个扩展的 JPanel，它覆盖了paintComponent 以绘制图像。问题是，模拟区域在左边而不是在中间：

![错误的布局](../Images/ae2c8183d32d3cc302ef6b9503f0a168.png)

我真正想要的是：

![在此处输入图像描述](../Images/0623a87769674d112f1a1e687a1df2fb.png)

编辑，这是一个例子，我是否需要使用不同的布局管理器来正确定位空 JPanel？：

```
import java.awt.*;
import javax.swing.*;
public class Test extends JFrame {  
    final static int MAXFLOORS = 8;
    public Test() {
        setLayout(new BorderLayout());
        setTitle("Simulator");
        setVisible(true);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setSize(500, 500);

        JPanel simulation = new JPanel();
        JPanel dropButtons = new JPanel();
        JPanel pickupButtons = new JPanel();

        pickupButtons.setLayout(new GridLayout(MAXFLOORS, 1));
        dropButtons.setLayout(new GridLayout(MAXFLOORS, 1));
        setLayout(new BorderLayout());      
        add(simulation,BorderLayout.CENTER);
        add(dropButtons,BorderLayout.EAST);
        add(pickupButtons,BorderLayout.WEST);

        for (int i = MAXFLOORS; i != 0; i--) {
            JButton pb = new JButton("F" + i);
            dropButtons.add(pb);

            JButton db = new JButton("F" + i);
            dropButtons.add(db);
        }       
        repaint();
    }
    public static void main(String[] args) {
        new Test();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:03:58.863

看看你的代码：

```
 for (int i = MAXFLOORS; i != 0; i--) {
        final JButton pb = new JButton("F" + i);
        dropButtons.add(pb);

        final JButton db = new JButton("F" + i);
        dropButtons.add(db);
    } 
```

您要添加`dropButtons`两次，而不是`pickupButtons`.

# jquery - 动态选择菜单的自动完成文本字段版本？

> ID：10079456
> 
> 赞同：0
> 
> 时间：2012-04-09T20:31:30.800
> 
> 标签：jquery, ruby-on-rails

我想结合以下 railscasts 的逻辑：

102 个自动完成关联 ( [https://gist.github.com/2347355](https://gist.github.com/2347355) ) 和 88 个动态选择菜单

例如，我们可以说选择了州，并根据输入的州，将城市列表填充到第二个自动完成字段中。重要的是，如果有人进入一个不存在的状态，它就会被该字段接受，并且没有城市填充到 city 字段中。

感谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:43:39.177

您可以使用 Ajax + 包含状态名称和相关数据的 XML 文件。

# actionscript - 你如何在actionscript中定义自定义对象？

> ID：10079466
> 
> 赞同：1
> 
> 时间：2012-04-09T20:32:11.853
> 
> 标签：actionscript, inline

我想定义一个伪强类型对象，但仍然可以内联定义它。

当前解决方案：

```
callMethod({param1:paramvalue,param2:paramvalue2}); 
```

我想使用类似的内联语法，但参数“对象”仅包含特定的参数列表。IE：只允许 param1 & param2 但不允许 param3。

我会很高兴这样的事情：

```
callMethod(mytype(param1:paramvalue,param2:paramvalue2); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:35:16.817

这就是你想要的：

```
callMethod( new MyType(paramvalue, paramvalue2) ); 
```

# php - PHP mysql同时没有分配与数据库键对应的变量

> ID：10079470
> 
> 赞同：1
> 
> 时间：2012-04-09T20:32:34.287
> 
> 标签：php, javascript, mysql, html

因此，直到一个小时前，这一直是完美的，从那时起，我绞尽脑汁修复它，却一无所获，也许我错过了明显的东西（通常是这种情况）。

该代码会打印出一个用户列表和一个在表格中禁止他们的按钮，但是问题是如果您单击禁止说.. 第 34 个用户它会禁止第一个用户，然后如果您单击第 56 个用户的禁止它会禁止第二个用户。如果您看到我的代码，您应该会发现情况并非如此（请注意，除了 uID 之外，所有其他细节都是完全正确的）：

```
 $query = mysql_query("SELECT id, full_name, banned, username from `tblUsers`");
        while($row = mysql_fetch_array($query)){
            $uID = $row['id'];
            if($row['banned'] == '0'){ 
                $banBool =  '<form id="ban" method="post" action="ban.php?uid='.$uID.'">
            <input type="hidden" name="ban" value="" /> 
            <a onclick="document.getElementById(\'ban\').submit();">Ban</a>
        </form>'; }else{   
            $banBool = '<form id="unban" method="post" action="unban.php?uid='.$uID.'">
            <input type="hidden" name="name" value="" /> 
            <a onclick="document.getElementById(\'unban\').submit();">UnBan</a>
            </form>' ;
        }
            if($row['banned'] == '1'){
                $status = 'Banned';
            }else{
                $status = 'Active';
            }
            echo "<tr><td>" . $row['username'] . " " . $uID . "</td><td>" . $banBool . "</td><td>" . $status . "</td><td>" . $row['full_name'] . "</td></tr>";
        } 
```

问题出在 action="unban.php?uid='.$uID.' 当我跟踪路径时，id 总是最小的数字（最高结果）

禁止.php

```
<?php
include '../../includes/dataBase.class.php';
sql::connect();
if(!sql::checkAdmin() == 1){
    header("Location: ../myaccount.php");
}
if(!isset($_GET['uid'])){
    header("Location: users.php?action=1");
}
$uid = $_GET['uid'];
$ip = $_SERVER['REMOTE_ADDR'];  
mysql_query("INSERT INTO `uipBan` (`ip`) VALUES ('$ip')")or die(mysql_error()); 
mysql_query("UPDATE tblUsers SET banned = '1' WHERE id = '$uid'")or die(mysql_error());
//header("Location: users.php?action=1");
echo $uid;
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:48:37.263

您为每个用户提供一个禁止/取消禁止该用户的表单。问题出在您的表格中`id`，因为它们不是唯一的。当您单击任何`Ban`/`UnBan`链接时，JavaScript 会搜索`ban`/`unban`元素，找到第一个并提交该元素。

解决方案非常简单：

```
 $query = mysql_query("SELECT id, full_name, banned, username from `tblUsers`");
        while($row = mysql_fetch_array($query)){
            $uID = $row['id'];
            if($row['banned'] == '0'){ 
                $banBool =  '<form id="ban' . $uID . '" method="post" action="ban.php?uid='.$uID.'">
            <input type="hidden" name="ban" value="" /> 
            <a onclick="document.getElementById(\'ban' . $uID . '\').submit();">Ban</a>
        </form>'; }else{   
            $banBool = '<form id="unban' . $uID . '" method="post" action="unban.php?uid='.$uID.'">
            <input type="hidden" name="unban" value="" /> 
            <a onclick="document.getElementById(\'unban' . $uID . '\').submit();">UnBan</a>
            </form>' ;
        }
            if($row['banned'] == '1'){
                $status = 'Banned';
            }else{
                $status = 'Active';
            }
            echo "<tr><td>" . $row['username'] . " " . $uID . "</td><td>" . $banBool . "</td><td>" . $status . "</td><td>" . $row['full_name'] . "</td></tr>";
        } 
```

我只是在每个表单和 JS 调用中都包含了用户 ID，以便它们是唯一的。（另外，您的第二个隐藏字段的名称为`name`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T06:50:08.227

是的，@MrFusion 成功了（+1）。但我仍然不明白你为什么不简单地做这样的事情：

```
 <?php
 $query = mysql_query("SELECT id, full_name, banned, username from `tblUsers`");

 while($row = mysql_fetch_array($query)) {

      echo "<tr><td>{$row['username']}</td><td>{$row['id']}</td>";

      if($row['banned'] == '0') { 
           echo "<td><a href=\"admin.php?ban={$row['id']}\">Ban</a></td>";
      }
      elseif($row['banned'] == '1') { 
            echo "<td>Banned (<a href=\"admin.php?unban={$row['id']}\">Unban</a>)</td>";
      }
      else { 
           echo "<td>Active</td>"; # Not sure what this is for in your original code
      }
      echo "<td>{$row['full_name']}</td></tr>";
}
?> 
```

然后只需制作 admin.php

```
<?php
include "../../includes/dataBase.class.php";
sql::connect();
if(!sql::checkAdmin() == 1){
    header("Location: ../myaccount.php");
}
if(!isset($_GET['ban']) AND !isset($_GET['unban'])){
    header("Location: users.php?action=1");
}

if(isset($_GET['ban'])) { 
    $uid = mysql_real_escape_string($_GET['ban']);
    mysql_query("UPDATE tblUsers SET banned = '1' WHERE id = '{$uid}'") or die(mysql_error());    
    //I don't know what the following two lines are for
    //but they seem to IP-ban the admin himself: you're banning the IP address 
    //of the user doing the ban, not the IP address of the user you are banning. 

    $ip = $_SERVER['REMOTE_ADDR'];  
    mysql_query("INSERT INTO `uipBan` (`ip`) VALUES ('{$ip}')") or die(mysql_error()); 
}
elseif(isset($_GET['unban'])) { 
    $uid = mysql_real_escape_string($_GET['unban']);
    mysql_query("UPDATE tblUsers SET banned = '0' WHERE id = '{$uid}'") or die(mysql_error());        
} 

header("Location: users.php?action=1");
?> 
```

请注意使用 mysql_real_escape_string 转义用户输入的重要性，即使它来自受信任的用户：这可以防止 SQL 注入，这可能导致您丢失整个数据库:)

# iphone - 从 google map AutoComplete API 获得超过 5 个结果

> ID：10079476
> 
> 赞同：0
> 
> 时间：2012-04-09T20:33:05.287
> 
> 标签：iphone, objective-c, google-maps

我正在使用这个 API 从谷歌地图 API 搜索位置。 [https://developers.google.com/maps/documentation/places/autocomplete](https://developers.google.com/maps/documentation/places/autocomplete)

当我搜索地点时，它只给出五个结果。你能告诉我获得超过五个结果的方法是什么，我的意思是完整的结果。如果您知道其他一些用于搜索多个位置的 API，请告诉我。谢谢

就像我正在使用以下路径进行搜索，但它只给出五个结果

[https://maps.googleapis.com/maps/api/place/autocomplete/xml?input=filadelfia&sensor=true&key=AIzaSyBPkN4zhGuTqm58_nHVKWWM9MZwYrz09FU](https://maps.googleapis.com/maps/api/place/autocomplete/xml?input=filadelfia&sensor=true&key=AIzaSyBPkN4zhGuTqm58_nHVKWWM9MZwYrz09FU)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:54:07.120

根据[https://developers.google.com/maps/documentation/places/autocomplete](https://developers.google.com/maps/documentation/places/autocomplete)：

> XML 响应由具有两种类型子元素的单个元素组成：
> 
> *   单个元素包含有关请求的元数据。请参阅下面的状态代码。
>     
>     
> *   零个元素，每个元素都包含有关单个地方的信息。有关这些结果的信息，请参阅放置自动完成结果。Places API 最多返回 5 个结果。

# substr - 避免在 .c_str 命令中使用临时字符串？

> ID：10079480
> 
> 赞同：1
> 
> 时间：2012-04-09T20:33:25.943
> 
> 标签：substr, c-str

我想知道在这种情况下是否有办法避免使用临时字符串：

```
tempString = inputString.substr(commaLast,commaCurrent-1);
yPos = strtod(tempString.c_str(), NULL); 
```

如果不先将子字符串存储在临时字符串中（假设我不想修改原始字符串），就无法使用 substr 命令并返回 c_str 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:36:32.237

您是否尝试过以下操作？

```
yPos = strtod(inputString.substr(commaLast,commaCurrent-1).c_str(), NULL); 
```

# java - Java中根据value获取ENUM描述

> ID：10079481
> 
> 赞同：0
> 
> 时间：2012-04-09T20:33:27.333
> 
> 标签：java, spring, jpa, enums

我是 ENUM 的新手，所以我想确保在对我的模型进行小手术之前完成所有这些工作。我的 ENUM 有一个较短的字符串，它存储在称为 的数据库中`name`，而`description`用户看到的是 a 。我的目标是获取内容对象的描述以显示在页面上。

当然

```
<td valign='top'><strong>Paperless:</strong> ${content.getPaperless()}</td> 
```

不会这样做，因为那只会显示`EDELIVERY_REQUIRED`。我需要如何调整它以使其正常运行？

我的编辑页面效果很好：

```
 <td valign='top'>
        <strong>Go Paperless Messaging</strong><br/>
        <form:select path="paperless">
            <form:options items="${paperlessEnumValues}" itemValue="name" itemLabel="description"/>
        </form:select>
    </td> 
```

**我的枚举：**

```
public enum Paperless {
    NONE(null, ""),
    EDELIVERY_RECOMMENDED("EDELIVERY_RECOMMENDED", "Recommend eDelivery"),
    EDELIVERY_REQUIRED("EDELIVERY_REQUIRED", "Require eDelivery"),
    EDELIVERY_REQUIRED_JUSTIFICATION("EDELIVERY_REQUIRED_JUSTIFICATION", "Require eDelivery w/out justification");

    private String name;
    private String description;
    Paperless(String name, String description) {
        this.name = name;
        this.description = description;
    }
    public String getName() {
        return this.name;
    }
    public String getDescription() {
        return this.description;
    }
} 
```

**我的模特**

```
public class Content implements Serializable {
...

    @Basic(optional = false)
    @NotNull
    @Size(min = 1, max = 255)
    @Column(name = "paperless")
    private String paperless;
...
    public String getPaperless() {
        return paperless;
    }

    public void setPaperless(String paperless) {
        this.paperless = paperless;
    } 
```

**我的内容服务**

```
private List<Content> findContentEntities(boolean all, int maxResults, int firstResult) {
    try {
        CriteriaQuery cq = em.getCriteriaBuilder().createQuery();
        cq.select(cq.from(Content.class));
        Query q = em.createQuery(cq);
        if (!all) {
            q.setMaxResults(maxResults);
            q.setFirstResult(firstResult);
        }
        return q.getResultList();
    } finally {
        em.close();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:40:49.593

1.  在您的实体中映射`private Paperless paperless`，而不是字符串。JPA 支持枚举映射
2.  采用`${content.paperless.description}`

# iphone - UIActivityIndi cator 没有动画

> ID：10079483
> 
> 赞同：2
> 
> 时间：2012-04-09T20:33:30.743
> 
> 标签：iphone, objective-c, ios, uiactivityindicatorview

我一直在用这个问题把头撞到墙上，需要一些帮助。我试图在后台加载数据时显示 UIActivityIndi​​cator。我不确定这是否相关，但我正在加载一个表格视图。指示器出现，但不旋转……除非我触摸屏幕，或者在加载时发生其他事情，比如我收到一条短信。这是代码：

```
UIActivityIndicatorView  *av = [[[UIActivityIndicatorView alloc]initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhite] autorelease];
av.frame=CGRectMake(145, 160, 25, 25);
av.tag  = 1;
[self.mTableView addSubview:av];
[av startAnimating];
[self performSelectorInBackground:@selector(load) withObject:nil]; 
```

我也试过这个：

```
UIActivityIndicatorView  *av = [[[UIActivityIndicatorView alloc]initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhite] autorelease];
av.frame=CGRectMake(145, 160, 25, 25);
av.tag  = 1;
[self.view addSubview:av];
[av startAnimating];
[self performSelectorInBackground:@selector(load) withObject:nil]; 
```

并尝试注释掉最后一行 - 所以**没有**运行后台线程。我已经在我的`viewDidLoad`和`viewDidAppear`方法中尝试了这两个版本的代码。

有任何想法吗？

**编辑**这是我的加载方法

```
- (void)load {

NSString *post = [NSString stringWithFormat:@"id[]=%@", [ids objectAtIndex:0]];

for(int i = 1; i < ids.count; i++){
    post = [NSString stringWithFormat:@"%@&id[]=%@", post, [ids objectAtIndex:i]];
}

NSURL *url=[NSURL URLWithString:@"http://myurl/instructions"];

NSData *postData = [post dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];

NSString *postLength = [NSString stringWithFormat:@"%d", [postData length]];

NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
[request setURL:url];
[request setHTTPMethod:@"POST"];
[request setValue:postLength forHTTPHeaderField:@"Content-Length"];
[request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
[request setHTTPBody:postData];

/* when we user https, we need to allow any HTTPS cerificates, so add the one line code,to tell teh NSURLRequest to accept any https certificate, i'm not sure about the security aspects
 */

//[NSURLRequest setAllowsAnyHTTPSCertificate:YES forHost:[url host]];

NSError *error;
NSURLResponse *response;
NSData *urlData=[NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];

NSString *data=[[NSString alloc]initWithData:urlData encoding:NSUTF8StringEncoding];

[self parseData:data];

[spinner stopAnimating];

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:45:44.593

您没有包含足够的代码来查看停止`UIActivityIndicator`动画的位置以及显示动画时发生的情况，但问题几乎可以肯定是以下问题之一：

1）您希望您的代码等待一些异步方法，这会导致您的活动指示器过早关闭，

或者

2）“后台”任务和“后台”任务`UIActivityIndicator`都在同一个线程上运行，并且您的“后台”任务将线程独占到活动指示器没有足够时间进行动画处理的地步。

这篇文章提供了一个如何将其推`UIActivityIndicator`送到自己的线程中的示例：

[活动指示器不旋转](https://stackoverflow.com/questions/4481467/activity-indicator-doesnt-spin)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T18:59:04.653

UI 需要时间加载，无法立即启动动画。通过在 viewDidLoad 方法中使用 NSTimer 启动它，问题就解决了。

```
timer = [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(spin) userInfo:nil repeats:NO];
[[NSRunLoop mainRunLoop] addTimer:self.timer forMode:UITrackingRunLoopMode]; 
```

和扫描方法：

```
spinner = [[[UIActivityIndicatorView alloc]initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhite] autorelease];
spinner.center = self.view.center;
spinner.hidesWhenStopped = YES;
[spinner startAnimating];
[self.view addSubview:spinner];
if ([spinner isAnimating]) NSLog(@"animating");
else NSLog(@"not animating");

[self performSelectorInBackground:@selector(load) withObject:nil]; 
```

希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T21:27:38.727

目前尚不清楚您在哪里添加活动指示器，但如果它不在主线程上，那么 UI 调用它可能不起作用。我通常会设置一个单独的例程来启动和停止我的活动监视器，这样我就可以`performSelectorInMainThread:`了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T22:20:53.023

与活动指示器无关，但您的加载方法会在循环中重写 post 变量。我认为您打算连接：

```
post = [post stringByAppendingFormat: ...] 
```

否则，您的 Web 服务将只看到最后一个参数。

此外，一旦你让你的微调器动画，你将遇到的下一个问题是它不会停止，因为 stopAnimating 正在被主线程调用。

# python-3.x - python3 github授权Oauth2不工作

> ID：10079491
> 
> 赞同：0
> 
> 时间：2012-04-09T20:34:09.390
> 
> 标签：python-3.x, oauth-2.0, urllib, github-api

我正在尝试在 Python3 中实现一个 oauth2 客户端，以便我可以将文件上传到 github。对于一个非常基本的开始，我正在尝试使用[API](http://developer.github.com/v3/oauth/)获取授权列表。

此代码有效：

```
from subprocess import Popen,PIPE
user = 'MYUSERNAME'
pw   = 'MYPASSWORD'
git_url = "https://api.github.com/authorizations"
res = Popen(['curl','--user',user + ':' + pw,git_url],stdout=PIPE,stderr=PIPE).communicate()[0]
print(res) 
```

此代码不起作用：

```
user = 'MYUSERNAME'
pw   = 'MYPASSWORD'
git_url = "https://api.github.com/authorizations"
import urllib.request
# Create an OpenerDirector with support for Basic HTTP Authentication...
auth_handler = urllib.request.HTTPBasicAuthHandler()
auth_handler.add_password(realm=None,
                          uri=git_url,
                          user=user,
                          passwd=pw)
opener = urllib.request.build_opener(auth_handler)
f = opener.open(git_url)
print(f.read()) 
```

事实上，它会产生这个错误：

```
Traceback (most recent call last):
  File "demo.py", line 18, in <module>
    f = opener.open("https://api.github.com/authorizations")
  File "/opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/urllib/request.py", line 375, in open
    response = meth(req, response)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/urllib/request.py", line 487, in http_response
    'http', request, response, code, msg, hdrs)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/urllib/request.py", line 413, in error
    return self._call_chain(*args)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/urllib/request.py", line 347, in _call_chain
    result = func(*args)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/urllib/request.py", line 495, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found 
```

我知道在 python 中有一个现有的 Oauth2 实现，但它是 python2，而不是 python3，它比我需要的要多得多。

我也知道我可以让我的 Python 程序调用`curl`，这是我的后备。

我真的很想知道我做错了什么。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:49:28.190

I have just [posted an answer to another question](https://stackoverflow.com/a/11621536/741316) with a full example using urllib2 from python2\. Obviously you are interested in python3, but it shouldn't be to difficult to migrate the code.

Hope that helps,

# python - 一次通过过滤和未过滤的元素

> ID：10079496
> 
> 赞同：5
> 
> 时间：2012-04-09T20:34:32.157
> 
> 标签：python, functional-programming

过滤器函数返回一个元素的子列表，这些元素对于给定的函数返回 true。是否可以在不同列表中获取返回 false 的元素列表，而无需再次遍历整个列表。

例子：

`trueList,falseList = someFunc(trueOrFalseFunc,list)`

PS：我知道这可以通过初始化两个空列表并根据函数的返回值向每个列表附加元素来完成。正在考虑的列表可能非常庞大，并且可能返回 true 的元素可能很少。由于附加功能成本很高，有没有更好的方法呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T21:04:07.567

试试这个，使用迭代器：

```
from itertools import tee

def partition(lst, pred):
    l1, l2 = tee((pred(e), e) for e in lst)
    return (x for cond, x in l1 if cond), (x for cond, x in l2 if not cond) 
```

像这样使用它，并记住返回的值是*迭代器*：

```
lst = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
evens, odds = partition(lst, lambda x: x%2 == 0) 
```

如果您出于某种原因需要列表，请执行以下操作：

```
list(evens)
> [0, 2, 4, 6, 8]
list(odds)
> [1, 3, 5, 7, 9] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T20:38:06.060

```
def someFunc(trueorfalsefunc, l):
    trueList = []
    falseList = []
    for item in l:
        if trueorfalsefunc(item):
            trueList.append(item)
        else:
            falseList.append(item)
    return trueList, falseList 
```

因此，例如：

```
>>> someFunc(bool, [1,2,0,"", "a"])
([1, 2, 'a'], [0, '']) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T20:41:23.647

如果你想选择一个单行，你可以这样做：（我正在从字典切换到列表作为 Niklas B. 建议提高可读性）

```
>>> some_list=[True, False, True, False, False]
>>> reduce(lambda (true,false),x: (true + [x], false) if x else (true, false + [x]), some_list, ([],[]))
([True, True], [False, False, False]) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T21:13:58.860

您可以使用生成器理解，这应该有助于提高性能并促进更简洁的代码。不过，我真的不确定这是否会满足您程序的其余部分。这取决于您如何使用这些返回的结果。

```
trueList = (elem for elem in list if trueOrFalseFunc(elem) )
falseList = (elem for elem in list if elem not in trueList ) 
```

# jquery-ui - jQuery-UI Autocomplete plugin AND Blackberry Autocompleter

> ID：10079497
> 
> 赞同：1
> 
> 时间：2012-04-09T20:34:35.023
> 
> 标签：jquery-ui, blackberry, jquery-mobile

I am using autocomplete jquery-ui plugin on jquery mobile framework. This setup is working great on all mobile devices but the Blackberry platform. The watermark is showing correctly so I know javascript is enabled and working however when a user starts typing it appears that Blackberry is over-riding and showing its own autocomplete/fill text options, when a user selects the jquery plugin is not firing.

On a desktop browser I can paste text and it works fine. It appears to be related to Blackberry mobile devices only.

Ideas on how to disable through code Blackberry autofill functionality?

thx

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:37:50.633

You can set the `autocomplete="off"` attribute on the input tag:

```
<input autocomplete="off" .../> 
```

*Source: [http://davidbcalhoun.com/2010/using-mobile-specific-html-css-javascript](http://davidbcalhoun.com/2010/using-mobile-specific-html-css-javascript)*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-07T16:38:01.393

你可以试试这个：

```
<input autocomplete="off" .../> 
```

但它不适用于（某些？）黑莓设备。他们忽略了属性。一种可能的解决方法/hack 是将输入类型设置为“电子邮件”，因为它们在 bb 上从来没有自动更正。

通过：[为移动设备禁用 HTML 中的拼写帮助](https://stackoverflow.com/questions/5380972/disable-spelling-assistance-in-html-for-mobile-devices)

# java - Is it good have a DatabaseManager with all of the functions from all the model objects?

> ID：10079501
> 
> 赞同：5
> 
> 时间：2012-04-09T20:34:58.547
> 
> 标签：java, android, database-design, ormlite

I'working on a db application with ORmlite, my model is like this:

MDL object..

```
DatabaseTable(tableName = "UserCars")
public class CarMDL
{
    @DatabaseField(generatedId = true)
    private int _id;

    @DatabaseField(columnName = "name")
    private String _name;

//................. etc
}

// DB Helper class...

public class DatabaseHelper extends OrmLiteSqliteOpenHelper
{
    private Dao<CarMDL,Integer> _carDao = null;

 @Override
    public void onCreate(SQLiteDatabase database,ConnectionSource connectionSource)
    {
        try 
        {
            TableUtils.createTable(connectionSource, CarMDL.class);

        } catch (SQLException e)
        {
            throw new RuntimeException(e);
        } catch (java.sql.SQLException e)
        {
            e.printStackTrace();
        }

    }

  public Dao<CarMDL, Integer> getCarDao() 
    {
        if (null == _carDao) 
        {
            try 
            {
                _carDao = getDao(CarMDL.class);

            }catch (java.sql.SQLException e) 
            {
                e.printStackTrace();
            }
        }
        return _carDao;
    }

}

// DatabaseManager class...

public class DatabaseManager
{
    static private DatabaseManager  instance;

    private DatabaseHelper  helper;

    static public void init(Context ctx)
    {
        if (null == instance)
        {
            instance = new DatabaseManager(ctx);
        }
    }

    static public DatabaseManager getInstance()
    {
        return instance;
    }

    private DatabaseManager(Context ctx)
    {
        helper = new DatabaseHelper(ctx);
    }

    private DatabaseHelper getHelper()
    {
        return helper;
    }

// All the Dao functions of all MDL objects are in this class, for example:

public List<CarMDL> getAllCars()
    {
        List<CarMDL> carLists = null;
        try
        {
            carLists = getHelper().getCarDao().queryForAll();
        } catch (SQLException e)
        {
            e.printStackTrace();
        }
        return carLists;
    }

// This is another MDL object..

public List<MarkMDL> getAllMarks()
    {
        List<MarkMDL> marks = null;
        try
        {
            marks = getHelper().getMarkDao().queryForAll();
        } catch (SQLException e)
        {
            e.printStackTrace();
        }
        return marks;       
    }

} 
```

So my question is, is it good have a DatabaseManager with all the functions from all the model objects, like:

```
listCarById(int id)
listPlaneById(int id)
removeCar(int id)
removePlane(int id) 
```

Etc.....

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:57:32.767

根据格雷的评论更新。

小心你的“单例”实现。您的`init`方法应该是`synchronized`确保您不会`DatabaseManager`由于并发问题而导致类的多个实例。我只是将`init`and`getInstance`方法与以下内容结合起来（注意添加的[同步](http://docs.oracle.com/javase/tutorial/essential/concurrency/locksync.html)关键字）：

```
public static synchronized DatabaseManager getInstance(Context c)
{
    if(instance == null)
        instance = new DatabaseManager(c);

    return instance;
} 
```

如需进一步阅读，请查看Kevin Galligan（ORMlite的[贡献者之一）关于](http://ormlite.com/javadoc/ormlite-core/doc-files/ormlite_8.html)[Single SQLite Connection](http://www.touchlab.co/blog/single-sqlite-connection/)和[Android Sqlite 锁定的这些博客文章。](http://www.touchlab.co/blog/android-sqlite-locking/)

**更新：**

要回答您有关如何组织加载方法之类的问题`getAllCars`，我首先建议制作它们`static`，因为它们不依赖于除您的方法之外的任何其他东西来获取您的单例`DatabaseManager`，当然，这也是`static`. 如果您有少量这些类型的方法，您可以将它们全部设为`DatabaseManger`. 如果你有很多，你可以为一个类型对应的所有静态方法创建一个帮助类。

如果你有一个方法**确实**依赖于给定的`CarMDL`or实例的内部结构`MarkMDL`（比如你需要一个方法来获取一些关联的引用），请考虑使这些方法成为`CarMDL`or`MarkMDL`类的成员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T01:31:11.040

我将所有一次性应用程序的工作都放在 Application onCreate 中，并保留应用程序实例本身的引用，因此我可以执行许多任务而不必弄乱同步方法或类似方法。所以假设我们有一个应用程序（记得在清单中添加它）：

```
public class App extends Application
{
    private static App gInstance = null;
    // your static globals here

    @Override
    public void onCreate()
    {
        // according to documentation onCreate is called before any other method
        super.onCreate();
        // assign here all your static stuff
        gInstance = this;
    }

    // doesn't need to be synchronized because of the early onCreate
    public static App getInstance()
    {
        return gInstance;
    }
} 
```

那么你的数据库助手类 Manifest.class 是一个包含所有数据类型类的数组：

```
public class DatabaseHelper extends OrmLiteSqliteOpenHelper
{
    // private constructor, singleton pattern, we use
    // App context so the class is created on static init
    private static DatabaseHelper gHelper = new DatabaseHelper(App.getInstance());

    private DatabaseHelper(Context context)
    {
        super(context, DATABASE_NAME, null, DATABASE_VERSION, R.raw.ormlite_config);

        // cache your dao here
        for (Class<?> cls: Manifest.classes)
        {
            try
            {
                DaoManager.createDao(getConnectionSource(), cls);
            } catch (SQLException e)
            {
                e.printStackTrace();
            }
        }
    }

    // if you need the instance, you don't need synchronized because of static init
    public static DatabaseHelper getHelper()
    {
        return gHelper;
    }

    // lookup from cache
    public static <D extends Dao<T, ?>, T> D getTypeDao(Class<T> cls)
    {
        return DaoManager.lookupDao(gHelper.getConnectionSource(), cls);
    }

    // we leak this class here since android doesn't provide Application onDestroy
    // it's not really a big deal if we need the orm mapping for all application lifetime
    // Q: should I keep the instance closeable? the android finalyzer calls somehow close here? I was unable to reproduce, to be sure you can call the super.close() and print a warning
    @Override
    public void close()
    {
        throw new RuntimeException("DatabaseHelper Singleton is ethernal");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-20T18:20:53.317

将上下文添加到您的 DatabaseManager 方法

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        DatabaseManager.init(this.getContext());
        if (getArguments() != null) {
            mParam1 = getArguments().getString(ARG_PARAM1);
            mParam2 = getArguments().getString(ARG_PARAM2);
        }
    } 
```

带有 ormlite 的示例 android 应用程序 [https://github.com/elberthcabrales/cfeMedicion](https://github.com/elberthcabrales/cfeMedicion)

# c - 为什么这个比较返回假？

> ID：10079503
> 
> 赞同：3
> 
> 时间：2012-04-09T20:35:04.370
> 
> 标签：c

在这个小程序中：

```
#include <unistd.h>
#include <stdint.h>
#include <stdio.h>

int main() {
    uint8_t a = 0;
    uint8_t b = 255;

    if (a == (b + 1)) {
        printf("Equal\n");
    } else {
        printf("Not equal\n");
    }

    if (a == ((b + 1) & 0xFF)) {
        printf("Equal\n");
    } else {
        printf("Not equal\n");
    }       
} 
```

我得到：

```
Not Equal
Equal 
```

除非我强行取最后 8 位，否则为什么比较不起作用？我猜我在这里遗漏了一些无符号算术的细微差别......

如果有区别，我正在使用 gcc 4.4.5。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T20:37:05.907

由于整数提升，`==`and`+`运算符的操作数都提升为`int`。

表达方式：

```
a == (b + 1) 
```

那么等价于：

```
0 == 256 
```

这是错误的。

表达式：`a == (uint8_t) (b + 1)`会给你你期望的结果（真）。另一种解决方案是在您的第二个语句中使用`& 0xFF`like ，`if`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:40:33.240

`1`是一个整数，所以表达式被提升为`int`. 使用这种类型，比较得到`0 == 256`. 在另一种情况下，您仅使用 8 位数字强制*and*，因此比较成立。

# android - libGDX: treat first color in palette as transparent color

> ID：10079504
> 
> 赞同：6
> 
> 时间：2012-04-09T20:35:09.440
> 
> 标签：android, transparent, libgdx, blending, color-palette

old game engines designate the first color of an image's palette as a transparent color. **is there a way to do the same with libGDX?**

i tried loading the picture and replacing the palete's first color with 0x00000000\. however since the pixels are either opaque or transparent i dont need alpha values so i could save a lot of memory by using RGB888 instead of RGBA8888. i lookes through the gdx and opengl documentary for other blending options and found Gdx.gl20.glBlendColor and the SpriteBatch's setBlendFunction function. but they only change the values used in the blending equations.

thanks in advance :)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T08:53:41.863

要透明地绘制纹理区域，请使用如下例程：

```
 Color c = batch.getColor();
    batch.setColor(1, 1, 1, alpha);
    batch.draw(....);
    batch.setColor(c); 
```

# python - python Popen：如何停止（杀死）使用 Popen 创建的子进程？

> ID：10079505
> 
> 赞同：1
> 
> 时间：2012-04-09T20:35:12.997
> 
> 标签：python, popen

在我得到结果后，我需要停止我在 python 中通过 Popen 发出的服务（在另一个线程的后台运行），但是以下方法失败了（只是`ping`为了解释而使用）：

```
class sample(threading.Thread):
  def __init__(self, command, queue):
    threading.Thread.__init__(self)
    self.command = command;
    self.queue = queue

  def run(self):
    result = Popen(self.command, shell=True, stdout=PIPE, stderr=STDOUT)    
    while True:
      output = result.stdout.readline()
      if not self.queue.empty():
        result.kill()
        break
      if output != "": 
        print output
      else:
        break

def main():
  q = Queue()
  command = sample("ping 127.0.0.1", q)
  command.start()
  time.sleep(10)
  q.put("stop!")
  command.join()

if __name__ == "__main__":
  main() 
```

运行上述程序后，当我 pgrep for 时`ping`，它仍然存在。如何杀死 Popen 打开的子进程？谢谢。

PS：我也试过result.terminate()，但也没有真正解决问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T21:06:06.727

您实际上并不需要从线程运行子进程。尝试在没有线程的情况下运行子进程。此外，您指定了 shell=True，因此它在 shell 中运行命令。因此有两个新进程，shell 和命令。您也可以通过设置 shell=False 来移除 shell。

# c++ - How can I avoid preemption of my thread in user mode

> ID：10079506
> 
> 赞同：5
> 
> 时间：2012-04-09T20:35:15.037
> 
> 标签：c++, linux, critical-section, interrupt, preemption

I have a simple chunk of deterministic work that only takes thirteen machine instructions to complete. Because the first instruction takes a homemade semaphore (spinlock) and the last instruction releases it, I am safe from all of the other threads running on the other cores as they are attempting to take and give the same semaphore.

The problem arises when some thread interrupts a thread holding the semaphore before it can finish its "critical section". Worst case the interruption kills the thread while holding the semaphore or as can happen one of the threads normally competing for the semaphore branches out into code that can generate the interrupt causing a deadlock.

I don't have a way synchronizing with these other threads when they branch into those parts of the code I can't control. I think I need to disable interrupts like I used to do in my old VxWorks days when I was running in kernel mode. Its always thirteen instructions and I am always completely safe if I can get all thirteen instructions done before I have to honor an interrupt. Oh and it is all my own internal data, other that the homemade semaphore there is nothing that locks anything else up.

I have read several answers that I think are close. Most have to do with Critical Section calls on the Windows API (wrong OS but maybe the right concept). Most of the wrong solutions assume that I can get all of the offending threads to use a mutex that I create with the pthread libraries.

I need this solution in C/C++ on Linux and Solaris.

Johnny Crash's question is very close [prevent linux thread from being interrupted by scheduler](https://stackoverflow.com/q/2595735/1322623)

KermitG also [Can I prevent a Linux user space pthread yielding in critical code?](https://stackoverflow.com/q/2865047/1322623)

Thanks for your consideration.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T21:18:55.157

您可能无法阻止用户模式线程的抢占。关键部分（和所有其他同步对象）可以防止线程冲突，但是它们绝不会阻止它们被操作系统抢占。

如果你的其他线程在超时时分支到*某个东西*，而那个*东西*可能会导致死锁——你有一个设计问题。

一个正确的设计应该是最悲观的：抢占可能无处不在，时间不确定。

# c - C 语言，多客户端服务器，错误：非套接字上的套接字操作

> ID：10079508
> 
> 赞同：0
> 
> 时间：2012-04-09T20:35:22.780
> 
> 标签：c

我的任务是编写一个接受多个客户端的服务器程序。我正在用 C 语言编写并尝试使用 select() 语句来完成此操作。我能够编译，但每当我远程登录时，我都会收到“非套接字错误的套接字操作”。我试过研究这个错误，但找不到任何有用的东西。任何援助将不胜感激。

我的服务器的输出是：

```
$ ./assign2 33333
Waiting for connection...
fd is 0
EchoServ recv error: Socket operation on non-socket
fd is 1
EchoServ recv error: Socket operation on non-socket
EchoServ recv error: Socket operation on non-socket 
```

telnet 的输出是：

```
$ telnet localhost 33333
Trying 127.0.0.1...
Connected to localhost.localdomain (127.0.0.1).
Escape character is '^]'.
Welcome to EchoServ chat. 
```

我的服务器代码：

```
#include <stdio.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <netdb.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>

#define PORT    50000

main( int argc, char *argv[] )
{
    char                buf[ BUFSIZ ],  /* buffer for incoming data */
                        *endptr,  /*  for strtol()  */
                        *message = "Welcome to EchoServ chat. \r\n"; /* welcome message */
    int                 masterSocket, /* main listening socket for server */
                        newSocket,  /* new sockets for connecting clients */
                        opt = 1,  /* for port reuse code */
                        nBytes,  /* # of incoming bytes */
                        addrlen;
    int                 i,j;  /* temp vars */
    short int           port;  /* port number */
    fd_set              master;  /* master file descriptor list */
    fd_set              temp_fds;  /* temp file descriptor list for select() */
    int                 fdmax;  /* maximum file descriptor number */
    struct sockaddr_in  sin;

    /*  Get port number from the command line, or
        set to default port if no arguments were supplied  */
    if ( argc == 2 ) {
        port = strtol(argv[1], &endptr, 0);
        if ( *endptr ) {
            fprintf(stderr, "EchoServ: Invalid port number.\n");
            exit(EXIT_FAILURE);
        }
    }
    else {
        port = PORT;
    }

    FD_ZERO(&master);    /* clear the master and temp sets */
    FD_ZERO(&temp_fds);

    /* Get an internet domain socket */
    if ( ( masterSocket = socket( AF_INET, SOCK_STREAM, 0) ) == -1 ) {
        perror( "EchoServ socket error" );
        exit( 1 );
    }

    /* Complete the socket structure */
    memset( &sin, 0, sizeof(sin) );
    sin.sin_family = AF_INET;
    sin.sin_addr.s_addr = INADDR_ANY;
    sin.sin_port = htons(port);

    /* Bind the socket to the port number */
    if ( bind( masterSocket, ( struct sockaddr *) &sin, sizeof( sin ) ) == -1) {
        perror( "EchoServ bind failed" );
        exit( 1 );
    }

    /* Allow port reuse */
    if ( setsockopt( masterSocket, SOL_SOCKET, SO_REUSEADDR, &opt, sizeof( opt ) ) == -1 ) { 
        perror( "EchoServ setsockopt error" );
        exit(1);
    } 

    /* Listen for clients that want to connect.         */
    if ( listen( masterSocket, 5 ) == -1 ) {
        perror( "EchoServ listen error" );
        exit( 1 );
    }

    /* add masterSocket to the master set */
    FD_SET(masterSocket, &master);

    /* track largest file descriptor, starting with masterSocket */
    fdmax = masterSocket;

    /* Wait for a client connection, then accept it. */

    puts ( "Waiting for connection..." );
    while(1){
        temp_fds = master;  /* copy master set to temp set */
        //addrlen = sizeof(sin); 
        /* wait for activity on a socket */
        if (select(fdmax+1, &temp_fds, NULL, NULL, NULL) == -1) {
            perror("EchoServ select error");
            exit(1);
        }

        for ( i = 0; i <= fdmax; i++ ){
            printf("fd is %d\n", i);  /*debug*/
            if ( FD_ISSET( i, &temp_fds ) ){  /* true if file descriptor is in set */

                /* accept new connection */               
                if ( i == masterSocket ){
                    addrlen = sizeof( sin );  
                    if ( (newSocket = accept( masterSocket, ( struct sockaddr *) &sin, &addrlen )) == -1 )
                        perror("EchoServ:  accept error");
                    else {
                        printf("New connection accepted\n"); /*debug*/
                        FD_SET( newSocket, &master ); /* add new connection to master set */
                        if ( newSocket > fdmax )  /* update max descriptor */
                            fdmax = newSocket;
                        //print details of new connection
                        printf("New connection on %s:%d, socket fd is %d \n", 
                        inet_ntoa(sin.sin_addr), ntohs(sin.sin_port), newSocket );

                        //send new connection greeting message
                        if( send( newSocket, message, strlen( message ), 0) == -1 )
                        {
                             perror("EchoServ welcome message error");
                        }
                        puts("Welcome message sent successfully");
                    }
                }
            }

            /* handle incoming data */
            else{
                if ( ( nBytes = recv( i, buf, sizeof( buf ), 0 ) ) <= 0 ){ /* error or closed connection */
                    if ( nBytes == 0 )  /* connection closed */
                        printf( "EchoServ: socket %d closed by client\n", i );
                    else /* recv error */
                        perror("EchoServ recv error");
                    close( i );  /* close socket */
                    FD_CLR( i, &master );  /* remove from master set */
                }
                else { /* got some data */ 
                    for( j = 0; j <= fdmax; j++ ){
                        if ( FD_ISSET( j, &master ) ){  /* send data to all sockets */
                            if( j != i && j != masterSocket ){  /* except self and masterSocket */
                                if ( send( j, buf, nBytes, 0) == -1)
                                    perror("EchoServ send error");
                            }  
                        }
                    }
                }
            }
        }
    }

    return( 0 );
} 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:47:38.210

因此，您**在 else 分支**`if (FD_ISSET(i, &temp_fds))`上进行测试并尝试在. 所以基本上你只是想接收如果无效或会阻塞。**`recv``i``i`**

 **这当然源于对块和大括号的无限使用。您可能意味着 else 与`if (i == masterSocket)`.**

# wcf - Silverlight：企业级推送通知

> ID：10079516
> 
> 赞同：4
> 
> 时间：2012-04-09T20:36:10.690
> 
> 标签：wcf, silverlight, notifications, scalability

我们正在金融领域构建基于 Silverlight 的系统。我们需要将通知/流数据从服务器推送到 Silverlight 客户端。我们在客户端使用 Silverlight 4，在服务器端使用 Windows Server 2003/IIS6（这不包括 AppFabric）。

到目前为止，我还没有找到一个安全且可扩展的与 Silverlight 兼容的数据推送解决方案。开箱即用的套接字似乎不支持 SSL，并且 PollingDuplexHttpBinding 似乎无法针对网络场实现/故障转移进行扩展。看起来 IIS 也不是长轮询应用程序的最佳平台。

是否有人为 Silverlight 成功实施了企业级通知推送解决方案，您使用了哪些技术/产品？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:55:20.150

Comet 服务器的可扩展性非常好，许多金融系统都在使用它们。

[marketplus.com.au/evolve](http://www.marketsplus.com.au/evolve)的一个例子，他们使用 Comet 服务器将价格信息推送到他们的 Silverlight 客户端。

Comet 的一些实现是[meteorserver.org](http://www.meteorserver.org)、[pokein.com](http://www.pokein.com)或[frozenmountain.com/websync](http://www.frozenmountain.com/websync)。

# php - 将 GET 变量传递给 PHP 以实例化类和调用函数

> ID：10079518
> 
> 赞同：0
> 
> 时间：2012-04-09T20:36:23.207
> 
> 标签：php, html, function, variables, get

我成功地实例化了对象类，但我不知道如何调用函数。这是我的PHP代码：

```
$obj = new router();
class router{

public function __construct(){
    if($_SERVER['REQUEST_METHOD'] == 'GET'){
        echo "GET";
        $page = 'index';
        $funct = 'myfuncempty';

        if (!empty ($_GET)){
            $page = $_GET['page'];
            $funct = $_GET['func'];
        }
        $obj = new $page(); //instantiating object with get from class
        $obj->funct;
    }
    else{
        echo "POST";
    }

}

}
class index{

public function __construct(){
    echo "hello I'm index";
}
public function myfunc(){
    echo "yo";
}

public function myfuncempty(){
    echo "empty get";
}
}

class login{
public function __construct(){
    echo "hello I'm login";
}

public function loggedin(){
    echo "you're logged in";
}

public function loggedinempty(){
    echo "its empty";
}
} 
```

这是我用来通过 GET 传递变量的 HTML 表单：

```
<html>
<head></head>
<body>
<form action="index.php" method="POST"><input type ="text" name="page" id="page" /><input type="submit" /></form>
<form action="index.php" method="GET">Page:<input type="text" name="page" id="page" />Function:<input type="text" name="func" id="func" /><input type= "submit" />
</body>
</html> 
```

当我在页面中键入 index 并在函数中键入 myfunc 时，我得到以下响应：

```
GEThello I'm login Notice: Undefined property: login::$funct in /home/cr47/public_html/final_project/index.php on line 27 
```

因此，它正确传递了“页面”并实例化了对象，但没有正确调用 myfunc 函数。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:39:46.267

替换`$obj->funct;`为`$obj->$funct();`

但**要小心**。您不应该让您的用户实例化任意类。至少使用白名单或要求它们是某些自定义类的子类，这些自定义类仅由您的安全类使用（即没有公共方法可以做任何用户不应该做的事情）。

# vim - Vim loading multiple syntax files instead of just one

> ID：10079521
> 
> 赞同：1
> 
> 时间：2012-04-09T20:36:39.430
> 
> 标签：vim

I have put new javascript syntax and indent files in my 'bundle' directory (I use Pathogen). I noticed that VIM loads both my new files as well as the standard files, in particular it loads the standard files after and I fear it may be overwriting the custom ones.

The VIM docs says it should not load the standard files if it found custom one first so I am not sure why this is happening.

This is what I see with the :scriptnames command, you can see the standard files (line 32, 35) after the customer ones (line 31, 34)

```
31: /usr/share/vim/vimfiles/bundle/vim-javascript/syntax/javascript.vim                                                                                                                                            
32: /usr/share/vim/vim73/syntax/javascript.vim                                                                                                                                                                     
33: /usr/share/vim/vim73/ftplugin/javascript.vim                                                                                                                                                                   
34: /usr/share/vim/vimfiles/bundle/vim-javascript/indent/javascript.vim                                                                                                                                            
35: /usr/share/vim/vim73/indent/javascript.vim 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T15:11:47.807

系统默认和您的自定义语法文件都出现在`:scriptnames`输出中很好。Vim 将 source 中找到的所有文件`'runtimepath'`，但规范的包含保护

```
if exists("b:current_syntax") 
```

将导致在第一个之后运行的所有脚本在检查后立即中止。

# css - 如何跨浏览以下 css3 moz 片段？

> ID：10079534
> 
> 赞同：1
> 
> 时间：2012-04-09T20:37:40.990
> 
> 标签：css, webkit

我是 css3 的新手，如果有人能给我以下各种浏览器版本，我将不胜感激：

`background:-moz-linear-gradient(center top , #FDFAFB, #F9F7F7 50%,#F0EDED) repeat scroll 0 0 transparent`

虽然可以通过将“moz”更改为“webkit”等来调整其他 css 方法，但各种浏览器似乎对线性背景有非常不同的规则......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:40:16.937

我相信[这个](http://www.colorzilla.com/gradient-editor/)网站会帮助生成一个，然后会给你所有知名浏览器组合的代码。

看一看。

# math - fractional binary subtraction

> ID：10079542
> 
> 赞同：0
> 
> 时间：2012-04-09T20:38:23.153
> 
> 标签：math, binary, floating-point, floating-point-precision, binary-operators

I am having difficulty understanding why the following binary subtraction gives the result that it does. I keep getting a different answer. I am trying to compute 0.1-x such that x is 0.00011001100110011001100\. The answer should be 0.000000000000000000000001100[1100]...(1100 keeps repeating) When i do it, I keep getting 1100 in the very beginning.

What am I not doing correctly?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-29T11:29:29.423

我认为您的预期答案是错误的。这是我的解决方案。我会将这些位分组为 nybbles，以便它看起来可读。

```
 0.1000 0000 0000 0000 0000 0000 <- added zero to the rightmost to fill in the nybble
- 0.0001 1001 1001 1001 1001 1000 <- added zero to the rightmost to fill in the nybble
_________________________________ 
```

得到 的 2 的补码`0.0001 1001 1001 1001 1001 1000`。

```
 1.1110 0110 0110 0110 0110 0111 (1's complement)
+ 0.0000 0000 0000 0000 0000 0001
_________________________________
  1.1110 0110 0110 0110 0110 1000 (2's complement) 
```

将 2 的补码添加到`0.1`.

```
 0.1000 0000 0000 0000 0000 0000
+ 1.1110 0110 0110 0110 0110 1000
_________________________________
 10.0110 0110 0110 0110 0110 1000 
```

由于溢出是`1`，请忽略它。它只是表示最终答案是一个正数，因为`0.1`它大于`0.0001 1001 1001 1001 1001 1000`。因此，最终的答案是`0.011001100110011001101000`。

# javascript - 谷歌地图V3用鼠标右键拖动地图？

> ID：10079543
> 
> 赞同：4
> 
> 时间：2012-04-09T20:38:27.433
> 
> 标签：javascript, google-maps

在法线贴图中，如果您主要在任意位置左键单击并拖动，则贴图会平移。

我的问题是：你可以交换左右按钮来平移地图吗？也就是说，左键单击和拖动什么都不做，而平移是通过右键单击和拖动发生的？

也许有一个与谷歌地图无关的 JavaScript 黑客来完成这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T07:28:56.173

大多数其他站点通过使用不同的地图使用模式来解决这个问题。例如，当您单击“绘图”按钮时，您会进入“绘图模式”，这只会禁用某些 Google 地图功能（如拖动）并启用绘图功能。

这是我能想到的唯一可行的方法。使用鼠标右键绘制感觉不对，恐怕大多数用户都会同意。

# javascript - Function vs. Object Literal Notaion - 有区别吗？

> ID：10079544
> 
> 赞同：2
> 
> 时间：2012-04-09T20:38:28.040
> 
> 标签：javascript

这两种方式都使用相同的调用机制。

显然，我想使用最好的方式，但也许这只是一个偏好问题？

风格方面，我喜欢 Object Literal Notation，因为它提供了外壳。

**功能符号：**

```
var TextProcessor = function()
{
};
TextProcessor.unEscape = function( second_split )
{
    var element;
    for( element in second_split )
    {
        second_split[element] = second_split[element].replace( '**', '*', 'g' );
        second_split[element] = second_split[element].replace( '|*', '|', 'g' );
    }
    return second_split;
};
TextProcessor.pullBullet = function( text )
{
    var pattern = /<(.+)_([a-z]){1}>$/;
    return pattern.exec( text );
};
TextProcessor.pullDomain = function( text )
{
    return text.match( /:\/\/(www\.)?(.[^\/:]+)/ )[2];
}; 
```

**对象文字符号**

```
/**
 *TextProcessor
 */

var TextProcessor = 
{
    unEscape:    function( text )
    {
        var index;
        for( index in second_split )
        {
            text[index] = text[index].replace( '**', '*', 'g' );
            text[index] = text[index].replace( '|*', '|', 'g' );
        }
        return second_split;
    },
    pullBullet:  function( text )
    {
        var pattern = /<(.+)_([a-z]){1}>$/;
        return pattern.exec( text );
    },
    pullDomain:  function( text )
    {
        return text.match( /:\/\/(www\.)?(.[^\/:]+)/ )[2];
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T20:42:21.210

你正在做两件有些不同的事情。

*   第一个示例创建一个函数对象并为其分配属性。

*   第二个示例创建一个具有这些属性的普通对象。

在您的示例中，第一个确实没有多大实际意义。您可以使用函数对象来分配属性，但您为什么要这样做呢？这些属性对函数的调用没有影响。

* * *

> *“就风格而言，我喜欢 Object Literal Notation，因为它提供了封闭性。”*

我不知道什么是*“外壳”*。这听起来像是封装和闭包的组合，而对象字面量两者都没有。

* * *

回到第一部分，想象一下如果你创建了这些对象中的任何一个......

```
var TextProcessor = new Number();
var TextProcessor = new Boolean();
var TextProcessor = new Date(); 
```

...然后将属性分配给它。它会起作用，但它会是一件奇怪的事情。对象是`Number`、`Boolean`或`Date`与手头的任务几乎没有相关性的事实。

当您将属性分配给`Function`对象时，这实际上就是您正在做的事情。

# c++ - 将两个 time_t 之间的差异转换为具有适当 tm_mday 的 tm

> ID：10079545
> 
> 赞同：0
> 
> 时间：2012-04-09T20:38:29.290
> 
> 标签：c++, date, time

根据输入数据的数量，我有一个可以在几秒或几天内运行的程序。在我的程序结束时，我想打印经过的“时钟墙”时间：如果小于一分钟，则以秒为单位，如果小于一小时，则以分钟和秒为单位，如果是，则以小时-分钟-秒为单位少于 1 天，否则以天-时-分-秒为单位。这是我正在使用的代码：

```
#include <cstdio>
#include <ctime>
#include <unistd.h> // for sleep

int main (int argc, char ** argv)
{
  time_t startRawTime, endRawTime;

  time (&startRawTime);
  printf ("%s", ctime (&startRawTime));

  sleep (3); // any preprocessing of input data

  time (&endRawTime);
  printf ("%s", ctime (&endRawTime));

  printf ("%.0fs\n", difftime (endRawTime, startRawTime));

  time_t elapsed = static_cast<time_t>(difftime (endRawTime, startRawTime));
  struct tm * ptm = gmtime (&elapsed);
  printf ("%id %ih %im %is\n", ptm->tm_mday, ptm->tm_hour, ptm->tm_min, ptm->tm_sec);

  return 0;
} 
```

这是它打印的内容：

```
Mon Apr  9 14:43:16 2012
Mon Apr  9 14:43:19 2012
3s
1d 0h 0m 3s 
```

当然最后一行是错误的（应该是“0d”）。似乎可以通过打印轻松解决`ptm->tm_mday - 1`。但是，`ptm->tm_mday`当两个日期之间确实经过了一天时，也将是“1”。所以在那种情况下，我不想让它显示为“0d”。

那么有没有办法正确处理这个问题？或者我应该得到`difftime`双倍的结果（即秒数），然后计算自己的秒/分钟/小时/天数？

备注：我的代码仅在 Linux 上使用，使用`gcc -lstdc++`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:51:40.940

一个`time_t`值代表一个特定的时刻。结果`difftime`是两个时刻之间的间隔，以秒为单位。那是非常不同的事情。

在您的代码中，`difftime()`返回`3.0`，因为两个指定时间之间有 3 秒。将其转换`time_t`为 epoch 后 3 秒的时间；在大多数系统上，这将是 1970 年 1 月 1 日格林威治标准时间午夜后 3 秒。该`tm_mday`值为 1，因为那是该月的第一天。

您可以通过从`tm_mday`值中减去 1 来完成这项工作，因为`tm_mday`它是基于 1 而不是基于 0。但是对于更长的时间间隔，您仍然会得到毫无意义的结果。例如，间隔 31.5 天会给你 2 月 1 日中午，因为 1 月有 31 天；这与您尝试获取的信息无关。

只需将结果`difftime()`视为 a `double`（因为它就是这样）并通过简单的算术计算天数、小时数、分钟数和秒数。

（由于一些可移植性的损失，您可以直接减去这些`time_t`值而不是使用`difftime()`。这将使一些算术更容易一些，但它会在`time_t`值不是自某个时期以来的整数秒计数的系统上中断. `difftime()`存在是有原因的。）

> 当然最后一行是错误的（应该是“0d”）。似乎可以通过打印“ptm->tm_mday - 1”轻松解决。但是，当两个日期之间确实经过了一天时，ptm->tm_mday 也将为“1”。所以在那种情况下，我不想让它显示为“0d”。

这是不正确的；如果时间间隔刚刚超过 1 天，`ptm->tm_mday`则为`2`. 您可以通过对代码稍作修改来验证这一点：

```
time (&endRawTime);
endRawTime += 86400; // add this line
printf ("%s", ctime (&endRawTime)); 
```

当我进行此更改时，我得到以下输出：

```
Mon Apr  9 13:56:49 2012
Tue Apr 10 13:56:52 2012
86403s
2d 0h 0m 3s 
```

可以通过从 中减去 1 来纠正`ptm->tm_mday`。但同样，这不是正确的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T21:26:03.567

这是一个使用该`<chrono>`库的示例，这是一个类型安全的时序库，可以防止您犯您所犯的错误。在 chrono 中，time_points 和 durations 不可互换，如果您尝试以这种方式使用它们，则会出现编译器错误。

```
#include <chrono>
#include <iostream>
#include <thread>
#include <cassert>

template<typename Rep,typename Period>
void print_duration(std::chrono::duration<Rep,Period> t) {
    assert(0<=t.count() && "t must be >= 0");

    // approximate because a day doesn't have a fixed length
    typedef std::chrono::duration<int,std::ratio<60*60*24>> days;

    auto d = std::chrono::duration_cast<days>(t);
    auto h = std::chrono::duration_cast<std::chrono::hours>(t - d);
    auto m = std::chrono::duration_cast<std::chrono::minutes>(t - d - h);
    auto s = std::chrono::duration_cast<std::chrono::seconds>(t - d - h - m);
    if(t>=days(1))
        std::cout << d.count() << "d ";
    if(t>=std::chrono::hours(1))
        std::cout << h.count() << "h ";
    if(t>=std::chrono::minutes(1))
        std::cout << m.count() << "m ";
    std::cout << s.count() << "s";
}

int main() {
    auto start = std::chrono::steady_clock::now();
    std::this_thread::sleep_for(std::chrono::seconds(3));
    auto finish = std::chrono::steady_clock::now();

    print_duration(finish-start);
    std::cout << '\n';
} 
```

* * *

### GCC 注释

旧版本的 GCC 有 monotonic_clock 而不是 stable_clock。4.7 有 stable_clock。

为了访问 std::this_thread::sleep_for ，您可能出于某种原因必须定义 _GLIBCXX_USE_NANOSLEEP 。

# c# - 正确地从 jquery 调用操作？

> ID：10079546
> 
> 赞同：0
> 
> 时间：2012-04-09T20:38:36.543
> 
> 标签：c#, asp.net-mvc, jquery

我从来没有使用过ajax，我只是想看看这是否会从我的控制器调用该方法并给我想要的结果。VS 中的 javascript 调试器目前似乎无法正常工作。这看起来对吗？

```
 $("form").submit(function() {
            var hasCurrentJob = $.ajax({
                url: 'Application/HasJobInProgess/@Model.ClientId'
            });
  }); 
```

控制器方法

```
public Boolean HasJobInProgress(int clientId)
{
    return _proxy.GetJobInProgress(clientId).Equals(0);
} 
```

***更新***

```
$("#saveButton").click(function() {
        var hasCurrentJob = false;
        $.ajax({
            url: '@Url.Action("HasJobInProgress","ClientChoices")/',
            data: { id: @Model.ClientId },
            success: function(data){
                hasCurrentJob = data;
            }
            });
        if (hasCurrentJob) {
            alert("The current clients has a job in progress. No changes can be saved until current job completes");
        } 
    }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T20:48:32.177

`Url.Action`在调用操作方法时尝试使用HTML Helper 方法。这将为您提供操作方法的正确 URL。您无需担心要添加多少 ..//

```
$(function(){
   $("form").submit(function() {
     $.ajax({
        url: '@Url.Action("HasJobInProgess","Application")',
        data: {clientId: '@Model.ClientId'},
       success: function(data) {
        //you have your result from action method here in data variable. do whatever you want with that.
        alert(data);
       }
     });
   });
}); 
```

# drupal-7 - Drupal allowed_values_function does not get called when creating a field

> ID：10079549
> 
> 赞同：0
> 
> 时间：2012-04-09T20:38:46.930
> 
> 标签：drupal-7, drupal-field-api

For some reason my allowed_values_function never gets called when showing a field on a user bundle. Code:

```
function get_business_units()
{
    $options = entity_load('business_unit', FALSE, NULL, FALSE);
    $opt = bu_to_list_values($options);
    return $opt;
}

function MYMODULE_enable()
{
    if (!field_info_field('field_user_business_unit')) {
        $field = array(
            'field_name' => 'field_user_business_unit', 
            'type' => 'text', 
            'settings' => array(
                'allowed_values' => array(),
                'allowed_values_function' => 'get_business_units',
            )
        );
        field_create_field($field);

        // Create the instance on the bundle.
        $instance = array(
            'field_name' => 'field_user_business_unit', 
            'entity_type' => 'user', 
            'label' => 'Business Unit', 
            'bundle' => 'user', 
            'required' => FALSE,
            'settings' => array(
                'user_register_form' => 1,
        ),
            'widget' => array(
                'type' => 'options_select',
        ),
        );
        field_create_instance($instance);
    }
} 
```

The field is created, and even displayed on the users "edit" page when editing their info. But the only value is "Select" or "None". My method is never called (I even placed a debug point). This is all in MYMODULE.install file.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-21T11:30:39.640

问题是：`'type' => 'text'`。

你必须使用：`'type' => 'list_text'`。

允许的值对于文本类型没有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T00:20:30.637

您的`get_business_units()`函数需要在`MYMODULE.module`文件中；这些`.install`文件不包含在正常的 Drupal 引导程序中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:21:52.527

您是否尝试过 drush features-revert MYMODULE ？

# c - Mutex 和 Cache sqlite3_open_v2 标志是什么意思？

> ID：10079552
> 
> 赞同：-1
> 
> 时间：2012-04-09T20:38:54.907
> 
> 标签：c, database, sqlite, mutex

编辑：如果我可以浏览文件，我会很危险。 [http://www.sqlite.org/sharedcache.html](http://www.sqlite.org/sharedcache.html)

原来的：

sqlite3_open_v2 函数带有签名：

```
int sqlite3_open_v2(
  const char *filename,   /* Database filename (UTF-8) */
  sqlite3 **ppDb,         /* OUT: SQLite db handle */
  int flags,              /* Flags */
  const char *zVfs        /* Name of VFS module to use */
); 
```

第三个参数`int flags`支持许多选项，其中一些是不言自明的：

```
#define SQLITE_OPEN_READONLY         0x00000001  /* Ok for sqlite3_open_v2() */
#define SQLITE_OPEN_READWRITE        0x00000002  /* Ok for sqlite3_open_v2() */
#define SQLITE_OPEN_CREATE           0x00000004  /* Ok for sqlite3_open_v2() */
/* snip */
#define SQLITE_OPEN_NOMUTEX          0x00008000  /* Ok for sqlite3_open_v2() */
#define SQLITE_OPEN_FULLMUTEX        0x00010000  /* Ok for sqlite3_open_v2() */
#define SQLITE_OPEN_SHAREDCACHE      0x00020000  /* Ok for sqlite3_open_v2() */
#define SQLITE_OPEN_PRIVATECACHE     0x00040000  /* Ok for sqlite3_open_v2() */ 
```

我的数据库使用（还）没有任何问题，但我想知道 NOMUTEX 与 FULLMUTEX 和 SHAREDCACHE 与 PRIVATECACHE 选项的含义。我发现的 sqlite.org 页面上的描述，例如 SQLITE_OPEN_NOMUTEX，并不是很有帮助。

> 如果设置了 SQLITE_OPEN_NOMUTEX 标志，那么只要在编译时或启动时没有设置单线程模式，数据库连接就会以多线程模式打开。

如果根据文档已经防止同时读取/写入，互斥标志会做什么？
此外，缓存中有什么，如果我决定共享它，我与谁共享，这对他们的读/写有何影响？
它是否仅在 close() 上刷新？

任何见解都值得赞赏，即使是指向更好描述的链接也会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2021-01-06T17:25:12.337

简而言之，解释起来很麻烦，如果你运行单线程，你不必关心下面的内容：

这是 SQLIte 中最复杂的部分。如果是第 1 版，我什至会称其为“构思不当”，但由于它是具有一些向后兼容性的渐进式进化，我理解开发人员遵循的路径和思维定势。与您阅读官方文档的感觉相反：并非所有组合都有效！！！

此外，虽然模式的决定可以推迟到调用 sqlite3_open_v2(,,,) ，但最好一劳永逸地选择它。好处是您可以决定多个策略，只要每个策略都在不同的数据库文件上。

那说：

SQLITE_OPEN_NOMUTEX 确实编译（或在 sqlite3_open_v2 上激活），使用没有内部互斥锁的 SQLite。仍然可以安全地使用 SQLite 多线程，但根据我的经验，只有在每个线程中打开单独的连接时才能安全地工作。不要尝试使用此模式在 Thread 之间共享连接。

SQLITE_OPEN_FULLMUTEX SQLite 在运行时会创建适当的互斥锁来锁定一些原子操作。我在线程之间共享连接时使用它。（事实上​​我总是使用 FULLMUTEX）如果你想查看在 sqlite3.c 中搜索 sqlite3_mutex_enter(db->mutex); 并且知道当 NOMUTEX db->mutex == NULL 并且没有锁发生时

始终使用 SQLITE_OPEN_FULLMUTEX。互斥量处理现在非常快，对性能没有真正的影响。磁盘/解析在 cpu 中更加繁重，除非您准备好对 sqlite3.c 的代码进行逆向工程，否则不清楚 NOMUTEX 有什么好处

但是，我使用多个连接（每个线程中一个 open_v2）成功地在多线程中试验了 NOMUTEX，但是使用它你还需要担心关于 CACHE 的决定（我使用 SQLITE_OPEN_PRIVATECACHE，并非所有组合都有效，一旦 db 拥有，尤其是缓存，也会改变模式systeme一旦已经打开真的是在找麻烦）在第一次打开之前选择MUTEX+CACHE+sync+journal策略并坚持下去。

另请参阅这篇关于 [https://dev.yorhel.nl/doc/sqlaccess的非常好的文章](https://dev.yorhel.nl/doc/sqlaccess)

# java - Google Guava / 提供功能集合类型的实现

> ID：10079555
> 
> 赞同：6
> 
> 时间：2012-04-09T20:39:00.663
> 
> 标签：java, clojure, guava

有人知道未来 Guava 或 Java8 是否会提供受更多功能实现启发的持久集合实现，例如在 Clojure 或 Scala 中（提供快照、由于共享树结构而进行的有效修改等）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T20:56:21.720

[关于 Guava，这里](http://groups.google.com/group/guava-discuss/browse_thread/thread/1b813f1e0f461afd/0e2126c045da1c12?lnk=gst&q=persistent#0e2126c045da1c12)有一个关于项目讨论组的讨论，项目负责人 (Kevin Bourrillion) 表示他认为 Guava 不是持久集合的正确库。

我不相信 Java 8 会有这样的计划。[这里](http://openjdk.java.net/projects/jdk8/)是 Java 8 计划的描述，其中指出主要功能是 Project Jigsaw 和 Lambda。还会有其他包含，但没有提到持久性集合。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T21:01:06.633

查看 PCollections：[http ://code.google.com/p/pcollections/](http://code.google.com/p/pcollections/)

我希望它最接近您正在寻找的东西。

# django - django-sitetree 0.7 sitetreedump 不工作

> ID：10079556
> 
> 赞同：0
> 
> 时间：2012-04-09T20:39:19.507
> 
> 标签：django, django-templates, django-sitetree

我在 Django 项目中使用[django-sitetree](https://github.com/idlesign/django-sitetree)。到目前为止，它在我的模板中运行良好。当我尝试：

```
python manage.py sitetreedump > treedump.json 
```

我得到一个未知的命令错误。我一定遗漏了一些明显的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:11:54.333

答：使用 pip 安装 django-sitetree 不包含 django-admin 管理命令。不知道为什么。直接从 git 存储库安装作为我项目中的子模块有效。

# ruby-on-rails - 登录时获取原始网址

> ID：10079563
> 
> 赞同：0
> 
> 时间：2012-04-09T20:39:58.883
> 
> 标签：ruby-on-rails, devise

当未登录的用户点击 url 时，devise 会将其转发到登录页面，然后将用户转发到其原始页面。如何在登录视图中访问此信息（原始路线/操作）？我想根据用户的去向以不同的方式显示 gui。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:09:02.127

因此，您应该扩展/覆盖设计的会话控制器。为此，请从[此处](https://github.com/plataformatec/devise/blob/master/app/controllers/devise/sessions_controller.rb)`new`复制最新的操作代码，并将其粘贴到从设计的会话控制器继承的控制器（我们称之为会话）中，如下所示：

```
class SessionsController < Devise::SessionsController
  def new
    self.resource = build_resource(nil, :unsafe => true)
    clean_up_passwords(resource)
    @after_sign_in_url = after_sign_in_path_for(resource)
    respond_with(resource, serialize_options(resource))
  end
end 
```

由于此控制器继承自 Devise 的，因此当您的控制器中未定义动作时，该动作将由 Devise 的控制器处理。所以你只需要覆盖那个`new`动作。

最后，编辑您的路线文件，使此更改生效：

```
# routes.rb
devise_for :users, :controllers => { :sessions => 'sessions' } 
```

或者，如果您使用的是范围，如下所示：

```
# routes.rb
devise_scope :user do
  get 'login' => 'sessions#new', :as => :new_user_session
end 
```

您现在可以`@after_sign_in_url`在您的视图中访问！

# java - 蚂蚁“除非”在宏定义上

> ID：10079565
> 
> 赞同：3
> 
> 时间：2012-04-09T20:40:09.597
> 
> 标签：java, ant, build, dependencies, macrodef

我想编写一个取决于在另一个宏定义中设置的属性的宏定义，例如这个，它不起作用......（宏定义不支持依赖和除非属性）无论如何要这样做？

```
<project name="mac">

    <property name="antlr.version" value="3.2"/>

    <macrodef name="check">
        <attribute name="dest"/>
        <attribute name="name"/>
        <attribute name="version"/>
        <sequential>
            <available file="@{dest}/@{name}-@{version}.jar" property="@{name}-exists"/>
        </sequential>
    </macrodef>

    <macrodef name="pull" depends="check" unless="@{name}-exists">
        <attribute name="url"/>
        <attribute name="dest"/>
        <attribute name="name"/>
        <attribute name="version"/>

        <sequential>
            <get src="@{url}" dest="@{dest}/@{name}-@{version}" verbose="true" ignoreerrors="true" unless="@{name}-exists"/>
        </sequential>
    </macrodef>

    <target name="pullall">
           <pull url="http://repo1.maven.org/maven2/org/antlr/antlr/${antlr.version}/antlr-${antlr.version}.jar" dest="." name="antlr" version="${antlr.version}"/>
    </target> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T21:10:09.177

这似乎有效：

```
 <project name="mac">

        <property name="antlr.version" value="3.2"/>
        <property name="stringtemplate.version" value="4.0.2"/>

        <target name="check">
            <available file="${dest}/${name}-${version}.jar" property="jar-exists"/>
        </target>

        <target name="_pull" depends="check" unless="jar-exists">
            <get src="${url}" dest="${dest}/${name}-${version}.jar" verbose="true" ignoreerrors="true"/>
        </target>

        <macrodef name="pull">
            <attribute name="url"/>
            <attribute name="dest"/>
            <attribute name="name"/>
            <attribute name="version"/>

            <sequential>
                <antcall target="_pull">
                    <param name="url" value="@{url}"/>
                    <param name="dest" value="@{dest}"/>
                    <param name="name" value="@{name}"/>
                    <param name="version" value="@{version}"/>
                </antcall>
            </sequential>
        </macrodef>

        <target name="pullall">
        <pull url="http://repo1.maven.org/maven2/org/antlr/antlr/${antlr.version}/antlr-${antlr.version}.jar" dest="." name="antlr" version="${antlr.version}"/>
        <pull url="http://repo1.maven.org/maven2/org/antlr/stringtemplate/${stringtemplate.version}/stringtemplate-${stringtemplate.version}.jar" dest="." name="stringtemplate" version="${stringtemplate.version}"/>
        </target>

</project> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-14T18:11:44.330

即使这个问题“有点”老了，这可能会对某人有所帮助：

在 ant 1.9.1 中引入了 if:set unless:set 属性。 [https://ant.apache.org/manual/ifunless.html](https://ant.apache.org/manual/ifunless.html)

这样，您可以按如下方式使用宏（使用 ant 1.9.3 测试）

```
<project name="mac" xmlns:unless="ant:unless">

    <property name="antlr.version" value="3.2"/>

    <macrodef name="check">
        <attribute name="dest"/>
        <attribute name="name"/>
        <attribute name="version"/>
        <sequential>
            <available file="@{dest}/@{name}-@{version}.jar" property="@{name}-exists" />
        </sequential>
    </macrodef>

    <macrodef name="pull">
        <attribute name="url"/>
        <attribute name="dest"/>
        <attribute name="name"/>
        <attribute name="version"/>

        <sequential>
            <check dest="@{dest}" name="@{name}" version="@{version}" />
            <get src="@{url}" dest="@{dest}/@{name}-@{version}.jar" verbose="true" ignoreerrors="true" unless:set="@{name}-exists" />
        </sequential>
    </macrodef>

    <target name="pullall">
           <pull url="http://repo1.maven.org/maven2/org/antlr/antlr/${antlr.version}/antlr-${antlr.version}.jar" dest="." name="antlr" version="${antlr.version}"/>
    </target>

</project> 
```

顺便提一句。宏还有其他技巧和 if:set/unless:set ，请参见此处[http://www.artificialworlds.net/blog/2013/09/13/using-ifset-unlessset-etc-with-macrodefs-in-蚂蚁/](http://www.artificialworlds.net/blog/2013/09/13/using-ifset-unlessset-etc-with-macrodefs-in-ant/)

如果将 if/unless 添加到宏的顺序主体中，您甚至可以模拟条件宏。

# ruby-on-rails - 如何使用将分页显示父母和孩子？

> ID：10079568
> 
> 赞同：0
> 
> 时间：2012-04-09T20:40:20.740
> 
> 标签：ruby-on-rails, ruby-on-rails-3, will-paginate

我无法正确显示我的视图。我现在有这个作为我的代码：

```
<% for store in @stores %>
  <% store.name %>
    <% @stores.products.each do |p| %>
     <% p.name %>
    <% end %>
<% end %>

def index
 @stores = Store.paginate(:page => params[:page], :per_page => 20)
end 
```

但最终出现错误：

```
undefined method `products' 
```

我试图展示一家商店，然后展示它的所有产品，尽可能在同一页面上重复这一点，例如：

```
Store1
 Product1
 Product2

Store2
 Product1
 Product2
 Product3
 Product4 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:47:44.937

而不是`<% @stores.products.each do |p| %>`我认为你的意思是`<% store.products.each do |p| %>`：

还有，你不是说要`<%=`上`store.name`and`p.name`行吗？

```
<% for store in @stores %>
  <%= store.name %>
    <% store.products.each do |p| %>
      <%= p.name %>
    <% end %>
<% end %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:47:13.617

那不应该`store.products`在你访问的循环内`store`吗？

```
<% for store in @stores %>
  <%= store.name %>
    <% store.products.each do |p| %>
     <%= p.name %>
    <% end %>
<% end %> 
```

并`=`添加到输出行。`<%=`

# powershell - “head -n-3”的PowerShell等效项？

> ID：10079572
> 
> 赞同：21
> 
> 时间：2012-04-09T20:40:42.867
> 
> 标签：powershell, tail, unix-head

我已经能够追踪基本的头/尾功能：

```
head -10 myfile <==> cat myfile | select -first 10
tail -10 myfile <==> cat myfile | select -last 10 
```

但是，如果我想列出除最后三行之外的所有行或除前三行之外的所有行，你该怎么做？在 Unix 中，我可以执行“head -n-3”或“tail -n+4”。如何为 PowerShell 完成此操作并不明显。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-11T20:30:36.917

有用的信息分布在此处的其他答案中，但我认为有一个简洁的摘要很有用：

**除前三行外的*所有*行**

```
1..10 | Select-Object -skip 3
returns (one per line): 4 5 6 7 8 9 10 
```

**除了*最后*三行之外的所有行**

```
1..10 | Select-Object -skip 3 -last 10
returns (one per line): 1 2 3 4 5 6 7 
```

也就是说，您*可以*使用内置的 PowerShell 命令来执行此操作，但是必须指定输入的大小很烦人。一个简单的解决方法是使用比任何可能的输入都大的常量，您不需要知道大小先验：

```
1..10 | Select-Object -skip 3 -last 10000000
returns (one per line): 1 2 3 4 5 6 7 
```

正如 Keith Hill 建议的那样，更简洁的语法是使用 PowerShell Community Extensions 中的 Skip-Object cmdlet（Goyuix 的答案中的 Skip-Last 函数执行相同，但使用 PSCX 可以使您不必维护代码）：

```
1..10 | Skip-Object -last 3
returns (one per line): 1 2 3 4 5 6 7 
```

***前三*****行**

```
1..10 | Select-Object –first 3
returns (one per line): 1 2 3 
```

***最后*****三行**

```
1..10 | Select-Object –last 3
returns (one per line): 8 9 10 
```

***中间*****四行**

（这是有效的，因为无论调用中参数的顺序如何，都是`-skip`在 之前处理的。）`-first`

```
1..10 | Select-Object -skip 3 -first 4
returns (one per line): 4 5 6 7 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-09T22:14:40.880

与 -First 和 -Last 参数一样，还有一个 -Skip 参数会有所帮助。值得注意的是，-Skip 是从 1 开始的，而不是从零开始的。

```
# this will skip the first three lines of the text file
cat myfile | select -skip 3 
```

我不确定 PowerShell 是否有什么东西可以让你返回除了最后 n 行预构建的所有内容。如果您知道长度，您可以从行数中减去 n 并使用 select 中的 -First 参数。您还可以使用仅在填充时通过行的缓冲区。

```
function Skip-Last {
  param (
    [Parameter(Mandatory=$true,ValueFromPipeline=$true)][PsObject]$InputObject,
    [Parameter(Mandatory=$true)][int]$Count
  )

  begin {
    $buf = New-Object 'System.Collections.Generic.Queue[string]'
  }

  process {
    if ($buf.Count -eq $Count) { $buf.Dequeue() }
    $buf.Enqueue($InputObject)
  }
} 
```

作为演示：

```
# this would display the entire file except the last five lines
cat myfile | Skip-Last -count 5 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T22:37:47.647

如果您使用的是[PowerShell Community Extensions](http://pscx.codeplex.com)，则有一个 Take-Object cmdlet 将传递除最后 N 项之外的所有输出，例如：

```
30# 1..10 | Skip-Object -Last 4
1
2
3
4
5
6 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T22:13:59.383

你可以这样做：

```
[array]$Service = Get-Service
$Service[0] #First Item
$Service[0..2] #First 3 Items
$Service[3..($Service.Count)] #Skip the first 3 lines
$Service[-1] #Last Item
$Service[-3..-1] #Last 3 Items
$Service[0..($Service.Count -4)] #Skip the last 3 lines 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-11-09T19:22:39.103

除了最后一个之外，所有的`n`都可以用

```
... | select -skiplast $n 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-09T21:58:47.130

除了第一个之外，所有的`n`都可以用

```
... | Select -skip $n 
```

然而，所有“除了最后一个`m`”都没有内置任何内容。将整个输入加载到一个数组中以获得长度是可行的——当然对于可能对内存提出不合理要求的大输入。

# java - 服务器发送事件 + Java 与 Spring MVC

> ID：10079573
> 
> 赞同：12
> 
> 时间：2012-04-09T20:40:47.717
> 
> 标签：java, javascript, html, spring-mvc

我目前遇到与 SSE 和 Windows XP 相关的问题。下面的源代码目前在我尝试过的所有 Chrome 中都可以使用，除了 Windows XP 中的 Chrome（？）不知道为什么。这旨在用于用户**必须**使用 Chrome 的控制面板。换句话说，我不关心 IE、Firefox 等。

**问题**：服务器端事件适用于任何地方（Chrome），但不适用于 Windows XP（Chrome）。**当我说它有效时，我的意思是调用了消息处理程序。**

**编码**

*   Javascript代码

    ```
    if (!!window.EventSource) {
       console.log("Event source available");
       var source = new EventSource('/admin/systemalert');

       source.addEventListener('message', function(e) {
            console.log(e.data);
       });

       source.addEventListener('open', function(e) {
            console.log("Connection was opened.");
       }, false);

       source.addEventListener('error', function(e) {
            if (e.readyState == EventSource.CLOSED) {
                console.log("Connection was closed.");
            } else {
                console.log(e.readyState);    <-- in windows XP it prints Error here
            }
       }, false);
    } else {
            console.log("No SSE available");
    } 
    ```

*   服务器端代码

    ```
    @Controller
    @RequestMapping("/admin/**")
    public class AdminController {

            @RequestMapping("systemalert")
            public @ResponseBody String sendMessage(HttpServletResponse response) {
                    Random r = new Random();
                    response.setContentType("text/event-stream");
                    try {
                            Thread.sleep(10000);
                    } catch (InterruptedException e) {
                            e.printStackTrace();
                    }   
                    return "data:Testing 1,2,3" + r.nextInt() +"\n";
            }

    } 
    ```

如代码中所述，行 console.log(e.readyState); 在 Windows XP 中使用 Chrome 时打印“错误”。有任何想法吗？有人看到源代码有什么问题吗？

提前致谢。奥古斯丁

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-10T17:00:45.510

For anyone with this problem, the problem was related to the new lines needed after the data. Basically, you need two lines and not one as I was using. That way it works everywhere.

Changing this:

```
return "data:Testing 1,2,3" + r.nextInt() +"\n"; 
```

To this:

```
return "data:Testing 1,2,3" + r.nextInt() +"\n\n"; 
```

Fixes the problem..

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-10-13T08:37:16.630

请注意 Spring Framework 4.2+ 原生支持 SSE，而不是手动实现[SSE](http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#mvc-ann-async-sse)。请参阅[此示例启用 SSE 的控制器](https://github.com/sdeleuze/spring-react-isomorphic/blob/master/src/main/java/io/spring/isomorphic/CommentController.java#L73)返回[SseEmitter](http://docs.spring.io/autorepo/docs/spring/current/javadoc-api/org/springframework/web/servlet/mvc/method/annotation/SseEmitter.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T15:36:43.630

好的，我在 PHP + HTML5 中创建了一个小例子。

你可以看看[这里](http://arancione-consulting.com/server-events/)。你会看到我有两个不同的按钮；第一个创建事件源，第二个断开它。

代码直接打印到 Firefox/chrome 控制台。正如您将看到的，消息处理程序在 firefox 中调用，而不是在 chrome 中调用。

**到目前为止，这不适用于我测试过的任何 chrome。**

Firefox 输出示例：

```
Creating event source
Open
Id: 1334072077
Message: Se puede leer esto?
Origin: http://arancione-consulting.com
Closed
Open
Id: 1334072082
Message: Se puede leer esto?
Origin: http://arancione-consulting.com
Closed 
```

示例 Chrome 输出：

```
Creating event source
Open
Closed
Open
Closed 
```

如果有人想知道，服务器端代码是：

```
<?php
header('Content-Type: text/event-stream');
header('Cache-Control: no-cache'); // prevent caching of event data.
echo "id: " . time() . "\n";
echo "Event: time\n";
echo "data: Se puede leer esto?\n";
flush();
?> 
```

有任何想法吗？

# f# - 带有类型提供程序的可移植库

> ID：10079576
> 
> 赞同：8
> 
> 时间：2012-04-09T20:40:50.103
> 
> 标签：f#, type-providers, portable-class-library

据我了解，F# 类型提供程序始终是一个不可移植的类库（例如，它将使用 WinRT 中不可用的 Reflection.Emit）。要在我的 F# 类库中使用它，我需要添加对类型提供程序 DLL 的引用，因此该库必须是不可移植的才能编译。

在这种情况下，我很乐意将其分成一个可移植程序集和一个使用类型提供程序的程序集。我可以编译它的唯一方法是向我的 C# 应用程序项目 (.NET 4.5) 添加对 Fsharp.Core 的引用 - 但在运行时 FSharp.Core 的版本之间仍然存在冲突。

```
{"Could not load file or assembly 'FSharp.Core, Version=2.3.5.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' or one of its dependencies. The system cannot find the file specified.":"FSharp.Core, Version=2.3.5.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"} 
```

我可以解决冲突吗，我是否错误地使用了类型提供程序，或者它是否还不能完成？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T22:43:15.290

您需要在 app.config 文件中进行绑定重定向。如果您创建一个以 4.5 为目标的新 F# 项目，它将具有

```
<runtime>
  <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
    <dependentAssembly>
      <assemblyIdentity name="FSharp.Core" publicKeyToken="b03f5f7f11d50a3a" culture="neutral"/>
      <bindingRedirect oldVersion="2.3.5.0" newVersion="4.3.0.0"/>
    </dependentAssembly>
  </assemblyBinding>
</runtime> 
```

在 app.config 中。您需要将其添加到最终使用的 exe 项目（例如 C# 项目）的 app.config 中，例如，如果您在桌面上运行它，它会将便携式 FSharp.Core (2.3.5.0) 解析到桌面一个（4.3.0.0）。

# ios - 当我创建 DDXMLDocument 的自动释放对象时，我的应用程序崩溃了

> ID：10079577
> 
> 赞同：0
> 
> 时间：2012-04-09T20:40:50.663
> 
> 标签：ios, crash, kissxml

我的应用程序没有崩溃。

```
DDXMLDocument *d = [[DDXMLDocument alloc] initWithData:abookConnData options:0 error:nil];
books = [d nodesForXPath:@"abooks/abook" error:nil]; 
```

我将 DDXMLDocument 的对象更改为自动释放，我的应用程序开始崩溃。但为什么？

```
DDXMLDocument *d = [[[DDXMLDocument alloc] initWithData:abookConnData options:0 error:nil] autorelease];
books = [d nodesForXPath:@"abooks/abook" error:nil]; 
```

我的应用程序在 DDXMLNode 中崩溃了。[DDXMLNode XMLStringWithOptions:]

![在此处输入图像描述](../Images/49279b05ded4121a5450922298fe5c97.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:32:00.080

您没有给出足够的代码来肯定地说，但这几乎可以肯定是您的 DDXMLDOcument* (d) 在您使用它之前就已发布的情况。

尝试打开 Zombie detection 并在 Exception 上放置一个断点。通常，这可以引导您找到问题所在的确切代码行。

调试的另一个技巧是创建 DDXMLDocument 的子类并覆盖 ALLOC 和 RELEASE 以调用 NSLog() 事件（然后`[super alloc]`或`[super release]`！），以便您可以观察正在发生的事情。

# windows-phone-7 - Windows Phone 7、隐写术和 MediaLibrary.SavePicture

> ID：10079580
> 
> 赞同：0
> 
> 时间：2012-04-09T20:41:08.753
> 
> 标签：windows-phone-7, metadata, steganography

我在 WP7 上与 MediaLibrary 合作，我正在对 BitmapImage (WriteableBitmap) 进行隐写术，效果很好（使用这种方法： http: [//www.codeproject.com/Articles/4877/Steganography-Hiding-messages-in-the-Noise -a-Pi](http://www.codeproject.com/Articles/4877/Steganography-Hiding-messages-in-the-Noise-of-a-Pi) )

现在，当我调用 MediaLibrary.SavePicture 方法将我的位图保存到手机时，就会出现问题。当我再次从手机加载此保存的位图时，我可以看到位图的像素发生了偏移，并且我的隐写数据丢失了。有没有办法在保存方法期间避免这种行为？

更好的是，有没有办法将一些元数据附加到我的位图中，这些元数据将与位图一起保存？

非常感谢！狮子座

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:48:41.387

该问题可能是由于`MediaLibrary.SavePicture`将流保存为 JPEG 而您的字节流表示未压缩的位图这一事实引起的。由于 JPEG 是一种有损压缩格式，您的数据可能会被丢弃，因此您的隐藏字节流会损坏。我不熟悉隐写术，但如果可能的话，您可以尝试创建一个空白 JPEG 图像并将数据写入其中。这样，您的图像格式保持不变。您可以尝试使用值为的[Extensions.SaveJpeg](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.extensions.savejpeg%28VS.92%29.aspx)，将数据写入其中，然后将其保存到 MediaLibrary。`quality``100`

# java - Windows 已经聚焦 - 在多个线程后忽略焦点增益

> ID：10079584
> 
> 赞同：0
> 
> 时间：2012-04-09T20:42:04.410
> 
> 标签：java, android, multithreading

我在 Android java 项目中有一个主类，其中定义了所有函数。然后我有 2 个其他类扩展主类并实现`Runnable`.

*   主类：所有主要功能
*   第 2 类：我使用所有主要功能并有一个静态变量`X`，我在文件 2 中对其进行了修改。
*   第 3 类：我使用所有主要功能并有一个静态变量`Y`，我在文件 3 中对其进行了修改。

在主类中，我启动了 2 个线程：一个用于 Class2，一个用于 Class3。

当我尝试`Class2.X`从主班打电话时，总是`null`无论如何。我已经尝试过`volatile`, `synchronized(thread)`,`getvalue()`等，但它不起作用。

我应该怎么做才能`Class2.X`从主类中读取它不为空的值？

这是代码：

```
Thread t = new Thread(new Functionss(mRgbImage));
t.start();
Thread t2 = new Thread(new Functionss_2(mRgbImage));
t2.start();

if(boolean_variable)
{
    try {
        Thread.sleep(30000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

    Bitmap final_added =addition(mRgbImage2, mRgbImage3);                 
    mImageView.setImageBitmap(final_added); 
```

`mRgbImage2`并且`mRgbImage3`是`static volatile`变量。

事实上，我认为这不是变量的问题，因为当我在主类中使用图像并对其进行修改，然后执行`mImageView.setImageBitmap(initial_image)`时，我的安卓手机仍然出现黑屏。

我在 logcat 中记录了以下内容：

```
Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@40a34d28 
```

如果我删除线程，我不会收到此错误。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:49:55.953

我怀疑您的线程从未执行赋值语句或分配不同的值或其他东西。也许放置一些日志消息或调试您的应用程序并在分配处放置一个断点会有所帮助。

如果你有类似的东西：

```
public class MainClass {
    Class2 class2 = new Thread(new Class2());
    class2.start();
    class2.join();
    // Class2.value will == 10 here
} 
```

进而：

```
public class Class2 implements Runnable {
    public static volatile int value;
    public void run() {
       ...
       this.value = 10;
       ...
    }
} 
```

然后在分配发生`Class2`后，`value` *将*更新。这显然是一个简单的例子，我怀疑`Class2`你的代码中的线程实际上还没有完成，但只要达到了分配，那么`value` *就会*改变。同样，日志消息或调试器在这里会有所帮助。

最好有类似以下模式的东西：

```
public class Class2 implements Runnable {
    private volatile int value;
    public void run() {
       ...
       this.value = 10;
       ...
    }
    public int getValue() {
        return this.value;
    }
} 
```

所以 then可以毫无混淆地`MainClass`访问该值。请注意，您仍然需要那里的关键字，因为该值是从不同的线程获取/设置的。`Class2``Class3``volatile`

希望这里有帮助。如果您使用更多详细信息编辑您的问题，我可能会提供更多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T18:17:18.223

我正在使用 JJIL 库，结果证明

“ 哪些步骤将重现该问题？

1.  在多个线程中使用 RgbImageJ2se.toDisplay 模拟（RgbImageJ2se 的不同实例）。

由于传递了对 Graphics 对象的静态引用，因此取决于哪个线程先执行会产生不确定的结果。"

参考：[http ://code.google.com/p/jjil/issues/detail?id=27](http://code.google.com/p/jjil/issues/detail?id=27)

我怀疑它与库有关，因为我用数学函数重写了代码，并且输出是正确的。它正在等待两个类完成并使用它们的输出进行进一步的计算。

希望这可以帮助其他人陷入困境。

# java - 应用程序在 Eclipse 中调试/运行，但 .APK 在解析包含自定义视图的 XML 布局时会给出 .classNotFoundException

> ID：10079585
> 
> 赞同：2
> 
> 时间：2012-04-09T20:42:11.737
> 
> 标签：java, android

当应用程序从 Eclipse 通过 USB 安装时，我的应用程序将在我的目标设备 (HTC Desire HD) 上调试和运行完美。

但是，当我导出到 .APK 然后在我的 Desire HD 上安装这个 .APK（首先手动卸载了我之前安装的应用程序）时，它崩溃了。

检查 Logcat 中的错误后，我可以看到我的自定义扩展`View`，在布局 XML 文件中使用其完全限定名称引用，显然无法找到并导致`.classNotFoundException`.

Logcat 错误跟踪中感兴趣的两行是：

`04-09 21:29:01.101: E/AndroidRuntime(2157): Caused by: android.view.InflateException: Binary XML file line #12: Error inflating class com.trevp.myAppName.DashboardLayout`

再往下看：

`04-09 21:29:01.101: E/AndroidRuntime(2157): Caused by: java.lang.ClassNotFoundException: com.trevp.myAppName.DashboardLayout in loader dalvik.system.PathClassLoader[/data/app/com.trevp.myAppName-1.apk`

从 Eclipse 安装应用程序时不会发生此崩溃，只有从导出的 .APK 安装时才会发生此崩溃。

如果这可能是 Proguard 问题，这是我的 Proguard 配置文件。我没有真正从默认情况下触及它，因为我是使用 Proguard 的新手。我的 Proguard 版本是 4.7。

```
-optimizationpasses 5
-dontusemixedcaseclassnames
-dontskipnonpubliclibraryclasses
-dontpreverify
-verbose
-optimizations !code/simplification/arithmetic,!field/*,!class/merging/*

-keep public class * extends android.app.Activity
-keep public class * extends android.app.Application
-keep public class * extends android.app.Service
-keep public class * extends android.content.BroadcastReceiver
-keep public class * extends android.content.ContentProvider
-keep public class * extends android.app.backup.BackupAgentHelper
-keep public class * extends android.preference.Preference
-keep public class com.android.vending.licensing.ILicensingService

-keepclasseswithmembernames class * {
    native <methods>;
}

-keepclasseswithmembernames class * {
    public <init>(android.content.Context, android.util.AttributeSet);
}

-keepclasseswithmembernames class * {
    public <init>(android.content.Context, android.util.AttributeSet, int);
}

-keepclassmembers enum * {
    public static **[] values();
    public static ** valueOf(java.lang.String);
}

-keep class * implements android.os.Parcelable {
  public static final android.os.Parcelable$Creator *;
} 
```

正在膨胀的 XML 文件。（`Merge`使用标签是因为其中的元素作为子元素添加到父元素`FrameLayout`。）

```
<?xml version="1.0" encoding="utf-8"?>
<merge xmlns:android="http://schemas.android.com/apk/res/android">

    <ImageView   
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_gravity="top|left"
    android:scaleType="centerCrop"
    android:id="@+id/dashLayoutImage"
    android:src="@drawable/background2" android:drawingCacheQuality="high"/>

    <com.trevp.myAppName.DashboardLayout
    android:clipChildren="false"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:id="@+id/dashLayout"
    android:layout_gravity="top|left" />

    <include
    android:layout_gravity="top|left"
    layout="@layout/status_bar"
    android:id="@+id/statusBar" />

    <TextView
    android:layout_gravity="bottom|left"
    android:id="@+id/pollRate"
     android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    >
    </TextView>

</merge> 
```

在此先感谢您提供任何提示。如果需要任何其他提取或配置信息，请大声疾呼。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T16:56:09.530

这个问题现在已经通过使用`proguard.cfg`从新创建的测试项目中获取的完全标准和默认文件来解决。

正如我原来的问题所引用的那样，我之前使用的配置文件是我不得不在短时间内手动添加到项目中的一个，因为它丢失了。我现在不确定文件来自哪里——我很可能已经用谷歌搜索并找到了一个示例默认文件，然后就使用了它。

这是 Eclipse 为我添加到新项目中的一个，它启用了一个工作 .APK。

```
-optimizationpasses 5
-dontusemixedcaseclassnames
-dontskipnonpubliclibraryclasses
-dontpreverify
-verbose
-optimizations !code/simplification/arithmetic,!field/*,!class/merging/*

-keep public class * extends android.app.Activity
-keep public class * extends android.app.Application
-keep public class * extends android.app.Service
-keep public class * extends android.content.BroadcastReceiver
-keep public class * extends android.content.ContentProvider
-keep public class * extends android.app.backup.BackupAgentHelper
-keep public class * extends android.preference.Preference
-keep public class com.android.vending.licensing.ILicensingService

-keepclasseswithmembernames class * {
    native <methods>;
}

-keepclasseswithmembers class * {
    public <init>(android.content.Context, android.util.AttributeSet);
}

-keepclasseswithmembers class * {
    public <init>(android.content.Context, android.util.AttributeSet, int);
}

-keepclassmembers class * extends android.app.Activity {
   public void *(android.view.View);
}

-keepclassmembers enum * {
    public static **[] values();
    public static ** valueOf(java.lang.String);
}

-keep class * implements android.os.Parcelable {
  public static final android.os.Parcelable$Creator *;
} 
```

我可以看到差异在于`-keepclass*`类型说明。

我现在将更加努力地真正了解如何配置 Proguard！

为了感兴趣，请查看以下几行：

```
-keepclasseswithmembers class * {
    public <init>(android.content.Context, android.util.AttributeSet);
}

-keepclasseswithmembers class * {
    public <init>(android.content.Context, android.util.AttributeSet, int);
} 
```

这些看起来像是为了保留`View`构造函数（或保留包含它们的类），只有在从 XML 引用类时才会调用这些构造函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:53:59.993

在使用合并膨胀视图时未将您设置`attachToRoot`为 true 可能是 InflateException 的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-01T10:42:48.443

或者您可以将项目中的一个替换为默认的或 ${sdk.dir}/tools/proguard/proguard-android.txt 中优化的那个

# java - java JTable如何跟踪行

> ID：10079588
> 
> 赞同：0
> 
> 时间：2012-04-09T20:42:16.673
> 
> 标签：java, swing, jtable

我有一个连接到 sqlite 的 JTable。db 表如下所示：

```
 resource_id #primary_key, file, type 
```

I have already implemented adding the rows from db, but the problem is i need to know the resource id when some row in jTable is selected (not the index). 有没有办法添加具有唯一 ID 而不是基于索引（或类似的东西）的行？

当前的解决方案将资源 id 添加为表列，但这并不能完全解决问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:30:27.430

创建一个`TableData`包含表中数据的类。使用自定义`TableModel`并将 JTable 的数据放在`Vector<TableData>`.

您可能会发现创建一种方法很有用，例如`addRow(TableData data)`在您的方法`TableModel`中处理表中的数据并将数据添加到`Vector`.

在覆盖的方法`public removeRow(int row)`中，您将需要删除行可以用作索引的向量数据。

用于在 JTable 中显示数据的重写方法`public Object getValueAt(int row, int col)`将只需要从`Vector<TableData>`. 您还可以将不属于此方法的其他列的逻辑放置`TableData`在此方法中。

不要忘记在适用的地方调用 fireTableRowsUpdated(row,col) 和 fireTableCellUpdated(row,col)。

如需进一步参考以及如何处理您的选择，`JTable`请参阅[本教程](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#selection)

# css - @font-face 在 FireFox 中不起作用，可能是缓存问题？

> ID：10079592
> 
> 赞同：0
> 
> 时间：2012-04-09T20:42:26.237
> 
> 标签：css, firefox, font-face

我以为我对此有所了解...以前曾多次工作过。这在 Chrome 中运行良好：

```
@font-face {
    font-family: 'idealsans_book';
    src: url('http://staceyclarke.com.s3.amazonaws.com/idealsans_book.eot'); /* IE fix */
    src: url('http://staceyclarke.com.s3.amazonaws.com/idealsans_book.eot?#iefix') format('embedded-opentype'), /* another IE fix */
         url('http://staceyclarke.com.s3.amazonaws.com/idealsans_book.wof') format('woff'),
         url('http://staceyclarke.com.s3.amazonaws.com/idealsans_book.ttf') format('truetype');
    src: local('idealsans_book'),
        url('fonts/idealsans_book.woff') format('woff');
} 
```

但在 FF 中不起作用......我正在使用[Paul Irish 的 Bulletproof @font-face Syntax](https://www.paulirish.com/2009/bulletproof-font-face-implementation-syntax/)。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:27:06.067

看了一下 Chrome 和 FF（全部更新），看起来字体在大多数情况下都可以正常工作。看一看（背景为镀铬，顶部为 FF）

![字体](../Images/263d923f46f8f9b1a4c8a93911d677b8.png)

也许它在你的一端缓存。不过，我确实注意到 FF 中有一些奇怪的字符（见右下角，红色圆圈）。可以是字符集。

另外，看看我写的这篇关于[CSS3 中的 font-face 的](http://maxfelker.tumblr.com/post/5673285606/cross-browser-solution-to-css3-font-face)博客文章。

此外，也许 Google 代码可以帮助您使用他们的新[字体 api](http://www.google.com/webfonts)。

# draggable - 可拖动的融合折线图

> ID：10079593
> 
> 赞同：1
> 
> 时间：2012-04-09T20:42:27.597
> 
> 标签：draggable, fusioncharts

我发现融合功率图表提供了在图表上拖动点的功能。那么融合图XT是否也有类似的功能呢？

这是 Highcharts 的示例：http: [//jsfiddle.net/highcharts/AyUbx/#](http://jsfiddle.net/highcharts/AyUbx/#)

或者是否有任何具有此类功能的替代图表库？

谢谢，-春

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T06:58:38.033

FusionCharts XT 是*常规*图表的集合。您在此处突出显示的可拖动图表是一个小众图表，它仅在 PowerCharts 包中可用。

您可以单独获取 PowerCharts 软件包，也可以购买完整的 FusionCharts 套件，其中包括 FusionCharts XT + FusionWidgets XT + FusionMaps + PowerCharts。

# sql - 实现您自己的乐观锁定 SQL Server 2008 R2

> ID：10079594
> 
> 赞同：1
> 
> 时间：2012-04-09T20:42:34.063
> 
> 标签：sql, sql-server-2008, locking

我见过一个实现了自己的乐观锁定机制的数据模型。实现自己的乐观锁定机制有哪些优点和缺点？表现？也许避免死锁？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:04:03.487

您的意思是在数据库上还是在对象关系映射 (ORM) 系统中。如果您有一些复杂的逻辑要实现，那么在应用程序级别有很多原因可能希望在数据库锁之上同步，但这些都依赖于数据库对其事务性能的保证。

你能给我们一些关于你需要知道的更多信息吗？

# wpf - ResourceDictionary 中的引用

> ID：10079596
> 
> 赞同：1
> 
> 时间：2012-04-09T20:43:06.457
> 
> 标签：wpf, silverlight, xaml, resourcedictionary

我有

```
<Image x:Name="imgScreenshoot" Margin="2" Source="{Binding Converter={StaticResource ImageConverter1}}" /> 
```

在一个`ResourceDictionary`

同时它有

```
<local:ImageConverter x:Key="ImageConverter1" /> 
```

在设计模式下没有错误。

但是当我启动应用程序时，我得到**了那个应用程序的错误。无法解析参考** `ImageConverter1`。

我该如何解决？谢谢！

* * *

```
 <UserControl.Resources>
        <ResourceDictionary>
            <DataTemplate x:Key="DataTemplateScreen">
                <Border Height="250" Width="250" BorderBrush="#FF3798F1" BorderThickness="2" CornerRadius="5" >
                    <Grid Margin="2,2,2,2" VerticalAlignment="Stretch"  HorizontalAlignment="Stretch">
                        <Grid.Background>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFF0F8FE" Offset="0"/>
                                <GradientStop Color="#FFE0F3FE" Offset="0.3"/>
                                <GradientStop Color="#FF6FA7C5" Offset="1"/>
                            </LinearGradientBrush>
                        </Grid.Background>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid x:Name="brdNameActionButtons" Grid.ColumnSpan="3" Margin="0">
                            <Grid.Background>
                                <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                    <GradientStop Color="#FFDCF0FA" Offset="0"/>
                                    <GradientStop Color="#FFC5E6F7" Offset="0.2"/>
                                    <GradientStop Color="#FF297CCA" Offset="1"/>
                                </LinearGradientBrush>
                            </Grid.Background>
                            <TextBlock x:Name="txbName" Text="{Binding Name}" Margin="2" Grid.Row="0" FontWeight="Bold" FontSize="12" Grid.Column="0" HorizontalAlignment="Left" Foreground="Black" FontFamily="Segoe UI" />
                            <TextBlock x:Name="txbUpdated" Text="{Binding Screenshot.Refreshed}" Margin="2" Grid.Row="0" FontWeight="Bold" FontSize="12" Grid.Column="0" HorizontalAlignment="Right" Foreground="Black" FontFamily="Segoe UI" />
                        </Grid>
                        <Border x:Name="brdScreenshoot" Grid.Column="2" Margin="2" Grid.Row="3"   CornerRadius="5" >
                            <Grid >
                                <Image x:Name="imgScreenshoot" Margin="2" Source="{Binding Converter={StaticResource ImageConverter1}}" />
                            </Grid>
                        </Border>
                        <StackPanel Grid.Column="2" Grid.Row="1"  Orientation="Horizontal"  HorizontalAlignment="Center" Margin="0,2">
                            <Button Content="Play"  HorizontalAlignment="Center" Height="23" Margin="0,0,0,0" VerticalAlignment="Bottom" Width="42" Grid.Row="1"/>
                            <Button Content="Stop"   HorizontalAlignment="Center" Height="23" Margin="2,0,0,0" VerticalAlignment="Bottom" Width="42" Grid.Row="1"/>
                            <Button Content="Cancel"   HorizontalAlignment="Center" Height="23" Margin="2,0,0,0" VerticalAlignment="Bottom" Width="42" Grid.Row="1"/>
                            <Button Content="Refresh"   HorizontalAlignment="Center" Height="23" Margin="10,0,0,0" VerticalAlignment="Bottom" Width="42" Grid.Row="1"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </DataTemplate>
            <ItemsPanelTemplate x:Key="MonitorPlayersItemsPaneltemplate">
                <toolkit:WrapPanel/>
            </ItemsPanelTemplate>
            <local:ImageConverter x:Key="ImageConverter1" />
        </ResourceDictionary>
    </UserControl.Resources> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:47:56.153

*在使用之前*将转换器声明得更高。

# javascript - 我可以为此添加鼠标悬停的声音吗？

> ID：10079597
> 
> 赞同：2
> 
> 时间：2012-04-09T20:43:09.313
> 
> 标签：javascript, html, mouseover

我有一个包含翻转图像的代码，单击时会显示一个弹出窗口。我不知道为什么，但我也无法将鼠标悬停在声音上。感谢您的帮助，谢谢！

```
<input name="image" type="image" onMouseOver= src="http://japanesefriend.zxq.net/images/pk1pg1roll_15.jpg" onMouseOut= src="http://japanesefriend.zxq.net/images/pk1pg1_15.jpg"  value="" src="http://japanesefriend.zxq.net/images/pk1pg1_15.jpg" onClick='styledPopupOpen("<img src=http://japanesefriend.zxq.net/flashcards/ichi.gif />")'  align=middle width=131 height=118> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:49:42.947

```
<input name="image" type="image" value=""
    onMouseOver='this.src = "http://japanesefriend.zxq.net/images/pk1pg1roll_15.jpg";'
    onMouseOut='this.src = "http://japanesefriend.zxq.net/images/pk1pg1_15.jpg";'
    src="http://japanesefriend.zxq.net/images/pk1pg1_15.jpg" onClick='styledPopupOpen("<img src=http://japanesefriend.zxq.net/flashcards/ichi.gif />")' align="middle" width="131" height="118" /> 
```

UPD：也可用于预加载这些图像或使用具有过度/退出状态的单个精灵。在后一种情况下，您将使用 not `this.src`but进行操作`this.style`（如果没有使用 JS 框架）。

# c++ - 在 OS X 10.7 而不是 Linux 中使用 FBO 渲染到纹理的问题

> ID：10079603
> 
> 赞同：0
> 
> 时间：2012-04-09T20:43:36.113
> 
> 标签：c++, macos, opengl

我有一个测试程序，它以编程方式渲染纹理，然后渲染一个简单的四边形，该四边形使用先前绘制的纹理进行蒙皮。该程序非常简单，一切都是在 2D 中完成的。该程序在 linux 下运行良好，一切看起来都应该：![在 Linux 上运行](../Images/8a81e5997e53f994251a63233ec7a90e.png)

但是，当我在运行 10.7 的 mac 上运行程序时，什么也没有出现： ![在 Mac 上运行](../Images/fc1c2f2e4a7157fed7fc7fcd859ad6e1.png)

我完全不知道为什么这个程序不能在我的 mac 上运行。

以下是程序的相关部分。

创建纹理：

```
void createTextureObject(){
    cout<<"Creating a new texture of size:"<<textureSize<<endl;
    //glDeleteTextures(1, &textureId);
    glGenTextures(1, &textureId);
    glBindTexture(GL_TEXTURE_2D, textureId);
    glTexParameteri(GL_TEXTURE_2D, GL_GENERATE_MIPMAP, GL_TRUE); // automatic mipmap generation included in OpenGL v1.4
    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA8, textureSize, textureSize, 0, GL_RGBA, GL_UNSIGNED_BYTE, 0);

    isTextureValid = true;
    createFBObject();
} 
```

创建帧缓冲区对象：

```
void createFBObject(){
    cout<<"Creating a new frame buffer object"<<endl;

    glDeleteFramebuffers(1, &fboId);
    glGenFramebuffersEXT(1, &fboId);

    glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, fboId);

    glGenRenderbuffersEXT(1, &rboId);
    glBindRenderbufferEXT(GL_RENDERBUFFER_EXT, rboId);
    glRenderbufferStorageEXT(GL_RENDERBUFFER_EXT, GL_DEPTH_COMPONENT, textureSize, textureSize);
    glBindRenderbufferEXT(GL_RENDERBUFFER_EXT, 0);

    glFramebufferTexture2DEXT(GL_FRAMEBUFFER_EXT, GL_COLOR_ATTACHMENT0_EXT, GL_TEXTURE_2D, textureId, 0);

    glFramebufferRenderbufferEXT(GL_FRAMEBUFFER_EXT, GL_DEPTH_ATTACHMENT_EXT, GL_RENDERBUFFER_EXT, rboId);

    bool status = checkFramebufferStatus();
    if(!status){
        cout<<"FrameBufferObject not created! Quitting!"<<endl;
        exit(1);
        fboUsed = false;
    }

    glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, 0);
} 
```

渲染到纹理：

```
void drawToTexture(){

    if (!isTextureValid)
        createTextureObject();

    glViewport(0, 0, textureSize, textureSize);
    glLoadIdentity();
    // set the rendering destination to FBO
    glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, fboId);
    // clear buffer
    glClearColor(0, 0, 0, 1.0);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
   // draw to the texture
    glColor3f(0.0, 1.0, 0.0);

    for (int i=1; i<=5; i++){
        glBegin(GL_LINE_LOOP);
            glVertex2f(-1 * i/5.0f, -1 * i/5.0f);
            glVertex2f( 1 * i/5.0f, -1 * i/5.0f);
            glVertex2f( 1 * i/5.0f,  1 * i/5.0f);
            glVertex2f(-1 * i/5.0f,  1 * i/5.0f);
        glEnd();
    }
    glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, 0); 
} 
```

渲染纹理四边形：

```
void drawTexturedQuad(){
    glViewport(50, 50, textureSize, textureSize);
    glLoadIdentity();
    glClearColor(0.2, 0.2, 0.2, 0.2);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glBindTexture(GL_TEXTURE_2D, textureId);

    int size = 1;
    int texS = 1;

    glBegin(GL_QUADS);
        glColor4f(1, 1, 1, 1);
        glTexCoord2f(texS,  texS);  glVertex3f(size,        size,0);
        glTexCoord2f(0,     texS);  glVertex3f(-1 * size ,  size,0);
        glTexCoord2f(0,     0);     glVertex3f(-1 * size,   -1 * size,0);
        glTexCoord2f(texS,  0);     glVertex3f(size,        -1 * size,0);
    glEnd();

    glBindTexture(GL_TEXTURE_2D, 0);
} 
```

我正在使用 GLUT，我的显示回调很简单：

```
void displayCB(){
    drawToTexture();
    drawTexturedQuad();
    glutSwapBuffers();
} 
```

此外，我还有其他方法检查 OpenGL 是否支持 FrameBufferObjects 以及它们是否不是程序退出。此外，我还有其他逻辑可以`textureSize`在调整窗口大小时设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:45:51.553

```
glTexParameteri(GL_TEXTURE_2D, GL_GENERATE_MIPMAP, GL_TRUE); // automatic mipmap generation included in OpenGL v1.4 
```

这可能是个问题。GL 规范没有确切说明应该在什么时候生成 mipmap，当然，这会产生渲染到纹理的问题。因此，GL_EXT_framebuffer_object（以及核心版本）引入了 glGenerateMipmapEXT，您在需要生成 mipmap 的位置（通常在渲染到纹理之后）准确地调用它。

因此，删除 GL_GENERATE_MIPMAP 内容并在需要时手动使用 glGenerateMipmap。[您可以在GL_EXT_framebuffer_object 规范](http://oss.sgi.com/projects/ogl-sample/registry/EXT/framebuffer_object.txt)中阅读有关此问题的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T21:16:02.040

你确定你的缓冲区 id 是 0 而不是 1？也许之前已经创建了另一个 FBO。

还要检查纹理尺寸尝试使它们的幂 2

# macos - 无法让MongoDB运行

> ID：10079612
> 
> 赞同：1
> 
> 时间：2012-04-09T20:44:28.060
> 
> 标签：macos, mongodb, installation

我刚刚按照以下链接上的说明安装了 Mongodb。

一切顺利，没有错误。但是，当尝试运行 Mongodb（通过键入“Mongod”或“Mongo”）时，我收到以下错误：mongod: command not found。有什么问题？

我试图再次安装它，但我收到一条消息，它已经安装。

我遵循的[说明（Mac OSX）。](http://www.mongodb.org/display/DOCS/Quickstart+OS+X)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T20:46:46.160

*您是否将mongod*所在的文件夹添加到路径中？

尝试 cd 进入文件夹并直接执行 mongod

```
./mongod 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T20:46:45.487

这对我来说听起来像是一个 PATH 问题。Mac OSX 上的安装可能不会自动将 MongoDB 添加到系统 PATH（可以从任何目录运行的程序列表）。

查看该文章评论中的以下评论，该`m o l a r o`评论指的是 Mac OSX [http://www.mongodb.org/display/DOCS/Quickstart+OS+X#comment-78182225](http://www.mongodb.org/display/DOCS/Quickstart+OS+X#comment-78182225)中的特定 PATH 问题。

# c++ - 使用 C 风格的结构访问维护封装

> ID：10079613
> 
> 赞同：1
> 
> 时间：2012-04-09T20:44:33.697
> 
> 标签：c++, encapsulation, const-cast

假设我有一堂课：

```
class Foo
{
    int _bar;

    public:
        Foo (const int); //sets bar as well
        bool setBar (const int);
        int getBar(); 

        const int &bar;
}; 
```

这将允许 C 和 C++ 方法获取数据，但在设置时仍然验证有效数据。它可以按如下方式使用：

```
int main()
{
    Foo foo (10);
    cout << foo.getBar(); //OK, prints 10

    foo.bar = 5; //error: bar is const
    foo._bar = 5; //error: _bar is private, use bar instead
    foo.setBar (6); //OK, foo._bar is now 6

    cout << foo.bar; //OK, prints 6
} 
```

然而，一切都不是很好。这也允许一个特定的肮脏把戏：

```
Foo foo (1000);
const_cast<int &> (foo.bar) = 5; //OK, bar's const is casted away
cout << foo.bar; //OK, prints 5 
```

如果我不希望人们首先滥用将其放入课堂的一半意义，会发生什么？我是否只是被迫不允许因为一个错误而对那些更喜欢（看似）直接访问成员的人留有余地，还是有一些技巧可以实际允许语法（用于阅读）和封装？

* * *

在不使用该方法的情况下保留我能想到的语法（这次保持一致）的最佳方法是：

```
private: 
    int _bar;
public:
    int bar() { return _bar; }
    void bar (const int data) { _bar = data; }

... 

foo.bar (5);
cout << foo.bar(); 
```

这是否是为了保持旧语法和类稳定性而接近它的理想方式？我能想到的准确维护语法的唯一方法是将数据成员包装在一个小类中，但是对于您要应用它的每个类来说，这似乎需要做很多工作。

# javascript - 在 JavaScript 中验证 Int 值

> ID：10079615
> 
> 赞同：1
> 
> 时间：2012-04-09T20:44:49.337
> 
> 标签：javascript, validation

我试图弄清楚如何确保用户使用 JavaScript 将 int 输入到文本字段中。目前，我有以下内容：

```
var myVal = $("#myField").val();
if (isInt(myVal)) {
  alert("Awesome!");
} else {
 alert("No Good");
}

function isInt(i) {
    if ((i != null) && (i != undefined) && (i.length > 0)) {
        alert(typeof i);
        return (typeof i == 'number' && /^-?\d+$/.test(i + ''));
    }
    return false;
} 
```

如果我在文本字段中输入 123，我注意到它`typeof i`是“字符串”。我不确定如何执行这种验证。有人可以告诉我吗？当我用谷歌搜索这个时，我很惊讶我没有成功。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T20:57:53.937

```
​function isInt(myVal) {
    return /^[+-]?\d+$/.test(myVal);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:45:23.910

您可以简单地使用`!isNaN(+myVal)`或`!isNaN(parseInt(myVal, 10))`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T20:46:29.727

这是一个简短而甜蜜的方式

```
function isInt(n) {
    return !isNaN(parseFloat(n)) && isFinite(n);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T20:57:32.350

如果您对非整数数字或字符串使用模数运算符，

返回余数或 NaN。

```
function isInt(i) {
   return i%1===0;
} 
```

# java - 在杰克逊反序列化中处理备用属性名称

> ID：10079617
> 
> 赞同：11
> 
> 时间：2012-04-09T20:45:07.840
> 
> 标签：java, json, jackson

我正在将 REST/JSON 服务从 Coldfusion 9 转换为 Spring-MVC 3.1 应用程序。我正在使用 Jackson (1.9.5) 和 Spring 提供的 MappingJacksonJsonConverter，并且正在自定义 ObjectMapper 以使用 CAMEL_CASE_TO_LOWER_CASE_WITH_UNDERSCORES 命名字段。

我面临的问题是我们的旧服务将“驼峰式大小写为带有下划线的大写”作为 json 属性名称。这个 JSON 的消费者（也是用 ColdFusion 编写的）可能不太关心大小写，但杰克逊确实关心大小写，并抛出 UnrecognizedPropertyExceptions。

在查看了我可以从 ObjectMapper 获得的几乎所有设置之后 - DeserializationConfig、DeserializerProvider 等，我最终得到了一个非常混乱的 hack，我在其中解析为 JSON 树，使用自定义 JsonGenerator 输出它，该 JsonGenerator 将字段名称小写，并且然后将其解析为对象。

```
MappingJacksonHttpMessageConverter mc = new MappingJacksonHttpMessageConverter() {
    @Override
    protected Object readInternal(Class<?> clazz, HttpInputMessage inputMessage) throws IOException, HttpMessageNotReadableException {
        return this.getObjectMapper().readValue(translateToLowerCaseKeys(inputMessage.getBody()), getJavaType(clazz));
    }

    private byte[] translateToLowerCaseKeys(InputStream messageBody) throws IOException {
        StringWriter sw = new StringWriter();
        JsonGenerator lowerCaseFieldNameGenerator = new JsonGeneratorDelegate(this.getObjectMapper().getJsonFactory().createJsonGenerator(sw)) {
            @Override
            public void writeFieldName(String name) throws IOException, org.codehaus.jackson.JsonGenerationException {
                delegate.writeFieldName(name.toLowerCase());
            };
        };
        this.getObjectMapper().writeTree(lowerCaseFieldNameGenerator, this.getObjectMapper().readTree(messageBody));
        lowerCaseFieldNameGenerator.close();
        return sw.getBuffer().toString().getBytes();
    }
}; 
```

这个解决方案似乎效率很低。有一个适用于地图键的[解决方案](https://gist.github.com/1260489)，但我无法为字段名称找到类似的解决方案。

另一种解决方案是使用两个设置器，一个使用旧字段名称进行注释。必须扩展命名策略以忽略这些字段，在我的情况下这很好，因为对象映射器不会使用 UPPER_UNDERSCORE 策略处理任何其他类：

```
public class JsonNamingTest {
    public static class CaseInsensitive extends LowerCaseWithUnderscoresStrategy {
        public String translate(String in) {
            return (in.toUpperCase().equals(in) ? in : super.translate(in));
        }
    }

    public static class A {
        private String testField;
        public String getTestField() {
            return testField;
        }
        public void setTestField(String field) {
            this.testField = field;
        }
        @JsonProperty("TEST_FIELD")
        public void setFieldAlternate(String field) {
            this.testField = field;
        }
    }

    @Test
    public void something() throws Exception {
        A test = new A();
        test.setTestField("test");
        ObjectMapper mapper = new ObjectMapper().setPropertyNamingStrategy(new CaseInsensitive());
        assertEquals("{\"test_field\":\"test\"}", mapper.writeValueAsString(test));
        assertEquals("test", mapper.readValue("{\"test_field\":\"test\"}", A.class).getTestField());
        assertEquals("test", mapper.readValue("{\"TEST_FIELD\":\"test\"}", A.class).getTestField());
    }
} 
```

这比以前的解决方案更理想，但每个字段都需要两个带注释的设置器 - 一个用于新格式，一个用于支持旧格式。

有没有人遇到过让杰克逊对反序列化字段名称不区分大小写的方法，或者就此而言接受字段名称的多个别名？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2015-03-16T20:21:36.127

自 Jackson 2.5.0 起，此问题已得到修复。

```
ObjectMapper mapper = new ObjectMapper();
mapper.configure(MapperFeature.ACCEPT_CASE_INSENSITIVE_PROPERTIES, true); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-09T20:50:38.687

您可以使用 PropertyNamingStrategy：

```
 class CaseInsensitiveNaming extends PropertyNamingStrategy {
    @Override
    public String nameForGetterMethod(MapperConfig<?> config,
         AnnotatedMethod method, String defaultName)
    {
      // case-insensitive, underscores etc. mapping to property names
      // so you need to implement the convert method in way you need.
      return convert(defaultName); 
    }
  }

  objectMapper.setPropertyNamingStrategy(new CaseInsensitiveNaming()); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-31T14:48:36.867

由于您使用的是 Jackson 1.x 而不是 Jackson 2.x，因此您可以使用 MixIns。据我了解，您希望反序列化理解 UPPER_CASE 但您想以小写字母进行序列化。在反序列化配置中添加 MixIn，但不在序列化配置中，如下所示：

```
public class JsonNamingTest {   
    public static class A {
        private String testField;
        public String getTestField() {
            return testField;
        }
        public void setTestField(String field) {
            this.testField = field;
        }
    }

    public static class MixInA {
        @JsonProperty("TEST_FIELD")
        public void setTestField(String field) {}
    }

    @Test
    public void something() throws Exception {
        A test = new A();
        test.setTestField("test");
        ObjectMapper mapper = new ObjectMapper();
        mapper.getDeserializationConfig().addMixInAnnotations(A.class, MixInA.class);
        assertEquals("{\"test_field\":\"test\"}", mapper.writeValueAsString(test));
        assertEquals("test", mapper.readValue("{\"test_field\":\"test\"}", A.class).getTestField());
        assertEquals("test", mapper.readValue("{\"TEST_FIELD\":\"test\"}", A.class).getTestField());
    }
} 
```

但是，您不能在 Jackson 2.x 中做到这一点：mixIn 由序列化和反序列化配置共享。我还没有找到使用 Jackson 2.x 处理别名的方法 :(

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-24T08:53:25.920

使用 Spring Boot 时，也可以使用[Jackson2ObjectMapperBuilderCustomizer](https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/autoconfigure/jackson/Jackson2ObjectMapperBuilderCustomizer.html)，它保留了默认的自动配置。这可以通过添加一个bean来完成：

```
@Bean
public Jackson2ObjectMapperBuilderCustomizer acceptCaseInsensitive() {
    return builder -> builder.featuresToEnable(MapperFeature.ACCEPT_CASE_INSENSITIVE_PROPERTIES);
} 
```

# javascript - 获取backbone.js中的下一个和上一个元素

> ID：10079619
> 
> 赞同：1
> 
> 时间：2012-04-09T20:45:22.973
> 
> 标签：javascript, backbone.js

假设我在主干中有一个集合，我希望能够找到给定元素的上一个和下一个元素。请假设元素可以动态删除和添加。

```
var MyModel=Backbone.Model.extend({
 nextElement: function(){
//????
},
previousElement:function(){
//?????
}
});

var MyCollectionType=Backbone.Collection.extend({
model:MyModel;
});
var collection=new MyCollectionType 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-09T21:23:22.580

将模型添加到集合时，该`collection`属性将添加到引用它所在集合的模型中。您可以在 nextElement 和 previousElement 方法中使用此属性。

```
var MyModel = Backbone.Model.extend({
  initialize: function() {
    _.bindAll(this, 'nextElement', 'previousElement');
  },

  nextElement: function() {
    var index = this.collection.indexOf(this);
    if ((index + 1) === this.collection.length) {
      //It's the last model in the collection so return null
      return null;
    }
    return this.collection.at(index + 1);
  },

  previousElement: function() {
    var index = this.collection.indexOf(this);
    if (index === 0 ) {
      //It's the first element in the collection so return null
      return null;
    }
    return this.collection.at(index - 1);
  }
} 
```

然而，这似乎是收藏应该有的问题，而不是模型`nextElement`。`previousElement`您是否考虑过将这些功能放在集合上而不是模型上？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-02T20:47:53.450

它被作为一个骨干问题进行了讨论

[https://github.com/jashkenas/backbone/issues/136](https://github.com/jashkenas/backbone/issues/136)

林森

它可以是这样的你总是可以使用新的模型方法来解决这个问题：

```
getRelative: function(direction) {
    return this.collection.at(this.collection.indexOf(this) + direction);
} 
```

因此，如果您通过 -1，它将获得前一个，而 1 将获得下一个。如果它没有找到任何东西，它将返回 -1。

# asp.net - 绑定TextBox时如何调用方法

> ID：10079622
> 
> 赞同：4
> 
> 时间：2012-04-09T20:45:40.227
> 
> 标签：asp.net

我想在 EditItemTemplate 中绑定（）一个 TextBox，但我需要在显示之前将文本框的原始值传递给一个函数。我的目标是在显示值之前对其进行格式化。这是一个复杂的格式化规则，所以我不能使用任何内置的格式化程序。使用 Eval() 很容易做到，但使用 Bind() 就另当别论了。我知道它可以使用代码隐藏中的事件来完成，但我试图从 aspx 页面完成这一切。

例子：

```
<EditItemTemplate>
        <asp:TextBox ID="NameTextBox" Text=<%# Bind("Name") %> MaxLength="255" runat="server" />
</EditItemTemplate> 
```

谢谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T21:48:37.170

您不能从标记中执行此操作。ASP.NET 有一个特殊代码来解析`Bind`语法并为其生成特殊代码。这就是为什么双向数据绑定不支持除`Bind()`. 您可以在Eilon Lipton的[ASP.NET 数据绑定如何处理 Eval() 和 Bind() 语句](http://weblogs.asp.net/leftslipper/archive/2007/06/29/how-asp-net-databinding-deals-with-eval-and-bind-statements.aspx)一文中找到更多信息：

> 令许多读者惊讶的是，ASP.NET 中没有绑定方法！当 ASP.NET 解析您的文件并看到您正在使用数据绑定表达式（在尖括号百分比格式中`"<%# %>"`）时，它具有特殊情况代码来解析`Bind`语法并为其生成一些特殊代码。当您使用`<%# Bind("Name") %>`它时，它不是真正的函数调用。如果 ASP.NET 解析代码并检测到`Bind()` 语句，它会将语句分成两部分。第一部分是单向数据绑定部分，最终只是一个常规 `Eval()`调用。第二部分是反向部分，它通常是一些代码，`"string name = TextBox1.Text"` 可以从绑定的位置获取值。
> 
> Non-Bind() 数据绑定语句是文字代码（我们 `CodeSnippetExpressions`在 中使用`CodeDom`），因此允许使用您选择的语言的任意代码。但是，因为 ASP.NET 必须解析 `Bind()`语句，所以双向数据绑定不支持除`Bind()`. 例如，以下语法是无效的，因为它试图调用任意代码并同时使用`Bind()`： `<%# FormatNameHelper(Bind("Name")) %>`双向数据绑定中支持的唯一格式是`Bind("field")`和`Bind("field", "format string {0}")`。

因此，请考虑在代码隐藏中执行此操作，或者改用`Eval`方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:51:09.713

像这样的东西应该非常接近你正在寻找的东西：

```
<asp:TextBox Id="TextBox1" runat="server" Text='<%# FormatValue(Eval("Name"), Container.DisplayItemIndex) %>' /> 
```

在代码隐藏中：

```
public object FormatValue(object value, int itemIndex)
{
    var input = GridView1.Rows[itemIndex].FindControl("TextBox1") as TextBox;
    if (input != null)
    {
        //do whatever you need with the old value
        var oldValue = input.Text.Trim();
    }

    //format the value and send it back
    return string.Format("My name is {0}", value);
} 
```

# c++ - C++ - 继承虚函数实现

> ID：10079624
> 
> 赞同：1
> 
> 时间：2012-04-09T20:45:46.203
> 
> 标签：c++, qt

如果我要从一个类继承，我是否必须定义它的所有虚函数和纯虚函数？

例如，我有一个继承自`QAbstractItemModel`. `QAbstractItemModel`具有以下纯虚函数。如果我的派生类不打算使用`index()`and`parent()`方法，我需要实现它吗？

```
//qabstractitemmodel.h
virtual QModelIndex index(int row, int column,
                              const QModelIndex &parent = QModelIndex()) const = 0;
virtual QModelIndex parent(const QModelIndex &child) const = 0;
virtual int rowCount(const QModelIndex &parent = QModelIndex()) const = 0;
virtual int columnCount(const QModelIndex &parent = QModelIndex()) const = 0;
virtual QVariant data(const QModelIndex &index, int role = Qt::DisplayRole) const = 0; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:49:24.437

你根本不需要在你的派生类中实现任何东西，但是如果你让任何纯虚成员函数没有实现，那么派生类仍然是抽象的（换句话说，你将无法实例化一个该类的对象）。

**编辑：** 要考虑的其他事情 - 如果您的基类包含您的派生类不想要/不需要的纯虚函数，也许值得考虑另一种设计？也许使用多个声明接口不同部分的基类。

如果`index()`并且`parent()`不适用于所有派生类，`QAbstractItemModel`那么我认为这些函数可能不属于`QAbstractItemModel`真正的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:49:43.673

是的。将方法声明为纯虚拟（'= 0'）意味着任何具体的子类（可以实例化）都必须实现它们。

# c++ - C++ 运行时检查失败 #0 - ESP 的值未在函数调用中正确保存

> ID：10079625
> 
> 赞同：9
> 
> 时间：2012-04-09T20:45:46.287
> 
> 标签：c++, dll

我正在尝试使用 C++ 对 motorbee 进行编程

当我运行代码时，出现以下错误：

> 运行时检查失败 #0 - ESP 的值未在函数调用中正确保存。这通常是调用使用一种调用约定声明的函数和使用另一种调用约定声明的函数指针的结果。

这是我的代码。

```
#include "stdafx.h"
#include <iostream>
#include "windows.h"
#include "mt.h"
using namespace std;

HINSTANCE BeeHandle= LoadLibrary("mtb.dll"); 
Type_InitMotoBee InitMotoBee;
Type_SetMotors SetMotors;
Type_Digital_IO Digital_IO;
void main ()
{   
    InitMotoBee = (Type_InitMotoBee)GetProcAddress( BeeHandle,"InitMotoBee");
    SetMotors =(Type_SetMotors)GetProcAddress(BeeHandle,"SetMotors");
    Digital_IO =(Type_Digital_IO)GetProcAddress(BeeHandle,"Digital_IO ");
    InitMotoBee();

    SetMotors(0, 50, 0, 0, 0, 0, 0, 0, 0);

} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-09T21:12:56.517

您的`typedef`函数指针需要与您正在使用的库的[调用约定相匹配。](http://msdn.microsoft.com/en-us/library/k2b2ssfy.aspx)例如，如果`InitMotoBee`使用，[`cdecl`](http://msdn.microsoft.com/en-us/library/zkwh89ks.aspx)您`typedef`将如下所示：

```
typedef bool (__cdecl *Type_InitMotoBee)(void) 
```

该`SetMotors`函数需要参数，因此也需要为此正确设置调用约定（这可能是应用程序失败的地方）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-05-10T23:28:06.220

错误消息告诉您 ESP 寄存器（堆栈指针）没有正确“维护”。它没有应有的价值。

当您使用非托管语言（如 C 或 C++）进行函数调用时，函数的参数会被推送到堆栈 - 增加堆栈指针。当函数调用返回时，参数被弹回 - 减少堆栈指针。

堆栈指针必须始终恢复到函数调用之前的相同值。

## 调用约定

调用约定精确地指定应如何维护堆栈，以及调用者或被调用者是否负责将参数从堆栈中弹出。

例如，在 stdcall 调用约定中，调用*ee*负责在函数返回之前恢复堆栈指针。在 cdecl 调用约定中，调用*者*负责。

很明显，混合调用约定是不好的！如果调用者正在使用*stdcall*，则它期望调用*ee*来维护堆栈。如果调用*ee*使用 cdecl，它期望调用*er*维护堆栈。最终结果：没有人维护堆栈！或者相反的例子：每个人都在维护堆栈，这意味着它被恢复两次并最终出错。

作为参考，请查看[这个 StackOverflow 问题](https://stackoverflow.com/questions/3404372/stdcall-and-cdecl)。

Raymond Chen 有一篇关于这个主题的好[博文。](https://blogs.msdn.microsoft.com/oldnewthing/20040108-00/?p=41163/)

## 您应该使用哪种调用约定？

这超出了这个答案的范围，但是如果你正在做 C# 到 C 的互操作，那么了解什么调用约定是很重要的。

在 Visual Studio 中，C/C++ 项目的默认调用约定是 cdecl。

在 .Net 中，使用 DllImport 进行互操作调用的默认调用约定是 stdcall。这也适用于代表。（大多数本机 Windows 函数使用 stdcall。）

考虑以下（**不正确**的）互操作调用。

```
[DllImport("MyDll", EntryPoint = "MyDll_Init"]
public static extern void Init(); 
```

它使用 stdcall 调用约定，因为这是 .Net 的默认设置。如果您没有更改 MyDLL 项目的 Visual Studio 项目设置，您很快就会发现这不起作用。C/C++ DLL 项目的默认值为 cdecl。

正确的互操作调用是：

```
[DllImport("MyDll", EntryPoint = "MyDll_Init", CallingConvention = CallingConvention.Cdecl)]
public static extern void Init(); 
```

请注意显式 CallingConvention 属性。C# 互操作包装器将知道生成 cdecl 调用。

## 还有什么问题？

如果您确定您的调用约定是正确的，您可能仍然会遇到运行时检查失败 #0。

## 编组结构

回想一下，函数参数在函数调用开始时被压入堆栈，然后在结束时再次弹出。为了确保正确维护堆栈，参数的大小必须在 push 和 pop 之间保持一致。

在本机代码中，编译器将为您处理这个问题。你永远不需要考虑。当谈到 C 和 C# 之间的互操作时，您可能会被咬。

如果您在 C# 中有 stdcall 委托，则如下所示：

```
public delegate void SampleTimeChangedCallback(SampleTime sampleTime); 
```

它对应于一个 C 函数指针，如下所示：

```
typedef void(__stdcall *SampleTimeChangedCallback)(SampleTime sampleTime); 
```

一切都应该没问题。您在双方都使用相同的调用约定（C# 互操作默认使用 stdcall，我们在本机代码中明确设置 __stdcall）。

但是看看那些参数：SampleTime 结构。它们都具有相同的名称，但一个是本机结构，另一个是 C# 结构。

本机结构看起来像这样：

```
struct SampleTime
{
    __int64 displayTime;
    __int64 playbackTime;
} 
```

C# 结构如下所示：

```
[StructLayout(LayoutKind.Explicit, Size = 32)]
public struct SampleTime
{
    [FieldOffset(0)]
    private long displayTime;

    [FieldOffset(8)]
    private long playbackTime;
} 
```

查看 C# 结构上的 Size 属性 - 这是错误的！两个 8 字节长表示 16 字节大小。也许有人删除了一些字段并且未能更新 Size 属性。

现在，当本机代码使用 stdcall 调用 SampleTimeChangedCallback 函数时，我们遇到了问题。

回想一下，在 stdcall 中，*被调用者*（即被调用的函数）负责恢复堆栈。

所以：调用者将参数压入堆栈。在此示例中，这发生在本机代码中。编译器知道参数的大小，因此保证堆栈指针递增的值是正确的。

然后执行该函数 - 请记住，实际上这是 ac# 委托。

由于我们使用 stdcall，被调用者（c# 委托）负责恢复堆栈。但是在 C# 领域，我们对编译器撒了谎，告诉它 SampleTime 结构的大小是 32 字节，而实际上它只有 16 个字节。

我们违反了[单一定义规则](https://en.wikipedia.org/wiki/One_Definition_Rule)。

C# 编译器别无选择，只能相信我们告诉它的内容，因此它将堆栈指针“恢复”32 字节。

当我们返回调用站点（在本地）时，堆栈指针尚未正确恢复，所有赌注都已关闭。

如果幸运的话，您会遇到运行时检查 #0。如果您不走运，该程序可能不会立即崩溃。您可以确定的一件事：您的程序不再执行您认为的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-21T00:05:44.750

我最终将编译器选项从 /RTC1（实际上是 /RTCs 和 /RTCu）更改为 /RTCu。 [http://support.microsoft.com/kb/822039](http://support.microsoft.com/kb/822039)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-26T13:30:30.170

我遇到了类似的问题，出现了相同的错误消息。

我通过以下方式解决了它。就我而言，当我尝试将成员函数作为回调传递给线程以执行异步调用时，问题就出现了。该类本身是由可执行项目调用的 DLL（子组件）的一部分。

```
OGLModel::~OGLModel() {
  std::thread delVertexThread(&OGLModel::AsyncDisposeVertices, this, vertices);
  delVertexThread.join();
}

void OGLModel::AsyncDisposeVertices(std::vector<OGLVertex> *vertices)
{

  std::cout << "OGLModel garbage collection active..";
  if (vertices != 0) {
    std::vector<OGLVertex> *swap = new std::vector<OGLVertex>();
    vertices->swap(*swap);
    delete vertices;
  }
  std::cout << "OGLModel garbage collection finished..";
} 
```

成员函数的声明`OGLModel::AsyncVertexDispose`是通过`virtual`在标头中使用来执行的。删除`virtual`限定符后，ESP 错误消息消失了。

我对此没有有效的解释，但有一些想法。我认为它与 c++ 如何处理其在内存中的成员函数调用（静态内存分配、动态内存分配）有关。您可以看看[静态内存分配和动态内存分配之间的区别](https://stackoverflow.com/questions/8385322/difference-between-static-memory-allocation-and-dynamic-memory-allocation)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-15T14:04:49.840

使用 Visual Studio 2019 DLL 时遇到类似问题，该 DLL 在内部使用了使用 Microsoft 特定`__thiscall`调用约定的 Visual Studio 2017 编写的第 3 方库。我需要在 Delphi 7 应用程序中调用回调。在早期版本的 MSVC 中，DLL 使用`__cdecl`调用约定，所以我的回调在 Delphi 中定义为：

```
TExternalProcCallbackDetectorError = procedure(dwError: DWORD); cdecl; 
```

这种类型的原型过去曾与许多 VS2003 DLL 一起使用，没有任何问题。但是当VS2019 C++ DLL调用回调时，调用了Delphi代码……然后`Run-Time Check Failure #0`抛出异常。灾难！

在摸索了一段时间后，我偶然发现了这个答案，尤其是@Rob's（感谢Rob！）。Delphi 不支持`__thiscall`，但将 Delphi 原型更改为以下解决了该问题：

```
TExternalProcCallbackDetectorError = procedure(dwError: DWORD); stdcall; 
```

# css - 样式表的最大尺寸

> ID：10079626
> 
> 赞同：-1
> 
> 时间：2012-04-09T20:45:48.420
> 
> 标签：css

有人可以告诉它在开始减慢网页速度之前单个样式表可以得到多大（以 kb 或 mb 为单位）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:48:59.760

没有这样定义的限制，大于这个 css 文件会使网页变慢。对于一般用途，它并不是真正的限制，除非是特殊情况。jQuery，我相信其他框架有很大的 CSS 文件，这没问题。

# linq - Linq to Entities 查询非原始类型

> ID：10079627
> 
> 赞同：0
> 
> 时间：2012-04-09T20:46:00.197
> 
> 标签：linq, entity-framework, linq-to-entities

我有我写的这个方法：

```
private void GetReceivedInvoiceTasks(User user, List<Task> tasks)
        {
            var taskList = from i in _db.Invoices
                           join a in user.Areas on i.AreaId equals a.AreaId
                           where i.Status == InvoiceStatuses.Received
                           select i;

        } 
```

基本上，我试图在用户区域的数据库中获取状态为已收到的所有发票。我现在不太了解 LINQ。

我收到错误：

> base {System.SystemException} = {“无法创建类型为‘Models.Area’的常量值。在此上下文中仅支持原始类型（‘例如 Int32、String 和 Guid’）。”}

有人可以向我解释我做错了什么以及如何解决这个问题吗？我目前无法理解问题所在。如果我`join`把这条线拿出来很好，但我真的需要这条线来确保我只有来自用户区域的发票（它们可以属于多个区域）。我对这个查询有什么根本错误吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T20:52:20.027

实体框架不支持与内存中集合的联接。您将不得不重新连接您的查询，以使用`Contains`带有原语集合的查询。

此外，EF 当前不支持枚举值，因此您必须与整数值进行比较（如果`InvoiceStatuses.Received`不是`enum`值则忽略此部分）。

这两个修复组合导致以下查询方法，该方法应导致与您的联接等效的结果：

```
int statusReceived = (int)InvoiceStatuses.Received;
var areaIds = user.Areas.Select(x=> x.AreaId).ToArray();

var taskList = from i in _db.Invoices
               where i.Status == statusReceived && areaIds.Contains(i.AreaId)
               select i; 
```

# sql-server - Xquery中[1]的意义是什么

> ID：10079628
> 
> 赞同：4
> 
> 时间：2012-04-09T20:46:02.350
> 
> 标签：sql-server, tsql, sql-server-2005, xquery, xquery-sql

我是 SQL Server 中的 xquery 新手。

我经常遇到使用带有属性的 [1] 的 xquery 表达式。

有人可以解释一下这是什么意思吗？

这是一个例子

```
declare @aa xml
set @aa='<data>
  <row>
    <Value>1</Value>
    <Text>Masters</Text>
  </row>
  <row>
    <Value>2</Value>
    <Text>Transactions</Text>
  </row>
  <row>
    <Value>3</Value>
    <Text>Misch. Reports</Text>
  </row>
</data>'

select a.f.value('Value[1]','varchar(50)'),   --  why [1] here ?
   a.f.value('Text[1]','varchar(50)')         --  and here too..
 from @aa.nodes('/data/row') as a(f) 
```

谢谢n问候

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-09T21:00:24.950

在 XPath 中，`[expression]`语法表示位置路径上的[谓词。](http://www.w3.org/TR/xpath/#NT-LocationPath)`[1]`是 的[缩写语法](http://www.w3.org/TR/xpath/#path-abbrev)，`[position()=1]`表示“第一个元素”。在 SQL Server 中使用 XPath `[1]`（或任何其他确定性过滤到最多一个元素的谓词）是必需的，因为它将 XPath 表达式从返回任意数量元素的表达式转换为确定性返回 0 或 1 个元素的表达式，从而转换为一个标量表达式，这[`.value()`](http://msdn.microsoft.com/en-us/library/ms178030.aspx)需要：

> XQuery 最多只能返回一个值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T20:51:03.130

在这种情况下，您是说您想要`Value`当前`/data/row`的第一个`Text`元素和相同的第一个元素。如果你把a放在`[2]`那里，这将意味着第二个。即使在您知道只有一行的地方也放置一个 [1]，您会感到安全，只有一个元素会进入`value`函数。

# android - 如何在广播接收器上设置振动和声音

> ID：10079630
> 
> 赞同：2
> 
> 时间：2012-04-09T20:46:14.907
> 
> 标签：android, alarmmanager

我有一个实现警报的类。接收器类是一个广播接收器，我希望它在闹钟响起时振动并播放默认的闹钟声音。但它不会让我在广播接收器类中使用 getSystemService 。

我猜这是因为它不是一项活动并且不能使用它，但我该如何解决这个问题？我应该将接收类更改为活动类还是警报对话活动？大家有什么建议？

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:49:40.510

你可以使用它。我在我的广播接收器中做到这一点。

```
 AudioManager audioManager = (AudioManager) context.getSystemService(Context.AUDIO_SERVICE); 
```

你有错误信息吗？还是源代码？

请注意，广播接收器最多只能持续 10 秒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:50:55.923

getSystemService 方法是[Context](http://developer.android.com/reference/android/content/Context.html#getSystemService%28java.lang.String%29)类的一部分。在您的广播接收器中，您将获得一个`Context`带有广播意图的实例。上下文将是活动上下文或应用程序上下文，具体取决于广播接收器的注册方式。

您应该能够使用此`Context`实例来调用`getSystemService`，如下所示：

```
public final void onReceive(Context context, Intent intent) {
    AlarmManager am = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
} 
```

# java - 安卓多点触控不工作

> ID：10079631
> 
> 赞同：0
> 
> 时间：2012-04-09T20:46:19.950
> 
> 标签：java, android, multi-touch, touchscreen, android-2.1-eclair

我最近一直在尝试为我的应用程序使用多点触控，但找不到任何解决我的问题的帮助，我发布了我遇到问题的代码。我正在使用 API 级别为 7 的旧 adk，多点触控可用于运行 2.1 的 android 吗？

谢谢

```
@Override
    public boolean onTouchEvent(MotionEvent event) {
            super.onTouchEvent(event);

            int action = event.getAction() & MotionEvent.ACTION_MASK;

            switch (action) {
            case MotionEvent.ACTION_DOWN: {
                float tx = event.getX();
                float ty = event.getY();
                if (tx > joystick.getWidth() - joystick.getWidth() && tx < (joystick.getWidth() / 3) && ty > getHeight() - joystick.getHeight()) {
                    left();
                    invalidate();
                }
                if (tx > (joystick.getWidth()/3)*2 && tx < (joystick.getWidth()) && ty > getHeight() - joystick.getHeight()) {
                    right();
                    invalidate();
                }
                if (tx > getWidth() - button.getWidth() - (button.getWidth() / 4)
                        && ty > getHeight() - button.getHeight()
                                - (button.getHeight() / 4)) {
                    jump();
                    invalidate();
                }else{jump_true = 0 ;
                jump_is = true;}
                    break;
            }
            case MotionEvent.ACTION_MOVE: {
                float txm = event.getX();
                float tym = event.getY();
                if (txm > joystick.getWidth() - joystick.getWidth() && txm < (joystick.getWidth() / 3) && tym > getHeight() - joystick.getHeight()) {
                    left();
                    right = false;
                    invalidate();
                }
                if (txm > getWidth() - button.getWidth() - (button.getWidth() / 4)
                        && tym > getHeight() - button.getHeight()
                                - (button.getHeight() / 4)) {
                    //jump();
                    //invalidate();
                }else{
                    //jump_true = 0 ;
                    //jump_is = true;
                }
                if (txm > (joystick.getWidth()/3)*2 && txm < (joystick.getWidth()) && tym > getHeight() - joystick.getHeight()) {
                    right();
                    left = false;
                    invalidate();
                }
                if (txm > getWidth() - button.getWidth() - (button.getWidth() / 4)
                        && tym > getHeight() - button.getHeight()
                                - (button.getHeight() / 4)) {
                    jump();
                    invalidate();
                }else{jump_true = 0 ;
                jump_is = true;}
                    break;
            }

            case MotionEvent.ACTION_POINTER_DOWN: {
                float txp = event.getX();
                float typ = event.getY();
                if (txp > getWidth() - button.getWidth() - (button.getWidth() / 4)
                        && typ > getHeight() - button.getHeight()
                                - (button.getHeight() / 4)) {
                    jump();
                    invalidate();
                }else{jump_true = 0 ;
                jump_is = true;}

                if (txp > joystick.getWidth() - joystick.getWidth() && txp < (joystick.getWidth() / 3) && typ > getHeight() - joystick.getHeight()) {
                    left();
                    right = false;
                    invalidate();
                }
                if (txp > getWidth() - button.getWidth() - (button.getWidth() / 4)
                        && typ > getHeight() - button.getHeight()
                                - (button.getHeight() / 4)) {
                    //jump();
                    //invalidate();
                }else{
                    //jump_true = 0 ;
                    //jump_is = true;
                }
                if (txp > (joystick.getWidth()/3)*2 && txp < (joystick.getWidth()) && typ > getHeight() - joystick.getHeight()) {
                    right();
                    left = false;
                    invalidate();
                }
            break;
            }
            case MotionEvent.ACTION_POINTER_UP: {
                touch_up();
                invalidate();
                    break;
            }
            case MotionEvent.ACTION_UP: {
                touch_up();
                invalidate();
                    break;
            }
            }

            return true;
    }

    private void touch_up() {
        left = false;
        right = false;
        jump_true = 0 ;
        jump_is = true;
    }

    private void left() {
        left = true;
    }
    private void right(){
        right = true;
    }
    private void jump() {
        jump_true=1;
        jump_done = false;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:53:45.203

是的，多点触控适用于 2.0 及更高版本。请参阅[http://androidandme.com/2009/10/news/android-2-0-does-indeed-feature-multitouch/](http://androidandme.com/2009/10/news/android-2-0-does-indeed-feature-multitouch/)。

此外，使用 logcat 确保您的运动事件被触发。

# ruby-on-rails - 在 Rails 模型中使用 Naturalsorter gem

> ID：10079633
> 
> 赞同：0
> 
> 时间：2012-04-09T20:46:24.610
> 
> 标签：ruby-on-rails, ruby, arrays, refactoring

我正在使用“naturalsorter”gem 按代码对一组项目（ActiveRecord 对象）进行排序

在控制器上：

```
@items = Item.all
@items = Naturalsorter::Sorter.sort_version_by_method(@items, :code) 
```

但我需要重构这个并将排序方法放在模型上

你好！我试过了：

```
class Item < ActiveRecord::Base 
   def self.by_code
      Naturalsorter::Sorter.sort_version_by_method(self, 'code')
   end 
end 
```

但我确定这不是办法......所以我明白了

```
undefined method `sort_by_code' for #<Array:0x007ff0b4c431d0> 
```

有什么想法？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T07:05:35.280

也许你应该改变这一行：

```
 Naturalsorter::Sorter.sort_version_by_method(self, 'code') 
```

像这样：

```
 Naturalsorter::Sorter.sort_version_by_method(self.all, :code) 
```

但是我没试过！

# css - 将 display:table DIV 包装在另一个具有精确高度的 div 中

> ID：10079644
> 
> 赞同：0
> 
> 时间：2012-04-09T20:47:17.093
> 
> 标签：css, html

这让我很头疼，我只需要问一下。我在 C#、Java、SQL 或 JS 方面似乎从来没有遇到过 CSS 方面的问题，而且我花了太多时间试图弄清楚。

我有一个表格 div 和里面的一些行和单元格 div。我只想让表格 div 具有精确的高度。

[![我的表格 div 的图片](../Images/992eeea4c751bdc38d5a63deb3293063.png)](https://i.stack.imgur.com/cysSF.jpg)

```
My current style:
div .table
{
    width: 410px;
    height: 410px;
    max-height: 410px;        
    display: table;
    border-spacing: 10px; 
    border-style:dotted;
    border-width:medium;     
    overflow: visible;
} 
```

我还需要做什么才能使 div 精确到 410 px 高？

我尝试将它包装在一个外部 div 中（图片中有蓝色边框，具有特定的高度和 display:block），但 table div 似乎没有注意到它。我在底部添加了一个带有 clear:both 的 div，有时它会有所帮助，但今天没有......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T21:35:23.620

看起来：

```
display:table; 
```

将强制元素扩展以填充内容的宽度。即使您将“溢出”设置为隐藏。

这里有一些例子：

[http://jsfiddle.net/dRLfv/](http://jsfiddle.net/dRLfv/)

我认为你需要做一个常规的“显示：块”，然后适当地设置溢出。这可能需要您为内部的表格/表单元素调整一些其他样式，但这应该是双重的，我相信其他人会很乐意提供帮助。

我希望这会有所帮助！

干杯!

# .net-4.0 - 仅异步启动一个任务来处理静态队列，完成后停止

> ID：10079645
> 
> 赞同：1
> 
> 时间：2012-04-09T20:47:30.040
> 
> 标签：.net-4.0, parallel-processing, task-parallel-library

基本上我有一个我想要处理的对象的静态自定义队列。从多个线程中，我需要启动一个将处理排队对象的单个任务，当所有项目都出队时停止任务。

一些伪代码：

```
static CustomQueue _customqueue;
static Task _processQueuedItems;

public static void EnqueueSomething(object something) {
    _customqueue.Enqueue(something);
    StartProcessingQueue();
}

static void StartProcessingQueue() {
   if(_processQueuedItems != null) {
      _processQueuedItems = new Task(() => {
        while(_customqueue.Any()) {
            var stuffToDequeue = _customqueue.Dequeue();
            /* do stuff */
        }
      });
     _processQueuedItems.Start();
   }
   if(_processQueuedItems.Status != TaskStatus.Running) {
      _processQueuedItems.Start();
   }
} 
```

如果它有所不同，我的自定义队列是一个基本上保存项目直到它们达到一定年龄的队列，然后允许它们出列。每次触摸一个项目时，它的计时器都会重新启动。我知道这件作品很好。

我正在努力解决的部分是并行性。（显然，我不知道我在这里做什么）。**我想要的是让一个线程处理队列直到它完成，然后离开。如果另一个调用进来，它不会启动一个新线程，除非它必须这样做。**

我希望这可以解释我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:00:05.480

您可能要考虑[`BlockingCollection<T>`](http://msdn.microsoft.com/en-us/library/dd267312.aspx)在此处使用。您可以让您的自定义队列实现`IProducerConsumerCollection`，在这种情况下，BC 可以直接使用它。

然后，您只需要启动一个长时间运行的任务来调用`blockingCollection.GetConsumingEnumerable()`和处理 foreach 中的项目。当集合为空时任务会自动阻塞，当有新项目时会重新启动`Enqueued`。

# jquery - 视图之间的动画淡入淡出过渡断断续续或不运行

> ID：10079649
> 
> 赞同：0
> 
> 时间：2012-04-09T20:47:34.723
> 
> 标签：jquery, asp.net-mvc, razor

我有一个带有多个视图的原型/演示 ASP.MVC 3 应用程序。当用户在它们之间导航时，设计师希望当前内容淡出，然后新内容淡出。使用 jQuery 来淡化 div 似乎很简单，但通常内容会闪烁、卡顿或根本不淡化。（淡入淡出似乎效果很好。）

每个视图处理其淡出，例如：

```
 $("tr").mousedown(function () {
            $("#innercontainer").fadeOut(250, function () {
                window.location.href = '@Url.Action("Application360", "Tofino")?an=' + appName;
            });
        }
    }); 
```

布局 (_AppLayout.cshtml) 处理淡出备份，例如：

```
 $(document).ready(function () {
        $("#innercontainer").animate({ opacity: '0' }, 0, function () {
            $("#innercontainer").delay(400).animate({ opacity: '1' }, { duration: 'fast', easing: 'swing' });
        });
    }); 
```

有没有更好的方法可以让动画更流畅、更可靠？

# c# - 关于默认的 Random by Seed，它会在不同的系统中改变吗？

> ID：10079653
> 
> 赞同：1
> 
> 时间：2012-04-09T20:47:46.963
> 
> 标签：c#, random

我知道默认的 c# Random() 是一个伪随机数序列。我只需要这样一个，我不是在寻找真正随机的这个问题。

请允许我提问：

我试过了：`new Random(100000000).Next(999999999)`，我得到了 145156561，就像[其他人说](https://stackoverflow.com/questions/5264412/why-does-random-next-always-return-the-same-number)的那样。

我的问题是：**相同种子的伪随机数序列**会在不同系统（win2003、win2008、mono 等）、不同 .net 版本（.net 3、.net 4、c#2、c#3 等）下发生变化，还是在任何其他环境下会改变吗？

我只想知道，一旦我编码，现在和将来，我是否总是会在任何地方*通过相同的种子获得相同的伪随机数序列*？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T20:50:12.613

不可靠。一般来说，弄清楚这种事情的方法是查看文档（MSDN for .NET）。如果算法没有被描述并且不是其他已发布算法的实现，则应将其视为实现细节并且可能会发生变化。

你也需要非常严格地阅读这些文档——如果有解释的余地​​，你需要假设最坏的情况。在这种情况下：http: [//msdn.microsoft.com/en-us/library/system.random.aspx](http://msdn.microsoft.com/en-us/library/system.random.aspx)仅声明：

> 为不同的 Random 对象提供相同的种子值会导致每个实例产生相同的随机数序列。

它适用于框架：

> 支持：4、3.5、3.0、2.0、1.1、1.0 .NET Framework 客户端配置文件
> 
> 支持：4、3.5 SP1 可移植类库
> 
> 支持：可移植类库

这并没有说明它是否保证在任何未来版本中都以相同的方式工作，或者您是否会从各种受支持的框架中获得相同的结果。事实上，它指出：

> **来电者须知**
> 
> Random 类中随机数生成器的实现不能保证在 .NET Framework 的主要版本中保持不变。因此，您的应用程序代码不应假定相同的种子会在不同版本的 .NET Framework 中产生相同的伪随机序列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T20:50:15.467

实现这一目标的最佳方法是实现您自己的随机数生成器。看看[http://www.agner.org/random/](http://www.agner.org/random/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T20:54:24.000

不，这[不保证](http://msdn.microsoft.com/en-us/library/system.random(v=vs.110).aspx)适用于不同的 .NET 版本：

> Random 类的当前实现基于 Donald E. Knuth 的减法随机数生成器算法。

注意单词*current*的使用；这意味着它可以在框架的更高版本中被替换。[（这在 Chris Shain 的帖子中提到](https://stackoverflow.com/a/10079684/27528)的引用中也明确表示。

如果您想 100% 确定您可以在所有未来版本中复制该序列，请包含您自己的 PRNG，例如[Mersenne Twister](http://en.wikipedia.org/wiki/Mersenne_twister)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-09T20:57:48.993

根据[Random 类](http://msdn.microsoft.com/en-us/library/ts6se2ek.aspx)的 MSDN 。

> **来电者须知**
> 
> Random 类中随机数生成器的实现不能保证在 .NET Framework 的主要版本中保持不变。因此，您的应用程序代码不应假定相同的种子会在不同版本的 .NET Framework 中产生相同的伪随机序列。

所以你不能使用`Random`和依赖你会得到相同的序列。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-04-30T01:30:07.977

正如[Chris Shain 的精彩回答](https://stackoverflow.com/a/10079684/684852)所阐明的那样：您不能依赖于不同平台甚至 .NET 的主要版本上的结果相同

[我们在@BlueLineGames](http://twitter.com/bluelinegames)遇到了这个确切的问题，因为我们使用 MonoGame 编写了一个游戏，该游戏在 Windows 的 .NET 中运行，但是当它在 OSX 的 Mono 上运行时产生了不同的值。

正如史蒂夫建议的那样，编写自己的 PRNG 是一个很好的解决方案。希望它可以为其他人节省一些时间，这里有一个可以代替 System.Random 的类和一些快速使用信息。

```
/// <summary>
/// This class is a drop-in replacement to use instead of Random(). Its
/// main purpose is to work identically across multiple platforms for a given
/// seed value - whereas the Random class is not guaranteed to give the
/// same results on different platforms even when the seed is the same.
/// 
/// This is an implementation of a Linear Congruential Generator which is
/// a very simple pseudorandom number generator. It is used instead of Random()
/// since Random() is implemented differently in Mono than .NET (and even
/// between different major-versions of .NET).
/// 
/// This is NOT recommended to be used for anything that should be secure such
/// as generating passwords or secret tokens. A "cryptogrpahically secure pseudorandom
/// number generator" (such as Mersenne Twister) should be used for that, instead.
/// 
/// More about Linear Congruential Generators can be found here:
/// http://en.wikipedia.org/wiki/Linear_congruential_generator
/// </summary>
public class CrossPlatformRandom : Random
{
    // To start with, we'll be using the same values as Borland Delphi, Visual Pascal, etc.
    // http://en.wikipedia.org/wiki/Linear_congruential_generator#Parameters_in_common_use
    private const int LCG_MULTIPLIER = 134775813; // 0x08088405
    private const int LCG_INCREMENT = 1;

    private int _seed;

    /// <summary>
    /// Initializes a new instance of the CrossPlatformRandom class, using a time-dependent
    /// default seed value.
    /// 
    /// Please note that this values generated from this are NOT guaranteed to be the same
    /// cross-platform because there is no seed value. In cases where the caller requires
    /// predictable or repeatable results, they MUST specify the seed.
    /// </summary>
    public CrossPlatformRandom()
    {
        // System.Random is time-dependent, so we will just use its first number to generate
        // the seed.
        Random rand = new Random();
        this._seed = rand.Next();
    }

    /// <summary>
    /// Initializes a new instance of the System.Random class, using the specified seed value.
    /// </summary>
    /// <param name="seed">A number used to calculate a starting value for the pseudo-random number sequence. If a negative number is specified, the absolute value of the number is used.</param>
    public CrossPlatformRandom(int seed)
    {
        _seed = seed;
    }

    private int GetNext() // note: returns negative numbers too
    {
        _seed = (_seed * LCG_MULTIPLIER) + LCG_INCREMENT;
        return _seed;
    }

    /// <summary>
    //  Returns a nonnegative random number.
    /// </summary>
    /// <returns>A 32-bit signed integer greater than or equal to zero and less than System.Int32.MaxValue.</returns>
    public override int Next()
    {
        return this.Next(int.MaxValue);
    }

    /// <summary>
    /// Returns a nonnegative random number less than the specified maximum.
    /// </summary>
    /// <param name="maxValue">The exclusive upper bound of the random number to be generated. maxValue must be greater than or equal to zero.</param>
    /// <returns> A 32-bit signed integer greater than or equal to zero, and less than maxValue; that is, the range of return values ordinarily includes zero but not maxValue. However, if maxValue equals zero, maxValue is returned.</returns>
    /// <exception cref="System.ArgumentOutOfRangeException">maxValue is less than zero.</exception>
    public override int Next(int maxValue)
    {
        if (maxValue < 0)
        {
            throw new System.ArgumentOutOfRangeException("maxValue is less than zero.");
        }

        ulong result = (ulong)(uint)GetNext() * (ulong)(uint)maxValue;
        return (int)(result >> 32);
    }

    /// <summary>
    /// Returns a random number within a specified range.
    /// </summary>
    /// <param name="minValue">The inclusive lower bound of the random number returned.</param>
    /// <param name="maxValue">The exclusive upper bound of the random number returned. maxValue must be greater than or equal to minValue.</param>
    /// <returns>A 32-bit signed integer greater than or equal to minValue and less than maxValue; that is, the range of return values includes minValue but not maxValue. If minValue equals maxValue, minValue is returned.</returns>
    /// <exception cref="System.ArgumentOutOfRangeException">minValue is greater than maxValue.</exception>
    public override int Next(int minValue, int maxValue)
    {
        if (minValue > maxValue)
        {
            throw new System.ArgumentOutOfRangeException("minValue is greater than maxValue.");
        }

        return minValue + this.Next(maxValue - minValue);
    }

    /// <summary>
    /// Fills the elements of a specified array of bytes with random numbers.
    /// </summary>
    /// <param name="buffer">An array of bytes to contain random numbers.</param>
    /// <exception cref="System.ArgumentNullException">buffer is null.</exception>
    public override void NextBytes(byte[] buffer)
    {
        if (buffer == null)
        {
            throw new System.ArgumentNullException("buffer is null.");
        }

        for (int index = 0; index < buffer.Length; index++)
        {
            buffer[index] = (byte)this.Next((int)byte.MaxValue);
        }
    }

    /// <summary>
    /// Returns a random number between 0.0 and 1.0.
    /// </summary>
    /// <returns>A double-precision floating point number greater than or equal to 0.0, and less than 1.0.</returns>
    public override double NextDouble()
    {
        return this.Sample();
    }

    /// <summary>
    /// Returns a random number between 0.0 and 1.0.
    /// 
    /// Since System.Random no longer uses this as the basis for all of the other random methods,
    /// this method isn't used widely by this class. It's here for completeness, primarily in case Random
    /// adds new entry points and we are lucky enough that they base them on .Sample() or one of the other existing methods.
    /// </summary>
    /// <returns>A double-precision floating point number greater than or equal to 0.0, and less than 1.0.</returns>
    protected override double Sample()
    {
        return ((double)this.Next() / (double)int.MaxValue);
    }
} 
```

您应该能够安全地删除此类，而不是使用任何 Random()，但您实际上只需要在使用种子构造它的地方执行此操作（例如：new Random(seedValue)）。

一些示例用法：

```
int seed = 42;
CrossPlatformRandom r = new CrossPlatformRandom(seed);
for (int i = 0; i < 10; ++i)
    Console.WriteLine(r.Next(100)); 
```

# google-chrome-extension - Chrome扩展程序中createNotification中的图标错误

> ID：10079658
> 
> 赞同：0
> 
> 时间：2012-04-09T20:48:13.847
> 
> 标签：google-chrome-extension, icons

在我的 Chrome 扩展程序中，我使用 webkitNotifications.createNotification 来提醒用户。这是一个很棒的工具！在给出的示例代码中，第一个参数是可选的，并指定一个图标，并且 Google 说明声称它可以是本地引用。当我使用本地文件时，我得到一个损坏的图像链接。当我使用位于此处的通知演示示例时，甚至会发生这种情况 - [http://code.google.com/chrome/extensions/samples.html#f799e26ceef2367cf836f24bcb47df4398b0df58](http://code.google.com/chrome/extensions/samples.html#f799e26ceef2367cf836f24bcb47df4398b0df58)

还有其他人有这个问题吗？

该图标列在我的清单文件中。

我可以通过使用完整的网络参考来解决这个问题，但我喜欢使用这个工具来通知错误，有时错误是由互联网访问中断引起的。

我正在使用 chrome 版本 18.0.1025.151 m。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T10:13:43.230

他们的样本的问题是他们已经包含`"manifest_version": 2`在他们的清单中，但没有添加一个`"web_accessible_resources"`列表，哪些资源应该可用于页面。
您可以在此处阅读有关 manifest_version 2 及其引入的更改的更多信息......
[http://code.google.com/chrome/extensions/manifestVersion.html](http://code.google.com/chrome/extensions/manifestVersion.html)
...以及有关 web_accessible_resources 的信息......
[http://code .google.com/chrome/extensions/manifest.html#web_accessible_resources](http://code.google.com/chrome/extensions/manifest.html#web_accessible_resources)

要解决示例中的问题，您可以删除清单版本 2 位（甚至文档说这暂时不需要）。或者您可以将以下内容添加到清单中......

```
"web_accessible_resources": [
    "48.png"
  ] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T20:06:16.897

“Web 可访问”表示正在从您的服务器访问资源，因此您必须确保在您的 javascript 和清单、json 中包含资源的路径。

# ruby-on-rails - Rails 3 自动完成 gem 与 belongs_to 关联

> ID：10079665
> 
> 赞同：1
> 
> 时间：2012-04-09T20:48:49.713
> 
> 标签：ruby-on-rails, autocomplete, associations

我正在使用[rails3-jquery-autocomplete gem](https://github.com/crowdint/rails3-jquery-autocomplete)，并且在将它用于模型中存在的字段时它工作得很好。但是，我一直在尝试将它用于关联，但我不知道如何使它工作。所以让我们解释一下我所拥有的：

**型号**：

```
class Receipt < ActiveRecord::Base
  belongs_to :user
end

class User < ActiveRecord::Base
  has_many :receipts
end 
```

**控制器**

```
class Admin::ReceiptsController < AdminController
 autocomplete :user, :name
  def index
    @receipts = Receipt.all
  end
  def show
    @receipt = Receipt.find_by_id(params[:id])
  end
  def edit
    @receipt = Receipt.find_by_id(params[:id])
    @users = User.all
  end
end 
```

**查看（表格）**：

```
<%= form_for(@receipt, :url => admin_receipt_path, :html => { :multipart => true }) do |f| %>
 <div class="clearfix">
  <%= f.label :value, "Value($)" %>
  <div class="input"><%= f.text_field :value %></div>
 </div>
 <div class="clearfix">
  <%= f.label :user_id, "User" %>
  <div class="input">
   <%= f.autocomplete_field :user_id, autocomplete_user_name_admin_receipts_path %>
  </div>
 </div>
..... 
```

问题是......我能够获取用户名，但我想实际将用户 ID 存储在那里。当管理员尝试编辑与关联用户的现有收据时，我想以同样的方式显示名称。我可以用这个下拉菜单做的事情：

```
<div class="clearfix">
 <%= f.label :user_id, "User" %>
 <div class="input"><%= f.select :user_id, @users.collect {|p| [ p.name, p.id ] },{:prompt => 'Select a User'} %></div>
</div> 
```

我看不到如何用这颗宝石做到这一点....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T21:22:46.557

Ryan Bates 对此进行了截屏。干净且解释清楚

[截屏](http://railscasts.com/episodes/102-auto-complete-association-revised)

如果您不想订阅，请尝试 torrent

# jquery - jQuery - 循环插件暂停/播放按钮

> ID：10079668
> 
> 赞同：2
> 
> 时间：2012-04-09T20:49:01.057
> 
> 标签：jquery, plugins, cycle

我正在使用[http://jquery.malsup.com/cycle/上的 Cycle Slider 插件](http://jquery.malsup.com/cycle/)

我在底部添加了带有图像的用户控件（左箭头表示上一个，右箭头表示下一个，两个条表示播放/暂停）。Prev 和 Next 按钮完美运行。我被困在播放/暂停按钮上。

我不知道如何在单击时将图像更改为播放符号，并在再次单击时更改为暂停符号。

这是当前代码：

```
<script type="text/javascript">
$(document).ready(function() 
{$('#slides').cycle({ pager: '#slideshow_links', pause: 1, speed: 1200, timeout: 6000,  next: '#next',prev: '#prev', cleartype:  true, cleartypeNoBg:  true });});</script> 
```

这是HTML。理想情况下，“暂停/播放”按钮应位于那里的两个按钮之间。

```
 <div id="controls">
    <span><a href="" id="prev"><img src="/images/left.gif" width="14" height="11" alt="Previous" title="Previous" style="border:0;"></a></span>
    <span><a href="" id="next"><img src="/images/right.gif" width="14" height="11" alt="Next" title="Next" style="border:0;"></a></span>
</div> 
```

我已经查看了网站中的示例列表，但我对 jQuery 相当缺乏经验，因此不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:00:01.127

[http://jsfiddle.net/Gcqfu/](http://jsfiddle.net/Gcqfu/)

```
<div id="controls">
    <span><a href="#" id="prev"><img src="/images/left.gif" width="14" height="11" alt="Previous" title="Previous" style="border:0;"></a></span>
     <span><a href="#" id="pauseOrPlay" data-playing='false'><img src="/images/play.gif" width="14" height="11" alt="Play" title="Play" style="border:0;"></a></span>
    <span><a href="#" id="next"><img src="/images/right.gif" width="14" height="11" alt="Next" title="Next" style="border:0;"></a></span>
</div> 
```

js：

```
$("#pauseOrPlay").on("click", function(e) {
    e.preventDefault();
   var $this = $(this),
        playing = $this.data("playing"),
        $slides = $("#slides");
   if (!playing)
   {
       $this.data("playing", true);
       $this.children("img:first").attr("src", "/images/pause.gif").attr("title", "Pause").attr("alt", "Pause");  
       // call play for the plugin here
       $slides.cycle('resume');
   } 
    else
    {
        $this.data("playing", false);
       $this.children("img:first").attr("src", "/images/play.gif").attr("title", "Play").attr("alt", "Play");  
       // call pause for the plugin here 
       $slides.cycle('pause');
    }    
}); 
```

# android - Android中其他应用程序的权限

> ID：10079669
> 
> 赞同：-1
> 
> 时间：2012-04-09T20:49:10.630
> 
> 标签：android

我正在尝试在我的应用程序中使用另一个第三方应用程序。基本上使用第三方应用程序的一些服务。但是这些服务需要在第三方应用程序中定义自定义权限。所以我在我的应用程序清单文件中添加了这些权限。

假设如果我的应用程序是在安装第三方应用程序之前安装的，那么它将不会获得这些权限，因此如果我尝试从第三方应用程序访问服务，我会收到安全异常。

有没有办法再次请求权限或任何其他建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:55:35.423

您在清单中请求的权限是您的应用无论何时安装都将获得的权限。时期。授予另一个应用程序的权限只能由该应用程序访问。如果您需要使用某个权限，它应该在您的清单中。如果存在，将在安装时向用户请求许可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T02:25:53.993

这实际上是自定义权限的已知限制。即使你的两个应用程序都需要先安装定义自定义权限的应用程序，否则你会遇到异常。如果您控制这两个应用程序，则需要在两个应用程序中定义它。否则，实际上没有解决方法：需要让系统知道要授予的权限。

BTW，你*可以*使用第三方权限，只要不是签名权限，要求你的应用使用相同的密钥签名。

# jquery - 无法使 blueimp/jQuery.fileupload 插件工作

> ID：10079670
> 
> 赞同：7
> 
> 时间：2012-04-09T20:49:12.160
> 
> 标签：jquery, file-upload, cross-domain

我正在尝试使用这个 jQuery 插件进行跨域图像上传[jQuery.fileupload](https://github.com/blueimp/jQuery-File-Upload/wiki/Basic-plugin)

我认为该插件使用 require.js，我已经包含了它，因为我使用它为我的页面加载 javascript 代码。该插件似乎不需要我包含require.js，但是当我测试我的页面时出现此错误

> 未捕获的错误：不匹配的匿名定义（）模块：函数（$，未定义）{ [http://requirejs.org/docs/errors.html#mismatch](http://requirejs.org/docs/errors.html#mismatch)

有人可以指出我正确的方向吗

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-07-03T17:47:30.937

你不需要使用 Requirejs 来使用 jQuery 文件上传。

只需确保以正确的顺序包含[所需的文件：](https://github.com/blueimp/jQuery-File-Upload#requirements)

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
<!-- The jQuery UI widget factory, can be omitted if jQuery UI is already included -->
<script src="js/vendor/jquery.ui.widget.js"></script>
<!-- The Iframe Transport is required for browsers without support for XHR file uploads -->
<script src="js/jquery.iframe-transport.js"></script>
<!-- The basic File Upload plugin -->
<script src="js/jquery.fileupload.js"></script>
<script>
$(function () {
    $('#fileupload').fileupload({
        // your options
    });
});
</script> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-24T14:08:19.280

我很高兴我在这里并不孤单。这个问题花了我几个小时，这是给你的答案，

这就是加载这些 JavaScript 文件的顺序。您必须按以下顺序包含文件，否则它将不起作用。

*   jquery-min.js
*   jquery.ui.widget.js
*   jquery.iframe-transport.js
*   jquery.fileupload.js
*   jquery.fileupload-ip.js
*   jquery.fileupload-ui.js
*   require-min.js（这必须是最后一个被包含的）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T20:58:15.153

这可能是函数名称之间的冲突，请尝试 jQuery.noConflict()。或 RequireJS 优化器。

[http://requirejs.org/docs/optimization.html](http://requirejs.org/docs/optimization.html) http://api.jquery.com/jQuery.noConflict/

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T03:59:24.430

`<script>`您很可能会收到此错误，因为您正在使用标准标记加载包含您的 define() 规则的 JavaScript 文件。

如果你想让 require 工作，你需要使用 require 提供的依赖框架来加载文件，也就是说，通过从代码的其他部分访问它：

```
define(
'jquery'
function($){
   // use $.fileupload here
}) 
```

# php - 如何上传多个文件

> ID：10079680
> 
> 赞同：1
> 
> 时间：2012-04-09T20:49:49.117
> 
> 标签：php, mysql, image, file-upload, upload

我喜欢在我的网站上发布一些图片。

当我只使用一张图片时，它适用于单个帖子。当我尝试使用多个图像时，它不再起作用，我不明白为什么这不起作用。显示我的代码：

```
if (isset($_POST['var1'];
 ...
 ...        $Bild1 = $_FILES['image1']; 
            $Bild2 = $_FILES['image2'];
            $Bild3 = $_FILES['image3'];
            $Bild4 = $_FILES['image4']; 
            $Bild5 = $_FILES['image5'];
            $Bild6 = $_FILES['image6'];
            $Bild7 = $_FILES['image7'];
            $Bild8 = $_FILES['image8'];
            $Bild9 = $_FILES['image9'];
            $Bild10 = $_FILES['image10'];

                $errors = array();
                $allowed_extension = array('jpg', 'jpeg', 'png', 'bmp', 'tiff', 'gif');

                $file_name_1 = $_FILES['image1']['name'];
                $file_name_2 = $_FILES['image2']['name'];
                $file_name_3 = $_FILES['image3']['name'];
                $file_name_4 = $_FILES['image4']['name'];
                $file_name_5 = $_FILES['image5']['name'];
                $file_name_6 = $_FILES['image6']['name'];
                $file_name_7 = $_FILES['image7']['name'];
                $file_name_8 = $_FILES['image8']['name'];
                $file_name_9 = $_FILES['image9']['name'];
                $file_name_10 = $_FILES['image10']['name'];

                $split_1 = explode('.', $file_name_1);  
                $split_2 = explode('.', $file_name_2);
                $split_3 = explode('.', $file_name_3);
                $split_4 = explode('.', $file_name_4);
                $split_5 = explode('.', $file_name_5);
                $split_6 = explode('.', $file_name_6);
                $split_7 = explode('.', $file_name_7);
                $split_8 = explode('.', $file_name_8);
                $split_9 = explode('.', $file_name_9);
                $split_10 = explode('.', $file_name_10);

                $split_1[0] = '1';
                $split_2[0] = '2';
                $split_3[0] = '3';
                $split_4[0] = '4';
                $split_5[0] = '5';
                $split_6[0] = '6';
                $split_7[0] = '7';
                $split_8[0] = '8';
                $split_9[0] = '9';
                $split_10[0] = '10';

                $file_basename_1 = $split_1[0];
                $file_basename_2 = $split_2[0];
                $file_basename_3 = $split_3[0];
                $file_basename_4 = $split_4[0];
                $file_basename_5 = $split_5[0];
                $file_basename_6 = $split_6[0];
                $file_basename_7 = $split_7[0];
                $file_basename_8 = $split_8[0];
                $file_basename_9 = $split_9[0];
                $file_basename_10 = $split_10[0];

                $file_extension_1 = strtolower(end(explode('.', $file_name_1)));
                $file_extension_2 = strtolower(end(explode('.', $file_name_2)));
                $file_extension_3 = strtolower(end(explode('.', $file_name_3)));
                $file_extension_4 = strtolower(end(explode('.', $file_name_4)));
                $file_extension_5 = strtolower(end(explode('.', $file_name_5)));
                $file_extension_6 = strtolower(end(explode('.', $file_name_6)));
                $file_extension_7 = strtolower(end(explode('.', $file_name_7)));
                $file_extension_8 = strtolower(end(explode('.', $file_name_8)));
                $file_extension_9 = strtolower(end(explode('.', $file_name_9)));
                $file_extension_10 = strtolower(end(explode('.', $file_name_10)));

                $file_size_1 = $_FILES['image1']['size'];
                $file_size_2 = $_FILES['image2']['size'];
                $file_size_3 = $_FILES['image3']['size'];
                $file_size_4 = $_FILES['image4']['size'];
                $file_size_5 = $_FILES['image5']['size'];
                $file_size_6 = $_FILES['image6']['size'];
                $file_size_7 = $_FILES['image7']['size'];
                $file_size_8 = $_FILES['image8']['size'];
                $file_size_9 = $_FILES['image9']['size'];
                $file_size_10 = $_FILES['image10']['size'];

                $file_tmp_1 = $_FILES['image1']['tmp_name'];
                $file_tmp_2 = $_FILES['image2']['tmp_name'];
                $file_tmp_3 = $_FILES['image3']['tmp_name'];
                $file_tmp_4 = $_FILES['image4']['tmp_name'];
                $file_tmp_5 = $_FILES['image5']['tmp_name'];
                $file_tmp_6 = $_FILES['image6']['tmp_name'];
                $file_tmp_7 = $_FILES['image7']['tmp_name'];
                $file_tmp_8 = $_FILES['image8']['tmp_name'];
                $file_tmp_9 = $_FILES['image9']['tmp_name'];
                $file_tmp_10 = $_FILES['image10']['tmp_name'];

                $file_newname_1 = $file_basename_1 .".". $file_extension_1;
                $file_newname_2 = $file_basename_2 .".". $file_extension_2;
                $file_newname_3 = $file_basename_3 .".". $file_extension_3;
                $file_newname_4 = $file_basename_4 .".". $file_extension_4;
                $file_newname_5 = $file_basename_5 .".". $file_extension_5;
                $file_newname_6 = $file_basename_6 .".". $file_extension_6;
                $file_newname_7 = $file_basename_7 .".". $file_extension_7;
                $file_newname_8 = $file_basename_8 .".". $file_extension_8;
                $file_newname_9 = $file_basename_9 .".". $file_extension_9;
                $file_newname_10 = $file_basename_10 .".". $file_extension_10;

                $path ='a/b/c/'.$id.'/'.$new_file_id.'/';

                if (in_array($file_extension_1, $allowed_extension)=== false){
                    $errors[] = 'errormessage1';
                }
                if (in_array($file_extension_2, $allowed_extension)=== false){
                    $errors[] = 'errormessage2';
                }
                if (in_array($file_extension_3, $allowed_extension)=== false){
                    $errors[] = 'errormessage3';
                }
                if (in_array($file_extension_4, $allowed_extension)=== false){
                    $errors[] = 'errormessage4';
                }
                if (in_array($file_extension_5, $allowed_extension)=== false){
                    $errors[] = 'errormessage5';
                }
                if (in_array($file_extension_6, $allowed_extension)=== false){
                    $errors[] = 'errormessage6';
                }
                if (in_array($file_extension_7, $allowed_extension)=== false){
                    $errors[] = 'errormessage7';
                }
                if (in_array($file_extension_8, $allowed_extension)=== false){
                    $errors[] = 'errormessage8';
                }
                if (in_array($file_extension_9, $allowed_extension)=== false){
                    $errors[] = 'errormessage9';
                }
                if (in_array($file_extension_10, $allowed_extension)=== false){
                    $errors[] = 'errormessage10';
                }

                if ($file_size_1 > 2097152){
                    $errors[] = 'errormessage1';
                }
                if ($file_size_2 > 2097152){
                    $errors[] = 'errormessage2';
                }
                if ($file_size_3 > 2097152){
                    $errors[] = 'errormessage3';
                }
                if ($file_size_4 > 2097152){
                    $errors[] = 'errormessage4';
                }
                if ($file_size_5 > 2097152){
                    $errors[] = 'errormessage5';
                }
                if ($file_size_6 > 2097152){
                    $errors[] = 'errormessage6';
                }
                if ($file_size_7 > 2097152){
                    $errors[] = 'errormessage7';
                }
                if ($file_size_8 > 2097152){
                    $errors[] = 'errormessage8';
                }
                if ($file_size_9 > 2097152){
                    $errors[] = 'errormessage9';
                }
                if ($file_size_10 > 2097152){
                    $errors[] = 'errormessage10';
                }

                if (empty($errors)) {

                if (move_uploaded_file($file_tmp_1, $path . $file_newname_1)) {
                    echo 'success1'; 
                }

                if (move_uploaded_file($file_tmp_2, $path . $file_newname_2)) {
                    echo 'success2'; 
                }

                if (move_uploaded_file($file_tmp_3, $path . $file_newname_3)) {
                    echo 'success3'; 
                }

            } 
```

还有一种方法可以缩短此代码吗？多谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T20:52:43.250

你这样做是错误的。您的代码中有很多冗余

```
$allowed_extension = array('jpg', 'jpeg', 'png', 'bmp', 'tiff', 'gif');
foreach($_FILES as $file) {
   // Carry on like this
   $file_name = $file['name'];
   $size = $file['size'];

   //However, you might want to extract the extension like this
   $ext = pathinfo($file_name, PATHINFO_EXTENSION);
   //...

} 
```

# postgresql - PostgreSQL 中的 COPY 函数

> ID：10079682
> 
> 赞同：10
> 
> 时间：2012-04-09T20:49:58.767
> 
> 标签：postgresql, csv, postgresql-copy

我想使用 PostgreSQL 中的 COPY 函数将 CSV 文件导入 PostgreSQL 数据库。

在[文档](http://www.postgresql.org/docs/8.1/static/sql-copy.html)中提到文件名的地方，CSV 文件是否必须存储在特定位置，或者是否可以存储在任何位置。

例如，`copy data_table from '/tmp/outputdata.csv' WITH DELIMITER AS ',' CSV QUOTE AS '"';`。它在哪里说`tmp`，这是否意味着 C: 驱动器中的 tmp 文件夹。可以更改为另一个文件夹名称吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-09T21:04:11.717

看起来您对 Linux 与 Windows 文件路径表示法感到困惑。你所拥有的是一个锚定到 root 的 Linux 路径。Windows 使用驱动器号，您也可以在 Windows 上运行时指定驱动器号。

如果您使用 Windows 表示法，请注意在不使用时必须*转义反斜杠*[`standard_conforming_strings = on`](https://www.postgresql.org/docs/current/runtime-config-compatible.html#GUC-STANDARD-CONFORMING-STRINGS)- 这是 Postgres 9.1 或更高版本中的默认值，但在旧版本中不是。像：

```
COPY data_table from E'C:\\tmp\\outputdata.csv' WITH ... 
```

你`standard_conforming_strings = on`可以简单地写：

```
COPY data_table from 'C:\tmp\outputdata.csv' WITH ... 
```

请注意，PostgreSQL Windows 服务器还可以理解带有斜杠而不是反斜杠的默认路径表示法。

对于 SQL [`COPY FROM / TO`](https://www.postgresql.org/docs/current/sql-copy.html)，您可以使用服务器进程所有者（`postgres`默认情况下）具有读/写权限的任何路径。

对于[`\copy`](https://www.postgresql.org/docs/current/app-psql.html)psql 客户端的 meta 命令，应用当前本地用户的权限。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-09T20:53:41.503

是的，当然您可以指定您具有读取权限的任何位置。更改文件的路径没有问题。

请只注意在 Windows 上您必须以这种方式转义反斜杠的事实：

```
copy data_table from 'c:\\Temp\\outputdata.csv' WITH DELIMITER AS ',' CSV QUOTE AS '"'; 
```

# .net - 如何使用oracle将水晶报表导出为pdf

> ID：10079686
> 
> 赞同：1
> 
> 时间：2012-04-09T20:50:20.073
> 
> 标签：.net, oracle, crystal-reports

尝试导出为 pdf 时出现 InvalidComObjectException 错误。我认为这可能与连接到 oracle 有关，但不确定。SetDatabaseLogon 似乎偏爱 Sql Server。该报告调用数据的存储过程，并使用 Business Objects XIR2 服务工作。我也可以查看报告并在设计器内部进行连接。

'CrystalDecisions.CrystalReports.Engine 13.0.2000.0' .NET Framework 4.0 的水晶报告

```
Imports CrystalDecisions.CrystalReports.Engine
Imports CrystalDecisions.ReportAppServer.DataDefModel
Imports CrystalDecisions.Shared
Imports CrystalDecisions.ReportSource

   Public Overloads Function CreateReport(ByVal reportFileName As String, ByVal reportTitle As String, ByVal outputDirectory As String, _
ByVal isFullPath As Boolean, ByVal outputFormat As OutputFormat, ByVal crystalParameter As CrystalParameter) As String

      Dim baseReportsSourcePath As String = "C:\ADSTAX\SUITES\RFL\Letters\"
      Dim baseReportsOutputPath As String = "C:\PDF_Exports\"

      Dim fullFilepath As String = baseReportsSourcePath + reportFileName

      'check report exists
      If File.Exists(fullFilepath) = False Then Throw New FileNotFoundException("File:" + fullFilepath + " does not exist", fullFilepath)

      Dim doc As ReportDocument = New ReportDocument()
      doc.Load(fullFilepath)

      'set parameters
      If crystalParameter.Name = CrystalParameterName.DistributionKey Then

         doc.SetParameterValue("DISTRIBUTIONKEY", crystalParameter.Value)

      ElseIf crystalParameter.Name = CrystalParameterName.RequestKey Then

         doc.SetParameterValue("REQUESTKEY", crystalParameter.Value)

      End If

      'user, pass, server, database
      doc.SetDatabaseLogon("user", "pass")

      'build full output filename
      Dim exportFileName As String = Path.GetFileNameWithoutExtension(reportFileName)
      exportFileName += Guid.NewGuid.ToString + ".pdf"
      Dim fullOuputFilePath As String = baseReportsOutputPath + exportFileName

      'export to pdf
      doc.ExportToDisk(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat, fullOuputFilePath)

      'check report created
      If File.Exists(fullFilepath) = False Then
         Return String.Empty
      End If

      Return fullOuputFilePath

   End Function 
```

下面的错误：

```
System.Runtime.InteropServices.InvalidComObjectException was unhandled
  Message=COM object that has been separated from its underlying RCW cannot be used.
  Source=mscorlib
  StackTrace:
       at System.StubHelpers.StubHelpers.StubRegisterRCW(Object pThis, IntPtr pThread)
       at System.Runtime.InteropServices.ComTypes.IConnectionPoint.Unadvise(Int32 dwCookie)
       at CrystalDecisions.ReportAppServer.ISCDClientDocumentEvents_EventProvider.RemoveOnClosed(_ISCDClientDocumentEvents_OnClosedEventHandler handler)
       at CrystalDecisions.ReportAppServer.ISCDClientDocumentEvents_EventProvider.remove_OnClosed(_ISCDClientDocumentEvents_OnClosedEventHandler value)
       at CrystalDecisions.ReportAppServer.ReportClientDocumentWrapper.DisconnectEventRelay()
       at CrystalDecisions.ReportAppServer.ReportClientDocumentWrapper.InternalClose(Boolean bSetupForNextReport, Boolean bAutoClose)
       at CrystalDecisions.ReportAppServer.ReportClientDocumentWrapper.Dispose(Boolean bDisposeManaged)
       at System.ComponentModel.Component.Dispose()
       at CrystalDecisions.CrystalReports.Engine.ReportDocument.ClearCache(Boolean clearDocument)
       at CrystalDecisions.CrystalReports.Engine.ReportDocument.InternalClose(Boolean bSetupForNextReport)
       at CrystalDecisions.CrystalReports.Engine.ReportDocument.Close()
       at CrystalDecisions.CrystalReports.Engine.ReportDocument.ExitHandler(Object sender, EventArgs e)
  InnerException: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:46:04.110

在许多水晶问题之后，这就是最终的工作。许多其他人都获得了信誉。我主要是发现需要什么，然后拼凑其他人的工作以找到解决方案。

您还需要添加对：CrystalDecisions.ReportAppServer.DataDefModel.dll 的引用

```
Imports CrystalDecisions.ReportAppServer.DataDefModel

   Public Overloads Function CreateReport(ByVal reportFileName As String, ByVal reportTitle As String, ByVal outputDirectory As String, _
ByVal isFullPath As Boolean, ByVal outputFormat As OutputFormat, ByVal crystalParameter As CrystalParameter) As String

      Dim baseReportsSourcePath As String = "C:\data\ReportTemplates\Correspondence\" '"C:\ADSTAX\SUITES\RFL\Letters\"
      Dim baseReportsOutputPath As String = "C:\PDF_Exports\"

      Dim fullFilepath As String = baseReportsSourcePath + reportFileName

      'check report exists
      If File.Exists(fullFilepath) = False Then Throw New FileNotFoundException("File:" + fullFilepath + " does not exist", fullFilepath)

      'build crystal
      Dim startCreateDoc As Long = DateTime.Now.Ticks
      Dim doc As ReportDocument = New ReportDocument()

      Dim tsc As New TimeSpan(startCreateDoc - DateTime.Now.Ticks)
      Trace.WriteLine(fullFilepath + " Report create time:" + tsc.ToString)

      Dim startLoad As Long = DateTime.Now.Ticks
      doc.Load(fullFilepath)

      Dim ts As New TimeSpan(startLoad - DateTime.Now.Ticks)
      Trace.WriteLine(fullFilepath + " Report Load time:" + ts.ToString)

      CrystalLogin(doc, "service", "user", "password")

      'set parameters
      If crystalParameter.Name = CrystalParameterName.DistributionKey Then
         doc.ApplyParameters("DISTRIBUTIONKEY=" + crystalParameter.Value)
      ElseIf crystalParameter.Name = CrystalParameterName.RequestKey Then
         doc.ApplyParameters("REQUESTKEY=" + crystalParameter.Value)
      End If

      'build full output filename
      Dim exportFileName As String = Path.GetFileNameWithoutExtension(reportFileName)
      exportFileName += "_"
      exportFileName += Guid.NewGuid.ToString + ".pdf"
      Dim fullOuputFilePath As String = baseReportsOutputPath + exportFileName

      'export to pdf
      'doc.ExportToDisk(ExportFormatType.PortableDocFormat, fullOuputFilePath)
      Dim pdfOps As CrystalDecisions.Shared.PdfFormatOptions = CrystalDecisions.Shared.ExportOptions.CreatePdfFormatOptions

      Dim eo As New CrystalDecisions.Shared.ExportOptions
      eo.ExportFormatType = ExportFormatType.PortableDocFormat
      eo.ExportDestinationType = ExportDestinationType.DiskFile
      eo.ExportFormatOptions = pdfOps

      'Dim htmlOps As CrystalDecisions.Shared.HTMLFormatOptions = CrystalDecisions.Shared.ExportOptions.CreateHTMLFormatOptions
      'htmlOps.HTMLFileName = fullOuputFilePath
      'eo.ExportFormatOptions = htmlOps

      Dim dop As DiskFileDestinationOptions = CrystalDecisions.Shared.ExportOptions.CreateDiskFileDestinationOptions
      dop.DiskFileName = fullOuputFilePath

      eo.ExportDestinationOptions = dop

      doc.Export(eo)
      doc.Close()

      'check report created
      If File.Exists(fullFilepath) = False Then
         Return String.Empty
      End If

      Return fullOuputFilePath

   End Function

   Public Shared Sub CrystalLogin(mainInRD As ReportDocument, dataSource As String, userId As String, pwd As String)
      Try
         'now update logon info for all sub-reports
         If Not mainInRD.IsSubreport AndAlso mainInRD.Subreports IsNot Nothing AndAlso mainInRD.Subreports.Count > 0 Then
            For Each rd As ReportDocument In mainInRD.Subreports
               CrystalLogin(rd, dataSource, userId, pwd)
            Next
         End If
      Catch
      End Try
      'do the main reports database
      Dim logonInfo As TableLogOnInfo = Nothing
      For Each table As CrystalDecisions.CrystalReports.Engine.Table In mainInRD.Database.Tables
         logonInfo = table.LogOnInfo
         logonInfo.ConnectionInfo.ServerName = dataSource
         logonInfo.ConnectionInfo.DatabaseName = ""
         logonInfo.ConnectionInfo.UserID = userId
         logonInfo.ConnectionInfo.Password = pwd
         table.ApplyLogOnInfo(logonInfo)

   'This part was needed to support the oracle store procs we use to obtain the data
         Dim prop As PropertyInfo = Nothing
         prop = table.[GetType]().GetProperty("RasTable", BindingFlags.NonPublic Or BindingFlags.Instance)
         Dim rasTable As ISCRTable = Nothing
         rasTable = DirectCast(prop.GetValue(table, Nothing), ISCRTable)
         table.Location = rasTable.QualifiedName
         'Console.Out.WriteLine(table.Name)
         'Console.Out.WriteLine(rasTable.QualifiedName)
      Next

   End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T02:29:56.397

1.  执行数据集以填充 oracle 存储过程中的数据。确保数据集中的表名与设计报表所基于的数据库对象的名称相同。（本例中为存储过程名称）

2.  不要提供任何登录信息。**这很重要**。

3.  设置所有报表参数，但不提供任何数据过滤器，因为数据集包含已过滤的数据。

4.  手动进行数据绑定。

    *doc.SetDataSource=你的数据源；*

现在像往常一样继续进行报告导出。

这是填充报告的**推送模型**方式。通常我使用 oledb dataadapter for oracle 来设计报告。但是如果你正在处理存储过程，那么推送模型是唯一的方法。设计人员可以访问 oracle SP 并填充报告，但在应用程序中您必须处理它，否则您将看到询问存储过程参数值的烦人弹出窗口。

这是一些代码

```
OracleConnection cn = new OracleConnection("Data Source=yourdbname;User ID=someid;password=somepw;Pooling=true;Connection Lifetime=30;Min Pool Size=5;Max Pool Size=100");

OracleParameter DETAILS = new OracleParameter();
DETAILS.ParameterName = "DETAILS";
DETAILS.Direction = ParameterDirection.Output;

OracleParameter NN = new OracleParameter();
NN.ParameterName = "PRODUCT";
NN.Direction = ParameterDirection.Input;
NN.Value = 1000; // Some product id

OracleParameter DD = new OracleParameter();
DD.ParameterName = "TRDATE";
DD.Direction = ParameterDirection.Input;
DD.Value = “09-DEC-2008”; // Some Date

// for Oracle.DataAccess.Client use the following
DETAILS.OracleDbType = OracleDbType.RefCursor;
NN.OracleDbType = OracleDbType.Varchar2;
DD.OracleDbType = OracleDbType.Date;

// for System.Data.OracleClient use the following
//DETAILS.OracleType = OracleType.Cursor;
//NN.OracleType = OracleType.VarChar;
//DD.OracleType = OracleType.DateTime;

OracleCommand cmd = new OracleCommand("Myschemaname.GETSTOCK", cn);
cmd.CommandType = CommandType.StoredProcedure;
cmd.Parameters.Add(NN);
cmd.Parameters.Add(DD);
cmd.Parameters.Add(DETAILS);
OracleDataAdapter da = new OracleDataAdapter(cmd);
DataSet ds = new DataSet();
da.Fill(ds,"GETSTOCK"); //Name must be same as Procedure
ReportDocument rptDoc = new ReportDocument();
rptDoc.Load(Server.MapPath("FINC//abc.rpt"));
rptDoc.SetDataSource(ds);
CRT.ReportSource = rptDoc; // CRT is the name of Crystal report viewer control
    // your export routine goes here 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T21:45:51.327

我建议查看此代码：

```
Imports CrystalDecisions.CrystalReports.Engine
Imports CrystalDecisions.Shared
Public Class Form1
    Private Sub Button1_Click(ByVal sender As System.Object, _
    ByVal e As System.EventArgs) Handles Button1.Click
        Dim cryRpt As New ReportDocument
        Dim crtableLogoninfos As New TableLogOnInfos
        Dim crtableLogoninfo As New TableLogOnInfo
        Dim crConnectionInfo As New ConnectionInfo
        Dim CrTables As Tables
        Dim CrTable As Table

        cryRpt.Load("PUT CRYSTAL REPORT PATH HERE\CrystalReport1.rpt")

        With crConnectionInfo
            .ServerName = "YOUR SERVER NAME"
            .DatabaseName = "YOUR DATABASE NAME"
            .UserID = "YOUR DATABASE USERNAME"
            .Password = "YOUR DATABASE PASSWORD"
        End With

        CrTables = cryRpt.Database.Tables
        For Each CrTable In CrTables
            crtableLogoninfo = CrTable.LogOnInfo
            crtableLogoninfo.ConnectionInfo = crConnectionInfo
            CrTable.ApplyLogOnInfo(crtableLogoninfo)
        Next

        CrystalReportViewer1.ReportSource = cryRpt
        CrystalReportViewer1.Refresh()
    End Sub
End Class 
```

来自[http://vb.net-informations.com/crystal-report/vb.net_crystal_report_load_dynamically.htm](http://vb.net-informations.com/crystal-report/vb.net_crystal_report_load_dynamically.htm)

我可能会在星号所在的位置放置一个断点：

```
 For Each CrTable In CrTables
            *crtableLogoninfo = CrTable.LogOnInfo
            crtableLogoninfo.ConnectionInfo = crConnectionInfo
            CrTable.ApplyLogOnInfo(crtableLogoninfo)
        Next 
```

然后分析现有的CrTable.TableLogonInfo

希望您以后可以使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T03:17:16.207

施耐德，

我怀疑问题不是由于您设置了连接详细信息或参数。要确认我的怀疑，您可以将代码放入一个简单的 Web 或 Windows 窗体/页面中，而不是导出，只需尝试通过将 CrystalReportViewer 对象拖放到该页面上来查看报告。（注意：这项工作有一些先决条件，但如果您在安装了完整 Crystal 的开发机器上，它应该很容易满足这些要求。）

假设您没有看到投诉（即它提示输入参数或数据库凭据），那么我将倾向于完全不同的理论。

线索在您的错误消息中：“无法使用已与其基础 RCW 分离的 COM 对象。” 此错误并非 Crystal Reports 独有。

我之前看到的这与垃圾收集（无论是自动化的还是由于您的代码而发生的处置/解构）或多线程相关的挑战有关。

我注意到您将其作为一个函数调用，该函数将 PDF 路径作为字符串返回。也许您已经将调用嵌套到一个独立于调用线程的线程中？也许您有其他代码会触发其他可能涉及对象处置或资源/锁定相关问题（如批处理）的事件？

避免推测的一种方法是将所有这些放入一个全新的、非常简单的基本 Windows 应用程序中。除了触发导出的绝对最小值之外什么都不做。确保 Windows 应用程序只是写入本地文件夹并从本地目录读取报告。我们不希望文件权限或网络问题（通过网络读取/写入）干扰。

祝你好运。

# c# - 确保解决方案中的项目来自同一个 TFS 分支

> ID：10079690
> 
> 赞同：5
> 
> 时间：2012-04-09T20:50:46.870
> 
> 标签：c#, visual-studio, visual-studio-2010, tfs, add-in

是否有可用的方法来确定解决方案中是否有任何项目或项目中是否有来自另一个 TFS 源分支的引用？目标是通过在签入前或添加该项目/参考时提醒用户来防止这种情况。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:32:26.103

这可能不是最有效的方法，但我们使用了创可贴......

我们设置了一个门控签入构建，它只签出该分支的特定源目录。任何高于或超出分支根的引用都会引发错误。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T08:10:16.440

应该可以通过自定义[Checkin-Policy](http://msdn.microsoft.com/en-us/library/ms181281%28v=vs.80%29.aspx)获得所需的内容。可以在J.Lamb的[这篇](http://blogs.msdn.com/b/jimlamb/archive/2010/03/31/how-to-implement-package-and-deploy-custom-check-in-policy-for-tfs-2010.aspx)

很棒的文章中找到一个非常好的实现方法。在这里，作者专注于审计，如果在执行签入[NArrange](http://www.narrange.net/)之前，应该可以将审计与审计交换，以便将所有源置于源代码控制中的给定根目录下。构建和部署此策略并安装[TFS Power Tools](http://visualstudiogallery.msdn.microsoft.com/c255a1e4-04ba-4f68-8f4e-cd473d6b971f)后，您应该在新构建的策略上应用已有的策略“自定义路径策略”。你可以在[这里](http://leon.mvps.org/Tfs/MergeOnlyPolicy.html)找到一个例子。您需要此信息以便在解决方案目录而不是整个 TeamProject 上确定您的签入策略。

# php - 使用 PDO (PHP) 从 SQL 数据库中提取数组值匹配项

> ID：10079698
> 
> 赞同：0
> 
> 时间：2012-04-09T20:51:21.563
> 
> 标签：php, sql, arrays, pdo

我有一个 id 数组`$friends = array(0001, 0002, 0003, 0004)`和一个数据库，其中`table_name = friends`, `column_header = fid`. `fid`in`friends`可能包含也可能不包含其中一个朋友 ID。我想输入`$friends`查询，并返回`$friends`在`fid`.

我确定这`fid={array_values($friends)}`是错误的，但我不知道如何将 WHERE 部分传递给值数组...

```
//All DB_X's are defined in another file that is included in this actual file
$db = new PDO("mysql:host=".DB_SERVER.";dbname=".DB_NAME, DB_USER, DB_PASS);
$stmt = $db->prepare("SELECT fid FROM friends WHERE fid={array_values($friends)} ORDER BY fid ASC");
$stmt->execute();

$friendResults = $stmt->fetchAll(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:38:13.770

您将需要使用 SQL 的`IN`运算符：

```
SELECT ... FROM ... WHERE foo IN (val1, val2, ...) 
```

您可以使用 PHP 的`implode()`函数来获取所需的 SQL 位：

```
$values = implode(', ', array_values($friends));
$query = "SELECT ... FROM ... WHERE fid IN ({$values})"; 
```

如果您的值是数字，则上述方法将起作用。如果它们是字符串，则必须在`implode()`ing 之前修改值：

```
$values = array_map(array_values($friends), function($value) {
    return "'{$value}'"; // Here is where you could do sanitization
});
$values = implode(', ', $values); 
```

**请注意：您必须正确清理数据`$friends`以防止 SQL 注入。**

# java - 与 Java 和 PHP 兼容的密码哈希

> ID：10079700
> 
> 赞同：5
> 
> 时间：2012-04-09T20:51:26.090
> 
> 标签：java, php, passwords

是否有可以在 PHP 和 Java 中轻松使用的安全密码散列库（例如 phpass）或散列方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T20:53:46.497

如果你想做简单的事情，你可以使用 sha-N 和盐。（N 为 1、256 或 512）

* * *

`bcrypt`Jeff Atwood 最近对此做了一篇不错的博客文章，他说这`PBKDF2`是最好的选择。

在 PHP 中你可以[使用`bcrypt`](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)（也可以在[Java 中使用）](http://www.mindrot.org/projects/jBCrypt/)

* * *

**相关话题：**

*   [如何在 PHP 中使用 bcrypt 对密码进行哈希处理？](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)

**资源：**

*   [编码恐怖 - 速度散列](http://www.codinghorror.com/blog/2012/04/speed-hashing.html)
*   [安全堆栈交换 - 是否有安全专家推荐 bcrypt 用于密码存储？](https://security.stackexchange.com/questions/4781/do-any-security-experts-recommend-bcrypt-for-password-storage)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:53:55.980

任何标准库，例如 SHA*、MD* 都可以。建议使用 SHA>2（例如 SHA512）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T20:55:56.093

[md5](http://www.w3schools.com/php/func_string_md5.asp)和[SHA with salt](http://php.net/manual/en/function.sha1.php)是最广泛使用的。

# iphone - 如何在 iOS 中裁剪图像

> ID：10079701
> 
> 赞同：27
> 
> 时间：2012-04-09T20:51:35.887
> 
> 标签：iphone, ios, xcode, ios4

我有一个照片应用程序，您可以在其中在一个部分中添加贴纸。完成后，我想保存图像。这是我必须这样做的代码。

```
if(UIGraphicsBeginImageContextWithOptions != NULL)
{
    UIGraphicsBeginImageContextWithOptions(self.view.frame.size, YES, 2.5);
} else {
    UIGraphicsBeginImageContext(self.view.frame.size);
}
CGContextRef contextNew=UIGraphicsGetCurrentContext();

[self.view.layer renderInContext:contextNew];

UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

UIGraphicsEndImageContext(); 
```

现在保存的图像是图像的全屏，这很好，但现在我需要裁剪图像，我不知道如何。您可以在以下链接中看到图片：http: [//dl.dropbox.com/u/19130454/Photo%202012-04-09%201%2036%2018%20PM.png](http://dl.dropbox.com/u/19130454/Photo%202012-04-09%201%2036%2018%20PM.png)

我需要裁剪：从左到右 91px 从底部到 220px

任何帮助将不胜感激。如果我没有解释清楚，请告诉我，我会尽力重新解释。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-04-10T00:31:26.283

这样的事情怎么样

```
CGRect clippedRect  = CGRectMake(self.view.frame.origin.x+91, self.view.frame.origin.y, self.view.frame.size.width-91*2, self.view.frame.size.height-220);
CGImageRef imageRef = CGImageCreateWithImageInRect([image CGImage], clippedRect);
UIImage *newImage   = [UIImage imageWithCGImage:imageRef];
CGImageRelease(imageRef); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-16T14:27:30.523

以下代码可能会对您有所帮助。

您应该通过以下方法获得正确的cropFrame拳头

```
-(CGRect)cropRectForFrame:(CGRect)frame
{
    // NSAssert(self.contentMode == UIViewContentModeScaleAspectFit, @"content mode must be aspect fit");

    CGFloat widthScale = imageview.superview.bounds.size.width / imageview.image.size.width;
    CGFloat heightScale = imageview.superview.bounds.size.height / imageview.image.size.height;

    float x, y, w, h, offset;
    if (widthScale<heightScale) {
        offset = (imageview.superview.bounds.size.height - (imageview.image.size.height*widthScale))/2;
        x = frame.origin.x / widthScale;
        y = (frame.origin.y-offset) / widthScale;
        w = frame.size.width / widthScale;
        h = frame.size.height / widthScale;
    } else {
        offset = (imageview.superview.bounds.size.width - (imageview.image.size.width*heightScale))/2;
        x = (frame.origin.x-offset) / heightScale;
        y = frame.origin.y / heightScale;
        w = frame.size.width / heightScale;
        h = frame.size.height / heightScale;
    }
    return CGRectMake(x, y, w, h);
} 
```

然后你需要调用这个方法来获取裁剪图像

```
- (UIImage *)imageByCropping:(UIImage *)image toRect:(CGRect)rect
{
    // you need to update scaling factor value if deice is not retina display
    UIGraphicsBeginImageContextWithOptions(rect.size,
                                           /* your view opaque */ NO,
                                           /* scaling factor */ 2.0);

    // stick to methods on UIImage so that orientation etc. are automatically
    // dealt with for us
    [image drawAtPoint:CGPointMake(-rect.origin.x, -rect.origin.y)];

    UIImage *result = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return result;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-01T05:36:21.353

```
- (UIImage*)imageByCropping:(CGRect)rect
{
    //create a context to do our clipping in
    UIGraphicsBeginImageContext(rect.size);
    CGContextRef currentContext = UIGraphicsGetCurrentContext();

    //create a rect with the size we want to crop the image to
    //the X and Y here are zero so we start at the beginning of our
    //newly created context
    CGRect clippedRect = CGRectMake(0, 0, rect.size.width, rect.size.height);
    CGContextClipToRect( currentContext, clippedRect);

    //create a rect equivalent to the full size of the image
    //offset the rect by the X and Y we want to start the crop
    //from in order to cut off anything before them
    CGRect drawRect = CGRectMake(rect.origin.x * -1,
                                 rect.origin.y * -1,
                                 self.size.width,
                                 self.size.height);

    //draw the image to our clipped context using our offset rect
    // CGContextDrawImage(currentContext, drawRect, self.CGImage);
    [self drawInRect:drawRect]; // This will fix getting inverted image from context.

    //pull the image from our cropped context
    UIImage *cropped = UIGraphicsGetImageFromCurrentImageContext();

    //pop the context to get back to the default
    UIGraphicsEndImageContext();

    //Note: this is autoreleased
    return cropped;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-09-15T12:53:36.623

请参阅以下链接以获取裁剪图像

[https://github.com/myang-git/iOS-Image-Crop-View](https://github.com/myang-git/iOS-Image-Crop-View)

```
** How to Use **

Very easy! It is created to be a drop-in component, so no static library, no extra dependencies. Just copy ImageCropView.h and ImageCropView.m to your project, and implement ImageCropViewControllerDelegate protocol.
Use it like UIImagePicker:
- (void)cropImage:(UIImage *)image{
    ImageCropViewController *controller = [[ImageCropViewController alloc] initWithImage:image];
    controller.delegate = self;
    [[self navigationController] pushViewController:controller animated:YES];
}
- (void)ImageCropViewController:(ImageCropViewController *)controller didFinishCroppingImage:(UIImage *)croppedImage{
   image = croppedImage;
   imageView.image = croppedImage;
   [[self navigationController] popViewControllerAnimated:YES];
}
- (void)ImageCropViewControllerDidCancel:(ImageCropViewController *)controller{
    imageView.image = image;
    [[self navigationController] popViewControllerAnimated:YES];
} 
```

# jquery - 通过检测哈希 (#) 后的路径将“活动”类添加到当前菜单项？

> ID：10079704
> 
> 赞同：2
> 
> 时间：2012-04-09T20:51:48.167
> 
> 标签：jquery, ajax, hashchange

我的网站在其 URL 中使用哈希来使用 AJAX [（我从本教程中获得）](http://www.deluxeblogtips.com/2010/05/how-to-ajaxify-wordpress-theme.html)进行导航。单击链接时，会在 URL 的末尾添加 /#/（链接名称）。

如果我在 mysite.com，然后单击“照片”，则 url 变为 mysite.com/#/photos，并且“#content” div 将使用 /photos 中的 #content div 重新填充。

此外，如果由于某种原因，用户手动键入“mysite.com/photos”，然后点击“bio”，他的 URL 将看起来像“mysite.com/photos/#/bio”

页面没有重新加载，并且 URl 与菜单 a 标记中的 href 不完全匹配的事实使我很难弄清楚如何将活动类添加到当前菜单项。

我的菜单是由 wordpress 生成的，看起来像这样

```
<div id="main-menu">
<ul>
<li><a href="mysite.com/photos">Photos</li>
etc.
</ul>
</div> 
```

请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:17:38.593

我猜`mysite.com/photos/#/bio`你想将生物链接设置为活动？换句话说，就是网址的最后一个“单词”。

为此，您可以执行以下操作：

```
var path = window.location.pathname.split("\/"), myString;

if(path[path.length-1] === "")
    myString = path[path.length-2];

else
   myString = path[path.length-1];

myString = myString.toLowerCase()
console.log(myString); 
```

if/else 检查是因为如果路径名是“/hola/bandola/”，则拆分后数组中的最后一个元素将是一个空字符串，但如果它只是“/hola/bandola”，则“bandola”将是最后一项。因此，要使其以两种方式工作，检查是必要的。现在您有了具有正确字符串的变量，并且可以使用该信息将正确的链接设置为活动状态。

编辑：由于您不动态生成导航链接，因此您必须将从我的代码中获得的值与每个导航链接的唯一值进行比较。我的建议是您在 a-tags 中添加一个与您从我的代码中获得的字符串匹配的数据属性。例子：`<li><a href="mysite.com/photos" data-page="photos">Photos</li>`

现在您遍历 UL 中的每个 a-tag 并将数据页值与您从查询字符串中获得的值进行比较，如果它们匹配，则将 class 设置为“active”：

```
var links = $("#main-menu").find("a");
$.each(links, function() {
         if($(this).data("page") === myString)
             $(this).addClass("active");
}​);​ 
```

​​​您可以只比较 a-tags 中的文本，但如果文本与 url-string 不匹配，那将不起作用，因此最好添加一个 data-attribute。请注意，我编辑了上面的代码以确保在与数据属性进行比较时“myString”变量是小写的。希望你能理解。

编辑2：

要改为比较 a-tag 中的文本，请改用每个循环：

```
var links = $("#main-menu").find("a");
$.each(links, function() {
         if($(this).html("page").toLowerCase() === myString)
             $(this).addClass("active");
}​);​ 
```

# curl - 从命令行使用 CURL 的 https 连接

> ID：10079707
> 
> 赞同：175
> 
> 时间：2012-04-09T20:52:04.170
> 
> 标签：curl, ssl, command-line, https, certificate

我是 Curl 和 Cacerts 世界的新手，在连接服务器时遇到问题。基本上，我需要通过 https 测试从一台机器到另一台机器的连接性。我有一个需要从机器 A（Linux 机器）连接到的 URL 我在命令提示符下尝试了这个

```
cmd> curl https://[my domain or IP address] 
```

并得到以下信息：

```
curl: (60) SSL certificate problem, verify that the CA cert is OK. Details:
error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed 
```

在通过互联网浏览一些文章时，我这样做了：

```
openssl s_client -connect <domain name or Ip address>:443 
```

并得到了一些响应，包括服务器证书（内部`-----BEGIN CERTIFICATE----- and -----END CERTIFICATE-----`）。

从这里我下一步该怎么做。我想，我将不得不复制粘贴其中的文本 `BEGIN CERTIFICATE & END CERTIFICATE`并将其保存在文件中。但是，它应该是什么类型的文件？`.pem`, `.crt`?.. 那之后我该怎么办？

我试过这个 - 复制里面的文本`BEGIN CERTIFICATE & END CERTIFICATE`并将其保存在一个`.crt`文件中 - 将其命名为`my-ca.crt`（也通过将其命名为`my-ca.pem`文件来尝试相同的事情）然后这样做：

```
cmd>curl --cacert my-ca.crt https://[my domain or IP address] 
```

但是得到了同样的错误。

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2014-02-10T17:57:43.330

我遇到了同样的问题 - 我正在从我自己的站点获取一个页面，该站点通过 HTTPS 提供，但 curl 给出了相同的“SSL 证书问题”消息。我通过`-k`在调用中添加一个标志以允许不安全的连接来解决它。

```
curl -k https://whatever.com/script.php 
```

编辑：我发现了问题的根源。我使用的是 SSL 证书（来自 StartSSL，但我认为这并不重要）并且没有正确设置中间证书。如果您遇到与上述 user1270392 相同的问题，那么在进行修复之前[测试您的 SSL 证书](http://www.sslshopper.com/ssl-checker.html)并修复任何问题可能是个好主意`curl -k`。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2016-01-15T13:22:05.213

## 基本证书信息

这是我的日常脚本：

```
curl --insecure -vvI https://www.example.com 2>&1 | awk 'BEGIN { cert=0 } /^\* SSL connection/ { cert=1 } /^\*/ { if (cert) print }' 
```

**输出：**

```
* SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384
* ALPN, server accepted to use h2
* Server certificate:
*  subject: C=US; ST=California; L=Los Angeles; O=Verizon Digital Media Services, Inc.; CN=www.example.org
*  start date: Dec 10 00:00:00 2021 GMT
*  expire date: Dec  9 23:59:59 2022 GMT
*  issuer: C=US; O=DigiCert Inc; CN=DigiCert TLS RSA SHA256 2020 CA1
*  SSL certificate verify ok.
* Using HTTP2, server supports multi-use
* Connection state changed (HTTP/2 confirmed)
* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0
* Using Stream ID: 1 (easy handle 0x5588e1f5ae30)
* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
* old SSL session ID is stale, removing
* Connection state changed (MAX_CONCURRENT_STREAMS == 100)!
* Connection #0 to host www.example.com left intact 
```

## 完整的证书信息

```
openssl s_client -connect www.example.com:443 </dev/null 2>/dev/null | openssl x509 -inform pem -text 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2015-10-21T09:09:29.383

您需要提供整个证书链来 curl，因为 curl 不再附带任何 CA 证书。由于 cacert 选项只能使用一个文件，因此您需要将完整的链信息连接到 1 个文件中

将证书链（例如从您的浏览器中）复制到 DER 编码的二进制 x.509(.cer) 中。为每个证书执行此操作。

将证书转换为 PEM，并将它们连接到 1 个文件中。

```
openssl x509 -inform DES -in file1.cer -out file1.pem -text
openssl x509 -inform DES -in file2.cer -out file2.pem -text
openssl x509 -inform DES -in file3.cer -out file3.pem -text

cat *.pem > certRepo

curl --cacert certRepo -u user:passwd -X GET -H 'Content-Type: application/json' "https//somesecureserver.com/rest/field" 
```

我在这里写了一篇关于如何做到这一点的博客：http: [//javamemento.blogspot.no/2015/10/using-curl-with-ssl-cert-chain.html](http://javamemento.blogspot.no/2015/10/using-curl-with-ssl-cert-chain.html)

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2013-04-30T10:03:47.180

用于`--cacert`指定`.crt`文件。 `ca-root-nss.crt`例如。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-02-17T09:22:46.833

我实际上遇到了这种问题，我通过以下步骤解决了它：

1.  从这里获取根 CA 证书包：[https](https://curl.haxx.se/ca/cacert.pem) ://curl.haxx.se/ca/cacert.pem并将其保存在本地

2.  查找`php.ini`文件

3.  将 设置`curl.cainfo`为证书的路径。所以它会是这样的：

`curl.cainfo = /path/of/the/keys/cacert.pem`

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-12-08T17:31:21.990

[在这里您可以找到 CA 证书以及下载和转换 Mozilla CA 证书的说明](http://curl.haxx.se/docs/caextract.html)。一旦你得到`ca-bundle.crt`或`cacert.pem`你只是使用：

```
curl.exe --cacert cacert.pem https://www.google.com 
```

或者

```
curl.exe --cacert ca-bundle.crt https://www.google.com 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-12-07T22:18:36.387

诊断出问题后，我能够使用现有的系统默认 CA 文件，在 debian6 上是：

```
/etc/ssl/certs/ca-certificates.crt 
```

作为 root 可以这样做：

```
echo curl.cainfo=/etc/ssl/certs/ca-certificates.crt >> /etc/php5/mods-available/curl.ini 
```

然后重新启动网络服务器。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-06-30T13:23:25.657

您需要证书链而不是单个证书。使用 Firefox 很容易获得它：

1.  在 Firefox 中打开网址。
2.  单击 URL 左侧地址框上的安全图标。
3.  点击`connection not secure`, `more information`。在`security`选项卡下，选择`view certificate`，向末尾滚动。在 旁边`download`，选择**PEM(chain)**以下载证书链。

现在，您将证书链作为一个文件，您可以在`--cacert`标志之后的 curl 请求中使用它：
`curl --cacert downloaded.pem -X POST https://the-url-to-access`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-03-13T09:11:29.137

你可以用这个

`curl_setopt($curl->curl, CURLOPT_SSL_VERIFYPEER, false);`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-09-07T02:56:37.967

有什么问题`wget`？

抱怨标准将其抛在脑后，这不是一个人。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-01-08T19:01:32.740

对我来说，我只是想测试一个具有自动 http->https 重定向的网站。我想我已经安装了一些证书，因此仅此一项就可以在 Ubuntu 16.04 上运行`curl 7.47.0 (x86_64-pc-linux-gnu) libcurl/7.47.0 GnuTLS/3.4.10 zlib/1.2.8 libidn/1.32 librtmp/2.3`

`curl --proto-default https <target>`

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2018-11-13T09:02:22.967

使用现代版本的 curl，您可以使用 --resolve 或 --connect-to （curl 比版本 7.49 更新）简单地覆盖要连接的 IP 地址。这甚至适用于 SSL/SNI。所有详细信息都在手册页中。

例如，要覆盖 DNS 并使用特定 IP 地址通过 ssl 连接到 www.example.com：（这也将覆盖 ipv6）

```
curl --resolve www.example.com:443:192.168.42.2 https://www.example.com/ 
```

另一个示例，连接到端口 8080 上名为 backend1 的特定后端服务器

```
curl --connect-to www.example.com:80:backend1.example.com:8080 http://www.example.com/ 
```

如果服务器需要正确回答，请记住添加主机标头：

```
-H 'Host:www.example.com' 
```

# javascript - 如何防止 javascript 评估函数参数

> ID：10079708
> 
> 赞同：1
> 
> 时间：2012-04-09T20:52:04.817
> 
> 标签：javascript

我是一个 javascript 菜鸟，擅长制作扫雷。我将 HTML 元素 ID 字符串传递给函数。字符串的格式为行连字符列。所以左上角的单元格是 1-1。我的函数正在评估这些字符串，就好像它们是表达式一样。所以...

```
function notMine(id){
alert(id) //If the incoming id=4-4, this pops up 0\. I want it to pop up 4-4 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T20:54:30.630

表达式在调用函数之前被评估，因为它们不是字符串。使用撇号或引号使其成为字符串：

```
notMine("4-4"); 
```

或者

```
notMine('4-4'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T20:55:41.927

传入参数时，请使用引号：

干杯。

```
<script type="text/javascript">
    feedMe( 4 + 4 );
    feedMe( "4 + 4" );

    function feedMe( id )
    {
        alert(id);
    }
</script> 
```

# arrays - 使用 STArray 的 Haskell 并行计算

> ID：10079710
> 
> 赞同：2
> 
> 时间：2012-04-09T20:52:38.560
> 
> 标签：arrays, haskell, parallel-processing, monads, state-monad

我正在尝试并行计算，并将结果写入 STArray。我认为这段代码显示了我正在尝试做的事情。但是，我遇到了编译错误。

```
import Control.Monad
import Control.Monad.ST
import Control.Parallel
import Data.Array.ST

main = do
    arr <- newArray ((0,0), (5,5)) 0 :: ST s (STArray s (Int, Int) Int)
    runSTArray $ do
        par (writeArray arr (1,1) 17) (writeArray arr (2,2) 23)
        return arr
    print arr 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-09T21:38:56.910

你使用`newArray`, 它的类型是`ST s (STArray s (Int, Int) Int)`. 然而，你在`main`函数体中使用它，这意味着你`do`必须有一个`IO`类型。`ST`is not `IO`，所以类型不能匹配。

您应该首先将其移动`newArray`到可以访问`ST`monad 的上下文中。这个上下文当然在 的正文中是可用的`runSTArray`，所以将正文更改为：

```
 runSTArray $ do
        arr <- newArray ((0,0), (5,5)) 0 :: ST s (STArray s (Int, Int) Int)
        par (writeArray arr (1,1) 17) (writeArray arr (2,2) 23)
        return arr 
```

然后，您需要重新考虑`par`行为方式。`par`用于创建并行*纯*计算，不能用于单子动作；monad 通常根本无法并行化。特别是，`ST`monad 甚至没有为并行计算提供任何替代方案。由于对数组的并行写入可能会导致竞争条件（如果覆盖同一个单元格会发生什么？哪个写入会计数，哪个不会？），在这里允许并行是不安全的。您必须按顺序更改数组：

```
 runSTArray $ do
        arr <- newArray ((0,0), (5,5)) 0 :: ST s (STArray s (Int, Int) Int)
        writeArray arr (1,1) 17
        writeArray arr (2,2) 23
        return arr 
```

但是，写入并不昂贵。可能是昂贵的值的计算。假设您要计算`17`并`23`在运行中；然后您可以执行以下操作：

```
let a = someLongCalculation 12534
    b = a `par` (someLongCalculation 24889)
writeArray arr (1, 1) a
writeArray arr (2, 2) b 
```

最后，你必须意识到`runSTArray`返回结果数组，所以你必须像这样存储它：

```
import Control.Monad
import Control.Monad.ST
import Control.Parallel
import Data.Array.ST

main =
  let pureArr =
        runSTArray $ do
          arr <- newArray ((0,0), (5,5)) 0 :: ST s (STArray s (Int, Int) Int)
          writeArray arr (1,1) 17
          writeArray arr (2,2) 23
          return arr
  in print pureArr 
```

我不认为`STArray`s 是正确的解决方案。您应该使用功能更强大的数组库，例如[`repa`](http://hackage.haskell.org/package/repa)在需要并行对称数组计算的情况下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T21:38:18.597

`par`用于并行组合纯操作。您正在编写有效的操作。你不能使用标准杆。此外，并行性*是*一种效果（至少在与突变组合时），并且在 ST monad 中对您不可用。我不能就构建代码的正确方法给你建议，因为事情太精简了，看不出你的实际问题域是什么。然而，我的一般建议是，使用像 fork（在 IO monad 中）这样的显式并发构造，*或者*使用纯操作而不是 mutatey 数组。

# c# - break 命令后循环多次命中

> ID：10079711
> 
> 赞同：3
> 
> 时间：2012-04-09T20:52:38.853
> 
> 标签：c#, kinect, nui

我有一个奇怪的问题。我正在为应用程序创建一个 NUI，并将一些简单的手势绑定到左右箭头。问题是当我启动应用程序时。当我第一次做手势时，我的应用程序连续命中 2 次。之后，它可以按我的意愿 100% 工作。只有开始才是问题所在。

我正在将两个关节和时间戳添加到我的历史结构中，该结构被放入 ArrayList

```
 this._history.Add(new HistoryItem()
            {
                timestamp = timestamp,
                activeHand = hand,
                controlJoint = controlJoint
            }
        ); 
```

然后在 foreach 循环中我正在比较数据

```
if (Math.Abs((hand.Position.X - item.controlJoint.Position.X)) < MainWindow.treshold && Math.Abs((hand.Position.Y - item.controlJoint.Position.Y)) < MainWindow.verticalTreshold) 
```

如果它击中，我会立即打破 lopp

```
break; 
```

之后我清除历史 ArrayList

```
this._history.Clear(); 
```

所以我不明白。为什么启动后会连续命中两次？

// 编辑

历史 ArrayList 初始化

```
private List<HistoryItem> _history = new List<HistoryItem>(16); 
```

循环中

```
foreach (HistoryItem item in this._history)
        {
         if ((hand.Position.X - item.controlJoint.Position.X) < MainWindow.treshold)
                            {
                                float tmp = (hand.Position.X - controlJoint.Position.X);
                                MainWindow.slideNumber++;
                                this._logger.Log("Next slide: " + MainWindow.slideNumber);
                                this._logger.Log(hand.Position.X + " - " + controlJoint.Position.X + " = " + tmp + " | " + MainWindow.treshold);
                                this.startTime = 0;
                                this.gestureStart = false;
                                answerFlag = true;
                                System.Windows.Forms.SendKeys.SendWait("{Right}");
                                break;
                            }
                } 
```

现在。正如你所看到的，我在这里打破了。因此，不应连续第二次调用此代码

这如何清除某些东西

// 编辑 2

我还要补充一点，要进入这部分代码，gestureStart 标志需要设置为 true。正如您在此处进入“if”部分后所看到的，我将其设置为 false。所以代码不可能立即到达这部分

// 编辑 3 **WORKAROUND**

我创造了一种解决方法。我添加了时间控制。我正在比较调用代码的时间戳和上次手势识别的时间戳。如果它太快（我是几毫秒，这是不可能的）我不允许击中箭头。我不确定这是否是一个完美的解决方案，但它是一个可行的解决方案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T15:29:54.917

好的，我的问题是代码。Ofc 在调试中无法追踪的一个小错误。我使用一个函数来分析帧的历史。

该方法在 2 种模式下工作。我已经将其分离并创建了 2 种不同的方法，每种方法用于每个任务，现在效果很好

# python - 尝试将经度/纬度转换为笛卡尔坐标

> ID：10079716
> 
> 赞同：2
> 
> 时间：2012-04-09T20:52:43.863
> 
> 标签：python, cartesian, polar-coordinates

我正在尝试将城市的经度/纬度位置转换为笛卡尔坐标，然后我可以将其转换为像素位置以显示在 pygame 屏幕上，但我无法弄清楚。

```
def ConvertPoint(self, Long, Lat, height, width):
    self.x = Long
    self.y = Lat
    self.x = angleToPointX(self.x, self.y, 3959)
    self.y = angleToPointY(self.x, self.y, 3959)
    pygame.draw.circle(self.window, (255,0,0), (int(self.x), int(self.y)), 5)
    print(self.x, self.y) 
```

职能：

```
def angleToPointX(lat, long, magnitude=1.0):
    V = (math.cos(lat) * math.cos(long))
    return V

def angleToPointY(lat, long, magnitude=1.0):
    V = (math.sin(lat))
    return V 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:58:14.830

你用的是什么[地图投影](http://en.wikipedia.org/wiki/List_of_map_projections)？纬度/经度可以直接用作圆柱投影中的 y/x - 这是最简单的游戏方式。否则，转换将完全取决于投影的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T21:02:02.003

我过去也遇到过类似的问题，[这](http://www.movable-type.co.uk/scripts/latlong.html)就是帮助我度过难关的原因

# imagemagick - ImageMagick 背景图片？

> ID：10079738
> 
> 赞同：2
> 
> 时间：2012-04-09T20:54:47.180
> 
> 标签：imagemagick

我最近才开始探索 ImageMagick，但我有一个疑问。我一直在寻找，但找不到解决方案。

使用以下代码：

```
convert -background lightblue  -fill blue  -font Candice -pointsize 30 \
          -size 220x220  -gravity Center  caption:'$txt' \
          $name.gif 
```

如何使用图像作为背景而不是静态颜色？

我已经尝试过`-background "file.jpg"`，但它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:57:20.120

使用[`-texture`](http://www.imagemagick.org/script/command-line-options.php#texture)而不是[`-background`](http://www.imagemagick.org/script/command-line-options.php#background).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T21:50:33.690

我想我误解了你最初的问题。这会将图像平铺到设定大小的背景上并添加一些文本。

```
$txt = 'Caption';
// Tile the image - no background as it will not be seen behind the tile
$cmd = " -size 220x220 tile:noise.jpg -font Candice -fill blue -pointsize 30 ".
"-gravity Center -annotate +0+0 $txt";  
exec("convert $cmd output.jpg"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T19:51:49.463

相当多的方法取决于您所追求的效果，但这是一种简单的方法：

转换 input.jpg -fill blue -font Candice -pointsize 30 -gravity Center -annotate +0+0 "Some text" $name.gif

我无法理解这个网站发布代码的方式:(

# iphone - 游戏被 AppStore 拒绝

> ID：10079739
> 
> 赞同：0
> 
> 时间：2012-04-09T20:54:58.513
> 
> 标签：iphone, ios, cocos2d-iphone, app-store

我使用 cocos2D 开发了一款纸牌游戏，最近将其二进制文件上传到了应用商店。当我们从一个场景移动到另一个场景时，我在游戏中使用了一些 CCtransition 效果。应用商店拒绝二进制文件，原因是“**当用户点击任何启动屏幕底部的选项卡，产生全屏转换**“。我现在该怎么办？CCTransition，问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T20:57:13.967

标签栏应该更改页面另一部分中包含的内容，并且不应转换标签栏本身。如果您的标签栏按钮触发全屏转换，则违反了人机界面指南。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T05:39:46.617

如果他们认为这违反了人机界面指南，那么不要使用标签栏，而是制作一些新的设计按钮并将其放在游戏的底部.....:)

# bash - 在 Unix 中使用 bash 查找指定大小的文件

> ID：10079740
> 
> 赞同：57
> 
> 时间：2012-04-09T20:55:09.230
> 
> 标签：bash, unix

我正在寻找一个 Unix 命令来打印文件的大小。我用过这个，但没有用。

```
find . -size +10000k -print. 
```

我想打印文件的大小以及文件名/目录。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-04-09T21:00:46.480

```
find . -size +10000k -exec ls -sd {} + 
```

如果您的版本`find`不接受该`+`表示法（其行为很像`xargs`），那么您可以使用（GNU`find`和`xargs`，因此`find`可能`+`无论如何都支持）：

```
find . -size +10000k -print0 | xargs -0 ls -sd 
```

或者您可能会替换为`+`（`\;`并忍受这种相对低效的情况），或者您可能会遇到由名称中的空格引起的问题并使用便携式：

```
find . -size +10000k -print | xargs ls -sd 
```

`-d`on命令确保如果`ls`找到目录（不太可能，但是...），则将打印目录信息，而不是目录中的文件。而且，如果您要查找超过 1 MB 的文件（正如现在已删除的评论所建议的那样），您需要调整`+10000k`to`1000k`或可能`+1024k`，或`+2048`（对于 512 字节块，默认单位为`-size`）。这将列出大小，然后是文件名。`-d`当然，您可以通过添加`-type f`到`find`命令来避免需要。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-09T21:10:41.320

Find 可用于以 %s 作为 printf 打印出文件大小（以字节为单位）。%h/%f 分别打印目录前缀和文件名。\n 强制换行。

例子

```
find . -size +10000k -printf "%h/%f,%s\n" 
```

输出

```
./DOTT/extract/DOTT/TENTACLE.001,11358470
./DOTT/Day Of The Tentacle.nrg,297308316
./DOTT/foo.iso,297001116 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-09T21:07:14.337

假设你有 GNU 发现：

```
find . -size +10000k -printf '%s %f\n' 
```

如果您想要 size 字段的恒定宽度，您可以执行以下操作：

```
find . -size +10000k -printf '%10s %f\n' 
```

请注意，`-size +1000k`选择至少 10,240,000 字节的文件（`k`是 1024，而不是 1000）。你在评论中说你想要大于 1M 的文件；如果那是 1024*1024 字节，那么：

```
find . -size +1M ... 
```

可以解决问题——除了它还会打印*恰好*为1024*1024 字节的文件的大小和名称。如果这很重要，您可以使用：

```
find . -size +1048575c ... 
```

你需要决定你想要什么标准。

# django - 了解目录结构建议

> ID：10079747
> 
> 赞同：4
> 
> 时间：2012-04-09T20:55:58.430
> 
> 标签：django, configuration, structure, directory-structure

我开始在 Django 示例项目中创建，第一个命令：

`django-admin.py startproject test`

给我：

```
- root
  - test
    - __init__.py 
    - settings.py 
    - urls.py 
    - wsgi.py 
    - manage.py 
```

现在我创建第一个应用程序：

`python manage.py startapp foo`

它为我创建了文件夹`root/foo`

所以我应该如何理解我的`root/test`文件夹。这个文件夹用于我的项目的全局配置，仅此而已？（类似于 Symfony 2 应用程序文件夹）

我很困惑，因为 Django 文档告诉：

> 内部 mysite/ 目录是您项目的实际 Python 包

但`manage.py startapp foo`在根目录下创建应用程序，而不是在`root/test`（mysite 等效项）下

**[编辑]**

两个命令：

```
python manage.py startapp app 
```

和：

```
django-admin.py startapp app 
```

在项目根目录中给我应用程序，而不是在`root/name_of_generated_project`

姜戈 1.4

**[编辑] 2**

对不起伙计们，我的错，现在一切正常。

**[编辑] 3**

我想再次创建另一个项目：

`django-admin.py startproject jobeet`

我的初始结构与上面类似。

现在我想尝试创建应用程序（在 jobeet 文件夹内）：

`django-admin.py startapp jobs`

我最终`jobeet/jobs`没有`jobeet/jobeet/jobs`

再次 ：/

所以在我的项目根目录中，我有：

```
- jobeet
- jobs
- manage.py 
```

另一个命令：

```
python manage.py startapp app 
```

给我同样的结果

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T21:16:49.137

因此，假设您创建了一个新的 Django 项目`testproject`：

> django-admin.py startproject testproject

这将创建一个具有以下最小文件集的新项目：

```
testproject/
├── __init__.py
├── manage.py
├── settings.py
└── urls.py 
```

要为您的第一个站点创建一个新应用程序，`mysite1`请进入`testproject`目录并运行：

> python manage.py startapp mysite1

`mysite1`这会为应用程序生成一个新目录`mysite1`。

即仅使用这两个命令，您将到达此层次结构：

```
testproject/
├── __init__.py
├── manage.py
├── mysite1
│   ├── __init__.py
│   ├── models.py
│   ├── tests.py
│   └── views.py
├── settings.py
└── urls.py 
```

请参阅[此处](https://docs.djangoproject.com/en/1.4/ref/django-admin/)`django-admin.py`的和/或`manage.py`单个命令。

在 Django 中， a和 an之间存在**一对多的**关系。应用程序通常是一个单独的站点组件（例如，），而项目是多个应用程序的组织，可以为许多不同的站点提供支持。这就是您获得[站点框架](https://docs.djangoproject.com/en/dev/ref/contrib/sites/)的原因。在实践中，一个项目通常服务于一个网站，但对于一个项目的 Django应用程序，您可以为尽可能多的网站服务，以实现可重用性。`project``app``comments``ratings``sites`

PS我认为创建一个简单称为项目的项目`test`并不是一个好习惯，因为在`app`级别单元测试中使用Django单元测试将进入一个名为的文件`tests.py`或一个名为`tests`.

**更新 Django 1.4**

正如*@zeantsoi*在下面评论的那样，我的回答是：

> 适用于 Django 1.3 及之前的版本。[根据文档](https://docs.djangoproject.com/en/dev/releases/1.4/#updated-default-project-layout-and-manage-py)，从 1.4 开始，基本配置文件（包括 settings.py、urls.py 和 wsgi.py）被抽象到一个与项目同名的子目录中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T21:03:10.763

“测试”是您项目的顶层。我从未使用过交响乐 2，所以我无法对此发表评论，但看起来你已经掌握了它。那里的文件基本上都是全局配置文件。在您的“测试”文件夹中，您还应该有一个或多个应用程序文件夹。在这些应用程序文件夹中保存着应用程序特定的模型、视图、url 等。

看来您的`foo`应用程序应该存在于 root/test/foo 而不是 root/foo 中有些错误。

现在在我的项目中，我倾向于将 virtualenv 文件夹之类的东西放在根目录中，但是您绝对不应该在该级别拥有应用程序（它只是行不通）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T21:01:09.893

manage.py 不提供 startproject 命令——通常是 django-admin 命令。我会检查您正在执行哪个 manage.py，理想情况下，使用您创建的项目目录中的 manage.py。

# python - 管理表单自定义多选框

> ID：10079748
> 
> 赞同：0
> 
> 时间：2012-04-09T20:55:58.650
> 
> 标签：python, django

我已经完成了我的模型，我正在尝试为特定模型定制管理模型。

这是我的 admin.py

```
from project.base.models import *
from django.contrib import admin
from django import forms

class StaffModuleForm(forms.ModelForm):
    user = forms.ModelChoiceField(queryset=User.objects.all())
    class Meta:
        model = StaffModule

class StaffModuleAdmin(admin.ModelAdmin):
    form = StaffModuleForm
    class Meta:
        pass

Modules = [UserProfile, Student, Module, StaffModule, Exercise, Result]
admin.site.register(Modules) 
```

这是有问题的模型

```
class StaffModule(models.Model):
    user = models.ForeignKey(User)
    modules = models.ManyToManyField(Module) # Field name made lowercase.
    department = models.CharField(max_length=6)
    def __unicode__(self):
        return str(self.user) 
```

这是我目前无法通过的错误：

```
AttributeError at /admin/base/staffmodule/2/
type object 'StaffModuleAdmin' has no attribute '_meta' 
```

这是跟踪： http: [//pastebin.com/tCJ9Q978](http://pastebin.com/tCJ9Q978)

我真的很感激一些帮助，因为我相信我正在关注 django 管理文档，但我不太确定问题是什么。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:29:55.550

问题在于：

```
class StaffModuleAdmin(admin.ModelAdmin):
    form = StaffModuleForm
    class Meta:
        pass 
```

`Class Meta`不应为类定义内部`admin.ModelAdmin`。

# sql - 如何对列中的值进行排序并更新表？

> ID：10079750
> 
> 赞同：17
> 
> 时间：2012-04-09T20:56:02.240
> 
> 标签：sql

我对 sql 完全陌生，自己不能这样做。所以我需要你的帮助。我想对列中的值进行排序，然后保存更改。但我不知道该怎么做。

表如下所示：

```
Id | Name | SomeDescription
---------------------------
1  |Best  | Description1
2  |Worth | Description2
3  |Good  | Description3 
```

我想得到这样的东西：

```
Id | Name | SomeDescription
---------------------------
1  |Best  | Description1
2  |Good  | Description3
3  |Worth | Description2 
```

所以我需要对“id”和“name”列进行排序。

我使用以下语句对“名称”列的值进行排序：

```
SELECT * FROM games ORDER BY name ASC 
```

但是如何对 id 列的值进行排序并将更改保存在表中？请帮忙。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-09T21:05:23.810

您将不得不使用第二张桌子

1.  创建一个`games2`与您的表具有相同结构的新表`games`，确保 ID 是自动递增的

    ```
    CREATE TABLE `games2` LIKE `games`; 
    ```

2.  复制数据，排序，到`games2`

    ```
    INSERT INTO `games2` (`Name`, `SomeDescription`) SELECT `Name`, `SomeDescription` FROM `games` ORDER BY `Name` 
    ```

3.  删除或移动旧表

    ```
    -- DROP TABLE `games`;
    -- or
    RENAME TABLE `games` TO `games1`; 
    ```

4.  将新表重命名为旧名称

    ```
    RENAME TABLE `games2` TO `games`; 
    ```

这些步骤将产生您想要的结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T21:21:30.687

您可以使用 ROW_NUMBER 排名函数对行重新编号。

```
SELECT UnsortedId = id
, SortedId = ROW_NUMBER() OVER (ORDER BY g.name, g.id)
FROM games 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-12T23:58:43.167

您可以使用更简单的 alter table 命令。

```
mysql> ALTER TABLE games ORDER BY name asc; 
```

就这样 ！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-02T08:37:15.170

很简单。只需使用一些代码。我已经尝试过了，它正在工作。首先创建一个临时表，同时对值进行排序。

```
 create table new as select * from games order by name; 
```

然后使用删除游戏桌，

```
 drop table games; 
```

现在再次使用与 new 相同的属性和数据创建游戏表（此处排序是可选的）使用，

```
 create table games as select * from new order by name; 
```

现在删除临时表“新”

```
 drop table new; 
```

现在检查你的桌子。必须对其进行整理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T20:59:48.670

您可以同时对两个字段进行排序。

```
SELECT *
FROM games
ORDER BY id DESC, name ASC 
```

我不明白您在表格中保存更改是什么意思。,`ORDER BY`只是更改您正在查看的显示它不会更改表中的数据，除非您执行`UPDATE`.

如果你对 SQL 不熟悉，网上有很多教程可以提供帮助：

[SQL 课程](http://www.sqlcourse.com/index.html)

[初级 SQL 教程](http://beginner-sql-tutorial.com/sql.htm)

[SQL 教程 - 学习 SQL](http://www.sql-tutorial.net/)

根据评论进行编辑，这可以一步完成：

```
create table #temp
(
    id int,
    name varchar(50),
    somedesc varchar(50)
)

insert into #temp values (1, 'best', 'desc1')
insert into #temp values (2, 'worth', 'desc2')
insert into #temp values (3, 'good', 'desc3')

update t1
SET t1.id = t2.rn
    , t1.somedesc = t1.somedesc
FROM #temp t1
JOIN 
(
    select id, name, somedesc, row_number() over(order by name, id) as rn
    from #temp 
) t2
on t1.id = t2.id

select *
from #temp
order by id

drop table #temp 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-23T21:03:11.463

这是我的解决方法......愚蠢的简单：

1.  提取到临时表

SELECT SortKeyValue *（添加任何其他固定值，只是不包括现有序列）* INTO #Temp FROM SourceTable;

2.  清空表：

截断表源表

3.  重新插入：

INSERT INTO SourceTable (SortKeyValue, DisplayOrder *(plus other fields)* ) SELECT SortKeyValue, ROW_NUMBER() OVER (ORDER BY SortKeyValue) AS DispOrd *(plus other fields)* FROM #Temp;

4.  完毕！

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2015-10-14T13:09:44.630

SQL> SELECT * FROM games ORDER BY ID,NAME;

# wpf - 操作事件未触发

> ID：10079751
> 
> 赞同：6
> 
> 时间：2012-04-09T20:56:03.877
> 
> 标签：wpf, pixelsense

我是在 WPF 中为触摸屏开发的新手，我在解释操作事件时遇到了麻烦。我相信我想做的事情相当简单：当用户捏住 UserControl 上的任何位置时，它将执行一个动作。

因此，在我拥有的控件中（这是 Surface 2.0 / Windows Touch）：

**XAML**

```
<Grid Background="White" IsManipulationEnabled="True" 
ManipulationStarting="Grid_ManipulationStarting" 
ManipulationDelta="Grid_ManipulationDelta">
    <!--Some content controls-->
</Grid> 
```

**C＃**

```
private void Grid_ManipulationStarting(object sender, ManipulationStartingEventArgs e)
{
    e.ManipulationContainer = this;
}

private void Grid_ManipulationDelta(object sender, ManipulationDeltaEventArgs e)
{
    //do the thing... you know, that thing you do
} 
```

但是，当我在屏幕上摩擦双手时，这些事件都不会触发。我想我一定不明白这种情况下事件的路由。我的显示器（3M MicroTouch PX）在理解触摸事件或 ScatterViewItems 中的内置操作方面没有任何问题。

编辑：我从网格内部删除了控件，它们现在触发了，所以我猜操作被内容拦截了。抱歉，应该更清楚地了解控件的内容，因为它们似乎是问题所在。

具体来说，我认为这与我里面有一个 SurfaceListBox 的事实有关。我想 SurfaceListBox 正在拦截操作。有什么办法可以让它走开吗？我仍在尝试围绕 WPF 执行事件的方式。

Edit2：要粘贴一些更完整的代码。

**SEMANTICPANEL.XAML 已满**

```
<UserControl x:Class="SemanticZoom.SemanticPanel"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         xmlns:local="clr-namespace:SemanticZoom"
         xmlns:views="clr-namespace:SemanticZoom.Views"
         mc:Ignorable="d" 
         d:DesignHeight="300" d:DesignWidth="300">
<UserControl.Resources>
</UserControl.Resources>
<Grid Background="White" IsManipulationEnabled="True" ManipulationStarting="Grid_ManipulationStarting" ManipulationDelta="Grid_ManipulationDelta">
    <views:CategoryView x:Name="CategoryView"/>
    <views:ShelfView x:Name="ShelfView" Visibility="Hidden" />
    <views:BookView x:Name="BookView" Visibility="Hidden" />
</Grid> 
```

**SEMANTICPANEL.CS 已满**

```
public partial class SemanticPanel : UserControl
{
    public SemanticPanel()
    {
        InitializeComponent();
        CategoryView.CategorySelected += new EventHandler(CategoryView_CategorySelected);
        ShelfView.BookSelected += new EventHandler(ShelfView_BookSelected);
        ShelfView.ZoomOut += new EventHandler(View_ZoomOut);
    }

    void View_ZoomOut(object sender, EventArgs e)
    {
        if (sender == ShelfView)
        {
            ShelfView.Visibility = System.Windows.Visibility.Hidden;
            CategoryView.Visibility = System.Windows.Visibility.Visible;
        }
        else if (sender == BookView)
        {
            BookView.Visibility = System.Windows.Visibility.Hidden;
            ShelfView.Visibility = System.Windows.Visibility.Visible;
        }
    }

    void ShelfView_BookSelected(object sender, EventArgs e)
    {
        BookView.Books = ShelfView.BookList;
        ShelfView.Visibility = System.Windows.Visibility.Hidden;
        BookView.Visibility = System.Windows.Visibility.Visible;
    }

    void CategoryView_CategorySelected(object sender, EventArgs e)
    {
        ShelfView.Category = CategoryView.ActiveCategory;
        ShelfView.Visibility = System.Windows.Visibility.Visible;
        CategoryView.Visibility = System.Windows.Visibility.Hidden;
        ShelfView.RefreshBooks();
    }

    private void Grid_ManipulationStarting(object sender, ManipulationStartingEventArgs e)
    {
        //e.ManipulationContainer = this;
    }

    private void Grid_ManipulationDelta(object sender, ManipulationDeltaEventArgs e)
    {
        if (e.DeltaManipulation.Scale.X < 0)
        {
            if (ShelfView.Visibility == System.Windows.Visibility.Visible)
            {
                ShelfView.Visibility = System.Windows.Visibility.Hidden;
                CategoryView.Visibility = System.Windows.Visibility.Visible;
            }
            else if (BookView.Visibility == System.Windows.Visibility.Visible)
            {
                BookView.Visibility = System.Windows.Visibility.Hidden;
                ShelfView.Visibility = System.Windows.Visibility.Visible;
            }
        }
    } 
```

**类别视图.XAML**

```
<UserControl x:Class="SemanticZoom.Views.CategoryView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         xmlns:s="http://schemas.microsoft.com/surface/2008"
         mc:Ignorable="d" 
         d:DesignHeight="300" d:DesignWidth="300">
<UserControl.Resources>
    <!--CATEGORY TEMPLATE-->
    <DataTemplate x:Name="CategoryTemplate" x:Key="CategoryTemplate">
        <s:SurfaceButton Background="Gray" Click="CategoryClicked" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Height="200" Width="300">
            <TextBlock Text="{Binding Name}" TextWrapping="Wrap" Foreground="White" FontSize="20" FontWeight="Bold" />
        </s:SurfaceButton>
    </DataTemplate>
    <!--CATEGORY STYLE-->
    <Style TargetType="{x:Type s:SurfaceListBoxItem}">
        <Setter Property="Width" Value="300"/>
        <Setter Property="Height" Value="200"/>
    </Style>
</UserControl.Resources>
<Grid>
    <s:SurfaceListBox x:Name="CategoryList" ItemTemplate="{StaticResource CategoryTemplate}">
        <s:SurfaceListBox.ItemsPanel>
            <ItemsPanelTemplate>
                <WrapPanel IsItemsHost="True"
                           Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type ScrollContentPresenter}, Mode=FindAncestor}}"/>
            </ItemsPanelTemplate>
        </s:SurfaceListBox.ItemsPanel>
    </s:SurfaceListBox>
</Grid> 
```

只是不要评判我，因为 a) 是的，我正在尝试模仿 Semantic Zoom，b) 是的，我正在做一个 hacky 工作。我只需要一个简单的工作概念。每个视图都与 CategoryView 基本相似。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T19:22:33.430

感谢您的帮助 Andriy，但问题似乎很简单，因为我的显示器太不敏感了。在我删除操作事件的所有内容的事件挂钩后，只在父网格中留下挂钩，然后用两根手指在屏幕上用力按下，我让事件触发。不过，可能需要在路由上多做一些事情。

# vb.net - VB.NET 中的“{0}”和“&”有什么区别？

> ID：10079757
> 
> 赞同：4
> 
> 时间：2012-04-09T20:56:24.187
> 
> 标签：vb.net, concatenation

请对我放松，因为我还在学习。

以下代码：

```
Imports System.Console

Module Module1

    Sub Main()
        Dim num As Integer
        Dim name As String

        num = 1
        name = "John"

        WriteLine("Hello, {0}", num)
        WriteLine("Hello, {0}", name)
        WriteLine("Hello, {0}", 1)
        WriteLine("Hello, {0}", "John")
        WriteLine("5 + 5 = {0}", 5 + 5)

        WriteLine()
    End Sub

End Module 
```

具有与此代码相同的输出：

```
Imports System.Console

    Module Module1

        Sub Main()
            Dim num As Integer
            Dim name As String

            num = 1
            name = "John"

            WriteLine("Hello, " & num)
            WriteLine("Hello, " & name)
            WriteLine("Hello, " & 1)
            WriteLine("Hello, " & "John")
            WriteLine("5 + 5 = " & 5 + 5)

            WriteLine()
        End Sub

    End Module 
```

两个输出：

> 你好，1
> 你好，约翰
> 你好，1
> 你好，约翰
> 5 + 5 = 10

我到处找，找不到答案。
何时使用*“{0}、{1}、...等”*？以及何时使用*“&”*？
哪个更好？为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T21:02:44.373

随着`{0}`您指定格式占位符，而`&`您只是连接字符串。

**使用格式占位符**

```
Dim name As String = String.Format("{0} {1}", "James", "Johnson") 
```

**使用字符串连接**

```
Dim name As String = "James" & " " & "Johnson" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-09T21:01:56.743

您在这里看到的是两个非常不同的表达式，它们恰好计算出相同的输出。

VB.Net 中的`&`运算符是字符串连接运算符。它本质上是通过将表达式的左侧和右侧都转换为 a`String`并将它们加在一起来工作的。这意味着以下所有操作*大致*等效

```
"Hello " & num
"Hello " & num.ToString()
"Hello " & CStr(num) 
```

这`{0}`是 .Net API 的一个特性。它表示字符串中的一个位置，稍后将替换为一个值。指的`{0}`是传递给函数的第一个值，`{1}`第二个等等。这意味着以下所有操作*大致*等效

```
Console.WriteLine("Hello {0}!", num)
Console.WriteLine("Hello " & num & "!") 
```

您看到相同输出的原因是因为放在`{0}`字符串的末尾几乎与两个值的字符串连接完全相同。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-09T21:04:32.907

使用`{N}`称为[复合格式](http://msdn.microsoft.com/en-us/library/txafckwd.aspx)。除了可读性之外，一个优点是您可以轻松设置对齐和格式属性。来自 MSDN 链接的示例：

```
Dim MyInt As Integer = 100
Console.WriteLine("{0:C}", MyInt)
' The example displays the following output
' if en-US is the current culture:
'        $100.00 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-09T21:03:17.007

{0} 是一个占位符，它与[String.Format](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)结合使用，以便进行更具可读性和性能的字符串替换。包括 WriteLine 在内的几个方法调用对 String.Format 有隐式调用。

使用连接的问题是每个连接操作都会创建一个新的字符串，这会消耗内存。

如果您正在执行大量替换，那么最好的性能将是使用[System.Text.StringBuilder](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)代替。

# jquery - 从选择列表中更改输入值。

> ID：10079759
> 
> 赞同：2
> 
> 时间：2012-04-09T20:56:41.753
> 
> 标签：jquery

我有两个文本输入框需要从同一个选择列表中填充，但每个文本框可能有不同的值。发生的情况是，我编写的代码允许您单击并更改值，但是当您尝试更改第二个值时，它会更改两个值而不仅仅是第二个值。我看过绑定，没有运气的文本。

输入框： `<input type="text" id="lensStyle" size="35" class="orderinput" tabindex="12"/> <input type="text" id="lensStyleLeft" size="35" class="orderinput" tabindex="12"/>`

从以下位置获取值：

```
<select class="longbox" size="14" id="lensStyleBox"></select> 
```

使用这个 Jquery

```
 $("#lensStyle").focus(function(){
        $("#lensStyleBox").click(function(){
            $("#lensStyle").val($("#lensStyleBox").val());
        });

    });

    $("#lensStyleLeft").focus(function(){
        $("#lensStyleBox").click(function(){
            $("#lensStyleLeft").val($("#lensStyleBox").val());
        });
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:12:14.697

随着焦点的变化，您需要取消绑定单击处理程序。这应该可以解决问题 - [http://jsfiddle.net/WPjgc/](http://jsfiddle.net/WPjgc/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T21:14:51.133

试试下面的代码，如果你希望文本框在焦点上填充你在下拉列表中的选择。

```
$("#lensStyle, #lensStyleLeft").focus(function(){
    $(this).val($("#lensStyleBox").val());
}); 
```

你在做什么似乎不正确。如果这不是您需要的，请告诉我们。

# parallel-processing - 为什么这个 Mathematica 7 Do 循环按顺序工作，但并行产生错误（使用 ParallelDo）？

> ID：10079761
> 
> 赞同：2
> 
> 时间：2012-04-09T20:57:07.367
> 
> 标签：parallel-processing, wolfram-mathematica, do-loops, mathematica-7

我正在运行 Mathematica 7，并且正在尝试`Do`使用`ParallelDo`. 以下标准的顺序代码可以正常工作：

```
len = 10;

A = Table[0, {len}];

Do[
 A[[i]] = i*10;
 , {i, 1, len}] 
```

但是，如果我使用`ParallelDo`而不是 standard `Do`，则此代码会给出错误消息：

```
len = 10;

A = Table[0, {len}];

ParallelDo[
 A[[i]] = i*10;
 , {i, 1, len}] 
```

我收到的错误消息是：

```
Set::noval: Symbol A in part assignment does not have an immediate value.
Set::noval: Symbol A in part assignment does not have an immediate value.
Set::noval: Symbol A in part assignment does not have an immediate value.
Set::noval: Symbol A in part assignment does not have an immediate value.
Set::noval: Symbol A in part assignment does not have an immediate value.
Set::noval: Symbol A in part assignment does not have an immediate value.
General::stop: Further output of Set::noval will be suppressed during this calculation.
General::stop: Further output of Set::noval will be suppressed during this calculation.
Set::noval: Symbol A in part assignment does not have an immediate value.
Set::noval: Symbol A in part assignment does not have an immediate value.
Set::noval: Symbol A in part assignment does not have an immediate value.
Set::noval: Symbol A in part assignment does not have an immediate value. 
```

我能做些什么来并行运行这个**Do循环吗？**

谢谢！

安德鲁·德扬

卡内基·梅隆大学

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T21:34:29.433

有什么理由不使用 a`ParallelTable`吗？

```
ParallelTable[i*10,{i, 1, len}] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T23:05:51.873

我在 Mathematica 8.0.1.0 上没有错误。

但是，代码可能不会按照您的意图执行，因为`A`它被复制到每个子进程（并且更改是该子进程的本地更改）。因此

```
ParallelDo[A[[i]] = i*10; Print@A, {i, 1, len}] 
```

印刷

![数学结果](../Images/ce15839fdb62ac76e1bcd35553ba8b41.png)

最终结果为`A`= {0, 0, ..., 0}。

相反，您应该`SetSharedVariable[A]`在初始化后添加`A`. 结果现在`{10,20,30,40,50,60,70,80,90,100}`正如预期的那样。

# java - 安卓语音认证库

> ID：10079769
> 
> 赞同：2
> 
> 时间：2012-04-09T20:57:36.543
> 
> 标签：java, android, authentication, libraries, voice

我正在制作一个应用程序，需要通过他/她的声音来识别用户以验证那个人。我已经搜索了谷歌，但它给了我语音识别或语音识别教程。是否可以在 android 中执行语音身份验证？

请指教。

提前致谢 ！！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-03T09:07:54.987

您可以使用[ViGo](http://voicevault.com/for-developers/)库进行语音生物识别。

# java - Java Slick2d - 从 spritesheet 加载图块抛出异常

> ID：10079782
> 
> 赞同：0
> 
> 时间：2012-04-09T20:58:45.853
> 
> 标签：java, sprite, slick2d

***块类***

```
public class Block {

public enum BlockType {
    Dirt,
    Grass,
    Selection
}

BlockType Type;
Vector2f Position;
Image texture;
boolean breakable;

public Block(BlockType Type, Vector2f Position, Image texture, boolean breakable) {
    this.Type = Type;
    this.Position = Position;
    this.texture = texture;
    this.breakable = breakable;
}

public BlockType getType() { 
    return Type; 
}
public void setType(BlockType value) {
    Type = value;
}

public Vector2f getPosition() { 
    return Position; 
}
public void setPosition(Vector2f value) { 
    Position = value; 
}

public Image gettexture() { 
    return texture; 
}
public void settexture(Image value) { 
    texture = value; 
}

public boolean getbreakable() { 
    return breakable; 
}
public void setbreakable(boolean value) { 
    breakable = value; 
} 
```

}

***瓦片生成类***

```
public class TileGen {

Block block;
public Block[] tiles = new Block[3];
public int width, height;
public int[][] index;
boolean selected;
int mouseX, mouseY;
int tileX, tileY;

Image dirt, grass, selection;
SpriteSheet tileSheet;

public void init() throws SlickException {
    tileSheet = new SpriteSheet("assets/tiles/tileSheet.png", 64, 64, new Color(0,0,0));

    grass = tileSheet.getSprite(0,0);
    dirt = tileSheet.getSprite(64,0);
    selection = tileSheet.getSprite(128,0);

    tiles[0] = new Block(BlockType.Grass, new Vector2f(tileX,tileY), grass, true);
    tiles[1] = new Block(BlockType.Dirt, new Vector2f(tileX,tileY), dirt, true);

    width = 50;
    height = 50;

    index = new int[width][height];

    Random rand = new Random();
    for (int x = 0; x < width; x++)
    {
        for (int y = 0; y < height; y++)
        {
            index[x][y] = rand.nextInt(2);
        }
    }
}

public void update(GameContainer gc) {
    Input input = gc.getInput();
    mouseX = input.getMouseX();
    mouseY = input.getMouseY();
    tileX = mouseX / width;
    tileY = mouseY / height;

    if(input.isMouseButtonDown(Input.MOUSE_LEFT_BUTTON)) {
        selected = true;
    }
    else{
        selected = false;
    }
    System.out.println(tileX);
}

public void render() {
    for (int x = 0; x < width; x++)
    {
        for (int y = 0; y < height; y++)
        {
            tiles[index[x][y]].texture.draw(x * 64, y *64);

            if(IsMouseInsideTile(x, y))
                selection.draw(x * 64, y * 64);
            if(selected && tiles[index[x][y]].breakable) {
                if(tiles[index[tileX][tileY]].texture == grass)
                    tiles[index[tileX][tileY]].texture = dirt;
            }
        }
    }
}

public boolean IsMouseInsideTile(int x, int y)
{
    return (mouseX >= x * 64 && mouseX <= (x + 1) * 64 &&
            mouseY >= y * 64 && mouseY <= (y + 1) * 64);
} 
```

我不确定我做错了什么，我是 slick2d 的新手。当我尝试从 spritesheet 初始化我的图块时，它会引发异常。我的 tileGen 类中的 init 是问题所在。

```
Exception in thread "main" java.lang.RuntimeException: SubImage out of sheet bounds: 64,0
at org.newdawn.slick.SpriteSheet.getSprite(SpriteSheet.java:208)
at com.synyst3r1.game.TileGen.init(TileGen.java:32)
at com.synyst3r1.game.Game.init(Game.java:23)
at org.newdawn.slick.AppGameContainer.setup(AppGameContainer.java:390)
at org.newdawn.slick.AppGameContainer.start(AppGameContainer.java:314)
at com.synyst3r1.game.Game.main(Game.java:50) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:51:06.257

(x, y) in[`getSprite()`](http://slick.cokeandcode.com/javadoc/org/newdawn/slick/SpriteSheet.html#getSprite%28int,%20int%29)是单元格位置，而不是像素位置。所以，你想要`getSprite(1, 0)`和`getSprite(2, 0)`（假设你的图像是 192x64）。

# javascript - 更多问题： .remove 第一次有效，但不再有效

> ID：10079783
> 
> 赞同：0
> 
> 时间：2012-04-09T20:58:57.807
> 
> 标签：javascript, raphael

在[这段](http://jsfiddle.net/BjMzH/)代码中。

我的“changeOrb”部分有问题，因为“手动”执行相同的步骤会产生正确的输出。

换句话说，如果我清除Orb，那么drawOrb 作为两个步骤起作用，但是changeStatus 函数会在同一个div 中导致两个'Orbs'。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:40:10.830

这不是不起作用的`.remove()`功能，而是您处理变量`child1`和`child2`.

我改变了一点流程，它可以工作。请看一看

[http://jsfiddle.net/BjMzH/25/](http://jsfiddle.net/BjMzH/25/)

# php - htaccess 在交付完全不同的脚本之前重写服务器上的执行脚本

> ID：10079784
> 
> 赞同：0
> 
> 时间：2012-04-09T20:58:59.150
> 
> 标签：php, apache, .htaccess

我的 /mobile 目录的 .htaccess：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

我的索引中有一个 mysql 查询，它基本上会增加页数，当我打开 m.mysite.net/style.css（即 /mobile/style.css）时，它会在服务器上执行 index.php，但仍会提供 style.css没有问题...如果 style.css 是可定位文件，为什么它会执行 index.php？

这是目录的apache配置：

```
<VirtualHost *:80>
     DocumentRoot /var/www/mobile
     ServerName m.mysite.com
     ServerAlias m.mysite.net
</VirtualHost> 
```

我怎样才能避免执行任何脚本而只提供绝对文件？我需要改变什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:52:27.207

您的 .htaccess 似乎是正确的。style.css 应该在没有 index.php 的情况下传递。

但。你可以在你的css中有图像，比如

```
background: url(/img/still/not/exists.png) 
```

此图像可能丢失，并且您有 index.php 调用。

无论如何，这当然是一个猜测:)

# c# - 决定让“null as string”返回 null 的理由是什么？

> ID：10079785
> 
> 赞同：1
> 
> 时间：2012-04-09T20:59:04.810
> 
> 标签：c#

除了向后兼容性之外，是否有任何令人信服的理由：

```
(null as string) == null; //true 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-09T21:03:01.467

`expr as T`方法

*   如果`expr`指向 的实例`T`，则`(T)expr`
*   `(T)null`， 除此以外

（并且`T`必须是可为空的类型）

无论您采用哪个分支`null as T`，`(T)null`对于任何`T`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-09T22:23:51.213

您的问题含糊不清，基本上无法回答，因此我不会尝试回答。如果您真正想要的是一篇关于运营商设计考虑的文章`as`，请参阅：

[http://blogs.msdn.com/b/ericlippert/archive/2009/10/08/what-s-the-difference-between-as-and-cast-operators.aspx](http://blogs.msdn.com/b/ericlippert/archive/2009/10/08/what-s-the-difference-between-as-and-cast-operators.aspx)

[http://blogs.msdn.com/b/ericlippert/archive/2010/09/16/is-is-as-or-is-as-is.aspx](http://blogs.msdn.com/b/ericlippert/archive/2010/09/16/is-is-as-or-is-as-is.aspx)

如果您对转换分析在 C# 类型系统中的作用这一更一般的主题感兴趣，请参阅：

[http://blogs.msdn.com/b/ericlippert/archive/tags/conversions/](http://blogs.msdn.com/b/ericlippert/archive/tags/conversions/)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-04-09T21:05:29.657

> 有什么令人信服的理由吗

是的，没有一个实例`System.String`可以将其转换`null`为非空实例。可以这样想：显然`null is string`应该评估为 false 因为`null`不引用`string`. 既然`null is string`是`false`，根据 的定义`null as string`，`null as string`应该是`null`。

> 超越向后兼容性

向后兼容什么？

让我把问题转给你？`string`您认为`null as string`应该评估什么非空实例？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-09T21:01:08.973

这只是因为空字符串引用等于空。如果您将其分解并显示“临时”变量，则更容易理解：

```
 string temporary = null as string;
 bool result = temporary == null; // Obviously true still 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-09T21:07:25.583

表达式`null as string`计算结果为 null 的原因与`(string)null`计算结果为 null 的原因相同：当您将 null 转换为字符串引用时，您将获得一个 null 字符串引用。

# mysql - MySQL 两次选择的平均值？

> ID：10079786
> 
> 赞同：1
> 
> 时间：2012-04-09T20:59:19.503
> 
> 标签：mysql, timestamp, union, average

我正在尝试获取两次选择的平均时间并返回它们以查看自上次订单以来经过的时间百分比。如果您想知道原因，它是早期警报系统的一部分。

选择 1 需要 5 个（几乎）最新的日期时间，例如记录 2-6 以获得一些最后订购产品的平均值。

选择 2（我认为它不起作用）取当前订单和 NOW() 的平均值，以查看自上次订单以来已经过去了多少时间。

回报应该是这些最近的订单和最后一个订单之间的平均时间。我的代码中显然有一些错误，无法让它工作......

我不知道，我希望有一些明显的东西会突出，比如我是如何搞砸 `UNION()`或混淆第二个的`TIMESTAMPDIFF()`

```
SELECT (spread + recent) / 2 AS lapse FROM 

    (SELECT TIMESTAMPDIFF(MINUTE, MIN(created_at), MAX(created_at) ) 
               /
               (COUNT(DISTINCT(created_at)) -1) 

          FROM (  SELECT created_at
            FROM dbname.sales_flat_order_status_history 
            ORDER BY created_at DESC LIMIT 5 OFFSET 1
             ) 

          AS created_at) AS spread,

UNION

    (SELECT TIMESTAMPDIFF(MINUTE, MIN(created_at), NOW() ) 
               /
               (COUNT(DISTINCT(created_at)) -1) 

          FROM (  SELECT created_at
            FROM dbname.sales_flat_order_status_history 
            ORDER BY created_at DESC LIMIT 1
             ) 

          AS created_at) AS recent;

ORDER BY lapse LIMIT 1; 
```

# c - 给线程分配工作 - MPI

> ID：10079787
> 
> 赞同：0
> 
> 时间：2012-04-09T20:59:25.893
> 
> 标签：c, mpi

我正在将一个值传递给我用 C 编写的 MPI 程序。因此，如果我传递一个值 5，我想将数字 5 分配给线程 1，将数字 4 分配给线程 2 等等。我该怎么做?

最后，我有一个 MPI reduce，它是所有这些值的乘积（5 * 4 * 3 ...），所以我真的不需要在线程中做任何事情，但我只需要向每个值传递不同的值线。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:55:04.123

这听起来像是一个作业，所以我只会写出伪代码。

1.  将值（例如 5）读入某个变量
2.  MPI_初始化
3.  使用 MPI_Comm_rank 获取 MPI 进程的等级
4.  在循环中，根据进程的等级为某个变量赋值
5.  在步骤 4 中初始化的变量上调用 MPI_Reduce。
6.  MPI_Finalize
7.  根据要求从单个/多个进程打印

即使我认为您实际上是指进程，而不是线程（正如 suszterpatt 已经在评论中指出的那样）。

# cocos2d-iphone - CCMenuItemImage 未显示选定状态

> ID：10079794
> 
> 赞同：2
> 
> 时间：2012-04-09T20:59:59.803
> 
> 标签：cocos2d-iphone, ccmenuitem

[CCMenuItemImage](http://www.cocos2d-iphone.org/api-ref/0.9.0-beta/interface_c_c_menu_item_image.html)的文档实际上并没有说明它的作用。

CCMenuItem 有很多子类。我继承了一个将其用作按钮的项目。

```
CCMenuItem *start;
start = [CCMenuItemImage itemFromNormalImage:[self prefixedImage:@"start button.png"]
                               selectedImage:[self prefixedImage:@"start button selected.png"]
                                      target:myTarget
                                    selector:@selector(start:)]; 
```

它对两种状态*都*使用相同的按钮。我对其进行了修改，以使所选状态具有不同的图像。

我期待/希望当我触摸该项目时它会突出显示，并且当我释放按钮时它会发送我的目标操作（它确实如此）。

（除此之外：用 iOS 的说法，我知道*这*是两个不同的东西。但是这个库似乎没有那个区别。）`highlighted``selected`

所以：

*   是否打算将此“菜单项”用作按钮？
*   何时显示此菜单项的选定图像？
*   我应该如何让它显示为选中状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:37:25.197

上面的代码是正确的。

供选择的图像资源**未添加到项目**中，因此未显示。它可能在创建时输出了错误消息（隐藏在其他输出中），但在点击时没有输出错误消息。

无声/安全故障使**用户错误**更难追踪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T05:35:21.130

试试这个代码...

```
CCMenuItemImage *backbtn = [CCMenuItemImage itemFromNormalImage:@"backbtn.png" selectedImage:@"backbtn_selected.png" target:self selector:@selector(LBback)];
CCMenu *Menu1 = [CCMenu menuWithItems:backbtn,nil];

[Menu1 alignItemsVerticallyWithPadding:15];
Menu1.position = ccp(160, 240);
[self addChild:Menu1]; 
```

借助此..当您触摸图像时，会显示所选图像，而其他明智的正常图像...:)

稍后当您的函数被调用并且您想要更改其图像时，您可以像这样设置..

```
 [backbtn setNormalImage:[CCSprite spriteWithFile:@"backbtn_selected.png"]]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T22:01:12.543

CCMenuItem 是一个抽象类，所有其他菜单项都从该类继承，因此您在代码中所做的在技术上是错误的。

另一方面，您可以将 CCMenuItem 子类化以创建自己的自定义类（例如：您不能将按钮和其上的标签用作菜单项，您必须使用按钮本身并且标签位于顶部。 .只是为了展示，或者使用标签和下面的按钮......毫无意义）

子类化 CCMenuItem 并创建自己的类可以解决这个问题（我的意思是你可以创建一个方法来获取图像和字符串并返回一个按钮）

你想在那里做的是：

```
 CCMenuItemImage *button= [CCMenuItemImage itemFromNormalImage:@"start button.png"
                           selectedImage:@"start button selected.png"
                                  target:self
                                selector:@selector(start:)];

 CCMenu *start=[CCMenu menuWithItems:button,nil];
start.position=ccp(200,200);
[self addChild:start]; 
```

当您将手指放在菜单上时，它将用选定的图像替换普通图像，但只会激活您在按钮的边界框中释放它（又名..您可以按下按钮，将手指从按钮，它不会激活）。因此，在某种意义上，该按钮会突出显示，直到您松开手指，然后将其选中。

这回答了你的问题吗？

# qt - 在 QToolbar 中添加标签

> ID：10079798
> 
> 赞同：6
> 
> 时间：2012-04-09T21:00:05.480
> 
> 标签：qt, label, qtoolbar

您如何建议在 QToolbar 上添加标签？因为它只接受动作或类似的东西。

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-30T08:53:25.907

正如 abresas 所写，可以使用[QAction](http://qt-project.org/doc/qt-4.8/qtoolbar.html#addAction-3)填充工具栏。与 QAction 一起传递的 QString 以多种方式使用（例如作为工具提示），但在 4.8 中，默认情况下仅显示带有图标的工具栏按钮。要显示带有图标的文本，请将工具栏设置为[Qt::ToolButtonStyle](http://qt-project.org/doc/qt-4.8/qt.html#ToolButtonStyle-enum)，例如

```
ui->toolBar->setToolButtonStyle( Qt::ToolButtonTextUnderIcon ); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-09T21:56:41.307

还通过方法`QToolBar`接受像 a 这样的小部件。`QLabel`[`QToolBar::addWidget`](http://qt-project.org/doc/qt-4.8/qtoolbar.html#addWidget)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-09T21:02:44.247

您只需将字符串传递给 addAction 方法。

[http://doc.qt.io/qt-5/qtoolbar.html](http://doc.qt.io/qt-5/qtoolbar.html)

```
QAction *   addAction ( const QString & text ) 
```

# java - 将 SPDY 与 Netty 一起使用

> ID：10079801
> 
> 赞同：7
> 
> 时间：2012-04-09T21:00:30.457
> 
> 标签：java, netty, spdy

我已经在我的 Apache 服务器上设置了 MOD_SPDY，现在想要改进我的客户端代码以使用 Netty 的 SPDY 实现通过 SPDY 通道将我的请求发送到服务器。

这是我第一次使用 Netty，所以我认为我需要以某种方式配置我的 Channel，然后通过它发送请求。问题是，似乎不太清楚如何配置通道，甚至在此之后，如何跟踪通道内可能同时执行的多个 HTTP 请求。

我用谷歌搜索并找到了 SPDY 包： http: [//netty.io/docs/stable/api/org/jboss/netty/handler/codec/spdy/package-summary.html](http://netty.io/docs/stable/api/org/jboss/netty/handler/codec/spdy/package-summary.html)

但是那里的文档仍然很薄。我似乎没有找到任何使用该代码的示例，只有在最新版本中存在它的公告。

有人有关于如何构建 SPDY 通道然后通过它发送/跟踪多个请求和响应的示例吗？此外，当服务器不支持 SPDY 并且通道回退到标准 SSL 连接时，此功能将如何发挥作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T08:51:34.080

我可以在 Netty 和 SPDY 上找到的唯一示例是 [SessionHandler](https://github.com/netty/netty/blob/master/codec-http/src/test/java/io/netty/handler/codec/spdy/SpdySessionHandlerTest.java)和 [socket echo test](https://github.com/netty/netty/blob/master/codec-http/src/test/java/io/netty/handler/codec/spdy/AbstractSocketSpdyEchoTest.java)的测试代码。我还没有让这个东西运行，但是你的客户应该制作由`SpdyFrameCodec`,`SpdySessionHandler`和你的处理程序组成的管道。

您的处理程序应该`EchoHandler`在会话测试中建模，因为这种方式`SpdySessionHandler`可以将原始帧解码为更有意义的帧，并按照 SPDY 协议的要求做一些事情。

至于后备，`SpdyHttpCodec`Netty 有从 SPDY 转换为 HTTP 的快照版本。这样，您可以根据 HTTP 构建客户端处理程序，并透明地接收通过 SPDY 或 HTTP 传入的消息。为此，需要实现类似于 [端口统一](http://netty.io/docs/stable/xref/org/jboss/netty/example/portunification/package-summary.html)示例的内容。

说了这么多。很少有实用程序类/处理程序有空间使所有这些成为“开箱即用”的体验。我想制作一个可行的示例，但现在缺少时间，并且代码太多，无法简单地将其粘贴在这里作为答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T07:52:42.763

将 spdy 与 jetty 结合使用的示例并不多。我通常不是无耻推销的人，但我只是写了一个完整的例子，告诉你如何做你想做的事。我已将 netty 配置为在客户端支持时为 spdy 提供服务，并在 spdy 不可用时回退到 http。您可以在以下位置找到代码：[http ://www.smartjava.org/content/using-spdy-and-http-transparently-using-netty](http://www.smartjava.org/content/using-spdy-and-http-transparently-using-netty)

# php - PHP 速记 If Else

> ID：10079806
> 
> 赞同：2
> 
> 时间：2012-04-09T21:00:55.183
> 
> 标签：php, if-statement

有没有办法执行以下操作，但简而言之 if/then 语法：

```
if($method->isAbstract()) {
   $details['abstract'] = true;
} 
```

如果我做：

```
$details['abstract'] = $method->isAbstract() ? true : null; 
```

不太一样，因为数组键`abstract`总是设置的。`isAbstract()`如果为真，我只会设置数组键。澄清一下，如果 isAbstract() 为假，请不要在数组中设置键。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T21:05:24.900

我手头没有 PHP 解释器，但我想这会起作用：

```
$method->isAbstract() && $details['abstract'] = true; 
```

更新：是的，它有效 → [http://codepad.org/lW23FR0j](http://codepad.org/lW23FR0j)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T21:23:39.070

我不会太担心尝试缩短三行代码，老实说无论如何都可以写在一行中：

```
if ( $obj->method() ) $data['key'] = 'value' ; 
```

但是，正如[@Mischa 的回答](https://stackoverflow.com/a/10079852/54680)所证明的，有更短的方法。您也可以使用逻辑运算符`&&`来执行赋值：

```
$obj->method() && $data['key'] = 'value' ; 
```

在此方法中，如果左边的表达式为“真”，则计算右边的表达式。

另一种方法是新的更短的三元运算符，它排除了第二个表达式。虽然您在原始问题中提出了长格式三元作为替代方案，但您也可以考虑自 PHP 5.3 以来提供的新格式

```
!$obj->method() ?: $data['key'] = 'value' ; 
```

由于我们没有使用第二个表达式，我们在第一个表达式中反转我们的测试。不再检查阳性，我们现在正在寻找阴性。当找到负数时，我们的分配就会发生。

我提供此答案并不是为了鼓励您避免使用 3 行解决方案，而只是为了鼓励您不时探索较短的解决方案，因为它们通常会导致您可能没有发现的语言部分。

# passwords - 丢失帐户的最佳密码重置行为

> ID：10079808
> 
> 赞同：2
> 
> 时间：2012-04-09T21:01:04.030
> 
> 标签：passwords, forgot-password

我想知道当用户请求为不存在的电子邮件重置密码时，最好的行为是什么。

上下文：用户未登录。他们只需输入电子邮件并点击重置按钮。

1.  如果我立即告诉请求重置的用户该帐户不存在，这既是一个安全漏洞，也是一个隐私问题。
2.  如果我什么都不做，这是一个无辜的错误（他们认为他们有一个帐户），他们会想知道到底发生了什么。最神秘的选择，最不容易被滥用。
3.  我可以发送一封电子邮件，说明已请求重置密码但没有帐户（应该忽略等等等等）。这似乎是最不有害的，但它有点受到滥用。

**更新**：进一步考虑，我真的不知道**1**有什么大不了的，因为他们可以通过简单地尝试注册/使用相同的电子邮件来获得相同的信息......除非我错过了什么......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:31:38.853

I personally would go this way:

1.  User enters e-mail address.
2.  Screen says "request will be processed, e-mail has been send" or something along those lines.
3.  If there is no account linked with this e-mail address: don't send a mail, but don't tell the guy requesting.
4.  If there is an account linked with this e-mail: send the reset e-mail including the usual "if this wasn't you simply ignore this mail, if you suspect abuse please contact $foobar"-message.

Here is why i would NOT tell anyone whether an account is linked with this e-mail address: Privacy. If you told everyone, everyone could check if $person is using $service.

Figured i would include why i wouldn't send a mail if there was no such user: Why should i? The user will probably either know which email address he used or try several at once (or only wait a short time span). Of course there are cases in which it would be a bit more userfriendly if one would send those mails, but they aren't important enough to negate the abuse potential. There is not much abuse potential if only one website does that stuff (as long as they wouldn't send multiple mails in a short timespan), but imagine every webservice going this way. You would just have to collect a few of those services and then emailbomb someone 'you' dislike, without hitting any spamfilter!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T21:04:18.707

就个人而言，我很喜欢：

*   用户输入电子邮件。
*   无论电子邮件是否存在，都说它已被请求，如果您没有很快收到电子邮件，请重试或联系我们。
*   在电子邮件中，说明已提交密码请求，如果不是用户，则忽略该电子邮件。

还，

*   如果您担心机器人会在您的网站上抓取电子邮件，请添加验证码。
*   如果您担心有人入侵帐户，请添加第二层以提示您提供秘密问题答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T21:10:23.043

在我看来，第三种选择是用户友好性和安全性之间的最佳折衷。选项 1 似乎是一个很大的隐私问题。使用选项 2，用户无法知道他是否有帐户，但使用另一个电子邮件地址注册，或者重置系统是否不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T22:40:25.307

我会做这样的事情

*   询问用户名或电子邮件
*   如果该电子邮件或用户名存在，请将所有电子邮件连同重置密码一起发送给此人。

完成的 ：）

# asp.net - 使用文件上传的详细信息触发 gridview

> ID：10079812
> 
> 赞同：1
> 
> 时间：2012-04-09T21:01:18.510
> 
> 标签：asp.net, gridview

我在 Modalpopup 窗口中处理文件上传。单击上传按钮时，我需要在我的 gridview 中显示文件的详细信息。单击按钮时，我需要 gridview 来触发文件信息。知道我该怎么做吗？

# javascript - 不满足条件时发出警报应保留在向导的同一窗格中

> ID：10079813
> 
> 赞同：0
> 
> 时间：2012-04-09T21:01:18.993
> 
> 标签：javascript

我正在尝试检查用户是否输入了特定信息......如果在单击向导窗格上的下一个按钮时输入，应该重定向到下一个窗格，否则应该在同一个窗格上..

我尝试了下面的代码..但是当用户不输入信息时，会弹出警报消息但它被重定向到下一页...我在做什么错误？任何帮助请...

```
checkinginfo: function () {

            if (!this.info) {
                alert("Enter info to proceed!");
                return false;
            }
            else
            return true;
        }, 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T15:36:21.370

e.preventDefault() 为我工作。

检查信息：功能（e）{

```
 if (!this.info) {
            alert("Enter info to proceed!");
            e.preventDefault();
        }
        else
        return true;
    }, 
```

# python - 将 celery 任务路由到特定队列

> ID：10079816
> 
> 赞同：6
> 
> 时间：2012-04-09T21:01:28.350
> 
> 标签：python, celery, supervisord

我的服务器上运行了两个独立的 celeryd 进程，由`supervisor`. 它们被设置为侦听单独的队列，如下所示：

```
[program:celeryd1]
command=/path/to/celeryd --pool=solo --queues=queue1
...

[program:celeryd2]
command=/path/to/celeryd --pool=solo --queues=queue2
... 
```

我的 celeryconfig 看起来像这样：

```
from celery.schedules import crontab

BROKER_URL = "amqp://guest:guest@localhost:5672//"

CELERY_DISABLE_RATE_LIMITS = True
CELERYD_CONCURRENCY = 1
CELERY_IGNORE_RESULT = True

CELERY_DEFAULT_QUEUE = 'default'
CELERY_QUEUES = {
    'default': {
        "exchange": "default",
        "binding_key": "default",
    },
    'queue1': {
        'exchange': 'queue1',
        'routing_key': 'queue1',
    },
    'queue2': {
        'exchange': 'queue2',
        'routing_key': 'queue2',
    },
}

CELERY_IMPORTS = ('tasks', )

CELERYBEAT_SCHEDULE = {
    'first-queue': {
        'task': 'tasks.sync',
        'schedule': crontab(hour=02, minute=00),
        'kwargs': {'client': 'client_1'},
        'options': {'queue': 'queue1'},
    },
    'second-queue': {
        'task': 'tasks.sync',
        'schedule': crontab(hour=02, minute=00),
        'kwargs': {'client': 'client_2'},
        'options': {'queue': 'queue1'},
    },
} 
```

所有`tasks.sync`任务都必须路由到特定队列（因此​​ celeryd 进度）。但是，当我尝试手动运行任务时，`sync.apply_async(kwargs={'client': 'value'}, queue='queue1')`两个芹菜工人都会接手任务。如何使任务路由到正确的队列并且仅由绑定到队列的工作人员运行？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T12:50:13.590

您只运行一个 celerybeat 实例，对吗？

也许您有与此冲突的旧队列绑定？尝试运行`rabbitmqctl list_queues`and `rabbitmqctl list_bindings`，也许将代理中的数据重置为从头开始。

您在这里的示例应该可以工作，并且在我刚尝试时对我有用。

提示：由于您使用与队列名称相同的 exchange 和 binding_key 值，因此不必在 CELERY_QUEUES 中显式列出它们。当 CELERY_CREATE_MISSING_QUEUES 开启时（默认情况下），如果您只是执行`celeryd -Q queue1`任务或将任务发送到未定义的队列，则会自动创建队列。

# c# - 查看数据库中的数据时出现 ASP.Net C# 错误

> ID：10079817
> 
> 赞同：1
> 
> 时间：2012-04-09T21:01:31.470
> 
> 标签：c#, visual-studio-2010, asp.net-mvc-3, foreach

在使用表单调用我刚刚更新到数据库的一些数据时，我遇到了错误。

我正在使用 Visual Studio Express 2010 MVC3 Razor（而且我对所有形式的开发都很陌生）。我已经填写了表格，单击了更新按钮，该按钮成功地将文本框中的文本存储到表格中，但是当我尝试在单独的页面上查看该数据时，出现此错误：

```
NullReferenceException was unhandled by user code.
Object reference was not set to an instance of an object. 
```

我相信这对大多数人来说是显而易见的，但我不确定我做错了什么。

感谢任何菜鸟的帮助，非常感谢。

==================================================== =================================

# “视图”的代码在这里：

```
@model IEnumerable<bhgc.Models.Data>

@{
ViewBag.Title = "Special Offers";
}

<fieldset>
<legend><h1>Special Offers</h1></legend>
@foreach (var data in Model)
{
<table>
<tr>
    <td>
        <strong>
             @Html.Raw(data.offer1.Replace(Environment.NewLine, "<br/>"))
        </strong>
    </td>
    <td>
        <strong>
             @Html.Raw(data.offer2.Replace(Environment.NewLine, "<br/>"))
        </strong>
    </td>
</tr>
<tr>    
    <td>
        <strong>
             @Html.Raw(data.offer3.Replace(Environment.NewLine, "<br/>"))
        </strong>
    </td>    
</tr>
</table>
}

</fieldset> 
```

==================================================== =================================

# 控制器在这里：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Data.Entity;
using bhgc.Models;

namespace bhgc.Controllers
{
public class HomeController : Controller
{
    private DataDBContext db = new DataDBContext();
    public ActionResult Index()
    {
        return View(db.Data.ToList());
    }

    public ActionResult Special()
    {
        return View();
    }

    public ActionResult Contact()
    {
        return View();
    }
}
} 
```

==================================================== =================================

# 从数据库读取的控制器：

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.Entity;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using bhgc.Models;

namespace bhgc.Controllers
{
[Authorize] //Created Validataion so inaccessible from outside
public class DataController : Controller
{
    private DataDBContext db = new DataDBContext();

    //
    // GET: /Data/

    public ViewResult Index()
    {
        return View(db.Data.ToList());
    }

    //
    // GET: /Data/Details/5

    public ViewResult Details(string id)
    {
        Data data = db.Data.Find(id);
        return View(data);
    }

    //
    // GET: /Data/Update

    public ActionResult Update()
    {
        var model = db.Data.FirstOrDefault();
        return View(model);
    }

    //
    // POST: /Data/Update

    [HttpPost]
    [ValidateInput(false)]
    public ActionResult Update(Data data)
    {
        if (ModelState.IsValid)
        {
            data.ID = 1; //EF need to know which row to update in the database.       
            db.Entry(data).State = EntityState.Modified;
            db.SaveChanges();
            return RedirectToAction("Special", "Home");
        }
        return View(data);
    }

}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:08:11.110

`db.Data`可能为空。检查它是否正在返回数据。但是，您的 foreach 可以处理这个问题。还要考虑`offer1, offer2,`或`offer3`可能为空。对空对象调用 Replace 也会引发该错误。

另外，请注意评论您的代码的人的建议。实际上有一些非常危险的习惯。

# javascript - 使用jQuery解析XML文档，有没有高效的方法

> ID：10079819
> 
> 赞同：1
> 
> 时间：2012-04-09T21:01:41.233
> 
> 标签：javascript, jquery, xml, xml-parsing, jquery-xml

例如，假设我有以下 XML 文档，我需要使用 jQuery 解析它。

```
 <books>
        <book>
            <title>Gone with the Wind!</title>
        </book
        <book>
            <title>Lord of the Rings</title>
        </book>
        <book>
            <title>4 hour work week</title>
        </book
    </books> 
```

为了获得第一本书的“标题”。我可以使用以下 jQuery 函数。

```
 // let's assume xmldoc contains the above document.
    $(xmldoc).find("title").first().text(); 
```

这会给我第一本书的*“标题”*，即*“乱世佳人！”* . 现在，我的问题是：这是获得**第一**本书“标题”的有效方法吗？

恐怕，jQuery 内部可能会解析所有书籍的标题，然后返回给我*first()*。我想知道，我是否在解析我不感兴趣的书籍时浪费了 CPU 周期？

如果您能想到任何方法，请提出替代方案。提前致谢！

**PS：**请注意，我不能使用浏览器的原生 javascript API，因为项目的其余部分已经使用 jQuery 进行 XML 解析。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T21:12:36.470

我无法谈论它的效率（为什么不对其进行基准测试？），但这里有一个替代表达式，它只使用一个选择器来实现相同的效果：

```
$( "book:first-child title", xmldoc ).text() 
```

正如@VincentMcNabb 指出的那样，jQuery 尽可能地尝试使用浏览器的内置功能。

# hid - HID 是否支持双向数据通信？

> ID：10079825
> 
> 赞同：2
> 
> 时间：2012-04-09T21:02:03.947
> 
> 标签：hid

我正在构建一个 HID 设备。有谁知道 HID 协议是否支持两种通信方式——主机可以向设备发送命令，例如，打开或关闭 LED、关闭电源等...？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:01:42.970

是的。[例如，可以使用hidmon](http://random-internet-node.de/projekte/hidmon)控制监视器（选择其视频输入，选择颜色模式等）。

# mysql - 将 C 连接到 mysql 时出现链接器错误

> ID：10079828
> 
> 赞同：3
> 
> 时间：2012-04-09T21:02:33.060
> 
> 标签：mysql, c, windows, visual-c++

我想使用以下代码将 C 连接到 mysql：

```
#include <C:\Program Files\MySQL\MySQL Connector C 6.0.2\include\my_global.h>
#include <C:\Program Files\MySQL\MySQL Connector C 6.0.2\include\mysql.h>

#include <stdio.h> 
MYSQL *conn;    /* pointer to connection handler */

int main ( int argc, char *argv[] )
{
    conn = mysql_init ( NULL );
    mysql_real_connect (
            conn,"localhost","root","","operator", 3306, NULL,0 );        
    mysql_close ( conn );
    return 0;
} 
```

当我尝试编译时，我得到：

```
Error   3   error LNK2019: unresolved external symbol _mysql_real_connect@32 referenced in function _main   C:\Users\kristel\Documents\Visual Studio 2010\Projects\database\database\database.obj   database

Error   4   error LNK2019: unresolved external symbol _mysql_init@4 referenced in function _main    C:\Users\kristel\Documents\Visual Studio 2010\Projects\database\database\database.obj   database 
```

好像有什么东西不见了，但我不知道什么时候。

![在此处输入图像描述](../Images/45c8ea39ad9ed8ae5c4dd1e9f285bef6.png)

我已经添加了图片中的 mysqllib.lib，但问题仍然没有解决。

**只是另一个问题：**在进行搜索时，我发现了一些关于 cmake 的内容。我的错误和 cmake 之间有什么关系吗？
谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:08:21.917

虽然您在代码中包含了 mySQL 头文件，但您还没有在链接选项中包含 mySQL 库。

# php - 在 htaccess 中为静态资源设置缓存过期

> ID：10079831
> 
> 赞同：1
> 
> 时间：2012-04-09T21:02:44.540
> 
> 标签：php, .htaccess, cache-control

我在下面的 htaccess 中添加了 FilesMatch 分支，但 google pagespeed 仍然抱怨设置缓存过期。此代码有效吗？

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

<FilesMatch "(?i)^.*\.(ico|flv|jpg|jpeg|png|gif|js|css)$">
ExpiresActive On
ExpiresDefault A2592000
</FilesMatch>

# END WordPress 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T21:22:15.297

我在我的大部分页面上都使用了这种模式，并取得了很好的成功。我把它放在 mod_rewrite 选项下。希望这可以帮助。

```
<ifModule mod_expires.c>
  ExpiresActive On
  ExpiresDefault "access plus 1 seconds"
  ExpiresByType text/html "access plus 1 seconds"
  ExpiresByType image/gif "access plus 2592000 seconds"
  ExpiresByType image/jpeg "access plus 2592000 seconds"
  ExpiresByType image/png "access plus 2592000 seconds"
  ExpiresByType text/css "access plus 604800 seconds"
  ExpiresByType text/javascript "access plus 216000 seconds"
  ExpiresByType application/x-javascript "access plus 216000 seconds"
</ifModule>
# compress text, html, javascript, css, xml:
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript 
```

# java - 泛型方法的返回类型

> ID：10079833
> 
> 赞同：3
> 
> 时间：2012-04-09T21:02:49.833
> 
> 标签：java, generics

例如，如果我有一个方法

```
public INode getNode(final int offset); 
```

我假设它没有添加任何东西来使方法返回类型通用，例如：

```
public <T extends INode> T getNode(final int offset); 
```

还是我错过了什么？我认为只有当参数之一是相同类型（或超/子类型）时，通用返回类型才有价值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T21:43:48.427

> ```
> public <T extends INode> T getNode(final int offset); 
> ```

这不仅不会向调用者提供任何额外的信息，而且是完全危险的：实现该方法签名的唯一方法是使用*未经检查*的强制转换，这不是类型安全的，因为方法的类型参数是由其调用者指定的（通过类型推断显式或隐式地），并且类型参数不适用于此方法的实现。例如，考虑以下程序：

```
class NodeCollection {
    private INode[] nodes = new INode[42];

    public <T extends INode> T getNode(final int offset) {
        return (T) nodes[offset];
    }

    public <T extends INode> setNode(final int offset, T node) {
        nodes[offset] = node;
    }
}

class ANode implements INode {}
class BNode implements INode {
    void foo();
}

public class Test {
    public static void main(String[] args) {
        NodeCollection nc = new NodeCollection();
        nc.setNode(0,new ANode());
        BNode b = nc.getNode(0); // throws ClassCastException (sic!)
    }
} 
```

最佳实践：不要使用未经检查的强制转换，除非您*真的*确定它在运行时类型正确。

> 我认为只有当参数之一是相同类型（或超/子类型）时，通用返回类型才有价值？

还有更多的情况，例如：

```
public <T> T getFavorite(Class<T> clazz) {
    return clazz.cast(favorites.get(clazz));
} 
```

或者

```
interface List<E> {
    E get(int index);
} 
```

或 Colin 答案中的示例，其中类型变量仅*作为类型参数*出现在返回类型中，由于类型擦除，这是可以接受的。

**编辑**：

> 我认为如果要转换为确切类型的节点，则没有类型保存方法（而不是 instanceof 必须在它之前）

当然有，叫做[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T21:31:16.950

`T`在您给出的示例中，除了强制实现的开发人员强制转换返回值（in ）之外，它并没有真正增加任何价值。（除非它有办法获得一个`T`值，但为此它需要调用另一个返回的方法`T`，所以你只是将演员表移动得更远一点。

因此，在您向我们展示的情况下，这并不是一个好主意。

* * *

在少数情况下，仅应用于返回值的泛型可能很有用。例如：

```
public static <T> Collection<T> generateCollection() {
    return new ArrayList<T>();
} 
```

这允许您创建一个对象`Collection`，`T`而无需进行任何强制转换。

或者，如果您希望开发人员执行实现以转换他的对象（主要在所述对象使用泛型时有效），示例来自`Collections`：

```
public static final <T> Set<T> emptySet() {
    return (Set<T>) EMPTY_SET;
} 
```

* * *

**资源：**

*   [angelikalanger.com：Java 泛型常见问题解答 - 泛型方法](http://www.angelikalanger.com/GenericsFAQ/FAQSections/ParameterizedMethods.html)

# vb.net - 逐页传递参数

> ID：10079835
> 
> 赞同：0
> 
> 时间：2012-04-09T21:02:54.903
> 
> 标签：vb.net, model-view-controller, parameters

我有一个用于填充网格视图的过滤器，并且 url 将包含：/example/grid?value1=1&value2=2

然后它将有一个指向第 2 页的链接，允许他们编辑某些内容。

然后，我希望他们单击​​一个链接，该链接将在以下相同参数下将它们发送回 gridview：/example/grid?value1=1&value2=2

这可能吗？我如何保持并填写 URL 值，以便它知道如何相应地重新填充网格视图？

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T21:06:39.330

好吧，既然您使用的是 MVC，您应该将参数添加到您的 Grid 控制器，以允许您传入参数，然后 url 将如下所示：

`/example/grid/1/2`

然后在您的代码中，您只需要在填充网格时读取参数并应用适当的逻辑。

# android - 有没有办法为人们免费下载您的应用程序提供促销/优惠券代码？

> ID：10079840
> 
> 赞同：65
> 
> 时间：2012-04-09T21:03:16.990
> 
> 标签：android, google-play, promotion-code

我需要一种分享我的应用程序的方法，以允许人们使用优惠券代码或促销代码或结帐代码免费下载它。我想将代码发布到板上，并在一段时间后使其无效。我的应用使用许可和应用内计费，因此邮寄 APK 可能不合适。我看到的最后一个问题是 6 个月大，所以我不知道是否有更新的解决方案可用。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-09T21:18:21.527

无法使用 Play 商店中的当前功能集来执行此操作。

您可以使用许可服务 (http://developer.android.com/guide/market/licensing) 或者应用内购买来产生类似的效果。但遗憾的是，您将不得不自己完成大部分工作。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2016-01-15T00:13:30.980

Google 最近启用了对付费应用和应用内购买的促销代码的支持。您首先需要通过您的 Google Play 商店开发者控制台设置促销活动：

[https://support.google.com/googleplay/android-developer/answer/6321495](https://support.google.com/googleplay/android-developer/answer/6321495)

或通过应用内促销添加对应用内购买代码的支持：

[https://developer.android.com/google/play/billing/billing_promotions.html](https://developer.android.com/google/play/billing/billing_promotions.html)

但请注意，可以创建的代码数量和类型存在限制：

> 对于每个应用，您每季度最多可以创建 500 个促销代码。要达到该限制，您可以使用付费应用和应用内促销代码的任意组合。
> 
> 以下是您可以达到应用促销代码限制的一些方法：
> 
> *   500 个付费应用促销代码，或
> *   一个应用内产品的 500 个促销代码，或
> *   250 个付费应用促销代码 + 一个应用内商品的 250 个促销代码，或
> *   五个应用内产品的 100 个促销代码

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-10T02:10:54.693

正如其他人所说，Android Market/Play 目前不支持此功能。我相信有一个功能请求，您可以投票/加注星标。如果您已经在使用应用内计费，那么自己实现这一点相当容易。您所需要的只是一个可以访问 Web 的数据库，这样您就可以检查优惠券代码是否有效。您可能希望实现某种恢复功能，以便人们在切换设备时可以重用代码。和/或设置优惠券使用上限，以便您可以防止人们共享优惠券代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-07T00:22:14.220

我想我有一个部分可行的方法来做到这一点。我使用许可服务，这并不难（比应用内计费容易 10 倍），并在我的应用程序中嵌入了到期时间，并将调试版本发布在网站上。在到期之前，它会忽略许可证服务器的响应。到期后，它会报告“未经许可的应用程序”，并带有购买选项。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-09T21:18:22.727

如果您通过第三方应用市场（例如 Appia）分发您的应用，则可以执行此操作。但是，此功能并未内置在 Google Play 中。

如果您希望向用户提供优惠券，以便他们可以在 Google Play 商店中免费下载付费应用程序，这是无法做到的。您要么需要使用另一个市场，要么自己分发付费应用程序。

# c - C 结构内存管理

> ID：10079843
> 
> 赞同：1
> 
> 时间：2012-04-09T21:03:45.460
> 
> 标签：c, pointers, memory-management, struct, member

另一个C问题：

假设我有一个具有类型指针成员的结构`char*`。

当我想初始化我调用的结构实例时`malloc`：

```
MyStruct* ptr = (MyStruct*)malloc(sizeof(MyStruct) 
```

然后为成员分配 256 字节的内存`char*`：

```
ptr->mem = (char*)malloc(sizeof(char)*256); 
```

当我调用时，指针成员和它指向的内存会发生什么 `free(ptr);`？当我用 valgrind 检查程序时，我发现我有内存泄漏，但是当我明确调用时，`free(ptr->member);`我仍然有内存泄漏，并且 valgrind 显示“无效的免费”错误

管理成员指向的内存的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T21:08:36.927

您必须先释放 ptr->member，然后再释放 struct

```
free(ptr->member);
free(ptr); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T21:16:01.293

只要您调用`free(ptr)`，其中的任何成员`ptr`都不再有效。你不能对他们做任何事。但是指向的内存`ptr->mem`仍然需要释放。因此，您必须`free(ptr->mem)`首先，或者以其他方式将该指针复制到某处，以便有一个有效的指向空闲的指针。

分配和释放复合结构的一般模式类似于（将它们包装在执行此操作的干净函数中很有帮助）：

```
MyStruct* MakeMyStruct() {
    MyStruct* ptr = malloc(sizeof(MyStruct)); //N.B. don't need cast if it's C
    ptr->mem = malloc(sizeof(char)*256);
    //initialise other members
    return ptr;
}

void DestroyMyStruct(MyStruct *ptr) {
    //Free members first, then the struct
    free(ptr->mem);
    free(ptr);
} 
```

如果某些成员本身是复杂的结构，则它们将依次被分配/释放，`MakeWhatever`而`DestroyWhatever`不是在上述两个函数中使用`malloc`and 。`free`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T21:08:24.793

经验法则是`free`每次（成功）调用都需要一个`malloc`（通常，这些调用以相反的顺序发生）。

如果你只有`free(ptr)`，那么你有内存泄漏（因为没有办法访问分配给 的内存`ptr->mem`）。如果你只是`free(ptr->mem)`，那么你还没有完全清除（不如内存泄漏那么糟糕）。

# dojo - 使用 Dojo 1.7 在网格中显示孩子

> ID：10079846
> 
> 赞同：0
> 
> 时间：2012-04-09T21:04:17.863
> 
> 标签：dojo, dojox.grid

我想以树/网格格式显示一些数据，如下所示：

```
MasterId     Title                       Date
  DetailId
  DetailId
MasterId     Title                       Date
  DetailId 
```

其中 ID、标题和日期是单独的列，而 DetailID 是 MasterId 的子项。当用户单击详细信息行时，我将执行一个操作。如果用户对列进行排序，我希望 DetailIds 保留其父 MasterId。

有没有办法使用库存的 Dojo 组件来做到这一点？dojox.grid.TreeGrid 看起来很接近，但据我所知，当您展开子项时，DetailId 将进入它们自己的列，我希望它们与 MasterId 保持在同一列中。

如果没有开箱即用的方法来做到这一点，我应该尝试子类化 TreeGrid 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T16:52:25.907

好吧，事实证明 dojox.grid.TreeGrid 是我正在寻找的，但我不知道 dijit.tree.ForestStoreModel。这个例子正是我想要做的：

[http://archive.dojotoolkit.org/nightly/dojotoolkit/dojox/grid/tests/test_treegrid_model.html](http://archive.dojotoolkit.org/nightly/dojotoolkit/dojox/grid/tests/test_treegrid_model.html)

# wpf - WPF - 部署问题 - 错误模块名称：KERNELBASE.dll

> ID：10079850
> 
> 赞同：2
> 
> 时间：2012-04-09T21:05:05.367
> 
> 标签：wpf

我正在尝试安装和运行我的第一个 WPF 应用程序，但遇到了一些问题。我已经建立了一个安装项目，一切似乎都安装正确，我的所有第三方 dll 都被复制，目录被创建等等......当我尝试运行应用程序时，它会立即出现以下错误：

错误应用程序名称：app.exe，版本：1.0.0.0，时间戳：0x4f8343f3 错误模块名称：KERNELBASE.dll，版本：6.1.7600.16850，时间戳：0x4e211485 异常代码：0xe0434352 错误偏移：0x0000b9bc 错误进程 id：0xdec 错误应用程序启动时间：0x01cd168e7b8a64fc 错误应用程序路径：C:\Program Files (x86)\Some Dir\Some APP\app.exe 错误模块路径：C:\Windows\syswow64\KERNELBASE.dll 报告 ID：bad81009-8281-11e1- 93ec-f4501845bd18

我该如何调试这个？我已将 InitializeComponent() 包装在 try/catch 中，但我什么也没得到？

话虽如此，如果我将调试目录的内容复制到我试图安装应用程序的同一台电脑上的程序文件目录，然后运行 ​​exe，一切正常？在我的设置项目中我需要做些什么不同的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T14:55:56.467

我遇到了完全相同的问题，希望你现在已经解决了，所以我正在为其他重定向到这里的人写这个。我正在通过 MSI 可执行文件安装项目，但问题是，我的项目中的一个文件（不是安装程序项目）在其属性中的“复制到输出目录”下被标记为“始终复制”。这个项目是我的 MSI 项目的一个依赖项，但是“复制到输出”文件没有被复制到 MSI 文件中，您还必须手动在 MSI 项目中的每个文件。希望这篇文章有意义！

编辑：这可能是从调试文件夹复制文件有效的原因，您包括以前未由 MSI 本身复制的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-21T17:14:45.017

遇到了同样的问题，但在我的情况下，我在从主窗口引用的页面的构造函数中触发了一个异常。糟糕的编码，但在这里提到它是因为在呈现主窗口之前构建 WPF 页面并不总是很明显。

# javascript - 为什么我的大多数 jquery 函数在将消息附加到现有消息列表后停止工作？

> ID：10079857
> 
> 赞同：1
> 
> 时间：2012-04-09T21:05:31.263
> 
> 标签：javascript, jquery, jquery-selectors

HTML：

```
<div class='cf' id='content'>
    <div id='leftColumn'>
    </div>
    <div class='microposts'>
      <div class="micropostContent">
      </div
    </div>
    <div id='rightColumn'>
  </div>
</div> 
```

前置：

```
$('.micropostContent').prepend('<%= j render("users/partials/micropost") %>'); 
```

一些功能：

```
$(".micropost_content").focus(function() {
    this.rows = 7;

    var micropostBox = $(this),
        xButton = $(this).parent().find(".xButton");

          micropostBox.hide().addClass("micropost_content_expanded").show().autoResize();  
          xButton.css("display", "block");

                xButton.click(function() {
                    micropostBox.removeClass("micropost_content_expanded").addClass("micropost_content");
                    micropostBox.val("");
                    xButton.hide();

                });

});

$(".comment_box").focus(function() {
    this.rows = 7;

    var $commentBox = $(this),
        $form = $(this).parent(),
        $cancelButton = $form.children(".commentButtons").children(".cancelButton");

            $(this).removeClass("comment_box").addClass("comment_box_focused").autoResize();  
            $form.children(".commentButtons").addClass("displayButtons");

            $form.children(".commentButtons").children(".cancelButton");

                $cancelButton.click(function() {
                    $commentBox.removeClass("comment_box_focused").addClass("comment_box");
                    $form.children(".commentButtons").removeClass("displayButtons");
                    $commentBox.val("");

                });

});

$('.micropostOptions').on('click',function(){
    var postMenu = $(this).find('.postMenu');

    if(postMenu.is(':hidden') ){
        $('.postMenu').hide();
        $('.micropostOptions').removeClass("postMenuHoverState");
        postMenu.show();
        $(this).hide().addClass('postMenuHoverState').show(60);

    }else{
        postMenu.hide();
        $(this).removeClass("postMenuHoverState");
    }

}); 
```

停止工作的功能是焦点和点击功能。它们只有在刷新后才能再次工作，直到我发布另一条 ajax 消息/微博。

.comment_box 函数不适用于预先添加的消息，但它适用于所有先前的消息。.micropostOptions 功能并非全部工作。然后刷新后一切正常。

我错过了什么吗？

亲切的问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T21:18:54.393

因为事件仅在您声明它们时绑定到现有项目.. 声明使用 on 并附加到父元素

```
$(document).on("focus", ".comment_box", function() {
//this will work with new elements 
}); 
```

父级越接近您要附加功能的元素越好，例如父级容器“.cf”或“.microposts”，而不是您的案例中的文档。

详细地说，在您的示例中，您只是将事件绑定到单个元素，并且当添加新项目时，它们没有相同的事件绑定......当您将事件绑定到更高级别的元素时，那么您就是基本上是说“将此处理程序应用于此父元素内与此选择器匹配的所有内容”。

# css - Firefox CSS 图像框

> ID：10079858
> 
> 赞同：0
> 
> 时间：2012-04-09T21:05:32.513
> 
> 标签：css, firefox

此 CSS 代码在除 FireFox 之外的所有浏览器中都有效。为什么 ？我该如何解决？

```
.img_box {
  width: 110px;
  height: 160px;
  background-repeat: no-repeat;
  background-position: center center;
  background-image: url('https://www.google.com/images/srpr/logo3w.png');
} 
```

提前致谢。

**编辑：** 这是我要使用的 HTML：

```
<img class="img_box" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:17:26.953

当 Firefox 遇到没有来源的图像时，它会用它的 alt 文本替换图像。我个人觉得这非常烦人，因为这意味着除非我专门创建占位符图像，否则我无法测试布局，并且如果这些图像因任何原因不可用，布局会完全中断。

不幸的是，我还没有找到解决这个问题的方法。

但是，在您的情况下，您最好使用 a`div`并添加`display:inline-block`到您的 CSS，而不是使用图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T22:19:15.053

**解决方案1：**

```
.img_box {
  width: 110px;
  height: 160px;
  background-repeat: no-repeat;
  background-position: center center;
  background-image: url('https://www.google.com/images/srpr/logo3w.png');
  display: block;
} 
```

**解决方案2：**

```
<div class="img_box"></div> 
```

# css - 可以在不实际隐藏溢出的情况下实现溢出隐藏的效果吗？

> ID：10079860
> 
> 赞同：0
> 
> 时间：2012-04-09T21:05:36.600
> 
> 标签：css, overflow

我有一个绝对定位的图像滑块，宽度为 1280 像素。margin-left 是 -160px 以使其在其父级中居中。父宽度为 960 像素，边距设置为“0 auto”以实现居中效果。

图片滑块应该只占用 width:960px 以便溢出不会导致浏览器使用滚动条来处理它。是否可以在高屏幕分辨率下显示溢出内容的同时实现溢出：隐藏？

问题示例：[http ://almightyidea.com/test/slider/](http://almightyidea.com/test/slider/)

基本的CSS：

```
.slide-wrapper {
  position:relative;
  width:960px;
  margin:0 auto;
 }

.slideshow{
    position:absolute !important;
    margin-left:-160px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T21:39:20.273

我认为您应该为包装器使用相对宽度。因此，当有足够的空间时，让它扩大。您还可以使用 JavaScript 为您计算 viweport 的宽度并将该宽度设置为包装器。

您也可以只使用现有的 jQuery 插件来完成所有繁重的工作。当我需要做这样的事情时，我会使用 Cycle。[http://jquery.malsup.com/cycle/](http://jquery.malsup.com/cycle/)

# django - Django URL 与 GET 变量不匹配

> ID：10079862
> 
> 赞同：7
> 
> 时间：2012-04-09T21:05:45.933
> 
> 标签：django

我有以下 Django URL：

```
url(r'^companies/$', 'companies', name='companies'), 
```

如果我去`http://localhost:8000/companies/`它完美的作品。但是，如果我尝试将任何 GET 变量添加到 URL django 会引发 404。例如，如果我去`http://localhost:8000/companies/?c=1`django 会引发 404。奇怪的是，在 404 上它说：

> 当前 URL`companies/`与其中任何一个都不匹配。

为什么我无法将 GET 变量传递给我的 URL？

我正在使用 django 1.4。

公司视图定义如下：

```
def companies(request): 
```

它不应该接受任何额外的参数，因为它们是 GET 变量，而不是 URL 参数——对吗？我发誓我已经这样做了数百次，并且总是有效...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-09T21:21:44.880

好的。弄清楚是什么导致了这种非常奇怪的行为。我有一个正在调用的自定义上下文处理器`resolve(request.get_full_path())`。显然，如果 URL 中有任何 GET 变量，则会导致 404。很奇怪。

# sql - Where 子句返回满足三个条件中至少两个的值

> ID：10079863
> 
> 赞同：5
> 
> 时间：2012-04-09T21:05:51.967
> 
> 标签：sql, sql-server-2008, where-clause

我正在尝试编写一个 where 子句，该子句将找到满足三个条件中至少两个的人。这是一个例子

```
 SELECT *
   FROM Personal
   WHERE
   [State] = 'Tx' or [City] = 'Austin' or [Gender] = 'Male' 
```

所以它应该返回住在德克萨斯州和奥斯汀的任何人或住在德克萨斯州并且是男性的人等等，但不是只住在德克萨斯州的人，他们必须满足至少两个标准

我的真实查询可以有更多的条件，还包括大于两个或正好两个等等。

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T21:10:27.990

您可以在一系列 case ... then 1 else 0 end 语句中添加匹配项，并将最终结果与所需匹配项的数量进行比较：

```
 SELECT *
   FROM Personal
   WHERE
     case when [State] = 'Tx' then 1 else 0 end
     + case when [City] = 'Austin' then 1 else 0 end
     + case when [Gender] = 'Male' then 1 else 0 end
     >= 2 
```

或者，您可以将其分解为 union all 列表：

```
SELECT *
FROM   personal
       INNER JOIN (SELECT id
                   FROM   (SELECT id
                           FROM   personal
                           WHERE  state = 'Tx'
                           UNION ALL
                           SELECT id
                           FROM   personal
                           WHERE  city = 'Austin'
                           UNION ALL
                           SELECT id
                           FROM   personal
                           WHERE  gender = 'Male') a
                   GROUP  BY id
                   HAVING COUNT (*) >= 2) a
         ON personal.id = a.id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T21:08:09.390

```
 SELECT *
   FROM Personal
   WHERE
   ([State] = 'Tx' AND [City] = 'Austin') or ([State] = 'Tx' AND [Gender] = 'Male') 
```

# javascript - jQuery 在 Chrome 18 中不起作用

> ID：10079867
> 
> 赞同：1
> 
> 时间：2012-04-09T21:06:18.520
> 
> 标签：javascript, jquery, google-chrome

jQuery 中的任何内容似乎都不适用于我的 Chrome。我的版本是 18.0.1025.151 m。javascript 在文件*test.js 中*：

```
$('#paragraph').click(function() {
$('#paragraph').hide();
}); 
```

html是这样的：

```
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>jQuery Example</title>

    <script src="jquery-1.7.1.min.js"></script>
    <script src="test.js"></script>
</head>
<body>
    <p id="paragraph">This is my paragragh 401!</p>
</body>
</html> 
```

我已经三重检查了 jQuery 文件是否在它应该在的位置。本质上，该代码应该使该段落在单击时消失。看起来很简单，语法正确。我选择了这样一个简单的代码，因为虽然常规的 javascript 语句和代码可以正常工作（例如 alert() 和诸如此类的东西），但到目前为止，jQuery 中绝对没有任何工作。

这是奇怪的部分。在 Chrome 的开发人员工具中使用控制台时，如果我输入完全相同的 jQuery 内容并按 Enter 键，它实际上可以正常工作并按应有的方式运行。

这和 Chrome 的安全结构有什么关系吗？

**编辑：**另外，我应该注意我还没有在我的服务器上上传这些文件。这是在本地主机上（我正在使用**xammp**来证明它的价值），所以也许这可能有助于阐明这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T21:09:17.003

将代码包装在准备好的文档中，或放在`test.js`结束正文标记之前。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T21:10:35.633

它在 DOM 准备好之前执行。它应该如下所示：

```
$(function(){
    $('#paragraph').click(function() {
        $('#paragraph').hide();
    });
}); 
```

要解决以下评论：

[http://api.jquery.com/ready/](http://api.jquery.com/ready/)

> .ready() 方法通常与匿名函数一起使用：

```
$(document).ready(function() {
  // Handler for .ready() called.
}); 
```

> 这相当于调用：

```
$(function() {
 // Handler for .ready() called.
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T21:10:36.207

您必须将其包装在准备好的文档中。那可能是你的问题。您也可以使用`$(this)`或缓存选择器。

```
$(function () {
    $('#paragraph').click(function () {
        $(this).hide();
    });
}); 
```

# javascript - 尝试在页面加载时显示随机视频

> ID：10079870
> 
> 赞同：0
> 
> 时间：2012-04-09T21:06:34.133
> 
> 标签：javascript, html

我正在尝试在页面加载时加载随机视频。这是我认为可能有用的一些 javascript。我对javascript不太熟悉，所以可能有更简单的方法来做到这一点......有什么想法吗？

```
function random_video {

    var string1 = '<div class="span4"><h3 class="meet">Meet the Makers</h3><iframe width="100%" height="200" src="http://www.youtube.com/embed/Ig-DbfPoz3o" frameborder="0" allowfullscreen></iframe></div>';

    var string2 = '<div class="span4"><h3 class="meet">Meet the Makers</h3><iframe width="100%" height="200" src="http://www.youtube.com/embed/estPhyfBGho" frameborder="0" allowfullscreen=""></iframe></div>';

    var string3 = '<div class="span4"><h3 class="meet">Meet the Makers</h3><iframe width="100%" height="200" src="http://www.youtube.com/embed/6JL4hpnZklk" frameborder="0" allowfullscreen=""></iframe></div>';

    var number = Math.floor((Math.random()*3)+1);

    if ( number == 1) {
      document.write(string1);
    } else ( number == 2 ) {
        document.write(string2);
    } else ( number == 3 ) {
        document.write(string3);
    }

}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T21:15:03.957

如果您使用数组，会更通用，更容易添加更多视频：

```
var videos = [
    'Ig-DbfPoz3o',
    'estPhyfBGho',
    '6JL4hpnZklk'
];

var index=Math.floor(Math.random() * videos.length);
var html='<div class="span4"><h3 class="meet">Meet the Makers</h3><iframe width="100%" height="200" src="http://www.youtube.com/embed/' + videos[index] + '" frameborder="0" allowfullscreen></iframe></div>';
document.write(html); 
```

# java - 使用 Pidgin 测试 XMPP Camel 路由

> ID：10079873
> 
> 赞同：2
> 
> 时间：2012-04-09T21:06:44.960
> 
> 标签：java, xmpp, apache-camel

我有，我认为，是 Java 中的工作骆驼路线，我正在尝试确认它正在发送消息。我希望我可以使用 Pidgin 来确认这一点。Camel 在 ServiceMix 中运行。

Camel 路线看起来与此非常相似（来自[apache 站点](http://camel.apache.org/xmpp.html)）：

```
from("timer://kickoff?period=10000").
setBody(constant("I will win!\n Your Superman.")).
to("xmpp://superman@jabber.org/joker@jabber.org?password=secret"); 
```

其中超人和小丑是各自的用户名，并且“jabber.org”被替换为我运行 OpenFire 的本地 IP。我曾希望 Pidgin 会弹出一个带有消息文本的消息窗口，但似乎并非如此。

这是测试我的路线的合适方法还是我应该考虑另一种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T17:09:37.670

我从来没有使用过 XMPP，所以可能帮不上什么忙，但我要做的第一件事是在 Camel 中[启用跟踪](http://camel.apache.org/tracer.html)，看看到底发生了什么。通常，它至少可以为您提供一个线索，为什么它不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T19:50:15.707

弄清楚了。

我注意到一个名为“监控服务”的插件并安装了它。我现在看到用户之间传递的消息。

# javascript - 所有库之后脚本中的匿名函数

> ID：10079874
> 
> 赞同：3
> 
> 时间：2012-04-09T21:06:51.703
> 
> 标签：javascript, html

只是想知道使用该样式是否有任何好处：`(function() { <code> })();`在您的脚本文件中继续库脚本。基本上是设置事件侦听器和其他初始化逻辑的地方。
例如：

```
<script>
(function() {
     $('div').on('click', 'a', function() {
          alert('click');
     });
})();
</script> 
```

对比

```
<script>
     $('div').on('click', 'a', function() {
          alert('click');
     });
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:08:28.177

不，第一个只是额外的代码。

现在可能会出现第一个会阻止创建全局变量的情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T21:14:06.970

在这种情况下，自执行匿名函数的要点是避免在不需要真正的全局时定义全局函数或变量。由于您的示例两者都没有，因此在这种情况下不需要它。

自执行匿名函数为您提供了一个私有闭包来定义您想要的任何内容，并且它与外界隔离。它不会与任何外部代码发生冲突，并且外部代码不能直接访问闭包内的函数和变量。

至于你关于它是否是标准做法的问题，这真的取决于你。我个人认为这是一个好主意，因为这样您就可以自由定义辅助函数或偶尔的全局函数，而无需触及实际的全局空间。如果您正在使用`$(document).ready(fn)`，那么您的初始化代码周围已经有一个闭包，因此您已经在这方面做好了准备。如果没有，这取决于你。我个人认为这是一个好主意，并且认为将其作为标准做法几乎没有缺点。当然，你必须记住，如果你需要一个真正的全局变量或函数，那么你必须在`window`对象上定义它，以便它在你的闭包之外可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T21:08:58.813

您需要使用 jQuery(document).ready(function(){...}); 模型来设置事件监听器，否则嗯......好吧，jQuery 不会准备好。

# wcf - 处理需要 Web 服务的应用程序 - 处理 EndpointNotFoundExceptions

> ID：10079875
> 
> 赞同：0
> 
> 时间：2012-04-09T21:06:58.017
> 
> 标签：wcf, windows-phone-7, crash, connection, marketplace

我几乎完成了我的第一个 WP7 应用程序，我想将它发布到市场。但是，对于已发布的应用程序的一项规定是，它在使用过程中不得意外崩溃。

我的应用程序几乎完全依赖于 WCF Azure 服务——因此我必须始终连接到 Internet 才能使我的功能正常工作（与托管数据库通信）——包括登录、添加/删除/编辑/搜索客户端等等。

当未连接到 Internet 时，或者在使用过程中连接断开时，对 Web 服务的调用将导致应用程序退出。我该如何处理？我认为连接到服务的失败会被捕获，我可以处理异常，但它不能以这种方式工作。

```
 LoginCommand = new RelayCommand(() =>
        {
            ApplicationBarHelper.UpdateBindingOnFocussedControl();
            MyTrainerReference.MyTrainerServiceClient service = new MyTrainerReference.MyTrainerServiceClient();

            // get list of clients from web service
            service.LoginCompleted += new EventHandler<LoginCompletedEventArgs>(service_LoginCompleted);

            try
            {
                service.LoginAsync(Email, Password);
            }
            **catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }**
            service.CloseAsync();
        }); 
```

编辑：

我的主要问题是如何在 WP7 中处理 EndpointNotFoundException 而不会导致应用程序崩溃。

谢谢，

杰拉德。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T21:43:11.387

您的代码应如下所示

```
LoginCommand = new RelayCommand(Login);
...

public void Login()
{
    var svc = new MyTrainerReference.MyTrainerServiceClient();
    try
    {
        svc.LoginCompleted += LoginCompleted;
        svc.LoginAsync();
    }
    catch (Exception e)
    {
        svc.CloseAsync();
        ShowError(e);
    }
}

private void LoginCompleted(object sender, LoginCompletedEventArgs e)
{
    ((MyTrainerReference.MyTrainerServiceClient)sender).LoginCompleted -= LoginCompleted;
    ((MyTrainerReference.MyTrainerServiceClient)sender).CloseAsync();

    if (e.Error == null && !e.Cancelled)
    {
        // TODO process e.Result
    }
    else if (!e.Cancelled)
    {
        ShowError(e.Error);
    }
}

private void ShowError(Exception e)
{
    // TODO show error
    MessageBox.Show(e.Message, "An error occured", MessageBoxButton.OK);
} 
```

您的代码调用`LoginAsync`然后立即`CloseAsync`，我认为这会导致问题......

# c - 将邻接矩阵转换为距离或跳跃矩阵

> ID：10079876
> 
> 赞同：5
> 
> 时间：2012-04-09T21:07:04.213
> 
> 标签：c, matlab, linear-algebra, adjacency-matrix, distance-matrix

是否可以将此处定义的 1 和 0 的***邻接矩阵***[转换为此处](http://en.wikipedia.org/wiki/Adjacency_matrix#Examples)定义的***距离矩阵***[，](http://en.wikipedia.org/wiki/Distance_matrix#Examples_and_uses) 其中每个链接的单位长度为 1？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T21:08:38.083

1 和 0 的邻接矩阵只是无向图的表示。要获取未加权图的任意两个顶点之间的距离，可以使用[广度优先搜索](http://en.wikipedia.org/wiki/Breadth-first_search)。

假设您有一个`n`by`n`矩阵：

```
for each vertex i:
    initialize an nxn matrix M
    run breadth-first search starting at i
    copy distances into row i of M
    return M 
```

# sql-server - 查找多边形重叠

> ID：10079879
> 
> 赞同：3
> 
> 时间：2012-04-09T21:07:13.603
> 
> 标签：sql-server, tsql, sql-server-2012

我必须找到多边形重叠并获得它们的几何形状。有人知道该怎么做吗？

这是多边形表：

```
DECLARE @Table TABLE (
  id varchar(32),
  shape geometry);

INSERT INTO @Table VALUES
('California', geometry::Parse('POLYGON((-124.23 41.96, -119.97 41.93, -119.97 38.99, -113.95 34.30, -114.69 32.62, -117.11 32.43, -122.25 36.10, -124.23 41.96))')),
('Western US', geometry::Parse('POLYGON((-124.71 48.69, -102.97 48.86, -102.88 31.72, -117.15 32.39, -124.01 39.50, -124.71 48.69))')),
('US', geometry::Parse('POLYGON((-124.62 48.86, -94.57 48.98, -80.68 42.09, -66.88 45.02, -82.26 28.69, -98.96 26.90, -116.80 32.62, -124.36 39.77, -124.62 48.86))')),
('Colorado', geometry::Parse('POLYGON((-108.98 40.91, -108.98 36.87, -101.95 36.87, -101.95 40.91, -108.98 40.91))')); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T21:18:55.567

这行得通吗？

```
SELECT
    T.id
    , O.id
    , T.shape.STIntersection(O.shape) Intersection
FROM @Table T
INNER JOIN @Table O
    ON T.shape.STIntersects(T.shape) = 1
    AND T.id > O.id 
```

# python - django 管理站点显示格式不正确

> ID：10079881
> 
> 赞同：0
> 
> 时间：2012-04-09T21:07:14.747
> 
> 标签：python, django, django-admin

我有一个 django 测试站点，我可以看到管理站点，但它的格式与教程示例不同。

这是我的管理网站的外观：

![在此处输入图像描述](../Images/a4bd9e55de8fdf1f552392330e6eaa88.png)

但在示例中，它看起来像这样：

![在此处输入图像描述](../Images/2434d83255e463a68da8876c299770f4.png)

缺少什么来显示正确的格式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T21:10:48.000

看起来您的 CSS 文件没有被加载。确保您的 django 安装正确设置为服务器输出静态文件。默认情况下，CSS 文件位于`/static/admin/css`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-28T22:36:54.457

从 settings.py 中取消注释 INSTALLED_APPS 下的“django.contrib.staticfiles”。

# objective-c - 如何使用三角函数？

> ID：10079886
> 
> 赞同：0
> 
> 时间：2012-04-09T21:07:37.737
> 
> 标签：objective-c, xcode4.2

我想知道如何使用三角函数（一个例子会很有帮助），以及我必须导入什么才能使用它们。他们在 math.h 中是否有 and 之类的`pow()`东西`sqrt()`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T21:17:45.203

您只想使用 sin() cos() 之类的东西吗？如果是这样，你甚至不需要导入 math.h，只要你有：`#import <Foundation/Foundation.h>`在你的头文件中。你可以做类似的事情`double result = cos(12);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T21:21:23.670

您可以像在 C 中一样使用基本的 C 函数，毕竟 Objective-C 是 C 的超集，而不是另一种语言

例如：

```
double root = sqrt(x); //where x is a value 
```

等等..我假设你知道怎么做

无论如何[，这里](http://www.codecogs.com/code/computing/c/math.h/index.php)有一些带有数学函数、解释和示例的 C 语言示例。这些应该按原样在目标 c 中工作。

# asp.net-mvc - 无法从asp mvc项目中的iis上的Content文件夹加载图像

> ID：10079887
> 
> 赞同：4
> 
> 时间：2012-04-09T21:07:51.433
> 
> 标签：asp.net-mvc, iis, iis-7

在 Visual Studio 虚拟服务器中，这是可行的。但是当我将站点放在 IIS 上时，它不会显示内容文件夹中的图像。

```
 var imgPath = '/Content/Images/Icons/' + icon + '.png';
                var imageContent = '@Server.MapPath(Url.Content("-1"))';
                image = imageContent.replace('-1', imgPath); 
```

我在浏览器 foreach 图像中遇到错误

```
http://localhost/Content/Images/Icons/carwash.png Failed to load resource: the server responded with a status of 404 (Not Found) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T21:50:25.293

首先，您确定您的所有“图标”都是解决方案的一部分并且实际上正在部署到您的 Web 服务器上吗？我有几个实例，我会在解决方案目录中添加一个文件，而 VS 不会自动将解决方案包含在其中，因此它实际上从未被部署......

如果没问题并且图像确实在那里，我的下一个问题是，您是否尝试过仅`@Url.Content`在视图中使用帮助器来确定它是否正常工作？

```
<img src="@Url.Content("~/Content/Images/Icons/SomeIcon.png")"/> 
```

**编辑**

由于您尝试在 Javascript 中完成此操作，并且上述标记在 HTML 中工作，您应该能够将该代码压缩为以下代码：

```
var image = '@Url.Content("~/Content/Images/Icons/")' + icon + '.png'; 
```

继续，让 MVC 获取 Icon 文件夹的路径并将您的文件和扩展名附加到该文件夹​​。这应该消除对字符串替换的需要，并且仍然能够处理 JS 中的图标路径。

`var image`现在将是您传递给此函数的图标文件的完整相对路径。您可以使用此字符串来更新和 img src 标签或创建图像或其他任何内容。

# doctrine-orm - 在 Doctrine 2.2 中反映 MySQL 多态关联

> ID：10079897
> 
> 赞同：2
> 
> 时间：2012-04-09T21:08:28.550
> 
> 标签：doctrine-orm, codeigniter-2

我将 Doctrine 2.2.0 与 Codeigniter 一起使用。我是 Doctrine 的新手（或者一般来说是 ORM 的新手）。

我正在基于 YAML 文件设置实体和代理类，效果很好。我在我的 Doctrine 类中反映我的数据库中的多态关联时确实存在问题。我正在寻找一个关于如何在 Doctrine 中实现以下多态关联的具体示例。

在我的数据库中，我有一个名为 products 的表。根据字段的值，`object_type`我`object_id`想与表格视频或表格汽车中的记录相关（我在这里简化了）。我想将两种产品类型保留在 2 个单独的表中，因为一个与另一个无关，并且两个表都与其他表相关。

我查看了 Doctrine Inheritance 文档和其他示例，但它似乎对我没有帮助。**如果可能的话，我想避免添加列`description`和`price`表格 videos 和 cars**。

非常感谢！

```
|Table: products                                      |
|-----------------------------------------------------|
| ID | description | price  | object_type | object_id |
|-----------------------------------------------------|
| 1  | A video     | 20.00  | video       | 12        |
| 2  | A car       | 159.00 | car         | 5         |

|Table: videos                               |
|--------------------------------------------|
| ID | filename     | artist_id | date       |
|--------------------------------------------|
| 12 | somename.mp4 | 189       | 2011-02-15 |

|Table: cars                   |
|------------------------------|
| ID | brand_id | model | year |
|------------------------------|
| 5  | 17       | astra | 2010 | 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T15:44:18.787

自己找到了解决方案。我在下面列出了我已完成的不同步骤。这个答案很大，但我尽量做到完整。

最重要的内容在 Product YAML 文件`inheritanceType: JOINED`中`discriminatorColumn:`，`discriminatorMap:`以及 Video 和 Car 实体类`class Video extends Product`中`class Car extends Product`。

### 1) 数据库模式

```
CREATE TABLE IF NOT EXISTS `artists` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB;

CREATE TABLE IF NOT EXISTS `brands` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB;

CREATE TABLE IF NOT EXISTS `cars` (
  `id` int(11) NOT NULL,
  `model` varchar(255) NOT NULL,
  `release_date` date NOT NULL,
  `brand_id` int(11) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB;

CREATE TABLE IF NOT EXISTS `products` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `description` varchar(255) NOT NULL,
  `price` double NOT NULL,
  `object_type` varchar(255) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB;

CREATE TABLE IF NOT EXISTS `videos` (
  `id` int(11) NOT NULL,
  `file_name` varchar(255) NOT NULL,
  `release_date` date NOT NULL,
  `artist_id` int(11) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB; 
```

### 2) Doctrine YAML 文件（您需要从中创建实体和代理类）

**实体.Artist.dcm.yml**

```
Entities\Artist:
    type: entity
    table: artists
    id:
        id:
            type: integer
            primary: true
            notnull: true
            generator:
                strategy: AUTO
    fields:
        name:
            type: string(255)
            notnull: true
    oneToMany:
        videos:
            targetEntity: Video
            mappedBy: artist
    options:
        charset: utf8
        type: InnoDB 
```

**实体.品牌.dcm.yml**

```
Entities\Brand:
    type: entity
    table: brands
    id:
        id:
            type: integer
            primary: true
            notnull: true
            generator:
                strategy: AUTO
    fields:
        name:
            type: string(255)
            notnull: true
    oneToMany:
        cars:
            targetEntity: Car
            mappedBy: brand
    options:
        charset: utf8
        type: InnoDB 
```

**实体.Car.dcm.yml**

```
Entities\Car:
    type: entity
    table: cars
    fields:
        model:
            type: string
            notnull: true
        release_date:
            type: date
            notnull: true
    oneToOne: #unidirectional    
        brand:
            targetEntity: Brand
            joinColumns:
                brand_id:
                    referencedColumnName: id
    options:
        charset: utf8
        type: InnoDB 
```

**实体.Product.dcm.yml**

```
Entities\Product:
    type: entity
    table: products
    id:
        id:
            type: string
            primary: true
            notnull: true
            generator:
                strategy: AUTO
    fields:
        description:
            type: string(255)
            notnull: true
        price:
            type: decimal
            notnull: true
    inheritanceType: JOINED
    discriminatorColumn:
        name: object_type
        type: string
        length: 255
    discriminatorMap:
        video: Video
        car: Car
    options:
        charset: utf8
        type: InnoDB 
```

**实体.视频.dcm.yml**

```
Entities\Video:
    type: entity
    table: videos
    fields:
        file_name:
            type: string
            notnull: true
        release_date:
            type: date
            notnull: true
    oneToOne: #unidirectional    
        artist:
            targetEntity: Artist
            joinColumns:
                artist_id:
                    referencedColumnName: id
    options:
        charset: utf8
        type: InnoDB 
```

### 3) 创建实体和代理类

我使用 CodeIgniter。[我使用了 Joel Verhagen 的优秀指南](http://www.joelverhagen.com/blog/2011/05/setting-up-codeigniter-2-with-doctrine-2-the-right-way/)

！！使用产品扩展视频和汽车很重要 - 见下文！

这导致以下实体类

**艺术家.php**

```
namespace Entities;

use Doctrine\ORM\Mapping as ORM;

/**
 * Entities\Artist
 *
 * @ORM\Table(name="artists")
 * @ORM\Entity
 */
class Artist
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @var string $name
     *
     * @ORM\Column(name="name", type="string", length=255)
     */
    private $name;

    /**
     * @var \Doctrine\Common\Collections\ArrayCollection
     *
     * @ORM\OneToMany(targetEntity="Entities\Video", mappedBy="artist")
     */
    private $videos;

    public function __construct()
    {
        $this->videos = new \Doctrine\Common\Collections\ArrayCollection();
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set name
     *
     * @param string $name
     * @return Artist
     */
    public function setName($name)
    {
        $this->name = $name;
        return $this;
    }

    /**
     * Get name
     *
     * @return string 
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Add videos
     *
     * @param Entities\Video $videos
     */
    public function addVideo(\Entities\Video $videos)
    {
        $this->videos[] = $videos;
    }

    /**
     * Get videos
     *
     * @return Doctrine\Common\Collections\Collection 
     */
    public function getVideos()
    {
        return $this->videos;
    }
} 
```

**品牌.php**

```
namespace Entities;

use Doctrine\ORM\Mapping as ORM;

/**
 * Entities\Brand
 *
 * @ORM\Table(name="brands")
 * @ORM\Entity
 */
class Brand
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @var string $name
     *
     * @ORM\Column(name="name", type="string", length=255)
     */
    private $name;

    /**
     * @var \Doctrine\Common\Collections\ArrayCollection
     *
     * @ORM\OneToMany(targetEntity="Entities\Car", mappedBy="brand")
     */
    private $cars;

    public function __construct()
    {
        $this->cars = new \Doctrine\Common\Collections\ArrayCollection();
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set name
     *
     * @param string $name
     * @return Brand
     */
    public function setName($name)
    {
        $this->name = $name;
        return $this;
    }

    /**
     * Get name
     *
     * @return string 
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Add cars
     *
     * @param Entities\Car $cars
     */
    public function addCar(\Entities\Car $cars)
    {
        $this->cars[] = $cars;
    }

    /**
     * Get cars
     *
     * @return Doctrine\Common\Collections\Collection 
     */
    public function getCars()
    {
        return $this->cars;
    }
} 
```

**汽车.php**

```
namespace Entities;

use Doctrine\ORM\Mapping as ORM;

/**
 * Entities\Car
 *
 * @ORM\Table(name="cars")
 * @ORM\Entity
 */
class Car extends Product //Important that Car extends Product
{
    /**
     * @var string $model
     *
     * @ORM\Column(name="model", type="string")
     */
    private $model;

    /**
     * @var date $release_date
     *
     * @ORM\Column(name="release_date", type="date")
     */
    private $release_date;

    /**
     * @var Entities\Brand
     *
     * @ORM\OneToOne(targetEntity="Entities\Brand")
     * @ORM\JoinColumns({
     *   @ORM\JoinColumn(name="brand_id", referencedColumnName="id", unique=true)
     * })
     */
    private $brand;

    /**
     * Set model
     *
     * @param string $model
     * @return Car
     */
    public function setModel($model)
    {
        $this->model = $model;
        return $this;
    }

    /**
     * Get model
     *
     * @return string 
     */
    public function getModel()
    {
        return $this->model;
    }

    /**
     * Set release_date
     *
     * @param date $releaseDate
     * @return Car
     */
    public function setReleaseDate($releaseDate)
    {
        $this->release_date = $releaseDate;
        return $this;
    }

    /**
     * Get release_date
     *
     * @return date 
     */
    public function getReleaseDate()
    {
        return $this->release_date;
    }

    /**
     * Set brand
     *
     * @param Entities\Brand $brand
     * @return Car
     */
    public function setBrand(\Entities\Brand $brand = null)
    {
        $this->brand = $brand;
        return $this;
    }

    /**
     * Get brand
     *
     * @return Entities\Brand 
     */
    public function getBrand()
    {
        return $this->brand;
    }
} 
```

**产品.php**

```
namespace Entities;

use Doctrine\ORM\Mapping as ORM;

/**
 * Entities\Product
 *
 * @ORM\Table(name="products")
 * @ORM\InheritanceType("JOINED")
 * @ORM\DiscriminatorColumn(name="", type="", length=)
 * @ORM\DiscriminatorMap({"video" = "Entities\Video", "car" = "Entities\Car"})
 * @ORM\Entity
 */
class Product
{
    /**
     * @var string $id
     *
     * @ORM\Column(name="id", type="string")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @var string $description
     *
     * @ORM\Column(name="description", type="string", length=255)
     */
    private $description;

    /**
     * @var decimal $price
     *
     * @ORM\Column(name="price", type="decimal")
     */
    private $price;

    /**
     * Get id
     *
     * @return string 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set description
     *
     * @param string $description
     * @return Product
     */
    public function setDescription($description)
    {
        $this->description = $description;
        return $this;
    }

    /**
     * Get description
     *
     * @return string 
     */
    public function getDescription()
    {
        return $this->description;
    }

    /**
     * Set price
     *
     * @param decimal $price
     * @return Product
     */
    public function setPrice($price)
    {
        $this->price = $price;
        return $this;
    }

    /**
     * Get price
     *
     * @return decimal 
     */
    public function getPrice()
    {
        return $this->price;
    }
} 
```

**视频.php**

```
namespace Entities;

use Doctrine\ORM\Mapping as ORM;

/**
 * Entities\Video
 *
 * @ORM\Table(name="videos")
 * @ORM\Entity
 */
class Video extends Product //Important that Video extends Product
{
    /**
     * @var string $file_name
     *
     * @ORM\Column(name="file_name", type="string")
     */
    private $file_name;

    /**
     * @var date $release_date
     *
     * @ORM\Column(name="release_date", type="date")
     */
    private $release_date;

    /**
     * @var Entities\Artist
     *
     * @ORM\OneToOne(targetEntity="Entities\Artist")
     * @ORM\JoinColumns({
     *   @ORM\JoinColumn(name="artist_id", referencedColumnName="id", unique=true)
     * })
     */
    private $artist;

    /**
     * Set file_name
     *
     * @param string $fileName
     * @return Video
     */
    public function setFileName($fileName)
    {
        $this->file_name = $fileName;
        return $this;
    }

    /**
     * Get file_name
     *
     * @return string 
     */
    public function getFileName()
    {
        return $this->file_name;
    }

    /**
     * Set release_date
     *
     * @param date $releaseDate
     * @return Video
     */
    public function setReleaseDate($releaseDate)
    {
        $this->release_date = $releaseDate;
        return $this;
    }

    /**
     * Get release_date
     *
     * @return date 
     */
    public function getReleaseDate()
    {
        return $this->release_date;
    }

    /**
     * Set artist
     *
     * @param Entities\Artist $artist
     * @return Video
     */
    public function setArtist(\Entities\Artist $artist = null)
    {
        $this->artist = $artist;
        return $this;
    }

    /**
     * Get artist
     *
     * @return Entities\Artist 
     */
    public function getArtist()
    {
        return $this->artist;
    }
} 
```

### 3) 创建新汽车和新视频

这就是我的 CodeIgniter 控制器中的内容。该代码假定您创建了一个名为 Metallica 的艺术家和一个名为 Ford 的品牌。

```
public function createVideo()
{
    //Instantiate new Entities\Video object
    $video = new Entities\Video;

    //Since it extends Entities\Product you can set the common Product properties
    $video->setDescription('This is a Metallica clip');
    $video->setPrice(19.95);

    //Setting the custom Video properties
    $artist = $this->doctrine->em->getRepository('Entities\Artist')->findOneBy(array('name' => 'Metallica'));
    $video->setArtist($artist);
    $video->setReleaseDate(new DateTime());
    $video->setFileName('metallica.mp4');

    //Save
    $this->doctrine->em->persist($video);
    $this->doctrine->em->flush();
}

public function createCar()
{
    //Instantiate new Entities\Car object
    $car = new Entities\Car;

    //Since it extends Entities\Product you can set the common Product properties
    $car->setDescription('This is Ford Mondeo of 2011');
    $car->setPrice(19.95);

    //Setting the custom Car properties
    $brand = $this->doctrine->em->getRepository('Entities\Brand')->findOneBy(array('name' => 'Ford'));
    $car->setBrand($brand);
    $car->setReleaseDate(DateTime::createFromFormat('Y-m-d', '2011-11-15'));
    $car->setModel('Mondeo');

    //Save
    $this->doctrine->em->persist($car);
    $this->doctrine->em->flush();
} 
```

### 4）提取所有产品

关于如何提取所有产品的示例

```
public function extractAllProducts()
{
    $products = $this->doctrine->em->getRepository('Entities\Product')->findAll();
    foreach($products as $product)
    {
        printf('%s for € %s<br />', $product->getDescription(), $product->getPrice());
    }
} 
```

这导致

```
This is a Metallica clip for € 19.95
This is Ford Mondeo of 2011 for € 19.95 
```

如何提取所有视频的示例

```
public function extractAllVideos()
{
    $videos = $this->doctrine->em->getRepository('Entities\Video')->findAll();
    foreach($videos as $video)
    {
        printf('%s, released %s for € %s<br />', $video->getDescription(),  $video->getReleaseDate()->format('Y'), $video->getPrice());
    }
} 
```

这导致

```
This is a Metallica clip, released 2012 for € 19.95 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:36:28.290

您找对地方了，继承映射当然是实现这一目标所需要的。据我所知，这是“类表继承”的完美示例。

查看手册以获取有关如何实现此功能的示例/说明。

[http://docs.doctrine-project.org/projects/doctrine-orm/en/2.0.x/reference/inheritance-mapping.html#class-table-inheritance](http://docs.doctrine-project.org/projects/doctrine-orm/en/2.0.x/reference/inheritance-mapping.html#class-table-inheritance)

# label - 自定义 MSCHART 标签

> ID：10079908
> 
> 赞同：0
> 
> 时间：2012-04-09T21:09:54.300
> 
> 标签：label, mschart

如何格式化 mschart 中的标签，使其包含 X-Value 和数据库中的其他值，如下所示：

12 公斤 , 200 磅 , 45 升

让我们称它为 MeasureUnit 值，它与每个 X 值不同

请帮帮我

我试过了，但标签总是显示为 0

```
 Chart1.Series(0).Points.DataBind(Data, XValue, YValue, "Label=" & YValue & ControlChars.Lf & LabelUnit) 
```

这是答案：

```
 Chart1.Series(0).Points.DataBind(Data, XValue, YValue, "Unit=" & LabelUnit)
    Chart1.Series("Series1").XValueMember = XValue
    Chart1.Series("Series1").YValueMembers = YValue

   For Each pnt As DataPoint In Chart1.Series(0).Points
        pnt.Label = "#VAL" & ControlChars.Lf & pnt.GetCustomProperty("Unit")

    Next
    Chart1.Series("Series1").IsValueShownAsLabel = True
    Chart1.Series("Series1").ToolTip = "#VAL" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:00:32.007

您可以使用 AxisLabel 属性

```
chart1.Series[i].Points[i].AxisLabel = yourValue; // here yourValue is the value returned by database 
```

或者，如果您的系列已经有数据，您可以这样做

```
foreach (DataPoint dp in s.Points)
{
     dp.AxisLabel = dp.XValue + "yourUnit" ; // or write your own logic here
} 
```

# mysql - 数据集太大而无法加载到内存中进行处理

> ID：10079911
> 
> 赞同：2
> 
> 时间：2012-04-09T21:10:04.090
> 
> 标签：mysql, ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

我有一个更大的快速增长的数据集，大约有 400 万行，为了定义和排除异常值（用于统计/分析用途），我需要算法来考虑该数据集中的所有条目。然而，这是太多的数据加载到内存和我的系统阻塞。我目前正在使用它来收集和处理数据：

```
@scoreInnerFences = innerFence Post.where( :source => 1 ).
                                    order( :score ).
                                    pluck( :score ) 
```

使用典型的分治法是行不通的，我不认为因为必须考虑每个条目以保持我的异常值计算准确。如何有效地实现这一目标？

`innerFence`识别数据集的下四分位数和上四分位数，然后使用这些发现来计算异常值。这是（尚未重构，非 DRY）代码：

```
def q1(s)
  q = s.length / 4

  if s.length % 2 == 0
    return ( s[ q ] + s[ q - 1 ] ) / 2
  else
    return s[ q ]
  end
end

def q2(s)
  q = s.length / 4

  if s.length % 2 == 0
    return ( s[ q * 3 ] + s[ (q * 3) - 1 ] ) / 2
  else
    return s[ q * 3 ]
  end
end

def innerFence(s)
  q1 = q1(s)
  q2 = q2(s)

  iq = (q2 - q1) * 3

  if1 = q1 - iq
  if2 = q2 + iq

  return [if1, if2]
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:09:19.677

这不是最好的方法，但它是一种简单的方法：

做几个查询。首先你计算分数的数量：

q = Post.where(:source => 1).count

然后你做你的计算然后你获取分数

q1 = Post.where(:source => 1)。reverse_order（：分数）。选择（“平均（分数）作为分数”）。偏移量(q).limit((q%2)+1)

q2 = Post.where(:source => 1)。reverse_order（：分数）。选择（“平均（分数）作为分数”）。偏移量(q*3).limit((q%2)+1)

代码可能是错误的，但我相信你明白了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:00:52.930

对于大型数据集，我有时会下拉到 ActiveRecord 下方。即使我想，它也是一个记忆猪，使用 pluck。当然它的便携性较差，但有时它是值得的。

score = Post.connection.execute('从 score > 1 order by score 的帖子中选择分数').map(&:first)

不知道这是否对 400 万条记录有足够的帮助。如果没有，也许看看存储过程？

# c# - c#概率和随机数

> ID：10079912
> 
> 赞同：9
> 
> 时间：2012-04-09T21:10:06.507
> 
> 标签：c#, random, probability

我已经以多种方式看到过这个问题，但我只需要对我在这里所做的事情进行一次健全的检查。

基本上，我想根据在 1 到 100 之间生成的随机数使用以下方法触发概率为 25% 的事件：

```
int rand = random.Next(1,100); 
```

以下会实现这一点吗？

```
if (rand<=25)
{
    // Some event...
} 
```

我想我会使用 1 到 100 之间的数字，以便稍后调整概率 - 例如通过使用调整到 23%

```
if (rand<=23) {...} 
```

谢谢参观。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-09T21:14:44.770

您犯的最大错误应该是`random.Next(0,100)`文档[所述](http://msdn.microsoft.com/en-us/library/2dx6wyd4.aspx)

> minValue：返回的随机数的包含下限。
> 
> maxValue：返回的随机数的**独占**上界。maxValue 必须大于或等于 minValue。

强调我的，独占意味着它不包括您传入的数字，因此我的代码生成范围 0-99，而您的代码生成范围 1-99。

因此，将您的代码更改为

```
int rand = random.Next(0,100)

if (rand < 25) //25%
{
    // Some event...
}

//other code
if (rand < 23) //23%
{
    // Some event...
} 
```

从`<=`to的变化`<`是因为您现在正在使用独占上限范围

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-09T21:13:44.767

的第二个参数`Next(int, int)`是所需结果范围的[唯一上限](http://msdn.microsoft.com/en-us/library/2dx6wyd4.aspx)。因此，您应该使用这个：

```
if (random.Next(0, 100) < 25) 
```

或者，如果您必须使用基于 1 的逻辑，

```
if (random.Next(1, 101) <= 25) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-09T21:17:03.733

您也可以使用此代码（通常用于百分比计算，使用 0 和 1 之间的两倍）：

```
double rand = random.NextDouble();
if(rand < .25)
{
... 
```

# c# - 在自定义控件上实施 AutoSize 的最佳做法是什么？

> ID：10079917
> 
> 赞同：2
> 
> 时间：2012-04-09T21:10:21.823
> 
> 标签：c#, .net, winforms, autosize

在自定义 Windows 窗体控件上实现自动调整大小的最佳做法是什么？例如，从 System.Windows.Forms.Label 类继承的自定义 Label 控件。

MSDN 上的 Control.ClientSize 文章有一个关于如何设置新大小的示例（使用 ClientSize 属性），但它没有提示应该调用此方法的事件：http: [//msdn.microsoft.com /en-us/library/system.windows.forms.control.clientsize.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.clientsize.aspx)

我尝试了不同的方法但没有成功（例如：覆盖 SizeFromClientSize、OnTextChanged 等）。似乎只要 AutoSize 属性为真，我就无法成功覆盖 ClientSize 值。

任何人都可以帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T21:22:06.533

最好直接从 中获取您的控制权`Control`，它没有任何`AutoSize`属性，也没有干扰您自己的逻辑的相关逻辑。

# ios - 设备上的 MPMoviePlayerController 方向错误，但模拟器中没有

> ID：10079925
> 
> 赞同：0
> 
> 时间：2012-04-09T21:10:57.550
> 
> 标签：ios, xcode, ios5, mpmovieplayercontroller, screen-orientation

当我在 iPad 设备上加载电影而不是在模拟器中使用 MPMoviePlayerController 加载电影时，我遇到了一个奇怪的错误。在模拟器中完美运行。当我在设备上加载电影时，它的框架设置不正确，但是当我旋转它时，它会正确设置框架。影片设置为仅在横向模式下播放。如果我之前的视图处于纵向模式，它可以通过将其旋转到横向来完美工作，但是当我处于横向模式时，它最初会将 x、y 坐标错误地放置在设备上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:25:33.657

模拟器中有几个错误——尤其是 UI 错误——导致它的行为与设备不同。此外，还有时间问题（您的计算机几乎肯定比 iOS 设备快）内存问题可以被掩盖（您的计算机有更多 RAM）等。

这就是模拟器适合初始测试的原因，但所有软件在发货前都应在设备上进行测试。

# arrays - 更新数组并将 varchar 转换为整数

> ID：10079926
> 
> 赞同：0
> 
> 时间：2012-04-09T21:11:11.227
> 
> 标签：arrays, postgresql

我通过将 varchar 添加到 int4 数组来更新数组。'varchar' 字段都是数字，所以我尝试将其转换为 ::integer 但它不起作用

```
update dwh.attr_lookup set kli_tree = array[target_909_kli::integer] || kli_tree 
```

给我这个错误

```
ERROR: ERROR: invalid input syntax for integer: ""

Query = update
dwh.attr_lookup set kli_tree = array[target_909_kli::integer]
|| kli_tree 
```

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:00:09.960

您正在尝试将空字符串转换为整数，但这不起作用：

```
=> select ''::int;
ERROR:  invalid input syntax for integer: ""
LINE 1: select ''::int;
               ^ 
```

你必须决定你想用空字符串做什么。如果你想将它们转换为零，那么这样的事情应该可以工作：

```
array[case when target_909_kli = '' then 0 else target_909_kli::integer end] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T21:37:13.010

显然，您的`varchar`领域*并非*全是数字。在这种情况下不会有任何双引号 - 正如错误消息告诉我们的那样。

如果错误现在还没有清除，请尝试给出一个完整的示例。包括表定义和样本值。

# c - 为什么这段代码是可利用的？

> ID：10079927
> 
> 赞同：1
> 
> 时间：2012-04-09T21:11:18.113
> 
> 标签：c, security

为什么此代码不安全？

```
#include <stdio.h>
int main( int argc, char *argv[] )
    {
       printf(argv[1]);
       printf("\n");
       return 0;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T21:15:33.270

`printf`将处理它的第一个参数，寻找类似`%d`and的东西`%s`。

基于这些值，它将从堆栈中获取更多数据并将其打印出来。

因此，如果有人调用您的程序：

```
a.out "%d %d %d %d %d %d %d %d %d %d %d %d" 
```

他们可以查看您计算机调用堆栈的一部分。

如果他们对格式说明符更有创意，也许他们可以转储一些重要的东西，比如信用卡号或密码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T21:13:04.323

考虑`printf`控件的第一个参数是什么（提示：`printf`不只是读取它的输入参数）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-09T21:14:07.330

看看什么是格式字符串漏洞：

[http://en.wikipedia.org/wiki/Uncontrolled_format_string](http://en.wikipedia.org/wiki/Uncontrolled_format_string)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-12T10:43:29.987

由于海报询问了一个例子，它做了什么`%n`：

`printf`格式字符串可以*改变*内存的方式是使用`%n`选项；可以通过“明智地”使用格式宽度说明符来获得要写入的特定值。作为测试：

```
#include <stdio.h>

int main(int argc, char **argv)
{
    int *q = (int *)argv[0];
    printf("%1$300000d%5$n",
        123,         // %1 - 1st param (formatted as '300000d')
        0,           // %2 - 2nd param (unused)
        0,           // %3 - 3rd param (unused)
        0,           // %4 - 4th param (unused)
        argv[0]);    // %5 - 5th param (written to via 'n')

    printf("\nNow *q == %d\n", *q);

    return 0;
} 
```

如果您运行它并查看输出的最后一行，它将打印`Now *q == 300000`（在 Linux 上测试）。

我在这里使用了相当未知的*位置格式语法*（`%`<pos> `$`<fmt>），`printf()`以展示如何跳过参数来选择要修改的参数，而无需使用任何“无趣”的参数。

我将把它留给读者进行实验，以找出`printf()`像`printf(argv[1])`. 答案取决于[*调用约定*](https://stackoverflow.com/questions/tagged/calling-convention)（或相关的，您系统的[*ABI*](https://stackoverflow.com/questions/tagged/abi)），并且对于 32/64 位 Windows/Linux/MacOSX 等不同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-09T21:16:13.263

你可以在这里找到解释。 [https://www.owasp.org/index.php/Testing_for_Format_String](https://www.owasp.org/index.php/Testing_for_Format_String)

# html - 在 HTML 5 中执行自定义分数的基于标准/语义的方法是什么？

> ID：10079929
> 
> 赞同：1
> 
> 时间：2012-04-09T21:11:20.837
> 
> 标签：html, standards, semantic-markup, fractions

**类似问题：** [如何使用 html 编写小数值？](https://stackoverflow.com/questions/7525977/how-to-write-fraction-value-using-html)

**我的问题不同的地方：**

1.  <sup> 和 <sub> 标签的使用是否被认为是在 HTML 5 中进行分数的“标准方式”？
2.  如果不是，那么自定义分数应该以什么方式完成？

**进一步说明：**

我*不是*在问*如何*在 HTML 5 中进行自定义分数。我在寻找*标准或最佳实践*是什么。我已经看到了很多不同的技术，我正在从一个有信誉的来源寻找可靠的参考资料，说明在语义和 Web 标准方面最好的方法是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T23:33:50.967

在 HTML5 中计算分数的最正确方法可能是使用[MathML](https://www.w3.org/TR/html5/embedded-content-0.html#mathml)。对于分数，无法获得比`<mfrac>`元素更多的语义。

你可以这样做：

```
<math>
  <mfrac bevelled="true">
    <mn>99</mn>
    <mn>100</mn>
  </mfrac>
</math> 
```

但是使用最先进的东西的问题是它还没有在浏览器中得到广泛的支持。快速测试表明它目前仅适用于 Firefox 和 Opera。

在这里看到它：[https ://jsfiddle.net/6sfeqcw5/](https://jsfiddle.net/6sfeqcw5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T21:28:33.157

HTML5 中没有关于自定义分数的标准。（而且 HTML5 甚至还没有接近标准。）一般来说，在 HTML 中没有为它们建立最佳实践。似乎没有进行任何工作来定义它们的标准或最佳实践。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-09T21:24:57.357

我没有参考，但这是我的观点：sup 和 sub 是显示标签，除了极少数情况外不应使用。这个来源[http://www.webdesignfromscratch.com/html-css/list-of-html-tags-with-semantic-usage/](http://www.webdesignfromscratch.com/html-css/list-of-html-tags-with-semantic-usage/)提到了化学公式，这是一个很好的例子，因为在这种情况下，文本的位置具有语义意义。

我不认为分数属于这些情况。分数可以以多种方式显示，如下所述：[http ://en.wikipedia.org/wiki/Fraction_(mathematics)#Writing_simple_fractions](http://en.wikipedia.org/wiki/Fraction_(mathematics)#Writing_simple_fractions)

因此，您可能应该只使用像 span 标签这样的通用解决方案。

# tinymce - 如何在 TinyMCE 编辑器中添加页眉和页脚？

> ID：10079933
> 
> 赞同：3
> 
> 时间：2012-04-09T21:11:57.990
> 
> 标签：tinymce

我正在尝试在 TinyMCE 编辑器中添加页眉和页脚，因此用户可以获得预定义的“空白”页面进行编辑并具有默认页眉和页脚。用户只需要输入定制的内容。

有没有办法做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T11:10:07.850

是的，这是可能的。您需要在编辑器初始化时将页眉和页脚添加到内容中。但请记住，如果您不想将它们存储在数据库中，则必须在保存之前将其删除。这是使它工作的初始化代码。您将需要使用[设置参数](http://www.tinymce.com/wiki.php/API3:event.tinymce.Editor.onInit)

```
// Adds an observer to the onInit event using tinyMCE.init
tinyMCE.init({
   ...
   setup : function(ed) {
      ed.onInit.add(function(ed) {
         var header = "<header>ABCD</header>",
             footer = "<div>footer</div>",
             content = ed.getContent();

         content = header + content + footer;
         ed.setContent(content);
      });
   }
}); 
```

此外，您需要将添加的标签定义为tinymce 配置中的*有效元素*。看看这个的[valid_elements](http://www.tinymce.com/wiki.php/Configuration:valid_elements)设置（也许你可以使用*extended_valid_elements*设置）。

# wso2 - 如何使用 WSO2 ESB 注册新的消息处理器类

> ID：10079934
> 
> 赞同：1
> 
> 时间：2012-04-09T21:12:01.697
> 
> 标签：wso2, wso2esb, esb

如何向 WSO2 ESB 注册新的消息处理器类？

我尝试将 jar 文件放入 CARBON_HOME/repository/components/plugins 和 dropins，但是当我通过 carbon 控制台创建自定义 MP 时，出现 ClassNotFound 异常。

我使用的是 4.0.3 版。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T13:41:00.487

如果是 osgi 包，请将 jar 保存在 repository/components/dropins 文件夹中。否则，如果它是普通 jar，请保存在 repository/components/lib 文件夹中。如果您保存在 plugins 文件夹中（如果是 OSGi 包），则需要编辑 bundle.info 文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T12:09:13.597

在旧版本中，您需要将其添加到axis2.xml 中。在消息接收器、消息格式化程序和/或消息构建器部分。也许现在您可以创建一个 OSGi 包来添加它，但我不确定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T18:26:19.000

在版本 4.0.3 中，将 jar 放入 repository/components/lib 文件夹。您必须重新启动 ESB

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-24T09:05:33.043

jar 文件需要在服务器启动期间复制到 CARBON_HOME/repository/components/lib 文件夹中，这个 jar 文件将被拾取。

# javascript - 检测浏览器何时滚动到某个点以下

> ID：10079936
> 
> 赞同：1
> 
> 时间：2012-04-09T21:12:10.700
> 
> 标签：javascript, html, cross-browser, browser

我有一个充满 div 的网页，当页面从底部到达 300px 时，它会加载更多的 div。我很难找到一种适用于任何地方的检测。

我需要一些 JavaScript（即不是 JQuery）if 语句来放入 body 的 onscroll 函数，该函数将检测浏览器从底部滚动到 300px 以下，它适用于 IE、FF、Chrome、Opera、Safari、Android 浏览器、iBrowsers 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:19:11.820

您可以使用类似的库

[http://code.google.com/p/jquery-appear/](http://code.google.com/p/jquery-appear/)

并绑定到您在每个批次中动态显示的最后一个元素，这样当它进入视图时，就会显示下一个批次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T21:20:59.980

我很确定您可以在文档对象或可能的正文标记上使用 jQuery 的“scrollTop”方法。

IE

```
if ($(document).scrollTop() > whatever) {
 doWhatever();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T21:23:56.357

你必须知道点的位置，然后检查窗口`scrollTop`

```
if ($(window).scrollTop() > point) {
 //Carry On
} 
```

# c++ - 不能推导出嵌套类型的模板函数

> ID：10079941
> 
> 赞同：3
> 
> 时间：2012-04-09T21:12:49.993
> 
> 标签：c++, templates, c++11, resolution

我正在使用 SystemC 库，它要求所有用户定义的类型都具有 operator<< 和 sc_trace() 函数。然而，用户定义的类型实际上是模板类中的嵌套类型，因为“嵌套类型”是根据外部类中指定的模板参数计算得出的。

```
template<typename T>
class Block {
    typedef typename transform<T>::value NewType;
public:
    struct SomeType {
        SomeType() {}
        SomeType(T val) : member(val) {}
        NewType member;
    };
}; 
```

当我像这样为 SomeType 定义 operator<<

```
template<typename T>
std::ostream& operator<<(std::ostream& os, const typename Block<T>::SomeType& type) {
    return os << type.member;
} 
```

编译器无法推断出 systemC 库中确实尝试使用流式操作符转储嵌套定义类型的调用。因为我宁愿不触摸库代码（在我的控制之外）。你们中的任何一位专家都知道解决这个问题的方法吗？

如果没有干净的解决方法，你知道 C++11 是否有解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:54:37.013

我实际上自己找到了解决方案。它在 Vandevoorde/Josuttis 被称为 Barton-Nackman 技巧。

关键是避免使用函数模板。该标准从模板参数推导中排除了依赖模板类的嵌套类型。operator<< 和 sc_trace 函数需要在模板类中定义为友元函数。这样，当模板类被实例化时，该函数是一个非模板化函数，但使用friend关键字，该函数占据了封闭命名空间的范围。

# xcode - 构建 Ipad 应用程序，一旦我添加了一个模态视图，我的布尔错误就出来了

> ID：10079943
> 
> 赞同：0
> 
> 时间：2012-04-09T21:12:55.207
> 
> 标签：xcode, ipad, boolean

我在使用 Bool 时出错，在添加模态视图之前，现在它说 bool 未定义。我不明白为什么会这样，除非因为我正在为我的模态视图使用另一个笔尖。

我现在需要打电话或改变我的恩惠吗？请指教。

```
 //
//  UrbanAgentViewController.m
//  UrbanAgent
//
//  Created by Dwayne Stephens on 4/2/12.
//  Copyright 2012 __MyCompanyName__. All rights reserved.
//

#import "UrbanAgentViewController.h"
#import "NewContactController.h"

@implementation UrbanAgentViewController

// our own buttonTapped method
-(IBAction) buttonTapped: (id) sender {
    NewContactController *ivc = [[NewContactController alloc] init];
    ivc.delegate = self;

    UINavigationController *nc = [[UINavigationController alloc]
                                  initWithRootViewController:ivc];

    [self presentModalViewController:nc animated:YES];

    [ivc release];
    [nc release];

}

-(void) doneButtonPressed: (NSArray *) values
{
    [self dismissModalViewControllerAnimated:YES];

    NSString *message =
    [[NSString alloc]
     initWithFormat:@"The values were %@, %@, %@, %@, %@, and %@",
     [values objectAtIndex:0], [values objectAtIndex:1], [values objectAtIndex:2],
     [values objectAtIndex:3], [values objectAtIndex:4], [values objectAtIndex:5]];

    UIAlertView *alert =
    [[UIAlertView alloc] initWithTitle:@"Values Passed" 
                               message:message delegate:nil
                     cancelButtonTitle:@"Excellent!" otherButtonTitles:nil ];

    [alert show];
    [alert release];
    [message release];

/*
// The designated initializer. Override to perform setup that is required before the view is loaded.
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}
*/

/*
// Implement loadView to create a view hierarchy programmatically, without using a nib.
- (void)loadView {
}
*/

/*
// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
- (void)viewDidLoad {
    [super viewDidLoad];
}
*/

// Override to allow orientations other than the default portrait orientation.
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return YES;
}

- (void)didReceiveMemoryWarning {
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];

    // Release any cached data, images, etc that aren't in use.
}

- (void)viewDidUnload {
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (void)dealloc {
    [super dealloc];
}

@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:22:19.980

您需要在`doneButtonPressed:`.

# c++ - 在哪里存储 C++ 应用程序的 SQL 代码？

> ID：10079952
> 
> 赞同：3
> 
> 时间：2012-04-09T21:13:41.887
> 
> 标签：c++, sql

我们有一个 C++ 应用程序，它利用一些基本 API 将原始查询发送到 MS SQL Server。分散在我们程序中的各种翻译单元中，我们有简单的 1-2 行查询作为 C++ 字符串，并且不时地您会看到可能超过 20 行的更复杂的查询。

我不禁认为较大的查询，特别是 20 多行的查询，不应该作为常量字符串嵌入到 C++ 代码中。我想建议将它们提取到由 C++ 应用程序按需加载的单独文本文件中，但是我不确定这是否是最佳方法。

对于这种情况，典型的设计选择是什么？我绝对觉得需要改进，我只是不知道将 SQL 查询移到数据文件（文本文件）中是否是最好的主意。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T21:23:41.833

您可以制作 DAL（数据访问层）。

这将是程序其余部分与之对话的 API。然后你就可以在不干扰主程序的情况下乱来尝试任何事情（存储过程、缓存等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T07:19:33.927

这真的取决于，这里有一些注意事项：

1）如果您所有的 sql 代码都驻留在应用程序中，那么您的应用程序在逻辑方面几乎是自包含的。这很好，就像您在当前应用程序中所做的那样。在速度方面，这可能会慢一些，因为当您运行这些查询时需要解析 SQL（也取决于您是否使用了准备好的语句等可以加快速度）。

2）第二种方法是将所有SQL逻辑作为存储过程放在服务器上。对于即使是小型 SQL 查询（无论是否为一行），这都是一种非常受欢迎的方法。您只需构建一个 DAL 层。就性能而言，这非常好，但是逻辑存在于两个不同的系统中，即您的 C++ 应用程序和 SQL 服务器。您很可能需要构建一个小型实用程序应用程序，该应用程序可以将存储过程的输入和输出转换为模板代码（无论是 C++ 还是任何其他代码），以使您的生活更轻松。

3）与上述两者混合的方法。我不会推荐这条路线。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T21:19:07.827

将它们移动到它们自己的文件中，甚至移动到它们自己的存储过程中。嵌入在应用程序中的查询不能在不重新编译的情况下更改，并且取决于您的发布程序，这可能会严重影响您响应紧急情况或部署热修复的能力。如果您走这条路，您可以更改您的应用程序以缓存文件内容，甚至定期检查文件是否有更新。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T21:19:13.267

最好的“设计选择”——出于许多不同的原因——是随时随地使用 MSSQL 存储过程。

我已经看到将 SQL 查询分离到一个公共模块中的代码，但我认为公共“查询模块”（或独立文本文件）与在模块中将 SQL 查询拼写为字符串文字相比没有多大好处那是在召唤他们。

另一方面，存储过程增加了模块化，增强了安全性，并且可以极大地提高性能。

恕我直言...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-09T21:26:46.793

我会将 SQL 嵌入到使用它的 C++ 函数中：它会更容易阅读和理解代码的作用。

如果您的代码周围散布着 SQL 查询，我会说您正在使用的类的整体结构存在一些问题：您应该有一些（甚至只有一个）“低级”类来处理与数据库，其余代码使用这些类。

我个人不喜欢使用存储过程：如果你必须支持不同的数据库服务器，移植会很痛苦，我从来没有见过这么多的性能改进，并且要理解你必须在之间来回跳转的代码存储过程和 C++。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-09T21:27:49.697

您需要考虑这些查询可能如何随时间变化，并将其与相关 C++ 代码可能如何变化进行比较。如果查询相对独立于代码，并且更改的可能性更高，那么我会在运行时从单独的文件中加载它们，或者改用存储过程。这种方法允许在不重新编译 C++ 代码的情况下更改查询。另一方面，如果查询与 C++ 代码高度耦合，使一个更改可能伴随另一个更改，我会将查询保留在代码中。这种方法使更改更加本地化并且不易出错。

# facebook - Facebook 赞按钮状态更新

> ID：10079956
> 
> 赞同：0
> 
> 时间：2012-04-09T21:14:00.497
> 
> 标签：facebook, facebook-like, facebook-login

我在同一页面上有一个赞按钮和一个登录按钮。该页面位于 Facebook iframe 之外。如果我没有登录并通过登录按钮登录，则类似按钮的状态不会得到更新。但是如果我没有登录并通过like按钮登录，登录按钮就会更新。据我所知，当 window.fbAsyncInit 被触发时，like 按钮似乎无法接收更新。

当我通过页面上的不同 Facebook 按钮登录时，有没有办法更新点赞按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:23:45.303

这是一个解决方法。

订阅`auth.statusChange`（http://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/）并检查是否成功登录。如果是这样，请将类似按钮代码重新渲染到您的 DOM 中，然后让 Javascript SDK 使用`FB.XFBL.parse()`(http://developers.facebook.com/docs/reference/javascript/FB.XFBML.parse/)重新解析它

# sharepoint - 更新 EndDate 导致“无效数据已用于更新列表项”

> ID：10079961
> 
> 赞同：2
> 
> 时间：2012-04-09T21:14:19.293
> 
> 标签：sharepoint, sharepoint-2010

这是完整的错误：

```
Invalid data has been used to update the list item. The field you are trying to update may be read only. 
```

我基本上是在尝试更新 Sharepoint 中的日历事件。

首先，我得到以下信息。

```
ClientContext clientContext = new ClientContext(deptUrl);
Web web = clientContext.Web;
List list = web.Lists.GetByTitle(deptCal);
clientContext.Load(list);

CamlQuery query = new CamlQuery();
query.ViewXml = "<View><Query><Where><IsNull><FieldRef Name='EndDate' /></IsNull></Where></Query><RowLimit>1</RowLimit></View>";

ListItemCollection allEventIds = list.GetItems(query);

clientContext.Load(allEventIds, 
items => items.Include(
     item => item["EventID"],
     item => item["EventDate"],
     item => item["EndDate"]
));

clientContext.ExecuteQuery(); 
```

接着是一个循环：

```
foreach (var item in allEventIds)
{
   Console.Write("EventId: {0} StartDate: {1}\n", item.FieldValues["EventID"], item.FieldValues["EventDate"]);

                if (item.FieldValues.ContainsKey("EventDate"))
                {
                    object objValue = item.FieldValues["EventDate"];
                    if (objValue != null)
                    {
                        clientContext.Load(item);                        
                        DateTime endDate = DateTime.Parse(objValue.ToString());
                        item["EndDate"] = endDate; //Updated this!

                    }
                }
                item.Update();

            } 
```

然后最后：

```
clientContext.ExecuteQuery(); 
```

如果我尝试更新 ListItem 中的任何其他项目 [x] 工作正常。当我尝试更新“EndDate”时。我收到以下错误：

```
Microsoft.SharePoint.Client.ServerException was unhandled
  Message="Invalid data has been used to update the list item. The field you are trying to update may be read only."
  Source="Microsoft.SharePoint.Client.Runtime"
  ServerErrorCode=-2147024809
  ServerErrorTypeName="System.ArgumentException"
  ServerStackTrace=""
  StackTrace:
       at Microsoft.SharePoint.Client.ClientRequest.ProcessResponseStream(Stream responseStream)
       at Microsoft.SharePoint.Client.ClientRequest.ProcessResponse()
       at Microsoft.SharePoint.Client.ClientRequest.ExecuteQueryToServer(ChunkStringBuilder sb)
       at Microsoft.SharePoint.Client.ClientRequest.ExecuteQuery()
       at Microsoft.SharePoint.Client.ClientRuntimeContext.ExecuteQuery()
       at Microsoft.SharePoint.Client.ClientContext.ExecuteQuery()
       at DisplayOnCalendarUtility.Program.Main(String[] args) in C:\Projects\DisplayOnCalendarUtility\DisplayOnCalendarUtility\Program.cs:line 61
       at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T15:06:13.063

Sharepoint 是这样连接的。当您自己更新 EndDate 时，它​​会给您上面列出的错误。解决方案是将 EventDate 和 EndDate 一起更新。

```
DateTime startDate = DateTime.Parse(objValue.ToString());
item["EventDate"] = startDate;
item["EndDate"] = startDate; //Or Any other date you want to set to. 
```

[http://social.msdn.microsoft.com/Forums/en-US/sharepointdevelopment/thread/31e84d74-3ea8-44df-86dc-2dc62381ab3b/#33ad370b-b137-4c2f-bcaa-d6f5c714f4dd](http://social.msdn.microsoft.com/Forums/en-US/sharepointdevelopment/thread/31e84d74-3ea8-44df-86dc-2dc62381ab3b/#33ad370b-b137-4c2f-bcaa-d6f5c714f4dd)

# java - Java中的Python拆分语义

> ID：10079962
> 
> 赞同：4
> 
> 时间：2012-04-09T21:14:23.160
> 
> 标签：java, python, regex, split, spaces

当我在 python 中拆分字符串时，相邻的空格分隔符被合并：

```
>>> str = "hi              there"
>>> str.split()
['hi', 'there'] 
```

在 Java 中，分隔符不被合并：

```
$ cat Split.java
class Split {
    public static void main(String args[]) {
        String str = "hi              there";
        String result = "";
        for (String tok : str.split(" "))
            result += tok + ",";
        System.out.println(result);
    }
}
$ javac Split.java ; java Split
hi,,,,,,,,,,,,,,there, 
```

有没有一种直接的方法可以在 java 中获取 python 空间拆分语义？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T21:15:56.713

`String.split`接受一个正则表达式，因此提供一个匹配相邻空格的正则表达式：

```
str.split("\\s+") 
```

如果您想模拟 Python 的确切行为`str.split()`，您还需要修剪：

```
str.trim().split("\\s+") 
```

引用[Python 文档`str.split()`](http://docs.python.org/library/stdtypes.html#str.split)：

> 如果*sep*未指定或为*None*，则应用不同的拆分算法：连续空格的运行被视为单个分隔符，如果字符串具有前导或尾随空格，则结果将在开头或结尾不包含空字符串。*因此，使用None*分隔符拆分空字符串或仅包含空格的字符串将返回 []。

所以上面仍然不是一个完全等价的，因为它会返回`['']`空字符串，但它可能适合你的目的:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-02T16:43:00.903

Niklas B. 的答案的问题在于`trim`它对空白有自己的定义，即任何代码不超过`'\u0020'`. 以下应该足够接近 Python 版本，包括对空字符串的修复：

```
class TestSplit {

    private static final String[] EMPTY = {};

    private static String[] pySplit(String s) {
        s = s.replaceAll("^\\s+", "").replaceAll("\\s+$", "");
        if (s.isEmpty()) return EMPTY;
        return s.split("\\s+");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T21:16:10.797

改为使用`str.split("\\s+")`。这将满足您的需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T21:18:44.350

Java 使用 Regex 进行拆分。

所以在一个空间上分割绝对会给你很多数组元素。

Python 拆分、ltrims 和 rtrims，然后在没有传递参数时将空格运行到单个空格中。

所以它会更合适

```
"my             string".trim().split("\\s+"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T21:16:10.103

在 java 中，String.split 采用正则表达式。所以你可以做得到`str.split(" +")`python语义。

# php - 如何使用 wamp 服务器连接 php 和 sql server 2008 R2

> ID：10079963
> 
> 赞同：0
> 
> 时间：2012-04-09T21:14:38.543
> 
> 标签：php, sql-server-2008-r2, connect, wampserver

已经更改的文件 php.ini 并且 index.php 文件包含：

```
<?php
$server = 'name/SQLEXPRESS';
$link = mssql_connect($server, 'namepc', 'pw');
if (!$link) {
    die('Something went wrong');
}
?> 
```

本地主机上的错误消息是：

警告：mssql_connect() [function.mssql-connect]:。（严重性 14）

警告：mssql_connect() [function.mssql-connect]：无法连接到服务器：出了点问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:53:49.760

已经成功了！只需在管理工作室上创建一个新用户并将其链接到您的 php 代码的新帐户。

# jasper-reports - iReports 4.5.1 在使用 TABLE 报表元素时抛出错误

> ID：10079964
> 
> 赞同：0
> 
> 时间：2012-04-09T21:14:38.700
> 
> 标签：jasper-reports, ireport

您好我在使用 iReport 设计器表格报告元素时收到以下错误消息：

```
Error filling print... java.lang.String cannot be cast to java.lang.Boolean
java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Boolean
at net.sf.jasperreports.components.table.fill.FillTable.toPrintColumn(FillTable.java:116)
at net.sf.jasperreports.components.table.fill.FillTable$FillColumnEvaluator.visitColumn(FillTable.java:143)
at net.sf.jasperreports.components.table.fill.FillTable$FillColumnEvaluator.visitColumn(FillTable.java:130)
at net.sf.jasperreports.components.table.StandardColumn.visitColumn(StandardColumn.java:73)
at net.sf.jasperreports.components.table.fill.FillTable.evaluateColumns(FillTable.java:205)
at net.sf.jasperreports.components.table.fill.FillTable.evaluate(FillTable.java:98)
at net.sf.jasperreports.engine.fill.JRFillComponentElement.evaluate(JRFillComponentElement.java:88)
at net.sf.jasperreports.engine.fill.JRFillElementContainer.evaluate(JRFillElementContainer.java:257)
at net.sf.jasperreports.engine.fill.JRFillBand.evaluate(JRFillBand.java:473)
at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillColumnBand(JRVerticalFiller.java:2021)
at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillGroupHeader(JRVerticalFiller.java:616)
at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillGroupHeaders(JRVerticalFiller.java:538)
at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillReportStart(JRVerticalFiller.java:263)
at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillReport(JRVerticalFiller.java:128)
at net.sf.jasperreports.engine.fill.JRBaseFiller.fill(JRBaseFiller.java:836)
at net.sf.jasperreports.engine.fill.JRBaseFiller.fill(JRBaseFiller.java:746)
at net.sf.jasperreports.engine.fill.JRFiller.fillReport(JRFiller.java:58)
at net.sf.jasperreports.engine.JasperFillManager.fillReport(JasperFillManager.java:417)
at net.sf.jasperreports.engine.JasperFillManager.fillReport(JasperFillManager.java:247)
at com.jaspersoft.ireport.designer.compiler.IReportCompiler.run(IReportCompiler.java:879)
at org.openide.util.RequestProcessor$Task.run(RequestProcessor.java:572)   
at org.openide.util.RequestProcessor$Processor.run(RequestProcessor.java:997) 
```

我正在使用返回游标作为输出的存储过程。

我已将此表格报告元素放在我的组标题之一中。

提前致谢

梅萨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T22:52:44.113

如果有使用 String 的评估，请检查您的样式条件。为确保一切正常，使用`new Boolean( ... )`.

# cakephp - 从应用程序内运行 shell 脚本

> ID：10079966
> 
> 赞同：0
> 
> 时间：2012-04-09T21:14:39.903
> 
> 标签：cakephp, cakephp-2.0, cakephp-2.1

我需要运行这个

```
./Console/cake AclExtras.AclExtras aco_sync 
```

在我的应用程序中的控制器中。那可能吗？我该怎么做。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:29:22.843

我认为您正在寻找一种在 CakePHP 中执行外部脚本的方法 - 这里指定的方法之一应该可以工作：[http ://chipmunkninja.com/Program-Execution-in-PHP%3A-exec-m@](http://chipmunkninja.com/Program-Execution-in-PHP%3A-exec-m@)

# ruby-on-rails - 稳定快速的 Web 服务器配置，在 Windows 上运行 Rails，如 apache + php

> ID：10079970
> 
> 赞同：0
> 
> 时间：2012-04-09T21:15:16.527
> 
> 标签：ruby-on-rails, windows, webserver

我正在寻找一个好的 Rails 配置 + 一个网络服务器。实际上，我使用的 webrick 存在一些问题（在 2 台不同的机器上）：首先，它在 XXX 时间后崩溃（这不是我的应用程序，它在一个全新的应用程序上随机发生）。其次，它不处理多个请求，而且我的应用程序使用大量小型 ajax 调用，使得网站测试在具有如此小页面的本地服务器上非常慢。

我以为我可以安装 Rails + Apache，但仔细阅读我认为这是不可能的。作为与 Rails 一起使用的网络服务器，最快的配置（支持多线程请求）是什么？

我正在使用 wamp 来处理我的 apache 网络服务器、php、mysql 等（是的，我不是专家，但我可以处理配置文件）。如果可能的话，我想通过那个apache使用rails，我读到我应该使用apache + mongrel（我可以用这种方式处理多个请求吗？）。

我对其他配置也很好，我只需要有人指出我正确的方向，可能还有教程。

**所以要求是：**

*   处理并行请求（我有很多小请求）
*   稳定（webrick 经常崩溃）

非常感谢

**编辑1：**

对于像我一样使用虚拟主机的人，这是我写的：

```
<VirtualHost *:8080>
    ServerAdmin admin@federtrek.org.localhost
    DocumentRoot "D:/wamp/www/manage_federtrek_org"
    ServerName federtrek.org.localhost
    ServerAlias manage.federtrek.org.localhost
    ErrorLog "logs/manage.federtrek.org-error.log"
    CustomLog "logs/manage.federtrek.org-access.log" common
    ProxyPass / http://manage.federtrek.org.localhost:3000/
    ProxyPassReverse / http://manage.federtrek.org.localhost:3000/
</VirtualHost> 
```

其中 3000 端口是 mongrel 服务器，8080 是 apache 端口。按照答案中链接的 pdf 文档进行操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:35:17.373

Webrick 不适合生产环境；它应该只用于本地开发。

你在 Windows 上部署 Rails？以前从未听说过这样做。如果是 Linux 或 OS X 并且您坚持使用 Apache，我会推荐 Fusion Passenger（它有点像 Ruby 的 mod_php）。但我不认为他们支持windows。

我认为你最好的选择是 Mongrel ......我*认为*它在 Windows 下运行。这个想法是您将 Rails 应用程序的一个或多个副本作为 Mongrel 进程（Windows 用语中的服务？）然后您将 Apache 设置为它们的反向代理，也许还进行一些负载平衡。虽然它实际上不是多线程，但它具有相同的好处。（事实上​​，大多数 Rails 部署都使用这种想法，而不是真正的多线程。）

至少在 *nix 上应该有很多教程。我认为Windows的大部分内容都是一样的。快速谷歌搜索产生了这个特定于 Windows 设置的 PDF。[http://www.napcsweb.com/howto/rails/deployment/RailsWithApacheAndMongrel.pdf](http://www.napcsweb.com/howto/rails/deployment/RailsWithApacheAndMongrel.pdf)

# css - CSS 浮动高度问题

> ID：10079976
> 
> 赞同：2
> 
> 时间：2012-04-09T21:15:44.147
> 
> 标签：css, position, css-float

所以我有这个页面：

[http://demo.unlockedmanagement.com/example/floating-issue.html](http://demo.unlockedmanagement.com/example/floating-issue.html)

您会注意到 3 个项目：详细信息、附件和说明。现在，当您展开详细信息（只需单击标题）时，问题就来了。附件文本在详细内容的第二个 ul 下被抛出。问题是附件应该在他们自己的线上。

我正在使用 clearfix 方法尝试修复没有此处描述的宽度的浮动元素：[http](http://www.webtoolkit.info/css-clearfix.html) ://www.webtoolkit.info/css-clearfix.html ：除了我的只是做一个 clear:right;。现在显然第一个向左浮动的 ul 比向右浮动的第二个 ul 具有更高的高度，但是父元素的高度似乎取了第二个 ul 的高度，而不是第一个更大的高度。

有人看到我在这里做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:23:09.867

您是否尝试过将浮动容器设置为 display:inline-table？这应该允许浮动元素相对于其兄弟元素进行布局，并在其周围元素的大小增加或缩小时移动。

# linq - LINQ to Entities 无法识别方法“System.String Format(System.String, System.Object, System.Object)”

> ID：10079990
> 
> 赞同：89
> 
> 时间：2012-04-09T21:17:15.487
> 
> 标签：linq, entity-framework, linq-to-entities

我有这个 linq 查询：

```
private void GetReceivedInvoiceTasks(User user, List<Task> tasks)
{
    var areaIds = user.Areas.Select(x => x.AreaId).ToArray();

    var taskList = from i in _db.Invoices
                   join a in _db.Areas on i.AreaId equals a.AreaId
                   where i.Status == InvoiceStatuses.Received && areaIds.Contains(a.AreaId)
                   select new Task {
                       LinkText = string.Format(Invoice {0} has been received from {1}, i.InvoiceNumber, i.Organisation.Name),
                       Link = Views.Edit
                   };
} 
```

虽然它有问题。我正在尝试创建任务。对于每个新任务，当我将链接文本设置为像“Hello”这样的常量字符串时，这很好。但是上面我正在尝试使用发票的属性来构建属性链接文本。

我收到此错误：

> base {System.SystemException} = {"LINQ to Entities 无法识别方法 'System.String Format(System.String, System.Object, System.Object)' 方法，并且此方法无法转换为存储表达式。" }

有谁知道为什么？任何人都知道这样做的另一种方法来使它工作？

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2012-04-09T21:21:36.973

实体框架正在尝试在 SQL 端执行您的投影，其中没有等效于[`string.Format`](http://msdn.microsoft.com/en-us/library/system.string.format.aspx). 用于[`AsEnumerable()`](http://msdn.microsoft.com/en-us/library/bb335435.aspx)强制使用 Linq to Objects 评估该部分。

根据我给你[的上一个答案](https://stackoverflow.com/questions/10079627/linq-to-entities-query-non-primative-type/10079709#10079709)，我会像这样重组你的查询：

```
int statusReceived = (int)InvoiceStatuses.Received;
var areaIds = user.Areas.Select(x=> x.AreaId).ToArray();

var taskList = (from i in _db.Invoices
               where i.Status == statusReceived && areaIds.Contains(i.AreaId)
               select i)
               .AsEnumerable()
               .Select( x => new Task()
               {
                  LinkText = string.Format("Invoice {0} has been received from {1}", x.InvoiceNumber, x.Organisation.Name),
                  Link = Views.Edit
                }); 
```

我还看到您在查询中使用了相关`Organisation.Name`实体`Include`（

```
var taskList = (from i in _db.Invoices
               where i.Status == statusReceived && areaIds.Contains(i.AreaId)
               select new { i.InvoiceNumber, OrganisationName = i.Organisation.Name})
               .AsEnumerable()
               .Select( x => new Task()
               {
                  LinkText = string.Format("Invoice {0} has been received from {1}", x.InvoiceNumber, x.OrganisationName),
                  Link = Views.Edit
                }); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-05-17T06:29:25.353

`IQueryable`派生自`IEnumerable`，主要相似之处在于，当您进行查询时，它会以它的语言发布到数据库引擎，此时您告诉 C# 处理服务器（而不是客户端）上的数据或告诉 SQL 处理数据。

所以基本上当你说`IEnumerable.ToString()`，C# 获取数据集合并调用`ToString()`对象。但是当你说`IQueryable.ToString()`C# 告诉 SQL 调用`ToString()`对象时，SQL 中没有这样的方法。

缺点是当您在 C# 中处理数据时，您正在查看的整个集合必须在 C# 应用过滤器之前在内存中构建。

最有效的方法是`IQueryable`使用您可以应用的所有过滤器进行查询。

然后在内存中构建它并在 C# 中进行数据格式化。

```
IQueryable<Customer> dataQuery = Customers.Where(c => c.ID < 100 && c.ZIP == 12345 && c.Name == "John Doe");

 var inMemCollection = dataQuery.AsEnumerable().Select(c => new
                                                  {
                                                     c.ID
                                                     c.Name,
                                                     c.ZIP,
                                                     c.DateRegisterred.ToString("dd,MMM,yyyy")
                                                   }); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-01-19T23:09:52.743

虽然 SQL 不知道如何处理 a`string.Format`它可以执行字符串连接。

如果你运行下面的代码，那么你应该得到你想要的数据。

```
var taskList = from i in _db.Invoices
               join a in _db.Areas on i.AreaId equals a.AreaId
               where i.Status == InvoiceStatuses.Received && areaIds.Contains(a.AreaId)
               select new Task {
                   LinkText = "Invoice " + i.InvoiceNumber + "has been received from " + i.Organisation.Name),
                   Link = Views.Edit
               }; 
```

一旦您实际执行查询，这应该比使用快一点`AsEnumerable`（至少这是我在遇到与您相同的原始错误后在自己的代码中发现的）。如果您使用 C# 做一些更复杂的事情，那么您仍然需要使用`AsEnumerable`。

# sql - 导出嵌入在 Wordpress 数据库中的图像

> ID：10079995
> 
> 赞同：0
> 
> 时间：2012-04-09T21:17:33.093
> 
> 标签：sql, database, wordpress

我已将 Blogger 帐户导入到 Wordpress 安装中。但突然间我看到表`wp_posts`增长到**128 MiB**，我注意到**在**一些帖子里面有像这样用 base64 编码的嵌入图像

`<img alt="" src="data:image/png;base64,iVBORw0KGgo...." />`

如何将所有这些图像导出到数据库之外的`wp-content`文件夹中并减轻数据库的负担？

有没有这样的插件？

如果没有一些指导方针？

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:28:38.573

有一个名为[Blogger Importer](http://wordpress.org/extend/plugins/blogger-importer/)的插件。它应该处理这些图像。如果没有，请编写您自己的导入程序。这真的很简单。然后你必须`base64_decode()`将图像插入到上传目录中[`wp_insert_attachment()`](http://codex.wordpress.org/Function_Reference/wp_insert_attachment)。

[我们对WordPress Stack Exchange](https://wordpress.stackexchange.com/search?q=blogger)上的这个主题有一些疑问。看看那些，如果你遇到困难，可以在那里寻求帮助。

# postgresql - 编码“UTF8”的字符 0xe28093 在“LATIN1”中没有等价物

> ID：10079996
> 
> 赞同：1
> 
> 时间：2012-04-09T21:17:38.013
> 
> 标签：postgresql, grails, encoding, character-encoding

在 Latin1 Postgres 9.1.3 中插入​​一些数据时，出现错误：

`character 0xe28093 of encoding "UTF8" has no equivalent in "LATIN1"`

Grails 应用程序正在插入数据。我尝试了以下**但没有成功**：

*   `hibernate { connection.characterEncoding='utf8'}`
*   `?charSet=LATIN1`在 jdbc conn 字符串中
*   `hibernate { connection.charSet='LATIN1'}`

该数据库是使用以下内容创建的：

```
CREATE DATABASE mydb
  WITH OWNER = postgres
       ENCODING = 'LATIN1'
       TABLESPACE = pg_default
       LC_COLLATE = 'C'
       LC_CTYPE = 'C'
       CONNECTION LIMIT = -1; 
```

任何想法？先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T21:35:54.740

如果我理解正确，您的数据库是使用编码“LATIN1”创建的。创建数据库后无法更改此编码。唯一可以更改的——如项目符号所示——是客户端和 PostgreSQL*服务器*之间的编码。然后 PostgreSQL 服务器尝试在客户端编码和数据库编码之间进行转换。

如果客户端传输无法转换为 DB 编码的数据时，此过程当然会失败。在您的情况下，Unicode 代码点 2013 无法翻译成 LATIN1。

这意味着您必须清理进入数据库的所有数据。摆弄客户端编码将无济于事。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T21:24:45.037

那是[短划线符号](http://www.fileformat.info/info/unicode/char/2013/index.htm)的 UTF-8 编码。latin1 字符集中最接近的等价物是字符代码 150 (0x96)。