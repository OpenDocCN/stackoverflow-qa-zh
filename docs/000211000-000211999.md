# StackOverflow 问答 000211000-000211999

# html - 防止浏览器后退按钮在用户注销后显示安全数据的最简单方法？

> ID：211001
> 
> 赞同：12
> 
> 时间：2008-10-17T03:24:48.393
> 
> 标签：html, security, web-applications, browser

在带有登录和保护数据的普通 Web 应用程序中，一旦用户注销，有什么简单的方法可以保护这些数据并防止它被浏览器的后退按钮看到？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T04:27:23.713

[这是一个有用的浏览器缓存指南](http://www.mnot.net/cache_docs/)。

您想设置缓存控制和到期日期标头（设置过去的日期），例如

```
 Cache-Control: no-cache
 Expires: Fri, 31 Dec 1998 12:00:00 GMT 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T07:22:08.650

缓存控制标头（Expires、Cache-Control、ETag）通常会阻止页面的缓存，迫使浏览器请求新副本，此时您可以检查会话状态。但是，出于“性能”的考虑，有时会忽略它们。

有两种 Javascript 方法可以帮助您：

*   离开页面时使用页面的退出事件（表单的 onSubmit 或其他页面的 onUnload）清除内容。
*   在页面之间移动时使用 document.location.replace() 而不是普通链接，以免在浏览器历史记录中留下用户可以返回的痕迹。

不过，这两者都可能对可用性产生非常可怕的影响。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T09:06:35.070

## 没有完美的解决方案

尽管对此有一些非常合理的解决方案（缓存控制标头、javascript 等），但您需要意识到，一旦您向客户端发送了某些内容，它就超出了您的控制范围。 **您不能*保证*客户会以您希望的方式处理数据**。

例如：

*   浏览器中可能存在错误
*   浏览器可能允许用户关闭缓存控制
*   用户可能在禁用 javascript 的情况下运行

对不起 ：（

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T04:01:48.587

将缓存标头设置为根本不允许对页面进行任何缓存。这应该可以防止页面本身在用户点击后退按钮时显示，除非他们已登录。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T09:23:44.327

我在 IE 和 Firefox 上试过这个 VB.NET 代码。

Response.Cache.SetAllowResponseInBrowserHistory(False) Response.Cache.SetCacheability(HttpCacheability.NoCache) Response.Cache.SetNoStore() Response.Expires = 0

这可以解决问题，但我同意您无法保证客户端浏览器的行为的其他答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T03:54:46.633

取决于您的登录解决方案（SSO - Windows Live / OpenID vs homegrown，存储登录信息等）......由于“返回”通常不会再次请求页面，我建议清除 JavaScript 中的表单（OnLoad ）。在服务器端，您可以填充它们（Page_Load）。注销时清除会话和视图状态。

# c# - C# 文件管理

> ID：211008
> 
> 赞同：18
> 
> 时间：2008-10-17T03:31:17.617
> 
> 标签：c#

如何在 C# 中检测两个文件是否完全相同（大小、内容等）？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-17T04:04:26.257

这是一个简单的解决方案，它只是读取两个文件并比较数据。它不应该比散列方法慢，因为这两种方法都必须读取整个文件。**编辑**正如其他人所指出的，由于其简单性，此实现实际上比散列方法慢一些。请参阅下面的更快的方法。

```
static bool FilesAreEqual( string f1, string f2 )
{
    // get file length and make sure lengths are identical
    long length = new FileInfo( f1 ).Length;
    if( length != new FileInfo( f2 ).Length )
        return false;

    // open both for reading
    using( FileStream stream1 = File.OpenRead( f1 ) )
    using( FileStream stream2 = File.OpenRead( f2 ) )
    {
        // compare content for equality
        int b1, b2;
        while( length-- > 0 )
        {
            b1 = stream1.ReadByte();
            b2 = stream2.ReadByte();
            if( b1 != b2 )
                return false;
        }
    }

    return true;
} 
```

您可以将其修改为一次读取多个字节，但内部文件流应该已经在缓冲数据，因此即使是这个简单的代码也应该相对较快。

**编辑**感谢您在此处提供有关速度的反馈。我仍然认为 compare-all-bytes 方法可以和 MD5 方法一样快，因为这两种方法都必须读取整个文件。我怀疑（但不确定）一旦文件被读取，比较所有字节方法需要较少的实际计算。无论如何，我在最初的实现中重复了您对性能的观察，但是当我添加一些简单的缓冲时，compare-all-bytes 方法同样快。下面是缓冲实现，欢迎进一步评论！

**编辑**Jon B 提出了另一个好点：在文件实际不同的情况下，此方法可以在找到第一个不同字节后立即停止，而 hash 方法必须在每种情况下读取两个文件的全部内容。

```
static bool FilesAreEqualFaster( string f1, string f2 )
{
    // get file length and make sure lengths are identical
    long length = new FileInfo( f1 ).Length;
    if( length != new FileInfo( f2 ).Length )
        return false;

    byte[] buf1 = new byte[4096];
    byte[] buf2 = new byte[4096];

    // open both for reading
    using( FileStream stream1 = File.OpenRead( f1 ) )
    using( FileStream stream2 = File.OpenRead( f2 ) )
    {
        // compare content for equality
        int b1, b2;
        while( length > 0 )
        {
            // figure out how much to read
            int toRead = buf1.Length;
            if( toRead > length )
                toRead = (int)length;
            length -= toRead;

            // read a chunk from each and compare
            b1 = stream1.Read( buf1, 0, toRead );
            b2 = stream2.Read( buf2, 0, toRead );
            for( int i = 0; i < toRead; ++i )
                if( buf1[i] != buf2[i] )
                    return false;
        }
    }

    return true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T04:01:50.690

或者您可以逐字节比较这两个文件....

# svn - git svn rebase：数据不完整：增量源意外结束

> ID：211025
> 
> 赞同：13
> 
> 时间：2008-10-17T03:47:52.247
> 
> 标签：svn, git, version-control, corrupt

我一直在维护[watir 项目](http://wtr.rubyforge.org/)的[git 镜像](http://github.com/Pistos/watir-mirror)。几周前的某个时候，我们有人准备提交他们的第一个基于 git 的补丁。不幸的是，由于项目的多平台性质，我们遇到了一些关于行尾（CRLF 与 LF 等）的问题。

我尝试了设置[autocrlf 选项](http://git-scm.com/docs/gitattributes)（设置为“输入”），并进行了一些 --hard 重置。然而，几天后，每日更新（git svn rebase）出现了这个错误：

```
Incomplete data: Delta source ended unexpectedly 
```

我试过用谷歌搜索做什么，但即使删除 .git/config 中的 autocrlf 设置也无济于事。我担心工作副本已损坏，但我希望它不是不可恢复的。

显然，一种可能的做法是从 svn 重新导入并启动一个新镜像，但我希望我们不必这样做，因为当前的 watir-mirror 已经分叉，并且人们已经开发了新代码在他们的叉子里。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-02-08T20:40:16.953

在尝试从 brlcad svn 存储库创建 git 存储库时，我遇到了同样的问题。我通过这样做解决了它`git svn reset --r XXXXX`，我将 XXXXX 设置为在最初产生错误的版本之前大约 50 个版本。

后退单个修订版未能成功解决错误。作为该过程的一部分，我从 git 收到关于 HEAD 未定义的错误。为了解决这个问题，我做了一个`git svn find-rev XXXXX`确定与我想要的修订相对应的哈希，然后 git checkout。在此之后，关于 HEAD 的错误消失了并且`git svn reset -r XXXXX`工作了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T03:59:04.003

从个人经验来看，git-svn 在克隆或从具有相同参数的 svn 存储库中获取时总是生成完全相同的提交（尝试：创建一个虚拟存储库，使用 git-svn 克隆它，进行更多提交，再次克隆它，并获取第一个副本；生成的提交应该具有完全相同的哈希值）。

这为您提供了一个有趣的选择：您可以使用相同的参数启动一个单独的新镜像，并比较两者以查看它们在哪里分歧（或者它们根本分歧；一定要比较散列，因为它们很重要）。如果它们是相同的（或者您在它们分歧后决定提交无关紧要），您可以使用新镜像而不破坏分叉（或者如果您决定忽略一些分歧的提交，则减少它们的破坏）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-16T16:39:10.147

我遇到了同样的问题`git svn fetch`，但是重置方法对我不起作用，也许是因为我真的不知道损坏何时发生。这就是最终对我有用的方法。我做了一个`git svn fetch --ignore-paths="/branches/"`没有错误的运行。在那之后，我再次做了我的`git svn fetch`，这次成功了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-10T03:10:46.403

我有同样的问题，就像托德的情况一样，去以前的修订版解决了这个问题。

我认为解决方案是对有问题的文件进行两步修改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-28T14:10:18.527

我见过类似的问题。它发生在我对 svn repo 进行部分克隆时。我猜 git-svn 在执行 dcommit 时找不到文件的原始来源。我已经通过确保我完全是最新的（git svn rebase）然后使用 git svn set-tree 来提交对 subversion 的特定更改来修复它。如果您有很多更改要提交，这可能会很痛苦，因为您需要按顺序手动提交每个更改，但是如果您只有一两个提交要推送，则效果很好。

# java - 使用备忘录模式（和命令）存储复杂对象的状态

> ID：211034
> 
> 赞同：4
> 
> 时间：2008-10-17T03:57:35.317
> 
> 标签：java, design-patterns, command, state, memento

我正在开发一个使用 Java 的小型 UML 编辑器项目，这是我几个月前开始的。几周后，我得到了一个 UML 类图编辑器的工作副本。

但是现在，我完全重新设计它以支持其他类型的图表，例如序列、状态、类等。这是通过实现一个图形构建框架来完成的（Cay Horstmann 在该主题上的工作给我很大启发紫罗兰色 UML 编辑器）。

重新设计进展顺利，直到我的一位朋友告诉我，我忘记在项目中添加 Do/Undo 功能，在我看来，这是至关重要的。

想起面向对象的设计课程，我立刻想到了 Memento 和 Command 模式。

这是交易。我有一个抽象类 AbstractDiagram，它包含两个 ArrayList：一个用于存储节点（在我的项目中称为 Elements），另一个用于存储边缘（在我的项目中称为 Links）。该图可能会保留一堆可以撤消/重做的命令。很标准。

如何有效地执行这些命令？比如说，我想移动一个节点（该节点将是一个名为 INode 的接口类型，并且会有从它派生的具体节点（ClassNode、InterfaceNode、NoteNode 等））。

位置信息作为属性保存在节点中，因此通过修改节点本身中的属性，状态会改变。刷新显示时，节点将移动。这是模式的 Memento 部分（我认为），不同之处在于对象是状态本身。

此外，如果我保留原始节点的克隆（在它移动之前），我可以回到它的旧版本。相同的技术适用于节点中包含的信息（类或接口名称、注释节点的文本、属性名称等）。

问题是，在图中，如何在撤消/重做操作时将节点替换为其克隆？如果我克隆图表引用的原始对象（在节点列表中），则克隆不是图表中的引用，唯一指向的是命令本身！我是否应该在图中包含根据 ID 查找节点的机制（例如），以便我可以在图中用其克隆替换节点（反之亦然）？是否由 Memento 和 Command 模式来做到这一点？链接呢？它们也应该是可移动的，但我不想只为链接创建一个命令（一个只为节点创建一个命令），我应该能够根据命令对象的类型修改正确的列表（节点或链接）指的是。

你将如何进行？简而言之，我无法以命令/备忘录模式表示对象的状态，以便可以有效地恢复它并在图表列表中恢复原始对象，具体取决于对象类型（节点或链接）。

非常感谢！

纪尧姆。

PS：如果我不清楚，请告诉我，我会澄清我的信息（一如既往！）。

**编辑**

这是我在发布此问题之前开始实施的实际解决方案。

首先，我有一个 AbstractCommand 类定义如下：

```
public abstract class AbstractCommand {
    public boolean blnComplete;

    public void setComplete(boolean complete) {
        this.blnComplete = complete;
    }

    public boolean isComplete() {
        return this.blnComplete;
    }

    public abstract void execute();
    public abstract void unexecute();
} 
```

然后，使用 AbstractCommand 的具体派生来实现每种类型的命令。

所以我有一个移动对象的命令：

```
public class MoveCommand extends AbstractCommand {
    Moveable movingObject;
    Point2D startPos;
    Point2D endPos;

    public MoveCommand(Point2D start) {
        this.startPos = start;
    }

    public void execute() {
        if(this.movingObject != null && this.endPos != null)
            this.movingObject.moveTo(this.endPos);
    }

    public void unexecute() {
        if(this.movingObject != null && this.startPos != null)
            this.movingObject.moveTo(this.startPos);
    }

    public void setStart(Point2D start) {
        this.startPos = start;
    }

    public void setEnd(Point2D end) {
        this.endPos = end;
    }
} 
```

我还有一个 MoveRemoveCommand（用于...移动或删除对象/节点）。如果我使用 instanceof 方法的 ID，我不必将图表传递给实际的节点或链接，以便它可以将自己从图表中移除（我认为这是一个坏主意）。

AbstractDiagram 图；可添加对象；AddRemoveType 类型；

```
@SuppressWarnings("unused")
private AddRemoveCommand() {}

public AddRemoveCommand(AbstractDiagram diagram, Addable obj, AddRemoveType type) {
    this.diagram = diagram;
    this.obj = obj;
    this.type = type;
}

public void execute() {
    if(obj != null && diagram != null) {
        switch(type) {
            case ADD:
                this.obj.addToDiagram(diagram);
                break;
            case REMOVE:
                this.obj.removeFromDiagram(diagram);
                break;
        }
    }
}

public void unexecute() {
    if(obj != null && diagram != null) {
        switch(type) {
            case ADD:
                this.obj.removeFromDiagram(diagram);
                break;
            case REMOVE:
                this.obj.addToDiagram(diagram);
                break;
        }
    }
} 
```

最后，我有一个 ModificationCommand，用于修改节点或链接的信息（类名等）。这可能在将来与 MoveCommand 合并。这个类暂时是空的。我可能会使用一种机制来确定修改后的对象是节点还是边（通过 instanceof 或 ID 中的特殊表示）来执行 ID 操作。

这是一个好的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T04:47:40.600

我认为您只需要将问题分解为较小的问题。

第一个问题： 问：如何用备忘录/命令模式来表示你的应用程序中的步骤？首先，我不知道你的应用程序是如何工作的，但希望你能看到我的目标。假设我想在图表上放置一个具有以下属性的 ClassNode

```
{ width:100, height:50, position:(10,25), content:"Am I certain?", edge-connections:null} 
```

这将被包装为一个命令对象。说去一个DiagramController。然后图表控制器的职责可以是记录该命令（我敢打赌将其压入堆栈）并将命令传递给DiagramBuilder。DiagramBuilder 实际上将负责更新显示。

```
DiagramController
{
  public DiagramController(diagramBuilder:DiagramBuilder)
  {
    this._diagramBuilder = diagramBuilder;
    this._commandStack = new Stack();
  }

  public void Add(node:ConditionalNode)
  {
    this._commandStack.push(node);
    this._diagramBuilder.Draw(node);
  }

  public void Undo()
  {
    var node = this._commandStack.pop();
    this._diagramBuilderUndraw(node);
  }
} 
```

像这样的事情应该做到这一点，当然会有很多细节需要整理。顺便说一句，您的节点拥有的属性越多，Undraw 就越详细。

使用 id 将堆栈中的命令链接到绘制的元素可能是一个好主意。这可能看起来像这样：

```
DiagramController
{
  public DiagramController(diagramBuilder:DiagramBuilder)
  {
    this._diagramBuilder = diagramBuilder;
    this._commandStack = new Stack();
  }

  public void Add(node:ConditionalNode)
  {
    string graphicalRefId = this._diagramBuilder.Draw(node);
    var nodePair = new KeyValuePair<string, ConditionalNode> (graphicalRefId, node);
    this._commandStack.push(nodePair);
  }

  public void Undo()
  {
    var nodePair = this._commandStack.pop();
    this._diagramBuilderUndraw(nodePair.Key);
  }
} 
```

在这一点上，您不必绝对*拥有*该对象，因为您拥有 ID，但如果您决定还实现重做功能，这将很有帮助。为您的节点生成 id 的一个好方法是为它们实现一个 hashcode 方法，除非您不能保证不会以导致哈希码相同的方式复制您的节点。

问题的下一部分是在您的 DiagramBuilder 中，因为您正试图弄清楚如何处理这些命令。为此，我只能说真的只是确保您可以为您可以添加的每种类型的组件创建一个反向操作。要处理断开连接，您可以查看边缘连接属性（我认为代码中的链接）并通知每个边缘连接它们将与特定节点断开连接。我会假设在断开连接时，他们可以适当地重新绘制自己。

总而言之，我建议不要在堆栈中保留对您的节点的引用，而只是一种表示当时给定节点状态的令牌。这将允许您在多个位置表示撤消堆栈中的同一节点，而无需引用同一对象。

如果你有 Q 就发帖。这是一个复杂的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-02T18:26:43.780

以我的拙见，您的想法比实际情况更复杂。为了恢复到以前的状态，根本不需要克隆整个节点。而是每个*** *Command 类将具有 -

1.  引用它所作用的节点，
2.  memento 对象（具有足以让节点恢复到的状态变量）
3.  执行（）方法
4.  撤消（）方法。

由于命令类具有对节点的引用，因此我们不需要 ID 机制来引用图中的对象。

在您问题的示例中，我们希望将节点移动到新位置。为此，我们有一个 NodePositionChangeCommand 类。

```
public class NodePositionChangeCommand {
    // This command will act upon this node
    private Node node;

    // Old state is stored here
    private NodePositionMemento previousNodePosition;

    NodePositionChangeCommand(Node node) {
        this.node = node;
    }

    public void execute(NodePositionMemento newPosition) {
        // Save current state in memento object previousNodePosition

        // Act upon this.node
    }

    public void undo() {
        // Update this.node object with values from this.previousNodePosition
    }
} 
```

> > 链接呢？它们也应该是可移动的，但我不想只为链接创建一个命令（一个只为节点创建一个命令）。

我在 GoF 书（在纪念品模式讨论中）读到，随着节点位置变化的链接移动是由某种约束求解器处理的。

# visual-c++ - 致命错误 C1083：无法打开包含文件：“Windows.h”：和 scons

> ID：211035
> 
> 赞同：9
> 
> 时间：2008-10-17T03:58:42.413
> 
> 标签：visual-c++, path, environment, scons, include

今天是我正式使用 C++ 的第一天 :P

我已经下载了 Visual C++ 2005 Express Edition 和 Microsoft Platform SDK for Windows Server 2003 SP1，因为我想接触开源[Enso Project](http://code.google.com/p/enso)。

因此，在安装 scons 后，我进入控制台并尝试使用 scons 进行编译，但出现此错误：

```
C:\oreyes\apps\enso\enso-read-only\src\platform\win32\Include\WinSdk.h(64) : fatal error C1083: Cannot open include file: 'Windows.h': No such file or directory
scons: *** [src\platform\win32\InputManager\AsyncEventProcessorRegistry.obj] Error 2
scons: building terminated because of errors. 
```

检查这些链接后：

[VS ans PSDK](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=1135164&SiteID=1)

[包括 tiffi.h](https://stackoverflow.com/questions/160938/fatal-error-c1083-cannot-open-include-file-tiffioh-no-such-file-or-directory-vc#160957)

[窗口.h](https://stackoverflow.com/questions/80788/fatal-error-c1083-cannot-open-include-file-windowsh-no-such-file-or-directory#81226)

我设法像这样配置我的安装：

![替代文字](https://i.stack.imgur.com/z41N8.png)

甚至运行这个脚本

![替代文字](https://i.stack.imgur.com/1rB1L.png)

我设法在IDE中编译了下面的文件。

```
// Test.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include <Windows.h>

int _tmain(int argc, _TCHAR* argv[])
{
    return 0;
} 
```

但我仍然在控制台中得到那个异常。有人有scons经验吗？

**编辑**

实际上（我忘了告诉你这一点）我使用“Visual Studio 2005 命令提示符”链接启动了命令提示符。

我假设这将包括环境变量中的路径。好吧，在打印它们之后，我发现它没有：

```
 echo %INCLUDE%
 echo %LIB%
 echo %PATH% 
```

他们不存在，所以我创建了这个 .bat 文件：

```
set PATH=%PATH%;"C:\Program Files\Microsoft Platform SDK\Bin"
set INCLUDE=%INCLUDE%;"C:\ Program Files\Microsoft Platform SDK\Include"
set LIB=%LIB%;"C:\ Program Files\Microsoft Platform SDK\Lib" 
```

尽管如此，scons 似乎不接受 vars ... :(

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-17T05:54:18.187

使用上述建议不适用于 scons：scons 不会导入用户环境（PATH 和其他变量）。根本问题是 scons 不处理最新版本的 SDKs/VS 。

我是 scons 的偶尔贡献者，并且正在开发这个功能 ATM。希望它很快会包含在 scons 中，但该功能比我最初预期的要可靠地实现要困难得多，部分原因是每个 sdk/编译器组合都是不同的（有时甚至 MS 都不正确，他们的一些 .bat 文件坏了），所以我不能给你约会。我希望它会包含在 1.2 中（大约一个月内发布）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T04:56:43.700

您需要设置包含文件路径（可能还有其他内容）。在命令行中，这通常使用 Visual Studio 安装的批处理文件`vsvars32.bat`（或`vcvars32.bat`为了与 VC6 兼容）来完成。

我不熟悉 scons 所以我不知道为该工具配置这些设置的最佳方法，但对于标准 makefile，makefile 中通常有一行设置包含目录路径的宏变量，该宏是在调用编译器的命令中用作命令行参数的一部分。

另一种可能是让 scons 进程调用 vsvars32.bat 或从已使用批处理文件配置的命令行运行 scons 脚本。

简而言之，您需要以某种方式将 vsvars32.bat 配置的内容放入 scons 配置中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T05:33:13.283

将有一个与此类似的批处理文件（用于 MSVC 2005），用于设置环境变量：

```
c:\Program Files\Microsoft Visual Studio 8\Common7\Tools\vsvars32.bat 
```

**第 1 步**：在 Express 安装文件夹中找到类似的文件

**第 2 步：使用这些目标详细信息和***适当修改*的路径在桌面上创建一个快捷方式：

```
cmd.exe /K "c:\Program Files\Microsoft Visual Studio 8\Common7\Tools\vsvars32.bat" 
```

**第 3 步：**通过此快捷方式打开 DOS 提示符

命令行构建现在应该在此控制台窗口中工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T04:08:49.197

您向我们展示了如何配置 Visual Studio 以在 Visual Studio 中进行编译，但您没有向我们展示您尝试过的命令行环境。抱歉，我没有尝试过 Express 版本，所以我不知道他们是否会创建额外的开始菜单快捷方式，如 Pro 及以上版本。如果您打开一个已经设置了环境变量的合适的命令提示符，那么您可以在命令行上进行编译。否则，每次打开命令提示符时，您都必须自己设置变量或执行批处理脚本来设置它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-21T20:02:03.530

当 scons 自动执行此操作时会很好。现在，我使用它（从 SDK 命令提示符运行，不确定在 vsvars32.bat 之后运行是否有区别）：

```
import os
env = Environment(ENV={'PATH': os.environ['PATH']})

env['ENV']['TMP'] = os.environ['TMP']
env.AppendUnique(CPPPATH=os.environ['INCLUDE'].split(';'))
env.AppendUnique(LIBPATH=os.environ['LIB'].split(';')) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T13:36:47.910

在使用命令行提示符使用 Visual C++ 2005 Express 编译 wxwidgets 时，这对我有用：

```
REM Fix Error error C1083 'windows.h' 
```

（编译时使用 /useenv 选项。）

```
set PDSKWIN=C:\Program Files\Microsoft Platform SDK for Windows Server 2003 R2 
```

**（换到右边。）**

```
set INCLUDE=%PDSKWIN%\Include;%INCLUDE%

set LIB=%PDSKWIN%\Lib;%LIB% 
```

然后我在编译时使用这一行。我相信只需添加`/useenv`到您的行中，一切都会正常工作：

```
vcbuild /useenv /nohtmllog /nologo name.proj (or any file to compile) 
```

# c# - 在 C# 中自动处理电子邮件

> ID：211037
> 
> 赞同：1
> 
> 时间：2008-10-17T04:01:13.377
> 
> 标签：c#, outlook-2003

[与此类](https://stackoverflow.com/questions/56722/automated-processing-of-an-email-in-java)似的问题，但针对 Microsoft 环境。

电子邮件 --> Exchange 服务器 --> [某事]

对于 [something] 我使用的是 Outlook 2003 和 C# 但*感觉*很乱（一个程序正在尝试访问 Outlook，这可能是病毒等）

```
Microsoft.Office.Interop.Outlook.Application objOutlook = new Microsoft.Office.Interop.Outlook.Application();
Microsoft.Office.Interop.Outlook.NameSpace objNS = objOutlook.GetNamespace("MAPI");
objNS.Logon("MAPIProfile", "MAPIPassword", false, true); 
```

这是最好的方法吗？有没有更好的方法在 Microsoft 环境中检索和处理电子邮件？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T04:22:30.430

[该](http://www.codeproject.com/KB/IP/NetPopMimeClient.aspx)库为您提供对 POP3 协议和 MIME 的基本支持，您可以使用它来检查指定的邮箱并检索电子邮件和附件，您可以根据需要对其进行调整。

这是[另一个库](http://www.codeproject.com/KB/IP/imaplibrary.aspx)，这个库用于 IMAP 协议，它非常基础，但也允许您获取完整的消息，包括附件......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T06:47:17.270

我对提供 IMAP 访问的[Rebex 组件很满意。](http://www.rebex.net/mail.net/)当然，您需要确保您的 Exchange 管理员会在您的 Exchange 服务器上打开 IMAP 端口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-27T14:09:19.097

使用 IMAP 是一种方法。您可以使用[Mail.dll IMAP 组件](http://www.lesnikowski.com/mail/)：

```
using(Imap imap = new Imap())
{
    imap.Connect("imap.company.com");
    imap.UseBestLogin("user", "password");

    imap.SelectInbox();
    List<long> uids = imap.Search(Flag.Unseen);
    foreach (long uid in uids)
    {
          var eml = imap.GetMessageByUID(uid);
          IMail message = new MailBuilder()
                    .CreateFromEml(eml);

          Console.WriteLine(message.Subject);
          Console.WriteLine(message.Text); 
    }
    imap.Close(true);
} 
```

您可以在此处下载：[Mail.dll 电子邮件组件](http://www.lesnikowski.com/mail/)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-11-11T09:21:54.197

我正在尝试[http://csharpopensource.com/openpopdotnet.aspx](http://csharpopensource.com/openpopdotnet.aspx)，它最近已更新，还不错。它缺乏良好的文档，但它也适用于 gmail/ssl。

# java - 您编写的每个方法都使用 Javadoc 吗？

> ID：211041
> 
> 赞同：52
> 
> 时间：2008-10-17T04:04:20.857
> 
> 标签：java, api, javadoc

我应该为我所有的 java 方法写 Doc Comments 吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-10-17T04:17:03.953

@克劳迪乌

> 当我编写其他人会使用的代码时 - 是的。其他人可以使用的每个方法（任何公共方法）都应该有一个 javadoc，至少说明它的明显目的。

@丹尼尔斯皮瓦克

> 我彻底记录了每个 API 类中的每个公共方法。具有公共成员但不供外部使用的类在类 javadoc 中显着标记。我还记录了每个 API 类中的每个受保护方法，尽管程度较轻。这延续了这样一个想法，即任何扩展 API 类的开发人员都已经对正在发生的事情有一个公平的概念。
> 
> 最后，为了自己的利益，我偶尔会记录私有和封装私有方法。我认为在其使用中需要一些解释的任何方法或字段都将收到文档，无论其可见性如何。

@保罗·德弗里兹

> 对于诸如琐碎的 getter 和 setter 之类的事情，在它们之间分享评论并描述属性的用途，而不是 getter/setter

```
/** 
 * Get the current value of the foo property.
 * The foo property controls the initial guess used by the bla algorithm in
 * {@link #bla}
 * @return The initial guess used by {@link #bla}
 */
int getFoo() {
  return foo;
} 
```

是的，这是更多的工作。

@VonC

当您将一个巨大的复杂方法（由于[高圈复杂度](https://stackoverflow.com/questions/105852/conditional-logging-with-minimal-cyclomatic-complexity)的原因）分解为：

*   一种公共方法调用
*   几种私有方法，代表公共方法的内部步骤

，javadoc 私有方法也非常有用，即使该文档在 javadoc API 文件中不可见。
尽管如此，它仍然可以让您更轻松地记住复杂算法的不同步骤的精确性质。

请记住：**[限制值或边界条件](https://stackoverflow.com/questions/61604)**也应该是您的 javadoc 的一部分。

另外，***javadoc 比简单的“//comment”要好得多***：

*   它被 IDE 识别并用于在您将光标移动到您的一个 - javadoc-ed - 函数的顶部时显示一个弹出窗口。例如，一个*常量*——即私有静态最终变量——应该有一个 javadoc，尤其是当它的值不是微不足道的时候。恰当的例子：正则***表达式***（它的 javadoc 应该包含非转义形式的正则表达式，目的是什么以及正则表达式匹配的文字示例）
*   它可以由外部工具（如[xdoclet](http://xdoclet.sourceforge.net/xdoclet/index.html)）解析

@Domci

> 对我来说，如果有人看到它并不重要——几个月后我不太可能知道我写的一些晦涩的代码会做什么。[...]
> 简而言之，注释逻辑，而不是语法，并且只在适当的地方做一次。

@米格尔平

> 要评论某事，您必须先了解它。当您尝试注释函数时，实际上是在考虑方法/函数/类的作用，这使您在 javadoc 中更加具体和清晰，从而使您编写的代码更加清晰简洁，这很好.

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-10-17T04:12:12.357

如果该方法显然是不言而喻的，我可能会跳过 javadoc 注释。

评论喜欢

```
/** 是否 Foo */
 无效 doFoo();

```

真的没那么好用。（过于简单的例子，但你明白了）

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2008-10-17T04:08:14.797

我*彻底*记录了每个 API 类中的每个公共方法。具有公共成员但不供外部使用的类在类 javadoc 中显着标记。我还记录了每个 API 类中的每个受保护方法，尽管程度较轻。这延续了这样一个想法，即任何扩展 API 类的开发人员都已经对正在发生的事情有一个公平的概念。

最后，为了自己的利益，我偶尔会记录私有和封装私有方法。我认为在其使用中需要一些解释的任何方法或字段都将收到文档，无论其可见性如何。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-10-17T08:49:28.443

对于诸如琐碎的 getter 和 setter 之类的事情，在它们之间分享评论并描述属性的用途，而不是 getter/setter 的用途。

```
/** 
 * Get foo
 * @return The value of the foo property
 */
int getFoo() {
  return foo;
} 
```

是**没有用**的。最好做类似的事情：

```
/** 
 * Get the current value of the foo property.
 * The foo property controls the initial guess used by the bla algorithm in
 * {@link #bla}
 * @return The initial guess used by {@link #bla}
 */
int getFoo() {
  return foo;
} 
```

是的，这是更多的工作。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-10-17T23:20:07.263

其他人已经覆盖的所有基地；附加说明：

如果你发现自己这样做：

```
/**
 * This method currently launches the blaardh into the bleeyrg.
 */
void execute() { ... } 
```

考虑将其更改为：

```
void launchBlaardhIntoBleeyrg() { ... } 
```

这似乎有点明显，但在许多情况下，您自己的代码很容易错过这个机会。

最后请记住，并非*总是*需要更改；例如，方法的行为可能会随着时间的推移而发展（注意 JavaDoc 中的“当前”一词）。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2016-10-19T15:25:25.750

不，不要评论每个方法、变量、类等。

这是来自“清洁代码：敏捷软件工艺手册”的引述：

> 有一个规则说每个函数都必须有一个 javadoc，或者每个变量都必须有一个注释，这简直是愚蠢的。像这样的评论只会弄乱代码，散布谎言，并导致普遍的混乱和混乱。

*当且仅当它为方法、变量、类等的预期*用户添加重要信息时才应该存在注释。什么构成“重要”值得考虑，并且可以在/如果我回来时提醒自己对于此方法/类/等，该方法的结果/副作用，该事物存在的动机（在某些代码克服某些库或系统的缺点/错误的情况下），有关性能的重要信息或者什么时候适合打电话等等。

不是一个好的注释*但*表明代码本身应该被重写/修改的是解释复杂和晦涩的方法或函数的细节的注释。相反，更喜欢更短更清晰的代码。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-17T06:08:44.990

当我为自己编写代码时 -**不**。在这种情况下，java 文档是浪费我的时间。

当我编写其他人会使用的代码时 -**是**的。其他人可以使用的每个方法（任何公共方法）都应该有一个 java 文档，至少说明它的明显目的。为了进行良好的测试 - 在您的代码上运行 javadoc 创建实用程序（我现在忘记了确切的命令行）。浏览它生成的网页。如果您对使用具有该级别文档的库感到满意，那么您就是黄金。如果没有，**请在您的代码中编写更多 javadocs**。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-10-18T15:45:49.647

您应该使用 javadocs 还有另一个原因。要评论某事，您必须先了解它。当您尝试对函数进行注释时，您实际上是在*考虑*方法/函数/类的作用，这使您在 javadoc 中更加具体和清晰，这反过来又使您编写的代码更加清晰简洁，这很好.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-17T05:03:32.813

简单地说：是

您需要考虑是否应该编写文档的时间最好花在编写文档上。

写一个单行代码总比花时间根本不记录方法要好。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-18T09:48:01.677

对我来说，如果有人看到它并不重要——几个月后我不太可能知道我写的一些晦涩的代码会做什么。有一些指导方针：

1.  API、框架类和内部可重用的静态方法应该被彻底注释掉。

2.  每一段复杂代码中的逻辑都应该在两个地方解释——javadoc中的一般逻辑，以及代码中每个有意义的部分的逻辑在它自己的注释中。

3.  如果模型属性不明显，则应对其进行注释。例如，评论用户名和密码没有意义，但 type 至少应该有一个评论，说明 type 的可能值。

4.  我不记录 getter、setter 或任何“按书”完成的事情。如果团队有创建表单、适配器、控制器、外观的标准方法......我不记录它们，因为如果所有适配器都相同并且具有一组标准方法，那是没有意义的。任何熟悉框架的人都会知道它们的用途——假设框架的理念和使用它的方式记录在某个地方。在这种情况下，评论意味着额外的混乱并且没有任何意义。当类做一些非标准的事情时，这有例外——那么简短的评论很有用。此外，即使我以标准方式创建表单，我也喜欢用简短的注释来划分表单的各个部分，这些注释将代码分成几个部分，例如“帐单地址从这里开始”。

简而言之，注释逻辑，而不是语法，并且只在适当的地方做一次。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-04-02T15:31:11.537

不应依赖 Java 文档，因为它会给开发人员带来负担，因为它需要进行更改以维护 Java 文档和代码。

类名和函数名应该足够明确以解释发生了什么。

如果要解释一个类或方法的作用使其名称太长而无法处理，则该类或方法的重点不够，应该重构为更小的单元。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-17T07:19:43.180

我觉得至少应该对接受的参数和返回类型进行评论。
如果函数名称描述完整，可以跳过实现细节，例如**sendEmail(..)**；

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-26T01:34:18.063

你可能真的应该记录你所有的方法。最重要的是公共 API 方法（尤其是已发布的 API 方法）。私有方法有时没有记录，尽管我认为它们应该记录，只是为了清楚起见——受保护的方法也是如此。您的评论应该提供信息，而不仅仅是重复代码的作用。

如果某个方法特别复杂，建议您将其记录在案。有些人认为代码应该写得很清楚，这样就不需要注释了。然而，这并不总是可行的，因此在这些情况下应该使用注释。

您可以通过代码模板从 Eclipse 自动为 getter/setter 生成 Javadoc 注释，以节省您必须编写的文档数量。另一个技巧是使用@{$inheritDoc} 来防止接口和实现类之间的代码注释重复。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-10-17T10:20:03.593

Javadoc 对于库和可重用组件非常有用。但让我们更实际一些。拥有自我解释的代码比 javadoc 更重要。如果您想象一个带有 Javadocs 的大型遗留项目 - 您会依赖它吗？我不这么认为......有人添加了 Javadoc，然后实现发生了变化，添加了（删除）新功能，所以 Javadoc 已经过时了。正如我提到的，我喜欢为库提供 javadocs，但对于活动项目，我更喜欢

*   具有描述其作用的名称的小函数/类
*   清晰的单元测试用例解释函数/类的作用

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-17T06:02:41.837

在以前的公司，我们曾经在 eclipse 中使用 jalopy 代码格式化程序。这会将 javadoc 添加到包括私有在内的所有方法中。

记录 setter 和 getter 让生活变得很困难。但到底是什么。你必须去做——你去做。这让我学习了 XEmacs 的一些宏功能 :-) 你可以通过编写一个 java 解析器和评论器来进一步自动化它，就像几年前 ANTLR 创建者所做的那样 :-)

目前，我记录了所有公共方法和超过 10 行的任何内容。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-17T23:42:15.457

我尝试至少记录每个公共和接口属性和方法，以便调用我的代码的人知道它们是什么。为了维护起见，我也尝试尽可能多地发表评论。即使是我在自己的时间为自己做的“个人”项目，我尝试使用 javadoc 只是因为我可能会搁置一年，然后再回来。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-18T16:22:01.647

每当写 javadoc 注释不重要时，我都会强调，在使用 Eclipse 或 netbeans 之类的 IDE 时编写 javadoc 注释并不是那么麻烦。此外，当您编写 javadoc 注释时，您不仅要考虑该方法的作用，还要考虑该方法的**确切**作用以及您所做的假设。

另一个原因是，一旦您理解了代码并对其进行了重构，javadoc 让您忘记它的作用，因为您可以随时参考它。我并不是在提倡故意忘记你的方法做了什么，只是我更喜欢记住其他更重要的事情。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-18T23:32:19.077

您可以针对没有 javadoc 注释的代码运行 javadoc，如果您为方法和参数提供周到的名称，它将生成相当有用的 javadoc。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-05-25T14:09:38.377

假设到目前为止的所有答案都是评论将是好的评论。众所周知，情况并非总是如此，有时它们甚至是不正确的。如果您必须阅读代码以确定其意图、边界和预期的错误行为，则缺少注释。例如，方法是否线程安全，任何 arg 是否可以为 null，是否可以返回 null，等等。注释应该是任何代码审查的一部分。

这对于私有方法可能更为重要，因为代码库的维护者将不得不处理 API 用户不会处理的问题。

也许 IDE 应该具有允许使用文档表单的功能，以便开发人员可以检查对当前方法很重要且适用的各种属性。

# intellij-idea - 在 KDE 中禁用全局 Ctrl-Alt-L 热键

> ID：211043
> 
> 赞同：61
> 
> 时间：2008-10-17T04:04:50.763
> 
> 标签：intellij-idea, desktop, kde

重新格式化源代码的IntelliJ IDEA 快捷方式是`Ctrl`++ 。这恰好在 KDE 中锁定屏幕（Gnome 也是？）。如何禁用此功能以便 IntelliJ 接收键序列？`Alt``L`

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-10-17T04:16:10.287

在 K 菜单下，转到控制中心。

区域和可访问性 | 键盘快捷键 | 快捷方式选项卡，全局快捷方式选项卡。

在搜索框中，键入“lock”，这应该会缩小可见的快捷方式并显示`Ctrl`++一个（“Lock Session”）`Alt`。`L`

在下方，单击无。

单击应用按钮。

* * *

在 KDE Plasma 5 上，转到系统设置 | 桌面行为 | 屏幕锁定

在这里，您将找到“键盘快捷键”选项。将其更改为其他内容或设置为无

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-10-31T18:00:31.630

在 Kubuntu 11.10 上，它*隐藏得很好*：

1.  启动**系统设置**
2.  在**Common Appearance and Behavior**下，选择**Shortcuts and Gestures**。
3.  在左侧面板中选择**全局键盘快捷键。**
4.  选择 KDE 组件：**运行命令界面**（重要，否则您将看不到`ctrl`- `alt`-`L`映射！）
5.  选择**锁定会话**
6.  编辑设置，选择不同的映射或“无”。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-23T18:50:12.330

我最终找到了如何在系统设置应用程序中禁用锁屏键绑定 ( `Ctrl`- `Alt`- )。`L`

系统设置->“键盘鼠标->键盘快捷键

我不得不选择 KDE 组件：运行命令界面。

我在 Fedora Core 9 上运行 KDE。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-03-04T14:28:29.517

对于 Linux Mint：系统设置 -> 键盘 -> 键盘快捷键 -> 系统 -> 锁定屏幕

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-05-02T10:52:06.387

在 KDE 中为特定应用程序禁用所有全局键盘快捷键很容易。我已经在 KDE 4 中完成了它，现在我又在 KDE 5 中完成了它。所以在 KDE 5 中右键单击应用程序的窗口标题 -> 更多操作 -> 特殊窗口设置（或特殊应用程序设置） -> 外观和修复 -> 忽略全局快捷方式 -> 强制，是的。这比逐个查找每个快捷方式要容易得多。

您可以在系统设置 -> 窗口管理 -> 窗口规则中检查此类配置。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-03-03T07:42:21.823

除了禁用任何东西之外，您还可以在大多数存在此问题的应用程序中使用`ctrl`++ 。KDE 知道元键（又名“windows 键”），但应用程序似乎忽略它并认为它只是+ + 。`meta``alt``l``ctrl``alt``l`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-11-27T13:41:04.827

我知道，老问题，但我不容易找到一个像样的答案。如果有人想知道如何在**Ubuntu**上禁用它（虽然`Windows_key`+`L`快捷方式仍然有效）：

去`Settings -> Keyboard -> Shortcuts tab -> System -> select Lock screen and press backspace`清除它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-09T01:50:22.453

对于**KDE 等离子 5**

1 - 单击**K 菜单**，键入键盘，选择`Global Keyboard shortcuts`

2 - 选择`KDE Session Manager`在**KDE 组件**中，在`Lock Session`，做你想做的，禁用快捷方式或选择另一个！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-06-21T16:32:51.833

对于 Ubuntu 16.04`System settings -> Keyboard -> Shortcut -> System -> LockScreen -> click-it and make changes`

我把我的从`ctrl`++改成了`alt`++`H``ctrl``atl``L`

这是屏幕截图，它告诉您上述说明将引导您到哪里。 [键盘 -> 快捷键](https://i.stack.imgur.com/MYz77.png)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-03-12T05:04:19.680

另一种选择是将 Idea 键盘映射更改为使用 KDE 的默认值。您可以转到*文件 -> 设置 -> 键盘映射*，然后从下拉列表中选择**KDE 的默认选项**

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-05-27T21:53:07.213

您也可以使用配置文件更改它。

以下文件存储了 KDE Plasma 5 及其相关应用程序（如 Konsole 和 KWrite）的键盘快捷键。

```
~/.config/kdeglobals
~/.config/kglobalshortcutsrc
~/.config/khotkeysrc
~/.config/kwinrc
~/.config/plasma-org.kde.plasma.desktop-appletsrc
~/.local/share/kxmlgui5/katepart/katepart5ui.rc
~/.local/share/kxmlgui5/konsole/konsoleui.rc
~/.local/share/kxmlgui5/konsole/sessionui.rc
~/.local/share/kxmlgui5/kwrite/kwriteui.rc 
```

让我添加文件的描述。

标准快捷方式（系统设置 > 快捷方式）~/.config/kdeglobals

全局快捷方式（系统设置 > 快捷方式）~/.config/kglobalshortcutsrc

“自定义快捷方式”（系统设置 > 快捷方式）~/.config/khotkeysrc

Konsole ~/.local/share/kxmlgui5/konsole/konsoleui.rc ~/.local/share/kxmlgui5/konsole/sessionui.rc

KWrite > 设置 > 配置快捷方式... > KWrite ~/.local/share/kxmlgui5/kwrite/kwriteui.rc

KWrite > 设置 > 配置快捷方式... > Kate Part ~/.local/share/kxmlgui5/katepart/katepart5ui.rc

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-10-17T16:15:54.823

对于那些喜欢视觉答案的人，可以在此处找到此设置 [![在此处输入图像描述](https://i.stack.imgur.com/NJwdx.png)](https://i.stack.imgur.com/NJwdx.png)

**重要**请注意，有两个值：*Global*和*Global Alternative*。我不得不取消绑定*Global Alternative*快捷方式来解决 IntelliJ 的问题。

# python - 在python中用win32在内存中创建一个图标

> ID：211046
> 
> 赞同：1
> 
> 时间：2008-10-17T04:07:42.940
> 
> 标签：python, windows, winapi, icons

在python中生成内存图标的好方法是什么？现在我被迫使用 pygame 来绘制图标，然后我将它作为 .ico 文件保存到磁盘，然后我从磁盘加载它作为 ICO 资源......

像这样的东西：

```
 if os.path.isfile(self.icon):
        icon_flags = win32con.LR_LOADFROMFILE | win32con.LR_DEFAULTSIZE
        hicon = win32gui.LoadImage(hinst,
                                   self.icon,
                                   win32con.IMAGE_ICON,
                                   0,
                                   0,
                                   icon_flags) 
```

...其中 self.icon 是我创建的图标的文件名。

有没有办法在内存中做到这一点？编辑：我想要做的就是创建一个带有 2 位数字的图标（天气任务栏样式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T07:22:12.207

您可以为此使用[wxPython 。](http://wxpython.org/)

```
from wx import EmptyIcon
icon = EmptyIcon()
icon.CopyFromBitmap(your_wxBitmap) 
```

wxBitmap可以使用 wxMemoryDC 在内存中生成，在[此处](http://docs.wxwidgets.org/stable/wx_wxbitmap.html#wxbitmap)[查找](http://docs.wxwidgets.org/stable/wx_wxmemorydc.html#wxmemorydc)[可以](http://docs.wxwidgets.org/stable/wx_wxdc.html)在DC 上执行的操作。

然后可以使用以下方法将此图标应用于 wxFrame（窗口）或 wxTaskBarIcon：

```
frame.SetIcon(icon) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T04:49:23.950

您可能可以创建一个模仿 python 文件对象接口的对象。

[http://docs.python.org/library/stdtypes.html#bltin-file-objects](http://docs.python.org/library/stdtypes.html#bltin-file-objects)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-04T17:44:55.793

这对我有用，不需要 wx.

```
from ctypes import *
from ctypes.wintypes import *

CreateIconFromResourceEx = windll.user32.CreateIconFromResourceEx
size_x, size_y = 32, 32
LR_DEFAULTCOLOR = 0

with open("my32x32.png", "rb") as f:
    png = f.read()
hicon = CreateIconFromResourceEx(png, len(png), 1, 0x30000, size_x, size_y, LR_DEFAULTCOLOR) 
```

# java - 查找 Swing/AWT 对象的“真实”高度/宽度

> ID：211051
> 
> 赞同：9
> 
> 时间：2008-10-17T04:09:09.630
> 
> 标签：java, swing

因为 Canvas3D 无法使用父框架动态调整大小，所以我希望能够跟踪用户何时调整窗口大小，然后自己手动调整窗口大小。（如果这最终导致 Canvas3D 崩溃，正如一些文档所建议的那样，我将在用户调整其窗口大小时简单地销毁并重新创建它）。此过程的一部分涉及能够准确地判断容器面板的大小。

我试过的两种方法：

```
面板.getHeight();
panel.getPreferredSize().height;
```

似乎没有准确地报告事情：`getHeight()`总是为零，并`getPreferredSize()`返回实际上与面板的实际大小没有任何关系的数字。

有任何想法吗？

**编辑**：因此，我将调试器带到面板对象并手动检查了非对象属性，但没有看到任何类似于宽度/高度的东西。当然，有些子对象我没有看过。另外，当我查询高度/对象时，也许窗口必须是可见的（它不是，在我连接对象的时候）？

**编辑 2**：所以，Swing 类是 AWT 类的子类，所以我想如果你能够找到这些类的高度/宽度，那么这种方法就会泛化。我已经相应地修改了标题。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-17T04:41:56.820

要确定组件的大小，您必须：

*   在某个时候手动设置它
*   运行负责布局组件的布局管理器

通常，您可以通过 getSize() 方法获得组件的确切大小，该方法返回一个包含宽度和高度的 Dimension 对象，但 getWidth/Height() 也应该可以工作。但这只有在满足两个先决条件之一的情况下才有效。如果窗口从未可见，没有布局管理器或在窗口/容器可见后添加了组件（您想知道其大小），则大小通常为零。

因此，要获得正确的大小，您必须使容器/框架可见（在添加组件之后）或在容器上调用 validate() 或 doLayout() 以重新计算布局，如果您在最后一个布局之后添加了组件已完成。要记住的另一件事是在容器上设置并可能配置布局管理器。如果没有设置布局管理器（null），即使使容器可见或调用 validate() 也不会为其子级设置大小。

minimumSize/preferredSize/maximumSize 属性是布局管理器的提示，组件应该如何调整大小，但*它不必*遵守它们（大多数布局管理器不需要）。

**编辑 2：**在我阅读了您关于同一主题[的其他问题](https://stackoverflow.com/questions/210998/canvas3d-not-appearing-in-swing-window)后，我认为您应该阅读The Java Tutorials 中的[Using Layout Managers](http://java.sun.com/docs/books/tutorial/uiswing/layout/using.html)

**编辑：**我不知道你是否已经想通了，但是要对窗口大小的调整做出反应，你可以这样做：

```
public class WindowResizeTest extends JFrame {

    public static void main(String[] args) {
        new WindowResizeTest();
    }

    public WindowResizeTest() {
        this.setSize(640, 480);

        JPanel panel = new JPanel();
        panel.setBackground(Color.RED);
        this.add(panel);

        this.addComponentListener(new ComponentListener() {

            public void componentResized(ComponentEvent e) {
                System.out.println(e.getComponent().getSize());
            }

            public void componentHidden(ComponentEvent e) {}

            public void componentMoved(ComponentEvent e) {}

            public void componentShown(ComponentEvent e) {}
        });

        this.setVisible(true);
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:49:24.257

我发现如果你通过 JFrame 扩展，这段代码也可以用来节省时间、精力和空间。

```
int windowWidth = getWidth();
int windowHeight = getHeight(); 
```

我知道您已经得到了答案，但如果您需要替代方案，这里就是。

# usergroups - 是什么促使您参加本地用户组？

> ID：211052
> 
> 赞同：5
> 
> 时间：2008-10-17T04:11:37.147
> 
> 标签：usergroups

所以我在爱荷华州的得梅因市，考虑到我们的规模，我们在我们所在地区拥有大量用户组。Ruby、.Net、Java、Agile、*nix 等......好吧，今晚我们这些用户组的很多“领导者”聚在一起喝了几杯酒，并讨论了我们如何共同努力来帮助“DeMo”（我一直在 Twitter 上看到这个）用户组场景更好。

我们提出了一些相当不错的想法，但我很好奇。是什么促使您参加本地用户组？在这里深入挖掘。也许是免费的披萨，或者是赠品。但我更感兴趣的是了解免费赠品之外的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T04:14:11.260

我一直认为专业网络是非常宝贵的。我因为 Denver Java 用户组而得到了现在的工作，这是我做过的最好的选择之一。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T04:47:20.397

我知道这里有 3 种不同类型的事件，用于本地用户组，​​每个用户组都有自己的拉力：

1) 演讲/演讲 - 有人进来并就某个主题进行一两个小时的演讲，以介绍或推进技术知识。因此，介绍依赖注入或 Windows 工作流就是几个例子。还有所谓的“深入研究”，其想法是真正深入主题，了解各种提示和技巧，并尝试改进我们所有人开发软件的方式。有时，微软会租用一天的电影院屏幕并进行一系列 4 场关于他们最新技术的演示，这将是另一个例子。这也可以包括敏捷项目领导网络之类的东西。

2)[代码营](http://torontocodecamp)——这些*太酷了*，我喜欢这些想法的一部分是人们自愿展示一些东西，而且工作不是罐装的。罐头我的意思是演示代码都准备好了，我们看不到代码变成那样需要多长时间，例如，十几个代码文件需要十几个小时才能从无到有到这种状态一个演示可能看起来应该在几个小时内就出来了，这是不现实的。在这里，他们在当地一所大学里租了几个房间来做这件事。[几年前一位博主的观点。](http://weblogs.asp.net/bsimser/archive/2006/05/28/Calgary-Code-Camp_2C00_-a-huge-success_2100_.aspx)

3)[开放空间](http://www.altnetconfcanada.com/home/index.castle)- 这是一个*很棒*的活动，我非常期待下一个活动。一堆其他开发人员聚集在一起，自组织地讨论我们想要的任何东西。讨论是多种多样的，在某些情况下结果不是很好，比如我们如何让其他人抽出时间来做这些事情，或者以其他方式来自愿提供我们在开源项目之外的技能。[第一天链接发生了什么。](http://weblogs.asp.net/bsimser/archive/2008/08/16/alt-net-canada-day-1-immersion.aspx)

最后两个中的每一个都发生在周末，因此不在工作时间。有时，看到新事物或做某事的更好方法的喜悦真的会很有意义，此外还有很好的交流机会，因为开放空间有一些人来自于出席的其他国家为事物增添了很好的多样性维度。

是否有其他本地用户组类型的事件？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T04:30:08.623

很多人真的有不同的理由参加，他们中的许多人否认了，但实际上只是为了食物和施瓦格（当然我开玩笑^_^）。但还有*一些*其他的事情让我感兴趣，特别是：

*   专业网络（如上所述 Eric）
*   能够找出我错过了什么（如果我不是因为我太忙而没有在 Google 阅读器上“从消防水龙带里喝水”）
*   参与证书（一些雇主使用 UG 参与作为积分）
*   简历上的布朗尼分数（如果你是演讲者，那就是）
*   食物和施瓦格（哎呀，已经提到过）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T05:17:51.257

我真的很喜欢结识像我一样对某个话题感到兴奋的人的想法；这是令人兴奋和鼓舞人心的。尤其是我住在中西部一个比较小的小镇，对计算机技术有共同兴趣的人不会很丰富，所以社交方面真的很吸引人

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T04:20:21.590

我同意埃里克。我也很高兴看到其他人如何处理问题以及他们有什么解决方案。原因是，如果您不是顾问，那么您将与同一组人一起工作，这有助于为团队带来新的想法。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-20T12:44:45.703

我参加当地的 JUG 会议已经有一段时间了，基于此，我想说：

*   网络，这对我很重要，因为我最近搬家了
*   组织活动本身可能很有趣
*   免费啤酒！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-17T12:12:32.790

有点不同的方法，但我可以告诉你是什么让我远离......我一直有兴趣去，但只是不要去他们中的任何一个。

*   他们中的大多数人似乎都在一个小时车程外的小镇上，就在下班后，所以我会错过会议的很大一部分。
*   难得在城里见面的人，似乎想在晚上在我白天都不想去的城镇的某个地方见面。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-17T12:20:53.850

因为我看到了像[这样](http://vimeo.com/1980031)很酷的东西（视频 - 带有嵌入式 RFID 标签的 RFID 锁舌。我的意思是嵌入式！）

当然，这是我为数不多的几个小组之一——我没有时间参加我想参加的每一个小组，但是这个小组混合了有趣的 Make、软件等，所以他们永远不会无聊.

尝试了解您的用户需要什么，并提供它是我能给出的最佳建议。只有你了解你的听众。

-亚当

# linux - Linux 是否为应用程序提供单调递增的时钟

> ID：211055
> 
> 赞同：11
> 
> 时间：2008-10-17T04:14:04.847
> 
> 标签：linux, unix, timer

Linux/Unix/Posix 是否为用户空间应用程序提供 API 以访问单调递增的时钟，精度为厘秒到毫秒？

在 Linux 上，/proc/uptime 提供基于字符串的浮点数表示系统已启动的秒数。

gettimeofday(2) 不提供单调递增的时钟。

我可以在 ITIMER_REAL 时域中使用 getitimer(2)，将计时器设置为在（取决于平台的）最大值开始并忽略生成的信号，但根据手册页，计时器可以运行的最长时间约为 100 天，其中比我预期的运行时间短。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-17T04:27:44.243

将 POSIX`clock_gettime()`函数与`CLOCK_MONOTONIC`. 有关详细信息，请参见[手册页](http://linux.die.net/man/3/clock_gettime)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T04:24:39.397

有clock_gettime：

```
struct timespec tp;
clock_gettime(CLOCK_MONOTONIC, &tp); 
```

# excel - 将每 n 行从一张纸复制到另一张纸

> ID：211062
> 
> 赞同：57
> 
> 时间：2008-10-17T04:18:15.837
> 
> 标签：excel

我有一个 1 列 700 行的 Excel 电子表格。我关心每七行。我不想进入并删除我关心的每一行之间的 6 行。所以我的解决方案是创建另一个工作表并指定对我想要的每个单元格的引用。

```
=sheet1!a1
=sheet1!a8
=sheet1!a15 
```

但是我不想输入这些公式中的每一个......`100次。我想如果我选择三个并拖动框，它会理解我想要做什么，但没有运气。

关于如何优雅/高效地做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2008-10-17T11:01:11.250

在新工作表的 A1 中，输入：

```
=OFFSET(Sheet1!$A$1,(ROW()-1)*7,0) 
```

...并复制下来。如果您从第 1 行以外的地方开始，请将 ROW() 更改为 ROW(A1) 或第 1 行上的其他单元格，然后再次向下复制。

如果要复制第 n 行但多列，请使用公式：

```
=OFFSET(Sheet1!A$1,(ROW()-1)*7,0) 
```

这也可以直接复制。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-17T14:23:00.673

如果我面临每 7 行提取一次，我会在“A”列之前“插入”一列。然后我会（假设第 1 行有标题行）在第 2、3、4、5、6、7、8 行中输入数字 1、2、3、4、5、6、7，我会突出显示 1,2,3,4,5,6,7 并将该块粘贴到工作表的末尾（价值 700 行）。结果将是 1,23,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7……。现在对列“A”进行数据升序排序。排序后，所有 1 将成为系列中的第一个，所有 7 将成为第七个项目。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-09-26T15:19:08.613

在我看来，这个问题的答案太具体了。这是使用两种不同方法和一个完整示例来尝试更一般的答案。

### `OFFSET`方法_

`OFFSET`需要 3 个强制参数。第一个是我们想要偏移的给定单元格。接下来的两个是我们想要偏移的行数和列数（向下和向右）。`OFFNET`返回这导致的单元格的内容。例如，`OFFSET(A1, 1, 2)`返回单元格的内容，`C2`因为`A1`是单元格`(1,1)`，如果我们添加`(1,2)`到其中，我们得到`(2,3)`对应于单元格的内容`C2`。

为了让它从另一列返回每第 n 行，我们可以使用该`ROW`函数。当这个函数没有参数时，它返回当前单元格的行号。因此，我们可以组合`OFFSET`并`ROW`创建一个函数，通过将乘数添加到由`ROW`. 例如`OFFSET(A$1,ROW()*3,0)`. 注意`$1`在目标单元格中​​的使用。如果不使用，则偏移量将从不同的单元格偏移，因此实际上增加`1`了乘数。

### `ADDRESS`+`INDIRECT`方法_

`ADDRESS`接受两个整数输入并将单元格的地址/名称作为字符串返回。例如，`ADDRESS(1,1)`返回`"$A$1"`。`INDIRECT`获取单元格的地址并返回内容。例如，`INDIRECT("A1")`返回单元格的内容`A1`（它也接受带有`$`'s 的输入）。如果我们将`ROW`inside`ADDRESS`与乘数一起使用，我们可以获得每个第 n 个单元格的地址。例如，`ADDRESS(ROW(), 1)`在第 1 行将返回`"$A$1"`，在第 2 行将返回`"$A$2"`，依此类推。所以，如果我们把它放在里面`INDIRECT`，我们可以得到每第 n 个单元格的内容。例如，`INDIRECT(ADDRESS(1*ROW()*3,1))`向下拖动时返回第一列中每个第三个单元格的内容。

### 例子

考虑以下电子表格的屏幕截图。标题（第一行）包含以下行中使用的调用。 [![在此处输入图像描述](https://i.stack.imgur.com/eyJuS.png)](https://i.stack.imgur.com/eyJuS.png) 列`A`包含我们的示例数据。在这种情况下，它只是正整数（计数在所示区域之外继续）。这些是我们希望每 3 个得到的值，即我们希望得到 1、4、7、10 等等。

列`B`包含使用该`OFFSET`方法的错误尝试，但我们忘记使用`$`. 可以看出，当我们乘以 时`3`，我们实际上每 4 行得到一次。

列包含使用我们记得使用但忘记减去`C`的方法的错误尝试。因此，虽然我们确实获得了每 3 个值，但我们跳过了一些值（1 和 4）。`OFFSET``$`

列`D`包含使用该`OFFSET`方法的正确函数。

列`E`包含使用`ADDRESS`+`INDRECT`方法的错误尝试，但我们忘记减去。因此，我们最初跳过了一些行。与 column 相同的问题`C`。

列`F`包含使用`ADDRESS`+`INDRECT`方法的正确函数。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-24T11:13:58.160

插入一个新列并将一个系列放入 1,2,3,4 等。然后创建另一个新列并使用命令 =if(int(a1/7)=(a1/7),1,0) 你应该每 7 行得到 1，过滤 1 上的列

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-12-19T20:37:55.653

突出显示第 7 行。将前 7 行的格式刷几次。然后做一大块画笔复制格式，直到你完成。每第 7 行应突出显示。按颜色过滤，然后从突出显示的单元格复制并粘贴（粘贴值）到新工作表中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-17T04:44:42.993

创建一个宏并使用以下代码获取数据并将其放入新工作表（Sheet2）中：

```
Dim strValue As String
Dim strCellNum As String
Dim x As String
x = 1

For i = 1 To 700 Step 7
    strCellNum = "A" & i
    strValue = Worksheets("Sheet1").Range(strCellNum).Value
    Debug.Print strValue
    Worksheets("Sheet2").Range("A" & x).Value = strValue
    x = x + 1
Next 
```

让我知道这是否有帮助！联合部队

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-30T01:53:20.703

如果您的原始数据采用多列的列形式，并且原始数据在 C42 中的第一个条目，并且您希望新的（下采样）数据也采用列形式，但仅每第七行，那么您将还需要减去第一个条目的行号，如下所示：

```
=OFFSET(C$42,(ROW(C42)-ROW(C$42))*7,0) 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-17T04:35:31.480

添加新列并用升序填充它。然后过滤 ([column] mod 7 = 0) 或类似的东西（我面前没有 Excel 来实际尝试这个）；

如果您无法按公式过滤，请再添加一列并在其中使用公式 =MOD([column; 7]) 然后过滤零，您将获得所有第七行。

# .net - 使用 svn 和 .NET Winforms - 构建安装文件会删除 _svn 文件夹

> ID：211071
> 
> 赞同：0
> 
> 时间：2008-10-17T04:22:39.603
> 
> 标签：.net, vb.net, svn, version-control

有谁知道如何在不删除/覆盖 _svn 文件夹的情况下构建安装项目？

我有一个 VB .NET 2005 Winform 应用程序，每次执行安装程序构建时，它都会删除/覆盖目录中的 _svn 文件夹。我怎样才能阻止这种情况发生？

任何和所有的帮助表示赞赏！

谢谢！联合部队

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T07:44:38.153

使用 Vis Studio 2005 我从来没有遇到过这个问题

您是否尝试过使用 .svn 文件夹而不是 _svn？

如果您使用的是 TortoiseSVN，则可以在设置中更改它。

# javascript - 如何限制工具提示/弹出式 DIV 的大小，使其不会触发页面上的滚动条

> ID：211074
> 
> 赞同：5
> 
> 时间：2008-10-17T04:24:17.150
> 
> 标签：javascript, html, css, dom

鼠标悬停在元素上并出现提示。提示溢出页面，触发滚动条，这会改变布局，使触发提示的底层元素不再位于鼠标指针下方，因此提示消失。

提示消失了，因此滚动条消失了，现在鼠标再次位于元素上方。

洗涤，冲洗，重复。

如果我可以确保提示不会太大以触发滚动条，那将解决我的问题。

编辑：阅读评论后，需要澄清一些事情： div 包含可以变化的文本。如果可以，我想显示所有文本。div 的位置需要靠近鼠标尖端所在的元素。所以关键是，我需要知道是否截断文本。

我确实找到了这个链接： http:
[//www.howtocreate.co.uk/tutorials/javascript/browserwindow](http://www.howtocreate.co.uk/tutorials/javascript/browserwindow)
包含这块拼图，弄清楚浏览器窗口有多大：

```
function alertSize() {
  var myWidth = 0, myHeight = 0;
  if( typeof( window.innerWidth ) == 'number' ) {
    //Non-IE
    myWidth = window.innerWidth;
    myHeight = window.innerHeight;
  } else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
    //IE 6+ in 'standards compliant mode'
    myWidth = document.documentElement.clientWidth;
    myHeight = document.documentElement.clientHeight;
  } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
    //IE 4 compatible
    myWidth = document.body.clientWidth;
    myHeight = document.body.clientHeight;
  }
  window.alert( 'Width = ' + myWidth );
  window.alert( 'Height = ' + myHeight );
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T04:25:49.690

**编辑**：响应评论，听起来你正试图让工具提示出现，而不影响现有元素的定位（从而导致主窗口上的滚动条）。

如果是这种情况，您希望将工具提示的位置定义为绝对位置，因为这会将其从元素流中移除（因此当它出现时不会将页面的其余部分向下推）。

例如，您可以隐藏它：

```
#tooltip {
  position: absolute;
  height: 100px;
  width: 200px;
  border: 1px solid #444444;
  background-color: #EEEEEE;
  display: none;
} 
```

然后，在你的鼠标悬停事件（或任何它被调用的事件）上，将 #tooltip 的`top`和`left`css 设置为你想要的任何位置，并将显示切换为`block`. 因为它是绝对定位的，所以不会引起闪烁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T04:29:53.333

CSS : 指定工具提示的`width`and `height`，添加`overflow: hidden`or`overflow: scroll`到它。

`position: absolute`也可以正常工作，但是当然，您必须指定工具提示的位置`top`和`left`位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T05:20:09.363

您可以使用位于 0,0 且宽度和高度设置为 100% 的隐藏 DIV 作为“标准”来测量屏幕的客户区域

如果您知道工具提示窗口的大小，则可以将其剪辑到客户端窗口，或更改显示位置以将其移动以使其保持在边界内

下面的一些代码（未经测试，从另一个项目中提取并重命名为内联）

```
var toolTipDiv; //this is your tooltip div element
//call AdjustToolTipPosition(window.event);
function AdjustToolTipPosition(e)
{
    var cpos = getPosition(e);
    mouseX = cpos.x;
    mouseY = cpos.y;

    //Depending on IE/Firefox, find out what 
    //object to use to find mouse position

    toolTipDiv.style.visibility = "visible";

    //backdrop 'yardstick' for client area measurement
    var backdropDiv = document.getElementById("divBackdrop");

    //make sure floating box doesn't leave the screen
    //we know box is 200x200 plus margins, say 215x215
    if ((cpos.y + 215) > backdropDiv.offsetHeight)
    {
        cpos.y = backdropDiv.offsetHeight - 215;
    }
    if ((cpos.x + 215) > backdropDiv.offsetWidth)
    {
        cpos.x = backdropDiv.offsetWidth - 215;
    }
    toolTipDiv.style.left = cpos.x + "px";
    toolTipDiv.style.top = cpos.y + "px";
}
//this function courtesy of 
//http://hartshorne.ca/2006/01/23/javascript_cursor_position/
function getPosition(e) 
{
    e = e || window.event;
    var cursor = {x:0, y:0};
    if (e.pageX || e.pageY) 
    {
        cursor.x = e.pageX;
        cursor.y = e.pageY;
    }
    else 
    {
        var de = document.documentElement;
        var b = document.body;
        cursor.x = e.clientX + 
            (de.scrollLeft || b.scrollLeft) - (de.clientLeft || 0);
        cursor.y = e.clientY + 
            (de.scrollTop || b.scrollTop) - (de.clientTop || 0);
    }
    return cursor;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-30T11:42:45.117

这是我最终使用的代码，它似乎正在工作。

```
function display_popup(s)
{ 

    var popup = document.getElementById("popup");
    popup.innerHTML = s

    //viewport_height = $(document).height()  doesn't work
    viewport_height = get_viewport_size()[1] // does this factor in scrollbar?

    mytop = $(current_element).offset().top + $(current_element).height() + 4
    scroll_offset_y = $(document).scrollTop()
    y_in_viewport = mytop - scroll_offset_y

    if (y_in_viewport < viewport_height) // are we even visible?
    {
        // Display the popup, but truncate it if it overflows   
        // to prevent scrollbar, which shifts element under mouse
        // which leads to flicker...

        popup.style.height= ""
        popup.style.display = "block";

        if (y_in_viewport + popup.offsetHeight > viewport_height)
        {
            overflow = (y_in_viewport + popup.offsetHeight) - viewport_height

            newh = popup.offsetHeight -  overflow
            newh -= 10 // not sure why i need the margin..

            if (newh > 0)
            {
                popup.style.height = newh 
            }
            else
            {
                popup.style.display = "none";
            }
        }
        popup.style.left = $(current_element).offset().left + 40
        popup.style.top = mytop
    }
}

function get_viewport_size()
{
  var myWidth = 0, myHeight = 0;

  if( typeof( window.innerWidth ) == 'number' )
  {
    //Non-IE
    myWidth = window.innerWidth;
    myHeight = window.innerHeight;
  }
  else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) )
  {
    //IE 6+ in 'standards compliant mode'
    myWidth = document.documentElement.clientWidth;
    myHeight = document.documentElement.clientHeight;
  }
  else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) )
  {
    //IE 4 compatible
    myWidth = document.body.clientWidth;
    myHeight = document.body.clientHeight;
  }

  return [myWidth, myHeight];
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T05:06:55.803

在我看来，您需要的是客户端浏览器窗口中的光标位置。然后，您可以进行计算以放置工具提示，使其不会越界。

我在网上找到的是一篇在不同浏览器中讨论这个问题的短文：[鼠标光标位置](http://javascript.about.com/library/blmousepos.htm)。也许这可以帮助您解决问题？

更多关于浏览器大小的信息可以在[这里](http://javascript.about.com/od/guidesscriptindex/a/screen.htm)找到。

希望能帮助到你。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T14:42:56.187

今年早些时候我遇到了同样的问题。我修复它的方式：

1.  我认为**垂直滚动是可以的**，但水平滚动不是。（总是有足够的空间，所以垂直滚动条不会影响我的布局）
2.  我固定了工具提示相对于目标的相对垂直位置。（工具提示的顶部总是在锚点底部下方 5px）
3.  工具提示的左侧是根据屏幕大小设置的。如果整个工具提示可以放在一行上，那就太酷了。否则，我限制了最大宽度并使其环绕。

帮助我实现它的一件事是 Quirksmode 的[Find Position](http://www.quirksmode.org/js/findpos.html)文章。

我的解决方案可能不是您正在寻找的，但至少看看 Quirksmode 链接，它很好。

希望有帮助！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T17:59:52.277

一个更好的想法可能是将工具提示放置在元素的左侧或右侧，具体取决于页面的哪一侧更近。我固定了工具提示的宽度，用内容填充它并在需要时使其可见，然后根据鼠标位置定位它。这是启用工具提示时 onmousemove 事件处理程序的关键部分：

```
if (!e) var e = window.event;
if(e) {
    var posx = 0;
    var posy = 0;

    if (e.pageX || e.pageY) {
        posx = e.pageX;
        posy = e.pageY;
    }
    else if (e.clientX || e.clientY) {
        posx = e.clientX + document.body.scrollLeft
            + document.documentElement.scrollLeft;
        posy = e.clientY + document.body.scrollTop
            + document.documentElement.scrollTop;
    }

    var overflowX = (document.body.clientWidth + document.body.scrollLeft + document.documentElement.scrollLeft) - (posx + 25+ tooltip.clientWidth);
    if(overflowX < 0) posx -= 25+ (tooltip.clientWidth);

    var overflowY = (document.body.clientHeight + document.body.scrollTop + document.documentElement.scrollTop) - (posy + 15+ tooltip.clientHeight);
    if(overflowY < 0) posy += overflowY;

    tooltip.style.left=(10+posx);
    tooltip.style.top=(10+posy);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-17T07:17:49.673

可以为您的整个页面/视口大小设置一个幽灵透明 DIV。然后你可以在其中“粘贴”一个工具提示 DIV，提供 CSS float:right 属性。这将为您提供正确的顶部/左侧工具提示角测量值，以进行最终工具提示渲染。

编辑：这应该只针对“边缘情况”的情况。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-17T13:39:50.103

您可以尝试确定指针的位置，如果它在视口的右侧 1/4（或您确定的任何区域），则将工具提示放在指针的左侧，否则将其放在右侧。

您提到文本可能会有所不同，但它可能会变得非常大吗？它会占据整个屏幕吗？最有可能的是，它会有一个最大尺寸，因此在决定使用什么阈值来决定尖端应该在右侧还是左侧时，请考虑到这一点。

然后，绝对定位您的tip div，并且为了安全起见，给它一个`max-height`and`max-width`属性。如果文本确实比这更大，`overflow: scroll`请在 CSS 中给出。

# asp.net - 在 windows server 2008 64bit 下运行 asp.net 1.1 应用程序

> ID：211076
> 
> 赞同：2
> 
> 时间：2008-10-17T04:24:33.080
> 
> 标签：asp.net, windows-server-2008, 64-bit, compatibility, .net-1.1

在 windows server 2008 64-bit web edition 下运行 asp.net 1.1 应用程序有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T05:10:19.337

我自己从未尝试过，但我确实找到了您可能会感兴趣的以下页面：

*   [这篇博客](http://blogs.iis.net/bills/archive/2008/06/02/installing-asp-net-1-1-with-iis7-on-vista-and-windows-2008.aspx)深入介绍了在 Windows Server 2008 上配置 ASP.NET 1.1。作者没有说它是 x86 还是 x64，所以我假设它是 x86。但无论哪种方式，看起来作者都必须跳过一些障碍才能正确设置 ISAPI 过滤器。

*   我还在 IIS7 论坛上发现[了这个线程](http://forums.iis.net/t/1150289.aspx)，其中有人讨论了 ASP.NET 1.1 的性能不佳。在 x64 Win2k8 上。因此，由于表现不佳，我认为它在某种程度上起作用。不幸的是，在作者提到的线程结束时遇到 500 个错误，然后讨论停止:-(

所以从我读过的内容来看，我猜这是可能的，但我也猜想，如果你能找到一些不涉及 II7 和 x64 的替代方案，你会少一些麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T09:55:21.507

.NET 1.1 只有 32 位，因此应用程序池必须以 32 位运行并使用经典管道。我没有尝试过自己，我会尽我所能不必在 2008 服务器上安装 .NET 1.1，但它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T07:17:36.693

我最近一直在 64 位 2008 上测试我们的应用程序。我们的应用程序是 .net 框架 3.5，但我们遇到了一些问题。

我们遇到的主要问题是第 3 方组件，例如不是为 64 位构建的 Aspose 字，并导致错误。不幸的是，您不尝试就不会知道..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-15T16:07:07.607

没问题。只需按照说明

[http://learn.iis.net/page.aspx/472/how-to-install-aspnet-11-with-iis7-on-vista-and-windows-2008/](http://learn.iis.net/page.aspx/472/how-to-install-aspnet-11-with-iis7-on-vista-and-windows-2008/)

通过单击计算机名称，可以在 IIS7 管理员上找到“CGI 限制”选项（最后一步）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T12:08:44.850

我很确定[http://learn.iis.net/page.aspx/472/how-to-install-aspnet-11-with-iis7-on-vista-and-windows-2008/](http://learn.iis.net/page.aspx/472/how-to-install-aspnet-11-with-iis7-on-vista-and-windows-2008/)上的文章是适用于 Windows Server 的非 R2 版本。

据我所知，ASP.NET 1.1 不能在 Windows 上运行（或者至少不能很好地运行）。

有一些创可贴解决方案，不同的人已经发布/博客，但这不受 Microsoft 支持。

# wpf - WPF 的免费 DayView 日历？

> ID：211081
> 
> 赞同：4
> 
> 时间：2008-10-17T04:29:34.317
> 
> 标签：wpf

是否有像这样的 WPF 的免费 DayView 日历？

[http://www.codeproject.com/KB/selection/Calendardayview.aspx](http://www.codeproject.com/KB/selection/Calendardayview.aspx)

提前致谢！来自阿根廷的欢呼！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T07:18:47.937

看看这些关于代码项目的文章

*   [使用 WPF 创建 Outlook 日历（第 1 部分）](http://www.codeproject.com/Articles/30329/Creating-an-Outlook-Calendar-using-WPF-Part-1)
*   [使用 WPF 创建 Outlook 日历（第 2 部分）](http://www.codeproject.com/Articles/30881/Creating-an-Outlook-Calendar-Using-WPF-Part-2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T15:51:11.210

日期选择器仍然是 WPF 用户的痛点。框架中还没有正式的标准日期选择器，而且绝对不是您正在寻找的东西。

也就是说，当然可以使用 ListView 或 DataGrid 来实现一些繁重的模板定制。如果您对起始方向感兴趣，请向我发表评论，如果您想走自制路线，我会更新我的答案。

# java - 如何允许我的 Java 小程序使用 MySQL？

> ID：211099
> 
> 赞同：3
> 
> 时间：2008-10-17T04:45:37.653
> 
> 标签：java, mysql, security, applet

[由于这个站点](https://stackoverflow.com/questions/138157/java-console-like-web-applet)，我最近将我的爱好 java 项目嵌入到一个页面中，但现在我遇到了一些安全问题。

我有包括：

```
import java.sql.*; 
```

和行：

```
Class.forName("com.mysql.jdbc.Driver").newInstance(); 
```

以及我的 src 目录中的一个 mysql .jar 文件，它可以从控制台运行，并且在小程序中可以从小程序正常工作 - 直到我的代码中的 forName() 行，它抛出异常：

```
    异常：com.mysql.jdbc.Driverjava.lang.ClassNotFoundException：com.mysql.jdbc.Driver
    java.security.AccessControlException：访问被拒绝（java.lang.RuntimePermission exitVM.-1）
    在 java.security.AccessControlContext.checkPermission（未知来源）
    在 java.security.AccessController.checkPermission（未知来源）
    在 java.lang.SecurityManager.checkPermission（未知来源）
    在 java.lang.SecurityManager.checkExit（未知来源）
    在 java.lang.Runtime.exit（未知来源）
    在 java.lang.System.exit（未知来源）
    在 applet.Database.connectDB(Database.java:80)
    ETC...

```

我想我可以用 client.policy 文件修复它，否则我可能需要编写一个抽象层，它使用服务器-客户端网络连接从服务器端查询......

我敢肯定这里的 Java 专家可能知道最好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T05:17:14.080

如果您尝试使用 applet 中的 JDBC 驱动程序，则 applet 需要使用证书进行签名，并且您的服务器需要在 applet 加载到客户端时交付此证书。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T17:01:07.530

我认为安全异常实际上来自您的小程序中的 System.exit() 调用，在 Class.forName() 之后。通常，您不允许在未签名的小程序中调用 System.exit()，因为它会关闭整个 JVM。您是否检查过第 80 行是否实际上是 Class.forName() 行，或者第 80 行是否有某种异常处理程序，如果驱动程序未加载，它会尝试调用 System.exit()？

无论如何，为了在您的小程序中加载 mysql jar 文件，您需要将其包含在 ARCHIVE 属性中，如下所示：

```
<APPLET ARCHIVE="mysql.jar" CODEBASE="./src/" ... 
```

一旦你过了这个阶段，你仍然需要将 mysql 服务器托管在与 web 服务器相同的 IP 号/主机名上，并向所有可以访问你的 applet 的人开放它。正如托尼所说，出于安全原因，这不是人们通常的做法。最好在服务器端写点东西，如果你可以控制应用服务器，并使用 XML 或其他一些数据交换方法将数据输出到小程序。当然，如果您只是在尝试学习小程序，那么它可能没问题 - 但如果可能，请注意将 mysql 放在防火墙后面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T06:38:06.053

执行此操作的公认方法是从加载小程序的服务器发出 HTTP 请求数据，并从服务器运行查询。JSON 或 XML 是在 applet 和服务器之间交换数据的好方法（类似于执行 AJAX 应用程序的方式，在浏览器和服务器之间发送 XML 或 JSON）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T17:13:13.887

正如其他答案之一（@Leigh Caldwell）中提到的，我*强烈*建议不要以这种方式做事。如果您的小程序可以访问 MySQL，那么世界上的其他人也可以访问 MySQL。如今，反编译是如此微不足道，以至于对于一个勤劳的黑客来说，只需片刻的工作就可以将 applet 凭证获取到数据库中。此外，MySQL 的用户/通行证身份验证相当薄弱，其大部分安全性是基于 IP 的。通过向世界开放它，你正在抛弃你的第一道顺从。

更好的方法是在服务器端构建某种前端协议（XMLRPC 将是一个很好的基础并且易于使用）。如果小程序绝对需要访问数据库，最好的选择是内存中的[HSQLDB](http://hsqldb.org/)。这不需要任何文件权限，并且可以完全在沙箱中运行。内存中的本地数据库可以根据需要使用前面提到的 XMLRPC 外观与服务器同步。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T05:10:38.337

尝试摆脱`newInstance()`部分。我认为只需`Class.forName()`加载驱动程序即可。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T17:11:08.350

异常告诉您applet 一直无法加载驱动程序类。您的小程序需要在运行时通过 HTTP 下载包含该类的 jar，因此您必须在网络服务器上提供该 jar（mysql.jar 或其他名称）。

一旦你解决了这个问题，用户将必须允许 applet 权限，以便它可以与 mysql db 服务器建立 TCP 套接字连接。他们将通过一个对话框提示...

# python - Python 的 __import__ 不能按预期工作

> ID：211100
> 
> 赞同：43
> 
> 时间：2008-10-17T04:46:08.980
> 
> 标签：python, python-import

当使用`__import__`带点的名称时，例如: `somepackage.somemodule`，返回的模块不是`somemodule`，返回的任何内容似乎大部分都是空的！这里发生了什么？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-10-17T04:46:20.680

来自 python 文档`__import__`：

> ```
> __import__( name[, globals[, locals[, fromlist[, level]]]]) 
> ```
> 
> ...
> 
> 当 name 变量的形式是 package.module 时，通常会返回顶级包（直到第一个点的名称），而不是按名称命名的模块。但是，当给定非空 fromlist 参数时，将返回按名称命名的模块。这样做是为了与为不同类型的 import 语句生成的字节码兼容；使用“import spam.ham.eggs”时，顶级包 spam 必须放在导入命名空间中，但使用“from spam.ham import eggs”时，必须使用 spam.ham 子包找到eggs 变量. 作为此行为的解决方法，请使用 getattr() 提取所需的组件。例如，您可以定义以下帮助程序：
> 
> ```
> def my_import(name):
>     mod = __import__(name)
>     components = name.split('.')
>     for comp in components[1:]:
>         mod = getattr(mod, comp)
>     return mod 
> ```

**转述：**

当您要求时`somepackage.somemodule`，`__import__`返回`somepackage.__init__.py`通常是空的。

`somemodule`如果您提供，它将返回`fromlist`（您想要的变量名称列表，`somemodule`实际上并未返回）

您也可以像我一样使用他们建议的功能。

注意：我问这个问题完全打算自己回答。我的代码中有一个大错误，并且误诊了它，我花了很长时间才弄明白，所以我想我会帮助 SO 社区并在这里发布我遇到的问题。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2011-02-28T06:08:46.463

python 2.7 有 importlib，虚线路径按预期解析

```
import importlib
foo = importlib.import_module('a.dotted.path')
instance = foo.SomeClass() 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2011-08-05T13:54:49.350

如文档中所述，有一个更简单的解决方案：

如果您只想按名称导入模块（可能在包中），您可以调用 __import__() 然后在 sys.modules 中查找它：

```
>>> import sys
>>> name = 'foo.bar.baz'
>>> __import__(name)
<module 'foo' from ...>
>>> baz = sys.modules[name]
>>> baz
<module 'foo.bar.baz' from ...> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-18T06:37:19.113

有些东西可以按您的意愿工作`twisted.python.reflect.namedAny`：

```
>>> from twisted.python.reflect import namedAny
>>> namedAny("operator.eq")
<built-in function eq>
>>> namedAny("pysqlite2.dbapi2.connect")
<built-in function connect>
>>> namedAny("os")
<module 'os' from '/usr/lib/python2.5/os.pyc'> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-30T17:07:40.503

对于 python 2.6，我写了这个片段：

```
def import_and_get_mod(str, parent_mod=None):
    """Attempts to import the supplied string as a module.
    Returns the module that was imported."""
    mods = str.split('.')
    child_mod_str = '.'.join(mods[1:])
    if parent_mod is None:
        if len(mods) > 1:
            #First time this function is called; import the module
            #__import__() will only return the top level module
            return import_and_get_mod(child_mod_str, __import__(str))
        else:
            return __import__(str)
    else:
        mod = getattr(parent_mod, mods[0])
        if len(mods) > 1:
            #We're not yet at the intended module; drill down
            return import_and_get_mod(child_mod_str, mod)
        else:
            return mod 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-19T11:11:58.347

我做的方式是

```
foo = __import__('foo',  globals(), locals(), ["bar"], -1)
foobar = eval("foo.bar") 
```

然后我可以访问任何内容

```
foobar.functionName() 
```

# jquery - jQuery.ScrollTo / jQuery.SerialScroll 水平滚动

> ID：211111
> 
> 赞同：4
> 
> 时间：2008-10-17T04:50:13.760
> 
> 标签：jquery, scrollto, serialscroll

我正在寻找使用[jQuery.SerialScroll](http://flesler.blogspot.com/2008/02/jqueryserialscroll.html)（基于[jQuery.ScrollTo](http://demos.flesler.com/jquery/scrollTo/)）实现水平滚动。

[正如我在这篇文章](https://stackoverflow.com/questions/41027/whats-a-good-bit-of-js-or-jquery-for-horizontally-scrolling-news-ticker)中讨论的那样，我目前正在使用 liScroll 进行连续水平滚动。

但是，现在我需要离散滚动，并且 SerialScroll 非常适合垂直滚动。

出于某种原因，如果将“axis”属性指定为“x”，则不会发生任何事情。

我什至无法获得[从右到左滚动的 SerialScroll 示例](http://flesler-plugins.googlecode.com/files/SerialScroll_right-to-left.js)。

我有这样的 HTML：

```
<div id="pane">
   <div>Item 1</div>
   <div>Item 2</div>
   <div>Item 3</div>
</div> 
```

我有这样的jQuery，当轴为'y'时有效

```
 jQuery(function($) {
      var $pane = $('#pane');
      $pane.serialScroll({
          items: 'div',
          next: $pane, // the container itself will get bound
          duration: 2100,
          force: true,
          axis: 'x',
          step: 1, //scroll 1 news each time
          event: 'showNext' //just a random event name
       });

       setInterval(function() {//scroll each 12 seconds
          $pane.trigger('showNext');
       }, 12000);
   }); 
```

有任何想法吗？

//编辑（接受答案）

对于那些出现的人，接受的答案消除了对“serialScroll”的需要（只需要scrollTo）。高度不是必需的。请务必将 $('scroller') 更改为 $('mywrap') 或 $(target.parent().parent()) 之类的内容。您还可以像这样设置自动滚动：

```
 var index = 2;

 setInterval(function() {//scroll each 5 seconds
 index = index > $('#news ul li').length ? 1 : index;
  sliderScroll($('#news ul li:nth-child(' + index + ')'));
  index ++;
 }, 5000); 
```

将#news ul li 替换为适当的选择器。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-18T01:12:13.887

我最近正在使用 scrollTo 来实现一个类似 Coda 的滑块向导。

这是我采取的步骤：

1.  将包含 div 设置为我希望滑块显示的尺寸。溢出：自动；有助于测试，但您可能希望最后使用溢出：隐藏。
2.  在那个地方另一个 div 里面，让它足够大，可以水平放置所有元素。
3.  浮动面板。给他们明确的维度。

我的 CSS：

```
.scroller{
  position: relative;
  overflow: hidden;
  height: 410px;
  width: 787px;}
  .modal-content{width: 3400px;}
    .modal-content div{float:left; width:728px; height: 405px; padding: 0 30px;} 
```

我的 JS：

```
function sliderScroll(target){
  if(target.length <1)return false;
  $(".current").removeClass("current");
  target.addClass("current");
  $(".scroller").scrollTo(target,500,{axis:'x'});
  return false;
} 
```

我的 HTML：

```
<div class="scroller">
  <div class="modal-content">
     <div>...</div>
     ...
  </div>
</div> 
```

# python - 如何使用 CouchDB 构建“标记”支持？

> ID：211118
> 
> 赞同：4
> 
> 时间：2008-10-17T04:57:22.887
> 
> 标签：python, couchdb, tagging, document-oriented-db

我正在使用以下视图函数来迭代数据库中的所有项目（以查找标签），但我认为如果数据集很大，性能会很差。还有其他方法吗？

```
def by_tag(tag):
return  '''
        function(doc) {
            if (doc.tags.length > 0) {
                for (var tag in doc.tags) {
                    if (doc.tags[tag] == "%s") {
                        emit(doc.published, doc)
                    }
                }
            }
        };
        ''' % tag 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T17:48:37.340

*免责声明：我没有对此进行测试，也不知道它是否可以表现得更好。*

创建单个烫发视图：

```
function(doc) {
  for (var tag in doc.tags) {
    emit([tag, doc.published], doc)
  }
}; 
```

并使用 _view/your_view/all?startkey=['your_tag_here']&endkey=['your_tag_here', {}] 查询

生成的 JSON 结构会略有不同，但您仍将获得发布日期排序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-19T15:34:37.657

You can define a single permanent view, as Bahadir suggests. when doing this sort of indexing, though, *don't* output the doc for each key. Instead, emit([tag, doc.published], null). In current release versions you'd then have to do a separate lookup for each doc, but SVN trunk now has support for specifying "include_docs=True" in the query string and CouchDB will automatically merge the docs into your view for you, without the space overhead.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T05:15:36.207

您的观点非常正确。一个想法列表：

视图生成是增量的。如果您的读取流量大于写入流量，那么您的视图根本不会引起问题。对此感到担忧的人通常不应该如此。参考框架，如果您在没有更新的情况下将数百条记录转储到视图中，您应该担心。

发出整个文档会减慢速度。您应该只发出使用视图所必需的内容。

不确定 val == "%s" 的性能是什么，但你不应该想太多。如果有标签数组，您应该发出标签。如果您期望一个包含非字符串的标签数组，那么请忽略它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-23T05:53:49.217

```
# Works on CouchDB 0.8.0
from couchdb import Server # http://code.google.com/p/couchdb-python/

byTag = """
function(doc) {
if (doc.type == 'post' && doc.tags) {
    doc.tags.forEach(function(tag) {
        emit(tag, doc);
    });
}
}
"""

def findPostsByTag(self, tag):
    server = Server("http://localhost:1234")
    db = server['my_table']
    return [row for row in db.query(byTag, key = tag)] 
```

The byTag map function returns the data with each unique tag in the "key", then each post with that tag in `value`, so when you grab key = "mytag", it will retrieve all posts with the tag "mytag".

I've tested it against about 10 entries and it seems to take about 0.0025 seconds per query, not sure how efficient it is with large data sets..

# .net - WCF 服务自定义配置

> ID：211122
> 
> 赞同：6
> 
> 时间：2008-10-17T04:59:10.793
> 
> 标签：.net, wcf, .net-3.5

在托管多个 WCF 服务的应用程序中，为每个服务添加自定义配置信息的最佳方式是什么？例如，您可能想要传递或设置公司名称或指定连接字符串服务或其他一些参数。

我猜这可能通过实现 IServiceBehavior 来实现。

即类似....

```
<behaviors>
  <serviceBehaviors>
    <behavior name="MyBehavior">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug />
      <customBehavior myCompany="ABC" />
    </behavior>
    <behavior name="MyOtherBehavior">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug />
      <customBehavior myCompany="DEF" />
    </behavior>
  </serviceBehaviors>
</behaviors>

<services>
  <service behaviorConfiguration="MyBehavior" name="MyNameSpace.MyService">
    <endpoint address="" behaviorConfiguration="" binding="netTcpBinding" 
      name="TcpEndpoint" contract="MyNameSpace.IMyService" />
    <endpoint address="mex" binding="mexTcpBinding" bindingConfiguration=""
      name="TcpMexEndpoint" contract="IMetadataExchange" />
    <host>
      <baseAddresses>
        <add baseAddress="net.tcp://localhost:4000/MyService" />
      </baseAddresses>
    </host>
  </service>
  <service behaviorConfiguration="MyOtherBehavior" name="MyNameSpace.MyOtherService">
    <endpoint address="" behaviorConfiguration="" binding="netTcpBinding" 
      name="TcpEndpoint" contract="MyNameSpace.IMyOtherService" />
    <endpoint address="mex" binding="mexTcpBinding" bindingConfiguration=""
      name="TcpMexEndpoint" contract="IMetadataExchange" />
    <host>
      <baseAddresses>
        <add baseAddress="net.tcp://localhost:4000/MyOtherService" />
      </baseAddresses>
    </host>
  </service>
</services> 
```

将在 MyService 上设置 ABC，在 MyOtherService 上设置 DEF（假设它们有一些带有公司名称的通用接口）。

谁能详细说明你是如何实现的？

TIA

迈克尔

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-06T15:44:24.163

我知道这是旧的，但它从未被标记为已回答，所以我想我会试一试。如果我了解您的需求，您可以使用自定义 ServiceHostFactory 来完成。
好帖子在[这里](http://blogs.msdn.com/dotnetinterop/archive/2008/09/22/custom-service-config-file-for-a-wcf-service-hosted-in-iis.aspx)。

您像这样设置您的自定义 ServiceHostFactory：

```
<%@ ServiceHost
 Language="C#"
 Debug="true"
 Service="Ionic.Samples.Webservices.Sep20.CustomConfigService"
 Factory="Ionic.ServiceModel.ServiceHostFactory"%> 
```

然后，在您的 ServiceHostFactory 中，您可以覆盖一个名为 ApplyConfiguration 的方法。通常对于托管在 IIS 中的 WCF 应用程序，WCF 会自动在 web.config 中查找配置。在此示例中，我们覆盖该行为以首先查找以 WCF 服务描述命名的配置文件。

```
protected override void ApplyConfiguration()
{
    // generate the name of the custom configFile, from the service name:
    string configFilename = System.IO.Path.Combine ( physicalPath,
        String.Format("{0}.config", this.Description.Name));

    if (string.IsNullOrEmpty(configFilename) || !System.IO.File.Exists(configFilename))
        base.ApplyConfiguration();
    else
        LoadConfigFromCustomLocation(configFilename);
} 
```

您可以将其替换为“任何内容” - 例如，在数据库表中查找配置。

还有一些方法可以完成这个难题。

```
private string _physicalPath = null;
private string physicalPath
{
    get
    {
        if (_physicalPath == null)
        {
            // if hosted in IIS
            _physicalPath = System.Web.Hosting.HostingEnvironment.ApplicationPhysicalPath;

            if (String.IsNullOrEmpty(_physicalPath))
            {
                // for hosting outside of IIS
                _physicalPath= System.IO.Directory.GetCurrentDirectory();
            }
        }
        return _physicalPath;
    }
}

private void LoadConfigFromCustomLocation(string configFilename)
{
    var filemap = new System.Configuration.ExeConfigurationFileMap();
    filemap.ExeConfigFilename = configFilename;
    System.Configuration.Configuration config =
        System.Configuration.ConfigurationManager.OpenMappedExeConfiguration
        (filemap,
         System.Configuration.ConfigurationUserLevel.None);
    var serviceModel = System.ServiceModel.Configuration.ServiceModelSectionGroup.GetSectionGroup(config);
    bool loaded= false;
    foreach (System.ServiceModel.Configuration.ServiceElement se in serviceModel.Services.Services)
    {
        if(!loaded)
            if (se.Name == this.Description.ConfigurationName)
            {
                base.LoadConfigurationSection(se);
                loaded= true;
            }
    }

    if (!loaded)
        throw new ArgumentException("ServiceElement doesn't exist");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-18T10:50:21.537

我遇到了类似的问题，但我使用的是 DuplexChannel。根据我发现的一篇[文章](http://www.mssoftwareconsulting.com/msswc/blog/post/Override-WCF-Client-Settings-From-Custom-Config-File.aspx)，我发现我以这种方式解决了：

```
public class CustomDuplexChannelFactory<TChannel> : DuplexChannelFactory<TChannel>
{
    public static string ConfigurationPath { get; set; }

    public CustomDuplexChannelFactory(InstanceContext callbackInstance)
        : base(callbackInstance)
    {
    }

    protected override ServiceEndpoint CreateDescription()
    {
        ServiceEndpoint serviceEndpoint = base.CreateDescription();

        if(ConfigurationPath == null || !File.Exists(ConfigurationPath))
            return base.CreateDescription();

        ExeConfigurationFileMap executionFileMap = new ExeConfigurationFileMap();
        executionFileMap.ExeConfigFilename = ConfigurationPath;
        System.Configuration.Configuration config = ConfigurationManager.OpenMappedExeConfiguration(executionFileMap, ConfigurationUserLevel.None);
        ServiceModelSectionGroup serviceModeGroup = ServiceModelSectionGroup.GetSectionGroup(config);
        ChannelEndpointElement selectedEndpoint = null;
        foreach(ChannelEndpointElement endpoint in serviceModeGroup.Client.Endpoints)
        {
            if(endpoint.Contract == serviceEndpoint.Contract.ConfigurationName)
            {
                selectedEndpoint = endpoint; break;
            }
        }
        if(selectedEndpoint != null)
        {
            if(serviceEndpoint.Binding == null)
            {
                serviceEndpoint.Binding = CreateBinding(selectedEndpoint.Binding, serviceModeGroup);
            } if(serviceEndpoint.Address == null)
            {
                serviceEndpoint.Address = new EndpointAddress(selectedEndpoint.Address,
                GetIdentity(selectedEndpoint.Identity), selectedEndpoint.Headers.Headers);
            } if(serviceEndpoint.Behaviors.Count == 0 && !String.IsNullOrEmpty(selectedEndpoint.BehaviorConfiguration))
            {
                AddBehaviors(selectedEndpoint.BehaviorConfiguration,
                    serviceEndpoint, serviceModeGroup);
            }
            serviceEndpoint.Name = selectedEndpoint.Contract;
        }
        return serviceEndpoint;
    }

    private Binding CreateBinding(string bindingName, ServiceModelSectionGroup group)
    {
        BindingCollectionElement bindingElementCollection = group.Bindings[bindingName];
        if(bindingElementCollection.ConfiguredBindings.Count > 0)
        {
            IBindingConfigurationElement be = bindingElementCollection.ConfiguredBindings[0];
            Binding binding = GetBinding(be); if(be != null)
            {
                be.ApplyConfiguration(binding);
            }
            return binding;
        }
        return null;
    }

    private void AddBehaviors(string behaviorConfiguration, ServiceEndpoint serviceEndpoint, ServiceModelSectionGroup group)
    {
        EndpointBehaviorElement behaviorElement = group.Behaviors.EndpointBehaviors[behaviorConfiguration];
        for(int i = 0; i < behaviorElement.Count; i++)
        {
            BehaviorExtensionElement behaviorExtension = behaviorElement[i];
            object extension = behaviorExtension.GetType().InvokeMember("CreateBehavior", BindingFlags.InvokeMethod | BindingFlags.NonPublic | BindingFlags.Instance, null, behaviorExtension, null);
            if(extension != null)
            {
                serviceEndpoint.Behaviors.Add((IEndpointBehavior)extension);
            }
        }
    }

    private EndpointIdentity GetIdentity(IdentityElement element)
    {
        EndpointIdentity identity = null;
        PropertyInformationCollection properties = element.ElementInformation.Properties;
        if(properties["userPrincipalName"].ValueOrigin != PropertyValueOrigin.Default)
        {
            return EndpointIdentity.CreateUpnIdentity(element.UserPrincipalName.Value);
        }
        if(properties["servicePrincipalName"].ValueOrigin != PropertyValueOrigin.Default)
        {
            return EndpointIdentity.CreateSpnIdentity(element.ServicePrincipalName.Value);
        }
        if(properties["dns"].ValueOrigin != PropertyValueOrigin.Default)
        {
            return EndpointIdentity.CreateDnsIdentity(element.Dns.Value);
        }
        if(properties["rsa"].ValueOrigin != PropertyValueOrigin.Default)
        {
            return EndpointIdentity.CreateRsaIdentity(element.Rsa.Value);
        }
        if(properties["certificate"].ValueOrigin != PropertyValueOrigin.Default)
        {
            X509Certificate2Collection supportingCertificates = new X509Certificate2Collection();
            supportingCertificates.Import(Convert.FromBase64String(element.Certificate.EncodedValue));

            if(supportingCertificates.Count == 0)
            {
                throw new InvalidOperationException("UnableToLoadCertificateIdentity");
            }

            X509Certificate2 primaryCertificate = supportingCertificates[0]; supportingCertificates.RemoveAt(0);
            return EndpointIdentity.CreateX509CertificateIdentity(primaryCertificate, supportingCertificates);
        }
        return identity;
    }

    private Binding GetBinding(IBindingConfigurationElement configurationElement)
    {
        if(configurationElement is CustomBindingElement)
            return new CustomBinding();
        else if(configurationElement is BasicHttpBindingElement)
            return new BasicHttpBinding();
        else if(configurationElement is NetMsmqBindingElement)
            return new NetMsmqBinding();
        else if(configurationElement is NetNamedPipeBindingElement)
            return new NetNamedPipeBinding();
        else if(configurationElement is NetPeerTcpBindingElement)
            return new NetPeerTcpBinding();
        else if(configurationElement is NetTcpBindingElement)
            return new NetTcpBinding();
        else if(configurationElement is WSDualHttpBindingElement)
            return new WSDualHttpBinding();
        else if(configurationElement is WSHttpBindingElement)
            return new WSHttpBinding();
        else if(configurationElement is WSFederationHttpBindingElement)
            return new WSFederationHttpBinding();
        return null;
    }
} 
```

我在我的[博客中总结了这一点](http://weblogs.asp.net/pabloretyk/archive/2010/01/17/override-wcf-client-settings-for-custom-config-file-using-duplexchannel.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T12:53:42.833

这在很大程度上取决于您希望在何处以及如何使用所述信息。如果它不会对基础设施做很多事情（即让服务运行和处理请求），我很想说尝试将其推入 WCF 行为可能会增加比其价值更多的复杂性。仅使用您自己的自定义配置部分可能会更简单。

您能否说明您希望在运行时如何使用这些信息？也许这样我们可以提供更明确的建议......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-19T23:50:08.763

好吧，我认为我给出的例子非常详尽。我将尝试进一步详细说明...

基本上，我希望能够将自定义配置数据传递给可能有多个 WCF 服务正在运行的应用程序中的 WCF 服务。

因此，这意味着在应用程序中运行的服务实例中，我想要访问专门为该服务（而不是其他服务）配置的数据。我想我可以简单地通过使用应用程序设置并使用服务的类型作为键来做到这一点。我希望 WCF 可以为此提供一些更好的构造。

# java - 无需用户名或密码即可连接到 Oracle

> ID：211133
> 
> 赞同：7
> 
> 时间：2008-10-17T05:05:06.460
> 
> 标签：java, oracle, jdbc, connection

Oracle 有这样一个概念，即允许数据库用户由运行连接到 Oracle 的程序的操作系统用户来识别。见[这里](http://www.oracle-base.com/articles/misc/OsAuthentication.php)。

这使您可以像 unix 机器上的用户那样执行以下命令：

```
sqlplus / 
```

我正在尝试为 Oracle 10.2 编写一个无需用户名或密码即可连接的 Java 程序。url的明显选择：

```
jdbc:oracle:thin:/@localhost:1521:MYDBSID 
```

不起作用，给出一个错误（对不起，我现在没有可用的错误）。

我也尝试了许多其他形式的这样做，但没有运气。

有人对我如何使用操作系统识别方法将 Java 程序连接到 Oracle 有任何建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T06:34:10.667

JDBC Thin 驱动程序是 100% 纯 Java 实现，无法从操作系统收集所需的信息。

JDBC OCI 驱动程序可以做到这一点！使用`jdbc:oracle:oci8:/@MYDBSID`，它将要求在该机器上安装 Oracle 驱动程序，如果这是一台服务器，则不是问题（并且启动速度更快，并且支持比瘦驱动程序更多的功能）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T05:44:45.710

oracle 提供的 jdbc 驱动程序无法从您提供的 URL 中收集操作系统用户名和密码。假设，有用于 ORACLE 的 3rd 方 JDBC 驱动程序提供程序，其中之一可能提供您所要求的功能。你应该到处谷歌。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-19T20:37:53.677

感谢那些回答。我们已经使用了 OCI 驱动程序。

我确实找到了表明 Oracle 11g**确实**支持通过瘦驱动程序进行操作系统用户身份验证的文档：

[http://www.orindasoft.com/public/Oracle_JDBC_JavaDoc/javadoc1110/oracle/jdbc/OracleConnection.html#CONNECTION_PROPERTY_THIN_VSESSION_OSUSER](http://www.orindasoft.com/public/Oracle_JDBC_JavaDoc/javadoc1110/oracle/jdbc/OracleConnection.html#CONNECTION_PROPERTY_THIN_VSESSION_OSUSER)

我没有 11g 设置来测试它，所以我不能确定它是否有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-17T21:44:31.693

在 11g 中添加了 JDBC 瘦驱动程序中的 OS 身份验证支持（您可以在 OTN 上从 11.2.0.4 下载 JDBC 瘦驱动程序）。

请注意，您必须允许服务器上的远程操作系统身份验证（通过 TCP），否则它只能在本地使用 IPC 或 BEQ 与 sqlplus 一起使用。在您的 init.ora 文件中，添加以下内容：

```
REMOTE_OS_AUTHENT = TRUE 
```

然后，如果您的用户是客户端计算机上的“osuserdemo”，请创建一个这样的数据库用户并重新启动数据库：

```
 CREATE USER OSUSERDEMO IDENTIFIED EXTERNALLY;
 GRANT CONNECT,CREATE SESSION,RESOURCE TO OSUSERDEMO; 
```

并且 JDBC 瘦驱动程序应该能够在没有任何用户名或密码的情况下进行连接。

值得注意的是，此功能 - 被认为是高度不安全的 - 在 12c 中已被取消支持。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T06:50:45.857

如果您从 J2EE 应用服务器访问 Oracle，则可以通过使用 JNDI 获取数据源来达到类似的目的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-04T19:01:43.493

11g 瘦驱动程序可以使用 Kerberos 身份验证进行连接。

请参阅[使用 Kerberos 连接到 Oracle 数据库](http://www.rgagnon.com/javadetails/java-oracle-jdbc-connect-with-kerberos.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-12-14T06:04:16.147

尝试以下 jdbc:oracle:thin:username/password@localhost:1521:MYDBSID

您需要指定帐户信息

sqlplus / as sysdba 在通过操作系统认证的 unix 机器上

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-06-17T13:35:12.363

`jdbc:oracle:oci:@`适用于 ojdbc6.jar 和 Oracle 11g2

# asp.net - 如何使用 jQuery 插入 围绕可变数量的子元素？

> ID：211137
> 
> 赞同：3
> 
> 时间：2008-10-17T05:08:59.277
> 
> 标签：asp.net, jquery, css, forms

我有类似于以下的 ASP.Net 代码（这是在 FIELDSET 中）：

```
<ol>
    <li>
        <label>Some label</label>
        <one or more form controls, ASP.Net controls, labels, etc.>
    </li>
    <li>
        <label>Another label</label>
        <... more of the same...>
    </li>
    ...
</ol> 
```

我试图让我的标记尽可能地干净，但我决定由于各种原因，我需要在第一个标签之后的列表项中的所有内容周围包裹一个 DIV，如下所示：

```
<ol>
    <li>
        <label>Some label</label>
        <div class="GroupThese">
           <one or more form controls, ASP.Net controls, labels, etc.>
        </div>
    </li>
    <li>
        <label>Another label</label>
        <div class="GroupThese">
            <... more of the same...>
        </div>
    </li>
    ...
</ol> 
```

我宁愿通过 jQuery 使用“不显眼的 Javascript”来做到这一点，而不是在我的页面上乱扔额外的标记，这样我就可以保持表单在语义上“干净”。

我知道如何编写一个 jQuery 选择器来获取每个列表项 $("li+label") 中的第一个标签或使用 :first-child。我也知道如何在选择后插入东西。

我无法弄清楚（至少在深夜）是如何找到列表项中第一个标签之后的所有内容（或者基本上除了第一个标签之外的列表项中的所有内容都是另一种放置方式）和在文档就绪函数中围绕它包装一个 DIV。

**更新：**

一旦我从周围删除单引号，欧文的代码就起作用了：

```
$('这个')
```

并设置正确的后代选择器：

```
$("li label:first-child")
```

为了只选择列表项之后出现的第一个标签。

这是我所做的：

```
$(document).ready(function() {

    $('li label:first-child').each(function() {
        $(this).siblings().wrapAll('<div class="GroupThese"></div>');
    });
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T05:27:40.067

**编辑**：更正的代码（有关更多信息，请参阅修订历史和评论中的旧代码）

好的，这应该工作：

```
$('li label:first-child').each(function() {
    $(this).siblings().wrapAll('<div class="li-non-label-child-wrapper">');
}); 
```

从：

```
<li>
    <label>Some label</label>
    <div>stuff</div>
    <div>other stuff</div>
</li>
<li>
    <label>Another label</label>
    <div>stuff3</div>
</li> 
```

产生：

```
<li>
    <label>Some label</label>
    <div class="li-non-label-child-wrapper">
      <div>stuff</div>
      <div>other stuff</div>
    </div>
</li>
<li>
    <label>Another label</label>
    <div class="li-non-label-child-wrapper">
      <div>stuff3</div>
    </div>
</li> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T05:19:58.473

一种方法是将所有内容包装在 <li> 中，然后将标签移出，例如

```
var $div = $('li').wrapInner('<div></div>').children('div');
$div.children('label').prependTo($div.parent()); 
```

# c# - SQL Server 2005 - 主键更改时在两个数据库之间移动数据的最佳方式

> ID：211142
> 
> 赞同：1
> 
> 时间：2008-10-17T05:12:36.883
> 
> 标签：c#, database, sql-server-2005, data-migration

我知道这应该是 db 101，但它对我来说并没有那么清晰。我正在使用 SQL2005 express，我想将数据从数据库 A 复制到数据库 B。DatabaseB 已经包含现有数据 - 它甚至可能包含 pk 已更改或不存在的数据 - 例如：

数据库 A pk1 = 桃子 pk2 = 苹果

数据库 B pk1 = 桃子 pk2 = 橙子 pk3 = 苹果

现在 A 和 B 都有与 pk 相关的相关表。

从历史上看，我会编写一个从 A 中选择数据并通过其插入/更新过程（使用 .NET）将其复制到 B 的应用程序，但是这非常麻烦，尽管有一些优点是我可以有一个允许您选择的下拉列表A 复制 - 如果 B 存在则复制到，或者说添加新的 - 例如：

（下拉 - 选择来源）桃苹果

（下拉 - 选择目标）-新-桃子橙子苹果

我打算使用 SSIS，但目标数据库只有 SQL Express，所以这不可用，我也没有时间学习它（我过去经常使用 dts，但不是这个较新的工具）。在 SQL2000 中，我只会使用 DTS，但现在使用更复杂的架构，我什至不确定我是否会相信它。

有什么建议还是我应该继续编写我的自定义应用程序来将数据从 A 迁移到 B？

我期待着大家的建议——我很想继续走一条我认为是最好的方法的道路:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T16:21:03.117

如果服务器在同一网络上，请添加链接服务器（在网上交易 sql 书籍中查找）。然后，您可以跨两台服务器运行查询。

SQL Server 2005 Express 很糟糕，它不包含 SSIS。但是，您也可以使用 BCP（批量复制，也可以在在线交易 sql 书籍中查找）将数据复制到目标服务器上的不同表中。它可能在您的路径中，因此您可以从 dos 键入 bcp /? 获取选项列表。一旦数据位于目标服务器上的表中，您就可以对其运行查询。

您确实需要在键之间创建映射。我不知道你是如何从桃子/苹果中得到桃子/橙子/苹果的。毫无疑问，有一些业务逻辑。一旦您链接服务器或在一台服务器上获取数据。您可以使用业务逻辑将旧主键映射到新键。或者你手动填写的映射表（oldkey, newkey）或（oldkey1, oldkey2, newkey1, newkey2, newkey3）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T15:53:43.890

sql 2008 有一个有趣的功能，称为更改数据捕获，这可能对您来说很有趣 [http://blog.benhall.me.uk/2007/06/sql-server-2008-change-data-capture-cdc.html](http://blog.benhall.me.uk/2007/06/sql-server-2008-change-data-capture-cdc.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T18:39:39.827

您可能会查看合并复制 - [http://msdn.microsoft.com/en-us/library/ms165713(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms165713(SQL.90).aspx)

它总是单向推动吗？A->B？

作为说明，如果你能获得 SSIS，你应该花一点时间来学习它。它比 DTS 恕我直言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T17:15:19.590

不太熟悉 SQL Server Express 的局限性，但你能备份吗？然后作为另一个数据库导入？

# java - Java 枚举定义

> ID：211143
> 
> 赞同：171
> 
> 时间：2008-10-17T05:14:15.960
> 
> 标签：java, generics, enums, crtp

我以为我非常了解 Java 泛型，但后来我在 java.lang.Enum 中遇到了以下内容：

```
class Enum<E extends Enum<E>> 
```

有人可以解释如何解释这个类型参数吗？提供可以使用类似类型参数的其他示例的奖励积分。

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2008-10-17T05:30:53.680

这意味着枚举的类型参数必须从本身具有相同类型参数的枚举派生。这怎么可能发生？通过使类型参数成为新类型本身。因此，如果我有一个名为 StatusCode 的枚举，它将相当于：

```
public class StatusCode extends Enum<StatusCode> 
```

现在，如果您检查约束，我们得到了`Enum<StatusCode>`-so `E=StatusCode`。让我们检查一下：`E`extend`Enum<StatusCode>`吗？是的！我们没事。

您可能会问自己这样做的意义何在 :) 好吧，这意味着 Enum 的 API 可以引用自身 - 例如，能够说`Enum<E>`implements `Comparable<E>`。基类能够进行比较（在枚举的情况下），但它可以确保它只比较正确类型的枚举。（编辑：嗯，几乎 - 见底部的编辑。）

我在我的 ProtocolBuffers 的 C# 端口中使用了类似的东西。有“消息”（不可变）和“构建器”（可变的，用于构建消息）——它们以成对的类型出现。涉及的接口有：

```
public interface IBuilder<TMessage, TBuilder>
  where TMessage : IMessage<TMessage, TBuilder> 
  where TBuilder : IBuilder<TMessage, TBuilder>

public interface IMessage<TMessage, TBuilder>
  where TMessage : IMessage<TMessage, TBuilder> 
  where TBuilder : IBuilder<TMessage, TBuilder> 
```

这意味着您可以从消息中获得适当的构建器（例如，获取消息的副本并更改一些位），并且在构建完成后您可以从构建器中获得适当的消息。虽然 API 的用户并不需要真正关心这一点，但这是一项很好的工作 - 它非常复杂，并且需要多次迭代才能到达它的位置。

编辑：请注意，这不会阻止您创建使用类型参数的奇怪类型，该类型参数本身是可以的，但不是同一类型。*目的是在正确*的情况下给予好处，而不是在*错误*的情况下保护您。

因此，如果`Enum`无论如何都没有在 Java 中“特别”处理，您可以（如注释中所述）创建以下类型：

```
public class First extends Enum<First> {}
public class Second extends Enum<First> {} 
```

`Second` would implement `Comparable<First>` rather than `Comparable<Second>`... but `First` itself would be fine.

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-04-17T00:31:29.497

The following is a modified version of the explanation from the book *Java Generics and Collections*: We have an `Enum` declared

```
enum Season { WINTER, SPRING, SUMMER, FALL } 
```

which will be expanded to a class

```
final class Season extends ... 
```

where `...` is to be the somehow-parameterised base class for Enums. Let's work out what that has to be. Well, one of the requirements for `Season` is that it should implement `Comparable<Season>`. So we're going to need

```
Season extends ... implements Comparable<Season> 
```

What could you use for `...` that would allow this to work? Given that it has to be a parameterisation of `Enum`, the only choice is `Enum<Season>`, so that you can have:

```
Season extends Enum<Season>
Enum<Season> implements Comparable<Season> 
```

So `Enum` is parameterised on types like `Season`. Abstract from `Season` and you get that the parameter of `Enum` is any type that satisfies

```
 E extends Enum<E> 
```

* * *

Maurice Naftalin (co-author, Java Generics and Collections)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-11-27T22:04:07.523

This can be illustrated by a simple example and a technique which can be used to implement chained method calls for sub-classes. In an example below `setName` returns a `Node` so chaining won't work for the `City`:

```
class Node {
    String name;

    Node setName(String name) {
        this.name = name;
        return this;
    }
}

class City extends Node {
    int square;

    City setSquare(int square) {
        this.square = square;
        return this;
    }
}

public static void main(String[] args) {
    City city = new City()
        .setName("LA")
        .setSquare(100);    // won't compile, setName() returns Node
} 
```

So we could reference a sub-class in a generic declaration, so that the `City` now returns the correct type:

```
abstract class Node<SELF extends Node<SELF>>{
    String name;

    SELF setName(String name) {
        this.name = name;
        return self();
    }

    protected abstract SELF self();
}

class City extends Node<City> {
    int square;

    City setSquare(int square) {
        this.square = square;
        return self();
    }

    @Override
    protected City self() {
        return this;
    }

    public static void main(String[] args) {
       City city = new City()
            .setName("LA")
            .setSquare(100);                 // ok!
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T05:32:45.967

You are not the only one wondering what that means; see [Chaotic Java blog](http://chaoticjava.com/posts/class-enume-extends-enume/).

“If a class extends this class, it should pass a parameter E. The parameter E’s bounds are for a class which extends this class with the same parameter E”.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-13T18:52:04.857

This post has totally clarified to me these problem of 'recursive generic types'. I just wanted to add another case where this particular structure is necessary.

Suppose you have generic nodes in a generic graph:

```
public abstract class Node<T extends Node<T>>
{
    public void addNeighbor(T);

    public void addNeighbors(Collection<? extends T> nodes);

    public Collection<T> getNeighbor();
} 
```

Then you can have graphs of specialized types:

```
public class City extends Node<City>
{
    public void addNeighbor(City){...}

    public void addNeighbors(Collection<? extends City> nodes){...}

    public Collection<City> getNeighbor(){...}
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-06-05T13:34:21.813

If you look at the `Enum` source code, it has the following:

```
public abstract class Enum<E extends Enum<E>>
        implements Comparable<E>, Serializable {

    public final int compareTo(E o) {
        Enum<?> other = (Enum<?>)o;
        Enum<E> self = this;
        if (self.getClass() != other.getClass() && // optimization
            self.getDeclaringClass() != other.getDeclaringClass())
            throw new ClassCastException();
        return self.ordinal - other.ordinal;
    }

    @SuppressWarnings("unchecked")
    public final Class<E> getDeclaringClass() {
        Class<?> clazz = getClass();
        Class<?> zuper = clazz.getSuperclass();
        return (zuper == Enum.class) ? (Class<E>)clazz : (Class<E>)zuper;
    }

    public static <T extends Enum<T>> T valueOf(Class<T> enumType,
                                                String name) {
        T result = enumType.enumConstantDirectory().get(name);
        if (result != null)
            return result;
        if (name == null)
            throw new NullPointerException("Name is null");
        throw new IllegalArgumentException(
            "No enum constant " + enumType.getCanonicalName() + "." + name);
    } 
} 
```

First thing first, what does `E extends Enum<E>` mean? It means the type parameter is something that extends from Enum, and isn't parametrized with a raw type (it's parametrized by itself).

This is relevant if you have an enum

```
public enum MyEnum {
    THING1,
    THING2;
} 
```

which, if I know correctly, is translated to

```
public final class MyEnum extends Enum<MyEnum> {
    public static final MyEnum THING1 = new MyEnum();
    public static final MyEnum THING2 = new MyEnum();
} 
```

So this means that MyEnum receives the following methods:

```
public final int compareTo(MyEnum o) {
    Enum<?> other = (Enum<?>)o;
    Enum<MyEnum> self = this;
    if (self.getClass() != other.getClass() && // optimization
        self.getDeclaringClass() != other.getDeclaringClass())
        throw new ClassCastException();
    return self.ordinal - other.ordinal;
} 
```

And even more importantly,

```
 @SuppressWarnings("unchecked")
    public final Class<MyEnum> getDeclaringClass() {
        Class<?> clazz = getClass();
        Class<?> zuper = clazz.getSuperclass();
        return (zuper == Enum.class) ? (Class<MyEnum>)clazz : (Class<MyEnum>)zuper;
    } 
```

This makes `getDeclaringClass()` cast to the proper `Class<T>` object.

A way clearer example is the one that I answered on [this question](https://stackoverflow.com/questions/30616864/how-to-make-type-safety-with-generics/30616937#30616937) where you cannot avoid this construct if you want to specify a generic bound.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-17T06:42:26.263

According to wikipedia, this pattern is called [Curiously recurring template pattern](https://en.wikipedia.org/wiki/Curiously_recurring_template_pattern). Basically, by using the CRTP pattern, we can easily refer to subclass type without type casting, which means by using the pattern, we can imitate virtual function.

# sql-server-2005 - 使用 InstallShield 安装 SqlServer 2005 Express 并创建唯一的命名实例

> ID：211145
> 
> 赞同：0
> 
> 时间：2008-10-17T05:16:03.803
> 
> 标签：sql-server-2005, installshield

我正在使用 Installshield 2008 express 创建安装包。我的应用程序依赖于 Sql Server 2005 express edition。我知道我可以检查可再发行选项卡下的“microsoft sql server 2005 express”先决条件。但是，这将安装完全留在最终用户手中，如果他/她一直选择默认设置，我们最终会使用命名实例 SqlExpress 进行安装。至少，我希望安装以 MyCompany 命名实例作为默认值。

我该如何做到这一点？

我必须升级到更强大的 installshield 版本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T12:40:29.797

如果快速添加支持安装脚本，您可以使用以下代码。您需要在安装中的某处包含 Sql Express redist

LaunchAppAndWait(SRCDIR+"\SQLEXPR32.EXE", "INSTANCENAME="+ instName +" SECURITYMODE=SQL" + "DISABLENETWORKPROTOCOLS=0 SQLAUTOSTART=1 ADDLOCAL=SQL_Data_Files SAPWD=" + sapass /qb" , LAAW_OPTION_WAIT);

在上面的代码中，instName 是实例的名称。如果您仅使用 Windows 身份验证，则可以省略安全和密码选项。

检查 MSDN 文档以获取其他命令行选项

我确信这可以移植到 VB，甚至可以使用其中一种内置的 MSI 动作类型

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-18T03:57:09.297

我没有使用 InstallShield Express。InstallShield Professional 允许您定义传递给 SQL Server 安装的命令行。这允许您定义实例名称以及其他参数，例如“安静”模式。

# c - 我可以在 Palm OS 应用程序中使用标准 C 库吗？

> ID：211149
> 
> 赞同：1
> 
> 时间：2008-10-17T05:19:49.770
> 
> 标签：c, palm-os, garnet-os

Palm OS 应用程序的已发布代码不包括标准头文件，而是使用 Palm OS API 来处理诸如 StrCopy 和 MemMove 之类的事情。我可以使用标准头文件和函数还是需要转换我的代码才能使用 Palm OS 版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T06:35:28.853

从程序大小的角度来看，最好尽可能使用 Palm OS API，因为这意味着您不必将库中的代码包含在生成的“可执行文件”中。如果您使用编译器提供的库中的函数，则该函数的代码将添加到您的每个程序中，从而增加它们的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T05:25:34.500

这取决于编译器和您使用的工具版本。一般来说，如果您可以使用 Palm OS API，您可能会在该平台上工作得更好，但 CodeWarrior 和 prc-tools 都实现了一些库函数。

在 Palm OS V9 的 CW 中，有一个相当完整的 Metrowerks 标准库 (MSL) 版本。大多数 MSL C++ 都可以让您访问 STL 和其他结构。在 C 前端，您已经获得了大多数用于内存管理和字符串函数的标准 C 头文件。但是，它忽略了语言环境、数学、信号和标准 I/O 的实现。

要使用该库，您需要确保链接到 MSL C/C++ 库。这可以在您在向导中创建项目时进行设置，或者稍后通过修改访问路径并为您的目标添加适当的静态库来添加。

# python - 矩阵的 Python 逆

> ID：211160
> 
> 赞同：62
> 
> 时间：2008-10-17T05:30:49.997
> 
> 标签：python, algorithm, matrix, linear-algebra, matrix-inverse

如何在python中获得矩阵的逆？我自己实现了它，但它是纯 python，我怀疑有更快的模块可以做到这一点。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2008-10-17T05:41:42.067

如果您进行矩阵操作，您应该看看[numpy 。](http://www.scipy.org/Tentative_NumPy_Tutorial)这是一个主要用C语言编写的模块，比纯python编程要快得多。这是一个如何反转矩阵以及进行其他矩阵操作的示例。

```
from numpy import matrix
from numpy import linalg
A = matrix( [[1,2,3],[11,12,13],[21,22,23]]) # Creates a matrix.
x = matrix( [[1],[2],[3]] )                  # Creates a matrix (like a column vector).
y = matrix( [[1,2,3]] )                      # Creates a matrix (like a row vector).
print A.T                                    # Transpose of A.
print A*x                                    # Matrix multiplication of A and x.
print A.I                                    # Inverse of A.
print linalg.solve(A, x)     # Solve the linear equation system. 
```

您还可以查看[数组](https://docs.python.org/3.4/library/array.html)模块，当您只需要处理一种数据类型时，它是一种更有效的列表实现。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2008-10-18T20:12:27.827

确保您确实需要反转矩阵。这通常是不必要的，并且可能在数值上不稳定。当大多数人问如何对矩阵求逆时，他们真的很想知道如何求解 Ax = b，其中 A 是矩阵，x 和 b 是向量。使用直接为 x 求解方程 Ax = b 的代码比计算 A 逆然后将逆乘以 B 更有效和更准确。即使您需要为许多 b 值求解 Ax = b，这也不是一个好主意反转 A。如果您必须求解多个 b 值的系统，请保存 A 的 Cholesky 分解，但不要反转它。

请参阅[不要反转该矩阵](http://www.johndcook.com/blog/2010/01/19/dont-invert-that-matrix/)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-06-27T21:19:14.100

遗憾的是，这里再次重复的所选矩阵要么是奇异的，要么是条件差的：

```
A = matrix( [[1,2,3],[11,12,13],[21,22,23]]) 
```

根据定义，A 的逆矩阵乘以矩阵 A 本身必须给出一个单位矩阵。在广受赞誉的解释中选择的 A 并没有做到这一点。事实上，只看倒数就可以看出倒数不能正常工作。看看各个项的大小 - 与原始 A 矩阵的项相比，它们非常非常大......

值得注意的是，人类在选择矩阵示例时经常设法选择奇异矩阵！

我确实对解决方案有疑问，所以进一步研究了它。在ubuntu-kubuntu平台上，debian包numpy没有matrix和linalg子包，所以除了导入numpy，还需要导入scipy。

如果 A 的对角项乘以一个足够大的因子，比如 2，则矩阵很可能不再是奇异的或接近奇异的。所以

```
A = matrix( [[2,2,3],[11,24,13],[21,22,46]]) 
```

变得既不是单数也不是近乎单数，并且该示例给出了有意义的结果...在处理浮点数时，必须注意不可避免的舍入错误的影响。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-07-16T18:06:17.593

对于像我这样正在寻找没有`pandas`或`numpy`参与的纯 Python 解决方案的人，请查看以下 GitHub 项目：[https](https://github.com/ThomIves/MatrixInverse) ://github.com/ThomIves/MatrixInverse 。

它慷慨地提供了一个很好的解释，解释了这个过程是如何“在幕后”的。作者很好地描述了分步方法并提供了一些实际示例，所有这些都易于理解。

这只是那里的一个小代码片段，非常简要地说明了该方法（`AM`是源矩阵，`IM`是相同大小的单位矩阵）：

```
def invert_matrix(AM, IM):
    for fd in range(len(AM)):
        fdScaler = 1.0 / AM[fd][fd]
        for j in range(len(AM)):
            AM[fd][j] *= fdScaler
            IM[fd][j] *= fdScaler
        for i in list(range(len(AM)))[0:fd] + list(range(len(AM)))[fd+1:]:
            crScaler = AM[i][fd]
            for j in range(len(AM)):
                AM[i][j] = AM[i][j] - crScaler * AM[fd][j]
                IM[i][j] = IM[i][j] - crScaler * IM[fd][j]
    return IM 
```

**但是请务必遵循整件事，您将学到更多，而不仅仅是复制粘贴此代码！**顺便说一句，还有一个 Jupyter 笔记本。

希望对某人有所帮助，我个人发现它对于我无法使用任何非标准包的非常特殊的任务（[吸收马尔可夫链）非常有用。](https://en.wikipedia.org/wiki/Absorbing_Markov_chain)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-03T07:46:49.733

您可以计算递归矩阵的行列式，然后形成邻接矩阵

[这是一个简短的教程](http://www.easycalculation.com/matrix/inverse-matrix-tutorial.php)

我认为这只适用于方阵

计算这些的另一种方法涉及gram-schmidt正交化然后转置矩阵，正交化矩阵的转置是它的逆矩阵！

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-01-14T23:49:57.923

Numpy 会适合大多数人，但你也可以[在 Sympy 中做矩阵](http://docs.sympy.org/latest/tutorial/matrices.html)

尝试在[http://live.sympy.org/运行这些命令](http://live.sympy.org/)

```
M = Matrix([[1, 3], [-2, 3]])
M
M**-1 
```

为了好玩，试试`M**(1/2)`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-17T20:25:42.873

如果您讨厌 numpy，请取出 RPy 和您的本地 R 副本，并改用它。

（我也会回应让你真的需要反转矩阵。例如，在 R 中，linalg.solve 和 solve() 函数实际上并没有完全反转，因为它是不必要的。）

# sql-server-2005 - 如何获取列上存在的统计信息（如果有）？

> ID：211166
> 
> 赞同：3
> 
> 时间：2008-10-17T05:33:26.730
> 
> 标签：sql-server-2005, tsql, statistics

如果表中的特定列有统计信息，我想检查 Transact SQL，如果有，则全部获取。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T05:35:15.073

这个查询应该这样做。
我在浏览数据库以查找统计信息的存储过程中使用它。
适用于 SQL Server 2005 和可能的旧版本。

```
SELECT S.NAME
FROM   SYS.OBJECTS AS O
       INNER JOIN SYS.STATS AS S
         ON O.OBJECT_ID = S.OBJECT_ID
       INNER JOIN SYS.STATS_COLUMNS AS SC
         ON SC.OBJECT_ID = S.OBJECT_ID
            AND S.STATS_ID = SC.STATS_ID
WHERE  (O.OBJECT_ID = OBJECT_ID('MyTable','local'))
       AND (O.TYPE IN ('U'))
       AND (INDEXPROPERTY(S.OBJECT_ID,S.NAME,'IsStatistics') = 1)  /* only stats */
       AND (COL_NAME(SC.OBJECT_ID,SC.COLUMN_ID) = 'MyColumn') 
```

# c# - CNG、CryptoServiceProvider 和 HashAlgorithm 的托管实现

> ID：211169
> 
> 赞同：24
> 
> 时间：2008-10-17T05:39:40.213
> 
> 标签：c#, .net, security, hash, cryptography

所以我想知道哈希算法的各种实现之间是否有任何重大差异，以SHA系列算法为例。它们每个都有 3 个实现，1 个在托管代码中，2 个围绕不同的本机加密 API 进行包装，但是使用它们之间有什么主要区别吗？我可以想象包装器版本可以具有更高的性能，因为它是在本机代码中执行的，但是 surley 嘿都需要执行完全相同的计算并因此提供相同的输出，即它们是可互换的。它是否正确？

例如 SHA512CNG 不能在 XP SP2 上使用（文档错误），但 SHA512MANAGED 可以。

* * *

@Maxim - 谢谢，但不是我所要求的。我在问使用给定哈希算法的 Managed/CryptoServiceProvider/CNG 实现是否有任何区别，除了可能的性能。使用 .NET 3.5，您可以获得具有三种实现的所有哈希算法，所以

SHA512Managed SHA512CryptoServiceProvider SHA512Cng

后两者是原生 API 的包装器。例如，所有 SHAxxx 实现都是如此。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-12T21:03:22.947

一个区别是本机版本（至少其中一些）经过 FIPS 认证（即，由美国政府批准），而托管版本则不是。如果您的代码恰好在已配置为“仅 FIPS”的 Windows 计算机上运行，​​则尝试使用托管版本将失败。

大多数 Windows 机器不是以这种方式配置的，但如果您要部署到政府或国防（或其他高度安全）环境，您可能会遇到这种情况。

请参阅[http://blogs.msdn.com/shawnfa/archive/2005/05/16/417975.aspx](http://blogs.msdn.com/shawnfa/archive/2005/05/16/417975.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-16T21:48:21.780

Cng 版本应该会快一点，但我只是写了一个小程序来比较每个版本的速度。（我有一个客户询问 MD5 与 SHA1 的性能特征）

我很惊讶地发现 MD5 和 SHA1 之间几乎没有区别，但也很惊讶 Cng 和 CryptoServiceProvider 之间存在细微差别。

The source is pretty straight forward, I added reps to do the same iteration multiple times so I could average in case there was any weirdness going on, on my machine during one of the runs.

call the following with a call like this:

```
CalculateHash(1, 1024, new SHA1CryptoServiceProvider());

static long CalculateHash(UInt64 repetitions, UInt64 size, HashAlgorithm engine)
    {
        RandomNumberGenerator rng = RandomNumberGenerator.Create();

        byte[][] goo = new byte[repetitions][];
        for (UInt64 i = 0; i < repetitions; i++)
        {
            goo[i] = new byte[size];
            rng.GetBytes(goo[i]);
        }

        DateTime start = DateTime.Now;
        for (UInt64 i = 0; i < repetitions; i++)
        {
            engine.ComputeHash(goo[i]);
        }
        return DateTime.Now.Subtract(start).Ticks;
    } 
```

I ran this in a loop of increasing size to figure out if one fell over when using large or small inputs. Here is the loop, and the data follows (my computer ran out of ram at 2^28):

```
int loops = 32;
        UInt64 reps = 1;

        int width = 20;
        Console.WriteLine("Loop#".PadRight(6) +
                "MD5".PadRight(width) +
                "SHA1".PadRight(width) +
                "SHA1Cng".PadRight(width) +
                "SHA256".PadRight(width) +
                "SHA256Cng".PadRight(width));

        for (int i = 0; i < loops; i++)
        {
            UInt64 size = (UInt64)Math.Pow((double)2, (double)i);

            Console.WriteLine((i + 1).ToString().PadRight(6) +
                CalculateHash(reps, size, new MD5CryptoServiceProvider()).ToString().PadRight(width) +
                CalculateHash(reps, size, new SHA1CryptoServiceProvider()).ToString().PadRight(width) +
                CalculateHash(reps, size, new SHA1Cng() ).ToString().PadRight(width) +
                CalculateHash(reps, size, new SHA256CryptoServiceProvider()).ToString().PadRight(width) +
                CalculateHash(reps, size, new SHA256Cng()).ToString().PadRight(width));
        }

Loop# MD5         SHA1        SHA1Cng     SHA256      SHA256Cng
1     50210       0           0           0           0
2     0           0           0           0           0
3     0           0           0           0           0
4     0           0           0           0           0
5     0           0           0           0           0
6     0           0           0           0           0
7     0           0           0           0           0
8     0           0           0           0           0
9     0           0           0           0           0
10    0           0           10042       0           0
11    0           0           0           0           0
12    0           0           0           0           0
13    0           0           0           0           0
14    0           0           0           0           0
15    10042       0           0           10042       10042
16    10042       0           0           0           0
17    0           0           0           10042       10042
18    0           10042       10042       20084       10042
19    0           10042       10042       30126       40168
20    20084       20084       20084       70294       70294
21    30126       40168       40168       140588      140588
22    60252       70294       80336       291218      281176
23    120504      140588      180756      572394      612562
24    241008      281176      361512      1144788     1215082
25    482016      572394      723024      2289576     2420122
26    953990      1134746     1456090     4538984     4830202
27    1907980     2259450     2982474     9118136     9660404
28    3805918     4508858     5804276     18336692    19581900 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-21T11:18:51.677

I did a quick and dirty comparison between `CNG` and `managed` on SHA512 which is the slowest of all SHA algorithms AFAIK using the code below.

```
 static void Main(string[] args)
    {
      int loops = 10000000;
      var data = Encoding.ASCII.GetBytes("123");

      var hashLoop = new Action<HashAlgorithm>((HashAlgorithm ha) =>
      {
        for (int i = 0; i < loops; i++)
          ha.ComputeHash(data);
      });

      var t1 = Task.Factory.StartNew(() =>
      {
        Time(hashLoop, new SHA512Managed());
      });
      var t2 = Task.Factory.StartNew(() =>
      {
        Time(hashLoop, new SHA512Cng());
      });

      Task.WaitAll(t1, t2);
      Console.WriteLine("Benchmark done!");
      Console.ReadKey();
    }
    static void Time(Action<HashAlgorithm> action, HashAlgorithm ha)
    {
      var sw = new Stopwatch();
      sw.Start();
      action(ha);
      sw.Stop();
      Console.WriteLine("{1} done in {0}ms", sw.ElapsedMilliseconds, ha.ToString());
    } 
```

After several runs I found that the difference was that CNG was considerably faster than managed version of the algorithm with about `21.7% to 49.5%`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-08-29T10:08:03.913

Another difference between the Managed and the CNG versions is the supported .Net Framework version: e.g.

*   the AES Managed version starts from 3.5, while the CNG from 4.6.2 and for
*   SHA512, [Managed](https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.sha512managed?view=netframework-4.7.2#applies-to) starts from 1.1 and [Cng](https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.sha512cng?view=netframework-4.7.2#applies-to) from 3.5.

However, I believe that if we are not constrained by the framework version or to support legacy OS versions, we should use the **CNG versions**:

*   The hashing algorithms postfixed with Cng are the only ones that use **bcrypt**
*   The fact that it might take longer is actually an advantage as it protects from brute force attacks: on the user side 300ms or 3ms makes no difference, while for an attacker it is an order 100 magnitude!

# .net - 关于在 WinForms 应用程序中使用 Firebird.NET 的文章

> ID：211171
> 
> 赞同：0
> 
> 时间：2008-10-17T05:40:14.627
> 
> 标签：.net, firebird

谁能给我一个链接到关于使用 Firebird.NET 和 WinForms 应用程序的好文章？一个简单的谷歌搜索并没有产生好的结果——我正在寻找一个分步指南，它可以帮助我快速完成一些事情，但我不确定文档是一个很好的起点。

提前致谢。阿宁迪亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T23:01:24.577

我的大部分链接都有些过时了，但我认为其中大部分仍然适用：

[http://firebirdsql.org/firebirdtutorial/index.html](http://firebirdsql.org/firebirdtutorial/index.html) [http://codemuch.com/?q=book/export/html/6](http://codemuch.com/?q=book/export/html/6) （我不能保证这个，它有很多代码 - 至于质量，好吧，看看）

# java - 使用代理时从 ClassLoader 看不到接口？

> ID：211176
> 
> 赞同：15
> 
> 时间：2008-10-17T05:43:55.510
> 
> 标签：java, dynamic, proxy

当我尝试使用动态代理时，我看到以下异常

```
 com.intellij.rt.execution.application.AppMain DynamicProxy.DynamicProxy
Exception in thread "main" java.lang.IllegalArgumentException: interface Interfaces.IPerson is not visible from class loader
    at java.lang.reflect.Proxy.getProxyClass(Proxy.java:353)
    at java.lang.reflect.Proxy.newProxyInstance(Proxy.java:581)
    at DynamicProxy.Creator.getProxy(Creator.java:18)
    at DynamicProxy.DynamicProxy.main(DynamicProxy.java:54)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 
```

知道我需要做什么来解决它

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-14T13:31:15.807

如果这是 Web 应用程序，那么您应该在创建动态代理时使用 Web 应用程序类加载器。因此，例如，而不是：

```
Proxy.newProxyInstance(
  ClassLoader.getSystemClassLoader(),
  new Class < ? >[] {MyInterface.class},
  new InvocationHandler() {
    // (...)
}); 
```

尝试：

```
Proxy.newProxyInstance(
  this.getClass().getClassLoader(), // here is the trick
  new Class < ? >[] {MyInterface.class},
  new InvocationHandler() {
    // (...)
}); 
```

例如，tomcat 类加载器的层次结构（其他 web 容器也有类似的）如下：

```
 Bootstrap
          |
       System
          |
       Common
       /     \
  Webapp1   Webapp2 ... 
```

它是 webapp 类加载器，其中包含 Web 应用程序的 /WEB-INF/classes 目录中的类和资源，以及 Web 应用程序的 /WEB-INF/lib 目录下的 JAR 文件中的类和资源。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T06:31:00.780

当您`DynamicProxy`尝试执行`Class.forName(youInterfaceClass.getName())`生成的`java.lang.Class`实例与创建代理时传递的实例不同时。换句话说，您有两个具有相同名称的类对象，并且代理不确定哪一个是正确的（无论它们是否相同）。

通常，当您尝试代理的接口位于通过两个不同的类加载器（即 Tomcat 的“通用”和“应用程序”）加载的库中时，就会发生这种情况。

如果这没有帮助，请在您的应用程序上发布更多信息 - 特别是如果您使用任何应用程序服务器、Spring 或 OSGi。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-25T12:11:07.937

我在使用 spring boot 时遇到了同样的问题，我通过注入 ResourceLoader 来解决它，获取它的类加载器。

```
@Autowired
private ResourceLoader resourceLoader;

....
ClassLoader classLoader = resourceLoader.getClassLoader();
...

Proxy.newProxyInstance(
  classLoader, //for example...
  new Class < ? >[] {MyInterface.class},
  new InvocationHandler() {
  // (...)
}); 
```

# ruby-on-rails - Selenium：wait_for_* 和 Selenium RC ruby 驱动程序中的朋友

> ID：211181
> 
> 赞同：2
> 
> 时间：2008-10-17T05:47:49.090
> 
> 标签：ruby-on-rails, ruby, unit-testing, selenium, integration-testing

是否有所有漂亮的[Selenium on Rails](http://selenium-on-rails.openqa.org)方法的实现`wait_for_visible`，例如 Selenium RC`assert_not_text_present`的**ruby​​ 驱动程序**？

如果没有，我将如何实施诸如 wait_for_visible 之类的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T10:07:55.023

我解决了我自己的问题。

[我在Git Hub 存储库](http://github.com/ph7/selenium-client/tree/master)中找到了官方的 ruby​​ 客户端

我编写了这个解决方案，所以你可以只`require`使用这段代码，然后你就可以使用所有有用的`wait_for_*, assert_*, assert_not_*, wait_for_not_*, verify_*, and verify_not_*`命令。

```
#need this for starts_with? and camelize
require 'activesupport'
module Selenium
  module Client
    class Driver
      def method_missing(method, *args)
        method_prefixes = %w(wait_for wait_for_not assert_ assert_not verify verify_not store)
        method_name = method.to_s

        prefix = method_prefixes.find {|pre| method_name.starts_with?(pre)}

        #if the method starts with a prefix, camelize the name.
        if(prefix)
          string_command method_name.camelize(:lower), *args
        else
          super *args
        end
      end
    end
  end
end 
```

# https - 使用多部分请求失败问题上传文件

> ID：211182
> 
> 赞同：1
> 
> 时间：2008-10-17T05:48:09.400
> 
> 标签：https, multipartform-data

HTTPS Multipart 文件上传请求是批处理吗？也就是说，如果我有99个文件，如果上传95个文件后上传失败，那会回滚整个集合吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T06:03:46.717

如果您使用普通的 HTTP(S) POST 请求，我会假设整个集合都已回滚，因为所有上传都在同一个 HTTP 请求中发布。但是，您可以使用 JavaScript/AJAX 在每个文件的单个请求中单独上传文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T06:24:17.893

这取决于服务器上发生的情况。如果您有一个包含 99 个文件的多部分请求，并且在读取流时，您保存了每个文件，那么第 95 个文件的失败将意味着前 94 个文件将被处理并保存。如果需要回滚，通常必须自己实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-26T16:07:37.333

如果您有 95 个文件，则必须逐个上传。因为如果我们假设每个文件大小为 1 MB。这将是一个 95MB 的请求。为了最大程度地执行成功操作，我们应该多次点击Apis，以避免出现TimeOut Error、Stream too large error等几个错误。

# asp.net - 将 AJAX 回调与 ASP.NET 用户控件一起使用

> ID：211184
> 
> 赞同：4
> 
> 时间：2008-10-17T05:50:57.820
> 
> 标签：asp.net, jquery, ajax

实现需要 AJAX 回调的用户控件的最佳方式是什么？

我想完成几件事：

*   在浏览器中完成事件（例如，拖放）会触发 AJAX 通知，该通知可以引发控件事件，这会导致页面上使用控件的代码执行它需要执行的任何操作（例如，更改数据库中的值） .
*   进行部分更新（不使用更新面板），可以执行诸如在文本框下方填充自动完成下拉列表之类的操作。
*   实现一个足够通用的用户控件，可以在多个页面上重复使用
*   避免必须在页面本身上实现将事件传递回控件的逻辑，因为这是重复的且难以维护

我对大多数客户端的东西都使用 jQuery，但对于实际的 AJAX 调用，我并不关心它是 jQuery 还是 ASP AJAX 库。

实际上，完美的是用户控件上的 PageMethods，它可以很容易地从客户端脚本调用。不幸的是，据我所知，pagemethods 不适用于用户控件。

* * *

我将使用自动完成控件作为示例：

我应该能够将自动完成控件放在页面上，然后在页面代码中，例如：

```
Public Sub HandleLookup(ByVal input As String, ByRef list As List(Of String) Handles MyControl.LookupEntries
  list = New List(Of String)
  ' Query database for list of items.. 
  For Each item as String in FullItemList
    If item.StartsWith(input) then list.Add(item)
  Next
  Return list
End Sub 
```

并且什么也不做......其余的代码应该在用户控件中。

* * *

请注意，我尝试制作的控件比自动完成更具体。它们不存在于任何 3rd 方库中，我真的需要自己制作它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T12:28:49.420

研究在您的页面中实现 ICallbackEventHandler ——这是一种从 JavaScript 回调页面函数的简单方法。

这是一个很好的教程：

[http://www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=119](http://www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=119)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T09:30:44.753

您可能想签出；[Ra-Ajax UserControl 示例](http://ra-ajax.org/samples/Combining.aspx)并将该知识与[Ra-Ajax 拖放相结合](http://ra-ajax.org/samples/Behaviors.aspx)

单击左侧的“显示代码”C# 图标，查看代码的用法...

# c# - 检查应用程序是否已安装

> ID：211192
> 
> 赞同：4
> 
> 时间：2008-10-17T05:58:01.550
> 
> 标签：c#

我想检查一个应用程序是否已经通过启动条件安装。如果是，我想退出安装程序，如果没有，安装应该继续。有人能告诉如何在 c# 安装程序中实现这一点吗？

问候， 苛刻的苏曼

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-17T09:51:02.030

我不确定如何专门使用 C# 执行此操作，但在使用[Nullsoft 安装程序](http://nsis.sourceforge.net)时，这是我见过的方法：在安装之前，检查在安装期间创建的注册表项。

卸载程序显示在“添加/删除程序”控制面板中。卸载程序列表存储在 HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall 下。如果安装程序注册了卸载程序，则卸载程序的密钥是安装程序检查的好密钥，因为：

1.  假设正在为所有用户安装程序，则测试的密钥必须在 HKey 本地计算机 (HKLM) 下，而不是特定于当前用户 (HKey Current User) 的密钥。卸载程序的密钥在 HKLM 下

2.  有时需要并排安装同一程序的多个版本。卸载程序密钥应特定于每个版本，因此可以添加规则来检查安装程序的版本号与已安装的版本。

检查注册表项以判断是否安装了程序有一个限制：如果手动从 Program Files 中删除程序（不使用卸载程序），重新安装将失败。为避免此问题，在找到卸载程序注册表项后，安装程序可以检查卸载程序是否仍然存在。如果是这样，则可以安全地假设该程序仍已安装。

在使用安装程序和条件安装时，值得记住的是，有时重新安装对于清理问题很有用。被迫通过（麻烦的）卸载才能重新安装可能很乏味。

有关卸载注册表项的更多详细信息，请参阅[NSIS 关于添加/删除程序的页面。](http://nsis.sourceforge.net/Add_uninstall_information_to_Add/Remove_Programs)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T06:15:00.797

在安装时在注册表中添加一个条目。如果在安装程序运行时，该条目存在，那么程序已经安装（或者您的用户已经入侵了注册表以使安装程序认为它已经安装）。如果不是，那么您还没有安装它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T16:34:32.667

如果您不想在注册表中添加任何内容（由于管理员权限或类似原因），您只需检查您安装的文件夹或文件是否存在。是的，这假设您每次都安装到同一个文件夹，但这是一个选项。

# .net - ASP.net 自定义服务器控件中 CSS 类的设计时间属性

> ID：211193
> 
> 赞同：1
> 
> 时间：2008-10-17T05:58:15.433
> 
> 标签：.net, asp.net, custom-controls, custom-server-controls

希望一些自定义控件设计器/构建器可以提供帮助

我正在尝试构建我的第一个自定义控件，它是客户详细信息收集表单必不可少的。此表单将有一系列元素，需要对其应用各种样式。理想情况下，我希望 VS 2005/2008 属性界面能够像在控制级别那样应用 CSSClass，即使用可用 CSS Classes 的下拉列表。

以应用于图例标签的类为例

```
/// <summary>Css Class for Legend</summary>
[Category("Appearance")]
[Browsable(true)]
[DefaultValue("")]
//I am at a loss as to what goes in [Editor]
[Editor(System.Web.UI.CssStyleCollection), typeof(System.Drawing.Design.UITypeEditor))]        
 public string LegendCSSClass
    {
        get { return _LegendCSSClass; }
        set { _LegendCSSClass = value; }
    } 
```

从上面可以看出，我尝试了几个选项，但运气不佳。

希望我缺少一些简单的东西。

我也很乐意提供与

```
[Editor]
```

属性

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T11:27:04.117

将 CssClassProperty 属性添加到您的属性。

```
[Category("Appearance")]
[Browsable(true)]
[DefaultValue("")]
[CssClassProperty]
public string LegendCSSClass    
{        
   get { return _LegendCSSClass; }        
   set { _LegendCSSClass = value; }    
} 
```

[来自 MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.cssclasspropertyattribute.aspx)：在设计时向属性添加级联样式表 (CSS) 编辑功能。

顺便说一句，对于此类问题，Lutz Reflector 是您的朋友。您可以查看应用于 .NET Framework 类中的类似属性的特性。

# sql - 通过 SQL 进行股票交易系统计算

> ID：211195
> 
> 赞同：2
> 
> 时间：2008-10-17T06:00:42.650
> 
> 标签：sql, database-design

需要根据数据库中的交易计算股票市场投资组合。我希望通过 SQL 进行的计算是平均价格、回报率、投资组合价值等。

样本数据：

```
股票 股价 价值
100 50 5000
一个 -20 60 -1200
50 40 2000

```

我无法用 SQL 做到这一点，所以我想我可能需要编写输出脚本，所以那里的任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T06:20:39.053

请注意，当前价格是硬编码的 (38)，因为它没有提供，它需要在另一个表中提供，该表将连接到 stock 表，但原理是相同的。

```
create table stocks (stock varchar2(10),shares number, price number);
insert into stocks values('A', 100, 50);
insert into stocks values('A', -20, 60);
insert into stocks values('A', 50, 40);

select stock, sum(shares) number_of_shares, round(sum(shares*price)/sum(shares),2) average_price,
    sum(shares*price) amount_paid,   sum(shares*38) value,   
    round((sum(shares*38)-sum(shares*price))/sum(shares*price)*100,2)||'%' rate_of_return
from stocks
group by stock

STOCK NUMBER_OF_SHARES AVERAGE_PRICE AMOUNT_PAID VALUE RETURN                    
A                  130         44.62        5800  4940 -14.83% 
```

# svn - 将 Sharepoint 站点置于版本控制之下

> ID：211196
> 
> 赞同：2
> 
> 时间：2008-10-17T06:01:22.790
> 
> 标签：svn, sharepoint, version-control, moss

使用 Mircosoft Office Sharepoint Server 2007（标准版）将正在开发的网站集置于版本控制之下的最佳方式是什么？我们正在为所有其他（非共享点）项目使用 Subversion，但我只是不确定如何处理 MOSS。

需要将哪些内容置于版本控制之下以确保我们拥有重建 Sharepoint 环境所需的一切？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T13:51:20.153

源代码控制不仅仅是备份，源代码控制也不一定是备份解决方案。这一切都是为了能够对文本文件进行差异化、协作开发、分支和合并。

如果目标是灾难恢复，那么获取一个空服务器并开始枚举您必须用来重建服务器及其内容的所有位。使用差异备份等备份这些位。

如果目标是为代码工件启用协作开发、分支和合并、n 级撤消，那么请仔细检查哪些代码工件是二进制的，哪些是文本的。您不会从将二进制工件放入 subversion 中获得太多好处，因为您将无法合并或获取差异。

同样在 sharepoint 的情况下，您在导入模板后对网站所做的任何修改都将难以版本化，因为这些位以某种隐藏的专有格式存储在内置 sql server 中。并非您的 sharepoint 解决方案的所有组件都将位于 subversion 真正作为源代码控制工具大放异彩的文件系统上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T07:13:56.920

问题有点模糊，你没有提到你是如何开发它的。如果您只是通过共享点中可用的界面对网站集进行开箱即用的修改，那么听起来您需要进行某种“备份”。我认为您不能将网站集导出为模板：P

如果您正在进行实际开发、进行站点配置的编码功能、为此的 Web 部件、自定义页面布局等等，我建议您在 Visual Studio 的共享点上复制 /12/ 配置单元中的结构。将您拥有的所有工件放在解决方案中的正确文件夹中，这使得部署变得非常容易，只需复制和调用一些 stsadm 命令或创建一个新的 manifest.xml 文件和一个 .ddf 文件，然后您可以添加到您的共享点安装上的解决方案存储库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T08:20:34.273

添加到 mortenbpost，为了将站点结构存储在源代码管理中，您需要在代码中创建它。例如，一个功能接收器创建网站集，因为它在激活功能时首先应该存在。

没有办法从 MOSS 中获取站点结构并将其置于源代码管理中。当网站上线时，用户将添加您无论如何都不需要在源代码管理中的内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-05T04:28:09.907

建立在上面所说的基础上：

*   为您的环境提供详细的构建文档，解释所有机器及其软件的配置
*   网络拓扑信息和负载平衡器配置（随着您的场中机器和 NIC 数量的增加，这变得更加重要
*   SharePoint 的脚本安装和配置（您是否注意到在初始配置向导完成后，您需要做很多事情才能启动 SP 环境）
*   最后，将您的站点开发为 SharePoint 工件（例如功能、WebPart 等），并将它们与将它们添加到环境所需的所有构建脚本和安装脚本一起置于源代码控制之下。使用 UI 来构建您的站点作为您的探索和开发是很好的，但没有什么比使用脚本从头开始重建环境的外部工件更好的了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-04T13:21:22.557

### 团队基础服务器？

您要问的是您能否对整个 SharePoint 网站集进行版本控制？

我知道您可以轻松做到这一点的唯一方法可能是使用 Team Foundation Server [http://msdn.microsoft.com/en-us/library/cc948982.aspx](http://msdn.microsoft.com/en-us/library/cc948982.aspx)

他们声称您可以对自定义 SharePoint 产品进行版本控制，我假设他们也指的是其中的数据库部分。我认为这将是最适合未来的路线。

* * *

### 我们当前使用 SharePoint 进行版本控制

目前我们在工作中所做的是，我们有一个 Subversion 服务器，当我们开发自定义 Web 部件和可能包含许多工作流和 Web 部件的解决方案时，我们在其中使用了一个[名为 AnkSVn 的 Visual Studio 插件。](http://ankhsvn.open.collab.net/)

我们目前没有对 SharePoint 的内容数据库进行任何版本控制，尽管我很想尝试 TFS，看看这是否可行。作为开发人员，我们使用[stsadm 工具](http://technet.microsoft.com/en-us/library/cc261956.aspx)在进行重大更改之前备份开发服务器，并且我们的 DBA 定期备份 SharePoint 数据库。

根据我的经验，恢复内容数据库将恢复 SharePoint 网站集的所有以前的内容、工作流、网站、模板、功能。

# haskell - Haskell 的隐藏特性

> ID：211216
> 
> 赞同：32
> 
> 时间：2008-10-17T06:23:08.363
> 
> 标签：haskell

Haskell 编程语言有哪些鲜为人知但有用的特性。（我知道该语言本身鲜为人知，但请与我合作。即使是对 Haskell 中简单事物的解释，例如用一行代码定义斐波那契数列，也会得到我的支持。）

*   尝试限制对 Haskell 核心的回答
*   每个答案一个功能
*   提供功能的示例和简短描述，而不仅仅是文档链接
*   使用粗体标题作为第一行标记特征

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-17T21:49:02.253

**用户定义的控制结构**

Haskell 没有速记三元运算符。内置的`if`- `then`-`else`始终是三元的，并且是一个表达式（命令式语言往往有`?:`=expression，`if`=statement）。不过，如果你愿意，

```
True ? x = const x
False ? _ = id 
```

将定义`(?)`为三元运算符：

```
(a ? b $ c)  ==  (if a then b else c) 
```

您必须借助大多数其他语言中的宏来定义自己的短路逻辑运算符，但 Haskell 是一种完全惰性的语言，因此它可以正常工作。

```
-- prints "I'm alive! :)"
main = True ? putStrLn "I'm alive! :)" $ error "I'm dead :(" 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-06-23T22:45:42.333

**胡格尔**

胡格尔是你的朋友。我承认，它不是“核心”的一部分，所以`cabal install hoogle`

现在您知道“如果您正在寻找高阶函数，它已经存在”（[ehemient 的评论](https://stackoverflow.com/questions/211216/hidden-features-of-haskell/213436#213436)）。但是您如何找到该功能？与胡歌！

```
$ hoogle "Num a => [a] -> a"
Prelude product :: Num a => [a] -> a
Prelude sum :: Num a => [a] -> a

$ hoogle "[Maybe a] -> [a]"
Data.Maybe catMaybes :: [Maybe a] -> [a]

$ hoogle "Monad m => [m a] -> m [a]"
Prelude sequence :: Monad m => [m a] -> m [a]

$ hoogle "[a] -> [b] -> (a -> b -> c) -> [c]"
Prelude zipWith :: (a -> b -> c) -> [a] -> [b] -> [c] 
```

hoogle-google 程序员无法像在计算机的帮助下那样自己在纸上编写程序。但他和机器一起是被迫的不可小觑。

顺便说一句，如果您喜欢 hoogle，请务必查看 hlint！

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-10-17T19:02:06.490

**我的大脑刚刚爆炸**

如果您尝试编译此代码：

```
{-# LANGUAGE ExistentialQuantification #-}
data Foo = forall a. Foo a
ignorefoo f = 1 where Foo a = f 
```

您将收到此错误消息：

```
$ ghc Foo.hs

Foo.hs:3:22:
    我的脑袋简直炸裂了。
    我无法处理存在量化构造函数的模式绑定。
    相反，使用 case-expression 或 do-notation 来解压缩构造函数。
    在绑定组中
        富一
    在模式绑定中：Foo a = f
    在 `ignorefoo' 的定义中：
        忽略foo f = 1
                    在哪里
                        富a = f

```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-07-06T17:46:13.053

**自由定理**

Phil Wadler 向我们介绍了[自由定理](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.38.9875)的概念，从那时起我们就一直在 Haskell 中滥用它们。

Hindley-Milner 风格的类型系统的这些奇妙工件通过使用参数告诉您函数*不会*做什么来帮助进行等式推理。

例如，Functor 的每个实例都应满足两条定律：

1.  forall f g. fmap f . fmap g = fmap (f . g)
2.  fmap id = id

但是，自由定理告诉我们，我们不必费心证明第一个，但考虑到第二个，它只是来自类型签名的“自由”！

```
fmap :: Functor f => (a -> b) -> f a -> f b 
```

你需要对惰性有点小心，但这在原始论文和 Janis Voigtlender[最近](http://portal.acm.org/citation.cfm?id=982962.964010)关于存在`seq`.

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2008-10-17T18:14:31.157

**常用列表操作的简写**

以下是等价的：

```
concat $ map f list
concatMap f list
list >>= f 
```

## 编辑

由于要求提供更多详细信息...

```
concat :: [[a]] -> [a] 
```

`concat`获取一个列表并将它们连接成一个列表。

```
map :: (a -> b) -> [a] -> [b] 
```

`map`在列表上映射一个函数。

```
concatMap :: (a -> [b]) -> [a] -> [b] 
```

`concatMap`相当于`(.) concat . map`：在列表上映射一个函数，并连接结果。

```
class Monad m where
    (>>=) :: m a -> (a -> m b) -> m b
    return :: a -> m a 
```

A`Monad`有一个*绑定*操作，在 Haskell 中调用`>>=`（或其糖化的`do`等效项）。列表，又名`[]`，是一个`Monad`. 如果我们在上面`[]`替换`m`：

```
instance Monad [] where
    (>>=) :: [a] -> (a -> [b]) -> [b]
    return :: a -> [a] 
```

对列表进行操作的自然`Monad`做法是什么？我们必须满足单子定律，

```
return a >>= f           ==  f a
ma >>= (\a -> return a)  ==  ma
(ma >>= f) >>= g         ==  ma >>= (\a -> f a >>= g) 
```

如果我们使用实施，您可以验证这些法律是否成立

```
instance Monad [] where
    (>>=) = concatMap
    return = (:[])

return a >>= f  ==  [a] >>= f  ==  concatMap f [a]  ==  f a
ma >>= (\a -> return a)  ==  concatMap (\a -> [a]) ma  ==  ma
(ma >>= f) >>= g  ==  concatMap g (concatMap f ma)  ==  concatMap (concatMap g . f) ma  ==  ma >>= (\a -> f a >>= g) 
```

这实际上是 的行为`Monad []`。作为示范，

```
double x = [x,x]
main = do
    print $ map double [1,2,3]
        -- [[1,1],[2,2],[3,3]]
    print . concat $ map double [1,2,3]
        -- [1,1,2,2,3,3]
    print $ concatMap double [1,2,3]
        -- [1,1,2,2,3,3]
    print $ [1,2,3] >>= double
        -- [1,1,2,2,3,3] 
```

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2008-10-17T19:00:43.560

**可嵌套的多行注释**。

```
{- inside a comment,
     {- inside another comment, -}
still commented! -} 
```

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2009-04-15T01:54:02.467

广义代数数据类型。这是一个示例解释器，其中类型系统可让您涵盖所有情况：

```
{-# LANGUAGE GADTs #-}
module Exp
where

data Exp a where
  Num  :: (Num a) => a -> Exp a
  Bool :: Bool -> Exp Bool
  Plus :: (Num a) => Exp a -> Exp a -> Exp a
  If   :: Exp Bool -> Exp a -> Exp a -> Exp a 
  Lt   :: (Num a, Ord a) => Exp a -> Exp a -> Exp Bool
  Lam  :: (a -> Exp b) -> Exp (a -> b)   -- higher order abstract syntax
  App  :: Exp (a -> b) -> Exp a -> Exp b
 -- deriving (Show) -- failse

eval :: Exp a -> a
eval (Num n)      = n
eval (Bool b)     = b
eval (Plus e1 e2) = eval e1 + eval e2
eval (If p t f)   = eval $ if eval p then t else f
eval (Lt e1 e2)   = eval e1 < eval e2
eval (Lam body)   = \x -> eval $ body x
eval (App f a)    = eval f $ eval a

instance Eq a => Eq (Exp a) where
  e1 == e2 = eval e1 == eval e2

instance Show (Exp a) where
  show e = "<exp>" -- very weak show instance

instance (Num a) => Num (Exp a) where
  fromInteger = Num
  (+) = Plus 
```

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2009-06-05T08:54:07.330

**顶级绑定中的模式**

```
five :: Int
Just five = Just 5

a, b, c :: Char
[a,b,c] = "abc" 
```

多么酷啊！`fromJust`不时为您节省电话`head`。

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2008-10-17T13:00:04.660

**可选布局**

您可以使用显式大括号和分号而不是空格（也称为布局）来分隔块。

```
let {
      x = 40;
      y = 2
     } in
 x + y 
```

...或等效地...

```
let { x = 40; y = 2 } in x + y 
```

... 代替 ...

```
let x = 40
    y = 2
 in x + y 
```

因为不需要布局，Haskell 程序可以直接由其他程序生成。

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2008-10-17T13:27:09.333

**操作员固定性**

您可以使用[infix、infixl 或 infixr](http://haskell.org/tutorial/functions.html#sect4.4.2)关键字来定义运算符的关联性和优先级。取自[参考](http://www.zvon.org/other/haskell/Outputsyntax/fixityQdeclaration_reference.html)的示例：

```
main = print (1 +++ 2 *** 3)

infixr  6 +++
infixr  7 ***,///

(+++) :: Int -> Int -> Int
a +++ b = a + 2*b

(***) :: Int -> Int -> Int
a *** b = a - 4*b

(///) :: Int -> Int -> Int
a /// b = 2*a - 3*b
Output: -19 
```

中缀后的数字（0 到 9）允许您定义运算符的优先级，9 最强。Infix 表示没有关联性，而 infixl 关联左，infixr 关联右。

这允许您定义复杂的运算符来执行编写为简单表达式的高级操作。

请注意，如果将二进制函数放在反引号之间，也可以将它们用作运算符：

```
main = print (a `foo` b)

foo :: Int -> Int -> Int
foo a b = a + b 
```

因此，您还可以为它们定义优先级：

```
infixr 4 `foo` 
```

* * *

## 回答 #11

> 赞同：16
> 
> 时间：2008-10-17T13:34:56.540

**`seq`并且`($!)` [只评估](http://users.aber.ac.uk/afc/stricthaskell.html#seq)足以检查某些东西是否不是底部。**

以下程序只会打印“那里”。

```
main = print "hi " `seq` print "there" 
```

对于那些不熟悉 Haskell 的人来说，Haskell 通常是非严格的，这意味着只有在需要时才评估函数的参数。

例如，以下打印“忽略”并成功终止。

```
main = foo (error "explode!")
  where foo _ = print "ignored" 
```

`seq`如果它的第一个参数是底部，则已知通过评估底部来改变该行为。

例如：

```
main = error "first" `seq` print "impossible to print" 
```

...或等效地，没有中缀...

```
main = seq (error "first") (print "impossible to print") 
```

...将在“第一个”上出现错误。它永远不会打印“不可能打印”。

因此，即使`seq`是严格的，它也不会像热切的语言那样评估某些东西，这可能有点令人惊讶。特别是，它不会尝试强制以下程序中的所有正整数。相反，它会检查`[1..]`不是底部（可以立即找到），打印“完成”，然后退出。

```
main = [1..] `seq` print "done" 
```

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2008-10-17T19:00:19.880

**避免括号**

中的`(.)`and`($)`函数`Prelude`有非常方便的固定性，让你在很多地方都避免使用括号。以下是等价的：

```
f (g (h x))
f $ g $ h x
f . g $ h x
f . g . h $ x 
```

`flip`也有帮助，以下是等效的：

```
map (\a -> {- some long expression -}) list
flip map list $ \a ->
    {- some long expression -} 
```

* * *

## 回答 #13

> 赞同：15
> 
> 时间：2008-10-17T19:01:06.087

**漂亮的警卫**

`Prelude`定义`otherwise = True`，使完整的保护条件读起来很自然。

```
fac n
  | n < 1     = 1
  | otherwise = n * fac (n-1) 
```

* * *

## 回答 #14

> 赞同：15
> 
> 时间：2009-12-14T14:12:35.123

**C 样式枚举**

结合顶级模式匹配和算术序列为我们提供了一种定义连续值的便捷方法：

```
foo : bar : baz : _ = [100 ..]    -- foo = 100, bar = 101, baz = 102 
```

* * *

## 回答 #15

> 赞同：13
> 
> 时间：2008-10-17T18:59:43.157

**可读函数组合**

`Prelude`定义`(.)`为数学函数组合；也就是说，`g . f`首先应用`f`，然后应用`g`到结果。

如果你`import Control.Arrow`，以下是等价的：

```
g . f
f >>> g 
```

`Control.Arrow`提供了一个`instance Arrow (->)`, 这对于不喜欢向后阅读函数应用程序的人来说很好。

* * *

## 回答 #16

> 赞同：11
> 
> 时间：2009-10-08T08:51:26.090

`let 5 = 6 in ...`是有效的 Haskell。

* * *

## 回答 #17

> 赞同：10
> 
> 时间：2008-10-17T16:02:12.780

**无限列表**

既然你提到了斐波那契，有一种非常优雅的方法可以从这样的无限列表中[生成斐波那契数：](http://www.haskell.org/tutorial/patterns.html#tut-lazy-patterns)

```
fib@(1:tfib)    = 1 : 1 : [ a+b | (a,b) <- zip fib tfib ] 
```

@ 运算符允许您在 1:tfib 结构上使用模式匹配，同时仍将整个模式称为 fib。

请注意，理解列表进入无限递归，生成无限列表。但是，您可以向它请求元素或操作它们，只要您请求有限的数量：

```
take 10 fib 
```

您还可以在请求之前对所有元素应用操作：

```
take 10 (map (\x -> x+1) fib) 
```

这要归功于 Haskell 对参数和列表的惰性求值。

* * *

## 回答 #18

> 赞同：9
> 
> 时间：2008-10-17T19:01:51.123

**灵活的模块导入导出规范**

导入和导出很好。

```
module Foo (module Bar, blah)  -- this is module Foo, export everything that Bar expored, plus blah

import qualified Some.Long.Name as Short
import Some.Long.Name (name)  -- can import multiple times, with different options

import Baz hiding (blah)  -- import everything from Baz, except something named 'blah' 
```

* * *

## 回答 #19

> 赞同：8
> 
> 时间：2008-10-17T19:01:30.920

**如果您正在寻找列表或高阶函数，它已经存在**

标准库中有太多便利和高阶函数。

```
-- factorial can be written, using the strict HOF foldl':
fac n = Data.List.foldl' (*) 1 [1..n]
-- there's a shortcut for that:
fac n = product [1..n]
-- and it can even be written pointfree:
fac = product . enumFromTo 1 
```

* * *

## 回答 #20

> 赞同：8
> 
> 时间：2009-07-06T17:38:53.503

**等式推理**

Haskell，纯粹是功能性的，允许您将等号读取为真正的等号（在没有非重叠模式的情况下）。

这允许您将定义直接替换到代码中，并且在优化方面为编译器提供了很多关于何时发生的事情的余地。

这种推理形式的一个很好的例子可以在这里找到：

[http://www.haskell.org/pipermail/haskell-cafe/2009-March/058603.html](http://www.haskell.org/pipermail/haskell-cafe/2009-March/058603.html)

这也很好地体现在实例的有效成员所期望的法律或 RULES pragma 的形式中，例如 Monad 法律：

1.  返回一个 >>= f == fa
2.  m >>= 返回 == m
3.  (m >>= f) >>= g == m >>= (\x -> fx >>= g)

通常可以用来简化一元代码。

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2009-07-06T18:26:23.750

**增强的模式匹配**

*   懒惰的模式
*   无可辩驳的模式

    ```
    let ~(Just x) = someExpression 
    ```

查看[模式匹配](http://www.haskell.org/tutorial/patterns.html)

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2009-07-06T18:31:18.843

**并行列表理解**

（特殊 GHC 功能）

```
 fibs = 0 : 1 : [ a + b | a <- fibs | b <- tail fibs ] 
```

* * *

## 回答 #23

> 赞同：6
> 
> 时间：2009-07-07T13:00:51.723

**懒惰**

无处不在的懒惰意味着你可以做一些事情，比如定义

```
fibs = 1 : 1 : zipWith (+) fibs (tail fibs) 
```

但它也在语法和推理方面为我们提供了很多更微妙的好处。

例如，由于严格 ML 必须处理[值限制](http://www.strangelights.com/fsharp/wiki/default.aspx/FSharpWiki/ValueRestriction.html)，并且非常小心地跟踪循环 let 绑定，但是在 Haskell 中，我们可以让每个 let 都是递归的，并且不需要区分`val`and `fun`。这从语言中消除了一个主要的语法缺陷。

这间接产生了我们可爱的`where`子句，因为我们可以安全地将可能会或可能不会使用的计算移出主控制流，并让惰性处理共享结果。

我们可以（几乎）替换所有需要获取 () 并返回值的 ML 样式函数，只需对值进行惰性计算。有理由不时避免这样做，以避免[CAF](http://www.haskell.org/haskellwiki/Constant_applicative_form)泄漏空间，但这种情况很少见。

最后，它允许不受限制的 eta 减少（`\x -> f x`可以用 f 代替）。这使得像解析器组合器这样的面向组合器的编程比在严格的语言中使用类似的结构更令人愉快。

这有助于您以无点风格推理程序，或将它们重写为无点风格并减少争论噪音。

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2009-12-14T14:06:08.367

**枚举**

任何作为**Enum**实例的类型都可以在算术序列中使用，而不仅仅是数字：

```
alphabet :: String
alphabet = ['A' .. 'Z'] 
```

包括您自己的数据类型，只需从 Enum 派生即可获得默认实现：

```
data MyEnum = A | B | C deriving(Eq, Show, Enum)

main = do
    print $ [A ..]                 -- prints "[A,B,C]"
    print $ map fromEnum [A ..]    -- prints "[0,1,2]" 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2009-07-06T18:28:24.807

**单子**

它们并没有那么隐蔽，但它们无处不在，即使你没有想到它们（列表，Maybe-Types）......

# flash - 可以使用 MovieClipLoader() 从不同的服务器加载 swf？

> ID：211219
> 
> 赞同：0
> 
> 时间：2008-10-17T06:27:19.603
> 
> 标签：flash, moviecliploader

将文件从媒体托管加载到 swf shell 时遇到一些问题（将 swf 作为资产加载的 swf）。Mp3 和图像工作正常，但从不加载 swf。代码就像：

swfpath = " [http://555.55.555.555/vir_dir/swf/N000001.swf](http://555.55.555.555/vir_dir/swf/N000001.swf) " movie_loader.loadMovie(swfpath, "mc_swfimage");

如果 swfpath 设置为“swf/N00001.swf”，它可以正常加载，如果我将 firefox 指向上面的 http 链接（此处为 555s 作为占位符），它会在 firefox 中打开文件就好了。

是某种安全性还是 loadMovie 不处理 http 路径？

请注意，如果我使用指向 MP3 的相同内容执行 loadAudio，它工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T06:45:01.767

如果有任何跨域请求，Flash 将在域的根目录中查找 crossdomain.xml 文件。例如，如果您从以下位置请求 XML 文件： `http://mysubdomain.mydomain.com/fu/bar/`

Flash 将检查 crossdomain.xml 文件是否存在于：`http://mysubdomin.mydomain.com/crossdomain.xml`

如果您需要从其他位置加载 crossdomain.xml 文件，您可以通过[Security.loadPolicyFile](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/system/Security.html#loadPolicyFile())来完成。请记住，此跨域的位置对您拥有的安全访问有任何影响。

您可能还想了解[Flash Player 10 中的安全更改](http://www.adobe.com/devnet/flashplayer/articles/fplayer9-10_security.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T15:05:43.317

您需要在为加载的 SWF 提供服务的服务器上设置一个 crossdomain.xml 文件。

查看谷歌上的前几个链接：

[http://www.google.com/search?client=safari&rls=en-us&q=crossdomain.xml&ie=UTF-8&oe=UTF-8](http://www.google.com/search?client=safari&rls=en-us&q=crossdomain.xml&ie=UTF-8&oe=UTF-8)

麦克风

# eclipse - 在 Eclipse 中保存时运行外部应用程序

> ID：211236
> 
> 赞同：4
> 
> 时间：2008-10-17T06:41:52.147
> 
> 标签：eclipse, eclipse-plugin, unison

由于我们无法设置 Eclipse 的 RSE 以用于远程编辑工具，因此我安装了[Unison](http://www.cis.upenn.edu/~bcpierce/unison/docs.html)。但是我怎样才能让 Eclipse 在每个文件保存时自动运行一致呢？是否有可用的 Eclipse 插件？

TIA

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T04:57:56.187

您可以将其设置为在每个构建上运行。任何外部工具都可以在每个构建上运行，只需打开项目的首选项，转到构建器页面，单击“新建...”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-07T09:46:11.333

根据重要性，我会编写一个简单的插件来处理这个问题。

编辑：您*真正*需要做的就是：

1) 使用 RCP\PDE Eclipse 安装从模板创建插件
2) 将以下代码添加到您的激活器...

```
@Override
public void start( final BundleContext context ) throws Exception {
    super.start( context );
    plugin = this;

    ICommandService commandService = (ICommandService)plugin.getWorkbench().getService( ICommandService.class );
    commandService.addExecutionListener( new IExecutionListener() {

        public void notHandled( final String commandId, final NotHandledException exception ) {}

        public void postExecuteFailure( final String commandId, final ExecutionException exception ) {}

        public void postExecuteSuccess( final String commandId, final Object returnValue ) {
            if ( commandId.equals( "org.eclipse.ui.file.save" ) ) {
                // add in your action here...
                // personally, I would use a custom preference page, 
                // but hard coding would work ok too
            }
        }

        public void preExecute( final String commandId, final ExecutionEvent event ) {}

    } );
} 
```

# c++ - 静态变量初始化顺序

> ID：211237
> 
> 赞同：68
> 
> 时间：2008-10-17T06:43:30.740
> 
> 标签：c++, visual-studio, gcc, static, linker

C++ 保证编译单元（.cpp 文件）中的变量按声明顺序进行初始化。对于编译单元的数量，此规则分别适用于每个编译单元（我的意思是类之外的静态变量）。

但是，变量的初始化顺序在不同的编译单元中是未定义的。

我在哪里可以看到关于 gcc 和 MSVC 的这个顺序的一些解释（我知道依赖它是一个非常糟糕的主意 - 这只是为了了解我们在迁移到新的 GCC 主要和不同操作系统时可能遇到的遗留代码问题） ?

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2008-10-17T07:23:14.840

正如您所说，该顺序在不同的编译单元中是未定义的。

在同一个编译单元中，顺序是明确定义的：与定义相同的顺序。

这是因为这不是在语言级别而是在链接器级别解决的。所以你真的需要查看链接器文档。尽管我真的怀疑这会以任何有用的方式提供帮助。

对于 gcc：查看**ld**

我发现即使更改链接的对象文件的顺序也可以更改初始化顺序。因此，您需要担心的不仅仅是链接器，还有构建系统如何调用链接器。甚至试图解决问题实际上也是徒劳的。

这通常仅在初始化在自己的初始化期间相互引用的全局变量时才会出现问题（因此仅影响具有构造函数的对象）。

### 有一些技术可以解决这个问题。

*   延迟初始化。
*   [施瓦茨计数器](http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Nifty_Counter)
*   将所有复杂的全局变量放在同一个编译单元中。

* * *

*   注 1：全局变量：
    用于泛指可能在 之前初始化的静态存储持续时间变量`main()`。
*   注意 2：可能
    在一般情况下，我们希望静态存储持续时间变量在 main 之前初始化，但编译器在某些情况下允许延迟初始化（规则很复杂，详见标准）。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-17T07:30:16.870

我希望模块之间的构造函数顺序主要取决于您将对象传递给链接器的顺序。

但是，GCC 确实允许您[使用`init_priority`](https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Attributes.html)显式指定全局 ctor[的顺序：](https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Attributes.html)

```
class Thingy
{
public:
    Thingy(char*p) {printf(p);}
};

Thingy a("A");
Thingy b("B");
Thingy c("C"); 
```

如您所料输出'ABC'，但是

```
Thingy a __attribute__((init_priority(300))) ("A");
Thingy b __attribute__((init_priority(200))) ("B");
Thingy c __attribute__((init_priority(400))) ("C"); 
```

输出“BAC”。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2016-09-12T00:53:36.380

由于您已经知道除非绝对必要，否则不应依赖此信息，因此它来了。我对各种工具链（MSVC、gcc/ld、clang/llvm 等）的一般观察是，将目标文件传递给链接器的顺序就是初始化它们的顺序。

这也有例外，我并不声称所有这些，但以下是我自己遇到的：

1) 4.7 之前的 GCC 版本实际上以链接行的相反顺序初始化。[GCC 中的这张票](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=46770)是更改发生的时间，它破坏了许多依赖于初始化顺序的程序（包括我的！）。

2) 在 GCC 和 Clang 中，使用[构造函数优先级](https://gcc.gnu.org/onlinedocs/gcc-4.7.2/gcc/Function-Attributes.html)可以改变初始化顺序。请注意，这只适用于声明为“构造函数”的函数（即它们应该像全局对象构造函数一样运行）。我尝试过使用这样的优先级，发现即使在构造函数上具有最高优先级，所有没有优先级的构造函数（例如普通全局对象、没有优先级的构造函数）都会*首先*被初始化。换句话说，优先级只是相对于其他具有优先级的功能而言，但真正的一等公民是那些没有优先级的。更糟糕的是，由于上述第 (1) 点，此规则在 4.7 之前的 GCC 中实际上是相反的。

3) 在 Windows 上，有一个非常简洁和有用的共享库 (DLL) 入口点函数，称为[DllMain()](https://msdn.microsoft.com/en-us/library/windows/desktop/ms682583(v=vs.85).aspx)，如果已定义，它将在所有全局数据初始化后直接使用等于 DLL_PROCESS_ATTACH 的参数“fdwReason”运行，并且*在*消费应用程序有机会调用 DLL 上的任何函数之前。这在某些情况下非常有用，并且在使用 GCC 或使用 C 或 C++ 的 Clang 的其他平台上绝对*没有*类似的行为。您会发现最接近的是创建一个具有优先级的构造函数（参见上面的第 (2) 点），这绝对不是一回事，并且不适用于 DllMain() 工作的许多用例。

4) 如果您使用 CMake 生成构建系统，我经常这样做，我发现输入源文件的顺序将是它们提供给链接器的结果目标文件的顺序。但是，通常您的应用程序/DLL 也链接到其他库，在这种情况下，这些库将在您输入源文件*之后的链接行上。*如果您希望让您的全局对象成为*第一个*初始化的对象，那么您很幸运，您可以将包含该对象的源文件放在源文件列表中的第一个。但是，如果您希望有一个是*最后一个*进行初始化（这可以有效地复制 DllMain() 行为！）然后您可以使用该源文件调用 add_library() 以生成静态库，并将生成的静态库添加为 target_link_libraries( ) 调用您的应用程序/DLL。请注意，在这种情况下，您的全局对象可能会被优化，您可以使用[--whole-archive](https://ftp.gnu.org/old-gnu/Manuals/ld-2.9.1/html_node/ld_3.html)标志强制链接器不要删除该特定小型存档文件的未使用符号。

**结束提示**

要绝对知道链接的应用程序/共享库的初始化顺序，请将 --print-map 传递给 ld 链接器和 grep 用于 .init_array （或在 4.7 之前的 GCC 中， grep 用于 .ctors）。每个全局构造函数都将按照初始化的顺序打印，并记住在 4.7 之前的 GCC 中该顺序是相反的（参见上面的第 (1) 点）。

写这个答案的动机是我需要知道这些信息，别无选择，只能依赖初始化顺序，并且在其他 SO 帖子和互联网论坛中只发现了这些信息的一小部分。其中大部分是通过大量实验学到的，我希望这可以节省一些人这样做的时间！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-17T07:41:03.323

[http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.12](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.12) - 这个链接移动。这个更稳定，但[你](http://www.parashift.com/c++-faq/)必须四处寻找它。

编辑：osgx 提供了一个更好的[链接](http://web.archive.org/web/20080512011623/http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.12)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-07-14T13:28:59.703

一个健壮的解决方案是使用返回对静态变量的引用的 getter 函数。下面显示了一个简单的示例，它是我们[SDG 控制器中间件](https://github.com/protohaus/sdg-controller)中的一个复杂变体。

```
// Foo.h
class Foo {
 public:
  Foo() {}

  static bool insertIntoBar(int number);

 private:
  static std::vector<int>& getBar();
};

// Foo.cpp
std::vector<int>& Foo::getBar() {
  static std::vector<int> bar;
  return bar;
}

bool Foo::insertIntoBar(int number) {
  getBar().push_back(number);
  return true;
}

// A.h
class A {
 public:
  A() {}

 private:
  static bool a1;
};

// A.cpp
bool A::a1 = Foo::insertIntoBar(22); 
```

初始化将使用唯一的静态成员变量`bool A::a1`。这将调用`Foo::insertIntoBar(22)`. 然后这将调用`Foo::getBar()`其中静态`std::vector<int>`变量的初始化将在返回对初始化对象的引用之前发生。

如果`static std::vector<int> bar`直接作为 的成员变量放置`Foo class`，则根据源文件的命名顺序，`bar`可能会在`insertIntoBar()`调用后初始化，从而使程序崩溃。

如果`insertIntoBar()`在初始化期间调用多个静态成员变量，则顺序将不依赖于源文件的名称，即随机，但`std::vector<int>`可以保证在插入任何值之前对其进行初始化。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-17T07:38:10.193

除了来自 C 背景的 Martin 的评论，我一直认为静态变量是程序可执行文件的一部分，在数据段中合并和分配空间。因此，静态变量可以被认为是在程序加载时初始化，在任何代码执行之前。可以通过查看链接器输出的映射文件的数据段来确定发生这种情况的确切顺序，但对于大多数意图和目的而言，初始化是同时进行的。

编辑：根据静态对象的构造顺序可能是不可移植的，应该避免。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-25T09:54:38.260

如果您真的想知道最终顺序，我建议您创建一个类，其构造函数记录当前时间戳，并在每个 cpp 文件中创建该类的几个静态实例，以便您可以知道初始化的最终顺序。确保在构造函数中放置一些耗时的操作，这样您就不会为每个文件获得相同的时间戳。

# mysql - Rails 和 CouchDB - 架构问题

> ID：211238
> 
> 赞同：3
> 
> 时间：2008-10-17T06:46:33.993
> 
> 标签：mysql, ruby-on-rails, architecture, activerecord, couchdb

我正在开发一个使用 CouchDB 灵活存储文档的项目。我的系统要求与 CouchDB 存储完美匹配。

但

我的问题真的归结为：我是否也应该继续使用 ActiveRecord 和 MySQL……有很多方便的插件都可以与 ActiveRecord 一起使用（例如身份验证和访问控制）。只是想知道利用现有插件的优势是否值得额外的管理开销和可能的集成问题（跨不同的数据存储工作）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-04T17:02:53.310

在单个应用程序中处理多个持久性存储的情况并不少见。一种非常常见的方法是使用关系数据库，该数据库存储指向存储在文件系统中的文件的路径。

因此，您可能会将 CouchDB 视为数据模型特殊部分的特殊“文件系统”。

此外，在较大的应用程序中，多个存储和复杂的物理架构非常常见，因此不要羞于为您的模型使用多个持久存储。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T07:36:39.010

你可以同时使用；有些模型仍然可以是 ActiveRecord，而其他模型可以是 CouchDB。

# visual-studio - 如何在 Visual Studio 中重命名项目文件夹？

> ID：211241
> 
> 赞同：762
> 
> 时间：2008-10-17T06:47:46.020
> 
> 标签：visual-studio, directory, projects-and-solutions

我当前重命名项目文件夹的解决方案是：

*   从解决方案中删除项目。
*   重命名 Visual Studio 外部的文件夹。
*   将项目重新添加到解决方案中。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：819
> 
> 时间：2008-10-22T07:55:49.810

> *TFS 用户：*如果您使用的源代码控制要求您在重命名文件/文件夹之前对其发出警告，那么请查看***[此答案](https://stackoverflow.com/a/10853509/10245)***，其中涵盖了所需的额外步骤。

* * *

要在 Visual Studio 中重命名项目的**文件夹**、**文件**( `.*proj`) 和**显示名称：**

*   关闭解决方案。
*   重命名 Visual Studio 外部的文件夹。（如果使用源代码控制，请在 TFS 中重命名）
*   打开解决方案，忽略警告（如果要求从源代码管理加载项目，请回答“否”）。
*   浏览所有**不可用**的项目并...
    *   打开项目的**属性**窗口（突出显示项目并按`Alt`+`Enter`或`F4`，或右键单击 > 属性）。
    *   将属性“**文件路径**”设置为新位置。
        *   如果该属性不可编辑（如在 Visual Studio 2012 中），则`.sln`直接在另一个编辑器（例如[Notepad++](http://en.wikipedia.org/wiki/Notepad%2B%2B) ）中打开该文件，然后更新那里的路径。（您可能需要先在 TFS 等中签出解决方案）
    *   **重新加载**项目 - 右键单击​​ > 重新加载项目。
    *   更改项目的显示名称，方法是突出显示并按`F2`，或右键单击 >**重命名**。

**注意：**涉及删除项目然后将项目重新添加到解决方案的其他建议解决方案将破坏项目引用。

如果您执行这些步骤，那么您还可以考虑重命名以下内容以匹配：

1.  集会
2.  默认/根命名空间
3.  现有文件的命名空间（使用 Visual Studio 中的重构工具或[ReSharper 的](https://en.wikipedia.org/wiki/JetBrains#ReSharper_Ultimate)不一致命名空间工具）

还可以考虑修改以下[程序集属性](http://msdn.microsoft.com/en-us/library/4w8c1y2s.aspx)的值：

1.  `AssemblyProductAttribute`
2.  `AssemblyDescriptionAttribute`
3.  `AssemblyTitleAttribute`

* * *

## 回答 #2

> 赞同：143
> 
> 时间：2015-10-18T08:42:06.270

**这在 Visual Studio 2015 中很简单**（可能适用于旧版本）

1.  在解决方案资源管理器中，右键单击*主解决方案*→*重命名*
2.  在解决方案资源管理器中，右键单击*项目*（在解决方案下）→*重命名*
3.  在解决方案资源管理器中，双击或右键单击*Properties* → goto *Application Tab*，重命名*程序集名称*和*默认命名空间*以匹配。
4.  如果您还想重命名命名空间，请打开您的类文件之一。右键单击命名空间 →重命名*...。*这应该在整个项目中搜索并替换对您的命名空间的所有引用。
5.  关闭项目→重命名*项目文件夹*。
6.  [在记事本](https://en.wikipedia.org/wiki/Notepad_%28software%29)中编辑`.sln`文件，并更改csproj的路径，即→ 。`fu\bar.csproj``bar\bar.csproj`

* * *

## 回答 #3

> 赞同：110
> 
> 时间：2008-10-17T07:05:02.880

还有另一种方法，使用 *.sol、*csproj 文件。

1.  打开您的解决方案文件。
2.  搜索您要更改的 *.csproj。
3.  它将是这样的（相对于 *.sol 文件）：

    *`Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Shani.Commands.Impl", "Shani.Commands.Impl\Shani.Commands.Impl.csproj", "{747CFA4B-FC83-419A-858E-5E2DE2B948EE}"`*

4.  只需将第一部分更改为新目录，例如：

    *`Impl\Shani.Commands.Impl\Shani.Commands.Impl.csproj`*

5.  当然，不要忘记将整个项目移动到该目录。

* * *

## 回答 #4

> 赞同：54
> 
> 时间：2013-06-13T15:22:42.930

伙计，我有没有为此挣扎过。不幸的是，Visual Studio 中没有一键式解决方案，但如果您正在运行**Visual Studio 2012**并且您的项目受**Team Foundation Server**的源代码控制，那么我是如何让它工作的，同时保留源代码历史记录：

*（请务必阅读下面的@mjv 评论，因为他指出您可以跳过步骤 5-10）*

1.  确保您已签入所有更改，因此您没有待处理的更改。
2.  通过右键单击并选择*Remove*从解决方案中删除项目。
3.  现在，在 Windows 资源管理器中，重命名项目文件夹。
4.  返回 Visual Studio，在解决方案资源管理器中，右键单击解决方案并选择*Add* -> *Existing project*。为您在步骤 2 中删除的项目选择项目文件，该文件应位于重命名的文件夹中。
5.  现在该项目又回到了解决方案中，但该项目似乎没有添加到源代码管理中。要解决此问题，请打开源代码管理资源管理器。
6.  在源代码管理资源管理器中找到与磁盘上的项目文件夹相对应的项目文件夹，您在步骤 3 中重命名了该文件夹。
7.  在源代码管理资源管理器中重命名文件夹，使其与磁盘上的项目文件夹具有相同的名称。
8.  现在看看您的待定更改。您应该对解决方案文件进行更改，并对项目文件夹进行重命名操作。
9.  进行重建并确保一切都正确编译。如果您对重命名的项目有项目间引用，则需要将它们再次添加到引用它的各个项目中。
10.  你现在应该准备好了。去检查所有东西。

上面的指南对我有用。如果它对您不起作用，请尝试完全删除您的本地解决方案，并删除工作区中的文件夹映射。以防万一，重新启动 Visual Studio。确保您确实从计算机中删除了整个解决方案。现在将解决方案映射到您的工作区并获取最新版本。现在尝试上述步骤。如果在执行上述步骤时出现问题，这同样适用。只需在本地删除您的解决方案并获取最新的源代码，您就会有一个全新的工作环境。

如果您仍然遇到问题，请确保您没有在解决方案文件中手动更改任何内容，或者在尝试上述步骤之前尝试其他“技巧”。如果您更改了某些内容并将其签入，您可能需要考虑回滚到开始弄乱项目重命名之前的点。

当然，您还想在解决方案资源管理器中重命名项目本身。您可以在上述步骤之前执行此操作，但在这种情况下，请确保在应用上述步骤之前签入该更改。您也可以在之后执行此操作，但请确保先执行上述所有步骤，并在尝试在解决方案资源管理器中重命名项目名称之前检查您的更改。我不建议尝试将上述步骤与解决方案资源管理器中的项目名称重命名混合使用。虽然它可能有效，但我建议在 2 个单独的变更集中进行。

* * *

## 回答 #5

> 赞同：34
> 
> 时间：2008-10-17T06:52:57.227

目前，没有。好吧，实际上您可以单击损坏的项目节点并在属性窗格中查找属性“路径”，单击小浏览图标，然后选择新路径。

瞧 :)

* * *

## 回答 #6

> 赞同：33
> 
> 时间：2016-01-26T11:17:47.850

更简单的解决方案如下：

1.  右键单击该项目并重命名它。
2.  （可选）打开项目的属性设置并修改程序集名称（以及可选的默认命名空间）以使用新的项目名称。
3.  （可选）在源文件中选择命名空间名称，右键单击并选择*重构*/*重命名*以将命名空间全局重命名为新的项目名称。
4.  （可选）打开 AssemblyInfo.cs 文件并更改程序集名称以匹配。
5.  保存并关闭解决方案。
6.  使用 Windows 资源管理器，将项目文件夹重命名为新名称。
7.  在文本编辑器中打开 SLN 文件并找到对项目路径的一个引用并将其更改为使用新文件夹名称。

有四个必需的步骤，但推荐七个。归根结底，该项目已完全重命名。从技术上讲，项目的文件夹名称不必与项目本身匹配，因此即使该步骤也是可选的，但如果它们不匹配，可能会造成混淆。程序集和命名空间名称也是如此。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2010-06-30T06:18:16.547

在[andersjanmyr 的回答](https://stackoverflow.com/questions/211241/how-can-i-rename-a-project-folder-from-within-visual-studio/224788#224788)中，首先重命名项目更容易。

1.  重命名项目。
2.  关闭解决方案（保存）。
3.  重命名 Visual Studio 外部的文件夹。
4.  打开解决方案，忽略警告。
5.  浏览所有不可用的项目并将属性“文件路径”设置为项目文件的新位置，即*someproject.csproj*。
6.  重新加载项目。

此外，执行这些步骤后，您可能希望将其他引用重命名为旧项目名称。

在项目属性中，更新程序集名称和默认命名空间。

这将更新项目文件中的以下内容...

```
<RootNamespace>SomeProjectName</RootNamespace>
<AssemblyName>SomeProjectName</AssemblyName> 
```

...并且将摆脱错误“命名空间与文件位置不对应，应该是：'SomeProjectName'”

重命名您的根命名空间（如果您有 ReSharper，请右键单击命名空间并转到 Refactor -> Rename）。

*更改AssemblyInfo.cs*中所有出现的旧项目名称。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2018-08-17T14:28:28.077

对于那些使用 Visual Studio + Git 并希望保留文件历史记录的人（重命名项目和/或解决方案的工作）：

1.  关闭 Visual Studio

2.  在 .gitignore 文件中，使用这些路径的重命名版本复制要重命名的项目的所有忽略路径。

3.  像这样使用 Git 移动命令：

    ```
    git mv <old_folder_name> <new_folder_name> 
    ```

    有关其他选项，请参阅文档：[https ://git-scm.com/docs/git-mv](https://git-scm.com/docs/git-mv)

4.  在您的 .sln 文件中：找到定义项目的行并更改路径中的文件夹名称。该行应类似于：

    ```
    Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "<Project name>", "<path-to-project>\<project>.csproj" 
    ```

5.  打开 Visual Studio，然后右键单击项目 →*重命名*

6.  之后，重命名命名空间。

    我读到[ReSharper](https://en.wikipedia.org/wiki/JetBrains#ReSharper_Ultimate)对此有一些选择。但是简单的查找/替换为我完成了这项工作。

7.  删除旧的 .gitignore 路径。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2017-05-29T06:15:45.140

对于 Visual Studio 2017，您可以使用我的 Visual Studio 扩展：

[下载](https://github.com/kuanysh-nabiyev/RenameProjectVsExtension/blob/master/FullRenamer2017-11-13.vsix)

它将在以下位置重命名项目：

*   项目位置文件夹
*   解决方案文件
*   其他项目中的参考
*   程序集名称、信息
*   默认命名空间

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2011-02-22T17:33:39.273

我只需要自己做这件事（使用 Visual Studio 2010）。正如一些人所回答的那样，最简单的步骤似乎是：

1.  关闭 Visual Studio 项目。
2.  打开 .sln 文件并重命名每个 .csproj 出现的项目目录前缀。
3.  保存 .sln 文件
4.  重命名硬盘驱动器上的实际项目文件夹目录以匹配 .sln 文件中的更改。
5.  打开 .sln（在 Visual Studio 中）并重建

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2020-07-23T17:41:07.367

使用 Visual Studio 2019，我按照以下步骤使项目名称更改成功：

1.  关闭解决方案
2.  重命名项目文件夹以匹配新项目名称
3.  在 notepad++ 类型的编辑器中打开解决方案文件并使用新项目名称文件夹编辑 FilePath
4.  打开解决方案，如果询问您是否要从源代码管理中打开，请单击否
5.  右键单击要重命名的项目，然后单击属性，然后在下面进行更改：更改程序集名称、默认程序集命名空间和使用新名称的程序集信息
6.  打开任何文件并将文件移动到新的命名空间，这将由所有文件完成
7.  如果您有 app.config 类型的文件，请确保将它们也移动到新的命名空间中
8.  重建它将成功运行

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2015-06-08T15:33:17.107

适用于商业智能数据工具的 Visual Studio 扩展的经过验证的解决方案 (SSDT-BI 2013)：

1.  将项目文件夹移动到新位置（暂时不要重命名）
2.  在解决方案资源管理器中，重命名项目/解决方案。
3.  关闭（并保存）新重命名的项目。
4.  重命名项目的文件夹和 .sln 文件。
5.  使用文本编辑器打开新重命名的项目解决方案文件 (.sln)（我使用的是[Notepad++](https://en.wikipedia.org/wiki/Notepad%2B%2B)）
6.  在第 6 行中，您将看到：“Project {fdjfksdjk4387!...} = "OLDPROJECT", "OLDFOLDER\OLDPROJECT.rptproj"。使用第 4 步中使用的新名称重命名所有内容。（即... = "NEWPROJECT ", "NEWFOLDER\NEWPROJECT.rptproj"...)
7.  就是这样！

它经过 100% 的测试，在我的情况下完美运行。

注意：我无法确认它是否适用于不同的项目模板和其他 Visual Studio 版本。与往常一样，请事先备份所有内容。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2018-06-29T15:40:43.540

在 Visual Studio 2017 中对我有用的是：

*   在 Visual Studio 中关闭解决方案
*   重命名解决方案中的项目目录。
    *   （推动源代码控制的变化——在我的例子中是 Git）
*   在文本编辑器（Visual Studio 2017 外部）中编辑 .sln 文件，更改目录名称。
*   在 Visual Studio 中重新打开解决方案

它说类似“*重新添加项目*”。我重建了一切，一切都很好。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2010-10-21T06:45:06.133

[请参阅链接文章中的第 3 项](http://social.msdn.microsoft.com/Forums/en-US/csharpide/thread/d4133fb7-57e1-44f2-a319-a63e7921ff0a)。

1.  关闭解决方案和 IDE。
2.  在 Windows 资源管理器中：将目录名称更改为新名称。
3.  在 Windows 资源管理器中：使用文本编辑器打开 .sln 文件。
4.  将目录名称更改为新名称并保存。
5.  如果解决方案没有自动启动，请重新启动 IDE 并从菜单*File* → *Recent Files*菜单打开解决方案。
6.  单击解决方案资源管理器中的项目文件夹，然后检查底部属性中的路径属性。现在它将引用新的项目文件夹。

它对我有用。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2019-02-27T17:15:36.053

我不得不这样做很多次。能够重新利用现有项目，但能够重命名命名空间、文件和文件夹中的文本（包括文件/目录名称），这非常有用。

使用从根文件夹开始的递归查找和替换意味着重命名不会破坏解决方案文件和项目引用中的项目链接。

为此，我创建了一个项目来做到这一点。该应用程序还努力忽略版本控制文件夹，例如 .git、.svn 和 .vs 设置文件。更多信息在自述文件中。

[https://github.com/garethrbrown/vs-project-rename](https://github.com/garethrbrown/vs-project-rename)

![例子](https://i.imgur.com/ihBY1aL.png)

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2020-09-04T12:33:22.030

我刚刚为自己编写了一个全局 dotnet 工具（也考虑了 git+history）解决了这个问题。

通过 安装 `dotnet tool install -g ModernRonin.ProjectRenamer`，与 一起使用`renameproject <oldName> <newName>`。

文档/修补/公关在

[https://github.com/ModernRonin/ProjectRenamer](https://github.com/ModernRonin/ProjectRenamer)

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2021-03-04T23:24:16.403

这在 Visual Studio 2019 中对我来说效果很好。

1.  只需像往常一样单击文件名，即可在 Visual Studio 中重命名解决方案和项目。
2.  在 Visual Studio 中重命名命名空间。
3.  重命名项目主页面上的所需元素（发布位置、应用程序、默认命名空间等）。正如正确指出的那样，这对文件夹没有任何作用，但它确实重命名了项目文件并将所有内容在 Visual Studio 中捆绑在一起。
4.  关闭 Visual Studio。
5.  重命名文件夹。
6.  打开 Visual Studio 并回答“否”以从源代码管理中获取项目。
7.  删除已卸载的项目引用。
8.  使用从解决方案添加现有项目重新添加每个项目。这将所有内容联系在一起，并为我构建了项目。

请评论并纠正以上任何无效的内容。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2021-07-04T05:05:20.987

这就是我在 VS19 中重命名现有项目的方式。

1.  关闭视觉工作室项目
2.  重命名并打开驱动器上的每个项目文件夹名称
3.  重命名每个 .csproj
4.  打开 .sln 文件并重命名每个 .csproj 出现的项目目录前缀。
5.  在 Visual Studio 中打开 .sln 文件并重建
6.  通过遍历每个文件或使用 ReplaceAll 来更新以前的命名空间引用

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2010-06-23T06:52:25.117

*注意*：此修复程序适用于 Visual Studio 2008，但它应该在这里工作。

1.  使用 Windows 资源管理器，将解决方案文件夹（父文件夹和子文件夹）重命名为新的解决方案名称。
2.  删除`.sln`位于父文件夹中的文件。
3.  在 Visual Studio 中，选择菜单*File* ► *Open Project*。
4.  钻入刚刚重命名的新文件夹并打开 .csproj 文件（位于子文件夹中）。
5.  右键单击项目名称并将其重命名为您想要的名称。（它应该与步骤 1 中的文件夹名称相同。）
6.  选择菜单*文件*►*关闭解决方案*。一个对话框将询问您是否要保存对`.sln`文件的更改。单击`Yes`。
7.  在“*将文件另存为*”对话框中，指向新重命名的*父*文件夹并单击“*保存*” 。（注意：确保`.sln`文件与文件夹同名。不是必需的，但保持一致性。）

完毕。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2011-08-21T15:27:50.373

我编写了一个小工具，可以自动执行所有这些步骤。它现在还支持[Subversion](https://en.wikipedia.org/wiki/Apache_Subversion)。

可以在*[Visual Studio Project Renamer Infos](http://normankosmal.com/wordpress/?page_id=184)*中找到有关当前版本的信息。

现在可以从[Visual Studio Project Renamer Download Page](http://normankosmal.com/wordpress/?page_id=15)下载最新版本。

非常感谢您的反馈。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2017-08-27T13:02:45.407

我经常遇到在 Visual Studio 中重命名项目并编辑文件夹名称、项目名称和 .sln 文件以完成此操作的相同问题。我刚刚编写了一个完成所有这些的[VBScript](https://en.wikipedia.org/wiki/VBScript)脚本。您必须小心选择要替换的字符串。

您只需将 .vbs 文件与解决方案的 .sln 文件放在同一目录中。

```
' Script parameters'
Solution = "Rename_Visual_Studio_Project" '.sln'
Project = "Rename_Visual_Studio_Project" '.csproj'
NewProject = "SUCCESS"

Const ForReading = 1
Const ForWriting = 2

Set objFso = CreateObject("Scripting.FileSystemObject")
scriptDirr = objFso.GetParentFolderName(wscript.ScriptFullName)

' Rename the all project references in the .sln file'
Set objFile = objFso.OpenTextFile(scriptDirr + "\" + Solution + ".sln", ForReading)
fileText = objFile.ReadAll
newFileText = Replace(fileText, Project, NewProject)
Set objFile = objFSO.OpenTextFile(scriptDirr + "\" + Solution + ".sln", ForWriting)
objFile.WriteLine(newFileText)
objFile.Close

' Rename the .csproj file'
objFso.MoveFile scriptDirr + "\" + Project + "\" + Project + ".csproj", scriptDirr + "\" + Project + "\" + NewProject + ".csproj"

' Rename the folder of the .csproj file'
objFso.MoveFolder scriptDirr + "\" + Project, scriptDirr + "\" + NewProject 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2018-06-13T13:49:29.257

1.  重命名解决方案和项目文件夹中的项目

2.  从解决方案中删除项目

3.  将现有项目添加到解决方案（您重命名的项目）

这个对我有用。TFS 还将跟踪新项目。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2012-10-12T13:11:31.167

使用 TFS 时，第 2 步实际上是在源代码管理中重命名文件夹，然后在重新打开解决方案之前获取最新的。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2014-04-29T17:05:29.817

在 Visual Studio 2013 Update 1 中测试了一种更简单的方法，适用于 TFS 连接的项目：

*   打开 Visual Studio，但关闭解决方案。
*   打开*Source Explorer*并重命名所需的文件夹（如果您尚未先关闭该解决方案，该解决方案将为您关闭）。
*   右键单击解决方案（也从*Source Explorer*中）并选择签入。
*   打开解决方案。您会被告知添加了新项目。接受以获取更改。
*   从解决方案中删除项目并重新添加，然后签入。
*   检查内部参考是否正常。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2015-02-20T22:09:53.967

我们最近上传了一个免费的 Visual Studio 扩展测试版，它可以为您完成这些工作。

看看 Visual Studio 画廊：[画廊下载](https://visualstudiogallery.msdn.microsoft.com/7f960171-9d87-4143-80ad-9e7edaa0d1f3)

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2015-04-09T09:12:28.273

嗯，我是按我的方式做的

*   关闭 Visual Studio 2012
*   将您的子目录重命名为 .sln 下的首选名称
*   删除 *.suo 文件
*   再次打开解决方案，并修复加载的项目的任何属性以满足新的子目录名称

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2015-08-20T15:52:22.573

1.  在 Visual Studio 之外重命名项目。
2.  使用文本编辑器编辑*your_project_name.sln*，并将路径重命名为新路径。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2019-01-26T23:48:10.940

在文本编辑器中打开 .sln，然后在以下行中将 <FolderName> 更改为您的新文件夹名称 Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Ricky", "\.csproj", " {021CC6B0-8CFB-4194-A103-C19AF869D965}"

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2020-02-04T18:13:35.253

转到.sln文件，右键，用Notepad++（或任何编辑器；Notepad++最快）打开，找到路径，更改它。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2013-03-18T20:38:44.200

[更改文件夹名称后，在记事本](https://en.wikipedia.org/wiki/Notepad_%28software%29)中打开 .sln 文件并将路径更改为新路径。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2013-08-23T23:27:14.020

当必须创建一个新项目并且您想要一个与项目名称不同的项目文件夹名称时，也会出现类似的问题。

当您创建一个新项目时，它会存储在

```
./path/to/pro/ject/YourProject/YourProject.**proj 
```

假设您想将其直接放在`ject`文件夹中：

```
./path/to/pro/ject/YourProject.**proj 
```

我的解决方法是使用路径的最后一部分作为名称来创建项目，这样它就不会创建额外的目录：

```
./path/to/pro/ject/ject.**proj 
```

现在，当您从 Visual Studio 中重命名项目时，无需离开 Visual Studio 即可实现目标：

```
./path/to/pro/ject/YourProject.**proj 
```

这种方法的缺点是您必须调整默认名称空间和输出二进制文件的名称，并且您必须更新项目模板中包含的所有文件中的名称空间。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2014-04-25T15:49:22.157

我使用 Visual Studio 2013 和[TFS](https://en.wikipedia.org/wiki/Team_Foundation_Server) 2013。

我是这样做的：

1.  打开 Visual Studio，而不打开解决方案本身，并使用*源代码管理资源管理器*查找和重命名项目的文件夹
2.  *在源代码管理资源管理器*中双击解决方案文件以打开解决方案。
3.  您会收到一个问题：*“项目最近已添加到此解决方案中。您想从源代码管理中获取它们吗？”* ，而你选择`Yes`。
4.  现在文件夹和项目结构在那里，但现在是文件，所以现在您可以从源代码管理中获得最新版本
5.  尝试构建并提交更改。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2015-07-22T12:34:21.673

最简单的方法是进入窗口的属性，更改默认命名空间的名称，然后重命名就完成了。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2017-03-25T17:50:30.470

我做了以下事情：

<创建整个文件夹的备份>

1.  在 Visual Studio 2013 中重命名项目（可选/不需要）。

2.  将项目导出为模板。

3.  关闭解决方案。

4.  重新打开解决方案

5.  从保存的模板创建一个项目并使用您喜欢的名称。

6.  从解决方案资源管理器中删除上一个项目。

*此时我尝试编译新的解决方案，为此，我必须手动将一些资源和标头从旧项目文件夹复制到新项目文件夹。这样做直到它编译没有错误。现在这个新项目将“* .exe”文件保存到之前的文件夹中。*

所以->

7.  转到 Windows 资源管理器并手动将解决方案文件从旧项目文件夹复制到新项目文件夹。

8.  关闭解决方案，然后从新项目中打开解决方案。

9.  如果需要，将配置更改回 (x64)。

10.  从解决方案的文件夹中删除具有旧名称的项目文件夹。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2018-09-23T03:27:44.390

或者简单地说，复制所有代码，使用所需名称打开一个新项目，然后粘贴代码。运行调试，然后删除以前的项目。完毕！

它对我有用！

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2021-02-26T23:52:21.123

我试图`rename`找到 Visual Studio 社区 2019 中的文件夹，但找不到它。

但是，我想通了`while the code is running you can not change the name of the folder`。

答案是：

1.  停止您的应用程序运行；
2.  然后右键单击该文件夹，`rename`名称将在那里。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2022-01-08T06:19:27.503

其他答案提供了很多关于如何做到这一点的细节。不过，这里有一个**快捷方式**，可以为您节省一些工作：

1.  重命名项目文件夹
2.  重命名`.csproj`文件
3.  **批量替换**解决方案中所有文件中的项目名称（我使用 GrepWin，它有一个方便的 GUI 预览）

这样，您就不必繁琐地使用 Visual Studio GUI。您也可以通过这种方式修复命名空间。您可以使用源代码管理来验证更改（例如打开 TortoiseGit Commit 并查看更改）。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2022-02-17T12:07:26.797

最简单的方法：

1.  从当前项目创建模板
    `Project -> Export Template... -> Project Template -> Finish`
2.  使用具有您想要的名称的模板创建一个新项目
    `File -> New Project -> Find the template -> Give it the name you want -> Add to existing solution or just as new`

就是这样，你已经完成了，你现在可以根据需要删除另一个项目，但首先要确保新项目按预期工作。模板应保留所有依赖项和项目设置。

* * *

## 回答 #39

> 赞同：-2
> 
> 时间：2018-03-19T04:44:06.000

右键单击 project → *Properties*，然后将 (name) 设置为所需的名称。

# php - 如何在 PHP 中构建大型 MySQL INSERT 查询而不浪费内存

> ID：211243
> 
> 赞同：5
> 
> 时间：2008-10-17T06:48:24.473
> 
> 标签：php, mysql

我的代码看起来像这样：

```
$data = file_get_contents($tempFile); // perhaps 30MB of file data, now in PHP's memory
$hash = md5($data);
$query = "INSERT INTO some_table
          SET BlobData = '" . mysql_real_escape_string($data) . "',
          BlobHash = '$hash'
          ";
mysql_query($query); 
```

我知道这不是很有效，因为每个“。” 运算符将重新分配更大的内存块，并且 30MB 的字符串将被复制多次。

有什么比以下解决方案更有效的吗？

```
$data = file_get_contents($tempFile); // perhaps 30MB of file data, now in PHP's memory
$hash = md5($data);
$query = "INSERT INTO some_table SET BlobData = '%s', BlobHash = '$hash'";
mysql_query(sprintf($query, mysql_real_escape_string($data))); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-18T09:06:43.010

您在这里有两个问题：

#1，有几种不同的方法可以计算 MD5 哈希：

*   像你一样做并作为字符串加载到 PHP 中并使用 PHP 的`md5()`
*   使用 PHP 的`md5_file()`
*   自 PHP 5.1+ 起，您可以将 PHP 的流 API 与其中一个`md5`或`md5_file`避免完全加载到内存中一起使用
*   用于`exec()`调用系统的`md5sum`命令
*   使用 MySQL 的`MD5()`函数计算哈希

由于这些实现起来都很简单，因此您可以轻松地实现它们并针对内存使用和速度对它们进行基准测试。以下是[一些基准](http://www.php.net/manual/en/function.md5-file.php#81751)，显示系统 md5 via随着文件大小`exec`的增加比 PHP 快得多。`md5_file`就内存使用而言，按照自己的方式做绝对是最糟糕的方式。

#2，`mysql_real_escape_string`执行数据库查询，因此您实际上是将 blob 数据传输到数据库，将其作为字符串返回，然后使用 INSERT 查询再次传输（！）。因此，它往返于数据库服务器 3 倍而不是 1 倍，并在 PHP 中使用 2 倍的内存。

[使用PHP5 准备好的语句](http://devzone.zend.com/node/view/id/686#Heading11)并且只将此数据发送到数据库一次会更有效。阅读链接文章部分，您会看到它提到在绑定参数时，您可以使用 blob 类型将 blob 数据以块的形式流式传输到 DB。[PHP 文档`mysqli_stmt::send_long_data`](http://www.php.net/manual/en/mysqli-stmt.send-long-data.php)有一个很好的简单示例，可以像您一样将文件插入到 blob 列中。

通过这样做，并使用流 API`md5_file`或`exec`系统 md5 命令，您可以执行整个 INSERT，而无需将整个文件加载到内存中，这意味着您的一系列操作的内存使用率可以尽可能低！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T07:07:01.660

如果您正在使用 PDO，并且准备好语句，则可以使用 PDO::PARAM_LOB 类型。请参阅 LOB 页面上的示例 #2，该示例显示了如何使用文件指针将图像插入数据库。

[http://us2.php.net/manual/en/pdo.lobs.php](http://us2.php.net/manual/en/pdo.lobs.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T07:04:13.367

您是否对输出缓冲技巧进行了基准测试？

```
ob_start();
echo 'INSERT INTO some_table SET BlobData = \'', mysql_real_escape_string( $data ), '\', BlobHash = \'', $hash, '\'';
mysql_query( ob_get_clean() ); 
```

您可以做的另一件事是转换为支持绑定参数的 mysqli 或 MDB2。这将允许您跳过 mysql_real_escape_string 调用**和**字符串连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T02:03:18.357

如果您不将查询放入另一个变量中，而是将其直接传递到 MySQL 命令中，这会有什么不同吗？我从未尝试过，但它可能会有所不同，因为整个字符串没有存储在另一个变量中。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-17T07:06:33.750

好吧，如果内存使用是您的问题，您可以分块读取大文件并使用 CONCAT 将这些块插入数据库字段。

示例代码（未测试）：

```
 $id = 1337;
$h = fopen("path/to/file.ext", "r");
while (!feof($h)) 
    {
    $buffer = fread($h, 4096);
    $sql = "UPDATE table SET my_field = CONCAT(my_field, '" . mysql_real_escape_string($buffer) . "') WHERE Id = " . $id;
    mysql_query($sql);
    } 
```

这种方法会比较慢，但您只需要 4Kb 的内存。

# windows - Windows 是否为应用程序提供单调递增的时钟

> ID：211257
> 
> 赞同：13
> 
> 时间：2008-10-17T06:56:07.157
> 
> 标签：windows, time, timer

这个问题的灵感来自[Linux 是否为应用程序提供了单调递增的时钟](https://stackoverflow.com/questions/211055/does-linux-provide-a-monotonically-increasing-clock-to-applications)。

也许我应该更准确一点：我正在寻找一个[严格增加](http://en.wikipedia.org/wiki/Monotonic_function)的时钟函数，因此永远不会返回相同的值，这与两个调用彼此跟随的速度无关。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-17T07:01:29.487

是的，[`GetTickCount()`](http://msdn.microsoft.com/en-us/library/ms724408(VS.85).aspx)这样做。如果您想要更高保真度的计数器，[`QueryPerformanceCounter`](http://msdn.microsoft.com/en-us/library/ms644904(VS.85).aspx)也可以使用。这些计数器都不取决于一天中的时间。

# web-services - 使用 MS Access 在 Web 服务器中返回按需报告？

> ID：211258
> 
> 赞同：1
> 
> 时间：2008-10-17T06:56:25.877
> 
> 标签：web-services, iis, ms-access, automation

我已经构建了一个 MS Access 2007 应用程序，它可以创建各种格式（PDF、XLS、CSV、XML）的报告文件。
我希望允许从网页访问这些报告的创建，用户只需单击链接并下载我的 Access 应用程序生成的报告。

我想保持简单，现阶段我对重写 .Net 中的数据处理不感兴趣。我只是想找到一种方法来自动创建用户报告以返回可以下载的文件。
从本质上讲，我的 Access 应用程序将充当某种 Web 服务。

Web 服务器是 Windows 2003 上的 IIS。

欢迎任何指示或想法。我不精通 IIS 管理或 ASP 页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T07:48:55.507

我能想到的第一个快速而肮脏的方法是从 shell 调用 Access 并传递一些参数以只读方式打开并运行宏。

该宏必须从某个地方（可能是环境变量）提取它的报告参数，运行报告并将其保存为 Excel、PDF 或其他任何唯一名称。为此，您需要传递报告名称、唯一的请求 ID 和参数数组来处理多个（或无）参数。

最后但并非最不重要的一点是，您的 Access 宏/VBA Sub 需要关闭访问。

这不是一个好的解决方案，因为每个请求启动一个 Access 副本并不是真正可取的。

另一种选择是使用在打开时启动的 VBA 子程序在服务器上启动 Access。该子程序可以轮询一个目录以查找由您的 Web 服务器编写的请求。然后在收到请求时运行报告并将其写入某处。同样，您必须以唯一的请求 ID 为基础。

我不确定哪个“解决方案”会更好.... Access 作为命令行报告生成器或 Access 作为批处理报告服务。两者都会令人讨厌，但会让您度过难关，直到您可以迁移到报告服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T07:17:39.393

这是一种实现您所要求的方法的回合。您可以使用包含报告服务组件的 sql server express 2005 或 2008 高级版的免费版本。使用报告生成工具，您可以将您的 access 2007 报告转换为 sql server 报告，并让这些报告从 access 数据库中获取。如果您想走这条路，您也可以将数据库迁移到 sql server。报告服务将生成 pdf、xls、csv 和 xml 格式作为报告的输出，您只需将 url 中的参数传递给服务器，服务器就会以请求的格式返回您的报告。

sql server 2008 express 高级版链接：

[http://www.microsoft.com/express/sql/download/](http://www.microsoft.com/express/sql/download/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T09:05:05.853

如果您不想在 .Net 中重写，那么 Classic ASP 和 VBScript 怎么样？VBScript 与 VBA 有很多共同之处，因此创建可用的东西应该不会花很长时间，并且 Internet 上有很多关于 ASP 和 VBScript 的帮助。例如，一个简单的搜索返回了这种使用 Adob​​e 从 ASP 创建 PDF 的方法：

[使用 ASP 创建 PDF](http://www.15seconds.com/issue/990902.htm)

# regex - 如何使用 Perl 提取和保存文本？

> ID：211260
> 
> 赞同：1
> 
> 时间：2008-10-17T07:00:27.913
> 
> 标签：regex, perl, text, extract

没有提取的数据输出到 data2.txt？代码出了什么问题？

**我的文件.txt**

```
ex1,fx2,xx1
mm1,nn2,gg3
EX1,hh2,ff7 
```

这是我在 data2.txt 中想要的输出：

```
ex1,fx2,xx1
EX1,hh2,ff7 
```

```
#! /DATA/PLUG/pvelasco/Softwares/PERLINUX/bin/perl -w

my $infile  ='My1.txt';
my $outfile ='data2.txt';

open IN,  '<', $infile  or die "Cant open $infile:$!";
open OUT, '>', $outfile or die "Cant open $outfile:$!";

while (<IN>) {   
  if (m/EX$HF|ex$HF/) {
    print OUT $_, "\n";      
    print $_;   
  }
}

close IN;
close OUT; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T07:10:53.010

这个正则表达式没有意义：

```
m/EX$HF|ex$HF/ 
```

$HF 应该是一个变量吗？你想匹配什么？

*此外，您编写的每个*Perl 脚本的第二行应该是：

```
use strict; 
```

它会让 Perl 捕捉到这些错误并告诉你它们，而不是默默地忽略它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T07:12:22.787

```
while (<IN>) {
  if (m/^(EX|ex)\d.*/) {   
    print OUT "$_";      
    print $_;   
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-18T08:03:45.867

抱歉，如果这似乎表明流血很明显，但有什么问题

```
grep -i ^ex < My1.txt > data2.txt 
```

...或者如果您真的想在 perl 中执行此操作（这并没有错）：

```
perl -ne '/^ex/i && print' < My1.txt > data2.txt 
```

这假设请求的目的是查找以 EX 开头的行，不区分大小写。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T17:58:06.040

文件名不匹配。

```
open(my $inhandle, '<', $infile)   or die "Cant open $infile: $!";
open(my $outhandle, '>', $outfile) or die "Cant open $outfile: $!";

while(my $line = <$inhandle>) {   

    # Assumes that ex, Ex, eX, EX all are valid first characters
    if($line =~ m{^ex}i) {         # or   if(lc(substr $line, 0 => 2) eq 'ex') {
        print { $outhandle } $line;      
        print $line;
    }
} 
```

是的，**总是** *使用严格的；*

你也可以*chomp $line*并且（如果使用 perl 5.10）*说 $line*而不是*print "$line\n"*。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T07:05:11.337

当我运行您的代码时，但命名输入文件`My1.txt`而不是`MyFile.txt`我得到所需的输出 - 除了空行，您可以通过`, "\n"`从 print 语句中删除来删除。

# security - 停止存储访问？

> ID：211263
> 
> 赞同：1
> 
> 时间：2008-10-17T07:03:56.143
> 
> 标签：security, usb, storage, file-permissions

出于安全原因（保护知识产权），我正在尝试构建一种方法来防止某些硬盘驱动器分区/ USB 驱动器被访问。我在想，当 Windows 尝试访问“锁定的驱动器/USB”时，尝试停止并返回“驱动器无法访问”之类的东西。这只是一个想法，有人认为这是合理/可能的吗？如果是这样，任何指针？

C/C++

-谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T08:39:57.057

分区问题很简单。只需使用 ACL 来阻止某些用户的访问。

对于驱动器访问，Windows 中的某处可能有一些设置可以禁用它。在更糟糕的情况下，您可以尝试强行删除驱动程序（以及 Windows 读取驱动器/棒的能力）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-19T08:44:58.073

您将需要编写一个[过滤器驱动程序](http://en.wikipedia.org/wiki/Filter_driver)来实现您的目标。您需要将驱动程序放在磁盘驱动程序堆栈中的某个位置，并使您要阻止的驱动器/分区的 IRP_MN_START_DEVICE 失败。

您将需要[Windows Driver Kit](http://www.microsoft.com/whdc/ddk/winddk.mspx)来编写驱动程序。WDK 中有一个过滤器驱动程序示例。这个[邮件列表](http://www.osronline.com/cf.cfm?PageURL=showlists.CFM?list=NTDEV)非常有用，如果您搜索档案，您会发现很多关于磁盘过滤器驱动程序的信息。
一篇关于编写过滤器驱动程序的好文章在[这里](http://www.osronline.com/article.cfm?article=446)，我认为您需要注册才能阅读，但是如果您想编写驱动程序，您应该在此站点上注册。
相关的书单可以在[这里](http://www.amazon.com/Windows-Kernel-Programming-Collection/lm/R1UMVPGFE45T4U)找到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T07:12:12.103

对于 USB 驱动器，您可以对其进行加密。

在工作中，我们使用[Pointsec 提供程序](http://www.checkpoint.com/products/datasecurity/protector/)，它允许您只有在有密码的情况下才能访问任何机器上的驱动器。

我确信有可用的免费软件加密产品

您也可以加密分区。

（基本上我不确定为什么要为可以通过其他方法充分管理的东西编写一些 c/c++ 代码）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T13:09:08.310

您需要对驱动器进行加密，否则攻击者只需将驱动器附加到另一台机器并提取内容即可。

您不应该自己实施加密 - 依靠别人审查过的代码要好得多。我建议使用[TrueCrypt](http://www.truecrypt.org/)来加密你的驱动器。

然后也许你想在你的应用程序中放置一个钩子，以便在它想要访问加密数据时提示输入密码。或者您在机器上安装 TrueCrypt，并让用户在他们想要访问数据时连接驱动器，这取决于使用数据的精确方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T10:30:24.180

意识到。任何涉及内核工作的东西，如果您还没有该领域的经验，那么开发时间都会以年为单位。

# unix - 跟踪路由如何工作？

> ID：211270
> 
> 赞同：18
> 
> 时间：2008-10-17T07:05:23.940
> 
> 标签：unix, networking, traceroute

这似乎几乎是神奇的。为了将整个路径映射到 Internet 上的某个其他节点，traceroute 命令做了什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-17T07:08:07.820

traceroute 将 TTL（生存时间）字段设置为 1，并为每一跳递增。收到消息的路由器会减少这个值，当它达到 0 时，它们会回复一条消息，说明 TTL 已达到零。有了这个回复，客户就知道谁在两者之间。反复执行此操作，直到您的目的地获得（至少其中一个）路线

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-17T07:22:31.240

Traceroute 传输具有小 TTL（生存时间）值的数据包。TTL 是一个 IP 头字段，用于防止数据包陷入无限循环。当处理数据包的路由器从数据包的 TTL 中减去 1 时。数据包过期并在 TTL 达到零时被丢弃。

发生这种情况时，Traceroute 会将 ICMP Time Exceeded 消息 ( [RFC 792](http://www.faqs.org/rfcs/rfc792.html) ) 发送回发送者。通过使用较小的 TTL 值，数据包将很快过期，因此 traceroute 会导致数据包路径上的所有路由器生成标识路由器的 ICMP 消息。

例如，TTL = 1 应该从第一个路由器生成消息，TTL = 2 从路径中的第二个路由器生成消息，依此类推......

# maven-2 - Maven原型生成简单项目，包括站点

> ID：211278
> 
> 赞同：3
> 
> 时间：2008-10-17T07:08:51.907
> 
> 标签：maven-2, maven-archetype

是否有一个 Maven 原型会生成与 相同的脚手架`maven-archetype-quickstart`，但还会创建由 生成的基本项目站点布局`maven-archetype-site`？还是我总是必须按顺序运行每个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T15:19:14.460

我认为[AppFuse](http://appfuse.org/)通常是开始新 Java 项目时使用的正确工具。[有关示例，](http://appfuse.org/display/APF/AppFuse+QuickStart)请参阅快速入门。

我认为该站点不会从最初的 AppFuse 生成中生成，但一个简单的`mvn site`将创建基本的网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T03:39:33.017

我只知道站点的 2 个 Maven 原型：

*   Maven 原型站点
*   maven-archetype-simple

我想知道他们在 Apache 中使用什么模板。

# iis - 选择 gzip 而不是 deflate 进行 http 压缩是否会影响性能？

> ID：211284
> 
> 赞同：16
> 
> 时间：2008-10-17T07:13:32.987
> 
> 标签：iis, gzip, sysadmin, http-compression, deflate

我们最近将我们的一些站点从 deflate 切换到 gzip，并注意到我们服务器上的 CPU 负载显着增加。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-17T07:25:56.007

您是否可能遇到缓存未命中？也就是说，压缩内容有时会被缓存压缩，但切换压缩方案会（或至少应该）使缓存无效，从而导致 CPU 利用率显着增加。你试过换回来吗？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-17T07:18:52.510

gzip 基本上是用一些额外的头文件放气的。所以不应该有显着的性能影响。现在，也许你的 deflate 工具比你的 gzip 工具更有效。您是使用相同的工具进行两次压缩还是两种不同的压缩？

# plugins - 在哪里可以找到 Resharper 的插件？

> ID：211298
> 
> 赞同：5
> 
> 时间：2008-10-17T07:19:26.767
> 
> 标签：plugins, resharper

有人知道找到 Resharper 插件的好地方吗？最好是比谷歌更有条理的地方……谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-17T07:22:24.407

[ReSharper Gallery](https://resharper-plugins.jetbrains.com/)包含许多包。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T18:55:17.423

[这里](http://resharper.blogspot.com/2008/04/extending-extension-resharper-plug-ins.html)还有一些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T07:22:06.183

在部分（自我）回答中，Resharper 网站本身的列表是一个好的开始。是否有任何地方讨论可用的插件，哪些是值得的？

# .net - 无法保存实体框架继承的类型

> ID：211299
> 
> 赞同：4
> 
> 时间：2008-10-17T07:19:33.303
> 
> 标签：.net, entity-framework, inheritance, savechanges, table-per-type

我已经在我的数据模型中实现了一些 table-per-type 继承（基本上有一个`BaseEntity`包含我的项目的所有基本信息的`Employer`类型和一个从`BaseEntity`项目继承的类型）。一切似乎都设置正确，并且在使用实体时（通过 ADO.net 数据服务或通过 Linq to Entities）我可以看到`Employer`类型并且事情似乎很好。当我创建一个新`Employer`实体并尝试保存它时，问题就开始了。

在似乎不是`.AddToEmployer`项目的上下文中（只有 and `AddObject`or `AddToBaseEntity`）。

如果我使用`AddObject("Employer", NewEmployer)`，我会收到以下错误消息：

> 找不到实体集名称“DataEntities.Employer”。

如果我使用`AddToBaseEntity(NewEmployer)`，我会收到以下错误消息：

> 无法确定相关操作的有效排序。由于外键约束、模型要求或存储生成的值，可能存在依赖关系。

我是否错过了设置继承的步骤？是否有一些特定的方法来保存继承的对象？我究竟做错了什么？我认为基本问题是我应该有一个`AddToEmployer`，我需要做什么才能暴露它？这似乎很奇怪，因为我可以在客户端看到 Employer 类型并且可以执行以下操作：

`var NewEmployer = new Employer()`- 这似乎表明我可以很好地看到 Employer 类型。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-15T19:45:39.717

我的名字是 Phani，我在 ADO.NET 数据服务团队工作。

和方法用于帮助您自定义客户端在发送到服务器的有效负载中写入的类型信息以及如何实现来自服务器的响应有效负载`ResolveName`。`ResolveType`

它们可以帮助您解析客户端上的类型，并且在许多场景中都很有用，例如：

1.  与服务器相比，实体的类型层次结构在客户端上是不同的。
2.  服务公开的实体类型参与继承，您希望在客户端上使用派生类型。

`ResolveName`用于更改我们在向服务器发出请求时放置在网络上的实体的名称。

考虑这个数据模型：在服务器上

```
public class Employee {
    public int EmployeeID {get;set;}
    public string EmployeeName {get;set;}
}

public class Manager:Employee {
    public List<int> employeesWhoReportToMe {get;set;}
} 
```

当您使用客户端处理 Manager Entity Type 的实例时，在将更改提交到服务器时，我们希望当实体参与继承时类型信息会出现在有效负载中。

```
context.AddObject("Employees",ManagerInstance ); <-- add manager instance to the employees set.
context.SaveChanges(); 
```

但是，当客户端序列化此有效负载时，它会将“Employee”作为类型名称输入，这不是服务器所期望的。因此，您必须在客户端上提供名称解析器，

```
context.ResolveName = delegate(Type entityType){
    //do what you have to do to resolve the type to the right type of the entity on the server
    return entityType.FullName;
} 
```

以相同的方式使用类型解析器。

```
context.ResolveType = delegate(string entitySetName){
    //do what you have to do to convert the entitysetName to a type that the client understands
    return Type.GetType(entitySetName);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T09:44:29.517

那么你只得到一个实体集pr。基类，所以 .AddToBaseEntity 就是这样的解决方案。

但是听起来您的模型中有循环依赖，因此实体框架无法确定以哪个顺序保存。

检查您的派生实体上的基础实体是否具有外键并更新您的模型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T04:19:52.213

我改变了一些东西，并且能够让它工作。我不是特别确定基本问题是什么，但想发布我所做的事情以供参考。

重建表：我只从 ID/Key 列和单个数据列开始重建表。

删除了额外的自动递增字段：我在 BaseEntity 和 Employer 上有一个自动递增的 ID。我删除了 Employer 上的自动递增 ID，只是将 Employer.BaseEntityID 列和外键返回到 BaseEntity.BaseEntityID。（这似乎是罪魁祸首，但我的印象是这是允许的）

不幸的是，这会导致实体框架中的继承类不能具有导航属性（所有导航属性都必须在基础实体上）的问题，因此继承将被证明无法满足我们的需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T07:43:49.183

您没有将 Employer 定义为实体集，就像实体类型一样。这就是您在上下文对象中缺少 AddToEntity 的方式。一个类层次结构总是有一个实体集，在这种情况下，它是 BaseClass 实体集。

如果要获取实体集“雇主”，可以尝试手动编辑 edmx 文件并添加新实体集“雇主”，然后将实体类型“雇主”设置为属于该实体集。这应该不难，我已经做过很多次了。

我不确定是否有更常规的解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-23T16:41:24.150

两年多之后，但为了保持它与搜索流量的相关性，这是我在一个便利类中快速解决这个问题的一种方法，我们用它来快速用暂存数据填充我们的数据库。

不确定早期版本，但 Entity Framework 4 允许您将对象作为基础对象转储到上下文中，然后框架计算出服务器端引用。因此，您不会使用 AddToInheritedObjects() （无论如何都已弃用），而是使用 ObjectSet<>.Add() 方法。

这是一个帮助类示例：

```
public ContextHelper
{
        …
        _context = ModelEntities();

        public T Create<T>() where T : class
        {
            // Create a new context
            _context = new ModelEntities();

            // Create the object using the context (can create outside of context too, FYI)
            T obj = _context.CreateObject<T>();

            // Somewhat kludgy workaround for determining if the object is
            // inherited from the base object or not, and adding it to the context's
            // object list appropriately.    
            if (obj is BaseObject)
            {
                _context.AddObject("BaseObjects", obj);
            }
            else
            {
                ObjectSet<T> set = _context.CreateObjectSet<T>();
                set.AddObject(obj);
            }

            return obj;
        }
        …
} 
```

因此，假设您有以下内容：

```
class ObjectOne : BaseObject {}
class ObjectTwo {} 
```

您可以轻松地将实体添加到上下文中：

```
ContextHelper ch = ContextHelper()
ObjectOne inherited = ch.Create<ObjectOne>();
ObjectTwo toplevel = ch.Create<ObjectTwo>();
… 
```

当然，请记住 ContextHelper 应该有一个公共的 Save() 方法，该方法调用 _context.SaveChanges()- 或者您应该有一些其他方式将对象更改推送到数据存储区。

这可能不是对任何关于继承的给定问题的直接回应，但希望为人们提供一个回答细节的起点。

# java - Java 数组的长度属性的数据类型是什么？

> ID：211311
> 
> 赞同：13
> 
> 时间：2008-10-17T07:28:24.457
> 
> 标签：java, types, limits

我想知道 Java 数组的长度属性是 int/long 还是别的什么。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-17T07:31:09.660

它是一个整数。请参阅[Java 语言规范](http://java.sun.com/docs/books/jls/third_edition/html/arrays.html#10.7)，第 10.7 节。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T07:37:58.540

在[Java 语言规范中，](http://java.sun.com/docs/books/jls/third_edition/html/arrays.html)您可以在 10.4 中看到的数组：

> 数组必须由 int 值索引；short、byte 或 char 值也可以用作索引值，因为它们经过一元数字提升并成为 int 值。尝试访问具有长索引值的数组组件会导致编译时错误。

我找不到长度属性的类型，但它至少是一个 int；如果它很长，那么您将无法访问超出最大整数长度的元素。

所以我想这是一个（最终的）int。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T07:36:29.387

根据[规范](http://java.sun.com/docs/books/jls/second_edition/html/arrays.doc.html#62964)，这是一个`int`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T07:34:30.717

数据类型是**int**，不是 long 。与索引相同。

见[http://java.sun.com/docs/books/jls/second_edition/html/arrays.doc.html](http://java.sun.com/docs/books/jls/second_edition/html/arrays.doc.html) , 10.4

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T13:59:37.770

在 JavaCard 中，数组索引很短，但 JavaCard 很奇怪。在其他任何地方，int 就像其他人所说的那样。

# wpf - WPF 数据绑定和级联转换器？

> ID：211319
> 
> 赞同：11
> 
> 时间：2008-10-17T07:33:23.697
> 
> 标签：wpf, data-binding, xaml, binding, converter

我想知道在使用 wpf 数据绑定时是否可以级联转换器。例如类似的东西

```
<SomeControl Visibility="{Binding Path=SomeProperty, Converter={StaticResource firstConverter}, Converter={StaticResource secondConverter}}"/> 
```

有可能还是我必须创建一个结合转换器A和B功能的自定义转换器？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-17T11:34:43.757

您可能正在寻找类似于 Josh Smith 的“[管道值转换器](http://www.codeproject.com/KB/WPF/PipingValueConverters_WPF.aspx)”的解决方案。

在他的文章中，他介绍了以下内容：

```
<local:ValueConverterGroup x:Key="statusDisplayNameGroup">
  <local:IntegerStringToProcessingStateConverter  />
  <local:EnumToDisplayNameConverter />
</local:ValueConverterGroup> 
```

然后使用多值转换器如下：

```
<TextBlock Text="{Binding XPath=@Status, 
             Converter={StaticResource statusDisplayNameGroup}}" /> 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-17T11:55:24.730

您可以尝试使用**MultiBinding**，并将两次绑定到同一个源，但在单个绑定上使用不同的转换。就像是：

```
<SomeControl>
    <SomeControl.Visibility>
        <MultiBinding Converter="{StaticResource combiningConverter}">
            <Binding Path="SomeProperty" Converter="{StaticResource firstConverter}"/>
            <Binding Path="SomeProperty" Converter="{StaticResource secondConverter}"/>
        </MultiBinding>
    </SomeControl.Visibility>
</SomeControl> 
```

然后在“ *combineConverter* ”中，您将逻辑组合来自两个绑定的值。

# mysql - 从mysql中的大表中快速选择随机行

> ID：211329
> 
> 赞同：48
> 
> 时间：2008-10-17T07:38:24.577
> 
> 标签：mysql, sql, select, random

从大型 mysql 表中选择随机行的快速方法是什么？

我正在使用 php，但我对任何解决方案都感兴趣，即使它是另一种语言。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-10-17T07:42:27.313

获取所有 id，从中随机选择一个，然后检索整行。

如果你知道 id 是连续的，没有孔，你可以抓住最大值并计算一个随机的 id。

如果这里和那里有洞，但主要是顺序值，并且您不关心稍微偏斜的随机性，请获取最大值，计算 id，然后选择 id 等于或高于您计算的第一行。倾斜的原因是 id 跟随这样的洞将比跟随另一个 id 的洞更有可能被选中。

如果您随机订购，您将面临可怕的表格扫描，并且“*快速*”一词不适用于此类解决方案。

不要那样做，也不应该按 GUID 订购，它也有同样的问题。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-10-17T08:19:30.890

我知道必须有一种方法可以在单个查询中快速完成。这里是：

一种无需外部代码参与的快速方法，赞

[http://jan.kneschke.de/projects/mysql/order-by-rand/](http://jan.kneschke.de/projects/mysql/order-by-rand/)

```
SELECT name
  FROM random AS r1 JOIN
       (SELECT (RAND() *
                     (SELECT MAX(id)
                        FROM random)) AS id)
        AS r2
 WHERE r1.id >= r2.id
 ORDER BY r1.id ASC
 LIMIT 1; 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-10-18T04:39:21.317

MediaWiki 使用了一个有趣的技巧（用于 Wikipedia 的 Special:Random 功能）：包含文章的表有一个带有随机数的额外列（在创建文章时生成）。要获得一篇随机文章，请生成一个随机数，并在随机数列中获取具有下一个更大或更小（不记得是哪个）值的文章。使用索引，这可以非常快。（而且 MediaWiki 是用 PHP 编写并为 MySQL 开发的。）

如果结果数字分布不均，这种方法可能会导致问题；IIRC，这已在 MediaWiki 上修复，因此如果您决定这样做，您应该查看代码以了解它当前是如何完成的（可能他们会定期重新生成随机数列）。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-10-17T18:16:48.873

这是一个运行相当快的解决方案，它获得了更好的随机分布，而不依赖于连续的 id 值或从 1 开始。

```
SET @r := (SELECT ROUND(RAND() * (SELECT COUNT(*) FROM mytable)));
SET @sql := CONCAT('SELECT * FROM mytable LIMIT ', @r, ', 1');
PREPARE stmt1 FROM @sql;
EXECUTE stmt1; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-26T22:15:52.187

也许您可以执行以下操作：

```
SELECT * FROM table 
  WHERE id=
    (FLOOR(RAND() * 
           (SELECT COUNT(*) FROM table)
          )
    ); 
```

这是假设您的身份证号码都是连续的，没有间隙。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-26T22:17:12.217

向每一行添加一个包含计算出的随机值的列，并在排序子句中使用它，在选择时限制为一个结果。这比`ORDER BY RANDOM()`导致表扫描更快。

**更新：**`SELECT`当然，您仍然需要在检索时发出语句之前计算一些随机值，例如

```
SELECT * FROM `foo` WHERE `foo_rand` >= {some random value} LIMIT 1 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-23T09:10:27.933

为了从给定的表中选择多个随机行（比如“单词”），我们的团队想出了这个美丽：

```
SELECT * FROM
`words` AS r1 JOIN 
(SELECT  MAX(`WordID`) as wid_c FROM `words`) as tmp1
WHERE r1.WordID >= (SELECT (RAND() * tmp1.wid_c) AS id) LIMIT n 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-11-30T21:01:18.110

还有另一种方法可以只使用查询而不用 rand() 排序来生成随机行。它涉及用户定义的变量。了解[如何从表中生成随机行](http://www.mysqldiary.com/how-to-produce-random-rows-from-a-table/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-05-31T20:53:12.610

如果您不删除此表中的行，最有效的方法是：

（如果你知道最小 id 就跳过它）

```
SELECT MIN(id) AS minId, MAX(id) AS maxId FROM table WHERE 1

$randId=mt_rand((int)$row['minId'], (int)$row['maxId']);

SELECT id,name,... FROM table WHERE id=$randId LIMIT 1 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-01-25T13:50:39.307

为了从表中找到随机行，不要使用 ORDER BY RAND() 因为它强制 MySQL 进行完整的文件排序，然后才检索所需的限制行数。为了避免这种完整的文件排序，请仅在 where 子句中使用 RAND() 函数。一旦达到所需的行数，它将立即停止。见 [http://www.rndblog.com/how-to-select-random-rows-in-mysql/](http://www.rndblog.com/how-to-select-random-rows-in-mysql/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-02-22T09:22:38.323

我在这里看到了很多解决方案。一两个似乎还可以，但其他解决方案有一些限制。但是以下解决方案适用于所有情况

```
select a.* from random_data a, (select max(id)*rand() randid  from random_data) b
     where a.id >= b.randid limit 1; 
```

这里，id，不需要是顺序的。它可以是任何主键/唯一/自动增量列。请参阅以下[从 MySQL 大表中选择随机行的最快方法](http://www.techinfobest.com/fastest-way-to-select-a-random-row-from-a-big-mysql-table/)

谢谢 Zillur - [www.techinfobest.com](http://www.techinfobest.com)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-27T13:12:13.937

经典的“SELECT id FROM table ORDER BY RAND() LIMIT 1”其实没问题。

请参阅 MySQL 手册的以下摘录：

*如果将 LIMIT row_count 与 ORDER BY 一起使用，MySQL 会在找到排序结果的第一个 row_count 行后立即结束排序，而不是对整个结果进行排序。*

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-17T07:39:09.333

一种简单但缓慢的方法是（适用于小桌子）

```
SELECT * from TABLE order by RAND() LIMIT 1 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-17T07:44:40.040

用一个命令你会做一个完整的扫描表。最好是执行 select count(*) 并稍后在 0 和最后一个注册表之间获得一个随机 row=rownum

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-17T07:53:46.277

在伪代码中：

```
sql "select id from table"
store result in list
n = random(size of list)
sql "select * from table where id=" + list[n] 
```

这假定这`id`是一个唯一的（主）键。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-19T22:27:28.230

我对 SQL 有点陌生，但是如何在 PHP 中生成一个随机数并使用

```
SELECT * FROM the_table WHERE primary_key >= $randNr 
```

这并不能解决桌子上有洞的问题。

但这是对 lassevks 建议的一个转折：

```
SELECT primary_key FROM the_table 
```

在 PHP 中使用 mysql_num_rows() 根据上述结果创建一个随机数：

```
SELECT * FROM the_table WHERE primary_key = rand_number 
```

附带说明一下有多慢`SELECT * FROM the_table`：
根据数据指针创建一个随机数`mysql_num_rows()`，然后将数据指针移动到该点`mysql_data_seek()`。在有一百万行的大表上，这会有多慢？

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-20T22:07:50.487

看看Jan Kneschke的[这个链接或](http://jan.kneschke.de/projects/mysql/order-by-rand/)[这个 SO answer](https://stackoverflow.com/questions/211329/quick-selection-of-a-random-row-from-a-large-table-in-mysql)，因为他们都讨论了同一个问题。SO的答案也涵盖了各种选项，并根据您的需要提供了一些很好的建议。Jan 回顾了所有不同的选项以及每个选项的性能特征。他最终得到了以下在 MySQL 选择中执行此操作的最优化方法：

```
SELECT name
  FROM random AS r1 JOIN
       (SELECT (RAND() *
                     (SELECT MAX(id)
                        FROM random)) AS id)
        AS r2
 WHERE r1.id >= r2.id
 ORDER BY r1.id ASC
 LIMIT 1; 
```

高温下，

-蘸

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-05-30T22:37:58.937

我遇到了我的 ID 不连续的问题。我想出了这个。

```
SELECT * FROM products WHERE RAND()<=(5/(SELECT COUNT(*) FROM products)) LIMIT 1 
```

返回的行大约为 5，但我将其限制为 1。

如果您想添加另一个 WHERE 子句，它会变得更有趣。假设您要搜索打折产品。

```
SELECT * FROM products WHERE RAND()<=(100/(SELECT COUNT(*) FROM pt_products)) AND discount<.2 LIMIT 1 
```

您要做的是确保返回足够的结果，这就是我将其设置为 100 的原因。在子查询中使用 WHERE discount<.2 子句会慢 10 倍，因此最好返回更多结果和限制。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-02-24T06:17:56.113

使用以下查询获取随机行

```
SELECT user_firstname ,
COUNT(DISTINCT usr_fk_id) cnt
FROM userdetails 
GROUP BY usr_fk_id 
ORDER BY cnt ASC  
LIMIT 1 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-05-15T14:27:49.570

在我的情况下，我的表有一个 id 作为主键，自动递增，没有间隙，所以我可以使用`COUNT(*)`or`MAX(id)`来获取行数。

我制作了这个脚本来测试最快的操作：

```
logTime();
query("SELECT COUNT(id) FROM tbl");
logTime();
query("SELECT MAX(id) FROM tbl");
logTime();
query("SELECT id FROM tbl ORDER BY id DESC LIMIT 1");
logTime(); 
```

结果是：

*   数数：`36.8418693542479 ms`
*   最大限度：`0.241041183472 ms`
*   **订购**：`0.216960906982 ms`

用订购方法回答：

```
SELECT FLOOR(RAND() * (
    SELECT id FROM tbl ORDER BY id DESC LIMIT 1
)) n FROM tbl LIMIT 1

...
SELECT * FROM tbl WHERE id = $result; 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-03-12T16:36:30.473

我已经使用了这个，并且工作已经完成了[这里的参考](https://www.warpconduit.net/2011/03/23/selecting-a-random-record-using-mysql-benchmark-results/)

```
SELECT * FROM myTable WHERE RAND()<(SELECT ((30/COUNT(*))*10) FROM myTable) ORDER BY RAND() LIMIT 30; 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-03-29T18:58:45.243

创建一个函数来做这个很可能是最好的答案和最快的答案！

优点 - 即使有间隙也能工作，而且速度极快。

```
<?

$sqlConnect = mysqli_connect('localhost','username','password','database');

function rando($data,$find,$max = '0'){
   global $sqlConnect; // Set as mysqli connection variable, fetches variable outside of function set as GLOBAL
   if($data == 's1'){
     $query = mysqli_query($sqlConnect, "SELECT * FROM `yourtable` ORDER BY `id` DESC LIMIT {$find},1");

     $fetched_data = mysqli_fetch_assoc($query);
      if(mysqli_num_rows($fetched_data>0){
       return $fetch_$data;
      }else{
       rando('','',$max); // Start Over the results returned nothing
      }
   }else{
     if($max != '0'){
        $irand = rand(0,$max); 
        rando('s1',$irand,$max); // Start rando with new random ID to fetch
     }else{

        $query = mysqli_query($sqlConnect, "SELECT `id` FROM `yourtable` ORDER BY `id` DESC LIMIT 0,1");
        $fetched_data = mysqli_fetch_assoc($query);
        $max = $fetched_data['id'];
        $irand = rand(1,$max);
        rando('s1',$irand,$max); // Runs rando against the random ID we have selected if data exist will return
     }
   }
 }

 $your_data = rando(); // Returns listing data for a random entry as a ASSOC ARRAY
?> 
```

请记住，此代码未经测试，但它是一个工作概念，即使有间隙也可以返回随机条目。只要间隙不足以导致加载时间问题。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2008-10-18T05:18:07.120

# 快速而肮脏的方法：

```
SET @COUNTER=SELECT COUNT(*) FROM your_table;

SELECT PrimaryKey
FROM your_table
LIMIT 1 OFFSET (RAND() * @COUNTER); 
```

对于 MyISAM 表，第一个查询的复杂度是 O(1)。

第二个查询伴随着表全扫描。复杂度 = O(n)

# 又脏又快的方法：

仅为此目的保留一个单独的表格。每当插入原始表时，您还应该向该表插入相同的行。假设：没有删除。

```
CREATE TABLE Aux(
  MyPK INT AUTO_INCREMENT,
  PrimaryKey INT
);

SET @MaxPK = (SELECT MAX(MyPK) FROM Aux);
SET @RandPK = CAST(RANDOM() * @MaxPK, INT)
SET @PrimaryKey = (SELECT PrimaryKey FROM Aux WHERE MyPK = @RandPK); 
```

如果允许删除，

```
SET @delta = CAST(@RandPK/10, INT);

SET @PrimaryKey = (SELECT PrimaryKey
                   FROM Aux
                   WHERE MyPK BETWEEN @RandPK - @delta AND @RandPK + @delta
                   LIMIT 1); 
```

总体复杂度为 O(1)。

* * *

## 回答 #24

> 赞同：-2
> 
> 时间：2014-01-22T02:53:57.493

`SELECT DISTINCT * FROM yourTable WHERE 4 = 4 LIMIT 1;`

# javascript - 从js问题调用As函数

> ID：211335
> 
> 赞同：0
> 
> 时间：2008-10-17T07:42:40.120
> 
> 标签：javascript, flash

我有一个不受我控制的 swf 文件。swf 需要一个 javascript 调用在初始化后设置一些变量。

swf 是使用 swfobject 嵌入的，我试图在嵌入之后立即调用 as 函数。这似乎为时过早，因为我收到了一个错误。其他一切都应该没问题，因为通过 firebug 手动调用 as 函数不会产生错误。

所以问题是嵌入完成后如何调用该函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T08:57:26.930

您是否在页面仍在加载时执行此操作？或者来自 am onload 处理程序？如果它是内联 javascript，我建议您在 javascript 的 onload 处理程序中执行它，您可以这样做 -

```
window.onload = function() {
  // your code here 
} 
```

一旦页面完全加载，它将运行您的代码。

但是，这并不能保证闪存已初始化。您可以通过让闪存在它准备好后对 javascript 进行回调来做到这一点，但是您说 swf 不在您的控制范围内。我真的能想到我们使用 onload 方法来确保页面完成加载，然后在尝试使用它之前插入一个短暂的延迟。查看 setTimeout javascript 函数。虽然不是一个很好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-02T10:19:28.113

When integrating Flash and HTML / JavaScript, there are several common approaches, which have been designed to eliminate this problem.

1.  Pass in the variables as flashvars. They will be available to the flash movie immediately.

2.  When the flash has loaded, it should call out to your page, normally there is a contract that defines the methods you can / must implement for the flash movie to call. For example, it would state that it will call `MovieLoaded()` when the flash file has loaded, and you could then put any scripts dependent on the movie being loaded within this method...

    ```
    function MovieLoaded() {
        doSomething();
    } 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T06:59:18.367

我[找到了一些](http://www.idealog.us/2007/02/check_if_a_java.html)用于检查该函数是否存在的代码。总之：

```
if (typeof yourFunctionName == 'function') {
    yourFunctionName();
} 
```

那对你有用吗？如果是这样，那么您可以将其包裹在一个`while`循环中。比 setTimeOut 少一点讨厌！

# versions - 如何及时了解所有软件（本地和基于 Web）

> ID：211336
> 
> 赞同：1
> 
> 时间：2008-10-17T07:43:18.200
> 
> 标签：versions

当涉及到新的软件版本时，您如何保持最新状态？最重要的是，我指的是次要更新（Joomla 安装、论坛软件、FTP 客户端的新版本……）。

Versiontracker、RSS-Feeds、Newsletter……还有什么？有人为新版本或类似的东西写了一个脚本爬取网站吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T07:48:02.170

通常，您的操作系统会帮助您解决这些问题，至少在（大多数发行版的）Linux 中是这样。一旦某个软件以可安装包的形式提供并安装，您的包管理系统就会跟踪它，并且有可能发现有新版本可用。

例如，在[Gentoo Linux](http://www.gentoo.org/)中，您可以从命令行执行以下操作以获取可能的软件包更新列表：

```
emerge --sync && emerge -p world 
```

第一个命令确保您拥有可用软件包的最新列表，后者将所有已安装的软件包（您的“世界”）与列表进行比较，并以每个可安装软件包的一行报告。这些行包含您拥有的版本和可用的版本，因此您可以决定是否值得升级。

可能还有其他几种方法，这正是我使用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T08:03:00.843

在 Windows 上，许多安装程序会为您处理此问题，例如 InstallShield 更新管理器。就个人而言，我会禁用其中的大部分功能，直到我需要新功能或出现问题为止。原因是，如果我现有的设置运行良好，那么更新更有可能破坏它并给我带来痛苦，而不是增加价值。我喜欢拉更新，我不喜欢他们推送给我，例外是病毒扫描程序和基本安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T08:37:34.440

1.  经常光顾他们的新闻版块/博客/论坛，或
2.  通过 RSS，或
3.  通过在 Twitter 上关注负责人/开发人员/布道者。:)

# sql-server-2005 - 访问 SQL 副本

> ID：211341
> 
> 赞同：2
> 
> 时间：2008-10-17T07:45:04.860
> 
> 标签：sql-server-2005, ms-access

我们有一个 Access DB，它有一组本地表和输入表单等，用户在其中维护他们的数据。

我们还有一个带有相同表的 SQL DB，用于在 Web 搜索表单中显示数据。

允许用户更新他对 SQL 数据库的更改同时将工作副本保持在本地以便他可以脱机工作然后在他对新版本的数据感到满意时推送文件的最佳方法是什么？

我的第一个想法是将 SQL 表添加为链接表，然后我可以截断（访问确实如此）或删除每个表中的内容，然后为每个表执行插入操作。

我可以通过访问 SQL 调用 SP 来截断表，因为我在运行删除时遇到问题

我真的很想把它归结为运行可重复的宏/sql调用等的用户。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T09:46:38.733

您应该能够使用 ADODB.Command 对象来执行存储过程。

编辑：

此示例复制自[Using ADO in VB and Access](http://blogs.msdn.com/selvar/archive/2007/11/11/using-ado-in-vb-and-access.aspx)

```
Sub ADO_COMMAND_CONNECTION_TEST()
Dim cmd As New ADODB.Command
Dim rs As ADODB.Recordset
Dim strConn As String

    cmd.ActiveConnection = " DRIVER={SQL Server};" & _
      "Server=UKDUDE;DATABASE=pubs;UID=sa;PWD=;"
    cmd.CommandText = "byroyalty"
    cmd.CommandType = adCmdStoredProc
    cmd.Parameters.Refresh
    cmd.Parameters(1).Value = 25

    Set rs = cmd.Execute

' Recordset now has authors with 25% royalty.....

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T09:47:26.047

永远不要将 MS Access 链接表与 MS SQL 一起使用。

它们不仅速度慢，而且 Access 可以在引用的表上留下开放的客户端写入游标。这是一种创建大量死锁的非常愚蠢的方法，但 Access 无论如何都会这样做。

Microsoft 在添加 Access 数据项目时显着改进了这一点——在这些项目中，整个后端都被 SQL 取代，而 Access 只提供表单。

如果您希望用户操作直接回写，那么 ADP 是迄今为止最好的方法。

If you want to cache changes locally in your Access DB and then send them up to SQL you have a far more complex problem. You will need to be far more specific on exactly how you want synchronisation to happen - for instance if two users make offline changes who wins when they connect?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-19T15:51:47.310

I don't understand why you just don't link directly to the SQL Server data and use it directly, rather than going to the trouble of maintaining a second copy of it. This is the standard Access way to do things -- why are you resisting the natural capabilities of the tool you're using?

# php - 在 PHP 中处理大数

> ID：211345
> 
> 赞同：58
> 
> 时间：2008-10-17T07:49:15.180
> 
> 标签：php, bignum

要像在对大数（100,000+）使用[费马素性检验时所需的那样使用](http://en.wikipedia.org/wiki/Fermat_primality_test)[模幂运算](http://en.wikipedia.org/wiki/Modular_exponentiation)，它需要一些非常大的计算。

当我将两个大数（例如：62574 和 62574）相乘时，PHP 似乎将结果转换为浮点数。获取它的模值会返回奇怪的值。

```
$x = 62574 * 62574;
var_dump($x);          // float(3915505476) ... correct
var_dump($x % 104659); // int(-72945)  ... wtf. 
```

有没有办法让 PHP 正确执行这些计算？或者，是否有另一种方法可以找到适用于大数的模值？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-10-17T09:35:02.843

出于某种原因，PHP 中有两个标准库可以处理任意长度/精度的数字：[BC Math](http://www.php.net/manual/en/book.bc.php)和[GMP](http://www.php.net/manual/en/book.gmp.php)。我个人更喜欢 GMP，因为它更新鲜，API 更丰富。

基于 GMP，我实现[了 Decimal2 类](https://github.com/ikr/money-math-php)来存储和处理货币金额（如 100.25 美元）。*有很多*mod 计算没有任何问题。用*非常*大的数字进行测试。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2011-05-17T06:23:17.837

用这个

```
 $num1 = "123456789012345678901234567890";
 $num2 = "9876543210";
 $r    = mysql_query("Select @sum:=$num1 + $num2");
 $sumR = mysql_fetch_row($r);
 $sum  = $sumR[0]; 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-10-17T08:10:16.057

你看过[`bcmod()`](http://php.net/manual/en/function.bcmod.php)吗？php 在 32 位平台上存在整数超过 2^31 - 1 的问题。

```
var_dump(bcmod("$x", '104659') ); // string(4) "2968" 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-17T08:08:04.627

我建议你试试[BigInteger](http://pear.php.net/package/Math_BigInteger)。如果这不起作用，您可以使用[SWIG](http://www.swig.org/)为大整数计算添加 C/C++ 代码并将其链接到您的代码中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-02-02T10:08:44.260

I found another solution, but the number will be stored as a string. As soon as you cast it back to a numeric, you'll be restricted to the precision of the underlying platform. On a 32 bit platform, the largest int you can represent as an int type is 2,147,483,647:

```
/**
 * @param string $a
 * @param string $b
 * @return string
 */
function terminal_add($a, $b){
    return shell_exec('echo "'.$a.'+'.$b.'"|bc');
}

// terminal_add("123456789012345678901234567890", "9876543210")
// output: "123456789012345678911111111100" 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-05-17T11:57:35.543

I wrote a very small code for you that will surely work in case of big numbers-

```
<?php
    $x = gmp_strval(gmp_mul("62574","62574")); // $x="3915505476"
    $mod=gmp_strval(gmp_mod($x,"104659"));  //$mod="2968"

    echo "x : ".$x."<br>";
    echo "mod : ".$mod;

    /* Output:
        x : 3915505476
        mod : 2968
    */
?> 
```

You simply have to use strings for storing big numbers and to operate on them use GMP functions in PHP.

You may check some good GMP functions in the official PHP manual here- [http://php.net/manual/en/ref.gmp.php](http://php.net/manual/en/ref.gmp.php)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-09-15T08:04:06.093

```
$x = 62574 * 62574;

// Cast to an integer
$asInt = intval($x);
var_dump($asInt);
var_dump($asInt % 104659);

// Use use sprintf to convert to integer (%d), which will casts to string
$asIntStr = sprintf('%d', $x);
var_dump($asIntStr);
var_dump($asIntStr % 104659); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-09-22T14:58:53.623

```
<?php
function add($int1,$int2){
    $int1 = str_pad($int1, strlen($int2), '0', STR_PAD_LEFT);
    $int2 = str_pad($int2, strlen($int1), '0', STR_PAD_LEFT);
    $carry = 0;
    $str = "";
    for($i=strlen($int1);$i>0;$i--){
        $var = $int1[$i-1] + $int2[$i-1] + $carry;
        $var = str_pad($var, 2, '0', STR_PAD_LEFT);
        $var = (string) $var;
        $carry = $var[0];
        $str = $str . $var[1];
    }
    $res = strrev($str.$carry);
    echo ltrim($res,"0");
}
add($int1,$int2);
?> 
```

# tdd - 您如何在不平凡的应用程序中进行 TDD？

> ID：211346
> 
> 赞同：15
> 
> 时间：2008-10-17T07:49:34.537
> 
> 标签：tdd, agile

我已经阅读了许多关于 TDD 主题的书籍和网站，它们都很有意义，尤其是 Kent Beck 的书。然而，当我尝试自己做 TDD 时，我发现自己盯着键盘想知道如何开始。有你使用的过程吗？你的思考过程是什么？你如何识别你的第一个测试？

大多数关于该主题的书籍都很好地描述了 TDD 是什么，但没有描述如何在现实世界的重要应用程序中*实践TDD。*你是怎么做TDD的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T08:06:45.813

It's easier than you think, actually. You just use TDD on each individual class. Every public method that you have in the class should be tested for all possible outcomes. So the "proof of concept" TDD examples you see can also be used in a relatively large application which has many hundreds of classes.

Another TDD strategy you could use is simulating application test runs themselves, by encapsulating the main app behavior. For example, I have written a framework (in C++, but this should apply to any OO language) which represents an application. There are abstract classes for initialization, the main runloop, and shutting down. So my main() method looks something like this:

```
int main(int argc, char *argv[]) {
  int result = 0;

  myApp &mw = getApp(); // Singleton method to return main app instance
  if(mw.initialize(argc, argv) == kErrorNone) {
    result = mw.run();
  }

  mw.shutdown();
  return(result);
} 
```

The advantage of doing this is twofold. First of all, all of the main application functionality can be compiled into a static library, which is then linked against both the test suite and this main.cpp stub file. Second, it means that I can simulate entire "runs" of the main application by creating arrays for argc & argv[], and then simulating what would happen in main(). We use this process to test lots of real-world functionality to make sure that the application generates exactly what it's supposed to do given a certain real-world corpus of input data and command-line arguments.

Now, you're probably wondering how this would change for an application which has a real GUI, web-based interface, or whatever. To that, I would simply say to use mock-ups to test these aspects of the program.

But in short, my advice boils down to this: break down your test cases to the smallest level, then start looking upwards. Eventually the test suite will throw them all together, and you'll end up with a reasonable level of automated test coverage.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T08:06:37.187

我曾经有同样的问题。我曾经通过启动一个窗口设计器来为我想要实现的第一个功能创建 UI 来开始大多数开发。由于 UI 是最难测试的事情之一，因此这种工作方式并不能很好地转化为 TDD。

我发现 Presenter First 上的 atomic object 论文非常有帮助。我仍然从设想我想要实现的用户操作开始（如果你有用例，这是一个很好的开始方式）并使用 MVP 或 MVC-ish 模型我开始为第一个屏幕的演示者编写测试。通过模拟视图直到演示者工作，我可以通过这种方式快速入门。[http://www.atomicobject.com/pages/Presenter+First](http://www.atomicobject.com/pages/Presenter+First)这里有更多关于以这种方式工作的信息。

If you're starting a project in a language or framework that's unknown to you or has many unknown you can start out doing a spike first. I often write unit tests for my spikes too but only to run the code I'm spiking. Doing the spike can give you some input on how to start your real project. Don't forget to throw away your spike when you start on your real project

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T08:00:51.613

我从考虑需求开始。

foreach 用例

1.  分析用例
2.  考虑未来的课程
3.  写下测试用例
4.  编写测试
5.  测试和实现类（如果我在第 4 点错过了某事，有时会添加新的测试）。

就是这样。这很简单，但我认为这很耗时。不过我喜欢它，我坚持下去。:)

如果我有更多时间，我会尝试在 Enterprise Architect 中建模一些时序图。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T08:13:48.077

I agree that it is especially hard to bootstrap the process.

I usually try to think of the first set of tests like a movie script, and maybe only the first scene to the movie.

> Actor1 tells Actor2 that the world is in trouble, Actor2 hands back a package, Actor1 unpacks the package, etc.

That is obviously a strange example, but I often find visualizing the interactions a nice way to get over that initial hump. There are other analogous techniques (User stories, RRC cards, etc.) that work well for larger groups, but it sounds like you are by yourself and may not need the extra overhead.

Also, I am sure the last thing that you want to do is read another book, but the guys at MockObjects.com have a book in early draft stages, currently titled [Growing Object-Oriented Software, Guided by Tests](http://www.mockobjects.com/book/). The chapters that are currently for review may give you some further insight in how to start TDD and continue it throughout.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-17T00:35:06.287

The problem is that you are looking at your keyboard wondering what tests you need to write.

Instead think of the code that you want to write, then find the first small part of that code, then try and think of the test that would force you to write that small bit of code.

In the beginning it helps to work in *very* small pieces. Even over the course of a single day you'll be working in larger chunks. But any time you get stuck just think of the smallest piece of code that you want to write next, then write the test for it.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T08:03:24.027

我认为您不应该真正从 TDD 开始。说真的，你的规格在哪里？您是否已就您的系统的通用/粗略整体设计达成一致，这*可能*适合您的应用程序？我知道 TDD 和敏捷不鼓励预先进行大设计，但这并不意味着您不应该在通过实施该设计进行 TDD 之前先进行预先设计。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T01:33:03.270

Sometimes you don't know how to do TDD because your code isn't "test friendly" (easily testable).

Thanks to some good practices your classes can become easier to test in isolation, to achieve true unit testing.

I recently came across a [blog](http://misko.hevery.com/) by a Google employee, which describes how you can design your classes and methods so that they are easier to test.

[Here is one of his recent talks](http://misko.hevery.com/2008/11/04/clean-code-talks-unit-testing/) which I recommand.

He insists on the fact that you have to separate business logic from object creation code (i.e. to avoid mixing logic with 'new' operator), by using the Dependency Injection pattern. He also explains how the Law of Demeter is important to testable code. He's mainly focused on Java code (and [Guice](http://code.google.com/p/google-guice/)) but his principles should apply to any language really.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-17T07:33:58.830

The easiest is to start with a class that has no dependencies, a class that is used by other classes, but does not use another class. Then you should pick up a test, asking yourself "how would I know if this class (this method) is implemented correctly ?".

Then you could write a first test to interrogate your object when it's not initialized, it could return NULL, or throw an exception. Then you can initialize (perhaps only partially) your object, and test test it returns something valuable. Then you can add a test with another initialization value - should behaves the same way. At that time, I usually test an error condition - such as trying to initialize the object with a invalid value.

When you're done with the method, goes to another method of the same class until you're done with the whole class.

Then you could pick another class - either another independent class, or class that use the first class you've implemented.

If you go with a class that relies on your first class, I think it is acceptable to have your test environment - or your second class - instantiating the first class as it has be fully tested. When one test about the class fails, you should be able to determine in which class the problem lies.

Should you discover a problem in the first class, or ask whether it will behave correctly under some particular conditions, then write a new test.

If climbing up the dependencies you think that the tests you're writing are spanning over to many classes to be qualified as unit-tests, then you can use a mock object to isolate a class from the rest of the system.

* * *

If you already have your design - as you indicated in a comment in the answer from Jon LimJap, then you're not doing pure TDD since TDD is about using unit tests to let your design emerge.

That being said, not all shops allow strict TDD, and you have a design at hand, so let's use it and do TDD - albeit it would be better to say Test-First-Programming but that's not the point, as that's also how I started TDD.

# c# - 如何获取填写基于 Web 的 Infopath 表单的客户端的计算机名称？

> ID：211347
> 
> 赞同：1
> 
> 时间：2008-10-17T07:49:36.270
> 
> 标签：c#, sharepoint, moss, infopath

我有一个托管在 MOSS 2007 上的 Infopath 2007 表单。表单背后的代码是用 C# 编写的。在此上下文中，`System.Environment.MachineName`返回服务器名称。

如何获取客户填写此表格的计算机名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T16:13:16.317

如果是通过 Internet：您无法获得 PC 名称 AFAIK（这是一件好事）。

如果它在内部网络上，那么 DNS 查找可能会起作用，[如此处所述](https://stackoverflow.com/questions/17664/retreiving-the-pc-name-of-a-client-windows-auth)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T12:13:28.483

ASP.NET 的 Request.ServerVariables("REMOTE_ADDR") 有帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T13:43:43.210

您可以简单地添加一个规则并从这个 xpath 中分配您喜欢的值的任何字段：**xdUser:get-UserName()**。这将返回用户登录名。

# c# - 如何让 ASMX 文件输出 JSON

> ID：211348
> 
> 赞同：64
> 
> 时间：2008-10-17T07:50:36.517
> 
> 标签：c#, json, asmx

我创建了一个带有代码隐藏文件的 ASMX 文件。它工作正常，但它正在输出 XML。

但是，我需要它来输出 JSON。ResponseFormat 配置似乎不起作用。我的代码隐藏是：

```
[System.Web.Script.Services.ScriptService]
public class _default : System.Web.Services.WebService {
    [WebMethod]
    [ScriptMethod(UseHttpGet = true,ResponseFormat = ResponseFormat.Json)]
    public string[] UserDetails()
    {
        return new string[] { "abc", "def" };
    }
} 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-11-22T11:32:46.763

要接收纯 JSON 字符串，而不将其包装到 XML 中，您必须将 JSON 字符串直接写入 并将返回类型`HttpResponse`更改为.`WebMethod``void`

```
 [System.Web.Script.Services.ScriptService]
    public class WebServiceClass : System.Web.Services.WebService {
        [WebMethod]
        public void WebMethodName()
        {
            HttpContext.Current.Response.Write("{property: value}");
        }
    } 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-10-17T10:36:24.997

[即使 ResponseFormat 设置为 JSON，WebService 也会返回](http://forums.asp.net/p/1327142/2652827.aspx)XML ：

> 确保请求是 POST 请求，而不是 GET。Scott Guthrie 有一篇[文章解释了原因](http://weblogs.asp.net/scottgu/archive/2007/04/04/json-hijacking-and-how-asp-net-ajax-1-0-mitigates-these-attacks.aspx)。
> 
> 虽然它是专门为 jQuery 编写的，但这也可能对您有用：
> [Using jQuery to Consume ASP.NET JSON Web Services](http://web.archive.org/web/20160424034823/http://encosia.com/using-jquery-to-consume-aspnet-json-web-services)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-04-18T16:48:03.907

这可能是现在的老新闻，但神奇的似乎是：

*   Web 服务类的 [ScriptService] 属性
*   [ScriptMethod(UseHttpGet = true, ResponseFormat = ResponseFormat.Json)] 方法
*   内容类型：请求中的应用程序/json

有了这些部分，GET 请求就成功了。

对于 HTTP POST

*   [ScriptMethod(UseHttpGet = false, ResponseFormat = ResponseFormat.Json)] 方法

在客户端（假设您的 web 方法称为 MethodName，并且它需要一个名为 searchString 的参数）：

```
 $.ajax({
            url: "MyWebService.asmx/MethodName",
            type: "POST",
            contentType: "application/json",
            data: JSON.stringify({ searchString: q }),
            success: function (response) {                  
            },
            error: function (jqXHR, textStatus, errorThrown) {
                alert(textStatus + ": " + jqXHR.responseText);
            }
        }); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-21T21:19:34.353

我通过艰难的方式学到了一个快速的问题（基本上在 Google 上花了 4 个小时），您可以在 ASPX 文件中使用 PageMethods 为静态方法返回 JSON（带有 [ScriptMethod()] 标记），但是如果您决定移动您对 asmx 文件的静态方法，它不能是静态方法。

此外，您需要告诉 Web 服务 Content-Type: application/json 以便从调用中获取 JSON（我正在使用 jQuery 并且使用 jQuery[时要避免的 3 个错误](http://encosia.com/2008/06/05/3-mistakes-to-avoid-when-using-jquery-with-aspnet-ajax/)文章非常有启发性 - 它来自同一个网站在这里的另一个答案中提到）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-17T10:38:54.133

您是从客户端脚本还是在服务器端调用 Web 服务？

您可能会发现向服务器发送内容类型标头会有所帮助，例如

'应用程序/json; 字符集=utf-8'

在客户端，我使用原型客户端库，并且在进行 Ajax 调用时有一个 contentType 参数，您可以在其中指定它。我认为 jQuery 有一个 getJSON 方法。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-09-10T20:47:07.920

替代方案：使用通用 HTTP 处理程序 (.ashx) 并使用您最喜欢的 json 库手动序列化和反序列化您的 JSON。

我发现对请求处理和生成响应的完全控制胜过 .NET 为简单的 RESTful Web 服务提供的任何其他功能。

# delphi - 通过 RDC/ActiveX Crystal Reports XI 进行独立报表预览

> ID：211353
> 
> 赞同：2
> 
> 时间：2008-10-17T07:59:22.397
> 
> 标签：delphi, crystal-reports

我正在使用 RDC/ActiveX 接口将应用程序从 Crystal Reports 8 移植到 Delphi 5 中的 Crystal Reports XI。

在 Crystal Reports 8 中，我能够为如下报表调出 Crystal 报表默认报表查看器窗口：

```
RptInvoicing.Destination := 0; // To: window
RptInvoicing.Action := 1; // Execute 
```

但是，这不适用于 CR XI。打印和导出我想像这样工作：

```
crReport.PrintOut(True);
...
crReport.Export(True); 
```

但是我找不到任何与显示默认预览窗口相关的东西。我已经尝试使用报表查看器组件来实现我自己的组件，但它有很多问题，例如在调整大小、冻结和崩溃时锁定，因此对于生产应用程序来说，它不是一个可行的解决方案。

即使是官方支持论坛也没有帮助，我只得到一个讨厌的答案去看看手册，我已经通过了好几次，只能说是坏的。对于企业产品，您并不是每天都能看到如此糟糕的文档。我在他们的手册中没有发现任何与此相关的内容，因此我认为他们自己的员工也对此一无所知。

所以我希望这里有人能告诉我默认的报表查看器是否仍然存在于 CR XI 中，如果存在，如何调用它？如果不是，那么使用报表设计器组件真的是创建一个的唯一解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T16:17:59.333

我最近遇到了同样的问题，并[在此处描述了解决方案](https://stackoverflow.com/questions/378089/how-can-i-display-crystal-xi-reports-inside-a-delphi-2007-application#378099)。我使用的是 Delphi 2007，但由于代码涉及对外部 ActiveX DLL 的调用，它也应该适用于您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T15:01:59.530

从他们的文档中：

> Craxddrt.dll（Crystal Reports ActiveX Designer 设计和运行时库）是一个统一的对象模型，它将 Craxdrt.dll（Crystal Reports ActiveX Designer 运行时库）的运行时功能与 Craxddt.dll（Crystal Reports ActiveX Designer 设计时库）。Craxddrt.dll 将替换 8.5 及更高版本的 Craxddt.dll。Craxddrt.dll 和 Craxdrt.dll 都包含在运行时创建、打开、导出、保存和打印报表所需的所有对象和关联的方法、属性和事件。此外，Craxddrt.dll 在设计时设计报表时与 RDC ActiveX 设计器一起使用，或在运行时设计报表时与嵌入式设计器一起使用。有关详细信息，请参见第 343 页的“可嵌入 Crystal Reports 设计器控件对象模型”。
> 
> **注意：RDC ActiveX** **设计器仅在** **Microsoft Visual Basic**中可用。
> 
> 在 8.5 版之前，Craxdrt.dll 将与应用程序一起分发。现在，开发人员可以选择两个自动化服务器进行分发。Craxdrt.dll 向后兼容以前的版本，并包含此版本中引入的所有功能。将 Craxdrt.dll 用于任何不包含可嵌入设计器的客户端应用程序，或将其用于任何服务器端应用程序。Craxddrt.dll 是单元模型线程，但不是线程安全的，只能在客户端应用程序中使用。尽管 Craxddrt.dll 是 RDC 的全功能自动化服务器，并且可以在任何客户端应用程序中工作，但它会增加安装大小。因此，建议您仅将 Craxddrt.dll 与可嵌入 Crystal Reports 设计器控件一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T22:24:01.930

关于 Delphi，我无话可说，但在 VB 中，我们使用的是 CRViewer ActiveX 控件。使用它很简单——您将查看器控件放在表单上并将 RDC 对象分配给它。这在某处的 CR 帮助中有所介绍。（我无法查看代码 ATM 来提供工作示例。）

# sql-server - SQL Server 中的参数嗅探（或欺骗）

> ID：211355
> 
> 赞同：65
> 
> 时间：2008-10-17T08:00:32.987
> 
> 标签：sql-server, tsql, sql-server-2005, parameter-spoofing

不久前，我有一个查询，我为我的一个用户运行了很多。它仍在不断发展和调整，但最终稳定下来并运行得非常快，因此我们从中创建了一个存储过程。

到目前为止，一切正常。

但是，存储过程很慢。查询和proc之间没有实质性区别，但速度变化很大。

[背景，我们正在运行 SQL Server 2005。]

一位友好的本地 DBA（不再在这里工作）看了一眼存储过程并说“参数欺骗！” （**编辑：**虽然它似乎也可能被称为“参数嗅探”，这可能解释了当我试图搜索它时谷歌点击量的缺乏。）

我们将一些存储过程抽象为第二个存储过程，将对这个新的内部过程的调用包装到预先存在的外部过程中，称为外部过程，嘿，转眼间，它与原始查询一样快。

那么，什么给了？有人可以解释参数欺骗吗？

奖励积分

*   强调如何避免它
*   建议如何识别可能的原因
*   讨论缓解情况的替代策略，例如统计数据、索引、键

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-10-19T01:36:33.493

仅供参考 - 当您使用 SQL 2005 并使用参数存储过程时，您需要注意其他事项。

SQL Server 将使用使用的第一个参数编译存储过程的执行计划。所以如果你运行这个：

```
usp_QueryMyDataByState 'Rhode Island' 
```

执行计划最适用于小州的数据。但如果有人转身跑：

```
usp_QueryMyDataByState 'Texas' 
```

为罗德岛大小的数据设计的执行计划可能不如德克萨斯大小的数据有效。当服务器重新启动时，这可能会产生令人惊讶的结果，因为新生成的执行计划将针对首先使用的任何参数——不一定是最好的。除非有很大的理由，否则不会重新编译该计划，例如重建统计数据。

这就是查询计划的用武之地，SQL Server 2008 提供了许多新功能，可帮助 DBA 长期将特定查询计划固定到位，无论首先调用什么参数。

我担心的是，当您重建存储过程时，您强制执行计划重新编译。你用你最喜欢的参数调用它，然后它当然很快 - 但问题可能不是存储过程。可能是存储过程在某些时候用一组不寻常的参数重新编译，因此查询计划效率低下。您可能没有修复任何东西，并且下次重新启动服务器或重新编译查询计划时，您可能会遇到同样的问题。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-17T11:51:10.527

是的，我认为您的意思是参数嗅探，这是 SQL Server 优化器用来尝试找出参数值/范围的技术，以便它可以为您的查询选择最佳执行计划。在某些情况下，SQL Server 在参数嗅探方面做得很差，并且没有为查询选择最佳执行计划。

相信这篇博客文章 [http://blogs.msdn.com/queryoptteam/archive/2006/03/31/565991.aspx](http://blogs.msdn.com/queryoptteam/archive/2006/03/31/565991.aspx)有很好的解释。

您的示例中的 DBA 似乎选择了选项 #4 将查询移动到另一个存储过程到单独的过程上下文。

您还可以在原始存储过程上使用*with recompile或在参数上使用**优化*选项。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2008-10-19T00:38:02.127

一种加快速度的简单方法是在存储过程的最开始将输入参数重新分配给本地参数，例如

```
CREATE PROCEDURE uspParameterSniffingAvoidance
    @SniffedFormalParameter int
AS
BEGIN

    DECLARE @SniffAvoidingLocalParameter int
    SET @SniffAvoidingLocalParameter = @SniffedFormalParameter

    --Work w/ @SniffAvoidingLocalParameter in sproc body 
    -- ... 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-22T09:27:19.847

参数嗅探是 SQL Server 用于优化存储过程的查询执行计划的一种技术。首次调用存储过程时，SQL Server 会查看调用的给定参数值，并根据参数值决定使用哪些索引。

所以当第一次调用包含不是很典型的参数时，SQL Server 可能会针对存储过程的后续调用选择并存储一个次优的执行计划。

您可以通过以下任一方式解决此问题

*   使用`WITH RECOMPILE`
*   将参数值复制到存储过程中的局部变量并在查询中使用局部变量。

我什至听说最好不要使用存储过程，而是将查询直接发送到服务器。我最近遇到了同样的问题，我还没有真正的解决方案。对于某些查询，复制到本地变量有助于回到正确的执行计划，对于某些查询，本地变量会降低性能。

我仍然需要对 SQL Server 如何缓存和重用（次优）执行计划进行更多研究。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-11-09T00:25:41.063

根据我的经验，参数嗅探的最佳解决方案是“动态 SQL”。需要注意的两个重要事项是 1\. 您应该在动态 sql 查询中使用参数 2\. 您应该使用 sp_executesql（而不是 sp_execute），它保存了每个参数值的执行计划

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-26T12:55:41.597

我有类似的问题。我的存储过程的执行计划需要 30-40 秒。我尝试在查询窗口中使用 SP 语句，执行相同的语句需要几毫秒。然后我制定了在存储过程中声明局部变量并将参数的值传递给局部变量。这使得 SP 执行速度非常快，现在相同的 SP 在几毫秒内执行，而不是 30-40 秒。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-08-21T19:57:41.410

非常简单和排序，查询优化器使用旧的查询计划来进行频繁运行的查询。但实际上数据的大小也在增加，所以当时需要新的优化计划，并且仍然使用旧的查询计划进行查询优化器。这称为参数嗅探。我还为此创建了详细的帖子。请访问此网址： [http ://www.dbrnd.com/2015/05/sql-server-parameter-sniffing/](http://www.dbrnd.com/2015/05/sql-server-parameter-sniffing/)

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-07-17T14:12:53.930

将存储过程更改为批量执行应该会提高速度。

批处理文件选择即：

```
exec ('select * from order where  order id ='''+ @ordersID') 
```

而不是普通的存储过程选择：

```
select * from order where  order id = @ordersID 
```

只需传入参数 as `nvarchar`，您应该会得到更快的结果。

# visual-c++ - 如何将自定义图标分配给 Mappoint 中的图钉？

> ID：211369
> 
> 赞同：3
> 
> 时间：2008-10-17T08:09:14.903
> 
> 标签：visual-c++, mappoint

我正在编写一个使用 MS Mappoint OCX 的 MFC 应用程序。我需要在地图上显示人和车辆的位置，而最好的方法似乎是使用图钉对象。我没有问题显示带有一些文本的股票图钉图标，但想将图标更改为自定义设计的图标。从那里有限数量的 Mappoint 编程信息看来，这样做的方法是从符号对象创建一个符号对象，然后将其分配给这样的图钉..

```
CSymbols symbols;
CSymbol symbol;

symbol=symbols.Add("c:/temp/myicon.ico");
pushpin.put_Symbol(symbol.get_ID()); 
```

但是程序在 symbols.add 指令上出现未处理的异常而崩溃。

谁能告诉我我在这里做错了什么？还是我完全走错了路？

谢谢你的时间

伊恩

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-21T12:23:31.847

我自己找到了解决方案。以下代码有效..

```
CSymbols symbols;
CSymbol symbol;

symbols=map.get_Symbols();
symbol=symbols.Add("c:/temp/myicon.ico");
pushpin.put_Symbol(symbol.get_ID()); 
```

其中 map 是 Mappoint 控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-24T01:13:26.683

所以看起来你的错误是符号集合尚未创建：所以是的，它当然会抛出异常。

如您所见，可以使用 MapPoint.Map 对象上的 Symbols 属性访问符号集合。

所有这些都在 MapPoint 参考中，但它主要是参考形式，很少有教程。[http://www.mp2kmag.com](http://www.mp2kmag.com)、[http://www.mapforums.com](http://www.mapforums.com)和[http://www.mapping-tools.com/howto/](http://www.mapping-tools.com/howto/)等网站是了解更多信息的良好开端。

（完全披露：最后一个站点是我的，信息在“howto”路径中，而站点的其余部分是商业性质的）

# javascript - jquery图像选择器在IE7中不起作用

> ID：211375
> 
> 赞同：3
> 
> 时间：2008-10-17T08:12:58.827
> 
> 标签：javascript, jquery, forms, radio-button

所以我有一些像这样的html：

```
<div id="avatar_choices">
    <label for="id_choice_0">
        <input id="id_choice_0" type="radio" name="choice" value="7" />
        <img src="someimage.jpg" />
    </label>
    <label for="id_choice_1">
        <input id="id_choice_1" type="radio" name="choice" value="8" />
        <img src="someimage2.jpg" />
    </label>
</div> 
```

还有一些脚本：

```
$('#avatar_choices input').hide();
$('#avatar_choices img').click(function(){
    $('#avatar_choices img').css('border', '2px solid #efefef');
    $(this).css('border', '2px solid #39c');
    $(this).siblings('input').attr('checked', 'checked');
}); 
```

目标是允许用户单击图像选项，使所选的一个突出显示带有边框颜色。

这在 FF 中运行良好。出于某种原因，在 IE 中，一旦我单击一个图像，单击另一个图像，然后尝试单击第一个图像，边框不会改变（尽管它确实被选中）。

编辑：我的解决方案最终意外发生了一半。由于redsquare的回答，我将代码更改为：

```
$('#avatar_choices input').hide();
$('#avatar_choices img').click(function(){
    $('#avatar_choices img').removeClass('selected');
    $(this).addClass('selected');
    $(this).siblings('input').attr('checked', 'checked');
}); 
```

在哪里：

```
#avatar_choices img.selected{border:2px solid #39c;} 
```

去搞清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-17T08:26:57.567

在这种情况下最好使用 addClass 和 removeClass。更容易维护。你可以粘贴你的完整 html 以便我可以看到你的文档类型等

# c++ - 函数重载失败：为什么这些运算符会发生冲突？

> ID：211376
> 
> 赞同：1
> 
> 时间：2008-10-17T08:13:00.917
> 
> 标签：c++, operator-overloading, overloading

我有一个很大的代码库，其中包括两个主要的命名空间：引擎和应用程序。

引擎将vector3 类定义为另一个vector3 类的typedef，相等运算符位于引擎命名空间中，而不是vector3 类中。我向应用程序添加了一个类，该类在应用程序命名空间中也有相等运算符。

当我尝试编译时，不相关但附近的 vector3 比较失败，因为它找不到合适的相等运算符。我怀疑我引起了冲突，所以将我的相等运算符移到我添加的类中，编译成功。

```
// engine.h
namespace Engine
{
    class Vector3Impl { ... };
    typedef Vector3Impl Vector3;
    bool operator==(Vector3 const &lhs, Vector3 const &rhs) { ... }
}

// myfile.cpp
#include "engine.h"

namespace application
{
    class MyClass { ... };
    bool operator==(MyClass const &lhs, MyClass const &rhs) { ... }

    void myFunc(...)
    {
        if ( myClassA == myClassB ) { ... } // builds
    }

    void anotherFunc(...)
    {
        Engine::Vector3 a, b;
        ...
        if ( a == b ) { ... } // fails
    }
} 
```

但是在考虑之后，我看不出编译失败的原因。没有从 vector3s 到我的类的隐式转换，反之亦然，并且依赖于参数的查找应该从引擎命名空间中拉入相等运算符并匹配它。

我尝试在示例 C++ 项目中重现此错误，但拒绝中断。大型代码库中一定有一些东西导致了这个问题，但我不确定从哪里开始寻找。类似于流氓“使用引擎”的反面？有人有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T08:36:25.693

C++ 标准，3.4.4.2 声明：

> 对于函数调用中的每个参数类型 T，有一组零个或多个关联的命名空间和一组零个或多个关联的类需要考虑。命名空间和类的集合完全由函数参数的类型（以及任何模板模板参数的命名空间）决定。**用于指定类型的 Typedef 名称和 using-declarations 不构成此集合**。

ADL 不适用于 typedef。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T08:35:17.473

我曾经在没有参数依赖查找（Koenig Lookup - 感谢@igor）（我认为是VC6）的编译器上遇到同样的问题。这意味着当它看到一个操作符时，它只是在封闭的命名空间中查找。

那么你能告诉我们你使用什么编译器吗？

转移到另一个编译器解决了它。

确实很不方便。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-17T08:17:24.577

```
bool operator==(Vector3 const &lhs, Vector3 const &rhs) { ... } 
```

在类上定义的等式运算符的规范定义应该只有一个参数，即 rhs。lhs是这样的。不知道这是否可以解决您的问题。

这就是我要写的：

类 Vector3 { bool operator==( const Vector3 & rhs) const { ... } };

# bash - Bash 的隐藏功能

> ID：211378
> 
> 赞同：72
> 
> 时间：2008-10-17T08:14:02.943
> 
> 标签：bash, shell, scripting, hidden-features

Shell 脚本通常用作粘合剂，用于自动化和简单的一次性任务。您最喜欢 Bash shell/脚本语言的哪些“隐藏”功能？

*   每个答案一个功能
*   提供功能的示例和简短描述，而不仅仅是文档链接
*   使用粗体标题作为第一行标记特征

也可以看看：

*   [C的隐藏特征](https://stackoverflow.com/questions/132241/hidden-features-of-c)
*   [C#的隐藏特性](https://stackoverflow.com/questions/9033/hidden-features-of-c)
*   [C++的隐藏特性](https://stackoverflow.com/questions/75538/hidden-features-of-c)
*   [Delphi的隐藏特性](https://stackoverflow.com/questions/102254/hidden-features-of-delphi)
*   [Python的隐藏特性](https://stackoverflow.com/questions/101268/hidden-features-of-python)
*   [Java的隐藏特性](https://stackoverflow.com/questions/15496/hidden-features-of-java)
*   [JavaScript 的隐藏特性](https://stackoverflow.com/questions/61088/hidden-features-of-javascript)
*   [Ruby 的隐藏特性](https://stackoverflow.com/questions/63998/hidden-features-of-ruby)
*   [PHP的隐藏特性](https://stackoverflow.com/questions/61401/hidden-features-of-php)
*   [Perl 的隐藏特性](https://stackoverflow.com/questions/161872/hidden-features-of-perl)
*   [VB.Net的隐藏特性](https://stackoverflow.com/questions/102084/hidden-features-of-vbnet)

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-02-25T11:35:36.910

**insert preceding line's final parameter**

`alt`-`.` the most useful key combination ever, try it and see, for some reason no one knows about this one.

press it again and again to select older last parameters.

great when you want to do something else to something you used just a moment ago.

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-02-25T11:42:32.743

**If you want to keep a process running after you log out:**

`disown -h <pid>`

is a useful bash built-in. Unlike `nohup`, you can run `disown` on an already-running process.

First, stop your job with control-Z, get the pid from `ps` (or use `echo $!`), use `bg` to send it to the background, then use `disown` with the -h flag.

Don't forget to background your job or it will be killed when you logout.

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2008-10-17T08:47:36.620

手册中 EXPANSION 部分下列出的几乎所有内容

特别是参数扩展：

```
$ I=foobar
$ echo ${I/oo/aa} #replacement
faabar
$ echo ${I:1:2}   #substring
oo
$ echo ${I%bar}   #trailing substitution
foo
$ echo ${I#foo}   #leading substitution
bar 
```

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2009-06-30T14:17:16.617

我最喜欢的：

```
sudo !! 
```

使用 sudo 重新运行上一个命令。

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2009-09-12T21:01:46.067

## 更多神奇的组合键：

*   `Ctrl`+`r`通过您的命令历史记录开始“反向增量搜索”。当您继续键入时，它会检索包含您输入的所有文本的最新命令。

*   `Tab`如果它是明确的，则补全您迄今为止键入的单词。

*   `Tab` `Tab`列出您迄今为止输入的单词的所有补全。

*   `Alt`+`*` *插入*所有可能的补全，这特别有用，例如，如果您刚刚输入了带有通配符的潜在破坏性命令：

    `rm -r source/d*.c` `Alt`+`*`
    `rm -r source/delete_me.c source/do_not_delete_me.c`

*   `Ctrl`++在当前行上执行别名、历史和 shell 扩展`Alt`。`e`换句话说，当前行将被重新显示，因为它将由 shell 处理：

    `ls $HOME/tmp` `Ctrl` `Alt`+`e`
    `ls -N --color=tty -T 0 /home/cramey`

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2008-10-17T12:16:22.050

**取回历史命令和参数**

可以使用`!`运算符有选择地访问以前的命令和参数。当您使用长路径时，它非常有用。

您可以使用 . 检查您的最后命令`history`。

您可以使用以前的命令`!<n>`作为`n`中命令的索引`history`，负数从历史中的最后一个命令开始倒数。

```
ls -l foo bar
touch foo bar
!-2 
```

您可以使用前面的参数`!:<n>`，零是命令，>= 1 是参数。

```
ls -l foo
touch !:2
cp !:1 bar 
```

你可以将两者结合起来`!<n>:<m>`

```
touch foo bar
ls -l !:1 !:2
rm !-2:1 !-2:2
!-2 
```

您还可以使用参数范围`!<n>:<x>-<y>`

```
touch boo far
ls -l !:1-2 
```

其他`!`特殊修饰符有：

*   `*`对于所有论点

    ```
    ls -l foo bar
    ls !* 
    ```

*   `^`对于第一个参数（`!:1`== `!^`）

*   `$`对于最后一个论点

    ```
    ls -l foo bar
    cat !$ > /dev/null 
    ```

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2008-10-17T08:33:29.910

我喜欢 -x 功能，它允许查看脚本中发生了什么。

```
bash -x script.sh 
```

* * *

## 回答 #8

> 赞同：19
> 
> 时间：2009-06-05T14:26:39.563

`SECONDS=0; sleep 5 ; echo "that took approximately $SECONDS seconds"`

> **秒**
> 
> 每次引用此参数时，都会返回自 shell 调用以来的秒数。如果为 SECONDS 分配了一个值，则后续引用时返回的值是自分配以来的秒数加上分配的值。如果 SECONDS 未设置，即使随后被重置，它也会失去其特殊属性。

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2009-06-05T14:10:09.707

这是我的最爱之一。这将选项卡完成设置为不区分大小写。它非常适合快速键入目录路径，尤其是在文件系统默认不区分大小写的 Mac 上。我把它放在`.inputrc`我的主文件夹中。

```
set completion-ignore-case on 
```

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2008-10-17T08:31:15.077

特殊变量随机：

```
if [[ $(($RANDOM % 6)) = 0 ]]
    then echo "BANG"
else
    echo "Try again"
fi 
```

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2009-04-25T18:32:58.677

拼写错误的快速和肮脏更正（特别适用于慢速连接上的长命令，其中使用命令历史记录并滚动浏览它会很糟糕）：

```
$ cat /proc/cupinfo
cat: /proc/cupinfo: No such file or directory
$ ^cup^cpu 
```

还可以尝试`!:s/old/new`在上一个命令中将旧的替换为新的。

如果要替换多次出现，可以使用`!:gs/old/new`.

您可以将`gs`and`s`命令与任何历史事件一起使用，例如

```
!-2:s/old/new 
```

`old`在倒数第二个命令中用`new`（一次）替换。

* * *

## 回答 #12

> 赞同：13
> 
> 时间：2009-06-30T02:04:10.400

`Ctrl``x` `Ctrl``e`

这会将当前命令加载到变量 VISUAL 中定义的编辑器中。这对于像这里列出的一些长命令非常有用。

使用 vi 作为编辑器：

```
export VISUAL=vi 
```

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2008-12-18T14:03:24.943

**正则表达式处理**

最近的 bash 版本具有正则表达式匹配功能，因此您可以执行以下操作：

```
if [[ "mystring" =~ REGEX ]] ; then  
    echo match
fi 
```

其中 REGEX 是格式由 man re_format 描述的原始正则表达式。

任何括号部分的匹配都存储在 BASH_REMATCH 数组中，从元素 1 开始（元素 0 是整个匹配的字符串），因此您也可以使用它来进行正则表达式驱动的解析。

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2008-10-17T09:49:06.123

这是我最喜欢的两个：

要检查没有真正执行脚本的语法，请使用：

```
bash -n script.sh 
```

返回上一个目录（是的，我知道 pushd 和 popd，但这更快）

```
cd - 
```

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2009-06-05T14:23:04.593

**在显示 bash 提示符之前运行命令**

在“PROMPT_COMMAND”环境变量中设置一个命令，它将在每个提示之前自动运行。例子：

```
[lsc@home]$ export PROMPT_COMMAND="date"
Fri Jun  5 15:19:18 BST 2009
[lsc@home]$ ls
file_a  file_b  file_c
Fri Jun  5 15:19:19 BST 2009
[lsc@home]$ ls 
```

对于下一个愚人节，将“export PROMPT_COMMAND=cd”添加到某人的 .bashrc 中，然后坐下来观看混乱的展开。

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2008-10-17T09:17:31.147

数组：

```
#!/bin/bash

array[0]="a string"
array[1]="a string with spaces and \"quotation\" marks in it"
array[2]="a string with spaces, \"quotation marks\" and (parenthesis) in it"

echo "There are ${#array[*]} elements in the array."
for n in "${array[@]}"; do
    echo "element = >>${n}<<"
done 
```

可以在[Advanced Bash-Scripting Guide](http://tldp.org/LDP/abs/html/)中找到有关数组（和其他高级 bash 脚本编写内容）的更多详细信息。

* * *

## 回答 #17

> 赞同：8
> 
> 时间：2009-09-12T20:43:23.903

## `man`来自 bash页面的魔法组合键：

*   `Ctrl`+`a`和`Ctrl`+`e`分别将光标移动到当前行的开头和结尾。

*   `Ctrl`+`t`和`Alt`+`t`将光标前的字符和单词与当前字符和单词转置，然后向前移动光标。

*   `Alt`+`u`和`Alt`+`l`将当前单词（从光标到结尾）转换为大写和小写。

    **提示：**按`Alt`+`–`后跟这些命令中的任何一个来转换当前单词的*开头*。

## 奖励`man`提示：

*   查看`man`页面时，用于`/`搜索页面内的文本。用于`n`跳到下一场比赛或`N`上一场比赛。

*   `man`利用它们的格式，加快您在页面中搜索特定命令或子部分的速度：

    o 不要键入`/history expansion`来查找该部分，而是尝试`/^history`使用插入符号 ( `^`) 仅查找以“历史”*开头的行。*

    o 尝试`/   read`使用几个前导空格来搜索该内置命令。内置插件总是在`man`页面中缩进。

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2008-10-17T08:15:08.947

**使用中缀布尔运算符**

考虑简单的 if：

```
if [ 2 -lt 3 ]
    then echo "Numbers are still good!"
fi 
```

-lt 看起来有点难看。不是很现代。如果您在布尔表达式周围使用双括号，则可以使用普通的布尔运算符！

```
if [[ 2 < 3 ]]
    then echo "Numbers are still good!"
fi 
```

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2009-12-10T15:53:05.913

`export TMOUT=$((15*60))`

在 15 分钟空闲时间后终止 bash，设置为 0 以禁用。我通常把它放在我的根帐户上的 ~/.bashrc 中。它在管理您的盒子时很方便，您可能会在离开终端之前忘记注销。

* * *

## 回答 #20

> 赞同：7
> 
> 时间：2010-10-16T21:03:56.103

### 撤消

`C-S--` [控制 Shift 减去]撤消键入操作。

### 杀/猛

任何删除操作`C-w`（删除前一个单词），`C-k`（删除到行尾），`C-u`（删除到行首）等...将其删除的文本复制到终止环，您可以粘贴最后一个终止：`C-y`并循环（和粘贴来自）已删除项目的环`Alt-y`

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2010-10-19T00:03:15.040

`FIGNORE`您可以通过设置 th变量在选项卡完成时忽略某些文件。

例如，如果您有一个 subverion 存储库并且想要更轻松地导航

```
export FIGNORE=".svn" 
```

现在您可以`cd`不受`.svn`目录的阻碍。

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2008-10-17T08:26:01.580

使用算术：

```
if [[ $((2+1)) = $((1+2)) ]]
    then echo "still ok"
fi 
```

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2011-08-13T04:09:37.580

大括号扩展

{x,y,z} 的标准扩展：

```
$ echo foo{bar,baz,blam}
foobar foobaz fooblam
$ cp program.py{,.bak}  # very useful with cp and mv 
```

用 {x..y} 展开序列：

```
$ echo {a..z}
a b c d e f g h i j k l m n o p q r s t u v w x y z
$ echo {a..f}{0..3}
a0 a1 a2 a3 b0 b1 b2 b3 c0 c1 c2 c3 d0 d1 d2 d3 e0 e1 e2 e3 f0 f1 f2 f3 
```

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2008-11-01T15:48:03.617

**截断文件的内容（归零文件）**

```
> file 
```

具体来说，这对于截断日志文件非常有用，当文件被另一个进程打开时，仍然可能写入文件。

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2008-10-17T08:29:51.650

我最近阅读了[Csh Programming Considered Harmful](http://www.faqs.org/faqs/unix-faq/shell/csh-whynot/)，其中包含这个惊人的宝石：

> 考虑管道：

```
A | B | C 
```

> 你想知道 C 的状态，嗯，很简单：它在 $? 中，或者在 csh 中的 $status。但是如果你想从 A 那里得到它，那你就不走运了——如果你在 csh 中，就是这样。在 Bourne shell 中，您可以获得它，尽管这样做有点棘手。这是我必须做的事情，我将 dd 的 stderr 运行到 grep -v 管道中以消除记录输入/输出噪音，但必须返回 dd 的退出状态，而不是 grep 的：

```
device=/dev/rmt8
dd_noise='^[0-9]+\+[0-9]+ records (in|out)$'
exec 3>&1
status=`((dd if=$device ibs=64k 2>&1 1>&3 3>&- 4>&-; echo $? >&4) |
    egrep -v "$dd_noise" 1>&2 3>&- 4>&-) 4>&1`
exit $status; 
```

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2009-12-10T15:55:46.443

不是一个真正的功能，而是一个方向：我在[commandlinefu.com](http://www.commandlinefu.com/)发现了许多“隐藏的功能”、秘密和各种 bash 有用性。这个答案的许多评价最高的答案，我在那个网站上学到了:)

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2010-11-23T14:55:18.617

另一个小的： `Alt`+`#`

注释掉当前行并将其移动到历史缓冲区中。

因此，当您组装命令行并且需要发出临时命令来查找文件时，您只需按 alt+#，发出另一个命令，进入历史记录，取消注释并继续。

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2012-01-15T13:40:37.613

**大括号代替`do`和`done`for 循环**

`For`循环体通常在`do...done`（只是一个例子）：

```
for f in *;
do
    ls "$f";
done 
```

但是我们可以使用大括号来使用 C 风格：

```
for f in *; {
    ls "$f";
} 
```

我认为这看起来比`do...done`我更喜欢这个。我还没有在任何 Bash 文档中找到这个，所以这确实是一个隐藏的特性。

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2009-06-06T16:13:31.873

These properties are another one of my favorites.

```
export HISTCONTROL=erasedups
export HISTSIZE=1000 
```

The first one makes sure bash doesn't log commands more than once, will really improves `history`'s usefulness. The other expands the history size to 1000 from the default of 100\. I actually set this to 10000 on my machines.

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2009-06-30T02:44:17.323

在多个目录之间轻松移动

不是隐藏功能，但比需要类似堆栈导航的 pushd 灵活得多。

```
a() { alias $1=cd\ $PWD; } 
```

`cd`某处并输入`a 1`。稍后只需键入`1`将返回该目录。

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2009-08-27T09:14:21.610

我经常使用的一个是 !$ 来引用最后一个命令的最后一个单词：

```
$ less foobar.txt
...
# I dont want that file any more
$ rm !$ 
```

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2010-05-13T07:49:06.217

`set -o vi`为了对命令历史以及当前键入的命令进行类似 vi 的编辑。

* * *

## 回答 #33

> 赞同：3
> 
> 时间：2008-10-17T13:56:40.740

C 风格的数值表达式：

```
let x="RANDOM%2**8"
echo -n "$x = 0b"
for ((i=8; i>=0; i--)); do
  let n="2**i"
  if (( (x&n) == n )); then echo -n "1"
  else echo -n "0"
  fi
done
echo "" 
```

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2009-12-10T15:49:25.207

我有一个 alias `r='fc-s'`，我发现它在某些有限的情况下非常有用。要运行最后一个命令，只需键入`r`并按 Enter，就可以了。当然，这本身并不是很有用，因为向上箭头做同样的事情。但是您可以使用`r`替换来运行上一个命令。假设您的最后一个命令是编译某个文件的长命令：

```
$ gcc -c <file_name>.c <lots of options> -o <file_name>.o 
```

现在你想用相同的选项编译另一个文件并有一个相应的`.o`文件：

```
$ r <file_name>=<new_file> 
```

会做的。您不必使用向上箭头，导航到正确的位置，然后手动替换它们。这可以重复多次，因此您可以接下来执行此操作：

```
$ r <new_file>=<other_file> 
```

当然，对于这样的事情，你有 makefiles，但我希望我已经证明了别名是有用的。

我不需要使用这个别名很多，但有时我很高兴我有这个别名！

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2009-12-10T15:34:14.817

正如其他人所提到的，`Ctrl`-`r`非常适合回顾您的命令历史记录。但是，如果您在迈出太多一步或几步之后还想继续前进怎么办？这就是`Ctrl`-`s`派上用场的地方。但是，它通常映射到 XOFF（中断数据流）。由于我们没有使用慢速串行终端，所以这不再有用了，您可以使用以下命令关闭该映射：

```
stty -ixon 
```

在你的`~/.bashrc`文件中。

这也使得`Ctrl`-`q`可用，它通常是`Ctrl`-的副本`v`（带引号的插入允许您插入文字控制字符）。我已经`Ctrl`-`q`映射到菜单完成，重复按下时会逐步完成。我喜欢离开`Tab`设置为常规完成。

您可以通过将此行添加到文件中来将`Ctrl`-设置为菜单完成：`q``~/.inputrc`

```
"\C-q": menu-complete 
```

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2009-12-10T15:41:30.823

Bash 有可变间接：

```
$ foo=bar
$ baz=foo
$ echo ${!baz}
bar 
```

* * *

## 回答 #37

> 赞同：2
> 
> 时间：2011-03-08T09:50:39.170

*这里是字符串*( `<<<`)。Bash 手册给出了这样的描述：

> 该词被扩展并提供给其标准输入上的命令。

例子：

```
$ cat<<<"$(( 10*3+1 )) nice isn't it?"
31 nice isn't it? 
```

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2011-08-13T03:52:34.057

特殊套接字文件名：/dev/tcp/HOST/PORT 和 /dev/udp/HOST/PORT

从日间服务器（端口 13）读取：

```
$ cat < /dev/tcp/utcnist.colorado.edu/13

55786 11-08-13 03:34:21 50 0 0 172.3 UTC(NIST) * 
```

[这与tcpserver](http://cr.yp.to/ucspi-tcp/tcpserver.html)结合使用非常有用。

如果您无权访问 wget 或 curl，则来自[http://thesmithfam.org/blog/2006/05/23/bash-socket-programming-with-devtcp-2/的更高级示例：](http://thesmithfam.org/blog/2006/05/23/bash-socket-programming-with-devtcp-2/)

```
$ exec 3<>/dev/tcp/www.google.com/80 # hook up to file desc 3
$ echo -e "GET / HTTP/1.1\n\n" >&3   # send the HTTP request
$ cat <&3                            # read the HTTP response 
```

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2009-06-05T15:09:53.157

**使用 'let' 内置 bash 命令进行基本算术运算**

```
A=10
let B="A * 10 + 1" # B=101
let B="B / 8"      # B=12, let does not do floating point
let B="(RANDOM % 6) + 1" # B is now a random number between 1 and 6 
```

要进行浮点计算，您可以使用“bc”命令（不是 bash 的一部分）。

```
FP=`echo "scale=4; 10 / 3" | bc` # FP="3.3333" 
```

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2011-08-13T03:11:11.533

使用 <(cmd ...) 或 >(cmd ...) 进行进程替换

在每种形式中，cmd 都会在其输入或输出连接到 FIFO 的情况下执行，并且该 FIFO 的路径在命令行中被替换：

```
$ echo A file to read: <(cat), a file to write to: >(cat)
A file to read: /dev/fd/63, a file to write to: /dev/fd/62 
```

例如，在不保存中间文件的情况下比较两个网站：

```
$ diff <(curl -s http://tldp.org/LDP/abs/html/) <(curl -s http://www.redhat.com/mirrors/LDP/LDP/abs/html/) 
```

如果您有一个将文件名作为输入的命令，但不接受“-”表示标准输出，您可以欺骗它：

```
$ do_thingee --log -
error: can't open log file: '-'
$ do_thingee --log >(cat)
do_thingee v0.2
initializing things
processing 4 things
done 
```

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2008-12-18T18:02:11.670

嵌入式命令替换：

> 主机名 && dig +short $(hostname) && dig +short -x $(dig +short $(hostname))

此命令适用于检查邮件服务器上的 RDNS。:P

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2011-09-23T07:58:37.073

[在http://linuxconfig.net/manual-howto/key-combinations-in-bash.html](http://linuxconfig.net/manual-howto/key-combinations-in-bash.html)中获取有关 Bash 中的组合键的更多信息

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2011-08-13T05:41:33.190

**快速历史搜索**

以下提供了一个类似 tcsh 的历史搜索，它既方便又容易。

将以下行添加到`~/.inputrc`或`/etc/inputrc`。

```
$ cat ~/.inputrc
"\e[A": history-search-backward
"\e[B": history-search-forward 
```

您可能希望使用不太意外的组合键，例如`Esc`+ `p`。如果是这种情况，请使用

```
"\ep": history-search-backward
"\en": history-search-forward 
```

然后，只需键入前几个字母并按向上箭头键。它将显示以给定字母开头的最新命令。

前任：

类型`grep`，向上箭头。它会显示类似`grep -ri myText .`

# ms-access - 将 Access 2003 更新到 2007，潜在问题？

> ID：211380
> 
> 赞同：3
> 
> 时间：2008-10-17T08:14:19.450
> 
> 标签：ms-access, ms-office, ms-access-2007

在过去的几年里，我编写了一个 Access 2003 应用程序来处理我公司的内部事务，我们正在讨论将我们所有的计算机升级到 Office 2007，这意味着将更新 Access。这会给我带来麻烦吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T09:39:08.793

Microsoft Access MVP Allen Browne 写了一篇关于 Microsoft Access 2007 和升级的综合文章：

[转换为 Access 2007](http://allenbrowne.com/Access2007.html)

这是微软的一篇文章：

[将现有 Access 应用程序转换为 Access 2007](http://msdn.microsoft.com/en-us/library/bb203849.aspx)

如果您不知道，可以[免费试用 2007](http://office.microsoft.com/en-us/FX102855291033.aspx)。我不建议在您经常用于其他 Access 工作的 PC 上进行尝试，这并非不可能，但事情会变得很尴尬。

如果你想在 2007 上运行你的 2003 版本，请确保你创建了一个 mde，否则你会遇到问题。Access 2007 以不同的方式处理多个控件，例如，带有日期字段的文本框会附加日历。您还需要检查您的参考资料。我还建议您对项目进行[自我认证](http://office.microsoft.com/en-us/access/HP010397921033.aspx)。除此之外，我还看到过有关许多问题的帖子，但这些通常是针对发帖人的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T18:15:56.207

我们最近刚刚经历了这个。

我们发现的一个问题是将*报告*转换为 Excel。他们从 Access 中删除了该功能，因此如果您这样做，则需要使用 Excel COM 对象模型以编程方式对其进行转换。我最终编写了一个函数来替换旧功能，但您仍然需要做一些杂耍。

# css - 我可以使用哪些“clearfix”方法？

> ID：211383
> 
> 赞同：883
> 
> 时间：2008-10-17T08:15:36.747
> 
> 标签：css, clearfix

`div`我有包装两列布局的古老问题。我的侧边栏是浮动的，所以我的容器`div`无法包装内容和侧边栏。

```
<div id="container">
  <div id="content"></div>
  <div id="sidebar"></div>
</div> 
```

似乎有很多方法可以修复 Firefox 中的明显错误：

*   `<br clear="all"/>`
*   `overflow:auto`
*   `overflow:hidden`

在我的情况下，唯一似乎工作正常的是`<br clear="all"/>`解决方案，它有点邋遢。`overflow:auto`给了我讨厌的滚动条，而且`overflow:hidden`肯定有副作用。此外，由于其不正确的行为，IE7 显然不应该遇到这个问题，但在我的情况下，它的问题与 Firefox 相同。

我们目前可用的哪种方法最可靠？

* * *

## 回答 #1

> 赞同：1060
> 
> 时间：2009-10-27T19:37:01.643

根据所产生的设计，以下每个 clearfix CSS 解决方案都有其自身的优点。

clearfix 确实有有用的应用程序，但它也被用作 hack。在使用 clearfix 之前，这些现代 CSS 解决方案可能会很有用：

*   [css 弹性盒](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)
*   [CSS网格](https://css-tricks.com/snippets/css/complete-guide-grid/)

* * *

# 现代 Clearfix 解决方案

* * *

## 容器与`overflow: auto;`

清除浮动元素的最简单方法是使用`overflow: auto`包含元素的样式。该解决方案适用于所有现代浏览器。

```
<div style="overflow: auto;">
  <img
    style="float: right;"
    src="path/to/floated-element.png"
    width="500"
    height="500"
  > 
  <p>Your content here…&lt;/p>
</div> 
```

一个缺点是，在外部元素上使用某些边距和填充的组合可能会导致出现滚动条，但这可以通过将边距和填充放在另一个包含父元素的元素上来解决。

使用 'overflow: hidden' 也是一个 clearfix 解决方案，但不会有滚动条，但是使用`hidden`会裁剪位于包含元素之外的任何内容。

*注意：*浮动元素`img`在本例中是一个标签，但可以是任何 html 元素。

* * *

## Clearfix 重新加载

CSSMojo 上的 Thierry Koblentz 写道：[最新的 clearfix reloaded](http://cssmojo.com/the-very-latest-clearfix-reloaded/)。他指出，通过放弃对 oldIE 的支持，解决方案可以简化为一个 css 语句。此外，当具有 clearfix 的元素是兄弟元素时，使用`display: block`(而不是`display: table`) 允许边距正确折叠。

```
.container::after {
  content: "";
  display: block;
  clear: both;
} 
```

这是 clearfix 的最现代版本。

* * *

⋮</p>

⋮</p>

# 较旧的 Clearfix 解决方案

以下解决方案对于现代浏览器不是必需的，但对于针对旧浏览器可能很有用。

请注意，这些解决方案依赖于浏览器错误，因此只有在上述解决方案都不适合您的情况下才应使用。

它们大致按时间顺序列出。

* * *

## “Beat That ClearFix”，现代浏览器的 clearfix

[CSS Mojo](http://www.cssmojo.com/latest_new_clearfix_so_far/)的蒂埃里·科布伦茨 (Thierry Koblentz)指出，在针对现代浏览器时，我们现在可以删除`zoom`and`::before`属性/值并简单地使用：

```
.container::after {
    content: "";
    display: table;
    clear: both;
} 
```

*此解决方案不支持 IE 6/7 ……故意的！*

Thierry 还提供：“[请注意](http://www.cssmojo.com/latest_new_clearfix_so_far/#why-is-that)：如果您从头开始一个新项目，请继续努力，但不要将这种技术与您现在拥有的技术互换，因为即使您不支持 oldIE，您现有的规则也会阻止崩溃的边距。”

* * *

## 微清除修复

最新和全球采用的 clearfix 解决方案，[Nicolas Gallagher 的 Micro Clearfix](http://nicolasgallagher.com/micro-clearfix-hack/)。

*已知支持：Firefox 3.5+、Safari 4+、Chrome、Opera 9+、IE 6+*

```
.container::before, .container::after {
  content: "";
  display: table;
}
.container::after {
  clear: both;
}
.container {
  zoom: 1;
} 
```

* * *

## 溢出属性

这种基本方法在通常情况下是首选的，当定位的内容不会显示在容器的边界之外时。

[http://www.quirksmode.org/css/clearing.html](http://www.quirksmode.org/css/clearing.html) -*解释如何解决与此技术相关的常见问题，即`width: 100%`在容器上设置。*

```
.container {
  overflow: hidden;
  display: inline-block;
  display: block;
} 
```

除了使用该`display`属性为 IE 设置“hasLayout”，还可以使用其他属性来[触发元素的“hasLayout”](http://www.satzansatz.de/cssd/onhavinglayout.html)。

```
.container {
  overflow: hidden;
  zoom: 1;
  display: block;
} 
```

`overflow`使用该属性清除浮点数的另一种方法是使用[下划线 hack](http://wellstyled.com/css-underscore-hack.html)。IE 将应用带有下划线前缀的值，其他浏览器不会。该属性在 IE 中`zoom`触发[hasLayout ：](http://www.satzansatz.de/cssd/onhavinglayout.html)

```
.container {
  overflow: hidden;
  _overflow: visible; /* for IE */
  _zoom: 1; /* for IE */
} 
```

虽然这可行......但使用黑客并不理想。

* * *

## PIE：简单的清算方法

这种较旧的“Easy Clearing”方法具有允许定位元素悬挂在容器边界之外的优点，但代价是更复杂的 CSS。

这个解决方案已经很老了，但你可以了解关于位置就是一切的简单清算：[http ://www.positioniseverything.net/easyclearing.html](http://www.positioniseverything.net/easyclearing.html)

* * *

## 使用“清除”属性的元素

当您快速将某些东西拍打在一起时，快速而肮脏的解决方案（有一些缺点）：

```
<br style="clear: both" /> <!-- So dirty! --> 
```

### 缺点

*   它不是响应式的，因此如果布局样式根据媒体查询发生变化，则可能无法提供所需的效果。纯 CSS 的解决方案更理想。
*   它添加 html 标记而不必添加任何语义值。
*   它需要每个实例的内联定义和解决方案，而不是对 css 中“clearfix”的单个解决方案的类引用和 html 中对它的类引用。
*   它使其他人难以使用代码，因为他们可能不得不编写更多的技巧来解决它。
*   将来当您需要/想要使用另一个 clearfix 解决方案时，您不必返回并删除`<br style="clear: both" />`标记周围散落的每个标签。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2012-03-29T19:54:41.480

## 我们试图解决什么问题？

浮动内容时有两个重要的考虑因素：

1.  **包含后代浮动。**这意味着有问题的元素使自己足够高以包裹所有浮动的后代。（他们不挂在外面。）

    ![浮动内容悬挂在其容器外](https://i.stack.imgur.com/3AUJp.png)

2.  **使后代与外部浮子绝缘。**这意味着元素内部的后代应该能够使用`clear: both`并且不与元素外部的浮动交互。

    ![<code>clear: both</code> 与 DOM 中其他地方的浮点数交互](https://i.stack.imgur.com/XIMXt.png)

## 块格式化上下文

只有一种方法可以做到这两点。那就是建立一个新的[块格式化上下文](https://developer.mozilla.org/en/CSS/block_formatting_context)。建立块格式化上下文的元素是一个绝缘的矩形，其中浮动相互交互。块格式化上下文总是足够高以可视地包装其浮动后代，并且块格式化上下文之外的任何浮动都不能与内部元素交互。这种双向绝缘正是您想要的。在 IE 中，同样的概念称为[hasLayout](http://www.satzansatz.de/cssd/onhavinglayout.html)，可以通过`zoom: 1`.

有几种方法可以建立块格式化上下文，但我推荐的解决方案是`display: inline-block`使用`width: 100%`. （当然，使用 using有一些[常见的注意事项](https://stackoverflow.com/questions/5219175/width-100-padding)`width: 100%`，所以使用`box-sizing: border-box`或放置`padding`, `margin`, 和`border`在不同的元素上。）

## 最强大的解决方案

浮动最常见的应用可能是两列布局。（可以扩展到三列。）

首先是标记结构。

```
<div class="container">
  <div class="sidebar">
    sidebar<br/>sidebar<br/>sidebar
  </div>
  <div class="main">
    <div class="main-content">
      main content
      <span style="clear: both">
        main content that uses <code>clear: both</code>
      </span>
    </div>
  </div>
</div> 
```

现在是 CSS。

```
/* Should contain all floated and non-floated content, so it needs to
 * establish a new block formatting context without using overflow: hidden.
 */
.container {
  display: inline-block;
  width: 100%;
  zoom: 1; /* new block formatting context via hasLayout for IE 6/7 */
}

/* Fixed-width floated sidebar. */
.sidebar {
  float: left;
  width: 160px;
}

/* Needs to make space for the sidebar. */
.main {
  margin-left: 160px;
}

/* Establishes a new block formatting context to insulate descendants from
 * the floating sidebar. */
.main-content {
  display: inline-block;
  width: 100%;
  zoom: 1; /* new block formatting context via hasLayout for IE 6/7 */
} 
```

## 自己试试

去[JS Bin](http://jsbin.com/eciwev/1/edit)玩弄代码，看看这个解决方案是如何从头开始构建的。

## 传统的 clearfix 方法被认为是有害的

传统的[clearfix](http://www.positioniseverything.net/easyclearing.html) [解决方案](http://nicolasgallagher.com/micro-clearfix-hack/)的问题在于，它们使用两种不同的渲染概念来实现 IE 和其他所有人的相同目标。在 IE 中，他们使用 hasLayout 来建立新的块格式化上下文，但对于其他所有人，他们使用生成的框 ( `:after`) with `clear: both`，这不会建立新的块格式化上下文。这意味着事情不会在所有情况下都表现相同。有关这不好的原因的解释，请参阅[关于 Clearfix 的所有知识都是错误的](http://www.cssmojo.com/clearfix_block-formatting-context_and_hasLayout/)。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2013-04-19T07:28:57.607

[Inuit.css](http://inuitcss.com/)和[Bourbon](http://bourbon.io)使用的最新标准- 两个非常广泛使用且维护良好的 CSS/Sass 框架：

```
.btcf:after {
    content:"";
    display:block;
    clear:both;
} 
```

* * *

### 笔记

请记住，clearfixes 本质上是对 flexbox 布局现在可以以[更容易和更智能的方式](https://philipwalton.github.io/solved-by-flexbox/)提供的内容的一种破解。CSS 浮动最初是为内联内容的流动而设计的 - 就像长篇文章中的图像 - 而不是网格布局等。除非您专门针对旧的（不是 Edge）Internet Explorer，否则您的[目标浏览器支持 flexbox](http://caniuse.com/#feat=flexbox)，因此值得花时间学习。

这不支持IE7。你**不**应该支持IE7。这样做会继续使用户暴露于未修复的安全漏洞，并使所有其他 Web 开发人员的生活更加艰难，因为它减轻了用户和组织切换到更安全的现代浏览器的压力。

这个 clearfix 是[由 Thierry Koblentz 在 2012 年 7 月宣布和解释的。它减轻了](http://www.css-101.org/articles/clearfix/latest-new-clearfix-so-far.php)[Nicolas Gallagher 2011 年 micro-clearfix 的](http://nicolasgallagher.com/micro-clearfix-hack/)不必要的重量。在此过程中，它释放了一个伪元素供您自己使用。这已更新为使用，`display: block`而不是`display: table`（再次归功于 Thierry Koblentz）。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2010-09-27T15:16:11.070

我建议使用以下内容，取自[http://html5boilerplate.com/](http://html5boilerplate.com/)

```
/* >> The Magnificent CLEARFIX << */ 
```

```
.clearfix:after { 
  content: "."; 
  display: block; 
  height: 0; 
  clear: both; 
  visibility: hidden; 
}
.clearfix { 
  display: inline-block;  
}
* html .clearfix {  
  height: 1%;  
} /* Hides from IE-mac \*/
.clearfix {  
  display: block;  
} 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2009-02-10T11:20:54.837

溢出属性可用于清除浮动而无需额外标记：

```
.container { overflow: hidden; } 
```

这适用于除 IE6 之外的所有浏览器，您需要做的就是启用 hasLayout（缩放是我的首选方法）：

```
.container { zoom: 1; } 
```

[http://www.quirksmode.org/css/clearing.html](http://www.quirksmode.org/css/clearing.html)

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2009-01-20T15:50:12.757

我在官方 CLEARFIX-Method 中发现了一个错误：DOT 没有字体大小。如果你设置`height = 0`DOM 树中的第一个元素有“clearfix”类，你总是在页面底部有 12px 的边距:)

你必须像这样修复它：

```
/* float clearing for everyone else */
.clearfix:after{
  clear: both;
  content: ".";
  display: block;
  height: 0;
  visibility: hidden;
  font-size: 0;
} 
```

它现在是 YAML 布局的一部分......看看它 - 它非常有趣！ [http://www.yaml.de/en/home.html](http://www.yaml.de/en/home.html)

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2011-04-21T14:46:44.210

这是一个非常整洁的解决方案：

```
/* For modern browsers */
.cf:before,
.cf:after {
    content:"";
    display:table;
}

.cf:after {
    clear:both;
}

/* For IE 6/7 (trigger hasLayout) */
.cf {
    zoom:1;
} 
```

> 众所周知，它适用于 Firefox 3.5+、Safari 4+、Chrome、Opera 9+、IE 6+
> 
> 包括 :before 选择器不是清除浮动所必需的，但它可以防止上边距在现代浏览器中折叠。这可确保在应用 zoom:1 时与 IE 6/7 具有视觉一致性。

来自[http://nicolasgallagher.com/micro-clearfix-hack/](http://nicolasgallagher.com/micro-clearfix-hack/)

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2012-12-05T07:12:19.783

来自引导程序的 Clearfix：

```
.clearfix {
  *zoom: 1;
}

.clearfix:before,
.clearfix:after {
  display: table;
  line-height: 0;
  content: "";
}

.clearfix:after {
  clear: both;
} 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2011-02-21T13:03:15.007

我只是使用：-

```
.clear:after{
  clear: both;
  content: "";
  display: block;
} 
```

效果最好并且与 IE8+ 兼容 :)

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2015-03-19T23:22:18.173

鉴于大量的回复，我不会发布。但是，这种方法可能会帮助某人，因为它确实帮助了我。

## 尽可能远离花车

值得一提的是，我避免像埃博拉这样的漂浮物。有很多原因，我并不孤单；阅读有关[什么是 clearfix 的](https://stackoverflow.com/questions/8554043/what-is-clearfix)Rikudo 答案，您就会明白我的意思。用他自己的话来说：`...the use of floated elements for layout is getting more and more discouraged with the use of better alternatives...`

除了浮动之外，还有其他好的（有时是更好的）选择。随着技术的进步和改进，[flexbox](https://developer.mozilla.org/en-US/docs/CSS/Using_CSS_flexible_boxes)（和其他方法）将被广泛采用，浮动将成为一种糟糕的记忆。也许是CSS4？

* * *

## 浮动不当行为和失败的清除

首先，有时，您可能会认为在您的救生员被刺破并且您的 html 流开始下沉之前，您可以避免浮动：

在下面的 codepen [http://codepen.io/omarjuvera/pen/jEXBya](http://codepen.io/omarjuvera/pen/jEXBya)中，用（或其他元素）清除浮点数的做法`<div classs="clear"></div>`很常见，但不受欢迎且反语义。

```
<div class="floated">1st</div>
<div class="floated">2nd</div>
<div class="floated">3nd</div>
<div classs="clear"></div> <!-- Acts as a wall -->
<section>Below</section> 
```

**CSS**

```
div {
    border: 1px solid #f00;
    width: 200px;
    height: 100px;
}

div.floated {
    float: left;
}

.clear {
    clear: both;
}
section {
    border: 1px solid #f0f;
} 
```

**然而**，就在您认为您的浮标值得航行的时候……轰！随着屏幕尺寸变得越来越小，您会看到如下图所示的奇怪行为（相同的[http://codepen.io/omarjuvera/pen/jEXBya](http://codepen.io/omarjuvera/pen/jEXBya)）：

![浮动错误示例 1](https://i.stack.imgur.com/BHCiv.png)

**你为什么要关心？** 大约 80%（或更多）使用的设备是带有小屏幕的移动设备。台式电脑/笔记本电脑不再是王道。

* * *

## 它并没有就此结束

这不是浮动的唯一问题。有很多，但在这个例子中，有些人可能会说`all you have to do is to place your floats in a container`。但正如您在[代码笔](http://codepen.io/omarjuvera/pen/XJoMYG)和图形中看到的那样，情况并非如此。这显然使事情变得更糟：

HTML

```
<div id="container" class="">
  <div class="floated">1st</div>
  <div class="floated">2nd</div>
  <div class="floated">3nd</div>
</div> <!-- /#conteiner -->
<div classs="clear"></div> <!-- Acts as a wall -->
<section>Below</section> 
```

CSS

```
#container {
  min-height: 100px; /* To prevent it from collapsing */
  border: 1px solid #0f0;
}
.floated {
    float: left;
    border: 1px solid #f00;
    width: 200px;
    height: 100px;
}

.clear {
    clear: both;
}
section {
    border: 1px solid #f0f;
} 
```

至于结果？

一样的！ ![浮动错误示例 2](https://i.stack.imgur.com/SDY1J.png)

至少你知道，你将开始一个 CSS 派对，邀请各种选择器和属性参加派对；使你的 CSS 比你开始的更混乱。只是为了修复你的浮动。

* * *

## CSS Clearfix 救援

这段简单且适应性很强的 CSS 是一个美丽和“救世主”：

```
.clearfix:before, .clearfix:after { 
    content: "";
    display: table;
    clear: both;
    zoom: 1; /* ie 6/7 */
} 
```

就是这样！它真的可以在不破坏语义的情况下工作，我有没有提到[它有效？](http://codepen.io/omarjuvera/pen/wBRJaz)：

来自同一个示例... **HTML**

```
<div class="clearfix">
    <div class="floated">1st</div>
    <div class="floated">2nd</div>
    <div class="floated">3nd</div>
</div>
<section>Below</section> 
```

**CSS**

```
div.floated {
    float: left;
    border: 1px solid #f00;
    width: 200px;
    height: 100px;
}
section {
        border: 4px solid #00f;
}

.clearfix:before, .clearfix:after { 
    content: "";
    display: table;
    clear: both;
    zoom: 1; /* ie 6/7 */
} 
```

* * *

现在我们不再需要`<div classs="clear"></div> <!-- Acts as a wall -->`并让语义警察满意了。这不是唯一的好处。这个 clearfix 可以响应任何屏幕尺寸，而无需以`@media`最简单的形式使用。换句话说，它将保持您的浮动容器处于检查状态并防止洪水泛滥。最后，它在一个小的空手道印章中提供了对旧浏览器的支持 =)

# 这里又是 clearfix

```
.clearfix:before, .clearfix:after { 
    content: "";
    display: table;
    clear: both;
    zoom: 1; /* ie 6/7 */
} 
```

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2011-08-18T02:12:14.643

我总是浮动网格的主要部分并应用于`clear: both;`页脚。这不需要额外的 div 或类。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2010-07-07T16:39:45.810

诚实地; 所有解决方案似乎都是修复渲染错误的技巧......我错了吗？

我发现`<br clear="all" />`这是最简单，最简单的。随处`class="clearfix"`可见不能触动那些反对无关标记元素的人的感受，不是吗？您只是在不同的画布上绘制问题。

我也使用这个`display: hidden`解决方案，它很棒，不需要额外的类声明或 html 标记......但有时你需要元素溢出容器，例如。漂亮的丝带和腰带

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2013-03-15T16:24:49.807

```
.clearFix:after { 
    content: "";
    display: table;  
    clear: both;  
} 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2009-08-27T13:19:40.403

如果浮动容器有父元素，则对 ie6使用`overflow:hidden`/和 height 就足够了。`auto`

#test 中的任何一个都可以工作，以便下面所述的 HTML 清除浮动。

```
#test {
  overflow:hidden; // or auto;
  _height:1%; forces hasLayout in IE6
}

<div id="test">
  <div style="floatLeft"></div>
  <div style="random"></div>
</div> 
```

如果这拒绝与 ie6 一起使用，只需浮动父级以清除浮动。

```
#test {
  float: left; // using float to clear float
  width: 99%;
} 
```

从来没有真正需要任何其他类型的清理。也许这是我编写 HTML 的方式。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2013-03-20T12:00:23.043

使用 LESS ( [http://lesscss.org/](http://lesscss.org/) )，可以创建一个方便的 clearfix 助手：

```
.clearfix() {
  zoom: 1;
  &:before { 
    content: ''; 
    display: block; 
  }
  &:after { 
    content: ''; 
    display: table; 
    clear: both; 
  }
} 
```

然后将它与有问题的容器一起使用，例如：

```
<!-- HTML -->
<div id="container">
  <div id="content"></div>
  <div id="sidebar"></div>
</div> 
```

```
/* LESS */
div#container {
  .clearfix();
} 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2014-05-05T18:46:16.850

使用 SASS，clearfix 是：

```
@mixin clearfix {
    &:before, &:after {
        content: '';
        display: table;
    }
    &:after {
        clear: both;
    }
    *zoom: 1;
} 
```

它的用法如下：

```
.container {
    @include clearfix;
} 
```

如果你想要新的 clearfix：

```
@mixin newclearfix {
    &:after {
        content:"";
        display:table;
        clear:both;
    }
} 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2017-08-17T11:45:56.000

一个新的显示值似乎在一行中完成。

```
display: flow-root; 
```

来自 W3 规范：“元素生成一个块容器框，并使用流布局布置其内容。它总是为其内容建立一个新的块格式化上下文。”

信息： [https ://www.w3.org/TR/css-display-3/#valdef-display-flow-root](https://www.w3.org/TR/css-display-3/#valdef-display-flow-root) [https://www.chromestatus.com/feature/5769454877147136](https://www.chromestatus.com/feature/5769454877147136)

※如上面的链接所示，目前支持有限，因此可以使用如下的后备支持： [https ://github.com/fliptheweb/postcss-flow-root](https://github.com/fliptheweb/postcss-flow-root)

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2012-09-02T10:22:32.867

`<html>`我已经尝试了所有这些解决方案，当我使用下面的代码时，会自动为元素添加一个很大的边距：

```
.clearfix:after {   
    visibility: hidden;   
    display: block;   
    content: ".";   
    clear: both;   
    height: 0;
} 
```

`font-size: 0;`最后，我通过添加到上面的 CSS解决了边距问题。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2010-05-26T03:16:51.540

我也会浮动`#content`，这样两列都包含浮动。也因为它允许您在`#content`不清除侧栏的情况下清除内部元素。

与包装器相同，您需要将其设为块格式化上下文来包装两列。

本文提到了一些您可以使用的触发器： [块格式化上下文](http://www.tjkdesign.com/articles/block-formatting-contexts_and_hasLayout.asp)。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2012-10-26T05:29:11.737

clearfix 是一种元素在其自身之后自动清除的方式，因此您无需添加额外的标记。

```
.clearfix:after {
   content: " "; /* Older browser do not support empty content */
   visibility: hidden;
   display: block;
   height: 0;
   clear: both;
}
.cleaner {
  clear: both;
} 
```

通常，您需要执行以下操作：

```
<div style="float: left;">Sidebar</div>
<div class="cleaner"></div> <!-- Clear the float --> 
```

使用 clearfix，您只需要

```
<div style="float: left;" class="clearfix">Sidebar</div>
<!-- No Clearing div! --> 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2011-05-20T12:52:47.400

为什么只是尝试使用 css hack 来完成 1 行 HTML 的工作。而为什么不使用语义化的 html tu put break 来返回行呢？

我真的更好用：

```
<br style="clear:both" /> 
```

如果你不想在你的 html 中使用任何样式，你只需要使用 class 来休息并放入`.clear { clear:both; }`你的 CSS。

这样做的好处：

*   html的语义使用返回行
*   如果没有 CSS 加载，它将正常工作
*   无需额外的 CSS 代码和 Hack
*   不需要用 CSS 模拟 br，它已经存在于 HTML 中

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2011-06-19T19:42:55.330

假设您使用的是这个 HTML 结构：

```
<div id="container">
  <div id="content">
  </div>
  <div id="sidebar">
  </div>
</div> 
```

这是我将使用的 CSS：

```
div#container {
    overflow: hidden;    /* makes element contain floated child elements */
}

div#content, div#sidebar {
    float: left;
    display: inline;    /* preemptively fixes IE6 dobule-margin bug */
} 
```

我一直使用这个设置，它对我来说很好，即使在 IE6 中也是如此。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2014-01-07T19:02:52.680

我总是使用[**micro-clearfix**](http://nicolasgallagher.com/micro-clearfix-hack/)：

```
.cf:before,
.cf:after {
    content: " ";
    display: table;
}

.cf:after {
    clear: both;
}

/**
 * For IE 6/7 only
 */
.cf {
    *zoom: 1;
} 
```

在[**Cascade Framework**](http://jslegers.github.io/cascadeframework/)中，我什至默认将它应用于块级元素。IMO，默认情况下将它应用于块级元素使块级元素的行为比它们的传统行为更直观。它还使我更容易将对旧浏览器的支持添加到 Cascade 框架（它支持 IE6-8 以及现代浏览器）。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2015-04-08T11:20:18.157

# 与其他清除修复不同，这是一个没有容器的开放式修复

其他 clearfixes 要么要求浮动元素位于标记良好的容器中，要么需要一个额外的、语义上为空的`<div>`. 相反，内容和标记的清晰分离需要**一个严格的 CSS 解决方案**来解决这个问题。

仅仅需要标记浮点数的结尾这一事实就不允许[**无人看管的 CSS 排版**](https://tex.stackexchange.com/a/340365/26348)。

如果后者是您的目标，则浮动应该对任何东西（段落、有序和无序列表等）保持开放状态，以环绕它，直到遇到“clearfix”。例如，clearfix 可能由新标题设置。

这就是我使用以下带有新标题的 clearfix 的原因：

```
h1 {
    clear: both;
    display: inline-block;
    width: 100%;
} 
```

[这个解决方案在我的网站](http://hamwaves.com/capacitors/en/index.html)上被广泛使用来解决这个问题：浮动缩影旁边的文本很短，并且下一个清除对象的上边距没有得到尊重。

在从站点自动生成[PDF](http://hamwaves.com/capacitors/en/capacitors.letter.pdf)时，它还可以防止任何手动干预。这是一个[示例页面](http://hamwaves.com/capacitors/en/index.html)。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2011-04-01T22:50:58.063

你也可以把它放在你的 CSS 中：

```
.cb:after{
  visibility: hidden;
  display: block;
  content: ".";
  clear: both;
  height: 0;
}

*:first-child+html .cb{zoom: 1} /* for IE7 */ 
```

并将类“cb”添加到您的父 div：

```
<div id="container" class="cb"> 
```

您无需在原始代码中添加任何其他内容...

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2013-03-08T10:13:38.497

```
#content{float:left;}
#sidebar{float:left;}
.clear{clear:both; display:block; height:0px; width:0px; overflow:hidden;}
```

```
<div id="container">
  <div id="content">text 1 </div>
  <div id="sidebar">text 2</div>
  <div class="clear"></div>
</div>
```

* * *

## 回答 #27

> 赞同：-2
> 
> 时间：2008-10-17T08:34:53.447

你有没有试过这个：

```
<div style="clear:both;"/> 
```

我对这种方法没有任何问题。

* * *

## 回答 #28

> 赞同：-2
> 
> 时间：2016-03-10T09:25:46.807

我最喜欢的方法是在我的 css / scss 文档中创建一个 clearfix 类，如下所示

```
.clearfix{
    clear:both;
} 
```

然后在我的html文档中调用如下图

```
<html>
  <div class="div-number-one">
    Some Content before the clearfix
  </div>

  <!-- Let's say we need to clearfix Here between these two divs --->
  <div class="clearfix"></div>

  <div class="div-number-two">
    Some more content after the clearfix
  </div>
</html> 
```

* * *

## 回答 #29

> 赞同：-3
> 
> 时间：2019-07-17T10:47:15.687

当我们在 div 元素中使用 float 属性时，clearfix 就这么简单地解决了这个问题。如果我们使用两个 div 元素一个作为 float:left; 另一个作为浮动：对；我们可以对两个 div 元素的父级使用 clearfix。如果我们拒绝使用 clearfix 不必要的空格填充下面的内容，网站结构将被破坏。

# c++ - 开源 C++ 数据可视化库

> ID：211384
> 
> 赞同：8
> 
> 时间：2008-10-17T08:15:52.597
> 
> 标签：c++, open-source, visualization

我们希望在桌面 GUI 中包含数据可视化（主要是时间线和图表；可点击、可拖动）。我们希望限制为开放源代码、非 Copyleft C++ 库，这些库允许商业用途并且可跨多个平台移植。我可以使用哪个库？我们的 GUI 基于 WxWidgets。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T08:44:21.057

有[VTK](http://www.vtk.org/)。

如果你喜欢数据可视化，也可以看看[opendx](http://www.opendx.org/highlights.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T14:51:46.010

如果您还说明了您使用的其他 GUI 组件，我认为这个问题会更容易回答。也许这限制了可用库的选择。既然你是 C++ 和跨平台的，也许是 wxWindows？不用猜测就好了。

# wcf - MSMQ 上的 WCF 不起作用

> ID：211385
> 
> 赞同：3
> 
> 时间：2008-10-17T08:16:00.583
> 
> 标签：wcf, security, msmq

我的任务是实现一个使用 NetMsmqBinding 的 WCF 服务。我编写了服务，它运行良好。问题是他们在最后一刻告诉我不会有 Active Directory 集成。所以我不知道如何配置服务的安全性。服务和客户端机器之间有一条 VPN 隧道，但它们不使用相同的活动目录。请指教。任何帮助或教程将不胜感激。

* * *

问题是该服务并不总是在线。这就是为什么在这种情况下首选使用 WCF 而不是 MSMQ 的原因。所以我通过 MSMQ 发送单向消息 - 效果很好。我唯一的问题是我是 WCF 新手，不熟悉 WCF 安全性。我希望能够对消息进行签名和加密，因为要发送到服务的信息是机密的。我想确保只有授权的客户才能调用该服务。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T16:51:26.317

我不确定我是否理解你的问题，如果我错了，请纠正我。我最近一直在使用托管在没有可用 Active Directory 的计算机上的 WCF 服务。我们使用证书保护它。它是您的选择吗？这非常轻松（如果您通过了“将证书放入商店并授予正确的用户访问权限”部分）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T18:49:41.430

您应该能够利用网络透明性。

使用 Web 服务从一个系统到另一个系统进行通信。您可能需要处理额外的延迟，但它应该仍然可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T03:55:32.200

首先，您可以使用 WCF 的安全性，即 WS-* 的东西。这里的一些信息：

*   [http://blogs.msdn.com/motleyqueue/archive/2007/10/06/complementing-msmq-security-with-wcf.aspx](http://blogs.msdn.com/motleyqueue/archive/2007/10/06/complementing-msmq-security-with-wcf.aspx)

其次，您可能会发现此博客很有帮助：

*   [http://blogs.msdn.com/johnbreakwell/default.aspx](http://blogs.msdn.com/johnbreakwell/default.aspx)

其中一篇关于跨域发送的文章提到了这篇文章（跨企业支持）：

*   [http://msdn.microsoft.com/en-us/library/ms705127(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms705127(VS.85).aspx)

这可能会帮助您进行一般配置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T08:36:21.057

谢谢你，迈克尔，但这些信息没有帮助......

我发现了这个：[http](http://www.codeplex.com/WCFSecurityGuide/Release/ProjectReleases.aspx?ReleaseId=14070) ://www.codeplex.com/WCFSecurityGuide/Release/ProjectReleases.aspx?ReleaseId=14070 - 一本来自“Microsoft Pattern & Practices”的书，它详细描述了 WCF 中的安全性 - 每个人都必须阅读WCF 开发人员。

# java - 以原子方式更新多行

> ID：211399
> 
> 赞同：4
> 
> 时间：2008-10-17T08:26:44.387
> 
> 标签：java, database, jdbc, atomic

我需要执行一个选择，然后`ResultSet`以原子方式更新其中的一些行。

我使用的代码看起来像（简化）：

```
stmt = con.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE, ResultSet.CONCUR_UPDATABLE);
rs = stmt.executeQuery("SELECT ...");

while (rs.next()) {
    if (conditions_to_update) {
        rs.updateString(...);
        rs.updateRow();
    }
} 
```

*   我可以保证更新将自动执行吗？如果不是，我怎么能保证呢？
*   如果任何其他进程更改了您正在更新的数据库行，会发生什么`updateRow()`？有什么办法可以锁定中的行`ResultSet`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T09:02:48.197

可能有一大堆技术和概念在这里发挥作用，当您开始考虑多线程/多请求应用程序时，事情开始变得相当棘手。

正如 Iassevk 所说，您应该考虑使用[Transactions](http://java.sun.com/docs/books/tutorial/jdbc/basics/transactions.html)来确保更新的原子性 - 一个非常低级的示例是执行以下操作：

```
...
con.setAutoCommit(false);
try {
  while (rs.next()) {
    if (conditions_to_update) {
      rs.updateString(...);
      rs.updateRow();
    }
  }
  con.setAutoCommit(true);
} catch (Exception ex) {
  //log the exception and rollback
  con.rollback();
} finally {
  con.close();
} 
```

然后，所有更新将被批处理到同一个事务中。如果任何更新产生异常（例如无效值或连接在结果中途失败），则整个批次将被回滚。（最后添加是因为我是它的拥护者；p）

但是，这不会解决您的第二个问题，即尝试更新同一张表的两种竞争方法 - 竞争条件。在我看来，这里有两种主要方法——每种方法都有其优点和缺点。

最简单的方法是[锁定表](http://dev.mysql.com/doc/refman/5.0/en/lock-tables.html)——这将需要最少的代码更改，但有一个很大的缺点。假设与大多数应用程序一样，读比写更多：锁定表将阻止所有其他用户查看数据，代码可能会挂起，等待锁定在连接超时之前释放启动并引发异常。

更复杂的方法是确保执行这些更新的方法以线程安全的方式实现。为此：

*   此表的所有更新都通过一个类
*   该类实现单例模式，或将更新方法公开为静态方法
*   更新方法利用[Synchronized](http://java.sun.com/docs/books/tutorial/essential/concurrency/syncmeth.html)关键字来防止竞争条件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T08:27:51.183

使用事务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T14:47:07.550

> 如果任何其他进程更改了您通过 updateRow() 更新的数据库行，会发生什么情况？有没有办法锁定 ResultSet 中的行？

在 Oracle 中，您可以通过发出以下 SQL 来标记某些行以进行更新。

```
select cola, colB from tabA for update; 
```

尝试更新此行的下一个事务/线程/应用程序将获得异常。有关更多详细信息，请参见此处- [http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:4530093713805](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:4530093713805)

# php - PHP 数组帮助

> ID：211403
> 
> 赞同：2
> 
> 时间：2008-10-17T08:28:40.247
> 
> 标签：php, arrays

我有一个数组，它是一个域列表，我想打印数组中的所有项目，除了包含 $x 的项目。$x 是可变的，所以基本上当它包含 $x 时它从不打印数组项。谁能帮我？:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T08:37:01.760

假设您不想打印等于 $x 的数组值，Darkey 的答案是正确的 - 但如果您不想打印那些“包含” $x 的值，请尝试：

```
foreach ($array as $key => $value) {
    if (strpos($value, $x) === false) {
         print($value);
    }
} 
```

如果 $x = stack，则将排除诸如“stackoverflow.com”和“getstacked.org”之类的条目

# lucene - 在 Solr 中使用 Nutch 爬虫

> ID：211411
> 
> 赞同：13
> 
> 时间：2008-10-17T08:32:39.007
> 
> 标签：lucene, solr, nutch

我能否将 Apache Nutch 爬虫与 Solr 索引服务器集成？

**编辑：**

我们的一位开发人员从这些帖子中想出了一个解决方案

1.  [运行 Nutch 和 Solr](http://wiki.apache.org/nutch/RunningNutchAndSolr)
2.  [运行 Nutch 和 Solr 的更新](http://www.mail-archive.com/nutch-commits@lucene.apache.org/msg02227.html)

**回答**

是的

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-08T19:08:42.567

If you're willing to upgrade to nutch 1.0 you can use the solrindex as described in this article by Lucid Imagination: [http://www.lucidimagination.com/blog/2009/03/09/nutch-solr/](http://www.lucidimagination.com/blog/2009/03/09/nutch-solr/).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-13T06:54:14.353

nutch 2.x 设计为默认使用 solr。您可以按照[http://wiki.apache.org/nutch/Nutch2Tutorial](http://wiki.apache.org/nutch/Nutch2Tutorial)中的步骤进行操作，或者按照“使用 Apache Nutch 进行 Web 爬网和数据挖掘”一书中更好的说明进行操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T01:13:56.933

这仍然是一个[悬而未决的问题](https://issues.apache.org/jira/browse/NUTCH-442)。如果您喜欢冒险，可以尝试自己应用这些补丁，尽管看起来[并不那么简单](http://www.mail-archive.com/nutch-user@lucene.apache.org/msg10872.html)

# c# - 可为空的 GUID

> ID：211436
> 
> 赞同：31
> 
> 时间：2008-10-17T08:40:53.950
> 
> 标签：c#, .net, sql-server, guid, nullable

在我的数据库中，在其中一个表中，我有一个允许空值的 GUID 列。我有一个指导方法？在表中插入新数据行的参数。但是，当我说 myNewRow.myGuidColumn = myGuid 时，我收到以下错误：“无法隐式转换类型'System.Guid？' 到‘System.Guid’。”

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-17T08:48:01.363

ADO.NET API 在处理可空值类型时存在一些问题（即它根本无法正常工作）。我们没有解决它的问题，因此得出的结论是最好手动将值设置为空，例如

```
myNewRow.myGuidColumn = myGuid == null ? (object)DBNull.Value : myGuid.Value 
```

ADO.NET 应该处理令人痛苦的额外工作，但它似乎并不可靠（即使在 3.5 SP1 中）。这至少可以正常工作。

我们还看到了将可空值类型传递给 SqlParameters 的问题，其中生成的 SQL 包含关键字`DEFAULT`而不是`NULL`值，因此我建议在构建参数时使用相同的方法。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-17T08:48:29.943

好的; myGuidColumn 是如何定义的，myGuid 是如何定义的？

如果 myGuid 是`Guid?`并且 myGuidColumn 是`Guid`，那么错误是正确的：您将需要使用`myGuid.Value`, 或`(Guid)myGuid`获取值（如果它为 null，则会抛出），或者如果为 null，则可能`myGuid.GetValueOrDefault()`返回零 guid。

如果 myGuid 是`Guid`并且 myGuidColumn 是`Guid?`，那么它应该可以工作。

如果 myGuidColumn 是`object`，您可能需要`DBNull.Value`代替常规的 null。

当然，如果该列确实可以为空，您可能只想确保它`Guid?`在 C# 代码中；-p

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-17T12:05:00.437

与格雷格·比奇的回答相同

```
myNewRow.myGuidColumn = (object)myGuid ?? DBNull.Value 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-11-02T12:46:12.513

您必须转换`null`为 a `nullable Guid`，这对我来说是如何工作的：

```
myRecord.myGuidCol = (myGuid == null) ? (Guid?)null : myGuid.Value 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-06-15T14:03:04.673

在您希望它为空的地方尝试 System.Guid.Empty

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-17T10:33:45.847

如果您想避免在您的 c# 代码中使用可为空的 GUID（就我个人而言，我经常发现使用可为空的类型很麻烦），您可以在某个地方提前将[Guid.Empty](http://msdn.microsoft.com/en-us/library/system.guid.empty.aspx)分配给在数据库中为空的 .NET 数据。这样，您就不必费心处理所有 .HasValue 的东西，只需检查 if 即可`myGuid != Guid.Empty`。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-17T10:19:57.697

或者：

```
 internal static T CastTo<T>(object value)
    {
        return value != DBNull.Value ? (T)value : default(T);
    } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-17T09:15:44.893

您可以使用辅助方法：

```
public static class Ado {
    public static void SetParameterValue<T>( IDataParameter parameter, T? value ) where T : struct {
        if ( null == value ) { parameter.Value = DBNull.Value; }
        else { parameter.Value = value.Value; }
    }
    public static void SetParameterValue( IDataParameter parameter, string value ) {
        if ( null == value ) { parameter.Value = DBNull.Value; }
        else { parameter.Value = value; }
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-05-08T14:43:16.100

如果您喜欢扩展方法...

```
/// <summary>
/// Returns nullable Guid (Guid?) value if not null or Guid.Empty, otherwise returns DBNull.Value
/// </summary>
public static object GetValueOrDBNull(this Guid? aGuid)
{
  return (!aGuid.IsNullOrEmpty()) ? (object)aGuid : DBNull.Value;
}

/// <summary>
/// Determines if a nullable Guid (Guid?) is null or Guid.Empty
/// </summary>
public static bool IsNullOrEmpty(this Guid? aGuid)
{
  return (!aGuid.HasValue || aGuid.Value == Guid.Empty);
} 
```

然后你可以说： `myNewRow.myGuidColumn = myGuid.GetValueOrDBNull();`

注意：这将在 时插入 null `myGuid == Guid.Empty`，如果您想在列中允许空 Guid，您可以轻松调整该方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-10-19T11:59:46.167

```
Guid? _field = null;
if (myValue!="")//test if myValue has value
{
_field = Guid.Parse(myValue)
} 
```

# windows - COM 注册如何在 Windows 中工作

> ID：211440
> 
> 赞同：7
> 
> 时间：2008-10-17T08:41:55.260
> 
> 标签：windows, com, registry

我是一名应用程序打包者，试图了解 COM 注册表项 (SelfReg) 如何与 Windows 中的给定 .dll 相互关联。

ProgID's、AppID's、TypeLibs、Extensions & Verbs 都与 CLSID 相关联，对吧？CLSID 是否总是使用 Prog/App ID，或者您可以只使用文件扩展名类吗？哪些位是可选的？

其中一些似乎“像路由器”，其中有两个接口（内部 - .dll）和外部（扩展等）。

这一切如何适应？（SDK 文档对我来说没有意义）

我问，因为这对于使用 Windows Installer 进行应用程序“修复”至关重要（哪些打包程序都是“大”的，但没有任何细节故障，因为它确实是一个编码器）

---编辑：我是否可以安全地假设对于注册的 COM，它必须全部链接回 CLSID 并且不能成为“死胡同”？动词需要扩展而需要 progid 的...

AppId、TypeLibs 和接口呢？它们如何相互关联？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T09:59:41.920

首先要意识到，COM dll 自己注册。他们会将所有必需的条目放入注册表中的正确位置。

我认为您关于哪些位是可选的核心问题的答案可能是它们对于不同类型的对象都是可选的。如果自动化对象是可公开创建的，则它们需要 Prog/AppID，但如果它们仅在内部创建则可能不需要，类似地，可以列出不可公开创建的 COM 类。

许多没有自动化接口的 COM 对象（例如微软在 Windows 内部使用的许多 COM 类将没有任何 ProgId，而只会在其 CLSID 下的 HKCR\CLSID 中具有一个条目。

如果我对您的理解正确，您会从安装人员的角度对此感兴趣。我想你需要做的就是要求用户指定哪些 dll 是自注册的，然后调用

> regsvr32 dllname.dll

或者

> exename.exe /注册服务器

对于进程外服务器。如果出现问题，您只需要调用对立面。

> regsvr32 /u dllname.dll

或者

> exename.exe /Unregserver

我希望这能回答你的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T22:41:18.997

我会推荐这本书[Inside COM](https://rads.stackoverflow.com/amzn/click/com/1572313498)。

即使在 COM 的鼎盛时期，它也不是最新的参考资料，但它很好地解释了基础知识，**包括所有注册表 goo**。另外，我敢打赌，你可以买到真正便宜的二手副本。

我知道这不是一个答案，但记住关于注册表的章节是什么样子的——一个非特定的“它是如何工作的”问题需要一个非常*非常*长的答案......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T00:19:46.130

我使用了一个答案，因为评论似乎很有限。不确定 SO 将如何解释这一点（也许我会因为自言自语而被视为生气？）

> “它是如何工作的”问题需要一个非常非常长的答案

谢谢 - 我想要实现的是在没有真正成为开发人员的情况下理解这一点 - 这是因为打包者试图将 COM 注册表项与 .dll （在同一组件中）分组的方式，以便应用程序弹性工作。

这意味着从 .dll 的注册中“捕获”COM，并将其在正确的广告表（CLSID、AppID ... *ad nauseum*）中与包含 .dll 的组件相关联。有时这并不容易看到，有时（我被告知）它可能会破坏应用程序的运行。我被告知 COM**不需要**是完整的（自引用）。

我仍在努力解决这一切。当然，如果打包程序捕获了所有信息但没有将 COM 信息与 .dll 相关联，则 regkeys 仍然在安装时编写，只是 MSI 在出现问题时不会照看应用程序（这几乎从来没有）

# tomcat - 如何在 WinXP 64 位上运行 Tomcat 6？

> ID：211446
> 
> 赞同：17
> 
> 时间：2008-10-17T08:43:30.310
> 
> 标签：tomcat, service, windows-xp, 64-bit

在 WinXP 64 上安装了 Tomcat 6。它安装得很好。但是当我尝试（从 Windows 服务）启动它时，我收到以下错误：“无法在本地计算机上启动 Apache Tomcat 服务。” 错误 216:0xd8

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-09T19:17:01.230

这是众所周知的问题。

Windows 服务的 Tomcat 包装器是为 32 位 JDK 编译的。

应该允许您在 JDK64 位下将 Tomcat 安装为 Windows 服务的步骤。

1.  下载 Tomcat 二进制安装（zip 文件；exe 文件找不到 64 位 JDK/JRE）。

2.  从存档中提取文件。

3.  将tomcat5.exe (tomcat6.exe) 重命名为 tomcat5.exe.32bits 到 (tomcat6.exe.32bits)

4.  从 tomcat5_5_64bits_wrapper.zip 中提取 64 位 Tomcat 包装器并将其重命名为 tomcat5.exe (tomcat6.exe)。查看[详细信息在这里](http://blog.datajelly.com/company/blog/35-running-tomcat-as-a-64-bit-windows-service.html)。（更新：Bugzilla 帖子似乎已关闭，但我相信可以在[Tomcat SVN 存储库](http://svn.apache.org/viewvc/tomcat/tc6.0.x/tags/TOMCAT_6_0_16/res/procrun/amd64/)中找到更新的 exe 文件）。

5.  将其安装为执行“service.bat install [Tomcat instance name]”的 Windows 服务，其中 [Tomcat instance name] 是可选的 Windows 服务名称。

6.  在某些情况下，tomcat 没有正确配置服务注册表值。它指向 JRE/JDK 的 32 位版本而不是 64 位版本。它可以显式完成（指向错误 JDK/JRE 的路径）或隐式完成（暗示使用指向 32 位版本的 JAVA_HOME 或 JRE_HOME 的“自动”值）。无论如何，强烈建议检查注册表值，该值定义将用于 tomcat windows 服务的 JDK/JRE 版本，请参阅键 HKEY_LOCAL_MACHINE\SOFTWARE\Apache Software Foundation\Procrun 2.0[Tomcat 实例名称]\Parameters\Log\jvm 并指出它纠正 64 位 JDK/JRE（例如 jvm=C:\Program Files\Java\jdk1.5.0_15\jre\bin\server\jvm.dll）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-02-03T21:03:37.447

根据自 6.0.21 版本以来的[更新日志](http://tomcat.apache.org/tomcat-6.0-doc/changelog.html)，64 位组件被打包在本机安装程序中：

> 在发行版中包含 64 位 Windows 服务包装器。更新 Windows 安装程序以在 64 位计算机上自动使用正确的二进制文件。（市场）

您应该不需要进一步的配置。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T17:26:07.833

我一直在努力解决这个问题。我试图在运行在虚拟 Intel Xeon CPU (X5460) 上的 Windox XP x64 系统上安装 Tomcat 6。我使用 FoxyBOA 的评论作为指导，但提供以下内容：

1.  从 Sun 安装 Windows x64 JRE。
2.  安装 Tomcat 6（我使用的是 Windows Service Installer 版本），您必须手动将其指向您在安装期间下载的 JRE（只需单击“...”按钮并找到 jre6 目录）。
3.  [从Tomcat Repository](http://svn.apache.org/viewvc/tomcat/tc6.0.x/tags/TOMCAT_6_0_18/res/procrun/amd64/ "Tomcat 存储库")下载 tomcat6.exe 和 tomcat6w.exe 的更新版本（您可能希望找到与您下载的 Tomcat 的确切版本匹配的标记）并将它们放在 bin 目录中。我不知道为什么 amd64 版本可以在 Intel 处理器上运行，[但确实可以](http://blogs.msdn.com/gauravseth/archive/2006/03/01/541288.aspx)。

之后，一切正常：我能够使用它的服务管理器和 Windows 服务管理控制台启动 Tomcat。

在我这样做的时候，我使用了 Tomcat 6.0.18 和 Sun Java 6 Update 12（64 位）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-25T23:34:41.077

在 64 位 Windows 环境中运行 Tomcat 的最快和最简单的方法是安装 32 位 JDK。注意：安装 JDK 64Bit 后可以安装 JDK 32Bit，不会出现问题并会更新 JDK。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-12T10:13:48.417

只是想让人们知道，当使用 64bit tomcat 6 时，要查看的注册表是

HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Apache 软件基金会\Procrun 2.0\

注意额外的 \Wow6432Node\

谢谢您的帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T08:23:46.787

只需修改第 6 步，将其放入 java 中，而不是登录注册表值

6.  在某些情况下，tomcat 没有正确配置服务注册表值。它指向 JRE/JDK 的 32 位版本而不是 64 位版本。它可以显式完成（指向错误 JDK/JRE 的路径）或隐式完成（暗示使用指向 32 位版本的 JAVA_HOME 或 JRE_HOME 的“自动”值）。无论如何，强烈建议检查注册表值，该值定义将用于 tomcat windows 服务的 JDK/JRE 版本，请参阅键 HKEY_LOCAL_MACHINE\SOFTWARE\Apache Software Foundation\Procrun 2.0[Tomcat 实例名称]\Parameters*java*\jvm 并指向它可以纠正 64 位 JDK/JRE（例如 jvm=C:\Program Files\Java\jdk1.5.0_15\jre\bin\server\jvm.dll）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-09T13:23:56.003

供参考。我现在可以工作了：Tomcat 6.0.29 和 JRE 6u23，不用担心 - 安装 JRE，安装 Tomcat 服务安装程序，完成工作。这一切都启动并完美运行。

# c# - ICollection、只读集合和同步。这是正确的吗？

> ID：211448
> 
> 赞同：6
> 
> 时间：2008-10-17T08:44:09.060
> 
> 标签：c#, .net-2.0

我有一个实现的自定义类，`ICollection`这个类是只读的，即。`IsReadOnly`返回 true （而不是使用`readonly`关键字），并且所有通常会修改集合中数据的函数都会抛出`InvalidOperationException`'s.

现在，鉴于这样的结构，并在实现时快速浏览线程安全问题`ICollection`（特别是[`ICollection.IsSynchronized`](http://msdn.microsoft.com/en-us/library/system.collections.icollection.issynchronized.aspx)朋友们），我想出了这个快速而肮脏的解决方案。

```
bool ICollection.IsSynchronised { get{ return true; } }
object ICollection.SyncRoot { get{ return new Object(); } } 
```

现在，鉴于 MSDN 中的示例，这不会导致不同的线程正确锁定，因为它们从`SyncRoot`. 鉴于这是一个只读集合，这是一个问题吗？返回是否存在内存/GC问题`new Object()`？您可以在此实现中看到任何其他问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T08:58:16.427

Yes this is an issue in some cases. Even though the collection is read only and cannot be changed, the objects the collection references are not read only. Thus if the clients use the SyncRoot to perform locking they will not be thread safe when modifying the objects referenced by the collection.

I would recommend adding:

```
private readonly object syncRoot = new object(); 
```

to your class. Return this as the SyncRoot and you're good to go.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T08:49:33.717

我想问题在于，如果客户使用您的同步根来锁定您的收藏，还有其他东西。假设他们缓存了集合的大小——或者可能是“这个集合的哪个子集与谓词匹配”——他们会合理地假设他们可以使用您的 SyncRoot 来保护您的集合和他们的其他成员。

就我个人而言，我几乎不使用 SyncRoot，但我认为总是返回相同的东西是明智的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T08:53:51.833

每次返回一个不同的对象似乎很奇怪......实际上，我很少（如果有的话）使用 SyncRoot 方法，因为我经常需要在多个对象之间进行同步等，所以一个单独的对象更有意义。

但是，如果数据真的是不可变的（只读），为什么不直接从 IsSynchronized 返回 false 呢？

Re GC - 任何这样的对象通常都是短暂的并被收集在 GEN0 中。如果您有一个带有对象的字段（用于锁），它将持续与集合一样长，但很可能无论如何都不会受到伤害......

如果您需要锁，我很想拥有一个：

```
private readonly object lockObj = new object(); 
```

您还可以使用惰性方法仅在需要时“新建”它，如果您实际上不希望任何人请求同步锁（通过返回 false 给 IsSynchronized），这在一定程度上是有意义的。

Another common approach is to return "this"; it keeps things simple, but risks conflicts with some other code using your object as a lock for an unrelated purpose. Rare, but possible. This is actually the approach that `[MethodImpl]` uses to synchronize.

# image-manipulation - 将文本添加到 TIFF

> ID：211459
> 
> 赞同：2
> 
> 时间：2008-10-17T08:47:19.820
> 
> 标签：image-manipulation, tiff, freetype

我需要将文本字符串添加到 TIFF 图像。我打算使用 libTIFF 来编辑 TIFF 图像。计划是使用 freetype2 将文本转换为图像，然后以某种方式将文本图像渲染到 TIFF。这是正确的方法吗？

关于如何将文本转换为图像的任何指示？我看到了 ft2 的示例代码——初始化库，创建人脸，然后设置字符大小。但不确定下一步该怎么做？任何指针appreaciated。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T09:14:29.030

一种方法是使用[ImageMagick](http://www.imagemagick.org)。他们有用于图像合成和文本渲染的工具。（还有很多）

尽管 ImageMagick 主要从命令行使用（尤其是在 Web 环境中），但也有几种语言界面可用。Java、C、C++、...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T23:57:45.020

ImgSource 是一个非常好的 Windows 上的 C/C++ 库，它可以开箱即用。

[http://www.smalleranimals.com/isource.htm](http://www.smalleranimals.com/isource.htm)

它不是免费的，但很便宜（59 美元）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T09:56:02.223

您没有告诉我们您需要使用哪种语言，它应该是可移植的还是用于给定平台等。
使用现成的图形库，如（大！）ImageMagick 或其他如 libGD 或[DevIL](http://openil.sourceforge.net/ "魔鬼")可能是最简单的方法，其中很多都绑定了很多语言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T10:05:29.283

如果你在 windows 和 c++ 中，那么使用 gdiplus 绘制字体非常容易。您可以访问任何已安装的字体，也可以使用一个 api 将光栅保存为 tiff 或 jpeg 等。

当然你也可以使用一些freetype和libtiff的组合，但是你必须为win32构建这些库。并不是说它很难，只是在你可能不想做的事情上多做文章。

# visual-studio - 如何在 Visual Studio 中向我的项目添加测试 Web 服务？

> ID：211465
> 
> 赞同：1
> 
> 时间：2008-10-17T08:48:52.187
> 
> 标签：visual-studio, web-services

我有一个测试网络服务，它复制了一个尚未公开的实时网络服务（应用程序发布时它将是公开的）。

我在我的解决方案中添加了一个新的 ASP.NET Web 服务应用程序。现在，当我尝试从主项目添加 Web 引用并选择“在此解决方案中浏览到 Web 服务”时，它找不到测试 Web 服务。

我在这里错过了重要的一步吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-17T08:51:05.117

也许您尝试连接的网络服务没有运行。执行 F5，通过检查浏览器中的地址来验证服务是否已启动，然后尝试再次添加引用。

如果它不起作用，只需手动指定地址。

# java - 在 Java 中反映方法的动作

> ID：211477
> 
> 赞同：3
> 
> 时间：2008-10-17T08:51:38.283
> 
> 标签：java, reflection, methods, monitoring

我想知道如何——如果可能的话——反映在执行期间在方法内部执行了哪些方法调用。我对外部方法调用（即其他类中的方法）或调用某些特定方法（如 getDatabaseConnection()）特别感兴趣。

我的意图是监视方法内预定义对象的操作，并在满足某些特定条件时执行附加代码，例如使用特定值调用某些方法。监视器将是完全外部的类或一组类，除了反射之外无法直接访问要监视的对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T14:49:48.543

[Aspect J](http://www.eclipse.org/aspectj/)将解决您的问题。

尝试像这样定义一个切入点：

```
pointcut profilling(): execution(public * *(..)) && (
            within(com.myPackage..*) || 
```

通过这种方式，您将捕获对 com.myPackage 包中任何公共方法的所有调用。在您需要的子句中添加尽可能多的内容。

然后添加以下代码：

```
Object around(): profilling() {

    //Do wherever you need before method call
    proceed();
    //Do wherever you need after method call

} 
```

如果您想了解有关 aspectJ 的更多信息，请遵循本[指南](http://www.eclipse.org/aspectj/doc/released/progguide/index.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T09:20:19.270

BCEL 应该提供这种能力，但是......

...您的要求听起来很像 Aspect-Oriented Programming (AOP)，因此您可能还应该查看[AspectJ](http://www.eclipse.org/aspectj/)（使用[Eclipse 工具](http://www.eclipse.org/ajdt/)）。

AspectJ 的主要优点是它提供了一种精心设计的方式来表达您的特定条件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T08:55:16.060

我希望[BCEL](http://jakarta.apache.org/bcel/index.html)能够做到这一点。从网站：

> 字节码工程库旨在为用户提供方便的可能性来分析、创建和操作（二进制）Java 类文件（以 .class 结尾的文件）。

“分析”部分是这里的重要部分。JavaDoc 在网站上不可见（据我所知），所以我不能轻易确定它是否会对您有所帮助，但这是一个合理的起点。

# java - Java 中的轻量级消息传递（异步调用）

> ID：211480
> 
> 赞同：10
> 
> 时间：2008-10-17T08:53:55.377
> 
> 标签：java, messaging

我正在寻找 Java 中的轻量级消息传递框架。我的任务是以 SEDA 的方式处理事件：我知道处理的某些阶段可以快速完成，而另一些则不能，并且希望将这些处理阶段解耦。

假设我有组件 A 和 B 并且处理引擎（是这个容器或其他任何东西）调用组件 A，而组件 A 又调用组件 B。我不关心组件 B 的执行时间是否为 2 秒，但我关心是否执行例如，组件 A 的时间低于 50ms。因此，组件 A 向 B 提交消息似乎是最合理的，B 将在所需的时间处理该消息。

我知道不同的 JMS 实现和 Apache ActiveMQ：它们对于这个来说太重了。我搜索了一些轻量级消息传递（具有消息序列化和最简单路由等非常基本的功能）但无济于事。

在这个问题上你有什么推荐的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T08:57:50.767

*真的很*轻吗？[执行者](http://java.sun.com/javase/6/docs/technotes/guides/concurrency/overview.html)。:-) 所以你设置了一个执行者（B，在你的描述中），A 只是将任务提交给执行者。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T09:49:09.727

您是否需要任何类型的持久性（例如，如果您的 JVM 在处理数千条消息之间死机）并且您是否需要消息来遍历任何其他 JVM？

如果它全部在单个 JVM 中，并且如果 JVM 死了，您无需担心事务、恢复或消息丢失 - 那么正如 Chris 上面所说，执行器很好。

ActiveMQ 非常轻量级；如果您愿意，您只能在没有持久性的情况下在单个 JVM 中使用它；然后，您可以在需要时启用事务/持久性/恢复/远程处理（使用多个 JVM）。但是，如果您不需要这些东西，那么它就大材小用了——只需使用 Executors。

顺便说一句，如果您不确定哪些步骤可能需要持久性/可靠性或负载平衡到多个 JVM，则另一个选择是完全[隐藏中间件的使用，](http://activemq.apache.org/camel/hiding-middleware.html)以便您可以在需要时在内存 SEDA 队列和 JMS/ActiveMQ 执行器之间切换到。

例如，某些步骤可能需要可靠且可恢复（因此需要某种持久性），而其他时候则不需要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-16T13:38:34.640

我认为 Apache Camel 可以满足您的所有需求。它在 JVM 中工作，并支持 SEDA 样式 ( [http://camel.apache.org/seda.html](http://camel.apache.org/seda.html) ) 和 simpe 路由。可以单独使用，也可以与 spring、JMS 提供程序或其他适配器一起使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-11T15:20:38.893

很抱歉复活了一个旧线程，但也许它可以帮助其他人阅读它......我认为[FFMQ](http://ffmq.sourceforge.net/)是轻量级消息传递框架的一个很好的候选者。

更新：但是我不确定它是否支持重新交付延迟（死信队列问题）。即使对于轻量级提供商，我也会发现这很有用。但我想结合使用 MessageSelector 查询和消息属性是可能的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-22T07:48:35.303

为了帮助其他人阅读此线程：
最轻的消息传递框架之一是[Mbasseder](https://github.com/bennidi/mbassador)。MBassador 是遵循发布订阅模式的非常轻量级的消息（事件）总线实现。它旨在易于使用，旨在提供丰富的功能和可扩展性，同时保持资源效率和性能。
MBassador 高性能的核心是一种专门的数据结构，可以最大限度地减少锁争用，从而最大限度地减少并发访问的性能下降。
特点：通过注释、同步和/或异步事件传递、弱引用、消息过滤的声明式侦听器定义

# python - 密码函数的参数

> ID：211483
> 
> 赞同：0
> 
> 时间：2008-10-17T08:55:21.520
> 
> 标签：python, cryptography

我有点困惑，加密函数的参数是一个字符串。我是否应该简单地用 str() 包装非字符串参数，例如

```
hashlib.sha256(str(user_id)+str(expiry_time))
hmac.new(str(random.randbits(256))) 
```

（暂时忽略 random.randbits() 可能在密码学上不好）。编辑：我意识到 hmac 示例很愚蠢，因为我没有将密钥存储在任何地方！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T09:06:02.933

好吧，通常散列函数（通常是加密函数）对字节起作用。Python 字符串基本上是字节字符串。如果要计算某个对象的哈希值，则必须将其转换为字符串表示形式。如果您想检查哈希是否正确，请确保稍后应用相同的操作。并确保您的字符串表示不包含任何您不想检查的更改数据。

编辑：由于受欢迎的请求，一个简短的提醒，Python unicode 字符串不包含字节，而是 unicode 代码点。每个 unicode 代码点包含*多个*字节（2 或 4，取决于 Python 解释器的编译方式）。Python 字符串只包含字节。所以 Python 字符串（类型*str*）是最类似于字节数组的类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T09:03:11.457

你可以。

但是，对于 HMAC，您实际上希望将密钥存储在某处。没有密钥，您以后无法验证哈希值。:-)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-17T09:07:01.700

哦，Sha256 并不是真正的工业强度加密功能（尽管不幸的是它在许多网站上都非常普遍地使用）。这不是保护密码或其他关键数据的真正方法，但足以生成临时令牌

编辑：如前所述，Sha256 至少需要一些盐。没有盐，Sha256 被字典攻击（时间方面）破解的门槛很低，而且还有很多 Rainbow 表可供使用。就我个人而言，我不会使用比 Blowfish 更少的密码（但那是因为我很偏执）

# winapi - 如何捕捉正在播放的音频？

> ID：211484
> 
> 赞同：30
> 
> 时间：2008-10-17T08:55:28.913
> 
> 标签：winapi, audio, directx, audio-recording

有谁知道如何以编程方式捕获正在播放的声音（即来自声卡的所有声音，而不是麦克风等输入设备）。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-17T13:45:50.247

假设您在谈论 Windows，基本上有三种方法可以做到这一点。

首先是打开音频设备的主输出作为录音源。这只有在驱动程序支持时才有可能，尽管现在大多数都这样做。虚拟设备的通用名称是“你所听到的”或“Wave Out”。您将需要使用合适的 API（请参阅 MSDN 中的 WaveIn 或 DirectSound）来进行捕获。

第二种方法是编写一个过滤器驱动程序，可以在音频流到达物理设备之前对其进行拦截。同样，此技术仅适用于具有合适驱动程序拓扑的设备，而且它肯定不适合胆小的人。

这意味着这些选项都不能保证在具有任意硬件的 PC 上工作。

最后一种选择是使用虚拟音频设备，例如[Virtual Audio Cable](http://www.ntonyx.com/vac.htm)。如果在 Windows 中将此设备设置为默认播放设备，则所有运行良好的应用程序都将通过它播放。然后，您可以从同一设备记录以捕获总和输出。只要您可以控制要录制的应用程序使用的设备，那么此选项将始终有效。

所有这些技术都有其优点和缺点 - 由您决定哪种技术最适合您的需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T09:57:55.043

您可以使用 Waveform Audio Interface，有一篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/aa446573.aspx)介绍了如何通过 PInvoke 访问它。

为了捕捉正在播放的声音，您只需要打开播放设备而不是麦克风。打开输入，当然，不是输出;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T20:07:40.020

如果您使用的是 OSX，[来自 Rogue Amoeba 的 Audio Hijack Pro](http://rogueamoeba.com/audiohijackpro/)可能是最简单的方法。

无论如何，为什么不把你的音频循环回你的线路并录制呢？这是一个*非常*简单的解决方案。只需将电缆插入您的音频输出插孔和插孔中的线路并开始录音。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T23:16:35.713

您必须启用设备立体声混音。如果你这样做，直接声音找到这个设备。

# java - 如何添加不从 TestCase 扩展到 TestSuite 的 JUnit 4 测试？

> ID：211487
> 
> 赞同：13
> 
> 时间：2008-10-17T08:56:17.337
> 
> 标签：java, junit, junit3

在 JUnit 3 中，我简单地调用了

```
suite.addTestSuite( MyTest.class ) 
```

但是，如果 MyTest 是不扩展 TestCase 的 JUnit 4 测试，则此方法不起作用。我应该怎么做才能创建一套测试？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-17T09:01:41.710

自己找到了答案：[这里](http://radio.javaranch.com/lasse/2006/07/27/1154024535662.html)

像这样：

```
import org.junit.runner.RunWith;
import org.junit.runners.Suite;

@RunWith(Suite.class)
@Suite.SuiteClasses({
  TestCalculatorAddition.class,
  TestCalculatorSubtraction.class,
  TestCalculatorMultiplication.class,
  TestCalculatorDivision.class
})
public class CalculatorSuite {
    // the class remains completely empty, 
    // being used only as a holder for the above annotations
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-29T18:09:27.927

对于那些需要与新的 v4 样式共存的大量 3.8 样式套件/测试，您可以执行以下操作：

```
import org.junit.runner.RunWith;
import org.junit.runners.Suite;

@RunWith(Suite.class)
@Suite.SuiteClasses({
  // Add a JUnit 3 suite
  CalculatorSuite.class,
  // JUnit 4 style tests
  TestCalculatorAddition.class,
  TestCalculatorDivision.class
})
public class CalculatorSuite {
    // A traditional JUnit 3 suite
    public static Test suite() {
        TestSuite suite = new TestSuite();
        suite.addTestSuite(TestCalculatorSubtraction.class);
        return suite;
    }
} 
```

# tfs - TFS Sprint 项目打印插件

> ID：211488
> 
> 赞同：9
> 
> 时间：2008-10-17T08:56:44.153
> 
> 标签：tfs, plugins, scrum

有谁知道是否有 TFS 插件可以以适合在 Scrum Board 上使用的格式打印我们的 sprint backlog 项目，而不是我们必须手动写出来？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-08-23T15:07:15.737

如果您的设置是带有 Microsoft Visual Studio Scrum 流程模板的 Team Foundation Server 2010/2012/2013 或 MSF for Agile Software Development 流程模板，此项目可以为您提供帮助。

[https://github.com/frederiksen/Task-Card-Creator](https://github.com/frederiksen/Task-Card-Creator)

截屏：

![在此处输入图像描述](https://i.stack.imgur.com/OZ7CK.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T17:26:28.507

如果我没看错你的问题，那么完美的工具就在这里：

[http://blog.crisp.se/henrikkniberg/2007/12/18/1197973740000.html](http://blog.crisp.se/henrikkniberg/2007/12/18/1197973740000.html)

可用于打印积压工作的 excel 模板。您需要做的就是将您的工作项目从 TFS 下拉到 excel 中，然后将它们打印出来。不完全是“插件”，但我在每个 sprint 中都使用它。

顺便说一句，就我而言，那个博客和他引用的论文是 Scrum 圣经。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T13:48:44.720

我们已经成功地使用了自定义查询、右键单击 ->“在 Microsoft Excel 中打开”和 Word 邮件合并的组合来为我们的 Scrum 板打印卡片。这让我们可以准确地定义我们想要为故事和任务显示的内容。唯一的缺点是我们把纸剪下来用胶带粘起来，而不是使用便利贴。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T14:13:38.820

不久前我在寻找类似的工具，最后我们只是把所有东西都放在卡片上，然后把它们粘在白板上。

更容易查看我们的进度......但是除非我们更新它，否则该状态不会进入 TFS :)

# asp.net-mvc - ASP.NET MVC Beta 1 - Html.RenderPartial 在哪里？

> ID：211493
> 
> 赞同：13
> 
> 时间：2008-10-17T08:58:58.610
> 
> 标签：asp.net-mvc, html-helper, renderpartial

我只是在将我的 Preview 5 应用程序升级到 Beta 1 的过程中，并且在尝试呈现控件时，我几乎可以解决这个错误：

> “System.Web.Mvc.HtmlHelper”不包含“RenderPartial”的定义，并且找不到接受“System.Web.Mvc.HtmlHelper”类型的第一个参数的扩展方法“RenderPartial”（您是否缺少 using 指令还是汇编参考？）

我的标记（在 .aspx 查看内容页面中）是：

```
<% Html.RenderPartial("Controls/UserForm", ViewData); %> 
```

我试过使用 Microsoft.Web.Mvc 但无济于事。有谁知道 Html.RenderPartial 去了哪里，或者我可以使用什么替代方案？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-19T19:47:59.750

并且不要忘记将如下命名空间添加到 web 配置中，我认为预览 5 默认 web.config 中没有 System.Web.Mvc.Html：

```
<namespaces>
 <add namespace="System.Web.Mvc"/>
 <add namespace="System.Web.Mvc.Ajax"/>
 <add namespace="System.Web.Mvc.Html"/>
 <add namespace="System.Web.Routing"/>
 <add namespace="System.Linq"/>
 <add namespace="System.Collections.Generic"/>
</namespaces> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-17T09:16:23.177

现在已修复 - 冲突是预览版 5 和 Beta 1 之间的 Web.config 要求不同。需要将以下内容添加到 system.web 编译程序集节点中：

```
<add assembly="System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/> 
```

在此更改之后，我所有的旧 HtmlHelper 方法都神奇地回来了！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T16:19:12.217

除了添加程序集引用之外，我还必须添加该行

```
 <add namespace="System.Web.Mvc.Html"/>" 
```

到 web.config 文件中的 pages/namespaces 部分。

# multithreading - WCF 服务和请求队列

> ID：211496
> 
> 赞同：2
> 
> 时间：2008-10-17T09:00:39.777
> 
> 标签：multithreading, wcf, scalability, request-queueing

正在使用使用伪代码的手动 POCO 队列类

```
T Dequeue() {
   lock(syncRoot) { 
      if(queue.Empty) Thread.Wait(); 
   }
}

void Enqueue(T item) {
   queue.Enqueue(item);
   Thread.Notify();
} 
```

对于 WCF 来说，请求队列是一种可扩展的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T14:09:55.643

WCF 服务限制将在内部对请求进行排队，无需任何额外代码。你想做什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-17T17:13:28.540

不，不是，因为当您添加更多服务器时，您的解决方案无法扩展，并且不可靠。

您应该使用内置的[WCF Queue Binding](http://msdn.microsoft.com/en-us/library/ms789048.aspx)。

# c# - 是否有与 SQL Server 的 newsequentialid() 等效的 .NET

> ID：211498
> 
> 赞同：35
> 
> 时间：2008-10-17T09:01:01.353
> 
> 标签：c#, .net, sql-server

我们使用 GUID 作为主键，您知道默认情况下它是集群的。

将新行插入到表中时，它会插入到表中的随机页面（因为 GUID 是随机的）。这会对性能产生可衡量的影响，因为数据库会一直拆分数据页（碎片化）。但我之所以使用顺序 GUID 的主要原因是因为我希望将新行作为表中的最后一行插入......这在调试时会有所帮助。

我可以在 上创建一个聚集索引`CreateDate`，但是我们的数据库是自动生成的，并且在开发中，我们需要做一些额外的事情来促进这一点。此外，`CreateDate`它也不是聚集索引的好选择。

过去，我使用[Jimmy Nielsons COMB's](http://www.informit.com/articles/article.aspx?p=25862)，但我想知道 .NET 框架中是否有针对此的东西。在 SQL 2005 中，Microsoft 引入了 .NET`newsequentialid()`的替代方案`newid()`，因此我希望他们制作 .NET 等效项，因为我们在代码中生成 ID。

PS：请不要开始讨论这是对还是错，因为 GUID 应该是唯一的等。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-17T11:10:56.957

应该可以使用对 UuidCreateSequential 的 API 调用在 c# 或 vb.net 中创建顺序 GUID。下面的 API 声明 (C#) 取自[Pinvoke.net](http://www.pinvoke.net/default.aspx/rpcrt4/UuidCreateSequential.html)，您还可以在其中找到有关如何调用该函数的完整示例。

```
[DllImport("rpcrt4.dll", SetLastError=true)]
static extern int UuidCreateSequential(out Guid guid); 
```

可以[在此处找到](http://msdn.microsoft.com/en-us/library/aa379322.aspx)与 UuidCreateSequential 函数相关的 MSDN 文章，其中包含使用的先决条件。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-09-25T09:28:27.827

**2018 年更新：**另[请查看我的其他答案](https://stackoverflow.com/a/49256827/66629)

这就是 NHibernate 生成连续 ID 的方式：

[NHibernate.Id.GuidCombGenerator](https://github.com/nhibernate/nhibernate-core/blob/5e71e83ac45439239b9028e6e87d1a8466aba551/src/NHibernate/Id/GuidCombGenerator.cs)

```
/// <summary>
/// Generate a new <see cref="Guid"/> using the comb algorithm.
/// </summary>
private Guid GenerateComb()
{
    byte[] guidArray = Guid.NewGuid().ToByteArray();

    DateTime baseDate = new DateTime(1900, 1, 1);
    DateTime now = DateTime.Now;

    // Get the days and milliseconds which will be used to build the byte string 
    TimeSpan days = new TimeSpan(now.Ticks - baseDate.Ticks);
    TimeSpan msecs = now.TimeOfDay;

    // Convert to a byte array 
    // Note that SQL Server is accurate to 1/300th of a millisecond so we divide by 3.333333 
    byte[] daysArray = BitConverter.GetBytes(days.Days);
    byte[] msecsArray = BitConverter.GetBytes((long) (msecs.TotalMilliseconds / 3.333333));

    // Reverse the bytes to match SQL Servers ordering 
    Array.Reverse(daysArray);
    Array.Reverse(msecsArray);

    // Copy the bytes into the guid 
    Array.Copy(daysArray, daysArray.Length - 2, guidArray, guidArray.Length - 6, 2);
    Array.Copy(msecsArray, msecsArray.Length - 4, guidArray, guidArray.Length - 4, 4);

    return new Guid(guidArray);
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2017-12-06T20:19:49.587

需要注意的是，由**[UuidCreateSequential](https://msdn.microsoft.com/en-us/library/windows/desktop/aa379322(v=vs.85).aspx)**生成的 UUID在 SQL Server 排序时不会是连续的。

*   SQL Server在对 UUID 进行排序时遵循[RFC](https://www.rfc-editor.org/rfc/rfc4122)
*   RFC 弄错了
*   `UuidCreateSequential`做对了吗
*   但`UuidCreateSequential`创建的东西与 SQL Server 所期望的不同

# 背景

由 UuidCreateSequential 创建的 Type 1 UUID 不在 SQL Server 中排序。

SQL Server 的**NewSequentialID**使用**UuidCreateSequential**，并应用了一些字节混洗。来自在线书籍：

> [**NEWSEQUENTIALID (Transact-SQL)**](https://docs.microsoft.com/en-us/sql/t-sql/functions/newsequentialid-transact-sql)
> 
> NEWSEQUENTIALID 是 Windows UuidCreateSequential 函数的包装，[应用了一些字节混洗](https://blogs.msdn.microsoft.com/dbrowne/2012/07/03/how-to-generate-sequential-guids-for-sql-server-in-net/)

然后引用 MSDN 博客文章：

> [**如何在 .NET 中为 SQL Server 生成顺序 GUID**](https://blogs.msdn.microsoft.com/dbrowne/2012/07/03/how-to-generate-sequential-guids-for-sql-server-in-net/) *（[存档](http://archive.is/jJYuK)）*
> 
> ```
> public static Guid NewSequentialId()
> {
>    Guid guid;
>    UuidCreateSequential(out guid);
>    var s = guid.ToByteArray();
>    var t = new byte[16];
>    
>    t[3] = s[0];
>    t[2] = s[1];
>    t[1] = s[2];
>    t[0] = s[3];
>    
>    t[5] = s[4];
>    t[4] = s[5];
>    t[7] = s[6];
>    t[6] = s[7];
>    t[8] = s[8];
>    t[9] = s[9];
>    t[10] = s[10];
>    t[11] = s[11];
>    t[12] = s[12];
>    t[13] = s[13];
>    t[14] = s[14];
>    t[15] = s[15];
>    
>    return new Guid(t);
> } 
> ```

这一切都始于自`1582-10-15 00:00:00`（1592 年 10 月 15 日，格里高利改革为基督教历法的日期）以来的滴答数。Ticks 是 100 ns 间隔的数量。

例如：

*   UTC 时间 2017 年 12 月 6 日下午 4:09:39
*   = 137,318,693,794,503,714 个刻度
*   =`0x01E7DA9FDCA45C22`滴答声

RFC 说我们应该把这个值分成三个块：

*   UInt32 低（4 字节）
*   Uint16 中（2 字节）
*   UInt32 hi (2 字节)

所以我们把它分开：

```
0x01E7DA9FDCA45C22

|   Hi   |   Mid  |    Low     |
|--------|--------|------------|
| 0x01E7 | 0xDA9F | 0xDCA45C22 | 
```

然后 RFC 说这三个整数应该按以下顺序写出：

*   **低：** 0xDCA45C22
*   **中：** 0xDA9F
*   **高：** 0x01E7

如果您遵循 RFC，则这些值必须以*大端*（又名*“网络字节顺序”*）编写：

```
DC A4 5C 22 DA 9F x1 E7 xx xx xx xx xx xx xx xx 
```

这是一个糟糕的设计，因为您不能将 UUID 的前 8 个字节视为大端 UInt64 或小端 UInt64。这是一个完全愚蠢的编码。

## UuidCreateSequential 做对了

到目前为止，微软遵循所有相同的规则：

*   **低：** 0xDCA45C22
*   **中：** 0xDA9F
*   **高：** 0x1E7

**但他们以 Intel little-endian**顺序写出来：

```
22 5C A4 DC 9F DA E7 x1 xx xx xx xx xx xx xx xx 
```

如果你看一下，你刚刚写了一个 little-endian `Int64`：

```
225CA4DC9FDAE701 
```

意义：

*   如果你想提取时间戳
*   或按时间戳排序

这是微不足道的；只需将前 8 个字节视为 UInt64。

使用 RFC，您别无选择，只能执行各种位摆弄。即使在大端机器上，也不能将 64 位时间戳视为 64 位时间戳。

## 如何扭转它

给定来自 的 little-endian 指导`UuidCreateSequential`：

```
DCA45C22-DA9F-11E7-DDDD-FFFFFFFFFFFF 
```

原始字节为：

```
22 5C A4 DC 9F DA E7 11 DD DD FF FF FF FF FF FF 
```

这解码为：

```
Low      Mid  Version High
-------- ---- ------- ---- -----------------
DCA45C22-DA9F-1       1E7 -DDDD-FFFFFFFFFFFF 
```

*   **低：** 0xDCA45C22
*   **中：** 0xDA9F
*   **高：** 0x1E7
*   **版本：** 1（类型 1）

我们可以按照 RFC big-endian 顺序写回：

```
DC A4 5C 22 DA 9F 11 E7 DD DD FF FF FF FF FF FF 
```

## 简洁版本

```
 |   Swap      | Swap  | Swap  | Copy as-is
Start index    |  0  1  2  3 |  4  5 |  6  7 | 
End index      |  3  2  1  0 |  5  4 |  7  6 | 
---------------|-------------|-------|-------|------------------------ 
Little-endian: | 22 5C A4 DC | 9F DA | E7 11 | DD DD FF FF FF FF FF FF
Big-endian:    | DC A4 5C 22 | DA 9F | 11 E7 | DD DD FF FF FF FF FF FF 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-17T09:09:28.543

确定添加行的顺序的一种简单方法可能是将 IDENTITY 列添加到表中，从而避免需要保持 GUID 有序，从而避免在 GUID 列上维护聚集索引对性能造成的影响。

我不禁想知道在调试时保持这些行的顺序如何帮助您。你能扩大一点吗？

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-03-13T12:56:22.537

您可以为此使用微小的 NewId 库。

通过 NuGet 安装它：

```
Install-Package NewId 
```

并像这样使用它：

```
Guid myNewSequentialGuid =  NewId.NextGuid(); 
```

请参阅[GitHub 上的项目页面](https://github.com/phatboyg/NewId)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-08-21T21:06:47.310

这是生成 COMB GUID 的 C# 代码。

```
byte[] guidArray = System.Guid.NewGuid().ToByteArray();

DateTime baseDate = new DateTime(1900, 1, 1);
DateTime now = DateTime.Now;

// Get the days and milliseconds which will be used to build the byte string 
TimeSpan days = new TimeSpan(now.Ticks - baseDate.Ticks);
TimeSpan msecs = new TimeSpan(now.Ticks - (new DateTime(now.Year, now.Month, now.Day).Ticks));

// Convert to a byte array 
// Note that SQL Server is accurate to 1/300th of a millisecond so we divide by 3.333333 
byte[] daysArray = BitConverter.GetBytes(days.Days);
byte[] msecsArray = BitConverter.GetBytes((long)(msecs.TotalMilliseconds / 3.333333));

// Reverse the bytes to match SQL Servers ordering 
Array.Reverse(daysArray);
Array.Reverse(msecsArray);

// Copy the bytes into the guid 
Array.Copy(daysArray, daysArray.Length - 2, guidArray, guidArray.Length - 6, 2);
Array.Copy(msecsArray, msecsArray.Length - 4, guidArray, guidArray.Length - 4, 4);

return new System.Guid(guidArray); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-17T09:26:32.797

不幸的是，不存在与 .NET 等效的 .NET `newsequentialid()`。您可以继续使用梳子。我实际上在某处有一个Comb 的C# 实现......我会看看我是否可以挖掘它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-17T11:41:06.020

我一直相信随机指南在某些用例中可能对性能有益。显然，插入到随机页面可以避免在多人同时尝试插入时在最后页面中发生的争用。

John 的 PInvoke 建议可能是最接近 SQL 的版本，但 UUidCreateSequential 文档声明您不应该使用它来识别它严格位于生成 Guid 的机器的本地对象。

在我进一步研究顺序 Guid 生成之前，我将用实际数量的真实数据测量实际用例性能。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-10-14T18:05:48.787

关于所选答案。文档说...如果计算机没有 ehternet 访问权限，生成的 Guid 不会在计算机之间为您提供 uniqueId。

如果插入时必须知道 guid，难道不能让 Sql-server 在插入之前返回一个分配给数据的顺序 guid 块吗？

```
declare @ids table(id uniqueidentifier default NEWSEQUENTIALID(), dummy char(1))

declare @c int
set @c = 0;
while (@c < 100)
begin
    insert into @ids (dummy) values ('a');
    set @c += 1;
end

select id from @ids 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-10-17T09:09:26.700

关键问题是知道 .NET 应用程序中的最后一个值是什么。SQL Server 会为您记录这一点。您需要自己保存最后一个值，并将 Guid 构造函数与包含下一个值的字节数组一起使用。当然，在分布式应用程序上，这可能无济于事，您可能必须使用随机向导。（并不是说我认为这有什么问题。）

[http://msdn.microsoft.com/en-us/library/90ck37x3.aspx](http://msdn.microsoft.com/en-us/library/90ck37x3.aspx)

# eclipse - Eclipse，在哪里更改当前调试行背景？

> ID：211500
> 
> 赞同：153
> 
> 时间：2008-10-17T09:01:48.497
> 
> 标签：eclipse, colors

任何人都可以将我指向具有**DEBUG**当前行背景颜色设置的首选项页面吗？我已经将几乎所有的颜色都更改为深色，但在调试时仍然对这个几乎是白色的当前行指示感到恼火（请注意，编辑模式下的当前行指示是可以的）。

* * *

## 回答 #1

> 赞同：301
> 
> 时间：2008-10-17T09:18:20.787

好的，现在我自己找到了（通过主要的逆向工程）。它位于 General\Editors\Text Editors\Annotations 页面中。它被称为“调试当前指令指针”

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-08T06:50:15.347

在我的 Eclipse 版本中，它是

> General\Editors\Text Editors\Annotations\Debug Call Stack"

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-01-04T19:34:25.753

因为 Eclipse 改变的东西比他们改变的衣服更多

从 Eclipse for Java EE 2019-09 开始，我花了 30 分钟才找到这个愚蠢的偏好

[![在此处输入图像描述](https://i.stack.imgur.com/5zC9x.png)](https://i.stack.imgur.com/5zC9x.png)

比去

[![在此处输入图像描述](https://i.stack.imgur.com/dWvMk.png)](https://i.stack.imgur.com/dWvMk.png)

# python - 在 Python 程序中使用 SQLite

> ID：211501
> 
> 赞同：14
> 
> 时间：2008-10-17T09:02:12.737
> 
> 标签：python, exception, sqlite

我创建了一个 Python 模块，用于创建和填充多个 SQLite 表。现在，我想在程序中使用它，但我真的不知道如何正确调用它。我发现的所有教程本质上都是“内联”的，即他们以线性方式使用 SQLite，而不是如何在生产中实际使用它。

我想做的是有一个方法检查数据库是否已经创建。如果是这样，那么我可以使用它。如果不是，则会引发异常并且程序将创建数据库。（或使用 if/else 语句，以更好者为准）。

我创建了一个测试脚本来查看我的逻辑是否正确，但它不起作用。当我创建 try 语句时，它只是创建一个新数据库，而不是检查一个是否已经存在。下次我运行脚本时，我得到一个表已经存在的错误，即使我尝试捕获异常。（我之前没有使用过 try/except ，但认为这是学习的好时机）。

是否有任何关于在操作上使用 SQLite 的好教程或关于如何编码的任何建议？我浏览了 pysqlite 教程和我发现的其他教程，但他们没有解决这个问题。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-17T10:30:02.670

Don't make this more complex than it needs to be. The big, independent databases have complex setup and configuration requirements. SQLite is just a file you access with SQL, it's much simpler.

Do the following.

1.  Add a table to your database for "Components" or "Versions" or "Configuration" or "Release" or something administrative like that.

    CREATE TABLE REVISION( RELEASE_NUMBER CHAR(20) );

2.  In your application, connect to your database normally.

3.  Execute a simple query against the revision table. Here's what can happen.
    *   The query fails to execute: your database doesn't exist, so execute a series of CREATE statements to build it.
    *   The query succeeds but returns no rows or the release number is lower than expected: your database exists, but is out of date. You need to migrate from that release to the current release. Hopefully, you have a sequence of DROP, CREATE and ALTER statements to do this.
    *   The query succeeds, and the release number is the expected value. Do nothing more, your database is configured correctly.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-17T09:23:01.260

AFAIK SQLITE 数据库只是一个文件。要检查数据库是否存在，请检查文件是否存在。

当你打开一个 SQLITE 数据库时，如果没有备份它的文件，它会自动创建一个。

如果您尝试将文件作为非数据库的 sqlite3 数据库打开，您将得到以下信息：

“sqlite3.DatabaseError：文件已加密或不是数据库”

所以检查文件是否存在，并确保在文件不是 sqlite3 数据库的情况下尝试捕获异常

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-17T09:44:53.760

SQLite automatically creates the database file the first time you try to use it. The SQL statements for creating tables can use `IF NOT EXISTS` to make the commands only take effect if the table has not been created This way you don't need to check for the database's existence beforehand: SQLite can take care of that for you.

The main thing I would still be worried about is that executing `CREATE TABLE IF EXISTS` for every web transaction (say) would be inefficient; you can avoid that by having the program keep an (in-memory) variable saying whether it has created the database today, so it runs the `CREATE TABLE` script once per run. This would still allow for you to delete the database and start over during debugging.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-17T09:40:12.880

As @diciu pointed out, the database file will be created by [sqlite3.connect](http://docs.python.org/library/sqlite3.html#module-sqlite3). If you want to take a special action when the file is not there, you'll have to explicitly check for existance:

```
import os
import sqlite3
if not os.path.exists(mydb_path):
    #create new DB, create table stocks
    con = sqlite3.connect(mydb_path)
    con.execute('''create table stocks
      (date text, trans text, symbol text, qty real, price real)''')
else:
    #use existing DB
    con = sqlite3.connect(mydb_path)
... 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-17T09:26:07.307

*   Sqlite doesn't throw an exception if you create a new database with the same name, it will just connect to it. Since sqlite is a file based database, I suggest you just check for the existence of the file.
*   About your second problem, to check if a table has been already created, just catch the exception. An exception "sqlite3.OperationalError: table TEST already exists" is thrown if the table already exist.

```
import sqlite3
import os
database_name = "newdb.db"
if not os.path.isfile(database_name):
    print "the database already exist"
db_connection = sqlite3.connect(database_name)
db_cursor = db_connection.cursor()
try:
    db_cursor.execute('CREATE TABLE TEST (a INTEGER);')
except sqlite3.OperationalError, msg:
    print msg 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-17T09:24:13.350

在我学习的任何语言中，总体上执行 SQL 都是可怕的。SQLalchemy 已被证明是最容易使用的，因为实际的查询和提交是如此干净且没有麻烦。

这是在您的应用程序中实际使用 sqlalchemy 的一些基本步骤，可以从文档中找到更好的详细信息。

*   提供表定义并创建 ORM 映射
*   加载数据库
*   要求它根据定义创建表（如果存在则不会这样做）
*   创建会话制造商（可选）
*   创建会话

After creating a session, you can commit and query from the database.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-09-13T05:07:20.723

See this solution at SourceForge which covers your question in a tutorial manner, with instructive source code :

y_serial.py module :: warehouse Python objects with SQLite

"Serialization + persistance :: in a few lines of code, compress and annotate Python objects into SQLite; then later retrieve them chronologically by keywords without any SQL. Most useful "standard" module for a database to store schema-less data."

[http://yserial.sourceforge.net](http://yserial.sourceforge.net)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-18T05:19:05.167

Yes, I was nuking out the problem. All I needed to do was check for the file and catch the IOError if it didn't exist.

Thanks for all the other answers. They may come in handy in the future.

# c# - 是否可以在运行时更改 WebReference 的属性？

> ID：211510
> 
> 赞同：7
> 
> 时间：2008-10-17T09:07:05.800
> 
> 标签：c#, visual-studio, asmx, web-reference

我正在尝试提出这样一个解决方案，即用户将输入 Web 服务的 URL 并对其进行测试。

虽然我想要的是 URL 更改，但我保证服务描述始终是相同的（当然，除了 wsdl:service 标记，它包含肥皂：地址）；我只想测试不同的客户，运行相同的服务。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T09:10:25.530

是的你可以。只需在调用任何方法之前更改服务代理的 url 属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T09:11:03.080

是的; 每个网络服务代理都提供了一种方法来做到这一点；对于 WCF 之前的代理（包括 WSEx），地址是`Url`代理类的属性 - 只需在对代理进行任何有趣的操作之前更改它。

使用 WCF，我相信您可以通过其中一个构造函数指定端点地址。

因此，只需从您的参考 wsdl 生成您的代理，然后就可以了；-p

# winapi - 抑制 Windows 中的弹出窗口

> ID：211529
> 
> 赞同：0
> 
> 时间：2008-10-17T09:21:02.060
> 
> 标签：winapi, popup, windows-server-2003, headless

有没有一种简单的方法来告诉 Windows 不要在无头服务器机器上显示弹出窗口？

目前，偶尔的应用程序弹出窗口导致我的应用程序冻结，因为没有人可以在控制台上按“确定”。只需登录到事件日志就足够了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T13:41:55.650

Depending on precisely what popups need to be handled, there are a couple of approaches.

1.  For hard error popup handling, [HOWTO: How To Change Hard Error Popup Handling in Windows NT](http://support.microsoft.com/kb/128642 "HOWTO: How To Change Hard Error Popup Handling in Windows NT")
2.  Creating an application to suppress messages. Microsoft has some documentation (from the XP Embedded documentation, but this does not require XP Embedded): [Creating a Win32 Service](http://msdn.microsoft.com/en-us/library/ms940840(WinEmbedded.5).aspx "Creating a Win32 Service") This allows for considerable customization in the handling of the messages, logging, and replies (i.e. depressing the button you want).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T09:40:46.543

这完全取决于弹出窗口的类型，从系统的消息框到自定义对话框。所以我认为没有通用的解决方案。

如果我有问题，我会使用宏语言，如 AutoHotkey（或 AutoIt）来检测弹出窗口的激活并自动单击丢弃按钮。

[编辑] 找到了一个现成的 AHK 弹出窗口阻止程序：[新窗口（弹出窗口）阻止](http://www.autohotkey.com/forum/topic13330.html "新窗口（弹出）拦截器")
程序也许可以按原样使用，或者作为一个起点。

# asp.net - 为什么 global.asax Application_Error 方法不能捕获 ASMX 服务抛出的异常？

> ID：211530
> 
> 赞同：43
> 
> 时间：2008-10-17T09:21:36.163
> 
> 标签：asp.net, error-handling, asmx

以及如何解决它。我想记录每个抛出的异常以进行维护。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-10-17T11:50:47.563

这是 .Net 中的一个已知问题 - Web 服务永远不会触发 Application_Error。不确定是否有任何原因是设计使然，但它就是行不通。

几年前，杰夫·阿特伍德 ( Jeff Atwood) 有一篇关于此的[帖子](http://blog.codinghorror.com/throwing-better-soap-exceptions/)（和[后续文章），其中有以下想法：](http://blog.codinghorror.com/throwing-better-net-exceptions-with-soap-and-http/)

*   在每个 Web 服务方法周围放置一个 try-catch 块
*   使用外观设计模式并在父对象中包含 try-catch
*   编写自定义 SOAP 扩展或 HTTPModule

我唯一关心的是第一个，尽管这看起来工作量很大。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-07-17T02:26:12.093

更好：[HttpApplication.Error 事件](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.error.aspx)：

### 笔记：

> 如果您的 Web 应用程序包含 XML Web services，则不能使用 Error 事件来处理这些服务的全局异常。XML Web services 的 HTTP 处理程序使用 XML Web services 中发生的任何异常，并在调用 Error 之前将其转换为 SOAP 错误。要处理 XML Web 服务异常，请构建一个 SOAP 扩展以在自定义全局异常处理程序中处理 Web 服务异常。有关详细信息，请参阅[XML Web 服务中的处理和引发异常](http://msdn.microsoft.com/en-us/library/bb552862.aspx)。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-07-16T19:21:45.650

对于任何在此主题上寻找 Microsoft 信息的人，请参阅此处：“[在 XML Web 服务中处理和引发异常](https://docs.microsoft.com/en-us/previous-versions/bb552862(v=vs.100)?redirectedfrom=MSDN)”。

这是相关部分：

> 一个 Web 应用程序可以由多个 XML Web services 组成，但是 Global.asax 文件中的 Application_Error 事件不能用于全局异常处理。XML Web services 的 HttpHandler 使用 XML Web services 执行时发生的任何异常，并在调用 Application_Error 事件之前将其转换为 SOAP 错误。

# c++ - 在 C/C++ 中进行不区分大小写的子字符串搜索的最快方法？

> ID：211535
> 
> 赞同：9
> 
> 时间：2008-10-17T09:23:03.273
> 
> 标签：c++, c, optimization, string, glibc

## 笔记

下面的问题是在 2008 年提出的关于 2003 年的一些代码的问题。正如 OP 的**更新**所显示的那样，整个帖子已被 2008 年的老式算法所淘汰，并且仅作为历史好奇心保留在这里。

* * *

我需要在 C/C++ 中进行快速不区分大小写的子字符串搜索。我的要求如下：

*   应该表现得像 strstr() （即返回一个指向匹配点的指针）。
*   必须不区分大小写 (doh)。
*   必须支持当前语言环境。
*   必须在 Windows (MSVC++ 8.0) 上可用或易于移植到 Windows（即来自开源库）。

这是我正在使用的当前实现（取自 GNU C 库）：

```
/* Return the offset of one string within another.
   Copyright (C) 1994,1996,1997,1998,1999,2000 Free Software Foundation, Inc.
   This file is part of the GNU C Library.

   The GNU C Library is free software; you can redistribute it and/or
   modify it under the terms of the GNU Lesser General Public
   License as published by the Free Software Foundation; either
   version 2.1 of the License, or (at your option) any later version.

   The GNU C Library is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
   Lesser General Public License for more details.

   You should have received a copy of the GNU Lesser General Public
   License along with the GNU C Library; if not, write to the Free
   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
   02111-1307 USA.  */

/*
 * My personal strstr() implementation that beats most other algorithms.
 * Until someone tells me otherwise, I assume that this is the
 * fastest implementation of strstr() in C.
 * I deliberately chose not to comment it.  You should have at least
 * as much fun trying to understand it, as I had to write it :-).
 *
 * Stephen R. van den Berg, berg@pool.informatik.rwth-aachen.de */

/*
 * Modified to use table lookup instead of tolower(), since tolower() isn't
 * worth s*** on Windows.
 *
 * -- Anders Sandvig (anders@wincue.org)
 */

#if HAVE_CONFIG_H
# include <config.h>
#endif

#include <ctype.h>
#include <string.h>

typedef unsigned chartype;

char char_table[256];

void init_stristr(void)
{
  int i;
  char string[2];

  string[1] = '\0';
  for (i = 0; i < 256; i++)
  {
    string[0] = i;
    _strlwr(string);
    char_table[i] = string[0];
  }
}

#define my_tolower(a) ((chartype) char_table[a])

char *
my_stristr (phaystack, pneedle)
     const char *phaystack;
     const char *pneedle;
{
  register const unsigned char *haystack, *needle;
  register chartype b, c;

  haystack = (const unsigned char *) phaystack;
  needle = (const unsigned char *) pneedle;

  b = my_tolower (*needle); 
  if (b != '\0')
  {
    haystack--;             /* possible ANSI violation */
    do
      {
        c = *++haystack;
        if (c == '\0')
          goto ret0;
      }
    while (my_tolower (c) != (int) b);

    c = my_tolower (*++needle);
    if (c == '\0')
        goto foundneedle;

    ++needle;
    goto jin;

    for (;;)
    {
      register chartype a;
        register const unsigned char *rhaystack, *rneedle;

        do
        {
          a = *++haystack;
          if (a == '\0')
              goto ret0;
          if (my_tolower (a) == (int) b)
              break;
          a = *++haystack;
          if (a == '\0')
              goto ret0;
        shloop:
          ;
        }
      while (my_tolower (a) != (int) b);

jin:      
      a = *++haystack;
      if (a == '\0')
          goto ret0;

        if (my_tolower (a) != (int) c)
          goto shloop;

        rhaystack = haystack-- + 1;
        rneedle = needle;

        a = my_tolower (*rneedle);

        if (my_tolower (*rhaystack) == (int) a)
          do
          {
              if (a == '\0')
                goto foundneedle;

              ++rhaystack;
          a = my_tolower (*++needle);
              if (my_tolower (*rhaystack) != (int) a)
                break;

          if (a == '\0')
                goto foundneedle;

          ++rhaystack;
              a = my_tolower (*++needle);
          }
          while (my_tolower (*rhaystack) == (int) a);

        needle = rneedle;       /* took the register-poor approach */

      if (a == '\0')
          break;
    }
  }
foundneedle:
  return (char*) haystack;
ret0:
  return 0;
}
```

你能让这段代码更快吗，或者你知道更好的实现吗？

**注意：**我注意到 GNU C 库现在有[一个新的实现`strstr()`](http://sources.redhat.com/cgi-bin/cvsweb.cgi/libc/string/strstr.c?rev=1.2&content-type=text/x-cvsweb-markup&cvsroot=glibc)，但我不确定它是否可以轻松地修改为不区分大小写，或者它实际上是否比旧的更快（在我的情况下）。我还注意到[旧的实现仍然用于宽字符串](http://sources.redhat.com/cgi-bin/cvsweb.cgi/libc/wcsmbs/wcsstr.c?rev=1.4&content-type=text/x-cvsweb-markup&cvsroot=glibc)，所以如果有人知道为什么，请分享。

**更新**

只是为了让事情清楚——以防它还没有——我没有编写这个函数，它是 GNU C 库的一部分。我只是将其修改为不区分大小写。

另外，感谢有关`strcasestr()`其他来源（如 OpenBSD、FreeBSD 等）的其他实现的提示和检查。这似乎是要走的路。上面的代码来自 2003 年，这就是为什么我在这里发布它以希望有更好的版本可用，显然是这样。:)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-17T11:56:02.560

您发布的代码大约是`strcasestr`.

```
$ gcc -Wall -o my_stristr my_stristr.c
steve@solaris:~/code/tmp
$ gcc -Wall -o strcasestr strcasestr.c 
steve@solaris:~/code/tmp
$ ./bench ./my_stristr > my_stristr.result ; ./bench ./strcasestr > strcasestr.result;
steve@solaris:~/code/tmp
$ cat my_stristr.result 
run 1... time = 6.32
run 2... time = 6.31
run 3... time = 6.31
run 4... time = 6.31
run 5... time = 6.32
run 6... time = 6.31
run 7... time = 6.31
run 8... time = 6.31
run 9... time = 6.31
run 10... time = 6.31
average user time over 10 runs = 6.3120
steve@solaris:~/code/tmp
$ cat strcasestr.result 
run 1... time = 3.82
run 2... time = 3.82
run 3... time = 3.82
run 4... time = 3.82
run 5... time = 3.82
run 6... time = 3.82
run 7... time = 3.82
run 8... time = 3.82
run 9... time = 3.82
run 10... time = 3.82
average user time over 10 runs = 3.8200
steve@solaris:~/code/tmp 
```

`main`功能是 ：

```
int main(void)
{
        char * needle="hello";
        char haystack[1024];
        int i;

        for(i=0;i<sizeof(haystack)-strlen(needle)-1;++i)
        {
                haystack[i]='A'+i%57;
        }
        memcpy(haystack+i,needle, strlen(needle)+1);
        /*printf("%s\n%d\n", haystack, haystack[strlen(haystack)]);*/
        init_stristr();

        for (i=0;i<1000000;++i)
        {
                /*my_stristr(haystack, needle);*/
                strcasestr(haystack,needle);
        }

        return 0;
} 
```

它经过适当修改以测试两种实现。我注意到，当我输入这个时，我在`init_stristr`通话中留下了，但它不应该改变太多。`bench`只是一个简单的shell脚本：

```
#!/bin/bash
function bc_calc()
{
        echo $(echo "scale=4;$1" | bc)
}
time="/usr/bin/time -p"
prog="$1"
accum=0
runs=10
for a in $(jot $runs 1 $runs)
do
        echo -n "run $a... "
        t=$($time $prog 2>&1| grep user | awk '{print $2}')
        echo "time = $t"
        accum=$(bc_calc "$accum+$t")
done

echo -n "average user time over $runs runs = "
echo $(bc_calc "$accum/$runs") 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-02-06T06:06:53.560

您可以使用 StrStrI 函数来查找字符串中第一次出现的子字符串。比较不区分大小写。不要忘记包含它的标题 - Shlwapi.h。看看这个：http: [//msdn.microsoft.com/en-us/library/windows/desktop/bb773439 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb773439(v=vs.85).aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T19:28:29.260

使用[提升字符串算法](http://www.boost.org/doc/libs/1_36_0/doc/html/string_algo.html)。它是可用的，跨平台的，并且只有一个头文件（没有要链接的库）。更不用说你应该使用 boost 。

```
#include <boost/algorithm/string/find.hpp>

const char* istrstr( const char* haystack, const char* needle )
{
   using namespace boost;
   iterator_range<char*> result = ifind_first( haystack, needle );
   if( result ) return result.begin();

   return NULL;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-05-23T23:57:36.340

对于平台独立使用：

```
const wchar_t *szk_wcsstri(const wchar_t *s1, const wchar_t *s2)
{
    if (s1 == NULL || s2 == NULL) return NULL;
    const wchar_t *cpws1 = s1, *cpws1_, *cpws2;
    char ch1, ch2;
    bool bSame;

    while (*cpws1 != L'\0')
    {
        bSame = true;
        if (*cpws1 != *s2)
        {
            ch1 = towlower(*cpws1);
            ch2 = towlower(*s2);

            if (ch1 == ch2)
                bSame = true;
        }

        if (true == bSame)
        {
            cpws1_ = cpws1;
            cpws2 = s2;
            while (*cpws1_ != L'\0')
            {
                ch1 = towlower(*cpws1_);
                ch2 = towlower(*cpws2);

                if (ch1 != ch2)
                    break;

                cpws2++;

                if (*cpws2 == L'\0')
                    return cpws1_-(cpws2 - s2 - 0x01);
                cpws1_++;
            }
        }
        cpws1++;
    }
    return NULL;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T09:39:45.173

你为什么使用 _strlwr(string); 在 init_stristr() 中？这不是标准功能。大概是为了支持语言环境，但由于它不是标准的，我只会使用：

```
char_table[i] = tolower(i); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-17T10:37:56.790

我建议您采用一些已经存在的常见 strcasestr 实现。例如 glib、glibc、OpenBSD、FreeBSD 等。您可以通过 google.com/codesearch 搜索更多内容。然后，您可以进行一些性能测量并比较不同的实现。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-17T12:12:48.920

假设两个输入字符串都已经小写。

```
int StringInStringFindFirst(const char* p_cText, const char* p_cSearchText)
{
    int iTextSize = strlen(p_cText);
    int iSearchTextSize = strlen(p_cSearchText);

    char* p_cFound = NULL;

    if(iTextSize >= iSearchTextSize)
    {
        int iCounter = 0;
        while((iCounter + iSearchTextSize) <= iTextSize)
        {
            if(memcmp( (p_cText + iCounter), p_cSearchText, iSearchTextSize) == 0)
                return  iCounter;
            iCounter ++;
        }
    }

    return -1;
} 
```

您也可以尝试使用掩码...例如，如果您要比较的大多数字符串仅包含从 a 到 z 的字符，那么可能值得做这样的事情。

```
long GetStringMask(const char* p_cText)
{
    long lMask=0;

    while(*p_cText != '\0')
    {       
        if (*p_cText>='a' && *p_cText<='z')
            lMask = lMask | (1 << (*p_cText - 'a') );
        else if(*p_cText != ' ')
        {
            lMask = 0;
            break;      
        }

        p_cText ++;
    }
    return lMask;
} 
```

然后...

```
int main(int argc, char* argv[])
{

    char* p_cText = "this is a test";   
    char* p_cSearchText = "test";

    long lTextMask = GetStringMask(p_cText);
    long lSearchMask = GetStringMask(p_cSearchText);

    int iFoundAt = -1;
    // If Both masks are Valid
    if(lTextMask != 0 && lSearchMask != 0)
    {
        if((lTextMask & lSearchMask) == lSearchMask)
        {       
             iFoundAt = StringInStringFindFirst(p_cText, p_cSearchText);
        }
    }
    else
    {
        iFoundAt = StringInStringFindFirst(p_cText, p_cSearchText);
    }

    return 0;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-02T07:50:46.727

这不会考虑语言环境，但是如果您可以更改 IS_ALPHA 和 TO_UPPER，则可以考虑它。

```
#define IS_ALPHA(c) (((c) >= 'A' && (c) <= 'Z') || ((c) >= 'a' && (c) <= 'z'))
#define TO_UPPER(c) ((c) & 0xDF)

char * __cdecl strstri (const char * str1, const char * str2){
        char *cp = (char *) str1;
        char *s1, *s2;

        if ( !*str2 )
            return((char *)str1);

        while (*cp){
                s1 = cp;
                s2 = (char *) str2;

                while ( *s1 && *s2 && (IS_ALPHA(*s1) && IS_ALPHA(*s2))?!(TO_UPPER(*s1) - TO_UPPER(*s2)):!(*s1-*s2))
                        ++s1, ++s2;

                if (!*s2)
                        return(cp);

                ++cp;
        }
        return(NULL);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-17T13:36:56.943

如果您想减少 CPU 周期，您可能会考虑这一点 - 假设我们正在处理 ASCII 而不是 Unicode。

制作一个包含 256 个条目的静态表。表中的每个条目都是 256 位。

要测试两个字符是否相等，请执行以下操作：

```
if (BitLookup(table[char1], char2)) { /* match */ } 
```

要构建表，您在 table[char1] 中的任何位置都设置了一点，您认为它与 char2 匹配。因此，在构建表时，您将在“a”条目（和“A”条目）中设置“a”和“A”的索引位。

现在进行位查找会变慢（位查找很可能是移位、掩码和相加），因此您可以使用字节表代替，因此您可以使用 8 位来表示 1 位。这将需要 32K - 所以万岁 - 你已经达到了时间/空间的权衡！我们可能想让表格更灵活，所以假设我们这样做 - 表格将改为定义同余。

当且仅当存在将它们定义为等效的函数时，才认为两个字符是全等的。所以'A'和'a'对于不区分大小写是一致的。'A'、'À'、'Á' 和 'Â' 对于变音不敏感是一致的。

所以你定义对应于你的一致性的位域

```
#define kCongruentCase (1 << 0)
#define kCongruentDiacritical (1 << 1)
#define kCongruentVowel (1 << 2)
#define kCongruentConsonant (1 << 3) 
```

那么你的测试是这样的：

```
inline bool CharsAreCongruent(char c1, char c2, unsigned char congruency)
{
    return (_congruencyTable[c1][c2] & congruency) != 0;
}

#define CaseInsensitiveCharEqual(c1, c2) CharsAreCongruent(c1, c2, kCongruentCase) 
```

这种对巨大表格的摆弄是 ctype 的核心。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-19T06:56:39.010

如果您可以控制针字符串，使其始终为小写，那么您可以编写 stristr() 的修改版本以避免查找，从而加快代码速度。它不是一般的，但它可以更快 - 稍微快一点。类似的评论适用于 haystack，但您更有可能从您无法控制的来源读取 haystack，因为您无法确定数据是否满足要求。

性能上的提升是否值得完全是另一个问题。对于 99% 的应用程序，答案是“不，不值得”。您的应用程序可能是少数重要的应用程序之一。更有可能的是，事实并非如此。

# java - 用 Java 编写脚本

> ID：211536
> 
> 赞同：8
> 
> 时间：2008-10-17T09:23:15.723
> 
> 标签：java, javascript, python, scripting-language

我和一些朋友正在用 Java 编写 MORPG，我们想使用脚本语言来，例如。创建任务。

我们没有使用 Java 编写脚本的经验。我们使用过 Python，但我们对它非常缺乏经验。我们中的一个人也使用过 Javascript。

我们应该使用什么脚本语言？我们不应该使用哪种脚本语言？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-18T14:23:18.923

我负责一个相当大的混合 Java/Jython 系统。我们使用 java 进行核心 API 开发，然后使用 Jython 将 Java 对象连接在一起。这是在科学计算环境中，我们需要能够快速组合临时数据分析脚本。

如果我今天从头开始这个系统，我*不会*选择 Jython 作为脚本语言。我很喜欢 Python，但我经常遇到 Python 类型系统和 Java 类型系统之间的尴尬不匹配。例如，如果您只想要一个哈希表，您应该使用 Python 字典还是 Java HashMap？根据您是仅在 Python 代码中本地使用数据结构还是跨 Java 边界传递数据结构，该决定可能会有所不同。Jython 为您做了一定数量的类型强制，但它并不完美。当首先使用脚本语言的目的是提高您的生产力时，甚至不得不考虑这样的问题是很烦人的。

我假设 JavaScript 或 JRuby 会有类似的问题。今天，我将选择一种专门针对 JVM 并利用 Java 类型系统的脚本语言。明显的候选者是 Groovy 和 Beanshell；Groovy 似乎最近势头强劲，所以我会仔细研究它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-17T09:37:24.197

我同意 Viktor 的 Jython 建议。除了 JavaScript（您已经提到，并且通过`javax.script`包内置在 Java 6+ 中）之外，[Groovy](http://groovy.codehaus.org/)和[JRuby](http://jruby.codehaus.org/)也值得一看。

顺便说一句，您应该看看[Wyvern](http://www.cabochon.com/)，它也是一个用 Java 编写并使用 Jython 编写脚本的 MMORPG。[它的作者史蒂夫·耶格（ Steve Yegge](http://steve-yegge.blogspot.com/)）不时对此有很多话要说。:-)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-17T09:38:09.217

Java 支持多种（脚本）语言，其中一些列在 Wikipedia [here](http://en.wikipedia.org/wiki/List_of_Java_scripting_languages)和[here](http://en.wikipedia.org/wiki/JVM_Languages)中。您可能应该选择具有强大 DSL 和元编程功能的语言，例如[Clojure](http://clojure.org/)。

但是如果你需要更简单的东西，JavaScript 可能是一个可行的替代方案。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-17T09:30:28.640

Jython 怎么样？
[http://www.jython.org/Project/](http://www.jython.org/Project/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-17T10:19:49.367

如何创建自己的专用脚本语言？如果您的应用程序是用 java 编写的，您可以使用 ANTLR ( [http://www.antlr.org/](http://www.antlr.org/) ) 来创建您的语言解析代码。

我之所以这么说是因为通用脚本语言可能会提供太多的功能（因为我假设它仅用于任务的脚本）。

但是如果制作自己的语言太难了，那么上面的任何建议都行得通——你只需要弄清楚如何将游戏的运行时绑定到脚本中。我还建议将 Lua ( [http://www.lua.org/](http://www.lua.org/) ) 作为许多游戏使用的另一种选择。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-08T08:10:46.817

### 简洁版本

不要使用脚本语言！而是专注于可配置性（这是非程序员可以做得很好的事情）。

### 更长的版本

*支持使用*脚本语言的一个常用论点是，它允许较少的程序员完成更琐碎的任务。不要相信这一点，它*不会为您节省任何**时间*，因为真正的程序员已经很快完成了琐碎的任务。以可配置性而不是脚本为目标，您将复杂的算法和概念流到无能的游戏设计师手中的风险要低得多。:)

缺少热交换（编辑并继续）是在 MMOG 中实现脚本语言的一个原因（你不想为了小的代码更改而重新加载整个游戏），但是使用 Java，内置热交换，你真的没有理由在上面添加脚本语言。

我花了数年时间思考这些问题；那天我为自己的 MMOG 实现了完整的脚本语言、IDE、VM、调试器等。从那以后，我变得更聪明了。

如果您仍然选择走上无限蹩脚的不归路，请记住以下几点。

*   选择一种已经存在了一段时间的成熟语言。
*   在您制作自己的工具/插件/开始在虚拟机中进行黑客攻击之前，自动测试、调试和编辑将耗费大量时间。

迄今为止，我从未见过可以改善这种情况的 DSL（获得更易于维护的产品）。我自己，我将 Python 集成到我的独立游戏引擎中，但最终我意识到并把它撕掉了。“Stackless Python”只是“不可维护但速度快”的一种说法。拜托，如果我错了，有人纠正我吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-17T09:38:31.870

请参阅[Java：要嵌入 Java 桌面应用程序的脚本语言（宏）](https://stackoverflow.com/questions/143388/java-scripting-language-macro-to-embed-into-a-java-desktop-application "Java：嵌入到 Java 桌面应用程序中的脚本语言（宏）")

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-17T09:39:39.403

你有很多选择：

*   Groovy - [http://groovy.codehaus.org/](http://groovy.codehaus.org/)
*   Jython - [http://www.jython.org/Project/](http://www.jython.org/Project/)
*   JRuby - [http://jruby.codehaus.org/](http://jruby.codehaus.org/)

甚至可能是 BeanShell ( [http://www.beanshell.org/](http://www.beanshell.org/) )

我自己是 Python 的粉丝，所以我推荐 Jython，但它们可能都是合理的选择。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-17T16:21:29.560

为此，我不得不推荐 Javascript。Mozilla Rhino [http://www.mozilla.org/rhino/](http://www.mozilla.org/rhino/)是一个很好的实现，可以完美地满足您的需求。

由于熟悉，我推荐 Javascript 而不是 Jython 或 JRuby。Trivial Javascript 遵循任何人都可以使用的非常熟悉的语法。但是，如果有人想做更激烈的事情，Javascript 是一种非常强大的函数式编程语言。

我经常专业地使用 Groovy 和 Ruby，并相信它们的用途最适合编写逻辑特别复杂的应用程序部分，而 Java 编写起来很麻烦。作为在游戏中使用的嵌入式通用脚本语言，Javascript 是更好的选择。我没有使用过 Python，但它在语法上与 Ruby 相似，而且我相信它的用途也会相似。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-03-24T13:39:42.023

LuaJ 似乎是将 Lua 嵌入 Java 的好方法：

[http://sourceforge.net/projects/luaj/](http://sourceforge.net/projects/luaj/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-17T12:06:11.400

由于语法简洁，我是 Python/Jython 的忠实粉丝——如果你有一些 Python 经验，这可能适合你。

否则，基于 Java 语法的 Groovy 可能更容易学习，如果您的大多数开发人员都是 Java 人员。它还具有与 Java 语言和库更紧密联系的优势。

如果您考虑到简单的脚本，那么 Beanshell 很好——它不支持类。但是，我认为它在过去几年中没有得到任何支持（JSR 似乎将其扼杀了......）所以如果支持对您很重要，那么这可能是一个糟糕的选择。

# asp.net - IE中的DataGrid分页问题

> ID：211544
> 
> 赞同：0
> 
> 时间：2008-10-17T09:28:06.867
> 
> 标签：asp.net, internet-explorer, datagrid

我在 ASP.NET 2 网站的 DataGrid 中有一个模板化列。DataGrid 是分页的，每页有十行。

在 Firefox 中，一切都很好，几乎总是如此，但是当我通过 IE 查看该站点时，出现以下异常：

> 无效的回发或回调参数。使用配置或页面中的 <%@ Page EnableEventValidation="true" %> 启用事件验证。

关于可能导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T13:12:34.043

我之前已经在动态添加的控件中看到过这一点。在您的 DataGrid 之外，您是否以编程方式向页面添加控件？

如果是这样，请确保它们在页面的 Init 事件中被构造、命名并添加到页面中，否则您可能会破坏事件跟踪和验证。

# windows-services - 如何在 Windows XP 中更改系统默认区域设置？

> ID：211549
> 
> 赞同：10
> 
> 时间：2008-10-17T09:35:49.113
> 
> 标签：windows-services, internationalization

如何更改 Windows XP 中的系统默认区域设置以供服务使用（由系统用户运行）？

控制面板中的区域和语言选项修改登录用户的设置。但是，服务不使用用户的设置——它们使用系统设置。我知道他们可以在这里的注册表中找到：

```
HKEY_USERS\.DEFAULT\Control Panel\International 
```

我的问题是：有什么机制可以将系统语言/日期/等从 en-us 更改为 en-gb？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-01-12T12:53:28.093

这对我“[将区域和语言设置应用于保留帐户](http://windows.microsoft.com/en-US/windows-vista/Apply-regional-and-language-settings-to-reserved-accounts)”很有帮助。

简而言之（Windows 7）：打开“**区域和语言**”对话框，然后单击“**管理**”选项卡，然后单击“**复制设置...** ”，选择“**欢迎屏幕和系统帐户**”，**确定**。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-18T09:06:21.823

没有记录的方法可以做到这一点。

快速查看区域设置 Applet dll 表明它调用了一个完全未记录的 API：NlsUpdateSystemLocale()。

你为什么要这样做？您想控制您的服务的语言环境吗？然后让您的服务在您控制的用户帐户下运行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T10:21:50.097

你能不能在机器上使用regedt32并进行所有正确的设置...然后通过右键单击导出国际文件夹并导出reg文件。

如果您不需要所有设置，您可以手动编辑导出的 reg 文件

那么您可以在新机器上运行该 reg 文件以导入注册表项等？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T10:09:17.407

没那么容易。

快捷方式：定义特定用户来运行服务，使用该用户登录，设置区域设置，运行服务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T09:51:45.027

我不确定这是否有帮助

首先从运行命令中输入 gpedit.msc，现在应该会打开一个对话框。导航到用户配置 > 管理模板 > 控制面板 > 区域设置。

这显示了 PC/s 的组策略，也许你可以设置它，所以 en_gb 是唯一的选择！

组策略不是我的强项，但是做一个谷歌搜索并从那里开始，我想你应该能够从这里设置谁和什么可以做什么。

高温高压

# css - 使用空格时 Safari/WebKit 表溢出：nowrap

> ID：211550
> 
> 赞同：4
> 
> 时间：2008-10-17T09:35:55.477
> 
> 标签：css, firefox, safari, webkit

Safari 有一个奇怪的渲染问题：

我在 div 中有一张桌子。在表 <td> 内，我有很多 div 向左浮动。所以正常显示是 td 内的所有 div 向左堆叠，直到它们填满宽度，然后流到下一行，依此类推。所以是这样的：

```
|===========================|
|  |---------------------|  |
|  | XXX  XXX  XXX  XXX  |  |
|  | XXX  XXX            |  |
|  |                     |  |
|  |----------------------  |
|===========================| 
```

这适用于除 safari/webkit 之外的所有浏览器，最终结果如下：

```
|===========================|
|  |-------------------------------|
|  | XXX  XXX  XXX  XXX  XXX  XXX  |
|  |                               |
|  |-------------------------------|
|===========================| 
```

更新：终于解决了问题：我的内部 div（“XXX”）有`white-space: nowrap`. 显然，webkit 没有包装整个 div 列表，而不是在 div 中应用 nowrap。

那是一个讨厌的。

（这与显示无关：无）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-07T18:53:47.097

实际上，我分别问了我上面的问题，然后我像一个大男孩一样找到了解决方案：

而不是使用 white-space:nowrap，在这种情况下使用 display:inline-block 更合适。

CSS 需要在这里和那里进行调整以进行更改，但它可以按预期工作。

[带有 nowrap 的元素会卡在 WebKit 中的相邻元素上](https://stackoverflow.com/questions/2392344/elements-with-nowrap-get-stuck-to-adjacent-elements-in-webkit/2392360#2392360)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T06:50:39.660

回答我自己的问题：

终于解决了这个问题：我的内部 div（“XXX”）有空格：nowrap。显然，webkit 没有包装整个 div 列表，而不是在 div 中应用 nowrap。

那是一个讨厌的。

（这与显示无关：无）

# asp.net - 使用 asp:UpdatePanels 时如何从服务器执行 javascript？

> ID：211553
> 
> 赞同：2
> 
> 时间：2008-10-17T09:37:16.257
> 
> 标签：asp.net, asp.net-ajax, updatepanel

我曾经执行以下操作从服务器执行 javascript：

```
Page.ClientScript.RegisterStartupScript( ... ); 
```

它会在页面加载回客户端时执行。我现在正在修改要使用的现有页面，`UpdatePanels`并且不再触发我的 javascript。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T09:53:35.817

AFAIR，你应该使用`ScriptManager`'`RegisterStartupScript`方法。有关详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.registerstartupscript.aspx)

# c# - 枚举和属性命名冲突

> ID：211567
> 
> 赞同：47
> 
> 时间：2008-10-17T09:42:07.337
> 
> 标签：c#, .net

使用具有枚举属性的类时，通常会在属性名称和枚举类型之间发生命名冲突。例子：

```
enum Day{ Monday, Tuesday, ... }

class MyDateClass
{
   private Day day;

   public Day Day{ get{ return day; } }
} 
```

由于只有标志枚举应该有复数名称，因此将枚举命名为“Days”并不是非标志枚举的方式。在上面的示例中，您可以为枚举或属性使用一些变体，例如“WeekDay”。但在一般情况下，没有像这样好的变体，因此您最终对具有 Foo 和 Bar 类型的枚举属性的对象使用“FooMode”或“BarKind”等属性。没有那么优雅。

在这种情况下，您通常如何命名枚举和属性？

* * *

感谢您的快速回复。另一个问题：为什么不建议嵌套公共枚举，如果要嵌套公共枚举，如何解决命名问题？

```
class Vehicle
{
  enum Kind{ Car, Bike }

  public Kind Kind{ get{ return ... } }
}

class Meal
{
  enum Kind{ Dessert, MainCourse }

  public Kind Kind{ get{ return ... } }
} 
```

在上面的场景中，鉴于 Meal 和 Vehicle 共享相同的命名空间，如果不分别重命名 MealKind 和 VehicleKind，我就无法将“Kind”移出任何一个类。我喜欢的样子

```
myVehicle.Kind = Vehicle.Kind.Car 
```

但这不是指导方针所建议的。这里的最佳做法是什么？永远不要使用嵌套的公共枚举，而是将它们命名为 VehicleKind 等？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-17T09:46:53.163

没有冲突。事实上，[.NET Framework 样式指南鼓励您这样做](http://msdn.microsoft.com/en-us/library/ms229012.aspx)，例如，如果您有一个类具有一个类型的单个属性（无论是枚举还是类），那么您应该将其命名为相同。典型示例是 Color 类型的 Color 属性。没关系，除非有两种颜色 - 在这种情况下，两者都应该在名称中添加一些内容（即 BackColor 和 ForeColor，而不是 Color 和 BackColor）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-17T09:44:28.707

只要枚举没有嵌套在 MyDateClass 中，我认为这不是问题。拥有与其返回的类型同名的属性并不少见（根据我的经验）。我会看看我是否可以在框架中找到一些例子......

编辑：第一个例子：DateTimeOffset.DateTime（不是枚举，但这有点无关紧要）

# embedded - 精确计时函数调用

> ID：211583
> 
> 赞同：2
> 
> 时间：2008-10-17T09:49:25.450
> 
> 标签：embedded, timer

我正在使用带有 C51 内核的微控制器。我有一个相当耗时且大型的子程序，需要每 500 毫秒调用一次。未使用 RTOS。

我现在这样做的方式是我有一个 10 毫秒的现有定时器中断。我在主程序循环中检查是否为真的每 50 个中断后设置一个标志。如果标志为真，则调用子例程。问题是，当程序循环来服务标志时，它已经超过 500 毫秒，在某些代码路径的情况下有时甚至超过 515 毫秒。所花费的时间无法准确预测。

显然，由于执行时间过长，子程序不能从定时器中断内部调用。子程序需要 50ms 到 89ms，具体取决于各种条件。

有没有办法确保每次在 500 毫秒内准确调用子程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T10:12:33.143

我认为您在这里有一些相互冲突/未经过深思熟虑的要求。您说您不能从计时器 ISR 调用此代码，因为它需要很长时间才能运行（这意味着它的优先级低于其他会延迟的东西），但是您受到了以下事实的打击当您从前台路径（“程序循环”）运行它时，本来应该是较低优先级的 else 会延迟它。

如果这项工作*必须*恰好在 500 毫秒内发生，那么从计时器例程中运行它，并处理由此产生的后果。这实际上是先发制人的 RTOS 无论如何都会做的事情。

如果您希望它从“程序循环”运行，那么您必须确保从该循环运行的其他任何东西都不会超过您可以容忍的最大延迟 - 通常这意味着将您的其他长时间运行的工作分解为每次通过循环可以做一些工作的状态机。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T12:09:46.480

我认为没有办法保证它，但这个解决方案可能会提供一个可接受的替代方案。

我可以建议**不要**设置标志而是修改值吗？

这是它的工作原理。

1/ 从零开始一个值。

2/ 每 10ms 中断，在 ISR（中断服务程序）中将该值增加 10。

3/ 在主循环中，如果值 >= 500，则从该值中减去 500 并执行 500 毫秒的活动。

在修改值时，您必须小心注意计时器和主程序之间的竞争条件。

这样做的好处是，无论延迟或持续时间如何，函数都尽可能接近 500ms 边界运行。

如果由于某种原因，您的函数在一次迭代中延迟了 20 毫秒，则该值已经是 520，因此您的函数会将其设置为 20，这意味着它只会在下一次迭代之前等待 480 毫秒。

在我看来，这似乎是实现您想要的最佳方式。

我已经很多年没有接触过 8051（假设这是 C51 的目标，考虑到您的描述，这似乎是一个安全的赌注），但它可能有一条指令可以减去 50 而不会出现中断。但是，我似乎记得架构非常简单，因此您可能必须在它执行加载/修改/存储操作时禁用或延迟中断。

```
volatile int xtime = 0;
void isr_10ms(void)  {
    xtime += 10;
}
void loop(void) {
    while (1) {
        /* Do all your regular main stuff here. */
        if (xtime >= 500) {
            xtime -= 500;
            /* Do your 500ms activity here */
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-18T03:20:40.540

一个不错的选择是使用 RTOS 或编写自己的简单 RTOS。

满足您需求的 RTOS 只需执行以下操作：

*   安排定期任务
*   安排循环任务
*   预制上下文切换

您的要求如下：

*   每 500 毫秒执行一次周期性任务
*   在执行循环任务之间的额外时间（执行非时间关键操作）

像这样的 RTOS 将保证您的代码有 99.9% 的机会按时执行。我不能说 100%，因为您在 ISR 中执行的任何操作都可能会干扰 RTOS。这是一次只能执行一条指令的 8 位微控制器的问题。

编写 RTOS 很棘手，但可行。这是针对 ATMEL 的 8 位 AVR 平台的小型（900 行）RTOS 示例。

以下是为 CSC 460 类创建的**[报告和代码](http://www.jwtanner.com/csc460/Report2/)**：实时操作系统（维多利亚大学）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T17:04:18.240

您还可以使用两个标志 - 一个“预操作”标志和一个“触发”标志（使用 Mike F 作为起点）：

```
#define PREACTION_HOLD_TICKS (2)
#define TOTAL_WAIT_TICKS (10)

volatile unsigned char pre_action_flag;
volatile unsigned char trigger_flag;

static isr_ticks;
interrupt void timer0_isr (void) {
   isr_ticks--;
   if (!isr_ticks) {
      isr_ticks=TOTAL_WAIT_TICKS;
      trigger_flag=1;
   } else {
      if (isr_ticks==PREACTION_HOLD_TICKS)
          preaction_flag=1;
   }
}

// ...

int main(...) {

isr_ticks = TOTAL_WAIT_TICKS;
preaction_flag = 0;
tigger_flag = 0;
// ...

   while (1) {
      if (preaction_flag) {
          preaction_flag=0;
          while(!trigger_flag)
             ;
          trigger_flag=0;
          service_routine();
      } else {
          main_processing_routines();
      }
   }
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T12:09:15.153

这会做你需要的吗？

```
#define FUDGE_MARGIN 2    //In 10ms increments

volatile unsigned int ticks = 0;

void timer_10ms_interrupt( void )  { ticks++; }

void mainloop( void )
{
    unsigned int next_time = ticks+50;

    while( 1 )
    {
        do_mainloopy_stuff();

        if( ticks >= next_time-FUDGE_MARGIN )
        {
            while( ticks < next_time );
            do_500ms_thingy();
            next_time += 50;
        }
    }
} 
```

注意：如果您在为每 500 毫秒的任务提供服务方面落后了，那么这将使它们排队，这可能不是您想要的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T23:21:37.680

一种直接的解决方案是设置一个在 500 毫秒触发的定时器中断……
如果您的硬件设计具有一定的灵活性，您可以将一个定时器的输出级联到第二级计数器，以获得较长的时基。我忘记了，但我隐约记得能够在 x51 上级联计时器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-21T23:27:54.563

为什么你有一个时间紧迫的例程需要这么长时间才能运行？

我同意其他一些人的观点，即这里可能存在架构问题。

如果具有精确的 500 毫秒（或其他）间隔的目的是让信号在特定时间间隔发生变化，那么您最好使用快速 ISR，它根据先前的计算输出新信号，然后设置一个标志，将导致新计算在 ISR 之外运行。

您能否更好地描述这个长时间运行的例程正在做什么，以及对特定间隔的需求是什么？

* * *

根据评论添加：

如果您可以确保服务例程中的时间是可预测的持续时间，您可能会错过计时器中断发布......

举个例子，如果你的定时器中断设置为 10 毫秒，并且你知道你的服务程序将花费 89 毫秒，那么继续计算 41 个定时器中断，然后执行 89 毫秒的活动并错过 8 个定时器中断（第 42 到第 49 条）。

然后，当您的 ISR 退出（并清除挂起的中断）时，下一轮 500 毫秒的“第一个”中断将在大约一毫秒后发生。

鉴于您“资源最大化”表明您还有其他计时器和中断源也在使用中——这意味着依靠主循环来准确计时是行不通的，因为其他中断源可能会触发在错误的时刻。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-21T23:38:33.293

啊，另一种可供考虑的选择——x51 架构允许两个级别的中断优先级。如果您有一定的硬件灵活性，您可以通过定时器 ISR 以 500ms 的间隔触发外部中断引脚之一，然后让每 500ms 代码的较低级别的中断处理发生。

根据您的特定 x51，您可能还可以完全在设备内部生成较低优先级的中断。

请参阅我在网上找到的本文档的第 11.2 部分：http: [//www.esacademy.com/automation/docs/c51primer/c11.htm](http://www.esacademy.com/automation/docs/c51primer/c11.htm)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-24T06:21:23.933

如果我正确地解释了你的问题，你有：

*   一个主循环
*   一些需要每 500 毫秒运行一次的高优先级操作，持续时间最长为 89 毫秒
*   一个 10 毫秒的计时器，它也执行少量操作。

在我看来，有三个选项。第一个是为您的 500 毫秒操作使用较低优先级的第二个计时器。您仍然可以处理您的 10 毫秒中断，并且一旦完成继续服务您的 500 毫秒定时器中断。

第二种选择 - 你真的需要每 10ms 处理一次 10ms 中断吗？除了计时，它还有什么作用吗？如果不是，并且如果您的硬件允许您确定在处理 500ms 操作时已经过去的 10ms 滴答数（即不使用中断本身），那么您可以在 10ms 中断内启动 500ms 操作并处理完成后您错过的 10 毫秒滴答声。

第三种选择：按照 Justin Tanner 的回答，听起来您可以生成自己的抢先式多任务内核来满足您的需求，而不会遇到太多麻烦。听起来您只需要两项任务-一项用于主超级循环，一项用于您的 500ms 任务。

在两个上下文之间交换的代码（即所有寄存器的两个副本，使用不同的堆栈指针）非常简单，通常包括一系列寄存器推送（以保存当前上下文），一系列寄存器弹出（恢复你的新上下文）和从中断指令返回。一旦您的 500 毫秒操作完成，您就可以恢复原始上下文。

（我想严格来说，这是抢占式和协作式多任务处理的混合体，但现在这并不重要）

* * *

编辑：有一个简单的第四个选项。在任何冗长的操作之前和之后，通过检查 500 毫秒是否已经过去来自由地填充您的主超级循环。不完全是 500 毫秒，但您可以将延迟降低到可容忍的水平。

# visual-studio - Visual Studio 2005 上的 CaptureStackBackTrace

> ID：211586
> 
> 赞同：1
> 
> 时间：2008-10-17T09:50:59.537
> 
> 标签：visual-studio, debugging

我最近通过阅读[这篇文章听说了](https://stackoverflow.com/questions/105659/how-can-one-grab-a-stack-trace-in-c)[CaptureStackBackTrace](http://msdn.microsoft.com/en-us/library/bb204633(VS.85).aspx)函数。但是，我在我的任何 Visual Studio 2005 头文件中都找不到它，而且我猜测（来自提到 VS.85 的 MSDN URL）这可能只是 Visual Studio 2008 的东西。

有没有办法，也许通过在某个系统 DLL 中手动找到入口点，在 Visual Studio 2005 下获得这个功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T09:59:16.977

> 评论
> 
> CaptureStackBackTrace 函数定义为 RtlCaptureStackBackTrace 函数。有关详细信息，请参阅 Winbase.h 和 Winnt.h。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T10:56:01.073

除了 Visual Studio 2005 附带的任何内容之外，我还没有更新我的 Windows SDK，但我发现这个解决方案可以工作：

```
typedef USHORT (WINAPI *CaptureStackBackTraceType)(__in ULONG, __in ULONG, __out PVOID*, __out_opt PULONG);
CaptureStackBackTraceType func = (CaptureStackBackTraceType)(GetProcAddress(LoadLibrary("kernel32.dll"), "RtlCaptureStackBackTrace"));
// Then use 'func' as if it were CaptureStackBackTrace 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T09:54:05.770

您是否将 Windows SDK 更新到最新版本？由于这是一个 Windows API 函数，它应该包含在其中。

# windows - Windows下TZ多时区

> ID：211604
> 
> 赞同：1
> 
> 时间：2008-10-17T09:58:49.550
> 
> 标签：windows, timezone

如果我启动一些可以代表在不同时区运行的客户端的进程，我可以（取决于实际代码）使用 TZ 环境使它们看起来像是来自不同时区。

有没有更合适的 windows 方法来模拟这个，而不启动 24 个虚拟机？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T10:06:39.253

Windows 中的不同进程当然可以在不同的环境中运行。如果您的进程使用 TZ 环境变量来确定其时区，那么您可以在启动每个进程之前单独设置该环境变量。

C 运行时库（例如[localtime](http://msdn.microsoft.com/en-us/library/bf12f0hc(VS.71).aspx)）使用 TZ 环境变量，但 Win32 API（例如[GetLocalTime](http://msdn.microsoft.com/en-us/library/ms724338(VS.85).aspx)）不使用。因此，根据您的应用程序如何确定本地时区，此技术可能适合您，也可能不适合您。

# c# - 在 C# 中将文件复制到剪贴板

> ID：211611
> 
> 赞同：28
> 
> 时间：2008-10-17T10:03:01.210
> 
> 标签：c#, winforms, clipboard

我有一个[Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms) [TreeView](http://www.google.com/search?hl=en&q=TreeView%20msdn&btnG=Search)（节点、子节点）。每个节点在其标签中都包含一些附加信息。此外，每个节点映射磁盘上的文件。在 C# 中复制/剪切/粘贴节点/文件的最简单方法是什么？

有一些示例代码会很好。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-10-17T10:07:28.393

考虑使用[剪贴板类](http://msdn.microsoft.com/en-us/library/system.windows.forms.clipboard_members.aspx)。它具有将数据放入 Windows 剪贴板和从 Windows 剪贴板检索数据所需的所有方法。

```
StringCollection paths = new StringCollection();
paths.Add("f:\\temp\\test.txt");
paths.Add("f:\\temp\\test2.txt");
Clipboard.SetFileDropList(paths); 
```

上面的代码会将文件 test.txt 和 test2.txt 复制到 Windows 剪贴板上。执行代码后，您可以导航到任何文件夹并粘贴 ( `Ctrl`+ `V`) 文件。这相当于在 Windows 资源管理器中选择这两个文件并选择复制 ( `Ctrl`+ `C`)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T18:28:12.923

如果您只是在应用程序中复制和粘贴，则可以将树视图的剪切/复制操作映射到仅克隆所选节点的方法。IE：

```
TreeNode selectedNode;
TreeNode copiedNode;

selectedNode = yourTreeview.SelectedNode;

if (selectedNode != null)
{
    copiedNode = selectedNode.Clone;
}

// Then you can do whatever you like with copiedNode elsewhere in your app. 
```

如果您希望能够粘贴到其他应用程序，则必须使用剪贴板。**通过了解有关IDataObject**接口的更多信息，您可以获得比纯文本更有趣的信息。我不记得出处，但这是我自己的笔记中的一些内容：

> 在类中实现时，IDataObject 方法允许用户在类的实例中以多种格式存储数据。以一种以上的格式存储数据会增加目标应用程序（您可能不知道其格式要求）检索存储数据的机会。要将数据存储在 IDataObject 的实例中，请调用 SetData 方法并在 format 参数中指定数据格式。如果您不希望在检索存储的数据时将其转换为另一种格式，请将 autoConvert 参数设置为 false。在 IDataObject 的一个实例上多次调用 SetData 以以一种以上的格式存储数据。

一旦你填充了一个实现**IDataObject**的对象 （例如，称为**yourTreeNodeDataObject**的东西），那么你可以调用：

```
Clipboard.SetDataObjecT(yourTreeNodeDataObject); 
```

# ruby-on-rails - Rails 中首选的夹具替换插件？

> ID：211612
> 
> 赞同：15
> 
> 时间：2008-10-17T10:03:21.320
> 
> 标签：ruby-on-rails, ruby, plugins, fixtures

有十几个 Rails 插件的目标是在测试中替换固定装置。以下是我能想到的几个：

*   夹具更换
*   工厂女工
*   工厂和工人
*   轨道场景
*   夹具场景
*   对象爸爸

可能还有其他人。您更喜欢这些插件中的哪一个，为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T10:23:44.587

我个人将[Faker](http://faker.rubyforge.org/)与自定义工厂类一起使用。这允许我创建我的工厂，并使用非静态数据填充生成的实例。

```
# spec/factory.rb
module Factory
  def self.create_offer(options={})
    Offer.create({
      :code => Faker::Lorem.words(1),
      :expires_on => Time.now + (rand(30) + 1).day
    }.merge(options))
  end
end

# spec_helper.rb
require 'faker'
require 'spec/factory'

# In the specs
@offer = Factory.create_offer(:code => 'TESTING') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-18T00:05:28.530

我会提倡[Fixture Replacement 2](http://replacefixtures.rubyforge.org/)。您的默认（无关）模型属性都存储在一个位置，db/example_data.rb，并提供快速有效的对象。您在创建时指定的任何属性都会覆盖默认属性 - 这意味着您**关心**的数据**在 test**中，仅此而已。

您的示例数据还可以引用其他默认模型，这些模型由具有延迟评估的 procs 表示，因此您可以在需要时轻松覆盖关联。

版本 2 提供了更清晰的定义格式，同时仍然`new_*, create_*, and default_*`为每个模型提供了神奇的方法。

我会避免任何一种鼓励构建越来越多以后难以阅读的测试数据的“场景”方案。您可以使用 FR2 创建命名（自定义）对象，但我从未发现需要它。

PS 确保你也考虑你的**单元**测试策略——Fixtures 和它们的所有类似物都是撞击数据库的真实对象，用于功能或集成测试。我目前正在使用 RSpec 的模拟`stub_model()`以及最新的[unit_record](http://github.com/dan-manges/unit-record/tree/master) gem 来禁止数据库访问。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-10-06T06:37:39.447

我也可以给工厂女孩加一。当你有一个有点正常的模型集时，它可以在多个工厂之间关联的方式非常有用。例如，一个项目有一个项目经理。

```
Factory.define :project_manager do |f|
  f.first_name "John"
  f.last_name  "Doe"
end

Factory.define :project do |f|
  f.name "Sample Project"
  f.association :project_manager
end 
```

这样您就不必担心在每个测试中实际设置关系。它还可以做一些像 Faker 这样的工作，您可以使用 Factory.sequence 在工厂中构建示例数据。有关 Factory Girl 的所有信息，请查看：[http](http://dev.thoughtbot.com/factory_girl/) ://dev.thoughtbot.com/factory_girl/ 。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T13:10:50.507

+1 工厂女孩

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-11T06:35:15.203

当您只需要一个或几个对象时，我是工厂的忠实粉丝。您可以自己编写或使用 Thoughtbot 的[Factory Girl](http://www.thoughtbot.com/projects/factory_girl)。

对于需要一组相互关联的对象的情况，灯具比工厂好，您应该看看优秀的[Lite Fixtures](http://github.com/theIntuitionist/lite-fixtures/tree/master)，它使灯具更加干燥和易于管理。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-17T17:27:09.473

我们刚刚开始在我们的项目中使用 Factory Girl。它的做事方式与我们的本土解决方案没有太大不同，因此对我们来说效果很好。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-03T12:01:12.107

我使用 Faker 和 Ryan Bates 的 Populator gem。[他甚至在http://railscasts.com/episodes/126-populating-a-database](http://railscasts.com/episodes/126-populating-a-database)上有一个不错的截屏视频。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-08T18:26:57.147

[我最近一直在和机械师](http://github.com/notahat/machinist/tree/master)玩耍，正在挖掘它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-29T23:04:57.017

工厂女孩很棒。我们在工作负载中使用它。

```
Factory.define :usa, :class => Team do |f|
  f.country_name 'USA'
  f.rank         15.6
end

Factory.define :player do |f|
  f.first_name 'Stevie'
  f.last_name  'Wonder'
  f.team       Factory.build(:usa)
end 
```

然后在您的规范中，您可以分别使用`Factory.build(:usa)`或`Factory.create(:usa)`建立或创建美国团队。

# iphone - Objective-C 的隐藏特性

> ID：211616
> 
> 赞同：12
> 
> 时间：2008-10-17T10:06:21.610
> 
> 标签：iphone, objective-c, macos, hidden-features

由于 Apple 将 Objective-C 用于 Mac OS X 和 iPhone 开发，Objective-C 的使用越来越广泛。您最喜欢 Objective-C 语言的哪些“隐藏”特性？

*   每个答案一个功能。
*   给出该功能的示例和简短描述，而不仅仅是文档链接。
*   使用标题作为第一行标记要素。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-18T05:23:30.930

## 方法混搭

基本上，在运行时，您可以将一种方法的一种实现换成另一种。

[这是一个带代码的解释。](http://cocoadev.com/MethodSwizzling)

一个聪明的用例是共享资源的延迟加载：通常你会`sharedFoo`通过获取一个锁来实现一个方法，`foo`如果需要的话，创建它的地址，释放锁，然后返回`foo`. 这确保了`foo`只创建一次，但每次后续访问都会浪费时间使用不再需要的锁。

使用方法 swizzling，您可以像以前一样做，除了一旦`foo`创建，使用 swizzling 将初始实现换成`sharedFoo`第二个不检查并简单地返回`foo`我们现在知道已经创建的实现！

当然，method swizzling 会给你带来麻烦，并且在某些情况下上面的例子不是一个好主意，但是嘿......这就是为什么它是一个*隐藏*的特性。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-17T10:37:18.757

## 摆姿势

Objective-C 允许一个类**完全替换**应用程序中的另一个类。替换类被称为“冒充”目标类。然后，发送到目标类的所有消息都由 POS 类接收。对哪些类可以构成一些限制：

*   一个类只能作为其直接或间接超类之一
*   姿势类不得定义目标类中不存在的任何新实例变量（尽管它可以定义或覆盖方法）。
*   在摆姿势之前，必须没有向目标类发送任何消息。

与类别类似，Posing 允许**全局扩充现有类别**。姿势允许类别中缺少的两个特征：

*   一个pose类可以通过super调用被覆盖的方法，从而合并目标类的实现。
*   姿势类可以覆盖类别中定义的方法。

**一个例子：**

```
@interface CustomNSApplication : NSApplication
@end

@implementation CustomNSApplication
- (void) setMainMenu: (NSMenu*) menu
{
     // do something with menu
}
@end

class_poseAs ([CustomNSApplication class], [NSApplication class]); 
```

这会拦截对 NSApplication 的每次 setMainMenu 调用。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-10-18T02:45:43.543

**Object Forwarding/Method Missing**

When an object is sent a message for which it has no method, the runtime system gives it another chance to handle the call before giving up. If the object supports a -forward:: method, the runtime calls this method, passing it information about the unhandled call. The return value from the forwarded call is propagated back to the original caller of the method.

```
-(retval_t)forward:(SEL)sel :(arglist_t)args {
  if ([myDelegate respondsTo:sel])
 return [myDelegate performv:sel :args]
 else
 return [super forward:sel :args];
 } 
```

Content from [Objective-C Pocket Reference](http://oreilly.com/catalog/9780596004231/)

This is very powerful and is used heavily in the Ruby community for the various DSLs and rails, etc. Originated in Smalltalk which influenced both Objective-C and Ruby.

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-25T01:11:39.653

## ISA交换

需要覆盖对象的所有行为？您实际上可以使用一行代码更改活动对象的类：

```
obj->isa = [NewClass class]; 
```

这只会更改接收该对象的方法调用的类；它不会改变对象在内存中的布局。因此，只有当您有一组具有相同 ivars 的类（或一个具有其他类的子集）并且您想在它们之间切换时，这才真正有用。

我编写的一段代码使用它进行延迟加载：它分配一个 class 对象`A`，填充几个关键 ivars（在这种情况下，主要是记录号）并将`isa`指针切换到指向`LazyA`. 当调用除了非常小的集合之外的任何方法时`release`，从磁盘加载所有数据，完成 ivars 的填充，将指针切换回，并将调用转发到真实类。`retain``LazyA``isa``A`

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-10-17T15:39:05.650

```
#include <Foundation/Debug.h> 
```

许多工具用于尝试在该头文件中追踪内存泄漏、过早解除分配等。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-10-22T20:15:07.493

**类别**

使用类别，您可以将方法添加到内置类而无需子类化。[完整参考](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/chapter_4_section_2.html#//apple_ref/doc/uid/TP30001163-CH20-TPXREF139)。

为常用的类添加方便的方法很好，例如 NSString 或 NSData。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-18T07:24:28.067

**Objective-C 运行时参考**

很容易忘记，Objective-C 的语法糖被转换为普通的 C 函数调用，即 Object-C 运行时。您可能永远不需要在运行时中真正深入研究和使用任何东西。这就是为什么我会认为这是一个“隐藏的功能”。

让我给出一种使用运行时系统的方法。

假设有人正在设计一个将由第三方使用的外部框架 API。并且有人在框架中设计了一个抽象表示数据包的类，我们称之为`MLAbstractDataPacket`。现在由在框架中链接的应用程序来子类`MLAbstractDataPacket`化和定义子类数据包。每个子类都必须重写该方法`+(BOOL)isMyKindOfDataPacket:(NSData *)data`。

考虑到这些信息...

如果`MLAbstractDataPacket`提供一个方便的方法，该方法为以 . 形式出现的数据包返回正确的初始化类，那就太好了`+(id)initWithDataPacket:(NSData *)data`。

这里只有一个问题。超类不知道它的任何子类。因此，您可以在这里使用运行时方法`objc_getClassList()`来`objc_getSuperclass()`查找作为 MLAbstractDataPacket 子类的类。一旦你有了一个子类列表，你就可以尝试`+isMyKindOfDataPacket:`每个子类，直到找到或找不到一个。

有关此的参考信息可以在[http://developer.apple.com/documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html](http://developer.apple.com/documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)找到。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-22T20:23:43.407

我喜欢详细的方法命名如`[myArray writeToFile:myPath atomically:YES]`，其中每个参数都有一个标签。

# c++ - 模拟 MFC C++

> ID：211621
> 
> 赞同：2
> 
> 时间：2008-10-17T10:07:44.087
> 
> 标签：c++, windows, mfc, impersonation

我想在 Windows 中模拟其他用户。例如：我创建了一个仅对用户 A 和管理员具有权限的目录，当使用用户 B 登录并运行 .exe 时，我想模拟用户 A 以获得在该特定目录中编辑/删除/插入的权限。

我发现了这个：http: [//msdn.microsoft.com/en-us/library/aa374731 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa374731(VS.85).aspx)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T10:15:19.673

首先，请查看有关 Windows 用户模拟的这篇文章：

[http://www.codeproject.com/KB/system/UserImpersonation.aspx](http://www.codeproject.com/KB/system/UserImpersonation.aspx)

它应该给你一个开始的地方。如果您需要更多控制权，则需要查看访问令牌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T11:34:26.660

如果要访问用户 A 的文件夹和用户 B 的文件夹，则只需设置文件夹权限，使管理员有权进入所有文件夹。通常机器管理员已经拥有这些权限。我假设这里谈论的是普通的 Windows 用户帐户和普通的机器/域管理员帐户。

如果您想成为用户 A，则意味着您需要用户 A 的主动权限才能成为该人。冒充并不简单（根据我的尝试），您需要通过您的域控制器请求访问并协商您是用户 B 并且您有权冒充用户 A，通常由用户 A 和用户 B 共享完成和协商凭证句柄和安全上下文。我怀疑这是您希望遵循的流程类型。

一些有用的功能包括：

为了设置上下文，这些被使用并且数据在用户A和用户B之间来回传递以协商模拟

```
AcquireCredentialsHandle()
InitializeSecurityContext()
AcceptSecurityContext()
CompleteAuthToken() 
```

一旦协商完成并创建了安全上下文，这些将用于启动和停止模拟。

```
ImpersonateSecurityContext()
RevertContext() 
```

我不知道在没有相关用户的积极参与或以该用户身份积极登录的情况下模拟用户的任何其他方式。

希望这在某种程度上有所帮助。

# c# - 附加 .net 调试器，同时仍然提供有用的死亡日志记录

> ID：211622
> 
> 赞同：6
> 
> 时间：2008-10-17T10:07:49.890
> 
> 标签：c#, debugging, stack-trace

我想在我的代码根目录中有某种包罗万象的异常机制，所以当应用程序意外终止时，我仍然可以提供一些有用的日志记录。

类似的东西

```
static void Main () {
    if (Debugger.IsAttached)
        RunApp();
    else {
        try {
            RunApp();
        }
        catch (Exception e) {
            LogException(e);
            throw;
        }
    }
 } 
```

虽然这一切都很好，但我的问题是当我想在引发异常后附加调试器时。

由于异常逃逸到运行时，Windows 将提示附加 Visual Studio，但由于它已被重新抛出，因此堆栈上方的所有局部变量和参数都已丢失。

无论如何要记录这些异常，同时仍然提供一种附加调试器并保留所有有用信息的方法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-13T17:42:10.913

正如 Paul Betts 已经提到的，您最好使用[AppDomain.UnhandledException](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)事件而不是 try/catch 块。

在您的 UnhandledException 事件处理程序中，您可以记录/显示异常，然后提供调试选项，例如显示带有异常详细信息和按钮的表单以忽略、调试或退出。

如果用户选择调试选项，调用[System.Diagnostics.Debugger.Break()](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.break.aspx)允许用户附加他们想要的任何调试器，而完整的调用堆栈仍然可用。

显然，您可以为您知道永远不会将调试器附加到的任何构建禁用此选项。

```
class Program
{
    static void Main()
    {
        AppDomain.CurrentDomain.UnhandledException += ExceptionHandler;

        RunApp();
    }

    static void ExceptionHandler(object sender, UnhandledExceptionEventArgs e)
    {
        Console.WriteLine(e.ExceptionObject);
        Console.WriteLine("Do you want to Debug?");
        if (Console.ReadLine().StartsWith("y"))
            Debugger.Break();
    }

    static void RunApp()
    {
        throw new Exception();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T00:25:36.983

骇人听闻，但没有运行时钩子（我不知道），这是到达您要抛出的堆栈帧的唯一方法....

所有已知会被终端抛出的异常都必须在其构造函数中包含以下内容：

```
#if DEBUG
System.Diagnostics.Debugger.Launch()
#endif 
```

这将显示一个对话框，允许用户提供相关的调试器或选择否，并且不会发生调试（无论哪种方式，异常都将完成构造然后被抛出。这显然仅适用于您控制其源的异常。

我不建议这样做，在带有调试器的调试版本中，您可以选择在异常抛出时获得“第一次机会”中断，这通常应该足以满足您的需求。

另一种选择是在异常抛出站点以编程方式开始生成小型转储，然后可以稍后使用诸如 windbg 之类的工具检查此类数据，但不会过多地干扰之后展开堆栈的异常的所需行为。

异常到达你的捕获所有陷阱的行为正是你不想要的堆栈展开，抱歉。如果您对 C++ 感到满意并且喜欢它，您可以构建一个较小的（但要正确处理）单声道分支，这会导致所有异常都触发调试器。或者，只需重建 mono 的 BCL Exception 类以执行与上述相同的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T03:28:59.023

为什么不让它崩溃然后注册以接收来自 Microsoft 的 Windows 错误报告？查看[http://msdn.microsoft.com/en-us/isv/bb190483.aspx](http://msdn.microsoft.com/en-us/isv/bb190483.aspx)了解详细信息。

如果您不想这样做，您可以使用 IsDebuggerPresent 函数 ( [http://msdn.microsoft.com/en-us/library/ms680345.aspx](http://msdn.microsoft.com/en-us/library/ms680345.aspx) )，如果结果为 False，而不是包装您的代码在 try-catch 中，将事件处理程序添加到 AppDomain.UnhandledException 事件 ( [http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx) )

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T10:17:16.347

不应该简单地做一个

```
Exception e1 = e;
LogException(e);
throw(e1); 
```

在 catch 里面做这个把戏（至少你可以检查外部异常）？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T12:00:33.220

如果您严格使用调试模式进行开发并使用发布模式进行部署，您可以尝试使用 System.Diagnostics.Debugger 类。

```
catch (Exception e) {
#if DEBUG
            System.Diagnostics.Debugger.Launch()
#endif
            LogException(e);
            throw;
        } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T10:14:48.573

您可以通过写入跟踪日志来获取异常信息：

```
 private static void Main(string[] args)
    {
        try
        {
            // ...
        }
        catch (Exception exception)
        {
            System.Diagnostics.Trace.Write(exception);
            #if DEBUG
            System.Diagnostics.Trace.Write("Waiting 20 seconds for debuggers to attach to process.");
            System.Threading.Thread.Sleep(20000);
            System.Diagnostics.Trace.Write("Continue with process...");
            #endif
            throw;
        }
    } 
```

使用[DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)显示跟踪日志。停止线程几秒钟将使您有时间将调试器附加到进程而不会丢失原始异常。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-13T14:12:43.383

如果没有一个全局事件起作用，那么您可以尝试将错误捕获放在您的软件处理的任何事件中。这些操作的难易程度取决于您的应用程序的复杂性。许多使用 .NET 框架编写的应用程序都是为了处理事件而编写的，无论它是传统应用程序还是 Web 应用程序。通过将钩子放在事件本身中，您应该能够将信息保留在您需要的堆栈中。

# numerical - 使用 GNU Scientific “multimin” 查找所有局部最小值

> ID：211625
> 
> 赞同：1
> 
> 时间：2008-10-17T10:08:48.190
> 
> 标签：numerical, minimization

GNU Scientific 库有一个[多维函数最小化](http://www.gnu.org/software/gsl/manual/html_node/Multidimensional-Minimization.html)框架。但是，它的警告明确指出，当用于具有多个不同局部最小值的函数时，它只会返回一个任意解决方案。有谁知道您可能如何调整它，以便它返回*所有*局部最小值的列表（受某些阈值标准约束）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T10:30:04.137

它不是基于 GNU Scientific，但我发现了这个用于查找所有局部最小值的算法：http://www.cs.uoi.gr/~lagaris/papers/MINF.pdf

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T09:21:38.940

任何标准优化算法都会在“接近”起点的某个地方寻找一个局部最小值，要么由它自己选择，要么由你提供。找到所有局部最小值可能是一个不可计算的问题，因为即使在有限范围内（例如 f(x) = [ cos(1/x) ]^2 具有无限数量的局部最小值），它们也可以有无穷多个在 (0, 1] 范围内)。假设您有有限数量的局部最小值，找到所有这些是比找到全局最小值更复杂的任务，而全局最小值又比在某处找到局部最小值要​​困难得多离你很近。没有简单的方法可以适应局部优化算法来找到全局最小值。即使是流行的算法来找到全局最小值，例如遗传算法/进化策略，也不能保证它们访问所有局部最小值。事实上，

在这种情况下使用 GSL 的最佳方法是查看最小化函数并尝试猜测最小值应该在哪里，然后使用 GSL 代码查找它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-09T07:55:00.053

事实证明，粒子群优化方法对于查找函数的所有局部最小值和全局最小值的任务来说并不是一个糟糕的选择。代码[PSO 查找局部最小值](https://github.com/saunter999/PSO) [PSO 查找全局最小值](https://github.com/saunter999/Global-optimization-)可供您参考。

# c# - 如何在c#中删除快捷方式文件

> ID：211629
> 
> 赞同：0
> 
> 时间：2008-10-17T10:09:59.340
> 
> 标签：c#, file, shortcut

如何从 Programs 文件夹中删除程序图标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T10:28:57.837

要获取开始菜单位置，请使用[SpecialFolder 枚举](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)。类似以下内容应该可以帮助您入门：

```
string startMenuDir = Environment.GetFolderPath(Environment.SpecialFolder.StartMenu);
string shortcut = Path.Combine(startMenuDir, @"The Company\MyShortcut.lnk");
if (File.Exists(shortcut))
    File.Delete(shortcut); 
```

如果您不知道确切的文件名，您可以使用[Directory.GetFiles](http://msdn.microsoft.com/en-us/library/system.io.directory.getfiles.aspx)或[Directory.GetDirectories](http://msdn.microsoft.com/en-us/library/system.io.directory.getdirectories.aspx)枚举开始菜单文件夹中的所有文件。[您还可以使用Directory.Delete](http://msdn.microsoft.com/en-us/library/fxeahc5f.aspx)删除整个文件夹（“The Company”）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T10:15:22.637

快捷方式文件是一个普通文件，它恰好将调用重定向（单击）到另一个文件、程序或目录。要删除快捷方式，您可以使用[File.Delete](http://msdn.microsoft.com/en-us/library/system.io.file.delete.aspx)方法。

```
File.Delete(path_to_lnk_file); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T10:38:44.620

在 Windows 资源管理器中，永远不会显示链接的文件扩展名 (lnk)，即使您禁用了*隐藏已知文件类型的扩展名*功能。

因此，如果您想删除“foobar.exe 的快捷方式”快捷方式，您必须这样做

```
File.Delete("Shortcut to foobar.exe.lnk"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T10:12:16.153

您可以对快捷方式使用标准文件操作。

我相信文件扩展名是 lnk。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-20T19:46:03.880

1-确保使用 OpenFileDialog 获取实际文件链接

* * *

OpenFileDialog od = new OpenFileDialog(); od.DereferenceLinks = false;

[使用 DereferenceLinks](http://www.vbforums.com/showthread.php?549631-RESOLVED-Shortcut-path-in-VB-NET)

2 使用shell lib获取包括路径在内的所有信息

* * *

[获取快捷方式信息](http://csharphelper.com/blog/2018/06/get-information-about-windows-shortcuts-in-c/)

* * *

## 最终使用 c# file.move 或 delete 根据路径

# .net - 托管 .NET 运行时和窗口焦点、问题和不一致

> ID：211634
> 
> 赞同：3
> 
> 时间：2008-10-17T10:13:40.580
> 
> 标签：.net, winapi, focus

我们有一个 Win32 应用程序，它承载 .NET 运行时并从应用程序的 Win32 部分打开 .NET 托管表单。

这些窗口始终作为模态窗口打开。

在某些机器上，当这些窗口关闭时，位于后面的 Win32 窗口不会获得焦点，而是在 Word、Outlook 或您可能打开的任何其他窗口后面发送。

此外，有时，如果我们打开这样的 .NET 表单，然后用 alt-tab 键转到 Word 或其他应用程序，然后单击我们应用程序的任务栏图标，就会出现 Win32 窗口。这当然还在等待模态 .NET 窗口关闭，所以它当然是不可用的。如果我们 alt-tab 到其他东西并最小化其他东西，那么我们的 .NET 窗口就会重新出现。

不一致的部分是这只发生在某些机器上，而不是全部。在包括我的在内的许多机器上，它完全按预期工作。每次都聚焦到正确的窗口。

我不怀疑我们做错了什么，但我不知道问题出在哪里。

有谁知道我应该寻找什么？我们已经查看了安装的 .NET 运行时，并且由于两台这样的机器在其中一台上运行但在另一台上不运行都是开发人员机器，它们包含相同的 .NET 服务包等。

* * *

**编辑：**嗯，[@sam](https://stackoverflow.com/users/7021/sam)，你说得对，我们在这条车道上有一些不同的设置。两台机器都运行 Windows XP SP3，但我的运行的是经典的 windows 主题，而另一台运行的是新的 XP 主题。将另一台计算机上的主题更改为经典主题可以解决问题，但将其更改回 XP 主题并没有使其重新出现。

所以现在我们有两台机器可以工作，客户仍然有问题，即使客户显然运行经典主题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T10:36:22.923

最近我注意到windows vista Aero上的窗口焦点设置与以前在XP上的设置不同。主窗口将在重新激活时获得焦点，而不是应用程序的最后一个激活窗口。
有趣的是，将 vista 更改为旧风格的 windows 主题（经典或基本），焦点将设置到最后拥有它的子窗口，就像在 XP 上一样。

您的问题可能非常不同，但也许您有不同的操作系统版本？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T11:28:07.343

这个问题提醒我 WPF 在从父窗口显示对话框时也有同样的问题。

我假设您指的是 .NET 框架的 2.0 版，并且您有一个调用 .NET 程序集的本机模块。

Windows 窗体（也包括窗体）中的任何[控件都实现了一个名为](http://msdn.microsoft.com/en-us/library/system.windows.forms.control(VS.80).aspx)[IWin32Window](http://msdn.microsoft.com/en-us/library/system.windows.forms.iwin32window(VS.80).aspx)的接口，该接口公开了该窗口的 Win32 句柄。

您可以做的是使用[NativeWindow](http://msdn.microsoft.com/en-us/library/system.windows.forms.nativewindow.aspx)来侦听 WM_ACTIVATEAPP 或任何表明您的应用程序具有焦点的事件，并向 .NET 窗口发送信号以获取焦点。

其他选项是使用承载 .net 用户控件而不是 winforms 的本机对话框（如果可以的话）。

我以前用 C++\CLI 做过这件事，没有太多麻烦，但现在我没有想到。也许这对您来说是一个很好的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T11:42:34.163

我记得帮助有同样问题的朋友（不记得是在 .net 2.0 还是 3.5 中）

我假设您在主表单上创建新表单并使用

```
Form2 form2 = new Form2();
form2.ShowDialog(); 
```

要显示模式弹出窗口，现在显然 ShowDialog 方法似乎默认情况下不使用调用 ShowDialog 作为其处理程序的表单，因此您需要这样做

```
form2.ShowDialog(this); 
```

这样，据我所知，应用程序知道要返回哪个句柄，因此总是返回到您的 main 。

有关 ShowDialog 表单 msdn 的其他信息：http: [//msdn.microsoft.com/en-us/library/w61zzfwe.aspx](http://msdn.microsoft.com/en-us/library/w61zzfwe.aspx)

# jquery - 在 Google App Engine 中构建 Ajax 表单

> ID：211648
> 
> 赞同：5
> 
> 时间：2008-10-17T10:22:24.153
> 
> 标签：jquery, ajax, google-app-engine

我有一个表单，当我单击提交按钮时，我想与服务器通信并从服务器获取一些内容以显示在同一页面上。一切都必须以 AJAX 方式完成。如何在 Google App Engine 中执行此操作？如果可能的话，我想用 JQuery 来做。

编辑：[code.google.com/appengine/articles/rpc.html](http://groups.google.com.my/group/google-appengine/browse_thread/thread/36dc8759dab4cc28?hl=en#)中的示例不适用于表单。

* * *

编辑： rpc 过程[不适用于 form](http://groups.google.com.my/group/google-appengine/browse_thread/thread/36dc8759dab4cc28?hl=en#)。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-31T10:25:58.280

您可以使用[jquery Form 插件](http://www.malsup.com/jquery/form/)使用 ajax 提交表单。效果很好。

```
$('#myFormId').submit(function() {
    // submit the form
    $(this).ajaxSubmit();
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T22:43:53.453

我以前在 jQuery 中使用过类似的方法（不确定它是否是“最佳”方式，但它有效）：

```
function jsonhandler(data) {
   // do stuff with the JSON data here
}

var doajax = function () {
    arr = Object();
    $("#form_id").children("input,select").each(function() { arr[this.name] = this.value;});
    $.getJSON("<page to call with AJAX>", arr, function (data) { jsonhandler(data);});
}

$(document).ready(function () {
    $("#submit_button_id").replaceWith("<input id=\"sub\" name=\"sub\" type=\"button\" value=\"Submit\">");
    $("#sub").click(doajax);
} 
```

您可以将 $.getJSON 替换为[您想要的任何 jQuery AJAX 函数](http://docs.jquery.com/Ajax)。如果您只想显示您正在调用的页面的输出，那么 $.get 可能是您最好的选择。如果您在表单中除了输入和选择之外还有其他输入类型，您还需要将它们添加到子函数中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-19T20:32:39.660

我会在 Firebug 中添加它，您应该会在控制台中看到您的 ajax 调用弹出。如果您在打开该地址时遇到异常，则说明您的 Python 代码有问题。也许您没有正确映射您的网址？

# asp.net - 在 SQL 报告服务中添加文本框（动态）

> ID：211654
> 
> 赞同：1
> 
> 时间：2008-10-17T10:27:29.947
> 
> 标签：asp.net, reporting-services

我遇到了这样的问题，我有大约 10 个参数。我正在显示文本框中的参数值（10 种不同）。我需要根据我的参数值显示文本框

如果参数有值 - 在文本框中显示它们 如果参数没有值 - 隐藏文本框。

目前我正在使用上述方法。（使用隐藏功能）。

请让我知道我们可以执行此操作的其他一些选项，例如根据参数动态创建控件（文本框）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T05:22:42.873

Reporting Services 没有基于事件的模型，该模型允许您挂接自定义代码以动态创建报表对象。使用表达式隐藏和显示对象是实现此类功能的正确方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T12:34:09.470

我不认为 SSRS 附带的默认报表查看器控件支持这一点。您可能必须构建自己的报表查看器界面，手动调用报表服务。

# castle-windsor - 温莎城堡：如何在 xml 配置中使用类型作为构造函数属性？

> ID：211656
> 
> 赞同：3
> 
> 时间：2008-10-17T10:27:50.350
> 
> 标签：castle-windsor

我有以下内容：
TypeUser:ITypeUser
{
public TypeUser(Type usedType){..}
}

如何在 Windsor config xml 中配置 Type 参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-21T19:07:52.403

对于自定义类型，您需要提供一个类型转换器来处理转换，但是“类型”是开箱即用的（如果您查看[Castleproject 网站上的列表](http://www.castleproject.org/container/documentation/trunk/usersguide/typeconverters.html)）并且应该“正常工作”，例如：

```
<component id="myServer" service="SomeNameSpace.ITypeUser, SomeAssembly" type="SomeNameSpace.TypeUser, SomeLib">
    <parameters>
        <usedType>SomeNameSpace.MyOtherType, SomeAssembly</usedType>
    </parameters>
</component> 
```

# eclipse - 在 Eclipse 中运行测试时，有没有办法使用自定义 JUnit Test Runner？

> ID：211659
> 
> 赞同：4
> 
> 时间：2008-10-17T10:29:50.643
> 
> 标签：eclipse, junit, jmockit

我想使用[JMockit](http://jmockit.dev.java.net)的增量测试运行程序，而不是 Eclipse 中的标准 JUnit 测试运行程序。有没有办法做到这一点？

**编辑**收到我给 JMockit 开发人员的电子邮件的以下答复：

> 您需要使用命令行启动 JVM，例如“-javaagent:jmockit.jar=incjunit4”，其中“incjunit4”指定加载用于增量 JUnit 测试的外部工具。还必须使用覆盖工具，因为它为增量测试工具提供了必要的运行时信息。事实上，没有关于这方面的文档，主要是因为这个功能还没有完全开发出来。

不幸的是，这仍然对我不起作用。有没有人让增量测试运行器工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T18:24:15.517

不能用`@RunWith`注解吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T08:17:44.963

它对我有用，您需要以正常方式运行测试，而不是转到该测试的运行和属性并使用 jmockit 补丁输入值（jar 路径）

# c# - 如何使用 XSD 创建具有类字典成员的 C# 类？

> ID：211689
> 
> 赞同：1
> 
> 时间：2008-10-17T10:44:06.323
> 
> 标签：c#, xsd

我正在使用 xsd.exe 为我们的设置创建 C# 类。我有一个针对每个服务器和每个数据库的设置，因此我希望该类的行为类似于 Dictionary<string, string[][]>。所以我想能够说

```
string serverName = "myServer";
int databaseId = 1;
FieldSettings fieldSettings = getFieldSettings();

string[] fields = fieldSettings[serverName][databaseId]; 
```

我如何在 XSD 中表示它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T10:49:54.517

xsd 定义了数据结构，而不是真正的访问方法。我认为您不能在 xsd 中表达“这是一个查找”：一切都是值或值/实体集。

如果您想要特定的处理，您可以考虑自定义序列化 - 或者将您的 DTO 和您的*工作*类视为单独的事物，并在两者之间简单地转换。

[编辑] 作为 leppie 笔记 - 您可以编写自己的索引器（如果从 xsd 生成 cs，通常在部分类中）循环遍历列表以查找项目：这将为您提供调用者的用法，但不是真正的完整字典经验（唯一性、O(1) 检索等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T10:48:42.883

这不是什么`xsd`用途。您始终可以将自己的索引器添加到部分类中，并用`[XmlIgnore]`

# c# - 在使用 Sandcastle 构建期间自动生成 html 文档

> ID：211693
> 
> 赞同：21
> 
> 时间：2008-10-17T10:47:11.467
> 
> 标签：c#, visual-studio-2008, documentation, sandcastle

我需要采取哪些步骤才能通过 Visual Studio 中的构建步骤自动构建 HTML 文档？我有所有的评论和正在生成的 comments.xml 文件，并安装了 Sandcastle。我只需要知道要在构建后步骤中添加什么来生成文档。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2011-03-05T00:43:29.567

自从提出这个问题以来，已经进行了一些更改。沙堡不再包括`SandcastleBuilderConsole.exe`. 相反，它使用普通的 old `MSBuild.exe`。

要将其与视觉工作室集成，这是我所做的：

把它放在你的 Post-build 事件中：

```
IF "$(ConfigurationName)"=="Release" Goto Exit

"$(SystemRoot)\microsoft.net\framework64\v4.0.30319\msbuild.exe" /p:CleanIntermediates=True /p:Configuration=Release "$(SolutionDir)ProjectName\doc\DocumentationProjectName.shfbproj"

:Exit 
```

仅当您以“发布”模式构建时，这将导致 Visual Studio 构建您的文档。这样，当您在开发过程中以“调试”模式构建时，您就不会永远等待。

几点注意事项：

*   `framework64`我的系统是 64 位的，如果你的不是，那么`framework`在`msbuild.exe`.

*   我设置它的方式是分别记录我的解决方案中的每个项目。如果您有一个包含多个项目的“Sandcastle Help File Builder”项目文件，那么您可能希望摆脱`ProjectName\`并`doc`进入解决方案目录。在这种情况下，您只想将构建后事件命令放在解决方案中最后构建的项目上。如果您将它放在每个项目的 Post-build 事件中，那么您将为每个已构建的项目重新构建文档。不用说，你会在那里坐一会儿。就我个人而言，我更喜欢单独记录每个项目，但这只是我自己。

**安装 Sandcastle 和“Sandcastle 帮助文件生成器”。**

如果您不知道如何正确设置 Sandcastle 和“Sandcastle 帮助文件生成器”，请按照以下步骤操作：

1.  [从http://sandcastle.codeplex.com/](http://sandcastle.codeplex.com/)下载并安装 Sandcastle （如果您有 64 位系统，则需要添加环境变量。说明在[此处](http://sandcastle.codeplex.com/wikipage?title=How%20to:%20Install%20Sandcastle&referringTitle=Introduction)。

2.  [从http://shfb.codeplex.com/](http://shfb.codeplex.com/)下载并安装“Sandcastle Help File Builder” （如果有任何关于 MSHelp2 的警告，请忽略。您将不需要它。）

3.  一旦你安装了这些，然后使用“Sandcastle Help File Builder”来创建一个新的文档项目。当它询问您将文件保存在哪里时，请将其保存在您的解决方案/项目中的文档文件夹中。 [http://www.chevtek.com/Temp/NewProject.jpg](http://www.chevtek.com/Temp/NewProject.jpg)

4.  创建新项目后，您需要选择要创建的文档类型。已编译的 Windows 帮助文件、网站或两者兼而有之。 [http://www.chevtek.com/Temp/DocumentationType.jpg](http://www.chevtek.com/Temp/DocumentationType.jpg)

5.  如果您将 SHFB 项目文件保存在要生成文档的目录中，则可以跳过此步骤。但是，如果您希望将生成的文档放在其他地方，那么您需要调整输出路径。 [http://www.chevtek.com/Temp/OutputPath.jpg](http://www.chevtek.com/Temp/OutputPath.jpg) 注意：关于输出路径要记住的一件事（这让我沮丧了一个小时）是，当您将网站检查为所需的文档类型时，它将覆盖其输出路径中的内容。他们忽略告诉你的是，SHFB 故意限制某些文件夹被包含在输出路径中。Desktop 就是这样一种文件夹。您的输出路径不能在桌面上，甚至不能是桌面的子文件夹。我的文档也不能，但它可以是我的文档的子文件夹。如果您在构建文档时遇到错误，请尝试更改输出路径并查看是否可以解决问题。有关详细信息，请参阅[http://shfb.codeplex.com/discussions/226668?ProjectName=shfb](http://shfb.codeplex.com/discussions/226668?ProjectName=shfb)。

6.  最后，您需要添加对要记录的项目的引用。如果您像我一样在做单个项目，那么对于您创建的每个 SHFB 项目文件，您将引用相应的 .CSPROJ 文件。如果您的整个解决方案有一个 SHFB 项目，那么您会找到适用于您的解决方案的 .SLN 文件。（如果您引用已编译的 DLL，sandcastle 也可以工作，但由于您将它与 Visual Studio 集成，我发现引用项目/解决方案文件更有意义。这也可能意味着您使用哪个项目并不重要执行构建后事件，因为它引用的是代码而不是 DLL，但最好是安全并将其放在最后一个构建的项目上） [http://www.chevtek.com/Temp/AddSource.jpg](http://www.chevtek.com/Temp/AddSource.jpg)

7.  保存项目，您可以关闭“Sandcastle Help File Builder”。现在一切都设置好了。只需确保将文档项目文件放在批处理命令在 Post-build 事件中指向的适当文件夹中。

希望我的简短教程能帮到你！我很难找到任何像样的教程来教我如何使用沙堡，更不用说如何将它与 Visual Studio 集成了。希望未来的谷歌搜索会出现这个问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T10:51:16.107

[我建议您从Codeplex](http://www.codeplex.com/SHFB)安装 Sandcastle Help File Builder 。

您可以从命令行运行它，例如从 Post-Build 事件。最简单的命令行是：

```
<install-path>\SandcastleBuilderConsole.exe ProjectName.shfb 
```

Sandcastle 非常慢，所以我只为发布版本运行它。为此，请使用以下命令创建一个 Post-Build 事件，该命令将配置名称传递给批处理文件：

```
CALL "$(ProjectDir)PostBuild.cmd" $(ConfigurationName) 
```

然后在批处理文件中，您可以测试第一个参数是否为“Release”，如果是，则运行 SandcastleBuilderConsole.exe。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-20T16:59:15.680

如上所述，一个简单的方法是使用 Sandcastle Help File Builder。从命令行对构建过程进行了一些更改，现在可以使用 MSbuild 而不是 SandcastleBuilderConsole.exe 构建这些项目。所以你所要做的就是：

MSbuild.exe 项目名称.shfb

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T10:54:29.127

我必须承认，我发现当前版本的 Sandcastle 有点欠缺。对于大型项目，它很慢，并且不容易集成（因为它还为时过早）。

对于常规使用，我实际上发现将反射器指向带有 dll 和 xml 文件的文件夹更容易 - IIRC，它会在您导航时加载 xml 文件。

另外，无论如何，我几乎总是打开反光板...

[编辑] 选中，是的 - 反汇编器面板中显示 xml 注释

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T11:09:59.890

安装这些：

NDoc：[http ://prdownloads.sourceforge.net/ndoc/NDoc-v1.3.1.msi?download](http://prdownloads.sourceforge.net/ndoc/NDoc-v1.3.1.msi?download)

HTML 帮助研讨会：[http ://www.microsoft.com/downloads/details.aspx?FamilyID=00535334-c8a6-452f-9aa0-d597d16580cc&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=00535334-c8a6-452f-9aa0-d597d16580cc&displaylang=en)

然后使用 NDocConsole.exe 命令行以 MSDN 或 CHM 形式生成文档：

@c:\progra~1\NDoc\NDocConsole.exe MyCode.dll,MyCode.xml -Documenter=MSDN-CHM

我自己为此制作了一个外部工具并为其提供了快捷方式，但正如之前的海报所说，您可以将它连接到一个后期构建事件中，然后就可以了。

（PS 我已经使用上面的设置好几年了，很满意）

# javascript - 如何对非 JavaScript 应用程序进行自动化测试？

> ID：211694
> 
> 赞同：4
> 
> 时间：2008-10-17T10:47:37.830
> 
> 标签：javascript, testing, selenium

我正在编写与 JavaScript 配合得很好的控件，但即使没有它，它们也必须工作。现在用硒进行测试对我来说很好。但是所有使用禁用 JavaScript（在我的浏览器中）的测试都不会使用 selenium 运行。有没有办法为此目的进行自动化测试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T10:59:43.500

我不知道 Selenium，但是使用 NoScript Firefox 扩展，您可以在每个域的基础上禁用脚本。那么您可以使用它来允许 Selenium 但禁用您页面的脚本吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T11:09:46.130

查看其他自动化软件包，例如[TestComplete](http://www.automatedqa.com/products/testcomplete/)或[AutoIt](http://www.autoitscript.com/autoit3/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-18T08:09:12.017

[WWW::Mechanize](http://search.cpan.org/perldoc?WWW::Mechanize)和[Test::WWW::Mechanize](http://search.cpan.org/perldoc?Test::WWW::Mechanize)是两个 Perl 模块，可以做到这一点。

```
use Test::More tests => 5;
use Test::WWW::Mechanize;

my $mech = Test::WWW::Mechanize->new;

# Test you can get http://petdance.com
$mech->get_ok( "http://petdance.com" );

# Test the <BASE> tag
$mech->base_is( 'http://petdance.com/', 'Proper <BASE HREF>' );

# Test the <TITLE>
$mech->title_is( "Invoice Status", "Make sure we're on the invoice page" );

# Test the text of the page contains "Andy Lester"
$mech->content_contains( "Andy Lester", "My name somewhere" );

# Test that all links on the page succeed.
$mech->page_links_ok('Check all links'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T11:18:03.807

如果它只是没有 javascript 的纯 html，您可以使用普通的屏幕抓取技术来比较您从服务器下载的 html 与您期望的内容，无需在浏览器中进行测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-18T19:38:25.803

您可以使用 Watir 来测试您的 Web 应用程序。

[http://wtr.rubyforge.org/](http://wtr.rubyforge.org/)

# python - 创建一个简单的一次性 Python 对象的简单方法是什么？

> ID：211695
> 
> 赞同：9
> 
> 时间：2008-10-17T10:47:49.577
> 
> 标签：python

我想创建一个简单的一次性 Python 对象来保存一些命令行选项。我想做这样的事情：

```
options = ??????
options.VERBOSE = True
options.IGNORE_WARNINGS = False

# Then, elsewhere in the code...
if options.VERBOSE:
    ... 
```

当然，我可以使用字典，但`options.VERBOSE`比`options['VERBOSE']`.

我*以为*我应该能够做到

```
options = object() 
```

，因为`object`它是所有类对象的基本类型，因此应该类似于没有属性的类。但它不起作用，因为使用创建的对象`object()`没有`__dict__`成员，因此无法为其添加属性：

```
options.VERBOSE = True
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'object' object has no attribute 'VERBOSE' 
```

创建可以以这种方式使用的对象的最简单的“pythonic”方法是什么，最好不必创建额外的帮助类？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-17T11:17:06.147

[collections 模块](http://docs.python.org/library/collections.html)在2.6中增加了一个*namedtuple*函数：

```
import collections
opt=collections.namedtuple('options','VERBOSE IGNORE_WARNINGS')
myoptions=opt(True, False)

>>> myoptions
options(VERBOSE=True, IGNORE_WARNINGS=False)
>>> myoptions.VERBOSE
True 
```

namedtuple是不可变的，因此您只能在创建它时分配字段值*。*

在早期的*Python*版本中，您可以创建一个空类：

```
class options(object):
    pass

myoptions=options()
myoptions.VERBOSE=True
myoptions.IGNORE_WARNINGS=False
>>> myoptions.IGNORE_WARNINGS,myoptions.VERBOSE
(False, True) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-17T14:10:03.553

鉴于您的要求，我会说自定义类是您最好的选择：

```
class options(object):
    VERBOSE = True
    IGNORE_WARNINGS = True

if options.VERBOSE:
    # ... 
```

为了完整起见，另一种方法是使用单独的模块，即`options.py`封装您的选项默认值。

`options.py`：

```
VERBOSE = True
IGNORE_WARNINGS = True 
```

然后，在`main.py`：

```
import options

if options.VERBOSE:
    # ... 
```

这具有从脚本中删除一些混乱的功能。默认值很容易找到和更改，因为它们在自己的模块中被封锁。如果以后您的应用程序增长了，您可以轻松地从其他模块访问这些选项。

这是我经常使用的一种模式，如果您不介意您的应用程序变得比单个模块更大，我会强烈推荐。或者，从自定义类开始，如果您的应用程序增长到多个模块，则稍后扩展为一个模块。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-17T13:46:37.423

如果你坚持不必定义一个类，你可以滥用一些现有的类。大多数对象属于没有字典的“新式”类，但函数可以具有任意属性：

```
>>> x = lambda: 0   # any function will do
>>> x.foo = 'bar'
>>> x.bar = 0
>>> x.xyzzy = x
>>> x.foo
'bar'
>>> x.bar
0
>>> x.xyzzy
<function <lambda> at 0x6cf30> 
```

一个问题是函数已经有了一些属性，所以 dir(x) 有点乱：

```
>>> dir(x)
['__call__', '__class__', '__delattr__', '__dict__', '__doc__',
'__get__', '__getattribute__', '__hash__', '__init__',
'__module__', '__name__', '__new__', '__reduce__',
'__reduce_ex__', '__repr__', '__setattr__', '__str__', 'foo',
'func_closure', 'func_code', 'func_defaults', 'func_dict',
'func_doc', 'func_globals', 'func_name', 'xyzzy'] 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-17T16:56:19.130

为什么不只使用[optparse](http://docs.python.org/library/optparse.html#module-optparse)：

```
from optparse import OptionParser
[...]
parser = OptionParser()
parser.add_option("-f", "--file", dest="filename",
              help="write report to FILE", metavar="FILE")
parser.add_option("-q", "--quiet",
              action="store_false", dest="verbose", default=True,
              help="don't print status messages to stdout")

(options, args) = parser.parse_args()

file = options.filename
if options.quiet == True:
    [...] 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-17T12:19:07.753

我使用[attrdict](http://code.activestate.com/recipes/361668/)：

```
class attrdict(dict):
    def __init__(self, *args, **kwargs):
        dict.__init__(self, *args, **kwargs)
        self.__dict__ = self 
```

根据您的观点，您可能认为这是一个大杂烩或非常聪明。但不管你怎么想，它确实可以生成漂亮的代码，并且与 dict 兼容：

```
>>> ad = attrdict({'foo': 100, 'bar': 200})
>>> ad.foo
100
>>> ad.bar
200
>>> ad.baz = 'hello'
>>> ad.baz
'hello'
>>> ad
{'baz': 'hello', 'foo': 100, 'bar': 200}
>>> isinstance(ad, dict)
True 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-19T13:54:18.967

随着最佳实践的发展，您最好使用[David Eyk 的答案](https://stackoverflow.com/questions/211695/what-is-an-easy-way-to-create-a-trivial-one-off-python-object#212299)中的一个选项。

`type`但是，要回答您的问题，您可以使用以下函数创建一次性类：

```
options = type('Options', (object,), { 'VERBOSE': True })()
options.IGNORE_WARNINGS = False 
```

请注意，您可以提供一个初始字典，或者将其留空。

```
Options = type('Options', (object,), {})
options = Options()
options.VERBOSE = True
options.IGNORE_WARNINGS = False 
```

不是很pythonic。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-17T14:23:15.007

只需创建一个名为 Options.py 的模块，然后导入它。将您的默认选项值作为全局变量放在那里。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-17T12:44:22.290

简化[davraamides 的建议](https://stackoverflow.com/questions/211695/what-is-an-easy-way-to-create-a-trivial-one-off-python-object#211918)，可以使用以下内容：

```
class attrdict2(object):
    def __init__(self, *args, **kwargs):
        self.__dict__.update(*args, **kwargs) 
```

哪一个

1.  是不是很笨拙。

2.  不会用`dict`; 的标准方法污染每个对象的命名空间。例如，`ad.has_key`没有为 类型的对象定义`attrdict2`。

`attrdict`顺便说一句，初始化or的实例更容易`attrdict2`：

```
>>> ad = attrdict2(foo = 100, bar = 200) 
```

当然，`attrdict2`与`dict`.

如果您不需要神奇的初始化行为，您甚至可以使用

```
class attrdict3(object):
    pass

ad = attrdict3()
ad.foo = 100
ad.bar = 200 
```

但我仍然希望有一个不需要辅助类的解决方案。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-17T12:58:34.977

一个可以使用

```
class options(object):
    VERBOSE = True
    IGNORE_WARNINGS = False

options.VERBOSE = False

if options.VERBOSE:
    ... 
```

，使用类对象本身（不是类的实例！）作为存储单个选项的地方。这很简洁并且满足所有要求，但它似乎是对类概念的误用。如果用户实例化该类，也会导致混淆`options`。

（如果需要多个选项持有对象的实例，这将是一个非常好的解决方案——类定义提供默认值，可以在单个实例中覆盖。）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-17T13:37:37.270

完成这项工作的最简单的类是：

```
class Struct:
    def __init__(self, **entries): 
        self.__dict__.update(entries) 
```

以后可以用作：

```
john = Struct(name='john doe', salary=34000)
print john.salary 
```

`namedtuple`（正如另一个评论所建议的）是一个更高级的类，它为您提供更多功能。如果您仍在使用 Python 2.5，`namedtuple`可以在[http://code.activestate.com/recipes/500261/找到基于 2.6 的实现](http://code.activestate.com/recipes/500261/)

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2011-06-24T08:09:38.263

简单对象和命名元组是要走的路

# javascript - 是否可以在浏览器视口中获取 div 的位置？不在文件内。窗内

> ID：211703
> 
> 赞同：17
> 
> 时间：2008-10-17T10:49:54.940
> 
> 标签：javascript, html, css

这在 IE7 或 Firefox 中是否可行？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-17T11:04:51.913

您可以在两者中执行此操作 - 获取相对于文档的位置，然后减去滚动位置。

```
var e = document.getElementById('xxx');
var offset = {x:0,y:0};
while (e)
{
    offset.x += e.offsetLeft;
    offset.y += e.offsetTop;
    e = e.offsetParent;
}

if (document.documentElement && (document.documentElement.scrollTop || document.documentElement.scrollLeft))
{
    offset.x -= document.documentElement.scrollLeft;
    offset.y -= document.documentElement.scrollTop;
}
else if (document.body && (document.body.scrollTop || document.body.scrollLeft))
{
    offset.x -= document.body.scrollLeft;
    offset.y -= document.body.scrollTop;
}
else if (window.pageXOffset || window.pageYOffset)
{
    offset.x -= window.pageXOffset;
    offset.y -= window.pageYOffset;
}

alert(offset.x + '\n' + offset.y); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-03-26T08:41:53.553

[[粘贴我在这里](https://stackoverflow.com/questions/1350581/how-to-get-an-elements-top-position-relative-to-the-browsers-window/18794913#18794913)给出的答案]

本机`getBoundingClientRect()`方法已经存在了很长一段时间，并且完全按照问题的要求进行。此外，所有浏览器都支持它（包括 IE 5，似乎！）

从[这个](https://developer.mozilla.org/en-US/docs/Web/API/element.getBoundingClientRect)MDN 页面：

*返回值是一个 TextRectangle 对象，它包含描述边框的只读 left、top、right 和 bottom 属性，以像素为单位，左上角**相对于视口的左上角**。*

你像这样使用它：

```
var viewportOffset = el.getBoundingClientRect();
// these are relative to the viewport, i.e. the window
var top = viewportOffset.top;
var left = viewportOffset.left; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-17T11:02:35.037

试试[尺寸 jQuery 插件](http://plugins.jquery.com/project/dimensions)。请参阅[此演示](http://brandonaaron.net/docs/dimensions/#sample-4)。

```
$('#myelement.').offset(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T20:44:06.690

在 IE 和 Firefox 3 中，您可以为此使用[getBoundingClientRect ；](http://ejohn.org/blog/getboundingclientrect-is-awesome)不需要框架。

但是，是的，如果您还需要支持其他浏览器，则应该使用框架。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T11:04:01.337

您可以从 document.body.scrollTop 中减去 div 的 offsetTop

这似乎适用于 IE7 和 FF3，但在一个非常简单的页面上。我还没有检查嵌套的 DIV。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T12:28:34.130

使用原型它将是：

```
$('divname').viewportOffset.top
$('divname').viewportOffset.left 
```

# c# - 由 MS Excel 和 COM 托管的 C# 2 中委托中的异常行为

> ID：211714
> 
> 赞同：3
> 
> 时间：2008-10-17T10:53:19.363
> 
> 标签：c#, excel, com, exception-handling, delegates

大家早，

这里有点语言理论问题......我在网上找到了一些参考资料，表明 C# 中的异常处理和委托在某些情况下有一些不同的行为，但我找不到任何关于此事的具体文档。

我们最近在 Microsoft Excel 插件的委托中遇到了一些大问题，导致 MSVC 运行时发生硬崩溃。删除代表解决了这个问题，但我现在很想知道血腥的细节。

作为核心代码的一个简洁示例：

```
Delegate del; // initialized elsewhere
try
{
    del.DynamicInvoke();
}
catch(Exception e)
{
    /* Parsing of exception to generate user-friendly message here */
} 
```

上述结构允许集中形式的错误处理，并且从纯代码的角度来看是简洁明了的。每个公开公开的函数都被声明为委托并通过上述片段执行。

在一个简单的控制台应用程序中，从委托中抛出异常或只是一个普通的意外错误（例如“意外地”在空指针上调用 ToString()）按预期工作，并按需要处理错误。

扔进 MS Excel，你会遇到严重的崩溃。单步执行代码将显示错误发生的位置，但在一切都陷入巨大的破坏火球之前，似乎*没有发生堆栈展开。*

我的假设是，托管 .NET 运行时（以及我们的代码）的 COM 正在做一些不同于正常 .NET 代码执行的事情。这会杀死端点，而 Excel 不知道这一点，而 Excel 又试图通过 COM 访问端点，却发现它不知何故消失了，而 Excel 作为回报也报废了。

这只发生在 Excel+COM+delegates 的组合中，但老实说，我不知道哪个对这种行为影响更大……有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-19T17:36:09.440

I think what you might find here is that you are not releasing the MS Excel COM objects you are implicitly creating when an exception is thrown. In my experience MS Office apps are very sensitive to their resources not being released (though most of my experience is with Outlook).

I would tend NOT to try to handle COM-based exceptions in this way if at all possible. If you want centalized logging, look at Application.ThreadException (for WinForms app) and AppDomain.CurrentDomain.UnhandledException instead.

Inside of your functions, you may want to call Marshal.ReleaseComObject() in your methods' finally {} blocks in order to make sure Excel doesn't get hosed when your exceptions are thrown.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T13:45:55.407

我觉得一个原因是由于委托正在调用在另一个线程中引发异常的实际代码。所以另一个线程中的异常被称为 async 不会在当前线程中被捕获，因为当前线程函数大部分会在异步调用执行之前退出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T12:35:36.237

为迟到的回复道歉 - 忙碌的一周！

> 异常捕获的整个想法不是“吞下”它们并显示错误消息，而是尽可能从情况中恢复，以及清理资源。

是的，这就是想法，但在实践中它并不总是那么干净。这里有问题的代码本质上是一个中间人，通常不知道是否会发生错误，如果发生错误，它不知道用户实际尝试做什么，因此会自动恢复。

> 它总是发生吗？

是的，如果这是一个意外异常并且它始终显示为源自 C#/.NET 代码的 .NET 异常

> 创建一个简单的方法，它只是抛出一个异常（ throw new ApplicationException();)，看看你是否还有问题？

不，每次抛出我们自己的异常都可以正常工作。只有当运行时本身产生异常时，我们才会遇到硬崩溃。

> 您没有释放在引发异常时隐式创建的 MS Excel COM 对象

这听起来很有道理。VBA 层通过 COM 将数据从 Excel 传递到 .NET，因此它很可能在资源所有权方面做一些时髦的事情。

> 如果您想要集中式日志记录，请查看 Application.ThreadException（对于 WinForms 应用程序）和 AppDomain.CurrentDomain.UnhandledException。

我没有调查前者，但后者永远不会被调用。我的第一个尝试是在 AppDomain 级别捕获它，假设无论出于何种原因，基于委托的异常正在通过网络传播。

> 你可能想调用 Marshal.ReleaseComObject()

有趣的是，我不知道该功能。我们几乎忽略了任何显式的 COM 代码，只希望（！）.NET CLR 发挥它的魔力......

我现在已经通过删除代表来解决它，一切似乎都很开心。只需要记住在未来的 Office+VBA+COM+CLR 代码中要小心（或完全避免）委托和异常 :-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T19:34:24.803

旁注：异常捕获的整个想法不是“吞下”它们并显示错误消息，而是尽可能从情况中恢复，以及清理资源。

最好在需要的地方使用 try/catch（即围绕可能抛出的代码），然后调用一个通用函数来显示/记录问题。

此外，如果您使用不同的线程来访问 Excel COM 对象，可能会发生很多奇怪的事情。

为了正确回答您的问题，需要更多信息：

1.  它总是发生吗？
2.  如果不是，当您看到问题是托管异常还是从 Excel 对象抛出的异常？
3.  你能创建一个简单的方法，只抛出一个异常（ throw new ApplicationException();)，看看你是否还有问题？

干杯

# excel - 如何制作一个在 Excel 中定期执行的宏？

> ID：211715
> 
> 赞同：8
> 
> 时间：2008-10-17T10:54:12.747
> 
> 标签：excel, vba

如何定期、完全自动化地执行一些 VBA 代码？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-17T11:18:56.427

您可以使用 Application.OnTime 来安排要定期执行的宏。例如，使用下面的代码创建一个模块。调用“启用”以启动计时器运行。

关闭工作簿时停止计时器运行很重要：这样做处理 Workbook_BeforeClose 并调用“禁用”

```
Option Explicit

Private m_dtNextTime As Date
Private m_dtInterval As Date

Public Sub Enable(Interval As Date)
    Disable
    m_dtInterval = Interval
    StartTimer
End Sub

Private Sub StartTimer()
    m_dtNextTime = Now + m_dtInterval
    Application.OnTime m_dtNextTime, "MacroName"
End Sub

Public Sub MacroName()
    On Error GoTo ErrHandler:
    ' ... do your stuff here

    ' Start timer again
    StartTimer
    Exit Sub
ErrHandler:
    ' Handle errors, restart timer if desired
End Sub

Public Sub Disable()
    On Error Resume Next ' Ignore errors
    Dim dtZero As Date
    If m_dtNextTime <> dtZero Then
        ' Stop timer if it is running
        Application.OnTime m_dtNextTime, "MacroName", , False
        m_dtNextTime = dtZero
    End If
    m_dtInterval = dtZero
End Sub 
```

或者，您可以以类似的方式使用 Win32 API SetTimer/KillTimer 函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T11:06:37.293

有一种应用方法可用于计时事件。如果您希望这种情况定期发生，您必须在每次执行后“重新加载”计时器，但这应该非常简单。

```
Sub MyTimer()
   Application.Wait Now + TimeValue("00:00:05")
   MsgBox ("5 seconds")
End Sub 
```

-亚当

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T12:02:10.207

您可以考虑使用 Windows 任务计划程序和 VBScript。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T18:09:42.023

我一直这样做，我曾经使用如上所示的“OnTime”方法，但它会使您正在运行代码的机器对其他事情无用，因为 Excel 100% 的时间都在运行。相反，我使用修改后的隐藏工作簿，并使用 Windows 任务计划程序执行，并在 thisworkbook workbook_open 函数中从您的个人工作簿中调用宏，或者打开并运行另一个包含代码的工作簿。代码运行后，您可以从隐藏的工作簿中调用 application.quit 函数并关闭 ecxel 以进行下一次运行。我将它用于我所有的 15 分钟和每日无人值守报告功能。

# common-lisp - Common Lisp 程序化关键字

> ID：211717
> 
> 赞同：27
> 
> 时间：2008-10-17T10:54:37.347
> 
> 标签：common-lisp

Common Lisp 中是否有将字符串作为参数并返回关键字的函数？

示例：`(keyword "foo")`->`:foo`

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-17T08:52:24.810

给出的答案虽然大致正确，但并不能为问题的示例产生正确的解决方案。

考虑：

```
CL-USER(4): (intern "foo" :keyword)

:|foo|
NIL
CL-USER(5): (eq * :foo)

NIL 
```

通常你想在实习之前将 STRING-UPCASE 应用于字符串，因此：

```
(defun make-keyword (name) (values (intern (string-upcase name) "KEYWORD"))) 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-10-17T11:31:29.067

这是一个`make-keyword`将关键字创建过程打包的函数（`intern`将名称放入`KEYWORD`包中）。:-)

```
(defun make-keyword (name) (values (intern name "KEYWORD"))) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-25T01:03:37.870

[Alexandria](http://common-lisp.net/project/alexandria/)库中有一个`make-keyword`函数，尽管它确实保留了大小写，因此要准确获得您想要的内容，您必须先将字符串大写。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-27T11:47:26.100

在此示例中，它还处理带有空格的字符串（用点替换它们）：

```
(defun make-keyword (name) (values (intern (substitute #\. #\space (string-upcase name)) :keyword))) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-05T00:45:39.573

以防万一，您可以将字符串更改为以冒号开头`:`

直接使用`read-from-string`。

这是另一个版本`make-keyword`：

```
(defun make-keyword (name)
           (read-from-string (concatenate 'string ":" name))) 
```

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2008-10-17T11:22:37.337

```
(intern "foo" "KEYWORD") -> :foo 
```

有关其他字符串/符号转换以及符号和包的详细讨论，请参阅[Common Lisp Cookbook](https://lispcookbook.github.io/cl-cookbook/)的[字符串部分。](https://lispcookbook.github.io/cl-cookbook/strings.html#converting-between-symbols-and-strings)

# java - Struts 逻辑问题

> ID：211718
> 
> 赞同：1
> 
> 时间：2008-10-17T10:55:54.350
> 
> 标签：java, struts, tags, logic

为什么下面的代码不起作用？这个想法是页面检查下拉变量是否在您上次刷新页面后发生了变化。

```
 <logic:equal name="Result" value = "-1">
   <bean:define id="JOININGDATE" name="smlMoverDetailForm" property="empFDJoiningDate"
         type="java.lang.String" toScope = "session" />
 </logic:equal> 

 <logic:equal name="Result" value = "-1">
   <bean:define id="DropDownValue" name="smlMoverDetailForm" property="moverChangeType" 
type="java.lang.String" toScope = "session" />              
</logic:equal>

<-- when you fisrt access this page from the above are run -->

 <bean:define id="NewDropDownValue" name="smlMoverDetailForm"
  property="moverChangeType" type="java.lang.String" toScope = "sess

<-- this happens everytime the page is refreshed-->

   <logic:equal name= DropDownValue   value = NewDropDownValue>
    <bean:define id="JOININGDATE" name="smlMoverDetailForm"
  property="empFDJoiningDate" type="java.lang.String" toScope = "session" />
   </logic:equal> 

    <logic:notEqual name="DropDownValue"   value = "NewDropDownValue">
    <bean:define id="DropDownValue" name="smlMoverDetailForm" 
    property="moverChangeType" type="java.lang.String" toScope = "session"
     />              
    </logic:notEqual> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-19T20:29:50.273

您已经意识到，您的 bean:define - 至少在您在这里提出的问题中 - 是有缺陷的？

```
toScope="sess 
```

很可能不是您想要的 - 它甚至不会终止标签。但这可能是 StackOverflow 中的格式......此外，其他答案中也提到了缺少的引号。

错误可能是使用 value 属性：根据[http://struts.apache.org/1.2.x/userGuide/struts-logic.html#equal](http://struts.apache.org/1.2.x/userGuide/struts-logic.html#equal) value is *The constant value to which variables,由其他属性指定(s) 这个标签，将被比较。*

因此，假设您已经定义了一个名为 NewDropDownValue 的 bean，您可能想要评估

```
<logic:equal name="DropDownValue" value="<%=NewDropDownValue/>"> 
```

编辑：此外，我不记得当您仅有条件地定义一个 bean 时会发生什么 - 您的 bean 是在一个可能会或可能不会被评估的 logic:equal 块中定义的。它可能是合法的并且有明确的结果，我只是不记得了......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T08:28:25.983

尝试这个：

```
<logic:equal name="Result" value = "-1">
   <bean:define id="JOININGDATE" name="smlMoverDetailForm" property="empFDJoiningDate"
         type="java.lang.String" toScope = "session" />
 </logic:equal> 

<logic:equal name="Result" value = "-1">
   <bean:define id="DropDownValue" name="smlMoverDetailForm" property="moverChangeType" 
        type="java.lang.String" toScope = "session" />              
</logic:equal>

<!-- when you fisrt access this page from the above are run -->

<bean:define id="NewDropDownValue" name="smlMoverDetailForm"
    property="moverChangeType" type="java.lang.String" toScope = "session"/>

<!-- this happens everytime the page is refreshed-->

<logic:equal name="DropDownValue" value="<%=request.getSession().getAttribute("NewDropDownValue").toString()%>">
    <bean:define id="JOININGDATE" name="smlMoverDetailForm"
        property="empFDJoiningDate" type="java.lang.String" toScope ="session" />
</logic:equal>

<logic:notEqual name="DropDownValue" value="NewDropDownValue">
    <bean:define id="DropDownValue" name="smlMoverDetailForm" 
        property="moverChangeType" type="java.lang.String" toScope = "session"/>              
</logic:notEqual> 
```

更正的错误：

*   评论没有很好的形成
*   第三次没有正确结束
*   改变获取NewDropDownValue的方式

我认为这些更改将使其正常运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T11:28:05.127

```
<logic:equal name= DropDownValue   value = NewDropDownValue> 
```

我不确定这是否是您的问题（请描述它是*如何*不起作用的），但上面的 xml 无效：它需要在属性值周围加上引号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T19:32:16.627

实际上，我并没有真正得到你想要的，但这里有一些伪代码（删除那些危险的尖括号）你的代码在问题中

```
if result == -1
   define JOININGDATE
end
if result == -1
   define DropDownValue
end 
```

这可能是一个错误（您可能想检查一次“等于”和一次“不等于”）或写得更短更清晰

```
if result == -1
   define JOININGDATE
   define DropDownValue
end
// otherwise don't define both values 
```

如果您在这些逻辑标签中放置一些输出并发布输出和更多上下文（例如实际参数值 - 什么是“结果”），您的问题可能会得到更好的答案（或由您自己回答）。但是然后 - 你是从一个未注册的帐户发布的，并且已经有一段时间没有被看到了......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T12:18:50.237

问题是正如您所描述的，我无法获得逻辑标签来评估定义的 bean 中保存的值。

# .net - 我应该在 dllimport 中使用 Ansi 还是 Unicode 字符集？

> ID：211739
> 
> 赞同：4
> 
> 时间：2008-10-17T11:05:40.960
> 
> 标签：.net, unicode, pinvoke

当您使用 DllImport 导入函数时，您可以指定要使用的 CharSet。我注意到在 C#、C++ 和 Visual Basic 中，.Net 运行时默认使用 Ansi 而不是 Unicode。因此，对于任何具有 A 和 W 版本的系统调用，默认情况下都会调用 A 版本。.Net 在内部使用 unicode，如果我没记错的话，新版本的 windows 也会将所有内容都转换为 unicode，因此这意味着大量额外的编组开销。

我已经养成了总是在这里指定 unicode 的习惯，这是正确的做事方式还是会导致问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T11:13:17.263

如果您使用 ANSI 变体，如果（例如）有一个名称无法在所使用的 ANSI 代码页中表示的文件，您将遇到问题。使用 Unicode 的唯一缺点是您的代码在 Windows 的旧 Win9x 版本（95、98 和 ME）上可能无法正常工作。

有一些函数必须使用 ANSI，因为它们实际上使用 ASCII（例如 GetProcAddress）。

# string - sprintf 风格的字符串格式化的由来

> ID：211741
> 
> 赞同：5
> 
> 时间：2008-10-17T11:06:33.690
> 
> 标签：string, formatting, multilingual, printf

**在sprintf**中发现的字符串格式化概念现在几乎可以在任何语言中找到*（你知道，用 %s %d %f 等来扼杀一个字符串，并提供一个变量列表来填充它们的位置）*。

**最初是哪种语言具有提供此功能的库函数或语言结构？**

请指定某种来源参考以确认您的主张，以免我们进行纯粹的猜测或猜测。

问候

罗伯特

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T11:13:19.603

[维基百科有相当详尽的历史。](http://en.wikipedia.org/wiki/Printf)这表明 C printf 函数起源于 BCPL 的 writef 函数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T11:35:23.413

我想说他们都可以追溯到 BCPL。二十年前，我们使用 BCPL 为 6809 处理器进行操作系统编程，它有一个`writef()`函数，可以接受诸如`%i2`(相当于 C's `%2d`) 之类的参数。

C 是基于 BCPL 的精简版本，并继承了用于格式化输出的类似机制，我很确定所有其他实例在那之后都从 C 中提取了它。

我可能是错的，这不会是第一次或最后一次，但鉴于我对 BCPL 语言及其起源的了解，我很有信心这是对的。

# asp.net-mvc - 将现有 ASP.NET 站点逐步转换为 MVC 的最佳方法

> ID：211744
> 
> 赞同：24
> 
> 时间：2008-10-17T11:06:38.743
> 
> 标签：asp.net-mvc

请记住，这对我来说是新的，我可能错过了一些重要的事情。

我有一个基于 ASP.NET Web 应用程序的现有网站。我现在正在使用 ASP.NET MVC 进行新开发，并打算逐步将大部分页面替换为基于 MVC 的页面。

我这里有两个问题：

1）我需要逐步替换页面，因为我不能一次转换所有内容。2) 如果可能，应保留（物理文件的）现有 URL。

在我看来，我有以下选择：

1) 在网站的根目录中创建一个全新的 MVC Web 应用程序，然后将现有的 HTML/ASPX/ASMX/... 页面包含到其中。这样，路由总是相对于网站的根目录。

2）修改现有的Global.asax、Web.config、Default.aspx（等等）来开启MVC处理程序进行路由，然后将我的MVC应用程序发布到子文件夹中。

最简单的方法是什么，我错过了什么吗？

谢谢，劳伦特

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-30T03:24:22.470

像你一样，我正在解决同样的问题。我遇到的一些事情我在这里发布了[https://stackoverflow.com/users/84825/mouffette](https://stackoverflow.com/users/84825/mouffette)，它们主要与 SETUP 相关。最好的办法是启动一个新的 MVC 项目并将文件和结构与现有的 ASP.NET 应用程序进行比较。如有疑问，只需逐行移动和 web.config's，最终你会得到它;-)

一旦你有管道工作，你就可以专注于 MVC，它只是并行工作。

这些链接也有帮助：

[http://media.wiley.com/assets/1539/15/professionalaspnet35mvc_chapter13.pdf](http://media.wiley.com/assets/1539/15/professionalaspnet35mvc_chapter13.pdf) [http://aspnetmvcbook.s3.amazonaws.com/aspnetmvc-nerdinner_v1.pdf](http://aspnetmvcbook.s3.amazonaws.com/aspnetmvc-nerdinner_v1.pdf)

你已经找到了最好的网站...stackoverflow。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T11:25:38.643

Scott Hanselman 有一篇很好的博客文章讨论了如何将 MVC 与 Web 窗体和其他 ASP.NET 技术结合起来。 [http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx](http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T12:56:24.170

这实际上取决于您现有 Web 应用程序的状态。如果它主要只是嵌入到您的代码隐藏中的业务逻辑，那么重新编写可能会更好。如果您的数据对象模型和业务层与您的代码背后的代码分离得非常好，那么您在这个过渡方面处于领先地位。不幸的是，这是一个非常难以简洁回答的问题，并且根据您当前的状态是相当主观的。

“经典的 ASP.Net 站点” - 听起来很奇怪。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T18:00:59.950

我认为这个问题措辞错误，因为这不是我的意思。

我的意思是：如何将基于 MVC 的页面*集成*到现有的“经典”ASP.NET 站点中（是的，我知道这听起来很奇怪 :)）。我最终将替换整个内容（如果这意味着重写一些页面，那就这样吧），但我想已经添加基于 MVC 的新内容。

我找到了有关如何创建新的 MVC 应用程序，甚至是如何在其中集成新的基于 Web 表单的内容的指导，但更不用说将应用程序逐渐移植到 MVC 了。

我找到了这个链接 [http://blog.eworldui.net/post/2008/05/ASPNET-MVC---Living-in-a-Web-Forms-World.aspx](http://blog.eworldui.net/post/2008/05/ASPNET-MVC---Living-in-a-Web-Forms-World.aspx)

这是有希望的，但听起来很麻烦。

具体来说，我正在寻找在现有 ASP.NET 应用程序中添加新的基于 MVC 的内容的步骤，并且仍然保持旧内容像以前一样工作。

# usability - 友好的 HTTP 401 状态码消息？

> ID：211747
> 
> 赞同：7
> 
> 时间：2008-10-17T11:07:52.453
> 
> 标签：usability, http-status-codes, http-status-code-401

我是开发人员而不是文字匠，因此我被困住了。

我们有一个基于订阅的网站，用户很可能会看到我们的 401 页面。

我们决定需要替换 IIS 401;2 页面。

有没有人有任何例子或建议写一个好的非攻击性 401 页面？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-17T11:36:29.620

这是一个真实的例子——也是一个非常有趣的例子——据说取自 michaelbloomberg.com

> 未经授权 (401)
> 
> 通过一系列高度复杂的算法，本系统已确定您目前无权使用本系统功能。可能是您只是输错了密码，或者您可能是某种星际外星人，没有手，因此无法打字。如果我是个赌徒，我敢打赌，一只猫（一只名叫 Sierra 或 Harley 的橙色虎斑猫）不知何故跳到了你的键盘上，忘记了你花钱购买的打字课程中的一些更重要的提示。根据遇到的实际错误，我猜测有问题的猫科动物只是在开始之前忘记将一只或两只爪子放在适当的主页键上。再说一次，我想这可能是某种形式的宇宙辐射引起的键盘错误；这很符合我的行星际外星人理论。如果你认为这可能是原因，也许你可以建造某种地下掩体来帮助保护自己免受它的伤害。我不知道它会起作用，但是，如果你尝试一些东西，你可能会感觉更好。

不要让我开始使用所有很酷的 404 页面......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T11:35:04.567

我不得不刷新我的记忆，看看[HTTP 错误 401 - Unauthorized](http://www.checkupdown.com/status/E401.html "HTTP 错误 401 - 未经授权")到底是什么......

因此，基本上，如果您未获得授权（未订阅）或未能通过身份验证（用户名/密码错误），您可能会收到此错误。加上其他一些角落案例。

可能是这样的：
“我们很抱歉，但我们无法验证您的身份。您必须订阅才能访问这些页面。如果您已经订阅，请检查您在登录步骤中是否提供了正确的凭据。”

当然，只是用正确的英语（我是法国人），也许还有更多细节（如果你忘记了密码怎么办等）。以及指向网站公共部分和登录页面的链接。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-11-22T02:36:18.973

只晚了 9 年，但也许这可以帮助某人。我为我的网站想出的一个是，

[![在此处输入图像描述](https://i.stack.imgur.com/Tq7zm.png)](https://i.stack.imgur.com/Tq7zm.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-19T10:01:31.103

可以肯定的是，Don Norman 和 Jakob Nielsen 的人机交互设计原则仍然适用于网页设计和 401 页面。

401 页面仍然是网页，主要区别是用户稍微更加困惑/沮丧。

以下是设计原则：

*   可见性 - 用户能否看到它是一个 401 页面并且他/她是否理解
*   反馈 - 用户是否了解正在发生的事情
*   Affordance - 用户是否了解可点击的内容以及如何处理您的界面
*   映射 - 用户是否了解单击何处从 401 中恢复
*   约束 - 限制用户拥有的自由，使他/她更容易认知处理。
*   一致性和标准 - 使用您在网站其他任何地方使用的相同标准

关于这个问题的一个非常好的免费资源是美国政府的[可用性指南书](http://www.usability.gov/guidelines/guidelines_book.pdf)。

# unit-testing - 你在你的专业项目中使用单元测试吗？

> ID：211751
> 
> 赞同：8
> 
> 时间：2008-10-17T11:09:02.373
> 
> 标签：unit-testing, testing, architecture, tdd

我们即将开始项目的一个新部分，似乎对单元测试没有太多兴趣（而且感觉他们没有经历过 TDD）。我相信它几乎是必不可少的，它使维护变得更加容易。那么你的观点是什么？

谢谢

顺便说一句：这是一个与语言无关的问题，但是新项目是用 Java 编写的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-17T11:19:29.730

我发现单元测试不仅仅是一件有用的事情，它也是开发人员的*责任*。如果您发布的代码尚未编写为通过一组有效且全面的单元测试，那么您很可能会延迟您的项目，或者导致其他人的包、类等出现问题。

此外，您应该与您的客户（即使是您自己的公司）保持密切联系，并尝试并鼓励他们进行全面的验收测试。这符合他们的最大利益（尽管我发现一些公司反对这个想法，因为执行测试所需的时间很短，尽管如果产品不能完全执行它会节省大量时间他们想要什么）。

**编辑**

所以，是的，我想我想说的是：是的，我确实认为[测试驱动开发](http://en.wikipedia.org/wiki/Test-driven_development)是要走的路。我当然没有提到的另一件事是测试有助于记录代码这一事实。您将知道这些方法应该做什么，并且您将确定当您在以后的任何阶段进行更改时它们仍然可以执行。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-18T04:01:19.350

我们的项目绝对使用单元测试。每个不是无脑 getter 和 setter 的类都经过单元测试。对您的代码进行功能测试使您可以随意重构，而不必担心一次会破坏 50 种不同的东西。

单元测试的另一个被低估的方面是它使算法的被忽视的方面浮出水面。我只花了两天时间使用正交数组编写和重写单元测试，因为每次我想出一个测试用例列表时，我都会发现技术负责人忽略了问题的另一个维度。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-17T11:13:29.773

是的。我们使用 TDD 已经有一段时间了。不知何故，我们发现了 TDD，我们喜欢这种增量方法，以实现更好的代码质量。尽管在最初的拒绝曲线中，您认为在编写代码时进行一致和渐进的单元测试会减慢开发速度，但在许多方面都是必不可少的。由于正在逐步构建回归测试框架，因此很难编写重大更改。如果做得好，代码会更加健壮，并且对代码和整个项目的信心都会受到积极影响。

现在编写单元测试不仅仅适合精英。这应该是每个开发人员的责任。越晚在代码上发现错误，修复的成本就越高，也就越难找到。这很容易成为维护的噩梦。对单元测试有强有力的支持可以大大降低这种风险。

将单元测试和 TDD 的强大功能与配置良好的持续集成系统相结合，可以在项目的早期阶段快速发现问题。每天构建是避免未来和几乎可以肯定的麻烦的必要条件。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-17T12:08:59.990

单元测试是有代价的。首先，您必须编写并验证所有额外的代码。然后你可能不得不在项目团队中推动昂贵的文化变革来接受单元测试。

这个价格可能值得为您的特定项目支付。该决定不应基于教条或轶事，而应基于对成本和收益的仔细分析。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T12:20:04.057

严格来说不是 TDD，但我对我编写的每一段代码都进行了单元测试。我对它的看法与我对源代码控制和重构的看法相同；它们是您编写高质量代码所*要做的事情。*我不会想到*不*进行单元测试。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-17T13:21:15.593

我们在一段代码像客户真正想要的那样工作之后进行单元测试。一开始我们做单元测试的速度太快了，当客户改变主意时（相信我），你经常不得不删除代码以及单元测试。这太耗时且成本高昂。我支持单元测试，但[TDD](http://en.wikipedia.org/wiki/Test-driven_development)对我们来说并不经济。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-08-25T09:49:33.677

我无法想象现在在没有自动化测试的情况下进行项目（单元/集成等......）

其实我经常说

> “如果这坏了，那不是我的错”

在处理没有测试的人们的代码时。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-17T11:23:07.383

我发现 TDD 非常有用，但是一些开发人员直到编写一些新代码破坏了旧测试时才看到它的价值。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-17T21:47:25.570

当你在论坛上提问时，很多人会说单元测试是“强制性的”，但实际上单元测试的考虑正如调查结果所示。有关更多参考资料/材料，请参阅[http://www.methodsandtools.com/dynpoll/oldpoll.php?UnitTest2](http://www.methodsandtools.com/dynpoll/oldpoll.php?UnitTest2)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-17T11:34:10.623

我有兴趣做这件事，但不知道如何开始我最终参与的大型项目......自 1996 年以来就没有参与过一个真正全新的项目！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-17T12:54:01.850

我希望我可以在我的项目中更多地使用单元测试，并且我希望我的同事至少正在编写*一些*测试。:)

就我而言，启用单元测试和使用 TDD 实践需要付出相当高的代价。它主要依赖于工具，这些工具对于我们正在使用的框架来说是相当糟糕的。如果只需单击整个项目（或单击两次，以防我们目前需要特定测试）就可以执行单元测试，那会容易得多。我们现在使用的工具并没有真正得到回报——有时手动发现错误比运行测试更容易。

使用 Java，有更好的工具，所以你现在真的应该开始编写测试了！调试很糟糕，测试岩石，真的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-17T13:16:07.280

不幸的是不是每次。我们最关键的任务系统充满了单元测试，以确保他们做他们应该做的事情，并且不管开发人员如何都继续做。对于其他系统，大多数时候开发时间太短，无法将其花在编写测试上。（但最终赢得的时间是在调试上花费了两次。）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-18T02:59:38.693

是的。除非客户在我头上拿着枪，以便在一天结束前将功能推出门外。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-18T03:47:56.227

单元测试（我在这里考虑 JUnit）和 TDD 是当您使用新代码开始一个新项目时要走的路（您将需要更多类似 CI）。

但是，当您的新项目要修改一个充满紧密耦合类的旧代码库时，每个类中都有 5KLOC，那么单元测试很困难，并且大多数时候项目时间线不允许重构（或重写）。如果这是您即将开始的项目，我建议您阅读“使用遗留代码”以测试旧代码的策略。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-10T19:20:57.630

在所有新的开发中，我们现在都做 TDD。对于遗留维护，我们创建失败的单元测试以暴露报告的缺陷并逐步建立一个库。

这是一种文化冲击，但当您意识到您将更多时间花在新开发上而花费更少时间寻找错误时，它确实会得到回报。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-10-11T17:18:30.253

是的，只要我能。我必须支持我编写的代码，而且我知道在开发过程中花费的少量额外时间使我免于在发布后花费大量额外时间。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-10-11T18:51:23.640

如果它值得写，那就值得测试。

# sql-server - 将 SP 返回值设置为 SQL Server 中的变量

> ID：211758
> 
> 赞同：13
> 
> 时间：2008-10-17T11:11:04.833
> 
> 标签：sql-server, stored-procedures

我有一个存储过程，它返回带有文本的单行和列，我需要将此文本设置为一个变量，例如：

```
declare @bla varchar(100)
select @bla = sp_Name 9999, 99989999, 'A', 'S', null 
```

但当然，这段代码不起作用......

谢谢！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-17T11:35:37.187

如果您无法更改存储过程，另一种解决方案是定义一个临时表，并将结果插入其中

```
DECLARE @Output VARCHAR(100)

CREATE TABLE #tmpTable
(
    OutputValue VARCHAR(100)
)
INSERT INTO #tmpTable (OutputValue)
EXEC dbo.sp_name 9999, 99989999, 'A', 'S', null

SELECT
    @Output = OutputValue
FROM 
    #tmpTable

DROP TABLE #tmpTable 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-17T11:18:30.840

如果存储过程返回单个值，您可以将存储过程上的参数之一定义为 OUTPUT 变量，然后存储过程将设置参数的值

```
CREATE PROCEDURE dbo.sp_Name
    @In INT,
    @Out VARCHAR(100) OUTPUT

AS
BEGIN
    SELECT @Out = 'Test'
END
GO 
```

然后，你得到如下输出值

```
DECLARE @OUT VARCHAR(100)
EXEC sp_name 1, @Out OUTPUT
PRINT @Out 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-10-17T12:06:40.447

```
DECLARE
  @out INT

EXEC @out = sp_name 'param', 2, ... 
```

T-SQL“EXECUTE”[帮助](http://msdn.microsoft.com/en-us/library/ms188332.aspx)中的更多信息（帮助来自 MSSQL 2008，但这也适用于 2000）

# apache-flex - ASDoc 通过 Flex Builder UI？

> ID：211760
> 
> 赞同：4
> 
> 时间：2008-10-17T11:12:52.007
> 
> 标签：apache-flex, flexbuilder, asdoc

有什么方法可以通过 Flex Builder UI 在您的项目上运行 ASDoc？或者，是否有一个好的（最好是免费的）插件可以做到这一点？

如果没有它的 UI，是否有人有一个教程的链接，关于如何在我构建我的项目时将其设置为自动，可能是通过 Ant（我从未使用过，但我很乐意尝试）或者其他的东西？（对不起，多部分问题）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T12:09:07.913

以下是为您运行 AsDoc 的 ant 任务的一些链接：

*   [埃里克·费米内拉（Eric Feminella）的一份](http://www.ericfeminella.com/blog/2007/06/07/asdocanttask-project-for-eclipse/)
*   [克里斯托夫·赫勒曼 (Christophe Herreman) 的一份](http://www.herrodius.com/blog/85)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-19T18:28:36.120

The solution at Seb Lee-Delisle's blog worked pretty well for me! I recommend it to anyone who is still looking for a solution. To get it working for me I had to use "Browse Workspace.." to add the specific project folder rather than use `${project_loc}` as suggested for current project. Also wrap the path to your swc folder in quotes for -library-path if you have spaces in any of the directory names. Escaping the spaces in the Arguments field did not seem to work for me.

[http://sebleedelisle.com/2009/03/how-to-set-up-asdoc-in-flex-builder/](http://sebleedelisle.com/2009/03/how-to-set-up-asdoc-in-flex-builder/)

If this is outdated in anyway or anyone has any bits to add it would be nice to hear them. I have not seen this explanation anywhere else yet so it was quite nice to find it worked :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T11:43:11.337

[该工具](http://www.idefactory.com/)表示只需单击功能页面即可完成此操作，尽管它可能比您想要的要多一些。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T10:51:16.307

您可以在将运行 asdoc 实用程序的外部工具中定义启动配置。

这篇博文中提供了详细信息[使用外部工具启动 ASDoc](http://amiest-devblog.blogspot.com/2007/12/launching-asdoc-with-external-tools.html) @amieStreetDevelopment

另一个：[带有 Eclipse](http://blog.formatlos.de/2008/07/10/asdoc-with-eclipse/) @formatlos 的AsDoc

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-29T15:05:44.363

SourceMate 也提供此功能。您可以在以下网址下载 30 天免费试用版：

[www.elementriver.com/sourcemate](http://www.elementriver.com/sourcemate)

SourceMate 还为 Flex 开发提供了更多功能。

# silverlight-2.0 - 将额外项目添加到 Silverlight 2 组合框

> ID：211761
> 
> 赞同：2
> 
> 时间：2008-10-17T11:13:13.707
> 
> 标签：silverlight-2.0, silverlight-2-rc0

对于 Silverlight 2 网络应用程序。我添加了一个组合框。我有一个 IEnumerable 作为 Itemsource 来填充组合框。工作正常。

但是我想在组合框中添加一个额外的项目（“请选择一个......”），任何人都知道如何使用 Silverlight 2 组合框来完成。

欢迎提供有关使用 ComboxboxItems 模板的更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-19T15:38:31.923

您可以使用以下代码轻松地在 ComboBox 的 Items 集合中的所需索引位置插入项目。

          文本块 t = new TextBlock();

            t.Text = "请选择....";

            combo.Items.Insert(0, t);

设置选定的索引将设置 ComboBox 以默认显示您添加的项目：

 combo.SelectedIndex = 0;

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T10:10:39.010

从异步调用返回`List<>`到 WCF 服务后，我使用以下语法在绑定到组合框之前将项目添加到结果中。在我的场景中，如果您尝试在绑定后将项目添加到列表中，则会引发只读错误。

```
E.Result.Items.Insert(0, new object { param1 = "", Param2 = ""} ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-18T21:15:17.140

如果您使用的是 WCF，则可以使用以下代码：

```
SilverlightApplication1.ServiceReference1.Region item = 
   new SilverlightApplication1.ServiceReference1.Region ();
item.RegionID = 0;
item.RegionDescription = "-Select Region-";
e.Result.Insert(0, item);

drControl.ItemsSource = e.Result; ////////.Result;  
drControl.SelectedIndex = 0; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-03-30T13:57:47.360

只需将其添加到 Xaml 页面并将其选中为 True....

# c# - 我必须使用 SVN API 或库访问/提交/更新 WPF 应用程序中的 SVN 存储库

> ID：211765
> 
> 赞同：40
> 
> 时间：2008-10-17T11:13:45.657
> 
> 标签：c#, .net, svn

任何可用于从 .net 应用程序（使用 C#）访问 SVN 的 GOOD 库。到目前为止，我发现我将尝试的唯一 3 个是：

*   [SVN#](http://www.softec.st/en/OpenSource/ClrProjects/SubversionSharp/SubversionSharp.html)
*   [SharpSVN](http://sharpsvn.open.collab.net/)
*   [神经网络](http://www.hanselman.com/blog/PowerShellAnkhSVNAndSubversion.aspx)

我想创建一个非常简单的 SVN 客户端！

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-10-17T12:44:56.407

SharpSvn 设计用于 .Net 2.0 和 Subversion 1.5 及更高版本。它将所有颠覆依赖项集成在一组 dll 中，可直接从 .Net 使用（XCopy 可部署）。SharpSvn 的另一个优点是它隐藏了所有内存管理并在异常中转换 Subversion 错误，更重要的是反之亦然。（使调试回调非常容易）

AnkhSVN 在 AnkhSVN 2.0 之前使用 NSvn。之后它移到了 SharpSvn。

Codeplex 上的 IronSvn 项目关闭。（它建议使用 SharpSvn）。

Svn# 和它的 2.0 继承者 Svn.Net 是 Subversion C api 的普通包装器。他们需要颠覆版本的二进制文件才能工作。您必须管理 apr 池和一些将自己从托管代码编组的 apr 集合。这是此列表中唯一的跨平台解决方案。（在 linux 上也能正常工作）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-25T16:25:34.300

我使用了 SharpSvn。它很容易集成并且对我来说效果很好。如果您需要一些示例代码，请查看此项目[https://github.com/bhank/SVNCompleteSync](https://github.com/bhank/SVNCompleteSync)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-17T11:50:50.573

我目前正在使用 SharpSVN - 可以很好地满足我的需要（尽管它是用于自动化过程，因此不需要 UI 工作）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T11:16:06.993

*   NSvn 怎么样（如果我没记错的话）也是 ankhsvn 的核心（查看 tigris.org 网站了解更多信息）

# javascript - 为大型代码库编写适当的可维护可读 jQuery 的行业和社区最佳实践是什么？

> ID：211769
> 
> 赞同：5
> 
> 时间：2008-10-17T11:15:02.627
> 
> 标签：javascript, jquery, oop, readability

来自 Ruby 背景，我习惯于使用带有方法等的类来编写我的所有代码。我确实非常了解 javascript，但我对 jQuery 及其最佳实践并不陌生。

显然有一百万种方法可以在 javascript 中模拟类。但是，实际 jQuery 社区在现实世界中真正使用的是什么？

具体的例子将是理想的。或链接到真实的生产代码。虚构的理想代码的链接也会有所帮助。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-21T15:22:21.347

这不适用于 jQuery，但我喜欢在我自己的代码中模拟类的对象文字语法。

[http://ajaxian.com/archives/show-love-to-the-object-literal](http://ajaxian.com/archives/show-love-to-the-object-literal)

我倾向于经常使用这样的（简化的）框架：

```
var Widget = {

    sound:'bleep',

    load:function(){

        // do stuff here that doesn't need to wait until the DOM is ready.

        // Inside an anonymous function (such as the 'click' handler below),
        // 'this' loses its scope and no longer refers to the widget object.
        // To retain a reference to the widget object, assign 'this' to a
        // variable. I use an underscore... some people like 'self':
        var _ = this;

        // when the DOM is ready, run the init "method":
        $(document).ready(function(){
            _.init(); // the underscore now refers to the widget object
        });

    },

    init:function(){

        var _ = this;

        // whenever a <p class="noisy"> element is clicked, call makeNoise()
        $("p.noisy").click(function(){
            _.makeNoise();
        });

    },

    makeNoise:function(){

        alert(this.sound); // alert 'bleep'

    }

};

Widget.load(); 
```

**编辑：**有关使用“this”关键字的更多信息，如上所述：

[http://groups.google.com/group/jquery-en/browse_thread/thread/328d07f90467cccc?pli=1](http://groups.google.com/group/jquery-en/browse_thread/thread/328d07f90467cccc?pli=1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T15:29:36.357

我将从这里开始寻找灵感：

[http://errtheblog.com/posts/73-the-jskinny-on-jquery](http://errtheblog.com/posts/73-the-jskinny-on-jquery)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-26T11:41:42.840

我在当前项目中使用 jQuery 时遇到了同样的问题，我对 jQuery 也有同样的感觉。它就像大的神秘方法链。当它变大时，需要更多时间来理解我之前写的内容。

我发现制作更易于维护的 jQuery 代码的唯一方法是[模块模式](http://www.yuiblog.com/blog/2007/06/12/module-pattern/)。也许它会很有用。你也可以看看 Ajaxian [jQuery vs. Prototype: OO JavaScript with or without training](http://ajaxian.com/archives/jquery-vs-prototype-oo-javascript-with-or-without-training-wheels) Wheels文章关于同样的问题。

# javascript - JavaScript 是否有任何编码标准？

> ID：211795
> 
> 赞同：179
> 
> 时间：2008-10-17T11:27:56.563
> 
> 标签：javascript, coding-style

JavaScript 的既定编码标准是什么？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2008-10-17T13:20:10.767

不完全是你要找的东西，但是（就像 Doug Crockford 的 vids 一样）我认为每个编写/编辑/评论 JS 的人都应该看看 Chris Heilmann 的关于可维护 javascript 的[幻灯片](http://www.slideshare.net/cheilmann/fronteers-maintainability-presentation)和[视频](http://ajaxian.com/archives/maintainable-javascript-videos-are-now-available)。

在[幻灯片](http://www.slideshare.net/cheilmann/fronteers-maintainability-presentation)中，幻灯片 127，他说不要太担心样式指南/代码标准，重新格式化所有签入到 VCS 的代码。

还有这些：

[Mozilla JavaScript 技巧](http://developer.mozilla.org/en/JavaScript_style_guide)

[JavaScript 样式指南](http://neil.rashbrook.org/Js.htm)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-10-18T00:24:06.870

[Crockford 的 JavaScript](http://javascript.crockford.com/code.html)编码指南值得遵循的另一个原因是：

由于 JavaScript 的分号注入，这段代码（如下）实际上返回 undefined - 这是让整个开发团队从同一张歌曲表中唱歌的好理由：

```
return // injected semicolon, therefore returns 'undefined'
{
    javascript : "fantastic"
}; // object constructs anonymously but nothing happens with it. 
```

在[提防 JavaScript 分号插入时了解更多信息](http://www.robertnyman.com/2008/10/16/beware-of-javascript-semicolon-insertion)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-17T11:30:23.627

我从未见过一个广为接受的 JavaScript 编码标准。前段时间我们确实写了自己的，我按照我的雇主[在我的博客上发布了它。](http://blog.galasoft.ch/archive/2007/02/05/105493.aspx)

请记住，某些指南可能有点过时了。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-10-13T01:28:47.960

Google 发布了[Javascript 指南](https://google.github.io/styleguide/jsguide.html)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-17T13:11:52.110

[您可以在Google Code Wiki](http://code.google.com/p/gmaps-utility-library-dev/wiki/JavascriptCodingConventions)找到一些简单但必不可少的编码约定。

有关非常详细的样式指南，请阅读[Dojo 样式指南](http://dojotoolkit.org/community/styleGuide)。它正在讨论命名约定、文件约定、变量使用、代码布局、空格和注释。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-12-21T22:15:31.740

[有点困惑，我在Idiomatic.js](https://github.com/rwldrn/idiomatic.js)和 [jQuery Core Style Guide](http://docs.jquery.com/JQuery_Core_Style_Guidelines)的回复中找不到 。Addy Osmani 在他的“JavaScript Style Guides And Beautifiers”文章中将这两个放在 JavaScript 编码样式的最顶端。

我个人更喜欢 jQuery 标准，尽管它与 Idiomatic.js 没有太大区别。但是无论您选择什么标准，您都需要一个验证器来检查您遵循它的成功程度。我找不到任何 jQuery 或至少 Idiomatic，但最终想出了[JS_CodeSniffer](https://github.com/dsheiko/jscodesniffer)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-05-02T21:59:02.203

[comp.lang.javascript 代码指南](http://jibbering.com/faq/notes/code-guidelines/)文档指出了与 web 应用程序的 javascript 相关的错误和问题的原因以及如何避免它们。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-06-10T13:03:30.933

我和其他一些人最近将[这些](http://www.asp.net/ajaxlibrary/act_contribute_codingStandards.ashx)（PDF 或 HTML）放在一起

它们主要用于 Ajax Control Toolkit，但实际上包含各种有用的指导，无论您使用哪种框架。

希望有帮助。

# php - PHP生成XML，随机超时

> ID：211800
> 
> 赞同：2
> 
> 时间：2008-10-17T11:29:15.267
> 
> 标签：php, xml

我不知道。这会导致看似随机的超时。这些反过来会破坏我正在加载它的闪存。有没有人见过这样的事情？

```
<?php
require_once("../includes/class.database.php");
require_once("../includes/dbConnectInfo.inc");
require_once("../includes/functions.php");

include("../includes/conn.php");

$cat = $_GET['category'];
$result = mysql_query("SELECT * FROM media WHERE related_page_id=4 && type='copy' ORDER BY id ASC LIMIT 6");

$media = "<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n";
$media .= "<content>\n";
while($row = mysql_fetch_array($result)) {
    $media .="<member>\n";
    $body = $row[copy];

    if($row[title] == "") {
        $media .= "<title><![CDATA[";
        $media .= "Team";
        $media .="]]></title>\n";
    } elseif ($row['path']=="") {
        $name = explode("/",$row[title],2);

        $media .= "<name><![CDATA[";
        $media .= $name[0];
        $media .="]]></name>\n";

        $media .= "<job><![CDATA[";
        $media .= $name[1];
        $media .="]]></job>\n";
    } 

    if($body !="") {
        $media .="<bio><![CDATA[";
        $media .= $body;
        $media .= "]]></bio>\n";
    }

    $something = $row['id'];
    $result1 = mysql_query("SELECT * FROM media WHERE assets='$something'");
    $media .= "<images>";
    while($row1 = mysql_fetch_array($result1)) {
        $img = explode("/",$row1[path],2);
        $media .= "<image url='$img[1]' />";
    }
    $media .= "</images>\n";
    $media .="</member>\n";
}   
$media .= "</content>";
echo $media;
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T11:31:35.307

如果添加`set_time_limit(0);`到代码中会发生什么？我通常将该行添加到包含语句下方的长时间执行代码中。

既然这行得通，让我详细说明一下。

默认情况下，PHP 脚本设置为只执行这么长时间。我相信安装 PHP 时的限制是 30 秒，但这可以在 php.ini 文件中更改。但是，您可能不想让所有脚本运行相同的时间长度 - 对于大多数脚本来说，30 秒可能就可以了。该`set_time_limit`功能允许您设置一个脚本的执行时间。它需要一个整数值，表示运行脚本的秒数，但值为 0 表示脚本将永远运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T11:41:41.573

PHP 的默认超时为 30 秒。如果该代码需要 30 秒，那么我认为您遇到了一些问题！您是否在媒体表上有索引（一个跨`related_page_id`+`type`和一个`assets`应该这样做）。

增加时间限制更像是隐藏问题而不是解决问题，我绝对不会使用`set_time_limit(0);`. 你想要某种合理的最大值，无论是一分钟、一小时、一天还是其他什么，这取决于你的需要。

# cvs - 有没有办法从命令行获得简短的 CVS 状态？

> ID：211819
> 
> 赞同：27
> 
> 时间：2008-10-17T11:37:13.550
> 
> 标签：cvs

执行 a 时`cvs update`，您会得到一个很好的存储库状态摘要，例如：

```
M src/file1.txt
M src/file2.txt
C src/file3.txt
A src/file4.txt
? src/file5.txt 
```

有没有办法在不实际更新的情况下获得这个？我知道有`cvs status`，但这是冗长的方式：

```
===================================================================
File: file6.txt        Status: Up-to-date

Working revision:    1.2
Repository revision: 1.2     /var/cvs/cvsroot/file6.txt,v
Sticky Tag:          (none)
Sticky Date:         (none)
Sticky Options:      (none) 
```

我当然可以编写一个脚本来完成从后者到前者的转换，但这似乎是在浪费时间，因为 cvs 显然可以生成前者。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-17T11:40:44.977

您可以使用 -n 标志来获取更新输出，而无需实际更新文件。您还可以添加 -q（安静）来禁止任何服务器消息。

```
cvs -q -n update 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T12:17:35.200

@jmcnamara：好提示！

一直以来，我一直在使用这个 bash 脚本：

```
cvs -q status "$@" | grep '^[?F]' | grep -v 'Up-to-date' 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-21T13:20:42.150

我有一些别名，可能对某人有用：

```
alias cvsstatus_command='cvs -q status | grep "^[?F]" | grep -v "Up-to-date" | \
    grep -v "\.so" | grep -v "\.[c]*project"'

alias cvsstatus_color='nawk '"'"'BEGIN \
    { \
        arr["Needs Merge"] = "0;31"; \
        arr["Needs Patch"] = "1;31"; \
        arr["conflicts"] = "1;33"; \
        arr["Locally Modified"] = "0;33"; \
        arr["Locally Added"] = "0;32" \
    } \
    { \
        l = $0; \
        for (pattern in arr) { \
            gsub(".*" pattern ".*", "\033[" arr[pattern] "m&\033[0m", l); \
        } \
        print l; \
    }'"'"

alias cvsstatus='cvsstatus_command | cvsstatus_color' 
```

这将仅显示文件名及其状态，忽略所有最新文件，删除所有 eclipse 项目文件和共享对象，并且还将**根据状态以不同颜色打印行**（例如，我在本地使用橙色已修改；红色表示文件，需要合并；绿色表示本地添加等）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T23:25:37.967

如果您使用的是 CVSNT，您也可以这样做`cvs status -q`，这也将产生比常规状态命令更简短的输出（每个文件也只有一行）。使用更新的版本，您甚至`cvs status -qq`可以跳过最新文件。

# asp.net - Donut 缓存是否与 ASP.NET MVC 一起正常工作？

> ID：211827
> 
> 赞同：10
> 
> 时间：2008-10-17T11:43:03.240
> 
> 标签：asp.net, asp.net-mvc, caching

通过甜甜圈缓存，我指的是[Scott Guthrie 的博客文章](http://weblogs.asp.net/scottgu/archive/2006/11/28/tip-trick-implement-donut-caching-with-the-asp-net-2-0-output-cache-substitution-feature.aspx)，这很棒。

有谁知道这是否正常工作？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-04-14T14:55:56.870

请注意，从 MVC 2.0 开始，此技术不再适用。这太糟糕了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-09T10:14:31.917

[来自另一个问题](https://stackoverflow.com/questions/4685906/is-donut-caching-available-in-asp-net-mvc-3/6994582#6994582)的交叉帖子：

甜甜圈缓存（是的，真实的东西）可作为 MVC 的“速度库”的一部分：[Moth](https://github.com/janjongboom/Moth)。适用于 ASP.NET MVC 2 和 MVC 3。

文档位于[wiki](https://github.com/janjongboom/Moth/wiki/Server-side-caching)中，示例位于[Mvc3.Demo](https://github.com/janjongboom/Moth/blob/master/Mvc3.Demo/Views/Home/OutputCaching.cshtml)文件夹中

# c++ - 用于 C++ 应用程序的 Perl/Tk GUI

> ID：211830
> 
> 赞同：5
> 
> 时间：2008-10-17T11:44:28.947
> 
> 标签：c++, perl, perltk

我必须使用需要 GUI 的 C++ 做一个大学项目。我想为 GUI 使用 Perl/Tk，但我不确定如何将 C++ 链接到 Perl。该项目需要能够来回传递变量。任何人都可以为我指出一些好的教程/书籍来链接两者的方向，或者关于我应该如何解决这个问题的任何想法，因为我以前从来没有链接过两种语言。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T11:52:15.717

我[正在](http://www.perlfoundation.org/leon_timmermans_embedding_perl_into_c_applications)开发一个[库](http://code.google.com/p/libperl/)以使其尽可能简单，但它仍然是 alpha 版本。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T12:12:14.850

你也可以试试[swig](http://www.swig.org)。它是一种从 C/C++ 生成多种脚本语言接口的工具。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-17T15:30:29.460

由于 Perl 将提供 GUI，我将 C++ 代码嵌入到 Perl 中。假设将有大量 C++ 代码，我会将其放入库中。将该库链接到 Perl 的传统方法是使用 XS 创建一个 Perl 模块。[编写 XSUB](http://perldoc.perl.org/perlxstut.html)和[XS 语言参考手册](http://perldoc.perl.org/perlxs.html)的教程将对此有所帮助。

一种更简单的方法可能是使用[Inline](http://search.cpan.org/perldoc?Inline)模块。我以前使用过[Inline::C](http://search.cpan.org/perldoc?Inline::C)，效果很好，但我从未尝试过[Inline::CPP](http://search.cpan.org/perldoc?Inline::CPP)（C++ 版本）。我看到它有[不同的评论](http://cpanratings.perl.org/dist/Inline-CPP)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T19:03:26.847

如果我正在解决这个问题，我将使用 TCL/TK 创建一个 GUI，然后在 C/C++ 中构建一个可以从 TCL/TK 调用的 TCL 扩展。这是 TCL/TK 真正擅长的事情之一（其他动态语言也可以做到这一点，但我喜欢 TCL/TK）。您使用 C++ 位创建共享库（Unix 上的 .so 或 Windows 上的 .dll），并在加载库时将它们作为命令导入 TCL。

已经提到过的 Swig 是一个帮助自动化包装过程的工具，它可以获取您的 C++ 代码并创建一个包装器，允许将其加载到多种语言中，例如 TCL、Perl、Python、Ruby ......

[从http://www.tcl.tk/](http://www.tcl.tk/)开始，了解 TCL 和 TK 的大量信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T15:50:21.837

如果它是一个小项目，花大量时间让两种语言交谈可能不值得投资。您可能会考虑使用更合适的工具。C# 与 C++ 对话的痛苦要少得多。

# wpf - 数据绑定失败 - 帮助我从简单示例开始

> ID：211834
> 
> 赞同：1
> 
> 时间：2008-10-17T11:47:38.333
> 
> 标签：wpf, data-binding

好的...我是一个 VB.NET WinForms 人，试图了解 WPF 及其所有精彩。我正在编写一个基本的应用程序作为学习经验，并且一直在阅读大量信息并观看教程视频，但是我无法通过简单的 DataBinding 起步，而且我知道我缺少一些基本概念。尽管我很喜欢它，但我没有那个“啊哈！” 审查源代码的那一刻。

所以...在我的 Window 类中，我定义了一个自定义字符串属性。当我进入 Blend 时，我尝试将我的 TextBox 的文本数据绑定到这个属性，但我的属性在 Blend 中没有显示为可用于绑定的东西。

有人可以告诉我我需要在下面的代码/XAML 中添加什么……最重要的是为什么？

我的 XAML：

```
<Window x:Class="Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <Grid>
        <TextBox Text="How do I Bind my SomeText property here?"></TextBox>
    </Grid>
</Window> 
```

我的窗口代码：

```
Class Window1 

    Private _sometext As String = "Hello World"

    Public Property SomeText() As String
        Get
            Return _sometext
        End Get
        Set(ByVal value As String)
            _sometext = value
        End Set
    End Property

End Class 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T12:52:02.757

这是您需要更改 XAML 的方法（代码很好）。

```
<Window x:Class="Window1"    
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"    
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"    
            Title="Window1" Height="300" Width="300" 
            DataContext="{Binding RelativeSource={RelativeSource Self}}">    
      <Grid>        
          <TextBox Text="{Binding SomeText}">
          </TextBox>    
      </Grid>
    </Window> 
```

要了解 WPF 中的绑定，您需要了解 DataContext。每个元素都有一个 DataContext 属性，并且您放入该属性中的任何对象都将成为任何未指定显式数据源的绑定的数据源。DataContext 的值是从父对象继承的（因此在这种情况下，TextBox 继承了 Grid 的 DataContext，后者继承了 Window 的 DataContext）。既然要引用窗口的某个属性，就需要设置DataContext指向Window实例，这就是我在Window的DataContext属性中所做的。

您还可以使用 {Binding } 元素中的 Source= 或 RelativeSource= 语法更改单个绑定的数据源。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T13:01:47.543

对于数据绑定，考虑以下几点很有帮助：

1.  源对象
2.  目标对象（必须是 DependencyObject）
3.  源属性（源对象上参与绑定的属性）
4.  目标属性（必须是依赖属性）

在您的示例代码中：

1.  源对象 = Window1
2.  目标对象 = 文本框
3.  源属性 = SomeText 属性
4.  目标属性 = 文本

Binding 标记扩展位于 Target 对象的 Target 属性上。

这是说明上述情况的图片：

![替代文字](https://farm4.static.flickr.com/3193/2949579676_4a98851949_o.png)

查看以下代码（解决此问题的一种方法）：

```
<Window
    x:Class="WpfApplication2.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    x:Name="theWindow"
    Title="Window1"
    Height="300"
    Width="300"
>
    <Grid>
        <StackPanel>
            <TextBox Text="{Binding ElementName=theWindow, Path=SomeText}"/>
            <Button
                Width="100"
                Height="25"
                Content="Change Text"
                Click="Button_Click"
            />
        </StackPanel>
    </Grid>
</Window> 
```

在 Binding 标记扩展中，我使用 ElementName ... 定义了源，它允许您使用可视树中的另一个元素作为源。这样做时，我还必须使用 x:Name 属性为窗口命名。

有几种方法可以使用 Binding 定义源（即 Source、ElementName、DataContext）... ElementName 只是一种方法。

需要注意的一点是 Source 属性不必是 Dependency Property，但如果不是，那么 Target 属性将不会更新......没有一些特殊帮助。查看以下代码（我很抱歉它是 C#，这对我来说更快）。在其中你会看到我实现了 INotifyPropertyChanged。这允许源对象说某事发生了变化......并且数据绑定足够智能以观察它。因此，如果您单击按钮（来自此处的示例代码），它将更新 TextBox。如果不实现此接口（并且如果您单击按钮），TextBox 将不会更新。

我希望这会有所帮助。

```
/// <summary>
/// Interaction logic for Window1.xaml
/// </summary>
public partial class Window1 : Window, INotifyPropertyChanged
{
    public Window1()
    {
        InitializeComponent();
    }

    private string _someText = "Hello World!";
    public string SomeText
    {
        get { return _someText; }
        set
        {
            _someText = value;
            OnNotifyPropertyChanged("SomeText");
        }
    }

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;
    private void OnNotifyPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }

    #endregion

    private void Button_Click(object sender, RoutedEventArgs e)
    {
        this.SomeText = "Goodbye World!";
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T13:02:05.360

WPF DataBinding 是一个非常强大的功能。我建议阅读网络上已有的一些文章，例如

*   [Windows Presentation Foundation 数据绑定：第 1 部分](http://msdn.microsoft.com/en-us/library/aa480224.aspx)
*   [Windows Presentation Foundation 数据绑定：第 2 部分](http://msdn.microsoft.com/en-us/library/aa480226.aspx)
*   [数据绑定概述](http://msdn.microsoft.com/en-us/library/ms752347.aspx)

[Beatrix Costa 关于数据绑定的博客对](http://www.beacosta.com/blog/)我也很有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T14:26:33.780

与 CLR 属性的数据绑定需要一个额外的步骤。您必须实现 INotifyPropertyChanged 并在 CLR 属性更改时触发 PropertyChanged 事件。这不会使它出现在 Blend 中，但您可以使用 Text="{Binding SomeText}" 绑定到属性并将窗口的 DataContext 设置为您的对象。

有一个替代方案。不要使用 .NET 数据绑定，而是考虑[更新控件 .NET](http://codeplex.com/updatecontrols)。它是一个替代数据绑定的开源项目，不需要 INotifyPropertyChanged。Update Controls 的伟大之处在于它可以看穿中间业务逻辑。使用 INotifyPropertyChanged，您必须捕获并重新触发事件。

# visual-studio - “解决方案的源代码管理之间似乎存在差异......”

> ID：211839
> 
> 赞同：9
> 
> 时间：2008-10-17T11:48:54.663
> 
> 标签：visual-studio, tfs, version-control, visual-studio-2005

我们在 Visual Studio 2005 和 TFS 中经常遇到此错误。

任何人都可以帮助我们查明此消息的原因吗？

完整的信息是：

> 解决方案关于某些项目的源代码控制信息与项目文件中的信息之间似乎存在差异。
> 
> 要解决此差异，有必要检出项目文件并更新它们。但是，如果签出失败，并且解决方案在未保存的情况下关闭，您将在下次打开解决方案时再次看到此警告。

单击“确定”最终会导致一个结帐框，它要在其中签出整个项目文件列表。但是，“更改源代码控制”窗口没有显示任何错误，并且保存所有内容并重新检查它最终会显示为“没有更改，撤消所有内容”类型的消息。

**编辑：**你说得对，[@Adam](https://stackoverflow.com/users/2915/adam-davis)，我们已经从 VSS 转换了，但是当我们前一段时间这样做时，我们经历了这样一个程序来清理绑定，一切都很顺利。该错误最近开始出现。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T11:58:03.507

听起来您将项目从 VSS 移动到 TFS，并且原始解决方案文件仍绑定到 VSS - 您需要将其重新绑定到 TFS。

[以下是](http://blogs.msdn.com/nagendra/archive/2005/09/30/475633.aspx)解决此问题所需执行的步骤。我会在这里摘录一段，但它似乎取决于几个因素，而且并非微不足道。

或者，这是一个涉及[项目绑定/解除绑定](http://social.msdn.microsoft.com/forums/en-US/tfsversioncontrol/thread/a9a34296-cae2-4c34-949a-5b40c7f74c7e)的线程，如果上述内容不适用，则可能适用。

-亚当

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T15:30:20.757

我们有 2 个解决方案和数百个项目。

我从 VS 2008 SP1 迁移到 VS 2010 SP1 并且也收到错误：

解决方案的源代码控制信息之间似乎存在差异。. .

我会打开解决方案1，允许它更新项目，然后打开解决方案2，只是再次出现此错误。

我分析了解决方案文件，发现以下内容：

根本原因：

关于项目源代码管理绑定，solution1.sln 和 solution2.sln 文件彼此不一致。

例子：

解决方案1.sln

```
SccProjectUniqueName6 = Project1\\Project1.csproj
SccProjectName6 = \u0022$/Project1\u0022,\u0020HSBAAAAA
SccLocalPath6 = Project1 
```

解决方案2.sln

```
SccProjectUniqueName6 = Project1\\Project1.csproj
SccLocalPath6 = .
SccProjectFilePathRelativizedFromConnection6 = Project1\\ 
```

解决方案：

我通过手动修改解决方案文件以在记事本中保持一致来解决此问题。我将源代码控制信息从 solution1.sln 复制并粘贴到 solution2.sln 中，用于他们共同的项目。

我最终编写了一个小实用程序来自动执行此操作。

[https://github.com/bentoo/MergeSolutionSourceControl](https://github.com/bentoo/MergeSolutionSourceControl)

# eclipse - Eclipse 有没有好的 JSP 编辑器？

> ID：211841
> 
> 赞同：93
> 
> 时间：2008-10-17T11:49:52.913
> 
> 标签：eclipse, jsp, editor, eclipse-plugin

我需要一个不错的 Eclipse JSP 编辑器插件。我的选择是什么？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2010-11-03T18:15:52.283

我在这个答案中遵循了 Simon Gibbs 的建议，发现效果很好 - 如果您赶时间，Eclipse 更新站点中的“网页编辑器（可选）”包可以解决问题。

对于 Eclipse 挑战（我）帮助 > 安装新软件 > 使用 > 展开 Web、XML 和 Java EE 开发 > 选择“网页编辑器（可选）”和“下一步”完成。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2008-10-17T11:57:03.010

除了 Amateras，您还可以尝试[Web Tools Project](http://www.eclipse.org/webtools/)或[Aptana](http://www.aptana.com/)。尽管它们都将为您提供不仅仅是 jsp 编辑器的方式。

**编辑 2010/10/26（来自[Simon Gibbs](https://stackoverflow.com/users/13935/simon-gibbs)的评论）：**

Web Tools Project JSP 编辑器位于“Web Page Editor (Optional)”项目中。

**编辑 2016/08/16（来自[Dan Carter](https://stackoverflow.com/users/692626/dan-carter)的扩展评论）：**

从 Kepler (Eclipse 4.3.x) 开始，这被称为“JSF 工具 - 网页编辑器”。

[![蚀](https://i.imgur.com/7hT1LOl.png)](https://i.imgur.com/7hT1LOl.png)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-12-04T14:59:05.150

来自 Eclipse Galileo/Helios 更新站点的“网页编辑器（可选）”包在 JSP 编辑器中具有以下非常小的怪癖：

*   Java 代码片段中的自动注释不起作用（Ctrl /）；[在 Helios SR2 中修复]
*   [存在于 Galileo 中，在 Eclipse Helios SR1 中已修复] 如果 Java 代码片段存在已修复的错误，则编辑器不会删除错误标记，直到您修改错误位置或关闭/重新打开正在编辑的文件；

这在 2010 年 12 月 7 日有效。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T11:59:06.517

您可以查看 JBoss Tools 插件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T11:50:17.283

看看这个，它是开源的[http://amateras.sourceforge.jp/cgi-bin/fswiki_en/wiki.cgi?page=EclipseHTMLEditor](http://amateras.sourceforge.jp/cgi-bin/fswiki_en/wiki.cgi?page=EclipseHTMLEditor)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-17T12:03:51.747

[MyEclipse](http://www.myeclipseide.com/)有一个相当不错的，但是它要花钱。我选择 Netbeans 的原因之一是他们的 JSP 编辑器，它仍然远非完美，但比普通的 Eclipse 更好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-19T19:47:16.627

Bravo JSP 编辑器（无法评论它有多好，我没有尝试过） [http://marketplace.eclipse.org/content/bravo-jsp-editor](http://marketplace.eclipse.org/content/bravo-jsp-editor)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-26T12:07:18.743

我在部署的文件上使用[webstorm](http://www.jetbrains.com/webstorm/)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-17T12:01:19.617

[Oracle Workshop for Weblogic](http://www.oracle.com/technology/products/workshop/index.html)应该有一个相当不错的 jsp 编辑器，但我从未使用过它。您无需使用 Weblogic 即可使用它。

# regex - 为什么人们使用正则表达式进行电子邮件和其他复杂的验证？

> ID：211842
> 
> 赞同：13
> 
> 时间：2008-10-17T11:50:17.110
> 
> 标签：regex, validation, email, parsing

这里弹出[了](https://stackoverflow.com/questions/201323/what-is-the-best-regular-expression-for-validating-email-addresses)许多[电子邮件](https://stackoverflow.com/questions/156430/regexp-recognition-of-email-address-hard)正则表达式[问题](https://stackoverflow.com/questions/210945/what-would-be-a-globally-accepted-regular-expression-to-match-e-mail-addresses)，老实说，我很困惑为什么人们使用这些[疯狂钝](https://stackoverflow.com/questions/156430/regexp-recognition-of-email-address-hard#156469)的匹配表达式，而不是一个非常简单的解析器，它将电子邮件分成名称和域标记，然后验证那些反对名称允许的有效字符（无法对此部分进行进一步检查）和域的有效字符（我想您可以添加对世界上所有 TLD 的检查，然后为国家/地区添加另一级别的二级域与此类（即，com.uk））。

真正的问题是 tlds 和 slds 不断变化（与普遍的看法相反），因此如果您计划在根名称服务器发送更改时进行所有这些高级检查，则必须不断更新正则表达式。

为什么不拥有一个简单地验证域的模块，该模块从数据库或平面文件中提取，并可选择检查 DNS 是否匹配记录？

我在这里是认真的，为什么每个人都如此热衷于为此发明完美的正则表达式？这似乎不是解决问题的合适方法......

让我相信，它不仅可以在 regexp 中进行（并满足所有人），而且它是比自定义解析器/验证器更好的解决方案。

-亚当

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-17T11:58:32.150

他们这样做是因为他们看到“我想测试此文本是否符合规范”并立即认为“我知道，我将使用正则表达式！” 没有完全理解规范的复杂性或正则表达式的局限性。正则表达式是处理各种文本匹配任务的出色而强大的工具，但它们并不是所有此类任务的完美工具，而且似乎许多使用它们的人忽略了这一事实。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-17T11:55:37.707

捕获大多数（但不是全部）常见错误的正则表达式相对容易设置和部署。编写自定义解析器需要更长的时间。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-17T13:23:47.483

The temptation of using RegExp, once you've mastered the basics, is very big. In fact, RegExp seems so powerful that people naturally want to start using it everywhere. I really suspect that there's a lot of psychology involved here, as demonstrated by Randall's [XKCD comic](http://xkcd.com/208/) (and yes, it *is* useful).

I've done an introductory presentation on RegExp once and the most important slide warned against its overuse. It was the only slide that used **bold** font. I believe this should be done more often.

![Everybody stand back!](https://imgs.xkcd.com/comics/regular_expressions.png)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-17T11:59:28.340

对此使用正则表达式*不是*一个好主意，正如其他帖子中详细说明的那样。

我想人们继续这样做是因为他们不知道更好或不在乎。

Will a parser be any better? Maybe, maybe not.

I maintain that sending a verification e-mail is the best way to validate it. If you want to check anything from JavaScript, then check that it has an '@' sign in there and something before and after it. If you go any stricter than that, you risc running up against some syntax you didn't know about and your validator will become overly restrictive.

Also, be careful with that TLD validation scheme of yours, you might find that you are [assuming too much](http://www.bizreport.com/2008/07/icann_anything_is_the_next_domain_craze.html) about what is allowed in a TLD.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-17T12:43:06.257

People do it because in most languages it is way easier to write regexp than to write and use a parser in your code (or so it seems, at least).

If you decide to eschew regexes, you will have to either write parsers by hand, or you resort to external tools (like yacc) for lexer/parser generation. This is way more complex than single-line regex match.

One need to have a library that makes it easy to write parsers directly in the language X (where 'X' is C, C++, C#, Java) to be able to build custom parsers with the same ease as regular expression matchers.

Such libraries originated in the functional land (Haskell and ML), but nowadays "parser combinators libraries" exist for Java, C++, C#, Scala and other mainstream languages.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-17T13:15:04.960

People use regexes for email addresses, HTML, XML, etc. because:

1.  It *looks* like they should work and they often *do* work for the obvious cases.
2.  They "know" regular expressions. When all you have is a hammer all your problems look like nails.
3.  Writing a parser is harder (or seems harder) than writing a regular expression. In particular, writing a parser is harder than writing a regex that handles the obvious cases in #1.
4.  They don't understand the full complexity of the task.
5.  They don't understand the limitations of regular expressions.
6.  They start with a regex that handles the obvious cases and then try to extend it to handle others. They get locked into one approach.
7.  They aren't aware that there's (probably) a library available to do the work for them.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-17T13:51:34.870

> and then validates those against the valid characters allowed for name (there's no further check that can be done on this portion)

This is not true. For example, "ben..doom@gmail.com" contains only valid characters in the name section, but is not valid.

In languages that do not have libraries for email validation, I generally use regex becasue

1.  I know regex, and find it easy to use
2.  I have many friends who know regex, and I can collaborate with
3.  It's fast for me to code, and me-time is more expensive than processor-time for most applications
4.  For the majority of email addresses, it works.

I'm sure many built-in libraries do use your approach, and if you want to cover all the possibilities, it does get ridiculous. However, so does your parser. The formal spec for email addresses is absurdly complex. So, we use a regex that gets close enough.

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-26T16:53:55.903

I don't believe correct email validation can be done with a single regular expression (now there's a challenge!). One of the issues is that comments can be nested to an arbitrary depth in both the local part and the domain.

If you want to validate an address against RFCs 5322 and 5321 (the current standards) then you'll need a procedural function to do so.

Fortunately, this is a commodity problem. Everybody wants the same result: RFC compliance. There's no need for anybody to write this code ever again once it's been solved by an open source function.

Check out some of the alternatives here: [http://www.dominicsayers.com/isemail/](http://www.dominicsayers.com/isemail/)

If you know of another function that I can add to the head-to-head, let me know.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-21T23:17:11.037

We're just looking for a fast way to see if the email address is valid so that we can warn the user they have made a mistake or prevent people from entering junk easily. Going off to the mail server and fingering it is slow and unreliable. The only real way to be sure is to get a confirmation email, but the problem is only to give a fast response to the user before the confirmation process takes place. That's why it's not so important to be strictly compliant. Anyway, it's a challenge and it's fun.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-17T12:07:38.527

People write regular expressions because most developers like so solve a simple problem in the most "cool" en "efficient" way (which means that it should be as unreadable as possible).

In Java, there are libraries to check if a String represents an email address without you having to know anything about regular expressions. These libraries should be available for other languages aswel.

Like Jamie Zawinski said in 1997: "Some people, when confronted with a problem, think "I know, I'll use regular expressions." Now they have two problems."

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-21T23:24:24.980

On factor: the set of people who understand how to write a regular expression is very much larger than the set of people who understand the formal constraints on regular languages. Same goes for non-regular "regular expressions".

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2008-10-17T11:51:46.203

当然，正则表达式使用起来要快得多，而且它们只验证 RFC 中指定的内容。编写自定义解析器？什么？使用正则表达式需要 10 秒。

# c# - 从字符串映射枚举

> ID：211875
> 
> 赞同：27
> 
> 时间：2008-10-17T12:02:13.310
> 
> 标签：c#, linq-to-sql

我在数据库表中有一个字符串列，它映射到代码中的枚举。在我的 dbml 文件中，当我将“类型”设置为时出现`MyTypes.EnumType`以下错误：

> 错误 1 ​​DBML1005：不支持 DbType 'VarChar(50) NOT NULL' 和类型 'Table1' 的列 'EnumCol' 中的类型 'MyTypes.EnumType' 之间的映射。

这个问题： [LINQ to SQL strings to enums](https://stackoverflow.com/questions/4939/linq-to-sql-strings-to-enums) 表明我正在尝试做的事情是可能的，但它是如何完成的？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-17T12:09:33.560

好奇 - 它应该可以工作 IIRC；我会看看我是否可以做一个简单的例子 - 但是，您可能想要检查您是否拥有完全限定的枚举名称（即包括命名空间）。

[更新] 从[这里](http://blog.rolpdog.com/2007/07/linq-to-sql-enum-mapping.html)看来，RTM 版本在解决枚举时出现了错误。建议的一种解决方法（在该页面上）是添加`global::`前缀。如果没有这种解决方法，它对我来说很好，所以它可能在 3.5 SP1 中修复了？如果枚举位于同一命名空间中，则如果您使用非限定名称，则据称它在 3.5 中也可以正常工作。

[示例] 是的，工作正常：使用 Northwind，我为运输国家定义了一个枚举：

```
namespace Foo.Bar
{
    public enum MyEnum
    {
        France,
        Belgium,
        Brazil,
        Switzerland
    }
} 
```

然后我将 dbml 编辑为：

```
<Column Name="ShipCountry" Type="Foo.Bar.MyEnum" DbType="NVarChar(15)" CanBeNull="true" /> 
```

这产生了：

```
private Foo.Bar.MyEnum _ShipCountry;
//...
[Column(Storage="_ShipCountry", DbType="NVarChar(15)", CanBeNull=true)]
public Foo.Bar.MyEnum ShipCountry
{ get {...} set {...} } 
```

最后写了一个查询：

```
using (DataClasses1DataContext ctx = new DataClasses1DataContext())
{
    var qry = from order in ctx.Orders
              where order.ShipCountry == Foo.Bar.MyEnum.Brazil
                || order.ShipCountry == Foo.Bar.MyEnum.Belgium
              select order;
    foreach (var order in qry.Take(10))
    {
        Console.WriteLine("{0}, {1}", order.OrderID, order.ShipCountry);
    }
} 
```

工作正常；结果：

```
10250, Brazil
10252, Belgium
10253, Brazil
10256, Brazil
10261, Brazil
10287, Brazil
10290, Brazil
10291, Brazil
10292, Brazil
10299, Brazil 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-10-18T03:36:30.577

我知道这已得到解答，但我仍然收到此错误。很奇怪。

无论如何，我找到了解决方案。您需要*使用*`global::`

喜欢WTF？确切地。我知道这听起来很奇怪。这是一个示例屏幕=>

[替代文字 http://img11.imageshack.us/img11/7517/lolzqg.png](http://img11.imageshack.us/img11/7517/lolzqg.png)

太蹩脚了:(

无论如何，我没有弄清楚这一点。[一些叫马特](http://blog.rolpdog.com/2007/07/linq-to-sql-enum-mapping.html)的家伙，做到了。他在 MS Connect 上发布了一个错误报告，他们无法重现它，所以它没有修复，我猜。

无论如何，HTH。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-19T01:13:06.180

如果您添加 global:: quallyfier 并在 Designer.cs 文件中的类型上按 Control + 空格，它会识别该类型并且您可以将其删除。

# php - Is there a PHP function or variable giving the local host name?

> ID：211885
> 
> 赞同：5
> 
> 时间：2008-10-17T12:06:24.270
> 
> 标签：php, hostname

When a script runs under Apache, I insert `$_SERVER['SERVER_NAME']` value into an error reporting e-mail message.

However, if a Web script forks a "worker" job with `nohup php ...`, `$_SERVER['SERVER_NAME']` appears to be empty there. Thus, if an error occurs, it's reported without a host name.

Can I reliably get the host name by means of PHP, without calling Unix `hostname` command?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-17T12:11:26.710

[php_uname("n")](http://uk.php.net/manual/en/function.php-uname.php)

> (PHP 4 >= 4.0.2, PHP 5)
> php_uname — Returns information about the operating system PHP is running on
> 
> php_uname() returns a description of the operating system PHP is running on. This is the same string you see at the very top of the phpinfo() output. For the name of just the operating system, consider using the PHP_OS constant, but keep in mind this constant will contain the operating system PHP was built on.
> 
> On some older UNIX platforms, it may not be able to determine the current OS information in which case it will revert to displaying the OS PHP was built on. This will only happen if your uname() library call either doesn't exist or doesn't work.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-17T20:54:52.693

For [PHP >= 5.3.0 use this](http://www.php.net/manual/en/function.gethostname.php):

`$hostname = gethostname();`

For [PHP < 5.3.0 but >= 4.2.0 use this](http://www.php.net/manual/en/function.php-uname.php):

`$hostname = php_uname('n');`

For PHP < 4.2.0 you can try one of these:

```
$hostname = getenv('HOSTNAME'); 
$hostname = trim(`hostname`); 
$hostname = preg_replace('#^\w+\s+(\w+).*$#', '$1', exec('uname -a')); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-19T13:17:36.560

You can use `_GLOBALS['MACHINENAME']` to obtain the information straight from the `globals` `array`.

# outlook - Thunderbird Lightning 上的共享日历

> ID：211888
> 
> 赞同：1
> 
> 时间：2008-10-17T12:07:02.600
> 
> 标签：outlook, scheduling, thunderbird, thunderbird-lightning

我想为中型企业的日历设置一个开源解决方案。我们将从 Thunderbird（闪电插件）、Microsoft Outlook 中使用它。我想查看其他人的空闲/忙碌日程安排，邀请他们参加会议等。

如果我能有一个用于会议室、投影仪等资源的日历，那就太好了。

我在网上搜索了很多，但没有找到合适的解决方案，也没有任何关于如何设置的详细说明。由于这在组织中非常需要，我相信您可能已经设置了它。如果您能为我提供任何详细（分步）文档的指针，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T12:13:06.050

我不确定它是否正是您需要的，但我喜欢 Google 日历。

最好的事情是你不需要设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T12:12:20.343

[Open Exchange](http://www.open-xchange.com/)执行此操作。查找社区版，并查看社区版常见问题解答，了解如何将 Thunderbird 和其他日历与 WebDav 发布者联系起来。

-亚当

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T13:13:07.410

我第二个[谷歌日历](http://www.google.com/calendar/)- 它是免费的，易于设置，并允许在许多国家/地区进行免费的会议短信通知，尽管在某些国家/地区，[网络运营商可能会](http://www.google.com/support/calendar/bin/answer.py?hl=en&answer=37173)收取接收消息的费用。

> Google 日历是免费产品，Google 不会向您收取通知费用。请记住，如果您在美国或加拿大，您的移动服务提供商接收短信的标准费率可能适用。

还有许多免费工具可用于将其与您现有的邮件客户端集成：

*   [雷鸟插件](https://addons.mozilla.org/en-US/thunderbird/addon/4631)

*   [MS Outlook 集成](http://my.opera.com/sean.orear/blog/show.dml/274414)说明

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-09T15:34:38.790

我创建了名为“会议室”、“投影仪”和“假期”之类的 Outlook 类别，并编写了一个快速而肮脏的客户端/服务器程序来将这些共享类别同步到每个客户端......这是很多年前的事了，但我怀疑 Outlook否则仍然不会向您显示每个人的自定义类别。

# performance - 将文档作为 Blob 存储在数据库中 - 有什么缺点吗？

> ID：211895
> 
> 赞同：53
> 
> 时间：2008-10-17T12:09:46.383
> 
> 标签：performance, security, document, blob, document-management

我的文档管理系统的要求是：

1.  必须通过简单复制目录、文件等来防止被盗。
2.  必须防止传统病毒感染（物理文件感染）
3.  必须快速检索
4.  临时（目录）浏览用户等不能看到存储库。

我决定将所有文档（和扫描的图像）作为 blob 存储在数据库中，到目前为止，我的体验非常棒，文档检索也非常快 - 它符合上面的所有标准，甚至还有一些额外的优势，例如自动存储文档及其相关实体，轻松快速地搜索内容，删除围绕文档打开和命名等的各种用户活动等。

我的问题是 - 在这个设计和实现中是否有任何严重的风险或我忽略的事情？

编辑说明：DB 是 PostgreSQL，可以很好地处理 BLOBS 并且可以很好地扩展。环境是多用户的。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-18T15:03:59.950

当您的数据库变得越来越大时，备份将变得越来越困难。恢复包含超过 100 GB 数据的表的备份并不是一件让您高兴的事情。

另一件事是，随着数据集的增长，所有表管理功能都会变得越来越慢。
但这可以通过使您的数据表仅包含 2 个字段来克服：ID 和 BLOB。

检索数据（通过主键）可能只会在您备份数据集遇到困难很久之后才会成为问题。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-10-17T12:16:01.973

我经常听到使用 blob 的主要缺点是，超过一定大小时，文件系统在存储和检索大文件方面效率更高。听起来您已经在您的要求列表中考虑到了这一点。

这里有一个[很好的参考资料 (PDF)](http://arxiv.org/ftp/cs/papers/0701/0701168.pdf)，涵盖了 blob 的优缺点。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-18T15:46:39.300

根据我的经验，一些问题是：

1.  速度与文件系统上的文件。

2.  缓存。IMO Web 服务器将更好地缓存静态内容。数据库也会做得很好，但如果数据库还处理各种其他查询，不要指望那些大文档会长时间缓存。您基本上必须传输文件两次。一次从 DB 到 Web 服务器，然后从 Web 服务器到客户端。

3.  内存限制。在我的上一份工作中，我们在数据库中有一个 40MB 的 PDF，并且在日志文件中不断出现 Java OutOfMemoryErrors。我们最终意识到，由于 Hibernate ORM 中的设置，整个 80MB PDF 不仅被读入堆中一次，而且被读入两次（如果对象是可变的，它会在内存中创建一个副本以供编辑）。将 PDF 流式传输回用户后，堆就被清理了，但是为了流式传输文档而一次从堆中取出 80MB 是一个巨大的打击。了解您的代码以及内存的使用方式！

您的 Web 服务器应该能够处理您的大部分安全问题，但是如果文档很小并且数据库还没有承受很大的负载，那么我认为将它们放在数据库中并没有什么大问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-11-18T19:57:03.590

我刚刚开始研究用于 BLOB 的 SQL Server 2008 的 FILESTREAMing，并且遇到了巨大的限制 (IMO)——它仅适用于集成安全性。如果您不使用 Windows 身份验证连接到数据库服务器，则无法读取/写入 BLOB。许多应用程序环境不能使用 Windows 身份验证。当然不是在异构环境中。

必须存在更好的存储 BLOB 的解决方案。最佳实践是什么？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T12:12:44.630

本文[涵盖](http://research.microsoft.com/research/pubs/view.aspx?msr_tr_id=MSR-TR-2006-45)了大部分问题。如果您使用的是 SQL Server 2008，请查看 Paul Randal[在此处](http://www.sqlskills.com/blogs/paul/post/High-performance-FILESTREAM-tips-and-tricks.aspx)讨论的新 FILESTREAM 类型的使用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-17T12:22:26.873

这取决于数据库类型。甲骨文还是 SQL Server？请注意一个缺点 - 恢复单个文档。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-12T18:50:31.327

根据我在 SQL Server 和 Oracle 中将内容文件存储为 blob 的经验，在小型数据库和少量登录用户的情况下都可以正常工作。ECM 系统将它们分开并使用单独的服务来传输内容。根据文件的大小，服务器资源可能会受到同时检索大文件的影响。由于恢复时间和无法从存档中检索文档，具有大量文件的数据库存档变得有问题。

如果这些文件是公司记录，并且这是记录的权威副本，则您可能会遇到合规性和保留管理问题，尤其是在您归档文件时。此外，搜索和版本控制可能会成为一个巨大的问题。

您可能希望使用某种 API 来研究 ECM 系统，而不是重新发明轮子。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-17T12:17:11.580

抱歉 - 我提供的答案是基于 SQL Server 的，因此维护部分不合适。但是文件 I/O 是在硬件级别完成的，任何数据库都会增加额外的处理步骤。

检索文档时，数据库将施加额外的开销。当文件在磁盘上时，您的速度仅与服务器上的 I/O 一样慢或快。您当然应该在数据库中管理您的元数据，但最终您需要文件的 UNC 并将用户指向源并让开。

从维护和管理的角度来看，在处理 MS SQL Server 时，您将限制自己使用 SAN。Documentum 等解决方案采用不同的方法，在磁盘上进行简单存储，并允许您实施您认为合适的存储解决方案。

**编辑**

让我澄清一下我的说法 - 使用 SQL Server，当您超出盒子的物理存储容量时，您的选择有限。这实际上是 Sharepoint 的一大弱点，您无法简单地附加任何类型的网络存储。

# c# - 如何处理 .NET 下未记录的 API/框架？

> ID：211920
> 
> 赞同：3
> 
> 时间：2008-10-17T12:20:31.060
> 
> 标签：c#, .net, api, documentation, frameworks

为了工作，我必须使用外部公司的 API 编写代码来处理他们专有的数据库解决方案。不幸的是，他们提供的文档更多的是一个示例指南，而不是正确的 API 文档，因此它对错误代码、方法返回和异常等细节非常简单。

例如，一个类将有一个 .GetErrorCode() 方法，但我不知道这些错误编号是什么意思，因为它们没有记录哪个编号与哪个错误匹配。在许多情况下，一个方法将返回一个 Object，但没有文档说明它实际返回的 Object 类型。我一再要求他们提供适当的文件，但他们似乎认为上述细节是保密的。那么，是否有任何工具或方法可以解决我有限或在某些情况下不存在的文档。

请注意，我正在使用 Visual Studo 2005 并在 .Net 下使用 C# 进行编码。

在任何人回答“不要使用 API”之前，我必须这样做，这是为了工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T12:24:57.820

一个糟糕的场景。我不想建议它，但如果没有混淆，也许[反射器是你的朋友。](http://www.red-gate.com/products/reflector/)可能存在一些 IP 问题，但在这种情况下，反转它似乎是找出 API 是什么的唯一可行方法。但是，我怀疑（来自 .GetErrorCode() 之类的方法）这是 P/Invoke 之上的一个 shim - 在这种情况下，即使是反射器也会向您显示许多外部调用......

我可以说的另一件事主要是：编写*大量*单元测试来涵盖您如何尝试使用它……这样，如果您猜错了并且发生了变化，您就会尽早知道。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T12:24:30.287

如果我无法获得代码示例或与原始开发人员交谈，我通常会求助于[Reflector](http://www.red-gate.com/products/reflector/)来查看底层代码。它缓慢且效率低下，但有时这就是您所能做的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T12:33:13.733

这取决于你的情况。如果你为 API 付费，你应该继续向公司施压，要求他们提供更好的关于如何使用 API 的文档。

如果这不起作用，我会做的是在开发时开始我自己的文档。保留笔记本、个人 Wiki（[想到螺丝转 wiki](http://www.screwturn.eu/Default.aspx)）或某种电子文档。正如其他一些人所提到的，您可以使用 Reflector 来帮助获取源代码（如果它没有被混淆）。

创建自己的文档可能不是您想要的，但是如果您无法获得真正的文档，至少在您学习的时候创建一些文档，这样您就可以在未来几个月（或几年）内获得一些指导当您尝试维护使用 API 构建的代码时。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T12:24:04.670

想到的最佳工具包括电话和电子邮件。希望你能继续骚扰那里的人，直到他们给你更多有用的信息...... :(

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T12:24:37.807

使用[Reflector](http://www.red-gate.com/products/reflector/index.htm)查看源代码。应该向您显示 GetErrorCode 消息的枚举。

顺便说一句，Reflector 是宇宙历史上最伟大的程序。

# c++ - 在 C 程序中动态加载外部模块？

> ID：211934
> 
> 赞同：3
> 
> 时间：2008-10-17T12:28:32.790
> 
> 标签：c++, c, dynamic, modularity

我确信这个问题之前已经解决了，我很好奇它是如何完成的。我有代码，在运行时，我想扫描目录的内容并加载功能。

具体来说，我正在使用我希望能够添加函数调用的脚本引擎。我希望核心引擎提供非常有限的功能。用户应该能够通过 3rd 方库添加其他功能，我希望引擎可以扫描并加载这些功能。这是怎么做到的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T12:34:29.097

这取决于平台。在 win32 上，您调用`LoadLibrary`加载一个 DLL，然后使用`GetProcAddress`. 在 Unixy 平台上，等价物是`dlopen`和`dlsym`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T12:35:38.843

您可以使用 Linux/UNIX 中的 POSIX dlopen/dlsym/dlerror/dlclose 函数来动态打开共享库并访问它们提供的符号（包括函数），有关详细信息，请参阅[手册页](http://linux.die.net/man/3/dlopen)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T12:41:30.893

如果您想为此使用库，我推荐 GLib（位于 GTK+ UI 工具包下方的实用程序库）。它具有“ [GModule](http://library.gnome.org/devel/glib/stable/glib-Dynamic-Loading-of-Modules.html) ”子 API，它提供了一种干净、可移植的方式来执行此操作。这使您不必自己包装相关调用，并且还为您带来了 GLib 的其余部分，这对于任何大小的 C 程序都*非常方便。*

# c# - 为单个 Web 应用程序页面注销用户

> ID：211941
> 
> 赞同：0
> 
> 时间：2008-10-17T12:29:22.337
> 
> 标签：c#, asp.net, security, xss

这是我[之前的 XSS 问题](https://stackoverflow.com/questions/205923)的扩展。

假设没有足够强大的正则表达式来保证用户输入的 URL 的 XSS 安全，我正在查看使用重定向。

（虽然如果你有一个，请在另一个问题下添加它）

我们有用户输入的网址，所以：

> stackoverflow.com

他们希望为其他用户显示一个链接，因此：

```
<a href="http://stackoverflow.com">stackoverflow.com</a> 
```

为了降低黑客攻击的风险，我打算使用警告页面，因此链接变为：

```
<a href="leavingSite.aspx?linkid=1234" target="_blank">stackoverflow.com</a> 
```

然后在该页面上会有一条警告消息和一个指向原始链接的普通链接：

```
<a href="javascript:alert('oh noes! xss!');">Following this link at your own risk!</a> 
```

由于我们使用了很多 Ajax，我想让离开站点的页面成为一个有围墙的花园，理想情况下，基本上只在该页面中注销用户。我希望他们在原始页面上保持登录状态。

然后，如果有人确实通过了 santisation Regex，他们将无法以受骗用户的身份访问任何内容。

有人知道怎么做吗？是否可以在不全部注销的情况下注销一个窗口/选项卡？我们支持 IE 和 FX，但理想的解决方案也适用于 Opera/Chrome/Safari。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T12:37:04.583

仅在一个选项卡/窗口中无法将某人注销。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T13:05:10.283

将 cookie 限制在 www.example.com 并在 links.example.com 上拥有转发页面

# lamp - 简单的文档存储库

> ID：211954
> 
> 赞同：17
> 
> 时间：2008-10-17T12:38:37.497
> 
> 标签：lamp, document-management

请向我推荐一个简单的基于 Web 的文档存储库，用于保存我的小型公司文档（.DOC、.PDF），以便我可以从任何地方访问它们。互联网上有很多可用的，但它们很重并且充满了不必要的功能和要求。

我几乎没有什么要求：令人愉快的界面（AJAX 感觉不错）、文件夹或标签、可能是版本控制、可能是 CIFS 安装或批量上传/下载，最好不要用 Java 编写（将无法托管它）。

问候，托多

注意 - 问题提交者正在使用基于 LAMP 的环境。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-17T12:50:43.167

最简单，也可能最容易设置的是 Subversion 存储库，因此您可以从任何地方实际存储、删除、添加和修改文档，然后在其上添加 ViewVC，以便您可以查看不同的文件网络浏览器。

另一个可能的选择是安装 Trac，虽然它有点重量级。同样，它仍然使用 Subversion，但它有一个很好地集成的存储库的 Web 查看器，以及一个 Wiki 功能，允许对更简单的文档进行版本化共享编辑。如果您需要它，Trac 也有一个问题跟踪系统，但如果您不想使用它，则不必使用它。

此外，除了通过 Web 浏览器查看界面外，Subversion 存储库本身还有许多 Linux、Mac 和 Windows 客户端，以允许对文件进行操作。对于 windows，最好的 Subversion Gui 是 TortoiseSVN。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T12:56:30.317

查看 Dropbox：[https](https://www.getdropbox.com/home) ://www.getdropbox.com/home 。多平台（win、mac、nix；可在网络上访问）、免费且执行非常好。编辑：我忘了提到安全。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T12:41:47.677

如果您想要版本控制，您是否考虑过设置一个 subversion（或 CVS 或任何您喜欢的）存储库并同步到它？在这种情况下不需要 Web 界面（尽管您也可以设置 Web 存储库）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T12:55:27.743

最简单的解决方案始终是其他人提供的解决方案，而您只需使用他们的服务即可。[NetDocs 提供文档和其他协作文件的安全在线托管。](http://www.netdocuments.com)

如果您确信自己想在 LAMPP 堆栈上托管解决方案，那么我建议您设置 Subversion。一旦你掌握了它的窍门，它的开源、免费且非常易于使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T12:43:00.233

考虑过 Google Docs，但我更有信心自己托管这个东西。这些文件可能包含敏感信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-17T12:52:22.057

不幸的是，基于 Windows 的解决方案不是我的强项。设置很简单：我办公室的一台 LAMP 服务器具有可公开访问的 IP 地址，以及三台运行 Windows XP 和 OpenOffice 和 MS Office 的笔记本电脑。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-17T13:02:29.227

像wikimedia这样的wiki怎么样

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-17T16:53:49.120

我会查看知识树：[http](http://www.knowledgetree.com/) ://www.knowledgetree.com/ 。这是一个基于网络的文档管理系统。他们有一个免费的社区版。几年前我对此进行了评估，它似乎很适合您的需求。它的版本，允许你强加流程，有用户限制等。另外，它可以被完全不知道源代码控制系统是什么的人使用。

（*我与他们没有任何关系供参考*）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-17T12:39:35.217

[谷歌文档](http://docs.google.com/)

不完全符合您的要求，但非常适合在线创建和共享文档。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-17T12:41:44.090

**SharePoint**怎么样？不够简单？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-17T12:42:23.183

WSS (Windows SharePoint Services) 怎么样，您只需要 SQL Express 和带有外部连接器许可证的 windows，它为您提供所需的所有功能（除了 ajax）...

或者尝试 www.umbraco.org 虽然这有点涉及配置

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-17T12:47:15.263

Windows Sharepoint Services 随 W2k3 一起提供，并具有您正在寻找的功能。

一件非常好的事情是 Windows 资源管理器集成，这样您就可以与文档库进行交互，就好像它们是网络/本地文件夹一样。您没有提及您的服务器基础设施，但您可以使用 AD 权限/组等。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-03T15:18:33.643

[Microsoft Office Live Workspace](http://workspace.officelive.com/)是免费的，并与 office 集成。（我知道，你是一家 LAMP 商店，我只是想我会把选项放在那里。）

> 将您的文档保存到网络上——免费！
> **从任何地方访问文件**
> 
> *   使用 Web 浏览器从几乎任何计算机上查看文档*   不再有闪存驱动器 - 文件随时随地都在您需要的地方*   受密码保护的文档共享；您控制谁查看和编辑*   简化的在线协作；每个人都使用相同的文档
> **使用您熟悉的程序**
> 
> *   在一个在线位置保存 1,000 多个 Microsoft Office 文档*   在一个方便的地方管理文档*   从 Word、Excel 和 PowerPoint 等熟悉的程序打开和保存文件*   将联系人、任务和事件列表与 Outlook 同步

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-08T04:47:55.023

下载[Alfresco](http://www.alfresco.com/)并试一试。它非常适合您的要求。他们有一个多功能的内容存储库和漂亮的基于 Web 的 UI。您还可以选择运行工作流程等。

好吧..社区版是免费的。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-11-22T16:41:36.230

使用 Google Docs 和/或任何其他 Google 服务是非常危险的 - 失去发布和/或共享您的文档的权利是很常见的。似乎存在阻止访问您的文件的错误或黑客行为 - 您需要*请求审查*才能让您的文档重新出现在基于网络的 Google 服务上，并且当 Google 回复时带有 -error- 标签，证明他们有无法控制谁或什么禁止您的文档在网络上查看 - 使用时要格外小心。

# c# - 遍历列表并动态创建摘要行

> ID：211958
> 
> 赞同：2
> 
> 时间：2008-10-17T12:40:41.330
> 
> 标签：c#, loops

**编辑：我错过了一个关键点：.NET 2.0**

考虑一下我有一个未排序项目列表的情况，为了简单起见，如下所示：

```
class TestClass
{
    DateTime SomeTime;
    decimal SomePrice;

    // constructor
} 
```

我需要创建一个类似报告的输出，其中累积了每天的总价格。每个项目应该有一行，后面是适当的摘要行。

拿这个测试数据：

```
List<TestClass> testList = new List<TestClass> { 
new TestClass(new DateTime(2008,01,01), 12),
new TestClass(new DateTime(2007,01,01), 20),
new TestClass(new DateTime(2008,01,01), 18)
}; 
```

所需的输出将是这样的：

```
2007-01-01: 
20
Total: 20

2008-01-01: 
12
18
Total: 30 
```

处理这种情况的最佳方法是什么？对于这样的列表，我将为 TestClass 实现 IComparable 接口，以便可以对列表进行排序。

要创建报告本身，可以使用类似的东西（假设我们有方法来完成诸如累积价格、跟踪当前日期等任务）：

```
for (int i=0;i<testList.Count;i++)
{
    if (IsNewDate(testList[i]))
    {
        CreateSummaryLine();
        ResetValuesForNewDate();
    }

    AddValues(testList[i]);
}

// a final summary line is needed to include the data for the last couple of items.
CreateSummaryLine(); 
```

这行得通，但就第二个“CreateSummaryLines”而言，我有一种奇怪的感觉。

您以什么方式处理这种情况（特别是考虑到这样一个事实，我们需要使用 List<> 项目而不是预先分类的 Dictionary 或类似的东西）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T12:55:41.317

好的，所以如果你不能使用 LINQ：

（我使用 var 来节省空间，但如果需要，它很容易转换为 C# 2.0...）

```
var grouped = new SortedDictionary<DateTime, List<TestClass>>();
foreach (TestClass entry in testList) {
  DateTime date = entry.SomeTime.Date;
  if (!grouped.ContainsKey(date)) {
    grouped[date] = new List<TestClass>();
  }
  grouped[date].Add(entry);
}

foreach (KeyValuePair<DateTime, List<TestClass>> pair in testList) {
  Console.WriteLine("{0}: ", pair.Key);
  Console.WriteLine(BuildSummaryLine(pair.Value));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T12:46:44.890

关键问题：您是否使用 .NET 3.5，从而允许使用 LINQ？如果是这样，您可以按 SomeTime.Date 分组，然后分别处理每个日期。

如果您有大量数据，您可能会发现我的[Push LINQ](http://msmvps.com/blogs/jon_skeet/archive/2008/01/04/quot-push-quot-linq-revisited-next-attempt-at-an-explanation.aspx)项目很有用 - 但否则直接 LINQ to Objects 是您最好的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T12:46:54.813

[编辑] 由于您将 .NET 2.0 与 C# 3.0 一起使用，因此您可以使用[LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx)来启用它。

LINQ；就像是：

```
 var groups = from row in testList
                  group row by row.SomeTime;
        foreach (var group in groups.OrderBy(group => group.Key))
        {
            Console.WriteLine(group.Key);
            foreach(var item in group.OrderBy(item => item.SomePrice))
            {
                Console.WriteLine(item.SomePrice);
            }
            Console.WriteLine("Total" + group.Sum(x=>x.SomePrice));
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T12:46:55.967

您使用的是哪个版本的 C#/.NET？如果您是最新的，请查看 LINQ。这允许对您的数据进行分组。在您的情况下，您可以按日期分组：

```
var days = from test in testList group test by test.SomeTime;
foreach (var day in days) {
    var sum = day.Sum(x => x.SomePrice);
    Report(day, sum);
} 
```

这样，您可以报告每个 的值列表`day`，以及当天的金额。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T12:47:29.337

您想要的输出感觉就像您想要创建一个代表您的摘要数据的数据结构。您想将日期与 TestClass 对象列表配对，然后收集这些对象。您可以使用 HashSet 或 Dictionary 作为集合。

总结一下，pair数据结构可以为你实现ToString。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T13:52:50.733

无论您如何生成报告输出，如果您要在应用程序中定期执行此操作，请考虑组合一个报告接口并为此接口实现类，以便将用于在一个位置创建报告的逻辑本地化，而不是将代码分散到在整个应用程序中创建报告。以我的经验，应用程序通常需要（或不断增长）对多个报告以及最终的多种格式的需求。

**如果您只有一份报告，请在编写第二份报告之前不要担心，**然后开始研究一种更易于扩展和维护的报告架构。

例如（并使用@Marc Gravell 的代码）：

```
public interface IReport
{
   string GetTextReportDocument();
   byte[] GetPDFReportDocument();  // needing this triggers the development of interface
}

public class SalesReport : IReport
{
   public void AddSale( Sale newSale )
   {
       this.Sales.Add(newSale);  // or however you implement it
   }

   public string GetTextReportDocument()
   {
       StringBuilder reportBuilder = new StringBuilder();
       var groups = from row in this.Sales
                    group row by row.SomeTime.Date;
       foreach (var group in groups.OrderBy(group => group.Key))
       {            
          reportBuilder.AppendLine(group.Key);
          foreach(var item in group.OrderBy(item => item.SomePrice))            
          {
             reportBuilder.AppendLine(item.SomePrice);
          }
          reportBuilder.AppendLine("Total" + group.Sum(x=>x.SomePrice));
      }

      return reportBuilder.ToString();
   }

   public byte[] GetPDFReportDocument()
   {
        return PDFReporter.GenerateDocumentFromXML( this.ConvertSalesToXML() );
   } 
```

...其余的留给读者练习...

# oracle - 将 Oracle 集合与瘦 JDBC 结合使用时的全球化问题

> ID：211959
> 
> 赞同：1
> 
> 时间：2008-10-17T12:41:08.473
> 
> 标签：oracle, jdbc, localization, globalization

总结一下这个问题：

1.  当 DB 编码为 Western ISO 8859-2 时，在 Java 1.5 (JDBC) 中检索字符串可以正常工作
2.  当切换到东欧 ISO（例如 ISO 8859-5）时，所有正常的 JDBC 字符串转换都可以工作，**除了那些涉及 Oracle 集合的**转换，例如对象的嵌套表。我得到的不是正确的字符串，甚至是简单的字符串，例如“1”，而是“？？？” （三个问号）代替。

我尝试了以下 10.2.0.4 JDBC Jar 文件，但无济于事：

*   ojdbc14.jar
*   orai18n.jar

我还尝试了 CHAR 和 VARCHAR2 并且两者的行为相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T01:17:06.327

您可能想尝试使用 type `NVARCHAR2`。

该类型更适合非英文字符。

# wpf - 将 WPF Listview 滚动到特定行

> ID：211971
> 
> 赞同：23
> 
> 时间：2008-10-17T12:44:45.410
> 
> 标签：wpf, listview, scroll

WPF，类似浏览器的应用程序。
我有一个包含 ListView 的页面。调用 PageFunction 后，我向 ListView 添加一行，并希望将新行滚动到视图中：

```
 ListViewItem item = ItemContainerGenerator.ContainerFromIndex(index) as ListViewItem;
  if (item != null)
    ScrollIntoView(item); 
```

这行得通。只要新线在视野中，该线就会得到应有的焦点。

问题是，当这条线不可见时，事情就不起作用了。
如果该行不可见，则生成的行没有 ListViewItem，因此 ItemContainerGenerator.ContainerFromIndex 返回 null。

但是没有该项目，我如何将行滚动到视图中？有什么方法可以滚动到最后一行（或任何地方）而不需要 ListViewItem？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-10-23T10:33:10.727

有人告诉我一种更好的滚动到特定行的方法，这很简单，而且效果很好。
简而言之：

```
public void ScrollToLastItem()
{
  lv.SelectedItem = lv.Items.GetItemAt(rows.Count - 1);
  lv.ScrollIntoView(lv.SelectedItem);
  ListViewItem item = lv.ItemContainerGenerator.ContainerFromItem(lv.SelectedItem) as ListViewItem;
  item.Focus();
} 
```

[MSDN 论坛](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/2ce4fee4-fbf6-4c0e-9dc6-49c0ac0c3152/)中的较长版本：

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-17T12:50:30.500

我认为这里的问题是如果该行不可见，则尚未创建 ListViewItem。WPF 按需创建 Visible。

所以在这种情况下，你可能会得到`null`这个项目，是吗？（根据您的评论，您可以）

我[在 MSDN 论坛上找到了一个链接，该链接建议直接访问 Scrollviewer](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/7c5812bd-482f-448c-bc67-02573e48d691)以进行滚动。对我来说，那里提出的解决方案看起来非常像黑客，但你可以自己决定。

[这是上面链接](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/7c5812bd-482f-448c-bc67-02573e48d691)中的代码片段：

```
VirtualizingStackPanel vsp =  
  (VirtualizingStackPanel)typeof(ItemsControl).InvokeMember("_itemsHost",
   BindingFlags.Instance | BindingFlags.GetField | BindingFlags.NonPublic, null, 
   _listView, null);

double scrollHeight = vsp.ScrollOwner.ScrollableHeight;

// itemIndex_ is index of the item which we want to show in the middle of the view
double offset = scrollHeight * itemIndex_ / _listView.Items.Count;

vsp.SetVerticalOffset(offset); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-08-20T11:30:09.230

我对 Sam 的回答做了一些修改。请注意，我想滚动到最后一行。不幸的是， ListView 有时只显示最后一行（即使上面有 100 行），所以这就是我修复的方法：

```
 public void ScrollToLastItem()
    {
        if (_mainViewModel.DisplayedList.Count > 0)
        {
            var listView = myListView;
            listView.SelectedItem = listView.Items.GetItemAt(_mainViewModel.DisplayedList.Count - 1);
            listView.ScrollIntoView(listView.Items[0]);
            listView.ScrollIntoView(listView.SelectedItem);
            //item.Focus();
        }
    } 
```

干杯

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T17:37:29.530

一种解决方法是更改​​ ListView 的 ItemsPanel。默认面板是 VirtualizingStackPanel，它仅在 ListBoxItem 第一次可见时创建。如果您的列表中没有太多项目，那应该不是问题。

```
<ListView>
   ...
   <ListView.ItemsPanel>
      <ItemsPanelTemplate>
         <StackPanel/>
      </ItemsPanelTemplate>
   </ListView.ItemsPanel>
</ListView> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-26T18:08:56.363

感谢山姆的最后提示。我打开了一个对话框，这意味着每次对话框关闭时我的网格都会失去焦点。我用这个：

```
if(currentRow >= 0 && currentRow < lstGrid.Items.Count) {
    lstGrid.SelectedIndex = currentRow;
    lstGrid.ScrollIntoView(lstGrid.SelectedItem);
    if(shouldFocusGrid) {
        ListViewItem item = lstGrid.ItemContainerGenerator.ContainerFromItem(lstGrid.SelectedItem) as ListViewItem;
        item.Focus();
    }
} else if(shouldFocusGrid) {
    lstGrid.Focus();
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-04-09T21:12:04.977

试试这个

```
private void OnSelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            ScrollViewer scrollViewer = GetScrollViewer(lstVw) as ScrollViewer;
            scrollViewer.ScrollToHorizontalOffset(dataRowToFocus.RowIndex);
            if (dataRowToFocus.RowIndex < 2)
                lstVw.ScrollIntoView((Entity)lstVw.Items[0]);
            else
                lstVw.ScrollIntoView(e.AddedItems[0]);
        } 

 public static DependencyObject GetScrollViewer(DependencyObject o)
        {
            if (o is ScrollViewer)
            { return o; }

            for (int i = 0; i < VisualTreeHelper.GetChildrenCount(o); i++)
            {
                var child = VisualTreeHelper.GetChild(o, i);

                var result = GetScrollViewer(child);
                if (result == null)
                {
                    continue;
                }
                else
                {
                    return result;
                }
            }
            return null;
        } 

private void Focus()
{
 lstVw.SelectedIndex = dataRowToFocus.RowIndex;
 lstVw.SelectedItem = (Entity)dataRowToFocus.Row;

 ListViewItem lvi = (ListViewItem)lstVw.ItemContainerGenerator.ContainerFromItem(lstVw.SelectedItem);
ContentPresenter contentPresenter = FindVisualChild<ContentPresenter>(lvi);
contentPresenter.Focus();
contentPresenter.BringIntoView();

} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-11-13T14:15:20.410

如果您只想在创建新数据项后显示并聚焦最后一项，则此方法可能更好。与 ScrollIntoView 相比，在我的测试中，ScrollViewer 的 ScrollToEnd 更可靠。在一些使用上面 ListView 的 ScrollIntoView 方法的测试中失败了，我不知道原因。但是使用 ScrollViewer 滚动到最后一个可以工作。

```
void FocusLastOne(ListView lsv)
{
   ObservableCollection<object> items= sender as ObservableCollection<object>;

   Decorator d = VisualTreeHelper.GetChild(lsv, 0) as Decorator;
   ScrollViewer v = d.Child as ScrollViewer;
   v.ScrollToEnd();

   lsv.SelectedItem = lsv.Items.GetItemAt(items.Count - 1);
   ListViewItem lvi = lsv.ItemContainerGenerator.ContainerFromIndex(items.Count - 1) as ListViewItem;
   lvi.Focus();
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-12-07T04:26:57.510

我刚刚遇到了与 ItemContainerGenerator.ContainerFromItem() 和 ItemContainerGenerator.ContainerFromIndex() 相同的问题，它们为列表框中明显存在的项目返回 null。Decasteljau 是对的，但我必须做一些挖掘才能弄清楚他的意思。这是为下一个人/女孩节省一些跑腿工作的细分。

长话短说，如果 ListBoxItems 不在视图之内，它们就会被销毁。因此 ContainerFromItem() 和 ContainerFromIndex() 返回 null，因为 ListBoxItems 不存在。这显然是这里详述的内存/性能节省功能：http: [//blogs.msdn.com/b/oren/archive/2010/11/08/wp7-silverlight-perf-demo-1-virtualizingstackpanel-vs-stackpanel- as-a-listbox-itemspanel.aspx](http://blogs.msdn.com/b/oren/archive/2010/11/08/wp7-silverlight-perf-demo-1-virtualizingstackpanel-vs-stackpanel-as-a-listbox-itemspanel.aspx)

空`<ListBox.ItemsPanel>`代码是关闭虚拟化的原因。为我解决问题的示例代码：

数据模板：

```
<phone:PhoneApplicationPage.Resources>
    <DataTemplate x:Key="StoryViewModelTemplate">
        <StackPanel>
          <your datatemplated stuff here/>
        </StackPanel>
    </DataTemplate>
</phone:PhoneApplicationPage.Resources> 
```

主体：

```
<Grid x:Name="ContentPanel">
    <ListBox Name="lbResults" ItemsSource="{Binding SearchResults}" ItemTemplate="{StaticResource StoryViewModelTemplate}">
        <ListBox.ItemsPanel>
             <ItemsPanelTemplate>
                 <StackPanel>
                 </StackPanel>
             </ItemsPanelTemplate>
        </ListBox.ItemsPanel>
    </ListBox>
</Grid> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-08T11:42:01.797

为了克服虚拟化问题，但仍然使用`ScrollIntoView`而不是在 ListView 的内部乱窜，您还可以使用 ViewModel 对象来确定选择的内容。假设您的列表中有具有`IsSelected`属性的 ViewModel 对象。您可以将项目链接到 XAML 中的 ListView，如下所示：

```
<ListView Name="PersonsListView" ItemsSource="{Binding PersonVMs}">
  <ListView.ItemContainerStyle>
    <Style TargetType="{x:Type ListViewItem}">
      <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}" />
    </Style>
  </ListView.ItemContainerStyle>
</ListView> 
```

然后，代码隐藏方法可以滚动到第一个选定的项目：

```
var firstSelected = PersonsListView.Items
    .OfType<TreeViewItemViewModel>().FirstOrDefault(x => x.IsSelected);
if (firstSelected != null)
    CoObjectsListView.ScrollIntoView(firstSelected); 
```

如果所选项目完全不在视线范围内，这也有效。在我的实验中，该`PersonsListView.SelectedItem`属性是`null`，但当然您的 ViewModel`IsSelected`属性始终存在。请务必在所有绑定和加载完成后调用此方法（使用右侧的`DispatcherPriority`）。

使用[ViewCommand](http://www.codeproject.com/Articles/554677/View-control-from-a-ViewModel-with-ViewCommands)模式，您的 ViewModel 代码可能如下所示：

```
PersonVMs.ForEach(vm => vm.IsSelected = false);
PersonVMs.Add(newPersonVM);
newPersonVM.IsSelected = true;
ViewCommandManager.InvokeLoaded("ScrollToSelectedPerson"); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-01-21T13:45:18.007

在我的项目中，我需要向用户显示从 listview 中选择的索引行，因此我将所选项目分配给 ListView 控件。此代码将滚动滚动条并显示所选项目。

BooleanListView.ScrollIntoView(BooleanListView.SelectedItem);

或者

var listView = BooleanListView; listView.SelectedItem = listView.Items.GetItemAt(BooleanListView.SelectedIndex); listView.ScrollIntoView(listView.Items[0]); listView.ScrollIntoView(listView.SelectedItem);

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-03-16T14:57:56.893

不确定这是否是要走的路，但这目前对我使用 WPF、MVVM Light 和 .NET 3.5 有效

我为 ListBox 添加了名为“ **lbPossibleError_SelectionChanged** ” 的 SelectionChanged 事件![我为 ListBox 添加了 SelectionChanged 事件](https://i.stack.imgur.com/I4Lkl.png)

然后在这个“ **lbPossibleError_SelectionChanged** ”事件后面，这是代码 ![在此处输入图像描述](https://i.stack.imgur.com/4AAs1.png)

对我来说应该有效。

# java - 虚拟网络服务

> ID：211995
> 
> 赞同：6
> 
> 时间：2008-10-17T12:54:03.097
> 
> 标签：java, web-services, mockups

我收到了一个 Web 服务接口的 WSDL 文件，我们的系统应该在将来的某个地方调用它。

在那之前，我想设置一个虚拟/模型 web 服务，它除了记录 web 服务调用并返回虚拟数据之外什么都不做。

到目前为止，我所做的是从 WSDL 文件生成 Java 对象。

当您已经有一个应用程序服务器（这里：JBoss）正在运行时，设置这样一个模型 Web 服务的最快方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-17T12:57:26.850

我们刚刚遇到了同样的问题，发现[SoapUI](http://www.soapui.org/)是一个完美的工具。给定一个 WSDL，它将在您的机器上创建一个您可以调用的服务，并且它允许您根据需要编辑响应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T13:18:59.957

您还可以使用[Fiddler](http://www.fiddlertool.com/fiddler/)，一个 HTTP 调试代理。当请求发送到特定 URL 时，您可以轻松地将 Fiddler 配置为使用其 AutoResponder 功能返回预定义的 HTTP 响应。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T14:13:01.283

您可以使用[Apache Axis 的 wsdl2java](http://ws.apache.org/axis/java/user-guide.html#WSDL2JavaBuildingStubsSkeletonsAndDataTypesFromWSDL)从 WSDL 生成框架类：

> 正如存根是用 Java 表示的 Web 服务的客户端一样，骨架是服务器端的 Java 框架。要制作骨架类，您只需为 WSDL2Java 指定“--server-side --skeletonDeploy true”选项。
> 
> ...
> 
> 骨架类是位于 Axis 引擎和实际服务实现之间的类。

You would effectively be creating your own version of the server-side implementation of the web service. You can then implement the skeleton to return some stub/dummy data, deploy that to your application server, and then make web service calls to your skeleton just as you would to the live web service.