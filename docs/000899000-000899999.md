# StackOverflow 问答 000899000-000899999

# .net - 合并两张图片，一张是透明的

> ID：899001
> 
> 赞同：1
> 
> 时间：2009-05-22T17:27:16.427
> 
> 标签：.net, c++, bitmap, imaging

我有两个位图图像。其中一个包含使用 USB 相机拍摄的照片。另一个将包含一个形状，如矩形，但它也可以是梯形，或者可以说是只有一种颜色的随机形状。图像的其余部分现在是白色的。

这两个图像的大小不同，但缩放算法并不是这里最困难的部分，因此假设它们具有完全相同的尺寸。

我想在 USB 相机图片上显示我的形状。出于组合目的，白色部分将被视为透明。现在我正在考虑逐个像素地编辑图像，但我正在寻找一个可以为我做这件事的 API。

因此，如果我拍摄一张中间有房子的照片并覆盖一个红色矩形，则生成的图像将是原始图片，房子周围有一个红色矩形。

如果有帮助，我正在使用 .NET。如果它包含一些有用的功能，我也可以使用 win32 API。

编辑：我接受了答案，因为它让我走上了正轨。这实际上非常容易做到。

```
Bitmap^ overlay_image = gcnew Bitmap("overlay.bmp");
Bitmap^ original_image = gcnew Bitmap("original.bmp");
overlay_image->MakeTransparent(Color::White);
Graphics^ g_original = Graphics::FromImage(original_image);
g_original->DrawImage(overlay_image, 0, 0); 
```

瞧，`original_image`现在上面有一个红色矩形。它实际上对于我的 30fps USB 相机来说已经足够快了，所以我可以实时获取它。

目前没有进行缩放。此外，它假设覆盖图像背景是白色的，这将是透明的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T17:41:06.177

如果您使用的是完整的 .NET 平台，System.Drawing.Imaging 具有用于 alpha 通道和遮罩的功能：

[http://www.codeproject.com/KB/GDI-plus/alphafx.aspx](http://www.codeproject.com/KB/GDI-plus/alphafx.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T17:54:14.643

[ImageMagick](http://www.imagemagick.org/script/index.php)是一个非常强大的库，值得一看。他们甚至有一个库的 .NET 端口。它可以做与透明度、形状和叠加相关的事情。

我可能会先尝试使用[命令行版本](http://www.imagemagick.org/script/command-line-tools.php)（例如`convert`or`composite`命令），看看你是否可以让它们做你想做的事。如果可行，那么您应该能够使用他们的库实现相同的功能。

# linux - Linux下如何写入CM108芯片的GPIO引脚？

> ID：899008
> 
> 赞同：2
> 
> 时间：2009-05-22T17:29:18.330
> 
> 标签：linux, hid

C-Media 的 CM108 有 4 个 GPIO 引脚，您可以通过隐藏接口访问。

使用 Windows 中的通用写入功能，我能够写入 gpio 引脚。

但是我试图在 Linux 中做同样的事情但没有成功。

linux 内核将该设备检测为 hidraw 设备。

注意：我能够从设备读取，只是不能写入。（我以 root 身份运行该应用程序只是为了确保它不是权限问题）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:09:15.830

我得到了这个工作，这里是如何。

我需要创建一个新的 linux hid 内核模块。（没那么难）/*

```
/*
 * Driver for the C-Media 108 chips
 *
 * Copyright (C) 2009 Steve Beaulac <steve@sagacity.ca>
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License as
 * published by the Free Software Foundation, version 2.
 */

/*
 * This driver is based on the cm109.c driver
 */

#include <linux/device.h>
#include <linux/hid.h>
#include <linux/module.h>

#define DRIVER_VERSION "20090526"
#define DRIVER_AUTHOR "Steve Beaulac"
#define DRIVER_DESC "C-Media 108 chip"

#define CM108_VENDOR_ID 0x0d8c
#define CM108_PRODUCT_ID 0x000c

#ifdef CONFIG_USB_DYNAMIC_MINORS
#define CM108_MINOR_BASE 0
#else
#define CM108_MINOR_BASE 96
#endif

/*
 * Linux interface and usb initialisation
 */

static int cm108_hid_probe(struct hid_device *hdev, const struct hid_device_id *id)
{
    int ret;

    ret = hid_parse(hdev);
    if (ret) {
        dev_err(&hdev->dev, "parse failed\n");
        goto error;
    }

    ret = hid_hw_start(hdev, HID_CONNECT_HIDRAW);
    if (ret) {
        dev_err(&hdev->dev, "hw start failed\n");
        goto error;
    }
    return 0;

error:
    return ret;
}

static struct hid_device_id cm108_device_table[] = {
    { HID_USB_DEVICE (CM108_VENDOR_ID, CM108_PRODUCT_ID) },
    /* you can add more devices here with product ID 0x0008 - 0x000f */
    { }
};
MODULE_DEVICE_TABLE (hid, cm108_device_table);

static struct hid_driver hid_cm108_driver = {
    .name = "cm108",
    .id_table = cm108_device_table, 
    .probe = cm108_hid_probe,
};

static int hid_cm108_init(void)
{
    return hid_register_driver(&hid_cm108_driver);
}

static void hid_cm108_exit(void)
{
    hid_unregister_driver(&hid_cm108_driver);   
}

module_init(hid_cm108_init);
module_exit(hid_cm108_exit);

MODULE_AUTHOR(DRIVER_AUTHOR);
MODULE_DESCRIPTION(DRIVER_DESC);
MODULE_LICENSE("GPL"); 
```

使用了这个makefile

```
obj-m += cm108.o 
```

并编译模块

```
make -C /lib/modules/`uname -r`/build/ M=`pwd` EXTRAVERSION="-generic" modules

sudo make -C /lib/modules/`uname -r`/build/ M=`pwd` EXTRAVERSION="-generic" modules_install

depmod -a 
```

我必须修改 modules.order 文件，以便在通用 hid linux 模块之前查询我的模块。

该模块确保 hidraw 使用接口 2。

然后我可以使用 fopen 对 CM108 芯片的 GPIO 引脚进行读写。

**顺便说一句：**写入时您需要写入 5 个字节，第一个字节用于 HID_OUTPUT_REPORT

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-25T00:54:13.523

Linux 中的大多数硬件都可以作为文件访问。如果驱动程序在文件系统上为它创建了一个硬件节点，那么你很幸运。您将能够使用常规文件例程对其进行写入。否则，您可能需要做一些汇编魔术，这可能需要您编写一个内核模块来完成它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-03-29T14:10:51.680

下面是如何在 Linux 上写入 CM108/CM119 GPIO 引脚的完整示例。

[https://github.com/wb2osz/direwolf/blob/dev/cm108.c](https://github.com/wb2osz/direwolf/blob/dev/cm108.c)

您不需要以 root 身份运行或编写自己的设备驱动程序。

我有相反的问题。我试图弄清楚如何在 Windows 上做同样的事情。

# xslt - 需要 BizTalk 的 XSLT 生成的替代品

> ID：899016
> 
> 赞同：2
> 
> 时间：2009-05-22T17:30:17.390
> 
> 标签：xslt, biztalk

目前我们使用 BizTalk 作为 XSLT 生成器。我们将两个 XSD 映射在一起，然后生成 BizTalk 和我们在另一个应用程序中使用的 XSLT。很快我们将摆脱 BizTalk，并正在寻找一个新程序来为我们提供此功能。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T15:48:04.663

我完全同意马丁的观点。如果您只是将 BizTalk 用作 XSLT 生成器，那么将其从 BizTalk 中移除是件好事。将 BizTalk 用作 XSLT 生成器就像使用 YAG 激光切割黄油一样。（[http://www.youtube.com/watch? v=aRZ8TlvH2gc](http://www.youtube.com/watch?v=aRZ8TlvH2gc) )

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T21:40:33.850

很遗憾听到您失去 BizTalk。

我已经尝试过 Altova 的 MapForce，[更多信息在这里](http://www.altova.com/products/mapforce/data_mapping.html)，它具有与 BizTalk 映射器类似的功能。

# vb.net - 如何在 vb.net 中获取从 MM/dd/yyyy 到 yyyy/MM/dd 的日期字段

> ID：899019
> 
> 赞同：0
> 
> 时间：2009-05-22T17:30:23.787
> 
> 标签：vb.net, date

我需要在 vb.net 中从 MM/dd/yyyy 到 yyyy/MM/dd 获取一个日期字段，但之后它应该仍然是一个日期字段，以便我可以将它与数据库中的日期进行匹配。

目前，我要做的就是将其更改为该格式的字符串。

我尝试了这种类型的代码，但也没有用。

```
 DateTime.Parse(yourDataAsAString).ToString("yyyy-MM-dd")
 fromDeString = String.Format("{0:yyyy/MM/dd}", aDate)
 fromDate = Format("{0:yyyy/MM/dd}", aDate) 
```

任何帮助将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-23T23:20:49.407

您不了解日期对象不会以任何特定格式存储数字。将数字按您想要的顺序格式化的唯一方法是将其转换为字符串。为什么需要以特定格式比较它们？无论格式如何，日期都是日期。12/15/78 == 1978/12/15。

如果您无法将数据库中的日期与 VB 中的日期对象进行比较，那么您在数据库中比较的日期可能会以字符串格式返回给您，在这种情况下，您应该将其转换为日期比较的对象。

```
Dim sDate As String = "2009/12/15" 'Get the date from the database and store it as a string
Dim dDate As New Date(2009, 12, 15) 'Your date object, set to whatever date you want to compare against

Select Case Date.Compare(dDate, Date.Parse(sDate))
   Case 0
      'The dates are equal
   Case Is > 0
      'The date in the database is less
   Case Is < 0
      'The date in the database is greater
End Select 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T11:07:26.203

这是一个示例模块，演示了您想要的功能。

```
Imports System.Globalization
Module Module1
    Sub Main()
        Dim culture As New CultureInfo("en-us", True)
        Dim mmDDyy As String = "10/23/2009"
        Dim realDate As Date = Date.ParseExact(mmDDyy, "mm/dd/yyyy", culture)
        Dim yyMMdd As String = realDate.ToString("yyyy/MM/dd")
    End Sub

End Module 
```

希望这可以帮助。

亲切的问候诺埃尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-12T14:37:09.313

你的第二个应该实际工作。相反，只需尝试：

```
dim chislo as date = date.now dim message As String = $"   
             Today`s Date: {String.Format("{0:dddd, dd/MM/yyyy}", Chislo)} "  
                     MsgBox(message) 
```

# javascript - 表达式解析：如何分词

> ID：899020
> 
> 赞同：4
> 
> 时间：2009-05-22T17:30:30.450
> 
> 标签：javascript, regex, parsing, expression, lexical-analysis

我希望在 Javascript 代码中标记类 Java/Javascript 的表达式。我的输入将是一个包含表达式的字符串，输出需要是一个标记数组。

做这样的事情的最佳做法是什么？我需要迭代字符串还是有一个正则表达式可以为我做这个？

我需要这个能够支持：

*   数字和字符串文字（单引号和双引号，引号转义）
*   基本的数学和布尔运算符和比较器（+、-、*、/、!、and、not、<、> 等）
*   递归对象访问的点和括号表示法 (foo.bar, foo['bar'], foo[2][prop])
*   带嵌套的括号
*   三元运算符 (foo ? bar : 'baz')
*   函数调用 (foo(bar))

出于安全原因，我特别想避免使用`eval()`或任何类似的东西。此外，`eval()`无论如何都不会为我标记表达式。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T18:14:04.143

学习编写递归下降解析器。一旦你理解了这些概念，你就可以用任何语言来做：Java、C++、JavaScript、SystemVerilog，……随便什么。如果你可以处理字符串，那么你可以解析。

递归下降解析是一种基本的解析技术，可以很容易地手动编码。如果您无法访问（或不想欺骗）解析器生成器，这将很有用。

在递归下降解析器中，语法中的每条规则都被转换为解析规则的过程。如果您需要参考其他规则，那么您可以通过调用它们来实现 - 它们只是程序。

一个简单的例子：涉及数字、加法和乘法的表达式（这说明了运算符的优先级）。一、语法：

```
expr ::= 术语
         | expr "+" 项

术语 ::= 因子
         | 术语“*”因子

因子 ::= /[0-9/+ （我在这里使用正则表达式）

```

现在编写解析器（包括词法分析器；使用递归下降，您可以将两者放在一起）。我从未使用过 JavaScript，所以让我们在（我生锈的）Java 中尝试一下：

```
class Parser {
  string str;
  int idx; // index into string

  Node parseExpr() throws ParseException
  {
    Node op1 = parseTerm();
    Node op2;

    while (idx < str.size() && str.charAt(idx) == '+') {
      idx++;
      op2 = parseTerm();
      op1 = new AddNode(op1, op2);
    }
    return op1;
  }

  Node parseTerm() throws ParseException
  {
    Node op1 = parseFactor();
    Node op2;

    while (idx < str.size() && str.charAt(idx) == '*') {
      idx++;
      op2 = parseFactor();
      op1 = new MultNode(op1, op2);
    }
    return op1;
  }

  Node parseFactor() throws ParseException
  {
    StringBuffer sb = new StringBuffer();
    int old_idx = idx;

    while (idx < str.size() && str.charAt(idx) >= '0' && str.charAt(idx) <= '9') {
      sb.append(str.charAt(idx));
      idx++;
    }
    if (idx == old_idx) {
      throw new ParseException();
    }
    return new NumberNode(sb.toString());
  }
} 
```

您可以看到每个语法规则如何转换为过程。我没有测试过这个；这是给读者的练习。

您还需要担心错误检测。现实世界的编译器需要从解析错误中恢复，以尝试解析其输入的其余部分。像这样的单行表达式解析器根本不需要尝试恢复，但它确实需要确定存在解析错误并标记它。如果您的语言允许，最简单的方法是抛出异常，并在解析器的入口点捕获它。在上面的示例中，我没有检测到所有可能的解析错误。

有关更多信息，请在 Wikipedia 中查找“LL 解析器”和“递归下降解析器”。正如我在开头所说，如果你能理解这些概念（与 LALR(1) 状态机配置闭包背后的概念相比，它们很简单），那么你就可以用任何语言为小任务编写解析器，只要因为你有一些基本的字符串能力。享受权力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T17:44:07.437

对于速度不重要的简单词法分析器，我通常为每种标记编写一个正则表达式，并反复尝试将每个标记依次与输入的开头匹配。（确保你最终不会使用 O(n^2) 算法！）像 lex 这样的工具会产生更高效的词法分析器，因为它将正则表达式组合到一个状态机中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T17:44:47.777

您需要实现一个词法分析器。您可以使用[js/cc](http://jscc.jmksf.com/)来完成，也可以自己实现有限自动机。

因为，正式地，您将操作的语言是正则的，您可以使用正则表达式。但我不推荐给你。

虽然我从来没有用过 js/cc，但我会先尝试一下，如果它不起作用，我会尝试自己构建一个词法分析器。

# c# - 在 C# 中获取数字的部分值的最快方法是什么？

> ID：899026
> 
> 赞同：2
> 
> 时间：2009-05-22T17:32:13.537
> 
> 标签：c#, floating-point

```
float f = 5.13;
double d = 5.13;

float fp = f - (float)Math.floor(f);
double dp = d - Math.floor(d); 
```

没有比每次调用外部函数更快的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T17:34:38.400

“外部功能”？

System.Math 内置于 mscorlib 中！

这实际上是最快的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T17:40:33.383

您可以将 f 转换为一个 int 来修剪小数部分。这假定您的双打在整数范围内。

当然，抖动可能足够聪明，可以将 Math.floor 优化为一些内联的 asm，这可能比转换为 int 然后再转换为 float 更快。

您是否实际测量并验证过 Math.floor 的性能正在影响您的程序？如果你没有，那么在你知道这是一个问题之前，你不应该为这种级别的微优化而烦恼，然后根据原始代码测量这个替代方案的性能。

编辑：这确实看起来更快。以下代码在使用 Math.Floor() 时需要 717 毫秒，而对于我的机器上的 int 转换代码，在发布模式下需要 172 毫秒。但同样，我怀疑性能改进是否真的很重要——为了让它变得可测量，我必须进行 100m 次迭代。此外，我发现 Math.Floor() 更具可读性并且其意图是显而易见的，未来的 CLR 可以为 Math.Floor 发出更优化的代码并轻松击败这种方法。

```
 private static double Floor1Test()
    {
        // Keep track of results in total so ops aren't optimized away.
        double total = 0;
        for (int i = 0; i < 100000000; i++)
        {
            float f = 5.13f;
            double d = 5.13;
            float fp = f - (float)Math.Floor(f);
            double dp = d - (float)Math.Floor(d);
            total = fp + dp;
        }

        return total;
    }

    private static double Floor2Test()
    {
        // Keep track of total so ops aren't optimized away.
        double total = 0;
        for (int i = 0; i < 100000000; i++)
        {
            float f = 5.13f;
            double d = 5.13;
            float fp = f - (int)(f);
            double dp = d - (int)(d);
            total = fp + dp;
        }

        return total;
    }

    static void Main(string[] args)
    {
        System.Diagnostics.Stopwatch timer = new System.Diagnostics.Stopwatch();

        // Unused run first, guarantee code is JIT'd.
        timer.Start();
        Floor1Test();
        Floor2Test();
        timer.Stop();

        timer.Reset();
        timer.Start();
        Floor1Test();
        timer.Stop();
        long floor1time = timer.ElapsedMilliseconds;

        timer.Reset();
        timer.Start();
        Floor2Test();
        timer.Stop();

        long floor2time = timer.ElapsedMilliseconds;

        Console.WriteLine("Floor 1 - {0} ms", floor1time);
        Console.WriteLine("Floor 2 - {0} ms", floor2time);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T17:47:40.520

Donald E. Knuth 说：

> “我们应该忘记小的效率，比如大约 97% 的时间：过早的优化是万恶之源。”

因此，除非您对您的应用程序进行了基准测试，并发现此操作是瓶颈的积极证据，否则不要费心优化这些代码行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T17:39:52.513

好吧，我怀疑你会得到任何现实世界的性能提升，但根据 Reflector Math.Floor 是这样的：

```
public static decimal Floor(decimal d)
{
    return decimal.Floor(d);
} 
```

所以可以说

```
double dp = d - decimal.Floor(d); 
```

可能更快。（编译器优化使我知道整点毫无意义……）

* * *

对于那些可能有兴趣将此得出其逻辑结论小数的人。楼层是：

```
public static decimal Floor(decimal d)
{
    decimal result = 0M;
    FCallFloor(ref result, d);
    return result;
} 
```

FCallFloor 是对非托管代码的调用，因此您几乎处于“优化”的极限。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-22T17:56:56.993

在这种情况下`Decimal`，我建议忽略大家喊不要更改它并尝试使用`Decimal.Truncate`. 无论它是否更快，它*都是*专门针对您正在尝试做的事情的功能，因此更加清晰。

哦，顺便说一句，它更快：

```
 System.Diagnostics.Stopwatch foo = new System.Diagnostics.Stopwatch();

        Decimal x = 1.5M;
        Decimal y = 1;
        int tests = 1000000;
        foo.Start();
        for (int z = 0; z < tests; ++z)
        {
            y = x - Decimal.Truncate(x);
        }
        foo.Stop();
        Console.WriteLine(foo.ElapsedMilliseconds);

        foo.Reset();
        foo.Start();
        for (int z = 0; z < tests; ++z)
        {
            y = x - Math.Floor(x);
        }
        foo.Stop();
        Console.WriteLine(foo.ElapsedMilliseconds);
        Console.ReadKey();

//Output: 123
//Output: 164 
```

编辑：修正了我的解释和代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T17:36:27.837

它是静态的，所以这应该非常快，没有物体可以站立。您始终可以进行位级数学运算，但除非您认真使用该功能。可能 floor() 方法已经在执行此操作，但是如果您需要非常快速的东西，您可以内联它并删除检查等，但在 C# 中，这不是您最大的性能问题。

# algorithm - 寻找一种算法来绘制一个区域，然后有条不紊地追踪该区域

> ID：899037
> 
> 赞同：1
> 
> 时间：2009-05-22T17:35:35.950
> 
> 标签：algorithm, mapping

我正在研究一些基本的机器人技术，我正在研究构建一个在房间内导航的简单机器人。这个想法是它会找到边缘，然后它会建立一个区域的地图。

完成后，我希望它能够有条不紊地走遍整个区域，以找到该区域内的任何障碍物。

有谁知道做这种事情的算法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T17:44:03.303

尝试这个：

[http://carmen.sourceforge.net/intro.html](http://carmen.sourceforge.net/intro.html)

CARMEN 是用于移动机器人控制的开源软件集合。CARMEN 是模块化软件，旨在提供基本的导航原语，包括：基地和传感器控制、测井、避障、定位、路径规划和地图绘制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T17:40:40.047

您可以看到有关 Roomba 算法的信息，因为它在做很多相同的事情。他们使用的策略是找到房间的大小，然后随机遍历该区域，房间的整体大小决定了运行多长时间以确保完全覆盖。

# posix - 获取最高分配的文件描述符

> ID：899038
> 
> 赞同：49
> 
> 时间：2009-05-22T17:35:49.287
> 
> 标签：posix, file-descriptor

是否有一种可移植的方式（POSIX）来获取当前进程的最高分配文件描述符编号？

例如，我知道有一种在 AIX 上获取号码的好方法，但我正在寻找一种可移植的方法。

我问的原因是我想关闭所有打开的文件描述符。我的程序是一个服务器，它以 root 身份运行，并为非 root 用户分叉和执行子程序。让特权文件描述符在子进程中打开是一个安全问题。一些文件描述符可能被我无法控制的代码（C 库、第三方库等）打开，所以我不能依赖`FD_CLOEXEC`任何一个。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-05-27T23:25:07.737

虽然可移植，但关闭所有文件描述符`sysconf(_SC_OPEN_MAX)`并不可靠，因为在大多数系统上，此调用返回当前文件描述符软限制，该限制可能已低于使用的最高文件描述符。另一个问题是在许多系统上`sysconf(_SC_OPEN_MAX)`可能会返回`INT_MAX`，这可能会导致这种方法速度慢得令人无法接受。不幸的是，没有可靠的、可移植的替代方案不涉及迭代每个可能的非负 int 文件描述符。

尽管不可移植，但当今常用的大多数操作系统都提供了以下一种或多种解决方案来解决此问题：

1.  **关闭所有打开的文件描述符**>= *fd*或在一个范围内的库函数。对于关闭所有文件描述符的常见情况，这是最简单的解决方案，尽管它不能用于其他很多情况。要关闭除特定集合之外的所有文件描述符，`dup2`可用于预先将它们移动到低端，并在必要时将它们向后移动。

    *   `closefrom(fd)` （Linux 与 glibc 2.34+、Solaris 9+、FreeBSD 7.3+、NetBSD 3.0+、OpenBSD 3.5+）

    *   `fcntl(fd, F_CLOSEM, 0)` （AIX、IRIX、NetBSD）

    *   `close_range(lowfd, highfd, 0)` （Linux 内核 5.9+ 和 glibc 2.34+，FreeBSD 12.2+）

2.  提供进程当前使用的**最大文件描述符的库函数。**要关闭某个数量以上的所有文件描述符，要么将它们全部关闭到此最大值，要么在循环中不断获取并关闭最高文件描述符，直到达到下限。哪个更有效取决于文件描述符密度。

    *   `fcntl(0, F_MAXFD)` (NetBSD)

    *   `pstat_getproc(&ps, sizeof(struct pst_status), (size_t)0, (int)getpid())`
        返回有关进程的信息，包括当前在 中打开的最高文件描述符`ps.pst_highestfd`。(HP-UX)

3.  列出进程当前使用的**所有文件描述符**的库函数。这更灵活，因为它允许关闭所有文件描述符，查找最高文件描述符，或者对每个打开的文件描述符执行任何其他操作，甚至可能是另一个进程的描述符。 [示例（OpenSSH）](https://github.com/openssh/openssh-portable/blob/V_8_6_P1/openbsd-compat/bsd-closefrom.c#L95-L122)

    *   `proc_pidinfo(getpid(), PROC_PIDLISTFDS, 0, fdinfo_buf, sz)` （苹果系统）
4.  当前为进程**分配的文件描述符插槽数**提供了当前使用的文件描述符数的上限。 [示例（红宝石）](https://github.com/ruby/ruby/blob/v3_0_2/io.c#L6557-L6597)

    *   `/proc/`*pid*`/status`或`/proc/self/status` (Linux)中的“FDSize:”行
5.  **包含每个打开文件描述符的条目**的目录。这类似于#3，只是它不是库函数。对于常见用途，这可能比其他方法更复杂，并且可能由于各种原因而失败，例如未安装 proc/fdescfs、chroot 环境或没有可用于打开目录的文件描述符（进程或系统限制）。因此，这种方法的使用通常与回退机制结合使用。 [示例（OpenSSH）](https://github.com/openssh/openssh-portable/blob/V_8_6_P1/openbsd-compat/bsd-closefrom.c#L124-L147)， [另一个示例（glib）](https://gitlab.gnome.org/GNOME/glib/-/blob/2.69.0/glib/gspawn.c#L1414)。

    *   `/proc/`*pid*`/fd/`或`/proc/self/fd/` （Linux、Solaris、AIX、Cygwin、NetBSD）
        （AIX 不支持“ `self`”）

    *   `/dev/fd/` (FreeBSD, macOS)

使用这种方法可能难以可靠地处理所有极端情况。例如考虑关闭所有文件描述符 >= *fd*的情况，但是所有文件描述符 < *fd*都被使用，当前进程资源限制为*fd*，并且有文件描述符 >= *fd*正在使用中。由于已达到进程资源限制，无法打开目录。如果通过资源限制从*fd*关闭每个文件描述符或`sysconf(_SC_OPEN_MAX)`用作后备，则不会关闭任何内容。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-22T19:15:58.133

POSIX方式是：

```
int maxfd=sysconf(_SC_OPEN_MAX);
for(int fd=3; fd<maxfd; fd++)
    close(fd); 
```

（注意从 3 开始关闭，以保持标准输入/标准输出/标准错误打开）

如果文件描述符未打开，close() 会无害地返回 EBADF。没有必要浪费另一个系统调用检查。

一些 Unix 支持 closefrom()。这避免了对 close() 的过多调用，具体取决于最大可能的文件描述符数。虽然我知道最好的解决方案，但它是完全不可移植的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-10-09T16:09:20.707

我编写了代码来处理所有特定于平台的功能。所有功能都是异步信号安全的。认为人们可能会发现这很有用。目前仅在 OS X 上测试，请随时改进/修复。

```
// Async-signal safe way to get the current process's hard file descriptor limit.
static int
getFileDescriptorLimit() {
    long long sysconfResult = sysconf(_SC_OPEN_MAX);

    struct rlimit rl;
    long long rlimitResult;
    if (getrlimit(RLIMIT_NOFILE, &rl) == -1) {
        rlimitResult = 0;
    } else {
        rlimitResult = (long long) rl.rlim_max;
    }

    long result;
    if (sysconfResult > rlimitResult) {
        result = sysconfResult;
    } else {
        result = rlimitResult;
    }
    if (result < 0) {
        // Both calls returned errors.
        result = 9999;
    } else if (result < 2) {
        // The calls reported broken values.
        result = 2;
    }
    return result;
}

// Async-signal safe function to get the highest file
// descriptor that the process is currently using.
// See also http://stackoverflow.com/questions/899038/getting-the-highest-allocated-file-descriptor
static int
getHighestFileDescriptor() {
#if defined(F_MAXFD)
    int ret;

    do {
        ret = fcntl(0, F_MAXFD);
    } while (ret == -1 && errno == EINTR);
    if (ret == -1) {
        ret = getFileDescriptorLimit();
    }
    return ret;

#else
    int p[2], ret, flags;
    pid_t pid = -1;
    int result = -1;

    /* Since opendir() may not be async signal safe and thus may lock up
     * or crash, we use it in a child process which we kill if we notice
     * that things are going wrong.
     */

    // Make a pipe.
    p[0] = p[1] = -1;
    do {
        ret = pipe(p);
    } while (ret == -1 && errno == EINTR);
    if (ret == -1) {
        goto done;
    }

    // Make the read side non-blocking.
    do {
        flags = fcntl(p[0], F_GETFL);
    } while (flags == -1 && errno == EINTR);
    if (flags == -1) {
        goto done;
    }
    do {
        fcntl(p[0], F_SETFL, flags | O_NONBLOCK);
    } while (ret == -1 && errno == EINTR);
    if (ret == -1) {
        goto done;
    }

    do {
        pid = fork();
    } while (pid == -1 && errno == EINTR);

    if (pid == 0) {
        // Don't close p[0] here or it might affect the result.

        resetSignalHandlersAndMask();

        struct sigaction action;
        action.sa_handler = _exit;
        action.sa_flags   = SA_RESTART;
        sigemptyset(&action.sa_mask);
        sigaction(SIGSEGV, &action, NULL);
        sigaction(SIGPIPE, &action, NULL);
        sigaction(SIGBUS, &action, NULL);
        sigaction(SIGILL, &action, NULL);
        sigaction(SIGFPE, &action, NULL);
        sigaction(SIGABRT, &action, NULL);

        DIR *dir = NULL;
        #ifdef __APPLE__
            /* /dev/fd can always be trusted on OS X. */
            dir = opendir("/dev/fd");
        #else
            /* On FreeBSD and possibly other operating systems, /dev/fd only
             * works if fdescfs is mounted. If it isn't mounted then /dev/fd
             * still exists but always returns [0, 1, 2] and thus can't be
             * trusted. If /dev and /dev/fd are on different filesystems
             * then that probably means fdescfs is mounted.
             */
            struct stat dirbuf1, dirbuf2;
            if (stat("/dev", &dirbuf1) == -1
             || stat("/dev/fd", &dirbuf2) == -1) {
                _exit(1);
            }
            if (dirbuf1.st_dev != dirbuf2.st_dev) {
                dir = opendir("/dev/fd");
            }
        #endif
        if (dir == NULL) {
            dir = opendir("/proc/self/fd");
            if (dir == NULL) {
                _exit(1);
            }
        }

        struct dirent *ent;
        union {
            int highest;
            char data[sizeof(int)];
        } u;
        u.highest = -1;

        while ((ent = readdir(dir)) != NULL) {
            if (ent->d_name[0] != '.') {
                int number = atoi(ent->d_name);
                if (number > u.highest) {
                    u.highest = number;
                }
            }
        }
        if (u.highest != -1) {
            ssize_t ret, written = 0;
            do {
                ret = write(p[1], u.data + written, sizeof(int) - written);
                if (ret == -1) {
                    _exit(1);
                }
                written += ret;
            } while (written < (ssize_t) sizeof(int));
        }
        closedir(dir);
        _exit(0);

    } else if (pid == -1) {
        goto done;

    } else {
        do {
            ret = close(p[1]);
        } while (ret == -1 && errno == EINTR);
        p[1] = -1;

        union {
            int highest;
            char data[sizeof(int)];
        } u;
        ssize_t ret, bytesRead = 0;
        struct pollfd pfd;
        pfd.fd = p[0];
        pfd.events = POLLIN;

        do {
            do {
                // The child process must finish within 30 ms, otherwise
                // we might as well query sysconf.
                ret = poll(&pfd, 1, 30);
            } while (ret == -1 && errno == EINTR);
            if (ret <= 0) {
                goto done;
            }

            do {
                ret = read(p[0], u.data + bytesRead, sizeof(int) - bytesRead);
            } while (ret == -1 && ret == EINTR);
            if (ret == -1) {
                if (errno != EAGAIN) {
                    goto done;
                }
            } else if (ret == 0) {
                goto done;
            } else {
                bytesRead += ret;
            }
        } while (bytesRead < (ssize_t) sizeof(int));

        result = u.highest;
        goto done;
    }

done:
    if (p[0] != -1) {
        do {
            ret = close(p[0]);
        } while (ret == -1 && errno == EINTR);
    }
    if (p[1] != -1) {
        do {
            close(p[1]);
        } while (ret == -1 && errno == EINTR);
    }
    if (pid != -1) {
        do {
            ret = kill(pid, SIGKILL);
        } while (ret == -1 && errno == EINTR);
        do {
            ret = waitpid(pid, NULL, 0);
        } while (ret == -1 && errno == EINTR);
    }

    if (result == -1) {
        result = getFileDescriptorLimit();
    }
    return result;
#endif
}

void
closeAllFileDescriptors(int lastToKeepOpen) {
    #if defined(F_CLOSEM)
        int ret;
        do {
            ret = fcntl(lastToKeepOpen + 1, F_CLOSEM);
        } while (ret == -1 && errno == EINTR);
        if (ret != -1) {
            return;
        }
    #elif defined(HAS_CLOSEFROM)
        closefrom(lastToKeepOpen + 1);
        return;
    #endif

    for (int i = getHighestFileDescriptor(); i > lastToKeepOpen; i--) {
        int ret;
        do {
            ret = close(i);
        } while (ret == -1 && errno == EINTR);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-08-03T12:55:12.990

在 MacOS 上，您可以使用`posix_spawn`带有.`POSIX_SPAWN_CLOEXEC_DEFAULT``posix_spawnattr_setflags`

这将只留下在调用中显式设置的文件描述符`posix_spawn`打开，关闭调用其他。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-11T22:02:30.757

就在您的程序启动并且没有打开任何东西的时候。例如像 main() 的开始。pipe 和 fork 立即启动执行服务器。这样它的内存和其他细节是干净的，你可以把东西交给 fork & exec。

```
#include <unistd.h>
#include <stdio.h>
#include <memory.h>
#include <stdlib.h>

struct PipeStreamHandles {
    /** Write to this */
    int output;
    /** Read from this */
    int input;

    /** true if this process is the child after a fork */
    bool isChild;
    pid_t childProcessId;
};

PipeStreamHandles forkFullDuplex(){
    int childInput[2];
    int childOutput[2];

    pipe(childInput);
    pipe(childOutput);

    pid_t pid = fork();
    PipeStreamHandles streams;
    if(pid == 0){
        // child
        close(childInput[1]);
        close(childOutput[0]);

        streams.output = childOutput[1];
        streams.input = childInput[0];
        streams.isChild = true;
        streams.childProcessId = getpid();
    } else {
        close(childInput[0]);
        close(childOutput[1]);

        streams.output = childInput[1];
        streams.input = childOutput[0];
        streams.isChild = false;
        streams.childProcessId = pid;
    }

    return streams;
}

struct ExecuteData {
    char command[2048];
    bool shouldExit;
};

ExecuteData getCommand() {
    // maybe use json or semething to read what to execute
    // environment if any and etc..        
    // you can read via stdin because of the dup setup we did
    // in setupExecutor
    ExecuteData data;
    memset(&data, 0, sizeof(data));
    data.shouldExit = fgets(data.command, 2047, stdin) == NULL;
    return data;
}

void executorServer(){

    while(true){
        printf("executor server waiting for command\n");
        // maybe use json or semething to read what to execute
        // environment if any and etc..        
        ExecuteData command = getCommand();
        // one way is for getCommand() to check if stdin is gone
        // that way you can set shouldExit to true
        if(command.shouldExit){
            break;
        }
        printf("executor server doing command %s", command.command);
        system(command.command);
        // free command resources.
    }
}

static PipeStreamHandles executorStreams;
void setupExecutor(){
    PipeStreamHandles handles = forkFullDuplex();

    if(handles.isChild){
        // This simplifies so we can just use standard IO 
        dup2(handles.input, 0);
        // we comment this out so we see output.
        // dup2(handles.output, 1);
        close(handles.input);
        // we uncomment this one so we can see hello world
        // if you want to capture the output you will want this.
        //close(handles.output);
        handles.input = 0;
        handles.output = 1;
        printf("started child\n");
        executorServer();
        printf("exiting executor\n");
        exit(0);
    }

    executorStreams = handles;
}

/** Only has 0, 1, 2 file descriptiors open */
pid_t cleanForkAndExecute(const char *command) {
    // You can do json and use a json parser might be better
    // so you can pass other data like environment perhaps.
    // and also be able to return details like new proccess id so you can
    // wait if it's done and ask other relevant questions.
    write(executorStreams.output, command, strlen(command));
    write(executorStreams.output, "\n", 1);
}

int main () {
    // needs to be done early so future fds do not get open
    setupExecutor();

    // run your program as usual.
    cleanForkAndExecute("echo hello world");
    sleep(3);
} 
```

如果你想在执行的程序上做 IO，执行器服务器将不得不做套接字重定向，你可以使用 unix 套接字。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-22T17:54:45.110

为什么不关闭从 0 到 10000 的所有描述符。

这会很快，最糟糕的事情就是 EBADF。

# twitter - OAuth 可以用于在未来安排 Twitter 状态更新吗？

> ID：899042
> 
> 赞同：0
> 
> 时间：2009-05-22T17:36:52.360
> 
> 标签：twitter, oauth, scheduled-tasks

我正在开发一个关于 OAuth 的 Twitter 应用程序，并且我希望能够提供将来发布更新的功能。

基本计划是每小时运行一个脚本并查找需要发布的任何更新，然后验证适当的用户并使用 statuses/update API 调用。

但是，我不知道如何为此使用 OAuth。我显然不想存储他们的用户名和密码——这违背了在第一个实例中使用 OAuth 的目的。

但是，如果这是唯一的选择，那么我怎么能不存储他们密码的明文副本但仍然对他们进行身份验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T17:54:17.420

使用 OAuth，您最初只需要用户凭据即可获取 oauth 令牌。获得 oauth 令牌后，您可以使用 oauth 令牌代替这些凭据。OAuth 下后续调用中的唯一问题是与服务端令牌关联的任何 TTL（生存时间）。 [Twitter 显然不会使令牌过期](http://apiwiki.twitter.com/OAuth-FAQ)，因此一旦您拥有有效的令牌，您应该能够继续代表用户拨打电话。您需要从用户那里获取凭据的唯一情况是 (1) 在运行应用程序的初始阶段，或 (2) 如果用户的会话由于某种原因变得无效（更改密码、用户控制的会话失效， ETC。）。

有关更多详细信息，请参阅[OAuth 规范](http://oauth.net/core/1.0/)。

请注意，如果您打算在应用程序的调用之间使用相同的用户令牌，您应该准备好加密令牌并安全地存储它。如果有人捕获了您的消费者密钥和秘密以及用户令牌，则用户的身份可能会受到损害。

# database - 最终用户数据库应用市场规模（Microsoft Access、Filemaker Pro 等）

> ID：899046
> 
> 赞同：0
> 
> 时间：2009-05-22T17:38:09.817
> 
> 标签：database

这不是一个技术问题，但我想我还是会把它扔掉。

我需要一个粗略的最终用户数据库应用市场规模。具体来说，我说的是 Microsoft Access 和 Filemaker Pro 等产品。

有谁知道我在哪里可以找到这样的信息（最好不要为市场研究报告支付 5000 美元......）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T18:30:54.520

微软的年报应该会谈到ms access，并有关于市场规模、渗透率、forcase等的信息。

# php - 在表单提交后台功能php运行

> ID：899052
> 
> 赞同：1
> 
> 时间：2009-05-22T17:39:17.020
> 
> 标签：php, javascript, background, server-side

我正在寻找一种在表单提交上启动函数的方法，它不会让浏览器窗口等待结果。

示例：用户填写表单并按提交，通过 javascript 将表单中的数据发送到数据库，php 中的一个需要几秒钟的函数将启动，但我不希望用户等待该函数的结束. 我希望能够将他带到另一个页面并让该功能在服务器端执行其操作。

有什么想法吗？

谢谢

* * *

感谢所有的答复...

我得到了ajax部分。但是我不能调用 ajax 并让浏览器移动到另一个页面。

这就是我想要的。

- 用户填写表单并提交 - 传递给数据库的表单结果 - 长烦人的进程功能启动 - 用户继续访问站点的其余部分，独立于“长烦人的进程功能”的状态

顺便说一句，在有人建议之前。不，它不能由 cron 作业完成

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T18:12:28.387

使用 AJAX 调用 php 脚本，并在脚本顶部打开[ignore_user_abort](http://www.php.net/manual/en/function.ignore-user-abort.php)。

```
ignore_user_abort(true); 
```

这样，如果他们离开页面，脚本将继续在后台运行。你也可以使用

```
set_time_limit(0); 
```

设置时间限制，如果您知道脚本需要一段时间才能完成，这很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T17:43:23.710

最常用的方法是：

```
exec("$COMMAND > /dev/null 2>&1 &"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T17:57:43.717

啊，好吧，那么您实际上是在问，PHP 是否支持线程，一般的答案是否定的......但是......

您可以执行一些技巧来模仿这种行为，其中一个在上面突出显示，涉及分叉到服务器上的单独进程，这可以通过多种方式实现，包括：

```
exec() 
```

方法。您可能还想看这里；

[PHP 线程](https://stackoverflow.com/questions/209774/does-php-have-threading)

我还看到人们试图在脚本中途强制刷新输出缓冲区，试图将响应强制返回给客户端，我不知道这种方法有多成功，但也许其他人会有一些关于该方法的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T17:44:07.403

这正是 AJAX（异步 JavaScript + XML 的简写）的用途；

[AJAX 信息](http://en.wikipedia.org/wiki/Ajax_(programming))

它允许您使用客户端代码进行编码，并向您的服务器发送异步请求，这样用户的浏览器就不会被整个页面请求中断。

网上有很多与 AJAX 相关的信息，所以请深吸一口气，开始搜索吧！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T17:45:46.153

听起来您想使用 AJAX（异步 Javascript 和 XML - google）必须提供的一些功能。

基本上，您将拥有一个包含内容的页面。当用户单击按钮时，javascript 将用于将数据 POST 到服务器并开始处理。同时，该 javascript 可能会从服务器加载页面并显示它（例如，加载数据，然后用该新页面替换 DIV 的内容。）

这种*事情*是 AJAX 背后的前提，当您有一个网页同时执行多项操作时，您随处可见。

值得注意的是：这并不意味着脚本“在服务器的后台”运行。您的网络浏览器仍在与网络服务器保持连接——这意味着代码在*客户端的*“后台”中运行。“后台”实际上是指“与其他 HTTP 请求并行处理 HTTP 请求，以给人一种‘后台’运行进程的感觉”

# hibernate - Glassfish 中的休眠 - Ejb3Configuration NoClassDefFoundError

> ID：899057
> 
> 赞同：2
> 
> 时间：2009-05-22T17:40:30.827
> 
> 标签：hibernate, netbeans, jakarta-ee, glassfish, ejb-3.0

我已经将 Hibernate 库放在 Glassfish 域和我在 Netbeans 中的项目的库集合中。*hibernate-entitymanager.jar*包含 HibernatePersistence（调用堆栈中的最后一个类）和 Ejb3Configuration，所以我很难理解为什么我会收到 Ejb3Configuration 的缺失类错误。

```
java.lang.NoClassDefFoundError: Could not initialize class org.hibernate.ejb.Ejb3Configuration
    at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:130)
    at com.sun.enterprise.server.PersistenceUnitLoaderImpl.load(PersistenceUnitLoaderImpl.java:149)
    at com.sun.enterprise.server.PersistenceUnitLoaderImpl.load(PersistenceUnitLoaderImpl.java:84)
... 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T20:59:50.373

我以前从未见过这个特定的错误消息，但我可以解释一下它的含义并给出一个可能的原因。

线

```
java.lang.NoClassDefFoundError：无法初始化类 org.hibernate.ejb.Ejb3Configuration

```

并不意味着 JVM 找不到该类`org.hibernate.ejb.Ejb3Configuration`。这意味着JVM可以找到这个类，但它已经尝试加载这个类并且失败了。

`Could not initialize class ...`它是表明这已经发生的文本。如果 JVM 根本找不到这个类，你会得到类似下面的东西：

```
java.lang.NoClassDefFoundError: org/hibernate/ejb/Ejb3Configuration

```

顺便说一句，这也意味着您正在使用 Java 6 - 在 Java 5 中，相应的异常没有消息。

以下两个类提供了这种行为的演示。`Unloadable`无法加载该类，因为它的静态初始化程序总是抛出异常。我们尝试加载这个类，捕捉`ExceptionInInitializerError`结果，然后尝试`Unloadable`再次加载。

```
class Unloadable {
    static {
        if (true) { throw new RuntimeException(); }
    }
}

public class LoadingTest {
    public static void main(String[] args) throws Exception {
        try {
            Class.forName("Unloadable");
        }
        catch (ExceptionInInitializerError e) {
            try {
                Class.forName("Unloadable");
            }
            catch (NoClassDefFoundError e2) {
                System.out.println("XXXXXXXXXXXXXXXXXXXXX");
                e2.printStackTrace(System.out);
            }
        }
    }
} 
```

当我运行 class`LoadingTest`时，我得到以下输出：

```
XXXXXXXXXXXXXXXXXXXXX
java.lang.NoClassDefFoundError：无法初始化类 Unloadable
        在 java.lang.Class.forName0（本机方法）
        在 java.lang.Class.forName(Class.java:169)
        在 LoadingTest.main(LoadingTest.java:14)

```

我不能说是什么导致了最初的加载尝试`org.hibernate.ejb.Ejb3Configuration`失败。很可能它`Ejb3Configuration`本身取决于类路径中缺少的类。可能值得仔细阅读`import`由[Ejb3Configuration](http://viewvc.jboss.org/cgi-bin/viewvc.cgi/hibernate/entitymanager/trunk/src/java/org/hibernate/ejb/Ejb3Configuration.java?view=markup&pathrev=14274)编辑的所有类的列表，并确保所有那些不在Glassfish 和 Netbeans 可以看到的 JAR下`java.*`或在其中的所有类。`javax.*`

另外，我只能推测为什么 JVM 试图加载`Ejb3Configuration` *两次*。当类加载第一次失败时，会抛出异常（通常是 的某个子类`LinkageError`）。这种类型的异常并不经常被捕获，所以我最好的猜测是正在发生类似以下的事情：

```
try {
    // Some code that loads Ejb3Configuration and fails.
}
finally {
    // Some code that also loads Ejb3Configuration and fails.
} 
```

如果`finally`块中的代码抛出异常，则该异常将替换块中抛出的任何异常`try`。[我建议这样做是因为在这个问题](https://stackoverflow.com/questions/596999)上发生了类似的事情。此问题中发布的堆栈跟踪来自一个`finally`块内。

如果我的回答仍然对您没有帮助，您能否发布您看到的整个堆栈跟踪？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-06T09:11:46.850

我也遇到了这个问题，尽管在我的情况下它似乎是一个特定于版本的问题。较新版本的 hibernate 依赖于 Java 的 Simple Logging Facade (SLF4J)，但 maven 工件仅包含 API，因此您需要 WAR 或服务器的 lib 文件夹中的运行时库。

这是特定于 Hibernate Entity Manager 3.4.0 版本的，尽管它也可能适用于其他版本。如果您使用的是 Hibernate Core 3.3.x，那么您使用的是 3.4.x 系列的 Hibernate EM，因此您需要这些运行时库。

# python - 在鼻子下测试 Python 代码时，我应该如何验证日志消息？

> ID：899067
> 
> 赞同：96
> 
> 时间：2009-05-22T17:42:46.020
> 
> 标签：python, unit-testing, mocking, nose

我正在尝试编写一个简单的单元测试，以验证在特定条件下，我的应用程序中的一个类将通过标准日志记录 API 记录一个错误。我无法弄清楚测试这种情况的最干净的方法是什么。

我知道鼻子已经通过它的日志插件捕获日志输出，但这似乎是为了作为失败测试的报告和调试帮助。

我可以看到的两种方法是：

*   以零碎的方式（mymodule.logging = mockloggingmodule）或使用适当的模拟库来模拟日志模块。
*   编写或使用现有的鼻子插件来捕获输出并验证它。

如果我采用前一种方法，我想知道在模拟日志模块之前将全局状态重置为它的最干净的方法。

期待您对此的提示和提示...

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2016-01-21T10:08:28.917

从 python 3.4 开始，标准的*unittest*库提供了一个新的测试断言上下文管理器，`assertLogs`. 从[文档](https://docs.python.org/3.4/library/unittest.html#unittest.TestCase.assertLogs)：

```
with self.assertLogs('foo', level='INFO') as cm:
    logging.getLogger('foo').info('first message')
    logging.getLogger('foo.bar').error('second message')
    self.assertEqual(cm.output, ['INFO:foo:first message',
                                 'ERROR:foo.bar:second message']) 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2013-02-02T20:36:27.420

幸运的是，这不是您必须自己编写的东西；该`testfixtures`包提供了一个上下文管理器，用于捕获`with`语句主体中出现的所有日志记录输出。你可以在这里找到包：

[http://pypi.python.org/pypi/testfixtures](http://pypi.python.org/pypi/testfixtures)

以下是有关如何测试日志记录的文档：

[http://testfixtures.readthedocs.org/en/latest/logging.html](http://testfixtures.readthedocs.org/en/latest/logging.html)

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2013-12-12T20:15:41.307

**更新**：不再需要下面的答案。请改用[内置的 Python 方式](https://docs.python.org/3/library/unittest.html#unittest.TestCase.assertLogs)！

这个答案扩展了在[https://stackoverflow.com/a/1049375/1286628](https://stackoverflow.com/a/1049375/1286628)中完成的工作。处理程序大致相同（构造函数更惯用，使用`super`）。此外，我添加了一个演示，说明如何将处理程序与标准库的`unittest`.

```
class MockLoggingHandler(logging.Handler):
    """Mock logging handler to check for expected logs.

    Messages are available from an instance's ``messages`` dict, in order, indexed by
    a lowercase log level string (e.g., 'debug', 'info', etc.).
    """

    def __init__(self, *args, **kwargs):
        self.messages = {'debug': [], 'info': [], 'warning': [], 'error': [],
                         'critical': []}
        super(MockLoggingHandler, self).__init__(*args, **kwargs)

    def emit(self, record):
        "Store a message from ``record`` in the instance's ``messages`` dict."
        try:
            self.messages[record.levelname.lower()].append(record.getMessage())
        except Exception:
            self.handleError(record)

    def reset(self):
        self.acquire()
        try:
            for message_list in self.messages.values():
                message_list.clear()
        finally:
            self.release() 
```

然后你可以`unittest.TestCase`像这样在标准库中使用处理程序：

```
import unittest
import logging
import foo

class TestFoo(unittest.TestCase):

    @classmethod
    def setUpClass(cls):
        super(TestFoo, cls).setUpClass()
        # Assuming you follow Python's logging module's documentation's
        # recommendation about naming your module's logs after the module's
        # __name__,the following getLogger call should fetch the same logger
        # you use in the foo module
        foo_log = logging.getLogger(foo.__name__)
        cls._foo_log_handler = MockLoggingHandler(level='DEBUG')
        foo_log.addHandler(cls._foo_log_handler)
        cls.foo_log_messages = cls._foo_log_handler.messages

    def setUp(self):
        super(TestFoo, self).setUp()
        self._foo_log_handler.reset() # So each test is independent

    def test_foo_objects_fromble_nicely(self):
        # Do a bunch of frombling with foo objects
        # Now check that they've logged 5 frombling messages at the INFO level
        self.assertEqual(len(self.foo_log_messages['info']), 5)
        for info_message in self.foo_log_messages['info']:
            self.assertIn('fromble', info_message) 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2009-06-26T14:13:44.763

我曾经模拟记录器，但在这种情况下，我发现最好使用记录处理程序，所以我根据[jkp 建议的文档](http://www.fubar.si/2009/3/4/mocking-logging-python-module-for-unittests)编写了这个（现已死，但缓存在[Internet Archive](https://web.archive.org/web/20090416104408/http://www.fubar.si/2009/3/4/mocking-logging-python-module-for-unittests)上）

```
class MockLoggingHandler(logging.Handler):
    """Mock logging handler to check for expected logs."""

    def __init__(self, *args, **kwargs):
        self.reset()
        logging.Handler.__init__(self, *args, **kwargs)

    def emit(self, record):
        self.messages[record.levelname.lower()].append(record.getMessage())

    def reset(self):
        self.messages = {
            'debug': [],
            'info': [],
            'warning': [],
            'error': [],
            'critical': [],
        } 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2015-02-03T18:33:46.227

布兰登的回答：

```
pip install testfixtures 
```

片段：

```
import logging
from testfixtures import LogCapture
logger = logging.getLogger('')

with LogCapture() as logs:
    # my awesome code
    logger.error('My code logged an error')
assert 'My code logged an error' in str(logs) 
```

**注意：以上与调用nosetests**和获取工具的logCapture插件输出不冲突

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2021-02-18T23:01:07.733

### 最简单的答案

Pytest 有一个名为`caplog`. 无需设置。

```
def test_foo(foo, caplog, expected_msgs):

    foo.bar()

    assert [r.msg for r in caplog.records] == expected_msgs 
```

**我希望在浪费 6 个小时之前就知道 caplog。**

> 不过警告 - 它会重置，因此您需要在对 caplog 进行断言的同一测试中执行 SUT 操作。

就个人而言，我希望我的控制台输出干净，所以我喜欢这样来使 log-to-stderr 静音：

```
from logging import getLogger
from pytest import fixture

@fixture
def logger(caplog):

    logger = getLogger()
    _ = [logger.removeHandler(h) for h in logger.handlers if h != caplog.handler]       # type: ignore
    return logger

@fixture
def foo(logger):

    return Foo(logger=logger)

@fixture
def expected_msgs():

    # return whatever it is you expect from the SUT

def test_foo(foo, caplog, expected_msgs):

    foo.bar()

    assert [r.msg for r in caplog.records] == expected_msgs 
```

如果您厌倦了可怕的单元测试代码，那么 pytest 固定装置有很多值得您喜欢的地方。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-22T22:57:26.970

作为 Reef 回答的后续行动，我冒昧地使用[pymox](http://code.google.com/p/pymox/)编写了一个示例。它引入了一些额外的帮助函数，使存根函数和方法更容易。

```
import logging

# Code under test:

class Server(object):
    def __init__(self):
        self._payload_count = 0
    def do_costly_work(self, payload):
        # resource intensive logic elided...
        pass
    def process(self, payload):
        self.do_costly_work(payload)
        self._payload_count += 1
        logging.info("processed payload: %s", payload)
        logging.debug("payloads served: %d", self._payload_count)

# Here are some helper functions
# that are useful if you do a lot
# of pymox-y work.

import mox
import inspect
import contextlib
import unittest

def stub_all(self, *targets):
    for target in targets:
        if inspect.isfunction(target):
            module = inspect.getmodule(target)
            self.StubOutWithMock(module, target.__name__)
        elif inspect.ismethod(target):
            self.StubOutWithMock(target.im_self or target.im_class, target.__name__)
        else:
            raise NotImplementedError("I don't know how to stub %s" % repr(target))
# Monkey-patch Mox class with our helper 'StubAll' method.
# Yucky pymox naming convention observed.
setattr(mox.Mox, 'StubAll', stub_all)

@contextlib.contextmanager
def mocking():
    mocks = mox.Mox()
    try:
        yield mocks
    finally:
        mocks.UnsetStubs() # Important!
    mocks.VerifyAll()

# The test case example:

class ServerTests(unittest.TestCase):
    def test_logging(self):
        s = Server()
        with mocking() as m:
            m.StubAll(s.do_costly_work, logging.info, logging.debug)
            # expectations
            s.do_costly_work(mox.IgnoreArg()) # don't care, we test logging here.
            logging.info("processed payload: %s", 'hello')
            logging.debug("payloads served: %d", 1)
            # verified execution
            m.ReplayAll()
            s.process('hello')

if __name__ == '__main__':
    unittest.main() 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-22T17:52:39.577

您应该使用模拟，因为有一天您可能希望将您的记录器更改为数据库之一。如果它在鼻子测试期间尝试连接到数据库，您将不会高兴。

即使标准输出被抑制，模拟仍将继续工作。

我使用[了 pyMox](http://code.google.com/p/pymox/wiki/MoxDocumentation)的存根。请记住在测试后取消设置存根。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-09-24T21:58:57.547

如果你定义一个这样的辅助方法：

```
import logging

def capture_logging():
    records = []

    class CaptureHandler(logging.Handler):
        def emit(self, record):
            records.append(record)

        def __enter__(self):
            logging.getLogger().addHandler(self)
            return records

        def __exit__(self, exc_type, exc_val, exc_tb):
            logging.getLogger().removeHandler(self)

    return CaptureHandler() 
```

然后你可以像这样编写测试代码：

```
 with capture_logging() as log:
        ... # trigger some logger warnings
    assert len(log) == ...
    assert log[0].getMessage() == ... 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-22T17:52:55.503

自从我发布此内容以来，找到[了一个答案。](http://www.fubar.si/2009/3/4/mocking-logging-python-module-for-unittests)不错。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-12-03T13:03:35.827

`ExpectLog`在 tornado 中实现的类是一个很棒的实用程序：

```
with ExpectLog('channel', 'message regex'):
    do_it() 
```

[http://tornado.readthedocs.org/en/latest/_modules/tornado/testing.html#ExpectLog](http://tornado.readthedocs.org/en/latest/_modules/tornado/testing.html#ExpectLog)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-01-12T01:54:46.633

关闭@Reef 的答案，我确实尝试了下面的代码。它适用于 Python 2.7（如果您安装[mock](https://pypi.python.org/pypi/mock)）和 Python 3.4。

```
"""
Demo using a mock to test logging output.
"""

import logging
try:
    import unittest
except ImportError:
    import unittest2 as unittest

try:
    # Python >= 3.3
    from unittest.mock import Mock, patch
except ImportError:
    from mock import Mock, patch

logging.basicConfig()
LOG=logging.getLogger("(logger under test)")

class TestLoggingOutput(unittest.TestCase):
    """ Demo using Mock to test logging INPUT. That is, it tests what
    parameters were used to invoke the logging method, while still
    allowing actual logger to execute normally.

    """
    def test_logger_log(self):
        """Check for Logger.log call."""
        original_logger = LOG
        patched_log = patch('__main__.LOG.log',
                            side_effect=original_logger.log).start()

        log_msg = 'My log msg.'
        level = logging.ERROR
        LOG.log(level, log_msg)

        # call_args is a tuple of positional and kwargs of the last call
        # to the mocked function.
        # Also consider using call_args_list
        # See: https://docs.python.org/3/library/unittest.mock.html#unittest.mock.Mock.call_args
        expected = (level, log_msg)
        self.assertEqual(expected, patched_log.call_args[0])

if __name__ == '__main__':
    unittest.main() 
```

# iphone - 如何在运行时动态地将 id 类型转换为具体类？

> ID：899068
> 
> 赞同：2
> 
> 时间：2009-05-22T17:43:04.130
> 
> 标签：iphone, objective-c, cocoa, dynamic, key-value-observing

我有几个用于一个 UIViewController 的数据源。我的视图控制器使用 KeyValue Observing 来跟踪运行时某些属性的状态。当我交换数据源时，我需要停止观察这些属性。问题是，我不确定运行时数据源的类，因此这样的事情是无效的：

```
if (aDataSource != dataSource) {
    // Ensure we stop observing the existing dataSource, otherwise bad stuff can happen.
    [dataSource removeObserver:self forKeyPath:@"someKeyPath"]; // not valid, compiler doesn't know what class dataSource is.
    [dataSource release];
    dataSource = [aDataSource retain];
} 
```

编译器需要一个具体的类才能知道对象的接口。在这种特殊情况下，如何获取数据源的类，然后为上面的 removeObserver:forKeyPath: 选择器键入数据源？我更喜欢动态/更智能的东西，而不是在 NSString 实例中缓存类的名称并在我切换时引用它。意思是，我总是可以做类似的事情：

```
NSString *lastDataSource = @"MyClass";
Class foo = [NSClassFromString(lastDataSource)]; 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T18:21:44.473

1.  如果你这样编码：

    ```
    id foo = ...;
    [foo removeObserver:self forKeyPath:@"someKeyPath"]; 
    ```

    编译器会很好，因为具有类型的对象`id`接受任何消息（只要编译器知道签名）。

2.  现在，如果您有：

    ```
    id<NSObject> foo = ...;
    [foo removeObserver:self forKeyPath:@"someKeyPath"]; 
    ```

    编译器会给你一个警告：

    > 警告：'-removeObserver:forKeyPath:' 在协议中找不到

    这是因为您指的是协议 NSObject 而不是定义 KVO 方法的 NSObject 类。

3.  但如果你有：

    ```
    NSObject* foo = ...;
    [foo removeObserver:self forKeyPath:@"someKeyPath"]; 
    ```

    这也可以很好地编译，因为在这种情况下您使用的是 NSObject 类。

相关链接：

*   [Objective-C 协议](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/ocProtocols.html#//apple_ref/doc/uid/TP30001163-CH15-SW1)
*   [id 类型和协议](http://www.mobileorchard.com/the-id-type-and-protocols/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T17:49:05.697

你是什​​么意思它是无效的？你得到一个编译错误？

Objective-C 默认支持对象的动态类型。您应该能够在 Objective-C 中的任何对象上调用任何方法，即使编译器不能从静态类型保证该对象支持该方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T18:10:48.483

我认为您需要将它们转换为`NSObject *`，因为那是 KVO 方法所在的位置（不在`NSObject`协议中）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T10:17:45.973

让我补充一下您概述的方法......

```
NSString *lastDataSource = @"MyClass";
Class foo = [NSClassFromString(lastDataSource)]; 
```

...当然无法抑制您的编译时警告，因为“foo”类只会在运行时计算。因此，即使您作为程序员可以从代码中清楚地看到“foo”最终将成为类“MyClass”，编译器也不清楚，所以如果“MyClass”有一个方法“myMethod:”，你会如果您将该消息发送到声明为“foo”的对象，仍然会收到编译器警告。

我猜你已经意识到了这一点，但最好弄清楚为什么这种方法不能解决你的问题。

# unit-testing - nant 脚本不显示单元测试详细信息

> ID：899070
> 
> 赞同：1
> 
> 时间：2009-05-22T17:43:22.180
> 
> 标签：unit-testing, nant

有人可以告诉我为什么我的构建脚本（nant）没有在命令提示符窗口中显示单元测试详细信息吗？我已将详细设置为 true，但它不想显示有关我的单元测试的任何详细信息。这是目标：

```
<target name="run-unit-tests" depends="compile, move.assemblies.for.tests, rebuildDatabase">
        <mkdir dir="${tests.output.dir}" />

        <nunit2 haltonfailure="true" failonerror="true" verbose="true">
            <formatter type="Xml" extension=".xml" outputdir="${tests.output.dir}" usefile="true" />
            <test assemblyname="${test.assembly.file}" />
        </nunit2>
    <echo message="Unit Testing Done!" />
    </target> 
```

命令提示符窗口仅显示以下内容：

```
[mkdir] Creating directory 'C:\Projects\TestProject\build\artifacts\UnitTestOutput'.
[echo] Unit Testing Done!
build:
BUILD SUCCEEDED 
```

我在这里错过了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T17:54:24.610

我找到了答案。我查看了 CodeCampServer 的源代码并看到了一行

```
<formatter type="Plain" /> 
```

并将其添加到我的构建脚本中，如下所示：

```
<nunit2 haltonfailure="true" failonerror="true" verbose="true">
            <formatter type="Xml" extension=".xml" outputdir="${tests.output.dir}" usefile="true" />
      <formatter type="Plain" />
            <test assemblyname="${test.assembly.file}" />
        </nunit2> 
```

现在它显示详细信息。

很抱歉在这里过早地问这个问题，但如果他们有类似的问题，至少它可能会帮助将来的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T17:46:25.233

${tests.output.dir} 中是否有日志文件？如果是这样，如果将 usefile 设置为 false 并键入“Plain”怎么办？

# .net - 调试.net进程时如何找到LastError的值？

> ID：899075
> 
> 赞同：4
> 
> 时间：2009-05-22T17:44:00.183
> 
> 标签：.net, visual-studio, debugging, winapi

我从使用互操作调用 win32 api 函数的 .net 进程中得到一个异常。我有一个调试器，我想查看 LastError 的值。是否可以从 Visual Studio 调试器中查看 LastError 的值？

两个注意事项：抛出异常的进程不是我的，我无法修改它的源代码来获取LastError的值。
我正在使用 Visual Studio 2010 的测试版，我假设适用于 VS 2008 的解决方案适用于 2010。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T17:46:06.933

您可以调用[Marshal.GetLastWin32Error()](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getlastwin32error.aspx)来获取最后的 Windows API 错误消息。这是建议的方法（与使用 P/Invoke 不同）。

来自文档：“GetLastWin32Error 从 Kernel32.DLL 公开 Win32 GetLastError API 方法。此方法存在是因为直接平台调用 GetLastError 来获取此信息是不安全的。如果您想访问此错误代码，您必须调用 GetLastWin32Error 而不是为 GetLastError 编写自己的平台调用定义并调用它。公共语言运行时可以对覆盖操作系统维护的 GetLastError 的 API 进行内部调用。”

另外，在不修改源方面：

[如果 P/Invoke 调用使用DllImportAttribute.SetLastError](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.dllimportattribute.setlasterror.aspx)修饰，这将在 Visual Studio 即时窗口中工作。但是，如果对 Windows API 的 P/Invoke 调用缺少该属性，那么您会有些不走运，因为编组 api 很可能会在您看到之前覆盖 GetLastError 中的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T17:46:00.303

尝试观看“$err”（请参阅[​​此问题](https://stackoverflow.com/questions/159888/how-to-execute-getlasterror-while-debugging-in-visual-studio)）。还可以考虑查看讨论将“SetLastError”添加到您的 P/Invoke 调用的[这个问题。](https://stackoverflow.com/questions/763724/dllimport-preserversig-and-setlasterror-attributes)

# performance - NHibernate - CreateCriteria vs CreateAlias

> ID：899079
> 
> 赞同：27
> 
> 时间：2009-05-22T17:44:24.160
> 
> 标签：performance, nhibernate, criteria, icriteria

假设以下场景：

```
class Project{
   public Job Job;
}

class Job{
   public Name;
} 
```

假设我想使用 Criteria API 搜索其 Job 名称为“sumthing”的所有项目。

我可以使用 CreateAlias 为 Job 创建一个别名并使用它来访问 Name，或者我可以为属性 Job 创建一个新的 Criteria 并按 Name 搜索。

性能方面，有什么区别吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-28T14:11:46.387

鉴于这些要求没有区别，生成的 SQL 是相同的：对于映射：

```
 <?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
    <class name="Project" table="Project">
        <id name="Id" type="Int32" unsaved-value="0">
            <column name="Id" sql-type="int" not-null="true" unique="true"/>
            <generator class="native" />
        </id>
        <many-to-one name="Job" column="FK_JobId" cascade="save-update" not-null="true" />
    </class>
</hibernate-mapping>
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
    <class name="Job" table="Job">
        <id name="Id" type="Int32" unsaved-value="0">
            <column name="Id" sql-type="int" not-null="true" unique="true"/>
            <generator class="native" />
        </id>
        <property name="Name" type="String">
            <column name="Name" sql-type="nvarchar" length="50" not-null="true"/>
        </property>
    </class>
</hibernate-mapping> 
```

和班级

```
public class Project
    {
        public Project() { }

        public virtual int Id { get; set; }

        public virtual Job Job { get; set; }
    }
public class Job
    {
        public Job() { }

        public virtual int Id { get; set; }

        public virtual String Name { get; set; }
    } 
```

这些标准定义

```
ICriteria criteriacrit = session
  .CreateCriteria(typeof (Project))
  .CreateCriteria("Job", "job")
  .Add(Restrictions.Eq("job.Name", "sometextA"));

ICriteria aliascrit = session
  .CreateCriteria(typeof (Project))
  .CreateAlias("Job", "job")
  .Add(Restrictions.Eq("job.Name", "sometextB")); 
```

生成相同的 SQL

```
SELECT 
  this_.Id as Id2_1_, 
  this_.FK_JobId as FK2_2_1_, 
  job1_.Id as Id1_0_, 
  job1_.Name as Name1_0_ 
FROM 
  Project this_ 
  inner join Job job1_ 
    on this_.FK_JobId=job1_.Id 
WHERE job1_.Name = @p0; @p0 = 'sometextA'

SELECT 
  this_.Id as Id2_1_, 
  this_.FK_JobId as FK2_2_1_, 
  job1_.Id as Id1_0_, 
  job1_.Name as Name1_0_ 
FROM
  Project this_ 
  inner join Job job1_ 
    on this_.FK_JobId=job1_.Id 
WHERE job1_.Name = @p0; @p0 = 'sometextB' 
```

但是请注意，`CreateAlias`依赖于映射来生成关联，而`CreateCriteria`调用允许指定`JoinType`.

所以，这些电话

```
ICriteria criteriacrit = session
  .CreateCriteria(typeof(Project))
  .CreateCriteria("Job",JoinType.LeftOuterJoin)
  .Add(Restrictions.Eq("Name", "sometextA"));

ICriteria aliascrit = session
  .CreateCriteria(typeof (Project))
  .CreateAlias("Job", "job")
  .Add(Restrictions.Eq("job.Name", "sometextB")); 
```

生成这些 SQL 语句

```
SELECT 
  this_.Id as Id2_1_, 
  this_.FK_JobId as FK2_2_1_, 
  job1_.Id as Id1_0_, 
  job1_.Name as Name1_0_ 
FROM 
  Project this_ 
  **left outer** join Job job1_
    on this_.FK_JobId=job1_.Id 
WHERE job1_.Name = @p0; @p0 = 'sometextA'

SELECT 
  this_.Id as Id2_1_, 
  this_.FK_JobId as FK2_2_1_, 
  job1_.Id as Id1_0_, 
  job1_.Name as Name1_0_ 
FROM Project this_ 
  **inner join** Job job1_ 
    on this_.FK_JobId=job1_.Id 
WHERE job1_.Name = @p0; @p0 = 'sometextB' 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2011-02-12T02:23:24.310

为了解释 NHibernate 2.0 + 中 CreateCriteria 和 CreateAlias 之间的区别，让我们看看下面的域模型。

```
public class Product
{
    public virtual int Id { get; private set; }
    public virtual string Name { get; set; }
    public virtual decimal Price { get; set; }
    public virtual Category Category { get; set; }
    public virtual IList<ProductStock> ProductStocks { get; set; }
}

public class Category
{
    public virtual int Id { get; private set; }
    public virtual string Name { get; set; }
    public virtual IList<Product> Products { get; set; }
}

public class ProductStock
{
    public virtual int Id { get; private set; }
    public virtual Product Product { get; set; }
    public virtual string WarehouseName { get; set; }
    public virtual int Stock { get; set; }
} 
```

现在，如果您编写以下条件来内部连接这些实体

```
var criteria = DetachedCriteria.For<Product>()
                .CreateCriteria("Category", JoinType.InnerJoin)
                .CreateCriteria("ProductStocks", "ps", JoinType.InnerJoin)
                .Add(Restrictions.Le("ps.Stock",10)); 
```

上述条件不起作用，因为当第一个 CreateCriteria 运行时它返回“Category”实体，因此当第二个 CreateCriteria 执行时它不会在“Category”实体中找到属性 ProductStocks 并且查询将失败。

所以写这个标准的正确方法是

```
var criteria = DetachedCriteria.For<Product>()
                .CreateAlias("Category", "c", JoinType.InnerJoin)
                .CreateCriteria("ProductStocks", "ps", JoinType.InnerJoin)
                .Add(Restrictions.Le("ps.Stock",10)); 
```

当第一个 CreateAlias 运行时，它返回“Product”实体，当第二个 CreateCriteria 执行时，它将在“Product”实体中找到属性 ProductStocks。

所以TSQL会是这样的。

```
SELECT this_.ProductID     as ProductID8_2_,
       this_.Name          as Name8_2_,
       this_.Price         as Price8_2_,
       this_.CategoryID    as CategoryID8_2_,
       ps2_.ProductStockID as ProductS1_9_0_,
       ps2_.Stock          as Stock9_0_,
       ps2_.ProductID      as ProductID9_0_,
       ps2_.WarehouseID    as Warehous4_9_0_,
       c1_.CategoryID      as CategoryID0_1_,
       c1_.Name            as Name0_1_
FROM   [Product] this_
       inner join [ProductStock] ps2_ on this_.ProductID = ps2_.ProductID
       inner join [Category] c1_ on this_.CategoryID = c1_.CategoryID
WHERE  ps2_.Stock <= 10 
```

我希望这将有所帮助。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-09-02T11:14:12.153

createAlias() 以结果形式返回原始条件 createCriteria() 返回使用 createCriteria 构造的新条件

不同之处在于链接方法时，例如

cr.createAlias().add(Restrictions.ilike("code","abc")) 将限制实体 cr.createCriteria("parent","p").add(Restrictions.ilike("code"," abc")) 将对其父级添加限制

# linq - LINQ - 不存在的地方

> ID：899090
> 
> 赞同：47
> 
> 时间：2009-05-22T17:47:04.203
> 
> 标签：linq, exists

LINQ 中以下语句的等价物是什么：

```
Select t1.appname, t1.julianDte, t1.cat 
From table1 t1 
Where NOT EXISTS 
   ( Select * 
     from table t2 
     where t1.cat = t2.cat AND t2.julianDte < t1.julianDte ) 
```

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-05-22T17:52:32.260

试试这个`Not Any`模式。

```
var query = db.table1
.Where(t1 => !db.table2
  .Any(t2 => t2.cat == t1.cat && t2.julianDte < t1.julianDte)
); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-23T05:59:45.700

查询@Amy B 答案的语法版本（将 !Any 反转为 All）：

```
from t1 in db.Table1
where db.Table2.All(t2 => t1.cat != t2.cat || t2.julianDte >= t1.julianDte)
select new
{
    t1.appname,
    t1.julianDte,
    t1.cat
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-01T13:48:03.410

```
from t1 in Context.table1DbSet
let ok = 
    (from t2 in Context.table2DbSet 
     where t2.Idt1 = t1.Idt1 && t1.DateValid.HasValue
    ).Any()
where 
   t1.Active
   && !ok 
```

# nhibernate - 模拟 SQL 替换功能的 NHibernate 查询

> ID：899094
> 
> 赞同：1
> 
> 时间：2009-05-22T17:47:54.293
> 
> 标签：nhibernate

我有一个电话号码字段，其中可以包含许多不同的字符，例如“-”“。” "(" ")" 等 我想搜索电话号码，但我想排除特定字符。我不确定如何使用 NHibernate Criteria 或 HQL 模拟此功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-03T13:50:47.273

我最终使用了带有 SQL 限制的条件查询。是这样的

```
Session.CreateCriteria<EntityName>()
.Add(Restrictions.Sql(
"Replace('ColumnToSearch','PatternToFind', 'ReplaceWithValue')")) 
```

Sql Restriction 允许您运行与您提供的完全相同的 sql 语句。

# c - Arduino 串行读取

> ID：899098
> 
> 赞同：4
> 
> 时间：2009-05-22T17:50:05.787
> 
> 标签：c, serial-port, microcontroller, arduino

我正在开发一个网络控制的流动站，并使用串行端口与[Arduino](http://en.wikipedia.org/wiki/Arduino)通信。我写了一些 PHP，它只使用`fwrite()`ASCII 1 或 ASCII 2 并将其写入串行端口。Arduino 正在侦听该端口并根据它听到的内容执行操作。我知道我的 PHP 正在工作，因为每当我告诉它发送东西时，Arduino 都会收到它。这是Arduino代码：

```
//This listens to the serial port (USB) and does stuff based on what it is hearing.

int motor1Pin = 13; //the first motor's port number
int motor2Pin = 12; //the second motor's port number
int usbnumber = 0; //this variable holds what we are currently reading from serial

void setup() { //call this once at the beginning
    pinMode(motor1Pin, OUTPUT);
    //Tell arduino that the motor pins are going to be outputs
    pinMode(motor2Pin, OUTPUT);
    Serial.begin(9600); //start up serial port
}

void loop() { //main loop
    if (Serial.available() > 0) { //if there is anything on the serial port, read it
        usbnumber = Serial.read(); //store it in the usbnumber variable
    }

    if (usbnumber > 0) { //if we read something
        if (usbnumber = 49){
          delay(1000);
          digitalWrite(motor1Pin, LOW);
          digitalWrite(motor2Pin, LOW); //if we read an ASCII 1, stop
        }

        if (usbnumber = 50){
              delay(1000);
              digitalWrite(motor1Pin, HIGH);
              digitalWrite(motor2Pin, HIGH); //if we read an ASCII 2, drive forward
        }

        usbnumber = 0; //reset
    }
} 
```

所以这应该是相当直截了当的。现在，当我发送 ASCII 1 或 ASCII 2 时，我正在测试的 LED（在引脚 13 上）打开并保持亮起。但是，如果我发送另一个 ASCII 1 或 2，它会关闭然后重新打开。目标是仅在 ASCII 1 是最后发送的内容时才打开它，并一直保持到 2 是最后发送的内容。

编辑：这是我的 PHP：

```
<?php
    $verz="0.0.2";
    $comPort = "com3"; /*change to correct com port */

    if (isset($_POST["rcmd"])) {
        $rcmd = $_POST["rcmd"];
        switch ($rcmd) {
            case Stop:
                $fp =fopen($comPort, "w");
                fwrite($fp, chr(1)); /* this is the number that it will write */
                fclose($fp);

                break;
            case Go:
                $fp =fopen($comPort, "w");
                fwrite($fp, chr(2)); /* this is the number that it will write */
                fclose($fp);
                break;
            default:
                die('???');
        }
    }
?>
<html>
    <head><title>Rover Control</title></head>
    <body>
        <center><h1>Rover Control</h1><b>Version <?php echo $verz; ?></b></center>

        <form method="post" action="<?php echo $PHP_SELF;?>">
            <table border="0">
                <tr>
                    <td></td>
                    <td>

                    </td>
                    <td></td>
                </tr>
                <tr>
                    <td>
                        <input type="submit" value="Stop" name="rcmd"><br/>
                    </td>
                    <td></td>
                    <td>
                        <input type="submit" value="Go" name="rcmd"><br />
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td><br><br><br><br><br>

                    </td>
                    <td></td>
                </tr>
            </table>
        </form>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T18:05:32.580

如果它是 C 那么你在两个测试中都有**分配**而不是**比较**，所以两者都是`true`，所以每次都完成所有写入。以高警告级别编译（如`-Wall -pedantic`在 GCC 中）。试试这个：

```
 int a = 0;
if ( a == 1 ) printf( "a is not one: %d\n", a );
if ( a = 1 ) printf( "a is one: %d\n", a ); 
```

从您发布的 PHP 代码（我不是这里的专家）看来，您正在将二进制 1 编写为字符，这不是 ASCII 49，而是 ASCII 1 (soh)，与 2 相同。尝试将其更改为`'1'`PHP 代码（或`1`在 C 代码中。）

这是一篇关于[使用 PHP 控制串行端口的](http://www.communitymx.com/abstract.cfm?cid=8658A)文章的链接——我用谷歌搜索过，不知道它的质量——但看起来仅仅将一个整数写入“com1”是不够的——这超出了我的领域，祝你好运:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T18:16:25.293

正如 Nikolai 所提到的，您似乎在“if”语句中进行赋值（=）而不是比较（==）。

一些 C 程序员养成的一个好习惯是将右值放在比较的左侧，这样如果您不小心使用了赋值运算符而不是比较运算符，编译器就会产生错误：

```
if (50 == usbnumber) { // 这没关系。
    ...
}

if (50 = usbnumber) { // 编译器将在此处生成错误。
    ...
}

```

无论您使用什么编译器标志或警告级别，这都有效，因为分配给右值是非法的。

我应该补充一点，如果您需要比较两个左值，则此“安全网”不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-03T04:18:00.727

可能为时已晚，但我认为您的问题是*serial.read()*一次只能读取一个字符。如果您从 PC 发送“49”，当您调用*usbnumber = serial.read()*时，您将获得“4”第一个循环和“9”第二个循环。这些都不满足条件，所以什么都不做，usbnumber 被重置为 0。

要修复，您可以将 serial.available 条件更改为

```
if (Serial.available() == 2) 
```

然后执行以下操作以转换为数字：

```
usbnumber = Serial.read() * 10 + Serial.read(); 
```

另一种选择是使用 TextFinder 库 - 我在我的网站[http://mechariusprojects.com/thunderbolt/?p=60上写了一个简短的教程](http://mechariusprojects.com/thunderbolt/?p=60)

机甲

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-02T03:26:58.433

我发现您的答案正在寻找其他东西，无论如何我刚刚遇到（我猜）您遇到的同样问题。

如果您还没有解决它，我认为问题不在于您的代码，而在于 arduino 板上的自动重置机制。也就是说：每次在串口上建立新连接时，arduino 板都会重置，这允许在通过串口对其进行编程时加载新固件。

要验证这一点，请尝试在您的`setup()`函数中闪烁 LED，如果每次加载页面时它都会闪烁，这证实了我的论点。

看看这里：[http ://www.arduino.cc/playground/Main/DisablingAutoResetOnSerialConnection](http://www.arduino.cc/playground/Main/DisablingAutoResetOnSerialConnection)

我通过在 +5V 和 RESET 之间粘贴 120 欧姆电阻来解决。只要记住每次您想将新固件上传到您的电路板时将其删除即可。

# javascript - 是否可以使用 VBScript 或 JScript 来实例化 SharePoint 对象？

> ID：899100
> 
> 赞同：0
> 
> 时间：2009-05-22T17:51:02.527
> 
> 标签：javascript, sharepoint, vbscript

我希望能够使用 cscript.exe 在服务器上运行 VBScript 或 JScript，以通过对象模型操作 SharePoint。

例如，要更新日志文件位置：

```
Microsoft.SharePoint.Administration.SPDiagnosticsService serv = new Microsoft.SharePoint.Administration.SPDiagnosticsService();
serv.LogLocation = @"E:\";
serv.Update(); 
```

是否有可能做到这一点？

我知道我需要使用场管理员帐户运行此代码。我（还）无法访问 PowerShell，我也不想编译几十个小型命令行实用程序来完成这项工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T17:54:00.790

OTTOMH，如果您有相对简单的需求，您可能可以为您需要的类创建[可调用 COM 的包装器。](http://msdn.microsoft.com/en-us/library/f07c8z1c.aspx)我的猜测是，如果你不能使用 PowerShell，这将比它的价值更麻烦，并且一些小型控制台应用程序会更好地利用你的时间。

# apache-flex - 如何在 flex 树节点中自动换行

> ID：899101
> 
> 赞同：0
> 
> 时间：2009-05-22T17:51:26.410
> 
> 标签：apache-flex, tree

我的 Flex 代码中有一个 Tree 对象。它的宽度是 100%，它包含在一个宽度为 200 的面板中。我正在使用扩展 TreeItemRenderer 的自定义 itemrenderer。

如果它太大（经常发生），我需要每个节点中的文本进行自动换行。我努力了

```
label.wordWrap = true; 
```

在我的项目渲染器中没有任何运气。还有其他建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-12-02T10:23:41.973

使用默认的 TreeItemRenderer，您只需在树上设置两个属性即可启用 wordWrap：

```
tree.variableRowHeight = true;

tree.wordWrap = true; 
```

享受。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-01T16:50:39.703

如果 'label' 是 Label 组件的一个实例，那么无论您做什么，都无法将其包装起来，因为 Label 组件不支持包装。或者，更确切地说，仅用于单行文本。

如果您*使用*的是 Label 组件，请尝试使用 Text 组件。它旨在显示多行文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T17:54:21.570

标签上设置的高度是多少？是否有足够的空间让文本垂直移动？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T18:17:49.347

尝试将标签宽度设置为恒定宽度。如果您因为需要动态而无法执行此操作，那么您需要覆盖更新函数并设置标签的宽度。问题是标签在渲染时没有计算出实际的 100% 宽度，所以它不知道它是否必须变形。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-09T06:59:51.163

不要使用标签。使用 ' mx:Text width=" 100%" ' （文本宽度为 100%），它会自行换行。

# javascript - 如何将 javascript 函数存储在队列中以便最终执行

> ID：899102
> 
> 赞同：78
> 
> 时间：2009-05-22T17:51:27.143
> 
> 标签：javascript, function, timeout, queue

我在 javascript 中创建了一个 Queue 类，我想将函数作为数据存储在队列中。这样我就可以构建请求（函数调用）并在需要时响应它们（实际执行函数）。

有没有办法将函数存储为数据，有点类似于

```
.setTimeout("doSomething()", 1000); 
```

除了它会

```
functionQueue.enqueue(doSomething()); 
```

它将 doSomething() 存储为数据的位置，因此当我从队列中检索数据时，将执行该函数。

我猜我必须在引号中加上 doSomething() -> "doSomething()" 以及如何让它使用字符串调用函数，有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2009-05-22T17:56:52.063

所有函数实际上都是变量，因此将所有函数存储在数组中实际上非常容易（通过在没有 . 的情况下引用它们`()`）：

```
// Create your functions, in a variety of manners...
// (The second method is preferable, but I show the first for reference.)
function fun1() { alert("Message 1"); };
var fun2 = function() { alert("Message 2"); };

// Create an array and append your functions to them
var funqueue = [];
funqueue.push(fun1);
funqueue.push(fun2);

// Remove and execute the first function on the queue
(funqueue.shift())(); 
```

如果您想将参数传递给您的函数，这会变得有点复杂，但是一旦您设置了执行此操作的框架，此后每次都变得容易。本质上，您要做的是创建一个包装函数，该函数在被调用时会触发具有特定上下文和参数集的预定义函数：

```
// Function wrapping code.
// fn - reference to function.
// context - what you want "this" to be.
// params - array of parameters to pass to function.
var wrapFunction = function(fn, context, params) {
    return function() {
        fn.apply(context, params);
    };
} 
```

现在我们已经有了一个用于包装的实用函数，让我们看看它是如何用于创建未来的函数调用的：

```
// Create my function to be wrapped
var sayStuff = function(str) {
    alert(str);
}

// Wrap the function.  Make sure that the params are an array.
var fun1 = wrapFunction(sayStuff, this, ["Hello, world!"]);
var fun2 = wrapFunction(sayStuff, this, ["Goodbye, cruel world!"]);

// Create an array and append your functions to them
var funqueue = [];
funqueue.push(fun1);
funqueue.push(fun2);

// Remove and execute all items in the array
while (funqueue.length > 0) {
    (funqueue.shift())();   
} 
```

可以通过允许包装器使用数组或一系列参数来改进此代码（但这样做会混淆我正在尝试制作的示例）。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-07-08T15:03:33.480

> ## [此处](https://stackoverflow.com/a/17528961/561731)发布的规范答案

* * *

这是一个不错的 Queue 类，您可以在**不**使用超时的情况下使用：

```
var Queue = (function(){

    function Queue() {};

    Queue.prototype.running = false;

    Queue.prototype.queue = [];

    Queue.prototype.add_function = function(callback) { 
        var _this = this;
        //add callback to the queue
        this.queue.push(function(){
            var finished = callback();
            if(typeof finished === "undefined" || finished) {
               //  if callback returns `false`, then you have to 
               //  call `next` somewhere in the callback
               _this.next();
            }
        });

        if(!this.running) {
            // if nothing is running, then start the engines!
            this.next();
        }

        return this; // for chaining fun!
    }

    Queue.prototype.next = function(){
        this.running = false;
        //get the first element off the queue
        var shift = this.queue.shift(); 
        if(shift) { 
            this.running = true;
            shift(); 
        }
    }

    return Queue;

})(); 
```

它可以像这样使用：

```
var queue = new Queue;
queue.add_function(function(){
   //start running something
});
queue.add_function(function(){
   //start running something 2
});
queue.add_function(function(){
   //start running something 3
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-22T17:55:12.487

请参阅您存储的函数，最后没有 ()。 `doSomething`是一个变量（恰好是一个函数）；`doSomething()`是执行功能的指令。

稍后，当您使用队列时，您会想要类似的东西`(functionQueue.pop())()`——即执行functionQueue.pop，然后执行pop 调用的返回值。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-22T17:56:46.137

您还可以使用函数对象的**.call()**方法。

```
function doSomething() {
    alert('doSomething');
}

var funcs = new Array();

funcs['doSomething'] = doSomething;

funcs['doSomething'].call(); 
```

* * *

此外，还可以直接将函数添加到队列中：

```
funcs['somethingElse'] = function() {
    alert('somethingElse');
};

funcs['somethingElse'].call(); 
```

# python - 使用 Python 将列表写入文件

> ID：899103
> 
> 赞同：848
> 
> 时间：2009-05-22T17:52:18.297
> 
> 标签：python, file, list, file-io, newline

这是将列表写入文件的最干净的方法，因为`writelines()`不插入换行符？

```
file.writelines(["%s\n" % item  for item in list]) 
```

似乎有一个标准的方法......

* * *

## 回答 #1

> 赞同：1152
> 
> 时间：2009-05-22T18:04:21.523

您可以使用循环：

```
with open('your_file.txt', 'w') as f:
    for item in my_list:
        f.write("%s\n" % item) 
```

在 Python 2 中，您还可以使用

```
with open('your_file.txt', 'w') as f:
    for item in my_list:
        print >> f, item 
```

如果您热衷于单个函数调用，请至少删除方括号`[]`，以便一次打印一个字符串（一个 genexp 而不是一个 listcomp）——没有理由占用所有所需的内存实现整个字符串列表。

* * *

## 回答 #2

> 赞同：466
> 
> 时间：2009-05-22T18:10:04.960

你打算怎么处理这个文件？该文件是否存在于人类或具有明确互操作性要求的其他程序？

如果您只是尝试将列表序列化到磁盘以供同一个 python 应用程序稍后使用，那么您应该对列表进行[腌制](http://docs.python.org/library/pickle.html)。

```
import pickle

with open('outfile', 'wb') as fp:
    pickle.dump(itemlist, fp) 
```

读回来：

```
with open ('outfile', 'rb') as fp:
    itemlist = pickle.load(fp) 
```

* * *

## 回答 #3

> 赞同：384
> 
> 时间：2009-05-22T17:58:40.923

更简单的方法是：

```
with open("outfile", "w") as outfile:
    outfile.write("\n".join(itemlist)) 
```

您可以使用生成器表达式确保项目列表中的所有项目都是字符串：

```
with open("outfile", "w") as outfile:
    outfile.write("\n".join(str(item) for item in itemlist)) 
```

请记住，所有`itemlist`列表都需要在内存中，因此，请注意内存消耗。

* * *

## 回答 #4

> 赞同：102
> 
> 时间：2011-07-22T14:30:50.883

使用**Python 3**和**Python 2.6+**语法：

```
with open(filepath, 'w') as file_handler:
    for item in the_list:
        file_handler.write("{}\n".format(item)) 
```

这是独立于平台的。它还以换行符结束最后一行，这是[UNIX 最佳实践](https://stackoverflow.com/questions/729692/why-should-text-files-end-with-a-newline)。

从 Python 3.6 开始，`"{}\n".format(item)`可以用 f-string: 替换`f"{item}\n"`。

* * *

## 回答 #5

> 赞同：94
> 
> 时间：2009-05-22T18:20:19.343

还有一种方式。[使用simplejson](http://code.google.com/p/simplejson/)序列化为 json（在 python 2.6 中作为[json包含）：](http://docs.python.org/library/json.html)

```
>>> import simplejson
>>> f = open('output.txt', 'w')
>>> simplejson.dump([1,2,3,4], f)
>>> f.close() 
```

如果您检查 output.txt：

> [1、2、3、4]

这很有用，因为语法是 Python 式的，它是人类可读的，并且它可以被其他语言的其他程序读取。

* * *

## 回答 #6

> 赞同：40
> 
> 时间：2011-02-17T18:13:19.440

我认为探索使用 genexp 的好处会很有趣，所以这是我的看法。

问题中的示例使用方括号创建临时列表，因此相当于：

```
file.writelines( list( "%s\n" % item for item in list ) ) 
```

它不必要地构建了一个包含所有将被写出的行的临时列表，这可能会消耗大量内存，具体取决于列表的大小和输出的详细`str(item)`程度。

删除方括号（相当于删除`list()`上面的包装调用）会将临时[生成器](http://www.python.org/dev/peps/pep-0255/)传递给`file.writelines()`：

```
file.writelines( "%s\n" % item for item in list ) 
```

此生成器将`item`按需创建对象的换行符终止表示（即，当它们被写出时）。这很好，有几个原因：

*   内存开销很小，即使对于非常大的列表
*   如果`str(item)`速度很慢，则在处理每个项目时文件中都有可见的进度

* * *

这样可以避免内存问题，例如：

```
In [1]: import os

In [2]: f = file(os.devnull, "w")

In [3]: %timeit f.writelines( "%s\n" % item for item in xrange(2**20) )
1 loops, best of 3: 385 ms per loop

In [4]: %timeit f.writelines( ["%s\n" % item for item in xrange(2**20)] )
ERROR: Internal Python error in the inspect module.
Below is the traceback from this internal error.

Traceback (most recent call last):
...
MemoryError 
```

（我通过将 Python 的最大虚拟内存限制为 ~100MB 来触发此错误`ulimit -v 102400`）。

将内存使用放在一边，这种方法实际上并不比原始方法快：

```
In [4]: %timeit f.writelines( "%s\n" % item for item in xrange(2**20) )
1 loops, best of 3: 370 ms per loop

In [5]: %timeit f.writelines( ["%s\n" % item for item in xrange(2**20)] )
1 loops, best of 3: 360 ms per loop 
```

（Linux 上的 Python 2.6.2）

* * *

## 回答 #7

> 赞同：26
> 
> 时间：2017-08-10T20:55:23.650

因为我很懒......

```
import json
a = [1,2,3]
with open('test.txt', 'w') as f:
    f.write(json.dumps(a))

#Now read the file back into a Python list object
with open('test.txt', 'r') as f:
    a = json.loads(f.read()) 
```

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2015-11-18T08:51:01.530

使用逗号分隔值将列表序列化为文本文件

```
mylist = dir()
with open('filename.txt','w') as f:
    f.write( ','.join( mylist ) ) 
```

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2013-05-09T01:01:40.190

# 一般来说

以下是**writelines()**方法的语法

```
fileObject.writelines( sequence ) 
```

# 例子

```
#!/usr/bin/python

# Open a file
fo = open("foo.txt", "rw+")
seq = ["This is 6th line\n", "This is 7th line"]

# Write sequence of lines at the end of the file.
line = fo.writelines( seq )

# Close opend file
fo.close() 
```

# 参考

[http://www.tutorialspoint.com/python/file_writelines.htm](http://www.tutorialspoint.com/python/file_writelines.htm)

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2009-05-22T18:29:47.143

```
file.write('\n'.join(list)) 
```

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2020-05-05T15:03:43.330

在 python>3 中，您可以使用`print`and`*`进行参数解包：

```
with open("fout.txt", "w") as fout:
    print(*my_list, sep="\n", file=fout) 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2015-09-30T21:50:24.963

如果您在 python3 上，也可以使用 print 功能，如下所示。

```
f = open("myfile.txt","wb")
print(mylist, file=f) 
```

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2015-09-10T18:14:57.450

```
with open ("test.txt","w")as fp:
   for line in list12:
       fp.write(line+"\n") 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2020-08-13T13:11:35.683

使用`numpy.savetxt`也是一种选择：

```
import numpy as np

np.savetxt('list.txt', list, delimiter="\n", fmt="%s") 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2022-01-04T15:56:16.077

简单地：

```
with open("text.txt", 'w') as file:
    file.write('\n'.join(yourList)) 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2015-08-19T23:47:34.093

你为什么不试试

```
file.write(str(list)) 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2018-07-11T07:09:33.377

此逻辑将首先将列表中的项目转换为`string(str)`. 有时列表包含一个像

```
alist = [(i12,tiger), 
(113,lion)] 
```

此逻辑将在新行中写入每个元组的文件。我们稍后可以`eval`在读取文件时加载每个元组时使用：

```
outfile = open('outfile.txt', 'w') # open a file in write mode
for item in list_to_persistence:    # iterate over the list items
   outfile.write(str(item) + '\n') # write to the file
outfile.close()   # close the file 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2021-01-02T17:41:58.573

您还可以通过以下方式：

例子：

```
my_list=[1,2,3,4,5,"abc","def"]
with open('your_file.txt', 'w') as file:
    for item in my_list:
        file.write("%s\n" % item) 
```

输出：

在`your_file.txt`项目中保存如下：

```
1

2

3

4

5

abc

def 
```

您的脚本也按上述方式保存。

否则，您可以使用泡菜

```
import pickle
my_list=[1,2,3,4,5,"abc","def"]
#to write
with open('your_file.txt', 'wb') as file:
    pickle.dump(my_list, file)
#to read
with open ('your_file.txt', 'rb') as file:
    Outlist = pickle.load(file)
print(Outlist) 
```

输出：[1, 2, 3, 4, 5, 'abc', 'def']

当我们加载我们能够读取的列表时，它会保存与列表相同的列表。

也`simplejson`可能与上述输出相同

```
import simplejson as sj
my_list=[1,2,3,4,5,"abc","def"]
#To write
with open('your_file.txt', 'w') as file:
    sj.dump(my_list, file)

#To save
with open('your_file.txt', 'r') as file:
    mlist=sj.load(file)
print(mlist) 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2018-06-14T20:54:20.047

另一种迭代和添加换行符的方法：

```
for item in items:
    filewriter.write(f"{item}" + "\n") 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2021-09-15T18:37:36.047

我最近发现 Path 很有用。帮助我避免不得不`with open('file') as f`然后写入文件。希望这对某人有用:)。

```
from pathlib import Path
import json
a = [[1,2,3],[4,5,6]]
# write
Path("file.json").write_text(json.dumps(a))
# read
json.loads(Path("file.json").read_text()) 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-09-09T07:53:03.023

将标准输出重定向到文件也可能对此有用：

```
from contextlib import redirect_stdout
with open('test.txt', 'w') as f:
  with redirect_stdout(f):
     for i in range(mylst.size):
        print(mylst[i]) 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-09-29T00:42:12.927

我认为您正在寻找这样的答案。

```
f = open('output.txt','w')
list = [3, 15.2123, 118.3432, 98.2276, 118.0043]
f.write('a= {:>3d}, b= {:>8.4f}, c= {:>8.4f}, d= {:>8.4f}, e= 
{:>8.4f}\n'.format(*list))
f.close() 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-07-05T22:03:22.680

我建议这个解决方案。

```
with open('your_file.txt', 'w') as f:        
    list(map(lambda item : f.write("%s\n" % item),my_list)) 
```

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2020-01-28T09:46:45.100

在**Python3 中**你可以使用这个循环

```
with open('your_file.txt', 'w') as f:
    for item in list:
        f.print("", item) 
```

* * *

## 回答 #25

> 赞同：-2
> 
> 时间：2011-04-26T07:16:32.917

设 avg 为列表，然后：

```
In [29]: a = n.array((avg))
In [31]: a.tofile('avgpoints.dat',sep='\n',dtype = '%f') 
```

您可以使用`%e`或`%s`根据您的要求。

* * *

## 回答 #26

> 赞同：-4
> 
> 时间：2013-07-14T10:37:44.367

```
poem = '''\
Programming is fun
When the work is done
if you wanna make your work also fun:
use Python!
'''
f = open('poem.txt', 'w') # open for 'w'riting
f.write(poem) # write text to file
f.close() # close the file 
```

工作原理：首先，使用内置的 open 函数打开一个文件，并指定文件名和我们想要打开文件的模式。模式可以是读模式（'r'）、写模式（'w'）或附加模式（'a'）。我们还可以指定我们是在文本模式（'t'）还是二进制模式（'b'）中读取、写入或追加。实际上还有更多可用的模式，help(open) 将为您提供有关它们的更多详细信息。默认情况下，open() 将文件视为 't'ext 文件并以 'r'ead 模式打开它。在我们的示例中，我们首先以写入文本模式打开文件并使用文件对象的 write 方法写入文件，然后最后关闭文件。

**上面的例子来自 Swaroop C H.** [swaroopch.com的《A Byte of Python》一书](http://swaroopch.com/)

# html - 如何在 CSS 中做 width = 100% - 100px？

> ID：899107
> 
> 赞同：185
> 
> 时间：2009-05-22T17:52:50.620
> 
> 标签：html, css

在 CSS 中，我该如何做这样的事情：

```
width: 100% - 100px; 
```

我想这相当简单，但很难找到证明这一点的例子。

* * *

## 回答 #1

> 赞同：328
> 
> 时间：2013-01-16T20:30:59.833

现代浏览器现在支持：

```
width: calc(100% - 100px); 
```

要查看支持的浏览器版本列表，请查看：[我可以使用 calc() 作为 CSS 单位值吗？](http://caniuse.com/calc)

有一个 jQuery 后备：[css width: calc(100% -100px); 使用 jquery 的替代方法](https://stackoverflow.com/questions/11117216/css-width-calc100-100px-alternative-using-jquery?rq=1)

* * *

## 回答 #2

> 赞同：99
> 
> 时间：2009-05-22T17:57:06.213

你可以在一个 with 和里面嵌套一个`margin-left: 50px;`div`margin-right: 50px;`吗？`<div>``width: 100%;`

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2016-02-11T08:38:57.637

你可以试试这个...

```
<!--First Solution-->
width: calc(100% - 100px);
<!--Second Solution-->
width: calc(100vh - 100px);
```

vw：视口宽度

vh：视口高度

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-05-25T09:48:57.917

只有当我检查所有空间时，它才开始为我工作。所以，它不是这样工作的：`width: calc(100%- 20px)`或者`calc(100%-20px)`完美地与`width: calc(100% - 20px)`.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-11-26T17:43:18.503

我的代码，它适用于 IE6：

```
<style>
#container {margin:0 auto; width:100%;}
#header { height:100px; background:#9c6; margin-bottom:5px;}
#mainContent { height:500px; margin-bottom:5px;}
#sidebar { float:left; width:100px; height:500px; background:#cf9;}
#content { margin-left:100px; height:500px; background:#ffa;}

</style>

<div id="container">
  <div id="header">header</div>
  <div id="mainContent">
    <div id="sidebar">left</div>
    <div id="content">right 100% - 100px</div>
  <span style="display:none"></span></div>
</div> 
```

![在此处输入图像描述](https://i.stack.imgur.com/i7gKD.png)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-22T18:18:30.033

您需要为您希望 100% - 100px 的内容 div 准备一个容器

```
#container {
   width: 100%
}
#content {
   margin-right:100px;
   width:100%;
}

<div id="container">
  <div id="content">
      Your content here
  </div>
</div> 
```

`</div>`如果您的内容 div 溢出，您可能需要在最后一个之前添加一个清除 div 。

```
<div style="clear:both; height:1px; line-height:0">&nbsp;</div> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-22T18:19:11.747

将主体边距设置为 0，将外部容器的宽度设置为 100%，并使用具有 50 像素左右边距的内部容器似乎可以工作。

```
<style>
body {
    margin: 0;
    padding: 0;
}

.full-width
{
    width: 100%;
}

.innerContainer
{
    margin: 0px 50px 0px 50px;
}
</style>

<body>
  <div class="full-width" style="background-color: #ff0000;">
    <div class="innerContainer" style="background-color: #00ff00;">
      content here
    </div>
  </div>
</body> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-03-07T14:05:25.833

使用引导面板，我正在寻找如何在标题面板中放置“删除”链接，这不会被长邻居元素遮挡。这是解决方案：

html:

```
<div class="with-right-link">
    <a class="left-link" href="#">Long link header Long link header</a>
    <a class="right-link" href="#">Delete</a>
</div> 
```

CSS：

```
.with-right-link { position: relative; width: 275px; }
a.left-link { display: inline-block; margin-right: 100px; }
a.right-link { position: absolute; top: 0; right: 0; } 
```

当然，您可以根据缩进修改“顶部”和“右侧”值。[资源](https://jsfiddle.net/w0mwuye7/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-22T17:56:15.577

你能做到吗：

```
margin-right: 50px;
margin-left: 50px; 
```

**编辑：** 我的解决方案是错误的。Aric TenEyck 发布的解决方案建议使用宽度为 100% 的 div，然后使用边距嵌套另一个 div 似乎更正确。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-03-22T04:28:31.757

对于这种常见情况，有两种技术可以派上用场。每个都有其缺点，但有时两者都有用。

**box-sizing：border-box**包括填充和边框宽度在一个项目的宽度。例如，如果将具有 20px 20px padding 和 1px 边框的 div 的宽度设置为 100px，则实际宽度将为 142px，但使用边框框，padding 和 margin 都在 100px 之内。

```
.bb{
    -webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
    -moz-box-sizing: border-box;    /* Firefox, other Gecko */
    box-sizing: border-box;     
    width: 100%;
    height:200px;
    padding: 50px;
} 
```

这是一篇关于它的优秀文章：[http](http://css-tricks.com/box-sizing/) ://css-tricks.com/box-sizing/这是一个小提琴[http://jsfiddle.net/L3Rvw/](http://jsfiddle.net/L3Rvw/)

然后是**位置：绝对**

```
.padded{
    position: absolute;
    top: 50px;
    right: 50px;
    left: 50px;
    bottom: 50px;
    background-color: #aefebc;
} 
```

[http://jsfiddle.net/Mw9CT/1/](http://jsfiddle.net/Mw9CT/1/)

当然，两者都不是完美的，box-sizing 并不完全适合这个问题，因为元素实际上是 100% 宽度，而不是 100% - 100px（但是子 div 会是）。而且绝对定位绝对不能在所有情况下都使用，但通常只要设置了父高度就可以了。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-22T18:19:51.277

外部 div 上的填充将获得所需的效果。

```
<html>
<head>
<style>
    #outer{
        padding: 0 50px;
        border:1px solid black; /*for visualization*/
    }

    #inner{
        border:1px solid red; /*for visualization*/
    }
</style>
</head>
<body>
<div id="outer">
    <div id="inner">
        100px smaller than outer
    </div>
</div>
</body>
</html> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-09-17T17:24:39.763

您可以考虑使用[LESS](http://lesscss.org/)，这是一个预处理 CSS 的 JavaScript 文件，因此您可以在 CSS 中包含逻辑和变量。因此，对于您的示例，在 LESS 中，您将编写`width: 100% - 100px;`以实现您想要的内容:)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-22T17:57:45.027

**CSS 不能用于动画，或对事件的任何样式修改。**

唯一的方法是使用 javascript 函数，它将返回给定元素的宽度，然后减去 100px，并设置新的宽度大小。

假设您使用的是 jQuery，您可以执行以下操作：

```
oldWidth = $('#yourElem').width();
$('#yourElem').width(oldWidth-100); 
```

并使用本机 javascript：

```
oldWidth = document.getElementById('yourElem').clientWidth;
document.getElementById('yourElem').style.width = oldWidth-100+'px'; 
```

我们假设你有一个 100% 的 CSS 样式集；

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-22T18:04:07.653

```
<div style="width: 200px; border: 1px solid red;">
    <br>
    <div style="margin: 0px 50px 0px 50px; border: 1px solid blue;">
        <br>
    </div>
    <br>
</div> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-22T18:20:04.927

你用的是标准模式吗？我认为这个解决方案取决于它。

如果您尝试制作 2 列，则可以执行以下操作：

```
<div id="outer">
    <div id="left">
        sidebar
    </div>
    <div id="main">
        lorem ispsum etc... 
    </div>
</div> 
```

然后使用 CSS 对其进行样式设置：

```
div#outer
{
    width:100%;
    height: 500px;
}

div#left
{
    width: 100px;
    height: 100%;
    float:left;
    background: green;
}

div#main
{
   width: auto;
   margin-left: 100px; /* same as div#left width */
   height: 100%;
   background:red;
} 
```

如果您不想要 2 列，则可以删除`<div id="left">`

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-05-22T17:56:14.703

你不能。

但是，您可以使用边距来产生相同的结果。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2016-01-22T16:25:13.900

这有效：

```
margin-right:100px;
width:auto; 
```

* * *

## 回答 #18

> 赞同：-3
> 
> 时间：2009-05-22T17:55:54.187

简短的回答是你不要在 CSS 中这样做。Internet Explorer 支持一种叫做 CSS 表达式的东西，但这不是标准的，并且绝对不受其他浏览器（例如 FireFox）的支持。

您最好在 JavaScript 中执行此操作。

# c# - C# 如何在 C# 中定位网页上的表单？

> ID：899112
> 
> 赞同：0
> 
> 时间：2009-05-22T17:53:53.520
> 
> 标签：c#

我正在编写一个应用程序，该应用程序需要能够定位到指定的 URL，然后在加载网站时自动为弹出的表单输入用户名和密码。

如何在 C# 中以编程方式实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T18:04:21.710

您应该能够使用[System.Net.WebRequest](http://msdn.microsoft.com/en-us/library/system.net.webrequest.aspx)并执行 HTTP POST 来执行此操作。 [这](http://www.artoftest.com/home.aspx)是一个这样做的例子。

如果由于某种原因这是一些奇怪的网页并且 POST 不起作用，另一种选择是使用浏览器自动化框架，如[http://watin.sourceforge.net/](http://watin.sourceforge.net/)或[WebAii](http://www.artoftest.com/home.aspx)来自动化浏览器来执行此操作，但我不'不推荐这个，除非你真的不能这样做，因为它会更慢，可能不那么健壮并且一般来说更痛苦。

# latex - 当你编写 TeX 源码时，你如何使用你的编辑器的自动换行？

> ID：899114
> 
> 赞同：36
> 
> 时间：2009-05-22T17:53:59.183
> 
> 标签：latex, editor, word-wrap, tex

您是否使用“硬换行”（您自己或由您的编辑器自动）通过在源文档中以一定的行长插入换行符，或者您是否将段落写在一个连续的行中并让您的编辑器为您“软换行” ?

另外，你用什么编辑器来做这个？

注意：我感兴趣的是如何在 TeX 源代码（.tex 文件，一般散文）中换行，而不是 TeX 如何为最终文档换行。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-07-16T06:30:16.257

*我最近切换到每个句子的硬包装（即，仅*在句子结束后换行；行和句子之间的一对一映射）有两个原因：

*   整个段落的软包装使得在版本控制差异中无法发现拼写错误。
*   硬包装的段落看起来不错，直到您开始编辑它们，如果您重新排列硬包装的段落，您最终会在差异中更改一大堆行，可能会更改一个单词。

只有每个句子换行才能解决这两个问题：

*   在差异中比较容易发现小的变化。
*   不重新排列文本，仅更改、插入或删除单行。

当你第一次看到它时看起来有点奇怪，但这是我见过的唯一一种解决软包装和硬包装两个问题的折衷方案。

当然，如果您正在协作工作，答案是使用其他人正在使用的任何东西。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T18:41:27.547

我使用 Emacs（带有 AUCTeX）。在编辑或写完一段之后，我点击 Mq 来硬包装它。它还处理缩进项目，它还格式化注释段落。我不喜欢软包装，因为它们在视觉上与真正的换行符没有区别，但表现不同。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-22T18:07:43.933

我通常让我的 LaTeX 编辑器软换行。我认为部分原因是我在第一次学习 LaTeX 时遇到了一些关于大量空白的糟糕经历，部分原因是我不喜欢在编辑文本时出现严重锯齿状的右边距文件。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-22T18:18:53.527

根据您使用的操作系统，我推荐[winedt](http://www.winedt.com/) (windows) 和[kile](http://kile.sourceforge.net/) (linux)。这两种软包装，都不需要硬包装。（也就是说，我将我的段落作为源代码中的长行） Latex 整理输出中的换行符，当我阅读源代码时，我使用我的编辑器。

使用硬换行符的唯一可能原因是更容易在代码中找到错误（编译器通过行号指示）但它们通常不难找到，如果主要是文本，无论如何错误很少见。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-22T18:02:56.173

通常我让我的编辑器插入换行符。也就是说，我尽量不按“enter”键换行，但是当编辑器软换行时，它实际上插入了一个换行符。

我是用vim来完成这个的，不知道其他编辑器有没有这个功能或者是怎么工作的。具体来说，我使用[wrapmargin](http://www.vim.org/htmldoc/options.html#%27wrapmargin%27)功能。

为了清晰和一致，我通常会尝试将我的代码行（TeX 或其他）保持在 n 个字符的长度。我倾向于使用 80 个字符，但这取决于你。

更多与 vim 相关的换行文档：

[http://www.vim.org/htmldoc/usr_25.html](http://www.vim.org/htmldoc/usr_25.html)

[http://www.vim.org/htmldoc/options.html#%27textwidth%27](http://www.vim.org/htmldoc/options.html#%27textwidth%27)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-05T21:09:54.060

尽管我更喜欢使用软包装，但出于一个实际原因，我最终还是使用了硬包装：我所有的合作者都这样做。所以，当我和某人一起写一篇文章时，软包装而另一个人硬包装对我来说会很痛苦。第二个原因是 Emacs 直到最近才能够正确处理硬包装。我目前使用的 Emacs 23 改变了这一点，但是每个人都升级到 23 还需要很长时间，所以我可以偷偷将软包装文本发送给他们。

我实际使用硬包装的方式是打开自动填充模式。此外，Mq 绑定到 LaTeX-fill-paragraph（在 AucTeX 模式下 - 但我不记得这是标准绑定还是我的绑定之一 - 我很确定是后者）。结合这两者，我设法使我的 TeX 源或多或少地格式化。

顺便说一句，我听说过总是在一行的开头开始一个新句子的建议。换句话说，句末的句号后面应该是硬回车。好处是它可以很好地与版本控制系统配合使用，因为对句子的更改可以保持本地化。我认为这原则上是一个好主意，但由于我对 Mq 的强迫性使用，我没有设法使用它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-22T17:57:11.970

我倾向于使用 TeX 进行硬包装，但这更多地源于我对文本格式的痴迷，而不是任何真正的效率提升。我不喜欢软包装的一件主要事情是，它倾向于（在我看来，显然）通过在语义上随机的地方进行包装来使事情更难阅读。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-11-19T21:11:21.470

我在 Linux 下使用带有硬包装的 Kile（在 Kile 中称为静态自动换行），因为显然在我的工作环境中，每个人都这样做。软包装对我来说更有意义，所以如果我可以选择，我会使用它而不是硬包装。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-31T16:34:05.440

我主要在乔工作。我不时按自动输入，如果看起来不好，我按自动格式化（ctrl-k j）。

乔有自动换行模式，但我什至不打扰。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-12-03T06:49:58.423

我使用关闭自动换行符的 Auctex，然后手动插入换行符。我避免自动格式化，因为我希望对文档编辑之间的换行位置进行少量更改，这使得差异不那么混乱。

使用更智能的差异，一个不关心与 tex 无关的空白，会更好，但这是我使用的工具。

我喜欢威尔关于每句话都用硬包装的建议。我以前想过，但我的习惯是固定的。

# vb.net - 如何在 VB.NET 中检测按键？

> ID：899125
> 
> 赞同：0
> 
> 时间：2009-05-22T17:55:24.283
> 
> 标签：vb.net, keypress

如何让 VB 不断检查按键？
逐步调试时会检测到按键，但仅此而已:(
到目前为止，这是我的按键代码：

```
Private Sub Form_Main_KeyPress(ByVal sender As System.Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles MyBase.KeyPress
    'Keypress Q, A, or Z if the picture is seen for the first time
    'Otherwise one accuracy point is deducted
    If e.KeyChar = Chr(97) Then 'key a
        If PictureBox.Visible = True Then
            If MainArray(X) = 1 Then
                Timer_End = TimeOfDay.Millisecond
                PictureBox.Image.Dispose()
                PictureBox.Image = Nothing
                PictureBox.Visible = False
                Accuracy = Accuracy + 1
                CalcTime()
            Else
                Timer_End = TimeOfDay.Millisecond
                PictureBox.Image.Dispose()
                PictureBox.Image = Nothing
                PictureBox.Visible = False
                Accuracy = Accuracy - 1
                CalcTime()
            End If
        End If
    End If

    'Keypress for second occurance
    If e.KeyChar = Chr(108) Then 'key l
        If PictureBox.Visible = True Then
            If MainArray(X) = 2 Then
                Timer_End = TimeOfDay.Millisecond
                PictureBox.Image.Dispose()
                PictureBox.Image = Nothing
                PictureBox.Visible = False
                Accuracy = Accuracy + 1
                CalcTime()
            Else
                Timer_End = TimeOfDay.Millisecond
                PictureBox.Image.Dispose()
                PictureBox.Image = Nothing
                PictureBox.Visible = False
                Accuracy = Accuracy - 1
                CalcTime()
            End If
        End If
    End If
End Sub 
```

我尝试将此添加到代码中，但没有帮助：

```
 Private Sub BackgroundWorker1_DoWork(ByVal sender As System.Object, ByVal e As System.ComponentModel.DoWorkEventArgs) Handles BackgroundWorker1.DoWork
    Do While PictureBox.Visible = True
        Application.DoEvents()
    Loop
    End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-10T19:45:40.697

此链接可能会有所帮助：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.aspx#](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.aspx#)

还应该有通过 KeyEventArgs 类检测某些按键的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T18:14:36.950

Form.KeyPress 应该在每次按下一个键时被提升。无论您是否正在调试，都应该调用您的事件处理程序。也许它被调用了，但它并没有按照你的预期做？尝试放置一些调试输出语句以确认正在调用事件处理程序。

# asp.net - BC30560：“default_aspx”在命名空间“ASP”中不明确

> ID：899130
> 
> 赞同：8
> 
> 时间：2009-05-22T17:56:21.533
> 
> 标签：asp.net, ambiguous

当我编译我最新的 asp.net 程序并尝试在测试服务器上运行时，我收到了这个错误

```
Line 46:             Dim dependencies() As String
Line 47:             CType(Me,Global.System.Web.UI.Page).AppRelativeVirtualPath = "~/default.aspx"
Line 48:             If (Global.ASP.default_aspx.__initialized = false) Then
Line 49:                 dependencies = New String(0) {}
Line 50:                 dependencies(0) = "~/default.aspx"

Source File: C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\ocbuild\c0c442ff\f0292c99\App_Web_default.aspx.cdcab7d2.4ubu1wgu.0.vb    Line: 48 
```

展开编译器输出时的详细错误...

```
Microsoft (R) Visual Basic Compiler version 8.0.50727.3053
for Microsoft (R) .NET Framework version 2.0.50727.3053
Copyright (c) Microsoft Corporation.  All rights reserved.

C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\ocbuild\c0c442ff\f0292c99\App_Web_default.aspx.cdcab7d2.4ubu1wgu.0.vb(48) : error BC30560: 'default_aspx' is ambiguous in the namespace 'ASP'.

            If (Global.ASP.default_aspx.__initialized = false) Then
                ~~~~~~~~~~~~~~~~~~~~~~~                            
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\ocbuild\c0c442ff\f0292c99\App_Web_default.aspx.cdcab7d2.4ubu1wgu.0.vb(51) : error BC30560: 'default_aspx' is ambiguous in the namespace 'ASP'.

                Global.ASP.default_aspx.__fileDependencies = Me.GetWrappedFileDependencies(dependencies)
                ~~~~~~~~~~~~~~~~~~~~~~~                                                                 
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\ocbuild\c0c442ff\f0292c99\App_Web_default.aspx.cdcab7d2.4ubu1wgu.0.vb(52) : error BC30560: 'default_aspx' is ambiguous in the namespace 'ASP'.

                Global.ASP.default_aspx.__initialized = true
                ~~~~~~~~~~~~~~~~~~~~~~~                     
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\ocbuild\c0c442ff\f0292c99\App_Web_default.aspx.cdcab7d2.4ubu1wgu.0.vb(76) : error BC30560: 'default_aspx' is ambiguous in the namespace 'ASP'.

        Private Sub __BuildControlTree(ByVal __ctrl As default_aspx)
                                                       ~~~~~~~~~~~~ 
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\ocbuild\c0c442ff\f0292c99\App_Web_default.aspx.cdcab7d2.4ubu1wgu.0.vb(100) : error BC30560: 'default_aspx' is ambiguous in the namespace 'ASP'.

            Me.AddWrappedFileDependencies(Global.ASP.default_aspx.__fileDependencies)
                                          ~~~~~~~~~~~~~~~~~~~~~~~                    
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\ocbuild\c0c442ff\f0292c99\App_Web_default.aspx.cdcab7d2.4ubu1wgu.1.vb(31) : error BC30560: 'default_aspx' is ambiguous in the namespace 'ASP'.

            Return New ASP.default_aspx
                       ~~~~~~~~~~~~~~~~ 
```

我检查了一些东西，结果都没有问题：

[*] 默认值没有在任何地方定义两次

[*] 1 周前的最后一个版本一切正常

[*] 没有旧文件仍然保留在已编译文件中。我也多次清除了临时文件。

[*] 我尝试过使用其他 aspx 文件，但它们都给出了模棱两可的错误（不同源文件中的错误...）

[*] 原始来源工作得很好！只有错误显示在编译的代码上。

关于如何解决这种歧义的任何想法或任何线索。

谢谢SK

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T09:54:39.620

我刚刚通过以下链接的帮助解决了这个问题：http: [//www.netomatix.com/development/usercontrols2.aspx](http://www.netomatix.com/development/usercontrols2.aspx)

将此添加到 aspx 或 ascx 页面 ClassName="MyModule"

```
 <%@ Control Language="vb" AutoEventWireup="false" CodeBehind="MyModule.ascx.vb" ClassName="MyModule" %> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T15:42:06.783

好的，这是我在这个问题上花了三天后发现的。

最后我想如果我从解决方案中删除所有项目，除了一个（导致问题），我可以将它隔离到 default.skin。这个问题似乎非常不稳定，因为如果我从这个文件中删除某些行，它就会开始消失。然而，这并不一致，问题来来去去都是随机的。

因此，在失去了在代码中修复它的所有希望之后，我决定尝试另一种方式。我将 aspnet_compiler 命令的选项从 -prefix 开关（为每个文件夹创建一个 dll）更改为 -o（所有编译的 ui 都放在一个 dll 中），问题消失了！！！

看来问题是由于 aspnet_compiler 中的一些错误造成的。它以某种我无法弄清楚的方式在这个版本中被触发。

我正在考虑转向更稳定的 asp.net 3.5SP1（或者等待 asp.net 4.0）有什么建议吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-12T18:00:53.880

在更改使用项目引用的库的名称/命名空间时，我在使用项目时遇到了这个问题。

问题是使用项目 Bin 文件夹具有每个名称/命名空间名称的 DLL 副本。

删除消费项目 Bin 文件夹并重建解决。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T18:06:56.010

我发现混合命名空间真的会让事情变得混乱。

清理它的最佳方法是删除 Web 项目中的所有命名空间声明，并确保它们在依赖项目中保持一致。不要忘记检查项目属性和生成的 .designer.vb 文件。

此外，听起来您有一个名为 ASP 的顶级目录 - 这也可能无济于事。我会完全摆脱那个目录，看看这是否有助于解决问题。不久前我确实将此作为错误报告给 MS，甚至为他们提供了一个可重现的示例，但从未收到他们的任何回复。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-10T22:00:34.513

我通过将命名空间放在类之上解决了这个问题

```
Namespace yournamespace

Public Class yourclass name

end class

end Namespace 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-20T09:19:03.263

您需要确保用户控件也与页面一起复制到您的测试服务器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-16T08:31:16.447

我们在测试服务器上遇到了同样的问题。我们在 bin 文件中找到了我们的应用程序 dll 的副本。它的名称与原始 dll 略有不同（其中缺少一个“.”），但它包含相同的类型。我们删除了它，一切又开始工作了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-03-06T13:17:25.133

在我检查了与塞缪尔相同的项目后：

[*] 默认值在任何地方都没有定义两次
[*] 1 周前在其他计算机上一切正常
[*] 没有旧文件仍然保留在已编译的文件中。我也多次清除了临时文件。
[*] 我尝试过使用其他 aspx 文件，但它们都给出了模棱两可的错误（不同源文件中的错误...）
[*] 原始源工作得很好！只有错误显示在编译的代码上。
(...)

我只是让我的代码在 VS-2015 和 CMD 窗口中执行：

```
C:\Windows\Microsoft.NET\Framework\v4.0.30319>aspnet_compiler -v / -p "C:\inetpub\wwwroot\projectFolder" 
```

一切都运行良好，没有任何错误。

后续在 VS-2015 环境下编译也OK。

# java - Java 中类似 Python 的列表推导

> ID：899138
> 
> 赞同：64
> 
> 时间：2009-05-22T17:57:13.857
> 
> 标签：java, python, parameters, methods, list-comprehension

由于 Java 不允许将方法作为参数传递，您使用什么技巧在 Java 中实现类似于列表推导的 Python ？

我有一个字符串列表（ArrayList）。我需要使用一个函数来转换每个元素，以便获得另一个列表。我有几个函数将一个字符串作为输入并返回另一个字符串作为输出。如何制作一个可以将列表和函数作为参数提供的通用方法，以便我可以在处理每个元素时返回一个列表。从字面上看是不可能的，但是我应该使用什么技巧呢？

另一种选择是为每个较小的字符串处理函数编写一个新函数，该函数简单地循环整个列表，这有点不太酷。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2013-05-24T09:52:55.317

在 Java 8 中，您可以使用方法引用：

```
List<String> list = ...;
list.replaceAll(String::toUpperCase); 
```

或者，如果你想创建一个新的列表实例：

```
List<String> upper = list.stream().map(String::toUpperCase).collect(Collectors.toList()); 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-05-22T18:03:05.003

基本上，您创建一个 Function 接口：

```
public interface Func<In, Out> {
    public Out apply(In in);
} 
```

然后将匿名子类传递给您的方法。

您的方法可以就地将该函数应用于每个元素：

```
public static <T> void applyToListInPlace(List<T> list, Func<T, T> f) {
    ListIterator<T> itr = list.listIterator();
    while (itr.hasNext()) {
        T output = f.apply(itr.next());
        itr.set(output);
    }
}
// ...
List<String> myList = ...;
applyToListInPlace(myList, new Func<String, String>() {
    public String apply(String in) {
        return in.toLowerCase();
    }
}); 
```

或创建一个新的`List`（基本上是创建从输入列表到输出列表的映射）：

```
public static <In, Out> List<Out> map(List<In> in, Func<In, Out> f) {
    List<Out> out = new ArrayList<Out>(in.size());
    for (In inObj : in) {
        out.add(f.apply(inObj));
    }
    return out;
}
// ...
List<String> myList = ...;
List<String> lowerCased = map(myList, new Func<String, String>() {
    public String apply(String in) {
        return in.toLowerCase();
    }
}); 
```

哪个更可取取决于您的用例。如果您的列表非常大，就地解决方案可能是唯一可行的解​​决方案；如果您希望将许多不同的功能应用于同一个原始列表以制作许多衍生列表，您将需要该`map`版本。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-05-22T18:02:12.570

[Google Collections 库](http://code.google.com/p/google-collections/)有很多类用于处理集合和迭代器，它们比普通 Java 支持的级别高得多，并且以功能方式（过滤器、映射、折叠等）。它定义了 Function 和 Predicate 接口以及使用它们来处理集合的方法，因此您不必这样做。它还具有方便的功能，使处理 Java 泛型变得不那么困难。

我还使用[Hamcrest](http://hamcrest.googlecode.com) ** 来过滤集合。

这两个库很容易与适配器类结合使用。

* * *

** 利益声明：我共同撰写了 Hamcrest

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-22T18:54:46.150

Apache Commons [CollectionsUtil.transform(Collection, Transformer)](http://commons.apache.org/collections/api-release/org/apache/commons/collections/CollectionUtils.html#transform(java.util.Collection,%20org.apache.commons.collections.Transformer)) 是另一种选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-18T18:58:19.817

我正在构建这个项目以用 Java 编写列表理解，现在是[https://github.com/farolfo/list-comprehension-in-java中的概念证明](https://github.com/farolfo/list-comprehension-in-java)

例子

```
// { x | x E {1,2,3,4} ^ x is even }
// gives {2,4}

Predicate<Integer> even = x -> x % 2 == 0;

List<Integer> evens = new ListComprehension<Integer>()
    .suchThat(x -> {
        x.belongsTo(Arrays.asList(1, 2, 3, 4));
        x.is(even);
    });
// evens = {2,4}; 
```

如果我们想以某种方式转换输出表达式，例如

```
// { x * 2 | x E {1,2,3,4} ^ x is even }
// gives {4,8}

List<Integer> duplicated = new ListComprehension<Integer>()
    .giveMeAll((Integer x) -> x * 2)
    .suchThat(x -> {
        x.belongsTo(Arrays.asList(1, 2, 3, 4));
        x.is(even);
    });
// duplicated = {4,8} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-23T12:29:58.020

您可以对函数使用 lambda，如下所示：

```
class Comprehension<T> {
    /**
    *in: List int
    *func: Function to do to each entry
    */
    public List<T> comp(List<T> in, Function<T, T> func) {
        List<T> out = new ArrayList<T>();
        for(T o: in) {
            out.add(func.apply(o));
        }
        return out;
    }
} 
```

用法：

```
List<String> stuff = new ArrayList<String>();
stuff.add("a");
stuff.add("b");
stuff.add("c");
stuff.add("d");
stuff.add("cheese");
List<String> newStuff = new Comprehension<String>().comp(stuff, (a) -> { //The <String> tells the comprehension to return an ArrayList<String>
    a.equals("a")? "1": 
            (a.equals("b")? "2": 
                (a.equals("c")? "3":
                    (a.equals("d")? "4": a
    )))
}); 
```

将返回：

```
["1", "2", "3", "4", "cheese"] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-05T23:59:17.140

```
import java.util.Arrays;

class Soft{
    public static void main(String[] args){
        int[] nums=range(9, 12);
        System.out.println(Arrays.toString(nums));
    }
    static int[] range(int low, int high){
        int[] a=new int[high-low];
        for(int i=0,j=low;i<high-low;i++,j++){
            a[i]=j;
        }
        return a;

    }
} 
```

希望，我可以帮助你:)

# iphone - 如何在 iPhone 上的 UITableView 中设置单元格的背景颜色？

> ID：899140
> 
> 赞同：4
> 
> 时间：2009-05-22T17:57:23.797
> 
> 标签：iphone, objective-c

如何在 UITableView 中设置单元格的背景颜色？

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-04-22T02:15:27.960

我知道这是一个旧帖子，但我相信有些人仍在寻求帮助。您可以使用它来设置单个单元格的背景颜色，它首先起作用：

```
-(UITableViewCell*)tableView:(UITableView*)tableView cellForRowAtIndexPath:(NSIndexPath*)indexPath {
     [cell setBackgroundColor:[UIColor lightGrayColor]]; 
```

但是，一旦您开始滚动，iphone 将重用单元格，这些单元格会混淆不同的背景颜色（如果您尝试交替它们）。您需要调用 tableView:willDisplayCell:forRowAtIndexPath。这样，在加载重用标识符之前设置背景颜色。你可以这样做：

```
- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath {
     cell.backgroundColor = ([indexPath row]%2)?[UIColor lightGrayColor]:[UIColor whiteColor];
} 
```

最后一行只是一个精简的 if/else 语句。祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T18:18:14.183

**更新**

显然，现有的 UITableViewCell 框架使得更改单元格的背景颜色并使其在所有状态更改（编辑模式等）中正常工作变得非常困难。

[在这个 SO question](https://stackoverflow.com/questions/400965/how-to-customize-the-background-border-colors-of-a-grouped-table-view)上发布了一个解决方案，并且在多个论坛上被称为“Apple 工程师批准的唯一解决方案”。它涉及子类化 UITableViewCell 并为子类化单元格的`backgroundView`属性添加自定义视图。

**原始帖子**- 此解决方案不能完全工作，但在某些情况下可能仍然有用

如果您已经拥有 UITableViewCell 对象，只需更改它`contentView`的`backgroundColor`属性。

如果需要创建具有自定义背景颜色的 UITableViewCells，则过程会更长一些。首先，您需要为您的 UITableView 创建一个数据源——这可以是任何实现该`UITableViewDataSource`协议的对象。

在该对象中，您需要实现该`tableView:cellForRowAtIndexPath:`方法，该方法在给定表格中单元格位置的 NSIndexPath 时返回 UITableViewCell。创建该单元格时，您需要更改`backgroundColor`其`contentView`.

不要忘记将`dataSource`UITableView 的属性设置为您的数据源对象。

有关更多信息，您可以阅读这些 API 文档：

*   [UITableViewDataSource -`tableView:cellForRowAtIndexPath`](http://developer.apple.com/iphone/prerelease/library/documentation/UIKit/Reference/UITableViewDataSource_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UITableViewDataSource/tableView:cellForRowAtIndexPath:)
*   [UITableViewCell -`contentView`](http://developer.apple.com/iphone/prerelease/library/documentation/UIKit/Reference/UITableViewCell_Class/Reference/Reference.html#//apple_ref/occ/instp/UITableViewCell/contentView)
*   [界面视图 -`backgroundColor`](http://developer.apple.com/iphone/prerelease/library/documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW30)
*   [UITableView -`dataSource`](http://developer.apple.com/iphone/prerelease/library/documentation/UIKit/Reference/UITableView_Class/Reference/Reference.html#//apple_ref/occ/instp/UITableView/dataSource)

请注意，所有这三个链接都需要注册为 Apple 开发人员。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-18T02:51:03.143

我编写的版本可以在 iPhone 3.0 或更高版本中运行，否则将回退到白色背景。

在您的`viewDidLoad`方法中，`UITableViewController`我们添加以下内容：

```
self.view.backgroundColor=[UIColor clearColor];
// Also consider adding this line below:
//self.tableView.separatorColor=[UIColor clearColor]; 
```

当您创建单元格时（在我的代码中，这是我的`tableView:cellForRowAtIndexPath:`）添加以下代码：

```
cell.backgroundColor=[UIColor colorWithPatternImage:[UIImage imageNamed:@"code_bg.png"]];
float version = [[[UIDevice currentDevice] systemVersion] floatValue];
if (version >= 3.0)
{
     [[cell textLabel] setBackgroundColor:[UIColor clearColor]];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T19:18:01.843

backgroundView 一直在底部。它是显示圆角和边缘的那个。您想要的是位于 backgroundView 之上的 contentView。它覆盖了单元格通常为白色的区域。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T22:18:33.097

这对我来说非常有效：

```
NSEnumerator *enumerator = [cell.subviews objectEnumerator];
id anObject;
while (anObject = [enumerator nextObject]) {
    if( [anObject isKindOfClass: [ UIView class] ] )
        ((UIView*)anObject).backgroundColor = [UIColor lightGrayColor];
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-01T02:39:47.727

您可以设置`backgroundColor`. `backgroundView`如果`backgroundView`不存在，您可以为其创建一个。

```
if (!tableView.backgroundView) {
    tableView.backgroundView = [[UIView alloc] initWithFrame:tableView.bounds];
}
tableView.backgroundView.backgroundColor = [UIColor theMostFancyColorInTheUniverse]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-16T08:12:05.047

如果要将单元格的背景设置为图像，请使用以下代码：

```
 // Assign our own background image for the cell
UIImage *background = [UIImage imageNamed:@"image.png"];
UIImageView *cellBackgroundView = [[UIImageView alloc] initWithImage:background];
cellBackgroundView.image = background;
cell.backgroundView = cellBackgroundView; 
```

# html - html 选择选项分隔符

> ID：899148
> 
> 赞同：239
> 
> 时间：2009-05-22T17:58:38.753
> 
> 标签：html

如何在选择标签中制作分隔符？

```
New Window
New Tab
-----------
Save Page
------------
Exit 
```

* * *

## 回答 #1

> 赞同：383
> 
> 时间：2014-04-23T18:15:22.923

禁用选项方法似乎看起来最好并且得到最好的支持。我还包含了一个使用 optgroup 的示例。

optgroup（这种方式有点糟糕）：

```
<select>
    <optgroup>
        <option>First</option>
    </optgroup>
    <optgroup label="_________">
        <option>Second</option>
        <option>Third</option>
    </optgroup>
</select>
```

禁用选项（更好一点）：

```
<select>
    <option>First</option>
    <option disabled>_________</option>
    <option>Second</option>
    <option>Third</option>
</select>
```

如果您想真正花哨，请使用水平 unicode 框绘图字符。
（最佳选择！）

```
<select>
    <option>First</option>
    <option disabled>──────────</option>
    <option>Second</option>
    <option>Third</option>
</select>
```

[http://jsfiddle.net/JFDgH/2/](http://jsfiddle.net/JFDgH/2/)

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2009-05-22T18:01:02.057

尝试：

```
<optgroup label="----------"></optgroup> 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2016-01-17T00:41:57.853

这是一个旧线程，但由于没有人发布类似的回复，我将添加它，因为这是我首选的分离方式。

我发现使用破折号等有点碍眼，因为它可能达不到选择框的宽度。所以，我更喜欢使用 CSS 来创建我的分隔符.. 一个简单的背景颜色。

```
<select>
  <option style="background-color: #cccccc;" disabled selected>Select An Option</option>
  <option>First Option</option>
  <option>Second</option>
  <option style="font-size: 1pt; background-color: #000000;" disabled>&nbsp;</option>
  <option>Third</option>
  <option>Fourth</option>
  <option style="font-size: 1pt; background-color: #000000;" disabled>&nbsp;</option>
  <option>Fifth</option>
  <option>Sixth</option>
</select>
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2011-08-10T13:58:23.547

如果您不想使用 optgroup 元素，请将短划线放在选项元素中，并为其赋予 disabled 属性。它将可见，但显示为灰色。

```
<option disabled>----------</option> 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-10-05T00:11:43.210

我没有使用常规的连字符替换它，而是使用扩展字符集中的水平条符号替换它，如果用户在另一个替换该字符但对我来说很好用的国家，它看起来不会很好。您可以使用一系列不同的字符来获得一些很棒的效果，并且不涉及 css。

```
<option value='-' disabled>――――&lt;/option> 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-05-11T20:25:06.393

在 CSS 中定义一个类：

```
option.separator {
    margin-top:8px;
    border-top:1px solid #666;
    padding:0;
} 
```

用 HTML 编写：

```
<select ...>
    <option disabled class="separator"></option>
</select> 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-09-19T01:26:21.207

我正在将@Laurence Gonsalves 的评论作为答案，因为它是唯一一个在语义上有效并且看起来不像黑客的评论。

尝试将其添加到您的样式表中：

```
optgroup + optgroup { border-top: 1px solid black } 
```

远不如一堆破折号那么俗气。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-08-02T20:06:47.993

另一种方法是在选项上使用 css 1x1 背景图像，该选项似乎仅适用于 firefox 并具有“----”后备

```
<option value="" disabled="disabled" class="SelectSeparator">----</option> 

.SelectSeparator
    {
      background-image:  url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAAAAACH5BAAAAAAALAAAAAABAAEAAAICTAEAOw==);
      color:black;
      background-repeat:repeat-x;
      background-position:50% 50%;
      background-attachment:scroll;
} 
```

[http://jsfiddle.net/yNecQ/6/](http://jsfiddle.net/yNecQ/6/)

或使用 javascript (jquery) 来：

```
-hide the select element and 
-show a div which can be completely styled and 
-reflect the div state onto the select for the form submit 
```

[http://tutorialzine.com/2010/11/better-select-jquery-css3/](http://tutorialzine.com/2010/11/better-select-jquery-css3/)

* * *

另请参阅 [如何在 html 选择控件中添加水平线？](https://stackoverflow.com/questions/4317025/how-to-add-horizontal-line-in-html-select-control)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-03-25T11:10:40.970

如果它是 WebKit-only，你可以使用它`<hr>`来创建一个真正的分隔符。

[http://code.google.com/p/chromium/issues/detail?id=99534](http://code.google.com/p/chromium/issues/detail?id=99534)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-08-12T11:09:16.733

我们可以在没有选项的情况下使用 optgroup 标签

*   可以设置 font-size:1px 来最小化高度，并且
*   一些漂亮的背景

```
.divider {
  font-size: 1px;
  background: rgba(0, 0, 0, 0.5);
}

.divider--danger {
  background: red;
}
```

```
<select>
  <option value="option1">option 1 key data</option>
  <option value="option2">option 2 key data</option>
  <optgroup class="divider"></optgroup>
  <option value="option3">option 3 key data</option>
  <option value="option4">option 4 key data</option>
</select>

<select>
  <option value="option1">option 1 key data</option>
  <option value="option2">option 2 key data</option>
  <optgroup class="divider divider--danger"></optgroup>
  <option value="option3">option 3 key data</option>
  <option value="option4">option 4 key data</option>
</select>
```

Codepen.io：https://codepen.io/JasneetDua/pen/yLOYwaV?editors=1100 [_](https://codepen.io/JasneetDua/pen/yLOYwaV?editors=1100)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-04-04T16:40:14.807

您可以使用破折号“—”。每个字符之间没有可见的空格。
（在**某些**字体中！）

**在 HTML 中：**

```
<option value="————————————"已禁用>—————————————</option>
```

**或者在 XHTML 中：**

```
<option value="————————————" disabled="disabled">—————————————</option>
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-05-28T11:24:12.050

这个永远是最好的。

```
<option>First</option>
<option disabled>_________</option>
<option>Second</option>
<option>Third</option> 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-12-06T12:08:29.480

```
 <option  data-divider="true" disabled>______________</option> 
```

你也可以这样做。这很容易并使分隔符选择下拉列表。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-08-13T00:09:43.737

以 Jasneet 的回答为基础：

*   **将禁用选项的背景设置**为灰色 (Jasneet)
*   **在上方和下方添加禁用选项**以填充分隔符

基本上，使用三个禁用的选项来制作一个自然风格的分隔符。我选择了一条非常细的 0.1px 灰线和 0.25em 的焊盘高度，因为我认为这种组合看起来最自然：

[![HTML选择列表中的分隔符](https://i.stack.imgur.com/gBsoz.png)](https://i.stack.imgur.com/gBsoz.png)

```
<select>
  <option :value="item1">Item 1</option>
  <option disabled style="font-size: 0.25em;"></option>
  <option disabled style="background: #c9c9c9; font-size: 0.1px;"></option>
  <option disabled style="font-size: 0.25em;"></option>
  <option :value="item2">Item 2</option>
</select> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-11-22T01:13:24.130

我选择有条件地交替颜色和背景。设置排序顺序并使用 vue.js，我做了这样的事情：

```
<style>
    .altgroup_1 {background:gray; color:white;}
    .altgroup_2{background:white; color:black;}
</style>

<option :class = {
    'altgroup_1': (country.sort_order > 25),
    'altgroup_2': (country.sort_order > 50 }"
    value="{{ country.iso_short }}">
    {{ country.short_name }}
</option 
```

# java - 如何学习游戏开发？

> ID：899155
> 
> 赞同：3
> 
> 时间：2009-05-22T18:00:21.670
> 
> 标签：java, applet, java-web-start

我做网络程序员已经有一段时间了，我也可以用 Java 编程。我有一个想要开发的小型多人 RPG 游戏的想法。它将通过用户 Web 浏览器中的 Java 小程序播放。

我已经编写了游戏的设计文件和规范。我现在想知道的是如何开发游戏？过去我只使用过类似 Windows 的商业应用程序，其中包含用于文本框、下拉菜单等的内置小部件。对于游戏编程，我似乎必须为游戏的 UI 构建自己的小部件/控件。

这些是我想到的具体问题：

1) 如何在下载游戏的图像、声音等时显示带有进度条的“正在加载...”消息。（使用 java 小程序）

2）如何用自己的菜单、控件等创建游戏的UI。比如点击地图图标，它会向他们显示一张地图。单击朋友图标可以让他们与朋友聊天等。

3) 以及我应该了解的其他一般游戏开发问题，例如我应该使用 2D 还是 3D 图形、游戏中的物理等。

如果有对我有帮助的书的好建议，请分享。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T18:26:34.713

如果这是您的第一款游戏，那么多人项目可能过于雄心勃勃。

加载屏幕并不难——我通过计算我必须“加载”的文件数量来实现它们，然后每次成功加载另一个文件时推进进度条（并进行屏幕刷新）。您可以根据需要使用尽可能多的粒度来执行此操作 - 添加 UI 组件可能会使您的加载代码复杂化。我暂时不用担心；也许只是抛出一个基本的“正在加载...”框架，然后在游戏更稳定时实现一个完整的进度条。我还看到了一些很好的多线程实现。

另外两个将有经验；我认为您需要的更多是游戏开发的通用教程，而不是具体的答案。你绝对应该从小处着手。一旦你了解了小型游戏的结构和问题，就更容易将其应用到大型游戏中。

大多数合理的游戏编程书籍都会介绍基本的游戏结构；我喜欢 Game Coding Complete，但它对于初学者来说相当复杂（它涵盖了处理大型项目的更复杂的方法）。游戏架构和设计类似，但可能更适合您正在寻找的内容，因为它还涵盖了一些次要的项目管理“最佳实践”。

有很多不同的方式来做 UI，从使用 Java 原始 UI 类型（取决于您使用的其他库）到根据您的需要自行编写自己的“HUD”实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T18:14:48.697

可能值得熟悉的一件事是多线程。例如，对于“加载屏幕”，您可能有一个线程显示进度条，而其他线程同时加载数据。

类似地，通过调度多个线程同时做很多事情（在屏幕上移动不同的字符）或处理用户输入的中断，会发生很多交互。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T18:19:12.747

我会看 O'Reilly Books

[Java 中的杀手游戏编程](http://oreilly.com/catalog/9780596007300/)

[有趣的编码](http://oreilly.com/catalog/9780596520748/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T18:04:10.400

不要走java小程序路线。

如果你想做一个快速的休闲游戏，那就做成Flash；否则，开发一个成熟的 java 应用程序并通过 java web start 运行它。

试试[Tower](http://tower.sourceforge.net)，看看使用 java 作为平台可以走多远，以及 Java Web Start 是如何工作的。

至于进度条，我建议您在使用进度条之前实现这些文件的加载并实际使用它们:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T18:04:29.243

[http://nehe.gamedev.net/](http://nehe.gamedev.net/)

拥有大量从基础到高级的教程，使用各种语言和系统的 OpenGL，从 C 到 C#，从 Python 到 Java。

我发现这非常有用，并且是一个很好的书签资源。它应该让您开始在您选择的平台/语言上进行游戏/3D 编程的基础知识。

**祝你好运！**

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-22T18:14:08.043

正如其他人所说，Java 小程序可能不是您想要展示游戏的媒介。第二个大多数人看到一个小程序开始加载他们害怕运行。

如果您根本没有游戏设计经验，那么您在多人 RPG 游戏中设定的标准非常高。您可能想从一个更简单的项目开始，例如重新创建俄罗斯方块、吃豆人，甚至是乒乓球，这样您就可以了解创建游戏的所有内容。

如果您打算做一个在线游戏，Flash 非常棒，Java 加上 Jogl open-gl 包装器也是一个不错的选择。

我个人建议使用 Microsoft Xna。C# 与 Java 非常相似，因此您应该能够相当快地掌握它，并且 Xna 在抽象出图形编程中涉及的一些较低级别的细节方面做得很好。社区也非常活跃和乐于助人。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-23T08:11:25.720

回答问题 3。如果您真的热衷于开始开发游戏，我建议您阅读[Jeff Howland 的这篇短文](http://www.gamedev.net/reference/design/features/makegames/default.asp)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-23T09:31:02.987

1.  最简单的方法是将所有内容打包到一个 Jar 文件中。[默认屏幕确实显示了一个具有一些小的自定义](http://java.sun.com/javase/6/docs/technotes/guides/plugin/developer_guide/special_attributes.html)能力的进度条。您可以编写自定义代码来跟踪、管理和下载文件，但我个人建议不要使用这种方法。如果您搜索小程序加载程序，您会发现更多信息。

2.  我不是 100% 确定您的意思，但是您可以像在应用程序中使用[Swing 组件](http://java.sun.com/docs/books/tutorial/ui/features/components.html)一样使用它们。使用带有图像的 JButton 非常简单，然后在 actionPerformed 方法中挂钩事件代码。

3.  您可能会遇到的最大问题是动画和[EDT](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/dispatch.html)。我早些时候问过[这个问题](https://stackoverflow.com/questions/686822/active-rendering-and-the-edt-swing-animation)。

[这个](http://www.coderanch.com/t/201085/Game-Development/java/Good-Java-Game-Tutorial)页面有一大堆有用的游戏开发链接。[Pulp core](http://www.interactivepulp.com/pulpcore/)是一个值得一试的开源框架——即使您不使用该框架，您也可以研究代码。

您是否应该使用 Java 小程序似乎超出了这个问题的范围，但是上面的很多答案都给出了关于是否使用 Java 小程序的客观（或根本没有理由）。如果这是一个学习 Java 的个人练习游戏，那么这是一个很好的方法。如果您希望将其公开，您需要考虑当前的[采用水平](http://www.riastats.com/)是否足以满足您的需求。

Things have changed in the applet world recently. Since [1.6 update 10](http://java.sun.com/developer/technicalArticles/javase/java6u10/) it is much more competitive with Flash - the download size is smaller (at typically under 4Mb), the startup time is reduced and a [new scaling look and feel](http://www.jasperpotts.com/blog/2007/09/nimbus-almost-done/) was introduced.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-22T18:02:31.790

Q1 = 1% 的时间。

Q2 = 40% 的时间。

Q3 = 59% 的时间。

您可能会问我如何为 Web 浏览器编写 Halo3。

目标稍微低一点开始......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-22T18:04:31.863

[博弈论与设计](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-972Spring-2005/CourseHome/index.htm)的开放课件课程。它还附带一个[阅读清单](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-972Spring-2005/Readings/index.htm)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-22T19:18:06.307

由于我无法添加评论，因此我将添加答案。我建议不要使用线程来移动角色等。对于文件加载、播放声音，甚至服务器端网络，它运行良好，但任何类型的 AI/图形，它往往会导致无休止的头痛。

此外，正如其他人所提到的，Java 可能不是最佳选择。人们这么说的原因很简单，就是很难。与 C++ 相比，Java 游戏开发的支持/教程数量相当缺乏（[GameDev.net](http://www.gamedev.net/)是很好的资源，但随着时间的推移，它的重点更多地转向了专业开发）、Flash（[关于 Kongregate的体面教程](http://www.kongregate.com/labs)以及可以为您托管游戏的地方），甚至是 C#（使用 XNA）。多年来，Java 游戏开发有所改进，您可以用它做一些令人惊奇的事情，但走这条路可能最终会变得更加困难。无论您选择哪种语言，一定要考虑使用图形/游戏引擎，因为它会减少您的工作量，并让您有希望创造出更好的游戏。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-05-22T18:35:58.740

如果您正在寻找一种温和的游戏开发入门途径并且不介意学习 C#，那么[XNA](http://creators.xna.com/)拥有一个围绕学习如何编写游戏而建立的整个社区。它有各种各样的示例——[游戏状态管理](http://creators.xna.com/en-US/samples/gamestatemanagement)示例展示了一种实现屏幕转换和加载的好方法，还有一个类似的[网络游戏状态管理](http://creators.xna.com/en-US/sample/network_game_state_mgt_sample)示例用于网络内容。他们还提供完整的游戏作为源代码下载。

无论您的长期目标是制作 Java 小程序、Flash 游戏，还是想使用带有 OpenGL 的 C/C++ 工作，XNA 都是忽略渲染/声音/等所有繁琐实现细节的好方法。当你只是想制作你的第一场比赛时，这非常有帮助，相信我。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-05-22T19:26:10.580

不要使用 java applet 方法；小程序通常很烦人，而且速度很慢。

如果您真的希望它可以在浏览器中播放，请考虑使用 Flash（actionscript），或者 silverlight（我对 silverlight 中的游戏不太了解）。

[Gamedev](http://gamedev.net)是一个很好的通用游戏编程资源

和 ...

我会无耻地从 yx 的答案中窃取链接：

[麻省理工学院开放课件：博弈论与机制设计](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-972Spring-2005/CourseHome/index.htm)

# asp.net - asp.net网站的奇怪问题

> ID：899163
> 
> 赞同：0
> 
> 时间：2009-05-22T18:01:22.977
> 
> 标签：asp.net, master-pages, publishing

我已经建立了一个asp网站，但我遇到了以下问题：-

我在其中使用了一个母版页，并在内容中定义了两个内容占位符，一个在标题中，并且我在 @page 指令的最顶部指令中指定了页面标题，但页面标题没有显示。我必须手动为其添加标签。

其次，当我从母版页创建内容页面时，它会创建它，当我重命名它时，它不会重命名它的类。它仍然是_default，因此每个页面都继承了_default。

**最重要** 的是，我正在使用一个页面来输入和查看数据库中的数据。我使用了一个名为的布尔值`isadmin`，我在页面加载时根据凭据设置。我添加了一个面板，它的可见属性设置为`Visible = '<%#IsAdmin %>'`. 当我通过 Visual Studio 环境运行它时它可以正常工作，但是当我发布它并运行它时它不起作用并且面板只是出现并停留在那里。为什么会这样？任何的想法？谢谢

**可见问题已修复，因为我必须在服务器上启用 Windows 身份验证。等待其他两个问题的答案。谢谢**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T18:12:00.823

1.  尝试添加`<head runat=server>`到母版页。只有这样 ASP.net 才能“看到”标签并对其进行修改
2.  几个 aspx 页面具有相同的类名并没有那么糟糕。ASP.NET 2.0 开始将每个页面作为自己的编译单元来处理。页面不能互相看到。有一个特殊的指令可以让页面互相看到并实例化或操作它们。所以它应该不会造成太大的伤害
3.  也许您没有正确测试它并且误认为它在 Visual Studio 中有效？？？但无论如何，我建议您将逻辑移到 OnInit 中，然后它运行得更早。我认为控件树是在 Page.OnLoad 之前构建的。您所做的是数据绑定，它可能仅在调用 DataBind 时运行，我不确定

或者使用安全的方法：`IsAdmin`创建一个属性，以便它在第一次调用时初始化自己并将结果缓存在一个变量中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T18:22:21.803

关于问题 #2 - 通过项目添加您的内容页面 -> 添加新项目，并在那里适当地命名。这样命名始终是一致和正确的。

关于#3，当你从服务器运行它时输出什么 HTML？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T18:25:51.253

您的第一个问题可以通过在 .aspx 页面中填写 @Page 指令的标题部分来解决。母版页将在浏览器标题栏中显示该文本。

问题 #2 应该通过使用 Visual Studio 中的文件添加选项添加文件来解决。

# java - 替代 javax.activation.MimetypesFileTypeMap().getContentType(filename);

> ID：899167
> 
> 赞同：3
> 
> 时间：2009-05-22T18:02:37.173
> 
> 标签：java, jdk1.6, jdk1.5

我有一些代码：

```
import javax.activation.MimetypesFileTypeMap;
...
..
.
String filename = "foo.xls"; // Where this can be any file name .doc, .pdf or whatever

String headerContentType = new MimetypesFileTypeMap().getContentType(filename); 
```

似乎 javax.activation.MimetypesFileTypeMap 类在`rt.jar`JRE 系统库（jdk1.6.0_10）中，但在 jdk1.5.0 中没有

我想避免使用 1.6 库。有人知道一个简单快捷的替代方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T18:06:45.153

这来自[激活](http://java.sun.com/javase/technologies/desktop/javabeans/jaf/downloads/index.html)框架。这作为标准包含在 Java 6 中，但也可以单独下载（用于 Java 1.4 及更高版本）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T18:07:12.017

特定的类实际上是 java bean 的激活框架的一部分；

[JAF 下载](http://java.sun.com/javase/technologies/desktop/javabeans/jaf/downloads/index.html)

据我所知，它不应该依赖于 1.6。因此，只需下载 jar，并确保您的类路径中有 mimetypes.default 可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T20:40:51.800

我已经成功使用了这个项目[SubLuna](http://sourceforge.net/projects/subluna/)，它似乎比 JAF 更完整。它使用这个 MIME 类型集合：[共享 MIME 信息规范](http://www.freedesktop.org/wiki/Software/shared-mime-info)，维护得很好（当然你必须替换库附带的文件）。

# agile - 什么方法最接近神话人月中的外科团队？

> ID：899171
> 
> 赞同：8
> 
> 时间：2009-05-22T18:02:59.357
> 
> 标签：agile, methodology, extreme-programming, waterfall, mda

神话人月现在很经典，但“手术团队”方法仍然很有趣。哪种方法最接近它或具有相同的本质？

总结外科团队的类比：外科医生了解问题/业务领域并且是专家。当团队中有问题或冲突时，他们是权威。当出现问题时，外科医生之间会相互合作，比如设计，作为一个较小的紧密专家团队。所以本质上他们拥有领域的知识，被委托去做他们认为正确的事情，并做实际的编码？团队的其他成员专注于支持、测试、文档和项目计划，这些都是委派的任务。因此，外科医生也是最熟练/训练有素的资源。

答案可能是项目、编程、设计方法，因为它似乎对主要方法领域都有影响。采购开发中的敏捷、MDA、Extreme？这个问题对于复杂业务领域中的大型软件也更有意义，比如空中交通管制，而不是 COTS 开发人员或通用实用程序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T18:16:13.077

[敏捷软件开发](http://www.amazon.ca/Organizational-Patterns-Agile-Software-Development/dp/0131467409)的组织模式中提到的模式之一名为“每个角色三到七个助手”；它与 Surgical Team 的不同之处在于它关注每个角色，例如，不仅外科医生的“角色”具有帮助者或关系：*所有*角色都有一定数量的关系。

来自同一来源的另一种模式名为“Architect Also Implements”，它可能类似于“Surgical Team”，因为建筑师（可能）特别熟练。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T18:34:33.437

在外科医生的情况下，关键参与者既是领域专家又是实施者。

即，他既是软件程序经理（架构师）又是开发人员。

这种方法可能适合某些短期情况：例如，像实时服务器迁移或软件升级这样的复杂操作。

然而，对于一般开发，这种“英雄”方法存在一些问题：

*   Few key developers understand the problem domain to a sufficient degree, and must rely on domain experts. This is simply a function of specialization--it's tough to find kick-butt programmers who also are lawyers, doctors, accountants, or otherwise are experts in the domain the software is modeling.

*   Scalability is limited by the number of "surgeons" you have available.

*   There's a lot of down time for the other staff while they wait on instructions, since the highly-focused "doer" is also managing the team. That's ok in the OR, since you're dealing with a "zero-bug" mandate and "live software." But in this economy, a more distributed workload is more efficient, even if it results in the occasional sync problem between team members.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T18:20:16.863

我不确定是否有任何方法真正解决了这个问题，因为这实际上是优先考虑开发人员并将一切都满足他们的需求的问题，而不是关于这些开发人员如何实际开发他们的软件的任何事情。

如果您正在寻找一些实现这一点的方法，我想这可能是个坏消息。我更愿意将其视为*好消息*，因为这意味着您可以将这种方法与几乎任何软件开发方法一起使用。

我从事的正是*一个*以这种方式运行的项目。这太令人愉快了，我几乎感觉不好称它为“工作”。我们四个开发人员（有额外的支持人员，包括偶尔的额外初级代码猴子）在短短 9 个月内编写并正常运行了大量的代码。我去过的其他地方不可能有一个 20 人的团队做的那么多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T18:35:23.170

From the text I see the following:

Agile Like:

*   Small teams focused on solving specific problems
*   Collaboration among the surgeions

Non Agile Like:

*   Surgeons are the authority, driving the plan, determining the design, allocating support tasks (viewng them as subservent to coding) and doing the coding. All of those are very command and control in approach and contrary to self directing teams (vs a directed team)
*   There appears to be no collaboration with the business partner (let alone frequent collaboration with the busines partner)
*   There appears to be no prioritized product backlog, thus the surgeon picks what is important not the business partner
*   There appears to be no incrmental delivery (tight feedback loop)

For a waterfall project, it is suggesting to use a team of experts (surgeons) to do the planning, designing, coding etc. and allocating tasks to the "support" staff. On an agile team, testing is not treated as support but an integral part of delivery.

One can't say with certainty the methodology being advocated. However, it does appear to use the language (project plans, tasks) and assume that the waterfall approach is being followed (phases like design, coding, testing driven by a plan). Whatever methodology is being used, it one for which the few determine the work for the many.

# java - Hibernate 调用 flush on find- 导致非空错误

> ID：899182
> 
> 赞同：3
> 
> 时间：2009-05-22T18:05:46.573
> 
> 标签：java, hibernate, transactions

我有一个将树更新到数据库的过程，并在此过程中执行读取以检查重复实体。

我发现在此过程中途尝试执行 criteria.uniqueResult() 会导致以下错误：

> org.hibernate.PropertyValueException：非空属性引用空值或瞬态值

挖掘堆栈跟踪，我看到 uniqueResult() 正在刷新会话，尝试执行尚未准备好进入数据库的更新。

```
at org.hibernate.engine.Cascade.cascade(Cascade.java:153)
at org.hibernate.event.def.AbstractFlushingEventListener.cascadeOnFlush(AbstractFlushingEventListener.java:154)
at org.hibernate.event.def.AbstractFlushingEventListener.prepareEntityFlushes(AbstractFlushingEventListener.java:145)
at org.hibernate.event.def.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:88)
at org.hibernate.event.def.DefaultAutoFlushEventListener.onAutoFlush(DefaultAutoFlushEventListener.java:58)
at org.hibernate.impl.SessionImpl.autoFlushIfRequired(SessionImpl.java:996)
at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1589)
at org.hibernate.impl.CriteriaImpl.list(CriteriaImpl.java:306)
at org.hibernate.impl.CriteriaImpl.uniqueResult(CriteriaImpl.java:328)
at com.inversion.dal.BaseDAO.findUniqueByCriterion(BaseDAO.java:59) 
```

我在这里设置错误了吗？

非常感谢任何帮助。

马蒂

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T18:49:26.940

hibernate 记得需要保存对象。发出选择时，休眠将刷新这些更改。这确保了选择将返回正确的结果。

将 flushmode 设置为 FlushMode.AUTO 以外的任何内容都将阻止这种行为。但是错误出现在您的代码中，您将不完整的对象传递给休眠以保持或更新。所以正确的解决方案是稍后将对象传递给休眠，当它完成时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T18:27:48.270

关闭 Session 对象上的自动刷新以修复此异常。

```
Session s;
// if you're doing transactional work
s.setFlushMode(FlushMode.COMMIT);
// if you want to control flushes directly
s.setFlushMode(FlushMode.MANUAL); 
```

然而，这不是你的错误。代码中较早的内容导致内存中的对象处于无效状态，该状态试图在自动刷新期间持久保存到数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T10:51:43.260

我已经多次试图弄清这些问题的根源。问题是很难找到导致它的问题的根源。

如果您快要失去理智了，您还可以执行支持查询，例如`findAll`在新会话中：

```
Domain.withNewSession { session -> ... } 
```

在大多数情况下，这通常为我解决了这个问题。

# mercurial - 如何在客户端级别抑制 Starteam 中的关键字扩展以启用到 DVCS 的本地镜像？

> ID：899184
> 
> 赞同：1
> 
> 时间：2009-05-22T18:06:14.170
> 
> 标签：mercurial, dvcs, starteam

我正在尝试使用本地分布式版本控制系统 (Mercurial) 来镜像我的公司 Starteam CM 服务器。由于 Starteam 在结帐功能上的关键字扩展，我在看到许多变化时遇到了问题。例如，服务器设置为将 $History 扩展为每个签入评论和其他元数据的日志。当我尝试合并时，这些通常会导致烦人的冲突。

我可以手动“取消扩展”关键字，但代码库非常大，这将花费非常长的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T21:22:39.470

如果关键字看起来像 CVS/RCS 关键字（`$Id$`等等），那么与 Mercurial 捆绑的[关键字扩展](http://www.selenic.com/mercurial/wiki/KeywordExtension)可能有助于解开这些关键字。但不幸的是它只支持简单的关键字，而且听起来会像CVS 关键字一样`$History`递增扩展。`$Log$`

但也许您可以使用关键字扩展作为起点？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-12T16:53:50.510

mercurial 方面的另一个选择是使用`precommit`挂钩自动取消展开您的 starteam 结帐文件中的关键字。

您`~/.hgrc`可能会遇到这样的事情：

```
[hooks]
precommit.unexpand_starteam = find . -name '*.cpp' -print0 | xargs -0 perl -pie 's/$History.*?\n\n//m' ; exit 0 
```

这将在提交之前从每个文件的第一个空白行中删除 $History 中的所有内容。我没有使用过starteam，但必须有某种方法来识别历史块的结尾（空白行是猜测），并且改变了pe​​rl行以反映你应该很好去。

# php - 受 mod_rewrite 影响的 PHP include()

> ID：899188
> 
> 赞同：0
> 
> 时间：2009-05-22T18:06:51.703
> 
> 标签：php, apache, mod-rewrite

我继承了一些粗略编码的 PHP 文件，我需要以编程方式更改它们的输出。

为了实现这一点，我选择通过另一个 PHP 文件 rewriter.php 运行它们，它看起来大致如下：

```
<?php
if(!preg_match('/^([a-zA-Z0-9\-_]*)$/', $_GET['page']))
  die('Incorrect page supplied.');
ob_start('changeOutput');

include($_GET['page'].'.php');
ob_end_flush();

function changeOutput ($buffer) {
  ...
}
?> 
```

我使用 mod_rewrite 来强制他们运行这个文件：

```
RewriteEngine On
RewriteRule ^([^\.]*)\.php$ rewriter.php?page=$1 
```

但是显示了一条错误消息，这使我相信 include() 语句受上面的 RewriteRule 影响，即它试图通过 rewriter.php 运行 rewriter.php 等等。

我想有很多方法可以解决这个问题，但我专门寻找一种方法来避免 include() 语句受到 mod_rewrite 的影响。我查看了模块文档，但找不到任何相关内容。

当然，也欢迎这种方法的替代方案。

感谢您的时间和思考。

最好的问候，
丹尼尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T20:41:04.967

听起来您正在寻找 RewriteCond，它本质上是 mod_rewrite 的条件语句

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !rewriter.php$
RewriteRule ^([^\.]*)\.php$ rewriter.php?page=$1 [L] 
```

这将阻止您的规则应用于以 rewriter.php 结尾的 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T18:21:33.180

您应该先检查文件是否存在，然后再包含它：

```
if ($_GET['page'] != 'rewriter' && is_file($_GET['page'].'.php')) {
    include $_GET['page'].'.php';
} else {
    // file does not exist or is invalid
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T18:32:07.310

您可以将 RewriteCond 条件添加到您的 htaccess 中，以检查文件是否存在。类似于 Gumbo 的评论，除了稍微快一些（并且更轻量级的代码）。

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -f
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^([^\.]*)\.php$ rewriter.php?page=$1 
```

这将检查它是否是相对于您网站的根目录的文件或目录。如果是，它将运行重写器。快速触摸 .htaccess 很棒:)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-22T18:18:08.130

包含使用您引用文件系统的方式并绕过 mod-rewrite 翻译引擎。

我会看你的正则表达式。

```
/^([a-zA-Z0-9\-_]*)$/ 
```

也匹配空字符串。

尝试

```
/^([a-zA-Z0-9\-_]+)$/ 
```

看看 $_GET['page'] 是否为空。

# database - 数据库加密

> ID：899190
> 
> 赞同：1
> 
> 时间：2009-05-22T18:07:02.657
> 
> 标签：database, encryption, obfuscation

我有一个桌面应用程序需要从数据库中读取数据，两者都安装在客户端计算机上。

必须对数据库中的数据进行加密，以拒绝客户端访问并保护数据。

我需要知道使用什么样的数据库可以支持加密，因为某些表中的数据量会非常庞大​​，我也需要效率。

我在网上阅读了一些关于此的内容，也许 SQL Server Compact Edition 将是一个不错的选择。

有人可以帮我解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T19:12:58.360

您无法阻止坚定的攻击者访问解密密钥和访问数据库。这实际上是一种复制保护方案，它们都被破坏了。

* * *

*更新：*问题指出，“必须对数据库中的数据进行加密，**以拒绝客户端访问**并保护数据。” 如果客户端可以访问任何可以访问数据库的应用程序，他就可以访问应用程序使用的密钥，并且可以绕过应用程序直接访问数据库。

如果不可避免的逻辑没有吸引力，请考虑试图保护音乐、游戏和其他数字资产的复制保护计划失败的轶事证据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T18:15:08.260

SQL Server 2008 包含一个称为透明数据加密的功能，它可以满足您的需要。我不知道精简版是否包含此功能。使用这些关键字进行一点谷歌搜索应该可以帮助您入门。我通常不提倡使用 SQL Server，但在这种情况下，我不知道其他数据库供应商有任何类似的功能（但它们必须存在......）。

也就是说，您希望通过加密数据获得什么？如果这完全是客户端，那么客户端将拥有解密数据的密钥。充其量，您只是为人们获取您的数据库内容设置了一个小障碍。任何有意义的定义都不安全。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T18:14:45.810

SQLite 有一个加密扩展 (SEE)，允许应用程序读取和写入加密的数据库文件：[http ://www.hwaci.com/sw/sqlite/see.html](http://www.hwaci.com/sw/sqlite/see.html)

该数据库可能非常适合桌面应用程序，并且被广泛使用。例如，我相信 FireFox 在内部使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T18:17:29.317

SQL Server CE 不支持任何加密。您最多可以使用主机操作系统加密工具来加密数据库文件。文件级加密不适用于数据库，因为要读取文件中的页面 X，必须解密所有页面 1...X-1 以获取处于适当状态的加密密钥（达到适当的 CBC 块状态）。另一方面，BitLocker 工作正常，因为它可以单独解密/加密文件中的页面。但 BitLocker 是分区级别选项，而不是文件级别。这些一般注意事项适用于加密整个数据库文件的任何计划，与所涉及的产品（SQL CE、SQL Express、MySQL、Access 等）无关。

SQL Server 具有数据库级加密。最容易使用的是 TDE，即[透明数据加密](http://msdn.microsoft.com/en-us/library/bb934049.aspx)，但这需要企业版。另一种选择是使用加密功能并[自己管理加密](http://msdn.microsoft.com/en-us/library/ms179331.aspx)。很难使用，但在免费的 Express 版本中可用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-29T14:31:22.703

我可以推荐[SQLCipher](http://www.zetetic.net/software/sqlcipher)吗？它是 SQLite 的免费和开源实现，支持透明的页面级加密。它类似于 SEE，它正在积极开发中，并且对许多不同的密码具有实验性支持，因为它在某些实现中使用了 OpenSSL。全面披露：我是开发人员之一！我们有[一个关于在 iPhone 应用程序中使用它的教程](http://www.mobileorchard.com/tutorial-iphone-sqlite-encryption-with-sqlcipher)，可以让您基本了解它的工作原理，并且有一个评论线程扩展了一些相关主题。显然，在 Visual Studio 中使用它与 XCode 略有不同，但您应该能够连接链接并在 Windows 环境中使用它。

# e-commerce - 注册密钥/访问代码格式的最佳实践参考

> ID：899194
> 
> 赞同：0
> 
> 时间：2009-05-22T18:07:27.227
> 
> 标签：e-commerce, usability, registration

我正在开发一个在线网站，该网站的访问权限将在大学书店出售。学生将在书店购买一张带有访问代码的卡，然后他们可以使用该卡在我们的网站上在线注册。

我想让代码尽可能用户友好。我个人讨厌注册产品并且必须输入注册密钥 5 次，因为它不明确。

谁能指出我描述设计代码本身格式的最佳实践的资源？显而易见的事情浮现在脑海中——不要使用零或字母 O，不要区分大小写，包括某种校验和。我不想在这里发挥创造力，我需要一个必须多次解决的问题的秘诀。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T19:42:41.293

Joel Spolsky 在最近的一个 StackOverflow 播客中对解决这个问题有一些很好的见解。**[我相信这一集是第 49 集，您应该下载播客或在https://stackoverflow.fogbugz.com/default.asp?W4](https://stackoverflow.fogbugz.com/default.asp?W4)**上查看成绩单

处理一个键中混合的 0（数字）和 O（字母）真的很烦人，因为某些字体很难区分这两者。

其他可用性概念，例如三人一组更容易处理和记住，然后一个数字是很好的注意事项。例如，345-829-817-432 而不是 345829817432。

顺便说一句，**345-829-817-432**给你 12^10 个排列，甚至更小的数字**345-829-817**给你 9^10 个排列，这可能会根据你的情况给你足够的力量。

楚斯，

十亿

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T18:48:59.763

这实际上取决于您需要多少安全性。一些想法浮现在脑海。

如果你想要一些非常简单的东西，你可以生成模拟的信用卡号码；学生擅长使用这些四位数的组合，并且可以使用 Luhn 算法对其进行检查。

如果您想要更强大的东西，您可以生成一个 GUID，并将其用作代码。

如果您的网站可以发送电子邮件，您可以向学生询问他们的电子邮件地址，并向他们发送挑战/回复电子邮件。那么你根本不需要代码。他们的电子邮件地址就是代码。

# bugzilla - Bugzilla 报告

> ID：899195
> 
> 赞同：13
> 
> 时间：2009-05-22T18:07:40.720
> 
> 标签：bugzilla

BugZilla 报告是否有一个非常**好的** **免费**工具？我发现 Web 界面上的默认搜索选项太有限了。我最大的问题是缺少 Order By 选项（一次只有一个字段，可供选择的字段非常有限）。我做了一些谷歌搜索，但我找不到任何好的免费 BugZilla 报告工具。

如果没有，有人可以指点我一个关于如何访问 BugZilla 网络服务的例子吗？如果我能获得 BugZilla 数据，那么我可以轻松地构建自己的报告，从而更好地满足我们的需求。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-08T12:05:15.633

看看这个： http: [//www.faqs.org/docs/bugzilla/dbdoc.html](http://www.faqs.org/docs/bugzilla/dbdoc.html)

使用此数据库模式作为参考：faqs.org/docs/bugzilla/dbschema.html

如果您需要 Web 界面，请使用您最喜欢的可以访问 MySQL 数据库的动态网站脚本语言（例如 PHP）...

简单的教程：freewebmasterhelp.com/tutorials/phpmysql/4

PHP MySQL API 参考：php.net/manual/en/ref.mysql.php

然后使用 SQL 查询，例如：“SELECT * FROM bugs WHERE WHERE WHERE bug_status != 'RESOLVED' ORDER BY creation_ts ASC, votes DESC LIMIT 50”列出了前 50 个未解决的 bug 条目，首先按创建时间升序排列，然后按票数降序排列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-05T16:10:14.163

我过去使用过它并且非常喜欢它：[http ://www.mediawiki.org/wiki/Extension:Bugzilla_Reports](http://www.mediawiki.org/wiki/Extension:Bugzilla_Reports)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-09T08:05:10.013

您还可以考虑使用其他工具，例如 mantis ( [http://www.mantisbt.org/](http://www.mantisbt.org/) )

我亲自从 Bugzilla 切换到 Mantis 并安装了一些插件（[http://deboutv.free.fr/mantis/](http://deboutv.free.fr/mantis/)），发现这更舒服

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-09T11:59:40.927

如果您是 Java 用户，您可能想查看[Mylyn](http://www.eclipse.org/mylyn/)的 eclipse。这是将任务驱动的开发方法集成到 eclipse 中。

有了它，您可以提出错误，将 SVN 更改和错误联系在一起，隐藏与修复错误无关的类等。入门有点复杂，但功能非常强大。

它还带有一个用于 BugZilla 的连接器。有关示例，请参阅[这篇介绍性文章。](http://www.ibm.com/developerworks/java/library/j-mylyn1/)

如果您不使用 eclipse，但**使用**Java，请注意，由于 Mylyn 是开源的，您可能需要查看 Mylyn BugZilla 连接器的源代码，了解它们是如何工作的。

祝你好运。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-29T14:33:29.330

你可以试试 Deskzilla ( [http://deskzilla.com/](http://deskzilla.com/) ) - 它是一个多平台的 Bugzilla 桌面客户端，具有类似 Outlook 的界面、丰富的报告和过滤功能、离线工作、拖放等。商业产品，但如果你正在开发一个开源项目，你可以免费使用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-05T16:10:32.697

AFAIK Bugzilla 使用 MySQL 数据库来存储数据。因此，您可能可以连接一些可视化数据库管理器（存在很多，请参阅 Toad Data Modeler、DbVisualizer）并尝试做一些 sql 工作...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-09T03:11:26.300

[Buzilla 插件 wiki](https://wiki.mozilla.org/Bugzilla:Addons)上列出了一些插件（免费和商业）的列表。如果您是 Windows 用户，[MyZilla](http://www.my-zilla.com/ "我的Zilla")是一个可能的选择。

否则，要自己努力，请参阅[Bugzilla API 文档](http://www.bugzilla.org/docs/tip/en/html/api/)，其中包括如何检索当前模式 (Bugzilla::DB::Schema) 和 Bugzilla::WebService。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-12T03:18:49.430

Netbeans 也有 Bugzilla 集成（我还没有尝试过......）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-12T08:47:32.353

我已经分析了一堆错误跟踪工具。你可以试试track或者mantis，因为bugzilla对报告很不友好。

Mantis Mantis 可以将数据导出到 excel 中：您需要的所有图形都可以由该表生成。有关更多信息，请查看我的博客： http: [//gioorgi.com/2008/bug-tracking-mantis/](http://gioorgi.com/2008/bug-tracking-mantis/)

无论如何，Track 被使用得更多，所以为了完整起见，我应该引用它：

Track Pros：也可以使用嵌入式数据库（使用 sqlite）。易于安装和使用。

缺点：功能太多，并且在某种程度上也旨在成为 CMS。看看： http: [//gioorgi.com/2008/bug-tracking-trac/](http://gioorgi.com/2008/bug-tracking-trac/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-12T09:01:09.357

由于`Bugzilla`可以安装在您自己的服务器上，我认为最简单的方法是这样做并使用它创建的数据库（[“Bugzilla 支持 MySQL、PostgreSQL 和 Oracle 作为数据库服务器”](http://www.bugzilla.org/docs/tip/en/html/installation.html#install-database)）。该文档还说您可以根据需要[修改模板](http://www.bugzilla.org/docs/tip/en/html/cust-templates.html)。

否则，可以尝试[付费支持](http://www.bugzilla.org/support/consulting.html)或[其他一些错误跟踪器](http://www.fogcreek.com/FogBugz/)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-11-16T15:39:43.233

我使用这个小[书签](https://www.squarefree.com/bookmarklets/mozilla.html)，并且喜欢它如何使用在位置栏中输入的字符串进行正确搜索，例如智能搜索。它让您可以通过 Bugzilla Quicksearch 快速搜索 bugzilla 或跳转到 bug 编号，并且兼容 IE6+、Moz、Op7+。

它在同一页面上的同伴可用于改进或帮助进行错误搜索/报告，例如`collect buglinks`（查询 bugzilla 以显示从当前页面链接到的错误列表）或`buglinkify`（将页面上的所有数字转换为错误链接）。

# c# - WPF 超链接子项

> ID：899198
> 
> 赞同：1
> 
> 时间：2009-05-22T18:08:17.023
> 
> 标签：c#, .net, wpf, hyperlink

我有一个 WPF `Hyperlink`，我可以单击它并`NavigateUri`很好地获取它的属性。但是，我希望能够将一些附加信息与 捆绑在一起，`Hyperlink`以便我可以在我的事件处理程序中处理它。这是它现在的样子：

```
<TextBlock Grid.Row="0">
    <Hyperlink ToolTip="{Binding Path=Contact.ToolTipPersonalEmail}" 
           Name="ContactHyperlink" Foreground="#FF333333" 
           RequestNavigate="HandleContactEmailClicked" 
           NavigateUri="{Binding Path=Contact.Email}"
           >
        <TextBlock Text="{Binding Path=Contact.Fullname}" Width="Auto"
            HorizontalAlignment="Stretch"
            TextTrimming="CharacterEllipsis"/>
        <TextBlock Text="{Binding Path=Data1}" Name="data1"  Visibility="Collapsed" />
        <TextBlock Text="{Binding Path=Data2}" Name="data2"  Visibility="Collapsed" />  
    </Hyperlink>

</TextBlock> 
```

基本上，在我的事件处理程序中，我希望能够访问具有可见性 =“已折叠”（data1 和 data2）的两个文本块内的数据。我把它比作 HTML 表单中的“隐藏”数据。

我尝试弄乱“内联”属性，`Hyperlink`但这不起作用，因为这是在 DataTemplate 中，我无法在我的代码中按名称访问 data1 和 data2。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T18:13:20.180

创建文本块来保存该数据有点……矫枉过正。我会选择以下两个选项之一：

1.  使用数据绑定，将特定对象放入超链接，然后将其取回，您需要做的就是访问超链接的 DataContext，它会为您提供包含 data1 和 data2 的类
2.  将填充 data1 和 data2 的对象附加到超链接的 TAG 属性中

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T18:14:24.407

在您的事件处理程序中，您可以执行以下操作：

```
ContentPresenter presenter = (ContentPresenter)sender.TemplatedParent;
DataTemplate template = presenter.ContentTemplate;
TextBlock textBlock = (TextBlock)template.FindName("data1", presenter); 
```

可能不是最漂亮的方式，但它对我有用。

# iphone - 在 iPhone 上失去网络连接

> ID：899200
> 
> 赞同：2
> 
> 时间：2009-05-22T18:10:31.637
> 
> 标签：iphone

我正在 iPhone 上开发一个始终需要互联网连接的网络应用程序。但是，一旦我登录到服务器并让 iPhone 闲置一段时间，iPhone 就会进入睡眠模式并断开我的网络连接（它会注销我）。

如果我在 iPhone 上运行相同的应用程序，当 iPhone 通过 USB 电缆连接到 PC 时，它永远不会失去网络连接。

在 info.plist 文件中我添加了这两个标志，但似乎没有任何效果。

UIRequiresPersistentWifi -> true SBUsesNetwork - 整数 ->3

我错过了什么吗？您能否让我知道如何确保网络连接在应用程序的整个生命周期中保持不变？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T18:48:59.280

在您的应用程序委托（“appDelegate”）中，禁用`+initialize`方法中的空闲计时器：

```
myApp.idleTimerDisabled = YES; 
```

请注意，这将使您的 iPhone 在您的应用程序打开时不会进入睡眠状态。这可能会导致电池寿命问题。

另一种选择可能是设置一个后台线程，`CFStream`定时打开一个小线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T19:07:15.920

这里的“注销我”是什么意思？在网络级别，没有“登录”（*）。只有数据包。你送他们，或者你不送。那么您的服务器进程是否对定期到达的数据包或消息有某种期望？如果是，那么您必须发送它们，这意味着您不能闲置 ( `idleTimerDisabled = YES`)。如果您控制服务器，最好降低它对您与它交谈的频率的要求。然而，这一切都发生在网络层之上。

`UIRequiresPersistentWifi`意味着在您的应用程序运行时 Wifi 无线电会保持打开状态，即使您不对其进行通话也是如此。这对于接收数据很重要。否则，您会在大约 30 分钟后掉线，其他人无法与您通话。它应该在 Info.plist 中设置，但这肯定在您的应用程序包中。如果不是，您的应用程序将无法启动，所以这不是问题。

(*) 蜂窝网络确实有登录的概念，但这不是导致您的问题的原因。

# sql - 如何找到最后一次更新 PostgreSQL 数据库的时间？

> ID：899203
> 
> 赞同：20
> 
> 时间：2009-05-22T18:11:24.147
> 
> 标签：sql, postgresql, metadata, database-administration

我正在使用一个批量更新的 postgreSQL 数据库。我需要知道上次更新或修改数据库（或数据库中的表）的时间，两者都可以。

我看到 postgeSQL 论坛上有人建议使用日志记录并查询您的日志。这对我不起作用，因为我无法控制客户端代码库。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-22T19:02:13.153

您可以编写一个[触发器](http://www.postgresql.org/docs/8.3/static/triggers.html)以在每次对特定表进行插入/更新时运行。常见的用法是将行的“created”或“last_updated”列设置为当前时间，但如果您不想更改现有表，也可以在中心位置更新时间。

因此，例如一种典型的方式是以下一种：

```
CREATE FUNCTION stamp_updated() RETURNS TRIGGER LANGUAGE 'plpgsql' AS $$
BEGIN
  NEW.last_updated := now();
  RETURN NEW;
END
$$;
-- repeat for each table you need to track:
ALTER TABLE sometable ADD COLUMN last_updated TIMESTAMP;
CREATE TRIGGER sometable_stamp_updated
  BEFORE INSERT OR UPDATE ON sometable
  FOR EACH ROW EXECUTE PROCEDURE stamp_updated(); 
```

然后要找到最后更新时间，您需要从您正在跟踪的每个表中选择“MAX（last_updated）”并取其中最大的一个，例如：

```
SELECT MAX(max_last_updated) FROM (
  SELECT MAX(last_updated) AS max_last_updated FROM sometable
  UNION ALL
  SELECT MAX(last_updated) FROM someothertable
) updates 
```

对于具有串行（或类似生成）主键的表，您可以尝试通过使用主键索引来避免顺序扫描以查找最新更新时间，或者在 last_updated 上创建索引。

```
-- get timestamp of row with highest id
SELECT last_updated FROM sometable ORDER BY sometable_id DESC LIMIT 1 
```

请注意，在 ID 不是很连续的情况下，这可能会给出稍微错误的结果，但是您需要多少准确度？（请记住，事务意味着行可以以与创建行不同的顺序对您可见。）

避免向每个表添加“更新”列的另一种方法是使用一个中央表来存储更新时间戳。例如：

```
CREATE TABLE update_log(table_name text PRIMARY KEY, updated timestamp NOT NULL DEFAULT now());
CREATE FUNCTION stamp_update_log() RETURNS TRIGGER LANGUAGE 'plpgsql' AS $$
BEGIN
  INSERT INTO update_log(table_name) VALUES(TG_TABLE_NAME);
  RETURN NEW;
END
$$;
-- Repeat for each table you need to track:
CREATE TRIGGER sometable_stamp_update_log
 AFTER INSERT OR UPDATE ON sometable
 FOR EACH STATEMENT EXECUTE stamp_update_log(); 
```

这将为您提供一个表，其中每个表更新都有一行：然后您可以这样做：

```
SELECT MAX(updated) FROM update_log 
```

获取最后更新时间。（如果你愿意，你可以按表分开）。该表当然会继续增长：要么在“更新”上创建一个索引（这应该可以非常快地获得最新的索引），或者如果适合您的用例，则定期截断它，（例如，在表上获取排他锁，获取最新的更新时间，如果需要定期检查是否进行了更改，则将其截断）。

另一种方法（可能是论坛上的人的意思）是在数据库配置中设置“log_statement = mod”（无论是全局的集群，还是您需要跟踪的数据库或用户），然后所有语句修改数据库将写入服务器日志。然后你需要在数据库之外写一些东西来扫描服务器日志，过滤掉你不感兴趣的表，等等。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-08-27T21:24:13.857

看起来您可以[`pg_stat_database`](http://www.postgresql.org/docs/current/interactive/monitoring-stats.html#MONITORING-STATS-VIEWS-TABLE)用来获取事务计数并检查这是否从一个备份运行更改为下一个备份运行 - 有关更多详细信息，请参阅[此 dba.se 答案](https://dba.stackexchange.com/questions/5110/determine-when-a-postgresql-database-was-last-changed/5116#5116)和评论

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T18:19:54.443

请参阅以下文章：

MySQL 与 PostgreSQL：向表中添加“上次修改时间”列 [http://www.pointbeing.net/weblog/2008/03/mysql-versus-postgresql-adding-a-last-modified-column-to-a -table.html](http://www.pointbeing.net/weblog/2008/03/mysql-versus-postgresql-adding-a-last-modified-column-to-a-table.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-30T12:17:52.107

我喜欢杰克的做法。您可以查询表统计信息并了解插入、更新、删除等的数量：

```
select n_tup_upd from pg_stat_user_tables  where relname = 'YOUR_TABLE'; 
```

每次更新都会将计数增加 1。

请记住，当您只有一个数据库时，这种方法是可行的。多个实例可能需要不同的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-09T15:05:52.263

您可以用“不受信任的语言”（例如 plpythonu）编写存储过程：这允许访问 postgres“base”目录中的文件。返回存储过程中这些文件的最大 mtime。

但这只是模糊的，因为vacuum会改变这些文件和mtime。

# wpf - WPF MenuItem 标头和 HeaderTemplate

> ID：899204
> 
> 赞同：9
> 
> 时间：2009-05-22T18:11:35.270
> 
> 标签：wpf, xaml, data-binding, menuitem

我想将 KeyValuePair 列表绑定到 MenuItems 列表。我以为我应该使用 MenuIten.HeaderTemplate，但它没有用。我只有空白标题。

```
 <MenuItem 
                Header="Template" 
                ItemsSource="{Binding Path=Samples}">
                <MenuItem.ItemTemplate>
                    <DataTemplate>
                        <MenuItem>
                            <MenuItem.HeaderTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding Path=Key}" FontWeight="Bold"/>
                                        <TextBlock Text="{Binding Path=Value}" FontStyle="Italic" Margin="5,0,0,0"/>
                                    </StackPanel>
                                </DataTemplate>
                            </MenuItem.HeaderTemplate>                            </MenuItem>
                    </DataTemplate>
                </MenuItem.ItemTemplate>
            </MenuItem> 
```

然后我用 MenuItem.Header 替换了 MenuItem.HeaderTemplate，它起作用了。

```
 <MenuItem 
                Header="Template" 
                ItemsSource="{Binding Path=Samples}">
                <MenuItem.ItemTemplate>
                    <DataTemplate>
                        <MenuItem>
                            <MenuItem.Header>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Path=Key}" FontWeight="Bold"/>
                                    <TextBlock Text="{Binding Path=Value}" FontStyle="Italic" Margin="2,0,0,0"/>
                                </StackPanel>
                            </MenuItem.Header>
                        </MenuItem>
                    </DataTemplate>
                </MenuItem.ItemTemplate>
            </MenuItem> 
```

谁能向我解释为什么 HeaderTemplate 在这里不起作用？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2010-01-29T15:14:16.417

弥迦是对的。在第一种方法中，我告诉菜单项如何对其自身进行模板化，但从未告诉它它绑定到什么数据！以下作品：

```
 <MenuItem 
            Header="Template" 
            ItemsSource="{Binding Path=Samples}">
            <MenuItem.ItemTemplate>
                <DataTemplate>
                    <MenuItem Header="{Binding}">
                        <MenuItem.HeaderTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Path=Key}" FontWeight="Bold"/>
                                    <TextBlock Text="{Binding Path=Value}" FontStyle="Italic" Margin="5,0,0,0"/>
                                </StackPanel>
                            </DataTemplate>
                        </MenuItem.HeaderTemplate>
                     </MenuItem>
                </DataTemplate>
            </MenuItem.ItemTemplate>
        </MenuItem> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-22T18:26:07.837

因为 HeaderTemplate 无权访问绑定到菜单项的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-11T09:50:29.607

*模板*的目的是向 VisualTree 添加一些元素。DataTemplate 用于子项（[Sub]MenuItem、ListBox 中的ListBoxItem 等）并应用于项目持有者，它与ControlTemplate 相反，应用于控件本身。你实际上做了什么

```
<MenuItem 
            Header="Template" 
            ItemsSource="{Binding Path=Samples}">
            <MenuItem.ItemTemplate>
                <DataTemplate>
                       ....
   </DataTemplate>
  </MenuItem.ItemTemplate>
</MenuItem> 
```

正在告诉“我想要获取 MenuItem*内容*并插入数据，必须将其可视化”。然后插入这个 insted 点：

```
 <MenuItem Header="{Binding}">... </MenuItem> 
```

因此，您正在向当前迭代的菜单项插入其他菜单项。我看不出重点。接下来更清楚：

```
 <MenuItem Header="Template" ItemsSource="{Binding Samples}">
         <MenuItem.Resources>
            <Style TargetType="{x:Type MenuItem}">
               <Setter Property="Command" Value="{Binding SomeCommand}" />
            </Style>            
        </MenuItem.Resources>
       <MenuItem.ItemTemplate>
          <DataTemplate>
              <TextBlock Text="{Binding Name}" />
          </DataTemplate>             
       </MenuItem.ItemTemplate>
    </MenuItem> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T10:33:07.667

HeaderTemplate 定义应该是 DataTemplate，而不是直接的 UI 内容：

```
...
<MenuItem.HeaderTemplate>
    <DataTemplate>
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="{Binding Path=Key}" FontWeight="Bold"/>
            <TextBlock Text="{Binding Path=Value}" FontStyle="Italic" Margin="2,0,0,0"/>
        </StackPanel>
    </DataTemplate>
</MenuItem.HeaderTemplate>
... 
```

# perl - Perl 如何知道文件是二进制文件？

> ID：899206
> 
> 赞同：19
> 
> 时间：2009-05-22T18:11:55.270
> 
> 标签：perl

我知道您可以使用文件测试运算符 -B 来测试文件是否为二进制文件，但是 Perl 如何在内部实现这一点？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-22T18:16:33.420

来自`perldoc -f -B`：

> `-T`和开关 的`-B`工作方式如下。检查文件的第一个块左右是否有奇数字符，例如奇怪的控制代码或设置了高位的字符。如果发现太多奇怪字符（>30%），则为`-B`文件；否则它是一个`-T`文件。此外，任何在第一个块中包含 null 的文件都被视为二进制文件。如果在文件句柄上使用`-T`or `-B` ，则检查当前 IO 缓冲区而不是第一个块。两者都`-T`返回`-B`true 在空文件或文件上`EOF`测试文件句柄时。因为你必须读取一个文件来做`-T`测试，所以在大多数情况下你想先`-f`对文件使用 a ，如 " `next unless -f $file && -T $file`"。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-22T18:20:00.310

根据*Learning Perl*一书的第11章：

> 答案是 **Perl 作弊**：它打开文件，查看前几千字节，并做出有根据的猜测。如果它看到很多空字节、不寻常的控制字符和设置了高位的字节，那么它看起来就像一个二进制文件。如果没有太多奇怪的东西，那么它看起来像文本。它有时会猜错。如果一个文本文件有很多瑞典语或法语单词（可能有用高位集表示的字符，如一些 ISO-8859 变体，甚至可能是 Unicode 版本），它可能会欺骗 Perl 将其声明为二进制。所以它并不完美，但如果您需要将源代码与编译文件或 HTML 文件与 PNG 分开，这些测试应该可以解决问题。

# ios - 如何在 Objective-C 中测试字符串是否为空？

> ID：899209
> 
> 赞同：681
> 
> 时间：2009-05-22T18:12:48.543
> 
> 标签：ios, objective-c, nsstring

如何`NSString`在 Objective-C 中测试 an 是否为空？

* * *

## 回答 #1

> 赞同：1183
> 
> 时间：2009-05-22T18:14:04.843

您可以检查是否`[string length] == 0`. 这将检查它是否是一个有效但为空的字符串 (@"") 以及它是否为 nil，因为调用`length`nil 也会返回 0。

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2009-05-22T18:33:24.377

马克的回答是正确的。但我将借此机会包括一个指向 Wil Shipley 的 generalized 的指针`isEmpty`，他在他的[博客](http://blog.wilshipley.com/2005/10/pimp-my-code-interlude-free-code.html)上分享了这一点：

```
static inline BOOL IsEmpty(id thing) {
return thing == nil
|| ([thing respondsToSelector:@selector(length)]
&& [(NSData *)thing length] == 0)
|| ([thing respondsToSelector:@selector(count)]
&& [(NSArray *)thing count] == 0);
} 
```

* * *

## 回答 #3

> 赞同：94
> 
> 时间：2009-10-27T13:37:03.867

第一种方法是有效的，但如果您的字符串有空格 ( ) 则不起作用`@" "`。所以你必须在测试之前清除这个空白。

此代码清除字符串两侧的所有空格：

```
[stringObject stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceCharacterSet] ]; 
```

一个好主意是创建一个宏，这样您就不必键入这个怪物行：

```
#define allTrim( object ) [object stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceCharacterSet] ] 
```

现在您可以使用：

```
NSString *emptyString = @"   ";

if ( [allTrim( emptyString ) length] == 0 ) NSLog(@"Is empty!"); 
```

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2010-09-09T09:54:52.253

我见过的最好的解决方案之一（比 Matt G 的解决方案更好）是我在一些 Git Hub 存储库中获得的改进的内联函数（Wil Shipley 的一个，但我找不到链接）：

```
// Check if the "thing" passed is empty
static inline BOOL isEmpty(id thing) {
    return thing == nil
    || [thing isKindOfClass:[NSNull class]]
    || ([thing respondsToSelector:@selector(length)]
        && [(NSData *)thing length] == 0)
    || ([thing respondsToSelector:@selector(count)]
        && [(NSArray *)thing count] == 0);
} 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-12-26T12:20:00.497

You should better use this category:

```
@implementation NSString (Empty)

    - (BOOL) isWhitespace{
        return ([[self stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]]length] == 0);
    }

@end 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2011-11-27T03:45:48.170

`@""`另一种选择是检查它是否等于`isEqualToString:`这样：

```
if ([myString isEqualToString:@""]) {
    NSLog(@"myString IS empty!");
} else {
    NSLog(@"myString IS NOT empty, it is: %@", myString);
} 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2011-06-02T07:30:36.610

我把这个：

```
@implementation NSObject (AdditionalMethod)
-(BOOL) isNotEmpty
{
    return !(self == nil
    || [self isKindOfClass:[NSNull class]]
    || ([self respondsToSelector:@selector(length)]
        && [(NSData *)self length] == 0)
    || ([self respondsToSelector:@selector(count)]
        && [(NSArray *)self count] == 0));

};
@end 
```

问题是如果 self 为 nil，则永远不会调用此函数。它将返回 false，这是所需的。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2014-02-03T10:52:02.133

只需将您的字符串传递给以下方法：

```
+(BOOL)isEmpty:(NSString *)str
{
    if(str.length==0 || [str isKindOfClass:[NSNull class]] || [str isEqualToString:@""]||[str  isEqualToString:NULL]||[str isEqualToString:@"(null)"]||str==nil || [str isEqualToString:@"<null>"]){
        return YES;
    }
    return NO;
} 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2014-07-01T09:34:35.637

可能这个答案是已经给出答案的重复，但我在检查条件的顺序上做了很少的修改和更改。请参考以下代码：

```
+(BOOL)isStringEmpty:(NSString *)str {
     if(str == nil || [str isKindOfClass:[NSNull class]] || str.length==0) {
            return YES;
       }
      return NO;
  } 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2015-07-09T19:59:17.653

# 斯威夫特版本

尽管这是一个 Objective C 问题，但我需要`NSString`在 Swift 中使用，所以我也会在此处提供一个答案。

```
let myNSString: NSString = ""

if myNSString.length == 0 {
    print("String is empty.")
} 
```

或者如果`NSString`是可选的：

```
var myOptionalNSString: NSString? = nil

if myOptionalNSString == nil || myOptionalNSString!.length == 0 {
    print("String is empty.")
}

// or alternatively...
if let myString = myOptionalNSString {
    if myString.length != 0 {
        print("String is not empty.")
    }
} 
```

正常的 Swift`String`版本是

```
let myString: String = ""

if myString.isEmpty {
    print("String is empty.")
} 
```

另请参阅：[在 Swift 中检查空字符串？](https://stackoverflow.com/a/31327259/3681880)

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2012-08-01T10:11:18.477

只需使用`if` `else`如下所示的条件之一：

**方法一：**

```
if ([yourString isEqualToString:@""]) {
        // yourString is empty.
    } else {
        // yourString has some text on it.
    } 
```

**方法二：**

```
if ([yourString length] == 0) {
    // Empty yourString
} else {
    // yourString is not empty
} 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2014-11-17T08:00:39.613

您有两种方法可以检查字符串是否为空：

假设您的字符串名称是`NSString *strIsEmpty`.

**方法一：**

```
if(strIsEmpty.length==0)
{
    //String is empty
}

else
{
    //String is not empty
} 
```

**方法二：**

```
if([strIsEmpty isEqualToString:@""])
{
    //String is empty
}

else
{
    //String is not empty
} 
```

选择上述任何一种方法，并了解字符串是否为空。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2014-09-24T18:12:03.350

您可以使用此方法检查您的字符串是否为空：

```
+(BOOL) isEmptyString : (NSString *)string
{
    if([string length] == 0 || [string isKindOfClass:[NSNull class]] || 
       [string isEqualToString:@""]||[string  isEqualToString:NULL]  ||
       string == nil)
     {
        return YES;         //IF String Is An Empty String
     }
    return NO;
} 
```

最佳实践是让一个共享类说 UtilityClass 并添加这个方法，这样你就可以通过在你的应用程序中调用它来使用这个方法。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2016-05-27T19:58:46.713

只需检查您的字符串长度

```
 if (!yourString.length)
 {
   //your code  
 } 
```

给 NIL 的消息将返回 nil 或 0，因此无需测试 nil :)。

快乐的编码...

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2013-09-30T11:33:53.570

它对我来说就像魅力一样

如果`NSString`是`s`

```
if ([s isKindOfClass:[NSNull class]] || s == nil || [s isEqualToString:@""]) {

    NSLog(@"s is empty");

} else {

    NSLog(@"s containing %@", s);

} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2012-09-15T19:17:10.297

非常有用的帖子，添加了 NSDictionary 支持以及一个小改动

```
static inline BOOL isEmpty(id thing) {
    return thing == nil
    || [thing isKindOfClass:[NSNull class]]
    || ([thing respondsToSelector:@selector(length)]
        && ![thing respondsToSelector:@selector(count)]
        && [(NSData *)thing length] == 0)
    || ([thing respondsToSelector:@selector(count)]
        && [thing count] == 0);
} 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2014-03-25T14:06:07.920

因此，除了检查字符串长度是否小于 1 的基本概念之外，深入考虑上下文也很重要。人类或计算机或其他语言可能对空字符串有不同的定义，并且在这些相同的语言中，额外的上下文可能会进一步改变含义。

假设空字符串表示“不包含在当前上下文中重要的任何字符的字符串”。

这可能意味着视觉上，因为颜色和背景颜色在属性字符串中是相同的。有效地为空。

这可能意味着没有有意义的字符。所有点或所有破折号或所有下划线都可能被视为空。此外，没有有意义的重要字符可能意味着字符串没有读者理解的字符。它们可以是一种语言中的字符或被定义为对读者无意义的字符集。我们可以稍微不同地定义它，说字符串不构成给定语言中的已知单词。

我们可以说空是所渲染字形中负空间百分比的函数。

即使是没有一般视觉表示的不可打印字符序列也不是真正的空。控制字符浮现在脑海。尤其是低 ASCII 范围（我很惊讶没有人提到这些，因为它们管理大量系统并且不是空白，因为它们通常没有字形和视觉指标）。然而字符串长度不为零。

结论。仅长度并不是这里唯一的衡量标准。上下文集成员资格也非常重要。

字符集成员资格是一个非常重要的常见附加措施。有意义的序列也是一种相当常见的序列。（想想 SETI 或加密或验证码）还存在其他更抽象的上下文集。

因此，在假设字符串仅基于长度或空格为空之前请仔细考虑。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2015-07-09T21:18:17.823

```
- (BOOL)isEmpty:(NSString *)string{
    if ((NSNull *) string == [NSNull null]) {
        return YES;
    }
    if (string == nil) {
        return YES;
    }
    if ([string length] == 0) {
        return YES;
    }
    if ([[string stringByTrimmingCharactersInSet: [NSCharacterSet whitespaceAndNewlineCharacterSet]] length] == 0) {
        return YES;
    }
    if([[string stringByStrippingWhitespace] isEqualToString:@""]){
        return YES;
    }
    return NO;
} 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2015-11-24T08:31:18.200

最好的方法是使用类别。
您可以检查以下功能。哪个有所有条件可以检查。

```
-(BOOL)isNullString:(NSString *)aStr{
        if([(NSNull *)aStr isKindOfClass:[NSNull class]]){
            return YES;
        }
        if ((NSNull *)aStr  == [NSNull null]) {
            return YES;
        }
        if ([aStr isKindOfClass:[NSNull class]]){
            return YES;
        }
        if(![[aStr stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]] length]){
            return YES;
        }
        return NO;
    } 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2014-04-14T07:29:16.340

您可以使用以下方法轻松检查字符串是否为空：

```
if ([yourstring isEqualToString:@""]) {
    // execute your action here if string is empty
} 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2012-06-27T12:17:20.403

无论如何，最好的方法是检查给定字符串的长度。为此，如果您的字符串是 myString ，那么代码是：

```
 int len = [myString length];
    if(len == 0){
       NSLog(@"String is empty");
    }
    else{
      NSLog(@"String is : %@", myString);
    } 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2014-03-25T13:20:13.773

检查这个：

```
if ([yourString isEqualToString:@""])
{
    NsLog(@"Blank String");
} 
```

或者

```
if ([yourString length] == 0)
{
    NsLog(@"Blank String");
} 
```

希望这会有所帮助。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2015-03-30T10:39:05.670

它就像`if([myString isEqual:@""])`或一样简单`if([myString isEqualToString:@""])`

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2014-09-30T12:46:32.817

我使用以下代码检查了一个空字符串：

```
//Check if we have any search terms in the search dictionary.
if( (strMyString.text==(id) [NSNull null] || [strMyString.text length]==0 
       || strMyString.text isEqual:@"")) {

   [AlertView showAlert:@"Please enter a valid string"];  
} 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2013-10-04T08:33:43.277

```
if (string.length == 0) stringIsEmpty; 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2017-01-02T16:25:25.923

```
//Different validations:
 NSString * inputStr = @"Hey ";

//Check length
[inputStr length]

//Coming from server, check if its NSNull
[inputStr isEqual:[NSNull null]] ? nil : inputStr

//For validation in allowed character set
-(BOOL)validateString:(NSString*)inputStr
{
    BOOL isValid = NO;
    if(!([inputStr length]>0))
    {
        return isValid;

    }

    NSMutableCharacterSet *allowedSet = [NSMutableCharacterSet characterSetWithCharactersInString:@".-"];
    [allowedSet formUnionWithCharacterSet:[NSCharacterSet decimalDigitCharacterSet]];
    if ([inputStr rangeOfCharacterFromSet:[allowedSet invertedSet]].location == NSNotFound)
    {
        // contains only decimal set and '-' and '.'

    }
    else
    {
        // invalid
        isValid = NO;

    }
    return isValid;
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2018-09-20T21:01:48.730

尝试以下

```
NSString *stringToCheck = @"";

if ([stringToCheck isEqualToString:@""])
{
   NSLog(@"String Empty");
}
else
{
   NSLog(@"String Not Empty");
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2018-02-02T10:31:35.403

您可以通过两种方式获得一个空字符串：

1) @"" // 不包含空格

2) @" " // 包含空格

从技术上讲，两个字符串都是空的。我们可以通过使用**ONE Con​​dition**来编写这两件事

```
if ([firstNameTF.text stringByReplacingOccurrencesOfString:@" " withString:@""].length==0)
{
    NSLog(@"Empty String");
}
else
{
    NSLog(@"String contains some value");
} 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2014-09-18T11:34:49.587

```
if(str.length == 0 || [str isKindOfClass: [NSNull class]]){
    NSLog(@"String is empty");
}
else{
    NSLog(@"String is not empty");
} 
```

* * *

## 回答 #30

> 赞同：-2
> 
> 时间：2013-10-24T11:24:55.463

```
if( [txtMobile.text length] == 0 )
{
    [Utility showAlertWithTitleAndMessage: AMLocalizedString(@"Invalid Mobile No",nil) message: AMLocalizedString(@"Enter valid Mobile Number",nil)];
} 
```

# text - sifr 中的下划线文本

> ID：899222
> 
> 赞同：0
> 
> 时间：2009-05-22T18:15:09.133
> 
> 标签：text, sifr, replace, underline

我最近开始使用 sifr 作为使用 php 将文本生成为图像的健康替代方案。我有一个关于下划线文本的问题，对于网站设计，我需要能够指定下划线的粗细和与文本的距离，有没有办法用 sifr 来完成这个？如果没有，有没有办法用css解决这个问题？我一直在努力解决它，但由于我还没有找到一种方法来获得 sifr 文本的确切宽度，我怀疑它是否可能。

对此有什么想法吗？他们非常感激。

亲切的问候，泰斯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T19:42:17.333

我怀疑 Flash 渲染了一个假的下划线，不，你不能改变它的外观。唯一的选择是使用 HTML 和 CSS 在 Flash 电影下方呈现边框，但我不认为这会很好。

使用 sIFR 3，如果您`fitExactly: true`在替换中指定选项，则 Flash 影片将与内部文本的宽度相同。

# sharepoint - 在 Sharepoint 2003 中发布 Cognos 内容

> ID：899228
> 
> 赞同：0
> 
> 时间：2009-05-22T18:17:01.767
> 
> 标签：sharepoint, cognos

我有哪些选择？我正在研究名为 QueryVision 的第 3 方，但想探索其他替代方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-12T20:59:17.227

Cognos 8 can integrate with SharePoint 2003 directly. Check your Administration and Security guide - in recent versions there is a section dedicated to setting this integration up entitled "Deploying Cognos Portlets to Microsoft SharePoint Portal Server 2003 and 2007."

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-29T15:43:03.493

将 Cognos 内容直接集成到第 3 方门户和应用程序的一种方法是使用参数化 URL。这是 IBM 站点上最佳实践文档的链接。[在 IBM Cognos 8 中使用参数化 URL 执行任务](http://www.ibm.com/developerworks/data/library/cognos/page123.html "在 IBM Cognos 8 中使用参数化 URL 执行任务") 在第 15 页，它显示了将 Cognos 8 集成到 Sharepoint 的示例。

# java - 在手机中调用 System.gc()

> ID：899241
> 
> 赞同：1
> 
> 时间：2009-05-22T18:19:11.170
> 
> 标签：java, java-me, garbage-collection

我必须维护一个 J2ME 应用程序。`System.gc()`应用程序里面有很多。在调用 System.gc() 之前，所有属性都设置为 null。将属性设置为 null 有意义吗？打电话`System.gc()`有意义吗？jvm不应该在必要时调用垃圾收集器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T18:31:09.700

在一个好的现代 VM 上，调用 System.gc() 通常没有什么意义。将属性设置为 null 通常是没有意义的，除非这是使它们无法访问的唯一方法。

在不太复杂的 VM 上，您*可能*会在移动设备上使用，如果在方法的一部分中不再使用引用但仍在范围内，则将引用设为 null 可能是有意义的。（在像 Hotspot 这样的现代桌面虚拟机上，这通常不再需要 - 虚拟机前面有您的代码，并且通常可以确定您是否仍将使用本地引用，无论范围如何。）

现在，回到 System.gc()，确实，移动虚拟机在历史上一直比我们习惯的相当复杂的“完全成熟”的虚拟机（如 Hotspot）更简单。然而：

*   近年来，移动虚拟机出现了很多——对象吞吐量，就像性能的其他方面一样，在许多设备上都得到了明显的提高；
*   在任何情况下，**System.gc() 都没有一致的、明确定义的行为**。在某些设备上，它可能什么也不做；在其他情况下，与桌面虚拟机一样，与虚拟机在应用程序运行时自动执行的正常“渐进式”垃圾收集相比，它可能会导致一种实际上损害性能的垃圾收集。

所以我会非常警惕使用 System.gc()。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T18:33:26.327

在 Java 世界中，调用 System.gc() 确实会为您可靠地做一些事情，这是 Java 世界的一个大都市传说。它不会。

这只是 JVM 尝试做某事的建议。[在这方面，该方法](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/System.html#gc())的Javadoc故意模棱两可。

另一个大问题是将引用归零。当引用超出范围时，它已经被 VM 清空，自己这样做是多余的和误导性的。如果周围还有其他参考资料，它们仍然可用，您的作业将无济于事（除非您去访问所有其他可用的参考资料——但是，这有什么意义呢？这就是 VM 已经在做的事情）。

所以回答你的问题：

*   将属性设置为 null 很少有意义。正确设计您的软件，以便在您不再使用它们时参考超出范围。
*   调用 System.gc() 很少有意义。让 JVM 为您完成工作——这就是我们使用虚拟机而不是管理我们自己的内存的原因。
*   是的，让 VM 管理您的内存，它会在需要时进行 GC。但是，如果您的软件设计不佳，它可能会破坏 VM 中的 GC。在这种情况下，追踪您的内存泄漏并重构软件（尽管说起来容易做起来难）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-11T08:54:37.927

到目前为止，这个问题的所有答案都是完全正确的，主要是你不能依赖 System.gc() 来做任何事情。它是特定于平台的，MIDP2 没有给出任何关于它应该如何表现的真正规范。

然而它通常以合适的方式实现，虽然你不能说“这个对象*现在*被删除了”等等，我相信在某些情况下使用这个调用是可以接受的和可取的。例如，如果您的应用程序需要执行大量删除然后分配（例如重置或更改状态），立即进行调用将告诉 VM - 现在是收集的好时机。

詹姆士

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T20:08:48.087

所有属性和 System.gc() 调用为空的原因绝对是对抗设备碎片的一部分。很容易说你永远不应该自己为空值，你应该让它超出范围，实际上这是 PC 开发的适当方式。然而，移动空间是一种完全不同的动物，如果说您可以在有限的移动设备上处理内存管理，就像在拥有大量 RAM 的 PC 上一样，那将是天真的。

即使是现在，高端智能手机也有大约 32-64MB 的堆可供 J2ME 应用程序使用。许多设备仍然在 1-4MB 左右，并且通常为了满足运营商规范，您需要针对更小的堆大小。Razr 只有 800K 的堆，并且仍然需要大多数运营商的支持，因为他们的许多订户仍在使用该设备。

发生内存碎片是因为即使一块内存不再使用，它​​已被取消，但在被垃圾收集之前它还不可用。大多数移动虚拟机只在需要内存时进行 GC。因此，当它最终运行 GC 时，堆可能会被分割成很小的内存块。当需要分配较大的内存块时，它将无法分配给较小的块。如果您有足够多的这些较小的块污染堆，而没有为较大的对象提供足够大的块，最终您将获得 OutOfMemory 异常，即使看起来您有大量可用内存也是如此。

例如，假设您创建了一个需要 50 个字节的局部 Object 变量。接下来，您分配一个成员变量，该变量将在应用程序的整个生命周期中持续存在，需要 200 字节的堆存在。如果您一遍又一遍地执行此过程，您可能会遇到数千个只有 50 字节长度的内存块的情况。因为持久对象需要 200 个字节，所以最终会搞砸并得到 OutOfMemory 异常。

现在，如果您创建了相同的 String 对象，使用它，然后自己将其清空并调用 System.gc() （您可能还想调用 Thread.yield() 给 GC 一个运行的机会），那么您将拥有这 50 个可用于创建新持久对象的字节，避免碎片并避免最终的 OutOfMemory 异常。

这是一个非常基本的示例，但是如果您在游戏应用程序中有很多大图像，那么您在移动领域很快就会遇到这种情况。

最后一点，对于 BlackBerry 设备，您应该避免自己调用垃圾收集器，因为它要复杂得多（它会为您整理堆碎片）。与大多数设备上的正常停机和脏 GC 相比，更复杂的处理速度会慢得多（我们说的是每次运行几秒钟）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T18:23:36.250

将属性设置为 null（从而破坏对对象的一些引用）将使 GC 声明这些对象。也许它们不再需要了，开发人员想要释放一些内存？

我听说不是每个 J2ME 目标*都有*GC。但如果是这样，调用 System.gc() 是有意义的，这样垃圾收集器就不会在你做一些实时的事情时启动。

# c++ - 有没有一种简单的方法来迭代 C++ 中的静态字符串列表

> ID：899244
> 
> 赞同：4
> 
> 时间：2009-05-22T18:19:19.907
> 
> 标签：c++, string, iterator

我经常需要遍历 C++ 代码中的字符串列表。

在像 Perl 这样的语言中，这很容易：

```
foreach my $x ("abc", "xyz", "123") {.... } 
```

过去，这是我在 C++ 中所做的

```
const char* strs[] = { "abc", "xyz", "123" };
for (int i=0; i<sizeof(strs)/sizeof(const char*); i++) {
   const char *str = strs[i];
   ... 
```

如果我已经有一个 STL 容器，我可以使用 BOOST_FOREACH

```
std::vector<std::string> strs;
BOOST_FOREACH(std::string str, strs) {
   ... 
```

我试图创建一个宏来结合所有这些概念，但没有成功。

我希望能够编写这样的代码：

```
SPECIAL_STRING_FOREACH(const char* str, {"abc", "xyz", "123"}) {
   ...
} 
```

肯定有人以前做过这个。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T20:03:00.303

这是我的尝试。遗憾的是，它依赖于 C99/C++1x 特性的可变参数宏。但适用于 GCC。

```
#include <boost/foreach.hpp>
#include <boost/type_traits.hpp>
#include <iostream>

#define SEQ_FOR_EACH(D, ...)                                        \
    if(bool c = false) ; else                                       \
        for(boost::remove_reference<boost::function_traits<void(D)> \
                ::arg1_type>::type _t[] = __VA_ARGS__;              \
            !c; c = true)                                           \
            BOOST_FOREACH(D, _t)

int main() {
    SEQ_FOR_EACH(std::string &v, { "hello", "doctor" }) {
        std::cout << v << std::endl;
    }
} 
```

请注意，您还可以使用引用变量进行迭代，以避免无用的复制。这是一种使用`boost.preprocessor`和`(a)(b)...`语法，在预处理阶段后编译成相同的代码。

```
#define SEQ_FOR_EACH(D, SEQ)                                          \
    if(bool c = false) ; else                                         \
        for(boost::remove_reference<boost::function_traits<void(D)>   \
                ::arg1_type>::type _t[] = { BOOST_PP_SEQ_ENUM(SEQ) }; \
            !c; c = true)                                             \
            BOOST_FOREACH(D, _t)

int main() {
    SEQ_FOR_EACH(std::string &v, ("hello")("doctor")) {
        std::cout << v << std::endl;
    }
} 
```

诀窍是组装一个以枚举变量为参数的函数类型，并获取该参数的类型。然后`boost::remove_reference`将删除任何引用。使用的第一个版本`boost::decay`。但它也会将数组转换为指针，我发现这有时不是我们想要的。然后将结果类型用作数组元素类型。

要在枚举变量具有依赖类型的模板中使用，您必须使用另一个放在and`typename`之前的宏。可以命名它（D == 依赖）。`boost::remove_reference``boost::function_traits``SEQ_FOR_EACH_D`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T18:34:34.717

请注意，如果标记数组的结尾，则处理 C 字符串数组会更容易：

```
const char* strs[] = { "abc", "xyz", "123", NULL };
for (int i=0; strs[i] != NULL  i++) {
  ...
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T18:30:15.987

像这样的东西：

```
 void func( const char* s ) { /* ... */ }

const char* array[] = { "abc", "xyz", "123" };
std::for_each( array, array + 3, func ); 
```

您可能还想看看`boost::array`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T18:33:10.243

Cou 可以使用[`va_arg`](http://www.cppreference.com/wiki/c/other/va_arg)hack 来创建一个返回可迭代集合的函数（请注意，这真的是 hack！）

新的 C++ 标准 (C++0x) 将提供更方便的初始化方式（[初始化列表](http://en.wikipedia.org/wiki/C%2B%2B0x#Initializer_lists)）

另一种可能性是[`boost::assignment`](http://www.boost.org/doc/libs/1_35_0/libs/assign/doc/index.html)与 结合使用`FOREACH`。

请注意，这`BOOST::FOREACH`也适用于数组！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-22T19:15:46.857

制作一个返回数组大小的宏在这里会有所帮助。

```
#define N_ELEMS(a) (sizeof(a) / sizeof((a)[0])) 
```

那么你的原始代码看起来并不那么糟糕。

```
for(int i = 0; i < N_ELEMS(strs); ++i) {
  ...
} 
```

对于迭代任何静态数组，而不仅仅是字符串数组，这是一个很好的习惯用法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T18:29:34.350

而不是这个：

```
for (int i=0; i<sizeof(strs)/sizeof(const char*); i++)
{
    const char *str = strs[i];
    ... 
```

考虑一下：

```
for (const char *ptr = strs[0],
    *end = strs[sizeof(strs)/sizeof(const char*)];
    ptr < end; ++ptr)
{
    ... 
```

您可能会发现这种形式更容易宏观化；在任何情况下，该`ptr`变量都模拟了一个迭代器。

> 肯定有人以前做过这个。

我怀疑他们应该这样做。循环是惯用且易于阅读的`for`（特别是如果您知道数组的大小），用户定义的宏是非标准的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T18:35:39.163

这应该可以（我没有测试它，所以可能有一些错别字）

```
#define STR_ARRAY_FOREACH(I) const char* Items[] = I; for( const char *item = Items[0], *end = strs[ sizeof( Items ) / sizeof( const char* ) ]; item < end; ++item ) 
```

然后在循环中使用 item：

```
STR_ARRAY_FOREACH({ "abc", "xyz", "123" })
{
    cout << item << "\n";
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T21:11:50.973

我会尝试直接在阵列上使用 BOOST_FOREACH 。该[文档](http://www.boost.org/doc/libs/1_38_0/doc/html/foreach.html)似乎认为它会起作用。

事实上确实如此。它必须是两行，但它有效：

```
const char * myarray[] = {"abc", "xyz", "123"};
BOOST_FOREACH (const char *str, myarray) {
  std::cout << "Hello " << str << std::endl;
} 
```

# sql-server - 如何实现记录更改的自动时间戳（SQL Server）

> ID：899245
> 
> 赞同：7
> 
> 时间：2009-05-22T18:19:26.520
> 
> 标签：sql-server, asp.net-mvc, timestamp

我习惯于在 MySQL 数据库中使用“changed_at”字段，Ruby on Rails 在更改记录时会自动更新这些字段。

现在我将 ASP.NET MVC 与 SQL Server 2008 一起使用，我想知道如何继续获得相同的功能。SQL Server 是否有在更新时自动更新字段的选项？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T18:22:59.807

“时间戳”数据类型为您提供了一个二进制值，每次您的字段更改时都会自动更新，但它不会为您提供一个好的日期/时间值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T18:22:01.400

您可以使用触发器或仅在执行更新的 sp 中更新它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T18:25:20.537

做这个...

```
UPDATE YourTable
    SET Column1=@...
        ,@Column2=@....
        ,@Column3=@...
        ,changed_at=GETDATE()
    WHERE ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-04T13:30:48.317

您还可以使用具有相同效果但以后支持的**rowversion**

参考 - [http://msdn.microsoft.com/en-us/library/ms182776.aspx](http://msdn.microsoft.com/en-us/library/ms182776.aspx)

# html - 你可以 用css定位吗？

> ID：899252
> 
> 赞同：171
> 
> 时间：2009-05-22T18:20:13.557
> 
> 标签：html, css, line-breaks

`<br/>`是否可以使用 CSS定位换行标记？

每次有换行符时，我都希望有一条 1px 的虚线。我正在使用自己的 CSS 自定义网站，无法更改设置的 HTML，否则我会使用其他方式。

我认为这是不可能的，但也许有人知道。

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2009-05-22T18:41:11.510

`BR`生成一个换行符，它只是一个换行符。由于此元素没有内容，因此只有少数样式可以应用在其上，例如[`clear`](https://stackoverflow.com/questions/899252/can-you-target-br-with-css/899286#899286)或`position`。您可以设置`BR`的边框，但您不会看到它，因为它没有视觉尺寸。

如果您想在视觉上将两个句子分开，那么您可能想要使用为此目的而设计的[水平标尺。](http://reference.sitepoint.com/html/hr)由于您无法更改标记，恐怕仅使用 CSS 您无法实现这一点。

看来，它已经在其他论坛上讨论过了。摘自*[Re：使用 CSS 设置 BR 元素的高度](http://markmail.org/message/etkaz7zmqpdyrwqf)*：

> [T]这导致 BR 的状态有些奇怪，因为一方面它没有被视为普通元素，而是在生成的内容中作为 \A 的一个实例，但另一方面它被视为一个正常的元素，其中（有限的）CSS属性被允许在它上面。

我还在[CSS 1 规范](http://www.w3.org/TR/REC-CSS1/#br-elements)中找到了一个澄清（没有更高级别的规范提到它）：

> 当前的 CSS1 属性和值无法描述“BR”元素的行为。在 HTML 中，'BR' 元素指定单词之间的换行符。实际上，该元素被换行符替换。CSS 的未来版本可能会处理添加和替换的内容，但基于 CSS1 的格式化程序必须特别对待“BR”。

[Grant Wagner 的测试](https://stackoverflow.com/questions/899252/can-you-target-br-with-css/899501#899501)表明，没有办法`BR`像使用其他元素那样设置样式。还有一个在线站点，您可以在其中[在浏览器中测试结果](http://www.hixie.ch/tests/evil/mixed/hrbrstyles.html)。

**更新**

pelms 进行了一些进一步的调查，并[指出](https://stackoverflow.com/questions/899252/can-you-target-br-with-css/903804#903804)IE8（在 Win7 上）和 Chrome 2/Safari 4b 允许您进行`BR`一些样式设置。事实上，我使用[IE Net Renderer 的 IE8 引擎检查了](http://ipinfo.info/netrenderer/)[IE 演示页面](http://www.uwe.ac.uk/library/private/phil/br-test.htm)，它确实有效。

**更新 2** c69 进行了一些进一步的调查，结果证明您[可以](http://jsfiddle.net/w7gDE/1/)*对标记*进行大量样式设置`br`（虽然，不是跨浏览器），但这不会影响换行符本身，因为它似乎属于父容器。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2012-04-19T22:18:55.197

尝试以下方法，我使用来自另一个高票答案的更新 2 将它放在一起，它对我来说非常有效：

```
br
{   content: "A" !important;
    display: block !important;
    margin-bottom: 1.5em !important;
} 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2012-05-18T11:55:58.983

您需要为`<br>`标签设置样式有一个很好的理由。

当它是代码的一部分时，您不想（或不能）更改并且您希望`<br>`不显示此特定内容。

```
.xxx br {display:none} 
```

可以节省大量时间，有时甚至是您的一天。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-05-22T19:07:22.677

为了任何可能错过我评论的未来访问者的利益：

```
br {
    border-bottom:1px dashed black;
} 
```

不起作用。

它已经在 IE 6、7 和 8、Firefox 2、3 和 3.5B4、Safari 3 和 4 for Windows、Opera 9.6 和 10（alpha）和 Google Chrome（版本 2）中进行了测试，但在任何他们。如果将来某个时候有人发现浏览器支持`<br>`元素边框，请随时更新此列表。

另请注意，我尝试了许多其他事情：

```
br {
    border-bottom:1px dashed black;
    display:block;
}

br:before { /* and :after */
    border-bottom:1px dashed black;
    /* content and display added as per porneL's comment */
    content: "";
    display: block;
}

br { /* and :before and :after */
    content: url(a_dashed_line_image);
} 
```

其中，以下在 Opera 9.6 和 10 (alpha) 中有效（感谢porneL！）：

```
br:after {
    border-bottom:1px dashed black;
    content: "";
    display: block;
} 
```

当它仅在一个浏览器中支持时不是很有用，但我总是觉得看看不同的浏览器如何实现规范很有趣。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-05-24T13:51:32.530

```
br { padding: 1px 8px; border-bottom: 1px dashed #000 } 
```

在 IE8 中呈现如下......虽然在一个浏览器中使用并不多。

[![IE 8 截图](https://i.stack.imgur.com/ctkq3.gif)](https://i.stack.imgur.com/ctkq3.gif)

（注意我使用的是 IE 8.0.7100（在 Win7 RC 上），如果这有什么不同的话）

还，

```
br:after { content: "..." }  
br { content: "" }` 
```

或者，

```
br:after {
    border: 1px none black;
    border-bottom-style: dashed;
    content: "";
    padding: 0 6px 0;
} 
```

`br { content: "" }`

在 Chrome 2 / Safari 4b 中给出了一条虚线，但丢失了换行符（除非有人能想出一种重新引入它的方法），这使它变得毫无用处。

例如
[IE8 测试](http://www.uwe.ac.uk/library/private/phil/br-test.htm)、[Chrome/Safari](http://www.uwe.ac.uk/library/private/phil/br-test2.htm)[测试](http://www.uwe.ac.uk/library/private/phil/br-test3.htm)等

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-05-22T19:27:34.867

我知道你不能编辑 HTML，但是如果你可以修改 CSS，你可以添加 javascript 吗？

如果是这样，您可以包含 jquery，那么您可以这样做

```
<script language="javascript">
$(document).ready(function() {
    $('br').append('<span class="myclass"></span>');
});
</script> 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-06-10T15:44:29.720

**2019 年 9 月 13 日更新：**

像这样设置标签样式的目的`<br>`是为了做一个“更大”的换行符（即，在行之间留出一点额外的空间）。

"oldbig" 类（如下）在 Chrome 66.0.3359.181、Firefox Quantum 60.0.2、Edge 42.17134.1.0 和 IE 11.48.17134.0 中经过测试并正常工作，以设置`<br>`. 不幸的是，它在 Chrome 版本 76 及其衍生版本（大约 2019 年 8 月）中崩溃了。症状是不再显示行之间的额外空间。

“newbig”类在当前版本的 Chrome (76.0.3809.132)、Opera、Firefox、Edge、IE、Brave 和 Palemoon 中经过测试并正常工作：

```
br.oldbig {line-height:190%;vertical-align:top;}
br.newbig {display:block;content:"";margin-top:0.5em;line-height:190%;vertical-align:top;} 
```

这是一个演示：

```
br.oldbig {line-height:175%;vertical-align:top;}
br.newbig {display:block;content:"";margin-top:0.5em;line-height:190%;vertical-align:top;}
```

```
<p style="max-width:20em">This is a paragraph which demonstrates the difference 
 between a line-break which occurs when the text exceeds the max-width, and a 
 line-break forced by a &lt;br&gt; tag here:<br>
 and a line break forced by a &lt;br class=oldbig&gt; tag here:<br class=oldbig>
 and a line break forced by a &lt;br class=newbig&gt; tag here:<br class=newbig>
 This is the next line after the &lt;br class=newbig&gt; tag (but still 
 part of the same paragraph).</p>
<p style="max-width:20em">And this is another paragraph, entirely.</p>
```

这是 Chrome v.76 中显示的结果：

[![截屏](https://sealevel.info/demo_big_br_tag2.png)](https://sealevel.info/demo_big_br_tag2.png)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-26T22:50:04.653

我自己的测试最终表明`br`标签不喜欢作为 css 的目标。

但是，如果您可以添加样式，那么您可能还可以在页面标题中添加一个脚本标签？链接到执行以下操作的外部`.js`：

```
function replaceLineBreaksWithHorizontalRulesInElement( element )
{
    elems = element.getElementsByTagName( 'br' );
    for ( var i = 0; i < elems.length; i ++ )
    {
        br = elems.item( i );
        hr = document.createElement( 'hr' );
        br.parentNode.replaceChild( hr, br );
    }
} 
```

所以简而言之，这不是最佳的，但这[是我的解决方案。](http://develop.theredhead.nl/~kris/stackoverflow/styleabreak.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-22T18:40:11.540

BR 是内联元素，而不是块元素。

所以，你需要：

```
 br.Underline{
    border-bottom:1px dashed black;
    display: block;
  } 
```

否则，对此类事情比较挑剔的浏览器将拒绝为您的 BR 元素应用边框，因为内联元素没有边框、填充或边距。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-09-18T08:57:37.743

老问题，但这是一个非常整洁和干净的解决方案，可能会用于仍然想知道是否可能的人:)：

```
br{
    content: '.';
    display: inline-block;
    width: 100%;
    border-bottom: 1px dashed black;
}
```

通过此修复，您还可以删除网站上的 BR（只需将宽度设置为 0px）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-08-24T03:20:30.093

这似乎解决了这个问题：

```
<!DOCTYPE html>

<style type="text/css">
#someContainer br { display:none }
#someContainer br + a:before { content:"|"; color: transparent; letter-spacing:-100px; border-left: 1px dashed black; margin:0 5px; }
</style>

<div id="someContainer"><a>link</a><br /><a>link</a><br /><a>link</a></div> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-22T19:47:05.403

这将有效，但仅在 IE 中有效。我在IE8中测试过。

```
br {

  border-bottom: 1px dashed #000000;
  background-color: #ffffff;
  display: block;
  } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-05-13T17:23:06.663

我将`<br>`标签放入`<span>`标签中，并且能够使用媒体查询`display:none;`来`<span>`控制何时不使用标签。`<br>`

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-08-24T19:20:26.313

这是 CSS 101。

为什么让简单的事情变得如此困难？？？？为什么
首先使用？

在写作时按回车键不是更容易，并且在每行文本之后开始一个新段落吗？

您仍然可以通过限制内边距和边距使其看起来像您使用过的 < /br>。然后在 CSS 中为 p 选择器设置下边框样式。

如果您希望最后一行文本下面没有虚线，仅在文本行之间（作为视觉分隔），只需在

仅最后一行文本的标签，并为其编写 CSS。

在这里查看：

```
p {
  padding-bottom: 10px;
  margin-top: 0px;
  margin-bottom: 10px;
  border-bottom: dashed 2px #777;
  }

 p#lastLine {
 border-bottom: none;
 }
```

```
<p>
This is a line of some very nice text. And mind you, this is no joke!
</p>
<p >
And this is another line of some very nice text. 
</p>
<p >
And this is another line of some very nice text. 
</p>
<p >
And this is another line of some very nice text. 
</p>
<p id="lastLine">
And this THE LAST LINE line of some very nice text. This is great!
</p>
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2009-06-24T16:33:45.873

为什么不直接使用 HR 标签？它完全符合您的要求。有点像当你面前的桌子上有勺子时试图做一个叉子来吃汤。

# javascript - 为什么 HTML 表单不能加载到 Javascript 创建的 iframe 中？

> ID：899258
> 
> 赞同：1
> 
> 时间：2009-05-22T18:21:48.467
> 
> 标签：javascript, html, forms, iframe, greasemonkey

因此，在纯 HTML 中，我可以创建一个将其结果加载到 iframe 的表单（而不是将用户移动到结果 url）。

```
<html>
  <head>
    <title>Google Preview</title>
    <style>iframe { width: 800px; height: 600px }</style>
  </head>
  <body>
    <form method='get' action='http://www.google.com/search' target='results'>
      <label for='q'>Google Search:</label>
      <input name='q'/>
    </form>
    <!-- form result loads in this iframe -->
    <iframe name='results'></iframe>
  </body>
</html> 
```

我正在尝试在 Greasemonkey 中做类似的事情，但遇到了问题。

我有一个带有表单的页面，我宁愿将其结果加载到 iframe 中，因此我创建了一个 iframe，并更改表单`target`以匹配 iframe 的名称。但是，这不会在 iframe 中加载结果页面，而是在新选项卡中打开结果页面。

我已将问题追溯到使用 Javascript 创建 iframe。似乎将 iframe 插入 DOM 就好了（看看 firebug，生成的源几乎与上面的相同，除了一个额外的`<script>`标签）。但是当我在 Javascript 中创建 iframe 时，我得到了“在新选项卡中打开结果”的行为。

```
<html>
  <head>
    <title>Google Preview</title>
    <style>iframe { width: 800px; height: 600px }</style>
  </head>
  <body>
    <form method='get' action='http://www.google.com/search' target='results'>
      <label for='q'>Google Search:</label>
      <input name='q'/>
    </form>
    <script>
      try {
        // form result doesn't load in this iframe, for some reason
        const iframe = document.body.appendChild( document.createElement('iframe') );
        iframe.name = 'results';
      } catch (e) {
        alert(e);
      }
    </script>
  </body>
</html> 
```

我需要做什么才能将结果加载到由 Javascript 创建的 iframe 中？（我还没有尝试过`document.write()`，但我不确定这对 Greasemonkey 是否有用）。

**更新**：所以我开始尝试`document.write()`，它有效。所以也许我只需要弄清楚如何从 GreaseMonkey 中使用它（不会弄乱我有句柄的大量 DOM 元素）

```
<html>
  <head>
    <title>Google Preview</title>
    <style>iframe { width: 800px; height: 600px }</style>
  </head>
  <body>
    <form method='get' action='http://www.google.com/search' target='results'>
      <label for='q'>Google Search:</label>
      <input name='q'/>
    </form>
    <script>
      try {
        // but form result will load in this iframe
        document.write('<iframe name="results"></iframe>');
      } catch (e) {
        alert(e);
      }
    </script>
  </body>
</html> 
```

我仍然想知道为什么`document.body.appendChild()`不起作用，但`document.write()`确实如此。

**更新²**：它似乎不仅仅是表格，我可以用一个链接代替，`<form>...</form>`并在所有三种情况下得到相同的结果

```
<div><a target="results" href="http://www.google.com">test</a></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T04:00:55.177

好的，我想出了一个令人满意的解决方案。我需要在调用*之前*`appendChild()`定义 iframe 名称。

```
<html>
  <head>
    <title>Google Preview</title>
    <style>iframe { width: 800px; height: 600px }</style>
  </head>
  <body>
    <div><a target="results" href="http://www.google.com">test</a></div>
    <script>
      try {
        // this works
        const iframe = document.createElement('iframe');
        iframe.name = 'results';
        document.body.appendChild( iframe );
      } catch (e) {
        alert(e);
      }
    </script>
  </body>
</html> 
```

我不确定为什么在将名称附加到文档后设置名称不起作用（我仍然想知道是否有人想要 15 分），但这让我可以继续使用 GreaseMonkeying，所以它已经足够好了.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-22T18:29:52.277

嗯，我在想，因为它仍在回发给自己，所以永远不会创建框架（因为每次回发时都会在页面上创建和呈现表单）

# nhibernate - NHibernate 多个数据库提供程序

> ID：899264
> 
> 赞同：4
> 
> 时间：2009-05-22T18:22:32.053
> 
> 标签：nhibernate

我有一个在客户端上运行的 WPF 应用程序。我有两个不同的应用程序使用的数据库。一种是用于应用程序数据的 SQL Server 2008，另一种是用于存储在客户端上的用户设置的 Sql Server Compact。我正在使用 app.config 来配置 NHibernate。我看过很多文章在类映射文件中使用“schema”属性，但只有在我连接到同一个 SQL Server 时才有效。如何配置 NHibernate 以设置两个不同的会话工厂？

如果可能的话，我想在 app.config 文件中配置它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-01-22T01:21:51.570

[看看这篇很棒的文章：将 NHibernate 与多个数据库一起使用](http://codebetter.com/blogs/karlseguin/archive/2009/03/30/using-nhibernate-with-multiple-databases.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T19:59:09.357

在我将所有东西都转换为使用 Fluent NHibernate 和依赖注入之前，我公司的 NH 库被配置为使用多个数据库，并且可以通过 app.config 进行配置（在这种情况下是 web.config）。我相信它使用了基于 Bill McCafferty 的[CodeProject 文章](http://www.codeproject.com/KB/aspnet/NHibernateMultipleDBs.aspx)中的会话管理器。

如果你不需要那么复杂的东西，它在很大程度上是一个有用的包装器：

```
Configuration cfg = new Configuration();
cfg.Configure(sessionFactoryConfigPath);
sessionFactory = cfg.BuildSessionFactory(); 
```

您可以使用上述方法创建自己的方法来传递会话工厂配置文件并实例化您的会话工厂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-11T16:55:10.467

您可能还想看看这个答案。它与您在问题中描述的完全一样。[配置 NHibernate hibernate.cfg.xml 文件以获得更多连接字符串](https://stackoverflow.com/questions/10450300/configure-nhibernate-hibernate-cfg-xml-file-to-have-more-connection-strings/10645667#10645667)

# python - 如何在 Python 中向上查找文件？

> ID：899273
> 
> 赞同：2
> 
> 时间：2009-05-22T18:23:48.760
> 
> 标签：python

在 Python 中“向上”查找文件的最佳方法是什么？（理想情况下它也可以在 Windows 上运行）。例如，

```
>>> os.makedirs('/tmp/foo/bar/baz/qux')
>>> open('/tmp/foo/findme.txt', 'w').close()
>>> os.chdir('/tmp/foo/bar/baz/qux')
>>> findup('findme.txt')
'/tmp/foo/findme.txt' 
```

据我所知，Python 标准库中没有任何内容（尽管我很想被证明是错误的）。此外，谷歌搜索并没有太多确定的结果。我想知道是否有“每个人”都在使用的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T19:33:25.027

```
import os

def findup(filename):
    drive, thisdir = os.path.splitdrive(os.getcwd())
    while True:
        fullpath = os.path.join(drive, thisdir, filename)
        if os.path.isfile(fullpath):
            return fullpath
        if thisdir == os.path.sep: #root dir
            raise LookupError('file not found: %r' % filename)
        thisdir = os.path.dirname(thisdir)

os.makedirs('/tmp/foo/bar/baz/qux')
open('/tmp/foo/findme.txt', 'w').close()
os.chdir('/tmp/foo/bar/baz/qux')
print findup('findme.txt') 
```

印刷：

```
/tmp/foo/findme.txt 
```

也适用于 Windows。可能适用于任何平台。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T18:28:23.637

os.path 模块有你需要的东西，特别是：abspath()（如果路径不是绝对的）、dirname()、isfile() 和 join()。

```
dir = os.path.curdir()
filename = None
while True:
    filename = os.path.join(dir, 'filename')
    if os.path.isfile(filename):
        break
    updir = os.path.dirname(dir)
    if updir == dir:
        filename = None
        break
    dir = updir 
```

编辑：将 posixpath 更改为 os.path 以便在 Windows 上运行。

编辑 x2：添加代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-22T18:31:45.520

I found myself in need of a findup function similar to the node.js version as well, opted for a recursive implementation:

```
import os

def findup(filename, dir = os.getcwd()):
    def inner(drive, dir, filename):
        filepath = os.path.join(drive, dir, filename)
        if os.path.isfile(filepath):
            return filepath
        if dir == os.path.sep:
            raise LookupError('file not found: %s' % filename)
        return inner(drive, os.path.dirname(dir), filename)
    drive, start = os.path.splitdrive(os.path.abspath(dir))
    return inner(drive, start, filename) 
```

# maven-2 - 为自定义 Maven 2 属性设置默认值

> ID：899274
> 
> 赞同：68
> 
> 时间：2009-05-22T18:24:08.057
> 
> 标签：maven-2, properties

我有一个带有插件的 Maven pom.xml，我希望能够在命令行上控制它。一切正常，除了即使在网上搜索了一段时间后我也无法弄清楚如何为我的控件属性设置默认值：

```
<plugin>
    ...
    <configuration>
        <param>${myProperty}</param>
    </configuration>
    ...
</plugin> 
```

所以如果我运行 Maven

```
mvn -DmyProperty=something ... 
```

一切都很好，但我想在没有`-DmyProperty=...`开关的情况下也为 myProperty 分配一个特定的值。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2013-08-05T14:42:35.627

您可以`<build>/<properties>`在配置文件中或配置文件中定义属性默认值，如下所示。当您在命令行上提供属性值时`-DmyProperty=anotherValue`，它将覆盖 POM 中的定义。也就是说， POM 中的**所有**属性值定义都只设置了属性的*默认*值。

```
<profile>
    ...
    <properties>
        <myProperty>defaultValue</myProperty>            
    </properties>
    ...
       <configuration>
          <param>${myProperty}</param>
       </configuration>
    ...
</profile> 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-05-28T18:19:11.787

Taylor L 的方法效果很好，但您不需要额外的配置文件。您可以只在 POM 文件中声明属性值。

```
<project>
  ...
  <properties>
    <!-- Sets the location that Apache Cargo will use to install containers when they are downloaded. 
         Executions of the plug-in should append the container name and version to this path. 
         E.g. apache-tomcat-5.5.20 --> 
    <cargo.container.install.dir>${user.home}/.m2/cargo/containers</cargo.container.install.dir> 
  </properties> 
</project> 
```

如果您希望每个用户能够设置自己的默认值，您还可以在用户 settings.xml 文件中设置属性。我们使用这种方法向常规开发人员隐藏 CI 服务器用于某些插件的凭据。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-05-22T19:06:32.523

您可以使用以下内容：

```
<profile>
    <id>default</id>
    <properties>
        <env>default</env>
        <myProperty>someValue</myProperty>            
    </properties>
    <activation>
        <activeByDefault>true</activeByDefault>
    </activation>
</profile> 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-01-08T10:17:02.217

@akostadinov 的解决方案非常适合常见用途......但是如果反应器组件在依赖关系解析阶段（在 mvn pom 层次结构处理的早期......）应该使用所需的属性，您应该使用配置文件“*无激活*”测试机制来确保可选的命令行提供的值总是优先于 pom.xml 中提供的值。无论你的 pom 层次结构有多深。

为此，请在您的父 pom.xml 中添加这种配置文件：

```
 <profiles>
    <profile>
      <id>my.property</id>
      <activation>
        <property>
          <name>!my.property</name>
        </property>
      </activation>
      <properties>
        <my.property>${an.other.property} or a_static_value</my.property>
      </properties>
    </profile>
  </profiles> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T19:05:49.373

这可能对您有用：

```
<profiles>
  <profile>
    <id>default</id>
    <activation>
      <activeByDefault>true</activeByDefault>
    </activation>
    <build>
     <plugin>
       <configuration>
        <param>Foo</param>
       </configuration>
     </plugin>
    </build>
    ...
  </profile>
  <profile>
    <id>notdefault</id>
    ...
     <build>
      <plugin>
        <configuration>
            <param>${myProperty}</param>
        </configuration>
     </plugin>
     </build>
    ...
  </profile>
</profiles> 
```

那样，

`mvn clean`将使用“foo”作为您的默认参数。如果您需要覆盖，请使用`mvn -P notdefault -DmyProperty=something`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-21T10:59:58.447

我采用了sal 的方法，但把它弄平了一点。

```
<profiles>
  <profile>
    <id>default</id>
    <activation>
      <activeByDefault>true</activeByDefault>
    </activation>
    <build>
     <plugin>
       <configuration>
        <version>LATEST</version>
       </configuration>
     </plugin>
    </build>
  </profile>
</profiles> 
```

现在您有 2 个选项：

1.  使用默认值：MVN 安装（所有 $version 将替换为 LATEST）

2.  使用自己的值：MVN install -P! 默认 -Dversion=0.9（所有 $version 都是 0.9）

# javascript - 用于链接替换的 Javascript 文本

> ID：899275
> 
> 赞同：0
> 
> 时间：2009-05-22T18:24:17.107
> 
> 标签：javascript, regex, replace

我需要将文本替换为链接

链接必须类似于“ href="/search?q=$oldtext" title="$oldtext" "。$oldtext 是要替换的文本。

我尝试使用循环查找带有正则表达式“/^\x23\w/”的文本，并替换为包含生成链接的变量。结果一无所获。我已将正则表达式编辑为“/\x23/”并仅在文本模式下替换“#”（十六进制中的\x23=））字符=（

帮帮我，我卡住了

更新：我在 [span class="text2replace"]super text #replacemetolink[/span] 之间有文本块我需要将 #replacemetolink 替换为链接 [a href="/timeline/search?q=#replacemetolink" title="#替换metolink" 类="搜索链接"]。我正在尝试使用 Opera 到 Twitter 的 usejs 将 #hashtags 替换为使用 Twitter 搜索搜索此主题标签的链接

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T19:05:09.840

你有没有尝试过：

```
var newText = 'Query';
var link = ' href="/search?q=$oldtext" title="$oldtext" ';
link.replace("$oldtext", newText); 
```

这将用存储在 newText 中的字符串替换所有 '$oldtext' 实例。

凯尔

# python - 如何解析字符串看起来像 sys.argv

> ID：899276
> 
> 赞同：47
> 
> 时间：2009-05-22T18:24:25.187
> 
> 标签：python, parsing, argv

我想解析这样的字符串：

```
-o 1  --long "Some long string" 
```

进入这个：

```
["-o", "1", "--long", 'Some long string'] 
```

或类似的。

这与 getopt 或 optparse 不同，后者以 sys.argv 解析输入*开头*（就像我上面的输出一样）。有没有标准的方法来做到这一点？基本上，这是“拆分”，同时将引用的字符串保持在一起。

到目前为止我最好的功能：

```
import csv
def split_quote(string,quotechar='"'):
    '''

    >>> split_quote('--blah "Some argument" here')
    ['--blah', 'Some argument', 'here']

    >>> split_quote("--blah 'Some argument' here", quotechar="'")
    ['--blah', 'Some argument', 'here']
    '''
    s = csv.StringIO(string)
    C = csv.reader(s, delimiter=" ",quotechar=quotechar)
    return list(C)[0] 
```

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-05-22T18:33:07.887

我相信你想要[shlex](http://docs.python.org/library/shlex.html)模块。

```
>>> import shlex
>>> shlex.split('-o 1 --long "Some long string"')
['-o', '1', '--long', 'Some long string'] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-13T22:55:23.003

在我意识到之前[`shlex.split`](http://docs.python.org/2/library/shlex.html#shlex.split)，我做了以下事情：

```
import sys

_WORD_DIVIDERS = set((' ', '\t', '\r', '\n'))

_QUOTE_CHARS_DICT = {
    '\\':   '\\',
    ' ':    ' ',
    '"':    '"',
    'r':    '\r',
    'n':    '\n',
    't':    '\t',
}

def _raise_type_error():
    raise TypeError("Bytes must be decoded to Unicode first")

def parse_to_argv_gen(instring):
    is_in_quotes = False
    instring_iter = iter(instring)
    join_string = instring[0:0]

    c_list = []
    c = ' '
    while True:
        # Skip whitespace
        try:
            while True:
                if not isinstance(c, str) and sys.version_info[0] >= 3:
                    _raise_type_error()
                if c not in _WORD_DIVIDERS:
                    break
                c = next(instring_iter)
        except StopIteration:
            break
        # Read word
        try:
            while True:
                if not isinstance(c, str) and sys.version_info[0] >= 3:
                    _raise_type_error()
                if not is_in_quotes and c in _WORD_DIVIDERS:
                    break
                if c == '"':
                    is_in_quotes = not is_in_quotes
                    c = None
                elif c == '\\':
                    c = next(instring_iter)
                    c = _QUOTE_CHARS_DICT.get(c)
                if c is not None:
                    c_list.append(c)
                c = next(instring_iter)
            yield join_string.join(c_list)
            c_list = []
        except StopIteration:
            yield join_string.join(c_list)
            break

def parse_to_argv(instring):
    return list(parse_to_argv_gen(instring)) 
```

这适用于 Python 2.x 和 3.x。在 Python 2.x 上，它直接处理字节字符串和 Unicode 字符串。在 Python 3.x 上，*它只*接受 [Unicode] 字符串，而不接受`bytes`对象。

这与 shell argv 拆分的行为并不完全相同——它还允许将 CR、LF 和 TAB 字符引用为`\r`,`\n`和`\t`，并将它们转换为真正的 CR、LF、TAB （`shlex.split`不这样做）。所以编写我自己的函数对我的需求很有用。我想`shlex.split`如果你只想要简单的 shell 样式的 argv 拆分会更好。我正在分享这段代码，以防它作为基线来做一些稍微不同的事情。

# ruby-on-rails - 在将用户输入传递给 %x （执行它）之前，我应该如何清理它？

> ID：899277
> 
> 赞同：4
> 
> 时间：2009-05-22T18:24:36.810
> 
> 标签：ruby-on-rails, ruby

我从用户那里获取一个输入字符串，并将其用作命令行后端程序的参数。

确保此输入“安全”的最佳方法是什么？也就是他们没有在字段中插入“; cd /; rm -rf”或其他一些丑陋的东西？

没有任何消毒，我有...

```
@query = params[:query]
@result = %x( mycommand #{@query} ) 
```

我需要获取命令的输出，所以我不能使用 system("command","parameters") 因为它只返回 true 或 false 但会提供保护。

我知道这很危险...在此先感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T19:01:37.960

永远，**永远**定义你会接受什么，然后否认其他一切。人们常常试图允许一切，然后否认坏事。

1.  从字符开始。即，如果 `mycommand`只需要字母数字输入加上空格，则只允许这样做。不会有“ `rm -rf /`”潜入的机会，也没有其他需要标点符号的10,000件事。
2.  是否有进一步的句法/语义`mycommand` 可用于定义“好”输入？比如它需要正好 2 个空格分隔的参数？

不知道是什么`mycommand`我不能提供细节，但你明白了：不要试图扔掉不好的东西；定义有效并丢弃其他所有内容。请注意，这仍然很难，但没有这种方法几乎是不可能的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T19:01:47.413

由于执行命令的性质，我可能会说您应该使用白名单来确保只运行预期的命令。不过，这让我觉得相当危险！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T15:08:36.317

如果正如您在对 dwc 的回复中所说，您需要一个域名（我假设您的意思是完全合格的）或 IP 地址，您可以使用 Resolv 对它们进行查找，并且只有在存在匹配的 A/CNAME 时才接受它们域名的情况下，或 IP 的情况下的 PTR。

如果他们输入没有反向 ptr 的 IP，您可能会遇到问题。如果他们输入没有 A/CNAME 的域名，那么您的命令很可能无论如何都会失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T15:42:31.723

另一种选择，如果您的命令是有界的，您可以在命令下拉列表中创建一个列表，并将参数放入其他字段/复选框/下拉列表中。然后按照 Mike 的建议验证每个参数。

这将阻止任何用户输入的值真正进入命令行。

# .net - 为什么 BinaryReader.ReadUInt32() 反转位模式？

> ID：899279
> 
> 赞同：8
> 
> 时间：2009-05-22T18:25:08.307
> 
> 标签：.net, 64-bit, bit-manipulation, 32-bit, endianness

我正在尝试使用 BinaryReader 类读取二进制文件，我需要将其作为 UInt32 块读取，然后进行一些位移等。

但是，由于某种原因，当我使用 ReadUInt32 方法时，位顺序颠倒了。

例如，如果我有一个文件，其中前四个字节在 hex, 中看起来像这样`0x12345678`，它们在被 ReadUInt32: 读取后最终是这样的`0x78563412`。

如果我使用 ReadBytes(4) 方法，我会得到预期的数组：

```
[0x00000000]    0x12    byte
[0x00000001]    0x34    byte
[0x00000002]    0x56    byte
[0x00000003]    0x78    byte 
```

为什么是这样？它只是 .net 表示内存中的 uint 的方式吗？在不同平台上是否相同（我运行的是 64 位 Windows 7、.net 3.5 sp1）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T18:30:23.117

是的，这与您的计算机硬件在内存中存储 uint 的方式有关。尽管大多数台式计算机应该相同，但它在不同平台上可能会有所不同。

这称为字节序 - 请参阅此处的维基百科：

[http://en.wikipedia.org/wiki/Endian](http://en.wikipedia.org/wiki/Endian)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-22T18:31:08.000

这似乎是一个[字节顺序](http://en.wikipedia.org/wiki/Endianness)问题。 [文档](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.readuint32.aspx)说 ReadUint32 以 little-endian 方式读取，因此第一个字节是最不重要的，因此它会到达最低的内存位置。你的作者一定是大端的？

`BinaryWriter.Write(UInt32)` [说它也写](http://msdn.microsoft.com/en-us/library/d79ecdwh.aspx)小端。你的二进制数据源不是 BinaryWriter 吗？

基本上你需要做的是修复它：

```
uint a = 0x12345678;
uint b = ((a & 0x000000FF) << 24) + ((a & 0x0000FF00) << 8) + ((a & 0x00FF0000) >> 8) + ((a & 0xFF000000) >> 24); 
```

这会将最低有效字节向上移动 24 位，将第 2 个 LSB 向上移动 8 位，将第 3 个 LSB 向下移动 8 位，将第 4 LSB（MSB）向下移动 24 位。这在几个库中都有介绍。

也许使用`BitConverter`会更清楚一点：

```
uint a = 0x12345678;
byte[] bytes = BitConverter.GetBytes(a);
// Swap byte order
uint b = BitConverter.ToUInt32(new byte[] { bytes[3], bytes[2], bytes[1], bytes[0] }, 0); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T18:33:39.400

查看 Jon Skeet 的 MiscUtil 库中的 Endian* 类，例如 EndianBinaryReader 和 EndianBitConverter。

[http://www.yoda.arachsys.com/csharp/miscutil/](http://www.yoda.arachsys.com/csharp/miscutil/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T18:33:45.733

Jon Skeet 编写了一个具有可配置字节序的 BitConverter。你可能会发现它很有用。

[http://www.yoda.arachsys.com/csharp/miscutil/](http://www.yoda.arachsys.com/csharp/miscutil/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T18:33:30.337

这是平台[Endianess](http://en.wikipedia.org/wiki/Endianness)的问题。当您从流中读取数据时，您必须根据其写入的字节顺序读取它。如果您在 .Net 中创建数据，那么 .Net 将正确读取它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-18T01:04:53.043

阅读[Generic BinaryReader 和 BinaryWriter Extensions](http://www.codeproject.com/KB/dotnet/genericbitconv.aspx)，这是一种以非托管方式处理泛型转换的好方法。

对于 VB.NET（仅限安全代码，也可以在 C# 中实现）使用以下内容：

导入 System.IO 导入 System.Runtime.CompilerServices 导入 System.Runtime.InteropServices

```
<HideModuleName()>
Public Module BinaryReaderExtensions

 <Extension()>
 Public Function Read(Of T As Structure)(br As BinaryReader) As T
  Dim bytes = br.ReadBytes(Marshal.SizeOf(GetType(T)))
  Dim handle = GCHandle.Alloc(bytes, GCHandleType.Pinned)
  Return Marshal.PtrToStructure(handle.AddrOfPinnedObject, GetType(T))
 End Function

 <Extension()>
 Public Function ReadReverse(Of T As Structure)(br As BinaryReader) As T
  Dim bytes = br.ReadBytes(Marshal.SizeOf(GetType(T))).Reverse.ToArray
  Dim handle = GCHandle.Alloc(bytes, GCHandleType.Pinned)
  Return Marshal.PtrToStructure(handle.AddrOfPinnedObject, GetType(T))
 End Function

End Module 
```

您现在可以为[`BitConverter`](http://msdn.microsoft.com/en-us/library/system.bitconverter.aspx)、 for[`BinaryWriter`](http://msdn.microsoft.com/en-us/library/system.io.binarywriter.aspx)等实现相同的功能。

# dojo - dojo gfx 的文本长度

> ID：899296
> 
> 赞同：2
> 
> 时间：2009-05-22T18:28:08.580
> 
> 标签：dojo

在使用 dojo 的 gfx 渲染文本时，有没有办法告诉文本将占用多少空间，以防我需要包装它以使其适合给定的宽度？如果您必须使它们适合宽度受限的区域，您将如何管理打印任意长度的文本？

**更新**：对不起，我应该提到我需要在服务器端进行包装。我的应用程序必须弄清楚所有元素的大小和位置，然后渲染最终绘制它们的 gfx 脚本。我知道我将与 gfx 一起使用的字体和字体大小。包装字符串会导致呈现多个 createText 调用。问题是，如何拆分字符串？（如果字体是固定宽度的，这应该是微不足道的）

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T05:27:37.497

我建议使用`dojox.html.metrics`模块，特别是`getTextBox(text, style)`功能。只需使用您将使用的相同样式`dojox.gfx`：字体、大小、装饰。

如果你看这个函数，你会发现它是一个简单的帮助器[`dojo.marginBox()`](http://docs.dojocampus.org/dojo/marginBox)，所以如果你不想拉入另一个文件，你可以在你的代码中做同样的事情并`marginBox()`直接调用，它在 Dojo Base 中并且总是可用的。

# c# - 检测用户是否在组中

> ID：899303
> 
> 赞同：0
> 
> 时间：2009-05-22T18:29:55.147
> 
> 标签：c#, .net, vb.net

如何检测任意用户是否是机器上的管理员？我有用户的域和用户名，但没有密码。该用户不是当前登录的用户，所以我不能只使用 WindowsIdentity.GetCurrent。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T18:42:43.330

使用[UserPrincipal.GetAuthorizationGroups](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.userprincipal.getauthorizationgroups.aspx)检查用户是否在允许对计算机进行管理访问的组中。

首先使用 FindByIdentity 获取一个 UserPrincipal 对象。然后获取用户所属的授权组。检查每个组以查看是否与内置管理员组匹配。如果内置管理员组不在用户的授权组中，则该用户不是本地计算机上的管理员。

```
using System.DirectoryServices.AccountManagement;
using System.Linq;

var name = Environment.UserName;
var user = UserPrincipal.FindByIdentity( new PrincipalContext( ContextType.Domain ), name );
var groups = user.GetAuthorizationGroups();
var isAdmin = groups.Any( g => g.Name == "Administrators" );    
Console.WriteLine( "Admin: " + isAdmin ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T18:35:05.090

使用 LDAP。[请参阅此处](http://www.codeproject.com/KB/system/everythingInAD.aspx#38)的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T18:41:27.390

您可以使用 System.DirectoryServices 首先加载本地计算机，然后搜索给定组中的任何用户。试试下面的代码：

```
DirectoryEntry localMachine = new DirectoryEntry("WinNT://" + Environment.MachineName);
DirectoryEntry admGroup = localMachine.Children.Find("administrators","group");
object members = admGroup.Invoke("members", null); 
```

然后为 members 对象中的每个成员创建一个新的 DirectoryEntry：

```
foreach (object groupMember in (IEnumerable)members)
{
  DirectoryEntry member = new DirectoryEntry(groupMember);
  //Do what you want
} 
```

该 foreach 循环内部的成员对象有大量关于其中的用户的数据。将您的成员名称与循环中的当前名称进行比较：

```
if (memberSearch.name == member.name) {
  return true;
} else {
  return false;
} 
```

您还可以搜索成员对象以查找用户等。有很多方法可以做到这一点。希望这可以帮助！

# sql-server - 从 SQL Server 2008 中的 XML 字段中选择值

> ID：899313
> 
> 赞同：122
> 
> 时间：2009-05-22T18:32:45.517
> 
> 标签：sql-server, xml, xpath

看看我的 XML 字段，我的行如下所示：

```
<person><firstName>Jon</firstName><lastName>Johnson</lastName></person>
<person><firstName>Kathy</firstName><lastName>Carter</lastName></person>
<person><firstName>Bob</firstName><lastName>Burns</lastName></person> 
```

请注意，这些是我表中的三行。

我想将 SQL 结果作为表返回，如

```
Jon  | Johnson
Kathy| Carter
Bob  | Burns 
```

什么查询将完成此操作？

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2009-05-22T18:39:47.580

鉴于 XML 字段名为“xmlField”...

```
SELECT 
[xmlField].value('(/person//firstName/node())[1]', 'nvarchar(max)') as FirstName,
[xmlField].value('(/person//lastName/node())[1]', 'nvarchar(max)') as LastName
FROM [myTable] 
```

* * *

## 回答 #2

> 赞同：127
> 
> 时间：2009-05-22T18:44:35.917

考虑到 XML 数据来自表“表”并存储在“字段”列中：使用[XML 方法](http://msdn.microsoft.com/en-us/library/ms190798.aspx)，使用 提取值，使用[`xml.value()`](http://msdn.microsoft.com/en-us/library/ms178030.aspx)项目节点[`xml.nodes()`](http://msdn.microsoft.com/en-us/library/ms188282.aspx)，使用[`CROSS APPLY`](http://msdn.microsoft.com/en-us/library/ms175156.aspx)连接：

```
SELECT 
    p.value('(./firstName)[1]', 'VARCHAR(8000)') AS firstName,
    p.value('(./lastName)[1]', 'VARCHAR(8000)') AS lastName
FROM table 
    CROSS APPLY field.nodes('/person') t(p) 
```

如果每个字段仅包含一个元素“人” ，则可以放弃`nodes()`and 。`cross apply`如果 XML 是您选择的变量`FROM @variable.nodes(...)`并且您不需要`cross apply`.

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-08-21T15:21:38.570

这篇文章有助于解决我的问题，它有一点不同的 XML 格式......我的 XML 包含一个键列表，如下例所示，我将 XML 存储在名为 DeleteBatch 的表的 SourceKeys 列中：

```
<k>1</k>
<k>2</k>
<k>3</k> 
```

创建表并用一些数据填充它：

```
CREATE TABLE dbo.DeleteBatch (
    ExecutionKey INT PRIMARY KEY,
    SourceKeys XML)

INSERT INTO dbo.DeleteBatch ( ExecutionKey, SourceKeys )
SELECT 1, 
    (CAST('<k>1</k><k>2</k><k>3</k>' AS XML))

INSERT INTO dbo.DeleteBatch ( ExecutionKey, SourceKeys )
SELECT 2, 
    (CAST('<k>100</k><k>101</k>' AS XML)) 
```

这是我从 XML 中选择键的 SQL：

```
SELECT ExecutionKey, p.value('.', 'int') AS [Key]
FROM dbo.DeleteBatch
    CROSS APPLY SourceKeys.nodes('/k') t(p) 
```

这是查询结果...

```
ExecutionKey 键
1 1
1 2
1 3
2 100
2 101

```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-12-19T01:18:58.323

这可能会回答您的问题：

```
select cast(xmlField as xml) xmlField into tmp from (
select '<person><firstName>Jon</firstName><lastName>Johnson</lastName></person>' xmlField
union select '<person><firstName>Kathy</firstName><lastName>Carter</lastName></person>'
union select '<person><firstName>Bob</firstName><lastName>Burns</lastName></person>'
) tb

SELECT
    xmlField.value('(person/firstName)[1]', 'nvarchar(max)') as FirstName
    ,xmlField.value('(person/lastName)[1]', 'nvarchar(max)') as LastName
FROM tmp

drop table tmp 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-09-08T08:46:09.180

天哪。这是一个非常有用的线索。

我仍然发现其中一些建议令人困惑。每当我在字符串中使用`value`with`[1]`时，它只会检索第一个值。并且一些建议建议使用`cross apply`which（在我的测试中）刚刚带回了太多数据。

因此，这是我如何创建`xml`对象，然后将其值读出到表中的简单示例。

```
DECLARE @str nvarchar(2000)

SET @str = ''
SET @str = @str + '<users>'
SET @str = @str + '  <user>'
SET @str = @str + '     <firstName>Mike</firstName>'
SET @str = @str + '     <lastName>Gledhill</lastName>'
SET @str = @str + '     <age>31</age>'
SET @str = @str + '  </user>'
SET @str = @str + '  <user>'
SET @str = @str + '     <firstName>Mark</firstName>'
SET @str = @str + '     <lastName>Stevens</lastName>'
SET @str = @str + '     <age>42</age>'
SET @str = @str + '  </user>'
SET @str = @str + '  <user>'
SET @str = @str + '     <firstName>Sarah</firstName>'
SET @str = @str + '     <lastName>Brown</lastName>'
SET @str = @str + '     <age>23</age>'
SET @str = @str + '  </user>'
SET @str = @str + '</users>'

DECLARE @xml xml
SELECT @xml = CAST(CAST(@str AS VARBINARY(MAX)) AS XML) 

--  Iterate through each of the "users\user" records in our XML
SELECT 
    x.Rec.query('./firstName').value('.', 'nvarchar(2000)') AS 'FirstName',
    x.Rec.query('./lastName').value('.', 'nvarchar(2000)') AS 'LastName',
    x.Rec.query('./age').value('.', 'int') AS 'Age'
FROM @xml.nodes('/users/user') as x(Rec) 
```

这是输出：

[![在此处输入图像描述](https://i.stack.imgur.com/AYalt.png)](https://i.stack.imgur.com/AYalt.png)

这是一种奇怪的语法，但是通过一个不错的示例，添加到您自己的 SQL Server 函数中很容易。

说到这里，这是这个问题的*正确*答案。

假设您的 xml 数据位于`@xml`类型变量中`xml`（如我上面的示例所示），以下是如何从问题中引用的 xml 返回三行数据：

```
SELECT 
    x.Rec.query('./firstName').value('.', 'nvarchar(2000)') AS 'FirstName',
    x.Rec.query('./lastName').value('.', 'nvarchar(2000)') AS 'LastName'
FROM @xml.nodes('/person') as x(Rec) 
```

[![在此处输入图像描述](https://i.stack.imgur.com/XiXCl.png)](https://i.stack.imgur.com/XiXCl.png)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-04-24T06:20:14.003

```
SELECT 
cast(xmlField as xml).value('(/person//firstName/node())[1]', 'nvarchar(max)') as FirstName,
cast(xmlField as xml).value('(/person//lastName/node())[1]', 'nvarchar(max)') as LastName
FROM [myTable] 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-02-21T12:29:24.077

如果您能够将 XML 包装在根元素中 - 比如说，以下是您的解决方案：

```
DECLARE @PersonsXml XML = '<persons><person><firstName>Jon</firstName><lastName>Johnson</lastName></person>
<person><firstName>Kathy</firstName><lastName>Carter</lastName></person>
<person><firstName>Bob</firstName><lastName>Burns</lastName></person></persons>'

SELECT  b.value('(./firstName/text())[1]','nvarchar(max)') as FirstName, b.value('(./lastName/text())[1]','nvarchar(max)') as LastName
FROM @PersonsXml.nodes('/persons/person') AS a(b) 
```

[![在此处输入图像描述](https://i.stack.imgur.com/eVec4.png)](https://i.stack.imgur.com/eVec4.png)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2018-09-18T16:16:58.173

MSSQL 使用如下常规 XPath 规则：

*   nodename 选择名称为“nodename”的所有节点
*   / 从根节点中选择
*   // 从当前节点中选择文档中与选择匹配的节点，无论它们在哪里
*   . 选择当前节点
*   .. 选择当前节点的父节点
*   @ 选择属性

[W3学校](https://www.w3schools.com/xml/xpath_syntax.asp)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-08-15T17:04:40.020

/* 此示例使用带有模式的 XML 变量 */

```
IF EXISTS (SELECT * FROM sys.xml_schema_collections 
           WHERE name = 'OrderingAfternoonTea')
BEGIN
    DROP XML SCHEMA COLLECTION dbo.OrderingAfternoonTea 
END
GO

CREATE XML SCHEMA COLLECTION dbo.OrderingAfternoonTea AS
N'<?xml version="1.0" encoding="UTF-16" ?>
  <xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
     targetNamespace="http://Tfor2.com/schemas/actions/orderAfternoonTea"
     xmlns="http://Tfor2.com/schemas/actions/orderAfternoonTea"
     xmlns:TFor2="http://Tfor2.com/schemas/actions/orderAfternoonTea"
     elementFormDefault="qualified"
     version="0.10"
   > 
    <xsd:complexType name="AfternoonTeaOrderType">
       <xsd:sequence>
         <xsd:element name="potsOfTea" type="xsd:int"/>
         <xsd:element name="cakes" type="xsd:int"/>
         <xsd:element name="fruitedSconesWithCream" type="xsd:int"/>
         <xsd:element name="jams" type="xsd:string"/>
      </xsd:sequence>
      <xsd:attribute name="schemaVersion" type="xsd:long" use="required"/>
    </xsd:complexType>

    <xsd:element name="afternoonTeaOrder"
                 type="TFor2:AfternoonTeaOrderType"/>

  </xsd:schema>' ;
GO

DECLARE @potsOfTea int;
DECLARE @cakes int;
DECLARE @fruitedSconesWithCream int;
DECLARE @jams nvarchar(128);

DECLARE @RequestMsg NVARCHAR(2048);
DECLARE @RequestXml XML(dbo.OrderingAfternoonTea);

set @potsOfTea = 5;
set @cakes = 7;
set @fruitedSconesWithCream = 25;
set @jams = N'medlar jelly, quince and mulberry';

SELECT @RequestMsg = N'<?xml version="1.0" encoding="utf-16" ?>
<TFor2:afternoonTeaOrder schemaVersion="10"
    xmlns:TFor2="http://Tfor2.com/schemas/actions/orderAfternoonTea">
    <TFor2:potsOfTea>' + CAST(@potsOfTea as NVARCHAR(20)) 
        + '</TFor2:potsOfTea>
    <TFor2:cakes>' + CAST(@cakes as NVARCHAR(20)) + '</TFor2:cakes>
    <TFor2:fruitedSconesWithCream>' 
        + CAST(@fruitedSconesWithCream as NVARCHAR(20))
        + '</TFor2:fruitedSconesWithCream>
    <TFor2:jams>' + @jams + '</TFor2:jams>
</TFor2:afternoonTeaOrder>';

SELECT @RequestXml  = CAST(CAST(@RequestMsg AS VARBINARY(MAX)) AS XML) ;

with xmlnamespaces('http://Tfor2.com/schemas/actions/orderAfternoonTea'
                    as tea)
select
    cast( x.Rec.value('.[1]/@schemaVersion','nvarchar(20)') as bigint )
        as schemaVersion,
    cast( x.Rec.query('./tea:potsOfTea')
               .value('.','nvarchar(20)') as bigint ) as potsOfTea,
    cast( x.Rec.query('./tea:cakes')
               .value('.','nvarchar(20)') as bigint )  as cakes,
    cast( x.Rec.query('./tea:fruitedSconesWithCream')
               .value('.','nvarchar(20)') as bigint ) 
      as fruitedSconesWithCream,
    x.Rec.query('./tea:jams').value('.','nvarchar(50)')  as jams
from @RequestXml.nodes('/tea:afternoonTeaOrder')  as x(Rec);

select @RequestXml.query('/*') 
```

# asp.net - 使用 ASP.net 和 jQuery 的表单提交（电子邮件）不起作用

> ID：899317
> 
> 赞同：1
> 
> 时间：2009-05-22T18:33:10.303
> 
> 标签：asp.net, jquery, email

我正在努力解决这个问题，但我运气不佳。

基本上，我有一个使用 jQuery 表单向导插件构建的向导样式 HTML 表单，其中包括 jQuery.Form、jQuery.Validation 和 jQuery.History 插件。我正在尝试使用 ASP.net Web Forms 提交电子邮件，但我似乎根本无法让它工作。

这是我的标记和代码的示例：

```
<form id="form1" runat="server">
    <div class="step" id="step01">
        <input type="text" id="text1" name="text1" runat="server" /><br />
        <input type="text" id="text2" name="text2" runat="server" />
    </div>
    <div class="step" id="step02">
        <input type="text" id="text3" name="text3" runat="server" /><br />
        <input type="text" id="text4" name="text4" runat="server" />
    </div>
    <input type="reset" id="reset" value="Reset" />
    <asp:Button runat="server" id="submit" Text="Submit" OnClick="button_Click" />
</form>

using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Net;
using System.Net.Mail;

public partial class email_test02 : System.Web.UI.Page
{
    protected void button_Click(object sender, EventArgs e)
    {
        //create the mail message
        MailMessage mail = new MailMessage();

        //set the addresses
        mail.From = new MailAddress("test@test.com");
        mail.To.Add("test2@test.com");

        //set the content
        mail.Subject = "Test";
        mail.Body =
            text1.Value + text2.Value + text3.Value + text4.Value;

        //send the message
        SmtpClient smtp = new SmtpClient("Localhost");
        smtp.Send(mail);
    }
} 
```

我不确定我需要从这里做什么。我对 jQuery 和 ASP.net 仍然很陌生，所以我确定我只是缺少一些明显的东西，但是我尝试过的任何事情都没有运气。因此，如果有人能在这里指出我正确的方向，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T00:08:36.530

如果您使用 jquery 表单进行提交，请删除 onclick 并为表单提供一个 id。该 ID 会进入您页面上的 javascript 代码以收集您的帖子。

```
<script type="text/javascript"> 
     $(document).ready(function() { 
        $('#form1').ajaxForm(function() { 
            location.href=("submitted.aspx");
        }); 
    }); 
</script> 
```

在您的页面加载中只需添加

```
if(isPostback){
    string txt1 = Request["text1"];

    // you will want to clean this string, (encode for storage) 
    // and maybe also check for isnull or empty first i.e

    var username = !string.IsNullorEmpty(Request["text1"]) ? Request["text1"] : null;

} 
```

# oracle - oracle sqlplus 命令行问题

> ID：899318
> 
> 赞同：2
> 
> 时间：2009-05-22T18:33:13.987
> 
> 标签：oracle, sqlplus

有没有办法从 oracle 脚本中检测缺少的命令行参数

例如，我的 oracle 脚本 test.sql 需要运行 3 个参数。我的脚本是从安装程序执行的，如 sqlplus /NOLOG @test.sql userid pw tablespace 当缺少参数之一时，sqlplus 会提示输入用户输入。这无法从安装程序中识别。我需要在脚本中找到丢失的参数并以错误代码退出。可行吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T19:09:14.623

我不认为有办法直接用 sqlplus 做到这一点。您可以将 sqlplus 执行包装在检查参数的命令/shell 脚本中，然后使用经过验证的参数列表调用 sqlplus。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T20:00:48.467

在 shell 脚本中包装对 sqlplus 的调用似乎是最简单的方法，但您也可以使用以下方法调用脚本：

```
sqlplus /NOLOG @test.sql <userid> <pw> <tablespace> empty empty empty 
```

并检查脚本内部是否有任何值等于“空”？这样，即使没有传递任何参数，脚本也不会挂起，因为您仍然拥有三个填充参数。

您可以使用以下内容进行检查：（使用 && 而不是 & 意味着您只会被提示输入一次值）

```
var status number;
set verify on
whenever sqlerror exit 1; 
begin
   :status := 0;
   select decode('&&1','empty',1,:status) into :status from dual;
   select decode('&&2','empty',2,:status) into :status from dual;
   select decode('&&3','empty',3,:status) into :status from dual;
   IF :status != 0 THEN
   RAISE_APPLICATION_ERROR (
   -20000+-1*:status,'parameter '|| :status || ' is missing');
   END IF;
end;
/ 
```

输入无效时的返回值为 1。在不知道参数的有效值是什么的情况下，很难知道省略了哪一个。

# jquery - 如何在页面上存储数据并通过 JQuery 检索数据？

> ID：899327
> 
> 赞同：3
> 
> 时间：2009-05-22T18:33:47.293
> 
> 标签：jquery, selector, hidden

我有一组数据，我将使用 PHP 将其回显到页面，并且我希望 JQuery 能够解析它。但是，我不希望用户必须看到数据。我有，例如：

```
<div id="data-1">
    <span id="width">5</span>
    <span id="height">10</span>
    <span id="depth">15</span>
</div>
<div id="data-2">
    <span id="width">10</span>
    <span id="height">20</span>
    <span id="depth">30</span>
</div> 
```

我想知道我是否应该以这种方式将数据存储在跨度中，然后在 JQuery 中，在加载时隐藏它们并通过稍后获取跨度值来处理数据：

```
$(document).ready( function() {
    $("#width, #height, #depth").hide();
    $("#data-*").click(function() {
        var width = $("#width", $(this)).text();
        var height = $("#height", $(this)).text();
        var depth = $("#depth", $(this)).text();
    });
}); 
```

这是在页面上存储数据的最有效方式吗？我应该改用隐藏输入，还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T18:42:04.440

当你用 PHP 回显你的数据时，通过[json_encode()](http://uk.php.net/json_encode)传递它，这将生成一个 jQuery 可以本机读取的 javascript 对象。然后，您可以在发出请求时将其插入页面底部，或使用 AJAX 即时获取它。

PHP：

```
$my_data = array(
   'data1' => array(
      'width' => 16,
      'height' => 20
    ),
   'data2' => array(
      'width' => 16,
      'height' => 20
    )
);

# echo at bottom of page
echo '<script type="text/javascript">';
echo 'window.my_data = '.json_encode($my_data);
echo '</script>'; 
```

jQuery：

```
var height = window.my_data.data1.height 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T18:39:54.583

我怀疑你会得到很多基于 ajax 的答案，但你所做的并不是真正的 ajax。您正在写出服务器创建页面时可用的值。Ajax 将是回调到服务器以获取该数据的 javascript。

那么为什么不直接使用 php 来编写使用 php 的脚本呢？

```
$(document).ready( function () {
   $("#data-*").click(function() {
      var width = <?=$width_var_in_php?>;
      var height = <?=$height_var_in_php?>;
   });
}); 
```

我的 php 有点生疏，但你应该明白了。然后没有什么可隐藏的，javascript包含准备好的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T18:53:42.983

我以前用 span 做过这个，但一直在考虑下次我需要做类似的事情时使用 jQuery[元数据插件。](http://plugins.jquery.com/project/metadata)

使用您的示例，它的结构可能如下：

```
<div id="data-1" class="{width: 5, height: 10, depth: 15}"></div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T18:58:15.423

您必须将其作为 HTML 进行吗？

你能简单地输出一个 JSON 结构吗？

```
变量数据1 = {
                宽度：5，
                高度：10，
                深度：15
             }
...

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-22T15:19:13.850

如果您想将数据与通过 JQuery 选择的 HTML 元素结合起来，那么 jSonComments 是一个很好的插件选择： [http ://plugins.jquery.com/project/jSonComments](http://plugins.jquery.com/project/jSonComments)

您可以将 JSON 直接放入 HTML 结构中的 HTML 注释中。

```
<div id="getMyData">
<!-- Metadata
        {
        "foo":"bar"
        }
-->
</div> 
```

并像这样检索它：

```
$('div#getMyData').jSonComments().foo 
```

正如duckyflip 所建议的，您可以在PHP 中使用[json_encode()](http://uk.php.net/json%5Fencode)将数据放入HTML 。

# c# - 在类中而不是在 Windows 窗体中使用 OpenNETCF.Net.Ftp

> ID：899328
> 
> 赞同：0
> 
> 时间：2009-05-22T18:34:02.050
> 
> 标签：c#, compact-framework, opennetcf

到目前为止，我在 Windows 窗体中使用 FTP 对象。FTP 对象在单独的线程中运行，因此为了确保我的应用程序不会冻结，我使用以下代码：

```
private void OnResponse(string response)
    {
        if (this.InvokeRequired)
        {
            this.Invoke(new StringDelegate(OnResponse), new object[] { response });
            return;
        }
    } //end of OnResponse 
```

我不完全清楚字符串委托是什么，但这有效。

但是，我现在正在重构并希望将 ftp 隐藏到一个类中。我的问题是如何确保主线程不会冻结？所有关于在类中引发事件的在线参考资料都是有意义的，但我还没有找到一个应用程序是多线程的示例。我最关心的是 InvokeRequired。

在上面的代码中，这是一个表单。如果我将 ftp 对象隐藏在一个类中，如下所示：

```
abstract class MyClass
{
    //data members
    private FTP _ftp;

    //other data members, methods, and properties etc
} 
```

"This" 成为 MyClass 的一个对象。我不确定是否在类上实现了 InvokeRequired 属性（也许我应该让它实现一个具有该属性的特殊接口？）。或者也许我遗漏了一些东西，我不应该在类中使用多线程对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T21:12:23.127

您需要在 UI 线程上创建的 Control 或从 Control 派生的东西（不一定是 Form）。您的 MyClass 可能不应该直接更新 UI，因此在这里并不真正相关 - MyClass 可能会引发事件或调用回调。

当您想根据来自 FTP 库的事件更改表单上的某些内容时，UI 变得很重要。为此，您需要在 UI 线程上创建的 Control 或从 Control 派生的任何内容（同样，不必是 Form）。使用该控件检查 InvokeRequired，如果为真，则调用 Invoke。原始版本使用自定义委托（可能来自 FTP 示例，因为它看起来对我来说非常熟悉），但您可以使用任何您想要的委托。

网络上有很多使用 Control.Invoke 的示例，因此您应该能够相当容易地实现它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T18:41:27.343

最可能的设计方法是让“MyClass”的调用者根据需要调用或不调用。我会设计您的课程以在响应发生时触发事件。

请记住，只有与 Windows UI 交互的代码需要 Invoke-d 到主线程上。OnResponse 中的任何其他处理都可以在后台线程中完成，没有问题。

如果您的“MyClass”不是窗体或控件之类的 Windows 对象，那么您就没有您所说的 InvokeRequired。但它不需要 InvokeRequired。如果代表 UI 对象的其他类确实需要对 FTP 对象做出响应，那么该 UI 对象可以执行 InvokeRequired 测试。

我希望这很清楚！

* * *

编辑：添加信息

OnReceived 处理程序肯定会在您的 FTP 类中。所以我在想这样的事情：

公共类 MyFTPClass { 公共事件 EventHandler DataReceived; // UI 表单可以订阅这个事件

```
 private void OnReceived()
 {
   //so the FTP has returned data
   // Do stuff here that can be on the background thread like saving
   // the file in an appropriate place, or whatever.

   // now trigger the DataReceived event.  Anyone who cares about data being received
   // can subscribe to this and do whatever is appropriate.
   if (DataReceived) DataReceived(this, EventArgs.Empty); 
```

}

这是一个粗略的轮廓。但基本思想是你在后台线程中做你可以做的事情。然后您可以通过事件通知 UI。

# visual-studio-2010 - 在 VS2010 上更清晰？

> ID：899330
> 
> 赞同：2
> 
> 时间：2009-05-22T18:34:34.577
> 
> 标签：visual-studio-2010, resharper

有人在 V2010 上获得了 resharper 4.5 吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T18:39:06.957

等待几天并尝试使用 ReSharper for VS2010 - [http://blogs.jetbrains.com/dotnet/2009/05/preview-of-resharper-for-visual-studio-2010-coming-soon/](http://blogs.jetbrains.com/dotnet/2009/05/preview-of-resharper-for-visual-studio-2010-coming-soon/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-12T12:17:57.573

你的两个答案仍然是错误的，他问你是否让 R# 4.5 工作......答案是否定的。Visual Studio 2010 有一个用 WPF 和 MEF 编写的全新文本编辑器，所以我非常怀疑 R# 4.5 是否会支持它：P

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-22T18:41:28.077

看看这个：

科学家们假设 ReSharper for Visual Studio 2010 的存在。他们无休止地争论利弊，把历史摆在桌面上，甚至赌一把，如果 ReSharper 可以在新的闪亮的 Visual Studio 2010 Beta 1 中运行。

你可以肯定地知道，它运行！[想知道它什么时候会为您运行？继续阅读！](http://blogs.jetbrains.com/dotnet/2009/05/preview-of-resharper-for-visual-studio-2010-coming-soon/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-28T16:25:13.573

[他们在http://www.how-to-code.com/](http://www.how-to-code.com/)上采访了 resharper 首席开发人员- 显然你必须等待 resharper 5

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-29T22:53:26.987

您可以在以下地址找到 ReSharper for Visual Studio 2010 Preview： [http://www.jetbrains.net/confluence/display/ReSharper/ReSharper+for+Visual+Studio+2010+%28Preview%29](http://www.jetbrains.net/confluence/display/ReSharper/ReSharper+for+Visual+Studio+2010+%28Preview%29)

# c# - 在自定义类中而不是在 Windows 窗体中使用 OpenNETCF.Net.Ftp

> ID：899332
> 
> 赞同：0
> 
> 时间：2009-05-22T18:35:03.127
> 
> 标签：c#, multithreading, events, compact-framework

**[在类中而不是在 Windows 窗体中使用 OpenNETCF.Net.Ftp 的](https://stackoverflow.com/questions/899328/using-opennetcf-net-ftp-inside-a-class-instead-of-inside-a-windows-form)完全相同**

* * *

到目前为止，我在 Windows 窗体中使用 FTP 对象。FTP 对象在单独的线程中运行，因此为了确保我的应用程序不会冻结，我使用以下代码：

```
private void OnResponse(string response)
    {
        if (this.InvokeRequired)
        {
            this.Invoke(new StringDelegate(OnResponse), new object[] { response });
            return;
        }
    } //end of OnResponse 
```

我不完全清楚字符串委托是什么，但这有效。

但是，我现在正在重构并希望将 ftp 隐藏到一个类中。我的问题是如何确保主线程不会冻结？所有关于在类中引发事件的在线参考资料都是有意义的，但我还没有找到一个应用程序是多线程的示例。我最关心的是 InvokeRequired。

在上面的代码中，“This”是一个表单。如果我将 ftp 对象隐藏在一个类中，如下所示：

```
abstract class MyClass
{
    //data members
    private FTP _ftp;

    //other data members, methods, and properties etc
} 
```

"This" 成为 MyClass 的一个对象。我不确定是否在类上实现了 InvokeRequired 属性（也许我应该让它实现一个具有该属性的特殊接口？）。或者也许我遗漏了一些东西，我不应该在类中使用多线程对象？

我在 VS 2008 中使用 c# 和 asp.net 2.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T23:52:20.213

InvokeRequired 和 Invoke 只需要在 UI 级别使用，以确保您不会与非 UI 线程上的控件进行交互。如果 MyClass 不是 UI 组件，您无需担心。

您可能需要担心的是 MyClass 何时与 UI 交互。例如，如果 MyClass 将作为 OnResponse 的结果引发一个事件，并且 UI 将观察该事件，那么在 UI 的事件处理程序中，您将需要使用 InvokeRequired 和 Invoke。

# c# - 需要的建议：如何使用 C# (WPF/WinForms) 创建一个全局菜单栏？

> ID：899334
> 
> 赞同：0
> 
> 时间：2009-05-22T18:35:13.420
> 
> 标签：c#

所以，我想创建一个“浮动”菜单栏（没有窗口）。这在 C# 中是如何实现的？

另外，如果您可以在以下位置提供一些指示：

*   如何使该栏“听”全局快捷键将不胜感激。
*   当另一个窗口最大化时，不要让这样的窗口在我的工具栏顶部最大化。

这样做的原因是，我想向我的经理展示 Mile High（类似 Mac）菜单栏的概念。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T19:50:58.347

我真的不喜欢这个概念（我不时看到它完成），但是......

您将创建一个将 FormBorderStyle 设置为 none 的无模式表单。然后把你的菜单放在那个表格上。

您还需要做一些工作来确定屏幕分辨率，但这很容易用谷歌搜索。此外，在单击菜单后，将需要与某种命令类进行通信，以告诉应用程序的其余部分刚刚请求了什么。

您正在寻找的其余内容涉及大量 PInvoke'ing，如果我不需要，我通常不会去那里。

# scrollbar - 如何设置网页的滚动条位置

> ID：899339
> 
> 赞同：0
> 
> 时间：2009-05-22T18:36:02.093
> 
> 标签：scrollbar, position

如何设置滚动条位置而不是顶部的默认位置

更新：我的意思是当用户第一次打开网页时，滚动条位于屏幕顶部（默认）

如何设置滚动条位置（中间或底部）？所以用户可以看到

网络中间还是网络底部，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T18:47:43.730

你可以使用：

```
<a name="myname" /> 
```

您要滚动到的位置...并通过以下方式引用页面：

```
www.example.com/mypage.html#myname 
```

?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T18:53:02.953

您可以使用 BoltBait 建议的锚点或使用 javascript：

```
window.scroll(x,y); 
```

虽然 jQuery 有一个不错的插件，但我建议使用它。 [滚动插件](http://demos.flesler.com/jquery/scrollTo/)

# c++ - 在 C++ 中将彩色文本打印到控制台

> ID：899341
> 
> 赞同：8
> 
> 时间：2009-05-22T18:36:27.913
> 
> 标签：c++, programming-languages, text, console, terminal

我想编写一个控制台类，可以将彩色文本输出到控制台。

所以我可以做类似的事情（基本上是 printf 的包装器）：

```
Console::Print( "This is a non-coloured message\n" );
Console::Warning( "This is a YELLOW warning message\n" );
Console::Error( "This is a RED error message\n" ); 
```

如何将不同颜色的文本打印到 Windows 控制台？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T18:43:14.813

查看[本指南](http://www.infernodevelopment.com/set-console-text-color)。我会制作一个自定义操纵器，以便可以执行以下操作：

```
std::cout << "standard text" << setcolour(red) << "red text" << std::endl; 
```

[这](http://www.informit.com/articles/article.aspx?p=171014&seqNum=2)是一个关于如何实现自己的操纵器的小指南。

一个快速的代码示例：

```
#include <iostream>
#include <windows.h>
#include <iomanip>

using namespace std;

enum colour { DARKBLUE = 1, DARKGREEN, DARKTEAL, DARKRED, DARKPINK, DARKYELLOW, GRAY, DARKGRAY, BLUE, GREEN, TEAL, RED, PINK, YELLOW, WHITE };

struct setcolour
{
   colour _c;
   HANDLE _console_handle;

       setcolour(colour c, HANDLE console_handle)
           : _c(c), _console_handle(0)
       { 
           _console_handle = console_handle;
       }
};

// We could use a template here, making it more generic. Wide streams won't
// work with this version.
basic_ostream<char> &operator<<(basic_ostream<char> &s, const setcolour &ref)
{
    SetConsoleTextAttribute(ref._console_handle, ref._c);
    return s;
}

int main(int argc, char *argv[])
{
    HANDLE chandle = GetStdHandle(STD_OUTPUT_HANDLE);
    cout << "standard text" << setcolour(RED, chandle) << " red text" << endl;

    cin.get();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T18:40:29.293

我搜索了“c++ console write coloured text”，并在大约 4 或 5 处找到了[这个页面](http://www.dreamincode.net/code/snippet680.htm)。由于该站点有一个复制和粘贴部分，我想我会在这里发布（关于链接腐烂的另一个问题也提示了这个):

```
#include <stdlib.h>
#include <windows.h>
#include <iostream>

using namespace std;

enum Color { DBLUE=1,GREEN,GREY,DRED,DPURP,BROWN,LGREY,DGREY,BLUE,LIMEG,TEAL,
    RED,PURPLE,YELLOW,WHITE,B_B };
/* These are the first 16 colors anyways. You test the other hundreds yourself.
   After 15 they are all combos of different color text/backgrounds. */

bool quit;

void col(unsigned short color)
{
    HANDLE hcon = GetStdHandle(STD_OUTPUT_HANDLE);
    SetConsoleTextAttribute(hcon,color);
}

istream &operator>> ( istream &in, Color &c )
{
    int tint;
    cin >> tint;
    if (tint==-1) quit=true;
    c=(Color)tint;
}

int main()
{
    do {
        col(7); // Defaults color for each round.
        cout << "Enter a color code, or -1 to quit... ";
        Color y;
        cin >> y; // Notice that >> is defined above for Color types.
        col(y); // Sets output color to y.
        if (!quit) cout << "Color: " << (int)y << endl;
    } while (!quit);
    return 0;
} 
```

对于 C#，有[这个页面](http://support.microsoft.com/kb/319883)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-04T05:57:30.020

```
#include <windows.h>
#include <iostream.h>
using namespace std;

int main()
{
    HANDLE hOut;

    hOut = GetStdHandle(STD_OUTPUT_HANDLE);

    SetConsoleTextAttribute(hOut,
                            BACKGROUND_RED);
    cout << "Red     " << flush;
    SetConsoleTextAttribute(hOut,
                            BACKGROUND_RED |
                            BACKGROUND_INTENSITY);
    cout << "Red     " << endl;

    SetConsoleTextAttribute(hOut,
                            BACKGROUND_GREEN);
    cout << "Green   " << flush;
    SetConsoleTextAttribute(hOut,
                            BACKGROUND_GREEN |
                            BACKGROUND_INTENSITY);
    cout << "Green   " << endl;

    SetConsoleTextAttribute(hOut,
                            BACKGROUND_BLUE);
    cout << "Blue    " << flush;
    SetConsoleTextAttribute(hOut,
                            BACKGROUND_BLUE |
                            BACKGROUND_INTENSITY);
    cout << "Blue    " << endl;

    SetConsoleTextAttribute(hOut,
                            BACKGROUND_RED | 
                            BACKGROUND_GREEN);
    cout << "Yellow  " << flush;
    SetConsoleTextAttribute(hOut,
                            BACKGROUND_RED | 
                            BACKGROUND_GREEN |
                            BACKGROUND_INTENSITY);
    cout << "Yellow  " << endl;

    SetConsoleTextAttribute(hOut,
                            BACKGROUND_GREEN | 
                            BACKGROUND_BLUE);
    cout << "Cyan    " << flush;
    SetConsoleTextAttribute(hOut,
                            BACKGROUND_GREEN | 
                            BACKGROUND_BLUE |
                            BACKGROUND_INTENSITY);
    cout << "Cyan    " << endl;

    SetConsoleTextAttribute(hOut,
                            BACKGROUND_BLUE | 
                            BACKGROUND_RED);
    cout << "Magenta " << flush;
    SetConsoleTextAttribute(hOut,
                            BACKGROUND_BLUE | 
                            BACKGROUND_RED |
                            BACKGROUND_INTENSITY);
    cout << "Magenta " << endl;

    SetConsoleTextAttribute(hOut,
                            BACKGROUND_RED | 
                            BACKGROUND_GREEN | 
                            BACKGROUND_BLUE);
    cout << "White   " << flush;
    SetConsoleTextAttribute(hOut,
                            BACKGROUND_RED | 
                            BACKGROUND_GREEN | 
                            BACKGROUND_BLUE |
                            BACKGROUND_INTENSITY);
    cout << "White   " << endl;

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-24T13:34:22.093

使用这些功能

```
enum c_color{BLACK=30,RED=31,GREEN=32,YELLOW=33,BLUE=34,MAGENTA=35,CYAN=36,WHITE=37};
enum c_decoration{NORMAL=0,BOLD=1,FAINT=2,ITALIC=3,UNDERLINE=4,RIVERCED=26,FRAMED=51};
void pr(const string str,c_color color,c_decoration decoration=c_decoration::NORMAL){
  cout<<"\033["<<decoration<<";"<<color<<"m"<<str<<"\033[0m";
}

void prl(const string str,c_color color,c_decoration decoration=c_decoration::NORMAL){
   cout<<"\033["<<decoration<<";"<<color<<"m"<<str<<"\033[0m"<<endl;
} 
```

# .net - 在选项卡控件上时，组合框下拉菜单意外关闭

> ID：899342
> 
> 赞同：0
> 
> 时间：2009-05-22T18:36:43.200
> 
> 标签：.net, vb.net, winforms

我有一个带有内置 .NET 2.0 选项卡控件的单个实例的模式表单。选项卡控件有几个页面，其中一个是一个组合框，直到用户第一次激活它时才会填充。发生这种情况时，我处理 DropDown 事件并运行一个需要几秒钟的进程，然后将该进程返回的项目添加到组合框中。

它工作正常，除了在组合框的列表部分被下拉之后，它立即关闭，就好像其他一些控件获得了焦点一样。我已将其范围缩小到表单上有一个选项卡控件，并且为组合框检索项目的过程需要 4 秒以上。如果我只使用组合框创建一个完全空白的表单，我看不到这种行为。

不用说，这是令人难以置信的奇怪。知道为什么选项卡控件会干扰当前具有焦点的控件吗？

编辑：

这是给定组合框的事件处理程序代码。基本上我正在网络上构建一个 SQL 服务器列表。需要几秒钟的时间是对 GetDataSources 的调用。

```
Private Sub cmbServer_DropDown(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmbServer.DropDown
    Dim oTable As DataTable
    Dim lstServers As List(Of String)
    Dim lstAliases As List(Of String)

    Try
        If cmbServer.Items.Count = 0 Then
            System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
            oTable = System.Data.Sql.SqlDataSourceEnumerator.Instance.GetDataSources
            lstServers = New List(Of String)

            For Each oRow As DataRow In oTable.Rows
                If oRow("InstanceName").ToString = "" Then
                    lstServers.Add(oRow("ServerName").ToString)
                Else
                    lstServers.Add(oRow("ServerName").ToString & "\" & oRow("InstanceName").ToString)
                End If
            Next oRow

            'Retrieve any server aliases on the client and add them to the server list
            lstAliases = GetSQLServerAliases()
            If lstAliases IsNot Nothing Then
                For Each sAlias As String In lstAliases
                    lstServers.Add(sAlias)
                Next sAlias
            End If

            lstServers.Sort()
            For Each sServer As String In lstServers
                cmbServer.Items.Add(sServer)
            Next sServer
        End If
    Catch ex As Exception
        ErrHandler("frmRefreshDB", "cmbServer_DropDown", ex.Source, ex.Message, ex.InnerException)
    Finally
        System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default

        If oTable IsNot Nothing Then
            oTable.Dispose()
        End If
    End Try
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T15:45:01.487

我能够解决这个问题。

我首先在组合框的 LostFocus 事件中添加了一个断点，并按照 Steve Dignan 的建议查看了堆栈跟踪，但这并没有显示任何内容。我的表单的一个特别之处是这个组合框通常是禁用的，只有当用户选中同一标签页上的框时才会启用。解决方案是在选中组合框时将焦点显式设置为组合框，如下所示：

```
Private Sub chkAltServer_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles chkAltServer.CheckedChanged
    Try
        If chkAltServer.Checked Then
            UnlockControl(cmbServer)
            cmbServer.Focus()
        Else
            LockControl(cmbServer)
        End If
    Catch ex As Exception
        ErrHandler("frmOptions", "chkAltServer_CheckedChanged", ex.Source, ex.Message, ex.InnerException)
    End Try
End Sub 
```

然后组合框的下拉部分正常显示。

# javascript - RegEx-如何解析 html 页面的模式（在 JavaScript 中）

> ID：899343
> 
> 赞同：1
> 
> 时间：2009-05-22T18:36:51.203
> 
> 标签：javascript, html, regex

我需要解析 html 页面的模式。我假设匹配被加载到一个数组中。然后我需要输出数组的内容。

```
<script language="JavaScript" type="text/javascript">
var adBookmarkletData=[
'<html><head><title>MYSA Yahoo! APT Debugger</title></head><body><center><div style=\"background:#ccc;color:#000;width:350px;text-align:left;padding:15px;border:2px #000;\">','<b>MYSA Yahoo! APT Debugger:</b><br /><hr />',
'<b>URL:</b> '+document.location.href+'<br />',
'<b>Pub ID:</b> '+window.yld_mgr.pub_id+'<br />',
'<b>Site Name:</b> '+window.yld_mgr.site_name+'<br />',
'<b>Content Topic ID List:</b> '+window.yld_mgr.content_topic_id_list+'<br />',
'<b>Site Section Name List:</b> '+window.yld_mgr.site_section_name_list+'<br />'
];
for(i in window.yld_mgr.slots){
    adBookmarkletData.push('<b>Ad:</b> ('+i+')<b>Category:</b>('+window.yld_mgr.slots[i].cstm_content_cat_list+')<br />');
    };
//Here my problem starts
    var myRegExp = new RegExp("place_ad_here\('(.*?)'\)");
//Here my Problem ends
adBookmarkletData.push(myRegExp.exec(document.innerHTML));

adBookmarkletData.push('</div></center></body></html>');
function createAptDebugger(){
   for (i in adBookmarkletData){
    document.write(adBookmarkletData[i]);
    }
};
void(createAptDebugger());
</script> 
```

RegEx 模式适用于针对示例代码的在线测试器。但是这里的结果是空的。**我不知道如何将 RegEx 指向 html 页面，然后将其从数组中输出。**

为清楚起见，html 将在正文中有这样的标签。

```
<script type="text/javascript">yld_mgr.place_ad_here('A728');</script>
<script type="text/javascript">yld_mgr.place_ad_here('ASPON120');</script>
<script type="text/javascript">yld_mgr.place_ad_here('ROLLOVER');</script>
<script type="text/javascript">yld_mgr.place_ad_here('A300');</script>
<script type="text/javascript">yld_mgr.place_ad_here('Middle1');</script>
<script type="text/javascript">yld_mgr.place_ad_here('B300');</script> 
```

结果将如下所示：

```
place_ad_here('A728')
place_ad_here('ASPON120')
place_ad_here('ROLLOVER')
place_ad_here('A300')
place_ad_here('Middle1')
place_ad_here('B300') 
```

这几乎就是我想要显示它们的方式。

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T17:50:55.180

您在正则表达式中缺少 g 标志。这将允许多重匹配。

这就是你想要的

```
Array.prototype.push.apply( adBookmarkletData
              , document.innerHTML.match( /place_ad_here\('[^']+'\)/g ) ) ; 
```

**如果您使用全局g**标志，string.match 将返回一个包含所有匹配项的数组。此外，由于 push 只接受参数列表，因此 apply 用于传递参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T19:04:40.267

请注意，soitgoes 和 Laurent 都推荐或使用文字正则表达式分隔符 (//)。您的 RegExp 不起作用 b/c 您正在转义传递给 RegExp 构造函数的字符串中的括号。你需要双重逃避它们。

```
new RegExp("place_ad_here\\('(.*?)'\\)","g") 
```

这就是为什么我更喜欢文字正则表达式并且**只**在我需要在运行时构造正则表达式时使用 RexExp。

除此之外，洛朗的回答应该可以完成你想要的。他只是使用了一个稍微不同的正则表达式。[^']+ 与 (.*)？两者都应该适用于您所描述的文本。

如果您想在末尾保留换行符（每行 1 个）的输出，您可以使用 replace 而不是 match 并相应地调整您的正则表达式。

最后一点：如果输入像

`<script type="text/javascript">yld_mgr.place_ad_here('A728');</script>`

跨越**多行**或`place_ad_here`曾经**使用多个参数**，因此请确保您了解输入的所有可能变化。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T18:45:58.613

我相信你拥有它的方式只会匹配第一场比赛......我相信你需要做这样的事情......

```
while ( var match = myRegExp.exec(document.innerHTML)){
   adBookmarkletData.push(match);
} 
```

# asp.net - 需要指导 ASP.Net 应用程序连接字符串

> ID：899346
> 
> 赞同：3
> 
> 时间：2009-05-22T18:38:31.357
> 
> 标签：asp.net, connection-string, data-access-layer

Net 2.0 / Visual Studio 2005 / ASP.Net 网络应用程序

我在这个网站上阅读了许多帖子和评论，但有些帖子和评论对我来说太混乱了，或者有些不符合我的要求。

所以我有一个 3 层应用程序 - UI、BLL、DAL。在我的 DAL 中，我通过从服务器资源管理器中拖动存储过程来创建数据集。所以连接字符串被硬编码到数据集文件中。

我很感激有人逐步解释我必须做的事情，以便当我将 UI（主项目）设置设计器中的连接字符串传递给 BLL，然后再传递给 DAL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T18:19:03.810

这是一个非常有趣的场景，因为我有时在我的多层应用程序中使用数据集，所以我之前已经经历过这种情况。所以这是解决方案。

我假设除了 UI 之外，所有的都是 BLL、DAL 的类库项目。在 DAL 中，您将拥有数据集设计器，它将连接字符串放在 DAL 类库 prj 的 app.config 下。现在，如果您需要引用 DAL 上方的 BAL，它又是一个类库项目，请从 DAL 的 app.config 中复制 connectionStrings 部分并将其粘贴到 BAL 类库项目的 app.Config 的 connectionStrings 部分。在这里您必须注意到连接字符串名称不仅仅是“myDataBaseConnStr”。它将带有详细的命名空间参考，例如 MyApp.DataLayer.DataSet.myDataBaseConnStr。您应该使用 UI 层 app.config 或 web.config 执行相同的过程。成功完成此操作后，您可以更改 UI 层应用程序 [web.config 或 app.config] 的根配置文件中的 connectionString。这样，它将始终从 UI 层获取 connectionString，因为那是运行时正在执行的 AppDomain。因此，您可以在那里更改连接字符串并将其反映在底层 BAL 和 DAL 中。

谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T18:52:10.117

如果可能的话，我会避免拖放编码。如果你玩太多魔法，那么你会被烧死。

连接字符串应仅位于应用程序中的一个位置。如果您的所有层都与连接字符串有关，那么这是一个问题。您的 DAL 应该是与连接字符串相关的唯一层。

让 DAL 获取连接字符串的一个好方法是通过 IoC（控制反转）。这样您就不必通过所有构造函数传递连接字符串。

数据集有些过时了。如果您正在开发一个新应用程序，您可能会考虑使用 ORM，例如 NHibernate 或 Linq

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T18:55:43.463

我猜当您将 sp 拖过来时，设计师会为您创建一个 tableAdapter。适配器上有一个 Connection 属性，您可以为适配器设置该属性以用于填充数据表。我同意其他人的观点，即您希望将连接信息放在配置文件或存储配置的其他位置。我也不喜欢拖放到设计器中，但这应该可以管理数据库连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T05:57:00.853

最后，我的问题是：有没有办法在运行时覆盖 DAL 项目设置设计器中设置的连接字符串？..以便 DAL 中的数据集可以将此连接字符串用于表适配器。

我在另一篇文章中读到，如果您在主项目的设置中有同名的属性（与 DLL 中的属性相同），那么子项目 (DLL) 会获取该属性的值，覆盖为其设置的值在它自己的设置中。

任何例子如何做到这一点？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T18:51:29.837

我们这样做的方式是在我们的 web.config 文件中包含连接字符串（app.config 也可以）。例子：

```
<add key="ConnectionString" value="Data Source=localhost;Initial Catalog=MyDatabase;User ID=username;Password=abc123"/> 
```

然后，在 DAL 中，我们使用如下内容：

```
using (var connection = new SqlConnection(ConfigurationManager.AppSettings["ConnectionString"])) {
    using (var command = new SqlDataAdapter("MyStoredProc", connection)) {
        command.SelectCommand.CommandType = CommandType.StoredProcedure;
        var categories = new DataSet();
        command.Fill(categories);
        return categories;
    }
} 
```

您可以使用 ConfigurationManager.AppSettings["Whatever"] 从 .config 文件中提取“Whatever”指定的值。非常方便，非常适合在开发、测试和生产环境之间切换。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T19:06:41.163

您可以添加 web.config 的一个特殊部分，称为 connectionStrings。您添加到 web.config：

```
 <connectionStrings>
    <add name="oracle" connectionString="Data Source=server; User ID=user; Password=password;"/>
  </connectionStrings> 
```

然后在您的 C# 代码中：

```
string connString = ConfigurationManager.ConnectionStrings["oracle"].ConnectionString; 
```

我知道它比第一个示例复杂一点，但它有助于保持配置文件的组织性，特别是随着这个文件变得越来越复杂，您将学会重视这个 connectionStrings 部分。

祝你好运！

里卡多。

# c# - 用于 (x)html 合规性的 C# 库

> ID：899348
> 
> 赞同：1
> 
> 时间：2009-05-22T18:39:23.117
> 
> 标签：c#, html, xhtml, validation

好奇是否有人遇到过可以清理无效 html 的 C# 库。基本上，我们的 CMS 有一些区域允许用户输入 HTML，这总是会导致一些格式不正确的代码。

示例 - 如果有人输入：

```
<div><span>blah blah blah</div> 
```

我们想撕掉所有未终止的标签，最终得到：

```
<div>blah blah blah</div> 
```

希望不要在这里重新发明轮子。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T18:56:16.473

有一个众所周知的库名称“HTML Tidy”：类似[http://www.google.ca/search?hl=en&q=html+tidy+c%23](http://www.google.ca/search?hl=en&q=html+tidy+c%23)的名称可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-01T16:08:07.937

试试这个答案：

[C# 版本的 HTML Tidy？](https://stackoverflow.com/questions/4002346/c-version-of-html-tidy)

# java - 在不安装客户端软件的情况下连接到 VPN

> ID：899349
> 
> 赞同：14
> 
> 时间：2009-05-22T18:39:26.270
> 
> 标签：java, sockets, vpn, cisco

有时我必须编写软件来与位于 Cisco VPN 中的特定服务器建立套接字。我只是像没有 VPN 一样编写我的软件（使用标准套接字库）。当需要运行该程序时，我使用计算机上安装的客户端软件手动连接到 VPN，然后运行该程序本身。

但是，最好编写软件以利用能够通过 VPN 直接通信的专用套接字库，而无需使用任何已安装的客户端软件。

这是一些说明我想要的功能的Java代码：

```
String vpnHost = ...;
String vpnUser = ...;
String vpnPassword = ...;
VPNConnection vpnConnection = new CiscoVPNConnection(vpnHost, vpnUser, vpnPassword);

String serverHost = ...;
int serverPort = ...;
Socket socket = vpnConnection.openSocket(serverHost, serverPort); 
```

是否可以在不安装任何客户端软件的情况下与 VPN 建立这样的连接？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T18:56:37.673

这取决于 VPN 服务器的配置方式。

大多数 VPN 产品使用 IPSEC，一种用于加密 TCP/IP 连接的标准协议。大多数产品还使用 ISAKMP（互联网安全架构密钥管理协议，也是一种标准）来设置会话。IPSEC 和 ISAKMP 的源代码很容易获得，并且可能已经安装在您的系统上。

现在是坏消息：虽然我已经提到的一切都是标准的，但可以与 ISAKMP 一起使用的身份验证方案几乎都是专有的。两种“标准”身份验证方案是预共享密钥和 X.509 证书。如果 VPN 服务器配置为允许其中任何一个，那么您就有机会。否则，您将无法真正使用 VPN，因为该协议是真正专有的，并且几乎不可能进行逆向工程，因为身份验证对话是加密的。

一条更简单的路径：您真的需要 VPN，还是有办法通过 SSL 进行隧道传输？我认为 Java 支持 SSL；您可以创建所需的安全套接字并从那里开始。

如果您知道您正在使用什么客户端系统，那么请考虑为该系统调用 Cisco VPN 客户端。

否则，您将不得不复制 VPN 客户端的功能。VPN 客户端使用 ISAKMP 执行身份验证和会话设置，并将结果安装到内核中以创建 VPN 连接。ISAKMP 实现可用；您只需要弄清楚正在使用什么身份验证并尝试进行设置。此时您将编写自己的 VPN 客户端。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T18:44:54.700

我在 linux 上使用 vpnc 包来连接到我公司的 Cisco VPN，因为我们没有兼容的 linux 客户端。但是 vpnc 是用 c 编写的，所以你必须执行一个端口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-22T13:44:59.133

您可以阅读官方 cisco 文档，然后您可以使用这些数据创建一个 bat 文件：vpnclient connect [Connection name] pwd [Password] 并断开连接。将其包含到您的 java 程序中： Runtime.getRuntime().exec("cmd /c start [Path to bat file]");

# c# - 如何将字符串的内容复制到 C# 中的剪贴板？

> ID：899350
> 
> 赞同：286
> 
> 时间：2009-05-22T18:39:36.347
> 
> 标签：c#, .net, clipboard

如果我在字符串中有一些文本，我如何将其复制到剪贴板，以便用户可以将其粘贴到另一个窗口（例如，从我的应用程序到记事本）？

* * *

## 回答 #1

> 赞同：372
> 
> 时间：2009-05-22T18:42:22.147

您可以使用`System.Windows.Forms.Clipboard.SetText(...)`.

* * *

## 回答 #2

> 赞同：160
> 
> 时间：2009-05-22T18:41:31.477

[`System.Windows.Forms.Clipboard.SetText`](http://msdn.microsoft.com/en-us/library/ydby206k.aspx)(Windows 窗体) 或[`System.Windows.Clipboard.SetText`](http://msdn.microsoft.com/en-us/library/ms597043.aspx)(WPF)

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2009-05-22T19:09:10.737

我希望打电话`SetText`这么容易，但是你必须处理很多问题。您必须确保您调用它的线程正在 STA 中运行。它有时会因访问被拒绝错误而失败，然后在几秒钟后正常工作 - 这与剪贴板中的 COM 计时问题有关。如果通过远程桌面访问您的应用程序，则对剪贴板的访问是粗略的。我们使用集中的方法来处理所有这些场景，而不是`SetText`直接调用。

@Stecy：这是我们的集中式代码：

StaHelper 类只是在单线程单元 (STA) 中的线程上执行一些任意代码 - 剪贴板需要。

```
abstract class StaHelper
{
    readonly ManualResetEvent _complete = new ManualResetEvent( false );    

    public void Go()
    {
        var thread = new Thread( new ThreadStart( DoWork ) )
        {
            IsBackground = true,
        }
        thread.SetApartmentState( ApartmentState.STA );
        thread.Start();
    }

    // Thread entry method
    private void DoWork()
    {
        try
        {
            _complete.Reset();
            Work();
        }
        catch( Exception ex )
        {
            if( DontRetryWorkOnFailed )
                throw;
            else
            {
                try
                {
                    Thread.Sleep( 1000 );
                    Work();
                }
                catch
                {
                    // ex from first exception
                    LogAndShowMessage( ex );
                }
            }
        }
        finally
        {
            _complete.Set();
        }
    }

    public bool DontRetryWorkOnFailed{ get; set; }

    // Implemented in base class to do actual work.
    protected abstract void Work();
} 
```

然后我们有一个用于在剪贴板上设置文本的特定类。`DataObject`在某些版本的 Windows/.NET 上，在某些边缘情况下需要手动创建。我现在不记得确切的场景，.NET 3.5 可能不需要它。

```
class SetClipboardHelper : StaHelper
{
    readonly string _format;
    readonly object _data;

    public SetClipboardHelper( string format, object data )
    {
        _format = format;
        _data = data;
    }

    protected override void Work()
    {
        var obj = new System.Windows.Forms.DataObject(
            _format,
            _data
        );

        Clipboard.SetDataObject( obj, true );
    }
} 
```

用法如下所示：

```
new SetClipboardHelper( DataFormats.Text, "See, I'm on the clipboard" ).Go(); 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-05-22T18:41:21.150

WPF：`System.Windows.Clipboard`（PresentationCore.dll）

窗体：`System.Windows.Forms.Clipboard`

两者都有一个静态`SetText`方法。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2012-12-20T17:11:01.327

这对我有用：

你想做：

```
System.Windows.Forms.Clipboard.SetText("String to be copied to Clipboard"); 
```

但它会导致错误，说它必须在 ApartmentState.STA 的单个线程中。

所以让我们让它在这样的线程中运行。它的代码：

```
public void somethingToRunInThread()
{
    System.Windows.Forms.Clipboard.SetText("String to be copied to Clipboard");
}

protected void copy_to_clipboard()
{
    Thread clipboardThread = new Thread(somethingToRunInThread);
    clipboardThread.SetApartmentState(ApartmentState.STA);
    clipboardThread.IsBackground = false;
    clipboardThread.Start();
} 
```

调用后`copy_to_clipboard()`，字符串被复制到剪贴板，因此您可以粘贴或`Ctrl`+并将字符串作为**要复制到剪贴板**`V`的字符串取回。

 *** * *

## 回答 #6

> 赞同：15
> 
> 时间：2012-05-02T09:07:28.110

使用此问题中显示的解决方案`System.Windows.Forms.Clipboard.SetText(...)`会导致异常：

> 在进行 OLE 调用之前，必须将当前线程设置为单线程单元 (STA) 模式

为了防止这种情况，您可以添加属性：

```
[STAThread] 
```

至

```
static void Main(string[] args) 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-09-11T07:56:18.727

在 Windows 窗体中，如果您的字符串在文本框中，您可以轻松使用：

```
textBoxcsharp.SelectAll();
textBoxcsharp.Copy();
textBoxcsharp.DeselectAll(); 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2015-09-18T08:34:07.843

使用`try`- `catch`，即使它有错误它仍然会复制。

```
Try
   Clipboard.SetText("copy me to clipboard")
Catch ex As Exception

End Try 
```

如果您使用消息框捕获异常，它会显示错误，但该值仍会复制到剪贴板。

# apache-flex - 您可以要求函数参数是函数类的静态常量吗？

> ID：899370
> 
> 赞同：0
> 
> 时间：2009-05-22T18:42:01.803
> 
> 标签：apache-flex, actionscript-3, events, static, constants

假设我有一个自定义事件类，它有几个事件类型存储在静态常量中：

```
package customEvents
{
    public class 
    {
        public static const DISAPPEAR_COMPLETELY:String = "disappearCompletely";

        public static const SIT_DOWN:String = "sitDown";

        public static const STAND_UP:String = "standUp";

        public static const SAIL_TO_THE_MOON:String = "sailToTheMoon";

        public static const GO_TO_SLEEP:String = "goToSleep";

        public static const GO_SLOWLY:String = "goSlowly";

        public function MyCustomEvent(type:String)
        {
            super(type);
        }
    }
} 
```

有没有一种简单的方法来验证`type`传递给构造函数是类的静态常量之一，而不必检查每个值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T22:32:53.057

克里斯蒂安是正确的——这个问题包含了一个有点模棱两可的术语。当您检查事件“类型”时，它们不是数据类型，即类对象，它们只是将事件的特定“风味”传递给侦听对象的字符串值。

就个人而言，我认为您不需要对事件类型进行运行时验证。如果您的代码尝试使用不存在的事件常量，例如

```
obj.addEventListener(CustomEvent.TYPE_WHICH_DOES_NOT_EXIST, handlerMethod); 
```

...在代码运行之前，您将遇到编译器错误。如果您对事件类型使用原始字符串值，那么无论如何您都违背了使用事件常量的目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T20:45:02.307

虽然这两个答案都为验证字符串值提供了不同的解决方案，但它们没有回答有关*必须*检查值的问题。您必须这样做，至少因为常量的值本身就是字符串。

所以答案是否定的——无论如何，如果您要扩展 Event，则不会。由于该初始参数必须是一个字符串（就您扩展事件而言），无论您使用多少级间接，您最终仍将根据有效值列表检查参数。传入除 String 以外的任何内容都会引发运行时错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T19:38:58.557

为了扩展 Dan R 的答案，您可以像这样创建一个严格的事件（就像您做枚举的方式一样）类：

```
import flash.utils.Dictionary;
import flash.utils.describeType;
import flash.utils.getQualifiedClassName;

public class StrictEvent
{   
    private static var VALID_EVENTS:Dictionary = new Dictionary();

    public static function initEvents(inType:*):void {
        var events:Object = {};
        var description:XML = describeType(inType);
        var constants:XMLList = description.constant;
        for each(var constant:XML in constants) {
          events[inType[constant.@name]] = true;
        }
        VALID_EVENTS[getQualifiedClassName(inType)] = events;
    }

    public function StrictEvent(type:String)
    {
        var className:String = getQualifiedClassName(this);
        if(VALID_EVENTS[className][type]) {
            // init
        } else {
            throw new Error("Error! " + type);
        }
    }

  } 
```

然后，您可以通过扩展严格事件类并在静态初始化程序中调用 initEvents 来定义您的自定义事件类。这是您使用此方法的示例：

```
public class CustomEvent extends StrictEvent
{

    public static const DISAPPEAR_COMPLETELY:String = "disappearCompletely";

    public static const SIT_DOWN:String = "sitDown";

    public static const STAND_UP:String = "standUp";

    public static const SAIL_TO_THE_MOON:String = "sailToTheMoon";

    public static const GO_TO_SLEEP:String = "goToSleep";

    public static const GO_SLOWLY:String = "goSlowly";

    public function CustomEvent(type:String) {
        super(type);
    }    

    {
      initEvents(CustomEvent);
    }

} 
```

现在，每次它创建一个事件时，它只需要查找事件对象并查看该类型是否在该对象中。这也意味着您不必在初始化程序中手动添加所有常量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T19:18:40.797

有几种方法可以攻击它：

1.  对类型使用枚举方法以保证它在列表中。构造函数中的参数将不再是字符串，而是枚举。有关在 AS3 中复制枚举的方法，请参阅[http://blog.petermolgaard.com/2008/11/02/actionscript-3-enums/](http://blog.petermolgaard.com/2008/11/02/actionscript-3-enums/)。
2.  在您的类中使用静态构造函数将类型列表填充到 ArrayCollection 中，并使用 .contains() 方法检查成员资格。（下面可能的实现）

您的代码示例似乎是一个事件类。如果是这种情况，则不能使用第一个选项，因为如果不需要，您不想更改构造函数的签名。

```
package customEvents
{
    public class 
    {
        private static var typeList:ArrayCollection;

        public static const DISAPPEAR_COMPLETELY:String = "disappearCompletely";
        public static const SIT_DOWN:String = "sitDown";
        <... lines deleted ...>
        public static const GO_SLOWLY:String = "goSlowly";

        // static constructor    
        {
            typeList = new ArrayCollection();

            typeList.addItem(DISAPPEAR_COMPLETELY);
            typeList.addItem(SIT_DOWN);
            <... lines deleted ...>
            typeList.addItem(GO_SLOWLY);

        public function MyCustomEvent(type:String)
        {
            if (typeList.contains(type)
                super(type);
            else
                throw new Error("Invalid type");
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T18:53:55.573

如果您要将每个静态常量作为大写常量名称的小写字符串，那么您可以这样做：

```
if( class.hasOwnProperty( type.toUpperCase() ) )
{
    // Do something
}
else
{
    // Failure
} 
```

# git - 将遗留代码库从 cvs 转移到分布式存储库（例如 git 或 mercurial）。初始存储库设计所需的建议

> ID：899373
> 
> 赞同：12
> 
> 时间：2009-05-22T18:42:13.643
> 
> 标签：git, mercurial, cvs, dvcs

## 简介和背景

我们正在更改源代码控制系统，我们目前正在评估 git 和 mercurial。总代码库大约有 600 万行代码，所以不算大，也不算小。

让我首先简要介绍一下当前存储库设计的外观。

我们有一个用于完整代码库的基本文件夹，在该级别之下，有各种不同的上下文中使用的各种模块。例如，“dllproject1”和“dllproject2”可以被视为完全独立的项目。

我们正在开发的软件是我们称之为配置器的东西，它可以根据不同的客户需求进行无休止的定制。我们总共可能有 50 个不同的版本。然而，他们有一个共同点。它们都共享几个强制性模块（mandatory_module1 ..）。这些文件夹基本上包含内核/核心代码和公共语言资源等。然后，所有自定义都可以是其他模块（module1 ..）之间的任意组合。

由于我们目前使用的是 cvs，因此我们在 CVSROOT/modules 文件中添加了别名。它们可能看起来像：

```
core –a mandatory_module1 mandatory_module2 mandatory_module3
project_x –a module1 module3 module5 core 
```

因此，如果有人决定在 project_x 上工作，他/她可以快速检查以下所需的模块：

```
base>cvs co project_x 
```

## 问题

直觉上，将基本文件夹作为单个存储库感觉是错误的。作为程序员，您应该能够检查您正在使用的当前项目所需的确切代码子集。您对此有何看法？

另一方面，将这些模块中的每一个放在单独的存储库中感觉更合适。但这使得程序员更难检查他们需要的模块。您应该能够通过单个命令来执行此操作。所以我的问题是：在 git/mercurial 中是否有类似的定义别名的方法？

任何其他问题，建议，指针都非常欢迎！

PS。我已经搜索过类似的问题，但并不觉得其中任何一个问题 100% 地适用于我的情况。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-22T18:54:40.783

只是一个简短的评论来提醒你：

*   这些迁移通常提供了重新组织源的机会，而不是沿着模块（每个模块都有一个存储库），而是沿着功能域拆分（相同给定功能域的几个模块放在同一个存储库中）。

然后将使用[子模块](http://git-scm.com/docs/git-submodule)作为定义[配置](https://stackoverflow.com/questions/769786/vendor-branches-in-git/769941#769941)的一种方式。

*   Git 没问题，但是从[Linus 自己的承认](http://osdir.com/ml/git/2009-05/msg00051.html)来看，将所有内容都放在一个存储库中可能会出现问题。

> [...] CVS，即它实际上最终非常面向“一次一个文件”模型。
> 
> 这很好，因为您可以拥有一百万个文件，然后只检查其中的几个 - 您甚至永远不会*看到*其他 999,995 个文件的影响。
> 
> Git 从根本上说从来没有真正关注过整个 repo。即使你稍微限制了一些事情（即只检查一部分，或者让历史回溯一点），git 最终仍然总是关心整个事情，并随身携带知识。
> 
> 所以如果你强迫 git 把所有东西都看成一个 *巨大的*存储库，那么它的扩展性就会非常糟糕。我不认为这部分是真正可以修复的，尽管我们可能可以改进它。
> 
> 是的，然后是“大文件”问题。我真的不知道如何处理大文件。我们很讨厌他们，我知道。

* * *

上述两点主张为大型系统（和大型遗留存储库）采用更加面向组件的方法。

使用[Git submodule](http://book.git-scm.com/5_submodules.html)，您可以在项目中签出它们（即使它是一个两步过程）。但是，您拥有可以使子模块管理更容易的工具（例如[git.rake](http://flavoriffic.blogspot.com/2008/05/managing-git-submodules-with-gitrake.html)）。

* * *

> 当我考虑修复在多个项目之间共享的模块中的错误时，我只是修复错误并提交它，然后所有人都只是进行更新

这就是我在[Vendor Branch](https://stackoverflow.com/questions/769786/vendor-branches-in-git/769941#769941)中描述的“系统方法”：每个人都在最新的（HEAD）上工作，它对少数项目有效。
尽管对于大量的模块，“模块”的概念仍然非常有用，但它的管理与 DVCS 不同：

*   对于密切相关的模块（又名“在同一功能域中”，例如“与 PNL 相关的所有模块 - 利润和损失 - 或“风险分析”，在金融领域），您确实需要使用最新的 (HEAD)所有涉及的组件。
    这将通过使用[子树策略](http://www.kernel.org/pub/software/scm/git/docs/howto/using-merge-subtree.html)来实现，不是为了让您发布（推送）对那些其他子模块的更正，而是为了跟踪其他团队所做的工作
    。Git 允许这样做的额外奖励是这种“跟踪”不必在您的存储库和一个“中央”存储库之间进行，也可以在您和另一个团队的本地存储库之间进行，从而允许非常快速的来回集成和测试类似性质的项目。

*   但是，对于不直接在您的功能域中的模块，子模块是更好的选择，因为它们指的是模块的修复版本（提交）：
    当低级框架发生更改时，您不希望它被传播*瞬间*，因为它会影响所有其他团队，然后他们将不得不放弃他们正在做的事情以使他们的代码适应那个新版本（你确实希望所有其他团队都知道这个新版本，以便他们不要忘记更新该低级组件或“模块”）。
    这允许您仅使用其他模块的官方稳定识别版本，而不是潜在的不稳定或未完全测试的 HEAD。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-24T18:40:10.327

至于 Mercurial 方面，建议还将大型遗留 CVS/SVN 存储库重构为更小的组件。公共代码应该放入自己的库中，然后应用程序代码将依赖于这些库，就像它依赖于其他库一样。

Mercurial 具有[森林扩展](http://www.selenic.com/mercurial/wiki/ForestExtension)，允许您管理“源树”的“森林”。使用这种方法，您可以将几个较小的存储库组合成一个较大的存储库。使用 CVS，您可以做相反的事情：您签出大型存储库的一小部分。

我没有亲自使用过森林扩展，它的页面说与 Mercurial 捆绑的版本相比，应该使用更新版本。但是，像 Sun 这样的大型组织在其[OpenJDK 项目](http://openjdk.java.net/guide/repositories.html#installConfig)*中*使用它。

根据 Mercurial wiki 中[嵌套存储库页面](http://www.selenic.com/mercurial/wiki/NestedRepositories)的设计，目前还正在进行将子存储库报告直接添加到 Mercurial 核心的工作。

# sharepoint - 从 CheckoutStepsTemplate 以编程方式创建列表会引发异常

> ID：899380
> 
> 赞同：1
> 
> 时间：2009-05-22T18:44:15.310
> 
> 标签：sharepoint, microsoft-commerce-server

（此问题已在[此处](http://social.msdn.microsoft.com/Forums/en-US/commserver2007/thread/e85820a0-1436-4926-8b07-ad5f008ea884)的 MSDN 论坛上交叉发布。）

我正在开发一个自定义 SharePoint/Commerce Server 站点，并且我有一个自定义功能，旨在做两件事：通过模块提供一些页面，并使用功能接收器中的 CheckoutStepsList 模板提供结帐步骤列表。但是，出于某种原因，在某些情况下，列表创建会引发异常：

无效的文件名

您指定的文件名无法使用。它可能是现有文件或目录的名称，或者您可能没有访问该文件的权限。

当我尝试导航到列表时，我被带到列表设置页面（应该有一个默认视图），并且列表中有 0 个项目。所以看起来它提供了一半的列表，但在中间的某个地方崩溃了。

重现此问题有些困难。如果我通过命令行上的 stsadm 命令激活该功能，它总是会失败，但如果我通过 SharePoint UI 执行此操作，有时会失败，有时不会。如果通过模块配置的页面尚不存在，则似乎更频繁地发生 UI 崩溃，但我还不确定。

这是有问题的代码：

```
SPListTemplateCollection listTemplateCollection = web.Site.GetCustomListTemplates(web);
SPListTemplate checkoutStepsTemplate = listTemplateCollection["CheckoutStepsTemplate"];
Guid listID = web.Lists.Add(listName, String.Empty, checkoutStepsTemplate); // the exception is thrown on this line 
```

知道这里发生了什么吗？我将继续对此进行调试，并且很乐意提供任何可能有助于诊断问题的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T17:48:51.110

我从来没有找到这个问题的完整解决方案，但我确实诊断出足够多的问题，我们找到了一个可接受的解决方法。事实证明，该问题仅在通过相同功能中的模块配置元素时发生，但当这些模块包含在不同功能中时，一切正常。

我们决定暂时继续，所以就我找到问题的根本原因而言，但它至少是一个足够好的修复，它不会在未来让我们头疼。

# sql-server - 将 MS Access 连接到我应该注意的 SQL Server 数据库是否存在任何问题？

> ID：899381
> 
> 赞同：0
> 
> 时间：2009-05-22T18:44:27.150
> 
> 标签：sql-server, ms-access, dynamics-gp

我在 Microsoft Dynamics GP 中出现了一个问题，正在研究这是否是原因，但这可能是对 SQL Server 的访问问题。GP 将数据存储在 SQL Server 中，MS Access 用于访问表数据。生产数据库中的某些数据似乎丢失了。不幸的是，我不知道 Access 正在做什么，因为没有向我透露。一个简单的解决方案是告诉他们停止使用 Access 来验证数据是否仍然丢失，但在提出此建议之前，我想知道任何记录在案的问题。

因此，为了对正在发生的事情做出最好的猜测，当 Access 作为后端连接到 SQL Server 时会做什么？它会锁定桌子吗？必须做什么才能导致数据丢失或删除？如果访问是原因，应采取哪些步骤来解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T18:50:40.183

您是否打算允许 Access 更改或删除数据？

如果没有，您是否考虑过设置一个用户 ID 供 Access 使用，以允许只读访问（没有双关语）？

在任何情况下，SQL Server 的最佳实践是确保用户帐户具有满足业务需求所需的最低访问权限。请不要给大家一个密码空白的sa账号。

编辑：

将 Access 想象为 SQL Server Management Studio 之类的工具，换句话说，它是一种交互式工具，可用于以几乎无限的方式查询和更改数据库，前提是您的帐户具有允许您执行此操作的权限。由于它是一个可以拉出表格的交互式环境，因此删除一行就像单击该行并按下删除键一样简单。同样，更改数据值就像单击该行和列并键入新值一样简单。

当然，删除某些东西就像意外按下删除键一样简单。

当您为用户提供这样一个工具和一个没有访问限制的帐户时，无论是出于意图、意外还是其他原因，数据最终都会被更改，这并不让我感到惊讶。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T18:58:39.310

SQL Server 数据通常在 MSACCESS 中使用链接表访问，这些链接表是 ODBC/OLEDB 连接。虽然这项技术有些过时并且并非完全没有错误，但我想不出底层技术中可能导致这种情况的任何东西。

您的普通用户是否使用 ODBC 数据源或包含 SQL Server 数据库管理员 ID 和密码的连接字符串访问这些表（即不受限制的权限）？如果是这样，缺失的数据将是给定的。在打开的 MSACCESS 链接表中删除行就像在 Excel 中删除行一样简单。

Record locking in MSACCESS/SQL connections is typically optimistic (unless you change it). In the old days under SQL Server 2000 this meant that if two people were editing the same record at the same time, the person who saves last won (silently). Nowadays the last person saving is told that someone else has edited the record while they were making changes, and offers two options: abandon my changes, or overwrite the other person's changes.

In any case, providing read-only access to the tables should alleviate a lot of the heartburn.

# php - 如何使用程序代码库在 PHP 中编写单元测试？

> ID：899390
> 
> 赞同：31
> 
> 时间：2009-05-22T18:46:05.103
> 
> 标签：php, unit-testing, phpunit, simpletest, paradigms

我对单元测试的好处深信不疑，我想开始将这个概念应用到用 PHP 编写的大型现有代码库中。不到 10% 的代码是面向对象的。

我查看了几个单元测试框架（PHPUnit、SimpleTest 和 phpt）。但是，我还没有找到任何测试程序代码的示例。什么是适合我情况的最佳框架，是否有任何使用非 OOP 代码对 PHP 进行单元测试的示例？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-06-18T17:07:26.367

您可以对程序 PHP 进行单元测试，没问题。如果您的代码与 HTML 混合在一起，您肯定不会不走运。

在应用程序或验收测试级别，您的程序 PHP 可能依赖于超全局变量（`$_POST, $_GET, $_COOKIE`等）的值来确定行为，并通过包含模板文件并输出输出来结束。

要进行应用程序级测试，您只需设置超全局值即可；启动一个输出缓冲区（以防止一堆 html 淹没您的屏幕）；调用页面；断言缓冲区内的东西；并在最后丢弃缓冲区。所以，你可以这样做：

```
public function setUp()
{
    if (isset($_POST['foo'])) {
        unset($_POST['foo']);
    }
}

public function testSomeKindOfAcceptanceTest()
{
    $_POST['foo'] = 'bar';
    ob_start();
    include('fileToTest.php');
    $output = ob_get_flush();
    $this->assertContains($someExpectedString, $output);
} 
```

即使对于包含大量包含的巨大“框架”，这种测试也会告诉您应用程序级功能是否正常工作。当您开始改进代码时，这将非常重要，因为即使您确信数据库连接器仍然可以工作并且看起来比以前更好，您也会想要单击一个按钮并看到，是的，您仍然可以通过数据库登录和注销。

在较低级别，根据变量范围以及函数是否通过副作用（返回真或假）或直接返回结果而存在细微变化。

变量是否作为函数之间的参数或参数数组显式传递？还是变量设置在许多不同的地方，并作为全局变量隐式传递？如果这是（好的）显式案例，您可以通过以下方式对函数进行单元测试：（1）包括保存函数的文件，然后（2）直接提供函数测试值，以及（3）捕获输出并针对它进行断言。如果您使用全局变量，您只需要格外小心（如上所述，在 $_POST 示例中）小心地将测试之间的所有全局变量清空。在处理一个推送和拉取大量全局变量的函数时，保持测试非常小（5-10 行，1-2 个断言）也特别有用。

另一个基本问题是函数是通过返回输出工作，还是通过改变传入的参数，返回真/假来代替。在第一种情况下，测试更容易，但同样，在这两种情况下都有可能：

```
// assuming you required the file of interest at the top of the test file
public function testShouldConcatenateTwoStringsAndReturnResult()
{
  $stringOne = 'foo';
  $stringTwo = 'bar';
  $expectedOutput = 'foobar';
  $output = myCustomCatFunction($stringOne, $stringTwo);
  $this->assertEquals($expectedOutput, $output);
} 
```

在不好的情况下，您的代码通过副作用工作并返回 true 或 false，您仍然可以很容易地进行测试：

```
/* suppose your cat function stupidly 
 * overwrites the first parameter
 * with the result of concatenation, 
 * as an admittedly contrived example 
 */
public function testShouldConcatenateTwoStringsAndReturnTrue()
    {
      $stringOne = 'foo';
      $stringTwo = 'bar';
      $expectedOutput = 'foobar';
      $output = myCustomCatFunction($stringOne, $stringTwo);
      $this->assertTrue($output);
      $this->Equals($expectedOutput, $stringOne);
    } 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-22T20:09:09.480

单元测试做得好的地方，以及你应该使用它们的地方，是当你有一段代码，你提供了一些输入，并且你希望得到一些输出。这个想法是，当您稍后添加功能时，您可以运行测试并确保它仍然以相同的方式执行旧功能。

所以，如果你有一个程序代码库，你可以在测试方法中调用你的函数来完成这个

```
require 'my-libraries.php';
class SomeTest extends SomeBaseTestFromSomeFramework {
    public function testSetup() {
        $this->assertTrue(true);
    }

    public function testMyFunction() {
        $output = my_function('foo',3);

        $this->assertEquals('expected output',$output);
    }
} 
```

PHP 代码库的这个技巧是，您的库代码通常会干扰测试框架的运行，因为您的代码库和测试框架将有很多与在 Web 浏览器中设置应用程序环境相关的代码（会话、共享全局变量等）。期望花费一些时间来包含您的库代码并运行一个简单的测试（上面的 testSetup 函数）。

如果您的代码没有函数，而只是一系列输出 HTML 页面的 PHP 文件，那么您有点不走运。您的代码不能分成不同的单元，这意味着单元测试对您没有多大用处。您最好将时间花在[Selenium](http://seleniumhq.org/)和[Watir](http://wtr.rubyforge.org/)等产品的“验收测试”级别上。这些将让您自动化浏览器，然后将页面内容检查为特定位置/表单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T18:58:53.753

您可以尝试使用将您的非 oop 代码包含到测试类中

```
require_once 'your_non_oop_file.php' # Contains fct_to_test() 
```

使用 phpUnit 定义你的测试函数：

```
testfct_to_test() {
   assertEquals( result_expected, fct_to_test(), 'Fail with fct_to_test' );
} 
```

# java - MIDP 2 移动应用程序中的 Java 枚举

> ID：899398
> 
> 赞同：4
> 
> 时间：2009-05-22T18:48:38.377
> 
> 标签：java, enums, design-patterns, midp, type-safety

在使用了 4 年的 .NET 2 和 Java 5 和 6 之后，我刚刚回到 MIDP 开发。在那段时间里，我非常喜欢使用枚举。

枚举是一种语言特性，它允许开发人员对其代码的某些部分更有信心，特别是能够更早地避免或检测错误（在编译期间）。其他一些优点可以在这里找到：**http://java.sun.com/j2se/1.5.0/docs/guide/language/enums.html**

我发现在 MIDP 2.0 中找不到它们很奇怪。我收到此错误消息：

> “类型 'enum' 不应用作标识符，因为它是源级别 1.5 中的保留关键字”

前段时间我有一些使用 Java 1.4 的经验，但我不记得了。你的高级语言的新版本肯定有一些你认为理所当然的特性......

无论如何，这里有一个很好的建议，没有它们怎么办（如果您正在开发 MIDP 或处理 Java 5 之前的代码）：**http://www.javacamp.org/designPattern/enum.html**

总结一下（更多细节和很好的解释，请点击前面的链接。非常感谢原作者）：

```
//The typesafe enum pattern
public class Suit {
    private final String name;

    public static final Suit CLUBS =new Suit("clubs");
    public static final Suit DIAMONDS =new Suit("diamonds");
    public static final Suit HEARTS =new Suit("hearts");
    public static final Suit SPADES =new Suit("spades");    

    private Suit(String name){
        this.name =name;
    }
    public String toString(){
        return name;
    }

} 
```

您对这个问题还有其他不同的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-03T20:02:40.993

MIDP 的问题在于它停留在 Java 语言级别 1.2（有人说是 1.3 或 1.4，但这不是重点），并且枚举是在 1.5 中引入的。您的模式是朝着正确方向迈出的一步，但缺少“真实”枚举的一些功能，例如为每个常量分配一个序数。

您可能会在 1.5 中引入的泛型、注释等方面遇到类似问题。有一些工具可以将 Java 1.5 转换回 1.2，[这里](https://stackoverflow.com/questions/974836/compiling-java-code-written-for-1-5-to-work-with-1-4-jre)列出了一些。像这样，您应该能够在 1.5 中编写代码并在 MIDP 上运行。但是请注意，使用这些工具会使您的构建过程相当复杂，而您提到的解决方案不会。

# prototypejs - 原型：找到某个类的所有元素？

> ID：899399
> 
> 赞同：10
> 
> 时间：2009-05-22T18:48:39.203
> 
> 标签：prototypejs

使用 Prototype js 框架，如何找到某个类的所有元素？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-22T18:57:35.393

您可以使用[$$ 函数](http://prototypejs.org/doc/latest/dom/dollar-dollar/)按类获取元素：

```
$$(".myclass") 
```

会给你一个可以迭代的元素数组。此函数也允许您使用任何 css 选择器来获取元素：

```
$$("li.myclass")
$$("p#test") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T18:52:20.833

[http://prototypejs.org/doc/latest/dom/dollar-dollar](http://prototypejs.org/doc/latest/dom/dollar-dollar)

$$ 允许您传入任何 css 选择器。

```
$$('.class') 
```

# vb.net - 单步执行控件看不到第二个下拉菜单

> ID：899402
> 
> 赞同：0
> 
> 时间：2009-05-22T18:49:26.113
> 
> 标签：vb.net, controls, containers

我有一个 ASP.net 表。在几个单元格中，我有两个下拉列表。每个下拉列表中选择的项目应该是从 SQLServer 2005 数据库中填充的。为此，我在后面的代码中逐步执行每个表格单元格中的控件。代码看到第一个下拉列表并填充它，然后转到下一个单元格。

我的 ASP

```
<asp:TableRow runat="server" ID="rowEnglish">
    <asp:TableCell ID="celCourseEnglish" runat="server">
        <asp:DropDownList ID="ddlCourseEnglish" runat="server" AutoPostBack="True">
            <asp:ListItem Value="0">English</asp:ListItem>
        </asp:DropDownList>
        <br />
        <asp:DropDownList ID="ddlCommentEnglish" runat="server" Font-Size="X-Small" DataSourceID="sqlDS_comment" DataTextField="comment" DataValueField="id" Width="125px">
        </asp:DropDownList> 
```

我的 VB

```
 For Each rowTemp In dtScores.Rows
    Dim tblRow As TableRow
    For Each tblRow In tblProgReport.Rows
        Dim celTemp As New TableCell
            For Each celTemp In tblRow.Cells
                Dim ctl As Control
                    For Each ctl In celTemp.Controls

                        If TypeOf ctl Is DropDownList Then
                        Dim ddlTemp As DropDownList = CType(ctl, DropDownList)
                        'select value from dropdown list 
```

我已经尝试更改单元格中控件的顺序，但课程下拉菜单仍然是可见的。尝试删除课程下拉列表，然后评论下拉列表正确显示。整个事情都在母版页的内容占位符中。不知道为什么没有看到第二个下拉列表。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T18:59:19.930

You may have to post your complete VB code. What are you doing once you find it? You are continuing in your foreach correct? You are not breaking out of it?

# c# - 在 C# 中向根 xelement 元素添加/创建命名空间

> ID：899403
> 
> 赞同：2
> 
> 时间：2009-05-22T18:49:26.893
> 
> 标签：c#, linq-to-xml

我正在通过 xelement 使用 linq.xml 创建 xml。我的雇佣关系是这样的

我想要这个模式 2 str

这是我的模式生成代码

```
 XNamespace ns = XNamespace.Get("urn:APISchema.xsd");
 root = new XElement(ns + "Foo");
 root.Add(new XElement("version", "2"));
 root.Add(new XElement("foochild", "str")); 
```

但结果模式是

```
<Foo xlmns="urn:APISchema.xsd">
<version xlmns="">2</version>
<foochild xlmns="">str</foochild>
</Foo> 
```

知道为什么会出现这样的问题，为什么将 xlmn 附加到根子级...？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T18:52:59.490

```
root.Add(new XElement(namespace + "foo", "str")) 
```

编辑：在进一步搜索后，[这个问题](https://stackoverflow.com/questions/61084/empty-namespace-using-linq-xml)似乎正在解决同样的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T18:55:09.767

您向元素 'usr:APISchema.xsd::Foo' 添加了两个带有 oa 命名空间的元素。生成的 XML 是预期的。您必须将命名空间添加到每个添加的元素：`root.Add(new XElement(namespace + "foochild")`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T19:02:29.847

```
XNamespace myNameSpace = XNamespace.Get("urn:APISchema.xsd");
        root = new XElement(myNameSpace + "Foo",
                                new XElement(myNameSpace + "foo", "str")); 
```

IMO 这更容易阅读。但正如理查德所说，您只需要添加命名空间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T20:04:04.060

```
XNamespace myNamespace = XNamespace.Get("urn:APISchema.xsd");
root = new XElement(myNamespace + "Foo",
    new XElement(myNamespace + "version", "2"),
    new XElement(myNamespace + "foochild", "str")); 
```

试一试，它应该为您解决问题。

# erlang - 在 erlang 中编码/解码 XDR 类型的推荐方法是什么？

> ID：899411
> 
> 赞同：2
> 
> 时间：2009-05-22T18:50:49.730
> 
> 标签：erlang, network-programming, externalinterface

[在另一个 SO 讨论中，我们正在讨论将 erlang 应用程序连接到另一个使用XDR 编码数据包进行网络通信](http://en.wikipedia.org/wiki/External_Data_Representation)的非 erlang 应用程序。

不幸的是，我真的找不到任何关于使用 erlang 处理 XDR 数据的真正指针。

那么在erlang中处理XDR编码数据的推荐方法是什么？

谢谢

PS：到目前为止，我可以找到以下资源：

*   [让 Erlang 与外部世界对话](http://www.erlang.se/workshop/2002/Armstrong.pdf)（2002，PDF，只是简短地提到了 XDR）

*   [Sendmail 遇到 Erlang：Erlang 用于电子邮件应用程序的体验](http://www.jetcafe.org/~npc/doc/euc00-sendmail.html)（2000 年，这里也没有相关内容，但仍然是一本有趣的读物）

*   [然后是这个帖子](http://erlang.org/pipermail/erlang-questions/2000-August/001543.html)，它是相关的，并提供了一些 XDR 例程，但来自 08/2000，因此甚至早于 erlang 对位语法的支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-21T10:16:19.177

[Jungerl](http://jungerl.sourceforge.net/) Erlang 源代码集合中有一个名为[rpc](https://github.com/gebi/jungerl/tree/master/lib/rpc/src)的项目。它有一个代码生成器，可以生成 Erlang 代码来管理基于 XDR 的协议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T01:50:15.133

构建您自己的 XDR 编码和解码库并不困难。

将 Erlang 术语编码为 XDR 很简单：

```
%% @spec push_bool(bool()) -> binary()

push_bool(Value) ->
    case Value of
        true ->
           <<0, 0, 0, 1>>;
        false ->
            <<0, 0, 0, 0>>
    end. 
```

采用另一种方式会更加冗长，具体取决于您希望如何完成错误报告。我选择了例外：

```
%% @spec pull_bool(binary()) -> {bool(), binary()}

pull_bool(Bin) ->
    {Value, Tail} = 
        try
            <<0, 0, 0, V, T/binary>> = Bin,
            {V, T}
        catch 
            error:{badmatch, _} -> 
                throw({xdr_error, "Invalid boolean value"})
        end,
    Result = case Value of
                 0 -> false;
                 1 -> true;
                 _ -> throw({xdr_error, "Invalid boolean value"})
             end, 
    {Result, Tail}. 
```

总共确实没有那么多 XDR 数据类型，因此总共可能只有几百行代码。

# jquery - JQuery：访问每个内部的原始 jquery 对象

> ID：899413
> 
> 赞同：2
> 
> 时间：2009-05-22T18:51:12.443
> 
> 标签：jquery, each

我正在尝试在 JQuery 中的一组 DIV 上实现 HTML 单选按钮行为。我想从所有元素中删除“set”类，然后使用 addClass() 重新设置单击的（一个）元素：

```
$(".button").each(function() {
  $(this).click(function(){
    // what goes here to call removeClass() on *all* the elements?
    $(this).addClass("set");
  });
}); 
```

我想在所有元素上调用 removeClass() - 在本例中为 $(".button")，但我不能明确引用 $(".button")。

我不能只在循环外调用 $(".button").removeClass("set") 因为这是更大程序的一部分，并且 each() 循环内的行为可以通过其他参数进行修改。

有没有办法从内部访问完整的元素集，或者将它们作为变量传递？还是有另一种解决问题的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T19:19:15.007

您可能正在寻找新的[选择器](http://docs.jquery.com/Core/selector)功能，因为您正在制作插件：

```
jQuery.fn.test = function() {
    console.log(this.selector); // .button
};

$('.button').test(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T19:06:18.263

如果您不能在内部函数中对选择器进行硬编码，jQuery 实际上可以返回在原始调用中用作选择器的字符串。见[$('.bla').selector](http://docs.jquery.com/Core/selector)

不过，这仅在较新的版本中添加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T18:55:34.260

这似乎不必要地复杂，它可能有助于更清楚地了解您最终要实现的目标。

在循环中，您可以使用 jquery $("div") // 在循环中获取任何您喜欢的内容

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T18:56:46.660

你说“但我不能明确地引用 $(".button")。”。这是为什么？

```
$(".button").each(function() {
  $(this).click(function(){
    $('.button').removeClass('set'); // this should do it
    $(this).addClass("set");
  });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T18:57:16.393

只是改变：

```
$(".button").each(function() {
  $(this).click(function(){
    $('.button').removeClass("set");
    $(this).addClass("set");
  });
}); 
```

我不明白为什么这会是一个问题，每次都必须拉动 .button 有点慢，但这是包含在循环中的唯一方法，就像你想要的那样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T18:57:39.140

我回答了正文中提出的问题：如果您想设置所有***其他***同级元素的类，请使用同级。

[有趣，因为这是在 radioClass() 下的路线图中](http://docs.jquery.com/JQuery_1.4_Roadmap#Attributes_.2F_CSS)

你想要的是[兄弟姐妹](http://docs.jquery.com/Traversing/siblings)，也不要使用 each 来设置点击事件。

```
$(".button").click(function() {
  $(this).addClass('set');
  $(this).siblings('.button').removeClass('set');
}); 
```

请参阅此示例以了解上述情况：

[http://jsbin.com/ewiqe](http://jsbin.com/ewiqe)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T19:31:45.560

仍然不确定为什么你不能从内部函数引用 $('.button') 但你可以在自由变量中捕获引用吗？

```
var buttons = $(".button");
buttons.each(function() {
  $(this).click(function(){
    // what goes here to call removeClass() on *all* the elements?
    buttons.removeClass('set');
    $(this).addClass("set");
  });
}); 
```

# java - 在 Java 中，为什么超类方法不能从子类实例访问受保护或私有方法/变量？

> ID：899414
> 
> 赞同：7
> 
> 时间：2009-05-22T18:51:28.870
> 
> 标签：java, oop, class, inheritance, instance

让我们从另一种行为开始：即使您将方法/变量声明为私有，同一类的另一个实例也可以访问它。没关系，我可以忍受它。我称这些为类私有而不是实例私有。

现在是问题部分：例如，在运行时我希望能够检查`this`类中的所有 String 变量是否不为空，如果它们为空，则应将其更改为字符串“NULL”。

我可以使用反射来遍历变量并获取它们的值。但是，如果我扩展我的类并添加私有甚至受保护的变量，我的基类将无法访问它们。我必须先`setAccessible`了解变量，然后才能使用它们。

所以请向我解释为什么基类（超类）不能从它的子类访问私有/受保护的变量。这是它的子类，所以我不明白。这背后的想法是什么？

我知道超类不应该知道它的子类，但在我的例子中它是有道理的，不是吗？

是因为我不能或不应该以这种方式限制我的子类吗？

* * *

**更新：** 根据答案，我还想知道：为什么不从同一个类访问另一个实例的私有变量被视为违反封装？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T22:30:45.417

要回答您的更新问题（因为原始问题已经得到很好的回答），私有的目的是隐藏实现细节，以便这些实现细节不会成为依赖项。这是面向对象编程的本质 - 封装确保通过将不同部分隔离到自己的区域来保持复杂性的可管理性。

由于类知道它自己的实现——它定义了它，因此限制对其他实例的访问没有任何好处，因为类实现声明了它已经暴露给所有这些细节的所有私有实例。

在这种情况下隐藏它实际上会增加复杂性，因为您必须添加额外的访问级别以允许类级别的可见性而不是实例级别的可见性，而实际上并没有真正封装任何进一步的复杂性。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T18:59:11.040

它就像违反封装一样简单。即使您概括了该班级，另一个班级也不应该能够进入您的班级并弄乱事物。例如，车辆如何知道有关汽车的任何信息？基类的全部意义在于提供子类，但就像过度保护的父母一样，你的建议太多了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T19:02:24.060

这都是关于继承和封装的。

Java 的可见性规则指出

1.  私有成员只能在定义它们的类中访问
2.  受保护的成员只能在
    *   定义它们的类
    *   定义它们的类的子类
    *   与定义它们的类在同一包中的其他类

当然，正如您所提到的，在反思中您可以更改规则（除非 SecurityManager 禁止它）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T19:26:13.857

我更倾向于从务实和现实的角度看待它：

```
public class Test1 {
    private int a = 1;

    public static void main(String s[]) {
        System.out.println((new Test1()).a);
        System.out.println((new Test1()).getA());
        System.out.println((new Test2()).getA());
    }

    public int getA() { return a; }
}

class Test2 extends Test {
    private int a = 2;

    public int getA() { return a; }
} 
```

您建议使用什么语法来`Test1`访问. 当被写入时，可能甚至不存在。`a``Test2``Test1``Test2`

同样，基类（超类）也不知道它是从什么时候继承而来的。为了让基类知道它何时被继承，您必须能够在从它继承时修改基类。您是否建议我`ArrayList`在编写时以某种方式修改我的本地副本：

```
class MyArrayList extends ArrayList 
```

当我决定在你的计算机上运行我的代码的那一天会发生什么，你会得到我修改过的`ArrayList`那个知道的副本`MyArrayList`，还是我会以某种方式修改你计算机上的副本？

这些问题能以某种方式克服吗？当然。允许它有什么价值吗？没有我能看到的。

# regex - 不以序列开头的字符串的正则表达式

> ID：899422
> 
> 赞同：251
> 
> 时间：2009-05-22T18:53:14.263
> 
> 标签：regex

[我正在使用这个程序](http://schemaspy.sourceforge.net/)处理一堆表，但我需要忽略那些以标签“tbd_”开头的表。到目前为止，我有类似 [^tbd_] 的东西，但这根本不匹配那些字符。

* * *

## 回答 #1

> 赞同：408
> 
> 时间：2009-05-22T18:57:13.477

您可以使用[否定的前瞻](http://www.regular-expressions.info/lookaround.html)断言：

```
^(?!tbd_).+ 
```

或否定的后视断言：

```
(^.{1,3}$|^.{4}(?<!tbd_).*) 
```

或者只是简单的旧字符集和替换：

```
^([^t]|t($|[^b]|b($|[^d]|d($|[^_])))).* 
```

# javascript - 如何将此工作的 JAVASCRIPT 代码转换为 JQUERY

> ID：899432
> 
> 赞同：0
> 
> 时间：2009-05-22T18:55:12.187
> 
> 标签：javascript, jquery

```
 <script language="javascript" type="text/javascript">

function hasPasswordChanged(value)
  {
        if(value == '1')
        {
            var container = document.getElementById("sNav");
            if(document.getElementsByTagName)
            {
               var hyperLinkList = container.getElementsByTagName("a");

               for(var currentLink in hyperLinkList)
               {
                    hyperLinkList[currentLink].disabled = true;
                    hyperLinkList[currentLink].onclick =function () { return false;}

               }

            }
        }
  }

  window.onload = function () 
  {
        hasPasswordChanged('<%  = HasPasswordAlreadyChanged %>');
  }

</script> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T19:00:04.097

假设我是正确的，如果密码已经更改（1 为真），您希望禁用页面上的导航链接。

```
$(function() {
   var changed = <%= HasPasswordAlreadyChanged %>;
   if (changed) {
      $('#sNav a').attr('disabled','disabled')
                  .click( function() { return false; } );
   }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T19:00:54.170

```
function hasPasswordChanged(value)
  {
        if(value == '1')
        {
            $('#sNav a').attr('disabled', 'true').click(function(){ return false; });
        }
  }

$(function(){
    hasPasswordChanged('<%  = HasPasswordAlreadyChanged %>');
}) 
```

或者更奇怪一点：

```
$(function(){
    <%  = HasPasswordAlreadyChanged %> == 1 ? $('#sNav a').attr('disabled', 'true').click(function(){ return false; }) : ""; 
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T19:02:37.803

```
<script language="javascript" type="text/javascript">
  $(function(){
    if ('<%  = HasPasswordAlreadyChanged %>' == '1') {
      $("#sNav").find("a").attr("disabled","disabled").click(function(){return false;});
    }
  });
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T10:16:16.407

由于您的 JavaScript 正在工作，因此将其转换为 jQuery 可能没有任何价值，可能会引入任何错误。

我唯一可能考虑的是使用 jQuery 的事件处理而不是显式使用**window.onload**：

```
function hasPasswordChanged() {
    // unchanged
}

$(document).ready(function() {
    hasPasswordChanged('<%  = HasPasswordAlreadyChanged %>');
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T19:15:17.293

假设 HasPasswordAlreadyChanged 为 0 或 1（或 flase/true）

```
jQuery(function($){
  !!<%= HasPasswordAlreadyChanged %> && $("#sNav a").attr("disabled",true).click(function(){return false;})
}) 
```

此外， A 元素上的 disabled 属性是否会以任何方式影响它？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T19:16:08.320

```
function hasPassWordChanged(value) {
  if (value == '1') {
    $("#sNav a").attr("disabled", true).click(function() {return false;});
  }
}

$(function() {
  hasPasswordChanged('<%  = HasPasswordAlreadyChanged %');
}); 
```

这将选择所有`a`具有 id 的节点的子标签，`sNav`将其所有禁用属性设置为 true，并将指定的返回 false 函数设置为在单击事件时调用。

最后一部分，`$()`对指定函数的调用，在 DOM 准备好处理时运行该函数，并且是`$(document).ready()`传递函数时的同义词。您也可以将其替换为您的设置，但jQuery 更喜欢`window.onload`调用 to 。`$()`

# c# - ORM 映射的代码生成工具

> ID：899435
> 
> 赞同：1
> 
> 时间：2009-05-22T18:55:47.207
> 
> 标签：c#, nhibernate, code-generation

似乎没有尽头的代码生成工具，宁愿不必逐个查看仍然维护的、易于使用的和提供定制的工具。代码生成用于 NHibernate 映射和随后创建值对象或数据传输对象 (DTO)。如果它也可以生成其他语言，例如动作脚本，那就太好了。

由于正在开发的这个应用程序使用数据库，所以 ORM 通常是 1:1 映射。我知道这违背了使用 NHibernate 的大多数原因，但事实就是如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T19:42:16.023

T4 - 内置于 Visual Studio 2008。您已经免费获得它。效果很好，完全支持。如果您进行一些搜索，您可以找到 Linq To Sql 和实体框架的 T4 脚本。我确信 NHibernate 脚本也存在。

MyGeneration：开源，也很不错。没有 Visual Studio 集成。

Code Smith：商业，做得很好。还集成到 Visual Studio 中。

所有这些都是可定制的。就脚本而言，Code Smith 和 T4 都与我非常相似。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T19:13:33.817

我通常创建一个 XSLT，它查询连接到 syscolumns 的 sysobjects（假设一个正在使用 SQL Server）并转换输出以构建必要的结构。这样做的缺点是您必须自己编写代码和调试它。然而，一旦你让它工作起来，你就有 100% 的灵活性来扩展和定制它，唯一的成本是前期的时间和精力（通常大约需要 2-3 天才能获得初始工作副本）。

希望这可以帮助，

账单

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T19:13:44.597

我还没来得及看它，但 4.0 中的实体框架（VS2010，现已公开测试版）支持从 edmx 生成代码的 T4 模板......所以你可以随意定制它。搜索“Entity Framework T4 Template”，你会发现很多，尤其是最近几天。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T19:46:05.313

我们使用了开源[NVelocity](http://nvelocity.sourceforge.net/)

# .net - 使用 MultiFieldQueryParser 时，Lucene 中哪个字段有我的搜索文本？

> ID：899447
> 
> 赞同：2
> 
> 时间：2009-05-22T18:57:03.743
> 
> 标签：.net, full-text-search, lucene, lucene.net

我正在使用[Lucene.Net 的](http://incubator.apache.org/lucene.net/) [MultiFieldQueryParser](http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/queryParser/MultiFieldQueryParser.html)在我的文档中搜索多个字段。我想找出找到文本的字段。例如，我的搜索可能如下所示：

```
var parser = new MultiFieldQueryParser(new string[] {"question","answer"}, analyzer);
var query = parser.Parse(searchphrase);

for(int idx=0; idx<hits.Length() ++idx)
{
     var doc = hits.Doc(i);
     // was this hit found in "answer" or "question"??
} 
```

我想确定是否在*答案*或*问题*字段中找到了*搜索短语*

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T20:28:32.433

唯一的判断方法是存储字段，为每次点击检索它们，然后自己检查它们是否匹配。

在问题中找到的搜索短语的某些术语可能会导致命中，而其余的则在答案中。如果您一起搜索问题和答案，您将无法轻松确定哪个是哪个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T15:27:16.573

出于调试目的，您可以使用 Lucene 的[explain()](http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/Searcher.html#explain(org.apache.lucene.search.Query,%20int))方法，它会引导您完成匹配。它与搜索本身一样昂贵，因此对生产不太有利。另请参阅[Grant Ingersoll 的 Debugging Relevance Issues in Search 以](http://www.lucidimagination.com/Community/Hear-from-the-Experts/Articles/Debugging-Relevance-Issues-Search)了解获取此信息的其他方式。

# sql-server - 从 T-SQL 存储过程中获取应用程序可执行文件名

> ID：899460
> 
> 赞同：0
> 
> 时间：2009-05-22T18:59:43.143
> 
> 标签：sql-server, stored-procedures, executable

从 SQL Server 中的存储过程中，是否可以获取拥有该连接的可执行文件（即 MyApp.exe）的名称？我知道有 APP_NAME()，但这似乎只是返回传递给连接字符串中“应用程序名称”参数的任何字符串。

如果这是可能的，怎么做？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T19:09:48.460

除非您修改存储过程以传递应用程序名称，否则您会遇到 APP_NAME() 的结果。希望开发人员在其中放置有意义的值，而不是仅仅接受默认值，默认值通常表示用于构建应用程序的开发工具。

希望这可以帮助，

账单

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T19:06:17.500

不幸的是，我不知道有任何这样的事情——请记住，连接很可能来自完全不同的机器。

也许您可以设计安全性，以便不同的应用程序使用不同的用户名来访问数据库。查找当前用户很容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T21:35:23.277

您可以从连接字符串中获取计算机和信息，但基本上就是这样。

通过监控和其他措施，您可以确保开发人员始终在其连接字符串中使用应用程序名称。例如，您可以记录不是批准的应用程序名称的案例，或者使用分析器来监视事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T21:39:27.167

Oracle 可以为您提供 exe 的名称，但 SQL Server 不能 - 不同的体系结构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-10T19:01:15.207

我意识到这不是您正在寻找的。但是您可以使用 DBCC INPUTBUFFER 确定调用堆栈的一部分。如果您将这样的逻辑放在 storeprodedure 中并将其记录在某处，您可能会获得有关调用者的一些信息。

```
 CREATE TABLE #dbc
                (
                  EventType VARCHAR(15),
                  Parameters INT,
                  EventInfo VARCHAR(255)
                )
              DECLARE @execStr VARCHAR(500)
              SET @ExecStr = 'DBCC INPUTBUFFER(' + STR(@@SPID) + ')'

              INSERT    INTO #dbc
                        EXEC ( @execStr
                            )

              SELECT    *
              FROM      #dbc 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-16T16:21:09.127

您还可以获取客户端计算机上进程的 ID，因此，如果您有某种神奇的方法将其映射到进程名称，那么您就可以做到。

# iphone - 如何在 iPhone 上显示图像动画

> ID：899461
> 
> 赞同：0
> 
> 时间：2009-05-22T18:59:47.917
> 
> 标签：iphone, image

我有一个动画 gif （像[这个](http://www.indiavilas.com/kidscorner/telugu/a.gif)），当我在我的 iphone 应用程序的图像视图中显示时，它只显示第一帧。此行为与苹果文档一致。我想知道在 iphone 上实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T20:42:56.337

这是我在当前项目中获得的一些代码。我有一个循环将图像standy2 到standby7.png 放入一个数组中。我正在使用 imageWithContentsOfFile ，因为这在内存使用方面似乎要好一些。

```
standbyAnimationImages = [[NSMutableArray alloc] init];
for (NSUInteger i=2; i<=7; i++) {
    filename = [NSString stringWithFormat:@"standby%d", i];
    [standbyAnimationImages addObject:[UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:filename ofType:@"png"]]];
}

imageViewAnimation.animationImages = standbyAnimationImages;
imageViewAnimation.animationDuration = 2;
imageViewAnimation.animationRepeatCount = 0;
[imageViewAnimation startAnimating]; 
```

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T19:10:55.900

将其拆分为单独的 PNG 或 JPG 图像，然后将每个帧加载到 a 中`UIImageView`并使用其动画方法。查看`UIImageView`“动画图像”下的文档。这很简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T19:12:55.067

如果将所有帧导出为单个图像，则可以创建`UIImage`视图，请将`animationImages`属性设置为`NSArray`包含所有帧的`UIImages`. 然后调用`[imageView startAnimating]`。

凯尔

# internet-explorer - 是否有强制需要关闭进程的 InstallShield 模块？

> ID：899463
> 
> 赞同：0
> 
> 时间：2009-05-22T18:59:58.137
> 
> 标签：internet-explorer, installshield

具体来说，我希望能够检测到应用程序正在运行并禁止用户继续安装过程（通过禁用下一步按钮等）

似乎没有编写自定义脚本就无法做到这一点，但这似乎是一个基本的实用程序，我觉得我忽略了一些东西。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-24T23:23:03.193

请参阅[如何在基于 MSI 的卸载期间停止正在运行的进程？](https://stackoverflow.com/questions/251218/how-to-stop-a-running-process-during-an-msi-based-un-install)

您可以使用[pskill](http://technet.microsoft.com/en-us/sysinternals/bb896683.aspx)强制进程退出，或使用 windows 命令`TASKKILL /IM someprocess.exe`要求应用程序正常退出。

如果要检测和禁用按钮，则必须编写自定义脚本。Windows Installer 将自动检测您尝试更新的文件是否正在被应用程序使用并提示用户。更常见的解决方案是安装，然后使用配置命令安排重启，以便在您知道其他应用程序不会运行时在重启时运行。

# php - 是否有任何具有良好面向对象实践和设计模式的参考 PHP 应用程序？

> ID：899477
> 
> 赞同：2
> 
> 时间：2009-05-22T19:02:44.073
> 
> 标签：php

我想从社区中了解是否有任何好的应用程序可以用作实现 OOP 和 MVC 等设计模式的模型或参考应用程序？

编辑：我主要是在寻找像 magento 这样的参考应用程序，而不是像 Zend Framework 这样的框架。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T19:05:45.847

[Magento](http://magentocommerce.com)是其中之一

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T19:04:14.117

[CodeIgniter](http://codeigniter.com)是一个面向 PHP 的 OO 和 MVC 框架。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T19:07:51.910

只要看看任何框架，例如[Zend 框架](http://framework.zend.com/)。和他们一起乱扔垃圾。

前端控制器、MVC、工厂、单例加载！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T03:15:38.183

查看 WordPress。它支持插件来修改输出，以及许多其他方面的挂钩。这并不是说它是一个“参考”平台，但它有一些非常有趣的实现。

# perl - 如何在不重新访问链接的情况下递归访问链接？

> ID：899480
> 
> 赞同：0
> 
> 时间：2009-05-22T19:04:04.273
> 
> 标签：perl, recursion

我想检查一个站点的链接，然后递归地检查这些站点的链接。但我不想两次获取同一页面。我的逻辑有问题。这是 Perl 代码：

```
my %urls_to_check = ();
my %checked_urls = ();

&fetch_and_parse($starting_url);

use Data::Dumper; die Dumper(\%checked_urls, \%urls_to_check);

sub fetch_and_parse {
    my ($url) = @_;

    if ($checked_urls{$url} > 1) { return 0; }
    warn "Fetching 'me' links from $url";

    my $p = HTML::TreeBuilder->new;

    my $req = HTTP::Request->new(GET => $url);
    my $res = $ua->request($req, sub { $p->parse($_[0])});
    $p->eof();

    my $base = $res->base;

    my @tags = $p->look_down(
        "_tag", "a",
    );

    foreach my $e (@tags) {
        my $full = url($e->attr('href'), $base)->abs;
        $urls_to_check{$full} = 1 if (!defined($checked_urls{$full}));
    }

    foreach my $url (keys %urls_to_check) {
        delete $urls_to_check{$url};
        $checked_urls{$url}++;
        &fetch_and_parse($url);
    }
} 
```

但这似乎并没有真正做到我想要的。

帮助？！

**编辑**：我想从 中获取 URL `$starting_url`，然后从结果获取中获取任何和所有 URL。但是，如果其中一个 URL 链接回`$starting_url`，我不想再次获取它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T19:06:53.520

最简单的做法是不要重新发明轮子并使用[CPAN](http://search.cpan.org/dist/W3C-LinkChecker/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T10:36:08.220

我猜问题是

```
foreach my $url (keys %urls_to_check) {...} 
```

不会以您认为的方式重复发生。对于您恢复的每个 URL，您必须再次递归调用您的函数一次，这是非常低效的内存。

尽管您正在编写一个程序来“递归”抓取网页，但在您的代码中您需要使用迭代，而不是递归：

```
sub fetch_and_parse {
    my ($url) = @_;
    $urls_to_check{$url} = 1;
    while(%urls_to_check) {
        // Grab a URL and process it, putting any new URLs you find into urls_to_check
    }
  } 
```

当然，正如其他海报所指出的，还有其他工具可以为您自动执行此操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T13:37:57.357

如果您有要检查的链接队列并且想要跳过重复的链接，请使用哈希来记录您已经访问过的链接。跳过该哈希中的链接：

```
我的@need_to_check = ( ... ); # 但是你列出了那个列表
我的 %already_checked = ();

而（我的 $link = shift @need_to_check ）
    {
    接下来如果存在 $already_checked{$link};
    ...;
    $already_checked{$link}++;
    }

```

对于看起来略有不同但最终位于相同资源的 URL，情况会稍微复杂一些，例如[http://example.com](http://example.com)、[http://www.example.com](http://www.example.com)、[http://www.example.com/](http://www.example.com/)，等等。如果我关心这些，我会添加一个规范化步骤，为每个对象创建一个 URI 对象，然后将 URL 作为字符串再次拉出。如果这是一个更大的问题，我还会查看响应标头声称我获得的 URL（例如，通过重定向等）并标记我也看到了这些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T20:08:49.213

如果你想从一个页面中提取所有链接，我推荐使用 Gisle Aas 的 LinkExtor，一个快速的 CPAN 搜索就会显示出来。然后，您可以递归地遍历找到的链接，方法是将它们推送到列表中，然后将它们弹出，在遍历它们之前先检查您是否已经访问过它们，就像您所做的那样使用哈希。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T10:40:31.403

也许这可以帮助你：blog.0x53a.de/where-do-my-links-go/ 它从给定的网站开始进行广度优先搜索。此外，使用的模块 HTML::LinkExtractor 可能对您来说很有趣。

问候，曼努埃尔

# c++ - 从 const 成员函数返回的对象的 constness

> ID：899483
> 
> 赞同：1
> 
> 时间：2009-05-22T19:04:28.983
> 
> 标签：c++

关于 const 成员函数的返回值是否应该是 const 有什么好的经验法则？这是我倾向于做的事情，但我在模棱两可的场景中挣扎。

```
class foo
{
    public:
        // if the returned object is conceptually
        // (and therefore usually literally but not even necessarily) 
        // owned by *this*,
        // then a const ptr should be returned
        const ownedByFoo *getOwnedByFoo() const { return m_ownedByFoo; }
        ownedByFoo *getOwnedByFoo() { return m_ownedByFoo; }

        // what's a poor boy to do here?
        // veryRelatedToFoo might be a conceptual contemporary or parent
        // of Foo. Note naming the function "find..." instead of "get.."
        // since *get* implies the object holds it as a data member but
        // that may not even be the case here. There could be a
        // standalone container that associates foo and veryRelatedToFoo.
        // Should constness be symmetrical here?
        const veryRelatedToFoo *findVeryRelatedToFoo() const;
        veryRelatedToFoo *findVeryRelatedToFoo();

        // If the returned object is only (conceptually)
        // peripherally related to *this*, 
        // the returned object probably shoudn't be const, even if
        // foo happens to have one of these as a direct data member,
        // since we don't want to give away the implementation details of
        // Foo and it may hold peripherallyRelatedToFoo simply for performance
        // reasons, etc.
        peripherallyRelatedToFoo *findPeripherallyRelatedToFoo() const

    ...
}; 
```

还有一点需要注意的是，一旦你有了非对称的 constness，你可以让 const object A 返回 object B，然后让 object B 返回 object A，然后你就成功地绕过了 object A 的预期 constness。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T19:20:50.027

拥有任何 constness 都比您在许多语言中所能找到的要多！

一旦您了解（如您所见）“物理上的 const”和“逻辑上的 const”之间的区别，那么“模棱两可”的场景仍然是：有待辩论。例如，甚至考虑`mutable`关键字存在的事实。

我认为您的总体思路是正确的：除此之外，这一切都是有争议的和主观的，并且会根据特定问题和限制等而有所不同。

我倾向于“规则没有例外”，所以我会避免从 const 方法返回指向非 const 的指针；但我想我可以想象一些我可能会受到诱惑的场景......尽管我可能更有可能决定使该方法成为非常量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T19:29:49.323

（我忽略了您像这样直接返回对象状态的事实，这通常是一个坏主意，因为它破坏了封装——我将其视为“示例代码”）

两者之间没有任何关系。`const`成员函数是不修改底层对象的成员——“在它执行时” 。没有承诺或要求返回值是`const`与否。一旦方法返回，`const`-ness 合同就“结束”了。我认为您会感到困惑，因为您试图将返回值与产生它的方法联系起来。

返回值是否应该`const`完全`const`取决于返回值的性质，以及您希望赋予该方法的语义。

在您的特定第一种情况下，这两种方法应该返回相同的`const`-ness。const 重载可能不是您想要使用的。如果您想要这两种变体，我可能会明确表示，如下所示：

```
const ownedByFoo *getOwnedByFoo() const { return m_ownedByFoo; }
ownedByFoo *getOwnedByFooForEdit() { return m_ownedByFoo; } 
```

这样，两者就没有歧义，也没有神秘的联系。请注意，我创建了第二个非常量，因为我们可能不希望客户端代码修改 const 对象上的 m_ownedByFoo。这是源于方法语义（“返回内部状态”）的要求，而不是源于方法的`const`-ness 和`const`返回值的 -ness 之间的联系。如果返回的值不是对象状态的一部分，我可能会做其他事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T21:05:06.153

如果返回的引用是 const，则将函数设为 const，如果不是，则不要。您应该尽量避免返回对成员数据的非常量引用，因为这会破坏封装，除非该类主要是某种容器类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T21:09:34.583

如果返回非常量引用/指针将允许调用者使类应该维护的不变量无效，则不要返回该非常量引用/指针。（它应该是常量。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T19:49:31.407

不要从 const 方法返回非常量指针或对成员数据的引用。

# oracle - 查询长原始数据类型

> ID：899487
> 
> 赞同：1
> 
> 时间：2009-05-22T19:05:23.430
> 
> 标签：oracle

我有一个 oracle 表，其中一列是 long raw 类型。我知道我们不能使用 sql 从该列中获取数据。

谁能告诉我如何从该列中获取所有数据？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T20:27:49.270

你试过 PL/SQL 吗？

```
declare
  a mytable.rawcol%TYPE;
begin
  select rawcol into a from mytable;
  -- now do something with "a"
end;
/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T22:19:15.487

您始终可以使用 SQL 来获取数据。事实上，这是将数据输入或输出数据库的唯一方法。问题是数据以什么格式出现以及你用它做什么。一些 SQL 客户端可能无法很好地处理二进制数据。有些人会将其显示为十六进制流（这可能不是很有意义）。

您可以使用 PL/SQL 和 UTL_FILE 将二进制数据写入服务器上的文件。或者查看 UTL_RAW 包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T20:52:55.013

您可以使用 perl DBD::Oracle 来查询该表并写入数据。您可以将任何您喜欢的程序语言与可以提取数据并将其写入文件的 oracle 客户端/api 一起使用。您还可以使用 oracle exp/imp 等 oracle 工具将数据从 db 移动到 db。由于您尚未指定要对长期原始数据执行的操作，因此很难进一步帮助您。

# .net-4.0 - 工作流 4.0 参数错误

> ID：899491
> 
> 赞同：0
> 
> 时间：2009-05-22T19:06:14.503
> 
> 标签：.net-4.0, workflow-foundation, workflow-foundation-4

我的工作流程有两个错误，一个我认为是由与 VS2010 编译时的错误引起的，它的

错误 1 ​​无法解析可附加成员 {clr-namespace:;}Flowchart1.requestType C:\Documents and Settings\Hilliard\my documents\visual studio 10\Projects\WorkflowConsoleApplication1\WorkflowConsoleApplication1\Flowchart1.xaml WorkflowConsoleApplication1

该错误通常在连续两次构建后消失。我不知道它是否相关，但一旦工作流在新的 Partial Class 中运行，就会引发另一个错误

“无法设置未知成员‘requestType’。行：3 偏移量：4”。

如果我在这里做错了什么，有人知道吗？我只想将两个参数传递到我的工作流程中并在整个工作流程中使用它们。现在，工作流程甚至不会加载，因为它们在工作流程中受到挑战。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T22:11:31.767

从您的描述中很难分辨出这些信息，我认为您确实需要添加更多详细信息：-您如何声明 requestType？-您如何将参数传递给您的工作流程？- 你从哪个 XAML 中得到编译错误？

您也可以尝试在 WF 4.0 Beta1 的 MS 论坛上提问... [http://social.msdn.microsoft.com/Forums/en-US/wfprerelease/threads](http://social.msdn.microsoft.com/Forums/en-US/wfprerelease/threads)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-17T14:45:15.057

通过您在错误消息中的“{clr-namespace:;}”，我怀疑您正在引用当前程序集中的某个类（例如自定义活动或编译程序集中的类型）。

如果是这种情况，那么只需继续拆分您的程序集，并将您的自定义活动和/或类型（由您的工作流实例引用）移动到新的。

# html - Html 文本编辑器

> ID：899495
> 
> 赞同：0
> 
> 时间：2009-05-22T19:06:40.760
> 
> 标签：html, css, text-editor

我需要 html/css 文本编辑器，即：

1.  自由的
2.  快速（没有 java 或类似的）
3.  没有所见即所得
4.  可以自动完成属性和样式
5.  我写 <script type=""，自动完成应该显示带有文本/javascript 的列表

我喜欢 Notepad++，但找不到智能自动完成功能，就像在 Visual Studio 中一样。

Windows 或 Linux，请不要使用 Mac

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T19:10:40.890

Visual Web Developer 是免费的，并且具有 Visual Studio 的所有功能。它不像记事本++那么轻巧，但其中一些是由于您提到的那些功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T19:16:05.217

[vim](http://www.vim.org)及其所有脚本轻松满足您的需求...

我建议你看看[维基百科](http://en.wikipedia.org/wiki/Comparison_of_HTML_editors)的 HTML 编辑器比较页面，那里有一堆 html 编辑器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T19:50:49.250

尝试[科莫多编辑](http://www.activestate.com/komodo_edit/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T20:05:14.383

Eclipse 还是 Aptana？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T19:10:50.580

Apple 的 Dashcode 符合要求。

虽然它的目标是仪表板开发人员，但它具有您寻求的所有 HTML/CSS/JS 自动完成功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T19:44:21.727

好吧，Dreamweaver 非常符合要求，而且我一直对它的自动完成支持感到满意（您不需要使用所见即所得的编辑器，而我从不这样做）。免费选项较少，但我对 geany 在我自己的编码中的表现感到满意。您还应该研究 vim 和 emacs，因为它们都有大量针对您需要的附加组件。我曾经在 Windows 上使用 notepad++，但我也很好奇你为什么希望远离它，因为它在我使用它的所有时间里都表现良好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-12T16:58:28.277

如果您正在寻找在 Windows 上开箱即用的类似 Textmate 的代码完成，请尝试[Intype](http://intype.info/home/index.php)。它很轻，片段效果很好。

如果您不介意花一些时间学习一种新方法并进行一些调整以使事情按您想要的方式工作，那么[Vim](http://www.vim.org/)是最好的选择。

# sql - 我可以使用 SQL 在下面给出的示例表中查找缺失的数字吗？

> ID：899502
> 
> 赞同：4
> 
> 时间：2009-05-22T19:07:28.697
> 
> 标签：sql, sql-server, database, algorithm

假设我有一个包含三列的下表：

```
id | start_block | end_block
-----------------------------
01 | 00000000001 | 00000000005
02 | 00000000006 | 00000000011
03 | 00000000012 | 00000000018
04 | 00000000025 | 00000000031
05 | 00000000032 | 00000000043 
```

每行是一个“起始块”和一个“结束块”。如果数据是完美的，每个起始块将比它之前的结束块多一个。因此，对于第 id == 02 行，起始块为 6，而前行的结束块为 5。

我需要查询这些数据（它有数万行）并找到任何缺失的行。根据我的样本数据，在 03 和 04 之间应该有一行，其起始块为 19，结束块为 24。

我正在尝试在 JSP 中构建一个报告来协调这些数据并找到丢失的行。这样做的丑陋方法是将整个记录集拉入一个数组并在每一行上执行类似的操作：

```
if ((arry(i,1) + 1) != (arry(i+1),1)( {
  print("Bad Row!\n");
} 
```

但是，我真的很希望能够直接查询记录集并返回我需要的内容。那可能吗？如果没有，有人可以指出我创建一个满足我需要的存储过程的正确方向吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T19:14:46.873

试一试肯定不会有什么坏处

```
CREATE TABLE #t (startz INT, zend INT)
insert into #t (startz, zend) values (1,5)
insert into #t (startz, zend) values (6,11)
insert into #t (startz, zend) values (12,18)
insert into #t (startz, zend) values (25,31)
insert into #t (startz, zend) values (32,43)

select * from #t ta
LEFT OUTER JOIN #t tb ON tb.startz - 1 = ta.zend
WHERE tb.startz IS NULL 
```

最后一个结果是误报。但容易消除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T19:29:43.550

你可以试试：

```
SELECT t.ID, t.Start_Block, t.End_Block
FROM [TableName] t
JOIN [TableName] t2 ON t.ID = t2.ID+1
WHERE t.Start_Block - t2.End_Block > 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T19:32:04.343

这会做到的。您可能还想寻找重叠的块。

```
SELECT
     T1.end_block + 1 AS start_block,
     T2.start_block - 1 AS end_block
FROM
     dbo.My_Table T1
INNER JOIN dbo.My_Table T2 ON
     T2.start_block > T1.end_block
LEFT OUTER JOIN dbo.My_Table T3 ON
     T3.start_block > T1.end_block AND
     T3.start_block < T2.start_block
WHERE
     T3.id IS NULL AND
     T2.start_block <> T1.end_block + 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T19:14:32.083

```
 Select * From Table O
   Where 
      (Exists
         (Select * From Table
          Where End_Block < O.Start_Block)
       And Not Exists 
         (Select * From Table
          Where End_Block = O.Start_Block - 1)) 
    Or
      (Exists
         (Select * From Table
          Where Start_Block > O.End_Block)
       And Not Exists 
         (Select * From Table
          Where Start_Block = O.End_Block + 1 )) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T19:23:01.567

```
select e1.end_block + 1 as start_hole,
    (select min(start_block) 
     from extent e3 
     where e3.start_block > e1.end_block) - 1 as end_hole
from extent e1 
left join extent e2 on e2.start_block = e1.end_block + 1
where e2.start_block is null 
and e1.end_block <> (select max(end_block) from extent); 
```

尽管我会说这是在 TSQL 中迭代结果的合理候选者：无论如何，您将不得不扫描整个表（或至少扫描`start_block`and上的全部索引`end_block`），因此只循环一次并使用变量记住最后一个值是目标。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T19:44:18.017

这是一个实际告诉您丢失行的 SQL！

它是否非常快，所以忽略了性能问题：

基于：

```
CREATE TABLE #t (startz INT, zend INT)
insert into #t (startz, zend) values (1,5)
insert into #t (startz, zend) values (6,11)
insert into #t (startz, zend) values (12,18)
insert into #t (startz, zend) values (25,31)
insert into #t (startz, zend) values (32,43)
insert into #t (startz, zend) values (45,58)
insert into #t (startz, zend) values (60,64)
insert into #t (startz, zend) values (70,98)

select tab1.zend+1 as MissingStartValue,
       (select min(startz-1) from #t where startz > tab1.zend+1) as MissingEndValue
 from #t as tab1 where not exists (select 1 from #t as tab2 where tab1.zend + 1 = tab2.startz)
and (select min(startz-1) from #t where startz > tab1.zend+1) is not null 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T20:43:14.463

```
select * from blocks a
where not exists (select * from blocks b where b.start_block = a.end_block + 1) 
```

会给你一个间隙之前的块。你可以变得花哨。让我们来看看...

```
select a.end_block, min(b.start_block)
from blocks a,
     blocks b
where not exists (select * from blocks c where c.start_block = a.end_block + 1)
and b.start_block > a.end_block
group by a.end_block 
```

我认为应该这样做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T20:45:20.000

```
SELECT t1.End_Block + 1 as Start_Block,
       t2.Start_Block - 1 as End_Block,
  FROM Table as t1, Table as t2
 WHERE t1.ID + 1 = t2.ID
   AND t1.End_Block + 1 <> T2.Start_Block 
```

这假设表中的 ID 是连续的。如果它们不是连续的，那么您必须使用 Start_Block 到 End_Block 进行一些复杂的链接，以链接彼此相邻的两个块。

# perl - 如何将 IO::Scalar 与 Image::Magick::Read() 一起使用？

> ID：899505
> 
> 赞同：3
> 
> 时间：2009-05-22T19:08:34.687
> 
> 标签：perl, imagemagick

我有一张我用[GD::Image](http://search.cpan.org/dist/GD)操作过的图像，我想用[Image::Magick](http://search.cpan.org/dist/PerlMagick)做进一步的操作。我想避免将图像写入磁盘，以便 Image::Magick 可以将其读入。Image::Magick 的 Read 函数将接受文件句柄作为参数，因此我试图将其传递给 IO::Scalar我使用 GD::Image 的输出创建的对象。

但是，由于 IO::Scalar 对象可以被视为字符串，看起来 Image::Magick 正在将图像的内容解释为它无法找到的文件名，并且 Read() 失败。

是否有另一种方法可以从行为更像常规文件句柄的标量创建文件句柄，或者是否有另一种更简单的方法来完成我在这里尝试做的事情？

```
my $FH = new IO::Scalar \$image_bin;
my $magick = Image::Magick->new;
my $response = $magick->Read(file => $FH); 
```

$响应是：

```
"Exception 435: unable to open image `????': No such file or directory" 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T19:52:23.583

我认为您正在寻找[BlobToImage](http://www.imagemagick.org/script/perl-magick.php#blobs)：

```
#!/usr/bin/perl

use strict;
use warnings;

use File::Slurp;
use Image::Magick;

my $image_bin = read_file 'test.jpg', binmode => ':raw';

my $magick = Image::Magick->new;

$magick->BlobToImage( $image_bin );

$magick->Resize( geometry => '64x64' );

$magick->Write( 'test-out.jpg' );

__END__ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T19:51:12.480

[从文档...](http://www.imagemagick.org/script/perl-magick.php)

> 要从 Perl 文件句柄中读取 GIF 格式的图像，请使用：
> 
> ```
> $image = Image::Magick->new;
> open(IMAGE, 'image.gif');
> $image->Read(file=>\*IMAGE);
> close(IMAGE); 
> ```

所以...我认为在您的示例中引用您的文件句柄（`\$FH`），而不仅仅是文件句柄，应该可以解决问题吗？

编辑：为了回应 brian d foy，这是我建议尝试的：

```
my $image = Image::Magick->new;
open my $fh, 'image.gif';
binmode $fh;
$image->Read( file => \$fh );
close $fh; 
```

至少在我的系统上，这个段错误。

我会让这篇文章作为不起作用的例子。:P

# oracle - oracle中选择查询的默认行排序

> ID：899514
> 
> 赞同：52
> 
> 时间：2009-05-22T19:11:11.013
> 
> 标签：oracle, sql-order-by

在 Oracle 中，如果未指定“order by”子句，则选择查询的默认行顺序是什么。

是吗

1.  插入行的顺序
2.  根本没有默认排序
3.  以上都不是。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-22T21:39:37.813

根据 Tom Kyte 的说法：“除非并且直到您在查询中添加“order by”，否则您不能对返回的行的顺序说任何话。好吧，除了“您不能依赖返回的行的顺序”之外。

请在 asktom.com 上查看[此问题。](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:3083286970877)

至于ROWNUM，它在物理上并不存在，所以不能“释放”。ROWNUM 是在从表中检索到记录后分配的，这就是为什么“WHERE ROWNUM = 5”总是无法选择任何记录的原因。

@ammoQ：您可能想阅读[这篇](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:74320098178823)关于 GROUP BY 订购的 AskTom 文章。简而言之：

> > Query 中的 Group By 子句是否保证输出数据将按 Group By 列排序，即使没有 Order By 子句？
> 
> 我们说...
> 
> 绝对不，
> 
> 它从来没有，它从来没有，它永远不会。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-22T19:36:11.167

没有明确的默认排序。出于显而易见的原因，如果您创建一个新表，插入几行并执行没有“where”子句的“select *”，它将（很可能）按照插入的顺序返回行。

但是你永远不应该依赖默认订单的发生。如果您需要特定的订单，请使用“order by”子句。例如，在最高 9i 的 Oracle 版本中，执行“分组依据”也会导致行按组表达式 (*) 排序。在 10g 中，这种行为不再存在！因此，升级 Oracle 安装给我带来了一些工作。

(*) 免责声明：虽然这是我观察到的行为，但从未得到保证

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-23T09:32:52.140

已经说过，当您没有指定 ORDER BY 子句时，Oracle 可以按照它想要的任何顺序为您提供行。当您不指定 ORDER BY 子句时，推测订单将是什么是没有意义的。在你的代码中依赖它，是一个“职业限制举措”。

一个简单的例子：

```
SQL> create table t as select level id from dual connect by level <= 10
  2  /

Tabel is aangemaakt.

SQL> select id from t
  2  /

        ID
----------
         1
         2
         3
         4
         5
         6
         7
         8
         9
        10

10 rijen zijn geselecteerd.

SQL> delete t where id = 6
  2  /

1 rij is verwijderd.

SQL> insert into t values (6)
  2  /

1 rij is aangemaakt.

SQL> select id from t
  2  /

        ID
----------
         1
         2
         3
         4
         5
         7
         8
         9
        10
         6

10 rijen zijn geselecteerd. 
```

这只是在简单的删除+插入之后。还有许多其他可以想象的情况。并行执行、分区、索引组织表等等。

底线，正如 ammoQ 所说的那样：如果您需要对行进行排序，请使用 ORDER BY 子句。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-26T18:50:43.010

除非您指定，否则您绝对不能依赖任何排序`order by`。特别是对于 Oracle，我实际上已经看到完全相同的查询（没有连接），在几秒钟内彼此运行两次，在一个临时没有更改的表上，返回一个完全不同的顺序。当结果集很大时，这似乎更有可能。

Rob van Wijk 提到的并行执行可能解释了这一点。另请参阅 Oracle 的[Using Parallel Execution](https://docs.oracle.com/cd/B19306_01/server.102/b14223/usingpe.htm)文档。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2016-11-05T19:26:11.620

它受索引的影响，如果有索引，它会返回一个升序，如果没有任何索引，它会返回插入的顺序。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2017-11-29T16:45:31.910

您可以使用 CREATE TABLE 语句的 ORGANIZATION 子句通过 INSERT 修改数据存储到表中的顺序

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-05-22T19:36:15.067

虽然，它应该是 rownnum （你的 #2），但它真的不能保证，你不应该 100% 相信它。

* * *

## 回答 #8

> 赞同：-7
> 
> 时间：2009-05-22T19:15:11.333

我相信它使用了 Oracle 的隐藏 Rownum 属性。

所以你的#1 可能是正确的，假设没有删除可能已经释放 rownums 供以后使用。

**编辑：**正如其他人所说，你真的不应该依赖这个，永远。除了删除之外，还有许多不同的条件会影响默认排序行为。

# c++ - 在 C++ 中设置本地环境变量

> ID：899517
> 
> 赞同：51
> 
> 时间：2009-05-22T19:12:14.150
> 
> 标签：c++, c, manpage

如何在 C++ 中设置环境变量？

*   他们不需要坚持过去的程序执行
*   它们只需要在当前进程中可见
*   偏好平台独立但我的问题只需要在 Win32/64 上工作

谢谢

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-05-22T19:14:18.777

```
姓名

       putenv - 更改或添加环境变量

概要

       #include <stdlib.h>

       int putenv(char *string);

描述
       putenv() 函数添加或更改环境的值
       变量。参数字符串的格式为 name=value。如果名字有
       环境中尚不存在，则将字符串添加到
       环境。如果 name 确实存在，则 name 中的值
       环境改变为价值。string 指向的字符串变为
       环境的一部分，所以改变字符串会改变环境。

```

我相信在 Win32 上它被称为 _putenv。

如果您喜欢长而丑陋的函数名称，请参阅[SetEnvironmentVariable 。](http://msdn.microsoft.com/en-us/library/ms686206.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2020-05-14T19:46:21.480

还有`setenv`，它比 稍微灵活一点`putenv`，它`setenv`检查环境变量是否已经设置并且不会覆盖它，如果你设置“overwrite”参数表示你不想覆盖它，并且还有因为名称和值是单独的参数`setenv`：

```
NAME
        setenv - change or add an environment variable
SYNOPSIS
       #include <stdlib.h>

       int setenv(const char *name, const char *value, int overwrite);

       int unsetenv(const char *name);

   Feature Test Macro Requirements for glibc (see feature_test_macros(7)):

       setenv(), unsetenv():
           _POSIX_C_SOURCE >= 200112L
               || /* Glibc versions <= 2.19: */ _BSD_SOURCE
DESCRIPTION
       The setenv() function adds the variable name to the environment with
       the value value, if name does not already exist.  If name does exist
       in the environment, then its value is changed to value if overwrite
       is nonzero; if overwrite is zero, then the value of name is not
       changed (and setenv() returns a success status).  This function makes
       copies of the strings pointed to by name and value (by contrast with
       putenv(3)).

       The unsetenv() function deletes the variable name from the
       environment.  If name does not exist in the environment, then the
       function succeeds, and the environment is unchanged. 
```

我并不是说哪个更好或更差。这仅取决于您的应用程序。

见[http://man7.org/linux/man-pages/man3/setenv.3.html](http://man7.org/linux/man-pages/man3/setenv.3.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T19:53:00.807

我不肯定环境变量是您需要的，因为它们不会在程序运行之外使用。无需使用操作系统。

您最好拥有一个包含所有这些值的单例类或命名空间，并在启动程序时初始化它们。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-04-27T11:25:57.510

```
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <string.h>

int main(int argc, char* argv[])
{

    char *var, *value;
    if (argc == 1 || argc > 3) {
        fprintf(stderr, "usage:environ variables \n");
        exit(0);
    }
    var = argv[1];
    value = getenv(var);
    //---------------------------------------
    if (value) {
        printf("variable %s has value %s \n", var, value);
    }
    else
        printf("variable %s has no value \n", var);
    //----------------------------------------
    if (argc == 3) {
        char* string;
        value = argv[2];
        string = malloc(strlen(var) + strlen(value) + 2);
        if (!string) {
            fprintf(stderr, "out of memory \n");
            exit(1);
        }
        strcpy(string, var);
        strcat(string, "=");
        strcat(string, value);
        printf("calling putenv with: %s \n", string);
        if (putenv(string) != 0) {
            fprintf(stderr, "putenv failed\n");
            free(string);
            exit(1);
        }
        value = getenv(var);
        if (value)
            printf("New value of %s is %s \n", var, value);
        else
            printf("New value of %s is null??\n", var);
    }
    exit(0);

} //----main 
```

```
# commands to execure on linux   
# compile:
$ gcc -o myfile myfile.c

# run:
$./myfile xyz
$./myfile abc
$./myfile pqr 
```

# c# - 如何以随机间隔运行脚本

> ID：899528
> 
> 赞同：0
> 
> 时间：2009-05-22T19:15:05.360
> 
> 标签：c#, .net, batch-file, scripting, random

我想在 c# 中编写一个批处理作业，它以随机（ish）间隔运行任务，例如每小时 +/- 20 分钟，如果不需要更新，则最后一次等待 x2，然后再次运行。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T19:29:40.820

其他人的答案都很好，但我在这里唯一可以贡献的是你不应该做的事情。不要**使**应用程序成为 Windows 服务。我已经多次看到它作为类似问题的答案。这不是 Windows 服务的用途。

在我的书中，windows服务是挂在后台以方便其他程序的应用程序/程序，或者不需要用户输入来操作。它不能用作按时间间隔启动程序的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T19:20:11.043

考虑创建一个简单的应用程序，并使用 Windows 任务计划程序启动它。调度程序可以让您对运行的时间和内容进行大量控制，它包括时间随机化。

编辑：错过了“2x”部分。过去，我构建了 Windows 服务来执行此操作：

```
sleep(1x +/- random(20 minutes))
if nothing to do, sleep(2x +/- random(20 minutes)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T19:28:32.073

可以创建一个每隔一段时间弹出并运行一个方法的计时器。

例子：

```
Timer ProcessTimer = new Timer(new TimerCallback(ProcessRandomTask), null, 0,Timeout.Infinite);

private void ProcessRandomTask(object data)
{
 //Do work

  lock(ProcessTime)
  {
       //change timer
       ProcessTimer.Change(GetNewTime(), Timeout.Infinite);
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T19:30:29.417

如何将上次“不必要”运行的时间戳记录到数据库/某个永久位置？然后，您的第一行可以说：

```
LastRunWithoutUpdating = GetLastRunWithoutUpdating() // load from file, or db...
if (LastRunWithoutUpdating - CurrentTime < DelayInterval) {
    SkipThisRun(); // sys.exit() or something
} 
```

# c++ - C++ 库：问题需要明确的答案（意见）

> ID：899531
> 
> 赞同：2
> 
> 时间：2009-05-22T19:15:40.320
> 
> 标签：c++, user-interface, sockets

我对 C++ 编程相当陌生，所以我不太确定我目前在寻找什么。我有 C#、Python（几乎没有）和 Visual Basic 的经验，但我正在考虑使用 C++ 并从总体上脱离 .NET（在它完全吸引我之前）。我的问题如下：

1) 什么是最轻量级、独立于平台的 GUI 库？Qt 对我来说似乎有点臃肿（OpenGL 等）。如果我错了，请告诉我。

2) 可用的最轻量、平台无关的套接字库是什么？（请不要调出winsock2.h）

先感谢您。我将继续使用谷歌，但正如我所说，我不太确定我在寻找什么，因此感谢任何和所有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T19:52:39.683

作为一个 GUI 库，我会使用 wxWidgets 或 Qt（因为文档非常好，而且 GUI 部分可以独立于您不想要的部分使用）。

对于 Sockets，看看[Boost Asio](http://www.boost.org/doc/libs/1_39_0/doc/html/boost_asio.html)，在我看来它是最好的 C++ 套接字库，但是文档很难理解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T19:42:30.717

Qt 并没有那么臃肿（尽管它的库体积很大——从这个意义上说它不是轻量级的），它使用起来非常舒适，并且几乎包含你可能需要的所有东西（或者可能不是，可能是第一次，比如openGL），虽然以它自己的方式（QSocket 用于套接字，QString 用于字符串，所以请注意不要也被它吸进去:)）。另一个优点（或缺点）是它没有模仿一些流行的非严格 OO 库，如 MFC（wxWidgets 就是这样），但展示了一个（可能是最好的）*非常好的*大规模 C++ OOD示例（所以这可能会有所帮助，来源也是免费的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T19:25:26.040

如果您关心跨平台开发，您应该真正检查一下[wxWidgets](http://www.wxwidgets.org/)，因为它不仅提供了 GUI 小部件集，还提供了其他独立于平台的解决方案。（而且它是开源的，并且附有很好的商业友好许可证）。

此外，它是模块化的，你基本上可以只包含你需要的东西——所以从这个意义上说，它是轻量级的，或者至少它可以是轻量级的。

我已经在几个项目（商业）中使用它并取得了巨大的成功，一旦你掌握了 API，它就会非常强大。

GTK+ 和 QT 等其他替代方案都很好，但在我看来，它们缺乏对底层管道的支持。

# c# - C# 中有没有办法用扩展方法覆盖类方法？

> ID：899539
> 
> 赞同：107
> 
> 时间：2009-05-22T19:17:18.227
> 
> 标签：c#, extension-methods, overriding

在某些情况下，我想用扩展方法覆盖类中的方法。有没有办法在 C# 中做到这一点？

例如：

```
public static class StringExtension
{
    public static int GetHashCode(this string inStr)
    {
        return MyHash(inStr);
    }
} 
```

我想要这样做的一种情况是能够将字符串的哈希存储到数据库中，并且所有使用字符串类哈希的类（即字典等）都使用相同的值。内置的 .NET 散列算法不保证从一个版本的框架兼容到下一个版本，我想用我自己的替换它。

在其他情况下，我还想用扩展方法覆盖类方法，因此它不仅仅特定于字符串类或`GetHashCode`方法。

我知道我可以通过对现有类进行子类化来做到这一点，但在很多情况下能够通过扩展来做到这一点会很方便。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-05-22T19:20:20.293

不; 扩展方法永远不会优先于具有合适签名的实例方法，并且永远不会参与多态性（`GetHashCode`是一种`virtual`方法）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-22T19:20:46.347

如果该方法具有不同的签名，则可以完成-在您的情况下：否。

但否则你需要使用继承来做你正在寻找的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T10:45:07.487

据我所知，答案是否定的，因为扩展方法不是实例。对我来说，它更像是一种智能感知工具，可以让您使用类的实例调用静态方法。我认为您的问题的解决方案可以是一个拦截器，它拦截特定方法的执行（例如 GetHashCode()）并执行其他操作。要使用这样的拦截器（如 Castle Project 提供的那个），所有对象都应该使用对象工厂（或 Castle 中的 IoC 容器），以便可以通过运行时生成的动态代理拦截它们的接口。（Caslte 还允许您拦截类的虚拟成员）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-23T04:52:45.833

我找到了一种方法来调用与类方法具有相同签名的扩展方法，但是它似乎不是很优雅。在使用扩展方法时，我注意到一些未记录的行为。示例代码：

```
public static class TestableExtensions
{
    public static string GetDesc(this ITestable ele)
    {
        return "Extension GetDesc";
    }

    public static void ValDesc(this ITestable ele, string choice)
    {
        if (choice == "ext def")
        {
            Console.WriteLine($"Base.Ext.Ext.GetDesc: {ele.GetDesc()}");
        }
        else if (choice == "ext base" && ele is BaseTest b)
        {
            Console.WriteLine($"Base.Ext.Base.GetDesc: {b.BaseFunc()}");
        }
    }

    public static string ExtFunc(this ITestable ele)
    {
        return ele.GetDesc();
    }

    public static void ExtAction(this ITestable ele, string choice)
    {
        ele.ValDesc(choice);
    }
}

public interface ITestable
{

}

public class BaseTest : ITestable
{
    public string GetDesc()
    {
        return "Base GetDesc";
    }

    public void ValDesc(string choice)
    {
        if (choice == "")
        {
            Console.WriteLine($"Base.GetDesc: {GetDesc()}");
        }
        else if (choice == "ext")
        {
            Console.WriteLine($"Base.Ext.GetDesc: {this.ExtFunc()}");
        }
        else
        {
            this.ExtAction(choice);
        }
    }

    public string BaseFunc()
    {
        return GetDesc();
    }
} 
```

我注意到的是，如果我从扩展方法内部调用第二个方法，它会调用与签名匹配的扩展方法，即使有一个类方法也与签名匹配。例如，在上面的代码中，当我调用 ExtFunc()，而后者又调用 ele.GetDesc()，我得到返回字符串“Extension GetDesc”而不是我们期望的字符串“Base GetDesc”。

测试代码：

```
var bt = new BaseTest();
bt.ValDesc("");
//Output is Base.GetDesc: Base GetDesc
bt.ValDesc("ext");
//Output is Base.Ext.GetDesc: Extension GetDesc
bt.ValDesc("ext def");
//Output is Base.Ext.Ext.GetDesc: Extension GetDesc
bt.ValDesc("ext base");
//Output is Base.Ext.Base.GetDesc: Base GetDesc 
```

这使您可以随意在类方法和扩展方法之间来回切换，但需要添加重复的“传递”方法才能使您进入所需的“范围”。我在这里称它为范围，因为没有更好的词。希望有人可以让我知道它实际上叫什么。

您可能已经通过我的“传递”方法名称猜到了，我也玩弄了将委托传递给它们的想法，希望一个或两个方法可以作为具有相同签名的多个方法的传递。不幸的是，它并没有像一旦解包委托那样总是选择类方法而不是扩展方法，即使是从另一个扩展方法内部也是如此。“范围”不再重要。不过，我并没有非常多地使用 Action 和 Func 代表，所以也许更有经验的人可以弄清楚这部分。

# c# - 在 Java 和 Windows 之间使用的软件架构风格的建议

> ID：899540
> 
> 赞同：2
> 
> 时间：2009-05-22T19:17:29.160
> 
> 标签：c#, java, web-services, architecture

这是一个有趣的组合，我需要在运行 Windows XP Home 的“设备”和 Internet 上的远程 Linux 服务器之间传输数据。让我逐项列出需要发生的事情：

1.  “xp home”系统需要每 30 分钟左右传输一次数据或文件。（sftp？）
2.  Linux服务器需要联系“XP Home”系统请求数据。

看起来很简单吧？我正在考虑在 Linux 端使用 Web 服务，并认为在 XP Home 系统上做同样的事情会很好。但是我的一些研究表明，这在 XP Home 上无法用于接听传入的 Web 服务呼叫。也许那是错的？那么 RESTful 服务能起到什么作用呢？

顺便说一句：由于这是一个新应用程序，我可以在两端进行开发。Windows 端的 C# 和 Linux 端的 Java。

想法表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T20:13:20.017

由于应用程序是新的，如果您需要强大的实时数据共享，我可以建议您使用共享数据库。您可以安装在其中一台主机上。

任何方式的 Web 服务解决方案都太复杂了。在两台机器上使用相同的技术，您将能够使用您选择的语言的特定语言功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T19:19:36.350

为什么不在 Windows 端也使用 Java？Tomcat 应该在任何 XP 上运行......这也将解决您的其他问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T19:25:04.187

XP Home 不包含 IIS，但您可以安装不同的 Web 服务器并在 Windows 端使用它。另一种选择是在两端进行一些简单的套接字编程，以方便从 Linux 机器到 XP 机器的请求。这种方法不能很好地扩展，但如果你想快速组合一些东西，它会起作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T23:07:37.370

如果你真的不需要实时。

一个低技术的解决方案可能是让 Windows 设备定期轮询 Linux 机器。它可以发送数据并询问 Linux 机器是否需要任何东西。

这将消除在 Windows 端打开传入端口的需要（这可能是不可取的或不可能的）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T01:35:19.367

在 Windows 服务器上安装 Cygwin，安装 SSH 服务器并确保已安装 rsync。在 linux 端通过 cron 作业调用 rsync。无需编程/设计。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T19:21:26.500

好的，所以整个协议是

1.  Linux系统联系Windows系统请求数据
2.  Windows 系统回复数据。

有多少数据，什么类型？

乍一看，您似乎只是在 Windows 机器上运行了一个 Web 服务器并用数据进行响应。我还没有构建一个，但是有很多支持 Windows 的 Web 服务器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T20:42:04.403

另一种解决方案是使用基于消息的东西，例如 JMS 或 XMPP。由于它是通过 Internet 的，因此 XMPP 可能更适合。

XMPP 聊天消息可用于握手，它具有文件共享扩展来进行二进制传输。

此外，您可以使用您选择的语言来实现任一端，因为所有流行语言都有可用的库。

编辑：据推测，[Tivo](http://www.slideshare.net/AdamFortuna/how-xmpp-could-change-the-wold)现在使用它从其服务器向 Tivo 框发送发送更新。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T23:25:45.040

另一种解决方案是让 XP 端连接到 java servlet 并将数据作为 JSON 传递。这可能是最简单的方法，因为它要求您只保护 java 端并且 JSON 很容易解析，并且在我的测试中，它最终比使用 web 服务更快地满足我的需求。

如果您需要有 java 端请求，则只需侦听一个端口，以获知需要发送数据，然后将数据发送到 servlet。这将是 XP 端的一个简单服务器，因为它不传输任何数据，只是收到一条小消息（“发送”）。

# lucene - 对多个请求使用相同的 indexSearcher 实例时出现问题

> ID：899542
> 
> 赞同：2
> 
> 时间：2009-05-22T19:17:40.987
> 
> 标签：lucene, lucene.net

我在 .net Web 应用程序中使用 Lucene API。我想对所有请求使用相同的 Indexsearcher 实例。因此我将 indexsearcher 实例存储在 http 缓存中。

这是我的代码：

```
if (HttpRuntime.Cache["IndexSearcher"] == null)
                {
                    searcher = new IndexSearcher(jobIndexFolderPath);
                    HttpRuntime.Cache["IndexSearcher"] = searcher;
                }
                else
                {
                    searcher = (IndexSearcher)HttpRuntime.Cache["IndexSearcher"];
                } 
```

当我执行下面的语句时，我得到一个运行时错误：“对象引用未设置为对象的实例。”

点击 hits = searcher.Search(myQuery);

我在这里想念什么？

谢谢阅读！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-15T15:06:21.303

尝试以下操作：

```
protected static IndexSearcher searcher = null;
...

if (searcher == null)
{
    searcher = new IndexSearcher(jobIndexFolderPath);
}
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-14T21:23:12.817

我还有一个使用 Lucene API 进行查询的 Web 应用程序（我的 Web 应用程序不写入索引），并且我为每个请求创建了一个新的搜索器实例。它可能不是很“[高效](http://boulter.com/blog/2004/08/19/performant-is-not-a-word/)”，但我从来没有遇到过这种问题。

如果您愿意，我的网络应用程序位于 Google Code 上，因此您可以下载源代码并看看我做了什么。这是项目的[网址 http://code.google.com/p/goomez/](http://code.google.com/p/goomez/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T10:09:00.880

首先它根本不安全，它应该是：

```
var searcher = (IndexSearcher)HttpRuntime.Cache["IndexSearcher"];
if(searcher == null)
{
     searcher = new IndexSearcher(jobIndexFolderPath);
     HttpRuntime.Cache["IndexSearcher"] = searcher;
} 
```

在您的代码缓存中，检查和分配之间可能会过期

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-12T15:34:49.927

两件事情：

1.  如果您使用的是 .Net 2.0 并且尚未应用 SP1，[这](http://support.microsoft.com/kb/938276)可能会有所帮助。
2.  看看[这个](http://forums.asp.net/t/1054276.aspx)人遇到的问题。

这两个条目都指缓存中的对象过早过期——在这两种情况下几乎都是立即过期。由于缓存中的对象不是线程安全的，事情也可能变得复杂。

如果您必须拥有一个 IndexSearcher，为什么不将它作为服务提供给 Web 应用程序呢？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-14T21:11:06.980

我的快速回答是...

您实际上并不需要对所有请求使用相同的索引搜索器对象，实际上我建议您不要这样做。您只需要确保只有一个线程更新索引。

如果您真的想要一个，那么应用程序中的静态成员变量如何初始化一次并被所有人使用？

长答案是......我会尝试找到我的代码，看看我是如何处理这个问题的

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T11:37:36.537

史蒂夫，请参阅[使用 IndexSearcher 的最佳方式](http://www.lucidimagination.com/search/document/6d6f0ffe9555b244/best_ways_of_using_indexsearcher#1aa40c5296e85643)。这有点过时了，但原则仍然存在：使用 IndexSearcher 的单个实例，使用正确的线程安全代码（我不知道如何在 .Net 中执行）保护它，并在索引更新后使其无效。我相信这是 Jesse 的建议，我支持这个想法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T18:48:47.957

不是缓存 indexSearcher，而是缓存 IndexReader。如果 IndexReader 已经在缓存中，则检查它是否是最新的。否则将打开它并将该实例传递给 indexSearcher 构造函数。

如果多个请求正在访问 Web 服务器进行搜索，这个逻辑/代码是否有意义 wrt 优化的搜索查询响应？

谢谢阅读。

```
string key = MyConstants.CacheKey.IndexReader;

            indexReader = MyCacheManager.Get<IndexReader>(key);

            if (indexReader == null)//cache is empty.open indexreader
            {
                indexReader = IndexReader.Open(myIndexFolderPath);
                MyCacheManager.Add(key, indexReader);
                indexSearcher = new IndexSearcher(indexReader);
            }
            else//cache contains indexreader...check if it is up to date
            {
                indexSearcher = base.GetIndexSearcher(myIndexFolderPath, indexReader);
            }
            protected IndexSearcher GetIndexSearcher(string indexFolderPath, IndexReader indexReader)
        {
            IndexSearcher indexSearcher = null;
            if (!indexReader.IsCurrent())//index is not up to date
            {
                indexReader = IndexReader.Open(indexFolderPath);

                indexSearcher = new IndexSearcher(indexReader);
            }
            else
            {
                indexSearcher = new IndexSearcher(indexReader);
            }

            return indexSearcher;

        } 
```

# google-maps - 谷歌地理编码怪异

> ID：899545
> 
> 赞同：1
> 
> 时间：2009-05-22T19:18:02.937
> 
> 标签：google-maps, geocoding

我有一个奇怪的问题。突然间，我的 Google 地理编码 API 的 PHP 实现决定停止工作。它现在为每个请求返回错误 602，这意味着地址不可用。但是，如果我打开我正在查询的实际网址，它会完美运行，我可以下载正确的信息。但如果我使用 curl 抓取它，则返回 602 而不是 200。

我尝试更改 API 密钥，以及检查和测试 url。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-01-25T06:09:03.467

我曾经将我的国家（“澳大利亚”）添加到地理编码搜索字符串中，以将自由格式的文本搜索限制为“本地”地址。这似乎要杀了它。

```
geocoder.geocode(event.arg + "Australia"); 
```

现在我在构造函数中添加它（Actionscript，但可能适用于其他语言）

```
var geocoder:ClientGeocoder = new ClientGeocoder(
            new ClientGeocoderOptions({
                countryCode: "AU",
                language: 'en'/
            })); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T19:51:02.120

我正在使用以下方法进行地理编码。您可以尝试一下，以确保它不是 cURL 问题。

```
$request_url = $base_url . "&q=" . urlencode($address);
$xml_string = file_get_contents($request_url);
$xml_string = str_replace('xmlns=', 'ns=', $xml_string);
$xml = simplexml_load_string($xml_string); 
```

此外，如果您还没有看过关于使用 PHP 进行地理编码的[本教程](http://code.google.com/support/bin/answer.py?answer=80200&topic=11364)，请务必查看。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-11T12:50:58.067

这是一个迟到的答复。

根据[http://code.google.com/intl/en/apis/maps/documentation/geocoding/](http://code.google.com/intl/en/apis/maps/documentation/geocoding/)，

不再需要 Maps API 密钥。

> 注意：Google Geocoding API 不再需要 Maps API 密钥！Google Maps API Premier 客户必须另外使用新的加密密钥签署他们的 URL。

不过有一个限制。

> 使用 Google 地理编码 API 的查询限制为每天 2,500 个地理定位请求。（Google Maps API Premier 的用户每天最多可以执行 100,000 个请求。）强制执行此限制是为了防止滥用和/或重新利用 Geocoding API，并且此限制将来可能会更改，恕不另行通知。此外，我们强制执行请求速率限制以防止滥用服务。如果您超过 24 小时限制或以其他方式滥用服务，Geocoding API 可能会暂时停止为您工作。如果您继续超过此限制，您对 Geocoding API 的访问可能会被阻止。

解决该限制的方法是同时使用多个代理请求地理编码。如果您有 10 个具有不同 IP 地址的代理，您每天可以请求 25000 个地理编码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-20T10:22:52.150

Google 现在在您的请求中强制执行有效密钥，因此请确保您指定

```
&key=YOUR_VALID_KEY&sensor=false 
```

在您的要求中。

如果你没有传递一个有效的密钥，你会得到 602。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T19:20:09.360

如果它未能对它正在尝试的地址进行地理编码，它将返回 602。

# vba - 无法添加到 Double 类型

> ID：899560
> 
> 赞同：0
> 
> 时间：2009-05-22T19:20:57.843
> 
> 标签：vba, excel, excel-2007

我有一个想要增加的双精度值，使用以下代码段：

```
 Total = CDbl(Total + CDbl(Workbooks(1).Worksheets(1).Cells(1,1).Value)) 
```

代码连续返回类型不匹配错误，即使它指向的单元格中有一个十进制值。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T19:34:21.593

确保您指向的单元格实际上包含一个数字，而不仅仅是数字的文本表示。

要将文本单元格转换为数字，请选择单元格，然后从菜单栏中选择格式/单元格，然后在数字选项卡上单击常规。

# c# - .NET 库中是否有 Month 的预定义枚举？

> ID：899565
> 
> 赞同：108
> 
> 时间：2009-05-22T19:21:28.077
> 
> 标签：c#, .net, datetime, enumeration

我正在查看.net 框架中是否有几个月的官方枚举。

对我来说似乎有可能存在一个，因为月份的使用非常普遍，并且因为 .net 框架中还有其他此类枚举。

例如，有一个星期几的枚举，System.DayOfWeek，其中包括星期一、星期二等。

我想知道一年中的月份是否有一个，即一月、二月等？

有人知道吗？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2009-05-22T19:27:57.207

没有，但如果你想要一个月的名字，你可以使用：

```
CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName (DateTime.Now.Month); 
```

这将返回一个字符串表示形式（在本例中为当前月份）。请注意，`GetMonth`参数从 1 到 13 - January 是 1，13 是空白字符串。

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2009-05-22T19:27:29.967

不，没有。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2011-03-30T02:59:48.237

> 我正在查看.net 框架中是否有几个月的官方枚举。

不。

这是我之前准备的一个。（C#版本）

```
public enum Month
{
    NotSet = 0,
    January = 1,
    February = 2,
    March = 3,
    April = 4,
    May = 5,
    June = 6,
    July = 7,
    August = 8,
    September = 9,
    October = 10,
    November = 11,
    December = 12
} 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2011-02-19T01:45:00.643

`DateTimeFormatInfo.CurrentInfo.MonthNames`（不是枚举，但我认为 DateTimeFormatInfo 的 CurrentInfo 实例通常是您要寻找的）。如果你想要一个下拉列表，你可以像这样构建它：

```
List<string> monthNames = DateTimeFormatInfo.CurrentInfo.MonthNames.Take(12).ToList();
var monthSelectList = monthNames.Select(
   m => new { Id = monthNames.IndexOf(m) + 1, Name = m }); 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-05-22T19:36:26.097

在此命名空间的枚举“MonthNamesType”中找到一个：Microsoft.ServiceModel.Channels.Mail.ExchangeWebService.Exchange2007

位置有点吓人，但它仍然存在。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-05-22T19:29:00.900

你到底想完成什么？

如果您想要的只是十二个字符串，其中包含一年中的月份，那么可以通过自定义格式字符串获得 - 适用于日期时间的任何实例，

```
 DateTime dt = DateTime.Parse("12 January 2009");
   dt.ToString("MMM");  // prints "Jan" 
                        // (or the right abbrev is in current culture)
   dt.ToString("MMMM"); // prints "January" 
                        // (or correct sp in current culture) 
```

如果您只想能够将月份指定为某个其他对象类型的枚举属性，则 DateTime 字段的 Month 属性返回一个从 1 到 12 的整数...

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-01-19T16:57:03.647

是的，当然有。它是 Microsoft.VisualBasic 命名空间的一部分...

```
Microsoft.VisualBasic.MonthName 
```

对于那些对此命名空间有疑问的人，您应该了解[它确实是 .NET，而且它不会去任何地方](https://stackoverflow.com/questions/226517/is-the-microsoft-visualbasic-namespace-true-net-code)。

作为记录，该`MonthName`函数在内部调用以下...

```
Thread.CurrentThread.CurrentCulture.DateTimeFormat.GetMonthName 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-01-19T16:38:25.450

我会寻找这样的东西来编码，因为

```
 if (DateTime.Now.Month != 1) // can't run this test in January. 
```

里面有这个神奇的数字 1。然而

```
 if (DateTime.Now.Month != DateTime.MonthsOfYear.January) 
```

是自我记录的

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-12-14T21:05:30.423

有些日历确实有超过 12 个月：[http](http://en.wikipedia.org/wiki/Month) ://en.wikipedia.org/wiki/Month但我不能说这是否是 MS 没有在 .NET 中构建枚举的原因。

对于像我这样喜欢复制/粘贴的懒人，在 VB 中：

```
Public Enum MonthsOfYear
    January = 1
    February = 2
    March = 3
    April = 4
    May = 5
    June = 6
    July = 7
    August = 8
    September = 9
    October = 10
    November = 11
    December = 12
End Enum 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-22T19:28:07.703

我不确定，但我的预感是不会的。DateTime.Month 返回一个整数。如果有这样的枚举，它可能会被 DateTime 返回。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-11-15T00:34:19.400

枚举会相当有用，但您可以使用以下格式获得所需的结果：

```
DateTime myDateTimeObject=DateTime.Now; //(for example)
string monthName = myDateTimeObject.ToString("MMMM"); 
```

这将返回完整的月份名称（一月、二月等）。用于`myDateTimeObject.ToString("MMM")`简称（Jan、Feb、Mar 等）。

如果你有一个特定的月份数，`mnthNum`没有任何`DateTime`，你总是可以使用这样的：

```
string monthName=(new DateTime(2000,mnthNum,1)).ToString("MMMM"); 
```

或者

```
string monthName=((new DateTime(2000,1,1)).AddMonths(mnthNum-1)ToString("MMMM"); 
```

但这似乎有点乱。第一个示例要求`mnthNum`介于 1 到 12 之间。第二个示例允许（几乎）任何月份数，并且不限于 1 到 12。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-11-02T12:36:28.347

[0 - 11] `var MonthNames = new List<string>(DateTimeFormatInfo.CurrentInfo.MonthNames);`

# sql - VS2008 和 SQL Express 2008

> ID：899570
> 
> 赞同：0
> 
> 时间：2009-05-22T19:22:45.250
> 
> 标签：sql, visual-studio-2008

如何使 SQL Express 2008 成为 VS2008 而不是 SQL Express 2005 的默认值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T22:30:18.477

如果您将 MDF 添加到您的网站文件夹中，我认为您正在使用一个名为[User Instances](http://technet.microsoft.com/en-us/library/bb264564(SQL.90).aspx)的功能。这几乎是不可取的，而且它[正在被弃用](http://msdn.microsoft.com/en-us/library/ms143684.aspx)：

> 此功能将在 Microsoft SQL Server 的未来版本中删除。避免在新的开发工作中使用此功能，并计划修改当前使用此功能的应用程序。

不使用用户实例，而是使用服务器资源管理器连接到 Sql Server Express，并从那里创建一个数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T00:09:45.640

您正在运行 Visual Studio 2008 SP1 吗？我认为这可能是 SQL Server 2008 支持所必需的。

否则，请说明为什么您认为 2008 不是默认值。您是否收到异常或错误消息？有什么不工作的吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T20:12:09.410

在 Visual Studio 中，转到“工具”-->“选项”-->“数据库工具”-->“数据连接”。SQL Server 实例名称有一个字段。

我假设这就是您所说的默认值。根据您创建的项目类型，您通常会指定数据库连接。

# javascript - typeof 和 instanceof 有什么区别，什么时候应该使用另一个？

> ID：899574
> 
> 赞同：460
> 
> 时间：2009-05-22T19:24:19.927
> 
> 标签：javascript, instanceof, typeof

在我的特殊情况下：

```
callback instanceof Function 
```

或者

```
typeof callback == "function" 
```

有没有关系，有什么区别？

**附加资源：**

JavaScript-Garden [typeof](http://bonsaiden.github.com/JavaScript-Garden/#types.typeof) vs [instanceof](http://bonsaiden.github.com/JavaScript-Garden/#types.instanceof)

* * *

## 回答 #1

> 赞同：622
> 
> 时间：2011-07-08T14:30:26.040

### 用于`instanceof`自定义类型：

```
var ClassFirst = function () {};
var ClassSecond = function () {};
var instance = new ClassFirst();
typeof instance; // object
typeof instance == 'ClassFirst'; // false
instance instanceof Object; // true
instance instanceof ClassFirst; // true
instance instanceof ClassSecond; // false 
```

### 用于`typeof`简单的内置类型：

```
'example string' instanceof String; // false
typeof 'example string' == 'string'; // true

'example string' instanceof Object; // false
typeof 'example string' == 'object'; // false

true instanceof Boolean; // false
typeof true == 'boolean'; // true

99.99 instanceof Number; // false
typeof 99.99 == 'number'; // true

function() {} instanceof Function; // true
typeof function() {} == 'function'; // true 
```

### 用于`instanceof`复杂的内置类型：

```
/regularexpression/ instanceof RegExp; // true
typeof /regularexpression/; // object

[] instanceof Array; // true
typeof []; //object

{} instanceof Object; // true
typeof {}; // object 
```

最后一个有点棘手：

```
typeof null; // object 
```

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2009-05-22T19:28:10.810

两者在功能上相似，因为它们都返回类型信息，但是我个人更喜欢它，`instanceof`因为它比较的是实际类型而不是字符串。类型比较不太容易出现人为错误，并且它在技术上更快，因为它比较内存中的指针而不是进行整个字符串比较。

* * *

## 回答 #3

> 赞同：106
> 
> 时间：2010-01-20T16:35:17.860

使用 typeof 的一个很好的理由是变量可能未定义。

```
alert(typeof undefinedVariable); // alerts the string "undefined"
alert(undefinedVariable instanceof Object); // throws an exception 
```

使用 instanceof 的一个很好的理由是变量可能为空。

```
var myNullVar = null;
alert(typeof myNullVar ); // alerts the string "object"
alert(myNullVar  instanceof Object); // alerts "false" 
```

因此，在我看来，这实际上取决于您正在检查的可能数据类型。

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2016-01-29T09:32:07.760

为了清楚起见，您需要知道两个事实：

1.  **instanceof**运算符测试**构造函数**的**原型属性**是否出现在对象的**原型链**中的任何位置。在大多数情况下，这意味着对象是使用此构造函数或其后代**创建的。**但原型也可以通过方法（ECMAScript 2015）或属性（旧浏览器，已弃用）显式设置。但是，由于性能问题，不建议更改对象的原型。 ******`Object.setPrototypeOf()``__proto__`******

 ******因此 instanceof 仅适用于对象。在大多数情况下，您不会使用构造函数来创建字符串或数字。你可以。但你几乎从不这样做。

instanceof 也无法检查究竟是哪个构造函数用于创建对象，但会返回 true，即使对象是从被检查的类派生的。在大多数情况下，这是所需的行为，但有时并非如此。所以你需要保持这种心态。

另一个问题是不同的作用域有不同的执行环境。这意味着它们具有不同的内置函数（不同的全局对象、不同的构造函数等）。这可能会导致意想不到的结果。

例如，`[] instanceof window.frames[0].Array`将返回`false`，因为`Array.prototype !== window.frames[0].Array`和数组继承自前者。
此外，它不能用于未定义的值，因为它没有原型。

2.  **typeof**运算符测试值是否属于以下**六种基本类型之一**：“**数字**”、“**字符串**”、“**布尔**”、“**对象**”、“**函数**”或“**未定义**”。字符串“object”属于所有对象（除了函数，它们是对象，但在 typeof 运算符中有自己的值），还有“null”值和数组（对于“null”，这是一个错误，但这个错误太老了，因此它已成为标准）。它不依赖于构造函数，即使值未定义也可以使用。但它没有提供有关对象的任何细节。因此，如果您需要它，请转到 instanceof。

现在让我们谈谈一件棘手的事情。如果你使用构造函数来创建一个原始类型呢？

```
let num = new Number(5);
console.log(num instanceof Number); // print true
console.log(typeof num); // print object
num++; //num is object right now but still can be handled as number
//and after that:
console.log(num instanceof Number); // print false
console.log(typeof num); // print number 
```

好像魔法一样。但事实并非如此。这就是所谓的装箱（按对象包装原始值）和拆箱（从对象中提取包装的原始值）。这种代码似乎“有点”脆弱。当然，您可以避免使用构造函数创建原始类型。但是还有另一种可能的情况，拳击可能会击中你。当您在原始类型上使用 Function.call() 或 Function.apply() 时。

```
function test(){
  console.log(typeof this);
} 
test.apply(5); 
```

为避免这种情况，您可以使用严格模式：

```
function test(){
  'use strict';
  console.log(typeof this);
} 
test.apply(5); 
```

**upd：** 自 ECMAScript 2015 以来，还有一种称为 Symbol 的类型，它有自己的 typeof == **"symbol"**。

```
console.log(typeof Symbol());
// expected output: "symbol" 
```

你可以在 MDN 上阅读它：（[Symbol](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol)，[typeof](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/typeof)）。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2011-11-22T00:28:53.253

我在 Safari 5 和 Internet Explorer 9 中发现了一些非常有趣（读作“可怕”）的行为。我在 Chrome 和 Firefox 中使用它取得了巨大成功。

```
if (typeof this === 'string') {
    doStuffWith(this);
} 
```

然后我在IE9中测试，它根本不起作用。大惊喜。但在 Safari 中，它是断断续续的！于是我开始调试，我发现 Internet Explorer*总是*返回`false`. 但最奇怪的是 Safari 似乎在其 JavaScript VM 中进行了某种优化，这是`true`第*一次*，但`false` ***每次你点击重新加载！***

我的大脑几乎要爆炸了。

所以现在我已经解决了这个问题：

```
if (this instanceof String || typeof this === 'string')
    doStuffWith(this.toString());
} 
```

现在一切都很好。请注意，您可以调用`"a string".toString()`它只返回字符串的副本，即

```
"a string".toString() === new String("a string").toString(); // true 
```

所以从现在开始我会同时使用这两种方法。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2011-01-20T09:20:44.870

其他显着的实际差异：

```
// Boolean

var str3 = true ;

alert(str3);

alert(str3 instanceof Boolean);  // false: expect true  

alert(typeof str3 == "boolean" ); // true

// Number

var str4 = 100 ;

alert(str4);

alert(str4 instanceof Number);  // false: expect true   

alert(typeof str4 == "number" ); // true 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-05-22T19:27:55.990

`instanceof`我认为当`callback`是 的子类型时也有效`Function`

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-05-22T19:41:32.403

`instanceof`在 Javascript 中可能会不稳定——我相信主要框架会尽量避免使用它。不同的窗口是它可以破坏的方式之一 - 我相信类层次结构也会混淆它。

有更好的方法来测试一个对象是否是某种内置类型（这通常是你想要的）。创建实用函数并使用它们：

```
function isFunction(obj) {
  return typeof(obj) == "function";
}
function isArray(obj) {
  return typeof(obj) == "object" 
      && typeof(obj.length) == "number" 
      && isFunction(obj.push);
} 
```

等等。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2021-05-02T19:11:09.283

**typeof**：根据 MDN 文档，typeof 是一个一元运算符，它返回一个字符串，指示未计算的操作数的类型。

对于字符串原语和字符串对象，typeof 返回以下内容：

```
const a = "I'm a string primitive";
const b = new String("I'm a String Object");

typeof a; --> returns 'string'
typeof b; --> returns 'object' 
```

**instanceof**：是一个二元运算符，接受一个对象和一个构造函数。**它返回一个布尔值，指示对象在其原型链中是否具有给定的构造函数**。

当应用于上面的字符串实例时，与 String 相比，它的行为如下：

```
const a = "I'm a string primitive";
const b = new String("I'm a String Object");

a instanceof String; --> returns false
b instanceof String; --> returns true 
```

参考：[https ://bambielli.com/til/2017-06-18-typeof-vs-instanceof/](https://bambielli.com/til/2017-06-18-typeof-vs-instanceof/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-22T19:29:02.290

我建议使用原型的`callback.isFunction()`.

他们已经找出了差异，你可以指望他们的原因。

我猜其他 JS 框架也有这样的东西。

`instanceOf`我相信，它不适用于其他窗口中定义的功能。它们的功能与您的`window.Function`.

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-02-03T09:42:48.667

`instanceof`不适用于原语，例如`"foo" instanceof String`will return`false`而`typeof "foo" == "string"`will return `true`。

另一方面`typeof`，当涉及到自定义对象（或类，无论你想如何称呼它们）时，可能不会做你想做的事。例如：

```
function Dog() {}
var obj = new Dog;
typeof obj == 'Dog' // false, typeof obj is actually "object"
obj instanceof Dog  // true, what we want in this case 
```

碰巧函数既是“函数”基元又是“函数”的实例，这有点奇怪，因为它不像其他基元类型那样工作，例如。

```
(typeof function(){} == 'function') == (function(){} instanceof Function) 
```

但

```
(typeof 'foo' == 'string') != ('foo' instanceof String) 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2015-08-28T13:25:17.247

**表现**

`typeof`比`instanceof`两者都适用的情况更快。

根据您的引擎，支持的性能差异`typeof`可能在**20% 左右**。（*您的里程可能会有所不同*）

这是一个基准测试`Array`：

```
var subject = new Array();
var iterations = 10000000;

var goBenchmark = function(callback, iterations) {
    var start = Date.now();
    for (i=0; i < iterations; i++) { var foo = callback(); }
    var end = Date.now();
    var seconds = parseFloat((end-start)/1000).toFixed(2);
    console.log(callback.name+" took: "+ seconds +" seconds.");
    return seconds;
}

// Testing instanceof
var iot = goBenchmark(function instanceofTest(){
     (subject instanceof Array);
}, iterations);

// Testing typeof
var tot = goBenchmark(function typeofTest(){
     (typeof subject == "object");
}, iterations);

var r = new Array(iot,tot).sort();
console.log("Performance ratio is: "+ parseFloat(r[1]/r[0]).toFixed(3)); 
```

结果

```
instanceofTest took: 9.98 seconds.
typeofTest took: 8.33 seconds.
Performance ratio is: 1.198 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-07-19T23:38:33.913

检查功能时，必须始终使用`typeof`.

区别如下：

```
var f = Object.create(Function);

console.log(f instanceof Function); //=> true
console.log(typeof f === 'function'); //=> false

f(); // throws TypeError: f is not a function 
```

这就是为什么永远不要使用`instanceof`来检查功能的原因。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2018-02-20T23:37:58.903

这只是对这里所有其他解释的补充知识——我*不*建议在`.constructor`任何地方使用。

**TL;DR：**在`typeof`无法选择的情况下，并且***当您知道自己不关心原型链***时，[`Object.prototype.constructor`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/constructor)可能是一个可行甚至更好的替代方案`instanceof`：

```
x instanceof Y
x.constructor === Y 
```

它自 1.1 以来一直在标准中，因此无需担心向后兼容性。

Muhammad Umer 也在此处某处的评论中简要提到了这一点。它适用于带有原型的所有东西 - 所以一切都不是`null`或`undefined`：

```
// (null).constructor;      // TypeError: null has no properties
// (undefined).constructor; // TypeError: undefined has no properties

(1).constructor;                 // function Number
''.constructor;                  // function String
([]).constructor;                // function Array
(new Uint8Array(0)).constructor; // function Uint8Array
false.constructor;               // function Boolean()
true.constructor;                // function Boolean()

(Symbol('foo')).constructor;     // function Symbol()
// Symbols work, just remember that this is not an actual constructor:
// new Symbol('foo'); //TypeError: Symbol is not a constructor

Array.prototype === window.frames.Array;               // false
Array.constructor === window.frames.Array.constructor; // true 
```

此外，根据您的用例，它可能*比*它快得多`instanceof`（原因可能是它不必检查整个原型链）。在我的情况下，我需要一种快速的方法来检查一个值是否是一个类型化的数组：

```
function isTypedArrayConstructor(obj) {
  switch (obj && obj.constructor){
    case Uint8Array:
    case Float32Array:
    case Uint16Array:
    case Uint32Array:
    case Int32Array:
    case Float64Array:
    case Int8Array:
    case Uint8ClampedArray:
    case Int16Array:
      return true;
    default:
      return false;
  }
}

function isTypedArrayInstanceOf(obj) {
  return obj instanceof Uint8Array ||
    obj instanceof Float32Array ||
    obj instanceof Uint16Array ||
    obj instanceof Uint32Array ||
    obj instanceof Int32Array ||
    obj instanceof Float64Array ||
    obj instanceof Int8Array ||
    obj instanceof Uint8ClampedArray ||
    obj instanceof Int16Array;
} 
```

[https://run.perf.zone/view/isTypedArray-constructor-vs-instanceof-1519140393812](https://run.perf.zone/view/isTypedArray-constructor-vs-instanceof-1519140393812)

结果：

**Chrome 64.0.3282.167（64 位，Windows）**

[![类型化数组 instanceof 与构造函数 - 在 Chrome 64.0.3282.167（64 位，Windows）中快 1.5 倍](https://i.stack.imgur.com/RAsZd.png)](https://i.stack.imgur.com/RAsZd.png)

**Firefox 59.0b10（64 位，Windows）**

[![类型化数组 instanceof 与构造函数 - 在 Firefox 59.0b10（64 位，Windows）中快 30 倍](https://i.stack.imgur.com/IXDfA.png)](https://i.stack.imgur.com/IXDfA.png)

出于好奇，我做了一个快速的玩具基准测试`typeof`；令人惊讶的是，它的性能并没有差很多，而且在 Chrome 中似乎更快一点：

```
let s = 0,
    n = 0;

function typeofSwitch(t) {
    switch (typeof t) {
        case "string":
            return ++s;
        case "number":
            return ++n;
        default:
            return 0;
    }
}

// note: no test for null or undefined here
function constructorSwitch(t) {
    switch (t.constructor) {
        case String:
            return ++s;
        case Number:
            return ++n;
        default:
            return 0;
    }
}

let vals = [];
for (let i = 0; i < 1000000; i++) {
    vals.push(Math.random() <= 0.5 ? 0 : 'A');
} 
```

[https://run.perf.zone/view/typeof-vs-constructor-string-or-number-1519142623570](https://run.perf.zone/view/typeof-vs-constructor-string-or-number-1519142623570)

**注意：列出功能的顺序在图像之间切换！**

**Chrome 64.0.3282.167（64 位，Windows）**

[![字符串/数字类型与构造函数 - 在 Chrome 64.0.3282.167（64 位，Windows）中快 1.26 倍](https://i.stack.imgur.com/gb4Si.png)](https://i.stack.imgur.com/gb4Si.png)

**Firefox 59.0b10（64 位，Windows）**

**注意：列出功能的顺序在图像之间切换！**

[![字符串/数字类型与构造函数 - 在 Firefox 59.0b10（64 位，Windows）中慢 0.78 倍](https://i.stack.imgur.com/pe9Ci.png)](https://i.stack.imgur.com/pe9Ci.png)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2010-08-20T14:07:56.597

显着的实际差异：

```
var str = 'hello word';

str instanceof String   // false

typeof str === 'string' // true 
```

不要问我为什么。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-22T19:55:36.293

使用 instanceof 因为如果您更改类的名称，您将收到编译器错误。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-09-05T08:37:00.947

```
var newObj =  new Object;//instance of Object
var newProp = "I'm xgqfrms!" //define property
var newFunc = function(name){//define function 
	var hello ="hello, "+ name +"!";
	return hello;
}
newObj.info = newProp;// add property
newObj.func = newFunc;// add function

console.log(newObj.info);// call function
// I'm xgqfrms!
console.log(newObj.func("ET"));// call function
// hello, ET!

console.log(newObj instanceof Object);
//true
console.log(typeof(newObj));
//"object"
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-03-25T13:46:08.193

无需对上述大量示例感到不知所措，只需记住两个观点：

1.  `typeof var;`是一元运算符，将返回原始类型或 var 的根类型。这样它将返回原始类型（`string`、`number`、`bigint`、`boolean`、`undefined`和`symbol`）或`object`类型。

2.  对于更高级别的对象，如内置对象（String、Number、Boolean、Array..）或复杂或自定义对象，它们都是`object`根类型，但基于它们构建的实例类型是不同的（如 OOP 类继承概念），这里`a instanceof A`- 二元运算符 - 会帮助你，它将通过原型链检查正确操作数（A）的构造函数是否出现。

因此，每当您想检查“根类型”或使用原始变量时 - 使用“typeof”，否则使用“instanceof”。

`null`是一个特例，看起来很原始，但确实是对象的特例。用于`a === null`检查空值。

另一方面，`function`也是一种特殊情况，即内置对象但`typeof`返回`function`

如您所见，`instanceof`必须通过原型链，同时`typeof`只需检查一次根类型，因此很容易理解为什么`typeof`比`instanceof`

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-12-13T14:57:03.290

确切地说 ，应该在通过构造函数（通常是自定义类型）创建值的地方使用**instanceof**，例如

```
var d = new String("abc") 
```

而**typeof**检查仅由分配创建的值，例如

```
var d = "abc" 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2009-05-22T19:29:03.850

来自严格的面向对象教育，我会去

```
callback instanceof Function 
```

字符串很容易出现我糟糕的拼写或其他拼写错误。另外，我觉得它读起来更好。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2016-05-23T11:39:26.267

尽管**instanceof可能比****typeof**快一点，但我更喜欢第二个，因为它可能具有魔力：

```
function Class() {};
Class.prototype = Function;

var funcWannaBe = new Class;

console.log(funcWannaBe instanceof Function); //true
console.log(typeof funcWannaBe === "function"); //false
funcWannaBe(); //Uncaught TypeError: funcWannaBe is not a function 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2016-06-02T16:35:09.857

另一种情况是您只能与`instanceof`- 它返回真或假。有了`typeof`你可以获得提供的*东西的类型*

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2017-09-16T22:55:38.053

考虑到性能，您最好将 typeof 与典型硬件一起使用，如果您创建一个包含 1000 万次迭代循环的脚本，则指令： typeof str == 'string' 将花费 9ms 而 'string' instanceof String 将花费 19ms

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2018-01-04T05:55:19.907

***当然有关系…………！***

让我们通过示例来完成。在我们的示例中，我们将以两种不同的方式声明函数。

我们将同时使用***`function declaration`***和 ***[Function Constructor](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function)***。我们将了解这两种不同情况下的方式**`typeof`**和**`instanceof`**行为。

***使用函数声明创建函数：***

```
function MyFunc(){  }

typeof Myfunc == 'function' // true

MyFunc instanceof Function // false 
```

对这种不同结果的可能解释是，当我们做了一个函数声明时，**`typeof`**可以理解它是一个函数**`typeof`**。因为检查是否对哪个 typeof 进行操作的表达式，在我们的例子中**实现****了*****[Call Method](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call)***。如果它实现方法，它就是一个函数。否则不是。为了澄清，请检查***[typeof 的 ecmascript 规范](https://www.ecma-international.org/ecma-262/5.1/#sec-11.4.3)***。**`MyFunc`** **`Call`**

***使用函数构造函数创建函数：***

```
var MyFunc2 = new Function('a','b','return a+b') // A function constructor is used 

typeof MyFunc2 == 'function' // true

MyFunc2 instanceof Function // true 
```

这里**`typeof`**断言that**`MyFunc2`**是一个函数和**`instanceof`**运算符。我们已经知道**`typeof`**检查是否**`MyFunc2`**实现了**`Call`**方法。既然**`MyFunc2`**是一个函数，它实现了**`call`**方法，那就**`typeof`**知道它是一个函数。另一方面，我们曾经**`function constructor`**创建**`MyFunc2`**，它成为**`Function constructor`**. 这就是为什么**`instanceof`**也解析为**`true`**.

***使用什么更安全？***

正如我们所看到的，在这两种情况下**`typeof`**，操作员都可以成功地断言我们正在处理一个函数，它比**`instanceof`**. **`instanceof`**将失败，**`function declaration`**因为**`function declarations`**不是**`Function constructor`**.

***最佳实践 ：***

正如***[Gary Rafferty](http://garyrafferty.com/2012/12/07/JavaScript-instanceof-vs-typeof.html)***建议的那样，最好的方法应该是同时使用 typeof 和 instanceof。

```
 function isFunction(functionItem) {

        return typeof(functionItem) == 'function' || functionItem instanceof Function;

  }

  isFunction(MyFunc) // invoke it by passing our test function as parameter 
```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2020-05-05T14:29:52.200

根据[关于 typeof 的 MDN 文档](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/typeof)，使用“new”关键字实例化的对象属于“object”类型：

```
typeof 'bla' === 'string';

// The following are confusing, dangerous, and wasteful. Avoid them.
typeof new Boolean(true) === 'object'; 
typeof new Number(1) === 'object'; 
typeof new String('abc') === 'object'; 
```

虽然[有关 instanceof 的文档](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/instanceof)指出：

```
const objectString = new String('String created with constructor');
objectString instanceOf String; // returns true
objectString instanceOf Object; // returns true 
```

因此，如果想检查某个东西是否是一个字符串，无论它是如何创建的，最安全的方法是使用`instanceof`.

# asp.net - 有没有办法将 Windows 身份验证模式与会员提供程序“链接”？

> ID：899595
> 
> 赞同：0
> 
> 时间：2009-05-22T19:28:35.160
> 
> 标签：asp.net, authentication, active-directory, impersonation

## **编辑：**

我想我可以归结为：我想使用 windows 身份验证模式，但能够像你一样获得用户列表`Membership.GetAllUsers()`。

* * *

我正在尝试开发一种在 Intranet 上使用的解决方案，因此所有用户都将通过身份验证。我想我正在寻找两全其美的解决方案。

这是要点（稍后我将进行编辑以进行澄清）

*   我想使用 Windows 身份验证模式。但随后`Membership.GetUser()`是`null`。
*   我需要在我的数据中使用一致的外键来引用经过身份验证的用户。我还需要用户的电子邮件地址以进行通知；Windows 身份验证不提供此功能。
*   对 ActiveDirectory 的任何查询都需要模拟 WindowsIdentity。IT 不会为此用途提供“系统”帐户。

有没有适合我需要的示例或解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T19:32:35.433

使用 Windows 身份验证时，System.Web.HttpContext.Current.User.Identity.Name 将为您提供用户名。至于电子邮件地址，您使用的是 Exchange 吗？

# bash - 如何将命令结果通过管道传输到 - 选项？（没有空格）

> ID：899596
> 
> 赞同：3
> 
> 时间：2009-05-22T19:28:43.990
> 
> 标签：bash, command, pipe, head

我有这组管道命令：

```
grep -n '*' file.txt | head -n1 | awk -F\: '{print $1-1;}' 
```

它告诉我它首先找到星号的前一行。现在我想将前面的几行管道传输到：

```
head -n<that previous line number> 
```

Head 需要紧跟 -n 参数的数字，不带空格，例如：

```
head -n4 
```

我怎样才能做到这一点？它只是不接受添加

```
| head -n 
```

在命令集的末尾。我的搜索没有结果。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T19:31:53.063

您希望反引号替换该值：

```
head -n`grep -n '*' file.txt | head -n1 | awk -F\: '{print $1-1;}'` file.txt 
```

或者可能在多行类似的东西：

```
LINENO=`grep -n '*' file.txt | head -n1 | awk -F\: '{print $1-1;}'`
head -n${LINENO} file.txt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T21:51:09.740

你为什么不这样做：

```
awk -- '{if (!/*/) print $0; else exit}' file.txt 
```

或者这个，更快：

```
awk -- '/*/ {exit}; {print}' file.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T20:08:46.313

我认为您也可以使用 xargs。就像是：

```
grep -n '*' file.txt | head -n1 | awk -F\: '{print $1-1;}' | xargs -I % head -n% file.txt 
```

# ios - 如何以简单的方式将 CGPoint 对象添加到 NSArray？

> ID：899600
> 
> 赞同：130
> 
> 时间：2009-05-22T19:29:37.670
> 
> 标签：ios, objective-c, iphone, cocoa-touch, uikit

我有大约 50 个描述类似“路径”的 CGPoint 对象，我想将它们添加到 NSArray。这将是一个只返回给定索引对应的 CGPoint 的方法。我不想创建 50 个变量，例如 p1 = ...; p2 = ...，依此类推。有没有一种简单的方法可以让我在使用对象初始化 NSArray 时“立即”定义这些点？

* * *

## 回答 #1

> 赞同：328
> 
> 时间：2009-05-22T19:44:40.993

随着`UIKit`Apple 添加对 CGPoint 的支持`NSValue`，您可以执行以下操作：

```
NSArray *points = [NSArray arrayWithObjects:
                     [NSValue valueWithCGPoint:CGPointMake(5.5, 6.6)],
                     [NSValue valueWithCGPoint:CGPointMake(7.7, 8.8)],
                     nil]; 
```

列出与 CGPoint 一样多的 [NSValue] 实例，并以 nil 结束列表。此结构中的所有对象都是自动释放的。

另一方面，当您从数组中提取值时：

```
NSValue *val = [points objectAtIndex:0];
CGPoint p = [val CGPointValue]; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-05-06T02:22:31.907

我用这个：

创建数组：

```
NSArray *myArray = @[[NSValue valueWithCGPoint:CGPointMake(30.0, 150.0)],[NSValue valueWithCGPoint:CGPointMake(41.67, 145.19)]]; 
```

获取第一个 CGPoint 对象：

```
CGPoint myPoint = [myArray[0] CGPointValue]; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-05-31T12:42:38.003

您也可以用以下最小形式编写：

```
CGPoint myArray[] = { CGPointMake(5.5, 6.6), CGPointMake(7.7, 8.8) };

CGPoint p2 = myArray[1]; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T19:44:58.093

你看过了`CFMutableArray`吗？这可能对你更有效。

# bash - Gnu-Screen：运行脚本，将命令发送到正在运行的屏幕会话

> ID：899609
> 
> 赞同：8
> 
> 时间：2009-05-22T19:31:09.353
> 
> 标签：bash, gnu-screen

假设它正在屏幕中运行，是否可以编写脚本来更改名称并打开对当前选项卡的监视？

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T20:44:48.127

从屏幕手册页：

> ```
>  -X   Send the specified command to a running screen  session.  You  can
>        use  the  -d or -r option to tell screen to look only for attached
>        or detached screen sessions. Note that this command  doesn't  work
>        if the session is password protected. 
> ```

基本上，运行

```
screen -X title mynewtitle
screen -X monitor on 
```

如果终端不在屏幕内运行，它会默默地出错：

```
notinscreen:~$ screen -X title mynewtitle
notinscreen:~$ 
```

您还可以将命令发送到特定会话，即使在分离时也是如此。给定一个名为“main”的屏幕会话：

```
$ screen -S main
[detach from screen session]
$ screen -ls
There is a screen on:
        2073.main       (Detached)
1 Socket in /tmp/uscreens/S-dbr. 
```

..您可以将最后一个活动窗口的标题发送到`blah`：

```
$ screen -x main -X title blah 
```

..或特定窗口（`oldwindow`在本例中命名）：

```
$ screen -x main -p oldwindow -X title blah 
```

`-x main`您可以使用进程 ID（from ）代替使用，也可以使用窗口编号`screen -ls`代替窗口名称（ ）：`-p oldwindow`

```
$ screen -x 2073 -p 0 -X title h 
```

如果只有一个会话，则不必指定会话 PID 或名称。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T20:23:44.643

我认为这有效：

```
if [-n "$STY"]; then
    screen -X title "foo"
    screen -X monitor on
fi 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T19:49:03.170

screen 声明`$STY`了环境变量，你可以尝试使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T19:35:26.207

您是否希望显示信息或与屏幕会话本身进行交互？你可以用这个发回消息：（[http://www.slac.stanford.edu/comp/unix/package/epics/extensions/iocConsole/screen.1.html#lbAI](http://www.slac.stanford.edu/comp/unix/package/epics/extensions/iocConsole/screen.1.html#lbAI)）

> 消息行屏幕在消息行中显示信息性消息和其他诊断信息。虽然该行分布在屏幕底部，但可以定义为在编译期间出现在屏幕顶部。如果您的终端在其 termcap 中定义了状态行，屏幕将使用它来显示其消息，否则当前屏幕的一行将被暂时覆盖，并且输出将暂时中断。消息行会在几秒钟延迟后自动删除，但也可以通过开始键入提前删除（在没有状态行的终端上）。
> 
> 在当前窗口中运行的应用程序可以通过 ANSI 隐私消息控制序列使用消息行工具。例如，在 shell 中，尝试以下操作：
> 
> ```
> echo '<esc>^Hello world from window '$WINDOW'<esc>\\' 
> ```
> 
> 其中 ' `<esc>`' 是转义符， ' `^`' 是文字向上箭头， ' `\\`' 变成单个反斜杠。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T19:34:10.843

屏幕透明运行，因此很难检测屏幕会话。如果您尝试发送按键，那将起作用，并且如果您不在会话中，则会在您的终端中填充一点垃圾。

# iphone - iphone铃声格式

> ID：899615
> 
> 赞同：0
> 
> 时间：2009-05-22T19:33:14.840
> 
> 标签：iphone

Apple 无损音频编解码器 (alac) 编码的 m4a 是否可以用作 iPhone 铃声？如果没有，iPhone 铃声支持哪些音频格式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-17T06:58:10.907

请注意，.m4r 文件实际上与 .m4a 文件格式相同，因此您只需将其重命名为 .m4r 并将其拖回 iTunes。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-17T06:53:59.560

m4a 不能直接用作 iPhone 铃声。iPhone 铃声只有一种音频格式，它是 .m4r

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-17T07:00:45.793

iTunes 铃声是普通的 .m4a 文件，但长度必须正好为 30 秒。（并且它们应该具有 .m4r 扩展名，尽管该文件是标准的 .m4a 文件）

# sql - 查询引擎将如何评估此 SQL 查询？

> ID：899618
> 
> 赞同：2
> 
> 时间：2009-05-22T19:33:53.263
> 
> 标签：sql, sql-execution-plan

我正在玩 SQL 查询，我想到了这个 - `select x,y from table T`.

这里 x 和 y 可以是算术表达式，例如 2.0/5.0 OR 1+2，结果是表 T 的行数，第一列的值为 2.0/5.0，即 0.444444，第二列的值为 3。

我很想知道这个查询是如何执行的。我了解到，在 SQL 查询引擎中，存在从查询的 SQL 表示到内部表示（如关系代数）的映射，然后对其进行优化以产生最佳的查询执行计划。

如果它是错误的，请纠正我的理解 - 对于我所说的查询，从我的查询 Q 到内部表示之间会有一个内部映射，它相当于`select * from table T`. 然后对于所有返回的行，n 个列被投影出来，其中 n 是 Q 中所述的算术表达式的数量。n 列的所有行都将具有它们各自对算术表达式的评估。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T19:41:13.777

它很可能取决于数据库。

如果您用于 x 和 y 的表达式是常量，那么一个体面的数据库应该能够识别并只执行一次计算并将值放入结果集中。

如果表达式包含其他函数，那么每次都必须执行表达式，以防函数产生副作用。

一般来说，您是正确的，计算 from 子句中描述的虚拟表，然后我相信 where 子句中的过滤器被应用，然后是 select 子句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T19:42:28.830

不，表达式只计算一次（至少在 MS SQL Server 中）。

如果你这样做，你可以很容易地看到这一点：

```
select rand() from tableT 
```

所有行都将具有相同的随机数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T19:54:10.600

它将扫描，因为没有 where 子句。这是 sql server 的**set showplan_all on**

```
select 2.0/5.0,1+2 from YourTable                                                            
  |--Compute Scalar(DEFINE:([Expr1003]=(0.400000), [Expr1004]=(3)))                           
       |--Index Scan(OBJECT:([wppusdev].[dbo].[AP_Voucher].[YourTable_Index])) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T19:57:49.143

从 MS SQL 的角度来看...

它的评估结果可能与 SELECT * FROM Table 不同，因为引擎应该意识到它实际上并不需要表中的任何列，因此它很可能会选择表上最薄的索引并对其进行扫描。

实际方程只应评估一次，然后将其用作常数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T20:01:16.187

PostgreSQL 将首先评估表达式，然后很可能对表执行顺序扫描。此外，正如其他地方所提到的，许多 SQL 风格都有一个 EXPLAIN 关键字，它将向您展示在给定当前实现的情况下如何评估特定查询。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T20:10:18.867

数据库是否为每一行评估一次函数是一个实现决定。在 Oracle 中，您可以从表中选择 dbms_random.random() 并为每一行返回不同的数字。例如，如果您想以随机顺序返回行，这将很有帮助。

# c# - 将对象投射到 T

> ID：899629
> 
> 赞同：110
> 
> 时间：2009-05-22T19:38:04.347
> 
> 标签：c#, generics, casting

我正在用`XmlReader`.NET 中的类解析一个 XML 文件，我认为编写一个通用的解析函数来通用地读取不同的属性会很聪明。我想出了以下功能：

```
private static T ReadData<T>(XmlReader reader, string value)
{
    reader.MoveToAttribute(value);
    object readData = reader.ReadContentAsObject();
    return (T)readData;
} 
```

我开始意识到，这并不完全按我的计划工作。它会抛出原始类型（例如`int`or ）的错误`double`，因为强制转换无法从 a 转换`string`为数字类型。有没有办法让我的功能以修改后的形式占上风？

* * *

## 回答 #1

> 赞同：244
> 
> 时间：2009-05-22T19:42:03.650

首先检查它是否可以投射。

```
if (readData is T) {
    return (T)readData;
} 
try {
   return (T)Convert.ChangeType(readData, typeof(T));
} 
catch (InvalidCastException) {
   return default(T);
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-22T19:42:15.773

您是否尝试过[Convert.ChangeType](http://msdn.microsoft.com/en-us/library/system.convert.changetype.aspx)？

如果该方法总是返回一个字符串，我觉得这很奇怪，但这不是重点，那么这个更改的代码可能会满足您的要求：

```
private static T ReadData<T>(XmlReader reader, string value)
{
    reader.MoveToAttribute(value);
    object readData = reader.ReadContentAsObject();
    return (T)Convert.ChangeType(readData, typeof(T));
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-05-22T19:43:16.690

尝试

```
if (readData is T)
    return (T)(object)readData; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-22T19:42:49.453

您可以要求类型是引用类型：

```
 private static T ReadData<T>(XmlReader reader, string value) where T : class
 {
     reader.MoveToAttribute(value);
     object readData = reader.ReadContentAsObject();
     return (T)readData;
 } 
```

然后做另一个使用值类型和 TryParse...

```
 private static T ReadDataV<T>(XmlReader reader, string value) where T : struct
 {
     reader.MoveToAttribute(value);
     object readData = reader.ReadContentAsObject();
     int outInt;
     if(int.TryParse(readData, out outInt))
        return outInt
     //...
 } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-29T21:02:30.333

实际上，这里的问题是 ReadContentAsObject 的使用。不幸的是，这种方法没有达到预期。虽然它应该检测到值的最合适类型，但它实际上返回一个字符串，无论如何（这可以使用 Reflector 进行验证）。

但是，在您的具体情况下，您已经知道要转换为的类型，因此我会说您使用了错误的方法。

尝试改用 ReadContentAs，这正是您所需要的。

```
private static T ReadData<T>(XmlReader reader, string value)
{
    reader.MoveToAttribute(value);
    object readData = reader.ReadContentAs(typeof(T), null);
    return (T)readData;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-22T19:42:32.387

添加“类”约束（或更详细，如预期 T 对象的基类或接口）：

```
private static T ReadData<T>(XmlReader reader, string value) where T : class
{
    reader.MoveToAttribute(value);
    object readData = reader.ReadContentAsObject();
    return (T)readData;
} 
```

或`where T : IMyInterface`或`where T : new()`等

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-22T19:42:37.783

您大概可以将一个委托作为参数传入，该委托将从字符串转换为 T。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-22T21:51:26.573

实际上，这些响应提出了一个有趣的问题，即您希望您的函数在发生错误时执行的操作。

也许以尝试读入 T 的 TryParse 方法的形式构造它会更有意义，但如果无法完成则返回 false？

```
 private static bool ReadData<T>(XmlReader reader, string value, out T data)
    {
        bool result = false;
        try
        {
            reader.MoveToAttribute(value);
            object readData = reader.ReadContentAsObject();
            data = readData as T;
            if (data == null)
            {
                // see if we can convert to the requested type
                data = (T)Convert.ChangeType(readData, typeof(T));
            }
            result = (data != null);
        }
        catch (InvalidCastException) { }
        catch (Exception ex)
        {
            // add in any other exception handling here, invalid xml or whatnot
        }
        // make sure data is set to a default value
        data = (result) ? data : default(T);
        return result;
    } 
```

编辑：现在我想想，我真的需要做 convert.changetype 测试吗？as 行不是已经尝试这样做了吗？我不确定做那个额外的 changetype 调用是否真的能完成任何事情。实际上，它可能只是通过生成异常来增加处理开销。如果有人知道值得做的不同之处，请发布！

# c++ - 8051微控制器的C++？

> ID：899633
> 
> 赞同：9
> 
> 时间：2009-05-22T19:39:21.957
> 
> 标签：c++, c, embedded, microcontroller, 8051

有人可以告诉我是否可以用 C++ 程序烧录 8051 微控制器？我试过在网上搜索它，但似乎无法确定它是否可能。Keil 使用 C，但我需要编写的程序是字符串密集型的，与我习惯使用的 C# 相比，C 对字符串非常不友好。目前，我正在尝试用 C 编写代码，但它变得非常混乱，所以如果我可以用 C++ 编写它，我会非常放心。

我需要一个 C++ 编译器来创建一个十六进制输出文件，然后可以将其刻录到微控制器上。有人听说过我可以使用的东西吗？而且，C 使用了一个头文件，可以让你引用端口，但是当我试图找出这个头文件是否也在 C++ 中使用时，我找不到任何关于它的信息。

另外：我使用的微控制器是带有 4K 字节可重编程闪存和 128 x 8 位内部 RAM 的 Atmel AT89C51。这实际上是针对大学项目的机器人，编码实际上不需要 OOP。它只是有很多二维字符串数组格式的查找表。我想考虑 C++ 的唯一原因是因为操作字符串似乎变得非常混乱（由于我缺乏 C 专业知识）。

有人知道头文件吗？C 使用 #include reg51.h 但我试图找出这是否适用于 C++ 并且找不到任何内容。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T19:49:52.153

我首先会质疑这是否真的是一个好主意。我理解在一般情况下希望在 C 上使用 c++ 的原因，但对于 8 位哈佛架构微控制器，我会警告不要这样做。

要记住的事情包括：

*   源代码级调试支持介于差和不可能之间。
*   OOP 在 8 位机器上的运行时开销。我强烈建议在使用工具之前进行一些认真的基准测试。
*   内存在嵌入式系统中并不便宜，毫无疑问你会有一些地址空间限制。

此外，如果您真的要进行一些严肃的字符串处理，我建议您使用 C 标准库而不是字符串对象库，因为您可以更好地控制就地替换，因此字符串副本在代码中变得非常明显。

请发布一些关于您计划使用的微控制器（数据存储器、程序存储器）以及是否必须满足任何性能要求的信息，以便我们提供更具体的帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T21:13:05.340

IAR Systems 有一个[8051 编译器](http://iar.com/website1/1.0.1.0/244/1/)，可以本机编译 C++（不翻译为 C），源代码级调试也不应该成为问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T19:47:53.373

[ceibo](http://ceibo.com/eng/products/cpp.shtml)有一个商业编译器。

但是，您是否可以使用 c++（尤其是 STL 字符串）取决于您将拥有多少资源（ROM 和 RAM）。

有一个[8051 站点](http://www.8051projects.net/)，其中包含论坛、教程和下载，您可以在其中获得更多关于 8051 编程的资源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T15:53:55.590

[IAR](http://iar.com)似乎为 8051 提供~~[了 C/C++ 编译器，为 8051](http://iar.com/website1/1.0.1.0/244/1/)~~[提供了 C/C++ 编译器](https://web.archive.org/web/20120118033143/http://www.iar.com/en/products/iar-embedded-workbench/8051/)。——但完全公开，我只使用 Keil 的 C 编译器进行 8051 开发。

至于您的头文件问题：头文件通常由 IDE 供应商或硬件制造商分发，并且通常提供您的寄存器映射的符号表示。将基于 C 的头文件合并到 C++ 项目中*可能需要*适量的按摩。-- 如果您要切换 IDE/编译器，您通常可以期望对源代码进行一些按摩以适应新的编译器。（阅读：从 C++ 代码库访问 C 代码通常会让我停下一天的时间来做正确的事情。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T20:21:50.717

您可能需要考虑提供有关您打算在该微控制器上运行的程序类型的更多详细信息：

您在帖子中提到了 C++ 和 C#，这两者肯定都不适合***在微控制器上***进行繁重的字符串处理，更不用说您可能正在考虑大量使用 STL，这会进一步增加可执行？

那么你的主要限制到底是什么（RAM、CPU、ROM 等）？

如果您真的认为您需要以 OO 方式进行字符串处理，您可能需要考虑在控制器上运行轻量级嵌入式脚本解释器，以便您可以使用脚本语言提供字符串处理例程，而解释器其本身将被 ANSI C 编译为 HEX 文件（例如，[lua](http://www.lua.org)或[鼻音](http://www.plausible.org/nasal/)似乎都是合适的候选者）。

但是，考虑到诸如 lua 之类的脚本语言通常会在空间上施加大约 100kb+ 的开销，Nasal 更轻量级，如果禁用某些扩展，可能会编译到 50-70kb。

此外，还有其他专门用于嵌入式平台的脚本解释器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T21:46:19.733

您可以尝试将 C++ 代码转换为 C 代码，然后使用现有的 C 编译器对其进行编译。

您应该能够创建一个调用 C++ 编译器的 Makefile，然后再运行 C 编译器。

这不是最优雅的解决方案，但在 8051 等小型设备上使用 C++ 确实很不寻常。

*免责声明：我还没有真正尝试过这么幸运！如果是我，我会坚持使用 C 并编写一些健壮的字符串处理函数。*

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-24T08:01:39.993

是的，您可以使用 C++ 程序烧录 8051 微控制器的内存，还有一些免费的编译器可用于创建 Hex 文件，然后将文件发送到微控制器。[您可以在包含教程、编译器、模拟器等](http://www.intorobotics.com/8051-microcontroller-programming-tutorials-simulators-compilers-and-programmers/)的综合文章中找到有关微控制器编程过程的任何信息

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T21:11:02.880

有几种商业编译器可用。行业排名第一的是[Keil Software](http://www.keil.com/c51/)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-23T15:18:20.257

其他人提到 8051 有 C++ 编译器。我猜你的主要问题是成本。许多公司会让你免费编写程序集，但对 C 或 C++ 编译器收费。我们可能在这里谈论几百美元。

我的主要问题是什么在你的代码中变得“混乱”？您试图在 C++ 中使用哪些在 C 中变得混乱的功能？C++ 中的一些特性不能很好地转化为这样一个最小的嵌入式环境（流、构造函数、析构函数等）。C 可以使用结构来执行许多面向对象的类型函数。应该避免其他功能（任何具有动态内存管理的功能）。

我会努力让它在 C 中工作，然后再花很多钱并获得庞大、缓慢和笨拙的代码。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-25T18:32:34.020

听起来您想要一个 C++ 编译器，以便您可以使用`std::string`. `std::string`需要一个堆。你不会有一个只有 128x8 位内部 RAM 的可用堆，尤其是对于`std::string`对象来说，考虑一下，如果你从一个串行端口读取一个 80 个字符的字符串，这会消耗超过 60% 的可用 RAM。你也打算使用外部RAM吗？多少钱？

您的固件真的需要在运行时处理字符串吗？例如，它是否通过串行端口或其他接口将命令作为字符串发送/接收？如果是这样，您应该尽可能将字符串处理与其余代码隔离开来，并在其他地方使用标记（枚举类型或#defined 整数常量）。如果没有，通过使用令牌而不是字符串，将逻辑放入处理器的受限内存中会少很多麻烦。

此外，如果您确实需要进行字符串解析，最好编写一个一次处理一个字符的状态机，这样您就不必处理完整的字符串。同样，128 字节对于字符串处理来说并不是很多空间。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-25T18:41:58.167

为什么不使用 C 字符串库？像[bstrlib](http://bstring.sourceforge.net/)或类似的？C++ 并不是您对这个微控制器所需要的。

# iphone - 有没有办法将像 CGPoint（或任何自己创建的）这样的标量类型放入 NSArray？

> ID：899640
> 
> 赞同：0
> 
> 时间：2009-05-22T19:42:27.193
> 
> 标签：iphone, cocoa-touch, uikit, nsarray

可能我可以创建一个将 CGPoint 作为实例变量的类，就像一个包装器一样。那有意义吗？不过，我对此感到不舒服。我希望有更好的解决方案。

任何自创的标量类型怎么样？喜欢 MyCoolScalarType？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T20:37:33.820

让它成为一个对象。你可以试试这个：

```
CGPoint point = CGPointMake(1.f,1.f);

[NSValue valueWithCGPoint:point]; 
```

这几乎适用于您想要放入 NSArray 的每个标量：

```
CGFloat foo = 1.f;

[NSNumber numberWithFloat:foo]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T19:45:20.243

[NSValue](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSValue_Class/Reference/Reference.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T20:20:26.257

您可以将 CGPoint 值装箱到 NSValue 对象中。它记录在[NSValue UIKit Additions Reference](http://developer.apple.com/iphone/library/documentation/uikit/reference/NSValue_UIKit_Additions/Reference/Reference.html)中。

# c# - 如何以编程方式创建矩形/按钮并使其沿曲线路径动画？

> ID：899648
> 
> 赞同：0
> 
> 时间：2009-05-22T19:43:58.563
> 
> 标签：c#, .net, wpf, animation, button

WPF：如何以编程方式创建矩形/按钮并使其沿曲线路径设置动画？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T21:00:46.160

只需将其粘贴到 Window1 类中的 Window1.xaml.cs 文件中，从[Here](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.matrixanimationusingpath(VS.85).aspx)中获取示例，玩得开心！

```
Storyboard pathAnimationStoryboard;

        public Window1()
        {
            InitializeComponent();

            this.Margin = new Thickness(20);

            // Create a NameScope for the page so that
            // we can use Storyboards.
            NameScope.SetNameScope(this, new NameScope());

            // Create a button.
            Button aButton = new Button();
            aButton.MinWidth = 100;
            aButton.Content = "A Button";

            // Create a MatrixTransform. This transform
            // will be used to move the button.
            MatrixTransform buttonMatrixTransform = new MatrixTransform();
            aButton.RenderTransform = buttonMatrixTransform;

            // Register the transform's name with the page
            // so that it can be targeted by a Storyboard.
            this.RegisterName("ButtonMatrixTransform", buttonMatrixTransform);

            // Create a Canvas to contain the button
            // and add it to the page.
            // Although this example uses a Canvas,
            // any type of panel will work.
            Canvas mainPanel = new Canvas();
            mainPanel.Width = 400;
            mainPanel.Height = 400;
            mainPanel.Children.Add(aButton);
            this.Content = mainPanel;

            // Create the animation path.
            PathGeometry animationPath = new PathGeometry();
            PathFigure pFigure = new PathFigure();
            pFigure.StartPoint = new Point(10, 100);
            PolyBezierSegment pBezierSegment = new PolyBezierSegment();
            pBezierSegment.Points.Add(new Point(35, 0));
            pBezierSegment.Points.Add(new Point(135, 0));
            pBezierSegment.Points.Add(new Point(160, 100));
            pBezierSegment.Points.Add(new Point(180, 190));
            pBezierSegment.Points.Add(new Point(285, 200));
            pBezierSegment.Points.Add(new Point(310, 100));
            pFigure.Segments.Add(pBezierSegment);
            animationPath.Figures.Add(pFigure);

            // Freeze the PathGeometry for performance benefits.
            animationPath.Freeze();

            // Create a MatrixAnimationUsingPath to move the
            // button along the path by animating
            // its MatrixTransform.
            MatrixAnimationUsingPath matrixAnimation =
                new MatrixAnimationUsingPath();
            matrixAnimation.PathGeometry = animationPath;
            matrixAnimation.Duration = TimeSpan.FromSeconds(5);
            matrixAnimation.RepeatBehavior = RepeatBehavior.Forever;

            // Set the animation to target the Matrix property
            // of the MatrixTransform named "ButtonMatrixTransform".
            Storyboard.SetTargetName(matrixAnimation, "ButtonMatrixTransform");
            Storyboard.SetTargetProperty(matrixAnimation,
                new PropertyPath(MatrixTransform.MatrixProperty));

            // Create a Storyboard to contain and apply the animation.
            pathAnimationStoryboard = new Storyboard();
            pathAnimationStoryboard.Children.Add(matrixAnimation);

            // Start the storyboard when the button is loaded.
            aButton.Loaded += new RoutedEventHandler(button_Loaded);
        }

        void button_Loaded(object sender, RoutedEventArgs e)
        {
            pathAnimationStoryboard.Begin(this);
        } 
```

# ms-access - 如何获得约束的名称？

> ID：899655
> 
> 赞同：0
> 
> 时间：2009-05-22T19:45:05.737
> 
> 标签：ms-access, jet, constraints

我正在使用 MS Access 数据库并尝试从 C# 2.0 获取完整数据。如何使用 ADOX 获取约束名称（例如：Primarykey 的名称而不是主键的字段名称）。

提前感谢马杜

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T20:09:02.817

来自：[如何使用 ADOX 确定表上是否存在主键](http://support.microsoft.com/kb/258013)

```
SQL = "CREATE TABLE PKTEST1 (f1 INT PRIMARY KEY, f2 INT)"
cn.Execute SQL

Set cat.ActiveConnection = cn

'Check all indexes on the table for a primary key'
For Each idx In cat.Tables("PKTEST1").Indexes
        If idx.PrimaryKey = True Then
        Debug.Print "INDEX  NAME: " & idx.Name

        'Show all columns that make up the index'
        Debug.Print "consists of the following columns:"
        For i = 0 To idx.Columns.Count - 1
            Debug.Print idx.Columns(i).Name
        Next

    End If

Next 
```

# python - 将 PyQwt 与 py2exe 捆绑在一起

> ID：899658
> 
> 赞同：2
> 
> 时间：2009-05-22T19:46:12.690
> 
> 标签：python, pyqt, py2exe

我有一个 py2exe 的标准设置脚本，我将基于 PyQt 的应用程序捆绑到 Windows .exe 文件中。

今天我尝试了一个使用 PyQwt 模块的简单脚本，它似乎不起作用。py2exe 运行正常，但是当我执行它创建的 .exe 时，它​​将以下内容转储到日志文件中并且不运行：

```
Traceback (most recent call last):
  File "qwt_test.pyw", line 5, in <module>
  File "zipextimporter.pyo", line 82, in load_module
  File "PyQt4\Qwt5\__init__.pyo", line 32, in <module>
  File "zipextimporter.pyo", line 98, in load_module
ImportError: MemoryLoadLibrary failed loading PyQt4\Qwt5\Qwt.pyd 
```

当我在目录中查找时`PyQt4\Qwt5\`，`build\bdist.win32\winexe\collect-2.5`肯定`Qwt.pyd`存在。

我似乎无法在网上找到有关此错误的任何有用信息。什么可能导致它？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T07:30:49.307

py2exe 不是将 Python 应用程序的 exe 文件放在一起的唯一方法，也许也不是最好的方法——特别是，它几乎不支持 pyqt。请，我恳求你，检查[PyInstaller](http://www.pyinstaller.org/)，它确实知道 PyQt（以及 Linux 和 Mac，如果你在乎的话......）——只要确保你使用 SVN 头结帐，而不是“发布”版本，它在这个时间已经严重过时了（这个问题希望很快就会消失......）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T17:16:14.133

一些选项：

1.  尝试使用 py2xe `bundle_files options`(3, 2, 1) （特别是如果您将它们全部放在一个大库 zip 中，一些 dll 不喜欢这样）。
2.  `msvcp71.dll`确保在 windows\system32 或可执行文件的目录中存在的副本。
3.  尝试明确排除 dll（将 Qwt.pyd 添加到`dll_excludes`选项中，并（在构建后）将 Qwt.pyd（和 _Qwt.pyd，如果存在）复制到您的可执行路径。

# build-process - 在构建 linux 内核时了解要编译的文件

> ID：899659
> 
> 赞同：2
> 
> 时间：2009-05-22T19:46:12.817
> 
> 标签：build-process, makefile, linux-kernel

我想知道是否有可能在配置内核后知道哪些文件将被编译以及以什么顺序编译？

我想知道这一点，因为我对根据架构的构建过程的变化感兴趣，并且我不想拥有与架构一样多的工具链......

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T20:07:27.453

完全重新编辑：

您可以修改内核源代码中的 Make 进程以使用

```
-n, --just-print, --dry-run, --recon 
```

这样做的最终结果是永远不会调用编译器或任何可执行文件。它只是伪造它并告诉你它*会*做什么。

选项并从中 grep 文件而不构建源代码。这可能就像在 shell 中设置 MAKE 环境以使用上述选项一样简单。然后只需 grep 出所有涉及 .c 和 .h 文件的编译器命令。下载 2.6.29.2 的内核源代码以了解如何执行此操作。编辑来。

**祝你好运**

回复你的进展情况。也许发布shell脚本！:)

**跟进**：

2.6.29.2 内核源代码的第 13 行包含在 /2.6.19.2/Makefile

```
# Do not:
# o  use make's built-in rules and variables
#    (this increases performance and avoids hard-to-debug behaviour);
# o  print "Entering directory ...";
MAKEFLAGS += -rR --no-print-directory

# We are using a recursive build, so we need to do a little thinking
# to get the ordering right. 
```

编辑`MAKEFLAGS`变量以包含 dryrun 标志*应该*允许您保存特定 make 配置的输出，然后再 grep 它。ala make > save.txt

我把我的改成

```
MAKEFLAGS += -rR --no-print-directory --just-print 
```

例如（可能会更好）：

```
[aiden@host linux-2.6.29.2]$ \
make > build_out.txt; grep -o -E "[a-zA-Z0-9_-]+\.[ch]" build_out.txt 
```

不完美，但以一种骇人听闻的方式为我工作，应该让你继续前进。相同的基本过程有望通过配置内核的盲目制作。

**警告** 如果不维护特定于体系结构的工具链或在目标体系结构上运行 Make，某些 ASM 和体系结构特定文件会与真正的构建有所不同。

**从评论编辑**

要抑制 ld 失败，您需要在内核 make 文件中找到以下部分（或类似部分）。

```
# Make variables (CC, etc...)

AS              = $(CROSS_COMPILE)as
LD              = $(CROSS_COMPILE)ld
CC              = $(CROSS_COMPILE)gcc
CPP             = $(CC) -E
AR              = $(CROSS_COMPILE)ar 
```

您需要先运行配置步骤来配置源代码，然后再尝试枚举前面步骤中使用的源文件（从空运行中进行管道和 grepping），因此您可以在`Makefile.enum`运行正常配置后进行编辑并使用它步骤（无论架构如何，都需要生成一些 config.h 类型的文件。因此，将内核源代码获取到您将要进行实际编译、模块和所有内容的地步）。哇！

现在，当您进行伪造以枚举源文件时，发布内核源配置（指定驱动程序/模块等）LD 将失败，正如您所发现的那样。您可以从

```
LD              = $(CROSS_COMPILE)ld 
```

至

```
LD              = -$(CROSS_COMPILE)ld 
```

注意“-”字符。这告诉 Makefile 忽略警告。显然，您尝试做的事情是不寻常的，但非常酷:) 可以通过查找 Makefile 部分并调整执行的命令来抑制进一步的错误。我建议您对 Makefiles 非常友好，因为您可能需要稍后更改 IF 语句。整理完所有内容后，您将拥有一个“哑”的 makefile，它将吐出 .c 文件，因此您可以执行

```
make | grep -E "[a-zA-Z0-9_-]+\.[ch]" 
```

管他呢。

我还有一个很酷的建议来验证你的结果......实际构建内核......但使用 Linux 的 inotify API（你可以在此处获取 Python 绑定[http://pyinotify.sourceforge.net/](http://pyinotify.sourceforge.net/)）并注意文件系统事件编译窗口（例如 gcc 正在读取的 .c 文件）。然后将其与“哑”makefile 中的列表进行比较。

好吧，我希望这不是太多的华夫饼！**祝你好运**

# ruby - Ruby DSL（领域特定语言）存储库，示例

> ID：899665
> 
> 赞同：16
> 
> 时间：2009-05-22T19:48:04.467
> 
> 标签：ruby, dsl

我正在寻找 Ruby DSL（领域特定语言）的优秀示例。您知道哪些存储库、项目值得一读？为什么它（或：它们是）很好的例子？

我对经过深思熟虑和设计的更复杂的示例特别感兴趣。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-22T19:55:51.987

Rake 和 Rack 是 DSL 的一些很好的例子。如果您想要更多示例，请查看以下内容：

*   [Sinatra](http://sinatrarb.com)是一种非常流行的用于构建 Web 应用程序的 DSL，它在 GitHub 上是开源的。
*   [Twibot](http://github.com/cjohansen/twibot/tree/master)是受 Sinatra 启发的一种较新的 DSL，可让您创建自动响应消息和回复的 Twitter 机器人。

如果您想开始自己制作，这里有一个名为[Building a DSL in Ruby](http://www.jroller.com/rolsen/entry/building_a_dsl_in_ruby)的优秀教程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-10-27T02:29:07.937

在行为驱动开发领域，您可以查看：

*   [Cucumber](http://github.com/cucumber/cucumber) - 使用场景描述 BDD
*   [RSpec](http://github.com/dchelimsky/rspec) - 用指定的行为替换测试代码。

虽然我不得不承认 RSpec 代码有时让我摸不着头脑，因为我还是个新手。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-09T19:50:24.570

当然，另一个例子是[Rake](http://rake.rubyforge.org/)，Ruby 构建系统。在我看来，是什么让 DSL “好”：

1.  符号符合意义，即如果您阅读 DSL 中的一个句子（陈述），您对它的作用有一个清晰、明确的概念。
2.  特定领域，即 DSL 并不能解决宇宙中的所有问题，而是专注于一个小领域（例如构建软件、查询数据或构建 UI）
3.  高级抽象。DSL 使用程序员可以使用的高级概念，并将这些概念转换为较低级别的实现（内部）。在 Rake 的情况下，该语言所基于的主要概念是任务和它们之间的依赖关系。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-31T18:29:40.677

您是否检查过[Docile gem](http://ms-ati.github.com/docile/)，它可能是满足您需求的最简单和最干净的方式？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T19:53:34.813

我能想到的一些好的 ruby​​ DSL 是 [hpricot](http://github.com/why/hpricot/tree/master) 和 [sinatra](http://www.sinatrarb.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T11:08:38.883

Ruby on Rails 的 Active Record 是一种 DSL！

[http://apidock.com/rails/ActiveRecord/Base](http://apidock.com/rails/ActiveRecord/Base)

此外，代码学校的这一集可能会很有趣，因为它会导致构建 DSL（在那里我了解到 Active Record 是 DSL）

[http://www.codeschool.com/courses/ruby-bits-part-2](http://www.codeschool.com/courses/ruby-bits-part-2)

上述课程还讨论了外部和内部 DSL。Cucumber 是一个外部 DSL 示例，您需要在其中构建解析器和编译器等。Active Record 是在一些现有代码中运行的内部 DSL 示例。

# jaxb - 如何使用 jaxb.in dex 文件？

> ID：899668
> 
> 赞同：26
> 
> 时间：2009-05-22T19:49:18.740
> 
> 标签：jaxb

我越来越

```
javax.xml.bind.JAXBException: "org.example.mypackage" doesnt contain ObjectFactory.class or jaxb.index 
```

在尝试创建`JAXBContext`using时`JAXBContext.newInstance(String contextPath)`。我猜有一种“通常”的方式来创建和维护一个 jaxb.in​​dex 文件。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2010-12-22T02:35:43.960

jaxb.in​​dex 文件只是包含包中具有 JAXB 注释的类的列表。

文件中的每一行都是一个类的简单名称，而不是它的完全限定名称。

你可以在这里阅读更多：http: [//cmaki.blogspot.com/2007/09/annotated-jaxb-classes.html](http://cmaki.blogspot.com/2007/09/annotated-jaxb-classes.html)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-06-03T16:04:42.140

试试这个方法

```
JAXBContext context = JAXBContext.newInstance(new Class[] {your.package.Test.class}); 
```

此外，请确保您已添加`@XmlRootElement`到 Test 类。

```
@XmlRootElement
class Test {
  private String ...;
  private int ......;
} 
```

还要确保您使用的是 java 1.5

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-05T00:01:25.180

确保您将正确的类传递给该方法。假设您的 XML 根元素是 XMLRoot，您可以将其称为：

```
JAXBContext context = JAXBContext.newInstance(XMLRoot.class); 
```

还要确保您使用正确版本的 JAXB 编译器 (xjc) 来运行您正在运行的 Java 版本。来自旧编译器的 JAXB 生成的类无法与 Java 6 的 JAXB 一起正常工作，从而产生相同的错误。

# asp.net-mvc - 在 MVC 中使用 Html Helper 动态添加 onclick

> ID：899669
> 
> 赞同：0
> 
> 时间：2009-05-22T19:49:25.523
> 
> 标签：asp.net-mvc, html-helper

我需要能够使用 HTML Helper 动态设置 onclick。以下是我正在尝试做的事情，但我得到了一个明显的语法错误

```
<%=Html.CheckBox("checkboxname", item.Id = 3, New With {.onclick = "ajaxThis(this, <%= Html.Encode(item.ID) %>, '<%= Html.Encode(item.NUMBER) %>');"})%> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T19:55:24.203

第一步是从 <%= Html.Encode(item.ID) %> 中删除 <%= %> 并直接调用 Html.Encode(item.ID) 。对 item.NUMBER 编码执行相同的操作。

就像是：

```
"ajaxThis(this, " + Html.Encode(item.ID) + ", '" + Html.Encode(item.NUMBER) + "');" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T19:55:53.360

您正在输入一个字符串，因此只需连接字符串即可：

```
<%= Html.CheckBox("checkboxname", item.Id = 3, New With {.onclick = String.Concat("ajaxThis(this, ", Html.Encode(item.ID), ", '", Html.Encode(item.NUMBER), "');")})%> 
```

但是，只添加一个 css 类并使用[jQuery](http://www.jquery.com/)连接一个事件处理程序可能会更容易。

# java - Java中的JFrame

> ID：899670
> 
> 赞同：5
> 
> 时间：2009-05-22T19:49:27.973
> 
> 标签：java, swing, jframe

我使用 JFrame 作为主框架的弹出窗口，用户应该在其中输入一些信息，然后按 OK。但问题是，一旦这个子框架打开，我希望程序忽略任何其他信号，直到按下 OK 按钮，类似于使用 JOptionPanes 完成的方式。像现在这样，你可以多次点击按钮打开子帧，从而得到几个帧，这不是本意（甚至会导致很多错误）。

一旦按下 OK 按钮，我可以用一个布尔值来解决它，但这似乎不是一个很酷的修复方法。我觉得必须有其他方法可以做到这一点，因为我可以看到来自我的 JOptionPanes 的广受欢迎的效果，但无法实现。

干杯。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T19:52:19.060

你需要一个[`JDialog`](http://java.sun.com/javase/6/docs/api/javax/swing/JDialog.html)with [`modal = true`](http://java.sun.com/javase/6/docs/api/javax/swing/JDialog.html#JDialog(java.awt.Frame,%20boolean))。来自 Javadocs：

> `modal`- 指定对话框在显示时是否阻止用户输入到其他顶级窗口。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-22T19:58:03.573

只需将 更改`JFrame`为`JDialog`.

然后在构造函数中使用这一行：

```
setModal(true); 
```

然后，您的应用程序将被阻止，直到对话框关闭。

如果您[`JOptionPane.showInputDialog()`](http://www.cse.yorku.ca/labtest/common/java/api/javax/swing/JOptionPane.html#showInputDialog(java.awt.Component,%20java.lang.Object))的用户只是输入一个`String`.

# asp.net - 在 ASP.Net 应用程序中使用 WCF 和最佳实践

> ID：899674
> 
> 赞同：14
> 
> 时间：2009-05-22T19:50:34.820
> 
> 标签：asp.net, wcf

我对 WCF 完全陌生。我很确定它会像常规 Web 服务一样工作——而且我也很确定我做错了，但现在我想确保我做对了。

我们的 ASP.Net 应用程序通过 Internet 连接到 WCF 服务。我已经实现了基本的安全性并使用了 SSL。它正在工作，但比我们使用常规 Web 服务时要慢。返回的数据与常规 Web 服务基本相同。

当我使用常规的 Web 服务时，每当我需要获取数据时，我都会创建一个新的服务对象并为我需要的数据调用该函数。这似乎工作正常，但正如我想象的那样，这不是最好的方法，特别是如果有成千上万的用户同时连接。因此，当我转换为 WCF 时，我决定让一个客户端保持打开状态，并将其用于连接到该站点的每个人。我把它放在缓存中，当缓存转储对象时，我有一个回调函数来处理它。

现在我什至没有想到它，直到我改变了这一切，这可能会给多人连接带来问题。如果人员 A 请求数据，则人员 B 必须等待其完成，然后才能通过服务获取他们的数据。

所以我把它改成基于会话的。我要么实施了这个错误，要么适得其反，因为它根本无法正常工作。客户端会超时，导致错误，或者根本无法工作。我现在把它改回缓存，它似乎工作正常（除了慢）。

这种情况的“最佳实践”是什么？我是在需要时动态创建客户端，创建一个基于会话（并找出我做错了什么），还是保持原样并使用一个客户端缓存方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T20:13:23.730

这类问题通常通过维护一个池来解决。池不是在一个极端只有一个服务对象，在另一个极端每个用户都有一个服务对象，而是将保存一组服务对象，这些服务对象需要支持对其服务的并发需求。因此，池应该只增长到最大需求点。

您将确保对象在服务对象内部的任何其他超时之前从池中退出，并确保它们在出现任何类型的异常时退出。

这样，您就不会有多个客户端请求等待访问单个对象，也不会有空闲对象挂在服务中，并且很可能在它们可以再次重用之前死于老年。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T08:55:00.470

WCF 服务的一般最佳实践是尽可能使用每次调用的单实例模型。这为您提供了服务实例中的最佳吞吐量、最佳和最简单的行为。所以只要有可能，除非你有一个真正令人信服的理由，否则请使用这个模型。

在您的情况下，创建服务实例似乎是一项相当昂贵的操作。也许您需要以某种方式清理它 - 使实际的服务实例非常精简和轻量级，以便可以在眨眼间（或更短时间）创建和处置它，然后有一些后台工作进程（或者可能是一个池其中，正如 Anthony 所建议的那样），然后您可以从您的实际服务实例中调用它们。

马克

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T20:06:37.847

正如您所提到的，我通常会即时创建一个客户端，但请确保在请求完成后将其处理掉。我已经完成了这项工作而没有遇到很多问题，但老实说，我没有 1000 多个用户同时使用完全相同的服务。

[如果您有兴趣，可以在这篇](http://www.iserviceoriented.com/blog/post/Indisposable+-+WCF+Gotcha+1.aspx)博文中找到确切的实现细节。

只是为了澄清您在问题中提到的内容-当您说“常规 Web 服务”时，您是在谈论 ASMX 还是？

# c# - 如何在 LINQ(-to-XML) 中拆分属性值？

> ID：899694
> 
> 赞同：1
> 
> 时间：2009-05-22T19:55:32.017
> 
> 标签：c#, .net-3.5, linq-to-xml, delicious-api

我一直想开始用我美味的书签和 LINQ to XML 做一些有趣的事情，我想知道是否有办法*在*LINQ 中拆分标记属性。

我*在 LINQ 中拆分标签的*意思是为每个 post 元素生成一个字符串集合，因此预期的结果将是一个通用的`post`元素集合，其属性作为属性，其中`tag`属性本身就是另一个字符串集合，它的项目是每个标签。

对于那些对delicious.com 导出的 xml 不太熟悉的人，这里是元素的基本结构：

```
<post
    href="http://stackoverflow.com/"
    hash="e4a42d992025b928a586b8bdc36ad38d"
    description="Stack Overflow"
    tag="code development programming community tips answers reference"
    time="2009-05-22T19:44:09Z"
    extended="Stack Overflow is a programming Q & A site that's free."
    meta="e0bf85c9df073cd51cc5528637db5277"
 /> 
```

这是我正在使用的代码片段：

```
 XDocument delicious = XDocument.Load("all.xml");

  var bookmarks = from posts in delicious.Descendants().Attributes("tag")
                  select (string)posts; 
```

任何想法、建议、评论将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T20:13:18.410

string 类有一个 Split 方法。
这是你想要的？

编辑： string.Join(Environment.NewLine, bookmarks.ToArray());

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T20:43:13.497

你想要的输出实际上是什么样的？您想要“标签”字段中每个值的数组吗？

```
var bookmarks = from posts in delicious.Descendants().Attributes("tag")
                    select ((string)posts).Split(" "); 
```

这会给你一个数组列表。很难说如何完成你想要的，因为它没有很好地指定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T12:58:21.073

我所做的是使用'set'并将值分配给该变量，然后使用set继续操作，所以最后我能够在我的linq查询中使用它，因为它的形式是现在对我有用。:)

# culture - 公司的盗版软件？

> ID：899699
> 
> 赞同：47
> 
> 时间：2009-05-22T19:56:18.413
> 
> 标签：culture

我最近在美国的一家小型 Web 开发商店任职，几乎每天使用的所有软件都被破解。我自己的 IDE 是付费的，在那里我个人使用开源软件，但我仍然需要使用 MS Office 和各种 Adob​​e 产品。

由于种种原因，我找到了一份新工作，但我很好奇。这个社区对交出纵容使用被盗软件的公司有何感想？我应该立即报告他们，还是继续前进？个人决定使用被盗软件是一回事，但*要求*您的员工效仿又如何呢？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-05-22T20:02:24.233

我将首先探讨有关这种做法的“权力”。如果他们拒绝听，请将其交给 BSA 或您所在地区的任何处理此事的人。

销售产品的公司期望为该产品获得报酬。我敢肯定，如果鞋子是在另一只脚上（即公司的产品*被*盗版），他们会追究它。认为您可以销售产品但欺骗他人的产品是愚蠢的。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-22T20:01:28.433

只要不影响您，他们使用的东西与您无关。如果你的个人工作场所是100%合法的，他们不会要求你使用盗版软件，给你工资，只是工作，不要想太多。

如果他们要求您使用盗版软件，您有两种选择，要么同意并成为同谋，要么拒绝。如果在后一种情况下您被解雇，那么您可以通过法律途径要求赔偿损失的时间、收入和其他损失。

你走出了那里，做了正确的事。享受生活。

补充：公司翻身的道德问题并不是那么容易。道德因文化而异。在一些国家（主要是西方文明国家），将每一个违法行为（甚至在家庭/父母/子女内部）传达给当局是一种正常的做法。在其他国家/地区，这可能被认为是一种高度不道德的行为，演员失去了他的面子/对他人的尊重，在某些情况下甚至冒着报复的风险（如果你的行为最终会毁了他们的生意，请认真考虑一下）。我个人会考虑中立立场。如果他们不要求您亲自使用盗版软件并且他们对您很好，请以实物回应。如果他们要求您使用它，您拒绝并且他们将您赶出去，那么您可以接近他们并要求整个期间的赔偿，直到您找到另一个地方。如果他们不认真对待，那么您可以考虑是否值得麻烦（例如，您搬到另一个城镇，租了一个公寓，现在您已经离开了）或不值得（您只接受其他工作中的一个）希望有）。无论如何，决定权在你。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-22T19:59:15.863

我处于那种情况，但决定不交出他们，因为我不确定我是否做出了公正的决定。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-22T20:00:18.403

如果他们先推，我只会说闲话，即他们强迫我使用他们的盗版软件或面临纪律处分。我个人对软件盗版没有意见，这在我们工作的行业中是不争的事实。但是在这个时代，一个公司强迫你使用他们非法获得的软件，当时有这么多可行的开放源替代品，就是有点多。

如果他们只是说，“在这里，如果你愿意，可以使用这个非法下载的软件”，如果我愿意，让我使用其他软件，我会继续前进，忘记他们。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-05-22T20:32:26.310

我曾经遇到过这种事情，我的解决方案一直是越过我的管理层提出一个“无辜”的问题，以确保它一直被高层知晓。

当被要求参与一项欺诈供应商的计划时，我给公司的律师发了电子邮件，询问他们是否认为我应该承担刑事责任，如果是，他们是否愿意为我的辩护付费。

当然，这样做是在要求被解雇。在这种情况下，它是一家足够大的公司（以数十亿美元的市值公开交易），我积累了足够的政治资本，这使他们能够纠正他们的行为并增加我的奖金。但我没有指望这一点。

如果它已经众所周知，那么您必须决定是否认为盗版软件更不道德或成为老鼠。在我处理过这类事情的情况下，我只是确保高层管理人员知道该政策。同样在我给公司的律师发电子邮件的情况下，我被要求成为一名积极的参与者，并且整整一年都在抱怨这种情况。我不只是被要求换个方向看。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-05-22T20:02:01.460

我的意见是举报。在公司层面，如果他们想使用该软件而不是在评估情况下，他们应该为它付费，简单明了。BSA 有一个很好的匿名举报机制，你可以获得奖励。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-05-22T20:36:03.543

这是一个简单的答案。公司正在做一些不同于我性格和信仰的事情。我只有在交易中诚实和诚实才能在这一生中取得成就。

我要离开公司了。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-27T19:38:58.177

2001 年我在这样的地方工作过。我们是一家小型初创公司，为了钱等而受到伤害。我向我的老板提出了 SQL 和 IIS 服务器都是盗版的事实，而且我们没有许可证。两周后，我失去了工作，没有受到严重影响。我打电话给我的律师，他又打电话给我的老老板和他的老板，我得到了 4 周的停职。我的律师这样做是为了一个忙。

当我提出这个问题时，我对我的老板很冷静。我们正在寻找 VC，我认为如果我们在审计中失败，我们看起来就像是一家三流的网店。

长话短说，公司在我离开几个月后倒闭了，而我的老老板现在正在做房地产，考虑到当前的市场，我认为这对他来说效果不佳。这都是业力。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-22T20:00:23.023

如果这是一件不寻常的事情，我会放手；但是，您的案例更具系统性。该公司需要使用某些软件这一事实是最能说明问题的。

我会给那家公司一个警告，如果他们不听那个警告，然后把他们交给 BSA。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-22T20:34:11.283

相反，使用自由软件绝对是正确的方法。在我看来，阻碍自由软件被广大公众广泛接受的主要因素之一是公众对软件许可证缺乏尊重。如果每个人都突然开始遵守他们的软件许可条款和法律，微软的安装用户群可能会在一夜之间减少一半。

至于被迫使用未经许可的软件，那是个硬汉。确保每个人都明白他们要求您做的事情是非法的，并且您知道他们要求您违法（或帮助他们违法），这一点很重要。如果他们当时还坚持，当然正确的做法是当场退出。有孩子要养活和抵押贷款要支付的人们常常觉得他们必须做一些不那么激烈的事情。但我们都喜欢认为我们会做正确的事。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-23T00:26:10.740

我不确定我是否会处理将它们“报告”给 BSA，因为文化问题以及因为 BSA 和 RIAA 一样，在正当理由下做恶。

话虽如此，作为一名软件开发人员，我可能更无私（或天真），而且我对软件公司获得报酬感到更加敏感。更多的软件盗版意味着我们很多人的工作更少，工资更低，间接地对我自己来说。我觉得大多数软件公司使用的商业软件定价合理，而且像 MS 这样的大公司最近在许可和定价方案中对小商店的需求而不是大企业的需求更加敏感。许可大多数典型软件的成本应该是员工成本的一小部分。

此外，如果一个人不喜欢使用主要产品，还有足够的可接受的替代品。如果我经营一家从事 .NET 开发的公司，我希望为 .NET 付费。

还有更便宜的替代品。我认为大多数普通开发人员需要生成的 PDFS 可以在没有 adobe 的情况下创建，还有更便宜的替代品。因此，也许解决方案是限制可用软件的数量并为此付费。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-05-23T00:53:16.830

我会采取中间的方法：这是否代表销售失败？我很难被不代表销售损失的盗版所困扰。

因此，如果公司处于亏损状态，将其推向更深的亏损状态，可能会倒闭有什么好处吗？但是，如果他们是体面的黑色，那么报告的情况就会变得更加强大。

由于这显然是一个政府机构，因此不会因为为其软件付费而被迫停业，而且我认为政府应该遵守更高的标准。报告它。

编辑：我*不是*说这是对的，我是说如果没有丢失的销售，我不认为这是一个大错。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-27T18:57:47.277

我会退出，很明显。

不过我不会把它们交出来。我没有什么可以获得这种方式的。只会制造不好的感觉，可能会浪费时间与警察交谈或在审判中作为证人。

所以，对我来说，最高期望值的计划是：1）出去 2）忘记它 3）把我的时间花在富有成效的事情上

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-23T00:12:57.380

除了“这是一个政府机构”之外，我无法确定我在哪里工作。

让我大吃一惊的是，我们 IT 部门的许多人（？也许是大多数人？）每天都在非法使用某些软件……从文本编辑器到 RDBMS 无所不包。

虽然我在家里使用的大部分软件都是“有问题的血统”，但我在工作中使用的软件都没有一个是“灰色”的。

如果我使用你们的产品来谋生，那么我绝对有责任确保你们从我们共同劳动的成果中获得公平的份额。没有工具，好的工具，我就无法完成我的工作。我为我的工具买单，我为好的工具买单，就像木匠一样。

DeWalt 钻头的成本是“同等”Back&Decker 的十倍，这是有充分理由的。DeWalt 可靠地工作！这对我和我的客户来说都是物有所值的。

你会容忍木匠从 ToolCity “偷”钻头吗？为什么或者为什么不？

你会容忍一个程序员从 Borland “偷”一个编译器吗？为什么或者为什么不？

你会容忍饥饿的农民从国王公园“偷”鹿吗？为什么或者为什么不？

有什么区别？

如果大多数人认为偷钻头“足够公平”，你认为钻头制造商会发生什么？谁会先破产？DeWalt 还是 Back & Decker？

干杯。基思。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-27T19:54:43.417

这些必须做更多的音乐，但它们在盗版方面是截然不同的想法：

[http://www.youtube.com/watch?v=KUgB0hNf0bs](http://www.youtube.com/watch?v=KUgB0hNf0bs)

[http://www.youtube.com/watch?v=-LkWKvMCzqA&NR=1](http://www.youtube.com/watch?v=-LkWKvMCzqA&NR=1)

请享用 ：）

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-05-23T00:08:34.567

只要公司没有做任何危害您、危害他人或使您面临法律风险的事情（并且使用公司提供的软件，无论多么不正当，都不会使您个人处于危险之中）我认为这是公平的公司的人提出要求，把他们交上来是卑鄙和卑鄙的。对不起，但我们可以说任何我们想要的道德和道德的东西，但最终就像你妈妈告诉你的那样一个孩子——没有人喜欢流言蜚语。

现在，如果您的公司要求您使用非法软件，而您已经表达了反对意见，并且您对这些反对意见感到强烈，而公司选择忽略它们，那么您也应该考虑离开公司——不是因为软件，但因为你的公司显然不尊重你。

# c# - ASP.NET 按钮不显示参数

> ID：899700
> 
> 赞同：1
> 
> 时间：2009-05-22T19:56:35.090
> 
> 标签：c#, asp.net, iis-7, parameters

我的本地机器似乎有问题。

当加载一个上面有按钮的页面，并且按钮已经使用标题中的参数设置时，在我的本地机器上参数消失了，但在我们的开发框上它们仍然存在。

这很难解释，所以我会用一张图片来展示。

这是我用鼠标悬停在按钮上时的样子，来自我们的开发服务器，即 II7：

[替代文字 http://members.generationdub.com/footose/params.jpg](http://members.generationdub.com/footose/params.jpg)

这与我的本地机器（也运行 IIS7）上的代码完全相同，但正如您所见，按钮上没有“设置”参数。

[替代文字 http://members.generationdub.com/footose/noparam.jpg](http://members.generationdub.com/footose/noparam.jpg)

这可能是什么原因造成的，我该如何解决？web.config 是相同的，所以我认为这可能是 IIS 问题？

# sharepoint - 在没有 smtp 服务器的情况下测试从 SharePoint 发送电子邮件

> ID：899701
> 
> 赞同：2
> 
> 时间：2009-05-22T19:57:22.293
> 
> 标签：sharepoint, email

我正在尝试测试 SharePoint 的电子邮件发送 - 无论是基本警报还是自定义代码（调用 SPUtility.SendEmail）。我尝试按照此处所述指定 smtpDeliveryMethod="pickup"：[ASP.NET 的隐藏功能，](https://stackoverflow.com/questions/54929/hidden-features-of-asp-net/75170#75170)但它似乎不起作用。

有没有人用这种方法来测试 Sharepoint 的电子邮件是否正常工作？有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T20:09:34.220

我正在使用 Antix SMTP Server for Developers 来测试我的电子邮件。这是一个不发送任何真实电子邮件的虚拟 SMTP 服务器。但是您仍将 SharePoint 环境配置为将其用作 SMPT 服务器，因此您将获得一个非常现实的场景。

网址：[http ://www.antix.co.uk/Projects/SMTPServerForDevelopers.aspx](http://www.antix.co.uk/Projects/SMTPServerForDevelopers.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-09T16:25:11.590

我一直在使用 smtp4dev：[http ://smtp4dev.codeplex.com/](http://smtp4dev.codeplex.com/)

# jquery - 如何使用/组合使用两种不同数据类型的 2 个 jquery 脚本

> ID：899702
> 
> 赞同：0
> 
> 时间：2009-05-22T19:57:32.980
> 
> 标签：jquery

托马斯一直在帮助我解决这个问题，我认为我们已经取得了一些真正的进展。这是修改后的代码。这应该做的是首先，获取我的查询字符串并将其传递给在数据库中解析和插入数据的服务器。当类方法返回成功时，JQ 函数应该使用来自服务器的消息回显一个 100% css 样式的 div (id=message)。它也可以返回失败消息。这条消息是导入的？？与 json。我可以在 FF 控制台中看到该消息，但在浏览器中看不到该消息。

我遇到的另一个问题是页面上的每个 div 都附加了 id=message 。

编辑：

```
$.ajax({
    type: "POST",
    url: "body.php?action=admCust",
    data: dataString,
    success: function(data){
        $('#admCust input[type=text]').val('');
        var div = $('<div>').attr('id', 'message').html(data.message);
        if(data.success == 0) {
            $(div).addClass('error');
        } else {
            $(div).addClass('success');
        }
        $('body').append(div);
        $(div).show();
      }
});
return false; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T04:30:32.383

试试这个代码（因为它最后有一个`return false;`我假设这是在提交函数或其他东西中，并且`dataString`是从其他地方填充的......）：

```
$.ajax({
    type: "POST",
    url: "body.php?action=admCust",
    data: dataString,
    dataType: 'json',
    success: function(data){
        $('#admCust input[type=text]').val('');
        var div = $('<div>').attr('id', 'message').html(data.message);
        if(data.success == 0) {
            $(div).addClass('error');
        } else {
            $(div).addClass('success');
        }
        $('body').append(div);
      }
});
return false; 
```

你最大的错误是你忘了指定一个`dataType`（我在我的例子中......）所以jQuery不知道服务器会返回什么格式。它只是假设它是一个字符串而不是 JSON 对象，因此您的`data`变量没有正确填充。您也不需要`show()`as 附加就足够了。

我对上面的内容进行了测试，并且它可以工作，假设再次`dataString`填充了其他地方并且 body.php 返回了一个有效的 JSON 字符串，其中包含一条消息和一个成功代码。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-22T20:02:33.627

不确定这是否是您所追求的，但据我了解您的问题，请执行以下操作：

```
$(function() {
    $('.error').hide();
    $(".admCustBtn").click(function() {
        $('.error').hide();
        var admCustRPSecPhone = $("input#admCustRPSecPhone").val();
        var dataString = '&admCustRptSumm='+ admCustRptSumm + '&admCustRptDtl='+ admCustRptDtl;
        $.ajax({
            type: "POST",
            url: "index.php",
            data: dataString,

            // add an input parameter named data
            success: function(data){
                $('#admCust input[type=text]').val('');

                // remove the alert box
                // alert( "Success! Data Saved");

                // add the success handling code from the other method
                var div = $('#message').attr('id', 'message').html(data.message);
                if(data.success == 0) {
                    $(div).addClass('error');
                } else {
                    $(div).addClass('success');
                }
                $(div).show();
              }
        });
        return false;
    });
}); 
```

编辑：重命名`$div`为`div`并将选择器更改为`'div'`from `'<div>'`。

EDIT2：修改选择器（`id="message"`在 html 中添加一个！），`$()`在变量周围添加 -wrappers `div`，并将`.append()`行更改为`.show()`命令。

# svn - 我怎样才能真正让 Subversion 忽略目录？

> ID：899713
> 
> 赞同：6
> 
> 时间：2009-05-22T19:59:25.317
> 
> 标签：svn

我想让 Subversion 始终忽略我的 NetBeans IDE 项目配置目录（“nbproject/”）及其所有项目的内容。我在 SVN 文档中读到，您可以在`~/.subversion/config`. 例如，在我的配置中，我有...

```
### Set global-ignores to a set of whitespace-delimited globs
### which Subversion will ignore in its 'status' output, and
### while importing or adding files and directories.
global-ignores = *.o *.lo *.la .class #*# .*.rej *.rej .*~ *~ .#* 
  .DS_Store *.log nbproject 
```

尽管`nbproject`在那里，SVN 并没有忽略它。它显示在状态报告中。有什么办法可以防止吗？

该`nbproject`目录确实以某种方式进入了存储库，但我将其删除。即使它不在存储库中并且不包含`.svn`目录，SVN 也拒绝忽略它。也许是因为它以某种方式在父目录的`.svn`目录中被注意到？

* * *

更新

我刚刚从 SVN 和文件系统中完全删除了它并重新创建了项目。现在 SVN 尊重忽略模式。我不知道为什么以前没有。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T20:13:46.990

请注意，配置文件中的忽略模式仅在您添加内容时生效。

如果您已经在 SVN 中拥有该项目，则需要在之后手动附加该属性。

如果您在存储库中有要忽略的目录，则需要在添加属性之前将其删除并清理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T20:11:09.147

我无法使用 svn 版本 1.6.2 (r37639) 重现此问题：不受版本控制的目录被忽略，因为它应该是。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T20:13:24.807

您还可以执行 svn propedit svn:ignore /path/to/dir，这将打开一个忽略文件。从那里只需输入 * 通配符，svn 应该忽略所有内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T20:19:24.373

我有同样的问题。忽略全局变量与上面完全相同，但由于 nbproject 已经处于颠覆状态，因此它出现在状态中。

做：

```
svn rm nbproject --keep-local 
```

那应该解决它。反正为我做了。

# iphone - 如何以编程方式确定是否发生了“touchUpInside”事件？

> ID：899714
> 
> 赞同：1
> 
> 时间：2009-05-22T20:00:17.500
> 
> 标签：iphone, cocoa-touch, uikit

似乎在用户触摸我的视图时是否会调用此方法：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];
    if ([touch view] == self && [touch tapCount] >= 1) {
        // do something...
    }
} 
```

我已经在 UIScrollView 中实现了这一点。UIEvent 的文档没有提及在与操作方法建立连接时在 Interface Builder 中可用的那些 touchUpInside、touchUpOutside 等事件。

实际上，我希望仅在其中一个“touchUpInside”事件上调用方法，而不是在任何类型的触摸上调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T20:07:40.993

你想要`touchesEnded:withEvent:`。`touchesBegan`当在 UIResponder 中开始触摸或一系列触摸时调用该方法；`touchesEnded`当这批触摸完成时（即您的用户停止触摸屏幕/抬起手指），该方法被调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-18T09:14:53.457

这就是我将 IBAction 链接到文本字段的方式：

```
[yourTextField addTarget:self action:@selector(your method:) forControlEvents:UIControlEventTouchUpInside]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T20:27:53.280

规范的方法是创建一个 IBAction 并将其连接到 InterfaceBuilder.app 中的 touchUpInside 事件。

每次 touchUpInside 发生时，都会调用您的 IBAction。

如果您在 IB 之外以编程方式创建，您仍然可以连接 IBAction。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-04-23T14:02:59.390

来自[UIControlEventTouchUpInside](https://developer.apple.com/documentation/uikit/uicontrolevents/uicontroleventtouchupinside?language=objc)的文档。

> 手指位于控件边界内的控件中的触摸事件。

AFAICS，您需要实施[`touchesEnded:withEvent:`](https://developer.apple.com/documentation/uikit/uiresponder/1621084-touchesended?language=objc).

```
 override func touchesEnded(_ touches: Set<UITouch>, with event: UIEvent?) {

        if let point = touches.first?.location(in: self), self.point(inside: point, with: event) {
            //didTouchUpInside
        }
    } 
```

> 如果您在不调用 super 的情况下覆盖此方法（一种常用模式），则您还必须覆盖其他用于处理触摸事件的方法，即使您的实现什么也不做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-02T00:07:34.797

Vadoff 的技术很简洁，但是不要忘记通过调用超级函数来清理触摸事件。这是完整的代码。

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {

    BOOL touchedUpInside = NO;
    if (self.isTouchUpInside) {
        touchedUpInside = YES;
    }

    [super touchesEnded:touches withEvent:event];    

    if (touchedUpInside) {
        // touched up inside
    } 
} 
```

# c# - 强制开发人员使用特定的构造函数

> ID：899725
> 
> 赞同：2
> 
> 时间：2009-05-22T20:02:15.250
> 
> 标签：c#, .net

我有以下课程

```
 public class UIControl
  {
    public string FName{ get; set; }
    public HtmlInputCheckBox SelectCheckBox { get; set; }
    public bool OverrideSelect { get; set; }

    //Want to throw an ApplicationExceptioh if developer uses this constructor and passes
    //chkSelect = null
    public UIControl(string sFieldName, HtmlInputCheckBox chkSelect)
    {
      this.FName= sFieldName;
      this.SelectCheckBox = chkSelect;
    }

    public UIControl(string sFieldName, HtmlInputCheckBox chkSelect, bool overrideSelect)
      : this(sFieldName, chkSelect)
    {
      OverrideSelect = overrideSelect;
    }
  } 
```

我想确保开发人员仅在 chkSelect 不为空时才使用第一个构造函数。

我想做一个：

```
throw new ApplicationException("Dev is using the incorrect constructor"); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-22T20:07:49.170

因此，您可以使用私有构造函数：

```
public UIControl(string sFieldName, HtmlInputCheckBox chkSelect) 
    : this(sFieldName, chkSelect, false, false)
{      
}    

public UIControl(string sFieldName, HtmlInputCheckBox chkSelect, 
     bool overrideSelect)      
    : this(sFieldName, chkSelect, overrideSelect, true)    
{      
}  

private UIControl(string sFieldName, HtmlInputCheckBox chkSelect, 
   bool overrideSelect, bool allowOverride)      
{      
    if ((!allowOverride) && (chkSelect == null)) 
         throw new ArgumentException(...);
    this.FName= sFieldName;      
    this.SelectCheckBox = chkSelect;    
    OverrideSelect = overrideSelect;    
} 
```

有很多变体，但作为一般规则，有较少特定的构造函数调用更具体的构造函数。例如，以下内容也适用于您的情况：

```
public UIControl(string sFieldName, HtmlInputCheckBox chkSelect)    
    : this(sFieldName, chkSelect, false)
{      
   if (chkSelect == null) throw ...
}    

public UIControl(string sFieldName, HtmlInputCheckBox chkSelect, 
     bool overrideSelect)    
{      
    this.FName= sFieldName;      
    this.SelectCheckBox = chkSelect;    
    this.OverrideSelect = overrideSelect;    
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T20:05:04.557

有什么难的？

```
public UIControl(string sFieldName, HtmlInputCheckBox chkSelect)
{
    if (chkSelect == null)
    {
        throw new ApplicationException("Dev is using the incorrect constructor");
    }

    this.FName= sFieldName;
    this.SelectCheckBox = chkSelect;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T20:05:58.800

像这样？

```
//Want to throw an ApplicationExceptioh if developer uses this constructor and passes
//chkSelect = null
public UIControl(string sFieldName, HtmlInputCheckBox chkSelect)
{
  if (chkSelect == null)
  {
    throw new ArgumentException("chkSelect cannot be null when using this constructor");
  }
  this.FName= sFieldName;
  this.SelectCheckBox = chkSelect;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T21:26:33.817

让不太具体的构造函数使用更具体的构造函数是一种更好的做法（或更常见的做法，因为 C# 在 4.0 之前没有默认参数），反之亦然。然后，您可以使用带有可为空的 bool 的私有构造函数。如果您能够重写它们，请尝试以下操作：

```
public UIControl(string sFieldName, HtmlInputCheckBox chkSelect)
  : this(sFieldName, chkSelect, null)
{
}

public UIControl(string sFieldName, HtmlInputCheckBox chkSelect, bool overrideSelect)
  : this(sFieldName, chkSelect, overrideSelect)
{
}

UIControl(string sFieldName, HtmlInputCheckBox chkSelect, bool? overrideSelect)
{
  if (!overrideSelect.HasValue && chkSelect == null)
  {
      throw new ArgumentException("chkSelect");
  }
  FName = sFieldName;
  SelectCheckBox = chkSelect;
  OverrideSelect = overrideSelect ?? false;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T20:07:21.870

为什么不这样？

```
public UIControl(string sFieldName, HtmlInputCheckBox chkSelect)
{
    if (chkSelect == null) 
    { 
        throw new ApplicationException("Dev is using the incorrect constructor"); 
    }
    this.FName= sFieldName;
    this.SelectCheckBox = chkSelect;
} 
```

但是，通过运行时错误执行此操作可能不是一个**好主意。**一个更好的主意是使用一个根本不接受`chkSelect`参数的重载，或者使其`chkSelect`不可为空。

**编辑：**我现在注意到第二个选择器调用了第一个，但第二个选择器唯一做的就是更改`OverrideSelect`字段的值。为什么不只有一个构造函数并设置该字段？或者为什么有那个领域？几个选择：

```
// This is now the ONLY constructor you need
public UIControl(string sFieldName, HtmlInputCheckBox chkSelect)
{
    OverrideSelect = (chkSelect == null);
    this.FName= sFieldName;
    this.SelectCheckBox = chkSelect;
}

// You could solve it differently by replacing OverrideSelect with this property:
public readonly bool isChkSelectNull {
    get {
        return (this.chkSelect == null);
    }
}

public UIControl(string sFieldName, HtmlInputCheckBox chkSelect)
{
    this.FName= sFieldName;
    this.SelectCheckBox = chkSelect;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T20:08:24.893

从 .Net 4.0 获取 Spec# 或 Contracts 并使参数不可为空

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T20:14:00.093

根据来自 OP 的更新信息：

```
public class UIControl
{
    //Want to throw an ApplicationException if developer uses this constructor and passes
    //chkSelect = null
    public UIControl(string sFieldName, HtmlInputCheckBox chkSelect)
    {
      if (chkSelect == null)
      {
        throw new ApplicationException("Dev is using the incorrect constructor");
      }
      this.FName= sFieldName;
      this.SelectCheckBox = chkSelect;
    }

    public UIControl(string sFieldName, HtmlInputCheckBox chkSelect, bool overrideSelect)
    {
      this.FName= sFieldName;
      this.SelectCheckBox = chkSelect;  // note: chkSelect MAY be null here.

      OverrideSelect = overrideSelect;
    }
  } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T20:14:29.967

我不喜欢为程序员问题抛出异常。不是抛出异常，而是 Debug.Assert()。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-22T20:22:30.950

如果 chkSelect 为空，为什么要抛出异常？

无论如何，要回答您的要求（不一定是您真正需要的），我认为您可能会倒退。让 2 参数版本调用 3 参数版本。

```
//Want to throw an ApplicationExceptioh if developer uses this constructor and passes
//chkSelect = null
public UIControl(string sFieldName, HtmlInputCheckBox chkSelect)
  : this(sFieldName, chkSelect, chkSelect==null)
{
  if(chkSelect==null) throw new ArgumentNullException("chkSelect");
}

public UIControl(string sFieldName, HtmlInputCheckBox chkSelect, bool overrideSelect)    
{
  this.FName= sFieldName;
  this.SelectCheckBox = chkSelect;
  OverrideSelect = overrideSelect;
} 
```

# apache-flex - 最佳实践：如何在 Flex 中编写布局代码？

> ID：899733
> 
> 赞同：0
> 
> 时间：2009-05-22T20:04:21.283
> 
> 标签：apache-flex, layout, mxml

我想在 flex 中编写一个简单的表单布局。类似于以下内容：

```
[label] [text field]
[label] [text field] 
```

最初，我尝试使用 vboxes 和 hboxes 对我的布局进行编码。像下面这样

```
<hbox>
   <vbox>
      <label />
      <textfield />
   </vbox>
   <vbox>
      <label />
      <textfield />
   </vbox>
</hbox> 
```

如果我开始在 ItemRender 或类似的东西中重用此代码，我会被性能所困扰。

我在某处读到，过度使用 HBox 和 VBox 会导致性能沉重，因为代码必须自己计算这些组件的确切位置。

考虑到这个答案，我转而使用 Canvas。像这样的东西：

```
<canvas>
   <label x="0" y="0" />
   <text field x="30" y="0" />

   <label x="0" y="15" />
   <textfield x="30" y="15" />
</canvas> 
```

当您想要隐藏和显示某些文本字段时，这开始成为一场噩梦。或者，如果您有一个 textArea 并且想要使用自动换行。我已经开始根据其他元素的位置在画布中动态放置对象，但这正在成为维护的噩梦。

问题：

所以，我想知道是否有任何 Flex 布局管理器可以减轻我的头痛？或者，如果有更好的方法来编码我的布局，一般来说。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T20:20:42.293

我会使用 Form、FormItem 和 FormHeading 标签来布局表单。像这样的东西：

```
 <mx:Form width="100%" height="100%">
        <mx:FormHeading label="Enter values into the form."/>

        <mx:FormItem label="First name">
            <mx:TextInput id="fname" width="200"/>
        </mx:FormItem>

        <mx:FormItem label="Date of birth (mm/dd/yyyy)">
            <mx:TextInput id="dob" width="200"/>
        </mx:FormItem>

        <mx:FormItem label="E-mail address">
            <mx:TextInput id="email" width="200"/>
        </mx:FormItem>

        <mx:FormItem label="Age">
            <mx:TextInput id="age" width="200"/>
        </mx:FormItem>

        <mx:FormItem label="SSN">
            <mx:TextInput id="ssn" width="200"/>
        </mx:FormItem>

        <mx:FormItem label="Zip">
            <mx:TextInput id="zip" width="200"/>
        </mx:FormItem>

        <mx:FormItem label="Phone">
            <mx:TextInput id="phone" width="200"/>
        </mx:FormItem>
    </mx:Form> 
```

查看： [http](http://livedocs.adobe.com/flex/3/langref/mx/containers/Form.html#includeExamplesSummary) ://livedocs.adobe.com/flex/3/langref/mx/containers/Form.html#includeExamplesSummary以供参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T20:18:15.047

如果您真正使用“表单”布局，Flex 有一个表单“组件”/布局管理器。我不知道您将获得的性能差异，但代码清洁度会得到改善（有助于维护 - 肯定会帮助您解决问题）。高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T22:39:25.603

就个人而言，我不会`ItemRenders`用于表单，但您可能希望`ItemEditors`在`DataGrid`单个项目中使用。如果您正在构建表单，请使用`Form`具有其功能的组件，如上所述。用于`States`交换表单元素，除非表单本身的性质是高度动态的，在这种情况下，您可能希望使用纯粹的动作脚本而不是 MXML 方法。

# c# - 具有实体框架的强类型 ASP.NET MVC

> ID：899734
> 
> 赞同：2
> 
> 时间：2009-05-22T20:04:39.207
> 
> 标签：c#, .net, asp.net, asp.net-mvc, entity-framework

此代码无法实际保存任何更改：

```
//
// POST: /SomeType/Edit/5

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, SomeType Model)
{
    db.AttachTo(Model.GetType().Name, Model);
    db.ApplyPropertyChanges(Model.EntityKey.EntitySetName, Model);
    db.SaveChanges();
    return RedirectToAction("Index");
} 
```

**ASP.NET MVC 将对象模型创建为具有Detached**的 EntityState 值的 Department 类型 EntityObject 。

使用*AttachTo*方法后，其 EntityState 变为**Unchanged**。

[MSDN 关于附加对象（实体框架）](http://msdn.microsoft.com/en-us/library/bb896271.aspx)

> 对象以**Unchanged**状态附加到对象上下文。

由于其未**更改**状态，*ApplyPropertyChanges*方法什么也不做。

我希望它改为具有状态**Modified**。

[MSDN 关于 EntityState 枚举](http://msdn.microsoft.com/en-us/library/system.data.entitystate.aspx)

> **已分离**
> 对象存在，但对象服务未对其进行跟踪。一个实体在它被创建之后并且在它被添加到对象上下文之前立即处于这种状态。在通过调用 Detach 方法将实体从上下文中删除或使用 NoTrackingMergeOption 加载实体后，它也处于此状态。
> 
> **Unchanged**
> 自加载到上下文中或自上次调用 SaveChanges 方法以来，该对象未被修改。
> 
> **Modified**
> 对象已更改，但尚未调用 SaveChanges 方法。

我无法将 EntityObject 的 EntityState 属性显式设置为**Modified**。它是只读的。

使用 EntityObjects 拥有强类型的 MVC 控制器是不可能的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T18:55:00.490

您需要从 ObjectContext 中获取 ObjectStateManager。使用 ObjectStateManager，您可以显式设置对象的状态，而无需调用数据库：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, SomeType Model)
{
    db.AttachTo(Model.GetType().Name, Model);

    ObjectStateManager stateMgr = db.ObjectStateManager;
    ObjectStateEntry stateEntry = stateMgr.GetObjectStateEntry(model);
    stateEntry.SetModified(); // Make sure the entity is marked as modified
    //db.ApplyPropertyChanges(Model.EntityKey.EntitySetName, Model);

    db.SaveChanges();
    return RedirectToAction("Index");
} 
```

ObjectStateEntry 还允许您通过 SetModifiedProperty 应用更细粒度的状态更改数据。如果您调用 SetModified，EF 会将整个实体视为已修改，并将每个属性持久保存到数据存储中。使用 SetModifiedProperty，EF 可以优化查询并且只涉及实际更改的属性。使用 SetModifiedProperty 显然更复杂，因为您通常需要知道每个属性的原始值。

我希望这有帮助。ObjectStateManager 是 EF 工具箱中一个强大的小工具，可以帮助改善 EF v1.0 原本病态的性能和效率。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-19T12:58:36.580

我发现上述方法似乎都不适合我，但 MSDN 指南示例确实如此，您可以从上下文中获取原始项目，然后附加更新后的项目。

第二个例子：

[http://msdn.microsoft.com/en-us/library/bb896248.aspx#Mtps_DropDownFilterText](http://msdn.microsoft.com/en-us/library/bb896248.aspx#Mtps_DropDownFilterText)

```
private static void ApplyItemUpdates(SalesOrderDetail updatedItem){
// Define an ObjectStateEntry and EntityKey for the current object.
EntityKey key;
object originalItem;

using (AdventureWorksEntities advWorksContext =
    new AdventureWorksEntities())
{
    try
    {
        // Create the detached object's entity key.
        key = advWorksContext.CreateEntityKey("SalesOrderDetail", updatedItem);

        // Get the original item based on the entity key from the context
        // or from the database.
        if (advWorksContext.TryGetObjectByKey(key, out originalItem))
        {
            // Call the ApplyPropertyChanges method to apply changes
            // from the updated item to the original version.
            advWorksContext.ApplyPropertyChanges(
                key.EntitySetName, updatedItem);
        }

        advWorksContext.SaveChanges();
    }
    catch (InvalidOperationException ex)
    {
        Console.WriteLine(ex.ToString());
    }
} 
```

}

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-20T13:41:10.597

我有这个工作，但我无法得到的是 SalesOrderDetail 的父实体我怎样才能得到它？

SalesOrderDetail.SalesOrderHead 为空，实体引用也为空。我的编辑例程只能访问 SalesOrderDetail 的 id。

谢谢斯里

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T20:07:48.140

这有效：

```
//
// POST: /SomeType/Edit/5

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, SomeType Model)
{
    Model.EntityKey = (from SomeType s in db.SomeType
                       where s.Id == id
                       select s).FirstOrDefault().EntityKey;
    db.ApplyPropertyChanges(Model.EntityKey.EntitySetName, Model);
    db.SaveChanges();
    return RedirectToAction("Index");
} 
```

但是有没有不查询数据库的方法呢？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T20:15:50.977

如果添加一行会发生什么：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, SomeType Model)
{
    db.AttachTo(Model.GetType().Name, Model);
    Model.SomeProperty = Model.SomeProperty; // This looks hacky... =(
    db.ApplyPropertyChanges(Model.EntityKey.EntitySetName, Model);
    db.SaveChanges();
    return RedirectToAction("Index");
} 
```

状态有变化吗？

# c# - 记录 WCF 消息大小

> ID：899741
> 
> 赞同：3
> 
> 时间：2009-05-22T20:06:13.790
> 
> 标签：c#, wcf, logging, message

我正在使用 WCF 通过网络发送一些 Linq 对象。我想使用消息记录或跟踪来记录消息大小。但是，我不希望或无法使用配置文件进行设置。我正在努力弄清楚如何以编程方式执行此操作。我不在乎这是否发生在客户端主机上。我控制两者。

有没有人有这样做的经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T15:30:20.843

Marc 说得对，Message Inspectors 将允许您执行此操作。创建一个类： 实现[IDispatchMessageInspector](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.idispatchmessageinspector.aspx)。下面的方法将可用，您可以在其中实现代码来操作请求消息。

```
Public Function AfterReceiveRequest(ByRef request As System.ServiceModel.Channels.Message, ByVal channel As System.ServiceModel.IClientChannel, ByVal instanceContext As System.ServiceModel.InstanceContext) As Object Implements System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest
    'Output the request message to immediate window
    System.Diagnostics.Debug.WriteLine("*** SERVER - RECEIVED REQUEST ***")
    System.Diagnostics.Debug.WriteLine(request.ToString())

    Return Nothing
End Function 
```

此外，以下[链接](http://weblogs.asp.net/paolopia/archive/2007/08/23/writing-a-wcf-message-inspector.aspx)也可能提供一些帮助。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T03:24:49.243

您还可以使用 Fiddler，如果您使用 wsHttp 或 basicHttp 绑定之一，它可以记录您的 HTTP 消息。[http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T20:13:42.153

不是编程，但也许是：[wireshark](http://www.wireshark.org/)？

或者，查看[消息检查器](http://msdn.microsoft.com/en-us/library/aa717047.aspx)。不过，我没有关于大小记录的具体示例。

# javascript - 将一个 HTML 文件动态插入另一个 HTML 文件？

> ID：899743
> 
> 赞同：2
> 
> 时间：2009-05-22T20:06:39.373
> 
> 标签：javascript, html

有 2 个 html 文件，file-1.htm 和 file-2.htm。还有另一个 html 文件 test.htm，其下拉菜单有 2 个值，“Load Sample-1”和“Load Sample-2”。

这就是我正在尝试的：当从下拉列表中选择“加载 Sample-1”时，file-1.htm 应该作为嵌套 html 在 test.htm 中加载。

现在，我可以通过在 test.htm 中包含 file-1.htm 和 file-2.htm 的内容来通过 javascript 实现这一点。Bt 随着下拉列表变大，test.htm 会变得很大。如何通过为下拉列表中的每个条目设置单独的 html 文件来实现这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T20:09:45.000

为什么不直接使用[`<iframe>`](http://www.w3schools.com/TAGS/tag_iframe.asp)，然后让 JavaScript 动态更改 iframe 的来源？

这是一个简单的页面，展示了如何使用它：

```
<html>
<head>
<script type="text/javascript">
var changePage = function() {
    var iframe = document.getElementById("myiframe");  // One of the many ways to select your iframe
    var select = document.getElementById("pageselected");
    var url = select.options[select.selectedIndex].value;
    iframe.src = url;
}
</script>
</head>
<body>
<select id="pageselected">
    <option value="page1.html">Page 1</option>
    <option value="page2.html">Page 2</option>
</select>
<input type="button" onclick="changePage()" value="Change Page" />
<iframe id="myiframe"></iframe>
</body>
</html> 
```

您可能会问自己“为什么[他](https://stackoverflow.com/questions/586936/jquery-change-on-select-and-firefox/586969#586969)不只是`onchange`使用Explorer 6 或 7。（不确定它是否仍然在 8 中损坏。）`<select>``<select>``onchange`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-22T20:56:27.807

如果你使用 JQuery，他们有一个花哨的函数 jquery('#div').load() [http://jquery.com/](http://jquery.com/) [http://docs.jquery.com/Ajax/load](http://docs.jquery.com/Ajax/load)

效果很好，还支持 GET 和 POST 参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T20:12:23.030

如果下拉菜单“巨大”，那么我建议不再使用下拉菜单并查看一些现有的自动完成框以供您选择语言。

如果有成百上千的选项，下拉菜单不再是合适的表单元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T20:12:46.740

您可以使用 AJAX 来完成此操作。有[一百万种不同的 AJAX 教程](http://www.smashingmagazine.com/2008/10/16/50-excellent-ajax-tutorials/)可以向您介绍该技术。

# javascript - 如何控制在 UpdatePanel 部分回发 endRequest 之后运行哪些 JavaScript？

> ID：899761
> 
> 赞同：6
> 
> 时间：2009-05-22T20:11:26.337
> 
> 标签：javascript, asp.net-ajax, updatepanel

我知道我可以在每次部分回发后挂钩客户端事件以运行 JavaScript；但是，我想做这样的事情：

```
protected void FooClicked(object sender, EventArgs e) {
        ClientScript.RegisterStartupScript(GetType(), "msg", "showMsg('Foo clicked');",true);        
} 
```

我知道我可以完全用隐藏字段破解它，并在*每次*回发后运行一些东西，但应该有一种非常简单的方式来以类似的方式。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T23:02:22.313

您描述的特定代码示例不适用于部分回发，因为`ClientScript.RegisterStartupScript()`在请求生命周期的输出构造阶段将 JS 写入页面；而部分回发仅通过 JavaScript 更新页面的选定部分（即使整个页面的标记，包括您的启动脚本，都是在服务器上生成的）。

为了密切模仿您所描述的内容，您应该在 UpdatePanel 中包含一个 Literal 控件，并在部分回发期间将内容面板的 Text 属性设置为您希望运行的脚本：

```
myLiteral.Text = "<script type=\"JavaScript\">doStuff();</script>"; 
```

IMO，更合适的方法是使用[异步回发的客户端 API](http://msdn.microsoft.com/en-us/library/bb398976.aspx)注册一个事件处理程序以在回发完成时运行：

```
function endRequestHandler(sender, args) {
    doStuff();
}

Sys.WebForms.PageRequestManager.getInstance().add_endRequest(endRequestHandler); 
```

如果您需要将回发期间生成的信息传递给处理程序，您可以通过隐藏字段传递该信息并从客户端处理程序中的 DOM 中获取该信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-14T22:06:34.093

[这](http://www.coderenaissance.com/2009/02/update-panel-partial-postback-and.html)更优雅，IMO。显然 ASP AJAX 将调用任何名为 pageLoad 的 JS 函数。所以编写一个名为 pageLoad 的函数，它会在每次页面加载时执行，即使在部分更新之后也是如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-01T06:14:13.060

```
<script type="text/javascript" language="javascript">
    function ValidateUserRole() {  
        var answer = confirm("Are you sure..................")
        if (answer) {
            var btnRoleReleatedButton = '<%=btnRoleReleatedButton.ClientID%>';
            document.getElementById(btnRoleReleatedButton).click();
        }
        else {
            return false;
        }
    }
</script> 
```

```
Tier 3 :<asp:UpdatePanel ID="upTier3Details" runat="server" UpdateMode="Conditional">
    <ContentTemplate>
        <asp:DropDownList ID="ddlTier3" runat="server" CssClass="ddlextralarge" Width="350" />
    </ContentTemplate>
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="ddlUserRole" EventName="SelectedIndexChanged" />
    </Triggers>
</asp:UpdatePanel> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-07T14:19:20.207

最好的方法是使用 DoAfterPostBack 控件。您可以从这里免费下载此控件 [http://go2amitech.blogspot.com/2010/08/running-specific-javascript-after.html](http://go2amitech.blogspot.com/2010/08/running-specific-javascript-after.html)

# c# - 在 WPF MV-VM 中撤消，它如何适应？

> ID：899762
> 
> 赞同：12
> 
> 时间：2009-05-22T20:12:06.070
> 
> 标签：c#, wpf, mvvm, undo

在我之前的项目中，我已经在 c++ 中实现了 undo system，并且我知道它是如何工作的。我也知道命令模式。

我将实现一个 C#/WPF 桌面应用程序，并希望我的设计基于 MV-VM 模式。

该应用程序将：

*   是一个相对较小的项目（1 个开发人员估计需要 2-3 周的工作时间）
*   有一个具有持久性的简单数据模型（linq to XML）
*   支持撤销/重做

我想知道是否有人在遵循 MV-VM 模式时有实施撤消系统的经验。它如何融入其中？它如何从 INotifyPropertyChanged 和 INotifyCollectionChanged 通知中受益，因此在实现模型（业务对象）时所需的工作最少。

我认为撤消系统会以某种方式集成到 ViewModel 层中，因为它是一种 UI 状态。

任何想法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-10-22T12:22:30.927

这是我用于我的项目的解决方案。事实证明，该解决方案运行良好。

系统正在使用撤消事件对象，其中每个撤消事件都知道如何撤消和重做自身。

```
interface IUndoEvent
{
    void Undo();
    void Redo();
} 
```

我能够通过仅实现 2 个撤消事件来构建系统：一个用于属性更改；另一个用于更改属性。一个用于集合更改。

这个想法是这些事件通过直接修改模型来实现撤消/重做。

```
class PropertyChangeUndoEvent : IUndoEvent
{
    private ModelBase _target;
    private string _propertyName;
    private object _oldValue;
    private object _newValue;

    public PropertyChangeUndoEvent(ModelBase target, string propertyName, object oldValue, object newValue)
    {
        _target = target;
        _propertyName = propertyName;
        _oldValue = oldValue;
        _newValue = newValue;
    }

    public void Undo()
    {
        SetValue(_oldValue);
    }

    public void Redo()
    {
        SetValue(_newValue);
    }

    private void SetValue(object value)
    {
        // Set Value on the _target using reflection (_propertyName)
    }
} 
```

ViewModel 通过调用 ViewModelBase 函数负责创建撤消事件：

```
class MyViewModel : ViewModelBase
{
    public string Name
    {
        get { return _model.Name; }

        // The SetValue will create a undo event, and push it to the UndoManager
        set { SetValue(_model, "Name", value); }
    }
} 
```

最后，还有一个UndoManager（项目单例），用于存储撤消堆栈和重做堆栈。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-06-21T03:30:55.077

您可能会发现 Monitored Undo Framework 很有用。[http://muf.codeplex.com/](http://muf.codeplex.com/)。它不使用“自上而下”命令模式，而是在更改发生时监视更改，并允许您在撤消堆栈上放置一个委托来撤消更改。

我将其创建为使用 MVVM 构建的 WPF 应用程序的一部分。大多数撤消操作起源于我们的底层域模型，但我们也连接到 ViewModel 的某些区域以允许在那里撤消/重做。

[您可以在http://muf.codeplex.com/](http://muf.codeplex.com/)上的 codeplex 站点上找到更多信息和文档。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-25T15:39:59.677

我想您正在将 Command 模式与 Memento 结合起来？

> 我认为撤消系统会以某种方式集成到 ViewModel 层中，因为它是一种 UI 状态。

？！通常，undo/redo 作用于业务对象，UI 反映业务层。

假设我们有一个带有“描述”字符串的产品类。ProductVM 公开了一个引发 PropertyChanged 的​​字符串属性。在修改时，纪念品会保留旧的模型实例。如果撤消，请使用 ProductVM.Description = (memento as Product).Description 恢复备忘录：模型和 UI 也会更新。

注意：避免*(memento as Product)*，仅用于示例；）

# c - 在 Unix 中区分管道和文件

> ID：899764
> 
> 赞同：7
> 
> 时间：2009-05-22T20:12:12.170
> 
> 标签：c, unix, file, pipe, manpage

给定一个 FILE*，是否可以确定底层类型？也就是说，是否有一个函数可以告诉我 FILE* 是管道、套接字还是常规磁盘文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T20:17:49.337

有一个`fstat(2)`功能。

NAME stat、fstat、lstat - 获取文件状态

概要

```
 #include <sys/types.h>
   #include <sys/stat.h>
   #include <unistd.h>

   int fstat(int fd, struct stat *buf); 
```

您可以通过调用获取 fd `fileno(3)`。

然后你可以打电话`S_ISFIFO(buf)`来弄清楚。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T20:29:21.310

使用 fstat() 函数。但是，您需要使用 fileno() 宏从文件 FILE 结构中获取文件描述符。

```
#include <stdio.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <unistd.h>

FILE *fp = fopen(path, "r");
int fd = fileno(fp);
struct stat statbuf;

fstat(fd, &statbuf);

/* a decoding case statement would be good here */
printf("%s is file type %08o\n", path, (statbuf.st_mode & 0777000); 
```

# ruby-on-rails - 如何防止黑客窃取我们的数据库？

> ID：899767
> 
> 赞同：1
> 
> 时间：2009-05-22T20:12:45.523
> 
> 标签：ruby-on-rails

> **可能重复：**
> [您如何阻止脚本编写者每秒数百次抨击您的网站？](https://stackoverflow.com/questions/450835/how-do-you-stop-scripters-from-slamming-your-website-hundreds-of-times-a-second)

我正在 RubyOnRails 中构建一个基于大量数据的 Web 应用程序。该应用程序提供强大的导航和数据交叉，以及用于添加更多数据的社区模型。在这方面，可以将其与 StackOverflow.com 进行比较：一大堆数据，以一种相当简单的方式结构化。

我打算在 CreativeCommons 许可下提供内容，但如果网站“成功”，我需要阻止模仿者。我最大的恐惧是屏幕抓取脚本，不仅会窃取原始数据，还会在我的服务器上引发巨大的使用高峰。

我想知道 RubyOnRails 是否提供了任何方式来限制（显然是自动化的）请求，例如为了普通用户的利益而减少他们的响应时间。也许这需要 Apache 或 Phusion Passenger 设置？

编辑：我的目标不是识别用户类型，而是减少对过度活跃用户的响应，例如最大化每个 IP 地址每单位时间处理的请求数（？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T20:42:48.070

我的建议是限制您网站的任何简单的迭代导航，这是我看到的收获程序工作的主要方式。用作 GET 变量的 ID 号码的简单加密将使剥离您的信息更加困难。您只能尝试使获取信息变得繁琐。你将无法完全阻止它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T04:04:14.380

您可能还想研究使用一些 Rack 中间件来进行速率限制，例如[最近](http://blog.messagepub.com/2009/05/05/how-to-rack-middleware-for-api-throttling/)介绍的有关 API 限制的文章（例如您在 Twitter 或类似网站上想要的东西）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T20:48:28.730

您可以向“过度活跃的用户”显示验证码，就像您编辑太快时 SO 所做的那样。这应该有效地阻碍自动爬虫，如抓取。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T20:15:42.257

我相信你所能做的就是让用户跳起来。最终，没有万无一失的方法可以将普通用户与机器人区分开来。

# desktop - 是否有任何 API 可以将广告添加到我的桌面应用程序

> ID：899777
> 
> 赞同：4
> 
> 时间：2009-05-22T20:14:17.767
> 
> 标签：desktop, embed, ads

我正在寻找一种将广告嵌入到我的桌面 API 的方法。对于从 Ad Networks 流式传输广告的网站，有一些成熟的解决方案。但是，我没有找到一个可以让应用程序获得类似广告内容的方法。有人对这个有经验么？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T20:19:52.123

您的目标是哪个操作系统？如果您使用的是 Windows，则始终可以在嵌入式/自动 IE 窗口中显示广告（假设已安装 IE）。或者，您可以连接到 shareasale.com 数据馈送之类的东西，并在您的应用程序中嵌入适当的链接。单击链接（或描述、图像等）只会导致浏览器在适当的站点启动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-18T06:53:35.863

我有同样的专业人士，我发现很难找到专注于桌面应用程序的广告网络。几个月前，我的一位开发人员朋友告诉我，他正在他的 Windows 桌面应用程序中使用 DesktopAd 的广告。我下载了他们的广告 SDK 并添加到我的 Windows 8.1 应用程序中，只用了半天时间就完成了所有工作。之后，我每天都能从广告点击中获得收入。希望我的回答能对你有所帮助。

# data-structures - 如何细分 2d 游戏世界以获得更好的碰撞检测

> ID：899778
> 
> 赞同：14
> 
> 时间：2009-05-22T20:14:19.610
> 
> 标签：data-structures, collision-detection

我正在开发一款具有相当大的方形 2d 游戏区域的游戏。游戏区没有瓷砖，有边界（没有环绕）。我试图弄清楚如何最好地划分这个世界以提高碰撞检测的性能。我不想检查每个实体是否与所有其他实体发生碰撞，我只想检查附近的实体是否有碰撞和避障。

我对这个游戏世界有一些特别的担忧……

*   我希望能够同时使用游戏世界中的大量实体。但是，有 % 的实体不会与相同类型的实体发生冲突。例如射弹不会与其他射弹发生碰撞。

*   我希望能够使用大范围的实体大小。我希望最小的实体和最大的实体之间有很大的尺寸差异。

*   游戏世界中很少有静态或不动的实体。

我有兴趣使用类似于此处答案中描述的内容：[Quadtree vs Red-Black tree for a game in C++?](https://stackoverflow.com/questions/371465/quadtree-vs-red-black-tree-for-a-game-in-c)

我担心的是世界的树细分能够如何处理实体中的大尺寸差异？要为较小的实体划分足够多的世界，较大的实体将需要占据大量区域，我担心这将如何影响系统的性能。

我的另一个主要问题是如何正确更新被占用区域的列表。由于有很多移动的实体，而且有一些非常大，似乎将世界划分为跟踪哪些实体占据哪些区域会产生大量开销。

我主要在寻找任何有助于减少碰撞检测和避障计算的好算法或想法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T22:11:18.547

如果我是你，我会从实现一个简单的 BSP（二进制空间分区）树开始。由于您在 2D 中工作，因此绑定框检查非常快。你基本上需要三个类：CBspTree、CBspNode 和 CBspCut（不是真的需要）

1.  CBspTree 有一个 CBspNode 类的根节点实例
2.  CBspNode 有一个 CBspCut 实例
3.  CBspCut 象征你如何将一个集合切割成两个不相交的集合。这可以通过引入多态性（例如 CBspCutX 或 CBspCutY 或其他一些切割线）巧妙地解决。CBspCut 也有两个 CBspNode

与分裂世界的接口将通过树类，如果您想用四叉树替换 BSP 解决方案，在此之上再创建一层可能是一个非常好的主意。一旦你掌握了窍门。但根据我的经验，BSP 就可以了。

如何在树中存储项目有不同的策略。我的意思是，您可以选择在每个节点中拥有例如某种容器，其中包含对占据该区域的对象的引用。这意味着（正如您问自己的那样）大项目将占用许多叶子，即会有很多对大对象的引用，而非常小的项目将出现在单个叶子上。

根据我的经验，这并没有那么大的影响。当然这很重要，但你必须做一些测试来检查它是否真的是一个问题。您只需将这些项目留在树中的分支节点上即可解决此问题，即您不会将它们存储在“叶级”上。这意味着您将在遍历树时快速找到这些对象。

当涉及到你的第一个问题。如果您只打算将此细分用于碰撞测试而没有其他用途，我建议永远不会碰撞的东西永远不要插入到树中。例如，正如您所说的导弹，不能与另一枚导弹相撞。这意味着您甚至不必将导弹存储在树中。

但是，您可能还想将 bsp 用于其他事情，您没有指定但请记住这一点（例如使用鼠标选择对象）。否则，我建议您将所有内容存储在 bsp 中，然后再解决冲突。只需询问某个区域中对象列表的 bsp 以获取一组有限的可能碰撞候选对象并在此之后执行检查（假设对象知道它们可以与什么碰撞，或其他一些外部机制）。

如果要加快速度，还需要处理**合并**和**拆分**，即当从树中删除事物时，很多节点将变为空，或者某个节点级别以下的项目数将减少到某个合并阈值以下. 然后，您想将两个子树合并为一个包含所有项目的节点。将项目插入世界时会发生拆分。因此，当项目的数量超过某个分割阈值时，您会引入一个新的切割，它将世界一分为二。这些合并和拆分阈值应该是两个常量，您可以使用它们来调整树的效率。

合并和拆分主要用于保持树的平衡，并确保它根据其规范尽可能高效地工作。这确实是您需要担心的。将事物从一个位置移动并因此更新树的速度很快。但是在合并和拆分方面，如果您过于频繁地进行合并和拆分，可能会变得昂贵。

这可以通过引入某种惰性合并和拆分系统来避免，即您有某种脏标记或修改计数。批处理所有可以批处理的操作，即移动 10 个对象并插入 5 个可能是一个批处理。完成这批操作后，您检查树是否脏，然后执行所需的合并和/或拆分操作。

如果您希望我进一步解释，请发表一些评论。

干杯！

* * *

编辑

树中有很多东西可以优化。但如您所知，过早优化是万恶之源。所以从简单开始。例如，您可以创建一些通用的回调系统，以便在遍历树时使用。这样，您不必查询树以获取与绑定框“问题”匹配的对象列表，而是可以遍历树并在每次遇到某些东西时执行该回调。“如果我提供的这个绑定框与您相交，则使用这些参数执行此回调”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-22T20:27:17.053

您绝对想[从 gamedev.net 中查看此碰撞检测资源列表](http://archive.gamedev.net/archive/reference/listf1c6.html?categoryid=45#199)。它充满了游戏开发约定的资源。

除了碰撞检测之外，请检查他们[的文章和资源的完整列表](http://www.gamedev.net/reference/)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-23T10:21:06.177

> 我担心的是世界的树细分能够如何处理实体中的大尺寸差异？要为较小的实体划分足够多的世界，较大的实体将需要占据大量区域，我担心这将如何影响系统的性能。

使用四叉树。对于存在于多个区域的对象，您有几个选项：

*   将对象存储在两个分支中，一直向下。一切都以叶节点结束，但您最终可能会得到大量额外的指针。可能适用于静态事物。

*   分割区域边界上的对象并将每个部分插入各自的位置。造成很多痛苦，并且对于很多对象都没有很好的定义。

*   将对象存储在树中的最低点。一组对象现在存在于叶节点和非叶节点中，但每个对象在树中都有一个指向它的指针。可能最适合要移动的物体。

顺便说一句，您使用四叉树的原因是因为它真的很容易使用。您不会像使用某些 BSP 实现那样进行任何基于启发式的创建。这很简单，它可以完成工作。

> 我的另一个主要问题是如何正确更新被占用区域的列表。由于有很多移动的实体，而且有一些非常大，似乎将世界划分为跟踪哪些实体占据哪些区域会产生大量开销。

每次移动时，将实体保持在树中的正确位置都会产生开销，是的，这可能很重要。但重点是您在碰撞代码中所做的工作要少得多。即使您通过树遍历和更新添加了一些开销，它也应该比您刚刚使用树删除的开销要小得多。

显然，取决于对象的数量、游戏世界的大小等，这种权衡可能不值得。通常结果会是一场胜利，但如果不这样做就很难知道。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T21:40:45.080

有很多方法。我建议设置一些特定目标（例如，每秒 x 次碰撞测试，最小实体与最大实体之间的比率为 y），并进行一些原型设计以找到实现这些目标的最简单方法。您可能会惊讶于您只需做很少的工作即可获得所需的东西。（或者可能需要大量工作，具体取决于您的具体情况。）

许多加速结构（例如，一个好的 BSP）可能需要一段时间来建立，因此通常不适合快速动画。

有很多关于这个主题的文献，所以花一些时间搜索和研究以列出候选方法。模拟它们并配置文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T10:15:05.317

我很想在游戏区域上覆盖一个粗网格以形成 2D 散列。如果网格至少是最大实体的大小，那么您只有 9 个网格方格来检查冲突，这比管理四叉树或任意 BSP 树要简单得多。确定您所在的粗网格正方形的开销通常只是 2 次算术运算，当检测到更改时，网格只需从一个正方形的列表中删除一个引用/ID/指针并将其添加到另一个正方形。

将弹丸排除在网格/树/等查找系统之外可以获得进一步的收益 - 因为您可以快速确定弹丸在网格中的位置，您知道要查询哪些网格方块以查找潜在的碰撞对象。如果您依次检查每个射弹与环境的碰撞，则其他实体无需反过来检查与射弹的碰撞。

# c# - 如何将外部页面/内容加载到 DIV

> ID：899782
> 
> 赞同：0
> 
> 时间：2009-05-22T20:15:14.520
> 
> 标签：c#, asp.net, visual-studio-2008

这是我的问题：

我确实创建了一个菜单/操作列表（如果使用接受数据源的控件制作，这会更容易，比如 listview 甚至带有模板列的 Gridview）。

每个操作都需要一个特定的表单来执行，我已经在单独的 aspx 页面中创建了所有这些表单。

问题是：当我选择列表中的任何操作而不刷新页面或使用 iframe 时，在 div 中加载这些页面/表单的最佳方式是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T20:43:03.590

使用[jQuery](http://jquery.com/)（据我所知，您的操作是指向您的表单的链接）：

```
$(document).ready(function() {
    $('a.yourActionClass').click(function(event) {
        event.preventDefault();
        var url = $(this).attr('href');
        $.get(url, function(response) {
            $('div#yourDivForForm').html(response);
        });
    });
}); 
```

或者

```
$(document).ready(function() {
    $('a.yourActionClass').click(function(event) {
        event.preventDefault();
        var url = $(this).attr('href');
        $('div#yourDivForForm').load(url);
    });
}); 
```

**添加：**

如果您要返回带有表单的“完整”ASPX 页面：

```
$(document).ready(function() {
    $('a.yourActionClass').click(function(event) {
        event.preventDefault();
        var url = $(this).attr('href');
        $.get(url, function(response) {
            var page = $(response);
            var form = $('form', page);
            $('div#yourDivForForm').prepend(form);
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T21:49:13.630

这正是 Ajax 的用途。首先创建一个 XMLHttpObject 并用它来打开一个 url

﻿</p>

```
var req;

    function loadXMLDoc(url) {
    // branch for native XMLHttpRequest object
    if (window.XMLHttpRequest) {
        req = new XMLHttpRequest();
        req.onreadystatechange = processReqChange;
        req.open("GET", url);
        req.send(null);
        // branch for IE/Windows ActiveX version
    } else if (window.ActiveXObject) {
        req = new ActiveXObject("Microsoft.XMLHTTP");
        if (req) {
            req.onreadystatechange = processReqChange;
            req.open("GET", url);
            req.send();
        }
    }

} 
```

响应将通过 processReqChange 事件处理程序返回。

```
function processReqChange() {
    // only if req shows "complete"
    if (req.readyState == 4) {
        // only if "OK"
        if (req.status == 200) {
            // process the result
            document.getElementById("mydiv").innerHTML = req.responseText;
        } else {
            alert("There was a problem retrieving the XML data:\n" + req.statusText);
        }
    }
} 
```

只需将“mydiv”替换为您要填充的 div 的 id。

彼得

# tomcat - 应用服务器

> ID：899783
> 
> 赞同：2
> 
> 时间：2009-05-22T20:15:19.357
> 
> 标签：tomcat

有哪些因素会驱使我在企业应用程序的生产环境中使用 Tomcat。我的公司不大，但是几个部门，而且会是一个动态站点（db，web services）。我不打算使用 EJB，而是使用 Spring 和 POJO。除了 EJB 之外，是否有关于应用程序的技术原因必然意味着我不能使用 Tomcat？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T20:22:05.147

我已经成功地在生产中使用了 Tomcat。没有技术理由*不*使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T20:24:19.247

我想不出任何技术原因，但您应该考虑您的支持选项。应用程序的任务关键程度如何？您是否需要 24 小时即时按需支持？如果是这样，您将需要寻找第三方支持提供商。如果没有，tomcat 社区可能足以提供支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T20:28:53.103

我认为自从 Spring 购买了领先的 Tomcat 支持提供商之一以来，它比以往任何时候都更加可行。如果您有一家预算有限的小公司，为什么不呢？

# sql - 改进我的数据访问层

> ID：899784
> 
> 赞同：2
> 
> 时间：2009-05-22T20:15:24.210
> 
> 标签：sql, vb.net

我在我的软件中重新编写数据访问层（如果你甚至可以这样称呼它的话）。这确实是我第一个使用的项目，并且事情以不正当的方式完成。

在我的项目中，所有被拉取的数据都存储在一个数组列表中。一些数据从 arraylist 转换为类型化对象，然后再放回 arraylist。

此外，应用程序中没有中央查询集。这意味着一些查询是复制和粘贴的，我也想消除它们。这个应用程序有一些对应用程序非常标准的自定义对象，以及一些对这些对象非常标准的查询。

我真的只是不确定是否应该在我的对象和读写数据库的类之间创建一个层。该层将获取来自数据库的数据，将其键入为正确的对象，如果返回多个对象的情况，则返回这些对象的列表。这是一个好方法吗？

另外，如果这是一种很好的做事方式，我应该如何从数据库中返回数据？我目前正在使用 SqlDataReader.read，并填充一个数组列表。我确信这不是在这里使用的最佳方法，我只是不清楚如何改进它。

**所有这一切的原因是，我想将所有数据库操作集中到几个类中，而不是让它们分散在项目中的所有类中**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T20:29:24.803

您应该使用 ORM。“不这样做就是从你的客户那里偷东西”——Ayende

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T20:28:17.880

一件事马上就想到了。你有理由使用 ArrayLists 而不是泛型吗？如果您使用的是 .NET 1.1，我可以理解，但似乎您可以获得性能的一个领域是从图片中删除 ArrayLists 并停止类型之间的转换和转换。

在设计数据访问层时，您可能会想到的另一件事是 ORM。 [NHibernate](https://www.hibernate.org/343.html)和[LINQ to SQL](http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx)做得很好。一般来说，N 层方法适用于您想要完成的任务。例如，使用可重用的特定方法在类库中执行数据访问远比到处“复制粘贴”相同的查询要好得多。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T20:24:47.480

这真的取决于你在做什么。如果它是具有用户界面等的不断增长的应用程序，那么您是对的，有更好的方法。

我目前正在使用 ASP.NET MVC 进行开发，我发现 Linq to SQL 真的很舒服。Linq to SQL 使用代码生成来创建对数据建模的代码类集合。

ScottGu 在他的博客上对 Linq to SQL 做了很好的介绍：

[http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx](http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T20:41:53.187

在过去的几个项目中，我使用了一个基类，它完成了我所有的 ADO.NET 工作，并且所有其他数据访问类都继承了该基类。所以我的 UserDB 类将继承 DataAccessBase 类。我现在有它，我的 UserDB 类实际上获取从数据库返回的数据并填充一个用户对象，然后该对象返回给调用业务对象。如果返回多个对象，那么这些是一个通用列表，即`List<Users>`返回。

Daemon Armstrong 有一篇很好的文章（在 Google 中搜索 Daemon Armstrong，它演示了如何实现这一点。

"" [http://www.simple-talk.com/dotnet/.net-framework/.net-application-architecture-the-data-access-layer/](http://www.simple-talk.com/dotnet/.net-framework/.net-application-architecture-the-data-access-layer/) ""

然而，我现在已经开始将所有这些转移到使用实体框架，因为它的性能要好得多，并且节省了所有那些手动 CRUD 操作。本来打算使用 LINQ to SQL，但由于它似乎很快就会死在水中，我认为最好把时间花在下一个 ORM 上。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T20:26:45.060

“我真的不确定是否应该在我的对象和读取和写入数据库的类之间创建一个层。该层将获取来自数据库的数据，将其键入为正确的对象，如果有返回多个对象的情况，返回这些对象的列表。这是一个好方法吗？

我是一名 Java 开发人员，但我相信与语言无关的答案是“是”。

看看 Martin Fowler 的[“企业应用程序架构模式](https://rads.stackoverflow.com/amzn/click/com/0321127420)”。我相信像 LINQ 这样的技术就是为此而生的。

# php - 如何在 smarty 中调用递归函数？

> ID：899786
> 
> 赞同：1
> 
> 时间：2009-05-22T20:15:44.347
> 
> 标签：php, recursion, smarty

```
$sql = "select menu_id , menu_name , parent_id from menu " ;
$dbc->setFetchMode(DB_FETCHMODE_ASSOC);
$res = $dbc->query($sql);
while($row = $res->fetchRow()){
    $menu[$row['parent_id']][$row['menu_id']] = $row['menu_name'];
}

function make_menu($parent)
{
    global $menu ;
    echo '<ul>';
    foreach($parent as $menu_id=>$menu_name)
    {
        echo '<li>'.$menu_name ; 
        if(isset($menu[$menu_id]))
        {
            make_menu($menu[$menu_id]) ;
        }
        echo '</li>';
    }
    echo '</ul>';
}
$P['menu_bilder_data'] = $menu[0] ; 
//menu :off
$smarty->register_function('make_menu' , 'make_menu') ; 
```

好的，我有这部分代码要检索并传递给 smarty。

我已经`make_menu`使用 smarty 将我的函数注册为自定义用户函数，并且在模板中我有以下代码：

```
{make_menu parent_id=$P.menu_bilder_data} 
```

我`$P`在索引文件中传递数组。它必须工作，但它什么也没给我，因为它是一个递归函数，它返回一个数组而不是打印的嵌套 uls；我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T08:06:14.420

## 问题

$Smarty->register_function() 和 {make_menu parent_id=$P.menu_bilder_data} 导致使用 ($params, &$smarty) 调用函数，
其中 $params =

```
array(
  'parent_id' => array(
     0 => array(
       1 => > "menu item 1",
) 
```

这不是函数所期望的数据结构。

## 解决方案

您可以在不使用“register_function”的情况下调用该函数

```
{$P.menu_bilder_data|@make_menu} 
```

管道“|” 将 $P['menu_bilder_data'] 作为函数的第一个参数传递。而“@”使管道传递数组。如果没有“@”，将为数组中的所有元素调用该函数。

## 只是一个提示

将参数从 $parent（它是一个数组）更改为 $parent_id，所有菜单数据都可以从全局 $menu 中获得。

```
function make_menu($parent_id)
{      
  global $menu;
  if (!isset($menu[$parent_id])) {
     return;
  }
  $nodes = $menu[$parent_id];
  echo '<ul>';
  foreach($nodes as $menu_id => $menu_name)
  {
    echo '<li>'.$menu_name ; 
    make_menu($menu_id) ;
    echo '</li>';
  }
  echo '</ul>';
} 
```

来自聪明的：

```
{0|make_menu} 
```

# php - PHP 配置文件不会加载 IIS7 x64

> ID：899789
> 
> 赞同：3
> 
> 时间：2009-05-22T20:15:59.980
> 
> 标签：php, iis-7, fastcgi

使用 Fast CGI 我无法读取 php.ini 文件。请参阅下面的我的 phpinfo。

```
系统 Windows NT WIN-PAFTBLXQWYW 6.0 build 6001
构建日期 2009 年 3 月 5 日 19:43:24
配置命令 cscript /nologo configure.js "--enable-snapshot-build" "--enable-debug-pack" "--with-snapshot-template=d:\php-sdk\snap_5_2\vc6\x86\template" "--with-php-build=d:\php-sdk\snap_5_2\vc6\x86\php_build" "--disable-zts" "--disable-isapi" "--disable-nsapi" "--with- pdo-oci=D:\php-sdk\oracle\instantclient10\sdk,shared" "--with-oci8=D:\php-sdk\oracle\instantclient10\sdk,shared" "--enable-htscanner=shared"
服务器 API CGI/FastCGI
虚拟目录支持已禁用
配置文件 (php.ini) 路径 C:\Windows
加载的配置文件（无）
扫描此目录以获取其他 .ini 文件（无）

```

我的 php.ini 文件位于我的 c:\php 和我的 c:\windows 中，我确保它在这两个地方都具有网络服务的读取权限。

我已经添加了各种注册表设置、环境变量，并遵循了在网络上找到的多个教程，但目前还没有骰子。每次重启后。

我最初的安装是使用 MS“Web 平台安装程序”，但是我已经重新启动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T12:08:06.743

当我在加载 php.ini 文件时遇到问题时，我发现以下设置是完成它的关键。

```
--with-config-file-path=<path-to-php.ini> --sysconfdir=<path-to-php.ini> 
```

就我而言（在 Linux 上）是

```
./configure .....   --with-config-file-path=/etc --sysconfdir=/etc 
```

# c# - 如何将查询语法转换为方法语法

> ID：899799
> 
> 赞同：6
> 
> 时间：2009-05-22T20:17:45.297
> 
> 标签：c#, .net, linq, linq-to-xml

我在鬼混，试图学习 LINQ 的来龙去脉。我想将以下查询（工作正常）从查询语法转换为方法语法，但我似乎无法正确处理。谁能告诉我正确的方法来做到这一点？

```
var logQuery = from entry in xDoc.Descendants("logentry")
               where (entry.Element("author").Value.ToLower().Contains(matchText) ||
                      entry.Element("msg").Value.ToLower().Contains(matchText) ||
                      entry.Element("paths").Value.ToLower().Contains(matchText) ||
                      entry.Element("revision").Value.ToLower().Contains(matchText))
               select new
               {
                   Revision = entry.Attribute("revision").Value,
                   Author = entry.Element("author").Value,
                   CR = LogFormatter.FormatCR(entry.Element("msg").Value),
                   Date = LogFormatter.FormatDate(entry.Element("date").Value),
                   Message = LogFormatter.FormatComment(entry.Element("msg").Value),
                   ET = LogFormatter.FormatET(entry.Element("msg").Value),
                   MergeFrom = LogFormatter.FormatMergeFrom(entry.Element("msg").Value),
                   MergeTo = LogFormatter.FormatMergeTo(entry.Element("msg").Value)
               }; 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-22T20:19:57.350

其实很简单；

```
from entry in A
where B 
```

翻译（字面意思）为：

```
A.Where(entry=>B) 
```

和：

```
select C 
```

直接转换为（以“条目”作为我们的上下文）：

```
.Select(entry=>C) 
```

（除了什么时候是`entry=>entry`，编译器会忽略不重要的情况）

所以只需注入这些，你就完成了：

```
var logQuery = xDoc.Descendants("logentry")
               .Where(entry=>
                          entry.Element("author").Value.ToLower().Contains(matchText) ||
                          entry.Element("msg").Value.ToLower().Contains(matchText) ||
                          entry.Element("paths").Value.ToLower().Contains(matchText) ||
                          entry.Element("revision").Value.ToLower().Contains(matchText))
                .Select(entry=>new
                   {
                       Revision = entry.Attribute("revision").Value,
                       Author = entry.Element("author").Value,
                       CR = LogFormatter.FormatCR(entry.Element("msg").Value),
                       Date = LogFormatter.FormatDate(entry.Element("date").Value),
                       Message = LogFormatter.FormatComment(entry.Element("msg").Value),
                       ET = LogFormatter.FormatET(entry.Element("msg").Value),
                       MergeFrom = LogFormatter.FormatMergeFrom(entry.Element("msg").Value),
                       MergeTo = LogFormatter.FormatMergeTo(entry.Element("msg").Value)
                   }); 
```

# java - 我是否使用 MVC 正确实现了 n 层应用程序？

> ID：899803
> 
> 赞同：2
> 
> 时间：2009-05-22T20:18:23.407
> 
> 标签：java, model-view-controller, architecture, web-applications, n-tier-architecture

由于对设计模式和架构非常陌生，我很难向其他人解释我的最新应用程序是如何设计的。我已经在认为它是纯 n 层、纯 MVC 和表示层中带有 MVC 的 n 层之间切换。目前我认为后者是正确的，但我想要更有经验的开发人员的想法。

# 这个怎么运作：

1.  浏览器向 Tomcat 发送 HTTP 请求。通过 web.xml 将请求映射到一个 servlet（我称之为控制器）
2.  控制器实例化一个或多个业务对象并在这些对象上调用方法，即`customerBO.getById(12)`在调用一个或多个 DAO 方法之前再次执行业务逻辑/验证，即`customerDAO.getById(12)`。BO 将 CustomerVO 列表返回给控制器
3.  控制器为视图（JSP）准备属性`request.setAttribute("customers", customers);`（

# 结构（我的建议/理解）

**表示层**：目前使用我认为是 MVC Web 实现的方式：servlet（控制器）、jsp（视图）和我自己的 OO XHTML 表单实现（即 CustomerForm）就在这里。应该可以通过切换此表示层来使用 Swing/JavaFX/Flex GUI，而无需更改下面层上的任何内容。

**逻辑层**：分为两层，顶部是业务对象（BO）。负责业务逻辑，但除了输入验证之外，我还没有发现太多可在此处添加的内容，因为应用程序主要由简单的 CRUD 操作组成……在许多情况下，这些方法只是调用 DAO 层上具有相同名称的方法。

带有 CRUD 方法的 DAO 类，它再次与下面的数据层联系。还有一个 convertToVO(ResultSet res) 方法，它们从数据库执行 ORM 并到（列表）值对象。所有方法都将值对象作为输入，即 customerDAO->save(voter) 并在成功时返回更新的投票者，在失败时返回 null。

**数据层**：底层数据存储在数据库中或作为 XML 文件。除了一些 MySQL 存储过程和触发器，我在这里没有“编码”任何东西。

# 问题（除了标题中的问题）：

1.  MVC 中的 M。我不确定当模型是从逻辑层中的业务对象返回的列表/VO 时是否可以调用此 n 层 MVC？当控制器/视图在这里时，模型是否需要驻留在表示层中？表示层中的表单模板可以称为模型吗？如果是这样的话; BO 中的表单和列表是否都被视为 MVC 中的 M？
2.  据我了解，在 MVC 中，视图应该观察模型并根据变化进行更新，但这在视图是呈现 XHTML 页面的 Web 应用程序中是不可能的？这反过来又让我想到了一个问题：Web 应用程序与常规桌面应用程序的 MVC 实现方式是否不同？
3.  当所有 HTTP 请求都显式映射到 web.xml 时，我没有使用前端控制器模式，对吗？要使用前端控制器，我需要将所有请求转发到标准 servlet/控制器，然后再评估请求并调用另一个控制器？
4.  业务层在我的应用程序中感觉有点“无用”。您通常在此层/对象中放置什么？是否应该始终有一个业务层？我知道它应该包含“业务逻辑”，但这究竟是什么？我只是执行输入验证并实例化一个或多个 DAO 并在它们上调用适当的方法......

我意识到有 MVC 框架，例如 Struts for Java，但是自从这是我的第一个 Java Web 应用程序以来，我试图更深入地了解事物的工作原理。回想起来，我希望你能回答我偶然发现的一些问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T20:38:19.857

> 当模型是从逻辑层中的业务对象返回的列表/VO 时，我不确定是否可以调用此 n 层 MVC

这些都是非常好的模型。我还认为 Struts 中的 ActionForms 是模型。ActionForms 是 Struts 用来表示/建模 HTML 表单的。

> 在 MVC 中，视图应该观察模型并根据变化进行更新，但这在 Web 应用程序中是不可能的

是的，关于您是否可以在 Web 应用程序中拥有真正的 MVC，这是一个有争议的问题。

> 是否应该始终有一个业务层？

这取决于应用程序的类型。一些应用程序是数据库驱动的，本质上是数据库的 UI。在这种情况下，几乎不需要业务逻辑。

> 数据层：

存储过程实际上并不是数据层代码的一部分。您应该创建由业务对象调用的数据访问对象 (DAO)。DAO 调用存储过程。此外，DAO 接口不应向业务对象提供有关数据存储位置的提示，无论是数据库还是文件系统还是来自某些 Web 服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T22:34:40.183

我认为您对术语感到困惑。MVC 模式（我相信）早于您描述的经典 Web 应用程序架构。人们曾经将其称为 web app arch MVC 2（Model 2 等）以将其与原始 MVC 模式区分开来......

看到这个链接> [http://www.javaranch.com/drive/servlet/#mvc2](http://www.javaranch.com/drive/servlet/#mvc2)

高温高压

# python - 使用正则表达式填充整数

> ID：899804
> 
> 赞同：1
> 
> 时间：2009-05-22T20:18:36.777
> 
> 标签：python, regex

我正在使用带有 python 框架的正则表达式来填充版本号中的特定数字：

10.2.11

我想将第二个元素转换为用零填充，所以它看起来像这样：

10.02.11

我的正则表达式如下所示：

```
^(\d{2}\.)(\d{1})([\.].*) 
```

如果我只是反刍匹配组，我使用这个字符串：

```
\1\2\3 
```

当我使用我最喜欢的正则表达式测试工具 ( [http://kodos.sourceforge.net/](http://kodos.sourceforge.net/) ) 时，我无法让它填充第二组。我尝试了 \1\20\3，但这会将第二个引用解释为 20，而不是 2。

由于我正在使用它的库，我需要它是一个单行。该库接受一个正则表达式字符串，然后是一个用于替换它的字符串。

我假设我只需要转义匹配的组字符串，但我无法弄清楚。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T22:16:14.557

完全不同的方法怎么样？

```
nums = version_string.split('.')
print ".".join("%02d" % int(n) for n in nums) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T20:24:13.503

试试这个：

```
(^\d(?=\.)|(?<=\.)\d(?=\.)|(?<=\.)\d$) 
```

并将匹配替换为`0\1`. 这将使任何数字至少有两位数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T20:40:34.440

`.`从正则表达式中删除呢？

```
^(\d{2})\.(\d{1})[\.](.*) 
```

用。。。来代替：

```
\1.0\2.\3 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T20:23:48.607

您的图书馆是否支持[命名组](http://docs.python.org/howto/regex.html#non-capturing-and-named-groups)？那可能会解决你的问题。

# visual-studio - JSF 与 Flex

> ID：899808
> 
> 赞同：1
> 
> 时间：2009-05-22T20:19:49.427
> 
> 标签：visual-studio, apache-flex, jsf

我想选择一个 GUI 框架，并尽可能简单地使用 AJAX。假设在 JSF 和 Flex 方面都有足够的技能，但在 AJAX/javascript 方面不太熟练，假设 Java 作为应用程序的语言，并且使用 DB，这是一个不错的选择，或者两者都有相同的优缺点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T22:49:47.003

...Flex 的优点是：

*   Flex 框架构建的 SWF 文件在 Flash Player JIT 中运行，这比浏览器原生 JS 快 100 倍，除非您有支持 JS Jit 的浏览器，例如使用 SquirrelFish。因此，用户性能可能会有很大差异，而 Flash Player 在所有浏览器、所有平台上都以相同的性能运行。
*   Flex 框架是开源的，因此您可以根据自己的喜好对其进行自定义。而且由于它在 Flash 播放器上运行，所以它在任何地方都运行相同。与 AJAX 框架不同，您通常必须精通浏览器兼容性编码才能对其进行自定义。
*   Flex 工具也是免费的，因为 Flex SDK 是开源的。

话虽如此，如果您愿意，您可以使用 Adob​​e AIR 在 AJAX 中编写桌面应用程序，而无需使用 Flex 或 ActionScript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T15:46:36.680

尝试使用 Richfaces。由于 RichFaces 库将提供现成的支持 Ajax 的 JSF 组件。您可以在 JSF 应用程序中使用它们。

RichFaces 是一个丰富的 JSF 组件库和一个用于将 AJAX 功能轻松集成到业务应用程序开发中的高级框架。RichFaces 组件开箱即用，因此开发人员可以立即节省时间，利用组件功能创建 Web 应用程序，从而更可靠、更快速地提供显着改善的用户体验。RichFaces 还包括对 JSF 应用程序的换肤能力的强大支持。RichFaces 还充分利用了 JSF 框架的优势，包括生命周期、验证和转换工具，以及静态和动态资源的管理。

[http://www.jboss.org/jbossrichfaces/](http://www.jboss.org/jbossrichfaces/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T20:55:54.923

如何使用 Flex 发出 HTTP 请求：http: [//www.adobe.com/devnet/flex/quickstart/httpservice/](http://www.adobe.com/devnet/flex/quickstart/httpservice/)

AJAX 使用 JQuery（许多 JS 框架之一）： [http ://docs.jquery.com/Ajax](http://docs.jquery.com/Ajax)

一旦你玩过它们，这两者都非常简单。您指定一个 URL 和一个回调函数，以便在完成加载后读取文本响应。假设你熟悉 Flex 的优点，JS 的优点是：

*   它不需要浏览器插件
*   您不会使用 Flex 框架压低页面。
*   您可能会在市场上找到更多熟悉它的开发人员，因为开发工具是免费的，而且代码通常对任何想从中学习的人都是可见的。

# javascript - 编写 javascript 小部件的最佳实践

> ID：899812
> 
> 赞同：28
> 
> 时间：2009-05-22T20:20:41.170
> 
> 标签：javascript, widget

我有一个添加到其他网站的 JS 脚本（小部件）。从技术上讲，它类似于谷歌分析。我的问题是：对于确保健壮性、防止代码干扰网站上的其他代码、避免用户出错等方面，您有什么建议。总的来说，我应该知道什么来编写专业级的小部件。

注意：我不能使用任何 JS 库，例如 jquery 等。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-22T20:30:36.160

我是 Peter Michaux 关于[他如何编写 javascript 小部件的指南的忠实粉丝](http://peter.michaux.ca/articles/how-i-write-javascript-widgets)

[Christian Heilmann 的脚本配置](http://www.wait-till-i.com/2008/05/23/script-configuration/)和[模块模式](http://www.wait-till-i.com/2007/07/24/show-love-to-the-module-pattern/)也很有用

这些是通用的 javascript 文章，并不特定于单个库

其他有用的技巧是将代码包装在匿名函数中以阻止它干扰其他全局库。

```
(function() {
    //Your code goes in here
})(); 
```

关于错误和最佳实践，John Resig 有一篇关于[javascript strict](http://ejohn.org/blog/ecmascript-5-strict-mode-json-and-more/)的有趣文章尚未发表，但确实有一些关于您应该避免的事情的方便信息。

如果您仍然对对象内的范围界定感到满意，那么您可能会发现[这篇关于私有和公共变量的文章以及](http://phrogz.net/js/Classes/OOPinJS.html)[Douglas Crockford](http://www.crockford.com/javascript/private.html)的更多技术定义很有用

最后，记得通过[代码质量工具运行你完成的代码](http://www.jslint.com/)

# sql - 使用触发器记录对数据库表的更改

> ID：899825
> 
> 赞同：9
> 
> 时间：2009-05-22T20:24:05.203
> 
> 标签：sql, sql-server, sql-server-2005, logging

我正在寻找一种记录在我的 SQL Server 2005 数据库中的一组特定表上发生的更改的好方法。我相信最好的方法是通过在更新和删除时执行的触发器。无论如何要抓住正在运行的实际语句？一旦我有了声明，我就可以轻松地将它记录在其他地方（其他数据库表）。但是，我还没有找到一种简单的方法（如果可能的话）来获取正在运行的 SQL 语句。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-05-11T22:07:28.127

如果您只想在某些数据库表中保留**所有事务**（插入、更新和删除）的日志，则可以运行以下脚本：

```
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME= 'Audit')
  CREATE TABLE LogTable
  (
    LogID [int]IDENTITY(1,1) NOT NULL,
    Type char(1), 
    TableName varchar(128), 
    PrimaryKeyField varchar(1000), 
    PrimaryKeyValue varchar(1000), 
    FieldName varchar(128), 
    OldValue varchar(1000), 
    NewValue varchar(1000), 
    UpdateDate datetime DEFAULT (GetDate()), 
    UserName varchar(128)
  )
GO

DECLARE @sql varchar(8000), @TABLE_NAME sysname
SET NOCOUNT ON

SELECT @TABLE_NAME= MIN(TABLE_NAME)
FROM INFORMATION_SCHEMA.Tables 
WHERE 
--query for table that you want to audit
TABLE_TYPE= 'BASE TABLE' 
AND TABLE_NAME!= 'sysdiagrams'
AND TABLE_NAME!= 'LogTable'
AND TABLE_NAME!= 'one table to not record de log';

WHILE @TABLE_NAME IS NOT NULL
  BEGIN

  SELECT 'PROCESANDO ' + @TABLE_NAME;

  EXEC('IF OBJECT_ID (''' + @TABLE_NAME+ '_ChangeTracking'', ''TR'') IS NOT NULL DROP TRIGGER ' + @TABLE_NAME+ '_ChangeTracking')

  SELECT @sql = 'create trigger ' + @TABLE_NAME+ '_ChangeTracking on ' + @TABLE_NAME+ ' for insert, update, delete
    as
      declare 
        @bit int ,
        @field int ,
        @maxfield int ,
        @char int ,
        @fieldname varchar(128) ,
        @TableName varchar(128) ,
        @PKCols varchar(1000) ,
        @sql varchar(2000), 
        @UpdateDate varchar(21) ,
        @UserName varchar(128) ,
        @Type char(1) ,
        @PKFieldSelect varchar(1000),
        @PKValueSelect varchar(1000)

        select @TableName = ''' + @TABLE_NAME+ '''

        -- date and user
        select @UserName = system_user ,
        @UpdateDate = convert(varchar(8), getdate(), 112) + '' '' + convert(varchar(12), getdate(), 114)

        -- Action
        if exists (select * from inserted)
          if exists (select * from deleted)
            select @Type = ''U''
          else
            select @Type = ''I''
        else
          select @Type = ''D''

        -- get list of columns
        select * into #ins from inserted
        select * into #del from deleted

        -- Get primary key columns for full outer join
        select @PKCols = coalesce(@PKCols + '' and'', '' on'') + '' i.'' + c.COLUMN_NAME + '' = d.'' + c.COLUMN_NAME
          from INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
          INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
          where pk.TABLE_NAME = @TableName
          and CONSTRAINT_TYPE = ''PRIMARY KEY''
          and c.TABLE_NAME = pk.TABLE_NAME
          and c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME

        -- Get primary key fields select for insert(comma deparated)           
        select @PKFieldSelect = coalesce(@PKFieldSelect+''+'','''') + '''''''' + COLUMN_NAME + '','''''' 
          from INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
          INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
          where pk.TABLE_NAME = @TableName
          and CONSTRAINT_TYPE = ''PRIMARY KEY''
          and c.TABLE_NAME = pk.TABLE_NAME
          and c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME

        -- Get primary key values for insert(comma deparated as varchar)           
        select @PKValueSelect = coalesce(@PKValueSelect+''+'','''') + ''convert(varchar(100), coalesce(i.'' + COLUMN_NAME + '',d.'' + COLUMN_NAME + ''))'' + ''+'''','''''' 
          from INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,    
          INFORMATION_SCHEMA.KEY_COLUMN_USAGE c   
          where  pk.TABLE_NAME = @TableName   
          and CONSTRAINT_TYPE = ''PRIMARY KEY''   
          and c.TABLE_NAME = pk.TABLE_NAME   
          and c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME 

        if @PKCols is null
        begin
          raiserror(''no PK on table %s'', 16, -1, @TableName)
          return
        end

        select @sql = ''insert LogTable(Type, TableName, PrimaryKeyField, PrimaryKeyValue, UserName)''
        select @sql = @sql + '' select '''''' + @Type + ''''''''
        select @sql = @sql + '','''''' + @TableName + ''''''''
        select @sql = @sql + '','' + @PKFieldSelect
        select @sql = @sql + '','' + @PKValueSelect
        select @sql = @sql + '','''''' + @UserName + ''''''''

        select @sql = @sql + '' from #ins i full outer join #del d''
        select @sql = @sql + @PKCols        

        exec (@sql)
    ';
  SELECT @sql
  EXEC(@sql)

  SELECT @TABLE_NAME= MIN(TABLE_NAME) FROM INFORMATION_SCHEMA.Tables 
    WHERE TABLE_NAME> @TABLE_NAME
    --query for table that you want to audit
    AND TABLE_TYPE= 'BASE TABLE' 
    AND TABLE_NAME!= 'sysdiagrams'
    AND TABLE_NAME!= 'LogTable'
    AND TABLE_NAME!= 'one table to not record de log';
END 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-22T20:31:13.520

您应该能够使用[系统管理视图](http://www.mssqltips.com/tip.asp?tip=1363)来完成此操作。

一个例子是这样的：

```
SELECT er.session_id,
  er.status,
  er.command,
  DB_NAME(database_id) AS 'DatabaseName',
  user_id,
  st.text
FROM sys.dm_exec_requests AS er
  CROSS APPLY sys.dm_exec_sql_text(er.sql_handle) AS st
WHERE er.session_id = @@SPID; 
```

不过，我不确定这对您是否会像更以数据为中心的日志记录机制一样有用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T20:47:28.013

不要忘记您的日志记录将成为事务的一部分，因此如果出现错误并且您回滚事务，您的日志也将被删除。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T20:31:36.563

MSSQL 有名为“Inserted”和“Deleted”的虚拟表，其中包含新插入和/或新删除和/或新更新的数据记录，您可以从触发器访问这些记录......我使用这些来了解什么数据已经改变（而不是被告知是什么语句改变了数据）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-03T01:04:46.857

有一种用于创建此类触发器的模式，称为**Log Trigger**。这是独立于供应商的并且非常简单。它在[此处](http://en.wikipedia.org/wiki/Log_trigger)进行了描述。

更改记录在另一个*历史记录*表中。无法获取确切的语句，但可以检测它是插入、更新还是删除，因为它创建了一组“链式”记录。插入是没有前任的记录，删除是没有后继的记录，中间记录是更新。可以将记录与其前身进行比较来检测更改。

在给定时间点获取单个实体（或整个表）的*快照*非常容易。

作为奖励，与 Oracle、DB2 和 MySQL 相比，SQL Server 的这种模式的语法恰好是最简单的一种。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-22T20:31:25.020

你真的需要记录运行的语句吗，大多数人记录更改的数据（触发器中的 INSERTED 和 DELETED 表）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-22T21:17:13.273

触发器不好，我会远离触发器。

如果您尝试排除故障，请将[Sql Profiler](http://msdn.microsoft.com/en-us/library/ms173757.aspx)附加到具有特定条件的数据库。这将记录每个查询运行以供您检查。

另一种选择是更改为调用程序来记录其查询。这是一种非常普遍的做法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-22T21:54:17.660

触发器是确保记录任何更改的好方法，因为无论更新如何执行，它们几乎总是会触发——例如，即席连接以及应用程序连接。

正如@mwigdahl 所建议的那样，系统管理视图看起来像是捕获当前正在运行的批处理的好方法。这对于登录触发器是否特别有用是另一回事。

使用触发器的一个缺点是您只能从数据库连接中识别更新源。许多应用程序没有与连接关联的任何用户信息，以方便连接池，因此您不知道哪个用户正在执行操作。即连接使用的登录名是通用应用程序登录名，而不是使用该应用程序的人。解决此问题的常规方法是使用存储过程作为所有数据库交互的接口，然后确保通过所有过程调用传递 UserId。然后，您可以通过存储过程而不是触发器来执行日志记录。显然，这仅在您知道人们在不使用过程的情况下不会直接更新表或不需要记录这种情况时才有用。

获取当前正在执行的批处理的能力可能会提供更好的机制：如果您确保所有 sql 批处理都包含一个 UserId，那么您可以从触发器中的 sql 中提取它。这将允许您使用触发器进行所有日志记录，这意味着您可以捕获所有内容，还可以让您将更改与特定用户相关联。

如果您要沿着触发路线前进，则值得检查未触发的情况触发器（可能是批量加载数据？或者人们是否有权禁用触发器）。

还要考虑@idstam 指出的触发代码将在您的事务中，因此通常会被记录并随之回滚。

编写触发器时要考虑的另一件事是[@@IDENTITY](http://msdn.microsoft.com/en-us/library/aa933167(SQL.80).aspx)的行为：如果您有使用 @@IDENTITY 的过程，您可能会不小心改变它们的行为。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-02-07T20:20:26.457

使用[日志触发器](http://en.wikipedia.org/wiki/Log_trigger)

几乎没有理由捕获实际的 SQL，因为可以有许多不同的语句以相同的方式更改数据。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-04-17T09:14:21.517

尝试安装一些基于触发器的第三方工具，例如[ApexSQL Audit](http://www.apexsql.com/sql_tools_audit.aspx)，然后逆向工程他们是如何做到的。只需在试用模式下安装它，看看它如何生成触发器来捕获所有不同类型的信息。

需要考虑的其他几件事是：

存储规划——如果您有大量更新，则意味着您将拥有大量审计数据。我会考虑将这些数据存储在单独的数据库中。特别是如果您计划审计多个数据库。

管理数据量——随着时间的推移，您可能不再需要保留一些非常旧的记录。计划轻松删除旧数据

架构更改——如果架构更新了怎么办。在最坏的情况下，如果创建不正确，您的触发器将停止工作并引发错误。在最好的情况下，你会错过一些数据。这也是要考虑的事情。

考虑到所有这些，使用一些已经开发的解决方案可能是最有效的时间，而不是自己从头开始创建。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-10-11T17:23:29.207

这改编自胡安卡洛斯贝莱斯的回答。我对其进行了修改以考虑复合主键和包含空格的列名。此外，我在整个过程中都对其进行了评论，以便那些想要为他们的目的修改它的人可以理解每一步发生的事情，如果他们不清楚代码。

```
-- This stops the message that shows the count of the number of rows affected from being returned as part of the result set.
set nocount on

-- If the Audit table doesn't exist, create it.
if not exists(select * from INFORMATION_SCHEMA.TABLES where TABLE_NAME = 'Audit')
create table Audit
(
    AuditID [int] identity(1,1) not null,
    [Type] char(1), 
    TableName nvarchar(128), 
    PKFields nvarchar(max),
    PKValues nvarchar(max),
    FieldName nvarchar(128), 
    OldValue nvarchar(max), 
    NewValue nvarchar(max), 
    UpdateDate datetime, 
    UserName nvarchar(128)
)
go

-- Variables for the dynamic SQL and table name.
declare @tr nvarchar(max),
@tableName sysname

-- Get the first table in database. Skip over views and a few specified tables.
select @tableName = min(TABLE_NAME) from INFORMATION_SCHEMA.TABLES where TABLE_TYPE = 'BASE TABLE' and TABLE_NAME <> 'sysdiagrams' and TABLE_NAME <> 'Audit'
---- If you want to specify certain tables, uncomment the next line and add your table names.
--and (TABLE_NAME = 'IGAs' or TABLE_NAME = 'IGABudgets' or TABLE_NAME = 'Resolutions' or TABLE_NAME = 'RTAProjects' or TABLE_NAME = 'RTASubProjects')

-- Loop through the tables in the database and create an audit trigger on each one.
while @tableName is not null
begin

    -- If a trigger of the same name already exists, delete it.
    exec('if OBJECT_ID (''' + @tableName + '_ChangeTracking'', ''TR'') is not null drop trigger ' + @tableName + '_ChangeTracking')

    -- Check if there is a primary key. If not, throw an error.
    if (select count(*) from INFORMATION_SCHEMA.TABLE_CONSTRAINTS c, INFORMATION_SCHEMA.KEY_COLUMN_USAGE u where c.TABLE_NAME = @tableName and c.CONSTRAINT_TYPE = 'PRIMARY KEY' and u.TABLE_NAME = c.TABLE_NAME and u.CONSTRAINT_NAME = c.CONSTRAINT_NAME) = 0
    begin
        raiserror('Error: There is no primary key on table %s', 16, -1, @tableName)
        return
    end

    -- Create the trigger.
    select @tr = 'create trigger ' + @tableName + '_ChangeTracking on ' + @tableName + ' for insert, update, delete as

    -- Misc variables.
    declare @table nvarchar(128),
    @fieldName nvarchar(128) = '''',
    @type char(1),
    @pkJoin nvarchar(max),
    @pkSelect nvarchar(max),
    @pkFields nvarchar(max),
    @pkValues nvarchar(max),
    @updateDate nvarchar(30) = convert(varchar(30), getdate(), 22),
    @user nvarchar(128) = system_user,
    @sql nvarchar(max),
    @params nvarchar(max) = N''@out nvarchar(max) output'',
    @fieldIndex int = 0,
    @maxField int,
    @bit int,
    @char int

    -- Get the table name.
    select @table = object_name(parent_id) from sys.triggers where object_id = @@PROCID

    -- Get the modification type: U = update, I = insert, D = delete
    if exists (select * from inserted)
        if exists (select * from deleted)
            select @type = ''U''
        else select @type = ''I''
    else select @type = ''D''

    -- Save the inserted and deleted values into temp tables.
    select * into #ins from inserted
    select * into #del from deleted

    -- Get the number of columns in the table.
    select @maxField = max(columnproperty(object_id(@table), COLUMN_NAME, ''ColumnID'')) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @table

    -- Get the primary key join relationship(s).
    select @pkJoin = coalesce(@pkJoin + '' and'', '' on'') + '' i.['' + u.COLUMN_NAME + ''] = d.['' + u.COLUMN_NAME + '']''
    from INFORMATION_SCHEMA.TABLE_CONSTRAINTS c, INFORMATION_SCHEMA.KEY_COLUMN_USAGE u
    where c.TABLE_NAME = @table
    and c.CONSTRAINT_TYPE = ''PRIMARY KEY''
    and u.TABLE_NAME = c.TABLE_NAME
    and u.CONSTRAINT_NAME = c.CONSTRAINT_NAME

    -- Get the primary key field name(s).
    select @pkFields = coalesce(@pkFields + '', '', '''') + ''['' + u.COLUMN_NAME + '']''
    from INFORMATION_SCHEMA.TABLE_CONSTRAINTS c, INFORMATION_SCHEMA.KEY_COLUMN_USAGE u
    where c.TABLE_NAME = @table
    and c.CONSTRAINT_TYPE = ''PRIMARY KEY''
    and u.TABLE_NAME = c.TABLE_NAME
    and u.CONSTRAINT_NAME = c.CONSTRAINT_NAME

    -- Get the primary key field(s) for select statement.
    select @pkSelect = coalesce(@pkSelect + '' + '''', '''' + '', '''') + ''convert(nvarchar(max), ['' + u.COLUMN_NAME + ''])''
    from INFORMATION_SCHEMA.TABLE_CONSTRAINTS c, INFORMATION_SCHEMA.KEY_COLUMN_USAGE u
    where c.TABLE_NAME = @table
    and c.CONSTRAINT_TYPE = ''PRIMARY KEY''
    and u.TABLE_NAME = c.TABLE_NAME
    and u.CONSTRAINT_NAME = c.CONSTRAINT_NAME

    -- Get the primary key field value(s).
    if (@type = ''D'')
    begin
        set @sql = ''select @out = '' + @pkSelect + '' from #del''
        exec sp_executesql @sql, @params, @out = @pkValues output
    end
    else
    begin 
        set @sql = ''select @out = '' + @pkSelect + '' from #ins''
        exec sp_executesql @sql, @params, @out = @pkValues output
    end

    -- Loop through each field in the inserted table.
    while @fieldIndex < @maxField
    begin

        -- Iterate the fieldIndex.
        select @fieldIndex = min(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @table and columnproperty(object_id(@table), COLUMN_NAME, ''ColumnID'') > @fieldIndex 

        -- If the column in scope has been modified, insert a record into the Audit table.
        select @bit = (@fieldIndex - 1)% 8 + 1
        select @bit = POWER(2, @bit - 1)
        select @char = ((@fieldIndex - 1) / 8) + 1
        if substring(columns_updated(), @char, 1) & @bit > 0 or @Type IN (''I'', ''D'')
        begin

            -- Get the name of the field whose ColumnID equals the current fieldIndex.
            select @fieldName = ''['' + COLUMN_NAME + '']'' from INFORMATION_SCHEMA.COLUMNS 
            where TABLE_NAME = @table and columnproperty(object_id(@table), COLUMN_NAME, ''ColumnID'') = @fieldIndex '

    -- Select statements have a length limitation. End the statement, then add the rest.
    select @tr = @tr + '

            set @sql = ''insert into Audit (Type, TableName, PKFields, PKValues, FieldName, OldValue, NewValue, UpdateDate, UserName) select '''''' + @type + '''''', '''''' + @table + '''''', '''''' + @pkFields + '''''', '''''' + @pkValues + '''''', '''''' + @fieldName + '''''', convert(nvarchar(max), d.'' + @fieldName + ''), convert(nvarchar(max), i.'' + @fieldName + ''), '''''' + @updateDate + '''''', '''''' + @user + '''''' from #ins i full outer join #del d'' + @pkJoin + '' where i.'' + @fieldName + '' <> d.'' + @fieldName + '' or (i.'' + @fieldName + '' is null and d.'' + @fieldName + '' is not null) or (i.'' + @fieldName + '' is not null and d.'' + @fieldName + '' is null)''

            --print(@sql)
            exec(@sql)

        end
    end'

    ---- This is if you want to see the statement that is generated rather than execute it.
    --select @tr

    -- Execute the trigger statement.
    exec(@tr)

    -- Iterate the table name.
    select @tableName = min(TABLE_NAME) from INFORMATION_SCHEMA.TABLES 
    where TABLE_NAME > @tableName and
    TABLE_TYPE = 'BASE TABLE' and TABLE_NAME <> 'sysdiagrams' and TABLE_NAME <> 'Audit'
    ---- If you want to specify certain tables, uncomment the next line and add your table names.
    --and (TABLE_NAME = 'IGAs' or TABLE_NAME = 'IGABudgets' or TABLE_NAME = 'Resolutions' or TABLE_NAME = 'RTAProjects' or TABLE_NAME = 'RTASubProjects')

end 
```

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2009-05-22T21:59:53.170

这里要小心，因为触发器在 ROW 级别触发，而不是 SQL STATEMENT 级别。因此，如果有人执行“DELETE FROM BIGTABLE”，您的触发器将为该表中的每一行触发（这特别是关于您想知道执行该操作的 SQL 语句的事实，因此您需要“图该语句影响的每一行）。

# regex - 从自由格式文本中提取国际街道地址/电话号码

> ID：899842
> 
> 赞同：2
> 
> 时间：2009-05-22T20:28:25.213
> 
> 标签：regex, street-address

嘿伙计。我正在寻找一些正则表达式来帮助从自由格式文本（a la Gmail）中获取街道地址和电话号码。

给定一些文字：`"John, I went to the store today, and it was awesome! Did you hear that they moved to 500 Green St.? ... Give me a call at +14252425424 when you get a chance."`

我希望能够退出：

`500 Green St.`（识别为街道地址）

`+14252425424`（识别为电话号码）

使这个问题更容易的是我不关心解析被拉出的文本。也就是说，我不在乎那`Green`是道路的名称还是`425`区号。我只想获取“看起来像”地址或电话号码的字符串。

不幸的是，这需要尽可能在国际上发挥作用。

有人有线索吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-13T11:04:56.213

电话号码只要你有所有国家代码和数字格式的列表很容易，街道地址我不知道，我能给你的唯一建议是验证每组单词@addressdoctor.com

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-09T09:12:11.573

您可以尝试一下 RecogniContact (-> [address-parser.com](http://address-parser.com) )，它可以识别邮政地址和电话号码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T21:34:40.850

看看[Dive Into Python 的第 7 章](http://www.diveintopython.org/regular_expressions/index.html)。它涉及电话号码和街道地址。我相信你可以以此为起点。国际部分似乎很难。我建议你建立一个初稿，在几个地方尝试，迭代和改进。

# .net - 从 .net 2.0 升级到 3.5 时的兼容性

> ID：899847
> 
> 赞同：3
> 
> 时间：2009-05-22T20:29:51.247
> 
> 标签：.net, compatibility

目前，我们仍在使用 2.0 框架，虽然 2.0 提供了我们目前所需的所有必要条件，但我们迟早必须转向 3.5。前几天，内部讨论了这次升级是否有任何风险，这个风险不能掉以轻心，因为我们所有的客户仍在使用 2.0 框架。有一位同事表示，将我们所有的产品针对 3.5 框架重新编译并完成新的推出会更安全。这将解决任何兼容性问题。确实有很多工作，也许是不必要的，我相信微软认为该框架是向后兼容的，我们为什么要对此有任何疑问？我是对的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T20:35:15.400

它不是 100%.... 最重要的是，3.5 和 3.5SP1 都包含 2.0 和（后来的）3.0 的服务包；这些变化并非都是微不足道的。

作为关键；如果您开始在 SP1 中使用类型，**即使在您认为是 2.0**的情况下，它也会在“正确的”2.0 客户端上失败。IIRC 有一个 FX cop 工具可以帮助避免这种情况。其次，（在服务包中）对核心深处的事物进行了更改 - 例如，池线程的数量（或者是池线程的堆栈大小......该区域的某些东西）如果你会咬你不走运。

此外，在 2.0 代码中有错误修复；如果您碰巧（偶然）依赖于服务包（SP1/SP2）中更改的行为......

**但**也不要忘记你**现在**有这个问题；如果您的客户**已**安装 .NET 3.5，那么他们已使用 2.0 服务包；-p

所以不要完全忽视它——但如果你采取适当的预防措施（通过测试），它应该是可以实现的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T20:35:10.783

我注意到的最重要的事情是安装 .net 3.5，你会得到 .net 2.0 SP1。Hanselman 有一篇[文章](http://www.hanselman.com/blog/CatchingRedBitsDifferencesInNET20AndNET20SP1.aspx)显示了这些变化（“红色位”）。

就个人而言，如果这让你感觉更好，我没有问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T20:35:16.947

当我们从 2.0 Framework 迁移到 3.5 时，我们能够毫无问题地做到这一点。原因是 3.5 框架本质上是 2.0 框架的扩展，这就是为什么当您进入 IIS 为网站设置 .NET 框架时，您会看到 .NET 2.0 而不是 3.0 / 3.5（例如）。

现在关于您的客户仍然使用 2.0 框架的问题，您需要确保发生的是您的开发人员将他们的 IDE 设置为在 VS2008 中针对 2.0 框架而不是 3.5，直到您的客户升级。这是为了确保 LINQ 等任何 3.5 功能都不会被使用并编译到应用程序中，并在部署应用程序时导致错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T20:35:15.400

不完全的。.NET 3.5 为 .NET 2.0 安装了一个服务包，因此风险不为零。我们有一个应用程序在升级到 .NET 3.5 后出现故障 - WinForms 应用程序中绑定源的当前行在我们尚未完全分析的某些情况下表现不同。

我认为重新编译不会有任何区别（在上述情况下肯定没有），但升级会导致问题的风险很小，您需要进行一些回归测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T19:04:28.113

需要注意的重要一点是 .NET 3.0、3.5 和 3.5SP1 并不是新的运行时。所有四个“框架”都在 .NET 2.0 运行时（CLI、CLR、GC）上运行。.NET 3.0 和 3.5 框架实际上是对 .NET 2.0 框架的扩展。使用 .NET 3.0 和 3.5 通常不会出现任何问题...但是 .NET 3.5 SP1 包含现有 .NET 2.0 类的一些更新版本，这些更新版本在少数（极少数）情况下添加或更改了方法签名或行为。您遇到这些问题之一的机会非常非常低，但机会仍然存在：

[http://forums.asp.net/t/1305800.aspx](http://forums.asp.net/t/1305800.aspx) [http://www.hanselman.com/blog/UpdateOnNETFramework35SP1AndWindowsUpdate.aspx](http://www.hanselman.com/blog/UpdateOnNETFramework35SP1AndWindowsUpdate.aspx)

# sql - 有没有更快的方法通过 ActiveRecord 从 MySQL 表中获取随机记录？

> ID：899850
> 
> 赞同：0
> 
> 时间：2009-05-22T20:30:40.527
> 
> 标签：sql, mysql, ruby-on-rails, ruby

在 Rails 应用程序中，我使用它从 MySQL 表中获取随机行：

```
contact = Contact.find(:all, :limit => 1, :order => 'RAND()')[0] 
```

即使该表只有大约 20,000 行，也需要几秒钟。有谁知道更快的方法？

* * *

更新

还尝试在控制台中运行 SQL ......

```
SELECT * FROM `contacts` ORDER BY RAND() LIMIT 1 
```

它仍然需要很长时间，比如两三秒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T20:56:50.193

从红宝石中获取一兰特，然后将其转换为您的主键

# macos - 从终端删除 Safari cookie

> ID：899851
> 
> 赞同：5
> 
> 时间：2009-05-22T20:31:05.800
> 
> 标签：macos, safari, terminal, applescript

我正在制作一个涉及从 Applescript 控制 Safari 的应用程序。终端（首选）或 Applescript 中是否有清除 Safari cookie 的方法。基本上我想使用终端从菜单中的“重置 Safari”项。有没有一种方法可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-12-06T18:40:50.183

重置 Safari 不仅仅是删除 cookie：

> 基本上我想使用终端从菜单中的“重置 Safari”项。

如果您想从终端完全重置 Safari，您可以使用（取决于 Safari 版本，命令可能会有所不同）：

```
rm ~/Library/Safari/History.plist

rm ~/Library/Safari/Downloads.plist

rm ~/Library/Safari/HistoryIndex.sk

rm ~/Library/Safari/LastSession.plist

rm ~/Library/Safari/TopSites.plist

rm -rf ~/Library/Caches/com.apple.safari 
```

**而且**（对最后一个有点不确定）：

```
rm ~/Library/Safari/SearchProviders.plist.signed 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T20:35:32.810

您可以简单地删除该`Cookies.plist`文件：

```
rm ~/Library/Cookies/Cookies.plist 
```

或者看看这个：[列出和删除 Safari cookie](http://codesnippets.joyent.com/posts/show/1820)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-22T12:53:05.120

您可以使用以下 AppleScript 重置 Safari（必须启用 GUI 脚本）：

```
tell application "System Events"
tell process "Safari"
    set frontmost to true
    click menu item "Reset Safari…" of menu 1 of menu bar item "Safari" of menu bar 1
    --delay 1 --may be uncommented if needed
    click button "Reset" of window 1
end tell
end tell 
```

# .net - 我可以签署我没有源代码的程序集吗？

> ID：899856
> 
> 赞同：15
> 
> 时间：2009-05-22T20:31:40.697
> 
> 标签：.net, assemblies

我收到了来自第三方的组装。我需要将它添加到 GAC，但它没有强名称。有什么方法可以让我使用自己的密钥对程序集进行签名，以便将其命名为强名称？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-22T20:34:03.750

是的。您可以使用[ILDASM](http://en.wikipedia.org/wiki/Common_Intermediate_Language#Generation)将程序集反汇编为[CIL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)代码，然后使用[ILAsm](https://en.wikipedia.org/wiki/ILAsm)重新组装该 CIL 代码并使用您自己的密钥对其进行签名。

我已经使用各种第三方程序集完成了此操作，并且效果很好。

*[.NET-fu: Signing an Unsigned Assembly (Without Delay Signing)](http://buffered.io/posts/net-fu-signing-an-unsigned-assembly-without-delay-signing/)*帖子详细解释了如何执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T20:33:46.917

是的，这是可能的。然而，解决方案并不简单。您将在 .NET-fu 中找到有关签署第三方程序集的说明*[：签署未签名的程序集（无延迟签名）](http://buffered.io/posts/net-fu-signing-an-unsigned-assembly-without-delay-signing/)*。

# java - 在 Internet Explorer 中通过 HTTPS 使用 ServletOutputStream 从 Servlet 返回 CSV 文件

> ID：899858
> 
> 赞同：6
> 
> 时间：2009-05-22T20:32:13.097
> 
> 标签：java, servlets, jakarta-ee

我有一个 Servlet，它返回一个 csv 文件，该文件在 Internet Explorer 和 firefox 中都通过 HTTP “工作”。当我通过 HTTPS 执行相同的 Servlet 时，只有 firefox 继续通过 HTTPS 下载 csv 文件。我认为这不一定是[MSDN](http://support.microsoft.com/kb/812935)上描述的 Internet 6 或 7 问题：

消息是：

> Internet Explorer 无法从 mydomain.com 下载 data.csv Internet Explorer 无法打开此 Internet 站点。请求的站点不可用或找不到。请稍后再试。

请注意，在此消息之后该站点仍处于“启动”状态，您可以继续浏览该站点，它只是提示此消息的 CSV 下载。我已经能够通过 IE 上的 https 从其他 j2ee 应用程序访问类似的文件，所以我相信这是我们的代码。 **我们不应该关闭 bufferedOutputStream 吗？**

**更新**

**是否关闭输出流：** 我在java posse论坛上问过这个问题，那里的[讨论](http://groups.google.com/group/javaposse/browse_thread/thread/3213a24d63e371f6)也很有见地。最后，似乎没有容器应该依赖“客户端”（在这种情况下是您的 servlet 代码）来关闭此输出流。因此，如果您未能关闭 servlet 中的流导致出现问题，则它更多地反映了 servlet 容器的不良实现而不是您的代码。我定位了来自 Sun、Oracle 和 BEA 的 IDE 和教程的行为，以及它们在是否关闭流方面也不一致。

**关于 IE 特定行为**：在我们的案例中，一个单独的产品“Oracle Web 缓存”引入了额外的标头值，这仅因为 IE 实现“无缓存”要求的方式而影响 Internet Explorer（[请参阅 MSDN 文章](http://blogs.msdn.com/ieinternals/archive/2009/10/02/Internet-Explorer-cannot-download-over-HTTPS-when-no-cache.aspx)）。代码是：

```
public class DownloadServlet extends HttpServlet {
    public void doGet(HttpServletRequest request, 
                      HttpServletResponse response) throws ServletException, 
                                                           IOException {
        ServletOutputStream out = null;
        ByteArrayInputStream byteArrayInputStream = null;
        BufferedOutputStream bufferedOutputStream = null;
        try {
            response.setContentType("text/csv");
                        String disposition = "attachment; fileName=data.csv";
            response.setHeader("Content-Disposition", disposition);

            out = response.getOutputStream();
            byte[] blobData = dao.getCSV();

            //setup the input as the blob to write out to the client
            byteArrayInputStream = new ByteArrayInputStream(blobData);
            bufferedOutputStream = new BufferedOutputStream(out);
            int length = blobData.length;
            response.setContentLength(length);
            //byte[] buff = new byte[length];
             byte[] buff = new byte[(1024 * 1024) * 2];

            //now lets shove the data down
            int bytesRead;
            // Simple read/write loop.
            while (-1 != 
                   (bytesRead = byteArrayInputStream.read(buff, 0, buff.length))) {
                bufferedOutputStream.write(buff, 0, bytesRead);
            }
            out.flush();
            out.close();

        } catch (Exception e) {
            System.err.println(e); throw e;

        } finally {
            if (out != null)
                out.close();
            if (byteArrayInputStream != null) {
                byteArrayInputStream.close();
            }
            if (bufferedOutputStream != null) {
                bufferedOutputStream.close();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T20:55:23.020

我真的很困惑你的“从背部穿过乳房到头部”的写入机制。为什么不简单（servlet 输出流将是 bufferend，那是容器的东西）：

```
byte[] csv = dao.getCSV();
response.setContentType("text/csv");
response.setHeader("Content-Disposition", "attachment; filename=data.csv"));
reponse.setContentLength(csv.length);
ServletOutputStream out = response.getOutputStream();
out.write(csv); 
```

也不需要刷新输出流或关闭。

IE 不应该对标头内容进行区分大小写的解析，但谁知道呢：不要使用 camelcase `fileName`。下一个问题是编码。CSV 是文本，因此您应该使用`getWriter(`) 或 g`etOutputStream()`并将内容类型设置为“text/csv; charset=UTF-8”。但是`dao`应该提供 CSV 作为字符串而不是字节 []。

servlet 代码与 HTTPS 无关，因此协议在服务器端无关紧要。我希望您可以使用 HTTP 从 localhost 测试 servlet。

你的应用程序中的过滤器怎么样？例如，过滤器也可以设置带有缓存控制的 HTTP 标头（或作为页脚）。

# c++ - 在 C++ 中进行快速除法的好方法？

> ID：899861
> 
> 赞同：14
> 
> 时间：2009-05-22T20:32:48.213
> 
> 标签：c++, performance, math

有时我看到并使用以下变体在 C++ 中使用浮点数进行快速除法。

```
// orig loop
double y = 44100.0;
for(int i=0; i<10000; ++i) {
double z = x / y;
}

// alternative
double y = 44100;
double y_div = 1.0 / y;

for(int i=0; i<10000; ++i) {
double z = x * y_div;
} 
```

但最近有人暗示，这可能不是最准确的方法。

有什么想法吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-22T21:01:40.557

在几乎每个 CPU 上，浮点除法的成本是浮点乘法的几倍，因此乘以除数的倒数是一个很好的优化。不利的一面是，在某些处理器上，您可能会损失*很小*一部分的准确度——例如，在现代 x86 处理器上，使用默认 FPU 模式时，64 位浮点运算实际上是在内部使用 80 位计算的，并且存储它在变量中关闭将导致根据您的 FPU 舍入模式（默认为最接近的）截断那些额外的精度位。仅当您连接许多浮点操作并且必须担心错误累积时，这才真正重要。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-22T20:41:54.920

[维基百科](http://en.wikipedia.org/wiki/Division_(digital))同意这可以更快。链接的文章还包含其他几种可能感兴趣的快速除法算法。

我猜想任何工业级的现代编译器都会为你进行优化，如果它能让你受益的话。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T20:42:28.677

你的原创

```
// original loop:
double y = 44100.0;

for(int i=0; i<10000; ++i) {
    double z = x / y;
} 
```

可以很容易地优化为

```
// haha:
double y = 44100.0;
double z = x / y; 
```

并且性能非常好。;-)

**编辑：**人们一直对此投反对票，所以这是不太有趣的版本：

如果有一种通用方法可以在所有情况下更快地进行除法，那么您不认为编译器编写者现在可能已经发生了吗？他们当然会这样做。此外，一些做 FPU 电路的人也不完全是愚蠢的。

因此，获得更好性能的唯一方法是了解手头的具体情况并为此编写最佳代码。这很可能完全是在浪费您的时间，因为您的程序由于某些其他原因而运行缓慢，例如对循环不变量执行数学运算。去寻找一个更好的算法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-03-24T18:23:54.117

在您的示例中，使用`gcc`带有选项的除法`-O3 -ffast-math`产生与不带`-ffast-math`. （在有足够挥发物的测试环境中，循环仍然存在。）

因此，如果您真的想优化这些部门并且不关心后果，那就是要走的路。顺便说一句，乘法似乎快了大约 15 倍。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-22T20:37:39.063

乘法比除法快，所以第二种方法更快。它可能会稍微不那么准确，但除非你在做核心数字，否则准确度应该绰绰有余。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-03-24T18:44:01.367

在处理音频时，我更喜欢使用定点数学。我想这取决于您需要的精度水平。但是，让我们假设 16.16 定点整数可以（意味着高 16 位是整数，低 16 位是小数）。现在，所有计算都可以通过简单的整数数学来完成：

```
unsigned int y = 44100 << 16;
unsigned int z = x / (y >> 16);  // divisor must be the whole number portion 
```

或使用宏来帮助：

```
#define FP_INT(x) (x << 16)
#define FP_MUL(x, y) (x * (y >> 16))
#define FP_DIV(x, y) (x / (y >> 16))

unsigned int y = FP_INT(44100);
unsigned int z = FP_MUL(x, y); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-03-24T17:37:53.133

音频，嗯？当您同时运行五个音频轨道时，这不仅仅是每秒 44,100 个分区。毕竟，即使是一个简单的推子也会消耗周期。这只是一个相当简单的、最小的例子——如果你想拥有一个均衡器和一个压缩器怎么办？也许有点混响？可以这么说，你的总数学预算很快就被吃光了。在这些情况下，挤出一点额外的性能*确实*是有意义的。

分析器很好。探查器是您的朋友。剖析师应该得到口交和布丁。但是你已经知道音频工作的主要瓶颈在哪里——它在处理样本的循环中，你越快做到这一点，你的用户就会越快乐。尽你所能！乘以倒数，尽可能移动位（exp(x*y) = exp(x)*exp(y)，毕竟），使用查找表，通过引用而不是值来引用变量（更少的压栈/弹出栈)、重构术语等。（如果你做得好，你会嘲笑这些基本的优化。）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-03-24T17:58:07.127

我从原始帖子中推测 x 不是那里显示的常数，而是可能来自数组的数据，因此 x[i] 可能是数据的来源，同样对于输出，它将存储在内存中的某个位置。

我建议，如果循环计数真的是 10,000，就像原始帖子中那样，那么您使用的整个循环在现代 CPU 上甚至不会花费几分之一毫秒。如果循环计数真的很高，可能是 1,000,000 或更多，那么我预计内存访问的成本可能会使更快的操作完全无关紧要，因为无论如何它总是在等待数据。

我建议尝试使用您的代码并测试它是否真的在运行时间上有任何显着差异，如果没有，那么如果算法需要的话，只需编写简单的除法即可。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-10-08T02:15:44.550

here's the problem with doing it with a reciprocal, you still have to do the division before you can actually divide by Y. unless your only dividing by Y then i suppose this may be useful. this is not very practical since division is done in binary with similar algorithms.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-22T20:47:47.217

我循环 10,000 次只是为了让代码花费足够长的时间来轻松测量时间？或者你有 10000 个数字除以同一个数字？如果是前者，就把“y_div = 1.0 / y;” *在*循环内部，因为它是操作的一部分。

如果是后者，是的，浮点乘法通常比除法快。但是，不要根据猜测将代码从显而易见的变为神秘的。首先进行基准测试以找到慢点，然后对其进行优化（并在前后进行测量以确保您的想法确实会带来改进）

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-05-24T01:41:42.633

在像 80286 这样的旧 CPU 上，浮点数学运算速度非常慢，我们采用了很多技巧来加快速度。

在现代 CPU 上，浮点数学运算速度非常快，优化编译器通常可以通过微调来创造奇迹。

**几乎不值得像这样进行微优化。**

尝试使您的代码简单且防白痴。只有您发现真正的瓶颈（使用分析器），您才会考虑在浮点计算中进行优化。

# iphone - UITableViewCell：如何防止蓝色选择 背景不带 isSelected 属性？

> ID：899862
> 
> 赞同：38
> 
> 时间：2009-05-22T20:33:00.537
> 
> 标签：iphone, objective-c, cocoa-touch, uikit

我有一个自定义`UITableViewCell`子类。我已将`contentView`我的单元格子类设置为一个自定义`UIView`类，在该类中我将覆盖`-drawRect:`并在那里进行所有绘图。

另外，我设置`cell.contentView.opaque = NO`是为了在单元格的某些区域实现透明度（不幸的是，表格后面的背景图像必须通过某些部分的每个单元格显示，以达到风格效果。我知道这是一个性能影响。它必须是所以）。

问题：当它被选中或突出显示（被按下）时，我仍然看到在我的单元格后面（在透明区域中）绘制了默认的漂亮蓝色渐变背景。这会遮挡桌子后面的图像，这很糟糕。

目标：防止出现蓝色渐变背景，但仍然能够从内部检查`cell.isSelected`和`cell.isHighlighted`属性`-[MyContentView drawRect:]`以确定如何绘制我自己的自定义选择/突出显示。

我试过的：

1.  设置`cell.selectionStyle = UITableViewCellSelectionStyleNone`具有防止漂亮的蓝色渐变选择背景的预期效果，但也防止正确设置`cell.isSelected`和`cell.isHighlighted`属性，这意味着我无法进行自己的自定义选择/突出显示绘图

2.  在单元格的or方法中设置`cell.selectionBackgroundView = nil`and不会阻止蓝色渐变选择背景`cell.backgroundView = nil``-init``-prepareForReuse`

3.  `cell.selectionBackgroundView = nil`该`-[MyContentView -drawRect:]`方法中的设置*确实*具有防止蓝色渐变选择背景的预期效果，但这似乎很笨拙

4.  覆盖 -[UITableViewCell setSelected:animated:] 为无操作。这没有防止蓝色渐变选择背景的预期效果

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-08-06T13:34:59.867

您还必须覆盖 setHighlighted: 以防止蓝色渐变显示。如果你只是覆盖 setHighlighted: 那么你最终会得到一个瞬间的选择效果。

所以你会有这两种方法：

```
- (void)setHighlighted: (BOOL)highlighted animated: (BOOL)animated
{
    // don't highlight
}

- (void)setSelected: (BOOL)selected animated: (BOOL)animated 
{
    // don't select
    //[super setSelected:selected animated:animated];
} 
```

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2009-11-01T08:21:04.857

```
cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2009-05-22T20:46:27.297

关于自定义 UITableViews 的一个极好的资源是 Matt Gallagher 的[这篇文章](http://cocoawithlove.com/2009/04/easy-custom-uitableview-drawing.html)。您要做的是将 selectedBackgroundView 设置为透明或 UIImageView 的新视图（而不是 nil）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-30T15:23:06.080

By far the easier method - in my opinion - to achieve this, is by setting the Table View attributes checkbox in the Interface Builder screen where it says "Show Selection on Touch". See the screenshot below:

![enter image description here](https://i.stack.imgur.com/NT2li.png)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-22T20:49:16.840

过去对我有用的只是把：

```
- (void)setSelected:(BOOL)selected animated:(BOOL)animated { } 
```

在我的 UITableViewCell 子类中（因为它不会调用 super 并使自己突出显示）。希望这就是你要找的。

* * *

## 回答 #6

> 赞同：-12
> 
> 时间：2010-06-23T19:41:22.477

这个怎么样？

```
// disable user interaction
cell.userInteractionEnabled = NO; 
```

# c - ncurses 菜单 - 不会显示我的用户输入的字符串

> ID：899876
> 
> 赞同：0
> 
> 时间：2009-05-22T20:35:45.697
> 
> 标签：c, ncurses

当我创建一个文字字符串并将其添加到菜单时，一切正常。但是如果我从用户那里输入一个字符串，那么菜单就是“空白”。我不知道这是一个诅咒/菜单问题，还是一个 C 问题，因为我是这两个方面的初学者。

```
#include <curses.h>
#include <menu.h>
#include <malloc.h>

int main()
{
    MENU *my_menu;
    ITEM **my_items;
    char c;

// works
    char my_string[20] = "this is the string";

// user-inputted string, comment these 2 lines out to make this program work
    printf("enter something: ");
    fgets(my_string, 19, stdin);

    initscr();
    noecho();
    crmode();

    my_items = (ITEM **)calloc(2, sizeof(ITEM *));
    my_items[0] = new_item(my_string, my_string);
    my_items[1] = (ITEM *)NULL;
    my_menu = new_menu(my_items);

    post_menu(my_menu);
    refresh();

    while ((c = getch()) != 'q') { }

    free_item(my_items[0]);
    free_item(my_items[1]);
    free_menu(my_menu);

    endwin();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T19:26:27.383

问题是输入字符串末尾的 '\n'。删除它将使这项工作。

# .net - 将子类实例化为父类，但调用子类的方法

> ID：899878
> 
> 赞同：0
> 
> 时间：2009-05-22T20:36:21.327
> 
> 标签：.net, visual-c++, inheritance, managed-c++

我正在编写一个应用程序，该应用程序需要开发用于处理数据的引擎，但该引擎必须可以根据客户的需要替换为另一个引擎。由于每个客户都有非常不同的需求，我想让每个引擎与其他引擎分开，这样我们就可以只交付带有客户所需引擎的应用程序。

所以我的 VS 解决方案有以下项目： App, Engine_Base, Engine_A, Engine_B App = exe Engine_Base = 父类...编译成 dll 并通过项目属性 Engine_A 和 Engine_B 添加到 App 的引用中Engine_Base 的子类，它们都编译为它们自己的 dll（Engine_A.dll、Engine_B.dll）。它们没有添加到 App 的引用中，因此它们不会在运行时加载，因为我们不想将两者都发送给我们的所有客户。

根据客户的配置文件，我们决定加载哪个引擎：

```
Engine_Base^  engine_for_app;
Assembly^ SampleAssembly;
Type^  engineType;

if (this->M_ENGINE == "A")
{
    SampleAssembly = Assembly::LoadFrom("path\\Engine_A.dll");

    engineType = SampleAssembly->GetType("Engine_A");
    engine_for_app = static_cast<Engine_Base^>(Activator::CreateInstance(engineType, param1, param2));
}
else
{
    SampleAssembly = Assembly::LoadFrom("path\\Engine_B.dll");

    engineType = SampleAssembly->GetType("Engine_B");
    engine_for_app = static_cast<Engine_Base^>(Activator::CreateInstance(engineType, param1, param2, param3, param4));
} 
```

由于只有 Engine_Base 被添加到 C++ 项目的引用中，我们将 Engine__A 或 Engine_B 对象转换为父类型。

然后我们为引擎的线程执行设置事件，因为它们需要很长时间才能运行（需要处理大量数据）：

```
engine_for_app->OnComplete += gcnew CompleteEngineProcess(this, &frmMain::ThreadChildComplete);
engine_for_app->OnProgressInit += gcnew ProgressInitEngine(this, &frmMain::ThreadChildProgressInit);
engine_for_app->OnProgressReport += gcnew ProgressReportEngine(this, &frmMain::ThreadChildProgressReport);

Thread^ aThread;
aThread = gcnew Thread(gcnew ThreadStart(engine_for_app, &Engine_Base::Read)); 
```

但这给了我一个：

```
Error   2   error C3754: delegate constructor: member function 'Engine_A::Read' cannot be called on an instance of type 'Engine_Base ^' d:\_activeWork\EDI_TRUNK\src\App\frmMain.cpp    492 
```

我意识到这与继承有关，但我对如何解决这个问题缺乏了解。

有没有人对如何解决这个问题有想法？

我们的方法是一个好的解决方案还是我们应该一直在寻找其他东西并以不同的方式做事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T21:34:13.643

编辑：也许确保Engine_A等方法被标记为虚拟？

# iphone - 如何以编程方式确定 CPU 使用率或 iPhone-OS 中系统的繁忙/占用程度？

> ID：899880
> 
> 赞同：1
> 
> 时间：2009-05-22T20:36:36.130
> 
> 标签：iphone, cocoa-touch, performance, uikit

我的应用在滚动过程中做了一些漂亮但重量级的核心动画。有时它会因性能不佳而崩溃。所以我需要一些方法来确定是否有足够的能力来制作动画，如果没有，我就把它们放在一边。最好的方法是我可以询问系统有多忙。

更新：我的意思是特别是核心动画。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T21:04:33.907

通过动画，您是指一个接一个地播放的帧（如动画 GIF）还是一些 CoreAnimation (OpenGL) 效果，它正在移动带有映射纹理的多边形？

如果是前者，我真的会考虑某种方式来优化动画或在所有情况下消除它。

如果是后者，我会更深入地挖掘问题的根源。Core Animation 在正常情况下会掉帧，以免一开始就陷入这种情况。

无论哪种情况，您都可以考虑提前加载纹理资源。*当我在*函数调用中创建 UIImage 时，我的应用程序使用带有 UIImage 参数的动画方法遇到了一些麻烦。在我的代码中提前一点预加载资产很好地解决了这个问题。

举个例子：
**坏**

```
[[UIImage imageNamed:@"checkmark.png"] drawAtPoint:p]; 
```

**更好的**

```
//declared at top of class
static UIImage *checkmark = nil; 
```

在初始化中：

```
checkmark = [UIImage imageNamed:@"checkmark.png"]; 
```

在drawRect中：

```
[checkmark drawAtPoint:p]; 
```

您需要根据您的特定情况调整此技术。就我而言，复选标记经常使用，而且它很小，我不介意将内存永久专用于它。

我想知道是否可以通过确保资产已准备好供应用程序使用来修复您的崩溃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T20:44:48.237

**我不会那样做的**。如果您的应用程序崩溃，那就太重了。您可以使用一些工具运行您的应用程序，以查看您的瓶颈在哪里。

所以，不要试图听起来太刺耳，你最好的方法是**重写**一些部分**，以使你的应用程序始终在 iPhone 上运行**。

# asp.net - 重新加载 Gridview onclientclick

> ID：899888
> 
> 赞同：2
> 
> 时间：2009-05-22T20:37:48.237
> 
> 标签：asp.net, vb.net, gridview

我有一个仅在模式弹出窗口中显示的网格视图。就在我调用模式弹出窗口之前，我在文本框中设置了一个值。模式弹出窗口内的 gridview 取决于该文本框的值，以使其数据完全显示。所以 onclick 我想重新加载 gridview 以便它将重新加载文本框的值。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T20:59:17.520

本质上......使用更新面板，按钮按下事件应该触发部分回发，您的查询重新运行，然后允许您在网格上执行另一个数据绑定。这之后都会有一个modalPopUp.Show() ...

**代码背后**

```
protected void btnAdd_Click(object sender, EventArgs e)
{
    if(!String.IsNullOrEmpty(this.txtMyValue.Text))
    {
         AddValue(this.txtMyValue.Text);
         UpdateGrid();
         this.UpdatePanel1.Update();
    }
    else
    {
       //ooooops
    }
}

private void AddValue(String str)
{
   DataAccess.AddSomeValue(str);
}

private void UpdateGrid()
{
   this.GridView1.DataSource = DataAccess.GetData();
   this.GridView1.DataBind();
} 
```

**前端**

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server" updatemode="Conditional">
    <ContentTemplate>
        <asp:TextBox id="TextBox1" runat="server" />
        <asp:Button id="btnAdd" OnClick="btnAdd_Click" runat="Server">
        <div id="MyModalArea">
           <asp:GridView id="GridView1" runat="Server" ..... >
           </asp:GridView>
        </div>
    </ContentTemplate>
</asp:UpdatePanel> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T20:45:52.697

将弹出窗口内容（网格和其余部分）放在单独的 aspx 页面中，然后在初始化弹出窗口时，将文本框值作为参数发送：

```
MyPopupWindowContent.aspx?TextBoxValue=something 
```

# php - Zend 框架的多条件删除示例

> ID：899890
> 
> 赞同：6
> 
> 时间：2009-05-22T20:38:16.143
> 
> 标签：php, mysql, zend-framework, zend-db

当我有两个条件时，有人可以给我一个例子，说明如何使用 Zend 框架删除 mysql 中的一行？

即：（试图这样做）

```
"DELETE FROM messages WHERE message_id = 1 AND user_id = 2" 
```

我的代码（惨遭失败的代码看起来像这样）

```
// is this our message?
$condition = array(
                   'message_id = ' => $messageId,
                   'profile_id = ' => $userId
);

$n = $db->delete('messages', $condition); 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2010-07-31T12:16:31.570

最好使用这个：

```
$condition = array(
    'message_id = ?' => $messageId,
    'profile_id = ?' => $userId
); 
```

占位符 (?) 被值替换，转义特殊字符，并在其周围应用引号。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-22T20:45:16.817

而不是关联数组，您应该只传入一个标准表达式数组，ala：

```
$condition = array(
    'message_id = ' . $messageId,
    'profile_id = ' . $userId
); 
```

（如果它们来自用户输入，请确保您适当地转义这些值）

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2011-12-16T05:48:26.260

使用这个，它正在工作......

```
$data = array(
    'bannerimage'=>$bannerimage
);

$where = $table->getAdapter()->quoteInto('id = ?', 5);

$table->update($data, $where); 
```

# c# - SQLiteDataAdapter 未填充指定的 DataTable

> ID：899892
> 
> 赞同：0
> 
> 时间：2009-05-22T20:38:26.987
> 
> 标签：c#, sqlite, datatable, dataadapter

我正在尝试从 SQLite 数据库中提取一些数据，以便可以在我的 GUI 中填充 GridView：这是返回 DataTable 的代码：

```
DataTable table = new DataTable();

SQLiteDataAdapter adapter = new SQLiteDataAdapter(this.command.CommandText, this.connection);
adapter.Fill(table);

return table; 
```

出于某种原因，调用后`adapter.Fill`，DataTable 仍然没有填充任何内容。到目前为止，我已经验证了命令文本是正确的，并且连接包含正确的连接字符串。两者都在应用程序的其他部分成功使用。似乎没有抛出异常......我还有什么地方应该找麻烦吗？我是否错误地使用了 API？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T20:57:43.017

这看起来是正确的用法。

要检查的一件事-在填充后您说未填充数据表。你只是在检查 Rows.Count 吗？列呢？如果 Fill 创建了与您的 SELECT 语句匹配的列，但没有任何行，那么您知道代码正在运行，但是您的查询存在问题，或者您没有访问您认为的同一个数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T20:42:25.683

是否有一个构造函数可以让您直接传入命令？

# .net - 在 Windows.Forms 中绘制图像的最快方法是什么？

> ID：899894
> 
> 赞同：1
> 
> 时间：2009-05-22T20:40:10.210
> 
> 标签：.net, winforms, paint

过去我曾使用多种技术在 Windows.Forms 中绘制图像，现在我正在重新审视一些处理为我们的产品呈现皮肤图像的核心库。我特别感兴趣的是多次渲染相同的图像（平铺）以表示背景控件的字段。假设图像的大小正好合适（不需要缩放）并且只包含要平铺的部分，那么将该图像绘制到屏幕上的最快方法是什么？

我使用的优化之一是将图像转换为 PixelFormat.Format32bpp **P** Argb，它会预先计算一些 alpha 通道。

DrawImage 和 DrawImageUnscaled 之间有性能差异吗？

寻找真实世界的经验，而不是记录在案的期望。

**更新：**在挖掘框架类之后，我看到 Control 类使用 TextureBrush 使用要平铺的图像。这看起来很有希望。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T20:43:41.983

如果你愿意 p/invoke，[BitBlt](http://msdn.microsoft.com/en-us/library/aa930997.aspx)。如果没有，DrawImageUnscaled 就好了。

# c++ - 为什么人们在 C++ 中使用枚举作为常量，而他们可以使用 const？

> ID：899917
> 
> 赞同：35
> 
> 时间：2009-05-22T20:44:45.490
> 
> 标签：c++, enums, enumeration

为什么人们可以使用 C++ 中的枚举作为常量`const`？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-05-22T21:13:24.327

Bruce Eckel 在[Thinking in C++](http://bruce-eckel.developpez.com/livres/cpp/ticpp/v1/?page=page_8#L8.4.2)中给出了一个理由：

> 在旧版本的 C++ 中，`static const`类内部不支持。这意味着这`const`对于类中的常量表达式是没有用的。然而，人们仍然想这样做，所以一个典型的解决方案（通常称为“enum hack”）是使用`enum`没有实例的未标记。枚举必须在编译时建立它的所有值，它是类的本地值，并且它的值可用于常量表达式。因此，您通常会看到：

> ```
> #include <iostream>
> using namespace std;
> 
> class Bunch {
>   enum { size = 1000 };
>   int i[size];
> };
> 
> int main() {
>   cout << "sizeof(Bunch) = " << sizeof(Bunch) 
>        << ", sizeof(i[1000]) = " 
>       << sizeof(int[1000]) << endl;
> } 
> ```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-05-22T20:52:30.810

枚举是不同的类型，所以你可以做面向类型的事情，比如用它们重载：

```
enum Color { Red,Green,Blue };
enum Size { Big,Little };

void f( Color c ) {
}

void f( Size s ) {
}

int main() {
    f( Red );
    f( Big );
} 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-05-22T20:47:58.060

枚举意味着一组*相关*的常数，因此有关关系的附加信息必须在他们手头问题的模型中有用。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-05-22T20:52:58.533

在处理模板元编程时也有一个历史原因。一些编译器可以使用枚举中的值，但不能使用静态 const int 来实例化一个类。

```
template <int N>
struct foo
{
    enum { Value = foo<N-1>::Value + N };
};

template <>
struct foo<0>
{
    enum { Value = 0; }
}; 
```

现在你可以用更明智的方式做到这一点：

```
template <int N>
struct foo
{
    static const int Value = foo<N-1>::Value + N;
};

template <>
struct foo<0>
{
    static const int Value = 0;
}; 
```

另一个可能的原因是，静态 const int 可能在运行时为其保留了内存，而枚举永远不会为它保留实际的内存位置，并将在编译时处理。请参阅[此相关问题。](https://stackoverflow.com/questions/607770/nameless-enums-in-templates)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-05-22T20:53:09.687

枚举在使用时更具描述性。考虑：

```
int f(int fg, int bg) 
```

相对

```
 int f(COLOR fg, COLOR bg) 
```

此外，枚举提供了更多的类型安全性，因为

*   整数不能隐式转换为枚举类型
*   一种类型的枚举不能隐式转换为另一种类型的枚举

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-05-22T21:01:42.960

我喜欢可以与枚举一起使用的自动行为，例如：

```
enum {NONE, START, HEY, HO, LAST}; 
```

然后很容易循环到 LAST，当添加新状态（或任何表示的状态）时，逻辑会适应。

```
for (int i = NONE; i < LAST; i++)
{
    // Do stuff...
} 
```

添点什么...

```
enum {NONE, START, HEY, WEE, HO, LAST}; 
```

循环适应...

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-22T21:02:20.213

在编译器供应商实施 ISO/IEC 14882:1998 C++ 标准之前，在类范围内定义常量的这段代码导致编译错误：

```
class Foo {
    static const int MAX_LEN = 80;
    ...
}; 
```

如果常量是整数类型，一个笨拙的解决方法是在类内的枚举中定义它：

```
class Foo {
    enum {
        MAX_LEN = 80
    };
    ...
}; 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-22T20:57:33.577

枚举也可以用作类型名称。因此，您可以定义一个将枚举作为参数的函数，与将值定义为 const 变量和函数仅接受“int”相比，这使得应该将哪些类型的值作为函数的参数提供更清楚作为论据。

考虑：

```
enum my_new_fangled_type {
  baz = 0,
  meh = 1
};

void foo (my_new_fangled_type bar) // bar can be a value listed in the enum
{
   ...
} 
```

相对：

```
int const baz = 0;
int const meh = 1;

void foo (int bar) // what are valid values for bar?
{
   ...
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-22T21:48:38.467

一些调试器在调试时会显示枚举名称而不是其值。这很有帮助。我知道我宁愿看到也不愿`day_of_week = MONDAY`看到`day_of_week = 1`。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-22T22:06:45.217

部分原因是旧的编译器不支持真正的类常量的声明

```
class C
{
  const int ARealConstant = 10;
}; 
```

所以不得不这样做

```
class C
{
  enum { ARealConstant = 10 };
}; 
```

出于这个原因，许多可移植库继续使用这种形式。

另一个原因是枚举可以用作一种方便的句法设备来将类常量组织成相关的和不相关的

```
class DirectorySearcher
{
  enum options
  {
    showFiles = 0x01,
    showDirectories = 0x02,
    showLinks = 0x04,
  };
}; 
```

对比

```
class Integer
{
   enum { treatAsNumeric = true };
   enum { treatAsIntegral = true };
   enum { treatAsString = false };
}; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-22T20:59:33.947

使用枚举以简洁的方式记录有效选择，并允许编译器强制执行它们。

如果他们使用枚举存储全局常量，例如 Pi，那么我不知道他们的目标是什么。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-05-22T20:49:16.870

一个原因是`const`需要更多的输入：

```
enum { Val1, Val2, Val3 }; 
```

...相对...

```
const int Val1=0, Val2=1, Val3=2; 
```

# vb.net - 在 Visual Studio 项目中嵌入 InfoPath 的实例？

> ID：899928
> 
> 赞同：1
> 
> 时间：2009-05-22T20:47:29.027
> 
> 标签：vb.net, infopath, embedded-resource

考虑我创建的以下模型图像：

[![小样](https://i.stack.imgur.com/BbyLt.gif)](https://i.stack.imgur.com/BbyLt.gif)

我是使用 InfoPath 的新手，我很好奇是否有人知道如何在 winform 中嵌入 InfoPath 的实例，这样用户就可以在不启动 InfoPath 应用程序的情况下填写表单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T21:36:43.500

InfoPath 编辑器可以作为控件托管在 Winforms 应用程序中。这样做的说明位于页面底部附近的[http://msdn.microsoft.com/en-us/library/aa947697.aspx 。](http://msdn.microsoft.com/en-us/library/aa947697.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-30T18:43:15.153

请参阅[在自定义 Windows 表单应用程序中托管 InfoPath 2007 表单编辑环境](http://msdn.microsoft.com/en-us/library/aa701079.aspx)。

# java-me - 开始使用 J2ME 进行开发的第一步

> ID：899932
> 
> 赞同：1
> 
> 时间：2009-05-22T20:48:11.473
> 
> 标签：java-me

我是一名 .NET 程序员，需要将一个已经在工作中的优秀桌面 OTP 系统移植到手机中。据我所知，J2ME 是正确的答案。我将不胜感激有关 IDE、第一步、书籍或任何其他信息的任何好的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T21:07:03.870

嗯，[Eclipse IDE](http://eclipse.org)有很好的 J2ME 支持，至少我听说过。

对于 api，请阅读 javadocs：http: [//java.sun.com/javame/reference/apis.jsp](http://java.sun.com/javame/reference/apis.jsp)

你必须弄清楚你想要定位哪个设备，并抓住它的模拟器。

然后，在教程的帮助下继续制作一个 hello world 应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T13:56:19.337

我也会尝试一下 NetBeans。Eclipse 和 NetBeans 非常相似，但根据您的个人喜好，差异可能是白天和黑夜。NetBeans 还具有出色的 J2ME 项目支持，它对于您可能需要定位的任何设备模拟器都是即插即用的，但我建议坚持使用默认值或 SonyEricsson 的。摩托罗拉总是有问题，根本没有反映设备，诺基亚总是很慢。

此外，还有大量的设备。在您首先进入此之前，您应该定义您需要定位的确切设备的范围。这将对调度产生巨大影响，因为移植不是一项小任务。

最后，只需掌握您需要定位的实际设备即可。模拟器是一个很好的开始方式，但是一旦你把应用程序扔到设备上，总会出现很多细微差别和问题，最好从一开始就拥有你的目标设备。

# windows - 有没有办法通过代码通知 IE 关于注册表中所做的更改？

> ID：899933
> 
> 赞同：0
> 
> 时间：2009-05-22T20:48:18.667
> 
> 标签：windows, internet-explorer, registry, notifications

我已经通过 Windows 编程代码更改了注册表（代理设置）。

每次运行代码以使这些更改生效时，我都必须重新启动（重新打开）Internet Explorer。

Windows 编程中是否有任何 API，通过它我可以通知 Internet Explorer 或 Windows 对注册表进行了更改，并且不需要重新打开 Internet Explorer 以使这些更改生效？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-24T12:21:57.347

我设法用 API 成功地做到了`InternetSetOption`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T21:19:58.697

尝试这个：

在不重新启动 Internet Explorer 的情况下更改 Internet Explorer 7 代理设置 [http://www.codeproject.com/KB/IP/Change_IE7_Proxy_Setting.aspx](http://www.codeproject.com/KB/IP/Change_IE7_Proxy_Setting.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T15:11:44.890

是的，使用 Shell api (FAQ)。
见上Win32 api群新闻://nntp.aioe.org/comp.os.ms-windows.programmer.win32

# .net - 我可以构建一个允许匿名访问但基于用户 ID 模拟用户权限的 .net Web 服务吗？

> ID：899947
> 
> 赞同：1
> 
> 时间：2009-05-22T20:53:47.267
> 
> 标签：.net, web-services, security, websphere, impersonation

我在 IBM WAS 服务器 (Windows) 上有一个 Web 应用程序。

在 WAS 应用程序中，用户可以浏览不同服务器上的文件。此功能连接到 Web 服务，以便从网络路径中检索文件列表。

Web 服务是使用 .net 构建的，并且驻留在与文件服务器位于同一域中的单独服务器上。

WAS 应用服务请求将用户 ID 作为调用的一部分发送。

有没有办法获取传递给 Web 服务的用户 ID，并根据 Windows 安全性将该用户限制为他们有权访问的文件/文件夹？

据我所知，除非 WAS 应用程序能够以登录用户的身份将请求发送到 Web 服务，否则这是不可能的。

那么，我的第二个问题是，是否可以将 Windows 用户凭据从 WAS 应用程序传递到 Web 服务？

我对 Windows 身份验证和模拟不太熟悉，而且我对 WAS 以及它如何处理安全性的了解更少，所以我希望找出这是否可行以及我可以从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T21:00:24.790

这是一个使用 .NET 了解匿名访问和模拟的链接：[匿名访问和模拟](http://www.dotnet-guide.com/impersonation.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T21:03:15.673

不可以。您可以创建身份令牌，但为了进行访问检查，您需要一个模拟令牌，并且只能通过提供密码或通过委托受信任的帐户委托来创建这样的令牌，该帐户反过来又提供了密码（或足够证明相信原始身份拥有密码，即 AD 为他担保）。

您需要做的是让 WAS 服务器模拟调用者，然后在模拟下调用您的服务。必须将运行 WAS 的帐户配置为[允许约束委派](http://msdn.microsoft.com/en-us/library/ms998355.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T21:04:57.557

假设您有一个 Active Directory 设置，我能想到的 WAS 服务器发送访问它的用户凭据的唯一方法是 DC 识别 WAS 服务（即运行您的 WAS 应用程序的帐户）进行委派。我们在这里遇到了这个问题（有点）。我们使用 AD 帐户来运行我们的 IIS 应用程序池，然后该 AD 帐户需要能够针对 AD 验证用户并连接到 SQL Server。

我们的解决方法是为运行 IIS 应用程序池的用户注册服务进程名称 (SPN)。这允许用户帐户针对 AD 对用户进行身份验证，因为 AD 会将其识别为服务。然后，您可以遵循传统的 .NET 模拟规则来传递凭据。很抱歉，我无法提供更具体的信息，但我希望这至少能为您指明正确的方向。

请参阅： [http ://technet.microsoft.com/en-us/library/cc773257.aspx](http://technet.microsoft.com/en-us/library/cc773257.aspx)

# websphere - RAD 7.5 Web 服务问题

> ID：899951
> 
> 赞同：6
> 
> 时间：2009-05-22T20:54:51.337
> 
> 标签：websphere, rad

我正在使用 Rational Application Developer 创建一些 Web 服务。我遇到的问题是我按照屏幕截图中的说明进行操作，但是当我到达选择“JAX-WS”的部分时，它抱怨 Websphere 没有 Web 服务库的实现，因为选择的服务器只有一个“存根”。

作为 WAS 开发的新手，我想知道这意味着什么？是不是 RAD 没有提供 WAS 的实际实现，而只提供了存根库，以便您的代码可以编译？我是否需要在本地安装完整的 WAS 服务器才能测试我的 Web 服务代码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T20:02:36.857

想通了这一点，必须进入 IBM Installation Manager 并选择 WAS 6.1 和 Web 服务特性。

# ruby - 解析单个键/值的字符串的“红宝石方式”是什么？

> ID：899953
> 
> 赞同：11
> 
> 时间：2009-05-22T20:55:29.807
> 
> 标签：ruby, regex, text

我正在尝试解析多行字符串并按照模式获取该行的其余部分。

文本：

```
你好约翰
你的用户名是：jj
感谢您的注册

```

我想提取 jj，也就是“你的用户名是：”之后的所有内容

单程：

```
text = "hello john\nyour username is: jj\nthanks for signing up\n"
match = text[/your username is: (.*)/]
value = $1 
```

但这让我想起了 perl ......并且不像我被告知 ruby​​ 应该那样自然地“阅读”。

有没有更清洁的方法？又名“红宝石”方式？

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-22T21:13:01.237

您的代码几乎是 Ruby 方式。如果您不想使用 global `$1`，可以使用 2 arg 版本`String#[]`：

```
match = text[/your username is: (.*)/, 1] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-22T21:05:50.567

*split*命令非常有用。它将一个字符串分成一个子字符串数组，根据你传入的任何内容进行分隔。如果你不给它任何参数，它会在空格上分割。因此，如果您知道要查找的单词是第五个“单词”（拆分为空格和返回字符），您可以这样做：

> text = "hello john\n你的用户名是：jj\n感谢注册\n"
> match=text.split[5]

..但也许这还不够自我记录，或者你想允许多词匹配。你可以这样做：

> midline=text.split("\n")[1]
> match=midline.split("用户名是：").last

或者也许这种更简洁的方式：

> 匹配=文本[/用户名是：(.*)/,1]

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T21:20:00.007

不确定它是否更像Ruby'ish，但另一种选择：

```
>> text = "hello john\nyour username is: jj\nthanks for signing up\n"
>> text.match(/your username is: (.*)/)[1]
=> "jj" 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-23T03:12:21.980

还有`Regexp#match`，它返回一个`MatchData`对象，其中包含您可能想要的所有信息。

```
irb> match = /your username is: (.*)/.match "hello john\nyour username is: jj\nthanks for signing up\n"
#=> #<MatchData:0x557f94>
irb> match.pre_match
#=> "hello john\n"
irb> match.post_match
#=> "\nthanks for signing up\n"
irb> match[0]
#=> "your username is: jj"
irb> match[1]
#=> "jj" 
```

# c# - 使用存储在字符串中的 C# 对象初始化器语法实例化匿名对象

> ID：899962
> 
> 赞同：11
> 
> 时间：2009-05-22T20:57:07.633
> 
> 标签：c#, dynamic

使用 C# 对象初始化器语法，我可以像这样实例化一个匿名对象：

```
object empData = new { name = "bob", age = 30, salary = 100000 }; 
```

但是，如果我将初始化程序存储在字符串中，例如：

```
string init = "{ name = \"bob\", age = 30, salary = 100000 }"; 
```

将此字符串转换为对象实例的最佳方法是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-22T21:29:04.200

**匿名类是 C#[语法糖](http://en.wikipedia.org/wiki/Syntactic_sugar)**[（请参阅此处](http://msdn.microsoft.com/en-us/library/bb397696.aspx)的备注部分）。csc.exe 创建一个具有私有字段的类和一个具有从上下文推断的类型的读/写属性。对象的所有用途再次被推断。

这意味着您不能在运行时创建匿名类，因为 CLR 看到它们与任何其他类没有什么不同（同样，因为它是 C# 语法糖）。

所以与其：

*   用一个`Dictionary<string,object>`
*   使用 JSON.NET、XML 或类似的东西，它们已经定义了一些用于解析字符串以获取对象的方案。然而，这需要明确定义属性。
*   用于`System.Reflection.Emit`在运行时创建类型，但我认为这并没有真正的好处`Dictionary<string,object>`

我也担心你在做什么，因为这作为一个字符串对我来说很可能意味着你正在接受某种用户输入。无论您做什么，都要警惕安全问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-22T21:00:32.447

使用匿名类型是不可能的，但是您可以使用 TypeBuilder 类，特别是 TypeBuilder.Create(..) 使用 Reflection Emit 来做到这一点。

[http://msdn.microsoft.com/en-us/library/system.reflection.emit.typebuilder.createtype.aspx](http://msdn.microsoft.com/en-us/library/system.reflection.emit.typebuilder.createtype.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-22T21:10:50.010

最好的方法是使用序列化。但是，当然，这不使用您描述的相同字符串格式。

您的对象初始化程序不必包含常量值。

```
string myName="bob";
int myAge=30;
double mySalary=100000;

object empData = new { name = myName, age = myAge, salary = mySalary }; 
```

因此，在您的场景中，您必须从字符串中解析出各个元素，并对它们执行一些转换以将它们强制转换为您想要的类型。

如果您不习惯这种特殊的字符串格式，您可以序列化和反序列化您的对象，并使用 XML 更轻松地完成同样的事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T20:59:53.683

没有直接简单的方法可以做到这一点。基本上，您有以下选择：

1.  手动解析字符串。
2.  使用 C# 编译器将该对象编译为程序集的一部分，并使用反射来找出内容。
3.  （不确定是否可能，仅限 C# 4.0）：使用 C# 4.0 托管编译器类来解析表达式并推断内容。

在我看来，这些都不是理想的。如果您可以选择并考虑将数据存储在字典实例中而不是为每个表达式创建对象，我会考虑像对、XML 或 JSON 或其他一些具有可用解析器的格式的 QueryString。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T21:05:25.183

我认为这个问题本身并不能回答你的问题，但它会告诉你为什么不能以你建议的方式使用字符串创建对象的匿名实例：

[如何创建和访问在 C# 中作为参数传递的匿名类的新实例？](https://stackoverflow.com/questions/478013/how-do-i-create-and-access-a-new-instance-of-an-anonymous-class-passed-as-a-param)

匿名类型没有任何公共字段，因此虽然您可以对命名对象执行此操作，但对匿名类型执行此操作并不简单。也就是说，没有什么可以阻止您 [正如 BFree 建议的那样] 使用反射来为匿名类型发出 MSIL——这并不完全简单，但也不是不可能的。

# oslo - 微软的奥斯陆项目将解决哪些问题？

> ID：899976
> 
> 赞同：6
> 
> 时间：2009-05-22T20:59:59.593
> 
> 标签：oslo

我看了一些关于“奥斯陆”的视频/网络广播，但我仍然看不到这一切是如何结合在一起的。

我知道[奥斯陆](http://en.wikipedia.org/wiki/Oslo_(Microsoft_project))是一个建模平台。

创建 DSL 的过程是什么？

它不仅仅是创建 DSL 的工具吗？

我了解 Mgramma 用于创建 DSL 的语法。

M语言是干什么用的？

什么是 MSchema？

创建 MGrammar 并将其编译为 .mgx 后，下一步是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T21:15:49.937

那篇[维基百科的文章](http://en.wikipedia.org/wiki/Oslo%5F%28Microsoft%5Fproject%29)非常不透明。

[奥斯陆](http://www.microsoft.com/soa/products/oslo.aspx)的 Microsoft 项目页面可能是一个更好的起点。它始于：

> ### 关于“奥斯陆”
> 
> “奥斯陆”是微软即将推出的建模平台的代号。建模在广泛的领域中使用，允许更多的人参与应用程序设计，并允许开发人员以更高的抽象级别编写应用程序。

恕我直言，它似乎比真正的产品更“完全符合流行语”。也就是说，看起来有某种演示或技术预览可供下载。人们可能希望他们包含一些样本，以便更清楚地了解它打算解决什么样的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T21:16:32.183

将 oslo 视为 excel/access 的替代品。最终用户无需开发人员即可对其数据进行建模和处理的东西。

Mgrammer 是我们感兴趣的地方，但有趣的部分更多的是 v2 的东西。您可以将其视为正确完成的 excel 宏。

# ruby-on-rails - Rails：belongs_to vs has_one

> ID：899981
> 
> 赞同：35
> 
> 时间：2009-05-22T21:00:54.273
> 
> 标签：ruby-on-rails, model, associations, has-many, belongs-to

关于 Rails 协会的一个新手问题。

我有一个 Bug 模型和一个 Status 模型。状态基本上只是一个键/值对表。在可用的选择中，我会说 Bug has_one Status 最有意义。然而，根据[这个](http://duanesbrain.blogspot.com/2006/05/ruby-on-rails-hasone-versus-belongsto.html)

> 内容属于_内容模板。回去看看我是如何描述这个问题的，你会发现它是有效的。使用belongs_to，表接受外键的责任。所以 Content 有一个 content_template_id。而 ContentTemplate 不需要任何东西。我可以随意指点。完毕。

Bug belongs_to Status 会更合适（因为 Bug 应该使用外键）。从语义上讲，他的例子是有道理的，但我的没有。这只是一个怪癖，在这种情况下它看起来很奇怪，还是我不理解/做错了什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-22T21:45:54.633

是的，我认为您刚刚在 Rails 中发现了一个看起来有点奇怪的场景。我认为将“状态”视为错误所属的一种类别可能很有用——从这个角度来看，这是有道理的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-22T21:30:43.137

```
TABLE:
    Bug
    id integer
    desc string
    status_id integer fk

    Status
    id integer
    desc string

RAILS MODEL:
    Bug
    belongs_to :status

    Status
    has_many :bugs 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T21:52:33.513

您没有准确解释您希望获得的 Bug 和 Status 之间的关系，但我假设您对以下其中一项感兴趣：

*   一对多：在这种情况下，应该有`has_many`Bug 类和`belongs_to`Status 类，
*   一对一：在这种情况下，应该有`has_one`Bug 类和`belongs_to`Status 类。

在这两种情况下，Status 都包含外键。在第二种情况下，措辞有点奇怪，因为一对一的关系实际上是不对称的（应该只在一侧有一个 FK）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T21:24:51.870

如果 Status 只是一个查找/键值表，听起来您可能想要 Status 和 Bug 之间的[habtm](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#M001792) ( `has_and_belongs_to_many`) 关系。使用 habtm，您最终会得到一个`bugs_statuses`连接表，其中包含`bug_id`列`status_id`以及错误和状态表。

# .net - 共享 SqlConnection

> ID：899987
> 
> 赞同：6
> 
> 时间：2009-05-22T21:02:44.083
> 
> 标签：.net, sql-server

在 .NET 应用程序中拥有一个共享的 SqlConnection 对象以用于所有数据库连接是一种好习惯，还是每次访问数据库时都应该拥有一个单独的对象？

我目前有一个共享的，似乎突然遇到了问题。当我需要使用 SQL 身份验证模式而不是 Windows 身份验证模式时，似乎无法使用共享的。我第一次尝试使用 SQL 身份验证，当我第二次尝试使用相同的连接时，它给了我这个错误：

已经有一个与此命令关联的打开的 DataReader，必须先关闭它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T21:13:21.703

你真的应该有一个单独的。重用连接由[连接池](http://msdn.microsoft.com/en-us/library/8xx3tyca.aspx)处理。像其他人所说的第二个问题可能可以通过启用 MARS 来解决。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T21:13:06.683

该错误与身份验证完全无关。在关闭从 ExecuteReader() 返回的 SqlDataReader 之前，您正在重用中间的连接。这是禁止的。您必须检查您的代码并消除您的问题。有使用 MARS（[多个活动记录集](http://msdn.microsoft.com/en-us/library/ms345109(SQL.90).aspx)）的替代方法，但我强烈反对这种做法。

在您的应用程序中使用多个连接可能会更糟，因为显然您不知道正在使用什么连接以及何时使用，因此当您使用单独的连接时，您将遇到事务一致性问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T21:11:12.410

其中很多可能是[这里](https://stackoverflow.com/questions/861552/when-should-i-open-and-close-a-connection-to-sql-server)的重复；简而言之，在大多数情况下，保持连接是短暂的和本地的。重新读取数据；也许启用[MARS](http://msdn.microsoft.com/en-us/library/cfa084cz(VS.80).aspx)？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-24T21:33:16.410

您的问题是您正在尝试使用 SqlDataReader 当前正在使用的连接。你不能那样做。当您使用 SqlDataReader 时，您必须在重用正在使用的连接之前关闭它。我建议您每次访问数据库时都创建一个不同的连接（任何时候，不仅是使用 SqlDataReaders）。如果您启用了池，那么框架本身（或者是 SqlServer？）将尽可能重用连接。

如果您需要按顺序访问数据库，假设您先选择，然后再选择，然后更新，您可以重用连接（我的意思是，相同的 SqlConnection 实例），但如果您需要在读取时访问数据库来自 SqlDataReader，那么您将需要 2 个不同的连接。

当然，您必须考虑并发问题。如果您使用事务，则某些记录可能会在某些操作期间被锁定，并且当您将 SqlDataReader 与其他查询并行使用时，您应该将隔离级别设置为不会与其余查询混淆的级别。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T21:11:42.300

虽然对于单个线程，使用单个 SqlConnection 对象可能会更好地执行，但它通过挂在连接上而对宝贵的数据库服务器资源提出了要求，因此对数据库服务器资源的要求比它需要的时间长。

最好在尽可能短的时间内实例化 SqlConnection。连接池减轻了建立连接的大部分费用，并确保最有效地使用数据库资源。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T21:11:03.050

如果您使用的是 SQL Server 2000，[这](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataproviders/thread/78d3989a-8975-4930-998d-1eb907966f57)可能会回答您的问题。

获胜的答案似乎是“这是由于 MARs 的默认设置发生了变化。它过去默认是打开的，我们在 RC1 后默认将其更改为关闭。所以只需更改您的连接字符串以将其添加回来（将 MultipleActiveResultSets=True 添加到连接字符串）。”

# c# - X509Certificate.CreateFromCertFile - 指定的网络密码不正确

> ID：899991
> 
> 赞同：29
> 
> 时间：2009-05-22T21:04:00.990
> 
> 标签：c#, ssl-certificate, x509certificate

我有一个 .NET 应用程序，我想将其用作客户端来调用 SSL SOAP Web 服务。我获得了一个名为`foo.pfx`. 证书本身有密码。

我已将证书放在以下位置：`C:\certs\foo.pfx`

要调用 Web 服务，我需要附加客户端证书。这是代码：

```
public X509Certificate GetCertificateFromDisk(){
    try{             

       string certPath = ConfigurationManager.AppSettings["MyCertPath"].ToString(); 
       //this evaluates to "c:\\certs\\foo.pfx". So far so good.

       X509Certificate myCert = X509Certificate.CreateFromCertFile(certPath);
       // exception is raised here! "The specified network password is not correct" 

       return cert;

     }
    catch (Exception ex){    
        throw;
     }
} 
```

听起来例外是在尝试读取磁盘的.NET 应用程序周围。该方法`CreateFromCertFile`是一个静态方法，应该创建一个新的 X509Certificate 实例。该方法没有被覆盖，并且只有一个参数：路径。

当我检查异常时，我发现：

```
_COMPlusExceptionCode = -532459699
Source=mscorlib 
```

问题：有谁知道“指定的网络密码不正确”异常的原因是什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-22T21:21:04.903

原来我试图从 .pfx 而不是 .cer 文件创建证书。

学过的知识...

*   .cer 文件是二进制形式的 X.509 证书。它们是[DER 编码](http://en.wikipedia.org/wiki/Distinguished_Encoding_Rules)的。
*   .pfx 文件是**容器文件**。也是DER编码的。它们不仅包含证书，还包含加密形式的私钥。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-01-29T10:36:49.150

您可能需要`X509Certificate2()`使用参数 of`X509KeyStorageFlags.MachineKeySet`来代替。这解决了我们遇到的类似问题。归功于建议这一点的原始网站：http: [//vdachev.net/2012/03/07/c-sharp-error-creating-x509certificate2-from-a-pfx-or-p12-file-in-production/](http://vdachev.net/2012/03/07/c-sharp-error-creating-x509certificate2-from-a-pfx-or-p12-file-in-production/)

报价：

> **原因**
> 
> 问题的原因似乎与错误消息没有太大关系。出于某种原因，尽管私钥存储在正在打开的文件中，但构造函数仍试图访问私钥存储。默认情况下，使用用户密钥存储，但不允许 ASP.NET（通常可能是非交互式 Windows 服务）打开它。所选帐户的用户密钥存储可能甚至不存在。
> 
> **解决方案**
> 
> 您可以尝试的一件事是通过登录帐户并在其个人存储中导入证书（然后再次将其删除）来创建用户密钥存储。
> 
> 另一种解决方案是向构造函数传递一个附加参数——一个指示私钥（应该是）存储在本地计算机中的标志——X509KeyStorageFlags.MachineKeySet，如下所示：`var certificate = new X509Certificate2(fileName, password, X509KeyStorageFlags.MachineKeySet);`

对于没有密码的 PFX，密码可以指定为`string.Empty`.

另请参阅[https://stackoverflow.com/a/8291956/130352](https://stackoverflow.com/a/8291956/130352)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-22T21:47:11.747

根据您的情况，您可能需要先在服务器上安装证书以提高信任级别，然后再导出`.cer`文件。

我必须为一个类似的项目做这个，这里是我关于它是如何完成的笔记。

将 替换`Foo.cer`为服务器上安装的证书的导出。（从文件中安装证书`pfx`，然后将其导出到`cer`文件中。）

*   用于 IIS6 的命令以允许 IIS_WPG 组访问证书密钥。需要安装`winhttpcertcfg`（您可以按照下面的链接获取自己的副本）。

    > C:\Program Files\Windows Resource Kits\Tools>winhttpcertcfg -i（pfx 文件的路径，例如 e:\Certs\Foo.pfx）-c LOCAL_MACHINE\My -a IIS_WPG -p（pfx 文件的密码）

*   吐出关键信息并授予特权

    授予帐户的私钥访问权限：

    ```
     (SERVERNAME)\IIS_WPG 
    ```

`WinHttpCertCfg.msi` [在这里](http://www.microsoft.com/downloads/details.aspx?familyid=c42e27ac-3409-40e9-8667-c748e422833f&displaylang=en)下载安装exe。

更多关于如何使用证书配置的信息可以在[这里](http://msdn2.microsoft.com/en-us/library/aa384088.aspx)找到。

然后它只是回到你如何做你的证书推送。

```
//Cert Challenge URL 
Uri requestURI = new Uri("https://someurl");

//Create the Request Object
HttpWebRequest pageRequest = (HttpWebRequest)WebRequest.Create(requestURI);

//After installing the cert on the server export a client cert to the working directory as Foo.cer
string certFile = MapPath("Foo.cer");
X509Certificate cert = X509Certificate.CreateFromCertFile(certFile);

//Set the Request Object parameters
pageRequest.ContentType = "application/x-www-form-urlencoded";
pageRequest.Method = "POST";
pageRequest.AllowWriteStreamBuffering = false;
pageRequest.AllowAutoRedirect = false;
pageRequest.ClientCertificates.Add(cert); 
```

这就是我通过证书的方式，但不确定你需要用你的证书做什么，所以这对你来说可能不一样。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-05-11T23:19:47.493

当您尝试在其中一个操作系统存储中导入的证书已存在于该存储中时，也会返回“指定的网络密码不正确”错误消息。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-09-29T00:08:09.740

在我的情况下，我试图在私有应用程序模式下运行，我得到了同样的错误。

> 指定的网络密码不正确

PrivateAuthenticator 构造函数 (in `Xero.Api.Example.Applications.Private`) 试图导入证书，假设在创建证书期间没有定义密码。

```
_certificate = new X509Certificate2();
_certificate.Import(certificatePath); 
```

然后我将导入更改为使用使用密码的重载方法，

```
_certificate.Import(certificatePath, "mypasswordusedtocreatethecertificate",  X509KeyStorageFlags.MachineKeySet); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-05-30T11:28:41.393

您可能需要 X509KeyStorageFlags.MachineKeySet。

我正在使用来自网络作业的证书。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-06T09:14:25.853

在我的情况下，将应用程序池中的 Identity 更改为 NetworkService 解决了这个问题。

# winapi - Win32：API 调用列出服务器上可用的网络共享？

> ID：899995
> 
> 赞同：2
> 
> 时间：2009-05-22T21:04:45.280
> 
> 标签：winapi, samba, smb, network-shares

假设我可以访问 IP 1.2.3.4 的 SMB 服务器，我如何确定可用共享列表？

当我输入 UNC 路径 \\1.2.3.4\ 时，Windows 资源管理器可以执行此操作 - 但命令提示符“dir \\1.2.3.4\”失败！

我已经尝试了通常的 FindFirstFile/FindNext 调用——我成功地使用它来读取每个共享上的文件和目录，但它们不能直接在服务器根目录上工作。

理想情况下，我需要一些适用于 XP 的东西。

**编辑：**我想以编程方式执行此操作，而不是从命令行执行此操作。重定向和解析来自“net view 1.2.3.4”的输出会起作用，但理想情况下我正在为这项工作寻找一个 API。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T21:14:27.710

根据文档，有一个[`NetShareEnum`](http://msdn.microsoft.com/en-us/library/bb525387(VS.85).aspx)和一个[`WNetEnumResource`](http://msdn.microsoft.com/en-us/library/aa385449(VS.85).aspx)功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T21:06:31.843

网络视图 \\1.2.3.4

查看[http://www.ss64.com/nt/net_share.html](http://www.ss64.com/nt/net_share.html)

编辑：如果您想以编程方式执行此操作，[NetShareEnum](http://msdn.microsoft.com/en-us/library/bb525387(VS.85).aspx)似乎可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T21:16:43.693

看来您可以使用 WMI 来获取此信息。查看[这篇文章](http://www.computerperformance.co.uk/powershell/powershell_wmi_shares.htm)，了解一些简洁的 PowerShell 教程，这些教程现在显示如何使用 Win32_Share WMI 对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T15:05:46.757

从不使用 WMI（未原生安装）
使用 Win32 api 枚举共享，在谷歌群组上发布数百万次（win32）**********